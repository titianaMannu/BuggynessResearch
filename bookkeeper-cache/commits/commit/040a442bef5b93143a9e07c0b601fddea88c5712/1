{"sha":"040a442bef5b93143a9e07c0b601fddea88c5712","node_id":"MDY6Q29tbWl0MTU3NTk1NjowNDBhNDQyYmVmNWI5MzE0M2E5ZTA3YzBiNjAxZmRkZWE4OGM1NzEy","commit":{"author":{"name":"Ivan Brendan Kelly","email":"ivank@apache.org","date":"2013-02-19T15:15:47Z"},"committer":{"name":"Ivan Brendan Kelly","email":"ivank@apache.org","date":"2013-02-19T15:15:47Z"},"message":"BOOKKEEPER-548: Document about periodic ledger checker configuration (ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1447756 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"3ce3940cef1a613c462ba8734b15317ff62d46b3","url":"https://api.github.com/repos/apache/bookkeeper/git/trees/3ce3940cef1a613c462ba8734b15317ff62d46b3"},"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/040a442bef5b93143a9e07c0b601fddea88c5712","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/bookkeeper/commits/040a442bef5b93143a9e07c0b601fddea88c5712","html_url":"https://github.com/apache/bookkeeper/commit/040a442bef5b93143a9e07c0b601fddea88c5712","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/040a442bef5b93143a9e07c0b601fddea88c5712/comments","author":{"login":"ivankelly","id":54955,"node_id":"MDQ6VXNlcjU0OTU1","avatar_url":"https://avatars.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"committer":{"login":"ivankelly","id":54955,"node_id":"MDQ6VXNlcjU0OTU1","avatar_url":"https://avatars.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"parents":[{"sha":"cda181255f0bb2ebc1a69f75b2b6f84b50c4fba0","url":"https://api.github.com/repos/apache/bookkeeper/commits/cda181255f0bb2ebc1a69f75b2b6f84b50c4fba0","html_url":"https://github.com/apache/bookkeeper/commit/cda181255f0bb2ebc1a69f75b2b6f84b50c4fba0"}],"stats":{"total":19,"additions":16,"deletions":3},"files":[{"sha":"c7a949facbc34f312ea3e867337654a20d25d845","filename":"CHANGES.txt","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/bookkeeper/blob/040a442bef5b93143a9e07c0b601fddea88c5712/CHANGES.txt","raw_url":"https://github.com/apache/bookkeeper/raw/040a442bef5b93143a9e07c0b601fddea88c5712/CHANGES.txt","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/CHANGES.txt?ref=040a442bef5b93143a9e07c0b601fddea88c5712","patch":"@@ -11,6 +11,8 @@ Trunk (unreleased changes)\n     BUGFIXES:\n       bookkeeper-server:\n \n+        BOOKKEEPER-548: Document about periodic ledger checker configuration (ivank)\n+\n         BOOKKEEPER-561: Findbugs report errors with openjdk (ivank via umamahesh)\n \n         BOOKKEEPER-554: fd leaking when move ledger index file (sijie, ivank via sijie)"},{"sha":"a02233655aa3ccb7542b95fffe11b7621120451c","filename":"bookkeeper-server/conf/bk_server.conf","status":"modified","additions":7,"deletions":0,"changes":7,"blob_url":"https://github.com/apache/bookkeeper/blob/040a442bef5b93143a9e07c0b601fddea88c5712/bookkeeper-server/conf/bk_server.conf","raw_url":"https://github.com/apache/bookkeeper/raw/040a442bef5b93143a9e07c0b601fddea88c5712/bookkeeper-server/conf/bk_server.conf","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/conf/bk_server.conf?ref=040a442bef5b93143a9e07c0b601fddea88c5712","patch":"@@ -177,3 +177,10 @@ zkTimeout=10000\n #Disk check interval in milli seconds, interval to check the ledger dirs usage.\n #Default is 10000\n #diskCheckInterval=10000\n+\n+# Interval at which the auditor will do a check of all ledgers in the cluster.\n+# By default this runs once a week. The interval is set in seconds.\n+# To disable the periodic check completely, set this to 0.\n+# Note that periodic checking will put extra load on the cluster, so it should\n+# not be run more frequently than once a day.\n+#auditorPeriodicCheckInterval=604800"},{"sha":"f422f5fdaf663f4d66bdc390c2edfc84371826ac","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java","status":"modified","additions":4,"deletions":3,"changes":7,"blob_url":"https://github.com/apache/bookkeeper/blob/040a442bef5b93143a9e07c0b601fddea88c5712/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java","raw_url":"https://github.com/apache/bookkeeper/raw/040a442bef5b93143a9e07c0b601fddea88c5712/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java?ref=040a442bef5b93143a9e07c0b601fddea88c5712","patch":"@@ -650,7 +650,8 @@ public int getDiskCheckInterval() {\n     /**\n      * Set the regularity at which the auditor will run a check\n      * of all ledgers. This should not be run very often, and at most,\n-     * once a day.\n+     * once a day. Setting this to 0 will completely disable the periodic\n+     * check.\n      *\n      * @param interval The interval in seconds. e.g. 86400 = 1 day, 604800 = 1 week\n      */\n@@ -660,10 +661,10 @@ public void setAuditorPeriodicCheckInterval(long interval) {\n \n     /**\n      * Get the regularity at which the auditor checks all ledgers.\n-     * @return The interval in seconds\n+     * @return The interval in seconds. Default is 604800 (1 week).\n      */\n     public long getAuditorPeriodicCheckInterval() {\n-        return getLong(AUDITOR_PERIODIC_CHECK_INTERVAL, 86400);\n+        return getLong(AUDITOR_PERIODIC_CHECK_INTERVAL, 604800);\n     }\n \n     /**"},{"sha":"e0196ccf959b12616908fc302696db6c7c262ab9","filename":"doc/bookkeeperConfig.textile","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/apache/bookkeeper/blob/040a442bef5b93143a9e07c0b601fddea88c5712/doc/bookkeeperConfig.textile","raw_url":"https://github.com/apache/bookkeeper/raw/040a442bef5b93143a9e07c0b601fddea88c5712/doc/bookkeeperConfig.textile","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/doc/bookkeeperConfig.textile?ref=040a442bef5b93143a9e07c0b601fddea88c5712","patch":"@@ -124,10 +124,13 @@ Configuration parameters for autorecovery can be set in *bookkeeper-server/conf/\n \n Important parameters are:\n \n+* @auditorPeriodicCheckInterval@, interval at which the auditor will do a check of all ledgers in the cluster. By default this runs once a week. The interval is set in seconds. To disable the periodic check completely, set this to 0. Note that periodic checking will put extra load on the cluster, so it should not be run more frequently than once a day.\n+\n * @rereplicationEntryBatchSize@ specifies the number of entries which a replication will rereplicate in parallel. The default value is 10. A larger value for this parameter will increase the speed at which autorecovery occurs but will increate the memory requirement of the autorecovery process, and create more load on the cluster.\n \n * @openLedgerRereplicationGracePeriod@, is the amount of time, in milliseconds, which a recovery worker will wait before recovering a ledger segment which has no defined ended, i.e. the client is still writing to that segment. If the client is still active, it should detect the bookie failure, and start writing to a new ledger segment, and a new ensemble, which doesn't include the failed bookie. Creating new ledger segment will define the end of the previous segment. If, after the grace period, the ledger segment's end has not been defined, we assume the writing client has crashed. The ledger is fenced and the client is blocked from writing any more entries to the ledger. The default value is 30000ms.\n \n+\n h3. Disabling Autorecovery during maintenance\n \n It is useful to disable autorecovery during maintenance, for example, to avoid a Bookie's data being unnecessarily rereplicated when it is only being taken down for a short period to update the software, or change the configuration."}]}

