{"sha":"3d32544c0b2b1cd5b184531846a451f518486c7d","node_id":"MDY6Q29tbWl0MTU3NTk1NjozZDMyNTQ0YzBiMmIxY2Q1YjE4NDUzMTg0NmE0NTFmNTE4NDg2Yzdk","commit":{"author":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2012-03-21T05:40:55Z"},"committer":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2012-03-21T05:40:55Z"},"message":"BOOKKEEPER-189: AbstractZkLedgerManager doesn't disregard cookies (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1303291 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"244e8aa0249846045e000b3c768f1a2631b3c0d8","url":"https://api.github.com/repos/apache/bookkeeper/git/trees/244e8aa0249846045e000b3c768f1a2631b3c0d8"},"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/3d32544c0b2b1cd5b184531846a451f518486c7d","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/bookkeeper/commits/3d32544c0b2b1cd5b184531846a451f518486c7d","html_url":"https://github.com/apache/bookkeeper/commit/3d32544c0b2b1cd5b184531846a451f518486c7d","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/3d32544c0b2b1cd5b184531846a451f518486c7d/comments","author":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"sha":"f3a404e4e6b0d0c2a0b2a83d38cdedaff0683e68","url":"https://api.github.com/repos/apache/bookkeeper/commits/f3a404e4e6b0d0c2a0b2a83d38cdedaff0683e68","html_url":"https://github.com/apache/bookkeeper/commit/f3a404e4e6b0d0c2a0b2a83d38cdedaff0683e68"}],"stats":{"total":10,"additions":7,"deletions":3},"files":[{"sha":"e059ecd77c1dfff403d103fc7700b12677edf28e","filename":"CHANGES.txt","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/bookkeeper/blob/3d32544c0b2b1cd5b184531846a451f518486c7d/CHANGES.txt","raw_url":"https://github.com/apache/bookkeeper/raw/3d32544c0b2b1cd5b184531846a451f518486c7d/CHANGES.txt","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/CHANGES.txt?ref=3d32544c0b2b1cd5b184531846a451f518486c7d","patch":"@@ -60,6 +60,8 @@ Trunk (unreleased changes)\n \n         BOOKKEEPER-186: Bookkeeper throttling - permits is not released when read has failed from all replicas (Rakesh R via sijie)\n \n+        BOOKKEEPER-189: AbstractZkLedgerManager doesn't disregard cookies (ivank via sijie)\n+\n       hedwig-server/\n       \n         BOOKKEEPER-140: Hub server doesn't subscribe remote region correctly when a region is down. (Sijie Gou via ivank)"},{"sha":"dfd94a2237fbcb02e993bb640835c19d8cdf60fc","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/apache/bookkeeper/blob/3d32544c0b2b1cd5b184531846a451f518486c7d/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java","raw_url":"https://github.com/apache/bookkeeper/raw/3d32544c0b2b1cd5b184531846a451f518486c7d/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java?ref=3d32544c0b2b1cd5b184531846a451f518486c7d","patch":"@@ -45,6 +45,7 @@\n     // Ledger Node Prefix\n     static public final String LEDGER_NODE_PREFIX = \"L\";\n     static final String AVAILABLE_NODE = \"available\";\n+    static final String COOKIES_NODE = \"cookies\";\n \n     protected final AbstractConfiguration conf;\n     protected final ZooKeeper zk;\n@@ -240,7 +241,8 @@ public void operationComplete(int rc, HashSet<Long> zkActiveLedgers) {\n      * @return true  if the znode is a special znode otherwise false\n      */\n     protected boolean isSpecialZnode(String znode) {\n-        if (AVAILABLE_NODE.equals(znode) \n+        if (AVAILABLE_NODE.equals(znode)\n+            || COOKIES_NODE.equals(znode)\n             || LedgerLayout.LAYOUT_ZNODE.equals(znode)) {\n             return true;\n         }"},{"sha":"9d9bf229cc8bef0979e1a3f395985271e0744863","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/apache/bookkeeper/blob/3d32544c0b2b1cd5b184531846a451f518486c7d/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java","raw_url":"https://github.com/apache/bookkeeper/raw/3d32544c0b2b1cd5b184531846a451f518486c7d/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java?ref=3d32544c0b2b1cd5b184531846a451f518486c7d","patch":"@@ -377,11 +377,11 @@ public void garbageCollectLedgers(GarbageCollector gc) {\n                     }\n                 } catch (Exception e) {\n                     LOG.warn(\"Exception during garbage collecting ledgers for \" + l1Node\n-                           + \" of \" + ledgerRootPath);\n+                             + \" of \" + ledgerRootPath, e);\n                 }\n             }\n         } catch (Exception e) {\n-            LOG.warn(\"Exception during garbage collecting inactive/deleted ledgers\");\n+            LOG.warn(\"Exception during garbage collecting inactive/deleted ledgers\", e);\n         }\n     }\n "}]}

