{"sha":"8b6f36788cb4614d506e0e526475592cd8fbeb6a","node_id":"MDY6Q29tbWl0MTU3NTk1Njo4YjZmMzY3ODhjYjQ2MTRkNTA2ZTBlNTI2NDc1NTkyY2Q4ZmJlYjZh","commit":{"author":{"name":"Ivan Brendan Kelly","email":"ivank@apache.org","date":"2011-11-29T20:00:18Z"},"committer":{"name":"Ivan Brendan Kelly","email":"ivank@apache.org","date":"2011-11-29T20:00:18Z"},"message":"BOOKKEEPER-121: Review Hedwig client documentation (breed via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1208050 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"487876cea5574567f3e0014d334c284d922bc165","url":"https://api.github.com/repos/apache/bookkeeper/git/trees/487876cea5574567f3e0014d334c284d922bc165"},"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/8b6f36788cb4614d506e0e526475592cd8fbeb6a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/bookkeeper/commits/8b6f36788cb4614d506e0e526475592cd8fbeb6a","html_url":"https://github.com/apache/bookkeeper/commit/8b6f36788cb4614d506e0e526475592cd8fbeb6a","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/8b6f36788cb4614d506e0e526475592cd8fbeb6a/comments","author":{"login":"ivankelly","id":54955,"node_id":"MDQ6VXNlcjU0OTU1","avatar_url":"https://avatars.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"committer":{"login":"ivankelly","id":54955,"node_id":"MDQ6VXNlcjU0OTU1","avatar_url":"https://avatars.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"parents":[{"sha":"da088187d80bf0b935aad14c1a4aa73e4920378f","url":"https://api.github.com/repos/apache/bookkeeper/commits/da088187d80bf0b935aad14c1a4aa73e4920378f","html_url":"https://github.com/apache/bookkeeper/commit/da088187d80bf0b935aad14c1a4aa73e4920378f"}],"stats":{"total":23,"additions":13,"deletions":10},"files":[{"sha":"dd5c2fb4aa544aa8b8e0e61c074059d53386d168","filename":"CHANGES.txt","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/bookkeeper/blob/8b6f36788cb4614d506e0e526475592cd8fbeb6a/CHANGES.txt","raw_url":"https://github.com/apache/bookkeeper/raw/8b6f36788cb4614d506e0e526475592cd8fbeb6a/CHANGES.txt","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/CHANGES.txt?ref=8b6f36788cb4614d506e0e526475592cd8fbeb6a","patch":"@@ -10,6 +10,8 @@ BUGFIXES:\n \n  BOOKKEEPER-124: build has RAT failures (ivank)\n \n+ BOOKKEEPER-121: Review Hedwig client documentation (breed via ivank)\n+\n  bookkeeper-server/\n \n   BOOKKEEPER-1: Static variable makes tests fail (fpj via ivank)"},{"sha":"bcecd9930e0727ef11d5c81d2fa3b8a9c272073a","filename":"doc/hedwigBuild.textile","status":"modified","additions":0,"deletions":4,"changes":4,"blob_url":"https://github.com/apache/bookkeeper/blob/8b6f36788cb4614d506e0e526475592cd8fbeb6a/doc/hedwigBuild.textile","raw_url":"https://github.com/apache/bookkeeper/raw/8b6f36788cb4614d506e0e526475592cd8fbeb6a/doc/hedwigBuild.textile","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/doc/hedwigBuild.textile?ref=8b6f36788cb4614d506e0e526475592cd8fbeb6a","patch":"@@ -15,8 +15,6 @@ For the core itself:\n \n * JDK 6: \"http://java.sun.com/\":http://java.sun.com/. Ensure @$JAVA_HOME@ is correctly set.\n * Maven 2: \"http://maven.apache.org/\":http://maven.apache.org/.\n-* Protocol Buffers 2.3.0: \"http://protobuf.googlecode.com/\":http://protobuf.googlecode.com/.\n-* Zookeeper 3.4.0: \"http://zookeeper.apache.org/\":http://zookeeper.apache.org/.\n \n Hedwig has been tested on Windows XP, Linux 2.6, and OS X.\n \n@@ -35,8 +33,6 @@ To check out, build, and develop using Eclipse:\n # Go to Preferences &gt; Team &gt; SVN. For the SVN interface, choose &quot;Pure Java&quot;.\n # Choose File &gt; New &gt; Project... &gt; Maven &gt; Checkout Maven Projects from SCM.\n # For the SCM URL type, choose SVN. For the URL, enter SVN URL. Maven will automatically create a top-level Eclipse project for each of the 4 Maven modules (recommended). If you want fewer top-level projects, uncheck the option of having a project for each module (under Advanced).\n-# Right-click on the @protocol@ project and choose Run As &gt; Maven generate-sources. This will generate the Java and C++ code for Protocol Buffers.\n-# Refresh the workspace to pick up the generated code and add @hedwig/protocol/target/generated-sources/java@ as a source folder. (6 &amp; 7 should really be doable automatically, but I haven't figured out how.)\n \n You are now ready to run and debug the client and server code. See the User's Guide for instructions on running and usage.\n "},{"sha":"e56c0d19569831941517566c8679c39a0f3831d8","filename":"doc/hedwigDesign.textile","status":"modified","additions":6,"deletions":2,"changes":8,"blob_url":"https://github.com/apache/bookkeeper/blob/8b6f36788cb4614d506e0e526475592cd8fbeb6a/doc/hedwigDesign.textile","raw_url":"https://github.com/apache/bookkeeper/raw/8b6f36788cb4614d506e0e526475592cd8fbeb6a/doc/hedwigDesign.textile","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/doc/hedwigDesign.textile?ref=8b6f36788cb4614d506e0e526475592cd8fbeb6a","patch":"@@ -36,9 +36,13 @@ h1. Pseudocode\n \n This summarizes the control flow through the system.\n \n-publishhandler topicmgr.getowner (maybe) claim the topic, calling back into persmgr.acquiredtopic read /hedwig/standalone/topics/TOPIC (which should initially be empty) for each line, parse as &quot;STARTSEQ&quot; # TODO how is this written? ledger = bk.openledger(ledgerid) lastid = ledger.getlast if lastid &gt; 0, lrs[startseq] = persmgr.ledger2lr[ledgerid] = new LedgerRange(ledger, ledgerid, startseq, startseq + lastid # TODO what are ledger ranges? create new ledger for topic # TODO read lr = new LedgerRange(ledger, ledgerid, lastid, -1) lrs[lastid] = lr persmgr.topic2ranges[topic] = lrs add region info to pub req and send that to persmgr.persistmessage entryid = persmgr.topic2ranges[topic].last.ledger.addentry(the pub'd data) update persmgr.topic2lastseq[topic]: .local = persmgr.ledger2lr[ledger id].startseq + entryid .regions = maxes of orig seq and incoming pub seq\n+h2. publish\n \n-subscribehandler topicmgr.getowner... delivmgr.startservingsubscription(topic, endpoint, ishubsubscriber) delivmgr.endpoint2sub[endpoint] = new subscriber(lastseq = persmgr.getcurrentseqidfortopic(topic).local) delivmgr.topic2ptr2subs[topic][ptr].add(sub) sub.delivernextmessage sub.curseq = persmgr.getseqidafterskipping(topic, sub.lastseq, skip = 1) msg = persmgr.scansinglemessage(topic, seq = sub.curseq) if persmgr.topic2lastseq[topic].local &gt;= seq lr = persmgr.topic2ranges[topic].floor(seq) return lr.ledger.read(first = last = seq - lr.startseq) if failed, then retry in 1 s endpoint.send(msg) movedeliveryptr delivmgr.topic2ptr2subs[topic][sub.lastseq].remove(sub) delivmgr.topic2ptr2subs[topic][sub.curseq].add(sub) previd = sub.lastseq, sub.lastseq = sub.curseq sub.delivernextmessage...\n+Need to document\n+\n+h2. subscribe\n+\n+Need to document\n \n h1. ReadAhead Cache\n "},{"sha":"58ff1cf1546ed9544ba732e3cd53b8cf1ad20731","filename":"doc/hedwigUser.textile","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/apache/bookkeeper/blob/8b6f36788cb4614d506e0e526475592cd8fbeb6a/doc/hedwigUser.textile","raw_url":"https://github.com/apache/bookkeeper/raw/8b6f36788cb4614d506e0e526475592cd8fbeb6a/doc/hedwigUser.textile","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/doc/hedwigUser.textile?ref=8b6f36788cb4614d506e0e526475592cd8fbeb6a","patch":"@@ -43,20 +43,21 @@ Hedwig requires BookKeeper to run. For BookKeeper setup instructions see \"BookKe\n \n To start a Hedwig hub server:\n \n- @ hedwig-server/bin/hedwig server\n+@hedwig-server/bin/hedwig server@\n \n Hedwig takes its configuration from hedwig-server/conf/hw_server.conf by default. To change location of the conf file, modify the HEDWIG_SERVER_CONF environment variable.\n \n h1. Debugging\n \n You can attach an Eclipse debugger (or any debugger) to a Java process running on a remote host, as long as it has been started with the appropriate JVM flags. (See the Building Hedwig document to set up your Eclipse environment.) To launch something using @bin/hedwig@ with debugger attachment enabled, prefix the command with @HEDWIG_EXTRA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,address=5000@, e.g.:\n \n-@ HEDWIG_EXTRA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,address=5000 hedwig-server/bin/hedwig server\n+@HEDWIG_EXTRA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,address=5000 hedwig-server/bin/hedwig server@\n \n h1. Logging\n \n-To control the logging in Hedwig server, set HEDWIG_LOG_CONF to the location of a log4j.properties file.\n+Hedwig uses \"slf4j\":http://www.slf4j.org for logging, with the log4j bindings enabled by default. To enable logging from hedwig, create a log4j.properties file and point the environment variable HEDWIG_LOG_CONF to the file. The path to the log4j.properties file must be absolute.\n \n-@ HEDWIG_LOG_CONF=../hw_testing/log4j.properties hedwig-server/bin/hedwig server\n+@export HEDWIG_LOG_CONF=/tmp/log4j.properties@\n+@hedwig-server/bin/hedwig server@\n \n "}]}

