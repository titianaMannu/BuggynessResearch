{"sha":"be94b88ea61b75246586b6495f8d3710d4c4217a","node_id":"MDY6Q29tbWl0MTU3NTk1NjpiZTk0Yjg4ZWE2MWI3NTI0NjU4NmI2NDk1ZjhkMzcxMGQ0YzQyMTdh","commit":{"author":{"name":"Ivan Brendan Kelly","email":"ivank@apache.org","date":"2012-08-17T16:25:35Z"},"committer":{"name":"Ivan Brendan Kelly","email":"ivank@apache.org","date":"2012-08-17T16:25:35Z"},"message":"BOOKKEEPER-372: Check service name in bookie start/stop script. (nijel via ivank)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1374345 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"031294b6587e49d39ee97fc529f6fe3d648e351d","url":"https://api.github.com/repos/apache/bookkeeper/git/trees/031294b6587e49d39ee97fc529f6fe3d648e351d"},"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/be94b88ea61b75246586b6495f8d3710d4c4217a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/bookkeeper/commits/be94b88ea61b75246586b6495f8d3710d4c4217a","html_url":"https://github.com/apache/bookkeeper/commit/be94b88ea61b75246586b6495f8d3710d4c4217a","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/be94b88ea61b75246586b6495f8d3710d4c4217a/comments","author":{"login":"ivankelly","id":54955,"node_id":"MDQ6VXNlcjU0OTU1","avatar_url":"https://avatars.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"committer":{"login":"ivankelly","id":54955,"node_id":"MDQ6VXNlcjU0OTU1","avatar_url":"https://avatars.githubusercontent.com/u/54955?v=4","gravatar_id":"","url":"https://api.github.com/users/ivankelly","html_url":"https://github.com/ivankelly","followers_url":"https://api.github.com/users/ivankelly/followers","following_url":"https://api.github.com/users/ivankelly/following{/other_user}","gists_url":"https://api.github.com/users/ivankelly/gists{/gist_id}","starred_url":"https://api.github.com/users/ivankelly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivankelly/subscriptions","organizations_url":"https://api.github.com/users/ivankelly/orgs","repos_url":"https://api.github.com/users/ivankelly/repos","events_url":"https://api.github.com/users/ivankelly/events{/privacy}","received_events_url":"https://api.github.com/users/ivankelly/received_events","type":"User","site_admin":false},"parents":[{"sha":"45034f5f4a51225b9f963840741818da7869a85c","url":"https://api.github.com/repos/apache/bookkeeper/commits/45034f5f4a51225b9f963840741818da7869a85c","html_url":"https://github.com/apache/bookkeeper/commit/45034f5f4a51225b9f963840741818da7869a85c"}],"stats":{"total":34,"additions":31,"deletions":3},"files":[{"sha":"4bd4580b588c442d64202b3fd0cba064fdb080b1","filename":"CHANGES.txt","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/bookkeeper/blob/be94b88ea61b75246586b6495f8d3710d4c4217a/CHANGES.txt","raw_url":"https://github.com/apache/bookkeeper/raw/be94b88ea61b75246586b6495f8d3710d4c4217a/CHANGES.txt","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/CHANGES.txt?ref=be94b88ea61b75246586b6495f8d3710d4c4217a","patch":"@@ -54,6 +54,8 @@ Trunk (unreleased changes)\n \n         BOOKKEEPER-326: DeadLock during ledger recovery (rakeshr via ivank)\n \n+        BOOKKEEPER-372: Check service name in bookie start/stop script. (nijel via ivank)\n+\n       hedwig-client:\n \n         BOOKKEEPER-274: Hedwig cpp client library should not link to cppunit which is just used for test. (sijie via ivank)"},{"sha":"bb2b3e7f4bdcae8a39b2be3d53a3bc8d6c8a0465","filename":"bookkeeper-server/bin/bookkeeper-daemon.sh","status":"modified","additions":29,"deletions":3,"changes":32,"blob_url":"https://github.com/apache/bookkeeper/blob/be94b88ea61b75246586b6495f8d3710d4c4217a/bookkeeper-server/bin/bookkeeper-daemon.sh","raw_url":"https://github.com/apache/bookkeeper/raw/be94b88ea61b75246586b6495f8d3710d4c4217a/bookkeeper-server/bin/bookkeeper-daemon.sh","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/bin/bookkeeper-daemon.sh?ref=be94b88ea61b75246586b6495f8d3710d4c4217a","patch":"@@ -18,8 +18,16 @@\n # * limitations under the License.\n # */\n \n-usage=\"Usage: bookkeeper-daemon.sh (start|stop) <command> <args...>\"\n-supportedargs=\"Supported args : -force (accepted only with stop command) - Decides whether to stop the Bookie Server forcefully if not stopped by normal shutdown\"\n+usage() {\n+    cat <<EOF\n+Usage: bookkeeper-daemon.sh (start|stop) <command> <args...>\n+where command is one of:\n+    bookie           Run the bookie server\n+\n+where argument is one of:\n+    -force (accepted only with stop command): Decides whether to stop the Bookie Server forcefully if not stopped by normal shutdown\n+EOF\n+}\n \n BINDIR=`dirname \"$0\"`\n BK_HOME=`cd $BINDIR/..;pwd`\n@@ -37,11 +45,29 @@ BOOKIE_STOP_TIMEOUT=${BOOKIE_STOP_TIMEOUT:-30}\n \n BOOKIE_PID_DIR=${BOOKIE_PID_DIR:-$BK_HOME/bin}\n \n+if [ $# -lt 2 ]\n+then\n+    echo \"Error: no enough arguments provided.\"\n+    usage\n+    exit 1\n+fi\n+\n startStop=$1\n shift\n command=$1\n shift\n \n+case $command in\n+    (bookie)\n+        echo \"doing $startStop $command ...\"\n+        ;;\n+    (*)\n+        echo \"Error: unknown service name $command\"\n+        usage\n+        exit 1\n+        ;;\n+esac\n+\n export BOOKIE_LOG_DIR=$BOOKIE_LOG_DIR\n export BOOKIE_ROOT_LOGGER=$BOOKIE_ROOT_LOGGER\n export BOOKIE_LOG_FILE=bookkeeper-$command-$HOSTNAME.log\n@@ -139,7 +165,7 @@ case $startStop in\n     ;;\n \n   (*)\n-    echo $usage\n+    usage\n     echo $supportedargs\n     exit 1\n     ;;"}]}

