{"sha":"d193780cc404c2e3694c82385d7f422accc416f3","node_id":"MDY6Q29tbWl0MTU3NTk1NjpkMTkzNzgwY2M0MDRjMmUzNjk0YzgyMzg1ZDdmNDIyYWNjYzQxNmYz","commit":{"author":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2012-06-27T05:10:46Z"},"committer":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2012-06-27T05:10:46Z"},"message":"BOOKKEEPER-307: BookieShell introduces 4 findbugs warnings (ivank via sijie)\n\ngit-svn-id: https://svn.apache.org/repos/asf/zookeeper/bookkeeper/trunk@1354326 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"069424ac7daa0be2002c070a244e5f12ca1bb77d","url":"https://api.github.com/repos/apache/bookkeeper/git/trees/069424ac7daa0be2002c070a244e5f12ca1bb77d"},"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/d193780cc404c2e3694c82385d7f422accc416f3","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/bookkeeper/commits/d193780cc404c2e3694c82385d7f422accc416f3","html_url":"https://github.com/apache/bookkeeper/commit/d193780cc404c2e3694c82385d7f422accc416f3","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/d193780cc404c2e3694c82385d7f422accc416f3/comments","author":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"sha":"18728877881a23d2639eb650d47b7c41bbccd9ca","url":"https://api.github.com/repos/apache/bookkeeper/commits/18728877881a23d2639eb650d47b7c41bbccd9ca","html_url":"https://github.com/apache/bookkeeper/commit/18728877881a23d2639eb650d47b7c41bbccd9ca"}],"stats":{"total":27,"additions":12,"deletions":15},"files":[{"sha":"e17a4694697be316eca94e3e23be6cef8609da46","filename":"CHANGES.txt","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/bookkeeper/blob/d193780cc404c2e3694c82385d7f422accc416f3/CHANGES.txt","raw_url":"https://github.com/apache/bookkeeper/raw/d193780cc404c2e3694c82385d7f422accc416f3/CHANGES.txt","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/CHANGES.txt?ref=d193780cc404c2e3694c82385d7f422accc416f3","patch":"@@ -22,6 +22,8 @@ Trunk (unreleased changes)\n \n         BOOKKEEPER-183: Provide tools to read/check data files in bookie server (sijie via ivank)\n \n+        BOOKKEEPER-307: BookieShell introduces 4 findbugs warnings (ivank via sijie)\n+\n       hedwig-client:\n \n         BOOKKEEPER-274: Hedwig cpp client library should not link to cppunit which is just used for test. (sijie via ivank)"},{"sha":"8ca0cb663486f6971dce75869b76e29af1d8ef1a","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java","status":"modified","additions":7,"deletions":12,"changes":19,"blob_url":"https://github.com/apache/bookkeeper/blob/d193780cc404c2e3694c82385d7f422accc416f3/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java","raw_url":"https://github.com/apache/bookkeeper/raw/d193780cc404c2e3694c82385d7f422accc416f3/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java?ref=d193780cc404c2e3694c82385d7f422accc416f3","patch":"@@ -21,11 +21,9 @@\n import java.io.File;\n import java.io.FileNotFoundException;\n import java.io.IOException;\n-import java.io.RandomAccessFile;\n import java.nio.ByteBuffer;\n import java.util.Formatter;\n import java.util.HashMap;\n-import java.util.List;\n import java.util.Map;\n \n import org.apache.bookkeeper.bookie.EntryLogger.EntryLogScanner;\n@@ -35,7 +33,6 @@\n import org.apache.bookkeeper.util.EntryFormatter;\n import org.apache.bookkeeper.util.Tool;\n import org.apache.commons.configuration.Configuration;\n-import org.apache.commons.configuration.ConfigurationException;\n import org.apache.commons.configuration.CompositeConfiguration;\n import org.apache.commons.configuration.PropertiesConfiguration;\n import org.apache.commons.cli.BasicParser;\n@@ -473,10 +470,11 @@ protected void scanEntryLog(long logId, EntryLogScanner scanner) throws IOExcept\n         entryLogger.scanEntryLog(logId, scanner);\n     }\n \n-    private synchronized void initJournal() throws IOException {\n+    private synchronized Journal getJournal() throws IOException {\n         if (null == journal) {\n             journal = new Journal(bkConf);\n         }\n+        return journal;\n     }\n \n     /**\n@@ -488,8 +486,7 @@ private synchronized void initJournal() throws IOException {\n      *          Journal File Scanner\n      */\n     protected void scanJournal(long journalId, JournalScanner scanner) throws IOException {\n-        initJournal();\n-        journal.scanJournal(journalId, 0L, scanner);\n+        getJournal().scanJournal(journalId, 0L, scanner);\n     }\n \n     ///\n@@ -617,11 +614,10 @@ public void process(int journalVersion, long offset, ByteBuffer entry) throws IO\n      * Print last log mark\n      */\n     protected void printLastLogMark() throws IOException {\n-        initJournal();\n-        LastLogMark lastLogMark = journal.getLastLogMark();\n-        System.out.println(\"LastLogMark: Journal Id - \" + lastLogMark.txnLogId + \"(\"\n-                         + Long.toHexString(lastLogMark.txnLogId) + \".txn), Pos - \"\n-                         + lastLogMark.txnLogPosition);\n+        LastLogMark lastLogMark = getJournal().getLastLogMark();\n+        System.out.println(\"LastLogMark: Journal Id - \" + lastLogMark.getTxnLogId() + \"(\"\n+                + Long.toHexString(lastLogMark.getTxnLogId()) + \".txn), Pos - \"\n+                + lastLogMark.getTxnLogPosition());\n     }\n \n     /**\n@@ -652,7 +648,6 @@ private void formatEntry(long pos, ByteBuffer recBuff, boolean printMsg) {\n         }\n         // process a data entry\n         long lastAddConfirmed = recBuff.getLong();\n-        long length = recBuff.getLong();\n         System.out.println(\"Type:           DATA\");\n         System.out.println(\"LastConfirmed:  \" + lastAddConfirmed);\n         if (!printMsg) {"},{"sha":"aadd555eaed086adb11ff23504c74bfeb69d8513","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/apache/bookkeeper/blob/d193780cc404c2e3694c82385d7f422accc416f3/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java","raw_url":"https://github.com/apache/bookkeeper/raw/d193780cc404c2e3694c82385d7f422accc416f3/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java?ref=d193780cc404c2e3694c82385d7f422accc416f3","patch":"@@ -85,9 +85,9 @@\n      * Last Log Mark\n      */\n     class LastLogMark {\n-        long txnLogId;\n-        long txnLogPosition;\n-        LastLogMark lastMark;\n+        private long txnLogId;\n+        private long txnLogPosition;\n+        private LastLogMark lastMark;\n         LastLogMark(long logId, long logPosition) {\n             this.txnLogId = logId;\n             this.txnLogPosition = logPosition;"}]}

