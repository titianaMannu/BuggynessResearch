{"sha":"d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2","node_id":"MDY6Q29tbWl0MTU3NTk1NjpkNGRiYjZiZmI2Y2Q3YTU2YThiYWY5NTQ3MmE3ZjZmYzY4MGQwY2Ey","commit":{"author":{"name":"Dongfa,Huang","email":"huangdongfa01@gmail.com","date":"2019-04-09T08:16:44Z"},"committer":{"name":"Sijie Guo","email":"guosijie@gmail.com","date":"2019-04-09T08:16:44Z"},"message":"Avoid useless verify if LedgerEntryRequest completed\n\nAvoid useless verify if LedgerEntryRequest completed\r\n\r\nChange-Id: Ifda2a6e218c49105a5627be69566ea2ce4a57699\r\n\r\nDescriptions of the changes in this PR:\r\nPrint misleading logs when the SpeculativeRequestExecutionPolicy is turned onï¼š\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 602\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 606\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 610\r\n2019-04-03 18:30:49,839 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 614\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 644 , actual: 622\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 640 , actual: 626\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 656 , actual: 630\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 652 , actual: 634\r\n2019-04-03 18:30:49,843 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 648 , actual: 638\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 660 , actual: 642\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 675 , actual: 646\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 671 , actual: 650\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 667 , actual: 654\r\n2019-04-03 18:30:49,846 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 663 , actual: 658\r\n2019-04-03 18:30:49,848 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: -1 , actual: 670\r\n2019-04-03 18:30:49,849 ERROR org.apache.bookkeeper.client.DigestManager: Entry-id mismatch in authenticated message, expected: 692 , actual: 662\r\n\r\n\r\n\r\n### Motivation\r\nAvoid useless verify and redundant logging(caused by the use of recycled `entryImpl`) if LedgerEntryRequest completed\r\n\r\n### Changes\r\nReturn immediately if completed\r\n\r\nMaster Issue: #<master-issue-number>\r\n\r\n\r\n\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nThis closes #2061 from huangdongfa/master","tree":{"sha":"2fbad9877cb873d98c1e3e08a8ae40492ba944e7","url":"https://api.github.com/repos/apache/bookkeeper/git/trees/2fbad9877cb873d98c1e3e08a8ae40492ba944e7"},"url":"https://api.github.com/repos/apache/bookkeeper/git/commits/d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/bookkeeper/commits/d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2","html_url":"https://github.com/apache/bookkeeper/commit/d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2","comments_url":"https://api.github.com/repos/apache/bookkeeper/commits/d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2/comments","author":{"login":"huangdongfa","id":4515935,"node_id":"MDQ6VXNlcjQ1MTU5MzU=","avatar_url":"https://avatars.githubusercontent.com/u/4515935?v=4","gravatar_id":"","url":"https://api.github.com/users/huangdongfa","html_url":"https://github.com/huangdongfa","followers_url":"https://api.github.com/users/huangdongfa/followers","following_url":"https://api.github.com/users/huangdongfa/following{/other_user}","gists_url":"https://api.github.com/users/huangdongfa/gists{/gist_id}","starred_url":"https://api.github.com/users/huangdongfa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huangdongfa/subscriptions","organizations_url":"https://api.github.com/users/huangdongfa/orgs","repos_url":"https://api.github.com/users/huangdongfa/repos","events_url":"https://api.github.com/users/huangdongfa/events{/privacy}","received_events_url":"https://api.github.com/users/huangdongfa/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"sha":"5c150f28339d7b32f351f34ee8a7469d265b8613","url":"https://api.github.com/repos/apache/bookkeeper/commits/5c150f28339d7b32f351f34ee8a7469d265b8613","html_url":"https://github.com/apache/bookkeeper/commit/5c150f28339d7b32f351f34ee8a7469d265b8613"}],"stats":{"total":3,"additions":3,"deletions":0},"files":[{"sha":"22c0fc15b3867960a03079f2f9b83dbed61f12a6","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/apache/bookkeeper/blob/d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java","raw_url":"https://github.com/apache/bookkeeper/raw/d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java","contents_url":"https://api.github.com/repos/apache/bookkeeper/contents/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java?ref=d4dbb6bfb6cd7a56a8baf95472a7f6fc680d0ca2","patch":"@@ -131,6 +131,9 @@ public void close() {\n          */\n         boolean complete(int bookieIndex, BookieSocketAddress host, final ByteBuf buffer) {\n             ByteBuf content;\n+            if (isComplete()) {\n+                return false;\n+            }\n             try {\n                 content = lh.macManager.verifyDigestAndReturnData(eId, buffer);\n             } catch (BKDigestMatchException e) {"}]}

