{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12598127","self":"https://issues.apache.org/jira/rest/api/2/issue/12598127","key":"BOOKKEEPER-336","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12320244","id":"12320244","description":"Release 4.2.0","name":"4.2.0","archived":false,"released":true,"releaseDate":"2013-01-19"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"250195","customfield_12312320":null,"customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319145","id":"12319145","name":"4.1.0","archived":false,"released":true,"releaseDate":"2012-06-13"}],"customfield_12311120":null,"customfield_12313826":null,"issuelinks":[{"id":"12355769","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12355769","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12549521","key":"BOOKKEEPER-208","self":"https://issues.apache.org/jira/rest/api/2/issue/12549521","fields":{"summary":"Separate write quorum from ack quorum","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype","name":"New Feature","subtask":false,"avatarId":21141}}}}],"customfield_12312339":null,"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"61216","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[{"id":"12613499","key":"BOOKKEEPER-444","self":"https://issues.apache.org/jira/rest/api/2/issue/12613499","fields":{"summary":"Refactor pending read op to make speculative reads possible","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/BOOKKEEPER-336/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7afe8dc[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21331f68[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@387c1d00[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@10d8d38[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@65da89d8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4a3ee296[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@127272cc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7ffb59f7[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4ede9b99[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@73c9ea86[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@72ac1221[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@57bdd962[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311293","id":"12311293","key":"BOOKKEEPER","name":"Bookkeeper","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311293&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311293&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311293&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311293&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/14780","id":"14780","description":"BookKeeper","name":"BookKeeper"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2012-12-13T12:08:30.771+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/BOOKKEEPER-336/watchers","watchCount":8,"isWatching":false},"created":"2012-07-10T04:49:01.887+0000","updated":"2013-02-13T15:46:37.181+0000","timeoriginalestimate":null,"description":"Scenario:\n\n1) Start three bookies. Create ledger with ensemblesize=3, quorumsize=2\n2) Add 100 entries to this ledger\n3) Make first bookie down and read the entries from 0-99\n\nOutput: Each entry is going to fetch from the failed bookie and is waiting for the bookie connection timeout, only after failure going to next bookie.\nThis is affecting the read entry performance.\n\nImpact: Namenode switching time will be affected by adding this failed bookie readTimeOut also.","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12560768","id":"12560768","filename":"0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-13T12:12:06.101+0000","size":36851,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12560768/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12560633","id":"12560633","filename":"0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-12T20:50:20.227+0000","size":36027,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12560633/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12555734","id":"12555734","filename":"0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-03T10:47:00.401+0000","size":29659,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12555734/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12555517","id":"12555517","filename":"0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-11-30T16:24:28.295+0000","size":29656,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12555517/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12551593","id":"12551593","filename":"0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-31T17:57:01.438+0000","size":29696,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12551593/0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12551569","id":"12551569","filename":"0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-31T16:00:46.978+0000","size":29543,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12551569/0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12550990","id":"12550990","filename":"0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-26T17:51:47.543+0000","size":10192,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12550990/0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12537686","id":"12537686","filename":"BOOKKEEPER-336.1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-24T12:59:31.493+0000","size":39103,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12537686/BOOKKEEPER-336.1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12541985","id":"12541985","filename":"BOOKKEEPER-336.draft1.diff","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-08-22T15:25:49.469+0000","size":13950,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12541985/BOOKKEEPER-336.draft1.diff"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12536005","id":"12536005","filename":"BOOKKEEPER-336.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-11T09:58:51.949+0000","size":19524,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12536005/BOOKKEEPER-336.patch"}],"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"bookie readEntries is taking more time if the ensemble has failed bookie(s)","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12311024":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13410047","id":"13410047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"body":"For each entry retry it'll take 10seconds\n{noformat}\n2012-07-06 22:07:59,734 ERROR hidden.bkjournal.org.apache.bookkeeper.client.PendingReadOp: Bookie handle is not available while reading entry: 18 ledgerId: 3 from bookie: /HOST.24:3181\n2012-07-06 22:08:10,234 ERROR hidden.bkjournal.org.apache.bookkeeper.proto.PerChannelBookieClient: Could not connect to bookie: /HOST.24:3181\n2012-07-06 22:08:10,234 ERROR hidden.bkjournal.org.apache.bookkeeper.client.PendingReadOp: Bookie handle is not available while reading entry: 21 ledgerId: 3 from bookie: /HOST.24:3181\n2012-07-06 22:08:21,234 ERROR hidden.bkjournal.org.apache.bookkeeper.proto.PerChannelBookieClient: Could not connect to bookie: /HOST.24:3181\n2012-07-06 22:08:21,234 ERROR hidden.bkjournal.org.apache.bookkeeper.client.PendingReadOp: Bookie handle is not available while reading entry: 24 ledgerId: 3 from bookie: /HOST.24:3181\n2012-07-06 22:08:31,734 ERROR hidden.bkjournal.org.apache.bookkeeper.proto.PerChannelBookieClient: Could not connect to bookie: /HOST.24:3181\n2012-07-06 22:08:31,734 ERROR hidden.bkjournal.org.apache.bookkeeper.client.PendingReadOp: Bookie handle is not available while reading entry: 27 ledgerId: 3 from bookie: /HOST.24:3181\n2012-07-06 22:08:42,734 ERROR hidden.bkjournal.org.apache.bookkeeper.proto.PerChannelBookieClient: Could not connect to bookie: /HOST.24:3181\n2012-07-06 22:08:42,734 ERROR hidden.bkjournal.org.apache.bookkeeper.client.PendingReadOp: Bookie handle is not available while reading entry: 30 ledgerId: 3 from bookie: /HOST.24:3181\n2012-07-06 22:08:53,234 ERROR hidden.bkjournal.org.apache.bookkeeper.proto.PerChannelBookieClient: Could not connect to bookie: /HOST.24:3181\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brahmareddy","name":"brahmareddy","key":"brahmareddy","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brahmareddy&avatarId=24624","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brahmareddy&avatarId=24624","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brahmareddy&avatarId=24624","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brahmareddy&avatarId=24624"},"displayName":"Brahma Reddy Battula","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-10T04:51:31.693+0000","updated":"2012-07-10T04:51:31.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13410052","id":"13410052","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"In the Netty code I've seen 'connectTimeout' parameter with default value 10000ms - Time to wait for a socket connection to be available. \n\nAlso, I could see if the machine is reachable(and just shutdown the bookie server) the timeout is very less and immediately retrying to the other bookie in the ensemble. This scenario is occurring if the machine is unreachable and come out as connection timeout.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-10T05:02:28.461+0000","updated":"2012-07-10T05:02:28.461+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411280","id":"13411280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"For some reason my reply did not go I think. Below is the reply for Ivan's mail.\n\n===================================================================\n\nYep, We are also thinking in the same lines.\nOne Idea is that, we can add the failed BKto blackList and from the next entry onwards, we will try first to the healthy bks then we will try for the blackListed bookie from the quorum trails.\nWhy we are planning to retry on blackListed bookies also is, that bookie may come back or can serve well for next reads. But we will give chance only after reamaining bookies faild for the read. \nHow does it sound? \nBrahma already filed a JIRA BK-336 and Rakesh signed up that same.\n\nRegards,\nUma\n________________________________________\nFrom: Ivan Kelly [ivank@apache.org]\nSent: Tuesday, July 10, 2012 4:22 PM\nTo: bookkeeper-dev@zookeeper.apache.org\nSubject: Re: Read entry performance when bookie in the ensemble in unreachable.....\n\nHmmm, perhaps we should add a blacklist to the PendingReadOp, or we\ncould decide to only read from bookies which are in /ledgers/available\n\nCould you open a JIRA for this.\n\nCheers\nIvan\n\n=======================================================================","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T06:51:07.872+0000","updated":"2012-07-11T06:51:07.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411281","id":"13411281","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"Flavio's reply in mailing list about this issue:\n\n=================================================\nI'm not sure blacklisting is a good idea, the bookie could be simply a little slow at that point for whatever reason. It might be a better idea to have a separate timeout for reads. We send read requests to the quorum sequentially to optimize the use bandwidth, but it is clear that slow/dead bookies can hurt performance. We have essentially optimized for what we believed to be the common case. \n\n-Flavio\n\n================================================\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T06:52:20.639+0000","updated":"2012-07-11T06:52:20.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411286","id":"13411286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"Hi Ivan, If we check available bookie's check, we may end up in checking for every entry right, whether bookie is available or not. \nInstead how does the above suggesion sounds to you? We will read the entry from that fault bookie only after the trails for remaining good bookis in the quorum. So, that we are just changing the oreder of read trails in quorum bookies for entries by keeping track of the failed bookies in a faultBookie list. So, that we are not completely avaoiding the reads from that fault bookies. We will to read from this fault bookies only if all other bookies also failed in quorum.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T06:59:50.555+0000","updated":"2012-07-11T06:59:50.555+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411304","id":"13411304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Changing the order of reads for a readEntry request for a single request makes sense because the problem might be transient. If the problem persists, we should drop the bookie and change the ensemble. \n\nMy suggestion is to have a short read timeout and simply move on to the next bookie quickly. This way does not require keeping a blacklist.\n\nWe could also provide another scheduler that sends reads to all bookies in parallel (or to any subset greater than 1). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-07-11T07:57:46.187+0000","updated":"2012-07-11T07:57:46.187+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411322","id":"13411322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"Thanks a lot, Flavio for your opinion.\n\n{quote}\nIf the problem persists, we should drop the bookie and change the ensemble. \n{quote}\nThis would be taken care by AutoRecovery worker if really Bookie is unavailable little later. read can continue with others until we have other bookies in quorum.\n\n{quote}\nMy suggestion is to have a short read timeout and simply move on to the next bookie quickly. This way does not require keeping a blacklist.\n{quote}\nYep, this would be a simplest option. But need to check the scenarios like, if quorum of bookies present in the slow network may create read failure due to this short timeout ..etc. In network down case, whatever whatever timeout we set that much time it will wait.\nIf n entries present in X bookie and its NW down, then n-y entries may be required to read first from this bookie based scheduling algorithm.\n\nSo, overall latency would be (n-y)* configured timeout. So, when compared to normal reads this will have little latency. Ofcource, I understand this is the initial design for the best optimization and have roundrobin fashion.\nMay be our first option may be more better than this as we will not talk to that failed bookie for next entries?\n\nMy worry here is, whatever latency in this read, it will get added to the NameNode switch time. Currently ZKFC will find and switch within 5secs I guess. This read latency will get added to that 5secs switch time due to some bookie are in outof network. \n\nThanks in advance, Ivan and Flavio for your valuable opinions.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T08:30:29.131+0000","updated":"2012-07-11T08:30:29.131+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411342","id":"13411342","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"{quote}\nOne Idea is that, we can add the failed BKto blackList and from the next entry onwards, we will try first to the healthy bks then we will try for the blackListed bookie from the quorum trails.\nWhy we are planning to retry on blackListed bookies also is, that bookie may come back or can serve well for next reads. But we will give chance only after reamaining bookies faild for the read. \n{quote}\n\nIf I understood correctly, the blackList could be a list which maintains the slow bookies based on previous requests. following requests could first tried bookies not in this list, then tried bookies in this this. I think it is a good solution to improve read latency for following requests.\n\nbut seems the problem mentioned in Rakesh's comment. the timeout latency hitting a unreachable bookie still would still be 10s, due to netty setting. so the above solution could not resolve it. and the long latency might introduced due to other reasons like slow disks on bookie server. Flavio is trying to introduce a solution to switch bookies in fixed timeout period to avoid long read latency: a new read request would be send if previous one does not respond. then we had two requests on-the-fly reading same entry from two bookies, the quick one would win and callback.\n\nI think we may consider including these two solutions: blacklist use to pick a might-be-better bookie as start to read entry, read timeout mechanism to avoid long latency and quick switch to next bookie.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T09:32:22.780+0000","updated":"2012-07-11T09:32:22.780+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411353","id":"13411353","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"{quote}\nbut seems the problem mentioned in Rakesh's comment. the timeout latency hitting a unreachable bookie still would still be 10s, due to netty setting.\n{quote}\nYes, 10s is deffenitely we may have to reduce or make it configurable, because our NN switch itself will take just 5secs. By including my proposal, this latency will be only for one entry.\n\nYep, I agree, keeping the both option will solve the things. And we can tune the config value however user wants depending on his clusters.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T09:46:33.979+0000","updated":"2012-07-11T09:46:33.979+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411356","id":"13411356","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"The thing I don't like about the blacklist idea is the following. Keeping a blacklist requires determining which bookies are misbehaving by not responding fast enough or at all. Since we are targeting performance, we don't want to wait too long to go to the next bookie to read an entry. With a short timeout, we will possibly have a lot of false positives because a request may have been caused by a transient problem. False positives make maintaining the blacklist difficult.   ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-07-11T09:56:11.226+0000","updated":"2012-07-11T09:56:11.226+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411367","id":"13411367","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"I just prepared an initial draft version and uploaded, here the idea is just re-ordering the replica indexes:\n\nOn read failure, it will just queued the bookie to the 'unhealthybookies' list. Next sendRead() request will consider the 'unhealthybookies' and prepare the replicabookieIndex in such a way that good bookies will come first in the list and then the unhealthy bookie. This way we would be able to move the slow/bad bookies last in the queue and will do the read. \n\nOn successful read from an unhealthy bookie will clear the entry from the 'unhealthybookies' list.\n\nI'd like to know the suggestion on this approach.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-11T10:06:12.340+0000","updated":"2012-07-11T10:06:12.340+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411383","id":"13411383","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks all for the suggestions and thoughts.\n\nPresently in our code base, we are configuring the \"readTimeout\" in the channel bookie. \nAs Uma suggested I'd also prefer providing \"connectionTimeOut' as a configurable item. Both the re-ordering and \"timeouts\" will help to improve the read performance.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-11T10:25:55.718+0000","updated":"2012-07-11T10:25:55.718+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411389","id":"13411389","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"{quote}\nWith a short timeout, we will possibly have a lot of false positives because a request may have been caused by a transient problem. False positives make maintaining the blacklist difficult.\n{quote}\n\nshort timeout provided the mechanism to quick switch to try next bookie. but it doesn't change read sequence, next read still started from same slow bookie. same long latency needs for following read requests.\n\nre-ordering the read sequence could avoid it. I treated blacklist as a kind of mechanism to achieve re-ordering. I think both needs for read latency.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-11T10:39:24.566+0000","updated":"2012-07-11T10:39:24.566+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13411397","id":"13411397","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"bq.re-ordering the read sequence could avoid it. I treated blacklist as a kind of mechanism to achieve re-ordering\n\nThe attached patch is based on the re-ordering mechanism and treated failed bookies are unhealthy and kept last in the list. \nPlease review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-11T11:12:37.276+0000","updated":"2012-07-11T11:12:37.276+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13412042","id":"13412042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"bq. short timeout provided the mechanism to quick switch to try next bookie. but it doesn't change read sequence, next read still started from same slow bookie. same long latency needs for following read requests.\n\n@sijie In general we have been taking an optimistic approach to reading. If you're not happy with that approach, perhaps we should have a pessimistic approach implemented in a different scheduler so that we can switch between the two.\n\nbq. The attached patch is based on the re-ordering mechanism and treated failed bookies are unhealthy and kept last in the list. \n\n@rakesh Could you post it on the review board, please, Rakesh? I haven't looked at the patch yet, but I'm still wondering if we should have a separate scheduler just so that we still have the option of using the approach we have currently implemented.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-07-11T21:54:12.317+0000","updated":"2012-07-11T21:54:12.317+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13412402","id":"13412402","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"{code}\n@sijie In general we have been taking an optimistic approach to reading. If you're not happy with that approach, perhaps we should have a pessimistic approach implemented in a different scheduler so that we can switch between the two.\n{code}\n\nI think both 're-ordering' and 'timeout' are needed to solve this problem. They resolved the problem in two different aspects.\n\nLet me explaining my understandings as below.\n\nsuppose we have an ensemble (bk1, bk2, bk3). bk1 is slow and it needs 10s to get read response; bk2 and bk3 are fast and it needs 1s to get read response. \n\nfor success case:\n\nusing current strategy: the read needs 10s to get the response.\n'timeout' strategy: suppose we had 5s timeout. we don't received response from bk1 at 5s. it does switch to read entry from bk2. bk2 responded at 1s. we need total 6s to get response.\n're-ordering' strategy: we had some latency statistics to know which bookies are slow (unreachable bookie is a kind of slow bookie whose latency is infinite). now we know bk1 is 10s slow, we start trying reading from bk2. so we just need 1s to get the response.\n\nfor failure case: (suppose bk1 returned failure response after 10s)\n\nusing current strategy: the read first try bk1 and then try bk2. the total time is 11s.\n'timeout' strategy: as above. we need 6s.\n're-ordering' strategy: just need 1s if we had know bk1 is a slow bookie.\n\n\nAs my explanation, 'timeout' resolve the read latency problem when hitting a slow bookie, while 're-ordering' try to avoid hitting a slow bookie based on previous requests' statistics. They are two different aspects of this problem. They doesn't conflict on resolving this issue.\n\nAnd I think we could abstract it to provide different strategies.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-12T00:19:17.479+0000","updated":"2012-07-12T00:19:17.479+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13412417","id":"13412417","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"@Rakesh\n\n{code}\nprivate Set<InetSocketAddress> unhealthyBookies = new HashSet<InetSocketAddress>();\n{code}\n\nseems unhealthyBookies is a local variable in PendingReadOp. so it is only useful for a readEntries request. it doesn't make sense if readEntries are just reading little entries. As my understanding, it would be a shared status across different readEntries requests.\n\n>> bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerEntry.java\n\nfor 're-ordering', it is a read sequence problem. I'd prefer 're-ordering' changes would behind an interface. the interface might just return next bookie to read. and you could put the original solution (in-ordering read sequence) and 're-ordering' solution as different implementation.\n\nas Flavio's suggestion, seems that it could be done in a separated distribution schedule. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-12T00:34:19.359+0000","updated":"2012-07-12T00:34:19.359+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13419056","id":"13419056","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"@Flavio\nbq. Could you post it on the review board, please, Rakesh?\nThere are few more refactoring to be done as part of the comments in the JIRA, Is that ok to post for review after the changes? Also it would be great to see your thoughts on the following refactoring.\n\n\n@Sijie\nbq.as Flavio's suggestion, seems that it could be done in a separated distribution schedule. \n\nYeah, I agree to make more generic to the LedgerHandle level rather than for each LedgerEntry. I feel we should have few more details of the health/proirity of bookies in the DistributionSchedule interface.\n\n----\nFollowing are just my thoughts to refactor the scheduling algo, please have a look and would like to know your opinon?\n*Proposal:*\nI'm just thinking to call this as different scheduling strategies:\n{code}\norg.apache.bookkeeper.client.DistributionSchedule.java\n\n    ScheduleStrategy getScheduleStrategy();\n\n    public enum ScheduleStrategy {\n        ROUNDROBIN, ORDEREDROUNDROBIN;\n    }\n{code}\n\nAlso, introducing new interface(thought of not adding ordering to the existing DistributionSchedule algo). New interface is an extended version of DistributionSchedule, which has the api getBookieIndexes(SchedulerContext) as follows: \n{code}\norg.apache.bookkeeper.client.OrderedDistributionSchedule.java\n\npublic interface OrderedDistributionSchedule extends DistributionSchedule {\n    SchedulerContext getSchedulerContext();\n    /**\n     * Get the bookieIndexes of the given context. This bookie index will be ordered\n     * according to the priority of bookies and high priority bookies will be first\n     * in the list.\n     */\n    public Set<Integer> getBookieIndexes(SchedulerContext schedulerContext);\n\n    public interface SchedulerContext {\n        void setEntryId();\n        void setQuorumSize();\n        void addCurrentEnsemble(ArrayList<InetSocketAddress> ensemble);\n        void addLowPriorityBookie(InetSocketAddress bookieAddr);\n        void removeLowPriorityBookie(InetSocketAddress bookieAddr);\n    }\n}\n{code}\n----\n\nHow the strategies will be used?\n\n{code}\nWill expose the strategy as a configuration item in bk_server.conf like:\nschedulingStrategy=RoundRobin (by default)\nschedulingStrategy=OrderedRoundRobin\n{code}\n\nWhen initializing the LedgerHandle, based on the strategy will create schedulers. Other modules will use like:\n{code}\nif(lh.distributionSchedulegetScheduleStrategy() == ScheduleStrategy.ORDEREDROUNDROBIN)\n           // casting to specifc strategy algo and do necessary operations\n           (OrderedDistributionSchedule)lh.distributionSchedule\n{code}\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-20T11:03:24.385+0000","updated":"2012-07-20T11:03:24.385+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13419081","id":"13419081","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"These are just my thoughts, but I don't think this is the best, since it requires specific typecasting.\n\nAnother simple approach is to modify the existing distributionSchedule interface, this needs dummy implementation to the RRDistributionSchedule algo and other OrderedRRDistributionSchedule algo will have ordered implementation. \n\n\nHi All, Could you please help me to give your ideas as its core part.\n\nThanks, \nRakesh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-20T12:26:12.566+0000","updated":"2012-07-20T12:26:12.566+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13420408","id":"13420408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"@Rakesh, thanks for providing such proposal. \n\nI'd have a different opinion on the interface. *DistributionSchedule* is an interface determines how entries are distributed to store among bookies. It is a strategy how we store the entries but not a strategy how we read/write the entries. For this jira, you are proposing different way to read entries from current strategy deployed in BookKeeper client. so I think we'd need a clean interface how to read entries from an ensemble instead of adding new methods in *DistributionSchedule*.\n\nHow about define an interface as below?\n{code}\ninterface ReadStrategy {\n\n\t/**\n\t * Read entry <ledgerId, entryId>.\n\t * The implementation should handle the logic how to retry reading all replicas.\n\t *\n\t * The entry would be returned in callback' context object.\n\t */\n\tpublic void readEntry(LedgerHandle lh, LedgerEntry entry, ReadEntryCallback callback);\n\n}\n{code} \n\nthe *ReadStrategy* interface provides a method for PendingReadOp to read an entry. the implementations should implement their logics to retry reading all replicas. \n\nyou could move PendingReadOp#sendRead and PendingReadOp#logErrorAndReattemptRead to a default read strategy. And you could implement your re-ordering read logic in a ReorderingReadStrategy.\n\nWhat is your opinion? And Would like to see others' comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-23T03:15:23.941+0000","updated":"2012-07-23T03:15:23.941+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13421380","id":"13421380","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks a lot Sijie for the idea.\n\nHi All, I've uploaded latest patch which defines the following read strategies and is maintianed in distribution schedule. Please have a look.\n- ReadStrategy\n -- SimpleReadStrategy\n -- OrderedReadStrategy\n\n-Rakesh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-24T13:06:00.684+0000","updated":"2012-07-24T13:06:00.684+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13421992","id":"13421992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"review board: https://reviews.apache.org/r/6128/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-07-25T04:15:00.706+0000","updated":"2012-07-25T04:15:00.706+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13422013","id":"13422013","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"I had added my comments in review board : https://reviews.apache.org/r/6128/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-07-25T05:28:13.521+0000","updated":"2012-07-25T05:29:16.789+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13429286","id":"13429286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"I'd prefer to only have one implementation of the reading schedule, which covers all usecases, and that it is completely encapsulated in PendingReadOp. Flavio and I discussed this last week and came up with something like the following (it has changed a little since I've thought about it more).\n\nFor each bookie, record the response time of the last read request. When making a read request, if the last response time for the replica is greater than a configured threshold, make the read request for the next replica also. \n\nTo do this, we maintain a array of int in PendingReadOp, int[] responseTimes = new int[ensembleSize]; \nThe response time can be UNKNOWN, PENDING, or a positive integer.\nInitially all will be initialized to UNKNOWN. When a read request is made to a bookie, we check the response time. If it is UNKNOWN, we make the request to the bookie, and to the next bookie also. If is PENDING, we do not send to the bookie, but we do send to the next bookie. If it is a positive int, we check it against the threshold and send to the next bookie also if it exceeds the threshold. \n\n\nThis does mean quite a large change to PendingReadOp, as at the moment it tries to read all entries in parallel. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-08-06T17:40:07.577+0000","updated":"2012-08-06T17:40:07.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13430953","id":"13430953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"@Ivan Thanks a lot for the new idea. Just few clarifications.\n\nbq. I'd prefer to only have one implementation of the reading schedule\n@Flavio @Sijie\nWould like to know your opinion on this. As we had talked about to have a separate scheduling algo for the perf oriented strategies?\n\n\nbq.When making a read request, if the last response time for the replica is greater than a configured threshold, make the read request for the next replica also.\n\nYou are suggesting to have parallel reads and whoever wins will send the result back to the client. Also collect statistics of the previous reads.\n\nWill the parallel read (to the quorum bookies) makes the bkserver busy/exhaust with many read requests ?\n\n\nbq.To do this, we maintain a array of int in PendingReadOp, int[] responseTimes = new int[ensembleSize]; \n\nSince PendingReadOp is for single entry, bookie statistics should be maintained behind and in the bkclient like, \nHashSet bkResponseTimes <InetAddress, Integer> = new HashSet <InetAddress, Integer>(). \nWhen reading, it justs initialize the PendingReadOp with previous statistics(UNKNOWN/PENDING/+ve integer) and will send the requests to the bookie which has good response time. Also I feel, the bookies can be reordered based on the statistics by sending request to the good/fast bookies first.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-08-08T08:52:00.839+0000","updated":"2012-08-08T08:52:00.839+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13430955","id":"13430955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"oops..just few correction. Please read the datastructure as \nHashMap<InetAddress, Integer> bkResponseTimes = new HashMap <InetAddress, Integer>();","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-08-08T08:56:10.842+0000","updated":"2012-08-08T08:56:10.842+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13430991","id":"13430991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"{quote}\n Would like to know your opinion on this. As we had talked about to have a separate scheduling algo for the perf oriented strategies?\n{quote}\n\n@Rekesh, @Ivan:\n\nI think we still need a clean interface ReadStrategy to allow the possibility to provide different read strategies. For code maintain, it would be better to have only one read strategy in codebase.\n\n{quote}\nTo do this, we maintain a array of int in PendingReadOp, int[] responseTimes = new int[ensembleSize]; \nThe response time can be UNKNOWN, PENDING, or a positive integer.\nInitially all will be initialized to UNKNOWN. When a read request is made to a bookie, we check the response time. If it is UNKNOWN, we make the request to the bookie, and to the next bookie also. If is PENDING, we do not send to the bookie, but we do send to the next bookie. If it is a positive int, we check it against the threshold and send to the next bookie also if it exceeds the threshold.\n{quote}\n\nit did the 'timeout' part as my previous comment. If we choose bookie to start reading according to the response time, it would be kind of 're-order'. the idea matches my previous comment. I am OK with it.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-08T09:56:21.305+0000","updated":"2012-08-08T09:56:21.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13431730","id":"13431730","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"My previously suggested solution won't work with the current implementation of PendingReadOp. We read all entries in parallel, so we can't decide whether to make more than one read based on previous reads. Generally, all read requests are sent at the start, so there'll never be an opportunity to make the decision. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-08-09T10:49:27.787+0000","updated":"2012-08-09T10:49:27.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13431793","id":"13431793","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"ah, if the responseTimes is only internal structure for a read operation. it doesn't help make the decision. but if the responseTimes is a kind of statistics shared by the client, it would help.\n\nIvan's comment reminder me that there might be a problem for 're-order' Rakesh proposed.\n\ncurrently, the read requests for a bunch of entries would be issued round-robin way, which balanced the load. if 're-order' as proposed, the read requests load might be not balanced. so 're-order' may improve nothing but introduced complexity.\n\nseems timeout is a simple and straightforward solution. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-08-09T13:21:07.760+0000","updated":"2012-08-09T13:21:07.760+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13431915","id":"13431915","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"Yes, i think having a timeout is the most straightforward solution to this. As kicking off all reads requests at the same time, we won't have to wait on the timeout for each individual request as I had initially thought. We can have this timeout as configurable, but I think that 2 seconds is a reasonable default. \n\n- Kick off a timer at end of PendingReadOp#initiate()\n- When timer times out, iterate through PendingReadOp#seq.\n   - For each entry, if not completed, kick off next speculative read\n- Set timer again\n\nWe must allow a response from either of the read requests to complete the entry. We also have to modify error handling to only propagate to client if all read requests have failed. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-08-09T15:43:04.545+0000","updated":"2012-08-09T15:43:04.545+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13432370","id":"13432370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"It sounds like we cannot avoid an extra timeout unless we send a read request for a given entry to all replicas in parallel (we assume that at least one will be available; if not, the request will eventually fail). Consequently, it sounds like we need a timeout in the way Ivan is proposing.\n\nI'm not against having another scheme that enables parallel read requests for the same entry of a ledger. It is a way of trading throughput for latency upon crash events. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-08-10T01:31:44.102+0000","updated":"2012-08-10T01:31:44.102+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13439610","id":"13439610","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"I've attached a first draft at the proposed fix. There's still a few things missing, such as the timeout is hardcoded now, and there's no testing yet, so I really don't know how well it works. All current tests pass though.\n\nhttps://github.com/ivankelly/bookkeeper/tree/BOOKKEEPER-336","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-08-22T15:25:49.476+0000","updated":"2012-08-22T15:25:49.476+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13481040","id":"13481040","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"Hi Ivan, The idea of timeout approach also works well and improves read perf.\n\nJust to conclude our discussion, the following approaches has been discussed so far.\n- reordering of bkclients based on health\n- read timeouts with sequential reads\n- read timeouts with parallel reads\n- provide multiple read schemes\n\nHi All, Could you please give your vote to select better one:-)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-10-21T19:49:51.966+0000","updated":"2012-10-21T19:49:51.966+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13481481","id":"13481481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"I think \"read timeouts with parallel reads\" is best, and i've already implemented it. I'll try to add tests this week.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-22T16:27:57.641+0000","updated":"2012-10-22T16:27:57.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13482028","id":"13482028","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stuhood","name":"stuhood","key":"stuhood","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stuhood&avatarId=10049","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stuhood&avatarId=10049","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stuhood&avatarId=10049","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stuhood&avatarId=10049"},"displayName":"Stu Hood","active":true,"timeZone":"America/Los_Angeles"},"body":"bq. I think \"read timeouts with parallel reads\" is best, and i've already implemented it.\n+1. This is the simplest place to start, and gives the best benefits for availability and latency. Optimizations for throughput can come later.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stuhood","name":"stuhood","key":"stuhood","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=stuhood&avatarId=10049","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stuhood&avatarId=10049","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stuhood&avatarId=10049","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stuhood&avatarId=10049"},"displayName":"Stu Hood","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-10-23T01:45:29.457+0000","updated":"2012-10-23T01:45:29.457+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13483042","id":"13483042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks Ivan, Stud for the participation. I also agree to go with read timeouts.\n\nI could see the parallel read to quorum bookies would make the bkserver busy/exhaust with many read requests and may affect the write latency in worst case. But good thing is, we have BOOKKEEPER-429 idea of separate read/write threads, this would help us in latency and IMO this issue also go together.\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-10-24T07:18:23.048+0000","updated":"2012-10-24T07:18:23.048+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13485072","id":"13485072","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"Added tests and made configurable. Ready for review","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-26T17:51:47.569+0000","updated":"2012-10-26T17:51:47.569+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13485074","id":"13485074","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"https://reviews.apache.org/r/7749/\n\nrequires BOOKKEEPER-444 to apply","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-26T17:55:26.638+0000","updated":"2012-10-26T17:55:26.638+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13485698","id":"13485698","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"Thanks Ivan for the patch and BitSet usage is very nice. I've added few comments in review board, could you please have a look.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-10-28T19:47:02.994+0000","updated":"2012-10-28T19:47:02.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13487890","id":"13487890","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"I've just realized I posted the wrong patch. The proper patch already addressed most of your comments, plus it had tests. Ive updated on reviewboard and here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-31T16:00:26.526+0000","updated":"2012-10-31T16:00:26.526+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13488016","id":"13488016","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"new patch switches back where the timer is started, but the requestsSent flag wasnt needed anyhow. Also, there was a possible ConcurrentModificationException. Fixed by switching to ArrayBlockingQueue","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-10-31T17:57:01.441+0000","updated":"2012-10-31T17:57:01.441+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13504619","id":"13504619","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"Testing JIRA BOOKKEEPER-336\n\nWARNING: Running test-patch on a dirty local svn workspace\n\nPatch <a href=\"/jira/secure/attachment/12551593/0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch\">/jira/secure/attachment/12551593/0002-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch</a> downloaded at Tue Nov 27 13:19:57 UTC 2012\n\n----------------------------\n\n{color:green}+1 PATCH_APPLIES{color}\n{color:green}+1 CLEAN{color}\n{color:red}-1 RAW_PATCH_ANALYSIS{color}\n.    {color:green}+1{color} the patch does not introduce any @author tags\n.    {color:green}+1{color} the patch does not introduce any tabs\n.    {color:red}-1{color} the patch contains 8 line(s) with trailing spaces\n.    {color:green}+1{color} the patch does not introduce any line longer than 120\n.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)\n{color:green}+1 RAT{color}\n.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings\n{color:red}-1 JAVADOC{color}\n.    {color:red}-1{color} the patch seems to introduce 1 new Javadoc warning(s)\n.    {color:red}WARNING{color}: the current HEAD has 8 Javadoc warning(s)\n{color:green}+1 COMPILE{color}\n.    {color:green}+1{color} HEAD compiles\n.    {color:green}+1{color} patch compiles\n.    {color:green}+1{color} the patch does not seem to introduce new javac warnings\n.    {color:red}WARNING{color}: the current HEAD has 9 javac warning(s)\n{color:green}+1 FINDBUGS{color}\n.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings\n.    {color:red}WARNING: the current HEAD has  Findbugs warning(s), they should be addressed ASAP{color}\n{color:green}+1 TESTS{color}\n.    Tests run: 397\n{color:green}+1 DISTRO{color}\n.    {color:green}+1{color} distro tarball builds with the patch \n\n----------------------------\n{color:red}*-1 Overall result, please check the reported -1(s)*{color}\n\n{color:red}.   There is at least one warning, please check{color}\n\nThe full output of the test-patch run is available at\n\n.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/37/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-11-27T13:42:23.245+0000","updated":"2012-11-27T13:42:23.245+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13507416","id":"13507416","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"New patch fixes precommit complaints.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-11-30T16:24:28.297+0000","updated":"2012-11-30T16:24:28.297+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13507448","id":"13507448","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"Testing JIRA BOOKKEEPER-336\n\nWARNING: Running test-patch on a dirty local svn workspace\n\nPatch <a href=\"/jira/secure/attachment/12555517/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch\">/jira/secure/attachment/12555517/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch</a> downloaded at Fri Nov 30 16:31:14 UTC 2012\n\n----------------------------\n\n{color:green}+1 PATCH_APPLIES{color}\n{color:green}+1 CLEAN{color}\n{color:red}-1 RAW_PATCH_ANALYSIS{color}\n.    {color:green}+1{color} the patch does not introduce any @author tags\n.    {color:green}+1{color} the patch does not introduce any tabs\n.    {color:red}-1{color} the patch contains 1 line(s) with trailing spaces\n.    {color:green}+1{color} the patch does not introduce any line longer than 120\n.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)\n{color:green}+1 RAT{color}\n.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings\n{color:green}+1 JAVADOC{color}\n.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings\n{color:green}+1 COMPILE{color}\n.    {color:green}+1{color} HEAD compiles\n.    {color:green}+1{color} patch compiles\n.    {color:green}+1{color} the patch does not seem to introduce new javac warnings\n{color:green}+1 FINDBUGS{color}\n.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings\n.    {color:red}WARNING: the current HEAD has  Findbugs warning(s), they should be addressed ASAP{color}\n{color:green}+1 TESTS{color}\n.    Tests run: 391\n{color:green}+1 DISTRO{color}\n.    {color:green}+1{color} distro tarball builds with the patch \n\n----------------------------\n{color:red}*-1 Overall result, please check the reported -1(s)*{color}\n\n{color:red}.   There is at least one warning, please check{color}\n\nThe full output of the test-patch run is available at\n\n.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/56/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-11-30T16:56:34.731+0000","updated":"2012-11-30T16:56:34.731+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13508654","id":"13508654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"Testing JIRA BOOKKEEPER-336\n\nWARNING: Running test-patch on a dirty local svn workspace\n\nPatch <a href=\"/jira/secure/attachment/12555734/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch\">/jira/secure/attachment/12555734/0001-BOOKKEEPER-336-bookie-readEntries-is-taking-more-tim.patch</a> downloaded at Mon Dec  3 10:52:06 UTC 2012\n\n----------------------------\n\n{color:green}+1 PATCH_APPLIES{color}\n{color:green}+1 CLEAN{color}\n{color:green}+1 RAW_PATCH_ANALYSIS{color}\n.    {color:green}+1{color} the patch does not introduce any @author tags\n.    {color:green}+1{color} the patch does not introduce any tabs\n.    {color:green}+1{color} the patch does not introduce any trailing spaces\n.    {color:green}+1{color} the patch does not introduce any line longer than 120\n.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)\n{color:green}+1 RAT{color}\n.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings\n{color:green}+1 JAVADOC{color}\n.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings\n{color:green}+1 COMPILE{color}\n.    {color:green}+1{color} HEAD compiles\n.    {color:green}+1{color} patch compiles\n.    {color:green}+1{color} the patch does not seem to introduce new javac warnings\n{color:green}+1 FINDBUGS{color}\n.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings\n{color:green}+1 TESTS{color}\n.    Tests run: 394\n{color:green}+1 DISTRO{color}\n.    {color:green}+1{color} distro tarball builds with the patch \n\n----------------------------\n{color:green}*+1 Overall result, good!, no -1s*{color}\n\n\nThe full output of the test-patch run is available at\n\n.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/64/","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-03T11:16:14.100+0000","updated":"2012-12-03T11:16:14.100+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13508940","id":"13508940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"body":"Good work Ivan, +1 for the speculative reads.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rakeshr","name":"rakeshr","key":"rakeshr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rakeshr&avatarId=29267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rakeshr&avatarId=29267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rakeshr&avatarId=29267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rakeshr&avatarId=29267"},"displayName":"Rakesh Radhakrishnan","active":true,"timeZone":"Asia/Kolkata"},"created":"2012-12-03T18:56:33.739+0000","updated":"2012-12-03T18:56:33.739+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13509524","id":"13509524","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in bookkeeper-trunk #836 (See [https://builds.apache.org/job/bookkeeper-trunk/836/])\n    [REVERT] BOOKKEEPER-336 bookie readEntries is taking more time if the ensemble has failed bookie(s) Basic speculative functionality  in place\nAccidently committed this change, before approval. Reverting (ivank) (Revision 1416408)\nBOOKKEEPER-336 bookie readEntries is taking more time if the ensemble has failed bookie(s) Basic speculative functionality  in place (Revision 1416393)\n\n     Result = FAILURE\nivank : \nFiles : \n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java\n\nivank : \nFiles : \n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-04T05:44:44.272+0000","updated":"2012-12-04T05:44:44.272+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13527900","id":"13527900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Overall it looks pretty good. I have a number of comments, not necessarily blockers for this patch:\n\n# In the case the digest of an entry doesn't match, we will discard the entry, although we have heard from the bookie. Consequently, we need to request another entry, and possibly this is handled through a different code path. Is it the case? In the case there is a different code path to deal with invalid entries, we may want to consider coalescing them as much as possible. \n# It would be great to add documentation for the new parameter and to update conf/bk_server.conf\n# The default value for the speculative read seems a large. Is there any reason why we shouldn't be a bit more aggressive with the default value, especially because we can turn off speculative reads altogether?\n# Please fix typos in the comments. I've seen at least a couple, like \"functionallity\".\n# In the future, it might be a good idea to use failure detection techniques like phi accrual for the speculative read timeout instead of having a fixed value. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-10T12:22:59.037+0000","updated":"2012-12-10T12:22:59.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13527902","id":"13527902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Sorting out comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-10T12:23:18.931+0000","updated":"2012-12-10T12:23:18.931+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13527962","id":"13527962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"{quote}\n1. In the case the digest of an entry doesn't match, we will discard the entry, although we have heard from the bookie. Consequently, we need to request another entry, and possibly this is handled through a different code path. Is it the case? In the case there is a different code path to deal with invalid entries, we may want to consider coalescing them as much as possible.{quote}\nIn the case of a digest fail, it will go through the same path as before. i.e. it will try the next replica anyhow.\n\n\n{quote}2. It would be great to add documentation for the new parameter and to update conf/bk_server.conf{quote}\nThe option is client side only so it doesn't belong in bk_server.conf. Will add something in bookkeeperConfigParams.textile.\n\n{quote}3. The default value for the speculative read seems a large. Is there any reason why we shouldn't be a bit more aggressive with the default value, especially because we can turn off speculative reads altogether?{quote}\nIt's much lower than connection timeout which is what was being hit originally (10 seconds). I have no problem with lowering it, but at this stage selecting a default value is guess work, and 2s seems reasonable to me.\n\n{quote}4. Please fix typos in the comments. I've seen at least a couple, like \"functionallity\".{quote}\nWill fix and put up a new patch.\n\n{quote}\n5. In the future, it might be a good idea to use failure detection techniques like phi accrual for the speculative read timeout instead of having a fixed value.\n{quote}\nThis would be nice. Has this stuff gone into ZK yet, perhaps we could reuse some of that code. In any case, future work.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-10T14:38:54.265+0000","updated":"2012-12-10T14:38:54.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13527969","id":"13527969","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"bq. The option is client side only so it doesn't belong in bk_server.conf.\n\nYou're right, my bad.\n\nbq. This would be nice. Has this stuff gone into ZK yet, perhaps we could reuse some of that code. In any case, future work.\n\nNo, it implied too many changes and the guy who did it didn't push very hard either. Here it would be a lot more focused, so less of a concern.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-10T14:54:26.591+0000","updated":"2012-12-10T14:54:26.591+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13528124","id":"13528124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"two comments about the patch.\n\n1. Using Timer per reading op is not a good idea, because each timer would create a thread associated with it. Image that there are lots of ledgers being used (e.g. Hedwig case), there might be lot of threads created, which is bad. I would suggest using (maybe reuse existing one) ScheduledExecutorService to schedule speculative reads instead of creating a new timer each time.\n\n2. could you define -1 to meaningful constants? it might make code more readable.\n\notherwise, the remaining part of the patch looks good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-12-10T18:20:35.581+0000","updated":"2012-12-10T18:20:35.581+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13530314","id":"13530314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"new patch addresses comments.\n\n[~hustlmsp] I couldn't remove all the -1s as some come from List#indexOf.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-12T20:50:20.230+0000","updated":"2012-12-12T20:50:20.230+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13530697","id":"13530697","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"{quote}\nI couldn't remove all the -1s as some come from List#indexOf.\n{quote}\n\nSounds OK for me.\n\n+1 for the new patch. Great work, Ivan. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2012-12-13T05:31:41.641+0000","updated":"2012-12-13T05:31:41.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13530939","id":"13530939","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"Committed as r1421242. Thanks for reviewing guys.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-13T12:08:30.794+0000","updated":"2012-12-13T12:08:30.794+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13530941","id":"13530941","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"I had to manually merge with BOOKKEEPER-365. Attaching final patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2012-12-13T12:12:06.103+0000","updated":"2012-12-13T12:12:06.103+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598127/comment/13532102","id":"13532102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"body":"Integrated in bookkeeper-trunk #860 (See [https://builds.apache.org/job/bookkeeper-trunk/860/])\n    BOOKKEEPER-336: bookie readEntries is taking more time if the ensemble has failed bookie(s) (ivank) (Revision 1421242)\n\n     Result = FAILURE\nivank : \nFiles : \n* /zookeeper/bookkeeper/trunk/CHANGES.txt\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcher.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java\n* /zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","key":"hudson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true,"timeZone":"Etc/UTC"},"created":"2012-12-14T06:51:27.627+0000","updated":"2012-12-14T06:51:27.627+0000"}],"maxResults":57,"total":57,"startAt":0},"customfield_12311820":"0|i0auif:","customfield_12314139":null}}

