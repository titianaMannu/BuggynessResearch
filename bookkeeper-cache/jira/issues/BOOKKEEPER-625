{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12652803","self":"https://issues.apache.org/jira/rest/api/2/issue/12652803","key":"BOOKKEEPER-625","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324601","id":"12324601","name":"4.2.2","archived":false,"released":true,"releaseDate":"2013-10-10"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"333126","customfield_12312320":null,"customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323840","id":"12323840","description":"Bug fix release for 4.2 branch","name":"4.2.1","archived":false,"released":true,"releaseDate":"2013-03-27"}],"customfield_12311120":null,"customfield_12313826":null,"issuelinks":[],"customfield_12312339":null,"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12314394","id":"12314394","name":"bookkeeper-server","description":"Bookkeeper server."}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"333454","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/BOOKKEEPER-625/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@14bcf765[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47678933[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@34a6a0ce[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4ff39978[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@28e98754[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7ceb4447[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7d4a3bc4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2ea1554c[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4a16b4eb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6cf91892[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40418ad2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@64eeaca3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12311293","id":"12311293","key":"BOOKKEEPER","name":"Bookkeeper","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12311293&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311293&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311293&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311293&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/14780","id":"14780","description":"BookKeeper","name":"BookKeeper"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2013-07-24T12:16:30.833+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/BOOKKEEPER-625/watchers","watchCount":7,"isWatching":false},"created":"2013-06-14T04:45:58.979+0000","updated":"2013-07-24T12:16:30.859+0000","timeoriginalestimate":null,"description":"Observed OutOfMemoryError in NIOServerFactory, but it didnt bring down the bookie and it continued to run without serving. \n\nOn OOME in any thread, bookie should shutdown.","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12593921","id":"12593921","filename":"BOOKKEEPER-625-branch-4.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-07-24T11:00:55.903+0000","size":973,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12593921/BOOKKEEPER-625-branch-4.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12593854","id":"12593854","filename":"BOOKKEEPER-625-branch-4.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-07-24T05:03:51.620+0000","size":972,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12593854/BOOKKEEPER-625-branch-4.2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12588581","id":"12588581","filename":"BOOKKEEPER-625-branch-4.2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-06-19T11:49:39.948+0000","size":544,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12588581/BOOKKEEPER-625-branch-4.2.patch"}],"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"On OutOfMemoryError in NIOServerFactory thread bookie should shutdown","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12311024":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13683101","id":"13683101","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"body":"This can happen in any thread. Handling OOM in all threads and shutting down may not be a correct option I guess.\none option is : -XX:OnOutOfMemoryError=\"kill -9 %p\" which will shutdown the process automatically on getting OOME. But this is not graceful as we pass 'kill -9'\nWe can discuss more if we think we must go gracefully only. or using UncaughtExceptionHandler can do gracefully? (but I did not use UncaughtExceptionHandler in my past experience)\n\nThoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=umamaheswararao","name":"umamaheswararao","key":"umamaheswararao","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uma Maheswara Rao G","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-14T05:27:37.366+0000","updated":"2013-06-14T05:27:37.366+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13683183","id":"13683183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"Do you know why it happened? It doesn't sound right to add code to deal with out of memory exceptions because it is really an anomalous situation. If we have a bug that is causing the bookie to run out of memory, then we need to track the bug. Is it something that has happened multiple times or just once? If it is reproducible, then we can try to fix what caused it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2013-06-14T08:10:56.197+0000","updated":"2013-06-14T08:10:56.197+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13683233","id":"13683233","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Yeah Agree to both of you.. we cannot handle the OOME for all threads..\n\nThe Actual intention I rised the Jira is, \nSince the NIOServerFactory is the basic thread which should be running to keep the BookieServer process running, we should avoid situations where this thread is not present and BookieServer process is still running.\nCurrently all exceptions are catched inside {{NIOServerFactory.run()}}, but still thread can exit due to errors such as OOME.\n\nIn one of our cluster, OOME came in NIOServerFactory thread and that thread exited. But user didnt know the problem because process was still running.\n\nbq. It doesn't sound right to add code to deal with out of memory exceptions because it is really an anomalous situation.\nYes I agree. But one simple call to check the thread availability inside {{NIOServerFactory.isRunning()}} will solve the problem. As follows\n{code:java}    public boolean isRunning() {\n        return !ss.socket().isClosed() && isAlive();\n    }{code}\n\nSimilar check we can add for other critical threads, without which keeping the process alive is useless.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-06-14T09:19:27.295+0000","updated":"2013-06-14T09:19:27.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13683239","id":"13683239","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"For 4.3.0 at least we will be using netty instead, right? BOOKKEEPER-555","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2013-06-14T09:28:04.444+0000","updated":"2013-06-14T09:28:04.444+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13687896","id":"13687896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Attached the patch for branch-4.2\n\nNot able to write the test because there was no way we can stop NIO thread without closing socket in tests. Also OOM is not possible in Tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-06-19T11:49:39.951+0000","updated":"2013-06-19T11:49:39.951+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13687929","id":"13687929","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"Testing JIRA BOOKKEEPER-625\n\n\nPatch [BOOKKEEPER-625-branch-4.2.patch|https://issues.apache.org/jira/secure/attachment/12588581/BOOKKEEPER-625-branch-4.2.patch] downloaded at Wed Jun 19 12:33:56 UTC 2013\n\n----------------------------\n\n{color:red}-1{color} Patch failed to apply to head of branch\n\n----------------------------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2013-06-19T12:35:48.199+0000","updated":"2013-06-19T12:35:48.199+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13688931","id":"13688931","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"body":"I am interested on why OOM happened. it would be good if you had information why this happened. otherwise, the patch looks good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hustlmsp","name":"hustlmsp","key":"hustlmsp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sijie Guo","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-06-20T06:43:47.151+0000","updated":"2013-06-20T06:43:47.151+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13689018","id":"13689018","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"In one of our cluster -XX:MaxDirectMemorySize=64M was set for testing GC OPTS. So due to increase in the number of ledgers directbuffer memory usage got increased and got OOME.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-06-20T08:40:43.651+0000","updated":"2013-06-20T08:40:43.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13689822","id":"13689822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"body":"I think jira should be more about how to deal with exception in NIOServerFactory, no? In b4.2, we just issue a warn message upon an exception and perhaps this is ok as long as the socket is still open. In the case of an error, I'm wondering if we should consider shutting down. Is that overkill?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fpj","name":"fpj","key":"fpj","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fpj&avatarId=16030","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fpj&avatarId=16030","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fpj&avatarId=16030","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fpj&avatarId=16030"},"displayName":"Flavio Paiva Junqueira","active":true,"timeZone":"Europe/Berlin"},"created":"2013-06-20T23:16:13.762+0000","updated":"2013-06-20T23:16:13.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13697999","id":"13697999","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"With this patch the process will just exit silently, no?\n\nCouldn't we also change the catch on line 158 to take a Throwable rather than an Exception. This way, it will at least attempt to inform the user of the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2013-07-02T17:15:36.455+0000","updated":"2013-07-02T17:15:36.455+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13714354","id":"13714354","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Sorry for the late reply.\n{quote}With this patch the process will just exit silently, no?\nCouldn't we also change the catch on line 158 to take a Throwable rather than an Exception. This way, it will at least attempt to inform the user of the problem.{quote}\n\n[~aivanise] Yes, process will exit silently. But anyway console logs will have the OutOfMemory information. \nIf we catch Throwable instead of Exception, then it will just avoid the thread exit, but It may not reduce the memory used and we may get OOME for every call.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-07-20T06:30:16.354+0000","updated":"2013-07-20T06:30:16.354+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13716535","id":"13716535","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"I wasn't suggesting that we catch and log and stop there. We should catch, log and then break out of the loop. That way there will be something in the server log and not just the console.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2013-07-23T16:14:59.259+0000","updated":"2013-07-23T16:14:59.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13717987","id":"13717987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"hi Ivan, \ni have updated the patch with your comments. Please have a look, Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-07-24T05:03:51.623+0000","updated":"2013-07-24T05:03:51.623+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13717992","id":"13717992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"body":"Testing JIRA BOOKKEEPER-625\n\n\nPatch [BOOKKEEPER-625-branch-4.2.patch|https://issues.apache.org/jira/secure/attachment/12593854/BOOKKEEPER-625-branch-4.2.patch] downloaded at Wed Jul 24 05:12:05 UTC 2013\n\n----------------------------\n\n{color:red}-1{color} Patch failed to apply to head of branch\n\n----------------------------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hadoopqa","name":"hadoopqa","key":"hadoopqa","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hadoopqa&avatarId=10393","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hadoopqa&avatarId=10393","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hadoopqa&avatarId=10393","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hadoopqa&avatarId=10393"},"displayName":"Hadoop QA","active":true,"timeZone":"Etc/UTC"},"created":"2013-07-24T05:13:58.833+0000","updated":"2013-07-24T05:13:58.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13718220","id":"13718220","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"One small nit. The logging should be a LOG.error instead of a LOG.warn. If you agree, I can make the change as I commit it changes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2013-07-24T10:51:29.343+0000","updated":"2013-07-24T10:51:29.343+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13718228","id":"13718228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"body":"Oops... Thanks Ivan for pointing it out. Here is the updated patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vinayakumarb","name":"vinayakumarb","key":"vinayrpet","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=34044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"},"displayName":"Vinayakumar B","active":true,"timeZone":"Asia/Kolkata"},"created":"2013-07-24T11:00:55.906+0000","updated":"2013-07-24T11:00:55.906+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13718291","id":"13718291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"Great. Patch is good. +1. Committing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2013-07-24T12:13:57.968+0000","updated":"2013-07-24T12:13:57.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12652803/comment/13718294","id":"13718294","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"body":"Committed revision 1506513. Thanks Vinay.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ikelly","name":"ikelly","key":"ikelly","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ivan Kelly","active":true,"timeZone":"Europe/Berlin"},"created":"2013-07-24T12:16:30.856+0000","updated":"2013-07-24T12:16:30.856+0000"}],"maxResults":18,"total":18,"startAt":0},"customfield_12311820":"0|i1lgtb:","customfield_12314139":null}}

