{"sha":"800e6bb90c78eff85a3194ccbc31cec9381964e4","node_id":"MDQ6QmxvYjE1NzU5NTY6ODAwZTZiYjkwYzc4ZWZmODVhMzE5NGNjYmMzMWNlYzkzODE5NjRlNA==","size":5727,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/800e6bb90c78eff85a3194ccbc31cec9381964e4","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEuaW8uSU9F\neGNlcHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmpteC5C\nS01CZWFuSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2tpZVByb3RvY29sOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnV0aWwuU25hcHNob3RNYXA7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CgppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoq\nCiAqIEludGVybGVhdmUgbGVkZ2VyIHN0b3JhZ2UKICogVGhpcyBsZWRnZXIg\nc3RvcmFnZSBpbXBsZW1lbnRhdGlvbiBzdG9yZXMgYWxsIGVudHJpZXMgaW4g\nYSBzaW5nbGUKICogZmlsZSBhbmQgbWFpbnRhaW5zIGFuIGluZGV4IGZpbGUg\nZm9yIGVhY2ggbGVkZ2VyLgogKi8KY2xhc3MgSW50ZXJsZWF2ZWRMZWRnZXJT\ndG9yYWdlIGltcGxlbWVudHMgTGVkZ2VyU3RvcmFnZSB7CiAgICBmaW5hbCBz\ndGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKElu\ndGVybGVhdmVkTGVkZ2VyU3RvcmFnZS5jbGFzcyk7CgogICAgRW50cnlMb2dn\nZXIgZW50cnlMb2dnZXI7CiAgICBMZWRnZXJDYWNoZSBsZWRnZXJDYWNoZTsK\nCiAgICAvLyBBIHNvcnRlZCBtYXAgdG8gc3RvcmVkIGFsbCBhY3RpdmUgbGVk\nZ2VyIGlkcwogICAgcHJvdGVjdGVkIGZpbmFsIFNuYXBzaG90TWFwPExvbmcs\nIEJvb2xlYW4+IGFjdGl2ZUxlZGdlcnM7CgogICAgLy8gVGhpcyBpcyB0aGUg\ndGhyZWFkIHRoYXQgZ2FyYmFnZSBjb2xsZWN0cyB0aGUgZW50cnkgbG9ncyB0\naGF0IGRvIG5vdAogICAgLy8gY29udGFpbiBhbnkgYWN0aXZlIGxlZGdlcnMg\naW4gdGhlbTsgYW5kIGNvbXBhY3RzIHRoZSBlbnRyeSBsb2dzIHRoYXQKICAg\nIC8vIGhhcyBsb3dlciByZW1haW5pbmcgcGVyY2VudGFnZSB0byByZWNsYWlt\nIGRpc2sgc3BhY2UuCiAgICBmaW5hbCBHYXJiYWdlQ29sbGVjdG9yVGhyZWFk\nIGdjVGhyZWFkOwoKICAgIEludGVybGVhdmVkTGVkZ2VyU3RvcmFnZShTZXJ2\nZXJDb25maWd1cmF0aW9uIGNvbmYsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgTGVkZ2VyTWFuYWdlciBsZWRnZXJNYW5hZ2VyLCBMZWRnZXJEaXJz\nTWFuYWdlciBsZWRnZXJEaXJzTWFuYWdlcikKCQkJdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBhY3RpdmVMZWRnZXJzID0gbmV3IFNuYXBzaG90TWFw\nPExvbmcsIEJvb2xlYW4+KCk7CiAgICAgICAgZW50cnlMb2dnZXIgPSBuZXcg\nRW50cnlMb2dnZXIoY29uZiwgbGVkZ2VyRGlyc01hbmFnZXIpOwogICAgICAg\nIGxlZGdlckNhY2hlID0gbmV3IExlZGdlckNhY2hlSW1wbChjb25mLCBhY3Rp\ndmVMZWRnZXJzLCBsZWRnZXJEaXJzTWFuYWdlcik7CiAgICAgICAgZ2NUaHJl\nYWQgPSBuZXcgR2FyYmFnZUNvbGxlY3RvclRocmVhZChjb25mLCBsZWRnZXJD\nYWNoZSwgZW50cnlMb2dnZXIsCiAgICAgICAgICAgICAgICBhY3RpdmVMZWRn\nZXJzLCBsZWRnZXJNYW5hZ2VyKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyB2b2lkIHN0YXJ0KCkgewogICAgICAgIGdjVGhyZWFkLnN0YXJ0\nKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzaHV0\nZG93bigpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAg\nLy8gc2h1dCBkb3duIGdjIHRocmVhZCwgd2hpY2ggZGVwZW5kcyBvbiB6b29r\nZWVwZXIgY2xpZW50CiAgICAgICAgLy8gYWxzbyBjb21wYWN0aW9uIHdpbGwg\nd3JpdGUgZW50cmllcyBhZ2FpbiB0byBlbnRyeSBsb2cgZmlsZQogICAgICAg\nIGdjVGhyZWFkLnNodXRkb3duKCk7CiAgICAgICAgZW50cnlMb2dnZXIuc2h1\ndGRvd24oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBsZWRnZXJDYWNo\nZS5jbG9zZSgpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJvciB3aGlsZSBjbG9zaW5nIHRo\nZSBsZWRnZXIgY2FjaGUiLCBlKTsKICAgICAgICB9CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBzZXRGZW5jZWQobG9uZyBsZWRn\nZXJJZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbGVk\nZ2VyQ2FjaGUuc2V0RmVuY2VkKGxlZGdlcklkKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyBib29sZWFuIGlzRmVuY2VkKGxvbmcgbGVkZ2Vy\nSWQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGxlZGdl\nckNhY2hlLmlzRmVuY2VkKGxlZGdlcklkKTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIHNldE1hc3RlcktleShsb25nIGxlZGdlcklk\nLCBieXRlW10gbWFzdGVyS2V5KSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgIGxlZGdlckNhY2hlLnNldE1hc3RlcktleShsZWRnZXJJZCwgbWFzdGVy\nS2V5KTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBieXRlW10g\ncmVhZE1hc3RlcktleShsb25nIGxlZGdlcklkKSB0aHJvd3MgSU9FeGNlcHRp\nb24sIEJvb2tpZUV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGxlZGdlckNh\nY2hlLnJlYWRNYXN0ZXJLZXkobGVkZ2VySWQpOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIGJvb2xlYW4gbGVkZ2VyRXhpc3RzKGxvbmcgbGVk\nZ2VySWQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGxl\nZGdlckNhY2hlLmxlZGdlckV4aXN0cyhsZWRnZXJJZCk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBzeW5jaHJvbml6ZWQgcHVibGljIGxvbmcgYWRkRW50\ncnkoQnl0ZUJ1ZmZlciBlbnRyeSkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBsb25nIGxlZGdlcklkID0gZW50cnkuZ2V0TG9uZygpOwogICAgICAg\nIGxvbmcgZW50cnlJZCA9IGVudHJ5LmdldExvbmcoKTsKICAgICAgICBlbnRy\neS5yZXdpbmQoKTsKICAgICAgICAKICAgICAgICAvKgogICAgICAgICAqIExv\nZyB0aGUgZW50cnkKICAgICAgICAgKi8KICAgICAgICBsb25nIHBvcyA9IGVu\ndHJ5TG9nZ2VyLmFkZEVudHJ5KGxlZGdlcklkLCBlbnRyeSk7CiAgICAgICAg\nCiAgICAgICAgCiAgICAgICAgLyoKICAgICAgICAgKiBTZXQgb2Zmc2V0IG9m\nIGVudHJ5IGlkIHRvIGJlIHRoZSBjdXJyZW50IGxlZGdlciBwb3NpdGlvbgog\nICAgICAgICAqLwogICAgICAgIGxlZGdlckNhY2hlLnB1dEVudHJ5T2Zmc2V0\nKGxlZGdlcklkLCBlbnRyeUlkLCBwb3MpOwoKICAgICAgICByZXR1cm4gZW50\ncnlJZDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBCeXRlQnVm\nZmVyIGdldEVudHJ5KGxvbmcgbGVkZ2VySWQsIGxvbmcgZW50cnlJZCkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBsb25nIG9mZnNldDsKICAgICAg\nICAvKgogICAgICAgICAqIElmIGVudHJ5SWQgaXMgQm9va2llUHJvdG9jb2wu\nTEFTVF9BRERfQ09ORklSTUVELCB0aGVuIHJldHVybiB0aGUgbGFzdCB3cml0\ndGVuLgogICAgICAgICAqLwogICAgICAgIGlmIChlbnRyeUlkID09IEJvb2tp\nZVByb3RvY29sLkxBU1RfQUREX0NPTkZJUk1FRCkgewogICAgICAgICAgICBl\nbnRyeUlkID0gbGVkZ2VyQ2FjaGUuZ2V0TGFzdEVudHJ5KGxlZGdlcklkKTsK\nICAgICAgICB9CgogICAgICAgIG9mZnNldCA9IGxlZGdlckNhY2hlLmdldEVu\ndHJ5T2Zmc2V0KGxlZGdlcklkLCBlbnRyeUlkKTsKICAgICAgICBpZiAob2Zm\nc2V0ID09IDApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEJvb2tpZS5Ob0Vu\ndHJ5RXhjZXB0aW9uKGxlZGdlcklkLCBlbnRyeUlkKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIEJ5dGVCdWZmZXIud3JhcChlbnRyeUxvZ2dlci5yZWFk\nRW50cnkobGVkZ2VySWQsIGVudHJ5SWQsIG9mZnNldCkpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gaXNGbHVzaFJlcXVpcmVk\nKCkgewogICAgICAgIHJldHVybiBlbnRyeUxvZ2dlci5pc0ZsdXNoUmVxdWly\nZWQoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGZs\ndXNoKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzRmx1\nc2hSZXF1aXJlZCgpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCiAgICAgICAgYm9vbGVhbiBmbHVzaEZhaWxlZCA9IGZhbHNlOwoKICAgICAg\nICB0cnkgewogICAgICAgICAgICBsZWRnZXJDYWNoZS5mbHVzaExlZGdlcih0\ncnVlKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAg\nICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24gZmx1c2hpbmcgTGVkZ2Vy\nIGNhY2hlIiwgaW9lKTsKICAgICAgICAgICAgZmx1c2hGYWlsZWQgPSB0cnVl\nOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZW50cnlM\nb2dnZXIuZmx1c2goKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBp\nb2UpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24gZmx1c2hp\nbmcgTGVkZ2VyIiwgaW9lKTsKICAgICAgICAgICAgZmx1c2hGYWlsZWQgPSB0\ncnVlOwogICAgICAgIH0KICAgICAgICBpZiAoZmx1c2hGYWlsZWQpIHsKICAg\nICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJGbHVzaGluZyB0byBz\ndG9yYWdlIGZhaWxlZCwgY2hlY2sgbG9ncyIpOwogICAgICAgIH0KICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBCS01CZWFuSW5mbyBnZXRKTVhC\nZWFuKCkgewogICAgICAgIHJldHVybiBsZWRnZXJDYWNoZS5nZXRKTVhCZWFu\nKCk7CiAgICB9Cn0K\n","encoding":"base64"}

