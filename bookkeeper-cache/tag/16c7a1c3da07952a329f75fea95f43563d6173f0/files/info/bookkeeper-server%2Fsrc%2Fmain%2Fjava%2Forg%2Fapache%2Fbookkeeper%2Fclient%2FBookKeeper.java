{"sha":"642f8774ef5751b68b2d92499df709546a3f3540","node_id":"MDQ6QmxvYjE1NzU5NTY6NjQyZjg3NzRlZjU3NTFiNjhiMmQ5MjQ5OWRmNzA5NTQ2YTNmMzU0MA==","size":26081,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/642f8774ef5751b68b2d92499df709546a3f3540","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJl\nbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlOwppbXBvcnQgamF2YS51dGls\nLmNvbmN1cnJlbnQuVGltZVVuaXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLkNyZWF0ZUNhbGxiYWNrOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxi\nYWNrLkRlbGV0ZUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLk9wZW5DYWxsYmFjazsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQXN5bmNDYWxsYmFjay5J\nc0Nsb3NlZENhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNsaWVudC5CS0V4Y2VwdGlvbi5Db2RlOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlck1hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyRmFj\ndG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\naWVDbGllbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWNDYWxsYmFjazsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLk9yZGVyZWRTYWZl\nRXhlY3V0b3I7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5a\na1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnpvb2tlZXBl\nci5ab29LZWVwZXJXYXRjaGVyQmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFu\nbmVsLnNvY2tldC5DbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeTsKaW1wb3J0\nIG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLnNvY2tldC5uaW8uTmlvQ2xpZW50\nU29ja2V0Q2hhbm5lbEZhY3Rvcnk7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2Vy\nOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioKICogQm9v\na0tlZXBlciBjbGllbnQuIFdlIGFzc3VtZSB0aGVyZSBpcyBvbmUgc2luZ2xl\nIHdyaXRlciB0byBhIGxlZGdlciBhdCBhbnkKICogdGltZS4KICoKICogVGhl\ncmUgYXJlIGZvdXIgcG9zc2libGUgb3BlcmF0aW9uczogc3RhcnQgYSBuZXcg\nbGVkZ2VyLCB3cml0ZSB0byBhIGxlZGdlciwKICogcmVhZCBmcm9tIGEgbGVk\nZ2VyIGFuZCBkZWxldGUgYSBsZWRnZXIuCiAqCiAqIFRoZSBleGNlcHRpb25z\nIHJlc3VsdGluZyBmcm9tIHN5bmNocm9ub3VzIGNhbGxzIGFuZCBlcnJvciBj\nb2RlIHJlc3VsdGluZyBmcm9tCiAqIGFzeW5jaHJvbm91cyBjYWxscyBjYW4g\nYmUgZm91bmQgaW4gdGhlIGNsYXNzIHtAbGluayBCS0V4Y2VwdGlvbn0uCiAq\nCiAqCiAqLwoKcHVibGljIGNsYXNzIEJvb2tLZWVwZXIgewoKICAgIHN0YXRp\nYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIo\nQm9va0tlZXBlci5jbGFzcyk7CgogICAgZmluYWwgWm9vS2VlcGVyIHprOwog\nICAgZmluYWwgQ291bnREb3duTGF0Y2ggY29ubmVjdExhdGNoID0gbmV3IENv\ndW50RG93bkxhdGNoKDEpOwogICAgZmluYWwgc3RhdGljIGludCB6a0Nvbm5l\nY3RUaW1lb3V0TXMgPSA1MDAwOwogICAgZmluYWwgQ2xpZW50U29ja2V0Q2hh\nbm5lbEZhY3RvcnkgY2hhbm5lbEZhY3Rvcnk7CgogICAgLy8gd2hldGhlciB0\naGUgc29ja2V0IGZhY3RvcnkgaXMgb25lIHdlIGNyZWF0ZWQsIG9yIGlzIG93\nbmVkIGJ5IHdob2V2ZXIKICAgIC8vIGluc3RhbnRpYXRlZCB1cwogICAgYm9v\nbGVhbiBvd25DaGFubmVsRmFjdG9yeSA9IGZhbHNlOwogICAgLy8gd2hldGhl\nciB0aGUgemsgaGFuZGxlIGlzIG9uZSB3ZSBjcmVhdGVkLCBvciBpcyBvd25l\nZCBieSB3aG9ldmVyCiAgICAvLyBpbnN0YW50aWF0ZWQgdXMKICAgIGJvb2xl\nYW4gb3duWktIYW5kbGUgPSBmYWxzZTsKCiAgICBmaW5hbCBCb29raWVDbGll\nbnQgYm9va2llQ2xpZW50OwogICAgZmluYWwgQm9va2llV2F0Y2hlciBib29r\naWVXYXRjaGVyOwoKICAgIGZpbmFsIE9yZGVyZWRTYWZlRXhlY3V0b3IgbWFp\nbldvcmtlclBvb2w7CiAgICBmaW5hbCBTY2hlZHVsZWRFeGVjdXRvclNlcnZp\nY2Ugc2NoZWR1bGVyOwoKICAgIC8vIExlZGdlciBtYW5hZ2VyIHJlc3BvbnNp\nYmxlIGZvciBob3cgdG8gc3RvcmUgbGVkZ2VyIG1ldGEgZGF0YQogICAgZmlu\nYWwgTGVkZ2VyTWFuYWdlckZhY3RvcnkgbGVkZ2VyTWFuYWdlckZhY3Rvcnk7\nCiAgICBmaW5hbCBMZWRnZXJNYW5hZ2VyIGxlZGdlck1hbmFnZXI7CgogICAg\nZmluYWwgQ2xpZW50Q29uZmlndXJhdGlvbiBjb25mOwoKICAgIGludGVyZmFj\nZSBaS0Nvbm5lY3RDYWxsYmFjayB7CiAgICAgICAgcHVibGljIHZvaWQgY29u\nbmVjdGVkKCk7CiAgICAgICAgcHVibGljIHZvaWQgY29ubmVjdGlvbkZhaWxl\nZChpbnQgY29kZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBi\nb29ra2VlcGVyIGNsaWVudC4gQSB6b29rZWVwZXIgY2xpZW50IGFuZCBhIGNs\naWVudCBzb2NrZXQgZmFjdG9yeQogICAgICogd2lsbCBiZSBpbnN0YW50aWF0\nZWQgYXMgcGFydCBvZiB0aGlzIGNvbnN0cnVjdG9yLgogICAgICoKICAgICAq\nIEBwYXJhbSBzZXJ2ZXJzCiAgICAgKiAgICAgICAgICBBIGxpc3Qgb2Ygb25l\nIG9mIG1vcmUgc2VydmVycyBvbiB3aGljaCB6b29rZWVwZXIgaXMgcnVubmlu\nZy4gVGhlCiAgICAgKiAgICAgICAgICBjbGllbnQgYXNzdW1lcyB0aGF0IHRo\nZSBydW5uaW5nIGJvb2tpZXMgaGF2ZSBiZWVuIHJlZ2lzdGVyZWQgd2l0aAog\nICAgICogICAgICAgICAgem9va2VlcGVyIHVuZGVyIHRoZSBwYXRoCiAgICAg\nKiAgICAgICAgICB7QGxpbmsgQm9va2llV2F0Y2hlciNib29raWVSZWdpc3Ry\nYXRpb25QYXRofQogICAgICogQHRocm93cyBJT0V4Y2VwdGlvbgogICAgICog\nQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBL\nZWVwZXJFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIEJvb2tLZWVwZXIo\nU3RyaW5nIHNlcnZlcnMpIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0\nZWRFeGNlcHRpb24sCiAgICAgICAgS2VlcGVyRXhjZXB0aW9uIHsKICAgICAg\nICB0aGlzKG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCkuc2V0WmtTZXJ2ZXJz\nKHNlcnZlcnMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIGJv\nb2trZWVwZXIgY2xpZW50IHVzaW5nIGEgY29uZmlndXJhdGlvbiBvYmplY3Qu\nCiAgICAgKiBBIHpvb2tlZXBlciBjbGllbnQgYW5kIGEgY2xpZW50IHNvY2tl\ndCBmYWN0b3J5IHdpbGwgYmUgCiAgICAgKiBpbnN0YW50aWF0ZWQgYXMgcGFy\ndCBvZiB0aGlzIGNvbnN0cnVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBj\nb25mCiAgICAgKiAgICAgICAgICBDbGllbnQgQ29uZmlndXJhdGlvbiBvYmpl\nY3QKICAgICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAqIEB0aHJvd3Mg\nSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqIEB0aHJvd3MgS2VlcGVyRXhj\nZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBCb29rS2VlcGVyKGZpbmFsIENs\naWVudENvbmZpZ3VyYXRpb24gY29uZikKICAgICAgICAgICAgdGhyb3dzIElP\nRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgS2VlcGVyRXhjZXB0\naW9uIHsKICAgICAgICB0aGlzLmNvbmYgPSBjb25mOwogICAgICAgIFpvb0tl\nZXBlcldhdGNoZXJCYXNlIHcgPSBuZXcgWm9vS2VlcGVyV2F0Y2hlckJhc2Uo\nY29uZi5nZXRaa1RpbWVvdXQoKSk7CiAgICAgICAgdGhpcy56ayA9IFprVXRp\nbHMKICAgICAgICAgICAgICAgIC5jcmVhdGVDb25uZWN0ZWRab29rZWVwZXJD\nbGllbnQoY29uZi5nZXRaa1NlcnZlcnMoKSwgdyk7CgogICAgICAgIHRoaXMu\nY2hhbm5lbEZhY3RvcnkgPSBuZXcgTmlvQ2xpZW50U29ja2V0Q2hhbm5lbEZh\nY3RvcnkoRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2woKSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCkp\nOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gRXhlY3V0b3JzLm5ld1Npbmds\nZVRocmVhZFNjaGVkdWxlZEV4ZWN1dG9yKCk7CgogICAgICAgIG1haW5Xb3Jr\nZXJQb29sID0gbmV3IE9yZGVyZWRTYWZlRXhlY3V0b3IoY29uZi5nZXROdW1X\nb3JrZXJUaHJlYWRzKCkpOwogICAgICAgIGJvb2tpZUNsaWVudCA9IG5ldyBC\nb29raWVDbGllbnQoY29uZiwgY2hhbm5lbEZhY3RvcnksIG1haW5Xb3JrZXJQ\nb29sKTsKICAgICAgICBib29raWVXYXRjaGVyID0gbmV3IEJvb2tpZVdhdGNo\nZXIoY29uZiwgc2NoZWR1bGVyLCB0aGlzKTsKICAgICAgICBib29raWVXYXRj\naGVyLnJlYWRCb29raWVzQmxvY2tpbmcoKTsKCiAgICAgICAgbGVkZ2VyTWFu\nYWdlckZhY3RvcnkgPSBMZWRnZXJNYW5hZ2VyRmFjdG9yeS5uZXdMZWRnZXJN\nYW5hZ2VyRmFjdG9yeShjb25mLCB6ayk7CiAgICAgICAgbGVkZ2VyTWFuYWdl\nciA9IGxlZGdlck1hbmFnZXJGYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXIoKTsK\nCiAgICAgICAgb3duQ2hhbm5lbEZhY3RvcnkgPSB0cnVlOwogICAgICAgIG93\nblpLSGFuZGxlID0gdHJ1ZTsKICAgICB9CgogICAgLyoqCiAgICAgKiBDcmVh\ndGUgYSBib29ra2VlcGVyIGNsaWVudCBidXQgdXNlIHRoZSBwYXNzZWQgaW4g\nem9va2VlcGVyIGNsaWVudCBpbnN0ZWFkCiAgICAgKiBvZiBpbnN0YW50aWF0\naW5nIG9uZS4KICAgICAqCiAgICAgKiBAcGFyYW0gY29uZgogICAgICogICAg\nICAgICAgQ2xpZW50IENvbmZpZ3VyYXRpb24gb2JqZWN0CiAgICAgKiAgICAg\nICAgICB7QGxpbmsgQ2xpZW50Q29uZmlndXJhdGlvbn0KICAgICAqIEBwYXJh\nbSB6awogICAgICogICAgICAgICAgWm9va2VlcGVyIGNsaWVudCBpbnN0YW5j\nZSBjb25uZWN0ZWQgdG8gdGhlIHpvb2tlZXBlciB3aXRoIHdoaWNoCiAgICAg\nKiAgICAgICAgICB0aGUgYm9va2llcyBoYXZlIHJlZ2lzdGVyZWQKICAgICAq\nIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAqIEB0aHJvd3MgSW50ZXJydXB0\nZWRFeGNlcHRpb24KICAgICAqIEB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uCiAg\nICAgKi8KICAgIHB1YmxpYyBCb29rS2VlcGVyKENsaWVudENvbmZpZ3VyYXRp\nb24gY29uZiwgWm9vS2VlcGVyIHprKQogICAgICAgIHRocm93cyBJT0V4Y2Vw\ndGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiB7\nCiAgICAgICAgdGhpcyhjb25mLCB6aywgbmV3IE5pb0NsaWVudFNvY2tldENo\nYW5uZWxGYWN0b3J5KEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCks\nCiAgICAgICAgICAgICAgICBFeGVjdXRvcnMubmV3Q2FjaGVkVGhyZWFkUG9v\nbCgpKSk7CiAgICAgICAgb3duQ2hhbm5lbEZhY3RvcnkgPSB0cnVlOwogICAg\nfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgYm9va2tlZXBlciBjbGllbnQg\nYnV0IHVzZSB0aGUgcGFzc2VkIGluIHpvb2tlZXBlciBjbGllbnQgYW5kCiAg\nICAgKiBjbGllbnQgc29ja2V0IGNoYW5uZWwgZmFjdG9yeSBpbnN0ZWFkIG9m\nIGluc3RhbnRpYXRpbmcgdGhvc2UuCiAgICAgKgogICAgICogQHBhcmFtIGNv\nbmYKICAgICAqICAgICAgICAgIENsaWVudCBDb25maWd1cmF0aW9uIE9iamVj\ndAogICAgICogICAgICAgICAge0BsaW5rIENsaWVudENvbmZpZ3VyYXRpb259\nCiAgICAgKiBAcGFyYW0gemsKICAgICAqICAgICAgICAgIFpvb2tlZXBlciBj\nbGllbnQgaW5zdGFuY2UgY29ubmVjdGVkIHRvIHRoZSB6b29rZWVwZXIgd2l0\naCB3aGljaAogICAgICogICAgICAgICAgdGhlIGJvb2tpZXMgaGF2ZSByZWdp\nc3RlcmVkLiBUaGUgWm9vS2VlcGVyIGNsaWVudCBtdXN0IGJlIGNvbm5lY3Rl\nZAogICAgICogICAgICAgICAgYmVmb3JlIGl0IGlzIHBhc3NlZCB0byBCb29r\nS2VlcGVyLiBPdGhlcndpc2UgYSBLZWVwZXJFeGNlcHRpb24gaXMgdGhyb3du\nLgogICAgICogQHBhcmFtIGNoYW5uZWxGYWN0b3J5CiAgICAgKiAgICAgICAg\nICBBIGZhY3RvcnkgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY3JlYXRlIGNvbm5l\nY3Rpb25zIHRvIHRoZSBib29raWVzCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0\naW9uCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAg\nKiBAdGhyb3dzIEtlZXBlckV4Y2VwdGlvbiBpZiB0aGUgcGFzc2VkIHprIGhh\nbmRsZSBpcyBub3QgY29ubmVjdGVkCiAgICAgKi8KICAgIHB1YmxpYyBCb29r\nS2VlcGVyKENsaWVudENvbmZpZ3VyYXRpb24gY29uZiwgWm9vS2VlcGVyIHpr\nLCBDbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeSBjaGFubmVsRmFjdG9yeSkK\nICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwgS2VlcGVyRXhjZXB0aW9uIHsKICAgICAgICBpZiAoemsgPT0g\nbnVsbCB8fCBjaGFubmVsRmFjdG9yeSA9PSBudWxsKSB7CiAgICAgICAgICAg\nIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigpOwogICAgICAgIH0K\nICAgICAgICBpZiAoIXprLmdldFN0YXRlKCkuaXNDb25uZWN0ZWQoKSkgewog\nICAgICAgICAgICBMT0cuZXJyb3IoIlVuY29ubmVjdGVkIHpvb2tlZXBlciBo\nYW5kbGUgcGFzc2VkIHRvIGJvb2trZWVwZXIiKTsKICAgICAgICAgICAgdGhy\nb3cgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29k\nZS5DT05ORUNUSU9OTE9TUyk7CiAgICAgICAgfQogICAgICAgIHRoaXMuY29u\nZiA9IGNvbmY7CiAgICAgICAgdGhpcy56ayA9IHprOwogICAgICAgIHRoaXMu\nY2hhbm5lbEZhY3RvcnkgPSBjaGFubmVsRmFjdG9yeTsKICAgICAgICB0aGlz\nLnNjaGVkdWxlciA9IEV4ZWN1dG9ycy5uZXdTaW5nbGVUaHJlYWRTY2hlZHVs\nZWRFeGVjdXRvcigpOwoKICAgICAgICBtYWluV29ya2VyUG9vbCA9IG5ldyBP\ncmRlcmVkU2FmZUV4ZWN1dG9yKGNvbmYuZ2V0TnVtV29ya2VyVGhyZWFkcygp\nKTsKICAgICAgICBib29raWVDbGllbnQgPSBuZXcgQm9va2llQ2xpZW50KGNv\nbmYsIGNoYW5uZWxGYWN0b3J5LCBtYWluV29ya2VyUG9vbCk7CiAgICAgICAg\nYm9va2llV2F0Y2hlciA9IG5ldyBCb29raWVXYXRjaGVyKGNvbmYsIHNjaGVk\ndWxlciwgdGhpcyk7CiAgICAgICAgYm9va2llV2F0Y2hlci5yZWFkQm9va2ll\nc0Jsb2NraW5nKCk7CgogICAgICAgIGxlZGdlck1hbmFnZXJGYWN0b3J5ID0g\nTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZhY3Rvcnko\nY29uZiwgemspOwogICAgICAgIGxlZGdlck1hbmFnZXIgPSBsZWRnZXJNYW5h\nZ2VyRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyKCk7CiAgICB9CgogICAgTGVk\nZ2VyTWFuYWdlciBnZXRMZWRnZXJNYW5hZ2VyKCkgewogICAgICAgIHJldHVy\nbiBsZWRnZXJNYW5hZ2VyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlcmUg\nYXJlIDIgZGlnZXN0IHR5cGVzIHRoYXQgY2FuIGJlIHVzZWQgZm9yIHZlcmlm\naWNhdGlvbi4gVGhlIENSQzMyIGlzCiAgICAgKiBjaGVhcCB0byBjb21wdXRl\nIGJ1dCBkb2VzIG5vdCBwcm90ZWN0IGFnYWluc3QgYnl6YW50aW5lIGJvb2tp\nZXMgKGkuZS4sIGEKICAgICAqIGJvb2tpZSBtaWdodCByZXBvcnQgZmFrZSBi\neXRlcyBhbmQgYSBtYXRjaGluZyBDUkMzMikuIFRoZSBNQUMgY29kZSBpcyBt\nb3JlCiAgICAgKiBleHBlbnNpdmUgdG8gY29tcHV0ZSwgYnV0IGlzIHByb3Rl\nY3RlZCBieSBhIHBhc3N3b3JkLCBpLmUuLCBhIGJvb2tpZSBjYW4ndAogICAg\nICogcmVwb3J0IGZha2UgYnl0ZXMgd2l0aCBhIG1hdGhjaGluZyBNQUMgdW5s\nZXNzIGl0IGtub3dzIHRoZSBwYXNzd29yZAogICAgICovCiAgICBwdWJsaWMg\nZW51bSBEaWdlc3RUeXBlIHsKICAgICAgICBNQUMsIENSQzMyCiAgICB9OwoK\nICAgIFpvb0tlZXBlciBnZXRaa0hhbmRsZSgpIHsKICAgICAgICByZXR1cm4g\nems7CiAgICB9CgogICAgcHJvdGVjdGVkIENsaWVudENvbmZpZ3VyYXRpb24g\nZ2V0Q29uZigpIHsKICAgICAgICByZXR1cm4gY29uZjsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdldCB0aGUgQm9va2llQ2xpZW50LCBjdXJyZW50bHkgdXNl\nZCBmb3IgZG9pbmcgYm9va2llIHJlY292ZXJ5LgogICAgICoKICAgICAqIEBy\nZXR1cm4gQm9va2llQ2xpZW50IGZvciB0aGUgQm9va0tlZXBlciBpbnN0YW5j\nZS4KICAgICAqLwogICAgQm9va2llQ2xpZW50IGdldEJvb2tpZUNsaWVudCgp\nIHsKICAgICAgICByZXR1cm4gYm9va2llQ2xpZW50OwogICAgfQoKICAgIC8q\nKgogICAgICogQ3JlYXRlcyBhIG5ldyBsZWRnZXIgYXN5bmNocm9ub3VzbHku\nIFRvIGNyZWF0ZSBhIGxlZGdlciwgd2UgbmVlZCB0byBzcGVjaWZ5CiAgICAg\nKiB0aGUgZW5zZW1ibGUgc2l6ZSwgdGhlIHF1b3J1bSBzaXplLCB0aGUgZGln\nZXN0IHR5cGUsIGEgcGFzc3dvcmQsIGEgY2FsbGJhY2sKICAgICAqIGltcGxl\nbWVudGF0aW9uLCBhbmQgYW4gb3B0aW9uYWwgY29udHJvbCBvYmplY3QuIFRo\nZSBlbnNlbWJsZSBzaXplIGlzIGhvdwogICAgICogbWFueSBib29raWVzIHRo\nZSBlbnRyaWVzIHNob3VsZCBiZSBzdHJpcGVkIGFtb25nIGFuZCB0aGUgcXVv\ncnVtIHNpemUgaXMgdGhlCiAgICAgKiBkZWdyZWUgb2YgcmVwbGljYXRpb24g\nb2YgZWFjaCBlbnRyeS4gVGhlIGRpZ2VzdCB0eXBlIGlzIGVpdGhlciBhIE1B\nQyBvciBhCiAgICAgKiBDUkMuIE5vdGUgdGhhdCB0aGUgQ1JDIG9wdGlvbiBp\ncyBub3QgYWJsZSB0byBwcm90ZWN0IGEgY2xpZW50IGFnYWluc3QgYQogICAg\nICogYm9va2llIHRoYXQgcmVwbGFjZXMgYW4gZW50cnkuIFRoZSBwYXNzd29y\nZCBpcyB1c2VkIG5vdCBvbmx5IHRvCiAgICAgKiBhdXRoZW50aWNhdGUgYWNj\nZXNzIHRvIGEgbGVkZ2VyLCBidXQgYWxzbyB0byB2ZXJpZnkgZW50cmllcyBp\nbiBsZWRnZXJzLgogICAgICoKICAgICAqIEBwYXJhbSBlbnNTaXplCiAgICAg\nKiAgICAgICAgICBudW1iZXIgb2YgYm9va2llcyBvdmVyIHdoaWNoIHRvIHN0\ncmlwZSBlbnRyaWVzCiAgICAgKiBAcGFyYW0gd3JpdGVRdW9ydW1TaXplCiAg\nICAgKiAgICAgICAgICBudW1iZXIgb2YgYm9va2llcyBlYWNoIGVudHJ5IHdp\nbGwgYmUgd3JpdHRlbiB0by4gZWFjaCBvZiB0aGVzZSBib29raWVzCiAgICAg\nKiAgICAgICAgICBtdXN0IGFja25vd2xlZGdlIHRoZSBlbnRyeSBiZWZvcmUg\ndGhlIGNhbGwgaXMgY29tcGxldGVkLgogICAgICogQHBhcmFtIGRpZ2VzdFR5\ncGUKICAgICAqICAgICAgICAgIGRpZ2VzdCB0eXBlLCBlaXRoZXIgTUFDIG9y\nIENSQzMyCiAgICAgKiBAcGFyYW0gcGFzc3dkCiAgICAgKiAgICAgICAgICBw\nYXNzd29yZAogICAgICogQHBhcmFtIGNiCiAgICAgKiAgICAgICAgICBjcmVh\ndGVDYWxsYmFjayBpbXBsZW1lbnRhdGlvbgogICAgICogQHBhcmFtIGN0eAog\nICAgICogICAgICAgICAgb3B0aW9uYWwgY29udHJvbCBvYmplY3QKICAgICAq\nLwogICAgcHVibGljIHZvaWQgYXN5bmNDcmVhdGVMZWRnZXIoZmluYWwgaW50\nIGVuc1NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm\naW5hbCBpbnQgd3JpdGVRdW9ydW1TaXplLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWwgRGlnZXN0VHlwZSBkaWdlc3RUeXBlLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgYnl0ZVtd\nIHBhc3N3ZCwgZmluYWwgQ3JlYXRlQ2FsbGJhY2sgY2IsIGZpbmFsIE9iamVj\ndCBjdHgpCiAgICB7CiAgICAgICAgYXN5bmNDcmVhdGVMZWRnZXIoZW5zU2l6\nZSwgd3JpdGVRdW9ydW1TaXplLCB3cml0ZVF1b3J1bVNpemUsIGRpZ2VzdFR5\ncGUsIHBhc3N3ZCwgY2IsIGN0eCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\ncmVhdGVzIGEgbmV3IGxlZGdlciBhc3luY2hyb25vdXNseS4gTGVkZ2VycyBj\ncmVhdGVkIHdpdGggdGhpcyBjYWxsIGhhdmUKICAgICAqIGEgc2VwYXJhdGUg\nd3JpdGUgcXVvcnVtIGFuZCBhY2sgcXVvcnVtIHNpemUuIFRoZSB3cml0ZSBx\ndW9ydW0gbXVzdCBiZSBsYXJnZXIgdGhhbgogICAgICogdGhlIGFjayBxdW9y\ndW0uCiAgICAgKgogICAgICogU2VwYXJhdGluZyB0aGUgd3JpdGUgYW5kIHRo\nZSBhY2sgcXVvcnVtIGFsbG93cyB0aGUgQm9va0tlZXBlciBjbGllbnQgdG8g\nY29udGludWUKICAgICAqIHdyaXRpbmcgd2hlbiBhIGJvb2tpZSBoYXMgZmFp\nbGVkIGJ1dCB0aGUgZmFpbHVyZSBoYXMgbm90IHlldCBiZWVuIGRldGVjdGVk\nLiBEZXRlY3RpbmcKICAgICAqIGEgYm9va2llIGhhcyBmYWlsZWQgY2FuIHRh\na2UgYSBudW1iZXIgb2Ygc2Vjb25kcywgYXMgY29uZmlndXJlZCBieSB0aGUg\ncmVhZCB0aW1lb3V0CiAgICAgKiB7QGxpbmsgQ2xpZW50Q29uZmlndXJhdGlv\nbiNnZXRSZWFkVGltZW91dCgpfS4gT25jZSB0aGUgYm9va2llIGZhaWx1cmUg\naXMgZGV0ZWN0ZWQsCiAgICAgKiB0aGF0IGJvb2tpZSB3aWxsIGJlIHJlbW92\nZWQgZnJvbSB0aGUgZW5zZW1ibGUuCiAgICAgKgogICAgICogVGhlIG90aGVy\nIHBhcmFtZXRlcnMgbWF0Y2ggdGhvc2Ugb2Yge0BsaW5rICNhc3luY0NyZWF0\nZUxlZGdlcihpbnQsIGludCwgRGlnZXN0VHlwZSwgYnl0ZVtdLAogICAgICog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFzeW5jQ2Fs\nbGJhY2suQ3JlYXRlQ2FsbGJhY2ssIE9iamVjdCl9CiAgICAgKgogICAgICog\nQHBhcmFtIGVuc1NpemUKICAgICAqICAgICAgICAgIG51bWJlciBvZiBib29r\naWVzIG92ZXIgd2hpY2ggdG8gc3RyaXBlIGVudHJpZXMKICAgICAqIEBwYXJh\nbSB3cml0ZVF1b3J1bVNpemUKICAgICAqICAgICAgICAgIG51bWJlciBvZiBi\nb29raWVzIGVhY2ggZW50cnkgd2lsbCBiZSB3cml0dGVuIHRvCiAgICAgKiBA\ncGFyYW0gYWNrUXVvcnVtU2l6ZQogICAgICogICAgICAgICAgbnVtYmVyIG9m\nIGJvb2tpZXMgd2hpY2ggbXVzdCBhY2tub3dsZWRnZSBhbiBlbnRyeSBiZWZv\ncmUgdGhlIGNhbGwgaXMgY29tcGxldGVkCiAgICAgKiBAcGFyYW0gZGlnZXN0\nVHlwZQogICAgICogICAgICAgICAgZGlnZXN0IHR5cGUsIGVpdGhlciBNQUMg\nb3IgQ1JDMzIKICAgICAqIEBwYXJhbSBwYXNzd2QKICAgICAqICAgICAgICAg\nIHBhc3N3b3JkCiAgICAgKiBAcGFyYW0gY2IKICAgICAqICAgICAgICAgIGNy\nZWF0ZUNhbGxiYWNrIGltcGxlbWVudGF0aW9uCiAgICAgKiBAcGFyYW0gY3R4\nCiAgICAgKiAgICAgICAgICBvcHRpb25hbCBjb250cm9sIG9iamVjdAogICAg\nICovCgogICAgcHVibGljIHZvaWQgYXN5bmNDcmVhdGVMZWRnZXIoZmluYWwg\naW50IGVuc1NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBmaW5hbCBpbnQgd3JpdGVRdW9ydW1TaXplLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZmluYWwgaW50IGFja1F1b3J1bVNpemUsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBEaWdlc3RU\neXBlIGRpZ2VzdFR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBmaW5hbCBieXRlW10gcGFzc3dkLCBmaW5hbCBDcmVhdGVDYWxsYmFj\nayBjYiwgZmluYWwgT2JqZWN0IGN0eCkgewogICAgICAgIGlmICh3cml0ZVF1\nb3J1bVNpemUgPCBhY2tRdW9ydW1TaXplKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIldyaXRlIHF1b3J1bSBt\ndXN0IGJlIGxhcmdlciB0aGFuIGFjayBxdW9ydW0iKTsKICAgICAgICB9CiAg\nICAgICAgbmV3IExlZGdlckNyZWF0ZU9wKEJvb2tLZWVwZXIudGhpcywgZW5z\nU2l6ZSwgd3JpdGVRdW9ydW1TaXplLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICBhY2tRdW9ydW1TaXplLCBkaWdlc3RUeXBlLCBwYXNzd2QsIGNiLCBj\ndHgpCiAgICAgICAgICAgIC5pbml0aWF0ZSgpOwogICAgfQoKCiAgICAvKioK\nICAgICAqIENyZWF0ZXMgYSBuZXcgbGVkZ2VyLiBEZWZhdWx0IG9mIDMgc2Vy\ndmVycywgYW5kIHF1b3J1bSBvZiAyIHNlcnZlcnMuCiAgICAgKgogICAgICog\nQHBhcmFtIGRpZ2VzdFR5cGUKICAgICAqICAgICAgICAgIGRpZ2VzdCB0eXBl\nLCBlaXRoZXIgTUFDIG9yIENSQzMyCiAgICAgKiBAcGFyYW0gcGFzc3dkCiAg\nICAgKiAgICAgICAgICBwYXNzd29yZAogICAgICogQHJldHVybiBhIGhhbmRs\nZSB0byB0aGUgbmV3bHkgY3JlYXRlZCBsZWRnZXIKICAgICAqIEB0aHJvd3Mg\nSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqIEB0aHJvd3MgQktFeGNlcHRp\nb24KICAgICAqLwogICAgcHVibGljIExlZGdlckhhbmRsZSBjcmVhdGVMZWRn\nZXIoRGlnZXN0VHlwZSBkaWdlc3RUeXBlLCBieXRlIHBhc3N3ZFtdKQogICAg\nICAgICAgICB0aHJvd3MgQktFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gY3JlYXRlTGVkZ2VyKDMsIDIsIGRpZ2Vz\ndFR5cGUsIHBhc3N3ZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTeW5jaHJv\nbm91cyBjYWxsIHRvIGNyZWF0ZSBsZWRnZXIuIFBhcmFtZXRlcnMgbWF0Y2gg\ndGhvc2Ugb2YKICAgICAqIHtAbGluayAjYXN5bmNDcmVhdGVMZWRnZXIoaW50\nLCBpbnQsIERpZ2VzdFR5cGUsIGJ5dGVbXSwgCiAgICAgKiAgICAgICAgICAg\nICAgICAgICAgICAgICAgIEFzeW5jQ2FsbGJhY2suQ3JlYXRlQ2FsbGJhY2ss\nIE9iamVjdCl9CiAgICAgKgogICAgICogQHBhcmFtIGVuc1NpemUKICAgICAq\nIEBwYXJhbSBxU2l6ZQogICAgICogQHBhcmFtIGRpZ2VzdFR5cGUKICAgICAq\nIEBwYXJhbSBwYXNzd2QKICAgICAqIEByZXR1cm4gYSBoYW5kbGUgdG8gdGhl\nIG5ld2x5IGNyZWF0ZWQgbGVkZ2VyCiAgICAgKiBAdGhyb3dzIEludGVycnVw\ndGVkRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIEJLRXhjZXB0aW9uCiAgICAg\nKi8KICAgIHB1YmxpYyBMZWRnZXJIYW5kbGUgY3JlYXRlTGVkZ2VyKGludCBl\nbnNTaXplLCBpbnQgcVNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBEaWdlc3RUeXBlIGRpZ2VzdFR5cGUsIGJ5dGUgcGFzc3dk\nW10pCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwg\nQktFeGNlcHRpb24gewogICAgICAgIHJldHVybiBjcmVhdGVMZWRnZXIoZW5z\nU2l6ZSwgcVNpemUsIHFTaXplLCBkaWdlc3RUeXBlLCBwYXNzd2QpOwogICAg\nfQoKICAgIC8qKgogICAgICogU3luY2hyb25vdXMgY2FsbCB0byBjcmVhdGUg\nbGVkZ2VyLiBQYXJhbWV0ZXJzIG1hdGNoIHRob3NlIG9mCiAgICAgKiB7QGxp\nbmsgI2FzeW5jQ3JlYXRlTGVkZ2VyKGludCwgaW50LCBpbnQsIERpZ2VzdFR5\ncGUsIGJ5dGVbXSwKICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAg\nQXN5bmNDYWxsYmFjay5DcmVhdGVDYWxsYmFjaywgT2JqZWN0KX0KICAgICAq\nCiAgICAgKiBAcGFyYW0gZW5zU2l6ZQogICAgICogQHBhcmFtIHdyaXRlUXVv\ncnVtU2l6ZQogICAgICogQHBhcmFtIGFja1F1b3J1bVNpemUKICAgICAqIEBw\nYXJhbSBkaWdlc3RUeXBlCiAgICAgKiBAcGFyYW0gcGFzc3dkCiAgICAgKiBA\ncmV0dXJuIGEgaGFuZGxlIHRvIHRoZSBuZXdseSBjcmVhdGVkIGxlZGdlcgog\nICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRo\ncm93cyBCS0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgTGVkZ2VySGFu\nZGxlIGNyZWF0ZUxlZGdlcihpbnQgZW5zU2l6ZSwgaW50IHdyaXRlUXVvcnVt\nU2l6ZSwgaW50IGFja1F1b3J1bVNpemUsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBEaWdlc3RUeXBlIGRpZ2VzdFR5cGUsIGJ5dGUg\ncGFzc3dkW10pCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiwgQktFeGNlcHRpb24gewogICAgICAgIFN5bmNDb3VudGVyIGNvdW50\nZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAgICBjb3VudGVyLmluYygp\nOwogICAgICAgIC8qCiAgICAgICAgICogQ2FsbHMgYXN5bmNocm9ub3VzIHZl\ncnNpb24KICAgICAgICAgKi8KICAgICAgICBhc3luY0NyZWF0ZUxlZGdlcihl\nbnNTaXplLCB3cml0ZVF1b3J1bVNpemUsIGFja1F1b3J1bVNpemUsIGRpZ2Vz\ndFR5cGUsIHBhc3N3ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcg\nU3luY0NyZWF0ZUNhbGxiYWNrKCksIGNvdW50ZXIpOwoKICAgICAgICAvKgog\nICAgICAgICAqIFdhaXQKICAgICAgICAgKi8KICAgICAgICBjb3VudGVyLmJs\nb2NrKDApOwogICAgICAgIGlmIChjb3VudGVyLmdldHJjKCkgIT0gQktFeGNl\ncHRpb24uQ29kZS5PSykgewogICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9y\nIHdoaWxlIGNyZWF0aW5nIGxlZGdlciA6IHt9IiwgY291bnRlci5nZXRyYygp\nKTsKICAgICAgICAgICAgdGhyb3cgQktFeGNlcHRpb24uY3JlYXRlKGNvdW50\nZXIuZ2V0cmMoKSk7CiAgICAgICAgfSBlbHNlIGlmIChjb3VudGVyLmdldExo\nKCkgPT0gbnVsbCkgewogICAgICAgICAgICBMT0cuZXJyb3IoIlVuZXhwZWN0\nZWQgY29uZGl0aW9uIDogbm8gbGVkZ2VyIGhhbmRsZSByZXR1cm5lZCBmb3Ig\nYSBzdWNjZXNzIGxlZGdlciBjcmVhdGlvbiIpOwogICAgICAgICAgICB0aHJv\ndyBCS0V4Y2VwdGlvbi5jcmVhdGUoQktFeGNlcHRpb24uQ29kZS5VbmV4cGVj\ndGVkQ29uZGl0aW9uRXhjZXB0aW9uKTsKICAgICAgICB9CgogICAgICAgIHJl\ndHVybiBjb3VudGVyLmdldExoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBP\ncGVuIGV4aXN0aW5nIGxlZGdlciBhc3luY2hyb25vdXNseSBmb3IgcmVhZGlu\nZy4KICAgICAqIAogICAgICogT3BlbmluZyBhIGxlZGdlciB3aXRoIHRoaXMg\nbWV0aG9kIGludm9rZXMgZmVuY2luZyBhbmQgcmVjb3Zlcnkgb24gdGhlIGxl\nZGdlciAKICAgICAqIGlmIHRoZSBsZWRnZXIgaGFzIG5vdCBiZWVuIGNsb3Nl\nZC4gRmVuY2luZyB3aWxsIGJsb2NrIGFsbCBvdGhlciBjbGllbnRzIGZyb20g\nCiAgICAgKiB3cml0aW5nIHRvIHRoZSBsZWRnZXIuIFJlY292ZXJ5IHdpbGwg\nbWFrZSBzdXJlIHRoYXQgdGhlIGxlZGdlciBpcyBjbG9zZWQgCiAgICAgKiBi\nZWZvcmUgcmVhZGluZyBmcm9tIGl0LiAKICAgICAqCiAgICAgKiBSZWNvdmVy\neSBhbHNvIG1ha2VzIHN1cmUgdGhhdCBhbnkgZW50cmllcyB3aGljaCByZWFj\naGVkIG9uZSBib29raWUsIGJ1dCBub3QgYSAKICAgICAqIHF1b3J1bSwgd2ls\nbCBiZSByZXBsaWNhdGVkIHRvIGEgcXVvcnVtIG9mIGJvb2tpZXMuIFRoaXMg\nb2NjdXJzIGluIGNhc2VzIHdlcmUKICAgICAqIHRoZSB3cml0ZXIgb2YgYSBs\nZWRnZXIgY3Jhc2hlcyBhZnRlciBzZW5kaW5nIGEgd3JpdGUgcmVxdWVzdCB0\nbyBvbmUgYm9va2llIGJ1dAogICAgICogYmVmb3JlIGJlaW5nIGFibGUgdG8g\nc2VuZCBpdCB0byB0aGUgcmVzdCBvZiB0aGUgYm9va2llcyBpbiB0aGUgcXVv\ncnVtLiAKICAgICAqCiAgICAgKiBJZiB0aGUgbGVkZ2VyIGlzIGFscmVhZHkg\nY2xvc2VkLCBuZWl0aGVyIGZlbmNpbmcgbm9yIHJlY292ZXJ5IHdpbGwgYmUg\nYXBwbGllZC4KICAgICAqIAogICAgICogQHNlZSBMZWRnZXJIYW5kbGUjYXN5\nbmNDbG9zZQogICAgICoKICAgICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAg\nICAgIGxlZGdlciBpZGVudGlmaWVyCiAgICAgKiBAcGFyYW0gZGlnZXN0VHlw\nZQogICAgICogICAgICAgICAgZGlnZXN0IHR5cGUsIGVpdGhlciBNQUMgb3Ig\nQ1JDMzIKICAgICAqIEBwYXJhbSBwYXNzd2QKICAgICAqICAgICAgICAgIHBh\nc3N3b3JkCiAgICAgKiBAcGFyYW0gY3R4CiAgICAgKiAgICAgICAgICBvcHRp\nb25hbCBjb250cm9sIG9iamVjdAogICAgICovCiAgICBwdWJsaWMgdm9pZCBh\nc3luY09wZW5MZWRnZXIoZmluYWwgbG9uZyBsSWQsIGZpbmFsIERpZ2VzdFR5\ncGUgZGlnZXN0VHlwZSwgZmluYWwgYnl0ZSBwYXNzd2RbXSwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBPcGVuQ2FsbGJhY2sgY2Is\nIGZpbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICBuZXcgTGVkZ2VyT3Blbk9w\nKEJvb2tLZWVwZXIudGhpcywgbElkLCBkaWdlc3RUeXBlLCBwYXNzd2QsIGNi\nLCBjdHgpLmluaXRpYXRlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBPcGVu\nIGV4aXN0aW5nIGxlZGdlciBhc3luY2hyb25vdXNseSBmb3IgcmVhZGluZywg\nYnV0IGl0IGRvZXMgbm90IHRyeSB0bwogICAgICogcmVjb3ZlciB0aGUgbGVk\nZ2VyIGlmIGl0IGlzIG5vdCB5ZXQgY2xvc2VkLiBUaGUgYXBwbGljYXRpb24g\nbmVlZHMgdG8gdXNlCiAgICAgKiBpdCBjYXJlZnVsbHksIHNpbmNlIHRoZSB3\ncml0ZXIgbWlnaHQgaGF2ZSBjcmFzaGVkIGFuZCBsZWRnZXIgd2lsbCByZW1h\naW4KICAgICAqIHVuc2VhbGVkIGZvcmV2ZXIgaWYgdGhlcmUgaXMgbm8gZXh0\nZXJuYWwgbWVjaGFuaXNtIHRvIGRldGVjdCB0aGUgZmFpbHVyZQogICAgICog\nb2YgdGhlIHdyaXRlciBhbmQgdGhlIGxlZGdlciBpcyBub3Qgb3BlbiBpbiBh\nIHNhZmUgbWFubmVyLCBpbnZva2luZyB0aGUKICAgICAqIHJlY292ZXJ5IHBy\nb2NlZHVyZS4KICAgICAqIAogICAgICogT3BlbmluZyBhIGxlZGdlciB3aXRo\nb3V0IHJlY292ZXJ5IGRvZXMgbm90IGZlbmNlIHRoZSBsZWRnZXIuIEFzIHN1\nY2gsIG90aGVyCiAgICAgKiBjbGllbnRzIGNhbiBjb250aW51ZSB0byB3cml0\nZSB0byB0aGUgbGVkZ2VyLiAKICAgICAqCiAgICAgKiBUaGlzIG1ldGhvZCBy\nZXR1cm5zIGEgcmVhZCBvbmx5IGxlZGdlciBoYW5kbGUuIEl0IHdpbGwgbm90\nIGJlIHBvc3NpYmxlIAogICAgICogdG8gYWRkIGVudHJpZXMgdG8gdGhlIGxl\nZGdlci4gQW55IGF0dGVtcHQgdG8gYWRkIGVudHJpZXMgd2lsbCB0aHJvdyBh\nbiAKICAgICAqIGV4Y2VwdGlvbi4KICAgICAqIAogICAgICogUmVhZHMgZnJv\nbSB0aGUgcmV0dXJuZWQgbGVkZ2VyIHdpbGwgb25seSBiZSBhYmxlIHRvIHJl\nYWQgZW50cmllcyB1cCB1bnRpbAogICAgICogdGhlIGxhc3RDb25maXJtZWRF\nbnRyeSBhdCB0aGUgcG9pbnQgaW4gdGltZSBhdCB3aGljaCB0aGUgbGVkZ2Vy\nIHdhcyBvcGVuZWQuCiAgICAgKgogICAgICogQHBhcmFtIGxJZAogICAgICog\nICAgICAgICAgbGVkZ2VyIGlkZW50aWZpZXIKICAgICAqIEBwYXJhbSBkaWdl\nc3RUeXBlCiAgICAgKiAgICAgICAgICBkaWdlc3QgdHlwZSwgZWl0aGVyIE1B\nQyBvciBDUkMzMgogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogICAgICAg\nICAgcGFzc3dvcmQKICAgICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAg\nIG9wdGlvbmFsIGNvbnRyb2wgb2JqZWN0CiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGFzeW5jT3BlbkxlZGdlck5vUmVjb3ZlcnkoZmluYWwgbG9uZyBsSWQs\nIGZpbmFsIERpZ2VzdFR5cGUgZGlnZXN0VHlwZSwgZmluYWwgYnl0ZSBwYXNz\nd2RbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZmluYWwgT3BlbkNhbGxiYWNrIGNiLCBmaW5hbCBPYmplY3QgY3R4KSB7\nCiAgICAgICAgbmV3IExlZGdlck9wZW5PcChCb29rS2VlcGVyLnRoaXMsIGxJ\nZCwgZGlnZXN0VHlwZSwgcGFzc3dkLCBjYiwgY3R4KS5pbml0aWF0ZVdpdGhv\ndXRSZWNvdmVyeSgpOwogICAgfQoKCiAgICAvKioKICAgICAqIFN5bmNocm9u\nb3VzIG9wZW4gbGVkZ2VyIGNhbGwKICAgICAqCiAgICAgKiBAc2VlICNhc3lu\nY09wZW5MZWRnZXIKICAgICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAgICAg\nIGxlZGdlciBpZGVudGlmaWVyCiAgICAgKiBAcGFyYW0gZGlnZXN0VHlwZQog\nICAgICogICAgICAgICAgZGlnZXN0IHR5cGUsIGVpdGhlciBNQUMgb3IgQ1JD\nMzIKICAgICAqIEBwYXJhbSBwYXNzd2QKICAgICAqICAgICAgICAgIHBhc3N3\nb3JkCiAgICAgKiBAcmV0dXJuIGEgaGFuZGxlIHRvIHRoZSBvcGVuIGxlZGdl\ncgogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICog\nQHRocm93cyBCS0V4Y2VwdGlvbgogICAgICovCgogICAgcHVibGljIExlZGdl\nckhhbmRsZSBvcGVuTGVkZ2VyKGxvbmcgbElkLCBEaWdlc3RUeXBlIGRpZ2Vz\ndFR5cGUsIGJ5dGUgcGFzc3dkW10pCiAgICAgICAgICAgIHRocm93cyBCS0V4\nY2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIFN5bmND\nb3VudGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAgICBj\nb3VudGVyLmluYygpOwoKICAgICAgICAvKgogICAgICAgICAqIENhbGxzIGFz\neW5jIG9wZW4gbGVkZ2VyCiAgICAgICAgICovCiAgICAgICAgYXN5bmNPcGVu\nTGVkZ2VyKGxJZCwgZGlnZXN0VHlwZSwgcGFzc3dkLCBuZXcgU3luY09wZW5D\nYWxsYmFjaygpLCBjb3VudGVyKTsKCiAgICAgICAgLyoKICAgICAgICAgKiBX\nYWl0CiAgICAgICAgICovCiAgICAgICAgY291bnRlci5ibG9jaygwKTsKICAg\nICAgICBpZiAoY291bnRlci5nZXRyYygpICE9IEJLRXhjZXB0aW9uLkNvZGUu\nT0spCiAgICAgICAgICAgIHRocm93IEJLRXhjZXB0aW9uLmNyZWF0ZShjb3Vu\ndGVyLmdldHJjKCkpOwoKICAgICAgICByZXR1cm4gY291bnRlci5nZXRMaCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25vdXMsIHVuc2FmZSBv\ncGVuIGxlZGdlciBjYWxsCiAgICAgKgogICAgICogQHNlZSAjYXN5bmNPcGVu\nTGVkZ2VyTm9SZWNvdmVyeQogICAgICogQHBhcmFtIGxJZAogICAgICogICAg\nICAgICAgbGVkZ2VyIGlkZW50aWZpZXIKICAgICAqIEBwYXJhbSBkaWdlc3RU\neXBlCiAgICAgKiAgICAgICAgICBkaWdlc3QgdHlwZSwgZWl0aGVyIE1BQyBv\nciBDUkMzMgogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogICAgICAgICAg\ncGFzc3dvcmQKICAgICAqIEByZXR1cm4gYSBoYW5kbGUgdG8gdGhlIG9wZW4g\nbGVkZ2VyCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAg\nICAgKiBAdGhyb3dzIEJLRXhjZXB0aW9uCiAgICAgKi8KCiAgICBwdWJsaWMg\nTGVkZ2VySGFuZGxlIG9wZW5MZWRnZXJOb1JlY292ZXJ5KGxvbmcgbElkLCBE\naWdlc3RUeXBlIGRpZ2VzdFR5cGUsIGJ5dGUgcGFzc3dkW10pCiAgICAgICAg\nICAgIHRocm93cyBCS0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24g\newogICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50\nZXIoKTsKICAgICAgICBjb3VudGVyLmluYygpOwoKICAgICAgICAvKgogICAg\nICAgICAqIENhbGxzIGFzeW5jIG9wZW4gbGVkZ2VyCiAgICAgICAgICovCiAg\nICAgICAgYXN5bmNPcGVuTGVkZ2VyTm9SZWNvdmVyeShsSWQsIGRpZ2VzdFR5\ncGUsIHBhc3N3ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBTeW5jT3BlbkNhbGxiYWNrKCksIGNvdW50ZXIpOwoKICAgICAgICAv\nKgogICAgICAgICAqIFdhaXQKICAgICAgICAgKi8KICAgICAgICBjb3VudGVy\nLmJsb2NrKDApOwogICAgICAgIGlmIChjb3VudGVyLmdldHJjKCkgIT0gQktF\neGNlcHRpb24uQ29kZS5PSykKICAgICAgICAgICAgdGhyb3cgQktFeGNlcHRp\nb24uY3JlYXRlKGNvdW50ZXIuZ2V0cmMoKSk7CgogICAgICAgIHJldHVybiBj\nb3VudGVyLmdldExoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxldGVz\nIGEgbGVkZ2VyIGFzeW5jaHJvbm91c2x5LgogICAgICoKICAgICAqIEBwYXJh\nbSBsSWQKICAgICAqICAgICAgICAgICAgbGVkZ2VyIElkCiAgICAgKiBAcGFy\nYW0gY2IKICAgICAqICAgICAgICAgICAgZGVsZXRlQ2FsbGJhY2sgaW1wbGVt\nZW50YXRpb24KICAgICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgICAg\nb3B0aW9uYWwgY29udHJvbCBvYmplY3QKICAgICAqLwogICAgcHVibGljIHZv\naWQgYXN5bmNEZWxldGVMZWRnZXIoZmluYWwgbG9uZyBsSWQsIGZpbmFsIERl\nbGV0ZUNhbGxiYWNrIGNiLCBmaW5hbCBPYmplY3QgY3R4KSB7CiAgICAgICAg\nbmV3IExlZGdlckRlbGV0ZU9wKEJvb2tLZWVwZXIudGhpcywgbElkLCBjYiwg\nY3R4KS5pbml0aWF0ZSgpOwogICAgfQoKCiAgICAvKioKICAgICAqIFN5bmNo\ncm9ub3VzIGNhbGwgdG8gZGVsZXRlIGEgbGVkZ2VyLiBQYXJhbWV0ZXJzIG1h\ndGNoIHRob3NlIG9mCiAgICAgKiB7QGxpbmsgI2FzeW5jRGVsZXRlTGVkZ2Vy\nKGxvbmcsIEFzeW5jQ2FsbGJhY2suRGVsZXRlQ2FsbGJhY2ssIE9iamVjdCl9\nCiAgICAgKgogICAgICogQHBhcmFtIGxJZAogICAgICogICAgICAgICAgICBs\nZWRnZXJJZAogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgog\nICAgICogQHRocm93cyBCS0V4Y2VwdGlvbi5CS05vU3VjaExlZGdlckV4aXN0\nc0V4Y2VwdGlvbiBpZiB0aGUgbGVkZ2VyIGRvZXNuJ3QgZXhpc3QKICAgICAq\nIEB0aHJvd3MgQktFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQg\nZGVsZXRlTGVkZ2VyKGxvbmcgbElkKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNl\ncHRpb24sIEJLRXhjZXB0aW9uIHsKICAgICAgICBTeW5jQ291bnRlciBjb3Vu\ndGVyID0gbmV3IFN5bmNDb3VudGVyKCk7CiAgICAgICAgY291bnRlci5pbmMo\nKTsKICAgICAgICAvLyBDYWxsIGFzeW5jaHJvbm91cyB2ZXJzaW9uCiAgICAg\nICAgYXN5bmNEZWxldGVMZWRnZXIobElkLCBuZXcgU3luY0RlbGV0ZUNhbGxi\nYWNrKCksIGNvdW50ZXIpOwogICAgICAgIC8vIFdhaXQKICAgICAgICBjb3Vu\ndGVyLmJsb2NrKDApOwogICAgICAgIGlmIChjb3VudGVyLmdldHJjKCkgIT0g\nQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAgICBMT0cuZXJyb3Io\nIkVycm9yIGRlbGV0aW5nIGxlZGdlciAiICsgbElkICsgIiA6ICIgKyBjb3Vu\ndGVyLmdldHJjKCkpOwogICAgICAgICAgICB0aHJvdyBCS0V4Y2VwdGlvbi5j\ncmVhdGUoY291bnRlci5nZXRyYygpKTsKICAgICAgICB9CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogQ2hlY2sgYXN5bmNocm9ub3VzbHkgd2hldGhlciB0\naGUgbGVkZ2VyIHdpdGggaWRlbnRpZmllciA8aT5sSWQ8L2k+CiAgICAgKiBo\nYXMgYmVlbiBjbG9zZWQuCiAgICAgKiAKICAgICAqIEBwYXJhbSBsSWQgICBs\nZWRnZXIgaWRlbnRpZmllcgogICAgICogQHBhcmFtIGNiICAgIGNhbGxiYWNr\nIG1ldGhvZAogICAgICovCiAgICBwdWJsaWMgdm9pZCBhc3luY0lzQ2xvc2Vk\nKGxvbmcgbElkLCBmaW5hbCBJc0Nsb3NlZENhbGxiYWNrIGNiLCBmaW5hbCBP\nYmplY3QgY3R4KXsKICAgICAgICBsZWRnZXJNYW5hZ2VyLnJlYWRMZWRnZXJN\nZXRhZGF0YShsSWQsIG5ldyBHZW5lcmljQ2FsbGJhY2s8TGVkZ2VyTWV0YWRh\ndGE+KCl7CiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBs\nZXRlKGludCByYywgTGVkZ2VyTWV0YWRhdGEgbG0pewogICAgICAgICAgICAg\nICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAg\nICAgICAgICAgICBjYi5pc0Nsb3NlZENvbXBsZXRlKHJjLCBsbS5pc0Nsb3Nl\nZCgpLCBjdHgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICBjYi5pc0Nsb3NlZENvbXBsZXRlKHJjLCBmYWxzZSwgY3R4\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0p\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENoZWNrIHdoZXRoZXIgdGhl\nIGxlZGdlciB3aXRoIGlkZW50aWZpZXIgPGk+bElkPC9pPgogICAgICogaGFz\nIGJlZW4gY2xvc2VkLgogICAgICogCiAgICAgKiBAcGFyYW0gbElkCiAgICAg\nKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBpZiBsZWRnZXIgaGFzIGJlZW4gY2xv\nc2VkCiAgICAgKiBAdGhyb3dzIEJLRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGlzQ2xvc2VkKGxvbmcgbElkKQogICAgdGhyb3dzIEJL\nRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgZmlu\nYWwgY2xhc3MgUmVzdWx0IHsKICAgICAgICAgICAgaW50IHJjOwogICAgICAg\nICAgICBib29sZWFuIGlzQ2xvc2VkOwogICAgICAgICAgICBmaW5hbCBDb3Vu\ndERvd25MYXRjaCBub3RpZmllciA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsK\nICAgICAgICB9CgogICAgICAgIGZpbmFsIFJlc3VsdCByZXN1bHQgPSBuZXcg\nUmVzdWx0KCk7CgogICAgICAgIGZpbmFsIElzQ2xvc2VkQ2FsbGJhY2sgY2Ig\nPSBuZXcgSXNDbG9zZWRDYWxsYmFjaygpewogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBpc0Nsb3NlZENvbXBsZXRlKGludCByYywgYm9vbGVhbiBpc0Nsb3Nl\nZCwgT2JqZWN0IGN0eCl7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmlz\nQ2xvc2VkID0gaXNDbG9zZWQ7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0\nLnJjID0gcmM7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lm5vdGlmaWVy\nLmNvdW50RG93bigpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAg\nICAgLyoKICAgICAgICAgKiBDYWxsIGFzeW5jaHJvbm91cyB2ZXJzaW9uIG9m\nIGlzQ2xvc2VkCiAgICAgICAgICovCiAgICAgICAgYXN5bmNJc0Nsb3NlZChs\nSWQsIGNiLCBudWxsKTsKICAgICAgICAKICAgICAgICAvKgogICAgICAgICAq\nIFdhaXQgZm9yIGNhbGxiYWNrCiAgICAgICAgICovCiAgICAgICAgcmVzdWx0\nLm5vdGlmaWVyLmF3YWl0KCk7CiAgICAgICAgCiAgICAgICAgaWYgKHJlc3Vs\ndC5yYyAhPSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIHRo\ncm93IEJLRXhjZXB0aW9uLmNyZWF0ZShyZXN1bHQucmMpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0LmlzQ2xvc2VkOwogICAg\nfQoKICAgIC8qKgogICAgICogU2h1dHMgZG93biBjbGllbnQuCiAgICAgKgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAgIHNjaGVkdWxl\nci5zaHV0ZG93bigpOwogICAgICAgIGlmICghc2NoZWR1bGVyLmF3YWl0VGVy\nbWluYXRpb24oMTAsIFRpbWVVbml0LlNFQ09ORFMpKSB7CiAgICAgICAgICAg\nIExPRy53YXJuKCJUaGUgc2NoZWR1bGVyIGRpZCBub3Qgc2h1dGRvd24gY2xl\nYW5seSIpOwogICAgICAgIH0KICAgICAgICBtYWluV29ya2VyUG9vbC5zaHV0\nZG93bigpOwogICAgICAgIGlmICghbWFpbldvcmtlclBvb2wuYXdhaXRUZXJt\naW5hdGlvbigxMCwgVGltZVVuaXQuU0VDT05EUykpIHsKICAgICAgICAgICAg\nTE9HLndhcm4oIlRoZSBtYWluV29ya2VyUG9vbCBkaWQgbm90IHNodXRkb3du\nIGNsZWFubHkiKTsKICAgICAgICB9CgogICAgICAgIGJvb2tpZUNsaWVudC5j\nbG9zZSgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxlZGdlck1hbmFn\nZXIuY2xvc2UoKTsKICAgICAgICAgICAgbGVkZ2VyTWFuYWdlckZhY3Rvcnku\ndW5pbml0aWFsaXplKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naWUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJGYWlsZWQgdG8gY2xvc2Ug\nbGVkZ2VyIG1hbmFnZXIgOiAiLCBpZSk7CiAgICAgICAgfQoKICAgICAgICBp\nZiAob3duQ2hhbm5lbEZhY3RvcnkpIHsKICAgICAgICAgICAgY2hhbm5lbEZh\nY3RvcnkucmVsZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7CiAgICAgICAgfQog\nICAgICAgIGlmIChvd25aS0hhbmRsZSkgewogICAgICAgICAgICB6ay5jbG9z\nZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFz\ncyBTeW5jQ3JlYXRlQ2FsbGJhY2sgaW1wbGVtZW50cyBDcmVhdGVDYWxsYmFj\nayB7CiAgICAgICAgLyoqCiAgICAgICAgICogQ3JlYXRlIGNhbGxiYWNrIGlt\ncGxlbWVudGF0aW9uIGZvciBzeW5jaHJvbm91cyBjcmVhdGUgY2FsbC4KICAg\nICAgICAgKgogICAgICAgICAqIEBwYXJhbSByYwogICAgICAgICAqICAgICAg\nICAgIHJldHVybiBjb2RlCiAgICAgICAgICogQHBhcmFtIGxoCiAgICAgICAg\nICogICAgICAgICAgbGVkZ2VyIGhhbmRsZSBvYmplY3QKICAgICAgICAgKiBA\ncGFyYW0gY3R4CiAgICAgICAgICogICAgICAgICAgb3B0aW9uYWwgY29udHJv\nbCBvYmplY3QKICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBjcmVh\ndGVDb21wbGV0ZShpbnQgcmMsIExlZGdlckhhbmRsZSBsaCwgT2JqZWN0IGN0\neCkgewogICAgICAgICAgICBTeW5jQ291bnRlciBjb3VudGVyID0gKFN5bmND\nb3VudGVyKSBjdHg7CiAgICAgICAgICAgIGNvdW50ZXIuc2V0TGgobGgpOwog\nICAgICAgICAgICBjb3VudGVyLnNldHJjKHJjKTsKICAgICAgICAgICAgY291\nbnRlci5kZWMoKTsKICAgICAgICB9CiAgICB9CgogICAgc3RhdGljIGNsYXNz\nIFN5bmNPcGVuQ2FsbGJhY2sgaW1wbGVtZW50cyBPcGVuQ2FsbGJhY2sgewog\nICAgICAgIC8qKgogICAgICAgICAqIENhbGxiYWNrIG1ldGhvZCBmb3Igc3lu\nY2hyb25vdXMgb3BlbiBvcGVyYXRpb24KICAgICAgICAgKgogICAgICAgICAq\nIEBwYXJhbSByYwogICAgICAgICAqICAgICAgICAgIHJldHVybiBjb2RlCiAg\nICAgICAgICogQHBhcmFtIGxoCiAgICAgICAgICogICAgICAgICAgbGVkZ2Vy\nIGhhbmRsZQogICAgICAgICAqIEBwYXJhbSBjdHgKICAgICAgICAgKiAgICAg\nICAgICBvcHRpb25hbCBjb250cm9sIG9iamVjdAogICAgICAgICAqLwogICAg\nICAgIHB1YmxpYyB2b2lkIG9wZW5Db21wbGV0ZShpbnQgcmMsIExlZGdlckhh\nbmRsZSBsaCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICBTeW5jQ291bnRl\nciBjb3VudGVyID0gKFN5bmNDb3VudGVyKSBjdHg7CiAgICAgICAgICAgIGNv\ndW50ZXIuc2V0TGgobGgpOwogICAgICAgICAgICAKICAgICAgICAgICAgTE9H\nLmRlYnVnKCJPcGVuIGNvbXBsZXRlOiB7fSIsIHJjKTsKICAgICAgICAgICAg\nCiAgICAgICAgICAgIGNvdW50ZXIuc2V0cmMocmMpOwogICAgICAgICAgICBj\nb3VudGVyLmRlYygpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0\nYXRpYyBjbGFzcyBTeW5jRGVsZXRlQ2FsbGJhY2sgaW1wbGVtZW50cyBEZWxl\ndGVDYWxsYmFjayB7CiAgICAgICAgLyoqCiAgICAgICAgICogRGVsZXRlIGNh\nbGxiYWNrIGltcGxlbWVudGF0aW9uIGZvciBzeW5jaHJvbm91cyBkZWxldGUg\nY2FsbC4KICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSByYwogICAgICAg\nICAqICAgICAgICAgICAgcmV0dXJuIGNvZGUKICAgICAgICAgKiBAcGFyYW0g\nY3R4CiAgICAgICAgICogICAgICAgICAgICBvcHRpb25hbCBjb250cm9sIG9i\namVjdAogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGRlbGV0ZUNv\nbXBsZXRlKGludCByYywgT2JqZWN0IGN0eCkgewogICAgICAgICAgICBTeW5j\nQ291bnRlciBjb3VudGVyID0gKFN5bmNDb3VudGVyKSBjdHg7CiAgICAgICAg\nICAgIGNvdW50ZXIuc2V0cmMocmMpOwogICAgICAgICAgICBjb3VudGVyLmRl\nYygpOwogICAgICAgIH0KICAgIH0KCgoKfQo=\n","encoding":"base64"}

