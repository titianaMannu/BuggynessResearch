{"sha":"8861c1a3b283fcca2697c1e788ea7f8a8cfb5b52","node_id":"MDQ6QmxvYjE1NzU5NTY6ODg2MWMxYTNiMjgzZmNjYTI2OTdjMWU3ODhlYTdmOGE4Y2ZiNWI1Mg==","size":6866,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8861c1a3b283fcca2697c1e788ea7f8a8cfb5b52","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNv\nZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq\nIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmltcG9ydCBq\nYXZhLnV0aWwuRW51bWVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5TY2hlZHVsZWRFeGVjdXRvclNlcnZpY2U7CgppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLkFkZENhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3lu\nY0NhbGxiYWNrLkNsb3NlQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suUmVhZENhbGxiYWNrOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5EaWdlc3RNYW5h\nZ2VyLlJlY292ZXJ5RGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0Nh\nbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5z\nbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFRoaXMgY2xhc3MgZW5jYXBz\ndWxhdGVkIHRoZSBsZWRnZXIgcmVjb3Zlcnkgb3BlcmF0aW9uLiBJdCBmaXJz\ndCBkb2VzIGEgcmVhZAogKiB3aXRoIGVudHJ5LWlkIG9mIC0xIChCb29raWVQ\ncm90b2NvbC5MQVNUX0FERF9DT05GSVJNRUQpIHRvIGFsbCBib29raWVzLiBU\naGVuCiAqIHN0YXJ0aW5nIGZyb20gdGhlIGxhc3QgY29uZmlybWVkIGVudHJ5\nIChmcm9tIGhpbnRzIGluIHRoZSBsZWRnZXIgZW50cmllcyksCiAqIGl0IHJl\nYWRzIGZvcndhcmQgdW50aWwgaXQgaXMgbm90IGFibGUgdG8gZmluZCBhIHBh\ncnRpY3VsYXIgZW50cnkuIEl0IGNsb3NlcwogKiB0aGUgbGVkZ2VyIGF0IHRo\nYXQgZW50cnkuCiAqCiAqLwpjbGFzcyBMZWRnZXJSZWNvdmVyeU9wIGltcGxl\nbWVudHMgUmVhZENhbGxiYWNrLCBBZGRDYWxsYmFjayB7CiAgICBzdGF0aWMg\nZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKExl\nZGdlclJlY292ZXJ5T3AuY2xhc3MpOwogICAgTGVkZ2VySGFuZGxlIGxoOwog\nICAgaW50IG51bVJlc3BvbnNlc1BlbmRpbmc7CiAgICBib29sZWFuIHByb2Nl\nZWRpbmdXaXRoUmVjb3ZlcnkgPSBmYWxzZTsKICAgIGxvbmcgbWF4QWRkUHVz\naGVkID0gTGVkZ2VySGFuZGxlLklOVkFMSURfRU5UUllfSUQ7CiAgICBsb25n\nIG1heEFkZENvbmZpcm1lZCA9IExlZGdlckhhbmRsZS5JTlZBTElEX0VOVFJZ\nX0lEOwogICAgbG9uZyBtYXhMZW5ndGggPSAwOwogICAgLy8ga2VlcCBhIGNv\ncHkgb2YgbWV0YWRhdGEgZm9yIHJlY292ZXJ5LgogICAgTGVkZ2VyTWV0YWRh\ndGEgbWV0YWRhdGFGb3JSZWNvdmVyeTsKCiAgICBHZW5lcmljQ2FsbGJhY2s8\nVm9pZD4gY2I7CgogICAgY2xhc3MgUmVjb3ZlcnlSZWFkT3AgZXh0ZW5kcyBQ\nZW5kaW5nUmVhZE9wIHsKCiAgICAgICAgUmVjb3ZlcnlSZWFkT3AoTGVkZ2Vy\nSGFuZGxlIGxoLCBTY2hlZHVsZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1bGVy\nLCBsb25nIHN0YXJ0RW50cnlJZCwKICAgICAgICAgICAgICAgIGxvbmcgZW5k\nRW50cnlJZCwgUmVhZENhbGxiYWNrIGNiLCBPYmplY3QgY3R4KSB7CiAgICAg\nICAgICAgIHN1cGVyKGxoLCBzY2hlZHVsZXIsIHN0YXJ0RW50cnlJZCwgZW5k\nRW50cnlJZCwgY2IsIGN0eCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwcm90ZWN0ZWQgTGVkZ2VyTWV0YWRhdGEgZ2V0TGVkZ2Vy\nTWV0YWRhdGEoKSB7CiAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YUZvclJl\nY292ZXJ5OwogICAgICAgIH0KCiAgICB9CgogICAgcHVibGljIExlZGdlclJl\nY292ZXJ5T3AoTGVkZ2VySGFuZGxlIGxoLCBHZW5lcmljQ2FsbGJhY2s8Vm9p\nZD4gY2IpIHsKICAgICAgICB0aGlzLmNiID0gY2I7CiAgICAgICAgdGhpcy5s\naCA9IGxoOwogICAgICAgIG51bVJlc3BvbnNlc1BlbmRpbmcgPSBsaC5tZXRh\nZGF0YS5nZXRFbnNlbWJsZVNpemUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBpbml0aWF0ZSgpIHsKICAgICAgICBSZWFkTGFzdENvbmZpcm1lZE9wIHJs\nY29wID0gbmV3IFJlYWRMYXN0Q29uZmlybWVkT3AobGgsCiAgICAgICAgICAg\nICAgICBuZXcgUmVhZExhc3RDb25maXJtZWRPcC5MYXN0Q29uZmlybWVkRGF0\nYUNhbGxiYWNrKCkgewogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHJlYWRMYXN0Q29uZmlybWVkRGF0YUNvbXBsZXRlKGludCByYywgUmVjb3Zl\ncnlEYXRhIGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJj\nID09IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGxoLmxhc3RBZGRQdXNoZWQgPSBsaC5sYXN0QWRkQ29uZmly\nbWVkID0gZGF0YS5sYXN0QWRkQ29uZmlybWVkOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbGgubGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAvLyBrZWVwIGEgY29weSBvZiBsZWRnZXIg\nbWV0YWRhdGEgYmVmb3JlIHByb2NlZWRpbmcKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIGxlZGdlciByZWNvdmVyeQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbWV0YWRhdGFGb3JSZWNvdmVyeSA9IG5ldyBMZWRnZXJN\nZXRhZGF0YShsaC5nZXRMZWRnZXJNZXRhZGF0YSgpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGRvUmVjb3ZlcnlSZWFkKCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0gZWxzZSBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29k\nZS5VbmF1dGhvcml6ZWRBY2Nlc3NFeGNlcHRpb24pIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKHJjLCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhj\nZXB0aW9uLkNvZGUuUmVhZEV4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9KTsKCiAgICAgICAgLyoqCiAgICAgICAgICogRW5hYmxlIGZl\nbmNpbmcgb24gdGhpcyBvcC4gV2hlbiB0aGUgcmVhZCByZXF1ZXN0IHJlYWNo\nZXMgdGhlIGJvb2tpZXMKICAgICAgICAgKiBzZXJ2ZXIgaXQgd2lsbCBmZW5j\nZSBvZmYgdGhlIGxlZGdlciwgc3RvcHBpbmcgYW55IHN1YnNlcXVlbnQgb3Bl\ncmF0aW9uCiAgICAgICAgICogZnJvbSB3cml0aW5nIHRvIGl0LgogICAgICAg\nICAqLwogICAgICAgIHJsY29wLmluaXRpYXRlV2l0aEZlbmNpbmcoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRyeSB0byByZWFkIHBhc3QgdGhlIGxhc3Qg\nY29uZmlybWVkLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZG9SZWNvdmVy\neVJlYWQoKSB7CiAgICAgICAgbG9uZyBuZXh0RW50cnkgPSBsaC5sYXN0QWRk\nQ29uZmlybWVkICsgMTsKICAgICAgICB0cnkgewogICAgICAgICAgICBuZXcg\nUmVjb3ZlcnlSZWFkT3AobGgsIGxoLmJrLnNjaGVkdWxlciwgbmV4dEVudHJ5\nLCBuZXh0RW50cnksIHRoaXMsIG51bGwpLmluaXRpYXRlKCk7CiAgICAgICAg\nfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICByZWFkQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5JbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwgbGgsIG51bGwsIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHJlYWRDb21wbGV0ZShpbnQg\ncmMsIExlZGdlckhhbmRsZSBsaCwgRW51bWVyYXRpb248TGVkZ2VyRW50cnk+\nIHNlcSwgT2JqZWN0IGN0eCkgewogICAgICAgIGlmIChyYyA9PSBCS0V4Y2Vw\ndGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIExlZGdlckVudHJ5IGVudHJ5\nID0gc2VxLm5leHRFbGVtZW50KCk7CiAgICAgICAgICAgIGJ5dGVbXSBkYXRh\nID0gZW50cnkuZ2V0RW50cnkoKTsKCiAgICAgICAgICAgIC8qCiAgICAgICAg\nICAgICAqIFdlIHdpbGwgYWRkIHRoaXMgZW50cnkgYWdhaW4gdG8gbWFrZSBz\ndXJlIGl0IGlzIHdyaXR0ZW4gdG8gZW5vdWdoCiAgICAgICAgICAgICAqIHJl\ncGxpY2FzLiBXZSBzdWJ0cmFjdCB0aGUgbGVuZ3RoIG9mIHRoZSBkYXRhIGl0\nc2VsZiwgc2luY2UgaXQgd2lsbAogICAgICAgICAgICAgKiBiZSBhZGRlZCBh\nZ2FpbiB3aGVuIHByb2Nlc3NpbmcgdGhlIGNhbGwgdG8gYWRkIGl0LgogICAg\nICAgICAgICAgKi8KICAgICAgICAgICAgc3luY2hyb25pemVkIChsaCkgewog\nICAgICAgICAgICAgICAgbGgubGVuZ3RoID0gZW50cnkuZ2V0TGVuZ3RoKCkg\nLSAobG9uZykgZGF0YS5sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgbGguYXN5bmNSZWNvdmVyeUFkZEVudHJ5KGRhdGEsIDAsIGRhdGEubGVu\nZ3RoLCB0aGlzLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KCiAgICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUuTm9TdWNo\nRW50cnlFeGNlcHRpb24gfHwgcmMgPT0gQktFeGNlcHRpb24uQ29kZS5Ob1N1\nY2hMZWRnZXJFeGlzdHNFeGNlcHRpb24pIHsKICAgICAgICAgICAgbGguYXN5\nbmNDbG9zZUludGVybmFsKG5ldyBDbG9zZUNhbGxiYWNrKCkgewogICAgICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBjbG9zZUNvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBPYmpl\nY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IEJLRXhj\nZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9H\nLndhcm4oIkNsb3NlIGZhaWxlZDogIiArIEJLRXhjZXB0aW9uLmdldE1lc3Nh\nZ2UocmMpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9u\nQ29tcGxldGUocmMsIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBs\nZXRlKEJLRXhjZXB0aW9uLkNvZGUuT0ssIG51bGwpOwogICAgICAgICAgICAg\nICAgICAgICAgICBMT0cuZGVidWcoIkFmdGVyIGNsb3NpbmcgbGVuZ3RoIGlz\nOiB7fSIsIGxoLmdldExlbmd0aCgpKTsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBudWxsLCBC\nS0V4Y2VwdGlvbi5Db2RlLkxlZGdlckNsb3NlZEV4Y2VwdGlvbik7CiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIG90aGVyd2lz\nZSwgc29tZSBvdGhlciBlcnJvciwgd2UgY2FuJ3QgaGFuZGxlCiAgICAgICAg\nTE9HLmVycm9yKCJGYWlsdXJlICIgKyBCS0V4Y2VwdGlvbi5nZXRNZXNzYWdl\nKHJjKSArICIgd2hpbGUgcmVhZGluZyBlbnRyeTogIiArIChsaC5sYXN0QWRk\nQ29uZmlybWVkICsgMSkKICAgICAgICAgICAgICAgICAgKyAiIGxlZGdlcjog\nIiArIGxoLmxlZGdlcklkICsgIiB3aGlsZSByZWNvdmVyaW5nIGxlZGdlciIp\nOwogICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKHJjLCBudWxsKTsKICAg\nICAgICByZXR1cm47CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCBhZGRDb21wbGV0ZShpbnQgcmMsIExlZGdlckhhbmRsZSBsaCwgbG9u\nZyBlbnRyeUlkLCBPYmplY3QgY3R4KSB7CiAgICAgICAgaWYgKHJjICE9IEJL\nRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgLy8gR2l2ZSB1cCwg\nd2UgY2FuJ3QgcmVjb3ZlciBmcm9tIHRoaXMgZXJyb3IKCiAgICAgICAgICAg\nIExPRy5lcnJvcigiRmFpbHVyZSAiICsgQktFeGNlcHRpb24uZ2V0TWVzc2Fn\nZShyYykgKyAiIHdoaWxlIHdyaXRpbmcgZW50cnk6ICIgKyAobGgubGFzdEFk\nZENvbmZpcm1lZCArIDEpCiAgICAgICAgICAgICAgICAgICAgICArICIgbGVk\nZ2VyOiAiICsgbGgubGVkZ2VySWQgKyAiIHdoaWxlIHJlY292ZXJpbmcgbGVk\nZ2VyIik7CiAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKHJjLCBu\ndWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBk\nb1JlY292ZXJ5UmVhZCgpOwogICAgfQoKfQo=\n","encoding":"base64"}

