{"sha":"48fa47aeb7b83a7178754eadac4c78c060397bee","node_id":"MDQ6QmxvYjE1NzU5NTY6NDhmYTQ3YWViN2I4M2E3MTc4NzU0ZWFkYWM0Yzc4YzA2MDM5N2JlZQ==","size":12341,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/48fa47aeb7b83a7178754eadac4c78c060397bee","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuTmF2aWdhYmxlU2V0OwppbXBvcnQgamF2YS51dGlsLlNl\ndDsKaW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlck1ldGFkYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQWJzdHJhY3RDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlcklu\ndGVybmFsQ2FsbGJhY2tzLk11bHRpQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJh\nY2tzLlByb2Nlc3NvcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51\ndGlsLkJvb2tLZWVwZXJDb25zdGFudHM7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIudXRpbC5aa1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnZlcnNpb25pbmcuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLkFzeW5jQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5Bc3luY0NhbGxiYWNrLkRhdGFDYWxsYmFjazsKaW1wb3J0IG9y\nZy5hcGFjaGUuem9va2VlcGVyLkFzeW5jQ2FsbGJhY2suU3RhdENhbGxiYWNr\nOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjay5W\nb2lkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVw\nZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVw\nZXJFeGNlcHRpb24uQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLmRhdGEu\nU3RhdDsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyRmFjdG9yeTsKCi8qKgogKiBBYnN0cmFjdCBsZWRnZXIgbWFu\nYWdlciBiYXNlZCBvbiB6b29rZWVwZXIsIHdoaWNoIHByb3ZpZGVzIGNvbW1v\nbiBtZXRob2RzIHN1Y2ggYXMgcXVlcnkgemsgbm9kZXMuCiAqLwphYnN0cmFj\ndCBjbGFzcyBBYnN0cmFjdFprTGVkZ2VyTWFuYWdlciBpbXBsZW1lbnRzIExl\nZGdlck1hbmFnZXIgewoKICAgIHN0YXRpYyBMb2dnZXIgTE9HID0gTG9nZ2Vy\nRmFjdG9yeS5nZXRMb2dnZXIoQWJzdHJhY3Raa0xlZGdlck1hbmFnZXIuY2xh\nc3MpOwoKICAgIHByb3RlY3RlZCBmaW5hbCBBYnN0cmFjdENvbmZpZ3VyYXRp\nb24gY29uZjsKICAgIHByb3RlY3RlZCBmaW5hbCBab29LZWVwZXIgems7CiAg\nICBwcm90ZWN0ZWQgZmluYWwgU3RyaW5nIGxlZGdlclJvb3RQYXRoOwoKICAg\nIC8qKgogICAgICogWm9vS2VlcGVyLWJhc2VkIExlZGdlciBNYW5hZ2VyIENv\nbnN0cnVjdG9yCiAgICAgKgogICAgICogQHBhcmFtIGNvbmYKICAgICAqICAg\nICAgICAgIENvbmZpZ3VyYXRpb24gb2JqZWN0CiAgICAgKiBAcGFyYW0gemsK\nICAgICAqICAgICAgICAgIFpvb0tlZXBlciBDbGllbnQgSGFuZGxlCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBBYnN0cmFjdFprTGVkZ2VyTWFuYWdlcihBYnN0\ncmFjdENvbmZpZ3VyYXRpb24gY29uZiwgWm9vS2VlcGVyIHprKSB7CiAgICAg\nICAgdGhpcy5jb25mID0gY29uZjsKICAgICAgICB0aGlzLnprID0gems7CiAg\nICAgICAgdGhpcy5sZWRnZXJSb290UGF0aCA9IGNvbmYuZ2V0WmtMZWRnZXJz\nUm9vdFBhdGgoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCB0aGUgem5v\nZGUgcGF0aCB0aGF0IGlzIHVzZWQgdG8gc3RvcmUgbGVkZ2VyIG1ldGFkYXRh\nCiAgICAgKgogICAgICogQHBhcmFtIGxlZGdlcklkCiAgICAgKiAgICAgICAg\nICBMZWRnZXIgSUQKICAgICAqIEByZXR1cm4gbGVkZ2VyIG5vZGUgcGF0aAog\nICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgU3RyaW5nIGdldExlZGdl\nclBhdGgobG9uZyBsZWRnZXJJZCk7CgogICAgLyoqCiAgICAgKiBHZXQgbGVk\nZ2VyIGlkIGZyb20gaXRzIHpub2RlIGxlZGdlciBwYXRoCiAgICAgKgogICAg\nICogQHBhcmFtIGxlZGdlclBhdGgKICAgICAqICAgICAgICAgIExlZGdlciBw\nYXRoIHRvIHN0b3JlIG1ldGFkYXRhCiAgICAgKiBAcmV0dXJuIGxlZGdlciBp\nZAogICAgICogQHRocm93cyBJT0V4Y2VwdGlvbiB3aGVuIHRoZSBsZWRnZXIg\ncGF0aCBpcyBpbnZhbGlkCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFj\ndCBsb25nIGdldExlZGdlcklkKFN0cmluZyBsZWRnZXJQYXRoKSB0aHJvd3Mg\nSU9FeGNlcHRpb247CgogICAgLyoqCiAgICAgKiBSZW1vdmVzIGxlZGdlciBt\nZXRhZGF0YSBmcm9tIFpvb0tlZXBlciBpZiB2ZXJzaW9uIG1hdGNoZXMuCiAg\nICAgKgogICAgICogQHBhcmFtICAgbGVkZ2VySWQgICAgbGVkZ2VyIGlkZW50\naWZpZXIKICAgICAqIEBwYXJhbSAgIHZlcnNpb24gICAgIGxvY2FsIHZlcnNp\nb24gb2YgbWV0YWRhdGEgem5vZGUKICAgICAqIEBwYXJhbSAgIGNiICAgICAg\nICAgIGNhbGxiYWNrIG9iamVjdAogICAgICovCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyB2b2lkIHJlbW92ZUxlZGdlck1ldGFkYXRhKGZpbmFsIGxvbmcg\nbGVkZ2VySWQsIGZpbmFsIFZlcnNpb24gdmVyc2lvbiwKICAgICAgICAgICAg\nZmluYWwgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+IGNiKSB7CiAgICAgICAgaW50\nIHpub2RlVmVyc2lvbiA9IC0xOwogICAgICAgIGlmIChWZXJzaW9uLk5FVyA9\nPSB2ZXJzaW9uKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiUmVxdWVzdCB0\nbyBkZWxldGUgbGVkZ2VyIHt9IG1ldGFkYXRhIHdpdGggdmVyc2lvbiBzZXQg\ndG8gdGhlIGluaXRpYWwgb25lIiwgbGVkZ2VySWQpOwogICAgICAgICAgICBj\nYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLk1ldGFkYXRh\nVmVyc2lvbkV4Y2VwdGlvbiwgKFZvaWQpbnVsbCk7CiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB9IGVsc2UgaWYgKFZlcnNpb24uQU5ZICE9IHZlcnNp\nb24pIHsKICAgICAgICAgICAgaWYgKCEodmVyc2lvbiBpbnN0YW5jZW9mIFpr\nVmVyc2lvbikpIHsKICAgICAgICAgICAgICAgIExPRy5pbmZvKCJOb3QgYW4g\naW5zdGFuY2Ugb2YgWktWZXJzaW9uOiB7fSIsIGxlZGdlcklkKTsKICAgICAg\nICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNv\nZGUuTWV0YWRhdGFWZXJzaW9uRXhjZXB0aW9uLCAoVm9pZCludWxsKTsKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgICAgIHpub2RlVmVyc2lvbiA9ICgoWmtWZXJzaW9uKXZlcnNp\nb24pLmdldFpub2RlVmVyc2lvbigpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICB6ay5kZWxldGUoZ2V0TGVkZ2VyUGF0aChsZWRnZXJJZCks\nIHpub2RlVmVyc2lvbiwgbmV3IFZvaWRDYWxsYmFjaygpIHsKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NS\nZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCkgewogICAg\nICAgICAgICAgICAgaW50IGJrUmM7CiAgICAgICAgICAgICAgICBpZiAocmMg\nPT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuTk9OT0RFLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgICAgICAgICBMT0cud2FybigiTGVkZ2VyIG5vZGUgZG9l\ncyBub3QgZXhpc3QgaW4gWm9vS2VlcGVyOiBsZWRnZXJJZD17fSIsIGxlZGdl\ncklkKTsKICAgICAgICAgICAgICAgICAgICBia1JjID0gQktFeGNlcHRpb24u\nQ29kZS5Ob1N1Y2hMZWRnZXJFeGlzdHNFeGNlcHRpb247CiAgICAgICAgICAg\nICAgICB9IGVsc2UgaWYgKHJjID09IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9L\nLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBia1JjID0gQktF\neGNlcHRpb24uQ29kZS5PSzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgYmtSYyA9IEJLRXhjZXB0aW9uLkNvZGUuWktF\neGNlcHRpb247CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBj\nYi5vcGVyYXRpb25Db21wbGV0ZShia1JjLCAoVm9pZCludWxsKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0sIG51bGwpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIHZvaWQgcmVhZExlZGdlck1ldGFkYXRhKGZpbmFsIGxv\nbmcgbGVkZ2VySWQsIGZpbmFsIEdlbmVyaWNDYWxsYmFjazxMZWRnZXJNZXRh\nZGF0YT4gcmVhZENiKSB7CiAgICAgICAgemsuZ2V0RGF0YShnZXRMZWRnZXJQ\nYXRoKGxlZGdlcklkKSwgZmFsc2UsIG5ldyBEYXRhQ2FsbGJhY2soKSB7CiAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBw\ncm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgs\nIGJ5dGVbXSBkYXRhLCBTdGF0IHN0YXQpIHsKICAgICAgICAgICAgICAgIGlm\nIChyYyA9PSBLZWVwZXJFeGNlcHRpb24uQ29kZS5OT05PREUuaW50VmFsdWUo\nKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChMT0cuaXNEZWJ1Z0VuYWJs\nZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoIk5v\nIHN1Y2ggbGVkZ2VyOiAiICsgbGVkZ2VySWQsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBl\nckV4Y2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVhZENiLm9wZXJhdGlv\nbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuTm9TdWNoTGVkZ2VyRXhpc3Rz\nRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocmMgIT0g\nS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAg\nICAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGQgbm90IHJlYWQgbWV0YWRh\ndGEgZm9yIGxlZGdlcjogIiArIGxlZGdlcklkLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4\nY2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAgICAg\nICAgICByZWFkQ2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29k\nZS5aS0V4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIExlZGdl\nck1ldGFkYXRhIG1ldGFkYXRhOwogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IExlZGdlck1ldGFkYXRhLnBh\ncnNlQ29uZmlnKGRhdGEsIG5ldyBaa1ZlcnNpb24oc3RhdC5nZXRWZXJzaW9u\nKCkpKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkNvdWxkIG5vdCBw\nYXJzZSBsZWRnZXIgbWV0YWRhdGEgZm9yIGxlZGdlcjogIiArIGxlZGdlcklk\nLCBlKTsKICAgICAgICAgICAgICAgICAgICByZWFkQ2Iub3BlcmF0aW9uQ29t\ncGxldGUoQktFeGNlcHRpb24uQ29kZS5aS0V4Y2VwdGlvbiwgbnVsbCk7CiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgcmVhZENiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhj\nZXB0aW9uLkNvZGUuT0ssIG1ldGFkYXRhKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0sIG51bGwpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIHZvaWQgd3JpdGVMZWRnZXJNZXRhZGF0YShmaW5hbCBsb25nIGxlZGdlcklk\nLCBmaW5hbCBMZWRnZXJNZXRhZGF0YSBtZXRhZGF0YSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgR2VuZXJpY0NhbGxiYWNr\nPFZvaWQ+IGNiKSB7CiAgICAgICAgVmVyc2lvbiB2ID0gbWV0YWRhdGEuZ2V0\nVmVyc2lvbigpOwogICAgICAgIGlmIChWZXJzaW9uLk5FVyA9PSB2IHx8ICEo\ndiBpbnN0YW5jZW9mIFprVmVyc2lvbikpIHsKICAgICAgICAgICAgY2Iub3Bl\ncmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5NZXRhZGF0YVZlcnNp\nb25FeGNlcHRpb24sIG51bGwpOwogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgfQogICAgICAgIGZpbmFsIFprVmVyc2lvbiB6diA9IChaa1ZlcnNpb24p\nIHY7CiAgICAgICAgemsuc2V0RGF0YShnZXRMZWRnZXJQYXRoKGxlZGdlcklk\nKSwKICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLnNlcmlhbGl6ZSgpLCB6\ndi5nZXRabm9kZVZlcnNpb24oKSwKICAgICAgICAgICAgICAgICAgIG5ldyBT\ndGF0Q2FsbGJhY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAg\nICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5n\nIHBhdGgsIE9iamVjdCBjdHgsIFN0YXQgc3RhdCkgewogICAgICAgICAgICAg\nICAgaWYgKEtlZXBlckV4Y2VwdGlvbi5Db2RlLkJhZFZlcnNpb24gPT0gcmMp\nIHsKICAgICAgICAgICAgICAgICAgICBjYi5vcGVyYXRpb25Db21wbGV0ZShC\nS0V4Y2VwdGlvbi5Db2RlLk1ldGFkYXRhVmVyc2lvbkV4Y2VwdGlvbiwgbnVs\nbCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEtlZXBlckV4Y2VwdGlv\nbi5Db2RlLk9LLmludFZhbHVlKCkgPT0gcmMpIHsKICAgICAgICAgICAgICAg\nICAgICAvLyB1cGRhdGUgbWV0YWRhdGEgdmVyc2lvbgogICAgICAgICAgICAg\nICAgICAgIG1ldGFkYXRhLnNldFZlcnNpb24oenYuc2V0Wm5vZGVWZXJzaW9u\nKHN0YXQuZ2V0VmVyc2lvbigpKSk7CiAgICAgICAgICAgICAgICAgICAgY2Iu\nb3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5PSywgbnVsbCk7\nCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIExPRy53YXJuKCJDb25kaXRpb25hbCB1cGRhdGUgbGVkZ2VyIG1ldGFkYXRh\nIGZhaWxlZDogIiwgS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSk7CiAg\nICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNl\ncHRpb24uQ29kZS5aS0V4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LCBudWxsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFByb2Nlc3MgbGVkZ2VycyBpbiBhIHNpbmdsZSB6ayBu\nb2RlLgogICAgICoKICAgICAqIDxwPgogICAgICogZm9yIGVhY2ggbGVkZ2Vy\nIGZvdW5kIGluIHRoaXMgemsgbm9kZSwgcHJvY2Vzc29yI3Byb2Nlc3MobGVk\nZ2VySWQpIHdpbGwgYmUgdHJpZ2dlcnJlZAogICAgICogdG8gcHJvY2VzcyBh\nIHNwZWNpZmljIGxlZGdlci4gYWZ0ZXIgYWxsIGxlZGdlcnMgaGFzIGJlZW4g\ncHJvY2Vzc2VkLCB0aGUgZmluYWxDYiB3aWxsCiAgICAgKiBiZSBjYWxsZWQg\nd2l0aCBwcm92aWRlZCBjb250ZXh0IG9iamVjdC4gVGhlIFJDIHBhc3NlZCB0\nbyBmaW5hbENiIGlzIGRlY2lkZWQgYnkgOgogICAgICogPHVsPgogICAgICog\nPGxpPiBBbGwgbGVkZ2VycyBhcmUgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseSwg\nc3VjY2Vzc1JjIHdpbGwgYmUgcGFzc2VkLgogICAgICogPGxpPiBFaXRoZXIg\nbGVkZ2VyIGlzIHByb2Nlc3NlZCBmYWlsZWQsIGZhaWx1cmVSYyB3aWxsIGJl\nIHBhc3NlZC4KICAgICAqIDwvdWw+CiAgICAgKiA8L3A+CiAgICAgKgogICAg\nICogQHBhcmFtIHBhdGgKICAgICAqICAgICAgICAgIFprIG5vZGUgcGF0aCB0\nbyBzdG9yZSBsZWRnZXJzCiAgICAgKiBAcGFyYW0gcHJvY2Vzc29yCiAgICAg\nKiAgICAgICAgICBQcm9jZXNzb3IgcHJvdmlkZWQgdG8gcHJvY2VzcyBsZWRn\nZXIKICAgICAqIEBwYXJhbSBmaW5hbENiCiAgICAgKiAgICAgICAgICBDYWxs\nYmFjayBvYmplY3Qgd2hlbiBhbGwgbGVkZ2VycyBhcmUgcHJvY2Vzc2VkCiAg\nICAgKiBAcGFyYW0gY3R4CiAgICAgKiAgICAgICAgICBDb250ZXh0IG9iamVj\ndCBwYXNzZWQgdG8gZmluYWxDYgogICAgICogQHBhcmFtIHN1Y2Nlc3NSYwog\nICAgICogICAgICAgICAgUkMgcGFzc2VkIHRvIGZpbmFsQ2Igd2hlbiBhbGwg\nbGVkZ2VycyBhcmUgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseQogICAgICogQHBh\ncmFtIGZhaWx1cmVSYwogICAgICogICAgICAgICAgUkMgcGFzc2VkIHRvIGZp\nbmFsQ2Igd2hlbiBlaXRoZXIgbGVkZ2VyIGlzIHByb2Nlc3NlZCBmYWlsZWQK\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgYXN5bmNQcm9jZXNzTGVkZ2Vy\nc0luU2luZ2xlTm9kZSgKICAgICAgICAgICAgZmluYWwgU3RyaW5nIHBhdGgs\nIGZpbmFsIFByb2Nlc3NvcjxMb25nPiBwcm9jZXNzb3IsCiAgICAgICAgICAg\nIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGZpbmFsQ2IsIGZp\nbmFsIE9iamVjdCBjdHgsCiAgICAgICAgICAgIGZpbmFsIGludCBzdWNjZXNz\nUmMsIGZpbmFsIGludCBmYWlsdXJlUmMpIHsKICAgICAgICBaa1V0aWxzLmdl\ndENoaWxkcmVuSW5TaW5nbGVOb2RlKHprLCBwYXRoLCBuZXcgR2VuZXJpY0Nh\nbGxiYWNrPExpc3Q8U3RyaW5nPj4oKSB7CiAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShp\nbnQgcmMsIExpc3Q8U3RyaW5nPiBsZWRnZXJOb2RlcykgewogICAgICAgICAg\nICAgICAgaWYgKENvZGUuT0suaW50VmFsdWUoKSAhPSByYykgewogICAgICAg\nICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jlc3VsdChmYWlsdXJlUmMs\nIG51bGwsIGN0eCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFNldDxMb25nPiB6a0Fj\ndGl2ZUxlZGdlcnMgPSBsZWRnZXJMaXN0VG9TZXQobGVkZ2VyTm9kZXMsIHBh\ndGgpOwogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJQcm9jZXNzaW5nIGxl\nZGdlcnM6IHt9IiwgemtBY3RpdmVMZWRnZXJzKTsKCiAgICAgICAgICAgICAg\nICAvLyBubyBsZWRnZXJzIGZvdW5kLCByZXR1cm4gZGlyZWN0bHkKICAgICAg\nICAgICAgICAgIGlmICh6a0FjdGl2ZUxlZGdlcnMuc2l6ZSgpID09IDApIHsK\nICAgICAgICAgICAgICAgICAgICBmaW5hbENiLnByb2Nlc3NSZXN1bHQoc3Vj\nY2Vzc1JjLCBudWxsLCBjdHgpOwogICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBNdWx0aUNh\nbGxiYWNrIG1jYiA9IG5ldyBNdWx0aUNhbGxiYWNrKHprQWN0aXZlTGVkZ2Vy\ncy5zaXplKCksIGZpbmFsQ2IsIGN0eCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc1JjLCBm\nYWlsdXJlUmMpOwogICAgICAgICAgICAgICAgLy8gc3RhcnQgbG9vcCBvdmVy\nIGFsbCBsZWRnZXJzCiAgICAgICAgICAgICAgICBmb3IgKExvbmcgbGVkZ2Vy\nIDogemtBY3RpdmVMZWRnZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgcHJv\nY2Vzc29yLnByb2Nlc3MobGVkZ2VyLCBtY2IpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRoZSB6bm9kZSBhIHNwZWNpYWwgem5vZGUKICAgICAq\nCiAgICAgKiBAcGFyYW0gem5vZGUKICAgICAqICAgICAgICAgIFpub2RlIE5h\nbWUKICAgICAqIEByZXR1cm4gdHJ1ZSAgaWYgdGhlIHpub2RlIGlzIGEgc3Bl\nY2lhbCB6bm9kZSBvdGhlcndpc2UgZmFsc2UKICAgICAqLwogICAgcHJvdGVj\ndGVkIGJvb2xlYW4gaXNTcGVjaWFsWm5vZGUoU3RyaW5nIHpub2RlKSB7CiAg\nICAgICAgaWYgKEJvb2tLZWVwZXJDb25zdGFudHMuQVZBSUxBQkxFX05PREUu\nZXF1YWxzKHpub2RlKQogICAgICAgICAgICAgICAgfHwgQm9va0tlZXBlckNv\nbnN0YW50cy5DT09LSUVfTk9ERS5lcXVhbHMoem5vZGUpCiAgICAgICAgICAg\nICAgICB8fCBCb29rS2VlcGVyQ29uc3RhbnRzLkxBWU9VVF9aTk9ERS5lcXVh\nbHMoem5vZGUpCiAgICAgICAgICAgICAgICB8fCBCb29rS2VlcGVyQ29uc3Rh\nbnRzLklOU1RBTkNFSUQuZXF1YWxzKHpub2RlKQogICAgICAgICAgICAgICAg\nfHwgQm9va0tlZXBlckNvbnN0YW50cy5VTkRFUl9SRVBMSUNBVElPTl9OT0RF\nLmVxdWFscyh6bm9kZSkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlcnQgdGhlIFpLIHJldHJpZXZlZCBsZWRnZXIgbm9kZXMg\ndG8gYSBIYXNoU2V0IGZvciBlYXNpZXIgY29tcGFyaXNvbnMuCiAgICAgKgog\nICAgICogQHBhcmFtIGxlZGdlck5vZGVzCiAgICAgKiAgICAgICAgICB6ayBs\nZWRnZXIgbm9kZXMKICAgICAqIEBwYXJhbSBwYXRoCiAgICAgKiAgICAgICAg\nICB0aGUgcHJlZml4IHBhdGggb2YgdGhlIGxlZGdlciBub2RlcwogICAgICog\nQHJldHVybiBsZWRnZXIgaWQgaGFzaCBzZXQKICAgICAqLwogICAgcHJvdGVj\ndGVkIE5hdmlnYWJsZVNldDxMb25nPiBsZWRnZXJMaXN0VG9TZXQoTGlzdDxT\ndHJpbmc+IGxlZGdlck5vZGVzLCBTdHJpbmcgcGF0aCkgewogICAgICAgIE5h\ndmlnYWJsZVNldDxMb25nPiB6a0FjdGl2ZUxlZGdlcnMgPSBuZXcgVHJlZVNl\ndDxMb25nPigpOwogICAgICAgIGZvciAoU3RyaW5nIGxlZGdlck5vZGUgOiBs\nZWRnZXJOb2RlcykgewogICAgICAgICAgICBpZiAoaXNTcGVjaWFsWm5vZGUo\nbGVkZ2VyTm9kZSkpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAv\nLyBjb252ZXJ0IHRoZSBub2RlIHBhdGggdG8gbGVkZ2VyIGlkIGFjY29yZGlu\nZyB0byBkaWZmZXJlbnQgbGVkZ2VyIG1hbmFnZXIgaW1wbGVtZW50YXRpb24K\nICAgICAgICAgICAgICAgIHprQWN0aXZlTGVkZ2Vycy5hZGQoZ2V0TGVkZ2Vy\nSWQocGF0aCArICIvIiArIGxlZGdlck5vZGUpKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgTE9HLndh\ncm4oIkVycm9yIGV4dHJhY3RpbmcgbGVkZ2VySWQgZnJvbSBaSyBsZWRnZXIg\nbm9kZTogIiArIGxlZGdlck5vZGUpOwogICAgICAgICAgICAgICAgLy8gVGhp\ncyBpcyBhIHByZXR0eSBiYWQgZXJyb3IgYXMgaXQgaW5kaWNhdGVzIGEgbGVk\nZ2VyIG5vZGUgaW4gWksKICAgICAgICAgICAgICAgIC8vIGhhcyBhbiBpbmNv\ncnJlY3QgZm9ybWF0LiBGb3Igbm93IGp1c3QgY29udGludWUgYW5kIGNvbnNp\nZGVyCiAgICAgICAgICAgICAgICAvLyB0aGlzIGFzIGEgbm9uLWV4aXN0ZW50\nIGxlZGdlci4KICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB6a0FjdGl2ZUxlZGdlcnM7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgp\nIHsKICAgIH0KfQo=\n","encoding":"base64"}

