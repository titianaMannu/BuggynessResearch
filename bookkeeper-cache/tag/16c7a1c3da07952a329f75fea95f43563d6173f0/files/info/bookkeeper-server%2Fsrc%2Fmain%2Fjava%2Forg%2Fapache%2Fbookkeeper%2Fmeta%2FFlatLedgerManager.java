{"sha":"2bc42580f4ae87784f44910009821c5c77553e9c","node_id":"MDQ6QmxvYjE1NzU5NTY6MmJjNDI1ODBmNGFlODc3ODRmNDQ5MTAwMDk4MjFjNWM3NzU1M2U5Yw==","size":6340,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2bc42580f4ae87784f44910009821c5c77553e9c","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCi8qKgogKiBM\naWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFT\nRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBh\nZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgog\nKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGlj\nZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91IG1h\neSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQogKiB3\naXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo\nZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0\nd2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3Bl\nY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBs\naW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Ob1N1Y2hFbGVt\nZW50RXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJNZXRhZGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkFic3RyYWN0\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0NhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5Qcm9jZXNzb3I7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TdHJpbmdVdGlsczsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLlprVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5Bc3luY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFw\nYWNoZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjay5TdHJpbmdDYWxsYmFjazsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb24uQ29kZTsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRzOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwoKLyoqCiAqIE1hbmFnZSBhbGwgbGVkZ2VycyBpbiBhIHNpbmdsZSB6ayBu\nb2RlLgogKgogKiA8cD4KICogQWxsIGxlZGdlcnMnIG1ldGFkYXRhIGFyZSBw\ndXQgaW4gYSBzaW5nbGUgemsgbm9kZSwgY3JlYXRlZCB1c2luZyB6ayBzZXF1\nZW50aWFsIG5vZGUuCiAqIEVhY2ggbGVkZ2VyIG5vZGUgaXMgcHJlZml4ZWQg\nd2l0aCAnTCcuCiAqIDwvcD4KICovCmNsYXNzIEZsYXRMZWRnZXJNYW5hZ2Vy\nIGV4dGVuZHMgQWJzdHJhY3Raa0xlZGdlck1hbmFnZXIgewoKICAgIHN0YXRp\nYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIo\nRmxhdExlZGdlck1hbmFnZXIuY2xhc3MpOwogICAgLy8gcGF0aCBwcmVmaXgg\ndG8gc3RvcmUgbGVkZ2VyIHpub2RlcwogICAgcHJpdmF0ZSBmaW5hbCBTdHJp\nbmcgbGVkZ2VyUHJlZml4OwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IK\nICAgICAqCiAgICAgKiBAcGFyYW0gY29uZgogICAgICogICAgICAgICAgQ29u\nZmlndXJhdGlvbiBvYmplY3QKICAgICAqIEBwYXJhbSB6awogICAgICogICAg\nICAgICAgWm9vS2VlcGVyIENsaWVudCBIYW5kbGUKICAgICAqIEBwYXJhbSBs\nZWRnZXJSb290UGF0aAogICAgICogICAgICAgICAgWm9vS2VlcGVyIFBhdGgg\ndG8gc3RvcmUgbGVkZ2VyIG1ldGFkYXRhCiAgICAgKiBAdGhyb3dzIElPRXhj\nZXB0aW9uIHdoZW4gdmVyc2lvbiBpcyBub3QgY29tcGF0aWJsZQogICAgICov\nCiAgICBwdWJsaWMgRmxhdExlZGdlck1hbmFnZXIoQWJzdHJhY3RDb25maWd1\ncmF0aW9uIGNvbmYsIFpvb0tlZXBlciB6aykgewogICAgICAgIHN1cGVyKGNv\nbmYsIHprKTsKCiAgICAgICAgbGVkZ2VyUHJlZml4ID0gbGVkZ2VyUm9vdFBh\ndGggKyAiLyIgKyBTdHJpbmdVdGlscy5MRURHRVJfTk9ERV9QUkVGSVg7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVMZWRn\nZXIoZmluYWwgTGVkZ2VyTWV0YWRhdGEgbWV0YWRhdGEsIGZpbmFsIEdlbmVy\naWNDYWxsYmFjazxMb25nPiBjYikgewogICAgICAgIFN0cmluZ0NhbGxiYWNr\nIHNjYiA9IG5ldyBTdHJpbmdDYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQo\naW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwKICAgICAgICAgICAg\nICAgICAgICBTdHJpbmcgbmFtZSkgewogICAgICAgICAgICAgICAgaWYgKENv\nZGUuT0suaW50VmFsdWUoKSAhPSByYykgewogICAgICAgICAgICAgICAgICAg\nIExPRy5lcnJvcigiQ291bGQgbm90IGNyZWF0ZSBub2RlIGZvciBsZWRnZXIi\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRp\nb24uY3JlYXRlKEtlZXBlckV4Y2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgp\nKTsKICAgICAgICAgICAgICAgICAgICBjYi5vcGVyYXRpb25Db21wbGV0ZShC\nS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRl\nIHpub2RlIHN0YXR1cwogICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLnNl\ndFZlcnNpb24obmV3IFprVmVyc2lvbigwKSk7CiAgICAgICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsZWRnZXJJ\nZCA9IGdldExlZGdlcklkKG5hbWUpOwogICAgICAgICAgICAgICAgICAgICAg\nICBjYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLk9LLCBs\nZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNl\ncHRpb24gaWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9y\nKCJDb3VsZCBub3QgZXh0cmFjdCBsZWRnZXItaWQgZnJvbSBwYXRoOiIgKyBu\nYW1lLCBpZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlv\nbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51bGwp\nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgWmtVdGlscy5hc3luY0Ny\nZWF0ZUZ1bGxQYXRoT3B0aW1pc3RpYyh6aywgbGVkZ2VyUHJlZml4LCBtZXRh\nZGF0YS5zZXJpYWxpemUoKSwKICAgICAgICAgICAgSWRzLk9QRU5fQUNMX1VO\nU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UX1NFUVVFTlRJQUwsIHNjYiwg\nbnVsbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5n\nIGdldExlZGdlclBhdGgobG9uZyBsZWRnZXJJZCkgewogICAgICAgIFN0cmlu\nZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNi\nLmFwcGVuZChsZWRnZXJQcmVmaXgpCiAgICAgICAgICAuYXBwZW5kKFN0cmlu\nZ1V0aWxzLmdldFpLU3RyaW5nSWQobGVkZ2VySWQpKTsKICAgICAgICByZXR1\ncm4gc2IudG9TdHJpbmcoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBsb25nIGdldExlZGdlcklkKFN0cmluZyBub2RlTmFtZSkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBsb25nIGxlZGdlcklkOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIFN0cmluZyBwYXJ0c1tdID0gbm9kZU5hbWUu\nc3BsaXQobGVkZ2VyUHJlZml4KTsKICAgICAgICAgICAgbGVkZ2VySWQgPSBM\nb25nLnBhcnNlTG9uZyhwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSk7CiAgICAg\nICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbGVkZ2VySWQ7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgdm9pZCBhc3luY1Byb2Nlc3NMZWRnZXJzKGZpbmFsIFByb2Nl\nc3NvcjxMb25nPiBwcm9jZXNzb3IsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNr\nIGZpbmFsQ2IsIGZpbmFsIE9iamVjdCBjdHgsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGZpbmFsIGludCBzdWNjZXNzUmMsIGZpbmFs\nIGludCBmYWlsdXJlUmMpIHsKICAgICAgICBhc3luY1Byb2Nlc3NMZWRnZXJz\nSW5TaW5nbGVOb2RlKGxlZGdlclJvb3RQYXRoLCBwcm9jZXNzb3IsIGZpbmFs\nQ2IsIGN0eCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIExlZGdlclJhbmdlSXRlcmF0b3IgZ2V0TGVk\nZ2VyUmFuZ2VzKCkgewogICAgICAgIHJldHVybiBuZXcgTGVkZ2VyUmFuZ2VJ\ndGVyYXRvcigpIHsKICAgICAgICAgICAgLy8gc2luZ2xlIGl0ZXJhdG9yLCBj\nYW4gdmlzaXQgb25seSBvbmUgdGltZQogICAgICAgICAgICBib29sZWFuIG5l\neHRDYWxsZWQgPSBmYWxzZTsKICAgICAgICAgICAgTGVkZ2VyUmFuZ2UgbmV4\ndFJhbmdlID0gbnVsbDsKCiAgICAgICAgICAgIHN5bmNocm9uaXplZCBwcml2\nYXRlIHZvaWQgcHJlbG9hZCgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBpZiAobmV4dFJhbmdlICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBTZXQ8TG9uZz4gemtBY3RpdmVMZWRnZXJzID0gbnVsbDsKCiAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHprQWN0\naXZlTGVkZ2VycyA9IGxlZGdlckxpc3RUb1NldCgKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIFprVXRpbHMuZ2V0Q2hpbGRyZW5JblNpbmdsZU5vZGUo\nemssIGxlZGdlclJvb3RQYXRoKSwgbGVkZ2VyUm9vdFBhdGgpOwogICAgICAg\nICAgICAgICAgICAgIG5leHRSYW5nZSA9IG5ldyBMZWRnZXJSYW5nZSh6a0Fj\ndGl2ZUxlZGdlcnMpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgICAgICBUaHJl\nYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiRXJyb3Igd2hlbiBnZXQg\nY2hpbGQgbm9kZXMgZnJvbSB6ayIsIGllKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHN5bmNocm9uaXplZCBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHByZWxvYWQoKTsK\nICAgICAgICAgICAgICAgIHJldHVybiBuZXh0UmFuZ2UgIT0gbnVsbCAmJiBu\nZXh0UmFuZ2Uuc2l6ZSgpID4gMCAmJiAhbmV4dENhbGxlZDsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHN5bmNo\ncm9uaXplZCBwdWJsaWMgTGVkZ2VyUmFuZ2UgbmV4dCgpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoIWhhc05leHQoKSkgewog\nICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb1N1Y2hFbGVtZW50RXhj\nZXB0aW9uKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBu\nZXh0Q2FsbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0\nUmFuZ2U7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgfQp9Cg==\n","encoding":"base64"}

