{"sha":"171fd3adb895c714f08ea2df18b6ffd14f9241e9","node_id":"MDQ6QmxvYjE1NzU5NTY6MTcxZmQzYWRiODk1YzcxNGYwOGVhMmRmMThiNmZmZDE0ZjkyNDFlOQ==","size":20909,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/171fd3adb895c714f08ea2df18b6ffd14f9241e9","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCi8qKgogKiBM\naWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFT\nRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBh\nZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgog\nKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGlj\nZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91IG1h\neSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQogKiB3\naXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo\nZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0\nd2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3Bl\nY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBs\naW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9u\nczsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk5hdmlnYWJsZVNldDsKaW1wb3J0\nIGphdmEudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uOwppbXBvcnQgamF2\nYS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBvcnQgamF2YS51dGls\nLmNvbmN1cnJlbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlOwppbXBvcnQg\namF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0ludGVnZXI7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2Vy\nTWV0YWRhdGE7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5B\nYnN0cmFjdENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVy\naWNDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuUHJvY2Vzc29yOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuU3RyaW5nVXRpbHM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5aa1V0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjazsKaW1wb3J0\nIG9yZy5hcGFjaGUuem9va2VlcGVyLkFzeW5jQ2FsbGJhY2suU3RyaW5nQ2Fs\nbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5DcmVhdGVNb2Rl\nOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9u\nLkNvZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29EZWZzLklk\nczsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1w\nb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2Vy\nRmFjdG9yeTsKCi8qKgogKiBIaWVyYXJjaGljYWwgTGVkZ2VyIE1hbmFnZXIg\nd2hpY2ggbWFuYWdlcyBsZWRnZXIgbWV0YSBpbiB6b29rZWVwZXIgdXNpbmcg\nMi1sZXZlbCBoaWVyYXJjaGljYWwgem5vZGVzLgogKgogKiA8cD4KICogSGll\ncmFyY2hpY2FsIExlZGdlciBNYW5hZ2VyIGZpcnN0IG9idGFpbiBhIGdsb2Jh\nbCB1bmlxdWUgaWQgZnJvbSB6b29rZWVwZXIgdXNpbmcgYSBFUEhFTUVSQUxf\nU0VRVUVOVElBTAogKiB6bm9kZSA8aT4obGVkZ2Vyc1Jvb3RQYXRoKS9sZWRn\nZXJzL2lkZ2VuL0lELTwvaT4uCiAqIFNpbmNlIHpvb2tlZXBlciBzZXF1ZW50\naWFsIGNvdW50ZXIgaGFzIGEgZm9ybWF0IG9mICUxMGQgLS0gdGhhdCBpcyAx\nMCBkaWdpdHMgd2l0aCAwICh6ZXJvKSBwYWRkaW5nLCBpLmUuCiAqICImbHQ7\ncGF0aCZndDswMDAwMDAwMDAxIiwgSGllcmFyY2hpY2FsTGVkZ2VyTWFuYWdl\nciBzcGxpdHMgdGhlIGdlbmVyYXRlZCBpZCBpbnRvIDMgcGFydHMgKDItNC00\nKToKICogPHByZT4mbHQ7bGV2ZWwxICgyIGRpZ2l0cykmZ3Q7Jmx0O2xldmVs\nMiAoNCBkaWdpdHMpJmd0OyZsdDtsZXZlbDMgKDQgZGlnaXRzKSZndDs8L3By\nZT4KICogVGhlc2UgMyBwYXJ0cyBhcmUgdXNlZCB0byBmb3JtIHRoZSBhY3R1\nYWwgbGVkZ2VyIG5vZGUgcGF0aCB1c2VkIHRvIHN0b3JlIGxlZGdlciBtZXRh\nZGF0YToKICogPHByZT4obGVkZ2Vyc1Jvb3RQYXRoKS9sZXZlbDEvbGV2ZWwy\nL0wobGV2ZWwzKTwvcHJlPgogKiBFLmcgTGVkZ2VyIDAwMDAwMDAwMDEgaXMg\nc3BsaXQgaW50byAzIHBhcnRzIDxpPjAwPC9pPiwgPGk+MDAwMDwvaT4sIDxp\nPjAwMDE8L2k+LCB3aGljaCBpcyBzdG9yZWQgaW4KICogPGk+KGxlZGdlcnNS\nb290UGF0aCkvMDAvMDAwMC9MMDAwMTwvaT4uIFNvIGVhY2ggem5vZGUgY291\nbGQgaGF2ZSBhdCBtb3N0IDEwMDAwIGxlZGdlcnMsIHdoaWNoIGF2b2lkcwog\nKiBlcnJvcnMgZHVyaW5nIGdhcmJhZ2UgY29sbGVjdGlvbiBkdWUgdG8gbGlz\ndHMgb2YgY2hpbGRyZW4gdGhhdCBhcmUgdG9vIGxvbmcuCiAqLwpjbGFzcyBI\naWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyIGV4dGVuZHMgQWJzdHJhY3Raa0xl\nZGdlck1hbmFnZXIgewoKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSGllcmFyY2hpY2FsTGVkZ2VyTWFu\nYWdlci5jbGFzcyk7CgogICAgc3RhdGljIGZpbmFsIFN0cmluZyBJREdFTl9a\nTk9ERSA9ICJpZGdlbiI7CiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIElER0VO\nRVJBVElPTl9QUkVGSVggPSAiLyIgKyBJREdFTl9aTk9ERSArICIvSUQtIjsK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBNQVhfSURfU1VGRklY\nID0gIjk5OTkiOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIE1J\nTl9JRF9TVUZGSVggPSAiMDAwMCI7CgogICAgLy8gUGF0aCB0byBnZW5lcmF0\nZSBnbG9iYWwgaWQKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIGlkR2VuUGF0\naDsKCiAgICAvLyB3ZSB1c2UgdGhpcyB0byBwcmV2ZW50IGxvbmcgc3RhY2sg\nY2hhaW5zIGZyb20gYnVpbGRpbmcgdXAgaW4gY2FsbGJhY2tzCiAgICBTY2hl\nZHVsZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1bGVyOwoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3IKICAgICAqCiAgICAgKiBAcGFyYW0gY29uZgogICAg\nICogICAgICAgICAgQ29uZmlndXJhdGlvbiBvYmplY3QKICAgICAqIEBwYXJh\nbSB6awogICAgICogICAgICAgICAgWm9vS2VlcGVyIENsaWVudCBIYW5kbGUK\nICAgICAqLwogICAgcHVibGljIEhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXIo\nQWJzdHJhY3RDb25maWd1cmF0aW9uIGNvbmYsIFpvb0tlZXBlciB6aykgewog\nICAgICAgIHN1cGVyKGNvbmYsIHprKTsKCiAgICAgICAgdGhpcy5pZEdlblBh\ndGggPSBsZWRnZXJSb290UGF0aCArIElER0VORVJBVElPTl9QUkVGSVg7CiAg\nICAgICAgdGhpcy5zY2hlZHVsZXIgPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhy\nZWFkU2NoZWR1bGVkRXhlY3V0b3IoKTsKICAgICAgICBMT0cuZGVidWcoIlVz\naW5nIEhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXIgd2l0aCByb290IHBhdGgg\nOiB7fSIsIGxlZGdlclJvb3RQYXRoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHNjaGVkdWxlci5zaHV0ZG93bigpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy53YXJuKCJFcnJvciB3\naGVuIGNsb3NpbmcgSGllcmFyY2hpY2FsTGVkZ2VyTWFuYWdlciA6ICIsIGUp\nOwogICAgICAgIH0KICAgICAgICBzdXBlci5jbG9zZSgpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY3JlYXRlTGVkZ2VyKGZpbmFs\nIExlZGdlck1ldGFkYXRhIG1ldGFkYXRhLCBmaW5hbCBHZW5lcmljQ2FsbGJh\nY2s8TG9uZz4gbGVkZ2VyQ2IpIHsKICAgICAgICBaa1V0aWxzLmFzeW5jQ3Jl\nYXRlRnVsbFBhdGhPcHRpbWlzdGljKHprLCBpZEdlblBhdGgsIG5ldyBieXRl\nWzBdLCBJZHMuT1BFTl9BQ0xfVU5TQUZFLAogICAgICAgICAgICBDcmVhdGVN\nb2RlLkVQSEVNRVJBTF9TRVFVRU5USUFMLCBuZXcgU3RyaW5nQ2FsbGJhY2so\nKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVj\ndCBjdHgsIGZpbmFsIFN0cmluZyBpZFBhdGhOYW1lKSB7CiAgICAgICAgICAg\nICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFs\ndWUoKSkgewogICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGQg\nbm90IGdlbmVyYXRlIG5ldyBsZWRnZXIgaWQiLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4\nY2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAgICAg\nICAgICBsZWRnZXJDYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5D\nb2RlLlpLRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvKgog\nICAgICAgICAgICAgICAgICogRXh0cmFjdCBsZWRnZXIgaWQgZnJvbSBnZW4g\ncGF0aAogICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICBsb25n\nIGxlZGdlcklkOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICBsZWRnZXJJZCA9IGdldExlZGdlcklkRnJvbUdlblBhdGgoaWRQ\nYXRoTmFtZSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJDb3VsZCBu\nb3QgZXh0cmFjdCBsZWRnZXItaWQgZnJvbSBpZCBnZW4gcGF0aDoiICsgcGF0\naCwgZSk7CiAgICAgICAgICAgICAgICAgICAgbGVkZ2VyQ2Iub3BlcmF0aW9u\nQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5aS0V4Y2VwdGlvbiwgbnVsbCk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgU3RyaW5nIGxlZGdlclBhdGggPSBnZXRMZWRn\nZXJQYXRoKGxlZGdlcklkKTsKICAgICAgICAgICAgICAgIGZpbmFsIGxvbmcg\nbGlkID0gbGVkZ2VySWQ7CiAgICAgICAgICAgICAgICBTdHJpbmdDYWxsYmFj\nayBzY2IgPSBuZXcgU3RyaW5nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgcHVibGljIHZv\naWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgT2JqZWN0IGN0eCwgU3RyaW5nIG5hbWUp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IEtlZXBlckV4\nY2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGQgbm90IGNyZWF0ZSBub2Rl\nIGZvciBsZWRnZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIEtlZXBlckV4Y2VwdGlvbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9u\nLkNvZGUuZ2V0KHJjKSwgcGF0aCkpOwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbGVkZ2VyQ2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24u\nQ29kZS5aS0V4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1\ncGRhdGUgdmVyc2lvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0\nYWRhdGEuc2V0VmVyc2lvbihuZXcgWmtWZXJzaW9uKDApKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGxlZGdlckNiLm9wZXJhdGlvbkNvbXBsZXRl\nKEJLRXhjZXB0aW9uLkNvZGUuT0ssIGxpZCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9OwogICAgICAgICAgICAgICAgWmtVdGlscy5hc3luY0NyZWF0ZUZ1bGxQ\nYXRoT3B0aW1pc3RpYyh6aywgbGVkZ2VyUGF0aCwgbWV0YWRhdGEuc2VyaWFs\naXplKCksCiAgICAgICAgICAgICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FG\nRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5ULCBzY2IsIG51bGwpOwogICAgICAg\nICAgICAgICAgLy8gZGVsZXRlIHRoZSB6bm9kZSBmb3IgaWQgZ2VuZXJhdGlv\nbgogICAgICAgICAgICAgICAgc2NoZWR1bGVyLnN1Ym1pdChuZXcgUnVubmFi\nbGUoKSB7CiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAg\nICAgICAgICAgICB6ay5kZWxldGUoaWRQYXRoTmFtZSwgLTEsIG5ldyBBc3lu\nY0NhbGxiYWNrLlZvaWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBw\nYXRoLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKHJjICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZh\nbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nTE9HLndhcm4oIkV4Y2VwdGlvbiBkdXJpbmcgZGVsZXRpbmcgem5vZGUgZm9y\nIGlkIGdlbmVyYXRpb24gOiAiLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtl\nZXBlckV4Y2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoIkRlbGV0aW5nIHpu\nb2RlIGZvciBpZCBnZW5lcmF0aW9uIDoge30iLCBpZFBhdGhOYW1lKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIG51\nbGwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0p\nOwogICAgICAgICAgICB9CiAgICAgICAgfSwgbnVsbCk7CiAgICB9CgogICAg\nLy8gZ2V0IGxlZGdlciBpZCBmcm9tIGdlbmVyYXRpb24gcGF0aAogICAgcHJp\ndmF0ZSBsb25nIGdldExlZGdlcklkRnJvbUdlblBhdGgoU3RyaW5nIG5vZGVO\nYW1lKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGxvbmcgbGVkZ2Vy\nSWQ7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nIHBhcnRzW10g\nPSBub2RlTmFtZS5zcGxpdChJREdFTkVSQVRJT05fUFJFRklYKTsKICAgICAg\nICAgICAgbGVkZ2VySWQgPSBMb25nLnBhcnNlTG9uZyhwYXJ0c1twYXJ0cy5s\nZW5ndGggLSAxXSk7CiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9u\nKGUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbGVkZ2VySWQ7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIGdldExlZGdlclBh\ndGgobG9uZyBsZWRnZXJJZCkgewogICAgICAgIHJldHVybiBsZWRnZXJSb290\nUGF0aCArIFN0cmluZ1V0aWxzLmdldEhpZXJhcmNoaWNhbExlZGdlclBhdGgo\nbGVkZ2VySWQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGxv\nbmcgZ2V0TGVkZ2VySWQoU3RyaW5nIHBhdGhOYW1lKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIGlmICghcGF0aE5hbWUuc3RhcnRzV2l0aChsZWRn\nZXJSb290UGF0aCkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0\naW9uKCJpdCBpcyBub3QgYSB2YWxpZCBoYXNoZWQgcGF0aCBuYW1lIDogIiAr\nIHBhdGhOYW1lKTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nIGhpZXJhcmNo\naWNhbFBhdGggPSBwYXRoTmFtZS5zdWJzdHJpbmcobGVkZ2VyUm9vdFBhdGgu\nbGVuZ3RoKCkgKyAxKTsKICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuc3Ry\naW5nVG9IaWVyYXJjaGljYWxMZWRnZXJJZChoaWVyYXJjaGljYWxQYXRoKTsK\nICAgIH0KCiAgICAvLyBnZXQgbGVkZ2VyIGZyb20gYWxsIGxldmVsIG5vZGVz\nCiAgICBwcml2YXRlIGxvbmcgZ2V0TGVkZ2VySWQoU3RyaW5nLi4ubGV2ZWxO\nb2RlcykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gU3Ry\naW5nVXRpbHMuc3RyaW5nVG9IaWVyYXJjaGljYWxMZWRnZXJJZChsZXZlbE5v\nZGVzKTsKICAgIH0KCiAgICAvLwogICAgLy8gQWN0aXZlIExlZGdlciBNYW5h\nZ2VyCiAgICAvLwoKICAgIC8qKgogICAgICogR2V0IHRoZSBzbWFsbGVzdCBj\nYWNoZSBpZCBpbiBhIHNwZWNpZmllZCBub2RlIC9sZXZlbDEvbGV2ZWwyCiAg\nICAgKgogICAgICogQHBhcmFtIGxldmVsMQogICAgICogICAgICAgICAgMXN0\nIGxldmVsIG5vZGUgbmFtZQogICAgICogQHBhcmFtIGxldmVsMgogICAgICog\nICAgICAgICAgMm5kIGxldmVsIG5vZGUgbmFtZQogICAgICogQHJldHVybiB0\naGUgc21hbGxlc3QgbGVkZ2VyIGlkCiAgICAgKi8KICAgIHByaXZhdGUgbG9u\nZyBnZXRTdGFydExlZGdlcklkQnlMZXZlbChTdHJpbmcgbGV2ZWwxLCBTdHJp\nbmcgbGV2ZWwyKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBnZXRMZWRnZXJJZChsZXZlbDEsIGxldmVsMiwgTUlOX0lEX1NVRkZJWCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhlIGxhcmdlc3QgY2FjaGUg\naWQgaW4gYSBzcGVjaWZpZWQgbm9kZSAvbGV2ZWwxL2xldmVsMgogICAgICoK\nICAgICAqIEBwYXJhbSBsZXZlbDEKICAgICAqICAgICAgICAgIDFzdCBsZXZl\nbCBub2RlIG5hbWUKICAgICAqIEBwYXJhbSBsZXZlbDIKICAgICAqICAgICAg\nICAgIDJuZCBsZXZlbCBub2RlIG5hbWUKICAgICAqIEByZXR1cm4gdGhlIGxh\ncmdlc3QgbGVkZ2VyIGlkCiAgICAgKi8KICAgIHByaXZhdGUgbG9uZyBnZXRF\nbmRMZWRnZXJJZEJ5TGV2ZWwoU3RyaW5nIGxldmVsMSwgU3RyaW5nIGxldmVs\nMikgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gZ2V0TGVk\nZ2VySWQobGV2ZWwxLCBsZXZlbDIsIE1BWF9JRF9TVUZGSVgpOwogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgYXN5bmNQcm9jZXNzTGVk\nZ2VycyhmaW5hbCBQcm9jZXNzb3I8TG9uZz4gcHJvY2Vzc29yLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBBc3luY0NhbGxi\nYWNrLlZvaWRDYWxsYmFjayBmaW5hbENiLCBmaW5hbCBPYmplY3QgY29udGV4\ndCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwg\naW50IHN1Y2Nlc3NSYywgZmluYWwgaW50IGZhaWx1cmVSYykgewogICAgICAg\nIC8vIHByb2Nlc3MgMXN0IGxldmVsIG5vZGVzCiAgICAgICAgYXN5bmNQcm9j\nZXNzTGV2ZWxOb2RlcyhsZWRnZXJSb290UGF0aCwgbmV3IFByb2Nlc3NvcjxT\ndHJpbmc+KCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\ncHVibGljIHZvaWQgcHJvY2VzcyhmaW5hbCBTdHJpbmcgbDFOb2RlLCBmaW5h\nbCBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBjYjEpIHsKICAgICAgICAg\nICAgICAgIGlmIChpc1NwZWNpYWxabm9kZShsMU5vZGUpKSB7CiAgICAgICAg\nICAgICAgICAgICAgY2IxLnByb2Nlc3NSZXN1bHQoc3VjY2Vzc1JjLCBudWxs\nLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmaW5hbCBTdHJpbmcgbDFO\nb2RlUGF0aCA9IGxlZGdlclJvb3RQYXRoICsgIi8iICsgbDFOb2RlOwogICAg\nICAgICAgICAgICAgLy8gcHJvY2VzcyBsZXZlbDEgcGF0aCwgYWZ0ZXIgYWxs\nIGNoaWxkcmVuIG9mIGxldmVsMSBwcm9jZXNzCiAgICAgICAgICAgICAgICAv\nLyBpdCBjYWxsYmFjayB0byBjb250aW51ZSBwcm9jZXNzaW5nIG5leHQgbGV2\nZWwxIG5vZGUKICAgICAgICAgICAgICAgIGFzeW5jUHJvY2Vzc0xldmVsTm9k\nZXMobDFOb2RlUGF0aCwgbmV3IFByb2Nlc3NvcjxTdHJpbmc+KCkgewogICAg\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHByb2Nlc3MoU3RyaW5nIGwyTm9kZSwgQXN5bmNDYWxs\nYmFjay5Wb2lkQ2FsbGJhY2sgY2IyKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIHByb2Nlc3MgbGV2ZWwxL2xldmVsMiBwYXRoCiAgICAgICAgICAg\nICAgICAgICAgICAgIFN0cmluZyBsMk5vZGVQYXRoID0gbGVkZ2VyUm9vdFBh\ndGggKyAiLyIgKyBsMU5vZGUgKyAiLyIgKyBsMk5vZGU7CiAgICAgICAgICAg\nICAgICAgICAgICAgIC8vIHByb2Nlc3MgZWFjaCBsZWRnZXIKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gYWZ0ZXIgYWxsIGxlZGdlciBhcmUgcHJvY2Vz\nc2VkLCBjYjIgd2lsbCBiZSBjYWxsIHRvIGNvbnRpbnVlIHByb2Nlc3Npbmcg\nbmV4dCBsZXZlbDIgbm9kZQogICAgICAgICAgICAgICAgICAgICAgICBhc3lu\nY1Byb2Nlc3NMZWRnZXJzSW5TaW5nbGVOb2RlKGwyTm9kZVBhdGgsIHByb2Nl\nc3NvciwgY2IyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQsIHN1Y2Nlc3NSYywgZmFp\nbHVyZVJjKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9LCBjYjEsIGNvbnRleHQsIHN1Y2Nlc3NSYywgZmFpbHVyZVJjKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0sIGZpbmFsQ2IsIGNvbnRleHQsIHN1Y2Nl\nc3NSYywgZmFpbHVyZVJjKTsKICAgIH0KCiAgICAvKioKICAgICAqIFByb2Nl\nc3MgaGFzaCBub2RlcyBpbiBhIGdpdmVuIHBhdGgKICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIGFzeW5jUHJvY2Vzc0xldmVsTm9kZXMoCiAgICAgICAgZmlu\nYWwgU3RyaW5nIHBhdGgsIGZpbmFsIFByb2Nlc3NvcjxTdHJpbmc+IHByb2Nl\nc3NvciwKICAgICAgICBmaW5hbCBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFj\nayBmaW5hbENiLCBmaW5hbCBPYmplY3QgY29udGV4dCwKICAgICAgICBmaW5h\nbCBpbnQgc3VjY2Vzc1JjLCBmaW5hbCBpbnQgZmFpbHVyZVJjKSB7CiAgICAg\nICAgemsuc3luYyhwYXRoLCBuZXcgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJh\nY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJs\naWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9i\namVjdCBjdHgpIHsKICAgICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9L\nLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3Io\nIkVycm9yIHN5bmNpbmcgcGF0aCAiICsgcGF0aCArICIgd2hlbiBnZXR0aW5n\nIGl0cyBjaGlkcmVuOiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4Y2VwdGlvbi5Db2Rl\nLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAgICAgICAgICBmaW5hbENi\nLnByb2Nlc3NSZXN1bHQoZmFpbHVyZVJjLCBudWxsLCBjb250ZXh0KTsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgemsuZ2V0Q2hpbGRyZW4ocGF0aCwgZmFsc2UsIG5l\ndyBBc3luY0NhbGxiYWNrLkNoaWxkcmVuQ2FsbGJhY2soKSB7CiAgICAgICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBP\nYmplY3QgY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGxldmVsTm9kZXMpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IENvZGUuT0suaW50VmFsdWUo\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJF\ncnJvciBwb2xsaW5nIGhhc2ggbm9kZXMgb2YgIiArIHBhdGgsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9u\nLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZS5nZXQocmMpLCBwYXRoKSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbENiLnByb2Nlc3NS\nZXN1bHQoZmFpbHVyZVJjLCBudWxsLCBjb250ZXh0KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgICAgICBBc3luY0xpc3RQcm9jZXNz\nb3I8U3RyaW5nPiBsaXN0UHJvY2Vzc29yID0KICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBuZXcgQXN5bmNMaXN0UHJvY2Vzc29yPFN0cmluZz4o\nc2NoZWR1bGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2Vz\ncyBpdHMgY2hpbGRyZW4KICAgICAgICAgICAgICAgICAgICAgICAgbGlzdFBy\nb2Nlc3Nvci5wcm9jZXNzKGxldmVsTm9kZXMsIHByb2Nlc3NvciwgZmluYWxD\nYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGNvbnRleHQsIHN1Y2Nlc3NSYywgZmFpbHVyZVJjKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBudWxsKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0sIG51bGwpOwogICAgfQoKICAgIC8qKgogICAg\nICogUHJvY2VzcyBsaXN0IG9uZSBieSBvbmUgaW4gYXN5bmNocm9uaXplIHdh\neS4gUHJvY2VzcyB3aWxsIGJlIHN0b3BwZWQgaW1tZWRpYXRlbHkKICAgICAq\nIHdoZW4gZXJyb3Igb2NjdXJyZWQuCiAgICAgKi8KICAgIHByaXZhdGUgc3Rh\ndGljIGNsYXNzIEFzeW5jTGlzdFByb2Nlc3NvcjxUPiB7CiAgICAgICAgLy8g\ndXNlIHRoaXMgdG8gcHJldmVudCBsb25nIHN0YWNrIGNoYWlucyBmcm9tIGJ1\naWxkaW5nIHVwIGluIGNhbGxiYWNrcwogICAgICAgIFNjaGVkdWxlZEV4ZWN1\ndG9yU2VydmljZSBzY2hlZHVsZXI7CgogICAgICAgIC8qKgogICAgICAgICAq\nIENvbnN0cnVjdG9yCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gc2No\nZWR1bGVyCiAgICAgICAgICogICAgICAgICAgRXhlY3V0b3IgdXNlZCB0byBw\ncmV2ZW50IGxvbmcgc3RhY2sgY2hhaW5zCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIEFzeW5jTGlzdFByb2Nlc3NvcihTY2hlZHVsZWRFeGVjdXRvclNl\ncnZpY2Ugc2NoZWR1bGVyKSB7CiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVy\nID0gc2NoZWR1bGVyOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAg\nICogUHJvY2VzcyBsaXN0IG9mIGl0ZW1zCiAgICAgICAgICoKICAgICAgICAg\nKiBAcGFyYW0gZGF0YQogICAgICAgICAqICAgICAgICAgIExpc3Qgb2YgZGF0\nYSB0byBwcm9jZXNzCiAgICAgICAgICogQHBhcmFtIHByb2Nlc3NvcgogICAg\nICAgICAqICAgICAgICAgIENhbGxiYWNrIHRvIHByb2Nlc3MgZWxlbWVudCBv\nZiBsaXN0IHdoZW4gc3VjY2VzcwogICAgICAgICAqIEBwYXJhbSBmaW5hbENi\nCiAgICAgICAgICogICAgICAgICAgRmluYWwgY2FsbGJhY2sgdG8gYmUgY2Fs\nbGVkIGFmdGVyIGFsbCBlbGVtZW50cyBpbiB0aGUgbGlzdCBhcmUgcHJvY2Vz\nc2VkCiAgICAgICAgICogQHBhcmFtIGNvbnR4dAogICAgICAgICAqICAgICAg\nICAgIENvbnRleHQgb2YgZmluYWwgY2FsbGJhY2sKICAgICAgICAgKiBAcGFy\nYW0gc3VjY2Vzc1JjCiAgICAgICAgICogICAgICAgICAgUkMgcGFzc2VkIHRv\nIGZpbmFsIGNhbGxiYWNrIG9uIHN1Y2Nlc3MKICAgICAgICAgKiBAcGFyYW0g\nZmFpbHVyZVJjCiAgICAgICAgICogICAgICAgICAgUkMgcGFzc2VkIHRvIGZp\nbmFsIGNhbGxiYWNrIG9uIGZhaWx1cmUKICAgICAgICAgKi8KICAgICAgICBw\ndWJsaWMgdm9pZCBwcm9jZXNzKGZpbmFsIExpc3Q8VD4gZGF0YSwgZmluYWwg\nUHJvY2Vzc29yPFQ+IHByb2Nlc3NvciwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGZpbmFs\nQ2IsIGZpbmFsIE9iamVjdCBjb250ZXh0LAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZmluYWwgaW50IHN1Y2Nlc3NSYywgZmluYWwgaW50IGZhaWx1\ncmVSYykgewogICAgICAgICAgICBpZiAoZGF0YSA9PSBudWxsIHx8IGRhdGEu\nc2l6ZSgpID09IDApIHsKICAgICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vz\nc1Jlc3VsdChzdWNjZXNzUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZpbmFs\nIGludCBzaXplID0gZGF0YS5zaXplKCk7CiAgICAgICAgICAgIGZpbmFsIEF0\nb21pY0ludGVnZXIgY3VycmVudCA9IG5ldyBBdG9taWNJbnRlZ2VyKDApOwog\nICAgICAgICAgICBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBzdHViQ2Fs\nbGJhY2sgPSBuZXcgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2soKSB7CiAg\nICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2Jq\nZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBzdWNj\nZXNzUmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGVybWluYWwg\naW1tZWRpYXRlbHkKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxDYi5w\ncm9jZXNzUmVzdWx0KGZhaWx1cmVSYywgbnVsbCwgY29udGV4dCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBuZXh0IGVsZW1l\nbnQKICAgICAgICAgICAgICAgICAgICBpbnQgbmV4dCA9IGN1cnJlbnQuaW5j\ncmVtZW50QW5kR2V0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQg\nPj0gc2l6ZSkgeyAvLyByZWFjaCB0aGUgZW5kIG9mIGxpc3QKICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWxDYi5wcm9jZXNzUmVzdWx0KHN1Y2Nlc3NS\nYywgbnVsbCwgY29udGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgZmluYWwgVCBkYXRhVG9Qcm9jZXNzID0gZGF0YS5nZXQobmV4dCk7CiAg\nICAgICAgICAgICAgICAgICAgZmluYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2Fs\nbGJhY2sgc3R1YiA9IHRoaXM7CiAgICAgICAgICAgICAgICAgICAgc2NoZWR1\nbGVyLnN1Ym1pdChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJs\naWMgZmluYWwgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBwcm9jZXNzb3IucHJvY2VzcyhkYXRhVG9Qcm9jZXNzLCBzdHViKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAg\nICAgICBUIGZpcnN0RWxlbWVudCA9IGRhdGEuZ2V0KDApOwogICAgICAgICAg\nICBwcm9jZXNzb3IucHJvY2VzcyhmaXJzdEVsZW1lbnQsIHN0dWJDYWxsYmFj\nayk7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIGJvb2xlYW4gaXNTcGVjaWFsWm5vZGUoU3RyaW5nIHpub2RlKSB7CiAg\nICAgICAgcmV0dXJuIElER0VOX1pOT0RFLmVxdWFscyh6bm9kZSkgfHwgc3Vw\nZXIuaXNTcGVjaWFsWm5vZGUoem5vZGUpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIExlZGdlclJhbmdlSXRlcmF0b3IgZ2V0TGVkZ2VyUmFu\nZ2VzKCkgewogICAgICAgIHJldHVybiBuZXcgSGllcmFyY2hpY2FsTGVkZ2Vy\nUmFuZ2VJdGVyYXRvcigpOwogICAgfQoKICAgIC8qKgogICAgICogSXRlcmF0\nb3IgdGhyb3VnaCBlYWNoIG1ldGFkYXRhIGJ1Y2tldCB3aXRoIGhpZXJhcmNo\naWNhbCBtb2RlCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgSGllcmFyY2hp\nY2FsTGVkZ2VyUmFuZ2VJdGVyYXRvciBpbXBsZW1lbnRzIExlZGdlclJhbmdl\nSXRlcmF0b3IgewogICAgICAgIHByaXZhdGUgSXRlcmF0b3I8U3RyaW5nPiBs\nMU5vZGVzSXRlciA9IG51bGw7CiAgICAgICAgcHJpdmF0ZSBJdGVyYXRvcjxT\ndHJpbmc+IGwyTm9kZXNJdGVyID0gbnVsbDsKICAgICAgICBwcml2YXRlIFN0\ncmluZyBjdXJMMU5vZGVzID0gIiI7CiAgICAgICAgcHJpdmF0ZSBib29sZWFu\nIGl0ZXJhdG9yRG9uZSA9IGZhbHNlOwogICAgICAgIHByaXZhdGUgTGVkZ2Vy\nUmFuZ2UgbmV4dFJhbmdlID0gbnVsbDsKCiAgICAgICAgLyoqCiAgICAgICAg\nICogaXRlcmF0ZSBuZXh0IGxldmVsMSB6bm9kZQogICAgICAgICAqCiAgICAg\nICAgICogQHJldHVybiBmYWxzZSBpZiBoYXZlIHZpc2l0ZWQgYWxsIGxldmVs\nMSBub2RlcwogICAgICAgICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRp\nb24vS2VlcGVyRXhjZXB0aW9uIGlmIGVycm9yIG9jY3VycyByZWFkaW5nIHpv\nb2tlZXBlciBjaGlsZHJlbgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUg\nYm9vbGVhbiBuZXh0TDFOb2RlKCkgdGhyb3dzIEtlZXBlckV4Y2VwdGlvbiwg\nSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgICAgICBsMk5vZGVzSXRl\nciA9IG51bGw7CiAgICAgICAgICAgIHdoaWxlIChsMk5vZGVzSXRlciA9PSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICBpZiAobDFOb2Rlc0l0ZXIuaGFzTmV4\ndCgpKSB7CiAgICAgICAgICAgICAgICAgICAgY3VyTDFOb2RlcyA9IGwxTm9k\nZXNJdGVyLm5leHQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgaWYgKGlzU3BlY2lhbFpub2RlKGN1ckwxTm9k\nZXMpKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICBMaXN0PFN0cmluZz4gbDJOb2Rl\ncyA9IHprLmdldENoaWxkcmVuKGxlZGdlclJvb3RQYXRoICsgIi8iICsgY3Vy\nTDFOb2RlcywgbnVsbCk7CiAgICAgICAgICAgICAgICBDb2xsZWN0aW9ucy5z\nb3J0KGwyTm9kZXMpOwogICAgICAgICAgICAgICAgbDJOb2Rlc0l0ZXIgPSBs\nMk5vZGVzLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICBpZiAoIWwyTm9k\nZXNJdGVyLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgICAgIGwyTm9k\nZXNJdGVyID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHN5bmNocm9uaXplZCBw\ncml2YXRlIHZvaWQgcHJlbG9hZCgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIHdoaWxlIChuZXh0UmFuZ2UgPT0gbnVsbCAmJiAhaXRlcmF0\nb3JEb25lKSB7CiAgICAgICAgICAgICAgICBib29sZWFuIGhhc01vcmVFbGVt\nZW50cyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICBpZiAobDFOb2Rlc0l0ZXIgPT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgICAgICAgICBsMU5vZGVzSXRlciA9IHprLmdldENoaWxkcmVu\nKGxlZGdlclJvb3RQYXRoLCBudWxsKS5pdGVyYXRvcigpOwogICAgICAgICAg\nICAgICAgICAgICAgICBoYXNNb3JlRWxlbWVudHMgPSBuZXh0TDFOb2RlKCk7\nCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsMk5vZGVzSXRlciA9\nPSBudWxsIHx8ICFsMk5vZGVzSXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaGFzTW9yZUVsZW1lbnRzID0gbmV4dEwxTm9kZSgp\nOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGhhc01vcmVFbGVtZW50cyA9IHRydWU7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhj\nZXB0aW9uIGtlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElP\nRXhjZXB0aW9uKCJFcnJvciBwcmVsb2FkaW5nIG5leHQgcmFuZ2UiLCBrZSk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiBpZSkgewogICAgICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhy\nZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IElPRXhjZXB0aW9uKCJJbnRlcnJ1cHRlZCB3aGlsZSBwcmVsb2FkaW5n\nIiwgaWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYg\nKGhhc01vcmVFbGVtZW50cykgewogICAgICAgICAgICAgICAgICAgIG5leHRS\nYW5nZSA9IGdldExlZGdlclJhbmdlQnlMZXZlbChjdXJMMU5vZGVzLCBsMk5v\nZGVzSXRlci5uZXh0KCkpOwogICAgICAgICAgICAgICAgICAgIGlmIChuZXh0\nUmFuZ2Uuc2l6ZSgpID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nbmV4dFJhbmdlID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGl0ZXJh\ndG9yRG9uZSA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHN5bmNo\ncm9uaXplZCBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgcHJlbG9hZCgpOwogICAgICAgICAgICBy\nZXR1cm4gbmV4dFJhbmdlICE9IG51bGwgJiYgIWl0ZXJhdG9yRG9uZTsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHN5bmNocm9uaXpl\nZCBwdWJsaWMgTGVkZ2VyUmFuZ2UgbmV4dCgpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIGlmICghaGFzTmV4dCgpKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbigpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIExlZGdlclJhbmdlIHIgPSBuZXh0UmFu\nZ2U7CiAgICAgICAgICAgIG5leHRSYW5nZSA9IG51bGw7CiAgICAgICAgICAg\nIHJldHVybiByOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nR2V0IGEgc2luZ2xlIG5vZGUgbGV2ZWwxL2xldmVsMgogICAgICAgICAqCiAg\nICAgICAgICogQHBhcmFtIGxldmVsMQogICAgICAgICAqICAgICAgICAgIDFz\ndCBsZXZlbCBub2RlIG5hbWUKICAgICAgICAgKiBAcGFyYW0gbGV2ZWwyCiAg\nICAgICAgICogICAgICAgICAgMm5kIGxldmVsIG5vZGUgbmFtZQogICAgICAg\nICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAgICAgKi8KICAgICAgICBM\nZWRnZXJSYW5nZSBnZXRMZWRnZXJSYW5nZUJ5TGV2ZWwoZmluYWwgU3RyaW5n\nIGxldmVsMSwgZmluYWwgU3RyaW5nIGxldmVsMikKICAgICAgICAgICAgICAg\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIFN0cmluZ0J1aWxk\nZXIgbm9kZUJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nICAgICBub2RlQnVpbGRlci5hcHBlbmQobGVkZ2VyUm9vdFBhdGgpLmFwcGVu\nZCgiLyIpCiAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChsZXZlbDEp\nLmFwcGVuZCgiLyIpLmFwcGVuZChsZXZlbDIpOwogICAgICAgICAgICBTdHJp\nbmcgbm9kZVBhdGggPSBub2RlQnVpbGRlci50b1N0cmluZygpOwogICAgICAg\nICAgICBMaXN0PFN0cmluZz4gbGVkZ2VyTm9kZXMgPSBudWxsOwogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgbGVkZ2VyTm9kZXMgPSBaa1V0\naWxzLmdldENoaWxkcmVuSW5TaW5nbGVOb2RlKHprLCBub2RlUGF0aCk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiRXJyb3Ig\nd2hlbiBnZXQgY2hpbGQgbm9kZXMgZnJvbSB6ayIsIGUpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIE5hdmlnYWJsZVNldDxMb25nPiB6a0FjdGl2ZUxl\nZGdlcnMgPSBsZWRnZXJMaXN0VG9TZXQobGVkZ2VyTm9kZXMsIG5vZGVQYXRo\nKTsKICAgICAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgICAgICBMT0cuZGVidWcoIkFsbCBhY3RpdmUgbGVkZ2VycyBm\ncm9tIFpLIGZvciBoYXNoIG5vZGUgIgogICAgICAgICAgICAgICAgICAgICAg\nICAgICsgbGV2ZWwxICsgIi8iICsgbGV2ZWwyICsgIiA6ICIgKyB6a0FjdGl2\nZUxlZGdlcnMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4g\nbmV3IExlZGdlclJhbmdlKHprQWN0aXZlTGVkZ2Vycy5zdWJTZXQoZ2V0U3Rh\ncnRMZWRnZXJJZEJ5TGV2ZWwobGV2ZWwxLCBsZXZlbDIpLCB0cnVlLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZ2V0RW5kTGVkZ2VySWRCeUxldmVsKGxldmVsMSwgbGV2ZWwy\nKSwgdHJ1ZSkpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

