{"sha":"a5f54d51a544e0ff553aecb71edb4223d4b351ed","node_id":"MDQ6QmxvYjE1NzU5NTY6YTVmNTRkNTFhNTQ0ZTBmZjU1M2FlY2I3MWVkYjQyMjNkNGIzNTFlZA==","size":26777,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a5f54d51a544e0ff553aecb71edb4223d4b351ed","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCmltcG9ydCBzdGF0\naWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGFzdG9yZS5NZXRhc3RvcmVU\nYWJsZS5BTExfRklFTERTOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5tZXRhc3RvcmUuTWV0YXN0b3JlVGFibGUuTk9OX0ZJRUxEUzsK\nCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEu\ndXRpbC5Tb3J0ZWRTZXQ7CmltcG9ydCBqYXZhLnV0aWwuVHJlZVNldDsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKaW1wb3J0IGph\ndmEudXRpbC5jb25jdXJyZW50LlNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZTsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwoK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nck1ldGFkYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYu\nQWJzdHJhY3RDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLm1ldGFzdG9yZS5NU0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5tZXRhc3RvcmUuTWV0YVN0b3JlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLm1ldGFzdG9yZS5NZXRhc3RvcmVDYWxsYmFj\nazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhc3RvcmUuTWV0\nYXN0b3JlQ3Vyc29yOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1l\ndGFzdG9yZS5NZXRhc3RvcmVDdXJzb3IuUmVhZEVudHJpZXNDYWxsYmFjazsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhc3RvcmUuTWV0YXN0\nb3JlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1l\ndGFzdG9yZS5NZXRhc3RvcmVGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLm1ldGFzdG9yZS5NZXRhc3RvcmVTY2FubmFibGVUYWJsZTsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhc3RvcmUuTWV0YXN0\nb3JlVGFibGVJdGVtOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1l\ndGFzdG9yZS5WYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0NhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5Qcm9jZXNzb3I7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb24uUmVwbGljYXRpb25FeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLlpr\nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudmVyc2lvbmlu\nZy5WZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnZlcnNp\nb25pbmcuVmVyc2lvbmVkOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nQXN5bmNDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkFz\neW5jQ2FsbGJhY2suU3RyaW5nQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hl\nLnpvb2tlZXBlci5DcmVhdGVNb2RlOwppbXBvcnQgb3JnLmFwYWNoZS56b29r\nZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29r\nZWVwZXIuWm9vRGVmcy5JZHM7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5ab29LZWVwZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioKICogTWV0YVN0b3JlIEJh\nc2VkIExlZGdlciBNYW5hZ2VyIEZhY3RvcnkKICovCnB1YmxpYyBjbGFzcyBN\nU0xlZGdlck1hbmFnZXJGYWN0b3J5IGV4dGVuZHMgTGVkZ2VyTWFuYWdlckZh\nY3RvcnkgewoKICAgIHN0YXRpYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9y\neS5nZXRMb2dnZXIoTVNMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcyk7Cgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ1VSX1ZFUlNJT04gPSAxOwoK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFRBQkxFX05BTUUgPSAi\nTEVER0VSIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIE1FVEFf\nRklFTEQgPSAiLk1FVEEiOwoKICAgIEFic3RyYWN0Q29uZmlndXJhdGlvbiBj\nb25mOwogICAgWm9vS2VlcGVyIHprOwogICAgTWV0YVN0b3JlIG1ldGFzdG9y\nZTsKCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBpbnQgZ2V0Q3VycmVudFZl\ncnNpb24oKSB7CiAgICAgICAgcmV0dXJuIENVUl9WRVJTSU9OOwogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIExlZGdlck1hbmFnZXJGYWN0b3J5\nIGluaXRpYWxpemUoZmluYWwgQWJzdHJhY3RDb25maWd1cmF0aW9uIGNvbmYs\nIGZpbmFsIFpvb0tlZXBlciB6aywKICAgICAgICAgICAgZmluYWwgaW50IGZh\nY3RvcnlWZXJzaW9uKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlm\nIChDVVJfVkVSU0lPTiAhPSBmYWN0b3J5VmVyc2lvbikgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkluY29tcGF0aWJsZSBsYXlvdXQg\ndmVyc2lvbiBmb3VuZCA6ICIgKyBmYWN0b3J5VmVyc2lvbik7CiAgICAgICAg\nfQogICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CiAgICAgICAgdGhpcy56ayA9\nIHprOwoKICAgICAgICAvLyBsb2FkIG1ldGFkYXRhIHN0b3JlCiAgICAgICAg\nU3RyaW5nIG1zTmFtZSA9IGNvbmYuZ2V0TWV0YXN0b3JlSW1wbENsYXNzKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbWV0YXN0b3JlID0gTWV0YXN0\nb3JlRmFjdG9yeS5jcmVhdGVNZXRhU3RvcmUobXNOYW1lKTsKCiAgICAgICAg\nICAgIC8vIFRPRE86IHNob3VsZCByZWNvcmQgdmVyc2lvbiBpbiBzb21ld2hl\ncmUuIGUuZy4gWm9vS2VlcGVyCiAgICAgICAgICAgIGludCBtc1ZlcnNpb24g\nPSBtZXRhc3RvcmUuZ2V0VmVyc2lvbigpOwogICAgICAgICAgICBtZXRhc3Rv\ncmUuaW5pdChjb25mLCBtc1ZlcnNpb24pOwogICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlv\nbigiRmFpbGVkIHRvIGluaXRpYWxpemUgbWV0YXN0b3JlICIgKyBtc05hbWUg\nKyAiIDogIiwgdCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGhpczsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHVuaW5pdGlh\nbGl6ZSgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgbWV0YXN0b3Jl\nLmNsb3NlKCk7CiAgICB9CgogICAgc3RhdGljIExvbmcga2V5MkxlZGdlcklk\nKFN0cmluZyBrZXkpIHsKICAgICAgICByZXR1cm4gbnVsbCA9PSBrZXkgPyBu\ndWxsIDogTG9uZy5wYXJzZUxvbmcoa2V5LCAxMCk7CiAgICB9CgogICAgc3Rh\ndGljIFN0cmluZyBsZWRnZXJJZDJLZXkoTG9uZyBsaWQpIHsKICAgICAgICBy\nZXR1cm4gbnVsbCA9PSBsaWQgPyBudWxsIDogU3RyaW5nVXRpbHMuZ2V0WktT\ndHJpbmdJZChsaWQpOwogICAgfQoKICAgIHN0YXRpYyBTdHJpbmcgcmFuZ2VU\nb1N0cmluZyhMb25nIGZpcnN0TGVkZ2VyLCBib29sZWFuIGZpcnN0SW5jbHVz\naXZlLCBMb25nIGxhc3RMZWRnZXIsIGJvb2xlYW4gbGFzdEluY2x1c2l2ZSkg\newogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRl\ncigpOwogICAgICAgIHNiLmFwcGVuZChmaXJzdEluY2x1c2l2ZSA/ICJbICIg\nOiAiKCAiKS5hcHBlbmQoZmlyc3RMZWRnZXIpLmFwcGVuZCgiIH4gIikuYXBw\nZW5kKGxhc3RMZWRnZXIpCiAgICAgICAgICAgICAgICAuYXBwZW5kKGxhc3RJ\nbmNsdXNpdmUgPyAiIF0iIDogIiApIik7CiAgICAgICAgcmV0dXJuIHNiLnRv\nU3RyaW5nKCk7CiAgICB9CgogICAgc3RhdGljIFNvcnRlZFNldDxMb25nPiBl\nbnRyaWVzMkxlZGdlcnMoSXRlcmF0b3I8TWV0YXN0b3JlVGFibGVJdGVtPiBl\nbnRyaWVzKSB7CiAgICAgICAgU29ydGVkU2V0PExvbmc+IGxlZGdlcnMgPSBu\nZXcgVHJlZVNldDxMb25nPigpOwogICAgICAgIHdoaWxlIChlbnRyaWVzLmhh\nc05leHQoKSkgewogICAgICAgICAgICBNZXRhc3RvcmVUYWJsZUl0ZW0gaXRl\nbSA9IGVudHJpZXMubmV4dCgpOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgbGVkZ2Vycy5hZGQoa2V5MkxlZGdlcklkKGl0ZW0uZ2V0S2V5\nKCkpKTsKICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0\naW9uIG5mZSkgewogICAgICAgICAgICAgICAgTE9HLndhcm4oIkZvdW5kIGlu\ndmFsaWQgbGVkZ2VyIGtleSB7fSIsIGl0ZW0uZ2V0S2V5KCkpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBsZWRnZXJzOwogICAg\nfQoKICAgIHN0YXRpYyBjbGFzcyBTeW5jUmVzdWx0PFQ+IHsKICAgICAgICBU\nIHZhbHVlOwogICAgICAgIGludCByYzsKICAgICAgICBib29sZWFuIGZpbmlz\naGVkID0gZmFsc2U7CgogICAgICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9p\nZCBjb21wbGV0ZShpbnQgcmMsIFQgdmFsdWUpIHsKICAgICAgICAgICAgdGhp\ncy5yYyA9IHJjOwogICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAg\nICAgICAgICAgIGZpbmlzaGVkID0gdHJ1ZTsKCiAgICAgICAgICAgIG5vdGlm\neSgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHN5bmNocm9uaXplZCB2\nb2lkIGJsb2NrKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgd2hpbGUgKCFmaW5pc2hlZCkgewogICAgICAgICAgICAgICAgICAgIHdh\naXQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAo\nSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHN5bmNocm9uaXplZCBpbnQgZ2V0UmV0\nQ29kZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHJjOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHN5bmNocm9uaXplZCBUIGdldFJlc3VsdCgpIHsKICAg\nICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgIH0KCiAgICBz\ndGF0aWMgY2xhc3MgTXNMZWRnZXJNYW5hZ2VyIGltcGxlbWVudHMgTGVkZ2Vy\nTWFuYWdlciB7CiAgICAgICAgZmluYWwgWm9vS2VlcGVyIHprOwogICAgICAg\nIGZpbmFsIEFic3RyYWN0Q29uZmlndXJhdGlvbiBjb25mOwoKICAgICAgICBm\naW5hbCBNZXRhU3RvcmUgbWV0YXN0b3JlOwogICAgICAgIGZpbmFsIE1ldGFz\ndG9yZVNjYW5uYWJsZVRhYmxlIGxlZGdlclRhYmxlOwogICAgICAgIGZpbmFs\nIGludCBtYXhFbnRyaWVzUGVyU2NhbjsKCiAgICAgICAgc3RhdGljIGZpbmFs\nIFN0cmluZyBJREdFTl9aTk9ERSA9ICJtcy1pZGdlbiI7CiAgICAgICAgc3Rh\ndGljIGZpbmFsIFN0cmluZyBJREdFTkVSQVRJT05fUFJFRklYID0gIi8iICsg\nSURHRU5fWk5PREUgKyAiL0lELSI7CgogICAgICAgIC8vIFBhdGggdG8gZ2Vu\nZXJhdGUgZ2xvYmFsIGlkCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcg\naWRHZW5QYXRoOwoKICAgICAgICAvLyB3ZSB1c2UgdGhpcyB0byBwcmV2ZW50\nIGxvbmcgc3RhY2sgY2hhaW5zIGZyb20gYnVpbGRpbmcgdXAgaW4KICAgICAg\nICAvLyBjYWxsYmFja3MKICAgICAgICBTY2hlZHVsZWRFeGVjdXRvclNlcnZp\nY2Ugc2NoZWR1bGVyOwoKICAgICAgICBNc0xlZGdlck1hbmFnZXIoZmluYWwg\nQWJzdHJhY3RDb25maWd1cmF0aW9uIGNvbmYsIGZpbmFsIFpvb0tlZXBlciB6\naywgZmluYWwgTWV0YVN0b3JlIG1ldGFzdG9yZSkgewogICAgICAgICAgICB0\naGlzLmNvbmYgPSBjb25mOwogICAgICAgICAgICB0aGlzLnprID0gems7CiAg\nICAgICAgICAgIHRoaXMubWV0YXN0b3JlID0gbWV0YXN0b3JlOwoKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxlZGdlclRhYmxlID0gbWV0\nYXN0b3JlLmNyZWF0ZVNjYW5uYWJsZVRhYmxlKFRBQkxFX05BTUUpOwogICAg\nICAgICAgICB9IGNhdGNoIChNZXRhc3RvcmVFeGNlcHRpb24gbXNlKSB7CiAg\nICAgICAgICAgICAgICBMT0cuZXJyb3IoIkZhaWxlZCB0byBpbnN0YW50aWF0\nZSB0YWJsZSAiICsgVEFCTEVfTkFNRSArICIgaW4gbWV0YXN0b3JlICIgKyBt\nZXRhc3RvcmUuZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBSdW50aW1lRXhjZXB0aW9uKCJGYWlsZWQgdG8gaW5zdGFudGlhdGUgdGFi\nbGUgIiArIFRBQkxFX05BTUUgKyAiIGluIG1ldGFzdG9yZSAiCiAgICAgICAg\nICAgICAgICAgICAgICAgICsgbWV0YXN0b3JlLmdldE5hbWUoKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgLy8gY29uZmlndXJhdGlvbiBzZXR0aW5n\ncwogICAgICAgICAgICBtYXhFbnRyaWVzUGVyU2NhbiA9IGNvbmYuZ2V0TWV0\nYXN0b3JlTWF4RW50cmllc1BlclNjYW4oKTsKCiAgICAgICAgICAgIHRoaXMu\naWRHZW5QYXRoID0gY29uZi5nZXRaa0xlZGdlcnNSb290UGF0aCgpICsgSURH\nRU5FUkFUSU9OX1BSRUZJWDsKICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIg\nPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhyZWFkU2NoZWR1bGVkRXhlY3V0b3Io\nKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIGNsb3NlKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgc2NoZWR1bGVyLnNodXRkb3duKCk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBMT0cud2Fybigi\nRXJyb3Igd2hlbiBjbG9zaW5nIE1zTGVkZ2VyTWFuYWdlciA6ICIsIGUpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGxlZGdlclRhYmxlLmNsb3NlKCk7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\ndm9pZCBjcmVhdGVMZWRnZXIoZmluYWwgTGVkZ2VyTWV0YWRhdGEgbWV0YWRh\ndGEsIGZpbmFsIEdlbmVyaWNDYWxsYmFjazxMb25nPiBsZWRnZXJDYikgewog\nICAgICAgICAgICBaa1V0aWxzLmFzeW5jQ3JlYXRlRnVsbFBhdGhPcHRpbWlz\ndGljKHprLCBpZEdlblBhdGgsIG5ldyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xf\nVU5TQUZFLAogICAgICAgICAgICAgICAgICAgIENyZWF0ZU1vZGUuRVBIRU1F\nUkFMX1NFUVVFTlRJQUwsIG5ldyBTdHJpbmdDYWxsYmFjaygpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJp\nbmcgcGF0aCwgT2JqZWN0IGN0eCwgZmluYWwgU3RyaW5nIGlkUGF0aE5hbWUp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBLZWVw\nZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJDb3VsZCBub3QgZ2Vu\nZXJhdGUgbmV3IGxlZGdlciBpZCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBl\nckV4Y2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBsZWRnZXJDYi5vcGVyYXRpb25Db21wbGV0\nZShCS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uLCBudWxsKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAvKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICogRXh0cmFjdCBs\nZWRnZXIgaWQgZnJvbSBnZW4gcGF0aAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxl\nZGdlcklkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWRnZXJJZCA9IGdldExl\nZGdlcklkRnJvbUdlblBhdGgoaWRQYXRoTmFtZSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJDb3VsZCBu\nb3QgZXh0cmFjdCBsZWRnZXItaWQgZnJvbSBpZCBnZW4gcGF0aDoiICsgcGF0\naCwgZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVkZ2Vy\nQ2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5aS0V4Y2Vw\ndGlvbiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIGxvbmcgbGlkID0gbGVkZ2Vy\nSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXRhc3RvcmVDYWxs\nYmFjazxWZXJzaW9uPiBtc0NhbGxiYWNrID0gbmV3IE1ldGFzdG9yZUNhbGxi\nYWNrPFZlcnNpb24+KCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIGNvbXBsZXRlKGludCByYywgVmVyc2lvbiB2ZXJzaW9u\nLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChNU0V4Y2VwdGlvbi5Db2RlLkJhZFZlcnNpb24uZ2V0Q29k\nZSgpID09IHJjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBsZWRnZXJDYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlv\nbi5Db2RlLk1ldGFkYXRhVmVyc2lvbkV4Y2VwdGlvbiwgbnVsbCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1TRXhjZXB0aW9uLkNv\nZGUuT0suZ2V0Q29kZSgpICE9IHJjKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBsZWRnZXJDYi5vcGVyYXRpb25Db21wbGV0\nZShCS0V4Y2VwdGlvbi5Db2RlLk1ldGFTdG9yZUV4Y2VwdGlvbiwgbnVsbCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJD\ncmVhdGUgbGVkZ2VyIHt9IHdpdGggdmVyc2lvbiB7fSBzdWNjZXNzZnVseS4i\nLCBuZXcgT2JqZWN0W10geyBsaWQsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiB9KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIHZlcnNpb24KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEuc2V0\nVmVyc2lvbih2ZXJzaW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbGVkZ2VyQ2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRp\nb24uQ29kZS5PSywgbGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGxlZGdlclRhYmxlLnB1dChsZWRnZXJJ\nZDJLZXkobGlkKSwgbmV3IFZhbHVlKCkuc2V0RmllbGQoTUVUQV9GSUVMRCwg\nbWV0YWRhdGEuc2VyaWFsaXplKCkpLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBWZXJzaW9uLk5FVywgbXNDYWxsYmFjaywgbnVsbCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6ay5kZWxldGUoaWRQYXRo\nTmFtZSwgLTEsIG5ldyBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjaygpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9j\nZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9\nIEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJF\neGNlcHRpb24gZHVyaW5nIGRlbGV0aW5nIHpub2RlIGZvciBpZCBnZW5lcmF0\naW9uIDogIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNl\ncHRpb24uQ29kZS5nZXQocmMpLCBwYXRoKSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoIkRlbGV0aW5nIHpu\nb2RlIGZvciBpZCBnZW5lcmF0aW9uIDoge30iLCBpZFBhdGhOYW1lKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIH0sIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfSwgbnVsbCk7CiAgICAgICAgfQoKICAgICAg\nICAvLyBnZXQgbGVkZ2VyIGlkIGZyb20gZ2VuZXJhdGlvbiBwYXRoCiAgICAg\nICAgcHJpdmF0ZSBsb25nIGdldExlZGdlcklkRnJvbUdlblBhdGgoU3RyaW5n\nIG5vZGVOYW1lKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBs\nb25nIGxlZGdlcklkOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgU3RyaW5nIHBhcnRzW10gPSBub2RlTmFtZS5zcGxpdChJREdFTkVSQVRJ\nT05fUFJFRklYKTsKICAgICAgICAgICAgICAgIGxlZGdlcklkID0gTG9uZy5w\nYXJzZUxvbmcocGFydHNbcGFydHMubGVuZ3RoIC0gMV0pOwogICAgICAgICAg\nICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKGUpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHJldHVybiBsZWRnZXJJZDsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHJlbW92ZUxl\nZGdlck1ldGFkYXRhKGZpbmFsIGxvbmcgbGVkZ2VySWQsIGZpbmFsIFZlcnNp\nb24gdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBmaW5hbCBHZW5lcmljQ2FsbGJhY2s8Vm9pZD4gY2IpIHsKICAg\nICAgICAgICAgTWV0YXN0b3JlQ2FsbGJhY2s8Vm9pZD4gbXNDYWxsYmFjayA9\nIG5ldyBNZXRhc3RvcmVDYWxsYmFjazxWb2lkPigpIHsKICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgY29t\ncGxldGUoaW50IHJjLCBWb2lkIHZhbHVlLCBPYmplY3QgY3R4KSB7CiAgICAg\nICAgICAgICAgICAgICAgaW50IGJrUmM7CiAgICAgICAgICAgICAgICAgICAg\naWYgKE1TRXhjZXB0aW9uLkNvZGUuTm9LZXkuZ2V0Q29kZSgpID09IHJjKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJMZWRnZXIgZW50\ncnkgZG9lcyBub3QgZXhpc3QgaW4gbWV0YSB0YWJsZTogbGVkZ2VySWQ9e30i\nLCBsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJrUmMgPSBC\nS0V4Y2VwdGlvbi5Db2RlLk5vU3VjaExlZGdlckV4aXN0c0V4Y2VwdGlvbjsK\nICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKE1TRXhjZXB0aW9uLkNv\nZGUuT0suZ2V0Q29kZSgpID09IHJjKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGJrUmMgPSBCS0V4Y2VwdGlvbi5Db2RlLk9LOwogICAgICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJrUmMg\nPSBCS0V4Y2VwdGlvbi5Db2RlLk1ldGFTdG9yZUV4Y2VwdGlvbjsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0\naW9uQ29tcGxldGUoYmtSYywgKFZvaWQpIG51bGwpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBsZWRnZXJUYWJsZS5y\nZW1vdmUobGVkZ2VySWQyS2V5KGxlZGdlcklkKSwgdmVyc2lvbiwgbXNDYWxs\nYmFjaywgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBwdWJsaWMgdm9pZCByZWFkTGVkZ2VyTWV0YWRhdGEoZmluYWwgbG9u\nZyBsZWRnZXJJZCwgZmluYWwgR2VuZXJpY0NhbGxiYWNrPExlZGdlck1ldGFk\nYXRhPiByZWFkQ2IpIHsKICAgICAgICAgICAgZmluYWwgU3RyaW5nIGtleSA9\nIGxlZGdlcklkMktleShsZWRnZXJJZCk7CiAgICAgICAgICAgIE1ldGFzdG9y\nZUNhbGxiYWNrPFZlcnNpb25lZDxWYWx1ZT4+IG1zQ2FsbGJhY2sgPSBuZXcg\nTWV0YXN0b3JlQ2FsbGJhY2s8VmVyc2lvbmVkPFZhbHVlPj4oKSB7CiAgICAg\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIGNvbXBsZXRlKGludCByYywgVmVyc2lvbmVkPFZhbHVlPiB2YWx1ZSwg\nT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgIGlmIChNU0V4Y2Vw\ndGlvbi5Db2RlLk5vS2V5LmdldENvZGUoKSA9PSByYykgewogICAgICAgICAg\nICAgICAgICAgICAgICBMT0cuZXJyb3IoIk5vIGxlZGdlciBtZXRhZGF0YSBm\nb3VuZCBmb3IgbGVkZ2VyICIgKyBsZWRnZXJJZCArICIgOiAiLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIE1TRXhjZXB0aW9uLmNyZWF0ZShN\nU0V4Y2VwdGlvbi5Db2RlLmdldChyYyksICJObyBrZXkgIiArIGtleSArICIg\nZm91bmQuIikpOwogICAgICAgICAgICAgICAgICAgICAgICByZWFkQ2Iub3Bl\ncmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5Ob1N1Y2hMZWRnZXJF\neGlzdHNFeGNlcHRpb24sIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIGlmIChNU0V4Y2VwdGlvbi5Db2RlLk9LLmdldENvZGUoKSAhPSBy\nYykgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkNvdWxk\nIG5vdCByZWFkIG1ldGFkYXRhIGZvciBsZWRnZXIgIiArIGxlZGdlcklkICsg\nIiA6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTVNFeGNl\ncHRpb24uY3JlYXRlKE1TRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSwgIkZhaWxl\nZCB0byBnZXQga2V5ICIgKyBrZXkpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgcmVhZENiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUu\nTWV0YVN0b3JlRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICBMZWRnZXJNZXRhZGF0YSBtZXRhZGF0YTsKICAgICAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBtZXRh\nZGF0YSA9IExlZGdlck1ldGFkYXRhCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLnBhcnNlQ29uZmlnKHZhbHVlLmdldFZhbHVlKCkuZ2V0Rmll\nbGQoTUVUQV9GSUVMRCksIHZhbHVlLmdldFZlcnNpb24oKSk7CiAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkNvdWxkIG5vdCBwYXJzZSBs\nZWRnZXIgbWV0YWRhdGEgZm9yIGxlZGdlciAiICsgbGVkZ2VySWQgKyAiIDog\nIiwgZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRDYi5vcGVyYXRp\nb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLk1ldGFTdG9yZUV4Y2VwdGlv\nbiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVhZENi\nLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuT0ssIG1ldGFk\nYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAg\nICAgICAgbGVkZ2VyVGFibGUuZ2V0KGtleSwgbXNDYWxsYmFjaywgQUxMX0ZJ\nRUxEUyk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgdm9pZCB3cml0ZUxlZGdlck1ldGFkYXRhKGZpbmFsIGxvbmcgbGVk\nZ2VySWQsIGZpbmFsIExlZGdlck1ldGFkYXRhIG1ldGFkYXRhLAogICAgICAg\nICAgICAgICAgZmluYWwgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+IGNiKSB7CiAg\nICAgICAgICAgIFZhbHVlIGRhdGEgPSBuZXcgVmFsdWUoKS5zZXRGaWVsZChN\nRVRBX0ZJRUxELCBtZXRhZGF0YS5zZXJpYWxpemUoKSk7CgogICAgICAgICAg\nICBMT0cuZGVidWcoIldyaXRpbmcgbGVkZ2VyIHt9IG1ldGFkYXRhLCB2ZXJz\naW9uIHt9IiwgbmV3IE9iamVjdFtdIHsgbGVkZ2VySWQsIG1ldGFkYXRhLmdl\ndFZlcnNpb24oKSB9KTsKCiAgICAgICAgICAgIGZpbmFsIFN0cmluZyBrZXkg\nPSBsZWRnZXJJZDJLZXkobGVkZ2VySWQpOwogICAgICAgICAgICBNZXRhc3Rv\ncmVDYWxsYmFjazxWZXJzaW9uPiBtc0NhbGxiYWNrID0gbmV3IE1ldGFzdG9y\nZUNhbGxiYWNrPFZlcnNpb24+KCkgewogICAgICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBjb21wbGV0ZShpbnQg\ncmMsIFZlcnNpb24gdmVyc2lvbiwgT2JqZWN0IGN0eCkgewogICAgICAgICAg\nICAgICAgICAgIGludCBia1JjOwogICAgICAgICAgICAgICAgICAgIGlmIChN\nU0V4Y2VwdGlvbi5Db2RlLkJhZFZlcnNpb24uZ2V0Q29kZSgpID09IHJjKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJCYWQgdmVyc2lv\nbiBwcm92aWRlZCB0byB1cGRhdCBtZXRhZGF0YSBmb3IgbGVkZ2VyIHt9Iiwg\nbGVkZ2VySWQpOwogICAgICAgICAgICAgICAgICAgICAgICBia1JjID0gQktF\neGNlcHRpb24uQ29kZS5NZXRhZGF0YVZlcnNpb25FeGNlcHRpb247CiAgICAg\nICAgICAgICAgICAgICAgfSBlbHNlIGlmIChNU0V4Y2VwdGlvbi5Db2RlLk5v\nS2V5LmdldENvZGUoKSA9PSByYykgewogICAgICAgICAgICAgICAgICAgICAg\nICBMT0cud2FybigiTGVkZ2VyIHt9IGRvZXNuJ3QgZXhpc3Qgd2hlbiB3cml0\naW5nIGl0cyBsZWRnZXIgbWV0YWRhdGEuIiwgbGVkZ2VySWQpOwogICAgICAg\nICAgICAgICAgICAgICAgICBia1JjID0gQktFeGNlcHRpb24uQ29kZS5Ob1N1\nY2hMZWRnZXJFeGlzdHNFeGNlcHRpb247CiAgICAgICAgICAgICAgICAgICAg\nfSBlbHNlIGlmIChNU0V4Y2VwdGlvbi5Db2RlLk9LLmdldENvZGUoKSA9PSBy\nYykgewogICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS5zZXRWZXJz\naW9uKHZlcnNpb24pOwogICAgICAgICAgICAgICAgICAgICAgICBia1JjID0g\nQktFeGNlcHRpb24uQ29kZS5PSzsKICAgICAgICAgICAgICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cud2FybigiQ29uZGl0\naW9uYWwgdXBkYXRlIGxlZGdlciBtZXRhZGF0YSBmYWlsZWQ6ICIsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTVNFeGNlcHRpb24uY3JlYXRl\nKE1TRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSwgIkZhaWxlZCB0byBwdXQga2V5\nICIgKyBrZXkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYmtSYyA9IEJL\nRXhjZXB0aW9uLkNvZGUuTWV0YVN0b3JlRXhjZXB0aW9uOwogICAgICAgICAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9u\nQ29tcGxldGUoYmtSYywgbnVsbCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH07CiAgICAgICAgICAgIGxlZGdlclRhYmxlLnB1dChrZXksIGRh\ndGEsIG1ldGFkYXRhLmdldFZlcnNpb24oKSwgbXNDYWxsYmFjaywgbnVsbCk7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\ndm9pZCBhc3luY1Byb2Nlc3NMZWRnZXJzKGZpbmFsIFByb2Nlc3NvcjxMb25n\nPiBwcm9jZXNzb3IsIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNr\nIGZpbmFsQ2IsCiAgICAgICAgICAgICAgICBmaW5hbCBPYmplY3QgY29udGV4\ndCwgZmluYWwgaW50IHN1Y2Nlc3NSYywgZmluYWwgaW50IGZhaWx1cmVSYykg\newogICAgICAgICAgICBNZXRhc3RvcmVDYWxsYmFjazxNZXRhc3RvcmVDdXJz\nb3I+IG9wZW5DdXJzb3JDYiA9IG5ldyBNZXRhc3RvcmVDYWxsYmFjazxNZXRh\nc3RvcmVDdXJzb3I+KCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBjb21wbGV0ZShpbnQgcmMsIE1l\ndGFzdG9yZUN1cnNvciBjdXJzb3IsIE9iamVjdCBjdHgpIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAoTVNFeGNlcHRpb24uQ29kZS5PSy5nZXRDb2RlKCkg\nIT0gcmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxDYi5wcm9j\nZXNzUmVzdWx0KGZhaWx1cmVSYywgbnVsbCwgY29udGV4dCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXJzb3IuaGFzTW9yZUVudHJp\nZXMoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBmaW5hbENiLnByb2Nl\nc3NSZXN1bHQoc3VjY2Vzc1JjLCBudWxsLCBjb250ZXh0KTsKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICBhc3luY1Byb2Nlc3NMZWRnZXJzKGN1cnNv\nciwgcHJvY2Vzc29yLCBmaW5hbENiLCBjb250ZXh0LCBzdWNjZXNzUmMsIGZh\naWx1cmVSYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAg\nICAgICAgICAgIGxlZGdlclRhYmxlLm9wZW5DdXJzb3IoTk9OX0ZJRUxEUywg\nb3BlbkN1cnNvckNiLCBudWxsKTsKICAgICAgICB9CgogICAgICAgIHZvaWQg\nYXN5bmNQcm9jZXNzTGVkZ2VycyhmaW5hbCBNZXRhc3RvcmVDdXJzb3IgY3Vy\nc29yLCBmaW5hbCBQcm9jZXNzb3I8TG9uZz4gcHJvY2Vzc29yLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBBc3luY0NhbGxiYWNr\nLlZvaWRDYWxsYmFjayBmaW5hbENiLCBmaW5hbCBPYmplY3QgY29udGV4dCwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgaW50IHN1\nY2Nlc3NSYywgZmluYWwgaW50IGZhaWx1cmVSYykgewogICAgICAgICAgICBz\nY2hlZHVsZXIuc3VibWl0KG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVu\nKCkgewogICAgICAgICAgICAgICAgICAgIGRvQXN5bmNQcm9jZXNzTGVkZ2Vy\ncyhjdXJzb3IsIHByb2Nlc3NvciwgZmluYWxDYiwgY29udGV4dCwgc3VjY2Vz\nc1JjLCBmYWlsdXJlUmMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9KTsKICAgICAgICB9CgogICAgICAgIHZvaWQgZG9Bc3luY1Byb2Nlc3NM\nZWRnZXJzKGZpbmFsIE1ldGFzdG9yZUN1cnNvciBjdXJzb3IsIGZpbmFsIFBy\nb2Nlc3NvcjxMb25nPiBwcm9jZXNzb3IsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJh\nY2sgZmluYWxDYiwgZmluYWwgT2JqZWN0IGNvbnRleHQsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgaW50IHN1Y2Nlc3NSYywg\nZmluYWwgaW50IGZhaWx1cmVSYykgewogICAgICAgICAgICAvLyBubyBlbnRy\naWVzIG5vdwogICAgICAgICAgICBpZiAoIWN1cnNvci5oYXNNb3JlRW50cmll\ncygpKSB7CiAgICAgICAgICAgICAgICBmaW5hbENiLnByb2Nlc3NSZXN1bHQo\nc3VjY2Vzc1JjLCBudWxsLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBSZWFkRW50cmllc0Nh\nbGxiYWNrIG1zQ2FsbGJhY2sgPSBuZXcgUmVhZEVudHJpZXNDYWxsYmFjaygp\nIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgY29tcGxldGUoaW50IHJjLCBJdGVyYXRvcjxNZXRhc3Rv\ncmVUYWJsZUl0ZW0+IGVudHJpZXMsIE9iamVjdCBjdHgpIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAoTVNFeGNlcHRpb24uQ29kZS5PSy5nZXRDb2RlKCkg\nIT0gcmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxDYi5wcm9j\nZXNzUmVzdWx0KGZhaWx1cmVSYywgbnVsbCwgY29udGV4dCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9\nCgogICAgICAgICAgICAgICAgICAgIFNvcnRlZFNldDxMb25nPiBsZWRnZXJz\nID0gbmV3IFRyZWVTZXQ8TG9uZz4oKTsKICAgICAgICAgICAgICAgICAgICB3\naGlsZSAoZW50cmllcy5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgTWV0YXN0b3JlVGFibGVJdGVtIGl0ZW0gPSBlbnRyaWVzLm5leHQo\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxlZGdlcnMuYWRkKGtleTJMZWRnZXJJZChpdGVt\nLmdldEtleSgpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIExPRy53YXJuKCJGb3VuZCBpbnZhbGlkIGxlZGdlciBr\nZXkge30iLCBpdGVtLmdldEtleSgpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAg\nICAgaWYgKDAgPT0gbGVkZ2Vycy5zaXplKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gcHJvY2VzcyBuZXh0IGJhdGNoIG9mIGxlZGdlcnMKICAg\nICAgICAgICAgICAgICAgICAgICAgYXN5bmNQcm9jZXNzTGVkZ2VycyhjdXJz\nb3IsIHByb2Nlc3NvciwgZmluYWxDYiwgY29udGV4dCwgc3VjY2Vzc1JjLCBm\nYWlsdXJlUmMpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmaW5h\nbCBsb25nIHN0YXJ0TGVkZ2VyID0gbGVkZ2Vycy5maXJzdCgpOwogICAgICAg\nICAgICAgICAgICAgIGZpbmFsIGxvbmcgZW5kTGVkZ2VyID0gbGVkZ2Vycy5s\nYXN0KCk7CgogICAgICAgICAgICAgICAgICAgIEFzeW5jU2V0UHJvY2Vzc29y\nPExvbmc+IHNldFByb2Nlc3NvciA9IG5ldyBBc3luY1NldFByb2Nlc3NvcjxM\nb25nPihzY2hlZHVsZXIpOwogICAgICAgICAgICAgICAgICAgIC8vIHByb2Nl\nc3Mgc2V0CiAgICAgICAgICAgICAgICAgICAgc2V0UHJvY2Vzc29yLnByb2Nl\nc3MobGVkZ2VycywgcHJvY2Vzc29yLCBuZXcgQXN5bmNDYWxsYmFjay5Wb2lk\nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNz\nUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzUmMgIT0gcmMp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3Io\nIkZhaWxlZCB3aGVuIHByb2Nlc3NpbmcgcmFuZ2UgIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKyByYW5nZVRvU3RyaW5nKHN0\nYXJ0TGVkZ2VyLCB0cnVlLCBlbmRMZWRnZXIsIHRydWUpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBmaW5hbENiLnByb2Nlc3NSZXN1bHQo\nZmFpbHVyZVJjLCBudWxsLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9jZXNz\nIG5leHQgYmF0Y2ggb2YgbGVkZ2VycwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgYXN5bmNQcm9jZXNzTGVkZ2VycyhjdXJzb3IsIHByb2Nlc3Nvciwg\nZmluYWxDYiwgY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwg\nY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBjdXJzb3IuYXN5bmNS\nZWFkRW50cmllcyhtYXhFbnRyaWVzUGVyU2NhbiwgbXNDYWxsYmFjaywgbnVs\nbCk7CiAgICAgICAgfQoKICAgICAgICBjbGFzcyBNU0xlZGdlclJhbmdlSXRl\ncmF0b3IgaW1wbGVtZW50cyBMZWRnZXJSYW5nZUl0ZXJhdG9yIHsKICAgICAg\nICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggb3BlbkN1cnNvckxhdGNoID0g\nbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgICAgICBNZXRhc3RvcmVD\ndXJzb3IgY3Vyc29yID0gbnVsbDsKICAgICAgICAgICAgLy8gbGFzdCBsZWRn\nZXIgaWQgaW4gcHJldmlvdXMgcmFuZ2UKCiAgICAgICAgICAgIE1TTGVkZ2Vy\nUmFuZ2VJdGVyYXRvcigpIHsKICAgICAgICAgICAgICAgIE1ldGFzdG9yZUNh\nbGxiYWNrPE1ldGFzdG9yZUN1cnNvcj4gb3BlbkN1cnNvckNiID0gbmV3IE1l\ndGFzdG9yZUNhbGxiYWNrPE1ldGFzdG9yZUN1cnNvcj4oKSB7CiAgICAgICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgY29tcGxldGUoaW50IHJjLCBNZXRhc3RvcmVDdXJzb3IgbmV3\nQ3Vyc29yLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmIChNU0V4Y2VwdGlvbi5Db2RlLk9LLmdldENvZGUoKSAhPSByYykgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJvciBv\ncGVuaW5nIGN1cnNvciBmb3IgbGVkZ2VyIHJhbmdlIGl0ZXJhdG9yIHt9Iiwg\ncmMpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgY3Vyc29yID0gbmV3Q3Vyc29yOwogICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nIG9wZW5DdXJzb3JMYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgbGVk\nZ2VyVGFibGUub3BlbkN1cnNvcihOT05fRklFTERTLCBvcGVuQ3Vyc29yQ2Is\nIG51bGwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzTmV4dCgpIHRocm93cyBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgIG9wZW5DdXJzb3JMYXRjaC5hd2FpdCgpOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAg\nICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkludGVycnVwdGVkIHdhaXRp\nbmcgZm9yIGN1cnNvciB0byBvcGVuIiwgaWUpOwogICAgICAgICAgICAgICAg\nICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJJbnRlcnJ1\ncHRlZCB3YWl0aW5nIHRvIHJlYWQgcmFuZ2UiLCBpZSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY3Vyc29yID09IG51bGwpIHsK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkZh\naWxlZCB0byBvcGVuIGxlZGdlciByYW5nZSBjdXJzb3IsIGNoZWNrIGxvZ3Mi\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBj\ndXJzb3IuaGFzTW9yZUVudHJpZXMoKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyBMZWRnZXJSYW5n\nZSBuZXh0KCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgU29ydGVkU2V0PExvbmc+IGxl\nZGdlcklkcyA9IG5ldyBUcmVlU2V0PExvbmc+KCk7CiAgICAgICAgICAgICAg\nICAgICAgSXRlcmF0b3I8TWV0YXN0b3JlVGFibGVJdGVtPiBpdGVyID0gY3Vy\nc29yLnJlYWRFbnRyaWVzKG1heEVudHJpZXNQZXJTY2FuKTsKICAgICAgICAg\nICAgICAgICAgICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgbGVkZ2VySWRzLmFkZChrZXkyTGVkZ2VySWQoaXRl\nci5uZXh0KCkuZ2V0S2V5KCkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMZWRnZXJSYW5nZShsZWRn\nZXJJZHMpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoTVNFeGNlcHRpb24g\nbXNlKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRp\nb24gb2NjdXJyZWQgcmVhZGluZyBmcm9tIG1ldGFzdG9yZSIsIG1zZSk7CiAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJDb3Vs\nZG4ndCByZWFkIGZyb20gbWV0YXN0b3JlIiwgbXNlKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIExlZGdlclJhbmdlSXRlcmF0b3IgZ2V0TGVk\nZ2VyUmFuZ2VzKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IE1TTGVkZ2Vy\nUmFuZ2VJdGVyYXRvcigpOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyBMZWRnZXJNYW5hZ2VyIG5ld0xlZGdlck1hbmFnZXIo\nKSB7CiAgICAgICAgcmV0dXJuIG5ldyBNc0xlZGdlck1hbmFnZXIoY29uZiwg\nemssIG1ldGFzdG9yZSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIgbmV3TGVkZ2VyVW5k\nZXJyZXBsaWNhdGlvbk1hbmFnZXIoKSB0aHJvd3MgS2VlcGVyRXhjZXB0aW9u\nLAogICAgICAgICAgICBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgUmVwbGljYXRp\nb25FeGNlcHRpb24uQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbiB7CiAgICAgICAg\nLy8gVE9ETzogY3VycmVudGx5IGp1c3QgdXNlIHprIGxlZGdlciB1bmRlcnJl\ncGxpY2F0aW9uIG1hbmFnZXIKICAgICAgICByZXR1cm4gbmV3IFprTGVkZ2Vy\nVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIoY29uZiwgemspOwogICAgfQoKICAg\nIC8qKgogICAgICogUHJvY2VzcyBzZXQgb25lIGJ5IG9uZSBpbiBhc3luY2hy\nb25pemUgd2F5LiBQcm9jZXNzIHdpbGwgYmUgc3RvcHBlZAogICAgICogaW1t\nZWRpYXRlbHkgd2hlbiBlcnJvciBvY2N1cnJlZC4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgY2xhc3MgQXN5bmNTZXRQcm9jZXNzb3I8VD4gewogICAg\nICAgIC8vIHVzZSB0aGlzIHRvIHByZXZlbnQgbG9uZyBzdGFjayBjaGFpbnMg\nZnJvbSBidWlsZGluZyB1cCBpbiBjYWxsYmFja3MKICAgICAgICBTY2hlZHVs\nZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1bGVyOwoKICAgICAgICAvKioKICAg\nICAgICAgKiBDb25zdHJ1Y3RvcgogICAgICAgICAqCiAgICAgICAgICogQHBh\ncmFtIHNjaGVkdWxlcgogICAgICAgICAqICAgICAgICAgICAgRXhlY3V0b3Ig\ndXNlZCB0byBwcmV2ZW50IGxvbmcgc3RhY2sgY2hhaW5zCiAgICAgICAgICov\nCiAgICAgICAgcHVibGljIEFzeW5jU2V0UHJvY2Vzc29yKFNjaGVkdWxlZEV4\nZWN1dG9yU2VydmljZSBzY2hlZHVsZXIpIHsKICAgICAgICAgICAgdGhpcy5z\nY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBQcm9jZXNzIHNldCBvZiBpdGVtcwogICAgICAgICAqCiAg\nICAgICAgICogQHBhcmFtIGRhdGEKICAgICAgICAgKiAgICAgICAgICAgIFNl\ndCBvZiBkYXRhIHRvIHByb2Nlc3MKICAgICAgICAgKiBAcGFyYW0gcHJvY2Vz\nc29yCiAgICAgICAgICogICAgICAgICAgICBDYWxsYmFjayB0byBwcm9jZXNz\nIGVsZW1lbnQgb2YgbGlzdCB3aGVuIHN1Y2Nlc3MKICAgICAgICAgKiBAcGFy\nYW0gZmluYWxDYgogICAgICAgICAqICAgICAgICAgICAgRmluYWwgY2FsbGJh\nY2sgdG8gYmUgY2FsbGVkIGFmdGVyIGFsbCBlbGVtZW50cyBpbiB0aGUgbGlz\ndAogICAgICAgICAqICAgICAgICAgICAgYXJlIHByb2Nlc3NlZAogICAgICAg\nICAqIEBwYXJhbSBjb250eHQKICAgICAgICAgKiAgICAgICAgICAgIENvbnRl\neHQgb2YgZmluYWwgY2FsbGJhY2sKICAgICAgICAgKiBAcGFyYW0gc3VjY2Vz\nc1JjCiAgICAgICAgICogICAgICAgICAgICBSQyBwYXNzZWQgdG8gZmluYWwg\nY2FsbGJhY2sgb24gc3VjY2VzcwogICAgICAgICAqIEBwYXJhbSBmYWlsdXJl\nUmMKICAgICAgICAgKiAgICAgICAgICAgIFJDIHBhc3NlZCB0byBmaW5hbCBj\nYWxsYmFjayBvbiBmYWlsdXJlCiAgICAgICAgICovCiAgICAgICAgcHVibGlj\nIHZvaWQgcHJvY2VzcyhmaW5hbCBTZXQ8VD4gZGF0YSwgZmluYWwgUHJvY2Vz\nc29yPFQ+IHByb2Nlc3NvciwgZmluYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2Fs\nbGJhY2sgZmluYWxDYiwKICAgICAgICAgICAgICAgIGZpbmFsIE9iamVjdCBj\nb250ZXh0LCBmaW5hbCBpbnQgc3VjY2Vzc1JjLCBmaW5hbCBpbnQgZmFpbHVy\nZVJjKSB7CiAgICAgICAgICAgIGlmIChkYXRhID09IG51bGwgfHwgZGF0YS5z\naXplKCkgPT0gMCkgewogICAgICAgICAgICAgICAgZmluYWxDYi5wcm9jZXNz\nUmVzdWx0KHN1Y2Nlc3NSYywgbnVsbCwgY29udGV4dCk7CiAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZmluYWwg\nSXRlcmF0b3I8VD4gaXRlciA9IGRhdGEuaXRlcmF0b3IoKTsKICAgICAgICAg\nICAgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sgc3R1YkNhbGxiYWNrID0g\nbmV3IEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrKCkgewogICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBw\ncm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmMgIT0gc3VjY2Vzc1JjKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRlcm1pbmFsIGltbWVkaWF0\nZWx5CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jl\nc3VsdChmYWlsdXJlUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAgICAgICAg\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgIGlmICghaXRlci5oYXNOZXh0KCkpIHsgLy8gcmVh\nY2ggdGhlIGVuZCBvZiBsaXN0CiAgICAgICAgICAgICAgICAgICAgICAgIGZp\nbmFsQ2IucHJvY2Vzc1Jlc3VsdChzdWNjZXNzUmMsIG51bGwsIGNvbnRleHQp\nOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIHByb2Nlc3MgbmV4\ndCBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgZmluYWwgVCBkYXRhVG9Q\ncm9jZXNzID0gaXRlci5uZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgZmlu\nYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sgc3R1YiA9IHRoaXM7CiAg\nICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLnN1Ym1pdChuZXcgUnVubmFi\nbGUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICAgICAgICAgICAgICBwdWJsaWMgZmluYWwgdm9pZCBydW4oKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzb3IucHJvY2Vz\ncyhkYXRhVG9Qcm9jZXNzLCBzdHViKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9OwogICAgICAgICAgICBUIGZpcnN0RWxlbWVudCA9\nIGl0ZXIubmV4dCgpOwogICAgICAgICAgICBwcm9jZXNzb3IucHJvY2Vzcyhm\naXJzdEVsZW1lbnQsIHN0dWJDYWxsYmFjayk7CiAgICAgICAgfQogICAgfQoK\nfQo=\n","encoding":"base64"}

