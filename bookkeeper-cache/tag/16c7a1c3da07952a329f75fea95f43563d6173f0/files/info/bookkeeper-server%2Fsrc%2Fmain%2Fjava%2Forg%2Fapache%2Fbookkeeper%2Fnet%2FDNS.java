{"sha":"e6846e737e58237d75299f5bdc15a5fcd6a34a85","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTY4NDZlNzM3ZTU4MjM3ZDc1Mjk5ZjViZGMxNWE1ZmNkNmEzNGE4NQ==","size":13751,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e6846e737e58237d75299f5bdc15a5fcd6a34a85","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KLy8g\nVGhpcyBjb2RlIGhhcyBiZWVuIGNvcGllZCBmcm9tIGhhZG9vcC1jb21tb24g\nMi4wLjQtYWxwaGEKcGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubmV0\nOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBqYXZhLm5ldC5JbmV0QWRkcmVzczsK\naW1wb3J0IGphdmEubmV0Lk5ldHdvcmtJbnRlcmZhY2U7CmltcG9ydCBqYXZh\nLm5ldC5Tb2NrZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5Vbmtub3du\nSG9zdEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsK\naW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRIYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLlZlY3RvcjsKCmlt\ncG9ydCBqYXZheC5uYW1pbmcuTmFtaW5nRXhjZXB0aW9uOwppbXBvcnQgamF2\nYXgubmFtaW5nLmRpcmVjdG9yeS5BdHRyaWJ1dGVzOwppbXBvcnQgamF2YXgu\nbmFtaW5nLmRpcmVjdG9yeS5EaXJDb250ZXh0OwppbXBvcnQgamF2YXgubmFt\naW5nLmRpcmVjdG9yeS5Jbml0aWFsRGlyQ29udGV4dDsKCi8qKgogKgogKiBB\nIGNsYXNzIHRoYXQgcHJvdmlkZXMgZGlyZWN0IGFuZCByZXZlcnNlIGxvb2t1\ncCBmdW5jdGlvbmFsaXRpZXMsIGFsbG93aW5nCiAqIHRoZSBxdWVyeWluZyBv\nZiBzcGVjaWZpYyBuZXR3b3JrIGludGVyZmFjZXMgb3IgbmFtZXNlcnZlcnMu\nCiAqCiAqCiAqLwpwdWJsaWMgY2xhc3MgRE5TIHsKCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dn\nZXIoRE5TLmNsYXNzKTsKCiAgICAvKioKICAgICAqIFRoZSBjYWNoZWQgaG9z\ndG5hbWUgLWluaXRpYWxseSBudWxsLgogICAgICovCgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgU3RyaW5nIGNhY2hlZEhvc3RuYW1lID0gcmVzb2x2ZUxv\nY2FsSG9zdG5hbWUoKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmlu\nZyBjYWNoZWRIb3N0QWRkcmVzcyA9IHJlc29sdmVMb2NhbEhvc3RJUEFkZHJl\nc3MoKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBMT0NBTEhP\nU1QgPSAibG9jYWxob3N0IjsKCiAgICAvKioKICAgICAqIFJldHVybnMgdGhl\nIGhvc3RuYW1lIGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIElQIGFk\nZHJlc3MgYnkgdGhlCiAgICAgKiBwcm92aWRlZCBuYW1lc2VydmVyLgogICAg\nICoKICAgICAqIExvb3BiYWNrIGFkZHJlc3NlcwogICAgICogQHBhcmFtIGhv\nc3RJcCBUaGUgYWRkcmVzcyB0byByZXZlcnNlIGxvb2t1cAogICAgICogQHBh\ncmFtIG5zIFRoZSBob3N0IG5hbWUgb2YgYSByZWFjaGFibGUgRE5TIHNlcnZl\ncgogICAgICogQHJldHVybiBUaGUgaG9zdCBuYW1lIGFzc29jaWF0ZWQgd2l0\naCB0aGUgcHJvdmlkZWQgSVAKICAgICAqIEB0aHJvd3MgTmFtaW5nRXhjZXB0\naW9uIElmIGEgTmFtaW5nRXhjZXB0aW9uIGlzIGVuY291bnRlcmVkCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIHJldmVyc2VEbnMoSW5ldEFk\nZHJlc3MgaG9zdElwLCBTdHJpbmcgbnMpCiAgICAgICAgICAgIHRocm93cyBO\nYW1pbmdFeGNlcHRpb24gewogICAgICAgIC8vCiAgICAgICAgLy8gQnVpbGRz\nIHRoZSByZXZlcnNlIElQIGxvb2t1cCBmb3JtCiAgICAgICAgLy8gVGhpcyBp\ncyBmb3JtZWQgYnkgcmV2ZXJzaW5nIHRoZSBJUCBudW1iZXJzIGFuZCBhcHBl\nbmRpbmcgaW4tYWRkci5hcnBhCiAgICAgICAgLy8KICAgICAgICBTdHJpbmdb\nXSBwYXJ0cyA9IGhvc3RJcC5nZXRIb3N0QWRkcmVzcygpLnNwbGl0KCJcXC4i\nKTsKICAgICAgICBTdHJpbmcgcmV2ZXJzZUlQID0gcGFydHNbM10gKyAiLiIg\nKyBwYXJ0c1syXSArICIuIiArIHBhcnRzWzFdICsgIi4iCiAgICAgICAgICAg\nICsgcGFydHNbMF0gKyAiLmluLWFkZHIuYXJwYSI7CgogICAgICAgIERpckNv\nbnRleHQgaWN0eCA9IG5ldyBJbml0aWFsRGlyQ29udGV4dCgpOwogICAgICAg\nIEF0dHJpYnV0ZXMgYXR0cmlidXRlOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGF0dHJpYnV0ZSA9IGljdHguZ2V0QXR0cmlidXRlcygiZG5zOi8vIiAg\nICAgICAgICAgICAgIC8vIFVzZSAiZG5zOi8vLyIgaWYgdGhlIGRlZmF1bHQK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nKChucyA9PSBudWxsKSA/ICIiIDogbnMpICsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5hbWVzZXJ2ZXIgaXMgdG8g\nYmUgdXNlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIi8iICsgcmV2ZXJzZUlQLCBuZXcgU3RyaW5nW10geyAiUFRSIiB9\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpY3R4LmNsb3Nl\nKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYXR0cmlidXRlLmdldCgi\nUFRSIikuZ2V0KCkudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEByZXR1cm4gTmV0d29ya0ludGVyZmFjZSBmb3IgdGhlIGdpdmVuIHN1Ymlu\ndGVyZmFjZSBuYW1lIChlZyBldGgwOjApCiAgICAgKiAgICBvciBudWxsIGlm\nIG5vIGludGVyZmFjZSB3aXRoIHRoZSBnaXZlbiBuYW1lIGNhbiBiZSBmb3Vu\nZAogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBOZXR3b3JrSW50ZXJmYWNl\nIGdldFN1YmludGVyZmFjZShTdHJpbmcgc3RySW50ZXJmYWNlKQogICAgICAg\nICAgICB0aHJvd3MgU29ja2V0RXhjZXB0aW9uIHsKICAgICAgICBFbnVtZXJh\ndGlvbjxOZXR3b3JrSW50ZXJmYWNlPiBuaWZzID0KICAgICAgICAgICAgTmV0\nd29ya0ludGVyZmFjZS5nZXROZXR3b3JrSW50ZXJmYWNlcygpOwoKICAgICAg\nICB3aGlsZSAobmlmcy5oYXNNb3JlRWxlbWVudHMoKSkgewogICAgICAgICAg\nICBFbnVtZXJhdGlvbjxOZXR3b3JrSW50ZXJmYWNlPiBzdWJOaWZzID0KICAg\nICAgICAgICAgICAgIG5pZnMubmV4dEVsZW1lbnQoKS5nZXRTdWJJbnRlcmZh\nY2VzKCk7CgogICAgICAgICAgICB3aGlsZSAoc3ViTmlmcy5oYXNNb3JlRWxl\nbWVudHMoKSkgewogICAgICAgICAgICAgICAgTmV0d29ya0ludGVyZmFjZSBu\naWYgPSBzdWJOaWZzLm5leHRFbGVtZW50KCk7CiAgICAgICAgICAgICAgICBp\nZiAobmlmLmdldE5hbWUoKS5lcXVhbHMoc3RySW50ZXJmYWNlKSkgewogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBuaWY7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBAcGFyYW0gbmlmIG5ldHdvcmsgaW50\nZXJmYWNlIHRvIGdldCBhZGRyZXNzZXMgZm9yCiAgICAgKiBAcmV0dXJuIHNl\ndCBjb250YWluaW5nIGFkZHJlc3NlcyBmb3IgZWFjaCBzdWJpbnRlcmZhY2Ug\nb2YgbmlmLAogICAgICogICAgc2VlIGJlbG93IGZvciB0aGUgcmF0aW9uYWxl\nIGZvciB1c2luZyBhbiBvcmRlcmVkIHNldAogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBMaW5rZWRIYXNoU2V0PEluZXRBZGRyZXNzPiBnZXRTdWJpbnRl\ncmZhY2VJbmV0QWRkcnMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTmV0\nd29ya0ludGVyZmFjZSBuaWYpIHsKICAgICAgICBMaW5rZWRIYXNoU2V0PElu\nZXRBZGRyZXNzPiBhZGRycyA9IG5ldyBMaW5rZWRIYXNoU2V0PEluZXRBZGRy\nZXNzPigpOwogICAgICAgIEVudW1lcmF0aW9uPE5ldHdvcmtJbnRlcmZhY2U+\nIHN1Yk5pZnMgPSBuaWYuZ2V0U3ViSW50ZXJmYWNlcygpOwogICAgICAgIHdo\naWxlIChzdWJOaWZzLmhhc01vcmVFbGVtZW50cygpKSB7CiAgICAgICAgICAg\nIE5ldHdvcmtJbnRlcmZhY2Ugc3ViTmlmID0gc3ViTmlmcy5uZXh0RWxlbWVu\ndCgpOwogICAgICAgICAgICBhZGRycy5hZGRBbGwoQ29sbGVjdGlvbnMubGlz\ndChzdWJOaWYuZ2V0SW5ldEFkZHJlc3NlcygpKSk7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBhZGRyczsKICAgIH0KCiAgICAvKioKICAgICAqIExpa2Ug\ne0BsaW5rIEROUyNnZXRJUHMoU3RyaW5nLCBib29sZWFuKSwgYnV0IHJldHVy\nbnMgYWxsCiAgICAgKiBJUHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBp\nbnRlcmZhY2UgYW5kIGl0cyBzdWJpbnRlcmZhY2VzLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIFN0cmluZ1tdIGdldElQcyhTdHJpbmcgc3RySW50ZXJm\nYWNlKQogICAgICAgICAgICB0aHJvd3MgVW5rbm93bkhvc3RFeGNlcHRpb24g\newogICAgICAgIHJldHVybiBnZXRJUHMoc3RySW50ZXJmYWNlLCB0cnVlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYWxsIHRoZSBJUHMgYXNz\nb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBpbnRlcmZhY2UsIGlmIGFueSwg\naW4KICAgICAqIHRleHR1YWwgZm9ybS4KICAgICAqCiAgICAgKiBAcGFyYW0g\nc3RySW50ZXJmYWNlCiAgICAgKiAgICAgICAgICAgIFRoZSBuYW1lIG9mIHRo\nZSBuZXR3b3JrIGludGVyZmFjZSBvciBzdWItaW50ZXJmYWNlIHRvIHF1ZXJ5\nCiAgICAgKiAgICAgICAgICAgIChlZyBldGgwIG9yIGV0aDA6MCkgb3IgdGhl\nIHN0cmluZyAiZGVmYXVsdCIKICAgICAqIEBwYXJhbSByZXR1cm5TdWJpbnRl\ncmZhY2VzCiAgICAgKiAgICAgICAgICAgIFdoZXRoZXIgdG8gcmV0dXJuIElQ\ncyBhc3NvY2lhdGVkIHdpdGggc3ViaW50ZXJmYWNlcyBvZgogICAgICogICAg\nICAgICAgICB0aGUgZ2l2ZW4gaW50ZXJmYWNlCiAgICAgKiBAcmV0dXJuIEEg\nc3RyaW5nIHZlY3RvciBvZiBhbGwgdGhlIElQcyBhc3NvY2lhdGVkIHdpdGgg\ndGhlIHByb3ZpZGVkCiAgICAgKiAgICAgICAgIGludGVyZmFjZS4gVGhlIGxv\nY2FsIGhvc3QgSVAgaXMgcmV0dXJuZWQgaWYgdGhlIGludGVyZmFjZQogICAg\nICogICAgICAgICBuYW1lICJkZWZhdWx0IiBpcyBzcGVjaWZpZWQgb3IgdGhl\ncmUgaXMgYW4gSS9PIGVycm9yIGxvb2tpbmcKICAgICAqICAgICAgICAgZm9y\nIHRoZSBnaXZlbiBpbnRlcmZhY2UuCiAgICAgKiBAdGhyb3dzIFVua25vd25I\nb3N0RXhjZXB0aW9uCiAgICAgKiAgICAgICAgICAgICBJZiB0aGUgZ2l2ZW4g\naW50ZXJmYWNlIGlzIGludmFsaWQKICAgICAqCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgU3RyaW5nW10gZ2V0SVBzKFN0cmluZyBzdHJJbnRlcmZhY2Us\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuIHJl\ndHVyblN1YmludGVyZmFjZXMpIHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKCJkZWZhdWx0Ii5lcXVhbHMoc3RySW50ZXJmYWNl\nKSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdIHsgY2FjaGVk\nSG9zdEFkZHJlc3MgfTsKICAgICAgICB9CiAgICAgICAgTmV0d29ya0ludGVy\nZmFjZSBuZXRJZjsKICAgICAgICB0cnkgewogICAgICAgICAgICBuZXRJZiA9\nIE5ldHdvcmtJbnRlcmZhY2UuZ2V0QnlOYW1lKHN0ckludGVyZmFjZSk7CiAg\nICAgICAgICAgIGlmIChuZXRJZiA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBuZXRJZiA9IGdldFN1YmludGVyZmFjZShzdHJJbnRlcmZhY2UpOwogICAg\nICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoU29ja2V0RXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgTE9HLndhcm4oIkkvTyBlcnJvciBmaW5kaW5nIGlu\ndGVyZmFjZSAiICsgc3RySW50ZXJmYWNlICsKICAgICAgICAgICAgICAgICAg\nICAgIjogIiArIGUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgcmV0dXJu\nIG5ldyBTdHJpbmdbXSB7IGNhY2hlZEhvc3RBZGRyZXNzIH07CiAgICAgICAg\nfQogICAgICAgIGlmIChuZXRJZiA9PSBudWxsKSB7CiAgICAgICAgICAgIHRo\ncm93IG5ldyBVbmtub3duSG9zdEV4Y2VwdGlvbigiTm8gc3VjaCBpbnRlcmZh\nY2UgIiArIHN0ckludGVyZmFjZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBO\nQjogVXNpbmcgYSBMaW5rZWRIYXNoU2V0IHRvIHByZXNlcnZlIHRoZSBvcmRl\nciBmb3IgY2FsbGVycwogICAgICAgIC8vIHRoYXQgZGVwZW5kIG9uIGEgcGFy\ndGljdWxhciBlbGVtZW50IGJlaW5nIDFzdCBpbiB0aGUgYXJyYXkuCiAgICAg\nICAgLy8gRm9yIGV4YW1wbGUsIGdldERlZmF1bHRJUCBhbHdheXMgcmV0dXJu\ncyB0aGUgZmlyc3QgZWxlbWVudC4KICAgICAgICBMaW5rZWRIYXNoU2V0PElu\nZXRBZGRyZXNzPiBhbGxBZGRycyA9IG5ldyBMaW5rZWRIYXNoU2V0PEluZXRB\nZGRyZXNzPigpOwogICAgICAgIGFsbEFkZHJzLmFkZEFsbChDb2xsZWN0aW9u\ncy5saXN0KG5ldElmLmdldEluZXRBZGRyZXNzZXMoKSkpOwogICAgICAgIGlm\nICghcmV0dXJuU3ViaW50ZXJmYWNlcykgewogICAgICAgICAgICBhbGxBZGRy\ncy5yZW1vdmVBbGwoZ2V0U3ViaW50ZXJmYWNlSW5ldEFkZHJzKG5ldElmKSk7\nCiAgICAgICAgfQoKICAgICAgICBTdHJpbmcgaXBzW10gPSBuZXcgU3RyaW5n\nW2FsbEFkZHJzLnNpemUoKV07CiAgICAgICAgaW50IGkgPSAwOwogICAgICAg\nIGZvciAoSW5ldEFkZHJlc3MgYWRkciA6IGFsbEFkZHJzKSB7CiAgICAgICAg\nICAgIGlwc1tpKytdID0gYWRkci5nZXRIb3N0QWRkcmVzcygpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gaXBzOwogICAgfQoKCiAgICAvKioKICAgICAq\nIFJldHVybnMgdGhlIGZpcnN0IGF2YWlsYWJsZSBJUCBhZGRyZXNzIGFzc29j\naWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQKICAgICAqIG5ldHdvcmsgaW50ZXJm\nYWNlIG9yIHRoZSBsb2NhbCBob3N0IElQIGlmICJkZWZhdWx0IiBpcyBnaXZl\nbi4KICAgICAqCiAgICAgKiBAcGFyYW0gc3RySW50ZXJmYWNlCiAgICAgKiAg\nICAgICAgICAgIFRoZSBuYW1lIG9mIHRoZSBuZXR3b3JrIGludGVyZmFjZSBv\nciBzdWJpbnRlcmZhY2UgdG8gcXVlcnkKICAgICAqICAgICAgICAgICAgIChl\nLmcuIGV0aDAgb3IgZXRoMDowKSBvciB0aGUgc3RyaW5nICJkZWZhdWx0Igog\nICAgICogQHJldHVybiBUaGUgSVAgYWRkcmVzcyBpbiB0ZXh0IGZvcm0sIHRo\nZSBsb2NhbCBob3N0IElQIGlzIHJldHVybmVkCiAgICAgKiAgICAgICAgIGlm\nIHRoZSBpbnRlcmZhY2UgbmFtZSAiZGVmYXVsdCIgaXMgc3BlY2lmaWVkCiAg\nICAgKiBAdGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uCiAgICAgKiAgICAg\nICAgICAgICBJZiB0aGUgZ2l2ZW4gaW50ZXJmYWNlIGlzIGludmFsaWQKICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgZ2V0RGVmYXVsdElQKFN0\ncmluZyBzdHJJbnRlcmZhY2UpCiAgICAgICAgICAgIHRocm93cyBVbmtub3du\nSG9zdEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nW10gaXBzID0gZ2V0SVBz\nKHN0ckludGVyZmFjZSk7CiAgICAgICAgcmV0dXJuIGlwc1swXTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybnMgYWxsIHRoZSBob3N0IG5hbWVzIGFz\nc29jaWF0ZWQgYnkgdGhlIHByb3ZpZGVkIG5hbWVzZXJ2ZXIgd2l0aCB0aGUK\nICAgICAqIGFkZHJlc3MgYm91bmQgdG8gdGhlIHNwZWNpZmllZCBuZXR3b3Jr\nIGludGVyZmFjZQogICAgICoKICAgICAqIEBwYXJhbSBzdHJJbnRlcmZhY2UK\nICAgICAqICAgICAgICAgICAgVGhlIG5hbWUgb2YgdGhlIG5ldHdvcmsgaW50\nZXJmYWNlIG9yIHN1YmludGVyZmFjZSB0byBxdWVyeQogICAgICogICAgICAg\nICAgICAoZS5nLiBldGgwIG9yIGV0aDA6MCkKICAgICAqIEBwYXJhbSBuYW1l\nc2VydmVyCiAgICAgKiAgICAgICAgICAgIFRoZSBETlMgaG9zdCBuYW1lCiAg\nICAgKiBAcmV0dXJuIEEgc3RyaW5nIHZlY3RvciBvZiBhbGwgaG9zdCBuYW1l\ncyBhc3NvY2lhdGVkIHdpdGggdGhlIElQcyB0aWVkIHRvCiAgICAgKiAgICAg\nICAgIHRoZSBzcGVjaWZpZWQgaW50ZXJmYWNlCiAgICAgKiBAdGhyb3dzIFVu\na25vd25Ib3N0RXhjZXB0aW9uIGlmIHRoZSBnaXZlbiBpbnRlcmZhY2UgaXMg\naW52YWxpZAogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGdl\ndEhvc3RzKFN0cmluZyBzdHJJbnRlcmZhY2UsIFN0cmluZyBuYW1lc2VydmVy\nKQogICAgICAgICAgICB0aHJvd3MgVW5rbm93bkhvc3RFeGNlcHRpb24gewog\nICAgICAgIFN0cmluZ1tdIGlwcyA9IGdldElQcyhzdHJJbnRlcmZhY2UpOwog\nICAgICAgIFZlY3RvcjxTdHJpbmc+IGhvc3RzID0gbmV3IFZlY3RvcjxTdHJp\nbmc+KCk7CiAgICAgICAgZm9yIChpbnQgY3RyID0gMDsgY3RyIDwgaXBzLmxl\nbmd0aDsgY3RyKyspIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIGhvc3RzLmFkZChyZXZlcnNlRG5zKEluZXRBZGRyZXNzLmdldEJ5TmFt\nZShpcHNbY3RyXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBuYW1lc2VydmVyKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFVua25v\nd25Ib3N0RXhjZXB0aW9uIGlnbm9yZWQpIHsKICAgICAgICAgICAgfSBjYXRj\naCAoTmFtaW5nRXhjZXB0aW9uIGlnbm9yZWQpIHsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBpZiAoaG9zdHMuaXNFbXB0eSgpKSB7CiAgICAg\nICAgICAgIExPRy53YXJuKCJVbmFibGUgdG8gZGV0ZXJtaW5lIGhvc3RuYW1l\nIGZvciBpbnRlcmZhY2UgIiArIHN0ckludGVyZmFjZSk7CiAgICAgICAgICAg\nIHJldHVybiBuZXcgU3RyaW5nW10geyBjYWNoZWRIb3N0bmFtZSB9OwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBob3N0cy50b0FycmF5\nKG5ldyBTdHJpbmdbaG9zdHMuc2l6ZSgpXSk7CiAgICAgICAgfQogICAgfQoK\nCiAgICAvKioKICAgICAqIERldGVybWluZSB0aGUgbG9jYWwgaG9zdG5hbWU7\nIHJldHJpZXZpbmcgaXQgZnJvbSBjYWNoZSBpZiBpdCBpcyBrbm93bgogICAg\nICogSWYgd2UgY2Fubm90IGRldGVybWluZSBvdXIgaG9zdCBuYW1lLCByZXR1\ncm4gImxvY2FsaG9zdCIKICAgICAqIEByZXR1cm4gdGhlIGxvY2FsIGhvc3Ru\nYW1lIG9yICJsb2NhbGhvc3QiCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIFN0cmluZyByZXNvbHZlTG9jYWxIb3N0bmFtZSgpIHsKICAgICAgICBTdHJp\nbmcgbG9jYWxob3N0OwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxvY2Fs\naG9zdCA9IEluZXRBZGRyZXNzLmdldExvY2FsSG9zdCgpLmdldENhbm9uaWNh\nbEhvc3ROYW1lKCk7CiAgICAgICAgfSBjYXRjaCAoVW5rbm93bkhvc3RFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBMT0cud2FybigiVW5hYmxlIHRvIGRl\ndGVybWluZSBsb2NhbCBob3N0bmFtZSAiCiAgICAgICAgICAgICAgICAgICAg\nICsgIi1mYWxsaW5nIGJhY2sgdG8gXCIiICsgTE9DQUxIT1NUICsgIlwiIiwg\nZSk7CiAgICAgICAgICAgIGxvY2FsaG9zdCA9IExPQ0FMSE9TVDsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGxvY2FsaG9zdDsKICAgIH0KCgogICAgLyoq\nCiAgICAgKiBHZXQgdGhlIElQQWRkcmVzcyBvZiB0aGUgbG9jYWwgaG9zdCBh\ncyBhIHN0cmluZy4KICAgICAqIFRoaXMgd2lsbCBiZSBhIGxvb3AgYmFjayB2\nYWx1ZSBpZiB0aGUgbG9jYWwgaG9zdCBhZGRyZXNzIGNhbm5vdCBiZQogICAg\nICogZGV0ZXJtaW5lZC4KICAgICAqIElmIHRoZSBsb29wYmFjayBhZGRyZXNz\nIG9mICJsb2NhbGhvc3QiIGRvZXMgbm90IHJlc29sdmUsIHRoZW4gdGhlIHN5\nc3RlbSdzCiAgICAgKiBuZXR3b3JrIGlzIGluIHN1Y2ggYSBzdGF0ZSB0aGF0\nIG5vdGhpbmcgaXMgZ29pbmcgdG8gd29yay4gQSBtZXNzYWdlIGlzCiAgICAg\nKiBsb2dnZWQgYXQgdGhlIGVycm9yIGxldmVsIGFuZCBhIG51bGwgcG9pbnRl\nciByZXR1cm5lZCwgYSBwb2ludGVyCiAgICAgKiB3aGljaCB3aWxsIHRyaWdn\nZXIgZmFpbHVyZXMgbGF0ZXIgb24gdGhlIGFwcGxpY2F0aW9uCiAgICAgKiBA\ncmV0dXJuIHRoZSBJUEFkZHJlc3Mgb2YgdGhlIGxvY2FsIGhvc3Qgb3IgbnVs\nbCBmb3IgYSBzZXJpb3VzIHByb2JsZW0uCiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIFN0cmluZyByZXNvbHZlTG9jYWxIb3N0SVBBZGRyZXNzKCkgewog\nICAgICAgIFN0cmluZyBhZGRyZXNzOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGFkZHJlc3MgPSBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3QoKS5nZXRI\nb3N0QWRkcmVzcygpOwogICAgICAgIH0gY2F0Y2ggKFVua25vd25Ib3N0RXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLndhcm4oIlVuYWJsZSB0byBk\nZXRlcm1pbmUgYWRkcmVzcyBvZiB0aGUgaG9zdCIKICAgICAgICAgICAgICAg\nICAgICAgKyAiLWZhbGxpbmcgYmFjayB0byBcIiIgKyBMT0NBTEhPU1QgKyAi\nXCIgYWRkcmVzcyIsIGUpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgYWRkcmVzcyA9IEluZXRBZGRyZXNzLmdldEJ5TmFtZShMT0NBTEhP\nU1QpLmdldEhvc3RBZGRyZXNzKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFVu\na25vd25Ib3N0RXhjZXB0aW9uIG5vTG9jYWxIb3N0QWRkcmVzc0V4Y2VwdGlv\nbikgewogICAgICAgICAgICAgICAgLy9hdCB0aGlzIHBvaW50LCBkZWVwIHRy\nb3VibGUKICAgICAgICAgICAgICAgIExPRy5lcnJvcigiVW5hYmxlIHRvIGRl\ndGVybWluZSBsb2NhbCBsb29wYmFjayBhZGRyZXNzICIKICAgICAgICAgICAg\nICAgICAgICAgICAgICArICJvZiBcIiIgKyBMT0NBTEhPU1QgKyAiXCIgIiAr\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi10aGlzIHN5c3RlbSdzIG5l\ndHdvcmsgY29uZmlndXJhdGlvbiBpcyB1bnN1cHBvcnRlZCIsIGUpOwogICAg\nICAgICAgICAgICAgYWRkcmVzcyA9IG51bGw7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGFkZHJlc3M7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgaG9zdCBuYW1lcyBhc3NvY2lhdGVk\nIGJ5IHRoZSBkZWZhdWx0IG5hbWVzZXJ2ZXIgd2l0aCB0aGUKICAgICAqIGFk\nZHJlc3MgYm91bmQgdG8gdGhlIHNwZWNpZmllZCBuZXR3b3JrIGludGVyZmFj\nZQogICAgICoKICAgICAqIEBwYXJhbSBzdHJJbnRlcmZhY2UKICAgICAqICAg\nICAgICAgICAgVGhlIG5hbWUgb2YgdGhlIG5ldHdvcmsgaW50ZXJmYWNlIHRv\nIHF1ZXJ5IChlLmcuIGV0aDApCiAgICAgKiBAcmV0dXJuIFRoZSBsaXN0IG9m\nIGhvc3QgbmFtZXMgYXNzb2NpYXRlZCB3aXRoIElQcyBib3VuZCB0byB0aGUg\nbmV0d29yawogICAgICogICAgICAgICBpbnRlcmZhY2UKICAgICAqIEB0aHJv\nd3MgVW5rbm93bkhvc3RFeGNlcHRpb24KICAgICAqICAgICAgICAgICAgIElm\nIG9uZSBpcyBlbmNvdW50ZXJlZCB3aGlsZSBxdWVyeWluZyB0aGUgZGVmYXVs\ndCBpbnRlcmZhY2UKICAgICAqCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nU3RyaW5nW10gZ2V0SG9zdHMoU3RyaW5nIHN0ckludGVyZmFjZSkKICAgICAg\nICAgICAgdGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gZ2V0SG9zdHMoc3RySW50ZXJmYWNlLCBudWxsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybnMgdGhlIGRlZmF1bHQgKGZpcnN0KSBob3N0\nIG5hbWUgYXNzb2NpYXRlZCBieSB0aGUgcHJvdmlkZWQKICAgICAqIG5hbWVz\nZXJ2ZXIgd2l0aCB0aGUgYWRkcmVzcyBib3VuZCB0byB0aGUgc3BlY2lmaWVk\nIG5ldHdvcmsgaW50ZXJmYWNlCiAgICAgKgogICAgICogQHBhcmFtIHN0cklu\ndGVyZmFjZQogICAgICogICAgICAgICAgICBUaGUgbmFtZSBvZiB0aGUgbmV0\nd29yayBpbnRlcmZhY2UgdG8gcXVlcnkgKGUuZy4gZXRoMCkKICAgICAqIEBw\nYXJhbSBuYW1lc2VydmVyCiAgICAgKiAgICAgICAgICAgIFRoZSBETlMgaG9z\ndCBuYW1lCiAgICAgKiBAcmV0dXJuIFRoZSBkZWZhdWx0IGhvc3QgbmFtZXMg\nYXNzb2NpYXRlZCB3aXRoIElQcyBib3VuZCB0byB0aGUgbmV0d29yawogICAg\nICogICAgICAgICBpbnRlcmZhY2UKICAgICAqIEB0aHJvd3MgVW5rbm93bkhv\nc3RFeGNlcHRpb24KICAgICAqICAgICAgICAgICAgIElmIG9uZSBpcyBlbmNv\ndW50ZXJlZCB3aGlsZSBxdWVyeWluZyB0aGUgZGVmYXVsdCBpbnRlcmZhY2UK\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgZ2V0RGVmYXVsdEhv\nc3QoU3RyaW5nIHN0ckludGVyZmFjZSwgU3RyaW5nIG5hbWVzZXJ2ZXIpCiAg\nICAgICAgICAgIHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKCJkZWZhdWx0Ii5lcXVhbHMoc3RySW50ZXJmYWNlKSkgewogICAg\nICAgICAgICByZXR1cm4gY2FjaGVkSG9zdG5hbWU7CiAgICAgICAgfQoKICAg\nICAgICBpZiAoImRlZmF1bHQiLmVxdWFscyhuYW1lc2VydmVyKSkgewogICAg\nICAgICAgICByZXR1cm4gZ2V0RGVmYXVsdEhvc3Qoc3RySW50ZXJmYWNlKTsK\nICAgICAgICB9CgogICAgICAgIFN0cmluZ1tdIGhvc3RzID0gZ2V0SG9zdHMo\nc3RySW50ZXJmYWNlLCBuYW1lc2VydmVyKTsKICAgICAgICByZXR1cm4gaG9z\ndHNbMF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBkZWZh\ndWx0IChmaXJzdCkgaG9zdCBuYW1lIGFzc29jaWF0ZWQgYnkgdGhlIGRlZmF1\nbHQKICAgICAqIG5hbWVzZXJ2ZXIgd2l0aCB0aGUgYWRkcmVzcyBib3VuZCB0\nbyB0aGUgc3BlY2lmaWVkIG5ldHdvcmsgaW50ZXJmYWNlCiAgICAgKgogICAg\nICogQHBhcmFtIHN0ckludGVyZmFjZQogICAgICogICAgICAgICAgICBUaGUg\nbmFtZSBvZiB0aGUgbmV0d29yayBpbnRlcmZhY2UgdG8gcXVlcnkgKGUuZy4g\nZXRoMCkuCiAgICAgKiAgICAgICAgICAgIE11c3Qgbm90IGJlIG51bGwuCiAg\nICAgKiBAcmV0dXJuIFRoZSBkZWZhdWx0IGhvc3QgbmFtZSBhc3NvY2lhdGVk\nIHdpdGggSVBzIGJvdW5kIHRvIHRoZSBuZXR3b3JrCiAgICAgKiAgICAgICAg\nIGludGVyZmFjZQogICAgICogQHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlv\nbgogICAgICogICAgICAgICAgICAgSWYgb25lIGlzIGVuY291bnRlcmVkIHdo\naWxlIHF1ZXJ5aW5nIHRoZSBkZWZhdWx0IGludGVyZmFjZQogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIFN0cmluZyBnZXREZWZhdWx0SG9zdChTdHJpbmcg\nc3RySW50ZXJmYWNlKQogICAgICAgICAgICB0aHJvd3MgVW5rbm93bkhvc3RF\neGNlcHRpb24gewogICAgICAgIHJldHVybiBnZXREZWZhdWx0SG9zdChzdHJJ\nbnRlcmZhY2UsIG51bGwpOwogICAgfQoKfQo=\n","encoding":"base64"}

