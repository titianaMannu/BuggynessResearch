{"sha":"86c0d894ee67e4b61f0cf0247c0bcdaababf4417","node_id":"MDQ6QmxvYjE1NzU5NTY6ODZjMGQ4OTRlZTY3ZTRiNjFmMGNmMDI0N2MwYmNkYWFiYWJmNDQxNw==","size":22397,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/86c0d894ee67e4b61f0cf0247c0bcdaababf4417","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5UaW1lVW5pdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4\nZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlNjaGVkdWxl\nZEV4ZWN1dG9yU2VydmljZTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50\nLlRocmVhZEZhY3Rvcnk7CgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFk\nZHJlc3M7CgppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3du\nTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRv\nbWljSW50ZWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29u\nZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyQWRtaW47CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckNoZWNr\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nckZyYWdtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVu\ndC5Cb29raWVzTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIudXRpbC5TdHJpbmdVdGlsczsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIudXRpbC5aa1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnpvb2tlZXBlci5ab29LZWVwZXJXYXRjaGVyQmFzZTsKCmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyTWFu\nYWdlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0\nYS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLm1ldGEuTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFs\nQ2FsbGJhY2tzLkdlbmVyaWNDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3Mu\nUHJvY2Vzc29yOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBs\naWNhdGlvbi5SZXBsaWNhdGlvbkV4Y2VwdGlvbi5CS0F1ZGl0RXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnJlcGxpY2F0aW9uLlJl\ncGxpY2F0aW9uRXhjZXB0aW9uLkNvbXBhdGliaWxpdHlFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb24uUmVwbGlj\nYXRpb25FeGNlcHRpb24uVW5hdmFpbGFibGVFeGNlcHRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuQ29sbGVjdGlvblV0aWxz\nOwppbXBvcnQgY29tLmdvb2dsZS5jb21tb24uY29sbGVjdC5TZXRzOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlZEV2ZW50OwppbXBvcnQg\nb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBvcnQgb3JnLmFw\nYWNoZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjazsKaW1wb3J0IG9yZy5zbGY0\nai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCi8q\nKgogKiBBdWRpdG9yIGlzIGEgc2luZ2xlIGVudGl0eSBpbiB0aGUgZW50aXJl\nIEJvb2tpZSBjbHVzdGVyIGFuZCB3aWxsIGJlIHdhdGNoaW5nCiAqIGFsbCB0\naGUgYm9va2llcyB1bmRlciAnbGVkZ2Vycm9vdHBhdGgvYXZhaWxhYmxlJyB6\na3BhdGguIFdoZW4gYW55IG9mIHRoZQogKiBib29raWUgZmFpbGVkIG9yIGRp\nc2Nvbm5lY3RlZCBmcm9tIHprLCBoZSB3aWxsIHN0YXJ0IGluaXRpYXRpbmcg\ndGhlCiAqIHJlLXJlcGxpY2F0aW9uIGFjdGl2aXRpZXMgYnkga2VlcGluZyBh\nbGwgdGhlIGNvcnJlc3BvbmRpbmcgbGVkZ2VycyBvZiB0aGUKICogZmFpbGVk\nIGJvb2tpZSBhcyB1bmRlcnJlcGxpY2F0ZWQgem5vZGUgaW4gemsuCiAqLwpw\ndWJsaWMgY2xhc3MgQXVkaXRvciBpbXBsZW1lbnRzIEJvb2tpZXNMaXN0ZW5l\nciB7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9n\nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoQXVkaXRvci5jbGFzcyk7CiAgICBwcml2\nYXRlIGZpbmFsIFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZjsKICAgIHByaXZh\ndGUgQm9va0tlZXBlciBia2M7CiAgICBwcml2YXRlIEJvb2tLZWVwZXJBZG1p\nbiBhZG1pbjsKICAgIHByaXZhdGUgQm9va2llTGVkZ2VySW5kZXhlciBib29r\naWVMZWRnZXJJbmRleGVyOwogICAgcHJpdmF0ZSBMZWRnZXJNYW5hZ2VyIGxl\nZGdlck1hbmFnZXI7CiAgICBwcml2YXRlIExlZGdlclVuZGVycmVwbGljYXRp\nb25NYW5hZ2VyIGxlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyOwogICAg\ncHJpdmF0ZSBmaW5hbCBTY2hlZHVsZWRFeGVjdXRvclNlcnZpY2UgZXhlY3V0\nb3I7CiAgICBwcml2YXRlIExpc3Q8U3RyaW5nPiBrbm93bkJvb2tpZXMgPSBu\nZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKCiAgICBwdWJsaWMgQXVkaXRvcihm\naW5hbCBTdHJpbmcgYm9va2llSWRlbnRpZmllciwgU2VydmVyQ29uZmlndXJh\ndGlvbiBjb25mLAogICAgICAgICAgICAgICAgICAgWm9vS2VlcGVyIHprYykg\ndGhyb3dzIFVuYXZhaWxhYmxlRXhjZXB0aW9uIHsKICAgICAgICB0aGlzLmNv\nbmYgPSBjb25mOwogICAgICAgIGluaXRpYWxpemUoY29uZiwgemtjKTsKCiAg\nICAgICAgZXhlY3V0b3IgPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhyZWFkU2No\nZWR1bGVkRXhlY3V0b3IobmV3IFRocmVhZEZhY3RvcnkoKSB7CiAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyBUaHJl\nYWQgbmV3VGhyZWFkKFJ1bm5hYmxlIHIpIHsKICAgICAgICAgICAgICAgICAg\nICBUaHJlYWQgdCA9IG5ldyBUaHJlYWQociwgIkF1ZGl0b3JCb29raWUtIiAr\nIGJvb2tpZUlkZW50aWZpZXIpOwogICAgICAgICAgICAgICAgICAgIHQuc2V0\nRGFlbW9uKHRydWUpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0Owog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgaW5pdGlhbGl6ZShTZXJ2ZXJDb25maWd1cmF0aW9uIGNv\nbmYsIFpvb0tlZXBlciB6a2MpCiAgICAgICAgICAgIHRocm93cyBVbmF2YWls\nYWJsZUV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGVk\nZ2VyTWFuYWdlckZhY3RvcnkgbGVkZ2VyTWFuYWdlckZhY3RvcnkgPSBMZWRn\nZXJNYW5hZ2VyRmFjdG9yeQogICAgICAgICAgICAgICAgICAgIC5uZXdMZWRn\nZXJNYW5hZ2VyRmFjdG9yeShjb25mLCB6a2MpOwogICAgICAgICAgICBsZWRn\nZXJNYW5hZ2VyID0gbGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFu\nYWdlcigpOwogICAgICAgICAgICB0aGlzLmJvb2tpZUxlZGdlckluZGV4ZXIg\nPSBuZXcgQm9va2llTGVkZ2VySW5kZXhlcihsZWRnZXJNYW5hZ2VyKTsKCiAg\nICAgICAgICAgIHRoaXMubGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIg\nPSBsZWRnZXJNYW5hZ2VyRmFjdG9yeQogICAgICAgICAgICAgICAgICAgIC5u\nZXdMZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlcigpOwoKICAgICAgICAg\nICAgdGhpcy5ia2MgPSBuZXcgQm9va0tlZXBlcihuZXcgQ2xpZW50Q29uZmln\ndXJhdGlvbihjb25mKSwgemtjKTsKICAgICAgICAgICAgdGhpcy5hZG1pbiA9\nIG5ldyBCb29rS2VlcGVyQWRtaW4oYmtjKTsKCiAgICAgICAgfSBjYXRjaCAo\nQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbiBjZSkgewogICAgICAgICAgICB0aHJv\ndyBuZXcgVW5hdmFpbGFibGVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAg\nICAgIkNvbXBhdGliaWxpdHlFeGNlcHRpb24gd2hpbGUgaW5pdGlhbGl6aW5n\nIEF1ZGl0b3IiLCBjZSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVbmF2YWlsYWJsZUV4Y2Vw\ndGlvbigKICAgICAgICAgICAgICAgICAgICAiSU9FeGNlcHRpb24gd2hpbGUg\naW5pdGlhbGl6aW5nIEF1ZGl0b3IiLCBpb2UpOwogICAgICAgIH0gY2F0Y2gg\nKEtlZXBlckV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nVW5hdmFpbGFibGVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgIktl\nZXBlckV4Y2VwdGlvbiB3aGlsZSBpbml0aWFsaXppbmcgQXVkaXRvciIsIGtl\nKTsKICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgVW5hdmFpbGFibGVFeGNlcHRpb24o\nCiAgICAgICAgICAgICAgICAgICAgIkludGVycnVwdGVkIHdoaWxlIGluaXRp\nYWxpemluZyBBdWRpdG9yIiwgaWUpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgc3VibWl0U2h1dGRvd25UYXNrKCkgewogICAgICAgIHN5\nbmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICBpZiAoZXhlY3V0b3Iu\naXNTaHV0ZG93bigpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgZXhlY3V0b3Iuc3VibWl0KG5ldyBSdW5u\nYWJsZSgpIHsKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAoQXVk\naXRvci50aGlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGVj\ndXRvci5zaHV0ZG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHByaXZhdGUgc3luY2hyb25pemVkIHZvaWQgc3Vi\nbWl0QXVkaXRUYXNrKCkgewogICAgICAgIHN5bmNocm9uaXplZCAodGhpcykg\newogICAgICAgICAgICBpZiAoZXhlY3V0b3IuaXNTaHV0ZG93bigpKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgZXhlY3V0b3Iuc3VibWl0KG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAg\nICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3\nYWl0SWZMZWRnZXJSZXBsaWNhdGlvbkRpc2FibGVkKCk7CgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGF2YWlsYWJsZUJvb2tp\nZXMgPSBnZXRBdmFpbGFibGVCb29raWVzKCk7CgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgLy8gY2FzdGluZyB0byBTdHJpbmcsIGFzIGtub3duQm9v\na2llcyBhbmQgYXZhaWxhYmxlQm9va2llcwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gY29udGFpbnMgb25seSBTdHJpbmcgdmFsdWVzCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAvLyBmaW5kIG5ldyBib29raWVzKGlm\nIGFueSkgYW5kIHVwZGF0ZSB0aGUga25vd24gYm9va2llIGxpc3QKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIENvbGxlY3Rpb248U3RyaW5nPiBuZXdC\nb29raWVzID0gQ29sbGVjdGlvblV0aWxzLnN1YnRyYWN0KAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVCb29raWVzLCBr\nbm93bkJvb2tpZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAga25v\nd25Cb29raWVzLmFkZEFsbChuZXdCb29raWVzKTsKCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAvLyBmaW5kIGxvc3QgYm9va2llcyhpZiBhbnkpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBDb2xsZWN0aW9uPFN0cmluZz4g\nbG9zdEJvb2tpZXMgPSBDb2xsZWN0aW9uVXRpbHMuc3VidHJhY3QoCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtub3duQm9va2llcywg\nYXZhaWxhYmxlQm9va2llcyk7CgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgaWYgKGxvc3RCb29raWVzLnNpemUoKSA+IDApIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBrbm93bkJvb2tpZXMucmVtb3ZlQWxsKGxv\nc3RCb29raWVzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBN\nYXA8U3RyaW5nLCBTZXQ8TG9uZz4+IGxlZGdlckRldGFpbHMgPSBnZW5lcmF0\nZUJvb2tpZTJMZWRnZXJzSW5kZXgoKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBoYW5kbGVMb3N0Qm9va2llcyhsb3N0Qm9va2llcywgbGVk\nZ2VyRGV0YWlscyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0aW9uIGJr\nZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJF\neGNlcHRpb24gZ2V0dGluZyBib29raWUgbGlzdCIsIGJrZSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9u\nIGllKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1cHRlZCB3aGlsZSB3YXRjaGlu\nZyBhdmFpbGFibGUgYm9va2llcyAiLCBpZSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEJLQXVkaXRFeGNlcHRpb24gYmtlKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3\naGlsZSB3YXRjaGluZyBhdmFpbGFibGUgYm9va2llcyIsIGJrZSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFVuYXZhaWxhYmxlRXhjZXB0\naW9uIHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJy\nb3IoIkV4Y2VwdGlvbiB3aGlsZSB3YXRjaGluZyBhdmFpbGFibGUgYm9va2ll\ncyIsIHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydCgpIHsKICAgICAgICBMT0cuaW5m\nbygiSSdtIHN0YXJ0aW5nIGFzIEF1ZGl0b3IgQm9va2llIik7CiAgICAgICAg\nLy8gb24gc3RhcnR1cCB3YXRjaGluZyBhdmFpbGFibGUgYm9va2llIGFuZCBi\nYXNlZCBvbiB0aGUKICAgICAgICAvLyBhdmFpbGFibGUgYm9va2llcyBkZXRl\ncm1pbmluZyB0aGUgYm9va2llIGZhaWx1cmVzLgogICAgICAgIHN5bmNocm9u\naXplZCAodGhpcykgewogICAgICAgICAgICBpZiAoZXhlY3V0b3IuaXNTaHV0\nZG93bigpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIGxvbmcgaW50ZXJ2YWwgPSBjb25mLmdldEF1ZGl0\nb3JQZXJpb2RpY0NoZWNrSW50ZXJ2YWwoKTsKICAgICAgICAgICAgaWYgKGlu\ndGVydmFsID4gMCkgewogICAgICAgICAgICAgICAgTE9HLmluZm8oIlBlcmlv\nZGljIGNoZWNraW5nIGVuYWJsZWQiKTsKICAgICAgICAgICAgICAgIGV4ZWN1\ndG9yLnNjaGVkdWxlQXRGaXhlZFJhdGUobmV3IFJ1bm5hYmxlKCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiUnVubmluZyBwZXJp\nb2RpYyBjaGVjayIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsZWRn\nZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlci5pc0xlZGdlclJlcGxpY2F0aW9u\nRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIExPRy5pbmZvKCJMZWRnZXIgcmVwbGljYXRpb24gZGlzYWJsZWQsIHNr\naXBwaW5nIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrQWxsTGVkZ2Vy\ncygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoS2Vl\ncGVyRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24gd2hpbGUgcnVubmluZyBwZXJp\nb2RpYyBjaGVjayIsIGtlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQo\nKS5pbnRlcnJ1cHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIkludGVycnVwdGVkIHdoaWxlIHJ1bm5pbmcgcGVyaW9k\naWMgY2hlY2siLCBpZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9\nIGNhdGNoIChCS0F1ZGl0RXhjZXB0aW9uIGJrYWUpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGls\nZSBydW5uaW5nIHBlcmlvZGljIGNoZWNrIiwgYmthZSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbiBia2UpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkV4\nY2VwdGlvbiBydW5uaW5nIHBlcmlvZGljIGNoZWNrIiwgYmtlKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlv\nZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiSS9PIGV4Y2VwdGlvbiBydW5uaW5nIHBlcmlvZGljIGNoZWNrIiwgaW9l\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFJlcGxp\nY2F0aW9uRXhjZXB0aW9uLlVuYXZhaWxhYmxlRXhjZXB0aW9uIHVlKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJVbmRl\ncnJlcGxpY2F0aW9uIG1hbmFnZXIgdW5hdmFpbGFibGUgIgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArInJ1bm5pbmcgcGVy\naW9kaWMgY2hlY2siLCB1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICB9LCBpbnRlcnZhbCwgaW50ZXJ2YWwsIFRpbWVVbml0Lk1JTExJU0VD\nT05EUyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBM\nT0cuaW5mbygiUGVyaW9kaWMgY2hlY2tpbmcgZGlzYWJsZWQiKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgZXhlY3V0b3Iuc3VibWl0KG5ldyBSdW5u\nYWJsZSgpIHsKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBrbm93bkJvb2tpZXMgPSBnZXRBdmFpbGFibGVC\nb29raWVzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdWRpdGlu\nZ0Jvb2tpZXMoa25vd25Cb29raWVzKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgfSBjYXRjaCAoQktFeGNlcHRpb24gYmtlKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiBnZXR0aW5nIGJv\nb2tpZSBsaXN0IiwgYmtlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHN1Ym1pdFNodXRkb3duVGFzaygpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChLZWVwZXJFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0aW9uIHdoaWxlIHdh\ndGNoaW5nIGF2YWlsYWJsZSBib29raWVzIiwga2UpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgc3VibWl0U2h1dGRvd25UYXNrKCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9u\nIGllKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1cHRlZCB3aGlsZSB3YXRjaGlu\nZyBhdmFpbGFibGUgYm9va2llcyAiLCBpZSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBzdWJtaXRTaHV0ZG93blRhc2soKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoQktBdWRpdEV4Y2VwdGlvbiBia2UpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0\naW9uIHdoaWxlIHdhdGNoaW5nIGF2YWlsYWJsZSBib29raWVzIiwgYmtlKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdFNodXRkb3duVGFz\naygpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHByaXZhdGUgdm9pZCB3YWl0SWZMZWRnZXJSZXBsaWNhdGlvbkRpc2Fi\nbGVkKCkgdGhyb3dzIFVuYXZhaWxhYmxlRXhjZXB0aW9uLAogICAgICAgICAg\nICBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgUmVwbGljYXRpb25F\nbmFibGVDYiBjYiA9IG5ldyBSZXBsaWNhdGlvbkVuYWJsZUNiKCk7CiAgICAg\nICAgaWYgKCFsZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlci5pc0xlZGdl\nclJlcGxpY2F0aW9uRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGxlZGdlclVu\nZGVycmVwbGljYXRpb25NYW5hZ2VyLm5vdGlmeUxlZGdlclJlcGxpY2F0aW9u\nRW5hYmxlZChjYik7CiAgICAgICAgICAgIGNiLmF3YWl0KCk7CiAgICAgICAg\nfQogICAgfQoKICAgIHByaXZhdGUgTGlzdDxTdHJpbmc+IGdldEF2YWlsYWJs\nZUJvb2tpZXMoKSB0aHJvd3MgQktFeGNlcHRpb24gewogICAgICAgIC8vIEdl\ndCB0aGUgYXZhaWxhYmxlIGJvb2tpZXMsIGFsc28gd2F0Y2ggZm9yIGZ1cnRo\nZXIgY2hhbmdlcwogICAgICAgIC8vIFdhdGNoaW5nIG9uIG9ubHkgYXZhaWxh\nYmxlIGJvb2tpZXMgaXMgc3VmZmljaWVudCwgYXMgY2hhbmdlcyBpbiByZWFk\nb25seSBib29raWVzIGFsc28gY2hhbmdlcyBpbiBhdmFpbGFibGUKICAgICAg\nICAvLyBib29raWVzCiAgICAgICAgYWRtaW4ubm90aWZ5Qm9va2llc0NoYW5n\nZWQodGhpcyk7CiAgICAgICAgQ29sbGVjdGlvbjxJbmV0U29ja2V0QWRkcmVz\ncz4gYXZhaWxhYmxlQmtBZGRyZXNzZXMgPSBhZG1pbi5nZXRBdmFpbGFibGVC\nb29raWVzKCk7CiAgICAgICAgQ29sbGVjdGlvbjxJbmV0U29ja2V0QWRkcmVz\ncz4gcmVhZE9ubHlCa0FkZHJlc3NlcyA9IGFkbWluLmdldFJlYWRPbmx5Qm9v\na2llcygpOwogICAgICAgIGF2YWlsYWJsZUJrQWRkcmVzc2VzLmFkZEFsbChy\nZWFkT25seUJrQWRkcmVzc2VzKTsKCiAgICAgICAgTGlzdDxTdHJpbmc+IGF2\nYWlsYWJsZUJvb2tpZXMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKICAg\nICAgICBmb3IgKEluZXRTb2NrZXRBZGRyZXNzIGFkZHIgOiBhdmFpbGFibGVC\na0FkZHJlc3NlcykgewogICAgICAgICAgICBhdmFpbGFibGVCb29raWVzLmFk\nZChTdHJpbmdVdGlscy5hZGRyVG9TdHJpbmcoYWRkcikpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gYXZhaWxhYmxlQm9va2llczsKICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgYXVkaXRpbmdCb29raWVzKExpc3Q8U3RyaW5nPiBhdmFp\nbGFibGVCb29raWVzKQogICAgICAgICAgICB0aHJvd3MgQktBdWRpdEV4Y2Vw\ndGlvbiwgS2VlcGVyRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCgogICAgICAgIE1hcDxTdHJpbmcsIFNldDxMb25nPj4gbGVkZ2VyRGV0YWls\ncyA9IGdlbmVyYXRlQm9va2llMkxlZGdlcnNJbmRleCgpOwoKICAgICAgICAv\nLyBmaW5kIGxvc3QgYm9va2llcwogICAgICAgIFNldDxTdHJpbmc+IGtub3du\nQm9va2llcyA9IGxlZGdlckRldGFpbHMua2V5U2V0KCk7CiAgICAgICAgQ29s\nbGVjdGlvbjxTdHJpbmc+IGxvc3RCb29raWVzID0gQ29sbGVjdGlvblV0aWxz\nLnN1YnRyYWN0KGtub3duQm9va2llcywKICAgICAgICAgICAgICAgIGF2YWls\nYWJsZUJvb2tpZXMpOwoKICAgICAgICBpZiAobG9zdEJvb2tpZXMuc2l6ZSgp\nID4gMCkKICAgICAgICAgICAgaGFuZGxlTG9zdEJvb2tpZXMobG9zdEJvb2tp\nZXMsIGxlZGdlckRldGFpbHMpOwogICAgfQoKICAgIHByaXZhdGUgTWFwPFN0\ncmluZywgU2V0PExvbmc+PiBnZW5lcmF0ZUJvb2tpZTJMZWRnZXJzSW5kZXgo\nKQogICAgICAgICAgICB0aHJvd3MgQktBdWRpdEV4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIGJvb2tpZUxlZGdlckluZGV4ZXIuZ2V0Qm9va2llVG9MZWRn\nZXJJbmRleCgpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBoYW5kbGVMb3N0\nQm9va2llcyhDb2xsZWN0aW9uPFN0cmluZz4gbG9zdEJvb2tpZXMsCiAgICAg\nICAgICAgIE1hcDxTdHJpbmcsIFNldDxMb25nPj4gbGVkZ2VyRGV0YWlscykg\ndGhyb3dzIEJLQXVkaXRFeGNlcHRpb24gewogICAgICAgIExPRy5pbmZvKCJG\nb2xsb3dpbmcgYXJlIHRoZSBmYWlsZWQgYm9va2llczogIiArIGxvc3RCb29r\naWVzCiAgICAgICAgICAgICAgICArICIgYW5kIHNlYXJjaGluZyBpdHMgbGVk\nZ2VycyBmb3IgcmUtcmVwbGljYXRpb24iKTsKCiAgICAgICAgZm9yIChTdHJp\nbmcgYm9va2llSVAgOiBsb3N0Qm9va2llcykgewogICAgICAgICAgICAvLyBp\nZGVudGlmeSBhbGwgdGhlIGxlZGdlcnMgaW4gYm9va2llSVAgYW5kIHB1Ymxp\nc2hpbmcgdGhlc2UgbGVkZ2VycwogICAgICAgICAgICAvLyBhcyB1bmRlci1y\nZXBsaWNhdGVkLgogICAgICAgICAgICBwdWJsaXNoU3VzcGVjdGVkTGVkZ2Vy\ncyhib29raWVJUCwgbGVkZ2VyRGV0YWlscy5nZXQoYm9va2llSVApKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHB1Ymxpc2hTdXNwZWN0\nZWRMZWRnZXJzKFN0cmluZyBib29raWVJUCwgU2V0PExvbmc+IGxlZGdlcnMp\nCiAgICAgICAgICAgIHRocm93cyBCS0F1ZGl0RXhjZXB0aW9uIHsKICAgICAg\nICBpZiAobnVsbCA9PSBsZWRnZXJzIHx8IGxlZGdlcnMuc2l6ZSgpID09IDAp\nIHsKICAgICAgICAgICAgLy8gdGhlcmUgaXMgbm8gbGVkZ2VycyBhdmFpbGFi\nbGUgZm9yIHRoaXMgYm9va2llIGFuZCBqdXN0CiAgICAgICAgICAgIC8vIGln\nbm9yaW5nIHRoZSBib29raWUgZmFpbHVyZXMKICAgICAgICAgICAgTE9HLmlu\nZm8oIlRoZXJlIGlzIG5vIGxlZGdlcnMgZm9yIHRoZSBmYWlsZWQgYm9va2ll\nOiAiICsgYm9va2llSVApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nfQogICAgICAgIExPRy5pbmZvKCJGb2xsb3dpbmcgbGVkZ2VyczogIiArIGxl\nZGdlcnMgKyAiIG9mIGJvb2tpZTogIiArIGJvb2tpZUlQCiAgICAgICAgICAg\nICAgICArICIgYXJlIGlkZW50aWZpZWQgYXMgdW5kZXJyZXBsaWNhdGVkIik7\nCiAgICAgICAgZm9yIChMb25nIGxlZGdlcklkIDogbGVkZ2VycykgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGVkZ2VyVW5kZXJyZXBs\naWNhdGlvbk1hbmFnZXIubWFya0xlZGdlclVuZGVycmVwbGljYXRlZCgKICAg\nICAgICAgICAgICAgICAgICAgICAgbGVkZ2VySWQsIGJvb2tpZUlQKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoVW5hdmFpbGFibGVFeGNlcHRpb24gdWUpIHsK\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBCS0F1ZGl0RXhjZXB0aW9uKAog\nICAgICAgICAgICAgICAgICAgICAgICAiRmFpbGVkIHRvIHB1Ymxpc2ggdW5k\nZXJyZXBsaWNhdGVkIGxlZGdlcjogIiArIGxlZGdlcklkCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyAiIG9mIGJvb2tpZTogIiArIGJvb2tp\nZUlQLCB1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBQcm9jZXNzIHRoZSByZXN1bHQgcmV0dXJuZWQgZnJvbSBj\naGVja2luZyBhIGxlZGdlcgogICAgICovCiAgICBwcml2YXRlIGNsYXNzIFBy\nb2Nlc3NMb3N0RnJhZ21lbnRzQ2IgaW1wbGVtZW50cyBHZW5lcmljQ2FsbGJh\nY2s8U2V0PExlZGdlckZyYWdtZW50Pj4gewogICAgICAgIGZpbmFsIExlZGdl\nckhhbmRsZSBsaDsKICAgICAgICBmaW5hbCBBc3luY0NhbGxiYWNrLlZvaWRD\nYWxsYmFjayBjYWxsYmFjazsKCiAgICAgICAgUHJvY2Vzc0xvc3RGcmFnbWVu\ndHNDYihMZWRnZXJIYW5kbGUgbGgsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxi\nYWNrIGNhbGxiYWNrKSB7CiAgICAgICAgICAgIHRoaXMubGggPSBsaDsKICAg\nICAgICAgICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJj\nLCBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IGZyYWdtZW50cykgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9u\nLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgICAgICBTZXQ8SW5ldFNvY2tl\ndEFkZHJlc3M+IGJvb2tpZXMgPSBTZXRzLm5ld0hhc2hTZXQoKTsKICAgICAg\nICAgICAgICAgICAgICBmb3IgKExlZGdlckZyYWdtZW50IGYgOiBmcmFnbWVu\ndHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYm9va2llcy5hZGQoZi5n\nZXRBZGRyZXNzKCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICBmb3IgKEluZXRTb2NrZXRBZGRyZXNzIGJvb2tpZSA6IGJv\nb2tpZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHVibGlzaFN1c3Bl\nY3RlZExlZGdlcnMoU3RyaW5nVXRpbHMuYWRkclRvU3RyaW5nKGJvb2tpZSks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIFNldHMubmV3SGFzaFNldChsaC5nZXRJZCgpKSk7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nbGguY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24g\nYmtlKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIGNsb3Np\nbmcgbGgiLCBia2UpOwogICAgICAgICAgICAgICAgaWYgKHJjID09IEJLRXhj\nZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgICAgICByYyA9IEJL\nRXhjZXB0aW9uLkNvZGUuUmVwbGljYXRpb25FeGNlcHRpb247CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhj\nZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkludGVy\ncnVwdGVkIHB1Ymxpc2hpbmcgc3VzcGVjdGVkIGxlZGdlciIsIGllKTsKICAg\nICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0\nKCk7CiAgICAgICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29k\nZS5PSykgewogICAgICAgICAgICAgICAgICAgIHJjID0gQktFeGNlcHRpb24u\nQ29kZS5JbnRlcnJ1cHRlZEV4Y2VwdGlvbjsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfSBjYXRjaCAoQktBdWRpdEV4Y2VwdGlvbiBia2FlKSB7\nCiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkF1ZGl0b3IgZXhjZXB0aW9u\nIHB1Ymxpc2hpbmcgc3VzcGVjdGVkIGxlZGdlciIsIGJrYWUpOwogICAgICAg\nICAgICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAg\nICAgICAgICAgICAgICAgICByYyA9IEJLRXhjZXB0aW9uLkNvZGUuUmVwbGlj\nYXRpb25FeGNlcHRpb247CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIGNhbGxiYWNrLnByb2Nlc3NSZXN1bHQocmMsIG51\nbGwsIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIExp\nc3QgYWxsIHRoZSBsZWRnZXJzIGFuZCBjaGVjayB0aGVtIGluZGl2aWR1YWxs\neS4gVGhpcyBzaG91bGQgbm90CiAgICAgKiBiZSBydW4gdmVyeSBvZnRlbi4K\nICAgICAqLwogICAgdm9pZCBjaGVja0FsbExlZGdlcnMoKSB0aHJvd3MgQktB\ndWRpdEV4Y2VwdGlvbiwgQktFeGNlcHRpb24sCiAgICAgICAgICAgIElPRXhj\nZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgS2VlcGVyRXhjZXB0aW9u\nIHsKICAgICAgICBab29LZWVwZXJXYXRjaGVyQmFzZSB3ID0gbmV3IFpvb0tl\nZXBlcldhdGNoZXJCYXNlKGNvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAg\nIFpvb0tlZXBlciBuZXd6ayA9IFprVXRpbHMuY3JlYXRlQ29ubmVjdGVkWm9v\na2VlcGVyQ2xpZW50KGNvbmYuZ2V0WmtTZXJ2ZXJzKCksIHcpOwoKICAgICAg\nICBmaW5hbCBCb29rS2VlcGVyIGNsaWVudCA9IG5ldyBCb29rS2VlcGVyKG5l\ndyBDbGllbnRDb25maWd1cmF0aW9uKGNvbmYpLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3emspOwogICAg\nICAgIGZpbmFsIEJvb2tLZWVwZXJBZG1pbiBhZG1pbiA9IG5ldyBCb29rS2Vl\ncGVyQWRtaW4oY2xpZW50KTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nZmluYWwgTGVkZ2VyQ2hlY2tlciBjaGVja2VyID0gbmV3IExlZGdlckNoZWNr\nZXIoY2xpZW50KTsKCiAgICAgICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIg\ncmV0dXJuQ29kZSA9IG5ldyBBdG9taWNJbnRlZ2VyKEJLRXhjZXB0aW9uLkNv\nZGUuT0spOwogICAgICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBwcm9j\nZXNzRG9uZSA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgICAg\nIFByb2Nlc3NvcjxMb25nPiBjaGVja0xlZGdlcnNQcm9jZXNzb3IgPSBuZXcg\nUHJvY2Vzc29yPExvbmc+KCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKGZpbmFsIExv\nbmcgbGVkZ2VySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGNhbGxiYWNr\nKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKCFsZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlci5p\nc0xlZGdlclJlcGxpY2F0aW9uRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBMT0cuaW5mbygiTGVkZ2VyIHJlcmVwbGljYXRpb24g\naGFzIGJlZW4gZGlzYWJsZWQsIGFib3J0aW5nIHBlcmlvZGljIGNoZWNrIik7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzRG9uZS5jb3Vu\ndERvd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFJlcGxpY2F0aW9uRXhjZXB0aW9uLlVuYXZhaWxhYmxlRXhj\nZXB0aW9uIHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiVW5kZXJyZXBsaWNhdGlvbiBtYW5hZ2VyIHVuYXZhaWxhYmxlICIKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsicnVubmluZyBwZXJp\nb2RpYyBjaGVjayIsIHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJv\nY2Vzc0RvbmUuY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAg\nICAgICAgIExlZGdlckhhbmRsZSBsaCA9IG51bGw7CiAgICAgICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbGggPSBhZG1p\nbi5vcGVuTGVkZ2VyTm9SZWNvdmVyeShsZWRnZXJJZCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGNoZWNrZXIuY2hlY2tMZWRnZXIobGgsIG5ldyBQcm9j\nZXNzTG9zdEZyYWdtZW50c0NiKGxoLCBjYWxsYmFjaykpOwogICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0aW9uLkJLTm9TdWNoTGVkZ2Vy\nRXhpc3RzRXhjZXB0aW9uIGJrbnNsZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBMT0cuZGVidWcoIkxlZGdlciB3YXMgZGVsZXRlZCBiZWZvcmUgd2Ug\nY291bGQgY2hlY2sgaXQiLCBia25zbGUpOwogICAgICAgICAgICAgICAgICAg\nICAgICBjYWxsYmFjay5wcm9jZXNzUmVzdWx0KEJLRXhjZXB0aW9uLkNvZGUu\nT0ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbnVsbCwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlv\nbiBia2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJD\nb3VsZG4ndCBvcGVuIGxlZGdlciAiICsgbGVkZ2VySWQsIGJrZSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLnByb2Nlc3NSZXN1bHQoQktF\neGNlcHRpb24uQ29kZS5Cb29raWVIYW5kbGVOb3RBdmFpbGFibGVFeGNlcHRp\nb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbnVsbCwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiBpZSkgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3Io\nIkludGVycnVwdGVkIG9wZW5pbmcgbGVkZ2VyIiwgaWUpOwogICAgICAgICAg\nICAgICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVw\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5wcm9jZXNz\nUmVzdWx0KEJLRXhjZXB0aW9uLkNvZGUuSW50ZXJydXB0ZWRFeGNlcHRpb24s\nIG51bGwsIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKGxoICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbGguY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKEJLRXhjZXB0aW9uIGJrZSkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIExPRy53YXJuKCJDb3VsZG4ndCBjbG9zZSBsZWRn\nZXIgIiArIGxlZGdlcklkLCBia2UpOwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cud2FybigiSW50ZXJy\ndXB0ZWQgY2xvc2luZyBsZWRnZXIgIiArIGxlZGdlcklkLCBpZSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJl\nYWQoKS5pbnRlcnJ1cHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAg\nICAgICAgIGxlZGdlck1hbmFnZXIuYXN5bmNQcm9jZXNzTGVkZ2VycyhjaGVj\na0xlZGdlcnNQcm9jZXNzb3IsCiAgICAgICAgICAgICAgICAgICAgbmV3IEFz\neW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrKCkgewogICAgICAgICAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBzLCBPYmpl\nY3Qgb2JqKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5D\nb2RlLnNldChyYyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9j\nZXNzRG9uZS5jb3VudERvd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIH0sIG51bGwsIEJLRXhjZXB0aW9uLkNv\nZGUuT0ssIEJLRXhjZXB0aW9uLkNvZGUuUmVhZEV4Y2VwdGlvbik7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBwcm9jZXNzRG9uZS5hd2Fp\ndCgpOwogICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgp\nLmludGVycnVwdCgpOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEJLQXVk\naXRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICJFeGNlcHRp\nb24gd2hpbGUgY2hlY2tpbmcgbGVkZ2VycyIsIGUpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGlmIChyZXR1cm5Db2RlLmdldCgpICE9IEJLRXhjZXB0\naW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgIHRocm93IEJLRXhjZXB0\naW9uLmNyZWF0ZShyZXR1cm5Db2RlLmdldCgpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGFkbWluLmNsb3NlKCk7\nCiAgICAgICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgICAgICAgICBuZXd6\nay5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyB2b2lkIGF2YWlsYWJsZUJvb2tpZXNDaGFuZ2VkKCkgewogICAg\nICAgIHN1Ym1pdEF1ZGl0VGFzaygpOwogICAgfQoKICAgIC8qKgogICAgICog\nU2h1dGRvd24gdGhlIGF1ZGl0b3IKICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2h1dGRvd24oKSB7CiAgICAgICAgTE9HLmluZm8oIlNodXR0aW5nIGRvd24g\nYXVkaXRvciIpOwogICAgICAgIHN1Ym1pdFNodXRkb3duVGFzaygpOwoKICAg\nICAgICB0cnkgewogICAgICAgICAgICB3aGlsZSAoIWV4ZWN1dG9yLmF3YWl0\nVGVybWluYXRpb24oMzAsIFRpbWVVbml0LlNFQ09ORFMpKSB7CiAgICAgICAg\nICAgICAgICBMT0cud2FybigiRXhlY3V0b3Igbm90IHNodXR0aW5nIGRvd24s\nIGludGVycnVwdGluZyIpOwogICAgICAgICAgICAgICAgZXhlY3V0b3Iuc2h1\ndGRvd25Ob3coKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhZG1pbi5j\nbG9zZSgpOwogICAgICAgICAgICBia2MuY2xvc2UoKTsKICAgICAgICB9IGNh\ndGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAg\nICBMT0cud2FybigiSW50ZXJydXB0ZWQgd2hpbGUgc2h1dHRpbmcgZG93biBh\ndWRpdG9yIGJvb2tpZSIsIGllKTsKICAgICAgICB9IGNhdGNoIChCS0V4Y2Vw\ndGlvbiBia2UpIHsKICAgICAgICAgICAgTE9HLndhcm4oIkV4Y2VwdGlvbiB3\naGlsZSBzaHV0dGluZyBkb3duIGF1ZGl0b3IgYm9va2llIiwgYmtlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBh\ndWRpdG9yIGlzIHJ1bm5pbmcgb3RoZXJ3aXNlIHJldHVybiBmYWxzZQogICAg\nICogCiAgICAgKiBAcmV0dXJuIGF1ZGl0b3Igc3RhdHVzCiAgICAgKi8KICAg\nIHB1YmxpYyBib29sZWFuIGlzUnVubmluZygpIHsKICAgICAgICByZXR1cm4g\nIWV4ZWN1dG9yLmlzU2h1dGRvd24oKTsKICAgIH0KfQo=\n","encoding":"base64"}

