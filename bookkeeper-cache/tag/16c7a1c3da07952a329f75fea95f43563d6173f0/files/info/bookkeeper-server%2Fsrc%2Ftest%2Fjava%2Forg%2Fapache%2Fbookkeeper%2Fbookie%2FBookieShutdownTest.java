{"sha":"6f641b6872a197191bef339f503195c0c5b216c2","node_id":"MDQ6QmxvYjE1NzU5NTY6NmY2NDFiNjg3MmExOTcxOTFiZWYzMzlmNTAzMTk1YzBjNWIyMTZjMg==","size":4561,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/6f641b6872a197191bef339f503195c0c5b216c2","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZTsKCmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0OwoKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdC5Cb29rS2VlcGVy\nQ2x1c3RlclRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVySW50ZXJuYWxDYWxsYmFja3MuV3JpdGVDYWxsYmFjazsKCmltcG9ydCBq\nYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVw\nZXIuS2VlcGVyRXhjZXB0aW9uOwoKaW1wb3J0IGphdmEubmlvLkJ5dGVCdWZm\nZXI7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKaW1wb3J0IG9yZy5qdW5pdC5B\nc3NlcnQ7CgpwdWJsaWMgY2xhc3MgQm9va2llU2h1dGRvd25UZXN0IGV4dGVu\nZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CgogICAgcHVibGljIEJv\nb2tpZVNodXRkb3duVGVzdCgpIHsKICAgICAgICBzdXBlcigxKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRlc3Qgd2hldGhlciBCb29raWUgY2FuIGJlIHNo\ndXRkb3duIHdoZW4gdGhlIGNhbGwgY29tZXMgaW5zaWRlIGJvb2tpZSB0aHJl\nYWQuCiAgICAgKiAKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8K\nICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0Qm9va2llU2h1dGRvd25G\ncm9tQm9va2llVGhyZWFkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mID0gYnNDb25mcy5nZXQoMCk7CiAg\nICAgICAga2lsbEJvb2tpZSgwKTsKICAgICAgICBmaW5hbCBDb3VudERvd25M\nYXRjaCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICBm\naW5hbCBDb3VudERvd25MYXRjaCBzaHV0ZG93bkNvbXBsZXRlID0gbmV3IENv\ndW50RG93bkxhdGNoKDEpOwogICAgICAgIEJvb2tpZSBib29raWUgPSBuZXcg\nQm9va2llKGNvbmYpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgbGF0Y2guYXdhaXQoKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgICAgICAvLyBJZ25vcmUKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIHRyaWdnZXJCb29raWVTaHV0ZG93bihFeGl0Q29k\nZS5CT09LSUVfRVhDRVBUSU9OKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHN5bmNocm9uaXplZCBpbnQgc2h1\ndGRvd24oaW50IGV4aXRDb2RlKSB7CiAgICAgICAgICAgICAgICBzdXBlci5z\naHV0ZG93bihleGl0Q29kZSk7CiAgICAgICAgICAgICAgICBzaHV0ZG93bkNv\nbXBsZXRlLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgcmV0dXJuIGV4\naXRDb2RlOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBib29r\naWUuc3RhcnQoKTsKICAgICAgICAvLyBhZnRlciAxIHNlYyBzdG9wIC4KICAg\nICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAgbGF0Y2guY291bnRE\nb3duKCk7CiAgICAgICAgc2h1dGRvd25Db21wbGV0ZS5hd2FpdCg1MDAwLCBU\naW1lVW5pdC5NSUxMSVNFQ09ORFMpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGVzdCB3aGV0aGVyIGJvb2tpZXNlcnZlciByZXR1cm5zIHRoZSBjb3JyZWN0\nIGVycm9yIGNvZGUgd2hlbiBpdCBjcmFzaGVzLgogICAgICovCiAgICBAVGVz\ndCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdEJvb2tpZVNl\ncnZlclRocmVhZEVycm9yKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mID0gYnNDb25mcy5nZXQoMCk7CiAg\nICAgICAga2lsbEJvb2tpZSgwKTsKICAgICAgICBmaW5hbCBDb3VudERvd25M\nYXRjaCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICBm\naW5hbCBDb3VudERvd25MYXRjaCBzaHV0ZG93bkNvbXBsZXRlID0gbmV3IENv\ndW50RG93bkxhdGNoKDEpOwogICAgICAgIC8vIHNpbXVsYXRpbmcgWm9vS2Vl\ncGVyIGV4Y2VwdGlvbiBieSBhc3NpZ25pbmcgYSBjbG9zZWQgemsgY2xpZW50\nIHRvIGJrCiAgICAgICAgQm9va2llU2VydmVyIGJrU2VydmVyID0gbmV3IEJv\nb2tpZVNlcnZlcihjb25mKSB7CiAgICAgICAgICAgIHByb3RlY3RlZCBCb29r\naWUgbmV3Qm9va2llKFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZikKICAgICAg\nICAgICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIEtlZXBlckV4Y2Vw\ndGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sCiAgICAgICAgICAgICAgICAg\nICAgQm9va2llRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHJldHVybiBu\nZXcgQm9va2llKGNvbmYpIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRFbnRyeShC\neXRlQnVmZmVyIGVudHJ5LCBXcml0ZUNhbGxiYWNrIGNiLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdCBjdHgsIGJ5\ndGVbXSBtYXN0ZXJLZXkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0\naHJvd3MgSU9FeGNlcHRpb24sIEJvb2tpZUV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBPdXRPZk1lbW9yeUVycm9yKCk7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAg\nICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgYmtTZXJ2ZXIuc3RhcnQo\nKTsKCiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxlZGdl\ncigxLCAxLCBCb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JDMzIsICJwYXNzd2Qi\nLmdldEJ5dGVzKCkpOwogICAgICAgIGxoLmFzeW5jQWRkRW50cnkoInRlc3Qi\nLmdldEJ5dGVzKCksIG5ldyBBZGRDYWxsYmFjaygpIHsKICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgYWRk\nQ29tcGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUgbGgsIGxvbmcgZW50cnlJ\nZCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgIC8vIGRvbnQg\nY2FyZSwgb25seSB0cnlpbmcgdG8gdHJpZ2dlciBPT00KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSwgbnVsbCk7CiAgICAgICAgYmtTZXJ2ZXIu\nam9pbigpOwogICAgICAgIEFzc2VydC5hc3NlcnRGYWxzZSgiU2hvdWxkIGhh\ndmUgZGllZCIsIGJrU2VydmVyLmlzUnVubmluZygpKTsKICAgICAgICBBc3Nl\ncnQuYXNzZXJ0RXF1YWxzKCJTaG91bGQgaGF2ZSBkaWVkIHdpdGggc2VydmVy\nIGV4Y2VwdGlvbiBjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIEV4aXRDb2RlLlNFUlZFUl9FWENFUFRJT04sIGJrU2VydmVyLmdldEV4aXRD\nb2RlKCkpOwogICAgfQp9Cg==\n","encoding":"base64"}

