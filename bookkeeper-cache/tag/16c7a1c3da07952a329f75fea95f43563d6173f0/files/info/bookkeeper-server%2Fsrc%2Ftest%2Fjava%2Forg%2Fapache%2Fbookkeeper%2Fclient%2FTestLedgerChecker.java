{"sha":"a1592ac660d1aeebd8dec59014a0f013f2c87f37","node_id":"MDQ6QmxvYjE1NzU5NTY6YTE1OTJhYzY2MGQxYWVlYmQ4ZGVjNTkwMTRhMGYwMTNmMmM4N2YzNw==","size":18341,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a1592ac660d1aeebd8dec59014a0f013f2c87f37","content":"LyoqCiAqIAogKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZv\ndW5kYXRpb24gKEFTRikgdW5kZXIgb25lIAogKiBvciBtb3JlIGNvbnRyaWJ1\ndG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUg\nCiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFs\nIGluZm9ybWF0aW9uIAogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hp\ncC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlIAogKiB0byB5b3UgdW5k\nZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIAogKiAi\nTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBp\nbiBjb21wbGlhbmNlIAogKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBv\nYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0IAogKiAKICogICBodHRw\nOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAgCiAqIAog\nKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVk\nIHRvIGluIHdyaXRpbmcsIAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRl\nciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAKICogIkFTIElT\nIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0Yg\nQU5ZIAogKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2Vl\nIHRoZSBMaWNlbnNlIGZvciB0aGUgCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdv\ndmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgCiAqIHVuZGVy\nIHRoZSBMaWNlbnNlLiAKICogCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQ7CgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFk\nZHJlc3M7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2\nYS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50\nRG93bkxhdGNoOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0NhbGxiYWNr\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9va0tlZXBl\nckNsdXN0ZXJUZXN0Q2FzZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJG\nYWN0b3J5OwoKLyoqCiAqIFRlc3RzIHRoZSBmdW5jdGlvbmFsaXR5IG9mIExl\nZGdlckNoZWNrZXIuIFRoaXMgTGVkZ2VyIGNoZWNrZXIgc2hvdWxkIGJlIGFi\nbGUKICogdG8gZGV0ZWN0IHRoZSBjb3JyZWN0IHVuZGVyUmVwbGljYXRlZCBm\ncmFnbWVudAogKi8KcHVibGljIGNsYXNzIFRlc3RMZWRnZXJDaGVja2VyIGV4\ndGVuZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBieXRlW10gVEVTVF9MRURHRVJfRU5UUllfREFUQSA9\nICJUZXN0Q2hlY2tlckRhdGEiCiAgICAgICAgICAgIC5nZXRCeXRlcygpOwog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgYnl0ZVtdIFRFU1RfTEVER0VSX1BB\nU1NXT1JEID0gInRlc3RwYXNzd2QiLmdldEJ5dGVzKCk7CiAgICBzdGF0aWMg\nTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFRlc3RMZWRn\nZXJDaGVja2VyLmNsYXNzKTsKCiAgICBwdWJsaWMgVGVzdExlZGdlckNoZWNr\nZXIoKSB7CiAgICAgICAgc3VwZXIoMyk7CiAgICB9CgogICAgY2xhc3MgQ2hl\nY2tlckNhbGxiYWNrIGltcGxlbWVudHMgR2VuZXJpY0NhbGxiYWNrPFNldDxM\nZWRnZXJGcmFnbWVudD4+IHsKICAgICAgICBwcml2YXRlIFNldDxMZWRnZXJG\ncmFnbWVudD4gcmVzdWx0ID0gbnVsbDsKICAgICAgICBwcml2YXRlIENvdW50\nRG93bkxhdGNoIGxhdGNoID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwoKICAg\nICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIFNl\ndDxMZWRnZXJGcmFnbWVudD4gcmVzdWx0KSB7CiAgICAgICAgICAgIHRoaXMu\ncmVzdWx0ID0gcmVzdWx0OwogICAgICAgICAgICBsYXRjaC5jb3VudERvd24o\nKTsKICAgICAgICB9CgogICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4gd2Fp\ndEFuZEdldFJlc3VsdCgpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIGxhdGNoLmF3YWl0KCk7CiAgICAgICAgICAgIHJldHVy\nbiByZXN1bHQ7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGVz\ndHMgdGhhdCB0aGUgTGVkZ2VyQ2hlY2tlciBzaG91bGQgZGV0ZWN0IHRoZSB1\nbmRlclJlcGxpY2F0ZWQgZnJhZ21lbnRzCiAgICAgKiBvbiBtdWx0aXBsZSBC\nb29raWUgY3Jhc2hlcwogICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAw\nKQogICAgcHVibGljIHZvaWQgdGVzdENoZWNrZXIoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKCiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxl\nZGdlcihCb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JDMzIsCiAgICAgICAgICAg\nICAgICBURVNUX0xFREdFUl9QQVNTV09SRCk7CiAgICAgICAgc3RhcnROZXdC\nb29raWUoKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxMDsgaSsr\nKSB7CiAgICAgICAgICAgIGxoLmFkZEVudHJ5KFRFU1RfTEVER0VSX0VOVFJZ\nX0RBVEEpOwogICAgICAgIH0KICAgICAgICBJbmV0U29ja2V0QWRkcmVzcyBy\nZXBsaWNhVG9LaWxsID0gbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKS5nZXRFbnNl\nbWJsZXMoKQogICAgICAgICAgICAgICAgLmdldCgwTCkuZ2V0KDApOwogICAg\nICAgIExPRy5pbmZvKCJLaWxsaW5nIHt9IiwgcmVwbGljYVRvS2lsbCk7CiAg\nICAgICAga2lsbEJvb2tpZShyZXBsaWNhVG9LaWxsKTsKCiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIGxoLmFk\nZEVudHJ5KFRFU1RfTEVER0VSX0VOVFJZX0RBVEEpOwogICAgICAgIH0KCiAg\nICAgICAgU2V0PExlZGdlckZyYWdtZW50PiByZXN1bHQgPSBnZXRVbmRlclJl\ncGxpY2F0ZWRGcmFnbWVudHMobGgpOwogICAgICAgIGFzc2VydE5vdE51bGwo\nIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CiAgICAgICAg\nZm9yIChMZWRnZXJGcmFnbWVudCByIDogcmVzdWx0KSB7CiAgICAgICAgICAg\nIExPRy5pbmZvKCJ1bnJlcGxpY2F0ZWQgZnJhZ21lbnQ6IHt9Iiwgcik7CiAg\nICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscygiU2hvdWxkIGhhdmUgb25l\nIG1pc3NpbmcgZnJhZ21lbnQiLCAxLCByZXN1bHQuc2l6ZSgpKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoIkZyYWdtZW50IHNob3VsZCBiZSBtaXNzaW5nIGZy\nb20gZmlyc3QgcmVwbGljYSIsIHJlc3VsdAogICAgICAgICAgICAgICAgLml0\nZXJhdG9yKCkubmV4dCgpLmdldEFkZHJlc3MoKSwgcmVwbGljYVRvS2lsbCk7\nCgogICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIHJlcGxpY2FUb0tpbGwyID0g\nbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKQogICAgICAgICAgICAgICAgLmdldEVu\nc2VtYmxlcygpLmdldCgwTCkuZ2V0KDEpOwogICAgICAgIExPRy5pbmZvKCJL\naWxsaW5nIHt9IiwgcmVwbGljYVRvS2lsbDIpOwogICAgICAgIGtpbGxCb29r\naWUocmVwbGljYVRvS2lsbDIpOwoKICAgICAgICByZXN1bHQgPSBnZXRVbmRl\nclJlcGxpY2F0ZWRGcmFnbWVudHMobGgpOwogICAgICAgIGFzc2VydE5vdE51\nbGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CiAgICAg\nICAgZm9yIChMZWRnZXJGcmFnbWVudCByIDogcmVzdWx0KSB7CiAgICAgICAg\nICAgIExPRy5pbmZvKCJ1bnJlcGxpY2F0ZWQgZnJhZ21lbnQ6IHt9Iiwgcik7\nCiAgICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscygiU2hvdWxkIGhhdmUg\ndGhyZWUgbWlzc2luZyBmcmFnbWVudHMiLCAzLCByZXN1bHQuc2l6ZSgpKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRlc3RzIHRoYXQgbGVkZ2VyIGNoZWNr\nZXIgc2hvdWxkIHBpY2sgdGhlIGZyYWdtZW50IGFzIGJhZCBvbmx5IGlmIGFu\neSBvZgogICAgICogdGhlIGZyYWdtZW50IGVudHJpZXMgbm90IG1lZXRpbmcg\ndGhlIHF1b3J1bS4KICAgICAqLwogICAgLy8gLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIC8v\nLy8vLy8vL0Vuc2VtYmxlID0gMywgUXVvcnVtID0gMiAvLy8vLy8vLy8vLy8v\nLy8vLy8vCiAgICAvLyAvU2FtcGxlIExlZGdlciBtZXRhIGRhdGEgc2hvdWxk\nIGxvb2sgbGlrZS8vLy8vLy8vLy8vLwogICAgLy8gLzAgYSBiIGMgLy8vLy8q\nZW50cnkgcHJlc2VudCBpbiBhLGIuIE5vdyBraWxsIGMvLy8vLy8KICAgIC8v\nIC8xIGEgYiBkIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vCiAgICAvLyAvSGVyZSBldmVuIHRob3VnaCBvbmUgQksgZmFp\nbGVkIGF0IHRoaXMgc3RhZ2UsIC8vLy8vLwogICAgLy8gL3dlIGRvbid0IGhh\ndmUgYW55IG1pc3NlZCBlbnRyaWVzLiBRdW9ydW0gc2F0aXNmaWVkLy8KICAg\nIC8vIC9TbywgdGhlcmUgc2hvdWxkIG5vdCBiZSBhbnkgbWlzc2luZyByZXBs\naWNhcy4vLy8vLy8vCiAgICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgQFRlc3QodGltZW91\ndCA9IDMwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2hvdWxkTm90R2V0VGhl\nRnJhZ21lbnRJZlRoZXJlSXNOb01pc3NlZEVudHJ5KCkKICAgICAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7CgogICAgICAgIExlZGdlckhhbmRsZSBsaCA9\nIGJrYy5jcmVhdGVMZWRnZXIoMywgMiwgQm9va0tlZXBlci5EaWdlc3RUeXBl\nLkNSQzMyLAogICAgICAgICAgICAgICAgVEVTVF9MRURHRVJfUEFTU1dPUkQp\nOwogICAgICAgIGxoLmFkZEVudHJ5KFRFU1RfTEVER0VSX0VOVFJZX0RBVEEp\nOwoKICAgICAgICAvLyBFbnRyeSBzaG91bGQgaGF2ZSBhZGRlZCBpbiBmaXJz\ndCAyIEJvb2tpZXMuCgogICAgICAgIC8vIEtpbGwgdGhlIDNyZCBCSyBmcm9t\nIGVuc2VtYmxlLgogICAgICAgIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVz\ncz4gZmlyc3RFbnNlbWJsZSA9IGxoLmdldExlZGdlck1ldGFkYXRhKCkKICAg\nICAgICAgICAgICAgIC5nZXRFbnNlbWJsZXMoKS5nZXQoMEwpOwogICAgICAg\nIEluZXRTb2NrZXRBZGRyZXNzIGxhc3RCb29raWVGcm9tRW5zZW1ibGUgPSBm\naXJzdEVuc2VtYmxlLmdldCgyKTsKICAgICAgICBMT0cuaW5mbygiS2lsbGlu\nZyAiICsgbGFzdEJvb2tpZUZyb21FbnNlbWJsZSArICIgZnJvbSBlbnNlbWJs\nZT0iCiAgICAgICAgICAgICAgICArIGZpcnN0RW5zZW1ibGUpOwogICAgICAg\nIGtpbGxCb29raWUobGFzdEJvb2tpZUZyb21FbnNlbWJsZSk7CgogICAgICAg\nIHN0YXJ0TmV3Qm9va2llKCk7CgogICAgICAgIExPRy5pbmZvKCJFbnNlbWJs\nZXMgYWZ0ZXIgZmlyc3QgZW50cnkgOiIKICAgICAgICAgICAgICAgICsgbGgu\nZ2V0TGVkZ2VyTWV0YWRhdGEoKS5nZXRFbnNlbWJsZXMoKSk7CgogICAgICAg\nIC8vIEFkZGluZyBvbmUgbW9yZSBlbnRyeS4gSGVyZSBlbnNlYmxlIHNob3Vs\nZCBiZSByZWZvcm1lZC4KICAgICAgICBsaC5hZGRFbnRyeShURVNUX0xFREdF\nUl9FTlRSWV9EQVRBKTsKCiAgICAgICAgTE9HLmluZm8oIkVuc2VtYmxlcyBh\nZnRlciBzZWNvbmQgZW50cnkgOiIKICAgICAgICAgICAgICAgICsgbGguZ2V0\nTGVkZ2VyTWV0YWRhdGEoKS5nZXRFbnNlbWJsZXMoKSk7CgogICAgICAgIFNl\ndDxMZWRnZXJGcmFnbWVudD4gcmVzdWx0ID0gZ2V0VW5kZXJSZXBsaWNhdGVk\nRnJhZ21lbnRzKGxoKTsKCiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiUmVzdWx0\nIHNob3VsZG4ndCBiZSBudWxsIiwgcmVzdWx0KTsKCiAgICAgICAgZm9yIChM\nZWRnZXJGcmFnbWVudCByIDogcmVzdWx0KSB7CiAgICAgICAgICAgIExPRy5p\nbmZvKCJ1bnJlcGxpY2F0ZWQgZnJhZ21lbnQ6IHt9Iiwgcik7CiAgICAgICAg\nfQoKICAgICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBub3QgaGF2ZSBhbnkg\nbWlzc2luZyBmcmFnbWVudCIsIDAsIHJlc3VsdC5zaXplKCkpOwogICAgfQoK\nICAgIC8qKgogICAgICogVGVzdHMgdGhhdCBMZWRnZXJDaGVja2VyIHNob3Vs\nZCBnaXZlIHR3byBmcmFnbWVudHMgd2hlbiAyIGJvb2tpZXMgZmFpbGVkCiAg\nICAgKiBpbiBzYW1lIGVuc2VtYmxlIHdoZW4gZW5zZW1ibGUgPSAzLCBxdW9y\ndW0gPSAyCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQgPSAzMDAwKQogICAg\ncHVibGljIHZvaWQgdGVzdFNob3VsZEdldFR3b0ZyZ2FtZW50c0lmVHdvQm9v\na2llc0ZhaWxlZEluU2FtZUVuc2VtYmxlKCkKICAgICAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7CgogICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5j\ncmVhdGVMZWRnZXIoMywgMiwgQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMy\nLAogICAgICAgICAgICAgICAgVEVTVF9MRURHRVJfUEFTU1dPUkQpOwogICAg\nICAgIHN0YXJ0TmV3Qm9va2llKCk7CiAgICAgICAgc3RhcnROZXdCb29raWUo\nKTsKICAgICAgICBsaC5hZGRFbnRyeShURVNUX0xFREdFUl9FTlRSWV9EQVRB\nKTsKCiAgICAgICAgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBmaXJz\ndEVuc2VtYmxlID0gbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKQogICAgICAgICAg\nICAgICAgLmdldEVuc2VtYmxlcygpLmdldCgwTCk7CgogICAgICAgIEluZXRT\nb2NrZXRBZGRyZXNzIGZpcnN0Qm9va2llRnJvbUVuc2VtYmxlID0gZmlyc3RF\nbnNlbWJsZS5nZXQoMCk7CiAgICAgICAga2lsbEJvb2tpZShmaXJzdEVuc2Vt\nYmxlLCBmaXJzdEJvb2tpZUZyb21FbnNlbWJsZSk7CgogICAgICAgIEluZXRT\nb2NrZXRBZGRyZXNzIHNlY29uZEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0\nRW5zZW1ibGUuZ2V0KDEpOwogICAgICAgIGtpbGxCb29raWUoZmlyc3RFbnNl\nbWJsZSwgc2Vjb25kQm9va2llRnJvbUVuc2VtYmxlKTsKICAgICAgICBsaC5h\nZGRFbnRyeShURVNUX0xFREdFUl9FTlRSWV9EQVRBKTsKICAgICAgICBTZXQ8\nTGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZy\nYWdtZW50cyhsaCk7CgogICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBz\naG91bGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CgogICAgICAgIGZvciAoTGVk\nZ2VyRnJhZ21lbnQgciA6IHJlc3VsdCkgewogICAgICAgICAgICBMT0cuaW5m\nbygidW5yZXBsaWNhdGVkIGZyYWdtZW50OiB7fSIsIHIpOwogICAgICAgIH0K\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUaGVyZSBzaG91bGQgYmUgMiBmcmFn\nbWVudHMiLCAyLCByZXN1bHQuc2l6ZSgpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRlc3RzIHRoYXQgTGVkZ2VyQ2hlY2tlciBzaG91bGQgbm90IGdldCBh\nbnkgdW5kZXJSZXBsaWNhdGVkIGZyYWdtZW50cywgaWYKICAgICAqIGNvcnJl\nc3BvbmRpbmcgbGVkZ2VyIGRvZXMgbm90IGV4aXN0cy4KICAgICAqLwogICAg\nQFRlc3QodGltZW91dCA9IDMwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2hv\ndWxkTm90R2V0QW55RnJhZ21lbnRJZk5vTGVkZ2VyUHJlc2VudCgpCiAgICAg\nICAgICAgIHRocm93cyBFeGNlcHRpb24gewoKICAgICAgICBMZWRnZXJIYW5k\nbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDIsIEJvb2tLZWVwZXIuRGln\nZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BB\nU1NXT1JEKTsKCiAgICAgICAgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNz\nPiBmaXJzdEVuc2VtYmxlID0gbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKQogICAg\nICAgICAgICAgICAgLmdldEVuc2VtYmxlcygpLmdldCgwTCk7CiAgICAgICAg\nSW5ldFNvY2tldEFkZHJlc3MgZmlyc3RCb29raWVGcm9tRW5zZW1ibGUgPSBm\naXJzdEVuc2VtYmxlLmdldCgwKTsKICAgICAgICBraWxsQm9va2llKGZpcnN0\nQm9va2llRnJvbUVuc2VtYmxlKTsKICAgICAgICBzdGFydE5ld0Jvb2tpZSgp\nOwogICAgICAgIGxoLmFkZEVudHJ5KFRFU1RfTEVER0VSX0VOVFJZX0RBVEEp\nOwogICAgICAgIGJrYy5kZWxldGVMZWRnZXIobGguZ2V0SWQoKSk7CgogICAg\nICAgIFNldDxMZWRnZXJGcmFnbWVudD4gcmVzdWx0ID0gZ2V0VW5kZXJSZXBs\naWNhdGVkRnJhZ21lbnRzKGxoKTsKICAgICAgICBhc3NlcnROb3ROdWxsKCJS\nZXN1bHQgc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQpOwoKICAgICAgICBh\nc3NlcnRFcXVhbHMoIlRoZXJlIHNob3VsZCBiZSAwIGZyYWdtZW50cy4gQnV0\nIHJldHVybmVkIGZyYWdtZW50cyBhcmUgIgogICAgICAgICAgICAgICAgKyBy\nZXN1bHQsIDAsIHJlc3VsdC5zaXplKCkpOwogICAgfQoKICAgIC8qKgogICAg\nICogVGVzdHMgdGhhdCBMZWRnZXJDaGVja2VyIHNob3VsZCBnZXQgZmFpbGVk\nIGVuc2VtYmxlIG51bWJlciBvZiBmcmFnbWVudHMKICAgICAqIGlmIGVuc2Vt\nYmxlIGJvb2tpZSBmYWlsdXJlcyBvbiBuZXh0IGVudHJ5CiAgICAgKi8KICAg\nIEBUZXN0KHRpbWVvdXQgPSAzMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFNo\nb3VsZEdldEZhaWxlZEVuc2VtYmxlTnVtYmVyT2ZGZ21udHNJZkVuc2VtYmxl\nQm9va2llc0ZhaWxlZE9uTmV4dFdyaXRlKCkKICAgICAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7CgogICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CiAgICAg\nICAgc3RhcnROZXdCb29raWUoKTsKICAgICAgICBMZWRnZXJIYW5kbGUgbGgg\nPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDIsIEJvb2tLZWVwZXIuRGlnZXN0VHlw\nZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NXT1JE\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDM7IGkrKykgewogICAg\nICAgICAgICBsaC5hZGRFbnRyeShURVNUX0xFREdFUl9FTlRSWV9EQVRBKTsK\nICAgICAgICB9CgogICAgICAgIC8vIEtpbGwgYWxsIHRocmVlIGJvb2tpZXMK\nICAgICAgICBBcnJheUxpc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGZpcnN0RW5z\nZW1ibGUgPSBsaC5nZXRMZWRnZXJNZXRhZGF0YSgpCiAgICAgICAgICAgICAg\nICAuZ2V0RW5zZW1ibGVzKCkuZ2V0KDBMKTsKICAgICAgICBmb3IgKEluZXRT\nb2NrZXRBZGRyZXNzIGJrQWRkciA6IGZpcnN0RW5zZW1ibGUpIHsKICAgICAg\nICAgICAga2lsbEJvb2tpZShmaXJzdEVuc2VtYmxlLCBia0FkZHIpOwogICAg\nICAgIH0KCiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50PiByZXN1bHQgPSBn\nZXRVbmRlclJlcGxpY2F0ZWRGcmFnbWVudHMobGgpOwoKICAgICAgICBhc3Nl\ncnROb3ROdWxsKCJSZXN1bHQgc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQp\nOwoKICAgICAgICBmb3IgKExlZGdlckZyYWdtZW50IHIgOiByZXN1bHQpIHsK\nICAgICAgICAgICAgTE9HLmluZm8oInVucmVwbGljYXRlZCBmcmFnbWVudDog\ne30iLCByKTsKICAgICAgICB9CgogICAgICAgIGFzc2VydEVxdWFscygiVGhl\ncmUgc2hvdWxkIGJlIDMgZnJhZ21lbnRzIiwgMywgcmVzdWx0LnNpemUoKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyB0aGF0IExlZGdlckNoZWNr\nZXIgc2hvdWxkIG5vdCBnZXQgYW55IGZyYWdtZW50cyBhcyB1bmRlclJlcGxp\nY2F0ZWQKICAgICAqIGlmIExlZGdlciBpdHNlbGYgaXMgZW1wdHkKICAgICAq\nLwogICAgQFRlc3QodGltZW91dCA9IDMwMDApCiAgICBwdWJsaWMgdm9pZCB0\nZXN0U2hvdWxkTm90R2V0QW55RnJhZ21lbnRXaXRoRW1wdHlMZWRnZXIoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBi\na2MuY3JlYXRlTGVkZ2VyKDMsIDIsIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5D\nUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsK\nICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVuZGVy\nUmVwbGljYXRlZEZyYWdtZW50cyhsaCk7CiAgICAgICAgYXNzZXJ0Tm90TnVs\nbCgiUmVzdWx0IHNob3VsZG4ndCBiZSBudWxsIiwgcmVzdWx0KTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoIlRoZXJlIHNob3VsZCBiZSAwIGZyYWdtZW50cy4g\nQnV0IHJldHVybmVkIGZyYWdtZW50cyBhcmUgIgogICAgICAgICAgICAgICAg\nKyByZXN1bHQsIDAsIHJlc3VsdC5zaXplKCkpOwogICAgfQoKICAgIC8qKgog\nICAgICogVGVzdHMgdGhhdCBMZWRnZXJDaGVja2VyIHNob3VsZCBnZXQgYWxs\nIGZyYWdtZW50cyBpZiBsZWRnZXIgaXMgZW1wdHkKICAgICAqIGJ1dCBhbGwg\nYm9va2llcyBpbiB0aGUgZW5zZW1ibGUgYXJlIGRvd24uCiAgICAgKiBJbiB0\naGlzIGNhc2UsIHRoZXJlJ3Mgbm8gd2F5IHRvIHRlbGwgd2hldGhlciBkYXRh\nIHdhcyB3cml0dGVuIG9yIG5vdC4KICAgICAqIEluIHRoaXMgY2FzZSwgdGhl\ncmUnbGwgb25seSBiZSB0d28gZnJhZ21lbnRzLCBhcyBxdW9ydW0gaXMgMiBh\nbmQgd2Ugb25seQogICAgICogc3VzcGVjdCB0aGF0IHRoZSBmaXJzdCBlbnRy\neSBvZiB0aGUgbGVkZ2VyIGNvdWxkIGV4aXN0LgogICAgICovCiAgICBAVGVz\ndCh0aW1lb3V0ID0gMzAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTaG91bGRH\nZXQyRnJhZ21lbnRzV2l0aEVtcHR5TGVkZ2VyQnV0Qm9va2llc0RlYWQoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBi\na2MuY3JlYXRlTGVkZ2VyKDMsIDIsIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5D\nUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsK\nICAgICAgICBmb3IgKEluZXRTb2NrZXRBZGRyZXNzIGIgOiBsaC5nZXRMZWRn\nZXJNZXRhZGF0YSgpLmdldEVuc2VtYmxlcygpLmdldCgwTCkpIHsKICAgICAg\nICAgICAga2lsbEJvb2tpZShiKTsKICAgICAgICB9CiAgICAgICAgU2V0PExl\nZGdlckZyYWdtZW50PiByZXN1bHQgPSBnZXRVbmRlclJlcGxpY2F0ZWRGcmFn\nbWVudHMobGgpOwogICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBzaG91\nbGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJUaGVyZSBzaG91bGQgYmUgMiBmcmFnbWVudHMuIiwgMiwgcmVzdWx0LnNp\nemUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyB0aGF0IExlZGdl\nckNoZWNrZXIgc2hvdWxkIG9uZSBmcmFnbWVudCBhcyB1bmRlclJlcGxpY2F0\nZWQKICAgICAqIGlmIHRoZXJlIGlzIGFuIG9wZW4gbGVkZ2VyIHdpdGggc2lu\nZ2xlIGVudHJ5IHdyaXR0ZW4uCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQg\nPSAzMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFNob3VsZEdldE9uZUZyYWdt\nZW50V2l0aFNpbmdsZUVudHJ5T3BlbmVkTGVkZ2VyKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxl\nZGdlcigzLCAzLCBCb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JDMzIsCiAgICAg\nICAgICAgICAgICBURVNUX0xFREdFUl9QQVNTV09SRCk7CiAgICAgICAgbGgu\nYWRkRW50cnkoVEVTVF9MRURHRVJfRU5UUllfREFUQSk7CiAgICAgICAgQXJy\nYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0gbGgu\nZ2V0TGVkZ2VyTWV0YWRhdGEoKQogICAgICAgICAgICAgICAgLmdldEVuc2Vt\nYmxlcygpLmdldCgwTCk7CiAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgbGFz\ndEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0KDApOwog\nICAgICAgIExPRy5pbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2llRnJvbUVu\nc2VtYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAgICAgICsg\nZmlyc3RFbnNlbWJsZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0Qm9va2ll\nRnJvbUVuc2VtYmxlKTsKCiAgICAgICAgc3RhcnROZXdCb29raWUoKTsKCiAg\nICAgICAgLy9PcGVuIGxlZGdlciBzZXBhcmF0ZWx5IGZvciBMZWRnZXIgY2hl\nY2tlci4KICAgICAgICBMZWRnZXJIYW5kbGUgbGgxID1ia2Mub3BlbkxlZGdl\nck5vUmVjb3ZlcnkobGguZ2V0SWQoKSwgQm9va0tlZXBlci5EaWdlc3RUeXBl\nLkNSQzMyLAogICAgICAgICAgICAgICAgVEVTVF9MRURHRVJfUEFTU1dPUkQp\nOwoKICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVu\nZGVyUmVwbGljYXRlZEZyYWdtZW50cyhsaDEpOwogICAgICAgIGFzc2VydE5v\ndE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKCJUaGVyZSBzaG91bGQgYmUgMSBmcmFnbWVu\ndC4gQnV0IHJldHVybmVkIGZyYWdtZW50cyBhcmUgIgogICAgICAgICAgICAg\nICAgKyByZXN1bHQsIDEsIHJlc3VsdC5zaXplKCkpOwogICAgfQoKICAgIC8q\nKgogICAgICogVGVzdHMgdGhhdCBMZWRnZXJDaGVja2VyIGNvcnJlY3RseSBp\nZGVudGlmaWVzIG1pc3NpbmcgZnJhZ21lbnRzCiAgICAgKiB3aGVuIGEgc2lu\nZ2xlIGVudHJ5IGlzIHdyaXR0ZW4gYWZ0ZXIgYW4gZW5zZW1ibGUgY2hhbmdl\nLgogICAgICogVGhpcyBpcyBpbXBvcnRhbnQsIGFzIHRoZSBsYXN0IGFkZCBj\nb25maXJtZWQgbWF5IGJlIGxlc3MgdGhhbiB0aGUKICAgICAqIGZpcnN0IGVu\ndHJ5IGlkIG9mIHRoZSBmaW5hbCBzZWdtZW50LgogICAgICovCiAgICBAVGVz\ndCh0aW1lb3V0ID0gMzAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTaW5nbGVF\nbnRyeUFmdGVyRW5zZW1ibGVDaGFuZ2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMs\nIDMsIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAg\nICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgbGguYWRkRW50cnko\nVEVTVF9MRURHRVJfRU5UUllfREFUQSk7CiAgICAgICAgfQogICAgICAgIEFy\ncmF5TGlzdDxJbmV0U29ja2V0QWRkcmVzcz4gZmlyc3RFbnNlbWJsZSA9IGxo\nLmdldExlZGdlck1ldGFkYXRhKCkKICAgICAgICAgICAgICAgIC5nZXRFbnNl\nbWJsZXMoKS5nZXQoMEwpOwogICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGxh\nc3RCb29raWVGcm9tRW5zZW1ibGUgPSBmaXJzdEVuc2VtYmxlLmdldCgKICAg\nICAgICAgICAgICAgIGxoLmdldERpc3RyaWJ1dGlvblNjaGVkdWxlKCkuZ2V0\nV3JpdGVTZXQobGguZ2V0TGFzdEFkZFB1c2hlZCgpKS5nZXQoMCkpOwogICAg\nICAgIExPRy5pbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2llRnJvbUVuc2Vt\nYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAgICAgICsgZmly\nc3RFbnNlbWJsZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0Qm9va2llRnJv\nbUVuc2VtYmxlKTsKICAgICAgICBzdGFydE5ld0Jvb2tpZSgpOwoKICAgICAg\nICBsaC5hZGRFbnRyeShURVNUX0xFREdFUl9FTlRSWV9EQVRBKTsKCiAgICAg\nICAgbGFzdEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0\nKAogICAgICAgICAgICAgICAgbGguZ2V0RGlzdHJpYnV0aW9uU2NoZWR1bGUo\nKS5nZXRXcml0ZVNldChsaC5nZXRMYXN0QWRkUHVzaGVkKCkpLmdldCgxKSk7\nCiAgICAgICAgTE9HLmluZm8oIktpbGxpbmcgIiArIGxhc3RCb29raWVGcm9t\nRW5zZW1ibGUgKyAiIGZyb20gZW5zZW1ibGU9IgogICAgICAgICAgICAgICAg\nKyBmaXJzdEVuc2VtYmxlKTsKICAgICAgICBraWxsQm9va2llKGxhc3RCb29r\naWVGcm9tRW5zZW1ibGUpOwoKICAgICAgICAvL09wZW4gbGVkZ2VyIHNlcGFy\nYXRlbHkgZm9yIExlZGdlciBjaGVja2VyLgogICAgICAgIExlZGdlckhhbmRs\nZSBsaDEgPWJrYy5vcGVuTGVkZ2VyTm9SZWNvdmVyeShsaC5nZXRJZCgpLCBC\nb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JDMzIsCiAgICAgICAgICAgICAgICBU\nRVNUX0xFREdFUl9QQVNTV09SRCk7CgogICAgICAgIFNldDxMZWRnZXJGcmFn\nbWVudD4gcmVzdWx0ID0gZ2V0VW5kZXJSZXBsaWNhdGVkRnJhZ21lbnRzKGxo\nMSk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiUmVzdWx0IHNob3VsZG4ndCBi\nZSBudWxsIiwgcmVzdWx0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlRoZXJl\nIHNob3VsZCBiZSAzIGZyYWdtZW50LiBCdXQgcmV0dXJuZWQgZnJhZ21lbnRz\nIGFyZSAiCiAgICAgICAgICAgICAgICArIHJlc3VsdCwgMywgcmVzdWx0LnNp\nemUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyB0aGF0IExlZGdl\nckNoZWNrZXIgZG9lcyBub3QgcmV0dXJuIGFueSBmcmFnbWVudHMKICAgICAq\nIGZyb20gYSBjbG9zZWQgbGVkZ2VyIHdpdGggMCBlbnRyaWVzLgogICAgICov\nCiAgICBAVGVzdCh0aW1lb3V0ID0gMzAwMCkKICAgIHB1YmxpYyB2b2lkIHRl\nc3RDbG9zZWRFbXB0eUxlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5jcmVhdGVMZWRnZXIoMywgMywg\nQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAg\nVEVTVF9MRURHRVJfUEFTU1dPUkQpOwogICAgICAgIEFycmF5TGlzdDxJbmV0\nU29ja2V0QWRkcmVzcz4gZmlyc3RFbnNlbWJsZSA9IGxoLmdldExlZGdlck1l\ndGFkYXRhKCkKICAgICAgICAgICAgICAgIC5nZXRFbnNlbWJsZXMoKS5nZXQo\nMEwpOwogICAgICAgIGxoLmNsb3NlKCk7CgogICAgICAgIEluZXRTb2NrZXRB\nZGRyZXNzIGxhc3RCb29raWVGcm9tRW5zZW1ibGUgPSBmaXJzdEVuc2VtYmxl\nLmdldCgwKTsKICAgICAgICBMT0cuaW5mbygiS2lsbGluZyAiICsgbGFzdEJv\nb2tpZUZyb21FbnNlbWJsZSArICIgZnJvbSBlbnNlbWJsZT0iCiAgICAgICAg\nICAgICAgICArIGZpcnN0RW5zZW1ibGUpOwogICAgICAgIGtpbGxCb29raWUo\nbGFzdEJvb2tpZUZyb21FbnNlbWJsZSk7CgogICAgICAgIC8vT3BlbiBsZWRn\nZXIgc2VwYXJhdGVseSBmb3IgTGVkZ2VyIGNoZWNrZXIuCiAgICAgICAgTGVk\nZ2VySGFuZGxlIGxoMSA9YmtjLm9wZW5MZWRnZXJOb1JlY292ZXJ5KGxoLmdl\ndElkKCksIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAg\nICAgICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsKCiAgICAgICAgU2V0PExl\nZGdlckZyYWdtZW50PiByZXN1bHQgPSBnZXRVbmRlclJlcGxpY2F0ZWRGcmFn\nbWVudHMobGgxKTsKICAgICAgICBhc3NlcnROb3ROdWxsKCJSZXN1bHQgc2hv\ndWxkbid0IGJlIG51bGwiLCByZXN1bHQpOwogICAgICAgIGFzc2VydEVxdWFs\ncygiVGhlcmUgc2hvdWxkIGJlIDAgZnJhZ21lbnQuIEJ1dCByZXR1cm5lZCBm\ncmFnbWVudHMgYXJlICIKICAgICAgICAgICAgICAgICsgcmVzdWx0LCAwLCBy\nZXN1bHQuc2l6ZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3RzIHRo\nYXQgTGVkZ2VyQ2hlY2tlciBkb2VzIG5vdCByZXR1cm4gYW55IGZyYWdtZW50\ncwogICAgICogZnJvbSBhIGNsb3NlZCBsZWRnZXIgd2l0aCAwIGVudHJpZXMu\nCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQgPSAzMDAwKQogICAgcHVibGlj\nIHZvaWQgdGVzdENsb3NlZFNpbmdsZUVudHJ5TGVkZ2VyKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0\nZUxlZGdlcigzLCAyLCBCb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JDMzIsCiAg\nICAgICAgICAgICAgICBURVNUX0xFREdFUl9QQVNTV09SRCk7CiAgICAgICAg\nQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0g\nbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKQogICAgICAgICAgICAuZ2V0RW5zZW1i\nbGVzKCkuZ2V0KDBMKTsKICAgICAgICBsaC5hZGRFbnRyeShURVNUX0xFREdF\nUl9FTlRSWV9EQVRBKTsKICAgICAgICBsaC5jbG9zZSgpOwoKICAgICAgICAv\nLyBraWxsIGJvb2tpZSAyCiAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgbGFz\ndEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0KDIpOwog\nICAgICAgIExPRy5pbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2llRnJvbUVu\nc2VtYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAgICAgICsg\nZmlyc3RFbnNlbWJsZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0Qm9va2ll\nRnJvbUVuc2VtYmxlKTsKCiAgICAgICAgLy9PcGVuIGxlZGdlciBzZXBhcmF0\nZWx5IGZvciBMZWRnZXIgY2hlY2tlci4KICAgICAgICBMZWRnZXJIYW5kbGUg\nbGgxID1ia2Mub3BlbkxlZGdlck5vUmVjb3ZlcnkobGguZ2V0SWQoKSwgQm9v\na0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAgVEVT\nVF9MRURHRVJfUEFTU1dPUkQpOwoKICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21l\nbnQ+IHJlc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZyYWdtZW50cyhsaDEp\nOwogICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUg\nbnVsbCIsIHJlc3VsdCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUaGVyZSBz\naG91bGQgYmUgMCBmcmFnbWVudC4gQnV0IHJldHVybmVkIGZyYWdtZW50cyBh\ncmUgIgogICAgICAgICAgICAgICAgKyByZXN1bHQsIDAsIHJlc3VsdC5zaXpl\nKCkpOwogICAgICAgIGxoMS5jbG9zZSgpOwoKICAgICAgICAvLyBraWxsIGJv\nb2tpZSAxCiAgICAgICAgbGFzdEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0\nRW5zZW1ibGUuZ2V0KDEpOwogICAgICAgIExPRy5pbmZvKCJLaWxsaW5nICIg\nKyBsYXN0Qm9va2llRnJvbUVuc2VtYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIK\nICAgICAgICAgICAgICAgICsgZmlyc3RFbnNlbWJsZSk7CiAgICAgICAga2ls\nbEJvb2tpZShsYXN0Qm9va2llRnJvbUVuc2VtYmxlKTsKICAgICAgICBzdGFy\ndE5ld0Jvb2tpZSgpOwoKICAgICAgICAvL09wZW4gbGVkZ2VyIHNlcGFyYXRl\nbHkgZm9yIExlZGdlciBjaGVja2VyLgogICAgICAgIGxoMSA9YmtjLm9wZW5M\nZWRnZXJOb1JlY292ZXJ5KGxoLmdldElkKCksIEJvb2tLZWVwZXIuRGlnZXN0\nVHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NX\nT1JEKTsKCiAgICAgICAgcmVzdWx0ID0gZ2V0VW5kZXJSZXBsaWNhdGVkRnJh\nZ21lbnRzKGxoMSk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiUmVzdWx0IHNo\nb3VsZG4ndCBiZSBudWxsIiwgcmVzdWx0KTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoIlRoZXJlIHNob3VsZCBiZSAxIGZyYWdtZW50LiBCdXQgcmV0dXJuZWQg\nZnJhZ21lbnRzIGFyZSAiCiAgICAgICAgICAgICAgICArIHJlc3VsdCwgMSwg\ncmVzdWx0LnNpemUoKSk7CiAgICAgICAgbGgxLmNsb3NlKCk7CgogICAgICAg\nIC8vIGtpbGwgYm9va2llIDAKICAgICAgICBsYXN0Qm9va2llRnJvbUVuc2Vt\nYmxlID0gZmlyc3RFbnNlbWJsZS5nZXQoMCk7CiAgICAgICAgTE9HLmluZm8o\nIktpbGxpbmcgIiArIGxhc3RCb29raWVGcm9tRW5zZW1ibGUgKyAiIGZyb20g\nZW5zZW1ibGU9IgogICAgICAgICAgICAgICAgKyBmaXJzdEVuc2VtYmxlKTsK\nICAgICAgICBraWxsQm9va2llKGxhc3RCb29raWVGcm9tRW5zZW1ibGUpOwog\nICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CgogICAgICAgIC8vT3BlbiBsZWRn\nZXIgc2VwYXJhdGVseSBmb3IgTGVkZ2VyIGNoZWNrZXIuCiAgICAgICAgbGgx\nID1ia2Mub3BlbkxlZGdlck5vUmVjb3ZlcnkobGguZ2V0SWQoKSwgQm9va0tl\nZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAgVEVTVF9M\nRURHRVJfUEFTU1dPUkQpOwoKICAgICAgICByZXN1bHQgPSBnZXRVbmRlclJl\ncGxpY2F0ZWRGcmFnbWVudHMobGgxKTsKICAgICAgICBhc3NlcnROb3ROdWxs\nKCJSZXN1bHQgc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQpOwogICAgICAg\nIGFzc2VydEVxdWFscygiVGhlcmUgc2hvdWxkIGJlIDIgZnJhZ21lbnQuIEJ1\ndCByZXR1cm5lZCBmcmFnbWVudHMgYXJlICIKICAgICAgICAgICAgICAgICsg\ncmVzdWx0LCAyLCByZXN1bHQuc2l6ZSgpKTsKICAgICAgICBsaDEuY2xvc2Uo\nKTsKICAgIH0KCiAgICBwcml2YXRlIFNldDxMZWRnZXJGcmFnbWVudD4gZ2V0\nVW5kZXJSZXBsaWNhdGVkRnJhZ21lbnRzKExlZGdlckhhbmRsZSBsaCkKICAg\nICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAg\nICBMZWRnZXJDaGVja2VyIGNoZWNrZXIgPSBuZXcgTGVkZ2VyQ2hlY2tlcihi\na2MpOwogICAgICAgIENoZWNrZXJDYWxsYmFjayBjYiA9IG5ldyBDaGVja2Vy\nQ2FsbGJhY2soKTsKICAgICAgICBjaGVja2VyLmNoZWNrTGVkZ2VyKGxoLCBj\nYik7CiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50PiByZXN1bHQgPSBjYi53\nYWl0QW5kR2V0UmVzdWx0KCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQga2lsbEJvb2tpZShBcnJheUxpc3Q8SW5l\ndFNvY2tldEFkZHJlc3M+IGZpcnN0RW5zZW1ibGUsCiAgICAgICAgICAgIElu\nZXRTb2NrZXRBZGRyZXNzIGVuc2VtYmxlKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBMT0cuaW5mbygiS2lsbGluZyAiICsgZW5zZW1ibGUgKyAiIGZy\nb20gZW5zZW1ibGU9IiArIGZpcnN0RW5zZW1ibGUpOwogICAgICAgIGtpbGxC\nb29raWUoZW5zZW1ibGUpOwogICAgfQoKfQo=\n","encoding":"base64"}

