{"sha":"fbd281b738eaf457421044e46d904b2122e852eb","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmJkMjgxYjczOGVhZjQ1NzQyMTA0NGU0NmQ5MDRiMjEyMmU4NTJlYg==","size":12215,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fbd281b738eaf457421044e46d904b2122e852eb","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG87CgovKgogKgog\nKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24g\nKEFTRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5z\nZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmli\ndXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlv\nbgogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0Yg\nbGljZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hl\nIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91\nIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQog\nKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9m\nIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3Jn\nL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBi\neSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywKICog\nc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlz\ndHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJS\nQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQsIGVpdGhlciBl\neHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQog\nKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKi8KCmlt\ncG9ydCBvcmcuanVuaXQuKjsKaW1wb3J0IGphdmEubmV0LkluZXRTb2NrZXRB\nZGRyZXNzOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0\nb21pY0xvbmc7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMu\nQXRvbWljQm9vbGVhbjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4\nZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93\nbkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7\nCgppbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEuaW8u\nSU9FeGNlcHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNv\nbmYuU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5ib29raWUuQm9va2llOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3Mu\nR2VuZXJpY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5SZWFkRW50cnlD\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Q\nZXJDaGFubmVsQm9va2llQ2xpZW50LkNvbm5lY3Rpb25TdGF0ZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVwZXJDbHVzdGVy\nVGVzdENhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5T\nYWZlUnVubmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRp\nbC5PcmRlcmVkU2FmZUV4ZWN1dG9yOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5\nLmNoYW5uZWwuQ2hhbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5idWZm\nZXIuQ2hhbm5lbEJ1ZmZlcjsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFu\nbmVsLnNvY2tldC5DbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeTsKaW1wb3J0\nIG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLnNvY2tldC5uaW8uTmlvQ2xpZW50\nU29ja2V0Q2hhbm5lbEZhY3Rvcnk7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFRl\nc3RzIGZvciBQZXJDaGFubmVsQm9va2llQ2xpZW50LiBIaXN0b3JpY2FsbHks\nIHRoaXMgY2xhc3MgaGFzCiAqIGhhZCBhIGZldyByYWNlIGNvbmRpdGlvbnMs\nIHNvIHRoaXMgaXMgd2hhdCB0aGVzZSB0ZXN0cyBmb2N1cyBvbi4KICovCnB1\nYmxpYyBjbGFzcyBUZXN0UGVyQ2hhbm5lbEJvb2tpZUNsaWVudCBleHRlbmRz\nIEJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2UgewogICAgc3RhdGljIExvZ2dl\nciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihUZXN0UGVyQ2hhbm5l\nbEJvb2tpZUNsaWVudC5jbGFzcyk7CgogICAgcHVibGljIFRlc3RQZXJDaGFu\nbmVsQm9va2llQ2xpZW50KCkgewogICAgICAgIHN1cGVyKDEpOwogICAgfQoK\nICAgIC8qKgogICAgICogVGVzdCB0aGF0IGEgcmFjZSBkb2VzIG5vdCBleGlz\ndCBiZXR3ZWVuIGNvbm5lY3Rpb24gY29tcGxldGlvbgogICAgICogYW5kIGNs\naWVudCBjbG9zdXJlLiBJZiBhIHJhY2UgZG9lcyBleGlzdCwgdGhpcyB0ZXN0\nIHdpbGwgc2ltcGx5CiAgICAgKiBoYW5nIGF0IHJlbGVhc2VFeHRlcm5hbFJl\nc291cmNlcygpIGFzIGl0IGlzIHVuaW50ZXJydXB0aWJsZS4KICAgICAqIFRo\naXMgc3BlY2lmaWMgcmFjZSB3YXMgZm91bmQgaW4KICAgICAqIHtAbGluayBo\ndHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2ppcmEvYnJvd3NlL0JPT0tLRUVQ\nRVItNDg1fS4KICAgICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAg\nIHB1YmxpYyB2b2lkIHRlc3RDb25uZWN0Q2xvc2VSYWNlKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgQ2xpZW50U29ja2V0Q2hhbm5lbEZhY3Rvcnkg\nY2hhbm5lbEZhY3RvcnkKICAgICAgICAgICAgPSBuZXcgTmlvQ2xpZW50U29j\na2V0Q2hhbm5lbEZhY3RvcnkoRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBv\nb2woKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2woKSk7CiAg\nICAgICAgT3JkZXJlZFNhZmVFeGVjdXRvciBleGVjdXRvciA9IG5ldyBPcmRl\ncmVkU2FmZUV4ZWN1dG9yKDEpOwoKICAgICAgICBJbmV0U29ja2V0QWRkcmVz\ncyBhZGRyID0gZ2V0Qm9va2llKDApOwogICAgICAgIEF0b21pY0xvbmcgYnl0\nZXNPdXRzdGFuZGluZyA9IG5ldyBBdG9taWNMb25nKDApOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgMTAwMDsgaSsrKSB7CiAgICAgICAgICAgIFBl\nckNoYW5uZWxCb29raWVDbGllbnQgY2xpZW50ID0gbmV3IFBlckNoYW5uZWxC\nb29raWVDbGllbnQoZXhlY3V0b3IsIGNoYW5uZWxGYWN0b3J5LAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGFkZHIsIGJ5dGVzT3V0c3RhbmRpbmcpOwog\nICAgICAgICAgICBjbGllbnQuY29ubmVjdElmTmVlZGVkQW5kRG9PcChuZXcg\nR2VuZXJpY0NhbGxiYWNrPFZvaWQ+KCkgewogICAgICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkNvbXBsZXRlKGludCByYywgVm9pZCByZXN1bHQpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZywgd2UgZG9uJ3QgY2Fy\nZSBhYm91dCBkb2luZyBhbnl0aGluZyB3aXRoIHRoZSBjb25uZWN0aW9uLAog\nICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBqdXN0IHdhbnQgdG8gdHJp\nZ2dlciBpdCBjb25uZWN0aW5nLgogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjbGllbnQuY2xvc2UoKTsK\nICAgICAgICB9CiAgICAgICAgY2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVy\nbmFsUmVzb3VyY2VzKCk7CiAgICAgICAgZXhlY3V0b3Iuc2h1dGRvd24oKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgcmFjZSBzY2VuYXJpbyBmb3Vu\nZCBpbiB7QGxpbmsgaHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jy\nb3dzZS9CT09LS0VFUEVSLTV9CiAgICAgKiB3aGVyZSBtdWx0aXBsZSBjbGll\nbnRzIHRyeSB0byBjb25uZWN0IGEgY2hhbm5lbCBzaW11bHRhbmVvdXNseS4g\nSWYgbm90IHN5bmNocm9uaXNlZAogICAgICogY29ycmVjdGx5LCB0aGlzIGNh\ndXNlcyB0aGUgbmV0dHkgY2hhbm5lbCB0byBnZXQgb3JwaGFuZWQuCiAgICAg\nKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0\nZXN0Q29ubmVjdFJhY2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBH\nZW5lcmljQ2FsbGJhY2s8Vm9pZD4gbnVsbG9wID0gbmV3IEdlbmVyaWNDYWxs\nYmFjazxWb2lkPigpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBsZXRlKGludCByYywgVm9p\nZCByZXN1bHQpIHsKICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcsIHdl\nIGRvbid0IGNhcmUgYWJvdXQgZG9pbmcgYW55dGhpbmcgd2l0aCB0aGUgY29u\nbmVjdGlvbiwKICAgICAgICAgICAgICAgIC8vIHdlIGp1c3Qgd2FudCB0byB0\ncmlnZ2VyIGl0IGNvbm5lY3RpbmcuCiAgICAgICAgICAgIH0KICAgICAgICB9\nOwogICAgICAgIENsaWVudFNvY2tldENoYW5uZWxGYWN0b3J5IGNoYW5uZWxG\nYWN0b3J5CiAgICAgICAgICAgID0gbmV3IE5pb0NsaWVudFNvY2tldENoYW5u\nZWxGYWN0b3J5KEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCksCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCkpOwogICAgICAgIE9y\nZGVyZWRTYWZlRXhlY3V0b3IgZXhlY3V0b3IgPSBuZXcgT3JkZXJlZFNhZmVF\neGVjdXRvcigxKTsKCiAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgYWRkciA9\nIGdldEJvb2tpZSgwKTsKICAgICAgICBBdG9taWNMb25nIGJ5dGVzT3V0c3Rh\nbmRpbmcgPSBuZXcgQXRvbWljTG9uZygwKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IDEwMDsgaSsrKSB7CiAgICAgICAgICAgIFBlckNoYW5uZWxC\nb29raWVDbGllbnQgY2xpZW50ID0gbmV3IFBlckNoYW5uZWxCb29raWVDbGll\nbnQoZXhlY3V0b3IsIGNoYW5uZWxGYWN0b3J5LAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGFkZHIsIGJ5dGVzT3V0c3RhbmRpbmcpOwogICAgICAgICAg\nICBmb3IgKGludCBqID0gaTsgaiA8IDEwOyBqKyspIHsKICAgICAgICAgICAg\nICAgIGNsaWVudC5jb25uZWN0SWZOZWVkZWRBbmREb09wKG51bGxvcCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAg\nICAgfQogICAgICAgIGNoYW5uZWxGYWN0b3J5LnJlbGVhc2VFeHRlcm5hbFJl\nc291cmNlcygpOwogICAgICAgIGV4ZWN1dG9yLnNodXRkb3duKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgYWxsIHJlc291cmNlcyBhcmUg\nZnJlZWQgaWYgY29ubmVjdGlvbnMgYW5kIGRpc2Nvbm5lY3Rpb25zCiAgICAg\nKiBhcmUgaW50ZXJsZWF2ZWQgcmFuZG9tbHkuCiAgICAgKgogICAgICoge0Bs\naW5rIGh0dHBzOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvQk9P\nS0tFRVBFUi02MjB9CiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDAp\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGlzY29ubmVjdFJhY2UoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBHZW5lcmljQ2FsbGJhY2s8Vm9p\nZD4gbnVsbG9wID0gbmV3IEdlbmVyaWNDYWxsYmFjazxWb2lkPigpIHsKICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkNvbXBsZXRlKGludCByYywgVm9pZCByZXN1bHQpIHsKICAgICAg\nICAgICAgICAgIC8vIGRvIG5vdGhpbmcsIHdlIGRvbid0IGNhcmUgYWJvdXQg\nZG9pbmcgYW55dGhpbmcgd2l0aCB0aGUgY29ubmVjdGlvbiwKICAgICAgICAg\nICAgICAgIC8vIHdlIGp1c3Qgd2FudCB0byB0cmlnZ2VyIGl0IGNvbm5lY3Rp\nbmcuCiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGZpbmFsIGlu\ndCBJVEVSQVRJT05TID0gMTAwMDAwOwogICAgICAgIENsaWVudFNvY2tldENo\nYW5uZWxGYWN0b3J5IGNoYW5uZWxGYWN0b3J5CiAgICAgICAgICAgID0gbmV3\nIE5pb0NsaWVudFNvY2tldENoYW5uZWxGYWN0b3J5KEV4ZWN1dG9ycy5uZXdD\nYWNoZWRUaHJlYWRQb29sKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJl\nYWRQb29sKCkpOwogICAgICAgIE9yZGVyZWRTYWZlRXhlY3V0b3IgZXhlY3V0\nb3IgPSBuZXcgT3JkZXJlZFNhZmVFeGVjdXRvcigxKTsKICAgICAgICBJbmV0\nU29ja2V0QWRkcmVzcyBhZGRyID0gZ2V0Qm9va2llKDApOwoKICAgICAgICBB\ndG9taWNMb25nIGJ5dGVzT3V0c3RhbmRpbmcgPSBuZXcgQXRvbWljTG9uZygw\nKTsKICAgICAgICBmaW5hbCBQZXJDaGFubmVsQm9va2llQ2xpZW50IGNsaWVu\ndCA9IG5ldyBQZXJDaGFubmVsQm9va2llQ2xpZW50KGV4ZWN1dG9yLAogICAg\nICAgICAgICAgICAgY2hhbm5lbEZhY3RvcnksIGFkZHIsIGJ5dGVzT3V0c3Rh\nbmRpbmcpOwogICAgICAgIGZpbmFsIEF0b21pY0Jvb2xlYW4gc2hvdWxkRmFp\nbCA9IG5ldyBBdG9taWNCb29sZWFuKGZhbHNlKTsKICAgICAgICBmaW5hbCBB\ndG9taWNCb29sZWFuIHJ1bm5pbmcgPSBuZXcgQXRvbWljQm9vbGVhbih0cnVl\nKTsKICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBkaXNjb25uZWN0UnVu\nbmluZyA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICBUaHJlYWQg\nY29ubmVjdFRocmVhZCA9IG5ldyBUaHJlYWQoKSB7CiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkaXNjb25uZWN0UnVu\nbmluZy5hd2FpdCgxMCwgVGltZVVuaXQuU0VDT05EUykpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRGlzY29ubmVjdCB0aHJl\nYWQgbmV2ZXIgc3RhcnRlZCIpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgc2hvdWxkRmFpbC5zZXQodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cu\nZXJyb3IoIkNvbm5lY3QgdGhyZWFkIGludGVycnVwdGVkIiwgaWUpOwogICAg\nICAgICAgICAgICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmlu\ndGVycnVwdCgpOwogICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nLnNl\ndChmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgSVRFUkFUSU9OUyAmJiBydW5u\naW5nLmdldCgpOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xp\nZW50LmNvbm5lY3RJZk5lZWRlZEFuZERvT3AobnVsbG9wKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcnVubmluZy5zZXQo\nZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAg\nICAgIFRocmVhZCBkaXNjb25uZWN0VGhyZWFkID0gbmV3IFRocmVhZCgpIHsK\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAg\nICAgICAgICAgICBkaXNjb25uZWN0UnVubmluZy5jb3VudERvd24oKTsKICAg\nICAgICAgICAgICAgICAgICB3aGlsZSAocnVubmluZy5nZXQoKSkgewogICAg\nICAgICAgICAgICAgICAgICAgICBjbGllbnQuZGlzY29ubmVjdCgpOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfTsKICAgICAgICBUaHJlYWQgY2hlY2tUaHJlYWQgPSBuZXcgVGhyZWFk\nKCkgewogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAg\nICAgICAgICAgICAgICAgIENvbm5lY3Rpb25TdGF0ZSBzdGF0ZTsKICAgICAg\nICAgICAgICAgICAgICBDaGFubmVsIGNoYW5uZWw7CiAgICAgICAgICAgICAg\nICAgICAgd2hpbGUgKHJ1bm5pbmcuZ2V0KCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgc3luY2hyb25pemVkIChjbGllbnQpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHN0YXRlID0gY2xpZW50LnN0YXRlOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCA9IGNsaWVudC5jaGFubmVs\nOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoc3RhdGUgPT0g\nQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RFRAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAmJiAoY2hhbm5lbCA9PSBudWxsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAhY2hhbm5lbC5pc0Nvbm5l\nY3RlZCgpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAo\nc3RhdGUgIT0gQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RFRAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBjaGFubmVsICE9IG51bGwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgY2hhbm5l\nbC5pc0Nvbm5lY3RlZCgpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiU3RhdGUoe30pIGFuZCBjaGFubmVsKHt9KSBp\nbmNvbnNpc3RlbnQgIiArIGNoYW5uZWwsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLCBjaGFubmVsID09IG51bGwg\nPyBudWxsIDogY2hhbm5lbC5pc0Nvbm5lY3RlZCgpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBzaG91bGRGYWlsLnNldCh0cnVlKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nLnNldChmYWxz\nZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgY29ubmVjdFRocmVh\nZC5zdGFydCgpOwogICAgICAgIGRpc2Nvbm5lY3RUaHJlYWQuc3RhcnQoKTsK\nICAgICAgICBjaGVja1RocmVhZC5zdGFydCgpOwoKICAgICAgICBjb25uZWN0\nVGhyZWFkLmpvaW4oKTsKICAgICAgICBkaXNjb25uZWN0VGhyZWFkLmpvaW4o\nKTsKICAgICAgICBjaGVja1RocmVhZC5qb2luKCk7CiAgICAgICAgYXNzZXJ0\nRmFsc2UoIkZhaWx1cmUgaW4gdGhyZWFkcywgY2hlY2sgbG9ncyIsIHNob3Vs\nZEZhaWwuZ2V0KCkpOwogICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgICAg\nIGNoYW5uZWxGYWN0b3J5LnJlbGVhc2VFeHRlcm5hbFJlc291cmNlcygpOwog\nICAgICAgIGV4ZWN1dG9yLnNodXRkb3duKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUZXN0IHRoYXQgcmVxdWVzdHMgYXJlIGNvbXBsZXRlZCBldmVuIGlm\nIHRoZSBjaGFubmVsIGlzIGRpc2Nvbm5lY3RlZAogICAgICoge0BsaW5rIGh0\ndHBzOi8vaXNzdWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvQk9PS0tFRVBF\nUi02Njh9CiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0UmVxdWVzdENvbXBsZXRlc0FmdGVyRGlzY29ubmVj\ndFJhY2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTZXJ2ZXJDb25m\naWd1cmF0aW9uIGNvbmYgPSBraWxsQm9va2llKDApOwoKICAgICAgICBCb29r\naWUgZGVsYXlCb29raWUgPSBuZXcgQm9va2llKGNvbmYpIHsKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyBCeXRlQnVmZmVyIHJl\nYWRFbnRyeShsb25nIGxlZGdlcklkLCBsb25nIGVudHJ5SWQpCiAgICAgICAg\nICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBOb0xlZGdlckV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIFRocmVhZC5zbGVlcCgzMDAwKTsKICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJJbnRlcnJ1cHRlZCB3YWl0\naW5nIiwgaWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\ncmV0dXJuIHN1cGVyLnJlYWRFbnRyeShsZWRnZXJJZCwgZW50cnlJZCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGJzQ29uZnMuYWRkKGNv\nbmYpOwogICAgICAgIGJzLmFkZChzdGFydEJvb2tpZShjb25mLCBkZWxheUJv\nb2tpZSkpOwoKICAgICAgICBDbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeSBj\naGFubmVsRmFjdG9yeQogICAgICAgICAgICA9IG5ldyBOaW9DbGllbnRTb2Nr\nZXRDaGFubmVsRmFjdG9yeShFeGVjdXRvcnMubmV3Q2FjaGVkVGhyZWFkUG9v\nbCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBFeGVjdXRvcnMubmV3Q2FjaGVkVGhyZWFkUG9vbCgpKTsKICAg\nICAgICBmaW5hbCBPcmRlcmVkU2FmZUV4ZWN1dG9yIGV4ZWN1dG9yID0gbmV3\nIE9yZGVyZWRTYWZlRXhlY3V0b3IoMSk7CiAgICAgICAgSW5ldFNvY2tldEFk\nZHJlc3MgYWRkciA9IGdldEJvb2tpZSgwKTsKICAgICAgICBBdG9taWNMb25n\nIGJ5dGVzT3V0c3RhbmRpbmcgPSBuZXcgQXRvbWljTG9uZygwKTsKCiAgICAg\nICAgZmluYWwgUGVyQ2hhbm5lbEJvb2tpZUNsaWVudCBjbGllbnQgPSBuZXcg\nUGVyQ2hhbm5lbEJvb2tpZUNsaWVudChleGVjdXRvciwgY2hhbm5lbEZhY3Rv\ncnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyLCBieXRlc091\ndHN0YW5kaW5nKTsKICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBjb21w\nbGV0aW9uID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgIGZpbmFs\nIFJlYWRFbnRyeUNhbGxiYWNrIGNiID0gbmV3IFJlYWRFbnRyeUNhbGxiYWNr\nKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCByZWFkRW50cnlDb21wbGV0ZShpbnQgcmMsIGxvbmcg\nbGVkZ2VySWQsIGxvbmcgZW50cnlJZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIENoYW5uZWxCdWZmZXIgYnVmZmVy\nLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgY29tcGxldGlv\nbi5jb3VudERvd24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfTsKCiAgICAgICAgY2xpZW50LmNvbm5lY3RJZk5lZWRlZEFuZERvT3AobmV3\nIEdlbmVyaWNDYWxsYmFjazxWb2lkPigpIHsKICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBsZXRl\nKGZpbmFsIGludCByYywgVm9pZCByZXN1bHQpIHsKICAgICAgICAgICAgICAg\nIGlmIChyYyAhPSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAg\nICAgICAgICAgZXhlY3V0b3Iuc3VibWl0T3JkZXJlZCgxLCBuZXcgU2FmZVJ1\nbm5hYmxlKCkgewogICAgICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVJ1bigp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNiLnJlYWRFbnRyeUNv\nbXBsZXRlKHJjLCAxLCAxLCBudWxsLCBudWxsKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgICAgICBjbGllbnQucmVhZEVudHJ5QW5kRmVuY2VMZWRnZXIoMSwgIjAw\nMDAwMTExMTEyMjIyMjMzMzMzIi5nZXRCeXRlcygpLCAxLCBjYiwgbnVsbCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgVGhyZWFkLnNs\nZWVwKDEwMDApOwogICAgICAgIGNsaWVudC5kaXNjb25uZWN0KCk7CiAgICAg\nICAgY2xpZW50LmNsb3NlKCk7CiAgICAgICAgY2hhbm5lbEZhY3RvcnkucmVs\nZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7CiAgICAgICAgZXhlY3V0b3Iuc2h1\ndGRvd24oKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZSgiUmVxdWVzdCBzaG91bGQg\naGF2ZSBjb21wbGV0ZWQiLCBjb21wbGV0aW9uLmF3YWl0KDUsIFRpbWVVbml0\nLlNFQ09ORFMpKTsKICAgIH0KfQo=\n","encoding":"base64"}

