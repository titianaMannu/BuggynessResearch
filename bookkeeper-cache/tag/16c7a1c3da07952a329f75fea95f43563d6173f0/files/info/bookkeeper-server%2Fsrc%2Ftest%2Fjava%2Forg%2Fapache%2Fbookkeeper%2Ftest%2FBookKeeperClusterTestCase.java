{"sha":"cec07d71b0d72df986f673b89689b8ad5402d8b1","node_id":"MDQ6QmxvYjE1NzU5NTY6Y2VjMDdkNzFiMGQ3MmRmOTg2ZjY3M2I4OTY4OWI4YWQ1NDAyZDhiMQ==","size":18084,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/cec07d71b0d72df986f673b89689b8ad5402d8b1","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247\nCmltcG9ydCBqYXZhLm5ldC5JbmV0QWRkcmVzczsKaW1wb3J0IGphdmEubmV0\nLkluZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7\nCmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5NYXAuRW50cnk7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3Vu\ndERvd25MYXRjaDsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7\nCgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5Cb29raWU7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tpZUV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQu\nQm9va0tlZXBlclRlc3RDbGllbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY29uZi5BYnN0cmFjdENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhc3Rv\ncmUuSW5NZW1vcnlNZXRhU3RvcmU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2llU2VydmVyOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnJlcGxpY2F0aW9uLkF1dG9SZWNvdmVyeU1haW47CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb24uUmVwbGljYXRp\nb25FeGNlcHRpb24uQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlvbi5SZXBsaWNhdGlvbkV4\nY2VwdGlvbi5VbmF2YWlsYWJsZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5pby5GaWxlVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7Cmlt\ncG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIEEg\nY2xhc3MgcnVucyBzZXZlcmFsIGJvb2tpZSBzZXJ2ZXJzIGZvciB0ZXN0aW5n\nLgogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEJvb2tLZWVwZXJDbHVzdGVy\nVGVzdENhc2UgZXh0ZW5kcyBUZXN0Q2FzZSB7CgogICAgc3RhdGljIGZpbmFs\nIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihCb29rS2Vl\ncGVyQ2x1c3RlclRlc3RDYXNlLmNsYXNzKTsKCiAgICAvLyBab29LZWVwZXIg\ncmVsYXRlZCB2YXJpYWJsZXMKICAgIHByb3RlY3RlZCBab29LZWVwZXJVdGls\nIHprVXRpbCA9IG5ldyBab29LZWVwZXJVdGlsKCk7CiAgICBwcm90ZWN0ZWQg\nWm9vS2VlcGVyIHprYzsKCiAgICAvLyBCb29rS2VlcGVyIHJlbGF0ZWQgdmFy\naWFibGVzCiAgICBwcm90ZWN0ZWQgTGlzdDxGaWxlPiB0bXBEaXJzID0gbmV3\nIExpbmtlZExpc3Q8RmlsZT4oKTsKICAgIHByb3RlY3RlZCBMaXN0PEJvb2tp\nZVNlcnZlcj4gYnMgPSBuZXcgTGlua2VkTGlzdDxCb29raWVTZXJ2ZXI+KCk7\nCiAgICBwcm90ZWN0ZWQgTGlzdDxTZXJ2ZXJDb25maWd1cmF0aW9uPiBic0Nv\nbmZzID0gbmV3IExpbmtlZExpc3Q8U2VydmVyQ29uZmlndXJhdGlvbj4oKTsK\nICAgIHByb3RlY3RlZCBpbnQgbnVtQm9va2llczsKICAgIHByb3RlY3RlZCBC\nb29rS2VlcGVyVGVzdENsaWVudCBia2M7CgogICAgcHJvdGVjdGVkIFNlcnZl\nckNvbmZpZ3VyYXRpb24gYmFzZUNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJh\ndGlvbigpOwogICAgcHJvdGVjdGVkIENsaWVudENvbmZpZ3VyYXRpb24gYmFz\nZUNsaWVudENvbmYgPSBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpOwoKICAg\nIHByaXZhdGUgTWFwPEJvb2tpZVNlcnZlciwgQXV0b1JlY292ZXJ5TWFpbj4g\nYXV0b1JlY292ZXJ5UHJvY2Vzc2VzID0gbmV3IEhhc2hNYXA8Qm9va2llU2Vy\ndmVyLCBBdXRvUmVjb3ZlcnlNYWluPigpOwoKICAgIHByaXZhdGUgYm9vbGVh\nbiBpc0F1dG9SZWNvdmVyeUVuYWJsZWQ7CgogICAgcHVibGljIEJvb2tLZWVw\nZXJDbHVzdGVyVGVzdENhc2UoaW50IG51bUJvb2tpZXMpIHsKICAgICAgICB0\naGlzLm51bUJvb2tpZXMgPSBudW1Cb29raWVzOwogICAgfQoKICAgIEBCZWZv\ncmUKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBMT0cuaW5mbygiU2V0dGluZyB1cCB0\nZXN0IHt9IiwgZ2V0TmFtZSgpKTsKICAgICAgICBJbk1lbW9yeU1ldGFTdG9y\nZS5yZXNldCgpOwogICAgICAgIHNldE1ldGFzdG9yZUltcGxDbGFzcyhiYXNl\nQ29uZik7CiAgICAgICAgc2V0TWV0YXN0b3JlSW1wbENsYXNzKGJhc2VDbGll\nbnRDb25mKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gc3RhcnQg\nem9va2VlcGVyIHNlcnZpY2UKICAgICAgICAgICAgc3RhcnRaS0NsdXN0ZXIo\nKTsKICAgICAgICAgICAgLy8gc3RhcnQgYm9va2tlZXBlciBzZXJ2aWNlCiAg\nICAgICAgICAgIHN0YXJ0QktDbHVzdGVyKCk7CiAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJvciBz\nZXR0aW5nIHVwIiwgZSk7CiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAg\nfQogICAgfQoKICAgIEBBZnRlcgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExP\nRy5pbmZvKCJUZWFyRG93biIpOwogICAgICAgIC8vIHN0b3AgYm9va2tlZXBl\nciBzZXJ2aWNlCiAgICAgICAgc3RvcEJLQ2x1c3RlcigpOwogICAgICAgIC8v\nIHN0b3Agem9va2VlcGVyIHNlcnZpY2UKICAgICAgICBzdG9wWktDbHVzdGVy\nKCk7CiAgICAgICAgTE9HLmluZm8oIlRlYXJpbmcgZG93biB0ZXN0IHt9Iiwg\nZ2V0TmFtZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXJ0IHpvb2tl\nZXBlciBjbHVzdGVyCiAgICAgKgogICAgICogQHRocm93cyBFeGNlcHRpb24K\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRaS0NsdXN0ZXIoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB6a1V0aWwuc3RhcnRTZXJ2ZXIo\nKTsKICAgICAgICB6a2MgPSB6a1V0aWwuZ2V0Wm9vS2VlcGVyQ2xpZW50KCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9wIHpvb2tlZXBlciBjbHVzdGVy\nCiAgICAgKgogICAgICogQHRocm93cyBFeGNlcHRpb24KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgc3RvcFpLQ2x1c3RlcigpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIHprVXRpbC5raWxsU2VydmVyKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTdGFydCBjbHVzdGVyLiBBbHNvLCBzdGFydHMgdGhlIGF1\ndG8gcmVjb3ZlcnkgcHJvY2VzcyBmb3IgZWFjaCBib29raWUsIGlmCiAgICAg\nKiBpc0F1dG9SZWNvdmVyeUVuYWJsZWQgaXMgdHJ1ZS4KICAgICAqCiAgICAg\nKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzdGFydEJLQ2x1c3RlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIGJhc2VDbGllbnRDb25mLnNldFprU2VydmVycyh6a1V0aWwuZ2V0Wm9vS2Vl\ncGVyQ29ubmVjdFN0cmluZygpKTsKICAgICAgICBpZiAobnVtQm9va2llcyA+\nIDApIHsKICAgICAgICAgICAgYmtjID0gbmV3IEJvb2tLZWVwZXJUZXN0Q2xp\nZW50KGJhc2VDbGllbnRDb25mKTsKICAgICAgICB9CgogICAgICAgIC8vIENy\nZWF0ZSBCb29raWUgU2VydmVycyAoQjEsIEIyLCBCMykKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IG51bUJvb2tpZXM7IGkrKykgewogICAgICAgICAg\nICBzdGFydE5ld0Jvb2tpZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFN0b3AgY2x1c3Rlci4gQWxzbywgc3RvcHMgYWxsIHRoZSBhdXRv\nIHJlY292ZXJ5IHByb2Nlc3NlcyBmb3IgdGhlIGJvb2tpZQogICAgICogY2x1\nc3RlciwgaWYgaXNBdXRvUmVjb3ZlcnlFbmFibGVkIGlzIHRydWUuCiAgICAg\nKgogICAgICogQHRocm93cyBFeGNlcHRpb24KICAgICAqLwogICAgcHJvdGVj\ndGVkIHZvaWQgc3RvcEJLQ2x1c3RlcigpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGlmIChia2MgIT0gbnVsbCkgewogICAgICAgICAgICBia2MuY2xv\nc2UoKTs7CiAgICAgICAgfQoKICAgICAgICBmb3IgKEJvb2tpZVNlcnZlciBz\nZXJ2ZXIgOiBicykgewogICAgICAgICAgICBzZXJ2ZXIuc2h1dGRvd24oKTsK\nICAgICAgICAgICAgQXV0b1JlY292ZXJ5TWFpbiBhdXRvUmVjb3ZlcnkgPSBh\ndXRvUmVjb3ZlcnlQcm9jZXNzZXMuZ2V0KHNlcnZlcik7CiAgICAgICAgICAg\nIGlmIChhdXRvUmVjb3ZlcnkgIT0gbnVsbCAmJiBpc0F1dG9SZWNvdmVyeUVu\nYWJsZWQoKSkgewogICAgICAgICAgICAgICAgYXV0b1JlY292ZXJ5LnNodXRk\nb3duKCk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoIlNodXRkb3duIGF1\ndG8gcmVjb3ZlcnkgZm9yIGJvb2tpZXNlcnZlcjoiCiAgICAgICAgICAgICAg\nICAgICAgICAgICsgc2VydmVyLmdldExvY2FsQWRkcmVzcygpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICBicy5jbGVhcigpOwogICAgICAg\nIGZvciAoRmlsZSBmIDogdG1wRGlycykgewogICAgICAgICAgICBGaWxlVXRp\nbHMuZGVsZXRlRGlyZWN0b3J5KGYpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncm90ZWN0ZWQgU2VydmVyQ29uZmlndXJhdGlvbiBuZXdTZXJ2ZXJDb25maWd1\ncmF0aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgRmlsZSBmID0g\nRmlsZS5jcmVhdGVUZW1wRmlsZSgiYm9va2llIiwgInRlc3QiKTsKICAgICAg\nICB0bXBEaXJzLmFkZChmKTsKICAgICAgICBmLmRlbGV0ZSgpOwogICAgICAg\nIGYubWtkaXIoKTsKCiAgICAgICAgaW50IHBvcnQgPSBQb3J0TWFuYWdlci5u\nZXh0RnJlZVBvcnQoKTsKICAgICAgICByZXR1cm4gbmV3U2VydmVyQ29uZmln\ndXJhdGlvbihwb3J0LCB6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmlu\nZygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYs\nIG5ldyBGaWxlW10geyBmIH0pOwogICAgfQoKICAgIHByb3RlY3RlZCBTZXJ2\nZXJDb25maWd1cmF0aW9uIG5ld1NlcnZlckNvbmZpZ3VyYXRpb24oaW50IHBv\ncnQsIFN0cmluZyB6a1NlcnZlcnMsIEZpbGUgam91cm5hbERpciwgRmlsZVtd\nIGxlZGdlckRpcnMpIHsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNv\nbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbihiYXNlQ29uZik7CiAgICAg\nICAgY29uZi5zZXRCb29raWVQb3J0KHBvcnQpOwogICAgICAgIGNvbmYuc2V0\nWmtTZXJ2ZXJzKHprU2VydmVycyk7CiAgICAgICAgY29uZi5zZXRKb3VybmFs\nRGlyTmFtZShqb3VybmFsRGlyLmdldFBhdGgoKSk7CiAgICAgICAgY29uZi5z\nZXRBbGxvd0xvb3BiYWNrKHRydWUpOwogICAgICAgIFN0cmluZ1tdIGxlZGdl\nckRpck5hbWVzID0gbmV3IFN0cmluZ1tsZWRnZXJEaXJzLmxlbmd0aF07CiAg\nICAgICAgZm9yIChpbnQgaT0wOyBpPGxlZGdlckRpcnMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgbGVkZ2VyRGlyTmFtZXNbaV0gPSBsZWRnZXJEaXJz\nW2ldLmdldFBhdGgoKTsKICAgICAgICB9CiAgICAgICAgY29uZi5zZXRMZWRn\nZXJEaXJOYW1lcyhsZWRnZXJEaXJOYW1lcyk7CiAgICAgICAgcmV0dXJuIGNv\nbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgYm9va2llIGFkZHJlc3Mg\nZm9yIGJvb2tpZSBhdCBpbmRleAogICAgICovCiAgICBwdWJsaWMgSW5ldFNv\nY2tldEFkZHJlc3MgZ2V0Qm9va2llKGludCBpbmRleCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKGJzLnNpemUoKSA8PSBpbmRleCB8fCBpbmRl\neCA8IDApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVu\ndEV4Y2VwdGlvbigiSW52YWxpZCBpbmRleCwgdGhlcmUgYXJlIG9ubHkgIiAr\nIGJzLnNpemUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICsgIiBib29raWVzLiBBc2tlZCBmb3IgIiArIGluZGV4\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJzLmdldChpbmRleCkuZ2V0\nTG9jYWxBZGRyZXNzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBLaWxsIGEg\nYm9va2llIGJ5IGl0cyBzb2NrZXQgYWRkcmVzcy4gQWxzbywgc3RvcHMgdGhl\nIGF1dG9yZWNvdmVyeSBwcm9jZXNzCiAgICAgKiBmb3IgdGhlIGNvcnJlc3Bv\nbmRpbmcgYm9va2llIHNlcnZlciwgaWYgaXNBdXRvUmVjb3ZlcnlFbmFibGVk\nIGlzIHRydWUuCiAgICAgKgogICAgICogQHBhcmFtIGFkZHIKICAgICAqICAg\nICAgICAgICAgU29ja2V0IEFkZHJlc3MKICAgICAqIEByZXR1cm4gdGhlIGNv\nbmZpZ3VyYXRpb24gb2Yga2lsbGVkIGJvb2tpZQogICAgICogQHRocm93cyBJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgU2VydmVy\nQ29uZmlndXJhdGlvbiBraWxsQm9va2llKEluZXRTb2NrZXRBZGRyZXNzIGFk\nZHIpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNlcnZlciB0\nb1JlbW92ZSA9IG51bGw7CiAgICAgICAgaW50IHRvUmVtb3ZlSW5kZXggPSAw\nOwogICAgICAgIGZvciAoQm9va2llU2VydmVyIHNlcnZlciA6IGJzKSB7CiAg\nICAgICAgICAgIGlmIChzZXJ2ZXIuZ2V0TG9jYWxBZGRyZXNzKCkuZXF1YWxz\nKGFkZHIpKSB7CiAgICAgICAgICAgICAgICBzZXJ2ZXIuc2h1dGRvd24oKTsK\nICAgICAgICAgICAgICAgIHRvUmVtb3ZlID0gc2VydmVyOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgKyt0b1Jl\nbW92ZUluZGV4OwogICAgICAgIH0KICAgICAgICBpZiAodG9SZW1vdmUgIT0g\nbnVsbCkgewogICAgICAgICAgICBzdG9wQXV0b1JlY292ZXJ5U2VydmljZSh0\nb1JlbW92ZSk7CiAgICAgICAgICAgIGJzLnJlbW92ZSh0b1JlbW92ZSk7CiAg\nICAgICAgICAgIHJldHVybiBic0NvbmZzLnJlbW92ZSh0b1JlbW92ZUluZGV4\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBLaWxsIGEgYm9va2llIGJ5IGluZGV4LiBBbHNvLCBzdG9w\ncyB0aGUgcmVzcGVjdGl2ZSBhdXRvIHJlY292ZXJ5IHByb2Nlc3MKICAgICAq\nIGZvciB0aGlzIGJvb2tpZSwgaWYgaXNBdXRvUmVjb3ZlcnlFbmFibGVkIGlz\nIHRydWUuCiAgICAgKgogICAgICogQHBhcmFtIGluZGV4CiAgICAgKiAgICAg\nICAgICAgIEJvb2tpZSBJbmRleAogICAgICogQHJldHVybiB0aGUgY29uZmln\ndXJhdGlvbiBvZiBraWxsZWQgYm9va2llCiAgICAgKiBAdGhyb3dzIEludGVy\ncnVwdGVkRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAg\nICAgKi8KICAgIHB1YmxpYyBTZXJ2ZXJDb25maWd1cmF0aW9uIGtpbGxCb29r\naWUoaW50IGluZGV4KSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\naW5kZXggPj0gYnMuc2l6ZSgpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbigiQm9va2llIGRvZXMgbm90IGV4aXN0Iik7CiAgICAgICAg\nfQogICAgICAgIEJvb2tpZVNlcnZlciBzZXJ2ZXIgPSBicy5nZXQoaW5kZXgp\nOwogICAgICAgIHNlcnZlci5zaHV0ZG93bigpOwogICAgICAgIHN0b3BBdXRv\nUmVjb3ZlcnlTZXJ2aWNlKHNlcnZlcik7CiAgICAgICAgYnMucmVtb3ZlKHNl\ncnZlcik7CiAgICAgICAgcmV0dXJuIGJzQ29uZnMucmVtb3ZlKGluZGV4KTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNsZWVwIGEgYm9va2llCiAgICAgKgog\nICAgICogQHBhcmFtIGFkZHIKICAgICAqICAgICAgICAgIFNvY2tldCBBZGRy\nZXNzCiAgICAgKiBAcGFyYW0gc2Vjb25kcwogICAgICogICAgICAgICAgU2xl\nZXAgc2Vjb25kcwogICAgICogQHJldHVybiBDb3VudCBEb3duIGxhdGNoIHdo\naWNoIHdpbGwgYmUgY291bnRlZCBkb3duIHdoZW4gc2xlZXAgZmluaXNoZXMK\nICAgICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqIEB0\naHJvd3MgSU9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIENvdW50RG93\nbkxhdGNoIHNsZWVwQm9va2llKEluZXRTb2NrZXRBZGRyZXNzIGFkZHIsIGZp\nbmFsIGludCBzZWNvbmRzKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBmb3IgKGZpbmFsIEJvb2tpZVNlcnZlciBib29raWUgOiBi\ncykgewogICAgICAgICAgICBpZiAoYm9va2llLmdldExvY2FsQWRkcmVzcygp\nLmVxdWFscyhhZGRyKSkgewogICAgICAgICAgICAgICAgZmluYWwgQ291bnRE\nb3duTGF0Y2ggbCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICAg\nICAgICAgIFRocmVhZCBzbGVlcGVyID0gbmV3IFRocmVhZCgpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgYm9va2llLnN1c3BlbmRQcm9jZXNzaW5nKCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgbC5jb3VudERvd24oKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBUaHJlYWQuc2xlZXAoc2Vjb25kcyoxMDAw\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29raWUucmVz\ndW1lUHJvY2Vzc2luZygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHN1c3BlbmRpbmcgYm9va2ll\nIiwgZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAg\nICAgICAgICAgICAgc2xlZXBlci5zdGFydCgpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhy\nb3cgbmV3IElPRXhjZXB0aW9uKCJCb29raWUgbm90IGZvdW5kIik7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTbGVlcCBhIGJvb2tpZSB1bnRpbCBJIGNvdW50\nIGRvd24gdGhlIGxhdGNoCiAgICAgKgogICAgICogQHBhcmFtIGFkZHIKICAg\nICAqICAgICAgICAgIFNvY2tldCBBZGRyZXNzCiAgICAgKiBAcGFyYW0gbGF0\nY2gKICAgICAqICAgICAgICAgIExhdGNoIHRvIHdhaXQgb24KICAgICAqIEB0\naHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqIEB0aHJvd3MgSU9F\neGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQgc2xlZXBCb29raWUo\nSW5ldFNvY2tldEFkZHJlc3MgYWRkciwgZmluYWwgQ291bnREb3duTGF0Y2gg\nbCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZm9y\nIChmaW5hbCBCb29raWVTZXJ2ZXIgYm9va2llIDogYnMpIHsKICAgICAgICAg\nICAgaWYgKGJvb2tpZS5nZXRMb2NhbEFkZHJlc3MoKS5lcXVhbHMoYWRkcikp\nIHsKICAgICAgICAgICAgICAgIFRocmVhZCBzbGVlcGVyID0gbmV3IFRocmVh\nZCgpIHsKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBib29raWUuc3VzcGVuZFByb2Nlc3NpbmcoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGwuYXdhaXQoKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGJvb2tpZS5yZXN1bWVQcm9jZXNzaW5nKCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVy\ncm9yIHN1c3BlbmRpbmcgYm9va2llIiwgZSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9OwogICAgICAgICAgICAgICAgc2xlZXBlci5zdGFydCgpOwogICAgICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiQm9va2llIG5vdCBmb3VuZCIp\nOwogICAgfQoKICAgIC8qKgogICAgICogUmVzdGFydCBib29raWUgc2VydmVy\ncy4gQWxzbyByZXN0YXJ0cyBhbGwgdGhlIHJlc3BlY3RpdmUgYXV0byByZWNv\ndmVyeQogICAgICogcHJvY2VzcywgaWYgaXNBdXRvUmVjb3ZlcnlFbmFibGVk\nIGlzIHRydWUuCiAgICAgKgogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbgogICAgICogQHRocm93cyBJT0V4Y2VwdGlvbgogICAgICogQHRo\ncm93cyBLZWVwZXJFeGNlcHRpb24KICAgICAqIEB0aHJvd3MgQm9va2llRXhj\nZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHJlc3RhcnRCb29raWVz\nKCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgcmVz\ndGFydEJvb2tpZXMobnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXN0\nYXJ0IGJvb2tpZSBzZXJ2ZXJzIHVzaW5nIG5ldyBjb25maWd1cmF0aW9uIHNl\ndHRpbmdzLiBBbHNvIHJlc3RhcnQgdGhlCiAgICAgKiByZXNwZWN0aXZlIGF1\ndG8gcmVjb3ZlcnkgcHJvY2VzcywgaWYgaXNBdXRvUmVjb3ZlcnlFbmFibGVk\nIGlzIHRydWUuCiAgICAgKgogICAgICogQHBhcmFtIG5ld0NvbmYKICAgICAq\nICAgICAgICAgICAgTmV3IENvbmZpZ3VyYXRpb24gU2V0dGluZ3MKICAgICAq\nIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqIEB0aHJvd3Mg\nSU9FeGNlcHRpb24KICAgICAqIEB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uCiAg\nICAgKiBAdGhyb3dzIEJvb2tpZUV4Y2VwdGlvbgogICAgICovCiAgICBwdWJs\naWMgdm9pZCByZXN0YXJ0Qm9va2llcyhTZXJ2ZXJDb25maWd1cmF0aW9uIG5l\nd0NvbmYpCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIC8vIHNodXQgZG93biBib29raWUgc2VydmVyCiAgICAgICAgZm9yIChCb29r\naWVTZXJ2ZXIgc2VydmVyIDogYnMpIHsKICAgICAgICAgICAgc2VydmVyLnNo\ndXRkb3duKCk7CiAgICAgICAgICAgIHN0b3BBdXRvUmVjb3ZlcnlTZXJ2aWNl\nKHNlcnZlcik7CiAgICAgICAgfQogICAgICAgIGJzLmNsZWFyKCk7CiAgICAg\nICAgVGhyZWFkLnNsZWVwKDEwMDApOwogICAgICAgIC8vIHJlc3RhcnQgdGhl\nbSB0byBlbnN1cmUgd2UgY2FuJ3QKICAgICAgICBpbnQgaiA9IDA7CiAgICAg\nICAgZm9yIChTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgOiBic0NvbmZzKSB7\nCiAgICAgICAgICAgIGlmIChudWxsICE9IG5ld0NvbmYpIHsKICAgICAgICAg\nICAgICAgIGNvbmYubG9hZENvbmYobmV3Q29uZik7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgYnMuYWRkKHN0YXJ0Qm9va2llKGNvbmYpKTsKICAgICAg\nICAgICAgaisrOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEhl\nbHBlciBtZXRob2QgdG8gc3RhcnR1cCBhIG5ldyBib29raWUgc2VydmVyIHdp\ndGggdGhlIGluZGljYXRlZCBwb3J0CiAgICAgKiBudW1iZXIuIEFsc28sIHN0\nYXJ0cyB0aGUgYXV0byByZWNvdmVyeSBwcm9jZXNzLCBpZiB0aGUKICAgICAq\nIGlzQXV0b1JlY292ZXJ5RW5hYmxlZCBpcyBzZXQgdHJ1ZS4KICAgICAqCiAg\nICAgKiBAcGFyYW0gcG9ydAogICAgICogICAgICAgICAgICBQb3J0IHRvIHN0\nYXJ0IHRoZSBuZXcgYm9va2llIHNlcnZlciBvbgogICAgICogQHRocm93cyBJ\nT0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgaW50IHN0YXJ0TmV3Qm9v\na2llKCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mID0gbmV3U2VydmVyQ29uZmlndXJh\ndGlvbigpOwogICAgICAgIGJzQ29uZnMuYWRkKGNvbmYpOwogICAgICAgIGJz\nLmFkZChzdGFydEJvb2tpZShjb25mKSk7CgogICAgICAgIHJldHVybiBjb25m\nLmdldEJvb2tpZVBvcnQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBl\nciBtZXRob2QgdG8gc3RhcnR1cCBhIGJvb2tpZSBzZXJ2ZXIgdXNpbmcgYSBj\nb25maWd1cmF0aW9uIG9iamVjdC4KICAgICAqIEFsc28sIHN0YXJ0cyB0aGUg\nYXV0byByZWNvdmVyeSBwcm9jZXNzIGlmIGlzQXV0b1JlY292ZXJ5RW5hYmxl\nZCBpcyB0cnVlLgogICAgICoKICAgICAqIEBwYXJhbSBjb25mCiAgICAgKiAg\nICAgICAgICAgIFNlcnZlciBDb25maWd1cmF0aW9uIE9iamVjdAogICAgICoK\nICAgICAqLwogICAgcHJvdGVjdGVkIEJvb2tpZVNlcnZlciBzdGFydEJvb2tp\nZShTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYpCiAgICAgICAgICAgIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNlcnZlciBzZXJ2ZXIgPSBu\nZXcgQm9va2llU2VydmVyKGNvbmYpOwogICAgICAgIHNlcnZlci5zdGFydCgp\nOwoKICAgICAgICBpbnQgcG9ydCA9IGNvbmYuZ2V0Qm9va2llUG9ydCgpOwog\nICAgICAgIHdoaWxlKGJrYy5nZXRaa0hhbmRsZSgpLmV4aXN0cygiL2xlZGdl\ncnMvYXZhaWxhYmxlLyIgKyBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3QoKS5n\nZXRIb3N0QWRkcmVzcygpICsgIjoiICsgcG9ydCwgZmFsc2UpID09IG51bGwp\nIHsKICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDUwMCk7CiAgICAgICAgfQoK\nICAgICAgICBia2MucmVhZEJvb2tpZXNCbG9ja2luZygpOwogICAgICAgIExP\nRy5pbmZvKCJOZXcgYm9va2llIG9uIHBvcnQgIiArIHBvcnQgKyAiIGhhcyBi\nZWVuIGNyZWF0ZWQuIik7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0\nYXJ0QXV0b1JlY292ZXJ5KHNlcnZlciwgY29uZik7CiAgICAgICAgfSBjYXRj\naCAoQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbiBjZSkgewogICAgICAgICAgICBM\nT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBzdGFydGluZyBBdXRvUmVjb3Zl\ncnkhIiwgY2UpOwogICAgICAgIH0gY2F0Y2ggKFVuYXZhaWxhYmxlRXhjZXB0\naW9uIHVlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0aW9uIHdo\naWxlIHN0YXJ0aW5nIEF1dG9SZWNvdmVyeSEiLCB1ZSk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBzZXJ2ZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\ndGFydCBhIGJvb2tpZSB3aXRoIHRoZSBnaXZlbiBib29raWUgaW5zdGFuY2Uu\nIEFsc28sIHN0YXJ0cyB0aGUgYXV0bwogICAgICogcmVjb3ZlcnkgZm9yIHRo\naXMgYm9va2llLCBpZiBpc0F1dG9SZWNvdmVyeUVuYWJsZWQgaXMgdHJ1ZS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIEJvb2tpZVNlcnZlciBzdGFydEJvb2tp\nZShTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYsIGZpbmFsIEJvb2tpZSBiKQog\nICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCb29raWVT\nZXJ2ZXIgc2VydmVyID0gbmV3IEJvb2tpZVNlcnZlcihjb25mKSB7CiAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwcm90ZWN0ZWQgQm9va2ll\nIG5ld0Jvb2tpZShTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiBiOwogICAgICAgICAgICB9CiAgICAgICAgfTsK\nICAgICAgICBzZXJ2ZXIuc3RhcnQoKTsKCiAgICAgICAgaW50IHBvcnQgPSBj\nb25mLmdldEJvb2tpZVBvcnQoKTsKICAgICAgICB3aGlsZShia2MuZ2V0WmtI\nYW5kbGUoKS5leGlzdHMoIi9sZWRnZXJzL2F2YWlsYWJsZS8iICsgSW5ldEFk\nZHJlc3MuZ2V0TG9jYWxIb3N0KCkuZ2V0SG9zdEFkZHJlc3MoKSArICI6IiAr\nIHBvcnQsIGZhbHNlKSA9PSBudWxsKSB7CiAgICAgICAgICAgIFRocmVhZC5z\nbGVlcCg1MDApOwogICAgICAgIH0KCiAgICAgICAgYmtjLnJlYWRCb29raWVz\nQmxvY2tpbmcoKTsKICAgICAgICBMT0cuaW5mbygiTmV3IGJvb2tpZSBvbiBw\nb3J0ICIgKyBwb3J0ICsgIiBoYXMgYmVlbiBjcmVhdGVkLiIpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHN0YXJ0QXV0b1JlY292ZXJ5KHNlcnZlciwg\nY29uZik7CiAgICAgICAgfSBjYXRjaCAoQ29tcGF0aWJpbGl0eUV4Y2VwdGlv\nbiBjZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGls\nZSBzdGFydGluZyBBdXRvUmVjb3ZlcnkhIiwgY2UpOwogICAgICAgIH0gY2F0\nY2ggKFVuYXZhaWxhYmxlRXhjZXB0aW9uIHVlKSB7CiAgICAgICAgICAgIExP\nRy5lcnJvcigiRXhjZXB0aW9uIHdoaWxlIHN0YXJ0aW5nIEF1dG9SZWNvdmVy\neSEiLCB1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZXJ2ZXI7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0TWV0YXN0b3JlSW1wbENsYXNzKEFi\nc3RyYWN0Q29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgY29uZi5zZXRN\nZXRhc3RvcmVJbXBsQ2xhc3MoSW5NZW1vcnlNZXRhU3RvcmUuY2xhc3MuZ2V0\nTmFtZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZsYWdzIHVzZWQgdG8g\nZW5hYmxlL2Rpc2FibGUgdGhlIGF1dG8gcmVjb3ZlcnkgcHJvY2Vzcy4gSWYg\naXQgaXMgZW5hYmxlZCwKICAgICAqIHN0YXJ0aW5nIHRoZSBib29raWUgc2Vy\ndmVyIHdpbGwgc3RhcnRzIHRoZSBhdXRvIHJlY292ZXJ5IHByb2Nlc3MgZm9y\nIHRoYXQKICAgICAqIGJvb2tpZS4gQWxzbywgc3RvcHBpbmcgYm9va2llIHdp\nbGwgc3RvcHMgdGhlIHJlc3BlY3RpdmUgYXV0byByZWNvdmVyeQogICAgICog\ncHJvY2Vzcy4KICAgICAqCiAgICAgKiBAcGFyYW0gaXNBdXRvUmVjb3ZlcnlF\nbmFibGVkCiAgICAgKiAgICAgICAgICAgIFZhbHVlIHRydWUgd2lsbCBlbmFi\nbGUgdGhlIGF1dG8gcmVjb3ZlcnkgcHJvY2Vzcy4gVmFsdWUgZmFsc2UKICAg\nICAqICAgICAgICAgICAgd2lsbCBkaXNhYmxlIHRoZSBhdXRvIHJlY292ZXJ5\nIHByb2Nlc3MKICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QXV0b1JlY292\nZXJ5RW5hYmxlZChib29sZWFuIGlzQXV0b1JlY292ZXJ5RW5hYmxlZCkgewog\nICAgICAgIHRoaXMuaXNBdXRvUmVjb3ZlcnlFbmFibGVkID0gaXNBdXRvUmVj\nb3ZlcnlFbmFibGVkOwogICAgfQoKICAgIC8qKgogICAgICogRmxhZyB1c2Vk\nIHRvIGNoZWNrIHdoZXRoZXIgYXV0byByZWNvdmVyeSBwcm9jZXNzIGlzIGVu\nYWJsZWQvZGlzYWJsZWQuIEJ5CiAgICAgKiBkZWZhdWx0IHRoZSBmbGFnIGlz\nIGZhbHNlLgogICAgICoKICAgICAqIEByZXR1cm4gdHJ1ZSwgaWYgdGhlIGF1\ndG8gcmVjb3ZlcnkgaXMgZW5hYmxlZC4gT3RoZXJ3aXNlIHJldHVybiBmYWxz\nZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNBdXRvUmVjb3ZlcnlF\nbmFibGVkKCkgewogICAgICAgIHJldHVybiBpc0F1dG9SZWNvdmVyeUVuYWJs\nZWQ7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHN0YXJ0QXV0b1JlY292ZXJ5\nKEJvb2tpZVNlcnZlciBic2VydmVyLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZikgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGlzQXV0b1JlY292ZXJ5RW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgIEF1dG9SZWNvdmVyeU1haW4gYXV0b1JlY292\nZXJ5UHJvY2VzcyA9IG5ldyBBdXRvUmVjb3ZlcnlNYWluKGNvbmYpOwogICAg\nICAgICAgICBhdXRvUmVjb3ZlcnlQcm9jZXNzLnN0YXJ0KCk7CiAgICAgICAg\nICAgIGF1dG9SZWNvdmVyeVByb2Nlc3Nlcy5wdXQoYnNlcnZlciwgYXV0b1Jl\nY292ZXJ5UHJvY2Vzcyk7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiU3RhcnRp\nbmcgQXVkaXRvciBSZWNvdmVyeSBmb3IgdGhlIGJvb2tpZToiCiAgICAgICAg\nICAgICAgICAgICAgKyBic2VydmVyLmdldExvY2FsQWRkcmVzcygpKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHN0b3BBdXRvUmVjb3Zl\ncnlTZXJ2aWNlKEJvb2tpZVNlcnZlciB0b1JlbW92ZSkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQXV0b1JlY292ZXJ5TWFpbiBhdXRvUmVjb3ZlcnlN\nYWluID0gYXV0b1JlY292ZXJ5UHJvY2Vzc2VzCiAgICAgICAgICAgICAgICAu\ncmVtb3ZlKHRvUmVtb3ZlKTsKICAgICAgICBpZiAobnVsbCAhPSBhdXRvUmVj\nb3ZlcnlNYWluICYmIGlzQXV0b1JlY292ZXJ5RW5hYmxlZCgpKSB7CiAgICAg\nICAgICAgIGF1dG9SZWNvdmVyeU1haW4uc2h1dGRvd24oKTsKICAgICAgICAg\nICAgTE9HLmRlYnVnKCJTaHV0ZG93biBhdXRvIHJlY292ZXJ5IGZvciBib29r\naWVzZXJ2ZXI6IgogICAgICAgICAgICAgICAgICAgICsgdG9SZW1vdmUuZ2V0\nTG9jYWxBZGRyZXNzKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFdpbGwgc3RhcnRzIHRoZSBhdXRvIHJlY292ZXJ5IHByb2Nlc3MgZm9y\nIHRoZSBib29raWUgc2VydmVycy4gT25lIGF1dG8KICAgICAqIHJlY292ZXJ5\nIHByb2Nlc3MgcGVyIGVhY2ggYm9va2llIHNlcnZlciwgaWYgaXNBdXRvUmVj\nb3ZlcnlFbmFibGVkIGlzCiAgICAgKiBlbmFibGVkLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzdGFydFJlcGxpY2F0aW9uU2VydmljZSgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGludCBpbmRleCA9IC0xOwogICAgICAgIGZv\nciAoQm9va2llU2VydmVyIGJzZXJ2ZXIgOiBicykgewogICAgICAgICAgICBz\ndGFydEF1dG9SZWNvdmVyeShic2VydmVyLCBic0NvbmZzLmdldCgrK2luZGV4\nKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogV2lsbCBzdG9w\ncyBhbGwgdGhlIGF1dG8gcmVjb3ZlcnkgcHJvY2Vzc2VzIGZvciB0aGUgYm9v\na2llIGNsdXN0ZXIsIGlmCiAgICAgKiBpc0F1dG9SZWNvdmVyeUVuYWJsZWQg\naXMgdHJ1ZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc3RvcFJlcGxpY2F0\naW9uU2VydmljZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmKGZh\nbHNlID09IGlzQXV0b1JlY292ZXJ5RW5hYmxlZCgpKXsKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIH0KICAgICAgICBmb3IgKEVudHJ5PEJvb2tpZVNl\ncnZlciwgQXV0b1JlY292ZXJ5TWFpbj4gYXV0b1JlY292ZXJ5UHJvY2VzcyA6\nIGF1dG9SZWNvdmVyeVByb2Nlc3NlcwogICAgICAgICAgICAgICAgLmVudHJ5\nU2V0KCkpIHsKICAgICAgICAgICAgYXV0b1JlY292ZXJ5UHJvY2Vzcy5nZXRW\nYWx1ZSgpLnNodXRkb3duKCk7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiU2h1\ndGRvd24gQXVkaXRvciBSZWNvdmVyeSBmb3IgdGhlIGJvb2tpZToiCiAgICAg\nICAgICAgICAgICAgICAgKyBhdXRvUmVjb3ZlcnlQcm9jZXNzLmdldEtleSgp\nLmdldExvY2FsQWRkcmVzcygpKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

