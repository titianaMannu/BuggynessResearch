{"sha":"3bd931203672132739ff9fb5bdc1cd9b216da315","node_id":"MDQ6QmxvYjE1NzU5NTY6M2JkOTMxMjAzNjcyMTMyNzM5ZmY5ZmI1YmRjMWNkOWIyMTZkYTMxNQ==","size":5532,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/3bd931203672132739ff9fb5bdc1cd9b216da315","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247\nCgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CgppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuWmtVdGlsczsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci56b29rZWVwZXIuWm9vS2VlcGVyV2F0Y2hl\nckJhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuaW8uRmlsZVV0aWxz\nOwoKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNo\nOwoKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBv\ncmcuYXBhY2hlLnpvb2tlZXBlci5ab29EZWZzLklkczsKCmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5zZXJ2ZXIuTklPU2VydmVyQ254bkZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5zZXJ2ZXIuWm9vS2VlcGVy\nU2VydmVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIudGVzdC5DbGll\nbnRCYXNlOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBzdGF0aWMgb3JnLmp1bml0\nLkFzc2VydC4qOwoKcHVibGljIGNsYXNzIFpvb0tlZXBlclV0aWwgewogICAg\nc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihab29LZWVwZXJVdGlsLmNsYXNzKTsKCiAgICAvLyBab29LZWVwZXIg\ncmVsYXRlZCB2YXJpYWJsZXMKICAgIHByb3RlY3RlZCBmaW5hbCBzdGF0aWMg\nSW50ZWdlciB6b29LZWVwZXJQb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQ\nb3J0KCk7CiAgICBwcml2YXRlIGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIHpr\nYWRkcjsKCiAgICBwcm90ZWN0ZWQgWm9vS2VlcGVyU2VydmVyIHprczsKICAg\nIHByb3RlY3RlZCBab29LZWVwZXIgemtjOyAvLyB6b29rZWVwZXIgY2xpZW50\nCiAgICBwcm90ZWN0ZWQgTklPU2VydmVyQ254bkZhY3Rvcnkgc2VydmVyRmFj\ndG9yeTsKICAgIHByb3RlY3RlZCBGaWxlIFprVG1wRGlyOwogICAgcHJpdmF0\nZSBmaW5hbCBTdHJpbmcgY29ubmVjdFN0cmluZzsKCiAgICBwdWJsaWMgWm9v\nS2VlcGVyVXRpbCgpIHsKICAgICAgICB6a2FkZHIgPSBuZXcgSW5ldFNvY2tl\ndEFkZHJlc3Moem9vS2VlcGVyUG9ydCk7CiAgICAgICAgY29ubmVjdFN0cmlu\nZz0gImxvY2FsaG9zdDoiICsgem9vS2VlcGVyUG9ydDsKICAgIH0KCiAgICBw\ndWJsaWMgWm9vS2VlcGVyIGdldFpvb0tlZXBlckNsaWVudCgpIHsKICAgICAg\nICByZXR1cm4gemtjOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0Wm9v\nS2VlcGVyQ29ubmVjdFN0cmluZygpIHsKICAgICAgICByZXR1cm4gY29ubmVj\ndFN0cmluZzsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydFNlcnZlcigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIGNyZWF0ZSBhIFpvb0tl\nZXBlciBzZXJ2ZXIoZGF0YURpciwgZGF0YUxvZ0RpciwgcG9ydCkKICAgICAg\nICBMT0cuZGVidWcoIlJ1bm5pbmcgWksgc2VydmVyIik7CiAgICAgICAgLy8g\nU2VydmVyU3RhdHMucmVnaXN0ZXJBc0NvbmNyZXRlKCk7CiAgICAgICAgQ2xp\nZW50QmFzZS5zZXR1cFRlc3RFbnYoKTsKICAgICAgICBaa1RtcERpciA9IEZp\nbGUuY3JlYXRlVGVtcEZpbGUoInpvb2tlZXBlciIsICJ0ZXN0Iik7CiAgICAg\nICAgWmtUbXBEaXIuZGVsZXRlKCk7CiAgICAgICAgWmtUbXBEaXIubWtkaXIo\nKTsKCiAgICAgICAgemtzID0gbmV3IFpvb0tlZXBlclNlcnZlcihaa1RtcERp\nciwgWmtUbXBEaXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBab29LZWVwZXJTZXJ2ZXIuREVGQVVMVF9USUNLX1RJTUUpOwogICAgICAg\nIHNlcnZlckZhY3RvcnkgPSBuZXcgTklPU2VydmVyQ254bkZhY3RvcnkoKTsK\nICAgICAgICBzZXJ2ZXJGYWN0b3J5LmNvbmZpZ3VyZSh6a2FkZHIsIDEwMCk7\nCiAgICAgICAgc2VydmVyRmFjdG9yeS5zdGFydHVwKHprcyk7CgogICAgICAg\nIGJvb2xlYW4gYiA9IENsaWVudEJhc2Uud2FpdEZvclNlcnZlclVwKGdldFpv\nb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBDbGllbnRCYXNlLkNPTk5FQ1RJ\nT05fVElNRU9VVCk7CiAgICAgICAgTE9HLmRlYnVnKCJTZXJ2ZXIgdXA6ICIg\nKyBiKTsKCiAgICAgICAgLy8gY3JlYXRlIGEgem9va2VlcGVyIGNsaWVudAog\nICAgICAgIExPRy5kZWJ1ZygiSW5zdGFudGlhdGUgWksgQ2xpZW50Iik7CiAg\nICAgICAgWm9vS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVwZXJX\nYXRjaGVyQmFzZSgxMDAwMCk7CiAgICAgICAgemtjID0gWmtVdGlscy5jcmVh\ndGVDb25uZWN0ZWRab29rZWVwZXJDbGllbnQoCiAgICAgICAgICAgICAgICBn\nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCksIHcpOwoKICAgICAgICAvLyBp\nbml0aWFsaXplIHRoZSB6ayBjbGllbnQgd2l0aCB2YWx1ZXMKICAgICAgICB6\na2MuY3JlYXRlKCIvbGVkZ2VycyIsIG5ldyBieXRlWzBdLCBJZHMuT1BFTl9B\nQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwogICAgICAgIHpr\nYy5jcmVhdGUoIi9sZWRnZXJzL2F2YWlsYWJsZSIsIG5ldyBieXRlWzBdLCBJ\nZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNsZWVwU2VydmVyKGZpbmFsIGludCBz\nZWNvbmRzLCBmaW5hbCBDb3VudERvd25MYXRjaCBsKQogICAgICAgICAgICB0\naHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24sIElPRXhjZXB0aW9uIHsKICAg\nICAgICBUaHJlYWRbXSBhbGx0aHJlYWRzID0gbmV3IFRocmVhZFtUaHJlYWQu\nYWN0aXZlQ291bnQoKV07CiAgICAgICAgVGhyZWFkLmVudW1lcmF0ZShhbGx0\naHJlYWRzKTsKICAgICAgICBmb3IgKGZpbmFsIFRocmVhZCB0IDogYWxsdGhy\nZWFkcykgewogICAgICAgICAgICBpZiAodC5nZXROYW1lKCkuY29udGFpbnMo\nIlN5bmNUaHJlYWQ6MCIpKSB7CiAgICAgICAgICAgICAgICBUaHJlYWQgc2xl\nZXBlciA9IG5ldyBUaHJlYWQoKSB7CiAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zdXNwZW5kKCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBsLmNvdW50RG93bigpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKHNlY29uZHMq\nMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlc3VtZSgp\nOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJF\ncnJvciBzdXNwZW5kaW5nIHRocmVhZCIsIGUpOwogICAgICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfTsKICAgICAgICAgICAgICAgIHNsZWVwZXIuc3RhcnQoKTsKICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIlpvb0tlZXBlciB0aHJlYWQg\nbm90IGZvdW5kIik7CiAgICB9CgogICAgcHVibGljIHZvaWQgZXhwaXJlU2Vz\nc2lvbihab29LZWVwZXIgemspIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIGxvbmcgaWQgPSB6ay5nZXRTZXNzaW9uSWQoKTsKICAgICAgICBieXRlW10g\ncGFzc3dvcmQgPSB6ay5nZXRTZXNzaW9uUGFzc3dkKCk7CiAgICAgICAgWm9v\nS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVwZXJXYXRjaGVyQmFz\nZSgxMDAwMCk7CiAgICAgICAgWm9vS2VlcGVyIHprMiA9IG5ldyBab29LZWVw\nZXIoZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLAogICAgICAgICAgICAg\nICAgemsuZ2V0U2Vzc2lvblRpbWVvdXQoKSwgdywgaWQsIHBhc3N3b3JkKTsK\nICAgICAgICB3LndhaXRGb3JDb25uZWN0aW9uKCk7CiAgICAgICAgemsyLmNs\nb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQga2lsbFNlcnZlcigpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGlmICh6a2MgIT0gbnVsbCkgewog\nICAgICAgICAgICB6a2MuY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIC8v\nIHNodXRkb3duIFpLIHNlcnZlcgogICAgICAgIGlmIChzZXJ2ZXJGYWN0b3J5\nICE9IG51bGwpIHsKICAgICAgICAgICAgc2VydmVyRmFjdG9yeS5zaHV0ZG93\nbigpOwogICAgICAgICAgICBhc3NlcnRUcnVlKCJ3YWl0aW5nIGZvciBzZXJ2\nZXIgZG93biIsCiAgICAgICAgICAgICAgICAgICAgICAgQ2xpZW50QmFzZS53\nYWl0Rm9yU2VydmVyRG93bihnZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBDbGllbnRCYXNlLkNPTk5FQ1RJT05fVElNRU9VVCkpOwogICAg\nICAgIH0KICAgICAgICBpZiAoemtzICE9IG51bGwpIHsKICAgICAgICAgICAg\nemtzLmdldFR4bkxvZ0ZhY3RvcnkoKS5jbG9zZSgpOwogICAgICAgIH0KICAg\nICAgICAvLyBTZXJ2ZXJTdGF0cy51bnJlZ2lzdGVyKCk7CiAgICAgICAgRmls\nZVV0aWxzLmRlbGV0ZURpcmVjdG9yeShaa1RtcERpcik7CiAgICB9Cn0K\n","encoding":"base64"}

