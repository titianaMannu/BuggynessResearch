{"sha":"0d5ae0a6fc0911a7091c0ec43738199894aa579c","node_id":"MDQ6QmxvYjE1NzU5NTY6MGQ1YWUwYTZmYzA5MTFhNzA5MWMwZWM0MzczODE5OTg5NGFhNTc5Yw==","size":17380,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0d5ae0a6fc0911a7091c0ec43738199894aa579c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0\naGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z\nIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICov\nCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJlbmNobWFyazsKCmlt\ncG9ydCBqYXZhLmlvLkJ1ZmZlcmVkT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2\nYS5pby5GaWxlT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuaW8uT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2\nYS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwu\nUmFuZG9tOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3du\nTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhvcmU7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5BdG9taWNMb25nOwppbXBv\ncnQgamF2YS51dGlsLlRpbWVyOwppbXBvcnQgamF2YS51dGlsLlRpbWVyVGFz\nazsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5C\nb29rS2VlcGVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVu\ndC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNsaS5Db21tYW5kTGluZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jbGkuQ29tbWFuZExpbmVQYXJzZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLkhlbHBGb3JtYXR0ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLk9wdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLlBhcnNlRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5jb21tb25zLmNsaS5Qb3NpeFBhcnNlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVkRXZlbnQ7CmltcG9ydCBvcmcuYXBh\nY2hlLnpvb2tlZXBlci5XYXRjaGVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29r\nZWVwZXIuWm9vRGVmczsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpv\nb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXIu\nRXZlbnQuRXZlbnRUeXBlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nV2F0Y2hlci5FdmVudC5LZWVwZXJTdGF0ZTsKaW1wb3J0IG9yZy5zbGY0ai5M\nb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCnB1Ymxp\nYyBjbGFzcyBCZW5jaFRocm91Z2hwdXRMYXRlbmN5IGltcGxlbWVudHMgQWRk\nQ2FsbGJhY2ssIFJ1bm5hYmxlIHsKICAgIHN0YXRpYyBMb2dnZXIgTE9HID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoQmVuY2hUaHJvdWdocHV0TGF0ZW5j\neS5jbGFzcyk7CgogICAgQm9va0tlZXBlciBiazsKICAgIExlZGdlckhhbmRs\nZSBsaFtdOwogICAgQXRvbWljTG9uZyBjb3VudGVyOwoKICAgIFNlbWFwaG9y\nZSBzZW07CiAgICBpbnQgbnVtYmVyT2ZMZWRnZXJzID0gMTsKICAgIGZpbmFs\nIGludCBzZW5kTGltaXQ7CiAgICBmaW5hbCBsb25nIGxhdGVuY2llc1tdOwoK\nICAgIHN0YXRpYyBjbGFzcyBDb250ZXh0IHsKICAgICAgICBsb25nIGxvY2Fs\nU3RhcnRUaW1lOwogICAgICAgIGxvbmcgaWQ7CgogICAgICAgIENvbnRleHQo\nbG9uZyBpZCwgbG9uZyB0aW1lKXsKICAgICAgICAgICAgdGhpcy5pZCA9IGlk\nOwogICAgICAgICAgICB0aGlzLmxvY2FsU3RhcnRUaW1lID0gdGltZTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIEJlbmNoVGhyb3VnaHB1dExhdGVu\nY3koaW50IGVuc2VtYmxlLCBpbnQgd3JpdGVRdW9ydW1TaXplLCBpbnQgYWNr\nUXVvcnVtU2l6ZSwgYnl0ZVtdIHBhc3N3ZCwKICAgICAgICAgICAgaW50IG51\nbWJlck9mTGVkZ2VycywgaW50IHNlbmRMaW1pdCwgQ2xpZW50Q29uZmlndXJh\ndGlvbiBjb25mKQogICAgICAgICAgICB0aHJvd3MgS2VlcGVyRXhjZXB0aW9u\nLCBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAg\nIHRoaXMuc2VtID0gbmV3IFNlbWFwaG9yZShjb25mLmdldFRocm90dGxlVmFs\ndWUoKSk7CiAgICAgICAgYmsgPSBuZXcgQm9va0tlZXBlcihjb25mKTsKICAg\nICAgICB0aGlzLmNvdW50ZXIgPSBuZXcgQXRvbWljTG9uZygwKTsKICAgICAg\nICB0aGlzLm51bWJlck9mTGVkZ2VycyA9IG51bWJlck9mTGVkZ2VyczsKICAg\nICAgICB0aGlzLnNlbmRMaW1pdCA9IHNlbmRMaW1pdDsKICAgICAgICB0aGlz\nLmxhdGVuY2llcyA9IG5ldyBsb25nW3NlbmRMaW1pdF07CiAgICAgICAgdHJ5\newogICAgICAgICAgICBsaCA9IG5ldyBMZWRnZXJIYW5kbGVbdGhpcy5udW1i\nZXJPZkxlZGdlcnNdOwoKICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8\nIHRoaXMubnVtYmVyT2ZMZWRnZXJzOyBpKyspIHsKICAgICAgICAgICAgICAg\nIGxoW2ldID0gYmsuY3JlYXRlTGVkZ2VyKGVuc2VtYmxlLCB3cml0ZVF1b3J1\nbVNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBhY2tRdW9ydW1TaXplLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dkKTsK\nICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiTGVkZ2VyIEhhbmRsZTogIiAr\nIGxoW2ldLmdldElkKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRj\naCAoQktFeGNlcHRpb24gZSkgewogICAgICAgICAgICBlLnByaW50U3RhY2tU\ncmFjZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBSYW5kb20gcmFuZCA9IG5l\ndyBSYW5kb20oKTsKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIElu\ndGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgZm9y\nKGludCBpID0gMDsgaSA8IG51bWJlck9mTGVkZ2VyczsgaSsrKSB7CiAgICAg\nICAgICAgIGxoW2ldLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGJrLmNs\nb3NlKCk7CiAgICB9CgogICAgbG9uZyBwcmV2aW91cyA9IDA7CiAgICBieXRl\nIGJ5dGVzW107CgogICAgdm9pZCBzZXRFbnRyeURhdGEoYnl0ZSBkYXRhW10p\nIHsKICAgICAgICBieXRlcyA9IGRhdGE7CiAgICB9CgogICAgaW50IGxhc3RM\nZWRnZXIgPSAwOwogICAgcHJpdmF0ZSBpbnQgZ2V0UmFuZG9tTGVkZ2VyKCkg\newogICAgICAgICByZXR1cm4gcmFuZC5uZXh0SW50KG51bWJlck9mTGVkZ2Vy\ncyk7CiAgICB9CgogICAgaW50IGxhdGVuY3lJbmRleCA9IC0xOwogICAgQXRv\nbWljTG9uZyBjb21wbGV0ZWRSZXF1ZXN0cyA9IG5ldyBBdG9taWNMb25nKDAp\nOwoKICAgIGxvbmcgZHVyYXRpb24gPSAtMTsKICAgIHN5bmNocm9uaXplZCBw\ndWJsaWMgbG9uZyBnZXREdXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gZHVy\nYXRpb247CiAgICB9CgogICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAg\nIExPRy5pbmZvKCJSdW5uaW5nLi4uIik7CiAgICAgICAgbG9uZyBzdGFydCA9\nIHByZXZpb3VzID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CgogICAg\nICAgIGludCBzZW50ID0gMDsKCiAgICAgICAgVGhyZWFkIHJlcG9ydGVyID0g\nbmV3IFRocmVhZCgpIHsKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1\nbigpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgICAgICB3aGlsZSh0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBMT0cuaW5mbygibXM6IHt9IHJlcToge30iLCBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKSwgY29tcGxldGVkUmVxdWVzdHMuZ2V0QW5k\nU2V0KDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJDYXVnaHQgaW50\nZXJydXB0ZWQgZXhjZXB0aW9uLCBnb2luZyBhd2F5Iik7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9Owog\nICAgICAgIHJlcG9ydGVyLnN0YXJ0KCk7CiAgICAgICAgbG9uZyBiZWZvcmVT\nZW5kID0gU3lzdGVtLm5hbm9UaW1lKCk7CgogICAgICAgIHdoaWxlKCFUaHJl\nYWQuY3VycmVudFRocmVhZCgpLmlzSW50ZXJydXB0ZWQoKSAmJiBzZW50IDwg\nc2VuZExpbWl0KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBzZW0uYWNxdWlyZSgpOwogICAgICAgICAgICAgICAgaWYgKHNlbnQgPT0g\nMTAwMDApIHsKICAgICAgICAgICAgICAgICAgICBsb25nIGFmdGVyU2VuZCA9\nIFN5c3RlbS5uYW5vVGltZSgpOwogICAgICAgICAgICAgICAgICAgIGxvbmcg\ndGltZSA9IGFmdGVyU2VuZCAtIGJlZm9yZVNlbmQ7CiAgICAgICAgICAgICAg\nICAgICAgTE9HLmluZm8oIlRpbWUgdG8gc2VuZCBmaXJzdCBiYXRjaDoge31z\nIHt9bnMgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lLzEw\nMDAvMTAwMC8xMDAwLCB0aW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGZpbmFsIGludCBpbmRleCA9IGdldFJhbmRvbUxlZGdlcigpOwogICAgICAg\nICAgICBMZWRnZXJIYW5kbGUgaCA9IGxoW2luZGV4XTsKICAgICAgICAgICAg\naWYgKGggPT0gbnVsbCkgewogICAgICAgICAgICAgICAgTE9HLmVycm9yKCJI\nYW5kbGUgIiArIGluZGV4ICsgIiBpcyBudWxsISIpOwogICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgbG9uZyBuYW5vVGltZSA9IFN5c3Rl\nbS5uYW5vVGltZSgpOwogICAgICAgICAgICAgICAgbGhbaW5kZXhdLmFzeW5j\nQWRkRW50cnkoYnl0ZXMsIHRoaXMsIG5ldyBDb250ZXh0KHNlbnQsIG5hbm9U\naW1lKSk7CiAgICAgICAgICAgICAgICBjb3VudGVyLmluY3JlbWVudEFuZEdl\ndCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbnQrKzsKICAgICAg\nICB9CiAgICAgICAgTE9HLmluZm8oIlNlbnQ6ICIgICsgc2VudCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaW50IGkgPSAwOwogICAgICAgICAgICB3\naGlsZSh0aGlzLmNvdW50ZXIuZ2V0KCkgPiAwKSB7CiAgICAgICAgICAgICAg\nICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAgICAgICAgICBpKys7CiAg\nICAgICAgICAgICAgICBpZiAoaSA+IDMwKSB7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9IGNhdGNoKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1cHRlZCB3aGlsZSB3YWl0aW5nIiwg\nZSk7CiAgICAgICAgfQogICAgICAgIHN5bmNocm9uaXplZCh0aGlzKSB7CiAg\nICAgICAgICAgIGR1cmF0aW9uID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlz\nKCkgLSBzdGFydDsKICAgICAgICB9CiAgICAgICAgdGhyb3VnaHB1dCA9IHNl\nbnQqMTAwMC9nZXREdXJhdGlvbigpOwoKICAgICAgICByZXBvcnRlci5pbnRl\ncnJ1cHQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXBvcnRlci5q\nb2luKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24g\naWUpIHsKICAgICAgICAgICAgLy8gaWdub3JlCiAgICAgICAgfQogICAgICAg\nIExPRy5pbmZvKCJGaW5pc2hlZCBwcm9jZXNzaW5nIGluIG1zOiAiICsgZ2V0\nRHVyYXRpb24oKSArICIgdHAgPSAiICsgdGhyb3VnaHB1dCk7CiAgICB9Cgog\nICAgbG9uZyB0aHJvdWdocHV0ID0gLTE7CiAgICBwdWJsaWMgbG9uZyBnZXRU\naHJvdWdocHV0KCkgewogICAgICAgIHJldHVybiB0aHJvdWdocHV0OwogICAg\nfQoKICAgIGxvbmcgdGhyZXNob2xkID0gMjAwMDA7CiAgICBsb25nIHJ1bm5p\nbmdBdmVyYWdlQ291bnRlciA9IDA7CiAgICBsb25nIHRvdGFsVGltZSA9IDA7\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGFkZENvbXBsZXRlKGlu\ndCByYywgTGVkZ2VySGFuZGxlIGxoLCBsb25nIGVudHJ5SWQsIE9iamVjdCBj\ndHgpIHsKICAgICAgICBDb250ZXh0IGNvbnRleHQgPSAoQ29udGV4dCkgY3R4\nOwoKICAgICAgICAvLyB3ZSBuZWVkIHRvIHVzZSB0aGUgaWQgcGFzc2VkIGlu\nIHRoZSBjb250ZXh0IGluIHRoZSBjYXNlIG9mCiAgICAgICAgLy8gbXVsdGlw\nbGUgbGVkZ2VycywgYW5kIGl0IHdvcmtzIGV2ZW4gd2l0aCBvbmUgbGVkZ2Vy\nCiAgICAgICAgZW50cnlJZCA9IGNvbnRleHQuaWQ7CiAgICAgICAgbG9uZyBu\nZXdUaW1lID0gU3lzdGVtLm5hbm9UaW1lKCkgLSBjb250ZXh0LmxvY2FsU3Rh\ncnRUaW1lOwoKICAgICAgICBzZW0ucmVsZWFzZSgpOwogICAgICAgIGNvdW50\nZXIuZGVjcmVtZW50QW5kR2V0KCk7CgogICAgICAgIGlmIChyYyA9PSAwKSB7\nCiAgICAgICAgICAgIGxhdGVuY2llc1soaW50KWVudHJ5SWRdID0gbmV3VGlt\nZTsKICAgICAgICAgICAgY29tcGxldGVkUmVxdWVzdHMuaW5jcmVtZW50QW5k\nR2V0KCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9p\nZCBtYWluKFN0cmluZ1tdIGFyZ3MpCiAgICAgICAgICAgIHRocm93cyBLZWVw\nZXJFeGNlcHRpb24sIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiwgUGFyc2VFeGNlcHRpb24sIEJLRXhjZXB0aW9uIHsKICAgICAgICBPcHRp\nb25zIG9wdGlvbnMgPSBuZXcgT3B0aW9ucygpOwogICAgICAgIG9wdGlvbnMu\nYWRkT3B0aW9uKCJ0aW1lIiwgdHJ1ZSwgIlJ1bm5pbmcgdGltZSAoc2Vjb25k\ncyksIGRlZmF1bHQgNjAiKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigi\nZW50cnlzaXplIiwgdHJ1ZSwgIkVudHJ5IHNpemUgKGJ5dGVzKSwgZGVmYXVs\ndCAxMDI0Iik7CiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24oImVuc2VtYmxl\nIiwgdHJ1ZSwgIkVuc2VtYmxlIHNpemUsIGRlZmF1bHQgMyIpOwogICAgICAg\nIG9wdGlvbnMuYWRkT3B0aW9uKCJxdW9ydW0iLCB0cnVlLCAiUXVvcnVtIHNp\nemUsIGRlZmF1bHQgMiIpOwogICAgICAgIG9wdGlvbnMuYWRkT3B0aW9uKCJh\nY2tRdW9ydW0iLCB0cnVlLCAiQWNrIHF1b3J1bSBzaXplLCBkZWZhdWx0IGlz\nIHNhbWUgYXMgcXVvcnVtIik7CiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24o\nInRocm90dGxlIiwgdHJ1ZSwgIk1heCBvdXRzdGFuZGluZyByZXF1ZXN0cywg\nZGVmYXVsdCAxMDAwMCIpOwogICAgICAgIG9wdGlvbnMuYWRkT3B0aW9uKCJs\nZWRnZXJzIiwgdHJ1ZSwgIk51bWJlciBvZiBsZWRnZXJzLCBkZWZhdWx0IDEi\nKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigiem9va2VlcGVyIiwgdHJ1\nZSwgIlpvb2tlZXBlciBlbnNlbWJsZSwgZGVmYXVsdCBcImxvY2FsaG9zdDoy\nMTgxXCIiKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigicGFzc3dvcmQi\nLCB0cnVlLCAiUGFzc3dvcmQgdXNlZCB0byBjcmVhdGUgbGVkZ2VycyAoZGVm\nYXVsdCAnYmVuY2hQYXNzd2QnKSIpOwogICAgICAgIG9wdGlvbnMuYWRkT3B0\naW9uKCJjb29yZG5vZGUiLCB0cnVlLCAiQ29vcmRpbmF0aW9uIHpub2RlIGZv\nciBtdWx0aSBjbGllbnQgYmVuY2htYXJrcyAob3B0aW9uYWwpIik7CiAgICAg\nICAgb3B0aW9ucy5hZGRPcHRpb24oInRpbWVvdXQiLCB0cnVlLCAiTnVtYmVy\nIG9mIHNlY29uZHMgYWZ0ZXIgd2hpY2ggdG8gZ2l2ZSB1cCIpOwogICAgICAg\nIG9wdGlvbnMuYWRkT3B0aW9uKCJzb2NrZXR0aW1lb3V0IiwgdHJ1ZSwgIlNv\nY2tldCB0aW1lb3V0IGZvciBib29ra2VlcGVyIGNsaWVudC4gSW4gc2Vjb25k\ncy4gRGVmYXVsdCA1Iik7CiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24oInNr\naXB3YXJtdXAiLCBmYWxzZSwgIlNraXAgd2FybSB1cCwgZGVmYXVsdCBmYWxz\nZSIpOwogICAgICAgIG9wdGlvbnMuYWRkT3B0aW9uKCJzZW5kbGltaXQiLCB0\ncnVlLCAiTWF4IG51bWJlciBvZiBlbnRyaWVzIHRvIHNlbmQuIERlZmF1bHQg\nMjAwMDAwMDAiKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigibGF0ZW5j\neUZpbGUiLCB0cnVlLCAiRmlsZSB0byBkdW1wIGxhdGVuY2llcy4gRGVmYXVs\ndCBpcyBsYXRlbmN5RHVtcC5kYXQiKTsKICAgICAgICBvcHRpb25zLmFkZE9w\ndGlvbigiaGVscCIsIGZhbHNlLCAiVGhpcyBtZXNzYWdlIik7CgogICAgICAg\nIENvbW1hbmRMaW5lUGFyc2VyIHBhcnNlciA9IG5ldyBQb3NpeFBhcnNlcigp\nOwogICAgICAgIENvbW1hbmRMaW5lIGNtZCA9IHBhcnNlci5wYXJzZShvcHRp\nb25zLCBhcmdzKTsKCiAgICAgICAgaWYgKGNtZC5oYXNPcHRpb24oImhlbHAi\nKSkgewogICAgICAgICAgICBIZWxwRm9ybWF0dGVyIGZvcm1hdHRlciA9IG5l\ndyBIZWxwRm9ybWF0dGVyKCk7CiAgICAgICAgICAgIGZvcm1hdHRlci5wcmlu\ndEhlbHAoIkJlbmNoVGhyb3VnaHB1dExhdGVuY3kgPG9wdGlvbnM+Iiwgb3B0\naW9ucyk7CiAgICAgICAgICAgIFN5c3RlbS5leGl0KC0xKTsKICAgICAgICB9\nCgogICAgICAgIGxvbmcgcnVubmluZ1RpbWUgPSBMb25nLnZhbHVlT2YoY21k\nLmdldE9wdGlvblZhbHVlKCJ0aW1lIiwgIjYwIikpOwogICAgICAgIFN0cmlu\nZyBzZXJ2ZXJzID0gY21kLmdldE9wdGlvblZhbHVlKCJ6b29rZWVwZXIiLCAi\nbG9jYWxob3N0OjIxODEiKTsKICAgICAgICBpbnQgZW50cnlzaXplID0gSW50\nZWdlci52YWx1ZU9mKGNtZC5nZXRPcHRpb25WYWx1ZSgiZW50cnlzaXplIiwg\nIjEwMjQiKSk7CgogICAgICAgIGludCBsZWRnZXJzID0gSW50ZWdlci52YWx1\nZU9mKGNtZC5nZXRPcHRpb25WYWx1ZSgibGVkZ2VycyIsICIxIikpOwogICAg\nICAgIGludCBlbnNlbWJsZSA9IEludGVnZXIudmFsdWVPZihjbWQuZ2V0T3B0\naW9uVmFsdWUoImVuc2VtYmxlIiwgIjMiKSk7CiAgICAgICAgaW50IHF1b3J1\nbSA9IEludGVnZXIudmFsdWVPZihjbWQuZ2V0T3B0aW9uVmFsdWUoInF1b3J1\nbSIsICIyIikpOwogICAgICAgIGludCBhY2tRdW9ydW0gPSBxdW9ydW07CiAg\nICAgICAgaWYgKGNtZC5oYXNPcHRpb24oImFja1F1b3J1bSIpKSB7CiAgICAg\nICAgICAgIGFja1F1b3J1bSA9IEludGVnZXIudmFsdWVPZihjbWQuZ2V0T3B0\naW9uVmFsdWUoImFja1F1b3J1bSIpKTsKICAgICAgICB9CiAgICAgICAgaW50\nIHRocm90dGxlID0gSW50ZWdlci52YWx1ZU9mKGNtZC5nZXRPcHRpb25WYWx1\nZSgidGhyb3R0bGUiLCAiMTAwMDAiKSk7CiAgICAgICAgaW50IHNlbmRMaW1p\ndCA9IEludGVnZXIudmFsdWVPZihjbWQuZ2V0T3B0aW9uVmFsdWUoInNlbmRs\naW1pdCIsICIyMDAwMDAwMCIpKTsKCiAgICAgICAgZmluYWwgaW50IHNvY2tU\naW1lb3V0ID0gSW50ZWdlci52YWx1ZU9mKGNtZC5nZXRPcHRpb25WYWx1ZSgi\nc29ja2V0dGltZW91dCIsICI1IikpOwoKICAgICAgICBTdHJpbmcgY29vcmRp\nbmF0aW9uWm5vZGUgPSBjbWQuZ2V0T3B0aW9uVmFsdWUoImNvb3Jkbm9kZSIp\nOwogICAgICAgIGZpbmFsIGJ5dGVbXSBwYXNzd2QgPSBjbWQuZ2V0T3B0aW9u\nVmFsdWUoInBhc3N3b3JkIiwgImJlbmNoUGFzc3dkIikuZ2V0Qnl0ZXMoKTsK\nCiAgICAgICAgU3RyaW5nIGxhdGVuY3lGaWxlID0gY21kLmdldE9wdGlvblZh\nbHVlKCJsYXRlbmN5RmlsZSIsICJsYXRlbmN5RHVtcC5kYXQiKTsKCiAgICAg\nICAgVGltZXIgdGltZW91dGVyID0gbmV3IFRpbWVyKCk7CiAgICAgICAgaWYg\nKGNtZC5oYXNPcHRpb24oInRpbWVvdXQiKSkgewogICAgICAgICAgICBmaW5h\nbCBsb25nIHRpbWVvdXQgPSBMb25nLnZhbHVlT2YoY21kLmdldE9wdGlvblZh\nbHVlKCJ0aW1lb3V0IiwgIjM2MCIpKSAqIDEwMDA7CgogICAgICAgICAgICB0\naW1lb3V0ZXIuc2NoZWR1bGUobmV3IFRpbWVyVGFzaygpIHsKICAgICAgICAg\nICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiVGltaW5nIG91dCBiZW5j\naG1hcmsgYWZ0ZXIgIiArIHRpbWVvdXQgKyAibXMiKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgU3lzdGVtLmV4aXQoLTEpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0sIHRpbWVvdXQpOwogICAgICAgIH0K\nCiAgICAgICAgTE9HLndhcm4oIihQYXJhbWV0ZXJzIHJlY2VpdmVkKSBydW5u\naW5nIHRpbWU6ICIgKyBydW5uaW5nVGltZSArCiAgICAgICAgICAgICAgICAi\nLCBlbnRyeSBzaXplOiAiICsgZW50cnlzaXplICsgIiwgZW5zZW1ibGUgc2l6\nZTogIiArIGVuc2VtYmxlICsKICAgICAgICAgICAgICAgICIsIHF1b3J1bSBz\naXplOiAiICsgcXVvcnVtICsKICAgICAgICAgICAgICAgICIsIHRocm90dGxl\nOiAiICsgdGhyb3R0bGUgKwogICAgICAgICAgICAgICAgIiwgbnVtYmVyIG9m\nIGxlZGdlcnM6ICIgKyBsZWRnZXJzICsKICAgICAgICAgICAgICAgICIsIHpr\nIHNlcnZlcnM6ICIgKyBzZXJ2ZXJzICsKICAgICAgICAgICAgICAgICIsIGxh\ndGVuY3kgZmlsZTogIiArIGxhdGVuY3lGaWxlKTsKCiAgICAgICAgbG9uZyB0\nb3RhbFRpbWUgPSBydW5uaW5nVGltZSoxMDAwOwoKICAgICAgICAvLyBEbyBh\nIHdhcm11cCBydW4KICAgICAgICBUaHJlYWQgdGhyZWFkOwoKICAgICAgICBi\neXRlIGRhdGFbXSA9IG5ldyBieXRlW2VudHJ5c2l6ZV07CiAgICAgICAgQXJy\nYXlzLmZpbGwoZGF0YSwgKGJ5dGUpJ3gnKTsKCiAgICAgICAgQ2xpZW50Q29u\nZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsK\nICAgICAgICBjb25mLnNldFRocm90dGxlVmFsdWUodGhyb3R0bGUpLnNldFJl\nYWRUaW1lb3V0KHNvY2tUaW1lb3V0KS5zZXRaa1NlcnZlcnMoc2VydmVycyk7\nCgogICAgICAgIGlmICghY21kLmhhc09wdGlvbigic2tpcHdhcm11cCIpKSB7\nCiAgICAgICAgICAgIGxvbmcgdGhyb3VnaHB1dDsKICAgICAgICAgICAgTE9H\nLmluZm8oIlN0YXJ0aW5nIHdhcm11cCIpOwoKICAgICAgICAgICAgdGhyb3Vn\naHB1dCA9IHdhcm1VcChkYXRhLCBsZWRnZXJzLCBlbnNlbWJsZSwgcXVvcnVt\nLCBwYXNzd2QsIGNvbmYpOwogICAgICAgICAgICBMT0cuaW5mbygiV2FybXVw\nIHRwOiAiICsgdGhyb3VnaHB1dCk7CiAgICAgICAgICAgIExPRy5pbmZvKCJX\nYXJtdXAgcGhhc2UgZmluaXNoZWQiKTsKICAgICAgICB9CgoKICAgICAgICAv\nLyBOb3cgZG8gdGhlIGJlbmNobWFyawogICAgICAgIEJlbmNoVGhyb3VnaHB1\ndExhdGVuY3kgYmVuY2ggPSBuZXcgQmVuY2hUaHJvdWdocHV0TGF0ZW5jeShl\nbnNlbWJsZSwgcXVvcnVtLCBhY2tRdW9ydW0sCiAgICAgICAgICAgICAgICBw\nYXNzd2QsIGxlZGdlcnMsIHNlbmRMaW1pdCwgY29uZik7CiAgICAgICAgYmVu\nY2guc2V0RW50cnlEYXRhKGRhdGEpOwogICAgICAgIHRocmVhZCA9IG5ldyBU\naHJlYWQoYmVuY2gpOwogICAgICAgIFpvb0tlZXBlciB6ayA9IG51bGw7Cgog\nICAgICAgIGlmIChjb29yZGluYXRpb25abm9kZSAhPSBudWxsKSB7CiAgICAg\nICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIGNvbm5lY3RMYXRjaCA9IG5l\ndyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICAgICAgemsgPSBuZXcgWm9v\nS2VlcGVyKHNlcnZlcnMsIDE1MDAwLCBuZXcgV2F0Y2hlcigpIHsKICAgICAg\nICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBw\ndWJsaWMgdm9pZCBwcm9jZXNzKFdhdGNoZWRFdmVudCBldmVudCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZ2V0U3RhdGUoKSA9PSBL\nZWVwZXJTdGF0ZS5TeW5jQ29ubmVjdGVkKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjb25uZWN0TGF0Y2guY291bnREb3duKCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9fSk7CiAg\nICAgICAgICAgIGlmICghY29ubmVjdExhdGNoLmF3YWl0KDEwLCBUaW1lVW5p\ndC5TRUNPTkRTKSkgewogICAgICAgICAgICAgICAgTE9HLmVycm9yKCJDb3Vs\nZG4ndCBjb25uZWN0IHRvIHpvb2tlZXBlciBhdCAiICsgc2VydmVycyk7CiAg\nICAgICAgICAgICAgICB6ay5jbG9zZSgpOwogICAgICAgICAgICAgICAgU3lz\ndGVtLmV4aXQoLTEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmaW5h\nbCBDb3VudERvd25MYXRjaCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgx\nKTsKICAgICAgICAgICAgTE9HLmluZm8oIldhaXRpbmcgZm9yICIgKyBjb29y\nZGluYXRpb25abm9kZSk7CiAgICAgICAgICAgIGlmICh6ay5leGlzdHMoY29v\ncmRpbmF0aW9uWm5vZGUsIG5ldyBXYXRjaGVyKCkgewogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9j\nZXNzKFdhdGNoZWRFdmVudCBldmVudCkgewogICAgICAgICAgICAgICAgICAg\nIGlmIChldmVudC5nZXRUeXBlKCkgPT0gRXZlbnRUeXBlLk5vZGVDcmVhdGVk\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigp\nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH19KSAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBsYXRjaC5hd2FpdCgpOwogICAg\nICAgICAgICBMT0cuaW5mbygiQ29vcmRpbmF0aW9uIHpub2RlIGNyZWF0ZWQi\nKTsKICAgICAgICB9CiAgICAgICAgdGhyZWFkLnN0YXJ0KCk7CiAgICAgICAg\nVGhyZWFkLnNsZWVwKHRvdGFsVGltZSk7CiAgICAgICAgdGhyZWFkLmludGVy\ncnVwdCgpOwogICAgICAgIHRocmVhZC5qb2luKCk7CgogICAgICAgIExPRy5p\nbmZvKCJDYWxjdWxhdGluZyBwZXJjZW50aWxlcyIpOwoKICAgICAgICBpbnQg\nbnVtbGF0ID0gMDsKICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgYmVuY2gu\nbGF0ZW5jaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChiZW5j\naC5sYXRlbmNpZXNbaV0gPiAwKSB7CiAgICAgICAgICAgICAgICBudW1sYXQr\nKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpbnQgbnVtY29t\ncGxldGlvbnMgPSBudW1sYXQ7CiAgICAgICAgbnVtbGF0ID0gTWF0aC5taW4o\nYmVuY2guc2VuZExpbWl0LCBudW1sYXQpOwogICAgICAgIGxvbmdbXSBsYXRl\nbmN5ID0gbmV3IGxvbmdbbnVtbGF0XTsKICAgICAgICBpbnQgaiA9MDsKICAg\nICAgICBmb3IoaW50IGkgPSAwOyBpIDwgYmVuY2gubGF0ZW5jaWVzLmxlbmd0\naCAmJiBqIDwgbnVtbGF0OyBpKyspIHsKICAgICAgICAgICAgaWYgKGJlbmNo\nLmxhdGVuY2llc1tpXSA+IDApIHsKICAgICAgICAgICAgICAgIGxhdGVuY3lb\naisrXSA9IGJlbmNoLmxhdGVuY2llc1tpXTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICBBcnJheXMuc29ydChsYXRlbmN5KTsKCiAgICAgICAg\nbG9uZyB0cCA9IChsb25nKSgoZG91YmxlKShudW1jb21wbGV0aW9ucyoxMDAw\nLjApLyhkb3VibGUpYmVuY2guZ2V0RHVyYXRpb24oKSk7CgogICAgICAgIExP\nRy5pbmZvKG51bWNvbXBsZXRpb25zICsgIiBjb21wbGV0aW9ucyBpbiAiICsg\nYmVuY2guZ2V0RHVyYXRpb24oKSArICIgc2Vjb25kczogIiArIHRwICsgIiBv\ncHMvc2VjIik7CgogICAgICAgIGlmICh6ayAhPSBudWxsKSB7CiAgICAgICAg\nICAgIHprLmNyZWF0ZShjb29yZGluYXRpb25abm9kZSArICIvd29ya2VyLSIs\nCiAgICAgICAgICAgICAgICAgICAgICAoInRwICIgKyB0cCArICIgZHVyYXRp\nb24gIiArIGJlbmNoLmdldER1cmF0aW9uKCkpLmdldEJ5dGVzKCksCiAgICAg\nICAgICAgICAgICAgICAgICBab29EZWZzLklkcy5PUEVOX0FDTF9VTlNBRkUs\nIENyZWF0ZU1vZGUuUEVSU0lTVEVOVF9TRVFVRU5USUFMKTsKICAgICAgICAg\nICAgemsuY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIC8vIGR1bXAgdGhl\nIGxhdGVuY2llcyBmb3IgbGF0ZXIgZGVidWdnaW5nIChpdCB3aWxsIGJlIHNv\ncnRlZCBieSBlbnRyeWlkKQogICAgICAgIE91dHB1dFN0cmVhbSBmb3MgPSBu\nZXcgQnVmZmVyZWRPdXRwdXRTdHJlYW0obmV3IEZpbGVPdXRwdXRTdHJlYW0o\nbGF0ZW5jeUZpbGUpKTsKCiAgICAgICAgZm9yKExvbmcgbDogbGF0ZW5jeSkg\newogICAgICAgICAgICBmb3Mud3JpdGUoKExvbmcudG9TdHJpbmcobCkrIlx0\nIisobC8xMDAwMDAwKSsgIm1zXG4iKS5nZXRCeXRlcygpKTsKICAgICAgICB9\nCiAgICAgICAgZm9zLmZsdXNoKCk7CiAgICAgICAgZm9zLmNsb3NlKCk7Cgog\nICAgICAgIC8vIG5vdyBnZXQgdGhlIGxhdGVuY2llcwogICAgICAgIExPRy5p\nbmZvKCI5OXRoIHBlcmNlbnRpbGUgbGF0ZW5jeToge30iLCBwZXJjZW50aWxl\nKGxhdGVuY3ksIDk5KSk7CiAgICAgICAgTE9HLmluZm8oIjk1dGggcGVyY2Vu\ndGlsZSBsYXRlbmN5OiB7fSIsIHBlcmNlbnRpbGUobGF0ZW5jeSwgOTUpKTsK\nCiAgICAgICAgYmVuY2guY2xvc2UoKTsKICAgICAgICB0aW1lb3V0ZXIuY2Fu\nY2VsKCk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZG91YmxlIHBlcmNl\nbnRpbGUobG9uZ1tdIGxhdGVuY3ksIGludCBwZXJjZW50aWxlKSB7CiAgICAg\nICAgaW50IHNpemUgPSBsYXRlbmN5Lmxlbmd0aDsKICAgICAgICBpbnQgc2Ft\ncGxlU2l6ZSA9IChzaXplICogcGVyY2VudGlsZSkgLyAxMDA7CiAgICAgICAg\nbG9uZyB0b3RhbCA9IDA7CiAgICAgICAgaW50IGNvdW50ID0gMDsKICAgICAg\nICBmb3IoaW50IGkgPSAwOyBpIDwgc2FtcGxlU2l6ZTsgaSsrKSB7CiAgICAg\nICAgICAgIHRvdGFsICs9IGxhdGVuY3lbaV07CiAgICAgICAgICAgIGNvdW50\nKys7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoKGRvdWJsZSl0b3RhbC8o\nZG91YmxlKWNvdW50KS8xMDAwMDAwLjA7CiAgICB9CgogICAgcHJpdmF0ZSBz\ndGF0aWMgbG9uZyB3YXJtVXAoYnl0ZVtdIGRhdGEsIGludCBsZWRnZXJzLCBp\nbnQgZW5zZW1ibGUsIGludCBxU2l6ZSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGJ5dGVbXSBwYXNzd2QsIENsaWVudENvbmZpZ3VyYXRpb24g\nY29uZikKICAgICAgICAgICAgdGhyb3dzIEtlZXBlckV4Y2VwdGlvbiwgSU9F\neGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7\nCiAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggY29ubmVjdExhdGNoID0g\nbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgIGZpbmFsIGludCBib29r\naWVzOwogICAgICAgIFN0cmluZyBib29raWVSZWdpc3RyYXRpb25QYXRoID0g\nY29uZi5nZXRaa0F2YWlsYWJsZUJvb2tpZXNQYXRoKCk7CiAgICAgICAgWm9v\nS2VlcGVyIHprID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBm\naW5hbCBTdHJpbmcgc2VydmVycyA9IGNvbmYuZ2V0WmtTZXJ2ZXJzKCk7CiAg\nICAgICAgICAgIHprID0gbmV3IFpvb0tlZXBlcihzZXJ2ZXJzLCAxNTAwMCwg\nbmV3IFdhdGNoZXIoKSB7CiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRj\naGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKGV2ZW50LmdldFN0YXRlKCkgPT0gS2VlcGVyU3RhdGUuU3luY0Nvbm5lY3Rl\nZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdExhdGNo\nLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgfX0pOwogICAgICAgICAgICBpZiAoIWNvbm5lY3RM\nYXRjaC5hd2FpdCgxMCwgVGltZVVuaXQuU0VDT05EUykpIHsKICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiQ291bGRuJ3QgY29ubmVjdCB0byB6b29rZWVw\nZXIgYXQgIiArIHNlcnZlcnMpOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIElPRXhjZXB0aW9uKCJDb3VsZG4ndCBjb25uZWN0IHRvIHpvb2tlZXBlciAi\nICsgc2VydmVycyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYm9va2ll\ncyA9IHprLmdldENoaWxkcmVuKGJvb2tpZVJlZ2lzdHJhdGlvblBhdGgsIGZh\nbHNlKS5zaXplKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\naWYgKHprICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHprLmNsb3NlKCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEJlbmNoVGhyb3Vn\naHB1dExhdGVuY3kgd2FybXVwID0gbmV3IEJlbmNoVGhyb3VnaHB1dExhdGVu\nY3koYm9va2llcywgYm9va2llcywgYm9va2llcywgcGFzc3dkLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbGVkZ2VycywgMTAwMDAsIGNvbmYpOwogICAgICAg\nIHdhcm11cC5zZXRFbnRyeURhdGEoZGF0YSk7CiAgICAgICAgVGhyZWFkIHRo\ncmVhZCA9IG5ldyBUaHJlYWQod2FybXVwKTsKICAgICAgICB0aHJlYWQuc3Rh\ncnQoKTsKICAgICAgICB0aHJlYWQuam9pbigpOwogICAgICAgIHdhcm11cC5j\nbG9zZSgpOwogICAgICAgIHJldHVybiB3YXJtdXAuZ2V0VGhyb3VnaHB1dCgp\nOwogICAgfQp9Cg==\n","encoding":"base64"}

