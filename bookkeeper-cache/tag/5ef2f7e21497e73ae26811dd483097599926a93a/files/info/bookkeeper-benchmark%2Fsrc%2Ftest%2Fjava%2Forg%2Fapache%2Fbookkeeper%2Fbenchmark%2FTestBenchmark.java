{"sha":"269ea5894f9a01bcda5c44e1cbac8e582dc1dc6b","node_id":"MDQ6QmxvYjE1NzU5NTY6MjY5ZWE1ODk0ZjlhMDFiY2RhNWM0NGUxY2JhYzhlNTgyZGMxZGM2Yg==","size":6001,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/269ea5894f9a01bcda5c44e1cbac8e582dc1dc6b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0\naGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z\nIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICov\nCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJlbmNobWFyazsKCmlt\ncG9ydCBvcmcuanVuaXQuQmVmb3JlQ2xhc3M7CmltcG9ydCBvcmcuanVuaXQu\nQWZ0ZXJDbGFzczsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQgb3Jn\nLmp1bml0LkFzc2VydDsKCmltcG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0QWRk\ncmVzczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9v\na0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQu\nTGVkZ2VySGFuZGxlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0\naWwuTG9jYWxCb29rS2VlcGVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnRlc3QuQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZTsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9y\neTsKCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRj\naDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0OwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jvb2xlYW47\nCgppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLktlZXBlckV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVu\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyLkV2ZW50LkV2ZW50VHlwZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXIuRXZlbnQuS2VlcGVy\nU3RhdGU7CgpwdWJsaWMgY2xhc3MgVGVzdEJlbmNobWFyayBleHRlbmRzIEJv\nb2tLZWVwZXJDbHVzdGVyVGVzdENhc2UgewogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIo\nVGVzdEJlbmNobWFyay5jbGFzcyk7CgogICAgcHVibGljIFRlc3RCZW5jaG1h\ncmsoKSB7CiAgICAgICAgc3VwZXIoNSk7CiAgICB9CgogICAgQFRlc3QodGlt\nZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RUaHJvdWdocHV0TGF0\nZW5jeSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBsYXRl\nbmN5RmlsZSA9IFN5c3RlbS5nZXRQcm9wZXJ0eSgidGVzdC5sYXRlbmN5LmZp\nbGUiLCAibGF0ZW5jeUR1bXAuZGF0Iik7CiAgICAgICAgQmVuY2hUaHJvdWdo\ncHV0TGF0ZW5jeS5tYWluKG5ldyBTdHJpbmdbXSB7CiAgICAgICAgICAgICAg\nICAiLS16b29rZWVwZXIiLCB6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0\ncmluZygpLAogICAgICAgICAgICAgICAgIi0tdGltZSIsICIxMCIsCiAgICAg\nICAgICAgICAgICAiLS1za2lwd2FybXVwIiwKICAgICAgICAgICAgICAgICIt\nLXRocm90dGxlIiwgIjEiLAogICAgICAgICAgICAgICAgIi0tc2VuZGxpbWl0\nIiwgIjEwMDAwIiwKICAgICAgICAgICAgICAgICItLWxhdGVuY3lGaWxlIiwg\nbGF0ZW5jeUZpbGUKICAgICAgICAgICAgfSk7CiAgICB9CgogICAgQFRlc3Qo\ndGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RCb29raWUoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBJbmV0U29ja2V0QWRkcmVzcyBi\nb29raWUgPSBnZXRCb29raWUoMCk7CiAgICAgICAgQmVuY2hCb29raWUubWFp\nbihuZXcgU3RyaW5nW10gewogICAgICAgICAgICAgICAgIi0taG9zdCIsIGJv\nb2tpZS5nZXRIb3N0TmFtZSgpLAogICAgICAgICAgICAgICAgIi0tcG9ydCIs\nIFN0cmluZy52YWx1ZU9mKGJvb2tpZS5nZXRQb3J0KCkpLAogICAgICAgICAg\nICAgICAgIi0tem9va2VlcGVyIiwgemtVdGlsLmdldFpvb0tlZXBlckNvbm5l\nY3RTdHJpbmcoKQogICAgICAgICAgICAgICAgfSk7CiAgICB9CgogICAgQFRl\nc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RSZWFkVGhy\nb3VnaHB1dExhdGVuY3koKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBm\naW5hbCBBdG9taWNCb29sZWFuIHRocmV3RXhjZXB0aW9uID0gbmV3IEF0b21p\nY0Jvb2xlYW4oZmFsc2UpOwogICAgICAgIFRocmVhZCB0ID0gbmV3IFRocmVh\nZCgpIHsKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAg\nICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAg\nICBCZW5jaFJlYWRUaHJvdWdocHV0TGF0ZW5jeS5tYWluKG5ldyBTdHJpbmdb\nXSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIi0tem9va2Vl\ncGVyIiwgemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiLS1saXN0ZW4iLCAiMTAi\nfSk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJvciBy\nZWFkaW5nIiwgdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocmV3RXhj\nZXB0aW9uLnNldCh0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgdC5zdGFydCgp\nOwoKICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMDApOwogICAgICAgIGJ5dGUg\nZGF0YVtdID0gbmV3IGJ5dGVbMTAyNF07CiAgICAgICAgQXJyYXlzLmZpbGwo\nZGF0YSwgKGJ5dGUpJ3gnKTsKCiAgICAgICAgbG9uZyBsYXN0TGVkZ2VySWQg\nPSAwOwogICAgICAgIEFzc2VydC5hc3NlcnRUcnVlKCJUaHJlYWQgc2hvdWxk\nIGJlIHJ1bm5pbmciLCB0LmlzQWxpdmUoKSk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIEJvb2tLZWVwZXIg\nYmsgPSBuZXcgQm9va0tlZXBlcih6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVj\ndFN0cmluZygpKTsKICAgICAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmsu\nY3JlYXRlTGVkZ2VyKEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwgImJl\nbmNoUGFzc3dkIi5nZXRCeXRlcygpKTsKICAgICAgICAgICAgbGFzdExlZGdl\ncklkID0gbGguZ2V0SWQoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgMTAwOyBqKyspIHsKICAgICAg\nICAgICAgICAgICAgICBsaC5hZGRFbnRyeShkYXRhKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nIGxoLmNsb3NlKCk7CiAgICAgICAgICAgICAgICBiay5jbG9zZSgpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgNjA7IGkrKykgewogICAgICAgICAgICBpZiAoIXQuaXNBbGl2ZSgpKSB7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7IC8vIHdhaXQgZm9yIDEwIHNlY29u\nZHMgZm9yIHJlYWRpbmcgdG8gZmluaXNoCiAgICAgICAgfQoKICAgICAgICBB\nc3NlcnQuYXNzZXJ0RmFsc2UoIlRocmVhZCBzaG91bGQgYmUgZmluaXNoZWQi\nLCB0LmlzQWxpdmUoKSk7CgogICAgICAgIEJlbmNoUmVhZFRocm91Z2hwdXRM\nYXRlbmN5Lm1haW4obmV3IFN0cmluZ1tdIHsKICAgICAgICAgICAgICAgICIt\nLXpvb2tlZXBlciIsIHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5n\nKCksCiAgICAgICAgICAgICAgICAiLS1sZWRnZXIiLCBTdHJpbmcudmFsdWVP\nZihsYXN0TGVkZ2VySWQpfSk7CgogICAgICAgIGZpbmFsIGxvbmcgbmV4dExl\nZGdlcklkID0gbGFzdExlZGdlcklkKzE7CiAgICAgICAgdCA9IG5ldyBUaHJl\nYWQoKSB7CiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAg\nICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAg\nICAgQmVuY2hSZWFkVGhyb3VnaHB1dExhdGVuY3kubWFpbihuZXcgU3RyaW5n\nW10gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICItLXpvb2tl\nZXBlciIsIHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCksCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIi0tbGVkZ2VyIiwgU3Ry\naW5nLnZhbHVlT2YobmV4dExlZGdlcklkKX0pOwogICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiRXJyb3IgcmVhZGluZyIsIHQpOwogICAgICAg\nICAgICAgICAgICAgICAgICB0aHJld0V4Y2VwdGlvbi5zZXQodHJ1ZSk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9OwogICAgICAgIHQuc3RhcnQoKTsKCiAgICAgICAgQXNzZXJ0LmFz\nc2VydFRydWUoIlRocmVhZCBzaG91bGQgYmUgcnVubmluZyIsIHQuaXNBbGl2\nZSgpKTsKICAgICAgICBCb29rS2VlcGVyIGJrID0gbmV3IEJvb2tLZWVwZXIo\nemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSk7CiAgICAgICAg\nTGVkZ2VySGFuZGxlIGxoID0gYmsuY3JlYXRlTGVkZ2VyKEJvb2tLZWVwZXIu\nRGlnZXN0VHlwZS5DUkMzMiwgImJlbmNoUGFzc3dkIi5nZXRCeXRlcygpKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8\nIDEwMDsgaisrKSB7CiAgICAgICAgICAgICAgICBsaC5hZGRFbnRyeShkYXRh\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGxoLmNsb3NlKCk7CiAgICAgICAgICAgIGJrLmNsb3NlKCk7CiAgICAg\nICAgfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNjA7IGkrKykgewog\nICAgICAgICAgICBpZiAoIXQuaXNBbGl2ZSgpKSB7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBUaHJlYWQuc2xl\nZXAoMTAwMCk7IC8vIHdhaXQgZm9yIDEwIHNlY29uZHMgZm9yIHJlYWRpbmcg\ndG8gZmluaXNoCiAgICAgICAgfQogICAgICAgIEFzc2VydC5hc3NlcnRGYWxz\nZSgiVGhyZWFkIHNob3VsZCBiZSBmaW5pc2hlZCIsIHQuaXNBbGl2ZSgpKTsK\nICAgICAgICBBc3NlcnQuYXNzZXJ0RmFsc2UoIkEgdGhyZWFkIGhhcyB0aHJv\nd24gYW4gZXhjZXB0aW9uLCBjaGVjayBsb2dzIiwgdGhyZXdFeGNlcHRpb24u\nZ2V0KCkpOwogICAgfQp9Cg==\n","encoding":"base64"}

