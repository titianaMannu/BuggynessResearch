{"sha":"9bcb26dbdad9c6274dbe4dae4df7f5bbf85e7098","node_id":"MDQ6QmxvYjE1NzU5NTY6OWJjYjI2ZGJkYWQ5YzYyNzRkYmU0ZGFlNGRmN2Y1YmJmODVlNzA5OA==","size":31154,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/9bcb26dbdad9c6274dbe4dae4df7f5bbf85e7098","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVOb3RGb3VuZEV4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZh\nLm5ldC5JbmV0U29ja2V0QWRkcmVzczsKaW1wb3J0IGphdmEubmlvLkJ5dGVC\ndWZmZXI7CmltcG9ydCBqYXZhLnV0aWwuRm9ybWF0dGVyOwppbXBvcnQgamF2\nYS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0\nIG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlck1hbmFnZXJGYWN0b3J5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyVW5kZXJy\nZXBsaWNhdGlvbk1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuem9va2VlcGVyLlpvb0tlZXBlcldhdGNoZXJCYXNlOwoKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuRW50cnlMb2dnZXIuRW50cnlM\nb2dTY2FubmVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tp\nZS5Kb3VybmFsLkpvdXJuYWxTY2FubmVyOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmJvb2tpZS5Kb3VybmFsLkxhc3RMb2dNYXJrOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlckFk\nbWluOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIudXRpbC5FbnRyeUZvcm1hdHRlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci51dGlsLlRvb2w7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIudXRpbC5aa1V0aWxzOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5jb25maWd1cmF0aW9uLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5Db21wb3NpdGVDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbmZpZ3VyYXRp\nb24uUHJvcGVydGllc0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMuY2xpLkJhc2ljUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmNsaS5NaXNzaW5nQXJndW1lbnRFeGNlcHRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLmNvbW1vbnMuY2xpLk9wdGlvbnM7CmltcG9ydCBvcmcuYXBh\nY2hlLmNvbW1vbnMuY2xpLkNvbW1hbmRMaW5lOwppbXBvcnQgb3JnLmFwYWNo\nZS5jb21tb25zLmNsaS5IZWxwRm9ybWF0dGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5jb21tb25zLmNsaS5QYXJzZUV4Y2VwdGlvbjsKCmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7Cgov\nKioKICogQm9va2llIFNoZWxsIGlzIHRvIHByb3ZpZGUgdXRpbGl0aWVzIGZv\nciB1c2VycyB0byBhZG1pbmlzdGVyIGEgYm9va2tlZXBlciBjbHVzdGVyLgog\nKi8KcHVibGljIGNsYXNzIEJvb2tpZVNoZWxsIGltcGxlbWVudHMgVG9vbCB7\nCgogICAgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5\nLmdldExvZ2dlcihCb29raWVTaGVsbC5jbGFzcyk7CgogICAgc3RhdGljIGZp\nbmFsIFN0cmluZyBFTlRSWV9GT1JNQVRURVJfQ0xBU1MgPSAiZW50cnlGb3Jt\nYXR0ZXJDbGFzcyI7CgogICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfTUVU\nQUZPUk1BVCA9ICJtZXRhZm9ybWF0IjsKICAgIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgQ01EX0JPT0tJRUZPUk1BVCA9ICJib29raWVmb3JtYXQiOwogICAgc3Rh\ndGljIGZpbmFsIFN0cmluZyBDTURfUkVDT1ZFUiA9ICJyZWNvdmVyIjsKICAg\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX0xFREdFUiA9ICJsZWRnZXIiOwog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfUkVBRExPRyA9ICJyZWFkbG9n\nIjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX1JFQURKT1VSTkFMID0g\nInJlYWRqb3VybmFsIjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX0xB\nU1RNQVJLID0gImxhc3RtYXJrIjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcg\nQ01EX0FVVE9SRUNPVkVSWSA9ICJhdXRvcmVjb3ZlcnkiOwogICAgc3RhdGlj\nIGZpbmFsIFN0cmluZyBDTURfSEVMUCA9ICJoZWxwIjsKCiAgICBmaW5hbCBT\nZXJ2ZXJDb25maWd1cmF0aW9uIGJrQ29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1\ncmF0aW9uKCk7CiAgICBGaWxlW10gbGVkZ2VyRGlyZWN0b3JpZXM7CiAgICBG\naWxlIGpvdXJuYWxEaXJlY3Rvcnk7CgogICAgRW50cnlMb2dnZXIgZW50cnlM\nb2dnZXIgPSBudWxsOwogICAgSm91cm5hbCBqb3VybmFsID0gbnVsbDsKICAg\nIEVudHJ5Rm9ybWF0dGVyIGZvcm1hdHRlcjsKCiAgICBpbnQgcGFnZVNpemU7\nCiAgICBpbnQgZW50cmllc1BlclBhZ2U7CgogICAgaW50ZXJmYWNlIENvbW1h\nbmQgewogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKFN0cmluZ1tdIGFyZ3Mp\nIHRocm93cyBFeGNlcHRpb247CiAgICAgICAgcHVibGljIHZvaWQgcHJpbnRV\nc2FnZSgpOwogICAgfQoKICAgIGFic3RyYWN0IGNsYXNzIE15Q29tbWFuZCBp\nbXBsZW1lbnRzIENvbW1hbmQgewogICAgICAgIGFic3RyYWN0IE9wdGlvbnMg\nZ2V0T3B0aW9ucygpOwogICAgICAgIGFic3RyYWN0IFN0cmluZyBnZXREZXNj\ncmlwdGlvbigpOwogICAgICAgIGFic3RyYWN0IFN0cmluZyBnZXRVc2FnZSgp\nOwogICAgICAgIGFic3RyYWN0IGludCBydW5DbWQoQ29tbWFuZExpbmUgY21k\nTGluZSkgdGhyb3dzIEV4Y2VwdGlvbjsKCiAgICAgICAgU3RyaW5nIGNtZE5h\nbWU7CgogICAgICAgIE15Q29tbWFuZChTdHJpbmcgY21kTmFtZSkgewogICAg\nICAgICAgICB0aGlzLmNtZE5hbWUgPSBjbWROYW1lOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBydW5DbWQoU3Ry\naW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBCYXNpY1BhcnNlciBwYXJzZXIgPSBuZXcg\nQmFzaWNQYXJzZXIoKTsKICAgICAgICAgICAgICAgIENvbW1hbmRMaW5lIGNt\nZExpbmUgPSBwYXJzZXIucGFyc2UoZ2V0T3B0aW9ucygpLCBhcmdzKTsKICAg\nICAgICAgICAgICAgIHJldHVybiBydW5DbWQoY21kTGluZSk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKFBhcnNlRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIExPRy5lcnJvcigiRXJyb3IgcGFyc2luZyBjb21tYW5kIGxpbmUgYXJn\ndW1lbnRzIDogIiwgZSk7CiAgICAgICAgICAgICAgICBwcmludFVzYWdlKCk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lk\nIHByaW50VXNhZ2UoKSB7CiAgICAgICAgICAgIEhlbHBGb3JtYXR0ZXIgaGYg\nPSBuZXcgSGVscEZvcm1hdHRlcigpOwogICAgICAgICAgICBTeXN0ZW0uZXJy\nLnByaW50bG4oY21kTmFtZSArICI6ICIgKyBnZXREZXNjcmlwdGlvbigpKTsK\nICAgICAgICAgICAgaGYucHJpbnRIZWxwKGdldFVzYWdlKCksIGdldE9wdGlv\nbnMoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRm9ybWF0\nIHRoZSBib29ra2VlcGVyIG1ldGFkYXRhIHByZXNlbnQgaW4gem9va2VlcGVy\nCiAgICAgKi8KICAgIGNsYXNzIE1ldGFGb3JtYXRDbWQgZXh0ZW5kcyBNeUNv\nbW1hbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7\nCgogICAgICAgIE1ldGFGb3JtYXRDbWQoKSB7CiAgICAgICAgICAgIHN1cGVy\nKENNRF9NRVRBRk9STUFUKTsKICAgICAgICAgICAgb3B0cy5hZGRPcHRpb24o\nIm4iLCAibm9uSW50ZXJhY3RpdmUiLCBmYWxzZSwKICAgICAgICAgICAgICAg\nICAgICAiV2hldGhlciB0byBjb25maXJtIGlmIG9sZCBkYXRhIGV4aXN0cy4u\nPyIpOwogICAgICAgICAgICBvcHRzLmFkZE9wdGlvbigiZiIsICJmb3JjZSIs\nIGZhbHNlLAogICAgICAgICAgICAgICAgICAgICJJZiBbbm9uSW50ZXJhY3Rp\ndmVdIGlzIHNwZWNpZmllZCwgdGhlbiB3aGV0aGVyIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyAiIHRvIGZvcmNlIGRlbGV0ZSB0aGUgb2xkIGRh\ndGEgd2l0aG91dCBwcm9tcHQuIik7CiAgICAgICAgfQoKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBPcHRpb25zIGdldE9wdGlvbnMoKSB7CiAgICAgICAg\nICAgIHJldHVybiBvcHRzOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAgICAg\nICByZXR1cm4gIkZvcm1hdCBib29ra2VlcGVyIG1ldGFkYXRhIGluIHpvb2tl\nZXBlciI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBT\ndHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJldHVybiAibWV0YWZv\ncm1hdCBbLW5vbkludGVyYWN0aXZlXSBbLWZvcmNlXSI7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRM\naW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBi\nb29sZWFuIGludGVyYWN0aXZlID0gKCFjbWRMaW5lLmhhc09wdGlvbigibiIp\nKTsKICAgICAgICAgICAgYm9vbGVhbiBmb3JjZSA9IGNtZExpbmUuaGFzT3B0\naW9uKCJmIik7CgogICAgICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uIGFk\nbWluQ29uZiA9IG5ldyBDbGllbnRDb25maWd1cmF0aW9uKGJrQ29uZik7CiAg\nICAgICAgICAgIGJvb2xlYW4gcmVzdWx0ID0gQm9va0tlZXBlckFkbWluLmZv\ncm1hdChhZG1pbkNvbmYsIGludGVyYWN0aXZlLAogICAgICAgICAgICAgICAg\nICAgIGZvcmNlKTsKICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQpID8gMCA6\nIDE7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRm9ybWF0cyB0\naGUgbG9jYWwgZGF0YSBwcmVzZW50IGluIGN1cnJlbnQgYm9va2llIHNlcnZl\ncgogICAgICovCiAgICBjbGFzcyBCb29raWVGb3JtYXRDbWQgZXh0ZW5kcyBN\neUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25z\nKCk7CgogICAgICAgIHB1YmxpYyBCb29raWVGb3JtYXRDbWQoKSB7CiAgICAg\nICAgICAgIHN1cGVyKENNRF9CT09LSUVGT1JNQVQpOwogICAgICAgICAgICBv\ncHRzLmFkZE9wdGlvbigibiIsICJub25JbnRlcmFjdGl2ZSIsIGZhbHNlLAog\nICAgICAgICAgICAgICAgICAgICJXaGV0aGVyIHRvIGNvbmZpcm0gaWYgb2xk\nIGRhdGEgZXhpc3RzLi4/Iik7CiAgICAgICAgICAgIG9wdHMuYWRkT3B0aW9u\nKCJmIiwgImZvcmNlIiwgZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgIklm\nIFtub25JbnRlcmFjdGl2ZV0gaXMgc3BlY2lmaWVkLCB0aGVuIHdoZXRoZXIi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgdG8gZm9yY2UgZGVs\nZXRlIHRoZSBvbGQgZGF0YSB3aXRob3V0IHByb21wdC4uPyIpOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRp\nb25zKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlv\nbigpIHsKICAgICAgICAgICAgcmV0dXJuICJGb3JtYXQgdGhlIGN1cnJlbnQg\nc2VydmVyIGNvbnRlbnRzIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuICJib29raWVmb3JtYXQgWy1ub25JbnRlcmFjdGl2ZV0gWy1mb3JjZV0i\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgaW50IHJ1\nbkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgYm9vbGVhbiBpbnRlcmFjdGl2ZSA9ICghY21kTGluZS5o\nYXNPcHRpb24oIm4iKSk7CiAgICAgICAgICAgIGJvb2xlYW4gZm9yY2UgPSBj\nbWRMaW5lLmhhc09wdGlvbigiZiIpOwoKICAgICAgICAgICAgU2VydmVyQ29u\nZmlndXJhdGlvbiBjb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmtD\nb25mKTsKICAgICAgICAgICAgYm9vbGVhbiByZXN1bHQgPSBCb29raWUuZm9y\nbWF0KGNvbmYsIGludGVyYWN0aXZlLCBmb3JjZSk7CiAgICAgICAgICAgIHJl\ndHVybiAocmVzdWx0KSA/IDAgOiAxOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJlY292ZXIgY29tbWFuZCBmb3IgbGVkZ2VyIGRhdGEgcmVj\nb3ZlcnkgZm9yIGZhaWxlZCBib29raWUKICAgICAqLwogICAgY2xhc3MgUmVj\nb3ZlckNtZCBleHRlbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBv\ncHRzID0gbmV3IE9wdGlvbnMoKTsKCiAgICAgICAgcHVibGljIFJlY292ZXJD\nbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9SRUNPVkVSKTsKICAgICAg\nICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIE9wdGlvbnMgZ2V0T3B0\naW9ucygpIHsKICAgICAgICAgICAgcmV0dXJuIG9wdHM7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0RGVzY3JpcHRp\nb24oKSB7CiAgICAgICAgICAgIHJldHVybiAiUmVjb3ZlciB0aGUgbGVkZ2Vy\nIGRhdGEgZm9yIGZhaWxlZCBib29raWUiOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkgewogICAgICAg\nICAgICByZXR1cm4gInJlY292ZXIgPGJvb2tpZVNyYz4gW2Jvb2tpZURlc3Rd\nIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIGludCBy\ndW5DbWQoQ29tbWFuZExpbmUgY21kTGluZSkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIFN0cmluZ1tdIGFyZ3MgPSBjbWRMaW5lLmdldEFyZ3Mo\nKTsKICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgMSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IE1pc3NpbmdBcmd1bWVudEV4Y2VwdGlvbigK\nICAgICAgICAgICAgICAgICAgICAgICAgIidib29raWVTcmMnIGFyZ3VtZW50\nIHJlcXVpcmVkIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIENsaWVu\ndENvbmZpZ3VyYXRpb24gYWRtaW5Db25mID0gbmV3IENsaWVudENvbmZpZ3Vy\nYXRpb24oYmtDb25mKTsKICAgICAgICAgICAgQm9va0tlZXBlckFkbWluIGFk\nbWluID0gbmV3IEJvb2tLZWVwZXJBZG1pbihhZG1pbkNvbmYpOwogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIGJrUmVjb3Zlcnko\nYWRtaW4sIGFyZ3MpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgaWYgKG51bGwgIT0gYWRtaW4pIHsKICAgICAgICAgICAgICAg\nICAgICBhZG1pbi5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIGludCBia1JlY292\nZXJ5KEJvb2tLZWVwZXJBZG1pbiBia0FkbWluLCBTdHJpbmdbXSBhcmdzKQog\nICAgICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uLCBC\nS0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGZpbmFsIFN0cmluZyBib29raWVT\ncmNTdHJpbmdbXSA9IGFyZ3NbMF0uc3BsaXQoIjoiKTsKICAgICAgICAgICAg\naWYgKGJvb2tpZVNyY1N0cmluZy5sZW5ndGggIT0gMikgewogICAgICAgICAg\nICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJCb29raWVTcmMgaW5wdXR0ZWQg\naGFzIGludmFsaWQgZm9ybWF0IgogICAgICAgICAgICAgICAgICAgICAgICAr\nICIoaG9zdDpwb3J0IGV4cGVjdGVkKTogIiArIGFyZ3NbMF0pOwogICAgICAg\nICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIGJvb2tpZVNyYyA9IG5ldyBJbmV0\nU29ja2V0QWRkcmVzcygKICAgICAgICAgICAgICAgICAgICBib29raWVTcmNT\ndHJpbmdbMF0sIEludGVnZXIucGFyc2VJbnQoYm9va2llU3JjU3RyaW5nWzFd\nKSk7CiAgICAgICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGJvb2tpZURlc3Qg\nPSBudWxsOwogICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMikgewog\nICAgICAgICAgICAgICAgZmluYWwgU3RyaW5nIGJvb2tpZURlc3RTdHJpbmdb\nXSA9IGFyZ3NbMV0uc3BsaXQoIjoiKTsKICAgICAgICAgICAgICAgIGlmIChi\nb29raWVEZXN0U3RyaW5nLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICAg\nICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIkJvb2tpZURlc3QgaW5wdXR0ZWQg\naGFzIGludmFsaWQgZm9ybWF0IgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyAiKGhvc3Q6cG9ydCBleHBlY3RlZCk6ICIgKyBhcmdzWzFdKTsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBib29raWVEZXN0ID0gbmV3IEluZXRTb2NrZXRB\nZGRyZXNzKGJvb2tpZURlc3RTdHJpbmdbMF0sCiAgICAgICAgICAgICAgICAg\nICAgICAgIEludGVnZXIucGFyc2VJbnQoYm9va2llRGVzdFN0cmluZ1sxXSkp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBia0FkbWluLnJlY292ZXJC\nb29raWVEYXRhKGJvb2tpZVNyYywgYm9va2llRGVzdCk7CiAgICAgICAgICAg\nIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIExl\nZGdlciBDb21tYW5kIEhhbmRsZXMgbGVkZ2VyIHJlbGF0ZWQgb3BlcmF0aW9u\ncwogICAgICovCiAgICBjbGFzcyBMZWRnZXJDbWQgZXh0ZW5kcyBNeUNvbW1h\nbmQgewogICAgICAgIE9wdGlvbnMgbE9wdHMgPSBuZXcgT3B0aW9ucygpOwoK\nICAgICAgICBMZWRnZXJDbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9M\nRURHRVIpOwogICAgICAgICAgICBsT3B0cy5hZGRPcHRpb24oIm0iLCAibWV0\nYSIsIGZhbHNlLCAiUHJpbnQgbWV0YSBpbmZvcm1hdGlvbiIpOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBydW5D\nbWQoQ29tbWFuZExpbmUgY21kTGluZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIFN0cmluZ1tdIGxlZnRBcmdzID0gY21kTGluZS5nZXRBcmdz\nKCk7CiAgICAgICAgICAgIGlmIChsZWZ0QXJncy5sZW5ndGggPD0gMCkgewog\nICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJFUlJPUjogbWlz\nc2luZyBsZWRnZXIgaWQiKTsKICAgICAgICAgICAgICAgIHByaW50VXNhZ2Uo\nKTsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgYm9vbGVhbiBwcmludE1ldGEgPSBmYWxzZTsKICAgICAg\nICAgICAgaWYgKGNtZExpbmUuaGFzT3B0aW9uKCJtIikpIHsKICAgICAgICAg\nICAgICAgIHByaW50TWV0YSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgbG9uZyBsZWRnZXJJZDsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIGxlZGdlcklkID0gTG9uZy5wYXJzZUxvbmcobGVmdEFyZ3Nb\nMF0pOwogICAgICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRp\nb24gbmZlKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4o\nIkVSUk9SOiBpbnZhbGlkIGxlZGdlciBpZCAiICsgbGVmdEFyZ3NbMF0pOwog\nICAgICAgICAgICAgICAgcHJpbnRVc2FnZSgpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwcmlu\ndE1ldGEpIHsKICAgICAgICAgICAgICAgIC8vIHByaW50IG1ldGEKICAgICAg\nICAgICAgICAgIHJlYWRMZWRnZXJNZXRhKGxlZGdlcklkKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICAvLyBkdW1wIGxlZGdlciBpbmZvCiAgICAgICAg\nICAgIHJlYWRMZWRnZXJJbmRleEVudHJpZXMobGVkZ2VySWQpOwogICAgICAg\nICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAg\ncmV0dXJuICJEdW1wIGxlZGdlciBpbmRleCBlbnRyaWVzIGludG8gcmVhZGFi\nbGUgZm9ybWF0LiI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJldHVybiAi\nbGVkZ2VyIFstbV0gPGxlZGdlcl9pZD4iOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkgewogICAg\nICAgICAgICByZXR1cm4gbE9wdHM7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQ29tbWFuZCB0byByZWFkIGVudHJ5IGxvZyBmaWxlcy4KICAg\nICAqLwogICAgY2xhc3MgUmVhZExvZ0NtZCBleHRlbmRzIE15Q29tbWFuZCB7\nCiAgICAgICAgT3B0aW9ucyBybE9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAg\nICAgICBSZWFkTG9nQ21kKCkgewogICAgICAgICAgICBzdXBlcihDTURfUkVB\nRExPRyk7CiAgICAgICAgICAgIHJsT3B0cy5hZGRPcHRpb24oIm0iLCAibXNn\nIiwgZmFsc2UsICJQcmludCBtZXNzYWdlIGJvZHkiKTsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKENv\nbW1hbmRMaW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBTdHJpbmdbXSBsZWZ0QXJncyA9IGNtZExpbmUuZ2V0QXJncygpOwog\nICAgICAgICAgICBpZiAobGVmdEFyZ3MubGVuZ3RoIDw9IDApIHsKICAgICAg\nICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiRVJST1I6IG1pc3Npbmcg\nZW50cnkgbG9nIGlkIG9yIGVudHJ5IGxvZyBmaWxlIG5hbWUiKTsKICAgICAg\nICAgICAgICAgIHByaW50VXNhZ2UoKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiAtMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYm9vbGVhbiBwcmlu\ndE1zZyA9IGZhbHNlOwogICAgICAgICAgICBpZiAoY21kTGluZS5oYXNPcHRp\nb24oIm0iKSkgewogICAgICAgICAgICAgICAgcHJpbnRNc2cgPSB0cnVlOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGxvbmcgbG9nSWQ7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsb2dJZCA9IExvbmcucGFyc2VM\nb25nKGxlZnRBcmdzWzBdKTsKICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVy\nRm9ybWF0RXhjZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgLy8gbm90\nIGEgZW50cnkgbG9nIGlkCiAgICAgICAgICAgICAgICBGaWxlIGYgPSBuZXcg\nRmlsZShsZWZ0QXJnc1swXSk7CiAgICAgICAgICAgICAgICBTdHJpbmcgbmFt\nZSA9IGYuZ2V0TmFtZSgpOwogICAgICAgICAgICAgICAgaWYgKCFuYW1lLmVu\nZHNXaXRoKCIubG9nIikpIHsKICAgICAgICAgICAgICAgICAgICAvLyBub3Qg\nYSBsb2cgZmlsZQogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJp\nbnRsbigiRVJST1I6IGludmFsaWQgZW50cnkgbG9nIGZpbGUgbmFtZSAiICsg\nbGVmdEFyZ3NbMF0pOwogICAgICAgICAgICAgICAgICAgIHByaW50VXNhZ2Uo\nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICBTdHJpbmcgaWRTdHJpbmcgPSBuYW1l\nLnNwbGl0KCJcXC4iKVswXTsKICAgICAgICAgICAgICAgIGxvZ0lkID0gTG9u\nZy5wYXJzZUxvbmcoaWRTdHJpbmcsIDE2KTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICAvLyBzY2FuIGVudHJ5IGxvZwogICAgICAgICAgICBzY2FuRW50\ncnlMb2cobG9nSWQsIHByaW50TXNnKTsKICAgICAgICAgICAgcmV0dXJuIDA7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcg\nZ2V0RGVzY3JpcHRpb24oKSB7CiAgICAgICAgICAgIHJldHVybiAiU2NhbiBh\nbiBlbnRyeSBmaWxlIGFuZCBmb3JtYXQgdGhlIGVudHJpZXMgaW50byByZWFk\nYWJsZSBmb3JtYXQuIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJu\nICJyZWFkbG9nIFstbV0gPGVudHJ5X2xvZ19pZCB8IGVudHJ5X2xvZ19maWxl\nX25hbWU+IjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIE9wdGlvbnMgZ2V0T3B0aW9ucygpIHsKICAgICAgICAgICAgcmV0dXJuIHJs\nT3B0czsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDb21tYW5k\nIHRvIHJlYWQgam91cm5hbCBmaWxlcwogICAgICovCiAgICBjbGFzcyBSZWFk\nSm91cm5hbENtZCBleHRlbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9u\ncyByak9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAgICAgICBSZWFkSm91cm5h\nbENtZCgpIHsKICAgICAgICAgICAgc3VwZXIoQ01EX1JFQURKT1VSTkFMKTsK\nICAgICAgICAgICAgcmpPcHRzLmFkZE9wdGlvbigibSIsICJtc2ciLCBmYWxz\nZSwgIlByaW50IG1lc3NhZ2UgYm9keSIpOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBydW5DbWQoQ29tbWFuZExp\nbmUgY21kTGluZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFN0\ncmluZ1tdIGxlZnRBcmdzID0gY21kTGluZS5nZXRBcmdzKCk7CiAgICAgICAg\nICAgIGlmIChsZWZ0QXJncy5sZW5ndGggPD0gMCkgewogICAgICAgICAgICAg\nICAgU3lzdGVtLmVyci5wcmludGxuKCJFUlJPUjogbWlzc2luZyBqb3VybmFs\nIGlkIG9yIGpvdXJuYWwgZmlsZSBuYW1lIik7CiAgICAgICAgICAgICAgICBw\ncmludFVzYWdlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIGJvb2xlYW4gcHJpbnRNc2cgPSBmYWxz\nZTsKICAgICAgICAgICAgaWYgKGNtZExpbmUuaGFzT3B0aW9uKCJtIikpIHsK\nICAgICAgICAgICAgICAgIHByaW50TXNnID0gdHJ1ZTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBsb25nIGpvdXJuYWxJZDsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGpvdXJuYWxJZCA9IExvbmcucGFyc2VMb25n\nKGxlZnRBcmdzWzBdKTsKICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9y\nbWF0RXhjZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgLy8gbm90IGEg\nam91cm5hbCBpZAogICAgICAgICAgICAgICAgRmlsZSBmID0gbmV3IEZpbGUo\nbGVmdEFyZ3NbMF0pOwogICAgICAgICAgICAgICAgU3RyaW5nIG5hbWUgPSBm\nLmdldE5hbWUoKTsKICAgICAgICAgICAgICAgIGlmICghbmFtZS5lbmRzV2l0\naCgiLnR4biIpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gbm90IGEgam91\ncm5hbCBmaWxlCiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmlu\ndGxuKCJFUlJPUjogaW52YWxpZCBqb3VybmFsIGZpbGUgbmFtZSAiICsgbGVm\ndEFyZ3NbMF0pOwogICAgICAgICAgICAgICAgICAgIHByaW50VXNhZ2UoKTsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBTdHJpbmcgaWRTdHJpbmcgPSBuYW1lLnNw\nbGl0KCJcXC4iKVswXTsKICAgICAgICAgICAgICAgIGpvdXJuYWxJZCA9IExv\nbmcucGFyc2VMb25nKGlkU3RyaW5nLCAxNik7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgLy8gc2NhbiBqb3VybmFsCiAgICAgICAgICAgIHNjYW5Kb3Vy\nbmFsKGpvdXJuYWxJZCwgcHJpbnRNc2cpOwogICAgICAgICAgICByZXR1cm4g\nMDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmlu\nZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICJTY2Fu\nIGEgam91cm5hbCBmaWxlIGFuZCBmb3JtYXQgdGhlIGVudHJpZXMgaW50byBy\nZWFkYWJsZSBmb3JtYXQuIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuICJyZWFkam91cm5hbCBbLW1dIDxqb3VybmFsX2lkIHwgam91cm5hbF9m\naWxlX25hbWU+IjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIE9wdGlvbnMgZ2V0T3B0aW9ucygpIHsKICAgICAgICAgICAgcmV0dXJu\nIHJqT3B0czsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDb21t\nYW5kIHRvIHByaW50IGxhc3QgbG9nIG1hcmsKICAgICAqLwogICAgY2xhc3Mg\nTGFzdE1hcmtDbWQgaW1wbGVtZW50cyBDb21tYW5kIHsKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBwdWJsaWMgaW50IHJ1bkNtZChTdHJpbmdbXSBhcmdz\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgcHJpbnRMYXN0TG9n\nTWFyaygpOwogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHByaW50VXNhZ2Uo\nKSB7CiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigibGFzdG1hcms6\nIFByaW50IGxhc3QgbG9nIG1hcmtlci4iKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBDb21tYW5kIHRvIHByaW50IGhlbHAgbWVzc2FnZQog\nICAgICovCiAgICBjbGFzcyBIZWxwQ21kIGltcGxlbWVudHMgQ29tbWFuZCB7\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBydW5DbWQo\nU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGlmIChhcmdzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgICAgICBwcmlu\ndFNoZWxsVXNhZ2UoKTsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIFN0cmluZyBjbWROYW1lID0gYXJnc1sw\nXTsKICAgICAgICAgICAgQ29tbWFuZCBjbWQgPSBjb21tYW5kcy5nZXQoY21k\nTmFtZSk7CiAgICAgICAgICAgIGlmIChudWxsID09IGNtZCkgewogICAgICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJVbmtub3duIGNvbW1hbmQg\nIiArIGNtZE5hbWUpOwogICAgICAgICAgICAgICAgcHJpbnRTaGVsbFVzYWdl\nKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgY21kLnByaW50VXNhZ2UoKTsKICAgICAgICAgICAgcmV0\ndXJuIDA7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgdm9pZCBwcmludFVzYWdlKCkgewogICAgICAgICAgICBTeXN0ZW0u\nZXJyLnByaW50bG4oImhlbHA6IERlc2NyaWJlIHRoZSB1c2FnZSBvZiB0aGlz\nIHByb2dyYW0gb3IgaXRzIHN1YmNvbW1hbmRzLiIpOwogICAgICAgICAgICBT\neXN0ZW0uZXJyLnByaW50bG4oInVzYWdlOiBoZWxwIFtDT01NQU5EXSIpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENvbW1hbmQgZm9yIGFk\nbWluaXN0cmF0aW9uIG9mIGF1dG9yZWNvdmVyeQogICAgICovCiAgICBjbGFz\ncyBBdXRvUmVjb3ZlcnlDbWQgZXh0ZW5kcyBNeUNvbW1hbmQgewogICAgICAg\nIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CgogICAgICAgIHB1Ymxp\nYyBBdXRvUmVjb3ZlcnlDbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9B\nVVRPUkVDT1ZFUlkpOwogICAgICAgICAgICBvcHRzLmFkZE9wdGlvbigiZSIs\nICJlbmFibGUiLCBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIkVuYWJsZSBhdXRvIHJlY292ZXJ5IG9mIHVuZGVycmVwbGljYXRlZCBsZWRn\nZXJzIik7CiAgICAgICAgICAgIG9wdHMuYWRkT3B0aW9uKCJkIiwgImRpc2Fi\nbGUiLCBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIkRpc2Fi\nbGUgYXV0byByZWNvdmVyeSBvZiB1bmRlcnJlcGxpY2F0ZWQgbGVkZ2VycyIp\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9u\ncyBnZXRPcHRpb25zKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXRE\nZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICJFbmFibGUgb3Ig\nZGlzYWJsZSBhdXRvcmVjb3ZlcnkgaW4gdGhlIGNsdXN0ZXIuIjsKICAgICAg\nICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXRVc2Fn\nZSgpIHsKICAgICAgICAgICAgcmV0dXJuICJhdXRvcmVjb3ZlcnkgWy1lbmFi\nbGV8LWRpc2FibGVdIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIGludCBydW5DbWQoQ29tbWFuZExpbmUgY21kTGluZSkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJvb2xlYW4gZGlzYWJsZSA9IGNt\nZExpbmUuaGFzT3B0aW9uKCJkIik7CiAgICAgICAgICAgIGJvb2xlYW4gZW5h\nYmxlID0gY21kTGluZS5oYXNPcHRpb24oImUiKTsKCiAgICAgICAgICAgIGlm\nICgoIWRpc2FibGUgJiYgIWVuYWJsZSkKICAgICAgICAgICAgICAgIHx8IChl\nbmFibGUgJiYgZGlzYWJsZSkpIHsKICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiT25lIGFuZCBvbmx5IG9uZSBvZiAtZW5hYmxlIGFuZCAtZGlzYWJsZSBt\ndXN0IGJlIHNwZWNpZmllZCIpOwogICAgICAgICAgICAgICAgcHJpbnRVc2Fn\nZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgWm9vS2VlcGVyIHprID0gbnVsbDsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIFpvb0tlZXBlcldhdGNoZXJCYXNlIHcg\nPSBuZXcgWm9vS2VlcGVyV2F0Y2hlckJhc2UoYmtDb25mLmdldFprVGltZW91\ndCgpKTsKICAgICAgICAgICAgICAgIHprID0gWmtVdGlscy5jcmVhdGVDb25u\nZWN0ZWRab29rZWVwZXJDbGllbnQoYmtDb25mLmdldFprU2VydmVycygpLCB3\nKTsKICAgICAgICAgICAgICAgIExlZGdlck1hbmFnZXJGYWN0b3J5IG1GYWN0\nb3J5ID0gTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZh\nY3RvcnkoYmtDb25mLCB6ayk7CiAgICAgICAgICAgICAgICBMZWRnZXJVbmRl\ncnJlcGxpY2F0aW9uTWFuYWdlciB1bmRlcnJlcGxpY2F0aW9uTWFuYWdlciA9\nIG1GYWN0b3J5Lm5ld0xlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyKCk7\nCiAgICAgICAgICAgICAgICBpZiAoZW5hYmxlKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKHVuZGVycmVwbGljYXRpb25NYW5hZ2VyLmlzTGVkZ2VyUmVw\nbGljYXRpb25FbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nTE9HLndhcm4oIkF1dG9yZWNvdmVyeSBhbHJlYWR5IGVuYWJsZWQuIERvaW5n\nIG5vdGhpbmciKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiRW5hYmxpbmcgYXV0b3Jl\nY292ZXJ5Iik7CiAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVycmVwbGlj\nYXRpb25NYW5hZ2VyLmVuYWJsZUxlZGdlclJlcGxpY2F0aW9uKCk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgICAgICAgICBpZiAoIXVuZGVycmVwbGljYXRpb25NYW5hZ2Vy\nLmlzTGVkZ2VyUmVwbGljYXRpb25FbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgTE9HLndhcm4oIkF1dG9yZWNvdmVyeSBhbHJlYWR5IGRp\nc2FibGVkLiBEb2luZyBub3RoaW5nIik7CiAgICAgICAgICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIkRp\nc2FibGluZyBhdXRvcmVjb3ZlcnkiKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgdW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIuZGlzYWJsZUxlZGdlclJlcGxp\nY2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\naWYgKHprICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB6ay5jbG9z\nZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAg\nICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICB9CgogICAgZmluYWwgTWFw\nPFN0cmluZywgQ29tbWFuZD4gY29tbWFuZHM7CiAgICB7CiAgICAgICAgY29t\nbWFuZHMgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIENvbW1hbmQ+KCk7CiAgICAg\nICAgY29tbWFuZHMucHV0KENNRF9NRVRBRk9STUFULCBuZXcgTWV0YUZvcm1h\ndENtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01EX0JPT0tJRUZPUk1B\nVCwgbmV3IEJvb2tpZUZvcm1hdENtZCgpKTsKICAgICAgICBjb21tYW5kcy5w\ndXQoQ01EX1JFQ09WRVIsIG5ldyBSZWNvdmVyQ21kKCkpOwogICAgICAgIGNv\nbW1hbmRzLnB1dChDTURfTEVER0VSLCBuZXcgTGVkZ2VyQ21kKCkpOwogICAg\nICAgIGNvbW1hbmRzLnB1dChDTURfUkVBRExPRywgbmV3IFJlYWRMb2dDbWQo\nKSk7CiAgICAgICAgY29tbWFuZHMucHV0KENNRF9SRUFESk9VUk5BTCwgbmV3\nIFJlYWRKb3VybmFsQ21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChDTURf\nTEFTVE1BUkssIG5ldyBMYXN0TWFya0NtZCgpKTsKICAgICAgICBjb21tYW5k\ncy5wdXQoQ01EX0FVVE9SRUNPVkVSWSwgbmV3IEF1dG9SZWNvdmVyeUNtZCgp\nKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01EX0hFTFAsIG5ldyBIZWxwQ21k\nKCkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0\nQ29uZihDb25maWd1cmF0aW9uIGNvbmYpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGJrQ29uZi5sb2FkQ29uZihjb25mKTsKICAgICAgICBqb3VybmFs\nRGlyZWN0b3J5ID0gQm9va2llLmdldEN1cnJlbnREaXJlY3RvcnkoYmtDb25m\nLmdldEpvdXJuYWxEaXIoKSk7CiAgICAgICAgbGVkZ2VyRGlyZWN0b3JpZXMg\nPSBCb29raWUuZ2V0Q3VycmVudERpcmVjdG9yaWVzKGJrQ29uZi5nZXRMZWRn\nZXJEaXJzKCkpOwogICAgICAgIGZvcm1hdHRlciA9IEVudHJ5Rm9ybWF0dGVy\nLm5ld0VudHJ5Rm9ybWF0dGVyKGJrQ29uZiwgRU5UUllfRk9STUFUVEVSX0NM\nQVNTKTsKICAgICAgICBMT0cuaW5mbygiVXNpbmcgZW50cnkgZm9ybWF0dGVy\nICIgKyBmb3JtYXR0ZXIuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpOwogICAgICAg\nIHBhZ2VTaXplID0gYmtDb25mLmdldFBhZ2VTaXplKCk7CiAgICAgICAgZW50\ncmllc1BlclBhZ2UgPSBwYWdlU2l6ZSAvIDg7CiAgICB9CgogICAgcHJpdmF0\nZSBzdGF0aWMgdm9pZCBwcmludFNoZWxsVXNhZ2UoKSB7CiAgICAgICAgU3lz\ndGVtLmVyci5wcmludGxuKCJVc2FnZTogQm9va2llU2hlbGwgWy1jb25mIGNv\nbmZpZ3VyYXRpb25dIDxjb21tYW5kPiIpOwogICAgICAgIFN5c3RlbS5lcnIu\ncHJpbnRsbigpOwogICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiICAgICAg\nIG1ldGFmb3JtYXQgICBbLW5vbkludGVyYWN0aXZlXSBbLWZvcmNlXSIpOwog\nICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiICAgICAgIGJvb2tpZWZvcm1h\ndCBbLW5vbkludGVyYWN0aXZlXSBbLWZvcmNlXSIpOwogICAgICAgIFN5c3Rl\nbS5lcnIucHJpbnRsbigiICAgICAgIHJlY292ZXIgICAgICA8Ym9va2llU3Jj\nPiBbYm9va2llRGVzdF0iKTsKICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4o\nIiAgICAgICBsZWRnZXIgICAgICAgWy1tZXRhXSA8bGVkZ2VyX2lkPiIpOwog\nICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiICAgICAgIHJlYWRsb2cgICAg\nICBbLW1zZ10gPGVudHJ5X2xvZ19pZHxlbnRyeV9sb2dfZmlsZV9uYW1lPiIp\nOwogICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiICAgICAgIHJlYWRqb3Vy\nbmFsICBbLW1zZ10gPGpvdXJuYWxfaWR8am91cm5hbF9maWxlX25hbWU+Iik7\nCiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCIgICAgICAgYXV0b3JlY292\nZXJ5IFstZW5hYmxlfC1kaXNhYmxlXSIpOwogICAgICAgIFN5c3RlbS5lcnIu\ncHJpbnRsbigiICAgICAgIGxhc3RtYXJrIik7CiAgICAgICAgU3lzdGVtLmVy\nci5wcmludGxuKCIgICAgICAgaGVscCIpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIGludCBydW4oU3RyaW5nW10gYXJncykgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDw9IDApIHsKICAg\nICAgICAgICAgcHJpbnRTaGVsbFVzYWdlKCk7CiAgICAgICAgICAgIHJldHVy\nbiAtMTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nIGNtZE5hbWUgPSBhcmdz\nWzBdOwogICAgICAgIENvbW1hbmQgY21kID0gY29tbWFuZHMuZ2V0KGNtZE5h\nbWUpOwogICAgICAgIGlmIChudWxsID09IGNtZCkgewogICAgICAgICAgICBT\neXN0ZW0uZXJyLnByaW50bG4oIkVSUk9SOiBVbmtub3duIGNvbW1hbmQgIiAr\nIGNtZE5hbWUpOwogICAgICAgICAgICBwcmludFNoZWxsVXNhZ2UoKTsKICAg\nICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICAvLyBwcmVw\nYXJlIG5ldyBhcmdzCiAgICAgICAgU3RyaW5nW10gbmV3QXJncyA9IG5ldyBT\ndHJpbmdbYXJncy5sZW5ndGggLSAxXTsKICAgICAgICBTeXN0ZW0uYXJyYXlj\nb3B5KGFyZ3MsIDEsIG5ld0FyZ3MsIDAsIG5ld0FyZ3MubGVuZ3RoKTsKICAg\nICAgICByZXR1cm4gY21kLnJ1bkNtZChuZXdBcmdzKTsKICAgIH0KCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmcgYXJndltdKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYXJndi5sZW5ndGggPD0gMCkgewog\nICAgICAgICAgICBwcmludFNoZWxsVXNhZ2UoKTsKICAgICAgICAgICAgU3lz\ndGVtLmV4aXQoLTEpOwogICAgICAgIH0KCiAgICAgICAgQ29tcG9zaXRlQ29u\nZmlndXJhdGlvbiBjb25mID0gbmV3IENvbXBvc2l0ZUNvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICAvLyBsb2FkIGNvbmZpZ3VyYXRpb24KICAgICAgICBpZiAo\nIi1jb25mIi5lcXVhbHMoYXJndlswXSkpIHsKICAgICAgICAgICAgaWYgKGFy\nZ3YubGVuZ3RoIDw9IDEpIHsKICAgICAgICAgICAgICAgIHByaW50U2hlbGxV\nc2FnZSgpOwogICAgICAgICAgICAgICAgU3lzdGVtLmV4aXQoLTEpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGNvbmYuYWRkQ29uZmlndXJhdGlvbihu\nZXcgUHJvcGVydGllc0NvbmZpZ3VyYXRpb24oCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBuZXcgRmlsZShhcmd2WzFdKS50b1VSSSgpLnRv\nVVJMKCkpKTsKCiAgICAgICAgICAgIFN0cmluZ1tdIG5ld0FyZ3YgPSBuZXcg\nU3RyaW5nW2FyZ3YubGVuZ3RoIC0gMl07CiAgICAgICAgICAgIFN5c3RlbS5h\ncnJheWNvcHkoYXJndiwgMiwgbmV3QXJndiwgMCwgbmV3QXJndi5sZW5ndGgp\nOwogICAgICAgICAgICBhcmd2ID0gbmV3QXJndjsKICAgICAgICB9CgogICAg\nICAgIEJvb2tpZVNoZWxsIHNoZWxsID0gbmV3IEJvb2tpZVNoZWxsKCk7CiAg\nICAgICAgc2hlbGwuc2V0Q29uZihjb25mKTsKICAgICAgICBpbnQgcmVzID0g\nc2hlbGwucnVuKGFyZ3YpOwogICAgICAgIFN5c3RlbS5leGl0KHJlcyk7CiAg\nICB9CgogICAgLy8vCiAgICAvLy8gQm9va2llIEZpbGUgT3BlcmF0aW9ucwog\nICAgLy8vCgogICAgLyoqCiAgICAgKiBHZXQgdGhlIGxlZGdlciBmaWxlIG9m\nIGEgc3BlY2lmaWVkIGxlZGdlci4KICAgICAqCiAgICAgKiBAcGFyYW0gbGVk\nZ2VySWQKICAgICAqICAgICAgICAgIExlZGdlciBJZAogICAgICoKICAgICAq\nIEByZXR1cm4gZmlsZSBvYmplY3QuCiAgICAgKi8KICAgIHByaXZhdGUgRmls\nZSBnZXRMZWRnZXJGaWxlKGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICBTdHJp\nbmcgbGVkZ2VyTmFtZSA9IExlZGdlckNhY2hlSW1wbC5nZXRMZWRnZXJOYW1l\nKGxlZGdlcklkKTsKICAgICAgICBGaWxlIGxmID0gbnVsbDsKICAgICAgICBm\nb3IgKEZpbGUgZCA6IGxlZGdlckRpcmVjdG9yaWVzKSB7CiAgICAgICAgICAg\nIGxmID0gbmV3IEZpbGUoZCwgbGVkZ2VyTmFtZSk7CiAgICAgICAgICAgIGlm\nIChsZi5leGlzdHMoKSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgbGYgPSBudWxsOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbGY7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgRmls\nZUluZm8gZm9yIGEgc3BlY2lmaWVkIGxlZGdlci4KICAgICAqCiAgICAgKiBA\ncGFyYW0gbGVkZ2VySWQKICAgICAqICAgICAgICAgIExlZGdlciBJZAogICAg\nICogQHJldHVybiByZWFkIG9ubHkgZmlsZSBpbmZvIGluc3RhbmNlCiAgICAg\nKi8KICAgIFJlYWRPbmx5RmlsZUluZm8gZ2V0RmlsZUluZm8obG9uZyBsZWRn\nZXJJZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBGaWxlIGxlZGdl\nckZpbGUgPSBnZXRMZWRnZXJGaWxlKGxlZGdlcklkKTsKICAgICAgICBpZiAo\nbnVsbCA9PSBsZWRnZXJGaWxlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBG\naWxlTm90Rm91bmRFeGNlcHRpb24oIk5vIGluZGV4IGZpbGUgZm91bmQgZm9y\nIGxlZGdlciAiICsgbGVkZ2VySWQgKyAiLiBJdCBtYXkgYmUgbm90IGZsdXNo\nZWQgeWV0LiIpOwogICAgICAgIH0KICAgICAgICBSZWFkT25seUZpbGVJbmZv\nIGZpID0gbmV3IFJlYWRPbmx5RmlsZUluZm8obGVkZ2VyRmlsZSwgbnVsbCk7\nCiAgICAgICAgZmkucmVhZEhlYWRlcigpOwogICAgICAgIHJldHVybiBmaTsK\nICAgIH0KCiAgICBwcml2YXRlIHN5bmNocm9uaXplZCB2b2lkIGluaXRFbnRy\neUxvZ2dlcigpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKG51\nbGwgPT0gZW50cnlMb2dnZXIpIHsKICAgICAgICAgICAgLy8gcHJvdmlkZSBy\nZWFkIG9ubHkgZW50cnkgbG9nZ2VyCiAgICAgICAgICAgIGVudHJ5TG9nZ2Vy\nID0gbmV3IFJlYWRPbmx5RW50cnlMb2dnZXIoYmtDb25mKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBzY2FuIG92ZXIgZW50cnkgbG9nCiAg\nICAgKgogICAgICogQHBhcmFtIGxvZ0lkCiAgICAgKiAgICAgICAgICBFbnRy\neSBMb2cgSWQKICAgICAqIEBwYXJhbSBzY2FubmVyCiAgICAgKiAgICAgICAg\nICBFbnRyeSBMb2cgU2Nhbm5lcgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzY2FuRW50cnlMb2cobG9uZyBsb2dJZCwgRW50cnlMb2dTY2FubmVyIHNj\nYW5uZXIpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaW5pdEVudHJ5\nTG9nZ2VyKCk7CiAgICAgICAgZW50cnlMb2dnZXIuc2NhbkVudHJ5TG9nKGxv\nZ0lkLCBzY2FubmVyKTsKICAgIH0KCiAgICBwcml2YXRlIHN5bmNocm9uaXpl\nZCBKb3VybmFsIGdldEpvdXJuYWwoKSB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIGlmIChudWxsID09IGpvdXJuYWwpIHsKICAgICAgICAgICAgam91\ncm5hbCA9IG5ldyBKb3VybmFsKGJrQ29uZiwgbmV3IExlZGdlckRpcnNNYW5h\nZ2VyKGJrQ29uZikpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gam91cm5h\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIFNjYW4gam91cm5hbCBmaWxlCiAg\nICAgKgogICAgICogQHBhcmFtIGpvdXJuYWxJZAogICAgICogICAgICAgICAg\nSm91cm5hbCBGaWxlIElkCiAgICAgKiBAcGFyYW0gc2Nhbm5lcgogICAgICog\nICAgICAgICAgSm91cm5hbCBGaWxlIFNjYW5uZXIKICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgc2NhbkpvdXJuYWwobG9uZyBqb3VybmFsSWQsIEpvdXJu\nYWxTY2FubmVyIHNjYW5uZXIpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgZ2V0Sm91cm5hbCgpLnNjYW5Kb3VybmFsKGpvdXJuYWxJZCwgMEwsIHNj\nYW5uZXIpOwogICAgfQoKICAgIC8vLwogICAgLy8vIEJvb2tpZSBTaGVsbCBD\nb21tYW5kcwogICAgLy8vCgogICAgLyoqCiAgICAgKiBSZWFkIGxlZGdlciBt\nZXRhCiAgICAgKgogICAgICogQHBhcmFtIGxlZGdlcklkCiAgICAgKiAgICAg\nICAgICBMZWRnZXIgSWQKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcmVh\nZExlZGdlck1ldGEobG9uZyBsZWRnZXJJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCI9PT09PSBMRURHRVI6ICIg\nKyBsZWRnZXJJZCArICIgPT09PT0iKTsKICAgICAgICBGaWxlSW5mbyBmaSA9\nIGdldEZpbGVJbmZvKGxlZGdlcklkKTsKICAgICAgICBieXRlW10gbWFzdGVy\nS2V5ID0gZmkuZ2V0TWFzdGVyS2V5KCk7CiAgICAgICAgaWYgKG51bGwgPT0g\nbWFzdGVyS2V5KSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigi\nbWFzdGVyIGtleSAgOiBOVUxMIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJtYXN0ZXIga2V5ICA6ICIgKyBi\neXRlczJIZXgoZmkuZ2V0TWFzdGVyS2V5KCkpKTsKICAgICAgICB9CiAgICAg\nICAgbG9uZyBzaXplID0gZmkuc2l6ZSgpOwogICAgICAgIGlmIChzaXplICUg\nOCA9PSAwKSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigic2l6\nZSAgICAgICAgOiAiICsgc2l6ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJzaXplIDogIiArIHNpemUgKyAi\nIChub3QgYWxpZ25lZCB3aXRoIDgsIG1heSBiZSBjb3JydXB0ZWQgb3IgdW5k\nZXIgZmx1c2hpbmcgbm93KSIpOwogICAgICAgIH0KICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oImVudHJpZXMgICAgIDogIiArIChzaXplIC8gOCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmVhZCBsZWRnZXIgaW5kZXggZW50aXJl\ncwogICAgICoKICAgICAqIEBwYXJhbSBsZWRnZXJJZAogICAgICogICAgICAg\nICAgTGVkZ2VyIElkCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIHJlYWRMZWRnZXJJbmRleEVudHJpZXMo\nbG9uZyBsZWRnZXJJZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIj09PT09IExFREdFUjogIiArIGxlZGdlcklk\nICsgIiA9PT09PSIpOwogICAgICAgIEZpbGVJbmZvIGZpID0gZ2V0RmlsZUlu\nZm8obGVkZ2VySWQpOwogICAgICAgIGxvbmcgc2l6ZSA9IGZpLnNpemUoKTsK\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oInNpemUgICAgICAgIDogIiAr\nIHNpemUpOwogICAgICAgIGxvbmcgY3VyU2l6ZSA9IDA7CiAgICAgICAgbG9u\nZyBjdXJFbnRyeSA9IDA7CiAgICAgICAgTGVkZ2VyRW50cnlQYWdlIGxlcCA9\nIG5ldyBMZWRnZXJFbnRyeVBhZ2UocGFnZVNpemUsIGVudHJpZXNQZXJQYWdl\nKTsKICAgICAgICBsZXAudXNlUGFnZSgpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHdoaWxlIChjdXJTaXplIDwgc2l6ZSkgewogICAgICAgICAgICAg\nICAgbGVwLnNldExlZGdlcihsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICBs\nZXAuc2V0Rmlyc3RFbnRyeShjdXJFbnRyeSk7CiAgICAgICAgICAgICAgICBs\nZXAucmVhZFBhZ2UoZmkpOwoKICAgICAgICAgICAgICAgIC8vIHByb2Nlc3Mg\nYSBwYWdlCiAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8ZW50cmll\nc1BlclBhZ2U7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGxvbmcgb2Zm\nc2V0ID0gbGVwLmdldE9mZnNldChpICogOCk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKDAgPT0gb2Zmc2V0KSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIFN5c3RlbS5vdXQucHJpbnRsbigiZW50cnkgIiArIGN1ckVudHJ5ICsgIlx0\nOlx0Ti9BIik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgbG9uZyBlbnRyeUxvZ0lkID0gb2Zmc2V0ID4+\nIDMyTDsKICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBwb3MgPSBvZmZz\nZXQgJiAweGZmZmZmZmZmTDsKICAgICAgICAgICAgICAgICAgICAgICAgU3lz\ndGVtLm91dC5wcmludGxuKCJlbnRyeSAiICsgY3VyRW50cnkgKyAiXHQ6XHQo\nbG9nOiIgKyBlbnRyeUxvZ0lkICsgIiwgcG9zOiAiICsgcG9zICsgIikiKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKytj\ndXJFbnRyeTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBj\ndXJTaXplICs9IHBhZ2VTaXplOwogICAgICAgICAgICB9CiAgICAgICAgfSBj\nYXRjaCAoSU9FeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgTE9HLmVycm9y\nKCJGYWlsZWQgdG8gcmVhZCBpbmRleCBwYWdlIDogIiwgaWUpOwogICAgICAg\nICAgICBpZiAoY3VyU2l6ZSArIHBhZ2VTaXplIDwgc2l6ZSkgewogICAgICAg\nICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJGYWlsZWQgdG8gcmVhZCBp\nbmRleCBwYWdlIEAgIiArIGN1clNpemUgKyAiLCB0aGUgaW5kZXggZmlsZSBt\nYXkgYmUgY29ycnVwdGVkIDogIiArIGllLmdldE1lc3NhZ2UoKSk7CiAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnBy\naW50bG4oIkZhaWxlZCB0byByZWFkIGxhc3QgaW5kZXggcGFnZSBAICIgKyBj\ndXJTaXplCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiwg\ndGhlIGluZGV4IGZpbGUgbWF5IGJlIGNvcnJ1cHRlZCBvciBsYXN0IGluZGV4\nIHBhZ2UgaXMgbm90IGZ1bGx5IGZsdXNoZWQgeWV0IDogIiArIGllLmdldE1l\nc3NhZ2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTY2FuIG92ZXIgYW4gZW50cnkgbG9nIGZpbGUuCiAgICAg\nKgogICAgICogQHBhcmFtIGxvZ0lkCiAgICAgKiAgICAgICAgICBFbnRyeSBM\nb2cgRmlsZSBpZC4KICAgICAqIEBwYXJhbSBwcmludE1zZwogICAgICogICAg\nICAgICAgV2hldGhlciBwcmludGluZyB0aGUgZW50cnkgZGF0YS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgc2NhbkVudHJ5TG9nKGxvbmcgbG9nSWQs\nIGZpbmFsIGJvb2xlYW4gcHJpbnRNc2cpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiU2NhbiBlbnRyeSBsb2cgIiAr\nIGxvZ0lkICsgIiAoIiArIExvbmcudG9IZXhTdHJpbmcobG9nSWQpICsgIi5s\nb2cpIik7CiAgICAgICAgc2NhbkVudHJ5TG9nKGxvZ0lkLCBuZXcgRW50cnlM\nb2dTY2FubmVyKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAg\nICAgcHVibGljIGJvb2xlYW4gYWNjZXB0KGxvbmcgbGVkZ2VySWQpIHsKICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9j\nZXNzKGxvbmcgbGVkZ2VySWQsIGxvbmcgc3RhcnRQb3MsIEJ5dGVCdWZmZXIg\nZW50cnkpIHsKICAgICAgICAgICAgICAgIGZvcm1hdEVudHJ5KHN0YXJ0UG9z\nLCBlbnRyeSwgcHJpbnRNc2cpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTY2FuIGEgam91cm5hbCBmaWxlCiAg\nICAgKgogICAgICogQHBhcmFtIGpvdXJuYWxJZAogICAgICogICAgICAgICAg\nSm91cm5hbCBGaWxlIElkCiAgICAgKiBAcGFyYW0gcHJpbnRNc2cKICAgICAq\nICAgICAgICAgIFdoZXRoZXIgcHJpbnRpbmcgdGhlIGVudHJ5IGRhdGEuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNjYW5Kb3VybmFsKGxvbmcgam91\ncm5hbElkLCBmaW5hbCBib29sZWFuIHByaW50TXNnKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlNjYW4gam91cm5h\nbCAiICsgam91cm5hbElkICsgIiAoIiArIExvbmcudG9IZXhTdHJpbmcoam91\ncm5hbElkKSArICIudHhuKSIpOwogICAgICAgIHNjYW5Kb3VybmFsKGpvdXJu\nYWxJZCwgbmV3IEpvdXJuYWxTY2FubmVyKCkgewogICAgICAgICAgICBib29s\nZWFuIHByaW50Sm91cm5hbFZlcnNpb24gPSBmYWxzZTsKICAgICAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3MoaW50\nIGpvdXJuYWxWZXJzaW9uLCBsb25nIG9mZnNldCwgQnl0ZUJ1ZmZlciBlbnRy\neSkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmICgh\ncHJpbnRKb3VybmFsVmVyc2lvbikgewogICAgICAgICAgICAgICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigiSm91cm5hbCBWZXJzaW9uIDogIiArIGpvdXJu\nYWxWZXJzaW9uKTsKICAgICAgICAgICAgICAgICAgICBwcmludEpvdXJuYWxW\nZXJzaW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIGZvcm1hdEVudHJ5KG9mZnNldCwgZW50cnksIHByaW50TXNnKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICog\nUHJpbnQgbGFzdCBsb2cgbWFyawogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBwcmludExhc3RMb2dNYXJrKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBMYXN0TG9nTWFyayBsYXN0TG9nTWFyayA9IGdldEpvdXJuYWwoKS5n\nZXRMYXN0TG9nTWFyaygpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigi\nTGFzdExvZ01hcms6IEpvdXJuYWwgSWQgLSAiICsgbGFzdExvZ01hcmsuZ2V0\nVHhuTG9nSWQoKSArICIoIgogICAgICAgICAgICAgICAgKyBMb25nLnRvSGV4\nU3RyaW5nKGxhc3RMb2dNYXJrLmdldFR4bkxvZ0lkKCkpICsgIi50eG4pLCBQ\nb3MgLSAiCiAgICAgICAgICAgICAgICArIGxhc3RMb2dNYXJrLmdldFR4bkxv\nZ1Bvc2l0aW9uKCkpOwogICAgfQoKICAgIC8qKgogICAgICogRm9ybWF0IHRo\nZSBtZXNzYWdlIGludG8gYSByZWFkYWJsZSBmb3JtYXQuCiAgICAgKgogICAg\nICogQHBhcmFtIHBvcwogICAgICogICAgICAgICAgRmlsZSBvZmZzZXQgb2Yg\ndGhlIG1lc3NhZ2Ugc3RvcmVkIGluIGVudHJ5IGxvZyBmaWxlCiAgICAgKiBA\ncGFyYW0gcmVjQnVmZgogICAgICogICAgICAgICAgRW50cnkgRGF0YQogICAg\nICogQHBhcmFtIHByaW50TXNnCiAgICAgKiAgICAgICAgICBXaGV0aGVyIHBy\naW50aW5nIHRoZSBtZXNzYWdlIGJvZHkKICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGZvcm1hdEVudHJ5KGxvbmcgcG9zLCBCeXRlQnVmZmVyIHJlY0J1ZmYs\nIGJvb2xlYW4gcHJpbnRNc2cpIHsKICAgICAgICBsb25nIGxlZGdlcklkID0g\ncmVjQnVmZi5nZXRMb25nKCk7CiAgICAgICAgbG9uZyBlbnRyeUlkID0gcmVj\nQnVmZi5nZXRMb25nKCk7CiAgICAgICAgaW50IGVudHJ5U2l6ZSA9IHJlY0J1\nZmYubGltaXQoKTsKCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCItLS0t\nLS0tLS0gTGlkPSIgKyBsZWRnZXJJZCArICIsIEVpZD0iICsgZW50cnlJZAog\nICAgICAgICAgICAgICAgICAgICAgICAgKyAiLCBCeXRlT2Zmc2V0PSIgKyBw\nb3MgKyAiLCBFbnRyeVNpemU9IiArIGVudHJ5U2l6ZSArICIgLS0tLS0tLS0t\nIik7CiAgICAgICAgaWYgKGVudHJ5SWQgPT0gQm9va2llLk1FVEFFTlRSWV9J\nRF9MRURHRVJfS0VZKSB7CiAgICAgICAgICAgIGludCBtYXN0ZXJLZXlMZW4g\nPSByZWNCdWZmLmdldEludCgpOwogICAgICAgICAgICBieXRlW10gbWFzdGVy\nS2V5ID0gbmV3IGJ5dGVbbWFzdGVyS2V5TGVuXTsKICAgICAgICAgICAgcmVj\nQnVmZi5nZXQobWFzdGVyS2V5KTsKICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCJUeXBlOiAgICAgICAgICAgTUVUQSIpOwogICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIk1hc3RlcktleTogICAgICAiICsgYnl0ZXMy\nSGV4KG1hc3RlcktleSkpOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50\nbG4oKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAv\nLyBwcm9jZXNzIGEgZGF0YSBlbnRyeQogICAgICAgIGxvbmcgbGFzdEFkZENv\nbmZpcm1lZCA9IHJlY0J1ZmYuZ2V0TG9uZygpOwogICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbigiVHlwZTogICAgICAgICAgIERBVEEiKTsKICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIkxhc3RDb25maXJtZWQ6ICAiICsgbGFzdEFk\nZENvbmZpcm1lZCk7CiAgICAgICAgaWYgKCFwcmludE1zZykgewogICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oKTsKICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIH0KICAgICAgICAvLyBza2lwIGRpZ2VzdCBjaGVja2luZwog\nICAgICAgIHJlY0J1ZmYucG9zaXRpb24oMzIgKyA4KTsKICAgICAgICBTeXN0\nZW0ub3V0LnByaW50bG4oIkRhdGE6Iik7CiAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYnl0ZVtdIHJl\ndCA9IG5ldyBieXRlW3JlY0J1ZmYucmVtYWluaW5nKCldOwogICAgICAgICAg\nICByZWNCdWZmLmdldChyZXQpOwogICAgICAgICAgICBmb3JtYXR0ZXIuZm9y\nbWF0RW50cnkocmV0KTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk4vQS4gQ29ycnVw\ndGVkLiIpOwogICAgICAgIH0KICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nKTsKICAgIH0KCiAgICBzdGF0aWMgU3RyaW5nIGJ5dGVzMkhleChieXRlW10g\nZGF0YSkgewogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5n\nQnVpbGRlcihkYXRhLmxlbmd0aCAqIDIpOwogICAgICAgIEZvcm1hdHRlciBm\nb3JtYXR0ZXIgPSBuZXcgRm9ybWF0dGVyKHNiKTsKICAgICAgICBmb3IgKGJ5\ndGUgYiA6IGRhdGEpIHsKICAgICAgICAgICAgZm9ybWF0dGVyLmZvcm1hdCgi\nJTAyeCIsIGIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2IudG9TdHJp\nbmcoKTsKICAgIH0KfQo=\n","encoding":"base64"}

