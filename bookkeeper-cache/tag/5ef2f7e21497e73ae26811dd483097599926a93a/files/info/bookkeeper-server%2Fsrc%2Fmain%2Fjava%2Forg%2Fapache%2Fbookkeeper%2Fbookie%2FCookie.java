{"sha":"28a8daa8dd103f92befc363160d5b206b97d0aa4","node_id":"MDQ6QmxvYjE1NzU5NTY6MjhhOGRhYThkZDEwM2Y5MmJlZmMzNjMxNjBkNWIyMDZiOTdkMGFhNA==","size":10032,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/28a8daa8dd103f92befc363160d5b206b97d0aa4","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEuaW8u\nRU9GRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2\nYS5pby5GaWxlT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5GaWxlUmVh\nZGVyOwppbXBvcnQgamF2YS5pby5PdXRwdXRTdHJlYW1Xcml0ZXI7CmltcG9y\ndCBqYXZhLmlvLkJ1ZmZlcmVkV3JpdGVyOwppbXBvcnQgamF2YS5pby5JT0V4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyaW5nUmVhZGVyOwoKaW1wb3J0\nIGphdmEubmV0LlVua25vd25Ib3N0RXhjZXB0aW9uOwoKaW1wb3J0IG9yZy5h\ncGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLmRhdGEuU3RhdDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5a\nb29EZWZzLklkczsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRp\nbC5Cb29rS2VlcGVyQ29uc3RhbnRzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnV0aWwuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkRhdGFGb3JtYXRzLkNvb2tpZUZv\ncm1hdDsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1\nZi5UZXh0Rm9ybWF0OwoKLyoqCiAqIFdoZW4gYSBib29raWUgc3RhcnRzIGZv\nciB0aGUgZmlyc3QgdGltZSBpdCBnZW5lcmF0ZXMgIGEgY29va2llLCBhbmQg\nc3RvcmVzCiAqIHRoZSBjb29raWUgaW4gem9va2VlcGVyIGFzIHdlbGwgYXMg\naW4gdGhlIGVhY2ggb2YgdGhlIGxvY2FsIGZpbGVzeXN0ZW0KICogZGlyZWN0\nb3JpZXMgaXQgdXNlcy4gVGhpcyBjb29raWUgaXMgdXNlZCB0byBlbnN1cmUg\ndGhhdCBmb3IgdGhlIGxpZmUgb2YgdGhlCiAqIGJvb2tpZSwgaXRzIGNvbmZp\nZ3VyYXRpb24gc3RheXMgdGhlIHNhbWUuIElmIGFueSBvZiB0aGUgYm9va2ll\nIGRpcmVjdG9yaWVzCiAqIGJlY29tZXMgdW5hdmFpbGFibGUsIHRoZSBib29r\naWUgYmVjb21lcyB1bmF2YWlsYWJsZS4gSWYgdGhlIGJvb2tpZSBjaGFuZ2Vz\nCiAqIHBvcnQsIGl0IG11c3QgYWxzbyByZXNldCBhbGwgb2YgaXRzIGRhdGEu\nCiAqCiAqIFRoaXMgaXMgZG9uZSB0byBlbnN1cmUgZGF0YSBpbnRlZ3JpdHku\nIFdpdGhvdXQgdGhlIGNvb2tpZSBhIGJvb2tpZSBjb3VsZAogKiBzdGFydCB3\naXRoIG9uZSBvZiBpdHMgbGVkZ2VyIGRpcmVjdG9yaWVzIG1pc3NpbmcsIHNv\nIGRhdGEgd291bGQgYmUgbWlzc2luZywKICogYnV0IHRoZSBib29raWUgd291\nbGQgYmUgdXAsIHNvIHRoZSBjbGllbnQgd291bGQgdGhpbmsgdGhhdCBldmVy\neXRoaW5nIGlzIG9rCiAqIHdpdGggdGhlIGNsdXN0ZXIuIEl0J3MgYmV0dGVy\nIHRvIGZhaWwgZWFybHkgYW5kIG9idmlvdXNseS4KICovCmNsYXNzIENvb2tp\nZSB7CiAgICBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKENvb2tpZS5jbGFzcyk7CgogICAgc3RhdGljIGZpbmFsIGludCBD\nVVJSRU5UX0NPT0tJRV9MQVlPVVRfVkVSU0lPTiA9IDQ7CiAgICBwcml2YXRl\nIGludCBsYXlvdXRWZXJzaW9uID0gMDsKICAgIHByaXZhdGUgU3RyaW5nIGJv\nb2tpZUhvc3QgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgam91cm5hbERp\nciA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBsZWRnZXJEaXJzID0gbnVs\nbDsKICAgIHByaXZhdGUgaW50IHpub2RlVmVyc2lvbiA9IC0xOwogICAgcHJp\ndmF0ZSBTdHJpbmcgaW5zdGFuY2VJZCA9IG51bGw7CgogICAgcHJpdmF0ZSBD\nb29raWUoKSB7CiAgICB9CgogICAgcHVibGljIHZvaWQgdmVyaWZ5KENvb2tp\nZSBjKSB0aHJvd3MgQm9va2llRXhjZXB0aW9uLkludmFsaWRDb29raWVFeGNl\ncHRpb24gewogICAgICAgIFN0cmluZyBlcnJNc2c7CiAgICAgICAgaWYgKGMu\nbGF5b3V0VmVyc2lvbiA8IDMgJiYgYy5sYXlvdXRWZXJzaW9uICE9IGxheW91\ndFZlcnNpb24pIHsKICAgICAgICAgICAgZXJyTXNnID0gIkNvb2tpZSBpcyBv\nZiB0b28gb2xkIHZlcnNpb24gIiArIGMubGF5b3V0VmVyc2lvbjsKICAgICAg\nICAgICAgTE9HLmVycm9yKGVyck1zZyk7CiAgICAgICAgICAgIHRocm93IG5l\ndyBCb29raWVFeGNlcHRpb24uSW52YWxpZENvb2tpZUV4Y2VwdGlvbihlcnJN\nc2cpOwogICAgICAgIH0gZWxzZSBpZiAoIShjLmxheW91dFZlcnNpb24gPj0g\nMyAmJiBjLmJvb2tpZUhvc3QuZXF1YWxzKGJvb2tpZUhvc3QpCiAgICAgICAg\nICAgICAgICAmJiBjLmpvdXJuYWxEaXIuZXF1YWxzKGpvdXJuYWxEaXIpICYm\nIGMubGVkZ2VyRGlycwogICAgICAgICAgICAgICAgICAgIC5lcXVhbHMobGVk\nZ2VyRGlycykpKSB7CiAgICAgICAgICAgIGVyck1zZyA9ICJDb29raWUgWyIg\nKyB0aGlzICsgIl0gaXMgbm90IG1hdGNoaW5nIHdpdGggWyIgKyBjICsgIl0i\nOwogICAgICAgICAgICB0aHJvdyBuZXcgQm9va2llRXhjZXB0aW9uLkludmFs\naWRDb29raWVFeGNlcHRpb24oZXJyTXNnKTsKICAgICAgICB9IGVsc2UgaWYg\nKChpbnN0YW5jZUlkID09IG51bGwgJiYgYy5pbnN0YW5jZUlkICE9IG51bGwp\nCiAgICAgICAgICAgICAgICB8fCAoaW5zdGFuY2VJZCAhPSBudWxsICYmICFp\nbnN0YW5jZUlkLmVxdWFscyhjLmluc3RhbmNlSWQpKSkgewogICAgICAgICAg\nICAvLyBpbnN0YW5jZUlkIHNob3VsZCBiZSBzYW1lIGluIGJvdGggY29va2ll\ncwogICAgICAgICAgICBlcnJNc2cgPSAiaW5zdGFuY2VJZCAiICsgaW5zdGFu\nY2VJZAogICAgICAgICAgICAgICAgICAgICsgIiBpcyBub3QgbWF0Y2hpbmcg\nd2l0aCAiICsgYy5pbnN0YW5jZUlkOwogICAgICAgICAgICB0aHJvdyBuZXcg\nQm9va2llRXhjZXB0aW9uLkludmFsaWRDb29raWVFeGNlcHRpb24oZXJyTXNn\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmlu\nZygpIHsKICAgICAgICBpZiAobGF5b3V0VmVyc2lvbiA8PSAzKSB7CiAgICAg\nICAgICAgIHJldHVybiB0b1N0cmluZ1ZlcnNpb24zKCk7CiAgICAgICAgfQog\nICAgICAgIENvb2tpZUZvcm1hdC5CdWlsZGVyIGJ1aWxkZXIgPSBDb29raWVG\nb3JtYXQubmV3QnVpbGRlcigpOwogICAgICAgIGJ1aWxkZXIuc2V0Qm9va2ll\nSG9zdChib29raWVIb3N0KTsKICAgICAgICBidWlsZGVyLnNldEpvdXJuYWxE\naXIoam91cm5hbERpcik7CiAgICAgICAgYnVpbGRlci5zZXRMZWRnZXJEaXJz\nKGxlZGdlckRpcnMpOwogICAgICAgIGlmIChudWxsICE9IGluc3RhbmNlSWQp\nIHsKICAgICAgICAgICAgYnVpbGRlci5zZXRJbnN0YW5jZUlkKGluc3RhbmNl\nSWQpOwogICAgICAgIH0KICAgICAgICBTdHJpbmdCdWlsZGVyIGIgPSBuZXcg\nU3RyaW5nQnVpbGRlcigpOwogICAgICAgIGIuYXBwZW5kKENVUlJFTlRfQ09P\nS0lFX0xBWU9VVF9WRVJTSU9OKS5hcHBlbmQoIlxuIik7CiAgICAgICAgYi5h\ncHBlbmQoVGV4dEZvcm1hdC5wcmludFRvU3RyaW5nKGJ1aWxkZXIuYnVpbGQo\nKSkpOwogICAgICAgIHJldHVybiBiLnRvU3RyaW5nKCk7CiAgICB9CgogICAg\ncHJpdmF0ZSBTdHJpbmcgdG9TdHJpbmdWZXJzaW9uMygpIHsKICAgICAgICBT\ndHJpbmdCdWlsZGVyIGIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nIGIuYXBwZW5kKENVUlJFTlRfQ09PS0lFX0xBWU9VVF9WRVJTSU9OKS5hcHBl\nbmQoIlxuIikKICAgICAgICAgICAgLmFwcGVuZChib29raWVIb3N0KS5hcHBl\nbmQoIlxuIikKICAgICAgICAgICAgLmFwcGVuZChqb3VybmFsRGlyKS5hcHBl\nbmQoIlxuIikKICAgICAgICAgICAgLmFwcGVuZChsZWRnZXJEaXJzKS5hcHBl\nbmQoIlxuIik7CiAgICAgICAgcmV0dXJuIGIudG9TdHJpbmcoKTsKICAgIH0K\nCiAgICBwcml2YXRlIHN0YXRpYyBDb29raWUgcGFyc2UoQnVmZmVyZWRSZWFk\nZXIgcmVhZGVyKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENvb2tp\nZSBjID0gbmV3IENvb2tpZSgpOwogICAgICAgIFN0cmluZyBsaW5lID0gcmVh\nZGVyLnJlYWRMaW5lKCk7CiAgICAgICAgaWYgKG51bGwgPT0gbGluZSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgRU9GRXhjZXB0aW9uKCJFeGNlcHRpb24g\naW4gcGFyc2luZyBjb29raWUiKTsKICAgICAgICB9CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgYy5sYXlvdXRWZXJzaW9uID0gSW50ZWdlci5wYXJzZUlu\ndChsaW5lLnRyaW0oKSk7CiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0\naW9uKCJJbnZhbGlkIHN0cmluZyAnIiArIGxpbmUudHJpbSgpCiAgICAgICAg\nICAgICAgICAgICAgKyAiJywgY2Fubm90IHBhcnNlIGNvb2tpZS4iKTsKICAg\nICAgICB9CiAgICAgICAgaWYgKGMubGF5b3V0VmVyc2lvbiA9PSAzKSB7CiAg\nICAgICAgICAgIGMuYm9va2llSG9zdCA9IHJlYWRlci5yZWFkTGluZSgpOwog\nICAgICAgICAgICBjLmpvdXJuYWxEaXIgPSByZWFkZXIucmVhZExpbmUoKTsK\nICAgICAgICAgICAgYy5sZWRnZXJEaXJzID0gcmVhZGVyLnJlYWRMaW5lKCk7\nCiAgICAgICAgfSBlbHNlIGlmIChjLmxheW91dFZlcnNpb24gPj0gNCkgewog\nICAgICAgICAgICBDb29raWVGb3JtYXQuQnVpbGRlciBidWlsZGVyID0gQ29v\na2llRm9ybWF0Lm5ld0J1aWxkZXIoKTsKICAgICAgICAgICAgVGV4dEZvcm1h\ndC5tZXJnZShyZWFkZXIsIGJ1aWxkZXIpOwogICAgICAgICAgICBDb29raWVG\nb3JtYXQgZGF0YSA9IGJ1aWxkZXIuYnVpbGQoKTsKICAgICAgICAgICAgYy5i\nb29raWVIb3N0ID0gZGF0YS5nZXRCb29raWVIb3N0KCk7CiAgICAgICAgICAg\nIGMuam91cm5hbERpciA9IGRhdGEuZ2V0Sm91cm5hbERpcigpOwogICAgICAg\nICAgICBjLmxlZGdlckRpcnMgPSBkYXRhLmdldExlZGdlckRpcnMoKTsKICAg\nICAgICAgICAgLy8gU2luY2UgSW5zdGFuY2VJZCBpcyBvcHRpb25hbAogICAg\nICAgICAgICBpZiAobnVsbCAhPSBkYXRhLmdldEluc3RhbmNlSWQoKSAmJiAh\nZGF0YS5nZXRJbnN0YW5jZUlkKCkuaXNFbXB0eSgpKSB7CiAgICAgICAgICAg\nICAgICBjLmluc3RhbmNlSWQgPSBkYXRhLmdldEluc3RhbmNlSWQoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gYzsKICAgIH0K\nCiAgICB2b2lkIHdyaXRlVG9EaXJlY3RvcnkoRmlsZSBkaXJlY3RvcnkpIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgRmlsZSB2ZXJzaW9uRmlsZSA9\nIG5ldyBGaWxlKGRpcmVjdG9yeSwKICAgICAgICAgICAgICAgIEJvb2tLZWVw\nZXJDb25zdGFudHMuVkVSU0lPTl9GSUxFTkFNRSk7CgogICAgICAgIEZpbGVP\ndXRwdXRTdHJlYW0gZm9zID0gbmV3IEZpbGVPdXRwdXRTdHJlYW0odmVyc2lv\nbkZpbGUpOwogICAgICAgIEJ1ZmZlcmVkV3JpdGVyIGJ3ID0gbnVsbDsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBidyA9IG5ldyBCdWZmZXJlZFdyaXRl\ncihuZXcgT3V0cHV0U3RyZWFtV3JpdGVyKGZvcykpOwogICAgICAgICAgICBi\ndy53cml0ZSh0b1N0cmluZygpKTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICBpZiAoYncgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgYncu\nY2xvc2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3MuY2xvc2Uo\nKTsKICAgICAgICB9CiAgICB9CgogICAgdm9pZCB3cml0ZVRvWm9vS2VlcGVy\nKFpvb0tlZXBlciB6aywgU2VydmVyQ29uZmlndXJhdGlvbiBjb25mKQogICAg\nICAgICAgICB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwgVW5rbm93bkhvc3RFeGNlcHRpb24gewogICAgICAgIFN0cmlu\nZyBib29raWVDb29raWVQYXRoID0gY29uZi5nZXRaa0xlZGdlcnNSb290UGF0\naCgpICsgIi8iCiAgICAgICAgICAgICAgICArIEJvb2tLZWVwZXJDb25zdGFu\ndHMuQ09PS0lFX05PREU7CiAgICAgICAgU3RyaW5nIHprUGF0aCA9IGdldFpr\nUGF0aChjb25mKTsKICAgICAgICBieXRlW10gZGF0YSA9IHRvU3RyaW5nKCku\nZ2V0Qnl0ZXMoKTsKICAgICAgICBpZiAoem5vZGVWZXJzaW9uICE9IC0xKSB7\nCiAgICAgICAgICAgIHprLnNldERhdGEoemtQYXRoLCBkYXRhLCB6bm9kZVZl\ncnNpb24pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh6ay5l\neGlzdHMoYm9va2llQ29va2llUGF0aCwgZmFsc2UpID09IG51bGwpIHsKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgemsuY3Jl\nYXRlKGJvb2tpZUNvb2tpZVBhdGgsIG5ldyBieXRlWzBdLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVh\ndGVNb2RlLlBFUlNJU1RFTlQpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAo\nS2VlcGVyRXhjZXB0aW9uLk5vZGVFeGlzdHNFeGNlcHRpb24gbm5lKSB7CiAg\nICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIk1vcmUgdGhhbiBvbmUgYm9v\na2llIHRyaWVkIHRvIGNyZWF0ZSB7fSBhdCBvbmNlLiBTYWZlIHRvIGlnbm9y\nZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9va2llQ29va2ll\nUGF0aCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgemsuY3JlYXRlKHprUGF0aCwgZGF0YSwKICAgICAgICAgICAgICAg\nICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lT\nVEVOVCk7CiAgICAgICAgICAgIFN0YXQgc3RhdCA9IHprLmV4aXN0cyh6a1Bh\ndGgsIGZhbHNlKTsKICAgICAgICAgICAgdGhpcy56bm9kZVZlcnNpb24gPSBz\ndGF0LmdldFZlcnNpb24oKTsKICAgICAgICB9CiAgICB9CgogICAgdm9pZCBk\nZWxldGVGcm9tWm9vS2VlcGVyKFpvb0tlZXBlciB6aywgU2VydmVyQ29uZmln\ndXJhdGlvbiBjb25mKQogICAgICAgICAgICB0aHJvd3MgS2VlcGVyRXhjZXB0\naW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgVW5rbm93bkhvc3RFeGNlcHRp\nb24gewogICAgICAgIFN0cmluZyB6a1BhdGggPSBnZXRaa1BhdGgoY29uZik7\nCiAgICAgICAgaWYgKHpub2RlVmVyc2lvbiAhPSAtMSkgewogICAgICAgICAg\nICB6ay5kZWxldGUoemtQYXRoLCB6bm9kZVZlcnNpb24pOwogICAgICAgIH0K\nICAgICAgICB6bm9kZVZlcnNpb24gPSAtMTsKICAgIH0KCiAgICBzdGF0aWMg\nQ29va2llIGdlbmVyYXRlQ29va2llKFNlcnZlckNvbmZpZ3VyYXRpb24gY29u\nZikKICAgICAgICAgICAgdGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uIHsK\nICAgICAgICBDb29raWUgYyA9IG5ldyBDb29raWUoKTsKICAgICAgICBjLmxh\neW91dFZlcnNpb24gPSBDVVJSRU5UX0NPT0tJRV9MQVlPVVRfVkVSU0lPTjsK\nICAgICAgICBjLmJvb2tpZUhvc3QgPSBTdHJpbmdVdGlscy5hZGRyVG9TdHJp\nbmcoQm9va2llLmdldEJvb2tpZUFkZHJlc3MoY29uZikpOwogICAgICAgIGMu\nam91cm5hbERpciA9IGNvbmYuZ2V0Sm91cm5hbERpck5hbWUoKTsKICAgICAg\nICBTdHJpbmdCdWlsZGVyIGIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAg\nICAgIFN0cmluZ1tdIGRpcnMgPSBjb25mLmdldExlZGdlckRpck5hbWVzKCk7\nCiAgICAgICAgYi5hcHBlbmQoZGlycy5sZW5ndGgpOwogICAgICAgIGZvciAo\nU3RyaW5nIGQgOiBkaXJzKSB7CiAgICAgICAgICAgIGIuYXBwZW5kKCJcdCIp\nLmFwcGVuZChkKTsKICAgICAgICB9CiAgICAgICAgYy5sZWRnZXJEaXJzID0g\nYi50b1N0cmluZygpOwogICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIHN0\nYXRpYyBDb29raWUgcmVhZEZyb21ab29LZWVwZXIoWm9vS2VlcGVyIHprLCBT\nZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYpCiAgICAgICAgICAgIHRocm93cyBL\nZWVwZXJFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uLCBJT0V4Y2Vw\ndGlvbiwgVW5rbm93bkhvc3RFeGNlcHRpb24gewogICAgICAgIFN0cmluZyB6\na1BhdGggPSBnZXRaa1BhdGgoY29uZik7CgogICAgICAgIFN0YXQgc3RhdCA9\nIHprLmV4aXN0cyh6a1BhdGgsIGZhbHNlKTsKICAgICAgICBieXRlW10gZGF0\nYSA9IHprLmdldERhdGEoemtQYXRoLCBmYWxzZSwgc3RhdCk7CiAgICAgICAg\nQnVmZmVyZWRSZWFkZXIgcmVhZGVyID0gbmV3IEJ1ZmZlcmVkUmVhZGVyKG5l\ndyBTdHJpbmdSZWFkZXIobmV3IFN0cmluZygKICAgICAgICAgICAgICAgIGRh\ndGEpKSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ29va2llIGMgPSBw\nYXJzZShyZWFkZXIpOwogICAgICAgICAgICBjLnpub2RlVmVyc2lvbiA9IHN0\nYXQuZ2V0VmVyc2lvbigpOwogICAgICAgICAgICByZXR1cm4gYzsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICByZWFkZXIuY2xvc2UoKTsKICAg\nICAgICB9CiAgICB9CgogICAgc3RhdGljIENvb2tpZSByZWFkRnJvbURpcmVj\ndG9yeShGaWxlIGRpcmVjdG9yeSkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBGaWxlIHZlcnNpb25GaWxlID0gbmV3IEZpbGUoZGlyZWN0b3J5LAog\nICAgICAgICAgICAgICAgQm9va0tlZXBlckNvbnN0YW50cy5WRVJTSU9OX0ZJ\nTEVOQU1FKTsKICAgICAgICBCdWZmZXJlZFJlYWRlciByZWFkZXIgPSBuZXcg\nQnVmZmVyZWRSZWFkZXIobmV3IEZpbGVSZWFkZXIodmVyc2lvbkZpbGUpKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gcGFyc2UocmVhZGVy\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICByZWFkZXIuY2xv\nc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0SW5z\ndGFuY2VJZChTdHJpbmcgaW5zdGFuY2VJZCkgewogICAgICAgIHRoaXMuaW5z\ndGFuY2VJZCA9IGluc3RhbmNlSWQ7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0\naWMgU3RyaW5nIGdldFprUGF0aChTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYp\nCiAgICAgICAgICAgIHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlvbiB7CiAg\nICAgICAgU3RyaW5nIGJvb2tpZUNvb2tpZVBhdGggPSBjb25mLmdldFprTGVk\nZ2Vyc1Jvb3RQYXRoKCkgKyAiLyIKICAgICAgICAgICAgICAgICsgQm9va0tl\nZXBlckNvbnN0YW50cy5DT09LSUVfTk9ERTsKICAgICAgICByZXR1cm4gYm9v\na2llQ29va2llUGF0aCArICIvIiArIFN0cmluZ1V0aWxzLmFkZHJUb1N0cmlu\nZyhCb29raWUuZ2V0Qm9va2llQWRkcmVzcyhjb25mKSk7CiAgICB9Cn0K\n","encoding":"base64"}

