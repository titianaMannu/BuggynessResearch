{"sha":"8062ad9e016103d66c608a991fcd014d9dce1557","node_id":"MDQ6QmxvYjE1NzU5NTY6ODA2MmFkOWUwMTYxMDNkNjZjNjA4YTk5MWZjZDAxNGQ5ZGNlMTU1Nw==","size":34469,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8062ad9e016103d66c608a991fcd014d9dce1557","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0Lklu\nZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxp\nbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUmFuZG9tOwppbXBvcnQgamF2\nYS51dGlsLlVVSUQ7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNs\naWVudC5Bc3luY0NhbGxiYWNrLk9wZW5DYWxsYmFjazsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5jbGllbnQuQXN5bmNDYWxsYmFjay5SZWNvdmVy\nQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50\nLkJvb2tLZWVwZXIuU3luY09wZW5DYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRnJhZ21lbnRSZXBsaWNhdG9y\nLlNpbmdsZUZyYWdtZW50Q2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENh\nbGxiYWNrcy5NdWx0aUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5Qcm9j\nZXNzb3I7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5Cb29r\nS2VlcGVyQ29uc3RhbnRzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnV0aWwuSU9VdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51\ndGlsLlprVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuem9v\na2VlcGVyLlpvb0tlZXBlcldhdGNoZXJCYXNlOwppbXBvcnQgb3JnLmFwYWNo\nZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5aS1V0aWw7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29L\nZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNl\ncHRpb24uQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0Rl\nZnMuSWRzOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5z\nbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIEFkbWluIGNsaWVudCBmb3Ig\nQm9va0tlZXBlciBjbHVzdGVycwogKi8KcHVibGljIGNsYXNzIEJvb2tLZWVw\nZXJBZG1pbiB7CiAgICBwcml2YXRlIHN0YXRpYyBMb2dnZXIgTE9HID0gTG9n\nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoQm9va0tlZXBlckFkbWluLmNsYXNzKTsK\nICAgIC8vIFpLIGNsaWVudCBpbnN0YW5jZQogICAgcHJpdmF0ZSBab29LZWVw\nZXIgems7CiAgICAvLyBaSyBsZWRnZXJzIHJlbGF0ZWQgU3RyaW5nIGNvbnN0\nYW50cwogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgYm9va2llc1BhdGg7Cgog\nICAgLy8gQm9va0tlZXBlciBjbGllbnQgaW5zdGFuY2UKICAgIHByaXZhdGUg\nQm9va0tlZXBlciBia2M7CiAgICAKICAgIC8vIExlZGdlckZyYWdtZW50UmVw\nbGljYXRvciBpbnN0YW5jZQogICAgcHJpdmF0ZSBMZWRnZXJGcmFnbWVudFJl\ncGxpY2F0b3IgbGZyOwoKICAgIC8qCiAgICAgKiBSYW5kb20gbnVtYmVyIGdl\nbmVyYXRvciB1c2VkIHRvIGNob29zZSBhbiBhdmFpbGFibGUgYm9va2llIHNl\ncnZlciB0bwogICAgICogcmVwbGljYXRlIGRhdGEgZnJvbSBhIGRlYWQgYm9v\na2llLgogICAgICovCiAgICBwcml2YXRlIFJhbmRvbSByYW5kID0gbmV3IFJh\nbmRvbSgpOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IgdGhhdCB0YWtl\ncyBpbiBhIFpvb0tlZXBlciBzZXJ2ZXJzIGNvbm5lY3Qgc3RyaW5nIHNvIHdl\nIGtub3cKICAgICAqIGhvdyB0byBjb25uZWN0IHRvIFpvb0tlZXBlciB0byBy\nZXRyaWV2ZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgQm9va0tlZXBlcgogICAg\nICogY2x1c3Rlci4gV2UgbmVlZCB0aGlzIGJlZm9yZSB3ZSBjYW4gZG8gYW55\nIHR5cGUgb2YgYWRtaW4gb3BlcmF0aW9ucyBvbgogICAgICogdGhlIEJvb2tL\nZWVwZXIgY2x1c3Rlci4KICAgICAqCiAgICAgKiBAcGFyYW0gemtTZXJ2ZXJz\nCiAgICAgKiAgICAgICAgICAgIENvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIGhv\nc3RuYW1lOnBvcnQgcGFpcnMgZm9yIHRoZSBab29LZWVwZXIKICAgICAqICAg\nICAgICAgICAgc2VydmVycyBjbHVzdGVyLgogICAgICogQHRocm93cyBJT0V4\nY2VwdGlvbgogICAgICogICAgICAgICAgICAgdGhyb3dzIHRoaXMgZXhjZXB0\naW9uIGlmIHRoZXJlIGlzIGFuIGVycm9yIGluc3RhbnRpYXRpbmcgdGhlCiAg\nICAgKiAgICAgICAgICAgICBab29LZWVwZXIgY2xpZW50LgogICAgICogQHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogICAgICAgICAgICAg\nVGhyb3dzIHRoaXMgZXhjZXB0aW9uIGlmIHRoZXJlIGlzIGFuIGVycm9yIGlu\nc3RhbnRpYXRpbmcgdGhlCiAgICAgKiAgICAgICAgICAgICBCb29rS2VlcGVy\nIGNsaWVudC4KICAgICAqIEB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uCiAgICAg\nKiAgICAgICAgICAgICBUaHJvd3MgdGhpcyBleGNlcHRpb24gaWYgdGhlcmUg\naXMgYW4gZXJyb3IgaW5zdGFudGlhdGluZyB0aGUKICAgICAqICAgICAgICAg\nICAgIEJvb2tLZWVwZXIgY2xpZW50LgogICAgICovCiAgICBwdWJsaWMgQm9v\na0tlZXBlckFkbWluKFN0cmluZyB6a1NlcnZlcnMpIHRocm93cyBJT0V4Y2Vw\ndGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiB7\nCiAgICAgICAgdGhpcyhuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpLnNldFpr\nU2VydmVycyh6a1NlcnZlcnMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\nbnN0cnVjdG9yIHRoYXQgdGFrZXMgaW4gYSBjb25maWd1cmF0aW9uIG9iamVj\ndCBzbyB3ZSBrbm93CiAgICAgKiBob3cgdG8gY29ubmVjdCB0byBab29LZWVw\nZXIgdG8gcmV0cmlldmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIEJvb2tLZWVw\nZXIKICAgICAqIGNsdXN0ZXIuIFdlIG5lZWQgdGhpcyBiZWZvcmUgd2UgY2Fu\nIGRvIGFueSB0eXBlIG9mIGFkbWluIG9wZXJhdGlvbnMgb24KICAgICAqIHRo\nZSBCb29rS2VlcGVyIGNsdXN0ZXIuCiAgICAgKgogICAgICogQHBhcmFtIGNv\nbmYKICAgICAqICAgICAgICAgICBDbGllbnQgQ29uZmlndXJhdGlvbiBPYmpl\nY3QKICAgICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAqICAgICAgICAg\nICAgIHRocm93cyB0aGlzIGV4Y2VwdGlvbiBpZiB0aGVyZSBpcyBhbiBlcnJv\nciBpbnN0YW50aWF0aW5nIHRoZQogICAgICogICAgICAgICAgICAgWm9vS2Vl\ncGVyIGNsaWVudC4KICAgICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRp\nb24KICAgICAqICAgICAgICAgICAgIFRocm93cyB0aGlzIGV4Y2VwdGlvbiBp\nZiB0aGVyZSBpcyBhbiBlcnJvciBpbnN0YW50aWF0aW5nIHRoZQogICAgICog\nICAgICAgICAgICAgQm9va0tlZXBlciBjbGllbnQuCiAgICAgKiBAdGhyb3dz\nIEtlZXBlckV4Y2VwdGlvbgogICAgICogICAgICAgICAgICAgVGhyb3dzIHRo\naXMgZXhjZXB0aW9uIGlmIHRoZXJlIGlzIGFuIGVycm9yIGluc3RhbnRpYXRp\nbmcgdGhlCiAgICAgKiAgICAgICAgICAgICBCb29rS2VlcGVyIGNsaWVudC4K\nICAgICAqLwogICAgcHVibGljIEJvb2tLZWVwZXJBZG1pbihDbGllbnRDb25m\naWd1cmF0aW9uIGNvbmYpIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0\nZWRFeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiB7CiAgICAgICAgLy8gQ3Jl\nYXRlIHRoZSBab29LZWVwZXIgY2xpZW50IGluc3RhbmNlCiAgICAgICAgWm9v\nS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVwZXJXYXRjaGVyQmFz\nZShjb25mLmdldFprVGltZW91dCgpKTsKICAgICAgICB6ayA9IFprVXRpbHMu\nY3JlYXRlQ29ubmVjdGVkWm9va2VlcGVyQ2xpZW50KGNvbmYuZ2V0WmtTZXJ2\nZXJzKCksIHcpOwogICAgICAgIC8vIENyZWF0ZSB0aGUgYm9va2llIHBhdGgK\nICAgICAgICBib29raWVzUGF0aCA9IGNvbmYuZ2V0WmtBdmFpbGFibGVCb29r\naWVzUGF0aCgpOwogICAgICAgIC8vIENyZWF0ZSB0aGUgQm9va0tlZXBlciBj\nbGllbnQgaW5zdGFuY2UKICAgICAgICBia2MgPSBuZXcgQm9va0tlZXBlcihj\nb25mLCB6ayk7CiAgICAgICAgdGhpcy5sZnIgPSBuZXcgTGVkZ2VyRnJhZ21l\nbnRSZXBsaWNhdG9yKGJrYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25z\ndHJ1Y3RvciB0aGF0IHRha2VzIGluIGEgQm9va0tlZXBlciBpbnN0YW5jZSAu\nIFRoaXMgd2lsbCBiZSB1c2VmdWwsCiAgICAgKiB3aGVuIHVzZXJzIGFscmVh\nZHkgaGFzIGJrIGluc3RhbmNlIHJlYWR5LgogICAgICogCiAgICAgKiBAcGFy\nYW0gYmtjCiAgICAgKiAgICAgICAgICAgIC0gYm9va2tlZXBlciBpbnN0YW5j\nZQogICAgICovCiAgICBwdWJsaWMgQm9va0tlZXBlckFkbWluKGZpbmFsIEJv\nb2tLZWVwZXIgYmtjKSB7CiAgICAgICAgdGhpcy5ia2MgPSBia2M7CiAgICAg\nICAgdGhpcy56ayA9IGJrYy56azsKICAgICAgICB0aGlzLmJvb2tpZXNQYXRo\nID0gYmtjLmdldENvbmYoKS5nZXRaa0F2YWlsYWJsZUJvb2tpZXNQYXRoKCk7\nCiAgICAgICAgdGhpcy5sZnIgPSBuZXcgTGVkZ2VyRnJhZ21lbnRSZXBsaWNh\ndG9yKGJrYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHcmFjZWZ1bGx5IHJl\nbGVhc2UgcmVzb3VyY2VzIHRoYXQgdGhpcyBjbGllbnQgdXNlcy4KICAgICAq\nCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAgKiAg\nICAgICAgICAgICBpZiB0aGVyZSBpcyBhbiBlcnJvciBzaHV0dGluZyBkb3du\nIHRoZSBjbGllbnRzIHRoYXQgdGhpcwogICAgICogICAgICAgICAgICAgY2xh\nc3MgdXNlcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJv\nd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24sIEJLRXhjZXB0aW9uIHsKICAgICAg\nICBia2MuY2xvc2UoKTsKICAgICAgICB6ay5jbG9zZSgpOwogICAgfQoKICAg\nIC8qKgogICAgICogT3BlbiBhIGxlZGdlciBhcyBhbiBhZG1pbmlzdHJhdG9y\nLiBUaGlzIG1lYW5zIHRoYXQgbm8gZGlnZXN0IHBhc3N3b3JkCiAgICAgKiBj\naGVja3MgYXJlIGRvbmUuIE90aGVyd2lzZSwgdGhlIGNhbGwgaXMgaWRlbnRp\nY2FsIHRvIEJvb2tLZWVwZXIjYXN5bmNPcGVuTGVkZ2VyCiAgICAgKgogICAg\nICogQHBhcmFtIGxJZAogICAgICogICAgICAgICAgbGVkZ2VyIGlkZW50aWZp\nZXIKICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAgICAgQ2FsbGJhY2sg\nd2hpY2ggd2lsbCByZWNlaXZlIGEgTGVkZ2VySGFuZGxlIG9iamVjdAogICAg\nICogQHBhcmFtIGN0eAogICAgICogICAgICAgICAgb3B0aW9uYWwgY29udGV4\ndCBvYmplY3QsIHRvIGJlIHBhc3N3ZCB0byB0aGUgY2FsbGJhY2sgKGNhbiBi\nZSBudWxsKQogICAgICoKICAgICAqIEBzZWUgQm9va0tlZXBlciNhc3luY09w\nZW5MZWRnZXIKICAgICAqLwogICAgcHVibGljIHZvaWQgYXN5bmNPcGVuTGVk\nZ2VyKGZpbmFsIGxvbmcgbElkLCBmaW5hbCBPcGVuQ2FsbGJhY2sgY2IsIGZp\nbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICBuZXcgTGVkZ2VyT3Blbk9wKGJr\nYywgbElkLCBjYiwgY3R4KS5pbml0aWF0ZSgpOwogICAgfQogICAgCiAgICAv\nKioKICAgICAqIE9wZW4gYSBsZWRnZXIgYXMgYW4gYWRtaW5pc3RyYXRvci4g\nVGhpcyBtZWFucyB0aGF0IG5vIGRpZ2VzdCBwYXNzd29yZAogICAgICogY2hl\nY2tzIGFyZSBkb25lLiBPdGhlcndpc2UsIHRoZSBjYWxsIGlzIGlkZW50aWNh\nbCB0bwogICAgICogQm9va0tlZXBlciNvcGVuTGVkZ2VyCiAgICAgKiAKICAg\nICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAgICAgICAgLSBsZWRnZXIgaWRl\nbnRpZmllcgogICAgICogQHNlZSBCb29rS2VlcGVyI29wZW5MZWRnZXIKICAg\nICAqLwogICAgcHVibGljIExlZGdlckhhbmRsZSBvcGVuTGVkZ2VyKGZpbmFs\nIGxvbmcgbElkKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24sCiAgICAg\nICAgICAgIEJLRXhjZXB0aW9uIHsKICAgICAgICBTeW5jQ291bnRlciBjb3Vu\ndGVyID0gbmV3IFN5bmNDb3VudGVyKCk7CiAgICAgICAgY291bnRlci5pbmMo\nKTsKICAgICAgICBuZXcgTGVkZ2VyT3Blbk9wKGJrYywgbElkLCBuZXcgU3lu\nY09wZW5DYWxsYmFjaygpLCBjb3VudGVyKS5pbml0aWF0ZSgpOwogICAgICAg\nIC8qCiAgICAgICAgICogV2FpdAogICAgICAgICAqLwogICAgICAgIGNvdW50\nZXIuYmxvY2soMCk7CiAgICAgICAgaWYgKGNvdW50ZXIuZ2V0cmMoKSAhPSBC\nS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIHRocm93IEJLRXhj\nZXB0aW9uLmNyZWF0ZShjb3VudGVyLmdldHJjKCkpOwogICAgICAgIH0KCiAg\nICAgICAgcmV0dXJuIGNvdW50ZXIuZ2V0TGgoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIE9wZW4gYSBsZWRnZXIgYXMgYW4gYWRtaW5pc3RyYXRvciB3aXRo\nb3V0IHJlY292ZXJpbmcgdGhlIGxlZGdlci4gVGhpcyBtZWFucwogICAgICog\ndGhhdCBubyBkaWdlc3QgcGFzc3dvcmQgIGNoZWNrcyBhcmUgZG9uZS4gT3Ro\nZXJ3aXNlLCB0aGUgY2FsbCBpcyBpZGVudGljYWwKICAgICAqIHRvIEJvb2tL\nZWVwZXIjYXN5bmNPcGVuTGVkZ2VyTm9SZWNvdmVyeQogICAgICoKICAgICAq\nIEBwYXJhbSBsSWQKICAgICAqICAgICAgICAgIGxlZGdlciBpZGVudGlmaWVy\nCiAgICAgKiBAcGFyYW0gY2IKICAgICAqICAgICAgICAgIENhbGxiYWNrIHdo\naWNoIHdpbGwgcmVjZWl2ZSBhIExlZGdlckhhbmRsZSBvYmplY3QKICAgICAq\nIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgIG9wdGlvbmFsIGNvbnRleHQg\nb2JqZWN0LCB0byBiZSBwYXNzd2QgdG8gdGhlIGNhbGxiYWNrIChjYW4gYmUg\nbnVsbCkKICAgICAqCiAgICAgKiBAc2VlIEJvb2tLZWVwZXIjYXN5bmNPcGVu\nTGVkZ2VyTm9SZWNvdmVyeQogICAgICovCiAgICBwdWJsaWMgdm9pZCBhc3lu\nY09wZW5MZWRnZXJOb1JlY292ZXJ5KGZpbmFsIGxvbmcgbElkLCBmaW5hbCBP\ncGVuQ2FsbGJhY2sgY2IsIGZpbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICBu\nZXcgTGVkZ2VyT3Blbk9wKGJrYywgbElkLCBjYiwgY3R4KS5pbml0aWF0ZVdp\ndGhvdXRSZWNvdmVyeSgpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIE9w\nZW4gYSBsZWRnZXIgYXMgYW4gYWRtaW5pc3RyYXRvciB3aXRob3V0IHJlY292\nZXJpbmcgdGhlIGxlZGdlci4gVGhpcwogICAgICogbWVhbnMgdGhhdCBubyBk\naWdlc3QgcGFzc3dvcmQgY2hlY2tzIGFyZSBkb25lLiBPdGhlcndpc2UsIHRo\nZSBjYWxsIGlzCiAgICAgKiBpZGVudGljYWwgdG8gQm9va0tlZXBlciNvcGVu\nTGVkZ2VyTm9SZWNvdmVyeQogICAgICogCiAgICAgKiBAcGFyYW0gbElkCiAg\nICAgKiAgICAgICAgICAgIGxlZGdlciBpZGVudGlmaWVyCiAgICAgKiBAc2Vl\nIEJvb2tLZWVwZXIjb3BlbkxlZGdlck5vUmVjb3ZlcnkKICAgICAqLwogICAg\ncHVibGljIExlZGdlckhhbmRsZSBvcGVuTGVkZ2VyTm9SZWNvdmVyeShmaW5h\nbCBsb25nIGxJZCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhj\nZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgU3luY0NvdW50ZXIgY291\nbnRlciA9IG5ldyBTeW5jQ291bnRlcigpOwogICAgICAgIGNvdW50ZXIuaW5j\nKCk7CiAgICAgICAgbmV3IExlZGdlck9wZW5PcChia2MsIGxJZCwgbmV3IFN5\nbmNPcGVuQ2FsbGJhY2soKSwgY291bnRlcikKICAgICAgICAgICAgICAgIC5p\nbml0aWF0ZVdpdGhvdXRSZWNvdmVyeSgpOwogICAgICAgIC8qCiAgICAgICAg\nICogV2FpdAogICAgICAgICAqLwogICAgICAgIGNvdW50ZXIuYmxvY2soMCk7\nCiAgICAgICAgaWYgKGNvdW50ZXIuZ2V0cmMoKSAhPSBCS0V4Y2VwdGlvbi5D\nb2RlLk9LKSB7CiAgICAgICAgICAgIHRocm93IEJLRXhjZXB0aW9uLmNyZWF0\nZShjb3VudGVyLmdldHJjKCkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJu\nIGNvdW50ZXIuZ2V0TGgoKTsKICAgIH0KCiAgICAvLyBPYmplY3QgdXNlZCBm\nb3IgY2FsbGluZyBhc3luYyBtZXRob2RzIGFuZCB3YWl0aW5nIGZvciB0aGVt\nIHRvIGNvbXBsZXRlLgogICAgc3RhdGljIGNsYXNzIFN5bmNPYmplY3Qgewog\nICAgICAgIGJvb2xlYW4gdmFsdWU7CiAgICAgICAgaW50IHJjOwoKICAgICAg\nICBwdWJsaWMgU3luY09iamVjdCgpIHsKICAgICAgICAgICAgdmFsdWUgPSBm\nYWxzZTsKICAgICAgICAgICAgcmMgPSBCS0V4Y2VwdGlvbi5Db2RlLk9LOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN5bmNocm9ub3VzIG1l\ndGhvZCB0byByZWJ1aWxkIGFuZCByZWNvdmVyIHRoZSBsZWRnZXIgZnJhZ21l\nbnRzIGRhdGEgdGhhdAogICAgICogd2FzIHN0b3JlZCBvbiB0aGUgc291cmNl\nIGJvb2tpZS4gVGhhdCBib29raWUgY291bGQgaGF2ZSBmYWlsZWQgY29tcGxl\ndGVseQogICAgICogYW5kIG5vdyB0aGUgbGVkZ2VyIGRhdGEgdGhhdCB3YXMg\nc3RvcmVkIG9uIGl0IGlzIHVuZGVyIHJlcGxpY2F0ZWQuIEFuCiAgICAgKiBv\ncHRpb25hbCBkZXN0aW5hdGlvbiBib29raWUgc2VydmVyIGNvdWxkIGJlIGdp\ndmVuIGlmIHdlIHdhbnQgdG8gY29weSBhbGwKICAgICAqIG9mIHRoZSBsZWRn\nZXIgZnJhZ21lbnRzIGRhdGEgb24gdGhlIGZhaWxlZCBzb3VyY2UgYm9va2ll\nIHRvIGl0LgogICAgICogT3RoZXJ3aXNlLCB3ZSB3aWxsIGp1c3QgcmFuZG9t\nbHkgZGlzdHJpYnV0ZSB0aGUgbGVkZ2VyIGZyYWdtZW50cyB0byB0aGUKICAg\nICAqIGFjdGl2ZSBzZXQgb2YgYm9va2llcywgcGVyaGFwcyBiYXNlZCBvbiBs\nb2FkLiBBbGwgWm9vS2VlcGVyIGxlZGdlcgogICAgICogbWV0YWRhdGEgd2ls\nbCBiZSB1cGRhdGVkIHRvIHBvaW50IHRvIHRoZSBuZXcgYm9va2llKHMpIHRo\nYXQgY29udGFpbiB0aGUKICAgICAqIHJlcGxpY2F0ZWQgbGVkZ2VyIGZyYWdt\nZW50cy4KICAgICAqCiAgICAgKiBAcGFyYW0gYm9va2llU3JjCiAgICAgKiAg\nICAgICAgICAgIFNvdXJjZSBib29raWUgdGhhdCBoYWQgYSBmYWlsdXJlLiBX\nZSB3YW50IHRvIHJlcGxpY2F0ZSB0aGUKICAgICAqICAgICAgICAgICAgbGVk\nZ2VyIGZyYWdtZW50cyB0aGF0IHdlcmUgc3RvcmVkIHRoZXJlLgogICAgICog\nQHBhcmFtIGJvb2tpZURlc3QKICAgICAqICAgICAgICAgICAgT3B0aW9uYWwg\nZGVzdGluYXRpb24gYm9va2llIHRoYXQgaWYgcGFzc2VkLCB3ZSB3aWxsIGNv\ncHkgYWxsCiAgICAgKiAgICAgICAgICAgIG9mIHRoZSBsZWRnZXIgZnJhZ21l\nbnRzIGZyb20gdGhlIHNvdXJjZSBib29raWUgb3ZlciB0byBpdC4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgcmVjb3ZlckJvb2tpZURhdGEoZmluYWwgSW5l\ndFNvY2tldEFkZHJlc3MgYm9va2llU3JjLCBmaW5hbCBJbmV0U29ja2V0QWRk\ncmVzcyBib29raWVEZXN0KQogICAgICAgICAgICB0aHJvd3MgSW50ZXJydXB0\nZWRFeGNlcHRpb24sIEJLRXhjZXB0aW9uIHsKICAgICAgICBTeW5jT2JqZWN0\nIHN5bmMgPSBuZXcgU3luY09iamVjdCgpOwogICAgICAgIC8vIENhbGwgdGhl\nIGFzeW5jIG1ldGhvZCB0byByZWNvdmVyIGJvb2tpZSBkYXRhLgogICAgICAg\nIGFzeW5jUmVjb3ZlckJvb2tpZURhdGEoYm9va2llU3JjLCBib29raWVEZXN0\nLCBuZXcgUmVjb3ZlckNhbGxiYWNrKCkgewogICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgcmVjb3ZlckNvbXBsZXRlKGlu\ndCByYywgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgTE9HLmluZm8o\nIlJlY292ZXIgYm9va2llIG9wZXJhdGlvbiBjb21wbGV0ZWQgd2l0aCByYzog\nIiArIHJjKTsKICAgICAgICAgICAgICAgIFN5bmNPYmplY3Qgc3luY09iaiA9\nIChTeW5jT2JqZWN0KSBjdHg7CiAgICAgICAgICAgICAgICBzeW5jaHJvbml6\nZWQgKHN5bmNPYmopIHsKICAgICAgICAgICAgICAgICAgICBzeW5jT2JqLnJj\nID0gcmM7CiAgICAgICAgICAgICAgICAgICAgc3luY09iai52YWx1ZSA9IHRy\ndWU7CiAgICAgICAgICAgICAgICAgICAgc3luY09iai5ub3RpZnkoKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sIHN5bmMp\nOwoKICAgICAgICAvLyBXYWl0IGZvciB0aGUgYXN5bmMgbWV0aG9kIHRvIGNv\nbXBsZXRlLgogICAgICAgIHN5bmNocm9uaXplZCAoc3luYykgewogICAgICAg\nICAgICB3aGlsZSAoc3luYy52YWx1ZSA9PSBmYWxzZSkgewogICAgICAgICAg\nICAgICAgc3luYy53YWl0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgaWYgKHN5bmMucmMgIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewog\nICAgICAgICAgICB0aHJvdyBCS0V4Y2VwdGlvbi5jcmVhdGUoc3luYy5yYyk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQXN5bmMgbWV0aG9k\nIHRvIHJlYnVpbGQgYW5kIHJlY292ZXIgdGhlIGxlZGdlciBmcmFnbWVudHMg\nZGF0YSB0aGF0IHdhcwogICAgICogc3RvcmVkIG9uIHRoZSBzb3VyY2UgYm9v\na2llLiBUaGF0IGJvb2tpZSBjb3VsZCBoYXZlIGZhaWxlZCBjb21wbGV0ZWx5\nIGFuZAogICAgICogbm93IHRoZSBsZWRnZXIgZGF0YSB0aGF0IHdhcyBzdG9y\nZWQgb24gaXQgaXMgdW5kZXIgcmVwbGljYXRlZC4gQW4KICAgICAqIG9wdGlv\nbmFsIGRlc3RpbmF0aW9uIGJvb2tpZSBzZXJ2ZXIgY291bGQgYmUgZ2l2ZW4g\naWYgd2Ugd2FudCB0byBjb3B5IGFsbAogICAgICogb2YgdGhlIGxlZGdlciBm\ncmFnbWVudHMgZGF0YSBvbiB0aGUgZmFpbGVkIHNvdXJjZSBib29raWUgdG8g\naXQuCiAgICAgKiBPdGhlcndpc2UsIHdlIHdpbGwganVzdCByYW5kb21seSBk\naXN0cmlidXRlIHRoZSBsZWRnZXIgZnJhZ21lbnRzIHRvIHRoZQogICAgICog\nYWN0aXZlIHNldCBvZiBib29raWVzLCBwZXJoYXBzIGJhc2VkIG9uIGxvYWQu\nIEFsbCBab29LZWVwZXIgbGVkZ2VyCiAgICAgKiBtZXRhZGF0YSB3aWxsIGJl\nIHVwZGF0ZWQgdG8gcG9pbnQgdG8gdGhlIG5ldyBib29raWUocykgdGhhdCBj\nb250YWluIHRoZQogICAgICogcmVwbGljYXRlZCBsZWRnZXIgZnJhZ21lbnRz\nLgogICAgICoKICAgICAqIEBwYXJhbSBib29raWVTcmMKICAgICAqICAgICAg\nICAgICAgU291cmNlIGJvb2tpZSB0aGF0IGhhZCBhIGZhaWx1cmUuIFdlIHdh\nbnQgdG8gcmVwbGljYXRlIHRoZQogICAgICogICAgICAgICAgICBsZWRnZXIg\nZnJhZ21lbnRzIHRoYXQgd2VyZSBzdG9yZWQgdGhlcmUuCiAgICAgKiBAcGFy\nYW0gYm9va2llRGVzdAogICAgICogICAgICAgICAgICBPcHRpb25hbCBkZXN0\naW5hdGlvbiBib29raWUgdGhhdCBpZiBwYXNzZWQsIHdlIHdpbGwgY29weSBh\nbGwKICAgICAqICAgICAgICAgICAgb2YgdGhlIGxlZGdlciBmcmFnbWVudHMg\nZnJvbSB0aGUgc291cmNlIGJvb2tpZSBvdmVyIHRvIGl0LgogICAgICogQHBh\ncmFtIGNiCiAgICAgKiAgICAgICAgICAgIFJlY292ZXJDYWxsYmFjayB0byBp\nbnZva2Ugb25jZSBhbGwgb2YgdGhlIGRhdGEgb24gdGhlIGRlYWQKICAgICAq\nICAgICAgICAgICAgYm9va2llIGhhcyBiZWVuIHJlY292ZXJlZCBhbmQgcmVw\nbGljYXRlZC4KICAgICAqIEBwYXJhbSBjb250ZXh0CiAgICAgKiAgICAgICAg\nICAgIENvbnRleHQgZm9yIHRoZSBSZWNvdmVyQ2FsbGJhY2sgdG8gY2FsbC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgYXN5bmNSZWNvdmVyQm9va2llRGF0\nYShmaW5hbCBJbmV0U29ja2V0QWRkcmVzcyBib29raWVTcmMsIGZpbmFsIElu\nZXRTb2NrZXRBZGRyZXNzIGJvb2tpZURlc3QsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIFJlY292ZXJDYWxsYmFjayBj\nYiwgZmluYWwgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAvLyBTeW5jIFpL\nIHRvIG1ha2Ugc3VyZSB3ZSdyZSByZWFkaW5nIHRoZSBsYXRlc3QgYm9va2ll\nIGRhdGEuCiAgICAgICAgemsuc3luYyhib29raWVzUGF0aCwgbmV3IEFzeW5j\nQ2FsbGJhY2suVm9pZENhbGxiYWNrKCkgewogICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQg\ncmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAg\nICBpZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgTE9HLmVycm9yKCJaSyBlcnJvciBzeW5jaW5nOiAiLCBLZWVw\nZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4Y2VwdGlvbi5Db2RlLmdldChy\nYyksIHBhdGgpKTsKICAgICAgICAgICAgICAgICAgICBjYi5yZWNvdmVyQ29t\ncGxldGUoQktFeGNlcHRpb24uQ29kZS5aS0V4Y2VwdGlvbiwgY29udGV4dCk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgZ2V0QXZhaWxhYmxlQm9va2llcyhib29raWVT\ncmMsIGJvb2tpZURlc3QsIGNiLCBjb250ZXh0KTsKICAgICAgICAgICAgfTsK\nICAgICAgICB9LCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMg\nbWV0aG9kIGFzeW5jaHJvbm91c2x5IGdldHMgdGhlIHNldCBvZiBhdmFpbGFi\nbGUgQm9va2llcyB0aGF0IHRoZQogICAgICogZGVhZCBpbnB1dCBib29raWUn\ncyBkYXRhIHdpbGwgYmUgY29waWVkIG92ZXIgaW50by4gSWYgdGhlIHVzZXIg\ncGFzc2VkIGluCiAgICAgKiBhIHNwZWNpZmljIGRlc3RpbmF0aW9uIGJvb2tp\nZSwgdGhlbiBqdXN0IHVzZSB0aGF0IG9uZS4gT3RoZXJ3aXNlLCB3ZSdsbAog\nICAgICogcmFuZG9tbHkgcGljayBvbmUgb2YgdGhlIG90aGVyIGF2YWlsYWJs\nZSBib29raWVzIHRvIHVzZSBmb3IgZWFjaCBsZWRnZXIKICAgICAqIGZyYWdt\nZW50IHdlIGFyZSByZXBsaWNhdGluZy4KICAgICAqCiAgICAgKiBAcGFyYW0g\nYm9va2llU3JjCiAgICAgKiAgICAgICAgICAgIFNvdXJjZSBib29raWUgdGhh\ndCBoYWQgYSBmYWlsdXJlLiBXZSB3YW50IHRvIHJlcGxpY2F0ZSB0aGUKICAg\nICAqICAgICAgICAgICAgbGVkZ2VyIGZyYWdtZW50cyB0aGF0IHdlcmUgc3Rv\ncmVkIHRoZXJlLgogICAgICogQHBhcmFtIGJvb2tpZURlc3QKICAgICAqICAg\nICAgICAgICAgT3B0aW9uYWwgZGVzdGluYXRpb24gYm9va2llIHRoYXQgaWYg\ncGFzc2VkLCB3ZSB3aWxsIGNvcHkgYWxsCiAgICAgKiAgICAgICAgICAgIG9m\nIHRoZSBsZWRnZXIgZnJhZ21lbnRzIGZyb20gdGhlIHNvdXJjZSBib29raWUg\nb3ZlciB0byBpdC4KICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAgICAg\nICBSZWNvdmVyQ2FsbGJhY2sgdG8gaW52b2tlIG9uY2UgYWxsIG9mIHRoZSBk\nYXRhIG9uIHRoZSBkZWFkCiAgICAgKiAgICAgICAgICAgIGJvb2tpZSBoYXMg\nYmVlbiByZWNvdmVyZWQgYW5kIHJlcGxpY2F0ZWQuCiAgICAgKiBAcGFyYW0g\nY29udGV4dAogICAgICogICAgICAgICAgICBDb250ZXh0IGZvciB0aGUgUmVj\nb3ZlckNhbGxiYWNrIHRvIGNhbGwuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBnZXRBdmFpbGFibGVCb29raWVzKGZpbmFsIEluZXRTb2NrZXRBZGRyZXNz\nIGJvb2tpZVNyYywgZmluYWwgSW5ldFNvY2tldEFkZHJlc3MgYm9va2llRGVz\ndCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFs\nIFJlY292ZXJDYWxsYmFjayBjYiwgZmluYWwgT2JqZWN0IGNvbnRleHQpIHsK\nICAgICAgICBmaW5hbCBMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBhdmFpbGFi\nbGVCb29raWVzID0gbmV3IExpbmtlZExpc3Q8SW5ldFNvY2tldEFkZHJlc3M+\nKCk7CiAgICAgICAgaWYgKGJvb2tpZURlc3QgIT0gbnVsbCkgewogICAgICAg\nICAgICBhdmFpbGFibGVCb29raWVzLmFkZChib29raWVEZXN0KTsKICAgICAg\nICAgICAgLy8gTm93IHBvbGwgWksgdG8gZ2V0IHRoZSBhY3RpdmUgbGVkZ2Vy\ncwogICAgICAgICAgICBnZXRBY3RpdmVMZWRnZXJzKGJvb2tpZVNyYywgYm9v\na2llRGVzdCwgY2IsIGNvbnRleHQsIGF2YWlsYWJsZUJvb2tpZXMpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHprLmdldENoaWxkcmVuKGJvb2tp\nZXNQYXRoLCBudWxsLCBuZXcgQXN5bmNDYWxsYmFjay5DaGlsZHJlbkNhbGxi\nYWNrKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5n\nIHBhdGgsIE9iamVjdCBjdHgsIExpc3Q8U3RyaW5nPiBjaGlsZHJlbikgewog\nICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9LLmludFZhbHVl\nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJaSyBl\ncnJvciBnZXR0aW5nIGJvb2tpZSBub2RlczogIiwgS2VlcGVyRXhjZXB0aW9u\nLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLmdldChyYyksIHBhdGgpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgY2IucmVjb3ZlckNvbXBsZXRlKEJLRXhjZXB0aW9u\nLkNvZGUuWktFeGNlcHRpb24sIGNvbnRleHQpOwogICAgICAgICAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIGZvciAoU3RyaW5nIGJvb2tpZU5vZGUgOiBjaGlsZHJl\nbikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoQm9va0tlZXBlckNv\nbnN0YW50cy5SRUFET05MWQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgLmVxdWFscyhib29raWVOb2RlKSkgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gZXhjbHVkZSB0aGUgcmVhZG9ubHkgbm9k\nZSBmcm9tIGF2YWlsYWJsZSBib29raWVzLgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHBhcnRzW10gPSBib29r\naWVOb2RlLnNwbGl0KEJvb2tLZWVwZXJDb25zdGFudHMuQ09MT04pOwogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoIDwgMikgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJCb29raWUg\nTm9kZSByZXRyaWV2ZWQgZnJvbSBaSyBoYXMgaW52YWxpZCBuYW1lIGZvcm1h\ndDogIiArIGJvb2tpZU5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY2IucmVjb3ZlckNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNl\ncHRpb24sIGNvbnRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgICAgIGF2YWlsYWJsZUJvb2tpZXMuYWRkKG5ldyBJbmV0U29j\na2V0QWRkcmVzcyhwYXJ0c1swXSwgSW50ZWdlci5wYXJzZUludChwYXJ0c1sx\nXSkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgLy8gTm93IHBvbGwgWksgdG8gZ2V0IHRoZSBhY3RpdmUgbGVkZ2Vycwog\nICAgICAgICAgICAgICAgICAgIGdldEFjdGl2ZUxlZGdlcnMoYm9va2llU3Jj\nLCBudWxsLCBjYiwgY29udGV4dCwgYXZhaWxhYmxlQm9va2llcyk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIG51bGwpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgbWV0aG9kIGFzeW5jaHJvbm91\nc2x5IHBvbGxzIFpLIHRvIGdldCB0aGUgY3VycmVudCBzZXQgb2YgYWN0aXZl\nCiAgICAgKiBsZWRnZXJzLiBGcm9tIHRoaXMsIHdlIGNhbiBvcGVuIGVhY2gg\nbGVkZ2VyIGFuZCBsb29rIGF0IHRoZSBtZXRhZGF0YSB0bwogICAgICogZGV0\nZXJtaW5lIGlmIGFueSBvZiB0aGUgbGVkZ2VyIGZyYWdtZW50cyBmb3IgaXQg\nd2VyZSBzdG9yZWQgYXQgdGhlIGRlYWQKICAgICAqIGlucHV0IGJvb2tpZS4K\nICAgICAqCiAgICAgKiBAcGFyYW0gYm9va2llU3JjCiAgICAgKiAgICAgICAg\nICAgIFNvdXJjZSBib29raWUgdGhhdCBoYWQgYSBmYWlsdXJlLiBXZSB3YW50\nIHRvIHJlcGxpY2F0ZSB0aGUKICAgICAqICAgICAgICAgICAgbGVkZ2VyIGZy\nYWdtZW50cyB0aGF0IHdlcmUgc3RvcmVkIHRoZXJlLgogICAgICogQHBhcmFt\nIGJvb2tpZURlc3QKICAgICAqICAgICAgICAgICAgT3B0aW9uYWwgZGVzdGlu\nYXRpb24gYm9va2llIHRoYXQgaWYgcGFzc2VkLCB3ZSB3aWxsIGNvcHkgYWxs\nCiAgICAgKiAgICAgICAgICAgIG9mIHRoZSBsZWRnZXIgZnJhZ21lbnRzIGZy\nb20gdGhlIHNvdXJjZSBib29raWUgb3ZlciB0byBpdC4KICAgICAqIEBwYXJh\nbSBjYgogICAgICogICAgICAgICAgICBSZWNvdmVyQ2FsbGJhY2sgdG8gaW52\nb2tlIG9uY2UgYWxsIG9mIHRoZSBkYXRhIG9uIHRoZSBkZWFkCiAgICAgKiAg\nICAgICAgICAgIGJvb2tpZSBoYXMgYmVlbiByZWNvdmVyZWQgYW5kIHJlcGxp\nY2F0ZWQuCiAgICAgKiBAcGFyYW0gY29udGV4dAogICAgICogICAgICAgICAg\nICBDb250ZXh0IGZvciB0aGUgUmVjb3ZlckNhbGxiYWNrIHRvIGNhbGwuCiAg\nICAgKiBAcGFyYW0gYXZhaWxhYmxlQm9va2llcwogICAgICogICAgICAgICAg\nICBMaXN0IG9mIEJvb2tpZSBTZXJ2ZXJzIHRoYXQgYXJlIGF2YWlsYWJsZSB0\nbyB1c2UgZm9yCiAgICAgKiAgICAgICAgICAgIHJlcGxpY2F0aW5nIGRhdGEg\nb24gdGhlIGZhaWxlZCBib29raWUuIFRoaXMgY291bGQgY29udGFpbiBhCiAg\nICAgKiAgICAgICAgICAgIHNpbmdsZSBib29raWUgc2VydmVyIGlmIHRoZSB1\nc2VyIGV4cGxpY2l0bHkgY2hvc2UgYSBib29raWUKICAgICAqICAgICAgICAg\nICAgc2VydmVyIHRvIHJlcGxpY2F0ZSBkYXRhIHRvLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgZ2V0QWN0aXZlTGVkZ2VycyhmaW5hbCBJbmV0U29ja2V0\nQWRkcmVzcyBib29raWVTcmMsIGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIGJv\nb2tpZURlc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm\naW5hbCBSZWNvdmVyQ2FsbGJhY2sgY2IsIGZpbmFsIE9iamVjdCBjb250ZXh0\nLCBmaW5hbCBMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBhdmFpbGFibGVCb29r\naWVzKSB7CiAgICAgICAgLy8gV3JhcHBlciBjbGFzcyBhcm91bmQgdGhlIFJl\nY292ZXJDYWxsYmFjayBzbyBpdCBjYW4gYmUgdXNlZAogICAgICAgIC8vIGFz\nIHRoZSBmaW5hbCBWb2lkQ2FsbGJhY2sgdG8gcHJvY2VzcyBsZWRnZXJzCiAg\nICAgICAgY2xhc3MgUmVjb3ZlckNhbGxiYWNrV3JhcHBlciBpbXBsZW1lbnRz\nIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIHsKICAgICAgICAgICAgZmlu\nYWwgUmVjb3ZlckNhbGxiYWNrIGNiOwoKICAgICAgICAgICAgUmVjb3ZlckNh\nbGxiYWNrV3JhcHBlcihSZWNvdmVyQ2FsbGJhY2sgY2IpIHsKICAgICAgICAg\nICAgICAgIHRoaXMuY2IgPSBjYjsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NS\nZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCkgewogICAg\nICAgICAgICAgICAgY2IucmVjb3ZlckNvbXBsZXRlKHJjLCBjdHgpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBQcm9jZXNzb3I8TG9uZz4g\nbGVkZ2VyUHJvY2Vzc29yID0gbmV3IFByb2Nlc3NvcjxMb25nPigpIHsKICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHBy\nb2Nlc3MoTG9uZyBsZWRnZXJJZCwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJh\nY2sgaXRlckNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgICByZWNvdmVyTGVk\nZ2VyKGJvb2tpZVNyYywgbGVkZ2VySWQsIGl0ZXJDYWxsYmFjaywgYXZhaWxh\nYmxlQm9va2llcyk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAg\nIGJrYy5nZXRMZWRnZXJNYW5hZ2VyKCkuYXN5bmNQcm9jZXNzTGVkZ2VycygK\nICAgICAgICAgICAgbGVkZ2VyUHJvY2Vzc29yLCBuZXcgUmVjb3ZlckNhbGxi\nYWNrV3JhcHBlcihjYiksCiAgICAgICAgICAgIGNvbnRleHQsIEJLRXhjZXB0\naW9uLkNvZGUuT0ssIEJLRXhjZXB0aW9uLkNvZGUuTGVkZ2VyUmVjb3ZlcnlF\neGNlcHRpb24pOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IGEgbmV3IHJh\nbmRvbSBib29raWUsIGJ1dCBlbnN1cmUgdGhhdCBpdCBpc24ndCBvbmUgdGhh\ndCBpcyBhbHJlYWR5CiAgICAgKiBpbiB0aGUgZW5zZW1ibGUgZm9yIHRoZSBs\nZWRnZXIuCiAgICAgKi8KICAgIHByaXZhdGUgSW5ldFNvY2tldEFkZHJlc3Mg\nZ2V0TmV3Qm9va2llKGZpbmFsIExpc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGJv\nb2tpZXNBbHJlYWR5SW5FbnNlbWJsZSwgCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBMaXN0PEluZXRTb2NrZXRB\nZGRyZXNzPiBhdmFpbGFibGVCb29raWVzKSAKICAgICAgICAgICAgdGhyb3dz\nIEJLRXhjZXB0aW9uLkJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbiB7CiAg\nICAgICAgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBjYW5kaWRhdGVz\nID0gbmV3IEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVzcz4oKTsKICAgICAg\nICBjYW5kaWRhdGVzLmFkZEFsbChhdmFpbGFibGVCb29raWVzKTsKICAgICAg\nICBjYW5kaWRhdGVzLnJlbW92ZUFsbChib29raWVzQWxyZWFkeUluRW5zZW1i\nbGUpOwogICAgICAgIGlmIChjYW5kaWRhdGVzLnNpemUoKSA9PSAwKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBCS0V4Y2VwdGlvbi5CS05vdEVub3VnaEJv\nb2tpZXNFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNh\nbmRpZGF0ZXMuZ2V0KHJhbmQubmV4dEludChjYW5kaWRhdGVzLnNpemUoKSkp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgYXN5bmNocm9u\nb3VzbHkgcmVjb3ZlcnMgYSBnaXZlbiBsZWRnZXIgaWYgYW55IG9mIHRoZSBs\nZWRnZXIKICAgICAqIGVudHJpZXMgd2VyZSBzdG9yZWQgb24gdGhlIGZhaWxl\nZCBib29raWUuCiAgICAgKgogICAgICogQHBhcmFtIGJvb2tpZVNyYwogICAg\nICogICAgICAgICAgICBTb3VyY2UgYm9va2llIHRoYXQgaGFkIGEgZmFpbHVy\nZS4gV2Ugd2FudCB0byByZXBsaWNhdGUgdGhlCiAgICAgKiAgICAgICAgICAg\nIGxlZGdlciBmcmFnbWVudHMgdGhhdCB3ZXJlIHN0b3JlZCB0aGVyZS4KICAg\nICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAgICAgICAgTGVkZ2VyIGlkIHdl\nIHdhbnQgdG8gcmVjb3Zlci4KICAgICAqIEBwYXJhbSBsZWRnZXJJdGVyQ2IK\nICAgICAqICAgICAgICAgICAgSXRlcmF0aW9uQ2FsbGJhY2sgdG8gaW52b2tl\nIG9uY2Ugd2UndmUgcmVjb3ZlcmVkIHRoZSBjdXJyZW50CiAgICAgKiAgICAg\nICAgICAgIGxlZGdlci4KICAgICAqIEBwYXJhbSBhdmFpbGFibGVCb29raWVz\nCiAgICAgKiAgICAgICAgICAgIExpc3Qgb2YgQm9va2llIFNlcnZlcnMgdGhh\ndCBhcmUgYXZhaWxhYmxlIHRvIHVzZSBmb3IKICAgICAqICAgICAgICAgICAg\ncmVwbGljYXRpbmcgZGF0YSBvbiB0aGUgZmFpbGVkIGJvb2tpZS4gVGhpcyBj\nb3VsZCBjb250YWluIGEKICAgICAqICAgICAgICAgICAgc2luZ2xlIGJvb2tp\nZSBzZXJ2ZXIgaWYgdGhlIHVzZXIgZXhwbGljaXRseSBjaG9zZSBhIGJvb2tp\nZQogICAgICogICAgICAgICAgICBzZXJ2ZXIgdG8gcmVwbGljYXRlIGRhdGEg\ndG8uCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCByZWNvdmVyTGVkZ2VyKGZp\nbmFsIEluZXRTb2NrZXRBZGRyZXNzIGJvb2tpZVNyYywgZmluYWwgbG9uZyBs\nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBBc3lu\nY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBsZWRnZXJJdGVyQ2IsIGZpbmFsIExp\nc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGF2YWlsYWJsZUJvb2tpZXMpIHsKICAg\nICAgICBMT0cuZGVidWcoIlJlY292ZXJpbmcgbGVkZ2VyIDoge30iLCBsSWQp\nOwoKICAgICAgICBhc3luY09wZW5MZWRnZXJOb1JlY292ZXJ5KGxJZCwgbmV3\nIE9wZW5DYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIG9wZW5Db21wbGV0ZShpbnQgcmMsIGZpbmFs\nIExlZGdlckhhbmRsZSBsaCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAg\nICAgaWYgKHJjICE9IENvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAg\nICAgICAgICAgIExPRy5lcnJvcigiQksgZXJyb3Igb3BlbmluZyBsZWRnZXI6\nICIgKyBsSWQsIEJLRXhjZXB0aW9uLmNyZWF0ZShyYykpOwogICAgICAgICAg\nICAgICAgICAgIGxlZGdlckl0ZXJDYi5wcm9jZXNzUmVzdWx0KHJjLCBudWxs\nLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgTGVkZ2VyTWV0YWRhdGEgbG0g\nPSBsaC5nZXRMZWRnZXJNZXRhZGF0YSgpOwogICAgICAgICAgICAgICAgaWYg\nKCFsbS5pc0Nsb3NlZCgpICYmCiAgICAgICAgICAgICAgICAgICAgbG0uZ2V0\nRW5zZW1ibGVzKCkuc2l6ZSgpID4gMCkgewogICAgICAgICAgICAgICAgICAg\nIExvbmcgbGFzdEtleSA9IGxtLmdldEVuc2VtYmxlcygpLmxhc3RLZXkoKTsK\nICAgICAgICAgICAgICAgICAgICBBcnJheUxpc3Q8SW5ldFNvY2tldEFkZHJl\nc3M+IGxhc3RFbnNlbWJsZSA9IGxtLmdldEVuc2VtYmxlcygpLmdldChsYXN0\nS2V5KTsKICAgICAgICAgICAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgd3Jp\ndGUgaGFzIG5vdCByZW1vdmVkIGZhdWx0eSBib29raWUgZnJvbQogICAgICAg\nICAgICAgICAgICAgIC8vIGN1cnJlbnQgbGVkZ2VyIGVuc2VtYmxlLiB0byBh\ndm9pZCBkYXRhIGxvc3MgaXNzdWUgaW4KICAgICAgICAgICAgICAgICAgICAv\nLyB0aGUgY2FzZSBvZiBjb25jdXJyZW50IHVwZGF0ZXMgdG8gdGhlIGVuc2Vt\nYmxlIGNvbXBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgIC8vIHRoZSBy\nZWNvdmVyeSB0b29sIHNob3VsZCBmaXJzdCBjbG9zZSB0aGUgbGVkZ2VyCiAg\nICAgICAgICAgICAgICAgICAgaWYgKGxhc3RFbnNlbWJsZS5jb250YWlucyhi\nb29raWVTcmMpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsb3Nl\nIG9wZW5lZCBub24gcmVjb3ZlcnkgbGVkZ2VyIGhhbmRsZQogICAgICAgICAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbGguY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBMT0cud2FybigiRXJyb3IgY2xvc2luZyBub24gcmVjb3ZlcnkgbGVkZ2Vy\nIGhhbmRsZSBmb3IgbGVkZ2VyICIgKyBsSWQsIGllKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBhc3luY09w\nZW5MZWRnZXIobElkLCBuZXcgT3BlbkNhbGxiYWNrKCkgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVuQ29tcGxldGUoaW50IG5ld3Jj\nLCBmaW5hbCBMZWRnZXJIYW5kbGUgbmV3bGgsIE9iamVjdCBuZXdjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3cmMgIT0g\nQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIExPRy5lcnJvcigiQksgZXJyb3IgY2xvc2UgbGVkZ2Vy\nOiAiICsgbElkLCBCS0V4Y2VwdGlvbi5jcmVhdGUobmV3cmMpKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVkZ2VySXRlckNiLnBy\nb2Nlc3NSZXN1bHQobmV3cmMsIG51bGwsIG51bGwpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIGRvIHJlY292ZXJ5CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgcmVjb3ZlckxlZGdlcihib29raWVTcmMsIGxJZCwgbGVkZ2Vy\nSXRlckNiLCBhdmFpbGFibGVCb29raWVzKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgbnVsbCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\nLyoKICAgICAgICAgICAgICAgICAqIFRoaXMgTGlzdCBzdG9yZXMgdGhlIGxl\nZGdlciBmcmFnbWVudHMgdG8gcmVjb3ZlciBpbmRleGVkIGJ5CiAgICAgICAg\nICAgICAgICAgKiB0aGUgc3RhcnQgZW50cnkgSUQgZm9yIHRoZSByYW5nZS4g\nVGhlIGVuc2VtYmxlcyBUcmVlTWFwIGlzCiAgICAgICAgICAgICAgICAgKiBr\nZXllZCBvZmYgdGhpcy4KICAgICAgICAgICAgICAgICAqLwogICAgICAgICAg\nICAgICAgZmluYWwgTGlzdDxMb25nPiBsZWRnZXJGcmFnbWVudHNUb1JlY292\nZXIgPSBuZXcgTGlua2VkTGlzdDxMb25nPigpOwogICAgICAgICAgICAgICAg\nLyoKICAgICAgICAgICAgICAgICAqIFRoaXMgTWFwIHdpbGwgc3RvcmUgdGhl\nIHN0YXJ0IGFuZCBlbmQgZW50cnkgSUQgdmFsdWVzIGZvcgogICAgICAgICAg\nICAgICAgICogZWFjaCBvZiB0aGUgbGVkZ2VyIGZyYWdtZW50IHJhbmdlcy4g\nVGhlIG9ubHkgZXhjZXB0aW9uIGlzIHRoZQogICAgICAgICAgICAgICAgICog\nY3VycmVudCBhY3RpdmUgZnJhZ21lbnQgc2luY2UgaXQgaGFzIG5vIGVuZCB5\nZXQuIEluIHRoZSBldmVudAogICAgICAgICAgICAgICAgICogb2YgYSBib29r\naWUgZmFpbHVyZSwgYSBuZXcgZW5zZW1ibGUgaXMgY3JlYXRlZCBzbyB0aGUg\nY3VycmVudAogICAgICAgICAgICAgICAgICogZW5zZW1ibGUgc2hvdWxkIG5v\ndCBjb250YWluIHRoZSBkZWFkIGJvb2tpZSB3ZSBhcmUgdHJ5aW5nIHRvCiAg\nICAgICAgICAgICAgICAgKiByZWNvdmVyLgogICAgICAgICAgICAgICAgICov\nCiAgICAgICAgICAgICAgICBNYXA8TG9uZywgTG9uZz4gbGVkZ2VyRnJhZ21l\nbnRzUmFuZ2UgPSBuZXcgSGFzaE1hcDxMb25nLCBMb25nPigpOwogICAgICAg\nICAgICAgICAgTG9uZyBjdXJFbnRyeUlkID0gbnVsbDsKICAgICAgICAgICAg\nICAgIGZvciAoTWFwLkVudHJ5PExvbmcsIEFycmF5TGlzdDxJbmV0U29ja2V0\nQWRkcmVzcz4+IGVudHJ5IDogbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKS5nZXRF\nbnNlbWJsZXMoKQogICAgICAgICAgICAgICAgICAgICAgICAgLmVudHJ5U2V0\nKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY3VyRW50cnlJZCAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgICAgICBsZWRnZXJGcmFnbWVudHNS\nYW5nZS5wdXQoY3VyRW50cnlJZCwgZW50cnkuZ2V0S2V5KCkgLSAxKTsKICAg\nICAgICAgICAgICAgICAgICBjdXJFbnRyeUlkID0gZW50cnkuZ2V0S2V5KCk7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKGVudHJ5LmdldFZhbHVlKCkuY29u\ndGFpbnMoYm9va2llU3JjKSkgewogICAgICAgICAgICAgICAgICAgICAgICAv\nKgogICAgICAgICAgICAgICAgICAgICAgICAgKiBDdXJyZW50IGxlZGdlciBm\ncmFnbWVudCBoYXMgZW50cmllcyBzdG9yZWQgb24gdGhlCiAgICAgICAgICAg\nICAgICAgICAgICAgICAqIGRlYWQgYm9va2llIHNvIHdlJ2xsIG5lZWQgdG8g\ncmVjb3ZlciB0aGVtLgogICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAg\nICAgICAgICAgICAgICAgICAgICAgbGVkZ2VyRnJhZ21lbnRzVG9SZWNvdmVy\nLmFkZChlbnRyeS5nZXRLZXkoKSk7CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gYWRkIGxhc3Qg\nZW5zZW1ibGUgb3RoZXJ3aXNlIGlmIHRoZSBmYWlsZWQgYm9va2llIGV4aXN0\nZWQgaW4KICAgICAgICAgICAgICAgIC8vIHRoZSBsYXN0IGVuc2VtYmxlIG9m\nIGEgY2xvc2VkIGxlZGdlci4gdGhlIGVudHJpZXMgYmVsb25nZWQgdG8KICAg\nICAgICAgICAgICAgIC8vIGxhc3QgZW5zZW1ibGUgd291bGQgbm90IGJlIHJl\ncGxpY2F0ZWQuCiAgICAgICAgICAgICAgICBpZiAoY3VyRW50cnlJZCAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgbGVkZ2VyRnJhZ21lbnRzUmFu\nZ2UucHV0KGN1ckVudHJ5SWQsIGxoLmdldExhc3RBZGRDb25maXJtZWQoKSk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvKgogICAgICAg\nICAgICAgICAgICogU2VlIGlmIHRoaXMgY3VycmVudCBsZWRnZXIgY29udGFp\nbnMgYW55IGxlZGdlciBmcmFnbWVudCB0aGF0CiAgICAgICAgICAgICAgICAg\nKiBuZWVkcyB0byBiZSByZS1yZXBsaWNhdGVkLiBJZiBub3QsIHRoZW4ganVz\ndCBpbnZva2UgdGhlCiAgICAgICAgICAgICAgICAgKiBtdWx0aUNhbGxiYWNr\nIGFuZCByZXR1cm4uCiAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAg\nICAgIGlmIChsZWRnZXJGcmFnbWVudHNUb1JlY292ZXIuc2l6ZSgpID09IDAp\nIHsKICAgICAgICAgICAgICAgICAgICBsZWRnZXJJdGVyQ2IucHJvY2Vzc1Jl\nc3VsdChCS0V4Y2VwdGlvbi5Db2RlLk9LLCBudWxsLCBudWxsKTsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAqIE11bHRpY2FsbGJh\nY2sgZm9yIGxlZGdlci4gT25jZSBhbGwgZnJhZ21lbnRzIGZvciB0aGUgbGVk\nZ2VyIGhhdmUgYmVlbiByZWNvdmVyZWQKICAgICAgICAgICAgICAgICAqIHRy\naWdnZXIgdGhlIGxlZGdlckl0ZXJDYgogICAgICAgICAgICAgICAgICovCiAg\nICAgICAgICAgICAgICBNdWx0aUNhbGxiYWNrIGxlZGdlckZyYWdtZW50c01j\nYgogICAgICAgICAgICAgICAgICAgID0gbmV3IE11bHRpQ2FsbGJhY2sobGVk\nZ2VyRnJhZ21lbnRzVG9SZWNvdmVyLnNpemUoKSwgbGVkZ2VySXRlckNiLCBu\ndWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nQktFeGNlcHRpb24uQ29kZS5PSywgQktFeGNlcHRpb24uQ29kZS5MZWRnZXJS\nZWNvdmVyeUV4Y2VwdGlvbik7CiAgICAgICAgICAgICAgICAvKgogICAgICAg\nICAgICAgICAgICogTm93IHJlY292ZXIgYWxsIG9mIHRoZSBuZWNlc3Nhcnkg\nbGVkZ2VyIGZyYWdtZW50cwogICAgICAgICAgICAgICAgICogYXN5bmNocm9u\nb3VzbHkgdXNpbmcgYSBNdWx0aUNhbGxiYWNrIGZvciBldmVyeSBmcmFnbWVu\ndC4KICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgZm9yIChm\naW5hbCBMb25nIHN0YXJ0RW50cnlJZCA6IGxlZGdlckZyYWdtZW50c1RvUmVj\nb3ZlcikgewogICAgICAgICAgICAgICAgICAgIExvbmcgZW5kRW50cnlJZCA9\nIGxlZGdlckZyYWdtZW50c1JhbmdlLmdldChzdGFydEVudHJ5SWQpOwogICAg\nICAgICAgICAgICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIG5ld0Jvb2tpZSA9\nIG51bGw7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgbmV3Qm9va2llID0gZ2V0TmV3Qm9va2llKGxoLmdldExl\nZGdlck1ldGFkYXRhKCkuZ2V0RW5zZW1ibGVzKCkuZ2V0KHN0YXJ0RW50cnlJ\nZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBhdmFpbGFibGVCb29raWVzKTsKICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5CS05vdEVub3VnaEJvb2tpZXNFeGNl\ncHRpb24gYmtlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxlZGdlckZy\nYWdtZW50c01jYi5wcm9jZXNzUmVzdWx0KEJLRXhjZXB0aW9uLkNvZGUuTm90\nRW5vdWdoQm9va2llc0V4Y2VwdGlvbiwgCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsIG51\nbGwpOwogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg\nICAgICAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiUmVwbGljYXRpbmcgZnJh\nZ21lbnQgZnJvbSBbIiArIHN0YXJ0RW50cnlJZCAKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiwiICsgZW5kRW50cnlJZCArICJdIG9m\nIGxlZGdlciAiICsgbGguZ2V0SWQoKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiIHRvICIgKyBuZXdCb29raWUpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgICAgICBMZWRnZXJGcmFnbWVudFJlcGxpY2F0b3IuU2lu\nZ2xlRnJhZ21lbnRDYWxsYmFjayBjYiA9IG5ldyBMZWRnZXJGcmFnbWVudFJl\ncGxpY2F0b3IuU2luZ2xlRnJhZ21lbnRDYWxsYmFjaygKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGxlZGdlckZyYWdtZW50c01jYiwgbGgs\nIHN0YXJ0RW50cnlJZCwgYm9va2llU3JjLCBuZXdCb29raWUpOwogICAgICAg\nICAgICAgICAgICAgICAgICBBcnJheUxpc3Q8SW5ldFNvY2tldEFkZHJlc3M+\nIGN1cnJlbnRFbnNlbWJsZSA9ICBsaC5nZXRMZWRnZXJNZXRhZGF0YSgpLmdl\ndEVuc2VtYmxlKHN0YXJ0RW50cnlJZCk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGludCBib29raWVJbmRleCA9IC0xOwogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAobnVsbCAhPSBjdXJyZW50RW5zZW1ibGUpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY3VycmVu\ndEVuc2VtYmxlLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKGN1cnJlbnRFbnNlbWJsZS5nZXQoaSkuZXF1YWxz\nKGJvb2tpZVNyYykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgYm9va2llSW5kZXggPSBpOwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nTGVkZ2VyRnJhZ21lbnQgbGVkZ2VyRnJhZ21lbnQgPSBuZXcgTGVkZ2VyRnJh\nZ21lbnQobGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rh\ncnRFbnRyeUlkLCBlbmRFbnRyeUlkLCBib29raWVJbmRleCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGFzeW5jUmVjb3ZlckxlZGdlckZyYWdtZW50KGxo\nLCBsZWRnZXJGcmFnbWVudCwgY2IsIG5ld0Jvb2tpZSk7CiAgICAgICAgICAg\nICAgICAgICAgfSBjYXRjaChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCku\naW50ZXJydXB0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSwgbnVsbCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGlzIG1ldGhvZCBhc3luY2hyb25vdXNseSByZWNvdmVycyBh\nIGxlZGdlciBmcmFnbWVudCB3aGljaCBpcyBhCiAgICAgKiBjb250aWd1b3Vz\nIHBvcnRpb24gb2YgYSBsZWRnZXIgdGhhdCB3YXMgc3RvcmVkIGluIGFuIGVu\nc2VtYmxlIHRoYXQKICAgICAqIGluY2x1ZGVkIHRoZSBmYWlsZWQgYm9va2ll\nLgogICAgICogCiAgICAgKiBAcGFyYW0gbGgKICAgICAqICAgICAgICAgICAg\nLSBMZWRnZXJIYW5kbGUgZm9yIHRoZSBsZWRnZXIKICAgICAqIEBwYXJhbSBs\nZgogICAgICogICAgICAgICAgICAtIExlZGdlckZyYWdtZW50IHRvIHJlcGxp\nY2F0ZQogICAgICogQHBhcmFtIGxlZGdlckZyYWdtZW50TWNiCiAgICAgKiAg\nICAgICAgICAgIC0gTXVsdGlDYWxsYmFjayB0byBpbnZva2Ugb25jZSB3ZSd2\nZSByZWNvdmVyZWQgdGhlIGN1cnJlbnQKICAgICAqICAgICAgICAgICAgbGVk\nZ2VyIGZyYWdtZW50LgogICAgICogQHBhcmFtIG5ld0Jvb2tpZQogICAgICog\nICAgICAgICAgICAtIE5ldyBib29raWUgd2Ugd2FudCB0byB1c2UgdG8gcmVj\nb3ZlciBhbmQgcmVwbGljYXRlIHRoZQogICAgICogICAgICAgICAgICBsZWRn\nZXIgZW50cmllcyB0aGF0IHdlcmUgc3RvcmVkIG9uIHRoZSBmYWlsZWQgYm9v\na2llLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXN5bmNSZWNvdmVyTGVk\nZ2VyRnJhZ21lbnQoZmluYWwgTGVkZ2VySGFuZGxlIGxoLAogICAgICAgICAg\nICBmaW5hbCBMZWRnZXJGcmFnbWVudCBsZWRnZXJGcmFnbWVudCwKICAgICAg\nICAgICAgZmluYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sgbGVkZ2Vy\nRnJhZ21lbnRNY2IsCiAgICAgICAgICAgIGZpbmFsIEluZXRTb2NrZXRBZGRy\nZXNzIG5ld0Jvb2tpZSkgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsK\nICAgICAgICBsZnIucmVwbGljYXRlKGxoLCBsZWRnZXJGcmFnbWVudCwgbGVk\nZ2VyRnJhZ21lbnRNY2IsIG5ld0Jvb2tpZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXBsaWNhdGUgdGhlIExlZGdlciBmcmFnbWVudCB0byB0YXJnZXQg\nQm9va2llIHBhc3NlZC4KICAgICAqIAogICAgICogQHBhcmFtIGxoCiAgICAg\nKiAgICAgICAgICAgIC0gbGVkZ2VySGFuZGxlCiAgICAgKiBAcGFyYW0gbGVk\nZ2VyRnJhZ21lbnQKICAgICAqICAgICAgICAgICAgLSBMZWRnZXJGcmFnbWVu\ndCB0byByZXBsaWNhdGUKICAgICAqIEBwYXJhbSB0YXJnZXRCb29raWVBZGRy\nZXNzCiAgICAgKiAgICAgICAgICAgIC0gdGFyZ2V0IEJvb2tpZSwgdG8gd2hl\ncmUgZW50cmllcyBzaG91bGQgYmUgcmVwbGljYXRlZC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgcmVwbGljYXRlTGVkZ2VyRnJhZ21lbnQoTGVkZ2VySGFu\nZGxlIGxoLAogICAgICAgICAgICBmaW5hbCBMZWRnZXJGcmFnbWVudCBsZWRn\nZXJGcmFnbWVudCwKICAgICAgICAgICAgZmluYWwgSW5ldFNvY2tldEFkZHJl\nc3MgdGFyZ2V0Qm9va2llQWRkcmVzcykKICAgICAgICAgICAgdGhyb3dzIElu\ndGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgU3lu\nY0NvdW50ZXIgc3luY0NvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAg\nICAgICBSZXN1bHRDYWxsQmFjayByZXN1bHRDYWxsQmFjayA9IG5ldyBSZXN1\nbHRDYWxsQmFjayhzeW5jQ291bnRlcik7CiAgICAgICAgU2luZ2xlRnJhZ21l\nbnRDYWxsYmFjayBjYiA9IG5ldyBTaW5nbGVGcmFnbWVudENhbGxiYWNrKHJl\nc3VsdENhbGxCYWNrLAogICAgICAgICAgICAgICAgbGgsIGxlZGdlckZyYWdt\nZW50LmdldEZpcnN0RW50cnlJZCgpLCBsZWRnZXJGcmFnbWVudAogICAgICAg\nICAgICAgICAgICAgICAgICAuZ2V0QWRkcmVzcygpLCB0YXJnZXRCb29raWVB\nZGRyZXNzKTsKICAgICAgICBzeW5jQ291bnRlci5pbmMoKTsKICAgICAgICBh\nc3luY1JlY292ZXJMZWRnZXJGcmFnbWVudChsaCwgbGVkZ2VyRnJhZ21lbnQs\nIGNiLCB0YXJnZXRCb29raWVBZGRyZXNzKTsKICAgICAgICBzeW5jQ291bnRl\nci5ibG9jaygwKTsKICAgICAgICBpZiAoc3luY0NvdW50ZXIuZ2V0cmMoKSAh\nPSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIHRocm93IEJL\nRXhjZXB0aW9uLmNyZWF0ZShzeW5jQ291bnRlci5nZXRyYygpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqIFRoaXMgaXMgdGhlIGNsYXNzIGZvciBnZXR0\naW5nIHRoZSByZXBsaWNhdGlvbiByZXN1bHQgKi8KICAgIHN0YXRpYyBjbGFz\ncyBSZXN1bHRDYWxsQmFjayBpbXBsZW1lbnRzIEFzeW5jQ2FsbGJhY2suVm9p\nZENhbGxiYWNrIHsKICAgICAgICBwcml2YXRlIFN5bmNDb3VudGVyIHN5bmM7\nCgogICAgICAgIHB1YmxpYyBSZXN1bHRDYWxsQmFjayhTeW5jQ291bnRlciBz\neW5jKSB7CiAgICAgICAgICAgIHRoaXMuc3luYyA9IHN5bmM7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBwcm9j\nZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHMsIE9iamVjdCBvYmopIHsKICAg\nICAgICAgICAgc3luYy5zZXRyYyhyYyk7CiAgICAgICAgICAgIHN5bmMuZGVj\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRm9ybWF0IHRo\nZSBCb29rS2VlcGVyIG1ldGFkYXRhIGluIHpvb2tlZXBlcgogICAgICogCiAg\nICAgKiBAcGFyYW0gaXNJbnRlcmFjdGl2ZQogICAgICogICAgICAgICAgICBX\naGV0aGVyIGZvcm1hdCBzaG91bGQgYXNrIHByb21wdCBmb3IgY29uZmlybWF0\naW9uIGlmIG9sZCBkYXRhCiAgICAgKiAgICAgICAgICAgIGV4aXN0cyBvciBu\nb3QuCiAgICAgKiBAcGFyYW0gZm9yY2UKICAgICAqICAgICAgICAgICAgSWYg\nbm9uIGludGVyYWN0aXZlIGFuZCBmb3JjZSBpcyB0cnVlLCB0aGVuIG9sZCBk\nYXRhIHdpbGwgYmUKICAgICAqICAgICAgICAgICAgcmVtb3ZlZCB3aXRob3V0\nIHByb21wdC4KICAgICAqIEByZXR1cm4gUmV0dXJucyB0cnVlIGlmIGZvcm1h\ndCBzdWNjZWVkcyBlbHNlIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGJvb2xlYW4gZm9ybWF0KENsaWVudENvbmZpZ3VyYXRpb24gY29uZiwK\nICAgICAgICAgICAgYm9vbGVhbiBpc0ludGVyYWN0aXZlLCBib29sZWFuIGZv\ncmNlKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBab29LZWVwZXJXYXRj\naGVyQmFzZSB3ID0gbmV3IFpvb0tlZXBlcldhdGNoZXJCYXNlKGNvbmYuZ2V0\nWmtUaW1lb3V0KCkpOwogICAgICAgIFpvb0tlZXBlciB6a2MgPSBaa1V0aWxz\nLmNyZWF0ZUNvbm5lY3RlZFpvb2tlZXBlckNsaWVudCgKICAgICAgICAgICAg\nICAgIGNvbmYuZ2V0WmtTZXJ2ZXJzKCksIHcpOwogICAgICAgIEJvb2tLZWVw\nZXIgYmtjID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBib29s\nZWFuIGxlZGdlclJvb3RFeGlzdHMgPSBudWxsICE9IHprYy5leGlzdHMoCiAg\nICAgICAgICAgICAgICAgICAgY29uZi5nZXRaa0xlZGdlcnNSb290UGF0aCgp\nLCBmYWxzZSk7CiAgICAgICAgICAgIGJvb2xlYW4gYXZhaWxhYmxlTm9kZUV4\naXN0cyA9IG51bGwgIT0gemtjLmV4aXN0cygKICAgICAgICAgICAgICAgICAg\nICBjb25mLmdldFprQXZhaWxhYmxlQm9va2llc1BhdGgoKSwgZmFsc2UpOwoK\nICAgICAgICAgICAgLy8gQ3JlYXRlIGxlZGdlcnMgcm9vdCBub2RlIGlmIG5v\ndCBleGlzdHMKICAgICAgICAgICAgaWYgKCFsZWRnZXJSb290RXhpc3RzKSB7\nCiAgICAgICAgICAgICAgICB6a2MuY3JlYXRlKGNvbmYuZ2V0WmtMZWRnZXJz\nUm9vdFBhdGgoKSwgIiIuZ2V0Qnl0ZXMoKSwKICAgICAgICAgICAgICAgICAg\nICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNU\nRU5UKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBjcmVhdGUgYXZh\naWxhYmxlIGJvb2tpZXMgbm9kZSBpZiBub3QgZXhpc3RzCiAgICAgICAgICAg\nIGlmICghYXZhaWxhYmxlTm9kZUV4aXN0cykgewogICAgICAgICAgICAgICAg\nemtjLmNyZWF0ZShjb25mLmdldFprQXZhaWxhYmxlQm9va2llc1BhdGgoKSwg\nIiIuZ2V0Qnl0ZXMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgSWRzLk9Q\nRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgLy8gSWYgb2xkIGRhdGEgd2FzIHRoZXJl\nIHRoZW4gY29uZmlybSB3aXRoIGFkbWluLgogICAgICAgICAgICBpZiAobGVk\nZ2VyUm9vdEV4aXN0cykgewogICAgICAgICAgICAgICAgYm9vbGVhbiBjb25m\naXJtID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAoIWlzSW50ZXJhY3Rp\ndmUpIHsKICAgICAgICAgICAgICAgICAgICAvLyBJZiBub24gaW50ZXJhY3Rp\ndmUgYW5kIGZvcmNlIGlzIHNldCwgdGhlbiBkZWxldGUgb2xkCiAgICAgICAg\nICAgICAgICAgICAgLy8gZGF0YS4KICAgICAgICAgICAgICAgICAgICBpZiAo\nZm9yY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybSA9IHRy\ndWU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgY29uZmlybSA9IGZhbHNlOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgLy8gQ29uZmlybSB3aXRoIHRoZSBhZG1pbi4KICAgICAgICAgICAg\nICAgICAgICBjb25maXJtID0gSU9VdGlscwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLmNvbmZpcm1Qcm9tcHQoIkFyZSB5b3Ugc3VyZSB0byBmb3Jt\nYXQgYm9va2tlZXBlciBtZXRhZGF0YSA/Iik7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBpZiAoIWNvbmZpcm0pIHsKICAgICAgICAgICAg\nICAgICAgICBMT0cuZXJyb3IoIkJvb2tLZWVwZXIgbWV0YWRhdGEgRm9ybWF0\nIGFib3J0ZWQhISIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBia2MgPSBuZXcgQm9va0tlZXBlcihjb25mLCB6a2MpOwogICAgICAgICAg\nICAvLyBGb3JtYXQgYWxsIGxlZGdlciBtZXRhZGF0YSBsYXlvdXQKICAgICAg\nICAgICAgYmtjLmxlZGdlck1hbmFnZXJGYWN0b3J5LmZvcm1hdChjb25mLCB6\na2MpOwoKICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGNvb2tpZXMKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFpLVXRpbC5kZWxldGVSZWN1\ncnNpdmUoemtjLCBjb25mLmdldFprTGVkZ2Vyc1Jvb3RQYXRoKCkKICAgICAg\nICAgICAgICAgICAgICAgICAgKyAiL2Nvb2tpZXMiKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uLk5vTm9kZUV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICBMT0cuZGVidWcoImNvb2tpZXMgbm9kZSBub3Qg\nZXhpc3RzIGluIHpvb2tlZXBlciB0byBkZWxldGUiKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIElOU1RBTkNFSUQKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHprYy5kZWxldGUoY29uZi5n\nZXRaa0xlZGdlcnNSb290UGF0aCgpICsgIi8iCiAgICAgICAgICAgICAgICAg\nICAgICAgICsgQm9va0tlZXBlckNvbnN0YW50cy5JTlNUQU5DRUlELCAtMSk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbi5Ob05vZGVF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJJTlNU\nQU5DRUlEIG5vdCBleGlzdHMgaW4gem9va2VlcGVyIHRvIGRlbGV0ZSIpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBjcmVhdGUgSU5TVEFOQ0VJ\nRAogICAgICAgICAgICBTdHJpbmcgaW5zdGFuY2VJZCA9IFVVSUQucmFuZG9t\nVVVJRCgpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIHprYy5jcmVhdGUoY29u\nZi5nZXRaa0xlZGdlcnNSb290UGF0aCgpICsgIi8iCiAgICAgICAgICAgICAg\nICAgICAgKyBCb29rS2VlcGVyQ29uc3RhbnRzLklOU1RBTkNFSUQsIGluc3Rh\nbmNlSWQuZ2V0Qnl0ZXMoKSwKICAgICAgICAgICAgICAgICAgICBJZHMuT1BF\nTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwoKICAgICAg\nICAgICAgTE9HLmluZm8oIlN1Y2Nlc3NmdWxseSBmb3JtYXR0ZWQgQm9va0tl\nZXBlciBtZXRhZGF0YSIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGlmIChudWxsICE9IGJrYykgewogICAgICAgICAgICAgICAgYmtjLmNs\nb3NlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG51bGwgIT0g\nemtjKSB7CiAgICAgICAgICAgICAgICB6a2MuY2xvc2UoKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQo=\n","encoding":"base64"}

