{"sha":"293c0e5a32ae5127ebbe74753a970cc62a91c628","node_id":"MDQ6QmxvYjE1NzU5NTY6MjkzYzBlNWEzMmFlNTEyN2ViYmU3NDc1M2E5NzBjYzYyYTkxYzYyOA==","size":6282,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/293c0e5a32ae5127ebbe74753a970cc62a91c628","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNv\nZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq\nIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmltcG9ydCBq\nYXZhLnV0aWwuRW51bWVyYXRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLkFkZENhbGxiYWNrOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNr\nLkNsb3NlQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkFzeW5jQ2FsbGJhY2suUmVhZENhbGxiYWNrOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLlJlYWRM\nYXN0Q29uZmlybWVkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uLkJLRGlnZXN0TWF0Y2hFeGNlcHRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nckhhbmRsZS5Ob29wQ2xvc2VDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jbGllbnQuRGlnZXN0TWFuYWdlci5SZWNvdmVyeURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2llUHJv\ndG9jb2w7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWNDYWxsYmFjazsKCmlt\ncG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\nckZhY3Rvcnk7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuYnVmZmVyLkNoYW5u\nZWxCdWZmZXI7CgovKioKICogVGhpcyBjbGFzcyBlbmNhcHN1bGF0ZWQgdGhl\nIGxlZGdlciByZWNvdmVyeSBvcGVyYXRpb24uIEl0IGZpcnN0IGRvZXMgYSBy\nZWFkCiAqIHdpdGggZW50cnktaWQgb2YgLTEgKEJvb2tpZVByb3RvY29sLkxB\nU1RfQUREX0NPTkZJUk1FRCkgdG8gYWxsIGJvb2tpZXMuIFRoZW4KICogc3Rh\ncnRpbmcgZnJvbSB0aGUgbGFzdCBjb25maXJtZWQgZW50cnkgKGZyb20gaGlu\ndHMgaW4gdGhlIGxlZGdlciBlbnRyaWVzKSwKICogaXQgcmVhZHMgZm9yd2Fy\nZCB1bnRpbCBpdCBpcyBub3QgYWJsZSB0byBmaW5kIGEgcGFydGljdWxhciBl\nbnRyeS4gSXQgY2xvc2VzCiAqIHRoZSBsZWRnZXIgYXQgdGhhdCBlbnRyeS4K\nICoKICovCmNsYXNzIExlZGdlclJlY292ZXJ5T3AgaW1wbGVtZW50cyBSZWFk\nQ2FsbGJhY2ssIEFkZENhbGxiYWNrIHsKICAgIHN0YXRpYyBmaW5hbCBMb2dn\nZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTGVkZ2VyUmVjb3Zl\ncnlPcC5jbGFzcyk7CiAgICBMZWRnZXJIYW5kbGUgbGg7CiAgICBpbnQgbnVt\nUmVzcG9uc2VzUGVuZGluZzsKICAgIGJvb2xlYW4gcHJvY2VlZGluZ1dpdGhS\nZWNvdmVyeSA9IGZhbHNlOwogICAgbG9uZyBtYXhBZGRQdXNoZWQgPSBMZWRn\nZXJIYW5kbGUuSU5WQUxJRF9FTlRSWV9JRDsKICAgIGxvbmcgbWF4QWRkQ29u\nZmlybWVkID0gTGVkZ2VySGFuZGxlLklOVkFMSURfRU5UUllfSUQ7CiAgICBs\nb25nIG1heExlbmd0aCA9IDA7CgogICAgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+\nIGNiOwoKICAgIHB1YmxpYyBMZWRnZXJSZWNvdmVyeU9wKExlZGdlckhhbmRs\nZSBsaCwgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+IGNiKSB7CiAgICAgICAgdGhp\ncy5jYiA9IGNiOwogICAgICAgIHRoaXMubGggPSBsaDsKICAgICAgICBudW1S\nZXNwb25zZXNQZW5kaW5nID0gbGgubWV0YWRhdGEuZ2V0RW5zZW1ibGVTaXpl\nKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5pdGlhdGUoKSB7CiAgICAg\nICAgUmVhZExhc3RDb25maXJtZWRPcCBybGNvcCA9IG5ldyBSZWFkTGFzdENv\nbmZpcm1lZE9wKGxoLAogICAgICAgICAgICAgICAgbmV3IFJlYWRMYXN0Q29u\nZmlybWVkT3AuTGFzdENvbmZpcm1lZERhdGFDYWxsYmFjaygpIHsKICAgICAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHJlYWRMYXN0Q29uZmlybWVkRGF0YUNv\nbXBsZXRlKGludCByYywgUmVjb3ZlcnlEYXRhIGRhdGEpIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29kZS5PSykgewog\nICAgICAgICAgICAgICAgICAgICAgICBsaC5sYXN0QWRkUHVzaGVkID0gbGgu\nbGFzdEFkZENvbmZpcm1lZCA9IGRhdGEubGFzdEFkZENvbmZpcm1lZDsKICAg\nICAgICAgICAgICAgICAgICAgICAgbGgubGVuZ3RoID0gZGF0YS5sZW5ndGg7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGRvUmVjb3ZlcnlSZWFkKCk7CiAg\nICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyYyA9PSBCS0V4Y2VwdGlv\nbi5Db2RlLlVuYXV0aG9yaXplZEFjY2Vzc0V4Y2VwdGlvbikgewogICAgICAg\nICAgICAgICAgICAgICAgICBjYi5vcGVyYXRpb25Db21wbGV0ZShyYywgbnVs\nbCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24u\nQ29kZS5SZWFkRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAg\nICAgICAgLyoqCiAgICAgICAgICogRW5hYmxlIGZlbmNpbmcgb24gdGhpcyBv\ncC4gV2hlbiB0aGUgcmVhZCByZXF1ZXN0IHJlYWNoZXMgdGhlIGJvb2tpZXMK\nICAgICAgICAgKiBzZXJ2ZXIgaXQgd2lsbCBmZW5jZSBvZmYgdGhlIGxlZGdl\nciwgc3RvcHBpbmcgYW55IHN1YnNlcXVlbnQgb3BlcmF0aW9uCiAgICAgICAg\nICogZnJvbSB3cml0aW5nIHRvIGl0LgogICAgICAgICAqLwogICAgICAgIHJs\nY29wLmluaXRpYXRlV2l0aEZlbmNpbmcoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRyeSB0byByZWFkIHBhc3QgdGhlIGxhc3QgY29uZmlybWVkLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgZG9SZWNvdmVyeVJlYWQoKSB7CiAgICAg\nICAgbGgubGFzdEFkZENvbmZpcm1lZCsrOwogICAgICAgIGxoLmFzeW5jUmVh\nZEVudHJpZXMobGgubGFzdEFkZENvbmZpcm1lZCwgbGgubGFzdEFkZENvbmZp\ncm1lZCwgdGhpcywgbnVsbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCByZWFkQ29tcGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUg\nbGgsIEVudW1lcmF0aW9uPExlZGdlckVudHJ5PiBzZXEsIE9iamVjdCBjdHgp\nIHsKICAgICAgICAvLyBnZXQgYmFjayB0byBwcmV2IHZhbHVlCiAgICAgICAg\nbGgubGFzdEFkZENvbmZpcm1lZC0tOwogICAgICAgIGlmIChyYyA9PSBCS0V4\nY2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIExlZGdlckVudHJ5IGVu\ndHJ5ID0gc2VxLm5leHRFbGVtZW50KCk7CiAgICAgICAgICAgIGJ5dGVbXSBk\nYXRhID0gZW50cnkuZ2V0RW50cnkoKTsKCiAgICAgICAgICAgIC8qCiAgICAg\nICAgICAgICAqIFdlIHdpbGwgYWRkIHRoaXMgZW50cnkgYWdhaW4gdG8gbWFr\nZSBzdXJlIGl0IGlzIHdyaXR0ZW4gdG8gZW5vdWdoCiAgICAgICAgICAgICAq\nIHJlcGxpY2FzLiBXZSBzdWJ0cmFjdCB0aGUgbGVuZ3RoIG9mIHRoZSBkYXRh\nIGl0c2VsZiwgc2luY2UgaXQgd2lsbAogICAgICAgICAgICAgKiBiZSBhZGRl\nZCBhZ2FpbiB3aGVuIHByb2Nlc3NpbmcgdGhlIGNhbGwgdG8gYWRkIGl0Lgog\nICAgICAgICAgICAgKi8KICAgICAgICAgICAgc3luY2hyb25pemVkIChsaCkg\newogICAgICAgICAgICAgICAgbGgubGVuZ3RoID0gZW50cnkuZ2V0TGVuZ3Ro\nKCkgLSAobG9uZykgZGF0YS5sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgbGguYXN5bmNSZWNvdmVyeUFkZEVudHJ5KGRhdGEsIDAsIGRhdGEu\nbGVuZ3RoLCB0aGlzLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KCiAgICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUuTm9T\ndWNoRW50cnlFeGNlcHRpb24gfHwgcmMgPT0gQktFeGNlcHRpb24uQ29kZS5O\nb1N1Y2hMZWRnZXJFeGlzdHNFeGNlcHRpb24pIHsKICAgICAgICAgICAgbGgu\nYXN5bmNDbG9zZUludGVybmFsKG5ldyBDbG9zZUNhbGxiYWNrKCkgewogICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMg\ndm9pZCBjbG9zZUNvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBP\nYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IEtl\nZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgTE9HLndhcm4oIkNsb3NlIGZhaWxlZDogIiArIEJL\nRXhjZXB0aW9uLmdldE1lc3NhZ2UocmMpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5a\nS0V4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxl\ndGUoQktFeGNlcHRpb24uQ29kZS5PSywgbnVsbCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIExPRy5kZWJ1ZygiQWZ0ZXIgY2xvc2luZyBsZW5ndGggaXM6\nIHt9IiwgbGguZ2V0TGVuZ3RoKCkpOwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIG51bGwsIEJL\nRXhjZXB0aW9uLkNvZGUuTGVkZ2VyQ2xvc2VkRXhjZXB0aW9uKTsKICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gb3RoZXJ3aXNl\nLCBzb21lIG90aGVyIGVycm9yLCB3ZSBjYW4ndCBoYW5kbGUKICAgICAgICBM\nT0cuZXJyb3IoIkZhaWx1cmUgIiArIEJLRXhjZXB0aW9uLmdldE1lc3NhZ2Uo\ncmMpICsgIiB3aGlsZSByZWFkaW5nIGVudHJ5OiAiICsgKGxoLmxhc3RBZGRD\nb25maXJtZWQgKyAxKQogICAgICAgICAgICAgICAgICArICIgbGVkZ2VyOiAi\nICsgbGgubGVkZ2VySWQgKyAiIHdoaWxlIHJlY292ZXJpbmcgbGVkZ2VyIik7\nCiAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUocmMsIG51bGwpOwogICAg\nICAgIHJldHVybjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIGFkZENvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBsb25n\nIGVudHJ5SWQsIE9iamVjdCBjdHgpIHsKICAgICAgICBpZiAocmMgIT0gQktF\neGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAgICAvLyBHaXZlIHVwLCB3\nZSBjYW4ndCByZWNvdmVyIGZyb20gdGhpcyBlcnJvcgoKICAgICAgICAgICAg\nTE9HLmVycm9yKCJGYWlsdXJlICIgKyBCS0V4Y2VwdGlvbi5nZXRNZXNzYWdl\nKHJjKSArICIgd2hpbGUgd3JpdGluZyBlbnRyeTogIiArIChsaC5sYXN0QWRk\nQ29uZmlybWVkICsgMSkKICAgICAgICAgICAgICAgICAgICAgICsgIiBsZWRn\nZXI6ICIgKyBsaC5sZWRnZXJJZCArICIgd2hpbGUgcmVjb3ZlcmluZyBsZWRn\nZXIiKTsKICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUocmMsIG51\nbGwpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBk\nb1JlY292ZXJ5UmVhZCgpOwoKICAgIH0KCn0K\n","encoding":"base64"}

