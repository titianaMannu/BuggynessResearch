{"sha":"a07755635d4c2ca96856e611dcb503c75790a9f3","node_id":"MDQ6QmxvYjE1NzU5NTY6YTA3NzU1NjM1ZDRjMmNhOTY4NTZlNjExZGNiNTAzYzc1NzkwYTlmMw==","size":5499,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a07755635d4c2ca96856e611dcb503c75790a9f3","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb24uQktEaWdl\nc3RNYXRjaEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuRGlnZXN0TWFuYWdlci5SZWNvdmVyeURhdGE7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFs\nQ2FsbGJhY2tzLlJlYWRFbnRyeUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVByb3RvY29sOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmJ1ZmZlci5DaGFubmVsQnVmZmVy\nOwoKLyoqCiAqIFRoaXMgY2xhc3MgZW5jYXBzdWxhdGVkIHRoZSByZWFkIGxh\nc3QgY29uZmlybWVkIG9wZXJhdGlvbi4KICoKICovCmNsYXNzIFJlYWRMYXN0\nQ29uZmlybWVkT3AgaW1wbGVtZW50cyBSZWFkRW50cnlDYWxsYmFjayB7CiAg\nICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKFJlYWRMYXN0Q29uZmlybWVkT3AuY2xhc3MpOwogICAgTGVkZ2Vy\nSGFuZGxlIGxoOwogICAgaW50IG51bVJlc3BvbnNlc1BlbmRpbmc7CiAgICBS\nZWNvdmVyeURhdGEgbWF4UmVjb3ZlcmVkRGF0YTsKICAgIHZvbGF0aWxlIGJv\nb2xlYW4gY29tcGxldGVkID0gZmFsc2U7CgogICAgTGFzdENvbmZpcm1lZERh\ndGFDYWxsYmFjayBjYjsKICAgIGZpbmFsIERpc3RyaWJ1dGlvblNjaGVkdWxl\nLlF1b3J1bUNvdmVyYWdlU2V0IGNvdmVyYWdlU2V0OwoKICAgIC8qKgogICAg\nICogV3JhcHBlciB0byBnZXQgYWxsIHJlY292ZXJlZCBkYXRhIGZyb20gdGhl\nIHJlcXVlc3QKICAgICAqLwogICAgaW50ZXJmYWNlIExhc3RDb25maXJtZWRE\nYXRhQ2FsbGJhY2sgewogICAgICAgIHB1YmxpYyB2b2lkIHJlYWRMYXN0Q29u\nZmlybWVkRGF0YUNvbXBsZXRlKGludCByYywgUmVjb3ZlcnlEYXRhIGRhdGEp\nOwogICAgfQoKICAgIHB1YmxpYyBSZWFkTGFzdENvbmZpcm1lZE9wKExlZGdl\nckhhbmRsZSBsaCwgTGFzdENvbmZpcm1lZERhdGFDYWxsYmFjayBjYikgewog\nICAgICAgIHRoaXMuY2IgPSBjYjsKICAgICAgICB0aGlzLm1heFJlY292ZXJl\nZERhdGEgPSBuZXcgUmVjb3ZlcnlEYXRhKExlZGdlckhhbmRsZS5JTlZBTElE\nX0VOVFJZX0lELCAwKTsKICAgICAgICB0aGlzLmxoID0gbGg7CiAgICAgICAg\ndGhpcy5udW1SZXNwb25zZXNQZW5kaW5nID0gbGgubWV0YWRhdGEuZ2V0RW5z\nZW1ibGVTaXplKCk7CiAgICAgICAgdGhpcy5jb3ZlcmFnZVNldCA9IGxoLmRp\nc3RyaWJ1dGlvblNjaGVkdWxlLmdldENvdmVyYWdlU2V0KCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgaW5pdGlhdGUoKSB7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBsaC5tZXRhZGF0YS5jdXJyZW50RW5zZW1ibGUuc2l6ZSgp\nOyBpKyspIHsKICAgICAgICAgICAgbGguYmsuYm9va2llQ2xpZW50LnJlYWRF\nbnRyeShsaC5tZXRhZGF0YS5jdXJyZW50RW5zZW1ibGUuZ2V0KGkpLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxoLmxlZGdl\ncklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIEJvb2tpZVByb3RvY29sLkxBU1RfQUREX0NPTkZJUk1FRCwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLCBpKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5pdGlhdGVXaXRoRmVu\nY2luZygpIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGxoLm1ldGFk\nYXRhLmN1cnJlbnRFbnNlbWJsZS5zaXplKCk7IGkrKykgewogICAgICAgICAg\nICBsaC5iay5ib29raWVDbGllbnQucmVhZEVudHJ5QW5kRmVuY2VMZWRnZXIo\nbGgubWV0YWRhdGEuY3VycmVudEVuc2VtYmxlLmdldChpKSwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGxoLmxlZGdlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbGgubGVkZ2VyS2V5LAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgQm9va2llUHJvdG9jb2wuTEFTVF9BRERfQ09ORklSTUVELAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgdGhpcywgaSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzeW5j\naHJvbml6ZWQgdm9pZCByZWFkRW50cnlDb21wbGV0ZShmaW5hbCBpbnQgcmMs\nIGZpbmFsIGxvbmcgbGVkZ2VySWQsIGZpbmFsIGxvbmcgZW50cnlJZCwKICAg\nICAgICAgICAgZmluYWwgQ2hhbm5lbEJ1ZmZlciBidWZmZXIsIGZpbmFsIE9i\namVjdCBjdHgpIHsKICAgICAgICBpbnQgYm9va2llSW5kZXggPSAoSW50ZWdl\ncikgY3R4OwoKICAgICAgICBudW1SZXNwb25zZXNQZW5kaW5nLS07CiAgICAg\nICAgYm9vbGVhbiBoZWFyZFZhbGlkUmVzcG9uc2UgPSBmYWxzZTsKICAgICAg\nICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgUmVjb3ZlcnlEYXRhIHJlY292ZXJ5\nRGF0YSA9IGxoLm1hY01hbmFnZXIudmVyaWZ5RGlnZXN0QW5kUmV0dXJuTGFz\ndENvbmZpcm1lZChidWZmZXIpOwogICAgICAgICAgICAgICAgaWYgKHJlY292\nZXJ5RGF0YS5sYXN0QWRkQ29uZmlybWVkID4gbWF4UmVjb3ZlcmVkRGF0YS5s\nYXN0QWRkQ29uZmlybWVkKSB7CiAgICAgICAgICAgICAgICAgICAgbWF4UmVj\nb3ZlcmVkRGF0YSA9IHJlY292ZXJ5RGF0YTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIGhlYXJkVmFsaWRSZXNwb25zZSA9IHRydWU7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKEJLRGlnZXN0TWF0Y2hFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgLy8gVG9vIGJhZCwgdGhpcyBib29raWUgZGlk\nbid0IGdpdmUgdXMgYSB2YWxpZCBhbnN3ZXIsIHdlCiAgICAgICAgICAgICAg\nICAvLyBzdGlsbCBtaWdodCBiZSBhYmxlIHRvIHJlY292ZXIgdGhvdWdoIHNv\nIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIk1hYyBtaXNt\nYXRjaCBmb3IgbGVkZ2VyOiAiICsgbGVkZ2VySWQgKyAiLCBlbnRyeTogIiAr\nIGVudHJ5SWQKICAgICAgICAgICAgICAgICAgICAgICAgICArICIgd2hpbGUg\ncmVhZGluZyBsYXN0IGVudHJ5IGZyb20gYm9va2llOiAiCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyBsaC5tZXRhZGF0YS5jdXJyZW50RW5zZW1ibGUu\nZ2V0KGJvb2tpZUluZGV4KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIGlmIChyYyA9PSBCS0V4Y2VwdGlvbi5Db2RlLk5vU3VjaExlZGdl\nckV4aXN0c0V4Y2VwdGlvbiB8fCByYyA9PSBCS0V4Y2VwdGlvbi5Db2RlLk5v\nU3VjaEVudHJ5RXhjZXB0aW9uKSB7CiAgICAgICAgICAgIC8vIHRoaXMgc3Rp\nbGwgY291bnRzIGFzIGEgdmFsaWQgcmVzcG9uc2UsIGUuZy4sIGlmIHRoZSBj\nbGllbnQgY3Jhc2hlZCB3aXRob3V0IHdyaXRpbmcgYW55IGVudHJ5CiAgICAg\nICAgICAgIGhlYXJkVmFsaWRSZXNwb25zZSA9IHRydWU7CiAgICAgICAgfQoK\nICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29kZS5VbmF1dGhvcml6\nZWRBY2Nlc3NFeGNlcHRpb24gICYmICFjb21wbGV0ZWQpIHsKICAgICAgICAg\nICAgY2IucmVhZExhc3RDb25maXJtZWREYXRhQ29tcGxldGUocmMsIG1heFJl\nY292ZXJlZERhdGEpOwogICAgICAgICAgICBjb21wbGV0ZWQgPSB0cnVlOwog\nICAgICAgIH0KICAgICAgICAvLyBvdGhlciByZXR1cm4gY29kZXMgZG9udCBj\nb3VudCBhcyB2YWxpZCByZXNwb25zZXMKICAgICAgICBpZiAoaGVhcmRWYWxp\nZFJlc3BvbnNlCiAgICAgICAgICAgICYmIGNvdmVyYWdlU2V0LmFkZEJvb2tp\nZUFuZENoZWNrQ292ZXJlZChib29raWVJbmRleCkKICAgICAgICAgICAgJiYg\nIWNvbXBsZXRlZCkgewogICAgICAgICAgICBjb21wbGV0ZWQgPSB0cnVlOwog\nICAgICAgICAgICBMT0cuZGVidWcoIlJlYWQgQ29tcGxldGUgd2l0aCBlbm91\nZ2ggdmFsaWRSZXNwb25zZXMgZm9yIGxlZGdlcjoge30sIGVudHJ5OiB7fSIs\nCiAgICAgICAgICAgICAgICBsZWRnZXJJZCwgZW50cnlJZCk7CgogICAgICAg\nICAgICBjYi5yZWFkTGFzdENvbmZpcm1lZERhdGFDb21wbGV0ZShCS0V4Y2Vw\ndGlvbi5Db2RlLk9LLCBtYXhSZWNvdmVyZWREYXRhKTsKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKG51bVJlc3BvbnNlc1Bl\nbmRpbmcgPT0gMCAmJiAhY29tcGxldGVkKSB7CiAgICAgICAgICAgIC8vIEhh\ndmUgZ290IGFsbCByZXNwb25zZXMgYmFjayBidXQgd2FzIHN0aWxsIG5vdCBl\nbm91Z2gsIGp1c3QgZmFpbCB0aGUgb3BlcmF0aW9uCiAgICAgICAgICAgIExP\nRy5lcnJvcigiV2hpbGUgcmVhZExhc3RDb25maXJtZWQgbGVkZ2VyOiAiICsg\nbGVkZ2VySWQgKyAiIGRpZCBub3QgaGVhciBzdWNjZXNzIHJlc3BvbnNlcyBm\ncm9tIGFsbCBxdW9ydW1zIik7CiAgICAgICAgICAgIGNiLnJlYWRMYXN0Q29u\nZmlybWVkRGF0YUNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuTGVkZ2VyUmVj\nb3ZlcnlFeGNlcHRpb24sIG1heFJlY292ZXJlZERhdGEpOwogICAgICAgIH0K\nCiAgICB9Cn0K\n","encoding":"base64"}

