{"sha":"b34ff754f924fd989a9cea4cc0783cde5fbaff99","node_id":"MDQ6QmxvYjE1NzU5NTY6YjM0ZmY3NTRmOTI0ZmQ5ODlhOWNlYTRjYzA3ODNjZGU1ZmJhZmY5OQ==","size":3710,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/b34ff754f924fd989a9cea4cc0783cde5fbaff99","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLk1hdGhVdGlsczsKCmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKCi8qKgogKiBBIHNwZWNpZmljIHtA\nbGluayBEaXN0cmlidXRpb25TY2hlZHVsZX0gdGhhdCBwbGFjZXMgZW50cmll\ncyBpbiByb3VuZC1yb2JpbgogKiBmYXNoaW9uLiBGb3IgZW5zZW1ibGUgc2l6\nZSAzLCBhbmQgcXVvcnVtIHNpemUgMiwgRW50cnkgMCBnb2VzIHRvIGJvb2tp\nZSAwIGFuZAogKiAxLCBlbnRyeSAxIGdvZXMgdG8gYm9va2llIDEgYW5kIDIs\nIGFuZCBlbnRyeSAyIGdvZXMgdG8gYm9va2llIDIgYW5kIDAsIGFuZCBzbwog\nKiBvbi4KICoKICovCmNsYXNzIFJvdW5kUm9iaW5EaXN0cmlidXRpb25TY2hl\nZHVsZSBpbXBsZW1lbnRzIERpc3RyaWJ1dGlvblNjaGVkdWxlIHsKICAgIHBy\naXZhdGUgaW50IHdyaXRlUXVvcnVtU2l6ZTsKICAgIHByaXZhdGUgaW50IGFj\na1F1b3J1bVNpemU7CiAgICBwcml2YXRlIGludCBlbnNlbWJsZVNpemU7CgoK\nICAgIHB1YmxpYyBSb3VuZFJvYmluRGlzdHJpYnV0aW9uU2NoZWR1bGUoaW50\nIHdyaXRlUXVvcnVtU2l6ZSwgaW50IGFja1F1b3J1bVNpemUsIGludCBlbnNl\nbWJsZVNpemUpIHsKICAgICAgICB0aGlzLndyaXRlUXVvcnVtU2l6ZSA9IHdy\naXRlUXVvcnVtU2l6ZTsKICAgICAgICB0aGlzLmFja1F1b3J1bVNpemUgPSBh\nY2tRdW9ydW1TaXplOwogICAgICAgIHRoaXMuZW5zZW1ibGVTaXplID0gZW5z\nZW1ibGVTaXplOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIExp\nc3Q8SW50ZWdlcj4gZ2V0V3JpdGVTZXQobG9uZyBlbnRyeUlkKSB7CiAgICAg\nICAgTGlzdDxJbnRlZ2VyPiBzZXQgPSBuZXcgQXJyYXlMaXN0PEludGVnZXI+\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0aGlzLndyaXRlUXVv\ncnVtU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIHNldC5hZGQoKGludCkoKGVu\ndHJ5SWQgKyBpKSAlIGVuc2VtYmxlU2l6ZSkpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gc2V0OwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIEFja1NldCBnZXRBY2tTZXQoKSB7CiAgICAgICAgZmluYWwgSGFzaFNldDxJ\nbnRlZ2VyPiBhY2tTZXQgPSBuZXcgSGFzaFNldDxJbnRlZ2VyPigpOwogICAg\nICAgIHJldHVybiBuZXcgQWNrU2V0KCkgewogICAgICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBhZGRCb29raWVBbmRDaGVjayhpbnQgYm9va2llSW5kZXhIZWFy\nZEZyb20pIHsKICAgICAgICAgICAgICAgIGFja1NldC5hZGQoYm9va2llSW5k\nZXhIZWFyZEZyb20pOwogICAgICAgICAgICAgICAgcmV0dXJuIGFja1NldC5z\naXplKCkgPj0gYWNrUXVvcnVtU2l6ZTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgcmVtb3ZlQm9va2llKGludCBib29raWUpIHsK\nICAgICAgICAgICAgICAgIGFja1NldC5yZW1vdmUoYm9va2llKTsKICAgICAg\nICAgICAgfQogICAgICAgIH07CiAgICB9CgogICAgcHJpdmF0ZSBjbGFzcyBS\nUlF1b3J1bUNvdmVyYWdlU2V0IGltcGxlbWVudHMgUXVvcnVtQ292ZXJhZ2VT\nZXQgewogICAgICAgIC8vIGNvdmVyZWRbaV0gaXMgdHJ1ZSBpZiB0aGUgcXVv\ncnVtIHN0YXJ0aW5nIGF0IGJvb2tpZSBpbmRleCBpIGhhcyBiZWVuCiAgICAg\nICAgLy8gY292ZXJlZCBieSBhIHJlY292ZXJ5IHJlcGx5CiAgICAgICAgcHJp\ndmF0ZSBib29sZWFuW10gY292ZXJlZCA9IG51bGw7CiAgICAgICAgcHJpdmF0\nZSBpbnQgbnVtUXVvcnVtc1VuY292ZXJlZDsKCiAgICAgICAgcHJpdmF0ZSBS\nUlF1b3J1bUNvdmVyYWdlU2V0KCkgewogICAgICAgICAgICBjb3ZlcmVkID0g\nbmV3IGJvb2xlYW5bZW5zZW1ibGVTaXplXTsKICAgICAgICAgICAgbnVtUXVv\ncnVtc1VuY292ZXJlZCA9IGVuc2VtYmxlU2l6ZTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgYm9vbGVhbiBhZGRCb29raWVBbmRD\naGVja0NvdmVyZWQoaW50IGJvb2tpZUluZGV4SGVhcmRGcm9tKSB7CiAgICAg\nICAgICAgIGlmIChudW1RdW9ydW1zVW5jb3ZlcmVkID09IDApIHsKICAgICAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFja1F1b3J1bVNpemU7IGkrKykg\newogICAgICAgICAgICAgICAgaW50IHF1b3J1bVN0YXJ0SW5kZXggPSBNYXRo\nVXRpbHMuc2lnblNhZmVNb2QoYm9va2llSW5kZXhIZWFyZEZyb20gLSBpLCBl\nbnNlbWJsZVNpemUpOwogICAgICAgICAgICAgICAgaWYgKCFjb3ZlcmVkW3F1\nb3J1bVN0YXJ0SW5kZXhdKSB7CiAgICAgICAgICAgICAgICAgICAgY292ZXJl\nZFtxdW9ydW1TdGFydEluZGV4XSA9IHRydWU7CiAgICAgICAgICAgICAgICAg\nICAgbnVtUXVvcnVtc1VuY292ZXJlZC0tOwoKICAgICAgICAgICAgICAgICAg\nICBpZiAobnVtUXVvcnVtc1VuY292ZXJlZCA9PSAwKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIFF1b3J1bUNvdmVyYWdlU2V0IGdldENvdmVyYWdlU2V0\nKCkgewogICAgICAgIHJldHVybiBuZXcgUlJRdW9ydW1Db3ZlcmFnZVNldCgp\nOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBib29sZWFu\nIGhhc0VudHJ5KGxvbmcgZW50cnlJZCwgaW50IGJvb2tpZUluZGV4KSB7CiAg\nICAgICAgcmV0dXJuIGdldFdyaXRlU2V0KGVudHJ5SWQpLmNvbnRhaW5zKGJv\nb2tpZUluZGV4KTsKICAgIH0KfQo=\n","encoding":"base64"}

