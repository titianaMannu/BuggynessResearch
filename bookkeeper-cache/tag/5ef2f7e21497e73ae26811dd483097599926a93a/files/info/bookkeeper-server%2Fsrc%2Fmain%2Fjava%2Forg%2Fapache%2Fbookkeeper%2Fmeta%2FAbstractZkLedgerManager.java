{"sha":"78cb244222e9aacdf2278a68d433fd7e540e619d","node_id":"MDQ6QmxvYjE1NzU5NTY6NzhjYjI0NDIyMmU5YWFjZGYyMjc4YTY4ZDQzM2ZkN2U1NDBlNjE5ZA==","size":12366,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/78cb244222e9aacdf2278a68d433fd7e540e619d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQWJzdHJhY3RDb25m\naWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVu\ndC5MZWRnZXJNZXRhZGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5H\nZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLk11bHRpQ2FsbGJh\nY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlckludGVybmFsQ2FsbGJhY2tzLlByb2Nlc3NvcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci51dGlsLkJvb2tLZWVwZXJDb25zdGFudHM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudmVyc2lvbmluZy5WZXJzaW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuWmtVdGlsczsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyRmFjdG9yeTsKCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5Bc3lu\nY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuQXN5bmND\nYWxsYmFjay5EYXRhQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5Bc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjazsKaW1wb3J0IG9yZy5h\ncGFjaGUuem9va2VlcGVyLkFzeW5jQ2FsbGJhY2suU3RhdENhbGxiYWNrOwpp\nbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uLkNv\nZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5kYXRhLlN0YXQ7CgovKioKICog\nQWJzdHJhY3QgbGVkZ2VyIG1hbmFnZXIgYmFzZWQgb24gem9va2VlcGVyLCB3\naGljaCBwcm92aWRlcyBjb21tb24gbWV0aG9kcyBzdWNoIGFzIHF1ZXJ5IHpr\nIG5vZGVzLgogKi8KYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3Raa0xlZGdlck1h\nbmFnZXIgaW1wbGVtZW50cyBMZWRnZXJNYW5hZ2VyIHsKCiAgICBzdGF0aWMg\nTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKEFic3RyYWN0\nWmtMZWRnZXJNYW5hZ2VyLmNsYXNzKTsKCiAgICBwcm90ZWN0ZWQgZmluYWwg\nQWJzdHJhY3RDb25maWd1cmF0aW9uIGNvbmY7CiAgICBwcm90ZWN0ZWQgZmlu\nYWwgWm9vS2VlcGVyIHprOwogICAgcHJvdGVjdGVkIGZpbmFsIFN0cmluZyBs\nZWRnZXJSb290UGF0aDsKCiAgICAvKioKICAgICAqIFpvb0tlZXBlci1iYXNl\nZCBMZWRnZXIgTWFuYWdlciBDb25zdHJ1Y3RvcgogICAgICoKICAgICAqIEBw\nYXJhbSBjb25mCiAgICAgKiAgICAgICAgICBDb25maWd1cmF0aW9uIG9iamVj\ndAogICAgICogQHBhcmFtIHprCiAgICAgKiAgICAgICAgICBab29LZWVwZXIg\nQ2xpZW50IEhhbmRsZQogICAgICovCiAgICBwcm90ZWN0ZWQgQWJzdHJhY3Ra\na0xlZGdlck1hbmFnZXIoQWJzdHJhY3RDb25maWd1cmF0aW9uIGNvbmYsIFpv\nb0tlZXBlciB6aykgewogICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CiAgICAg\nICAgdGhpcy56ayA9IHprOwogICAgICAgIHRoaXMubGVkZ2VyUm9vdFBhdGgg\nPSBjb25mLmdldFprTGVkZ2Vyc1Jvb3RQYXRoKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBHZXQgdGhlIHpub2RlIHBhdGggdGhhdCBpcyB1c2VkIHRvIHN0\nb3JlIGxlZGdlciBtZXRhZGF0YQogICAgICoKICAgICAqIEBwYXJhbSBsZWRn\nZXJJZAogICAgICogICAgICAgICAgTGVkZ2VyIElECiAgICAgKiBAcmV0dXJu\nIGxlZGdlciBub2RlIHBhdGgKICAgICAqLwogICAgcHJvdGVjdGVkIGFic3Ry\nYWN0IFN0cmluZyBnZXRMZWRnZXJQYXRoKGxvbmcgbGVkZ2VySWQpOwoKICAg\nIC8qKgogICAgICogR2V0IGxlZGdlciBpZCBmcm9tIGl0cyB6bm9kZSBsZWRn\nZXIgcGF0aAogICAgICoKICAgICAqIEBwYXJhbSBsZWRnZXJQYXRoCiAgICAg\nKiAgICAgICAgICBMZWRnZXIgcGF0aCB0byBzdG9yZSBtZXRhZGF0YQogICAg\nICogQHJldHVybiBsZWRnZXIgaWQKICAgICAqIEB0aHJvd3MgSU9FeGNlcHRp\nb24gd2hlbiB0aGUgbGVkZ2VyIHBhdGggaXMgaW52YWxpZAogICAgICovCiAg\nICBwcm90ZWN0ZWQgYWJzdHJhY3QgbG9uZyBnZXRMZWRnZXJJZChTdHJpbmcg\nbGVkZ2VyUGF0aCkgdGhyb3dzIElPRXhjZXB0aW9uOwoKICAgIC8qKgogICAg\nICogUmVtb3ZlcyBsZWRnZXIgbWV0YWRhdGEgZnJvbSBab29LZWVwZXIgaWYg\ndmVyc2lvbiBtYXRjaGVzLgogICAgICoKICAgICAqIEBwYXJhbSAgIGxlZGdl\ncklkICAgIGxlZGdlciBpZGVudGlmaWVyCiAgICAgKiBAcGFyYW0gICB2ZXJz\naW9uICAgICBsb2NhbCB2ZXJzaW9uIG9mIG1ldGFkYXRhIHpub2RlCiAgICAg\nKiBAcGFyYW0gICBjYiAgICAgICAgICBjYWxsYmFjayBvYmplY3QKICAgICAq\nLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCByZW1vdmVMZWRnZXJN\nZXRhZGF0YShmaW5hbCBsb25nIGxlZGdlcklkLCBmaW5hbCBWZXJzaW9uIHZl\ncnNpb24sCiAgICAgICAgICAgIGZpbmFsIEdlbmVyaWNDYWxsYmFjazxWb2lk\nPiBjYikgewogICAgICAgIGludCB6bm9kZVZlcnNpb24gPSAtMTsKICAgICAg\nICBpZiAoVmVyc2lvbi5ORVcgPT0gdmVyc2lvbikgewogICAgICAgICAgICBM\nT0cuZXJyb3IoIlJlcXVlc3QgdG8gZGVsZXRlIGxlZGdlciB7fSBtZXRhZGF0\nYSB3aXRoIHZlcnNpb24gc2V0IHRvIHRoZSBpbml0aWFsIG9uZSIsIGxlZGdl\ncklkKTsKICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNl\ncHRpb24uQ29kZS5NZXRhZGF0YVZlcnNpb25FeGNlcHRpb24sIChWb2lkKW51\nbGwpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIGlmIChW\nZXJzaW9uLkFOWSAhPSB2ZXJzaW9uKSB7CiAgICAgICAgICAgIGlmICghKHZl\ncnNpb24gaW5zdGFuY2VvZiBaa1ZlcnNpb24pKSB7CiAgICAgICAgICAgICAg\nICBMT0cuaW5mbygiTm90IGFuIGluc3RhbmNlIG9mIFpLVmVyc2lvbjoge30i\nLCBsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICBjYi5vcGVyYXRpb25Db21w\nbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLk1ldGFkYXRhVmVyc2lvbkV4Y2VwdGlv\nbiwgKFZvaWQpbnVsbCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB6bm9kZVZlcnNpb24g\nPSAoKFprVmVyc2lvbil2ZXJzaW9uKS5nZXRabm9kZVZlcnNpb24oKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgemsuZGVsZXRlKGdldExl\nZGdlclBhdGgobGVkZ2VySWQpLCB6bm9kZVZlcnNpb24sIG5ldyBWb2lkQ2Fs\nbGJhY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgs\nIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgIGludCBia1JjOwogICAg\nICAgICAgICAgICAgaWYgKHJjID09IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk5P\nTk9ERS5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLndh\ncm4oIkxlZGdlciBub2RlIGRvZXMgbm90IGV4aXN0IGluIFpvb0tlZXBlcjog\nbGVkZ2VySWQ9e30iLCBsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAg\nYmtSYyA9IEJLRXhjZXB0aW9uLkNvZGUuTm9TdWNoTGVkZ2VyRXhpc3RzRXhj\nZXB0aW9uOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyYyA9PSBLZWVw\nZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgYmtSYyA9IEJLRXhjZXB0aW9uLkNvZGUuT0s7CiAgICAgICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJrUmMgPSBC\nS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUoYmtSYywg\nKFZvaWQpbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCBudWxsKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHJlYWRMZWRn\nZXJNZXRhZGF0YShmaW5hbCBsb25nIGxlZGdlcklkLCBmaW5hbCBHZW5lcmlj\nQ2FsbGJhY2s8TGVkZ2VyTWV0YWRhdGE+IHJlYWRDYikgewogICAgICAgIHpr\nLmdldERhdGEoZ2V0TGVkZ2VyUGF0aChsZWRnZXJJZCksIGZhbHNlLCBuZXcg\nRGF0YUNhbGxiYWNrKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmlu\nZyBwYXRoLCBPYmplY3QgY3R4LCBieXRlW10gZGF0YSwgU3RhdCBzdGF0KSB7\nCiAgICAgICAgICAgICAgICBpZiAocmMgPT0gS2VlcGVyRXhjZXB0aW9uLkNv\nZGUuTk9OT0RFLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBp\nZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgTE9HLmRlYnVnKCJObyBzdWNoIGxlZGdlcjogIiArIGxlZGdlcklk\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhj\nZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZS5nZXQocmMpLCBw\nYXRoKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIHJlYWRDYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2Rl\nLk5vU3VjaExlZGdlckV4aXN0c0V4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgaWYgKHJjICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmlu\ndFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkNv\ndWxkIG5vdCByZWFkIG1ldGFkYXRhIGZvciBsZWRnZXI6ICIgKyBsZWRnZXJJ\nZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0\naW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZS5nZXQocmMpLCBwYXRo\nKSk7CiAgICAgICAgICAgICAgICAgICAgcmVhZENiLm9wZXJhdGlvbkNvbXBs\nZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51bGwpOwogICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICBMZWRnZXJNZXRhZGF0YSBtZXRhZGF0YTsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEg\nPSBMZWRnZXJNZXRhZGF0YS5wYXJzZUNvbmZpZyhkYXRhLCBuZXcgWmtWZXJz\naW9uKHN0YXQuZ2V0VmVyc2lvbigpKSk7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgTE9H\nLmVycm9yKCJDb3VsZCBub3QgcGFyc2UgbGVkZ2VyIG1ldGFkYXRhIGZvciBs\nZWRnZXI6ICIgKyBsZWRnZXJJZCwgZSk7CiAgICAgICAgICAgICAgICAgICAg\ncmVhZENiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktF\neGNlcHRpb24sIG51bGwpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlYWRDYi5vcGVy\nYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLk9LLCBtZXRhZGF0YSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9LCBudWxsKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHdyaXRlTGVkZ2VyTWV0YWRhdGEo\nZmluYWwgbG9uZyBsZWRnZXJJZCwgZmluYWwgTGVkZ2VyTWV0YWRhdGEgbWV0\nYWRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZp\nbmFsIEdlbmVyaWNDYWxsYmFjazxWb2lkPiBjYikgewogICAgICAgIFZlcnNp\nb24gdiA9IG1ldGFkYXRhLmdldFZlcnNpb24oKTsKICAgICAgICBpZiAoVmVy\nc2lvbi5ORVcgPT0gdiB8fCAhKHYgaW5zdGFuY2VvZiBaa1ZlcnNpb24pKSB7\nCiAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9u\nLkNvZGUuTWV0YWRhdGFWZXJzaW9uRXhjZXB0aW9uLCBudWxsKTsKICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBmaW5hbCBaa1ZlcnNp\nb24genYgPSAoWmtWZXJzaW9uKSB2OwogICAgICAgIHprLnNldERhdGEoZ2V0\nTGVkZ2VyUGF0aChsZWRnZXJJZCksCiAgICAgICAgICAgICAgICAgICBtZXRh\nZGF0YS5zZXJpYWxpemUoKSwgenYuZ2V0Wm5vZGVWZXJzaW9uKCksCiAgICAg\nICAgICAgICAgICAgICBuZXcgU3RhdENhbGxiYWNrKCkgewogICAgICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jl\nc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4LCBTdGF0IHN0\nYXQpIHsKICAgICAgICAgICAgICAgIGlmIChLZWVwZXJFeGNlcHRpb24uQ29k\nZS5CYWRWZXJzaW9uID09IHJjKSB7CiAgICAgICAgICAgICAgICAgICAgY2Iu\nb3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5NZXRhZGF0YVZl\ncnNpb25FeGNlcHRpb24sIG51bGwpOwogICAgICAgICAgICAgICAgfSBlbHNl\nIGlmIChLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpID09IHJj\nKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1ldGFkYXRhIHZl\ncnNpb24KICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS5zZXRWZXJzaW9u\nKHp2LnNldFpub2RlVmVyc2lvbihzdGF0LmdldFZlcnNpb24oKSkpOwogICAg\nICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0\naW9uLkNvZGUuT0ssIG51bGwpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgICAgICBMT0cud2FybigiQ29uZGl0aW9uYWwgdXBk\nYXRlIGxlZGdlciBtZXRhZGF0YSBmYWlsZWQ6ICIsIEtlZXBlckV4Y2VwdGlv\nbi5Db2RlLmdldChyYykpOwogICAgICAgICAgICAgICAgICAgIGNiLm9wZXJh\ndGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51\nbGwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfSwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcm9jZXNzIGxlZGdl\ncnMgaW4gYSBzaW5nbGUgemsgbm9kZS4KICAgICAqCiAgICAgKiA8cD4KICAg\nICAqIGZvciBlYWNoIGxlZGdlciBmb3VuZCBpbiB0aGlzIHprIG5vZGUsIHBy\nb2Nlc3NvciNwcm9jZXNzKGxlZGdlcklkKSB3aWxsIGJlIHRyaWdnZXJyZWQK\nICAgICAqIHRvIHByb2Nlc3MgYSBzcGVjaWZpYyBsZWRnZXIuIGFmdGVyIGFs\nbCBsZWRnZXJzIGhhcyBiZWVuIHByb2Nlc3NlZCwgdGhlIGZpbmFsQ2Igd2ls\nbAogICAgICogYmUgY2FsbGVkIHdpdGggcHJvdmlkZWQgY29udGV4dCBvYmpl\nY3QuIFRoZSBSQyBwYXNzZWQgdG8gZmluYWxDYiBpcyBkZWNpZGVkIGJ5IDoK\nICAgICAqIDx1bD4KICAgICAqIDxsaT4gQWxsIGxlZGdlcnMgYXJlIHByb2Nl\nc3NlZCBzdWNjZXNzZnVsbHksIHN1Y2Nlc3NSYyB3aWxsIGJlIHBhc3NlZC4K\nICAgICAqIDxsaT4gRWl0aGVyIGxlZGdlciBpcyBwcm9jZXNzZWQgZmFpbGVk\nLCBmYWlsdXJlUmMgd2lsbCBiZSBwYXNzZWQuCiAgICAgKiA8L3VsPgogICAg\nICogPC9wPgogICAgICoKICAgICAqIEBwYXJhbSBwYXRoCiAgICAgKiAgICAg\nICAgICBaayBub2RlIHBhdGggdG8gc3RvcmUgbGVkZ2VycwogICAgICogQHBh\ncmFtIHByb2Nlc3NvcgogICAgICogICAgICAgICAgUHJvY2Vzc29yIHByb3Zp\nZGVkIHRvIHByb2Nlc3MgbGVkZ2VyCiAgICAgKiBAcGFyYW0gZmluYWxDYgog\nICAgICogICAgICAgICAgQ2FsbGJhY2sgb2JqZWN0IHdoZW4gYWxsIGxlZGdl\ncnMgYXJlIHByb2Nlc3NlZAogICAgICogQHBhcmFtIGN0eAogICAgICogICAg\nICAgICAgQ29udGV4dCBvYmplY3QgcGFzc2VkIHRvIGZpbmFsQ2IKICAgICAq\nIEBwYXJhbSBzdWNjZXNzUmMKICAgICAqICAgICAgICAgIFJDIHBhc3NlZCB0\nbyBmaW5hbENiIHdoZW4gYWxsIGxlZGdlcnMgYXJlIHByb2Nlc3NlZCBzdWNj\nZXNzZnVsbHkKICAgICAqIEBwYXJhbSBmYWlsdXJlUmMKICAgICAqICAgICAg\nICAgIFJDIHBhc3NlZCB0byBmaW5hbENiIHdoZW4gZWl0aGVyIGxlZGdlciBp\ncyBwcm9jZXNzZWQgZmFpbGVkCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIGFzeW5jUHJvY2Vzc0xlZGdlcnNJblNpbmdsZU5vZGUoCiAgICAgICAgICAg\nIGZpbmFsIFN0cmluZyBwYXRoLCBmaW5hbCBQcm9jZXNzb3I8TG9uZz4gcHJv\nY2Vzc29yLAogICAgICAgICAgICBmaW5hbCBBc3luY0NhbGxiYWNrLlZvaWRD\nYWxsYmFjayBmaW5hbENiLCBmaW5hbCBPYmplY3QgY3R4LAogICAgICAgICAg\nICBmaW5hbCBpbnQgc3VjY2Vzc1JjLCBmaW5hbCBpbnQgZmFpbHVyZVJjKSB7\nCiAgICAgICAgWmtVdGlscy5nZXRDaGlsZHJlbkluU2luZ2xlTm9kZSh6aywg\ncGF0aCwgbmV3IEdlbmVyaWNDYWxsYmFjazxMaXN0PFN0cmluZz4+KCkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBMaXN0PFN0cmluZz4gbGVkZ2Vy\nTm9kZXMpIHsKICAgICAgICAgICAgICAgIGlmIChDb2RlLk9LLmludFZhbHVl\nKCkgIT0gcmMpIHsKICAgICAgICAgICAgICAgICAgICBmaW5hbENiLnByb2Nl\nc3NSZXN1bHQoZmFpbHVyZVJjLCBudWxsLCBjdHgpOwogICAgICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICBTZXQ8TG9uZz4gemtBY3RpdmVMZWRnZXJzID0gbGVkZ2VyTGlzdFRv\nU2V0KGxlZGdlck5vZGVzLCBwYXRoKTsKICAgICAgICAgICAgICAgIExPRy5k\nZWJ1ZygiUHJvY2Vzc2luZyBsZWRnZXJzOiB7fSIsIHprQWN0aXZlTGVkZ2Vy\ncyk7CgogICAgICAgICAgICAgICAgLy8gbm8gbGVkZ2VycyBmb3VuZCwgcmV0\ndXJuIGRpcmVjdGx5CiAgICAgICAgICAgICAgICBpZiAoemtBY3RpdmVMZWRn\nZXJzLnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgZmluYWxD\nYi5wcm9jZXNzUmVzdWx0KHN1Y2Nlc3NSYywgbnVsbCwgY3R4KTsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgTXVsdGlDYWxsYmFjayBtY2IgPSBuZXcgTXVsdGlDYWxs\nYmFjayh6a0FjdGl2ZUxlZGdlcnMuc2l6ZSgpLCBmaW5hbENiLCBjdHgsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHN1Y2Nlc3NSYywgZmFpbHVyZVJjKTsKICAgICAgICAgICAgICAg\nIC8vIHN0YXJ0IGxvb3Agb3ZlciBhbGwgbGVkZ2VycwogICAgICAgICAgICAg\nICAgZm9yIChMb25nIGxlZGdlciA6IHprQWN0aXZlTGVkZ2VycykgewogICAg\nICAgICAgICAgICAgICAgIHByb2Nlc3Nvci5wcm9jZXNzKGxlZGdlciwgbWNi\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0p\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGUgem5vZGUgYSBz\ncGVjaWFsIHpub2RlCiAgICAgKgogICAgICogQHBhcmFtIHpub2RlCiAgICAg\nKiAgICAgICAgICBabm9kZSBOYW1lCiAgICAgKiBAcmV0dXJuIHRydWUgIGlm\nIHRoZSB6bm9kZSBpcyBhIHNwZWNpYWwgem5vZGUgb3RoZXJ3aXNlIGZhbHNl\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzU3BlY2lhbFpub2Rl\nKFN0cmluZyB6bm9kZSkgewogICAgICAgIGlmIChCb29rS2VlcGVyQ29uc3Rh\nbnRzLkFWQUlMQUJMRV9OT0RFLmVxdWFscyh6bm9kZSkKICAgICAgICAgICAg\nICAgIHx8IEJvb2tLZWVwZXJDb25zdGFudHMuQ09PS0lFX05PREUuZXF1YWxz\nKHpub2RlKQogICAgICAgICAgICAgICAgfHwgQm9va0tlZXBlckNvbnN0YW50\ncy5MQVlPVVRfWk5PREUuZXF1YWxzKHpub2RlKQogICAgICAgICAgICAgICAg\nfHwgQm9va0tlZXBlckNvbnN0YW50cy5JTlNUQU5DRUlELmVxdWFscyh6bm9k\nZSkKICAgICAgICAgICAgICAgIHx8IEJvb2tLZWVwZXJDb25zdGFudHMuVU5E\nRVJfUkVQTElDQVRJT05fTk9ERS5lcXVhbHMoem5vZGUpKSB7CiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBaSyByZXRy\naWV2ZWQgbGVkZ2VyIG5vZGVzIHRvIGEgSGFzaFNldCBmb3IgZWFzaWVyIGNv\nbXBhcmlzb25zLgogICAgICoKICAgICAqIEBwYXJhbSBsZWRnZXJOb2Rlcwog\nICAgICogICAgICAgICAgemsgbGVkZ2VyIG5vZGVzCiAgICAgKiBAcGFyYW0g\ncGF0aAogICAgICogICAgICAgICAgdGhlIHByZWZpeCBwYXRoIG9mIHRoZSBs\nZWRnZXIgbm9kZXMKICAgICAqIEByZXR1cm4gbGVkZ2VyIGlkIGhhc2ggc2V0\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBTZXQ8TG9uZz4gbGVkZ2VyTGlzdFRv\nU2V0KExpc3Q8U3RyaW5nPiBsZWRnZXJOb2RlcywgU3RyaW5nIHBhdGgpIHsK\nICAgICAgICBTZXQ8TG9uZz4gemtBY3RpdmVMZWRnZXJzID0gbmV3IEhhc2hT\nZXQ8TG9uZz4obGVkZ2VyTm9kZXMuc2l6ZSgpLCAxLjBmKTsKICAgICAgICBm\nb3IgKFN0cmluZyBsZWRnZXJOb2RlIDogbGVkZ2VyTm9kZXMpIHsKICAgICAg\nICAgICAgaWYgKGlzU3BlY2lhbFpub2RlKGxlZGdlck5vZGUpKSB7CiAgICAg\nICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgLy8gY29udmVydCB0aGUgbm9kZSBw\nYXRoIHRvIGxlZGdlciBpZCBhY2NvcmRpbmcgdG8gZGlmZmVyZW50IGxlZGdl\nciBtYW5hZ2VyIGltcGxlbWVudGF0aW9uCiAgICAgICAgICAgICAgICB6a0Fj\ndGl2ZUxlZGdlcnMuYWRkKGdldExlZGdlcklkKHBhdGggKyAiLyIgKyBsZWRn\nZXJOb2RlKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIExPRy53YXJuKCJFcnJvciBleHRyYWN0aW5n\nIGxlZGdlcklkIGZyb20gWksgbGVkZ2VyIG5vZGU6ICIgKyBsZWRnZXJOb2Rl\nKTsKICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBwcmV0dHkgYmFkIGVy\ncm9yIGFzIGl0IGluZGljYXRlcyBhIGxlZGdlciBub2RlIGluIFpLCiAgICAg\nICAgICAgICAgICAvLyBoYXMgYW4gaW5jb3JyZWN0IGZvcm1hdC4gRm9yIG5v\ndyBqdXN0IGNvbnRpbnVlIGFuZCBjb25zaWRlcgogICAgICAgICAgICAgICAg\nLy8gdGhpcyBhcyBhIG5vbi1leGlzdGVudCBsZWRnZXIuCiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICByZXR1cm4gemtBY3RpdmVMZWRnZXJzOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICB9Cn0K\n","encoding":"base64"}

