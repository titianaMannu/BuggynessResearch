{"sha":"ab577f1634dd5d320a1c9c581d40243189940b7d","node_id":"MDQ6QmxvYjE1NzU5NTY6YWI1NzdmMTYzNGRkNWQzMjBhMWM5YzU4MWQ0MDI0MzE4OTk0MGI3ZA==","size":4932,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ab577f1634dd5d320a1c9c581d40243189940b7d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YXN0b3JlOwoKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0\nb3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuYXRvbWljLkF0b21pY0ludGVnZXI7CgppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLm1ldGFzdG9yZS5NU0V4Y2VwdGlvbi5Db2RlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnZlcnNpb25pbmcuVmVyc2lv\nbjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKCi8qKgogKiBQcm92aWRlcyB1dGlsaXRpZXMgZm9y\nIG1ldGFzdG9yZS4KICovCnB1YmxpYyBjbGFzcyBNZXRhc3RvcmVVdGlscyB7\nCgogICAgcHJvdGVjdGVkIGZpbmFsIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTWV0YXN0b3JlVXRpbHMuY2xhc3Mp\nOwoKICAgIHN0YXRpYyBjbGFzcyBNdWx0aU1ldGFzdG9yZUNhbGxiYWNrPFQ+\nIGltcGxlbWVudHMgTWV0YXN0b3JlQ2FsbGJhY2s8VD4gewoKICAgICAgICBp\nbnQgcmMgPSBDb2RlLk9LLmdldENvZGUoKTsKICAgICAgICBmaW5hbCBpbnQg\nbnVtT3BzOwogICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIgbnVtRmluaXNo\nZWQgPSBuZXcgQXRvbWljSW50ZWdlcigwKTsKICAgICAgICBmaW5hbCBDb3Vu\ndERvd25MYXRjaCBkb25lTGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7\nCgogICAgICAgIE11bHRpTWV0YXN0b3JlQ2FsbGJhY2soaW50IG51bU9wcykg\newogICAgICAgICAgICB0aGlzLm51bU9wcyA9IG51bU9wczsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIGNvbXBs\nZXRlKGludCByYywgVCB2YWx1ZSwgT2JqZWN0IGN0eCkgewogICAgICAgICAg\nICBpZiAoQ29kZS5PSy5nZXRDb2RlKCkgIT0gcmMpIHsKICAgICAgICAgICAg\nICAgIHRoaXMucmMgPSByYzsKICAgICAgICAgICAgICAgIGRvbmVMYXRjaC5j\nb3VudERvd24oKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBpZiAobnVtRmluaXNoZWQuaW5jcmVtZW50QW5k\nR2V0KCkgPT0gbnVtT3BzKSB7CiAgICAgICAgICAgICAgICBkb25lTGF0Y2gu\nY291bnREb3duKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyB2b2lkIHdhaXRVbnRpbEFsbEZpbmlzaGVkKCkgdGhyb3dzIE1T\nRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGRvbmVMYXRjaC5hd2FpdCgpOwogICAgICAgICAgICBpZiAoQ29kZS5PSy5n\nZXRDb2RlKCkgIT0gcmMpIHsKICAgICAgICAgICAgICAgIHRocm93IE1TRXhj\nZXB0aW9uLmNyZWF0ZShDb2RlLmdldChyYykpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQoKICAgIHN0YXRpYyBjbGFzcyBTeW5jTWV0YXN0b3Jl\nQ2FsbGJhY2s8VD4gaW1wbGVtZW50cyBNZXRhc3RvcmVDYWxsYmFjazxUPiB7\nCgogICAgICAgIGludCByYzsKICAgICAgICBUIHJlc3VsdDsKICAgICAgICBm\naW5hbCBDb3VudERvd25MYXRjaCBkb25lTGF0Y2ggPSBuZXcgQ291bnREb3du\nTGF0Y2goMSk7CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2\nb2lkIGNvbXBsZXRlKGludCByYywgVCB2YWx1ZSwgT2JqZWN0IGN0eCkgewog\nICAgICAgICAgICB0aGlzLnJjID0gcmM7CiAgICAgICAgICAgIHJlc3VsdCA9\nIHZhbHVlOwogICAgICAgICAgICBkb25lTGF0Y2guY291bnREb3duKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgVCBnZXRSZXN1bHQoKSB0aHJvd3Mg\nTVNFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgZG9uZUxhdGNoLmF3YWl0KCk7CgogICAgICAgICAgICBpZiAoQ29kZS5P\nSy5nZXRDb2RlKCkgIT0gcmMpIHsKICAgICAgICAgICAgICAgIHRocm93IE1T\nRXhjZXB0aW9uLmNyZWF0ZShDb2RlLmdldChyYykpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQoKICAgIH0K\nCiAgICAvKioKICAgICAqIENsZWFuIHRoZSBnaXZlbiB0YWJsZS4KICAgICAq\nCiAgICAgKiBAcGFyYW0gdGFibGUKICAgICAqICAgICAgICAgIE1ldGFzdG9y\nZSBUYWJsZS4KICAgICAqIEBwYXJhbSBudW1FbnRyaWVzUGVyU2NhbgogICAg\nICogICAgICAgICAgTnVtIGVudHJpZXMgcGVyIHNjYW4uCiAgICAgKiBAdGhy\nb3dzIE1TRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhj\nZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBjbGVhblRh\nYmxlKE1ldGFzdG9yZVRhYmxlIHRhYmxlLCBpbnQgbnVtRW50cmllc1BlclNj\nYW4pCiAgICB0aHJvd3MgTVNFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0\naW9uIHsKICAgICAgICAvLyBvcGVuIGN1cnNvcgogICAgICAgIFN5bmNNZXRh\nc3RvcmVDYWxsYmFjazxNZXRhc3RvcmVDdXJzb3I+IG9wZW5DYiA9IG5ldyBT\neW5jTWV0YXN0b3JlQ2FsbGJhY2s8TWV0YXN0b3JlQ3Vyc29yPigpOwogICAg\nICAgIHRhYmxlLm9wZW5DdXJzb3IoTWV0YXN0b3JlVGFibGUuTk9OX0ZJRUxE\nUywgb3BlbkNiLCBudWxsKTsKICAgICAgICBNZXRhc3RvcmVDdXJzb3IgY3Vy\nc29yID0gb3BlbkNiLmdldFJlc3VsdCgpOwogICAgICAgIGxvZ2dlci5pbmZv\nKCJPcGVuIGN1cnNvciBmb3IgdGFibGUge30gdG8gY2xlYW4gZW50cmllcy4i\nLCB0YWJsZS5nZXROYW1lKCkpOwoKICAgICAgICBMaXN0PFN0cmluZz4ga2V5\nc1RvQ2xlYW4gPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4obnVtRW50cmllc1Bl\nclNjYW4pOwogICAgICAgIGludCBudW1FbnRyaWVzUmVtb3ZlZCA9IDA7CiAg\nICAgICAgd2hpbGUgKGN1cnNvci5oYXNNb3JlRW50cmllcygpKSB7CiAgICAg\nICAgICAgIGxvZ2dlci5pbmZvKCJGZXRjaGluZyBuZXh0IHt9IGVudHJpZXMg\nZnJvbSB0YWJsZSB7fSB0byBjbGVhbi4iLAogICAgICAgICAgICAgICAgICAg\nICAgICAgbnVtRW50cmllc1BlclNjYW4sIHRhYmxlLmdldE5hbWUoKSk7CiAg\nICAgICAgICAgIEl0ZXJhdG9yPE1ldGFzdG9yZVRhYmxlSXRlbT4gaXRlciA9\nIGN1cnNvci5yZWFkRW50cmllcyhudW1FbnRyaWVzUGVyU2Nhbik7CiAgICAg\nICAgICAgIGtleXNUb0NsZWFuLmNsZWFyKCk7CiAgICAgICAgICAgIHdoaWxl\nIChpdGVyLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgTWV0YXN0b3Jl\nVGFibGVJdGVtIGl0ZW0gPSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgICAg\nIFN0cmluZyBrZXkgPSBpdGVtLmdldEtleSgpOwogICAgICAgICAgICAgICAg\na2V5c1RvQ2xlYW4uYWRkKGtleSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgaWYgKGtleXNUb0NsZWFuLmlzRW1wdHkoKSkgewogICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxvZ2dl\nci5pbmZvKCJJc3N1aW5nIGRlbGV0ZXMgdG8gZGVsZXRlIGtleXMge30iLCBr\nZXlzVG9DbGVhbik7CiAgICAgICAgICAgIC8vIGlzc3VlIGRlbGV0ZXMgdG8g\nZGVsZXRlIGJhdGNoIG9mIGtleXMKICAgICAgICAgICAgTXVsdGlNZXRhc3Rv\ncmVDYWxsYmFjazxWb2lkPiBtY2IgPSBuZXcgTXVsdGlNZXRhc3RvcmVDYWxs\nYmFjazxWb2lkPihrZXlzVG9DbGVhbi5zaXplKCkpOwogICAgICAgICAgICBm\nb3IgKFN0cmluZyBrZXkgOiBrZXlzVG9DbGVhbikgewogICAgICAgICAgICAg\nICAgdGFibGUucmVtb3ZlKGtleSwgVmVyc2lvbi5BTlksIG1jYiwgbnVsbCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWNiLndhaXRVbnRpbEFsbEZp\nbmlzaGVkKCk7CiAgICAgICAgICAgIG51bUVudHJpZXNSZW1vdmVkICs9IGtl\neXNUb0NsZWFuLnNpemUoKTsKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlJl\nbW92ZWQge30gZW50cmllcyBmcm9tIHRhYmxlIHt9LiIsIG51bUVudHJpZXNS\nZW1vdmVkLCB0YWJsZS5nZXROYW1lKCkpOwogICAgICAgIH0KCiAgICAgICAg\nbG9nZ2VyLmluZm8oIkZpbmlzaGVkIGNsZWFuaW5nIHVwIHRhYmxlIHt9LiIs\nIHRhYmxlLmdldE5hbWUoKSk7CiAgICB9Cn0K\n","encoding":"base64"}

