{"sha":"5f616fc4f14376853d4b931b5b16566afc633118","node_id":"MDQ6QmxvYjE1NzU5NTY6NWY2MTZmYzRmMTQzNzY4NTNkNGI5MzFiNWIxNjU2NmFmYzYzMzExOA==","size":21692,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5f616fc4f14376853d4b931b5b16566afc633118","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5UaW1lVW5pdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4\nZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlNjaGVkdWxl\nZEV4ZWN1dG9yU2VydmljZTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50\nLlRocmVhZEZhY3Rvcnk7CgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFk\nZHJlc3M7CgppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3du\nTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRv\nbWljSW50ZWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29u\nZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyQWRtaW47CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckNoZWNr\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nckZyYWdtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwu\nU3RyaW5nVXRpbHM7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0\naWwuWmtVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci56b29r\nZWVwZXIuWm9vS2VlcGVyV2F0Y2hlckJhc2U7CgppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlck1hbmFnZXJGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2Vy\nTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxl\nZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNr\ncy5HZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLlByb2Nlc3Nv\ncjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb24u\nUmVwbGljYXRpb25FeGNlcHRpb24uQktBdWRpdEV4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlvbi5SZXBsaWNhdGlv\nbkV4Y2VwdGlvbi5Db21wYXRpYmlsaXR5RXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnJlcGxpY2F0aW9uLlJlcGxpY2F0aW9uRXhj\nZXB0aW9uLlVuYXZhaWxhYmxlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5jb21tb25zLmNvbGxlY3Rpb25zLkNvbGxlY3Rpb25VdGlsczsKaW1wb3J0\nIGNvbS5nb29nbGUuY29tbW9uLmNvbGxlY3QuU2V0czsKaW1wb3J0IG9yZy5h\ncGFjaGUuem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVudDsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLldhdGNoZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5B\nc3luY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0\nY2hlci5FdmVudC5FdmVudFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5XYXRjaGVyLkV2ZW50LktlZXBlclN0YXRlOwppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoK\nLyoqCiAqIEF1ZGl0b3IgaXMgYSBzaW5nbGUgZW50aXR5IGluIHRoZSBlbnRp\ncmUgQm9va2llIGNsdXN0ZXIgYW5kIHdpbGwgYmUgd2F0Y2hpbmcKICogYWxs\nIHRoZSBib29raWVzIHVuZGVyICdsZWRnZXJyb290cGF0aC9hdmFpbGFibGUn\nIHprcGF0aC4gV2hlbiBhbnkgb2YgdGhlCiAqIGJvb2tpZSBmYWlsZWQgb3Ig\nZGlzY29ubmVjdGVkIGZyb20gemssIGhlIHdpbGwgc3RhcnQgaW5pdGlhdGlu\nZyB0aGUKICogcmUtcmVwbGljYXRpb24gYWN0aXZpdGllcyBieSBrZWVwaW5n\nIGFsbCB0aGUgY29ycmVzcG9uZGluZyBsZWRnZXJzIG9mIHRoZQogKiBmYWls\nZWQgYm9va2llIGFzIHVuZGVycmVwbGljYXRlZCB6bm9kZSBpbiB6ay4KICov\nCnB1YmxpYyBjbGFzcyBBdWRpdG9yIGltcGxlbWVudHMgV2F0Y2hlciB7CiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoQXVkaXRvci5jbGFzcyk7CiAgICBwcml2YXRlIGZp\nbmFsIFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZjsKICAgIHByaXZhdGUgZmlu\nYWwgWm9vS2VlcGVyIHprYzsKICAgIHByaXZhdGUgQm9va2llTGVkZ2VySW5k\nZXhlciBib29raWVMZWRnZXJJbmRleGVyOwogICAgcHJpdmF0ZSBMZWRnZXJN\nYW5hZ2VyIGxlZGdlck1hbmFnZXI7CiAgICBwcml2YXRlIExlZGdlclVuZGVy\ncmVwbGljYXRpb25NYW5hZ2VyIGxlZGdlclVuZGVycmVwbGljYXRpb25NYW5h\nZ2VyOwogICAgcHJpdmF0ZSBmaW5hbCBTY2hlZHVsZWRFeGVjdXRvclNlcnZp\nY2UgZXhlY3V0b3I7CiAgICBwcml2YXRlIExpc3Q8U3RyaW5nPiBrbm93bkJv\nb2tpZXMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKCiAgICBwdWJsaWMg\nQXVkaXRvcihmaW5hbCBTdHJpbmcgYm9va2llSWRlbnRpZmllciwgU2VydmVy\nQ29uZmlndXJhdGlvbiBjb25mLAogICAgICAgICAgICAgICAgICAgWm9vS2Vl\ncGVyIHprYykgdGhyb3dzIFVuYXZhaWxhYmxlRXhjZXB0aW9uIHsKICAgICAg\nICB0aGlzLmNvbmYgPSBjb25mOwogICAgICAgIHRoaXMuemtjID0gemtjOwog\nICAgICAgIGluaXRpYWxpemUoY29uZiwgemtjKTsKCiAgICAgICAgZXhlY3V0\nb3IgPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhyZWFkU2NoZWR1bGVkRXhlY3V0\nb3IobmV3IFRocmVhZEZhY3RvcnkoKSB7CiAgICAgICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyBUaHJlYWQgbmV3VGhyZWFk\nKFJ1bm5hYmxlIHIpIHsKICAgICAgICAgICAgICAgICAgICBUaHJlYWQgdCA9\nIG5ldyBUaHJlYWQociwgIkF1ZGl0b3JCb29raWUtIiArIGJvb2tpZUlkZW50\naWZpZXIpOwogICAgICAgICAgICAgICAgICAgIHQuc2V0RGFlbW9uKHRydWUp\nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0OwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9KTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\naW5pdGlhbGl6ZShTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYsIFpvb0tlZXBl\nciB6a2MpCiAgICAgICAgICAgIHRocm93cyBVbmF2YWlsYWJsZUV4Y2VwdGlv\nbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGVkZ2VyTWFuYWdlckZh\nY3RvcnkgbGVkZ2VyTWFuYWdlckZhY3RvcnkgPSBMZWRnZXJNYW5hZ2VyRmFj\ndG9yeQogICAgICAgICAgICAgICAgICAgIC5uZXdMZWRnZXJNYW5hZ2VyRmFj\ndG9yeShjb25mLCB6a2MpOwogICAgICAgICAgICBsZWRnZXJNYW5hZ2VyID0g\nbGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlcigpOwogICAg\nICAgICAgICB0aGlzLmJvb2tpZUxlZGdlckluZGV4ZXIgPSBuZXcgQm9va2ll\nTGVkZ2VySW5kZXhlcihsZWRnZXJNYW5hZ2VyKTsKCiAgICAgICAgICAgIHRo\naXMubGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIgPSBsZWRnZXJNYW5h\nZ2VyRmFjdG9yeQogICAgICAgICAgICAgICAgICAgIC5uZXdMZWRnZXJVbmRl\ncnJlcGxpY2F0aW9uTWFuYWdlcigpOwoKICAgICAgICB9IGNhdGNoIChDb21w\nYXRpYmlsaXR5RXhjZXB0aW9uIGNlKSB7CiAgICAgICAgICAgIHRocm93IG5l\ndyBVbmF2YWlsYWJsZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAi\nQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbiB3aGlsZSBpbml0aWFsaXppbmcgQXVk\naXRvciIsIGNlKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2Up\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFVuYXZhaWxhYmxlRXhjZXB0aW9u\nKAogICAgICAgICAgICAgICAgICAgICJJT0V4Y2VwdGlvbiB3aGlsZSBpbml0\naWFsaXppbmcgQXVkaXRvciIsIGlvZSk7CiAgICAgICAgfSBjYXRjaCAoS2Vl\ncGVyRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVbmF2\nYWlsYWJsZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiS2VlcGVy\nRXhjZXB0aW9uIHdoaWxlIGluaXRpYWxpemluZyBBdWRpdG9yIiwga2UpOwog\nICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBVbmF2YWlsYWJsZUV4Y2VwdGlvbigKICAg\nICAgICAgICAgICAgICAgICAiSW50ZXJydXB0ZWQgd2hpbGUgaW5pdGlhbGl6\naW5nIEF1ZGl0b3IiLCBpZSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZh\ndGUgdm9pZCBzdWJtaXRTaHV0ZG93blRhc2soKSB7CiAgICAgICAgc3luY2hy\nb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIGlmIChleGVjdXRvci5pc1No\ndXRkb3duKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBleGVjdXRvci5zdWJtaXQobmV3IFJ1bm5hYmxl\nKCkgewogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgc3luY2hyb25pemVkIChBdWRpdG9y\nLnRoaXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dG9y\nLnNodXRkb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9\nCiAgICB9CgogICAgcHJpdmF0ZSBzeW5jaHJvbml6ZWQgdm9pZCBzdWJtaXRB\ndWRpdFRhc2soKSB7CiAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAg\nICAgICAgICAgIGlmIChleGVjdXRvci5pc1NodXRkb3duKCkpIHsKICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBl\neGVjdXRvci5zdWJtaXQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRJ\nZkxlZGdlclJlcGxpY2F0aW9uRGlzYWJsZWQoKTsKCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBMaXN0PFN0cmluZz4gYXZhaWxhYmxlQm9va2llcyA9\nIGdldEF2YWlsYWJsZUJvb2tpZXMoKTsKCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAvLyBjYXN0aW5nIHRvIFN0cmluZywgYXMga25vd25Cb29raWVz\nIGFuZCBhdmFpbGFibGVCb29raWVzCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAvLyBjb250YWlucyBvbmx5IFN0cmluZyB2YWx1ZXMKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIGZpbmQgbmV3IGJvb2tpZXMoaWYgYW55\nKSBhbmQgdXBkYXRlIHRoZSBrbm93biBib29raWUgbGlzdAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQ29sbGVjdGlvbjxTdHJpbmc+IG5ld0Jvb2tp\nZXMgPSBDb2xsZWN0aW9uVXRpbHMuc3VidHJhY3QoCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZUJvb2tpZXMsIGtub3du\nQm9va2llcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbm93bkJv\nb2tpZXMuYWRkQWxsKG5ld0Jvb2tpZXMpOwoKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIGZpbmQgbG9zdCBib29raWVzKGlmIGFueSkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIENvbGxlY3Rpb248U3RyaW5nPiBsb3N0\nQm9va2llcyA9IENvbGxlY3Rpb25VdGlscy5zdWJ0cmFjdCgKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAga25vd25Cb29raWVzLCBhdmFp\nbGFibGVCb29raWVzKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nZiAobG9zdEJvb2tpZXMuc2l6ZSgpID4gMCkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGtub3duQm9va2llcy5yZW1vdmVBbGwobG9zdEJv\nb2tpZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcDxT\ndHJpbmcsIFNldDxMb25nPj4gbGVkZ2VyRGV0YWlscyA9IGdlbmVyYXRlQm9v\na2llMkxlZGdlcnNJbmRleCgpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGhhbmRsZUxvc3RCb29raWVzKGxvc3RCb29raWVzLCBsZWRnZXJE\nZXRhaWxzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uIGtl\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkV4\nY2VwdGlvbiB3aGlsZSB3YXRjaGluZyBhdmFpbGFibGUgYm9va2llcyIsIGtl\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0\nZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkludGVycnVwdGVkIHdo\naWxlIHdhdGNoaW5nIGF2YWlsYWJsZSBib29raWVzICIsIGllKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoQktBdWRpdEV4Y2VwdGlvbiBi\na2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigi\nRXhjZXB0aW9uIHdoaWxlIHdhdGNoaW5nIGF2YWlsYWJsZSBib29raWVzIiwg\nYmtlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoVW5hdmFp\nbGFibGVFeGNlcHRpb24gdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIExPRy5lcnJvcigiRXhjZXB0aW9uIHdoaWxlIHdhdGNoaW5nIGF2YWls\nYWJsZSBib29raWVzIiwgdWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0KCkgewogICAg\nICAgIExPRy5pbmZvKCJJJ20gc3RhcnRpbmcgYXMgQXVkaXRvciBCb29raWUi\nKTsKICAgICAgICAvLyBvbiBzdGFydHVwIHdhdGNoaW5nIGF2YWlsYWJsZSBi\nb29raWUgYW5kIGJhc2VkIG9uIHRoZQogICAgICAgIC8vIGF2YWlsYWJsZSBi\nb29raWVzIGRldGVybWluaW5nIHRoZSBib29raWUgZmFpbHVyZXMuCiAgICAg\nICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIGlmIChleGVj\ndXRvci5pc1NodXRkb3duKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgbG9uZyBpbnRlcnZhbCA9IGNv\nbmYuZ2V0QXVkaXRvclBlcmlvZGljQ2hlY2tJbnRlcnZhbCgpOwogICAgICAg\nICAgICBpZiAoaW50ZXJ2YWwgPiAwKSB7CiAgICAgICAgICAgICAgICBMT0cu\naW5mbygiUGVyaW9kaWMgY2hlY2tpbmcgZW5hYmxlZCIpOwogICAgICAgICAg\nICAgICAgZXhlY3V0b3Iuc2NoZWR1bGVBdEZpeGVkUmF0ZShuZXcgUnVubmFi\nbGUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1\nbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJS\ndW5uaW5nIHBlcmlvZGljIGNoZWNrIik7CgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBpZiAoIWxlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyLmlzTGVkZ2Vy\nUmVwbGljYXRpb25FbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgTE9HLmluZm8oIkxlZGdlciByZXBsaWNhdGlvbiBk\naXNhYmxlZCwgc2tpcHBpbmciKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hl\nY2tBbGxMZWRnZXJzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9\nIGNhdGNoIChLZWVwZXJFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBy\ndW5uaW5nIHBlcmlvZGljIGNoZWNrIiwga2UpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIExPRy5lcnJvcigiSW50ZXJydXB0ZWQgd2hpbGUgcnVu\nbmluZyBwZXJpb2RpYyBjaGVjayIsIGllKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEJLQXVkaXRFeGNlcHRpb24gYmthZSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXhj\nZXB0aW9uIHdoaWxlIHJ1bm5pbmcgcGVyaW9kaWMgY2hlY2siLCBia2FlKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0\naW9uIGJrZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExP\nRy5lcnJvcigiRXhjZXB0aW9uIHJ1bm5pbmcgcGVyaW9kaWMgY2hlY2siLCBi\na2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoSU9F\neGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgTE9HLmVycm9yKCJJL08gZXhjZXB0aW9uIHJ1bm5pbmcgcGVyaW9kaWMg\nY2hlY2siLCBpb2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBj\nYXRjaCAoUmVwbGljYXRpb25FeGNlcHRpb24uVW5hdmFpbGFibGVFeGNlcHRp\nb24gdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cu\nZXJyb3IoIlVuZGVycmVwbGljYXRpb24gbWFuYWdlciB1bmF2YWlsYWJsZSAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsi\ncnVubmluZyBwZXJpb2RpYyBjaGVjayIsIHVlKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgIH0sIGludGVydmFsLCBpbnRlcnZhbCwgVGltZVVu\naXQuTUlMTElTRUNPTkRTKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgIExPRy5pbmZvKCJQZXJpb2RpYyBjaGVja2luZyBkaXNhYmxl\nZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBleGVjdXRvci5zdWJt\naXQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtub3duQm9va2llcyA9IGdl\ndEF2YWlsYWJsZUJvb2tpZXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGF1ZGl0aW5nQm9va2llcyhrbm93bkJvb2tpZXMpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9IGNhdGNoIChLZWVwZXJFeGNlcHRpb24ga2UpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0\naW9uIHdoaWxlIHdhdGNoaW5nIGF2YWlsYWJsZSBib29raWVzIiwga2UpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0U2h1dGRvd25UYXNr\nKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVw\ndGVkRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1cHRlZCB3\naGlsZSB3YXRjaGluZyBhdmFpbGFibGUgYm9va2llcyAiLCBpZSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRTaHV0ZG93blRhc2soKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoQktBdWRpdEV4Y2Vw\ndGlvbiBia2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5l\ncnJvcigiRXhjZXB0aW9uIHdoaWxlIHdhdGNoaW5nIGF2YWlsYWJsZSBib29r\naWVzIiwgYmtlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1p\ndFNodXRkb3duVGFzaygpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCB3YWl0SWZMZWRnZXJSZXBs\naWNhdGlvbkRpc2FibGVkKCkgdGhyb3dzIFVuYXZhaWxhYmxlRXhjZXB0aW9u\nLAogICAgICAgICAgICBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAg\nUmVwbGljYXRpb25FbmFibGVDYiBjYiA9IG5ldyBSZXBsaWNhdGlvbkVuYWJs\nZUNiKCk7CiAgICAgICAgaWYgKCFsZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFu\nYWdlci5pc0xlZGdlclJlcGxpY2F0aW9uRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgIGxlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyLm5vdGlmeUxlZGdl\nclJlcGxpY2F0aW9uRW5hYmxlZChjYik7CiAgICAgICAgICAgIGNiLmF3YWl0\nKCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIExpc3Q8U3Ry\naW5nPiBnZXRBdmFpbGFibGVCb29raWVzKCkgdGhyb3dzIEtlZXBlckV4Y2Vw\ndGlvbiwKICAgICAgICAgICAgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAg\nICAgIHJldHVybiB6a2MuZ2V0Q2hpbGRyZW4oY29uZi5nZXRaa0F2YWlsYWJs\nZUJvb2tpZXNQYXRoKCksIHRoaXMpOwogICAgfQoKICAgIHByaXZhdGUgdm9p\nZCBhdWRpdGluZ0Jvb2tpZXMoTGlzdDxTdHJpbmc+IGF2YWlsYWJsZUJvb2tp\nZXMpCiAgICAgICAgICAgIHRocm93cyBCS0F1ZGl0RXhjZXB0aW9uLCBLZWVw\nZXJFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uIHsKCiAgICAgICAg\nTWFwPFN0cmluZywgU2V0PExvbmc+PiBsZWRnZXJEZXRhaWxzID0gZ2VuZXJh\ndGVCb29raWUyTGVkZ2Vyc0luZGV4KCk7CgogICAgICAgIC8vIGZpbmQgbG9z\ndCBib29raWVzCiAgICAgICAgU2V0PFN0cmluZz4ga25vd25Cb29raWVzID0g\nbGVkZ2VyRGV0YWlscy5rZXlTZXQoKTsKICAgICAgICBDb2xsZWN0aW9uPFN0\ncmluZz4gbG9zdEJvb2tpZXMgPSBDb2xsZWN0aW9uVXRpbHMuc3VidHJhY3Qo\na25vd25Cb29raWVzLAogICAgICAgICAgICAgICAgYXZhaWxhYmxlQm9va2ll\ncyk7CgogICAgICAgIGlmIChsb3N0Qm9va2llcy5zaXplKCkgPiAwKQogICAg\nICAgICAgICBoYW5kbGVMb3N0Qm9va2llcyhsb3N0Qm9va2llcywgbGVkZ2Vy\nRGV0YWlscyk7CiAgICB9CgogICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTZXQ8\nTG9uZz4+IGdlbmVyYXRlQm9va2llMkxlZGdlcnNJbmRleCgpCiAgICAgICAg\nICAgIHRocm93cyBCS0F1ZGl0RXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4g\nYm9va2llTGVkZ2VySW5kZXhlci5nZXRCb29raWVUb0xlZGdlckluZGV4KCk7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGhhbmRsZUxvc3RCb29raWVzKENv\nbGxlY3Rpb248U3RyaW5nPiBsb3N0Qm9va2llcywKICAgICAgICAgICAgTWFw\nPFN0cmluZywgU2V0PExvbmc+PiBsZWRnZXJEZXRhaWxzKSB0aHJvd3MgQktB\ndWRpdEV4Y2VwdGlvbiwKICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uLCBJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgTE9HLmluZm8oIkZvbGxv\nd2luZyBhcmUgdGhlIGZhaWxlZCBib29raWVzOiAiICsgbG9zdEJvb2tpZXMK\nICAgICAgICAgICAgICAgICsgIiBhbmQgc2VhcmNoaW5nIGl0cyBsZWRnZXJz\nIGZvciByZS1yZXBsaWNhdGlvbiIpOwoKICAgICAgICBmb3IgKFN0cmluZyBi\nb29raWVJUCA6IGxvc3RCb29raWVzKSB7CiAgICAgICAgICAgIC8vIGlkZW50\naWZ5IGFsbCB0aGUgbGVkZ2VycyBpbiBib29raWVJUCBhbmQgcHVibGlzaGlu\nZyB0aGVzZSBsZWRnZXJzCiAgICAgICAgICAgIC8vIGFzIHVuZGVyLXJlcGxp\nY2F0ZWQuCiAgICAgICAgICAgIHB1Ymxpc2hTdXNwZWN0ZWRMZWRnZXJzKGJv\nb2tpZUlQLCBsZWRnZXJEZXRhaWxzLmdldChib29raWVJUCkpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgcHVibGlzaFN1c3BlY3RlZExl\nZGdlcnMoU3RyaW5nIGJvb2tpZUlQLCBTZXQ8TG9uZz4gbGVkZ2VycykKICAg\nICAgICAgICAgdGhyb3dzIEtlZXBlckV4Y2VwdGlvbiwgSW50ZXJydXB0ZWRF\neGNlcHRpb24sIEJLQXVkaXRFeGNlcHRpb24gewogICAgICAgIGlmIChudWxs\nID09IGxlZGdlcnMgfHwgbGVkZ2Vycy5zaXplKCkgPT0gMCkgewogICAgICAg\nICAgICAvLyB0aGVyZSBpcyBubyBsZWRnZXJzIGF2YWlsYWJsZSBmb3IgdGhp\ncyBib29raWUgYW5kIGp1c3QKICAgICAgICAgICAgLy8gaWdub3JpbmcgdGhl\nIGJvb2tpZSBmYWlsdXJlcwogICAgICAgICAgICBMT0cuaW5mbygiVGhlcmUg\naXMgbm8gbGVkZ2VycyBmb3IgdGhlIGZhaWxlZCBib29raWU6ICIgKyBib29r\naWVJUCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAg\nTE9HLmluZm8oIkZvbGxvd2luZyBsZWRnZXJzOiAiICsgbGVkZ2VycyArICIg\nb2YgYm9va2llOiAiICsgYm9va2llSVAKICAgICAgICAgICAgICAgICsgIiBh\ncmUgaWRlbnRpZmllZCBhcyB1bmRlcnJlcGxpY2F0ZWQiKTsKICAgICAgICBm\nb3IgKExvbmcgbGVkZ2VySWQgOiBsZWRnZXJzKSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBsZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFu\nYWdlci5tYXJrTGVkZ2VyVW5kZXJyZXBsaWNhdGVkKAogICAgICAgICAgICAg\nICAgICAgICAgICBsZWRnZXJJZCwgYm9va2llSVApOwogICAgICAgICAgICB9\nIGNhdGNoIChVbmF2YWlsYWJsZUV4Y2VwdGlvbiB1ZSkgewogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IEJLQXVkaXRFeGNlcHRpb24oCiAgICAgICAgICAg\nICAgICAgICAgICAgICJGYWlsZWQgdG8gcHVibGlzaCB1bmRlcnJlcGxpY2F0\nZWQgbGVkZ2VyOiAiICsgbGVkZ2VySWQKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArICIgb2YgYm9va2llOiAiICsgYm9va2llSVAsIHVlKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFByb2Nlc3MgdGhlIHJlc3VsdCByZXR1cm5lZCBmcm9tIGNoZWNraW5nIGEg\nbGVkZ2VyCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgUHJvY2Vzc0xvc3RG\ncmFnbWVudHNDYiBpbXBsZW1lbnRzIEdlbmVyaWNDYWxsYmFjazxTZXQ8TGVk\nZ2VyRnJhZ21lbnQ+PiB7CiAgICAgICAgZmluYWwgTGVkZ2VySGFuZGxlIGxo\nOwogICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGNh\nbGxiYWNrOwoKICAgICAgICBQcm9jZXNzTG9zdEZyYWdtZW50c0NiKExlZGdl\nckhhbmRsZSBsaCwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sgY2FsbGJh\nY2spIHsKICAgICAgICAgICAgdGhpcy5saCA9IGxoOwogICAgICAgICAgICB0\naGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIFNldDxMZWRn\nZXJGcmFnbWVudD4gZnJhZ21lbnRzKSB7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29kZS5PSykg\newogICAgICAgICAgICAgICAgICAgIFNldDxJbmV0U29ja2V0QWRkcmVzcz4g\nYm9va2llcyA9IFNldHMubmV3SGFzaFNldCgpOwogICAgICAgICAgICAgICAg\nICAgIGZvciAoTGVkZ2VyRnJhZ21lbnQgZiA6IGZyYWdtZW50cykgewogICAg\nICAgICAgICAgICAgICAgICAgICBib29raWVzLmFkZChmLmdldEFkZHJlc3Mo\nKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIGZvciAoSW5ldFNvY2tldEFkZHJlc3MgYm9va2llIDogYm9va2llcykgewog\nICAgICAgICAgICAgICAgICAgICAgICBwdWJsaXNoU3VzcGVjdGVkTGVkZ2Vy\ncyhTdHJpbmdVdGlscy5hZGRyVG9TdHJpbmcoYm9va2llKSwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0cy5u\nZXdIYXNoU2V0KGxoLmdldElkKCkpKTsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsaC5jbG9zZSgp\nOwogICAgICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbiBia2UpIHsKICAg\nICAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3IgY2xvc2luZyBsaCIsIGJr\nZSk7CiAgICAgICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29k\nZS5PSykgewogICAgICAgICAgICAgICAgICAgIHJjID0gQktFeGNlcHRpb24u\nQ29kZS5aS0V4Y2VwdGlvbjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAg\nICAgICBMT0cuZXJyb3IoIkNvdWxkbid0IHB1Ymxpc2ggc3VzcGVjdGVkIGxl\nZGdlciIsIGtlKTsKICAgICAgICAgICAgICAgIGlmIChyYyA9PSBCS0V4Y2Vw\ndGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgICAgICAgICAgcmMgPSBCS0V4\nY2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkg\newogICAgICAgICAgICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1cHRlZCBwdWJs\naXNoaW5nIHN1c3BlY3RlZCBsZWRnZXIiLCBpZSk7CiAgICAgICAgICAgICAg\nICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAg\nICAgICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAg\nICAgICAgICAgICAgICAgICByYyA9IEJLRXhjZXB0aW9uLkNvZGUuSW50ZXJy\ndXB0ZWRFeGNlcHRpb247CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEJLQXVkaXRFeGNlcHRpb24gYmthZSkgewogICAgICAgICAg\nICAgICAgTE9HLmVycm9yKCJBdWRpdG9yIGV4Y2VwdGlvbiBwdWJsaXNoaW5n\nIHN1c3BlY3RlZCBsZWRnZXIiLCBia2FlKTsKICAgICAgICAgICAgICAgIGlm\nIChyYyA9PSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgICAg\nICAgICAgcmMgPSBCS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBjYWxs\nYmFjay5wcm9jZXNzUmVzdWx0KHJjLCBudWxsLCBudWxsKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBMaXN0IGFsbCB0aGUgbGVkZ2VycyBh\nbmQgY2hlY2sgdGhlbSBpbmRpdmlkdWFsbHkuIFRoaXMgc2hvdWxkIG5vdAog\nICAgICogYmUgcnVuIHZlcnkgb2Z0ZW4uCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBjaGVja0FsbExlZGdlcnMoKSB0aHJvd3MgQktBdWRpdEV4Y2VwdGlv\nbiwgQktFeGNlcHRpb24sCiAgICAgICAgICAgIElPRXhjZXB0aW9uLCBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiwgS2VlcGVyRXhjZXB0aW9uIHsKICAgICAgICBa\nb29LZWVwZXJXYXRjaGVyQmFzZSB3ID0gbmV3IFpvb0tlZXBlcldhdGNoZXJC\nYXNlKGNvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAgIFpvb0tlZXBlciBu\nZXd6ayA9IFprVXRpbHMuY3JlYXRlQ29ubmVjdGVkWm9va2VlcGVyQ2xpZW50\nKGNvbmYuZ2V0WmtTZXJ2ZXJzKCksIHcpOwoKICAgICAgICBmaW5hbCBCb29r\nS2VlcGVyIGNsaWVudCA9IG5ldyBCb29rS2VlcGVyKG5ldyBDbGllbnRDb25m\naWd1cmF0aW9uKGNvbmYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgbmV3emspOwogICAgICAgIGZpbmFsIEJv\nb2tLZWVwZXJBZG1pbiBhZG1pbiA9IG5ldyBCb29rS2VlcGVyQWRtaW4oY2xp\nZW50KTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmluYWwgTGVkZ2Vy\nQ2hlY2tlciBjaGVja2VyID0gbmV3IExlZGdlckNoZWNrZXIoY2xpZW50KTsK\nCiAgICAgICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIgcmV0dXJuQ29kZSA9\nIG5ldyBBdG9taWNJbnRlZ2VyKEJLRXhjZXB0aW9uLkNvZGUuT0spOwogICAg\nICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBwcm9jZXNzRG9uZSA9IG5l\ndyBDb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgICAgIFByb2Nlc3NvcjxM\nb25nPiBjaGVja0xlZGdlcnNQcm9jZXNzb3IgPSBuZXcgUHJvY2Vzc29yPExv\nbmc+KCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKGZpbmFsIExvbmcgbGVkZ2VySWQs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIEFz\neW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGNhbGxiYWNrKSB7CiAgICAgICAg\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKCFsZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlci5pc0xlZGdlclJlcGxp\nY2F0aW9uRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBMT0cuaW5mbygiTGVkZ2VyIHJlcmVwbGljYXRpb24gaGFzIGJlZW4gZGlz\nYWJsZWQsIGFib3J0aW5nIHBlcmlvZGljIGNoZWNrIik7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBwcm9jZXNzRG9uZS5jb3VudERvd24oKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFJl\ncGxpY2F0aW9uRXhjZXB0aW9uLlVuYXZhaWxhYmxlRXhjZXB0aW9uIHVlKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiVW5kZXJyZXBs\naWNhdGlvbiBtYW5hZ2VyIHVuYXZhaWxhYmxlICIKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsicnVubmluZyBwZXJpb2RpYyBjaGVjayIs\nIHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0RvbmUuY291\nbnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIExlZGdl\nckhhbmRsZSBsaCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICAgICAgbGggPSBhZG1pbi5vcGVuTGVkZ2Vy\nTm9SZWNvdmVyeShsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGNoZWNrZXIuY2hlY2tMZWRnZXIobGgsIG5ldyBQcm9jZXNzTG9zdEZyYWdt\nZW50c0NiKGxoLCBjYWxsYmFjaykpOwogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEJLRXhjZXB0aW9uIGJrZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBMT0cuZXJyb3IoIkNvdWxkbid0IG9wZW4gbGVkZ2VyICIgKyBsZWRn\nZXJJZCwgYmtlKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2su\ncHJvY2Vzc1Jlc3VsdChCS0V4Y2VwdGlvbi5Db2RlLkJvb2tpZUhhbmRsZU5v\ndEF2YWlsYWJsZUV4Y2VwdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBudWxsLCBudWxsKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiSW50ZXJydXB0ZWQgb3BlbmluZyBsZWRnZXIi\nLCBpZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50\nVGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGNhbGxiYWNrLnByb2Nlc3NSZXN1bHQoQktFeGNlcHRpb24uQ29kZS5JbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiwgbnVsbCwgbnVsbCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobGggIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBsaC5jbG9zZSgpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24gYmtlKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLndhcm4oIkNv\ndWxkbid0IGNsb3NlIGxlZGdlciAiICsgbGVkZ2VySWQsIGJrZSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy53YXJuKCJJbnRlcnJ1cHRlZCBjbG9zaW5nIGxlZGdlciAiICsgbGVk\nZ2VySWQsIGllKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9OwoKICAgICAgICAgICAgbGVkZ2VyTWFuYWdlci5hc3luY1By\nb2Nlc3NMZWRnZXJzKGNoZWNrTGVkZ2Vyc1Byb2Nlc3NvciwKICAgICAgICAg\nICAgICAgICAgICBuZXcgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2soKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCBy\nYywgU3RyaW5nIHMsIE9iamVjdCBvYmopIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybkNvZGUuc2V0KHJjKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHByb2Nlc3NEb25lLmNvdW50RG93bigpOwogICAgICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwgbnVs\nbCwgQktFeGNlcHRpb24uQ29kZS5PSywgQktFeGNlcHRpb24uQ29kZS5SZWFk\nRXhjZXB0aW9uKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIHByb2Nlc3NEb25lLmF3YWl0KCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElu\ndGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIFRocmVh\nZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgQktBdWRpdEV4Y2VwdGlvbigKICAgICAgICAgICAgICAg\nICAgICAgICAgIkV4Y2VwdGlvbiB3aGlsZSBjaGVja2luZyBsZWRnZXJzIiwg\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJldHVybkNvZGUu\nZ2V0KCkgIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAgICAg\nICAgdGhyb3cgQktFeGNlcHRpb24uY3JlYXRlKHJldHVybkNvZGUuZ2V0KCkp\nOwogICAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgYWRtaW4uY2xvc2UoKTsKICAgICAgICAgICAgY2xpZW50LmNsb3NlKCk7\nCiAgICAgICAgICAgIG5ld3prLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVk\nRXZlbnQgZXZlbnQpIHsKICAgICAgICAvLyBsaXN0ZW4gY2hpbGRyZW4gY2hh\nbmdlZCBldmVudCBmcm9tIFpvb0tlZXBlcgogICAgICAgIGlmIChldmVudC5n\nZXRTdGF0ZSgpID09IEtlZXBlclN0YXRlLkRpc2Nvbm5lY3RlZAogICAgICAg\nICAgICAgICAgfHwgZXZlbnQuZ2V0U3RhdGUoKSA9PSBLZWVwZXJTdGF0ZS5F\neHBpcmVkKSB7CiAgICAgICAgICAgIHN1Ym1pdFNodXRkb3duVGFzaygpOwog\nICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuZ2V0VHlwZSgpID09IEV2ZW50VHlw\nZS5Ob2RlQ2hpbGRyZW5DaGFuZ2VkKSB7CiAgICAgICAgICAgIHN1Ym1pdEF1\nZGl0VGFzaygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNo\ndXRkb3duIHRoZSBhdWRpdG9yCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNo\ndXRkb3duKCkgewogICAgICAgIExPRy5pbmZvKCJTaHV0dGluZyBkb3duIGF1\nZGl0b3IiKTsKICAgICAgICBzdWJtaXRTaHV0ZG93blRhc2soKTsKCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgd2hpbGUgKCFleGVjdXRvci5hd2FpdFRl\ncm1pbmF0aW9uKDMwLCBUaW1lVW5pdC5TRUNPTkRTKSkgewogICAgICAgICAg\nICAgICAgTE9HLndhcm4oIkV4ZWN1dG9yIG5vdCBzaHV0dGluZyBkb3duLCBp\nbnRlcnJ1cHRpbmciKTsKICAgICAgICAgICAgICAgIGV4ZWN1dG9yLnNodXRk\nb3duTm93KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICBUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAgICBMT0cud2Fy\nbigiSW50ZXJydXB0ZWQgd2hpbGUgc2h1dHRpbmcgZG93biBhdWRpdG9yIGJv\nb2tpZSIsIGllKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdHJ1ZSBpZiBhdWRpdG9yIGlzIHJ1bm5pbmcgb3RoZXJ3aXNlIHJl\ndHVybiBmYWxzZQogICAgICogCiAgICAgKiBAcmV0dXJuIGF1ZGl0b3Igc3Rh\ndHVzCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzUnVubmluZygpIHsK\nICAgICAgICByZXR1cm4gIWV4ZWN1dG9yLmlzU2h1dGRvd24oKTsKICAgIH0K\nfQo=\n","encoding":"base64"}

