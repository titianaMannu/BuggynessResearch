{"sha":"f4bb2d09745ee8ee1c732f2ebb16be5b58f23e0b","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjRiYjJkMDk3NDVlZThlZTFjNzMyZjJlYmIxNmJlNWI1OGYyM2UwYg==","size":5907,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f4bb2d09745ee8ee1c732f2ebb16be5b58f23e0b","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb247CgppbXBv\ncnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwpp\nbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hN\nYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRj\naDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5M\nZWRnZXJNZXRhZGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5t\nZXRhLkxlZGdlck1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWND\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuUHJvY2Vzc29yOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnJlcGxpY2F0aW9uLlJlcGxpY2F0aW9u\nRXhjZXB0aW9uLkJLQXVkaXRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIudXRpbC5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLkFzeW5jQ2FsbGJhY2s7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioK\nICogUHJlcGFyaW5nIGJvb2tpZSB2cyBpdHMgY29ycmVzcG9uZGluZyBsZWRn\nZXJzLiBUaGlzIHdpbGwgYWx3YXlzIGxvb2sgdXAgdGhlCiAqIGxlZGdlcm1h\nbmFnZXIgZm9yIGxlZGdlciBtZXRhZGF0YSBhbmQgd2lsbCBnZW5lcmF0ZSBp\nbmRleGVzLgogKi8KcHVibGljIGNsYXNzIEJvb2tpZUxlZGdlckluZGV4ZXIg\newoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dn\nZXJGYWN0b3J5LmdldExvZ2dlcihCb29raWVMZWRnZXJJbmRleGVyLmNsYXNz\nKTsKICAgIHByaXZhdGUgZmluYWwgTGVkZ2VyTWFuYWdlciBsZWRnZXJNYW5h\nZ2VyOwoKICAgIHB1YmxpYyBCb29raWVMZWRnZXJJbmRleGVyKExlZGdlck1h\nbmFnZXIgbGVkZ2VyTWFuYWdlcikgewogICAgICAgIHRoaXMubGVkZ2VyTWFu\nYWdlciA9IGxlZGdlck1hbmFnZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBH\nZW5lcmF0aW5nIGJvb2tpZSB2cyBpdHMgbGVkZ2VycyBtYXAgYnkgcmVhZGlu\nZyBhbGwgdGhlIGxlZGdlcnMgaW4gZWFjaAogICAgICogYm9va2llIGFuZCBw\nYXJzaW5nIGl0cyBtZXRhZGF0YS4KICAgICAqIAogICAgICogQHJldHVybiBi\nb29raWUybGVkZ2Vyc01hcCBtYXAgb2YgYm9va2llIHZzIGxlZGdlcnMKICAg\nICAqIEB0aHJvd3MgQktBdWRpdEV4Y2VwdGlvbgogICAgICogICAgICAgICAg\nICAgZXhjZXB0aW9uIHdoaWxlIGdldHRpbmcgYm9va2llLWxlZGdlcnMKICAg\nICAqLwogICAgcHVibGljIE1hcDxTdHJpbmcsIFNldDxMb25nPj4gZ2V0Qm9v\na2llVG9MZWRnZXJJbmRleCgpCiAgICAgICAgICAgIHRocm93cyBCS0F1ZGl0\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBib29raWUgdnMgbGVkZ2VycyBtYXAK\nICAgICAgICBmaW5hbCBDb25jdXJyZW50SGFzaE1hcDxTdHJpbmcsIFNldDxM\nb25nPj4gYm9va2llMmxlZGdlcnNNYXAKICAgICAgICAgICAgPSBuZXcgQ29u\nY3VycmVudEhhc2hNYXA8U3RyaW5nLCBTZXQ8TG9uZz4+KCk7CiAgICAgICAg\nZmluYWwgQ291bnREb3duTGF0Y2ggbGVkZ2VyQ29sbGVjdG9yTGF0Y2ggPSBu\nZXcgQ291bnREb3duTGF0Y2goMSk7CgogICAgICAgIFByb2Nlc3NvcjxMb25n\nPiBsZWRnZXJQcm9jZXNzb3IgPSBuZXcgUHJvY2Vzc29yPExvbmc+KCkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\ncHJvY2VzcyhmaW5hbCBMb25nIGxlZGdlcklkLAogICAgICAgICAgICAgICAg\nICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGl0ZXJDYWxs\nYmFjaykgewogICAgICAgICAgICAgICAgR2VuZXJpY0NhbGxiYWNrPExlZGdl\nck1ldGFkYXRhPiBnZW5lcmljQ2FsbGJhY2sgPSBuZXcgR2VuZXJpY0NhbGxi\nYWNrPExlZGdlck1ldGFkYXRhPigpIHsKICAgICAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25Db21wbGV0ZShmaW5hbCBpbnQgcmMsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBMZWRnZXJNZXRhZGF0YSBsZWRnZXJNZXRhZGF0YSkgewog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24u\nQ29kZS5PSykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChN\nYXAuRW50cnk8TG9uZywgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPj4g\nZW5zZW1ibGUgOiBsZWRnZXJNZXRhZGF0YQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAuZ2V0RW5zZW1ibGVzKCkuZW50cnlTZXQoKSkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoSW5ldFNv\nY2tldEFkZHJlc3MgYm9va2llIDogZW5zZW1ibGUKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRWYWx1ZSgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1dExlZGdlcihib29r\naWUybGVkZ2Vyc01hcCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIFN0cmluZ1V0aWxzLmFkZHJUb1N0cmluZyhib29r\naWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbGVkZ2VySWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIExPRy53YXJuKCJVbmFibGUgdG8gcmVhZCB0aGUgbGVkZ2VyOiIg\nKyBsZWRnZXJJZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICArICIgaW5mb3JtYXRpb24iKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgICAgICBpdGVyQ2FsbGJhY2sucHJvY2Vz\nc1Jlc3VsdChyYywgbnVsbCwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGxlZGdlck1h\nbmFnZXIucmVhZExlZGdlck1ldGFkYXRhKGxlZGdlcklkLCBnZW5lcmljQ2Fs\nbGJhY2spOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICAvLyBS\nZWFkaW5nIHRoZSByZXN1bHQgYWZ0ZXIgcHJvY2Vzc2luZyBhbGwgdGhlIGxl\nZGdlcnMKICAgICAgICBmaW5hbCBMaXN0PEludGVnZXI+IHJlc3VsdENvZGUg\nPSBuZXcgQXJyYXlMaXN0PEludGVnZXI+KDEpOwogICAgICAgIGxlZGdlck1h\nbmFnZXIuYXN5bmNQcm9jZXNzTGVkZ2VycyhsZWRnZXJQcm9jZXNzb3IsCiAg\nICAgICAgICAgICAgICBuZXcgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2so\nKSB7CgogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBT\ndHJpbmcgcywgT2JqZWN0IG9iaikgewogICAgICAgICAgICAgICAgICAgICAg\nICByZXN1bHRDb2RlLmFkZChyYyk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGxlZGdlckNvbGxlY3RvckxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIG51bGwsIEJLRXhjZXB0\naW9uLkNvZGUuT0ssIEJLRXhjZXB0aW9uLkNvZGUuUmVhZEV4Y2VwdGlvbik7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGVkZ2VyQ29sbGVjdG9yTGF0\nY2guYXdhaXQoKTsKICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCku\naW50ZXJydXB0KCk7CiAgICAgICAgICAgIHRocm93IG5ldyBCS0F1ZGl0RXhj\nZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICJFeGNlcHRpb24gd2hpbGUg\nZ2V0dGluZyB0aGUgYm9va2llLWxlZGdlcnMiLCBlKTsKICAgICAgICB9CiAg\nICAgICAgaWYgKCFyZXN1bHRDb2RlLmNvbnRhaW5zKEJLRXhjZXB0aW9uLkNv\nZGUuT0spKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBCS0F1ZGl0RXhjZXB0\naW9uKAogICAgICAgICAgICAgICAgICAgICJFeGNlcHRpb24gd2hpbGUgZ2V0\ndGluZyB0aGUgYm9va2llLWxlZGdlcnMiLCBCS0V4Y2VwdGlvbgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZShyZXN1bHRDb2RlLmdldCgw\nKSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYm9va2llMmxlZGdlcnNN\nYXA7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHB1dExlZGdlcihDb25jdXJy\nZW50SGFzaE1hcDxTdHJpbmcsIFNldDxMb25nPj4gYm9va2llMmxlZGdlcnNN\nYXAsCiAgICAgICAgICAgIFN0cmluZyBib29raWUsIGxvbmcgbGVkZ2VySWQp\nIHsKICAgICAgICBTZXQ8TG9uZz4gbGVkZ2VycyA9IGJvb2tpZTJsZWRnZXJz\nTWFwLmdldChib29raWUpOwogICAgICAgIC8vIGNyZWF0ZXMgYW4gZW1wdHkg\nbGlzdCBhbmQgYWRkIHRvIGJvb2tpZSBmb3Iga2VlcGluZyBpdHMgbGVkZ2Vy\ncwogICAgICAgIGlmIChsZWRnZXJzID09IG51bGwpIHsKICAgICAgICAgICAg\nbGVkZ2VycyA9IENvbGxlY3Rpb25zLnN5bmNocm9uaXplZFNldChuZXcgSGFz\naFNldDxMb25nPigpKTsKICAgICAgICAgICAgU2V0PExvbmc+IG9sZExlZGdl\ncnMgPSBib29raWUybGVkZ2Vyc01hcC5wdXRJZkFic2VudChib29raWUsIGxl\nZGdlcnMpOwogICAgICAgICAgICBpZiAob2xkTGVkZ2VycyAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBsZWRnZXJzID0gb2xkTGVkZ2VyczsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICBsZWRnZXJzLmFkZChsZWRnZXJJ\nZCk7CiAgICB9Cn0K\n","encoding":"base64"}

