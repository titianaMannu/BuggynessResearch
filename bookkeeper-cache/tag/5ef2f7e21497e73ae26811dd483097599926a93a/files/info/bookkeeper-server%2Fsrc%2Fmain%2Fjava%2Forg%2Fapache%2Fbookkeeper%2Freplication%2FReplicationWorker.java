{"sha":"4a0bd229161749843a70bf54772f6649e31192a2","node_id":"MDQ6QmxvYjE1NzU5NTY6NGEwYmQyMjkxNjE3NDk4NDNhNzBiZjU0NzcyZjY2NDllMzExOTJhMg==","size":14411,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/4a0bd229161749843a70bf54772f6649e31192a2","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZSAKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24gCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUgCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UgCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQgCiAqIAogKiAgIGh0dHA6Ly93\nd3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMCAKICogCiAqIFVu\nbGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8g\naW4gd3JpdGluZywgCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRo\nZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIAogKiAiQVMgSVMiIEJB\nU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkg\nCiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhl\nIExpY2Vuc2UgZm9yIHRoZSAKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJu\naW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyAKICogdW5kZXIgdGhl\nIExpY2Vuc2UuIAogKiAKICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnJlcGxpY2F0aW9uOwoKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247\nCmltcG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0QWRkcmVzczsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGph\ndmEudXRpbC5UaW1lcjsKaW1wb3J0IGphdmEudXRpbC5UaW1lclRhc2s7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2Vl\ncGVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29r\nS2VlcGVyQWRtaW47CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xp\nZW50LkxlZGdlckNoZWNrZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY2xpZW50LkxlZGdlckZyYWdtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uLkJLQm9va2llSGFu\nZGxlTm90QXZhaWxhYmxlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbi5CS05vU3VjaExlZGdlckV4\naXN0c0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nbGllbnQuQktFeGNlcHRpb24uQktSZWFkRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZp\nZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YS5M\nZWRnZXJNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5tZXRhLkxlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRl\ncm5hbENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb24uUmVwbGljYXRpb25FeGNlcHRp\nb24uQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5yZXBsaWNhdGlvbi5SZXBsaWNhdGlvbkV4Y2VwdGlvbi5V\nbmF2YWlsYWJsZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9y\ndCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCi8qKgogKiBSZXBsaWNhdGlv\nbldvcmtlciB3aWxsIHRha2UgdGhlIGZyYWdtZW50cyBvbmUgYnkgb25lIGZy\nb20KICogWktMZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlciBhbmQgcmVw\nbGljYXRlcyB0byBpdC4KICovCnB1YmxpYyBjbGFzcyBSZXBsaWNhdGlvbldv\ncmtlciBpbXBsZW1lbnRzIFJ1bm5hYmxlIHsKICAgIHByaXZhdGUgc3RhdGlj\nIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5CiAgICAgICAgICAgIC5nZXRM\nb2dnZXIoUmVwbGljYXRpb25Xb3JrZXIuY2xhc3MpOwogICAgZmluYWwgcHJp\ndmF0ZSBMZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlciB1bmRlcnJlcGxp\nY2F0aW9uTWFuYWdlcjsKICAgIHByaXZhdGUgU2VydmVyQ29uZmlndXJhdGlv\nbiBjb25mOwogICAgcHJpdmF0ZSBab29LZWVwZXIgemtjOwogICAgcHJpdmF0\nZSB2b2xhdGlsZSBib29sZWFuIHdvcmtlclJ1bm5pbmcgPSBmYWxzZTsKICAg\nIGZpbmFsIHByaXZhdGUgQm9va0tlZXBlckFkbWluIGFkbWluOwogICAgcHJp\ndmF0ZSBMZWRnZXJDaGVja2VyIGxlZGdlckNoZWNrZXI7CiAgICBwcml2YXRl\nIEluZXRTb2NrZXRBZGRyZXNzIHRhcmdldEJvb2tpZTsKICAgIHByaXZhdGUg\nQm9va0tlZXBlciBia2M7CiAgICBwcml2YXRlIFRocmVhZCB3b3JrZXJUaHJl\nYWQ7CiAgICBwcml2YXRlIGxvbmcgb3BlbkxlZGdlclJlcmVwbGljYXRpb25H\ncmFjZVBlcmlvZDsKICAgIHByaXZhdGUgVGltZXIgcGVuZGluZ1JlcGxpY2F0\naW9uVGltZXI7CgogICAgLyoqCiAgICAgKiBSZXBsaWNhdGlvbiB3b3JrZXIg\nZm9yIHJlcGxpY2F0aW5nIHRoZSBsZWRnZXIgZnJhZ21lbnRzIGZyb20KICAg\nICAqIFVuZGVyUmVwbGljYXRpb25NYW5hZ2VyIHRvIHRoZSB0YXJnZXRCb29r\naWUuIFRoaXMgdGFyZ2V0IGJvb2tpZSB3aWxsIGJlIGEKICAgICAqIGxvY2Fs\nIGJvb2tpZS4KICAgICAqIAogICAgICogQHBhcmFtIHprYwogICAgICogICAg\nICAgICAgICAtIFpLIGluc3RhbmNlCiAgICAgKiBAcGFyYW0gY29uZgogICAg\nICogICAgICAgICAgICAtIGNvbmZpZ3VyYXRpb25zCiAgICAgKiBAcGFyYW0g\ndGFyZ2V0QktBZGRyCiAgICAgKiAgICAgICAgICAgIC0gdG8gd2hlcmUgcmVw\nbGljYXRpb24gc2hvdWxkIGhhcHBlbi4gSWRlYWxseSB0aGlzIHdpbGwgYmUK\nICAgICAqICAgICAgICAgICAgbG9jYWwgQm9va2llIGFkZHJlc3MuCiAgICAg\nKi8KICAgIHB1YmxpYyBSZXBsaWNhdGlvbldvcmtlcihmaW5hbCBab29LZWVw\nZXIgemtjLAogICAgICAgICAgICBmaW5hbCBTZXJ2ZXJDb25maWd1cmF0aW9u\nIGNvbmYsIEluZXRTb2NrZXRBZGRyZXNzIHRhcmdldEJLQWRkcikKICAgICAg\nICAgICAgdGhyb3dzIENvbXBhdGliaWxpdHlFeGNlcHRpb24sIEtlZXBlckV4\nY2VwdGlvbiwKICAgICAgICAgICAgSW50ZXJydXB0ZWRFeGNlcHRpb24sIElP\nRXhjZXB0aW9uIHsKICAgICAgICB0aGlzLnprYyA9IHprYzsKICAgICAgICB0\naGlzLmNvbmYgPSBjb25mOwogICAgICAgIHRoaXMudGFyZ2V0Qm9va2llID0g\ndGFyZ2V0QktBZGRyOwogICAgICAgIExlZGdlck1hbmFnZXJGYWN0b3J5IG1G\nYWN0b3J5ID0gTGVkZ2VyTWFuYWdlckZhY3RvcnkKICAgICAgICAgICAgICAg\nIC5uZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeSh0aGlzLmNvbmYsIHRoaXMuemtj\nKTsKICAgICAgICB0aGlzLnVuZGVycmVwbGljYXRpb25NYW5hZ2VyID0gbUZh\nY3RvcnkKICAgICAgICAgICAgICAgIC5uZXdMZWRnZXJVbmRlcnJlcGxpY2F0\naW9uTWFuYWdlcigpOwogICAgICAgIHRoaXMuYmtjID0gbmV3IEJvb2tLZWVw\nZXIobmV3IENsaWVudENvbmZpZ3VyYXRpb24oY29uZiksIHprYyk7CiAgICAg\nICAgdGhpcy5hZG1pbiA9IG5ldyBCb29rS2VlcGVyQWRtaW4oYmtjKTsKICAg\nICAgICB0aGlzLmxlZGdlckNoZWNrZXIgPSBuZXcgTGVkZ2VyQ2hlY2tlcihi\na2MpOwogICAgICAgIHRoaXMud29ya2VyVGhyZWFkID0gbmV3IFRocmVhZCh0\naGlzLCAiUmVwbGljYXRpb25Xb3JrZXIiKTsKICAgICAgICB0aGlzLm9wZW5M\nZWRnZXJSZXJlcGxpY2F0aW9uR3JhY2VQZXJpb2QgPSBjb25mCiAgICAgICAg\nICAgICAgICAuZ2V0T3BlbkxlZGdlclJlcmVwbGljYXRpb25HcmFjZVBlcmlv\nZCgpOwogICAgICAgIHRoaXMucGVuZGluZ1JlcGxpY2F0aW9uVGltZXIgPSBu\nZXcgVGltZXIoIlBlbmRpbmdSZXBsaWNhdGlvblRpbWVyIik7CiAgICB9Cgog\nICAgLyoqIFN0YXJ0IHRoZSByZXBsaWNhdGlvbiB3b3JrZXIgKi8KICAgIHB1\nYmxpYyB2b2lkIHN0YXJ0KCkgewogICAgICAgIHRoaXMud29ya2VyVGhyZWFk\nLnN0YXJ0KCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBydW4oKSB7CiAgICAgICAgd29ya2VyUnVubmluZyA9IHRydWU7CiAgICAg\nICAgd2hpbGUgKHdvcmtlclJ1bm5pbmcpIHsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIHJlcmVwbGljYXRlKCk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIHNodXRkb3duKCk7CiAgICAgICAgICAgICAgICBUaHJlYWQuY3VycmVu\ndFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAgICAgICAgTE9HLmlu\nZm8oIkludGVycnVwdGVkRXhjZXB0aW9uICIKICAgICAgICAgICAgICAgICAg\nICAgICAgKyAid2hpbGUgcmVwbGljYXRpbmcgZnJhZ21lbnRzIiwgZSk7CiAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gY2F0Y2ggKEJL\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHNodXRkb3duKCk7CiAg\nICAgICAgICAgICAgICBMT0cuZXJyb3IoIkJLRXhjZXB0aW9uIHdoaWxlIHJl\ncGxpY2F0aW5nIGZyYWdtZW50cyIsIGUpOwogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICB9IGNhdGNoIChVbmF2YWlsYWJsZUV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICBzaHV0ZG93bigpOwogICAgICAgICAg\nICAgICAgTE9HLmVycm9yKCJVbmF2YWlsYWJsZUV4Y2VwdGlvbiAiCiAgICAg\nICAgICAgICAgICAgICAgICAgICsgIndoaWxlIHJlcGxpY2F0aW5nIGZyYWdt\nZW50cyIsIGUpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVwbGljYXRl\ncyB0aGUgdW5kZXIgcmVwbGljYXRlZCBmcmFnbWVudHMgZnJvbSBmYWlsZWQg\nYm9va2llIGxlZGdlciB0bwogICAgICogdGFyZ2V0Qm9va2llCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCByZXJlcGxpY2F0ZSgpIHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24sCiAgICAgICAgICAgIFVuYXZh\naWxhYmxlRXhjZXB0aW9uIHsKICAgICAgICBsb25nIGxlZGdlcklkVG9SZXBs\naWNhdGUgPSB1bmRlcnJlcGxpY2F0aW9uTWFuYWdlcgogICAgICAgICAgICAg\nICAgLmdldExlZGdlclRvUmVyZXBsaWNhdGUoKTsKICAgICAgICBMT0cuaW5m\nbygiR29pbmcgdG8gcmVwbGljYXRlIHRoZSBmcmFnbWVudHMgb2YgdGhlIGxl\nZGdlcjogIgogICAgICAgICAgICAgICAgKyBsZWRnZXJJZFRvUmVwbGljYXRl\nKTsKICAgICAgICBMZWRnZXJIYW5kbGUgbGg7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgbGggPSBhZG1pbi5vcGVuTGVkZ2VyTm9SZWNvdmVyeShsZWRn\nZXJJZFRvUmVwbGljYXRlKTsKICAgICAgICB9IGNhdGNoIChCS05vU3VjaExl\nZGdlckV4aXN0c0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIExlZGdl\nciBtaWdodCBoYXZlIGJlZW4gZGVsZXRlZCBieSB1c2VyCiAgICAgICAgICAg\nIExPRy5pbmZvKCJCS05vU3VjaExlZGdlckV4aXN0c0V4Y2VwdGlvbiB3aGls\nZSBvcGVuaW5nICIKICAgICAgICAgICAgICAgICAgICArICJsZWRnZXIgZm9y\nIHJlcGxpY2F0aW9uLiBPdGhlciBjbGllbnRzICIKICAgICAgICAgICAgICAg\nICAgICArICJtaWdodCBoYXZlIGRlbGV0ZWQgdGhlIGxlZGdlci4gIgogICAg\nICAgICAgICAgICAgICAgICsgIlNvLCBubyBoYXJtIHRvIGNvbnRpbnVlIik7\nCiAgICAgICAgICAgIHVuZGVycmVwbGljYXRpb25NYW5hZ2VyLm1hcmtMZWRn\nZXJSZXBsaWNhdGVkKGxlZGdlcklkVG9SZXBsaWNhdGUpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfSBjYXRjaCAoQktSZWFkRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgTE9HLmluZm8oIkJLUmVhZEV4Y2VwdGlvbiB3aGls\nZSIKICAgICAgICAgICAgICAgICAgICArICIgb3BlbmluZyBsZWRnZXIgZm9y\nIHJlcGxpY2F0aW9uLiIKICAgICAgICAgICAgICAgICAgICArICIgRW5vdWdo\nIEJvb2tpZXMgbWlnaHQgbm90IGhhdmUgYXZhaWxhYmxlIgogICAgICAgICAg\nICAgICAgICAgICsgIlNvLCBubyBoYXJtIHRvIGNvbnRpbnVlIik7CiAgICAg\nICAgICAgIHVuZGVycmVwbGljYXRpb25NYW5hZ2VyCiAgICAgICAgICAgICAg\nICAgICAgLnJlbGVhc2VVbmRlcnJlcGxpY2F0ZWRMZWRnZXIobGVkZ2VySWRU\nb1JlcGxpY2F0ZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGNh\ndGNoIChCS0Jvb2tpZUhhbmRsZU5vdEF2YWlsYWJsZUV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIExPRy5pbmZvKCJCS0Jvb2tpZUhhbmRsZU5vdEF2YWls\nYWJsZUV4Y2VwdGlvbiB3aGlsZSIKICAgICAgICAgICAgICAgICAgICArICIg\nb3BlbmluZyBsZWRnZXIgZm9yIHJlcGxpY2F0aW9uLiIKICAgICAgICAgICAg\nICAgICAgICArICIgRW5vdWdoIEJvb2tpZXMgbWlnaHQgbm90IGhhdmUgYXZh\naWxhYmxlIgogICAgICAgICAgICAgICAgICAgICsgIlNvLCBubyBoYXJtIHRv\nIGNvbnRpbnVlIik7CiAgICAgICAgICAgIHVuZGVycmVwbGljYXRpb25NYW5h\nZ2VyCiAgICAgICAgICAgICAgICAgICAgLnJlbGVhc2VVbmRlcnJlcGxpY2F0\nZWRMZWRnZXIobGVkZ2VySWRUb1JlcGxpY2F0ZSk7CiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB9CiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50PiBm\ncmFnbWVudHMgPSBnZXRVbmRlcnJlcGxpY2F0ZWRGcmFnbWVudHMobGgpOwog\nICAgICAgIExPRy5pbmZvKCJGb3VuZHMgZnJhZ21lbnRzICIgKyBmcmFnbWVu\ndHMKICAgICAgICAgICAgICAgICsgIiBmb3IgcmVwbGljYXRpb24gZnJvbSBs\nZWRnZXI6ICIgKyBsZWRnZXJJZFRvUmVwbGljYXRlKTsKCiAgICAgICAgYm9v\nbGVhbiBmb3VuZE9wZW5GcmFnbWVudHMgPSBmYWxzZTsKICAgICAgICBmb3Ig\nKExlZGdlckZyYWdtZW50IGxlZGdlckZyYWdtZW50IDogZnJhZ21lbnRzKSB7\nCiAgICAgICAgICAgIGlmICghbGVkZ2VyRnJhZ21lbnQuaXNDbG9zZWQoKSkg\newogICAgICAgICAgICAgICAgZm91bmRPcGVuRnJhZ21lbnRzID0gdHJ1ZTsK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKGlzVGFyZ2V0Qm9va2llRXhpc3RzSW5GcmFnbWVudEVuc2VtYmxlKGxo\nLAogICAgICAgICAgICAgICAgICAgIGxlZGdlckZyYWdtZW50KSkgewogICAg\nICAgICAgICAgICAgTE9HLmluZm8oIlRhcmdldCBCb29raWVbIiArIHRhcmdl\ndEJvb2tpZQogICAgICAgICAgICAgICAgICAgICAgICArICJdIGZvdW5kIGlu\nIHRoZSBmcmFnbWVudCBlbnNlbWJsZToiCiAgICAgICAgICAgICAgICAgICAg\nICAgICsgbGVkZ2VyRnJhZ21lbnQuZ2V0RW5zZW1ibGUoKSk7CiAgICAgICAg\nICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgYWRtaW4ucmVwbGljYXRlTGVkZ2VyRnJh\nZ21lbnQobGgsIGxlZGdlckZyYWdtZW50LCB0YXJnZXRCb29raWUpOwogICAg\nICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5CS0Jvb2tpZUhhbmRsZU5v\ndEF2YWlsYWJsZUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBMT0cu\nd2FybigiQktCb29raWVIYW5kbGVOb3RBdmFpbGFibGVFeGNlcHRpb24gIgog\nICAgICAgICAgICAgICAgICAgICAgICArICJ3aGlsZSByZXBsaWNhdGluZyB0\naGUgZnJhZ21lbnQiLCBlKTsKICAgICAgICAgICAgfSBjYXRjaCAoQktFeGNl\ncHRpb24uQktMZWRnZXJSZWNvdmVyeUV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICBMT0cud2FybigiQktMZWRnZXJSZWNvdmVyeUV4Y2VwdGlvbiAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICsgIndoaWxlIHJlcGxpY2F0aW5n\nIHRoZSBmcmFnbWVudCIsIGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBpZiAoZm91bmRPcGVuRnJhZ21lbnRzKSB7CiAgICAgICAgICAg\nIGRlZmVyTGVkZ2VyTG9ja1JlbGVhc2UobGVkZ2VySWRUb1JlcGxpY2F0ZSk7\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAg\nICAgZnJhZ21lbnRzID0gZ2V0VW5kZXJyZXBsaWNhdGVkRnJhZ21lbnRzKGxo\nKTsKICAgICAgICBpZiAoZnJhZ21lbnRzLnNpemUoKSA9PSAwKSB7CiAgICAg\nICAgICAgIExPRy5pbmZvKCJMZWRnZXIgcmVwbGljYXRlZCBzdWNjZXNzZnVs\nbHkuIGxlZGdlciBpZCBpczogIgogICAgICAgICAgICAgICAgICAgICsgbGVk\nZ2VySWRUb1JlcGxpY2F0ZSk7CiAgICAgICAgICAgIHVuZGVycmVwbGljYXRp\nb25NYW5hZ2VyLm1hcmtMZWRnZXJSZXBsaWNhdGVkKGxlZGdlcklkVG9SZXBs\naWNhdGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFJlbGVh\nc2luZyB0aGUgdW5kZXJSZXBsaWNhdGlvbiBsZWRnZXIgbG9jayBhbmQgY29t\ncGV0ZQogICAgICAgICAgICAvLyBmb3IgdGhlIHJlcGxpY2F0aW9uIGFnYWlu\nIGZvciB0aGUgcGVuZGluZyBmcmFnbWVudHMKICAgICAgICAgICAgdW5kZXJy\nZXBsaWNhdGlvbk1hbmFnZXIKICAgICAgICAgICAgICAgICAgICAucmVsZWFz\nZVVuZGVycmVwbGljYXRlZExlZGdlcihsZWRnZXJJZFRvUmVwbGljYXRlKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqIEdldHMgdGhlIHVuZGVyIHJlcGxp\nY2F0ZWQgZnJhZ21lbnRzICovCiAgICBwcml2YXRlIFNldDxMZWRnZXJGcmFn\nbWVudD4gZ2V0VW5kZXJyZXBsaWNhdGVkRnJhZ21lbnRzKExlZGdlckhhbmRs\nZSBsaCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9u\nIHsKICAgICAgICBDaGVja2VyQ2FsbGJhY2sgY2hlY2tlckNiID0gbmV3IENo\nZWNrZXJDYWxsYmFjaygpOwogICAgICAgIGxlZGdlckNoZWNrZXIuY2hlY2tM\nZWRnZXIobGgsIGNoZWNrZXJDYik7CiAgICAgICAgU2V0PExlZGdlckZyYWdt\nZW50PiBmcmFnbWVudHMgPSBjaGVja2VyQ2Iud2FpdEFuZEdldFJlc3VsdCgp\nOwogICAgICAgIHJldHVybiBmcmFnbWVudHM7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTY2hlZHVsZXMgYSB0aW1lciB0YXNrIGZvciByZWxlYXNpbmcgdGhl\nIGxvY2sgd2hpY2ggd2lsbCBiZSBzY2hlZHVsZWQKICAgICAqIGFmdGVyIG9w\nZW4gbGVkZ2VyIGZyYWdtZW50IHJlcGxpY2F0aW9uIHRpbWUuIExlZGdlciB3\naWxsIGJlIGZlbmNlZCBpZiBpdAogICAgICogaXMgc3RpbGwgaW4gb3BlbiBz\ndGF0ZSB3aGVuIHRpbWVyIHRhc2sgZmlyZWQKICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIGRlZmVyTGVkZ2VyTG9ja1JlbGVhc2UoZmluYWwgbG9uZyBsZWRn\nZXJJZCkgewogICAgICAgIGxvbmcgZ3JhY2VQZXJpb2QgPSB0aGlzLm9wZW5M\nZWRnZXJSZXJlcGxpY2F0aW9uR3JhY2VQZXJpb2Q7CiAgICAgICAgVGltZXJU\nYXNrIHRpbWVyVGFzayA9IG5ldyBUaW1lclRhc2soKSB7CiAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAg\nICAgICAgICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBudWxsOwogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBsaCA9IGFkbWlu\nLm9wZW5MZWRnZXJOb1JlY292ZXJ5KGxlZGdlcklkKTsKICAgICAgICAgICAg\nICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IGZyYWdtZW50cyA9IGdldFVu\nZGVycmVwbGljYXRlZEZyYWdtZW50cyhsaCk7CiAgICAgICAgICAgICAgICAg\nICAgZm9yIChMZWRnZXJGcmFnbWVudCBmcmFnbWVudCA6IGZyYWdtZW50cykg\newogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZyYWdtZW50LmlzQ2xv\nc2VkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxoID0gYWRt\naW4ub3BlbkxlZGdlcihsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElu\ndGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAg\nICAgICAgICAgIExPRy5pbmZvKCJJbnRlcnJ1cHRlZEV4Y2VwdGlvbiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICArICJ3aGlsZSByZXBsaWNhdGlu\nZyBmcmFnbWVudHMiLCBlKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEJL\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3Io\nIkJLRXhjZXB0aW9uIHdoaWxlIGZlbmNpbmcgdGhlIGxlZGdlciIKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgIiBmb3IgcmVyZXBsaWNhdGlvbiBv\nZiBwb3N0cG9uZWQgbGVkZ2VycyIsIGUpOwogICAgICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAobGggIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbGguY2xvc2UoKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVw\ndGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGhy\nZWFkLmN1cnJlbnRUaHJlYWQoKS5pbnRlcnJ1cHQoKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgTE9HLmluZm8oIkludGVycnVwdGVkRXhjZXB0aW9uIHdo\naWxlIGNsb3NpbmcgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgImxlZGdlciIsIGUpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKEJLRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nTGV0cyBnbyBhaGVhZCBhbmQgcmVsZWFzZSB0aGUgbG9jay4gQ2F0Y2ggYWN0\ndWFsCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4Y2VwdGlvbiBpbiBu\nb3JtYWwgcmVwbGljYXRpb24gZmxvdyBhbmQgdGFrZQogICAgICAgICAgICAg\nICAgICAgICAgICAvLyBhY3Rpb24uCiAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy53YXJuKCJCS0V4Y2VwdGlvbiB3aGlsZSBjbG9zaW5nIGxlZGdlciAi\nLCBlKTsKICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgdW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgLnJlbGVhc2VVbmRlcnJlcGxpY2F0ZWRM\nZWRnZXIobGVkZ2VySWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChVbmF2YWlsYWJsZUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBzaHV0ZG93bigpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgTE9HLmVycm9yKCJVbmF2YWlsYWJsZUV4Y2VwdGlvbiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIndoaWxlIHJl\ncGxpY2F0aW5nIGZyYWdtZW50cyIsIGUpOwogICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBwZW5kaW5nUmVw\nbGljYXRpb25UaW1lci5zY2hlZHVsZSh0aW1lclRhc2ssIGdyYWNlUGVyaW9k\nKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBTdG9wIHRoZSByZXBsaWNh\ndGlvbiB3b3JrZXIgc2VydmljZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\naHV0ZG93bigpIHsKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAg\nICAgICAgICAgaWYgKCF3b3JrZXJSdW5uaW5nKSB7CiAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgd29ya2VyUnVu\nbmluZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICB0aGlzLnBlbmRpbmdS\nZXBsaWNhdGlvblRpbWVyLmNhbmNlbCgpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHRoaXMud29ya2VyVGhyZWFkLmludGVycnVwdCgpOwogICAgICAg\nICAgICB0aGlzLndvcmtlclRocmVhZC5qb2luKCk7CiAgICAgICAgfSBjYXRj\naCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cu\nZXJyb3IoIkludGVycnVwdGVkIGR1cmluZyBzaHV0dGluZyBkb3duIHJlcGxp\nY2F0aW9uIHdvcmtlciA6ICIsCiAgICAgICAgICAgICAgICAgICAgZSk7CiAg\nICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7\nCiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGJrYy5jbG9z\nZSgpOwogICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgTE9HLndhcm4oIkludGVycnVwdGVkIHdoaWxlIGNs\nb3NpbmcgdGhlIEJvb2tpZSBjbGllbnQiLCBlKTsKICAgICAgICAgICAgVGhy\nZWFkLmN1cnJlbnRUaHJlYWQoKS5pbnRlcnJ1cHQoKTsKICAgICAgICB9IGNh\ndGNoIChCS0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy53YXJuKCJF\neGNlcHRpb24gd2hpbGUgY2xvc2luZyB0aGUgQm9va2llIGNsaWVudCIsIGUp\nOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICB1bmRlcnJl\ncGxpY2F0aW9uTWFuYWdlci5jbG9zZSgpOwogICAgICAgIH0gY2F0Y2ggKFVu\nYXZhaWxhYmxlRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLndhcm4o\nIkV4Y2VwdGlvbiB3aGlsZSBjbG9zaW5nIHRoZSAiCiAgICAgICAgICAgICAg\nICAgICAgKyAiWmtMZWRnZXJVbmRlcnJlcGxpYXRpb25NYW5hZ2VyIiwgZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogR2l2ZXMgdGhlIHJ1\nbm5pbmcgc3RhdHVzIG9mIFJlcGxpY2F0aW9uV29ya2VyCiAgICAgKi8KICAg\nIGJvb2xlYW4gaXNSdW5uaW5nKCkgewogICAgICAgIHJldHVybiB3b3JrZXJS\ndW5uaW5nOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBpc1RhcmdldEJv\nb2tpZUV4aXN0c0luRnJhZ21lbnRFbnNlbWJsZShMZWRnZXJIYW5kbGUgbGgs\nCiAgICAgICAgICAgIExlZGdlckZyYWdtZW50IGxlZGdlckZyYWdtZW50KSB7\nCiAgICAgICAgTGlzdDxJbmV0U29ja2V0QWRkcmVzcz4gZW5zZW1ibGUgPSBs\nZWRnZXJGcmFnbWVudC5nZXRFbnNlbWJsZSgpOwogICAgICAgIGZvciAoSW5l\ndFNvY2tldEFkZHJlc3MgYmtBZGRyIDogZW5zZW1ibGUpIHsKICAgICAgICAg\nICAgaWYgKHRhcmdldEJvb2tpZS5lcXVhbHMoYmtBZGRyKSkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKiBMZWRnZXIg\nY2hlY2tlciBjYWxsIGJhY2sgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNz\nIENoZWNrZXJDYWxsYmFjayBpbXBsZW1lbnRzCiAgICAgICAgICAgIEdlbmVy\naWNDYWxsYmFjazxTZXQ8TGVkZ2VyRnJhZ21lbnQ+PiB7CiAgICAgICAgcHJp\ndmF0ZSBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IG51bGw7CiAgICAg\nICAgcHJpdmF0ZSBDb3VudERvd25MYXRjaCBsYXRjaCA9IG5ldyBDb3VudERv\nd25MYXRjaCgxKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBTZXQ8TGVkZ2VyRnJh\nZ21lbnQ+IHJlc3VsdCkgewogICAgICAgICAgICB0aGlzLnJlc3VsdCA9IHJl\nc3VsdDsKICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBXYWl0IHVudGlsIG9wZXJhdGlv\nbiBjb21wbGV0ZSBjYWxsIGJhY2sgY29tZXMgYW5kIHJldHVybiB0aGUgbGVk\nZ2VyCiAgICAgICAgICogZnJhZ21lbnRzIHNldAogICAgICAgICAqLwogICAg\nICAgIFNldDxMZWRnZXJGcmFnbWVudD4gd2FpdEFuZEdldFJlc3VsdCgpIHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGxhdGNo\nLmF3YWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAg\nfQogICAgfQoKfQo=\n","encoding":"base64"}

