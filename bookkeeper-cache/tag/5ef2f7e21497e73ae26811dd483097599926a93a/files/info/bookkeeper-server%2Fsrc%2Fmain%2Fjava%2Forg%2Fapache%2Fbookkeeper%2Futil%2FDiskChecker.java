{"sha":"bc50158187fa19737f3154aa50b193978261cc62","node_id":"MDQ6QmxvYjE1NzU5NTY6YmM1MDE1ODE4N2ZhMTk3MzdmMzE1NGFhNTBiMTkzOTc4MjYxY2M2Mg==","size":5745,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/bc50158187fa19737f3154aa50b193978261cc62","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWw7CgppbXBvcnQgamF2\nYS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKCmltcG9y\ndCBjb20uZ29vZ2xlLmNvbW1vbi5hbm5vdGF0aW9ucy5WaXNpYmxlRm9yVGVz\ndGluZzsKCi8qKgogKiBDbGFzcyB0aGF0IHByb3ZpZGVzIHV0aWxpdHkgZnVu\nY3Rpb25zIGZvciBjaGVja2luZyBkaXNrIHByb2JsZW1zCiAqLwpwdWJsaWMg\nY2xhc3MgRGlza0NoZWNrZXIgewogICAgcHJpdmF0ZSBmbG9hdCBkaXNrVXNh\nZ2VUaHJlc2hvbGQ7CgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBEaXNrRXJy\nb3JFeGNlcHRpb24gZXh0ZW5kcyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEID0gOTA5\nMTYwNjAyMjQ0OTc2MTcyOUw7CgogICAgICAgIHB1YmxpYyBEaXNrRXJyb3JF\neGNlcHRpb24oU3RyaW5nIG1zZykgewogICAgICAgICAgICBzdXBlcihtc2cp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIERp\nc2tPdXRPZlNwYWNlRXhjZXB0aW9uIGV4dGVuZHMgSU9FeGNlcHRpb24gewog\nICAgICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGxvbmcgc2VyaWFsVmVyc2lv\nblVJRCA9IDE2MDg5ODc5NzkxNTkwNjg2MEw7CgogICAgICAgIHB1YmxpYyBE\naXNrT3V0T2ZTcGFjZUV4Y2VwdGlvbihTdHJpbmcgbXNnKSB7CiAgICAgICAg\nICAgIHN1cGVyKG1zZyk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBE\naXNrQ2hlY2tlcihmbG9hdCB0aHJlc2hvbGQpIHsKICAgICAgICB2YWxpZGF0\nZVRocmVzaG9sZCh0aHJlc2hvbGQpOwogICAgICAgIHRoaXMuZGlza1VzYWdl\nVGhyZXNob2xkID0gdGhyZXNob2xkOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIHNlbWFudGljcyBvZiBta2RpcnNXaXRoRXhpc3RzQ2hlY2sgbWV0aG9k\nIGlzIGRpZmZlcmVudCBmcm9tIHRoZQogICAgICogbWtkaXJzIG1ldGhvZCBw\ncm92aWRlZCBpbiB0aGUgU3VuJ3MgamF2YS5pby5GaWxlIGNsYXNzIGluIHRo\nZSBmb2xsb3dpbmcKICAgICAqIHdheTogV2hpbGUgY3JlYXRpbmcgdGhlIG5v\nbi1leGlzdGVudCBwYXJlbnQgZGlyZWN0b3JpZXMsIHRoaXMgbWV0aG9kCiAg\nICAgKiBjaGVja3MgZm9yIHRoZSBleGlzdGVuY2Ugb2YgdGhvc2UgZGlyZWN0\nb3JpZXMgaWYgdGhlIG1rZGlyIGZhaWxzIGF0IGFueQogICAgICogcG9pbnQg\nKHNpbmNlIHRoYXQgZGlyZWN0b3J5IG1pZ2h0IGhhdmUganVzdCBiZWVuIGNy\nZWF0ZWQgYnkgc29tZSBvdGhlcgogICAgICogcHJvY2VzcykuIElmIGJvdGgg\nbWtkaXIoKSBhbmQgdGhlIGV4aXN0cygpIGNoZWNrIGZhaWxzIGZvciBhbnkg\nc2VlbWluZ2x5CiAgICAgKiBub24tZXhpc3RlbnQgZGlyZWN0b3J5LCB0aGVu\nIHdlIHNpZ25hbCBhbiBlcnJvcjsgU3VuJ3MgbWtkaXIgd291bGQgc2lnbmFs\nCiAgICAgKiBhbiBlcnJvciAocmV0dXJuIGZhbHNlKSBpZiBhIGRpcmVjdG9y\neSBpdCBpcyBhdHRlbXB0aW5nIHRvIGNyZWF0ZSBhbHJlYWR5CiAgICAgKiBl\neGlzdHMgb3IgdGhlIG1rZGlyIGZhaWxzLgogICAgICogCiAgICAgKiBAcGFy\nYW0gZGlyCiAgICAgKiBAcmV0dXJuIHRydWUgb24gc3VjY2VzcywgZmFsc2Ug\nb24gZmFpbHVyZQogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFu\nIG1rZGlyc1dpdGhFeGlzdHNDaGVjayhGaWxlIGRpcikgewogICAgICAgIGlm\nIChkaXIubWtkaXIoKSB8fCBkaXIuZXhpc3RzKCkpIHsKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIEZpbGUgY2Fub25EaXIg\nPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNhbm9uRGlyID0g\nZGlyLmdldENhbm9uaWNhbEZpbGUoKTsKICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICB9CiAgICAgICAgU3RyaW5nIHBhcmVudCA9IGNhbm9uRGlyLmdldFBhcmVu\ndCgpOwogICAgICAgIHJldHVybiAocGFyZW50ICE9IG51bGwpCiAgICAgICAg\nICAgICAgICAmJiAobWtkaXJzV2l0aEV4aXN0c0NoZWNrKG5ldyBGaWxlKHBh\ncmVudCkpICYmIChjYW5vbkRpcgogICAgICAgICAgICAgICAgICAgICAgICAu\nbWtkaXIoKSB8fCBjYW5vbkRpci5leGlzdHMoKSkpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2hlY2tzIHRoZSBkaXNrIHNwYWNlIGF2YWlsYWJsZS4KICAg\nICAqIAogICAgICogQHBhcmFtIGRpcgogICAgICogICAgICAgICAgICBEaXJl\nY3RvcnkgdG8gY2hlY2sgZm9yIHRoZSBkaXNrIHNwYWNlCiAgICAgKiBAdGhy\nb3dzIERpc2tPdXRPZlNwYWNlRXhjZXB0aW9uCiAgICAgKiAgICAgICAgICAg\nICBUaHJvd3Mge0BsaW5rIERpc2tPdXRPZlNwYWNlRXhjZXB0aW9ufSBpZiBh\ndmFpbGFibGUgc3BhY2UgaXMKICAgICAqICAgICAgICAgICAgIGxlc3MgdGhh\nbiB0aHJlc2hob2xkLgogICAgICovCiAgICBAVmlzaWJsZUZvclRlc3RpbmcK\nICAgIHZvaWQgY2hlY2tEaXNrRnVsbChGaWxlIGRpcikgdGhyb3dzIERpc2tP\ndXRPZlNwYWNlRXhjZXB0aW9uIHsKICAgICAgICBpZiAobnVsbCA9PSBkaXIp\nIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAo\nZGlyLmV4aXN0cygpKSB7CiAgICAgICAgICAgIGxvbmcgdXNhYmxlU3BhY2Ug\nPSBkaXIuZ2V0VXNhYmxlU3BhY2UoKTsKICAgICAgICAgICAgbG9uZyB0b3Rh\nbFNwYWNlID0gZGlyLmdldFRvdGFsU3BhY2UoKTsKICAgICAgICAgICAgZmxv\nYXQgZnJlZSA9IChmbG9hdCkgdXNhYmxlU3BhY2UgLyAoZmxvYXQpIHRvdGFs\nU3BhY2U7CiAgICAgICAgICAgIGZsb2F0IHVzZWQgPSAxZiAtIGZyZWU7CiAg\nICAgICAgICAgIGlmICh1c2VkID4gZGlza1VzYWdlVGhyZXNob2xkKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgRGlza091dE9mU3BhY2VFeGNlcHRp\nb24oIlNwYWNlIGxlZnQgb24gZGV2aWNlICIKICAgICAgICAgICAgICAgICAg\nICAgICAgKyB1c2FibGVTcGFjZSArICIgPCB0aHJlc2hob2xkICIgKyBkaXNr\nVXNhZ2VUaHJlc2hvbGQpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgY2hlY2tEaXNrRnVsbChkaXIuZ2V0UGFyZW50Rmls\nZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\ndGhlIGRpcmVjdG9yeSBpZiBpdCBkb2Vzbid0IGV4aXN0IGFuZAogICAgICog\nCiAgICAgKiBAcGFyYW0gZGlyCiAgICAgKiAgICAgICAgICAgIERpcmVjdG9y\neSB0byBjaGVjayBmb3IgdGhlIGRpc2sgZXJyb3IvZnVsbC4KICAgICAqIEB0\naHJvd3MgRGlza0Vycm9yRXhjZXB0aW9uCiAgICAgKiAgICAgICAgICAgICBJ\nZiBkaXNrIGhhdmluZyBlcnJvcnMKICAgICAqIEB0aHJvd3MgRGlza091dE9m\nU3BhY2VFeGNlcHRpb24KICAgICAqICAgICAgICAgICAgIElmIGRpc2sgaXMg\nZnVsbCBvciBoYXZpbmcgbGVzcyBzcGFjZSB0aGFuIHRocmVzaGhvbGQKICAg\nICAqLwogICAgcHVibGljIHZvaWQgY2hlY2tEaXIoRmlsZSBkaXIpIHRocm93\ncyBEaXNrRXJyb3JFeGNlcHRpb24sCiAgICAgICAgICAgIERpc2tPdXRPZlNw\nYWNlRXhjZXB0aW9uIHsKICAgICAgICBjaGVja0Rpc2tGdWxsKGRpcik7CiAg\nICAgICAgaWYgKCFta2RpcnNXaXRoRXhpc3RzQ2hlY2soZGlyKSkKICAgICAg\nICAgICAgdGhyb3cgbmV3IERpc2tFcnJvckV4Y2VwdGlvbigiY2FuIG5vdCBj\ncmVhdGUgZGlyZWN0b3J5OiAiCiAgICAgICAgICAgICAgICAgICAgKyBkaXIu\ndG9TdHJpbmcoKSk7CgogICAgICAgIGlmICghZGlyLmlzRGlyZWN0b3J5KCkp\nCiAgICAgICAgICAgIHRocm93IG5ldyBEaXNrRXJyb3JFeGNlcHRpb24oIm5v\ndCBhIGRpcmVjdG9yeTogIiArIGRpci50b1N0cmluZygpKTsKCiAgICAgICAg\naWYgKCFkaXIuY2FuUmVhZCgpKQogICAgICAgICAgICB0aHJvdyBuZXcgRGlz\na0Vycm9yRXhjZXB0aW9uKCJkaXJlY3RvcnkgaXMgbm90IHJlYWRhYmxlOiAi\nCiAgICAgICAgICAgICAgICAgICAgKyBkaXIudG9TdHJpbmcoKSk7CgogICAg\nICAgIGlmICghZGlyLmNhbldyaXRlKCkpCiAgICAgICAgICAgIHRocm93IG5l\ndyBEaXNrRXJyb3JFeGNlcHRpb24oImRpcmVjdG9yeSBpcyBub3Qgd3JpdGFi\nbGU6ICIKICAgICAgICAgICAgICAgICAgICArIGRpci50b1N0cmluZygpKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIGRpc2sgc3BhY2Ug\ndGhyZXNob2xkLgogICAgICogCiAgICAgKiBAcmV0dXJuCiAgICAgKi8KICAg\nIEBWaXNpYmxlRm9yVGVzdGluZwogICAgZmxvYXQgZ2V0RGlza1NwYWNlVGhy\nZXNob2xkKCkgewogICAgICAgIHJldHVybiBkaXNrVXNhZ2VUaHJlc2hvbGQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGRpc2sgc3BhY2UgdGhy\nZXNob2xkCiAgICAgKiAKICAgICAqIEBwYXJhbSBkaXNrU3BhY2VUaHJlc2hv\nbGQKICAgICAqLwogICAgQFZpc2libGVGb3JUZXN0aW5nCiAgICB2b2lkIHNl\ndERpc2tTcGFjZVRocmVzaG9sZChmbG9hdCBkaXNrU3BhY2VUaHJlc2hvbGQp\nIHsKICAgICAgICB2YWxpZGF0ZVRocmVzaG9sZChkaXNrU3BhY2VUaHJlc2hv\nbGQpOwogICAgICAgIHRoaXMuZGlza1VzYWdlVGhyZXNob2xkID0gZGlza1Nw\nYWNlVGhyZXNob2xkOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0\nZVRocmVzaG9sZChmbG9hdCBkaXNrU3BhY2VUaHJlc2hvbGQpIHsKICAgICAg\nICBpZiAoZGlza1NwYWNlVGhyZXNob2xkIDw9IDAgfHwgZGlza1NwYWNlVGhy\nZXNob2xkID49IDEpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbigiRGlzayBzcGFjZSB0aHJlYXNob2xkICIKICAg\nICAgICAgICAgICAgICAgICArIGRpc2tTcGFjZVRocmVzaG9sZAogICAgICAg\nICAgICAgICAgICAgICsgIiBpcyBub3QgdmFsaWQuIFNob3VsZCBiZSA+IDAg\nYW5kIDwgMSAiKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

