{"sha":"d3b523c6f95f1a0ca98dcac9bd6d088a930dc48c","node_id":"MDQ6QmxvYjE1NzU5NTY6ZDNiNTIzYzZmOTVmMWEwY2E5OGRjYWM5YmQ2ZDA4OGE5MzBkYzQ4Yw==","size":9818,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/d3b523c6f95f1a0ca98dcac9bd6d088a930dc48c","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbDsKCmltcG9ydCBqYXZh\nLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRT\ndHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsKaW1w\nb3J0IGphdmEubmV0LkluZXRBZGRyZXNzOwppbXBvcnQgamF2YS5uZXQuSW5l\ndFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLm5ldC5Tb2NrZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5ib29raWUuQm9va2llRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\naWVTZXJ2ZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGlj\nYXRpb24uUmVwbGljYXRpb25FeGNlcHRpb24uQ29tcGF0aWJpbGl0eUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbi5SZXBsaWNhdGlvbkV4Y2VwdGlvbi5VbmF2YWlsYWJsZUV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0\nZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVkRXZl\nbnQ7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlci5FdmVudC5LZWVwZXJTdGF0ZTsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRzOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuc2VydmVyLk5JT1NlcnZlckNueG5G\nYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuc2VydmVyLlpv\nb0tlZXBlclNlcnZlcjsKCnB1YmxpYyBjbGFzcyBMb2NhbEJvb2tLZWVwZXIg\newogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9n\nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTG9jYWxCb29rS2VlcGVyLmNsYXNzKTsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENPTk5FQ1RJT05fVElNRU9V\nVCA9IDMwMDAwOwoKICAgIGludCBudW1iZXJPZkJvb2tpZXM7CgogICAgcHVi\nbGljIExvY2FsQm9va0tlZXBlcigpIHsKICAgICAgICBudW1iZXJPZkJvb2tp\nZXMgPSAzOwogICAgfQoKICAgIHB1YmxpYyBMb2NhbEJvb2tLZWVwZXIoaW50\nIG51bWJlck9mQm9va2llcykgewogICAgICAgIHRoaXMoKTsKICAgICAgICB0\naGlzLm51bWJlck9mQm9va2llcyA9IG51bWJlck9mQm9va2llczsKICAgICAg\nICBMT0cuaW5mbygiUnVubmluZyAiICsgdGhpcy5udW1iZXJPZkJvb2tpZXMg\nKyAiIGJvb2tpZShzKS4iKTsKICAgIH0KCiAgICBwcml2YXRlIGZpbmFsIFN0\ncmluZyBIT1NUUE9SVCA9ICIxMjcuMC4wLjE6MjE4MSI7CiAgICBOSU9TZXJ2\nZXJDbnhuRmFjdG9yeSBzZXJ2ZXJGYWN0b3J5OwogICAgWm9vS2VlcGVyU2Vy\ndmVyIHprczsKICAgIFpvb0tlZXBlciB6a2M7CiAgICBpbnQgWm9vS2VlcGVy\nRGVmYXVsdFBvcnQgPSAyMTgxOwogICAgc3RhdGljIGludCB6a1Nlc3Npb25U\naW1lT3V0ID0gNTAwMDsKICAgIEZpbGUgWmtUbXBEaXI7CgogICAgLy9Cb29r\nS2VlcGVyIHZhcmlhYmxlcwogICAgRmlsZSB0bXBEaXJzW107CiAgICBCb29r\naWVTZXJ2ZXIgYnNbXTsKICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gYnNDb25m\nc1tdOwogICAgSW50ZWdlciBpbml0aWFsUG9ydCA9IDUwMDA7CgogICAgLyoq\nCiAgICAgKiBAcGFyYW0gYXJncwogICAgICovCgogICAgcHJpdmF0ZSB2b2lk\nIHJ1blpvb2tlZXBlcihpbnQgbWF4Q0MpIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gY3JlYXRlIGEgWm9vS2VlcGVyIHNlcnZlcihkYXRhRGly\nLCBkYXRhTG9nRGlyLCBwb3J0KQogICAgICAgIExPRy5pbmZvKCJTdGFydGlu\nZyBaSyBzZXJ2ZXIiKTsKICAgICAgICAvL1NlcnZlclN0YXRzLnJlZ2lzdGVy\nQXNDb25jcmV0ZSgpOwogICAgICAgIC8vQ2xpZW50QmFzZS5zZXR1cFRlc3RF\nbnYoKTsKICAgICAgICBaa1RtcERpciA9IEZpbGUuY3JlYXRlVGVtcEZpbGUo\nInpvb2tlZXBlciIsICJ0ZXN0Iik7CiAgICAgICAgaWYgKCFaa1RtcERpci5k\nZWxldGUoKSB8fCAhWmtUbXBEaXIubWtkaXIoKSkgewogICAgICAgICAgICB0\naHJvdyBuZXcgSU9FeGNlcHRpb24oIkNvdWxkbid0IGNyZWF0ZSB6ayBkaXJl\nY3RvcnkgIiArIFprVG1wRGlyKTsKICAgICAgICB9CgogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHprcyA9IG5ldyBab29LZWVwZXJTZXJ2ZXIoWmtUbXBE\naXIsIFprVG1wRGlyLCBab29LZWVwZXJEZWZhdWx0UG9ydCk7CiAgICAgICAg\nICAgIHNlcnZlckZhY3RvcnkgPSAgbmV3IE5JT1NlcnZlckNueG5GYWN0b3J5\nKCk7CiAgICAgICAgICAgIHNlcnZlckZhY3RvcnkuY29uZmlndXJlKG5ldyBJ\nbmV0U29ja2V0QWRkcmVzcyhab29LZWVwZXJEZWZhdWx0UG9ydCksIG1heEND\nKTsKICAgICAgICAgICAgc2VydmVyRmFjdG9yeS5zdGFydHVwKHprcyk7CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8g\nVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRjaCBibG9jawogICAgICAgICAgICBM\nT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBpbnN0YW50aWF0aW5nIFpvb0tl\nZXBlciIsIGUpOwogICAgICAgIH0KCiAgICAgICAgYm9vbGVhbiBiID0gd2Fp\ndEZvclNlcnZlclVwKEhPU1RQT1JULCBDT05ORUNUSU9OX1RJTUVPVVQpOwog\nICAgICAgIExPRy5kZWJ1ZygiWm9vS2VlcGVyIHNlcnZlciB1cDoge30iLCBi\nKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgaW5pdGlhbGl6ZVpvb2tlcGVy\nKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBMT0cuaW5mbygiSW5z\ndGFudGlhdGUgWksgQ2xpZW50Iik7CiAgICAgICAgLy9pbml0aWFsaXplIHRo\nZSB6ayBjbGllbnQgd2l0aCB2YWx1ZXMKICAgICAgICB0cnkgewogICAgICAg\nICAgICBaS0Nvbm5lY3Rpb25XYXRjaGVyIHprQ29ubmVjdGlvbldhdGNoZXIg\nPSBuZXcgWktDb25uZWN0aW9uV2F0Y2hlcigpOwogICAgICAgICAgICB6a2Mg\nPSBuZXcgWm9vS2VlcGVyKEhPU1RQT1JULCB6a1Nlc3Npb25UaW1lT3V0LAog\nICAgICAgICAgICAgICAgICAgIHprQ29ubmVjdGlvbldhdGNoZXIpOwogICAg\nICAgICAgICB6a0Nvbm5lY3Rpb25XYXRjaGVyLndhaXRGb3JDb25uZWN0aW9u\nKCk7CiAgICAgICAgICAgIHprYy5jcmVhdGUoIi9sZWRnZXJzIiwgbmV3IGJ5\ndGVbMF0sIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lT\nVEVOVCk7CiAgICAgICAgICAgIHprYy5jcmVhdGUoIi9sZWRnZXJzL2F2YWls\nYWJsZSIsIG5ldyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVh\ndGVNb2RlLlBFUlNJU1RFTlQpOwogICAgICAgICAgICAvLyBObyBuZWVkIHRv\nIGNyZWF0ZSBhbiBlbnRyeSBmb3IgZWFjaCByZXF1ZXN0ZWQgYm9va2llIGFu\neW1vcmUgYXMgdGhlCiAgICAgICAgICAgIC8vIEJvb2tpZVNlcnZlcnMgd2ls\nbCByZWdpc3RlciB0aGVtc2VsdmVzIHdpdGggWm9vS2VlcGVyIG9uIHN0YXJ0\ndXAuCiAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRjaCBibG9jawog\nICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBjcmVhdGlu\nZyB6bm9kZXMiLCBlKTsKICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIFRPRE8gQXV0by1nZW5lcmF0\nZWQgY2F0Y2ggYmxvY2sKICAgICAgICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1\ncHRlZCB3aGlsZSBjcmVhdGluZyB6bm9kZXMiLCBlKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIHJ1bkJvb2tpZXMoU2VydmVyQ29uZmln\ndXJhdGlvbiBiYXNlQ29uZikgdGhyb3dzIElPRXhjZXB0aW9uLAogICAgICAg\nICAgICBLZWVwZXJFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uLCBC\nb29raWVFeGNlcHRpb24sCiAgICAgICAgICAgIFVuYXZhaWxhYmxlRXhjZXB0\naW9uLCBDb21wYXRpYmlsaXR5RXhjZXB0aW9uIHsKICAgICAgICBMT0cuaW5m\nbygiU3RhcnRpbmcgQm9va2llKHMpIik7CiAgICAgICAgLy8gQ3JlYXRlIEJv\nb2tpZSBTZXJ2ZXJzIChCMSwgQjIsIEIzKQoKICAgICAgICB0bXBEaXJzID0g\nbmV3IEZpbGVbbnVtYmVyT2ZCb29raWVzXTsKICAgICAgICBicyA9IG5ldyBC\nb29raWVTZXJ2ZXJbbnVtYmVyT2ZCb29raWVzXTsKICAgICAgICBic0NvbmZz\nID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb25bbnVtYmVyT2ZCb29raWVzXTsK\nCiAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IG51bWJlck9mQm9va2llczsg\naSsrKSB7CiAgICAgICAgICAgIHRtcERpcnNbaV0gPSBGaWxlLmNyZWF0ZVRl\nbXBGaWxlKCJib29raWUiICsgSW50ZWdlci50b1N0cmluZyhpKSwgInRlc3Qi\nKTsKICAgICAgICAgICAgaWYgKCF0bXBEaXJzW2ldLmRlbGV0ZSgpIHx8ICF0\nbXBEaXJzW2ldLm1rZGlyKCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBJT0V4Y2VwdGlvbigiQ291bGRuJ3QgY3JlYXRlIGJvb2tpZSBkaXIgIiAr\nIHRtcERpcnNbaV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBic0Nv\nbmZzW2ldID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmFzZUNvbmYpOwog\nICAgICAgICAgICAvLyBvdmVycmlkZSBzZXR0aW5ncwogICAgICAgICAgICBi\nc0NvbmZzW2ldLnNldEJvb2tpZVBvcnQoaW5pdGlhbFBvcnQgKyBpKTsKICAg\nICAgICAgICAgYnNDb25mc1tpXS5zZXRaa1NlcnZlcnMoSW5ldEFkZHJlc3Mu\nZ2V0TG9jYWxIb3N0KCkuZ2V0SG9zdEFkZHJlc3MoKSArICI6IgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBab29LZWVwZXJEZWZhdWx0\nUG9ydCk7CiAgICAgICAgICAgIGJzQ29uZnNbaV0uc2V0Sm91cm5hbERpck5h\nbWUodG1wRGlyc1tpXS5nZXRQYXRoKCkpOwogICAgICAgICAgICBic0NvbmZz\nW2ldLnNldExlZGdlckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7IHRtcERpcnNb\naV0uZ2V0UGF0aCgpIH0pOwoKICAgICAgICAgICAgYnNbaV0gPSBuZXcgQm9v\na2llU2VydmVyKGJzQ29uZnNbaV0pOwogICAgICAgICAgICBic1tpXS5zdGFy\ndCgpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQg\nbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJvd3MgSU9FeGNlcHRpb24sIEtlZXBl\nckV4Y2VwdGlvbiwKICAgICAgICAgICAgSW50ZXJydXB0ZWRFeGNlcHRpb24s\nIEJvb2tpZUV4Y2VwdGlvbiwgVW5hdmFpbGFibGVFeGNlcHRpb24sCiAgICAg\nICAgICAgIENvbXBhdGliaWxpdHlFeGNlcHRpb24gewogICAgICAgIGlmKGFy\nZ3MubGVuZ3RoIDwgMSkgewogICAgICAgICAgICB1c2FnZSgpOwogICAgICAg\nICAgICBTeXN0ZW0uZXhpdCgtMSk7CiAgICAgICAgfQogICAgICAgIExvY2Fs\nQm9va0tlZXBlciBsYiA9IG5ldyBMb2NhbEJvb2tLZWVwZXIoSW50ZWdlci5w\nYXJzZUludChhcmdzWzBdKSk7CgogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRp\nb24gY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAg\naWYgKGFyZ3MubGVuZ3RoID49IDIpIHsKICAgICAgICAgICAgU3RyaW5nIGNv\nbmZGaWxlID0gYXJnc1sxXTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIGNvbmYubG9hZENvbmYobmV3IEZpbGUoY29uZkZpbGUpLnRvVVJJ\nKCkudG9VUkwoKSk7CiAgICAgICAgICAgICAgICBMT0cuaW5mbygiVXNpbmcg\nY29uZmlndXJhdGlvbiBmaWxlICIgKyBjb25mRmlsZSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBs\nb2FkIGNvbmYgZmFpbGVkCiAgICAgICAgICAgICAgICBMT0cud2FybigiRXJy\nb3IgbG9hZGluZyBjb25maWd1cmF0aW9uIGZpbGUgIiArIGNvbmZGaWxlLCBl\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbGIucnVuWm9v\na2VlcGVyKDEwMDApOwogICAgICAgIGxiLmluaXRpYWxpemVab29rZXBlcigp\nOwogICAgICAgIGxiLnJ1bkJvb2tpZXMoY29uZik7CiAgICAgICAgd2hpbGUg\nKHRydWUpIHsKICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDUwMDApOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHVzYWdlKCkg\newogICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiVXNhZ2U6IExvY2FsQm9v\na0tlZXBlciBudW1iZXItb2YtYm9va2llcyIpOwogICAgfQoKICAgIC8qIFdh\ndGNoaW5nIFN5bmNDb25uZWN0ZWQgZXZlbnQgZnJvbSBab29LZWVwZXIgKi8K\nICAgIHN0YXRpYyBjbGFzcyBaS0Nvbm5lY3Rpb25XYXRjaGVyIGltcGxlbWVu\ndHMgV2F0Y2hlciB7CiAgICAgICAgcHJpdmF0ZSBDb3VudERvd25MYXRjaCBj\nbGllbnRDb25uZWN0TGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3Mo\nV2F0Y2hlZEV2ZW50IGV2ZW50KSB7CiAgICAgICAgICAgIGlmIChldmVudC5n\nZXRTdGF0ZSgpID09IEtlZXBlclN0YXRlLlN5bmNDb25uZWN0ZWQpIHsKICAg\nICAgICAgICAgICAgIGNsaWVudENvbm5lY3RMYXRjaC5jb3VudERvd24oKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gV2FpdGluZyBm\nb3IgdGhlIFN5bmNDb25uZWN0ZWQgZXZlbnQgZnJvbSB0aGUgWm9vS2VlcGVy\nIHNlcnZlcgogICAgICAgIHB1YmxpYyB2b2lkIHdhaXRGb3JDb25uZWN0aW9u\nKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIGlmICghY2xpZW50Q29ubmVjdExhdGNoLmF3YWl0KHpr\nU2Vzc2lvblRpbWVPdXQsCiAgICAgICAgICAgICAgICAgICAgICAgIFRpbWVV\nbml0Lk1JTExJU0VDT05EUykpIHsKICAgICAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSU9FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAiQ291bGRuJ3QgY29ubmVjdCB0byB6b29rZWVwZXIgc2VydmVyIik7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVw\ndGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgIkludGVycnVw\ndGVkIHdoZW4gY29ubmVjdGluZyB0byB6b29rZWVwZXIgc2VydmVyIiwgZSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHN0\nYXRpYyBib29sZWFuIHdhaXRGb3JTZXJ2ZXJVcChTdHJpbmcgaHAsIGxvbmcg\ndGltZW91dCkgewogICAgICAgIGxvbmcgc3RhcnQgPSBNYXRoVXRpbHMubm93\nKCk7CiAgICAgICAgU3RyaW5nIHNwbGl0W10gPSBocC5zcGxpdCgiOiIpOwog\nICAgICAgIFN0cmluZyBob3N0ID0gc3BsaXRbMF07CiAgICAgICAgaW50IHBv\ncnQgPSBJbnRlZ2VyLnBhcnNlSW50KHNwbGl0WzFdKTsKICAgICAgICB3aGls\nZSAodHJ1ZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nU29ja2V0IHNvY2sgPSBuZXcgU29ja2V0KGhvc3QsIHBvcnQpOwogICAgICAg\nICAgICAgICAgQnVmZmVyZWRSZWFkZXIgcmVhZGVyID0gbnVsbDsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgT3V0cHV0U3Ry\nZWFtIG91dHN0cmVhbSA9IHNvY2suZ2V0T3V0cHV0U3RyZWFtKCk7CiAgICAg\nICAgICAgICAgICAgICAgb3V0c3RyZWFtLndyaXRlKCJzdGF0Ii5nZXRCeXRl\ncygpKTsKICAgICAgICAgICAgICAgICAgICBvdXRzdHJlYW0uZmx1c2goKTsK\nCiAgICAgICAgICAgICAgICAgICAgcmVhZGVyID0KICAgICAgICAgICAgICAg\nICAgICAgICAgbmV3IEJ1ZmZlcmVkUmVhZGVyKAogICAgICAgICAgICAgICAg\nICAgICAgICBuZXcgSW5wdXRTdHJlYW1SZWFkZXIoc29jay5nZXRJbnB1dFN0\ncmVhbSgpKSk7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGxpbmUgPSBy\nZWFkZXIucmVhZExpbmUoKTsKICAgICAgICAgICAgICAgICAgICBpZiAobGlu\nZSAhPSBudWxsICYmIGxpbmUuc3RhcnRzV2l0aCgiWm9va2VlcGVyIHZlcnNp\nb246IikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIlNl\ncnZlciBVUCIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgICAgIHNvY2suY2xvc2UoKTsKICAg\nICAgICAgICAgICAgICAgICBpZiAocmVhZGVyICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgcmVhZGVyLmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBpZ25v\ncmUgYXMgdGhpcyBpcyBleHBlY3RlZAogICAgICAgICAgICAgICAgTE9HLmlu\nZm8oInNlcnZlciAiICsgaHAgKyAiIG5vdCB1cCAiICsgZSk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIGlmIChNYXRoVXRpbHMubm93KCkgPiBzdGFy\ndCArIHRpbWVvdXQpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBUaHJl\nYWQuc2xlZXAoMjUwKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0\nZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gaWdub3JlCiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgfQoKfQo=\n","encoding":"base64"}

