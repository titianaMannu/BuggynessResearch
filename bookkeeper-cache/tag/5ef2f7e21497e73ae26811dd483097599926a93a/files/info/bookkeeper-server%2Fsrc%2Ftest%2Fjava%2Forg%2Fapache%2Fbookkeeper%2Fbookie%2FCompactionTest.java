{"sha":"bc2b0837a468c26fb2317055c94453b9855e6fff","node_id":"MDQ6QmxvYjE1NzU5NTY6YmMyYjA4MzdhNDY4YzI2ZmIyMzE3MDU1Yzk0NDUzYjk4NTVlNmZmZg==","size":10742,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/bc2b0837a468c26fb2317055c94453b9855e6fff","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llOwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCmlt\ncG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwpp\nbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9uOwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdl\nc3RUeXBlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9v\na0tlZXBlckNsdXN0ZXJUZXN0Q2FzZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci51dGlsLlRlc3RVdGlsczsKCmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQg\nb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKLyoq\nCiAqIFRoaXMgY2xhc3MgdGVzdHMgdGhlIGVudHJ5IGxvZyBjb21wYWN0aW9u\nIGZ1bmN0aW9uYWxpdHkuCiAqLwpwdWJsaWMgY2xhc3MgQ29tcGFjdGlvblRl\nc3QgZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKICAgIHN0\nYXRpYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoQ29t\ncGFjdGlvblRlc3QuY2xhc3MpOwogICAgRGlnZXN0VHlwZSBkaWdlc3RUeXBl\nOwoKICAgIHN0YXRpYyBpbnQgRU5UUllfU0laRSA9IDEwMjQ7CiAgICBzdGF0\naWMgaW50IE5VTV9CT09LSUVTID0gMTsKCiAgICBpbnQgbnVtRW50cmllczsK\nICAgIGludCBnY1dhaXRUaW1lOwogICAgZG91YmxlIG1pbm9yQ29tcGFjdGlv\nblRocmVzaG9sZDsKICAgIGRvdWJsZSBtYWpvckNvbXBhY3Rpb25UaHJlc2hv\nbGQ7CiAgICBsb25nIG1pbm9yQ29tcGFjdGlvbkludGVydmFsOwogICAgbG9u\nZyBtYWpvckNvbXBhY3Rpb25JbnRlcnZhbDsKCiAgICBTdHJpbmcgbXNnOwoK\nICAgIHB1YmxpYyBDb21wYWN0aW9uVGVzdCgpIHsKICAgICAgICBzdXBlcihO\nVU1fQk9PS0lFUyk7CgogICAgICAgIHRoaXMuZGlnZXN0VHlwZSA9IERpZ2Vz\ndFR5cGUuQ1JDMzI7CgogICAgICAgIG51bUVudHJpZXMgPSAxMDA7CiAgICAg\nICAgZ2NXYWl0VGltZSA9IDEwMDA7CiAgICAgICAgbWlub3JDb21wYWN0aW9u\nVGhyZXNob2xkID0gMC4xZjsKICAgICAgICBtYWpvckNvbXBhY3Rpb25UaHJl\nc2hvbGQgPSAwLjVmOwogICAgICAgIG1pbm9yQ29tcGFjdGlvbkludGVydmFs\nID0gMiAqIGdjV2FpdFRpbWUgLyAxMDAwOwogICAgICAgIG1ham9yQ29tcGFj\ndGlvbkludGVydmFsID0gNCAqIGdjV2FpdFRpbWUgLyAxMDAwOwoKICAgICAg\nICAvLyBhIGR1bW15IG1lc3NhZ2UKICAgICAgICBTdHJpbmdCdWlsZGVyIG1z\nZ1NCID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IEVOVFJZX1NJWkU7IGkrKykgewogICAgICAgICAgICBtc2dT\nQi5hcHBlbmQoImEiKTsKICAgICAgICB9CiAgICAgICAgbXNnID0gbXNnU0Iu\ndG9TdHJpbmcoKTsKICAgIH0KCiAgICBAQmVmb3JlCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgLy8gU2V0IHVwIHRoZSBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMg\nbmVlZGVkLgogICAgICAgIGJhc2VDb25mLnNldEVudHJ5TG9nU2l6ZUxpbWl0\nKG51bUVudHJpZXMgKiBFTlRSWV9TSVpFKTsKICAgICAgICBiYXNlQ29uZi5z\nZXRHY1dhaXRUaW1lKGdjV2FpdFRpbWUpOwogICAgICAgIGJhc2VDb25mLnNl\ndE1pbm9yQ29tcGFjdGlvblRocmVzaG9sZChtaW5vckNvbXBhY3Rpb25UaHJl\nc2hvbGQpOwogICAgICAgIGJhc2VDb25mLnNldE1ham9yQ29tcGFjdGlvblRo\ncmVzaG9sZChtYWpvckNvbXBhY3Rpb25UaHJlc2hvbGQpOwogICAgICAgIGJh\nc2VDb25mLnNldE1pbm9yQ29tcGFjdGlvbkludGVydmFsKG1pbm9yQ29tcGFj\ndGlvbkludGVydmFsKTsKICAgICAgICBiYXNlQ29uZi5zZXRNYWpvckNvbXBh\nY3Rpb25JbnRlcnZhbChtYWpvckNvbXBhY3Rpb25JbnRlcnZhbCk7CgogICAg\nICAgIHN1cGVyLnNldFVwKCk7CiAgICB9CgogICAgTGVkZ2VySGFuZGxlW10g\ncHJlcGFyZURhdGEoaW50IG51bUVudHJ5TG9ncywgYm9vbGVhbiBjaGFuZ2VO\ndW0pCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc2lu\nY2UgYW4gZW50cnkgbG9nIGZpbGUgY2FuIGhvbGQgYXQgbW9zdCAxMDAgZW50\ncmllcwogICAgICAgIC8vIGZpcnN0IGxlZGdlciB3cml0ZSAyIGVudHJpZXMs\nIHdoaWNoIGlzIGxlc3MgdGhhbiBsb3cgd2F0ZXIgbWFyawogICAgICAgIGlu\ndCBudW0xID0gMjsKICAgICAgICAvLyB0aGlyZCBsZWRnZXIgd3JpdGUgbW9y\nZSB0aGFuIGhpZ2ggd2F0ZXIgbWFyayBlbnRyaWVzCiAgICAgICAgaW50IG51\nbTMgPSAoaW50KShudW1FbnRyaWVzICogMC43Zik7CiAgICAgICAgLy8gc2Vj\nb25kIGxlZGdlciB3cml0ZSByZW1haW5pbmcgZW50cmllcywgd2hpY2ggaXMg\naGlnaGVyIHRoYW4gbG93IHdhdGVyIG1hcmsKICAgICAgICAvLyBhbmQgbGVz\ncyB0aGFuIGhpZ2ggd2F0ZXIgbWFyawogICAgICAgIGludCBudW0yID0gbnVt\nRW50cmllcyAtIG51bTMgLSBudW0xOwoKICAgICAgICBMZWRnZXJIYW5kbGVb\nXSBsaHMgPSBuZXcgTGVkZ2VySGFuZGxlWzNdOwogICAgICAgIGZvciAoaW50\nIGk9MDsgaTwzOyArK2kpIHsKICAgICAgICAgICAgbGhzW2ldID0gYmtjLmNy\nZWF0ZUxlZGdlcihOVU1fQk9PS0lFUywgTlVNX0JPT0tJRVMsIGRpZ2VzdFR5\ncGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChp\nbnQgbiA9IDA7IG4gPCBudW1FbnRyeUxvZ3M7IG4rKykgewogICAgICAgICAg\nICBmb3IgKGludCBrID0gMDsgayA8IG51bTE7IGsrKykgewogICAgICAgICAg\nICAgICAgbGhzWzBdLmFkZEVudHJ5KG1zZy5nZXRCeXRlcygpKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IG51bTI7\nIGsrKykgewogICAgICAgICAgICAgICAgbGhzWzFdLmFkZEVudHJ5KG1zZy5n\nZXRCeXRlcygpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGlu\ndCBrID0gMDsgayA8IG51bTM7IGsrKykgewogICAgICAgICAgICAgICAgbGhz\nWzJdLmFkZEVudHJ5KG1zZy5nZXRCeXRlcygpKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBpZiAoY2hhbmdlTnVtKSB7CiAgICAgICAgICAgICAgICAt\nLW51bTI7CiAgICAgICAgICAgICAgICArK251bTM7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHJldHVybiBsaHM7CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIHZlcmlmeUxlZGdlcihsb25nIGxpZCwgbG9uZyBzdGFydEVu\ndHJ5SWQsIGxvbmcgZW5kRW50cnlJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLm9wZW5MZWRnZXIobGlkLCBk\naWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKICAgICAgICBFbnVtZXJhdGlv\nbjxMZWRnZXJFbnRyeT4gZW50cmllcyA9IGxoLnJlYWRFbnRyaWVzKHN0YXJ0\nRW50cnlJZCwgZW5kRW50cnlJZCk7CiAgICAgICAgd2hpbGUgKGVudHJpZXMu\naGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgTGVkZ2VyRW50cnkg\nZW50cnkgPSBlbnRyaWVzLm5leHRFbGVtZW50KCk7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscyhtc2csIG5ldyBTdHJpbmcoZW50cnkuZ2V0RW50cnkoKSkp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQog\nICAgcHVibGljIHZvaWQgdGVzdERpc2FibGVDb21wYWN0aW9uKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gcHJlcGFyZSBkYXRhCiAgICAgICAg\nTGVkZ2VySGFuZGxlW10gbGhzID0gcHJlcGFyZURhdGEoMywgZmFsc2UpOwoK\nICAgICAgICAvLyBkaXNhYmxlIGNvbXBhY3Rpb24KICAgICAgICBiYXNlQ29u\nZi5zZXRNaW5vckNvbXBhY3Rpb25UaHJlc2hvbGQoMC4wZik7CiAgICAgICAg\nYmFzZUNvbmYuc2V0TWFqb3JDb21wYWN0aW9uVGhyZXNob2xkKDAuMGYpOwoK\nICAgICAgICAvLyByZXN0YXJ0IGJvb2tpZXMKICAgICAgICByZXN0YXJ0Qm9v\na2llcyhiYXNlQ29uZik7CgogICAgICAgIC8vIHJlbW92ZSBsZWRnZXIyIGFu\nZCBsZWRnZXIzCiAgICAgICAgLy8gc28gZW50cnkgbG9nIDEgYW5kIDIgd291\nbGQgaGF2ZSBsZWRnZXIxIGVudHJpZXMgbGVmdAogICAgICAgIGJrYy5kZWxl\ndGVMZWRnZXIobGhzWzFdLmdldElkKCkpOwogICAgICAgIGJrYy5kZWxldGVM\nZWRnZXIobGhzWzJdLmdldElkKCkpOwogICAgICAgIExPRy5pbmZvKCJGaW5p\nc2hlZCBkZWxldGluZyB0aGUgbGVkZ2VycyBjb250YWlucyBtb3N0IGVudHJp\nZXMuIik7CiAgICAgICAgVGhyZWFkLnNsZWVwKGJhc2VDb25mLmdldE1ham9y\nQ29tcGFjdGlvbkludGVydmFsKCkgKiAxMDAwCiAgICAgICAgICAgICAgICAg\nICArIGJhc2VDb25mLmdldEdjV2FpdFRpbWUoKSk7CgogICAgICAgIC8vIGVu\ndHJ5IGxvZ3MgKFswLDFdLmxvZykgc2hvdWxkIG5vdCBiZSBjb21wYWN0ZWQu\nCiAgICAgICAgZm9yIChGaWxlIGxlZGdlckRpcmVjdG9yeSA6IHRtcERpcnMp\nIHsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiTm90IEZvdW5kIGVudHJ5IGxv\nZyBmaWxlIChbMCwxXS5sb2cgdGhhdCBzaG91bGQgaGF2ZSBiZWVuIGNvbXBh\nY3RlZCBpbiBsZWRnZXJEaXJlY3Rvcnk6ICIKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgbGVkZ2VyRGlyZWN0b3J5LCBUZXN0VXRpbHMuaGFzTG9n\nRmlsZXMobGVkZ2VyRGlyZWN0b3J5LCBmYWxzZSwgMCwgMSkpOwogICAgICAg\nIH0KICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGlj\nIHZvaWQgdGVzdE1pbm9yQ29tcGFjdGlvbigpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIC8vIHByZXBhcmUgZGF0YQogICAgICAgIExlZGdlckhhbmRs\nZVtdIGxocyA9IHByZXBhcmVEYXRhKDMsIGZhbHNlKTsKCiAgICAgICAgZm9y\nIChMZWRnZXJIYW5kbGUgbGggOiBsaHMpIHsKICAgICAgICAgICAgbGguY2xv\nc2UoKTsKICAgICAgICB9CgogICAgICAgIC8vIGRpc2FibGUgbWFqb3IgY29t\ncGFjdGlvbgogICAgICAgIGJhc2VDb25mLnNldE1ham9yQ29tcGFjdGlvblRo\ncmVzaG9sZCgwLjBmKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzCiAg\nICAgICAgcmVzdGFydEJvb2tpZXMoYmFzZUNvbmYpOwoKICAgICAgICAvLyBy\nZW1vdmUgbGVkZ2VyMiBhbmQgbGVkZ2VyMwogICAgICAgIGJrYy5kZWxldGVM\nZWRnZXIobGhzWzFdLmdldElkKCkpOwogICAgICAgIGJrYy5kZWxldGVMZWRn\nZXIobGhzWzJdLmdldElkKCkpOwoKICAgICAgICBMT0cuaW5mbygiRmluaXNo\nZWQgZGVsZXRpbmcgdGhlIGxlZGdlcnMgY29udGFpbnMgbW9zdCBlbnRyaWVz\nLiIpOwogICAgICAgIFRocmVhZC5zbGVlcChiYXNlQ29uZi5nZXRNaW5vckNv\nbXBhY3Rpb25JbnRlcnZhbCgpICogMTAwMAogICAgICAgICAgICAgICAgICAg\nKyBiYXNlQ29uZi5nZXRHY1dhaXRUaW1lKCkpOwoKICAgICAgICAvLyBlbnRy\neSBsb2dzIChbMCwxLDJdLmxvZykgc2hvdWxkIGJlIGNvbXBhY3RlZC4KICAg\nICAgICBmb3IgKEZpbGUgbGVkZ2VyRGlyZWN0b3J5IDogdG1wRGlycykgewog\nICAgICAgICAgICBhc3NlcnRGYWxzZSgiRm91bmQgZW50cnkgbG9nIGZpbGUg\nKFswLDEsMl0ubG9nIHRoYXQgc2hvdWxkIGhhdmUgbm90IGJlZW4gY29tcGFj\ndGVkIGluIGxlZGdlckRpcmVjdG9yeTogIiAKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgbGVkZ2VyRGlyZWN0b3J5LCBUZXN0VXRpbHMuaGFzTG9n\nRmlsZXMobGVkZ2VyRGlyZWN0b3J5LCB0cnVlLCAwLCAxLCAyKSk7CiAgICAg\nICAgfQoKICAgICAgICAvLyBldmVuIGVudHJ5IGxvZyBmaWxlcyBhcmUgcmVt\nb3ZlZCwgd2Ugc3RpbGwgY2FuIGFjY2VzcyBlbnRyaWVzIGZvciBsZWRnZXIx\nCiAgICAgICAgLy8gc2luY2UgdGhvc2UgZW50cmllcyBoYXMgYmVlbiBjb21w\nYWN0ZWQgdG8gbmV3IGVudHJ5IGxvZwogICAgICAgIHZlcmlmeUxlZGdlcihs\naHNbMF0uZ2V0SWQoKSwgMCwgbGhzWzBdLmdldExhc3RBZGRDb25maXJtZWQo\nKSk7CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RNYWpvckNvbXBhY3Rpb24oKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKCiAgICAgICAgLy8gcHJlcGFyZSBkYXRhCiAgICAgICAgTGVkZ2VySGFu\nZGxlW10gbGhzID0gcHJlcGFyZURhdGEoMywgdHJ1ZSk7CgogICAgICAgIGZv\nciAoTGVkZ2VySGFuZGxlIGxoIDogbGhzKSB7CiAgICAgICAgICAgIGxoLmNs\nb3NlKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBkaXNhYmxlIG1pbm9yIGNv\nbXBhY3Rpb24KICAgICAgICBiYXNlQ29uZi5zZXRNaW5vckNvbXBhY3Rpb25U\naHJlc2hvbGQoMC4wZik7CgogICAgICAgIC8vIHJlc3RhcnQgYm9va2llcwog\nICAgICAgIHJlc3RhcnRCb29raWVzKGJhc2VDb25mKTsKCiAgICAgICAgLy8g\ncmVtb3ZlIGxlZGdlcjEgYW5kIGxlZGdlcjMKICAgICAgICBia2MuZGVsZXRl\nTGVkZ2VyKGxoc1swXS5nZXRJZCgpKTsKICAgICAgICBia2MuZGVsZXRlTGVk\nZ2VyKGxoc1syXS5nZXRJZCgpKTsKICAgICAgICBMT0cuaW5mbygiRmluaXNo\nZWQgZGVsZXRpbmcgdGhlIGxlZGdlcnMgY29udGFpbnMgbW9zdCBlbnRyaWVz\nLiIpOwoKICAgICAgICBUaHJlYWQuc2xlZXAoYmFzZUNvbmYuZ2V0TWFqb3JD\nb21wYWN0aW9uSW50ZXJ2YWwoKSAqIDEwMDAKICAgICAgICAgICAgICAgICAg\nICsgYmFzZUNvbmYuZ2V0R2NXYWl0VGltZSgpKTsKCiAgICAgICAgLy8gZW50\ncnkgbG9ncyAoWzAsMSwyXS5sb2cpIHNob3VsZCBiZSBjb21wYWN0ZWQKICAg\nICAgICBmb3IgKEZpbGUgbGVkZ2VyRGlyZWN0b3J5IDogdG1wRGlycykgewog\nICAgICAgICAgICBhc3NlcnRGYWxzZSgiRm91bmQgZW50cnkgbG9nIGZpbGUg\nKFswLDEsMl0ubG9nIHRoYXQgc2hvdWxkIGhhdmUgbm90IGJlZW4gY29tcGFj\ndGVkIGluIGxlZGdlckRpcmVjdG9yeTogIgogICAgICAgICAgICAgICAgICAg\nICAgKyBsZWRnZXJEaXJlY3RvcnksIFRlc3RVdGlscy5oYXNMb2dGaWxlcyhs\nZWRnZXJEaXJlY3RvcnksIHRydWUsIDAsIDEsIDIpKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIGV2ZW4gZW50cnkgbG9nIGZpbGVzIGFyZSByZW1vdmVkLCB3\nZSBzdGlsbCBjYW4gYWNjZXNzIGVudHJpZXMgZm9yIGxlZGdlcjIKICAgICAg\nICAvLyBzaW5jZSB0aG9zZSBlbnRyaWVzIGhhcyBiZWVuIGNvbXBhY3RlZCB0\nbyBuZXcgZW50cnkgbG9nCiAgICAgICAgdmVyaWZ5TGVkZ2VyKGxoc1sxXS5n\nZXRJZCgpLCAwLCBsaHNbMV0uZ2V0TGFzdEFkZENvbmZpcm1lZCgpKTsKICAg\nIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQg\ndGVzdE1ham9yQ29tcGFjdGlvbkFib3ZlVGhyZXNob2xkKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gcHJlcGFyZSBkYXRhCiAgICAgICAgTGVk\nZ2VySGFuZGxlW10gbGhzID0gcHJlcGFyZURhdGEoMywgZmFsc2UpOwoKICAg\nICAgICBmb3IgKExlZGdlckhhbmRsZSBsaCA6IGxocykgewogICAgICAgICAg\nICBsaC5jbG9zZSgpOwogICAgICAgIH0KCiAgICAgICAgLy8gcmVtb3ZlIGxl\nZGdlcjEgYW5kIGxlZGdlcjIKICAgICAgICBia2MuZGVsZXRlTGVkZ2VyKGxo\nc1swXS5nZXRJZCgpKTsKICAgICAgICBia2MuZGVsZXRlTGVkZ2VyKGxoc1sx\nXS5nZXRJZCgpKTsKICAgICAgICBMT0cuaW5mbygiRmluaXNoZWQgZGVsZXRp\nbmcgdGhlIGxlZGdlcnMgY29udGFpbnMgbGVzcyBlbnRyaWVzLiIpOwogICAg\nICAgIFRocmVhZC5zbGVlcChiYXNlQ29uZi5nZXRNYWpvckNvbXBhY3Rpb25J\nbnRlcnZhbCgpICogMTAwMAogICAgICAgICAgICAgICAgICAgKyBiYXNlQ29u\nZi5nZXRHY1dhaXRUaW1lKCkpOwoKICAgICAgICAvLyBlbnRyeSBsb2dzIChb\nMCwxLDJdLmxvZykgc2hvdWxkIG5vdCBiZSBjb21wYWN0ZWQKICAgICAgICBm\nb3IgKEZpbGUgbGVkZ2VyRGlyZWN0b3J5IDogdG1wRGlycykgewogICAgICAg\nICAgICBhc3NlcnRUcnVlKCJOb3QgRm91bmQgZW50cnkgbG9nIGZpbGUgKFsx\nLDJdLmxvZyB0aGF0IHNob3VsZCBoYXZlIGJlZW4gY29tcGFjdGVkIGluIGxl\nZGdlckRpcmVjdG9yeTogIgogICAgICAgICAgICAgICAgICAgICArIGxlZGdl\nckRpcmVjdG9yeSwgVGVzdFV0aWxzLmhhc0xvZ0ZpbGVzKGxlZGdlckRpcmVj\ndG9yeSwgZmFsc2UsIDAsIDEsIDIpKTsKICAgICAgICB9CiAgICB9CgogICAg\nQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RDb21w\nYWN0aW9uU21hbGxFbnRyeUxvZ3MoKSB0aHJvd3MgRXhjZXB0aW9uIHsKCiAg\nICAgICAgLy8gY3JlYXRlIGEgbGVkZ2VyIHRvIHdyaXRlIGEgZmV3IGVudHJp\nZXMKICAgICAgICBMZWRnZXJIYW5kbGUgYWxoID0gYmtjLmNyZWF0ZUxlZGdl\ncihOVU1fQk9PS0lFUywgTlVNX0JPT0tJRVMsIGRpZ2VzdFR5cGUsICIiLmdl\ndEJ5dGVzKCkpOwogICAgICAgIGZvciAoaW50IGk9MDsgaTwzOyBpKyspIHsK\nICAgICAgICAgICBhbGguYWRkRW50cnkobXNnLmdldEJ5dGVzKCkpOwogICAg\nICAgIH0KICAgICAgICBhbGguY2xvc2UoKTsKCiAgICAgICAgLy8gcmVzdGFy\ndCBib29raWUgdG8gcm9sbCBlbnRyeSBsb2cgZmlsZXMKICAgICAgICByZXN0\nYXJ0Qm9va2llcygpOwoKICAgICAgICAvLyBwcmVwYXJlIGRhdGEKICAgICAg\nICBMZWRnZXJIYW5kbGVbXSBsaHMgPSBwcmVwYXJlRGF0YSgzLCBmYWxzZSk7\nCgogICAgICAgIGZvciAoTGVkZ2VySGFuZGxlIGxoIDogbGhzKSB7CiAgICAg\nICAgICAgIGxoLmNsb3NlKCk7CiAgICAgICAgfQoKICAgICAgICAvLyByZW1v\ndmUgbGVkZ2VyMiBhbmQgbGVkZ2VyMwogICAgICAgIGJrYy5kZWxldGVMZWRn\nZXIobGhzWzFdLmdldElkKCkpOwogICAgICAgIGJrYy5kZWxldGVMZWRnZXIo\nbGhzWzJdLmdldElkKCkpOwogICAgICAgIExPRy5pbmZvKCJGaW5pc2hlZCBk\nZWxldGluZyB0aGUgbGVkZ2VycyBjb250YWlucyBtb3N0IGVudHJpZXMuIik7\nCiAgICAgICAgVGhyZWFkLnNsZWVwKGJhc2VDb25mLmdldE1ham9yQ29tcGFj\ndGlvbkludGVydmFsKCkgKiAxMDAwCiAgICAgICAgICAgICAgICAgICArIGJh\nc2VDb25mLmdldEdjV2FpdFRpbWUoKSk7CgogICAgICAgIC8vIGVudHJ5IGxv\nZ3MgKDAubG9nKSBzaG91bGQgbm90IGJlIGNvbXBhY3RlZAogICAgICAgIC8v\nIGVudHJ5IGxvZ3MgKFsxLDIsM10ubG9nKSBzaG91bGQgYmUgY29tcGFjdGVk\nLgogICAgICAgIGZvciAoRmlsZSBsZWRnZXJEaXJlY3RvcnkgOiB0bXBEaXJz\nKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoIk5vdCBGb3VuZCBlbnRyeSBs\nb2cgZmlsZSAoWzBdLmxvZyB0aGF0IHNob3VsZCBoYXZlIGJlZW4gY29tcGFj\ndGVkIGluIGxlZGdlckRpcmVjdG9yeTogIgogICAgICAgICAgICAgICAgICAg\nICArIGxlZGdlckRpcmVjdG9yeSwgVGVzdFV0aWxzLmhhc0xvZ0ZpbGVzKGxl\nZGdlckRpcmVjdG9yeSwgdHJ1ZSwgMCkpOwogICAgICAgICAgICBhc3NlcnRG\nYWxzZSgiRm91bmQgZW50cnkgbG9nIGZpbGUgKFsxLDIsM10ubG9nIHRoYXQg\nc2hvdWxkIGhhdmUgbm90IGJlZW4gY29tcGFjdGVkIGluIGxlZGdlckRpcmVj\ndG9yeTogIgogICAgICAgICAgICAgICAgICAgICAgKyBsZWRnZXJEaXJlY3Rv\ncnksIFRlc3RVdGlscy5oYXNMb2dGaWxlcyhsZWRnZXJEaXJlY3RvcnksIHRy\ndWUsIDEsIDIsIDMpKTsKICAgICAgICB9CgogICAgICAgIC8vIGV2ZW4gZW50\ncnkgbG9nIGZpbGVzIGFyZSByZW1vdmVkLCB3ZSBzdGlsbCBjYW4gYWNjZXNz\nIGVudHJpZXMgZm9yIGxlZGdlcjEKICAgICAgICAvLyBzaW5jZSB0aG9zZSBl\nbnRyaWVzIGhhcyBiZWVuIGNvbXBhY3RlZCB0byBuZXcgZW50cnkgbG9nCiAg\nICAgICAgdmVyaWZ5TGVkZ2VyKGxoc1swXS5nZXRJZCgpLCAwLCBsaHNbMF0u\nZ2V0TGFzdEFkZENvbmZpcm1lZCgpKTsKICAgIH0KfQo=\n","encoding":"base64"}

