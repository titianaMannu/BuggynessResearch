{"sha":"cd222df13eb9a7f8cbbdccfe13d167cd1bd232f1","node_id":"MDQ6QmxvYjE1NzU5NTY6Y2QyMjJkZjEzZWI5YTdmOGNiYmRjY2ZlMTNkMTY3Y2QxYmQyMzJmMQ==","size":4943,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/cd222df13eb9a7f8cbbdccfe13d167cd1bd232f1","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llOwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCgpp\nbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9uOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2Vy\ndmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RUeXBlOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9va0tlZXBlckNsdXN0\nZXJUZXN0Q2FzZTsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgb3JnLmp1bml0LkFz\nc2VydDsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKLyoqCiAqIFRoaXMgY2xh\nc3MgdGVzdHMgdGhhdCBpbmRleCBjb3JydXB0aW9uIGNhc2VzCiAqLwpwdWJs\naWMgY2xhc3MgSW5kZXhDb3JydXB0aW9uVGVzdCBleHRlbmRzIEJvb2tLZWVw\nZXJDbHVzdGVyVGVzdENhc2UgewogICAgc3RhdGljIExvZ2dlciBMT0cgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihJbmRleENvcnJ1cHRpb25UZXN0LmNs\nYXNzKTsKCiAgICBEaWdlc3RUeXBlIGRpZ2VzdFR5cGU7CgogICAgaW50IHBh\nZ2VTaXplID0gMTAyNDsKCiAgICBwdWJsaWMgSW5kZXhDb3JydXB0aW9uVGVz\ndCgpIHsKICAgICAgICBzdXBlcigxKTsKICAgICAgICB0aGlzLmRpZ2VzdFR5\ncGUgPSBEaWdlc3RUeXBlLkNSQzMyOwogICAgICAgIGJhc2VDb25mLnNldFBh\nZ2VTaXplKHBhZ2VTaXplKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYw\nMDAwKQogICAgcHVibGljIHZvaWQgdGVzdE5vU3VjaExlZGdlcigpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIExPRy5kZWJ1ZygiVGVzdGluZyBOb1N1\nY2hMZWRnZXIiKTsKCiAgICAgICAgQm9va2llLlN5bmNUaHJlYWQgc3luY1Ro\ncmVhZCA9IGJzLmdldCgwKS5nZXRCb29raWUoKS5zeW5jVGhyZWFkOwogICAg\nICAgIHN5bmNUaHJlYWQuc3VzcGVuZFN5bmMoKTsKICAgICAgICAvLyBDcmVh\ndGUgYSBsZWRnZXIKICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3Jl\nYXRlTGVkZ2VyKDEsIDEsIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwoK\nICAgICAgICAvLyBDbG9zZSB0aGUgbGVkZ2VyIHdoaWNoIGNhdXNlIGEgcmVh\nZEVudHJ5KDApIGNhbGwKICAgICAgICBMZWRnZXJIYW5kbGUgbmV3TGggPSBi\na2Mub3BlbkxlZGdlcihsaC5nZXRJZCgpLCBkaWdlc3RUeXBlLCAiIi5nZXRC\neXRlcygpKTsKCiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGxlZGdlciB0byB3\ncml0ZSBlbnRyaWVzCiAgICAgICAgU3RyaW5nIGR1bW15TXNnID0gIk5vU3Vj\naExlZGdlciI7CiAgICAgICAgaW50IG51bU1zZ3MgPSAzOwogICAgICAgIExl\nZGdlckhhbmRsZSB3bGggPSBia2MuY3JlYXRlTGVkZ2VyKDEsIDEsIGRpZ2Vz\ndFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIGZvciAoaW50IGk9MDsg\naTxudW1Nc2dzOyBpKyspIHsKICAgICAgICAgICAgd2xoLmFkZEVudHJ5KGR1\nbW15TXNnLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAgICAgc3luY1Ro\ncmVhZC5yZXN1bWVTeW5jKCk7CgogICAgICAgIC8vIHRyaWdnZXIgc3luYwog\nICAgICAgIFRocmVhZC5zbGVlcCgyICogYmFzZUNvbmYuZ2V0Rmx1c2hJbnRl\ncnZhbCgpKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzCiAgICAgICAg\ncmVzdGFydEJvb2tpZXMoKTsKCiAgICAgICAgRW51bWVyYXRpb248TGVkZ2Vy\nRW50cnk+IHNlcSA9IHdsaC5yZWFkRW50cmllcygwLCBudW1Nc2dzIC0gMSk7\nCiAgICAgICAgYXNzZXJ0VHJ1ZSgiRW51bWVyYXRpb24gb2YgbGVkZ2VyIGVu\ndHJpZXMgaGFzIG5vIGVsZW1lbnQiLCBzZXEuaGFzTW9yZUVsZW1lbnRzKCkg\nPT0gdHJ1ZSk7CiAgICAgICAgaW50IGVudHJ5SWQgPSAwOwogICAgICAgIHdo\naWxlIChzZXEuaGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgTGVk\nZ2VyRW50cnkgZSA9IHNlcS5uZXh0RWxlbWVudCgpOwogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoZW50cnlJZCwgZS5nZXRFbnRyeUlkKCkpOwoKICAgICAg\nICAgICAgQXNzZXJ0LmFzc2VydEFycmF5RXF1YWxzKGR1bW15TXNnLmdldEJ5\ndGVzKCksIGUuZ2V0RW50cnkoKSk7CiAgICAgICAgICAgICsrZW50cnlJZDsK\nICAgICAgICB9CiAgICAgICAgYXNzZXJ0RXF1YWxzKGVudHJ5SWQsIG51bU1z\nZ3MpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJs\naWMgdm9pZCB0ZXN0RW1wdHlJbmRleFBhZ2UoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBMT0cuZGVidWcoIlRlc3RpbmcgRW1wdHlJbmRleFBhZ2Ui\nKTsKCiAgICAgICAgQm9va2llLlN5bmNUaHJlYWQgc3luY1RocmVhZCA9IGJz\nLmdldCgwKS5nZXRCb29raWUoKS5zeW5jVGhyZWFkOwogICAgICAgIGFzc2Vy\ndE5vdE51bGwoIk5vdCBmb3VuZCBTeW5jVGhyZWFkLiIsIHN5bmNUaHJlYWQp\nOwoKICAgICAgICBzeW5jVGhyZWFkLnN1c3BlbmRTeW5jKCk7CgogICAgICAg\nIC8vIENyZWF0ZSBhIGxlZGdlcgogICAgICAgIExlZGdlckhhbmRsZSBsaDEg\nPSBia2MuY3JlYXRlTGVkZ2VyKDEsIDEsIGRpZ2VzdFR5cGUsICIiLmdldEJ5\ndGVzKCkpOwoKICAgICAgICBTdHJpbmcgZHVtbXlNc2cgPSAiTm9TdWNoTGVk\nZ2VyIjsKCiAgICAgICAgLy8gd3JpdGUgdHdvIHBhZ2UgZW50cmllcyB0byBs\nZWRnZXIgMgogICAgICAgIGludCBudW1Nc2dzID0gMiAqIHBhZ2VTaXplIC8g\nODsKICAgICAgICBMZWRnZXJIYW5kbGUgbGgyID0gYmtjLmNyZWF0ZUxlZGdl\ncigxLCAxLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKICAgICAgICBm\nb3IgKGludCBpPTA7IGk8bnVtTXNnczsgaSsrKSB7CiAgICAgICAgICAgIGxo\nMi5hZGRFbnRyeShkdW1teU1zZy5nZXRCeXRlcygpKTsKICAgICAgICB9Cgog\nICAgICAgIHN5bmNUaHJlYWQucmVzdW1lU3luYygpOwoKICAgICAgICAvLyB0\ncmlnZ2VyIHN5bmMKICAgICAgICBUaHJlYWQuc2xlZXAoMiAqIGJhc2VDb25m\nLmdldEZsdXNoSW50ZXJ2YWwoKSk7CgogICAgICAgIHN5bmNUaHJlYWQuc3Vz\ncGVuZFN5bmMoKTsKCiAgICAgICAgLy8gQ2xvc2UgbGVkZ2VyIDEgd2hpY2gg\nY2F1c2UgYSByZWFkRW50cnkoMCkgY2FsbAogICAgICAgIExlZGdlckhhbmRs\nZSBuZXdMaDEgPSBia2Mub3BlbkxlZGdlcihsaDEuZ2V0SWQoKSwgZGlnZXN0\nVHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CgogICAgICAgIC8vIHdyaXRlIGFub3Ro\nZXIgMyBlbnRyaWVzIHRvIGxlZGdlciAyCiAgICAgICAgZm9yIChpbnQgaT0w\nOyBpPDM7IGkrKykgewogICAgICAgICAgICBsaDIuYWRkRW50cnkoZHVtbXlN\nc2cuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgfQoKICAgICAgICBzeW5jVGhyZWFk\nLnJlc3VtZVN5bmMoKTsKCiAgICAgICAgLy8gd2FpdCBmb3Igc3luYyBhZ2Fp\nbgogICAgICAgIFRocmVhZC5zbGVlcCgyICogYmFzZUNvbmYuZ2V0Rmx1c2hJ\nbnRlcnZhbCgpKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzCiAgICAg\nICAgcmVzdGFydEJvb2tpZXMoKTsKCiAgICAgICAgbnVtTXNncyArPSAzOwog\nICAgICAgIEVudW1lcmF0aW9uPExlZGdlckVudHJ5PiBzZXEgPSBsaDIucmVh\nZEVudHJpZXMoMCwgbnVtTXNncyAtIDEpOwogICAgICAgIGFzc2VydFRydWUo\nIkVudW1lcmF0aW9uIG9mIGxlZGdlciBlbnRyaWVzIGhhcyBubyBlbGVtZW50\nIiwgc2VxLmhhc01vcmVFbGVtZW50cygpID09IHRydWUpOwogICAgICAgIGlu\ndCBlbnRyeUlkID0gMDsKICAgICAgICB3aGlsZSAoc2VxLmhhc01vcmVFbGVt\nZW50cygpKSB7CiAgICAgICAgICAgIExlZGdlckVudHJ5IGUgPSBzZXEubmV4\ndEVsZW1lbnQoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGVudHJ5SWQs\nIGUuZ2V0RW50cnlJZCgpKTsKCiAgICAgICAgICAgIEFzc2VydC5hc3NlcnRB\ncnJheUVxdWFscyhkdW1teU1zZy5nZXRCeXRlcygpLCBlLmdldEVudHJ5KCkp\nOwogICAgICAgICAgICArK2VudHJ5SWQ7CiAgICAgICAgfQogICAgICAgIGFz\nc2VydEVxdWFscyhlbnRyeUlkLCBudW1Nc2dzKTsKICAgIH0KfQo=\n","encoding":"base64"}

