{"sha":"6825e8fb71b7357c36cb6bbd0ccdc0fac88209c0","node_id":"MDQ6QmxvYjE1NzU5NTY6NjgyNWU4ZmI3MWI3MzU3YzM2Y2I2YmJkMGNjZGMwZmFjODgyMDljMA==","size":9237,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/6825e8fb71b7357c36cb6bbd0ccdc0fac88209c0","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5czsKCmltcG9ydCBqYXZhLm5pby5CeXRl\nQnVmZmVyOwppbXBvcnQgamF2YS5uaW8uY2hhbm5lbHMuRmlsZUNoYW5uZWw7\nCgppbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2Vw\ndGlvbjsKCmltcG9ydCBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW07CmltcG9y\ndCBqYXZhLmlvLk91dHB1dFN0cmVhbVdyaXRlcjsKaW1wb3J0IGphdmEuaW8u\nQnVmZmVyZWRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLlByaW50U3RyZWFtOwpp\nbXBvcnQgamF2YS5pby5SYW5kb21BY2Nlc3NGaWxlOwoKaW1wb3J0IG9yZy5q\ndW5pdC5CZWZvcmU7CmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9ydCBv\ncmcuanVuaXQuVGVzdDsKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0\nLio7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5DbGll\nbnRVdGlsOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5M\nZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29u\nZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci50ZXN0Llpvb0tlZXBlclV0aWw7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIudGVzdC5Qb3J0TWFuYWdlcjsKCmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgpwdWJsaWMg\nY2xhc3MgVXBncmFkZVRlc3QgewogICAgc3RhdGljIExvZ2dlciBMT0cgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihGaWxlSW5mby5jbGFzcyk7CgogICAg\nWm9vS2VlcGVyVXRpbCB6a3V0aWw7CiAgICBab29LZWVwZXIgemtjID0gbnVs\nbDsKICAgIGZpbmFsIHN0YXRpYyBpbnQgYm9va2llUG9ydCA9IFBvcnRNYW5h\nZ2VyLm5leHRGcmVlUG9ydCgpOwoKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2\nb2lkIHNldHVwWm9vS2VlcGVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgemt1dGlsID0gbmV3IFpvb0tlZXBlclV0aWwoKTsKICAgICAgICB6a3V0\naWwuc3RhcnRTZXJ2ZXIoKTsKICAgICAgICB6a2MgPSB6a3V0aWwuZ2V0Wm9v\nS2VlcGVyQ2xpZW50KCk7CiAgICB9CgogICAgQEFmdGVyCiAgICBwdWJsaWMg\ndm9pZCB0ZWFyRG93blpvb0tlZXBlcigpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHprdXRpbC5raWxsU2VydmVyKCk7CiAgICB9CgogICAgc3RhdGlj\nIHZvaWQgd3JpdGVMZWRnZXJEaXIoRmlsZSBkaXIsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBieXRlW10gbWFzdGVyS2V5KQogICAgICAgICAg\nICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBsb25nIGxlZGdlcklkID0g\nMTsKCiAgICAgICAgRmlsZSBmbiA9IG5ldyBGaWxlKGRpciwgTGVkZ2VyQ2Fj\naGVJbXBsLmdldExlZGdlck5hbWUobGVkZ2VySWQpKTsKICAgICAgICBmbi5n\nZXRQYXJlbnRGaWxlKCkubWtkaXJzKCk7CiAgICAgICAgRmlsZUluZm8gZmkg\nPSBuZXcgRmlsZUluZm8oZm4sIG1hc3RlcktleSk7CiAgICAgICAgLy8gZm9y\nY2UgY3JlYXRpb24gb2YgaW5kZXggZmlsZQogICAgICAgIGZpLndyaXRlKG5l\ndyBCeXRlQnVmZmVyW117IEJ5dGVCdWZmZXIuYWxsb2NhdGUoMCkgfSwgMCk7\nCiAgICAgICAgZmkuY2xvc2UodHJ1ZSk7CgogICAgICAgIGxvbmcgbG9nSWQg\nPSAwOwogICAgICAgIEJ5dGVCdWZmZXIgTE9HRklMRV9IRUFERVIgPSBCeXRl\nQnVmZmVyLmFsbG9jYXRlKDEwMjQpOwogICAgICAgIExPR0ZJTEVfSEVBREVS\nLnB1dCgiQktMTyIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgRmlsZUNoYW5uZWwg\nbG9nZmlsZSA9IG5ldyBSYW5kb21BY2Nlc3NGaWxlKAogICAgICAgICAgICAg\nICAgbmV3IEZpbGUoZGlyLCBMb25nLnRvSGV4U3RyaW5nKGxvZ0lkKSsiLmxv\nZyIpLCAicnciKS5nZXRDaGFubmVsKCk7CiAgICAgICAgbG9nZmlsZS53cml0\nZSgoQnl0ZUJ1ZmZlcikgTE9HRklMRV9IRUFERVIuY2xlYXIoKSk7CiAgICAg\nICAgbG9nZmlsZS5jbG9zZSgpOwogICAgfQoKICAgIHN0YXRpYyBKb3VybmFs\nQ2hhbm5lbCB3cml0ZUpvdXJuYWwoRmlsZSBqb3VybmFsRGlyLCBpbnQgbnVt\nRW50cmllcywgYnl0ZVtdIG1hc3RlcktleSkKICAgICAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgbG9uZyBsb2dJZCA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgIEpvdXJuYWxDaGFubmVsIGpjID0g\nbmV3IEpvdXJuYWxDaGFubmVsKGpvdXJuYWxEaXIsIGxvZ0lkKTsKCiAgICAg\nICAgQnVmZmVyZWRDaGFubmVsIGJjID0gamMuZ2V0QnVmZmVyZWRDaGFubmVs\nKCk7CgogICAgICAgIGxvbmcgbGVkZ2VySWQgPSAxOwogICAgICAgIGJ5dGVb\nXSBkYXRhID0gbmV3IGJ5dGVbMTAyNF07CiAgICAgICAgQXJyYXlzLmZpbGwo\nZGF0YSwgKGJ5dGUpJ1gnKTsKICAgICAgICBsb25nIGxhc3RDb25maXJtZWQg\nPSBMZWRnZXJIYW5kbGUuSU5WQUxJRF9FTlRSWV9JRDsKCiAgICAgICAgZm9y\nIChpbnQgaSA9IDE7IGkgPD0gbnVtRW50cmllczsgaSsrKSB7CiAgICAgICAg\nICAgIEJ5dGVCdWZmZXIgcGFja2V0ID0gQ2xpZW50VXRpbC5nZW5lcmF0ZVBh\nY2tldChsZWRnZXJJZCwgaSwgbGFzdENvbmZpcm1lZCwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGkqZGF0YS5sZW5ndGgsIGRhdGEpLnRvQnl0ZUJ1ZmZlcigpOwogICAgICAg\nICAgICBsYXN0Q29uZmlybWVkID0gaTsKICAgICAgICAgICAgQnl0ZUJ1ZmZl\nciBsZW5CdWZmID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZSg0KTsKICAgICAgICAg\nICAgbGVuQnVmZi5wdXRJbnQocGFja2V0LnJlbWFpbmluZygpKTsKICAgICAg\nICAgICAgbGVuQnVmZi5mbGlwKCk7CgogICAgICAgICAgICBiYy53cml0ZShs\nZW5CdWZmKTsKICAgICAgICAgICAgYmMud3JpdGUocGFja2V0KTsKICAgICAg\nICB9CiAgICAgICAgYmMuZmx1c2godHJ1ZSk7CgogICAgICAgIHJldHVybiBq\nYzsKICAgIH0KCiAgICBzdGF0aWMgU3RyaW5nIG5ld1YxSm91cm5hbERpcmVj\ndG9yeSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEZpbGUgZCA9IEZp\nbGUuY3JlYXRlVGVtcEZpbGUoImJvb2tpZSIsICJ0bXBkaXIiKTsKICAgICAg\nICBkLmRlbGV0ZSgpOwogICAgICAgIGQubWtkaXJzKCk7CiAgICAgICAgd3Jp\ndGVKb3VybmFsKGQsIDEwMCwgImZvb2JhciIuZ2V0Qnl0ZXMoKSkuY2xvc2Uo\nKTsKICAgICAgICByZXR1cm4gZC5nZXRQYXRoKCk7CiAgICB9CgogICAgc3Rh\ndGljIFN0cmluZyBuZXdWMUxlZGdlckRpcmVjdG9yeSgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIEZpbGUgZCA9IEZpbGUuY3JlYXRlVGVtcEZpbGUo\nImJvb2tpZSIsICJ0bXBkaXIiKTsKICAgICAgICBkLmRlbGV0ZSgpOwogICAg\nICAgIGQubWtkaXJzKCk7CiAgICAgICAgd3JpdGVMZWRnZXJEaXIoZCwgImZv\nb2JhciIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgcmV0dXJuIGQuZ2V0UGF0aCgp\nOwogICAgfQoKICAgIHN0YXRpYyB2b2lkIGNyZWF0ZVZlcnNpb24yRmlsZShT\ndHJpbmcgZGlyKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBGaWxlIHZl\ncnNpb25GaWxlID0gbmV3IEZpbGUoZGlyLCAiVkVSU0lPTiIpOwoKICAgICAg\nICBGaWxlT3V0cHV0U3RyZWFtIGZvcyA9IG5ldyBGaWxlT3V0cHV0U3RyZWFt\nKHZlcnNpb25GaWxlKTsKICAgICAgICBCdWZmZXJlZFdyaXRlciBidyA9IG51\nbGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYncgPSBuZXcgQnVmZmVy\nZWRXcml0ZXIobmV3IE91dHB1dFN0cmVhbVdyaXRlcihmb3MpKTsKICAgICAg\nICAgICAgYncud3JpdGUoU3RyaW5nLnZhbHVlT2YoMikpOwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIGlmIChidyAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBidy5jbG9zZSgpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGZvcy5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBzdGF0aWMg\nU3RyaW5nIG5ld1YySm91cm5hbERpcmVjdG9yeSgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIFN0cmluZyBkID0gbmV3VjFKb3VybmFsRGlyZWN0b3J5\nKCk7CiAgICAgICAgY3JlYXRlVmVyc2lvbjJGaWxlKGQpOwogICAgICAgIHJl\ndHVybiBkOwogICAgfQoKICAgIHN0YXRpYyBTdHJpbmcgbmV3VjJMZWRnZXJE\naXJlY3RvcnkoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcg\nZCA9IG5ld1YxTGVkZ2VyRGlyZWN0b3J5KCk7CiAgICAgICAgY3JlYXRlVmVy\nc2lvbjJGaWxlKGQpOwogICAgICAgIHJldHVybiBkOwogICAgfQoKICAgIHBy\naXZhdGUgc3RhdGljIHZvaWQgdGVzdFVwZ3JhZGVQcm9jZWVkdXJlKFN0cmlu\nZyB6a1NlcnZlcnMsIFN0cmluZyBqb3VybmFsRGlyLCBTdHJpbmcgbGVkZ2Vy\nRGlyKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTZXJ2ZXJDb25maWd1\ncmF0aW9uIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbigpCiAgICAg\nICAgICAgIC5zZXRaa1NlcnZlcnMoemtTZXJ2ZXJzKQogICAgICAgICAgICAu\nc2V0Sm91cm5hbERpck5hbWUoam91cm5hbERpcikKICAgICAgICAgICAgLnNl\ndExlZGdlckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7IGxlZGdlckRpciB9KQog\nICAgICAgICAgICAuc2V0Qm9va2llUG9ydChib29raWVQb3J0KTsKICAgICAg\nICBCb29raWUgYiA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYiA9IG5ldyBCb29raWUoY29uZik7CiAgICAgICAgICAgIGZhaWwoIlNob3Vs\nZG4ndCBoYXZlIGJlZW4gYWJsZSB0byBzdGFydCIpOwogICAgICAgIH0gY2F0\nY2ggKEJvb2tpZUV4Y2VwdGlvbi5JbnZhbGlkQ29va2llRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgLy8gY29ycmVjdCBiZWhhdmlvdXIKICAgICAgICAg\nICAgYXNzZXJ0VHJ1ZSgid3JvbmcgZXhjZXB0aW9uIiwgZS5nZXRNZXNzYWdl\nKCkuY29udGFpbnMoInVwZ3JhZGUgbmVlZGVkIikpOwogICAgICAgIH0KCiAg\nICAgICAgRmlsZVN5c3RlbVVwZ3JhZGUudXBncmFkZShjb25mKTsgLy8gc2hv\ndWxkIHdvcmsgZmluZQogICAgICAgIGIgPSBuZXcgQm9va2llKGNvbmYpOwog\nICAgICAgIGIuc3RhcnQoKTsKICAgICAgICBiLnNodXRkb3duKCk7CiAgICAg\nICAgYiA9IG51bGw7CgogICAgICAgIEZpbGVTeXN0ZW1VcGdyYWRlLnJvbGxi\nYWNrKGNvbmYpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGIgPSBuZXcg\nQm9va2llKGNvbmYpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgaGF2\nZSBiZWVuIGFibGUgdG8gc3RhcnQiKTsKICAgICAgICB9IGNhdGNoIChCb29r\naWVFeGNlcHRpb24uSW52YWxpZENvb2tpZUV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIC8vIGNvcnJlY3QgYmVoYXZpb3VyCiAgICAgICAgICAgIGFzc2Vy\ndFRydWUoIndyb25nIGV4Y2VwdGlvbiIsIGUuZ2V0TWVzc2FnZSgpLmNvbnRh\naW5zKCJ1cGdyYWRlIG5lZWRlZCIpKTsKICAgICAgICB9CgogICAgICAgIEZp\nbGVTeXN0ZW1VcGdyYWRlLnVwZ3JhZGUoY29uZik7CiAgICAgICAgRmlsZVN5\nc3RlbVVwZ3JhZGUuZmluYWxpemVVcGdyYWRlKGNvbmYpOwogICAgICAgIGIg\nPSBuZXcgQm9va2llKGNvbmYpOwogICAgICAgIGIuc3RhcnQoKTsKICAgICAg\nICBiLnNodXRkb3duKCk7CiAgICAgICAgYiA9IG51bGw7CiAgICB9CgogICAg\nQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RVcGdy\nYWRlVjF0b0N1cnJlbnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBT\ndHJpbmcgam91cm5hbERpciA9IG5ld1YxSm91cm5hbERpcmVjdG9yeSgpOwog\nICAgICAgIFN0cmluZyBsZWRnZXJEaXIgPSBuZXdWMUxlZGdlckRpcmVjdG9y\neSgpOwogICAgICAgIHRlc3RVcGdyYWRlUHJvY2VlZHVyZSh6a3V0aWwuZ2V0\nWm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLCBqb3VybmFsRGlyLCBsZWRnZXJE\naXIpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJs\naWMgdm9pZCB0ZXN0VXBncmFkZVYydG9DdXJyZW50KCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgU3RyaW5nIGpvdXJuYWxEaXIgPSBuZXdWMkpvdXJu\nYWxEaXJlY3RvcnkoKTsKICAgICAgICBTdHJpbmcgbGVkZ2VyRGlyID0gbmV3\nVjJMZWRnZXJEaXJlY3RvcnkoKTsKICAgICAgICB0ZXN0VXBncmFkZVByb2Nl\nZWR1cmUoemt1dGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwgam91\ncm5hbERpciwgbGVkZ2VyRGlyKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0\nPTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFVwZ3JhZGVDdXJyZW50KCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIGpvdXJuYWxEaXIg\nPSBuZXdWMkpvdXJuYWxEaXJlY3RvcnkoKTsKICAgICAgICBTdHJpbmcgbGVk\nZ2VyRGlyID0gbmV3VjJMZWRnZXJEaXJlY3RvcnkoKTsKICAgICAgICB0ZXN0\nVXBncmFkZVByb2NlZWR1cmUoemt1dGlsLmdldFpvb0tlZXBlckNvbm5lY3RT\ndHJpbmcoKSwgam91cm5hbERpciwgbGVkZ2VyRGlyKTsKICAgICAgICAvLyBV\ncGdyYWRlIGFnYWluCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBjb25m\nID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oKQogICAgICAgICAgICAuc2V0\nWmtTZXJ2ZXJzKHprdXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCkp\nCiAgICAgICAgICAgIC5zZXRKb3VybmFsRGlyTmFtZShqb3VybmFsRGlyKQog\nICAgICAgICAgICAuc2V0TGVkZ2VyRGlyTmFtZXMobmV3IFN0cmluZ1tdIHsg\nbGVkZ2VyRGlyIH0pCiAgICAgICAgICAgIC5zZXRCb29raWVQb3J0KGJvb2tp\nZVBvcnQpOwogICAgICAgIEZpbGVTeXN0ZW1VcGdyYWRlLnVwZ3JhZGUoY29u\nZik7IC8vIHNob3VsZCB3b3JrIGZpbmUgd2l0aCBjdXJyZW50IGRpcmVjdG9y\neQogICAgICAgIEJvb2tpZSBiID0gbmV3IEJvb2tpZShjb25mKTsKICAgICAg\nICBiLnN0YXJ0KCk7CiAgICAgICAgYi5zaHV0ZG93bigpOwogICAgfQoKICAg\nIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q29t\nbWFuZExpbmUoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBQcmludFN0\ncmVhbSBvcmlnZXJyID0gU3lzdGVtLmVycjsKICAgICAgICBQcmludFN0cmVh\nbSBvcmlnb3V0ID0gU3lzdGVtLm91dDsKCiAgICAgICAgRmlsZSBvdXRwdXQg\nPSBGaWxlLmNyZWF0ZVRlbXBGaWxlKCJib29raWUiLCAic3Rkb3V0Iik7CiAg\nICAgICAgRmlsZSBlcnJvdXRwdXQgPSBGaWxlLmNyZWF0ZVRlbXBGaWxlKCJi\nb29raWUiLCAic3RkZXJyIik7CiAgICAgICAgU3lzdGVtLnNldE91dChuZXcg\nUHJpbnRTdHJlYW0ob3V0cHV0KSk7CiAgICAgICAgU3lzdGVtLnNldEVycihu\nZXcgUHJpbnRTdHJlYW0oZXJyb3V0cHV0KSk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgRmlsZVN5c3RlbVVwZ3JhZGUubWFpbihuZXcgU3RyaW5nW10g\neyAiLWgiIH0pOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nLy8gdGVzdCB3aXRob3V0IGNvbmYKICAgICAgICAgICAgICAgIEZpbGVTeXN0\nZW1VcGdyYWRlLm1haW4obmV3IFN0cmluZ1tdIHsgIi11IiB9KTsKICAgICAg\nICAgICAgICAgIGZhaWwoIlNob3VsZCBoYXZlIGZhaWxlZCIpOwogICAgICAg\nICAgICB9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWFlKSB7\nCiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKCJXcm9uZyBleGNlcHRpb24g\nIiArIGlhZS5nZXRNZXNzYWdlKCksCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGlhZS5nZXRNZXNzYWdlKCkuY29udGFpbnMoIndpdGhvdXQgY29uZmln\ndXJhdGlvbiIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBGaWxlIGYg\nPSBGaWxlLmNyZWF0ZVRlbXBGaWxlKCJib29raWUiLCAidG1wY29uZiIpOwog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gdGVzdCB3aXRo\nb3V0IHVwZ3JhZGUgb3AKICAgICAgICAgICAgICAgIEZpbGVTeXN0ZW1VcGdy\nYWRlLm1haW4obmV3IFN0cmluZ1tdIHsgIi0tY29uZiIsIGYuZ2V0UGF0aCgp\nIH0pOwogICAgICAgICAgICAgICAgZmFpbCgiU2hvdWxkIGhhdmUgZmFpbGVk\nIik7CiAgICAgICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2Vw\ndGlvbiBpYWUpIHsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUoIldyb25n\nIGV4Y2VwdGlvbiAiICsgaWFlLmdldE1lc3NhZ2UoKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWFlLmdldE1lc3NhZ2UoKS5jb250YWlucygiTXVz\ndCBzcGVjaWZ5IC11cGdyYWRlIikpOwogICAgICAgICAgICB9CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgU3lzdGVtLnNldE91dChvcmlnb3V0\nKTsKICAgICAgICAgICAgU3lzdGVtLnNldEVycihvcmlnZXJyKTsKICAgICAg\nICB9CiAgICB9Cn0K\n","encoding":"base64"}

