{"sha":"bc3c8995248900648354ffb2f16b704167780bd9","node_id":"MDQ6QmxvYjE1NzU5NTY6YmMzYzg5OTUyNDg5MDA2NDgzNTRmZmIyZjE2YjcwNDE2Nzc4MGJkOQ==","size":6517,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/bc3c8995248900648354ffb2f16b704167780bd9","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhOwoKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLlJhbmRvbTsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5D\nb3VudERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0\nb21pYy5BdG9taWNJbnRlZ2VyOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5ib29raWUuR2FyYmFnZUNvbGxlY3RvcjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5ib29raWUuU2NhbkFuZENvbXBhcmVHYXJiYWdlQ29s\nbGVjdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5C\nS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGll\nbnQuTGVkZ2VyTWV0YWRhdGE7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxs\nYmFja3MuR2VuZXJpY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnZlcnNpb25pbmcuVmVyc2lvbjsKaW1wb3J0IG9yZy5zbGY0ai5M\nb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9y\ndCBvcmcuanVuaXQuVGVzdDsKCi8qKgogKiBUZXN0IGdhcmJhZ2UgY29sbGVj\ndGlvbiBsZWRnZXJzIGluIGxlZGdlciBtYW5hZ2VyCiAqLwpwdWJsaWMgY2xh\nc3MgR2NMZWRnZXJzVGVzdCBleHRlbmRzIExlZGdlck1hbmFnZXJUZXN0Q2Fz\nZSB7CiAgICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3Rv\ncnkuZ2V0TG9nZ2VyKEdjTGVkZ2Vyc1Rlc3QuY2xhc3MpOwoKICAgIHB1Ymxp\nYyBHY0xlZGdlcnNUZXN0KENsYXNzPD8gZXh0ZW5kcyBMZWRnZXJNYW5hZ2Vy\nRmFjdG9yeT4gbG1GYWN0b3J5Q2xzKSB7CiAgICAgICAgc3VwZXIobG1GYWN0\nb3J5Q2xzKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBsZWRnZXJz\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBjcmVhdGVMZWRnZXJzKGludCBu\ndW1MZWRnZXJzLCBmaW5hbCBTZXQ8TG9uZz4gY3JlYXRlZExlZGdlcnMpIHsK\nICAgICAgICBmaW5hbCBBdG9taWNJbnRlZ2VyIGV4cGVjdGVkID0gbmV3IEF0\nb21pY0ludGVnZXIobnVtTGVkZ2Vycyk7CiAgICAgICAgZm9yIChpbnQgaT0w\nOyBpPG51bUxlZGdlcnM7IGkrKykgewogICAgICAgICAgICBnZXRMZWRnZXJN\nYW5hZ2VyKCkuY3JlYXRlTGVkZ2VyKG5ldyBMZWRnZXJNZXRhZGF0YSgxLCAx\nLCAxLCBEaWdlc3RUeXBlLk1BQywgIiIuZ2V0Qnl0ZXMoKSksCiAgICAgICAg\nICAgICAgICBuZXcgR2VuZXJpY0NhbGxiYWNrPExvbmc+KCkgewogICAgICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIExvbmcgbGVkZ2VySWQpIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29k\nZS5PSykgewogICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVMZWRnZXJz\nLnB1dChsZWRnZXJJZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGNyZWF0ZWRMZWRnZXJzLmFkZChsZWRnZXJJZCk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAoZXhw\nZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IG51bSA9IGV4\ncGVjdGVkLmRlY3JlbWVudEFuZEdldCgpOwogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAobnVtID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGV4cGVjdGVkLm5vdGlmeSgpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgc3luY2hyb25pemVk\nIChleHBlY3RlZCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgd2hpbGUgKGV4cGVjdGVkLmdldCgpID4gMCkgewogICAgICAgICAgICAg\nICAgICAgIGV4cGVjdGVkLndhaXQoMTAwKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUp\nIHsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0\naW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdEdhcmJhZ2VDb2xs\nZWN0TGVkZ2VycygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBu\ndW1MZWRnZXJzID0gMTAwOwogICAgICAgIGludCBudW1SZW1vdmVkTGVkZ2Vy\ncyA9IDEwOwoKICAgICAgICBmaW5hbCBTZXQ8TG9uZz4gY3JlYXRlZExlZGdl\ncnMgPSBuZXcgSGFzaFNldDxMb25nPigpOwogICAgICAgIGZpbmFsIFNldDxM\nb25nPiByZW1vdmVkTGVkZ2VycyA9IG5ldyBIYXNoU2V0PExvbmc+KCk7Cgog\nICAgICAgIC8vIGNyZWF0ZSAxMDAgbGVkZ2VycwogICAgICAgIGNyZWF0ZUxl\nZGdlcnMobnVtTGVkZ2VycywgY3JlYXRlZExlZGdlcnMpOwoKICAgICAgICBS\nYW5kb20gciA9IG5ldyBSYW5kb20oU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlz\nKCkpOwogICAgICAgIGZpbmFsIExpc3Q8TG9uZz4gdG1wTGlzdCA9IG5ldyBB\ncnJheUxpc3Q8TG9uZz4oKTsKICAgICAgICB0bXBMaXN0LmFkZEFsbChjcmVh\ndGVkTGVkZ2Vycyk7CiAgICAgICAgQ29sbGVjdGlvbnMuc2h1ZmZsZSh0bXBM\naXN0LCByKTsKICAgICAgICAvLyByYW5kb20gcmVtb3ZlIHNldmVyYWwgbGVk\nZ2VycwogICAgICAgIGZvciAoaW50IGk9MDsgaTxudW1SZW1vdmVkTGVkZ2Vy\nczsgaSsrKSB7CiAgICAgICAgICAgIGxvbmcgbGVkZ2VySWQgPSB0bXBMaXN0\nLmdldChpKTsKICAgICAgICAgICAgc3luY2hyb25pemVkIChyZW1vdmVkTGVk\nZ2VycykgewogICAgICAgICAgICAgICAgZ2V0TGVkZ2VyTWFuYWdlcigpLnJl\nbW92ZUxlZGdlck1ldGFkYXRhKGxlZGdlcklkLCBWZXJzaW9uLkFOWSwKICAg\nICAgICAgICAgICAgICAgICBuZXcgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+KCkg\newogICAgICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAg\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUo\naW50IHJjLCBWb2lkIHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgc3luY2hyb25pemVkIChyZW1vdmVkTGVkZ2VycykgewogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWRMZWRnZXJzLm5vdGlm\neSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAg\nICAgICAgICAgICByZW1vdmVkTGVkZ2Vycy53YWl0KCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgcmVtb3ZlZExlZGdlcnMuYWRkKGxlZGdlcklkKTsK\nICAgICAgICAgICAgY3JlYXRlZExlZGdlcnMucmVtb3ZlKGxlZGdlcklkKTsK\nICAgICAgICB9CiAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggaW5HY1By\nb2dyZXNzID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgIGZpbmFs\nIENvdW50RG93bkxhdGNoIGNyZWF0ZUxhdGNoID0gbmV3IENvdW50RG93bkxh\ndGNoKDEpOwogICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIGVuZExhdGNo\nID0gbmV3IENvdW50RG93bkxhdGNoKDIpOwogICAgICAgIGZpbmFsIEdhcmJh\nZ2VDb2xsZWN0b3IgZ2FyYmFnZUNvbGxlY3RvciA9CiAgICAgICAgICAgICAg\nICBuZXcgU2NhbkFuZENvbXBhcmVHYXJiYWdlQ29sbGVjdG9yKGdldExlZGdl\nck1hbmFnZXIoKSwgYWN0aXZlTGVkZ2Vycyk7CiAgICAgICAgVGhyZWFkIGdj\nVGhyZWFkID0gbmV3IFRocmVhZCgpIHsKICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAg\nICAgIGdhcmJhZ2VDb2xsZWN0b3IuZ2MobmV3IEdhcmJhZ2VDb2xsZWN0b3Iu\nR2FyYmFnZUNsZWFuZXIoKSB7CiAgICAgICAgICAgICAgICAgICAgYm9vbGVh\nbiBwYXVzZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBjbGVhbihsb25n\nIGxlZGdlcklkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGF1\nc2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbkdjUHJvZ3Jl\nc3MuY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxh\ndGNoLmF3YWl0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\ncGF1c2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiR2FyYmFnZSBDb2xsZWN0\nZWQgbGVkZ2VyIHt9IiwgbGVkZ2VySWQpOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgTE9HLmlu\nZm8oIkdjIFRocmVhZCBxdWl0cy4iKTsKICAgICAgICAgICAgICAgIGVuZExh\ndGNoLmNvdW50RG93bigpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAg\nICAgICAgVGhyZWFkIGNyZWF0ZVRocmVhZCA9IG5ldyBUaHJlYWQoKSB7CiAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIGluR2NQcm9ncmVzcy5hd2FpdCgpOwogICAgICAgICAgICAgICAgICAg\nIC8vIGNyZWF0ZSAxMCBtb3JlIGxlZGdlcnMKICAgICAgICAgICAgICAgICAg\nICBjcmVhdGVMZWRnZXJzKDEwLCBjcmVhdGVkTGVkZ2Vycyk7CiAgICAgICAg\nICAgICAgICAgICAgTE9HLmluZm8oIkZpbmlzaGVkIGNyZWF0aW5nIDEwIG1v\ncmUgbGVkZ2Vycy4iKTsKICAgICAgICAgICAgICAgICAgICBjcmVhdGVMYXRj\naC5jb3VudERvd24oKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBM\nT0cuaW5mbygiQ3JlYXRlIFRocmVhZCBxdWl0cy4iKTsKICAgICAgICAgICAg\nICAgIGVuZExhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICB9CiAgICAg\nICAgfTsKCiAgICAgICAgY3JlYXRlVGhyZWFkLnN0YXJ0KCk7CiAgICAgICAg\nZ2NUaHJlYWQuc3RhcnQoKTsKCiAgICAgICAgZW5kTGF0Y2guYXdhaXQoKTsK\nCiAgICAgICAgLy8gdGVzdCBsZWRnZXJzCiAgICAgICAgZm9yIChMb25nIGxl\nZGdlciA6IHJlbW92ZWRMZWRnZXJzKSB7CiAgICAgICAgICAgIGFzc2VydEZh\nbHNlKGFjdGl2ZUxlZGdlcnMuY29udGFpbnNLZXkobGVkZ2VyKSk7CiAgICAg\nICAgfQogICAgICAgIGZvciAoTG9uZyBsZWRnZXIgOiBjcmVhdGVkTGVkZ2Vy\ncykgewogICAgICAgICAgICBhc3NlcnRUcnVlKGFjdGl2ZUxlZGdlcnMuY29u\ndGFpbnNLZXkobGVkZ2VyKSk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

