{"sha":"d6af24c911b84cafe172eba2af2bbd8b5a61afcf","node_id":"MDQ6QmxvYjE1NzU5NTY6ZDZhZjI0YzkxMWI4NGNhZmUxNzJlYmEyYWYyYmJkOGI1YTYxYWZjZg==","size":11702,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/d6af24c911b84cafe172eba2af2bbd8b5a61afcf","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGE7CgppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRp\nZ2VzdFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5D\nbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVw\nZXIuV2F0Y2hlZEV2ZW50OwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nV2F0Y2hlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29EZWZzLklkczsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkN5Y2xpY0JhcnJpZXI7CmltcG9ydCBq\nYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEubGFuZy5yZWZsZWN0LkZpZWxkOwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2U7\nCmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVm\nb3JlOwppbXBvcnQgb3JnLmp1bml0LlRlc3Q7CmltcG9ydCBvcmcuanVuaXQu\nQXNzZXJ0Lio7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKcHVibGljIGNsYXNzIFRlc3RMZWRn\nZXJNYW5hZ2VyIGV4dGVuZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7\nCiAgICBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9n\nZ2VyKFRlc3RMZWRnZXJNYW5hZ2VyLmNsYXNzKTsKCiAgICBwdWJsaWMgVGVz\ndExlZGdlck1hbmFnZXIoKSB7CiAgICAgICAgc3VwZXIoMCk7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIHdyaXRlTGVkZ2VyTGF5b3V0KFN0cmluZyBsZWRn\nZXJzUm9vdFBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgU3RyaW5nIG1hbmFnZXJUeXBlLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGludCBtYW5hZ2VyVmVyc2lvbiwgaW50IGxheW91dFZl\ncnNpb24pCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTGVk\nZ2VyTGF5b3V0IGxheW91dCA9IG5ldyBMZWRnZXJMYXlvdXQobWFuYWdlclR5\ncGUsIG1hbmFnZXJWZXJzaW9uKTsKCiAgICAgICAgRmllbGQgZiA9IExlZGdl\nckxheW91dC5jbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJsYXlvdXRGb3JtYXRW\nZXJzaW9uIik7CiAgICAgICAgZi5zZXRBY2Nlc3NpYmxlKHRydWUpOwogICAg\nICAgIGYuc2V0KGxheW91dCwgbGF5b3V0VmVyc2lvbik7CgogICAgICAgIGxh\neW91dC5zdG9yZSh6a2MsIGxlZGdlcnNSb290UGF0aCk7CiAgICB9CgogICAg\nLyoqIAogICAgICogVGVzdCBiYWQgY2xpZW50IGNvbmZpZ3VyYXRpb24KICAg\nICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RCYWRDb25mKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xp\nZW50Q29uZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRp\nb24oKTsKICAgICAgICAKICAgICAgICAvLyBzdWNjZXNzIGNhc2UKICAgICAg\nICBTdHJpbmcgcm9vdDAgPSAiL2dvb2Rjb25mMCI7CiAgICAgICAgemtjLmNy\nZWF0ZShyb290MCwgbmV3IGJ5dGVbMF0sIAogICAgICAgICAgICAgICAgICAg\nSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsK\nICAgICAgICBjb25mLnNldFprTGVkZ2Vyc1Jvb3RQYXRoKHJvb3QwKTsKCiAg\nICAgICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkgbSA9IExlZGdlck1hbmFnZXJG\nYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXJGYWN0b3J5KGNvbmYsIHprYyk7CiAg\nICAgICAgYXNzZXJ0VHJ1ZSgiTGVkZ2VyIG1hbmFnZXIgaXMgdW5leHBlY3Rl\nZCB0eXBlIiwgCiAgICAgICAgICAgICAgICAgICAobSBpbnN0YW5jZW9mIEZs\nYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeSkpOwogICAgICAgIG0udW5pbml0aWFs\naXplKCk7CgogICAgICAgIC8vIG1pc21hdGNoaW5nIGNvbmYKICAgICAgICBj\nb25mLnNldExlZGdlck1hbmFnZXJGYWN0b3J5Q2xhc3MoSGllcmFyY2hpY2Fs\nTGVkZ2VyTWFuYWdlckZhY3RvcnkuY2xhc3MpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIExlZGdlck1hbmFnZXJGYWN0b3J5Lm5ld0xlZGdlck1hbmFn\nZXJGYWN0b3J5KGNvbmYsIHprYyk7CiAgICAgICAgICAgIGZhaWwoIlNob3Vs\nZG4ndCByZWFjaCBoZXJlIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJSZWNlaXZlZCBleGNlcHRp\nb24iLCBlKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiSW52YWxpZCBleGNl\ncHRpb24iLCAKICAgICAgICAgICAgICAgICAgICAgICBlLmdldE1lc3NhZ2Uo\nKS5jb250YWlucygiZG9lcyBub3QgbWF0Y2ggZXhpc3RpbmcgbGF5b3V0Iikp\nOwogICAgICAgIH0KCiAgICAgICAgLy8gaW52YWxpZCBsZWRnZXIgbWFuYWdl\ncgogICAgICAgIFN0cmluZyByb290MSA9ICIvYmFkY29uZjEiOwogICAgICAg\nIHprYy5jcmVhdGUocm9vdDEsIG5ldyBieXRlWzBdLCAKICAgICAgICAgICAg\nICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lT\nVEVOVCk7CiAgICAgICAgY29uZi5zZXRaa0xlZGdlcnNSb290UGF0aChyb290\nMSk7CgogICAgICAgIGNvbmYuc2V0TGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFz\nc05hbWUoIkRvZXNOb3RFeGlzdCIpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIExlZGdlck1hbmFnZXJGYWN0b3J5IGYgPSBMZWRnZXJNYW5hZ2VyRmFj\ndG9yeS5uZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeShjb25mLCB6a2MpOwogICAg\nICAgICAgICBmYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSIpOwogICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJv\ncigiUmVjZWl2ZWQgZXhjZXB0aW9uIiwgZSk7CiAgICAgICAgICAgIGFzc2Vy\ndFRydWUoIkludmFsaWQgZXhjZXB0aW9uIiwKICAgICAgICAgICAgICAgICAg\nICBlLmdldE1lc3NhZ2UoKS5jb250YWlucygiRmFpbGVkIHRvIGdldCBsZWRn\nZXIgbWFuYWdlciBmYWN0b3J5IGNsYXNzIGZyb20gY29uZmlndXJhdGlvbiIp\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IGJhZCBj\nbGllbnQgY29uZmlndXJhdGlvbgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0\nPTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdEJhZENvbmZWMSgpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29u\nZiA9IG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCk7CgogICAgICAgIFN0cmlu\nZyByb290MCA9ICIvZ29vZGNvbmYwIjsKICAgICAgICB6a2MuY3JlYXRlKHJv\nb3QwLCBuZXcgYnl0ZVswXSwKICAgICAgICAgICAgICAgICAgIElkcy5PUEVO\nX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lTVEVOVCk7CiAgICAgICAg\nY29uZi5zZXRaa0xlZGdlcnNSb290UGF0aChyb290MCk7CiAgICAgICAgLy8g\nd3JpdGUgdjEgbGF5b3V0CiAgICAgICAgd3JpdGVMZWRnZXJMYXlvdXQocm9v\ndDAsIEZsYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeS5OQU1FLAogICAgICAgICAg\nICAgICAgICAgICAgICAgIEZsYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeS5DVVJf\nVkVSU0lPTiwgMSk7CgogICAgICAgIGNvbmYuc2V0TGVkZ2VyTWFuYWdlckZh\nY3RvcnlDbGFzcyhGbGF0TGVkZ2VyTWFuYWdlckZhY3RvcnkuY2xhc3MpOwoK\nICAgICAgICBMZWRnZXJNYW5hZ2VyRmFjdG9yeSBtID0gTGVkZ2VyTWFuYWdl\nckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZhY3RvcnkoY29uZiwgemtjKTsK\nICAgICAgICBhc3NlcnRUcnVlKCJMZWRnZXIgbWFuYWdlciBpcyB1bmV4cGVj\ndGVkIHR5cGUiLAogICAgICAgICAgICAgICAgICAgKG0gaW5zdGFuY2VvZiBG\nbGF0TGVkZ2VyTWFuYWdlckZhY3RvcnkpKTsKICAgICAgICBtLnVuaW5pdGlh\nbGl6ZSgpOwoKICAgICAgICAvLyB2MiBzZXR0aW5nIGRvZXNuJ3QgZWZmZWN0\nIHYxCiAgICAgICAgY29uZi5zZXRMZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNz\nKEhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXJGYWN0b3J5LmNsYXNzKTsKICAg\nICAgICBtID0gTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdl\nckZhY3RvcnkoY29uZiwgemtjKTsKICAgICAgICBhc3NlcnRUcnVlKCJMZWRn\nZXIgbWFuYWdlciBpcyB1bmV4cGVjdGVkIHR5cGUiLAogICAgICAgICAgICAg\nICAgICAgKG0gaW5zdGFuY2VvZiBGbGF0TGVkZ2VyTWFuYWdlckZhY3Rvcnkp\nKTsKICAgICAgICBtLnVuaW5pdGlhbGl6ZSgpOwoKICAgICAgICAvLyBtaXNt\nYXRjaGluZyBjb25mCiAgICAgICAgY29uZi5zZXRMZWRnZXJNYW5hZ2VyVHlw\nZShIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyRmFjdG9yeS5OQU1FKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBMZWRnZXJNYW5hZ2VyRmFjdG9yeS5u\nZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeShjb25mLCB6a2MpOwogICAgICAgICAg\nICBmYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSIpOwogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiUmVj\nZWl2ZWQgZXhjZXB0aW9uIiwgZSk7CiAgICAgICAgICAgIGFzc2VydFRydWUo\nIkludmFsaWQgZXhjZXB0aW9uIiwgCiAgICAgICAgICAgICAgICAgICAgICAg\nZS5nZXRNZXNzYWdlKCkuY29udGFpbnMoImRvZXMgbm90IG1hdGNoIGV4aXN0\naW5nIGxheW91dCIpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUZXN0IGJhZCB6ayBjb25maWd1cmF0aW9uCiAgICAgKi8KICAgIEBUZXN0\nKHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmFkWmtDb250\nZW50cygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENsaWVudENvbmZp\nZ3VyYXRpb24gY29uZiA9IG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgCiAgICAgICAgLy8gYmFkIHR5cGUgaW4gem9va2VlcGVyCiAgICAg\nICAgU3RyaW5nIHJvb3QwID0gIi9iYWR6azAiOwogICAgICAgIHprYy5jcmVh\ndGUocm9vdDAsIG5ldyBieXRlWzBdLCAKICAgICAgICAgICAgICAgICAgIElk\ncy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lTVEVOVCk7CiAg\nICAgICAgY29uZi5zZXRaa0xlZGdlcnNSb290UGF0aChyb290MCk7CiAgICAg\nICAgCiAgICAgICAgbmV3IExlZGdlckxheW91dCgiRG9lc05vdEV4aXN0IiwK\nICAgICAgICAgICAgICAgICAgICAgICAgIDB4ZGVhZGJlZWYpLnN0b3JlKHpr\nYywgcm9vdDApOwogICAgICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIExlZGdlck1hbmFnZXJGYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXJGYWN0b3J5\nKGNvbmYsIHprYyk7CiAgICAgICAgICAgIGZhaWwoIlNob3VsZG4ndCByZWFj\naCBoZXJlIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgTE9HLmVycm9yKCJSZWNlaXZlZCBleGNlcHRpb24iLCBlKTsK\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiSW52YWxpZCBleGNlcHRpb24iLCAK\nICAgICAgICAgICAgICAgICAgICBlLmdldE1lc3NhZ2UoKS5jb250YWlucygi\nRmFpbGVkIHRvIGluc3RhbnRpYXRlIGxlZGdlciBtYW5hZ2VyIGZhY3Rvcnki\nKSk7CiAgICAgICAgfQoKICAgICAgICAvLyBiYWQgdmVyc2lvbiBpbiB6b29r\nZWVwZXIKICAgICAgICBTdHJpbmcgcm9vdDEgPSAiL2JhZHprMSI7CiAgICAg\nICAgemtjLmNyZWF0ZShyb290MSwgbmV3IGJ5dGVbMF0sIAogICAgICAgICAg\nICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJT\nSVNURU5UKTsKICAgICAgICBjb25mLnNldFprTGVkZ2Vyc1Jvb3RQYXRoKHJv\nb3QxKTsKICAgICAgICAKICAgICAgICBuZXcgTGVkZ2VyTGF5b3V0KEZsYXRM\nZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcy5nZXROYW1lKCksCiAgICAgICAg\nICAgICAgICAgICAgICAgICAweGRlYWRiZWVmKS5zdG9yZSh6a2MsIHJvb3Qx\nKTsKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBMZWRnZXJN\nYW5hZ2VyRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeShjb25mLCB6\na2MpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSIp\nOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nIExPRy5lcnJvcigiUmVjZWl2ZWQgZXhjZXB0aW9uIiwgZSk7CiAgICAgICAg\nICAgIGFzc2VydFRydWUoIkludmFsaWQgZXhjZXB0aW9uIiwgCiAgICAgICAg\nICAgICAgICAgICAgZS5nZXRNZXNzYWdlKCkuY29udGFpbnMoIkluY29tcGF0\naWJsZSBsYXlvdXQgdmVyc2lvbiBmb3VuZCIpKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQ3JlYXRlTE1UaHJlYWQgZXh0\nZW5kcyBUaHJlYWQgewogICAgICAgIHByaXZhdGUgYm9vbGVhbiBzdWNjZXNz\nID0gZmFsc2U7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgZmFjdG9y\neUNsczsKICAgICAgICBwcml2YXRlIGZpbmFsIFN0cmluZyByb290OwogICAg\nICAgIHByaXZhdGUgZmluYWwgQ3ljbGljQmFycmllciBiYXJyaWVyOwogICAg\nICAgIHByaXZhdGUgWm9vS2VlcGVyIHprYzsKICAgICAgICAKICAgICAgICBD\ncmVhdGVMTVRocmVhZChTdHJpbmcgemtDb25uZWN0U3RyaW5nLCBTdHJpbmcg\ncm9vdCwKICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgZmFjdG9yeUNs\ncywgQ3ljbGljQmFycmllciBiYXJyaWVyKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgdGhpcy5mYWN0b3J5Q2xzID0gZmFjdG9yeUNsczsKICAg\nICAgICAgICAgdGhpcy5iYXJyaWVyID0gYmFycmllcjsKICAgICAgICAgICAg\ndGhpcy5yb290ID0gcm9vdDsKICAgICAgICAgICAgZmluYWwgQ291bnREb3du\nTGF0Y2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAg\nICAgIHprYyA9IG5ldyBab29LZWVwZXIoemtDb25uZWN0U3RyaW5nLCAxMDAw\nMCwgbmV3IFdhdGNoZXIoKSB7CiAgICAgICAgICAgICAgICAgICAgcHVibGlj\nIHZvaWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGxh\ndGNoLmF3YWl0KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9\nIG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGNvbmYu\nc2V0TGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFzc05hbWUoZmFjdG9yeUNscyk7\nCgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYmFycmllci5h\nd2FpdCgpOwogICAgICAgICAgICAgICAgTGVkZ2VyTWFuYWdlckZhY3Rvcnkg\nZmFjdG9yeSA9CiAgICAgICAgICAgICAgICAgICAgTGVkZ2VyTWFuYWdlckZh\nY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZhY3RvcnkoY29uZiwgemtjKTsKICAg\nICAgICAgICAgICAgIGZhY3RvcnkudW5pbml0aWFsaXplKCk7CiAgICAgICAg\nICAgICAgICAKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlOwogICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgTE9HLmVycm9yKCJGYWlsZWQgdG8gY3JlYXRlIGxlZGdlciBtYW5hZ2Vy\nIiwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIGlzU3VjY2Vzc2Z1bCgpIHsKICAgICAgICAgICAgcmV0dXJu\nIHN1Y2Nlc3M7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2\nb2lkIGNsb3NlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHpr\nYy5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyB0ZXN0IGNvbmN1\ncnJlbnQKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0Q29uY3VycmVudDEoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICAvLy8gZXZlcnlvbmUgY3JlYXRlcyB0aGUgc2FtZQogICAgICAgIGludCBu\ndW1UaHJlYWRzID0gNTA7CiAgICAgICAgCiAgICAgICAgLy8gYmFkIHZlcnNp\nb24gaW4gem9va2VlcGVyCiAgICAgICAgU3RyaW5nIHJvb3QwID0gIi9sbXJv\nb3QwIjsKICAgICAgICB6a2MuY3JlYXRlKHJvb3QwLCBuZXcgYnl0ZVswXSwg\nCiAgICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVh\ndGVNb2RlLlBFUlNJU1RFTlQpOwoKICAgICAgICBDeWNsaWNCYXJyaWVyIGJh\ncnJpZXIgPSBuZXcgQ3ljbGljQmFycmllcihudW1UaHJlYWRzKzEpOwogICAg\nICAgIExpc3Q8Q3JlYXRlTE1UaHJlYWQ+IHRocmVhZHMgPSBuZXcgQXJyYXlM\naXN0PENyZWF0ZUxNVGhyZWFkPihudW1UaHJlYWRzKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IG51bVRocmVhZHM7IGkrKykgewogICAgICAgICAg\nICBDcmVhdGVMTVRocmVhZCB0ID0gbmV3IENyZWF0ZUxNVGhyZWFkKHprVXRp\nbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCksCiAgICAgICAgICAgICAg\nICAgICAgcm9vdDAsIEZsYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcy5n\nZXROYW1lKCksIGJhcnJpZXIpOwogICAgICAgICAgICB0LnN0YXJ0KCk7CiAg\nICAgICAgICAgIHRocmVhZHMuYWRkKHQpOwogICAgICAgIH0KCiAgICAgICAg\nYmFycmllci5hd2FpdCgpOwoKICAgICAgICBib29sZWFuIHN1Y2Nlc3MgPSB0\ncnVlOwogICAgICAgIGZvciAoQ3JlYXRlTE1UaHJlYWQgdCA6IHRocmVhZHMp\nIHsKICAgICAgICAgICAgdC5qb2luKCk7CiAgICAgICAgICAgIHQuY2xvc2Uo\nKTsKICAgICAgICAgICAgc3VjY2VzcyA9IHQuaXNTdWNjZXNzZnVsKCkgJiYg\nc3VjY2VzczsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0VHJ1ZSgiTm90IGFs\nbCBsZWRnZXIgbWFuYWdlcnMgY3JlYXRlZCIsIHN1Y2Nlc3MpOwogICAgfQoK\nICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nQ29uY3VycmVudDIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLy8g\nb2RkIGNyZWF0ZSBkaWZmZXJlbnQKICAgICAgICBpbnQgbnVtVGhyZWFkc0Vh\nY2ggPSAyNTsKICAgICAgICAKICAgICAgICAvLyBiYWQgdmVyc2lvbiBpbiB6\nb29rZWVwZXIKICAgICAgICBTdHJpbmcgcm9vdDAgPSAiL2xtcm9vdDAiOwog\nICAgICAgIHprYy5jcmVhdGUocm9vdDAsIG5ldyBieXRlWzBdLCAKICAgICAg\nICAgICAgICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUu\nUEVSU0lTVEVOVCk7CgogICAgICAgIEN5Y2xpY0JhcnJpZXIgYmFycmllciA9\nIG5ldyBDeWNsaWNCYXJyaWVyKG51bVRocmVhZHNFYWNoKjIrMSk7CiAgICAg\nICAgTGlzdDxDcmVhdGVMTVRocmVhZD4gdGhyZWFkc0EgPSBuZXcgQXJyYXlM\naXN0PENyZWF0ZUxNVGhyZWFkPihudW1UaHJlYWRzRWFjaCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBudW1UaHJlYWRzRWFjaDsgaSsrKSB7CiAg\nICAgICAgICAgIENyZWF0ZUxNVGhyZWFkIHQgPSBuZXcgQ3JlYXRlTE1UaHJl\nYWQoemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwKICAgICAg\nICAgICAgICAgICAgICByb290MCwgRmxhdExlZGdlck1hbmFnZXJGYWN0b3J5\nLmNsYXNzLmdldE5hbWUoKSwgYmFycmllcik7CiAgICAgICAgICAgIHQuc3Rh\ncnQoKTsKICAgICAgICAgICAgdGhyZWFkc0EuYWRkKHQpOwogICAgICAgIH0K\nICAgICAgICBMaXN0PENyZWF0ZUxNVGhyZWFkPiB0aHJlYWRzQiA9IG5ldyBB\ncnJheUxpc3Q8Q3JlYXRlTE1UaHJlYWQ+KG51bVRocmVhZHNFYWNoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bVRocmVhZHNFYWNoOyBpKysp\nIHsKICAgICAgICAgICAgQ3JlYXRlTE1UaHJlYWQgdCA9IG5ldyBDcmVhdGVM\nTVRocmVhZCh6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLAog\nICAgICAgICAgICAgICAgICAgIHJvb3QwLCBIaWVyYXJjaGljYWxMZWRnZXJN\nYW5hZ2VyRmFjdG9yeS5jbGFzcy5nZXROYW1lKCksIGJhcnJpZXIpOwogICAg\nICAgICAgICB0LnN0YXJ0KCk7CiAgICAgICAgICAgIHRocmVhZHNCLmFkZCh0\nKTsKICAgICAgICB9CgogICAgICAgIGJhcnJpZXIuYXdhaXQoKTsKCiAgICAg\nICAgaW50IG51bVN1Y2Nlc3MgPSAwOwogICAgICAgIGludCBudW1GYWlscyA9\nIDA7CiAgICAgICAgZm9yIChDcmVhdGVMTVRocmVhZCB0IDogdGhyZWFkc0Ep\nIHsKICAgICAgICAgICAgdC5qb2luKCk7CiAgICAgICAgICAgIHQuY2xvc2Uo\nKTsKICAgICAgICAgICAgaWYgKHQuaXNTdWNjZXNzZnVsKCkpIHsKICAgICAg\nICAgICAgICAgIG51bVN1Y2Nlc3MrKzsKICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgIG51bUZhaWxzKys7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIGZvciAoQ3JlYXRlTE1UaHJlYWQgdCA6IHRocmVh\nZHNCKSB7CiAgICAgICAgICAgIHQuam9pbigpOwogICAgICAgICAgICB0LmNs\nb3NlKCk7CiAgICAgICAgICAgIGlmICh0LmlzU3VjY2Vzc2Z1bCgpKSB7CiAg\nICAgICAgICAgICAgICBudW1TdWNjZXNzKys7CiAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICBudW1GYWlscysrOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscygiSW5jb3JyZWN0IG51\nbWJlciBvZiBzdWNjZXNzZXMiLCBudW1UaHJlYWRzRWFjaCwgbnVtU3VjY2Vz\ncyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgbnVtYmVyIG9m\nIGZhaWx1cmVzIiwgbnVtVGhyZWFkc0VhY2gsIG51bUZhaWxzKTsKICAgIH0K\nfQo=\n","encoding":"base64"}

