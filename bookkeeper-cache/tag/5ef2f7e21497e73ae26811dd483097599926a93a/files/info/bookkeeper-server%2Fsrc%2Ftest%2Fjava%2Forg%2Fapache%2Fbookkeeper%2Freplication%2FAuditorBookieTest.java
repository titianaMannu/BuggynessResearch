{"sha":"60041360192efdbc739c523f257a73a88e121ed5","node_id":"MDQ6QmxvYjE1NzU5NTY6NjAwNDEzNjAxOTJlZmRiYzczOWM1MjNmMjU3YTczYTg4ZTEyMWVkNQ==","size":11164,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/60041360192efdbc739c523f257a73a88e121ed5","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQg\nanVuaXQuZnJhbWV3b3JrLkFzc2VydDsKCmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLlprVXRpbHM7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuem9va2VlcGVyLlpvb0tlZXBlcldhdGNo\nZXJCYXNlOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJv\nb2tLZWVwZXJDbHVzdGVyVGVzdENhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIudXRpbC5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0Owpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwoKLyoqCiAqIFRoaXMgdGVzdCB2ZXJpZmllcyB0aGUgYXVk\naXRvciBib29raWUgc2NlbmFyaW9zIHdoaWNoIHdpbGwgYmUgbW9uaXRvcmlu\nZyB0aGUKICogYm9va2llIGZhaWx1cmVzCiAqLwpwdWJsaWMgY2xhc3MgQXVk\naXRvckJvb2tpZVRlc3QgZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RD\nYXNlIHsKICAgIC8vIERlcGVuZGluZyBvbiB0aGUgdGFzdGUsIHNlbGVjdCB0\naGUgYW1vdW50IG9mIGxvZ2dpbmcKICAgIC8vIGJ5IGRlY29tbWVudGluZyBv\nbmUgb2YgdGhlIHR3byBsaW5lcyBiZWxvdwogICAgLy8gc3RhdGljIExvZ2dl\nciBMT0cgPSBMb2dnZXIuZ2V0Um9vdExvZ2dlcigpOwogICAgcHJpdmF0ZSBm\naW5hbCBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkKICAgICAg\nICAgICAgLmdldExvZ2dlcihBdWRpdG9yQm9va2llVGVzdC5jbGFzcyk7CiAg\nICBwcml2YXRlIFN0cmluZyBlbGVjdGlvblBhdGg7CiAgICBwcml2YXRlIEhh\nc2hNYXA8U3RyaW5nLCBBdWRpdG9yRWxlY3Rvcj4gYXVkaXRvckVsZWN0b3Jz\nID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBBdWRpdG9yRWxlY3Rvcj4oKTsKICAg\nIHByaXZhdGUgTGlzdDxab29LZWVwZXI+IHprQ2xpZW50cyA9IG5ldyBMaW5r\nZWRMaXN0PFpvb0tlZXBlcj4oKTsKCiAgICBwdWJsaWMgQXVkaXRvckJvb2tp\nZVRlc3QoKSB7CiAgICAgICAgc3VwZXIoNik7CiAgICAgICAgZWxlY3Rpb25Q\nYXRoID0gYmFzZUNvbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgoKQogICAgICAg\nICAgICAgICAgKyAiL3VuZGVycmVwbGljYXRpb24vYXVkaXRvcmVsZWN0aW9u\nIjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldFVw\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoKTsK\nICAgICAgICBzdGFydEF1ZGl0b3JFbGVjdG9ycygpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBzdG9wQXVkaXRvckVsZWN0b3JzKCk7CiAgICAg\nICAgZm9yIChab29LZWVwZXIgemsgOiB6a0NsaWVudHMpIHsKICAgICAgICAg\nICAgemsuY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgemtDbGllbnRzLmNs\nZWFyKCk7CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRlc3Qgc2hvdWxkIGVuc3VyZSBvbmx5IG9uZSBzaG91bGQg\nYWN0IGFzIEF1ZGl0b3IuIFN0YXJ0aW5nL3NodXRkb3duCiAgICAgKiBvdGhl\nciB0aGFuIGF1ZGl0b3IgYm9va2llIHNob3VsZG4ndCBpbml0aWF0ZSByZS1l\nbGVjdGlvbiBhbmQgbXVsdGlwbGUKICAgICAqIGF1ZGl0b3JzLgogICAgICov\nCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVz\ndEVuc3VyZU9ubHlTaW5nbGVBdWRpdG9yKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgQm9va2llU2VydmVyIGF1ZGl0b3IgPSB2ZXJpZnlBdWRpdG9y\nKCk7CgogICAgICAgIC8vIHNodXRkb3duIGJvb2tpZSB3aGljaCBpcyBub3Qg\nYW4gYXVkaXRvcgogICAgICAgIGludCBpbmRleE9mID0gYnMuaW5kZXhPZihh\ndWRpdG9yKTsKICAgICAgICBpbnQgYmtJbmRleERvd25Cb29raWU7CiAgICAg\nICAgaWYgKGluZGV4T2YgPCBicy5zaXplKCkgLSAxKSB7CiAgICAgICAgICAg\nIGJrSW5kZXhEb3duQm9va2llID0gaW5kZXhPZiArIDE7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgYmtJbmRleERvd25Cb29raWUgPSBpbmRleE9m\nIC0gMTsKICAgICAgICB9CiAgICAgICAgc2h1dGRvd25Cb29raWUoYnMuZ2V0\nKGJrSW5kZXhEb3duQm9va2llKSk7CgogICAgICAgIHN0YXJ0TmV3Qm9va2ll\nKCk7CiAgICAgICAgc3RhcnROZXdCb29raWUoKTsKICAgICAgICAvLyBncmFj\nZSBwZXJpb2QgZm9yIHRoZSBhdWRpdG9yIHJlLWVsZWN0aW9uIGlmIGFueQog\nICAgICAgIEJvb2tpZVNlcnZlciBuZXdBdWRpdG9yID0gd2FpdEZvck5ld0F1\nZGl0b3IoYXVkaXRvcik7CiAgICAgICAgQXNzZXJ0LmFzc2VydFNhbWUoCiAg\nICAgICAgICAgICAgICAiQXVkaXRvciByZS1lbGVjdGlvbiBpcyBub3QgaGFw\ncGVuZWQgZm9yIGF1ZGl0b3IgZmFpbHVyZSEiLAogICAgICAgICAgICAgICAg\nYXVkaXRvciwgbmV3QXVkaXRvcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\nZXN0IEF1ZGl0b3IgY3Jhc2hlcyBzaG91bGQgdHJpZ2dlciByZS1lbGVjdGlv\nbiBhbmQgYW5vdGhlciBib29raWUgc2hvdWxkCiAgICAgKiB0YWtlIG92ZXIg\ndGhlIGF1ZGl0b3Igc2hpcAogICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYw\nMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFN1Y2Nlc3NpdmVBdWRpdG9yQ3Jh\nc2hlcygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNlcnZl\nciBhdWRpdG9yID0gdmVyaWZ5QXVkaXRvcigpOwogICAgICAgIHNodXRkb3du\nQm9va2llKGF1ZGl0b3IpOwoKICAgICAgICBCb29raWVTZXJ2ZXIgbmV3QXVk\naXRvcjEgPSB3YWl0Rm9yTmV3QXVkaXRvcihhdWRpdG9yKTsKICAgICAgICBi\ncy5yZW1vdmUoYXVkaXRvcik7CgogICAgICAgIHNodXRkb3duQm9va2llKG5l\nd0F1ZGl0b3IxKTsKICAgICAgICBCb29raWVTZXJ2ZXIgbmV3QXVkaXRvcjIg\nPSB3YWl0Rm9yTmV3QXVkaXRvcihuZXdBdWRpdG9yMSk7CiAgICAgICAgQXNz\nZXJ0LmFzc2VydE5vdFNhbWUoCiAgICAgICAgICAgICAgICAiQXVkaXRvciBy\nZS1lbGVjdGlvbiBpcyBub3QgaGFwcGVuZWQgZm9yIGF1ZGl0b3IgZmFpbHVy\nZSEiLAogICAgICAgICAgICAgICAgYXVkaXRvciwgbmV3QXVkaXRvcjIpOwog\nICAgICAgIGJzLnJlbW92ZShuZXdBdWRpdG9yMSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUZXN0IHJlc3RhcnRpbmcgdGhlIGVudGlyZSBib29raWUgY2x1\nc3Rlci4gSXQgc2hvdWxkbid0IGNyZWF0ZSBtdWx0aXBsZQogICAgICogYm9v\na2llIGF1ZGl0b3JzCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDAp\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0Qm9va2llQ2x1c3RlclJlc3RhcnQoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCb29raWVTZXJ2ZXIgYXVkaXRv\nciA9IHZlcmlmeUF1ZGl0b3IoKTsKICAgICAgICBmb3IgKEF1ZGl0b3JFbGVj\ndG9yIGF1ZGl0b3JFbGVjdG9yIDogYXVkaXRvckVsZWN0b3JzLnZhbHVlcygp\nKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoIkF1ZGl0b3IgZWxlY3RvciBp\ncyBub3QgcnVubmluZyEiLCBhdWRpdG9yRWxlY3RvcgogICAgICAgICAgICAg\nICAgICAgIC5pc1J1bm5pbmcoKSk7CiAgICAgICAgfQogICAgICAgIHN0b3BC\nS0NsdXN0ZXIoKTsKICAgICAgICBzdG9wQXVkaXRvckVsZWN0b3JzKCk7Cgog\nICAgICAgIHN0YXJ0QktDbHVzdGVyKCk7CiAgICAgICAgc3RhcnRBdWRpdG9y\nRWxlY3RvcnMoKTsKICAgICAgICBCb29raWVTZXJ2ZXIgbmV3QXVkaXRvciA9\nIHdhaXRGb3JOZXdBdWRpdG9yKGF1ZGl0b3IpOwogICAgICAgIEFzc2VydC5h\nc3NlcnROb3RTYW1lKAogICAgICAgICAgICAgICAgIkF1ZGl0b3IgcmUtZWxl\nY3Rpb24gaXMgbm90IGhhcHBlbmVkIGZvciBhdWRpdG9yIGZhaWx1cmUhIiwK\nICAgICAgICAgICAgICAgIGF1ZGl0b3IsIG5ld0F1ZGl0b3IpOwogICAgfQoK\nICAgIC8qKgogICAgICogVGVzdCB0aGUgdm90ZSBpcyBkZWxldGluZyBmcm9t\nIHRoZSBab29LZWVwZXIgZHVyaW5nIHNodXRkb3duLgogICAgICovCiAgICBA\nVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFNodXRk\nb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQm9va2llU2VydmVy\nIGF1ZGl0b3IgPSB2ZXJpZnlBdWRpdG9yKCk7CiAgICAgICAgc2h1dGRvd25C\nb29raWUoYXVkaXRvcik7CgogICAgICAgIC8vIHdhaXRpbmcgZm9yIG5ldyBh\ndWRpdG9yCiAgICAgICAgQm9va2llU2VydmVyIG5ld0F1ZGl0b3IgPSB3YWl0\nRm9yTmV3QXVkaXRvcihhdWRpdG9yKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0\nTm90U2FtZSgKICAgICAgICAgICAgICAgICJBdWRpdG9yIHJlLWVsZWN0aW9u\nIGlzIG5vdCBoYXBwZW5lZCBmb3IgYXVkaXRvciBmYWlsdXJlISIsCiAgICAg\nICAgICAgICAgICBhdWRpdG9yLCBuZXdBdWRpdG9yKTsKICAgICAgICBpbnQg\naW5kZXhPZkRvd25Cb29raWUgPSBicy5pbmRleE9mKGF1ZGl0b3IpOwogICAg\nICAgIGJzLnJlbW92ZShpbmRleE9mRG93bkJvb2tpZSk7CiAgICAgICAgYnND\nb25mcy5yZW1vdmUoaW5kZXhPZkRvd25Cb29raWUpOwogICAgICAgIHRtcERp\ncnMucmVtb3ZlKGluZGV4T2ZEb3duQm9va2llKTsKICAgICAgICBMaXN0PFN0\ncmluZz4gY2hpbGRyZW4gPSB6a2MuZ2V0Q2hpbGRyZW4oZWxlY3Rpb25QYXRo\nLCBmYWxzZSk7CiAgICAgICAgZm9yIChTdHJpbmcgY2hpbGQgOiBjaGlsZHJl\nbikgewogICAgICAgICAgICBieXRlW10gZGF0YSA9IHprYy5nZXREYXRhKGVs\nZWN0aW9uUGF0aCArICcvJyArIGNoaWxkLCBmYWxzZSwgbnVsbCk7CiAgICAg\nICAgICAgIFN0cmluZyBib29raWVJUCA9IG5ldyBTdHJpbmcoZGF0YSk7CiAg\nICAgICAgICAgIFN0cmluZyBhZGRyID0gU3RyaW5nVXRpbHMuYWRkclRvU3Ry\naW5nKGF1ZGl0b3IuZ2V0TG9jYWxBZGRyZXNzKCkpOwogICAgICAgICAgICBB\nc3NlcnQuYXNzZXJ0RmFsc2UoIkF1ZGl0b3JFbGVjdGlvbiBjbGVhbnVwIGZh\naWxzIiwgYm9va2llSVAKICAgICAgICAgICAgICAgICAgICAuY29udGFpbnMo\nYWRkcikpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRlc3Qg\ncmVzdGFydCBvZiB0aGUgcHJldmlvdXMgQXVkaXRvciBib29raWUgc2hvdWxk\nbid0IGluaXRpYXRlCiAgICAgKiByZS1lbGVjdGlvbiBhbmQgc2hvdWxkIGNy\nZWF0ZSBuZXcgdm90ZSBhZnRlciByZXN0YXJ0aW5nLgogICAgICovCiAgICBA\nVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFJlc3Rh\ncnRBdWRpdG9yQm9va2llQWZ0ZXJDcmFzaGluZygpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIEJvb2tpZVNlcnZlciBhdWRpdG9yID0gdmVyaWZ5QXVk\naXRvcigpOwoKICAgICAgICBzaHV0ZG93bkJvb2tpZShhdWRpdG9yKTsKICAg\nICAgICBTdHJpbmcgYWRkciA9IFN0cmluZ1V0aWxzLmFkZHJUb1N0cmluZyhh\ndWRpdG9yLmdldExvY2FsQWRkcmVzcygpKTsKCiAgICAgICAgLy8gcmVzdGFy\ndGluZyBCb29raWUgd2l0aCBzYW1lIGNvbmZpZ3VyYXRpb25zLgogICAgICAg\nIGludCBpbmRleE9mRG93bkJvb2tpZSA9IGJzLmluZGV4T2YoYXVkaXRvcik7\nCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBzZXJ2ZXJDb25maWd1cmF0\naW9uID0gYnNDb25mcwogICAgICAgICAgICAgICAgLmdldChpbmRleE9mRG93\nbkJvb2tpZSk7CiAgICAgICAgYnMucmVtb3ZlKGluZGV4T2ZEb3duQm9va2ll\nKTsKICAgICAgICBic0NvbmZzLnJlbW92ZShpbmRleE9mRG93bkJvb2tpZSk7\nCiAgICAgICAgdG1wRGlycy5yZW1vdmUoaW5kZXhPZkRvd25Cb29raWUpOwog\nICAgICAgIGF1ZGl0b3JFbGVjdG9ycy5yZW1vdmUoYWRkcik7CiAgICAgICAg\nc3RhcnRCb29raWUoc2VydmVyQ29uZmlndXJhdGlvbik7CiAgICAgICAgLy8g\nc3RhcnRpbmcgY29ycmVzcG9uZGluZyBhdWRpdG9yIGVsZWN0b3IKCiAgICAg\nICAgTE9HLmRlYnVnKCJQZXJmb3JtaW5nIEF1ZGl0b3IgRWxlY3Rpb246IiAr\nIGFkZHIpOwogICAgICAgIHN0YXJ0QXVkaXRvckVsZWN0b3IoYWRkcik7Cgog\nICAgICAgIC8vIHdhaXRpbmcgZm9yIG5ldyBhdWRpdG9yIHRvIGNvbWUKICAg\nICAgICBCb29raWVTZXJ2ZXIgbmV3QXVkaXRvciA9IHdhaXRGb3JOZXdBdWRp\ndG9yKGF1ZGl0b3IpOwogICAgICAgIEFzc2VydC5hc3NlcnROb3RTYW1lKAog\nICAgICAgICAgICAgICAgIkF1ZGl0b3IgcmUtZWxlY3Rpb24gaXMgbm90IGhh\ncHBlbmVkIGZvciBhdWRpdG9yIGZhaWx1cmUhIiwKICAgICAgICAgICAgICAg\nIGF1ZGl0b3IsIG5ld0F1ZGl0b3IpOwogICAgICAgIEFzc2VydC5hc3NlcnRG\nYWxzZSgiTm8gcmVsZWN0aW9uIGFmdGVyIG9sZCBhdWRpdG9yIHJlam9pbnMi\nLCBhdWRpdG9yCiAgICAgICAgICAgICAgICAuZ2V0TG9jYWxBZGRyZXNzKCku\nZ2V0UG9ydCgpID09IG5ld0F1ZGl0b3IuZ2V0TG9jYWxBZGRyZXNzKCkKICAg\nICAgICAgICAgICAgIC5nZXRQb3J0KCkpOwogICAgfQoKICAgIC8qKgogICAg\nICogVGVzdCB0aGF0LCBpZiBhbiBhdWRpdG9yIGxvb3NlcyBpdHMgWksgY29u\nbmVjdGlvbi9zZXNzaW9uCiAgICAgKiBpdCB3aWxsIHNodXRkb3duLgogICAg\nICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQg\ndGVzdEF1ZGl0b3JaS1Nlc3Npb25Mb3NzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgc3RvcFpLQ2x1c3RlcigpOwogICAgICAgIGZvciAoQXVkaXRv\nckVsZWN0b3IgZSA6IGF1ZGl0b3JFbGVjdG9ycy52YWx1ZXMoKSkgewogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEwOyBpKyspIHsgLy8gZ2l2\nZSBpdCAxMCBzZWNvbmRzIHRvIHNodXRkb3duCiAgICAgICAgICAgICAgICBp\nZiAoIWUuaXNSdW5uaW5nKCkpIHsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBUaHJlYWQu\nc2xlZXAoMTAwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXNzZXJ0\nRmFsc2UoIkF1ZGl0b3JFbGVjdG9yIHNob3VsZCBoYXZlIHNodXRkb3duIiwg\nZS5pc1J1bm5pbmcoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBzdGFydEF1ZGl0b3JFbGVjdG9yKFN0cmluZyBhZGRyKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBab29LZWVwZXJXYXRjaGVyQmFzZSB3ID0g\nbmV3IFpvb0tlZXBlcldhdGNoZXJCYXNlKDEwMDAwKTsKICAgICAgICBab29L\nZWVwZXIgemsgPSBaa1V0aWxzLmNyZWF0ZUNvbm5lY3RlZFpvb2tlZXBlckNs\naWVudCgKICAgICAgICAgICAgICAgIHprVXRpbC5nZXRab29LZWVwZXJDb25u\nZWN0U3RyaW5nKCksIHcpOwogICAgICAgIHprQ2xpZW50cy5hZGQoemspOwoK\nICAgICAgICBBdWRpdG9yRWxlY3RvciBhdWRpdG9yRWxlY3RvciA9IG5ldyBB\ndWRpdG9yRWxlY3RvcihhZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VDb25mLCB6\nayk7CiAgICAgICAgYXVkaXRvckVsZWN0b3JzLnB1dChhZGRyLCBhdWRpdG9y\nRWxlY3Rvcik7CiAgICAgICAgYXVkaXRvckVsZWN0b3Iuc3RhcnQoKTsKICAg\nICAgICBMT0cuZGVidWcoIlN0YXJ0aW5nIEF1ZGl0b3IgRWxlY3RvciIpOwog\nICAgfQoKICAgIHByaXZhdGUgdm9pZCBzdGFydEF1ZGl0b3JFbGVjdG9ycygp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGZvciAoQm9va2llU2VydmVy\nIGJzZXJ2ZXIgOiBicykgewogICAgICAgICAgICBTdHJpbmcgYWRkciA9IFN0\ncmluZ1V0aWxzLmFkZHJUb1N0cmluZyhic2VydmVyLmdldExvY2FsQWRkcmVz\ncygpKTsKICAgICAgICAgICAgc3RhcnRBdWRpdG9yRWxlY3RvcihhZGRyKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHN0b3BBdWRpdG9y\nRWxlY3RvcnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBmb3IgKEF1\nZGl0b3JFbGVjdG9yIGF1ZGl0b3JFbGVjdG9yIDogYXVkaXRvckVsZWN0b3Jz\nLnZhbHVlcygpKSB7CiAgICAgICAgICAgIGF1ZGl0b3JFbGVjdG9yLnNodXRk\nb3duKCk7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiU3RvcHBpbmcgQXVkaXRv\nciBFbGVjdG9yISIpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIEJv\nb2tpZVNlcnZlciB2ZXJpZnlBdWRpdG9yKCkgdGhyb3dzIEtlZXBlckV4Y2Vw\ndGlvbiwKICAgICAgICAgICAgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAg\nICAgIExpc3Q8Qm9va2llU2VydmVyPiBhdWRpdG9ycyA9IGdldEF1ZGl0b3JC\nb29raWUoKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKCJNdWx0aXBs\nZSBCb29raWVzIGFjdGluZyBhcyBBdWRpdG9yISIsIDEsIGF1ZGl0b3JzCiAg\nICAgICAgICAgICAgICAuc2l6ZSgpKTsKICAgICAgICBMT0cuZGVidWcoIkJv\nb2tpZSBydW5uaW5nIGFzIEF1ZGl0b3I6IiArIGF1ZGl0b3JzLmdldCgwKSk7\nCiAgICAgICAgcmV0dXJuIGF1ZGl0b3JzLmdldCgwKTsKICAgIH0KCiAgICBw\ncml2YXRlIExpc3Q8Qm9va2llU2VydmVyPiBnZXRBdWRpdG9yQm9va2llKCkg\ndGhyb3dzIEtlZXBlckV4Y2VwdGlvbiwKICAgICAgICAgICAgSW50ZXJydXB0\nZWRFeGNlcHRpb24gewogICAgICAgIExpc3Q8Qm9va2llU2VydmVyPiBhdWRp\ndG9ycyA9IG5ldyBMaW5rZWRMaXN0PEJvb2tpZVNlcnZlcj4oKTsKICAgICAg\nICBieXRlW10gZGF0YSA9IHprYy5nZXREYXRhKGVsZWN0aW9uUGF0aCwgZmFs\nc2UsIG51bGwpOwogICAgICAgIEFzc2VydC5hc3NlcnROb3ROdWxsKCJBdWRp\ndG9yIGVsZWN0aW9uIGZhaWxlZCIsIGRhdGEpOwogICAgICAgIGZvciAoQm9v\na2llU2VydmVyIGJrcyA6IGJzKSB7CiAgICAgICAgICAgIGlmIChuZXcgU3Ry\naW5nKGRhdGEpLmNvbnRhaW5zKGJrcy5nZXRMb2NhbEFkZHJlc3MoKS5nZXRQ\nb3J0KCkgKyAiIikpIHsKICAgICAgICAgICAgICAgIGF1ZGl0b3JzLmFkZChi\na3MpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBh\ndWRpdG9yczsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgc2h1dGRvd25Cb29r\naWUoQm9va2llU2VydmVyIGJrU2VydmVyKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBTdHJpbmcgYWRkciA9IFN0cmluZ1V0aWxzLmFkZHJUb1N0cmlu\nZyhia1NlcnZlci5nZXRMb2NhbEFkZHJlc3MoKSk7CiAgICAgICAgTE9HLmRl\nYnVnKCJTaHV0dGluZyBkb3duIGJvb2tpZToiICsgYWRkcik7CgogICAgICAg\nIC8vIHNodXRkb3duIGJvb2tpZSB3aGljaCBpcyBhbiBhdWRpdG9yCiAgICAg\nICAgYmtTZXJ2ZXIuc2h1dGRvd24oKTsKICAgICAgICAvLyBzdG9wcGluZyBj\nb3JyZXNwb25kaW5nIGF1ZGl0b3IgZWxlY3RvcgogICAgICAgIGF1ZGl0b3JF\nbGVjdG9ycy5nZXQoYWRkcikuc2h1dGRvd24oKTsKICAgIH0KCiAgICBwcml2\nYXRlIEJvb2tpZVNlcnZlciB3YWl0Rm9yTmV3QXVkaXRvcihCb29raWVTZXJ2\nZXIgYXVkaXRvcikKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhj\nZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNlcnZl\nciBuZXdBdWRpdG9yID0gbnVsbDsKICAgICAgICBpbnQgcmV0cnlDb3VudCA9\nIDg7CiAgICAgICAgd2hpbGUgKHJldHJ5Q291bnQgPiAwKSB7CiAgICAgICAg\nICAgIExpc3Q8Qm9va2llU2VydmVyPiBhdWRpdG9ycyA9IGdldEF1ZGl0b3JC\nb29raWUoKTsKICAgICAgICAgICAgaWYgKGF1ZGl0b3JzLnNpemUoKSA+IDAp\nIHsKICAgICAgICAgICAgICAgIG5ld0F1ZGl0b3IgPSBhdWRpdG9ycy5nZXQo\nMCk7CiAgICAgICAgICAgICAgICBpZiAoYXVkaXRvciAhPSBuZXdBdWRpdG9y\nKSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDUw\nMCk7CiAgICAgICAgICAgIHJldHJ5Q291bnQtLTsKICAgICAgICB9CiAgICAg\nICAgQXNzZXJ0LmFzc2VydE5vdE51bGwoCiAgICAgICAgICAgICAgICAiTmV3\nIEF1ZGl0b3IgaXMgbm90IHJlZWxlY3RlZCBhZnRlciBhdWRpdG9yIGNyYXNo\nZXMiLAogICAgICAgICAgICAgICAgbmV3QXVkaXRvcik7CiAgICAgICAgdmVy\naWZ5QXVkaXRvcigpOwogICAgICAgIHJldHVybiBuZXdBdWRpdG9yOwogICAg\nfQp9Cg==\n","encoding":"base64"}

