{"sha":"969f35fa8f01ef728366ba06c07f32c278f5c751","node_id":"MDQ6QmxvYjE1NzU5NTY6OTY5ZjM1ZmE4ZjAxZWY3MjgzNjZiYTA2YzA3ZjMyYzI3OGY1Yzc1MQ==","size":6741,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/969f35fa8f01ef728366ba06c07f32c278f5c751","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlv\nbjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tp\nZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuTGVkZ2Vy\nRGlyc01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xp\nZW50LkJLRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2VzdFR5cGU7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckVudHJ5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0\naW9uOwoKLyoqCiAqIFRlc3QgdG8gdmVyaWZ5IHRoZSByZWFkb25seSBmZWF0\ndXJlIG9mIGJvb2tpZXMKICovCnB1YmxpYyBjbGFzcyBSZWFkT25seUJvb2tp\nZVRlc3QgZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKCiAg\nICBwdWJsaWMgUmVhZE9ubHlCb29raWVUZXN0KCkgewogICAgICAgIHN1cGVy\nKDIpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgcmVhZG9ubHkgYm9v\na2llCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RCb29raWVTaG91bGRT\nZXJ2ZUFzUmVhZE9ubHkoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBr\naWxsQm9va2llKDApOwogICAgICAgIGJhc2VDb25mLnNldFJlYWRPbmx5TW9k\nZUVuYWJsZWQodHJ1ZSk7CiAgICAgICAgc3RhcnROZXdCb29raWUoKTsKICAg\nICAgICBMZWRnZXJIYW5kbGUgbGVkZ2VyID0gYmtjLmNyZWF0ZUxlZGdlcigy\nLCAyLCBEaWdlc3RUeXBlLk1BQywKICAgICAgICAgICAgICAgICIiLmdldEJ5\ndGVzKCkpOwoKICAgICAgICAvLyBDaGVjayBuZXcgYm9va2llIHdpdGggcmVh\nZG9ubHkgbW9kZSBlbmFibGVkLgogICAgICAgIEZpbGVbXSBsZWRnZXJEaXJz\nID0gYnNDb25mcy5nZXQoMSkuZ2V0TGVkZ2VyRGlycygpOwogICAgICAgIGFz\nc2VydEVxdWFscygiT25seSBvbmUgbGVkZ2VyIGRpciBzaG91bGQgYmUgcHJl\nc2VudCIsIDEsCiAgICAgICAgICAgICAgICBsZWRnZXJEaXJzLmxlbmd0aCk7\nCiAgICAgICAgQm9va2llIGJvb2tpZSA9IGJzLmdldCgxKS5nZXRCb29raWUo\nKTsKICAgICAgICBMZWRnZXJEaXJzTWFuYWdlciBsZWRnZXJEaXJzTWFuYWdl\nciA9IGJvb2tpZS5nZXRMZWRnZXJEaXJzTWFuYWdlcigpOwoKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgbGVk\nZ2VyLmFkZEVudHJ5KCJkYXRhIi5nZXRCeXRlcygpKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIE5vdyBhZGQgdGhlIGN1cnJlbnQgbGVkZ2VyIGRpciB0byBm\naWxsZWQgZGlycyBsaXN0CiAgICAgICAgbGVkZ2VyRGlyc01hbmFnZXIuYWRk\nVG9GaWxsZWREaXJzKG5ldyBGaWxlKGxlZGdlckRpcnNbMF0sICJjdXJyZW50\nIikpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBsZWRnZXIuYWRkRW50\ncnkoImRhdGEiLmdldEJ5dGVzKCkpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhj\nZXB0aW9uLkJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIC8vIEV4cGVjdGVkCiAgICAgICAgfQoKICAgICAgICBhc3NlcnRU\ncnVlKCJCb29raWUgc2hvdWxkIGJlIHJ1bm5pbmcgYW5kIGNvbnZlcnRlZCB0\nbyByZWFkb25seSBtb2RlIiwKICAgICAgICAgICAgICAgIGJvb2tpZS5pc1J1\nbm5pbmcoKSAmJiBib29raWUuaXNSZWFkT25seSgpKTsKCiAgICAgICAgLy8g\nTm93IGtpbGwgdGhlIG90aGVyIGJvb2tpZSBhbmQgcmVhZCBlbnRyaWVzIGZy\nb20gdGhlIHJlYWRvbmx5IGJvb2tpZQogICAgICAgIGtpbGxCb29raWUoMCk7\nCgogICAgICAgIEVudW1lcmF0aW9uPExlZGdlckVudHJ5PiByZWFkRW50cmll\ncyA9IGxlZGdlci5yZWFkRW50cmllcygwLCA5KTsKICAgICAgICB3aGlsZSAo\ncmVhZEVudHJpZXMuaGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAg\nTGVkZ2VyRW50cnkgZW50cnkgPSByZWFkRW50cmllcy5uZXh0RWxlbWVudCgp\nOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkVudHJ5IHNob3VsZCBjb250\nYWluIGNvcnJlY3QgZGF0YSIsICJkYXRhIiwKICAgICAgICAgICAgICAgICAg\nICBuZXcgU3RyaW5nKGVudHJ5LmdldEVudHJ5KCkpKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBjaGVjayByZWFkT25seU1vZGVFbmFibGVk\nPWZhbHNlCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RCb29raWVTaHV0\nZG93bklmUmVhZE9ubHlNb2RlTm90RW5hYmxlZCgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIEZpbGVbXSBsZWRnZXJEaXJzID0gYnNDb25mcy5nZXQo\nMSkuZ2V0TGVkZ2VyRGlycygpOwogICAgICAgIGFzc2VydEVxdWFscygiT25s\neSBvbmUgbGVkZ2VyIGRpciBzaG91bGQgYmUgcHJlc2VudCIsIDEsCiAgICAg\nICAgICAgICAgICBsZWRnZXJEaXJzLmxlbmd0aCk7CiAgICAgICAgQm9va2ll\nIGJvb2tpZSA9IGJzLmdldCgxKS5nZXRCb29raWUoKTsKICAgICAgICBMZWRn\nZXJIYW5kbGUgbGVkZ2VyID0gYmtjLmNyZWF0ZUxlZGdlcigyLCAyLCBEaWdl\nc3RUeXBlLk1BQywKICAgICAgICAgICAgICAgICIiLmdldEJ5dGVzKCkpOwog\nICAgICAgIExlZGdlckRpcnNNYW5hZ2VyIGxlZGdlckRpcnNNYW5hZ2VyID0g\nYm9va2llLmdldExlZGdlckRpcnNNYW5hZ2VyKCk7CgogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgICAgICAgICBsZWRnZXIu\nYWRkRW50cnkoImRhdGEiLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAg\nICAgLy8gTm93IGFkZCB0aGUgY3VycmVudCBsZWRnZXIgZGlyIHRvIGZpbGxl\nZCBkaXJzIGxpc3QKICAgICAgICBsZWRnZXJEaXJzTWFuYWdlci5hZGRUb0Zp\nbGxlZERpcnMobmV3IEZpbGUobGVkZ2VyRGlyc1swXSwgImN1cnJlbnQiKSk7\nCgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxlZGdlci5hZGRFbnRyeSgi\nZGF0YSIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRp\nb24uQktOb3RFbm91Z2hCb29raWVzRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgLy8gRXhwZWN0ZWQKICAgICAgICB9CgogICAgICAgIC8vIHdhaXQgZm9y\nIHVwIHRvIDEwIHNlY29uZHMgZm9yIGJvb2tpZSB0byBzaHV0IGRvd24KICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEwICYmIGJvb2tpZS5pc0FsaXZl\nKCk7IGkrKykgewogICAgICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAg\nICAgICAgfQogICAgICAgIGFzc2VydEZhbHNlKCJCb29raWUgc2hvdWxkIHNo\ndXRkb3duIGlmIHJlYWRPbmx5TW9kZSBub3QgZW5hYmxlZCIsCiAgICAgICAg\nICAgICAgICBib29raWUuaXNBbGl2ZSgpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENoZWNrIG11bHRpcGxlIGxlZGdlciBkaXJzCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHRlc3RCb29raWVDb250aW51ZVdyaXRpbmdJZk11bHRpcGxl\nTGVkZ2Vyc1ByZXNlbnQoKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBzdGFydE5ld0Jvb2tpZVdpdGhNdWx0aXBsZUxlZGdlckRp\ncnMoMik7CgogICAgICAgIEZpbGVbXSBsZWRnZXJEaXJzID0gYnNDb25mcy5n\nZXQoMSkuZ2V0TGVkZ2VyRGlycygpOwogICAgICAgIGFzc2VydEVxdWFscygi\nT25seSBvbmUgbGVkZ2VyIGRpciBzaG91bGQgYmUgcHJlc2VudCIsIDIsCiAg\nICAgICAgICAgICAgICBsZWRnZXJEaXJzLmxlbmd0aCk7CiAgICAgICAgQm9v\na2llIGJvb2tpZSA9IGJzLmdldCgxKS5nZXRCb29raWUoKTsKICAgICAgICBM\nZWRnZXJIYW5kbGUgbGVkZ2VyID0gYmtjLmNyZWF0ZUxlZGdlcigyLCAyLCBE\naWdlc3RUeXBlLk1BQywKICAgICAgICAgICAgICAgICIiLmdldEJ5dGVzKCkp\nOwogICAgICAgIExlZGdlckRpcnNNYW5hZ2VyIGxlZGdlckRpcnNNYW5hZ2Vy\nID0gYm9va2llLmdldExlZGdlckRpcnNNYW5hZ2VyKCk7CgogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgICAgICAgICBsZWRn\nZXIuYWRkRW50cnkoImRhdGEiLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAg\nICAgICAgLy8gTm93IGFkZCB0aGUgY3VycmVudCBsZWRnZXIgZGlyIHRvIGZp\nbGxlZCBkaXJzIGxpc3QKICAgICAgICBsZWRnZXJEaXJzTWFuYWdlci5hZGRU\nb0ZpbGxlZERpcnMobmV3IEZpbGUobGVkZ2VyRGlyc1swXSwgImN1cnJlbnQi\nKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAg\nICAgICAgICAgIGxlZGdlci5hZGRFbnRyeSgiZGF0YSIuZ2V0Qnl0ZXMoKSk7\nCiAgICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscygid3JpdGFibGUgZGly\ncyBzaG91bGQgaGF2ZSBvbmUgZGlyIiwgMSwgbGVkZ2VyRGlyc01hbmFnZXIK\nICAgICAgICAgICAgICAgIC5nZXRXcml0YWJsZUxlZGdlckRpcnMoKS5zaXpl\nKCkpOwogICAgICAgIGFzc2VydFRydWUoIkJvb2tpZSBzaG91bGQgc2h1dGRv\nd24gaWYgcmVhZE9ubHlNb2RlIG5vdCBlbmFibGVkIiwKICAgICAgICAgICAg\nICAgIGJvb2tpZS5pc0FsaXZlKCkpOwogICAgfQoKICAgIHByaXZhdGUgdm9p\nZCBzdGFydE5ld0Jvb2tpZVdpdGhNdWx0aXBsZUxlZGdlckRpcnMoaW50IG51\nbU9mTGVkZ2VyRGlycykKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBjb25mID0gYnNDb25mcy5n\nZXQoMSk7CiAgICAgICAga2lsbEJvb2tpZSgxKTsKCiAgICAgICAgRmlsZVtd\nIGxlZGdlckRpcnMgPSBuZXcgRmlsZVtudW1PZkxlZGdlckRpcnNdOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtT2ZMZWRnZXJEaXJzOyBpKysp\nIHsKICAgICAgICAgICAgRmlsZSBkaXIgPSBGaWxlLmNyZWF0ZVRlbXBGaWxl\nKCJib29raWUiLCAidGVzdCIpOwogICAgICAgICAgICB0bXBEaXJzLmFkZChk\naXIpOwogICAgICAgICAgICBkaXIuZGVsZXRlKCk7CiAgICAgICAgICAgIGRp\nci5ta2RpcigpOwogICAgICAgICAgICBsZWRnZXJEaXJzW2ldID0gZGlyOwog\nICAgICAgIH0KCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBuZXdDb25m\nID0gbmV3U2VydmVyQ29uZmlndXJhdGlvbigKICAgICAgICAgICAgICAgIGNv\nbmYuZ2V0Qm9va2llUG9ydCgpICsgMSwgemtVdGlsLmdldFpvb0tlZXBlckNv\nbm5lY3RTdHJpbmcoKSwKICAgICAgICAgICAgICAgIGxlZGdlckRpcnNbMF0s\nIGxlZGdlckRpcnMpOwogICAgICAgIGJzQ29uZnMuYWRkKG5ld0NvbmYpOwog\nICAgICAgIGJzLmFkZChzdGFydEJvb2tpZShuZXdDb25mKSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUZXN0IGxlZGdlciBjcmVhdGlvbiB3aXRoIHJlYWRv\nbmx5IGJvb2tpZXMKICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdExlZGdl\nckNyZWF0aW9uU2hvdWxkRmFpbFdpdGhSZWFkb25seUJvb2tpZSgpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIGtpbGxCb29raWUoMSk7CiAgICAgICAg\nYmFzZUNvbmYuc2V0UmVhZE9ubHlNb2RlRW5hYmxlZCh0cnVlKTsKICAgICAg\nICBzdGFydE5ld0Jvb2tpZSgpOwogICAgICAgIGJzLmdldCgxKS5nZXRCb29r\naWUoKS50cmFuc2l0aW9uVG9SZWFkT25seU1vZGUoKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBia2MucmVhZEJvb2tpZXNCbG9ja2luZygpOwogICAg\nICAgICAgICBia2MuY3JlYXRlTGVkZ2VyKDIsIDIsIERpZ2VzdFR5cGUuQ1JD\nMzIsICIiLmdldEJ5dGVzKCkpOwogICAgICAgICAgICBmYWlsKCJNdXN0IHRo\ncm93IGV4Y2VwdGlvbiwgYXMgdGhlcmUgaXMgb25lIHJlYWRvbmx5IGJvb2tp\nZSIpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgLy8gRXhwZWN0ZWQKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

