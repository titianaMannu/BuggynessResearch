{"sha":"bb2c0bb658b8bdef6f7b535df671a857a0b0df06","node_id":"MDQ6QmxvYjE1NzU5NTY6YmIyYzBiYjY1OGI4YmRlZjZmN2I1MzVkZjY3MWE4NTdhMGIwZGYwNg==","size":7244,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/bb2c0bb658b8bdef6f7b535df671a857a0b0df06","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuaGFuZGxlcnM7CgppbXBv\ncnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0\naWwuTGlua2VkTGlzdDsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5\ndGVTdHJpbmc7CgppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hh\nbm5lbDsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5D\nbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nY2xpZW50LmRhdGEuUHViU3ViRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmNsaWVudC5uZXR0eS5IQ2hhbm5lbE1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuZXhjZXB0aW9ucy5TZXJ2ZXJSZWRpcmVj\ndExvb3BFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGll\nbnQuZXhjZXB0aW9ucy5Ub29NYW55U2VydmVyUmVkaXJlY3RzRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50Lm5ldHR5Lk5ldFV0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0aW9ucy5QdWJT\ndWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5leGNlcHRp\nb25zLlB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29s\nLlB1YlN1YlJlc3BvbnNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRp\nbC5IZWR3aWdTb2NrZXRBZGRyZXNzOwppbXBvcnQgc3RhdGljIG9yZy5hcGFj\naGUuaGVkd2lnLnV0aWwuVmFyQXJncy52YTsKCmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgpwdWJs\naWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RSZXNwb25zZUhhbmRsZXIgewoK\nICAgIHByaXZhdGUgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0\nb3J5LmdldExvZ2dlcihBYnN0cmFjdFJlc3BvbnNlSGFuZGxlci5jbGFzcyk7\nCgogICAgcHJvdGVjdGVkIGZpbmFsIENsaWVudENvbmZpZ3VyYXRpb24gY2Zn\nOwogICAgcHJvdGVjdGVkIGZpbmFsIEhDaGFubmVsTWFuYWdlciBjaGFubmVs\nTWFuYWdlcjsKCiAgICBwcm90ZWN0ZWQgQWJzdHJhY3RSZXNwb25zZUhhbmRs\nZXIoQ2xpZW50Q29uZmlndXJhdGlvbiBjZmcsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgSENoYW5uZWxNYW5hZ2VyIGNoYW5uZWxN\nYW5hZ2VyKSB7CiAgICAgICAgdGhpcy5jZmcgPSBjZmc7CiAgICAgICAgdGhp\ncy5jaGFubmVsTWFuYWdlciA9IGNoYW5uZWxNYW5hZ2VyOwogICAgfQoKICAg\nIC8qKgogICAgICogTG9naWMgdG8gaGFuZGxlIHJlY2VpdmVkIHJlc3BvbnNl\nLgogICAgICoKICAgICAqIEBwYXJhbSByZXNwb25zZQogICAgICogICAgICAg\nICAgICBQdWJTdWJSZXNwb25zZSByZWNlaXZlZCBmcm9tIGh1YiBzZXJ2ZXIu\nCiAgICAgKiBAcGFyYW0gcHViU3ViRGF0YQogICAgICogICAgICAgICAgICBQ\ndWJTdWJEYXRhIGZvciB0aGUgcHViL3N1YiByZXF1ZXN0LgogICAgICogQHBh\ncmFtIGNoYW5uZWwKICAgICAqICAgICAgICAgICAgQ2hhbm5lbCB3ZSB1c2Vk\nIHRvIG1ha2UgdGhlIHJlcXVlc3QuCiAgICAgKi8KICAgIHB1YmxpYyBhYnN0\ncmFjdCB2b2lkIGhhbmRsZVJlc3BvbnNlKFB1YlN1YlJlc3BvbnNlIHJlc3Bv\nbnNlLCBQdWJTdWJEYXRhIHB1YlN1YkRhdGEsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBDaGFubmVsIGNoYW5uZWwpIHRocm93\ncyBFeGNlcHRpb247CgogICAgLyoqCiAgICAgKiBMb2dpYyB0byByZXBvc3Qg\nYSBQdWJTdWJSZXF1ZXN0IHdoZW4gdGhlIHNlcnZlciByZXNwb25kcyB3aXRo\nIGEgcmVkaXJlY3QKICAgICAqIGluZGljYXRpbmcgdGhleSBhcmUgbm90IHRo\nZSB0b3BpYyBtYXN0ZXIuCiAgICAgKgogICAgICogQHBhcmFtIHJlc3BvbnNl\nCiAgICAgKiAgICAgICAgICAgIFB1YlN1YlJlc3BvbnNlIGZyb20gdGhlIHNl\ncnZlciBmb3IgdGhlIHJlZGlyZWN0CiAgICAgKiBAcGFyYW0gcHViU3ViRGF0\nYQogICAgICogICAgICAgICAgICBQdWJTdWJEYXRhIGZvciB0aGUgb3JpZ2lu\nYWwgUHViU3ViUmVxdWVzdCBtYWRlCiAgICAgKiBAcGFyYW0gY2hhbm5lbAog\nICAgICogICAgICAgICAgICBDaGFubmVsIENoYW5uZWwgd2UgdXNlZCB0byBt\nYWtlIHRoZSBvcmlnaW5hbCBQdWJTdWJSZXF1ZXN0CiAgICAgKiBAdGhyb3dz\nIEV4Y2VwdGlvbgogICAgICogICAgICAgICAgICAgVGhyb3dzIGFuIGV4Y2Vw\ndGlvbiBpZiB0aGVyZSB3YXMgYW4gZXJyb3IgaW4gZG9pbmcgdGhlCiAgICAg\nKiAgICAgICAgICAgICByZWRpcmVjdCByZXBvc3Qgb2YgdGhlIFB1YlN1YlJl\ncXVlc3QKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgaGFuZGxlUmVkaXJl\nY3RSZXNwb25zZShQdWJTdWJSZXNwb25zZSByZXNwb25zZSwgUHViU3ViRGF0\nYSBwdWJTdWJEYXRhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBDaGFubmVsIGNoYW5uZWwpCiAgICAgICAgICAgIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJs\nZWQoKSkgewogICAgICAgICAgICBsb2dnZXIuZGVidWcoIkhhbmRsaW5nIGEg\ncmVkaXJlY3QgZnJvbSBob3N0OiB7fSwgcmVzcG9uc2U6IHt9LCBwdWJTdWJE\nYXRhOiB7fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICB2YShOZXRVdGls\ncy5nZXRIb3N0RnJvbUNoYW5uZWwoY2hhbm5lbCksIHJlc3BvbnNlLCBwdWJT\ndWJEYXRhKSk7CiAgICAgICAgfQogICAgICAgIC8vIEluIHRoaXMgY2FzZSwg\ndGhlIFB1YlN1YiByZXF1ZXN0IHdhcyBkb25lIHRvIGEgc2VydmVyIHRoYXQg\naXMgbm90CiAgICAgICAgLy8gcmVzcG9uc2libGUgZm9yIHRoZSB0b3BpYy4g\nRmlyc3QgbWFrZSBzdXJlIHRoYXQgd2UgaGF2ZW4ndAogICAgICAgIC8vIGV4\nY2VlZGVkIHRoZSBtYXhpbXVtIG51bWJlciBvZiBzZXJ2ZXIgcmVkaXJlY3Rz\nLgogICAgICAgIGludCBjdXJOdW1TZXJ2ZXJSZWRpcmVjdHMgPSAocHViU3Vi\nRGF0YS50cmllZFNlcnZlcnMgPT0gbnVsbCkgPyAwIDogcHViU3ViRGF0YS50\ncmllZFNlcnZlcnMuc2l6ZSgpOwogICAgICAgIGlmIChjdXJOdW1TZXJ2ZXJS\nZWRpcmVjdHMgPj0gY2ZnLmdldE1heGltdW1TZXJ2ZXJSZWRpcmVjdHMoKSkg\newogICAgICAgICAgICAvLyBXZSd2ZSBhbHJlYWR5IGV4Y2VlZGVkIHRoZSBt\nYXhpbXVtIG51bWJlciBvZiBzZXJ2ZXIgcmVkaXJlY3RzCiAgICAgICAgICAg\nIC8vIHNvIGNvbnNpZGVyIHRoaXMgYXMgYW4gZXJyb3IgY29uZGl0aW9uIGZv\nciB0aGUgY2xpZW50LgogICAgICAgICAgICAvLyBJbnZva2UgdGhlIG9wZXJh\ndGlvbkZhaWxlZCBjYWxsYmFjayBhbmQganVzdCByZXR1cm4uCiAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1ZygiRXhjZWVkZWQgdGhlIG51bWJlciBvZiBzZXJ2\nZXIgcmVkaXJlY3RzICh7fSkgc28gZXJyb3Igb3V0LiIsCiAgICAgICAgICAg\nICAgICAgICAgICAgICBjdXJOdW1TZXJ2ZXJSZWRpcmVjdHMpOwogICAgICAg\nICAgICBQdWJTdWJFeGNlcHRpb24gZXhjZXB0aW9uID0gbmV3IFNlcnZpY2VE\nb3duRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgbmV3IFRvb01hbnlTZXJ2\nZXJSZWRpcmVjdHNFeGNlcHRpb24oIkFscmVhZHkgcmVhY2hlZCBtYXggbnVt\nYmVyIG9mIHJlZGlyZWN0czogIgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBjdXJOdW1TZXJ2ZXJSZWRp\ncmVjdHMpKTsKICAgICAgICAgICAgcHViU3ViRGF0YS5nZXRDYWxsYmFjaygp\nLm9wZXJhdGlvbkZhaWxlZChwdWJTdWJEYXRhLmNvbnRleHQsIGV4Y2VwdGlv\nbik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8v\nIFdlIHdpbGwgcmVkaXJlY3QgYW5kIHRyeSB0byBjb25uZWN0IHRvIHRoZSBj\nb3JyZWN0IHNlcnZlcgogICAgICAgIC8vIHN0b3JlZCBpbiB0aGUgU3RhdHVz\nTXNnIG9mIHRoZSByZXNwb25zZS4gRmlyc3Qgc3RvcmUgdGhlCiAgICAgICAg\nLy8gc2VydmVyIHRoYXQgd2Ugc2VudCB0aGUgUHViU3ViIHJlcXVlc3QgdG8g\nZm9yIHRoZSB0b3BpYy4KICAgICAgICBCeXRlU3RyaW5nIHRyaWVkU2VydmVy\nID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoSGVkd2lnU29ja2V0QWRkcmVz\ncy5zb2NrQWRkclN0cigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTmV0VXRpbHMuZ2V0SG9zdEZy\nb21DaGFubmVsKGNoYW5uZWwpKSk7CiAgICAgICAgaWYgKHB1YlN1YkRhdGEu\ndHJpZWRTZXJ2ZXJzID09IG51bGwpIHsKICAgICAgICAgICAgcHViU3ViRGF0\nYS50cmllZFNlcnZlcnMgPSBuZXcgTGlua2VkTGlzdDxCeXRlU3RyaW5nPigp\nOwogICAgICAgIH0KICAgICAgICBwdWJTdWJEYXRhLnNob3VsZENsYWltID0g\ndHJ1ZTsKICAgICAgICBwdWJTdWJEYXRhLnRyaWVkU2VydmVycy5hZGQodHJp\nZWRTZXJ2ZXIpOwoKICAgICAgICAvLyBOb3cgZ2V0IHRoZSByZWRpcmVjdGVk\nIHNlcnZlciBob3N0IChleHBlY3RlZCBmb3JtYXQgaXMKICAgICAgICAvLyBI\nb3N0bmFtZTpQb3J0OlNTTFBvcnQpIGZyb20gdGhlIHNlcnZlcidzIHJlc3Bv\nbnNlIG1lc3NhZ2UuIElmIG9uZSBpcwogICAgICAgIC8vIG5vdCBnaXZlbiBm\nb3Igc29tZSByZWFzb24sIHRoZW4gcmVkaXJlY3QgdG8gdGhlIGRlZmF1bHQg\nc2VydmVyCiAgICAgICAgLy8gaG9zdC9WSVAgdG8gcmVwb3N0IHRoZSByZXF1\nZXN0LgogICAgICAgIFN0cmluZyBzdGF0dXNNc2cgPSByZXNwb25zZS5nZXRT\ndGF0dXNNc2coKTsKICAgICAgICBJbmV0U29ja2V0QWRkcmVzcyByZWRpcmVj\ndGVkSG9zdDsKICAgICAgICBib29sZWFuIHJlZGlyZWN0VG9EZWZhdWx0U2Vy\ndmVyOwogICAgICAgIGlmIChzdGF0dXNNc2cgIT0gbnVsbCAmJiBzdGF0dXNN\nc2cubGVuZ3RoKCkgPiAwKSB7CiAgICAgICAgICAgIGlmIChjZmcuaXNTU0xF\nbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIHJlZGlyZWN0ZWRIb3N0ID0g\nbmV3IEhlZHdpZ1NvY2tldEFkZHJlc3Moc3RhdHVzTXNnKS5nZXRTU0xTb2Nr\nZXRBZGRyZXNzKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICByZWRpcmVjdGVkSG9zdCA9IG5ldyBIZWR3aWdTb2NrZXRBZGRyZXNz\nKHN0YXR1c01zZykuZ2V0U29ja2V0QWRkcmVzcygpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIHJlZGlyZWN0VG9EZWZhdWx0U2VydmVyID0gZmFsc2U7\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVkaXJlY3RlZEhvc3Qg\nPSBjZmcuZ2V0RGVmYXVsdFNlcnZlckhvc3QoKTsKICAgICAgICAgICAgcmVk\naXJlY3RUb0RlZmF1bHRTZXJ2ZXIgPSB0cnVlOwogICAgICAgIH0KCiAgICAg\nICAgLy8gTWFrZSBzdXJlIHRoZSByZWRpcmVjdGVkIHNlcnZlciBpcyBub3Qg\nb25lIHdlJ3ZlIGFscmVhZHkgYXR0ZW1wdGVkCiAgICAgICAgLy8gYWxyZWFk\neSBiZWZvcmUgaW4gdGhpcyBQdWJTdWIgcmVxdWVzdC4KICAgICAgICBpZiAo\ncHViU3ViRGF0YS50cmllZFNlcnZlcnMuY29udGFpbnMoQnl0ZVN0cmluZy5j\nb3B5RnJvbVV0ZjgoSGVkd2lnU29ja2V0QWRkcmVzcy5zb2NrQWRkclN0cihy\nZWRpcmVjdGVkSG9zdCkpKSkgewogICAgICAgICAgICBsb2dnZXIuZXJyb3Io\nIldlJ3ZlIGFscmVhZHkgc2VudCB0aGlzIFB1YlN1YlJlcXVlc3QgYmVmb3Jl\nIHRvIHJlZGlyZWN0ZWRIb3N0OiB7fSwgcHViU3ViRGF0YToge30iLAogICAg\nICAgICAgICAgICAgICAgICAgICAgdmEocmVkaXJlY3RlZEhvc3QsIHB1YlN1\nYkRhdGEpKTsKICAgICAgICAgICAgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlv\nbiA9IG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlvbigKICAgICAgICAgICAgICAg\nIG5ldyBTZXJ2ZXJSZWRpcmVjdExvb3BFeGNlcHRpb24oIkFscmVhZHkgbWFk\nZSB0aGUgcmVxdWVzdCBiZWZvcmUgdG8gcmVkaXJlY3RlZCBob3N0OiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgcmVkaXJlY3RlZEhvc3QpKTsKICAgICAgICAgICAgcHViU3ViRGF0YS5n\nZXRDYWxsYmFjaygpLm9wZXJhdGlvbkZhaWxlZChwdWJTdWJEYXRhLmNvbnRl\neHQsIGV4Y2VwdGlvbik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCgogICAgICAgIC8vIHN1Ym1pdCB0aGUgcHViL3N1YiByZXF1ZXN0IHRvIHJl\nZGlyZWN0ZWQgaG9zdAogICAgICAgIGlmIChyZWRpcmVjdFRvRGVmYXVsdFNl\ncnZlcikgewogICAgICAgICAgICBjaGFubmVsTWFuYWdlci5zdWJtaXRPcFRv\nRGVmYXVsdFNlcnZlcihwdWJTdWJEYXRhKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICBjaGFubmVsTWFuYWdlci5yZWRpcmVjdFRvSG9zdChwdWJT\ndWJEYXRhLCByZWRpcmVjdGVkSG9zdCk7CiAgICAgICAgfQogICAgfQoKfQo=\n","encoding":"base64"}

