{"sha":"0c676a13c909580f1aa85105fa54d1eb6469e273","node_id":"MDQ6QmxvYjE1NzU5NTY6MGM2NzZhMTNjOTA5NTgwZjFhYTg1MTA1ZmE1NGQxZWI2NDY5ZTI3Mw==","size":5951,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0c676a13c909580f1aa85105fa54d1eb6469e273","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHk7CgppbXBvcnQg\namF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5jb25j\ndXJyZW50LmxvY2tzLlJlZW50cmFudFJlYWRXcml0ZUxvY2s7CgppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwoKcHVibGljIGNsYXNzIENsZWFudXBDaGFubmVsTWFwPFQ+IHsKCiAg\nICBwcml2YXRlIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9y\neS5nZXRMb2dnZXIoQ2xlYW51cENoYW5uZWxNYXAuY2xhc3MpOwogICAgCiAg\nICBwcml2YXRlIGZpbmFsIENvbmN1cnJlbnRIYXNoTWFwPFQsIEhDaGFubmVs\nPiBjaGFubmVsczsKCiAgICAvLyBCb29sZWFuIGluZGljYXRpbmcgaWYgdGhl\nIGNoYW5uZWwgbWFwIGlzIGNsb3NlZCBvciBub3QuCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBjbG9zZWQgPSBmYWxzZTsKICAgIHByb3RlY3RlZCBmaW5hbCBS\nZWVudHJhbnRSZWFkV3JpdGVMb2NrIGNsb3NlZExvY2sgPQogICAgICAgIG5l\ndyBSZWVudHJhbnRSZWFkV3JpdGVMb2NrKCk7CgogICAgcHVibGljIENsZWFu\ndXBDaGFubmVsTWFwKCkgewogICAgICAgIGNoYW5uZWxzID0gbmV3IENvbmN1\ncnJlbnRIYXNoTWFwPFQsIEhDaGFubmVsPigpOwogICAgfQoKICAgIC8qKgog\nICAgICogQWRkIGNoYW5uZWwgdG8gdGhlIG1hcC4gSWYgYW4gb2xkIGNoYW5u\nZWwgaGFzIGJlZW4gYm91bmQKICAgICAqIHRvIDxjb2RlPmtleTwvY29kZT4s\nIHRoZSA8Y29kZT5jaGFubmVsPC9jb2RlPiB3b3VsZCBiZQogICAgICogY2xv\nc2VkIGltbWVkaWF0ZWx5IGFuZCB0aGUgb2xkIGNoYW5uZWwgaXMgcmV0dXJu\nZWQuIE90aGVyd2lzZSwKICAgICAqIHRoZSA8Y29kZT5jaGFubmVsPC9jb2Rl\nPiBpcyBwdXQgaW4gdGhlIG1hcCBmb3IgZnV0dXJlIHVzYWdlLgogICAgICoK\nICAgICAqIElmIHRoZSBjaGFubmVsIG1hcCBoYXMgYmVlbiBjbG9zZWQsIHRo\nZSBjaGFubmVsIHdvdWxkIGJlIGNsb3NlZAogICAgICogaW1tZWRpYXRlbHku\nCiAgICAgKgogICAgICogQHBhcmFtIGtleQogICAgICogICAgICAgICAgICBL\nZXkKICAgICAqIEBwYXJhbSBjaGFubmVsCiAgICAgKiAgICAgICAgICAgIENo\nYW5uZWwKICAgICAqIEByZXR1cm4gdGhlIGNoYW5uZWwgaW5zdGFuY2UgdG8g\ndXNlLgogICAgICovCiAgICBwdWJsaWMgSENoYW5uZWwgYWRkQ2hhbm5lbChU\nIGtleSwgSENoYW5uZWwgY2hhbm5lbCkgewogICAgICAgIHRoaXMuY2xvc2Vk\nTG9jay5yZWFkTG9jaygpLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBpZiAoY2xvc2VkKSB7CiAgICAgICAgICAgICAgICBjaGFubmVsLmNs\nb3NlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gY2hhbm5lbDsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBIQ2hhbm5lbCBvbGRDaGFubmVsID0gY2hh\nbm5lbHMucHV0SWZBYnNlbnQoa2V5LCBjaGFubmVsKTsKICAgICAgICAgICAg\naWYgKG51bGwgIT0gb2xkQ2hhbm5lbCkgewogICAgICAgICAgICAgICAgbG9n\nZ2VyLmluZm8oIkNoYW5uZWwgZm9yIHt9IGFscmVhZHkgZXhpc3RzLCBzbyBu\nbyBuZWVkIHRvIHN0b3JlIGl0LiIsIGtleSk7CiAgICAgICAgICAgICAgICBj\naGFubmVsLmNsb3NlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gb2xkQ2hh\nbm5lbDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxv\nZ2dlci5kZWJ1ZygiU3RvcmluZyBhIG5ldyBjaGFubmVsIGZvciB7fS4iLCBr\nZXkpOwogICAgICAgICAgICAgICAgcmV0dXJuIGNoYW5uZWw7CiAgICAgICAg\nICAgIH0KICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0aGlzLmNs\nb3NlZExvY2sucmVhZExvY2soKS51bmxvY2soKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXBsYWNlIGNoYW5uZWwgb25seSBpZiBjdXJy\nZW50bHkgbWFwcGVkIHRvIHRoZSBnaXZlbiA8Y29kZT5vbGRDaGFubmVsPC9j\nb2RlPi4KICAgICAqCiAgICAgKiBAcGFyYW0ga2V5CiAgICAgKiAgICAgICAg\nICAgIEtleQogICAgICogQHBhcmFtIG9sZENoYW5uZWwKICAgICAqICAgICAg\nICAgICAgT2xkIENoYW5uZWwKICAgICAqIEBwYXJhbSBuZXdDaGFubmVsCiAg\nICAgKiAgICAgICAgICAgIE5ldyBDaGFubmVsCiAgICAgKiBAcmV0dXJuIHRy\ndWUgaWYgcmVwbGFjZWQgc3VjY2Vzc2Z1bGx5LCBvdGhlcndpc2UgZmFsc2Uu\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlcGxhY2VDaGFubmVsKFQg\na2V5LCBIQ2hhbm5lbCBvbGRDaGFubmVsLCBIQ2hhbm5lbCBuZXdDaGFubmVs\nKSB7CiAgICAgICAgdGhpcy5jbG9zZWRMb2NrLnJlYWRMb2NrKCkubG9jaygp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChjbG9zZWQpIHsKICAg\nICAgICAgICAgICAgIGlmIChudWxsICE9IG9sZENoYW5uZWwpIG9sZENoYW5u\nZWwuY2xvc2UoKTsKICAgICAgICAgICAgICAgIGlmIChudWxsICE9IG5ld0No\nYW5uZWwpIG5ld0NoYW5uZWwuY2xvc2UoKTsKICAgICAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobnVs\nbCA9PSBvbGRDaGFubmVsKSB7CiAgICAgICAgICAgICAgICBIQ2hhbm5lbCBl\neGlzdGVkQ2hhbm5lbCA9IGNoYW5uZWxzLnB1dElmQWJzZW50KGtleSwgbmV3\nQ2hhbm5lbCk7CiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBleGlzdGVk\nQ2hhbm5lbCkgewogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJD\naGFubmVsIGZvciB7fSBhbHJlYWR5IGV4aXN0cywgc28gbm8gbmVlZCB0byBy\nZXBsYWNlIGl0LiIsIGtleSk7CiAgICAgICAgICAgICAgICAgICAgbmV3Q2hh\nbm5lbC5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg\nICAgbG9nZ2VyLmRlYnVnKCJTdG9yaW5nIGEgbmV3IGNoYW5uZWwgZm9yIHt9\nLiIsIGtleSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICBpZiAoY2hhbm5lbHMucmVwbGFjZShrZXksIG9sZENoYW5uZWws\nIG5ld0NoYW5uZWwpKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRl\nYnVnKCJSZXBsYWNkIGNoYW5uZWwge30gZm9yIHt9LiIsIG9sZENoYW5uZWws\nIGtleSk7CiAgICAgICAgICAgICAgICAgICAgb2xkQ2hhbm5lbC5jbG9zZSgp\nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBuZXdDaGFubmVs\nLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgdGhpcy5jbG9zZWRMb2NrLnJlYWRMb2NrKCku\ndW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyB0aGUgY2hhbm5lbCBib3VuZCB3aXRoIDxjb2RlPmtleTwvY29kZT4u\nCiAgICAgKgogICAgICogQHBhcmFtIGtleSBLZXkKICAgICAqIEByZXR1cm4g\ndGhlIGNoYW5uZWwgYm91bmQgd2l0aCA8Y29kZT5rZXk8L2NvZGU+LgogICAg\nICovCiAgICBwdWJsaWMgSENoYW5uZWwgZ2V0Q2hhbm5lbChUIGtleSkgewog\nICAgICAgIHJldHVybiBjaGFubmVscy5nZXQoa2V5KTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJlbW92ZSB0aGUgY2hhbm5lbCBib3VuZCB3aXRoIDxjb2Rl\nPmtleTwvY29kZT4uCiAgICAgKgogICAgICogQHBhcmFtIGtleSBLZXkKICAg\nICAqIEByZXR1cm4gdGhlIGNoYW5uZWwgYm91bmQgd2l0aCA8Y29kZT5rZXk8\nL2NvZGU+LCBudWxsIGlmIG5vIGNoYW5uZWwKICAgICAqICAgICAgICAgaXMg\nYm91bmQgd2l0aCA8Y29kZT5rZXk8L2NvZGU+LgogICAgICovCiAgICBwdWJs\naWMgSENoYW5uZWwgcmVtb3ZlQ2hhbm5lbChUIGtleSkgewogICAgICAgIHJl\ndHVybiBjaGFubmVscy5yZW1vdmUoa2V5KTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJlbW92ZSB0aGUgY2hhbm5lbCBib3VuZCB3aXRoIDxjb2RlPmtleTwv\nY29kZT4uCiAgICAgKgogICAgICogQHBhcmFtIGtleSBLZXkKICAgICAqIEBw\nYXJhbSBjaGFubmVsIFRoZSBjaGFubmVsIGV4cGVjdGVkIHRvIGJlIGJvdW5k\nIHdpdGggPGNvZGU+a2V5PC9jb2RlPi4KICAgICAqIEByZXR1cm4gdHJ1ZSBp\nZiB0aGUgY2hhbm5lbCBpcyByZW1vdmVkLCBmYWxzZSBvdGhlcndpc2UuCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUNoYW5uZWwoVCBrZXks\nIEhDaGFubmVsIGNoYW5uZWwpIHsKICAgICAgICByZXR1cm4gY2hhbm5lbHMu\ncmVtb3ZlKGtleSwgY2hhbm5lbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGNoYW5uZWxzIGluIHRoZSBtYXAuCiAgICAgKgogICAgICog\nQHJldHVybiB0aGUgc2V0IG9mIGNoYW5uZWxzLgogICAgICovCiAgICBwdWJs\naWMgQ29sbGVjdGlvbjxIQ2hhbm5lbD4gZ2V0Q2hhbm5lbHMoKSB7CiAgICAg\nICAgcmV0dXJuIGNoYW5uZWxzLnZhbHVlcygpOwogICAgfQoKICAgIC8qKgog\nICAgICogQ2xvc2UgdGhlIGNoYW5uZWxzIG1hcC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgY2xvc2VkTG9jay53cml0ZUxv\nY2soKS5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKGNs\nb3NlZCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGNsb3NlZCA9IHRydWU7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgY2xvc2VkTG9jay53cml0ZUxvY2soKS51bmxvY2so\nKTsKICAgICAgICB9CiAgICAgICAgbG9nZ2VyLmRlYnVnKCJDbG9zaW5nIGNo\nYW5uZWxzIG1hcC4iKTsKICAgICAgICBmb3IgKEhDaGFubmVsIGNoYW5uZWwg\nOiBjaGFubmVscy52YWx1ZXMoKSkgewogICAgICAgICAgICBjaGFubmVsLmNs\nb3NlKHRydWUpOwogICAgICAgIH0KICAgICAgICBjaGFubmVscy5jbGVhcigp\nOwogICAgICAgIGxvZ2dlci5kZWJ1ZygiQ2xvc2VkIGNoYW5uZWxzIG1hcC4i\nKTsKICAgIH0KfQo=\n","encoding":"base64"}

