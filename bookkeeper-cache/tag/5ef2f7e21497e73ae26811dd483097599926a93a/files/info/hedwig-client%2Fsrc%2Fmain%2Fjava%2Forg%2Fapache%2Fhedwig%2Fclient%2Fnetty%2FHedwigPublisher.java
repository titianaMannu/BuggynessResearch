{"sha":"5611bdd0c6e5f6871ec1fd6c751f6b16761aa2e6","node_id":"MDQ6QmxvYjE1NzU5NTY6NTYxMWJkZDBjNmU1ZjY4NzFlYzFmZDZjNzUxZjZiMTY3NjFhYTJlNg==","size":6909,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5611bdd0c6e5f6871ec1fd6c751f6b16761aa2e6","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHk7CgppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsK\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5kYXRhLlB1YlN1\nYkRhdGE7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuaGFuZGxl\ncnMuUHViU3ViQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5l\neGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uLkNvdWxkTm90Q29u\nbmVjdEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2Vw\ndGlvbnMuUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29s\nLlB1YlN1YlByb3RvY29sLk9wZXJhdGlvblR5cGU7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5QdWJsaXNoUmVz\ncG9uc2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5SZXNwb25zZUJvZHk7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy51dGlsLkNhbGxiYWNrOwoKLyoqCiAqIFRoaXMgaXMgdGhlIEhlZHdp\nZyBOZXR0eSBzcGVjaWZpYyBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgUHVibGlz\naGVyIGludGVyZmFjZS4KICoKICovCnB1YmxpYyBjbGFzcyBIZWR3aWdQdWJs\naXNoZXIgaW1wbGVtZW50cyBQdWJsaXNoZXIgewoKICAgIHByaXZhdGUgc3Rh\ndGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihI\nZWR3aWdQdWJsaXNoZXIuY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgSENo\nYW5uZWxNYW5hZ2VyIGNoYW5uZWxNYW5hZ2VyOwoKICAgIHByb3RlY3RlZCBI\nZWR3aWdQdWJsaXNoZXIoSGVkd2lnQ2xpZW50SW1wbCBjbGllbnQpIHsKICAg\nICAgICB0aGlzLmNoYW5uZWxNYW5hZ2VyID0gY2xpZW50LmdldEhDaGFubmVs\nTWFuYWdlcigpOwogICAgfQoKICAgIHB1YmxpYyBQdWJsaXNoUmVzcG9uc2Ug\ncHVibGlzaChCeXRlU3RyaW5nIHRvcGljLCBNZXNzYWdlIG1zZykKICAgICAg\nICB0aHJvd3MgQ291bGROb3RDb25uZWN0RXhjZXB0aW9uLCBTZXJ2aWNlRG93\nbkV4Y2VwdGlvbiB7CgogICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJs\nZWQoKSkgewogICAgICAgICAgICBsb2dnZXIuZGVidWcoIkNhbGxpbmcgYSBz\neW5jIHB1Ymxpc2ggZm9yIHRvcGljOiB7fSwgbXNnOiB7fS4iLAogICAgICAg\nICAgICAgICAgICAgICAgICAgdG9waWMudG9TdHJpbmdVdGY4KCksIG1zZyk7\nCiAgICAgICAgfQogICAgICAgIFB1YlN1YkRhdGEgcHViU3ViRGF0YSA9IG5l\ndyBQdWJTdWJEYXRhKHRvcGljLCBtc2csIG51bGwsIE9wZXJhdGlvblR5cGUu\nUFVCTElTSCwgbnVsbCwgbnVsbCwgbnVsbCk7CiAgICAgICAgc3luY2hyb25p\nemVkIChwdWJTdWJEYXRhKSB7CiAgICAgICAgICAgIFB1YlN1YkNhbGxiYWNr\nIHB1YlN1YkNhbGxiYWNrID0gbmV3IFB1YlN1YkNhbGxiYWNrKHB1YlN1YkRh\ndGEpOwogICAgICAgICAgICBhc3luY1B1Ymxpc2hXaXRoUmVzcG9uc2VJbXBs\nKHRvcGljLCBtc2csIHB1YlN1YkNhbGxiYWNrLCBudWxsKTsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIHdoaWxlICghcHViU3ViRGF0YS5p\nc0RvbmUpCiAgICAgICAgICAgICAgICAgICAgcHViU3ViRGF0YS53YWl0KCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTZXJ2aWNlRG93bkV4Y2Vw\ndGlvbigiSW50ZXJydXB0ZWQgRXhjZXB0aW9uIHdoaWxlIHdhaXRpbmcgZm9y\nIGFzeW5jIHB1Ymxpc2ggY2FsbCIpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIC8vIENoZWNrIGZyb20gdGhlIFB1YlN1YkNhbGxiYWNrIGlmIGl0IHdh\ncyBzdWNjZXNzZnVsIG9yIG5vdC4KICAgICAgICAgICAgaWYgKCFwdWJTdWJD\nYWxsYmFjay5nZXRJc0NhbGxTdWNjZXNzZnVsKCkpIHsKICAgICAgICAgICAg\nICAgIC8vIFNlZSB3aGF0IHRoZSBleGNlcHRpb24gd2FzIHRoYXQgd2FzIHRo\ncm93biB3aGVuIHRoZSBvcGVyYXRpb24KICAgICAgICAgICAgICAgIC8vIGZh\naWxlZC4KICAgICAgICAgICAgICAgIFB1YlN1YkV4Y2VwdGlvbiBmYWlsdXJl\nRXhjZXB0aW9uID0gcHViU3ViQ2FsbGJhY2suZ2V0RmFpbHVyZUV4Y2VwdGlv\nbigpOwogICAgICAgICAgICAgICAgaWYgKGZhaWx1cmVFeGNlcHRpb24gPT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIG5v\ndCBoYXBwZW4gYXMgdGhlIG9wZXJhdGlvbiBmYWlsZWQgYnV0IGEgbnVsbAog\nICAgICAgICAgICAgICAgICAgIC8vIFB1YlN1YkV4Y2VwdGlvbiB3YXMgcGFz\nc2VkLiBMb2cgYSB3YXJuaW5nIG1lc3NhZ2UgYnV0CiAgICAgICAgICAgICAg\nICAgICAgLy8gdGhyb3cgYSBnZW5lcmljIFNlcnZpY2VEb3duRXhjZXB0aW9u\nLgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiU3luYyBQdWJs\naXNoIG9wZXJhdGlvbiBmYWlsZWQgYnV0IG5vIFB1YlN1YkV4Y2VwdGlvbiB3\nYXMgcGFzc2VkISIpOwogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBT\nZXJ2aWNlRG93bkV4Y2VwdGlvbigiU2VydmVyIGFjayByZXNwb25zZSB0byBw\ndWJsaXNoIHJlcXVlc3QgaXMgbm90IHN1Y2Nlc3NmdWwiKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIEZvciB0aGUgZXhwZWN0ZWQg\nZXhjZXB0aW9ucyB0aGF0IGNvdWxkIG9jY3VyLCBqdXN0IHJldGhyb3cKICAg\nICAgICAgICAgICAgIC8vIHRoZW0uCiAgICAgICAgICAgICAgICBlbHNlIGlm\nIChmYWlsdXJlRXhjZXB0aW9uIGluc3RhbmNlb2YgQ291bGROb3RDb25uZWN0\nRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKENvdWxk\nTm90Q29ubmVjdEV4Y2VwdGlvbikgZmFpbHVyZUV4Y2VwdGlvbjsKICAgICAg\nICAgICAgICAgIH0gZWxzZSBpZiAoZmFpbHVyZUV4Y2VwdGlvbiBpbnN0YW5j\nZW9mIFNlcnZpY2VEb3duRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgKFNlcnZpY2VEb3duRXhjZXB0aW9uKSBmYWlsdXJlRXhjZXB0\naW9uOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICAvLyBGb3Igb3RoZXIgdHlwZXMgb2YgUHViU3ViRXhjZXB0aW9ucywg\nanVzdCB0aHJvdyBhIGdlbmVyaWMKICAgICAgICAgICAgICAgICAgICAvLyBT\nZXJ2aWNlRG93bkV4Y2VwdGlvbiBidXQgbG9nIGEgd2FybmluZyBtZXNzYWdl\nLgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiVW5leHBlY3Rl\nZCBleGNlcHRpb24gdHlwZSB3aGVuIGEgc3luYyBwdWJsaXNoIG9wZXJhdGlv\nbiBmYWlsZWQ6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGZhaWx1cmVFeGNlcHRpb24pOwogICAgICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlvbigiU2VydmVyIGFjayByZXNwb25z\nZSB0byBwdWJsaXNoIHJlcXVlc3QgaXMgbm90IHN1Y2Nlc3NmdWwiKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgUmVz\ncG9uc2VCb2R5IHJlc3BCb2R5ID0gcHViU3ViQ2FsbGJhY2suZ2V0UmVzcG9u\nc2VCb2R5KCk7CiAgICAgICAgICAgIGlmIChudWxsID09IHJlc3BCb2R5KSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQog\nICAgICAgICAgICByZXR1cm4gcmVzcEJvZHkuaGFzUHVibGlzaFJlc3BvbnNl\nKCkgPyByZXNwQm9keS5nZXRQdWJsaXNoUmVzcG9uc2UoKSA6IG51bGw7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFzeW5jUHVibGlzaChC\neXRlU3RyaW5nIHRvcGljLCBNZXNzYWdlIG1zZywKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywg\nT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICBhc3luY1B1Ymxpc2hXaXRoUmVz\ncG9uc2VJbXBsKHRvcGljLCBtc2csCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBuZXcgVm9pZENhbGxiYWNrQWRhcHRlcjxSZXNwb25z\nZUJvZHk+KGNhbGxiYWNrKSwgY29udGV4dCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgYXN5bmNQdWJsaXNoV2l0aFJlc3BvbnNlKEJ5dGVTdHJpbmcgdG9w\naWMsIE1lc3NhZ2UgbXNnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIENhbGxiYWNrPFB1Ymxpc2hSZXNwb25zZT4gY2FsbGJh\nY2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAvLyBhZGFwdCB0aGUgY2FsbGJh\nY2suCiAgICAgICAgYXN5bmNQdWJsaXNoV2l0aFJlc3BvbnNlSW1wbCh0b3Bp\nYywgbXNnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbmV3IFB1Ymxpc2hSZXNwb25zZUNhbGxiYWNrQWRhcHRlcihjYWxsYmFjayks\nIGNvbnRleHQpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhc3luY1B1Ymxp\nc2hXaXRoUmVzcG9uc2VJbXBsKEJ5dGVTdHJpbmcgdG9waWMsIE1lc3NhZ2Ug\nbXNnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgQ2FsbGJhY2s8UmVzcG9uc2VCb2R5PiBjYWxsYmFjaywKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVj\ndCBjb250ZXh0KSB7CiAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiQ2FsbGluZyBhbiBh\nc3luYyBwdWJsaXNoIGZvciB0b3BpYzoge30sIG1zZzoge30uIiwKICAgICAg\nICAgICAgICAgICAgICAgICAgIHRvcGljLnRvU3RyaW5nVXRmOCgpLCBtc2cp\nOwogICAgICAgIH0KICAgICAgICBQdWJTdWJEYXRhIHB1YlN1YkRhdGEgPSBu\nZXcgUHViU3ViRGF0YSh0b3BpYywgbXNnLCBudWxsLCBPcGVyYXRpb25UeXBl\nLlBVQkxJU0gsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY2FsbGJhY2ssIGNvbnRleHQpOwogICAgICAg\nIGNoYW5uZWxNYW5hZ2VyLnN1Ym1pdE9wKHB1YlN1YkRhdGEpOwogICAgfQoK\nICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFB1Ymxpc2hSZXNwb25zZUNhbGxi\nYWNrQWRhcHRlciBpbXBsZW1lbnRzIENhbGxiYWNrPFJlc3BvbnNlQm9keT57\nCgogICAgICAgIHByaXZhdGUgZmluYWwgQ2FsbGJhY2s8UHVibGlzaFJlc3Bv\nbnNlPiBkZWxlZ2F0ZTsKCiAgICAgICAgcHJpdmF0ZSBQdWJsaXNoUmVzcG9u\nc2VDYWxsYmFja0FkYXB0ZXIoQ2FsbGJhY2s8UHVibGlzaFJlc3BvbnNlPiBk\nZWxlZ2F0ZSkgewogICAgICAgICAgICB0aGlzLmRlbGVnYXRlID0gZGVsZWdh\ndGU7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgdm9pZCBvcGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBSZXNwb25z\nZUJvZHkgcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgaWYgKG51\nbGwgPT0gcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgICAgIGRl\nbGVnYXRlLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbnVsbCk7CiAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkZWxlZ2F0ZS5vcGVyYXRp\nb25GaW5pc2hlZChjdHgsIHJlc3VsdE9mT3BlcmF0aW9uLmdldFB1Ymxpc2hS\nZXNwb25zZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVk\nKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAg\nICAgICAgICAgZGVsZWdhdGUub3BlcmF0aW9uRmFpbGVkKGN0eCwgZXhjZXB0\naW9uKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

