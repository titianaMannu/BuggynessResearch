{"sha":"6fb89784bd34c894fee74a2804d5e26de5f823d4","node_id":"MDQ6QmxvYjE1NzU5NTY6NmZiODk3ODRiZDM0Yzg5NGZlZTc0YTI4MDRkNWUyNmRlNWY4MjNkNA==","size":25773,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/6fb89784bd34c894fee74a2804d5e26de5f823d4","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHkuaW1wbDsKCmlt\ncG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0QWRkcmVzczsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGph\ndmEudXRpbC5UaW1lcjsKaW1wb3J0IGphdmEudXRpbC5UaW1lclRhc2s7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRNYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWljTG9uZzsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmxvY2tzLlJlZW50cmFudFJl\nYWRXcml0ZUxvY2s7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5l\ndHR5LmNoYW5uZWwuQ2hhbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5j\naGFubmVsLkNoYW5uZWxGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5\nLmNoYW5uZWwuQ2hhbm5lbEZ1dHVyZTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0\neS5jaGFubmVsLkNoYW5uZWxGdXR1cmVMaXN0ZW5lcjsKCmltcG9ydCBjb20u\nZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CgppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuY2xpZW50LmFwaS5NZXNzYWdlSGFuZGxlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5jb25mLkNsaWVudENvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZGF0YS5QdWJT\ndWJEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEu\nVG9waWNTdWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xp\nZW50LmV4Y2VwdGlvbnMuQWxyZWFkeVN0YXJ0RGVsaXZlcnlFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZXhjZXB0aW9ucy5O\nb1Jlc3BvbnNlSGFuZGxlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmNsaWVudC5oYW5kbGVycy5NZXNzYWdlQ29uc3VtZUNhbGxiYWNr\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmhhbmRsZXJzLlN1\nYnNjcmliZVJlc3BvbnNlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmNsaWVudC5uZXR0eS5DbGVhbnVwQ2hhbm5lbE1hcDsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5IQ2hhbm5lbDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5IQ2hhbm5lbE1hbmFn\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHkuTmV0\nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHku\nU3Vic2NyaXB0aW9uRXZlbnRFbWl0dGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LnNzbC5Tc2xDbGllbnRDb250ZXh0RmFjdG9yeTsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0aW9ucy5QdWJT\ndWJFeGNlcHRpb24uQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0\naW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuZmlsdGVyLkNsaWVudE1lc3NhZ2VGaWx0ZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1l\nc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5NZXNzYWdlSGVhZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvY29sLlB1YlN1YlByb3RvY29sLlB1YlN1YlJlcXVlc3Q7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5SZXNw\nb25zZUJvZHk7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxi\nYWNrOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuVmFy\nQXJncy52YTsKCi8qKgogKiBCYXNpYyBIQ2hhbm5lbCBNYW5hZ2VyIEltcGxl\nbWVudGF0aW9uCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RI\nQ2hhbm5lbE1hbmFnZXIgaW1wbGVtZW50cyBIQ2hhbm5lbE1hbmFnZXIgewoK\nICAgIHByaXZhdGUgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0\nb3J5LmdldExvZ2dlcihBYnN0cmFjdEhDaGFubmVsTWFuYWdlci5jbGFzcyk7\nCgogICAgLy8gRW1wdHkgVG9waWMgTGlzdAogICAgcHJpdmF0ZSBmaW5hbCBz\ndGF0aWMgU2V0PEJ5dGVTdHJpbmc+IEVNUFRZX1RPUElDX1NFVCA9CiAgICAg\nICAgbmV3IEhhc2hTZXQ8Qnl0ZVN0cmluZz4oKTsKCiAgICAvLyBCb29sZWFu\nIGluZGljYXRpbmcgaWYgdGhlIGNoYW5uZWwgbWFuYWdlciBpcyBydW5uaW5n\nIG9yIGhhcyBiZWVuIGNsb3NlZC4KICAgIC8vIE9uY2Ugd2Ugc3RvcCB0aGUg\nbWFuYWdlciwgd2Ugc2hvdWxkIHNpZGVzdGVwIGFsbCBvZiB0aGUgY29ubmVj\ndCwgd3JpdGUgY2FsbGJhY2sKICAgIC8vIGFuZCBjaGFubmVsIGRpc2Nvbm5l\nY3RlZCBsb2dpYy4KICAgIHByb3RlY3RlZCBib29sZWFuIGNsb3NlZCA9IGZh\nbHNlOwogICAgcHJvdGVjdGVkIGZpbmFsIFJlZW50cmFudFJlYWRXcml0ZUxv\nY2sgY2xvc2VkTG9jayA9CiAgICAgICAgbmV3IFJlZW50cmFudFJlYWRXcml0\nZUxvY2soKTsKCiAgICAvLyBHbG9iYWwgY291bnRlciB1c2VkIGZvciBnZW5l\ncmF0aW5nIHVuaXF1ZSB0cmFuc2FjdGlvbiBJRCdzIGZvcgogICAgLy8gcHVi\nbGlzaCBhbmQgc3Vic2NyaWJlIHJlcXVlc3RzCiAgICBwcm90ZWN0ZWQgZmlu\nYWwgQXRvbWljTG9uZyBnbG9iYWxDb3VudGVyID0gbmV3IEF0b21pY0xvbmco\nKTsKCiAgICAvLyBDb25jdXJyZW50IE1hcCB0byBzdG9yZSB0aGUgbWFwcGlu\nZyBmcm9tIHRoZSBUb3BpYyB0byB0aGUgSG9zdC4KICAgIC8vIFRoaXMgY291\nbGQgY2hhbmdlIG92ZXIgdGltZSBzaW5jZSBzZXJ2ZXJzIGNhbiBkcm9wIG1h\nc3RlcnNoaXAgb2YgdG9waWNzCiAgICAvLyBmb3IgbG9hZCBiYWxhbmNpbmcg\nb3IgZmFpbG92ZXIuIElmIGEgc2VydmVyIGhvc3QgZXZlciBnb2VzIGRvd24s\nIHdlJ2QKICAgIC8vIGFsc28gd2FudCB0byByZW1vdmUgYWxsIHRvcGljIG1h\ncHBpbmdzIHRoZSBob3N0IHdhcyByZXNwb25zaWJsZSBmb3IuCiAgICAvLyBU\naGUgc2Vjb25kIE1hcCBpcyB1c2VkIGFzIHRoZSBpbnZlcnRlZCB2ZXJzaW9u\nIG9mIHRoZSBmaXJzdCBvbmUuCiAgICBwcm90ZWN0ZWQgZmluYWwgQ29uY3Vy\ncmVudE1hcDxCeXRlU3RyaW5nLCBJbmV0U29ja2V0QWRkcmVzcz4gdG9waWMy\nSG9zdCA9CiAgICAgICAgbmV3IENvbmN1cnJlbnRIYXNoTWFwPEJ5dGVTdHJp\nbmcsIEluZXRTb2NrZXRBZGRyZXNzPigpOwogICAgLy8gVGhlIGludmVyc2Ug\nbWFwcGluZyBpcyB1c2VkIG9ubHkgd2hlbiBjbGVhcmluZyBhbGwgdG9waWNz\nLiBGb3IgcGVyZm9ybWFuY2UKICAgIC8vIGNvbnNpZGVyYXRpb24sIHdlIGRv\nbid0IGd1YXJhbnRlZSBob3N0MlRvcGljcyB0byBiZSBjb25zaXN0ZW50IHdp\ndGgKICAgIC8vIHRvcGljMkhvc3QuIGl0IHdvdWxkIGJlIGJldHRlciB0byBu\nb3QgcmVseSBvbiB0aGlzIG1hcHBpbmcgZm9yIGFueXRoaW5nCiAgICAvLyBz\naWduaWZpY2FudC4KICAgIHByb3RlY3RlZCBmaW5hbCBDb25jdXJyZW50TWFw\nPEluZXRTb2NrZXRBZGRyZXNzLCBTZXQ8Qnl0ZVN0cmluZz4+IGhvc3QyVG9w\naWNzID0KICAgICAgICBuZXcgQ29uY3VycmVudEhhc2hNYXA8SW5ldFNvY2tl\ndEFkZHJlc3MsIFNldDxCeXRlU3RyaW5nPj4oKTsKCiAgICAvLyBUaGlzIGNo\nYW5uZWxzIHdpbGwgYmUgdXNlZCBmb3IgcHVibGlzaCBhbmQgdW5zdWJzY3Jp\nYmUgcmVxdWVzdHMKICAgIHByb3RlY3RlZCBmaW5hbCBDbGVhbnVwQ2hhbm5l\nbE1hcDxJbmV0U29ja2V0QWRkcmVzcz4gaG9zdDJOb25TdWJzY3JpcHRpb25D\naGFubmVscyA9CiAgICAgICAgbmV3IENsZWFudXBDaGFubmVsTWFwPEluZXRT\nb2NrZXRBZGRyZXNzPigpOwoKICAgIHByaXZhdGUgZmluYWwgQ2xpZW50Q29u\nZmlndXJhdGlvbiBjZmc7CiAgICAvLyBUaGUgTmV0dHkgc29ja2V0IGZhY3Rv\ncnkgZm9yIG1ha2luZyBjb25uZWN0aW9ucyB0byB0aGUgc2VydmVyLgogICAg\ncHJvdGVjdGVkIGZpbmFsIENoYW5uZWxGYWN0b3J5IHNvY2tldEZhY3Rvcnk7\nCiAgICAvLyBQaXBlbGluZUZhY3RvcnkgdG8gY3JlYXRlIG5vbi1zdWJzY3Jp\ncHRpb24gbmV0dHkgY2hhbm5lbHMgdG8gdGhlIGFwcHJvcHJpYXRlIHNlcnZl\ncgogICAgcHJpdmF0ZSBmaW5hbCBDbGllbnRDaGFubmVsUGlwZWxpbmVGYWN0\nb3J5IG5vblN1YnNjcmlwdGlvbkNoYW5uZWxQaXBlbGluZUZhY3Rvcnk7CiAg\nICAvLyBzc2wgY29udGV4dCBmYWN0b3J5CiAgICBwcml2YXRlIFNzbENsaWVu\ndENvbnRleHRGYWN0b3J5IHNzbEZhY3RvcnkgPSBudWxsOwoKICAgIC8vIGRl\nZmF1bHQgc2VydmVyIGNoYW5uZWwKICAgIHByaXZhdGUgZmluYWwgSENoYW5u\nZWwgZGVmYXVsdFNlcnZlckNoYW5uZWw7CgogICAgLy8gRWFjaCBjbGllbnQg\naW5zdGFudGlhdGlvbiB3aWxsIGhhdmUgYSBUaW1lciBmb3IgcnVubmluZyBy\nZWN1cnJpbmcKICAgIC8vIHRocmVhZHMuIE9uZSBzdWNoIHRpbWVyIHRhc2sg\ndGhyZWFkIHRvIGlzIHRvIHRpbWVvdXQgbG9uZyBydW5uaW5nCiAgICAvLyBQ\ndWJTdWJSZXF1ZXN0cyB0aGF0IGFyZSB3YWl0aW5nIGZvciBhbiBhY2sgcmVz\ncG9uc2UgZnJvbSB0aGUgc2VydmVyLgogICAgcHJpdmF0ZSBmaW5hbCBUaW1l\nciBjbGllbnRUaW1lciA9IG5ldyBUaW1lcih0cnVlKTsKICAgIC8vIGEgY29t\nbW9uIGNvbnN1bWUgY2FsbGJhY2sgZm9yIGFsbCBjb25zdW1lIHJlcXVlc3Rz\nLgogICAgcHJpdmF0ZSBmaW5hbCBNZXNzYWdlQ29uc3VtZUNhbGxiYWNrIGNv\nbnN1bWVDYjsKICAgIC8vIEEgZXZlbnQgZW1pdHRlciB0byBlbWl0IHN1YnNj\ncmlwdGlvbiBldmVudHMKICAgIHByaXZhdGUgZmluYWwgU3Vic2NyaXB0aW9u\nRXZlbnRFbWl0dGVyIGV2ZW50RW1pdHRlcjsKCiAgICBwcm90ZWN0ZWQgQWJz\ndHJhY3RIQ2hhbm5lbE1hbmFnZXIoQ2xpZW50Q29uZmlndXJhdGlvbiBjZmcs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2hhbm5l\nbEZhY3Rvcnkgc29ja2V0RmFjdG9yeSkgewogICAgICAgIHRoaXMuY2ZnID0g\nY2ZnOwogICAgICAgIHRoaXMuc29ja2V0RmFjdG9yeSA9IHNvY2tldEZhY3Rv\ncnk7CiAgICAgICAgdGhpcy5ub25TdWJzY3JpcHRpb25DaGFubmVsUGlwZWxp\nbmVGYWN0b3J5ID0KICAgICAgICAgICAgbmV3IE5vblN1YnNjcmlwdGlvbkNo\nYW5uZWxQaXBlbGluZUZhY3RvcnkoY2ZnLCB0aGlzKTsKCiAgICAgICAgLy8g\nY3JlYXRlIGEgZGVmYXVsdCBzZXJ2ZXIgY2hhbm5lbAogICAgICAgIGRlZmF1\nbHRTZXJ2ZXJDaGFubmVsID0KICAgICAgICAgICAgbmV3IERlZmF1bHRTZXJ2\nZXJDaGFubmVsKGNmZy5nZXREZWZhdWx0U2VydmVySG9zdCgpLCB0aGlzKTsK\nCiAgICAgICAgaWYgKGNmZy5pc1NTTEVuYWJsZWQoKSkgewogICAgICAgICAg\nICBzc2xGYWN0b3J5ID0gbmV3IFNzbENsaWVudENvbnRleHRGYWN0b3J5KGNm\nZyk7CiAgICAgICAgfQoKICAgICAgICBjb25zdW1lQ2IgPSBuZXcgTWVzc2Fn\nZUNvbnN1bWVDYWxsYmFjayhjZmcsIHRoaXMpOwogICAgICAgIGV2ZW50RW1p\ndHRlciA9IG5ldyBTdWJzY3JpcHRpb25FdmVudEVtaXR0ZXIoKTsKCiAgICAg\nICAgLy8gU2NoZWR1bGUgUmVxdWVzdCBUaW1lb3V0IHRhc2suCiAgICAgICAg\nY2xpZW50VGltZXIuc2NoZWR1bGUobmV3IFB1YlN1YlJlcXVlc3RUaW1lb3V0\nVGFzaygpLCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNmZy5n\nZXRUaW1lb3V0VGhyZWFkUnVuSW50ZXJ2YWwoKSk7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgU3Vic2NyaXB0aW9uRXZlbnRFbWl0dGVyIGdl\ndFN1YnNjcmlwdGlvbkV2ZW50RW1pdHRlcigpIHsKICAgICAgICByZXR1cm4g\nZXZlbnRFbWl0dGVyOwogICAgfQoKICAgIHB1YmxpYyBNZXNzYWdlQ29uc3Vt\nZUNhbGxiYWNrIGdldENvbnN1bWVDYWxsYmFjaygpIHsKICAgICAgICByZXR1\ncm4gY29uc3VtZUNiOwogICAgfQoKICAgIHB1YmxpYyBTc2xDbGllbnRDb250\nZXh0RmFjdG9yeSBnZXRTc2xGYWN0b3J5KCkgewogICAgICAgIHJldHVybiBz\nc2xGYWN0b3J5OwogICAgfQoKICAgIHByb3RlY3RlZCBDaGFubmVsRmFjdG9y\neSBnZXRDaGFubmVsRmFjdG9yeSgpIHsKICAgICAgICByZXR1cm4gc29ja2V0\nRmFjdG9yeTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xpZW50Q2hhbm5lbFBp\ncGVsaW5lRmFjdG9yeSBnZXROb25TdWJzY3JpcHRpb25DaGFubmVsUGlwZWxp\nbmVGYWN0b3J5KCkgewogICAgICAgIHJldHVybiB0aGlzLm5vblN1YnNjcmlw\ndGlvbkNoYW5uZWxQaXBlbGluZUZhY3Rvcnk7CiAgICB9CgogICAgcHJvdGVj\ndGVkIGFic3RyYWN0IENsaWVudENoYW5uZWxQaXBlbGluZUZhY3RvcnkgZ2V0\nU3Vic2NyaXB0aW9uQ2hhbm5lbFBpcGVsaW5lRmFjdG9yeSgpOwoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIHZvaWQgc2NoZWR1bGUoZmluYWwgVGltZXJU\nYXNrIHRhc2ssIGZpbmFsIGxvbmcgZGVsYXkpIHsKICAgICAgICB0aGlzLmNs\nb3NlZExvY2sucmVhZExvY2soKS5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgaWYgKGNsb3NlZCkgewogICAgICAgICAgICAgICAgbG9nZ2Vy\nLndhcm4oIlRhc2sge30gaXMgbm90IHNjaGVkdWxlZCBkdWUgdG8gdGhlIGNo\nYW5uZWwgbWFuYWdlciBpcyBjbG9zZWQuIiwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIHRhc2spOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGNsaWVudFRpbWVyLnNjaGVkdWxlKHRh\nc2ssIGRlbGF5KTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0\naGlzLmNsb3NlZExvY2sucmVhZExvY2soKS51bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzdWJtaXRP\ncEFmdGVyRGVsYXkoZmluYWwgUHViU3ViRGF0YSBwdWJTdWJEYXRhLCBmaW5h\nbCBsb25nIGRlbGF5KSB7CiAgICAgICAgdGhpcy5jbG9zZWRMb2NrLnJlYWRM\nb2NrKCkubG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChj\nbG9zZWQpIHsKICAgICAgICAgICAgICAgIHB1YlN1YkRhdGEuZ2V0Q2FsbGJh\nY2soKS5vcGVyYXRpb25GYWlsZWQocHViU3ViRGF0YS5jb250ZXh0LAogICAg\nICAgICAgICAgICAgICAgIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlvbigiQ2xp\nZW50IGhhcyBiZWVuIGNsb3NlZC4iKSk7CiAgICAgICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xpZW50VGltZXIuc2No\nZWR1bGUobmV3IFRpbWVyVGFzaygpIHsKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAg\nICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3VibWl0IHJlcXVlc3Qg\ne30gaW4ge30gbXMgbGF0ZXIuIiwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdmEocHViU3ViRGF0YSwgZGVsYXkpKTsKICAgICAgICAgICAg\nICAgICAgICBzdWJtaXRPcChwdWJTdWJEYXRhKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfSwgZGVsYXkpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIGNsb3NlZExvY2sucmVhZExvY2soKS51bmxvY2soKTsK\nICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBzdWJtaXRPcChQdWJTdWJEYXRhIHB1YlN1YkRhdGEpIHsKICAgICAgICBI\nQ2hhbm5lbCBoQ2hhbm5lbDsKICAgICAgICBpZiAoT3BlcmF0aW9uVHlwZS5Q\nVUJMSVNILmVxdWFscyhwdWJTdWJEYXRhLm9wZXJhdGlvblR5cGUpIHx8CiAg\nICAgICAgICAgIE9wZXJhdGlvblR5cGUuVU5TVUJTQ1JJQkUuZXF1YWxzKHB1\nYlN1YkRhdGEub3BlcmF0aW9uVHlwZSkpIHsKICAgICAgICAgICAgaENoYW5u\nZWwgPSBnZXROb25TdWJzY3JpcHRpb25DaGFubmVsQnlUb3BpYyhwdWJTdWJE\nYXRhLnRvcGljKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBUb3Bp\nY1N1YnNjcmliZXIgdHMgPSBuZXcgVG9waWNTdWJzY3JpYmVyKHB1YlN1YkRh\ndGEudG9waWMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgcHViU3ViRGF0YS5zdWJzY3JpYmVySWQpOwog\nICAgICAgICAgICBoQ2hhbm5lbCA9IGdldFN1YnNjcmlwdGlvbkNoYW5uZWxC\neVRvcGljU3Vic2NyaWJlcih0cyk7CiAgICAgICAgfQogICAgICAgIC8vIG5v\nIGNoYW5uZWwgZm91bmQgdG8gc3VibWl0IHB1YnN1YiBkYXRhCiAgICAgICAg\nLy8gY2hvb3NlIHRoZSBkZWZhdWx0IHNlcnZlcgogICAgICAgIGlmIChudWxs\nID09IGhDaGFubmVsKSB7CiAgICAgICAgICAgIGhDaGFubmVsID0gZGVmYXVs\ndFNlcnZlckNoYW5uZWw7CiAgICAgICAgfQogICAgICAgIGhDaGFubmVsLnN1\nYm1pdE9wKHB1YlN1YkRhdGEpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIHZvaWQgcmVkaXJlY3RUb0hvc3QoUHViU3ViRGF0YSBwdWJTdWJE\nYXRhLCBJbmV0U29ja2V0QWRkcmVzcyBob3N0KSB7CiAgICAgICAgbG9nZ2Vy\nLmRlYnVnKCJTdWJtaXQgb3BlcmF0aW9uIHt9IHRvIGhvc3Qge30uIiwKICAg\nICAgICAgICAgICAgICAgICAgdmEocHViU3ViRGF0YSwgaG9zdCkpOwogICAg\nICAgIEhDaGFubmVsIGhDaGFubmVsOwogICAgICAgIGlmIChPcGVyYXRpb25U\neXBlLlBVQkxJU0guZXF1YWxzKHB1YlN1YkRhdGEub3BlcmF0aW9uVHlwZSkg\nfHwKICAgICAgICAgICAgT3BlcmF0aW9uVHlwZS5VTlNVQlNDUklCRS5lcXVh\nbHMocHViU3ViRGF0YS5vcGVyYXRpb25UeXBlKSkgewogICAgICAgICAgICBo\nQ2hhbm5lbCA9IGdldE5vblN1YnNjcmlwdGlvbkNoYW5uZWwoaG9zdCk7CiAg\nICAgICAgICAgIGlmIChudWxsID09IGhDaGFubmVsKSB7CiAgICAgICAgICAg\nICAgICAvLyBjcmVhdGUgYSBjaGFubmVsIHRvIGNvbm5lY3QgdG8gc3BlY2lm\naWVkIGhvc3QKICAgICAgICAgICAgICAgIGhDaGFubmVsID0gY3JlYXRlQW5k\nU3RvcmVOb25TdWJzY3JpcHRpb25DaGFubmVsKGhvc3QpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaENoYW5uZWwgPSBn\nZXRTdWJzY3JpcHRpb25DaGFubmVsKGhvc3QpOwogICAgICAgICAgICBpZiAo\nbnVsbCA9PSBoQ2hhbm5lbCkgewogICAgICAgICAgICAgICAgLy8gY3JlYXRl\nIGEgc3Vic2NyaXB0aW9uIGNoYW5uZWwgdG8gc3BlY2lmaWVkIGhvc3QKICAg\nICAgICAgICAgICAgIGhDaGFubmVsID0gY3JlYXRlQW5kU3RvcmVTdWJzY3Jp\ncHRpb25DaGFubmVsKGhvc3QpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIC8vIG5vIGNoYW5uZWwgZm91bmQgdG8gc3VibWl0IHB1YnN1YiBk\nYXRhCiAgICAgICAgLy8gY2hvb3NlIHRoZSBkZWZhdWx0IHNlcnZlcgogICAg\nICAgIGlmIChudWxsID09IGhDaGFubmVsKSB7CiAgICAgICAgICAgIGhDaGFu\nbmVsID0gZGVmYXVsdFNlcnZlckNoYW5uZWw7CiAgICAgICAgfQogICAgICAg\nIGhDaGFubmVsLnN1Ym1pdE9wKHB1YlN1YkRhdGEpOwogICAgfQoKICAgIHZv\naWQgc3VibWl0T3BUaHJ1Q2hhbm5lbChQdWJTdWJEYXRhIHB1YlN1YkRhdGEs\nIENoYW5uZWwgY2hhbm5lbCkgewogICAgICAgIGxvZ2dlci5kZWJ1ZygiU3Vi\nbWl0IG9wZXJhdGlvbiB7fSB0byB0aHJ1IGNoYW5uZWwge30uIiwKICAgICAg\nICAgICAgICAgICAgICAgdmEocHViU3ViRGF0YSwgY2hhbm5lbCkpOwogICAg\nICAgIEhDaGFubmVsIGhDaGFubmVsOwogICAgICAgIGlmIChPcGVyYXRpb25U\neXBlLlBVQkxJU0guZXF1YWxzKHB1YlN1YkRhdGEub3BlcmF0aW9uVHlwZSkg\nfHwKICAgICAgICAgICAgT3BlcmF0aW9uVHlwZS5VTlNVQlNDUklCRS5lcXVh\nbHMocHViU3ViRGF0YS5vcGVyYXRpb25UeXBlKSkgewogICAgICAgICAgICBo\nQ2hhbm5lbCA9IGNyZWF0ZUFuZFN0b3JlTm9uU3Vic2NyaXB0aW9uQ2hhbm5l\nbChjaGFubmVsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoQ2hh\nbm5lbCA9IGNyZWF0ZUFuZFN0b3JlU3Vic2NyaXB0aW9uQ2hhbm5lbChjaGFu\nbmVsKTsKICAgICAgICB9CiAgICAgICAgaENoYW5uZWwuc3VibWl0T3AocHVi\nU3ViRGF0YSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBzdWJtaXRPcFRvRGVmYXVsdFNlcnZlcihQdWJTdWJEYXRhIHB1YlN1YkRh\ndGEpIHsKICAgICAgICBsb2dnZXIuZGVidWcoIlN1Ym1pdCBvcGVyYXRpb24g\ne30gdG8gZGVmYXVsdCBzZXJ2ZXIge30uIiwKICAgICAgICAgICAgICAgICAg\nICAgdmEocHViU3ViRGF0YSwgZGVmYXVsdFNlcnZlckNoYW5uZWwpKTsKICAg\nICAgICBkZWZhdWx0U2VydmVyQ2hhbm5lbC5zdWJtaXRPcChwdWJTdWJEYXRh\nKTsKICAgIH0KCiAgICAvLyBTeW5jaHJvbml6ZWQgbWV0aG9kIHRvIHN0b3Jl\nIHRoZSBob3N0MkNoYW5uZWwgbWFwcGluZyAoaWYgaXQgZG9lc24ndAogICAg\nLy8gZXhpc3QgeWV0KS4gUmV0cmlldmUgdGhlIGhvc3RuYW1lIGluZm8gZnJv\nbSB0aGUgQ2hhbm5lbCBjcmVhdGVkIHZpYSB0aGUKICAgIC8vIFJlbW90ZUFk\nZHJlc3MgdGllZCB0byBpdC4KICAgIHByaXZhdGUgSENoYW5uZWwgY3JlYXRl\nQW5kU3RvcmVOb25TdWJzY3JpcHRpb25DaGFubmVsKENoYW5uZWwgY2hhbm5l\nbCkgewogICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGhvc3QgPSBOZXRVdGls\ncy5nZXRIb3N0RnJvbUNoYW5uZWwoY2hhbm5lbCk7CiAgICAgICAgSENoYW5u\nZWwgbmV3SENoYW5uZWwgPSBuZXcgSENoYW5uZWxJbXBsKGhvc3QsIGNoYW5u\nZWwsIHRoaXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGdldE5vblN1YnNjcmlwdGlvbkNoYW5uZWxQaXBlbGlu\nZUZhY3RvcnkoKSk7CiAgICAgICAgcmV0dXJuIHN0b3JlTm9uU3Vic2NyaXB0\naW9uQ2hhbm5lbChob3N0LCBuZXdIQ2hhbm5lbCk7CiAgICB9CgogICAgcHJp\ndmF0ZSBIQ2hhbm5lbCBjcmVhdGVBbmRTdG9yZU5vblN1YnNjcmlwdGlvbkNo\nYW5uZWwoSW5ldFNvY2tldEFkZHJlc3MgaG9zdCkgewogICAgICAgIEhDaGFu\nbmVsIG5ld0hDaGFubmVsID0gbmV3IEhDaGFubmVsSW1wbChob3N0LCB0aGlz\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBnZXROb25TdWJzY3JpcHRpb25DaGFubmVsUGlwZWxpbmVGYWN0b3J5\nKCkpOwogICAgICAgIHJldHVybiBzdG9yZU5vblN1YnNjcmlwdGlvbkNoYW5u\nZWwoaG9zdCwgbmV3SENoYW5uZWwpOwogICAgfQoKICAgIHByaXZhdGUgSENo\nYW5uZWwgc3RvcmVOb25TdWJzY3JpcHRpb25DaGFubmVsKEluZXRTb2NrZXRB\nZGRyZXNzIGhvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBIQ2hhbm5lbCBuZXdIQ2hhbm5lbCkgewogICAg\nICAgIHJldHVybiBob3N0Mk5vblN1YnNjcmlwdGlvbkNoYW5uZWxzLmFkZENo\nYW5uZWwoaG9zdCwgbmV3SENoYW5uZWwpOwogICAgfQoKICAgIC8qKgogICAg\nICogSXMgdGhlcmUgYSB7QGxpbmsgSENoYW5uZWx9IGV4aXN0ZWQgZm9yIGEg\nZ2l2ZW4gaG9zdC4KICAgICAqCiAgICAgKiBAcGFyYW0gaG9zdAogICAgICog\nICAgICAgICAgVGFyZ2V0IGhvc3QgYWRkcmVzcy4KICAgICAqLwogICAgcHJp\ndmF0ZSBIQ2hhbm5lbCBnZXROb25TdWJzY3JpcHRpb25DaGFubmVsKEluZXRT\nb2NrZXRBZGRyZXNzIGhvc3QpIHsKICAgICAgICByZXR1cm4gaG9zdDJOb25T\ndWJzY3JpcHRpb25DaGFubmVscy5nZXRDaGFubmVsKGhvc3QpOwogICAgfQoK\nICAgIC8qKgogICAgICogR2V0IGEgbm9uLXN1YnNjcmlwdGlvbiBjaGFubmVs\nIGZvciBhIGdpdmVuIDxjb2RlPnRvcGljPC9jb2RlPi4KICAgICAqCiAgICAg\nKiBAcGFyYW0gdG9waWMKICAgICAqICAgICAgICAgIFRvcGljIE5hbWUKICAg\nICAqIEByZXR1cm4gaWYgPGNvZGU+dG9waWM8L2NvZGU+J3Mgb3duZXIgaXMg\ndW5rbm93biwgcmV0dXJuIG51bGwuCiAgICAgKiAgICAgICAgIGlmIDxjb2Rl\nPnRvcGljPC9jb2RlPidzIG93bmVyIGlzIGtub3cgYW5kIHRoZXJlIGlzIGEg\nY2hhbm5lbAogICAgICogICAgICAgICBleGlzdGVkIGJlZm9yZSwgcmV0dXJu\nIHRoZSBleGlzdGVkIGNoYW5uZWwsIG90aGVyd2lzZSBjcmVhdGVkCiAgICAg\nKiAgICAgICAgIGEgbmV3IG9uZS4KICAgICAqLwogICAgcHJpdmF0ZSBIQ2hh\nbm5lbCBnZXROb25TdWJzY3JpcHRpb25DaGFubmVsQnlUb3BpYyhCeXRlU3Ry\naW5nIHRvcGljKSB7CiAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgaG9zdCA9\nIHRvcGljMkhvc3QuZ2V0KHRvcGljKTsKICAgICAgICBpZiAobnVsbCA9PSBo\nb3N0KSB7CiAgICAgICAgICAgIC8vIHdlIGRvbid0IGtub3cgd2hlcmUgaXMg\ndGhlIHRvcGljCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIC8vIHdlIGhhZCBrbm93IHdoaWNoIHNlcnZl\nciBvd25lZCB0aGUgdG9waWMKICAgICAgICAgICAgSENoYW5uZWwgY2hhbm5l\nbCA9IGdldE5vblN1YnNjcmlwdGlvbkNoYW5uZWwoaG9zdCk7CiAgICAgICAg\nICAgIGlmIChudWxsID09IGNoYW5uZWwpIHsKICAgICAgICAgICAgICAgIC8v\nIGNyZWF0ZSBhIGNoYW5uZWwgdG8gY29ubmVjdCB0byBzcGVjaWZpZWQgaG9z\ndAogICAgICAgICAgICAgICAgY2hhbm5lbCA9IGNyZWF0ZUFuZFN0b3JlTm9u\nU3Vic2NyaXB0aW9uQ2hhbm5lbChob3N0KTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICByZXR1cm4gY2hhbm5lbDsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBIYW5kbGUgdGhlIGRpc2Nvbm5lY3RlZCBldmVudCBmcm9t\nIGEgbm9uLXN1YnNjcmlwdGlvbiB7QGxpbmsgSENoYW5uZWx9LgogICAgICoK\nICAgICAqIEBwYXJhbSBob3N0CiAgICAgKiAgICAgICAgICBXaGljaCBob3N0\nIGlzIGRpc2Nvbm5lY3RlZC4KICAgICAqIEBwYXJhbSBjaGFubmVsCiAgICAg\nKiAgICAgICAgICBUaGUgdW5kZXJseWluZyBlc3RhYmxpc2hlZCBjaGFubmVs\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBvbk5vblN1YnNjcmlwdGlv\nbkNoYW5uZWxEaXNjb25uZWN0ZWQoSW5ldFNvY2tldEFkZHJlc3MgaG9zdCwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBDaGFubmVsIGNoYW5uZWwpIHsKICAgICAgICAvLyBPbmx5\nIHJlbW92ZSB0aGUgQ2hhbm5lbCBmcm9tIHRoZSBtYXBwaW5nIGlmIHRoaXMg\nY3VycmVudAogICAgICAgIC8vIGRpc2Nvbm5lY3RlZCBjaGFubmVsIGlzIHRo\nZSBzYW1lIGFzIHRoZSBjYWNoZWQgZW50cnkuCiAgICAgICAgLy8gRHVlIHRv\nIHJhY2UgY29uY3VycmVuY3kgc2l0dWF0aW9ucywgaXQgaXMgcG9zc2libGUg\ndG8KICAgICAgICAvLyBjcmVhdGUgbXVsdGlwbGUgY2hhbm5lbHMgdG8gdGhl\nIHNhbWUgaG9zdCBmb3IgcHVibGlzaAogICAgICAgIC8vIGFuZCB1bnN1YnNj\ncmliZSByZXF1ZXN0cy4KICAgICAgICBIQ2hhbm5lbCBoQ2hhbm5lbCA9IGhv\nc3QyTm9uU3Vic2NyaXB0aW9uQ2hhbm5lbHMuZ2V0Q2hhbm5lbChob3N0KTsK\nICAgICAgICBpZiAobnVsbCA9PSBoQ2hhbm5lbCkgewogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQogICAgICAgIENoYW5uZWwgdW5kZXJseWluZ0No\nYW5uZWwgPSBoQ2hhbm5lbC5nZXRDaGFubmVsKCk7CiAgICAgICAgaWYgKG51\nbGwgPT0gdW5kZXJseWluZ0NoYW5uZWwgfHwKICAgICAgICAgICAgIXVuZGVy\nbHlpbmdDaGFubmVsLmVxdWFscyhjaGFubmVsKSkgewogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQogICAgICAgIGxvZ2dlci5pbmZvKCJOb25TdWJz\nY3JpcHRpb24gQ2hhbm5lbCB7fSB0byB7fSBkaXNjb25uZWN0ZWQuIiwKICAg\nICAgICAgICAgICAgICAgICB2YShjaGFubmVsLCBob3N0KSk7CiAgICAgICAg\nLy8gcmVtb3ZlIGV4aXN0ZWQgY2hhbm5lbAogICAgICAgIGlmIChob3N0Mk5v\nblN1YnNjcmlwdGlvbkNoYW5uZWxzLnJlbW92ZUNoYW5uZWwoaG9zdCwgaENo\nYW5uZWwpKSB7CiAgICAgICAgICAgIGNsZWFyQWxsVG9waWNzRm9ySG9zdCho\nb3N0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYW5kIHN0b3JlIGEgc3Vic2NyaXB0aW9uIHtAbGluayBIQ2hhbm5lbH0gdGhy\ndSB0aGUgdW5kZXJseWluZyBlc3RhYmxpc2hlZAogICAgICogPGNvZGU+Y2hh\nbm5lbDwvY29kZT4KICAgICAqCiAgICAgKiBAcGFyYW0gY2hhbm5lbAogICAg\nICogICAgICAgICAgVGhlIHVuZGVybHlpbmcgZXN0YWJsaXNoZWQgc3Vic2Ny\naXB0aW9uIGNoYW5uZWwuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFj\ndCBIQ2hhbm5lbCBjcmVhdGVBbmRTdG9yZVN1YnNjcmlwdGlvbkNoYW5uZWwo\nQ2hhbm5lbCBjaGFubmVsKTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQg\nc3RvcmUgYSBzdWJzY3JpcHRpb24ge0BsaW5rIEhDaGFubmVsfSB0byB0YXJn\nZXQgaG9zdC4KICAgICAqCiAgICAgKiBAcGFyYW0gaG9zdAogICAgICogICAg\nICAgICAgVGFyZ2V0IGhvc3QgYWRkcmVzcy4KICAgICAqLwogICAgcHJvdGVj\ndGVkIGFic3RyYWN0IEhDaGFubmVsIGNyZWF0ZUFuZFN0b3JlU3Vic2NyaXB0\naW9uQ2hhbm5lbChJbmV0U29ja2V0QWRkcmVzcyBob3N0KTsKCiAgICAvKioK\nICAgICAqIElzIHRoZXJlIGEgc3Vic2NyaXB0aW9uIHtAbGluayBIQ2hhbm5l\nbH0gZXhpc3RlZCBmb3IgYSBnaXZlbiBob3N0LgogICAgICoKICAgICAqIEBw\nYXJhbSBob3N0CiAgICAgKiAgICAgICAgICBUYXJnZXQgaG9zdCBhZGRyZXNz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgSENoYW5uZWwgZ2V0\nU3Vic2NyaXB0aW9uQ2hhbm5lbChJbmV0U29ja2V0QWRkcmVzcyBob3N0KTsK\nCiAgICAvKioKICAgICAqIEdldCBhIHN1YnNjcmlwdGlvbiBjaGFubmVsIGZv\nciBhIGdpdmVuIDxjb2RlPnRvcGljU3Vic2NyaWJlcjwvY29kZT4uCiAgICAg\nKgogICAgICogQHBhcmFtIHRvcGljU3Vic2NyaWJlcgogICAgICogICAgICAg\nICAgVG9waWMgU3Vic2NyaWJlcgogICAgICogQHJldHVybiBpZiA8Y29kZT50\nb3BpYzwvY29kZT4ncyBvd25lciBpcyB1bmtub3duLCByZXR1cm4gbnVsbC4K\nICAgICAqICAgICAgICAgaWYgPGNvZGU+dG9waWM8L2NvZGU+J3Mgb3duZXIg\naXMga25vdyBhbmQgdGhlcmUgaXMgYSBjaGFubmVsCiAgICAgKiAgICAgICAg\nIGV4aXN0ZWQgYmVmb3JlLCByZXR1cm4gdGhlIGV4aXN0ZWQgY2hhbm5lbCwg\nb3RoZXJ3aXNlIGNyZWF0ZWQKICAgICAqICAgICAgICAgYSBuZXcgb25lIGZv\nciB0aGUgPGNvZGU+dG9waWNTdWJzY3JpYmVyPC9jb2RlPi4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGFic3RyYWN0IEhDaGFubmVsIGdldFN1YnNjcmlwdGlv\nbkNoYW5uZWxCeVRvcGljU3Vic2NyaWJlcihUb3BpY1N1YnNjcmliZXIgdG9w\naWNTdWJzY3JpYmVyKTsKCiAgICAvKioKICAgICAqIEhhbmRsZSB0aGUgZGlz\nY29ubmVjdGVkIGV2ZW50IGZyb20gYSBzdWJzY3JpcHRpb24ge0BsaW5rIEhD\naGFubmVsfS4KICAgICAqCiAgICAgKiBAcGFyYW0gaG9zdAogICAgICogICAg\nICAgICAgV2hpY2ggaG9zdCBpcyBkaXNjb25uZWN0ZWQuCiAgICAgKiBAcGFy\nYW0gY2hhbm5lbAogICAgICogICAgICAgICAgVGhlIHVuZGVybHlpbmcgZXN0\nYWJsaXNoZWQgY2hhbm5lbC4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3Ry\nYWN0IHZvaWQgb25TdWJzY3JpcHRpb25DaGFubmVsRGlzY29ubmVjdGVkKElu\nZXRTb2NrZXRBZGRyZXNzIGhvc3QsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2hhbm5l\nbCBjaGFubmVsKTsKCiAgICBwcml2YXRlIHZvaWQgc2VuZENvbnN1bWVSZXF1\nZXN0KGZpbmFsIFRvcGljU3Vic2NyaWJlciB0b3BpY1N1YnNjcmliZXIsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIE1lc3Nh\nZ2VTZXFJZCBtZXNzYWdlU2VxSWQsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGZpbmFsIENoYW5uZWwgY2hhbm5lbCkgewogICAgICAg\nIFB1YlN1YlJlcXVlc3QuQnVpbGRlciBwdWJzdWJSZXF1ZXN0QnVpbGRlciA9\nCiAgICAgICAgICAgIE5ldFV0aWxzLmJ1aWxkQ29uc3VtZVJlcXVlc3QobmV4\ndFR4bklkKCksIHRvcGljU3Vic2NyaWJlciwgbWVzc2FnZVNlcUlkKTsgIAoK\nICAgICAgICAvLyBGb3IgQ29uc3VtZSByZXF1ZXN0cywgd2Ugd2lsbCBzZW5k\nIHRoZW0gZnJvbSB0aGUgY2xpZW50IGluIGEgZmlyZSBhbmQKICAgICAgICAv\nLyBmb3JnZXQgbWFubmVyLiBXZSBhcmUgbm90IGV4cGVjdGluZyB0aGUgc2Vy\ndmVyIHRvIHNlbmQgYmFjayBhbiBhY2sKICAgICAgICAvLyByZXNwb25zZSBz\nbyBubyBuZWVkIHRvIHJlZ2lzdGVyIHRoaXMgaW4gdGhlIFJlc3BvbnNlSGFu\nZGxlci4gVGhlcmUKICAgICAgICAvLyBhcmUgbm8gY2FsbGJhY2tzIHRvIGlu\ndm9rZSBzaW5jZSB0aGlzIGlzbid0IGEgY2xpZW50IGluaXRpYXRlZAogICAg\nICAgIC8vIGFjdGlvbi4gSW5zdGVhZCwganVzdCBoYXZlIGEgZnV0dXJlIGxp\nc3RlbmVyIHRoYXQgd2lsbCBsb2cgYW4gZXJyb3IKICAgICAgICAvLyBtZXNz\nYWdlIGlmIHRoZXJlIHdhcyBhIHByb2JsZW0gd3JpdGluZyB0aGUgY29uc3Vt\nZSByZXF1ZXN0LgogICAgICAgIGxvZ2dlci5kZWJ1ZygiV3JpdGluZyBhIENv\nbnN1bWUgcmVxdWVzdCB0byBob3N0OiB7fSB3aXRoIG1lc3NhZ2VTZXFJZDog\ne30gZm9yIHt9IiwKICAgICAgICAgICAgICAgICAgICAgdmEoTmV0VXRpbHMu\nZ2V0SG9zdEZyb21DaGFubmVsKGNoYW5uZWwpLCBtZXNzYWdlU2VxSWQsIHRv\ncGljU3Vic2NyaWJlcikpOwogICAgICAgIENoYW5uZWxGdXR1cmUgZnV0dXJl\nID0gY2hhbm5lbC53cml0ZShwdWJzdWJSZXF1ZXN0QnVpbGRlci5idWlsZCgp\nKTsKICAgICAgICBmdXR1cmUuYWRkTGlzdGVuZXIobmV3IENoYW5uZWxGdXR1\ncmVMaXN0ZW5lcigpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBsZXRlKENoYW5uZWxGdXR1\ncmUgZnV0dXJlKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIGlmICghZnV0dXJlLmlzU3VjY2VzcygpKSB7CiAgICAgICAgICAgICAgICAg\nICAgbG9nZ2VyLmVycm9yKCJFcnJvciB3cml0aW5nIGEgQ29uc3VtZSByZXF1\nZXN0IHRvIGhvc3Q6IHt9IHdpdGggbWVzc2FnZVNlcUlkOiB7fSBmb3Ige30i\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YShOZXRVdGls\ncy5nZXRIb3N0RnJvbUNoYW5uZWwoY2hhbm5lbCksCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VTZXFJZCwgdG9waWNTdWJz\nY3JpYmVyKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBlciBtZXRob2Qg\ndG8gc3RvcmUgdGhlIHRvcGljMkhvc3QgbWFwcGluZyBpbiB0aGUgY2hhbm5l\nbCBtYW5hZ2VyIGNhY2hlCiAgICAgKiBtYXAuIFRoaXMgbWV0aG9kIGlzIGFz\nc3VtZWQgdG8gYmUgY2FsbGVkIHdoZW4gd2UndmUgZG9uZSBhIHN1Y2Nlc3Nm\ndWwKICAgICAqIGNvbm5lY3Rpb24gdG8gdGhlIGNvcnJlY3Qgc2VydmVyIHRv\ncGljIG1hc3Rlci4KICAgICAqCiAgICAgKiBAcGFyYW0gdG9waWMKICAgICAq\nICAgICAgICAgICAgVG9waWMgTmFtZQogICAgICogQHBhcmFtIGhvc3QKICAg\nICAqICAgICAgICAgICAgSG9zdCBBZGRyZXNzCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHN0b3JlVG9waWMySG9zdE1hcHBpbmcoQnl0ZVN0cmluZyB0\nb3BpYywgSW5ldFNvY2tldEFkZHJlc3MgaG9zdCkgewogICAgICAgIEluZXRT\nb2NrZXRBZGRyZXNzIG9sZEhvc3QgPSB0b3BpYzJIb3N0LnB1dElmQWJzZW50\nKHRvcGljLCBob3N0KTsKICAgICAgICBpZiAobnVsbCAhPSBvbGRIb3N0ICYm\nIG9sZEhvc3QuZXF1YWxzKGhvc3QpKSB7CiAgICAgICAgICAgIC8vIEVudHJ5\nIGluIG1hcCBleGlzdHMgZm9yIHRoZSB0b3BpYyBidXQgaXQgaXMgdGhlIHNh\nbWUgYXMgdGhlCiAgICAgICAgICAgIC8vIGN1cnJlbnQgaG9zdC4gSW4gdGhp\ncyBjYXNlIHRoZXJlIGlzIG5vdGhpbmcgdG8gZG8uCiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChudWxsICE9IG9sZEhvc3Qp\nIHsKICAgICAgICAgICAgaWYgKHRvcGljMkhvc3QucmVwbGFjZSh0b3BpYywg\nb2xkSG9zdCwgaG9zdCkpIHsKICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRo\nZSByZWxldmFudCBtYXBwaW5ncyBmb3IgdGhpcyB0b3BpYyBhbmQgaG9zdCBj\nb21iaW5hdGlvbi4KICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3Rv\ncmluZyBpbmZvIGZvciB0b3BpYzoge30sIG9sZCBob3N0OiB7fSwgbmV3IGhv\nc3Q6IHt9LiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmEodG9w\naWMudG9TdHJpbmdVdGY4KCksIG9sZEhvc3QsIGhvc3QpKTsKICAgICAgICAg\nICAgICAgIGNsZWFySG9zdEZvclRvcGljKHRvcGljLCBvbGRIb3N0KTsKICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJu\nKCJPd25lcnNoaXAgb2YgdG9waWM6IHt9IGhhcyBiZWVuIGNoYW5nZWQgZnJv\nbSB7fSB0byB7fSB3aGVuIHN0b3JlaW5nIGhvc3Q6IHt9IiwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHZhKHRvcGljLnRvU3RyaW5nVXRmOCgpLCBv\nbGRIb3N0LCB0b3BpYzJIb3N0LmdldCh0b3BpYyksIGhvc3QpKTsKICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3RvcmluZyBpbmZvIGZv\nciB0b3BpYzoge30sIGhvc3Q6IHt9LiIsCiAgICAgICAgICAgICAgICAgICAg\nICAgICB2YSh0b3BpYy50b1N0cmluZ1V0ZjgoKSwgaG9zdCkpOwogICAgICAg\nIH0KICAgICAgICBTZXQ8Qnl0ZVN0cmluZz4gdG9waWNzRm9ySG9zdCA9IGhv\nc3QyVG9waWNzLmdldChob3N0KTsKICAgICAgICBpZiAobnVsbCA9PSB0b3Bp\nY3NGb3JIb3N0KSB7CiAgICAgICAgICAgIFNldDxCeXRlU3RyaW5nPiBuZXdU\nb3BpY3NTZXQgPSBuZXcgSGFzaFNldDxCeXRlU3RyaW5nPigpOwogICAgICAg\nICAgICB0b3BpY3NGb3JIb3N0ID0gaG9zdDJUb3BpY3MucHV0SWZBYnNlbnQo\naG9zdCwgbmV3VG9waWNzU2V0KTsKICAgICAgICAgICAgaWYgKG51bGwgPT0g\ndG9waWNzRm9ySG9zdCkgewogICAgICAgICAgICAgIHRvcGljc0Zvckhvc3Qg\nPSBuZXdUb3BpY3NTZXQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgc3luY2hyb25pemVkICh0b3BpY3NGb3JIb3N0KSB7CiAgICAgICAgICAg\nIC8vIGNoZWNrIHdoZXRoZXIgdGhlIG93bmVyc2hpcCBjaGFuZ2VkLCBzaW5j\nZSBpdCBtaWdodCBoYXBwZW5lZAogICAgICAgICAgICAvLyBhZnRlciByZXBs\nYWNlIHN1Y2NlZWQKICAgICAgICAgICAgaWYgKGhvc3QuZXF1YWxzKHRvcGlj\nMkhvc3QuZ2V0KHRvcGljKSkpIHsKICAgICAgICAgICAgICAgIHRvcGljc0Zv\nckhvc3QuYWRkKHRvcGljKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nIH0KCiAgICAvLyBJZiBhIHNlcnZlciBob3N0IGdvZXMgZG93biBvciB0aGUg\nY2hhbm5lbCB0byBpdCBnZXRzIGRpc2Nvbm5lY3RlZCwKICAgIC8vIHdlIHdh\nbnQgdG8gY2xlYXIgb3V0IGFsbCByZWxldmFudCBjYWNoZWQgaW5mb3JtYXRp\nb24uIFdlJ2xsCiAgICAvLyBuZWVkIHRvIHJlbW92ZSBhbGwgb2YgdGhlIHRv\ncGljIG1hcHBpbmdzIHRoYXQgdGhlIGhvc3Qgd2FzCiAgICAvLyByZXNwb25z\naWJsZSBmb3IuCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhckFsbFRvcGljc0Zv\nckhvc3QoSW5ldFNvY2tldEFkZHJlc3MgaG9zdCkgewogICAgICAgIGxvZ2dl\nci5kZWJ1ZygiQ2xlYXJpbmcgYWxsIHRvcGljcyBmb3IgaG9zdDoge30iLCBo\nb3N0KTsKICAgICAgICAvLyBGb3IgZWFjaCBvZiB0aGUgdG9waWNzIHRoYXQg\ndGhlIGhvc3Qgd2FzIHJlc3BvbnNpYmxlIGZvciwKICAgICAgICAvLyByZW1v\ndmUgaXQgZnJvbSB0aGUgdG9waWMySG9zdCBtYXBwaW5nLgogICAgICAgIFNl\ndDxCeXRlU3RyaW5nPiB0b3BpY3NGb3JIb3N0ID0gaG9zdDJUb3BpY3MuZ2V0\nKGhvc3QpOwogICAgICAgIGlmIChudWxsICE9IHRvcGljc0Zvckhvc3QpIHsK\nICAgICAgICAgICAgc3luY2hyb25pemVkICh0b3BpY3NGb3JIb3N0KSB7CiAg\nICAgICAgICAgICAgICBmb3IgKEJ5dGVTdHJpbmcgdG9waWMgOiB0b3BpY3NG\nb3JIb3N0KSB7CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJS\nZW1vdmluZyBtYXBwaW5nIGZvciB0b3BpYzoge30gZnJvbSBob3N0OiB7fS4i\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YSh0b3BpYy50\nb1N0cmluZ1V0ZjgoKSwgaG9zdCkpOwogICAgICAgICAgICAgICAgICAgIHRv\ncGljMkhvc3QucmVtb3ZlKHRvcGljLCBob3N0KTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBOb3cgaXQgaXMgc2Fm\nZSB0byByZW1vdmUgdGhlIGhvc3QyVG9waWNzIG1hcHBpbmcgZW50cnkuCiAg\nICAgICAgICAgIGhvc3QyVG9waWNzLnJlbW92ZShob3N0LCB0b3BpY3NGb3JI\nb3N0KTsKICAgICAgICB9CiAgICB9CgogICAgLy8gSWYgYSBzdWJzY3JpYmUg\nY2hhbm5lbCBnb2VzIGRvd24sIHRoZSB0b3BpYyBtaWdodCBoYXZlIG1vdmVk\nLgogICAgLy8gV2Ugb25seSBjbGVhciBvdXQgdGhhdCB0b3BpYyBmb3IgdGhl\nIGhvc3QgYW5kIG5vdCBhbGwgY2FjaGVkIGluZm9ybWF0aW9uLgogICAgcHVi\nbGljIHZvaWQgY2xlYXJIb3N0Rm9yVG9waWMoQnl0ZVN0cmluZyB0b3BpYywg\nSW5ldFNvY2tldEFkZHJlc3MgaG9zdCkgewogICAgICAgIGxvZ2dlci5kZWJ1\nZygiQ2xlYXJpbmcgdG9waWM6IHt9IGZyb20gaG9zdDoge30uIiwKICAgICAg\nICAgICAgICAgICAgICAgdmEodG9waWMudG9TdHJpbmdVdGY4KCksIGhvc3Qp\nKTsKICAgICAgICBpZiAodG9waWMySG9zdC5yZW1vdmUodG9waWMsIGhvc3Qp\nKSB7CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiUmVtb3ZlZCB0b3BpYyB0\nbyBob3N0IG1hcHBpbmcgZm9yIHRvcGljOiB7fSBhbmQgaG9zdDoge30uIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgIHZhKHRvcGljLnRvU3RyaW5nVXRm\nOCgpLCBob3N0KSk7CiAgICAgICAgfQogICAgICAgIFNldDxCeXRlU3RyaW5n\nPiB0b3BpY3NGb3JIb3N0ID0gaG9zdDJUb3BpY3MuZ2V0KGhvc3QpOwogICAg\nICAgIGlmIChudWxsICE9IHRvcGljc0Zvckhvc3QpIHsKICAgICAgICAgICAg\nYm9vbGVhbiByZW1vdmVkOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKHRv\ncGljc0Zvckhvc3QpIHsKICAgICAgICAgICAgICAgIHJlbW92ZWQgPSB0b3Bp\nY3NGb3JIb3N0LnJlbW92ZSh0b3BpYyk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgaWYgKHJlbW92ZWQpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5k\nZWJ1ZygiUmVtb3ZlZCB0b3BpYzoge30gZnJvbSBob3N0OiB7fS4iLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHRvcGljLnRvU3RyaW5nVXRmOCgp\nLCBob3N0KTsKICAgICAgICAgICAgICAgIGlmICh0b3BpY3NGb3JIb3N0Lmlz\nRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbmx5\nIHRvcGljIGxpc3QgaXMgZW1wdHkKICAgICAgICAgICAgICAgICAgICBob3N0\nMlRvcGljcy5yZW1vdmUoaG9zdCwgRU1QVFlfVE9QSUNfU0VUKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBsb25nIG5leHRUeG5JZCgpIHsKICAg\nICAgICByZXR1cm4gZ2xvYmFsQ291bnRlci5pbmNyZW1lbnRBbmRHZXQoKTsK\nICAgIH0KCiAgICAvLyBXZSBuZWVkIHRvIGRlYWwgd2l0aCB0aGUgcG9zc2li\nbGUgcHJvYmxlbSBvZiBhIFB1YlN1YiByZXF1ZXN0IGJlaW5nCiAgICAvLyB3\ncml0dGVuIHRvIHN1Y2Nlc3NmdWxseSB0byB0aGUgc2VydmVyIGhvc3QgYnV0\nIGZvciBzb21lIHJlYXNvbiwgdGhlCiAgICAvLyBhY2sgbWVzc2FnZSBiYWNr\nIG5ldmVyIGNvbWVzLiBXaGF0IGNvdWxkIGhhcHBlbiBpcyB0aGF0IHRoZSBW\nb2lkQ2FsbGJhY2sKICAgIC8vIHN0b3JlZCBpbiB0aGUgUmVzcG9uc2VIYW5k\nbGVyLnR4bjJQdWJsaXNoRGF0YSBtYXAgd2lsbCBuZXZlciBiZSBjYWxsZWQu\nCiAgICAvLyBXZSBzaG91bGQgaGF2ZSBhIGNvbmZpZ3VyZWQgdGltZW91dCBz\nbyBpZiB0aGF0IHBhc3NlcyBmcm9tIHRoZSB0aW1lIGEKICAgIC8vIHdyaXRl\nIHdhcyBzdWNjZXNzZnVsbHkgZG9uZSB0byB0aGUgc2VydmVyLCB3ZSBjYW4g\nZmFpbCB0aGlzIGFzeW5jIFB1YlN1YgogICAgLy8gdHJhbnNhY3Rpb24uIFRo\nZSBjYWxsZXIgY291bGQgcG9zc2libHkgcmVkbyB0aGUgdHJhbnNhY3Rpb24g\naWYgbmVlZGVkIGF0CiAgICAvLyBhIGxhdGVyIHRpbWUuIENyZWF0aW5nIGEg\ndGltZW91dCBjbGVhbmVyIFRpbWVyVGFzayB0byBkbyB0aGlzIGhlcmUuCiAg\nICBjbGFzcyBQdWJTdWJSZXF1ZXN0VGltZW91dFRhc2sgZXh0ZW5kcyBUaW1l\nclRhc2sgewogICAgICAgIC8qKgogICAgICAgICAqIEltcGxlbWVudCB0aGUg\nVGltZXJUYXNrJ3MgYWJzdHJhY3QgcnVuIG1ldGhvZC4KICAgICAgICAgKi8K\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7\nCiAgICAgICAgICAgIGlmIChpc0Nsb3NlZCgpKSB7CiAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9nZ2VyLmRl\nYnVnKCJSdW5uaW5nIHRoZSBQdWJTdWJSZXF1ZXN0IFRpbWVvdXQgVGFzayIp\nOwogICAgICAgICAgICAvLyBGaXJzdCBjaGVjayB0aG9zZSBub24tc3Vic2Ny\naXB0aW9uIGNoYW5uZWxzCiAgICAgICAgICAgIGZvciAoSENoYW5uZWwgY2hh\nbm5lbCA6IGhvc3QyTm9uU3Vic2NyaXB0aW9uQ2hhbm5lbHMuZ2V0Q2hhbm5l\nbHMoKSkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICBIQ2hhbm5lbEhhbmRsZXIgY2hhbm5lbEhhbmRsZXIgPQogICAgICAg\nICAgICAgICAgICAgICAgICBIQ2hhbm5lbEltcGwuZ2V0SENoYW5uZWxIYW5k\nbGVyRnJvbUNoYW5uZWwoY2hhbm5lbC5nZXRDaGFubmVsKCkpOwogICAgICAg\nICAgICAgICAgICAgIGNoYW5uZWxIYW5kbGVyLmNoZWNrVGltZW91dFJlcXVl\nc3RzKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChOb1Jlc3BvbnNlSGFu\nZGxlckV4Y2VwdGlvbiBucmhlKSB7CiAgICAgICAgICAgICAgICAgICAgY29u\ndGludWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgLy8gVGhlbiBjaGVjayB0aG9zZSBzdWJzY3JpcHRpb24gY2hhbm5l\nbHMKICAgICAgICAgICAgY2hlY2tUaW1lb3V0UmVxdWVzdHNPblN1YnNjcmlw\ndGlvbkNoYW5uZWxzKCk7CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3Rl\nZCBhYnN0cmFjdCB2b2lkIHJlc3RhcnREZWxpdmVyeShUb3BpY1N1YnNjcmli\nZXIgdG9waWNTdWJzY3JpYmVyKQogICAgICAgIHRocm93cyBDbGllbnROb3RT\ndWJzY3JpYmVkRXhjZXB0aW9uLCBBbHJlYWR5U3RhcnREZWxpdmVyeUV4Y2Vw\ndGlvbjsKCiAgICAvKioKICAgICAqIENoZWtvdXQgdGhlIHB1Yi9zdWIgcmVx\ndWVzdHMgb24gc3Vic2NyaXB0aW9uIGNoYW5uZWxzLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYWJzdHJhY3Qgdm9pZCBjaGVja1RpbWVvdXRSZXF1ZXN0c09u\nU3Vic2NyaXB0aW9uQ2hhbm5lbHMoKTsKCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBib29sZWFuIGlzQ2xvc2VkKCkgewogICAgICAgIGNsb3NlZExvY2su\ncmVhZExvY2soKS5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\ncmV0dXJuIGNsb3NlZDsgCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgY2xvc2VkTG9jay5yZWFkTG9jaygpLnVubG9jaygpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIENsb3NlIGFsbCBzdWJzY3JpcHRpb24g\nY2hhbm5lbHMgd2hlbiBjbG9zZSBjaGFubmVsIG1hbmFnZXIuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBhYnN0cmFjdCB2b2lkIGNsb3NlU3Vic2NyaXB0aW9u\nQ2hhbm5lbHMoKTsKCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGNs\nb3NlKCkgewogICAgICAgIGxvZ2dlci5pbmZvKCJTaHV0dGluZyBkb3duIHRo\nZSBjaGFubmVscyBtYW5hZ2VyLiIpOwogICAgICAgIGNsb3NlZExvY2sud3Jp\ndGVMb2NrKCkubG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8v\nIE5vdCBmaXJzdCB0aW1lIHRvIGNsb3NlCiAgICAgICAgICAgIGlmIChjbG9z\nZWQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBjbG9zZWQgPSB0cnVlOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIGNsb3NlZExvY2sud3JpdGVMb2NrKCkudW5sb2NrKCk7\nCiAgICAgICAgfQogICAgICAgIGNsaWVudFRpbWVyLmNhbmNlbCgpOwogICAg\nICAgIC8vIENsZWFyIGFsbCBleGlzdGVkIGNoYW5uZWxzCiAgICAgICAgaG9z\ndDJOb25TdWJzY3JpcHRpb25DaGFubmVscy5jbG9zZSgpOwoKICAgICAgICAv\nLyBjbGVhciBhbGwgc3Vic2NyaXB0aW9uIGNoYW5uZWxzCiAgICAgICAgY2xv\nc2VTdWJzY3JpcHRpb25DaGFubmVscygpOwoKICAgICAgICAvLyBDbGVhciBv\ndXQgYWxsIE1hcHMKICAgICAgICB0b3BpYzJIb3N0LmNsZWFyKCk7CiAgICAg\nICAgaG9zdDJUb3BpY3MuY2xlYXIoKTsKICAgIH0KCn0K\n","encoding":"base64"}

