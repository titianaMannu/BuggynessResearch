{"sha":"fd58747b87182b2df95e3a5d25ddfd609e3bb0a5","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmQ1ODc0N2I4NzE4MmIyZGY5NWUzYTVkMjVkZGZkNjA5ZTNiYjBhNQ==","size":14125,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fd58747b87182b2df95e3a5d25ddfd609e3bb0a5","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHkuaW1wbDsKCmlt\ncG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0QWRkcmVzczsKaW1wb3J0IGphdmEu\ndXRpbC5BcnJheURlcXVlOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZExpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuUXVldWU7CgppbXBvcnQgY29tLmdvb2dsZS5w\ncm90b2J1Zi5CeXRlU3RyaW5nOwoKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5i\nb290c3RyYXAuQ2xpZW50Qm9vdHN0cmFwOwppbXBvcnQgb3JnLmpib3NzLm5l\ndHR5LmNoYW5uZWwuQ2hhbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5j\naGFubmVsLkNoYW5uZWxGdXR1cmU7CmltcG9ydCBvcmcuamJvc3MubmV0dHku\nY2hhbm5lbC5DaGFubmVsRnV0dXJlTGlzdGVuZXI7CgppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEuUHViU3ViRGF0YTsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5leGNlcHRpb25zLk5vUmVzcG9uc2VI\nYW5kbGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xp\nZW50Lm5ldHR5LkhDaGFubmVsOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nY2xpZW50Lm5ldHR5Lk5ldFV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb24uQ291bGROb3RDb25uZWN0\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wu\nUHViU3ViUHJvdG9jb2wuUHViU3ViUmVxdWVzdDsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnV0aWwuSGVkd2lnU29ja2V0QWRkcmVzczsKaW1wb3J0IHN0\nYXRpYyBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLlZhckFyZ3MudmE7CgppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJG\nYWN0b3J5OwoKLyoqCiAqIFByb3ZpZGUgYSB3cmFwcGVyIG92ZXIgbmV0dHkg\nY2hhbm5lbCBmb3IgSGVkd2lnIG9wZXJhdGlvbnMuCiAqLwpwdWJsaWMgY2xh\nc3MgSENoYW5uZWxJbXBsIGltcGxlbWVudHMgSENoYW5uZWwgewoKICAgIHBy\naXZhdGUgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihIQ2hhbm5lbEltcGwuY2xhc3MpOwoKICAgIGVudW0gU3RhdGUg\newogICAgICAgIERJU0NPTk5FQ1RFRCwKICAgICAgICBDT05ORUNUSU5HLAog\nICAgICAgIENPTk5FQ1RFRCwKICAgIH07CgogICAgSW5ldFNvY2tldEFkZHJl\nc3MgaG9zdDsKICAgIGZpbmFsIEFic3RyYWN0SENoYW5uZWxNYW5hZ2VyIGNo\nYW5uZWxNYW5hZ2VyOwogICAgZmluYWwgQ2xpZW50Q2hhbm5lbFBpcGVsaW5l\nRmFjdG9yeSBwaXBlbGluZUZhY3Rvcnk7CiAgICB2b2xhdGlsZSBDaGFubmVs\nIGNoYW5uZWw7CiAgICB2b2xhdGlsZSBTdGF0ZSBzdGF0ZTsKCiAgICAvLyBJ\nbmRpY2F0ZXMgd2hldGhlciB0aGUgY2hhbm5lbCBpcyBjbG9zZWQgb3Igbm90\nLgogICAgdm9sYXRpbGUgYm9vbGVhbiBjbG9zZWQgPSBmYWxzZTsKICAgIC8v\nIFF1ZXVlIHRoZSBwdWJzdWIgcmVxdWVzdHMgd2hlbiB0aGUgY2hhbm5lbCBp\ncyBub3QgY29ubmVjdGVkLgogICAgUXVldWU8UHViU3ViRGF0YT4gcGVuZGlu\nZ09wcyA9IG5ldyBBcnJheURlcXVlPFB1YlN1YkRhdGE+KCk7CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgYSB1bi1lc3RhYmxpc2hlZCBjaGFubmVsIHdpdGgg\ncHJvdmlkZWQgdGFyZ2V0IDxjb2RlPmhvc3Q8L2NvZGU+LgogICAgICoKICAg\nICAqIEBwYXJhbSBob3N0CiAgICAgKiAgICAgICAgICBUYXJnZXQgaG9zdCBh\nZGRyZXNzLgogICAgICogQHBhcmFtIGNoYW5uZWxNYW5hZ2VyCiAgICAgKiAg\nICAgICAgICBDaGFubmVsIG1hbmFnZXIgbWFuYWdlcyB0aGUgY2hhbm5lbHMu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBIQ2hhbm5lbEltcGwoSW5ldFNvY2tl\ndEFkZHJlc3MgaG9zdCwgQWJzdHJhY3RIQ2hhbm5lbE1hbmFnZXIgY2hhbm5l\nbE1hbmFnZXIpIHsKICAgICAgICB0aGlzKGhvc3QsIGNoYW5uZWxNYW5hZ2Vy\nLCBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgSENoYW5uZWxJbXBsKEluZXRT\nb2NrZXRBZGRyZXNzIGhvc3QsIEFic3RyYWN0SENoYW5uZWxNYW5hZ2VyIGNo\nYW5uZWxNYW5hZ2VyLAogICAgICAgICAgICAgICAgICAgICAgICBDbGllbnRD\naGFubmVsUGlwZWxpbmVGYWN0b3J5IHBpcGVsaW5lRmFjdG9yeSkgewogICAg\nICAgIHRoaXMoaG9zdCwgbnVsbCwgY2hhbm5lbE1hbmFnZXIsIHBpcGVsaW5l\nRmFjdG9yeSk7CiAgICAgICAgc3RhdGUgPSBTdGF0ZS5ESVNDT05ORUNURUQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSA8Y29kZT5IQ2hhbm5l\nbDwvY29kZT4gd2l0aCBhbiBlc3RhYmxpc2hlZCBuZXR0eSBjaGFubmVsLgog\nICAgICoKICAgICAqIEBwYXJhbSBob3N0CiAgICAgKiAgICAgICAgICBUYXJn\nZXQgaG9zdCBhZGRyZXNzLgogICAgICogQHBhcmFtIGNoYW5uZWwKICAgICAq\nICAgICAgICAgIEVzdGFibGlzaGVkIE5ldHR5IGNoYW5uZWwuCiAgICAgKiBA\ncGFyYW0gY2hhbm5lbE1hbmFnZXIKICAgICAqICAgICAgICAgIENoYW5uZWwg\nbWFuYWdlciBtYW5hZ2VzIHRoZSBjaGFubmVscy4KICAgICAqLwogICAgcHVi\nbGljIEhDaGFubmVsSW1wbChJbmV0U29ja2V0QWRkcmVzcyBob3N0LCBDaGFu\nbmVsIGNoYW5uZWwsCiAgICAgICAgICAgICAgICAgICAgICAgIEFic3RyYWN0\nSENoYW5uZWxNYW5hZ2VyIGNoYW5uZWxNYW5hZ2VyLAogICAgICAgICAgICAg\nICAgICAgICAgICBDbGllbnRDaGFubmVsUGlwZWxpbmVGYWN0b3J5IHBpcGVs\naW5lRmFjdG9yeSkgewogICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7CiAgICAg\nICAgdGhpcy5jaGFubmVsID0gY2hhbm5lbDsKICAgICAgICB0aGlzLmNoYW5u\nZWxNYW5hZ2VyID0gY2hhbm5lbE1hbmFnZXI7CiAgICAgICAgdGhpcy5waXBl\nbGluZUZhY3RvcnkgPSBwaXBlbGluZUZhY3Rvcnk7CiAgICAgICAgc3RhdGUg\nPSBTdGF0ZS5DT05ORUNURUQ7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCBzdWJtaXRPcChQdWJTdWJEYXRhIHB1YlN1YkRhdGEpIHsK\nICAgICAgICBib29sZWFuIGRvT3BOb3cgPSBmYWxzZTsKCiAgICAgICAgLy8g\nY29tbW9uIGNhc2Ugd2l0aG91dCBsb2NrIGZpcnN0CiAgICAgICAgaWYgKG51\nbGwgIT0gY2hhbm5lbCAmJiBTdGF0ZS5DT05ORUNURUQgPT0gc3RhdGUpIHsK\nICAgICAgICAgICAgZG9PcE5vdyA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAg\nICAgICAvLyBjaGVjayBjaGFubmVsICYgc3RhdGUgYWdhaW4gdW5kZXIgbG9j\nawogICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gY2hhbm5lbCAmJiBTdGF0\nZS5DT05ORUNURUQgPT0gc3RhdGUpIHsKICAgICAgICAgICAgICAgICAgICBk\nb09wTm93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgLy8gaWYgcmVhY2hlZCBoZXJlLCBjaGFubmVsIGlz\nIGVpdGhlciBudWxsIChmaXJzdCBjb25uZWN0aW9uIGF0dGVtcHQpLAogICAg\nICAgICAgICAgICAgICAgIC8vIG9yIHRoZSBjaGFubmVsIGlzIGRpc2Nvbm5l\nY3RlZC4gQ29ubmVjdGlvbiBhdHRlbXB0IGlzIHN0aWxsIGluIHByb2dyZXNz\nLAogICAgICAgICAgICAgICAgICAgIC8vIHF1ZXVlIHVwIHRoaXMgb3AuIE9w\nIHdpbGwgYmUgZXhlY3V0ZWQgd2hlbiBjb25uZWN0aW9uIGF0dGVtcHQgZWl0\naGVyCiAgICAgICAgICAgICAgICAgICAgLy8gZmFpbHMgb3Igc3VjY2VlZHMK\nICAgICAgICAgICAgICAgICAgICBwZW5kaW5nT3BzLmFkZChwdWJTdWJEYXRh\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAoIWRvT3BOb3cpIHsKICAgICAgICAgICAgICAgIC8vIHN0YXJ0IGNv\nbm5lY3Rpb24gYXR0ZW1wdCB0byBzZXJ2ZXIKICAgICAgICAgICAgICAgIGNv\nbm5lY3QoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAo\nZG9PcE5vdykgewogICAgICAgICAgICBleGVjdXRlT3BBZnRlckNvbm5lY3Rl\nZChwdWJTdWJEYXRhKTsgCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogRXhlY3V0ZSBwdWIvc3ViIG9wZXJhdGlvbiBhZnRlciB0aGUgdW5kZXJs\neWluZyBjaGFubmVsIGlzIGNvbm5lY3RlZC4KICAgICAqCiAgICAgKiBAcGFy\nYW0gcHViU3ViRGF0YQogICAgICogICAgICAgICAgUHViL1N1YiBPcGVyYXRp\nb24KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGV4ZWN1dGVPcEFmdGVyQ29u\nbmVjdGVkKFB1YlN1YkRhdGEgcHViU3ViRGF0YSkgewogICAgICAgIFB1YlN1\nYlJlcXVlc3QuQnVpbGRlciByZXFCdWlsZGVyID0KICAgICAgICAgICAgTmV0\nVXRpbHMuYnVpbGRQdWJTdWJSZXF1ZXN0KGNoYW5uZWxNYW5hZ2VyLm5leHRU\neG5JZCgpLCBwdWJTdWJEYXRhKTsKICAgICAgICB3cml0ZVB1YlN1YlJlcXVl\nc3QocHViU3ViRGF0YSwgcmVxQnVpbGRlci5idWlsZCgpKTsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBDaGFubmVsIGdldENoYW5uZWwoKSB7\nCiAgICAgICAgcmV0dXJuIGNoYW5uZWw7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIHdyaXRlUHViU3ViUmVxdWVzdChQdWJTdWJEYXRhIHB1YlN1YkRhdGEs\nIFB1YlN1YlJlcXVlc3QgcHViU3ViUmVxdWVzdCkgewogICAgICAgIGlmIChj\nbG9zZWQgfHwgbnVsbCA9PSBjaGFubmVsIHx8IFN0YXRlLkNPTk5FQ1RFRCAh\nPSBzdGF0ZSkgewogICAgICAgICAgICByZXRyeU9yRmFpbE9wKHB1YlN1YkRh\ndGEpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAv\nLyBCZWZvcmUgd2UgZG8gdGhlIHdyaXRlLCBzdG9yZSB0aGlzIGluZm9ybWF0\naW9uIGludG8gdGhlCiAgICAgICAgLy8gUmVzcG9uc2VIYW5kbGVyIHNvIHdo\nZW4gdGhlIHNlcnZlciByZXNwb25kcywgd2Uga25vdyB3aGF0CiAgICAgICAg\nLy8gYXBwcm9wcmlhdGUgQ2FsbGJhY2sgRGF0YSB0byBpbnZva2UgZm9yIHRo\nZSBnaXZlbiB0eG4gSUQuCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZ2V0\nSENoYW5uZWxIYW5kbGVyRnJvbUNoYW5uZWwoY2hhbm5lbCkKICAgICAgICAg\nICAgICAgIC5hZGRUeG4ocHViU3ViRGF0YS50eG5JZCwgcHViU3ViRGF0YSk7\nCiAgICAgICAgfSBjYXRjaCAoTm9SZXNwb25zZUhhbmRsZXJFeGNlcHRpb24g\nbnJoZSkgewogICAgICAgICAgICBsb2dnZXIud2FybigiTm8gQ2hhbm5lbCBI\nYW5kbGVyIGZvdW5kIGZvciBjaGFubmVsIHt9IHdoZW4gd3JpdGluZyByZXF1\nZXN0LiIKICAgICAgICAgICAgICAgICAgICAgICAgKyAiIEl0IG1pZ2h0IGFs\ncmVhZHkgZGlzY29ubmVjdC4iLCBjaGFubmVsKTsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gRmluYWxseSwgd3JpdGUgdGhl\nIHB1Yi9zdWIgcmVxdWVzdCB0aHJvdWdoIHRoZSBDaGFubmVsLgogICAgICAg\nIGxvZ2dlci5kZWJ1ZygiV3JpdGluZyBhIHt9IHJlcXVlc3QgdG8gaG9zdDog\ne30gZm9yIHB1YlN1YkRhdGE6IHt9LiIsCiAgICAgICAgICAgICAgICAgICAg\nIHZhKHB1YlN1YkRhdGEub3BlcmF0aW9uVHlwZSwgaG9zdCwgcHViU3ViRGF0\nYSkpOwogICAgICAgIENoYW5uZWxGdXR1cmUgZnV0dXJlID0gY2hhbm5lbC53\ncml0ZShwdWJTdWJSZXF1ZXN0KTsKICAgICAgICBmdXR1cmUuYWRkTGlzdGVu\nZXIobmV3IFdyaXRlQ2FsbGJhY2socHViU3ViRGF0YSwgY2hhbm5lbE1hbmFn\nZXIpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlLXN1Ym1pdCBvcGVyYXRp\nb24gdG8gZGVmYXVsdCBzZXJ2ZXIgb3IgZmFpbCBpdC4KICAgICAqCiAgICAg\nKiBAcGFyYW0gcHViU3ViRGF0YQogICAgICogICAgICAgICAgUHViL1N1YiBP\ncGVyYXRpb24KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcmV0cnlPckZh\naWxPcChQdWJTdWJEYXRhIHB1YlN1YkRhdGEpIHsKICAgICAgICAvLyBpZiB3\nZSB3ZXJlIG5vdCBhYmxlIHRvIGNvbm5lY3QgdG8gdGhlIGhvc3QsIGl0IGNv\ndWxkIGJlIGRvd24KICAgICAgICBCeXRlU3RyaW5nIGhvc3RTdHJpbmcgPSBC\neXRlU3RyaW5nLmNvcHlGcm9tVXRmOChIZWR3aWdTb2NrZXRBZGRyZXNzLnNv\nY2tBZGRyU3RyKGhvc3QpKTsKICAgICAgICBpZiAocHViU3ViRGF0YS5jb25u\nZWN0RmFpbGVkU2VydmVycyAhPSBudWxsICYmCiAgICAgICAgICAgIHB1YlN1\nYkRhdGEuY29ubmVjdEZhaWxlZFNlcnZlcnMuY29udGFpbnMoaG9zdFN0cmlu\nZykpIHsKICAgICAgICAgICAgLy8gV2UndmUgYWxyZWFkeSB0cmllZCB0byBj\nb25uZWN0IHRvIHRoaXMgaG9zdCBiZWZvcmUgc28ganVzdAogICAgICAgICAg\nICAvLyBpbnZva2UgdGhlIG9wZXJhdGlvbkZhaWxlZCBjYWxsYmFjay4KICAg\nICAgICAgICAgbG9nZ2VyLmVycm9yKCJFcnJvciBjb25uZWN0aW5nIHRvIGhv\nc3Qge30gbW9yZSB0aGFuIG9uY2Ugc28gZmFpbCB0aGUgcmVxdWVzdDoge30i\nLAogICAgICAgICAgICAgICAgICAgICAgICAgdmEoaG9zdCwgcHViU3ViRGF0\nYSkpOwogICAgICAgICAgICBwdWJTdWJEYXRhLmdldENhbGxiYWNrKCkub3Bl\ncmF0aW9uRmFpbGVkKHB1YlN1YkRhdGEuY29udGV4dCwKICAgICAgICAgICAg\nICAgIG5ldyBDb3VsZE5vdENvbm5lY3RFeGNlcHRpb24oIkNvdWxkIG5vdCBj\nb25uZWN0IHRvIGhvc3Q6ICIgKyBob3N0KSk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJSZXRyeSB0byBjb25uZWN0IHRv\nIGRlZmF1bHQgaHViIHNlcnZlciBhZ2FpbiBmb3IgcHViU3ViRGF0YToge30i\nLAogICAgICAgICAgICAgICAgICAgICAgICAgcHViU3ViRGF0YSk7CiAgICAg\nICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhpcyBjdXJyZW50IHNlcnZlciB0\naGF0IHdlIGZhaWxlZCB0byBjb25uZWN0CiAgICAgICAgICAgIC8vIHRvIGJ1\ndCByZXRyeSB0aGUgcmVxdWVzdCBvbiB0aGUgZGVmYXVsdCBzZXJ2ZXIgaG9z\ndC9WSVAuCiAgICAgICAgICAgIGlmIChwdWJTdWJEYXRhLmNvbm5lY3RGYWls\nZWRTZXJ2ZXJzID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHB1YlN1YkRh\ndGEuY29ubmVjdEZhaWxlZFNlcnZlcnMgPSBuZXcgTGlua2VkTGlzdDxCeXRl\nU3RyaW5nPigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHB1YlN1YkRh\ndGEuY29ubmVjdEZhaWxlZFNlcnZlcnMuYWRkKGhvc3RTdHJpbmcpOwogICAg\nICAgICAgICBjaGFubmVsTWFuYWdlci5zdWJtaXRPcFRvRGVmYXVsdFNlcnZl\ncihwdWJTdWJEYXRhKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIG9uQ2hhbm5lbENvbm5lY3RlZChDaGFubmVsRnV0dXJlIGZ1dHVyZSkg\newogICAgICAgIFF1ZXVlPFB1YlN1YkRhdGE+IG9sZFBlbmRpbmdPcHM7CiAg\nICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIC8vIGlm\nIHRoZSBjaGFubmVsIGlzIGNsb3NlZCBieSBjbGllbnQsIGRvIG5vdGhpbmcK\nICAgICAgICAgICAgaWYgKGNsb3NlZCkgewogICAgICAgICAgICAgICAgZnV0\ndXJlLmdldENoYW5uZWwoKS5jbG9zZSgpOwogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN0YXRlID0gU3RhdGUu\nQ09OTkVDVEVEOwogICAgICAgICAgICBjaGFubmVsID0gZnV0dXJlLmdldENo\nYW5uZWwoKTsKICAgICAgICAgICAgaG9zdCA9IE5ldFV0aWxzLmdldEhvc3RG\ncm9tQ2hhbm5lbChjaGFubmVsKTsKICAgICAgICAgICAgb2xkUGVuZGluZ09w\ncyA9IHBlbmRpbmdPcHM7CiAgICAgICAgICAgIHBlbmRpbmdPcHMgPSBuZXcg\nQXJyYXlEZXF1ZTxQdWJTdWJEYXRhPigpOwogICAgICAgIH0KICAgICAgICBm\nb3IgKFB1YlN1YkRhdGEgb3AgOiBvbGRQZW5kaW5nT3BzKSB7CiAgICAgICAg\nICAgIGV4ZWN1dGVPcEFmdGVyQ29ubmVjdGVkKG9wKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIG9uQ2hhbm5lbENvbm5lY3RGYWlsdXJl\nKCkgewogICAgICAgIFF1ZXVlPFB1YlN1YkRhdGE+IG9sZFBlbmRpbmdPcHM7\nCiAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIHN0\nYXRlID0gU3RhdGUuRElTQ09OTkVDVEVEOwogICAgICAgICAgICBjaGFubmVs\nID0gbnVsbDsKICAgICAgICAgICAgb2xkUGVuZGluZ09wcyA9IHBlbmRpbmdP\ncHM7CiAgICAgICAgICAgIHBlbmRpbmdPcHMgPSBuZXcgQXJyYXlEZXF1ZTxQ\ndWJTdWJEYXRhPigpOwogICAgICAgIH0KICAgICAgICBmb3IgKFB1YlN1YkRh\ndGEgb3AgOiBvbGRQZW5kaW5nT3BzKSB7CiAgICAgICAgICAgIHJldHJ5T3JG\nYWlsT3Aob3ApOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\nY29ubmVjdCgpIHsKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAg\nICAgICAgICAgaWYgKFN0YXRlLkNPTk5FQ1RJTkcgPT0gc3RhdGUgfHwKICAg\nICAgICAgICAgICAgIFN0YXRlLkNPTk5FQ1RFRCA9PSBzdGF0ZSkgewogICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIHN0YXRlID0gU3RhdGUuQ09OTkVDVElORzsKICAgICAgICB9CiAgICAgICAg\nLy8gU3RhcnQgdGhlIGNvbm5lY3Rpb24gYXR0ZW1wdCB0byB0aGUgaW5wdXQg\nc2VydmVyIGhvc3QuCiAgICAgICAgQ2hhbm5lbEZ1dHVyZSBmdXR1cmUgPSBj\nb25uZWN0KGhvc3QsIHBpcGVsaW5lRmFjdG9yeSk7CiAgICAgICAgZnV0dXJl\nLmFkZExpc3RlbmVyKG5ldyBDaGFubmVsRnV0dXJlTGlzdGVuZXIoKSB7Cgog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uQ29tcGxldGUoQ2hhbm5lbEZ1dHVyZSBmdXR1cmUpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgICAgICAgICAgLy8gSWYgdGhlIGNoYW5u\nZWwgaGFzIGJlZW4gY2xvc2VkLCB0aGVyZSBpcyBubyBuZWVkIHRvIHByb2Nl\nZWQgd2l0aCBhbnkKICAgICAgICAgICAgICAgIC8vIGNhbGxiYWNrIGxvZ2lj\nIGhlcmUuCiAgICAgICAgICAgICAgICBpZiAoY2xvc2VkKSB7CiAgICAgICAg\nICAgICAgICAgICAgZnV0dXJlLmdldENoYW5uZWwoKS5jbG9zZSgpOwogICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICBpZiAoIWZ1dHVyZS5pc1N1Y2Nlc3MoKSkgewogICAg\nICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3IgY29ubmVjdGlu\nZyB0byBob3N0IHt9LiIsIGhvc3QpOwogICAgICAgICAgICAgICAgICAgIGZ1\ndHVyZS5nZXRDaGFubmVsKCkuY2xvc2UoKTsKCiAgICAgICAgICAgICAgICAg\nICAgLy8gaWYgd2Ugd2VyZSBub3QgYWJsZSB0byBjb25uZWN0IHRvIHRoZSBo\nb3N0LCBpdCBjb3VsZCBiZSBkb3duLgogICAgICAgICAgICAgICAgICAgIG9u\nQ2hhbm5lbENvbm5lY3RGYWlsdXJlKCk7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbG9n\nZ2VyLmRlYnVnKCJDb25uZWN0ZWQgdG8gc2VydmVyIHt9LiIsIGhvc3QpOwog\nICAgICAgICAgICAgICAgLy8gTm93IHRoYXQgd2UgaGF2ZSBjb25uZWN0ZWQg\nc3VjY2Vzc2Z1bGx5IHRvIHRoZSBzZXJ2ZXIsIGV4ZWN1dGUgYWxsIHF1ZXVl\naW5nCiAgICAgICAgICAgICAgICAvLyByZXF1ZXN0cy4KICAgICAgICAgICAg\nICAgIG9uQ2hhbm5lbENvbm5lY3RlZChmdXR1cmUpOwogICAgICAgICAgICB9\nCgogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBpcyBh\nIGhlbHBlciBtZXRob2QgdG8gZG8gdGhlIGNvbm5lY3QgYXR0ZW1wdCB0byB0\naGUgc2VydmVyIGdpdmVuIHRoZQogICAgICogaW5wdXR0ZWQgaG9zdC9wb3J0\nLiBUaGlzIGNhbiBiZSB1c2VkIHRvIGNvbm5lY3QgdG8gdGhlIGRlZmF1bHQg\nc2VydmVyCiAgICAgKiBob3N0L3BvcnQgd2hpY2ggaXMgdGhlIFZJUC4gVGhh\ndCB3aWxsIHBpY2sgYSBzZXJ2ZXIgaW4gdGhlIGNsdXN0ZXIgYXQKICAgICAq\nIHJhbmRvbSB0byBjb25uZWN0IHRvIGZvciB0aGUgaW5pdGlhbCBQdWJTdWIg\nYXR0ZW1wdCAod2l0aCByZWRpcmVjdCBsb2dpYwogICAgICogYmVpbmcgZG9u\nZSBhdCB0aGUgc2VydmVyIHNpZGUpLiBBZGRpdGlvbmFsbHksIHRoaXMgY291\nbGQgYmUgY2FsbGVkIGFmdGVyCiAgICAgKiB0aGUgY2xpZW50IG1ha2VzIGFu\nIGluaXRpYWwgUHViU3ViIGF0dGVtcHQgYXQgYSBzZXJ2ZXIsIGFuZCBpcyBy\nZWRpcmVjdGVkCiAgICAgKiB0byB0aGUgb25lIHRoYXQgaXMgcmVzcG9uc2li\nbGUgZm9yIHRoZSB0b3BpYy4gT25jZSB0aGUgY29ubmVjdCB0byB0aGUKICAg\nICAqIHNlcnZlciBpcyBkb25lLCB3ZSB3aWxsIHBlcmZvcm0gdGhlIGNvcnJl\nc3BvbmRpbmcgUHViU3ViIHdyaXRlIG9uIHRoYXQKICAgICAqIGNoYW5uZWwu\nCiAgICAgKgogICAgICogQHBhcmFtIHNlcnZlckhvc3QKICAgICAqICAgICAg\nICAgICAgSW5wdXQgc2VydmVyIGhvc3QgdG8gY29ubmVjdCB0byBvZiB0eXBl\nIEluZXRTb2NrZXRBZGRyZXNzCiAgICAgKiBAcGFyYW0gcGlwZWxpbmVGYWN0\nb3J5CiAgICAgKiAgICAgICAgICAgIFBpcGVsaW5lRmFjdG9yeSB0byBjcmVh\ndGUgcmVzcG9uc2UgaGFuZGxlciB0byBoYW5kbGUgcmVzcG9uc2VzIGZyb20K\nICAgICAqICAgICAgICAgICAgdW5kZXJseWluZyBjaGFubmVsLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgQ2hhbm5lbEZ1dHVyZSBjb25uZWN0KEluZXRTb2Nr\nZXRBZGRyZXNzIHNlcnZlckhvc3QsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIENsaWVudENoYW5uZWxQaXBlbGluZUZhY3RvcnkgcGlw\nZWxpbmVGYWN0b3J5KSB7CiAgICAgICAgbG9nZ2VyLmRlYnVnKCJDb25uZWN0\naW5nIHRvIGhvc3Qge30gLi4uIiwgc2VydmVySG9zdCk7CiAgICAgICAgLy8g\nU2V0IHVwIHRoZSBDbGllbnRCb290U3RyYXAgc28gd2UgY2FuIGNyZWF0ZSBh\nIG5ldyBDaGFubmVsIGNvbm5lY3Rpb24KICAgICAgICAvLyB0byB0aGUgc2Vy\ndmVyLgogICAgICAgIENsaWVudEJvb3RzdHJhcCBib290c3RyYXAgPSBuZXcg\nQ2xpZW50Qm9vdHN0cmFwKGNoYW5uZWxNYW5hZ2VyLmdldENoYW5uZWxGYWN0\nb3J5KCkpOwogICAgICAgIGJvb3RzdHJhcC5zZXRQaXBlbGluZUZhY3Rvcnko\ncGlwZWxpbmVGYWN0b3J5KTsKICAgICAgICBib290c3RyYXAuc2V0T3B0aW9u\nKCJ0Y3BOb0RlbGF5IiwgdHJ1ZSk7CiAgICAgICAgYm9vdHN0cmFwLnNldE9w\ndGlvbigia2VlcEFsaXZlIiwgdHJ1ZSk7CgogICAgICAgIC8vIFN0YXJ0IHRo\nZSBjb25uZWN0aW9uIGF0dGVtcHQgdG8gdGhlIGlucHV0IHNlcnZlciBob3N0\nLgogICAgICAgIHJldHVybiBib290c3RyYXAuY29ubmVjdChzZXJ2ZXJIb3N0\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGNsb3Nl\nKGJvb2xlYW4gd2FpdCkgewogICAgICAgIHN5bmNocm9uaXplZCAodGhpcykg\newogICAgICAgICAgICBpZiAoY2xvc2VkKSB7CiAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xvc2VkID0gdHJ1\nZTsKICAgICAgICB9CiAgICAgICAgaWYgKG51bGwgPT0gY2hhbm5lbCkgewog\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGdldEhDaGFubmVsSGFuZGxlckZyb21DaGFubmVsKGNoYW5u\nZWwpLmNsb3NlRXhwbGljaXRseSgpOwogICAgICAgIH0gY2F0Y2ggKE5vUmVz\ncG9uc2VIYW5kbGVyRXhjZXB0aW9uIG5yaGUpIHsKICAgICAgICAgICAgbG9n\nZ2VyLndhcm4oIk5vIGNoYW5uZWwgaGFuZGxlciBmb3VuZCBmb3IgY2hhbm5l\nbCB7fSB3aGVuIGNsb3NpbmcgaXQuIiwKICAgICAgICAgICAgICAgICAgICAg\nICAgY2hhbm5lbCk7CiAgICAgICAgfQogICAgICAgIGlmICh3YWl0KSB7CiAg\nICAgICAgICAgIGNoYW5uZWwuY2xvc2UoKS5hd2FpdFVuaW50ZXJydXB0aWJs\neSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNoYW5uZWwuY2xv\nc2UoKTsKICAgICAgICB9CiAgICAgICAgY2hhbm5lbCA9IG51bGw7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkg\newogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRl\ncigpOwogICAgICAgIHNiLmFwcGVuZCgiW0hDaGFubmVsOiBob3N0IC0gIiku\nYXBwZW5kKGhvc3QpCiAgICAgICAgICAuYXBwZW5kKCIsIGNoYW5uZWwgLSAi\nKS5hcHBlbmQoY2hhbm5lbCkKICAgICAgICAgIC5hcHBlbmQoIiwgcGVuZGlu\nZyByZXFzIC0gIikuYXBwZW5kKHBlbmRpbmdPcHMuc2l6ZSgpKQogICAgICAg\nICAgLmFwcGVuZCgiLCBjbG9zZWQgLSAiKS5hcHBlbmQoY2xvc2VkKS5hcHBl\nbmQoIl0iKTsKICAgICAgICByZXR1cm4gc2IudG9TdHJpbmcoKTsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAg\nICAgIGNsb3NlKGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBl\nciBzdGF0aWMgbWV0aG9kIHRvIGdldCB0aGUgUmVzcG9uc2VIYW5kbGVyIGlu\nc3RhbmNlIGZyb20gYSBDaGFubmVsCiAgICAgKiB2aWEgdGhlIENoYW5uZWxQ\naXBlbGluZSBpdCBpcyBhc3NvY2lhdGVkIHdpdGguIFRoZSBhc3N1bXB0aW9u\nIGlzIHRoYXQgdGhlCiAgICAgKiBsYXN0IENoYW5uZWxIYW5kbGVyIHRpZWQg\ndG8gdGhlIENoYW5uZWxQaXBlbGluZSBpcyB0aGUgUmVzcG9uc2VIYW5kbGVy\nLgogICAgICoKICAgICAqIEBwYXJhbSBjaGFubmVsCiAgICAgKiAgICAgICAg\nICAgIENoYW5uZWwgd2UgYXJlIHJldHJpZXZpbmcgdGhlIFJlc3BvbnNlSGFu\nZGxlciBpbnN0YW5jZSBmb3IKICAgICAqIEByZXR1cm4gUmVzcG9uc2VIYW5k\nbGVyIEluc3RhbmNlIHRpZWQgdG8gdGhlIENoYW5uZWwncyBQaXBlbGluZQog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIEhDaGFubmVsSGFuZGxlciBnZXRI\nQ2hhbm5lbEhhbmRsZXJGcm9tQ2hhbm5lbChDaGFubmVsIGNoYW5uZWwpCiAg\nICB0aHJvd3MgTm9SZXNwb25zZUhhbmRsZXJFeGNlcHRpb24gewogICAgICAg\nIGlmIChudWxsID09IGNoYW5uZWwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3\nIE5vUmVzcG9uc2VIYW5kbGVyRXhjZXB0aW9uKCJSZWNlaXZlZCBhIG51bGwg\ndmFsdWUgZm9yIHRoZSBjaGFubmVsLiBDYW5ub3QgcmV0cmlldmUgdGhlIHJl\nc3BvbnNlIGhhbmRsZXIiKTsKICAgICAgICB9CgogICAgICAgIEhDaGFubmVs\nSGFuZGxlciBoYW5kbGVyID0gKEhDaGFubmVsSGFuZGxlcikgY2hhbm5lbC5n\nZXRQaXBlbGluZSgpLmdldExhc3QoKTsKICAgICAgICBpZiAobnVsbCA9PSBo\nYW5kbGVyKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBOb1Jlc3BvbnNlSGFu\nZGxlckV4Y2VwdGlvbigiQ291bGQgbm90IHJldHJpZXZlIHRoZSByZXNwb25z\nZSBoYW5kbGVyIGZyb20gdGhlIGNoYW5uZWwncyBwaXBlbGluZS4iKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGhhbmRsZXI7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

