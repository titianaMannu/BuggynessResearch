{"sha":"f28a6b27fd21ccf9fb12fd665761c4be2ee02138","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjI4YTZiMjdmZDIxY2NmOWZiMTJmZDY2NTc2MWM0YmUyZWUwMjEzOA==","size":14285,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f28a6b27fd21ccf9fb12fd665761c4be2ee02138","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHkuaW1wbC5tdWx0\naXBsZXg7CgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRNYXA7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hh\nbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxG\nYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5l\nbEZ1dHVyZTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5u\nZWxGdXR1cmVMaXN0ZW5lcjsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5j\nbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5kYXRhLlB1YlN1YkRhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZGF0YS5Ub3BpY1N1YnNj\ncmliZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZXhjZXB0\naW9ucy5BbHJlYWR5U3RhcnREZWxpdmVyeUV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5leGNlcHRpb25zLk5vUmVzcG9uc2VI\nYW5kbGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xp\nZW50LmhhbmRsZXJzLlN1YnNjcmliZVJlc3BvbnNlSGFuZGxlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5DbGVhbnVwQ2hhbm5l\nbE1hcDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5I\nQ2hhbm5lbDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0\neS5OZXRVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5u\nZXR0eS5pbXBsLkFic3RyYWN0SENoYW5uZWxNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuY2xpZW50Lm5ldHR5LmltcGwuQ2xpZW50Q2hhbm5l\nbFBpcGVsaW5lRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNs\naWVudC5uZXR0eS5pbXBsLkhDaGFubmVsSGFuZGxlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5pbXBsLkhDaGFubmVsSW1wbDsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0aW9ucy5Q\ndWJTdWJFeGNlcHRpb24uQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhj\nZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlw\nZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLlJlc3BvbnNlQm9keTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnV0aWwuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGls\nLkVpdGhlcjsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLmhlZHdpZy51dGls\nLlZhckFyZ3MudmE7CgoKLyoqCiAqIE11bHRpcGxleCBIQ2hhbm5lbCBNYW5h\nZ2VyIHdoaWNoIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gZm9yIG11bHRpIHN1\nYnNjcmlwdGlvbnMuCiAqLwpwdWJsaWMgY2xhc3MgTXVsdGlwbGV4SENoYW5u\nZWxNYW5hZ2VyIGV4dGVuZHMgQWJzdHJhY3RIQ2hhbm5lbE1hbmFnZXIgewoK\nICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9y\neS5nZXRMb2dnZXIoTXVsdGlwbGV4SENoYW5uZWxNYW5hZ2VyLmNsYXNzKTsK\nCiAgICAvLyBGaW5kIHdoaWNoIEhDaGFubmVsIHRoYXQgYSBnaXZlbiBUb3Bp\nY1N1YnNjcmliZXIgdXNlZC4KICAgIHByb3RlY3RlZCBmaW5hbCBDbGVhbnVw\nQ2hhbm5lbE1hcDxJbmV0U29ja2V0QWRkcmVzcz4gc3Vic2NyaXB0aW9uQ2hh\nbm5lbHM7CgogICAgLy8gQSBpbmRleCBtYXAgZm9yIGVhY2ggdG9waWMgc3Vi\nc2NyaWJlciBpcyBzZXJ2ZWQgYnkgd2hpY2ggc3Vic2NyaXB0aW9uIGNoYW5u\nZWwKICAgIHByb3RlY3RlZCBmaW5hbCBDbGVhbnVwQ2hhbm5lbE1hcDxUb3Bp\nY1N1YnNjcmliZXI+IHN1YjJDaGFubmVsczsKCiAgICAvLyBDb25jdXJyZW50\nIE1hcCB0byBzdG9yZSBNZXNzYWdlIGhhbmRsZXIgZm9yIGVhY2ggdG9waWMg\nKyBzdWIgaWQgY29tYmluYXRpb24uCiAgICAvLyBTdG9yZSBpdCBoZXJlIGlu\nc3RlYWQgb2YgaW4gU3Vic2NyaWJlclJlc3BvbnNlSGFuZGxlciBhcyB3ZSBk\nb24ndCB3YW50IHRvIGxvc2UgdGhlIGhhbmRsZXIKICAgIC8vIHVzZXIgc2V0\nIHdoZW4gY29ubmVjdGlvbiBpcyByZWNvdmVyZWQKICAgIHByb3RlY3RlZCBm\naW5hbCBDb25jdXJyZW50TWFwPFRvcGljU3Vic2NyaWJlciwgTWVzc2FnZUhh\nbmRsZXI+IHRvcGljU3Vic2NyaWJlcjJNZXNzYWdlSGFuZGxlcgogICAgICAg\nID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPFRvcGljU3Vic2NyaWJlciwgTWVz\nc2FnZUhhbmRsZXI+KCk7CgogICAgLy8gUGlwZWxpbmVGYWN0b3J5IHRvIGNy\nZWF0ZSBzdWJzY3JpcHRpb24gbmV0dHkgY2hhbm5lbHMgdG8gdGhlIGFwcHJv\ncHJpYXRlIHNlcnZlcgogICAgcHJpdmF0ZSBmaW5hbCBDbGllbnRDaGFubmVs\nUGlwZWxpbmVGYWN0b3J5IHN1YnNjcmlwdGlvbkNoYW5uZWxQaXBlbGluZUZh\nY3Rvcnk7CgogICAgcHVibGljIE11bHRpcGxleEhDaGFubmVsTWFuYWdlcihD\nbGllbnRDb25maWd1cmF0aW9uIGNmZywKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgQ2hhbm5lbEZhY3Rvcnkgc29ja2V0RmFjdG9yeSkg\newogICAgICAgIHN1cGVyKGNmZywgc29ja2V0RmFjdG9yeSk7CiAgICAgICAg\nc3Vic2NyaXB0aW9uQ2hhbm5lbHMgPSBuZXcgQ2xlYW51cENoYW5uZWxNYXA8\nSW5ldFNvY2tldEFkZHJlc3M+KCk7CiAgICAgICAgc3ViMkNoYW5uZWxzID0g\nbmV3IENsZWFudXBDaGFubmVsTWFwPFRvcGljU3Vic2NyaWJlcj4oKTsKICAg\nICAgICBzdWJzY3JpcHRpb25DaGFubmVsUGlwZWxpbmVGYWN0b3J5ID0KICAg\nICAgICAgICAgbmV3IE11bHRpcGxleFN1YnNjcmlwdGlvbkNoYW5uZWxQaXBl\nbGluZUZhY3RvcnkoY2ZnLCB0aGlzKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCBDbGllbnRDaGFubmVsUGlwZWxpbmVGYWN0b3J5IGdl\ndFN1YnNjcmlwdGlvbkNoYW5uZWxQaXBlbGluZUZhY3RvcnkoKSB7CiAgICAg\nICAgcmV0dXJuIHN1YnNjcmlwdGlvbkNoYW5uZWxQaXBlbGluZUZhY3Rvcnk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgSENoYW5uZWwg\nY3JlYXRlQW5kU3RvcmVTdWJzY3JpcHRpb25DaGFubmVsKENoYW5uZWwgY2hh\nbm5lbCkgewogICAgICAgIC8vIHN0b3JlIHRoZSBjaGFubmVsIGNvbm5lY3Rl\nZCB0byB0YXJnZXQgaG9zdCBmb3IgZnV0dXJlIHVzYWdlCiAgICAgICAgSW5l\ndFNvY2tldEFkZHJlc3MgaG9zdCA9IE5ldFV0aWxzLmdldEhvc3RGcm9tQ2hh\nbm5lbChjaGFubmVsKTsKICAgICAgICBIQ2hhbm5lbCBuZXdIQ2hhbm5lbCA9\nIG5ldyBIQ2hhbm5lbEltcGwoaG9zdCwgY2hhbm5lbCwgdGhpcywKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0\nU3Vic2NyaXB0aW9uQ2hhbm5lbFBpcGVsaW5lRmFjdG9yeSgpKTsKICAgICAg\nICByZXR1cm4gc3RvcmVTdWJzY3JpcHRpb25DaGFubmVsKGhvc3QsIG5ld0hD\naGFubmVsKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBI\nQ2hhbm5lbCBjcmVhdGVBbmRTdG9yZVN1YnNjcmlwdGlvbkNoYW5uZWwoSW5l\ndFNvY2tldEFkZHJlc3MgaG9zdCkgewogICAgICAgIEhDaGFubmVsIG5ld0hD\naGFubmVsID0gbmV3IEhDaGFubmVsSW1wbChob3N0LCB0aGlzLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRT\ndWJzY3JpcHRpb25DaGFubmVsUGlwZWxpbmVGYWN0b3J5KCkpOwogICAgICAg\nIHJldHVybiBzdG9yZVN1YnNjcmlwdGlvbkNoYW5uZWwoaG9zdCwgbmV3SENo\nYW5uZWwpOwogICAgfQoKICAgIHByaXZhdGUgSENoYW5uZWwgc3RvcmVTdWJz\nY3JpcHRpb25DaGFubmVsKEluZXRTb2NrZXRBZGRyZXNzIGhvc3QsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIQ2hh\nbm5lbCBuZXdIQ2hhbm5lbCkgewogICAgICAgIC8vIGhlcmUsIHdlIGd1YXJh\nbnRlZSB0aGVyZSBpcyBvbmx5IG9uZSBjaGFubmVsIHVzZWQgdG8gY29tbXVu\naWNhdGUgd2l0aCB0YXJnZXQKICAgICAgICAvLyBob3N0LgogICAgICAgIHJl\ndHVybiBzdWJzY3JpcHRpb25DaGFubmVscy5hZGRDaGFubmVsKGhvc3QsIG5l\nd0hDaGFubmVsKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCBIQ2hhbm5lbCBnZXRTdWJzY3JpcHRpb25DaGFubmVsKEluZXRTb2NrZXRB\nZGRyZXNzIGhvc3QpIHsKICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uQ2hh\nbm5lbHMuZ2V0Q2hhbm5lbChob3N0KTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nSENoYW5uZWwgZ2V0U3Vic2NyaXB0aW9uQ2hhbm5lbChUb3BpY1N1YnNjcmli\nZXIgc3Vic2NyaWJlcikgewogICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGhv\nc3QgPSB0b3BpYzJIb3N0LmdldChzdWJzY3JpYmVyLmdldFRvcGljKCkpOwog\nICAgICAgIGlmIChudWxsID09IGhvc3QpIHsKICAgICAgICAgICAgLy8gd2Ug\nZG9uJ3Qga25vdyB3aGVyZSBpcyB0aGUgb3duZXIgb2YgdGhlIHRvcGljCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIHJldHVybiBnZXRTdWJzY3JpcHRpb25DaGFubmVsKGhvc3QpOwog\nICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBI\nQ2hhbm5lbCBnZXRTdWJzY3JpcHRpb25DaGFubmVsQnlUb3BpY1N1YnNjcmli\nZXIoVG9waWNTdWJzY3JpYmVyIHN1YnNjcmliZXIpIHsKICAgICAgICBJbmV0\nU29ja2V0QWRkcmVzcyBob3N0ID0gdG9waWMySG9zdC5nZXQoc3Vic2NyaWJl\nci5nZXRUb3BpYygpKTsKICAgICAgICBpZiAobnVsbCA9PSBob3N0KSB7CiAg\nICAgICAgICAgIC8vIHdlIGRvbid0IGtub3cgd2hlcmUgaXMgdGhlIHRvcGlj\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgIC8vIHdlIGhhZCBrbm93IHdoaWNoIHNlcnZlciBvd25lZCB0\naGUgdG9waWMKICAgICAgICAgICAgSENoYW5uZWwgY2hhbm5lbCA9IGdldFN1\nYnNjcmlwdGlvbkNoYW5uZWwoaG9zdCk7CiAgICAgICAgICAgIGlmIChudWxs\nID09IGNoYW5uZWwpIHsKICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhIGNo\nYW5uZWwgdG8gY29ubmVjdCB0byBzZXBjaWZpZWQgaG9zdAogICAgICAgICAg\nICAgICAgY2hhbm5lbCA9IGNyZWF0ZUFuZFN0b3JlU3Vic2NyaXB0aW9uQ2hh\nbm5lbChob3N0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4g\nY2hhbm5lbDsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgdm9pZCBvblN1YnNjcmlwdGlvbkNoYW5uZWxEaXNjb25uZWN0\nZWQoSW5ldFNvY2tldEFkZHJlc3MgaG9zdCwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDaGFubmVsIGNo\nYW5uZWwpIHsKICAgICAgICBIQ2hhbm5lbCBoQ2hhbm5lbCA9IHN1YnNjcmlw\ndGlvbkNoYW5uZWxzLmdldENoYW5uZWwoaG9zdCk7CiAgICAgICAgaWYgKG51\nbGwgPT0gaENoYW5uZWwpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KICAgICAgICBDaGFubmVsIHVuZGVybHlpbmdDaGFubmVsID0gaENoYW5u\nZWwuZ2V0Q2hhbm5lbCgpOwogICAgICAgIGlmIChudWxsID09IHVuZGVybHlp\nbmdDaGFubmVsIHx8CiAgICAgICAgICAgICF1bmRlcmx5aW5nQ2hhbm5lbC5l\ncXVhbHMoY2hhbm5lbCkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KICAgICAgICBsb2dnZXIuaW5mbygiU3Vic2NyaXB0aW9uIENoYW5uZWwg\ne30gZGlzY29ubmVjdGVkIGZyb20ge30uIiwKICAgICAgICAgICAgICAgICAg\nICB2YShjaGFubmVsLCBob3N0KSk7CiAgICAgICAgLy8gcmVtb3ZlIGV4aXN0\nZWQgY2hhbm5lbAogICAgICAgIGlmIChzdWJzY3JpcHRpb25DaGFubmVscy5y\nZW1vdmVDaGFubmVsKGhvc3QsIGhDaGFubmVsKSkgewogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgSENoYW5uZWxIYW5kbGVyIGNoYW5uZWxI\nYW5kbGVyID0KICAgICAgICAgICAgICAgICAgICBIQ2hhbm5lbEltcGwuZ2V0\nSENoYW5uZWxIYW5kbGVyRnJvbUNoYW5uZWwoY2hhbm5lbCk7CiAgICAgICAg\nICAgICAgICBjaGFubmVsSGFuZGxlci5nZXRTdWJzY3JpYmVSZXNwb25zZUhh\nbmRsZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25DaGFu\nbmVsRGlzY29ubmVjdGVkKGhvc3QsIGNoYW5uZWwpOwogICAgICAgICAgICB9\nIGNhdGNoIChOb1Jlc3BvbnNlSGFuZGxlckV4Y2VwdGlvbiBucmhlKSB7CiAg\nICAgICAgICAgICAgICBsb2dnZXIud2FybigiTm8gQ2hhbm5lbCBIYW5kbGVy\nIGZvdW5kIGZvciBjaGFubmVsIHt9IHdoZW4gaXQgZGlzY29ubmVjdGVkLiIs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBTdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIgZ2V0U3Vic2NyaWJlUmVz\ncG9uc2VIYW5kbGVyKFRvcGljU3Vic2NyaWJlciB0b3BpY1N1YnNjcmliZXIp\nIHsKICAgICAgICBIQ2hhbm5lbCBoQ2hhbm5lbCA9IGdldFN1YnNjcmlwdGlv\nbkNoYW5uZWwodG9waWNTdWJzY3JpYmVyKTsKICAgICAgICBpZiAobnVsbCA9\nPSBoQ2hhbm5lbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICB9CiAgICAgICAgQ2hhbm5lbCBjaGFubmVsID0gaENoYW5uZWwuZ2V0Q2hh\nbm5lbCgpOwogICAgICAgIGlmIChudWxsID09IGNoYW5uZWwpIHsKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIEhDaGFubmVsSGFuZGxlciBjaGFubmVsSGFuZGxlciA9CiAg\nICAgICAgICAgICAgICBIQ2hhbm5lbEltcGwuZ2V0SENoYW5uZWxIYW5kbGVy\nRnJvbUNoYW5uZWwoY2hhbm5lbCk7CiAgICAgICAgICAgIHJldHVybiBjaGFu\nbmVsSGFuZGxlci5nZXRTdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIoKTsKICAg\nICAgICB9IGNhdGNoIChOb1Jlc3BvbnNlSGFuZGxlckV4Y2VwdGlvbiBucmhl\nKSB7CiAgICAgICAgICAgIGxvZ2dlci53YXJuKCJObyBDaGFubmVsIEhhbmRs\nZXIgZm91bmQgZm9yIGNoYW5uZWwge30sIHRvcGljIHN1YnNjcmliZXIge30u\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCwgdG9waWNTdWJz\nY3JpYmVyKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc3RhcnREZWxp\ndmVyeShUb3BpY1N1YnNjcmliZXIgdG9waWNTdWJzY3JpYmVyLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlSGFuZGxlciBtZXNzYWdl\nSGFuZGxlcikKICAgICAgICB0aHJvd3MgQ2xpZW50Tm90U3Vic2NyaWJlZEV4\nY2VwdGlvbiwgQWxyZWFkeVN0YXJ0RGVsaXZlcnlFeGNlcHRpb24gewogICAg\nICAgIHN0YXJ0RGVsaXZlcnkodG9waWNTdWJzY3JpYmVyLCBtZXNzYWdlSGFu\nZGxlciwgZmFsc2UpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIHZvaWQgcmVzdGFydERlbGl2ZXJ5KFRvcGljU3Vic2NyaWJlciB0b3Bp\nY1N1YnNjcmliZXIpCiAgICAgICAgdGhyb3dzIENsaWVudE5vdFN1YnNjcmli\nZWRFeGNlcHRpb24sIEFscmVhZHlTdGFydERlbGl2ZXJ5RXhjZXB0aW9uIHsK\nICAgICAgICBzdGFydERlbGl2ZXJ5KHRvcGljU3Vic2NyaWJlciwgbnVsbCwg\ndHJ1ZSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHN0YXJ0RGVsaXZlcnko\nVG9waWNTdWJzY3JpYmVyIHRvcGljU3Vic2NyaWJlciwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VIYW5kbGVyIG1lc3NhZ2VIYW5k\nbGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiBy\nZXN0YXJ0KQogICAgICAgIHRocm93cyBDbGllbnROb3RTdWJzY3JpYmVkRXhj\nZXB0aW9uLCBBbHJlYWR5U3RhcnREZWxpdmVyeUV4Y2VwdGlvbiB7CiAgICAg\nICAgLy8gTWFrZSBzdXJlIHdlIGtub3cgYWJvdXQgdGhpcyB0b3BpYyBzdWJz\nY3JpcHRpb24gb24gdGhlIGNsaWVudCBzaWRlCiAgICAgICAgLy8gZXhpc3Rz\nLiBUaGUgYXNzdW1wdGlvbiBpcyB0aGF0IHRoZSBjbGllbnQgc2hvdWxkIGhh\ndmUgaW4gbWVtb3J5IHRoZQogICAgICAgIC8vIENoYW5uZWwgY3JlYXRlZCBm\nb3IgdGhlIFRvcGljU3Vic2NyaWJlciBvbmNlIHRoZSBzZXJ2ZXIgaGFzIHNl\nbnQKICAgICAgICAvLyBhbiBhY2sgcmVzcG9uc2UgdG8gdGhlIGluaXRpYWwg\nc3Vic2NyaWJlIHJlcXVlc3QuCiAgICAgICAgU3Vic2NyaWJlUmVzcG9uc2VI\nYW5kbGVyIHN1YnNjcmliZVJlc3BvbnNlSGFuZGxlciA9CiAgICAgICAgICAg\nIGdldFN1YnNjcmliZVJlc3BvbnNlSGFuZGxlcih0b3BpY1N1YnNjcmliZXIp\nOwogICAgICAgIGlmIChudWxsID09IHN1YnNjcmliZVJlc3BvbnNlSGFuZGxl\nciB8fAogICAgICAgICAgICAhc3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVyLmhh\nc1N1YnNjcmlwdGlvbih0b3BpY1N1YnNjcmliZXIpKSB7CiAgICAgICAgICAg\nIGxvZ2dlci5lcnJvcigiQ2xpZW50IGlzIG5vdCB5ZXQgc3Vic2NyaWJlZCB0\nbyB7fS4iLCB0b3BpY1N1YnNjcmliZXIpOwogICAgICAgICAgICB0aHJvdyBu\nZXcgQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbigiQ2xpZW50IGlzIG5v\ndCB5ZXQgc3Vic2NyaWJlZCB0byAiCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgdG9waWNTdWJzY3JpYmVy\nKTsKICAgICAgICB9CgogICAgICAgIE1lc3NhZ2VIYW5kbGVyIGV4aXN0ZWRN\nc2dIYW5kbGVyID0gdG9waWNTdWJzY3JpYmVyMk1lc3NhZ2VIYW5kbGVyLmdl\ndCh0b3BpY1N1YnNjcmliZXIpOwogICAgICAgIGlmIChyZXN0YXJ0KSB7CiAg\nICAgICAgICAgIC8vIHJlc3RhcnQgdXNpbmcgZXhpc3RpbmcgbXNnIGhhbmRs\nZXIgCiAgICAgICAgICAgIG1lc3NhZ2VIYW5kbGVyID0gZXhpc3RlZE1zZ0hh\nbmRsZXI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gc29tZSBo\nYXMgc3RhcnRlZCBkZWxpdmVyeSBidXQgbm90IHN0b3AgaXQKICAgICAgICAg\nICAgaWYgKG51bGwgIT0gZXhpc3RlZE1zZ0hhbmRsZXIpIHsKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBBbHJlYWR5U3RhcnREZWxpdmVyeUV4Y2VwdGlv\nbigiQSBtZXNzYWdlIGhhbmRsZXIgaGFzIGJlZW4gc3RhcnRlZCBmb3IgdG9w\naWMgc3Vic2NyaWJlciAiICsgdG9waWNTdWJzY3JpYmVyKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBpZiAobWVzc2FnZUhhbmRsZXIgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdG9waWNTdWJzY3JpYmVy\nMk1lc3NhZ2VIYW5kbGVyLnB1dElmQWJzZW50KHRvcGljU3Vic2NyaWJlciwg\nbWVzc2FnZUhhbmRsZXIpKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IEFscmVhZHlTdGFydERlbGl2ZXJ5RXhjZXB0aW9uKCJTb21lb25lIGlz\nIGFsc28gc3RhcnRpbmcgZGVsaXZlcnkgZm9yIHRvcGljIHN1YnNjcmliZXIg\nIiArIHRvcGljU3Vic2NyaWJlcik7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIHRlbGwgc3Vic2NyaWJl\nIHJlc3BvbnNlIGhhbmRsZXIgdG8gc3RhcnQgZGVsaXZlcmluZyBtZXNzYWdl\ncyBmb3IgdG9waWNTdWJzY3JpYmVyCiAgICAgICAgc3Vic2NyaWJlUmVzcG9u\nc2VIYW5kbGVyLnN0YXJ0RGVsaXZlcnkodG9waWNTdWJzY3JpYmVyLCBtZXNz\nYWdlSGFuZGxlcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgc3RvcERlbGl2\nZXJ5KFRvcGljU3Vic2NyaWJlciB0b3BpY1N1YnNjcmliZXIpCiAgICB0aHJv\nd3MgQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbiB7CiAgICAgICAgLy8g\nTWFrZSBzdXJlIHdlIGtub3cgdGhhdCB0aGlzIHRvcGljIHN1YnNjcmlwdGlv\nbiBvbiB0aGUgY2xpZW50IHNpZGUKICAgICAgICAvLyBleGlzdHMuIFRoZSBh\nc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGNsaWVudCBzaG91bGQgaGF2ZSBpbiBt\nZW1vcnkgdGhlCiAgICAgICAgLy8gQ2hhbm5lbCBjcmVhdGVkIGZvciB0aGUg\nVG9waWNTdWJzY3JpYmVyIG9uY2UgdGhlIHNlcnZlciBoYXMgc2VudAogICAg\nICAgIC8vIGFuIGFjayByZXNwb25zZSB0byB0aGUgaW5pdGlhbCBzdWJzY3Jp\nYmUgcmVxdWVzdC4KICAgICAgICBTdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIg\nc3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVyID0KICAgICAgICAgICAgZ2V0U3Vi\nc2NyaWJlUmVzcG9uc2VIYW5kbGVyKHRvcGljU3Vic2NyaWJlcik7CiAgICAg\nICAgaWYgKG51bGwgPT0gc3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVyIHx8CiAg\nICAgICAgICAgICFzdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIuaGFzU3Vic2Ny\naXB0aW9uKHRvcGljU3Vic2NyaWJlcikpIHsKICAgICAgICAgICAgbG9nZ2Vy\nLmVycm9yKCJDbGllbnQgaXMgbm90IHlldCBzdWJzY3JpYmVkIHRvIHt9LiIs\nIHRvcGljU3Vic2NyaWJlcik7CiAgICAgICAgICAgIHRocm93IG5ldyBDbGll\nbnROb3RTdWJzY3JpYmVkRXhjZXB0aW9uKCJDbGllbnQgaXMgbm90IHlldCBz\ndWJzY3JpYmVkIHRvICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyB0b3BpY1N1YnNjcmliZXIpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gdGVsbCBzdWJzY3JpYmUgcmVzcG9uc2UgaGFu\nZGxlciB0byBzdG9wIGRlbGl2ZXJpbmcgbWVzc2FnZXMgZm9yIGEgZ2l2ZW4g\ndG9waWMgc3Vic2NyaWJlcgogICAgICAgIHRvcGljU3Vic2NyaWJlcjJNZXNz\nYWdlSGFuZGxlci5yZW1vdmUodG9waWNTdWJzY3JpYmVyKTsKICAgICAgICBz\ndWJzY3JpYmVSZXNwb25zZUhhbmRsZXIuc3RvcERlbGl2ZXJ5KHRvcGljU3Vi\nc2NyaWJlcik7CiAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAK\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGFzeW5jQ2xvc2VTdWJz\nY3JpcHRpb24oZmluYWwgVG9waWNTdWJzY3JpYmVyIHRvcGljU3Vic2NyaWJl\nciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlu\nYWwgQ2FsbGJhY2s8UmVzcG9uc2VCb2R5PiBjYWxsYmFjaywKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgT2JqZWN0IGNv\nbnRleHQpIHsKICAgICAgICBTdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIgc3Vi\nc2NyaWJlUmVzcG9uc2VIYW5kbGVyID0KICAgICAgICAgICAgZ2V0U3Vic2Ny\naWJlUmVzcG9uc2VIYW5kbGVyKHRvcGljU3Vic2NyaWJlcik7CiAgICAgICAg\naWYgKG51bGwgPT0gc3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVyIHx8CiAgICAg\nICAgICAgICFzdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIuaGFzU3Vic2NyaXB0\naW9uKHRvcGljU3Vic2NyaWJlcikpIHsKICAgICAgICAgICAgbG9nZ2VyLndh\ncm4oIlRyeWluZyB0byBjbG9zZSBhIHN1YnNjcmlwdGlvbiB3aGVuIHdlIGRv\nbid0IGhhdmUgYSBzdWJzY3JpcHRpb24gY2hhbm5lbCBjYWNoZWQgZm9yIHt9\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgdG9waWNTdWJzY3JpYmVyKTsK\nICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY29udGV4\ndCwgKFJlc3BvbnNlQm9keSludWxsKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KICAgICAgICBzdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIuYXN5\nbmNDbG9zZVN1YnNjcmlwdGlvbih0b3BpY1N1YnNjcmliZXIsIGNhbGxiYWNr\nLCBjb250ZXh0KTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCB2b2lkIGNoZWNrVGltZW91dFJlcXVlc3RzT25TdWJzY3JpcHRpb25DaGFu\nbmVscygpIHsKICAgICAgICAvLyB0aW1lb3V0IHRhc2sgbWF5IGJlIHN0YXJ0\nZWQgYmVmb3JlIGNvbnN0cnVjdGluZyBzdWJzY3JpcHRpb25DaGFubmVscwog\nICAgICAgIGlmIChudWxsID09IHN1YnNjcmlwdGlvbkNoYW5uZWxzKSB7CiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZm9yIChIQ2hh\nbm5lbCBjaGFubmVsIDogc3Vic2NyaXB0aW9uQ2hhbm5lbHMuZ2V0Q2hhbm5l\nbHMoKSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgSENo\nYW5uZWxIYW5kbGVyIGNoYW5uZWxIYW5kbGVyID0KICAgICAgICAgICAgICAg\nICAgICBIQ2hhbm5lbEltcGwuZ2V0SENoYW5uZWxIYW5kbGVyRnJvbUNoYW5u\nZWwoY2hhbm5lbC5nZXRDaGFubmVsKCkpOwogICAgICAgICAgICAgICAgY2hh\nbm5lbEhhbmRsZXIuY2hlY2tUaW1lb3V0UmVxdWVzdHMoKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoTm9SZXNwb25zZUhhbmRsZXJFeGNlcHRpb24gbnJoZSkg\newogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9p\nZCBjbG9zZVN1YnNjcmlwdGlvbkNoYW5uZWxzKCkgewogICAgICAgIHN1YnNj\ncmlwdGlvbkNoYW5uZWxzLmNsb3NlKCk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIEVpdGhlcjxCb29sZWFuLCBIQ2hhbm5lbD4gc3RvcmVTdWJzY3JpcHRpb25D\naGFubmVsKAogICAgICAgIFRvcGljU3Vic2NyaWJlciB0b3BpY1N1YnNjcmli\nZXIsIFB1YlN1YkRhdGEgdHhuLCBIQ2hhbm5lbCBjaGFubmVsKSB7CiAgICAg\nICAgYm9vbGVhbiByZXBsYWNlZCA9IHN1YjJDaGFubmVscy5yZXBsYWNlQ2hh\nbm5lbCgKICAgICAgICAgICAgdG9waWNTdWJzY3JpYmVyLCB0eG4uZ2V0T3Jp\nZ2luYWxDaGFubmVsRm9yUmVzdWJzY3JpYmUoKSwgY2hhbm5lbCk7CiAgICAg\nICAgaWYgKHJlcGxhY2VkKSB7CiAgICAgICAgICAgIHJldHVybiBFaXRoZXIu\nb2YocmVwbGFjZWQsIGNoYW5uZWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIHJldHVybiBFaXRoZXIub2YocmVwbGFjZWQsIG51bGwpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiByZW1vdmVTdWJz\nY3JpcHRpb25DaGFubmVsKAogICAgICAgIFRvcGljU3Vic2NyaWJlciB0b3Bp\nY1N1YnNjcmliZXIsIEhDaGFubmVsIGNoYW5uZWwpIHsKICAgICAgICByZXR1\ncm4gc3ViMkNoYW5uZWxzLnJlbW92ZUNoYW5uZWwodG9waWNTdWJzY3JpYmVy\nLCBjaGFubmVsKTsKICAgIH0KfQo=\n","encoding":"base64"}

