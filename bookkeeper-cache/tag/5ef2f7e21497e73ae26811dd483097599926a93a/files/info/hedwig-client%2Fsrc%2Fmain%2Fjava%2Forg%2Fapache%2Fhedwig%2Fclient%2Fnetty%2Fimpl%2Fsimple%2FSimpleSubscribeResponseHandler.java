{"sha":"7dd320ced43b6e28e54ca1ccd7d2d247cf04affe","node_id":"MDQ6QmxvYjE1NzU5NTY6N2RkMzIwY2VkNDNiNmUyOGU1NGNhMWNjZDdkMmQyNDdjZjA0YWZmZQ==","size":12534,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/7dd320ced43b6e28e54ca1ccd7d2d247cf04affe","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHkuaW1wbC5zaW1w\nbGU7CgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9y\ndCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25z\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hN\nYXA7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0\nai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5u\nZWwuQ2hhbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNo\nYW5uZWxGdXR1cmU7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5D\naGFubmVsRnV0dXJlTGlzdGVuZXI7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90\nb2J1Zi5CeXRlU3RyaW5nOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNs\naWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEuUHViU3ViRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5kYXRhLlRvcGljU3Vic2Ny\naWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5leGNlcHRp\nb25zLkFscmVhZHlTdGFydERlbGl2ZXJ5RXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuY2xpZW50LmhhbmRsZXJzLlN1YnNjcmliZVJlc3Bv\nbnNlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5u\nZXR0eS5IQ2hhbm5lbDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVu\ndC5uZXR0eS5IQ2hhbm5lbE1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQubmV0dHkuaW1wbC5BYnN0cmFjdEhDaGFubmVsTWFuYWdl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5pbXBs\nLkFic3RyYWN0U3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuY2xpZW50Lm5ldHR5LmltcGwuQWN0aXZlU3Vic2Ny\naWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0eS5p\nbXBsLkhDaGFubmVsSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4\nY2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb24uQ2xpZW50Tm90U3Vi\nc2NyaWJlZEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5QdWJTdWJSZXNw\nb25zZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLlJlc3BvbnNlQm9keTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbkV2ZW50\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJv\ndG9jb2wuU3Vic2NyaXB0aW9uUHJlZmVyZW5jZXM7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdGF0dXNDb2Rl\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25zLk1l\nc3NhZ2VJZFV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5D\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuRWl0aGVy\nOwoKcHVibGljIGNsYXNzIFNpbXBsZVN1YnNjcmliZVJlc3BvbnNlSGFuZGxl\nciBleHRlbmRzIEFic3RyYWN0U3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVyIHsK\nCiAgICBwcml2YXRlIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoU2ltcGxlU3Vic2NyaWJlUmVzcG9uc2VIYW5kbGVy\nLmNsYXNzKTsKCiAgICAvKioKICAgICAqIFNpbXBsZSBBY3RpdmUgU3Vic2Ny\naWJlciBlbmFibGluZyBjbGllbnQtc2lkZSB0aHJvdHRsaW5nLgogICAgICov\nCiAgICBzdGF0aWMgY2xhc3MgU2ltcGxlQWN0aXZlU3Vic2NyaWJlciBleHRl\nbmRzIEFjdGl2ZVN1YnNjcmliZXIgewoKICAgICAgICAvLyBTZXQgdG8gc3Rv\ncmUgYWxsIG9mIHRoZSBvdXRzdGFuZGluZyBzdWJzY3JpYmVkIG1lc3NhZ2Vz\nIHRoYXQgYXJlIHBlbmRpbmcKICAgICAgICAvLyB0byBiZSBjb25zdW1lZCBi\neSB0aGUgY2xpZW50IGFwcCdzIE1lc3NhZ2VIYW5kbGVyLiBJZiB0aGlzIGV2\nZXIgZ3Jvd3MgdG9vCiAgICAgICAgLy8gYmlnIChlLmcuIHByb2JsZW0gYXQg\ndGhlIGNsaWVudCBlbmQgZm9yIG1lc3NhZ2UgY29uc3VtcHRpb24pLCB3ZSBj\nYW4KICAgICAgICAvLyB0aHJvdHRsZSB0aGluZ3MgYnkgdGVtcG9yYXJpbHkg\nc2V0dGluZyB0aGUgU3Vic2NyaWJlIE5ldHR5IENoYW5uZWwKICAgICAgICAv\nLyB0byBub3QgYmUgcmVhZGFibGUuIFdoZW4gdGhlIFNldCBoYXMgc2hydW5r\nIHN1ZmZpY2llbnRseSwgd2UgY2FuIHR1cm4gdGhlCiAgICAgICAgLy8gY2hh\nbm5lbCBiYWNrIG9uIHRvIHJlYWQgbmV3IG1lc3NhZ2VzLgogICAgICAgIHBy\naXZhdGUgZmluYWwgU2V0PE1lc3NhZ2U+IG91dHN0YW5kaW5nTXNnU2V0OwoK\nICAgICAgICBwdWJsaWMgU2ltcGxlQWN0aXZlU3Vic2NyaWJlcihDbGllbnRD\nb25maWd1cmF0aW9uIGNmZywKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBBYnN0cmFjdEhDaGFubmVsTWFuYWdlciBjaGFubmVsTWFu\nYWdlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBU\nb3BpY1N1YnNjcmliZXIgdHMsIFB1YlN1YkRhdGEgb3AsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Vic2NyaXB0aW9uUHJlZmVy\nZW5jZXMgcHJlZmVyZW5jZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgQ2hhbm5lbCBjaGFubmVsLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIEhDaGFubmVsIGhDaGFubmVsKSB7CiAg\nICAgICAgICAgIHN1cGVyKGNmZywgY2hhbm5lbE1hbmFnZXIsIHRzLCBvcCwg\ncHJlZmVyZW5jZXMsIGNoYW5uZWwsIGhDaGFubmVsKTsKICAgICAgICAgICAg\nb3V0c3RhbmRpbmdNc2dTZXQgPSBDb2xsZWN0aW9ucy5uZXdTZXRGcm9tTWFw\nKAogICAgICAgICAgICAgICAgICAgIG5ldyBDb25jdXJyZW50SGFzaE1hcDxN\nZXNzYWdlLCBCb29sZWFuPigKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGNmZy5nZXRNYXhpbXVtT3V0c3RhbmRpbmdNZXNzYWdlcygpLCAxLjBmKSk7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0\nZWQgdm9pZCB1bnNhZmVEZWxpdmVyTWVzc2FnZShNZXNzYWdlIG1lc3NhZ2Up\nIHsKICAgICAgICAgICAgLy8gQWRkIHRoaXMgInBlbmRpbmcgdG8gYmUgY29u\nc3VtZWQiIG1lc3NhZ2UgdG8gdGhlIG91dHN0YW5kaW5nTXNnU2V0LgogICAg\nICAgICAgICBvdXRzdGFuZGluZ01zZ1NldC5hZGQobWVzc2FnZSk7CiAgICAg\nICAgICAgIC8vIENoZWNrIGlmIHdlJ3ZlIGV4Y2VlZGVkIHRoZSBtYXggc2l6\nZSBmb3IgdGhlIG91dHN0YW5kaW5nIG1lc3NhZ2Ugc2V0LgogICAgICAgICAg\nICBpZiAob3V0c3RhbmRpbmdNc2dTZXQuc2l6ZSgpID49IGNmZy5nZXRNYXhp\nbXVtT3V0c3RhbmRpbmdNZXNzYWdlcygpICYmCiAgICAgICAgICAgICAgICBj\naGFubmVsLmlzUmVhZGFibGUoKSkgewogICAgICAgICAgICAgICAgLy8gVG9v\nIG1hbnkgb3V0c3RhbmRpbmcgbWVzc2FnZXMgc28gdGhyb3R0bGUgaXQgYnkg\nc2V0dGluZyB0aGUgTmV0dHkKICAgICAgICAgICAgICAgIC8vIENoYW5uZWwg\ndG8gbm90IGJlIHJlYWRhYmxlLgogICAgICAgICAgICAgICAgaWYgKGxvZ2dl\nci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgbG9n\nZ2VyLmRlYnVnKCJUb28gbWFueSBvdXRzdGFuZGluZyBtZXNzYWdlcyAoe30p\nIHNvIHRocm90dGxpbmcgdGhlIHN1YnNjcmliZSBuZXR0eSBDaGFubmVsIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0c3RhbmRpbmdN\nc2dTZXQuc2l6ZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIGNoYW5uZWwuc2V0UmVhZGFibGUoZmFsc2UpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIHN1cGVyLnVuc2FmZURlbGl2ZXJNZXNzYWdlKG1lc3Nh\nZ2UpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIHN5bmNocm9uaXplZCB2b2lkIG1lc3NhZ2VDb25zdW1lZChNZXNzYWdl\nIG1lc3NhZ2UpIHsKICAgICAgICAgICAgc3VwZXIubWVzc2FnZUNvbnN1bWVk\nKG1lc3NhZ2UpOwogICAgICAgICAgICAvLyBSZW1vdmUgdGhpcyBjb25zdW1l\nZCBtZXNzYWdlIGZyb20gdGhlIG91dHN0YW5kaW5nIE1lc3NhZ2UgU2V0Lgog\nICAgICAgICAgICBvdXRzdGFuZGluZ01zZ1NldC5yZW1vdmUobWVzc2FnZSk7\nCiAgICAgICAgICAgIC8vIENoZWNrIGlmIHdlIHRocm90dGxlZCBtZXNzYWdl\nIGNvbnN1bXB0aW9uIHByZXZpb3VzbHkgd2hlbiB0aGUKICAgICAgICAgICAg\nLy8gb3V0c3RhbmRpbmcgbWVzc2FnZSBsaW1pdCB3YXMgcmVhY2hlZC4gRm9y\nIG5vdywgb25seSB0dXJuIHRoZQogICAgICAgICAgICAvLyBkZWxpdmVyeSBi\nYWNrIG9uIGlmIHRoZXJlIGFyZSBubyBtb3JlIG91dHN0YW5kaW5nIG1lc3Nh\nZ2VzIHRvCiAgICAgICAgICAgIC8vIGNvbnN1bWUuIFdlIGNvdWxkIG1ha2Ug\ndGhpcyBhIGNvbmZpZ3VyYWJsZSBwYXJhbWV0ZXIgaWYgbmVlZGVkLgogICAg\nICAgICAgICBpZiAoIWNoYW5uZWwuaXNSZWFkYWJsZSgpICYmIG91dHN0YW5k\naW5nTXNnU2V0LnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICBpZiAo\nbG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAg\nbG9nZ2VyLmRlYnVnKCJNZXNzYWdlIGNvbnN1bXB0aW9uIGhhcyBjYXVnaHQg\ndXAgc28gb2theSB0byB0dXJuIG9mZiIKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiIHRocm90dGxpbmcgb2YgbWVzc2FnZXMgb24gdGhl\nIHN1YnNjcmliZSBjaGFubmVsIGZvciB7fSIsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHRvcGljU3Vic2NyaWJlcik7CiAgICAgICAgICAg\nICAgICBjaGFubmVsLnNldFJlYWRhYmxlKHRydWUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nc3luY2hyb25pemVkIHZvaWQgc3RhcnREZWxpdmVyeShNZXNzYWdlSGFuZGxl\nciBtZXNzYWdlSGFuZGxlcikKICAgICAgICB0aHJvd3MgQWxyZWFkeVN0YXJ0\nRGVsaXZlcnlFeGNlcHRpb24sIENsaWVudE5vdFN1YnNjcmliZWRFeGNlcHRp\nb24gewogICAgICAgICAgICBzdXBlci5zdGFydERlbGl2ZXJ5KG1lc3NhZ2VI\nYW5kbGVyKTsKICAgICAgICAgICAgLy8gTm93IG1ha2UgdGhlIFRvcGljU3Vi\nc2NyaWJlciBDaGFubmVsIHJlYWRhYmxlIChpdCBpcyBzZXQgdG8gbm90IGJl\nCiAgICAgICAgICAgIC8vIHJlYWRhYmxlIHdoZW4gdGhlIGluaXRpYWwgc3Vi\nc2NyaXB0aW9uIGlzIGRvbmUpLiBOb3RlIHRoYXQgdGhpcyBpcyBhbgogICAg\nICAgICAgICAvLyBhc3luY2hyb25vdXMgY2FsbC4gSWYgdGhpcyBmYWlscyAo\nbm90IGxpa2VseSksIHRoZSBmdXR1cmVMaXN0ZW5lcgogICAgICAgICAgICAv\nLyB3aWxsIGp1c3QgbG9nIGFuIGVycm9yIG1lc3NhZ2UgZm9yIG5vdy4KICAg\nICAgICAgICAgQ2hhbm5lbEZ1dHVyZSBmdXR1cmUgPSBjaGFubmVsLnNldFJl\nYWRhYmxlKHRydWUpOwogICAgICAgICAgICBmdXR1cmUuYWRkTGlzdGVuZXIo\nbmV3IENoYW5uZWxGdXR1cmVMaXN0ZW5lcigpIHsKICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uQ29tcGxldGUoQ2hhbm5lbEZ1dHVyZSBmdXR1cmUpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgICAgIGlmICghZnV0dXJlLmlzU3Vj\nY2VzcygpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJv\ncigiVW5hYmxlIHRvIG1ha2Ugc3Vic2NyaWJlciBDaGFubmVsIHJlYWRhYmxl\nIGluIHN0YXJ0RGVsaXZlcnkgY2FsbCBmb3Ige30iLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgdG9waWNTdWJzY3JpYmVyKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIHN5bmNocm9uaXplZCB2b2lkIHN0b3BEZWxpdmVyeSgpIHsKICAg\nICAgICAgICAgc3VwZXIuc3RvcERlbGl2ZXJ5KCk7CiAgICAgICAgICAgIC8v\nIE5vdyBtYWtlIHRoZSBUb3BpY1N1YnNjcmliZXIgY2hhbm5lbCBub3QtcmVh\nZGFibGUuIFRoaXMgd2lsbCBidWZmZXIKICAgICAgICAgICAgLy8gdXAgbWVz\nc2FnZXMgaWYgYW55IGFyZSBzZW50IGZyb20gdGhlIHNlcnZlci4gTm90ZSB0\naGF0IHRoaXMgaXMgYW4KICAgICAgICAgICAgLy8gYXN5bmNocm9ub3VzIGNh\nbGwuIElmIHRoaXMgZmFpbHMgKG5vdCBsaWtlbHkpLCB0aGUgZnV0dXJlTGlz\ndGVuZXIKICAgICAgICAgICAgLy8gd2lsbCBqdXN0IGxvZyBhbiBlcnJvciBt\nZXNzYWdlIGZvciBub3cuCiAgICAgICAgICAgIENoYW5uZWxGdXR1cmUgZnV0\ndXJlID0gY2hhbm5lbC5zZXRSZWFkYWJsZShmYWxzZSk7CiAgICAgICAgICAg\nIGZ1dHVyZS5hZGRMaXN0ZW5lcihuZXcgQ2hhbm5lbEZ1dHVyZUxpc3RlbmVy\nKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShDaGFubmVsRnV0dXJl\nIGZ1dHVyZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKCFmdXR1cmUuaXNTdWNjZXNzKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgbG9nZ2VyLmVycm9yKCJVbmFibGUgdG8gbWFrZSBzdWJzY3Jp\nYmVyIENoYW5uZWwgbm90IHJlYWRhYmxlIGluIHN0b3BEZWxpdmVyeSBjYWxs\nIGZvciB7fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB0b3BpY1N1YnNjcmliZXIpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAg\nIH0KCiAgICAvLyBUcmFjayB3aGljaCBzdWJzY3JpYmVyIGlzIGFsaXZlIGlu\nIHRoaXMgcmVzcG9uc2UgaGFuZGxlcgogICAgLy8gV2hpY2ggaXMgdXNlZCBm\nb3IgYmFja3dhcmQgY29tcGF0LCBzaW5jZSBvbGQgdmVyc2lvbiBodWIKICAg\nIC8vIHNlcnZlciBkb2Vzbid0IGNhcnJ5ICh0b3BpYywgc3Vic2NyaWJlcmlk\nKSBpbiBlYWNoIG1lc3NhZ2UuCiAgICBwcml2YXRlIHZvbGF0aWxlIFRvcGlj\nU3Vic2NyaWJlciBvcmlnVG9waWNTdWJzY3JpYmVyOwogICAgcHJpdmF0ZSB2\nb2xhdGlsZSBBY3RpdmVTdWJzY3JpYmVyIG9yaWdBY3RpdmVTdWJzY3JpYmVy\nOwoKICAgIHByaXZhdGUgU2ltcGxlSENoYW5uZWxNYW5hZ2VyIHNDaGFubmVs\nTWFuYWdlcjsKCiAgICBwcm90ZWN0ZWQgU2ltcGxlU3Vic2NyaWJlUmVzcG9u\nc2VIYW5kbGVyKENsaWVudENvbmZpZ3VyYXRpb24gY2ZnLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIQ2hhbm5lbE1h\nbmFnZXIgY2hhbm5lbE1hbmFnZXIpIHsKICAgICAgICBzdXBlcihjZmcsIGNo\nYW5uZWxNYW5hZ2VyKTsKICAgICAgICBzQ2hhbm5lbE1hbmFnZXIgPSAoU2lt\ncGxlSENoYW5uZWxNYW5hZ2VyKSBjaGFubmVsTWFuYWdlcjsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBBY3RpdmVTdWJzY3JpYmVyIGNy\nZWF0ZUFjdGl2ZVN1YnNjcmliZXIoCiAgICAgICAgQ2xpZW50Q29uZmlndXJh\ndGlvbiBjZmcsIEFic3RyYWN0SENoYW5uZWxNYW5hZ2VyIGNoYW5uZWxNYW5h\nZ2VyLAogICAgICAgIFRvcGljU3Vic2NyaWJlciB0cywgUHViU3ViRGF0YSBv\ncCwgU3Vic2NyaXB0aW9uUHJlZmVyZW5jZXMgcHJlZmVyZW5jZXMsCiAgICAg\nICAgQ2hhbm5lbCBjaGFubmVsLCBIQ2hhbm5lbCBoQ2hhbm5lbCkgewogICAg\nICAgIHJldHVybiBuZXcgU2ltcGxlQWN0aXZlU3Vic2NyaWJlcihjZmcsIGNo\nYW5uZWxNYW5hZ2VyLCB0cywgb3AsIHByZWZlcmVuY2VzLCBjaGFubmVsLCBo\nQ2hhbm5lbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nc3luY2hyb25pemVkIEFjdGl2ZVN1YnNjcmliZXIgZ2V0QWN0aXZlU3Vic2Ny\naWJlcihUb3BpY1N1YnNjcmliZXIgdHMpIHsKICAgICAgICBpZiAobnVsbCA9\nPSBvcmlnVG9waWNTdWJzY3JpYmVyIHx8ICFvcmlnVG9waWNTdWJzY3JpYmVy\nLmVxdWFscyh0cykpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBvcmlnQWN0aXZlU3Vic2NyaWJlcjsKICAg\nIH0KCiAgICBwcml2YXRlIHN5bmNocm9uaXplZCBBY3RpdmVTdWJzY3JpYmVy\nIGdldEFjdGl2ZVN1YnNjcmliZXIoKSB7CiAgICAgICAgcmV0dXJuIG9yaWdB\nY3RpdmVTdWJzY3JpYmVyOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIHN5bmNocm9uaXplZCBib29sZWFuIGhhc1N1YnNjcmlwdGlvbihUb3Bp\nY1N1YnNjcmliZXIgdHMpIHsKICAgICAgICBpZiAobnVsbCA9PSBvcmlnVG9w\naWNTdWJzY3JpYmVyKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIG9yaWdUb3BpY1N1YnNjcmliZXIuZXF1\nYWxzKHRzKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBz\neW5jaHJvbml6ZWQgYm9vbGVhbiByZW1vdmVTdWJzY3JpcHRpb24oVG9waWNT\ndWJzY3JpYmVyIHRzLCBBY3RpdmVTdWJzY3JpYmVyIHNzKSB7CiAgICAgICAg\naWYgKG51bGwgIT0gb3JpZ1RvcGljU3Vic2NyaWJlciAmJiAhb3JpZ1RvcGlj\nU3Vic2NyaWJlci5lcXVhbHModHMpKSB7CiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICB9CiAgICAgICAgb3JpZ1RvcGljU3Vic2NyaWJlciA9\nIG51bGw7CiAgICAgICAgb3JpZ0FjdGl2ZVN1YnNjcmliZXIgPSBudWxsOwog\nICAgICAgIHJldHVybiBzdXBlci5yZW1vdmVTdWJzY3JpcHRpb24odHMsIHNz\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGhhbmRs\nZVJlc3BvbnNlKFB1YlN1YlJlc3BvbnNlIHJlc3BvbnNlLCBQdWJTdWJEYXRh\nIHB1YlN1YkRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBD\naGFubmVsIGNoYW5uZWwpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8v\nIElmIHRoaXMgd2FzIG5vdCBhIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgdG8gdGhl\nIFN1YnNjcmliZSByZXF1ZXN0LCB3ZQogICAgICAgIC8vIHdvbid0IGJlIHVz\naW5nIHRoZSBOZXR0eSBDaGFubmVsIGNyZWF0ZWQgc28ganVzdCBjbG9zZSBp\ndC4KICAgICAgICBpZiAoIXJlc3BvbnNlLmdldFN0YXR1c0NvZGUoKS5lcXVh\nbHMoU3RhdHVzQ29kZS5TVUNDRVNTKSkgewogICAgICAgICAgICBIQ2hhbm5l\nbEltcGwuZ2V0SENoYW5uZWxIYW5kbGVyRnJvbUNoYW5uZWwoY2hhbm5lbCku\nY2xvc2VFeHBsaWNpdGx5KCk7CiAgICAgICAgICAgIGNoYW5uZWwuY2xvc2Uo\nKTsKICAgICAgICB9CiAgICAgICAgc3VwZXIuaGFuZGxlUmVzcG9uc2UocmVz\ncG9uc2UsIHB1YlN1YkRhdGEsIGNoYW5uZWwpOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIHZvaWQgaGFuZGxlU3Vic2NyaWJlTWVzc2FnZShQ\ndWJTdWJSZXNwb25zZSByZXNwb25zZSkgewogICAgICAgIE1lc3NhZ2UgbWVz\nc2FnZSA9IHJlc3BvbnNlLmdldE1lc3NhZ2UoKTsKICAgICAgICBBY3RpdmVT\ndWJzY3JpYmVyIHNzID0gZ2V0QWN0aXZlU3Vic2NyaWJlcigpOwogICAgICAg\nIGlmIChudWxsID09IHNzKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcigi\nTm8gU3Vic2NyaWJlciBpcyBhbGl2ZSByZWNlaXZpbmcgaXRzIG1lc3NhZ2Ug\ne30uIiwKICAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VJZFV0aWxz\nLm1zZ0lkVG9SZWFkYWJsZVN0cmluZyhtZXNzYWdlLmdldE1zZ0lkKCkpKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzcy5oYW5k\nbGVNZXNzYWdlKG1lc3NhZ2UpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHJvdGVjdGVkIEVpdGhlcjxTdGF0dXNDb2RlLCBIQ2hhbm5lbD4gaGFuZGxl\nU3VjY2Vzc1Jlc3BvbnNlKAogICAgICAgIFRvcGljU3Vic2NyaWJlciB0cywg\nUHViU3ViRGF0YSBwdWJTdWJEYXRhLCBDaGFubmVsIGNoYW5uZWwpIHsKICAg\nICAgICAvLyBTdG9yZSB0aGUgbWFwcGluZyBmb3IgdGhlIFRvcGljU3Vic2Ny\naWJlciB0byB0aGUgQ2hhbm5lbC4KICAgICAgICAvLyBUaGlzIGlzIHNvIHdl\nIGNhbiBjb250cm9sIHRoZSBzdGFydGluZyBhbmQgc3RvcHBpbmcgb2YKICAg\nICAgICAvLyBtZXNzYWdlIGRlbGl2ZXJpZXMgZnJvbSB0aGUgc2VydmVyIG9u\nIHRoYXQgQ2hhbm5lbC4gU3RvcmUKICAgICAgICAvLyB0aGlzIG9ubHkgb24g\nYSBzdWNjZXNzZnVsIGFjayByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXIuCiAg\nICAgICAgRWl0aGVyPEJvb2xlYW4sIEhDaGFubmVsPiByZXN1bHQgPQogICAg\nICAgICAgICBzQ2hhbm5lbE1hbmFnZXIuc3RvcmVTdWJzY3JpcHRpb25DaGFu\nbmVsKHRzLCBwdWJTdWJEYXRhLCBjaGFubmVsKTsKICAgICAgICBpZiAocmVz\ndWx0LmxlZnQoKSkgewogICAgICAgICAgICByZXR1cm4gRWl0aGVyLm9mKFN0\nYXR1c0NvZGUuU1VDQ0VTUywgcmVzdWx0LnJpZ2h0KCkpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIFN0YXR1c0NvZGUgY29kZTsKICAgICAgICAg\nICAgaWYgKHB1YlN1YkRhdGEuaXNSZXN1YnNjcmliZVJlcXVlc3QoKSkgewog\nICAgICAgICAgICAgICAgY29kZSA9IFN0YXR1c0NvZGUuUkVTVUJTQ1JJQkVf\nRVhDRVBUSU9OOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgY29kZSA9IFN0YXR1c0NvZGUuQ0xJRU5UX0FMUkVBRFlfU1VCU0NSSUJF\nRDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gRWl0aGVyLm9m\nKGNvZGUsIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCBzeW5jaHJvbml6ZWQgdm9pZCBwb3N0SGFuZGxlU3Vj\nY2Vzc1Jlc3BvbnNlKAogICAgICAgIFRvcGljU3Vic2NyaWJlciB0cywgQWN0\naXZlU3Vic2NyaWJlciBhcykgewogICAgICAgIG9yaWdUb3BpY1N1YnNjcmli\nZXIgPSB0czsKICAgICAgICBvcmlnQWN0aXZlU3Vic2NyaWJlciA9IGFzOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgYXN5bmNDbG9z\nZVN1YnNjcmlwdGlvbihmaW5hbCBUb3BpY1N1YnNjcmliZXIgdG9waWNTdWJz\nY3JpYmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBmaW5hbCBDYWxsYmFjazxSZXNwb25zZUJvZHk+IGNhbGxiYWNrLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBPYmpl\nY3QgY29udGV4dCkgewogICAgICAgIC8vIG5vdGhpbmcgdG8gZG8ganVzdCBj\nbGVhciBzdGF0dXMKICAgICAgICAvLyBjaGFubmVsIG1hbmFnZXIgdGFrZXMg\ndGhlIHJlc3BvbnNpYmlsaXR5IHRvIGNsb3NlIHRoZSBjaGFubmVsCiAgICAg\nICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY29udGV4dCwgKFJlc3Bv\nbnNlQm9keSludWxsKTsKICAgIH0KCn0K\n","encoding":"base64"}

