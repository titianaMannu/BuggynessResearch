{"sha":"4d73387640fa6f9d83ef4e09c3631a030572eb52","node_id":"MDQ6QmxvYjE1NzU5NTY6NGQ3MzM4NzY0MGZhNmY5ZDgzZWY0ZTA5YzM2MzFhMDMwNTcyZWI1Mg==","size":11993,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/4d73387640fa6f9d83ef4e09c3631a030572eb52","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW4uY29uc29sZTsKCmltcG9y\ndCBqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5pby5JT0V4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW1SZWFkZXI7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkVu\ndW1lcmF0aW9uOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQg\namF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVw\nZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmFkbWluLkhlZHdpZ0FkbWluOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTGVkZ2VyUmFuZ2U7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5M\nZWRnZXJSYW5nZXM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuUmVnaW9uU3BlY2lmaWNTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbkRhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5kYXRhLlN0YXQ7CgppbXBvcnQgY29t\nLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgY29tLmdvb2ds\nZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb247Cgov\nKioKICogQSB0b29sIHRvIHJlYWQgdG9waWMgbWVzc2FnZXMuCiAqCiAqIFRo\naXMgdG9vbCA6CiAqIDEpIHJlYWQgcGVyc2lzdGVuY2UgaW5mbyBmcm9tIHpv\nb2tlZXBlcjogbGVkZ2VyIHJhbmdlcwogKiAyKSByZWFkIHN1YnNjcmlwdGlv\nbiBpbmZvciBmcm9tIHpvb2tlZXBlcjogd2UgY2FuIGtub3cgdGhlIGxlYXN0\nIG1lc3NhZ2UgaWQgKGxlZGdlciBpZCkgCiAqIDMpIHVzZSBiayBjbGllbnQg\ndG8gcmVhZCBtZXNzYWdlIHN0YXJ0aW5nIGZyb20gbGVhc3QgbWVzc2FnZSBp\nZAogKi8KcHVibGljIGNsYXNzIFJlYWRUb3BpYyB7CiAgICAKICAgIGZpbmFs\nIEhlZHdpZ0FkbWluIGFkbWluOwogICAgZmluYWwgQnl0ZVN0cmluZyB0b3Bp\nYzsKICAgIGxvbmcgc3RhcnRTZXFJZDsKICAgIGxvbmcgbGVhc3RDb25zdW1l\nZFNlcUlkID0gTG9uZy5NQVhfVkFMVUU7CiAgICBmaW5hbCBib29sZWFuIGlu\nQ29uc29sZTsKCiAgICBzdGF0aWMgZmluYWwgaW50IFJDX09LID0gMDsKICAg\nIHN0YXRpYyBmaW5hbCBpbnQgUkNfRVJST1IgPSAtMTsKICAgIHN0YXRpYyBm\naW5hbCBpbnQgUkNfTk9UT1BJQyA9IC0yOwogICAgc3RhdGljIGZpbmFsIGlu\ndCBSQ19OT0xFREdFUlMgPSAtMzsKICAgIHN0YXRpYyBmaW5hbCBpbnQgUkNf\nTk9TVUJTQ1JJQkVSUyA9IC00OwogICAgCiAgICBzdGF0aWMgZmluYWwgaW50\nIE5VTV9NRVNTQUdFU19UT19QUklOVCA9IDE1OwoKICAgIExpc3Q8TGVkZ2Vy\nUmFuZ2U+IGxlZGdlcnMgPSBuZXcgQXJyYXlMaXN0PExlZGdlclJhbmdlPigp\nOwogICAgCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yCiAgICAgKi8KICAg\nIHB1YmxpYyBSZWFkVG9waWMoSGVkd2lnQWRtaW4gYWRtaW4sIEJ5dGVTdHJp\nbmcgdG9waWMsIGJvb2xlYW4gaW5Db25zb2xlKSB7CiAgICAgICAgdGhpcyhh\nZG1pbiwgdG9waWMsIDEsIGluQ29uc29sZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3RvcgogICAgICovCiAgICBwdWJsaWMgUmVhZFRvcGlj\nKEhlZHdpZ0FkbWluIGFkbWluLCBCeXRlU3RyaW5nIHRvcGljLCBsb25nIG1z\nZ1NlcUlkLCBib29sZWFuIGluQ29uc29sZSkgewogICAgICAgIHRoaXMuYWRt\naW4gPSBhZG1pbjsKICAgICAgICB0aGlzLnRvcGljID0gdG9waWM7CiAgICAg\nICAgdGhpcy5zdGFydFNlcUlkID0gbXNnU2VxSWQ7CiAgICAgICAgdGhpcy5p\nbkNvbnNvbGUgPSBpbkNvbnNvbGU7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQ2hlY2sgd2hldGhlciB0aGUgdG9waWMgZXhpc3RlZCBvciBub3QKICAg\nICAqCiAgICAgKiBAcmV0dXJuIFJDX09LIGlmIHRvcGljIGlzIGV4aXN0ZWQ7\nIFJDX05PVE9QSUMgaWYgbm90LgogICAgICogQHRocm93cyBFeGNlcHRpb24K\nICAgICAqLwogICAgcHJvdGVjdGVkIGludCBjaGVja1RvcGljKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGFkbWluLmhhc1RvcGljKHRv\ncGljKSA/IFJDX09LIDogUkNfTk9UT1BJQzsKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBHZXQgdGhlIGxlZGdlcnMgdXNlZCBieSB0aGlzIHRvcGljIHRv\nIHN0b3JlIG1lc3NhZ2VzCiAgICAgKgogICAgICogQHJldHVybiBSQ19PSyBp\nZiB0b3BpYyBoYXMgbWVzc2FnZXM7IFJDX05PTEVER0VSUyBpZiBub3QuCiAg\nICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBwcm90ZWN0ZWQg\naW50IGdldFRvcGljTGVkZ2VycygpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIExpc3Q8TGVkZ2VyUmFuZ2U+IHJhbmdlcyA9IGFkbWluLmdldFRvcGlj\nTGVkZ2Vycyh0b3BpYyk7IAogICAgICAgIGlmIChudWxsID09IHJhbmdlcyB8\nfCByYW5nZXMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIHJldHVybiBSQ19O\nT0xFREdFUlM7CiAgICAgICAgfQogICAgICAgIGxlZGdlcnMuYWRkQWxsKHJh\nbmdlcyk7CiAgICAgICAgcmV0dXJuIFJDX09LOwogICAgfQogICAgCiAgICBw\ncm90ZWN0ZWQgaW50IGdldExlYXN0U3Vic2NyaXB0aW9uKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgTWFwPEJ5dGVTdHJpbmcsIFN1YnNjcmlwdGlv\nbkRhdGE+IHN0YXRlcyA9IGFkbWluLmdldFRvcGljU3Vic2NyaXB0aW9ucyh0\nb3BpYyk7IAogICAgICAgIGlmIChzdGF0ZXMuaXNFbXB0eSgpKSB7CiAgICAg\nICAgICAgIHJldHVybiBSQ19OT1NVQlNDUklCRVJTOwogICAgICAgIH0KICAg\nICAgICBmb3IgKE1hcC5FbnRyeTxCeXRlU3RyaW5nLCBTdWJzY3JpcHRpb25E\nYXRhPiBlbnRyeSA6IHN0YXRlcy5lbnRyeVNldCgpKSB7CiAgICAgICAgICAg\nIFN1YnNjcmlwdGlvbkRhdGEgc3RhdGUgPSBlbnRyeS5nZXRWYWx1ZSgpOwog\nICAgICAgICAgICBsb25nIGxvY2FsTXNnSWQgPSBzdGF0ZS5nZXRTdGF0ZSgp\nLmdldE1zZ0lkKCkuZ2V0TG9jYWxDb21wb25lbnQoKTsKICAgICAgICAgICAg\naWYgKGxvY2FsTXNnSWQgPCBsZWFzdENvbnN1bWVkU2VxSWQpIHsKICAgICAg\nICAgICAgICAgIGxlYXN0Q29uc3VtZWRTZXFJZCA9IGxvY2FsTXNnSWQ7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGxlYXN0Q29uc3Vt\nZWRTZXFJZCA9PSBMb25nLk1BWF9WQUxVRSkgewogICAgICAgICAgICBsZWFz\ndENvbnN1bWVkU2VxSWQgPSAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nUkNfT0s7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHJlYWRUb3BpYygp\nIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBpbnQgcmMgPSBfcmVhZFRv\ncGljKCk7CiAgICAgICAgICAgIHN3aXRjaCAocmMpIHsKICAgICAgICAgICAg\nY2FzZSBSQ19OT1RPUElDOgogICAgICAgICAgICAgICAgU3lzdGVtLmVyci5w\ncmludGxuKCJObyB0b3BpYyAiICsgdG9waWMgKyAiIGZvdW5kLiIpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgUkNfTk9MRURH\nRVJTOgogICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJObyBt\nZXNzYWdlIGlzIHB1Ymxpc2hlZCB0byB0b3BpYyAiICsgdG9waWMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJp\nbnRsbigiRVJST1I6IHJlYWQgbWVzc2FnZXMgb2YgdG9waWMgIiArIHRvcGlj\nICsgIiBmYWlsZWQuIik7CiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNl\nKCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwcm90ZWN0ZWQgaW50IF9y\nZWFkVG9waWMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgcmM7\nCiAgICAgICAgLy8gY2hlY2sgdG9waWMKICAgICAgICByYyA9IGNoZWNrVG9w\naWMoKTsKICAgICAgICBpZiAoUkNfT0sgIT0gcmMpIHsKICAgICAgICAgICAg\ncmV0dXJuIHJjOwogICAgICAgIH0KICAgICAgICAvLyBnZXQgdG9waWMgbGVk\nZ2VycwogICAgICAgIHJjID0gZ2V0VG9waWNMZWRnZXJzKCk7CiAgICAgICAg\naWYgKFJDX09LICE9IHJjKSB7CiAgICAgICAgICAgIHJldHVybiByYzsKICAg\nICAgICB9CiAgICAgICAgLy8gZ2V0IHRvcGljIHN1YnNjcmlwdGlvbiB0byBm\naW5kIHRoZSBsZWFzdCBvbmUKICAgICAgICByYyA9IGdldExlYXN0U3Vic2Ny\naXB0aW9uKCk7CiAgICAgICAgaWYgKFJDX05PU1VCU0NSSUJFUlMgPT0gcmMp\nIHsKICAgICAgICAgICAgc3RhcnRTZXFJZCA9IDE7CiAgICAgICAgfSBlbHNl\nIGlmIChSQ19PSyA9PSByYykgewogICAgICAgICAgICBpZiAobGVhc3RDb25z\ndW1lZFNlcUlkID4gc3RhcnRTZXFJZCkgewogICAgICAgICAgICAgICAgc3Rh\ncnRTZXFJZCA9IGxlYXN0Q29uc3VtZWRTZXFJZCArIDE7CiAgICAgICAgICAg\nIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gcmM7CiAg\nICAgICAgfQoKICAgICAgICBmb3IgKExlZGdlclJhbmdlIHJhbmdlIDogbGVk\nZ2VycykgewogICAgICAgICAgICBsb25nIGVuZFNlcUlkID0gcmFuZ2UuZ2V0\nRW5kU2VxSWRJbmNsdWRlZCgpLmdldExvY2FsQ29tcG9uZW50KCk7CiAgICAg\nICAgICAgIGlmIChlbmRTZXFJZCA8IHN0YXJ0U2VxSWQpIHsKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJv\nb2xlYW4gdG9Db250aW51ZSA9IHJlYWRMZWRnZXIocmFuZ2UpOwogICAgICAg\nICAgICBzdGFydFNlcUlkID0gZW5kU2VxSWQgKyAxOwogICAgICAgICAgICBp\nZiAoIXRvQ29udGludWUpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiBS\nQ19PSzsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZWFkIGEgc3BlY2lm\naWMgbGVkZ2VyCiAgICAgKgogICAgICogQHBhcmFtIGxlZGdlciBpbiBtZW1v\ncnkgbGVkZ2VyIHJhbmdlCiAgICAgKiBAcGFyYW0gZW5kU2VxSWQgZW5kIHNl\ncSBpZAogICAgICogQHJldHVybiB0cnVlIGlmIGNvbnRpbnVlLCBvdGhlcndp\nc2UgZmFsc2UKICAgICAqIEB0aHJvd3MgQktFeGNlcHRpb24KICAgICAqIEB0\naHJvd3MgSU9FeGNlcHRpb24KICAgICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRF\neGNlcHRpb24KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gcmVhZExl\nZGdlcihMZWRnZXJSYW5nZSBsZWRnZXIpCiAgICB0aHJvd3MgQktFeGNlcHRp\nb24sIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAg\nICAgbG9uZyB0RW5kU2VxSWQgPSBsZWRnZXIuZ2V0RW5kU2VxSWRJbmNsdWRl\nZCgpLmdldExvY2FsQ29tcG9uZW50KCk7CgogICAgICAgIGlmICh0RW5kU2Vx\nSWQgPCB0aGlzLnN0YXJ0U2VxSWQpIHsKICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgfQogICAgICAgIC8vIE9wZW4gTGVkZ2VyIEhhbmRsZQog\nICAgICAgIGxvbmcgbGVkZ2VySWQgPSBsZWRnZXIuZ2V0TGVkZ2VySWQoKTsK\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlxuPj4+Pj4gIiArIGxlZGdl\nciArICIgPDw8PDxcbiIpOwogICAgICAgIExlZGdlckhhbmRsZSBsaCA9IG51\nbGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGggPSBhZG1pbi5nZXRC\na0hhbmRsZSgpLm9wZW5MZWRnZXJOb1JlY292ZXJ5KGxlZGdlcklkLCBhZG1p\nbi5nZXRCa0RpZ2VzdFR5cGUoKSwgYWRtaW4uZ2V0QmtQYXNzd2QoKSk7CiAg\nICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24gZSkgewogICAgICAgICAgICBT\neXN0ZW0uZXJyLnByaW50bG4oIkVSUk9SOiBObyBsZWRnZXIgIiArIGxlZGdl\ncklkICsgIiBmb3VuZC4gbWF5YmUgZ2FyYmFnZSBjb2xsZWN0ZWQgZHVlIHRv\nIHRoZSBtZXNzYWdlcyBhcmUgY29uc3VtZWQuIik7CiAgICAgICAgfQogICAg\nICAgIGlmIChudWxsID09IGxoKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIH0KICAgICAgICBsb25nIGV4cGVjdGVkRW50cnlJZCA9IHN0\nYXJ0U2VxSWQgLSBsZWRnZXIuZ2V0U3RhcnRTZXFJZEluY2x1ZGVkKCk7CiAg\nICAgICAgCiAgICAgICAgbG9uZyBjb3JyZWN0ZWRFbmRTZXFJZCA9IHRFbmRT\nZXFJZDsKICAgICAgICB0cnkgewogICAgICAgICAgICB3aGlsZSAoc3RhcnRT\nZXFJZCA8PSB0RW5kU2VxSWQpIHsKICAgICAgICAgICAgICAgIGNvcnJlY3Rl\nZEVuZFNlcUlkID0gTWF0aC5taW4oc3RhcnRTZXFJZCArIE5VTV9NRVNTQUdF\nU19UT19QUklOVCAtIDEsIHRFbmRTZXFJZCk7CiAgICAgICAgICAgICAgICAK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgRW51\nbWVyYXRpb248TGVkZ2VyRW50cnk+IHNlcSA9CiAgICAgICAgICAgICAgICAg\nICAgICAgIGxoLnJlYWRFbnRyaWVzKHN0YXJ0U2VxSWQgLSBsZWRnZXIuZ2V0\nU3RhcnRTZXFJZEluY2x1ZGVkKCksCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGNvcnJlY3RlZEVuZFNlcUlkIC0gbGVkZ2VyLmdl\ndFN0YXJ0U2VxSWRJbmNsdWRlZCgpKTsKICAgICAgICAgICAgICAgICAgICBM\nZWRnZXJFbnRyeSBlbnRyeSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAg\nd2hpbGUgKHNlcS5oYXNNb3JlRWxlbWVudHMoKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICBlbnRyeSA9IHNlcS5uZXh0RWxlbWVudCgpOwogICAgICAg\nICAgICAgICAgICAgICAgICBNZXNzYWdlIG1lc3NhZ2U7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBtZXNzYWdlID0gTWVzc2FnZS5wYXJzZUZyb20oZW50cnkuZ2V0RW50cnlJ\nbnB1dFN0cmVhbSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgU3lzdGVtLm91dC5wcmludGxuKCJXQVJOOiBVbnJlYWRhYmxlIG1lc3Nh\nZ2UgZm91bmRcbiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhw\nZWN0ZWRFbnRyeUlkKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBj\nb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAoZXhwZWN0ZWRFbnRyeUlkICE9IGVudHJ5Lmdl\ndEVudHJ5SWQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgKG1l\nc3NhZ2UuZ2V0TXNnSWQoKS5nZXRMb2NhbENvbXBvbmVudCgpIC0gbGVkZ2Vy\nLmdldFN0YXJ0U2VxSWRJbmNsdWRlZCgpKSAhPSBleHBlY3RlZEVudHJ5SWQp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4\nY2VwdGlvbigiRVJST1I6IE1lc3NhZ2UgaWRzIGFyZSBvdXQgb2Ygb3JkZXIg\nOiBleHBlY3RlZCBlbnRyeSBpZCAiICsgZXhwZWN0ZWRFbnRyeUlkCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nIiwgY3VycmVudCBlbnRyeSBpZCAiICsgZW50cnkuZ2V0RW50cnlJZCgpICsg\nIiwgbXNnIHNlcSBpZCAiICsgbWVzc2FnZS5nZXRNc2dJZCgpLmdldExvY2Fs\nQ29tcG9uZW50KCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkRW50cnlJZCsrOwogICAgICAg\nICAgICAgICAgICAgICAgICBmb3JtYXRNZXNzYWdlKG1lc3NhZ2UpOwoKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc3RhcnRT\nZXFJZCA9IGNvcnJlY3RlZEVuZFNlcUlkICsgMTsKICAgICAgICAgICAgICAg\nICAgICBpZiAoaW5Db25zb2xlKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmICghcHJlc3NLZXlUb0NvbnRpbnVlKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKEJLRXhjZXB0aW9uLkJLUmVhZEV4Y2VwdGlvbiBiZSkgewog\nICAgICAgICAgICAgICAgICAgIHRocm93IGJlOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24g\nYmtlKSB7CiAgICAgICAgICAgIGlmICh0RW5kU2VxSWQgIT0gTG9uZy5NQVhf\nVkFMVUUpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigi\nRVJST1I6IGxlZGdlciAiICsgbGVkZ2VySWQgKyAiIG1heSBiZSBjb3JydXB0\nZWQsIHNpbmNlIHJlYWQgbWVzc2FnZXMgWyIKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyBzdGFydFNlcUlkICsgIiB+ICIgKyBjb3JyZWN0\nZWRFbmRTZXFJZCArICIgXSBmYWlsZWQgOiIpOwogICAgICAgICAgICAgICAg\ndGhyb3cgYmtlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigiXG4iKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KICAgIAogICAgcHJvdGVjdGVkIHZvaWQgZm9ybWF0TWVzc2FnZShN\nZXNzYWdlIG1lc3NhZ2UpIHsKICAgICAgICAvLyBwcmludCBtc2cgaWQKICAg\nICAgICBTdHJpbmcgbXNnSWQ7CiAgICAgICAgaWYgKCFtZXNzYWdlLmhhc01z\nZ0lkKCkpIHsKICAgICAgICAgICAgbXNnSWQgPSAiTi9BIjsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICBNZXNzYWdlU2VxSWQgc2VxSWQgPSBtZXNz\nYWdlLmdldE1zZ0lkKCk7CiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgaWRC\ndWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgaWYg\nKHNlcUlkLmhhc0xvY2FsQ29tcG9uZW50KCkpIHsKICAgICAgICAgICAgICAg\nIGlkQnVpbGRlci5hcHBlbmQoIkxPQ0FMKCIpLmFwcGVuZChzZXFJZC5nZXRM\nb2NhbENvbXBvbmVudCgpKS5hcHBlbmQoIikiKTsKICAgICAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgICAgIExpc3Q8UmVnaW9uU3BlY2lmaWNTZXFJ\nZD4gcmVtb3RlSWRzID0gc2VxSWQuZ2V0UmVtb3RlQ29tcG9uZW50c0xpc3Qo\nKTsKICAgICAgICAgICAgICAgIGludCBpID0gMCwgbnVtUmVnaW9ucyA9IHJl\nbW90ZUlkcy5zaXplKCk7CiAgICAgICAgICAgICAgICBpZEJ1aWxkZXIuYXBw\nZW5kKCJSRU1PVEUoIik7CiAgICAgICAgICAgICAgICBmb3IgKFJlZ2lvblNw\nZWNpZmljU2VxSWQgcnNzaWQgOiByZW1vdGVJZHMpIHsKICAgICAgICAgICAg\nICAgICAgICBpZEJ1aWxkZXIuYXBwZW5kKHJzc2lkLmdldFJlZ2lvbigpLnRv\nU3RyaW5nVXRmOCgpKTsKICAgICAgICAgICAgICAgICAgICBpZEJ1aWxkZXIu\nYXBwZW5kKCJbIik7CiAgICAgICAgICAgICAgICAgICAgaWRCdWlsZGVyLmFw\ncGVuZChyc3NpZC5nZXRTZXFJZCgpKTsKICAgICAgICAgICAgICAgICAgICBp\nZEJ1aWxkZXIuYXBwZW5kKCJdIik7CiAgICAgICAgICAgICAgICAgICAgKytp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChpIDwgbnVtUmVnaW9ucykgewog\nICAgICAgICAgICAgICAgICAgICAgICBpZEJ1aWxkZXIuYXBwZW5kKCIsIik7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgaWRCdWlsZGVyLmFwcGVuZCgiKSIpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIG1zZ0lkID0gaWRCdWlsZGVyLnRvU3RyaW5nKCk7\nCiAgICAgICAgfQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiLS0tLS0t\nLS0tLSBNU0dJRD0iICsgbXNnSWQgKyAiIC0tLS0tLS0tLS0iKTsKICAgICAg\nICBTeXN0ZW0ub3V0LnByaW50bG4oIk1zZ0lkOiAgICAgIiArIG1zZ0lkKTsK\nICAgICAgICAvLyBwcmludCBzb3VyY2UgcmVnaW9uCiAgICAgICAgaWYgKG1l\nc3NhZ2UuaGFzU3JjUmVnaW9uKCkpIHsKICAgICAgICAgICAgU3lzdGVtLm91\ndC5wcmludGxuKCJTcmNSZWdpb246ICIgKyBtZXNzYWdlLmdldFNyY1JlZ2lv\nbigpLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlNyY1JlZ2lvbjogTi9BIik7CiAg\nICAgICAgfQogICAgICAgIC8vIHByaW50IG1lc3NhZ2UgYm9keQogICAgICAg\nIFN5c3RlbS5vdXQucHJpbnRsbigiTWVzc2FnZToiKTsKICAgICAgICBTeXN0\nZW0ub3V0LnByaW50bG4oKTsKICAgICAgICBpZiAobWVzc2FnZS5oYXNCb2R5\nKCkpIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKG1lc3NhZ2Uu\nZ2V0Qm9keSgpLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk4vQSIpOwogICAgICAg\nIH0KICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oKTsKICAgIH0KICAgIAog\nICAgYm9vbGVhbiBwcmVzc0tleVRvQ29udGludWUoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiUHJlc3MgWSB0\nbyBjb250aW51ZS4uLiIpOwogICAgICAgIEJ1ZmZlcmVkUmVhZGVyIHN0ZGlu\nID0gbmV3IEJ1ZmZlcmVkUmVhZGVyKG5ldyBJbnB1dFN0cmVhbVJlYWRlcihT\neXN0ZW0uaW4pKTsKICAgICAgICBpbnQgY2ggPSBzdGRpbi5yZWFkKCk7CiAg\nICAgICAgaWYgKGNoID09ICd5JyB8fAogICAgICAgICAgICBjaCA9PSAnWScp\nIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KfQo=\n","encoding":"base64"}

