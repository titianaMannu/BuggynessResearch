{"sha":"8bd56032cb14132916d35eca7800ce7b07d1829e","node_id":"MDQ6QmxvYjE1NzU5NTY6OGJkNTYwMzJjYjE0MTMyOTE2ZDM1ZWNhNzgwMGNlN2IwN2QxODI5ZQ==","size":4393,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8bd56032cb14132916d35eca7800ce7b07d1829e","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuaGVkd2lnLmRhdGE7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLkVudHJ5Rm9ybWF0\ndGVyOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbmZpZ3VyYXRpb24u\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQ7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90\nb2NvbC5SZWdpb25TcGVjaWZpY1NlcUlkOwoKaW1wb3J0IG9yZy5zbGY0ai5M\nb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCi8qKgog\nKiBGb3JtYXQgYSBwdWIgc3ViIG1lc3NhZ2UgaW50byBhIHJlYWRhYmxlIGZv\ncm1hdC4KICovCnB1YmxpYyBjbGFzcyBNZXNzYWdlRm9ybWF0dGVyIGV4dGVu\nZHMgRW50cnlGb3JtYXR0ZXIgewogICAgc3RhdGljIExvZ2dlciBsb2dnZXIg\nPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihNZXNzYWdlRm9ybWF0dGVyLmNs\nYXNzKTsKCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIE1FU1NBR0VfUEFZTE9B\nRF9GT1JNQVRURVJfQ0xBU1MgPSAibWVzc2FnZV9wYXlsb2FkX2Zvcm1hdHRl\ncl9jbGFzcyI7CgogICAgRW50cnlGb3JtYXR0ZXIgZGF0YUZvcm1hdHRlciA9\nIEVudHJ5Rm9ybWF0dGVyLlNUUklOR19GT1JNQVRURVI7CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCBzZXRDb25mKENvbmZpZ3VyYXRpb24gY29u\nZikgewogICAgICAgIHN1cGVyLnNldENvbmYoY29uZik7CiAgICAgICAgZGF0\nYUZvcm1hdHRlciA9IEVudHJ5Rm9ybWF0dGVyLm5ld0VudHJ5Rm9ybWF0dGVy\nKGNvbmYsIE1FU1NBR0VfUEFZTE9BRF9GT1JNQVRURVJfQ0xBU1MpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgZm9ybWF0RW50cnko\namF2YS5pby5JbnB1dFN0cmVhbSBpbnB1dCkgewogICAgICAgIE1lc3NhZ2Ug\nbWVzc2FnZTsKICAgICAgICB0cnkgewogICAgICAgICAgICBtZXNzYWdlID0g\nTWVzc2FnZS5wYXJzZUZyb20oaW5wdXQpOwogICAgICAgIH0gY2F0Y2ggKElP\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCJXQVJOOiBVbnJlYWRhYmxlIG1lc3NhZ2UgZm91bmRcbiIpOwogICAgICAg\nICAgICBFbnRyeUZvcm1hdHRlci5TVFJJTkdfRk9STUFUVEVSLmZvcm1hdEVu\ndHJ5KGlucHV0KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAg\nICAgICBmb3JtYXRNZXNzYWdlKG1lc3NhZ2UpOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIHZvaWQgZm9ybWF0RW50cnkoYnl0ZVtdIGRhdGEp\nIHsKICAgICAgICBNZXNzYWdlIG1lc3NhZ2U7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgbWVzc2FnZSA9IE1lc3NhZ2UucGFyc2VGcm9tKGRhdGEpOwog\nICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nU3lzdGVtLm91dC5wcmludGxuKCJXQVJOOiBVbnJlYWRhYmxlIG1lc3NhZ2Ug\nZm91bmRcbiIpOwogICAgICAgICAgICBFbnRyeUZvcm1hdHRlci5TVFJJTkdf\nRk9STUFUVEVSLmZvcm1hdEVudHJ5KGRhdGEpOwogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgfQogICAgICAgIGZvcm1hdE1lc3NhZ2UobWVzc2FnZSk7\nCiAgICB9CgogICAgdm9pZCBmb3JtYXRNZXNzYWdlKE1lc3NhZ2UgbWVzc2Fn\nZSkgewogICAgICAgIC8vIHByaW50IG1zZyBpZAogICAgICAgIFN0cmluZyBt\nc2dJZDsKICAgICAgICBpZiAoIW1lc3NhZ2UuaGFzTXNnSWQoKSkgewogICAg\nICAgICAgICBtc2dJZCA9ICJOL0EiOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIE1lc3NhZ2VTZXFJZCBzZXFJZCA9IG1lc3NhZ2UuZ2V0TXNnSWQo\nKTsKICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBpZEJ1aWxkZXIgPSBuZXcg\nU3RyaW5nQnVpbGRlcigpOwogICAgICAgICAgICBpZiAoc2VxSWQuaGFzTG9j\nYWxDb21wb25lbnQoKSkgewogICAgICAgICAgICAgICAgaWRCdWlsZGVyLmFw\ncGVuZCgiTE9DQUwoIikuYXBwZW5kKHNlcUlkLmdldExvY2FsQ29tcG9uZW50\nKCkpLmFwcGVuZCgiKSIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgTGlzdDxSZWdpb25TcGVjaWZpY1NlcUlkPiByZW1vdGVJZHMg\nPSBzZXFJZC5nZXRSZW1vdGVDb21wb25lbnRzTGlzdCgpOwogICAgICAgICAg\nICAgICAgaW50IGkgPSAwLCBudW1SZWdpb25zID0gcmVtb3RlSWRzLnNpemUo\nKTsKICAgICAgICAgICAgICAgIGlkQnVpbGRlci5hcHBlbmQoIlJFTU9URSgi\nKTsKICAgICAgICAgICAgICAgIGZvciAoUmVnaW9uU3BlY2lmaWNTZXFJZCBy\nc3NpZCA6IHJlbW90ZUlkcykgewogICAgICAgICAgICAgICAgICAgIGlkQnVp\nbGRlci5hcHBlbmQocnNzaWQuZ2V0UmVnaW9uKCkudG9TdHJpbmdVdGY4KCkp\nOwogICAgICAgICAgICAgICAgICAgIGlkQnVpbGRlci5hcHBlbmQoIlsiKTsK\nICAgICAgICAgICAgICAgICAgICBpZEJ1aWxkZXIuYXBwZW5kKHJzc2lkLmdl\ndFNlcUlkKCkpOwogICAgICAgICAgICAgICAgICAgIGlkQnVpbGRlci5hcHBl\nbmQoIl0iKTsKICAgICAgICAgICAgICAgICAgICArK2k7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGkgPCBudW1SZWdpb25zKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGlkQnVpbGRlci5hcHBlbmQoIiwiKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBp\nZEJ1aWxkZXIuYXBwZW5kKCIpIik7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgbXNnSWQgPSBpZEJ1aWxkZXIudG9TdHJpbmcoKTsKICAgICAgICB9CiAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCIqKioqKiogTVNHSUQ9IiArIG1z\nZ0lkICsgIiAqKioqKioiKTsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nIk1lc3NhZ2VJZDogICAgICAiICsgbXNnSWQpOwogICAgICAgIC8vIHByaW50\nIHNvdXJjZSByZWdpb24KICAgICAgICBpZiAobWVzc2FnZS5oYXNTcmNSZWdp\nb24oKSkgewogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlNyY1Jl\nZ2lvbjogICAgICAiICsgbWVzc2FnZS5nZXRTcmNSZWdpb24oKS50b1N0cmlu\nZ1V0ZjgoKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3lzdGVt\nLm91dC5wcmludGxuKCJTcmNSZWdpb246ICAgICAgTi9BIik7CiAgICAgICAg\nfQogICAgICAgIC8vIHByaW50IG1lc3NhZ2UgYm9keQogICAgICAgIGlmICht\nZXNzYWdlLmhhc0JvZHkoKSkgewogICAgICAgICAgICBTeXN0ZW0ub3V0LnBy\naW50bG4oIkJvZHk6Iik7CiAgICAgICAgICAgIGRhdGFGb3JtYXR0ZXIuZm9y\nbWF0RW50cnkobWVzc2FnZS5nZXRCb2R5KCkudG9CeXRlQXJyYXkoKSk7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCJCb2R5OiAgICAgICAgICAgTi9BIik7CiAgICAgICAgfQogICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigpOwogICAgfQp9Cg==\n","encoding":"base64"}

