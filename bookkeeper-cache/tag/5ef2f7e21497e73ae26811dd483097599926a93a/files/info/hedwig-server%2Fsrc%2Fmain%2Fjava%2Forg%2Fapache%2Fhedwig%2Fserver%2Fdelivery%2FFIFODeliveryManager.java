{"sha":"d6e4c6a667a4f8a801d3e31edd51f966ff552c31","node_id":"MDQ6QmxvYjE1NzU5NTY6ZDZlNGM2YTY2N2E0ZjhhODAxZDNlMzFlZGQ1MWY5NjZmZjU1MmMzMQ==","size":34083,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/d6e4c6a667a4f8a801d3e31edd51f966ff552c31","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuZGVsaXZlcnk7CgppbXBv\ncnQgamF2YS51dGlsLkNvbXBhcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuSGFz\naE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51\ndGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5RdWV1ZTsKaW1wb3J0IGphdmEu\ndXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuU29ydGVkTWFwOwppbXBvcnQg\namF2YS51dGlsLlRyZWVNYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVu\ndC5CbG9ja2luZ1F1ZXVlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQu\nUHJpb3JpdHlCbG9ja2luZ1F1ZXVlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1\ncnJlbnQuTGlua2VkQmxvY2tpbmdRdWV1ZTsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LlRpbWVVbml0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJl\nbnQubG9ja3MuUmVlbnRyYW50UmVhZFdyaXRlTG9jazsKCmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7\nCgppbXBvcnQgY29tLmdvb2dsZS5jb21tb24uYW5ub3RhdGlvbnMuVmlzaWJs\nZUZvclRlc3Rpbmc7CmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVT\ndHJpbmc7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuTWF0\naFV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEu\nVG9waWNTdWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhj\nZXB0aW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5maWx0ZXIuU2VydmVyTWVzc2FnZUZpbHRlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90\nb2NvbC5NZXNzYWdlU2VxSWQ7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5w\ncm90b2NvbC5QdWJTdWJQcm90b2NvbC5Qcm90b2NvbFZlcnNpb247CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5Q\ndWJTdWJSZXNwb25zZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLlN0YXR1c0NvZGU7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRp\nb25FdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1\nYlN1YlByb3RvY29sLlN1YnNjcmlwdGlvblByZWZlcmVuY2VzOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25zLlB1YlN1YlJlc3Bv\nbnNlVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29t\nbW9uLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIuY29tbW9uLlVuZXhwZWN0ZWRFcnJvcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVycy5TdWJzY3JpcHRpb25D\naGFubmVsTWFuYWdlci5TdWJDaGFubmVsRGlzY29ubmVjdGVkTGlzdGVuZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubmV0dHkuU2VydmVy\nU3RhdHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lz\ndGVuY2UuQ2FuY2VsU2NhblJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuRmFjdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5NYXBNZXRob2RzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLlBl\ncnNpc3RlbmNlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5wZXJzaXN0ZW5jZS5SZWFkQWhlYWRDYWNoZTsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5TY2FuQ2FsbGJhY2s7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2Uu\nU2NhblJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNh\nbGxiYWNrOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwu\nVmFyQXJncy52YTsKCnB1YmxpYyBjbGFzcyBGSUZPRGVsaXZlcnlNYW5hZ2Vy\nIGltcGxlbWVudHMgUnVubmFibGUsIERlbGl2ZXJ5TWFuYWdlciwgU3ViQ2hh\nbm5lbERpc2Nvbm5lY3RlZExpc3RlbmVyIHsKCiAgICBwcm90ZWN0ZWQgc3Rh\ndGljIGZpbmFsIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihGSUZPRGVsaXZlcnlNYW5hZ2VyLmNsYXNzKTsKCiAgICBwcml2YXRl\nIHN0YXRpYyBDYWxsYmFjazxWb2lkPiBOT1BfQ0FMTEJBQ0sgPSBuZXcgQ2Fs\nbGJhY2s8Vm9pZD4oKSB7CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9pZCBy\nZXN1bHQpIHsKICAgICAgICB9CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1\nYkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICB9CiAgICB9OwoKICAg\nIHByb3RlY3RlZCBpbnRlcmZhY2UgRGVsaXZlcnlNYW5hZ2VyUmVxdWVzdCB7\nCiAgICAgICAgcHVibGljIHZvaWQgcGVyZm9ybVJlcXVlc3QoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIHRoZSBtYWluIHF1ZXVlIHRoYXQgdGhlIHNpbmds\nZS10aHJlYWRlZCBkZWxpdmVyeSBtYW5hZ2VyIHdvcmtzIG9mZiBvZgogICAg\nICovCiAgICBCbG9ja2luZ1F1ZXVlPERlbGl2ZXJ5TWFuYWdlclJlcXVlc3Q+\nIHJlcXVlc3RRdWV1ZSA9IG5ldyBMaW5rZWRCbG9ja2luZ1F1ZXVlPERlbGl2\nZXJ5TWFuYWdlclJlcXVlc3Q+KCk7CgogICAgLyoqCiAgICAgKiBUaGUgcXVl\ndWUgb2YgYWxsIHN1YnNjcmlwdGlvbnMgdGhhdCBhcmUgZmFjaW5nIGEgdHJh\nbnNpZW50IGVycm9yIGVpdGhlcgogICAgICogaW4gc2Nhbm5pbmcgZnJvbSB0\naGUgcGVyc2lzdGVuY2UgbWFuYWdlciwgb3IgaW4gc2VuZGluZyB0byB0aGUg\nY29uc3VtZXIKICAgICAqLwogICAgUXVldWU8QWN0aXZlU3Vic2NyaWJlclN0\nYXRlPiByZXRyeVF1ZXVlID0KICAgICAgICBuZXcgUHJpb3JpdHlCbG9ja2lu\nZ1F1ZXVlPEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4oMzIsIG5ldyBDb21wYXJh\ndG9yPEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4oKSB7CiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgaW50IGNvbXBhcmUoQWN0aXZl\nU3Vic2NyaWJlclN0YXRlIGFzMSwgQWN0aXZlU3Vic2NyaWJlclN0YXRlIGFz\nMikgewogICAgICAgICAgICAgICAgbG9uZyBzID0gYXMxLmxhc3RTY2FuRXJy\nb3JUaW1lIC0gYXMyLmxhc3RTY2FuRXJyb3JUaW1lOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHMgPiAwID8gMSA6IChzIDwgMCA/IC0xIDogMCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9KTsKCiAgICAvKioKICAgICAqIFN0b3JlcyBh\nIG1hcHBpbmcgZnJvbSB0b3BpYyB0byB0aGUgZGVsaXZlcnkgcG9pbnRlcnMg\nb24gdGhlIHRvcGljLiBUaGUKICAgICAqIGRlbGl2ZXJ5IHBvaW50ZXJzIGFy\nZSBzdG9yZWQgaW4gYSBzb3J0ZWQgbWFwIGZyb20gc2VxLWlkIHRvIHRoZSBz\nZXQgb2YKICAgICAqIHN1YnNjcmliZXJzIGF0IHRoYXQgc2VxLWlkCiAgICAg\nKi8KICAgIE1hcDxCeXRlU3RyaW5nLCBTb3J0ZWRNYXA8TG9uZywgU2V0PEFj\ndGl2ZVN1YnNjcmliZXJTdGF0ZT4+PiBwZXJUb3BpY0RlbGl2ZXJ5UHRyczsK\nCiAgICAvKioKICAgICAqIE1hcHBpbmcgZnJvbSBkZWxpdmVyeSBlbmQgcG9p\nbnQgdG8gdGhlIHN1YnNjcmliZXIgc3RhdGUgdGhhdCB3ZSBhcmUKICAgICAq\nIHNlcnZpbmcgYXQgdGhhdCBlbmQgcG9pbnQuIFRoaXMgcHJldmVudHMgdXMg\nZS5nLiwgZnJvbSBzZXJ2aW5nIHR3bwogICAgICogc3Vic2NyaXB0aW9ucyB0\nbyB0aGUgc2FtZSBlbmRwb2ludAogICAgICovCiAgICBNYXA8VG9waWNTdWJz\nY3JpYmVyLCBBY3RpdmVTdWJzY3JpYmVyU3RhdGU+IHN1YnNjcmliZXJTdGF0\nZXM7CgogICAgcHJpdmF0ZSBmaW5hbCBSZWFkQWhlYWRDYWNoZSBjYWNoZTsK\nICAgIHByaXZhdGUgZmluYWwgUGVyc2lzdGVuY2VNYW5hZ2VyIHBlcnNpc3Rl\nbmNlTWdyOwoKICAgIHByaXZhdGUgU2VydmVyQ29uZmlndXJhdGlvbiBjZmc7\nCgogICAgLy8gQm9vbGVhbiBpbmRpY2F0aW5nIGlmIHRoaXMgdGhyZWFkIHNo\nb3VsZCBjb250aW51ZSBydW5uaW5nLiBUaGlzIGlzIHVzZWQKICAgIC8vIHdo\nZW4gd2Ugd2FudCB0byBzdG9wIHRoZSB0aHJlYWQgZHVyaW5nIGEgUHViU3Vi\nU2VydmVyIHNodXRkb3duLgogICAgcHJvdGVjdGVkIGJvb2xlYW4ga2VlcFJ1\nbm5pbmcgPSB0cnVlOwogICAgcHJpdmF0ZSBmaW5hbCBUaHJlYWQgd29ya2Vy\nVGhyZWFkOwoKICAgIHByaXZhdGUgT2JqZWN0IHN1c3BlbnNpb25Mb2NrID0g\nbmV3IE9iamVjdCgpOwogICAgcHJpdmF0ZSBib29sZWFuIHN1c3BlbmRlZCA9\nIGZhbHNlOwoKCiAgICBwdWJsaWMgRklGT0RlbGl2ZXJ5TWFuYWdlcihQZXJz\naXN0ZW5jZU1hbmFnZXIgcGVyc2lzdGVuY2VNZ3IsIFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY2ZnKSB7CiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZU1nciA9IHBl\ncnNpc3RlbmNlTWdyOwogICAgICAgIGlmIChwZXJzaXN0ZW5jZU1nciBpbnN0\nYW5jZW9mIFJlYWRBaGVhZENhY2hlKSB7CiAgICAgICAgICAgIHRoaXMuY2Fj\naGUgPSAoUmVhZEFoZWFkQ2FjaGUpIHBlcnNpc3RlbmNlTWdyOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuY2FjaGUgPSBudWxsOwogICAg\nICAgIH0KICAgICAgICBwZXJUb3BpY0RlbGl2ZXJ5UHRycyA9IG5ldyBIYXNo\nTWFwPEJ5dGVTdHJpbmcsIFNvcnRlZE1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vi\nc2NyaWJlclN0YXRlPj4+KCk7CiAgICAgICAgc3Vic2NyaWJlclN0YXRlcyA9\nIG5ldyBIYXNoTWFwPFRvcGljU3Vic2NyaWJlciwgQWN0aXZlU3Vic2NyaWJl\nclN0YXRlPigpOwogICAgICAgIHdvcmtlclRocmVhZCA9IG5ldyBUaHJlYWQo\ndGhpcywgIkRlbGl2ZXJ5TWFuYWdlclRocmVhZCIpOwogICAgICAgIHRoaXMu\nY2ZnID0gY2ZnOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0KCkgewog\nICAgICAgIHdvcmtlclRocmVhZC5zdGFydCgpOwogICAgfQoKICAgIC8qKgog\nICAgICogU3RvcCBGSUZPIGRlbGl2ZXJ5IG1hbmFnZXIgZnJvbSBwcm9jZXNz\naW5nIHJlcXVlc3RzLiAoZm9yIHRlc3RpbmcpCiAgICAgKi8KICAgIEBWaXNp\nYmxlRm9yVGVzdGluZwogICAgcHVibGljIHZvaWQgc3VzcGVuZFByb2Nlc3Np\nbmcoKSB7CiAgICAgICAgc3luY2hyb25pemVkKHN1c3BlbnNpb25Mb2NrKSB7\nCiAgICAgICAgICAgIHN1c3BlbmRlZCA9IHRydWU7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogUmVzdW1lIEZJRk8gZGVsaXZlcnkgbWFuYWdl\nci4gKGZvciB0ZXN0aW5nKQogICAgICovCiAgICBAVmlzaWJsZUZvclRlc3Rp\nbmcKICAgIHB1YmxpYyB2b2lkIHJlc3VtZVByb2Nlc3NpbmcoKSB7CiAgICAg\nICAgc3luY2hyb25pemVkKHN1c3BlbnNpb25Mb2NrKSB7CiAgICAgICAgICAg\nIHN1c3BlbmRlZCA9IGZhbHNlOwogICAgICAgICAgICBzdXNwZW5zaW9uTG9j\nay5ub3RpZnkoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiA9\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT0gT3VyCiAgICAgKiB1c3VhbCBlbnF1\nZXVlIGZ1bmN0aW9uLCBzdG9wIGlmIGVycm9yIGJlY2F1c2Ugb2YgdW5ib3Vu\nZGVkIHF1ZXVlLCBzaG91bGQKICAgICAqIG5ldmVyIGhhcHBlbgogICAgICoK\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZW5xdWV1ZVdpdGhvdXRGYWls\ndXJlKERlbGl2ZXJ5TWFuYWdlclJlcXVlc3QgcmVxdWVzdCkgewogICAgICAg\nIGlmICghcmVxdWVzdFF1ZXVlLm9mZmVyKHJlcXVlc3QpKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBVbmV4cGVjdGVkRXJyb3IoIkNvdWxkIG5vdCBlbnF1\nZXVlIG9iamVjdDogIiArIHJlcXVlc3QgKyAiIHRvIGRlbGl2ZXJ5IG1hbmFn\nZXIgcmVxdWVzdCBxdWV1ZS4iKTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICogUHVibGlj\nIGludGVyZmFjZSBvZiB0aGUgZGVsaXZlcnkgbWFuYWdlcgogICAgICovCgog\nICAgLyoqCiAgICAgKiBUZWxscyB0aGUgZGVsaXZlcnkgbWFuYWdlciB0byBz\ndGFydCBzZW5kaW5nIG91dCBtZXNzYWdlcyBmb3IgYSBwYXJ0aWN1bGFyCiAg\nICAgKiBzdWJzY3JpcHRpb24KICAgICAqCiAgICAgKiBAcGFyYW0gdG9waWMK\nICAgICAqIEBwYXJhbSBzdWJzY3JpYmVySWQKICAgICAqIEBwYXJhbSBzZXFJ\nZFRvU3RhcnRGcm9tCiAgICAgKiAgICAgICAgICAgIE1lc3NhZ2Ugc2VxdWVu\nY2UtaWQgZnJvbSB3aGVyZSBkZWxpdmVyeSBzaG91bGQgYmUgc3RhcnRlZAog\nICAgICogQHBhcmFtIGVuZFBvaW50CiAgICAgKiAgICAgICAgICAgIFRoZSBk\nZWxpdmVyeSBlbmQgcG9pbnQgdG8gd2hpY2ggc2VuZCBtZXNzYWdlcyB0bwog\nICAgICogQHBhcmFtIGZpbHRlcgogICAgICogICAgICAgICAgICBPbmx5IG1l\nc3NhZ2VzIHBhc3NpbmcgdGhpcyBmaWx0ZXIgc2hvdWxkIGJlIHNlbnQgdG8g\ndGhpcwogICAgICogICAgICAgICAgICBzdWJzY3JpYmVyCiAgICAgKiBAcGFy\nYW0gY2FsbGJhY2sKICAgICAqICAgICAgICAgICAgQ2FsbGJhY2sgaW5zdGFu\nY2UKICAgICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgICAgQ2FsbGJh\nY2sgY29udGV4dAogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHN0YXJ0U2VydmluZ1N1YnNjcmlwdGlvbihCeXRlU3RyaW5nIHRvcGlj\nLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBTdWJzY3JpcHRpb25QcmVmZXJlbmNl\ncyBwcmVmZXJlbmNlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBNZXNzYWdlU2VxSWQgc2VxSWRUb1N0YXJ0RnJvbSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWxpdmVy\neUVuZFBvaW50IGVuZFBvaW50LCBTZXJ2ZXJNZXNzYWdlRmlsdGVyIGZpbHRl\nciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBD\nYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAgICAg\nIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBzdWJzY3JpYmVyID0gCiAgICAgICAg\nICAgIG5ldyBBY3RpdmVTdWJzY3JpYmVyU3RhdGUodG9waWMsIHN1YnNjcmli\nZXJJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBw\ncmVmZXJlbmNlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBzZXFJZFRvU3RhcnRGcm9tLmdldExvY2FsQ29tcG9uZW50KCkgLSAx\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZFBv\naW50LCBmaWx0ZXIsIGNhbGxiYWNrLCBjdHgpOwoKICAgICAgICBlbnF1ZXVl\nV2l0aG91dEZhaWx1cmUoc3Vic2NyaWJlcik7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc3RvcFNlcnZpbmdTdWJzY3JpYmVyKEJ5dGVTdHJpbmcgdG9waWMs\nIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIFN1YnNjcmlwdGlvbkV2ZW50IGV2ZW50LAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNr\nPFZvaWQ+IGNiLCBPYmplY3QgY3R4KSB7CiAgICAgICAgZW5xdWV1ZVdpdGhv\ndXRGYWlsdXJlKG5ldyBTdG9wU2VydmluZ1N1YnNjcmliZXIodG9waWMsIHN1\nYnNjcmliZXJJZCwgZXZlbnQsIGNiLCBjdHgpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEluc3RydWN0cyB0aGUgZGVsaXZlcnkgbWFuYWdlciB0byBiYWNr\nb2ZmIG9uIHRoZSBnaXZlbiBzdWJzY3JpYmVyIGFuZAogICAgICogcmV0cnkg\nc2VuZGluZyBhZnRlciBzb21lIHRpbWUKICAgICAqCiAgICAgKiBAcGFyYW0g\nc3Vic2NyaWJlcgogICAgICovCiAgICBwdWJsaWMgdm9pZCByZXRyeUVycm9y\nZWRTdWJzY3JpYmVyQWZ0ZXJEZWxheShBY3RpdmVTdWJzY3JpYmVyU3RhdGUg\nc3Vic2NyaWJlcikgewoKICAgICAgICBzdWJzY3JpYmVyLnNldExhc3RTY2Fu\nRXJyb3JUaW1lKE1hdGhVdGlscy5ub3coKSk7CgogICAgICAgIGlmICghcmV0\ncnlRdWV1ZS5vZmZlcihzdWJzY3JpYmVyKSkgewogICAgICAgICAgICB0aHJv\ndyBuZXcgVW5leHBlY3RlZEVycm9yKCJDb3VsZCBub3QgZW5xdWV1ZSB0byBk\nZWxpdmVyeSBtYW5hZ2VyIHJldHJ5IHF1ZXVlIik7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGNsZWFyUmV0cnlEZWxheUZvclN1YnNjcmli\nZXIoQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXIpIHsKICAgICAg\nICBzdWJzY3JpYmVyLmNsZWFyTGFzdFNjYW5FcnJvclRpbWUoKTsKICAgICAg\nICBpZiAoIXJldHJ5UXVldWUub2ZmZXIoc3Vic2NyaWJlcikpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRFcnJvcigiQ291bGQgbm90IGVu\ncXVldWUgdG8gZGVsaXZlcnkgbWFuYWdlciByZXRyeSBxdWV1ZSIpOwogICAg\nICAgIH0KICAgICAgICAvLyBubyByZXF1ZXN0IGluIHJlcXVlc3QgcXVldWUg\nbm93CiAgICAgICAgLy8gaXNzdWUgYSBlbXB0eSBkZWxpdmVyeSByZXF1ZXN0\nIHRvIG5vdCB3YWl0aW5nIGZvciBwb2xsaW5nIHJlcXVlc3RzIHF1ZXVlCiAg\nICAgICAgaWYgKHJlcXVlc3RRdWV1ZS5pc0VtcHR5KCkpIHsKICAgICAgICAg\nICAgZW5xdWV1ZVdpdGhvdXRGYWlsdXJlKG5ldyBEZWxpdmVyeU1hbmFnZXJS\nZXF1ZXN0KCkgewogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHBlcmZvcm1SZXF1ZXN0KCkg\newogICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8vIFRPRE86IGZvciBub3csIEkgZG9uJ3QgbW92ZSBt\nZXNzYWdlQ29uc3VtZWQgcmVxdWVzdCB0byBkZWxpdmVyeSBtYW5hZ2VyIHRo\ncmVhZCwKICAgIC8vICAgICAgIHdoaWNoIGlzIHN1cHBvc2VkIHRvIGJlIGZp\neGVkIGluIHtAbGluayBodHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2ppcmEv\nYnJvd3NlL0JPT0tLRUVQRVItNTAzfQogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgdm9pZCBtZXNzYWdlQ29uc3VtZWQoQnl0ZVN0cmluZyB0b3BpYywgQnl0\nZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgTWVzc2FnZVNlcUlkIGNvbnN1bWVkU2VxSWQpIHsKICAgICAg\nICBBY3RpdmVTdWJzY3JpYmVyU3RhdGUgc3ViU3RhdGUgPQogICAgICAgICAg\nICBzdWJzY3JpYmVyU3RhdGVzLmdldChuZXcgVG9waWNTdWJzY3JpYmVyKHRv\ncGljLCBzdWJzY3JpYmVySWQpKTsKICAgICAgICBpZiAobnVsbCA9PSBzdWJT\ndGF0ZSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAg\nIHN1YlN0YXRlLm1lc3NhZ2VDb25zdW1lZChjb25zdW1lZFNlcUlkLmdldExv\nY2FsQ29tcG9uZW50KCkpOyAKICAgIH0KCiAgICAvKioKICAgICAqIEluc3Ry\ndWN0cyB0aGUgZGVsaXZlcnkgbWFuYWdlciB0byBtb3ZlIHRoZSBkZWxpdmVy\neSBwb2ludGVyIGZvciBhIGdpdmVuCiAgICAgKiBzdWJzY3JpYmVyCiAgICAg\nKgogICAgICogQHBhcmFtIHN1YnNjcmliZXIKICAgICAqIEBwYXJhbSBwcmV2\nU2VxSWQKICAgICAqIEBwYXJhbSBuZXdTZXFJZAogICAgICovCiAgICBwdWJs\naWMgdm9pZCBtb3ZlRGVsaXZlcnlQdHJGb3J3YXJkKEFjdGl2ZVN1YnNjcmli\nZXJTdGF0ZSBzdWJzY3JpYmVyLCBsb25nIHByZXZTZXFJZCwgbG9uZyBuZXdT\nZXFJZCkgewogICAgICAgIGVucXVldWVXaXRob3V0RmFpbHVyZShuZXcgRGVs\naXZlcnlQdHJNb3ZlKHN1YnNjcmliZXIsIHByZXZTZXFJZCwgbmV3U2VxSWQp\nKTsKICAgIH0KCiAgICAvKgogICAgICogPT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT0KICAgICAqID09IEVuZCBvZiBwdWJsaWMgaW50ZXJmYWNlLCBp\nbnRlcm5hbCBtYWNoaW5lcnkgYmVnaW5zLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBydW4oKSB7CiAgICAgICAgd2hpbGUgKGtlZXBSdW5uaW5nKSB7CiAg\nICAgICAgICAgIERlbGl2ZXJ5TWFuYWdlclJlcXVlc3QgcmVxdWVzdCA9IG51\nbGw7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gV2Ug\ndXNlIGEgdGltZW91dCBvZiAxIHNlY29uZCwgc28gdGhhdCB3ZSBjYW4gd2Fr\nZSB1cCBvbmNlIGluCiAgICAgICAgICAgICAgICAvLyBhIHdoaWxlIHRvIGNo\nZWNrIGlmIHRoZXJlIGlzIHNvbWV0aGluZyBpbiB0aGUgcmV0cnkgcXVldWUu\nCiAgICAgICAgICAgICAgICByZXF1ZXN0ID0gcmVxdWVzdFF1ZXVlLnBvbGwo\nMSwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAgICAgICAgICAgICBzeW5jaHJv\nbml6ZWQoc3VzcGVuc2lvbkxvY2spIHsKICAgICAgICAgICAgICAgICAgICB3\naGlsZSAoc3VzcGVuZGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1\nc3BlbnNpb25Mb2NrLndhaXQoKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVw\ndGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIFRocmVhZC5jdXJy\nZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIC8vIEZpcnN0IHJldHJ5IGFueSBzdWJzY3JpcHRpb25zIHRoYXQg\naGFkIGZhaWxlZCBhbmQgbmVlZCBhIHJldHJ5CiAgICAgICAgICAgIHJldHJ5\nRXJyb3JlZFN1YnNjcmliZXJzKCk7CgogICAgICAgICAgICBpZiAocmVxdWVz\ndCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcmVxdWVzdC5wZXJmb3JtUmVxdWVzdCgp\nOwoKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9wIG1ldGhv\nZCB3aGljaCB3aWxsIGVucXVldWUgYSBTaHV0ZG93bkRlbGl2ZXJ5TWFuYWdl\nclJlcXVlc3QuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHN0b3AoKSB7CiAg\nICAgICAgZW5xdWV1ZVdpdGhvdXRGYWlsdXJlKG5ldyBTaHV0ZG93bkRlbGl2\nZXJ5TWFuYWdlclJlcXVlc3QoKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZv\naWQgcmV0cnlFcnJvcmVkU3Vic2NyaWJlcnMoKSB7CiAgICAgICAgbG9uZyBs\nYXN0SW50ZXJlc3RpbmdGYWlsdXJlVGltZSA9IE1hdGhVdGlscy5ub3coKSAt\nIGNmZy5nZXRTY2FuQmFja29mZlBlcmlvZE1zKCk7CiAgICAgICAgQWN0aXZl\nU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXI7CgogICAgICAgIHdoaWxlICgo\nc3Vic2NyaWJlciA9IHJldHJ5UXVldWUucGVlaygpKSAhPSBudWxsKSB7CiAg\nICAgICAgICAgIGlmIChzdWJzY3JpYmVyLmdldExhc3RTY2FuRXJyb3JUaW1l\nKCkgPiBsYXN0SW50ZXJlc3RpbmdGYWlsdXJlVGltZSkgewogICAgICAgICAg\nICAgICAgLy8gTm90IGVub3VnaCB0aW1lIGhhcyBlbGFwc2VkIHlldCwgd2ls\nbCByZXRyeSBsYXRlcgogICAgICAgICAgICAgICAgLy8gU2luY2UgdGhlIHF1\nZXVlIGlzIGZpZm8sIG5vIG5lZWQgdG8gY2hlY2sgbGF0ZXIgaXRlbXMKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gcmV0cnkgbm93CiAgICAgICAgICAgIHN1YnNjcmliZXIuZGVsaXZl\nck5leHRNZXNzYWdlKCk7CiAgICAgICAgICAgIHJldHJ5UXVldWUucG9sbCgp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCByZW1vdmVE\nZWxpdmVyeVB0cihBY3RpdmVTdWJzY3JpYmVyU3RhdGUgc3Vic2NyaWJlciwg\nTG9uZyBzZXFJZCwgYm9vbGVhbiBpc0Fic2VuY2VPaywKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4gcHJ1bmVUb3BpYykg\newoKICAgICAgICBhc3NlcnQgc2VxSWQgIT0gbnVsbDsKCiAgICAgICAgLy8g\ncmVtb3ZlIHRoaXMgc3Vic2NyaWJlciBmcm9tIHRoZSBkZWxpdmVyeSBwb2lu\ndGVycyBkYXRhIHN0cnVjdHVyZQogICAgICAgIEJ5dGVTdHJpbmcgdG9waWMg\nPSBzdWJzY3JpYmVyLmdldFRvcGljKCk7CiAgICAgICAgU29ydGVkTWFwPExv\nbmcsIFNldDxBY3RpdmVTdWJzY3JpYmVyU3RhdGU+PiBkZWxpdmVyeVB0cnMg\nPSBwZXJUb3BpY0RlbGl2ZXJ5UHRycy5nZXQodG9waWMpOwoKICAgICAgICBp\nZiAoZGVsaXZlcnlQdHJzID09IG51bGwgJiYgIWlzQWJzZW5jZU9rKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBVbmV4cGVjdGVkRXJyb3IoIk5vIGRlbGl2\nZXJ5IHBvaW50ZXJzIGZvdW5kIHdoaWxlIGRpc2Nvbm5lY3RpbmcgIiArICJj\naGFubmVsIGZvciB0b3BpYzoiICsgdG9waWMpOwogICAgICAgIH0KCiAgICAg\nICAgaWYobnVsbCA9PSBkZWxpdmVyeVB0cnMpIHsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFNYXBNZXRob2RzLnJlbW92\nZUZyb21NdWx0aU1hcChkZWxpdmVyeVB0cnMsIHNlcUlkLCBzdWJzY3JpYmVy\nKSAmJiAhaXNBYnNlbmNlT2spIHsKCiAgICAgICAgICAgIHRocm93IG5ldyBV\nbmV4cGVjdGVkRXJyb3IoIkNvdWxkIG5vdCBmaW5kIHN1YnNjcmliZXI6IiAr\nIHN1YnNjcmliZXIgKyAiIGF0IHRoZSBleHBlY3RlZCBkZWxpdmVyeSBwb2lu\ndGVyIik7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJ1bmVUb3BpYyAmJiBk\nZWxpdmVyeVB0cnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIHBlclRvcGlj\nRGVsaXZlcnlQdHJzLnJlbW92ZSh0b3BpYyk7CiAgICAgICAgfQoKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgbG9uZyBnZXRNaW5pbXVtU2VxSWQoQnl0ZVN0cmlu\nZyB0b3BpYykgewogICAgICAgIFNvcnRlZE1hcDxMb25nLCBTZXQ8QWN0aXZl\nU3Vic2NyaWJlclN0YXRlPj4gZGVsaXZlcnlQdHJzID0gcGVyVG9waWNEZWxp\ndmVyeVB0cnMuZ2V0KHRvcGljKTsKCiAgICAgICAgaWYgKGRlbGl2ZXJ5UHRy\ncyA9PSBudWxsIHx8IGRlbGl2ZXJ5UHRycy5pc0VtcHR5KCkpIHsKICAgICAg\nICAgICAgcmV0dXJuIExvbmcuTUFYX1ZBTFVFIC0gMTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIGRlbGl2ZXJ5UHRycy5maXJzdEtleSgpOwogICAgfQoK\nICAgIHByb3RlY3RlZCB2b2lkIGFkZERlbGl2ZXJ5UHRyKEFjdGl2ZVN1YnNj\ncmliZXJTdGF0ZSBzdWJzY3JpYmVyLCBMb25nIHNlcUlkKSB7CgogICAgICAg\nIC8vIElmIHRoaXMgdG9waWMgZG9lc24ndCBleGlzdCBpbiB0aGUgcGVyLXRv\ncGljIGRlbGl2ZXJ5IHBvaW50ZXJzIHRhYmxlLAogICAgICAgIC8vIGNyZWF0\nZSBhbiBlbnRyeSBmb3IgaXQKICAgICAgICBTb3J0ZWRNYXA8TG9uZywgU2V0\nPEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4+IGRlbGl2ZXJ5UHRycyA9IE1hcE1l\ndGhvZHMuZ2V0QWZ0ZXJJbnNlcnRpbmdJZkFic2VudCgKICAgICAgICAgICAg\nICAgICAgICBwZXJUb3BpY0RlbGl2ZXJ5UHRycywgc3Vic2NyaWJlci5nZXRU\nb3BpYygpLCBUcmVlTWFwTG9uZ1RvU2V0U3Vic2NyaWJlckZhY3RvcnkuaW5z\ndGFuY2UpOwoKICAgICAgICBNYXBNZXRob2RzLmFkZFRvTXVsdGlNYXAoZGVs\naXZlcnlQdHJzLCBzZXFJZCwgc3Vic2NyaWJlciwgSGFzaE1hcFN1YnNjcmli\nZXJGYWN0b3J5Lmluc3RhbmNlKTsKICAgIH0KCiAgICBwdWJsaWMgY2xhc3Mg\nQWN0aXZlU3Vic2NyaWJlclN0YXRlCiAgICAgICAgaW1wbGVtZW50cyBTY2Fu\nQ2FsbGJhY2ssIERlbGl2ZXJ5Q2FsbGJhY2ssIERlbGl2ZXJ5TWFuYWdlclJl\ncXVlc3QsIENhbmNlbFNjYW5SZXF1ZXN0IHsKCiAgICAgICAgc3RhdGljIGZp\nbmFsIGludCBVTkxJTUlURUQgPSAwOwoKICAgICAgICBCeXRlU3RyaW5nIHRv\ncGljOwogICAgICAgIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkOwogICAgICAg\nIGxvbmcgbGFzdExvY2FsU2VxSWREZWxpdmVyZWQ7CiAgICAgICAgYm9vbGVh\nbiBjb25uZWN0ZWQgPSB0cnVlOwogICAgICAgIFJlZW50cmFudFJlYWRXcml0\nZUxvY2sgY29ubmVjdGVkTG9jayA9IG5ldyBSZWVudHJhbnRSZWFkV3JpdGVM\nb2NrKCk7CiAgICAgICAgRGVsaXZlcnlFbmRQb2ludCBkZWxpdmVyeUVuZFBv\naW50OwogICAgICAgIGxvbmcgbGFzdFNjYW5FcnJvclRpbWUgPSAtMTsKICAg\nICAgICBsb25nIGxvY2FsU2VxSWREZWxpdmVyaW5nTm93OwogICAgICAgIGxv\nbmcgbGFzdFNlcUlkQ29tbXVuaWNhdGVkRXh0ZXJuYWxseTsKICAgICAgICBs\nb25nIGxhc3RTZXFJZENvbnN1bWVkVXRpbDsKICAgICAgICBib29sZWFuIGlz\nVGhyb3R0bGVkID0gZmFsc2U7CiAgICAgICAgZmluYWwgaW50IG1lc3NhZ2VX\naW5kb3dTaXplOwogICAgICAgIFNlcnZlck1lc3NhZ2VGaWx0ZXIgZmlsdGVy\nOwogICAgICAgIENhbGxiYWNrPFZvaWQ+IGNiOwogICAgICAgIE9iamVjdCBj\ndHg7CgogICAgICAgIC8vIHRyYWNrIHRoZSBvdXRzdGFuZGluZyBzY2FuIHJl\ncXVlc3QKICAgICAgICAvLyBzbyB3ZSBjb3VsZCBjYW5jZWwgaXQKICAgICAg\nICBTY2FuUmVxdWVzdCBvdXRzdGFuZGluZ1NjYW5SZXF1ZXN0OwoKICAgICAg\nICBmaW5hbCBzdGF0aWMgaW50IFNFUV9JRF9TTEFDSyA9IDEwOwoKICAgICAg\nICBwdWJsaWMgQWN0aXZlU3Vic2NyaWJlclN0YXRlKEJ5dGVTdHJpbmcgdG9w\naWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgU3Vic2NyaXB0aW9uUHJlZmVyZW5jZXMg\ncHJlZmVyZW5jZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBsb25nIGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVsaXZlcnlFbmRQb2ludCBk\nZWxpdmVyeUVuZFBvaW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgU2VydmVyTWVzc2FnZUZpbHRlciBmaWx0ZXIsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjazxWb2lkPiBj\nYiwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICB0aGlzLnRvcGljID0gdG9w\naWM7CiAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcklkID0gc3Vic2NyaWJl\ncklkOwogICAgICAgICAgICB0aGlzLmxhc3RMb2NhbFNlcUlkRGVsaXZlcmVk\nID0gbGFzdExvY2FsU2VxSWREZWxpdmVyZWQ7CiAgICAgICAgICAgIHRoaXMu\nbGFzdFNlcUlkQ29uc3VtZWRVdGlsID0gbGFzdExvY2FsU2VxSWREZWxpdmVy\nZWQ7CiAgICAgICAgICAgIHRoaXMuZGVsaXZlcnlFbmRQb2ludCA9IGRlbGl2\nZXJ5RW5kUG9pbnQ7CiAgICAgICAgICAgIHRoaXMuZmlsdGVyID0gZmlsdGVy\nOwogICAgICAgICAgICBpZiAocHJlZmVyZW5jZXMuaGFzTWVzc2FnZVdpbmRv\nd1NpemUoKSkgewogICAgICAgICAgICAgICAgbWVzc2FnZVdpbmRvd1NpemUg\nPSBwcmVmZXJlbmNlcy5nZXRNZXNzYWdlV2luZG93U2l6ZSgpOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKEZJRk9EZWxpdmVy\neU1hbmFnZXIudGhpcy5jZmcuZ2V0RGVmYXVsdE1lc3NhZ2VXaW5kb3dTaXpl\nKCkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVdpbmRvd1Np\nemUgPQogICAgICAgICAgICAgICAgICAgICAgICBGSUZPRGVsaXZlcnlNYW5h\nZ2VyLnRoaXMuY2ZnLmdldERlZmF1bHRNZXNzYWdlV2luZG93U2l6ZSgpOwog\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBt\nZXNzYWdlV2luZG93U2l6ZSA9IFVOTElNSVRFRDsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmNiID0gY2I7CiAg\nICAgICAgICAgIHRoaXMuY3R4ID0gY3R4OwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgc2V0Tm90Q29ubmVjdGVkKFN1YnNjcmlwdGlvbkV2ZW50\nIGV2ZW50KSB7CiAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkTG9jay53cml0\nZUxvY2soKS5sb2NrKCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAvLyBoYXZlIGNsb3NlZCBpdC4KICAgICAgICAgICAgICAgIGlmICgh\nY29ubmVjdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5jb25uZWN0ZWQg\nPSBmYWxzZTsKICAgICAgICAgICAgICAgIC8vIHB1dCBpdHNlbGYgaW4gUmVh\nZEFoZWFkIHF1ZXVlIHRvIGNhbmNlbCBvdXRzdGFuZGluZyBzY2FuIHJlcXVl\nc3QKICAgICAgICAgICAgICAgIC8vIGlmIG91dHN0YW5kaW5nIHNjYW4gcmVx\ndWVzdCBjYWxsYmFjayBiZWZvcmUgY2FuY2VsIG9wIGV4ZWN1dGVkLAogICAg\nICAgICAgICAgICAgLy8gbm90aGluZyBpdCB3b3VsZCBjYW5jZWwuCiAgICAg\nICAgICAgICAgICBpZiAobnVsbCAhPSBjYWNoZSAmJiBudWxsICE9IG91dHN0\nYW5kaW5nU2NhblJlcXVlc3QpIHsKICAgICAgICAgICAgICAgICAgICBjYWNo\nZS5jYW5jZWxTY2FuUmVxdWVzdCh0b3BpYywgdGhpcyk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICB0aGlzLmNvbm5lY3RlZExvY2sud3JpdGVMb2NrKCkudW5sb2NrKCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChudWxsICE9IGV2ZW50ICYm\nCiAgICAgICAgICAgICAgICAoU3Vic2NyaXB0aW9uRXZlbnQuVE9QSUNfTU9W\nRUQgPT0gZXZlbnQgfHwKICAgICAgICAgICAgICAgICBTdWJzY3JpcHRpb25F\ndmVudC5TVUJTQ1JJUFRJT05fRk9SQ0VEX0NMT1NFRCA9PSBldmVudCkpIHsK\nICAgICAgICAgICAgICAgIC8vIHdlIHNob3VsZCBub3QgY2xvc2UgdGhlIGNo\nYW5uZWwgbm93IGFmdGVyIGVuYWJsaW5nIG11bHRpcGxleGluZwogICAgICAg\nICAgICAgICAgUHViU3ViUmVzcG9uc2UgcmVzcG9uc2UgPSBQdWJTdWJSZXNw\nb25zZVV0aWxzLmdldFJlc3BvbnNlRm9yU3Vic2NyaXB0aW9uRXZlbnQoCiAg\nICAgICAgICAgICAgICAgICAgdG9waWMsIHN1YnNjcmliZXJJZCwgZXZlbnQK\nICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBkZWxpdmVyeUVu\nZFBvaW50LnNlbmQocmVzcG9uc2UsIG5ldyBEZWxpdmVyeUNhbGxiYWNrKCkg\newogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNlbmRpbmdGaW5pc2hlZCgpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZyBub3cKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgdHJhbnNpZW50RXJyb3JP\nblNlbmQoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhp\nbmcgbm93CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHBlcm1hbmVudEVycm9yT25TZW5kKCkgewogICAgICAgICAgICAgICAgICAg\nICAgICAvLyBpZiBjaGFubmVsIGlzIGJyb2tlbiwgY2xvc2UgdGhlIGNoYW5u\nZWwKICAgICAgICAgICAgICAgICAgICAgICAgZGVsaXZlcnlFbmRQb2ludC5j\nbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHVuaW5pdGlhbGl6\nZSBmaWx0ZXIKICAgICAgICAgICAgdGhpcy5maWx0ZXIudW5pbml0aWFsaXpl\nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQnl0ZVN0cmluZyBnZXRU\nb3BpYygpIHsKICAgICAgICAgICAgcmV0dXJuIHRvcGljOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHN5bmNocm9uaXplZCBsb25nIGdldExhc3RTY2Fu\nRXJyb3JUaW1lKCkgewogICAgICAgICAgICByZXR1cm4gbGFzdFNjYW5FcnJv\nclRpbWU7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgc3luY2hyb25pemVk\nIHZvaWQgc2V0TGFzdFNjYW5FcnJvclRpbWUobG9uZyBsYXN0U2NhbkVycm9y\nVGltZSkgewogICAgICAgICAgICB0aGlzLmxhc3RTY2FuRXJyb3JUaW1lID0g\nbGFzdFNjYW5FcnJvclRpbWU7CiAgICAgICAgfQoKICAgICAgICAvKioKICAg\nICAgICAgKiBDbGVhciB0aGUgbGFzdCBzY2FuIGVycm9yIHRpbWUgc28gaXQg\nY291bGQgYmUgcmV0cnkgaW1tZWRpYXRlbHkuCiAgICAgICAgICovCiAgICAg\nICAgcHJvdGVjdGVkIHN5bmNocm9uaXplZCB2b2lkIGNsZWFyTGFzdFNjYW5F\ncnJvclRpbWUoKSB7CiAgICAgICAgICAgIHRoaXMubGFzdFNjYW5FcnJvclRp\nbWUgPSAtMTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBib29sZWFu\nIGlzQ29ubmVjdGVkKCkgewogICAgICAgICAgICBjb25uZWN0ZWRMb2NrLnJl\nYWRMb2NrKCkubG9jaygpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgcmV0dXJuIGNvbm5lY3RlZDsKICAgICAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgICAgIGNvbm5lY3RlZExvY2sucmVhZExvY2soKS51\nbmxvY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIHN5bmNocm9uaXplZCB2b2lkIG1lc3NhZ2VDb25zdW1lZChsb25n\nIG5ld1NlcUlkQ29uc3VtZWQpIHsKICAgICAgICAgICAgaWYgKG5ld1NlcUlk\nQ29uc3VtZWQgPD0gbGFzdFNlcUlkQ29uc3VtZWRVdGlsKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBs\nb2dnZXIuZGVidWcoIlN1YnNjcmliZXIgKHt9KSBtb3ZlZCBjb25zdW1lZCBw\ndHIgZnJvbSB7fSB0byB7fS4iLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHZhKHRoaXMsIGxhc3RTZXFJZENvbnN1bWVkVXRpbCwgbmV3U2VxSWRD\nb25zdW1lZCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxhc3RTZXFJ\nZENvbnN1bWVkVXRpbCA9IG5ld1NlcUlkQ29uc3VtZWQ7CiAgICAgICAgICAg\nIC8vIGFmdGVyIHVwZGF0ZWQgc2VxIGlkIGNoZWNrIHdoZXRoZXIgaXQgc3Rp\nbGwgZXhjZWVkIG1zZyBsaW1pdGF0aW9uCiAgICAgICAgICAgIGlmIChtc2dM\naW1pdEV4Y2VlZGVkKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgfQogICAgICAgICAgICBpZiAoaXNUaHJvdHRsZWQpIHsKICAg\nICAgICAgICAgICAgIGlzVGhyb3R0bGVkID0gZmFsc2U7CiAgICAgICAgICAg\nICAgICBsb2dnZXIuaW5mbygiVHJ5IHRvIHdha2UgdXAgc3Vic2NyaWJlciAo\ne30pIHRvIGRlbGl2ZXIgbWVzc2FnZXMgYWdhaW4gOiBsYXN0IGRlbGl2ZXJl\nZCB7fSwgbGFzdCBjb25zdW1lZCB7fS4iLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdmEodGhpcywgbGFzdExvY2FsU2VxSWREZWxpdmVyZWQsIGxh\nc3RTZXFJZENvbnN1bWVkVXRpbCkpOwoKICAgICAgICAgICAgICAgIGVucXVl\ndWVXaXRob3V0RmFpbHVyZShuZXcgRGVsaXZlcnlNYW5hZ2VyUmVxdWVzdCgp\nIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVxdWVzdCgpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gZW5xdWV1ZSAKICAgICAgICAgICAgICAg\nICAgICAgICAgY2xlYXJSZXRyeURlbGF5Rm9yU3Vic2NyaWJlcihBY3RpdmVT\ndWJzY3JpYmVyU3RhdGUudGhpcyk7ICAgICAgICAgICAgCiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBib29sZWFuIG1zZ0xpbWl0\nRXhjZWVkZWQoKSB7CiAgICAgICAgICAgIGlmIChtZXNzYWdlV2luZG93U2l6\nZSA9PSBVTkxJTUlURUQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobGFzdExvY2FsU2Vx\nSWREZWxpdmVyZWQgLSBsYXN0U2VxSWRDb25zdW1lZFV0aWwgPj0gbWVzc2Fn\nZVdpbmRvd1NpemUpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGRlbGl2ZXJOZXh0TWVzc2FnZSgp\nIHsKICAgICAgICAgICAgY29ubmVjdGVkTG9jay5yZWFkTG9jaygpLmxvY2so\nKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGRvRGVsaXZl\nck5leHRNZXNzYWdlKCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICBjb25uZWN0ZWRMb2NrLnJlYWRMb2NrKCkudW5sb2NrKCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZhdGUgdm9p\nZCBkb0RlbGl2ZXJOZXh0TWVzc2FnZSgpIHsKICAgICAgICAgICAgaWYgKCFj\nb25uZWN0ZWQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAg\nICAgICAgICAgICAvLyBjaGVjayB3aGV0aGVyIHdlIGhhdmUgZGVsaXZlcmVk\nIGVub3VnaCBtZXNzYWdlcyB3aXRob3V0IHJlY2VpdmluZyB0aGVpciBjb25z\ndW1lcwogICAgICAgICAgICAgICAgaWYgKG1zZ0xpbWl0RXhjZWVkZWQoKSkg\newogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJTdWJzY3JpYmVy\nICh7fSkgaXMgdGhyb3R0bGVkIDogbGFzdCBkZWxpdmVyZWQge30sIGxhc3Qg\nY29uc3VtZWQge30uIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB2YSh0aGlzLCBsYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCwgbGFzdFNlcUlk\nQ29uc3VtZWRVdGlsKSk7CiAgICAgICAgICAgICAgICAgICAgaXNUaHJvdHRs\nZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcs\nIHNpbmNlIHRoZSBkZWxpdmVyeSBwcm9jZXNzIHdvdWxkIGJlIHRocm90dGxl\nZC4KICAgICAgICAgICAgICAgICAgICAvLyBBZnRlciBtZXNzYWdlIGNvbnN1\nbWVkLCBpdCB3b3VsZCBiZSBhZGRlZCBiYWNrIHRvIHJldHJ5IHF1ZXVlLgog\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgICAgICBsb2NhbFNlcUlkRGVsaXZlcmluZ05vdyA9IHBl\ncnNpc3RlbmNlTWdyLmdldFNlcUlkQWZ0ZXJTa2lwcGluZyh0b3BpYywgbGFz\ndExvY2FsU2VxSWREZWxpdmVyZWQsIDEpOwoKICAgICAgICAgICAgICAgIG91\ndHN0YW5kaW5nU2NhblJlcXVlc3QgPSBuZXcgU2NhblJlcXVlc3QodG9waWMs\nIGxvY2FsU2VxSWREZWxpdmVyaW5nTm93LAogICAgICAgICAgICAgICAgICAg\nICAgICAvKiBjYWxsYmFjaz0gKi90aGlzLCAvKiBjdHg9ICovbnVsbCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHBlcnNpc3RlbmNlTWdyLnNjYW5T\naW5nbGVNZXNzYWdlKG91dHN0YW5kaW5nU2NhblJlcXVlc3QpOwogICAgICAg\nIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogPT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nCiAgICAgICAgICoge0BsaW5rIENhbmNlbFNjYW5SZXF1ZXN0fSBtZXRob2Rz\nCiAgICAgICAgICoKICAgICAgICAgKiBUaGlzIG1ldGhvZCBydW5zIGlucyBz\nYW1lIHRocmVhZHMgd2l0aCBTY2FuQ2FsbGJhY2suIFdoZW4gaXQgcnVucywK\nICAgICAgICAgKiBpdCBjaGVja2VkIHdoZXRoZXIgaXQgaXMgb3V0c3RhbmRp\nbmcgc2NhbiByZXF1ZXN0LiBpZiB0aGVyZSBpcyBvbmUsCiAgICAgICAgICog\nY2FuY2VsIGl0LgogICAgICAgICAqLwogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyBTY2FuUmVxdWVzdCBnZXRTY2FuUmVxdWVzdCgpIHsKICAg\nICAgICAgICAgLy8gbm8gcmFjZSBiZXR3ZWVuIGNhbmNlbCByZXF1ZXN0IGFu\nZCBzY2FuIGNhbGxiYWNrCiAgICAgICAgICAgIC8vIHRoZSBvbmx5IHJhY2Ug\naXMgYmV0d2VlbiBzdG9wU2VydmluZyBhbmQgZGVsaXZlck5leHRNZXNzYWdl\nCiAgICAgICAgICAgIC8vIGRlbGl2ZXJOZXh0TWVzc2FnZSB3b3VsZCBiZSBl\neGVjdXRlZCBpbiBuZXR0eSBjYWxsYmFjayB3aGljaCBpcyBpbiBuZXR0eSB0\naHJlYWQKICAgICAgICAgICAgLy8gc3RvcFNlcnZpbmcgaXMgcnVuIGluIGRl\nbGl2ZXJ5IHRocmVhZC4gaWYgc3RvcFNlcnZpbmcgcnVucyBiZWZvcmUgZGVs\naXZlck5leHRNZXNzYWdlCiAgICAgICAgICAgIC8vIGRlbGl2ZXJOZXh0TWVz\nc2FnZSB3b3VsZCBoYXZlIGNoYW5jZSB0byBwdXQgYSBzdHViIGluIFJlYWRB\naGVhZENhY2hlCiAgICAgICAgICAgIC8vIHRoZW4gd2UgZG9uJ3QgaGF2ZSBh\nbnkgY2hhbmNlIHRvIGNhbmNlbCBpdC4KICAgICAgICAgICAgLy8gdXNlIGNv\nbm5lY3RlZExvY2sgdG8gYXZvaWQgc3VjaCByYWNlLgogICAgICAgICAgICBy\nZXR1cm4gb3V0c3RhbmRpbmdTY2FuUmVxdWVzdDsKICAgICAgICB9CgogICAg\nICAgIHByaXZhdGUgYm9vbGVhbiBjaGVja0Nvbm5lY3RlZCgpIHsKICAgICAg\nICAgICAgY29ubmVjdGVkTG9jay5yZWFkTG9jaygpLmxvY2soKTsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIG1lc3NhZ2Ugc2Nhbm5l\nZCBtZWFucyB0aGUgb3V0c3RhbmRpbmcgcmVxdWVzdCBpcyBleGVjdXRlZAog\nICAgICAgICAgICAgICAgb3V0c3RhbmRpbmdTY2FuUmVxdWVzdCA9IG51bGw7\nCiAgICAgICAgICAgICAgICByZXR1cm4gY29ubmVjdGVkOwogICAgICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgY29ubmVjdGVkTG9jay5y\nZWFkTG9jaygpLnVubG9jaygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICAvKioKICAgICAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAg\nICAgICAgKiB7QGxpbmsgU2NhbkNhbGxiYWNrfSBtZXRob2RzCiAgICAgICAg\nICovCgogICAgICAgIHB1YmxpYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVj\ndCBjdHgsIE1lc3NhZ2UgbWVzc2FnZSkgewogICAgICAgICAgICBpZiAoIWNo\nZWNrQ29ubmVjdGVkKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFmaWx0ZXIudGVzdE1lc3Nh\nZ2UobWVzc2FnZSkpIHsKICAgICAgICAgICAgICAgIHNlbmRpbmdGaW5pc2hl\nZCgpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICAvKioKICAgICAgICAgICAgICogVGhlIG1ldGhvZCBiZWxv\ndyB3aWxsIGludm9rZSBvdXIgc2VuZGluZ0ZpbmlzaGVkKCkgbWV0aG9kIHdo\nZW4KICAgICAgICAgICAgICogZG9uZQogICAgICAgICAgICAgKi8KICAgICAg\nICAgICAgUHViU3ViUmVzcG9uc2UgcmVzcG9uc2UgPSBQdWJTdWJSZXNwb25z\nZS5uZXdCdWlsZGVyKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAuc2V0UHJvdG9jb2xWZXJzaW9uKFByb3RvY29sVmVyc2lvbi5W\nRVJTSU9OX09ORSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAuc2V0U3RhdHVzQ29kZShTdGF0dXNDb2RlLlNVQ0NFU1MpLnNldFR4\nbklkKDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLnNldE1lc3NhZ2UobWVzc2FnZSkuc2V0VG9waWModG9waWMpCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFN1YnNjcmliZXJJ\nZChzdWJzY3JpYmVySWQpLmJ1aWxkKCk7CgogICAgICAgICAgICBkZWxpdmVy\neUVuZFBvaW50LnNlbmQocmVzcG9uc2UsIC8vCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAvLyBjYWxsYmFjayA9CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB0aGlzKTsKCiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBzY2FuRmFpbGVkKE9iamVjdCBjdHgsIEV4Y2VwdGlv\nbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgaWYgKCFjaGVja0Nvbm5lY3Rl\nZCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIC8vIHdhaXQgZm9yIHNvbWUgdGltZSBhbmQgdGhlbiBy\nZXRyeQogICAgICAgICAgICByZXRyeUVycm9yZWRTdWJzY3JpYmVyQWZ0ZXJE\nZWxheSh0aGlzKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNj\nYW5GaW5pc2hlZChPYmplY3QgY3R4LCBSZWFzb25Gb3JGaW5pc2ggcmVhc29u\nKSB7CiAgICAgICAgICAgIGNoZWNrQ29ubmVjdGVkKCk7CiAgICAgICAgfQoK\nICAgICAgICAvKioKICAgICAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAg\nICAgICAgKiB7QGxpbmsgRGVsaXZlcnlDYWxsYmFja30gbWV0aG9kcwogICAg\nICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIHNlbmRpbmdGaW5pc2hlZCgp\nIHsKICAgICAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCgpKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN5\nbmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICAgICAgbGFzdExvY2Fs\nU2VxSWREZWxpdmVyZWQgPSBsb2NhbFNlcUlkRGVsaXZlcmluZ05vdzsKCiAg\nICAgICAgICAgICAgICBpZiAobGFzdExvY2FsU2VxSWREZWxpdmVyZWQgPiBs\nYXN0U2VxSWRDb21tdW5pY2F0ZWRFeHRlcm5hbGx5ICsgU0VRX0lEX1NMQUNL\nKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogVGhlIG9yZGVyIG9m\nIHRoZSBuZXh0IDIgc3RhdGVtZW50cyBpcyBpbXBvcnRhbnQuIFdlIHNob3Vs\nZAogICAgICAgICAgICAgICAgICAgIC8vIHN1Ym1pdCBhIHJlcXVlc3QgdG8g\nY2hhbmdlIG91ciBkZWxpdmVyeSBwb2ludGVyIG9ubHkgKmFmdGVyKiB3ZQog\nICAgICAgICAgICAgICAgICAgIC8vIGhhdmUgYWN0dWFsbHkgY2hhbmdlZCBp\ndC4gT3RoZXJ3aXNlLCB0aGVyZSBpcyBhIHJhY2UgY29uZGl0aW9uCiAgICAg\nICAgICAgICAgICAgICAgLy8gd2l0aCByZW1vdmFsIG9mIHRoaXMgY2hhbm5l\nbCwgdy5yLnQsIG1haW50YWluaW5nIHRoZSBkZWxpdmVyeVB0cnMKICAgICAg\nICAgICAgICAgICAgICAvLyB0cmVlIG1hcC4KICAgICAgICAgICAgICAgICAg\nICBsb25nIHByZXZJZCA9IGxhc3RTZXFJZENvbW11bmljYXRlZEV4dGVybmFs\nbHk7CiAgICAgICAgICAgICAgICAgICAgbGFzdFNlcUlkQ29tbXVuaWNhdGVk\nRXh0ZXJuYWxseSA9IGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkOwogICAgICAg\nICAgICAgICAgICAgIG1vdmVEZWxpdmVyeVB0ckZvcndhcmQodGhpcywgcHJl\ndklkLCBsYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gaW5jcmVtZW50IGRl\nbGl2ZXJpZWQgbWVzc2FnZQogICAgICAgICAgICBTZXJ2ZXJTdGF0cy5nZXRJ\nbnN0YW5jZSgpLmluY3JlbWVudE1lc3NhZ2VzRGVsaXZlcmVkKCk7CiAgICAg\nICAgICAgIGRlbGl2ZXJOZXh0TWVzc2FnZSgpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIHN5bmNocm9uaXplZCBsb25nIGdldExhc3RTZXFJZENvbW11\nbmljYXRlZEV4dGVybmFsbHkoKSB7CiAgICAgICAgICAgIHJldHVybiBsYXN0\nU2VxSWRDb21tdW5pY2F0ZWRFeHRlcm5hbGx5OwogICAgICAgIH0KCgogICAg\nICAgIHB1YmxpYyB2b2lkIHBlcm1hbmVudEVycm9yT25TZW5kKCkgewogICAg\nICAgICAgICAvLyB0aGUgdW5kZXJseWluZyBjaGFubmVsIGlzIGJyb2tlbiwg\ndGhlIGNoYW5uZWwgd2lsbAogICAgICAgICAgICAvLyBiZSBjbG9zZWQgaW4g\nVW1icmVsbGFIYW5kbGVyIHdoZW4gZXhjZXB0aW9uIGhhcHBlbmVkLgogICAg\nICAgICAgICAvLyBzbyB3ZSBkb24ndCBuZWVkIHRvIGNsb3NlIHRoZSBjaGFu\nbmVsIGFnYWluCiAgICAgICAgICAgIHN0b3BTZXJ2aW5nU3Vic2NyaWJlcih0\nb3BpYywgc3Vic2NyaWJlcklkLCBudWxsLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgTk9QX0NBTExCQUNLLCBudWxsKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIHRyYW5zaWVudEVycm9yT25TZW5kKCkg\newogICAgICAgICAgICByZXRyeUVycm9yZWRTdWJzY3JpYmVyQWZ0ZXJEZWxh\neSh0aGlzKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqID09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PQogICAgICAgICAqIHtAbGluayBEZWxpdmVyeU1h\nbmFnZXJSZXF1ZXN0fSBtZXRob2RzCiAgICAgICAgICovCiAgICAgICAgcHVi\nbGljIHZvaWQgcGVyZm9ybVJlcXVlc3QoKSB7CiAgICAgICAgICAgIC8vIFB1\ndCB0aGlzIHN1YnNjcmliZXIgaW4gdGhlIGNoYW5uZWwgdG8gc3Vic2NyaWJl\nciBtYXBwaW5nCiAgICAgICAgICAgIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBw\ncmV2U3Vic2NyaWJlciA9CiAgICAgICAgICAgICAgICBzdWJzY3JpYmVyU3Rh\ndGVzLnB1dChuZXcgVG9waWNTdWJzY3JpYmVyKHRvcGljLCBzdWJzY3JpYmVy\nSWQpLCB0aGlzKTsKCiAgICAgICAgICAgIC8vIGFmdGVyIHB1dCB0aGUgYWN0\naXZlIHN1YnNjcmliZXIgaW4gc3Vic2NyaWJlciBzdGF0ZXMgbWFwcGluZwog\nICAgICAgICAgICAvLyB0cmlnZ2VyIHRoZSBjYWxsYmFjayB0byB0ZWxsIGl0\nIHN0YXJ0ZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZQogICAgICAgICAgICAv\nLyBzaG91bGQgbGV0IHN1YnNjcmliZXIgcmVzcG9uc2UgZ28gZmlyc3QgYmVm\nb3JlIGZpcnN0IGRlbGl2ZXJlZCBtZXNzYWdlLgogICAgICAgICAgICBjYi5v\ncGVyYXRpb25GaW5pc2hlZChjdHgsIChWb2lkKW51bGwpOwoKICAgICAgICAg\nICAgaWYgKHByZXZTdWJzY3JpYmVyICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgIC8vIHdlIGFscmVhZHkgaW4gdGhlIGRlbGl2ZXJ5IHRocmVhZCwgd2Ug\nZG9uJ3QgbmVlZCB0byBlcXVldWUgYSBzdG9wIHJlcXVlc3QKICAgICAgICAg\nICAgICAgIC8vIGp1c3Qgc3RvcCBpdCBub3csIHNpbmNlIHN0b3AgaXMgbm90\nIGJsb2NraW5nIG9wZXJhdGlvbi4KICAgICAgICAgICAgICAgIC8vIGFuZCBh\nbHNvIGl0IGNsZWFucyB0aGUgb2xkIHN0YXRlIG9mIHRoZSBhY3RpdmUgc3Vi\nc2NyaWJlciBpbW1lZGlhdGVseS4KICAgICAgICAgICAgICAgIFN1YnNjcmlw\ndGlvbkV2ZW50IHNlOwogICAgICAgICAgICAgICAgaWYgKGRlbGl2ZXJ5RW5k\nUG9pbnQuZXF1YWxzKHByZXZTdWJzY3JpYmVyLmRlbGl2ZXJ5RW5kUG9pbnQp\nKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJTdWJzY3Jp\nYmVyIHt9IHJlcGxhY2VkIGEgZHVwbGljYXRlZCBzdWJzY3JpYmVyIHt9IGF0\nIHNhbWUgZGVsaXZlcnkgcG9pbnQge30uIiwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgdmEodGhpcywgcHJldlN1YnNjcmliZXIsIGRlbGl2\nZXJ5RW5kUG9pbnQpKTsKICAgICAgICAgICAgICAgICAgICBzZSA9IG51bGw7\nCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIGxvZ2dlci5kZWJ1ZygiU3Vic2NyaWJlciB7fSBmcm9tIGRlbGl2ZXJ5IHBv\naW50IHt9IGZvcmNlbGx5IGNsb3NlZCBkZWxpdmVyeSBwb2ludCB7fS4iLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YSh0aGlzLCBkZWxp\ndmVyeUVuZFBvaW50LCBwcmV2U3Vic2NyaWJlci5kZWxpdmVyeUVuZFBvaW50\nKSk7CiAgICAgICAgICAgICAgICAgICAgc2UgPSBTdWJzY3JpcHRpb25FdmVu\ndC5TVUJTQ1JJUFRJT05fRk9SQ0VEX0NMT1NFRDsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIGRvU3RvcFNlcnZpbmdTdWJzY3JpYmVyKHBy\nZXZTdWJzY3JpYmVyLCBzZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICAgICAgbGFzdFNl\ncUlkQ29tbXVuaWNhdGVkRXh0ZXJuYWxseSA9IGxhc3RMb2NhbFNlcUlkRGVs\naXZlcmVkOwogICAgICAgICAgICAgICAgYWRkRGVsaXZlcnlQdHIodGhpcywg\nbGFzdExvY2FsU2VxSWREZWxpdmVyZWQpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBkZWxpdmVyTmV4dE1lc3NhZ2UoKTsKICAgICAgICB9OwoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5n\nKCkgewogICAgICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmlu\nZ0J1aWxkZXIoKTsKICAgICAgICAgICAgc2IuYXBwZW5kKCJUb3BpYzogIik7\nCiAgICAgICAgICAgIHNiLmFwcGVuZCh0b3BpYy50b1N0cmluZ1V0ZjgoKSk7\nCiAgICAgICAgICAgIHNiLmFwcGVuZCgiU3Vic2NyaWJlcjogIik7CiAgICAg\nICAgICAgIHNiLmFwcGVuZChzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkp\nOwogICAgICAgICAgICBzYi5hcHBlbmQoIiwgRGVsaXZlcnlQdHI6ICIpOwog\nICAgICAgICAgICBzYi5hcHBlbmQobGFzdExvY2FsU2VxSWREZWxpdmVyZWQp\nOwogICAgICAgICAgICByZXR1cm4gc2IudG9TdHJpbmcoKTsKCiAgICAgICAg\nfQogICAgfQoKICAgIHByb3RlY3RlZCBjbGFzcyBTdG9wU2VydmluZ1N1YnNj\ncmliZXIgaW1wbGVtZW50cyBEZWxpdmVyeU1hbmFnZXJSZXF1ZXN0IHsKICAg\nICAgICBUb3BpY1N1YnNjcmliZXIgdHM7CiAgICAgICAgU3Vic2NyaXB0aW9u\nRXZlbnQgZXZlbnQ7CiAgICAgICAgZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2I7\nCiAgICAgICAgZmluYWwgT2JqZWN0IGN0eDsKCiAgICAgICAgcHVibGljIFN0\nb3BTZXJ2aW5nU3Vic2NyaWJlcihCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3Ry\naW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIFN1YnNjcmlwdGlvbkV2ZW50IGV2ZW50LAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2s8Vm9pZD4gY2Fs\nbGJhY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgdGhpcy50cyA9IG5l\ndyBUb3BpY1N1YnNjcmliZXIodG9waWMsIHN1YnNjcmliZXJJZCk7CiAgICAg\nICAgICAgIHRoaXMuZXZlbnQgPSBldmVudDsKICAgICAgICAgICAgdGhpcy5j\nYiA9IGNhbGxiYWNrOwogICAgICAgICAgICB0aGlzLmN0eCA9IGN0eDsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lk\nIHBlcmZvcm1SZXF1ZXN0KCkgewogICAgICAgICAgICBBY3RpdmVTdWJzY3Jp\nYmVyU3RhdGUgc3Vic2NyaWJlciA9IHN1YnNjcmliZXJTdGF0ZXMucmVtb3Zl\nKHRzKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0gc3Vic2NyaWJlcikgewog\nICAgICAgICAgICAgICAgZG9TdG9wU2VydmluZ1N1YnNjcmliZXIoc3Vic2Ny\naWJlciwgZXZlbnQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNiLm9w\nZXJhdGlvbkZpbmlzaGVkKGN0eCwgbnVsbCk7CiAgICAgICAgfQoKICAgIH0K\nCiAgICAvKioKICAgICAqIFN0b3Agc2VydmluZyBhIHN1YnNjcmliZXIuIFRo\naXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgaW4gYQogICAgICoge0BsaW5r\nIERlbGl2ZXJ5TWFuYWdlclJlcXVlc3R9LgogICAgICoKICAgICAqIEBwYXJh\nbSBzdWJzY3JpYmVyCiAgICAgKiAgICAgICAgICBBY3RpdmUgU3Vic2NyaWJl\nciB0byBzdG9wCiAgICAgKiBAcGFyYW0gZXZlbnQKICAgICAqICAgICAgICAg\nIFN1YnNjcmlwdGlvbiBFdmVudCBmb3IgdGhlIHN0b3AgcmVhc29uCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBkb1N0b3BTZXJ2aW5nU3Vic2NyaWJlcihB\nY3RpdmVTdWJzY3JpYmVyU3RhdGUgc3Vic2NyaWJlciwgU3Vic2NyaXB0aW9u\nRXZlbnQgZXZlbnQpIHsKICAgICAgICAvLyBUaGlzIHdpbGwgYXV0b21hdGlj\nYWxseSBzdG9wIGRlbGl2ZXJ5LCBhbmQgZGlzY29ubmVjdCB0aGUgY2hhbm5l\nbAogICAgICAgIHN1YnNjcmliZXIuc2V0Tm90Q29ubmVjdGVkKGV2ZW50KTsK\nCiAgICAgICAgLy8gaWYgdGhlIHN1YnNjcmliZXIgaGFzIG1vdmVkIG9uLCBh\nIG1vdmUgcmVxdWVzdCBmb3IgaXRzIGRlbGl2ZXJ5CiAgICAgICAgLy8gcG9p\nbnRlciBtdXN0IGJlIHBlbmRpbmcgaW4gdGhlIHJlcXVlc3QgcXVldWUuIE5v\ndGUgdGhhdCB0aGUKICAgICAgICAvLyBzdWJzY3JpYmVyIGZpcnN0IGNoYW5n\nZXMgaXRzIGRlbGl2ZXJ5IHBvaW50ZXIgYW5kIHRoZW4gc3VibWl0cyBhCiAg\nICAgICAgLy8gcmVxdWVzdCB0byBtb3ZlIHNvIHRoaXMgd29ya3MuCiAgICAg\nICAgcmVtb3ZlRGVsaXZlcnlQdHIoc3Vic2NyaWJlciwgc3Vic2NyaWJlci5n\nZXRMYXN0U2VxSWRDb21tdW5pY2F0ZWRFeHRlcm5hbGx5KCksIC8vCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgLy8gaXNBYnNlbmNlT2s9CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAvLyBwcnVuZVRvcGljPQogICAgICAgICAgICAgICAgICAgICAgICAg\nIHRydWUpOwogICAgfQoKICAgIHByb3RlY3RlZCBjbGFzcyBEZWxpdmVyeVB0\nck1vdmUgaW1wbGVtZW50cyBEZWxpdmVyeU1hbmFnZXJSZXF1ZXN0IHsKCiAg\nICAgICAgQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXI7CiAgICAg\nICAgTG9uZyBvbGRTZXFJZDsKICAgICAgICBMb25nIG5ld1NlcUlkOwoKICAg\nICAgICBwdWJsaWMgRGVsaXZlcnlQdHJNb3ZlKEFjdGl2ZVN1YnNjcmliZXJT\ndGF0ZSBzdWJzY3JpYmVyLCBMb25nIG9sZFNlcUlkLCBMb25nIG5ld1NlcUlk\nKSB7CiAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlciA9IHN1YnNjcmliZXI7\nCiAgICAgICAgICAgIHRoaXMub2xkU2VxSWQgPSBvbGRTZXFJZDsKICAgICAg\nICAgICAgdGhpcy5uZXdTZXFJZCA9IG5ld1NlcUlkOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcGVyZm9ybVJl\ncXVlc3QoKSB7CiAgICAgICAgICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBzdWJz\nY3JpYmVyLmdldFRvcGljKCk7CiAgICAgICAgICAgIGxvbmcgcHJldk1pblNl\ncUlkID0gZ2V0TWluaW11bVNlcUlkKHRvcGljKTsKCiAgICAgICAgICAgIGlm\nIChzdWJzY3JpYmVyLmlzQ29ubmVjdGVkKCkpIHsKICAgICAgICAgICAgICAg\nIHJlbW92ZURlbGl2ZXJ5UHRyKHN1YnNjcmliZXIsIG9sZFNlcUlkLCAvLwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXNBYnNlbmNl\nT2s9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBydW5lVG9w\naWM9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSk7\nCgogICAgICAgICAgICAgICAgYWRkRGVsaXZlcnlQdHIoc3Vic2NyaWJlciwg\nbmV3U2VxSWQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgcmVtb3ZlRGVsaXZlcnlQdHIoc3Vic2NyaWJlciwgb2xkU2VxSWQsIC8v\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpc0Fic2Vu\nY2VPaz0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwcnVuZVRv\ncGljPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxvbmcgbm93TWluU2VxSWQg\nPSBnZXRNaW5pbXVtU2VxSWQodG9waWMpOwoKICAgICAgICAgICAgaWYgKG5v\nd01pblNlcUlkID4gcHJldk1pblNlcUlkKSB7CiAgICAgICAgICAgICAgICBw\nZXJzaXN0ZW5jZU1nci5kZWxpdmVyZWRVbnRpbCh0b3BpYywgbm93TWluU2Vx\nSWQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3Rl\nY3RlZCBjbGFzcyBTaHV0ZG93bkRlbGl2ZXJ5TWFuYWdlclJlcXVlc3QgaW1w\nbGVtZW50cyBEZWxpdmVyeU1hbmFnZXJSZXF1ZXN0IHsKICAgICAgICAvLyBU\naGlzIGlzIGEgc2ltcGxlIHR5cGUgb2YgUmVxdWVzdCB3ZSB3aWxsIGVucXVl\ndWUgd2hlbiB0aGUKICAgICAgICAvLyBQdWJTdWJTZXJ2ZXIgaXMgc2h1dCBk\nb3duIGFuZCB3ZSB3YW50IHRvIHN0b3AgdGhlIERlbGl2ZXJ5TWFuYWdlcgog\nICAgICAgIC8vIHRocmVhZC4KICAgICAgICBwdWJsaWMgdm9pZCBwZXJmb3Jt\nUmVxdWVzdCgpIHsKICAgICAgICAgICAga2VlcFJ1bm5pbmcgPSBmYWxzZTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiA9PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PQogICAgICoKICAgICAqIER1bWIgZmFjdG9yaWVzIGZvciBv\ndXIgbWFwIG1ldGhvZHMKICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBj\nbGFzcyBUcmVlTWFwTG9uZ1RvU2V0U3Vic2NyaWJlckZhY3RvcnkgaW1wbGVt\nZW50cwogICAgICAgIEZhY3Rvcnk8U29ydGVkTWFwPExvbmcsIFNldDxBY3Rp\ndmVTdWJzY3JpYmVyU3RhdGU+Pj4gewogICAgICAgIHN0YXRpYyBUcmVlTWFw\nTG9uZ1RvU2V0U3Vic2NyaWJlckZhY3RvcnkgaW5zdGFuY2UgPSBuZXcgVHJl\nZU1hcExvbmdUb1NldFN1YnNjcmliZXJGYWN0b3J5KCk7CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBTb3J0ZWRNYXA8TG9uZywgU2V0PEFj\ndGl2ZVN1YnNjcmliZXJTdGF0ZT4+IG5ld0luc3RhbmNlKCkgewogICAgICAg\nICAgICByZXR1cm4gbmV3IFRyZWVNYXA8TG9uZywgU2V0PEFjdGl2ZVN1YnNj\ncmliZXJTdGF0ZT4+KCk7CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3Rl\nZCBzdGF0aWMgY2xhc3MgSGFzaE1hcFN1YnNjcmliZXJGYWN0b3J5IGltcGxl\nbWVudHMgRmFjdG9yeTxTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4gewog\nICAgICAgIHN0YXRpYyBIYXNoTWFwU3Vic2NyaWJlckZhY3RvcnkgaW5zdGFu\nY2UgPSBuZXcgSGFzaE1hcFN1YnNjcmliZXJGYWN0b3J5KCk7CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTZXQ8QWN0aXZlU3Vic2NyaWJl\nclN0YXRlPiBuZXdJbnN0YW5jZSgpIHsKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBIYXNoU2V0PEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4oKTsKICAgICAgICB9\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBvblN1YkNo\nYW5uZWxEaXNjb25uZWN0ZWQoVG9waWNTdWJzY3JpYmVyIHRvcGljU3Vic2Ny\naWJlcikgewogICAgICAgIHN0b3BTZXJ2aW5nU3Vic2NyaWJlcih0b3BpY1N1\nYnNjcmliZXIuZ2V0VG9waWMoKSwgdG9waWNTdWJzY3JpYmVyLmdldFN1YnNj\ncmliZXJJZCgpLAogICAgICAgICAgICAgICAgbnVsbCwgTk9QX0NBTExCQUNL\nLCBudWxsKTsKICAgIH0KCn0K\n","encoding":"base64"}

