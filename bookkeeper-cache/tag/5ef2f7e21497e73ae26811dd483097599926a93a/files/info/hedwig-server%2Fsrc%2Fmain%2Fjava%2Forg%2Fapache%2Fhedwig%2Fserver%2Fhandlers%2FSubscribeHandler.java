{"sha":"d10dbf757c49ccf7dbd4ae4002efc30a6c838e80","node_id":"MDQ6QmxvYjE1NzU5NTY6ZDEwZGJmNzU3YzQ5Y2NmN2RiZDRhZTQwMDJlZmMzMGE2YzgzOGU4MA==","size":12189,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/d10dbf757c49ccf7dbd4ae4002efc30a6c838e80","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaGFuZGxlcnM7CgppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJG\nYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5l\nbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxGdXR1\ncmU7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5DaGFubmVsRnV0\ndXJlTGlzdGVuZXI7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRl\nU3RyaW5nOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLk1h\ndGhVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLlJl\nZmxlY3Rpb25VdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVu\ndC5kYXRhLlRvcGljU3Vic2NyaWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb24uU2VydmVy\nTm90UmVzcG9uc2libGVGb3JUb3BpY0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLmZpbHRlci5QaXBlbGluZUZpbHRlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmZpbHRlci5TZXJ2ZXJNZXNzYWdlRmlsdGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTWVzc2FnZVNlcUlkOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlB1YlN1\nYlJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5Q\ndWJTdWJQcm90b2NvbC5SZXNwb25zZUJvZHk7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1\nZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3Vi\nUHJvdG9jb2wuU3Vic2NyaWJlUmVzcG9uc2U7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25E\nYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25z\nLlB1YlN1YlJlc3BvbnNlVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5wcm90b2V4dGVuc2lvbnMuU3Vic2NyaXB0aW9uU3RhdGVVdGlsczsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5k\nZWxpdmVyeS5DaGFubmVsRW5kUG9pbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIuZGVsaXZlcnkuRGVsaXZlcnlNYW5hZ2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLm5ldHR5LlNlcnZlclN0YXRzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLm5ldHR5LlNlcnZlclN0\nYXRzLk9wU3RhdHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIu\nbmV0dHkuVW1icmVsbGFIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlTWFuYWdlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5zdWJzY3JpcHRpb25zLlN1\nYnNjcmlwdGlvbk1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5z\nZXJ2ZXIuc3Vic2NyaXB0aW9ucy5BbGxUb0FsbFRvcG9sb2d5RmlsdGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljcy5Ub3BpY01h\nbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNr\nOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuVmFyQXJn\ncy52YTsKCnB1YmxpYyBjbGFzcyBTdWJzY3JpYmVIYW5kbGVyIGV4dGVuZHMg\nQmFzZUhhbmRsZXIgewogICAgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dn\nZXJGYWN0b3J5LmdldExvZ2dlcihTdWJzY3JpYmVIYW5kbGVyLmNsYXNzKTsK\nCiAgICBwcml2YXRlIGZpbmFsIERlbGl2ZXJ5TWFuYWdlciBkZWxpdmVyeU1n\ncjsKICAgIHByaXZhdGUgZmluYWwgUGVyc2lzdGVuY2VNYW5hZ2VyIHBlcnNp\nc3RlbmNlTWdyOwogICAgcHJpdmF0ZSBmaW5hbCBTdWJzY3JpcHRpb25NYW5h\nZ2VyIHN1Yk1ncjsKICAgIHByaXZhdGUgZmluYWwgU3Vic2NyaXB0aW9uQ2hh\nbm5lbE1hbmFnZXIgc3ViQ2hhbm5lbE1ncjsKCiAgICAvLyBvcCBzdGF0cwog\nICAgcHJpdmF0ZSBmaW5hbCBPcFN0YXRzIHN1YlN0YXRzOwoKICAgIHB1Ymxp\nYyBTdWJzY3JpYmVIYW5kbGVyKFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnLCBU\nb3BpY01hbmFnZXIgdG9waWNNZ3IsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBEZWxpdmVyeU1hbmFnZXIgZGVsaXZlcnlNYW5hZ2VyLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VNYW5hZ2VyIHBlcnNp\nc3RlbmNlTWdyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Vic2Ny\naXB0aW9uTWFuYWdlciBzdWJNZ3IsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBTdWJzY3JpcHRpb25DaGFubmVsTWFuYWdlciBzdWJDaGFubmVsTWdy\nKSB7CiAgICAgICAgc3VwZXIodG9waWNNZ3IsIGNmZyk7CiAgICAgICAgdGhp\ncy5kZWxpdmVyeU1nciA9IGRlbGl2ZXJ5TWFuYWdlcjsKICAgICAgICB0aGlz\nLnBlcnNpc3RlbmNlTWdyID0gcGVyc2lzdGVuY2VNZ3I7CiAgICAgICAgdGhp\ncy5zdWJNZ3IgPSBzdWJNZ3I7CiAgICAgICAgdGhpcy5zdWJDaGFubmVsTWdy\nID0gc3ViQ2hhbm5lbE1ncjsKICAgICAgICBzdWJTdGF0cyA9IFNlcnZlclN0\nYXRzLmdldEluc3RhbmNlKCkuZ2V0T3BTdGF0cyhPcGVyYXRpb25UeXBlLlNV\nQlNDUklCRSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBoYW5kbGVSZXF1ZXN0QXRPd25lcihmaW5hbCBQdWJTdWJSZXF1ZXN0IHJl\ncXVlc3QsIGZpbmFsIENoYW5uZWwgY2hhbm5lbCkgewoKICAgICAgICBpZiAo\nIXJlcXVlc3QuaGFzU3Vic2NyaWJlUmVxdWVzdCgpKSB7CiAgICAgICAgICAg\nIFVtYnJlbGxhSGFuZGxlci5zZW5kRXJyb3JSZXNwb25zZVRvTWFsZm9ybWVk\nUmVxdWVzdChjaGFubmVsLCByZXF1ZXN0LmdldFR4bklkKCksCiAgICAgICAg\nICAgICAgICAgICAgIk1pc3Npbmcgc3Vic2NyaWJlIHJlcXVlc3QgZGF0YSIp\nOwogICAgICAgICAgICBzdWJTdGF0cy5pbmNyZW1lbnRGYWlsZWRPcHMoKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgZmluYWwg\nQnl0ZVN0cmluZyB0b3BpYyA9IHJlcXVlc3QuZ2V0VG9waWMoKTsKCiAgICAg\nICAgTWVzc2FnZVNlcUlkIHNlcUlkOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIHNlcUlkID0gcGVyc2lzdGVuY2VNZ3IuZ2V0Q3VycmVudFNlcUlkRm9y\nVG9waWModG9waWMpOwogICAgICAgIH0gY2F0Y2ggKFNlcnZlck5vdFJlc3Bv\nbnNpYmxlRm9yVG9waWNFeGNlcHRpb24gZSkgewogICAgICAgICAgICBjaGFu\nbmVsLndyaXRlKFB1YlN1YlJlc3BvbnNlVXRpbHMuZ2V0UmVzcG9uc2VGb3JF\neGNlcHRpb24oZSwgcmVxdWVzdC5nZXRUeG5JZCgpKSkuYWRkTGlzdGVuZXIo\nCiAgICAgICAgICAgICAgICBDaGFubmVsRnV0dXJlTGlzdGVuZXIuQ0xPU0Up\nOwogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIGdldHRpbmcgY3Vy\ncmVudCBzZXEgaWQgZm9yIHRvcGljICIgKyB0b3BpYy50b1N0cmluZ1V0Zjgo\nKQogICAgICAgICAgICAgICAgICAgICAgICsgIiB3aGVuIHByb2Nlc3Npbmcg\nc3Vic2NyaWJlIHJlcXVlc3QgKHR4bmlkOiIgKyByZXF1ZXN0LmdldFR4bklk\nKCkgKyAiKSA6IiwgZSk7CiAgICAgICAgICAgIHN1YlN0YXRzLmluY3JlbWVu\ndEZhaWxlZE9wcygpOwogICAgICAgICAgICBTZXJ2ZXJTdGF0cy5nZXRJbnN0\nYW5jZSgpLmluY3JlbWVudFJlcXVlc3RzUmVkaXJlY3QoKTsKICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgZmluYWwgU3Vic2NyaWJl\nUmVxdWVzdCBzdWJSZXF1ZXN0ID0gcmVxdWVzdC5nZXRTdWJzY3JpYmVSZXF1\nZXN0KCk7CiAgICAgICAgZmluYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQg\nPSBzdWJSZXF1ZXN0LmdldFN1YnNjcmliZXJJZCgpOwoKICAgICAgICBNZXNz\nYWdlU2VxSWQgbGFzdFNlcUlkUHVibGlzaGVkID0gTWVzc2FnZVNlcUlkLm5l\nd0J1aWxkZXIoc2VxSWQpLnNldExvY2FsQ29tcG9uZW50KHNlcUlkLmdldExv\nY2FsQ29tcG9uZW50KCkpLmJ1aWxkKCk7CgogICAgICAgIGZpbmFsIGxvbmcg\ncmVxdWVzdFRpbWUgPSBNYXRoVXRpbHMubm93KCk7CiAgICAgICAgc3ViTWdy\nLnNlcnZlU3Vic2NyaWJlUmVxdWVzdCh0b3BpYywgc3ViUmVxdWVzdCwgbGFz\ndFNlcUlkUHVibGlzaGVkLCBuZXcgQ2FsbGJhY2s8U3Vic2NyaXB0aW9uRGF0\nYT4oKSB7CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4\nY2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIGNoYW5uZWwu\nd3JpdGUoUHViU3ViUmVzcG9uc2VVdGlscy5nZXRSZXNwb25zZUZvckV4Y2Vw\ndGlvbihleGNlcHRpb24sIHJlcXVlc3QuZ2V0VHhuSWQoKSkpLmFkZExpc3Rl\nbmVyKAogICAgICAgICAgICAgICAgICAgIENoYW5uZWxGdXR1cmVMaXN0ZW5l\nci5DTE9TRSk7CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9y\nIHNlcnZpbmcgc3Vic2NyaWJlIHJlcXVlc3QgKCIgKyByZXF1ZXN0LmdldFR4\nbklkKCkgKyAiKSBmb3IgKHRvcGljOiAiCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAiICwgc3Vic2NyaWJl\ncjogIiArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0ZjgoKSArICIpIiwgZXhj\nZXB0aW9uKTsKICAgICAgICAgICAgICAgIHN1YlN0YXRzLmluY3JlbWVudEZh\naWxlZE9wcygpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQo\nT2JqZWN0IGN0eCwgZmluYWwgU3Vic2NyaXB0aW9uRGF0YSBzdWJEYXRhKSB7\nCgogICAgICAgICAgICAgICAgVG9waWNTdWJzY3JpYmVyIHRvcGljU3ViID0g\nbmV3IFRvcGljU3Vic2NyaWJlcih0b3BpYywgc3Vic2NyaWJlcklkKTsKICAg\nICAgICAgICAgICAgIHN5bmNocm9uaXplZCAoY2hhbm5lbCkgewogICAgICAg\nICAgICAgICAgICAgIGlmICghY2hhbm5lbC5pc0Nvbm5lY3RlZCgpKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIGNoYW5uZWwgZ290IGRpc2Nvbm5l\nY3RlZCB3aGlsZSB3ZSB3ZXJlIHByb2Nlc3NpbmcgdGhlCiAgICAgICAgICAg\nICAgICAgICAgICAgIC8vIHN1YnNjcmliZSByZXF1ZXN0LAogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBub3RoaW5nIG11Y2ggd2UgY2FuIGRvIGluIHRo\naXMgY2FzZQogICAgICAgICAgICAgICAgICAgICAgICBzdWJTdGF0cy5pbmNy\nZW1lbnRGYWlsZWRPcHMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIG1lc3NhZ2UgZmls\ndGVyCiAgICAgICAgICAgICAgICBQaXBlbGluZUZpbHRlciBmaWx0ZXIgPSBu\nZXcgUGlwZWxpbmVGaWx0ZXIoKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgLy8gdGhlIGZpbHRlciBwaXBlbGluZSBzaG91\nbGQgYmUKICAgICAgICAgICAgICAgICAgICAvLyAxKSBBbGxUb0FsbFRvcG9s\nb2d5RmlsdGVyIHRvIGZpbHRlciBjcm9zcy1yZWdpb24gbWVzc2FnZXMKICAg\nICAgICAgICAgICAgICAgICBmaWx0ZXIuYWRkTGFzdChuZXcgQWxsVG9BbGxU\nb3BvbG9neUZpbHRlcigpKTsKICAgICAgICAgICAgICAgICAgICAvLyAyKSBV\nc2VyLUN1c3RvbWl6ZWQgTWVzc2FnZUZpbHRlcgogICAgICAgICAgICAgICAg\nICAgIGlmIChzdWJEYXRhLmhhc1ByZWZlcmVuY2VzKCkgJiYKICAgICAgICAg\nICAgICAgICAgICAgICAgc3ViRGF0YS5nZXRQcmVmZXJlbmNlcygpLmhhc01l\nc3NhZ2VGaWx0ZXIoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBTdHJp\nbmcgbWVzc2FnZUZpbHRlck5hbWUgPSBzdWJEYXRhLmdldFByZWZlcmVuY2Vz\nKCkuZ2V0TWVzc2FnZUZpbHRlcigpOwogICAgICAgICAgICAgICAgICAgICAg\nICBmaWx0ZXIuYWRkTGFzdChSZWZsZWN0aW9uVXRpbHMubmV3SW5zdGFuY2Uo\nbWVzc2FnZUZpbHRlck5hbWUsIFNlcnZlck1lc3NhZ2VGaWx0ZXIuY2xhc3Mp\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nLy8gaW5pdGlhbGl6ZSB0aGUgZmlsdGVyCiAgICAgICAgICAgICAgICAgICAg\nZmlsdGVyLmluaXRpYWxpemUoY2ZnLmdldENvbmYoKSk7CiAgICAgICAgICAg\nICAgICAgICAgZmlsdGVyLnNldFN1YnNjcmlwdGlvblByZWZlcmVuY2VzKHRv\ncGljLCBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YkRhdGEuZ2V0UHJlZmVy\nZW5jZXMoKSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhj\nZXB0aW9uIHJlKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGVyck1z\nZyA9ICJSdW50aW1lRXhjZXB0aW9uIGNhdWdodCB3aGVuIGluc3RhbnRpYXRp\nbmcgbWVzc2FnZSBmaWx0ZXIgZm9yICh0b3BpYzoiCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsg\nIiwgc3Vic2NyaWJlcjoiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgp\nICsgIikuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAi\nSXQgbWlnaHQgYmUgaW50cm9kdWNlZCBieSBwcm9ncmFtbWluZyBlcnJvciBp\nbiBtZXNzYWdlIGZpbHRlci4iOwogICAgICAgICAgICAgICAgICAgIGxvZ2dl\nci5lcnJvcihlcnJNc2csIHJlKTsKICAgICAgICAgICAgICAgICAgICBQdWJT\ndWJFeGNlcHRpb24gcHNlID0gbmV3IFB1YlN1YkV4Y2VwdGlvbi5JbnZhbGlk\nTWVzc2FnZUZpbHRlckV4Y2VwdGlvbihlcnJNc2csIHJlKTsKICAgICAgICAg\nICAgICAgICAgICBzdWJTdGF0cy5pbmNyZW1lbnRGYWlsZWRPcHMoKTsKICAg\nICAgICAgICAgICAgICAgICAvLyB3ZSBzaG91bGQgbm90IGNsb3NlIHRoZSBz\ndWJzY3JpcHRpb24gY2hhbm5lbCwganVzdCByZXNwb25zZSBlcnJvcgogICAg\nICAgICAgICAgICAgICAgIC8vIGNsaWVudCBkZWNpZGUgdG8gY2xvc2UgaXQg\nb3Igbm90LgogICAgICAgICAgICAgICAgICAgIGNoYW5uZWwud3JpdGUoUHVi\nU3ViUmVzcG9uc2VVdGlscy5nZXRSZXNwb25zZUZvckV4Y2VwdGlvbihwc2Us\nIHJlcXVlc3QuZ2V0VHhuSWQoKSkpOwogICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7\nCiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGVyck1zZyA9ICJGYWlsZWQg\ndG8gaW5zdGFudGlhdGUgbWVzc2FnZSBmaWx0ZXIgZm9yICh0b3BpYzoiICsg\ndG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIiwgc3Vic2NyaWJlcjoiICsgc3Vic2NyaWJlcklkLnRv\nU3RyaW5nVXRmOCgpICsgIikuIjsKICAgICAgICAgICAgICAgICAgICBsb2dn\nZXIuZXJyb3IoZXJyTXNnLCB0KTsKICAgICAgICAgICAgICAgICAgICBQdWJT\ndWJFeGNlcHRpb24gcHNlID0gbmV3IFB1YlN1YkV4Y2VwdGlvbi5JbnZhbGlk\nTWVzc2FnZUZpbHRlckV4Y2VwdGlvbihlcnJNc2csIHQpOwogICAgICAgICAg\nICAgICAgICAgIHN1YlN0YXRzLmluY3JlbWVudEZhaWxlZE9wcygpOwogICAg\nICAgICAgICAgICAgICAgIGNoYW5uZWwud3JpdGUoUHViU3ViUmVzcG9uc2VV\ndGlscy5nZXRSZXNwb25zZUZvckV4Y2VwdGlvbihwc2UsIHJlcXVlc3QuZ2V0\nVHhuSWQoKSkpCiAgICAgICAgICAgICAgICAgICAgLmFkZExpc3RlbmVyKENo\nYW5uZWxGdXR1cmVMaXN0ZW5lci5DTE9TRSk7CiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nYm9vbGVhbiBmb3JjZUF0dGFjaCA9IGZhbHNlOwogICAgICAgICAgICAgICAg\naWYgKHN1YlJlcXVlc3QuaGFzRm9yY2VBdHRhY2goKSkgewogICAgICAgICAg\nICAgICAgICAgIGZvcmNlQXR0YWNoID0gc3ViUmVxdWVzdC5nZXRGb3JjZUF0\ndGFjaCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8g\nVHJ5IHRvIHN0b3JlIHRoZSBzdWJzY3JpcHRpb24gY2hhbm5lbCBmb3IgdGhl\nIHRvcGljIHN1YnNjcmliZXIKICAgICAgICAgICAgICAgIENoYW5uZWwgb2xk\nQ2hhbm5lbCA9IHN1YkNoYW5uZWxNZ3IucHV0KHRvcGljU3ViLCBjaGFubmVs\nLCBmb3JjZUF0dGFjaCk7CiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBv\nbGRDaGFubmVsKSB7CiAgICAgICAgICAgICAgICAgICAgUHViU3ViRXhjZXB0\naW9uIHBzZSA9IG5ldyBQdWJTdWJFeGNlcHRpb24uVG9waWNCdXN5RXhjZXB0\naW9uKAogICAgICAgICAgICAgICAgICAgICAgICAiU3Vic2NyaWJlciAiICsg\nc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpICsgIiBmb3IgdG9waWMgIiAr\nIHRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAg\nICsgIiBpcyBhbHJlYWR5IGJlaW5nIHNlcnZlZCBvbiBhIGRpZmZlcmVudCBj\naGFubmVsICIgKyBvbGRDaGFubmVsICsgIi4iKTsKICAgICAgICAgICAgICAg\nICAgICBzdWJTdGF0cy5pbmNyZW1lbnRGYWlsZWRPcHMoKTsKICAgICAgICAg\nICAgICAgICAgICBjaGFubmVsLndyaXRlKFB1YlN1YlJlc3BvbnNlVXRpbHMu\nZ2V0UmVzcG9uc2VGb3JFeGNlcHRpb24ocHNlLCByZXF1ZXN0LmdldFR4bklk\nKCkpKQogICAgICAgICAgICAgICAgICAgIC5hZGRMaXN0ZW5lcihDaGFubmVs\nRnV0dXJlTGlzdGVuZXIuQ0xPU0UpOwogICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyB3\nYW50IHRvIHN0YXJ0IDEgYWhlYWQgb2YgdGhlIGNvbnN1bWUgcHRyCiAgICAg\nICAgICAgICAgICBNZXNzYWdlU2VxSWQgbGFzdENvbnN1bWVkU2VxSWQgPSBz\ndWJEYXRhLmdldFN0YXRlKCkuZ2V0TXNnSWQoKTsKICAgICAgICAgICAgICAg\nIE1lc3NhZ2VTZXFJZCBzZXFJZFRvU3RhcnRGcm9tID0gTWVzc2FnZVNlcUlk\nLm5ld0J1aWxkZXIobGFzdENvbnN1bWVkU2VxSWQpLnNldExvY2FsQ29tcG9u\nZW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbGFzdENvbnN1bWVkU2VxSWQuZ2V0TG9jYWxDb21wb25l\nbnQoKSArIDEpLmJ1aWxkKCk7CiAgICAgICAgICAgICAgICBkZWxpdmVyeU1n\nci5zdGFydFNlcnZpbmdTdWJzY3JpcHRpb24odG9waWMsIHN1YnNjcmliZXJJ\nZCwKICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YS5nZXRQcmVmZXJl\nbmNlcygpLCBzZXFJZFRvU3RhcnRGcm9tLCBuZXcgQ2hhbm5lbEVuZFBvaW50\nKGNoYW5uZWwpLCBmaWx0ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIG5l\ndyBDYWxsYmFjazxWb2lkPigpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9pZCBy\nZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBG\naXJzdCB3cml0ZSBzdWNjZXNzIGFuZCB0aGVuIHRlbGwgdGhlIGRlbGl2ZXJ5\nIG1hbmFnZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nb3RoZXJ3aXNlIHRoZSBmaXJzdCBtZXNzYWdlIG1pZ2h0IGdvIG91dCBiZWZv\ncmUgdGhlIHJlc3BvbnNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gdG8gdGhlIHN1YnNjcmliZQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIFN1YnNjcmliZVJlc3BvbnNlLkJ1aWxkZXIgc3ViUmVzcEJ1\naWxkZXIgPSBTdWJzY3JpYmVSZXNwb25zZS5uZXdCdWlsZGVyKCkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFByZWZlcmVuY2Vz\nKHN1YkRhdGEuZ2V0UHJlZmVyZW5jZXMoKSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgUmVzcG9uc2VCb2R5IHJlc3BCb2R5ID0gUmVzcG9u\nc2VCb2R5Lm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAuc2V0U3Vic2NyaWJlUmVzcG9uc2Uoc3ViUmVzcEJ1aWxk\nZXIpLmJ1aWxkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nY2hhbm5lbC53cml0ZShQdWJTdWJSZXNwb25zZVV0aWxzLmdldFN1Y2Nlc3NS\nZXNwb25zZShyZXF1ZXN0LmdldFR4bklkKCksIHJlc3BCb2R5KSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlN1YnNj\ncmliZSByZXF1ZXN0ICgiICsgcmVxdWVzdC5nZXRUeG5JZCgpICsgIikgZm9y\nICh0b3BpYzoiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmli\nZXI6IiArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0ZjgoKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIikgZnJvbSBj\naGFubmVsICIgKyBjaGFubmVsLmdldFJlbW90ZUFkZHJlc3MoKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWNj\nZWVkIC0gaXRzIHN1YnNjcmlwdGlvbiBkYXRhIGlzICIKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFN1YnNjcmlwdGlv\nblN0YXRlVXRpbHMudG9TdHJpbmcoc3ViRGF0YSkpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHN1YlN0YXRzLnVwZGF0ZUxhdGVuY3koTWF0\naFV0aWxzLm5vdygpIC0gcmVxdWVzdFRpbWUpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBvcGVyYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9u\nIGV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC8vIHdvdWxkIG5vdCBoYXBwZW5lZAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBudWxsKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0sIG51bGwpOwoKICAgIH0KCn0K\n","encoding":"base64"}

