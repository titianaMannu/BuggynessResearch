{"sha":"ac48e024623ce4c4a0ade74d465cfd1a3960c6fe","node_id":"MDQ6QmxvYjE1NzU5NTY6YWM0OGUwMjQ2MjNjZTRjNGEwYWRlNzRkNDY1Y2ZkMWEzOTYwYzZmZQ==","size":42154,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ac48e024623ce4c4a0ade74d465cfd1a3960c6fe","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubWV0YTsKCmltcG9ydCBq\nYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hN\nYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWlj\nQm9vbGVhbjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5B\ndG9taWNJbnRlZ2VyOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9y\ndCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb24uQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLlpLVXRpbDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0Rl\nZnMuSWRzOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuZGF0YS5TdGF0\nOwppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBv\ncnQgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudmVyc2lv\nbmluZy5WZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnZl\ncnNpb25pbmcuVmVyc2lvbmVkOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5tZXRhLlprVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTGVkZ2VyUmFu\nZ2VzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3Vi\nUHJvdG9jb2wuU3RhdHVzQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbkRhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbC5TdWJzY3JpcHRpb25TdGF0ZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvZXh0ZW5zaW9ucy5TdWJzY3JpcHRpb25TdGF0ZVV0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1vbi5TZXJ2ZXJDb25m\naWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRv\ncGljcy5IdWJJbmZvOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5D\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnpvb2tlZXBlci5T\nYWZlQXN5bmNaS0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nem9va2VlcGVyLlprVXRpbHM7CgovKioKICogWm9vS2VlcGVyLWJhc2VkIE1l\ndGFkYXRhIE1hbmFnZXIuCiAqLwpwdWJsaWMgY2xhc3MgWmtNZXRhZGF0YU1h\nbmFnZXJGYWN0b3J5IGV4dGVuZHMgTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSB7\nCiAgICBwcm90ZWN0ZWQgZmluYWwgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihaa01ldGFkYXRhTWFuYWdlckZhY3Rv\ncnkuY2xhc3MpOwoKICAgIHN0YXRpYyBmaW5hbCBpbnQgQ1VSX1ZFUlNJT04g\nPSAxOwoKICAgIFpvb0tlZXBlciB6azsKICAgIFNlcnZlckNvbmZpZ3VyYXRp\nb24gY2ZnOwoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGludCBnZXRDdXJy\nZW50VmVyc2lvbigpIHsKICAgICAgICByZXR1cm4gQ1VSX1ZFUlNJT047CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgTWV0YWRhdGFNYW5hZ2Vy\nRmFjdG9yeSBpbml0aWFsaXplKFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBa\nb29LZWVwZXIgemssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGludCB2ZXJzaW9uKQogICAgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoQ1VSX1ZFUlNJT04gIT0gdmVyc2lvbikgewog\nICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkluY29tcGF0aWJs\nZSBaa01ldGFkYXRhTWFuYWdlckZhY3RvcnkgdmVyc2lvbiAiICsgdmVyc2lv\nbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBmb3VuZCwg\nZXhwZWN0ZWQgdmVyc2lvbiAiICsgQ1VSX1ZFUlNJT04pOwogICAgICAgIH0K\nICAgICAgICB0aGlzLmNmZyA9IGNmZzsKICAgICAgICB0aGlzLnprID0gems7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgdm9pZCBzaHV0ZG93bigpIHsKICAgICAgICAvLyBkbyBub3Ro\naW5nIGhlcmUsIGJlY2F1c2Ugem9va2VlcGVyIGhhbmRsZSBpcyBwYXNzZWQg\nZnJvbSBvdXRzaWRlCiAgICAgICAgLy8gd2UgZG9uJ3QgbmVlZCB0byBzdG9w\nIGl0LgogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIEl0ZXJhdG9y\nPEJ5dGVTdHJpbmc+IGdldFRvcGljcygpIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgTGlzdDxTdHJpbmc+IHRvcGljczsKICAgICAgICB0cnkgewog\nICAgICAgICAgICB0b3BpY3MgPSB6ay5nZXRDaGlsZHJlbihjZmcuZ2V0WmtU\nb3BpY3NQcmVmaXgobmV3IFN0cmluZ0J1aWxkZXIoKSkudG9TdHJpbmcoKSwg\nZmFsc2UpOwogICAgICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbiBrZSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkZhaWxlZCB0\nbyBnZXQgdG9waWNzIGxpc3QgOiAiLCBrZSk7CiAgICAgICAgfSBjYXRjaCAo\nSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IElPRXhjZXB0aW9uKCJJbnRlcnJ1cHRlZCBvbiBnZXR0aW5nIHRvcGlj\ncyBsaXN0IDogIiwgaWUpOwogICAgICAgIH0KICAgICAgICBmaW5hbCBJdGVy\nYXRvcjxTdHJpbmc+IGl0ZXIgPSB0b3BpY3MuaXRlcmF0b3IoKTsKICAgICAg\nICByZXR1cm4gbmV3IEl0ZXJhdG9yPEJ5dGVTdHJpbmc+KCkgewogICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaGFz\nTmV4dCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBpdGVyLmhhc05leHQo\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgcHVibGljIEJ5dGVTdHJpbmcgbmV4dCgpIHsKICAgICAgICAgICAg\nICAgIFN0cmluZyB0ID0gaXRlci5uZXh0KCk7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgodCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHJlbW92ZSgpIHsKICAgICAgICAgICAgICAgIGl0ZXIucmVtb3ZlKCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIFRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyIG5ld1RvcGlj\nUGVyc2lzdGVuY2VNYW5hZ2VyKCkgewogICAgICAgIHJldHVybiBuZXcgWmtU\nb3BpY1BlcnNpc3RlbmNlTWFuYWdlckltcGwoY2ZnLCB6ayk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3Vic2NyaXB0aW9uRGF0YU1hbmFn\nZXIgbmV3U3Vic2NyaXB0aW9uRGF0YU1hbmFnZXIoKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBaa1N1YnNjcmlwdGlvbkRhdGFNYW5hZ2VySW1wbChjZmcsIHpr\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBUb3BpY093bmVy\nc2hpcE1hbmFnZXIgbmV3VG9waWNPd25lcnNoaXBNYW5hZ2VyKCkgewogICAg\nICAgIHJldHVybiBuZXcgWmtUb3BpY093bmVyc2hpcE1hbmFnZXJJbXBsKGNm\nZywgemspOwogICAgfQoKICAgIC8qKgogICAgICogWm9vS2VlcGVyIGJhc2Vk\nIHRvcGljIHBlcnNpc3RlbmNlIG1hbmFnZXIuCiAgICAgKi8KICAgIHN0YXRp\nYyBjbGFzcyBaa1RvcGljUGVyc2lzdGVuY2VNYW5hZ2VySW1wbCBpbXBsZW1l\nbnRzIFRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyIHsKCiAgICAgICAgWm9vS2Vl\ncGVyIHprOwogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnOwoKICAg\nICAgICBaa1RvcGljUGVyc2lzdGVuY2VNYW5hZ2VySW1wbChTZXJ2ZXJDb25m\naWd1cmF0aW9uIGNvbmYsIFpvb0tlZXBlciB6aykgewogICAgICAgICAgICB0\naGlzLmNmZyA9IGNvbmY7CiAgICAgICAgICAgIHRoaXMuemsgPSB6azsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lk\nIGNsb3NlKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgLy8g\nZG8gbm90aGluZyBpbiB6b29rZWVwZXIgYmFzZWQgaW1wbAogICAgICAgIH0K\nCiAgICAgICAgLyoqCiAgICAgICAgICogR2V0IHpub2RlIHBhdGggdG8gc3Rv\ncmUgcGVyc2lzdGVuY2UgaW5mbyBvZiBhIHRvcGljLgogICAgICAgICAqCiAg\nICAgICAgICogQHBhcmFtIHRvcGljCiAgICAgICAgICogICAgICAgICAgVG9w\naWMgbmFtZQogICAgICAgICAqIEByZXR1cm4gem5vZGUgcGF0aCB0byBzdG9y\nZSBwZXJzaXN0ZW5jZSBpbmZvLgogICAgICAgICAqLwogICAgICAgIHByaXZh\ndGUgU3RyaW5nIGxlZGdlcnNQYXRoKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAg\nICAgICAgICAgcmV0dXJuIGNmZy5nZXRaa1RvcGljUGF0aChuZXcgU3RyaW5n\nQnVpbGRlcigpLCB0b3BpYykuYXBwZW5kKCIvbGVkZ2VycyIpLnRvU3RyaW5n\nKCk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBQYXJzZSBs\nZWRnZXIgcmFuZ2VzIGRhdGEgYW5kIHJldHVybiBpdCB0aHJ1IGNhbGxiYWNr\nLgogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHRvcGljCiAgICAgICAg\nICogICAgICAgICAgVG9waWMgbmFtZQogICAgICAgICAqIEBwYXJhbSBkYXRh\nCiAgICAgICAgICogICAgICAgICAgVG9waWMgTGVkZ2VyIFJhbmdlcyBkYXRh\nCiAgICAgICAgICogQHBhcmFtIHZlcnNpb24KICAgICAgICAgKiAgICAgICAg\nICBWZXJzaW9uIG9mIHRoZSB0b3BpYyBsZWRnZXIgcmFuZ2VzIGRhdGEKICAg\nICAgICAgKiBAcGFyYW0gY2FsbGJhY2sKICAgICAgICAgKiAgICAgICAgICBD\nYWxsYmFjayB0byByZXR1cm4gbGVkZ2VyIHJhbmdlcwogICAgICAgICAqIEBw\nYXJhbSBjdHgKICAgICAgICAgKiAgICAgICAgICBDb250ZXh0IG9mIHRoZSBj\nYWxsYmFjawogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBwYXJz\nZUFuZFJldHVyblRvcGljTGVkZ2VyUmFuZ2VzKEJ5dGVTdHJpbmcgdG9waWMs\nIGJ5dGVbXSBkYXRhLCBpbnQgdmVyc2lvbiwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjazxW\nZXJzaW9uZWQ8TGVkZ2VyUmFuZ2VzPj4gY2FsbGJhY2ssIE9iamVjdCBjdHgp\nIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFZlcnNpb25l\nZDxMZWRnZXJSYW5nZXM+IHJhbmdlcyA9IG5ldyBWZXJzaW9uZWQ8TGVkZ2Vy\nUmFuZ2VzPihMZWRnZXJSYW5nZXMucGFyc2VGcm9tKGRhdGEpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBaa1ZlcnNpb24odmVyc2lv\nbikpOwogICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNo\nZWQoY3R4LCByYW5nZXMpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICB9IGNhdGNoIChJbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgU3RyaW5nIG1zZyA9ICJMZWRnZXIg\ncmFuZ2VzIGZvciB0b3BpYzoiICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAi\nIGNvdWxkIG5vdCBiZSBkZXNlcmlhbGl6ZWQiOwogICAgICAgICAgICAgICAg\nbG9nZ2VyLmVycm9yKG1zZywgZSk7CiAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVu\nZXhwZWN0ZWRDb25kaXRpb25FeGNlcHRpb24obXNnKSk7CiAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHJlYWRUb3BpY1BlcnNp\nc3RlbmNlSW5mbyhmaW5hbCBCeXRlU3RyaW5nIHRvcGljLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBDYWxs\nYmFjazxWZXJzaW9uZWQ8TGVkZ2VyUmFuZ2VzPj4gY2FsbGJhY2ssCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVj\ndCBjdHgpIHsKICAgICAgICAgICAgLy8gcmVhZCB0b3BpYyBsZWRnZXJzIG5v\nZGUgZGF0YQogICAgICAgICAgICBmaW5hbCBTdHJpbmcgek5vZGVQYXRoID0g\nbGVkZ2Vyc1BhdGgodG9waWMpOwoKICAgICAgICAgICAgemsuZ2V0RGF0YSh6\nTm9kZVBhdGgsIGZhbHNlLCBuZXcgU2FmZUFzeW5jWktDYWxsYmFjay5EYXRh\nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCBy\nYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsIGJ5dGVbXSBkYXRhLCBTdGF0\nIHN0YXQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQ29kZS5P\nSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNl\nQW5kUmV0dXJuVG9waWNMZWRnZXJSYW5nZXModG9waWMsIGRhdGEsIHN0YXQu\nZ2V0VmVyc2lvbigpLCBjYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgICAgICAgICAgaWYgKHJjID09IENvZGUuTk9OT0RFLmludFZhbHVl\nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgZG9uJ3QgY3Jl\nYXRlIHRoZSB6bm9kZSB1bnRpbCB3ZSBmaXJzdCB3cml0ZSBpdC4KICAgICAg\nICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQo\nY3R4LCBudWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8g\nb3RoZXJ3aXNlIHNvbWUgb3RoZXIgZXJyb3IKICAgICAgICAgICAgICAgICAg\nICBLZWVwZXJFeGNlcHRpb24ga2UgPQogICAgICAgICAgICAgICAgICAgICAg\nICBaa1V0aWxzLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRpb24oIkNvdWxk\nIG5vdCByZWFkIGxlZGdlcnMgbm9kZSBmb3IgdG9waWM6ICIKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICsgdG9waWMudG9TdHJpbmdVdGY4KCksIHBhdGgsIHJjKTsKICAg\nICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4\nLCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKGtl\nKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGN0eCk7CiAg\nICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgY3JlYXRlVG9waWNQZXJz\naXN0ZW5jZUluZm8oZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgTGVkZ2VyUmFu\nZ2VzIHJhbmdlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWwgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJh\nY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgZmluYWwgU3RyaW5nIHpO\nb2RlUGF0aCA9IGxlZGdlcnNQYXRoKHRvcGljKTsKICAgICAgICAgICAgZmlu\nYWwgYnl0ZVtdIGRhdGEgPSByYW5nZXMudG9CeXRlQXJyYXkoKTsKICAgICAg\nICAgICAgLy8gY3JlYXRlIGl0CiAgICAgICAgICAgIFprVXRpbHMuY3JlYXRl\nRnVsbFBhdGhPcHRpbWlzdGljKHprLCB6Tm9kZVBhdGgsIGRhdGEsIElkcy5P\nUEVOX0FDTF9VTlNBRkUsCiAgICAgICAgICAgIENyZWF0ZU1vZGUuUEVSU0lT\nVEVOVCwgbmV3IFNhZmVBc3luY1pLQ2FsbGJhY2suU3RyaW5nQ2FsbGJhY2so\nKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5n\nIHBhdGgsIE9iamVjdCBjdHgsIFN0cmluZyBuYW1lKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHJjID09IENvZGUuTk9ERUVYSVNUUy5pbnRWYWx1ZSgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlv\nbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29k\nZS5UT1BJQ19QRVJTSVNURU5DRV9JTkZPX0VYSVNUUywKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBl\ncnNpc3RlbmNlIGluZm8gb2YgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRm\nOCgpICsgIiBleGlzdGVkLiIpKTsKICAgICAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICBpZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlvbiBrZSA9IFprVXRpbHMu\nbG9nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkIG5vdCBjcmVh\ndGUgbGVkZ2VycyBub2RlIGZvciB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5n\nVXRmOCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBwYXRoLCByYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNh\nbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRp\nb24uU2VydmljZURvd25FeGNlcHRpb24oa2UpKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICAvLyBpbml0aWFsIHZlcnNpb24gaXMgdmVyc2lvbiAw\nCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNo\nZWQoY3R4LCBuZXcgWmtWZXJzaW9uKDApKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfSwgY3R4KTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\nd3JpdGVUb3BpY1BlcnNpc3RlbmNlSW5mbyhmaW5hbCBCeXRlU3RyaW5nIHRv\ncGljLCBMZWRnZXJSYW5nZXMgcmFuZ2VzLCBmaW5hbCBWZXJzaW9uIHZlcnNp\nb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBmaW5hbCBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgT2JqZWN0\nIGN0eCkgewogICAgICAgICAgICBpZiAoVmVyc2lvbi5ORVcgPT0gdmVyc2lv\nbikgewogICAgICAgICAgICAgICAgY3JlYXRlVG9waWNQZXJzaXN0ZW5jZUlu\nZm8odG9waWMsIHJhbmdlcywgY2FsbGJhY2ssIGN0eCk7CiAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpbmFs\nIFN0cmluZyB6Tm9kZVBhdGggPSBsZWRnZXJzUGF0aCh0b3BpYyk7CiAgICAg\nICAgICAgIGZpbmFsIGJ5dGVbXSBkYXRhID0gcmFuZ2VzLnRvQnl0ZUFycmF5\nKCk7CgogICAgICAgICAgICBpZiAoISh2ZXJzaW9uIGluc3RhbmNlb2YgWmtW\nZXJzaW9uKSkgewogICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9u\nRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5VbmV4cGVjdGVkQ29u\nZGl0aW9uRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIkludmFsaWQgdmVyc2lvbiBwcm92aWRlZCB0\nbyB1cGRhdGUgcGVyc2lzdGVuY2UgaW5mbyBmb3IgdG9waWMgIiArIHRvcGlj\nLnRvU3RyaW5nVXRmOCgpKSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIGludCB6bm9kZVZlcnNpb24gPSAo\nKFprVmVyc2lvbil2ZXJzaW9uKS5nZXRabm9kZVZlcnNpb24oKTsKICAgICAg\nICAgICAgemsuc2V0RGF0YSh6Tm9kZVBhdGgsIGRhdGEsIHpub2RlVmVyc2lv\nbiwgbmV3IFNhZmVBc3luY1pLQ2FsbGJhY2suU3RhdENhbGxiYWNrKCkgewog\nICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3Ry\naW5nIHBhdGgsIE9iamVjdCBjdHgsIFN0YXQgc3RhdCkgewogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAocmMgPT0gQ29kZS5OT05PREUuaW50VmFsdWUo\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gbm9kZQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9u\nRmFpbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2Rl\nLk5PX1RPUElDX1BFUlNJU1RFTkNFX0lORk8sCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm8g\ncGVyc2lzdGVuY2UgaW5mbyBmb3VuZCBmb3IgdG9waWMgIiArIHRvcGljLnRv\nU3RyaW5nVXRmOCgpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmMg\nPT0gQ29kZS5CYWRWZXJzaW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAvLyBiYWQgdmVyc2lvbgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgUHViU3ViRXhjZXB0\naW9uLmNyZWF0ZShTdGF0dXNDb2RlLkJBRF9WRVJTSU9OLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIkJhZCB2ZXJzaW9uIHByb3ZpZGVkIHRvIHVwZGF0ZSBwZXJzaXN0ZW5j\nZSBpbmZvIG9mIHRvcGljICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSkpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAg\nICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJjID09IENvZGUuT0suaW50VmFs\ndWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2su\nb3BlcmF0aW9uRmluaXNoZWQoY3R4LCBuZXcgWmtWZXJzaW9uKHN0YXQuZ2V0\nVmVyc2lvbigpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24ga2UgPSBaa1V0\naWxzLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRpb24oCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICJDb3VsZCBub3Qgd3JpdGUgbGVk\nZ2VycyBub2RlIGZvciB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgp\nLCBwYXRoLCByYyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxs\nYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9u\nLlNlcnZpY2VEb3duRXhjZXB0aW9uKGtlKSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGN0eCk7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9p\nZCBkZWxldGVUb3BpY1BlcnNpc3RlbmNlSW5mbyhmaW5hbCBCeXRlU3RyaW5n\nIHRvcGljLCBmaW5hbCBWZXJzaW9uIHZlcnNpb24sCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgQ2FsbGJh\nY2s8Vm9pZD4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAg\nZmluYWwgU3RyaW5nIHpOb2RlUGF0aCA9IGxlZGdlcnNQYXRoKHRvcGljKTsK\nCiAgICAgICAgICAgIGludCB6bm9kZVZlcnNpb24gPSAtMTsKICAgICAgICAg\nICAgaWYgKFZlcnNpb24uQU5ZICE9IHZlcnNpb24pIHsKICAgICAgICAgICAg\nICAgIGlmICghKHZlcnNpb24gaW5zdGFuY2VvZiBaa1ZlcnNpb24pKSB7CiAg\nICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0\neCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5VbmV4cGVjdGVkQ29uZGl0aW9uRXhj\nZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICJJbnZhbGlkIHZlcnNpb24gcHJvdmlkZWQgdG8gZGVs\nZXRlIHBlcnNpc3RlbmNlIGluZm8gZm9yIHRvcGljICIgKyB0b3BpYy50b1N0\ncmluZ1V0ZjgoKSkpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgem5v\nZGVWZXJzaW9uID0gKChaa1ZlcnNpb24pdmVyc2lvbikuZ2V0Wm5vZGVWZXJz\naW9uKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgemsuZGVsZXRlKHpOb2RlUGF0aCwgem5vZGVWZXJzaW9uLCBuZXcg\nU2FmZUFzeW5jWktDYWxsYmFjay5Wb2lkQ2FsbGJhY2soKSB7CiAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVj\ndCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQ29kZS5P\nSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxi\nYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbnVsbCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9IGVs\nc2UgaWYgKHJjID09IENvZGUuTk9OT0RFLmludFZhbHVlKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gbm8gbm9kZQogICAgICAgICAgICAgICAg\nICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBQdWJTdWJF\neGNlcHRpb24uY3JlYXRlKFN0YXR1c0NvZGUuTk9fVE9QSUNfUEVSU0lTVEVO\nQ0VfSU5GTywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIk5vIHBlcnNpc3RlbmNlIGluZm8gZm91bmQg\nZm9yIHRvcGljICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSkpOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAg\nfSBlbHNlIGlmIChyYyA9PSBDb2RlLkJhZFZlcnNpb24pIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gYmFkIHZlcnNpb24KICAgICAgICAgICAgICAg\nICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgUHViU3Vi\nRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2RlLkJBRF9WRVJTSU9OLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAiQmFkIHZlcnNpb24gcHJvdmlkZWQgdG8gZGVsZXRlIHBlcnNpc3Rl\nbmNlIGluZm8gb2YgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpKSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlv\nbiBlID0gWmtVdGlscy5sb2dFcnJvckFuZENyZWF0ZVpLRXhjZXB0aW9uKCJU\nb3BpYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICArICIgZmFpbGVkIHRvIGRlbGV0\nZSBwZXJzaXN0ZW5jZSBpbmZvIEB2ZXJzaW9uICIgKyB2ZXJzaW9uICsgIiA6\nICIsIHBhdGgsIHJjKTsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZp\nY2VEb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSwgY3R4KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBab29LZWVwZXIgYmFzZWQgc3Vic2NyaXB0aW9uIGRhdGEgbWFuYWdlci4K\nICAgICAqLwogICAgc3RhdGljIGNsYXNzIFprU3Vic2NyaXB0aW9uRGF0YU1h\nbmFnZXJJbXBsIGltcGxlbWVudHMgU3Vic2NyaXB0aW9uRGF0YU1hbmFnZXIg\newoKICAgICAgICBab29LZWVwZXIgems7CiAgICAgICAgU2VydmVyQ29uZmln\ndXJhdGlvbiBjZmc7CgogICAgICAgIFprU3Vic2NyaXB0aW9uRGF0YU1hbmFn\nZXJJbXBsKFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiwgWm9vS2VlcGVyIHpr\nKSB7CiAgICAgICAgICAgIHRoaXMuY2ZnID0gY29uZjsKICAgICAgICAgICAg\ndGhpcy56ayA9IHprOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgICAgICAvLyBkbyBub3RoaW5nIGluIHpvb2tlZXBlciBiYXNl\nZCBpbXBsCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBHZXQg\nem5vZGUgcGF0aCB0byBzdG9yZSBzdWJzY3JpcHRpb24gc3RhdGVzLgogICAg\nICAgICAqCiAgICAgICAgICogQHBhcmFtIHNiCiAgICAgICAgICogICAgICAg\nICAgU3RyaW5nIGJ1aWxkZXIgdG8gc3RvcmUgdGhlIHpub2RlIHBhdGguCiAg\nICAgICAgICogQHBhcmFtIHRvcGljCiAgICAgICAgICogICAgICAgICAgVG9w\naWMgbmFtZS4KICAgICAgICAgKgogICAgICAgICAqIEByZXR1cm4gc3RyaW5n\nIGJ1aWxkZXIgdG8gc3RvcmUgem5vZGUgcGF0aC4KICAgICAgICAgKi8KICAg\nICAgICBwcml2YXRlIFN0cmluZ0J1aWxkZXIgdG9waWNTdWJzY3JpYmVyc1Bh\ndGgoU3RyaW5nQnVpbGRlciBzYiwgQnl0ZVN0cmluZyB0b3BpYykgewogICAg\nICAgICAgICByZXR1cm4gY2ZnLmdldFprVG9waWNQYXRoKHNiLCB0b3BpYyku\nYXBwZW5kKCIvc3Vic2NyaWJlcnMiKTsKICAgICAgICB9CgogICAgICAgIC8q\nKgogICAgICAgICAqIEdldCB6bm9kZSBwYXRoIHRvIHN0b3JlIHN1YnNjcmlw\ndGlvbiBzdGF0ZSBmb3IgYSBzcGVjaWZpZWQgc3Vic2NyaWJlci4KICAgICAg\nICAgKgogICAgICAgICAqIEBwYXJhbSB0b3BpYwogICAgICAgICAqICAgICAg\nICAgIFRvcGljIG5hbWUuCiAgICAgICAgICogQHBhcmFtIHN1YnNjcmliZXIK\nICAgICAgICAgKiAgICAgICAgICBTdWJzY3JpYmVyIGlkLgogICAgICAgICAq\nIEByZXR1cm4gem5vZGUgcGF0aCB0byBzdG9yZSBzdWJzY3JpcHRpb24gc3Rh\ndGUuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBTdHJpbmcgdG9waWNT\ndWJzY3JpYmVyUGF0aChCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1\nYnNjcmliZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRvcGljU3Vic2NyaWJl\ncnNQYXRoKG5ldyBTdHJpbmdCdWlsZGVyKCksIHRvcGljKS5hcHBlbmQoIi8i\nKS5hcHBlbmQoc3Vic2NyaWJlci50b1N0cmluZ1V0ZjgoKSkKICAgICAgICAg\nICAgICAgICAgIC50b1N0cmluZygpOwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gaXNQYXJ0aWFsVXBkYXRl\nU3VwcG9ydGVkKCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBj\ncmVhdGVTdWJzY3JpcHRpb25EYXRhKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMs\nIGZpbmFsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBmaW5hbCBTdWJzY3Jp\ncHRpb25EYXRhIGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFj\naywgZmluYWwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICBaa1V0aWxzLmNy\nZWF0ZUZ1bGxQYXRoT3B0aW1pc3RpYyh6aywgdG9waWNTdWJzY3JpYmVyUGF0\naCh0b3BpYywgc3Vic2NyaWJlcklkKSwgZGF0YS50b0J5dGVBcnJheSgpLAog\nICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBF\nUlNJU1RFTlQsIG5ldyBTYWZlQXN5bmNaS0NhbGxiYWNrLlN0cmluZ0NhbGxi\nYWNrKCkgewoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBT\ndHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgU3RyaW5nIG5hbWUpIHsKCiAgICAg\nICAgICAgICAgICAgICAgaWYgKHJjID09IENvZGUuTk9ERUVYSVNUUy5pbnRW\nYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9w\nZXJhdGlvbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3Rh\ndHVzQ29kZS5TVUJTQ1JJUFRJT05fU1RBVEVfRVhJU1RTLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi\nU3Vic2NyaXB0aW9uIHN0YXRlIGZvciAodG9waWM6IiArIHRvcGljLnRvU3Ry\naW5nVXRmOCgpICsgIiwgc3Vic2NyaWJlcjoiCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc3Vic2Ny\naWJlcklkLnRvU3RyaW5nVXRmOCgpICsgIikgZXhpc3RlZC4iKSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICB9IGVsc2UgaWYgKHJjID09IENvZGUuT0suaW50VmFsdWUoKSkgewogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVk\nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1\nZygiU3VjY2Vzc2Z1bGx5IHJlY29yZGVkIHN1YnNjcmlwdGlvbiBmb3IgdG9w\naWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIg\nKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkgKyAiIGRhdGE6ICIKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFN1YnNj\ncmlwdGlvblN0YXRlVXRpbHMudG9TdHJpbmcoZGF0YSkpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxi\nYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbmV3IFprVmVyc2lvbigwKSk7\nCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGtlID0gWmtVdGlscy5sb2dFcnJv\nckFuZENyZWF0ZVpLRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkIG5vdCByZWNvcmQg\nbmV3IHN1YnNjcmlwdGlvbiBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmlu\nZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJ\nZC50b1N0cmluZ1V0ZjgoKSwgcGF0aCwgcmMpOwogICAgICAgICAgICAgICAg\nICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHVi\nU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKGtlKSk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9LCBjdHgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIHZvaWQgdXBkYXRlU3Vic2NyaXB0aW9uRGF0YShmaW5hbCBC\neXRlU3RyaW5nIHRvcGljLCBmaW5hbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJ\nZCwgZmluYWwgU3Vic2NyaXB0aW9uRGF0YSBkYXRhLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgVmVyc2lvbiB2\nZXJzaW9uLCBmaW5hbCBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgZmlu\nYWwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBw\nb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oIlpvb0tlZXBlciBiYXNlZCBtZXRh\nZGF0YSBtYW5hZ2VyIGRvZXNuJ3Qgc3VwcG9ydCBwYXJ0aWFsIHVwZGF0ZSEi\nKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIHJlcGxhY2VTdWJzY3JpcHRpb25EYXRhKGZpbmFsIEJ5dGVTdHJp\nbmcgdG9waWMsIGZpbmFsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBmaW5h\nbCBTdWJzY3JpcHRpb25EYXRhIGRhdGEsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgVmVyc2lvbiB2ZXJzaW9u\nLCBmaW5hbCBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgZmluYWwgT2Jq\nZWN0IGN0eCkgewogICAgICAgICAgICBpbnQgem5vZGVWZXJzaW9uID0gLTE7\nCiAgICAgICAgICAgIGlmIChWZXJzaW9uLk5FVyA9PSB2ZXJzaW9uKSB7CiAg\nICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCAK\nICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFB1YlN1YkV4Y2VwdGlvbi5C\nYWRWZXJzaW9uRXhjZXB0aW9uKCJDYW4gbm90IHJlcGxhY2UgVmVyc2lvbi5O\nZXcgc3Vic2NyaXB0aW9uIGRhdGEiKSk7CiAgICAgICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgICAgIH0gZWxzZSBpZiAoVmVyc2lvbi5BTlkgIT0gdmVy\nc2lvbikgewogICAgICAgICAgICAgICAgaWYgKCEodmVyc2lvbiBpbnN0YW5j\nZW9mIFprVmVyc2lvbikpIHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVu\nZXhwZWN0ZWRDb25kaXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkludmFsaWQgdmVy\nc2lvbiBwcm92aWRlZCB0byByZXBsYWNlIHN1YnNjcmlwdGlvbiBkYXRhIGZv\nciB0b3BpYyAgIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiBz\ndWJzY3JpYmUgaWQ6ICIgKyBzdWJzY3JpYmVySWQpKTsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgIHpub2RlVmVyc2lvbiA9ICgoWmtWZXJzaW9uKXZl\ncnNpb24pLmdldFpub2RlVmVyc2lvbigpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHprLnNldERhdGEodG9waWNTdWJz\nY3JpYmVyUGF0aCh0b3BpYywgc3Vic2NyaWJlcklkKSwgZGF0YS50b0J5dGVB\ncnJheSgpLCAKICAgICAgICAgICAgICAgICAgICB6bm9kZVZlcnNpb24sIG5l\ndyBTYWZlQXN5bmNaS0NhbGxiYWNrLlN0YXRDYWxsYmFjaygpIHsKICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZv\naWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2Jq\nZWN0IGN0eCwgU3RhdCBzdGF0KSB7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKHJjID09IENvZGUuTk9OT0RFLmludFZhbHVlKCkpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgLy8gbm8gbm9kZQogICAgICAgICAgICAgICAgICAgICAg\nICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBQdWJTdWJFeGNlcHRp\nb24uY3JlYXRlKFN0YXR1c0NvZGUuTk9fU1VCU0NSSVBUSU9OX1NUQVRFLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAiTm8gc3Vic2NyaXB0aW9uIHN0YXRlIGZvdW5kIGZvciAodG9w\naWM6IiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiwgc3Vic2NyaWJlcjoi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpICsgIiku\nIikpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgICAgICAgICAgfSBlbHNlIGlmIChyYyA9PSBDb2RlLkJhZFZlcnNpb24p\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFkIHZlcnNpb24KICAg\nICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVk\nKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2RlLkJBRF9W\nRVJTSU9OLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAiQmFkIHZlcnNpb24gcHJvdmlkZWQgdG8gcmVw\nbGFjZSBzdWJzY3JpcHRpb24gZGF0YSBvZiB0b3BpYyAiIAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr\nIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiBzdWJzY3JpYmVySWQgIiArIHN1\nYnNjcmliZXJJZCkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyYyAhPSBDb2RlLk9L\nLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVy\nRXhjZXB0aW9uIGUgPSBaa1V0aWxzLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNl\ncHRpb24oIlRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgc3Vi\nc2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAi\nIGNvdWxkIG5vdCBzZXQgc3Vic2NyaXB0aW9uIGRhdGE6ICIgKyBTdWJzY3Jp\ncHRpb25TdGF0ZVV0aWxzLnRvU3RyaW5nKGRhdGEpLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgsIHJjKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVk\nKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlv\nbihlKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoIlN1\nY2Nlc3NmdWxseSB1cGRhdGVkIHN1YnNjcmlwdGlvbiBmb3IgdG9waWM6ICIg\nKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBzdWJz\nY3JpYmVySWQudG9TdHJpbmdVdGY4KCkgKyAiIGRhdGE6ICIKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFN1YnNjcmlwdGlv\nblN0YXRlVXRpbHMudG9TdHJpbmcoZGF0YSkpOwogICAgICAgICAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GaW5pc2hlZChjdHgsIG5ldyBaa1ZlcnNpb24oc3RhdC5nZXRW\nZXJzaW9uKCkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0sIGN0eCk7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBkZWxldGVTdWJzY3Jp\ncHRpb25EYXRhKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIEJ5dGVT\ndHJpbmcgc3Vic2NyaWJlcklkLCBWZXJzaW9uIHZlcnNpb24sCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBDYWxs\nYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAgICAgICAg\nICAKICAgICAgICAgICAgaW50IHpub2RlVmVyc2lvbiA9IC0xOwogICAgICAg\nICAgICBpZiAoVmVyc2lvbi5ORVcgPT0gdmVyc2lvbikgewogICAgICAgICAg\nICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgCiAgICAgICAg\nICAgICAgICAgICAgICAgIG5ldyBQdWJTdWJFeGNlcHRpb24uQmFkVmVyc2lv\nbkV4Y2VwdGlvbigiQ2FuIG5vdCBkZWxldGUgVmVyc2lvbi5OZXcgc3Vic2Ny\naXB0aW9uIGRhdGEiKSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgIH0gZWxzZSBpZiAoVmVyc2lvbi5BTlkgIT0gdmVyc2lvbikgewog\nICAgICAgICAgICAgICAgaWYgKCEodmVyc2lvbiBpbnN0YW5jZW9mIFprVmVy\nc2lvbikpIHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRD\nb25kaXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIkludmFsaWQgdmVyc2lvbiBwcm92\naWRlZCB0byBkZWxldGUgc3Vic2NyaXB0aW9uIGRhdGEgZm9yIHRvcGljICAi\nIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAiIHN1YnNjcmliZSBp\nZDogIiArIHN1YnNjcmliZXJJZCkpOwogICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgem5vZGVWZXJzaW9uID0gKChaa1ZlcnNpb24pdmVyc2lvbikuZ2V0\nWm5vZGVWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHprLmRlbGV0ZSh0b3BpY1N1\nYnNjcmliZXJQYXRoKHRvcGljLCBzdWJzY3JpYmVySWQpLCB6bm9kZVZlcnNp\nb24sIG5ldyBTYWZlQXN5bmNaS0NhbGxiYWNrLlZvaWRDYWxsYmFjaygpIHsK\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0\naCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyYyA9\nPSBDb2RlLk5PTk9ERS5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIG5vIG5vZGUKICAgICAgICAgICAgICAgICAgICAgICAgY2Fs\nbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNy\nZWF0ZShTdGF0dXNDb2RlLk5PX1NVQlNDUklQVElPTl9TVEFURSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIk5vIHN1YnNjcmlwdGlvbiBzdGF0ZSBmb3VuZCBmb3IgKHRvcGljOiIg\nKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmliZXI6IgogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0ZjgoKSArICIpLiIpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgICAgIH0gZWxzZSBpZiAocmMgPT0gQ29kZS5CYWRWZXJzaW9uKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIGJhZCB2ZXJzaW9uCiAgICAgICAg\nICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgs\nIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29kZS5CQURfVkVSU0lP\nTiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIkJhZCB2ZXJzaW9uIHByb3ZpZGVkIHRvIGRlbGV0ZSBz\ndWJzY3JpcHRpb24gZGF0YSBvZiB0b3BpYyAiIAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHRvcGlj\nLnRvU3RyaW5nVXRmOCgpICsgIiBzdWJzY3JpYmVySWQgIiArIHN1YnNjcmli\nZXJJZCkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyYyA9PSBDb2RlLk9LLmludFZh\nbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5p\nc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBsb2dnZXIuZGVidWcoIlN1Y2Nlc3NmdWxseSBkZWxldGVkIHN1YnNjcmlw\ndGlvbiBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWJz\nY3JpYmVySWQ6ICIgKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAg\nICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjdHgsIG51bGwpOwog\nICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24g\nZSA9IFprVXRpbHMubG9nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigiVG9w\naWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiAr\nIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0ZjgoKSArICIgZmFpbGVkIHRvIGRl\nbGV0ZSBzdWJzY3JpcHRpb24iLCBwYXRoLCByYyk7CiAgICAgICAgICAgICAg\nICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1\nYkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbihlKSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0sIGN0eCk7CiAgICAgICAgfQoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCByZWFkU3Vic2Ny\naXB0aW9uRGF0YShmaW5hbCBCeXRlU3RyaW5nIHRvcGljLCBmaW5hbCBCeXRl\nU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBmaW5hbCBDYWxsYmFjazxWZXJzaW9uZWQ8U3Vi\nc2NyaXB0aW9uRGF0YT4+IGNhbGxiYWNrLCBmaW5hbCBPYmplY3QgY3R4KSB7\nCiAgICAgICAgICAgIHprLmdldERhdGEodG9waWNTdWJzY3JpYmVyUGF0aCh0\nb3BpYywgc3Vic2NyaWJlcklkKSwgZmFsc2UsIG5ldyBTYWZlQXN5bmNaS0Nh\nbGxiYWNrLkRhdGFDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NS\nZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgYnl0ZVtd\nIGRhdGEsIFN0YXQgc3RhdCkgewogICAgICAgICAgICAgICAgICAgIGlmIChy\nYyA9PSBDb2RlLk5PTk9ERS5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbnVs\nbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IENv\nZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBL\nZWVwZXJFeGNlcHRpb24gZSA9IFprVXRpbHMubG9nRXJyb3JBbmRDcmVhdGVa\nS0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIkNvdWxkIG5vdCByZWFkIHN1YnNjcmlwdGlvbiBk\nYXRhIGZvciB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nIiwgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRm\nOCgpLCBwYXRoLCByYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxi\nYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24u\nU2VydmljZURvd25FeGNlcHRpb24oZSkpOwogICAgICAgICAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIFZlcnNpb25lZDxTdWJz\nY3JpcHRpb25EYXRhPiBzdWJEYXRhOwogICAgICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1YkRhdGEgPSBuZXcgVmVy\nc2lvbmVkPFN1YnNjcmlwdGlvbkRhdGE+KAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgU3Vic2NyaXB0aW9uU3RhdGVVdGlscy5w\nYXJzZVN1YnNjcmlwdGlvbkRhdGEoZGF0YSksIAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFprVmVyc2lvbihzdGF0Lmdl\ndFZlcnNpb24oKSkpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElu\ndmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiBleCkgewogICAgICAgICAg\nICAgICAgICAgICAgICBTdHJpbmcgbXNnID0gIkZhaWxlZCB0byBkZXNlcmlh\nbGl6ZSBzdWJzY3JpcHRpb24gZGF0YSBmb3IgdG9waWM6ICIgKyB0b3BpYy50\nb1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJZC50b1N0\ncmluZ1V0ZjgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKG1zZywgZXgpOwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVu\nZXhwZWN0ZWRDb25kaXRpb25FeGNlcHRpb24obXNnKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQo\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoIkZv\ndW5kIHN1YnNjcmlwdGlvbiB3aGlsZSBhY3F1aXJpbmcgdG9waWM6ICIgKyB0\nb3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJ\nZC50b1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgKyAiIGRhdGE6ICIgKyBTdWJzY3JpcHRpb25TdGF0ZVV0aWxz\nLnRvU3RyaW5nKHN1YkRhdGEuZ2V0VmFsdWUoKSkpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GaW5pc2hlZChjdHgsIHN1YkRhdGEpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9LCBjdHgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIHZvaWQgcmVhZFN1YnNjcmlwdGlvbnMoZmlu\nYWwgQnl0ZVN0cmluZyB0b3BpYywKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBDYWxsYmFjazxNYXA8Qnl0ZVN0cmluZywg\nVmVyc2lvbmVkPFN1YnNjcmlwdGlvbkRhdGE+Pj4gY2IsIGZpbmFsIE9iamVj\ndCBjdHgpIHsKICAgICAgICAgICAgU3RyaW5nIHRvcGljU3Vic2NyaWJlcnNQ\nYXRoID0gdG9waWNTdWJzY3JpYmVyc1BhdGgobmV3IFN0cmluZ0J1aWxkZXIo\nKSwgdG9waWMpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIHprLmdldENoaWxk\ncmVuKHRvcGljU3Vic2NyaWJlcnNQYXRoLCBmYWxzZSwgbmV3IFNhZmVBc3lu\nY1pLQ2FsbGJhY2suQ2hpbGRyZW5DYWxsYmFjaygpIHsKICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2Fm\nZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgZmluYWwgT2Jq\nZWN0IGN0eCwgZmluYWwgTGlzdDxTdHJpbmc+IGNoaWxkcmVuKSB7CgogICAg\nICAgICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9LLmludFZhbHVlKCkg\nJiYgcmMgIT0gQ29kZS5OT05PREUuaW50VmFsdWUoKSkgewogICAgICAgICAg\nICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24gZSA9IFprVXRpbHMubG9n\nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigiQ291bGQgbm90IHJlYWQgc3Vi\nc2NyaWJlcnMgZm9yIHRvcGljICIKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpLCBw\nYXRoLCByYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlv\nbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25F\neGNlcHRpb24oZSkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBm\naW5hbCBNYXA8Qnl0ZVN0cmluZywgVmVyc2lvbmVkPFN1YnNjcmlwdGlvbkRh\ndGE+PiB0b3BpY1N1YnMgPSAKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBDb25jdXJyZW50SGFzaE1hcDxCeXRlU3RyaW5nLCBWZXJzaW9uZWQ8\nU3Vic2NyaXB0aW9uRGF0YT4+KCk7CgogICAgICAgICAgICAgICAgICAgIGlm\nIChyYyA9PSBDb2RlLk5PTk9ERS5pbnRWYWx1ZSgpIHx8IGNoaWxkcmVuLnNp\nemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2dn\nZXIuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbG9nZ2VyLmRlYnVnKCJObyBzdWJzY3JpcHRpb25zIGZvdW5kIHdo\naWxlIGFjcXVpcmluZyB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgp\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgICAgICBjYi5vcGVyYXRpb25GaW5pc2hlZChjdHgsIHRvcGljU3Vicyk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZpbmFsIEF0b21pY0Jv\nb2xlYW4gZmFpbGVkID0gbmV3IEF0b21pY0Jvb2xlYW4oKTsKICAgICAgICAg\nICAgICAgICAgICBmaW5hbCBBdG9taWNJbnRlZ2VyIGNvdW50ID0gbmV3IEF0\nb21pY0ludGVnZXIoKTsKCiAgICAgICAgICAgICAgICAgICAgZm9yIChmaW5h\nbCBTdHJpbmcgY2hpbGQgOiBjaGlsZHJlbikgewoKICAgICAgICAgICAgICAg\nICAgICAgICAgZmluYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQgPSBCeXRl\nU3RyaW5nLmNvcHlGcm9tVXRmOChjaGlsZCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsIFN0cmluZyBjaGlsZFBhdGggPSBwYXRoICsgIi8iICsg\nY2hpbGQ7CgogICAgICAgICAgICAgICAgICAgICAgICB6ay5nZXREYXRhKGNo\naWxkUGF0aCwgZmFsc2UsIG5ldyBTYWZlQXN5bmNaS0NhbGxiYWNrLkRhdGFD\nYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0\nIGN0eCwgYnl0ZVtdIGRhdGEsIFN0YXQgc3RhdCkgewoKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1\nZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtl\nZXBlckV4Y2VwdGlvbiBlID0gWmtVdGlscy5sb2dFcnJvckFuZENyZWF0ZVpL\nRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAiQ291bGQgbm90IHJlYWQgc3Vi\nc2NyaXB0aW9uIGRhdGEgZm9yIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdV\ndGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyAiLCBzdWJzY3JpYmVySWQ6ICIgKyBz\ndWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCksIHBhdGgsIHJjKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0RmFpbHVyZShu\nZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKGUpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWxlZC5nZXQoKSkgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBWZXJzaW9uZWQ8U3Vic2NyaXB0aW9uRGF0YT4g\nc3ViRGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJEYXRh\nID0gbmV3IFZlcnNpb25lZDxTdWJzY3JpcHRpb25EYXRhPigKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJzY3JpcHRp\nb25TdGF0ZVV0aWxzLnBhcnNlU3Vic2NyaXB0aW9uRGF0YShkYXRhKSwgCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3\nIFprVmVyc2lvbihzdGF0LmdldFZlcnNpb24oKSkpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludmFsaWRQcm90b2NvbEJ1\nZmZlckV4Y2VwdGlvbiBleCkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBTdHJpbmcgbXNnID0gIkZhaWxlZCB0byBkZXNlcmlhbGl6\nZSBzdWJzY3JpcHRpb24gZGF0YSBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0\ncmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmli\nZXJJZC50b1N0cmluZ1V0ZjgoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG1zZywgZXgpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnRGYWlsdXJlKG5ldyBQ\ndWJTdWJFeGNlcHRpb24uVW5leHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbiht\nc2cpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVn\nRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1ZygiRm91bmQgc3Vic2NyaXB0aW9uIHdoaWxlIGFj\ncXVpcmluZyB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr\nICIgc3Vic2NyaWJlcklkOiAiICsgY2hpbGQgKyAic3RhdGU6ICIKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nU3Vic2NyaXB0aW9uU3RhdGVVdGlscy50b1N0cmluZyhzdWJEYXRhLmdldFZh\nbHVlKCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcGljU3Vicy5wdXQo\nc3Vic2NyaWJlcklkLCBzdWJEYXRhKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoY291bnQuaW5jcmVtZW50QW5kR2V0KCkgPT0gY2hp\nbGRyZW4uc2l6ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGFzc2VydCB0b3BpY1N1YnMuc2l6ZSgpID09IGNvdW50LmdldCgp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYi5vcGVy\nYXRpb25GaW5pc2hlZChjdHgsIHRvcGljU3Vicyk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaXZhdGUgdm9p\nZCByZXBvcnRGYWlsdXJlKFB1YlN1YkV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWxlZC5jb21wYXJlQW5k\nU2V0KGZhbHNlLCB0cnVlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgY2Iub3BlcmF0aW9uRmFpbGVkKGN0eCwgZSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0sIGN0eCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9LCBjdHgpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFpvb0tlZXBlciBiYXNlIHRvcGljIG93bmVyc2hpcCBt\nYW5hZ2VyLgogICAgICovCiAgICBzdGF0aWMgY2xhc3MgWmtUb3BpY093bmVy\nc2hpcE1hbmFnZXJJbXBsIGltcGxlbWVudHMgVG9waWNPd25lcnNoaXBNYW5h\nZ2VyIHsKCiAgICAgICAgWm9vS2VlcGVyIHprOwogICAgICAgIFNlcnZlckNv\nbmZpZ3VyYXRpb24gY2ZnOwoKICAgICAgICBaa1RvcGljT3duZXJzaGlwTWFu\nYWdlckltcGwoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLCBab29LZWVwZXIg\nemspIHsKICAgICAgICAgICAgdGhpcy5jZmcgPSBjb25mOwogICAgICAgICAg\nICB0aGlzLnprID0gems7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcgaW4gem9va2VlcGVyIGJh\nc2VkIGltcGwKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJl\ndHVybiB6bm9kZSBwYXRoIHRvIHN0b3JlIHRvcGljIG93bmVyLgogICAgICAg\nICAqCiAgICAgICAgICogQHBhcmFtIHRvcGljCiAgICAgICAgICogICAgICAg\nICAgVG9waWMgTmFtZQogICAgICAgICAqIEByZXR1cm4gem5vZGUgcGF0aCB0\nbyBzdG9yZSB0b3BpYyBvd25lci4KICAgICAgICAgKi8KICAgICAgICBTdHJp\nbmcgaHViUGF0aChCeXRlU3RyaW5nIHRvcGljKSB7CiAgICAgICAgICAgIHJl\ndHVybiBjZmcuZ2V0WmtUb3BpY1BhdGgobmV3IFN0cmluZ0J1aWxkZXIoKSwg\ndG9waWMpLmFwcGVuZCgiL2h1YiIpLnRvU3RyaW5nKCk7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCByZWFkT3du\nZXJJbmZvKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIENhbGxiYWNr\nPFZlcnNpb25lZDxIdWJJbmZvPj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgU3RyaW5nIG93bmVyUGF0aCA9IGh1YlBhdGgodG9waWMp\nOwogICAgICAgICAgICB6ay5nZXREYXRhKG93bmVyUGF0aCwgZmFsc2UsIG5l\ndyBTYWZlQXN5bmNaS0NhbGxiYWNrLkRhdGFDYWxsYmFjaygpIHsKICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZv\naWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2Jq\nZWN0IGN0eCwgYnl0ZVtdIGRhdGEsIFN0YXQgc3RhdCkgewogICAgICAgICAg\nICAgICAgICAgIGlmIChDb2RlLk5PTk9ERS5pbnRWYWx1ZSgpID09IHJjKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZp\nbmlzaGVkKGN0eCwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\nICAgIGlmIChDb2RlLk9LLmludFZhbHVlKCkgIT0gcmMpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGUgPSBaa1V0aWxzLmxv\nZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRpb24oIkNvdWxkIG5vdCByZWFkIG93\nbmVyc2hpcCBmb3IgdG9waWM6ICIKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpLCBw\nYXRoLCByYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9w\nZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2Vydmlj\nZURvd25FeGNlcHRpb24oZSkpOwogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIEh1YkluZm8gb3duZXIgPSBudWxsOwogICAgICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG93bmVyID0gSHViSW5m\nby5wYXJzZShuZXcgU3RyaW5nKGRhdGEpKTsKICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChIdWJJbmZvLkludmFsaWRIdWJJbmZvRXhjZXB0aW9uIGlo\naWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm4oIkZh\naWxlZCB0byBwYXJzZSBodWIgaW5mbyBmb3IgdG9waWMgIiArIHRvcGljLnRv\nU3RyaW5nVXRmOCgpICsgIiA6ICIsIGloaWUpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICBpbnQgdmVyc2lvbiA9IHN0YXQu\nZ2V0VmVyc2lvbigpOwogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9w\nZXJhdGlvbkZpbmlzaGVkKGN0eCwgbmV3IFZlcnNpb25lZDxIdWJJbmZvPihv\nd25lciwgbmV3IFprVmVyc2lvbih2ZXJzaW9uKSkpOwogICAgICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfSwgY3R4KTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyB2b2lkIHdyaXRlT3duZXJJbmZvKGZpbmFsIEJ5dGVTdHJpbmcg\ndG9waWMsIGZpbmFsIEh1YkluZm8gb3duZXIsIGZpbmFsIFZlcnNpb24gdmVy\nc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5h\nbCBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewog\nICAgICAgICAgICBpZiAoVmVyc2lvbi5ORVcgPT0gdmVyc2lvbikgewogICAg\nICAgICAgICAgICAgY3JlYXRlT3duZXJJbmZvKHRvcGljLCBvd25lciwgY2Fs\nbGJhY2ssIGN0eCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIGlmICghKHZlcnNpb24gaW5zdGFuY2VvZiBa\na1ZlcnNpb24pKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRD\nb25kaXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAiSW52YWxpZCB2ZXJzaW9uIHByb3ZpZGVk\nIHRvIHVwZGF0ZSBvd25lciBpbmZvIGZvciB0b3BpYyAiICsgdG9waWMudG9T\ndHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgaW50IHpub2RlVmVyc2lvbiA9ICgoWmtW\nZXJzaW9uKXZlcnNpb24pLmdldFpub2RlVmVyc2lvbigpOwogICAgICAgICAg\nICB6ay5zZXREYXRhKGh1YlBhdGgodG9waWMpLCBvd25lci50b1N0cmluZygp\nLmdldEJ5dGVzKCksIHpub2RlVmVyc2lvbiwKICAgICAgICAgICAgICAgICAg\nICAgICBuZXcgU2FmZUFzeW5jWktDYWxsYmFjay5TdGF0Q2FsbGJhY2soKSB7\nCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBh\ndGgsIE9iamVjdCBjdHgsIFN0YXQgc3RhdCkgewogICAgICAgICAgICAgICAg\nICAgIGlmIChyYyA9PSBDb2RlLk5PTk9ERS5pbnRWYWx1ZSgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIG5vIG5vZGUKICAgICAgICAgICAgICAg\nICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgUHViU3Vi\nRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2RlLk5PX1RPUElDX09XTkVSX0lO\nRk8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICJObyBvd25lciBpbmZvIGZvdW5kIGZvciB0b3BpYyAi\nICsgdG9waWMudG9TdHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAo\ncmMgPT0gQ29kZS5CYWRWZXJzaW9uKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIGJhZCB2ZXJzaW9uCiAgICAgICAgICAgICAgICAgICAgICAgIGNh\nbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5j\ncmVhdGUoU3RhdHVzQ29kZS5CQURfVkVSU0lPTiwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhZCB2\nZXJzaW9uIHByb3ZpZGVkIHRvIHVwZGF0ZSBvd25lciBpbmZvIG9mIHRvcGlj\nICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSkpOwogICAgICAgICAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlm\nIChDb2RlLk9LLmludFZhbHVlKCkgPT0gcmMpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBuZXcg\nWmtWZXJzaW9uKHN0YXQuZ2V0VmVyc2lvbigpKSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24gZSA9\nIFprVXRpbHMubG9nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICJGYWlsZWQgdG8gdXBkYXRlIG93bmVy\nc2hpcCBvZiB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIiB0byAiICsgb3duZXIsIHBhdGgs\nIHJjKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0\naW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93\nbkV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0sIGN0eCk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0\nZWQgdm9pZCBjcmVhdGVPd25lckluZm8oZmluYWwgQnl0ZVN0cmluZyB0b3Bp\nYywgZmluYWwgSHViSW5mbyBvd25lciwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZmluYWwgQ2FsbGJhY2s8VmVyc2lvbj4gY2Fs\nbGJhY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgU3RyaW5nIG93bmVy\nUGF0aCA9IGh1YlBhdGgodG9waWMpOwogICAgICAgICAgICBaa1V0aWxzLmNy\nZWF0ZUZ1bGxQYXRoT3B0aW1pc3RpYyh6aywgb3duZXJQYXRoLCBvd25lci50\nb1N0cmluZygpLmdldEJ5dGVzKCksIElkcy5PUEVOX0FDTF9VTlNBRkUsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENy\nZWF0ZU1vZGUuUEVSU0lTVEVOVCwgbmV3IFNhZmVBc3luY1pLQ2FsbGJhY2su\nU3RyaW5nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0\nKGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsIFN0cmluZyBuYW1l\nKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKENvZGUuT0suaW50VmFsdWUo\nKSA9PSByYykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBhc3N1bWUg\ndGhlIGluaXRpYWwgdmVyc2lvbiBpcyAwCiAgICAgICAgICAgICAgICAgICAg\nICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbmV3IFprVmVy\nc2lvbigwKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKENvZGUuTk9ERUVYSVNUUy5p\nbnRWYWx1ZSgpID09IHJjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8v\nIG5vZGUgZXhpc3RlZAogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LCBQdWJTdWJFeGNlcHRpb24uY3JlYXRl\nKFN0YXR1c0NvZGUuVE9QSUNfT1dORVJfSU5GT19FWElTVFMsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICJPd25lciBpbmZvIG9mIHRvcGljICIgKyB0b3BpYy50b1N0cmluZ1V0Zjgo\nKSArICIgZXhpc3RlZC4iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24gZSA9IFprVXRpbHMubG9n\nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkZhaWxlZCB0byBjcmVh\ndGUgem5vZGUgZm9yIG93bmVyc2hpcCBvZiB0b3BpYzogIgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHRvcGlj\nLnRvU3RyaW5nVXRmOCgpLCBwYXRoLCByYyk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJT\ndWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRpb24oZSkpOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBjdHgpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\nZGVsZXRlT3duZXJJbmZvKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFs\nIFZlcnNpb24gdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIE9iamVj\ndCBjdHgpIHsKICAgICAgICAgICAgaW50IHpub2RlVmVyc2lvbiA9IC0xOwog\nICAgICAgICAgICBpZiAoVmVyc2lvbi5BTlkgIT0gdmVyc2lvbikgewogICAg\nICAgICAgICAgICAgaWYgKCEodmVyc2lvbiBpbnN0YW5jZW9mIFprVmVyc2lv\nbikpIHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25G\nYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRDb25k\naXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIkludmFsaWQgdmVyc2lvbiBwcm92aWRl\nZCB0byBkZWxldGUgb3duZXIgaW5mbyBmb3IgdG9waWMgIiArIHRvcGljLnRv\nU3RyaW5nVXRmOCgpKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB6\nbm9kZVZlcnNpb24gPSAoKFprVmVyc2lvbil2ZXJzaW9uKS5nZXRabm9kZVZl\ncnNpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgemsuZGVsZXRlKGh1YlBhdGgodG9waWMpLCB6bm9kZVZlcnNp\nb24sIG5ldyBTYWZlQXN5bmNaS0NhbGxiYWNrLlZvaWRDYWxsYmFjaygpIHsK\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0\naCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgIGlmIChDb2Rl\nLk9LLmludFZhbHVlKCkgPT0gcmMpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoIlN1Y2Nlc3NmdWxseSBk\nZWxldGVkIG93bmVyIGluZm8gZm9yIHRvcGljICIgKyB0b3BpYy50b1N0cmlu\nZ1V0ZjgoKSArICIuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNo\nZWQoY3R4LCBudWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQ29kZS5OT05PREUu\naW50VmFsdWUoKSA9PSByYykgewogICAgICAgICAgICAgICAgICAgICAgICAv\nLyBubyBub2RlCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9w\nZXJhdGlvbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3Rh\ndHVzQ29kZS5OT19UT1BJQ19PV05FUl9JTkZPLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm8gb3du\nZXIgaW5mbyBmb3VuZCBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRm\nOCgpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgICAgICAgICB9IGVsc2UgaWYgKENvZGUuQmFkVmVyc2lvbiA9PSBy\nYykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWQgdmVyc2lvbgog\nICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWls\nZWQoY3R4LCBQdWJTdWJFeGNlcHRpb24uY3JlYXRlKFN0YXR1c0NvZGUuQkFE\nX1ZFUlNJT04sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICJCYWQgdmVyc2lvbiBwcm92aWRlZCB0byBk\nZWxldGUgb3duZXIgaW5mbyBvZiB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdV\ndGY4KCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIEtlZXBlckV4Y2VwdGlvbiBlID0gWmtVdGlscy5sb2dFcnJvckFuZENy\nZWF0ZVpLRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAiRmFpbGVkIHRvIGRlbGV0ZSBvd25lciBp\nbmZvIGZvciB0b3BpYyAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgdG9waWMudG9TdHJpbmdVdGY4KCksIHBh\ndGgsIHJjKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3Bl\ncmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNl\nRG93bkV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBjdHgpOwogICAgICAgIH0K\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGZvcm1hdChT\nZXJ2ZXJDb25maWd1cmF0aW9uIGNmZywgWm9vS2VlcGVyIHprKSB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFpLVXRp\nbC5kZWxldGVSZWN1cnNpdmUoemssIGNmZy5nZXRaa1RvcGljc1ByZWZpeChu\nZXcgU3RyaW5nQnVpbGRlcigpKS50b1N0cmluZygpKTsKICAgICAgICB9IGNh\ndGNoIChLZWVwZXJFeGNlcHRpb24uTm9Ob2RlRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgbG9nZ2VyLmRlYnVnKCJIZWR3aWcgcm9vdCBub2RlIGRvZXNu\nJ3QgZXhpc3QgaW4gem9va2VlcGVyIHRvIGRlbGV0ZSIpOwogICAgICAgIH0g\nY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0aHJv\ndyBuZXcgSU9FeGNlcHRpb24oa2UpOwogICAgICAgIH0gY2F0Y2ggKEludGVy\ncnVwdGVkRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbihpZSk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

