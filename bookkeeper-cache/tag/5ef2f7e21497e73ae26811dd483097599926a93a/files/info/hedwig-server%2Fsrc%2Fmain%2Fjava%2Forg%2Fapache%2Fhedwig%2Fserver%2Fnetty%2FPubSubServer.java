{"sha":"16bf417ff84598c995b10142ac42ec9d340b99f4","node_id":"MDQ6QmxvYjE1NzU5NTY6MTZiZjQxN2ZmODQ1OThjOTk1YjEwMTQyYWM0MmVjOWQzNDBiOTlmNA==","size":22317,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/16bf417ff84598c995b10142ac42ec9d340b99f4","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubmV0dHk7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEubmV0LkluZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS5u\nZXQuTWFsZm9ybWVkVVJMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNv\nbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291\nbnREb3duTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5FeGVj\ndXRvcnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TY2hlZHVsZWRF\neGVjdXRvclNlcnZpY2U7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5T\neW5jaHJvbm91c1F1ZXVlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQu\nVGltZVVuaXQ7CgppbXBvcnQgY29tLmdvb2dsZS5jb21tb24uYW5ub3RhdGlv\nbnMuVmlzaWJsZUZvclRlc3Rpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5jb25maWd1cmF0aW9uLkNvbmZpZ3VyYXRp\nb25FeGNlcHRpb247CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5XYXRjaGVkRXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5XYXRjaGVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9v\nS2VlcGVyOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmJvb3RzdHJhcC5TZXJ2\nZXJCb290c3RyYXA7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5n\ncm91cC5DaGFubmVsR3JvdXA7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hh\nbm5lbC5ncm91cC5EZWZhdWx0Q2hhbm5lbEdyb3VwOwppbXBvcnQgb3JnLmpi\nb3NzLm5ldHR5LmNoYW5uZWwuc29ja2V0LkNsaWVudFNvY2tldENoYW5uZWxG\nYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuc29ja2V0\nLlNlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5OwppbXBvcnQgb3JnLmpib3Nz\nLm5ldHR5LmNoYW5uZWwuc29ja2V0Lm5pby5OaW9DbGllbnRTb2NrZXRDaGFu\nbmVsRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLnNv\nY2tldC5uaW8uTmlvU2VydmVyU29ja2V0Q2hhbm5lbEZhY3Rvcnk7CmltcG9y\ndCBvcmcuamJvc3MubmV0dHkubG9nZ2luZy5JbnRlcm5hbExvZ2dlckZhY3Rv\ncnk7CmltcG9ydCBvcmcuamJvc3MubmV0dHkubG9nZ2luZy5Mb2c0SkxvZ2dl\nckZhY3Rvcnk7CgppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0aW9u\ncy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5w\ncm90b2NvbC5QdWJTdWJQcm90b2NvbC5PcGVyYXRpb25UeXBlOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1vbi5TZXJ2ZXJDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1v\nbi5UZXJtaW5hdGVKVk1FeGNlcHRpb25IYW5kbGVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLmRlbGl2ZXJ5LkRlbGl2ZXJ5TWFuYWdlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5kZWxpdmVyeS5GSUZP\nRGVsaXZlcnlNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLmhhbmRsZXJzLkNsb3NlU3Vic2NyaXB0aW9uSGFuZGxlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVycy5Db25zdW1lSGFu\nZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVy\ncy5IYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmhh\nbmRsZXJzLk5ldHR5SGFuZGxlckJlYW47CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIuaGFuZGxlcnMuUHVibGlzaEhhbmRsZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaGFuZGxlcnMuU3Vic2NyaWJlSGFu\nZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVy\ncy5TdWJzY3JpcHRpb25DaGFubmVsTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5oYW5kbGVycy5TdWJzY3JpcHRpb25DaGFubmVs\nTWFuYWdlci5TdWJDaGFubmVsRGlzY29ubmVjdGVkTGlzdGVuZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaGFuZGxlcnMuVW5zdWJzY3Jp\nYmVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmpt\neC5IZWR3aWdNQmVhblJlZ2lzdHJ5OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLm1ldGEuTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRhLlprTWV0YWRhdGFNYW5h\nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5w\nZXJzaXN0ZW5jZS5Cb29ra2VlcGVyUGVyc2lzdGVuY2VNYW5hZ2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLkxvY2Fs\nREJQZXJzaXN0ZW5jZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5zZXJ2ZXIucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2VNYW5hZ2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLlBlcnNp\nc3RlbmNlTWFuYWdlcldpdGhSYW5nZVNjYW47CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuUmVhZEFoZWFkQ2FjaGU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucmVnaW9ucy5IZWR3aWdI\ndWJDbGllbnRGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLnJlZ2lvbnMuUmVnaW9uTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnNlcnZlci5zc2wuU3NsU2VydmVyQ29udGV4dEZhY3Rvcnk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9ucy5J\nbk1lbW9yeVN1YnNjcmlwdGlvbk1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9ucy5TdWJzY3JpcHRpb25NYW5h\nZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnN1YnNjcmlw\ndGlvbnMuTU1TdWJzY3JpcHRpb25NYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLnRvcGljcy5NTVRvcGljTWFuYWdlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci50b3BpY3MuVG9waWNNYW5hZ2Vy\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljcy5Ucml2\naWFsT3duQWxsVG9waWNNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLnRvcGljcy5aa1RvcGljTWFuYWdlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnV0aWwuQ29uY3VycmVuY3lVdGlsczsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnV0aWwuRWl0aGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuem9va2VlcGVyLlNhZmVBc3luY0NhbGxiYWNrOwoKcHVibGlj\nIGNsYXNzIFB1YlN1YlNlcnZlciB7CgogICAgc3RhdGljIExvZ2dlciBsb2dn\nZXIgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihQdWJTdWJTZXJ2ZXIuY2xh\nc3MpOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBKTVhOQU1F\nX1BSRUZJWCA9ICJQdWJTdWJTZXJ2ZXJfIjsKCiAgICAvLyBOZXR0eSByZWxh\ndGVkIHZhcmlhYmxlcwogICAgU2VydmVyU29ja2V0Q2hhbm5lbEZhY3Rvcnkg\nc2VydmVyQ2hhbm5lbEZhY3Rvcnk7CiAgICBDbGllbnRTb2NrZXRDaGFubmVs\nRmFjdG9yeSBjbGllbnRDaGFubmVsRmFjdG9yeTsKICAgIFNlcnZlckNvbmZp\nZ3VyYXRpb24gY29uZjsKICAgIG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5j\nb25mLkNsaWVudENvbmZpZ3VyYXRpb24gY2xpZW50Q29uZmlndXJhdGlvbjsK\nICAgIENoYW5uZWxHcm91cCBhbGxDaGFubmVsczsKCiAgICAvLyBNYW5hZ2Vy\nIGNvbXBvbmVudHMgdGhhdCBtYWtlIHVwIHRoZSBQdWJTdWJTZXJ2ZXIKICAg\nIFBlcnNpc3RlbmNlTWFuYWdlciBwbTsKICAgIERlbGl2ZXJ5TWFuYWdlciBk\nbTsKICAgIFRvcGljTWFuYWdlciB0bTsKICAgIFN1YnNjcmlwdGlvbk1hbmFn\nZXIgc207CiAgICBSZWdpb25NYW5hZ2VyIHJtOwoKICAgIC8vIE1ldGFkYXRh\nIE1hbmFnZXIgRmFjdG9yeQogICAgTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSBt\nbTsKCiAgICBab29LZWVwZXIgems7IC8vIG51bGwgaWYgd2UgYXJlIGluIHN0\nYW5kYWxvbmUgbW9kZQogICAgQm9va0tlZXBlciBiazsgLy8gbnVsbCBpZiB3\nZSBhcmUgaW4gc3RhbmRhbG9uZSBtb2RlCgogICAgLy8gd2UgdXNlIHRoaXMg\ndG8gcHJldmVudCBsb25nIHN0YWNrIGNoYWlucyBmcm9tIGJ1aWxkaW5nIHVw\nIGluIGNhbGxiYWNrcwogICAgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNj\naGVkdWxlcjsKCiAgICAvLyBKTVggQmVhbnMKICAgIE5ldHR5SGFuZGxlckJl\nYW4gam14TmV0dHlCZWFuOwogICAgUHViU3ViU2VydmVyQmVhbiBqbXhTZXJ2\nZXJCZWFuOwogICAgZmluYWwgVGhyZWFkR3JvdXAgdGc7CgogICAgcHJvdGVj\ndGVkIFBlcnNpc3RlbmNlTWFuYWdlciBpbnN0YW50aWF0ZVBlcnNpc3RlbmNl\nTWFuYWdlcihUb3BpY01hbmFnZXIgdG9waWNNZ3IpIHRocm93cyBJT0V4Y2Vw\ndGlvbiwKICAgICAgICBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CgogICAgICAg\nIFBlcnNpc3RlbmNlTWFuYWdlcldpdGhSYW5nZVNjYW4gdW5kZXJseWluZ1BN\nOwoKICAgICAgICBpZiAoY29uZi5pc1N0YW5kYWxvbmUoKSkgewoKICAgICAg\nICAgICAgdW5kZXJseWluZ1BNID0gTG9jYWxEQlBlcnNpc3RlbmNlTWFuYWdl\nci5pbnN0YW5jZSgpOwoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlvbiBia0Nv\nbmYgPSBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpOwogICAgICAgICAgICAg\nICAgYmtDb25mLmFkZENvbmZpZ3VyYXRpb24oY29uZi5nZXRDb25mKCkpOwog\nICAgICAgICAgICAgICAgYmsgPSBuZXcgQm9va0tlZXBlcihia0NvbmYsIHpr\nLCBjbGllbnRDaGFubmVsRmFjdG9yeSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEtlZXBlckV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIu\nZXJyb3IoIkNvdWxkIG5vdCBpbnN0YW50aWF0ZSBib29ra2VlcGVyIGNsaWVu\ndCIsIGUpOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9u\nKGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVuZGVybHlpbmdQTSA9\nIG5ldyBCb29ra2VlcGVyUGVyc2lzdGVuY2VNYW5hZ2VyKGJrLCBtbSwgdG9w\naWNNZ3IsIGNvbmYsIHNjaGVkdWxlcik7CgogICAgICAgIH0KCiAgICAgICAg\nUGVyc2lzdGVuY2VNYW5hZ2VyIHBtID0gdW5kZXJseWluZ1BNOwoKICAgICAg\nICBpZiAoY29uZi5nZXRSZWFkQWhlYWRFbmFibGVkKCkpIHsKICAgICAgICAg\nICAgcG0gPSBuZXcgUmVhZEFoZWFkQ2FjaGUodW5kZXJseWluZ1BNLCBjb25m\nKS5zdGFydCgpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBtOwogICAg\nfQoKICAgIHByb3RlY3RlZCBTdWJzY3JpcHRpb25NYW5hZ2VyIGluc3RhbnRp\nYXRlU3Vic2NyaXB0aW9uTWFuYWdlcihUb3BpY01hbmFnZXIgdG0sIFBlcnNp\nc3RlbmNlTWFuYWdlciBwbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWxpdmVy\neU1hbmFnZXIgZG0pIHsKICAgICAgICBpZiAoY29uZi5pc1N0YW5kYWxvbmUo\nKSkgewogICAgICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5U3Vic2NyaXB0\naW9uTWFuYWdlcihjb25mLCB0bSwgcG0sIGRtLCBzY2hlZHVsZXIpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgTU1TdWJzY3Jp\ncHRpb25NYW5hZ2VyKGNvbmYsIG1tLCB0bSwgcG0sIGRtLCBzY2hlZHVsZXIp\nOwogICAgICAgIH0KCiAgICB9CgogICAgcHJvdGVjdGVkIFJlZ2lvbk1hbmFn\nZXIgaW5zdGFudGlhdGVSZWdpb25NYW5hZ2VyKFBlcnNpc3RlbmNlTWFuYWdl\nciBwbSwgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcikgewog\nICAgICAgIHJldHVybiBuZXcgUmVnaW9uTWFuYWdlcihwbSwgY29uZiwgemss\nIHNjaGVkdWxlciwgbmV3IEhlZHdpZ0h1YkNsaWVudEZhY3RvcnkoY29uZiwg\nY2xpZW50Q29uZmlndXJhdGlvbiwKICAgICAgICAgICAgICAgIGNsaWVudENo\nYW5uZWxGYWN0b3J5KSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgaW5z\ndGFudGlhdGVab29rZWVwZXJDbGllbnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIWNvbmYuaXNTdGFuZGFsb25lKCkpIHsKICAgICAgICAg\nICAgZmluYWwgQ291bnREb3duTGF0Y2ggc2lnbmFsWmtSZWFkeSA9IG5ldyBD\nb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgICAgIHprID0gbmV3IFpvb0tl\nZXBlcihjb25mLmdldFprSG9zdCgpLCBjb25mLmdldFprVGltZW91dCgpLCBu\nZXcgV2F0Y2hlcigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQg\nZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICBpZihFdmVudC5LZWVwZXJT\ndGF0ZS5TeW5jQ29ubmVjdGVkLmVxdWFscyhldmVudC5nZXRTdGF0ZSgpKSkg\newogICAgICAgICAgICAgICAgICAgICAgICBzaWduYWxaa1JlYWR5LmNvdW50\nRG93bigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIHdhaXQgdW50aWwg\nY29ubmVjdGlvbiBpcyBlZmZlY3RpdmUKICAgICAgICAgICAgaWYgKCFzaWdu\nYWxaa1JlYWR5LmF3YWl0KGNvbmYuZ2V0WmtUaW1lb3V0KCkqMiwgVGltZVVu\naXQuTUlMTElTRUNPTkRTKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJDb3VsZCBub3QgZXN0YWJsaXNoIGNvbm5lY3Rpb24gd2l0aCBab29L\nZWVwZXIgYWZ0ZXIgemtfdGltZW91dCoyID0gIiArCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY29uZi5nZXRaa1RpbWVvdXQoKSoyICsgIiBtcy4g\nKERlZmF1bHQgdmFsdWUgZm9yIHprX3RpbWVvdXQgaXMgMjAwMCkuIik7CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCJDb3VsZCBub3Qg\nZXN0YWJsaXNoIGNvbm5lY3Rpb24gd2l0aCBab29LZWVwZXIgYWZ0ZXIgemtf\ndGltZW91dCoyID0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGNvbmYuZ2V0WmtUaW1lb3V0KCkqMiArICIgbXMuIChEZWZhdWx0\nIHZhbHVlIGZvciB6a190aW1lb3V0IGlzIDIwMDApLiIpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGluc3Rh\nbnRpYXRlTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIGlmIChjb25mLmlzU3RhbmRhbG9uZSgpKSB7CiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgbW0gPSBNZXRhZGF0\nYU1hbmFnZXJGYWN0b3J5Lm5ld01ldGFkYXRhTWFuYWdlckZhY3RvcnkoY29u\nZiwgemspOwogICAgfQoKICAgIHByb3RlY3RlZCBUb3BpY01hbmFnZXIgaW5z\ndGFudGlhdGVUb3BpY01hbmFnZXIoKSB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIFRvcGljTWFuYWdlciB0bTsKCiAgICAgICAgaWYgKGNvbmYuaXNT\ndGFuZGFsb25lKCkpIHsKICAgICAgICAgICAgdG0gPSBuZXcgVHJpdmlhbE93\nbkFsbFRvcGljTWFuYWdlcihjb25mLCBzY2hlZHVsZXIpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAo\nY29uZi5pc01ldGFkYXRhTWFuYWdlckJhc2VkVG9waWNNYW5hZ2VyRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgdG0gPSBuZXcgTU1Ub3BpY01h\nbmFnZXIoY29uZiwgemssIG1tLCBzY2hlZHVsZXIpOwogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIShtbSBpbnN0\nYW5jZW9mIFprTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJVc2VzICIg\nKyBtbS5nZXRDbGFzcygpLmdldE5hbWUoKSArICIgdG8gc3RvcmUgaGVkd2ln\nIG1ldGFkYXRhLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiYnV0IHVzZXMgem9va2VlcGVyIGVwaGVtZXJhbCB6\nbm9kZXMgdG8gc3RvcmUgdG9waWMgb3duZXJzaGlwLiAiCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiQ2hlY2sgeW91\nciBjb25maWd1cmF0aW9uIGFzIHRoaXMgY291bGQgbGVhZCB0byBzY2FsYWJp\nbGl0eSBpc3N1ZXMuIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIHRtID0gbmV3IFprVG9waWNNYW5hZ2VyKHprLCBjb25m\nLCBzY2hlZHVsZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nIGNhdGNoIChQdWJTdWJFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nbG9nZ2VyLmVycm9yKCJDb3VsZCBub3QgaW5zdGFudGlhdGUgVG9waWNPd25l\ncnNoaXBNYW5hZ2VyIGJhc2VkIHRvcGljIG1hbmFnZXIiLCBlKTsKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbihlKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdG07CiAgICB9CgogICBw\ncm90ZWN0ZWQgTWFwPE9wZXJhdGlvblR5cGUsIEhhbmRsZXI+IGluaXRpYWxp\nemVOZXR0eUhhbmRsZXJzKAogICAgICAgICAgIFRvcGljTWFuYWdlciB0bSwg\nRGVsaXZlcnlNYW5hZ2VyIGRtLAogICAgICAgICAgIFBlcnNpc3RlbmNlTWFu\nYWdlciBwbSwgU3Vic2NyaXB0aW9uTWFuYWdlciBzbSwKICAgICAgICAgICBT\ndWJzY3JpcHRpb25DaGFubmVsTWFuYWdlciBzdWJDaGFubmVsTWdyKSB7CiAg\nICAgICAgTWFwPE9wZXJhdGlvblR5cGUsIEhhbmRsZXI+IGhhbmRsZXJzID0g\nbmV3IEhhc2hNYXA8T3BlcmF0aW9uVHlwZSwgSGFuZGxlcj4oKTsKICAgICAg\nICBoYW5kbGVycy5wdXQoT3BlcmF0aW9uVHlwZS5QVUJMSVNILCBuZXcgUHVi\nbGlzaEhhbmRsZXIodG0sIHBtLCBjb25mKSk7CiAgICAgICAgaGFuZGxlcnMu\ncHV0KE9wZXJhdGlvblR5cGUuU1VCU0NSSUJFLAogICAgICAgICAgICAgICAg\nICAgICBuZXcgU3Vic2NyaWJlSGFuZGxlcihjb25mLCB0bSwgZG0sIHBtLCBz\nbSwgc3ViQ2hhbm5lbE1ncikpOwogICAgICAgIGhhbmRsZXJzLnB1dChPcGVy\nYXRpb25UeXBlLlVOU1VCU0NSSUJFLAogICAgICAgICAgICAgICAgICAgICBu\nZXcgVW5zdWJzY3JpYmVIYW5kbGVyKGNvbmYsIHRtLCBzbSwgZG0sIHN1YkNo\nYW5uZWxNZ3IpKTsKICAgICAgICBoYW5kbGVycy5wdXQoT3BlcmF0aW9uVHlw\nZS5DT05TVU1FLCBuZXcgQ29uc3VtZUhhbmRsZXIodG0sIHNtLCBjb25mKSk7\nCiAgICAgICAgaGFuZGxlcnMucHV0KE9wZXJhdGlvblR5cGUuQ0xPU0VTVUJT\nQ1JJUFRJT04sCiAgICAgICAgICAgICAgICAgICAgIG5ldyBDbG9zZVN1YnNj\ncmlwdGlvbkhhbmRsZXIoY29uZiwgdG0sIHNtLCBkbSwgc3ViQ2hhbm5lbE1n\ncikpOwogICAgICAgIGhhbmRsZXJzID0gQ29sbGVjdGlvbnMudW5tb2RpZmlh\nYmxlTWFwKGhhbmRsZXJzKTsKICAgICAgICByZXR1cm4gaGFuZGxlcnM7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgaW5pdGlhbGl6ZU5ldHR5KFNzbFNl\ncnZlckNvbnRleHRGYWN0b3J5IHNzbEZhY3RvcnksCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgTWFwPE9wZXJhdGlvblR5cGUsIEhhbmRs\nZXI+IGhhbmRsZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIFN1YnNjcmlwdGlvbkNoYW5uZWxNYW5hZ2VyIHN1YkNoYW5uZWxNZ3Ip\nIHsKICAgICAgICBib29sZWFuIGlzU1NMRW5hYmxlZCA9IChzc2xGYWN0b3J5\nICE9IG51bGwpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIEludGVybmFsTG9n\nZ2VyRmFjdG9yeS5zZXREZWZhdWx0RmFjdG9yeShuZXcgTG9nNEpMb2dnZXJG\nYWN0b3J5KCkpOwogICAgICAgIFNlcnZlckJvb3RzdHJhcCBib290c3RyYXAg\nPSBuZXcgU2VydmVyQm9vdHN0cmFwKHNlcnZlckNoYW5uZWxGYWN0b3J5KTsK\nICAgICAgICBVbWJyZWxsYUhhbmRsZXIgdW1icmVsbGFIYW5kbGVyID0KICAg\nICAgICAgICAgbmV3IFVtYnJlbGxhSGFuZGxlcihhbGxDaGFubmVscywgaGFu\nZGxlcnMsIHN1YkNoYW5uZWxNZ3IsIGlzU1NMRW5hYmxlZCk7CiAgICAgICAg\nUHViU3ViU2VydmVyUGlwZWxpbmVGYWN0b3J5IHBpcGVsaW5lID0KICAgICAg\nICAgICAgbmV3IFB1YlN1YlNlcnZlclBpcGVsaW5lRmFjdG9yeSh1bWJyZWxs\nYUhhbmRsZXIsIHNzbEZhY3RvcnksCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgY29uZi5nZXRNYXhpbXVtTWVzc2FnZVNp\nemUoKSk7CgogICAgICAgIGJvb3RzdHJhcC5zZXRQaXBlbGluZUZhY3Rvcnko\ncGlwZWxpbmUpOwogICAgICAgIGJvb3RzdHJhcC5zZXRPcHRpb24oImNoaWxk\nLnRjcE5vRGVsYXkiLCB0cnVlKTsKICAgICAgICBib290c3RyYXAuc2V0T3B0\naW9uKCJjaGlsZC5rZWVwQWxpdmUiLCB0cnVlKTsKICAgICAgICBib290c3Ry\nYXAuc2V0T3B0aW9uKCJyZXVzZUFkZHJlc3MiLCB0cnVlKTsKCiAgICAgICAg\nLy8gQmluZCBhbmQgc3RhcnQgdG8gYWNjZXB0IGluY29taW5nIGNvbm5lY3Rp\nb25zLgogICAgICAgIGFsbENoYW5uZWxzLmFkZChib290c3RyYXAuYmluZChp\nc1NTTEVuYWJsZWQgPyBuZXcgSW5ldFNvY2tldEFkZHJlc3MoY29uZi5nZXRT\nU0xTZXJ2ZXJQb3J0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIDogbmV3IEluZXRTb2NrZXRBZGRyZXNzKGNvbmYuZ2V0U2Vy\ndmVyUG9ydCgpKSkpOwogICAgICAgIGxvZ2dlci5pbmZvKCJHb2luZyBpbnRv\nIHJlY2VpdmUgbG9vcCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNodXRk\nb3duKCkgewogICAgICAgIC8vIFRPRE86IHRlbGwgYmsgdG8gY2xvc2UgbG9n\ncwoKICAgICAgICAvLyBTdG9wIHRvcGljIG1hbmFnZXIgZmlyc3Qgc2luY2Ug\naXQgaXMgY29yZSBvZiBIdWIgc2VydmVyCiAgICAgICAgdG0uc3RvcCgpOwoK\nICAgICAgICAvLyBTdG9wIHRoZSBSZWdpb25NYW5hZ2VyLgogICAgICAgIHJt\nLnN0b3AoKTsKCiAgICAgICAgLy8gU3RvcCB0aGUgRGVsaXZlcnlNYW5hZ2Vy\nIGFuZCBSZWFkQWhlYWRDYWNoZSB0aHJlYWRzIChpZgogICAgICAgIC8vIGFw\ncGxpY2FibGUpLgogICAgICAgIGRtLnN0b3AoKTsKICAgICAgICBwbS5zdG9w\nKCk7CgogICAgICAgIC8vIFN0b3AgdGhlIFN1YnNjcmlwdGlvbk1hbmFnZXIg\naWYgbmVlZGVkLgogICAgICAgIHNtLnN0b3AoKTsKCiAgICAgICAgLy8gU2h1\ndGRvd24gbWV0YWRhdGEgbWFuYWdlciBpZiBuZWVkZWQKICAgICAgICBpZiAo\nbnVsbCAhPSBtbSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgbW0uc2h1dGRvd24oKTsKICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNl\ncHRpb24gaWUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJy\nb3Igd2hpbGUgc2h1dGRvd24gbWV0YWRhdGEgbWFuYWdlciBmYWN0b3J5ISIs\nIGllKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gU2h1\ndGRvd24gdGhlIFpvb0tlZXBlciBhbmQgQm9va0tlZXBlciBjbGllbnRzIG9u\nbHkgaWYgd2UgYXJlCiAgICAgICAgLy8gbm90IGluIHN0YW5kLWFsb25lIG1v\nZGUuCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKGJrICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBiay5jbG9zZSgpOwogICAgICAgICAgICBpZiAo\nemsgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHprLmNsb3NlKCk7CiAgICAg\nICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIHdoaWxlIGNsb3NpbmcgWm9vS2Vl\ncGVyIGNsaWVudCA6ICIsIGUpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0\naW9uIGJrZSkgewogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIHdo\naWxlIGNsb3NpbmcgQm9va0tlZXBlciBjbGllbnQgOiAiLCBia2UpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gQ2xvc2UgYW5kIHJlbGVhc2UgdGhlIE5ldHR5\nIGNoYW5uZWxzIGFuZCByZXNvdXJjZXMKICAgICAgICBhbGxDaGFubmVscy5j\nbG9zZSgpLmF3YWl0VW5pbnRlcnJ1cHRpYmx5KCk7CiAgICAgICAgc2VydmVy\nQ2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7CiAg\nICAgICAgY2xpZW50Q2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVybmFsUmVz\nb3VyY2VzKCk7CiAgICAgICAgc2NoZWR1bGVyLnNodXRkb3duKCk7CgogICAg\nICAgIC8vIHVucmVnaXN0ZXIgam14CiAgICAgICAgdW5yZWdpc3RlckpNWCgp\nOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHJlZ2lzdGVySk1YKFN1YnNj\ncmlwdGlvbkNoYW5uZWxNYW5hZ2VyIHN1YkNoYW5uZWxNZ3IpIHsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBTdHJpbmcgam14TmFtZSA9IEpNWE5BTUVf\nUFJFRklYICsgY29uZi5nZXRTZXJ2ZXJQb3J0KCkgKyAiXyIKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGNvbmYuZ2V0\nU1NMU2VydmVyUG9ydCgpOwogICAgICAgICAgICBqbXhTZXJ2ZXJCZWFuID0g\nbmV3IFB1YlN1YlNlcnZlckJlYW4oam14TmFtZSk7CiAgICAgICAgICAgIEhl\nZHdpZ01CZWFuUmVnaXN0cnkuZ2V0SW5zdGFuY2UoKS5yZWdpc3RlcihqbXhT\nZXJ2ZXJCZWFuLCBudWxsKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIGpteE5ldHR5QmVhbiA9IG5ldyBOZXR0eUhhbmRsZXJCZWFuKHN1\nYkNoYW5uZWxNZ3IpOwogICAgICAgICAgICAgICAgSGVkd2lnTUJlYW5SZWdp\nc3RyeS5nZXRJbnN0YW5jZSgpLnJlZ2lzdGVyKGpteE5ldHR5QmVhbiwgam14\nU2VydmVyQmVhbik7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIud2FybigiRmFpbGVkIHRvIHJl\nZ2lzdGVyIHdpdGggSk1YIiwgZSk7CiAgICAgICAgICAgICAgICBqbXhOZXR0\neUJlYW4gPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLndhcm4oIkZhaWxl\nZCB0byByZWdpc3RlciB3aXRoIEpNWCIsIGUpOwogICAgICAgICAgICBqbXhT\nZXJ2ZXJCZWFuID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHBtIGlu\nc3RhbmNlb2YgUmVhZEFoZWFkQ2FjaGUpIHsKICAgICAgICAgICAgKChSZWFk\nQWhlYWRDYWNoZSlwbSkucmVnaXN0ZXJKTVgoam14U2VydmVyQmVhbik7CiAg\nICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHVucmVnaXN0ZXJK\nTVgoKSB7CiAgICAgICAgaWYgKHBtICE9IG51bGwgJiYgcG0gaW5zdGFuY2Vv\nZiBSZWFkQWhlYWRDYWNoZSkgewogICAgICAgICAgICAoKFJlYWRBaGVhZENh\nY2hlKXBtKS51bnJlZ2lzdGVySk1YKCk7CiAgICAgICAgfQogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGlmIChqbXhOZXR0eUJlYW4gIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgSGVkd2lnTUJlYW5SZWdpc3RyeS5nZXRJbnN0YW5j\nZSgpLnVucmVnaXN0ZXIoam14TmV0dHlCZWFuKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGxv\nZ2dlci53YXJuKCJGYWlsZWQgdG8gdW5yZWdpc3RlciB3aXRoIEpNWCIsIGUp\nOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoam14\nU2VydmVyQmVhbiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBIZWR3aWdN\nQmVhblJlZ2lzdHJ5LmdldEluc3RhbmNlKCkudW5yZWdpc3RlcihqbXhTZXJ2\nZXJCZWFuKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIGxvZ2dlci53YXJuKCJGYWlsZWQgdG8g\ndW5yZWdpc3RlciB3aXRoIEpNWCIsIGUpOwogICAgICAgIH0KICAgICAgICBq\nbXhOZXR0eUJlYW4gPSBudWxsOwogICAgICAgIGpteFNlcnZlckJlYW4gPSBu\ndWxsOwogICAgfQoKICAgIC8qKgogICAgICogU3RhcnRzIHRoZSBoZWR3aWcg\nc2VydmVyIG9uIHRoZSBnaXZlbiBwb3J0CiAgICAgKgogICAgICogQHBhcmFt\nIHBvcnQKICAgICAqIEB0aHJvd3MgQ29uZmlndXJhdGlvbkV4Y2VwdGlvbgog\nICAgICogICAgICAgICAgICAgaWYgdGhlcmUgaXMgc29tZXRoaW5nIHdyb25n\nIHdpdGggdGhlIGdpdmVuIGNvbmZpZ3VyYXRpb24KICAgICAqIEB0aHJvd3Mg\nSU9FeGNlcHRpb24KICAgICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRp\nb24KICAgICAqIEB0aHJvd3MgQ29uZmlndXJhdGlvbkV4Y2VwdGlvbgogICAg\nICovCiAgICBwdWJsaWMgUHViU3ViU2VydmVyKGZpbmFsIFNlcnZlckNvbmZp\nZ3VyYXRpb24gc2VydmVyQ29uZmlndXJhdGlvbiwKICAgICAgICAgICAgICAg\nICAgICAgICAgZmluYWwgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYu\nQ2xpZW50Q29uZmlndXJhdGlvbiBjbGllbnRDb25maWd1cmF0aW9uLAogICAg\nICAgICAgICAgICAgICAgICAgICBmaW5hbCBUaHJlYWQuVW5jYXVnaHRFeGNl\ncHRpb25IYW5kbGVyIGV4Y2VwdGlvbkhhbmRsZXIpCiAgICAgICAgICAgIHRo\ncm93cyBDb25maWd1cmF0aW9uRXhjZXB0aW9uIHsKCiAgICAgICAgLy8gRmly\nc3QgdmFsaWRhdGUgdGhlIHNlcnZlckNvbmZpZ3VyYXRpb24KICAgICAgICB0\naGlzLmNvbmYgPSBzZXJ2ZXJDb25maWd1cmF0aW9uOwogICAgICAgIHNlcnZl\nckNvbmZpZ3VyYXRpb24udmFsaWRhdGUoKTsKCiAgICAgICAgLy8gVmFsaWRh\ndGUgdGhlIGNsaWVudCBjb25maWd1cmF0aW9uCiAgICAgICAgdGhpcy5jbGll\nbnRDb25maWd1cmF0aW9uID0gY2xpZW50Q29uZmlndXJhdGlvbjsKICAgICAg\nICBjbGllbnRDb25maWd1cmF0aW9uLnZhbGlkYXRlKCk7CgogICAgICAgIC8v\nIFdlIG5lZWQgYSBjdXN0b20gdGhyZWFkIGdyb3VwLCBzbyB0aGF0IHdlIGNh\nbiBvdmVycmlkZSB0aGUgdW5jYXVnaHQKICAgICAgICAvLyBleGNlcHRpb24g\nbWV0aG9kCiAgICAgICAgdGcgPSBuZXcgVGhyZWFkR3JvdXAoImhlZHdpZyIp\nIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHVuY2F1Z2h0RXhjZXB0aW9uKFRocmVhZCB0LCBUaHJvd2FibGUgZSkg\newogICAgICAgICAgICAgICAgZXhjZXB0aW9uSGFuZGxlci51bmNhdWdodEV4\nY2VwdGlvbih0LCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAg\nICAgLy8gWm9vS2VlcGVyIHRocmVhZHMgcmVnaXN0ZXIgdGhlaXIgb3duIGhh\nbmRsZXIuIEJ1dCBpZiBzb21lIHdvcmsgdGhhdAogICAgICAgIC8vIHdlIGRv\nIGluIFpLIHRocmVhZHMgdGhyb3dzIGFuIGV4Y2VwdGlvbiwgd2Ugd2FudCBv\ndXIgaGFuZGxlciB0byBiZQogICAgICAgIC8vIGNhbGxlZCwgbm90IHRoZWly\ncy4KICAgICAgICBTYWZlQXN5bmNDYWxsYmFjay5zZXRVbmNhdWdodEV4Y2Vw\ndGlvbkhhbmRsZXIoZXhjZXB0aW9uSGFuZGxlcik7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc3RhcnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBm\naW5hbCBTeW5jaHJvbm91c1F1ZXVlPEVpdGhlcjxPYmplY3QsIEV4Y2VwdGlv\nbj4+IHF1ZXVlID0gbmV3IFN5bmNocm9ub3VzUXVldWU8RWl0aGVyPE9iamVj\ndCwgRXhjZXB0aW9uPj4oKTsKCiAgICAgICAgbmV3IFRocmVhZCh0ZywgbmV3\nIFJ1bm5hYmxlKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAg\nICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSB6ayBpcyBuZWVkZWQgYnkg\nYWxtb3N0IGV2ZXJ5b25lLHRyeSB0byBzZWUgaWYgd2UKICAgICAgICAgICAg\nICAgICAgICAvLyBuZWVkIHRoYXQgZmlyc3QKICAgICAgICAgICAgICAgICAg\nICBzY2hlZHVsZXIgPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhyZWFkU2NoZWR1\nbGVkRXhlY3V0b3IoKTsKICAgICAgICAgICAgICAgICAgICBzZXJ2ZXJDaGFu\nbmVsRmFjdG9yeSA9IG5ldyBOaW9TZXJ2ZXJTb2NrZXRDaGFubmVsRmFjdG9y\neShFeGVjdXRvcnMubmV3Q2FjaGVkVGhyZWFkUG9vbCgpLCBFeGVjdXRvcnMK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5uZXdDYWNoZWRUaHJlYWRQ\nb29sKCkpOwogICAgICAgICAgICAgICAgICAgIGNsaWVudENoYW5uZWxGYWN0\nb3J5ID0gbmV3IE5pb0NsaWVudFNvY2tldENoYW5uZWxGYWN0b3J5KEV4ZWN1\ndG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCksIEV4ZWN1dG9ycwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgLm5ld0NhY2hlZFRocmVhZFBvb2woKSk7\nCgogICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlWm9va2VlcGVyQ2xp\nZW50KCk7CiAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVNZXRhZGF0\nYU1hbmFnZXJGYWN0b3J5KCk7CiAgICAgICAgICAgICAgICAgICAgdG0gPSBp\nbnN0YW50aWF0ZVRvcGljTWFuYWdlcigpOwogICAgICAgICAgICAgICAgICAg\nIHBtID0gaW5zdGFudGlhdGVQZXJzaXN0ZW5jZU1hbmFnZXIodG0pOwogICAg\nICAgICAgICAgICAgICAgIGRtID0gbmV3IEZJRk9EZWxpdmVyeU1hbmFnZXIo\ncG0sIGNvbmYpOwogICAgICAgICAgICAgICAgICAgIGRtLnN0YXJ0KCk7Cgog\nICAgICAgICAgICAgICAgICAgIHNtID0gaW5zdGFudGlhdGVTdWJzY3JpcHRp\nb25NYW5hZ2VyKHRtLCBwbSwgZG0pOwogICAgICAgICAgICAgICAgICAgIHJt\nID0gaW5zdGFudGlhdGVSZWdpb25NYW5hZ2VyKHBtLCBzY2hlZHVsZXIpOwog\nICAgICAgICAgICAgICAgICAgIHNtLmFkZExpc3RlbmVyKHJtKTsKCiAgICAg\nICAgICAgICAgICAgICAgYWxsQ2hhbm5lbHMgPSBuZXcgRGVmYXVsdENoYW5u\nZWxHcm91cCgiaGVkd2lnIik7CiAgICAgICAgICAgICAgICAgICAgLy8gSW5p\ndGlhbGl6ZSB0aGUgTmV0dHkgSGFuZGxlcnMgKHVzZWQgYnkgdGhlCiAgICAg\nICAgICAgICAgICAgICAgLy8gVW1icmVsbGFIYW5kbGVyKSBvbmNlIHNvIHRo\nZXkgY2FuIGJlIHNoYXJlZCBieQogICAgICAgICAgICAgICAgICAgIC8vIGJv\ndGggdGhlIFNTTCBhbmQgbm9uLVNTTCBjaGFubmVscy4KICAgICAgICAgICAg\nICAgICAgICBTdWJzY3JpcHRpb25DaGFubmVsTWFuYWdlciBzdWJDaGFubmVs\nTWdyID0gbmV3IFN1YnNjcmlwdGlvbkNoYW5uZWxNYW5hZ2VyKCk7CiAgICAg\nICAgICAgICAgICAgICAgc3ViQ2hhbm5lbE1nci5hZGRTdWJDaGFubmVsRGlz\nY29ubmVjdGVkTGlzdGVuZXIoKFN1YkNoYW5uZWxEaXNjb25uZWN0ZWRMaXN0\nZW5lcikgZG0pOwogICAgICAgICAgICAgICAgICAgIE1hcDxPcGVyYXRpb25U\neXBlLCBIYW5kbGVyPiBoYW5kbGVycyA9CiAgICAgICAgICAgICAgICAgICAg\nICAgIGluaXRpYWxpemVOZXR0eUhhbmRsZXJzKHRtLCBkbSwgcG0sIHNtLCBz\ndWJDaGFubmVsTWdyKTsKICAgICAgICAgICAgICAgICAgICAvLyBJbml0aWFs\naXplIE5ldHR5IGZvciB0aGUgcmVndWxhciBub24tU1NMIGNoYW5uZWxzCiAg\nICAgICAgICAgICAgICAgICAgaW5pdGlhbGl6ZU5ldHR5KG51bGwsIGhhbmRs\nZXJzLCBzdWJDaGFubmVsTWdyKTsKICAgICAgICAgICAgICAgICAgICBpZiAo\nY29uZi5pc1NTTEVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICBpbml0aWFsaXplTmV0dHkobmV3IFNzbFNlcnZlckNvbnRleHRGYWN0b3J5\nKGNvbmYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgaGFuZGxlcnMsIHN1YkNoYW5uZWxNZ3IpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyByZWdpc3RlciBqbXgKICAg\nICAgICAgICAgICAgICAgICByZWdpc3RlckpNWChzdWJDaGFubmVsTWdyKTsK\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQocXVldWUsIEVp\ndGhlci5yaWdodChlKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIENvbmN1cnJlbmN5\nVXRpbHMucHV0KHF1ZXVlLCBFaXRoZXIub2YobmV3IE9iamVjdCgpLCAoRXhj\nZXB0aW9uKSBudWxsKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSkuc3Rh\ncnQoKTsKCiAgICAgICAgRWl0aGVyPE9iamVjdCwgRXhjZXB0aW9uPiBlaXRo\nZXIgPSBDb25jdXJyZW5jeVV0aWxzLnRha2UocXVldWUpOwogICAgICAgIGlm\nIChlaXRoZXIubGVmdCgpID09IG51bGwpIHsKICAgICAgICAgICAgdGhyb3cg\nZWl0aGVyLnJpZ2h0KCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBQ\ndWJTdWJTZXJ2ZXIoU2VydmVyQ29uZmlndXJhdGlvbiBzZXJ2ZXJDb25maWd1\ncmF0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQuY29uZi5DbGllbnRDb25maWd1cmF0aW9uIGNsaWVudENv\nbmZpZ3VyYXRpb24pIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRoaXMo\nc2VydmVyQ29uZmlndXJhdGlvbiwgY2xpZW50Q29uZmlndXJhdGlvbiwgbmV3\nIFRlcm1pbmF0ZUpWTUV4Y2VwdGlvbkhhbmRsZXIoKSk7CiAgICB9CgogICAg\ncHVibGljIFB1YlN1YlNlcnZlcihTZXJ2ZXJDb25maWd1cmF0aW9uIHNlcnZl\nckNvbmZpZ3VyYXRpb24pIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRo\naXMoc2VydmVyQ29uZmlndXJhdGlvbiwgbmV3IG9yZy5hcGFjaGUuaGVkd2ln\nLmNsaWVudC5jb25mLkNsaWVudENvbmZpZ3VyYXRpb24oKSk7CiAgICB9Cgog\nICAgQFZpc2libGVGb3JUZXN0aW5nCiAgICBwdWJsaWMgRGVsaXZlcnlNYW5h\nZ2VyIGdldERlbGl2ZXJ5TWFuYWdlcigpIHsKICAgICAgICByZXR1cm4gZG07\nCiAgICB9CgogICAgLyoqCiAgICAgKgogICAgICogQHBhcmFtIG1zZwogICAg\nICogQHBhcmFtIHJjCiAgICAgKiAgICAgICAgICAgIDogY29kZSB0byBleGl0\nIHdpdGgKICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGVycm9yTXNn\nQW5kRXhpdChTdHJpbmcgbXNnLCBUaHJvd2FibGUgdCwgaW50IHJjKSB7CiAg\nICAgICAgbG9nZ2VyLmVycm9yKG1zZywgdCk7CiAgICAgICAgU3lzdGVtLmVy\nci5wcmludGxuKG1zZyk7CiAgICAgICAgU3lzdGVtLmV4aXQocmMpOwogICAg\nfQoKICAgIHB1YmxpYyBmaW5hbCBzdGF0aWMgaW50IFJDX0lOVkFMSURfQ09O\nRl9GSUxFID0gMTsKICAgIHB1YmxpYyBmaW5hbCBzdGF0aWMgaW50IFJDX01J\nU0NPTkZJR1VSRUQgPSAyOwogICAgcHVibGljIGZpbmFsIHN0YXRpYyBpbnQg\nUkNfT1RIRVIgPSAzOwoKICAgIC8qKgogICAgICogQHBhcmFtIGFyZ3MKICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJn\ncykgewoKICAgICAgICBsb2dnZXIuaW5mbygiQXR0ZW1wdGluZyB0byBzdGFy\ndCBIZWR3aWciKTsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIHNlcnZl\nckNvbmZpZ3VyYXRpb24gPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbigpOwog\nICAgICAgIC8vIFRoZSBjbGllbnQgY29uZmlndXJhdGlvbiBmb3IgdGhlIGhl\nZHdpZyBjbGllbnQgaW4gdGhlIHJlZ2lvbiBtYW5hZ2VyLgogICAgICAgIG9y\nZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5jb25mLkNsaWVudENvbmZpZ3VyYXRp\nb24gcmVnaW9uTWdyQ2xpZW50Q29uZmlndXJhdGlvbgogICAgICAgICAgICAg\nICAgPSBuZXcgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50\nQ29uZmlndXJhdGlvbigpOwogICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDAp\nIHsKICAgICAgICAgICAgU3RyaW5nIGNvbmZGaWxlID0gYXJnc1swXTsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHNlcnZlckNvbmZpZ3Vy\nYXRpb24ubG9hZENvbmYobmV3IEZpbGUoY29uZkZpbGUpLnRvVVJJKCkudG9V\nUkwoKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE1hbGZvcm1lZFVSTEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgbXNnID0gIkNvdWxk\nIG5vdCBvcGVuIHNlcnZlciBjb25maWd1cmF0aW9uIGZpbGU6ICIgKyBjb25m\nRmlsZTsKICAgICAgICAgICAgICAgIGVycm9yTXNnQW5kRXhpdChtc2csIGUs\nIFJDX0lOVkFMSURfQ09ORl9GSUxFKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nQ29uZmlndXJhdGlvbkV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBT\ndHJpbmcgbXNnID0gIk1hbGZvcm1lZCBzZXJ2ZXIgY29uZmlndXJhdGlvbiBm\naWxlOiAiICsgY29uZkZpbGU7CiAgICAgICAgICAgICAgICBlcnJvck1zZ0Fu\nZEV4aXQobXNnLCBlLCBSQ19NSVNDT05GSUdVUkVEKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBsb2dnZXIuaW5mbygiVXNpbmcgY29uZmlndXJhdGlv\nbiBmaWxlICIgKyBjb25mRmlsZSk7CiAgICAgICAgfQogICAgICAgIGlmIChh\ncmdzLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgLy8gYXJnc1sxXSBpcyB0\naGUgY2xpZW50IGNvbmZpZ3VyYXRpb24gZmlsZS4KICAgICAgICAgICAgU3Ry\naW5nIGNvbmZGaWxlID0gYXJnc1sxXTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHJlZ2lvbk1nckNsaWVudENvbmZpZ3VyYXRpb24ubG9h\nZENvbmYobmV3IEZpbGUoY29uZkZpbGUpLnRvVVJJKCkudG9VUkwoKSk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKE1hbGZvcm1lZFVSTEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICBTdHJpbmcgbXNnID0gIkNvdWxkIG5vdCBvcGVu\nIGNsaWVudCBjb25maWd1cmF0aW9uIGZpbGU6ICIgKyBjb25mRmlsZTsKICAg\nICAgICAgICAgICAgIGVycm9yTXNnQW5kRXhpdChtc2csIGUsIFJDX0lOVkFM\nSURfQ09ORl9GSUxFKTsKICAgICAgICAgICAgfSBjYXRjaCAoQ29uZmlndXJh\ndGlvbkV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgbXNn\nID0gIk1hbGZvcm1lZCBjbGllbnQgY29uZmlndXJhdGlvbiBmaWxlOiAiICsg\nY29uZkZpbGU7CiAgICAgICAgICAgICAgICBlcnJvck1zZ0FuZEV4aXQobXNn\nLCBlLCBSQ19NSVNDT05GSUdVUkVEKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBuZXcgUHViU3ViU2VydmVy\nKHNlcnZlckNvbmZpZ3VyYXRpb24sIHJlZ2lvbk1nckNsaWVudENvbmZpZ3Vy\nYXRpb24pLnN0YXJ0KCk7CiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQp\nIHsKICAgICAgICAgICAgZXJyb3JNc2dBbmRFeGl0KCJFcnJvciBkdXJpbmcg\nc3RhcnR1cCIsIHQsIFJDX09USEVSKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

