{"sha":"69ee6efd5eae294973becf03c1909a2c8f30ab0c","node_id":"MDQ6QmxvYjE1NzU5NTY6NjllZTZlZmQ1ZWFlMjk0OTczYmVjZjAzYzE5MDlhMmM4ZjMwYWIwYw==","size":6136,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/69ee6efd5eae294973becf03c1909a2c8f30ab0c","content":"LyoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJz\naW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90IHVzZSB0\naGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5z\nZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0\nCiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElD\nRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUg\nbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0\ncmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBh\nbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09O\nRElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGll\nZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3Vh\nZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBsaW1pdGF0aW9ucyB1\nbmRlciB0aGUgTGljZW5zZS4KICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuaGVk\nd2lnLnNlcnZlci5uZXR0eTsKCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsK\naW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgamF2YS5iZWFucy5Db25z\ndHJ1Y3RvclByb3BlcnRpZXM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVu\ndC5hdG9taWMuQXRvbWljTG9uZzsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5PcGVyYXRpb25UeXBlOwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJG\nYWN0b3J5OwoKLyoqCiAqIFNlcnZlciBTdGF0cwogKi8KcHVibGljIGNsYXNz\nIFNlcnZlclN0YXRzIHsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dl\nciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihTZXJ2ZXJTdGF0cy5j\nbGFzcyk7CiAgICBzdGF0aWMgU2VydmVyU3RhdHMgaW5zdGFuY2UgPSBuZXcg\nU2VydmVyU3RhdHMoKTsKCiAgICAvKioKICAgICAqIEEgcmVhZCB2aWV3IG9m\nIHN0YXRzLCBhbHNvIHVzZWQgaW4gQ29tcG9zaXRlVmlld0RhdGEgdG8gZXhw\nb3NlIHRvIEpNWAogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIE9w\nU3RhdERhdGEgewogICAgICAgIHByaXZhdGUgZmluYWwgbG9uZyBtYXhMYXRl\nbmN5LCBtaW5MYXRlbmN5OwogICAgICAgIHByaXZhdGUgZmluYWwgZG91Ymxl\nIGF2Z0xhdGVuY3k7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBsb25nIG51bVN1\nY2Nlc3NPcHMsIG51bUZhaWxlZE9wczsKICAgICAgICBwcml2YXRlIGZpbmFs\nIFN0cmluZyBsYXRlbmN5SGlzdDsKCiAgICAgICAgQENvbnN0cnVjdG9yUHJv\ncGVydGllcyh7Im1heExhdGVuY3kiLCAibWluTGF0ZW5jeSIsICJhdmdMYXRl\nbmN5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibnVtU3Vj\nY2Vzc09wcyIsICJudW1GYWlsZWRPcHMiLCAibGF0ZW5jeUhpc3QifSkKICAg\nICAgICBwdWJsaWMgT3BTdGF0RGF0YShsb25nIG1heExhdGVuY3ksIGxvbmcg\nbWluTGF0ZW5jeSwgZG91YmxlIGF2Z0xhdGVuY3ksCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgbG9uZyBudW1TdWNjZXNzT3BzLCBsb25nIG51bUZhaWxl\nZE9wcywgU3RyaW5nIGxhdGVuY3lIaXN0KSB7CiAgICAgICAgICAgIHRoaXMu\nbWF4TGF0ZW5jeSA9IG1heExhdGVuY3k7CiAgICAgICAgICAgIHRoaXMubWlu\nTGF0ZW5jeSA9IG1pbkxhdGVuY3kgPT0gTG9uZy5NQVhfVkFMVUUgPyAwIDog\nbWluTGF0ZW5jeTsKICAgICAgICAgICAgdGhpcy5hdmdMYXRlbmN5ID0gYXZn\nTGF0ZW5jeTsKICAgICAgICAgICAgdGhpcy5udW1TdWNjZXNzT3BzID0gbnVt\nU3VjY2Vzc09wczsKICAgICAgICAgICAgdGhpcy5udW1GYWlsZWRPcHMgPSBu\ndW1GYWlsZWRPcHM7CiAgICAgICAgICAgIHRoaXMubGF0ZW5jeUhpc3QgPSBs\nYXRlbmN5SGlzdDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBsb25nIGdl\ndE1heExhdGVuY3koKSB7CiAgICAgICAgICAgIHJldHVybiBtYXhMYXRlbmN5\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0TWluTGF0ZW5j\neSgpIHsKICAgICAgICAgICAgcmV0dXJuIG1pbkxhdGVuY3k7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgZG91YmxlIGdldEF2Z0xhdGVuY3koKSB7CiAg\nICAgICAgICAgIHJldHVybiBhdmdMYXRlbmN5OwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGxvbmcgZ2V0TnVtU3VjY2Vzc09wcygpIHsKICAgICAgICAg\nICAgcmV0dXJuIG51bVN1Y2Nlc3NPcHM7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgbG9uZyBnZXROdW1GYWlsZWRPcHMoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBudW1GYWlsZWRPcHM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nU3RyaW5nIGdldExhdGVuY3lIaXN0KCkgewogICAgICAgICAgICByZXR1cm4g\nbGF0ZW5jeUhpc3Q7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nT3BlcmF0aW9uIFN0YXRpc3RpY3MKICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBPcFN0YXRzIHsKICAgICAgICBzdGF0aWMgZmluYWwgaW50IE5V\nTV9CVUNLRVRTID0gMyo5ICsgMjsKCiAgICAgICAgbG9uZyBtYXhMYXRlbmN5\nID0gMDsKICAgICAgICBsb25nIG1pbkxhdGVuY3kgPSBMb25nLk1BWF9WQUxV\nRTsKICAgICAgICBkb3VibGUgdG90YWxMYXRlbmN5ID0gMC4wZjsKICAgICAg\nICBsb25nIG51bVN1Y2Nlc3NPcHMgPSAwOwogICAgICAgIGxvbmcgbnVtRmFp\nbGVkT3BzID0gMDsKICAgICAgICBsb25nW10gbGF0ZW5jeUJ1Y2tldHMgPSBu\nZXcgbG9uZ1tOVU1fQlVDS0VUU107CgogICAgICAgIE9wU3RhdHMoKSB7fQoK\nICAgICAgICAvKioKICAgICAgICAgKiBJbmNyZW1lbnQgbnVtYmVyIG9mIGZh\naWxlZCBvcGVyYXRpb25zCiAgICAgICAgICovCiAgICAgICAgc3luY2hyb25p\nemVkIHB1YmxpYyB2b2lkIGluY3JlbWVudEZhaWxlZE9wcygpIHsKICAgICAg\nICAgICAgKytudW1GYWlsZWRPcHM7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBVcGRhdGUgTGF0ZW5jeQogICAgICAgICAqLwogICAgICAg\nIHN5bmNocm9uaXplZCBwdWJsaWMgdm9pZCB1cGRhdGVMYXRlbmN5KGxvbmcg\nbGF0ZW5jeSkgewogICAgICAgICAgICBpZiAobGF0ZW5jeSA8IDApIHsKICAg\nICAgICAgICAgICAgIC8vIGxlc3MgdGhhbiAwbXMgLiBJZGVhbGx5IHRoaXMg\nc2hvdWxkIG5vdCBoYXBwZW4uCiAgICAgICAgICAgICAgICAvLyBXZSBoYXZl\nIHNlZW4gdGhpcyBsYXRlbmN5IG5lZ2F0aXZlIGluIHNvbWUgY2FzZXMgZHVl\nIHRvIHRoZQogICAgICAgICAgICAgICAgLy8gYmVoYXZpb3JzIG9mIEpWTS4g\nSWdub3JpbmcgdGhlIHN0YXRpc3RpY3MgdXBkYXRpb24gZm9yIHN1Y2gKICAg\nICAgICAgICAgICAgIC8vIGNhc2VzLgogICAgICAgICAgICAgICAgTE9HLndh\ncm4oIkxhdGVuY3kgdGltZSBjb21pbmcgbmVnYXRpdmUiKTsKICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0b3Rh\nbExhdGVuY3kgKz0gbGF0ZW5jeTsKICAgICAgICAgICAgKytudW1TdWNjZXNz\nT3BzOwogICAgICAgICAgICBpZiAobGF0ZW5jeSA8IG1pbkxhdGVuY3kpIHsK\nICAgICAgICAgICAgICAgIG1pbkxhdGVuY3kgPSBsYXRlbmN5OwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGlmIChsYXRlbmN5ID4gbWF4TGF0ZW5jeSkg\newogICAgICAgICAgICAgICAgbWF4TGF0ZW5jeSA9IGxhdGVuY3k7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgaW50IGJ1Y2tldDsKICAgICAgICAgICAg\naWYgKGxhdGVuY3kgPD0gMTAwKSB7IC8vIGxlc3MgdGhhbiAxMDBtcwogICAg\nICAgICAgICAgICAgYnVja2V0ID0gKGludCkobGF0ZW5jeSAvIDEwKTsKICAg\nICAgICAgICAgfSBlbHNlIGlmIChsYXRlbmN5IDw9IDEwMDApIHsgLy8gMTAw\nbXMgfiAxMDAwbXMKICAgICAgICAgICAgICAgIGJ1Y2tldCA9IDEgKiA5ICsg\nKGludCkobGF0ZW5jeSAvIDEwMCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAo\nbGF0ZW5jeSA8PSAxMDAwMCkgeyAvLyAxcyB+IDEwcwogICAgICAgICAgICAg\nICAgYnVja2V0ID0gMiAqIDkgKyAoaW50KShsYXRlbmN5IC8gMTAwMCk7CiAg\nICAgICAgICAgIH0gZWxzZSB7IC8vIG1vcmUgdGhhbiAxMHMKICAgICAgICAg\nICAgICAgIGJ1Y2tldCA9IDMgKiA5ICsgMTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICArK2xhdGVuY3lCdWNrZXRzW2J1Y2tldF07CiAgICAgICAgfQoK\nICAgICAgICBzeW5jaHJvbml6ZWQgcHVibGljIE9wU3RhdERhdGEgdG9PcFN0\nYXREYXRhKCkgewogICAgICAgICAgICBkb3VibGUgYXZnTGF0ZW5jeSA9IG51\nbVN1Y2Nlc3NPcHMgPiAwID8gdG90YWxMYXRlbmN5IC8gbnVtU3VjY2Vzc09w\ncyA6IDAuMGY7CiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcg\nU3RyaW5nQnVpbGRlcigpOwogICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8\nTlVNX0JVQ0tFVFM7IGkrKykgewogICAgICAgICAgICAgICAgc2IuYXBwZW5k\nKGxhdGVuY3lCdWNrZXRzW2ldKTsKICAgICAgICAgICAgICAgIGlmIChpICE9\nIE5VTV9CVUNLRVRTIC0gMSkgewogICAgICAgICAgICAgICAgICAgIHNiLmFw\ncGVuZCgnLCcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9Cgog\nICAgICAgICAgICByZXR1cm4gbmV3IE9wU3RhdERhdGEobWF4TGF0ZW5jeSwg\nbWluTGF0ZW5jeSwgYXZnTGF0ZW5jeSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIG51bVN1Y2Nlc3NPcHMsIG51bUZhaWxlZE9wcywgc2Iu\ndG9TdHJpbmcoKSk7CiAgICAgICAgfQoKICAgIH0KCiAgICBwdWJsaWMgc3Rh\ndGljIFNlcnZlclN0YXRzIGdldEluc3RhbmNlKCkgewogICAgICAgIHJldHVy\nbiBpbnN0YW5jZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgU2VydmVyU3RhdHMo\nKSB7CiAgICAgICAgc3RhdHMgPSBuZXcgSGFzaE1hcDxPcGVyYXRpb25UeXBl\nLCBPcFN0YXRzPigpOwogICAgICAgIGZvciAoT3BlcmF0aW9uVHlwZSB0eXBl\nIDogT3BlcmF0aW9uVHlwZS52YWx1ZXMoKSkgewogICAgICAgICAgICBzdGF0\ncy5wdXQodHlwZSwgbmV3IE9wU3RhdHMoKSk7CiAgICAgICAgfQogICAgfQog\nICAgTWFwPE9wZXJhdGlvblR5cGUsIE9wU3RhdHM+IHN0YXRzOwoKCiAgICBB\ndG9taWNMb25nIG51bVJlcXVlc3RzUmVjZWl2ZWQgPSBuZXcgQXRvbWljTG9u\nZygwKTsKICAgIEF0b21pY0xvbmcgbnVtUmVxdWVzdHNSZWRpcmVjdCA9IG5l\ndyBBdG9taWNMb25nKDApOwogICAgQXRvbWljTG9uZyBudW1NZXNzYWdlc0Rl\nbGl2ZXJlZCA9IG5ldyBBdG9taWNMb25nKDApOwoKICAgIC8qKgogICAgICog\nU3RhdHMgb2Ygb3BlcmF0aW9ucwogICAgICoKICAgICAqIEBwYXJhbSB0eXBl\nCiAgICAgKiAgICAgICAgICBPcGVyYXRpb24gVHlwZQogICAgICogQHJldHVy\nbiBvcCBzdGF0cwogICAgICovCiAgICBwdWJsaWMgT3BTdGF0cyBnZXRPcFN0\nYXRzKE9wZXJhdGlvblR5cGUgdHlwZSkgewogICAgICAgIHJldHVybiBzdGF0\ncy5nZXQodHlwZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5jcmVtZW50\nUmVxdWVzdHNSZWNlaXZlZCgpIHsKICAgICAgICBudW1SZXF1ZXN0c1JlY2Vp\ndmVkLmluY3JlbWVudEFuZEdldCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGluY3JlbWVudFJlcXVlc3RzUmVkaXJlY3QoKSB7CiAgICAgICAgbnVtUmVx\ndWVzdHNSZWRpcmVjdC5pbmNyZW1lbnRBbmRHZXQoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBpbmNyZW1lbnRNZXNzYWdlc0RlbGl2ZXJlZCgpIHsKICAg\nICAgICBudW1NZXNzYWdlc0RlbGl2ZXJlZC5pbmNyZW1lbnRBbmRHZXQoKTsK\nICAgIH0KCiAgICBwdWJsaWMgbG9uZyBnZXROdW1SZXF1ZXN0c1JlY2VpdmVk\nKCkgewogICAgICAgIHJldHVybiBudW1SZXF1ZXN0c1JlY2VpdmVkLmdldCgp\nOwogICAgfQoKICAgIHB1YmxpYyBsb25nIGdldE51bVJlcXVlc3RzUmVkaXJl\nY3QoKSB7CiAgICAgICAgcmV0dXJuIG51bVJlcXVlc3RzUmVkaXJlY3QuZ2V0\nKCk7CiAgICB9CgogICAgcHVibGljIGxvbmcgZ2V0TnVtTWVzc2FnZXNEZWxp\ndmVyZWQoKSB7CiAgICAgICAgcmV0dXJuIG51bU1lc3NhZ2VzRGVsaXZlcmVk\nLmdldCgpOwogICAgfQp9Cg==\n","encoding":"base64"}

