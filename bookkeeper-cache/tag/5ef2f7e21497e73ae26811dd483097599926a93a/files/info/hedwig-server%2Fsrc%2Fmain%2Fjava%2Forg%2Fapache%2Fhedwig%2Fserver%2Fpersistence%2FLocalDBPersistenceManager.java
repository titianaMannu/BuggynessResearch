{"sha":"62e3b91a260e2cb18f9f3160ed6757819d9c2b02","node_id":"MDQ6QmxvYjE1NzU5NTY6NjJlM2I5MWEyNjBlMmNiMThmOWYzMTYwZWQ2NzU3ODE5ZDljMmIwMg==","size":17974,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/62e3b91a260e2cb18f9f3160ed6757819d9c2b02","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZhLnNx\nbC5Ecml2ZXJNYW5hZ2VyOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0\nZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZh\nLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5TdGF0ZW1lbnQ7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1h\ncDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRNYXA7\nCgppbXBvcnQgamF2YS5tYXRoLkJpZ0ludGVnZXI7CmltcG9ydCBqYXZhLnNl\nY3VyaXR5Lk1lc3NhZ2VEaWdlc3Q7CmltcG9ydCBqYXZhLnNlY3VyaXR5Lk5v\nU3VjaEFsZ29yaXRobUV4Y2VwdGlvbjsKCmltcG9ydCBqYXZheC5zcWwucm93\nc2V0LnNlcmlhbC5TZXJpYWxCbG9iOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNl\nRG93bkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2Vw\ndGlvbnMuUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRDb25kaXRpb25FeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25zLk1lc3NhZ2VJZFV0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3Rl\nbmNlLlNjYW5DYWxsYmFjay5SZWFzb25Gb3JGaW5pc2g7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcudXRpbC5GaWxlVXRpbHM7CgpwdWJsaWMgY2xhc3MgTG9jYWxE\nQlBlcnNpc3RlbmNlTWFuYWdlciBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlTWFu\nYWdlcldpdGhSYW5nZVNjYW4gewogICAgc3RhdGljIExvZ2dlciBsb2dnZXIg\nPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMb2NhbERCUGVyc2lzdGVuY2VN\nYW5hZ2VyLmNsYXNzKTsKCiAgICBzdGF0aWMgU3RyaW5nIGNvbm5lY3Rpb25V\nUkw7CgogICAgc3RhdGljIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBG\naWxlIHRlbXBEaXIgPSBGaWxlVXRpbHMuY3JlYXRlVGVtcERpcmVjdG9yeSgi\nZGVyYnkiLCBudWxsKTsKCiAgICAgICAgICAgIC8vIFNpbmNlIGRlcmJ5IG5l\nZWRzIHRvIGNyZWF0ZSBpdCwgSSB3aWxsIGhhdmUgdG8gZGVsZXRlIGl0IGZp\ncnN0CiAgICAgICAgICAgIGlmICghdGVtcERpci5kZWxldGUoKSkgewogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJDb3VsZCBub3Qg\nZGVsZXRlIGRpcjogIiArIHRlbXBEaXIuZ2V0QWJzb2x1dGVQYXRoKCkpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbm5lY3Rpb25VUkwgPSAiamRi\nYzpkZXJieToiICsgdGVtcERpci5nZXRBYnNvbHV0ZVBhdGgoKSArICI7Y3Jl\nYXRlPXRydWUiOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZSk7CiAg\nICAgICAgfQoKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBUaHJl\nYWRMb2NhbDxDb25uZWN0aW9uPiB0aHJlYWRMb2NhbENvbm5lY3Rpb24gPSBu\nZXcgVGhyZWFkTG9jYWw8Q29ubmVjdGlvbj4oKSB7CiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHJvdGVjdGVkIENvbm5lY3Rpb24gaW5pdGlhbFZhbHVl\nKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJu\nIERyaXZlck1hbmFnZXIuZ2V0Q29ubmVjdGlvbihjb25uZWN0aW9uVVJMKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIGxvZ2dlci5lcnJvcigiQ291bGQgbm90IGNvbm5lY3QgdG8g\nZGVyYnkiLCBlKTsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBUaHJlYWRMb2NhbDxNZXNzYWdlRGlnZXN0PiB0aHJlYWRMb2Nh\nbERpZ2VzdCA9IG5ldyBUaHJlYWRMb2NhbDxNZXNzYWdlRGlnZXN0PigpIHsK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgTWVzc2FnZURp\nZ2VzdCBpbml0aWFsVmFsdWUoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gTWVzc2FnZURpZ2VzdC5nZXRJbnN0YW5jZSgi\nTUQ1Iik7CiAgICAgICAgICAgIH0gY2F0Y2ggKE5vU3VjaEFsZ29yaXRobUV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkNv\ndWxkIG5vdCBmaW5kIE1ENSBoYXNoIiwgZSk7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAg\nICBzdGF0aWMgZmluYWwgU3RyaW5nIElEX0ZJRUxEX05BTUUgPSAiaWQiOwog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBNU0dfRklFTERfTkFNRSA9ICJtc2ci\nOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBkcml2ZXIgPSAib3JnLmFwYWNo\nZS5kZXJieS5qZGJjLkVtYmVkZGVkRHJpdmVyIjsKCiAgICBzdGF0aWMgZmlu\nYWwgaW50IFNDQU5fQ0hVTksgPSAxMDAwOwoKICAgIC8qKgogICAgICogSGF2\naW5nIHRyb3VibGUgcmVzdGFydGluZyB0aGUgZGF0YWJhc2UgbXVsdGlwbGUg\ndGltZXMgZnJvbSB3aXRoaW4gdGhlCiAgICAgKiBzYW1lIGp2bS4gSGVuY2Ug\ndG8gZmFjaWxpdGF0ZSB1bml0cyB0ZXN0cywgd2UgYXJlIGp1c3QgZ29pbmcg\ndG8gaGF2ZSBhCiAgICAgKiB2ZXJzaW9uIG51bWJlciB0aGF0IHdlIHdpbGwg\nYXBwZW5kIHRvIGV2ZXJ5IHRhYmxlIG5hbWUuIFRoaXMgdmVyc2lvbgogICAg\nICogbnVtYmVyIHdpbGwgYmUgaW5jcmVtZW50ZWQgaW4gbGlldSBvZiBzaHV0\ndGluZyBkb3duIHRoZSBkYXRhYmFzZSBhbmQKICAgICAqIHJlc3RhcnRpbmcg\naXQsIHNvIHRoYXQgd2UgZ2V0IGRpZmZlcmVudCB0YWJsZSBuYW1lcywgYW5k\nIGl0IGJlaGF2ZXMgbGlrZQogICAgICogYSBicmFuZCBuZXcgZGF0YWJhc2UK\nICAgICAqLwogICAgcHJpdmF0ZSBpbnQgdmVyc2lvbiA9IDA7CgogICAgQ29u\nY3VycmVudE1hcDxCeXRlU3RyaW5nLCBNZXNzYWdlU2VxSWQ+IGN1cnJUb3Bp\nY1NlcUlkcyA9IG5ldyBDb25jdXJyZW50SGFzaE1hcDxCeXRlU3RyaW5nLCBN\nZXNzYWdlU2VxSWQ+KCk7CgogICAgc3RhdGljIExvY2FsREJQZXJzaXN0ZW5j\nZU1hbmFnZXIgaW5zdGFuY2UgPSBuZXcgTG9jYWxEQlBlcnNpc3RlbmNlTWFu\nYWdlcigpOwoKICAgIHB1YmxpYyBzdGF0aWMgTG9jYWxEQlBlcnNpc3RlbmNl\nTWFuYWdlciBpbnN0YW5jZSgpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2U7\nCiAgICB9CgogICAgcHJpdmF0ZSBMb2NhbERCUGVyc2lzdGVuY2VNYW5hZ2Vy\nKCkgewoKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFzcy5mb3JOYW1l\nKGRyaXZlcikubmV3SW5zdGFuY2UoKTsKICAgICAgICAgICAgbG9nZ2VyLmlu\nZm8oIkRlcmJ5IERyaXZlciBsb2FkZWQiKTsKICAgICAgICB9IGNhdGNoIChq\nYXZhLmxhbmcuQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIGxvZ2dlci5lcnJvcigiRGVyYnkgZHJpdmVyIG5vdCBmb3VuZCIsIGUp\nOwogICAgICAgIH0gY2F0Y2ggKEluc3RhbnRpYXRpb25FeGNlcHRpb24gZSkg\newogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkNvdWxkIG5vdCBpbnN0YW50\naWF0ZSBkZXJieSBkcml2ZXIiLCBlKTsKICAgICAgICB9IGNhdGNoIChJbGxl\nZ2FsQWNjZXNzRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJDb3VsZCBub3QgaW5zdGFudGlhdGUgZGVyYnkgZHJpdmVyIiwgZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgc3RvcCgpIHsKICAgICAgICAvLyBkbyBub3RoaW5nCiAgICB9CgogICAg\nLyoqCiAgICAgKiBFbnN1cmVzIHRoYXQgYXQgbGVhc3QgdGhlIGRlZmF1bHQg\nc2VxLWlkIGV4aXN0cyBpbiB0aGUgbWFwIGZvciB0aGUgZ2l2ZW4KICAgICAq\nIHRvcGljLiBDaGVja3MgZm9yIHJhY2UgY29uZGl0aW9ucyAoLmUuZywgYW5v\ndGhlciB0aHJlYWQgaW5zZXJ0cyB0aGUKICAgICAqIGRlZmF1bHQgaWQgYmVm\nb3JlIHVzKSwgYW5kIHJldHVybnMgdGhlIGxhdGVzdCBzZXEtaWQgdmFsdWUg\naW4gdGhlIG1hcAogICAgICoKICAgICAqIEBwYXJhbSB0b3BpYwogICAgICog\nQHJldHVybgogICAgICovCiAgICBwcml2YXRlIE1lc3NhZ2VTZXFJZCBlbnN1\ncmVTZXFJZEV4aXN0c0ZvclRvcGljKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAg\nICAgICBNZXNzYWdlU2VxSWQgcHJlc2VudFNlcUlkSW5NYXAgPSBjdXJyVG9w\naWNTZXFJZHMuZ2V0KHRvcGljKTsKCiAgICAgICAgaWYgKHByZXNlbnRTZXFJ\nZEluTWFwICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHByZXNlbnRT\nZXFJZEluTWFwOwogICAgICAgIH0KCiAgICAgICAgcHJlc2VudFNlcUlkSW5N\nYXAgPSBNZXNzYWdlU2VxSWQubmV3QnVpbGRlcigpLnNldExvY2FsQ29tcG9u\nZW50KDApLmJ1aWxkKCk7CiAgICAgICAgTWVzc2FnZVNlcUlkIG9sZFNlcUlk\nSW5NYXAgPSBjdXJyVG9waWNTZXFJZHMucHV0SWZBYnNlbnQodG9waWMsIHBy\nZXNlbnRTZXFJZEluTWFwKTsKCiAgICAgICAgaWYgKG9sZFNlcUlkSW5NYXAg\nIT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gb2xkU2VxSWRJbk1hcDsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHByZXNlbnRTZXFJZEluTWFwOwoK\nICAgIH0KCiAgICAvKioKICAgICAqIEFkanVzdCB0aGUgY3VycmVudCBzZXEg\naWQgb2YgdGhlIHRvcGljIGJhc2VkIG9uIHRoZSBtZXNzYWdlIHdlIGFyZSBh\nYm91dAogICAgICogdG8gcHVibGlzaC4gVGhlIGxvY2FsIGNvbXBvbmVudCBv\nZiB0aGUgY3VycmVudCBzZXEtaWQgaXMgYWx3YXlzCiAgICAgKiBpbmNyZW1l\nbnRlZCBieSAxLiBGb3IgdGhlIG90aGVyIGNvbXBvbmVudHMsIHRoZXJlIGFy\nZSB0d28gY2FzZXM6CiAgICAgKgogICAgICogMS4gSWYgdGhlIG1lc3NhZ2Ug\ndG8gYmUgcHVibGlzaGVkIGRvZXNuJ3QgaGF2ZSBhIHNlcS1pZCAobG9jYWxs\neQogICAgICogcHVibGlzaGVkIG1lc3NhZ2VzKSwgdGhlIG90aGVyIGNvbXBv\nbmVudHMgYXJlIGxlZnQgYXMgaXMuCiAgICAgKgogICAgICogMi4gSWYgdGhl\nIG1lc3NhZ2UgdG8gYmUgcHVibGlzaGVkIGhhcyBhIHNlcS1pZCwgd2UgdGFr\nZSB0aGUgbWF4IG9mIHRoZQogICAgICogY3VycmVudCBvbmUgd2UgaGF2ZSwg\nYW5kIHRoYXQgaW4gdGhlIG1lc3NhZ2UgdG8gYmUgcHVibGlzaGVkLgogICAg\nICoKICAgICAqIEBwYXJhbSB0b3BpYwogICAgICogQHBhcmFtIG1lc3NhZ2VU\nb1B1Ymxpc2gKICAgICAqIEByZXR1cm4gVGhlIHZhbHVlIG9mIHRoZSBsb2Nh\nbCBzZXEtaWQgb2J0YWluZWQgYWZ0ZXIgaW5jcmVtZW50aW5nIHRoZQogICAg\nICogICAgICAgICBsb2NhbCBjb21wb25lbnQuIFRoaXMgdmFsdWUgc2hvdWxk\nIGJlIHVzZWQgYXMgYW4gaWQgd2hpbGUKICAgICAqICAgICAgICAgcGVyc2lz\ndGluZyB0byBEZXJieQogICAgICogQHRocm93cyBVbmV4cGVjdGVkQ29uZGl0\naW9uRXhjZXB0aW9uCiAgICAgKi8KICAgIHByaXZhdGUgbG9uZyBhZGp1c3RU\nb3BpY1NlcUlkRm9yUHVibGlzaChCeXRlU3RyaW5nIHRvcGljLCBNZXNzYWdl\nIG1lc3NhZ2VUb1B1Ymxpc2gpCiAgICAgICAgICAgIHRocm93cyBVbmV4cGVj\ndGVkQ29uZGl0aW9uRXhjZXB0aW9uIHsKICAgICAgICBsb25nIHJldFZhbHVl\nID0gMDsKICAgICAgICBNZXNzYWdlU2VxSWQgb2xkSWQ7CiAgICAgICAgTWVz\nc2FnZVNlcUlkLkJ1aWxkZXIgbmV3SWRCdWlsZGVyID0gTWVzc2FnZVNlcUlk\nLm5ld0J1aWxkZXIoKTsKCiAgICAgICAgZG8gewogICAgICAgICAgICBvbGRJ\nZCA9IGVuc3VyZVNlcUlkRXhpc3RzRm9yVG9waWModG9waWMpOwoKICAgICAg\nICAgICAgLy8gSW5jcmVtZW50IG91ciBvd24gY29tcG9uZW50IGJ5IDEKICAg\nICAgICAgICAgcmV0VmFsdWUgPSBvbGRJZC5nZXRMb2NhbENvbXBvbmVudCgp\nICsgMTsKICAgICAgICAgICAgbmV3SWRCdWlsZGVyLnNldExvY2FsQ29tcG9u\nZW50KHJldFZhbHVlKTsKCiAgICAgICAgICAgIGlmIChtZXNzYWdlVG9QdWJs\naXNoLmhhc01zZ0lkKCkpIHsKICAgICAgICAgICAgICAgIC8vIHRha2UgYSBy\nZWdpb24td2lzZSBtYXgKICAgICAgICAgICAgICAgIE1lc3NhZ2VJZFV0aWxz\nLnRha2VSZWdpb25NYXhpbXVtKG5ld0lkQnVpbGRlciwgbWVzc2FnZVRvUHVi\nbGlzaC5nZXRNc2dJZCgpLCBvbGRJZCk7CgogICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgbmV3SWRCdWlsZGVyLmFkZEFsbFJlbW90ZUNv\nbXBvbmVudHMob2xkSWQuZ2V0UmVtb3RlQ29tcG9uZW50c0xpc3QoKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9IHdoaWxlICghY3VyclRvcGljU2VxSWRz\nLnJlcGxhY2UodG9waWMsIG9sZElkLCBuZXdJZEJ1aWxkZXIuYnVpbGQoKSkp\nOwoKICAgICAgICByZXR1cm4gcmV0VmFsdWU7CgogICAgfQoKICAgIHB1Ymxp\nYyBsb25nIGdldFNlcUlkQWZ0ZXJTa2lwcGluZyhCeXRlU3RyaW5nIHRvcGlj\nLCBsb25nIHNlcUlkLCBpbnQgc2tpcEFtb3VudCkgewogICAgICAgIHJldHVy\nbiBzZXFJZCArIHNraXBBbW91bnQ7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncGVyc2lzdE1lc3NhZ2UoUGVyc2lzdFJlcXVlc3QgcmVxdWVzdCkgewoKICAg\nICAgICBDb25uZWN0aW9uIGNvbm4gPSB0aHJlYWRMb2NhbENvbm5lY3Rpb24u\nZ2V0KCk7CgogICAgICAgIENhbGxiYWNrPE1lc3NhZ2VTZXFJZD4gY2FsbGJh\nY2sgPSByZXF1ZXN0LmdldENhbGxiYWNrKCk7CiAgICAgICAgT2JqZWN0IGN0\neCA9IHJlcXVlc3QuZ2V0Q3R4KCk7CiAgICAgICAgQnl0ZVN0cmluZyB0b3Bp\nYyA9IHJlcXVlc3QuZ2V0VG9waWMoKTsKICAgICAgICBNZXNzYWdlIG1lc3Nh\nZ2UgPSByZXF1ZXN0LmdldE1lc3NhZ2UoKTsKCiAgICAgICAgaWYgKGNvbm4g\nPT0gbnVsbCkgewogICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWls\nZWQoY3R4LCBuZXcgU2VydmljZURvd25FeGNlcHRpb24oIk5vdCBjb25uZWN0\nZWQgdG8gZGVyYnkiKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCgogICAgICAgIGxvbmcgc2VxSWQ7CgogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIHNlcUlkID0gYWRqdXN0VG9waWNTZXFJZEZvclB1Ymxpc2godG9waWMs\nIG1lc3NhZ2UpOwogICAgICAgIH0gY2F0Y2ggKFVuZXhwZWN0ZWRDb25kaXRp\nb25FeGNlcHRpb24gZSkgewogICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GYWlsZWQoY3R4LCBlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG10OwoKICAgICAgICBi\nb29sZWFuIHRyaWVkQ3JlYXRpbmdUYWJsZSA9IGZhbHNlOwogICAgICAgIHdo\naWxlICh0cnVlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBtZXNzYWdlLmdldEJvZHkoKTsKICAgICAgICAgICAgICAgIHN0bXQgPSBj\nb25uLnByZXBhcmVTdGF0ZW1lbnQoIklOU0VSVCBJTlRPICIgKyBnZXRUYWJs\nZU5hbWVGb3JUb3BpYyh0b3BpYykgKyAiIFZBTFVFUyg/LD8pIik7CiAgICAg\nICAgICAgICAgICBzdG10LnNldExvbmcoMSwgc2VxSWQpOwogICAgICAgICAg\nICAgICAgc3RtdC5zZXRCbG9iKDIsIG5ldyBTZXJpYWxCbG9iKG1lc3NhZ2Uu\ndG9CeXRlQXJyYXkoKSkpOwoKICAgICAgICAgICAgICAgIGludCByb3dDb3Vu\ndCA9IHN0bXQuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICAgICAgc3Rt\ndC5jbG9zZSgpOwogICAgICAgICAgICAgICAgaWYgKHJvd0NvdW50ICE9IDEp\nIHsKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIlVuZXhwZWN0\nZWQgbnVtYmVyIG9mIGFmZmVjdGVkIHJvd3MgZnJvbSBkZXJieSIpOwogICAg\nICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgs\nIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlvbigiVW5leHBlY3RlZCByZXNwb25z\nZSBmcm9tIGRlcmJ5IikpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc3FsZSkgewogICAgICAg\nICAgICAgICAgU3RyaW5nIHRoZUVycm9yID0gKHNxbGUpLmdldFNRTFN0YXRl\nKCk7CiAgICAgICAgICAgICAgICBpZiAodGhlRXJyb3IuZXF1YWxzKCI0Mlgw\nNSIpICYmICF0cmllZENyZWF0aW5nVGFibGUpIHsKICAgICAgICAgICAgICAg\nICAgICBjcmVhdGVUYWJsZShjb25uLCB0b3BpYyk7CiAgICAgICAgICAgICAg\nICAgICAgdHJpZWRDcmVhdGluZ1RhYmxlID0gdHJ1ZTsKICAgICAgICAgICAg\nICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIHdoaWxlIGV4ZWN1dGluZyBk\nZXJieSBpbnNlcnQiLCBzcWxlKTsKICAgICAgICAgICAgICAgIGNhbGxiYWNr\nLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlv\nbihzcWxlKSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNo\nZWQoY3R4LCBNZXNzYWdlSWRVdGlscy5tZXJnZUxvY2FsU2VxSWQobWVzc2Fn\nZSwgc2VxSWQpLmdldE1zZ0lkKCkpOwogICAgfQoKICAgIC8qCiAgICAgKiBU\naGlzIG1ldGhvZCBkb2VzIG5vdCB0aHJvdyBhbiBleGNlcHRpb24gYmVjYXVz\nZSBhbm90aGVyIHRocmVhZCBtaWdodAogICAgICogc25lYWsgaW4gYW5kIGNy\nZWF0ZSB0aGUgdGFibGUgYmVmb3JlIHVzCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBjcmVhdGVUYWJsZShDb25uZWN0aW9uIGNvbm4sIEJ5dGVTdHJpbmcg\ndG9waWMpIHsKICAgICAgICBTdGF0ZW1lbnQgc3RtdCA9IG51bGw7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgc3RtdCA9IGNvbm4uY3JlYXRlU3RhdGVt\nZW50KCk7CiAgICAgICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSBnZXRUYWJs\nZU5hbWVGb3JUb3BpYyh0b3BpYyk7CiAgICAgICAgICAgIHN0bXQuZXhlY3V0\nZSgiQ1JFQVRFIFRBQkxFICIgKyB0YWJsZU5hbWUgKyAiICgiICsgSURfRklF\nTERfTkFNRSArICIgQklHSU5UIE5PVCBOVUxMIENPTlNUUkFJTlQgSURfUEtf\nIgogICAgICAgICAgICAgICAgICAgICsgdGFibGVOYW1lICsgIiBQUklNQVJZ\nIEtFWSwiICsgTVNHX0ZJRUxEX05BTUUgKyAiIEJMT0IoMk0pIE5PVCBOVUxM\nKSIpOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIGxvZ2dlci5kZWJ1ZygiQ291bGQgbm90IGNyZWF0ZSB0YWJsZSIs\nIGUpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBpZiAoc3RtdCAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgc3RtdC5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgbG9nZ2VyLmVycm9yKCJFcnJvciBjbG9zaW5nIHN0YXRlbWVudCIs\nIGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHB1Ymxp\nYyBNZXNzYWdlU2VxSWQgZ2V0Q3VycmVudFNlcUlkRm9yVG9waWMoQnl0ZVN0\ncmluZyB0b3BpYykgewogICAgICAgIHJldHVybiBlbnN1cmVTZXFJZEV4aXN0\nc0ZvclRvcGljKHRvcGljKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzY2Fu\nU2luZ2xlTWVzc2FnZShTY2FuUmVxdWVzdCByZXF1ZXN0KSB7CiAgICAgICAg\nc2Nhbk1lc3NhZ2VzSW50ZXJuYWwocmVxdWVzdC5nZXRUb3BpYygpLCByZXF1\nZXN0LmdldFN0YXJ0U2VxSWQoKSwgMSwgTG9uZy5NQVhfVkFMVUUsIHJlcXVl\nc3QuZ2V0Q2FsbGJhY2soKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICByZXF1ZXN0LmdldEN0eCgpLCAxKTsKICAgICAgICByZXR1cm47CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2Nhbk1lc3NhZ2VzKFJhbmdlU2NhblJlcXVl\nc3QgcmVxdWVzdCkgewogICAgICAgIHNjYW5NZXNzYWdlc0ludGVybmFsKHJl\ncXVlc3QuZ2V0VG9waWMoKSwgcmVxdWVzdC5nZXRTdGFydFNlcUlkKCksIHJl\ncXVlc3QuZ2V0TWVzc2FnZUxpbWl0KCksIHJlcXVlc3QKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAuZ2V0U2l6ZUxpbWl0KCksIHJlcXVlc3QuZ2V0\nQ2FsbGJhY2soKSwgcmVxdWVzdC5nZXRDdHgoKSwgU0NBTl9DSFVOSyk7CiAg\nICAgICAgcmV0dXJuOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIGdldFRh\nYmxlTmFtZUZvclRvcGljKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAgICAgICBT\ndHJpbmcgc3JjID0gKHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIl8iICsgdmVy\nc2lvbik7CiAgICAgICAgdGhyZWFkTG9jYWxEaWdlc3QuZ2V0KCkucmVzZXQo\nKTsKICAgICAgICBieXRlW10gZGlnZXN0ID0gdGhyZWFkTG9jYWxEaWdlc3Qu\nZ2V0KCkuZGlnZXN0KHNyYy5nZXRCeXRlcygpKTsKICAgICAgICBCaWdJbnRl\nZ2VyIGJpZ0ludCA9IG5ldyBCaWdJbnRlZ2VyKDEsZGlnZXN0KTsKICAgICAg\nICByZXR1cm4gU3RyaW5nLmZvcm1hdCgiVEFCTEVfJTAzMlgiLCBiaWdJbnQp\nOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzY2FuTWVzc2FnZXNJbnRlcm5h\nbChCeXRlU3RyaW5nIHRvcGljLCBsb25nIHN0YXJ0U2VxSWQsIGludCBtZXNz\nYWdlTGltaXQsIGxvbmcgc2l6ZUxpbWl0LAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIFNjYW5DYWxsYmFjayBjYWxsYmFjaywgT2Jq\nZWN0IGN0eCwgaW50IHNjYW5DaHVuaykgewoKICAgICAgICBDb25uZWN0aW9u\nIGNvbm4gPSB0aHJlYWRMb2NhbENvbm5lY3Rpb24uZ2V0KCk7CgogICAgICAg\nIGlmIChjb25uID09IG51bGwpIHsKICAgICAgICAgICAgY2FsbGJhY2suc2Nh\nbkZhaWxlZChjdHgsIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlvbigiTm90IGNv\nbm5lY3RlZCB0byBkZXJieSIpKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KCiAgICAgICAgbG9uZyBjdXJyZW50U2VxSWQ7CiAgICAgICAgY3Vy\ncmVudFNlcUlkID0gc3RhcnRTZXFJZDsKCiAgICAgICAgUHJlcGFyZWRTdGF0\nZW1lbnQgc3RtdCA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIHN0bXQgPSBjb25uLnByZXBhcmVTdGF0\nZW1lbnQoIlNFTEVDVCAqIEZST00gIiArIGdldFRhYmxlTmFtZUZvclRvcGlj\nKHRvcGljKSArICIgV0hFUkUgIiArIElEX0ZJRUxEX05BTUUKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiID49ID8g\nIEFORCAiICsgSURfRklFTERfTkFNRSArICIgPD0gPyIpOwoKICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNxbGUpIHsKICAgICAgICAgICAg\nICAgIFN0cmluZyB0aGVFcnJvciA9IChzcWxlKS5nZXRTUUxTdGF0ZSgpOwog\nICAgICAgICAgICAgICAgaWYgKHRoZUVycm9yLmVxdWFscygiNDJYMDUiKSkg\newogICAgICAgICAgICAgICAgICAgIC8vIE5vIHRhYmxlLCBzY2FuIGlzIG92\nZXIKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5zY2FuRmluaXNoZWQo\nY3R4LCBSZWFzb25Gb3JGaW5pc2guTk9fTU9SRV9NRVNTQUdFUyk7CiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBzcWxlOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpbnQgbnVtTWVz\nc2FnZXMgPSAwOwogICAgICAgICAgICBsb25nIHRvdGFsU2l6ZSA9IDA7Cgog\nICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewoKICAgICAgICAgICAgICAgIHN0\nbXQuc2V0TG9uZygxLCBjdXJyZW50U2VxSWQpOwogICAgICAgICAgICAgICAg\nc3RtdC5zZXRMb25nKDIsIGN1cnJlbnRTZXFJZCArIHNjYW5DaHVuayk7Cgog\nICAgICAgICAgICAgICAgaWYgKCFzdG10LmV4ZWN1dGUoKSkgewogICAgICAg\nICAgICAgICAgICAgIFN0cmluZyBlcnJvck1zZyA9ICJTZWxlY3QgcXVlcnkg\nZGlkIG5vdCByZXR1cm4gYSByZXN1bHQgc2V0IjsKICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoZXJyb3JNc2cpOwogICAgICAgICAgICAgICAg\nICAgIHN0bXQuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5zY2FuRmFpbGVkKGN0eCwgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKGVy\ncm9yTXNnKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFJlc3VsdFNldCByZXN1bHRT\nZXQgPSBzdG10LmdldFJlc3VsdFNldCgpOwoKICAgICAgICAgICAgICAgIGlm\nICghcmVzdWx0U2V0Lm5leHQoKSkgewogICAgICAgICAgICAgICAgICAgIHN0\nbXQuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5zY2Fu\nRmluaXNoZWQoY3R4LCBSZWFzb25Gb3JGaW5pc2guTk9fTU9SRV9NRVNTQUdF\nUyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgIGRvIHsKCiAgICAgICAgICAgICAgICAg\nICAgbG9uZyBsb2NhbFNlcUlkID0gcmVzdWx0U2V0LmdldExvbmcoMSk7Cgog\nICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UuQnVpbGRlciBtZXNzYWdlQnVp\nbGRlciA9IE1lc3NhZ2UubmV3QnVpbGRlcigpLm1lcmdlRnJvbShyZXN1bHRT\nZXQuZ2V0QmluYXJ5U3RyZWFtKDIpKTsKCiAgICAgICAgICAgICAgICAgICAg\nLy8gTWVyZ2UgaW4gdGhlIGxvY2FsIHNlcS1pZCBzaW5jZSB0aGF0IGlzIG5v\ndCBzdG9yZWQgd2l0aAogICAgICAgICAgICAgICAgICAgIC8vIHRoZSBtZXNz\nYWdlCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSBtZXNzYWdlID0gTWVz\nc2FnZUlkVXRpbHMubWVyZ2VMb2NhbFNlcUlkKG1lc3NhZ2VCdWlsZGVyLCBs\nb2NhbFNlcUlkKTsKCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2subWVz\nc2FnZVNjYW5uZWQoY3R4LCBtZXNzYWdlKTsKICAgICAgICAgICAgICAgICAg\nICBudW1NZXNzYWdlcysrOwogICAgICAgICAgICAgICAgICAgIHRvdGFsU2l6\nZSArPSBtZXNzYWdlLmdldEJvZHkoKS5zaXplKCk7CgogICAgICAgICAgICAg\nICAgICAgIGlmIChudW1NZXNzYWdlcyA+IG1lc3NhZ2VMaW1pdCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBzdG10LmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGNhbGxiYWNrLnNjYW5GaW5pc2hlZChjdHgsIFJlYXNv\nbkZvckZpbmlzaC5OVU1fTUVTU0FHRVNfTElNSVRfRVhDRUVERUQpOwogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAg\nICAgfSBlbHNlIGlmICh0b3RhbFNpemUgPiBzaXplTGltaXQpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgc3RtdC5jbG9zZSgpOwogICAgICAgICAgICAg\nICAgICAgICAgICBjYWxsYmFjay5zY2FuRmluaXNoZWQoY3R4LCBSZWFzb25G\nb3JGaW5pc2guU0laRV9MSU1JVF9FWENFRURFRCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgfSB3aGlsZSAocmVzdWx0U2V0Lm5leHQoKSk7CgogICAg\nICAgICAgICAgICAgY3VycmVudFNlcUlkICs9IFNDQU5fQ0hVTks7CiAgICAg\nICAgICAgIH0KICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBsb2dnZXIuZXJyb3IoIlNRTCBFeGNlcHRpb24iLCBlKTsK\nICAgICAgICAgICAgY2FsbGJhY2suc2NhbkZhaWxlZChjdHgsIG5ldyBTZXJ2\naWNlRG93bkV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcigiTWVzc2FnZSBzdG9yZWQgaW4gZGVyYnkgaXMgbm90IHBh\ncnNlYWJsZSIsIGUpOwogICAgICAgICAgICBjYWxsYmFjay5zY2FuRmFpbGVk\nKGN0eCwgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBpZiAoc3RtdCAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICAgICAgc3RtdC5jbG9zZSgpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJFcnJvciBjbG9zaW5nIHN0YXRl\nbWVudCIsIGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGRlbGl2ZXJlZFVudGlsKEJ5dGVTdHJpbmcgdG9waWMs\nIExvbmcgc2VxSWQpIHsKICAgICAgICAvLyBub29wCiAgICB9CgogICAgcHVi\nbGljIHZvaWQgY29uc3VtZWRVbnRpbChCeXRlU3RyaW5nIHRvcGljLCBMb25n\nIHNlcUlkKSB7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gdGhyZWFkTG9j\nYWxDb25uZWN0aW9uLmdldCgpOwogICAgICAgIGlmIChjb25uID09IG51bGwp\nIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJOb3QgY29ubmVjdGVkIHRv\nIGRlcmJ5Iik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAg\nICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtdCA9IG51bGw7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgc3RtdCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudCgi\nREVMRVRFIEZST00gIiArIGdldFRhYmxlTmFtZUZvclRvcGljKHRvcGljKSAr\nICIgV0hFUkUgIiArIElEX0ZJRUxEX05BTUUKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICArICIgPD0gPyIpOwogICAgICAgICAg\nICBzdG10LnNldExvbmcoMSwgc2VxSWQpOwogICAgICAgICAgICBpbnQgcm93\nQ291bnQgPSBzdG10LmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAgaWYg\nKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgbG9n\nZ2VyLmRlYnVnKCJEZWxldGVkICIgKyByb3dDb3VudCArICIgcmVjb3JkcyBm\nb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAg\nICAgICAgICArICIsIHNlcUlkOiAiICsgc2VxSWQpOwogICAgICAgICAgICB9\nCiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNxbGUpIHsKICAgICAg\nICAgICAgU3RyaW5nIHRoZUVycm9yID0gKHNxbGUpLmdldFNRTFN0YXRlKCk7\nCiAgICAgICAgICAgIGlmICh0aGVFcnJvci5lcXVhbHMoIjQyWDA1IikpIHsK\nICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKCJUYWJsZSBmb3IgdG9waWMg\nKCIgKyB0b3BpYyArICIpIGRvZXMgbm90IGV4aXN0IHNvIG5vIGNvbnN1bWVk\nIG1lc3NhZ2VzIHRvIGRlbGV0ZSEiKTsKICAgICAgICAgICAgfSBlbHNlCiAg\nICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIHdoaWxlIGV4ZWN1\ndGluZyBkZXJieSBkZWxldGUgZm9yIGNvbnN1bWVkIG1lc3NhZ2VzIiwgc3Fs\nZSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIGlmIChzdG10ICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgICAgICBzdG10LmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIGNsb3Npbmcgc3RhdGVtZW50Iiwg\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0TWVzc2FnZUJvdW5kKEJ5dGVTdHJpbmcgdG9waWMsIEludGVn\nZXIgYm91bmQpIHsKICAgICAgICAvLyBub29wOyBNYXliZSBpbXBsZW1lbnQg\nbGF0ZXIKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbGVhck1lc3NhZ2VCb3Vu\nZChCeXRlU3RyaW5nIHRvcGljKSB7CiAgICAgICAgLy8gbm9vcDsgTWF5YmUg\naW1wbGVtZW50IGxhdGVyCiAgICB9CgogICAgcHVibGljIHZvaWQgY29uc3Vt\nZVRvQm91bmQoQnl0ZVN0cmluZyB0b3BpYykgewogICAgICAgIC8vIG5vb3A7\nIE1heWJlIGltcGxlbWVudCBsYXRlcgogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIHZvaWQgZmluYWxpemUoKSB0aHJvd3MgVGhyb3dhYmxl\nIHsKICAgICAgICBpZiAoZHJpdmVyLmVxdWFscygib3JnLmFwYWNoZS5kZXJi\neS5qZGJjLkVtYmVkZGVkRHJpdmVyIikpIHsKICAgICAgICAgICAgYm9vbGVh\nbiBnb3RTUUxFeGMgPSBmYWxzZTsKICAgICAgICAgICAgLy8gVGhpcyBpcyB3\nZWlyZDogb24gbm9ybWFsIHNodXRkb3duLCBpdCB0aHJvd3MgYW4gZXhjZXB0\naW9uCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBEcml2ZXJN\nYW5hZ2VyLmdldENvbm5lY3Rpb24oImpkYmM6ZGVyYnk6O3NodXRkb3duPXRy\ndWUiKS5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgICAgIGlmIChzZS5nZXRTUUxTdGF0ZSgp\nLmVxdWFscygiWEowMTUiKSkgewogICAgICAgICAgICAgICAgICAgIGdvdFNR\nTEV4YyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgaWYgKCFnb3RTUUxFeGMpIHsKICAgICAgICAgICAgICAg\nIGxvZ2dlci5lcnJvcigiRGF0YWJhc2UgZGlkIG5vdCBzaHV0IGRvd24gbm9y\nbWFsbHkiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nIGxvZ2dlci5pbmZvKCJEYXRhYmFzZSBzaHV0IGRvd24gbm9ybWFsbHkiKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzdXBlci5maW5hbGl6\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlc2V0KCkgewogICAgICAg\nIC8vIGp1c3QgbW92ZSB0aGUgbmFtZXNwYWNlIG92ZXIgdG8gdGhlIG5leHQg\nb25lCiAgICAgICAgdmVyc2lvbisrOwogICAgICAgIGN1cnJUb3BpY1NlcUlk\ncy5jbGVhcigpOwogICAgfQp9Cg==\n","encoding":"base64"}

