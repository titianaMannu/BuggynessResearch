{"sha":"9a4cb3d6d32e77e5f22f9ff4b29e8c7efcd51b7a","node_id":"MDQ6QmxvYjE1NzU5NTY6OWE0Y2IzZDZkMzJlNzdlNWYyMmY5ZmY0YjI5ZThjN2VmY2Q1MWI3YQ==","size":5074,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/9a4cb3d6d32e77e5f22f9ff4b29e8c7efcd51b7a","content":"cGFja2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKLyoK\nICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0\naGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z\nIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICov\nCgppbXBvcnQgamF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLlN0cmluZ1JlYWRlcjsK\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90\nb2NvbC5IdWJJbmZvRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0\naWwuSGVkd2lnU29ja2V0QWRkcmVzczsKCmltcG9ydCBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbjsKaW1wb3J0\nIGNvbS5nb29nbGUucHJvdG9idWYuVGV4dEZvcm1hdDsKCi8qKgogKiBJbmZv\nIGlkZW50aWZpZXMgYSBodWIgc2VydmVyLgogKi8KcHVibGljIGNsYXNzIEh1\nYkluZm8gewoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgSW52YWxpZEh1Yklu\nZm9FeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb24gewogICAgICAgIHB1Ymxp\nYyBJbnZhbGlkSHViSW5mb0V4Y2VwdGlvbihTdHJpbmcgbXNnKSB7CiAgICAg\nICAgICAgIHN1cGVyKG1zZyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nSW52YWxpZEh1YkluZm9FeGNlcHRpb24oU3RyaW5nIG1zZywgVGhyb3dhYmxl\nIHQpIHsKICAgICAgICAgICAgc3VwZXIobXNnLCB0KTsKICAgICAgICB9CiAg\nICB9CgogICAgLy8gYWRkcmVzcyBpZGVudGlmeSBhIGh1YiBzZXJ2ZXIKICAg\nIGZpbmFsIEhlZHdpZ1NvY2tldEFkZHJlc3MgYWRkcjsKICAgIC8vIGl0cyB6\nbm9kZSBjenhpZAogICAgZmluYWwgbG9uZyBjenhpZDsKICAgIC8vIHByb3Rv\nYnVmIGVuY29kZWQgaHViIGluZm8gZGF0YSB0byBiZSBzZXJpYWxpemVkCiAg\nICBIdWJJbmZvRGF0YSBodWJJbmZvRGF0YTsKCiAgICBwdWJsaWMgSHViSW5m\nbyhIZWR3aWdTb2NrZXRBZGRyZXNzIGFkZHIsIGxvbmcgY3p4aWQpIHsKICAg\nICAgICB0aGlzKGFkZHIsIGN6eGlkLCBudWxsKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgSHViSW5mbyhIZWR3aWdTb2NrZXRBZGRyZXNzIGFkZHIsIGxvbmcg\nY3p4aWQsCiAgICAgICAgICAgICAgICAgICAgICBIdWJJbmZvRGF0YSBkYXRh\nKSB7CiAgICAgICAgdGhpcy5hZGRyID0gYWRkcjsKICAgICAgICB0aGlzLmN6\neGlkID0gY3p4aWQ7CiAgICAgICAgdGhpcy5odWJJbmZvRGF0YSA9IGRhdGE7\nCiAgICB9CgogICAgcHVibGljIEhlZHdpZ1NvY2tldEFkZHJlc3MgZ2V0QWRk\ncmVzcygpIHsKICAgICAgICByZXR1cm4gYWRkcjsKICAgIH0KCiAgICBwdWJs\naWMgbG9uZyBnZXRaeGlkKCkgewogICAgICAgIHJldHVybiBjenhpZDsKICAg\nIH0KCiAgICBwcml2YXRlIHN5bmNocm9uaXplZCBIdWJJbmZvRGF0YSBnZXRI\ndWJJbmZvRGF0YSgpIHsKICAgICAgICBpZiAobnVsbCA9PSBodWJJbmZvRGF0\nYSkgewogICAgICAgICAgICBodWJJbmZvRGF0YSA9IEh1YkluZm9EYXRhLm5l\nd0J1aWxkZXIoKS5zZXRIb3N0bmFtZShhZGRyLnRvU3RyaW5nKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0Q3p4aWQoY3p4\naWQpLmJ1aWxkKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBodWJJbmZv\nRGF0YTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmcg\ndG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIFRleHRGb3JtYXQucHJpbnRU\nb1N0cmluZyhnZXRIdWJJbmZvRGF0YSgpKTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3QgbykgewogICAg\nICAgIGlmIChudWxsID09IG8pIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIH0KICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgSHViSW5m\nbykpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAg\nICAgICBIdWJJbmZvIG90aGVyID0gKEh1YkluZm8pbzsKICAgICAgICBpZiAo\nbnVsbCA9PSBhZGRyKSB7CiAgICAgICAgICAgIGlmIChudWxsID09IG90aGVy\nLmFkZHIpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGN6eGlkID09\nIG90aGVyLmN6eGlkOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgaWYgKGFkZHIuZXF1YWxzKG90aGVyLmFkZHIpKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm4gY3p4aWQgPT0gb3RoZXIuY3p4aWQ7CiAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAgIHJldHVy\nbiBhZGRyLmhhc2hDb2RlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBodWIgaW5mbyBmcm9tIGEgc3RyaW5nLgogICAgICoKICAgICAqIEBwYXJh\nbSBodWJJbmZvU3RyCiAgICAgKiAgICAgICAgICBTdHJpbmcgcmVwcmVzZW50\nYXRpb24gb2YgaHViIGluZm8KICAgICAqIEByZXR1cm4gaHViIGluZm8KICAg\nICAqIEB0aHJvd3MgSW52YWxpZEh1YkluZm9FeGNlcHRpb24gd2hlbiA8Y29k\nZT5odWJJbmZvU3RyPC9jb2RlPiBpcyBub3QgYSB2YWxpZAogICAgICogICAg\nICAgICBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgaHViIGluZm8uCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgSHViSW5mbyBwYXJzZShTdHJpbmcgaHVi\nSW5mb1N0cikgdGhyb3dzIEludmFsaWRIdWJJbmZvRXhjZXB0aW9uIHsKICAg\nICAgICAvLyBpdCBpcyBub3QgcHJvdG9idWYgZW5jb2RlZCBodWIgaW5mbywg\naXQgbWlnaHQgYmUgZ2VuZXJhdGVkIGJ5IFprVG9waWNNYW5hZ2VyCiAgICAg\nICAgaWYgKCFodWJJbmZvU3RyLnN0YXJ0c1dpdGgoImhvc3RuYW1lIikpIHsK\nICAgICAgICAgICAgZmluYWwgSGVkd2lnU29ja2V0QWRkcmVzcyBvd25lcjsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIG93bmVyID0gbmV3\nIEhlZHdpZ1NvY2tldEFkZHJlc3MoaHViSW5mb1N0cik7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSW52YWxpZEh1YkluZm9FeGNlcHRpb24oIkNvcnJ1cHRlZCBodWIg\nc2VydmVyIGFkZHJlc3MgOiAiICsgaHViSW5mb1N0ciwgZSk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgcmV0dXJuIG5ldyBIdWJJbmZvKG93bmVyLCAw\nTCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpdCBpcyBhIHByb3RvYnVmIGVu\nY29kZWQgaHViIGluZm8uCiAgICAgICAgSHViSW5mb0RhdGEgaHViSW5mb0Rh\ndGE7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEJ1ZmZlcmVkUmVhZGVy\nIHJlYWRlciA9IG5ldyBCdWZmZXJlZFJlYWRlcigKICAgICAgICAgICAgICAg\nIG5ldyBTdHJpbmdSZWFkZXIoaHViSW5mb1N0cikpOwogICAgICAgICAgICBI\ndWJJbmZvRGF0YS5CdWlsZGVyIGRhdGFCdWlsZGVyID0gSHViSW5mb0RhdGEu\nbmV3QnVpbGRlcigpOwogICAgICAgICAgICBUZXh0Rm9ybWF0Lm1lcmdlKHJl\nYWRlciwgZGF0YUJ1aWxkZXIpOwogICAgICAgICAgICBodWJJbmZvRGF0YSA9\nIGRhdGFCdWlsZGVyLmJ1aWxkKCk7CiAgICAgICAgfSBjYXRjaCAoSW52YWxp\nZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIGlwYmUpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IEludmFsaWRIdWJJbmZvRXhjZXB0aW9uKCJDb3JydXB0ZWQg\naHViIGluZm8gOiAiICsgaHViSW5mb1N0ciwgaXBiZSk7CiAgICAgICAgfSBj\nYXRjaCAoSU9FeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3\nIEludmFsaWRIdWJJbmZvRXhjZXB0aW9uKCJDb3JydXB0ZWQgaHViIGluZm8g\nOiAiICsgaHViSW5mb1N0ciwgaWUpOwogICAgICAgIH0KCiAgICAgICAgZmlu\nYWwgSGVkd2lnU29ja2V0QWRkcmVzcyBvd25lcjsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBvd25lciA9IG5ldyBIZWR3aWdTb2NrZXRBZGRyZXNzKGh1\nYkluZm9EYXRhLmdldEhvc3RuYW1lKCkudHJpbSgpKTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW52\nYWxpZEh1YkluZm9FeGNlcHRpb24oIkNvcnJ1cHRlZCBodWIgc2VydmVyIGFk\nZHJlc3MgOiAiICsgaHViSW5mb0RhdGEuZ2V0SG9zdG5hbWUoKSwgZSk7CiAg\nICAgICAgfQogICAgICAgIGxvbmcgb3duZXJaeGlkID0gaHViSW5mb0RhdGEu\nZ2V0Q3p4aWQoKTsKICAgICAgICByZXR1cm4gbmV3IEh1YkluZm8ob3duZXIs\nIG93bmVyWnhpZCwgaHViSW5mb0RhdGEpOwogICAgfQp9Cg==\n","encoding":"base64"}

