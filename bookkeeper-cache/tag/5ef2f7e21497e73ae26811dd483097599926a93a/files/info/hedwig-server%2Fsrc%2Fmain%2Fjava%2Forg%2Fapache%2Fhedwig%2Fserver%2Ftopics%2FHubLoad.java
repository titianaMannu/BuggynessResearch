{"sha":"79f7922dcaeb377d4aa30723c7ef96072735b67a","node_id":"MDQ6QmxvYjE1NzU5NTY6NzlmNzkyMmRjYWViMzc3ZDRhYTMwNzIzYzdlZjk2MDcyNzM1YjY3YQ==","size":4198,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/79f7922dcaeb377d4aa30723c7ef96072735b67a","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljczsK\nCmltcG9ydCBqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5p\nby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyaW5nUmVhZGVyOwoK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3Rv\nY29sLkh1YkxvYWREYXRhOwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYu\nSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uOwppbXBvcnQgY29tLmdv\nb2dsZS5wcm90b2J1Zi5UZXh0Rm9ybWF0OwoKLyoqCiAqIFRoaXMgY2xhc3Mg\nZW5jYXBzdWxhdGVzIG1ldHJpY3MgZm9yIGRldGVybWluaW5nIHRoZSBsb2Fk\nIG9uIGEgaHViIHNlcnZlci4KICovCnB1YmxpYyBjbGFzcyBIdWJMb2FkIGlt\ncGxlbWVudHMgQ29tcGFyYWJsZTxIdWJMb2FkPiB7CgogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBIdWJMb2FkIE1BWF9MT0FEID0gbmV3IEh1YkxvYWQoTG9u\nZy5NQVhfVkFMVUUpOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBIdWJMb2Fk\nIE1JTl9MT0FEID0gbmV3IEh1YkxvYWQoMCk7CgogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcHVibGljIEludmFsaWRIdWJMb2FkRXhjZXB0aW9u\nKFN0cmluZyBtc2cpIHsKICAgICAgICAgICAgc3VwZXIobXNnKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbihT\ndHJpbmcgbXNnLCBUaHJvd2FibGUgdCkgewogICAgICAgICAgICBzdXBlciht\nc2csIHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBob3cgbWFueSB0b3Bp\nY3MgdGhhdCBhIGh1YiBzZXJ2ZXIgc2VydmVzCiAgICBsb25nIG51bVRvcGlj\nczsgCgogICAgcHVibGljIEh1YkxvYWQobG9uZyBudW0pIHsKICAgICAgICB0\naGlzLm51bVRvcGljcyA9IG51bTsKICAgIH0KCiAgICBwdWJsaWMgSHViTG9h\nZChIdWJMb2FkRGF0YSBkYXRhKSB7CiAgICAgICAgdGhpcy5udW1Ub3BpY3Mg\nPSBkYXRhLmdldE51bVRvcGljcygpOwogICAgfQoKICAgIHB1YmxpYyBIdWJM\nb2FkIHNldE51bVRvcGljcyhsb25nIG51bVRvcGljcykgewogICAgICAgIHRo\naXMubnVtVG9waWNzID0gbnVtVG9waWNzOwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgfQoKICAgIHB1YmxpYyBIdWJMb2FkRGF0YSB0b0h1YkxvYWREYXRh\nKCkgewogICAgICAgIHJldHVybiBIdWJMb2FkRGF0YS5uZXdCdWlsZGVyKCku\nc2V0TnVtVG9waWNzKG51bVRvcGljcykuYnVpbGQoKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAg\nICAgcmV0dXJuIFRleHRGb3JtYXQucHJpbnRUb1N0cmluZyh0b0h1YkxvYWRE\nYXRhKCkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xl\nYW4gZXF1YWxzKE9iamVjdCBvKSB7CiAgICAgICAgaWYgKG51bGwgPT0gbyB8\nfAogICAgICAgICAgICAhKG8gaW5zdGFuY2VvZiBIdWJMb2FkKSkgewogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiAwID09IGNvbXBhcmVUbygoSHViTG9hZClvKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyBpbnQgY29tcGFyZVRvKEh1YkxvYWQgb3RoZXIp\nIHsKICAgICAgICByZXR1cm4gbnVtVG9waWNzID4gb3RoZXIubnVtVG9waWNz\nID8KICAgICAgICAgICAgICAgMSA6IChudW1Ub3BpY3MgPCBvdGhlci5udW1U\nb3BpY3MgPyAtMSA6IDApOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICByZXR1cm4gKGludCludW1U\nb3BpY3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBodWIgbG9hZCBm\ncm9tIGEgc3RyaW5nLgogICAgICoKICAgICAqIEBwYXJhbSBodWJMb2FkU3Ry\nCiAgICAgKiAgICAgICAgICBTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgaHVi\nIGxvYWQKICAgICAqIEByZXR1cm4gaHViIGxvYWQKICAgICAqIEB0aHJvd3Mg\nSW52YWxpZEh1YkxvYWRFeGNlcHRpb24gd2hlbiA8Y29kZT5odWJMb2FkU3Ry\nPC9jb2RlPiBpcyBub3QgYSB2YWxpZAogICAgICogICAgICAgICBzdHJpbmcg\ncmVwcmVzZW50YXRpb24gb2YgaHViIGxvYWQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgSHViTG9hZCBwYXJzZShTdHJpbmcgaHViTG9hZFN0cikgdGhy\nb3dzIEludmFsaWRIdWJMb2FkRXhjZXB0aW9uIHsKICAgICAgICAvLyBpdCBp\ncyBubyBwcm90b2J1ZiBlbmNvZGVkIGh1YiBpbmZvLCBpdCBtaWdodCBiZSBn\nZW5lcmF0ZWQgYnkgWmtUb3BpY01hbmFnZXIKICAgICAgICBpZiAoIWh1Ykxv\nYWRTdHIuc3RhcnRzV2l0aCgibnVtVG9waWNzIikpIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIGxvbmcgbnVtVG9waWNzID0gTG9uZy5w\nYXJzZUxvbmcoaHViTG9hZFN0ciwgMTApOwogICAgICAgICAgICAgICAgcmV0\ndXJuIG5ldyBIdWJMb2FkKG51bVRvcGljcyk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbigiQ29ycnVw\ndGVkIGh1YiBsb2FkIGRhdGEgOiAiICsgaHViTG9hZFN0ciwgbmZlKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBpdCBpdCBhIHByb3Rv\nYnVmIGVuY29kZWQgaHViIGxvYWQgZGF0YS4KICAgICAgICBIdWJMb2FkRGF0\nYSBodWJMb2FkRGF0YTsKICAgICAgICB0cnkgewogICAgICAgICAgICBCdWZm\nZXJlZFJlYWRlciByZWFkZXIgPSBuZXcgQnVmZmVyZWRSZWFkZXIoCiAgICAg\nICAgICAgICAgICBuZXcgU3RyaW5nUmVhZGVyKGh1YkxvYWRTdHIpKTsKICAg\nICAgICAgICAgSHViTG9hZERhdGEuQnVpbGRlciBkYXRhQnVpbGRlciA9IEh1\nYkxvYWREYXRhLm5ld0J1aWxkZXIoKTsKICAgICAgICAgICAgVGV4dEZvcm1h\ndC5tZXJnZShyZWFkZXIsIGRhdGFCdWlsZGVyKTsKICAgICAgICAgICAgaHVi\nTG9hZERhdGEgPSBkYXRhQnVpbGRlci5idWlsZCgpOwogICAgICAgIH0gY2F0\nY2ggKEludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiBpcGJlKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbigi\nQ29ycnVwdGVkIGh1YiBsb2FkIGRhdGEgOiAiICsgaHViTG9hZFN0ciwgaXBi\nZSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaWUpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IEludmFsaWRIdWJMb2FkRXhjZXB0aW9uKCJDb3Jy\ndXB0ZWQgaHViIGxvYWQgZGF0YSA6ICIgKyBodWJMb2FkU3RyLCBpZSk7CiAg\nICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IEh1YkxvYWQoaHViTG9hZERh\ndGEpOwogICAgfQp9Cg==\n","encoding":"base64"}

