{"sha":"c54442b8861ec68bd6b5c324cedebc503f87c326","node_id":"MDQ6QmxvYjE1NzU5NTY6YzU0NDQyYjg4NjFlYzY4YmQ2YjVjMzI0Y2VkZWJjNTAzZjg3YzMyNg==","size":5719,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/c54442b8861ec68bd6b5c324cedebc503f87c326","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXI7CgppbXBvcnQgamF2YS51\ndGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9y\ndCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBv\ncnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsK\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5DbGllbnRD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVy\nLmNvbW1vbi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLm5ldHR5LlB1YlN1YlNlcnZlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5Cb29rS2VlcGVy\nVGVzdEJhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkhlZHdp\nZ1NvY2tldEFkZHJlc3M7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnRlc3QuUG9ydE1hbmFnZXI7CgovKioKICogVGhpcyBpcyBhIGJhc2UgY2xh\nc3MgZm9yIGFueSB0ZXN0cyB0aGF0IG5lZWQgYSBIZWR3aWcgSHViKHMpIHNl\ndHVwIHdpdGggYW4KICogYXNzb2NpYXRlZCBCb29rS2VlcGVyIGFuZCBab29L\nZWVwZXIgaW5zdGFuY2UuCiAqCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3Mg\nSGVkd2lnSHViVGVzdEJhc2UgZXh0ZW5kcyBUZXN0Q2FzZSB7CgogICAgcHJv\ndGVjdGVkIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5n\nZXRMb2dnZXIoSGVkd2lnSHViVGVzdEJhc2UuY2xhc3MpOwoKICAgIC8vIEJv\nb2tLZWVwZXIgdmFyaWFibGVzCiAgICAvLyBEZWZhdWx0IG51bWJlciBvZiBi\nb29raWUgc2VydmVycyB0byBzZXR1cC4gRXh0ZW5kaW5nIGNsYXNzZXMgY2Fu\nCiAgICAvLyBvdmVycmlkZSB0aGlzLgogICAgcHJvdGVjdGVkIGludCBudW1C\nb29raWVzID0gMzsKICAgIHByb3RlY3RlZCBsb25nIHJlYWREZWxheSA9IDBM\nOwogICAgcHJvdGVjdGVkIEJvb2tLZWVwZXJUZXN0QmFzZSBia3RiOwoKICAg\nIC8vIFB1YlN1YlNlcnZlciB2YXJpYWJsZXMKICAgIC8vIERlZmF1bHQgbnVt\nYmVyIG9mIFB1YlN1YlNlcnZlciBodWJzIHRvIHNldHVwLiBFeHRlbmRpbmcg\nY2xhc3NlcyBjYW4KICAgIC8vIG92ZXJyaWRlIHRoaXMuCiAgICBwcm90ZWN0\nZWQgZmluYWwgaW50IG51bVNlcnZlcnM7CiAgICBwcm90ZWN0ZWQgTGlzdDxQ\ndWJTdWJTZXJ2ZXI+IHNlcnZlcnNMaXN0OwogICAgcHJvdGVjdGVkIExpc3Q8\nSGVkd2lnU29ja2V0QWRkcmVzcz4gc2VydmVyQWRkcmVzc2VzOwoKICAgIHB1\nYmxpYyBIZWR3aWdIdWJUZXN0QmFzZSgpIHsKICAgICAgICB0aGlzKDEpOwog\nICAgfQoKICAgIHByb3RlY3RlZCBIZWR3aWdIdWJUZXN0QmFzZShpbnQgbnVt\nU2VydmVycykgewogICAgICAgIHRoaXMubnVtU2VydmVycyA9IG51bVNlcnZl\ncnM7CgogICAgICAgIHNlcnZlckFkZHJlc3NlcyA9IG5ldyBMaW5rZWRMaXN0\nPEhlZHdpZ1NvY2tldEFkZHJlc3M+KCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBudW1TZXJ2ZXJzOyBpKyspIHsKICAgICAgICAgICAgc2VydmVy\nQWRkcmVzc2VzLmFkZChuZXcgSGVkd2lnU29ja2V0QWRkcmVzcygibG9jYWxo\nb3N0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIFBvcnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpLCBQb3J0TWFuYWdlci5uZXh0\nRnJlZVBvcnQoKSkpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBEZWZhdWx0\nIGNoaWxkIGNsYXNzIG9mIHRoZSBTZXJ2ZXJDb25maWd1cmF0aW9uIHRvIGJl\nIHVzZWQgaGVyZS4KICAgIC8vIEV4dGVuZGluZyBjbGFzc2VzIGNhbiBkZWZp\nbmUgdGhlaXIgb3duIChwb3NzaWJseSBleHRlbmRpbmcgZnJvbSB0aGlzKSBh\nbmQKICAgIC8vIG92ZXJyaWRlIHRoZSBnZXRTZXJ2ZXJDb25maWd1cmF0aW9u\nIG1ldGhvZCBiZWxvdyB0byByZXR1cm4gdGhlaXIgb3duCiAgICAvLyBjb25m\naWd1cmF0aW9uLgogICAgcHJvdGVjdGVkIGNsYXNzIEh1YlNlcnZlckNvbmZp\nZ3VyYXRpb24gZXh0ZW5kcyBTZXJ2ZXJDb25maWd1cmF0aW9uIHsKICAgICAg\nICBwcml2YXRlIGZpbmFsIGludCBzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0\nOwoKICAgICAgICBwdWJsaWMgSHViU2VydmVyQ29uZmlndXJhdGlvbihpbnQg\nc2VydmVyUG9ydCwgaW50IHNzbFNlcnZlclBvcnQpIHsKICAgICAgICAgICAg\ndGhpcy5zZXJ2ZXJQb3J0ID0gc2VydmVyUG9ydDsKICAgICAgICAgICAgdGhp\ncy5zc2xTZXJ2ZXJQb3J0ID0gc3NsU2VydmVyUG9ydDsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgZ2V0U2VydmVy\nUG9ydCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlcnZlclBvcnQ7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50IGdl\ndFNTTFNlcnZlclBvcnQoKSB7CiAgICAgICAgICAgIHJldHVybiBzc2xTZXJ2\nZXJQb3J0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIFN0cmluZyBnZXRaa0hvc3QoKSB7CiAgICAgICAgICAgIHJldHVy\nbiBia3RiLmdldFprSG9zdFBvcnQoKTsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBib29sZWFuIGlzU1NMRW5hYmxlZCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nIGdldENlcnROYW1l\nKCkgewogICAgICAgICAgICByZXR1cm4gIi9zZXJ2ZXIucDEyIjsKICAgICAg\nICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0UGFzc3dvcmQoKSB7CiAgICAgICAgICAgIHJldHVybiAiZVV5U3ZwMnBo\nTTJXayI7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBjbGFzcyBIdWJD\nbGllbnRDb25maWd1cmF0aW9uIGV4dGVuZHMgQ2xpZW50Q29uZmlndXJhdGlv\nbiB7CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIEhlZHdpZ1Nv\nY2tldEFkZHJlc3MgZ2V0RGVmYXVsdFNlcnZlckhlZHdpZ1NvY2tldEFkZHJl\nc3MoKSB7CiAgICAgICAgICAgIHJldHVybiBzZXJ2ZXJBZGRyZXNzZXMuZ2V0\nKDApOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBNZXRob2QgdG8gZ2V0IGEg\nU2VydmVyQ29uZmlndXJhdGlvbiBmb3IgdGhlIFB1YlN1YlNlcnZlcnMgY3Jl\nYXRlZCB1c2luZwogICAgLy8gdGhlIHNwZWNpZmllZCBwb3J0cy4gRXh0ZW5k\naW5nIGNoaWxkIGNsYXNzZXMgY2FuIG92ZXJyaWRlIHRoaXMuIFRoaXMKICAg\nIC8vIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gd2lsbCByZXR1cm4gdGhlIEh1\nYlNlcnZlckNvbmZpZ3VyYXRpb24gb2JqZWN0CiAgICAvLyBkZWZpbmVkIGFi\nb3ZlLgogICAgcHJvdGVjdGVkIFNlcnZlckNvbmZpZ3VyYXRpb24gZ2V0U2Vy\ndmVyQ29uZmlndXJhdGlvbihpbnQgc2VydmVyUG9ydCwgaW50IHNzbFNlcnZl\nclBvcnQpIHsKICAgICAgICByZXR1cm4gbmV3IEh1YlNlcnZlckNvbmZpZ3Vy\nYXRpb24oc2VydmVyUG9ydCwgc3NsU2VydmVyUG9ydCk7CiAgICB9CgogICAg\ncHJvdGVjdGVkIHZvaWQgc3RhcnRIdWJTZXJ2ZXJzKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLy8gTm93IGNyZWF0ZSB0aGUgUHViU3ViU2VydmVy\nIEh1YnMKICAgICAgICBzZXJ2ZXJzTGlzdCA9IG5ldyBMaW5rZWRMaXN0PFB1\nYlN1YlNlcnZlcj4oKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBu\ndW1TZXJ2ZXJzOyBpKyspIHsKICAgICAgICAgICAgU2VydmVyQ29uZmlndXJh\ndGlvbiBjb25mID0gZ2V0U2VydmVyQ29uZmlndXJhdGlvbihzZXJ2ZXJBZGRy\nZXNzZXMuZ2V0KGkpLmdldFBvcnQoKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2\nZXJBZGRyZXNzZXMuZ2V0KGkpLmdldFNTTFBvcnQoKSk7CiAgICAgICAgICAg\nIFB1YlN1YlNlcnZlciBzID0gbmV3IFB1YlN1YlNlcnZlcihjb25mLCBuZXcg\nQ2xpZW50Q29uZmlndXJhdGlvbigpLCBuZXcgTG9nZ2luZ0V4Y2VwdGlvbkhh\nbmRsZXIoKSk7CiAgICAgICAgICAgIHNlcnZlcnNMaXN0LmFkZChzKTsKICAg\nICAgICAgICAgcy5zdGFydCgpOwogICAgICAgIH0KICAgIH0KICAgIHByb3Rl\nY3RlZCB2b2lkIHN0b3BIdWJTZXJ2ZXJzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gU2h1dGRvd24gYWxsIG9mIHRoZSBQdWJTdWJTZXJ2ZXJz\nCiAgICAgICAgZm9yIChQdWJTdWJTZXJ2ZXIgc2VydmVyIDogc2VydmVyc0xp\nc3QpIHsKICAgICAgICAgICAgc2VydmVyLnNodXRkb3duKCk7CiAgICAgICAg\nfQogICAgICAgIHNlcnZlcnNMaXN0LmNsZWFyKCk7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBAQmVmb3JlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGxvZ2dlci5pbmZvKCJTVEFSVElO\nRyAiICsgZ2V0TmFtZSgpKTsKICAgICAgICBia3RiID0gbmV3IEJvb2tLZWVw\nZXJUZXN0QmFzZShudW1Cb29raWVzLCByZWFkRGVsYXkpOwogICAgICAgIGJr\ndGIuc2V0VXAoKTsKICAgICAgICBzdGFydEh1YlNlcnZlcnMoKTsKICAgICAg\nICBsb2dnZXIuaW5mbygiSGVkd2lnSHViIHRlc3Qgc2V0dXAgZmluaXNoZWQi\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIEBBZnRlcgogICAgcHVibGlj\nIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBs\nb2dnZXIuaW5mbygidGVhckRvd24gc3RhcnRpbmciKTsKICAgICAgICBzdG9w\nSHViU2VydmVycygpOwogICAgICAgIGJrdGIudGVhckRvd24oKTsKICAgICAg\nICBsb2dnZXIuaW5mbygiRklOSVNIRUQgIiArIGdldE5hbWUoKSk7CiAgICB9\nCgp9Cg==\n","encoding":"base64"}

