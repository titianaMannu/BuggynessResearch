{"sha":"e42c0b9074038c81b27687e1b22ce472d2b8430f","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTQyYzBiOTA3NDAzOGM4MWIyNzY4N2UxYjIyY2U0NzJkMmI4NDMwZg==","size":11300,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e42c0b9074038c81b27687e1b22ce472d2b8430f","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXI7CgppbXBvcnQgamF2YS51\ndGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmlt\ncG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5Owpp\nbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9y\nZTsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5DbGll\nbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xp\nZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5uZXR0eS5QdWJTdWJTZXJ2ZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuQm9va0tl\nZXBlclRlc3RCYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5I\nZWR3aWdTb2NrZXRBZGRyZXNzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nc2VydmVyLkxvZ2dpbmdFeGNlcHRpb25IYW5kbGVyOwoKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci50ZXN0LlBvcnRNYW5hZ2VyOwoKLyoqCiAqIFRo\naXMgaXMgYSBiYXNlIGNsYXNzIGZvciBhbnkgdGVzdHMgdGhhdCBuZWVkIGEg\nSGVkd2lnIFJlZ2lvbihzKSBzZXR1cCB3aXRoIGEKICogbnVtYmVyIG9mIEhl\nZHdpZyBodWJzIHBlciByZWdpb24sIGFuIGFzc29jaWF0ZWQgSGVkd2lnQ2xp\nZW50IHBlciByZWdpb24gYW5kCiAqIHRoZSByZXF1aXJlZCBCb29rS2VlcGVy\nIGFuZCBab29LZWVwZXIgaW5zdGFuY2VzLgogKgogKi8KcHVibGljIGFic3Ry\nYWN0IGNsYXNzIEhlZHdpZ1JlZ2lvblRlc3RCYXNlIGV4dGVuZHMgVGVzdENh\nc2UgewoKICAgIHByb3RlY3RlZCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExv\nZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKEhlZHdpZ1JlZ2lvblRlc3RCYXNlLmNs\nYXNzKTsKCiAgICAvLyBCb29rS2VlcGVyIHZhcmlhYmxlcwogICAgLy8gRGVm\nYXVsdCBudW1iZXIgb2YgYm9va2llIHNlcnZlcnMgdG8gc2V0dXAuIEV4dGVu\nZGluZyBjbGFzc2VzCiAgICAvLyBjYW4gb3ZlcnJpZGUgdGhpcy4gV2Ugc2hv\ndWxkIGJlIGFibGUgdG8gcmV1c2UgdGhlIHNhbWUgQm9va0tlZXBlcgogICAg\nLy8gZW5zZW1ibGUgYW1vbmcgYWxsIG9mIHRoZSByZWdpb25zLCBhdCBsZWFz\ndCBmb3IgdW5pdCB0ZXN0aW5nIHB1cnBvc2VzLgogICAgcHJvdGVjdGVkIGlu\ndCBudW1Cb29raWVzID0gMzsKICAgIHByb3RlY3RlZCBCb29rS2VlcGVyVGVz\ndEJhc2UgYmt0YjsKCiAgICAvLyBIZWR3aWcgUmVnaW9uIHZhcmlhYmxlcwog\nICAgLy8gRGVmYXVsdCBudW1iZXIgb2YgSGVkd2lnIFJlZ2lvbnMgdG8gc2V0\ndXAuIEV4dGVuZGluZyBjbGFzc2VzIGNhbgogICAgLy8gb3ZlcnJpZGUgdGhp\ncy4KICAgIHByb3RlY3RlZCBpbnQgbnVtUmVnaW9ucyA9IDI7CiAgICBwcm90\nZWN0ZWQgaW50IG51bVNlcnZlcnNQZXJSZWdpb24gPSAxOwoKICAgIC8vIE1h\ncCB3aXRoIGtleXMgYmVpbmcgUmVnaW9uIG5hbWVzIGFuZCB2YWx1ZXMgYmVp\nbmcgdGhlIGxpc3Qgb2YgSGVkd2lnCiAgICAvLyBIdWJzIChQdWJTdWJTZXJ2\nZXJzKSBmb3IgdGhhdCBwYXJ0aWN1bGFyIHJlZ2lvbi4KICAgIHByb3RlY3Rl\nZCBNYXA8U3RyaW5nLCBMaXN0PFB1YlN1YlNlcnZlcj4+IHJlZ2lvblNlcnZl\ncnNNYXA7CiAgICAvLyBNYXAgd2l0aCBrZXlzIGJlaW5nIFJlZ2lvbiBuYW1l\ncyBhbmQgdmFsdWVzIGJlaW5nIHRoZSBIZWR3aWcgQ2xpZW50CiAgICAvLyBp\nbnN0YW5jZS4KICAgIHByb3RlY3RlZCBNYXA8U3RyaW5nLCBIZWR3aWdDbGll\nbnQ+IHJlZ2lvbkNsaWVudHNNYXA7CgogICAgcHJvdGVjdGVkIE1hcDxTdHJp\nbmcsIEludGVnZXI+IHJlZ2lvbk5hbWVUb0luZGV4TWFwOwogICAgcHJvdGVj\ndGVkIE1hcDxJbnRlZ2VyLCBMaXN0PEhlZHdpZ1NvY2tldEFkZHJlc3M+PiBy\nZWdpb25IdWJBZGRyZXNzZXM7CgogICAgLy8gU3RyaW5nIGNvbnN0YW50IHVz\nZWQgYXMgdGhlIHByZWZpeCBmb3IgdGhlIHJlZ2lvbiBuYW1lcy4KICAgIHBy\nb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIFJFR0lPTl9QUkVGSVggPSAi\ncmVnaW9uIjsKCiAgICAvLyBEZWZhdWx0IGNoaWxkIGNsYXNzIG9mIHRoZSBT\nZXJ2ZXJDb25maWd1cmF0aW9uIHRvIGJlIHVzZWQgaGVyZS4KICAgIC8vIEV4\ndGVuZGluZyBjbGFzc2VzIGNhbiBkZWZpbmUgdGhlaXIgb3duIChwb3NzaWJs\neSBleHRlbmRpbmcgZnJvbSB0aGlzKSBhbmQKICAgIC8vIG92ZXJyaWRlIHRo\nZSBnZXRTZXJ2ZXJDb25maWd1cmF0aW9uIG1ldGhvZCBiZWxvdyB0byByZXR1\ncm4gdGhlaXIgb3duCiAgICAvLyBjb25maWd1cmF0aW9uLgogICAgcHJvdGVj\ndGVkIGNsYXNzIFJlZ2lvblNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5kcyBT\nZXJ2ZXJDb25maWd1cmF0aW9uIHsKICAgICAgICBwcml2YXRlIGZpbmFsIGlu\ndCBzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0OwogICAgICAgIHByaXZhdGUg\nZmluYWwgU3RyaW5nIHJlZ2lvbk5hbWU7CgogICAgICAgIHB1YmxpYyBSZWdp\nb25TZXJ2ZXJDb25maWd1cmF0aW9uKGludCBzZXJ2ZXJQb3J0LCBpbnQgc3Ns\nU2VydmVyUG9ydCwgU3RyaW5nIHJlZ2lvbk5hbWUpIHsKICAgICAgICAgICAg\ndGhpcy5zZXJ2ZXJQb3J0ID0gc2VydmVyUG9ydDsKICAgICAgICAgICAgdGhp\ncy5zc2xTZXJ2ZXJQb3J0ID0gc3NsU2VydmVyUG9ydDsKICAgICAgICAgICAg\ndGhpcy5yZWdpb25OYW1lID0gcmVnaW9uTmFtZTsKICAgICAgICAgICAgY29u\nZi5zZXRQcm9wZXJ0eShSRUdJT04sIHJlZ2lvbk5hbWUpOwogICAgICAgICAg\nICBzZXRSZWdpb25MaXN0KCk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0\nZWQgdm9pZCBzZXRSZWdpb25MaXN0KCkgewogICAgICAgICAgICBMaXN0PFN0\ncmluZz4gbXlSZWdpb25MaXN0ID0gbmV3IExpbmtlZExpc3Q8U3RyaW5nPigp\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bVJlZ2lvbnM7\nIGkrKykgewogICAgICAgICAgICAgICAgaW50IGN1ckRlZmF1bHRTZXJ2ZXJQ\nb3J0ID0gcmVnaW9uSHViQWRkcmVzc2VzLmdldChpKS5nZXQoMCkuZ2V0UG9y\ndCgpOwogICAgICAgICAgICAgICAgaW50IGN1ckRlZmF1bHRTU0xTZXJ2ZXJQ\nb3J0ID0gcmVnaW9uSHViQWRkcmVzc2VzLmdldChpKS5nZXQoMCkuZ2V0U1NM\nUG9ydCgpOwogICAgICAgICAgICAgICAgLy8gQWRkIHRoaXMgcmVnaW9uIGRl\nZmF1bHQgc2VydmVyIHBvcnQgaWYgaXQgaXMgZm9yIGEgcmVnaW9uCiAgICAg\nICAgICAgICAgICAvLyBvdGhlciB0aGFuIGl0cyBvd24uCiAgICAgICAgICAg\nICAgICBpZiAocmVnaW9uTmFtZVRvSW5kZXhNYXAuZ2V0KHJlZ2lvbk5hbWUp\nICE9IGkpIHsKICAgICAgICAgICAgICAgICAgICBteVJlZ2lvbkxpc3QuYWRk\nKCJsb2NhbGhvc3Q6IiArIGN1ckRlZmF1bHRTZXJ2ZXJQb3J0ICsgIjoiICsg\nY3VyRGVmYXVsdFNTTFNlcnZlclBvcnQpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CgogICAgICAgICAgICByZWdpb25MaXN0ID0gbXlSZWdp\nb25MaXN0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIGludCBnZXRTZXJ2ZXJQb3J0KCkgewogICAgICAgICAgICByZXR1\ncm4gc2VydmVyUG9ydDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBpbnQgZ2V0U1NMU2VydmVyUG9ydCgpIHsKICAgICAg\nICAgICAgcmV0dXJuIHNzbFNlcnZlclBvcnQ7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nIGdldFprSG9zdCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIGJrdGIuZ2V0WmtIb3N0UG9ydCgpOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0\ncmluZyBnZXRNeVJlZ2lvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHJlZ2lv\nbk5hbWU7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBpc1NTTEVuYWJsZWQoKSB7CiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gaXNJbnRlclJlZ2lvblNTTEVuYWJsZWQoKSB7\nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRDZXJ0TmFtZSgp\nIHsKICAgICAgICAgICAgcmV0dXJuICIvc2VydmVyLnAxMiI7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nIGdl\ndFBhc3N3b3JkKCkgewogICAgICAgICAgICByZXR1cm4gImVVeVN2cDJwaE0y\nV2siOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBNZXRob2QgdG8gZ2V0IGEg\nU2VydmVyQ29uZmlndXJhdGlvbiBmb3IgdGhlIFB1YlN1YlNlcnZlcnMgY3Jl\nYXRlZCB1c2luZwogICAgLy8gdGhlIHNwZWNpZmllZCBwb3J0cyBhbmQgcmVn\naW9uIG5hbWUuIEV4dGVuZGluZyBjaGlsZCBjbGFzc2VzIGNhbiBvdmVycmlk\nZQogICAgLy8gdGhpcy4gVGhpcyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHdp\nbGwgcmV0dXJuIHRoZQogICAgLy8gUmVnaW9uU2VydmVyQ29uZmlndXJhdGlv\nbiBvYmplY3QgZGVmaW5lZCBhYm92ZS4KICAgIHByb3RlY3RlZCBTZXJ2ZXJD\nb25maWd1cmF0aW9uIGdldFNlcnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZl\nclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0LCBTdHJpbmcgcmVnaW9uTmFtZSkg\newogICAgICAgIHJldHVybiBuZXcgUmVnaW9uU2VydmVyQ29uZmlndXJhdGlv\nbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0LCByZWdpb25OYW1lKTsKICAg\nIH0KCiAgICAvLyBEZWZhdWx0IENsaWVudENvbmZpZ3VyYXRpb24gdG8gdXNl\nLiBUaGlzIGp1c3QgcG9pbnRzIHRvIHRoZSBmaXJzdAogICAgLy8gSGVkd2ln\nIGh1YiBzZXJ2ZXIgaW4gZWFjaCByZWdpb24gYXMgdGhlICJkZWZhdWx0IHNl\ncnZlciBob3N0IiB0byBjb25uZWN0CiAgICAvLyB0by4KICAgIHByb3RlY3Rl\nZCBjbGFzcyBSZWdpb25DbGllbnRDb25maWd1cmF0aW9uIGV4dGVuZHMgQ2xp\nZW50Q29uZmlndXJhdGlvbiB7CiAgICAgICAgcHVibGljIFJlZ2lvbkNsaWVu\ndENvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2ZXJQ\nb3J0KSB7CiAgICAgICAgICAgIG15RGVmYXVsdFNlcnZlckFkZHJlc3MgPSBu\nZXcgSGVkd2lnU29ja2V0QWRkcmVzcygibG9jYWxob3N0OiIgKyBzZXJ2ZXJQ\nb3J0ICsgIjoiICsgc3NsU2VydmVyUG9ydCk7CiAgICAgICAgfQogICAgICAg\nIC8vIEJlbG93IHlvdSBjYW4gb3ZlcnJpZGUgYW55IG9mIHRoZSBkZWZhdWx0\nIENsaWVudENvbmZpZ3VyYXRpb24KICAgICAgICAvLyBwYXJhbWV0ZXJzIGlm\nIG5lZWRlZC4KICAgIH0KCiAgICAvLyBNZXRob2QgdG8gZ2V0IGEgQ2xpZW50\nQ29uZmlndXJhdGlvbiBmb3IgdGhlIEhlZHdpZ0NsaWVudHMgY3JlYXRlZC4K\nICAgIC8vIElucHV0cyBhcmUgdGhlIGRlZmF1bHQgSGVkd2lnIGh1YiBzZXJ2\nZXIncyBwb3J0cyB0byBwb2ludCB0by4KICAgIHByb3RlY3RlZCBDbGllbnRD\nb25maWd1cmF0aW9uIGdldENsaWVudENvbmZpZ3VyYXRpb24oaW50IHNlcnZl\nclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0KSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBSZWdpb25DbGllbnRDb25maWd1cmF0aW9uKHNlcnZlclBvcnQsIHNzbFNl\ncnZlclBvcnQpOwogICAgfQoKICAgIC8vIE1ldGhvZCB0byBnZXQgYSBDbGll\nbnRDb25maWd1cmF0aW9uIGZvciB0aGUgQ3Jvc3MgUmVnaW9uIEhlZHdpZyBD\nbGllbnQuCiAgICBwcm90ZWN0ZWQgQ2xpZW50Q29uZmlndXJhdGlvbiBnZXRS\nZWdpb25DbGllbnRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVybiBu\nZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpIHsKICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgIHB1YmxpYyBIZWR3aWdTb2NrZXRBZGRyZXNzIGdl\ndERlZmF1bHRTZXJ2ZXJIZWR3aWdTb2NrZXRBZGRyZXNzKCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIHJlZ2lvbkh1YkFkZHJlc3Nlcy5nZXQoMCkuZ2V0\nKDApOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbG9nZ2VyLmluZm8oIlNUQVJUSU5H\nICIgKyBnZXROYW1lKCkpOwogICAgICAgIGJrdGIgPSBuZXcgQm9va0tlZXBl\nclRlc3RCYXNlKG51bUJvb2tpZXMpOwogICAgICAgIGJrdGIuc2V0VXAoKTsK\nCiAgICAgICAgLy8gQ3JlYXRlIHRoZSBIZWR3aWcgUHViU3ViU2VydmVyIEh1\nYnMgZm9yIGFsbCBvZiB0aGUgcmVnaW9ucwogICAgICAgIHJlZ2lvblNlcnZl\ncnNNYXAgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIExpc3Q8UHViU3ViU2VydmVy\nPj4obnVtUmVnaW9ucywgMS4wZik7CiAgICAgICAgcmVnaW9uQ2xpZW50c01h\ncCA9IG5ldyBIYXNoTWFwPFN0cmluZywgSGVkd2lnQ2xpZW50PihudW1SZWdp\nb25zLCAxLjBmKTsKCiAgICAgICAgcmVnaW9uSHViQWRkcmVzc2VzID0gbmV3\nIEhhc2hNYXA8SW50ZWdlciwgTGlzdDxIZWR3aWdTb2NrZXRBZGRyZXNzPj4o\nbnVtUmVnaW9ucywgMS4wZik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBudW1SZWdpb25zOyBpKyspIHsKICAgICAgICAgICAgTGlzdDxIZWR3aWdT\nb2NrZXRBZGRyZXNzPiBhZGRyZXNzZXMgPSBuZXcgTGlua2VkTGlzdDxIZWR3\naWdTb2NrZXRBZGRyZXNzPigpOwogICAgICAgICAgICBmb3IgKGludCBqID0g\nMDsgaiA8IG51bVNlcnZlcnNQZXJSZWdpb247IGorKykgewogICAgICAgICAg\nICAgICAgSGVkd2lnU29ja2V0QWRkcmVzcyBhID0gbmV3IEhlZHdpZ1NvY2tl\ndEFkZHJlc3MoImxvY2FsaG9zdCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nIFBvcnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpLCBQb3J0TWFuYWdlci5uZXh0\nRnJlZVBvcnQoKSk7CiAgICAgICAgICAgICAgICBhZGRyZXNzZXMuYWRkKGEp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlZ2lvbkh1YkFkZHJlc3Nl\ncy5wdXQoaSwgYWRkcmVzc2VzKTsKICAgICAgICB9CiAgICAgICAgcmVnaW9u\nTmFtZVRvSW5kZXhNYXAgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIEludGVnZXI+\nKCk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtUmVnaW9uczsg\naSsrKSB7CiAgICAgICAgICAgIHN0YXJ0UmVnaW9uKGkpOwogICAgICAgIH0K\nICAgICAgICBsb2dnZXIuaW5mbygiSGVkd2lnUmVnaW9uIHRlc3Qgc2V0dXAg\nZmluaXNoZWQiKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIEBBZnRlcgog\nICAgcHVibGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBsb2dnZXIuaW5mbygidGVhckRvd24gc3RhcnRpbmciKTsKICAg\nICAgICAvLyBTdG9wIGFsbCBvZiB0aGUgSGVkd2lnQ2xpZW50cyBmb3IgYWxs\nIHJlZ2lvbnMKICAgICAgICBmb3IgKEhlZHdpZ0NsaWVudCBjbGllbnQgOiBy\nZWdpb25DbGllbnRzTWFwLnZhbHVlcygpKSB7CiAgICAgICAgICAgIGNsaWVu\ndC5jbG9zZSgpOwogICAgICAgIH0KICAgICAgICByZWdpb25DbGllbnRzTWFw\nLmNsZWFyKCk7CiAgICAgICAgLy8gU2h1dGRvd24gYWxsIG9mIHRoZSBQdWJT\ndWJTZXJ2ZXJzIGluIGFsbCByZWdpb25zCiAgICAgICAgZm9yIChMaXN0PFB1\nYlN1YlNlcnZlcj4gc2VydmVyc0xpc3QgOiByZWdpb25TZXJ2ZXJzTWFwLnZh\nbHVlcygpKSB7CiAgICAgICAgICAgIGZvciAoUHViU3ViU2VydmVyIHNlcnZl\nciA6IHNlcnZlcnNMaXN0KSB7CiAgICAgICAgICAgICAgICBzZXJ2ZXIuc2h1\ndGRvd24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBsb2dn\nZXIuaW5mbygiRmluaXNoZWQgc2h1dHRpbmcgZG93biBhbGwgb2YgdGhlIGh1\nYiBzZXJ2ZXJzISIpOwogICAgICAgIHJlZ2lvblNlcnZlcnNNYXAuY2xlYXIo\nKTsKICAgICAgICAvLyBTaHV0ZG93biB0aGUgQm9va0tlZXBlciBhbmQgWm9v\nS2VlcGVyIHN0dWZmCiAgICAgICAgYmt0Yi50ZWFyRG93bigpOwogICAgICAg\nIGxvZ2dlci5pbmZvKCJGSU5JU0hFRCAiICsgZ2V0TmFtZSgpKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzdG9wUmVnaW9uKGludCByZWdpb25JZHgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZyByZWdpb25OYW1l\nID0gUkVHSU9OX1BSRUZJWCArIHJlZ2lvbklkeDsKICAgICAgICBpZiAobG9n\nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLmRl\nYnVnKCJTdG9wIHJlZ2lvbiA6ICIgKyByZWdpb25OYW1lKTsKICAgICAgICB9\nCiAgICAgICAgSGVkd2lnQ2xpZW50IHJlZ2lvbkNsaWVudCA9IHJlZ2lvbkNs\naWVudHNNYXAucmVtb3ZlKHJlZ2lvbk5hbWUpOwogICAgICAgIGlmIChudWxs\nICE9IHJlZ2lvbkNsaWVudCkgewogICAgICAgICAgICByZWdpb25DbGllbnQu\nY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgTGlzdDxQdWJTdWJTZXJ2ZXI+\nIHNlcnZlcnNMaXN0ID0gcmVnaW9uU2VydmVyc01hcC5yZW1vdmUocmVnaW9u\nTmFtZSk7CiAgICAgICAgaWYgKG51bGwgPT0gc2VydmVyc0xpc3QpIHsKICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBmb3IgKFB1YlN1\nYlNlcnZlciBzZXJ2ZXIgOiBzZXJ2ZXJzTGlzdCkgewogICAgICAgICAgICBz\nZXJ2ZXIuc2h1dGRvd24oKTsKICAgICAgICB9CiAgICAgICAgbG9nZ2VyLmlu\nZm8oIkZpbmlzaGVkIHNodXR0aW5nIGRvd24gYWxsIG9mIHRoZSBodWIgc2Vy\ndmVycyBpbiByZWdpb24gIiArIHJlZ2lvbk5hbWUpOwogICAgfQoKICAgIHBy\nb3RlY3RlZCB2b2lkIHN0YXJ0UmVnaW9uKGludCBpKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBTdHJpbmcgcmVnaW9uTmFtZSA9IFJFR0lPTl9QUkVG\nSVggKyBpOwogICAgICAgIHJlZ2lvbk5hbWVUb0luZGV4TWFwLnB1dChyZWdp\nb25OYW1lLCBpKTsKCiAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3RhcnQgcmVnaW9u\nIDogIiArIHJlZ2lvbk5hbWUpOwogICAgICAgIH0KCiAgICAgICAgTGlzdDxQ\ndWJTdWJTZXJ2ZXI+IHNlcnZlcnNMaXN0ID0gbmV3IExpbmtlZExpc3Q8UHVi\nU3ViU2VydmVyPigpOwogICAgICAgIC8vIEZvciB0aGUgY3VycmVudCByZWdp\nb24sIGNyZWF0ZSB0aGUgbmVjZXNzYXJ5IGFtb3VudCBvZiBodWIKICAgICAg\nICAvLyBzZXJ2ZXJzLiBXZSB3aWxsIGJhc2ljYWxseSBpbmNyZW1lbnQgdGhy\nb3VnaCB0aGUgcG9ydCBudW1iZXJzCiAgICAgICAgLy8gc3RhcnRpbmcgZnJv\nbSB0aGUgaW5pdGlhbCBvbmVzIGRlZmluZWQuCiAgICAgICAgZm9yIChpbnQg\naiA9IDA7IGogPCBudW1TZXJ2ZXJzUGVyUmVnaW9uOyBqKyspIHsKICAgICAg\nICAgICAgSGVkd2lnU29ja2V0QWRkcmVzcyBhID0gcmVnaW9uSHViQWRkcmVz\nc2VzLmdldChpKS5nZXQoaik7CiAgICAgICAgICAgIFB1YlN1YlNlcnZlciBz\nID0gbmV3IFB1YlN1YlNlcnZlcigKICAgICAgICAgICAgICAgICAgICBnZXRT\nZXJ2ZXJDb25maWd1cmF0aW9uKGEuZ2V0UG9ydCgpLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5nZXRTU0xQb3J0KCks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBy\nZWdpb25OYW1lKSwKICAgICAgICAgICAgICAgICAgICBnZXRSZWdpb25DbGll\nbnRDb25maWd1cmF0aW9uKCksCiAgICAgICAgICAgICAgICAgICAgbmV3IExv\nZ2dpbmdFeGNlcHRpb25IYW5kbGVyKCkpOwogICAgICAgICAgICBzZXJ2ZXJz\nTGlzdC5hZGQocyk7CiAgICAgICAgICAgIHMuc3RhcnQoKTsKICAgICAgICB9\nCiAgICAgICAgLy8gU3RvcmUgdGhpcyBsaXN0IG9mIHNlcnZlcnMgY3JlYXRl\nZCBmb3IgdGhlIGN1cnJlbnQgcmVnaW9uCiAgICAgICAgcmVnaW9uU2VydmVy\nc01hcC5wdXQocmVnaW9uTmFtZSwgc2VydmVyc0xpc3QpOwogICAgICAgIC8v\nIENyZWF0ZSBhIEhlZHdpZyBDbGllbnQgdGhhdCBwb2ludHMgdG8gdGhlIGZp\ncnN0IEh1YiBzZXJ2ZXIKICAgICAgICAvLyBjcmVhdGVkIGluIHRoZSBsb29w\nIGFib3ZlIGZvciB0aGUgY3VycmVudCByZWdpb24uCiAgICAgICAgSGVkd2ln\nQ2xpZW50IHJlZ2lvbkNsaWVudCA9IG5ldyBIZWR3aWdDbGllbnQoCiAgICAg\nICAgICAgICAgICBnZXRDbGllbnRDb25maWd1cmF0aW9uKHJlZ2lvbkh1YkFk\nZHJlc3Nlcy5nZXQoaSkuZ2V0KDApLmdldFBvcnQoKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uSHViQWRkcmVzc2Vz\nLmdldChpKS5nZXQoMCkuZ2V0U1NMUG9ydCgpKSk7CiAgICAgICAgcmVnaW9u\nQ2xpZW50c01hcC5wdXQocmVnaW9uTmFtZSwgcmVnaW9uQ2xpZW50KTsKICAg\nIH0KfQo=\n","encoding":"base64"}

