{"sha":"e54c5f8aa0ff0b860ec74a2a6fc370aebb3bd11e","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTU0YzVmOGFhMGZmMGI4NjBlYzc0YTJhNmZjMzcwYWViYjNiZDExZQ==","size":49188,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e54c5f8aa0ff0b860ec74a2a6fc370aebb3bd11e","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXI7CgppbXBvcnQgamF2YS5u\nZXQuSW5ldEFkZHJlc3M7CmltcG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBq\nYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZExp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVu\ndC5hdG9taWMuQXRvbWljSW50ZWdlcjsKCmltcG9ydCBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmc7CgppbXBvcnQganVuaXQuZnJhbWV3b3JrLlRl\nc3RDYXNlOwoKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQgc3RhdGlj\nIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIudGVzdC5ab29LZWVwZXJVdGlsOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnRlc3QuUG9ydE1hbmFnZXI7CgppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcudXRpbC5IZWR3aWdTb2NrZXRBZGRyZXNzOwoKaW1wb3J0IG9y\nZy5hcGFjaGUuY29tbW9ucy5jb25maWd1cmF0aW9uLkNvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5Db25m\naWd1cmF0aW9uRXhjZXB0aW9uOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFRlc3Qg\nQmFja3dhcmQgQ29tcGF0YWJpbGl0eSBiZXR3ZWVuIGRpZmZlcmVudCB2ZXJz\naW9ucwogKi8KcHVibGljIGNsYXNzIFRlc3RCYWNrd2FyZENvbXBhdCBleHRl\nbmRzIFRlc3RDYXNlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBMb2dnZXIgbG9n\nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoVGVzdEJhY2t3YXJkQ29t\ncGF0LmNsYXNzKTsKCiAgICBzdGF0aWMgZmluYWwgaW50IENPTlNVTUVJTlRF\nUlZBTCA9IDU7CiAgICBzdGF0aWMgWm9vS2VlcGVyVXRpbCB6a1V0aWwgPSBu\nZXcgWm9vS2VlcGVyVXRpbCgpOwoKICAgIHN0YXRpYyBjbGFzcyBCb29rS2Vl\ncGVyQ2x1c3RlcjQwMCB7CgogICAgICAgIGludCBudW1Cb29raWVzOwogICAg\nICAgIExpc3Q8b3JnLmFwYWNoZS5od192NF8wXzAuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb24+IGJrQ29uZnM7CiAgICAgICAgTGlzdDxv\ncmcuYXBhY2hlLmh3X3Y0XzBfMC5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNl\ncnZlcj4gYmtzOwoKICAgICAgICBCb29rS2VlcGVyQ2x1c3RlcjQwMChpbnQg\nbnVtQm9va2llcykgewogICAgICAgICAgICB0aGlzLm51bUJvb2tpZXMgPSBu\ndW1Cb29raWVzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc3Rh\ncnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgemtVdGlsLnN0\nYXJ0U2VydmVyKCk7CgogICAgICAgICAgICBia3MgPSBuZXcgTGlua2VkTGlz\ndDxvcmcuYXBhY2hlLmh3X3Y0XzBfMC5ib29ra2VlcGVyLnByb3RvLkJvb2tp\nZVNlcnZlcj4oKTsKICAgICAgICAgICAgYmtDb25mcyA9IG5ldyBMaW5rZWRM\naXN0PG9yZy5hcGFjaGUuaHdfdjRfMF8wLmJvb2trZWVwZXIuY29uZi5TZXJ2\nZXJDb25maWd1cmF0aW9uPigpOwoKICAgICAgICAgICAgZm9yIChpbnQgaT0w\nOyBpPG51bUJvb2tpZXM7IGkrKykgewogICAgICAgICAgICAgICAgc3RhcnRC\nb29raWVTZXJ2ZXIoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIHZvaWQgc3RvcCgpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgICAgICBmb3IgKG9yZy5hcGFjaGUuaHdfdjRfMF8wLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2llU2VydmVyIGJzIDogYmtzKSB7CiAgICAgICAgICAgICAg\nICBicy5zaHV0ZG93bigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJr\ncy5jbGVhcigpOwoKICAgICAgICAgICAgemtVdGlsLmtpbGxTZXJ2ZXIoKTsK\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0Qm9va2ll\nU2VydmVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGludCBw\nb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQb3J0KCk7CiAgICAgICAgICAg\nIEZpbGUgdG1wRGlyID0gb3JnLmFwYWNoZS5od192NF8wXzAuaGVkd2lnLnV0\naWwuRmlsZVV0aWxzLmNyZWF0ZVRlbXBEaXJlY3RvcnkoCiAgICAgICAgICAg\nICAgICBnZXRDbGFzcygpLmdldE5hbWUoKSArIHBvcnQsICJ0ZXN0Iik7CiAg\nICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMF8wLmJvb2trZWVwZXIuY29u\nZi5TZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXdTZXJ2ZXJDb25maWd1\ncmF0aW9uKAogICAgICAgICAgICAgICAgcG9ydCwgemtVdGlsLmdldFpvb0tl\nZXBlckNvbm5lY3RTdHJpbmcoKSwgdG1wRGlyLCBuZXcgRmlsZVtdIHsgdG1w\nRGlyIH0pOwogICAgICAgICAgICBia3MuYWRkKHN0YXJ0Qm9va2llKGNvbmYp\nKTsKICAgICAgICAgICAgYmtDb25mcy5hZGQoY29uZik7CiAgICAgICAgfQoK\nICAgICAgICBwcm90ZWN0ZWQgb3JnLmFwYWNoZS5od192NF8wXzAuYm9va2tl\nZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24gbmV3U2VydmVyQ29uZmln\ndXJhdGlvbigKICAgICAgICAgICAgaW50IHBvcnQsIFN0cmluZyB6a1NlcnZl\ncnMsIEZpbGUgam91cm5hbERpciwgRmlsZVtdIGxlZGdlckRpcnMpIHsKICAg\nICAgICAgICAgb3JnLmFwYWNoZS5od192NF8wXzAuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiA9CiAgICAgICAgICAgICAgICBu\nZXcgb3JnLmFwYWNoZS5od192NF8wXzAuYm9va2tlZXBlci5jb25mLlNlcnZl\nckNvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgY29uZi5zZXRCb29raWVQ\nb3J0KHBvcnQpOwogICAgICAgICAgICBjb25mLnNldFprU2VydmVycyh6a1Nl\ncnZlcnMpOwogICAgICAgICAgICBjb25mLnNldEpvdXJuYWxEaXJOYW1lKGpv\ndXJuYWxEaXIuZ2V0UGF0aCgpKTsKICAgICAgICAgICAgU3RyaW5nW10gbGVk\nZ2VyRGlyTmFtZXMgPSBuZXcgU3RyaW5nW2xlZGdlckRpcnMubGVuZ3RoXTsK\nICAgICAgICAgICAgZm9yIChpbnQgaT0wOyBpPGxlZGdlckRpcnMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgIGxlZGdlckRpck5hbWVzW2ldID0g\nbGVkZ2VyRGlyc1tpXS5nZXRQYXRoKCk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgY29uZi5zZXRMZWRnZXJEaXJOYW1lcyhsZWRnZXJEaXJOYW1lcyk7\nCiAgICAgICAgICAgIHJldHVybiBjb25mOwogICAgICAgIH0KCiAgICAgICAg\ncHJvdGVjdGVkIG9yZy5hcGFjaGUuaHdfdjRfMF8wLmJvb2trZWVwZXIucHJv\ndG8uQm9va2llU2VydmVyIHN0YXJ0Qm9va2llKAogICAgICAgICAgICBvcmcu\nYXBhY2hlLmh3X3Y0XzBfMC5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmln\ndXJhdGlvbiBjb25mKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nb3JnLmFwYWNoZS5od192NF8wXzAuYm9va2tlZXBlci5wcm90by5Cb29raWVT\nZXJ2ZXIgc2VydmVyCiAgICAgICAgICAgICAgICA9IG5ldyBvcmcuYXBhY2hl\nLmh3X3Y0XzBfMC5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlcihjb25m\nKTsKICAgICAgICAgICAgc2VydmVyLnN0YXJ0KCk7CgogICAgICAgICAgICBp\nbnQgcG9ydCA9IGNvbmYuZ2V0Qm9va2llUG9ydCgpOwogICAgICAgICAgICB3\naGlsZSAoemtVdGlsLmdldFpvb0tlZXBlckNsaWVudCgpLmV4aXN0cygKICAg\nICAgICAgICAgICAgICAgICAiL2xlZGdlcnMvYXZhaWxhYmxlLyIgKyBJbmV0\nQWRkcmVzcy5nZXRMb2NhbEhvc3QoKS5nZXRIb3N0QWRkcmVzcygpICsgIjoi\nICsgcG9ydCwKICAgICAgICAgICAgICAgICAgICBmYWxzZSkgPT0gbnVsbCkg\newogICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDUwMCk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgcmV0dXJuIHNlcnZlcjsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBWZXJzaW9uIDQuMC4wIGNsYXNzZXMKICAg\nICAqLwogICAgc3RhdGljIGNsYXNzIFNlcnZlcjQwMCB7CiAgICAgICAgb3Jn\nLmFwYWNoZS5od192NF8wXzAuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVy\nQ29uZmlndXJhdGlvbiBjb25mOwogICAgICAgIG9yZy5hcGFjaGUuaHdfdjRf\nMF8wLmhlZHdpZy5zZXJ2ZXIubmV0dHkuUHViU3ViU2VydmVyIHNlcnZlcjsK\nCiAgICAgICAgU2VydmVyNDAwKGZpbmFsIFN0cmluZyB6a0hvc3RzLCBmaW5h\nbCBpbnQgcG9ydCwgZmluYWwgaW50IHNzbFBvcnQpIHsKICAgICAgICAgICAg\nY29uZiA9IG5ldyBvcmcuYXBhY2hlLmh3X3Y0XzBfMC5oZWR3aWcuc2VydmVy\nLmNvbW1vbi5TZXJ2ZXJDb25maWd1cmF0aW9uKCkgewogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgU3RyaW5nIGdl\ndFprSG9zdCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gemtIb3N0\nczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgIHB1YmxpYyBpbnQgZ2V0U2VydmVyUG9ydCgp\nIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9ydDsKICAgICAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAg\nICAgICAgIHB1YmxpYyBpbnQgZ2V0U1NMU2VydmVyUG9ydCgpIHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gc3NsUG9ydDsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHZvaWQgc3Rh\ncnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgc2VydmVyID0g\nbmV3IG9yZy5hcGFjaGUuaHdfdjRfMF8wLmhlZHdpZy5zZXJ2ZXIubmV0dHku\nUHViU3ViU2VydmVyKGNvbmYpOwogICAgICAgIH0KCiAgICAgICAgdm9pZCBz\ndG9wKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChudWxs\nICE9IHNlcnZlcikgewogICAgICAgICAgICAgICAgc2VydmVyLnNodXRkb3du\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgc3RhdGlj\nIGNsYXNzIENsaWVudDQwMCB7CiAgICAgICAgb3JnLmFwYWNoZS5od192NF8w\nXzAuaGVkd2lnLmNsaWVudC5jb25mLkNsaWVudENvbmZpZ3VyYXRpb24gY29u\nZjsKICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzBfMC5oZWR3aWcuY2xpZW50\nLmFwaS5DbGllbnQgY2xpZW50OwogICAgICAgIG9yZy5hcGFjaGUuaHdfdjRf\nMF8wLmhlZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hlciBwdWJsaXNoZXI7CiAg\nICAgICAgb3JnLmFwYWNoZS5od192NF8wXzAuaGVkd2lnLmNsaWVudC5hcGku\nU3Vic2NyaWJlciBzdWJzY3JpYmVyOwoKICAgICAgICBDbGllbnQ0MDAoZmlu\nYWwgU3RyaW5nIGNvbm5lY3RTdHJpbmcpIHsKICAgICAgICAgICAgY29uZiA9\nIG5ldyBvcmcuYXBhY2hlLmh3X3Y0XzBfMC5oZWR3aWcuY2xpZW50LmNvbmYu\nQ2xpZW50Q29uZmlndXJhdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgb3JnLmFw\nYWNoZS5od192NF8wXzAuaGVkd2lnLnV0aWwuSGVkd2lnU29ja2V0QWRkcmVz\ncwogICAgICAgICAgICAgICAgICAgICAgICBnZXREZWZhdWx0U2VydmVySGVk\nd2lnU29ja2V0QWRkcmVzcygpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIG5ldyBvcmcuYXBhY2hlLmh3X3Y0XzBfMC5oZWR3aWcudXRpbC5I\nZWR3aWdTb2NrZXRBZGRyZXNzKGNvbm5lY3RTdHJpbmcpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNs\naWVudCA9IG5ldyBvcmcuYXBhY2hlLmh3X3Y0XzBfMC5oZWR3aWcuY2xpZW50\nLkhlZHdpZ0NsaWVudChjb25mKTsKICAgICAgICAgICAgcHVibGlzaGVyID0g\nY2xpZW50LmdldFB1Ymxpc2hlcigpOwogICAgICAgICAgICBzdWJzY3JpYmVy\nID0gY2xpZW50LmdldFN1YnNjcmliZXIoKTsKICAgICAgICB9CgogICAgICAg\nIHZvaWQgY2xvc2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAg\naWYgKG51bGwgIT0gY2xpZW50KSB7CiAgICAgICAgICAgICAgICBjbGllbnQu\nY2xvc2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3Jn\nLmFwYWNoZS5od192NF8wXzAuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3Rv\nY29sLk1lc3NhZ2VTZXFJZCBwdWJsaXNoKAogICAgICAgICAgICBCeXRlU3Ry\naW5nIHRvcGljLCBCeXRlU3RyaW5nIGRhdGEpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzBfMC5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBtZXNzYWdlID0KICAgICAg\nICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMF8wLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlLm5ld0J1aWxkZXIoKQogICAgICAg\nICAgICAgICAgICAgIC5zZXRCb2R5KGRhdGEpLmJ1aWxkKCk7CiAgICAgICAg\nICAgIHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljLCBtZXNzYWdlKTsKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIHN0YXRp\nYyBjbGFzcyBCb29rS2VlcGVyQ2x1c3RlcjQxMCB7CgogICAgICAgIGludCBu\ndW1Cb29raWVzOwogICAgICAgIExpc3Q8b3JnLmFwYWNoZS5od192NF8xXzAu\nYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24+IGJrQ29uZnM7\nCiAgICAgICAgTGlzdDxvcmcuYXBhY2hlLmh3X3Y0XzFfMC5ib29ra2VlcGVy\nLnByb3RvLkJvb2tpZVNlcnZlcj4gYmtzOwoKICAgICAgICBCb29rS2VlcGVy\nQ2x1c3RlcjQxMChpbnQgbnVtQm9va2llcykgewogICAgICAgICAgICB0aGlz\nLm51bUJvb2tpZXMgPSBudW1Cb29raWVzOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgc3RhcnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgemtVdGlsLnN0YXJ0U2VydmVyKCk7CgogICAgICAgICAgICBia3Mg\nPSBuZXcgTGlua2VkTGlzdDxvcmcuYXBhY2hlLmh3X3Y0XzFfMC5ib29ra2Vl\ncGVyLnByb3RvLkJvb2tpZVNlcnZlcj4oKTsKICAgICAgICAgICAgYmtDb25m\ncyA9IG5ldyBMaW5rZWRMaXN0PG9yZy5hcGFjaGUuaHdfdjRfMV8wLmJvb2tr\nZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uPigpOwoKICAgICAgICAg\nICAgZm9yIChpbnQgaT0wOyBpPG51bUJvb2tpZXM7IGkrKykgewogICAgICAg\nICAgICAgICAgc3RhcnRCb29raWVTZXJ2ZXIoKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc3RvcCgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgICAgICBmb3IgKG9yZy5hcGFjaGUuaHdfdjRf\nMV8wLmJvb2trZWVwZXIucHJvdG8uQm9va2llU2VydmVyIGJzIDogYmtzKSB7\nCiAgICAgICAgICAgICAgICBicy5zaHV0ZG93bigpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGJrcy5jbGVhcigpOwoKICAgICAgICAgICAgemtVdGls\nLmtpbGxTZXJ2ZXIoKTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCB2\nb2lkIHN0YXJ0Qm9va2llU2VydmVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIGludCBwb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQb3J0\nKCk7CiAgICAgICAgICAgIEZpbGUgdG1wRGlyID0gb3JnLmFwYWNoZS5od192\nNF8xXzAuaGVkd2lnLnV0aWwuRmlsZVV0aWxzLmNyZWF0ZVRlbXBEaXJlY3Rv\ncnkoCiAgICAgICAgICAgICAgICBnZXRDbGFzcygpLmdldE5hbWUoKSArIHBv\ncnQsICJ0ZXN0Iik7CiAgICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8w\nLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBu\nZXdTZXJ2ZXJDb25maWd1cmF0aW9uKAogICAgICAgICAgICAgICAgICAgIHBv\ncnQsIHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCksIHRtcERp\nciwgbmV3IEZpbGVbXSB7IHRtcERpciB9KTsKICAgICAgICAgICAgYmtzLmFk\nZChzdGFydEJvb2tpZShjb25mKSk7CiAgICAgICAgICAgIGJrQ29uZnMuYWRk\nKGNvbmYpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIG9yZy5hcGFj\naGUuaHdfdjRfMV8wLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0\naW9uIG5ld1NlcnZlckNvbmZpZ3VyYXRpb24oCiAgICAgICAgICAgIGludCBw\nb3J0LCBTdHJpbmcgemtTZXJ2ZXJzLCBGaWxlIGpvdXJuYWxEaXIsIEZpbGVb\nXSBsZWRnZXJEaXJzKSB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRf\nMV8wLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYg\nPQogICAgICAgICAgICAgICAgbmV3IG9yZy5hcGFjaGUuaHdfdjRfMV8wLmJv\nb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAg\nICAgIGNvbmYuc2V0Qm9va2llUG9ydChwb3J0KTsKICAgICAgICAgICAgY29u\nZi5zZXRaa1NlcnZlcnMoemtTZXJ2ZXJzKTsKICAgICAgICAgICAgY29uZi5z\nZXRKb3VybmFsRGlyTmFtZShqb3VybmFsRGlyLmdldFBhdGgoKSk7CiAgICAg\nICAgICAgIFN0cmluZ1tdIGxlZGdlckRpck5hbWVzID0gbmV3IFN0cmluZ1ts\nZWRnZXJEaXJzLmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGk9MDsg\naTxsZWRnZXJEaXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBs\nZWRnZXJEaXJOYW1lc1tpXSA9IGxlZGdlckRpcnNbaV0uZ2V0UGF0aCgpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbmYuc2V0TGVkZ2VyRGlyTmFt\nZXMobGVkZ2VyRGlyTmFtZXMpOwogICAgICAgICAgICByZXR1cm4gY29uZjsK\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBvcmcuYXBhY2hlLmh3X3Y0\nXzFfMC5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlciBzdGFydEJvb2tp\nZSgKICAgICAgICAgICAgb3JnLmFwYWNoZS5od192NF8xXzAuYm9va2tlZXBl\nci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24gY29uZikgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2llU2VydmVyIHNlcnZlcgogICAgICAgICAgICAg\nICAgPSBuZXcgb3JnLmFwYWNoZS5od192NF8xXzAuYm9va2tlZXBlci5wcm90\nby5Cb29raWVTZXJ2ZXIoY29uZik7CiAgICAgICAgICAgIHNlcnZlci5zdGFy\ndCgpOwoKICAgICAgICAgICAgaW50IHBvcnQgPSBjb25mLmdldEJvb2tpZVBv\ncnQoKTsKICAgICAgICAgICAgd2hpbGUgKHprVXRpbC5nZXRab29LZWVwZXJD\nbGllbnQoKS5leGlzdHMoCiAgICAgICAgICAgICAgICAgICAgIi9sZWRnZXJz\nL2F2YWlsYWJsZS8iICsgSW5ldEFkZHJlc3MuZ2V0TG9jYWxIb3N0KCkuZ2V0\nSG9zdEFkZHJlc3MoKSArICI6IiArIHBvcnQsCiAgICAgICAgICAgICAgICAg\nICAgZmFsc2UpID09IG51bGwpIHsKICAgICAgICAgICAgICAgIFRocmVhZC5z\nbGVlcCg1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBz\nZXJ2ZXI7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVmVyc2lv\nbiA0LjEuMCBjbGFzc2VzCiAgICAgKi8KICAgIHN0YXRpYyBjbGFzcyBTZXJ2\nZXI0MTAgewogICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5z\nZXJ2ZXIuY29tbW9uLlNlcnZlckNvbmZpZ3VyYXRpb24gY29uZjsKICAgICAg\nICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcuc2VydmVyLm5ldHR5LlB1\nYlN1YlNlcnZlciBzZXJ2ZXI7CgogICAgICAgIFNlcnZlcjQxMChmaW5hbCBT\ndHJpbmcgemtIb3N0cywgZmluYWwgaW50IHBvcnQsIGZpbmFsIGludCBzc2xQ\nb3J0KSB7CiAgICAgICAgICAgIGNvbmYgPSBuZXcgb3JnLmFwYWNoZS5od192\nNF8xXzAuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlv\nbigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAg\nICAgcHVibGljIGludCBnZXRDb25zdW1lSW50ZXJ2YWwoKSB7CiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIENPTlNVTUVJTlRFUlZBTDsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgcHVibGljIFN0cmluZyBnZXRaa0hvc3QoKSB7CiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIHprSG9zdHM7CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJs\naWMgaW50IGdldFNlcnZlclBvcnQoKSB7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIHBvcnQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgaW50IGdldFNT\nTFNlcnZlclBvcnQoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNz\nbFBvcnQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAg\nICAgfQoKICAgICAgICB2b2lkIHN0YXJ0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIHNlcnZlciA9IG5ldyBvcmcuYXBhY2hlLmh3X3Y0XzFf\nMC5oZWR3aWcuc2VydmVyLm5ldHR5LlB1YlN1YlNlcnZlcihjb25mKTsKICAg\nICAgICAgICAgc2VydmVyLnN0YXJ0KCk7CiAgICAgICAgfQoKICAgICAgICB2\nb2lkIHN0b3AoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYg\nKG51bGwgIT0gc2VydmVyKSB7CiAgICAgICAgICAgICAgICBzZXJ2ZXIuc2h1\ndGRvd24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBz\ndGF0aWMgY2xhc3MgQ2xpZW50NDEwIHsKICAgICAgICBvcmcuYXBhY2hlLmh3\nX3Y0XzFfMC5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJhdGlv\nbiBjb25mOwogICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5j\nbGllbnQuYXBpLkNsaWVudCBjbGllbnQ7CiAgICAgICAgb3JnLmFwYWNoZS5o\nd192NF8xXzAuaGVkd2lnLmNsaWVudC5hcGkuUHVibGlzaGVyIHB1Ymxpc2hl\ncjsKICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcuY2xpZW50\nLmFwaS5TdWJzY3JpYmVyIHN1YnNjcmliZXI7CgogICAgICAgIGNsYXNzIElu\ndE1lc3NhZ2VIYW5kbGVyIGltcGxlbWVudHMgb3JnLmFwYWNoZS5od192NF8x\nXzAuaGVkd2lnLmNsaWVudC5hcGkuTWVzc2FnZUhhbmRsZXIgewogICAgICAg\nICAgICBCeXRlU3RyaW5nIHRvcGljOwogICAgICAgICAgICBCeXRlU3RyaW5n\nIHN1YklkOwogICAgICAgICAgICBpbnQgbmV4dDsKCiAgICAgICAgICAgIENv\ndW50RG93bkxhdGNoIGxhdGNoOwoKICAgICAgICAgICAgSW50TWVzc2FnZUhh\nbmRsZXIoQnl0ZVN0cmluZyB0LCBCeXRlU3RyaW5nIHMsIGludCBzdGFydCwg\naW50IG51bSkgewogICAgICAgICAgICAgICAgdGhpcy50b3BpYyA9IHQ7CiAg\nICAgICAgICAgICAgICB0aGlzLnN1YklkID0gczsKICAgICAgICAgICAgICAg\nIHRoaXMubmV4dCA9IHN0YXJ0OwogICAgICAgICAgICAgICAgdGhpcy5sYXRj\naCA9IG5ldyBDb3VudERvd25MYXRjaChudW0pOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\nZGVsaXZlcihCeXRlU3RyaW5nIHQsIEJ5dGVTdHJpbmcgcywKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5o\nZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBtc2csCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5od192\nNF8xXzAuaGVkd2lnLnV0aWwuQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIE9i\namVjdCBjb250ZXh0KSB7CiAgICAgICAgICAgICAgICBpZiAoIXQuZXF1YWxz\nKHRvcGljKSB8fCAhcy5lcXVhbHMoc3ViSWQpKSB7CiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgaW50IG51bSA9IEludGVnZXIucGFyc2VJbnQobXNnLmdldEJvZHkoKS50\nb1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAgICAgICBpZiAobnVtID09IG5l\neHQpIHsKICAgICAgICAgICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsK\nICAgICAgICAgICAgICAgICAgICArK25leHQ7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChj\nb250ZXh0LCBudWxsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIGJvb2xlYW4gYXdhaXQobG9uZyB0aW1lb3V0LCBUaW1lVW5pdCB1bml0\nKQogICAgICAgICAgICB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgcmV0dXJuIGxhdGNoLmF3YWl0KHRpbWVvdXQsIHVu\naXQpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBDbGllbnQ0\nMTAoZmluYWwgU3RyaW5nIGNvbm5lY3RTdHJpbmcpIHsKICAgICAgICAgICAg\nY29uZiA9IG5ldyBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcuY2xpZW50\nLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbigpIHsKICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaXNB\ndXRvU2VuZENvbnN1bWVNZXNzYWdlRW5hYmxlZCgpIHsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIGlu\ndCBnZXRDb25zdW1lZE1lc3NhZ2VzQnVmZmVyU2l6ZSgpIHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHJvdGVjdGVk\nIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy51dGlsLkhlZHdpZ1NvY2tl\ndEFkZHJlc3MKICAgICAgICAgICAgICAgICAgICBnZXREZWZhdWx0U2VydmVy\nSGVkd2lnU29ja2V0QWRkcmVzcygpIHsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy51dGlsLkhl\nZHdpZ1NvY2tldEFkZHJlc3MoY29ubmVjdFN0cmluZyk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNsaWVudCA9IG5l\ndyBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcuY2xpZW50LkhlZHdpZ0Ns\naWVudChjb25mKTsKICAgICAgICAgICAgcHVibGlzaGVyID0gY2xpZW50Lmdl\ndFB1Ymxpc2hlcigpOwogICAgICAgICAgICBzdWJzY3JpYmVyID0gY2xpZW50\nLmdldFN1YnNjcmliZXIoKTsKICAgICAgICB9CgogICAgICAgIHZvaWQgY2xv\nc2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKG51bGwg\nIT0gY2xpZW50KSB7CiAgICAgICAgICAgICAgICBjbGllbnQuY2xvc2UoKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3JnLmFwYWNoZS5o\nd192NF8xXzAuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3Nh\nZ2VTZXFJZCBwdWJsaXNoKAogICAgICAgICAgICBCeXRlU3RyaW5nIHRvcGlj\nLCBCeXRlU3RyaW5nIGRhdGEpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuTWVzc2FnZSBtZXNzYWdlID0KICAgICAgICAgICAgICAg\nIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQ\ncm90b2NvbC5NZXNzYWdlLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAg\nICAgIC5zZXRCb2R5KGRhdGEpLmJ1aWxkKCk7CiAgICAgICAgICAgIHB1Ymxp\nc2hlci5wdWJsaXNoKHRvcGljLCBtZXNzYWdlKTsKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICB2b2lkIHB1Ymxpc2hJbnRz\nKEJ5dGVTdHJpbmcgdG9waWMsIGludCBzdGFydCwgaW50IG51bSkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGZvciAoaW50IGk9MDsgaTxudW07\nIGkrKykgewogICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5od192NF8xXzAu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2UgbXNnID0K\nICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZS5uZXdCdWlsZGVy\nKCkuc2V0Qm9keShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiIiArIChzdGFy\ndCtpKSkpLmJ1aWxkKCk7CiAgICAgICAgICAgICAgICBwdWJsaXNoZXIucHVi\nbGlzaCh0b3BpYywgbXNnKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgdm9pZCBzZW5kWEV4cGVjdExhc3RZKEJ5dGVTdHJpbmcgdG9waWMs\nIEJ5dGVTdHJpbmcgc3ViaWQsIGZpbmFsIGludCB4LCBmaW5hbCBpbnQgeSkK\nICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgZm9yIChp\nbnQgaT0wOyBpPHg7IGkrKykgewogICAgICAgICAgICAgICAgcHVibGlzaGVy\nLnB1Ymxpc2godG9waWMsIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5w\ncm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlLm5ld0J1aWxkZXIoKS5z\nZXRCb2R5KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KFN0cmluZy52YWx1ZU9mKGkp\nKSkuYnVpbGQoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3Vic2Ny\naWJlci5zdWJzY3JpYmUodG9waWMsIHN1YmlkLCBvcmcuYXBhY2hlLmh3X3Y0\nXzFfMC5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJl\nUmVxdWVzdC5DcmVhdGVPckF0dGFjaC5BVFRBQ0gpOwoKICAgICAgICAgICAg\nZmluYWwgQXRvbWljSW50ZWdlciBleHBlY3RlZCA9IG5ldyBBdG9taWNJbnRl\nZ2VyKHggLSB5KTsKICAgICAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2gg\nbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgICAgIHN1\nYnNjcmliZXIuc3RhcnREZWxpdmVyeSh0b3BpYywgc3ViaWQsIG5ldyBvcmcu\nYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcuY2xpZW50LmFwaS5NZXNzYWdlSGFu\nZGxlcigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgc3luY2hyb25pemVkIHB1YmxpYyB2b2lkIGRlbGl2ZXIoQnl0ZVN0\ncmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmcu\nYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTWVzc2FnZSBtc2csCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3\naWcudXRpbC5DYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGNvbnRl\neHQpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgICAgICBpbnQgdmFsdWUgPSBJbnRlZ2VyLnZhbHVlT2YobXNnLmdl\ndEJvZHkoKS50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmICh2YWx1ZSA9PSBleHBlY3RlZC5nZXQoKSkgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQuaW5jcmVtZW50QW5kR2V0KCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkRpZCBub3QgcmVjZWl2\nZSBleHBlY3RlZCB2YWx1ZSwgZXhwZWN0ZWQge30sIGdvdCB7fSIsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQu\nZ2V0KCksIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4\ncGVjdGVkLnNldCgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxh\ndGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBlY3RlZC5nZXQoKSA9PSB4\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRjaC5jb3VudERv\nd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjb250ZXh0\nLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3Io\nIlJlY2VpdmVkIGJhZCBtZXNzYWdlIiwgZSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAg\nICAgIGFzc2VydFRydWUoIlRpbWVkIG91dCB3YWl0aW5nIGZvciBtZXNzYWdl\ncyBZIGlzICIgKyB5ICsgIiBleHBlY3RlZCBpcyBjdXJyZW50bHkgIgogICAg\nICAgICAgICAgICAgICAgICAgICsgZXhwZWN0ZWQuZ2V0KCksIGxhdGNoLmF3\nYWl0KDEwLCBUaW1lVW5pdC5TRUNPTkRTKSk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygiU2hvdWxkIGJlIGV4cGVjdGVkIG1lc3NhZ2Ugd2l0aCAiICsg\neCwgeCwgZXhwZWN0ZWQuZ2V0KCkpOwogICAgICAgICAgICBzdWJzY3JpYmVy\nLnN0b3BEZWxpdmVyeSh0b3BpYywgc3ViaWQpOwogICAgICAgICAgICBzdWJz\nY3JpYmVyLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZCk7CiAgICAg\nICAgICAgIFRocmVhZC5zbGVlcCgxMDAwKTsgLy8gZ2l2ZSBzZXJ2ZXIgdGlt\nZSB0byBydW4gZGlzY29ubmVjdCBsb2dpYyAoQk9PS0tFRVBFUi01MTMpCiAg\nICAgICAgfQoKICAgICAgICB2b2lkIHN1YnNjcmliZShCeXRlU3RyaW5nIHRv\ncGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5w\ncm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zIG9w\ndGlvbnMgPQogICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5od192NF8xXzAu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbk9w\ndGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgICAgICAuc2V0Q3JlYXRl\nT3JBdHRhY2gob3JnLmFwYWNoZS5od192NF8xXzAuaGVkd2lnLnByb3RvY29s\nLlB1YlN1YlByb3RvY29sLlN1YnNjcmliZVJlcXVlc3QuQ3JlYXRlT3JBdHRh\nY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICAgICAgc3Vi\nc2NyaWJlKHRvcGljLCBzdWJzY3JpYmVySWQsIG9wdGlvbnMpOwogICAgICAg\nIH0KCiAgICAgICAgdm9pZCBzdWJzY3JpYmUoQnl0ZVN0cmluZyB0b3BpYywg\nQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAg\nICAgb3JnLmFwYWNoZS5od192NF8xXzAuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLlN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0aW9ucykgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJl\nKHRvcGljLCBzdWJzY3JpYmVySWQsIG9wdGlvbnMpOwogICAgICAgIH0KCiAg\nICAgICAgdm9pZCBjbG9zZVN1YnNjcmlwdGlvbihCeXRlU3RyaW5nIHRvcGlj\nLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIHN1YnNjcmliZXIuY2xvc2VTdWJzY3JpcHRpb24odG9w\naWMsIHN1YnNjcmliZXJJZCk7CiAgICAgICAgICAgIFRocmVhZC5zbGVlcCgx\nMDAwKTsgLy8gZ2l2ZSBzZXJ2ZXIgdGltZSB0byBydW4gZGlzY29ubmVjdCBs\nb2dpYyAoQk9PS0tFRVBFUi01MTMpCiAgICAgICAgfQoKICAgICAgICB2b2lk\nIHJlY2VpdmVJbnRzKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vi\nc2NyaWJlcklkLCBpbnQgc3RhcnQsIGludCBudW0pIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgICAgICBJbnRNZXNzYWdlSGFuZGxlciBtc2dIYW5kbGVy\nID0gbmV3IEludE1lc3NhZ2VIYW5kbGVyKHRvcGljLCBzdWJzY3JpYmVySWQs\nIHN0YXJ0LCBudW0pOwogICAgICAgICAgICBzdWJzY3JpYmVyLnN0YXJ0RGVs\naXZlcnkodG9waWMsIHN1YnNjcmliZXJJZCwgbXNnSGFuZGxlcik7CiAgICAg\nICAgICAgIG1zZ0hhbmRsZXIuYXdhaXQobnVtLCBUaW1lVW5pdC5TRUNPTkRT\nKTsKICAgICAgICAgICAgc3Vic2NyaWJlci5zdG9wRGVsaXZlcnkodG9waWMs\nIHN1YnNjcmliZXJJZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQ3VycmVudCBWZXJzaW9uCiAgICAgKi8KICAgIHN0YXRpYyBjbGFzcyBC\nb29rS2VlcGVyQ2x1c3RlckN1cnJlbnQgewoKICAgICAgICBpbnQgbnVtQm9v\na2llczsKICAgICAgICBMaXN0PG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb24+IGJrQ29uZnM7CiAgICAgICAgTGlzdDxv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2llU2VydmVyPiBia3M7\nCgoKICAgICAgICBCb29rS2VlcGVyQ2x1c3RlckN1cnJlbnQoaW50IG51bUJv\nb2tpZXMpIHsKICAgICAgICAgICAgdGhpcy5udW1Cb29raWVzID0gbnVtQm9v\na2llczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHN0YXJ0KCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHprVXRpbC5zdGFydFNl\ncnZlcigpOwoKICAgICAgICAgICAgYmtzID0gbmV3IExpbmtlZExpc3Q8b3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlcj4oKTsKICAg\nICAgICAgICAgYmtDb25mcyA9IG5ldyBMaW5rZWRMaXN0PG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24+KCk7CgogICAg\nICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtQm9va2llczsgaSsrKSB7CiAg\nICAgICAgICAgICAgICBzdGFydEJvb2tpZVNlcnZlcigpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzdG9wKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGZvciAob3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlciBicyA6IGJrcykgewogICAg\nICAgICAgICAgICAgYnMuc2h1dGRvd24oKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBia3MuY2xlYXIoKTsKCiAgICAgICAgICAgIHprVXRpbC5raWxs\nU2VydmVyKCk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgdm9pZCBz\ndGFydEJvb2tpZVNlcnZlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBpbnQgcG9ydCA9IFBvcnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpOwog\nICAgICAgICAgICBGaWxlIHRtcERpciA9IG9yZy5hcGFjaGUuaGVkd2lnLnV0\naWwuRmlsZVV0aWxzLmNyZWF0ZVRlbXBEaXJlY3RvcnkoCiAgICAgICAgICAg\nICAgICBnZXRDbGFzcygpLmdldE5hbWUoKSArIHBvcnQsICJ0ZXN0Iik7CiAg\nICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNv\nbmZpZ3VyYXRpb24gY29uZiA9IG5ld1NlcnZlckNvbmZpZ3VyYXRpb24oCiAg\nICAgICAgICAgICAgICBwb3J0LCB6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVj\ndFN0cmluZygpLCB0bXBEaXIsIG5ldyBGaWxlW10geyB0bXBEaXIgfSk7CiAg\nICAgICAgICAgIGJrcy5hZGQoc3RhcnRCb29raWUoY29uZikpOwogICAgICAg\nICAgICBia0NvbmZzLmFkZChjb25mKTsKICAgICAgICB9CgogICAgICAgIHBy\nb3RlY3RlZCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25m\naWd1cmF0aW9uIG5ld1NlcnZlckNvbmZpZ3VyYXRpb24oCiAgICAgICAgICAg\nIGludCBwb3J0LCBTdHJpbmcgemtTZXJ2ZXJzLCBGaWxlIGpvdXJuYWxEaXIs\nIEZpbGVbXSBsZWRnZXJEaXJzKSB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiA9CiAg\nICAgICAgICAgICAgICBuZXcgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYu\nU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBjb25mLnNldEJv\nb2tpZVBvcnQocG9ydCk7CiAgICAgICAgICAgIGNvbmYuc2V0WmtTZXJ2ZXJz\nKHprU2VydmVycyk7CiAgICAgICAgICAgIGNvbmYuc2V0Sm91cm5hbERpck5h\nbWUoam91cm5hbERpci5nZXRQYXRoKCkpOwogICAgICAgICAgICBTdHJpbmdb\nXSBsZWRnZXJEaXJOYW1lcyA9IG5ldyBTdHJpbmdbbGVkZ2VyRGlycy5sZW5n\ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8bGVkZ2VyRGlycy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbGVkZ2VyRGlyTmFtZXNb\naV0gPSBsZWRnZXJEaXJzW2ldLmdldFBhdGgoKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBjb25mLnNldExlZGdlckRpck5hbWVzKGxlZGdlckRpck5h\nbWVzKTsKICAgICAgICAgICAgcmV0dXJuIGNvbmY7CiAgICAgICAgfQoKICAg\nICAgICBwcm90ZWN0ZWQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2tpZVNlcnZlciBzdGFydEJvb2tpZSgKICAgICAgICAgICAgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbiBjb25mKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlciBzZXJ2ZXIKICAgICAgICAgICAg\nICAgID0gbmV3IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29raWVT\nZXJ2ZXIoY29uZik7CiAgICAgICAgICAgIHNlcnZlci5zdGFydCgpOwoKICAg\nICAgICAgICAgaW50IHBvcnQgPSBjb25mLmdldEJvb2tpZVBvcnQoKTsKICAg\nICAgICAgICAgd2hpbGUgKHprVXRpbC5nZXRab29LZWVwZXJDbGllbnQoKS5l\neGlzdHMoCiAgICAgICAgICAgICAgICAgICAgIi9sZWRnZXJzL2F2YWlsYWJs\nZS8iICsgSW5ldEFkZHJlc3MuZ2V0TG9jYWxIb3N0KCkuZ2V0SG9zdEFkZHJl\nc3MoKSArICI6IiArIHBvcnQsCiAgICAgICAgICAgICAgICAgICAgZmFsc2Up\nID09IG51bGwpIHsKICAgICAgICAgICAgICAgIFRocmVhZC5zbGVlcCg1MDAp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzZXJ2ZXI7CiAg\nICAgICAgfQogICAgfQoKICAgIHN0YXRpYyBjbGFzcyBTZXJ2ZXJDdXJyZW50\nIHsKICAgICAgICBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9uLlNl\ncnZlckNvbmZpZ3VyYXRpb24gY29uZjsKICAgICAgICBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIubmV0dHkuUHViU3ViU2VydmVyIHNlcnZlcjsKCiAgICAg\nICAgU2VydmVyQ3VycmVudChmaW5hbCBTdHJpbmcgemtIb3N0cywgZmluYWwg\naW50IHBvcnQsIGZpbmFsIGludCBzc2xQb3J0KSB7CiAgICAgICAgICAgIGNv\nbmYgPSBuZXcgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1vbi5TZXJ2\nZXJDb25maWd1cmF0aW9uKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgICAgICBwdWJsaWMgaW50IGdldENvbnN1bWVJbnRlcnZh\nbCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ09OU1VNRUlOVEVS\nVkFMOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIFN0cmluZyBnZXRaa0hvc3Qo\nKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHprSG9zdHM7CiAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgICAgICAgICBwdWJsaWMgaW50IGdldFNlcnZlclBvcnQoKSB7CiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHBvcnQ7CiAgICAgICAgICAgICAgICB9\nCgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBw\ndWJsaWMgaW50IGdldFNTTFNlcnZlclBvcnQoKSB7CiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIHNzbFBvcnQ7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICB2b2lkIHN0YXJ0KCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHNlcnZlciA9IG5ldyBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubmV0dHkuUHViU3ViU2VydmVyKGNvbmYp\nOwogICAgICAgICAgICBzZXJ2ZXIuc3RhcnQoKTsKICAgICAgICB9CgogICAg\nICAgIHZvaWQgc3RvcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAobnVsbCAhPSBzZXJ2ZXIpIHsKICAgICAgICAgICAgICAgIHNlcnZl\nci5zaHV0ZG93bigpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoK\nICAgIHN0YXRpYyBjbGFzcyBDbGllbnRDdXJyZW50IHsKICAgICAgICBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5DbGllbnRDb25maWd1cmF0aW9u\nIGNvbmY7CiAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5D\nbGllbnQgY2xpZW50OwogICAgICAgIG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVu\ndC5hcGkuUHVibGlzaGVyIHB1Ymxpc2hlcjsKICAgICAgICBvcmcuYXBhY2hl\nLmhlZHdpZy5jbGllbnQuYXBpLlN1YnNjcmliZXIgc3Vic2NyaWJlcjsKCiAg\nICAgICAgY2xhc3MgSW50TWVzc2FnZUhhbmRsZXIgaW1wbGVtZW50cyBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyIHsKICAg\nICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYzsKICAgICAgICAgICAgQnl0ZVN0\ncmluZyBzdWJJZDsKICAgICAgICAgICAgaW50IG5leHQ7CgogICAgICAgICAg\nICBDb3VudERvd25MYXRjaCBsYXRjaDsKCiAgICAgICAgICAgIEludE1lc3Nh\nZ2VIYW5kbGVyKEJ5dGVTdHJpbmcgdCwgQnl0ZVN0cmluZyBzLCBpbnQgc3Rh\ncnQsIGludCBudW0pIHsKICAgICAgICAgICAgICAgIHRoaXMudG9waWMgPSB0\nOwogICAgICAgICAgICAgICAgdGhpcy5zdWJJZCA9IHM7CiAgICAgICAgICAg\nICAgICB0aGlzLm5leHQgPSBzdGFydDsKICAgICAgICAgICAgICAgIHRoaXMu\nbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2gobnVtKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIGRlbGl2ZXIoQnl0ZVN0cmluZyB0LCBCeXRlU3RyaW5nIHMsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBtc2csCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcudXRp\nbC5DYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGNvbnRleHQpIHsK\nICAgICAgICAgICAgICAgIGlmICghdC5lcXVhbHModG9waWMpIHx8ICFzLmVx\ndWFscyhzdWJJZCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpbnQgbnVtID0gSW50\nZWdlci5wYXJzZUludChtc2cuZ2V0Qm9keSgpLnRvU3RyaW5nVXRmOCgpKTsK\nICAgICAgICAgICAgICAgIGlmIChudW0gPT0gbmV4dCkgewogICAgICAgICAg\nICAgICAgICAgIGxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAg\nICAgICsrbmV4dDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGNvbnRleHQsIG51bGwpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBhd2Fp\ndChsb25nIHRpbWVvdXQsIFRpbWVVbml0IHVuaXQpCiAgICAgICAgICAgIHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbGF0Y2guYXdhaXQodGltZW91dCwgdW5pdCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIENsaWVudEN1cnJlbnQoZmluYWwgU3Ry\naW5nIGNvbm5lY3RTdHJpbmcpIHsKICAgICAgICAgICAgdGhpcyh0cnVlLCBj\nb25uZWN0U3RyaW5nKTsKICAgICAgICB9CgogICAgICAgIENsaWVudEN1cnJl\nbnQoZmluYWwgYm9vbGVhbiBhdXRvQ29uc3VtZUVuYWJsZWQsIGZpbmFsIFN0\ncmluZyBjb25uZWN0U3RyaW5nKSB7CiAgICAgICAgICAgIGNvbmYgPSBuZXcg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJh\ndGlvbigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgcHVibGljIGJvb2xlYW4gaXNBdXRvU2VuZENvbnN1bWVNZXNzYWdl\nRW5hYmxlZCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXV0b0Nv\nbnN1bWVFbmFibGVkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgaW50IGdldENv\nbnN1bWVkTWVzc2FnZXNCdWZmZXJTaXplKCkgewogICAgICAgICAgICAgICAg\nICAgIHJldHVybiAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgSGVkd2ln\nU29ja2V0QWRkcmVzcyBnZXREZWZhdWx0U2VydmVySGVkd2lnU29ja2V0QWRk\ncmVzcygpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEhlZHdp\nZ1NvY2tldEFkZHJlc3MoY29ubmVjdFN0cmluZyk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNsaWVudCA9IG5ldyBv\ncmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuSGVkd2lnQ2xpZW50KGNvbmYpOwog\nICAgICAgICAgICBwdWJsaXNoZXIgPSBjbGllbnQuZ2V0UHVibGlzaGVyKCk7\nCiAgICAgICAgICAgIHN1YnNjcmliZXIgPSBjbGllbnQuZ2V0U3Vic2NyaWJl\ncigpOwogICAgICAgIH0KCiAgICAgICAgdm9pZCBjbG9zZSgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgICAgICBpZiAobnVsbCAhPSBjbGllbnQpIHsK\nICAgICAgICAgICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQgcHVibGlzaCgKICAgICAg\nICAgICAgQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBkYXRhKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBtZXNzYWdlID0KICAg\nICAgICAgICAgICAgIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLk1lc3NhZ2UubmV3QnVpbGRlcigpCiAgICAgICAgICAgICAg\nICAgICAgLnNldEJvZHkoZGF0YSkuYnVpbGQoKTsKICAgICAgICAgICAgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuUHVibGlz\naFJlc3BvbnNlIHJlc3AgPQogICAgICAgICAgICAgICAgcHVibGlzaGVyLnB1\nYmxpc2godG9waWMsIG1lc3NhZ2UpOwogICAgICAgICAgICBpZiAobnVsbCA9\nPSByZXNwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzcC5nZXRQdWJsaXNoZWRN\nc2dJZCgpOwogICAgICAgIH0KCiAgICAgICAgdm9pZCBwdWJsaXNoSW50cyhC\neXRlU3RyaW5nIHRvcGljLCBpbnQgc3RhcnQsIGludCBudW0pIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtOyBp\nKyspIHsKICAgICAgICAgICAgICAgIG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2UgbXNnID0KICAgICAgICAgICAg\nICAgICAgICBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90\nb2NvbC5NZXNzYWdlLm5ld0J1aWxkZXIoKS5zZXRCb2R5KEJ5dGVTdHJpbmcu\nY29weUZyb21VdGY4KCIiICsgKHN0YXJ0K2kpKSkuYnVpbGQoKTsKICAgICAg\nICAgICAgICAgIHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljLCBtc2cpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2b2lkIHNlbmRYRXhwZWN0\nTGFzdFkoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJpZCwgZmlu\nYWwgaW50IHgsIGZpbmFsIGludCB5KQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8eDsgaSsrKSB7CiAg\nICAgICAgICAgICAgICBwdWJsaXNoZXIucHVibGlzaCh0b3BpYywgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZS5u\nZXdCdWlsZGVyKCkuc2V0Qm9keSgKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOChTdHJp\nbmcudmFsdWVPZihpKSkpLmJ1aWxkKCkpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZCwgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2Ny\naWJlUmVxdWVzdC5DcmVhdGVPckF0dGFjaC5BVFRBQ0gpOwoKICAgICAgICAg\nICAgZmluYWwgQXRvbWljSW50ZWdlciBleHBlY3RlZCA9IG5ldyBBdG9taWNJ\nbnRlZ2VyKHggLSB5KTsKICAgICAgICAgICAgZmluYWwgQ291bnREb3duTGF0\nY2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgICAg\nIHN1YnNjcmliZXIuc3RhcnREZWxpdmVyeSh0b3BpYywgc3ViaWQsIG5ldyBv\ncmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyKCkg\newogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBz\neW5jaHJvbml6ZWQgcHVibGljIHZvaWQgZGVsaXZlcihCeXRlU3RyaW5nIHRv\ncGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZy5hcGFjaGUu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2UgbXNnLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazxWb2lkPiBjYWxs\nYmFjaywgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgdmFsdWUgPSBJbnRl\nZ2VyLnZhbHVlT2YobXNnLmdldEJvZHkoKS50b1N0cmluZ1V0ZjgoKSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBleHBlY3RlZC5n\nZXQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQu\naW5jcmVtZW50QW5kR2V0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJy\nb3IoIkRpZCBub3QgcmVjZWl2ZSBleHBlY3RlZCB2YWx1ZSwgZXhwZWN0ZWQg\ne30sIGdvdCB7fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZXhwZWN0ZWQuZ2V0KCksIHZhbHVlKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGV4cGVjdGVkLnNldCgwKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChl\neHBlY3RlZC5nZXQoKSA9PSB4KSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBsYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GaW5pc2hlZChjb250ZXh0LCBudWxsKTsKICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIlJlY2VpdmVkIGJhZCBtZXNzYWdlIiwgZSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSk7CiAgICAgICAgICAgIGFzc2VydFRydWUoIlRpbWVkIG91dCB3\nYWl0aW5nIGZvciBtZXNzYWdlcyBZIGlzICIgKyB5ICsgIiBleHBlY3RlZCBp\ncyBjdXJyZW50bHkgIgogICAgICAgICAgICAgICAgICAgICAgICsgZXhwZWN0\nZWQuZ2V0KCksIGxhdGNoLmF3YWl0KDEwLCBUaW1lVW5pdC5TRUNPTkRTKSk7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiU2hvdWxkIGJlIGV4cGVjdGVk\nIG1lc3NhZ2Ugd2l0aCAiICsgeCwgeCwgZXhwZWN0ZWQuZ2V0KCkpOwogICAg\nICAgICAgICBzdWJzY3JpYmVyLnN0b3BEZWxpdmVyeSh0b3BpYywgc3ViaWQp\nOwogICAgICAgICAgICBzdWJzY3JpYmVyLmNsb3NlU3Vic2NyaXB0aW9uKHRv\ncGljLCBzdWJpZCk7CiAgICAgICAgfQoKICAgICAgICB2b2lkIHJlY2VpdmVO\ndW1Nb2RNKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIEJ5dGVTdHJp\nbmcgc3ViaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBp\nbnQgc3RhcnQsIGZpbmFsIGludCBudW0sIGZpbmFsIGludCBNKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcuZmls\ndGVyLlNlcnZlck1lc3NhZ2VGaWx0ZXIgZmlsdGVyID0KICAgICAgICAgICAg\nICAgIG5ldyBvcmcuYXBhY2hlLmhlZHdpZy5maWx0ZXIuU2VydmVyTWVzc2Fn\nZUZpbHRlcigpIHsKCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmhlZHdpZy5maWx0ZXIuU2Vy\ndmVyTWVzc2FnZUZpbHRlcgogICAgICAgICAgICAgICAgICAgIGluaXRpYWxp\nemUoQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgICAgICAgICAgICAg\nLy8gZG8gbm90aGluZwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlz\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgdW5pbml0aWFsaXplKCkg\newogICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmc7CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICBwdWJsaWMgb3JnLmFwYWNoZS5oZWR3aWcuZmlsdGVyLk1lc3Nh\nZ2VGaWx0ZXJCYXNlCiAgICAgICAgICAgICAgICAgICAgc2V0U3Vic2NyaXB0\naW9uUHJlZmVyZW5jZXMoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBz\ndWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5o\nZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uUHJl\nZmVyZW5jZXMgcHJlZmVyZW5jZXMpIHsKICAgICAgICAgICAgICAgICAgICAv\nLyBkbyBub3RoaW5nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlz\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gdGVzdE1lc3NhZ2Uo\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVz\nc2FnZSBtc2cpIHsKICAgICAgICAgICAgICAgICAgICBpbnQgdmFsdWUgPSBJ\nbnRlZ2VyLnZhbHVlT2YobXNnLmdldEJvZHkoKS50b1N0cmluZ1V0ZjgoKSk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDAgPT0gdmFsdWUgJSBNOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBm\naWx0ZXIuaW5pdGlhbGl6ZShjb25mLmdldENvbmYoKSk7CgogICAgICAgICAg\nICBzdWJzY3JpYmVyLnN1YnNjcmliZSh0b3BpYywgc3ViaWQsIG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmliZVJl\ncXVlc3QuQ3JlYXRlT3JBdHRhY2guQVRUQUNIKTsKICAgICAgICAgICAgZmlu\nYWwgaW50IGJhc2UgPSBzdGFydCArIE0gLSBzdGFydCAlIE07CiAgICAgICAg\nICAgIGZpbmFsIEF0b21pY0ludGVnZXIgZXhwZWN0ZWQgPSBuZXcgQXRvbWlj\nSW50ZWdlcihiYXNlKTsKICAgICAgICAgICAgZmluYWwgQ291bnREb3duTGF0\nY2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgICAg\nIHN1YnNjcmliZXIuc3RhcnREZWxpdmVyeVdpdGhGaWx0ZXIodG9waWMsIHN1\nYmlkLCBuZXcgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5NZXNzYWdl\nSGFuZGxlcigpIHsKICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCBwdWJs\naWMgdm9pZCBkZWxpdmVyKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcg\nc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wu\nUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBtc2csCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmhl\nZHdpZy51dGlsLkNhbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLCBPYmplY3QgY29u\ndGV4dCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGludCB2YWx1ZSA9IEludGVnZXIudmFsdWVPZihtc2cu\nZ2V0Qm9keSgpLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gZHVwbGljYXRlZCBtZXNzYWdlcyByZWNlaXZlZCwgaWdub3Jl\nIHRoZW0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gc3Rh\ncnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9\nPSBleHBlY3RlZC5nZXQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGV4cGVjdGVkLmFkZEFuZEdldChNKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbG9nZ2VyLmVycm9yKCJEaWQgbm90IHJlY2VpdmUgZXhwZWN0\nZWQgdmFsdWUsIGV4cGVjdGVkIHt9LCBnb3Qge30iLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZC5nZXQo\nKSwgdmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4\ncGVjdGVkLnNldCgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBsYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBlY3Rl\nZC5nZXQoKSA9PSAoYmFzZSArIG51bSAqIE0pKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9u\nRmluaXNoZWQoY29udGV4dCwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgbG9nZ2VyLmVycm9yKCJSZWNlaXZlZCBiYWQgbWVzc2FnZSIsIGUpOwog\nICAgICAgICAgICAgICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0sIChvcmcuYXBhY2hlLmhlZHdpZy5maWx0ZXIuQ2xpZW50TWVzc2Fn\nZUZpbHRlcikgZmlsdGVyKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiVGlt\nZWQgb3V0IHdhaXRpbmcgZm9yIG1lc3NhZ2VzIG1vZCAiICsgTSArICIgZXhw\nZWN0ZWQgaXMgIiArIGV4cGVjdGVkLmdldCgpLAogICAgICAgICAgICAgICAg\nICAgICAgIGxhdGNoLmF3YWl0KDEwLCBUaW1lVW5pdC5TRUNPTkRTKSk7CiAg\nICAgICAgICAgIGFzc2VydEVxdWFscygiU2hvdWxkIGJlIGV4cGVjdGVkIG1l\nc3NhZ2Ugd2l0aCAiICsgKGJhc2UgKyBudW0gKiBNKSwgKGJhc2UgKyBudW0q\nTSksIGV4cGVjdGVkLmdldCgpKTsKICAgICAgICAgICAgc3Vic2NyaWJlci5z\ndG9wRGVsaXZlcnkodG9waWMsIHN1YmlkKTsKICAgICAgICAgICAgZmlsdGVy\nLnVuaW5pdGlhbGl6ZSgpOwogICAgICAgICAgICBzdWJzY3JpYmVyLmNsb3Nl\nU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZCk7CiAgICAgICAgfQoKICAgICAg\nICB2b2lkIHN1YnNjcmliZShCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5n\nIHN1YnNjcmliZXJJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1\nYnNjcmlwdGlvbk9wdGlvbnMgb3B0aW9ucyA9CiAgICAgICAgICAgICAgICBv\ncmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJz\nY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAg\nLnNldENyZWF0ZU9yQXR0YWNoKG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29s\nLlB1YlN1YlByb3RvY29sLlN1YnNjcmliZVJlcXVlc3QuQ3JlYXRlT3JBdHRh\nY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICAgICAgc3Vi\nc2NyaWJlKHRvcGljLCBzdWJzY3JpYmVySWQsIG9wdGlvbnMpOwogICAgICAg\nIH0KCiAgICAgICAgdm9pZCBzdWJzY3JpYmUoQnl0ZVN0cmluZyB0b3BpYywg\nQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAg\nICAgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nU3Vic2NyaXB0aW9uT3B0aW9ucyBvcHRpb25zKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgc3Vic2NyaWJlci5zdWJzY3JpYmUodG9waWMsIHN1\nYnNjcmliZXJJZCwgb3B0aW9ucyk7CiAgICAgICAgfQoKICAgICAgICB2b2lk\nIGNsb3NlU3Vic2NyaXB0aW9uKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJp\nbmcgc3Vic2NyaWJlcklkKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgc3Vic2NyaWJlci5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3Vic2Ny\naWJlcklkKTsKICAgICAgICB9CgogICAgICAgIHZvaWQgcmVjZWl2ZUludHMo\nQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsIGlu\ndCBzdGFydCwgaW50IG51bSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIEludE1lc3NhZ2VIYW5kbGVyIG1zZ0hhbmRsZXIgPSBuZXcgSW50TWVz\nc2FnZUhhbmRsZXIodG9waWMsIHN1YnNjcmliZXJJZCwgc3RhcnQsIG51bSk7\nCiAgICAgICAgICAgIHN1YnNjcmliZXIuc3RhcnREZWxpdmVyeSh0b3BpYywg\nc3Vic2NyaWJlcklkLCBtc2dIYW5kbGVyKTsKICAgICAgICAgICAgbXNnSGFu\nZGxlci5hd2FpdChudW0sIFRpbWVVbml0LlNFQ09ORFMpOwogICAgICAgICAg\nICBzdWJzY3JpYmVyLnN0b3BEZWxpdmVyeSh0b3BpYywgc3Vic2NyaWJlcklk\nKTsKICAgICAgICB9CgogICAgICAgIC8vIHRocm90dGxlIGRvZXNuJ3Qgd29y\nayB0YWxraW5nIHdpdGggNDEgc2VydmVyCiAgICAgICAgdm9pZCB0aHJvdHRs\nZVg0MShCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YmlkLCBmaW5h\nbCBpbnQgWCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nU3Vic2NyaXB0aW9uT3B0aW9ucyBvcHRpb25zID0KICAgICAgICAgICAgICAg\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1\nYnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgICAg\nICAuc2V0Q3JlYXRlT3JBdHRhY2gob3JnLmFwYWNoZS5oZWR3aWcucHJvdG9j\nb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVhdGVPckF0\ndGFjaC5DUkVBVEVfT1JfQVRUQUNIKQogICAgICAgICAgICAgICAgLnNldE1l\nc3NhZ2VXaW5kb3dTaXplKFgpIC5idWlsZCgpOwogICAgICAgICAgICBzdWJz\nY3JpYmUodG9waWMsIHN1YmlkLCBvcHRpb25zKTsKICAgICAgICAgICAgY2xv\nc2VTdWJzY3JpcHRpb24odG9waWMsIHN1YmlkKTsKICAgICAgICAgICAgcHVi\nbGlzaEludHModG9waWMsIDEsIDMqWCk7CiAgICAgICAgICAgIHN1YnNjcmli\nZSh0b3BpYywgc3ViaWQpOwoKICAgICAgICAgICAgZmluYWwgQXRvbWljSW50\nZWdlciBleHBlY3RlZCA9IG5ldyBBdG9taWNJbnRlZ2VyKDEpOwogICAgICAg\nICAgICBmaW5hbCBDb3VudERvd25MYXRjaCB0aHJvdHRsZUxhdGNoID0gbmV3\nIENvdW50RG93bkxhdGNoKDEpOwogICAgICAgICAgICBmaW5hbCBDb3VudERv\nd25MYXRjaCBub25UaHJvdHRsZUxhdGNoID0gbmV3IENvdW50RG93bkxhdGNo\nKDEpOwogICAgICAgICAgICBzdWJzY3JpYmVyLnN0YXJ0RGVsaXZlcnkodG9w\naWMsIHN1YmlkLCBuZXcgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5N\nZXNzYWdlSGFuZGxlcigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIGRlbGl2\nZXIoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbC5NZXNzYWdlIG1zZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2Fs\nbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIE9iamVjdCBjb250ZXh0KSB7CiAgICAg\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAg\naW50IHZhbHVlID0gSW50ZWdlci52YWx1ZU9mKG1zZy5nZXRCb2R5KCkudG9T\ndHJpbmdVdGY4KCkpOwogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu\nZGVidWcoIlJlY2VpdmVkIG1lc3NhZ2Uge30sIiwgdmFsdWUpOwoKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09IGV4cGVjdGVkLmdldCgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZC5pbmNy\nZW1lbnRBbmRHZXQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVycm9yIGNvbmRp\ndGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9y\nKCJEaWQgbm90IHJlY2VpdmUgZXhwZWN0ZWQgdmFsdWUsIGV4cGVjdGVkIHt9\nLCBnb3Qge30iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGV4cGVjdGVkLmdldCgpLCB2YWx1ZSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBleHBlY3RlZC5zZXQoMCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB0aHJvdHRsZUxhdGNoLmNvdW50RG93bigpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbm9uVGhyb3R0bGVMYXRjaC5jb3Vu\ndERvd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAoZXhwZWN0ZWQuZ2V0KCkgPiBYKzEpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHRocm90dGxlTGF0Y2guY291bnRE\nb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKGV4cGVjdGVkLmdldCgpID09ICgzICogWCArIDEp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25UaHJvdHRsZUxh\ndGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlz\naGVkKGNvbnRleHQsIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcigiUmVjZWl2ZWQgYmFkIG1lc3NhZ2UiLCBlKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgdGhyb3R0bGVMYXRjaC5jb3VudERvd24oKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgbm9uVGhyb3R0bGVMYXRjaC5jb3Vu\ndERvd24oKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhc3NlcnRUcnVlKCJT\naG91bGQgUmVjZWl2ZSBtb3JlIG1lc3NhZ2VzIHRoYW4gdGhyb3R0bGUgdmFs\ndWUgIiArIFgsCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm90dGxlTGF0\nY2guYXdhaXQoMTAsIFRpbWVVbml0LlNFQ09ORFMpKTsKCiAgICAgICAgICAg\nIGFzc2VydFRydWUoIlRpbWVkIG91dCB3YWl0aW5nIGZvciBtZXNzYWdlcyAi\nICsgKDMqWCArIDEpLAogICAgICAgICAgICAgICAgICAgICAgIG5vblRocm90\ndGxlTGF0Y2guYXdhaXQoMTAsIFRpbWVVbml0LlNFQ09ORFMpKTsKICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKCJTaG91bGQgYmUgZXhwZWN0ZWQgbWVzc2Fn\nZSB3aXRoICIgKyAoMypYICsgMSksCiAgICAgICAgICAgICAgICAgICAgICAg\nICAzKlggKyAxLCBleHBlY3RlZC5nZXQoKSk7CgogICAgICAgICAgICBzdWJz\nY3JpYmVyLnN0b3BEZWxpdmVyeSh0b3BpYywgc3ViaWQpOwogICAgICAgICAg\nICBjbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgY29tcGF0YWJpbGl0eSBvZiBt\nZXNzYWdlIGJvdW5kIGJldHdlZW4gdmVyc2lvbiA0LjAuMCBhbmQKICAgICAq\nIGN1cnJlbnQgdmVyc2lvbi4KICAgICAqCiAgICAgKiAxKSBtZXNzYWdlIGJv\ndW5kIGRvZXNuJ3QgdGFrZSBlZmZlY3RzIG9uIDQuMC4wIHNlcnZlci4KICAg\nICAqIDIpIG1lc3NhZ2UgYm91bmQgdGFrZSBlZmZlY3RzIG9uIGJvdGggNC4x\nLjAgYW5kIGN1cnJlbnQgc2VydmVyCiAgICAgKi8KICAgIEBUZXN0KHRpbWVv\ndXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWVzc2FnZUJvdW5kQ29t\ncGF0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0\nb3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0ZXN0TWVzc2FnZUJv\ndW5kQ29tcGF0Iik7CiAgICAgICAgQnl0ZVN0cmluZyBzdWJpZCA9IEJ5dGVT\ndHJpbmcuY29weUZyb21VdGY4KCJteXN1YiIpOwoKICAgICAgICBpbnQgcG9y\ndCA9IFBvcnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpOwogICAgICAgIGludCBz\nc2xQb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQb3J0KCk7CgogICAgICAg\nIC8vIHN0YXJ0IGJvb2trZWVwZXIgNDAwCiAgICAgICAgQm9va0tlZXBlckNs\ndXN0ZXI0MDAgYmtjNDAwID0gbmV3IEJvb2tLZWVwZXJDbHVzdGVyNDAwKDMp\nOwogICAgICAgIGJrYzQwMC5zdGFydCgpOwoKICAgICAgICAvLyBzdGFydCA0\nMDAgc2VydmVyCiAgICAgICAgU2VydmVyNDAwIHM0MDAgPSBuZXcgU2VydmVy\nNDAwKHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCksIHBvcnQs\nIHNzbFBvcnQpOwogICAgICAgIHM0MDAuc3RhcnQoKTsKCiAgICAgICAgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2Ny\naXB0aW9uT3B0aW9ucyBvcHRpb25zNWN1ciA9CiAgICAgICAgICAgIG9yZy5h\ncGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlw\ndGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgIC5zZXRDcmVh\ndGVPckF0dGFjaChvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQ\ncm90b2NvbC5TdWJzY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoLkNSRUFU\nRV9PUl9BVFRBQ0gpCiAgICAgICAgICAgIC5zZXRNZXNzYWdlQm91bmQoNSku\nYnVpbGQoKTsKCiAgICAgICAgQ2xpZW50Q3VycmVudCBjY3VyID0gbmV3IENs\naWVudEN1cnJlbnQoImxvY2FsaG9zdDoiICsgcG9ydCArICI6IiArIHNzbFBv\ncnQpOwogICAgICAgIGNjdXIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZCwgb3B0\naW9uczVjdXIpOwogICAgICAgIGNjdXIuY2xvc2VTdWJzY3JpcHRpb24odG9w\naWMsIHN1YmlkKTsKICAgICAgICBjY3VyLnNlbmRYRXhwZWN0TGFzdFkodG9w\naWMsIHN1YmlkLCA1MCwgNTApOwoKICAgICAgICAvLyBzdG9wIDQwMCBzZXJ2\nZXJzCiAgICAgICAgczQwMC5zdG9wKCk7CiAgICAgICAgYmtjNDAwLnN0b3Ao\nKTsKCiAgICAgICAgLy8gc3RhcnQgYm9va2tlZXBlciA0MTAKICAgICAgICBC\nb29rS2VlcGVyQ2x1c3RlcjQxMCBia2M0MTAgPSBuZXcgQm9va0tlZXBlckNs\ndXN0ZXI0MTAoMyk7CiAgICAgICAgYmtjNDEwLnN0YXJ0KCk7CgogICAgICAg\nIC8vIHN0YXJ0IDQxMCBzZXJ2ZXIKICAgICAgICBTZXJ2ZXI0MTAgczQxMCA9\nIG5ldyBTZXJ2ZXI0MTAoemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJp\nbmcoKSwgcG9ydCwgc3NsUG9ydCk7CiAgICAgICAgczQxMC5zdGFydCgpOwoK\nICAgICAgICBjY3VyLnN1YnNjcmliZSh0b3BpYywgc3ViaWQsIG9wdGlvbnM1\nY3VyKTsKICAgICAgICBjY3VyLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBz\ndWJpZCk7CiAgICAgICAgY2N1ci5zZW5kWEV4cGVjdExhc3RZKHRvcGljLCBz\ndWJpZCwgNTAsIDUpOwoKICAgICAgICAvLyBzdG9wIDQxMCBzZXJ2ZXJzCiAg\nICAgICAgczQxMC5zdG9wKCk7CiAgICAgICAgYmtjNDEwLnN0b3AoKTsKCiAg\nICAgICAgLy8gc3RhcnQgYm9va2tlZXBlciBjdXJyZW50CiAgICAgICAgQm9v\na0tlZXBlckNsdXN0ZXJDdXJyZW50IGJrY2N1ciA9IG5ldyBCb29rS2VlcGVy\nQ2x1c3RlckN1cnJlbnQoMyk7CiAgICAgICAgYmtjY3VyLnN0YXJ0KCk7Cgog\nICAgICAgIC8vIHN0YXJ0IGN1cnJlbnQgc2VydmVyCiAgICAgICAgU2VydmVy\nQ3VycmVudCBzY3VyID0gbmV3IFNlcnZlckN1cnJlbnQoemtVdGlsLmdldFpv\nb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwgcG9ydCwgc3NsUG9ydCk7CiAgICAg\nICAgc2N1ci5zdGFydCgpOwoKICAgICAgICBjY3VyLnN1YnNjcmliZSh0b3Bp\nYywgc3ViaWQsIG9wdGlvbnM1Y3VyKTsKICAgICAgICBjY3VyLmNsb3NlU3Vi\nc2NyaXB0aW9uKHRvcGljLCBzdWJpZCk7CiAgICAgICAgY2N1ci5zZW5kWEV4\ncGVjdExhc3RZKHRvcGljLCBzdWJpZCwgNTAsIDUpOwoKICAgICAgICAvLyBz\ndG9wIGN1cnJlbnQgc2VydmVycwogICAgICAgIHNjdXIuc3RvcCgpOwogICAg\nICAgIGJrY2N1ci5zdG9wKCk7CgogICAgICAgIGNjdXIuY2xvc2UoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRlc3QgY29tcGF0YWJpbGl0eSBvZiBwdWJs\naXNoIGludGVyZmFjZSBiZXR3ZWVuIHZlcnNpb24gNC4xLjAKICAgICAqIGFu\nZCBjdXJyZW50IHZlcmlzb24uCiAgICAgKgogICAgICogMSkgNC4xLjAgY2xp\nZW50IGNvdWxkIHRhbGsgd2l0aCBjdXJyZW50IHNlcnZlci4KICAgICAqIDIp\nIGN1cnJlbnQgY2xpZW50IGNvdWxkIHRhbGsgd2l0aCA0LjEuMCBzZXJ2ZXIs\nCiAgICAgKiAgICBidXQgbm8gbWVzc2FnZSBzZXEgaWQgd291bGQgYmUgcmV0\ndXJuZWQKICAgICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1\nYmxpYyB2b2lkIHRlc3RQdWJsaXNoQ29tcGF0NDEwKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcu\nY29weUZyb21VdGY4KCJUZXN0UHVibGlzaENvbXBhdDQxMCIpOwogICAgICAg\nIEJ5dGVTdHJpbmcgZGF0YSA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0\nZXN0ZGF0YSIpOwoKICAgICAgICAvLyBzdGFydCBib29ra2VlcGVyIDQxMAog\nICAgICAgIEJvb2tLZWVwZXJDbHVzdGVyNDEwIGJrYzQxMCA9IG5ldyBCb29r\nS2VlcGVyQ2x1c3RlcjQxMCgzKTsKICAgICAgICBia2M0MTAuc3RhcnQoKTsK\nCiAgICAgICAgaW50IHBvcnQgPSBQb3J0TWFuYWdlci5uZXh0RnJlZVBvcnQo\nKTsKICAgICAgICBpbnQgc3NsUG9ydCA9IFBvcnRNYW5hZ2VyLm5leHRGcmVl\nUG9ydCgpOwoKICAgICAgICAvLyBzdGFydCA0MTAgc2VydmVyCiAgICAgICAg\nU2VydmVyNDEwIHM0MTAgPSBuZXcgU2VydmVyNDEwKHprVXRpbC5nZXRab29L\nZWVwZXJDb25uZWN0U3RyaW5nKCksIHBvcnQsIHNzbFBvcnQpOwogICAgICAg\nIHM0MTAuc3RhcnQoKTsKCiAgICAgICAgQ2xpZW50Q3VycmVudCBjY3VyID0g\nbmV3IENsaWVudEN1cnJlbnQoImxvY2FsaG9zdDoiK3BvcnQrIjoiK3NzbFBv\ncnQpOwogICAgICAgIENsaWVudDQxMCBjNDEwID0gbmV3IENsaWVudDQxMCgi\nbG9jYWxob3N0OiIrcG9ydCsiOiIrc3NsUG9ydCk7CgogICAgICAgIC8vIGNs\naWVudCBjNDEwIGNvdWxkIHB1Ymxpc2ggbWVzc2FnZSB0byA0MTAgc2VydmVy\nCiAgICAgICAgYXNzZXJ0TnVsbChjNDEwLnB1Ymxpc2godG9waWMsIGRhdGEp\nKTsKICAgICAgICAvLyBjbGllbnQgY2N1ciBjb3VsZCBwdWJsaXNoIG1lc3Nh\nZ2UgdG8gNDEwIHNlcnZlcgogICAgICAgIC8vIGJ1dCBubyBtZXNzYWdlIHNl\ncSBpZCB3b3VsZCBiZSByZXR1cm5lZAogICAgICAgIGFzc2VydE51bGwoY2N1\nci5wdWJsaXNoKHRvcGljLCBkYXRhKSk7CgogICAgICAgIC8vIHN0b3AgNDEw\nIHNlcnZlcgogICAgICAgIHM0MTAuc3RvcCgpOwoKICAgICAgICAvLyBzdGFy\ndCBjdXJyZW50IHNlcnZlcgogICAgICAgIFNlcnZlckN1cnJlbnQgc2N1ciA9\nIG5ldyBTZXJ2ZXJDdXJyZW50KHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0\nU3RyaW5nKCksIHBvcnQsIHNzbFBvcnQpOwogICAgICAgIHNjdXIuc3RhcnQo\nKTsKCiAgICAgICAgLy8gY2xpZW50IGM0MTAgY291bGQgcHVibGlzaCBtZXNz\nYWdlIHRvIDQxMCBzZXJ2ZXIKICAgICAgICAvLyBidXQgbm8gbWVzc2FnZSBz\nZXEgaWQgd291bGQgYmUgcmV0dXJuZWQKICAgICAgICBhc3NlcnROdWxsKGM0\nMTAucHVibGlzaCh0b3BpYywgZGF0YSkpOwogICAgICAgIC8vIGNsaWVudCBj\nY3VyIGNvdWxkIHB1Ymxpc2ggbWVzc2FnZSB0byBjdXJyZW50IHNlcnZlcgog\nICAgICAgIGFzc2VydE5vdE51bGwoY2N1ci5wdWJsaXNoKHRvcGljLCBkYXRh\nKSk7CgogICAgICAgIGNjdXIuY2xvc2UoKTsKICAgICAgICBjNDEwLmNsb3Nl\nKCk7CgogICAgICAgIC8vIHN0b3AgY3VycmVudCBzZXJ2ZXIKICAgICAgICBz\nY3VyLnN0b3AoKTsKICAgICAgICBia2M0MTAuc3RvcCgpOwogICAgfQoKICAg\nIC8qKgogICAgICogVGVzdCBjb21wYXRhYmlsaXR5IGJldHdlZW4gdmVyc2lv\nbiA0LjEuMCBhbmQgdGhlIGN1cnJlbnQgdmVyc2lvbi4KICAgICAqCiAgICAg\nKiBBIGN1cnJlbnQgc2VydmVyIGNvdWxkIHJlYWQgc3Vic2NyaXB0aW9uIGRh\ndGEgcmVjb3JkZWQgYnkgNC4xLjAgc2VydmVyLgogICAgICovCiAgICBAVGVz\ndCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFN1YnNjcmlw\ndGlvbkRhdGFDb21wYXQ0MTAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0Zjgo\nIlRlc3RDb21wYXQ0MTAiKTsKICAgICAgICBCeXRlU3RyaW5nIHN1YjQxMCA9\nIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJzdWI0MTAiKTsKICAgICAgICBC\neXRlU3RyaW5nIHN1YmN1ciA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJz\ndWJjdXIiKTsKCiAgICAgICAgLy8gc3RhcnQgYm9va2tlZXBlciA0MTAKICAg\nICAgICBCb29rS2VlcGVyQ2x1c3RlcjQxMCBia2M0MTAgPSBuZXcgQm9va0tl\nZXBlckNsdXN0ZXI0MTAoMyk7CiAgICAgICAgYmtjNDEwLnN0YXJ0KCk7Cgog\nICAgICAgIGludCBwb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQb3J0KCk7\nCiAgICAgICAgaW50IHNzbFBvcnQgPSBQb3J0TWFuYWdlci5uZXh0RnJlZVBv\ncnQoKTsKCiAgICAgICAgLy8gc3RhcnQgNDEwIHNlcnZlcgogICAgICAgIFNl\ncnZlcjQxMCBzNDEwID0gbmV3IFNlcnZlcjQxMCh6a1V0aWwuZ2V0Wm9vS2Vl\ncGVyQ29ubmVjdFN0cmluZygpLCBwb3J0LCBzc2xQb3J0KTsKICAgICAgICBz\nNDEwLnN0YXJ0KCk7CgogICAgICAgIENsaWVudDQxMCBjNDEwID0gbmV3IENs\naWVudDQxMCgibG9jYWxob3N0OiIrcG9ydCsiOiIrc3NsUG9ydCk7CiAgICAg\nICAgYzQxMC5zdWJzY3JpYmUodG9waWMsIHN1YjQxMCk7CiAgICAgICAgYzQx\nMC5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViNDEwKTsKICAgICAgICBU\naHJlYWQuc2xlZXAoMTAwMCk7IC8vIGdpdmUgc2VydmVyIHRpbWUgdG8gcnVu\nIGRpc2Nvbm5lY3QgbG9naWMgKEJPT0tLRUVQRVItNTEzKQoKICAgICAgICBD\nbGllbnRDdXJyZW50IGNjdXIgPSBuZXcgQ2xpZW50Q3VycmVudCgibG9jYWxo\nb3N0OiIrcG9ydCsiOiIrc3NsUG9ydCk7CiAgICAgICAgY2N1ci5zdWJzY3Jp\nYmUodG9waWMsIHN1YmN1cik7CiAgICAgICAgY2N1ci5jbG9zZVN1YnNjcmlw\ndGlvbih0b3BpYywgc3ViY3VyKTsKCiAgICAgICAgLy8gcHVibGlzaCBtZXNz\nYWdlcyB1c2luZyBvbGQgY2xpZW50CiAgICAgICAgYzQxMC5wdWJsaXNoSW50\ncyh0b3BpYywgMCwgMTApOwogICAgICAgIC8vIHN0b3AgNDEwIHNlcnZlcgog\nICAgICAgIHM0MTAuc3RvcCgpOwoKICAgICAgICAvLyBzdGFydCBjdXJyZW50\nIHNlcnZlcgogICAgICAgIFNlcnZlckN1cnJlbnQgc2N1ciA9IG5ldyBTZXJ2\nZXJDdXJyZW50KHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgcG9ydCwgc3NsUG9ydCk7CiAgICAgICAgc2N1ci5zdGFydCgpOwoKICAg\nICAgICBjNDEwLnN1YnNjcmliZSh0b3BpYywgc3ViNDEwKTsKICAgICAgICBj\nNDEwLnJlY2VpdmVJbnRzKHRvcGljLCBzdWI0MTAsIDAsIDEwKTsKCiAgICAg\nICAgY2N1ci5zdWJzY3JpYmUodG9waWMsIHN1YmN1cik7CiAgICAgICAgY2N1\nci5yZWNlaXZlSW50cyh0b3BpYywgc3ViY3VyLCAwLCAxMCk7CgogICAgICAg\nIC8vIHB1Ymxpc2ggbWVzc2FnZXMgdXNpbmcgY3VycmVudCBjbGllbnQKICAg\nICAgICBjY3VyLnB1Ymxpc2hJbnRzKHRvcGljLCAxMCwgMTApOwoKICAgICAg\nICBjNDEwLnJlY2VpdmVJbnRzKHRvcGljLCBzdWI0MTAsIDEwLCAxMCk7CiAg\nICAgICAgY2N1ci5yZWNlaXZlSW50cyh0b3BpYywgc3ViY3VyLCAxMCwgMTAp\nOwoKICAgICAgICAvLyBzdG9wIGN1cnJlbnQgc2VydmVyCiAgICAgICAgc2N1\nci5zdG9wKCk7CgogICAgICAgIGM0MTAuY2xvc2UoKTsKICAgICAgICBjY3Vy\nLmNsb3NlKCk7CgogICAgICAgIC8vIHN0b3AgYm9va2tlZXBlciBjbHVzdGVy\nCiAgICAgICAgYmtjNDEwLnN0b3AoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRlc3QgY29tcGF0YWJpbGl0eSBiZXR3ZWVuIHZlcnNpb24gNC4xLjAgYW5k\nIHRoZSBjdXJyZW50IHZlcnNpb24uCiAgICAgKgogICAgICogQSA0LjEuMCBj\nbGllbnQgY291bGQgbm90IHVwZGF0ZSBtZXNzYWdlIGJvdW5kLCB3aGlsZSBj\ndXJyZW50IGNvdWxkIGRvIGl0LgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0\nPTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFVwZGF0ZU1lc3NhZ2VCb3Vu\nZENvbXBhdDQxMCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVT\ndHJpbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdFVw\nZGF0ZU1lc3NhZ2VCb3VuZENvbXBhdDQxMCIpOwogICAgICAgIEJ5dGVTdHJp\nbmcgc3ViaWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgibXlzdWIiKTsK\nCiAgICAgICAgLy8gc3RhcnQgYm9va2tlZXBlcgogICAgICAgIEJvb2tLZWVw\nZXJDbHVzdGVyQ3VycmVudCBia2NjdXI9IG5ldyBCb29rS2VlcGVyQ2x1c3Rl\nckN1cnJlbnQoMyk7CiAgICAgICAgYmtjY3VyLnN0YXJ0KCk7CgogICAgICAg\nIGludCBwb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQb3J0KCk7CiAgICAg\nICAgaW50IHNzbFBvcnQgPSBQb3J0TWFuYWdlci5uZXh0RnJlZVBvcnQoKTsK\nCiAgICAgICAgLy8gc3RhcnQgaHViIHNlcnZlcgogICAgICAgIFNlcnZlckN1\ncnJlbnQgc2N1ciA9IG5ldyBTZXJ2ZXJDdXJyZW50KHprVXRpbC5nZXRab29L\nZWVwZXJDb25uZWN0U3RyaW5nKCksCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCwgc3NsUG9ydCk7CiAgICAg\nICAgc2N1ci5zdGFydCgpOwoKICAgICAgICBvcmcuYXBhY2hlLmhlZHdpZy5w\ncm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zIG9w\ndGlvbnM1Y3VyID0KICAgICAgICAgICAgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdC\ndWlsZGVyKCkKICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKG9yZy5h\ncGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmli\nZVJlcXVlc3QuQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkKICAg\nICAgICAgICAgLnNldE1lc3NhZ2VCb3VuZCg1KS5idWlsZCgpOwogICAgICAg\nIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQ\ncm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zIG9wdGlvbnM1djQxMCA9CiAg\nICAgICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxk\nZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2gob3JnLmFwYWNo\nZS5od192NF8xXzAuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1\nYnNjcmliZVJlcXVlc3QuQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFD\nSCkKICAgICAgICAgICAgLnNldE1lc3NhZ2VCb3VuZCg1KS5idWlsZCgpOwog\nICAgICAgIG9yZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5wcm90b2NvbC5Q\ndWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zIG9wdGlvbnMyMHY0\nMTAgPQogICAgICAgICAgICBvcmcuYXBhY2hlLmh3X3Y0XzFfMC5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uT3B0aW9ucy5u\nZXdCdWlsZGVyKCkKICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKG9y\nZy5hcGFjaGUuaHdfdjRfMV8wLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90\nb2NvbC5TdWJzY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoLkNSRUFURV9P\nUl9BVFRBQ0gpCiAgICAgICAgICAgIC5zZXRNZXNzYWdlQm91bmQoMjApLmJ1\naWxkKCk7CgogICAgICAgIENsaWVudDQxMCBjNDEwID0gbmV3IENsaWVudDQx\nMCgibG9jYWxob3N0OiIrcG9ydCsiOiIrc3NsUG9ydCk7CiAgICAgICAgYzQx\nMC5zdWJzY3JpYmUodG9waWMsIHN1YmlkLCBvcHRpb25zMjB2NDEwKTsKICAg\nICAgICBjNDEwLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZCk7CiAg\nICAgICAgVGhyZWFkLnNsZWVwKDEwMDApOyAvLyBnaXZlIHNlcnZlciB0aW1l\nIHRvIHJ1biBkaXNjb25uZWN0IGxvZ2ljIChCT09LS0VFUEVSLTUxMykKCiAg\nICAgICAgYzQxMC5zZW5kWEV4cGVjdExhc3RZKHRvcGljLCBzdWJpZCwgNTAs\nIDIwKTsKCiAgICAgICAgYzQxMC5zdWJzY3JpYmUodG9waWMsIHN1YmlkLCBv\ncHRpb25zNXY0MTApOwogICAgICAgIGM0MTAuY2xvc2VTdWJzY3JpcHRpb24o\ndG9waWMsIHN1YmlkKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7IC8v\nIGdpdmUgc2VydmVyIHRpbWUgdG8gcnVuIGRpc2Nvbm5lY3QgbG9naWMgKEJP\nT0tLRUVQRVItNTEzKQoKICAgICAgICAvLyB0aGUgbWVzc2FnZSBib3VuZCBp\nc24ndCB1cGRhdGVkLgogICAgICAgIGM0MTAuc2VuZFhFeHBlY3RMYXN0WSh0\nb3BpYywgc3ViaWQsIDUwLCAyMCk7CgogICAgICAgIENsaWVudEN1cnJlbnQg\nY2N1ciA9IG5ldyBDbGllbnRDdXJyZW50KCJsb2NhbGhvc3Q6Iitwb3J0KyI6\nIitzc2xQb3J0KTsKICAgICAgICBjY3VyLnN1YnNjcmliZSh0b3BpYywgc3Vi\naWQsIG9wdGlvbnM1Y3VyKTsKICAgICAgICBjY3VyLmNsb3NlU3Vic2NyaXB0\naW9uKHRvcGljLCBzdWJpZCk7CiAgICAgICAgVGhyZWFkLnNsZWVwKDEwMDAp\nOyAvLyBnaXZlIHNlcnZlciB0aW1lIHRvIHJ1biBkaXNjb25uZWN0IGxvZ2lj\nIChCT09LS0VFUEVSLTUxMykKCiAgICAgICAgLy8gdGhlIG1lc3NhZ2UgYm91\nbmQgc2hvdWxkIGJlIHVwZGF0ZWQuCiAgICAgICAgYzQxMC5zZW5kWEV4cGVj\ndExhc3RZKHRvcGljLCBzdWJpZCwgNTAsIDUpOwoKICAgICAgICAvLyBzdG9w\nIGN1cnJlbnQgc2VydmVyCiAgICAgICAgc2N1ci5zdG9wKCk7CgogICAgICAg\nIGM0MTAuY2xvc2UoKTsKICAgICAgICBjY3VyLmNsb3NlKCk7CgogICAgICAg\nIC8vIHN0b3AgYm9va2tlZXBlciBjbHVzdGVyCiAgICAgICAgYmtjY3VyLnN0\nb3AoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgY29tcGF0YWJpbGl0\neSBiZXR3ZWVuIHZlcnNpb24gNC4xLjAgYW5kIHRoZSBjdXJyZW50IHZlcnNp\nb24uCiAgICAgKgogICAgICogQSBjdXJyZW50IGNsaWVudCBydW5uaW5nIG1l\nc3NhZ2UgZmlsdGVyIHdvdWxkIGZhaWwgb24gNC4xLjAgaHViIHNlcnZlcnMu\nCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0Q2xpZW50TWVzc2FnZUZpbHRlckNvbXBhdDQxMCgpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBCeXRl\nU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdFVwZGF0ZU1lc3NhZ2VCb3VuZENv\nbXBhdDQxMCIpOwogICAgICAgIEJ5dGVTdHJpbmcgc3ViaWQgPSBCeXRlU3Ry\naW5nLmNvcHlGcm9tVXRmOCgibXlzdWIiKTsKCiAgICAgICAgLy8gc3RhcnQg\nYm9va2tlZXBlcgogICAgICAgIEJvb2tLZWVwZXJDbHVzdGVyNDEwIGJrYzQx\nMCA9IG5ldyBCb29rS2VlcGVyQ2x1c3RlcjQxMCgzKTsKICAgICAgICBia2M0\nMTAuc3RhcnQoKTsKCiAgICAgICAgaW50IHBvcnQgPSBQb3J0TWFuYWdlci5u\nZXh0RnJlZVBvcnQoKTsKICAgICAgICBpbnQgc3NsUG9ydCA9IFBvcnRNYW5h\nZ2VyLm5leHRGcmVlUG9ydCgpOwoKICAgICAgICAvLyBzdGFydCBodWIgc2Vy\ndmVyIDQxMAogICAgICAgIFNlcnZlcjQxMCBzNDEwID0gbmV3IFNlcnZlcjQx\nMCh6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLCBwb3J0LCBz\nc2xQb3J0KTsKICAgICAgICBzNDEwLnN0YXJ0KCk7CgogICAgICAgIENsaWVu\ndEN1cnJlbnQgY2N1ciA9IG5ldyBDbGllbnRDdXJyZW50KCJsb2NhbGhvc3Q6\nIitwb3J0KyI6Iitzc2xQb3J0KTsKICAgICAgICBjY3VyLnN1YnNjcmliZSh0\nb3BpYywgc3ViaWQpOwogICAgICAgIGNjdXIuY2xvc2VTdWJzY3JpcHRpb24o\ndG9waWMsIHN1YmlkKTsKCiAgICAgICAgY2N1ci5wdWJsaXNoSW50cyh0b3Bp\nYywgMCwgMTAwKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjY3VyLnJl\nY2VpdmVOdW1Nb2RNKHRvcGljLCBzdWJpZCwgMCwgNTAsIDIpOwogICAgICAg\nICAgICBmYWlsKCJjbGllbnQtc2lkZSBmaWx0ZXIgY291bGQgbm90IHJ1biBv\nbiA0LjEuMCBodWIgc2VydmVyIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlNob3VsZCBmYWls\nIHRvIHJ1biBjbGllbnQtc2lkZSBtZXNzYWdlIGZpbHRlciBvbiA0LjEuMCBo\ndWIgc2VydmVyLiIsIGUpOwogICAgICAgICAgICBjY3VyLmNsb3NlU3Vic2Ny\naXB0aW9uKHRvcGljLCBzdWJpZCk7CiAgICAgICAgfQoKICAgICAgICAvLyBz\ndG9wIDQxMCBzZXJ2ZXIKICAgICAgICBzNDEwLnN0b3AoKTsKICAgICAgICAv\nLyBzdG9wIGJvb2trZWVwZXIgY2x1c3RlcgogICAgICAgIGJrYzQxMC5zdG9w\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IGNvbXBhdGFiaWxpdHkg\nYmV0d2VlbiB2ZXJzaW9uIDQuMS4wIGFuZCB0aGUgY3VycmVudCB2ZXJzaW9u\nLgogICAgICoKICAgICAqIFNlcnZlciBzaWRlIHRocm90dGxpbmcgZG9lcyd0\nIHdvcmsgd2hlbiBjdXJyZW50IGNsaWVudCBjb25uZWN0cyB0byBvbGQgdmVy\nc2lvbgogICAgICogc2VydmVyLgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0\nPTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFNlcnZlclNpZGVUaHJvdHRs\nZUNvbXBhdDQxMCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVT\ndHJpbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdFNl\ncnZlclNpZGVUaHJvdHRsZUNvbXBhdDQxMCIpOwogICAgICAgIEJ5dGVTdHJp\nbmcgc3ViaWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgibXlzdWIiKTsK\nCiAgICAgICAgLy8gc3RhcnQgYm9va2tlZXBlcgogICAgICAgIEJvb2tLZWVw\nZXJDbHVzdGVyNDEwIGJrYzQxMCA9IG5ldyBCb29rS2VlcGVyQ2x1c3RlcjQx\nMCgzKTsKICAgICAgICBia2M0MTAuc3RhcnQoKTsKCiAgICAgICAgaW50IHBv\ncnQgPSBQb3J0TWFuYWdlci5uZXh0RnJlZVBvcnQoKTsKICAgICAgICBpbnQg\nc3NsUG9ydCA9IFBvcnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpOwoKICAgICAg\nICAvLyBzdGFydCBodWIgc2VydmVyIDQxMAogICAgICAgIFNlcnZlcjQxMCBz\nNDEwID0gbmV3IFNlcnZlcjQxMCh6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVj\ndFN0cmluZygpLCBwb3J0LCBzc2xQb3J0KTsKICAgICAgICBzNDEwLnN0YXJ0\nKCk7CgogICAgICAgIENsaWVudEN1cnJlbnQgY2N1ciA9IG5ldyBDbGllbnRD\ndXJyZW50KGZhbHNlLCAibG9jYWxob3N0OiIrcG9ydCsiOiIrc3NsUG9ydCk7\nCiAgICAgICAgY2N1ci50aHJvdHRsZVg0MSh0b3BpYywgc3ViaWQsIDEwKTsK\nCiAgICAgICAgY2N1ci5jbG9zZSgpOwoKICAgICAgICAvLyBzdG9wIDQxMCBz\nZXJ2ZXIKICAgICAgICBzNDEwLnN0b3AoKTsKICAgICAgICAvLyBzdG9wIGJv\nb2trZWVwZXIgY2x1c3RlcgogICAgICAgIGJrYzQxMC5zdG9wKCk7CiAgICB9\nCn0K\n","encoding":"base64"}

