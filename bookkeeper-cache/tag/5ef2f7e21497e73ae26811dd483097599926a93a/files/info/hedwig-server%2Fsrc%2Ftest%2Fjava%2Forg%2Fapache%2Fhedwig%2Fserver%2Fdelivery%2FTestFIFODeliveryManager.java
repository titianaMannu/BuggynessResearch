{"sha":"a2b5b279e5c7f5504ea26ab055dd7db854df5461","node_id":"MDQ6QmxvYjE1NzU5NTY6YTJiNWIyNzllNWM3ZjU1MDRlYTI2YWIwNTVkZDdkYjg1NGRmNTQ2MQ==","size":12407,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a2b5b279e5c7f5504ea26ab055dd7db854df5461","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuZGVsaXZlcnk7CgppbXBv\ncnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuYXNzZXJ0RXF1YWxzOwppbXBv\ncnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuYXNzZXJ0Tm90TnVsbDsKaW1w\nb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0LmFzc2VydE51bGw7CmltcG9y\ndCBzdGF0aWMgb3JnLmp1bml0LkFzc2VydC5hc3NlcnRUcnVlOwoKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRMaW5rZWRRdWV1ZTsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwpp\nbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBvcnQg\namF2YS51dGlsLmNvbmN1cnJlbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNl\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWljQm9vbGVhbjsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5BdG9taWNJbnRl\nZ2VyOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHVi\nU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZmlsdGVy\nLlBpcGVsaW5lRmlsdGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2VTZXFJ\nZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLlB1YlN1YlJlc3BvbnNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uUHJlZmVy\nZW5jZXM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9u\nLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5zZXJ2ZXIucGVyc2lzdGVuY2UuUGVyc2lzdFJlcXVlc3Q7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuUGVyc2lzdGVu\nY2VNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBl\ncnNpc3RlbmNlLlN0dWJQZXJzaXN0ZW5jZU1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9ucy5BbGxUb0FsbFRv\ncG9sb2d5RmlsdGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5D\nYWxsYmFjazsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoK\naW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKCnB1Ymxp\nYyBjbGFzcyBUZXN0RklGT0RlbGl2ZXJ5TWFuYWdlciB7CiAgICBzdGF0aWMg\nTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFRlc3RG\nSUZPRGVsaXZlcnlNYW5hZ2VyLmNsYXNzKTsKCiAgICBzdGF0aWMgY2xhc3Mg\nVGVzdENhbGxiYWNrIGltcGxlbWVudHMgQ2FsbGJhY2s8TWVzc2FnZVNlcUlk\nPiB7CiAgICAgICAgQXRvbWljQm9vbGVhbiBzdWNjZXNzID0gbmV3IEF0b21p\nY0Jvb2xlYW4oZmFsc2UpOwogICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNo\nIGxhdGNoOwogICAgICAgIE1lc3NhZ2VTZXFJZCBtc2dpZCA9IG51bGw7Cgog\nICAgICAgIFRlc3RDYWxsYmFjayhDb3VudERvd25MYXRjaCBsKSB7CiAgICAg\nICAgICAgIHRoaXMubGF0Y2ggPSBsOwogICAgICAgIH0KICAgICAgICBwdWJs\naWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhj\nZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICBsb2dnZXIuZXJyb3Io\nIlBlcnNpc3Qgb3BlcmF0aW9uIGZhaWxlZCIsIGV4Y2VwdGlvbik7CiAgICAg\nICAgICAgIGxhdGNoLmNvdW50RG93bigpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgTWVz\nc2FnZVNlcUlkIHJlc3VsdE9mT3BlcmF0aW9uKSB7CiAgICAgICAgICAgIG1z\nZ2lkID0gcmVzdWx0T2ZPcGVyYXRpb247CiAgICAgICAgICAgIHN1Y2Nlc3Mu\nc2V0KHRydWUpOwogICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsKICAg\nICAgICB9CgogICAgICAgIE1lc3NhZ2VTZXFJZCBnZXRJZCgpIHsKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZSgiUGVyc2lzdCBvcGVyYXRpb24gZmFpbGVkIiwg\nc3VjY2Vzcy5nZXQoKSk7CiAgICAgICAgICAgIHJldHVybiBtc2dpZDsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxpdmVyeSBlbmRwb2lu\ndCB3aGljaCBwdXRzIGFsbCByZXNwb25zZXMgb24gYSBxdWV1ZQogICAgICov\nCiAgICBzdGF0aWMgY2xhc3MgRXhlY3V0b3JEZWxpdmVyeUVuZFBvaW50V2l0\naFF1ZXVlIGltcGxlbWVudHMgRGVsaXZlcnlFbmRQb2ludCB7CiAgICAgICAg\nU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIGV4ZWN1dG9yID0gRXhlY3V0b3Jz\nLm5ld1NpbmdsZVRocmVhZFNjaGVkdWxlZEV4ZWN1dG9yKCk7CiAgICAgICAg\nQXRvbWljSW50ZWdlciBudW1SZXNwb25zZXMgPSBuZXcgQXRvbWljSW50ZWdl\ncigwKTsKICAgICAgICBDb25jdXJyZW50TGlua2VkUXVldWU8UHViU3ViUmVz\ncG9uc2U+IHF1ZXVlID0gbmV3IENvbmN1cnJlbnRMaW5rZWRRdWV1ZTxQdWJT\ndWJSZXNwb25zZT4oKTsKCiAgICAgICAgcHVibGljIHZvaWQgc2VuZChmaW5h\nbCBQdWJTdWJSZXNwb25zZSByZXNwb25zZSwgZmluYWwgRGVsaXZlcnlDYWxs\nYmFjayBjYWxsYmFjaykgewogICAgICAgICAgICBsb2dnZXIuaW5mbygiUmVj\nZWl2ZWQgcmVzcG9uc2Uge30iLCByZXNwb25zZSk7CiAgICAgICAgICAgIHF1\nZXVlLmFkZChyZXNwb25zZSk7CiAgICAgICAgICAgIG51bVJlc3BvbnNlcy5p\nbmNyZW1lbnRBbmRHZXQoKTsKICAgICAgICAgICAgZXhlY3V0b3Iuc3VibWl0\nKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\ndm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNr\nLnNlbmRpbmdGaW5pc2hlZCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgY2xvc2UoKSB7CiAgICAgICAgICAgIGV4ZWN1dG9yLnNodXRkb3duKCk7\nCiAgICAgICAgfQoKICAgICAgICBQdWJTdWJSZXNwb25zZSBnZXROZXh0UmVz\ncG9uc2UoKSB7CiAgICAgICAgICAgIHJldHVybiBxdWV1ZS5wb2xsKCk7CiAg\nICAgICAgfQoKICAgICAgICBpbnQgZ2V0TnVtUmVzcG9uc2VzKCkgewogICAg\nICAgICAgICByZXR1cm4gbnVtUmVzcG9uc2VzLmdldCgpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgdGhhdCB0aGUgRklGTyBkZWxp\ndmVyeSBtYW5hZ2VyIGV4ZWN1dGVzIHN0b3BTZXJ2aW5nIGFuZCBzdGFydFNl\ncnZpbmcKICAgICAqIGluIHRoZSBjb3JyZWN0IG9yZGVyCiAgICAgKiB7QGxp\nbmsgaHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9CT09L\nS0VFUEVSLTUzOX0KICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lk\nIHRlc3RGSUZPRGVsaXZlcnlTdWJDbG9zZVN1YlJhY2UoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBu\nZXcgU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAgIEJ5dGVTdHJpbmcg\ndG9waWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgic3ViUmFjZVRvcGlj\nIik7CiAgICAgICAgQnl0ZVN0cmluZyBzdWJzY3JpYmVyID0gQnl0ZVN0cmlu\nZy5jb3B5RnJvbVV0ZjgoInN1YlJhY2VTdWJzY3JpYmVyIik7CgogICAgICAg\nIFBlcnNpc3RlbmNlTWFuYWdlciBwbSA9IG5ldyBTdHViUGVyc2lzdGVuY2VN\nYW5hZ2VyKCk7CiAgICAgICAgRklGT0RlbGl2ZXJ5TWFuYWdlciBmZG0gPSBu\nZXcgRklGT0RlbGl2ZXJ5TWFuYWdlcihwbSwgY29uZik7CiAgICAgICAgRXhl\nY3V0b3JEZWxpdmVyeUVuZFBvaW50V2l0aFF1ZXVlIGRlcCA9IG5ldyBFeGVj\ndXRvckRlbGl2ZXJ5RW5kUG9pbnRXaXRoUXVldWUoKTsKICAgICAgICBTdWJz\nY3JpcHRpb25QcmVmZXJlbmNlcyBwcmVmcyA9IFN1YnNjcmlwdGlvblByZWZl\ncmVuY2VzLm5ld0J1aWxkZXIoKS5idWlsZCgpOwoKICAgICAgICBQaXBlbGlu\nZUZpbHRlciBmaWx0ZXIgPSBuZXcgUGlwZWxpbmVGaWx0ZXIoKTsKICAgICAg\nICBmaWx0ZXIuYWRkTGFzdChuZXcgQWxsVG9BbGxUb3BvbG9neUZpbHRlcigp\nKTsKICAgICAgICBmaWx0ZXIuaW5pdGlhbGl6ZShjb25mLmdldENvbmYoKSk7\nCiAgICAgICAgZmlsdGVyLnNldFN1YnNjcmlwdGlvblByZWZlcmVuY2VzKHRv\ncGljLCBzdWJzY3JpYmVyLCBwcmVmcyk7CiAgICAgICAgTWVzc2FnZVNlcUlk\nIHN0YXJ0SWQgPSBNZXNzYWdlU2VxSWQubmV3QnVpbGRlcigpLnNldExvY2Fs\nQ29tcG9uZW50KDEpLmJ1aWxkKCk7CgogICAgICAgIENvdW50RG93bkxhdGNo\nIGwgPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgTWVzc2FnZSBt\nID0gTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keShCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOChTdHJpbmcudmFsdWVPZigxKSkpLmJ1aWxkKCk7CiAgICAg\nICAgVGVzdENhbGxiYWNrIGNiID0gbmV3IFRlc3RDYWxsYmFjayhsKTsKICAg\nICAgICBwbS5wZXJzaXN0TWVzc2FnZShuZXcgUGVyc2lzdFJlcXVlc3QodG9w\naWMsIG0sIGNiLCBudWxsKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiUGVyc2lz\ndGVuY2UgbmV2ZXIgZmluaXNoZWQiLCBsLmF3YWl0KDEwLCBUaW1lVW5pdC5T\nRUNPTkRTKSk7CgogICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIG9wbGF0\nY2ggPSBuZXcgQ291bnREb3duTGF0Y2goMyk7CiAgICAgICAgZmRtLnN0YXJ0\nKCk7CiAgICAgICAgZmRtLnN0YXJ0U2VydmluZ1N1YnNjcmlwdGlvbih0b3Bp\nYywgc3Vic2NyaWJlciwgcHJlZnMsIHN0YXJ0SWQsIGRlcCwgZmlsdGVyLAog\nICAgICAgICAgICAgICAgbmV3IENhbGxiYWNrPFZvaWQ+KCkgewogICAgICAg\nICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9p\nZCByZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIG9wbGF0Y2gu\nY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBQdWJTdWJF\neGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICBvcGxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9LCBudWxsKTsKICAgICAgICBmZG0uc3RvcFNl\ncnZpbmdTdWJzY3JpYmVyKHRvcGljLCBzdWJzY3JpYmVyLCBudWxsLAogICAg\nICAgICAgICAgICAgbmV3IENhbGxiYWNrPFZvaWQ+KCkgewogICAgICAgICAg\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9pZCBy\nZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIG9wbGF0Y2guY291\nbnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBQdWJTdWJFeGNl\ncHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBv\ncGxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9LCBudWxsKTsKICAgICAgICBmZG0uc3RhcnRTZXJ2\naW5nU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJzY3JpYmVyLCBwcmVmcywgc3Rh\ncnRJZCwgZGVwLCBmaWx0ZXIsCiAgICAgICAgICAgICAgICBuZXcgQ2FsbGJh\nY2s8Vm9pZD4oKSB7CiAgICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5p\nc2hlZChPYmplY3QgY3R4LCBWb2lkIHJlc3VsdCkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgb3BsYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVk\nKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgIG9wbGF0Y2guY291bnREb3duKCk7CiAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIG51bGwp\nOwoKICAgICAgICBhc3NlcnRUcnVlKCJPcHMgbmV2ZXIgZmluaXNoZWQiLCBv\ncGxhdGNoLmF3YWl0KDEwLCBUaW1lVW5pdC5TRUNPTkRTKSk7CiAgICAgICAg\naW50IHNlY29uZHMgPSA1OwogICAgICAgIHdoaWxlIChkZXAuZ2V0TnVtUmVz\ncG9uc2VzKCkgPCAyKSB7CiAgICAgICAgICAgIGlmIChzZWNvbmRzLS0gPT0g\nMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgVGhyZWFkLnNsZWVwKDEwMDApOwogICAgICAgIH0KICAgICAg\nICBQdWJTdWJSZXNwb25zZSByID0gZGVwLmdldE5leHRSZXNwb25zZSgpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoIlRoZXJlIHNob3VsZCBiZSBhIHJlc3Bv\nbnNlIiwgcik7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiUmVzcG9uc2Ugc2hvdWxk\nIGNvbnRhaW4gYSBtZXNzYWdlIiwgci5oYXNNZXNzYWdlKCkpOwogICAgICAg\nIHIgPSBkZXAuZ2V0TmV4dFJlc3BvbnNlKCk7CiAgICAgICAgYXNzZXJ0Tm90\nTnVsbCgiVGhlcmUgc2hvdWxkIGJlIGEgcmVzcG9uc2UiLCByKTsKICAgICAg\nICBhc3NlcnRUcnVlKCJSZXNwb25zZSBzaG91bGQgY29udGFpbiBhIG1lc3Nh\nZ2UiLCByLmhhc01lc3NhZ2UoKSk7CiAgICAgICAgciA9IGRlcC5nZXROZXh0\nUmVzcG9uc2UoKTsKICAgICAgICBhc3NlcnROdWxsKCJUaGVyZSBzaG91bGQg\nb25seSBiZSAyIHJlc3BvbnNlcyIsIHIpOwogICAgfQoKICAgIHN0YXRpYyBj\nbGFzcyBFeGVjdXRvckRlbGl2ZXJ5RW5kUG9pbnQgaW1wbGVtZW50cyBEZWxp\ndmVyeUVuZFBvaW50IHsKICAgICAgICBTY2hlZHVsZWRFeGVjdXRvclNlcnZp\nY2UgZXhlY3V0b3IgPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhyZWFkU2NoZWR1\nbGVkRXhlY3V0b3IoKTsKICAgICAgICBBdG9taWNJbnRlZ2VyIG51bURlbGl2\nZXJlZCA9IG5ldyBBdG9taWNJbnRlZ2VyKCk7CiAgICAgICAgZmluYWwgRGVs\naXZlcnlNYW5hZ2VyIGRtOwoKICAgICAgICBFeGVjdXRvckRlbGl2ZXJ5RW5k\nUG9pbnQoRGVsaXZlcnlNYW5hZ2VyIGRtKSB7CiAgICAgICAgICAgIHRoaXMu\nZG0gPSBkbTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNlbmQo\nZmluYWwgUHViU3ViUmVzcG9uc2UgcmVzcG9uc2UsIGZpbmFsIERlbGl2ZXJ5\nQ2FsbGJhY2sgY2FsbGJhY2spIHsKICAgICAgICAgICAgZXhlY3V0b3Iuc3Vi\nbWl0KG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAgICAgICBwdWJs\naWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChy\nZXNwb25zZS5oYXNNZXNzYWdlKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIE1lc3NhZ2VTZXFJZCBtc2dpZCA9IHJlc3BvbnNlLmdldE1lc3Nh\nZ2UoKS5nZXRNc2dJZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKChtc2dpZC5nZXRMb2NhbENvbXBvbmVudCgpICUgMikgPT0gMSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRtLm1lc3NhZ2VDb25z\ndW1lZChyZXNwb25zZS5nZXRUb3BpYygpLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuZ2V0U3Vic2NyaWJlcklk\nKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBy\nZXNwb25zZS5nZXRNZXNzYWdlKCkuZ2V0TXNnSWQoKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGV4ZWN1dG9yLnNjaGVkdWxlKG5ldyBSdW5uYWJsZSgp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBkbS5tZXNzYWdlQ29uc3VtZWQocmVzcG9uc2Uu\nZ2V0VG9waWMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmdldFN1YnNjcmliZXJJZCgp\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgcmVzcG9uc2UuZ2V0TWVzc2FnZSgpLmdldE1zZ0lkKCkpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxLCBUaW1lVW5p\ndC5TRUNPTkRTKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAg\nICBudW1EZWxpdmVyZWQuaW5jcmVtZW50QW5kR2V0KCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGNhbGxiYWNrLnNlbmRpbmdGaW5pc2hlZCgpOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgICAg\nIGV4ZWN1dG9yLnNodXRkb3duKCk7CiAgICAgICAgfQoKICAgICAgICBpbnQg\nZ2V0TnVtRGVsaXZlcmVkKCkgewogICAgICAgICAgICByZXR1cm4gbnVtRGVs\naXZlcmVkLmdldCgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFRlc3QgdGhyb3R0bGUgcmFjZSBpc3N1ZSBjYXVzZSBieSBtZXNzYWdlQ29u\nc3VtZWQgYW5kIGRvRGVsaXZlck5leHRNZXNzYWdlCiAgICAgKiB7QGxpbmsg\naHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9CT09LS0VF\nUEVSLTUwM30KICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRl\nc3RGSUZPRGVsaXZlcnlUaHJvdHRsaW5nUmFjZSgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIGZpbmFsIGludCBudW1NZXNzYWdlcyA9IDIwOwogICAg\nICAgIGZpbmFsIGludCB0aHJvdHRsZVNpemUgPSAxMDsKICAgICAgICBTZXJ2\nZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlv\nbigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAg\nICAgcHVibGljIGludCBnZXREZWZhdWx0TWVzc2FnZVdpbmRvd1NpemUoKSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRocm90dGxlU2l6ZTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICBCeXRlU3Ry\naW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoInRocm90dGxp\nbmdSYWNlVG9waWMiKTsKICAgICAgICBCeXRlU3RyaW5nIHN1YnNjcmliZXIg\nPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgidGhyb3R0bGluZ1JhY2VTdWJz\nY3JpYmVyIik7CgogICAgICAgIFBlcnNpc3RlbmNlTWFuYWdlciBwbSA9IG5l\ndyBTdHViUGVyc2lzdGVuY2VNYW5hZ2VyKCk7CiAgICAgICAgRklGT0RlbGl2\nZXJ5TWFuYWdlciBmZG0gPSBuZXcgRklGT0RlbGl2ZXJ5TWFuYWdlcihwbSwg\nY29uZik7CiAgICAgICAgRXhlY3V0b3JEZWxpdmVyeUVuZFBvaW50IGRlcCA9\nIG5ldyBFeGVjdXRvckRlbGl2ZXJ5RW5kUG9pbnQoZmRtKTsKICAgICAgICBT\ndWJzY3JpcHRpb25QcmVmZXJlbmNlcyBwcmVmcyA9IFN1YnNjcmlwdGlvblBy\nZWZlcmVuY2VzLm5ld0J1aWxkZXIoKS5idWlsZCgpOwoKICAgICAgICBQaXBl\nbGluZUZpbHRlciBmaWx0ZXIgPSBuZXcgUGlwZWxpbmVGaWx0ZXIoKTsKICAg\nICAgICBmaWx0ZXIuYWRkTGFzdChuZXcgQWxsVG9BbGxUb3BvbG9neUZpbHRl\ncigpKTsKICAgICAgICBmaWx0ZXIuaW5pdGlhbGl6ZShjb25mLmdldENvbmYo\nKSk7CiAgICAgICAgZmlsdGVyLnNldFN1YnNjcmlwdGlvblByZWZlcmVuY2Vz\nKHRvcGljLCBzdWJzY3JpYmVyLCBwcmVmcyk7CgogICAgICAgIENvdW50RG93\nbkxhdGNoIGwgPSBuZXcgQ291bnREb3duTGF0Y2gobnVtTWVzc2FnZXMpOwoK\nICAgICAgICBUZXN0Q2FsbGJhY2sgZmlyc3RDYWxsYmFjayA9IG51bGw7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1NZXNzYWdlczsgaSsrKSB7\nCiAgICAgICAgICAgIE1lc3NhZ2UgbSA9IE1lc3NhZ2UubmV3QnVpbGRlcigp\nLnNldEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoU3RyaW5nLnZhbHVl\nT2YoaSkpKS5idWlsZCgpOwogICAgICAgICAgICBUZXN0Q2FsbGJhY2sgY2Ig\nPSBuZXcgVGVzdENhbGxiYWNrKGwpOwogICAgICAgICAgICBpZiAoZmlyc3RD\nYWxsYmFjayA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBmaXJzdENhbGxi\nYWNrID0gY2I7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcG0ucGVyc2lz\ndE1lc3NhZ2UobmV3IFBlcnNpc3RSZXF1ZXN0KHRvcGljLCBtLCBjYiwgbnVs\nbCkpOwogICAgICAgIH0KICAgICAgICBmZG0uc3RhcnQoKTsKICAgICAgICBh\nc3NlcnRUcnVlKCJQZXJzaXN0ZW5jZSBuZXZlciBmaW5pc2hlZCIsIGwuYXdh\naXQoMTAsIFRpbWVVbml0LlNFQ09ORFMpKTsKICAgICAgICBmZG0uc3RhcnRT\nZXJ2aW5nU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJzY3JpYmVyLCBwcmVmcywg\nZmlyc3RDYWxsYmFjay5nZXRJZCgpLCBkZXAsIGZpbHRlciwKICAgICAgICAg\nICAgICAgIG5ldyBDYWxsYmFjazxWb2lkPigpIHsKICAgICAgICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZvaWQgcmVzdWx0\nKSB7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBQdWJTdWJFeGNlcHRpb24g\nZXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3Vs\nZCBub3QgaGFwcGVuZWQKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfSwgbnVsbCk7CgogICAgICAgIGludCBjb3VudCA9IDMwOyAv\nLyB3YWl0IGZvciAzMCBzZWNvbmRzIG1heGltdW0KICAgICAgICB3aGlsZSAo\nZGVwLmdldE51bURlbGl2ZXJlZCgpIDwgbnVtTWVzc2FnZXMpIHsKICAgICAg\nICAgICAgVGhyZWFkLnNsZWVwKDEwMDApOwogICAgICAgICAgICBpZiAoY291\nbnQtLSA9PSAwKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBo\nYXZlIGRlbGl2ZXJlZCAiICsgbnVtTWVzc2FnZXMsIG51bU1lc3NhZ2VzLCBk\nZXAuZ2V0TnVtRGVsaXZlcmVkKCkpOwogICAgfQoKfQo=\n","encoding":"base64"}

