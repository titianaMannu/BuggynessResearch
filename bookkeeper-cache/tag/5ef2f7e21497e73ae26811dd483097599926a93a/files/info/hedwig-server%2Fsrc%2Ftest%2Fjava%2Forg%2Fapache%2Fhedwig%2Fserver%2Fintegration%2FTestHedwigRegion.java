{"sha":"e20b55051cff7d8911166709e3d691eac6482d99","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTIwYjU1MDUxY2ZmN2Q4OTExMTY2NzA5ZTNkNjkxZWFjNjQ4MmQ5OQ==","size":13077,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e20b55051cff7d8911166709e3d691eac6482d99","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaW50ZWdyYXRpb247Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5SYW5kb207CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TeW5jaHJv\nbm91c1F1ZXVlOwoKaW1wb3J0IG9yZy5qdW5pdC5BZnRlcjsKaW1wb3J0IG9y\nZy5qdW5pdC5CZWZvcmU7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKaW1wb3J0\nIG9yZy5qdW5pdC5ydW5uZXIuUnVuV2l0aDsKaW1wb3J0IG9yZy5qdW5pdC5y\ndW5uZXJzLlBhcmFtZXRlcml6ZWQ7CmltcG9ydCBvcmcuanVuaXQucnVubmVy\ncy5QYXJhbWV0ZXJpemVkLlBhcmFtZXRlcnM7CgppbXBvcnQgY29tLmdvb2ds\nZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmNsaWVudC5hcGkuUHVibGlzaGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1l\nc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLkhlZHdpZ1JlZ2lvblRl\nc3RCYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1v\nbi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLmludGVncmF0aW9uLlRlc3RIZWR3aWdIdWIuVGVzdENhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmludGVncmF0\naW9uLlRlc3RIZWR3aWdIdWIuVGVzdE1lc3NhZ2VIYW5kbGVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5IZWR3aWdTb2NrZXRBZGRyZXNzOwoK\nQFJ1bldpdGgoUGFyYW1ldGVyaXplZC5jbGFzcykKcHVibGljIGNsYXNzIFRl\nc3RIZWR3aWdSZWdpb24gZXh0ZW5kcyBIZWR3aWdSZWdpb25UZXN0QmFzZSB7\nCgogICAgLy8gU3luY2hyb25vdXNRdWV1ZXMgdG8gdmVyaWZ5IGFzeW5jIGNh\nbGxzCiAgICBwcml2YXRlIGZpbmFsIFN5bmNocm9ub3VzUXVldWU8Qm9vbGVh\nbj4gcXVldWUgPSBuZXcgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPigpOwog\nICAgcHJpdmF0ZSBmaW5hbCBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNv\nbnN1bWVRdWV1ZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFRFU1RfUkVUUllfUkVN\nT1RFX1NVQlNDUklCRV9JTlRFUlZBTF9WQUxVRSA9IDMwMDA7CgogICAgcHJv\ndGVjdGVkIGNsYXNzIE5ld1JlZ2lvblNlcnZlckNvbmZpZ3VyYXRpb24gZXh0\nZW5kcyBSZWdpb25TZXJ2ZXJDb25maWd1cmF0aW9uIHsKCiAgICAgICAgcHVi\nbGljIE5ld1JlZ2lvblNlcnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBv\ncnQsIGludCBzc2xTZXJ2ZXJQb3J0LAogICAgICAgICAgICAgICAgU3RyaW5n\nIHJlZ2lvbk5hbWUpIHsKICAgICAgICAgICAgc3VwZXIoc2VydmVyUG9ydCwg\nc3NsU2VydmVyUG9ydCwgcmVnaW9uTmFtZSk7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50IGdldFJldHJ5UmVtb3Rl\nU3Vic2NyaWJlVGhyZWFkUnVuSW50ZXJ2YWwoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBURVNUX1JFVFJZX1JFTU9URV9TVUJTQ1JJQkVfSU5URVJWQUxfVkFM\nVUU7CiAgICAgICAgfQoKICAgIH0KCiAgICBwcm90ZWN0ZWQgY2xhc3MgTmV3\nUmVnaW9uQ2xpZW50Q29uZmlndXJhdGlvbiBleHRlbmRzIENsaWVudENvbmZp\nZ3VyYXRpb24gewogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBi\nb29sZWFuIGlzU3Vic2NyaXB0aW9uQ2hhbm5lbFNoYXJpbmdFbmFibGVkKCkg\newogICAgICAgICAgICByZXR1cm4gaXNTdWJzY3JpcHRpb25DaGFubmVsU2hh\ncmluZ0VuYWJsZWQ7CiAgICAgICAgfQogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyBIZWR3aWdTb2NrZXRBZGRyZXNzIGdldERlZmF1bHRTZXJ2\nZXJIZWR3aWdTb2NrZXRBZGRyZXNzKCkgewogICAgICAgICAgICByZXR1cm4g\ncmVnaW9uSHViQWRkcmVzc2VzLmdldCgwKS5nZXQoMCk7CiAgICAgICAgfQog\nICAgfQoKICAgIHByb3RlY3RlZCBTZXJ2ZXJDb25maWd1cmF0aW9uIGdldFNl\ncnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2\nZXJQb3J0LCBTdHJpbmcgcmVnaW9uTmFtZSkgewogICAgICAgIHJldHVybiBu\nZXcgTmV3UmVnaW9uU2VydmVyQ29uZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBz\nc2xTZXJ2ZXJQb3J0LCByZWdpb25OYW1lKTsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgQ2xpZW50Q29uZmlndXJhdGlvbiBnZXRSZWdpb25DbGllbnRDb25maWd1\ncmF0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgTmV3UmVnaW9uQ2xpZW50\nQ29uZmlndXJhdGlvbigpOwogICAgfQoKICAgIEBQYXJhbWV0ZXJzCiAgICBw\ndWJsaWMgc3RhdGljIENvbGxlY3Rpb248T2JqZWN0W10+IGNvbmZpZ3MoKSB7\nCiAgICAgICAgcmV0dXJuIEFycmF5cy5hc0xpc3QobmV3IE9iamVjdFtdW10g\neyB7IGZhbHNlIH0sIHsgdHJ1ZSB9IH0pOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBib29sZWFuIGlzU3Vic2NyaXB0aW9uQ2hhbm5lbFNoYXJpbmdFbmFibGVk\nOwoKICAgIHB1YmxpYyBUZXN0SGVkd2lnUmVnaW9uKGJvb2xlYW4gaXNTdWJz\nY3JpcHRpb25DaGFubmVsU2hhcmluZ0VuYWJsZWQpIHsKICAgICAgICB0aGlz\nLmlzU3Vic2NyaXB0aW9uQ2hhbm5lbFNoYXJpbmdFbmFibGVkID0gaXNTdWJz\nY3JpcHRpb25DaGFubmVsU2hhcmluZ0VuYWJsZWQ7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBAQmVmb3JlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIG51bVJlZ2lvbnMgPSAzOwogICAg\nICAgIG51bVNlcnZlcnNQZXJSZWdpb24gPSA0OwogICAgICAgIHN1cGVyLnNl\ndFVwKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBAQWZ0ZXIKICAgIHB1\nYmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgc3VwZXIudGVhckRvd24oKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0\nPTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdE11bHRpUmVnaW9uU3Vic2Ny\naWJlQW5kQ29uc3VtZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlu\ndCBiYXRjaFNpemUgPSAxMDsKICAgICAgICAvLyBTdWJzY3JpYmUgdG8gdG9w\naWNzIGZvciBjbGllbnRzIGluIGFsbCByZWdpb25zCiAgICAgICAgZm9yIChI\nZWR3aWdDbGllbnQgY2xpZW50IDogcmVnaW9uQ2xpZW50c01hcC52YWx1ZXMo\nKSkgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6\nZTsgaSsrKSB7CiAgICAgICAgICAgICAgICBjbGllbnQuZ2V0U3Vic2NyaWJl\ncigpLmFzeW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJU\nb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0Zjgo\nIkxvY2FsU3Vic2NyaWJlciIpLCBDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1Jf\nQVRUQUNILAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVs\nbCk7CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFN0YXJ0IGRl\nbGl2ZXJ5IGZvciB0aGUgbG9jYWwgc3Vic2NyaWJlcnMgaW4gYWxsIHJlZ2lv\nbnMKICAgICAgICBmb3IgKEhlZHdpZ0NsaWVudCBjbGllbnQgOiByZWdpb25D\nbGllbnRzTWFwLnZhbHVlcygpKSB7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGNs\naWVudC5nZXRTdWJzY3JpYmVyKCkuc3RhcnREZWxpdmVyeShCeXRlU3RyaW5n\nLmNvcHlGcm9tVXRmOCgiVG9waWMiICsgaSksCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmlu\nZy5jb3B5RnJvbVV0ZjgoIkxvY2FsU3Vic2NyaWJlciIpLCBuZXcgVGVzdE1l\nc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICAvLyBOb3cgc3RhcnQgcHVibGlzaGluZyBtZXNz\nYWdlcyBmb3IgdGhlIHN1YnNjcmliZWQgdG9waWNzIGluIG9uZSBvZiB0aGUK\nICAgICAgICAvLyByZWdpb25zIGFuZCB2ZXJpZnkgdGhhdCBpdCBnZXRzIGRl\nbGl2ZXJlZCBhbmQgY29uc3VtZWQgaW4gYWxsIG9mIHRoZQogICAgICAgIC8v\nIG90aGVyIG9uZXMuCiAgICAgICAgUHVibGlzaGVyIHB1Ymxpc2hlciA9IHJl\nZ2lvbkNsaWVudHNNYXAudmFsdWVzKCkuaXRlcmF0b3IoKS5uZXh0KCkuZ2V0\nUHVibGlzaGVyKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRj\naFNpemU7IGkrKykgewogICAgICAgICAgICBwdWJsaXNoZXIuYXN5bmNQdWJs\naXNoKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUb3BpYyIgKyBpKSwgTWVz\nc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keSgKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0Zjgo\nIk1lc3NhZ2UiICsgaSkpLmJ1aWxkKCksIG5ldyBUZXN0Q2FsbGJhY2socXVl\ndWUpLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtl\nKCkpOwogICAgICAgIH0KICAgICAgICAvLyBNYWtlIHN1cmUgZWFjaCByZWdp\nb24gY29uc3VtZXMgdGhlIHNhbWUgc2V0IG9mIHB1Ymxpc2hlZCBtZXNzYWdl\ncy4KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJlZ2lvbkNsaWVudHNN\nYXAuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7\nIGogPCBiYXRjaFNpemU7IGorKykgewogICAgICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgcmVnaW9uIHNodXRz\nIGRvd24gd2hlbiBmaXJzdCBzdWJzY3JpcHRpb24uCiAgICAgKgogICAgICog\nQHRocm93cyBFeGNlcHRpb24KICAgICAqLwogICAgQFRlc3QodGltZW91dD02\nMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTdWJzY3JpYmVBbmRDb25zdW1l\nV2hlbkFSZWdpb25Eb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\naW50IGJhdGNoU2l6ZSA9IDEwOwoKICAgICAgICAvLyBmaXJzdCBzaHV0IGRv\nd24gYSByZWdpb24KICAgICAgICBSYW5kb20gciA9IG5ldyBSYW5kb20oKTsK\nICAgICAgICBpbnQgcmVnaW9uSWQgPSByLm5leHRJbnQobnVtUmVnaW9ucyk7\nCiAgICAgICAgc3RvcFJlZ2lvbihyZWdpb25JZCk7CiAgICAgICAgLy8gc3Vi\nc2NyaWJlIHRvIHRvcGljcyB3aGVuIGEgcmVnaW9uIHNodXRzIGRvd24KICAg\nICAgICBmb3IgKEhlZHdpZ0NsaWVudCBjbGllbnQgOiByZWdpb25DbGllbnRz\nTWFwLnZhbHVlcygpKSB7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIGNsaWVudC5n\nZXRTdWJzY3JpYmVyKCkuYXN5bmNTdWJzY3JpYmUoQnl0ZVN0cmluZy5jb3B5\nRnJvbVV0ZjgoIlRvcGljIiArIGkpLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOCgiTG9jYWxTdWJzY3JpYmVyIiksIENyZWF0ZU9yQXR0YWNo\nLkNSRUFURV9PUl9BVFRBQ0gsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBUZXN0Q2FsbGJhY2so\ncXVldWUpLCBudWxsKTsKICAgICAgICAgICAgICAgIGFzc2VydEZhbHNlKHF1\nZXVlLnRha2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8vIHN0YXJ0IHJlZ2lvbiBnYWluCiAgICAgICAgc3RhcnRSZWdpb24ocmVn\naW9uSWQpOwoKICAgICAgICAvLyBzdWIgaXQgYWdhaW4KICAgICAgICBmb3Ig\nKE1hcC5FbnRyeTxTdHJpbmcsIEhlZHdpZ0NsaWVudD4gZW50cnkgOiByZWdp\nb25DbGllbnRzTWFwLmVudHJ5U2V0KCkpIHsKICAgICAgICAgICAgSGVkd2ln\nQ2xpZW50IGNsaWVudCA9IGVudHJ5LmdldFZhbHVlKCk7CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAg\nICAgICAgICAgIGNsaWVudC5nZXRTdWJzY3JpYmVyKCkuYXN5bmNTdWJzY3Jp\nYmUoQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRvcGljIiArIGkpLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiTG9jYWxTdWJzY3JpYmVy\nIiksIENyZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICAgICAg\nICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgLy8gU3RhcnQgZGVsaXZlcnkgZm9yIGxvY2Fs\nIHN1YnNjcmliZXJzIGluIGFsbCByZWdpb25zCiAgICAgICAgZm9yIChNYXAu\nRW50cnk8U3RyaW5nLCBIZWR3aWdDbGllbnQ+IGVudHJ5IDogcmVnaW9uQ2xp\nZW50c01hcC5lbnRyeVNldCgpKSB7CiAgICAgICAgICAgIEhlZHdpZ0NsaWVu\ndCBjbGllbnQgPSBlbnRyeS5nZXRWYWx1ZSgpOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAg\nICAgICBjbGllbnQuZ2V0U3Vic2NyaWJlcigpLnN0YXJ0RGVsaXZlcnkoQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRvcGljIiArIGkpLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KCJMb2NhbFN1YnNjcmliZXIiKSwgbmV3\nIFRlc3RNZXNzYWdlSGFuZGxlcihjb25zdW1lUXVldWUpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gTm93IHN0YXJ0IHB1Ymxpc2hp\nbmcgbWVzc2FnZXMgZm9yIHRoZSBzdWJzY3JpYmVkIHRvcGljcyBpbiBvbmUg\nb2YgdGhlCiAgICAgICAgLy8gcmVnaW9ucyBhbmQgdmVyaWZ5IHRoYXQgaXQg\nZ2V0cyBkZWxpdmVyZWQgYW5kIGNvbnN1bWVkIGluIGFsbCBvZiB0aGUKICAg\nICAgICAvLyBvdGhlciBvbmVzLgogICAgICAgIGludCByaWQgPSByLm5leHRJ\nbnQobnVtUmVnaW9ucyk7CiAgICAgICAgU3RyaW5nIHJlZ2lvbk5hbWUgPSBS\nRUdJT05fUFJFRklYICsgcmlkOwogICAgICAgIFB1Ymxpc2hlciBwdWJsaXNo\nZXIgPSByZWdpb25DbGllbnRzTWFwLmdldChyZWdpb25OYW1lKS5nZXRQdWJs\naXNoZXIoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6\nZTsgaSsrKSB7CiAgICAgICAgICAgIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2go\nQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRvcGljIiArIGkpLCBNZXNzYWdl\nLm5ld0J1aWxkZXIoKS5zZXRCb2R5KAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KHJlZ2lvbk5h\nbWUgKyAiLU1lc3NhZ2UiICsgaSkpLmJ1aWxkKCksIG5ldyBUZXN0Q2FsbGJh\nY2socXVldWUpLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1\nZS50YWtlKCkpOwogICAgICAgIH0KICAgICAgICAvLyBNYWtlIHN1cmUgZWFj\naCByZWdpb24gY29uc3VtZXMgdGhlIHNhbWUgc2V0IG9mIHB1Ymxpc2hlZCBt\nZXNzYWdlcy4KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJlZ2lvbkNs\naWVudHNNYXAuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgZm9yIChpbnQg\naiA9IDA7IGogPCBiYXRjaFNpemU7IGorKykgewogICAgICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgcmVnaW9u\nIHNodXRzIGRvd24gd2hlbiBhdHRhY2hpbmcgZXhpc3Rpbmcgc3Vic2NyaXB0\naW9ucy4KICAgICAqCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICov\nCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVz\ndEF0dGFjaEV4aXN0aW5nU3Vic2NyaXB0aW9uc1doZW5BUmVnaW9uRG93bigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBiYXRjaFNpemUgPSAx\nMDsKICAgICAgICAKICAgICAgICAvLyBzdWIgaXQgcmVtb3RlbHkgdG8gbWFr\nZSBzdWJzY3JpcHRpb25zIGV4aXN0ZWQKICAgICAgICBmb3IgKE1hcC5FbnRy\neTxTdHJpbmcsIEhlZHdpZ0NsaWVudD4gZW50cnkgOiByZWdpb25DbGllbnRz\nTWFwLmVudHJ5U2V0KCkpIHsKICAgICAgICAgICAgSGVkd2lnQ2xpZW50IGNs\naWVudCA9IGVudHJ5LmdldFZhbHVlKCk7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAgICAg\nIGNsaWVudC5nZXRTdWJzY3JpYmVyKCkuYXN5bmNTdWJzY3JpYmUoQnl0ZVN0\ncmluZy5jb3B5RnJvbVV0ZjgoIlRvcGljIiArIGkpLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRl\nU3RyaW5nLmNvcHlGcm9tVXRmOCgiTG9jYWxTdWJzY3JpYmVyIiksIENyZWF0\nZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBUZXN0\nQ2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICAgICAgICAgIGFzc2Vy\ndFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgLy8gc3RvcCByZWdpb25zCiAgICAgICAgZm9yIChpbnQgaT0w\nOyBpPG51bVJlZ2lvbnM7IGkrKykgewogICAgICAgICAgICBzdG9wUmVnaW9u\nKGkpOwogICAgICAgIH0KICAgICAgICAvLyBzdGFydCByZWdpb25zIGFnYWlu\nCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bVJlZ2lvbnM7IGkrKykgewog\nICAgICAgICAgICBzdGFydFJlZ2lvbihpKTsKICAgICAgICB9CgogICAgICAg\nIC8vIGZpcnN0IHNodXQgZG93biBhIHJlZ2lvbgogICAgICAgIFJhbmRvbSBy\nID0gbmV3IFJhbmRvbSgpOwogICAgICAgIGludCByZWdpb25JZCA9IHIubmV4\ndEludChudW1SZWdpb25zKTsKICAgICAgICBzdG9wUmVnaW9uKHJlZ2lvbklk\nKTsKICAgICAgICAvLyBzdWJzY3JpYmUgdG8gdG9waWNzIHdoZW4gYSByZWdp\nb24gc2h1dHMgZG93bgogICAgICAgIC8vIGl0IHNob3VsZCBzdWNjZWVkIHNp\nbmNlIHRoZSBzdWJzY3JpcHRpb25zIGV4aXN0ZWQgYmVmb3JlCiAgICAgICAg\nZm9yIChIZWR3aWdDbGllbnQgY2xpZW50IDogcmVnaW9uQ2xpZW50c01hcC52\nYWx1ZXMoKSkgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJh\ndGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgICAgICBjbGllbnQuZ2V0U3Vi\nc2NyaWJlcigpLmFzeW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21V\ndGY4KCJUb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJv\nbVV0ZjgoIkxvY2FsU3Vic2NyaWJlciIpLCBDcmVhdGVPckF0dGFjaC5DUkVB\nVEVfT1JfQVRUQUNILAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBuZXcgVGVzdENhbGxiYWNrKHF1ZXVl\nKSwgbnVsbCk7CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRh\na2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFN0\nYXJ0IGRlbGl2ZXJ5IGZvciBsb2NhbCBzdWJzY3JpYmVycyBpbiBhbGwgcmVn\naW9ucwogICAgICAgIGZvciAoTWFwLkVudHJ5PFN0cmluZywgSGVkd2lnQ2xp\nZW50PiBlbnRyeSA6IHJlZ2lvbkNsaWVudHNNYXAuZW50cnlTZXQoKSkgewog\nICAgICAgICAgICBIZWR3aWdDbGllbnQgY2xpZW50ID0gZW50cnkuZ2V0VmFs\ndWUoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRjaFNp\nemU7IGkrKykgewogICAgICAgICAgICAgICAgY2xpZW50LmdldFN1YnNjcmli\nZXIoKS5zdGFydERlbGl2ZXJ5KEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJU\nb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgi\nTG9jYWxTdWJzY3JpYmVyIiksIG5ldyBUZXN0TWVzc2FnZUhhbmRsZXIoY29u\nc3VtZVF1ZXVlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8vIHN0YXJ0IHJlZ2lvbiBhZ2FpbgogICAgICAgIHN0YXJ0UmVnaW9uKHJl\nZ2lvbklkKTsKICAgICAgICAvLyB3YWl0IGZvciByZXRyeQogICAgICAgIFRo\ncmVhZC5zbGVlcCgzICogVEVTVF9SRVRSWV9SRU1PVEVfU1VCU0NSSUJFX0lO\nVEVSVkFMX1ZBTFVFKTsKCiAgICAgICAgU3RyaW5nIHJlZ2lvbk5hbWUgPSBS\nRUdJT05fUFJFRklYICsgcmVnaW9uSWQ7CiAgICAgICAgSGVkd2lnQ2xpZW50\nIGNsaWVudCA9IHJlZ2lvbkNsaWVudHNNYXAuZ2V0KHJlZ2lvbk5hbWUpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsK\nICAgICAgICAgICAgY2xpZW50LmdldFN1YnNjcmliZXIoKS5hc3luY1N1YnNj\ncmliZShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVG9waWMiICsgaSksCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkxvY2FsU3Vic2NyaWJlciIp\nLCBDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNILAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBU\nZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgICAgICBjbGllbnQuZ2V0U3Vi\nc2NyaWJlcigpLnN0YXJ0RGVsaXZlcnkoQnl0ZVN0cmluZy5jb3B5RnJvbVV0\nZjgoIlRvcGljIiArIGkpLAogICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KCJMb2NhbFN1YnNjcmliZXIiKSwgbmV3IFRlc3RN\nZXNzYWdlSGFuZGxlcihjb25zdW1lUXVldWUpKTsKICAgICAgICB9CgogICAg\nICAgIC8vIE5vdyBzdGFydCBwdWJsaXNoaW5nIG1lc3NhZ2VzIGZvciB0aGUg\nc3Vic2NyaWJlZCB0b3BpY3MgaW4gb25lIG9mIHRoZQogICAgICAgIC8vIHJl\nZ2lvbnMgYW5kIHZlcmlmeSB0aGF0IGl0IGdldHMgZGVsaXZlcmVkIGFuZCBj\nb25zdW1lZCBpbiBhbGwgb2YgdGhlCiAgICAgICAgLy8gb3RoZXIgb25lcy4g\nICAgICAgIAogICAgICAgIFB1Ymxpc2hlciBwdWJsaXNoZXIgPSBjbGllbnQu\nZ2V0UHVibGlzaGVyKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBi\nYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICBwdWJsaXNoZXIuYXN5bmNQ\ndWJsaXNoKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUb3BpYyIgKyBpKSwg\nTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keSgKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOChy\nZWdpb25OYW1lICsgIi1NZXNzYWdlIiArIGkpKS5idWlsZCgpLCBuZXcgVGVz\ndENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgIGFzc2VydFRy\ndWUocXVldWUudGFrZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gTWFrZSBz\ndXJlIGVhY2ggcmVnaW9uIGNvbnN1bWVzIHRoZSBzYW1lIHNldCBvZiBwdWJs\naXNoZWQgbWVzc2FnZXMuCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBy\nZWdpb25DbGllbnRzTWFwLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIGZv\nciAoaW50IGogPSAwOyBqIDwgYmF0Y2hTaXplOyBqKyspIHsKICAgICAgICAg\nICAgICAgIGFzc2VydFRydWUoY29uc3VtZVF1ZXVlLnRha2UoKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

