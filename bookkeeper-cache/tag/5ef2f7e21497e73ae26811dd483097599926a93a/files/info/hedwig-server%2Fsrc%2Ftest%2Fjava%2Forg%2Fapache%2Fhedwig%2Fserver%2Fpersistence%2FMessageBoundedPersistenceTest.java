{"sha":"e54452a737f3d1a1ff41da9df1ae51f1a90d8203","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTU0NDUyYTczN2YzZDFhMWZmNDFkYTlkZjFhZTUxZjFhOTBkODIwMw==","size":11928,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e54452a737f3d1a1ff41da9df1ae51f1a90d8203","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3Jn\nLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQg\nc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LlRpbWVVbml0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJl\nbnQuYXRvbWljLkF0b21pY0ludGVnZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmNsaWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7CmltcG9ydCBjb20u\nZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nU3Vic2NyaWJlUmVxdWVzdC5DcmVhdGVPckF0dGFjaDsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlw\ndGlvbk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5MZWRnZXJSYW5nZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLkxlZGdlclJhbmdl\nczsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLkNsaWVu\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuU3Vic2Ny\naWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuUHVi\nbGlzaGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYu\nQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnV0aWwuQ2FsbGJhY2s7CgppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLkhlZHdpZ0h1YlRlc3RCYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLmNvbW1vbi5TZXJ2ZXJDb25maWd1cmF0aW9uOwoKcHVibGlj\nIGNsYXNzIE1lc3NhZ2VCb3VuZGVkUGVyc2lzdGVuY2VUZXN0IGV4dGVuZHMg\nSGVkd2lnSHViVGVzdEJhc2UgewogICAgcHJvdGVjdGVkIHN0YXRpYyBMb2dn\nZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTWVzc2FnZUJv\ndW5kZWRQZXJzaXN0ZW5jZVRlc3QuY2xhc3MpOwoKICAgIHByb3RlY3RlZCBj\nbGFzcyBTbWFsbFJlYWRBaGVhZFNlcnZlckNvbmZpZ3VyYXRpb24KICAgICAg\nICBleHRlbmRzIEhlZHdpZ0h1YlRlc3RCYXNlLkh1YlNlcnZlckNvbmZpZ3Vy\nYXRpb24gewogICAgICAgIFNtYWxsUmVhZEFoZWFkU2VydmVyQ29uZmlndXJh\ndGlvbihpbnQgc2VydmVyUG9ydCwgaW50IHNzbFNlcnZlclBvcnQpIHsKICAg\nICAgICAgICAgc3VwZXIoc2VydmVyUG9ydCwgc3NsU2VydmVyUG9ydCk7CiAg\nICAgICAgfQogICAgICAgIHB1YmxpYyBsb25nIGdldE1heGltdW1DYWNoZVNp\nemUoKSB7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGludCBnZXRSZWFkQWhlYWRDb3VudCgpIHsKICAgICAgICAg\nICAgcmV0dXJuIDE7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdl\ndE1lc3NhZ2VzQ29uc3VtZWRUaHJlYWRSdW5JbnRlcnZhbCgpIHsKICAgICAg\nICAgICAgcmV0dXJuIDEwMDA7IC8vIHJ1biBldmVyeSBzZWNvbmQKICAgICAg\nICB9CiAgICB9CgogICAgcHJvdGVjdGVkIFNlcnZlckNvbmZpZ3VyYXRpb24g\nZ2V0U2VydmVyQ29uZmlndXJhdGlvbihpbnQgc2VydmVyUG9ydCwgaW50IHNz\nbFNlcnZlclBvcnQpIHsKICAgICAgICByZXR1cm4gbmV3IFNtYWxsUmVhZEFo\nZWFkU2VydmVyQ29uZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQ\nb3J0KTsKICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIE1lc3NhZ2VCb3VuZENs\naWVudENvbmZpZ3VyYXRpb24gZXh0ZW5kcyBIdWJDbGllbnRDb25maWd1cmF0\naW9uIHsKICAgICAgICBmaW5hbCBpbnQgbWVzc2FnZUJvdW5kOwoKICAgICAg\nICBwdWJsaWMgTWVzc2FnZUJvdW5kQ2xpZW50Q29uZmlndXJhdGlvbihpbnQg\nYm91bmQpIHsKICAgICAgICAgICAgdGhpcy5tZXNzYWdlQm91bmQgPSBib3Vu\nZDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBNZXNzYWdlQm91bmRDbGll\nbnRDb25maWd1cmF0aW9uKCkgewogICAgICAgICAgICB0aGlzKDUpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIGludCBnZXRTdWJzY3JpcHRpb25NZXNz\nYWdlQm91bmQoKSB7CiAgICAgICAgICAgIHJldHVybiBtZXNzYWdlQm91bmQ7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzZW5kWEV4cGVj\ndExhc3RZKFB1Ymxpc2hlciBwdWIsIFN1YnNjcmliZXIgc3ViLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYywg\nQnl0ZVN0cmluZyBzdWJpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsIGludCBYLCBmaW5hbCBpbnQgWSkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBYOyBpKyspIHsK\nICAgICAgICAgICAgcHViLnB1Ymxpc2godG9waWMsIE1lc3NhZ2UubmV3QnVp\nbGRlcigpLnNldEJvZHkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoU3RyaW5nLnZhbHVlT2YoaSkp\nKS5idWlsZCgpKTsKICAgICAgICB9CiAgICAgICAgc3ViLnN1YnNjcmliZSh0\nb3BpYywgc3ViaWQsIENyZWF0ZU9yQXR0YWNoLkFUVEFDSCk7CgogICAgICAg\nIGZpbmFsIEF0b21pY0ludGVnZXIgZXhwZWN0ZWQgPSBuZXcgQXRvbWljSW50\nZWdlcihYIC0gWSk7CiAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggbGF0\nY2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgc3ViLnN0YXJ0\nRGVsaXZlcnkodG9waWMsIHN1YmlkLCBuZXcgTWVzc2FnZUhhbmRsZXIgKCkg\newogICAgICAgICAgICAgICAgc3luY2hyb25pemVkIHB1YmxpYyB2b2lkIGRl\nbGl2ZXIoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1lc3Nh\nZ2UgbXNnLCBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0IGNvbnRleHQpIHsKICAg\nICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAg\nICBpbnQgdmFsdWUgPSBJbnRlZ2VyLnZhbHVlT2YobXNnLmdldEJvZHkoKS50\nb1N0cmluZ1V0ZjgoKSk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\ndmFsdWUgPT0gZXhwZWN0ZWQuZ2V0KCkpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGV4cGVjdGVkLmluY3JlbWVudEFuZEdldCgpOwogICAgICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gZXJyb3IgY29uZGl0aW9uCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkRpZCBub3QgcmVjZWl2ZSBleHBl\nY3RlZCB2YWx1ZSwgZXhwZWN0ZWQge30sIGdvdCB7fSIsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQuZ2V0KCks\nIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVk\nLnNldCgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhdGNoLmNv\ndW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChleHBlY3RlZC5nZXQoKSA9PSBYKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjb250ZXh0LCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIlJlY2Vp\ndmVkIGJhZCBtZXNzYWdlIiwgZSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGxhdGNoLmNvdW50RG93bigpOy8vIHdpbGwgZXJyb3Igb24gbWF0Y2gKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0pOwogICAgICAgIGFzc2VydFRydWUoIlRpbWVkIG91dCB3YWl0aW5n\nIGZvciBtZXNzYWdlcyBZIGlzICIgKyBZCiAgICAgICAgICAgICAgICArICIg\nZXhwZWN0ZWQgaXMgY3VycmVudGx5ICIgKyBleHBlY3RlZC5nZXQoKSwgbGF0\nY2guYXdhaXQoMTAsIFRpbWVVbml0LlNFQ09ORFMpKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoIlNob3VsZCBiZSBleHBlY3RlZCBtZXNzYWdlIHdpdGggIiAr\nIFgsIFgsIGV4cGVjdGVkLmdldCgpKTsKCiAgICAgICAgc3ViLnN0b3BEZWxp\ndmVyeSh0b3BpYywgc3ViaWQpOwogICAgICAgIHN1Yi5jbG9zZVN1YnNjcmlw\ndGlvbih0b3BpYywgc3ViaWQpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9\nNjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmFzaWNCb3VuZGluZygpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIENsaWVudCBjbGllbnQgPSBuZXcg\nSGVkd2lnQ2xpZW50KG5ldyBNZXNzYWdlQm91bmRDbGllbnRDb25maWd1cmF0\naW9uKDUpKTsKICAgICAgICBQdWJsaXNoZXIgcHViID0gY2xpZW50LmdldFB1\nYmxpc2hlcigpOwogICAgICAgIFN1YnNjcmliZXIgc3ViID0gY2xpZW50Lmdl\ndFN1YnNjcmliZXIoKTsKCiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KCJiYXNpY0JvdW5kaW5nVG9waWMiKTsK\nICAgICAgICBCeXRlU3RyaW5nIHN1YmlkID0gQnl0ZVN0cmluZy5jb3B5RnJv\nbVV0ZjgoImJhc2ljQm91bmRpbmdTdWJJZCIpOwogICAgICAgIHN1Yi5zdWJz\nY3JpYmUodG9waWMsIHN1YmlkLCBDcmVhdGVPckF0dGFjaC5DUkVBVEUpOwog\nICAgICAgIHN1Yi5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwoK\nICAgICAgICBzZW5kWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3Vi\naWQsIDEwMDAsIDUpOwoKICAgICAgICBjbGllbnQuY2xvc2UoKTsKICAgIH0K\nCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVz\ndE11bHRpcGxlU3Vic2NyaWJlcnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0\nZjgoIm11bHRpU3ViVG9waWMiKTsKCiAgICAgICAgQ2xpZW50IGNsaWVudCA9\nIG5ldyBIZWR3aWdDbGllbnQobmV3IEh1YkNsaWVudENvbmZpZ3VyYXRpb24o\nKSk7CiAgICAgICAgUHVibGlzaGVyIHB1YiA9IGNsaWVudC5nZXRQdWJsaXNo\nZXIoKTsKICAgICAgICBTdWJzY3JpYmVyIHN1YiA9IGNsaWVudC5nZXRTdWJz\nY3JpYmVyKCk7CgogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0aW9u\nczUgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAg\nICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRF\nKS5zZXRNZXNzYWdlQm91bmQoNSkuYnVpbGQoKTsKICAgICAgICBTdWJzY3Jp\ncHRpb25PcHRpb25zIG9wdGlvbnMyMCA9IFN1YnNjcmlwdGlvbk9wdGlvbnMu\nbmV3QnVpbGRlcigpCiAgICAgICAgICAgIC5zZXRDcmVhdGVPckF0dGFjaChD\ncmVhdGVPckF0dGFjaC5DUkVBVEUpLnNldE1lc3NhZ2VCb3VuZCgyMCkuYnVp\nbGQoKTsKICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdGlvbnNVbmJv\ndW5kZWQgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAg\nICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JF\nQVRFKS5idWlsZCgpOwoKICAgICAgICBCeXRlU3RyaW5nIHN1YmlkNSA9IEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KCJib3VuZDVTdWJJZCIpOwogICAgICAg\nIEJ5dGVTdHJpbmcgc3ViaWQyMCA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKCJib3VuZDIwU3ViSWQiKTsKICAgICAgICBCeXRlU3RyaW5nIHN1YmlkVW5i\nb3VuZGVkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIm5vYm91bmRTdWJJ\nZCIpOwoKICAgICAgICBzdWIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZDUsIG9w\ndGlvbnM1KTsKICAgICAgICBzdWIuY2xvc2VTdWJzY3JpcHRpb24odG9waWMs\nIHN1YmlkNSk7CiAgICAgICAgc2VuZFhFeHBlY3RMYXN0WShwdWIsIHN1Yiwg\ndG9waWMsIHN1YmlkNSwgMTAwMCwgNSk7CgogICAgICAgIHN1Yi5zdWJzY3Jp\nYmUodG9waWMsIHN1YmlkMjAsIG9wdGlvbnMyMCk7CiAgICAgICAgc3ViLmNs\nb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZDIwKTsKICAgICAgICBzZW5k\nWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQyMCwgMTAwMCwg\nMjApOwoKICAgICAgICBzdWIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZFVuYm91\nbmRlZCwgb3B0aW9uc1VuYm91bmRlZCk7CiAgICAgICAgc3ViLmNsb3NlU3Vi\nc2NyaXB0aW9uKHRvcGljLCBzdWJpZFVuYm91bmRlZCk7CgogICAgICAgIHNl\nbmRYRXhwZWN0TGFzdFkocHViLCBzdWIsIHRvcGljLCBzdWJpZFVuYm91bmRl\nZCwgMTAwMDAsIDEwMDAwKTsKICAgICAgICBzdWIudW5zdWJzY3JpYmUodG9w\naWMsIHN1YmlkVW5ib3VuZGVkKTsKCiAgICAgICAgc2VuZFhFeHBlY3RMYXN0\nWShwdWIsIHN1YiwgdG9waWMsIHN1YmlkMjAsIDEwMDAsIDIwKTsKICAgICAg\nICBzdWIudW5zdWJzY3JpYmUodG9waWMsIHN1YmlkMjApOwoKICAgICAgICBz\nZW5kWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQ1LCAxMDAw\nLCA1KTsKICAgICAgICBzdWIudW5zdWJzY3JpYmUodG9waWMsIHN1YmlkNSk7\nCgogICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgfQoKICAgIEBUZXN0KHRp\nbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0VXBkYXRlTWVzc2Fn\nZUJvdW5kKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0cmlu\nZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJVcGRhdGVNZXNz\nYWdlQm91bmQiKTsKCiAgICAgICAgQ2xpZW50IGNsaWVudCA9IG5ldyBIZWR3\naWdDbGllbnQobmV3IEh1YkNsaWVudENvbmZpZ3VyYXRpb24oKSk7CiAgICAg\nICAgUHVibGlzaGVyIHB1YiA9IGNsaWVudC5nZXRQdWJsaXNoZXIoKTsKICAg\nICAgICBTdWJzY3JpYmVyIHN1YiA9IGNsaWVudC5nZXRTdWJzY3JpYmVyKCk7\nCgogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0aW9uczUgPSBTdWJz\nY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0\nQ3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFD\nSCkuc2V0TWVzc2FnZUJvdW5kKDUpLmJ1aWxkKCk7CiAgICAgICAgU3Vic2Ny\naXB0aW9uT3B0aW9ucyBvcHRpb25zMjAgPSBTdWJzY3JpcHRpb25PcHRpb25z\nLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2go\nQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuc2V0TWVzc2FnZUJv\ndW5kKDIwKS5idWlsZCgpOwogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMg\nb3B0aW9uczEwID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVyKCkK\nICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0YWNo\nLkNSRUFURV9PUl9BVFRBQ0gpLnNldE1lc3NhZ2VCb3VuZCgxMCkuYnVpbGQo\nKTsKCiAgICAgICAgQnl0ZVN0cmluZyBzdWJpZCA9IEJ5dGVTdHJpbmcuY29w\neUZyb21VdGY4KCJ1cGRhdGVTdWJJZCIpOwoKICAgICAgICBzdWIuc3Vic2Ny\naWJlKHRvcGljLCBzdWJpZCwgb3B0aW9uczUpOwogICAgICAgIHN1Yi5jbG9z\nZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwogICAgICAgIHNlbmRYRXhw\nZWN0TGFzdFkocHViLCBzdWIsIHRvcGljLCBzdWJpZCwgNTAsIDUpOwoKICAg\nICAgICAvLyB1cGRhdGUgYm91bmQgdG8gMjAKICAgICAgICBzdWIuc3Vic2Ny\naWJlKHRvcGljLCBzdWJpZCwgb3B0aW9uczIwKTsKICAgICAgICBzdWIuY2xv\nc2VTdWJzY3JpcHRpb24odG9waWMsIHN1YmlkKTsKICAgICAgICBzZW5kWEV4\ncGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQsIDUwLCAyMCk7Cgog\nICAgICAgIC8vIHVwZGF0ZSBib3VuZCB0byAxMAogICAgICAgIHN1Yi5zdWJz\nY3JpYmUodG9waWMsIHN1YmlkLCBvcHRpb25zMTApOwogICAgICAgIHN1Yi5j\nbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwogICAgICAgIHNlbmRY\nRXhwZWN0TGFzdFkocHViLCBzdWIsIHRvcGljLCBzdWJpZCwgNTAsIDEwKTsK\nCiAgICAgICAgLy8gbWVzc2FnZSBib3VuZCBpcyBub3QgcHJvdmlkZWQsIG5v\nIHVwZGF0ZQogICAgICAgIHN1Yi5zdWJzY3JpYmUodG9waWMsIHN1YmlkLCBD\ncmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKTsKICAgICAgICBzdWIu\nY2xvc2VTdWJzY3JpcHRpb24odG9waWMsIHN1YmlkKTsKICAgICAgICBzZW5k\nWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQsIDUwLCAxMCk7\nCgogICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgfQoKICAgIEBUZXN0KHRp\nbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGVkZ2VyR0MoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBDbGllbnQgY2xpZW50ID0gbmV3\nIEhlZHdpZ0NsaWVudChuZXcgTWVzc2FnZUJvdW5kQ2xpZW50Q29uZmlndXJh\ndGlvbigpKTsKICAgICAgICBQdWJsaXNoZXIgcHViID0gY2xpZW50LmdldFB1\nYmxpc2hlcigpOwogICAgICAgIFN1YnNjcmliZXIgc3ViID0gY2xpZW50Lmdl\ndFN1YnNjcmliZXIoKTsKCiAgICAgICAgU3RyaW5nIGxlZGdlcnNQYXRoID0g\nIi9oZWR3aWcvc3RhbmRhbG9uZS90b3BpY3MvdGVzdEdDVG9waWMvbGVkZ2Vy\ncyI7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29w\neUZyb21VdGY4KCJ0ZXN0R0NUb3BpYyIpOwogICAgICAgIEJ5dGVTdHJpbmcg\nc3ViaWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgidGVzdEdDU3ViSWQi\nKTsKICAgICAgICBzdWIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZCwgQ3JlYXRl\nT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCk7CiAgICAgICAgc3ViLmNsb3Nl\nU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZCk7CgogICAgICAgIGZvciAoaW50\nIGkgPSAxOyBpIDw9IDEwMDsgaSsrKSB7CiAgICAgICAgICAgIHB1Yi5wdWJs\naXNoKHRvcGljLCBNZXNzYWdlLm5ld0J1aWxkZXIoKS5zZXRCb2R5KAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcuY29weUZy\nb21VdGY4KFN0cmluZy52YWx1ZU9mKGkpKSkuYnVpbGQoKSk7CiAgICAgICAg\nfQogICAgICAgIExlZGdlclJhbmdlcyByID0gTGVkZ2VyUmFuZ2VzLnBhcnNl\nRnJvbShia3RiLmdldFpvb0tlZXBlckNsaWVudCgpLmdldERhdGEobGVkZ2Vy\nc1BhdGgsIGZhbHNlLCBudWxsKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJT\naG91bGQgb25seSBoYXZlIDEgbGVkZ2VyIHlldCIsIDEsIHIuZ2V0UmFuZ2Vz\nTGlzdCgpLnNpemUoKSk7CiAgICAgICAgbG9uZyBmaXJzdExlZGdlciA9IHIu\nZ2V0UmFuZ2VzTGlzdCgpLmdldCgwKS5nZXRMZWRnZXJJZCgpOwoKICAgICAg\nICBzdG9wSHViU2VydmVycygpOwogICAgICAgIHN0YXJ0SHViU2VydmVycygp\nOwoKICAgICAgICBwdWIucHVibGlzaCh0b3BpYywgTWVzc2FnZS5uZXdCdWls\nZGVyKCkuc2V0Qm9keSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KFN0cmluZy52YWx1ZU9mKDB4ZGVhZGJl\nZWYpKSkuYnVpbGQoKSk7CgogICAgICAgIHIgPSBMZWRnZXJSYW5nZXMucGFy\nc2VGcm9tKGJrdGIuZ2V0Wm9vS2VlcGVyQ2xpZW50KCkuZ2V0RGF0YShsZWRn\nZXJzUGF0aCwgZmFsc2UsIG51bGwpKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nIlNob3VsZCBoYXZlIDIgbGVkZ2VycyBhZnRlciByZXN0YXJ0IiwgMiwgci5n\nZXRSYW5nZXNMaXN0KCkuc2l6ZSgpKTsKCiAgICAgICAgZm9yIChpbnQgaSA9\nIDEwMDsgaSA8PSAyMDA7IGkrKykgewogICAgICAgICAgICBwdWIucHVibGlz\naCh0b3BpYywgTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keSgKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9t\nVXRmOChTdHJpbmcudmFsdWVPZihpKSkpLmJ1aWxkKCkpOwogICAgICAgIH0K\nICAgICAgICBUaHJlYWQuc2xlZXAoNTAwMCk7IC8vIGdpdmUgR0MgYSBjaGFu\nY2UgdG8gaGFwcGVuCgogICAgICAgIHIgPSBMZWRnZXJSYW5nZXMucGFyc2VG\ncm9tKGJrdGIuZ2V0Wm9vS2VlcGVyQ2xpZW50KCkuZ2V0RGF0YShsZWRnZXJz\nUGF0aCwgZmFsc2UsIG51bGwpKTsKICAgICAgICBsb25nIHNlY29uZExlZGdl\nciA9IHIuZ2V0UmFuZ2VzTGlzdCgpLmdldCgwKS5nZXRMZWRnZXJJZCgpOwoK\nICAgICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBvbmx5IGhhdmUgMSBsZWRn\nZXIgYWZ0ZXIgR0MiLCAxLCByLmdldFJhbmdlc0xpc3QoKS5zaXplKCkpOwoK\nICAgICAgICAvLyBlbnN1cmUgb3JpZ2luYWwgbGVkZ2VyIGRvZXNuJ3QgZXhp\nc3QKICAgICAgICBTdHJpbmcgZmlyc3RMZWRnZXJQYXRoID0gU3RyaW5nLmZv\ncm1hdCgiL2xlZGdlcnMvTCUwMTBkIiwgZmlyc3RMZWRnZXIpOwogICAgICAg\nIFN0cmluZyBzZWNvbmRMZWRnZXJQYXRoID0gU3RyaW5nLmZvcm1hdCgiL2xl\nZGdlcnMvTCUwMTBkIiwgc2Vjb25kTGVkZ2VyKTsKICAgICAgICBhc3NlcnRO\ndWxsKCJMZWRnZXIgc2hvdWxkIG5vdCBleGlzdCIsIGJrdGIuZ2V0Wm9vS2Vl\ncGVyQ2xpZW50KCkuZXhpc3RzKGZpcnN0TGVkZ2VyUGF0aCwgZmFsc2UpKTsK\nICAgICAgICBhc3NlcnROb3ROdWxsKCJMZWRnZXIgc2hvdWxkIGV4aXN0Iiwg\nYmt0Yi5nZXRab29LZWVwZXJDbGllbnQoKS5leGlzdHMoc2Vjb25kTGVkZ2Vy\nUGF0aCwgZmFsc2UpKTsKCiAgICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICB9\nCn0K\n","encoding":"base64"}

