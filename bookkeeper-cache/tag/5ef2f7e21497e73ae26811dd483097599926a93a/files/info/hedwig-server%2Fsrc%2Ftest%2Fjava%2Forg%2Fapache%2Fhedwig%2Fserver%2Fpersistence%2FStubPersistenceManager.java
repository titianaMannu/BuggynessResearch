{"sha":"827677f14094a13cb8a28bad559897e3e1adfbc0","node_id":"MDQ6QmxvYjE1NzU5NTY6ODI3Njc3ZjE0MDk0YTEzY2I4YTI4YmFkNTU5ODk3ZTNlMWFkZmJjMA==","size":5287,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/827677f14094a13cb8a28bad559897e3e1adfbc0","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5I\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmlu\nZzsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3Vi\nRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3Rv\nY29sLk1lc3NhZ2VTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvZXh0ZW5zaW9ucy5NZXNzYWdlSWRVdGlsczsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5TY2FuQ2FsbGJhY2suUmVh\nc29uRm9yRmluaXNoOwoKcHVibGljIGNsYXNzIFN0dWJQZXJzaXN0ZW5jZU1h\nbmFnZXIgaW1wbGVtZW50cyBQZXJzaXN0ZW5jZU1hbmFnZXJXaXRoUmFuZ2VT\nY2FuIHsKICAgIE1hcDxCeXRlU3RyaW5nLCBMaXN0PE1lc3NhZ2U+PiBtZXNz\nYWdlcyA9IG5ldyBIYXNoTWFwPEJ5dGVTdHJpbmcsIExpc3Q8TWVzc2FnZT4+\nKCk7CiAgICBib29sZWFuIGZhaWx1cmUgPSBmYWxzZTsKICAgIFNlcnZpY2VE\nb3duRXhjZXB0aW9uIGV4Y2VwdGlvbiA9IG5ldyBTZXJ2aWNlRG93bkV4Y2Vw\ndGlvbigiQXNrZWQgdG8gZmFpbCIpOwoKICAgIHB1YmxpYyB2b2lkIGRlbGl2\nZXJlZFVudGlsKEJ5dGVTdHJpbmcgdG9waWMsIExvbmcgc2VxSWQpIHsKICAg\nICAgICAvLyBub29wCiAgICB9CgogICAgcHVibGljIHZvaWQgY29uc3VtZWRV\nbnRpbChCeXRlU3RyaW5nIHRvcGljLCBMb25nIHNlcUlkKSB7CiAgICAgICAg\nLy8gbm9vcAogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldE1lc3NhZ2VCb3Vu\nZChCeXRlU3RyaW5nIHRvcGljLCBJbnRlZ2VyIGJvdW5kKSB7CiAgICAgICAg\nLy8gbm9vcAogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsZWFyTWVzc2FnZUJv\ndW5kKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAgICAgICAvLyBub29wCiAgICB9\nCgogICAgcHVibGljIHZvaWQgY29uc3VtZVRvQm91bmQoQnl0ZVN0cmluZyB0\nb3BpYykgewogICAgICAgIC8vIG5vb3AKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nc3RhdGljIGNsYXNzIEFycmF5TGlzdE1lc3NhZ2VGYWN0b3J5IGltcGxlbWVu\ndHMgRmFjdG9yeTxMaXN0PE1lc3NhZ2U+PiB7CiAgICAgICAgc3RhdGljIEFy\ncmF5TGlzdE1lc3NhZ2VGYWN0b3J5IGluc3RhbmNlID0gbmV3IEFycmF5TGlz\ndE1lc3NhZ2VGYWN0b3J5KCk7CgogICAgICAgIHB1YmxpYyBMaXN0PE1lc3Nh\nZ2U+IG5ld0luc3RhbmNlKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEFy\ncmF5TGlzdDxNZXNzYWdlPigpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgTWVzc2FnZVNlcUlkIGdldEN1cnJlbnRTZXFJZEZvclRvcGljKEJ5dGVT\ndHJpbmcgdG9waWMpIHsKICAgICAgICBsb25nIHNlcUlkID0gTWFwTWV0aG9k\ncy5nZXRBZnRlckluc2VydGluZ0lmQWJzZW50KG1lc3NhZ2VzLCB0b3BpYywg\nQXJyYXlMaXN0TWVzc2FnZUZhY3RvcnkuaW5zdGFuY2UpLnNpemUoKTsKICAg\nICAgICByZXR1cm4gTWVzc2FnZVNlcUlkLm5ld0J1aWxkZXIoKS5zZXRMb2Nh\nbENvbXBvbmVudChzZXFJZCkuYnVpbGQoKTsKICAgIH0KCiAgICBwdWJsaWMg\nbG9uZyBnZXRTZXFJZEFmdGVyU2tpcHBpbmcoQnl0ZVN0cmluZyB0b3BpYywg\nbG9uZyBzZXFJZCwgaW50IHNraXBBbW91bnQpIHsKICAgICAgICByZXR1cm4g\nc2VxSWQgKyBza2lwQW1vdW50OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBl\ncnNpc3RNZXNzYWdlKFBlcnNpc3RSZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAg\nICBpZiAoZmFpbHVyZSkgewogICAgICAgICAgICByZXF1ZXN0LmdldENhbGxi\nYWNrKCkub3BlcmF0aW9uRmFpbGVkKHJlcXVlc3QuZ2V0Q3R4KCksIGV4Y2Vw\ndGlvbik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAg\nIE1hcE1ldGhvZHMuYWRkVG9NdWx0aU1hcChtZXNzYWdlcywgcmVxdWVzdC5n\nZXRUb3BpYygpLCByZXF1ZXN0LmdldE1lc3NhZ2UoKSwgQXJyYXlMaXN0TWVz\nc2FnZUZhY3RvcnkuaW5zdGFuY2UpOwogICAgICAgIHJlcXVlc3QuZ2V0Q2Fs\nbGJhY2soKS5vcGVyYXRpb25GaW5pc2hlZChyZXF1ZXN0LmdldEN0eCgpLCBN\nZXNzYWdlSWRVdGlscy5tZXJnZUxvY2FsU2VxSWQocmVxdWVzdC5nZXRNZXNz\nYWdlKCksCiAgICAgICAgICAgICAgICAobG9uZykgbWVzc2FnZXMuZ2V0KHJl\ncXVlc3QuZ2V0VG9waWMoKSkuc2l6ZSgpKS5nZXRNc2dJZCgpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzY2FuU2luZ2xlTWVzc2FnZShTY2FuUmVxdWVz\ndCByZXF1ZXN0KSB7CiAgICAgICAgaWYgKGZhaWx1cmUpIHsKICAgICAgICAg\nICAgcmVxdWVzdC5nZXRDYWxsYmFjaygpLnNjYW5GYWlsZWQocmVxdWVzdC5n\nZXRDdHgoKSwgZXhjZXB0aW9uKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KCiAgICAgICAgbG9uZyBpbmRleCA9IHJlcXVlc3QuZ2V0U3RhcnRT\nZXFJZCgpIC0gMTsKICAgICAgICBMaXN0PE1lc3NhZ2U+IG1lc3NhZ2VMaXN0\nID0gbWVzc2FnZXMuZ2V0KHJlcXVlc3QuZ2V0VG9waWMoKSk7CiAgICAgICAg\naWYgKGluZGV4ID49IG1lc3NhZ2VMaXN0LnNpemUoKSkgewogICAgICAgICAg\nICByZXF1ZXN0LmdldENhbGxiYWNrKCkuc2NhbkZpbmlzaGVkKHJlcXVlc3Qu\nZ2V0Q3R4KCksIFJlYXNvbkZvckZpbmlzaC5OT19NT1JFX01FU1NBR0VTKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgTWVzc2Fn\nZSBtc2cgPSBtZXNzYWdlTGlzdC5nZXQoKGludCkgaW5kZXgpOwogICAgICAg\nIE1lc3NhZ2UgdG9EZWxpdmVyID0gTWVzc2FnZUlkVXRpbHMubWVyZ2VMb2Nh\nbFNlcUlkKG1zZywgcmVxdWVzdC5nZXRTdGFydFNlcUlkKCkpOwogICAgICAg\nIHJlcXVlc3QuZ2V0Q2FsbGJhY2soKS5tZXNzYWdlU2Nhbm5lZChyZXF1ZXN0\nLmdldEN0eCgpLCB0b0RlbGl2ZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNjYW5NZXNzYWdlcyhSYW5nZVNjYW5SZXF1ZXN0IHJlcXVlc3QpIHsKICAg\nICAgICBpZiAoZmFpbHVyZSkgewogICAgICAgICAgICByZXF1ZXN0LmdldENh\nbGxiYWNrKCkuc2NhbkZhaWxlZChyZXF1ZXN0LmdldEN0eCgpLCBleGNlcHRp\nb24pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBs\nb25nIHRvdGFsU2l6ZSA9IDA7CiAgICAgICAgbG9uZyBzdGFydFNlcUlkID0g\ncmVxdWVzdC5nZXRTdGFydFNlcUlkKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCByZXF1ZXN0LmdldE1lc3NhZ2VMaW1pdCgpOyBpKyspIHsKICAg\nICAgICAgICAgTGlzdDxNZXNzYWdlPiBtZXNzYWdlTGlzdCA9IE1hcE1ldGhv\nZHMuZ2V0QWZ0ZXJJbnNlcnRpbmdJZkFic2VudChtZXNzYWdlcywgcmVxdWVz\ndC5nZXRUb3BpYygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgQXJyYXlMaXN0TWVzc2FnZUZhY3RvcnkuaW5zdGFuY2UpOwog\nICAgICAgICAgICBpZiAoc3RhcnRTZXFJZCArIGkgPiBtZXNzYWdlTGlzdC5z\naXplKCkpIHsKICAgICAgICAgICAgICAgIHJlcXVlc3QuZ2V0Q2FsbGJhY2so\nKS5zY2FuRmluaXNoZWQocmVxdWVzdC5nZXRDdHgoKSwgUmVhc29uRm9yRmlu\naXNoLk5PX01PUkVfTUVTU0FHRVMpOwogICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIE1lc3NhZ2UgbXNnID0gbWVz\nc2FnZUxpc3QuZ2V0KChpbnQpIHN0YXJ0U2VxSWQgKyBpIC0gMSk7CiAgICAg\nICAgICAgIE1lc3NhZ2UgdG9EZWxpdmVyID0gTWVzc2FnZUlkVXRpbHMubWVy\nZ2VMb2NhbFNlcUlkKG1zZywgc3RhcnRTZXFJZCArIGkpOwogICAgICAgICAg\nICByZXF1ZXN0LmdldENhbGxiYWNrKCkubWVzc2FnZVNjYW5uZWQocmVxdWVz\ndC5nZXRDdHgoKSwgdG9EZWxpdmVyKTsKCiAgICAgICAgICAgIHRvdGFsU2l6\nZSArPSB0b0RlbGl2ZXIuZ2V0Qm9keSgpLnNpemUoKTsKCiAgICAgICAgICAg\nIGlmICh0b3RhbFNpemUgPiByZXF1ZXN0LmdldFNpemVMaW1pdCgpKSB7CiAg\nICAgICAgICAgICAgICByZXF1ZXN0LmdldENhbGxiYWNrKCkuc2NhbkZpbmlz\naGVkKHJlcXVlc3QuZ2V0Q3R4KCksIFJlYXNvbkZvckZpbmlzaC5TSVpFX0xJ\nTUlUX0VYQ0VFREVEKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXF1ZXN0LmdldENhbGxiYWNr\nKCkuc2NhbkZpbmlzaGVkKHJlcXVlc3QuZ2V0Q3R4KCksIFJlYXNvbkZvckZp\nbmlzaC5OVU1fTUVTU0FHRVNfTElNSVRfRVhDRUVERUQpOwoKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHN0b3AoKSB7CiAgICAgICAg\nLy8gZG8gbm90aGluZwogICAgfQp9Cg==\n","encoding":"base64"}

