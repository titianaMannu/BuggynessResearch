{"sha":"688c685c6ced03528418eb42a29c8c86638cf0cd","node_id":"MDQ6QmxvYjE1NzU5NTY6Njg4YzY4NWM2Y2VkMDM1Mjg0MThlYjQyYTI5YzhjODY2MzhjZjBjZA==","size":33031,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/688c685c6ced03528418eb42a29c8c86638cf0cd","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25j\ndXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5TY2hlZHVsZWRFeGVjdXRvclNlcnZpY2U7CmltcG9ydCBq\nYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhvcmU7CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBqdW5pdC5mcmFtZXdv\ncmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnZl\ncnNpb25pbmcuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci52ZXJzaW9uaW5nLlZlcnNpb25lZDsKCmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5IZWxwZXJNZXRob2RzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nU3R1YkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0\naW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbDsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLkxlZGdlclJhbmdlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTGVkZ2VyUmFuZ2VzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2VTZXFJ\nZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLlN1YnNjcmliZVJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1ZXN0\nLkNyZWF0ZU9yQXR0YWNoOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uRGF0YTsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRh\nLk1ldGFkYXRhTWFuYWdlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIubWV0YS5TdWJzY3JpcHRpb25EYXRhTWFuYWdlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRhLlRvcGljT3duZXJz\naGlwTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5t\nZXRhLlRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLnN1YnNjcmlwdGlvbnMuTU1TdWJzY3JpcHRpb25N\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGlj\ncy5Ub3BpY01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2\nZXIudG9waWNzLlRyaXZpYWxPd25BbGxUb3BpY01hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcudXRpbC5Db25jdXJyZW5jeVV0aWxzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcudXRpbC5FaXRoZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7\nCmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1bml0LlRl\nc3Q7CmltcG9ydCBvcmcuanVuaXQucnVubmVyLlJ1bldpdGg7CmltcG9ydCBv\ncmcuanVuaXQucnVubmVycy5QYXJhbWV0ZXJpemVkOwppbXBvcnQgb3JnLmp1\nbml0LnJ1bm5lcnMuUGFyYW1ldGVyaXplZC5QYXJhbWV0ZXJzOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsK\nCkBSdW5XaXRoKFBhcmFtZXRlcml6ZWQuY2xhc3MpCnB1YmxpYyBjbGFzcyBU\nZXN0Qm9va0tlZXBlclBlcnNpc3RlbmNlTWFuYWdlciBleHRlbmRzIFRlc3RD\nYXNlIHsKICAgIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9y\neS5nZXRMb2dnZXIoVGVzdFBlcnNpc3RlbmNlTWFuYWdlckJsYWNrQm94LmNs\nYXNzKTsKCiAgICBCb29rS2VlcGVyVGVzdEJhc2UgYmt0YjsKICAgIHByaXZh\ndGUgZmluYWwgaW50IG51bUJvb2tpZXMgPSAzOwogICAgcHJpdmF0ZSBmaW5h\nbCBsb25nIHJlYWREZWxheSA9IDIwMDBMOwogICAgcHJpdmF0ZSBmaW5hbCBp\nbnQgbWF4RW50cmllc1BlckxlZGdlciA9IDEwOwoKICAgIFNlcnZlckNvbmZp\nZ3VyYXRpb24gY29uZjsKICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBz\nY2hlZHVsZXI7CgogICAgVG9waWNNYW5hZ2VyIHRtOwogICAgQm9va2tlZXBl\nclBlcnNpc3RlbmNlTWFuYWdlciBtYW5hZ2VyOwogICAgUHViU3ViRXhjZXB0\naW9uIGZhaWx1cmVFeGNlcHRpb24gPSBudWxsOwogICAgVGVzdE1ldGFkYXRh\nTWFuYWdlckZhY3RvcnkgbWV0YWRhdGFNYW5hZ2VyRmFjdG9yeTsKICAgIFRv\ncGljUGVyc2lzdGVuY2VNYW5hZ2VyIHRwTWFuYWdlcjsKICAgIE1NU3Vic2Ny\naXB0aW9uTWFuYWdlciBzbTsKCiAgICBib29sZWFuIHJlbW92ZVN0YXJ0U2Vx\nSWQ7CgogICAgc3RhdGljIGNsYXNzIFRlc3RNZXRhZGF0YU1hbmFnZXJGYWN0\nb3J5IGV4dGVuZHMgTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSB7CgogICAgICAg\nIGZpbmFsIE1ldGFkYXRhTWFuYWdlckZhY3RvcnkgZmFjdG9yeTsKICAgICAg\nICBpbnQgc2VydmljZURvd25Db3VudCA9IDA7CgogICAgICAgIFRlc3RNZXRh\nZGF0YU1hbmFnZXJGYWN0b3J5KFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiwg\nWm9vS2VlcGVyIHprKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nZmFjdG9yeSA9IE1ldGFkYXRhTWFuYWdlckZhY3RvcnkubmV3TWV0YWRhdGFN\nYW5hZ2VyRmFjdG9yeShjb25mLCB6ayk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRTZXJ2aWNlRG93bkNvdW50KGludCBjb3VudCkgewog\nICAgICAgICAgICB0aGlzLnNlcnZpY2VEb3duQ291bnQgPSBjb3VudDsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQg\nZ2V0Q3VycmVudFZlcnNpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0\nb3J5LmdldEN1cnJlbnRWZXJzaW9uKCk7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgTWV0YWRhdGFNYW5hZ2VyRmFj\ndG9yeSBpbml0aWFsaXplKAogICAgICAgICAgICBTZXJ2ZXJDb25maWd1cmF0\naW9uIGNmZywgWm9vS2VlcGVyIHprLCBpbnQgdmVyc2lvbikgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgLy8gZG8gbm90aGluZwogICAgICAg\nICAgICByZXR1cm4gZmFjdG9yeTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHNodXRkb3duKCkgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgZmFjdG9yeS5zaHV0ZG93bigpOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIEl0\nZXJhdG9yPEJ5dGVTdHJpbmc+IGdldFRvcGljcygpIHRocm93cyBJT0V4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LmdldFRvcGljcygp\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyIG5ld1RvcGljUGVyc2lzdGVuY2VN\nYW5hZ2VyKCkgewogICAgICAgICAgICBmaW5hbCBUb3BpY1BlcnNpc3RlbmNl\nTWFuYWdlciBtYW5hZ2VyID0gZmFjdG9yeS5uZXdUb3BpY1BlcnNpc3RlbmNl\nTWFuYWdlcigpOwogICAgICAgICAgICByZXR1cm4gbmV3IFRvcGljUGVyc2lz\ndGVuY2VNYW5hZ2VyKCkgewoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9F\neGNlcHRpb24gewogICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJlYWRUb3BpY1BlcnNp\nc3RlbmNlSW5mbyhCeXRlU3RyaW5nIHRvcGljLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNr\nPFZlcnNpb25lZDxMZWRnZXJSYW5nZXM+PiBjYWxsYmFjaywgT2JqZWN0IGN0\neCkgewogICAgICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlRG93bkNvdW50\nID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAtLXNlcnZpY2VEb3du\nQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJh\ndGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURv\nd25FeGNlcHRpb24oIk1ldGFkYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5yZWFkVG9waWNQZXJz\naXN0ZW5jZUluZm8odG9waWMsIGNhbGxiYWNrLCBjdHgpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCB3cml0ZVRvcGljUGVyc2lzdGVuY2VJbmZvKEJ5\ndGVTdHJpbmcgdG9waWMsIExlZGdlclJhbmdlcyByYW5nZXMsIFZlcnNpb24g\ndmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ss\nIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2Vydmlj\nZURvd25Db3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLS1z\nZXJ2aWNlRG93bkNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICBjYWxs\nYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9u\nLlNlcnZpY2VEb3duRXhjZXB0aW9uKCJNZXRhZGF0YSBTdG9yZSBpcyBkb3du\nIikpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG1hbmFnZXIud3Jp\ndGVUb3BpY1BlcnNpc3RlbmNlSW5mbyh0b3BpYywgcmFuZ2VzLCB2ZXJzaW9u\nLCBjYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nZGVsZXRlVG9waWNQZXJzaXN0ZW5jZUluZm8oQnl0ZVN0cmluZyB0b3BpYywg\nVmVyc2lvbiB2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2s8Vm9pZD4gY2Fs\nbGJhY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAo\nc2VydmljZURvd25Db3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgLS1zZXJ2aWNlRG93bkNvdW50OwogICAgICAgICAgICAgICAgICAgICAg\nICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhj\nZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKCJNZXRhZGF0YSBTdG9yZSBp\ncyBkb3duIikpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG1hbmFn\nZXIuZGVsZXRlVG9waWNQZXJzaXN0ZW5jZUluZm8odG9waWMsIHZlcnNpb24s\nIGNhbGxiYWNrLCBjdHgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFN1YnNjcmlwdGlvbkRhdGFNYW5hZ2VyIG5ld1N1YnNjcmlwdGlvbkRh\ndGFNYW5hZ2VyKCkgewogICAgICAgICAgICBmaW5hbCBTdWJzY3JpcHRpb25E\nYXRhTWFuYWdlciBzZG0gPSBmYWN0b3J5Lm5ld1N1YnNjcmlwdGlvbkRhdGFN\nYW5hZ2VyKCk7CiAgICAgICAgICAgIHJldHVybiBuZXcgU3Vic2NyaXB0aW9u\nRGF0YU1hbmFnZXIoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgICAgICBzZG0uY2xvc2UoKTsKICAg\nICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNyZWF0ZVN1YnNjcmlwdGlvbkRh\ndGEoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQs\nIFN1YnNjcmlwdGlvbkRhdGEgZGF0YSwKICAgICAgICAgICAgICAgICAgICAg\nICAgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICBzZG0uY3JlYXRlU3Vic2NyaXB0aW9uRGF0\nYSh0b3BpYywgc3Vic2NyaWJlcklkLCBkYXRhLCBjYWxsYmFjaywgY3R4KTsK\nICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIGlzUGFydGlhbFVwZGF0\nZVN1cHBvcnRlZCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2Rt\nLmlzUGFydGlhbFVwZGF0ZVN1cHBvcnRlZCgpOwogICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgdXBkYXRlU3Vic2NyaXB0aW9uRGF0YShCeXRlU3RyaW5n\nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAg\nICAgICAgICAgICAgU3Vic2NyaXB0aW9uRGF0YSBkYXRhVG9VcGRhdGUsIFZl\ncnNpb24gdmVyc2lvbiwgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9i\namVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2VydmljZURv\nd25Db3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLS1zZXJ2\naWNlRG93bkNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNl\ncHRpb24oIk1ldGFkYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgc2RtLnVwZGF0ZVN1YnNjcmlwdGlvbkRhdGEo\ndG9waWMsIHN1YnNjcmliZXJJZCwgZGF0YVRvVXBkYXRlLCB2ZXJzaW9uLCBj\nYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJl\ncGxhY2VTdWJzY3JpcHRpb25EYXRhKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVT\ndHJpbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgICBT\ndWJzY3JpcHRpb25EYXRhIGRhdGFUb1JlcGxhY2UsIFZlcnNpb24gdmVyc2lv\nbiwgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAoc2VydmljZURvd25Db3VudCA+IDAp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgLS1zZXJ2aWNlRG93bkNvdW50\nOwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25G\nYWlsZWQoY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5l\ndyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRpb24oIk1ldGFk\nYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgc2RtLnJlcGxhY2VTdWJzY3JpcHRpb25EYXRhKHRvcGljLCBzdWJz\nY3JpYmVySWQsIGRhdGFUb1JlcGxhY2UsIHZlcnNpb24sIGNhbGxiYWNrLCBj\ndHgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgZGVsZXRlU3Vic2Ny\naXB0aW9uRGF0YShCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNj\ncmliZXJJZCwgVmVyc2lvbiB2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAg\nICAgICBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewog\nICAgICAgICAgICAgICAgICAgIHNkbS5kZWxldGVTdWJzY3JpcHRpb25EYXRh\nKHRvcGljLCBzdWJzY3JpYmVySWQsIHZlcnNpb24sIGNhbGxiYWNrLCBjdHgp\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcmVhZFN1YnNjcmlwdGlv\nbkRhdGEoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrPFZlcnNpb25l\nZDxTdWJzY3JpcHRpb25EYXRhPj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICBzZG0ucmVhZFN1YnNjcmlwdGlvbkRhdGEo\ndG9waWMsIHN1YnNjcmliZXJJZCwgY2FsbGJhY2ssIGN0eCk7CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCByZWFkU3Vic2NyaXB0aW9ucyhCeXRlU3Ry\naW5nIHRvcGljLAogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjazxN\nYXA8Qnl0ZVN0cmluZywgVmVyc2lvbmVkPFN1YnNjcmlwdGlvbkRhdGE+Pj4g\nY2IsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBzZG0ucmVh\nZFN1YnNjcmlwdGlvbnModG9waWMsIGNiLCBjdHgpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIFRvcGljT3duZXJzaGlwTWFuYWdlciBuZXdU\nb3BpY093bmVyc2hpcE1hbmFnZXIoKSB7CiAgICAgICAgICAgIHJldHVybiBm\nYWN0b3J5Lm5ld1RvcGljT3duZXJzaGlwTWFuYWdlcigpOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgZm9ybWF0\nKFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnLCBab29LZWVwZXIgemspIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGZhY3RvcnkuZm9ybWF0KGNm\nZywgemspOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgVGVzdEJvb2tL\nZWVwZXJQZXJzaXN0ZW5jZU1hbmFnZXIoYm9vbGVhbiByZW1vdmVTdGFydFNl\ncUlkKSB7CiAgICAgICAgdGhpcy5yZW1vdmVTdGFydFNlcUlkID0gcmVtb3Zl\nU3RhcnRTZXFJZDsKICAgIH0KCiAgICBAUGFyYW1ldGVycwogICAgcHVibGlj\nIHN0YXRpYyBDb2xsZWN0aW9uPE9iamVjdFtdPiBjb25maWdzKCkgewogICAg\nICAgIHJldHVybiBBcnJheXMuYXNMaXN0KG5ldyBPYmplY3RbXVtdIHsKICAg\nICAgICAgICAgeyB0cnVlIH0sIHsgZmFsc2UgfQogICAgICAgIH0pOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBzdGFydENsdXN0ZXIobG9uZyBkZWxheSkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgYmt0YiA9IG5ldyBCb29rS2Vl\ncGVyVGVzdEJhc2UobnVtQm9va2llcywgMEwpOwogICAgICAgIGJrdGIuc2V0\nVXAoKTsKCiAgICAgICAgY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9u\nKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGlj\nIGludCBnZXRNZXNzYWdlc0NvbnN1bWVkVGhyZWFkUnVuSW50ZXJ2YWwoKSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gMjAwMDsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIGludCBn\nZXRDb25zdW1lSW50ZXJ2YWwoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgcHVibGljIGxvbmcgZ2V0TWF4RW50cmllc1BlckxlZGdlcigpIHsK\nICAgICAgICAgICAgICAgIHJldHVybiBtYXhFbnRyaWVzUGVyTGVkZ2VyOwog\nICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uIGJrQ2xpZW50Q29u\nZiA9CiAgICAgICAgICAgICAgICBuZXcgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbigpOwogICAgICAgIGJrQ2xpZW50\nQ29uZi5zZXROdW1Xb3JrZXJUaHJlYWRzKDEpLnNldFJlYWRUaW1lb3V0KDk5\nOTkpCiAgICAgICAgLnNldFRocm90dGxlVmFsdWUoMyk7CiAgICAgICAgY29u\nZi5hZGRDb25mKGJrQ2xpZW50Q29uZik7CgogICAgICAgIG1ldGFkYXRhTWFu\nYWdlckZhY3RvcnkgPSBuZXcgVGVzdE1ldGFkYXRhTWFuYWdlckZhY3Rvcnko\nY29uZiwgYmt0Yi5nZXRab29LZWVwZXJDbGllbnQoKSk7CiAgICAgICAgdHBN\nYW5hZ2VyID0gbWV0YWRhdGFNYW5hZ2VyRmFjdG9yeS5uZXdUb3BpY1BlcnNp\nc3RlbmNlTWFuYWdlcigpOwoKICAgICAgICBzY2hlZHVsZXIgPSBFeGVjdXRv\ncnMubmV3U2NoZWR1bGVkVGhyZWFkUG9vbCgxKTsKICAgICAgICB0bSA9IG5l\ndyBUcml2aWFsT3duQWxsVG9waWNNYW5hZ2VyKGNvbmYsIHNjaGVkdWxlcik7\nCiAgICAgICAgbWFuYWdlciA9IG5ldyBCb29ra2VlcGVyUGVyc2lzdGVuY2VN\nYW5hZ2VyKGJrdGIuYmssIG1ldGFkYXRhTWFuYWdlckZhY3RvcnksCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRtLCBjb25mLCBzY2hlZHVsZXIpOwogICAgICAgIHNtID0gbmV3IE1NU3Vi\nc2NyaXB0aW9uTWFuYWdlcihjb25mLCBtZXRhZGF0YU1hbmFnZXJGYWN0b3J5\nLCB0bSwgbWFuYWdlciwgbnVsbCwgc2NoZWR1bGVyKTsKICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgc3RvcENsdXN0ZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICB0bS5zdG9wKCk7CiAgICAgICAgbWFuYWdlci5zdG9wKCk7CiAg\nICAgICAgc20uc3RvcCgpOwogICAgICAgIHRwTWFuYWdlci5jbG9zZSgpOwog\nICAgICAgIG1ldGFkYXRhTWFuYWdlckZhY3Rvcnkuc2h1dGRvd24oKTsKICAg\nICAgICBzY2hlZHVsZXIuc2h1dGRvd24oKTsKICAgICAgICBia3RiLnRlYXJE\nb3duKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBAQmVmb3JlCiAgICBw\ndWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIHN1cGVyLnNldFVwKCk7CiAgICAgICAgc3RhcnRDbHVzdGVyKDBMKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIEBBZnRlcgogICAgcHVibGljIHZvaWQg\ndGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdG9wQ2x1\nc3RlcigpOwogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICB9CgogICAg\nY2xhc3MgUmFuZ2VTY2FuVmVyaWZpZXIgaW1wbGVtZW50cyBTY2FuQ2FsbGJh\nY2sgewogICAgICAgIExpbmtlZExpc3Q8TWVzc2FnZT4gcHViTXNnczsKICAg\nICAgICBib29sZWFuIHJ1bk5leHRTY2FuID0gZmFsc2U7CiAgICAgICAgUmFu\nZ2VTY2FuUmVxdWVzdCBuZXh0U2NhbiA9IG51bGw7CgogICAgICAgIHB1Ymxp\nYyBSYW5nZVNjYW5WZXJpZmllcihMaW5rZWRMaXN0PE1lc3NhZ2U+IHB1Yk1z\nZ3MsIFJhbmdlU2NhblJlcXVlc3QgbmV4dFNjYW4pIHsKICAgICAgICAgICAg\ndGhpcy5wdWJNc2dzID0gcHViTXNnczsKICAgICAgICAgICAgdGhpcy5uZXh0\nU2NhbiA9IG5leHRTY2FuOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIHZvaWQgbWVzc2FnZVNjYW5uZWQoT2JqZWN0IGN0\neCwgTWVzc2FnZSByZWN2TWVzc2FnZSkgewogICAgICAgICAgICBsb2dnZXIu\naW5mbygiU2Nhbm5lZCBtZXNzYWdlIDoge30iLCByZWN2TWVzc2FnZS5nZXRN\nc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCkpOwogICAgICAgICAgICBpZiAo\nbnVsbCAhPSBuZXh0U2NhbiAmJiAhcnVuTmV4dFNjYW4pIHsKICAgICAgICAg\nICAgICAgIHJ1bk5leHRTY2FuID0gdHJ1ZTsKICAgICAgICAgICAgICAgIG1h\nbmFnZXIuc2Nhbk1lc3NhZ2VzKG5leHRTY2FuKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgaWYgKHB1Yk1zZ3Muc2l6ZSgpID09IDApIHsKICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nTWVzc2FnZSBwdWJNc2cgPSBwdWJNc2dzLnJlbW92ZUZpcnN0KCk7CiAgICAg\nICAgICAgIGlmICghSGVscGVyTWV0aG9kcy5hcmVFcXVhbChyZWN2TWVzc2Fn\nZSwgcHViTXNnKSkgewogICAgICAgICAgICAgICAgZmFpbCgiU2Nhbm5lZCBt\nZXNzYWdlIG5vdCBlcXVhbCB0byBleHBlY3RlZCIpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\ndm9pZCBzY2FuRmFpbGVkKE9iamVjdCBjdHgsIEV4Y2VwdGlvbiBleGNlcHRp\nb24pIHsKICAgICAgICAgICAgZmFpbCgiRmFpbGVkIHRvIHNjYW4gbWVzc2Fn\nZXMuIik7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBA\nU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgICAgICBwdWJsaWMg\ndm9pZCBzY2FuRmluaXNoZWQoT2JqZWN0IGN0eCwgUmVhc29uRm9yRmluaXNo\nIHJlYXNvbikgewogICAgICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJv\nb2xlYW4+IHN0YXR1c1F1ZXVlID0gKExpbmtlZEJsb2NraW5nUXVldWU8Qm9v\nbGVhbj4pIGN0eDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIHN0YXR1c1F1ZXVlLnB1dChwdWJNc2dzLmlzRW1wdHkoKSk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGUpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBwcml2YXRlIExpbmtl\nZExpc3Q8TWVzc2FnZT4gc3ViTWVzc2FnZXMoTGlzdDxNZXNzYWdlPiBtc2dz\nLCBpbnQgc3RhcnQsIGludCBlbmQpIHsKICAgICAgICBMaW5rZWRMaXN0PE1l\nc3NhZ2U+IHJlc3VsdCA9IG5ldyBMaW5rZWRMaXN0PE1lc3NhZ2U+KCk7CiAg\nICAgICAgZm9yIChpbnQgaT1zdGFydDsgaTw9ZW5kOyBpKyspIHsKICAgICAg\nICAgICAgcmVzdWx0LmFkZChtc2dzLmdldChpKSk7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgQFRlc3QodGltZW91dD02\nMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTY2FuTWVzc2FnZXNPbkNsb3Nl\nZExlZGdlckFmdGVyRGVsZXRlTGVkZ2VyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgc2Nhbk1lc3NhZ2VzQWZ0ZXJEZWxldGVMZWRnZXJUZXN0KDIp\nOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0U2Nhbk1lc3NhZ2VzT25VbmNsb3NlZExlZGdlckFmdGVyRGVs\nZXRlTGVkZ2VyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc2Nhbk1l\nc3NhZ2VzQWZ0ZXJEZWxldGVMZWRnZXJUZXN0KDEpOwogICAgfQoKICAgIHBy\naXZhdGUgdm9pZCBzY2FuTWVzc2FnZXNBZnRlckRlbGV0ZUxlZGdlclRlc3Qo\naW50IG51bUxlZGdlcnMpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5\ndGVTdHJpbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVz\ndFNjYW5NZXNzYWdlc0FmdGVyRGVsZXRlTGVkZ2VyIik7CgogICAgICAgIExp\nc3Q8TWVzc2FnZT4gbXNncyA9IG5ldyBBcnJheUxpc3Q8TWVzc2FnZT4oKTsK\nCiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGljKTsKICAgICAgICBtc2dzLmFk\nZEFsbChwdWJsaXNoTWVzc2FnZXModG9waWMsIDIpKTsKCiAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPG51bUxlZGdlcnM7IGkrKykgewogICAgICAgICAgICBy\nZWxlYXNlVG9waWModG9waWMpOwogICAgICAgICAgICAvLyBhY3F1aXJlIHRv\ncGljIGFnYWluIHRvIGZvcmNlIGEgbmV3IGxlZGdlcgogICAgICAgICAgICBh\nY3F1aXJlVG9waWModG9waWMpOwogICAgICAgICAgICBtc2dzLmFkZEFsbChw\ndWJsaXNoTWVzc2FnZXModG9waWMsIDIpKTsKICAgICAgICB9CgogICAgICAg\nIGNvbnN1bWVkVW50aWwodG9waWMsIDJMKTsKICAgICAgICAvLyBXYWl0IHVu\ndGlsIGxlZGdlciByYW5nZXMgaXMgdXBkYXRlZC4KICAgICAgICBUaHJlYWQu\nc2xlZXAoMjAwMEwpOwogICAgICAgIHJlbGVhc2VUb3BpYyh0b3BpYyk7Cgog\nICAgICAgIC8vIGFjcXVpcmUgdG9waWMgYWdhaW4KICAgICAgICBhY3F1aXJl\nVG9waWModG9waWMpOwogICAgICAgIC8vIHNjYW4gbWVzc2FnZXMgc3RhcnRp\nbmcgZnJvbSAzCiAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFu\nPiBzdGF0dXNRdWV1ZSA9CiAgICAgICAgICAgIG5ldyBMaW5rZWRCbG9ja2lu\nZ1F1ZXVlPEJvb2xlYW4+KCk7CiAgICAgICAgbWFuYWdlci5zY2FuTWVzc2Fn\nZXMobmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMsIDMsIDIsIExvbmcuTUFY\nX1ZBTFVFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBSYW5n\nZVNjYW5WZXJpZmllcihzdWJNZXNzYWdlcyhtc2dzLCAyLCAzKSwgbnVsbCks\nIHN0YXR1c1F1ZXVlKSk7CiAgICAgICAgQm9vbGVhbiBiID0gc3RhdHVzUXVl\ndWUucG9sbCgxMCAqIHJlYWREZWxheSwgVGltZVVuaXQuTUlMTElTRUNPTkRT\nKTsKICAgICAgICBhc3NlcnRUcnVlKCJTaG91bGQgc3VjY2VlZCB0byBzY2Fu\nIG1lc3NhZ2VzIGFmdGVyIGRlbGV0ZWQgY29uc3VtZWQgbGVkZ2VyLiIsIGIp\nOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0U2Nhbk1lc3NhZ2VzT25FbXB0eUxlZGdlckFmdGVyRGVsZXRl\nTGVkZ2VyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0cmlu\nZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUZXN0U2Nhbk1l\nc3NhZ2VzT25FbXB0eUxlZGdlckFmdGVyRGVsZXRlTGVkZ2VyIik7CgogICAg\nICAgIExpc3Q8TWVzc2FnZT4gbXNncyA9IG5ldyBBcnJheUxpc3Q8TWVzc2Fn\nZT4oKTsKCiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGljKTsKICAgICAgICBt\nc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXModG9waWMsIDIpKTsKICAgICAg\nICByZWxlYXNlVG9waWModG9waWMpOwoKICAgICAgICAvLyBhY3F1aXJlIHRv\ncGljIGFnYWluIHRvIGZvcmNlIGEgbmV3IGxlZGdlcgogICAgICAgIGFjcXVp\ncmVUb3BpYyh0b3BpYyk7CiAgICAgICAgbG9nZ2VyLmluZm8oIkNvbnN1bWVk\nIG1lc3NhZ2VzLiIpOwogICAgICAgIGNvbnN1bWVkVW50aWwodG9waWMsIDJM\nKTsKICAgICAgICAvLyBXYWl0IHVudGlsIGxlZGdlciByYW5nZXMgaXMgdXBk\nYXRlZC4KICAgICAgICBUaHJlYWQuc2xlZXAoMjAwMEwpOwogICAgICAgIGxv\nZ2dlci5pbmZvKCJSZWxlYXNlZCB0b3BpYyB3aXRoIGFuIGVtcHR5IGxlZGdl\nci4iKTsKICAgICAgICAvLyByZWxlYXNlIHRvcGljIHRvIGZvcmNlIGFuIGVt\ncHR5IGxlZGdlcgogICAgICAgIHJlbGVhc2VUb3BpYyh0b3BpYyk7CgogICAg\nICAgIC8vIHB1Ymxpc2ggMiBtb3JlIG1lc3NhZ2VzLCB0aGVzZSBtZXNzYWdl\nIGV4cGVjdGVkIHRvIGJlIGlkIDMgYW5kIDQKICAgICAgICBhY3F1aXJlVG9w\naWModG9waWMpOwogICAgICAgIGxvZ2dlci5pbmZvKCJQdWJsaXNoZWQgbW9y\nZSBtZXNzYWdlcy4iKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVz\nc2FnZXModG9waWMsIDIpKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMp\nOwoKICAgICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluCiAgICAgICAgYWNx\ndWlyZVRvcGljKHRvcGljKTsKICAgICAgICAvLyBzY2FuIG1lc3NhZ2VzIHN0\nYXJ0aW5nIGZyb20gMwogICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9v\nbGVhbj4gc3RhdHVzUXVldWUgPQogICAgICAgICAgICBuZXcgTGlua2VkQmxv\nY2tpbmdRdWV1ZTxCb29sZWFuPigpOwogICAgICAgIGxvbmcgc3RhcnRTZXFJ\nZCA9IHJlbW92ZVN0YXJ0U2VxSWQgPyAxIDogMzsKICAgICAgICBtYW5hZ2Vy\nLnNjYW5NZXNzYWdlcyhuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgc3Rh\ncnRTZXFJZCwgMiwgTG9uZy5NQVhfVkFMVUUsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbmV3IFJhbmdlU2NhblZlcmlmaWVyKHN1Yk1lc3NhZ2Vz\nKG1zZ3MsIDIsIDMpLCBudWxsKSwgc3RhdHVzUXVldWUpKTsKICAgICAgICBC\nb29sZWFuIGIgPSBzdGF0dXNRdWV1ZS5wb2xsKDEwICogcmVhZERlbGF5LCBU\naW1lVW5pdC5NSUxMSVNFQ09ORFMpOwogICAgICAgIGFzc2VydFRydWUoIlNo\nb3VsZCBzdWNjZWVkIHRvIHNjYW4gbWVzc2FnZXMgYWZ0ZXIgZGVsZXRlZCBj\nb25zdW1lZCBsZWRnZXIuIiwgYik7CiAgICB9CgogICAgQFRlc3QodGltZW91\ndD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RGYWlsZWRUb0RlbGV0ZUxl\nZGdlcjEoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBmYWlsZWRUb0Rl\nbGV0ZUxlZGdlcnNUZXN0KDEpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9\nNjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0RmFpbGVkVG9EZWxldGVMZWRn\nZXIyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc3VjY2VlZCB0\nbyBkZWxldGUgc2Vjb25kIGxlZGdlcgogICAgICAgIGZhaWxlZFRvRGVsZXRl\nTGVkZ2Vyc1Rlc3QoMik7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGZhaWxl\nZFRvRGVsZXRlTGVkZ2Vyc1Rlc3QoaW50IG51bUxlZGdlcnMpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMgPSBC\neXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdEZhaWxlZFRvRGVsZXRlTGVk\nZ2VyIik7CiAgICAgICAgZmluYWwgaW50IHNlcnZpY2VEb3duQ291bnQgPSAx\nOwoKICAgICAgICBMaXN0PE1lc3NhZ2U+IG1zZ3MgPSBuZXcgQXJyYXlMaXN0\nPE1lc3NhZ2U+KCk7CgogICAgICAgIGZvciAoaW50IGk9MDsgaTxudW1MZWRn\nZXJzOyBpKyspIHsKICAgICAgICAgICAgYWNxdWlyZVRvcGljKHRvcGljKTsK\nICAgICAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3NhZ2VzKHRvcGlj\nLCAyKSk7CiAgICAgICAgICAgIHJlbGVhc2VUb3BpYyh0b3BpYyk7CiAgICAg\nICAgfQoKICAgICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluIHRvIGZvcmNl\nIGEgbmV3IGxlZGdlcgogICAgICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAg\nICAgICAgbG9nZ2VyLmluZm8oIkNvbnN1bWVkIG1lc3NhZ2VzLiIpOwogICAg\nICAgIG1ldGFkYXRhTWFuYWdlckZhY3Rvcnkuc2V0U2VydmljZURvd25Db3Vu\ndChzZXJ2aWNlRG93bkNvdW50KTsKICAgICAgICAvLyBmYWlsZWQgY29uc3Vt\nZWQKICAgICAgICBjb25zdW1lZFVudGlsKHRvcGljLCAyTCAqIG51bUxlZGdl\ncnMpOwogICAgICAgIC8vIFdhaXQgdW50aWwgbGVkZ2VyIHJhbmdlcyBpcyB1\ncGRhdGVkLgogICAgICAgIFRocmVhZC5zbGVlcCgyMDAwTCk7CiAgICAgICAg\nbG9nZ2VyLmluZm8oIlJlbGVhc2VkIHRvcGljIHdpdGggYW4gZW1wdHkgbGVk\nZ2VyLiIpOwogICAgICAgIC8vIHJlbGVhc2UgdG9waWMgdG8gZm9yY2UgYW4g\nZW1wdHkgbGVkZ2VyCiAgICAgICAgcmVsZWFzZVRvcGljKHRvcGljKTsKCiAg\nICAgICAgLy8gcHVibGlzaCAyIG1vcmUgbWVzc2FnZXMsIHRoZXNlIG1lc3Nh\nZ2UgZXhwZWN0ZWQgdG8gYmUgaWQgMyBhbmQgNAogICAgICAgIGFjcXVpcmVU\nb3BpYyh0b3BpYyk7CiAgICAgICAgbG9nZ2VyLmluZm8oIlB1Ymxpc2hlZCBt\nb3JlIG1lc3NhZ2VzLiIpOwogICAgICAgIG1zZ3MuYWRkQWxsKHB1Ymxpc2hN\nZXNzYWdlcyh0b3BpYywgMikpOwogICAgICAgIHJlbGVhc2VUb3BpYyh0b3Bp\nYyk7CgogICAgICAgIC8vIGFjcXVpcmUgdG9waWMgYWdhaW4KICAgICAgICBh\nY3F1aXJlVG9waWModG9waWMpOwogICAgICAgIExpbmtlZEJsb2NraW5nUXVl\ndWU8Qm9vbGVhbj4gc3RhdHVzUXVldWUgPQogICAgICAgICAgICBuZXcgTGlu\na2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPigpOwogICAgICAgIG1hbmFnZXIu\nc2Nhbk1lc3NhZ2VzKG5ldyBSYW5nZVNjYW5SZXF1ZXN0KHRvcGljLCBudW1M\nZWRnZXJzICogMiArIDEsIDIsIExvbmcuTUFYX1ZBTFVFLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG5ldyBSYW5nZVNjYW5WZXJpZmllcihzdWJN\nZXNzYWdlcyhtc2dzLCBudW1MZWRnZXJzICogMiwgbnVtTGVkZ2VycyAqIDIg\nKyAxKSwgbnVsbCksIHN0YXR1c1F1ZXVlKSk7CiAgICAgICAgQm9vbGVhbiBi\nID0gc3RhdHVzUXVldWUucG9sbCgxMCAqIHJlYWREZWxheSwgVGltZVVuaXQu\nTUlMTElTRUNPTkRTKTsKICAgICAgICBhc3NlcnRUcnVlKCJTaG91bGQgc3Vj\nY2VlZCB0byBzY2FuIG1lc3NhZ2VzIGFmdGVyIGRlbGV0ZWQgY29uc3VtZWQg\nbGVkZ2VyLiIsIGIpOwoKICAgICAgICAvLyBjb25zdW1lZCAKICAgICAgICBj\nb25zdW1lZFVudGlsKHRvcGljLCAobnVtTGVkZ2VycyArIDEpICogMkwpOwog\nICAgICAgIC8vIFdhaXQgdW50aWwgbGVkZ2VyIHJhbmdlcyBpcyB1cGRhdGVk\nLgogICAgICAgIFRocmVhZC5zbGVlcCgyMDAwTCk7CgogICAgICAgIFNlbWFw\naG9yZSBsYXRjaCA9IG5ldyBTZW1hcGhvcmUoMSk7CiAgICAgICAgbGF0Y2gu\nYWNxdWlyZSgpOwogICAgICAgIHRwTWFuYWdlci5yZWFkVG9waWNQZXJzaXN0\nZW5jZUluZm8odG9waWMsIG5ldyBDYWxsYmFjazxWZXJzaW9uZWQ8TGVkZ2Vy\nUmFuZ2VzPj4oKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBW\nZXJzaW9uZWQ8TGVkZ2VyUmFuZ2VzPiByYW5nZXMpIHsKICAgICAgICAgICAg\nICAgIGlmIChudWxsID09IHJhbmdlcyB8fCByYW5nZXMuZ2V0VmFsdWUoKS5n\nZXRSYW5nZXNMaXN0KCkuc2l6ZSgpID4gMSkgewogICAgICAgICAgICAgICAg\nICAgIGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUHViU3ViRXhjZXB0aW9uLk5v\nVG9waWNQZXJzaXN0ZW5jZUluZm9FeGNlcHRpb24oIkludmFsaWQgcGVyc2lz\ndGVuY2UgaW5mbyBmb3VuZCBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5n\nVXRmOCgpKTsKICAgICAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgp\nLnJlbGVhc2UoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9u\nID0gbnVsbDsKICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVs\nZWFzZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoT2JqZWN0\nIGN0eCwgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAg\nICAgICAgZmFpbHVyZUV4Y2VwdGlvbiA9IGV4Y2VwdGlvbjsKICAgICAgICAg\nICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSwgbGF0Y2gpOwogICAgICAgIGxhdGNoLmFjcXVpcmUo\nKTsKICAgICAgICBsYXRjaC5yZWxlYXNlKCk7CiAgICAgICAgYXNzZXJ0TnVs\nbCgiU2hvdWxkIG5vdCBmYWlsIHdpdGggZXhjZXB0aW9uLiIsIGZhaWx1cmVF\neGNlcHRpb24pOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0U2Nhbk1lc3NhZ2VzT25Ud29MZWRnZXJzKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3RvcENsdXN0ZXIoKTsKICAg\nICAgICBzdGFydENsdXN0ZXIocmVhZERlbGF5KTsKCiAgICAgICAgQnl0ZVN0\ncmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUZXN0U2Nh\nbk1lc3NhZ2VzT25Ud29MZWRnZXJzIik7CgogICAgICAgIExpc3Q8TWVzc2Fn\nZT4gbXNncyA9IG5ldyBBcnJheUxpc3Q8TWVzc2FnZT4oKTsKCiAgICAgICAg\nYWNxdWlyZVRvcGljKHRvcGljKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJs\naXNoTWVzc2FnZXModG9waWMsIDEpKTsKICAgICAgICByZWxlYXNlVG9waWMo\ndG9waWMpOwoKICAgICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluIHRvIGZv\ncmNlIGEgbmV3IGxlZGdlcgogICAgICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7\nCiAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3NhZ2VzKHRvcGljLCAz\nKSk7CgogICAgICAgIC8vIHNjYW4gbWVzc2FnZXMKICAgICAgICBMaW5rZWRC\nbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtl\nZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4oKTsKICAgICAgICBSYW5nZVNjYW5S\nZXF1ZXN0IG5leHRTY2FuID0gbmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMs\nIDMsIDIsIExvbmcuTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgbmV3IFJh\nbmdlU2NhblZlcmlmaWVyKHN1Yk1lc3NhZ2VzKG1zZ3MsIDIsIDMpLCBudWxs\nKSwgc3RhdHVzUXVldWUpOwogICAgICAgIG1hbmFnZXIuc2Nhbk1lc3NhZ2Vz\nKG5ldyBSYW5nZVNjYW5SZXF1ZXN0KHRvcGljLCAxLCAyLCBMb25nLk1BWF9W\nQUxVRSwKICAgICAgICAgICAgICAgIG5ldyBSYW5nZVNjYW5WZXJpZmllcihz\ndWJNZXNzYWdlcyhtc2dzLCAwLCAxKSwgbmV4dFNjYW4pLCBzdGF0dXNRdWV1\nZSkpOwogICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwoMTAg\nKiByZWFkRGVsYXksIFRpbWVVbml0Lk1JTExJU0VDT05EUyk7CiAgICAgICAg\naWYgKGIgPT0gbnVsbCkgewogICAgICAgICAgICBmYWlsKCJPbmUgc2NhbiBy\nZXF1ZXN0IGRvZXNuJ3QgZmluaXNoIik7CiAgICAgICAgfQogICAgICAgIGIg\nPSBzdGF0dXNRdWV1ZS5wb2xsKDEwICogcmVhZERlbGF5LCBUaW1lVW5pdC5N\nSUxMSVNFQ09ORFMpOwogICAgICAgIGlmIChiID09IG51bGwpIHsKICAgICAg\nICAgICAgZmFpbCgiT25lIHNjYW4gcmVxdWVzdCBkb2Vzbid0IGZpbmlzaCIp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQog\nICAgcHVibGljIHZvaWQgdGVzdEluY29uc2lzdGVudFN1YnNjcmlwdGlvblN0\nYXRlQW5kTGVkZ2VyUmFuZ2VzMSgpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIC8vIFNlZSB0aGUgY29tbWVudCBvZiBpbmNvbnNpc3RlbnRTdWJzY3Jp\ncHRpb25TdGF0ZUFuZExlZGdlclJhbmdlcy4KICAgICAgICAvLyBGb3IgdGhp\ncyBjYXNlLCBTdGVwICgyKSBmYWlsZWQgdG8gdXBkYXRlIHN1YnNjcmlwdGlv\nbiBzdGF0ZSBtZXRhZGF0YSwKICAgICAgICAvLyBidXQgTGVkZ2VyUmFuZ2Vz\nIGlzIHVwZGF0ZWQgc3VjY2Vzcy4KICAgICAgICAvLyBSZXN1bHQ6IHNjYW4g\nbWVzc2FnZXMgZnJvbSAxIHRvIDQgdGFrZSBwbGFjZSBvbiBsZWRnZXIgTDIu\nCiAgICAgICAgaW5jb25zaXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVBbmRMZWRn\nZXJSYW5nZXMoMSk7CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkK\nICAgIHB1YmxpYyB2b2lkIHRlc3RJbmNvbnNpc3RlbnRTdWJzY3JpcHRpb25T\ndGF0ZUFuZExlZGdlclJhbmdlczIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICAvLyBTZWUgdGhlIGNvbW1lbnQgb2YgaW5jb25zaXN0ZW50U3Vic2Ny\naXB0aW9uU3RhdGVBbmRMZWRnZXJSYW5nZXMuCiAgICAgICAgLy8gRm9yIHRo\naXMgY2FzZSwgc3RlcCAoMikgZmFpbGVkIHRvIHVwZGF0ZSBzdWJzY3JpcHRp\nb24gc3RhdGUgbWV0YWRhdGEsCiAgICAgICAgLy8gc3RlcCAoMykgc3VjY2Vz\nc2Z1bGx5IGRlbGV0ZSBMMSBidXQgZmFpbGVkIHRvIHVwZGF0ZSBMZWRnZXJS\nYW5nZXMuCiAgICAgICAgLy8gUmVzdWx0OiBzY2FuIG1lc3NhZ2VzIGZyb20g\nMSB0byA0IGZhbGxzIGluIEwxIGFuZCBMMiwKICAgICAgICAvLyAgICAgICAg\nIGJ1dCBCb29rS2VlcGVyIG1heSBjb21wbGFpbiBMMSBub3QgZm91bmQuCiAg\nICAgICAgaW5jb25zaXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVBbmRMZWRnZXJS\nYW5nZXMoMik7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaW5jZSBJbk1lbW9y\neVN1YnNjcmlwdGlvblN0YXRlIGFuZCBMZWRnZXJSYW5nZXMgaXMgbWFpbnRh\naW5lZAogICAgICogc2VwYXJhdGVseSwgdGhlcmUgbWF5IGV4aXN0IHN1Y2gg\naW5jb25zaXN0ZW50IHN0YXRlOgogICAgICogKDEpLiBUb3BpYyBsZWRnZXJz\nOiBMMSBbMSB+IDJdLCBMMiBbMyB+IF0KICAgICAqICgyKS4gU3Vic2NyaWJl\nciBjb25zdW1lcyB0byAyIGFuZCBJbk1lbW9yeVN1YnNjcmlwdGlvblN0YXRl\nIGlzIHVwZGF0ZWQKICAgICAqICAgICAgc3VjY2Vzc2Z1bGx5IGJ1dCBmYWls\nZWQgd2hlbiB1cGRhdGluZyBzdWJzY3JpcHRpb24gc3RhdGUgbWV0YWRhdGEK\nICAgICAqICgzKS4gQWJzdHJhY3RTdWJzY3JpcHRpb25NYW5hZ2VyI01lc3Nh\nZ2VzQ29uc3VtZWRUYXNrIHVzZQogICAgICogICAgICBJbk1lbW9yeVN1YnNj\ncmlwdGlvblN0YXRlIHRvIGRvIGdhcmJhZ2UgY29sbGVjdGlvbgogICAgICog\nICAgICBhbmQgTDEgaXMgZGVsZXRlCiAgICAgKiAoNCkuIElmIEh1YiByZXN0\nYXJ0cyBhdCB0aGlzIHRpbWUsIG9sZCBzdWJzY3JpcHRpb24gc3RhdGUgaXMg\ncmVhZCBhbmQKICAgICAqICAgICAgSHViIHdpbGwgdHJ5IHRvIGRlbGl2ZXIg\nbWVzc2FnZSBmcm9tIDEKICAgICAqLwogICAgcHVibGljIHZvaWQgaW5jb25z\naXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVBbmRMZWRnZXJSYW5nZXMoaW50IGZh\naWxlZENvdW50KSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBC\neXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoImlu\nY29uc2lzdGVudFN1YnNjcmlwdGlvblN0YXRlQW5kTGVkZ2VyUmFuZ2VzIik7\nCiAgICAgICAgZmluYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQgPSBCeXRl\nU3RyaW5nLmNvcHlGcm9tVXRmOCgic3ViSWQiKTsKICAgICAgICBMaW5rZWRM\naXN0PE1lc3NhZ2U+IG1zZ3MgPSBuZXcgTGlua2VkTGlzdDxNZXNzYWdlPigp\nOwoKICAgICAgICAvLyBtYWtlIGxlZGdlciBMMSBbMSB+IDJdCiAgICAgICAg\nYWNxdWlyZVRvcGljKHRvcGljKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJs\naXNoTWVzc2FnZXModG9waWMsIDIpKTsKICAgICAgICByZWxlYXNlVG9waWMo\ndG9waWMpOwoKICAgICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluIHRvIGZv\ncmNlIGEgbmV3IGxlZGdlciBMMiBbMyB+IF0KICAgICAgICBhY3F1aXJlVG9w\naWModG9waWMpOwogICAgICAgIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdl\ncyh0b3BpYywgMikpOwoKICAgICAgICBTdHViQ2FsbGJhY2s8Vm9pZD4gdm9p\nZENiID0gbmV3IFN0dWJDYWxsYmFjazxWb2lkPigpOwogICAgICAgIFN0dWJD\nYWxsYmFjazxTdWJzY3JpcHRpb25EYXRhPiBzdWJEYXRhQ2IgPSBuZXcgU3R1\nYkNhbGxiYWNrPFN1YnNjcmlwdGlvbkRhdGE+KCk7CiAgICAgICAgRWl0aGVy\nPFZvaWQsIFB1YlN1YkV4Y2VwdGlvbj4gdm9pZFJlc3VsdDsKICAgICAgICBF\naXRoZXI8U3Vic2NyaXB0aW9uRGF0YSwgUHViU3ViRXhjZXB0aW9uPiBzdWJE\nYXRhUmVzdWx0OwoKICAgICAgICAvLyBwcmVwYXJlIGZvciBzdWJzY3JpcHRp\nb24KICAgICAgICBzbS5hY3F1aXJlZFRvcGljKHRvcGljLCB2b2lkQ2IsIG51\nbGwpOwogICAgICAgIHZvaWRSZXN1bHQgPSBDb25jdXJyZW5jeVV0aWxzLnRh\na2Uodm9pZENiLnF1ZXVlKTsKICAgICAgICBhc3NlcnROdWxsKHZvaWRSZXN1\nbHQucmlnaHQoKSk7IC8vIG5vIGV4Y2VwdGlvbgoKICAgICAgICAvLyBEbyBz\ndWJzY3JpcHRpb24KICAgICAgICBTdWJzY3JpYmVSZXF1ZXN0IHN1YlJlcXVl\nc3QgPSBTdWJzY3JpYmVSZXF1ZXN0Lm5ld0J1aWxkZXIoKS5zZXRTdWJzY3Jp\nYmVySWQoc3Vic2NyaWJlcklkKQogICAgICAgICAgICAgICAgLnNldENyZWF0\nZU9yQXR0YWNoKENyZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gpLmJ1\naWxkKCk7CiAgICAgICAgc20uc2VydmVTdWJzY3JpYmVSZXF1ZXN0KHRvcGlj\nLCBzdWJSZXF1ZXN0LCBNZXNzYWdlU2VxSWQubmV3QnVpbGRlcigpLnNldExv\nY2FsQ29tcG9uZW50KDApLmJ1aWxkKCksIHN1YkRhdGFDYiwKICAgICAgICAg\nICAgICAgIG51bGwpOwogICAgICAgIHN1YkRhdGFSZXN1bHQgPSBDb25jdXJy\nZW5jeVV0aWxzLnRha2Uoc3ViRGF0YUNiLnF1ZXVlKTsKICAgICAgICBhc3Nl\ncnROb3ROdWxsKHN1YkRhdGFSZXN1bHQubGVmdCgpKTsgLy8gc2VydmVTdWJz\nY3JpYmVSZXF1ZXN0IHN1Y2Nlc3MKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHJldHVybiBhIFN1YnNjcmlw\ndGlvbkRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gb2JqZWN0CiAgICAgICAgYXNzZXJ0TnVsbChzdWJEYXRh\nUmVzdWx0LnJpZ2h0KCkpOyAvLyBubyBleGNlcHRpb24KCiAgICAgICAgLy8g\nc2ltdWxhdGUgaW5jb25zaXN0ZW50IHNpdHVhdGlvbiBiZXR3ZWVuIEluTWVt\nb3J5U3Vic2NyaXB0aW9uU3RhdGUgYW5kCiAgICAgICAgLy8gTGVkZ2VyUmFu\nZ2VzCiAgICAgICAgbWV0YWRhdGFNYW5hZ2VyRmFjdG9yeS5zZXRTZXJ2aWNl\nRG93bkNvdW50KGZhaWxlZENvdW50KTsKICAgICAgICBzbS5zZXRDb25zdW1l\nU2VxSWRGb3JTdWJzY3JpYmVyKHRvcGljLCBzdWJzY3JpYmVySWQsIE1lc3Nh\nZ2VTZXFJZC5uZXdCdWlsZGVyKCkuc2V0TG9jYWxDb21wb25lbnQoMikuYnVp\nbGQoKSwKICAgICAgICAgICAgICAgIHZvaWRDYiwgbnVsbCk7CiAgICAgICAg\ndm9pZFJlc3VsdCA9IENvbmN1cnJlbmN5VXRpbHMudGFrZSh2b2lkQ2IucXVl\ndWUpOwogICAgICAgIGFzc2VydE5vdE51bGwodm9pZFJlc3VsdC5yaWdodCgp\nKTsgLy8gdXBkYXRlIHN1YnNjcmlwdGlvbiBzdGF0ZSBmYWlsZWQKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBl\neHBlY3QgYSBleGNlcHRpb24KCiAgICAgICAgLy8gd2FpdCBBYnN0cmFjdFN1\nYnNjcmlwdGlvbk1hbmFnZXIjTWVzc2FnZXNDb25zdW1lZFRhc2sgdG8gZ2Fy\nYmFnZQogICAgICAgIC8vIGNvbGxlY3QgbGVkZ2VyIEwxCiAgICAgICAgVGhy\nZWFkLnNsZWVwKGNvbmYuZ2V0TWVzc2FnZXNDb25zdW1lZFRocmVhZFJ1bklu\ndGVydmFsKCkgKiAyKTsKCiAgICAgICAgLy8gc2ltdWxhdGUgaHViIHJlc3Rh\ncnQ6IHJlYWQgb2xkIHN1YnNjcmlwdGlvbiBzdGF0ZSBtZXRhZGF0YSBhbmQg\nZGVsaXZlcgogICAgICAgIC8vIG1lc3NhZ2VzIGZyb20gMQogICAgICAgIExp\nbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4gc3RhdHVzUXVldWUgPSBuZXcg\nTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPigpOwogICAgICAgIFJhbmdl\nU2NhblJlcXVlc3Qgc2NhbiA9IG5ldyBSYW5nZVNjYW5SZXF1ZXN0KHRvcGlj\nLCAxLCA0LCBMb25nLk1BWF9WQUxVRSwgbmV3IFJhbmdlU2NhblZlcmlmaWVy\nKG1zZ3MsIG51bGwpLAogICAgICAgICAgICAgICAgc3RhdHVzUXVldWUpOwog\nICAgICAgIG1hbmFnZXIuc2Nhbk1lc3NhZ2VzKHNjYW4pOwogICAgICAgIEJv\nb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwoMTAgKiByZWFkRGVsYXksIFRp\nbWVVbml0Lk1JTExJU0VDT05EUyk7CiAgICAgICAgaWYgKGIgPT0gbnVsbCkg\newogICAgICAgICAgICBmYWlsKCJTY2FuIHJlcXVlc3QgZG9lc24ndCBmaW5p\nc2giKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAw\nMCkKICAgIC8vIEFkZCB0aGlzIHRlc3QgY2FzZSBmb3IgQk9PS0tFRVBFUi00\nNTgKICAgIHB1YmxpYyB2b2lkIHRlc3RSZWFkV2hlblRvcGljQ2hhbmdlTGVk\nZ2VyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZmluYWwgQnl0ZVN0\ncmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0ZXN0UmVh\nZFdoZW5Ub3BpY0NoYW5nZUxlZGdlciIpOwogICAgICAgIExpbmtlZExpc3Q8\nTWVzc2FnZT4gbXNncyA9IG5ldyBMaW5rZWRMaXN0PE1lc3NhZ2U+KCk7Cgog\nICAgICAgIC8vIFdyaXRlIG1heEVudHJpZXNQZXJMZWRnZXIgZW50cmllcyB0\nbyBtYWtlIHRvcGljIGNoYW5nZSBsZWRnZXIKICAgICAgICBhY3F1aXJlVG9w\naWModG9waWMpOwogICAgICAgIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdl\ncyh0b3BpYywgbWF4RW50cmllc1BlckxlZGdlcikpOwoKICAgICAgICAvLyBO\nb3RpY2UsIGNoYW5nZSBsZWRnZXIgb3BlcmF0aW9uIGlzIGFzeW5jaHJvbm91\ncywgc28gd2Ugc2hvdWxkIHdhaXQhISEKICAgICAgICBUaHJlYWQuc2xlZXAo\nMjAwMCk7CgogICAgICAgIC8vIElzc3VlIGEgc2NhbiByZXF1ZXN0IHJpZ2h0\nIHN0YXJ0IGZyb20gdGhlIG5ldyBsZWRnZXIKICAgICAgICBMaW5rZWRCbG9j\na2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtlZEJs\nb2NraW5nUXVldWU8Qm9vbGVhbj4oKTsKICAgICAgICBSYW5nZVNjYW5SZXF1\nZXN0IHNjYW4gPSBuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgbWF4RW50\ncmllc1BlckxlZGdlciArIDEsIDEsIExvbmcuTUFYX1ZBTFVFLAogICAgICAg\nICAgICAgICAgbmV3IFJhbmdlU2NhblZlcmlmaWVyKG1zZ3MsIG51bGwpLCBz\ndGF0dXNRdWV1ZSk7CiAgICAgICAgbWFuYWdlci5zY2FuTWVzc2FnZXMoc2Nh\nbik7CiAgICAgICAgQm9vbGVhbiBiID0gc3RhdHVzUXVldWUucG9sbCgxMCAq\nIHJlYWREZWxheSwgVGltZVVuaXQuTUlMTElTRUNPTkRTKTsKICAgICAgICBp\nZiAoYiA9PSBudWxsKSB7CiAgICAgICAgICAgIGZhaWwoIlNjYW4gcmVxdWVz\ndCB0aW1lb3V0Iik7CiAgICAgICAgfQogICAgICAgIGFzc2VydEZhbHNlKCJF\neHBlY3Qgbm9uZSBtZXNzYWdlIGlzIHNjYW5uZWQgb24gdGhlIG5ldyBjcmVh\ndGVkIGxlZGdlciIsIGIpOwogICAgfQoKICAgIGNsYXNzIFRlc3RDYWxsYmFj\nayBpbXBsZW1lbnRzIENhbGxiYWNrPFB1YlN1YlByb3RvY29sLk1lc3NhZ2VT\nZXFJZD4gewoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBAU3VwcHJlc3NX\nYXJuaW5ncygidW5jaGVja2VkIikKICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIGV4Y2Vw\ndGlvbikgewogICAgICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xl\nYW4+IHN0YXR1c1F1ZXVlID0gKExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVh\nbj4pIGN0eDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0\nYXR1c1F1ZXVlLnB1dChmYWxzZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElu\ndGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBSdW50aW1lRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBAU3VwcHJlc3NXYXJu\naW5ncygidW5jaGVja2VkIikKICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRp\nb25GaW5pc2hlZChPYmplY3QgY3R4LCBQdWJTdWJQcm90b2NvbC5NZXNzYWdl\nU2VxSWQgcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgTGlua2Vk\nQmxvY2tpbmdRdWV1ZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRC\nbG9ja2luZ1F1ZXVlPEJvb2xlYW4+KSBjdHg7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBzdGF0dXNRdWV1ZS5wdXQodHJ1ZSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGUpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBM\naXN0PE1lc3NhZ2U+IHB1Ymxpc2hNZXNzYWdlcyhCeXRlU3RyaW5nIHRvcGlj\nLCBpbnQgbnVtTXNncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTGlz\ndDxNZXNzYWdlPiBtc2dzID0gSGVscGVyTWV0aG9kcy5nZXRSYW5kb21QdWJs\naXNoZWRNZXNzYWdlcyhudW1Nc2dzLCAxMDI0KTsKICAgICAgICBMaW5rZWRC\nbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtl\nZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4oKTsKICAgICAgICBmb3IgKE1lc3Nh\nZ2UgbXNnIDogbXNncykgewoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIG1hbmFnZXIucGVyc2lzdE1lc3NhZ2UobmV3IFBlcnNpc3RSZXF1\nZXN0KHRvcGljLCBtc2csIG5ldyBUZXN0Q2FsbGJhY2soKSwgc3RhdHVzUXVl\ndWUpKTsKICAgICAgICAgICAgICAgIC8vIHdhaXQgYSBtYXhpbXVtIG9mIGEg\nbWludXRlCiAgICAgICAgICAgICAgICBCb29sZWFuIGIgPSBzdGF0dXNRdWV1\nZS5wb2xsKDYwLCBUaW1lVW5pdC5TRUNPTkRTKTsKICAgICAgICAgICAgICAg\nIGlmIChiID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgUnVudGltZUV4Y2VwdGlvbigiUHVibGlzaCB0aW1lZCBvdXQiKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0\nZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1\nbnRpbWVFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIG1zZ3M7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nYWNxdWlyZVRvcGljKEJ5dGVTdHJpbmcgdG9waWMpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIFNlbWFwaG9yZSBsYXRjaCA9IG5ldyBTZW1hcGhvcmUo\nMSk7CiAgICAgICAgbGF0Y2guYWNxdWlyZSgpOwogICAgICAgIG1hbmFnZXIu\nYWNxdWlyZWRUb3BpYyh0b3BpYywgbmV3IENhbGxiYWNrPFZvaWQ+KCkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9pZCByZXN1bHRPZk9w\nZXJhdGlvbikgewogICAgICAgICAgICAgICAgZmFpbHVyZUV4Y2VwdGlvbiA9\nIG51bGw7CiAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVh\nc2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBj\ndHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAg\nICAgIGZhaWx1cmVFeGNlcHRpb24gPSBleGNlcHRpb247CiAgICAgICAgICAg\nICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0sIGxhdGNoKTsKICAgICAgICBsYXRjaC5hY3F1aXJlKCk7\nCiAgICAgICAgbGF0Y2gucmVsZWFzZSgpOwogICAgICAgIGlmIChudWxsICE9\nIGZhaWx1cmVFeGNlcHRpb24pIHsKICAgICAgICAgICAgdGhyb3cgZmFpbHVy\nZUV4Y2VwdGlvbjsKICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHZv\naWQgcmVsZWFzZVRvcGljKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIG1hbmFnZXIubG9zdFRvcGljKHRvcGlj\nKTsKICAgICAgICAvLyBiYWNrd2FyZCB0ZXN0aW5nIGxlZGdlciByYW5nZXMg\nd2l0aG91dCBzdGFydCBzZXEgaWQKICAgICAgICBpZiAocmVtb3ZlU3RhcnRT\nZXFJZCkgewogICAgICAgICAgICBTZW1hcGhvcmUgbGF0Y2ggPSBuZXcgU2Vt\nYXBob3JlKDEpOwogICAgICAgICAgICBsYXRjaC5hY3F1aXJlKCk7CiAgICAg\nICAgICAgIHRwTWFuYWdlci5yZWFkVG9waWNQZXJzaXN0ZW5jZUluZm8odG9w\naWMsIG5ldyBDYWxsYmFjazxWZXJzaW9uZWQ8TGVkZ2VyUmFuZ2VzPj4oKSB7\nCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZlcnNp\nb25lZDxMZWRnZXJSYW5nZXM+IHJhbmdlcykgewogICAgICAgICAgICAgICAg\nICAgIGlmIChudWxsID09IHJhbmdlcykgewogICAgICAgICAgICAgICAgICAg\nICAgICBmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFB1YlN1YkV4Y2VwdGlvbi5O\nb1RvcGljUGVyc2lzdGVuY2VJbmZvRXhjZXB0aW9uKCJObyBwZXJzaXN0ZW5j\nZSBpbmZvIGZvdW5kIGZvciB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4\nKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgp\nLnJlbGVhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8g\nYnVpbGQgYSBuZXcgbGVkZ2VyIHJhbmdlcyB3L28gc3RhcnQgc2VxIGlkLgog\nICAgICAgICAgICAgICAgICAgIExlZGdlclJhbmdlcy5CdWlsZGVyIGJ1aWxk\nZXIgPSBMZWRnZXJSYW5nZXMubmV3QnVpbGRlcigpOwogICAgICAgICAgICAg\nICAgICAgIGZpbmFsIExpc3Q8TGVkZ2VyUmFuZ2U+IHJhbmdlc0xpc3QgPSBy\nYW5nZXMuZ2V0VmFsdWUoKS5nZXRSYW5nZXNMaXN0KCk7CiAgICAgICAgICAg\nICAgICAgICAgZm9yIChMZWRnZXJSYW5nZSByYW5nZSA6IHJhbmdlc0xpc3Qp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgTGVkZ2VyUmFuZ2UuQnVpbGRl\nciBuZXdSYW5nZUJ1aWxkZXIgPSBMZWRnZXJSYW5nZS5uZXdCdWlsZGVyKCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1JhbmdlQnVpbGRlci5zZXRM\nZWRnZXJJZChyYW5nZS5nZXRMZWRnZXJJZCgpKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKHJhbmdlLmhhc0VuZFNlcUlkSW5jbHVkZWQoKSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UmFuZ2VCdWlsZGVyLnNl\ndEVuZFNlcUlkSW5jbHVkZWQocmFuZ2UuZ2V0RW5kU2VxSWRJbmNsdWRlZCgp\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgICAgICBidWlsZGVyLmFkZFJhbmdlcyhuZXdSYW5nZUJ1aWxkZXIuYnVp\nbGQoKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIHRwTWFuYWdlci53cml0ZVRvcGljUGVyc2lzdGVuY2VJbmZvKHRvcGlj\nLCBidWlsZGVyLmJ1aWxkKCksIHJhbmdlcy5nZXRWZXJzaW9uKCksCiAgICAg\nICAgICAgICAgICAgICAgbmV3IENhbGxiYWNrPFZlcnNpb24+KCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAg\nICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0\nIGN0eCwgVmVyc2lvbiBuZXdWZXJzaW9uKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gbnVsbDsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgp\nOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJs\naWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhj\nZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZmFpbHVyZUV4Y2VwdGlvbiA9IGV4Y2VwdGlvbjsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nfSwgY3R4KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9u\nRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24p\nIHsKICAgICAgICAgICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gZXhj\nZXB0aW9uOwogICAgICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKWN0eCku\ncmVsZWFzZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBs\nYXRjaCk7CiAgICAgICAgICAgIGxhdGNoLmFjcXVpcmUoKTsKICAgICAgICAg\nICAgbGF0Y2gucmVsZWFzZSgpOwogICAgICAgICAgICBpZiAobnVsbCAhPSBm\nYWlsdXJlRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBmYWls\ndXJlRXhjZXB0aW9uOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoK\nICAgIHByb3RlY3RlZCB2b2lkIGNvbnN1bWVkVW50aWwoQnl0ZVN0cmluZyB0\nb3BpYywgbG9uZyBzZXFJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nbWFuYWdlci5jb25zdW1lZFVudGlsKHRvcGljLCBzZXFJZCk7CiAgICB9Cgp9\nCg==\n","encoding":"base64"}

