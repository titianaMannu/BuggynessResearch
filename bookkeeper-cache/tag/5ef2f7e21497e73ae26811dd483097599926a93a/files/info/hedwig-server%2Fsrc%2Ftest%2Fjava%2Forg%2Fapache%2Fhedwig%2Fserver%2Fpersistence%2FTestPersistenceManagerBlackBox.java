{"sha":"7a865ee98a1caafd10d36ea46f74d6c097328d7b","node_id":"MDQ6QmxvYjE1NzU5NTY6N2E4NjVlZTk4YTFjYWFmZDEwZDM2ZWE0NmY3NGQ2YzA5NzMyOGQ3Yg==","size":11301,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/7a865ee98a1caafd10d36ea46f74d6c097328d7b","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwu\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2Nr\naW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhv\ncmU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmlt\ncG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2w7CmltcG9ydCBv\ncmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rv\ncnk7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKCmltcG9ydCBjb20uZ29vZ2xl\nLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5IZWxwZXJNZXRob2RzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhj\nZXB0aW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljcy5Ub3BpY093bmVyc2hp\ncENoYW5nZUxpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRp\nbC5DYWxsYmFjazsKCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBUZXN0UGVyc2lz\ndGVuY2VNYW5hZ2VyQmxhY2tCb3ggZXh0ZW5kcyBUZXN0Q2FzZSB7CiAgICBw\ncm90ZWN0ZWQgUGVyc2lzdGVuY2VNYW5hZ2VyIHBlcnNpc3RlbmNlTWFuYWdl\ncjsKICAgIHByb3RlY3RlZCBpbnQgTlVNX01FU1NBR0VTX1RPX1RFU1QgPSA1\nOwogICAgcHJvdGVjdGVkIGludCBOVU1fVE9QSUNTX1RPX1RFU1QgPSA1Owog\nICAgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihUZXN0UGVyc2lzdGVuY2VNYW5hZ2VyQmxhY2tCb3guY2xhc3MpOwog\nICAgVGVzdENhbGxiYWNrIHRlc3RDYWxsYmFjayA9IG5ldyBUZXN0Q2FsbGJh\nY2soKTsKCiAgICBSdW50aW1lRXhjZXB0aW9uIGZhaWx1cmVFeGNlcHRpb247\nCgogICAgY2xhc3MgVGVzdENhbGxiYWNrIGltcGxlbWVudHMgQ2FsbGJhY2s8\nUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkPiB7CgogICAgICAgIHB1Ymxp\nYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBQdWJTdWJFeGNl\ncHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgIHRocm93IChmYWlsdXJl\nRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXhjZXB0aW9uKSk7\nCiAgICAgICAgfQoKICAgICAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVj\na2VkIikKICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5pc2hlZChP\nYmplY3QgY3R4LCBQdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQgcmVzdWx0\nT2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1\nZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVl\nPEJvb2xlYW4+KSBjdHg7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBzdGF0dXNRdWV1ZS5wdXQodHJ1ZSk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nIHRocm93IChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRp\nb24oZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGNs\nYXNzIFJhbmdlU2NhblZlcmlmaWVyTGlzdGVuZXIgaW1wbGVtZW50cyBTY2Fu\nQ2FsbGJhY2sgewogICAgICAgIExpc3Q8TWVzc2FnZT4gcHViTXNnczsKCiAg\nICAgICAgcHVibGljIFJhbmdlU2NhblZlcmlmaWVyTGlzdGVuZXIoTGlzdDxN\nZXNzYWdlPiBwdWJNc2dzKSB7CiAgICAgICAgICAgIHRoaXMucHViTXNncyA9\nIHB1Yk1zZ3M7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBtZXNz\nYWdlU2Nhbm5lZChPYmplY3QgY3R4LCBNZXNzYWdlIHJlY3ZNZXNzYWdlKSB7\nCiAgICAgICAgICAgIGlmIChwdWJNc2dzLmlzRW1wdHkoKSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGlt\nZUV4Y2VwdGlvbigiTWVzc2FnZSByZWNlaXZlZCB3aGVuIG5vbmUgZXhwZWN0\nZWQiKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1lc3NhZ2UgcHVi\nTXNnID0gcHViTXNncy5nZXQoMCk7CiAgICAgICAgICAgIGlmICghSGVscGVy\nTWV0aG9kcy5hcmVFcXVhbChyZWN2TWVzc2FnZSwgcHViTXNnKSkgewogICAg\nICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVu\ndGltZUV4Y2VwdGlvbigiU2Nhbm5lZCBtZXNzYWdlIG5vdCBlcXVhbCB0byBl\neHBlY3RlZCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwdWJNc2dz\nLnJlbW92ZSgwKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNj\nYW5GYWlsZWQoT2JqZWN0IGN0eCwgRXhjZXB0aW9uIGV4Y2VwdGlvbikgewog\nICAgICAgICAgICB0aHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50\naW1lRXhjZXB0aW9uKGV4Y2VwdGlvbikpOwogICAgICAgIH0KCiAgICAgICAg\nQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICAgICAgcHVibGlj\nIHZvaWQgc2NhbkZpbmlzaGVkKE9iamVjdCBjdHgsIFJlYXNvbkZvckZpbmlz\naCByZWFzb24pIHsKICAgICAgICAgICAgaWYgKHJlYXNvbiAhPSBSZWFzb25G\nb3JGaW5pc2guTk9fTU9SRV9NRVNTQUdFUykgewogICAgICAgICAgICAgICAg\ndGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2VwdGlv\nbigiU2NhbiBmaW5pc2hlZCBwcmVtYXR1cmVseSAiICsgcmVhc29uKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxC\nb29sZWFuPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJv\nb2xlYW4+KSBjdHg7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBzdGF0dXNRdWV1ZS5wdXQodHJ1ZSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRo\ncm93IChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24o\nZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBjbGFz\ncyBQb2ludFNjYW5WZXJpZmllckxpc3RlbmVyIGltcGxlbWVudHMgU2NhbkNh\nbGxiYWNrIHsKICAgICAgICBMaXN0PE1lc3NhZ2U+IHB1Yk1zZ3M7CiAgICAg\nICAgQnl0ZVN0cmluZyB0b3BpYzsKCiAgICAgICAgcHVibGljIFBvaW50U2Nh\nblZlcmlmaWVyTGlzdGVuZXIoTGlzdDxNZXNzYWdlPiBwdWJNc2dzLCBCeXRl\nU3RyaW5nIHRvcGljKSB7CiAgICAgICAgICAgIHRoaXMudG9waWMgPSB0b3Bp\nYzsKICAgICAgICAgICAgdGhpcy5wdWJNc2dzID0gcHViTXNnczsKICAgICAg\nICB9CgogICAgICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQog\nICAgICAgIHB1YmxpYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVjdCBjdHgs\nIE1lc3NhZ2UgcmVjdk1lc3NhZ2UpIHsKCiAgICAgICAgICAgIE1lc3NhZ2Ug\ncHViTXNnID0gcHViTXNncy5nZXQoMCk7CiAgICAgICAgICAgIGlmICghSGVs\ncGVyTWV0aG9kcy5hcmVFcXVhbChyZWN2TWVzc2FnZSwgcHViTXNnKSkgewog\nICAgICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcg\nUnVudGltZUV4Y2VwdGlvbigiU2Nhbm5lZCBtZXNzYWdlIG5vdCBlcXVhbCB0\nbyBleHBlY3RlZCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwdWJN\nc2dzLnJlbW92ZSgwKTsKCiAgICAgICAgICAgIGlmIChwdWJNc2dzLmlzRW1w\ndHkoKSkgewogICAgICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxC\nb29sZWFuPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJv\nb2xlYW4+KSBjdHg7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgIHN0YXR1c1F1ZXVlLnB1dCh0cnVlKTsKICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBS\ndW50aW1lRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvbmcgc2VxSWQgPSBy\nZWN2TWVzc2FnZS5nZXRNc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCk7CiAg\nICAgICAgICAgICAgICBzZXFJZCA9IHBlcnNpc3RlbmNlTWFuYWdlci5nZXRT\nZXFJZEFmdGVyU2tpcHBpbmcodG9waWMsIHNlcUlkLCAxKTsKICAgICAgICAg\nICAgICAgIFNjYW5SZXF1ZXN0IHJlcXVlc3QgPSBuZXcgU2NhblJlcXVlc3Qo\ndG9waWMsIHNlcUlkLCBuZXcgUG9pbnRTY2FuVmVyaWZpZXJMaXN0ZW5lcihw\ndWJNc2dzLCB0b3BpYyksIGN0eCk7CiAgICAgICAgICAgICAgICBwZXJzaXN0\nZW5jZU1hbmFnZXIuc2NhblNpbmdsZU1lc3NhZ2UocmVxdWVzdCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzY2Fu\nRmFpbGVkKE9iamVjdCBjdHgsIEV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAg\nICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGlt\nZUV4Y2VwdGlvbihleGNlcHRpb24pKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIHNjYW5GaW5pc2hlZChPYmplY3QgY3R4LCBSZWFzb25Gb3JG\naW5pc2ggcmVhc29uKSB7CgogICAgICAgIH0KCiAgICB9CgogICAgY2xhc3Mg\nU2NhblZlcmlmaWVyIGltcGxlbWVudHMgUnVubmFibGUgewogICAgICAgIExp\nc3Q8TWVzc2FnZT4gcHViTXNnczsKICAgICAgICBCeXRlU3RyaW5nIHRvcGlj\nOwogICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4gc3RhdHVz\nUXVldWUgPSBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPigpOwoK\nICAgICAgICBwdWJsaWMgU2NhblZlcmlmaWVyKEJ5dGVTdHJpbmcgdG9waWMs\nIExpc3Q8TWVzc2FnZT4gcHViTXNncykgewogICAgICAgICAgICB0aGlzLnRv\ncGljID0gdG9waWM7CiAgICAgICAgICAgIHRoaXMucHViTXNncyA9IHB1Yk1z\nZ3M7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAg\nICAgICAgICAgIC8vIHN0YXJ0IHRoZSBzY2FuCiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBpZiAocGVyc2lzdGVuY2VNYW5hZ2VyIGluc3Rh\nbmNlb2YgUGVyc2lzdGVuY2VNYW5hZ2VyV2l0aFJhbmdlU2NhbikgewoKICAg\nICAgICAgICAgICAgICAgICBTY2FuQ2FsbGJhY2sgbGlzdGVuZXIgPSBuZXcg\nUmFuZ2VTY2FuVmVyaWZpZXJMaXN0ZW5lcihwdWJNc2dzKTsKCiAgICAgICAg\nICAgICAgICAgICAgUGVyc2lzdGVuY2VNYW5hZ2VyV2l0aFJhbmdlU2NhbiBy\nYW5nZVBlcnNpc3RlbmNlTWFuYWdlciA9IChQZXJzaXN0ZW5jZU1hbmFnZXJX\naXRoUmFuZ2VTY2FuKSBwZXJzaXN0ZW5jZU1hbmFnZXI7CgogICAgICAgICAg\nICAgICAgICAgIHJhbmdlUGVyc2lzdGVuY2VNYW5hZ2VyLnNjYW5NZXNzYWdl\ncyhuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgZ2V0TG93ZXN0U2VxSWQo\nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgTlVNX01FU1NBR0VTX1RPX1RFU1QgKyAxLCBMb25n\nLk1BWF9WQUxVRSwgbGlzdGVuZXIsIHN0YXR1c1F1ZXVlKSk7CgogICAgICAg\nICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgU2NhbkNh\nbGxiYWNrIGxpc3RlbmVyID0gbmV3IFBvaW50U2NhblZlcmlmaWVyTGlzdGVu\nZXIocHViTXNncywgdG9waWMpOwogICAgICAgICAgICAgICAgICAgIHBlcnNp\nc3RlbmNlTWFuYWdlcgogICAgICAgICAgICAgICAgICAgIC5zY2FuU2luZ2xl\nTWVzc2FnZShuZXcgU2NhblJlcXVlc3QodG9waWMsIGdldExvd2VzdFNlcUlk\nKCksIGxpc3RlbmVyLCBzdGF0dXNRdWV1ZSkpOwoKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIC8vIG5vdyBsaXN0ZW4gZm9yIGl0IHRvIGZp\nbmlzaAogICAgICAgICAgICAgICAgLy8gd2FpdCBhIG1heGltdW0gb2YgYSBt\naW51dGUKICAgICAgICAgICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVl\nLnBvbGwoNjAsIFRpbWVVbml0LlNFQ09ORFMpOwogICAgICAgICAgICAgICAg\naWYgKGIgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IChm\nYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oIlNjYW5u\naW5nIHRpbWVkIG91dCIpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGlt\nZUV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCgogICAgY2xhc3MgUHVibGlzaGVyIGltcGxlbWVudHMgUnVubmFibGUgewog\nICAgICAgIExpc3Q8TWVzc2FnZT4gcHViTXNnczsKICAgICAgICBCeXRlU3Ry\naW5nIHRvcGljOwoKICAgICAgICBwdWJsaWMgUHVibGlzaGVyKEJ5dGVTdHJp\nbmcgdG9waWMsIExpc3Q8TWVzc2FnZT4gcHViTXNncykgewogICAgICAgICAg\nICB0aGlzLnB1Yk1zZ3MgPSBwdWJNc2dzOwogICAgICAgICAgICB0aGlzLnRv\ncGljID0gdG9waWM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVh\nbj4gc3RhdHVzUXVldWUgPSBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29s\nZWFuPigpOwoKICAgICAgICAgICAgZm9yIChNZXNzYWdlIG1zZyA6IHB1Yk1z\nZ3MpIHsKCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIHBlcnNpc3RlbmNlTWFuYWdlci5wZXJzaXN0TWVzc2FnZShuZXcgUGVy\nc2lzdFJlcXVlc3QodG9waWMsIG1zZywgdGVzdENhbGxiYWNrLCBzdGF0dXNR\ndWV1ZSkpOwogICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgYSBtYXhpbXVt\nIG9mIGEgbWludXRlCiAgICAgICAgICAgICAgICAgICAgQm9vbGVhbiBiID0g\nc3RhdHVzUXVldWUucG9sbCg2MCwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGIgPT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgICAgICB0aHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50\naW1lRXhjZXB0aW9uKCJTY2FubmluZyB0aW1lZCBvdXQiKSk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIHRocm93\nIChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oZSkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHNldFVw\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbG9nZ2VyLmluZm8oIlNU\nQVJUSU5HICIgKyBnZXROYW1lKCkpOwogICAgICAgIHBlcnNpc3RlbmNlTWFu\nYWdlciA9IGluc3RhbnRpYXRlUGVyc2lzdGVuY2VNYW5hZ2VyKCk7CiAgICAg\nICAgZmFpbHVyZUV4Y2VwdGlvbiA9IG51bGw7CiAgICAgICAgbG9nZ2VyLmlu\nZm8oIlBlcnNpc3RlbmNlIE1hbmFnZXIgdGVzdCBzZXR1cCBmaW5pc2hlZCIp\nOwogICAgfQoKICAgIGFic3RyYWN0IGxvbmcgZ2V0TG93ZXN0U2VxSWQoKTsK\nCiAgICBhYnN0cmFjdCBQZXJzaXN0ZW5jZU1hbmFnZXIgaW5zdGFudGlhdGVQ\nZXJzaXN0ZW5jZU1hbmFnZXIoKSB0aHJvd3MgRXhjZXB0aW9uOwoKICAgIEBP\ndmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgdGVhckRvd24oKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBsb2dnZXIuaW5mbygidGVhckRvd24gc3Rh\ncnRpbmciKTsKICAgICAgICBwZXJzaXN0ZW5jZU1hbmFnZXIuc3RvcCgpOwog\nICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICAgICAgbG9nZ2VyLmluZm8o\nIkZJTklTSEVEICIgKyBnZXROYW1lKCkpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBCeXRlU3RyaW5nIGdldFRvcGljTmFtZShpbnQgbnVtYmVyKSB7CiAgICAg\nICAgcmV0dXJuIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0b3BpYyIgKyBu\ndW1iZXIpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0UGVyc2lzdGVuY2VNYW5hZ2VyKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgTGlzdDxUaHJlYWQ+IHB1Ymxpc2hlclRocmVh\nZHMgPSBuZXcgTGlua2VkTGlzdDxUaHJlYWQ+KCk7CiAgICAgICAgTGlzdDxU\naHJlYWQ+IHNjYW5uZXJUaHJlYWRzID0gbmV3IExpbmtlZExpc3Q8VGhyZWFk\nPigpOwogICAgICAgIFRocmVhZCB0aHJlYWQ7CiAgICAgICAgU2VtYXBob3Jl\nIGxhdGNoID0gbmV3IFNlbWFwaG9yZSgxKTsKCiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBOVU1fVE9QSUNTX1RPX1RFU1Q7IGkrKykgewogICAgICAg\nICAgICBCeXRlU3RyaW5nIHRvcGljID0gZ2V0VG9waWNOYW1lKGkpOwoKICAg\nICAgICAgICAgaWYgKHBlcnNpc3RlbmNlTWFuYWdlciBpbnN0YW5jZW9mIFRv\ncGljT3duZXJzaGlwQ2hhbmdlTGlzdGVuZXIpIHsKCiAgICAgICAgICAgICAg\nICBUb3BpY093bmVyc2hpcENoYW5nZUxpc3RlbmVyIHRvY2wgPSAoVG9waWNP\nd25lcnNoaXBDaGFuZ2VMaXN0ZW5lcikgcGVyc2lzdGVuY2VNYW5hZ2VyOwoK\nICAgICAgICAgICAgICAgIGxhdGNoLmFjcXVpcmUoKTsKCiAgICAgICAgICAg\nICAgICB0b2NsLmFjcXVpcmVkVG9waWModG9waWMsIG5ldyBDYWxsYmFjazxW\nb2lkPigpIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoT2Jq\nZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAg\nICAgICAgICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRp\nbWVFeGNlcHRpb24oZXhjZXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgKChTZW1hcGhvcmUpIGN0eCkucmVsZWFzZSgpOwogICAgICAgICAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQo\nT2JqZWN0IGN0eCwgVm9pZCByZXMpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgKChTZW1hcGhvcmUpIGN0eCkucmVsZWFzZSgpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIGxhdGNoKTsKCiAgICAgICAg\nICAgICAgICBsYXRjaC5hY3F1aXJlKCk7CiAgICAgICAgICAgICAgICBsYXRj\naC5yZWxlYXNlKCk7CiAgICAgICAgICAgICAgICBpZiAoZmFpbHVyZUV4Y2Vw\ndGlvbiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKEV4\nY2VwdGlvbikgZmFpbHVyZUV4Y2VwdGlvbi5nZXRDYXVzZSgpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIExpc3Q8TWVz\nc2FnZT4gbXNncyA9IEhlbHBlck1ldGhvZHMuZ2V0UmFuZG9tUHVibGlzaGVk\nTWVzc2FnZXMoTlVNX01FU1NBR0VTX1RPX1RFU1QsIDEwMjQpOwoKICAgICAg\nICAgICAgdGhyZWFkID0gbmV3IFRocmVhZChuZXcgUHVibGlzaGVyKHRvcGlj\nLCBtc2dzKSk7CiAgICAgICAgICAgIHB1Ymxpc2hlclRocmVhZHMuYWRkKHRo\ncmVhZCk7CiAgICAgICAgICAgIHRocmVhZC5zdGFydCgpOwoKICAgICAgICAg\nICAgdGhyZWFkID0gbmV3IFRocmVhZChuZXcgU2NhblZlcmlmaWVyKHRvcGlj\nLCBtc2dzKSk7CiAgICAgICAgICAgIHNjYW5uZXJUaHJlYWRzLmFkZCh0aHJl\nYWQpOwogICAgICAgIH0KICAgICAgICBmb3IgKFRocmVhZCB0IDogcHVibGlz\naGVyVGhyZWFkcykgewogICAgICAgICAgICB0LmpvaW4oKTsKICAgICAgICB9\nCgogICAgICAgIGZvciAoVGhyZWFkIHQgOiBzY2FubmVyVGhyZWFkcykgewog\nICAgICAgICAgICB0LnN0YXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBmb3Ig\nKFRocmVhZCB0IDogc2Nhbm5lclRocmVhZHMpIHsKICAgICAgICAgICAgdC5q\nb2luKCk7CiAgICAgICAgfQoKICAgICAgICBhc3NlcnRFcXVhbHMobnVsbCwg\nZmFpbHVyZUV4Y2VwdGlvbik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBOVU1fVE9QSUNTX1RPX1RFU1Q7IGkrKykgewogICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMocGVyc2lzdGVuY2VNYW5hZ2VyLmdldEN1cnJlbnRTZXFJZEZv\nclRvcGljKGdldFRvcGljTmFtZShpKSkuZ2V0TG9jYWxDb21wb25lbnQoKSwK\nICAgICAgICAgICAgICAgICAgICAgICAgIGdldEV4cGVjdGVkU2VxSWQoTlVN\nX01FU1NBR0VTX1RPX1RFU1QpKTsKICAgICAgICB9CgogICAgfQoKICAgIGFi\nc3RyYWN0IGxvbmcgZ2V0RXhwZWN0ZWRTZXFJZChpbnQgbnVtUHVibGlzaGVk\nKTsKCn0K\n","encoding":"base64"}

