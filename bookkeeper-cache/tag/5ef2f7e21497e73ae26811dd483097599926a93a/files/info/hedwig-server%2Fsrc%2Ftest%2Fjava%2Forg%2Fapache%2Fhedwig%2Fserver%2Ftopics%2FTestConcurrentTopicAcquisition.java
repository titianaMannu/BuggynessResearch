{"sha":"274578ceb5547653f57b3662d7c4a2c70f450125","node_id":"MDQ6QmxvYjE1NzU5NTY6Mjc0NTc4Y2ViNTU0NzY1M2Y1N2IzNjYyZDdjNGEyYzcwZjQ1MDEyNQ==","size":7941,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/274578ceb5547653f57b3662d7c4a2c70f450125","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TeW5jaHJvbm91c1F1ZXVlOwpp\nbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jvb2xl\nYW47CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWlj\nSW50ZWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29u\nZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmNsaWVudC5hcGkuUHVibGlzaGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LmFwaS5TdWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJz\nY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLkhlZHdpZ0h1YlRlc3RCYXNlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnV0aWwuQ29uY3VycmVuY3lVdGlsczsKaW1wb3J0IG9yZy5q\ndW5pdC5UZXN0OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0\ncmluZzsKCnB1YmxpYyBjbGFzcyBUZXN0Q29uY3VycmVudFRvcGljQWNxdWlz\naXRpb24gZXh0ZW5kcyBIZWR3aWdIdWJUZXN0QmFzZSB7CgogICAgLy8gQ2xp\nZW50IHZhcmlhYmxlcwogICAgcHJvdGVjdGVkIEhlZHdpZ0NsaWVudCBjbGll\nbnQ7CiAgICBwcm90ZWN0ZWQgUHVibGlzaGVyIHB1Ymxpc2hlcjsKICAgIHBy\nb3RlY3RlZCBTdWJzY3JpYmVyIHN1YnNjcmliZXI7CiAgICAKICAgIGZpbmFs\nIExpbmtlZEJsb2NraW5nUXVldWU8Qnl0ZVN0cmluZz4gc3Vic2NyaWJlcnMg\nPQogICAgICAgICAgICBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCeXRlU3Ry\naW5nPigpOwogICAgZmluYWwgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KCJjb25jdXJyZW50LXRvcGljIik7CiAgICBmaW5h\nbCBpbnQgbnVtU3Vic2NyaWJlcnMgPSAzMDA7CiAgICBmaW5hbCBBdG9taWNJ\nbnRlZ2VyIG51bURvbmUgPSBuZXcgQXRvbWljSW50ZWdlcigwKTsKCiAgICAv\nLyBTeW5jaHJvbm91c1F1ZXVlcyB0byB2ZXJpZnkgYXN5bmMgY2FsbHMKICAg\nIHByaXZhdGUgZmluYWwgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBxdWV1\nZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CiAgICAKICAg\nIGNsYXNzIFN1YkNhbGxiYWNrIGltcGxlbWVudHMgQ2FsbGJhY2s8Vm9pZD4g\newogICAgICAgIAogICAgICAgIEJ5dGVTdHJpbmcgc3ViSWQ7CiAgICAgICAg\nCiAgICAgICAgcHVibGljIFN1YkNhbGxiYWNrKEJ5dGVTdHJpbmcgc3ViSWQp\nIHsKICAgICAgICAgICAgdGhpcy5zdWJJZCA9IHN1YklkOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uRmluaXNoZWQoT2JqZWN0IGN0eCwKICAgICAgICAgICAgICAgIFZvaWQg\ncmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgaWYgKGxvZ2dlci5p\nc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZGVi\ndWcoInN1YnNjcmliZXIgIiArIHN1YklkLnRvU3RyaW5nVXRmOCgpICsgIiBz\ndWNjZWVkLiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGludCBkb25l\nID0gbnVtRG9uZS5pbmNyZW1lbnRBbmRHZXQoKTsKICAgICAgICAgICAgaWYg\nKGRvbmUgPT0gbnVtU3Vic2NyaWJlcnMpIHsKICAgICAgICAgICAgICAgIENv\nbmN1cnJlbmN5VXRpbHMucHV0KHF1ZXVlLCBmYWxzZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LAogICAgICAgICAg\nICAgICAgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAg\nICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1Zygic3Vic2NyaWJlciAiICsgc3ViSWQudG9TdHJp\nbmdVdGY4KCkgKyAiIGZhaWxlZCA6ICIsIGV4Y2VwdGlvbik7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQoc3Vic2Ny\naWJlcnMsIHN1YklkKTsKICAgICAgICAgICAgLy8gQ29uY3VycmVuY3lVdGls\ncy5wdXQocXVldWUsIGZhbHNlKTsKICAgICAgICB9CiAgICB9CiAgICAKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBzdXBlci5zZXRVcCgpOwogICAgICAgIGNsaWVu\ndCA9IG5ldyBIZWR3aWdDbGllbnQobmV3IEh1YkNsaWVudENvbmZpZ3VyYXRp\nb24oKSk7CgogICAgICAgIHB1Ymxpc2hlciA9IGNsaWVudC5nZXRQdWJsaXNo\nZXIoKTsKICAgICAgICBzdWJzY3JpYmVyID0gY2xpZW50LmdldFN1YnNjcmli\nZXIoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHRl\nYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc3ViLmlu\ndGVycnVwdCgpOwogICAgICAgIC8vIHN1Yi5qb2luKCk7CiAgICAgICAgCiAg\nICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAgICAgc3VwZXIudGVhckRvd24o\nKTsKICAgIH0KICAgIAogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1\nYmxpYyB2b2lkIHRlc3RUb3BpY0FjcXVpc3Rpb24oKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBsb2dnZXIuaW5mbygiU3RhcnQgY29uY3VycmVudCB0\nb3BpYyBhY3F1aXN0aW9uIHRlc3QuIik7CiAgICAgICAgCiAgICAgICAgLy8g\nbGV0IG9uZSBib29raWUgZG93biB0byBjYXVzZSBub3QgZW5vdWdoIGJvb2tp\nZSBleGNlcHRpb24KICAgICAgICBsb2dnZXIuaW5mbygiVGVhciBkb3duIG9u\nZSBib29raWUgc2VydmVyLiIpOwogICAgICAgIGJrdGIudGVhckRvd25PbmVC\nb29raWVTZXJ2ZXIoKTsKICAgICAgICAKICAgICAgICAvLyBJbiBjdXJyZW50\nIGltcGxlbWVudGF0aW9uLCB0aGUgZmlyc3Qgc2V2ZXJhbCBzdWJzY3JpcHRp\nb25zIHdpbGwgc3VjY2VlZCB0byBwdXQgdG9waWMgaW4gdG9waWMgbWFuYWdl\nciBzZXQsCiAgICAgICAgLy8gYmVjYXVzZSB0aGUgdGVhciBkb3duIGJvb2tp\nZSBzZXJ2ZXIncyB6ayBub2RlIG5lZWQgdGltZSB0byBkaXNhcHBlYXIKICAg\nICAgICAvLyBzb21lIHN1YnNjcmlwdGlvbnMgd2lsbCBjcmVhdGUgbGVkZ2Vy\nIHN1Y2Nlc3NmdWxseSwgdGhlbiBvdGhlciBzdWJzY3JpcHRpb25zIHdpbGwg\nZmFpbC4KICAgICAgICAvLyB0aGUgcmFjZSBjb25kaXRpb24gd2lsbCBiZTog\ndG9waWMgbWFuYWdlciBvd24gdG9waWMgYnV0IHBlcnNpc3RlbmNlIG1hbmFn\nZXIgZG9lc24ndAogICAgICAgIAogICAgICAgIC8vIDMwMCBzdWJzY3JpYmVy\ncyBzdWJzY3JpYmUgdG8gYSBzYW1lIHRvcGljCiAgICAgICAgZmluYWwgQXRv\nbWljQm9vbGVhbiBpblJlZGlyZWN0TG9vcCA9IG5ldyBBdG9taWNCb29sZWFu\nKGZhbHNlKTsKICAgICAgICBudW1Eb25lLnNldCgwKTsKICAgICAgICBmb3Ig\nKGludCBpPTA7IGk8bnVtU3Vic2NyaWJlcnM7IGkrKykgewogICAgICAgICAg\nICBCeXRlU3RyaW5nIHN1YklkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0Zjgo\nInN1Yi0iICsgaSk7CiAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0Vu\nYWJsZWQoKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJzdWJz\nY3JpYmVyICIgKyBzdWJJZC50b1N0cmluZ1V0ZjgoKSArICIgc3Vic2NyaWJl\ncyB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHN1YnNjcmliZXIuYXN5bmNTdWJzY3JpYmUodG9w\naWMsIHN1YklkLCBDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNILAog\nICAgICAgICAgICAgICAgbmV3IENhbGxiYWNrPFZvaWQ+KCkgewogICAgICAg\nICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHRp\nY2soKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudW1Eb25lLmlu\nY3JlbWVudEFuZEdldCgpID09IG51bVN1YnNjcmliZXJzKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChxdWV1\nZSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlz\naGVkKE9iamVjdCBjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBW\nb2lkIHJlc3VsdE9mT3BlcmF0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHRpY2soKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikg\newogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhjZXB0aW9uIGluc3Rh\nbmNlb2YgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbXNnID0gZXhj\nZXB0aW9uLmdldE1lc3NhZ2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChtc2cuaW5kZXhPZigiU2VydmVyUmVkaXJlY3RMb29wRXhjZXB0\naW9uIikgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\naW5SZWRpcmVjdExvb3Auc2V0KHRydWUpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxv\nZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJPcGVyYXRpb24gZmFpbGVkIDog\nIiwgZXhjZXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nICAgICB0aWNrKCk7IAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgbnVsbCk7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHF1ZXVlLnRha2UoKTsKICAg\nICAgICAKICAgICAgICAvLyBUT0RPOiByZW1vdmUgY29tbWVudCBhZnRlciB3\nZSBmaXggdGhlIGlzc3VlCiAgICAgICAgLy8gQXNzZXJ0LmFzc2VydEVxdWFs\ncyhmYWxzZSwgaW5SZWRpcmVjdExvb3AuZ2V0KCkpOwogICAgICAgIAogICAg\nICAgIC8vIHN0YXJ0IGEgdGhyZWFkIHRvIHNlbmQgc3Vic2NyaXB0aW9ucwog\nICAgICAgIG51bURvbmUuc2V0KDApOwogICAgICAgIFRocmVhZCBzdWIgPSBu\nZXcgVGhyZWFkKG5ldyBSdW5uYWJsZSgpIHsKCiAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nICAgICAgICBsb2dnZXIuaW5mbygic3ViIHRocmVhZCBzdGFydGVkIik7CiAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIC8vIDEw\nMCBzdWJzY3JpYmVycyBzdWJzY3JpYmUgdG8gYSBzYW1lIHRvcGljCiAgICAg\nICAgICAgICAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bVN1YnNjcmliZXJz\nOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZyBz\ndWJzY3JpYmVySWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgic3ViLSIg\nKyBpKTsKICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcnMucHV0\nKHN1YnNjcmliZXJJZCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcg\nc3ViSWQ7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgc3ViSWQgPSBzdWJzY3JpYmVycy50YWtl\nKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygic3Vic2NyaWJl\nciAiICsgc3ViSWQudG9TdHJpbmdVdGY4KCkgKyAiIHN1YnNjcmliZXMgdG9w\naWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVy\nLmFzeW5jU3Vic2NyaWJlKHRvcGljLCBzdWJJZCwgQ3JlYXRlT3JBdHRhY2gu\nQ1JFQVRFX09SX0FUVEFDSCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBTdWJDYWxsYmFjayhzdWJJZCksIG51bGwpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyBzdWJzY3JpYmVyLmFz\neW5jU3Vic2NyaWJlKHRvcGljLCBzdWJzY3JpYmVySWQsIG1vZGUsIGNhbGxi\nYWNrLCBjb250ZXh0KQogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgICAgICAvLyBi\ncmVhawogICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKCJJbnRlcnJ1\ncHRlZCA6ICIsIGllKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICB9KTsKICAgICAgICBzdWIuc3RhcnQoKTsKICAgICAgICBU\naHJlYWQuc2xlZXAoMjAwMCk7CiAgICAgICAgCiAgICAgICAgLy8gc3RhcnQg\nYSBuZXcgYm9va2llIHNlcnZlcgogICAgICAgIGxvZ2dlci5pbmZvKCJzdGFy\ndCBuZXcgYm9va2llIHNlcnZlciIpOwogICAgICAgIGJrdGIuc3RhcnRVcE5l\nd0Jvb2tpZVNlcnZlcigpOwogICAgICAgIAogICAgICAgIC8vIGhvcGUgdGhh\ndCBhbGwgdGhlIHN1YnNjcmlwdGlvbnMgd2lsbCBiZSBPSwogICAgICAgIHF1\nZXVlLnRha2UoKTsKICAgIH0KCn0K\n","encoding":"base64"}

