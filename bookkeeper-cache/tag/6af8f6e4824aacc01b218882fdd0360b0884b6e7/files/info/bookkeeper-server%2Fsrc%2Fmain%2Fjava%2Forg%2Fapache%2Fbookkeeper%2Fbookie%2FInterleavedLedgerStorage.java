{"sha":"ea35e0851523c96f9c035f9efbfdf8b7531c8ef5","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWEzNWUwODUxNTIzYzk2ZjljMDM1ZjllZmJmZGY4Yjc1MzFjOGVmNQ==","size":6007,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ea35e0851523c96f9c035f9efbfdf8b7531c8ef5","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEuaW8uSU9F\neGNlcHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmpteC5C\nS01CZWFuSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2tpZVByb3RvY29sOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnV0aWwuU25hcHNob3RNYXA7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CgppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoq\nCiAqIEludGVybGVhdmUgbGVkZ2VyIHN0b3JhZ2UKICogVGhpcyBsZWRnZXIg\nc3RvcmFnZSBpbXBsZW1lbnRhdGlvbiBzdG9yZXMgYWxsIGVudHJpZXMgaW4g\nYSBzaW5nbGUKICogZmlsZSBhbmQgbWFpbnRhaW5zIGFuIGluZGV4IGZpbGUg\nZm9yIGVhY2ggbGVkZ2VyLgogKi8KY2xhc3MgSW50ZXJsZWF2ZWRMZWRnZXJT\ndG9yYWdlIGltcGxlbWVudHMgTGVkZ2VyU3RvcmFnZSB7CiAgICBmaW5hbCBz\ndGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKElu\ndGVybGVhdmVkTGVkZ2VyU3RvcmFnZS5jbGFzcyk7CgogICAgRW50cnlMb2dn\nZXIgZW50cnlMb2dnZXI7CiAgICBMZWRnZXJDYWNoZSBsZWRnZXJDYWNoZTsK\nCiAgICAvLyBBIHNvcnRlZCBtYXAgdG8gc3RvcmVkIGFsbCBhY3RpdmUgbGVk\nZ2VyIGlkcwogICAgcHJvdGVjdGVkIGZpbmFsIFNuYXBzaG90TWFwPExvbmcs\nIEJvb2xlYW4+IGFjdGl2ZUxlZGdlcnM7CgogICAgLy8gVGhpcyBpcyB0aGUg\ndGhyZWFkIHRoYXQgZ2FyYmFnZSBjb2xsZWN0cyB0aGUgZW50cnkgbG9ncyB0\naGF0IGRvIG5vdAogICAgLy8gY29udGFpbiBhbnkgYWN0aXZlIGxlZGdlcnMg\naW4gdGhlbTsgYW5kIGNvbXBhY3RzIHRoZSBlbnRyeSBsb2dzIHRoYXQKICAg\nIC8vIGhhcyBsb3dlciByZW1haW5pbmcgcGVyY2VudGFnZSB0byByZWNsYWlt\nIGRpc2sgc3BhY2UuCiAgICBmaW5hbCBHYXJiYWdlQ29sbGVjdG9yVGhyZWFk\nIGdjVGhyZWFkOwoKICAgIC8vIHRoaXMgaW5kaWNhdGVzIHRoYXQgYSB3cml0\nZSBoYXMgaGFwcGVuZWQgc2luY2UgdGhlIGxhc3QgZmx1c2gKICAgIHByaXZh\ndGUgdm9sYXRpbGUgYm9vbGVhbiBzb21ldGhpbmdXcml0dGVuID0gZmFsc2U7\nCgogICAgSW50ZXJsZWF2ZWRMZWRnZXJTdG9yYWdlKFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY29uZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMZWRn\nZXJNYW5hZ2VyIGxlZGdlck1hbmFnZXIsIExlZGdlckRpcnNNYW5hZ2VyIGxl\nZGdlckRpcnNNYW5hZ2VyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIEdhcmJhZ2VDb2xsZWN0b3JUaHJlYWQuU2FmZUVudHJ5QWRkZXIgc2FmZUVu\ndHJ5QWRkZXIpCgkJCXRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgYWN0\naXZlTGVkZ2VycyA9IG5ldyBTbmFwc2hvdE1hcDxMb25nLCBCb29sZWFuPigp\nOwogICAgICAgIGVudHJ5TG9nZ2VyID0gbmV3IEVudHJ5TG9nZ2VyKGNvbmYs\nIGxlZGdlckRpcnNNYW5hZ2VyKTsKICAgICAgICBsZWRnZXJDYWNoZSA9IG5l\ndyBMZWRnZXJDYWNoZUltcGwoY29uZiwgYWN0aXZlTGVkZ2VycywgbGVkZ2Vy\nRGlyc01hbmFnZXIpOwogICAgICAgIGdjVGhyZWFkID0gbmV3IEdhcmJhZ2VD\nb2xsZWN0b3JUaHJlYWQoY29uZiwgbGVkZ2VyQ2FjaGUsIGVudHJ5TG9nZ2Vy\nLAogICAgICAgICAgICAgICAgYWN0aXZlTGVkZ2Vycywgc2FmZUVudHJ5QWRk\nZXIsIGxlZGdlck1hbmFnZXIpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIHZvaWQgc3RhcnQoKSB7CiAgICAgICAgZ2NUaHJlYWQuc3RhcnQo\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNodXRk\nb3duKCkgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAv\nLyBzaHV0IGRvd24gZ2MgdGhyZWFkLCB3aGljaCBkZXBlbmRzIG9uIHpvb2tl\nZXBlciBjbGllbnQKICAgICAgICAvLyBhbHNvIGNvbXBhY3Rpb24gd2lsbCB3\ncml0ZSBlbnRyaWVzIGFnYWluIHRvIGVudHJ5IGxvZyBmaWxlCiAgICAgICAg\nZ2NUaHJlYWQuc2h1dGRvd24oKTsKICAgICAgICBlbnRyeUxvZ2dlci5zaHV0\nZG93bigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxlZGdlckNhY2hl\nLmNsb3NlKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHdoaWxlIGNsb3NpbmcgdGhl\nIGxlZGdlciBjYWNoZSIsIGUpOwogICAgICAgIH0KICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyBib29sZWFuIHNldEZlbmNlZChsb25nIGxlZGdl\ncklkKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIHJldHVybiBsZWRn\nZXJDYWNoZS5zZXRGZW5jZWQobGVkZ2VySWQpOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIGJvb2xlYW4gaXNGZW5jZWQobG9uZyBsZWRnZXJJ\nZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbGVkZ2Vy\nQ2FjaGUuaXNGZW5jZWQobGVkZ2VySWQpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIHZvaWQgc2V0TWFzdGVyS2V5KGxvbmcgbGVkZ2VySWQs\nIGJ5dGVbXSBtYXN0ZXJLZXkpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgbGVkZ2VyQ2FjaGUuc2V0TWFzdGVyS2V5KGxlZGdlcklkLCBtYXN0ZXJL\nZXkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJ5dGVbXSBy\nZWFkTWFzdGVyS2V5KGxvbmcgbGVkZ2VySWQpIHRocm93cyBJT0V4Y2VwdGlv\nbiwgQm9va2llRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbGVkZ2VyQ2Fj\naGUucmVhZE1hc3RlcktleShsZWRnZXJJZCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgYm9vbGVhbiBsZWRnZXJFeGlzdHMobG9uZyBsZWRn\nZXJJZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbGVk\nZ2VyQ2FjaGUubGVkZ2VyRXhpc3RzKGxlZGdlcklkKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHN5bmNocm9uaXplZCBwdWJsaWMgbG9uZyBhZGRFbnRy\neShCeXRlQnVmZmVyIGVudHJ5KSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgIGxvbmcgbGVkZ2VySWQgPSBlbnRyeS5nZXRMb25nKCk7CiAgICAgICAg\nbG9uZyBlbnRyeUlkID0gZW50cnkuZ2V0TG9uZygpOwogICAgICAgIGVudHJ5\nLnJld2luZCgpOwogICAgICAgIAogICAgICAgIC8qCiAgICAgICAgICogTG9n\nIHRoZSBlbnRyeQogICAgICAgICAqLwogICAgICAgIGxvbmcgcG9zID0gZW50\ncnlMb2dnZXIuYWRkRW50cnkobGVkZ2VySWQsIGVudHJ5KTsKICAgICAgICAK\nICAgICAgICAKICAgICAgICAvKgogICAgICAgICAqIFNldCBvZmZzZXQgb2Yg\nZW50cnkgaWQgdG8gYmUgdGhlIGN1cnJlbnQgbGVkZ2VyIHBvc2l0aW9uCiAg\nICAgICAgICovCiAgICAgICAgbGVkZ2VyQ2FjaGUucHV0RW50cnlPZmZzZXQo\nbGVkZ2VySWQsIGVudHJ5SWQsIHBvcyk7CgogICAgICAgIHNvbWV0aGluZ1dy\naXR0ZW4gPSB0cnVlOwoKICAgICAgICByZXR1cm4gZW50cnlJZDsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBCeXRlQnVmZmVyIGdldEVudHJ5\nKGxvbmcgbGVkZ2VySWQsIGxvbmcgZW50cnlJZCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBsb25nIG9mZnNldDsKICAgICAgICAvKgogICAgICAg\nICAqIElmIGVudHJ5SWQgaXMgQm9va2llUHJvdG9jb2wuTEFTVF9BRERfQ09O\nRklSTUVELCB0aGVuIHJldHVybiB0aGUgbGFzdCB3cml0dGVuLgogICAgICAg\nICAqLwogICAgICAgIGlmIChlbnRyeUlkID09IEJvb2tpZVByb3RvY29sLkxB\nU1RfQUREX0NPTkZJUk1FRCkgewogICAgICAgICAgICBlbnRyeUlkID0gbGVk\nZ2VyQ2FjaGUuZ2V0TGFzdEVudHJ5KGxlZGdlcklkKTsKICAgICAgICB9Cgog\nICAgICAgIG9mZnNldCA9IGxlZGdlckNhY2hlLmdldEVudHJ5T2Zmc2V0KGxl\nZGdlcklkLCBlbnRyeUlkKTsKICAgICAgICBpZiAob2Zmc2V0ID09IDApIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IEJvb2tpZS5Ob0VudHJ5RXhjZXB0aW9u\nKGxlZGdlcklkLCBlbnRyeUlkKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIEJ5dGVCdWZmZXIud3JhcChlbnRyeUxvZ2dlci5yZWFkRW50cnkobGVkZ2Vy\nSWQsIGVudHJ5SWQsIG9mZnNldCkpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIGJvb2xlYW4gaXNGbHVzaFJlcXVpcmVkKCkgewogICAgICAg\nIHJldHVybiBzb21ldGhpbmdXcml0dGVuOwogICAgfTsKCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIGZsdXNoKCkgdGhyb3dzIElPRXhjZXB0aW9u\nIHsKCiAgICAgICAgaWYgKCFzb21ldGhpbmdXcml0dGVuKSB7CiAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgc29tZXRoaW5nV3JpdHRl\nbiA9IGZhbHNlOwogICAgICAgIGJvb2xlYW4gZmx1c2hGYWlsZWQgPSBmYWxz\nZTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbGVkZ2VyQ2FjaGUuZmx1\nc2hMZWRnZXIodHJ1ZSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9lKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0aW9uIGZsdXNo\naW5nIExlZGdlciBjYWNoZSIsIGlvZSk7CiAgICAgICAgICAgIGZsdXNoRmFp\nbGVkID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGVudHJ5TG9nZ2VyLmZsdXNoKCk7CiAgICAgICAgfSBjYXRjaCAoSU9F\neGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0\naW9uIGZsdXNoaW5nIExlZGdlciIsIGlvZSk7CiAgICAgICAgICAgIGZsdXNo\nRmFpbGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGZsdXNoRmFp\nbGVkKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiRmx1\nc2hpbmcgdG8gc3RvcmFnZSBmYWlsZWQsIGNoZWNrIGxvZ3MiKTsKICAgICAg\nICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgQktNQmVhbklu\nZm8gZ2V0Sk1YQmVhbigpIHsKICAgICAgICByZXR1cm4gbGVkZ2VyQ2FjaGUu\nZ2V0Sk1YQmVhbigpOwogICAgfQp9Cg==\n","encoding":"base64"}

