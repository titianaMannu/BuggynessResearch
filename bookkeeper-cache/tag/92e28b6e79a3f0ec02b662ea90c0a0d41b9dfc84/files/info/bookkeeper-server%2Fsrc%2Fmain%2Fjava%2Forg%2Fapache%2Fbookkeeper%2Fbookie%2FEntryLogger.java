{"sha":"0d09308e7710a1f1d4f10dd121a12756362755a1","node_id":"MDQ6QmxvYjE1NzU5NTY6MGQwOTMwOGU3NzEwYTFmMWQ0ZjEwZGQxMjFhMTI3NTYzNjI3NTVhMQ==","size":19182,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0d09308e7710a1f1d4f10dd121a12756362755a1","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEuaW8u\nQnVmZmVyZWRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBq\nYXZhLmlvLkZpbGVJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uRmlsZU5v\ndEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5GaWxlT3V0cHV0U3Ry\nZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\naW8uSW5wdXRTdHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0\ncmVhbVdyaXRlcjsKaW1wb3J0IGphdmEuaW8uUmFuZG9tQWNjZXNzRmlsZTsK\naW1wb3J0IGphdmEubmlvLkJ5dGVCdWZmZXI7CmltcG9ydCBqYXZhLm5pby5j\naGFubmVscy5GaWxlQ2hhbm5lbDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0\naWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJl\nbnRIYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3Vy\ncmVudE1hcDsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyTWFuYWdlcjsKCi8qKgogKiBU\naGlzIGNsYXNzIG1hbmFnZXMgdGhlIHdyaXRpbmcgb2YgdGhlIGJvb2trZWVw\nZXIgZW50cmllcy4gQWxsIHRoZSBuZXcKICogZW50cmllcyBhcmUgd3JpdHRl\nbiB0byBhIGNvbW1vbiBsb2cuIFRoZSBMZWRnZXJDYWNoZSB3aWxsIGhhdmUg\ncG9pbnRlcnMKICogaW50byBmaWxlcyBjcmVhdGVkIGJ5IHRoaXMgY2xhc3Mg\nd2l0aCBvZmZzZXRzIGludG8gdGhlIGZpbGVzIHRvIGZpbmQKICogdGhlIGFj\ndHVhbCBsZWRnZXIgZW50cnkuIFRoZSBlbnRyeSBsb2cgZmlsZXMgY3JlYXRl\nZCBieSB0aGlzIGNsYXNzIGFyZQogKiBpZGVudGlmaWVkIGJ5IGEgbG9uZy4K\nICovCnB1YmxpYyBjbGFzcyBFbnRyeUxvZ2dlciB7CiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dn\nZXIoRW50cnlMb2dnZXIuY2xhc3MpOwogICAgcHJpdmF0ZSBGaWxlIGRpcnNb\nXTsKICAgIC8vIFRoaXMgaXMgYSBoYW5kbGUgdG8gdGhlIEJvb2tpZSBwYXJl\nbnQgaW5zdGFuY2UuIFdlIG5lZWQgdGhpcyB0byBnZXQKICAgIC8vIGFjY2Vz\ncyB0byB0aGUgTGVkZ2VyQ2FjaGUgYXMgd2VsbCBhcyB0aGUgWm9vS2VlcGVy\nIGNsaWVudCBoYW5kbGUuCiAgICBwcml2YXRlIGZpbmFsIEJvb2tpZSBib29r\naWU7CgogICAgcHJpdmF0ZSBsb25nIGxvZ0lkOwogICAgLyoqCiAgICAgKiBU\naGUgbWF4aW11bSBzaXplIG9mIGEgZW50cnkgbG9nZ2VyIGZpbGUuCiAgICAg\nKi8KICAgIGZpbmFsIGxvbmcgbG9nU2l6ZUxpbWl0OwogICAgcHJpdmF0ZSB2\nb2xhdGlsZSBCdWZmZXJlZENoYW5uZWwgbG9nQ2hhbm5lbDsKICAgIC8qKgog\nICAgICogVGhlIDFLIGJsb2NrIGF0IHRoZSBoZWFkIG9mIHRoZSBlbnRyeSBs\nb2dnZXIgZmlsZQogICAgICogdGhhdCBjb250YWlucyB0aGUgZmluZ2VycHJp\nbnQgYW5kIChmdXR1cmUpIG1ldGEtZGF0YQogICAgICovCiAgICBmaW5hbCBz\ndGF0aWMgaW50IExPR0ZJTEVfSEVBREVSX1NJWkUgPSAxMDI0OwogICAgZmlu\nYWwgQnl0ZUJ1ZmZlciBMT0dGSUxFX0hFQURFUiA9IEJ5dGVCdWZmZXIuYWxs\nb2NhdGUoTE9HRklMRV9IRUFERVJfU0laRSk7CgogICAgLy8gdGhpcyBpbmRp\nY2F0ZXMgdGhhdCBhIHdyaXRlIGhhcyBoYXBwZW5lZCBzaW5jZSB0aGUgbGFz\ndCBmbHVzaAogICAgcHJpdmF0ZSB2b2xhdGlsZSBib29sZWFuIHNvbWV0aGlu\nZ1dyaXR0ZW4gPSBmYWxzZTsKCiAgICAvLyBNYXBzIGVudHJ5IGxvZyBmaWxl\ncyB0byB0aGUgc2V0IG9mIGxlZGdlcnMgdGhhdCBjb21wcmlzZSB0aGUgZmls\nZS4KICAgIHByaXZhdGUgQ29uY3VycmVudE1hcDxMb25nLCBDb25jdXJyZW50\nSGFzaE1hcDxMb25nLCBCb29sZWFuPj4gZW50cnlMb2dzMkxlZGdlcnNNYXAg\nPSBuZXcgQ29uY3VycmVudEhhc2hNYXA8TG9uZywgQ29uY3VycmVudEhhc2hN\nYXA8TG9uZywgQm9vbGVhbj4+KCk7CiAgICAvLyBUaGlzIGlzIHRoZSB0aHJl\nYWQgdGhhdCBnYXJiYWdlIGNvbGxlY3RzIHRoZSBlbnRyeSBsb2dzIHRoYXQg\nZG8gbm90CiAgICAvLyBjb250YWluIGFueSBhY3RpdmUgbGVkZ2VycyBpbiB0\naGVtLgogICAgR2FyYmFnZUNvbGxlY3RvclRocmVhZCBnY1RocmVhZCA9IG5l\ndyBHYXJiYWdlQ29sbGVjdG9yVGhyZWFkKCk7CiAgICAvLyBUaGlzIGlzIGhv\ndyBvZnRlbiB3ZSB3YW50IHRvIHJ1biB0aGUgR2FyYmFnZSBDb2xsZWN0b3Ig\nVGhyZWFkIChpbiBtaWxsaXNlY29uZHMpLgogICAgZmluYWwgbG9uZyBnY1dh\naXRUaW1lOwoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuIEVudHJ5TG9nZ2Vy\nIHRoYXQgc3RvcmVzIGl0J3MgbG9nIGZpbGVzIGluIHRoZSBnaXZlbgogICAg\nICogZGlyZWN0b3JpZXMKICAgICAqLwogICAgcHVibGljIEVudHJ5TG9nZ2Vy\nKFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiwgQm9va2llIGJvb2tpZSkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICB0aGlzLmRpcnMgPSBjb25mLmdl\ndExlZGdlckRpcnMoKTsKICAgICAgICB0aGlzLmJvb2tpZSA9IGJvb2tpZTsK\nICAgICAgICAvLyBsb2cgc2l6ZSBsaW1pdAogICAgICAgIHRoaXMubG9nU2l6\nZUxpbWl0ID0gY29uZi5nZXRFbnRyeUxvZ1NpemVMaW1pdCgpOwogICAgICAg\nIHRoaXMuZ2NXYWl0VGltZSA9IGNvbmYuZ2V0R2NXYWl0VGltZSgpOwogICAg\nICAgIC8vIEluaXRpYWxpemUgdGhlIGVudHJ5IGxvZyBoZWFkZXIgYnVmZmVy\nLiBUaGlzIGNhbm5vdCBiZSBhIHN0YXRpYyBvYmplY3QKICAgICAgICAvLyBz\naW5jZSBpbiBvdXIgdW5pdCB0ZXN0cywgd2UgcnVuIG11bHRpcGxlIEJvb2tp\nZXMgYW5kIHRodXMgRW50cnlMb2dnZXJzCiAgICAgICAgLy8gd2l0aGluIHRo\nZSBzYW1lIEpWTS4gQWxsIG9mIHRoZXNlIEJvb2tpZSBpbnN0YW5jZXMgYWNj\nZXNzIHRoaXMgaGVhZGVyCiAgICAgICAgLy8gc28gdGhlcmUgY2FuIGJlIHJh\nY2UgY29uZGl0aW9ucyB3aGVuIGVudHJ5IGxvZ3MgYXJlIHJvbGxlZCBvdmVy\nIGFuZAogICAgICAgIC8vIHRoaXMgaGVhZGVyIGJ1ZmZlciBpcyBjbGVhcmVk\nIGJlZm9yZSB3cml0aW5nIGl0IGludG8gdGhlIG5ldyBsb2dDaGFubmVsLgog\nICAgICAgIExPR0ZJTEVfSEVBREVSLnB1dCgiQktMTyIuZ2V0Qnl0ZXMoKSk7\nCiAgICAgICAgLy8gRmluZCB0aGUgbGFyZ2VzdCBsb2dJZAogICAgICAgIGZv\ncihGaWxlIGY6IGRpcnMpIHsKICAgICAgICAgICAgbG9uZyBsYXN0TG9nSWQg\nPSBnZXRMYXN0TG9nSWQoZik7CiAgICAgICAgICAgIGlmIChsYXN0TG9nSWQg\nPj0gbG9nSWQpIHsKICAgICAgICAgICAgICAgIGxvZ0lkID0gbGFzdExvZ0lk\nKzE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3JlYXRlTG9n\nSWQobG9nSWQpOwogICAgICAgIC8vIFN0YXJ0IHRoZSBHYXJiYWdlIENvbGxl\nY3RvciB0aHJlYWQgdG8gcHJ1bmUgdW5uZWVkZWQgZW50cnkgbG9ncy4KICAg\nICAgICBnY1RocmVhZC5zdGFydCgpOwogICAgfQoKICAgIC8qKgogICAgICog\nTWFwcyBlbnRyeSBsb2cgZmlsZXMgdG8gb3BlbiBjaGFubmVscy4KICAgICAq\nLwogICAgcHJpdmF0ZSBDb25jdXJyZW50SGFzaE1hcDxMb25nLCBCdWZmZXJl\nZENoYW5uZWw+IGNoYW5uZWxzID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPExv\nbmcsIEJ1ZmZlcmVkQ2hhbm5lbD4oKTsKCiAgICAvKioKICAgICAqIFRoaXMg\naXMgdGhlIGdhcmJhZ2UgY29sbGVjdG9yIHRocmVhZCB0aGF0IHJ1bnMgaW4g\ndGhlIGJhY2tncm91bmQgdG8KICAgICAqIHJlbW92ZSBhbnkgZW50cnkgbG9n\nIGZpbGVzIHRoYXQgbm8gbG9uZ2VyIGNvbnRhaW5zIGFueSBhY3RpdmUgbGVk\nZ2VyLgogICAgICovCiAgICBjbGFzcyBHYXJiYWdlQ29sbGVjdG9yVGhyZWFk\nIGV4dGVuZHMgVGhyZWFkIHsKICAgICAgICB2b2xhdGlsZSBib29sZWFuIHJ1\nbm5pbmcgPSB0cnVlOwoKICAgICAgICBwdWJsaWMgR2FyYmFnZUNvbGxlY3Rv\nclRocmVhZCgpIHsKICAgICAgICAgICAgc3VwZXIoIkdhcmJhZ2VDb2xsZWN0\nb3JUaHJlYWQiKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgd2hpbGUgKHJ1\nbm5pbmcpIHsKICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAodGhpcykg\newogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHdhaXQoZ2NXYWl0VGltZSk7CiAgICAgICAgICAgICAgICAgICAg\nfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVw\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAvLyBJbml0aWFsaXphdGlvbiBjaGVjay4gTm8gbmVlZCB0byBydW4g\nYW55IGxvZ2ljIGlmIHdlIGFyZSBzdGlsbCBzdGFydGluZyB1cC4KICAgICAg\nICAgICAgICAgIGlmIChib29raWUuemsgPT0gbnVsbCB8fCBlbnRyeUxvZ3My\nTGVkZ2Vyc01hcC5pc0VtcHR5KCkgfHwKICAgICAgICAgICAgICAgICAgICBi\nb29raWUubGVkZ2VyQ2FjaGUgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nICAgIC8vIGdjIGluYWN0aXZlL2RlbGV0ZWQgbGVkZ2VycwogICAgICAgICAg\nICAgICAgZG9HY0xlZGdlcnMoKTsKCiAgICAgICAgICAgICAgICAvLyBnYyBl\nbnRyeSBsb2dzCiAgICAgICAgICAgICAgICBkb0djRW50cnlMb2dzKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIERvIGdhcmJhZ2UgY29sbGVjdGlvbiBsZWRnZXIgaW5kZXggZmlsZXMKICAg\nICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgZG9HY0xlZGdlcnMoKSB7\nCiAgICAgICAgICAgIGJvb2tpZS5sZWRnZXJDYWNoZS5hY3RpdmVMZWRnZXJN\nYW5hZ2VyLmdhcmJhZ2VDb2xsZWN0TGVkZ2VycygKICAgICAgICAgICAgbmV3\nIExlZGdlck1hbmFnZXIuR2FyYmFnZUNvbGxlY3RvcigpIHsKICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nZ2MobG9uZyBsZWRnZXJJZCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJvb2tpZS5sZWRnZXJDYWNoZS5k\nZWxldGVMZWRnZXIobGVkZ2VySWQpOwogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgTE9HLmVycm9yKCJFeGNlcHRpb24gd2hlbiBkZWxldGluZyB0aGUgbGVk\nZ2VyIGluZGV4IGZpbGUgb24gdGhlIEJvb2tpZTogIiwgZSk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEdhcmJhZ2Ug\nY29sbGVjdCB0aG9zZSBlbnRyeSBsb2dnZXJzIHdoaWNoIGFyZSBub3QgYXNz\nb2NpYXRlZCB3aXRoIGFueSBhY3RpdmUgbGVkZ2VycwogICAgICAgICAqLwog\nICAgICAgIHByaXZhdGUgdm9pZCBkb0djRW50cnlMb2dzKCkgewogICAgICAg\nICAgICAvLyBMb29wIHRocm91Z2ggYWxsIG9mIHRoZSBlbnRyeSBsb2dzIGFu\nZCByZW1vdmUgdGhlIG5vbi1hY3RpdmUgbGVkZ2Vycy4KICAgICAgICAgICAg\nZm9yIChMb25nIGVudHJ5TG9nSWQgOiBlbnRyeUxvZ3MyTGVkZ2Vyc01hcC5r\nZXlTZXQoKSkgewogICAgICAgICAgICAgICAgQ29uY3VycmVudEhhc2hNYXA8\nTG9uZywgQm9vbGVhbj4gZW50cnlMb2dMZWRnZXJzID0gZW50cnlMb2dzMkxl\nZGdlcnNNYXAuZ2V0KGVudHJ5TG9nSWQpOwogICAgICAgICAgICAgICAgZm9y\nIChMb25nIGVudHJ5TG9nTGVkZ2VyIDogZW50cnlMb2dMZWRnZXJzLmtleVNl\ndCgpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBlbnRy\neSBsb2cgbGVkZ2VyIGZyb20gdGhlIHNldCBpZiBpdCBpc24ndCBhY3RpdmUu\nCiAgICAgICAgICAgICAgICAgICAgaWYgKCFib29raWUubGVkZ2VyQ2FjaGUu\nYWN0aXZlTGVkZ2VyTWFuYWdlci5jb250YWluc0FjdGl2ZUxlZGdlcihlbnRy\neUxvZ0xlZGdlcikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlM\nb2dMZWRnZXJzLnJlbW92ZShlbnRyeUxvZ0xlZGdlcik7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\naWYgKGVudHJ5TG9nTGVkZ2Vycy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAg\nICAgICAgICAvLyBUaGlzIG1lYW5zIHRoZSBlbnRyeSBsb2cgaXMgbm90IGFz\nc29jaWF0ZWQgd2l0aCBhbnkgYWN0aXZlIGxlZGdlcnMgYW55bW9yZS4KICAg\nICAgICAgICAgICAgICAgICAvLyBXZSBjYW4gcmVtb3ZlIHRoaXMgZW50cnkg\nbG9nIGZpbGUgbm93LgogICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJE\nZWxldGluZyBlbnRyeUxvZ0lkICIgKyBlbnRyeUxvZ0lkICsgIiBhcyBpdCBo\nYXMgbm8gYWN0aXZlIGxlZGdlcnMhIik7CiAgICAgICAgICAgICAgICAgICAg\nQnVmZmVyZWRDaGFubmVsIGJjID0gY2hhbm5lbHMucmVtb3ZlKGVudHJ5TG9n\nSWQpOwogICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGJjKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIGNsb3NlIGl0cyB1bmRlcmx5aW5n\nIGZpbGUgY2hhbm5lbCwgc28gaXQgY291bGQgYmUgZGVsZXRlZCByZWFsbHkK\nICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGJjLmdldEZpbGVDaGFubmVsKCkuY2xvc2UoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaWUp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJFeGNl\ncHRpb24gd2hpbGUgY2xvc2luZyBnYXJiYWdlIGNvbGxlY3RlZCBlbnRyeUxv\nZyBmaWxlIDogIiwgaWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIEZpbGUg\nZW50cnlMb2dGaWxlOwogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGVudHJ5TG9nRmlsZSA9IGZpbmRGaWxlKGVu\ndHJ5TG9nSWQpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEZpbGVO\nb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy5lcnJvcigiVHJ5aW5nIHRvIGRlbGV0ZSBhbiBlbnRyeUxvZyBmaWxl\nIHRoYXQgY291bGQgbm90IGJlIGZvdW5kOiAiCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyBlbnRyeUxvZ0lkICsgIi5sb2ciKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIGVudHJ5TG9nRmlsZS5kZWxldGUo\nKTsKICAgICAgICAgICAgICAgICAgICBlbnRyeUxvZ3MyTGVkZ2Vyc01hcC5y\nZW1vdmUoZW50cnlMb2dJZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGVz\nIGEgbmV3IGxvZyBmaWxlIHdpdGggdGhlIGdpdmVuIGlkLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgY3JlYXRlTG9nSWQobG9uZyBsb2dJZCkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBMaXN0PEZpbGU+IGxpc3QgPSBBcnJh\neXMuYXNMaXN0KGRpcnMpOwogICAgICAgIENvbGxlY3Rpb25zLnNodWZmbGUo\nbGlzdCk7CiAgICAgICAgRmlsZSBmaXJzdERpciA9IGxpc3QuZ2V0KDApOwog\nICAgICAgIGlmIChsb2dDaGFubmVsICE9IG51bGwpIHsKICAgICAgICAgICAg\nbG9nQ2hhbm5lbC5mbHVzaCh0cnVlKTsKICAgICAgICB9CiAgICAgICAgbG9n\nQ2hhbm5lbCA9IG5ldyBCdWZmZXJlZENoYW5uZWwobmV3IFJhbmRvbUFjY2Vz\nc0ZpbGUobmV3IEZpbGUoZmlyc3REaXIsIExvbmcudG9IZXhTdHJpbmcobG9n\nSWQpKyIubG9nIiksICJydyIpLmdldENoYW5uZWwoKSwgNjQqMTAyNCk7CiAg\nICAgICAgbG9nQ2hhbm5lbC53cml0ZSgoQnl0ZUJ1ZmZlcikgTE9HRklMRV9I\nRUFERVIuY2xlYXIoKSk7CiAgICAgICAgY2hhbm5lbHMucHV0KGxvZ0lkLCBs\nb2dDaGFubmVsKTsKICAgICAgICBmb3IoRmlsZSBmOiBkaXJzKSB7CiAgICAg\nICAgICAgIHNldExhc3RMb2dJZChmLCBsb2dJZCk7CiAgICAgICAgfQogICAg\nICAgIC8vIEV4dHJhY3QgYWxsIG9mIHRoZSBsZWRnZXIgSUQncyB0aGF0IGNv\nbXByaXNlIGFsbCBvZiB0aGUgZW50cnkgbG9ncwogICAgICAgIC8vIChleGNl\ncHQgZm9yIHRoZSBjdXJyZW50IG5ldyBvbmUgd2hpY2ggaXMgc3RpbGwgYmVp\nbmcgd3JpdHRlbiB0bykuCiAgICAgICAgZXh0cmFjdExlZGdlcnNGcm9tRW50\ncnlMb2dzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiB3cml0ZXMgdGhlIGdp\ndmVuIGlkIHRvIHRoZSAibGFzdElkIiBmaWxlIGluIHRoZSBnaXZlbiBkaXJl\nY3RvcnkuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXRMYXN0TG9nSWQo\nRmlsZSBkaXIsIGxvbmcgbG9nSWQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAg\nICAgICAgRmlsZU91dHB1dFN0cmVhbSBmb3M7CiAgICAgICAgZm9zID0gbmV3\nIEZpbGVPdXRwdXRTdHJlYW0obmV3IEZpbGUoZGlyLCAibGFzdElkIikpOwog\nICAgICAgIEJ1ZmZlcmVkV3JpdGVyIGJ3ID0gbmV3IEJ1ZmZlcmVkV3JpdGVy\nKG5ldyBPdXRwdXRTdHJlYW1Xcml0ZXIoZm9zKSk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgYncud3JpdGUoTG9uZy50b0hleFN0cmluZyhsb2dJZCkg\nKyAiXG4iKTsKICAgICAgICAgICAgYncuZmx1c2goKTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgZm9z\nLmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIHJlYWRzIGlkIGZyb20gdGhlICJsYXN0SWQiIGZpbGUgaW4gdGhlIGdp\ndmVuIGRpcmVjdG9yeS4KICAgICAqLwogICAgcHJpdmF0ZSBsb25nIGdldExh\nc3RMb2dJZChGaWxlIGYpIHsKICAgICAgICBGaWxlSW5wdXRTdHJlYW0gZmlz\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZpcyA9IG5ldyBGaWxlSW5w\ndXRTdHJlYW0obmV3IEZpbGUoZiwgImxhc3RJZCIpKTsKICAgICAgICB9IGNh\ndGNoIChGaWxlTm90Rm91bmRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBy\nZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIEJ1ZmZlcmVkUmVhZGVyIGJy\nID0gbmV3IEJ1ZmZlcmVkUmVhZGVyKG5ldyBJbnB1dFN0cmVhbVJlYWRlcihm\naXMpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmcgbGFzdElk\nU3RyaW5nID0gYnIucmVhZExpbmUoKTsKICAgICAgICAgICAgcmV0dXJuIExv\nbmcucGFyc2VMb25nKGxhc3RJZFN0cmluZyk7CiAgICAgICAgfSBjYXRjaCAo\nSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAg\nICAgfSBjYXRjaChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICByZXR1cm4gLTE7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZpcy5jbG9zZSgpOwogICAgICAg\nICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIG9wZW5OZXdDaGFu\nbmVsKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBjcmVhdGVMb2dJ\nZCgrK2xvZ0lkKTsKICAgIH0KCiAgICBzeW5jaHJvbml6ZWQgdm9pZCBmbHVz\naCgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGxvZ0NoYW5u\nZWwgIT0gbnVsbCkgewogICAgICAgICAgICBsb2dDaGFubmVsLmZsdXNoKHRy\ndWUpOwogICAgICAgIH0KICAgIH0KICAgIHN5bmNocm9uaXplZCBsb25nIGFk\nZEVudHJ5KGxvbmcgbGVkZ2VyLCBCeXRlQnVmZmVyIGVudHJ5KSB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgIGlmIChsb2dDaGFubmVsLnBvc2l0aW9u\nKCkgKyBlbnRyeS5yZW1haW5pbmcoKSArIDQgPiBsb2dTaXplTGltaXQpIHsK\nICAgICAgICAgICAgb3Blbk5ld0NoYW5uZWwoKTsKICAgICAgICB9CiAgICAg\nICAgQnl0ZUJ1ZmZlciBidWZmID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZSg0KTsK\nICAgICAgICBidWZmLnB1dEludChlbnRyeS5yZW1haW5pbmcoKSk7CiAgICAg\nICAgYnVmZi5mbGlwKCk7CiAgICAgICAgbG9nQ2hhbm5lbC53cml0ZShidWZm\nKTsKICAgICAgICBsb25nIHBvcyA9IGxvZ0NoYW5uZWwucG9zaXRpb24oKTsK\nICAgICAgICBsb2dDaGFubmVsLndyaXRlKGVudHJ5KTsKICAgICAgICAvL2xv\nZ0NoYW5uZWwuZmx1c2goZmFsc2UpOwogICAgICAgIHNvbWV0aGluZ1dyaXR0\nZW4gPSB0cnVlOwogICAgICAgIHJldHVybiAobG9nSWQgPDwgMzJMKSB8IHBv\nczsKICAgIH0KCiAgICBieXRlW10gcmVhZEVudHJ5KGxvbmcgbGVkZ2VySWQs\nIGxvbmcgZW50cnlJZCwgbG9uZyBsb2NhdGlvbikgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBsb25nIGVudHJ5TG9nSWQgPSBsb2NhdGlvbiA+PiAz\nMkw7CiAgICAgICAgbG9uZyBwb3MgPSBsb2NhdGlvbiAmIDB4ZmZmZmZmZmZM\nOwogICAgICAgIEJ5dGVCdWZmZXIgc2l6ZUJ1ZmYgPSBCeXRlQnVmZmVyLmFs\nbG9jYXRlKDQpOwogICAgICAgIHBvcyAtPSA0OyAvLyB3ZSB3YW50IHRvIGdl\ndCB0aGUgbGVkZ2VySWQgYW5kIGxlbmd0aCB0byBjaGVjawogICAgICAgIEJ1\nZmZlcmVkQ2hhbm5lbCBmYzsKICAgICAgICB0cnkgewogICAgICAgICAgICBm\nYyA9IGdldENoYW5uZWxGb3JMb2dJZChlbnRyeUxvZ0lkKTsKICAgICAgICB9\nIGNhdGNoIChGaWxlTm90Rm91bmRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICBGaWxlTm90Rm91bmRFeGNlcHRpb24gbmV3ZSA9IG5ldyBGaWxlTm90Rm91\nbmRFeGNlcHRpb24oZS5nZXRNZXNzYWdlKCkgKyAiIGZvciAiICsgbGVkZ2Vy\nSWQgKyAiIHdpdGggbG9jYXRpb24gIiArIGxvY2F0aW9uKTsKICAgICAgICAg\nICAgbmV3ZS5zZXRTdGFja1RyYWNlKGUuZ2V0U3RhY2tUcmFjZSgpKTsKICAg\nICAgICAgICAgdGhyb3cgbmV3ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGZj\nLnJlYWQoc2l6ZUJ1ZmYsIHBvcykgIT0gc2l6ZUJ1ZmYuY2FwYWNpdHkoKSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIlNob3J0IHJl\nYWQgZnJvbSBlbnRyeWxvZyAiICsgZW50cnlMb2dJZCk7CiAgICAgICAgfQog\nICAgICAgIHBvcyArPSA0OwogICAgICAgIHNpemVCdWZmLmZsaXAoKTsKICAg\nICAgICBpbnQgZW50cnlTaXplID0gc2l6ZUJ1ZmYuZ2V0SW50KCk7CiAgICAg\nICAgLy8gZW50cnlTaXplIGRvZXMgbm90IGluY2x1ZGUgdGhlIGxlZGdlcklk\nCiAgICAgICAgaWYgKGVudHJ5U2l6ZSA+IDEwMjQqMTAyNCkgewogICAgICAg\nICAgICBMT0cuZXJyb3IoIlNhbml0eSBjaGVjayBmYWlsZWQgZm9yIGVudHJ5\nIHNpemUgb2YgIiArIGVudHJ5U2l6ZSArICIgYXQgbG9jYXRpb24gIiArIHBv\ncyArICIgaW4gIiArIGVudHJ5TG9nSWQpOwoKICAgICAgICB9CiAgICAgICAg\nYnl0ZSBkYXRhW10gPSBuZXcgYnl0ZVtlbnRyeVNpemVdOwogICAgICAgIEJ5\ndGVCdWZmZXIgYnVmZiA9IEJ5dGVCdWZmZXIud3JhcChkYXRhKTsKICAgICAg\nICBpbnQgcmMgPSBmYy5yZWFkKGJ1ZmYsIHBvcyk7CiAgICAgICAgaWYgKCBy\nYyAhPSBkYXRhLmxlbmd0aCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSU9F\neGNlcHRpb24oIlNob3J0IHJlYWQgZm9yICIgKyBsZWRnZXJJZCArICJAIiAr\nIGVudHJ5SWQgKyAiIGluICIgKyBlbnRyeUxvZ0lkICsgIkAiICsgcG9zICsg\nIigiK3JjKyIhPSIrZGF0YS5sZW5ndGgrIikiKTsKICAgICAgICB9CiAgICAg\nICAgYnVmZi5mbGlwKCk7CiAgICAgICAgbG9uZyB0aGlzTGVkZ2VySWQgPSBi\ndWZmLmdldExvbmcoKTsKICAgICAgICBpZiAodGhpc0xlZGdlcklkICE9IGxl\nZGdlcklkKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigi\ncHJvYmxlbSBmb3VuZCBpbiAiICsgZW50cnlMb2dJZCArICJAIiArIGVudHJ5\nSWQgKyAiIGF0IHBvc2l0aW9uICsgIiArIHBvcyArICIgZW50cnkgYmVsb25n\ncyB0byAiICsgdGhpc0xlZGdlcklkICsgIiBub3QgIiArIGxlZGdlcklkKTsK\nICAgICAgICB9CiAgICAgICAgbG9uZyB0aGlzRW50cnlJZCA9IGJ1ZmYuZ2V0\nTG9uZygpOwogICAgICAgIGlmICh0aGlzRW50cnlJZCAhPSBlbnRyeUlkKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigicHJvYmxlbSBm\nb3VuZCBpbiAiICsgZW50cnlMb2dJZCArICJAIiArIGVudHJ5SWQgKyAiIGF0\nIHBvc2l0aW9uICsgIiArIHBvcyArICIgZW50cnkgaXMgIiArIHRoaXNFbnRy\neUlkICsgIiBub3QgIiArIGVudHJ5SWQpOwogICAgICAgIH0KCiAgICAgICAg\ncmV0dXJuIGRhdGE7CiAgICB9CgogICAgcHJpdmF0ZSBCdWZmZXJlZENoYW5u\nZWwgZ2V0Q2hhbm5lbEZvckxvZ0lkKGxvbmcgZW50cnlMb2dJZCkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBCdWZmZXJlZENoYW5uZWwgZmMgPSBj\naGFubmVscy5nZXQoZW50cnlMb2dJZCk7CiAgICAgICAgaWYgKGZjICE9IG51\nbGwpIHsKICAgICAgICAgICAgcmV0dXJuIGZjOwogICAgICAgIH0KICAgICAg\nICBGaWxlIGZpbGUgPSBmaW5kRmlsZShlbnRyeUxvZ0lkKTsKICAgICAgICBG\naWxlQ2hhbm5lbCBuZXdGYyA9IG5ldyBSYW5kb21BY2Nlc3NGaWxlKGZpbGUs\nICJydyIpLmdldENoYW5uZWwoKTsKICAgICAgICAvLyBJZiB0aGUgZmlsZSBh\nbHJlYWR5IGV4aXN0cyBiZWZvcmUgY3JlYXRpbmcgYSBCdWZmZXJlZENoYW5u\nZWwgbGF5ZXIgYWJvdmUgaXQsCiAgICAgICAgLy8gc2V0IHRoZSBGaWxlQ2hh\nbm5lbCdzIHBvc2l0aW9uIHRvIHRoZSBlbmQgc28gdGhlIHdyaXRlIGJ1ZmZl\nciBrbm93cyB3aGVyZSB0byBzdGFydC4KICAgICAgICBuZXdGYy5wb3NpdGlv\nbihuZXdGYy5zaXplKCkpOwogICAgICAgIHN5bmNocm9uaXplZCAoY2hhbm5l\nbHMpIHsKICAgICAgICAgICAgZmMgPSBjaGFubmVscy5nZXQoZW50cnlMb2dJ\nZCk7CiAgICAgICAgICAgIGlmIChmYyAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBuZXdGYy5jbG9zZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZj\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZjID0gbmV3IEJ1ZmZlcmVk\nQ2hhbm5lbChuZXdGYywgODE5Mik7CiAgICAgICAgICAgIGNoYW5uZWxzLnB1\ndChlbnRyeUxvZ0lkLCBmYyk7CiAgICAgICAgICAgIHJldHVybiBmYzsKICAg\nICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBGaWxlIGZpbmRGaWxlKGxvbmcg\nbG9nSWQpIHRocm93cyBGaWxlTm90Rm91bmRFeGNlcHRpb24gewogICAgICAg\nIGZvcihGaWxlIGQ6IGRpcnMpIHsKICAgICAgICAgICAgRmlsZSBmID0gbmV3\nIEZpbGUoZCwgTG9uZy50b0hleFN0cmluZyhsb2dJZCkrIi5sb2ciKTsKICAg\nICAgICAgICAgaWYgKGYuZXhpc3RzKCkpIHsKICAgICAgICAgICAgICAgIHJl\ndHVybiBmOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRocm93\nIG5ldyBGaWxlTm90Rm91bmRFeGNlcHRpb24oIk5vIGZpbGUgZm9yIGxvZyAi\nICsgTG9uZy50b0hleFN0cmluZyhsb2dJZCkpOwogICAgfQoKICAgIHN5bmNo\ncm9uaXplZCBwdWJsaWMgYm9vbGVhbiB0ZXN0QW5kQ2xlYXJTb21ldGhpbmdX\ncml0dGVuKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBz\nb21ldGhpbmdXcml0dGVuOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIHNvbWV0aGluZ1dyaXR0ZW4gPSBmYWxzZTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBNZXRob2QgdG8gcmVhZCBpbiBhbGwgb2YgdGhl\nIGVudHJ5IGxvZ3MgKHRob3NlIHRoYXQgd2UgaGF2ZW4ndCBkb25lIHNvIHll\ndCksCiAgICAgKiBhbmQgZmluZCB0aGUgc2V0IG9mIGxlZGdlciBJRCdzIHRo\nYXQgbWFrZSB1cCBlYWNoIGVudHJ5IGxvZyBmaWxlLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgZXh0cmFjdExlZGdlcnNGcm9tRW50cnlMb2dzKCkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBFeHRyYWN0IGl0IGZvciBl\ndmVyeSBlbnRyeSBsb2cgZXhjZXB0IGZvciB0aGUgY3VycmVudCBvbmUuCiAg\nICAgICAgLy8gRW50cnkgTG9nIElEJ3MgYXJlIGp1c3QgYSBsb25nIHZhbHVl\nIHRoYXQgc3RhcnRzIGF0IDAgYW5kIGluY3JlbWVudHMKICAgICAgICAvLyBi\neSAxIHdoZW4gdGhlIGxvZyBmaWxscyB1cCBhbmQgd2Ugcm9sbCB0byBhIG5l\ndyBvbmUuCiAgICAgICAgQnl0ZUJ1ZmZlciBzaXplQnVmZiA9IEJ5dGVCdWZm\nZXIuYWxsb2NhdGUoNCk7CiAgICAgICAgQnVmZmVyZWRDaGFubmVsIGJjOwog\nICAgICAgIGZvciAobG9uZyBlbnRyeUxvZ0lkID0gMDsgZW50cnlMb2dJZCA8\nIGxvZ0lkOyBlbnRyeUxvZ0lkKyspIHsKICAgICAgICAgICAgLy8gQ29tYiB0\naGUgY3VycmVudCBlbnRyeSBsb2cgZmlsZSBpZiBpdCBoYXMgbm90IGFscmVh\nZHkgYmVlbiBleHRyYWN0ZWQuCiAgICAgICAgICAgIGlmIChlbnRyeUxvZ3My\nTGVkZ2Vyc01hcC5jb250YWluc0tleShlbnRyeUxvZ0lkKSkgewogICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nTE9HLmluZm8oIkV4dHJhY3RpbmcgdGhlIGxlZGdlcnMgZnJvbSBlbnRyeUxv\nZ0lkOiAiICsgZW50cnlMb2dJZCk7CiAgICAgICAgICAgIC8vIEdldCB0aGUg\nQnVmZmVyZWRDaGFubmVsIGZvciB0aGUgY3VycmVudCBlbnRyeSBsb2cgZmls\nZQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYmMgPSBnZXRD\naGFubmVsRm9yTG9nSWQoZW50cnlMb2dJZCk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICAvLyBJZiB3ZSBjYW4ndCBmaW5kIHRoZSBlbnRyeSBsb2cgZmlsZSwganVz\ndCBsb2cgYSB3YXJuaW5nIG1lc3NhZ2UgYW5kIGNvbnRpbnVlLgogICAgICAg\nICAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBhIGRlbGV0ZWQvZ2FyYmFnZSBj\nb2xsZWN0ZWQgZW50cnkgbG9nLgogICAgICAgICAgICAgICAgTE9HLndhcm4o\nIkVudHJ5IExvZyBmaWxlIG5vdCBmb3VuZCBpbiBsb2cgZGlyZWN0b3JpZXM6\nICIgKyBlbnRyeUxvZ0lkICsgIi5sb2ciKTsKICAgICAgICAgICAgICAgIGNv\nbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIFN0YXJ0IHRo\nZSByZWFkIHBvc2l0aW9uIGluIHRoZSBjdXJyZW50IGVudHJ5IGxvZyBmaWxl\nIHRvIGJlIGFmdGVyCiAgICAgICAgICAgIC8vIHRoZSBoZWFkZXIgd2hlcmUg\nYWxsIG9mIHRoZSBsZWRnZXIgZW50cmllcyBhcmUuCiAgICAgICAgICAgIGxv\nbmcgcG9zID0gTE9HRklMRV9IRUFERVJfU0laRTsKICAgICAgICAgICAgQ29u\nY3VycmVudEhhc2hNYXA8TG9uZywgQm9vbGVhbj4gZW50cnlMb2dMZWRnZXJz\nID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPExvbmcsIEJvb2xlYW4+KCk7CiAg\nICAgICAgICAgIC8vIFJlYWQgdGhyb3VnaCB0aGUgZW50cnkgbG9nIGZpbGUg\nYW5kIGV4dHJhY3QgdGhlIGxlZGdlciBJRCdzLgogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAg\nICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSBmaW5pc2hlZCByZWFkaW5nIHRo\nZSBlbnRyeSBsb2cgZmlsZS4KICAgICAgICAgICAgICAgICAgICBpZiAocG9z\nID49IGJjLnNpemUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\naWYgKGJjLnJlYWQoc2l6ZUJ1ZmYsIHBvcykgIT0gc2l6ZUJ1ZmYuY2FwYWNp\ndHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSU9F\neGNlcHRpb24oIlNob3J0IHJlYWQgZnJvbSBlbnRyeWxvZyAiICsgZW50cnlM\nb2dJZCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIHBvcyArPSA0OwogICAgICAgICAgICAgICAgICAgIHNpemVCdWZmLmZs\naXAoKTsKICAgICAgICAgICAgICAgICAgICBpbnQgZW50cnlTaXplID0gc2l6\nZUJ1ZmYuZ2V0SW50KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGVudHJ5\nU2l6ZSA+IDEwMjQgKiAxMDI0KSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy5lcnJvcigiU2FuaXR5IGNoZWNrIGZhaWxlZCBmb3IgZW50cnkgc2l6\nZSBvZiAiICsgZW50cnlTaXplICsgIiBhdCBsb2NhdGlvbiAiICsgcG9zICsg\nIiBpbiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBlbnRy\neUxvZ0lkKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgYnl0ZSBkYXRhW10gPSBuZXcgYnl0ZVtlbnRyeVNpemVdOwogICAg\nICAgICAgICAgICAgICAgIEJ5dGVCdWZmZXIgYnVmZiA9IEJ5dGVCdWZmZXIu\nd3JhcChkYXRhKTsKICAgICAgICAgICAgICAgICAgICBpbnQgcmMgPSBiYy5y\nZWFkKGJ1ZmYsIHBvcyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9\nIGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBJT0V4Y2VwdGlvbigiU2hvcnQgcmVhZCBmb3IgZW50cnlMb2cgIiAr\nIGVudHJ5TG9nSWQgKyAiQCIgKyBwb3MgKyAiKCIgKyByYyArICIhPSIKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGRhdGEubGVuZ3RoICsg\nIikiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgYnVmZi5mbGlwKCk7CiAgICAgICAgICAgICAgICAgICAgbG9uZyBsZWRn\nZXJJZCA9IGJ1ZmYuZ2V0TG9uZygpOwogICAgICAgICAgICAgICAgICAgIGVu\ndHJ5TG9nTGVkZ2Vycy5wdXQobGVkZ2VySWQsIHRydWUpOwogICAgICAgICAg\nICAgICAgICAgIC8vIEFkdmFuY2UgcG9zaXRpb24gdG8gdGhlIG5leHQgZW50\ncnkgYW5kIGNsZWFyIHNpemVCdWZmLgogICAgICAgICAgICAgICAgICAgIHBv\ncyArPSBlbnRyeVNpemU7CiAgICAgICAgICAgICAgICAgICAgc2l6ZUJ1ZmYu\nY2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRj\naChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgTE9HLmluZm8oIlBy\nZW1hdHVyZSBleGNlcHRpb24gd2hlbiBwcm9jZXNzaW5nICIgKyBlbnRyeUxv\nZ0lkICsgCiAgICAgICAgICAgICAgICAgICAgICAgInJlY292ZXJ5IHdpbGwg\ndGFrZSBjYXJlIG9mIHRoZSBwcm9ibGVtIiwgZSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgTE9HLmluZm8oIlJldHJpZXZlZCBhbGwgbGVkZ2VycyB0\naGF0IGNvbXByaXNlIGVudHJ5TG9nSWQ6ICIgKyBlbnRyeUxvZ0lkICsgIiwg\ndmFsdWVzOiAiICsgZW50cnlMb2dMZWRnZXJzKTsKICAgICAgICAgICAgZW50\ncnlMb2dzMkxlZGdlcnNNYXAucHV0KGVudHJ5TG9nSWQsIGVudHJ5TG9nTGVk\nZ2Vycyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2h1dGRv\nd24gbWV0aG9kIHRvIGdyYWNlZnVsbHkgc3RvcCBhbGwgdGhyZWFkcyBzcGF3\nbmVkIGluIHRoaXMgY2xhc3MgYW5kIGV4aXQuCiAgICAgKgogICAgICogQHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZiB0aGVyZSBpcyBhbiBleGNl\ncHRpb24gc3RvcHBpbmcgdGhyZWFkcy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2h1dGRvd24oKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gewog\nICAgICAgIGdjVGhyZWFkLnJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICBnY1Ro\ncmVhZC5pbnRlcnJ1cHQoKTsKICAgICAgICBnY1RocmVhZC5qb2luKCk7CiAg\nICAgICAgLy8gc2luY2UgbG9nQ2hhbm5lbCBpcyBidWZmZXJlZCBjaGFubmVs\nLCBkbyBmbHVzaCB3aGVuIHNodXR0aW5nIGRvd24KICAgICAgICB0cnkgewog\nICAgICAgICAgICBmbHVzaCgpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0\naW9uIGllKSB7CiAgICAgICAgICAgIC8vIHdlIGhhdmUgbm8gaWRlYSBob3cg\ndG8gYXZvaWQgaW8gZXhjZXB0aW9uIGR1cmluZyBzaHV0dGluZyBkb3duLCBz\nbyBqdXN0IGlnbm9yZSBpdAogICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9y\nIGZsdXNoIGVudHJ5IGxvZyBkdXJpbmcgc2h1dHRpbmcgZG93biwgd2hpY2gg\nbWF5IGNhdXNlIGVudHJ5IGxvZyBjb3JydXB0ZWQuIiwgaWUpOwogICAgICAg\nIH0KICAgIH0KCn0K\n","encoding":"base64"}

