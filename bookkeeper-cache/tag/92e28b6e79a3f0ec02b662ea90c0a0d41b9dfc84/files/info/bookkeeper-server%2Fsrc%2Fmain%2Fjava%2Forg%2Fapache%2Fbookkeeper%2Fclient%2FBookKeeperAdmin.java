{"sha":"37623dccf9e71a949d824b6089f8e01aee409f37","node_id":"MDQ6QmxvYjE1NzU5NTY6Mzc2MjNkY2NmOWU3MWE5NDlkODI0YjYwODlmOGUwMWFlZTQwOWYzNw==","size":33709,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/37623dccf9e71a949d824b6089f8e01aee409f37","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0Lklu\nZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZExpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9y\ndCBqYXZhLnV0aWwuUmFuZG9tOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jb25mLkNsaWVudENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suT3BlbkNhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3lu\nY0NhbGxiYWNrLlJlYWRDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuQXN5bmNDYWxsYmFjay5SZWNvdmVyQ2FsbGJhY2s7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVw\nZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuTXVsdGlDYWxsYmFj\nazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVySW50ZXJuYWxDYWxsYmFja3MuUHJvY2Vzc29yOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxi\nYWNrcy5Xcml0ZUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2tpZVByb3RvY29sOwppbXBvcnQgb3JnLnNsZjRqLkxv\nZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjazsKaW1wb3J0IG9y\nZy5hcGFjaGUuem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVudDsKaW1wb3J0IG9yZy5h\ncGFjaGUuem9va2VlcGVyLldhdGNoZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5LZWVwZXJFeGNlcHRpb24uQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLmRhdGEuU3RhdDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5idWZm\nZXIuQ2hhbm5lbEJ1ZmZlcjsKCi8qKgogKiBBZG1pbiBjbGllbnQgZm9yIEJv\nb2tLZWVwZXIgY2x1c3RlcnMKICovCnB1YmxpYyBjbGFzcyBCb29rS2VlcGVy\nQWRtaW4gewogICAgcHJpdmF0ZSBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dl\nckZhY3RvcnkuZ2V0TG9nZ2VyKEJvb2tLZWVwZXJBZG1pbi5jbGFzcyk7Cgog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBDT0xPTiA9ICI6IjsKCiAgICAvLyBa\nSyBjbGllbnQgaW5zdGFuY2UKICAgIHByaXZhdGUgWm9vS2VlcGVyIHprOwog\nICAgLy8gWksgbGVkZ2VycyByZWxhdGVkIFN0cmluZyBjb25zdGFudHMKICAg\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQk9PS0lFU19QQVRIID0gQm9va2llV2F0\nY2hlci5CT09LSUVfUkVHSVNUUkFUSU9OX1BBVEg7CgogICAgLy8gQm9va0tl\nZXBlciBjbGllbnQgaW5zdGFuY2UKICAgIHByaXZhdGUgQm9va0tlZXBlciBi\na2M7CgogICAgLyoKICAgICAqIFJhbmRvbSBudW1iZXIgZ2VuZXJhdG9yIHVz\nZWQgdG8gY2hvb3NlIGFuIGF2YWlsYWJsZSBib29raWUgc2VydmVyIHRvCiAg\nICAgKiByZXBsaWNhdGUgZGF0YSBmcm9tIGEgZGVhZCBib29raWUuCiAgICAg\nKi8KICAgIHByaXZhdGUgUmFuZG9tIHJhbmQgPSBuZXcgUmFuZG9tKCk7Cgog\nICAgLyoKICAgICAqIEZvciBub3csIGFzc3VtZSB0aGF0IGFsbCBsZWRnZXJz\nIHdlcmUgY3JlYXRlZCB3aXRoIHRoZSBzYW1lIERpZ2VzdFR5cGUKICAgICAq\nIGFuZCBwYXNzd29yZC4gSW4gdGhlIGZ1dHVyZSwgdGhpcyBhZG1pbiB0b29s\nIHdpbGwgbmVlZCB0byBrbm93IGZvciBlYWNoCiAgICAgKiBsZWRnZXIsIHdo\nYXQgd2FzIHRoZSBEaWdlc3RUeXBlIGFuZCBwYXNzd29yZCB1c2VkIHRvIGNy\nZWF0ZSBpdCBiZWZvcmUgaXQKICAgICAqIGNhbiBvcGVuIGl0LiBUaGVzZSB2\nYWx1ZXMgd2lsbCBjb21lIGZyb20gU3lzdGVtIHByb3BlcnRpZXMsIHRob3Vn\naCBoYXJkCiAgICAgKiBjb2RlZCBkZWZhdWx0cyBhcmUgZGVmaW5lZCBoZXJl\nLgogICAgICovCiAgICBwcml2YXRlIERpZ2VzdFR5cGUgRElHRVNUX1RZUEU7\nCiAgICBwcml2YXRlIGJ5dGVbXSBQQVNTV0Q7CgogICAgCiAgICAvKioKICAg\nICAqIENvbnN0cnVjdG9yIHRoYXQgdGFrZXMgaW4gYSBab29LZWVwZXIgc2Vy\ndmVycyBjb25uZWN0IHN0cmluZyBzbyB3ZSBrbm93CiAgICAgKiBob3cgdG8g\nY29ubmVjdCB0byBab29LZWVwZXIgdG8gcmV0cmlldmUgaW5mb3JtYXRpb24g\nYWJvdXQgdGhlIEJvb2tLZWVwZXIKICAgICAqIGNsdXN0ZXIuIFdlIG5lZWQg\ndGhpcyBiZWZvcmUgd2UgY2FuIGRvIGFueSB0eXBlIG9mIGFkbWluIG9wZXJh\ndGlvbnMgb24KICAgICAqIHRoZSBCb29rS2VlcGVyIGNsdXN0ZXIuCiAgICAg\nKgogICAgICogQHBhcmFtIHprU2VydmVycwogICAgICogICAgICAgICAgICBD\nb21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBob3N0bmFtZTpwb3J0IHBhaXJzIGZv\nciB0aGUgWm9vS2VlcGVyCiAgICAgKiAgICAgICAgICAgIHNlcnZlcnMgY2x1\nc3Rlci4KICAgICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAqICAgICAg\nICAgICAgIHRocm93cyB0aGlzIGV4Y2VwdGlvbiBpZiB0aGVyZSBpcyBhbiBl\ncnJvciBpbnN0YW50aWF0aW5nIHRoZQogICAgICogICAgICAgICAgICAgWm9v\nS2VlcGVyIGNsaWVudC4KICAgICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNl\ncHRpb24KICAgICAqICAgICAgICAgICAgIFRocm93cyB0aGlzIGV4Y2VwdGlv\nbiBpZiB0aGVyZSBpcyBhbiBlcnJvciBpbnN0YW50aWF0aW5nIHRoZQogICAg\nICogICAgICAgICAgICAgQm9va0tlZXBlciBjbGllbnQuCiAgICAgKiBAdGhy\nb3dzIEtlZXBlckV4Y2VwdGlvbgogICAgICogICAgICAgICAgICAgVGhyb3dz\nIHRoaXMgZXhjZXB0aW9uIGlmIHRoZXJlIGlzIGFuIGVycm9yIGluc3RhbnRp\nYXRpbmcgdGhlCiAgICAgKiAgICAgICAgICAgICBCb29rS2VlcGVyIGNsaWVu\ndC4KICAgICAqLwogICAgcHVibGljIEJvb2tLZWVwZXJBZG1pbihTdHJpbmcg\nemtTZXJ2ZXJzKSB0aHJvd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhj\nZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24gewogICAgICAgIHRoaXMobmV3IENs\naWVudENvbmZpZ3VyYXRpb24oKS5zZXRaa1NlcnZlcnMoemtTZXJ2ZXJzKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RvciB0aGF0IHRha2Vz\nIGluIGEgY29uZmlndXJhdGlvbiBvYmplY3Qgc28gd2Uga25vdwogICAgICog\naG93IHRvIGNvbm5lY3QgdG8gWm9vS2VlcGVyIHRvIHJldHJpZXZlIGluZm9y\nbWF0aW9uIGFib3V0IHRoZSBCb29rS2VlcGVyCiAgICAgKiBjbHVzdGVyLiBX\nZSBuZWVkIHRoaXMgYmVmb3JlIHdlIGNhbiBkbyBhbnkgdHlwZSBvZiBhZG1p\nbiBvcGVyYXRpb25zIG9uCiAgICAgKiB0aGUgQm9va0tlZXBlciBjbHVzdGVy\nLgogICAgICoKICAgICAqIEBwYXJhbSBjb25mCiAgICAgKiAgICAgICAgICAg\nQ2xpZW50IENvbmZpZ3VyYXRpb24gT2JqZWN0CiAgICAgKiBAdGhyb3dzIElP\nRXhjZXB0aW9uCiAgICAgKiAgICAgICAgICAgICB0aHJvd3MgdGhpcyBleGNl\ncHRpb24gaWYgdGhlcmUgaXMgYW4gZXJyb3IgaW5zdGFudGlhdGluZyB0aGUK\nICAgICAqICAgICAgICAgICAgIFpvb0tlZXBlciBjbGllbnQuCiAgICAgKiBA\ndGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAgKiAgICAgICAgICAg\nICBUaHJvd3MgdGhpcyBleGNlcHRpb24gaWYgdGhlcmUgaXMgYW4gZXJyb3Ig\naW5zdGFudGlhdGluZyB0aGUKICAgICAqICAgICAgICAgICAgIEJvb2tLZWVw\nZXIgY2xpZW50LgogICAgICogQHRocm93cyBLZWVwZXJFeGNlcHRpb24KICAg\nICAqICAgICAgICAgICAgIFRocm93cyB0aGlzIGV4Y2VwdGlvbiBpZiB0aGVy\nZSBpcyBhbiBlcnJvciBpbnN0YW50aWF0aW5nIHRoZQogICAgICogICAgICAg\nICAgICAgQm9va0tlZXBlciBjbGllbnQuCiAgICAgKi8KICAgIHB1YmxpYyBC\nb29rS2VlcGVyQWRtaW4oQ2xpZW50Q29uZmlndXJhdGlvbiBjb25mKSB0aHJv\nd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uLCBLZWVwZXJF\neGNlcHRpb24gewogICAgICAgIC8vIENyZWF0ZSB0aGUgWm9vS2VlcGVyIGNs\naWVudCBpbnN0YW5jZQogICAgICAgIHprID0gbmV3IFpvb0tlZXBlcihjb25m\nLmdldFprU2VydmVycygpLCBjb25mLmdldFprVGltZW91dCgpLCBuZXcgV2F0\nY2hlcigpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHByb2Nlc3MoV2F0Y2hlZEV2ZW50IGV2ZW50KSB7CiAgICAg\nICAgICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAg\nICAgICAgICAgICAgICBMT0cuZGVidWcoIlByb2Nlc3M6ICIgKyBldmVudC5n\nZXRUeXBlKCkgKyAiICIgKyBldmVudC5nZXRQYXRoKCkpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8v\nIENyZWF0ZSB0aGUgQm9va0tlZXBlciBjbGllbnQgaW5zdGFuY2UKICAgICAg\nICBia2MgPSBuZXcgQm9va0tlZXBlcihjb25mKTsKICAgICAgICBESUdFU1Rf\nVFlQRSA9IGNvbmYuZ2V0Qm9va2llUmVjb3ZlcnlEaWdlc3RUeXBlKCk7CiAg\nICAgICAgUEFTU1dEID0gY29uZi5nZXRCb29raWVSZWNvdmVyeVBhc3N3ZCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogR3JhY2VmdWxseSByZWxlYXNlIHJl\nc291cmNlcyB0aGF0IHRoaXMgY2xpZW50IHVzZXMuCiAgICAgKgogICAgICog\nQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogICAgICAgICAg\nICAgaWYgdGhlcmUgaXMgYW4gZXJyb3Igc2h1dHRpbmcgZG93biB0aGUgY2xp\nZW50cyB0aGF0IHRoaXMKICAgICAqICAgICAgICAgICAgIGNsYXNzIHVzZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIEludGVy\ncnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgYmtjLmNs\nb3NlKCk7CiAgICAgICAgemsuY2xvc2UoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIE1ldGhvZCB0byBnZXQgdGhlIGlucHV0IGxlZGdlcidzIGRpZ2VzdCB0\neXBlLiBGb3Igbm93LCB0aGlzIGlzIGp1c3QgYQogICAgICogcGxhY2Vob2xk\nZXIgZnVuY3Rpb24gc2luY2UgdGhlcmUgaXMgbm8gd2F5IHdlIGNhbiBnZXQg\ndGhpcyBpbmZvcm1hdGlvbgogICAgICogZWFzaWx5LiBJbiB0aGUgZnV0dXJl\nLCBCb29rS2VlcGVyIHNob3VsZCBzdG9yZSB0aGlzIGxlZGdlciBtZXRhZGF0\nYQogICAgICogc29tZXdoZXJlIHN1Y2ggdGhhdCBhbiBhZG1pbiB0b29sIGNh\nbiBhY2Nlc3MgaXQuCiAgICAgKgogICAgICogQHBhcmFtIGxlZGdlcklkCiAg\nICAgKiAgICAgICAgICAgIExlZGdlcklkIHdlIGFyZSByZXRyaWV2aW5nIHRo\nZSBkaWdlc3RUeXBlIGZvci4KICAgICAqIEByZXR1cm4gRGlnZXN0VHlwZSBm\nb3IgdGhlIGlucHV0IGxlZGdlcgogICAgICovCiAgICBwcml2YXRlIERpZ2Vz\ndFR5cGUgZ2V0TGVkZ2VyRGlnZXN0VHlwZShsb25nIGxlZGdlcklkKSB7CiAg\nICAgICAgcmV0dXJuIERJR0VTVF9UWVBFOwogICAgfQoKICAgIC8qKgogICAg\nICogTWV0aG9kIHRvIGdldCB0aGUgaW5wdXQgbGVkZ2VyJ3MgcGFzc3dvcmQu\nIEZvciBub3csIHRoaXMgaXMganVzdCBhCiAgICAgKiBwbGFjZWhvbGRlciBm\ndW5jdGlvbiBzaW5jZSB0aGVyZSBpcyBubyB3YXkgd2UgY2FuIGdldCB0aGlz\nIGluZm9ybWF0aW9uCiAgICAgKiBlYXNpbHkuIEluIHRoZSBmdXR1cmUsIEJv\nb2tLZWVwZXIgc2hvdWxkIHN0b3JlIHRoaXMgbGVkZ2VyIG1ldGFkYXRhCiAg\nICAgKiBzb21ld2hlcmUgc3VjaCB0aGF0IGFuIGFkbWluIHRvb2wgY2FuIGFj\nY2VzcyBpdC4KICAgICAqCiAgICAgKiBAcGFyYW0gbGVkZ2VySWQKICAgICAq\nICAgICAgICAgICAgTGVkZ2VySWQgd2UgYXJlIHJldHJpZXZpbmcgdGhlIHBh\nc3N3b3JkIGZvci4KICAgICAqIEByZXR1cm4gUGFzc3dvcmQgZm9yIHRoZSBp\nbnB1dCBsZWRnZXIKICAgICAqLwogICAgcHJpdmF0ZSBieXRlW10gZ2V0TGVk\nZ2VyUGFzc3dkKGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICByZXR1cm4gUEFT\nU1dEOwogICAgfQoKICAgIC8vIE9iamVjdCB1c2VkIGZvciBjYWxsaW5nIGFz\neW5jIG1ldGhvZHMgYW5kIHdhaXRpbmcgZm9yIHRoZW0gdG8gY29tcGxldGUu\nCiAgICBjbGFzcyBTeW5jT2JqZWN0IHsKICAgICAgICBib29sZWFuIHZhbHVl\nOwogICAgICAgIGludCByYzsKCiAgICAgICAgcHVibGljIFN5bmNPYmplY3Qo\nKSB7CiAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7CiAgICAgICAgICAgIHJj\nID0gQktFeGNlcHRpb24uQ29kZS5PSzsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTeW5jaHJvbm91cyBtZXRob2QgdG8gcmVidWlsZCBhbmQg\ncmVjb3ZlciB0aGUgbGVkZ2VyIGZyYWdtZW50cyBkYXRhIHRoYXQKICAgICAq\nIHdhcyBzdG9yZWQgb24gdGhlIHNvdXJjZSBib29raWUuIFRoYXQgYm9va2ll\nIGNvdWxkIGhhdmUgZmFpbGVkIGNvbXBsZXRlbHkKICAgICAqIGFuZCBub3cg\ndGhlIGxlZGdlciBkYXRhIHRoYXQgd2FzIHN0b3JlZCBvbiBpdCBpcyB1bmRl\nciByZXBsaWNhdGVkLiBBbgogICAgICogb3B0aW9uYWwgZGVzdGluYXRpb24g\nYm9va2llIHNlcnZlciBjb3VsZCBiZSBnaXZlbiBpZiB3ZSB3YW50IHRvIGNv\ncHkgYWxsCiAgICAgKiBvZiB0aGUgbGVkZ2VyIGZyYWdtZW50cyBkYXRhIG9u\nIHRoZSBmYWlsZWQgc291cmNlIGJvb2tpZSB0byBpdC4KICAgICAqIE90aGVy\nd2lzZSwgd2Ugd2lsbCBqdXN0IHJhbmRvbWx5IGRpc3RyaWJ1dGUgdGhlIGxl\nZGdlciBmcmFnbWVudHMgdG8gdGhlCiAgICAgKiBhY3RpdmUgc2V0IG9mIGJv\nb2tpZXMsIHBlcmhhcHMgYmFzZWQgb24gbG9hZC4gQWxsIFpvb0tlZXBlciBs\nZWRnZXIKICAgICAqIG1ldGFkYXRhIHdpbGwgYmUgdXBkYXRlZCB0byBwb2lu\ndCB0byB0aGUgbmV3IGJvb2tpZShzKSB0aGF0IGNvbnRhaW4gdGhlCiAgICAg\nKiByZXBsaWNhdGVkIGxlZGdlciBmcmFnbWVudHMuCiAgICAgKgogICAgICog\nQHBhcmFtIGJvb2tpZVNyYwogICAgICogICAgICAgICAgICBTb3VyY2UgYm9v\na2llIHRoYXQgaGFkIGEgZmFpbHVyZS4gV2Ugd2FudCB0byByZXBsaWNhdGUg\ndGhlCiAgICAgKiAgICAgICAgICAgIGxlZGdlciBmcmFnbWVudHMgdGhhdCB3\nZXJlIHN0b3JlZCB0aGVyZS4KICAgICAqIEBwYXJhbSBib29raWVEZXN0CiAg\nICAgKiAgICAgICAgICAgIE9wdGlvbmFsIGRlc3RpbmF0aW9uIGJvb2tpZSB0\naGF0IGlmIHBhc3NlZCwgd2Ugd2lsbCBjb3B5IGFsbAogICAgICogICAgICAg\nICAgICBvZiB0aGUgbGVkZ2VyIGZyYWdtZW50cyBmcm9tIHRoZSBzb3VyY2Ug\nYm9va2llIG92ZXIgdG8gaXQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHJl\nY292ZXJCb29raWVEYXRhKGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIGJvb2tp\nZVNyYywgZmluYWwgSW5ldFNvY2tldEFkZHJlc3MgYm9va2llRGVzdCkKICAg\nICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2Vw\ndGlvbiB7CiAgICAgICAgU3luY09iamVjdCBzeW5jID0gbmV3IFN5bmNPYmpl\nY3QoKTsKICAgICAgICAvLyBDYWxsIHRoZSBhc3luYyBtZXRob2QgdG8gcmVj\nb3ZlciBib29raWUgZGF0YS4KICAgICAgICBhc3luY1JlY292ZXJCb29raWVE\nYXRhKGJvb2tpZVNyYywgYm9va2llRGVzdCwgbmV3IFJlY292ZXJDYWxsYmFj\naygpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHJlY292ZXJDb21wbGV0ZShpbnQgcmMsIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgIExPRy5pbmZvKCJSZWNvdmVyIGJvb2tpZSBvcGVy\nYXRpb24gY29tcGxldGVkIHdpdGggcmM6ICIgKyByYyk7CiAgICAgICAgICAg\nICAgICBTeW5jT2JqZWN0IHN5bmNPYmogPSAoU3luY09iamVjdCkgY3R4Owog\nICAgICAgICAgICAgICAgc3luY2hyb25pemVkIChzeW5jT2JqKSB7CiAgICAg\nICAgICAgICAgICAgICAgc3luY09iai5yYyA9IHJjOwogICAgICAgICAgICAg\nICAgICAgIHN5bmNPYmoudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgICAg\nICAgIHN5bmNPYmoubm90aWZ5KCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9LCBzeW5jKTsKCiAgICAgICAgLy8gV2FpdCBm\nb3IgdGhlIGFzeW5jIG1ldGhvZCB0byBjb21wbGV0ZS4KICAgICAgICBzeW5j\naHJvbml6ZWQgKHN5bmMpIHsKICAgICAgICAgICAgd2hpbGUgKHN5bmMudmFs\ndWUgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIHN5bmMud2FpdCgpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChzeW5jLnJjICE9\nIEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgdGhyb3cgQktF\neGNlcHRpb24uY3JlYXRlKHN5bmMucmMpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIEFzeW5jIG1ldGhvZCB0byByZWJ1aWxkIGFuZCByZWNv\ndmVyIHRoZSBsZWRnZXIgZnJhZ21lbnRzIGRhdGEgdGhhdCB3YXMKICAgICAq\nIHN0b3JlZCBvbiB0aGUgc291cmNlIGJvb2tpZS4gVGhhdCBib29raWUgY291\nbGQgaGF2ZSBmYWlsZWQgY29tcGxldGVseSBhbmQKICAgICAqIG5vdyB0aGUg\nbGVkZ2VyIGRhdGEgdGhhdCB3YXMgc3RvcmVkIG9uIGl0IGlzIHVuZGVyIHJl\ncGxpY2F0ZWQuIEFuCiAgICAgKiBvcHRpb25hbCBkZXN0aW5hdGlvbiBib29r\naWUgc2VydmVyIGNvdWxkIGJlIGdpdmVuIGlmIHdlIHdhbnQgdG8gY29weSBh\nbGwKICAgICAqIG9mIHRoZSBsZWRnZXIgZnJhZ21lbnRzIGRhdGEgb24gdGhl\nIGZhaWxlZCBzb3VyY2UgYm9va2llIHRvIGl0LgogICAgICogT3RoZXJ3aXNl\nLCB3ZSB3aWxsIGp1c3QgcmFuZG9tbHkgZGlzdHJpYnV0ZSB0aGUgbGVkZ2Vy\nIGZyYWdtZW50cyB0byB0aGUKICAgICAqIGFjdGl2ZSBzZXQgb2YgYm9va2ll\ncywgcGVyaGFwcyBiYXNlZCBvbiBsb2FkLiBBbGwgWm9vS2VlcGVyIGxlZGdl\ncgogICAgICogbWV0YWRhdGEgd2lsbCBiZSB1cGRhdGVkIHRvIHBvaW50IHRv\nIHRoZSBuZXcgYm9va2llKHMpIHRoYXQgY29udGFpbiB0aGUKICAgICAqIHJl\ncGxpY2F0ZWQgbGVkZ2VyIGZyYWdtZW50cy4KICAgICAqCiAgICAgKiBAcGFy\nYW0gYm9va2llU3JjCiAgICAgKiAgICAgICAgICAgIFNvdXJjZSBib29raWUg\ndGhhdCBoYWQgYSBmYWlsdXJlLiBXZSB3YW50IHRvIHJlcGxpY2F0ZSB0aGUK\nICAgICAqICAgICAgICAgICAgbGVkZ2VyIGZyYWdtZW50cyB0aGF0IHdlcmUg\nc3RvcmVkIHRoZXJlLgogICAgICogQHBhcmFtIGJvb2tpZURlc3QKICAgICAq\nICAgICAgICAgICAgT3B0aW9uYWwgZGVzdGluYXRpb24gYm9va2llIHRoYXQg\naWYgcGFzc2VkLCB3ZSB3aWxsIGNvcHkgYWxsCiAgICAgKiAgICAgICAgICAg\nIG9mIHRoZSBsZWRnZXIgZnJhZ21lbnRzIGZyb20gdGhlIHNvdXJjZSBib29r\naWUgb3ZlciB0byBpdC4KICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAg\nICAgICBSZWNvdmVyQ2FsbGJhY2sgdG8gaW52b2tlIG9uY2UgYWxsIG9mIHRo\nZSBkYXRhIG9uIHRoZSBkZWFkCiAgICAgKiAgICAgICAgICAgIGJvb2tpZSBo\nYXMgYmVlbiByZWNvdmVyZWQgYW5kIHJlcGxpY2F0ZWQuCiAgICAgKiBAcGFy\nYW0gY29udGV4dAogICAgICogICAgICAgICAgICBDb250ZXh0IGZvciB0aGUg\nUmVjb3ZlckNhbGxiYWNrIHRvIGNhbGwuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGFzeW5jUmVjb3ZlckJvb2tpZURhdGEoZmluYWwgSW5ldFNvY2tldEFk\nZHJlc3MgYm9va2llU3JjLCBmaW5hbCBJbmV0U29ja2V0QWRkcmVzcyBib29r\naWVEZXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBmaW5hbCBSZWNvdmVyQ2FsbGJhY2sgY2IsIGZpbmFsIE9iamVjdCBjb250\nZXh0KSB7CiAgICAgICAgLy8gU3luYyBaSyB0byBtYWtlIHN1cmUgd2UncmUg\ncmVhZGluZyB0aGUgbGF0ZXN0IGJvb2tpZSBkYXRhLgogICAgICAgIHprLnN5\nbmMoQk9PS0lFU19QQVRILCBuZXcgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJh\nY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJs\naWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9i\namVjdCBjdHgpIHsKICAgICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9L\nLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3Io\nIlpLIGVycm9yIHN5bmNpbmc6ICIsIEtlZXBlckV4Y2VwdGlvbi5jcmVhdGUo\nS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSwgcGF0aCkpOwogICAgICAg\nICAgICAgICAgICAgIGNiLnJlY292ZXJDb21wbGV0ZShCS0V4Y2VwdGlvbi5D\nb2RlLlpLRXhjZXB0aW9uLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBn\nZXRBdmFpbGFibGVCb29raWVzKGJvb2tpZVNyYywgYm9va2llRGVzdCwgY2Is\nIGNvbnRleHQpOwogICAgICAgICAgICB9OwogICAgICAgIH0sIG51bGwpOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgYXN5bmNocm9ub3Vz\nbHkgZ2V0cyB0aGUgc2V0IG9mIGF2YWlsYWJsZSBCb29raWVzIHRoYXQgdGhl\nCiAgICAgKiBkZWFkIGlucHV0IGJvb2tpZSdzIGRhdGEgd2lsbCBiZSBjb3Bp\nZWQgb3ZlciBpbnRvLiBJZiB0aGUgdXNlciBwYXNzZWQgaW4KICAgICAqIGEg\nc3BlY2lmaWMgZGVzdGluYXRpb24gYm9va2llLCB0aGVuIGp1c3QgdXNlIHRo\nYXQgb25lLiBPdGhlcndpc2UsIHdlJ2xsCiAgICAgKiByYW5kb21seSBwaWNr\nIG9uZSBvZiB0aGUgb3RoZXIgYXZhaWxhYmxlIGJvb2tpZXMgdG8gdXNlIGZv\nciBlYWNoIGxlZGdlcgogICAgICogZnJhZ21lbnQgd2UgYXJlIHJlcGxpY2F0\naW5nLgogICAgICoKICAgICAqIEBwYXJhbSBib29raWVTcmMKICAgICAqICAg\nICAgICAgICAgU291cmNlIGJvb2tpZSB0aGF0IGhhZCBhIGZhaWx1cmUuIFdl\nIHdhbnQgdG8gcmVwbGljYXRlIHRoZQogICAgICogICAgICAgICAgICBsZWRn\nZXIgZnJhZ21lbnRzIHRoYXQgd2VyZSBzdG9yZWQgdGhlcmUuCiAgICAgKiBA\ncGFyYW0gYm9va2llRGVzdAogICAgICogICAgICAgICAgICBPcHRpb25hbCBk\nZXN0aW5hdGlvbiBib29raWUgdGhhdCBpZiBwYXNzZWQsIHdlIHdpbGwgY29w\neSBhbGwKICAgICAqICAgICAgICAgICAgb2YgdGhlIGxlZGdlciBmcmFnbWVu\ndHMgZnJvbSB0aGUgc291cmNlIGJvb2tpZSBvdmVyIHRvIGl0LgogICAgICog\nQHBhcmFtIGNiCiAgICAgKiAgICAgICAgICAgIFJlY292ZXJDYWxsYmFjayB0\nbyBpbnZva2Ugb25jZSBhbGwgb2YgdGhlIGRhdGEgb24gdGhlIGRlYWQKICAg\nICAqICAgICAgICAgICAgYm9va2llIGhhcyBiZWVuIHJlY292ZXJlZCBhbmQg\ncmVwbGljYXRlZC4KICAgICAqIEBwYXJhbSBjb250ZXh0CiAgICAgKiAgICAg\nICAgICAgIENvbnRleHQgZm9yIHRoZSBSZWNvdmVyQ2FsbGJhY2sgdG8gY2Fs\nbC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGdldEF2YWlsYWJsZUJvb2tp\nZXMoZmluYWwgSW5ldFNvY2tldEFkZHJlc3MgYm9va2llU3JjLCBmaW5hbCBJ\nbmV0U29ja2V0QWRkcmVzcyBib29raWVEZXN0LAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgZmluYWwgUmVjb3ZlckNhbGxiYWNrIGNi\nLCBmaW5hbCBPYmplY3QgY29udGV4dCkgewogICAgICAgIGZpbmFsIExpc3Q8\nSW5ldFNvY2tldEFkZHJlc3M+IGF2YWlsYWJsZUJvb2tpZXMgPSBuZXcgTGlu\na2VkTGlzdDxJbmV0U29ja2V0QWRkcmVzcz4oKTsKICAgICAgICBpZiAoYm9v\na2llRGVzdCAhPSBudWxsKSB7CiAgICAgICAgICAgIGF2YWlsYWJsZUJvb2tp\nZXMuYWRkKGJvb2tpZURlc3QpOwogICAgICAgICAgICAvLyBOb3cgcG9sbCBa\nSyB0byBnZXQgdGhlIGFjdGl2ZSBsZWRnZXJzCiAgICAgICAgICAgIGdldEFj\ndGl2ZUxlZGdlcnMoYm9va2llU3JjLCBib29raWVEZXN0LCBjYiwgY29udGV4\ndCwgYXZhaWxhYmxlQm9va2llcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgemsuZ2V0Q2hpbGRyZW4oQk9PS0lFU19QQVRILCBudWxsLCBuZXcg\nQXN5bmNDYWxsYmFjay5DaGlsZHJlbkNhbGxiYWNrKCkgewogICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBw\ncm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgs\nIExpc3Q8U3RyaW5nPiBjaGlsZHJlbikgewogICAgICAgICAgICAgICAgICAg\nIGlmIChyYyAhPSBDb2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgTE9HLmVycm9yKCJaSyBlcnJvciBnZXR0aW5nIGJvb2tp\nZSBub2RlczogIiwgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNl\ncHRpb24uQ29kZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2Iu\ncmVjb3ZlckNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24s\nIGNvbnRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGZvciAo\nU3RyaW5nIGJvb2tpZU5vZGUgOiBjaGlsZHJlbikgewogICAgICAgICAgICAg\nICAgICAgICAgICBTdHJpbmcgcGFydHNbXSA9IGJvb2tpZU5vZGUuc3BsaXQo\nQ09MT04pOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydHMubGVu\nZ3RoIDwgMikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVy\ncm9yKCJCb29raWUgTm9kZSByZXRyaWV2ZWQgZnJvbSBaSyBoYXMgaW52YWxp\nZCBuYW1lIGZvcm1hdDogIiArIGJvb2tpZU5vZGUpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY2IucmVjb3ZlckNvbXBsZXRlKEJLRXhjZXB0aW9u\nLkNvZGUuWktFeGNlcHRpb24sIGNvbnRleHQpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZUJvb2tpZXMuYWRk\nKG5ldyBJbmV0U29ja2V0QWRkcmVzcyhwYXJ0c1swXSwgSW50ZWdlci5wYXJz\nZUludChwYXJ0c1sxXSkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgLy8gTm93IHBvbGwgWksgdG8gZ2V0IHRoZSBhY3Rp\ndmUgbGVkZ2VycwogICAgICAgICAgICAgICAgICAgIGdldEFjdGl2ZUxlZGdl\ncnMoYm9va2llU3JjLCBib29raWVEZXN0LCBjYiwgY29udGV4dCwgYXZhaWxh\nYmxlQm9va2llcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0s\nIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMg\nbWV0aG9kIGFzeW5jaHJvbm91c2x5IHBvbGxzIFpLIHRvIGdldCB0aGUgY3Vy\ncmVudCBzZXQgb2YgYWN0aXZlCiAgICAgKiBsZWRnZXJzLiBGcm9tIHRoaXMs\nIHdlIGNhbiBvcGVuIGVhY2ggbGVkZ2VyIGFuZCBsb29rIGF0IHRoZSBtZXRh\nZGF0YSB0bwogICAgICogZGV0ZXJtaW5lIGlmIGFueSBvZiB0aGUgbGVkZ2Vy\nIGZyYWdtZW50cyBmb3IgaXQgd2VyZSBzdG9yZWQgYXQgdGhlIGRlYWQKICAg\nICAqIGlucHV0IGJvb2tpZS4KICAgICAqCiAgICAgKiBAcGFyYW0gYm9va2ll\nU3JjCiAgICAgKiAgICAgICAgICAgIFNvdXJjZSBib29raWUgdGhhdCBoYWQg\nYSBmYWlsdXJlLiBXZSB3YW50IHRvIHJlcGxpY2F0ZSB0aGUKICAgICAqICAg\nICAgICAgICAgbGVkZ2VyIGZyYWdtZW50cyB0aGF0IHdlcmUgc3RvcmVkIHRo\nZXJlLgogICAgICogQHBhcmFtIGJvb2tpZURlc3QKICAgICAqICAgICAgICAg\nICAgT3B0aW9uYWwgZGVzdGluYXRpb24gYm9va2llIHRoYXQgaWYgcGFzc2Vk\nLCB3ZSB3aWxsIGNvcHkgYWxsCiAgICAgKiAgICAgICAgICAgIG9mIHRoZSBs\nZWRnZXIgZnJhZ21lbnRzIGZyb20gdGhlIHNvdXJjZSBib29raWUgb3ZlciB0\nbyBpdC4KICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAgICAgICBSZWNv\ndmVyQ2FsbGJhY2sgdG8gaW52b2tlIG9uY2UgYWxsIG9mIHRoZSBkYXRhIG9u\nIHRoZSBkZWFkCiAgICAgKiAgICAgICAgICAgIGJvb2tpZSBoYXMgYmVlbiBy\nZWNvdmVyZWQgYW5kIHJlcGxpY2F0ZWQuCiAgICAgKiBAcGFyYW0gY29udGV4\ndAogICAgICogICAgICAgICAgICBDb250ZXh0IGZvciB0aGUgUmVjb3ZlckNh\nbGxiYWNrIHRvIGNhbGwuCiAgICAgKiBAcGFyYW0gYXZhaWxhYmxlQm9va2ll\ncwogICAgICogICAgICAgICAgICBMaXN0IG9mIEJvb2tpZSBTZXJ2ZXJzIHRo\nYXQgYXJlIGF2YWlsYWJsZSB0byB1c2UgZm9yCiAgICAgKiAgICAgICAgICAg\nIHJlcGxpY2F0aW5nIGRhdGEgb24gdGhlIGZhaWxlZCBib29raWUuIFRoaXMg\nY291bGQgY29udGFpbiBhCiAgICAgKiAgICAgICAgICAgIHNpbmdsZSBib29r\naWUgc2VydmVyIGlmIHRoZSB1c2VyIGV4cGxpY2l0bHkgY2hvc2UgYSBib29r\naWUKICAgICAqICAgICAgICAgICAgc2VydmVyIHRvIHJlcGxpY2F0ZSBkYXRh\nIHRvLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZ2V0QWN0aXZlTGVkZ2Vy\ncyhmaW5hbCBJbmV0U29ja2V0QWRkcmVzcyBib29raWVTcmMsIGZpbmFsIElu\nZXRTb2NrZXRBZGRyZXNzIGJvb2tpZURlc3QsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBmaW5hbCBSZWNvdmVyQ2FsbGJhY2sgY2IsIGZp\nbmFsIE9iamVjdCBjb250ZXh0LCBmaW5hbCBMaXN0PEluZXRTb2NrZXRBZGRy\nZXNzPiBhdmFpbGFibGVCb29raWVzKSB7CiAgICAgICAgLy8gV3JhcHBlciBj\nbGFzcyBhcm91bmQgdGhlIFJlY292ZXJDYWxsYmFjayBzbyBpdCBjYW4gYmUg\ndXNlZAogICAgICAgIC8vIGFzIHRoZSBmaW5hbCBWb2lkQ2FsbGJhY2sgdG8g\ncHJvY2VzcyBsZWRnZXJzCiAgICAgICAgY2xhc3MgUmVjb3ZlckNhbGxiYWNr\nV3JhcHBlciBpbXBsZW1lbnRzIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNr\nIHsKICAgICAgICAgICAgZmluYWwgUmVjb3ZlckNhbGxiYWNrIGNiOwoKICAg\nICAgICAgICAgUmVjb3ZlckNhbGxiYWNrV3JhcHBlcihSZWNvdmVyQ2FsbGJh\nY2sgY2IpIHsKICAgICAgICAgICAgICAgIHRoaXMuY2IgPSBjYjsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwg\nT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgY2IucmVjb3ZlckNvbXBs\nZXRlKHJjLCBjdHgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBQcm9jZXNzb3I8TG9uZz4gbGVkZ2VyUHJvY2Vzc29yID0gbmV3IFByb2Nl\nc3NvcjxMb25nPigpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHByb2Nlc3MoTG9uZyBsZWRnZXJJZCwgQXN5bmND\nYWxsYmFjay5Wb2lkQ2FsbGJhY2sgaXRlckNhbGxiYWNrKSB7CiAgICAgICAg\nICAgICAgICByZWNvdmVyTGVkZ2VyKGJvb2tpZVNyYywgbGVkZ2VySWQsIGl0\nZXJDYWxsYmFjaywgYXZhaWxhYmxlQm9va2llcyk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9OwogICAgICAgIGJrYy5nZXRMZWRnZXJNYW5hZ2VyKCkuYXN5\nbmNQcm9jZXNzTGVkZ2VycygKICAgICAgICAgICAgbGVkZ2VyUHJvY2Vzc29y\nLCBuZXcgUmVjb3ZlckNhbGxiYWNrV3JhcHBlcihjYiksCiAgICAgICAgICAg\nIGNvbnRleHQsIEJLRXhjZXB0aW9uLkNvZGUuT0ssIEJLRXhjZXB0aW9uLkNv\nZGUuTGVkZ2VyUmVjb3ZlcnlFeGNlcHRpb24pOwogICAgfQoKICAgIC8qKgog\nICAgICogR2V0IGEgbmV3IHJhbmRvbSBib29raWUsIGJ1dCBlbnN1cmUgdGhh\ndCBpdCBpc24ndCBvbmUgdGhhdCBpcyBhbHJlYWR5CiAgICAgKiBpbiB0aGUg\nZW5zZW1ibGUgZm9yIHRoZSBsZWRnZXIuCiAgICAgKi8KICAgIHByaXZhdGUg\nSW5ldFNvY2tldEFkZHJlc3MgZ2V0TmV3Qm9va2llKGZpbmFsIExpc3Q8SW5l\ndFNvY2tldEFkZHJlc3M+IGJvb2tpZXNBbHJlYWR5SW5FbnNlbWJsZSwgCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5h\nbCBMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBhdmFpbGFibGVCb29raWVzKSAK\nICAgICAgICAgICAgdGhyb3dzIEJLRXhjZXB0aW9uLkJLTm90RW5vdWdoQm9v\na2llc0V4Y2VwdGlvbiB7CiAgICAgICAgQXJyYXlMaXN0PEluZXRTb2NrZXRB\nZGRyZXNzPiBjYW5kaWRhdGVzID0gbmV3IEFycmF5TGlzdDxJbmV0U29ja2V0\nQWRkcmVzcz4oKTsKICAgICAgICBjYW5kaWRhdGVzLmFkZEFsbChhdmFpbGFi\nbGVCb29raWVzKTsKICAgICAgICBjYW5kaWRhdGVzLnJlbW92ZUFsbChib29r\naWVzQWxyZWFkeUluRW5zZW1ibGUpOwogICAgICAgIGlmIChjYW5kaWRhdGVz\nLnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBCS0V4Y2Vw\ndGlvbi5CS05vdEVub3VnaEJvb2tpZXNFeGNlcHRpb24oKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZXMuZ2V0KHJhbmQubmV4dEludChj\nYW5kaWRhdGVzLnNpemUoKSkpOwogICAgfQoKICAgIC8qKgogICAgICogVGhp\ncyBtZXRob2QgYXN5bmNocm9ub3VzbHkgcmVjb3ZlcnMgYSBnaXZlbiBsZWRn\nZXIgaWYgYW55IG9mIHRoZSBsZWRnZXIKICAgICAqIGVudHJpZXMgd2VyZSBz\ndG9yZWQgb24gdGhlIGZhaWxlZCBib29raWUuCiAgICAgKgogICAgICogQHBh\ncmFtIGJvb2tpZVNyYwogICAgICogICAgICAgICAgICBTb3VyY2UgYm9va2ll\nIHRoYXQgaGFkIGEgZmFpbHVyZS4gV2Ugd2FudCB0byByZXBsaWNhdGUgdGhl\nCiAgICAgKiAgICAgICAgICAgIGxlZGdlciBmcmFnbWVudHMgdGhhdCB3ZXJl\nIHN0b3JlZCB0aGVyZS4KICAgICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAg\nICAgICAgTGVkZ2VyIGlkIHdlIHdhbnQgdG8gcmVjb3Zlci4KICAgICAqIEBw\nYXJhbSBsZWRnZXJJdGVyQ2IKICAgICAqICAgICAgICAgICAgSXRlcmF0aW9u\nQ2FsbGJhY2sgdG8gaW52b2tlIG9uY2Ugd2UndmUgcmVjb3ZlcmVkIHRoZSBj\ndXJyZW50CiAgICAgKiAgICAgICAgICAgIGxlZGdlci4KICAgICAqIEBwYXJh\nbSBhdmFpbGFibGVCb29raWVzCiAgICAgKiAgICAgICAgICAgIExpc3Qgb2Yg\nQm9va2llIFNlcnZlcnMgdGhhdCBhcmUgYXZhaWxhYmxlIHRvIHVzZSBmb3IK\nICAgICAqICAgICAgICAgICAgcmVwbGljYXRpbmcgZGF0YSBvbiB0aGUgZmFp\nbGVkIGJvb2tpZS4gVGhpcyBjb3VsZCBjb250YWluIGEKICAgICAqICAgICAg\nICAgICAgc2luZ2xlIGJvb2tpZSBzZXJ2ZXIgaWYgdGhlIHVzZXIgZXhwbGlj\naXRseSBjaG9zZSBhIGJvb2tpZQogICAgICogICAgICAgICAgICBzZXJ2ZXIg\ndG8gcmVwbGljYXRlIGRhdGEgdG8uCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCByZWNvdmVyTGVkZ2VyKGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIGJvb2tp\nZVNyYywgZmluYWwgbG9uZyBsSWQsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBmaW5hbCBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBsZWRn\nZXJJdGVyQ2IsIGZpbmFsIExpc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGF2YWls\nYWJsZUJvb2tpZXMpIHsKICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVk\nKCkpIHsKICAgICAgICAgICAgTE9HLmRlYnVnKCJSZWNvdmVyaW5nIGxlZGdl\nciA6ICIgKyBsSWQpOwogICAgICAgIH0KICAgICAgICAvKgogICAgICAgICAq\nIEZvciB0aGUgY3VycmVudCBsZWRnZXIsIG9wZW4gaXQgdG8gcmV0cmlldmUg\ndGhlIExlZGdlckhhbmRsZS4gVGhpcwogICAgICAgICAqIHdpbGwgY29udGFp\nbiB0aGUgTGVkZ2VyTWV0YWRhdGEgaW5kaWNhdGluZyB3aGljaCBib29raWUg\nc2VydmVycyB0aGUKICAgICAgICAgKiBsZWRnZXIgZnJhZ21lbnRzIGFyZSBz\ndG9yZWQgb24uIENoZWNrIGlmIGFueSBvZiB0aGUgbGVkZ2VyIGZyYWdtZW50\ncwogICAgICAgICAqIGZvciB0aGUgY3VycmVudCBsZWRnZXIgYXJlIHN0b3Jl\nZCBvbiB0aGUgaW5wdXQgZGVhZCBib29raWUuCiAgICAgICAgICovCiAgICAg\nICAgRGlnZXN0VHlwZSBkaWdlc3RUeXBlID0gZ2V0TGVkZ2VyRGlnZXN0VHlw\nZShsSWQpOwogICAgICAgIGJ5dGVbXSBwYXNzd2QgPSBnZXRMZWRnZXJQYXNz\nd2QobElkKTsKICAgICAgICBia2MuYXN5bmNPcGVuTGVkZ2VyTm9SZWNvdmVy\neShsSWQsIGRpZ2VzdFR5cGUsIHBhc3N3ZCwgbmV3IE9wZW5DYWxsYmFjaygp\nIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIG9wZW5Db21wbGV0ZShpbnQgcmMsIGZpbmFsIExlZGdlckhhbmRsZSBs\naCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgaWYgKHJjICE9IENv\nZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgIExPRy5l\ncnJvcigiQksgZXJyb3Igb3BlbmluZyBsZWRnZXI6ICIgKyBsSWQsIEJLRXhj\nZXB0aW9uLmNyZWF0ZShyYykpOwogICAgICAgICAgICAgICAgICAgIGxlZGdl\nckl0ZXJDYi5wcm9jZXNzUmVzdWx0KHJjLCBudWxsLCBudWxsKTsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICogVGhpcyBMaXN0IHN0\nb3JlcyB0aGUgbGVkZ2VyIGZyYWdtZW50cyB0byByZWNvdmVyIGluZGV4ZWQg\nYnkKICAgICAgICAgICAgICAgICAqIHRoZSBzdGFydCBlbnRyeSBJRCBmb3Ig\ndGhlIHJhbmdlLiBUaGUgZW5zZW1ibGVzIFRyZWVNYXAgaXMKICAgICAgICAg\nICAgICAgICAqIGtleWVkIG9mZiB0aGlzLgogICAgICAgICAgICAgICAgICov\nCiAgICAgICAgICAgICAgICBmaW5hbCBMaXN0PExvbmc+IGxlZGdlckZyYWdt\nZW50c1RvUmVjb3ZlciA9IG5ldyBMaW5rZWRMaXN0PExvbmc+KCk7CiAgICAg\nICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICogVGhpcyBNYXAgd2ls\nbCBzdG9yZSB0aGUgc3RhcnQgYW5kIGVuZCBlbnRyeSBJRCB2YWx1ZXMgZm9y\nCiAgICAgICAgICAgICAgICAgKiBlYWNoIG9mIHRoZSBsZWRnZXIgZnJhZ21l\nbnQgcmFuZ2VzLiBUaGUgb25seSBleGNlcHRpb24gaXMgdGhlCiAgICAgICAg\nICAgICAgICAgKiBjdXJyZW50IGFjdGl2ZSBmcmFnbWVudCBzaW5jZSBpdCBo\nYXMgbm8gZW5kIHlldC4gSW4gdGhlIGV2ZW50CiAgICAgICAgICAgICAgICAg\nKiBvZiBhIGJvb2tpZSBmYWlsdXJlLCBhIG5ldyBlbnNlbWJsZSBpcyBjcmVh\ndGVkIHNvIHRoZSBjdXJyZW50CiAgICAgICAgICAgICAgICAgKiBlbnNlbWJs\nZSBzaG91bGQgbm90IGNvbnRhaW4gdGhlIGRlYWQgYm9va2llIHdlIGFyZSB0\ncnlpbmcgdG8KICAgICAgICAgICAgICAgICAqIHJlY292ZXIuCiAgICAgICAg\nICAgICAgICAgKi8KICAgICAgICAgICAgICAgIE1hcDxMb25nLCBMb25nPiBs\nZWRnZXJGcmFnbWVudHNSYW5nZSA9IG5ldyBIYXNoTWFwPExvbmcsIExvbmc+\nKCk7CiAgICAgICAgICAgICAgICBMb25nIGN1ckVudHJ5SWQgPSBudWxsOwog\nICAgICAgICAgICAgICAgZm9yIChNYXAuRW50cnk8TG9uZywgQXJyYXlMaXN0\nPEluZXRTb2NrZXRBZGRyZXNzPj4gZW50cnkgOiBsaC5nZXRMZWRnZXJNZXRh\nZGF0YSgpLmdldEVuc2VtYmxlcygpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAuZW50cnlTZXQoKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChjdXJF\nbnRyeUlkICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGxlZGdl\nckZyYWdtZW50c1JhbmdlLnB1dChjdXJFbnRyeUlkLCBlbnRyeS5nZXRLZXko\nKSAtIDEpOwogICAgICAgICAgICAgICAgICAgIGN1ckVudHJ5SWQgPSBlbnRy\neS5nZXRLZXkoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZW50cnkuZ2V0\nVmFsdWUoKS5jb250YWlucyhib29raWVTcmMpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICAgICAgICAqIEN1cnJl\nbnQgbGVkZ2VyIGZyYWdtZW50IGhhcyBlbnRyaWVzIHN0b3JlZCBvbiB0aGUK\nICAgICAgICAgICAgICAgICAgICAgICAgICogZGVhZCBib29raWUgc28gd2Un\nbGwgbmVlZCB0byByZWNvdmVyIHRoZW0uCiAgICAgICAgICAgICAgICAgICAg\nICAgICAqLwogICAgICAgICAgICAgICAgICAgICAgICBsZWRnZXJGcmFnbWVu\ndHNUb1JlY292ZXIuYWRkKGVudHJ5LmdldEtleSgpKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAv\nKgogICAgICAgICAgICAgICAgICogU2VlIGlmIHRoaXMgY3VycmVudCBsZWRn\nZXIgY29udGFpbnMgYW55IGxlZGdlciBmcmFnbWVudCB0aGF0CiAgICAgICAg\nICAgICAgICAgKiBuZWVkcyB0byBiZSByZS1yZXBsaWNhdGVkLiBJZiBub3Qs\nIHRoZW4ganVzdCBpbnZva2UgdGhlCiAgICAgICAgICAgICAgICAgKiBtdWx0\naUNhbGxiYWNrIGFuZCByZXR1cm4uCiAgICAgICAgICAgICAgICAgKi8KICAg\nICAgICAgICAgICAgIGlmIChsZWRnZXJGcmFnbWVudHNUb1JlY292ZXIuc2l6\nZSgpID09IDApIHsKICAgICAgICAgICAgICAgICAgICBsZWRnZXJJdGVyQ2Iu\ncHJvY2Vzc1Jlc3VsdChCS0V4Y2VwdGlvbi5Db2RlLk9LLCBudWxsLCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAg\nICB9CgogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAqIE11\nbHRpY2FsbGJhY2sgZm9yIGxlZGdlci4gT25jZSBhbGwgZnJhZ21lbnRzIGZv\nciB0aGUgbGVkZ2VyIGhhdmUgYmVlbiByZWNvdmVyZWQKICAgICAgICAgICAg\nICAgICAqIHRyaWdnZXIgdGhlIGxlZGdlckl0ZXJDYgogICAgICAgICAgICAg\nICAgICovCiAgICAgICAgICAgICAgICBNdWx0aUNhbGxiYWNrIGxlZGdlckZy\nYWdtZW50c01jYgogICAgICAgICAgICAgICAgICAgID0gbmV3IE11bHRpQ2Fs\nbGJhY2sobGVkZ2VyRnJhZ21lbnRzVG9SZWNvdmVyLnNpemUoKSwgbGVkZ2Vy\nSXRlckNiLCBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgQktFeGNlcHRpb24uQ29kZS5PSywgQktFeGNlcHRpb24uQ29k\nZS5MZWRnZXJSZWNvdmVyeUV4Y2VwdGlvbik7CiAgICAgICAgICAgICAgICAv\nKgogICAgICAgICAgICAgICAgICogTm93IHJlY292ZXIgYWxsIG9mIHRoZSBu\nZWNlc3NhcnkgbGVkZ2VyIGZyYWdtZW50cwogICAgICAgICAgICAgICAgICog\nYXN5bmNocm9ub3VzbHkgdXNpbmcgYSBNdWx0aUNhbGxiYWNrIGZvciBldmVy\neSBmcmFnbWVudC4KICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAg\nICAgZm9yIChmaW5hbCBMb25nIHN0YXJ0RW50cnlJZCA6IGxlZGdlckZyYWdt\nZW50c1RvUmVjb3ZlcikgewogICAgICAgICAgICAgICAgICAgIExvbmcgZW5k\nRW50cnlJZCA9IGxlZGdlckZyYWdtZW50c1JhbmdlLmdldChzdGFydEVudHJ5\nSWQpOwogICAgICAgICAgICAgICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIG5l\nd0Jvb2tpZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICAgICAgbmV3Qm9va2llID0gZ2V0TmV3Qm9va2ll\nKGxoLmdldExlZGdlck1ldGFkYXRhKCkuZ2V0RW5zZW1ibGVzKCkuZ2V0KHN0\nYXJ0RW50cnlJZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBhdmFpbGFibGVCb29raWVzKTsKICAgICAgICAg\nICAgICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5CS05vdEVub3VnaEJv\nb2tpZXNFeGNlcHRpb24gYmtlKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGxlZGdlckZyYWdtZW50c01jYi5wcm9jZXNzUmVzdWx0KEJLRXhjZXB0aW9u\nLkNvZGUuTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbiwgCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG51bGwsIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nCiAgICAgICAgICAgICAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiUmVwbGlj\nYXRpbmcgZnJhZ21lbnQgZnJvbSBbIiArIHN0YXJ0RW50cnlJZCAKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiwiICsgZW5kRW50cnlJ\nZCArICJdIG9mIGxlZGdlciAiICsgbGguZ2V0SWQoKQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyAiIHRvICIgKyBuZXdCb29raWUpOwog\nICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2luZ2xlRnJhZ21lbnRDYWxs\nYmFjayBjYiA9IG5ldyBTaW5nbGVGcmFnbWVudENhbGxiYWNrKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVkZ2VyRnJhZ21lbnRzTWNi\nLCBsaCwgc3RhcnRFbnRyeUlkLCBib29raWVTcmMsIG5ld0Jvb2tpZSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHJlY292ZXJMZWRnZXJGcmFnbWVudChi\nb29raWVTcmMsIGxoLCBzdGFydEVudHJ5SWQsIGVuZEVudHJ5SWQsIGNiLCBu\nZXdCb29raWUpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIH0s\nIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgYXN5\nbmNocm9ub3VzbHkgcmVjb3ZlcnMgYSBsZWRnZXIgZnJhZ21lbnQgd2hpY2gg\naXMgYQogICAgICogY29udGlndW91cyBwb3J0aW9uIG9mIGEgbGVkZ2VyIHRo\nYXQgd2FzIHN0b3JlZCBpbiBhbiBlbnNlbWJsZSB0aGF0CiAgICAgKiBpbmNs\ndWRlZCB0aGUgZmFpbGVkIGJvb2tpZS4KICAgICAqCiAgICAgKiBAcGFyYW0g\nYm9va2llU3JjCiAgICAgKiAgICAgICAgICAgIFNvdXJjZSBib29raWUgdGhh\ndCBoYWQgYSBmYWlsdXJlLiBXZSB3YW50IHRvIHJlcGxpY2F0ZSB0aGUKICAg\nICAqICAgICAgICAgICAgbGVkZ2VyIGZyYWdtZW50cyB0aGF0IHdlcmUgc3Rv\ncmVkIHRoZXJlLgogICAgICogQHBhcmFtIGxoCiAgICAgKiAgICAgICAgICAg\nIExlZGdlckhhbmRsZSBmb3IgdGhlIGxlZGdlcgogICAgICogQHBhcmFtIHN0\nYXJ0RW50cnlJZAogICAgICogICAgICAgICAgICBTdGFydCBlbnRyeSBJZCBm\nb3IgdGhlIGxlZGdlciBmcmFnbWVudAogICAgICogQHBhcmFtIGVuZEVudHJ5\nSWQKICAgICAqICAgICAgICAgICAgRW5kIGVudHJ5IElkIGZvciB0aGUgbGVk\nZ2VyIGZyYWdtZW50CiAgICAgKiBAcGFyYW0gbGVkZ2VyRnJhZ21lbnRNY2IK\nICAgICAqICAgICAgICAgICAgTXVsdGlDYWxsYmFjayB0byBpbnZva2Ugb25j\nZSB3ZSd2ZSByZWNvdmVyZWQgdGhlIGN1cnJlbnQKICAgICAqICAgICAgICAg\nICAgbGVkZ2VyIGZyYWdtZW50LgogICAgICogQHBhcmFtIG5ld0Jvb2tpZQog\nICAgICogICAgICAgICAgICBOZXcgYm9va2llIHdlIHdhbnQgdG8gdXNlIHRv\nIHJlY292ZXIgYW5kIHJlcGxpY2F0ZSB0aGUgbGVkZ2VyCiAgICAgKiAgICAg\nICAgICAgIGVudHJpZXMgdGhhdCB3ZXJlIHN0b3JlZCBvbiB0aGUgZmFpbGVk\nIGJvb2tpZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlY292ZXJMZWRn\nZXJGcmFnbWVudChmaW5hbCBJbmV0U29ja2V0QWRkcmVzcyBib29raWVTcmMs\nIGZpbmFsIExlZGdlckhhbmRsZSBsaCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZmluYWwgTG9uZyBzdGFydEVudHJ5SWQsIGZp\nbmFsIExvbmcgZW5kRW50cnlJZCwgZmluYWwgU2luZ2xlRnJhZ21lbnRDYWxs\nYmFjayBjYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZmluYWwgSW5ldFNvY2tldEFkZHJlc3MgbmV3Qm9va2llKSB0aHJvd3Mg\nSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIGlmIChlbmRFbnRyeUlk\nID09IG51bGwpIHsKICAgICAgICAgICAgLyoKICAgICAgICAgICAgICogSWRl\nYWxseSB0aGlzIHNob3VsZCBuZXZlciBoYXBwZW4gaWYgYm9va2llIGZhaWx1\ncmUgaXMgdGFrZW4gY2FyZQogICAgICAgICAgICAgKiBvZiBwcm9wZXJseS4g\nTm90aGluZyB3ZSBjYW4gZG8gdGhvdWdoIGluIHRoaXMgY2FzZS4KICAgICAg\nICAgICAgICovCiAgICAgICAgICAgIExPRy53YXJuKCJEZWFkIGJvb2tpZSAo\nIiArIGJvb2tpZVNyYyArICIpIGlzIHN0aWxsIHBhcnQgb2YgdGhlIGN1cnJl\nbnQgYWN0aXZlIGVuc2VtYmxlIGZvciBsZWRnZXJJZDogIgogICAgICAgICAg\nICAgICAgICAgICArIGxoLmdldElkKCkpOwogICAgICAgICAgICBjYi5wcm9j\nZXNzUmVzdWx0KEJLRXhjZXB0aW9uLkNvZGUuT0ssIG51bGwsIG51bGwpOwog\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBBcnJheUxp\nc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGN1ckVuc2VtYmxlID0gbGguZ2V0TGVk\nZ2VyTWV0YWRhdGEoKS5nZXRFbnNlbWJsZXMoKS5nZXQoc3RhcnRFbnRyeUlk\nKTsKICAgICAgICBpbnQgYm9va2llSW5kZXggPSAwOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY3VyRW5zZW1ibGUuc2l6ZSgpOyBpKyspIHsKICAg\nICAgICAgICAgaWYgKGN1ckVuc2VtYmxlLmdldChpKS5lcXVhbHMoYm9va2ll\nU3JjKSkgewogICAgICAgICAgICAgICAgYm9va2llSW5kZXggPSBpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgLyoKICAgICAgICAgKiBMb29wIHRocm91Z2ggYWxsIGVudHJpZXMg\naW4gdGhlIGN1cnJlbnQgbGVkZ2VyIGZyYWdtZW50IHJhbmdlIGFuZAogICAg\nICAgICAqIGZpbmQgdGhlIG9uZXMgdGhhdCB3ZXJlIHN0b3JlZCBvbiB0aGUg\nZGVhZCBib29raWUuCiAgICAgICAgICovCiAgICAgICAgTGlzdDxMb25nPiBl\nbnRyaWVzVG9SZXBsaWNhdGUgPSBuZXcgTGlua2VkTGlzdDxMb25nPigpOwog\nICAgICAgIGZvciAobG9uZyBpID0gc3RhcnRFbnRyeUlkOyBpIDw9IGVuZEVu\ndHJ5SWQ7IGkrKykgewogICAgICAgICAgICBpZiAobGguZ2V0RGlzdHJpYnV0\naW9uU2NoZWR1bGUoKS5nZXRSZXBsaWNhSW5kZXgoaSwgYm9va2llSW5kZXgp\nID49IDApIHsKICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAg\nKiBDdXJyZW50IGVudHJ5IGlzIHN0b3JlZCBvbiB0aGUgZGVhZCBib29raWUg\nc28gd2UnbGwgbmVlZCB0bwogICAgICAgICAgICAgICAgICogcmVhZCBpdCBh\nbmQgcmVwbGljYXRlIGl0IHRvIGEgbmV3IGJvb2tpZS4KICAgICAgICAgICAg\nICAgICAqLwogICAgICAgICAgICAgICAgZW50cmllc1RvUmVwbGljYXRlLmFk\nZChpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvKgogICAg\nICAgICAqIE5vdyBhc3luY2hyb25vdXNseSByZXBsaWNhdGUgYWxsIG9mIHRo\nZSBlbnRyaWVzIGZvciB0aGUgbGVkZ2VyCiAgICAgICAgICogZnJhZ21lbnQg\ndGhhdCB3ZXJlIG9uIHRoZSBkZWFkIGJvb2tpZS4KICAgICAgICAgKi8KICAg\nICAgICBNdWx0aUNhbGxiYWNrIGxlZGdlckZyYWdtZW50RW50cnlNY2IgPQog\nICAgICAgICAgICBuZXcgTXVsdGlDYWxsYmFjayhlbnRyaWVzVG9SZXBsaWNh\ndGUuc2l6ZSgpLCBjYiwgbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgQktFeGNlcHRpb24uQ29kZS5PSywgQktFeGNlcHRpb24uQ29kZS5M\nZWRnZXJSZWNvdmVyeUV4Y2VwdGlvbik7CiAgICAgICAgZm9yIChmaW5hbCBM\nb25nIGVudHJ5SWQgOiBlbnRyaWVzVG9SZXBsaWNhdGUpIHsKICAgICAgICAg\nICAgcmVjb3ZlckxlZGdlckZyYWdtZW50RW50cnkoZW50cnlJZCwgbGgsIGxl\nZGdlckZyYWdtZW50RW50cnlNY2IsIG5ld0Jvb2tpZSk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgYXN5bmNocm9ub3Vz\nbHkgcmVjb3ZlcnMgYSBzcGVjaWZpYyBsZWRnZXIgZW50cnkgYnkgcmVhZGlu\nZwogICAgICogdGhlIHZhbHVlcyB2aWEgdGhlIEJvb2tLZWVwZXIgQ2xpZW50\nICh3aGljaCB3b3VsZCByZWFkIGl0IGZyb20gdGhlIG90aGVyCiAgICAgKiBy\nZXBsaWNhcykgYW5kIHRoZW4gd3JpdGluZyBpdCB0byB0aGUgY2hvc2VuIG5l\ndyBib29raWUuCiAgICAgKgogICAgICogQHBhcmFtIGVudHJ5SWQKICAgICAq\nICAgICAgICAgICAgTGVkZ2VyIEVudHJ5IElEIHRvIHJlY292ZXIuCiAgICAg\nKiBAcGFyYW0gbGgKICAgICAqICAgICAgICAgICAgTGVkZ2VySGFuZGxlIGZv\nciB0aGUgbGVkZ2VyCiAgICAgKiBAcGFyYW0gbGVkZ2VyRnJhZ21lbnRFbnRy\neU1jYgogICAgICogICAgICAgICAgICBNdWx0aUNhbGxiYWNrIHRvIGludm9r\nZSBvbmNlIHdlJ3ZlIHJlY292ZXJlZCB0aGUgY3VycmVudAogICAgICogICAg\nICAgICAgICBsZWRnZXIgZW50cnkuCiAgICAgKiBAcGFyYW0gbmV3Qm9va2ll\nCiAgICAgKiAgICAgICAgICAgIE5ldyBib29raWUgd2Ugd2FudCB0byB1c2Ug\ndG8gcmVjb3ZlciBhbmQgcmVwbGljYXRlIHRoZSBsZWRnZXIKICAgICAqICAg\nICAgICAgICAgZW50cmllcyB0aGF0IHdlcmUgc3RvcmVkIG9uIHRoZSBmYWls\nZWQgYm9va2llLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcmVjb3Zlckxl\nZGdlckZyYWdtZW50RW50cnkoZmluYWwgTG9uZyBlbnRyeUlkLCBmaW5hbCBM\nZWRnZXJIYW5kbGUgbGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWwgTXVsdGlDYWxsYmFjayBsZWRnZXJGcmFn\nbWVudEVudHJ5TWNiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBJbmV0U29ja2V0QWRkcmVzcyBuZXdCb29r\naWUpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgLyoK\nICAgICAgICAgKiBSZWFkIHRoZSBsZWRnZXIgZW50cnkgdXNpbmcgdGhlIExl\nZGdlckhhbmRsZS4gVGhpcyB3aWxsIGFsbG93IHVzIHRvCiAgICAgICAgICog\ncmVhZCB0aGUgZW50cnkgZnJvbSBvbmUgb2YgdGhlIG90aGVyIHJlcGxpY2F0\nZWQgYm9va2llcyBvdGhlciB0aGFuCiAgICAgICAgICogdGhlIGRlYWQgb25l\nLgogICAgICAgICAqLwogICAgICAgIGxoLmFzeW5jUmVhZEVudHJpZXMoZW50\ncnlJZCwgZW50cnlJZCwgbmV3IFJlYWRDYWxsYmFjaygpIHsKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJlYWRDb21w\nbGV0ZShpbnQgcmMsIExlZGdlckhhbmRsZSBsaCwgRW51bWVyYXRpb248TGVk\nZ2VyRW50cnk+IHNlcSwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAg\naWYgKHJjICE9IENvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiQksgZXJyb3IgcmVhZGluZyBsZWRnZXIgZW50\ncnk6ICIgKyBlbnRyeUlkLCBCS0V4Y2VwdGlvbi5jcmVhdGUocmMpKTsKICAg\nICAgICAgICAgICAgICAgICBsZWRnZXJGcmFnbWVudEVudHJ5TWNiLnByb2Nl\nc3NSZXN1bHQocmMsIG51bGwsIG51bGwpOwogICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8q\nCiAgICAgICAgICAgICAgICAgKiBOb3cgdGhhdCB3ZSd2ZSByZWFkIHRoZSBs\nZWRnZXIgZW50cnksIHdyaXRlIGl0IHRvIHRoZSBuZXcKICAgICAgICAgICAg\nICAgICAqIGJvb2tpZSB3ZSd2ZSBzZWxlY3RlZC4KICAgICAgICAgICAgICAg\nICAqLwogICAgICAgICAgICAgICAgTGVkZ2VyRW50cnkgZW50cnkgPSBzZXEu\nbmV4dEVsZW1lbnQoKTsKICAgICAgICAgICAgICAgIGJ5dGVbXSBkYXRhID0g\nZW50cnkuZ2V0RW50cnkoKTsKICAgICAgICAgICAgICAgIENoYW5uZWxCdWZm\nZXIgdG9TZW5kID0gbGguZ2V0RGlnZXN0TWFuYWdlcigpLmNvbXB1dGVEaWdl\nc3RBbmRQYWNrYWdlRm9yU2VuZGluZyhlbnRyeUlkLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBsaC5nZXRMYXN0QWRkQ29uZmly\nbWVkKCksIGVudHJ5LmdldExlbmd0aCgpLCBkYXRhLCAwLCBkYXRhLmxlbmd0\naCk7CiAgICAgICAgICAgICAgICBia2MuZ2V0Qm9va2llQ2xpZW50KCkuYWRk\nRW50cnkobmV3Qm9va2llLCBsaC5nZXRJZCgpLCBsaC5nZXRMZWRnZXJLZXko\nKSwgZW50cnlJZCwgdG9TZW5kLAogICAgICAgICAgICAgICAgbmV3IFdyaXRl\nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgd3JpdGVDb21wbGV0ZShp\nbnQgcmMsIGxvbmcgbGVkZ2VySWQsIGxvbmcgZW50cnlJZCwgSW5ldFNvY2tl\ndEFkZHJlc3MgYWRkciwKICAgICAgICAgICAgICAgICAgICBPYmplY3QgY3R4\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9L\nLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExP\nRy5lcnJvcigiQksgZXJyb3Igd3JpdGluZyBlbnRyeSBmb3IgbGVkZ2VySWQ6\nICIgKyBsZWRnZXJJZCArICIsIGVudHJ5SWQ6ICIKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICArIGVudHJ5SWQgKyAiLCBib29raWU6\nICIgKyBhZGRyLCBCS0V4Y2VwdGlvbi5jcmVhdGUocmMpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChMT0cuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiU3VjY2VzcyB3cml0\naW5nIGxlZGdlciBpZCAiICtsZWRnZXJJZCArICIsIGVudHJ5IGlkICIKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBlbnRy\neUlkICsgIiB0byBhIG5ldyBib29raWUgIiArIGFkZHIgKyAiISIpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAg\nICAgICAgICAgICAgICAqIFBhc3MgdGhlIHJldHVybiBjb2RlIHJlc3VsdCB1\ncCB0aGUgY2hhaW4gd2l0aAogICAgICAgICAgICAgICAgICAgICAgICAgKiB0\naGUgcGFyZW50IGNhbGxiYWNrLgogICAgICAgICAgICAgICAgICAgICAgICAg\nKi8KICAgICAgICAgICAgICAgICAgICAgICAgbGVkZ2VyRnJhZ21lbnRFbnRy\neU1jYi5wcm9jZXNzUmVzdWx0KHJjLCBudWxsLCBudWxsKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBudWxsLCBCb29raWVQ\ncm90b2NvbC5GTEFHX1JFQ09WRVJZX0FERCk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9LCBudWxsKTsKICAgIH0KCiAgICAvKgogICAgICogQ2FsbGJhY2sg\nZm9yIHJlY292ZXJ5IG9mIGEgc2luZ2xlIGxlZGdlciBmcmFnbWVudC4KICAg\nICAqIE9uY2UgdGhlIGZyYWdtZW50IGhhcyBoYWQgYWxsIGVudHJpZXMgcmVw\nbGljYXRlZCwgdXBkYXRlIHRoZSBlbnNlbWJsZSAKICAgICAqIGluIHpvb2tl\nZXBlci4KICAgICAqIE9uY2UgZmluaXNoZWQgcHJvcG9nYXRlIGNhbGxiYWNr\nIHVwIHRvIGxlZGdlckZyYWdtZW50c01jYiB3aGljaCBzaG91bGQKICAgICAq\nIGJlIGEgbXVsdGljYWxsYmFjayByZXNwb25zaWJsZSBmb3IgYWxsIGZyYWdt\nZW50cyBpbiBhIHNpbmdsZSBsZWRnZXIKICAgICAqLwogICAgY2xhc3MgU2lu\nZ2xlRnJhZ21lbnRDYWxsYmFjayBpbXBsZW1lbnRzIEFzeW5jQ2FsbGJhY2su\nVm9pZENhbGxiYWNrIHsKICAgICAgICBmaW5hbCBNdWx0aUNhbGxiYWNrIGxl\nZGdlckZyYWdtZW50c01jYjsKICAgICAgICBmaW5hbCBMZWRnZXJIYW5kbGUg\nbGg7CiAgICAgICAgZmluYWwgbG9uZyBmcmFnbWVudFN0YXJ0SWQ7CiAgICAg\nICAgZmluYWwgSW5ldFNvY2tldEFkZHJlc3Mgb2xkQm9va2llOwogICAgICAg\nIGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIG5ld0Jvb2tpZTsKCiAgICAgICAg\nU2luZ2xlRnJhZ21lbnRDYWxsYmFjayhNdWx0aUNhbGxiYWNrIGxlZGdlckZy\nYWdtZW50c01jYiwgTGVkZ2VySGFuZGxlIGxoLCAKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxvbmcgZnJhZ21lbnRTdGFydElkLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgSW5ldFNvY2tldEFkZHJlc3Mgb2xk\nQm9va2llLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5ldFNv\nY2tldEFkZHJlc3MgbmV3Qm9va2llKSB7CiAgICAgICAgICAgIHRoaXMubGVk\nZ2VyRnJhZ21lbnRzTWNiID0gbGVkZ2VyRnJhZ21lbnRzTWNiOwogICAgICAg\nICAgICB0aGlzLmxoID0gbGg7CiAgICAgICAgICAgIHRoaXMuZnJhZ21lbnRT\ndGFydElkID0gZnJhZ21lbnRTdGFydElkOwogICAgICAgICAgICB0aGlzLm5l\nd0Jvb2tpZSA9IG5ld0Jvb2tpZTsKICAgICAgICAgICAgdGhpcy5vbGRCb29r\naWUgPSBvbGRCb29raWU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50\nIHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICBp\nZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIkJLIGVycm9yIHJlcGxpY2F0aW5nIGxlZGdlciBmcmFn\nbWVudHMgZm9yIGxlZGdlcjogIiArIGxoLmdldElkKCksIAogICAgICAgICAg\nICAgICAgICAgICAgICAgIEJLRXhjZXB0aW9uLmNyZWF0ZShyYykpOwogICAg\nICAgICAgICAgICAgbGVkZ2VyRnJhZ21lbnRzTWNiLnByb2Nlc3NSZXN1bHQo\ncmMsIG51bGwsIG51bGwpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAqIFVwZGF0\nZSB0aGUgbGVkZ2VyIG1ldGFkYXRhJ3MgZW5zZW1ibGUgaW5mbyB0byBwb2lu\ndAogICAgICAgICAgICAgKiB0byB0aGUgbmV3IGJvb2tpZS4KICAgICAgICAg\nICAgICovCiAgICAgICAgICAgIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVz\ncz4gZW5zZW1ibGUgPSBsaC5nZXRMZWRnZXJNZXRhZGF0YSgpLmdldEVuc2Vt\nYmxlcygpLmdldCgKICAgICAgICAgICAgICAgICAgICBmcmFnbWVudFN0YXJ0\nSWQpOwogICAgICAgICAgICBpbnQgZGVhZEJvb2tpZUluZGV4ID0gZW5zZW1i\nbGUuaW5kZXhPZihvbGRCb29raWUpOwogICAgICAgICAgICBlbnNlbWJsZS5y\nZW1vdmUoZGVhZEJvb2tpZUluZGV4KTsKICAgICAgICAgICAgZW5zZW1ibGUu\nYWRkKGRlYWRCb29raWVJbmRleCwgbmV3Qm9va2llKTsKICAgICAgICAgICAg\nCiAgICAgICAgICAgIAogICAgICAgICAgICBsaC53cml0ZUxlZGdlckNvbmZp\nZyhuZXcgV3JpdGVDYigpLCBudWxsKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHJpdmF0ZSBjbGFzcyBXcml0ZUNiIGltcGxlbWVudHMgQXN5bmND\nYWxsYmFjay5TdGF0Q2FsbGJhY2sgewogICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMs\nIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4LCBTdGF0IHN0YXQpIHsKICAgICAg\nICAgICAgICAgIGlmIChyYyA9PSBDb2RlLkJBRFZFUlNJT04uaW50VmFsdWUo\nKSkgewogICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJUd28gZnJhZ21l\nbnRzIGF0dGVtcHRlZCB1cGRhdGUgYXQgb25jZTsgbGVkZ2VyIGlkOiAiICsg\nbGguZ2V0SWQoKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIg\nc3RhcnRpZDogIiArIGZyYWdtZW50U3RhcnRJZCk7CiAgICAgICAgICAgICAg\nICAgICAgLy8gdHJ5IGFnYWluLCB0aGUgcHJldmlvdXMgc3VjY2VzcyAod2l0\naCB3aGljaCB0aGlzIGhhcyBjb25mbGljdGVkKQogICAgICAgICAgICAgICAg\nICAgIC8vIHdpbGwgaGF2ZSB1cGRhdGVkIHRoZSBzdGF0CiAgICAgICAgICAg\nICAgICAgICAgbGgud3JpdGVMZWRnZXJDb25maWcobmV3IFdyaXRlQ2IoKSwg\nbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAg\nICAgICAgfSBlbHNlIGlmIChyYyAhPSBDb2RlLk9LLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIlpLIGVycm9yIHVwZGF0\naW5nIGxlZGdlciBjb25maWcgbWV0YWRhdGEgZm9yIGxlZGdlcklkOiAiICsg\nbGguZ2V0SWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2Vl\ncGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZS5nZXQo\ncmMpLCBwYXRoKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgICAgIGxoLmdldExlZGdlck1ldGFkYXRhKCkudXBkYXRlWm5v\nZGVTdGF0dXMoc3RhdCk7CiAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8o\nIlVwZGF0ZWQgWksgZm9yIGxlZGdlcklkOiAoIiArIGxoLmdldElkKCkgKyAi\nIDogIiArIGZyYWdtZW50U3RhcnRJZCAKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICArICIpIHRvIHBvaW50IGxlZGdlciBmcmFnbWVudHMgZnJvbSBv\nbGQgZGVhZCBib29raWU6ICgiICsgb2xkQm9va2llCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyAiKSB0byBuZXcgYm9va2llOiAoIiArIG5ld0Jv\nb2tpZSArICIpIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAvKgogICAgICAgICAgICAgICAgICogUGFzcyB0aGUgcmV0dXJuIGNvZGUg\ncmVzdWx0IHVwIHRoZSBjaGFpbiB3aXRoCiAgICAgICAgICAgICAgICAgKiB0\naGUgcGFyZW50IGNhbGxiYWNrLgogICAgICAgICAgICAgICAgICovCiAgICAg\nICAgICAgICAgICBsZWRnZXJGcmFnbWVudHNNY2IucHJvY2Vzc1Jlc3VsdChy\nYywgbnVsbCwgbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAg\nfQp9Cg==\n","encoding":"base64"}

