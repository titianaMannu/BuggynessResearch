{"sha":"ae375ecfa6dd7fdea7ff661568f9207b389d8ba2","node_id":"MDQ6QmxvYjE1NzU5NTY6YWUzNzVlY2ZhNmRkN2ZkZWE3ZmY2NjE1NjhmOTIwN2IzODlkOGJhMg==","size":6629,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ae375ecfa6dd7fdea7ff661568f9207b389d8ba2","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNv\nZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq\nIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmltcG9ydCBq\nYXZhLm5pby5CeXRlQnVmZmVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5HZW5l\ncmFsU2VjdXJpdHlFeGNlcHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbi5CS0RpZ2VzdE1hdGNoRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29r\nS2VlcGVyLkRpZ2VzdFR5cGU7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CmltcG9ydCBvcmcuamJv\nc3MubmV0dHkuYnVmZmVyLkNoYW5uZWxCdWZmZXI7CmltcG9ydCBvcmcuamJv\nc3MubmV0dHkuYnVmZmVyLkNoYW5uZWxCdWZmZXJJbnB1dFN0cmVhbTsKaW1w\nb3J0IG9yZy5qYm9zcy5uZXR0eS5idWZmZXIuQ2hhbm5lbEJ1ZmZlcnM7Cgov\nKioKICogVGhpcyBjbGFzcyB0YWtlcyBhbiBlbnRyeSwgYXR0YWNoZXMgYSBk\naWdlc3QgdG8gaXQgYW5kIHBhY2thZ2VzIGl0IHdpdGggcmVsZXZhbnQKICog\nZGF0YSBzbyB0aGF0IGl0IGNhbiBiZSBzaGlwcGVkIHRvIHRoZSBib29raWUu\nIE9uIHRoZSByZXR1cm4gc2lkZSwgaXQgYWxzbwogKiBnZXRzIGEgcGFja2V0\nLCBjaGVja3MgdGhhdCB0aGUgZGlnZXN0IG1hdGNoZXMsIGFuZCBleHRyYWN0\ncyB0aGUgb3JpZ2luYWwgZW50cnkKICogZm9yIHRoZSBwYWNrZXQuIEN1cnJl\nbnRseSAyIHR5cGVzIG9mIGRpZ2VzdHMgYXJlIHN1cHBvcnRlZDogTUFDIChi\nYXNlZCBvbiBTSEEtMSkgYW5kIENSQzMyCiAqLwoKYWJzdHJhY3QgY2xhc3Mg\nRGlnZXN0TWFuYWdlciB7CiAgICBzdGF0aWMgZmluYWwgTG9nZ2VyIGxvZ2dl\nciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKERpZ2VzdE1hbmFnZXIuY2xh\nc3MpOwoKICAgIHN0YXRpYyBmaW5hbCBpbnQgTUVUQURBVEFfTEVOR1RIID0g\nMzI7CgogICAgbG9uZyBsZWRnZXJJZDsKCiAgICBhYnN0cmFjdCBpbnQgZ2V0\nTWFjQ29kZUxlbmd0aCgpOwoKICAgIHZvaWQgdXBkYXRlKGJ5dGVbXSBkYXRh\nKSB7CiAgICAgICAgdXBkYXRlKGRhdGEsIDAsIGRhdGEubGVuZ3RoKTsKICAg\nIH0KCiAgICBhYnN0cmFjdCB2b2lkIHVwZGF0ZShieXRlW10gZGF0YSwgaW50\nIG9mZnNldCwgaW50IGxlbmd0aCk7CiAgICBhYnN0cmFjdCBieXRlW10gZ2V0\nVmFsdWVBbmRSZXNldCgpOwoKICAgIGZpbmFsIGludCBtYWNDb2RlTGVuZ3Ro\nOwoKICAgIHB1YmxpYyBEaWdlc3RNYW5hZ2VyKGxvbmcgbGVkZ2VySWQpIHsK\nICAgICAgICB0aGlzLmxlZGdlcklkID0gbGVkZ2VySWQ7CiAgICAgICAgbWFj\nQ29kZUxlbmd0aCA9IGdldE1hY0NvZGVMZW5ndGgoKTsKICAgIH0KCiAgICBz\ndGF0aWMgRGlnZXN0TWFuYWdlciBpbnN0YW50aWF0ZShsb25nIGxlZGdlcklk\nLCBieXRlW10gcGFzc3dkLCBEaWdlc3RUeXBlIGRpZ2VzdFR5cGUpIHRocm93\ncyBHZW5lcmFsU2VjdXJpdHlFeGNlcHRpb24gewogICAgICAgIHN3aXRjaChk\naWdlc3RUeXBlKSB7CiAgICAgICAgY2FzZSBNQUM6CiAgICAgICAgICAgIHJl\ndHVybiBuZXcgTWFjRGlnZXN0TWFuYWdlcihsZWRnZXJJZCwgcGFzc3dkKTsK\nICAgICAgICBjYXNlIENSQzMyOgogICAgICAgICAgICByZXR1cm4gbmV3IENS\nQzMyRGlnZXN0TWFuYWdlcihsZWRnZXJJZCk7CiAgICAgICAgZGVmYXVsdDoK\nICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxTZWN1cml0eUV4Y2VwdGlv\nbigiVW5rbm93biBjaGVja3N1bSB0eXBlOiAiICsgZGlnZXN0VHlwZSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ29tcHV0ZXMgdGhlIGRp\nZ2VzdCBmb3IgYW4gZW50cnkgYW5kIHB1dCBieXRlcyB0b2dldGhlciBmb3Ig\nc2VuZGluZy4KICAgICAqCiAgICAgKiBAcGFyYW0gZW50cnlJZAogICAgICog\nQHBhcmFtIGxhc3RBZGRDb25maXJtZWQKICAgICAqIEBwYXJhbSBsZW5ndGgK\nICAgICAqIEBwYXJhbSBkYXRhCiAgICAgKiBAcmV0dXJuCiAgICAgKi8KCiAg\nICBwdWJsaWMgQ2hhbm5lbEJ1ZmZlciBjb21wdXRlRGlnZXN0QW5kUGFja2Fn\nZUZvclNlbmRpbmcobG9uZyBlbnRyeUlkLCBsb25nIGxhc3RBZGRDb25maXJt\nZWQsIGxvbmcgbGVuZ3RoLCBieXRlW10gZGF0YSwgaW50IGRvZmZzZXQsIGlu\ndCBkbGVuZ3RoKSB7CgogICAgICAgIGJ5dGVbXSBidWZmZXJBcnJheSA9IG5l\ndyBieXRlW01FVEFEQVRBX0xFTkdUSCArIG1hY0NvZGVMZW5ndGhdOwogICAg\nICAgIEJ5dGVCdWZmZXIgYnVmZmVyID0gQnl0ZUJ1ZmZlci53cmFwKGJ1ZmZl\nckFycmF5KTsKICAgICAgICBidWZmZXIucHV0TG9uZyhsZWRnZXJJZCk7CiAg\nICAgICAgYnVmZmVyLnB1dExvbmcoZW50cnlJZCk7CiAgICAgICAgYnVmZmVy\nLnB1dExvbmcobGFzdEFkZENvbmZpcm1lZCk7CiAgICAgICAgYnVmZmVyLnB1\ndExvbmcobGVuZ3RoKTsKICAgICAgICBidWZmZXIuZmxpcCgpOwoKICAgICAg\nICB1cGRhdGUoYnVmZmVyLmFycmF5KCksIDAsIE1FVEFEQVRBX0xFTkdUSCk7\nCiAgICAgICAgdXBkYXRlKGRhdGEsIGRvZmZzZXQsIGRsZW5ndGgpOwogICAg\nICAgIGJ5dGVbXSBkaWdlc3QgPSBnZXRWYWx1ZUFuZFJlc2V0KCk7CgogICAg\nICAgIGJ1ZmZlci5saW1pdChidWZmZXIuY2FwYWNpdHkoKSk7CiAgICAgICAg\nYnVmZmVyLnBvc2l0aW9uKE1FVEFEQVRBX0xFTkdUSCk7CiAgICAgICAgYnVm\nZmVyLnB1dChkaWdlc3QpOwogICAgICAgIGJ1ZmZlci5mbGlwKCk7CgogICAg\nICAgIHJldHVybiBDaGFubmVsQnVmZmVycy53cmFwcGVkQnVmZmVyKENoYW5u\nZWxCdWZmZXJzLndyYXBwZWRCdWZmZXIoYnVmZmVyKSwgQ2hhbm5lbEJ1ZmZl\ncnMud3JhcHBlZEJ1ZmZlcihkYXRhLCBkb2Zmc2V0LCBkbGVuZ3RoKSk7CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIHZlcmlmeURpZ2VzdChDaGFubmVsQnVm\nZmVyIGRhdGFSZWNlaXZlZCkgdGhyb3dzIEJLRGlnZXN0TWF0Y2hFeGNlcHRp\nb24gewogICAgICAgIHZlcmlmeURpZ2VzdCgtMSwgZGF0YVJlY2VpdmVkLCB0\ncnVlKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgdmVyaWZ5RGlnZXN0KGxv\nbmcgZW50cnlJZCwgQ2hhbm5lbEJ1ZmZlciBkYXRhUmVjZWl2ZWQpIHRocm93\ncyBCS0RpZ2VzdE1hdGNoRXhjZXB0aW9uIHsKICAgICAgICB2ZXJpZnlEaWdl\nc3QoZW50cnlJZCwgZGF0YVJlY2VpdmVkLCBmYWxzZSk7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIHZlcmlmeURpZ2VzdChsb25nIGVudHJ5SWQsIENoYW5u\nZWxCdWZmZXIgZGF0YVJlY2VpdmVkLCBib29sZWFuIHNraXBFbnRyeUlkQ2hl\nY2spCiAgICAgICAgICAgIHRocm93cyBCS0RpZ2VzdE1hdGNoRXhjZXB0aW9u\nIHsKCiAgICAgICAgQnl0ZUJ1ZmZlciBkYXRhUmVjZWl2ZWRCdWZmZXIgPSBk\nYXRhUmVjZWl2ZWQudG9CeXRlQnVmZmVyKCk7CiAgICAgICAgYnl0ZVtdIGRp\nZ2VzdDsKCiAgICAgICAgdXBkYXRlKGRhdGFSZWNlaXZlZEJ1ZmZlci5hcnJh\neSgpLCBkYXRhUmVjZWl2ZWRCdWZmZXIucG9zaXRpb24oKSwgTUVUQURBVEFf\nTEVOR1RIKTsKCiAgICAgICAgaW50IG9mZnNldCA9IE1FVEFEQVRBX0xFTkdU\nSCArIG1hY0NvZGVMZW5ndGg7CiAgICAgICAgdXBkYXRlKGRhdGFSZWNlaXZl\nZEJ1ZmZlci5hcnJheSgpLCBkYXRhUmVjZWl2ZWRCdWZmZXIucG9zaXRpb24o\nKSArIG9mZnNldCwgZGF0YVJlY2VpdmVkLnJlYWRhYmxlQnl0ZXMoKSAtIG9m\nZnNldCk7CiAgICAgICAgZGlnZXN0ID0gZ2V0VmFsdWVBbmRSZXNldCgpOwoK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGRpZ2VzdC5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBpZiAoZGlnZXN0W2ldICE9IGRhdGFSZWNlaXZl\nZC5nZXRCeXRlKE1FVEFEQVRBX0xFTkdUSCArIGkpKSB7CiAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIk1hYyBtaXNtYXRjaCBmb3IgbGVkZ2VyLWlk\nOiAiICsgbGVkZ2VySWQgKyAiLCBlbnRyeS1pZDogIiArIGVudHJ5SWQpOwog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IEJLRGlnZXN0TWF0Y2hFeGNlcHRp\nb24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbG9uZyBh\nY3R1YWxMZWRnZXJJZCA9IGRhdGFSZWNlaXZlZC5yZWFkTG9uZygpOwogICAg\nICAgIGxvbmcgYWN0dWFsRW50cnlJZCA9IGRhdGFSZWNlaXZlZC5yZWFkTG9u\nZygpOwoKICAgICAgICBpZiAoYWN0dWFsTGVkZ2VySWQgIT0gbGVkZ2VySWQp\nIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJMZWRnZXItaWQgbWlzbWF0\nY2ggaW4gYXV0aGVudGljYXRlZCBtZXNzYWdlLCBleHBlY3RlZDogIiArIGxl\nZGdlcklkICsgIiAsIGFjdHVhbDogIgogICAgICAgICAgICAgICAgICAgICAg\nICAgKyBhY3R1YWxMZWRnZXJJZCk7CiAgICAgICAgICAgIHRocm93IG5ldyBC\nS0RpZ2VzdE1hdGNoRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBp\nZiAoIXNraXBFbnRyeUlkQ2hlY2sgJiYgYWN0dWFsRW50cnlJZCAhPSBlbnRy\neUlkKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRW50cnktaWQgbWlz\nbWF0Y2ggaW4gYXV0aGVudGljYXRlZCBtZXNzYWdlLCBleHBlY3RlZDogIiAr\nIGVudHJ5SWQgKyAiICwgYWN0dWFsOiAiCiAgICAgICAgICAgICAgICAgICAg\nICAgICArIGFjdHVhbEVudHJ5SWQpOwogICAgICAgICAgICB0aHJvdyBuZXcg\nQktEaWdlc3RNYXRjaEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICB9Cgog\nICAgLyoqCiAgICAgKiBWZXJpZnkgdGhhdCB0aGUgZGlnZXN0IG1hdGNoZXMg\nYW5kIHJldHVybnMgdGhlIGRhdGEgaW4gdGhlIGVudHJ5LgogICAgICoKICAg\nICAqIEBwYXJhbSBlbnRyeUlkCiAgICAgKiBAcGFyYW0gZGF0YVJlY2VpdmVk\nCiAgICAgKiBAcmV0dXJuCiAgICAgKiBAdGhyb3dzIEJLRGlnZXN0TWF0Y2hF\neGNlcHRpb24KICAgICAqLwogICAgQ2hhbm5lbEJ1ZmZlcklucHV0U3RyZWFt\nIHZlcmlmeURpZ2VzdEFuZFJldHVybkRhdGEobG9uZyBlbnRyeUlkLCBDaGFu\nbmVsQnVmZmVyIGRhdGFSZWNlaXZlZCkKICAgICAgICAgICAgdGhyb3dzIEJL\nRGlnZXN0TWF0Y2hFeGNlcHRpb24gewogICAgICAgIHZlcmlmeURpZ2VzdChl\nbnRyeUlkLCBkYXRhUmVjZWl2ZWQpOwogICAgICAgIGRhdGFSZWNlaXZlZC5y\nZWFkZXJJbmRleChNRVRBREFUQV9MRU5HVEggKyBtYWNDb2RlTGVuZ3RoKTsK\nICAgICAgICByZXR1cm4gbmV3IENoYW5uZWxCdWZmZXJJbnB1dFN0cmVhbShk\nYXRhUmVjZWl2ZWQpOwogICAgfQoKICAgIHN0YXRpYyBjbGFzcyBSZWNvdmVy\neURhdGEgewogICAgICAgIGxvbmcgbGFzdEFkZENvbmZpcm1lZDsKICAgICAg\nICBsb25nIGVudHJ5SWQ7CgogICAgICAgIHB1YmxpYyBSZWNvdmVyeURhdGEo\nbG9uZyBsYXN0QWRkQ29uZmlybWVkLCBsb25nIGVudHJ5SWQpIHsKICAgICAg\nICAgICAgdGhpcy5sYXN0QWRkQ29uZmlybWVkID0gbGFzdEFkZENvbmZpcm1l\nZDsKICAgICAgICAgICAgdGhpcy5lbnRyeUlkID0gZW50cnlJZDsKICAgICAg\nICB9CgogICAgfQoKICAgIFJlY292ZXJ5RGF0YSB2ZXJpZnlEaWdlc3RBbmRS\nZXR1cm5MYXN0Q29uZmlybWVkKENoYW5uZWxCdWZmZXIgZGF0YVJlY2VpdmVk\nKSB0aHJvd3MgQktEaWdlc3RNYXRjaEV4Y2VwdGlvbiB7CiAgICAgICAgdmVy\naWZ5RGlnZXN0KGRhdGFSZWNlaXZlZCk7CiAgICAgICAgZGF0YVJlY2VpdmVk\nLnJlYWRlckluZGV4KDgpOwoKICAgICAgICBsb25nIGVudHJ5SWQgPSBkYXRh\nUmVjZWl2ZWQucmVhZExvbmcoKTsKICAgICAgICBsb25nIGxhc3RBZGRDb25m\naXJtZWQgPSBkYXRhUmVjZWl2ZWQucmVhZExvbmcoKTsKICAgICAgICBsb25n\nIGxlbmd0aCA9IGRhdGFSZWNlaXZlZC5yZWFkTG9uZygpOwogICAgICAgIHJl\ndHVybiBuZXcgUmVjb3ZlcnlEYXRhKGxhc3RBZGRDb25maXJtZWQsIGVudHJ5\nSWQpOwoKICAgIH0KfQo=\n","encoding":"base64"}

