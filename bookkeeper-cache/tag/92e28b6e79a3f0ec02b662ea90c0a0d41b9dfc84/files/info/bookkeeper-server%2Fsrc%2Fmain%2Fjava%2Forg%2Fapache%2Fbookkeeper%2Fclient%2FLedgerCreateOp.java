{"sha":"31751119c5cf08cf4e9a8f48fc3cab7d3e9a1f43","node_id":"MDQ6QmxvYjE1NzU5NTY6MzE3NTExMTljNWNmMDhjZjRlOWE4ZjQ4ZmMzY2FiN2QzZTlhMWY0Mw==","size":5125,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/31751119c5cf08cf4e9a8f48fc3cab7d3e9a1f43","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0Lklu\nZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS5zZWN1cml0eS5HZW5lcmFs\nU2VjdXJpdHlFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0Nh\nbGxiYWNrLkNyZWF0ZUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbi5CS05vdEVub3VnaEJvb2tpZXNF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50\nLkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2Vu\nZXJpY0NhbGxiYWNrOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS56\nb29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56\nb29rZWVwZXIuQXN5bmNDYWxsYmFjay5TdGF0Q2FsbGJhY2s7CmltcG9ydCBv\ncmcuYXBhY2hlLnpvb2tlZXBlci5kYXRhLlN0YXQ7CgovKioKICogRW5jYXBz\ndWxhdGVzIGFzeW5jaHJvbm91cyBsZWRnZXIgY3JlYXRlIG9wZXJhdGlvbgog\nKgogKi8KY2xhc3MgTGVkZ2VyQ3JlYXRlT3AgaW1wbGVtZW50cyBHZW5lcmlj\nQ2FsbGJhY2s8U3RyaW5nPiwgU3RhdENhbGxiYWNrIHsKCiAgICBzdGF0aWMg\nZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKExl\nZGdlckNyZWF0ZU9wLmNsYXNzKTsKCiAgICBDcmVhdGVDYWxsYmFjayBjYjsK\nICAgIExlZGdlck1ldGFkYXRhIG1ldGFkYXRhOwogICAgTGVkZ2VySGFuZGxl\nIGxoOwogICAgT2JqZWN0IGN0eDsKICAgIGJ5dGVbXSBwYXNzd2Q7CiAgICBC\nb29rS2VlcGVyIGJrOwogICAgRGlnZXN0VHlwZSBkaWdlc3RUeXBlOwoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0b3IKICAgICAqCiAgICAgKiBAcGFyYW0g\nYmsKICAgICAqICAgICAgIEJvb2tLZWVwZXIgb2JqZWN0CiAgICAgKiBAcGFy\nYW0gZW5zZW1ibGVTaXplCiAgICAgKiAgICAgICBlbnNlbWJsZSBzaXplCiAg\nICAgKiBAcGFyYW0gcXVvcnVtU2l6ZQogICAgICogICAgICAgcXVvcnVtIHNp\nemUKICAgICAqIEBwYXJhbSBkaWdlc3RUeXBlCiAgICAgKiAgICAgICBkaWdl\nc3QgdHlwZSwgZWl0aGVyIE1BQyBvciBDUkMzMgogICAgICogQHBhcmFtIHBh\nc3N3ZAogICAgICogICAgICAgcGFzc293cmQKICAgICAqIEBwYXJhbSBjYgog\nICAgICogICAgICAgY2FsbGJhY2sgaW1wbGVtZW50YXRpb24KICAgICAqIEBw\nYXJhbSBjdHgKICAgICAqICAgICAgIG9wdGlvbmFsIGNvbnRyb2wgb2JqZWN0\nCiAgICAgKi8KCiAgICBMZWRnZXJDcmVhdGVPcChCb29rS2VlcGVyIGJrLCBp\nbnQgZW5zZW1ibGVTaXplLCBpbnQgcXVvcnVtU2l6ZSwgRGlnZXN0VHlwZSBk\naWdlc3RUeXBlLCBieXRlW10gcGFzc3dkLCBDcmVhdGVDYWxsYmFjayBjYiwg\nT2JqZWN0IGN0eCkgewogICAgICAgIHRoaXMuYmsgPSBiazsKICAgICAgICB0\naGlzLm1ldGFkYXRhID0gbmV3IExlZGdlck1ldGFkYXRhKGVuc2VtYmxlU2l6\nZSwgcXVvcnVtU2l6ZSk7CiAgICAgICAgdGhpcy5kaWdlc3RUeXBlID0gZGln\nZXN0VHlwZTsKICAgICAgICB0aGlzLnBhc3N3ZCA9IHBhc3N3ZDsKICAgICAg\nICB0aGlzLmNiID0gY2I7CiAgICAgICAgdGhpcy5jdHggPSBjdHg7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbml0aWF0ZXMgdGhlIG9wZXJhdGlvbgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBpbml0aWF0ZSgpIHsKICAgICAgICBiay5n\nZXRMZWRnZXJNYW5hZ2VyKCkubmV3TGVkZ2VyUGF0aCh0aGlzKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENhbGxiYWNrIHdoZW4gY3JlYXRlZCBsZWRnZXIg\ncGF0aC4KICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBv\ncGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIFN0cmluZyBsZWRnZXJQYXRoKSB7\nCgogICAgICAgIGlmIChyYyAhPSBLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5p\nbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGQgbm90\nIGNyZWF0ZSBub2RlIGZvciBsZWRnZXIiLAogICAgICAgICAgICAgICAgICAg\nICAgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29k\nZS5nZXQocmMpLCBsZWRnZXJQYXRoKSk7CiAgICAgICAgICAgIGNiLmNyZWF0\nZUNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51bGws\nIHRoaXMuY3R4KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAg\nICAgICAgLyoKICAgICAgICAgKiBFeHRyYWN0IGxlZGdlciBpZC4KICAgICAg\nICAgKi8KICAgICAgICBsb25nIGxlZGdlcklkOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGxlZGdlcklkID0gYmsuZ2V0TGVkZ2VyTWFuYWdlcigpLmdl\ndExlZGdlcklkKGxlZGdlclBhdGgpOwogICAgICAgIH0gY2F0Y2ggKElPRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJDb3VsZCBub3Qg\nZXh0cmFjdCBsZWRnZXItaWQgZnJvbSBwYXRoOiIgKyBsZWRnZXJQYXRoLCBl\nKTsKICAgICAgICAgICAgY2IuY3JlYXRlQ29tcGxldGUoQktFeGNlcHRpb24u\nQ29kZS5aS0V4Y2VwdGlvbiwgbnVsbCwgdGhpcy5jdHgpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvKgogICAgICAgICAqIEFk\nZGluZyBib29raWVzIHRvIGxlZGdlciBoYW5kbGUKICAgICAgICAgKi8KCiAg\nICAgICAgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBlbnNlbWJsZTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBlbnNlbWJsZSA9IGJrLmJvb2tp\nZVdhdGNoZXIuZ2V0TmV3Qm9va2llcyhtZXRhZGF0YS5lbnNlbWJsZVNpemUp\nOwogICAgICAgIH0gY2F0Y2ggKEJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiTm90IGVub3VnaCBib29r\naWVzIHRvIGNyZWF0ZSBsZWRnZXIiICsgbGVkZ2VySWQpOwogICAgICAgICAg\nICBjYi5jcmVhdGVDb21wbGV0ZShlLmdldENvZGUoKSwgbnVsbCwgdGhpcy5j\ndHgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAv\nKgogICAgICAgICAqIEFkZCBlbnNlbWJsZSB0byB0aGUgY29uZmlndXJhdGlv\nbgogICAgICAgICAqLwogICAgICAgIG1ldGFkYXRhLmFkZEVuc2VtYmxlKG5l\ndyBMb25nKDApLCBlbnNlbWJsZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgbGggPSBuZXcgTGVkZ2VySGFuZGxlKGJrLCBsZWRnZXJJZCwgbWV0YWRh\ndGEsIGRpZ2VzdFR5cGUsIHBhc3N3ZCk7CiAgICAgICAgfSBjYXRjaCAoR2Vu\nZXJhbFNlY3VyaXR5RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVy\ncm9yKCJTZWN1cml0eSBleGNlcHRpb24gd2hpbGUgY3JlYXRpbmcgbGVkZ2Vy\nOiAiICsgbGVkZ2VySWQsIGUpOwogICAgICAgICAgICBjYi5jcmVhdGVDb21w\nbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLkRpZ2VzdE5vdEluaXRpYWxpemVkRXhj\nZXB0aW9uLCBudWxsLCB0aGlzLmN0eCk7CiAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBMT0cuZXJyb3IoIkluY29ycmVjdGx5IGVudGVyZWQgcGFy\nYW1ldGVyIHRocm90dGxlOiAiICsgYmsuZ2V0Q29uZigpLmdldFRocm90dGxl\nVmFsdWUoKSwgZSk7CiAgICAgICAgICAgIGNiLmNyZWF0ZUNvbXBsZXRlKEJL\nRXhjZXB0aW9uLkNvZGUuSW5jb3JyZWN0UGFyYW1ldGVyRXhjZXB0aW9uLCBu\ndWxsLCB0aGlzLmN0eCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCgogICAgICAgIGxoLndyaXRlTGVkZ2VyQ29uZmlnKHRoaXMsIG51bGwpOwoK\nICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudHMgWm9vS2VlcGVyIHN0\nYXQgY2FsbGJhY2suCiAgICAgKgogICAgICogQHNlZSBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5Bc3luY0NhbGxiYWNrLlN0YXRDYWxsYmFjayNwcm9jZXNzUmVz\ndWx0KGludCwgU3RyaW5nLCBPYmplY3QsIFN0YXQpCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwg\nT2JqZWN0IGN0eCwgU3RhdCBzdGF0KSB7CiAgICAgICAgbWV0YWRhdGEuem5v\nZGVWZXJzaW9uID0gc3RhdC5nZXRWZXJzaW9uKCk7CiAgICAgICAgY2IuY3Jl\nYXRlQ29tcGxldGUocmMsIGxoLCB0aGlzLmN0eCk7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

