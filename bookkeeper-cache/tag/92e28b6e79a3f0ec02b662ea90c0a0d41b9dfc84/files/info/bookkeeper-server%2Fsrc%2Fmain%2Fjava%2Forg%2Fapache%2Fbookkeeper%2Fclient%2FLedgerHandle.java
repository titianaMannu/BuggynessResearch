{"sha":"8de20c9baa96d5c8521ac7d29586cd37011ea4d0","node_id":"MDQ6QmxvYjE1NzU5NTY6OGRlMjBjOWJhYTk2ZDVjODUyMWFjN2QyOTU4NmNkMzcwMTFlYTRkMA==","size":25859,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8de20c9baa96d5c8521ac7d29586cd37011ea4d0","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuSW5l\ndFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkdlbmVyYWxT\nZWN1cml0eUV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheURlcXVl\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRpbC5RdWV1ZTsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LlNlbWFwaG9yZTsKCmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suUmVhZExh\nc3RDb25maXJtZWRDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJh\nY2suQ2xvc2VDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuQXN5bmNDYWxsYmFjay5SZWFkQ2FsbGJhY2s7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uLkJLTm90\nRW5vdWdoQm9va2llc0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RUeXBlOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJNZXRhZGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nSW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0NhbGxiYWNrOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuU2FmZVJ1bm5hYmxlOwoKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFj\ndG9yeTsKCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5Bc3luY0NhbGxi\nYWNrLlN0YXRDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLkFzeW5jQ2FsbGJhY2suRGF0YUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNo\nZS56b29rZWVwZXIuZGF0YS5TdGF0OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5\nLmJ1ZmZlci5DaGFubmVsQnVmZmVyOwoKLyoqCiAqIExlZGdlciBoYW5kbGUg\nY29udGFpbnMgbGVkZ2VyIG1ldGFkYXRhIGFuZCBpcyB1c2VkIHRvIGFjY2Vz\ncyB0aGUgcmVhZCBhbmQKICogd3JpdGUgb3BlcmF0aW9ucyB0byBhIGxlZGdl\nci4KICovCnB1YmxpYyBjbGFzcyBMZWRnZXJIYW5kbGUgewogICAgZmluYWwg\nc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihM\nZWRnZXJIYW5kbGUuY2xhc3MpOwogICAgZmluYWwgc3RhdGljIGxvbmcgTEFT\nVF9BRERfQ09ORklSTUVEID0gLTE7CgogICAgZmluYWwgYnl0ZVtdIGxlZGdl\ncktleTsKICAgIExlZGdlck1ldGFkYXRhIG1ldGFkYXRhOwogICAgZmluYWwg\nQm9va0tlZXBlciBiazsKICAgIGZpbmFsIGxvbmcgbGVkZ2VySWQ7CiAgICBs\nb25nIGxhc3RBZGRQdXNoZWQ7CiAgICBsb25nIGxhc3RBZGRDb25maXJtZWQ7\nCiAgICBsb25nIGxlbmd0aDsKICAgIGZpbmFsIERpZ2VzdE1hbmFnZXIgbWFj\nTWFuYWdlcjsKICAgIGZpbmFsIERpc3RyaWJ1dGlvblNjaGVkdWxlIGRpc3Ry\naWJ1dGlvblNjaGVkdWxlOwoKICAgIGZpbmFsIFNlbWFwaG9yZSBvcENvdW50\nZXJTZW07CiAgICBwcml2YXRlIGZpbmFsIEludGVnZXIgdGhyb3R0bGluZzsK\nCiAgICBmaW5hbCBRdWV1ZTxQZW5kaW5nQWRkT3A+IHBlbmRpbmdBZGRPcHMg\nPSBuZXcgQXJyYXlEZXF1ZTxQZW5kaW5nQWRkT3A+KCk7CgogICAgTGVkZ2Vy\nSGFuZGxlKEJvb2tLZWVwZXIgYmssIGxvbmcgbGVkZ2VySWQsIExlZGdlck1l\ndGFkYXRhIG1ldGFkYXRhLAogICAgICAgICAgICAgICAgIERpZ2VzdFR5cGUg\nZGlnZXN0VHlwZSwgYnl0ZVtdIHBhc3N3b3JkKQogICAgICAgICAgICB0aHJv\nd3MgR2VuZXJhbFNlY3VyaXR5RXhjZXB0aW9uLCBOdW1iZXJGb3JtYXRFeGNl\ncHRpb24gewogICAgICAgIHRoaXMuYmsgPSBiazsKICAgICAgICB0aGlzLm1l\ndGFkYXRhID0gbWV0YWRhdGE7CgogICAgICAgIGlmIChtZXRhZGF0YS5pc0Ns\nb3NlZCgpKSB7CiAgICAgICAgICAgIGxhc3RBZGRDb25maXJtZWQgPSBsYXN0\nQWRkUHVzaGVkID0gbWV0YWRhdGEuY2xvc2U7CiAgICAgICAgICAgIGxlbmd0\naCA9IG1ldGFkYXRhLmxlbmd0aDsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICBsYXN0QWRkQ29uZmlybWVkID0gbGFzdEFkZFB1c2hlZCA9IC0xOwog\nICAgICAgICAgICBsZW5ndGggPSAwOwogICAgICAgIH0KCiAgICAgICAgdGhp\ncy5sZWRnZXJJZCA9IGxlZGdlcklkOwoKICAgICAgICB0aGlzLnRocm90dGxp\nbmcgPSBiay5nZXRDb25mKCkuZ2V0VGhyb3R0bGVWYWx1ZSgpOwogICAgICAg\nIHRoaXMub3BDb3VudGVyU2VtID0gbmV3IFNlbWFwaG9yZSh0aHJvdHRsaW5n\nKTsKCiAgICAgICAgbWFjTWFuYWdlciA9IERpZ2VzdE1hbmFnZXIuaW5zdGFu\ndGlhdGUobGVkZ2VySWQsIHBhc3N3b3JkLCBkaWdlc3RUeXBlKTsKICAgICAg\nICB0aGlzLmxlZGdlcktleSA9IE1hY0RpZ2VzdE1hbmFnZXIuZ2VuRGlnZXN0\nKCJsZWRnZXIiLCBwYXNzd29yZCk7CiAgICAgICAgZGlzdHJpYnV0aW9uU2No\nZWR1bGUgPSBuZXcgUm91bmRSb2JpbkRpc3RyaWJ1dGlvblNjaGVkdWxlKAog\nICAgICAgICAgICBtZXRhZGF0YS5xdW9ydW1TaXplLCBtZXRhZGF0YS5lbnNl\nbWJsZVNpemUpOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRoZSBpZCBv\nZiB0aGUgY3VycmVudCBsZWRnZXIKICAgICAqCiAgICAgKiBAcmV0dXJuIHRo\nZSBpZCBvZiB0aGUgbGVkZ2VyCiAgICAgKi8KICAgIHB1YmxpYyBsb25nIGdl\ndElkKCkgewogICAgICAgIHJldHVybiBsZWRnZXJJZDsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdldCB0aGUgbGFzdCBjb25maXJtZWQgZW50cnkgaWQgb24g\ndGhpcyBsZWRnZXIKICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBsYXN0IGNv\nbmZpcm1lZCBlbnRyeSBpZAogICAgICovCiAgICBwdWJsaWMgbG9uZyBnZXRM\nYXN0QWRkQ29uZmlybWVkKCkgewogICAgICAgIHJldHVybiBsYXN0QWRkQ29u\nZmlybWVkOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRoZSBlbnRyeSBp\nZCBvZiB0aGUgbGFzdCBlbnRyeSB0aGF0IGhhcyBiZWVuIGVucXVldWVkIGZv\nciBhZGRpdGlvbiAoYnV0CiAgICAgKiBtYXkgbm90IGhhdmUgcG9zc2libHkg\nYmVlbiBwZXJzaXRlZCB0byB0aGUgbGVkZ2VyKQogICAgICoKICAgICAqIEBy\nZXR1cm4gdGhlIGlkIG9mIHRoZSBsYXN0IGVudHJ5IHB1c2hlZAogICAgICov\nCiAgICBwdWJsaWMgbG9uZyBnZXRMYXN0QWRkUHVzaGVkKCkgewogICAgICAg\nIHJldHVybiBsYXN0QWRkUHVzaGVkOwogICAgfQoKICAgIC8qKgogICAgICog\nR2V0IHRoZSBMZWRnZXIncyBrZXkvcGFzc3dvcmQuCiAgICAgKgogICAgICog\nQHJldHVybiBieXRlIGFycmF5IGZvciB0aGUgbGVkZ2VyJ3Mga2V5L3Bhc3N3\nb3JkLgogICAgICovCiAgICBwdWJsaWMgYnl0ZVtdIGdldExlZGdlcktleSgp\nIHsKICAgICAgICByZXR1cm4gbGVkZ2VyS2V5OwogICAgfQoKICAgIC8qKgog\nICAgICogR2V0IHRoZSBMZWRnZXJNZXRhZGF0YQogICAgICoKICAgICAqIEBy\nZXR1cm4gTGVkZ2VyTWV0YWRhdGEgZm9yIHRoZSBMZWRnZXJIYW5kbGUKICAg\nICAqLwogICAgTGVkZ2VyTWV0YWRhdGEgZ2V0TGVkZ2VyTWV0YWRhdGEoKSB7\nCiAgICAgICAgcmV0dXJuIG1ldGFkYXRhOwogICAgfQoKICAgIC8qKgogICAg\nICogR2V0IHRoZSBEaWdlc3RNYW5hZ2VyCiAgICAgKgogICAgICogQHJldHVy\nbiBEaWdlc3RNYW5hZ2VyIGZvciB0aGUgTGVkZ2VySGFuZGxlCiAgICAgKi8K\nICAgIERpZ2VzdE1hbmFnZXIgZ2V0RGlnZXN0TWFuYWdlcigpIHsKICAgICAg\nICByZXR1cm4gbWFjTWFuYWdlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0b3RhbCBudW1iZXIgb2YgYXZhaWxhYmxlIHNsb3RzLgogICAgICoK\nICAgICAqIEByZXR1cm4gaW50ICAgIGF2YWlsYWJsZSBzbG90cwogICAgICov\nCiAgICBTZW1hcGhvcmUgZ2V0QXZhaWxhYmxlUGVybWl0cygpIHsKICAgICAg\nICByZXR1cm4gdGhpcy5vcENvdW50ZXJTZW07CiAgICB9CgogICAgLyoqCiAg\nICAgKiAgQWRkIHRvIHRoZSBsZW5ndGggb2YgdGhlIGxlZGdlciBpbiBieXRl\ncy4KICAgICAqCiAgICAgKiBAcGFyYW0gZGVsdGEKICAgICAqIEByZXR1cm4K\nICAgICAqLwogICAgbG9uZyBhZGRUb0xlbmd0aChsb25nIGRlbHRhKSB7CiAg\nICAgICAgdGhpcy5sZW5ndGggKz0gZGVsdGE7CiAgICAgICAgcmV0dXJuIHRo\naXMubGVuZ3RoOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUg\nbGVuZ3RoIG9mIHRoZSBsZWRnZXIgaW4gYnl0ZXMuCiAgICAgKgogICAgICog\nQHJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBsZWRnZXIgaW4gYnl0ZXMKICAg\nICAqLwogICAgcHVibGljIGxvbmcgZ2V0TGVuZ3RoKCkgewogICAgICAgIHJl\ndHVybiB0aGlzLmxlbmd0aDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCB0\naGUgRGlzdHJpYnV0aW9uIFNjaGVkdWxlCiAgICAgKgogICAgICogQHJldHVy\nbiBEaXN0cmlidXRpb25TY2hlZHVsZSBmb3IgdGhlIExlZGdlckhhbmRsZQog\nICAgICovCiAgICBEaXN0cmlidXRpb25TY2hlZHVsZSBnZXREaXN0cmlidXRp\nb25TY2hlZHVsZSgpIHsKICAgICAgICByZXR1cm4gZGlzdHJpYnV0aW9uU2No\nZWR1bGU7CiAgICB9CgogICAgdm9pZCB3cml0ZUxlZGdlckNvbmZpZyhTdGF0\nQ2FsbGJhY2sgY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICBpZiAo\nTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgTE9HLmRlYnVn\nKCJXcml0aW5nIG1ldGFkYXRhIHRvIFpvb0tlZXBlcjogIiArIHRoaXMubGVk\nZ2VySWQgKyAiLCAiICsgbWV0YWRhdGEuZ2V0Wm5vZGVWZXJzaW9uKCkpOwog\nICAgICAgIH0KCiAgICAgICAgYmsuZ2V0WmtIYW5kbGUoKS5zZXREYXRhKGJr\nLmdldExlZGdlck1hbmFnZXIoKS5nZXRMZWRnZXJQYXRoKGxlZGdlcklkKSwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEuc2Vy\naWFsaXplKCksIG1ldGFkYXRhLmdldFpub2RlVmVyc2lvbigpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaywgY3R4KTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENsb3NlIHRoaXMgbGVkZ2VyIHN5bmNocm9u\nb3VzbHkuCiAgICAgKiBAc2VlICNhc3luY0Nsb3NlCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIGNsb3NlKCkgCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAgIFN5bmNDb3Vu\ndGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAgICBjb3Vu\ndGVyLmluYygpOwoKICAgICAgICBhc3luY0Nsb3NlKG5ldyBTeW5jQ2xvc2VD\nYWxsYmFjaygpLCBjb3VudGVyKTsKCiAgICAgICAgY291bnRlci5ibG9jaygw\nKTsKICAgICAgICBpZiAoY291bnRlci5nZXRyYygpICE9IEJLRXhjZXB0aW9u\nLkNvZGUuT0spIHsKICAgICAgICAgICAgdGhyb3cgQktFeGNlcHRpb24uY3Jl\nYXRlKGNvdW50ZXIuZ2V0cmMoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQXN5bmNocm9ub3VzIGNsb3NlLCBhbnkgYWRkcyBpbiBmbGln\naHQgd2lsbCByZXR1cm4gZXJyb3JzLgogICAgICogCiAgICAgKiBDbG9zaW5n\nIGEgbGVkZ2VyIHdpbGwgZW5zdXJlIHRoYXQgYWxsIGNsaWVudHMgYWdyZWUg\nb24gd2hhdCB0aGUgbGFzdCBlbnRyeSAKICAgICAqIG9mIHRoZSBsZWRnZXIg\naXMuIFRoaXMgZW5zdXJlcyB0aGF0LCBvbmNlIHRoZSBsZWRnZXIgaGFzIGJl\nZW4gY2xvc2VkLCBhbGwgCiAgICAgKiByZWFkcyBmcm9tIHRoZSBsZWRnZXIg\nd2lsbCByZXR1cm4gdGhlIHNhbWUgc2V0IG9mIGVudHJpZXMuIAogICAgICog\nCiAgICAgKiBAcGFyYW0gY2IKICAgICAqICAgICAgICAgIGNhbGxiYWNrIGlt\ncGxlbWVudGF0aW9uCiAgICAgKiBAcGFyYW0gY3R4CiAgICAgKiAgICAgICAg\nICBjb250cm9sIG9iamVjdAogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgdm9pZCBhc3luY0Nsb3NlKENs\nb3NlQ2FsbGJhY2sgY2IsIE9iamVjdCBjdHgpIHsKICAgICAgICBhc3luY0Ns\nb3NlSW50ZXJuYWwoY2IsIGN0eCwgQktFeGNlcHRpb24uQ29kZS5MZWRnZXJD\nbG9zZWRFeGNlcHRpb24pOwogICAgfQoKICAgIC8qKgogICAgICogU2FtZSBh\ncyBwdWJsaWMgdmVyc2lvbiBvZiBhc3luY0Nsb3NlIGV4Y2VwdCB0aGF0IHRo\naXMgb25lIHRha2VzIGFuCiAgICAgKiBhZGRpdGlvbmFsIHBhcmFtZXRlciB3\naGljaCBpcyB0aGUgcmV0dXJuIGNvZGUgdG8gaGFuZCB0byBhbGwgdGhlIHBl\nbmRpbmcKICAgICAqIGFkZCBvcHMKICAgICAqCiAgICAgKiBAcGFyYW0gY2IK\nICAgICAqIEBwYXJhbSBjdHgKICAgICAqIEBwYXJhbSByYwogICAgICovCiAg\nICB2b2lkIGFzeW5jQ2xvc2VJbnRlcm5hbChmaW5hbCBDbG9zZUNhbGxiYWNr\nIGNiLCBmaW5hbCBPYmplY3QgY3R4LCBmaW5hbCBpbnQgcmMpIHsKIAogICAg\nICAgIGJrLm1haW5Xb3JrZXJQb29sLnN1Ym1pdE9yZGVyZWQobGVkZ2VySWQs\nIG5ldyBTYWZlUnVubmFibGUoKSB7CgogICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVJ1bigpIHsKICAgICAgICAg\nICAgICAgIG1ldGFkYXRhLmxlbmd0aCA9IGxlbmd0aDsKICAgICAgICAgICAg\nICAgIC8vIENsb3NlIG9wZXJhdGlvbiBpcyBpZGVtcG90ZW50LCBzbyBubyBu\nZWVkIHRvIGNoZWNrIGlmIHdlIGFyZQogICAgICAgICAgICAgICAgLy8gYWxy\nZWFkeSBjbG9zZWQKCiAgICAgICAgICAgICAgICBtZXRhZGF0YS5jbG9zZShs\nYXN0QWRkQ29uZmlybWVkKTsKICAgICAgICAgICAgICAgIGVycm9yT3V0UGVu\nZGluZ0FkZHMocmMpOwogICAgICAgICAgICAgICAgbGFzdEFkZFB1c2hlZCA9\nIGxhc3RBZGRDb25maXJtZWQ7CgogICAgICAgICAgICAgICAgaWYgKExPRy5p\nc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmRl\nYnVnKCJDbG9zaW5nIGxlZGdlcjogIiArIGxlZGdlcklkICsgIiBhdCBlbnRy\neUlkOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgbWV0YWRh\ndGEuY2xvc2UgKyAiIHdpdGggdGhpcyBtYW55IGJ5dGVzOiAiICsgbWV0YWRh\ndGEubGVuZ3RoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAg\nICB3cml0ZUxlZGdlckNvbmZpZyhuZXcgU3RhdENhbGxiYWNrKCkgewogICAg\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0\naCwgT2JqZWN0IHN1YmN0eCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIFN0YXQgc3RhdCkgewogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0su\naW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9H\nLndhcm4oIkNvbmRpdGlvbmFsIHdyaXRlIGZhaWxlZDogIiArIEtlZXBlckV4\nY2VwdGlvbi5Db2RlLmdldChyYykpOwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgY2IuY2xvc2VDb21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLlpLRXhj\nZXB0aW9uLCBMZWRnZXJIYW5kbGUudGhpcywKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIG1ldGFkYXRhLnVwZGF0ZVpub2RlU3RhdHVzKHN0YXQpOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgY2IuY2xvc2VDb21wbGV0ZShCS0V4Y2Vw\ndGlvbi5Db2RlLk9LLCBMZWRnZXJIYW5kbGUudGhpcywgY3R4KTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0sIG51bGwpOwoKICAgICAgICAgICAgfQogICAgICAg\nIH0pOwogICAgfQoKICAgIC8qKgogICAgICogUmVhZCBhIHNlcXVlbmNlIG9m\nIGVudHJpZXMgc3luY2hyb25vdXNseS4KICAgICAqCiAgICAgKiBAcGFyYW0g\nZmlyc3RFbnRyeQogICAgICogICAgICAgICAgaWQgb2YgZmlyc3QgZW50cnkg\nb2Ygc2VxdWVuY2UgKGluY2x1ZGVkKQogICAgICogQHBhcmFtIGxhc3RFbnRy\neQogICAgICogICAgICAgICAgaWQgb2YgbGFzdCBlbnRyeSBvZiBzZXF1ZW5j\nZSAoaW5jbHVkZWQpCiAgICAgKgogICAgICovCiAgICBwdWJsaWMgRW51bWVy\nYXRpb248TGVkZ2VyRW50cnk+IHJlYWRFbnRyaWVzKGxvbmcgZmlyc3RFbnRy\neSwgbG9uZyBsYXN0RW50cnkpCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAgIFN5bmNDb3Vu\ndGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAgICBjb3Vu\ndGVyLmluYygpOwoKICAgICAgICBhc3luY1JlYWRFbnRyaWVzKGZpcnN0RW50\ncnksIGxhc3RFbnRyeSwgbmV3IFN5bmNSZWFkQ2FsbGJhY2soKSwgY291bnRl\ncik7CgogICAgICAgIGNvdW50ZXIuYmxvY2soMCk7CiAgICAgICAgaWYgKGNv\ndW50ZXIuZ2V0cmMoKSAhPSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAg\nICAgICAgIHRocm93IEJLRXhjZXB0aW9uLmNyZWF0ZShjb3VudGVyLmdldHJj\nKCkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNvdW50ZXIuZ2V0U2Vx\ndWVuY2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlYWQgYSBzZXF1ZW5j\nZSBvZiBlbnRyaWVzIGFzeW5jaHJvbm91c2x5LgogICAgICoKICAgICAqIEBw\nYXJhbSBmaXJzdEVudHJ5CiAgICAgKiAgICAgICAgICBpZCBvZiBmaXJzdCBl\nbnRyeSBvZiBzZXF1ZW5jZQogICAgICogQHBhcmFtIGxhc3RFbnRyeQogICAg\nICogICAgICAgICAgaWQgb2YgbGFzdCBlbnRyeSBvZiBzZXF1ZW5jZQogICAg\nICogQHBhcmFtIGNiCiAgICAgKiAgICAgICAgICBvYmplY3QgaW1wbGVtZW50\naW5nIHJlYWQgY2FsbGJhY2sgaW50ZXJmYWNlCiAgICAgKiBAcGFyYW0gY3R4\nCiAgICAgKiAgICAgICAgICBjb250cm9sIG9iamVjdAogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBhc3luY1JlYWRFbnRyaWVzKGxvbmcgZmlyc3RFbnRyeSwg\nbG9uZyBsYXN0RW50cnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIFJlYWRDYWxsYmFjayBjYiwgT2JqZWN0IGN0eCkgewogICAgICAgIC8v\nIExpdHRsZSBzYW5pdHkgY2hlY2sKICAgICAgICBpZiAoZmlyc3RFbnRyeSA8\nIDAgfHwgbGFzdEVudHJ5ID4gbGFzdEFkZENvbmZpcm1lZAogICAgICAgICAg\nICAgICAgfHwgZmlyc3RFbnRyeSA+IGxhc3RFbnRyeSkgewogICAgICAgICAg\nICBjYi5yZWFkQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5SZWFkRXhjZXB0\naW9uLCB0aGlzLCBudWxsLCBjdHgpOwogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgICBuZXcgUGVuZGlu\nZ1JlYWRPcCh0aGlzLCBmaXJzdEVudHJ5LCBsYXN0RW50cnksIGNiLCBjdHgp\nLmluaXRpYXRlKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBjYi5yZWFkQ29tcGxldGUoQktFeGNl\ncHRpb24uQ29kZS5JbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgdGhpcywgbnVsbCwg\nY3R4KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgZW50\ncnkgc3luY2hyb25vdXNseSB0byBhbiBvcGVuIGxlZGdlci4KICAgICAqCiAg\nICAgKiBAcGFyYW0gZGF0YQogICAgICogICAgICAgICBhcnJheSBvZiBieXRl\ncyB0byBiZSB3cml0dGVuIHRvIHRoZSBsZWRnZXIKICAgICAqLwogICAgcHVi\nbGljIHZvaWQgYWRkRW50cnkoYnl0ZVtdIGRhdGEpIHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAgIGFkZEVudHJ5\nKGRhdGEsIDAsIGRhdGEubGVuZ3RoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFkZCBlbnRyeSBzeW5jaHJvbm91c2x5IHRvIGFuIG9wZW4gbGVkZ2VyLgog\nICAgICoKICAgICAqIEBwYXJhbSBkYXRhCiAgICAgKiAgICAgICAgIGFycmF5\nIG9mIGJ5dGVzIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIGxlZGdlcgogICAgICog\nQHBhcmFtIG9mZnNldAogICAgICogICAgICAgICAgb2Zmc2V0IGZyb20gd2hp\nY2ggdG8gdGFrZSBieXRlcyBmcm9tIGRhdGEKICAgICAqIEBwYXJhbSBsZW5n\ndGgKICAgICAqICAgICAgICAgIG51bWJlciBvZiBieXRlcyB0byB0YWtlIGZy\nb20gZGF0YQogICAgICovCiAgICBwdWJsaWMgdm9pZCBhZGRFbnRyeShieXRl\nW10gZGF0YSwgaW50IG9mZnNldCwgaW50IGxlbmd0aCkKICAgICAgICAgICAg\ndGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAg\nICAgICAgTE9HLmRlYnVnKCJBZGRpbmcgZW50cnkgIiArIGRhdGEpOwogICAg\nICAgIFN5bmNDb3VudGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsK\nICAgICAgICBjb3VudGVyLmluYygpOwoKICAgICAgICBhc3luY0FkZEVudHJ5\nKGRhdGEsIG9mZnNldCwgbGVuZ3RoLCBuZXcgU3luY0FkZENhbGxiYWNrKCks\nIGNvdW50ZXIpOwogICAgICAgIGNvdW50ZXIuYmxvY2soMCk7CiAgICAgICAg\nCiAgICAgICAgaWYgKGNvdW50ZXIuZ2V0cmMoKSAhPSBCS0V4Y2VwdGlvbi5D\nb2RlLk9LKSB7CiAgICAgICAgICAgIHRocm93IEJLRXhjZXB0aW9uLmNyZWF0\nZShjb3VudGVyLmdldHJjKCkpOwogICAgICAgIH0KCiAgICAgICAgaWYoY291\nbnRlci5nZXRyYygpICE9IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAg\nICAgICAgdGhyb3cgQktFeGNlcHRpb24uY3JlYXRlKGNvdW50ZXIuZ2V0cmMo\nKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkIGVudHJ5\nIGFzeW5jaHJvbm91c2x5IHRvIGFuIG9wZW4gbGVkZ2VyLgogICAgICoKICAg\nICAqIEBwYXJhbSBkYXRhCiAgICAgKiAgICAgICAgICBhcnJheSBvZiBieXRl\ncyB0byBiZSB3cml0dGVuCiAgICAgKiBAcGFyYW0gY2IKICAgICAqICAgICAg\nICAgIG9iamVjdCBpbXBsZW1lbnRpbmcgY2FsbGJhY2tpbnRlcmZhY2UKICAg\nICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgIHNvbWUgY29udHJvbCBv\nYmplY3QKICAgICAqLwogICAgcHVibGljIHZvaWQgYXN5bmNBZGRFbnRyeShm\naW5hbCBieXRlW10gZGF0YSwgZmluYWwgQWRkQ2FsbGJhY2sgY2IsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIE9iamVjdCBjdHgpIHsK\nICAgICAgICBhc3luY0FkZEVudHJ5KGRhdGEsIDAsIGRhdGEubGVuZ3RoLCBj\nYiwgY3R4KTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBlbnRyeSBhc3lu\nY2hyb25vdXNseSB0byBhbiBvcGVuIGxlZGdlciwgdXNpbmcgYW4gb2Zmc2V0\nIGFuZCByYW5nZS4KICAgICAqCiAgICAgKiBAcGFyYW0gZGF0YQogICAgICog\nICAgICAgICAgYXJyYXkgb2YgYnl0ZXMgdG8gYmUgd3JpdHRlbgogICAgICog\nQHBhcmFtIG9mZnNldAogICAgICogICAgICAgICAgb2Zmc2V0IGZyb20gd2hp\nY2ggdG8gdGFrZSBieXRlcyBmcm9tIGRhdGEKICAgICAqIEBwYXJhbSBsZW5n\ndGgKICAgICAqICAgICAgICAgIG51bWJlciBvZiBieXRlcyB0byB0YWtlIGZy\nb20gZGF0YQogICAgICogQHBhcmFtIGNiCiAgICAgKiAgICAgICAgICBvYmpl\nY3QgaW1wbGVtZW50aW5nIGNhbGxiYWNraW50ZXJmYWNlCiAgICAgKiBAcGFy\nYW0gY3R4CiAgICAgKiAgICAgICAgICBzb21lIGNvbnRyb2wgb2JqZWN0CiAg\nICAgKiBAdGhyb3dzIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiBp\nZiBvZmZzZXQgb3IgbGVuZ3RoIGlzIG5lZ2F0aXZlIG9yCiAgICAgKiAgICAg\nICAgICBvZmZzZXQgYW5kIGxlbmd0aCBzdW0gdG8gYSB2YWx1ZSBoaWdoZXIg\ndGhhbiB0aGUgbGVuZ3RoIG9mIGRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGFzeW5jQWRkRW50cnkoZmluYWwgYnl0ZVtdIGRhdGEsIGZpbmFsIGlu\ndCBvZmZzZXQsIGZpbmFsIGludCBsZW5ndGgsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGZpbmFsIEFkZENhbGxiYWNrIGNiLCBmaW5hbCBPYmpl\nY3QgY3R4KSB7CiAgICAgICAgUGVuZGluZ0FkZE9wIG9wID0gbmV3IFBlbmRp\nbmdBZGRPcChMZWRnZXJIYW5kbGUudGhpcywgY2IsIGN0eCk7CiAgICAgICAg\nZG9Bc3luY0FkZEVudHJ5KG9wLCBkYXRhLCBvZmZzZXQsIGxlbmd0aCwgY2Is\nIGN0eCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYWtlIGEgcmVjb3Zlcnkg\nYWRkIGVudHJ5IHJlcXVlc3QuIFJlY292ZXJ5IGFkZHMgY2FuIGFkZCB0byBh\nIGxlZGdlciBldmVuIGlmCiAgICAgKiBpdCBoYXMgYmVlbiBmZW5jZWQuCiAg\nICAgKgogICAgICogVGhpcyBpcyBvbmx5IHZhbGlkIGZvciBib29raWUgYW5k\nIGxlZGdlciByZWNvdmVyeSwgd2hpY2ggbWF5IG5lZWQgdG8gcmVwbGljYXRl\nCiAgICAgKiBlbnRyaWVzIHRvIGEgcXVvcnVtIG9mIGJvb2tpZXMgdG8gZW5z\ndXJlIGRhdGEgc2FmZXR5LgogICAgICoKICAgICAqIE5vcm1hbCBjbGllbnQg\nc2hvdWxkIG5ldmVyIGNhbGwgdGhpcyBtZXRob2QuCiAgICAgKi8KICAgIHZv\naWQgYXN5bmNSZWNvdmVyeUFkZEVudHJ5KGZpbmFsIGJ5dGVbXSBkYXRhLCBm\naW5hbCBpbnQgb2Zmc2V0LCBmaW5hbCBpbnQgbGVuZ3RoLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgZmluYWwgQWRkQ2FsbGJhY2sgY2IsIGZp\nbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICBQZW5kaW5nQWRkT3Agb3AgPSBu\nZXcgUGVuZGluZ0FkZE9wKExlZGdlckhhbmRsZS50aGlzLCBjYiwgY3R4KS5l\nbmFibGVSZWNvdmVyeUFkZCgpOwogICAgICAgIGRvQXN5bmNBZGRFbnRyeShv\ncCwgZGF0YSwgb2Zmc2V0LCBsZW5ndGgsIGNiLCBjdHgpOwogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCBkb0FzeW5jQWRkRW50cnkoZmluYWwgUGVuZGluZ0Fk\nZE9wIG9wLCBmaW5hbCBieXRlW10gZGF0YSwgZmluYWwgaW50IG9mZnNldCwg\nZmluYWwgaW50IGxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgZmluYWwgQWRkQ2FsbGJhY2sgY2IsIGZpbmFsIE9iamVjdCBjdHgp\nIHsKICAgICAgICBpZiAob2Zmc2V0IDwgMCB8fCBsZW5ndGggPCAwCiAgICAg\nICAgICAgICAgICB8fCAob2Zmc2V0ICsgbGVuZ3RoKSA+IGRhdGEubGVuZ3Ro\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3Vu\nZHNFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAiSW52YWxpZCB2YWx1ZXMg\nZm9yIG9mZnNldCgiK29mZnNldAogICAgICAgICAgICAgICAgKyIpIG9yIGxl\nbmd0aCgiK2xlbmd0aCsiKSIpOwogICAgICAgIH0KICAgICAgICB0cnkgewog\nICAgICAgICAgICBvcENvdW50ZXJTZW0uYWNxdWlyZSgpOwogICAgICAgIH0g\nY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nY2IuYWRkQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5JbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgTGVkZ2VySGFu\nZGxlLnRoaXMsIC0xLCBjdHgpOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgYmsubWFpbldvcmtlclBvb2wuc3VibWl0T3JkZXJlZChs\nZWRnZXJJZCwgbmV3IFNhZmVSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVJ1\nbigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEuaXNDbG9z\nZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cud2FybigiQXR0\nZW1wdCB0byBhZGQgdG8gY2xvc2VkIGxlZGdlcjogIiArIGxlZGdlcklkKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgTGVkZ2VySGFuZGxlLnRoaXMub3BD\nb3VudGVyU2VtLnJlbGVhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nY2IuYWRkQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5MZWRnZXJDbG9zZWRF\neGNlcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIExlZGdlckhhbmRsZS50aGlzLCAtMSwgY3R4KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICAgICAgbG9uZyBlbnRyeUlkID0gKytsYXN0QWRkUHVz\naGVkOwogICAgICAgICAgICAgICAgICAgIGxvbmcgY3VycmVudExlbmd0aCA9\nIGFkZFRvTGVuZ3RoKGxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgb3Au\nc2V0RW50cnlJZChlbnRyeUlkKTsKICAgICAgICAgICAgICAgICAgICBwZW5k\naW5nQWRkT3BzLmFkZChvcCk7CiAgICAgICAgICAgICAgICAgICAgQ2hhbm5l\nbEJ1ZmZlciB0b1NlbmQgPSBtYWNNYW5hZ2VyLmNvbXB1dGVEaWdlc3RBbmRQ\nYWNrYWdlRm9yU2VuZGluZygKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBlbnRyeUlkLCBsYXN0QWRkQ29uZmlybWVk\nLCBjdXJyZW50TGVuZ3RoLCBkYXRhLCBvZmZzZXQsIGxlbmd0aCk7CiAgICAg\nICAgICAgICAgICAgICAgb3AuaW5pdGlhdGUodG9TZW5kKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoUnVu\ndGltZUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIG9wQ291bnRlclNlbS5y\nZWxlYXNlKCk7CiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogT2J0YWlucyBsYXN0IGNvbmZpcm1lZCB3cml0\nZSBmcm9tIGEgcXVvcnVtIG9mIGJvb2tpZXMuCiAgICAgKgogICAgICogQHBh\ncmFtIGNiCiAgICAgKiBAcGFyYW0gY3R4CiAgICAgKi8KCiAgICBwdWJsaWMg\ndm9pZCBhc3luY1JlYWRMYXN0Q29uZmlybWVkKFJlYWRMYXN0Q29uZmlybWVk\nQ2FsbGJhY2sgY2IsIE9iamVjdCBjdHgpIHsKICAgICAgICBuZXcgUmVhZExh\nc3RDb25maXJtZWRPcCh0aGlzLCBjYiwgY3R4KS5pbml0aWF0ZSgpOwogICAg\nfQoKCiAgICAvKioKICAgICAqIENvbnRleHQgb2JqZWN0cyBmb3Igc3luY2hy\nb25vdXMgY2FsbCB0byByZWFkIGxhc3QgY29uZmlybWVkLgogICAgICovCiAg\nICBjbGFzcyBMYXN0Q29uZmlybWVkQ3R4IHsKICAgICAgICBsb25nIHJlc3Bv\nbnNlOwogICAgICAgIGludCByYzsKCiAgICAgICAgTGFzdENvbmZpcm1lZEN0\neCgpIHsKICAgICAgICAgICAgdGhpcy5yZXNwb25zZSA9IC0xOwogICAgICAg\nIH0KCiAgICAgICAgdm9pZCBzZXRMYXN0Q29uZmlybWVkKGxvbmcgbGFzdENv\nbmZpcm1lZCkgewogICAgICAgICAgICB0aGlzLnJlc3BvbnNlID0gbGFzdENv\nbmZpcm1lZDsKICAgICAgICB9CgogICAgICAgIGxvbmcgZ2V0bGFzdENvbmZp\ncm1lZCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzcG9uc2U7CiAg\nICAgICAgfQoKICAgICAgICB2b2lkIHNldFJDKGludCByYykgewogICAgICAg\nICAgICB0aGlzLnJjID0gcmM7CiAgICAgICAgfQoKICAgICAgICBpbnQgZ2V0\nUkMoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnJjOwogICAgICAgIH0K\nCiAgICAgICAgYm9vbGVhbiByZWFkeSgpIHsKICAgICAgICAgICAgcmV0dXJu\nICh0aGlzLnJlc3BvbnNlICE9IC0xKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIGxvbmcgcmVhZExhc3RDb25maXJtZWQoKQogICAgICAgICAgICB0\naHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24sIEJLRXhjZXB0aW9uIHsKICAg\nICAgICBMYXN0Q29uZmlybWVkQ3R4IGN0eCA9IG5ldyBMYXN0Q29uZmlybWVk\nQ3R4KCk7CiAgICAgICAgYXN5bmNSZWFkTGFzdENvbmZpcm1lZChuZXcgU3lu\nY1JlYWRMYXN0Q29uZmlybWVkQ2FsbGJhY2soKSwgY3R4KTsKICAgICAgICBz\neW5jaHJvbml6ZWQoY3R4KSB7CiAgICAgICAgICAgIHdoaWxlKCFjdHgucmVh\nZHkoKSkgewogICAgICAgICAgICAgICAgY3R4LndhaXQoKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgaWYoY3R4LmdldFJDKCkgIT0gQktF\neGNlcHRpb24uQ29kZS5PSykgdGhyb3cgQktFeGNlcHRpb24uY3JlYXRlKGN0\neC5nZXRSQygpKTsKICAgICAgICByZXR1cm4gY3R4LmdldGxhc3RDb25maXJt\nZWQoKTsKICAgIH0KCiAgICAvLyBjbG9zZSB0aGUgbGVkZ2VyIGFuZCBzZW5k\nIGZhaWxzIHRvIGFsbCB0aGUgYWRkcyBpbiB0aGUgcGlwZWxpbmUKICAgIHZv\naWQgaGFuZGxlVW5yZWNvdmVyYWJsZUVycm9yRHVyaW5nQWRkKGludCByYykg\newogICAgICAgIGFzeW5jQ2xvc2VJbnRlcm5hbChOb29wQ2xvc2VDYWxsYmFj\nay5pbnN0YW5jZSwgbnVsbCwgcmMpOwogICAgfQoKICAgIHZvaWQgZXJyb3JP\ndXRQZW5kaW5nQWRkcyhpbnQgcmMpIHsKICAgICAgICBQZW5kaW5nQWRkT3Ag\ncGVuZGluZ0FkZE9wOwogICAgICAgIHdoaWxlICgocGVuZGluZ0FkZE9wID0g\ncGVuZGluZ0FkZE9wcy5wb2xsKCkpICE9IG51bGwpIHsKICAgICAgICAgICAg\ncGVuZGluZ0FkZE9wLnN1Ym1pdENhbGxiYWNrKHJjKTsKICAgICAgICB9CiAg\nICB9CgogICAgdm9pZCBzZW5kQWRkU3VjY2Vzc0NhbGxiYWNrcygpIHsKICAg\nICAgICAvLyBTdGFydCBmcm9tIHRoZSBoZWFkIG9mIHRoZSBxdWV1ZSBhbmQg\ncHJvY2VlZCB3aGlsZSB0aGVyZSBhcmUKICAgICAgICAvLyBlbnRyaWVzIHRo\nYXQgaGF2ZSBoYWQgYWxsIHRoZWlyIHJlc3BvbnNlcyBjb21lIGJhY2sKICAg\nICAgICBQZW5kaW5nQWRkT3AgcGVuZGluZ0FkZE9wOwogICAgICAgIHdoaWxl\nICgocGVuZGluZ0FkZE9wID0gcGVuZGluZ0FkZE9wcy5wZWVrKCkpICE9IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKHBlbmRpbmdBZGRPcC5udW1SZXNwb25z\nZXNQZW5kaW5nICE9IDApIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgfQogICAgICAgICAgICBwZW5kaW5nQWRkT3BzLnJlbW92ZSgp\nOwogICAgICAgICAgICBsYXN0QWRkQ29uZmlybWVkID0gcGVuZGluZ0FkZE9w\nLmVudHJ5SWQ7CiAgICAgICAgICAgIHBlbmRpbmdBZGRPcC5zdWJtaXRDYWxs\nYmFjayhCS0V4Y2VwdGlvbi5Db2RlLk9LKTsKICAgICAgICB9CgogICAgfQoK\nICAgIHZvaWQgaGFuZGxlQm9va2llRmFpbHVyZShJbmV0U29ja2V0QWRkcmVz\ncyBhZGRyLCBmaW5hbCBpbnQgYm9va2llSW5kZXgpIHsKICAgICAgICBJbmV0\nU29ja2V0QWRkcmVzcyBuZXdCb29raWU7CgogICAgICAgIGlmIChMT0cuaXNE\nZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICBMT0cuZGVidWcoIkhhbmRs\naW5nIGZhaWx1cmUgb2YgYm9va2llOiAiICsgYWRkciArICIgaW5kZXg6ICIK\nICAgICAgICAgICAgICAgICAgICAgICsgYm9va2llSW5kZXgpOwogICAgICAg\nIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbmV3Qm9va2llID0gYmsu\nYm9va2llV2F0Y2hlcgogICAgICAgICAgICAgICAgICAgICAgICAuZ2V0QWRk\naXRpb25hbEJvb2tpZShtZXRhZGF0YS5jdXJyZW50RW5zZW1ibGUpOwogICAg\nICAgIH0gY2F0Y2ggKEJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIExPRwogICAgICAgICAgICAuZXJyb3IoIkNvdWxkIG5v\ndCBnZXQgYWRkaXRpb25hbCBib29raWUgdG8gcmVtYWtlIGVuc2VtYmxlLCBj\nbG9zaW5nIGxlZGdlcjogIgogICAgICAgICAgICAgICAgICAgKyBsZWRnZXJJ\nZCk7CiAgICAgICAgICAgIGhhbmRsZVVucmVjb3ZlcmFibGVFcnJvckR1cmlu\nZ0FkZChlLmdldENvZGUoKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICB9CgogICAgICAgIGZpbmFsIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVz\ncz4gbmV3RW5zZW1ibGUgPSBuZXcgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRy\nZXNzPigKICAgICAgICAgICAgbWV0YWRhdGEuY3VycmVudEVuc2VtYmxlKTsK\nICAgICAgICBuZXdFbnNlbWJsZS5zZXQoYm9va2llSW5kZXgsIG5ld0Jvb2tp\nZSk7CgogICAgICAgIGlmIChMT0cuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAg\nICAgICAgICBMT0cuZGVidWcoIkNoYW5naW5nIGVuc2VtYmxlIGZyb206ICIg\nKyBtZXRhZGF0YS5jdXJyZW50RW5zZW1ibGUgKyAiIHRvOiAiCiAgICAgICAg\nICAgICAgICAgICAgICArIG5ld0Vuc2VtYmxlICsgIiBmb3IgbGVkZ2VyOiAi\nICsgbGVkZ2VySWQgKyAiIHN0YXJ0aW5nIGF0IGVudHJ5OiAiCiAgICAgICAg\nICAgICAgICAgICAgICArIChsYXN0QWRkQ29uZmlybWVkICsgMSkpOwogICAg\nICAgIH0KCiAgICAgICAgbWV0YWRhdGEuYWRkRW5zZW1ibGUobGFzdEFkZENv\nbmZpcm1lZCArIDEsIG5ld0Vuc2VtYmxlKTsKCiAgICAgICAgd3JpdGVMZWRn\nZXJDb25maWcobmV3IFN0YXRDYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQo\nZmluYWwgaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgZmluYWwg\nU3RhdCBzdGF0KSB7CgogICAgICAgICAgICAgICAgYmsubWFpbldvcmtlclBv\nb2wuc3VibWl0T3JkZXJlZChsZWRnZXJJZCwgbmV3IFNhZmVSdW5uYWJsZSgp\nIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBzYWZlUnVuKCkgewogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0su\naW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9H\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoIkNvdWxkIG5v\ndCBwZXJzaXN0IGxlZGdlciBtZXRhZGF0YSB3aGlsZSBjaGFuZ2luZyBlbnNl\nbWJsZSB0bzogIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgbmV3RW5zZW1ibGUgKyAiICwgY2xvc2luZyBsZWRnZXIiKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVVucmVjb3ZlcmFibGVFcnJv\nckR1cmluZ0FkZChCS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRh\ndGEudXBkYXRlWm5vZGVTdGF0dXMoc3RhdCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGZvciAoUGVuZGluZ0FkZE9wIHBlbmRpbmdBZGRPcCA6IHBlbmRp\nbmdBZGRPcHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRp\nbmdBZGRPcC51bnNldFN1Y2Nlc3NBbmRTZW5kV3JpdGVSZXF1ZXN0KGJvb2tp\nZUluZGV4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAg\nfQogICAgICAgIH0sIG51bGwpOwoKICAgIH0KCiAgICB2b2lkIHJlcmVhZE1l\ndGFkYXRhKGZpbmFsIEdlbmVyaWNDYWxsYmFjazxWb2lkPiBjYikgewogICAg\nICAgIGJrLmdldFprSGFuZGxlKCkuZ2V0RGF0YShiay5nZXRMZWRnZXJNYW5h\nZ2VyKCkuZ2V0TGVkZ2VyUGF0aChsZWRnZXJJZCksIGZhbHNlLAogICAgICAg\nICAgICAgICAgbmV3IERhdGFDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5n\nIHBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBPYmplY3QgY3R4LCBieXRlW10gZGF0YSwgU3RhdCBzdGF0KSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBLZWVwZXJFeGNl\ncHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHJlYWRpbmcgbWV0YWRhdGEg\nZnJvbSBsZWRnZXIsIGNvZGUgPSIgKyByYyk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5D\nb2RlLlpLRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhID0g\nTGVkZ2VyTWV0YWRhdGEucGFyc2VDb25maWcoZGF0YSwgc3RhdC5nZXRWZXJz\naW9uKCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cu\nZXJyb3IoIkVycm9yIHBhcnNpbmcgbGVkZ2VyIG1ldGFkYXRhIGZvciBsZWRn\nZXIiLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJh\ndGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51\nbGwpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNv\nZGUuT0ssIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0sIG51bGwpOwogICAgfQoKICAgIHZvaWQgcmVjb3ZlcihmaW5h\nbCBHZW5lcmljQ2FsbGJhY2s8Vm9pZD4gY2IpIHsKICAgICAgICBpZiAobWV0\nYWRhdGEuaXNDbG9zZWQoKSkgewogICAgICAgICAgICBsYXN0QWRkQ29uZmly\nbWVkID0gbGFzdEFkZFB1c2hlZCA9IG1ldGFkYXRhLmNsb3NlOwogICAgICAg\nICAgICBsZW5ndGggPSBtZXRhZGF0YS5sZW5ndGg7CgogICAgICAgICAgICAv\nLyBXZSBhcmUgYWxyZWFkeSBjbG9zZWQsIG5vdGhpbmcgdG8gZG8KICAgICAg\nICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5P\nSywgbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAg\nICAgIG1ldGFkYXRhLm1hcmtMZWRnZXJJblJlY292ZXJ5KCk7CgogICAgICAg\nIHdyaXRlTGVkZ2VyQ29uZmlnKG5ldyBTdGF0Q2FsbGJhY2soKSB7CiAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9j\nZXNzUmVzdWx0KGZpbmFsIGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBj\ndHgsIFN0YXQgc3RhdCkgewogICAgICAgICAgICAgICAgaWYgKHJjID09IEtl\nZXBlckV4Y2VwdGlvbi5Db2RlLkJhZFZlcnNpb24pIHsKICAgICAgICAgICAg\nICAgICAgICByZXJlYWRNZXRhZGF0YShuZXcgR2VuZXJpY0NhbGxiYWNrPFZv\naWQ+KCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25Db21wbGV0ZShpbnQgcmMsIFZvaWQgcmVzdWx0KSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IEJLRXhjZXB0aW9u\nLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY2Iub3BlcmF0aW9uQ29tcGxldGUocmMsIG51bGwpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHJlY292ZXIoY2IpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAg\nICAgICAgICB9IGVsc2UgaWYgKHJjID09IEtlZXBlckV4Y2VwdGlvbi5Db2Rl\nLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBtZXRhZGF0\nYS56bm9kZVZlcnNpb24gPSBzdGF0LmdldFZlcnNpb24oKTsKICAgICAgICAg\nICAgICAgICAgICBuZXcgTGVkZ2VyUmVjb3ZlcnlPcChMZWRnZXJIYW5kbGUu\ndGhpcywgY2IpLmluaXRpYXRlKCk7CiAgICAgICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3Igd3JpdGlu\nZyBsZWRnZXIgY29uZmlnICIgKyAgcmMgCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIiBwYXRoID0gIiArIHBhdGgpOwogICAgICAgICAgICAg\nICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUu\nWktFeGNlcHRpb24sIG51bGwpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9CiAgICAgICAgfSwgbnVsbCk7CiAgICB9CgogICAgc3RhdGljIGNs\nYXNzIE5vb3BDbG9zZUNhbGxiYWNrIGltcGxlbWVudHMgQ2xvc2VDYWxsYmFj\nayB7CiAgICAgICAgc3RhdGljIE5vb3BDbG9zZUNhbGxiYWNrIGluc3RhbmNl\nID0gbmV3IE5vb3BDbG9zZUNhbGxiYWNrKCk7CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlQ29tcGxldGUoaW50IHJjLCBM\nZWRnZXJIYW5kbGUgbGgsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgaWYg\nKHJjICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgICAgIExPRy53YXJuKCJDbG9zZSBmYWlsZWQ6ICIgKyBC\nS0V4Y2VwdGlvbi5nZXRNZXNzYWdlKHJjKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgLy8gbm9vcAogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJp\ndmF0ZSBzdGF0aWMgY2xhc3MgU3luY1JlYWRDYWxsYmFjayBpbXBsZW1lbnRz\nIFJlYWRDYWxsYmFjayB7CiAgICAgICAgLyoqCiAgICAgICAgICogSW1wbGVt\nZW50YXRpb24gb2YgY2FsbGJhY2sgaW50ZXJmYWNlIGZvciBzeW5jaHJvbm91\ncyByZWFkIG1ldGhvZC4KICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSBy\nYwogICAgICAgICAqICAgICAgICAgIHJldHVybiBjb2RlCiAgICAgICAgICog\nQHBhcmFtIGxlZGVyCiAgICAgICAgICogICAgICAgICAgbGVkZ2VyIGlkZW50\naWZpZXIKICAgICAgICAgKiBAcGFyYW0gc2VxCiAgICAgICAgICogICAgICAg\nICAgc2VxdWVuY2Ugb2YgZW50cmllcwogICAgICAgICAqIEBwYXJhbSBjdHgK\nICAgICAgICAgKiAgICAgICAgICBjb250cm9sIG9iamVjdAogICAgICAgICAq\nLwogICAgICAgIHB1YmxpYyB2b2lkIHJlYWRDb21wbGV0ZShpbnQgcmMsIExl\nZGdlckhhbmRsZSBsaCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgRW51bWVyYXRpb248TGVkZ2VyRW50cnk+IHNlcSwgT2JqZWN0IGN0eCkg\newogICAgICAgICAgICAKICAgICAgICAgICAgU3luY0NvdW50ZXIgY291bnRl\nciA9IChTeW5jQ291bnRlcikgY3R4OwogICAgICAgICAgICBzeW5jaHJvbml6\nZWQgKGNvdW50ZXIpIHsKICAgICAgICAgICAgICAgIGNvdW50ZXIuc2V0U2Vx\ndWVuY2Uoc2VxKTsKICAgICAgICAgICAgICAgIGNvdW50ZXIuc2V0cmMocmMp\nOwogICAgICAgICAgICAgICAgY291bnRlci5kZWMoKTsKICAgICAgICAgICAg\nICAgIGNvdW50ZXIubm90aWZ5KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU3luY0FkZENhbGxi\nYWNrIGltcGxlbWVudHMgQWRkQ2FsbGJhY2sgewogICAgICAgIC8qKgogICAg\nICAgICAqIEltcGxlbWVudGF0aW9uIG9mIGNhbGxiYWNrIGludGVyZmFjZSBm\nb3Igc3luY2hyb25vdXMgcmVhZCBtZXRob2QuCiAgICAgICAgICoKICAgICAg\nICAgKiBAcGFyYW0gcmMKICAgICAgICAgKiAgICAgICAgICByZXR1cm4gY29k\nZQogICAgICAgICAqIEBwYXJhbSBsZWRlcgogICAgICAgICAqICAgICAgICAg\nIGxlZGdlciBpZGVudGlmaWVyCiAgICAgICAgICogQHBhcmFtIGVudHJ5CiAg\nICAgICAgICogICAgICAgICAgZW50cnkgaWRlbnRpZmllcgogICAgICAgICAq\nIEBwYXJhbSBjdHgKICAgICAgICAgKiAgICAgICAgICBjb250cm9sIG9iamVj\ndAogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGFkZENvbXBsZXRl\nKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBsb25nIGVudHJ5LCBPYmplY3Qg\nY3R4KSB7CiAgICAgICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIgPSAoU3lu\nY0NvdW50ZXIpIGN0eDsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvdW50\nZXIuc2V0cmMocmMpOwogICAgICAgICAgICBjb3VudGVyLmRlYygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBTeW5jUmVh\nZExhc3RDb25maXJtZWRDYWxsYmFjayBpbXBsZW1lbnRzIFJlYWRMYXN0Q29u\nZmlybWVkQ2FsbGJhY2sgewogICAgICAgIC8qKgogICAgICAgICAqIEltcGxl\nbWVudGF0aW9uIG9mICBjYWxsYmFjayBpbnRlcmZhY2UgZm9yIHN5bmNocm9u\nb3VzIHJlYWQgbGFzdCBjb25maXJtZWQgbWV0aG9kLgogICAgICAgICAqLwog\nICAgICAgIHB1YmxpYyB2b2lkIHJlYWRMYXN0Q29uZmlybWVkQ29tcGxldGUo\naW50IHJjLCBsb25nIGxhc3RDb25maXJtZWQsIE9iamVjdCBjdHgpIHsKICAg\nICAgICAgICAgTGFzdENvbmZpcm1lZEN0eCBsY0N0eCA9IChMYXN0Q29uZmly\nbWVkQ3R4KSBjdHg7CiAgICAgICAgICAgIAogICAgICAgICAgICBzeW5jaHJv\nbml6ZWQobGNDdHgpIHsKICAgICAgICAgICAgICAgIGxjQ3R4LnNldFJDKHJj\nKTsKICAgICAgICAgICAgICAgIGxjQ3R4LnNldExhc3RDb25maXJtZWQobGFz\ndENvbmZpcm1lZCk7CiAgICAgICAgICAgICAgICBsY0N0eC5ub3RpZnkoKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0\nYXRpYyBjbGFzcyBTeW5jQ2xvc2VDYWxsYmFjayBpbXBsZW1lbnRzIENsb3Nl\nQ2FsbGJhY2sgewogICAgICAgIC8qKgogICAgICAgICAqIENsb3NlIGNhbGxi\nYWNrIG1ldGhvZAogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHJjCiAg\nICAgICAgICogQHBhcmFtIGxoCiAgICAgICAgICogQHBhcmFtIGN0eAogICAg\nICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlQ29tcGxldGUoaW50\nIHJjLCBMZWRnZXJIYW5kbGUgbGgsIE9iamVjdCBjdHgpIHsKICAgICAgICAg\nICAgU3luY0NvdW50ZXIgY291bnRlciA9IChTeW5jQ291bnRlcikgY3R4Owog\nICAgICAgICAgICBjb3VudGVyLnNldHJjKHJjKTsKICAgICAgICAgICAgc3lu\nY2hyb25pemVkIChjb3VudGVyKSB7CiAgICAgICAgICAgICAgICBjb3VudGVy\nLmRlYygpOwogICAgICAgICAgICAgICAgY291bnRlci5ub3RpZnkoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

