{"sha":"56186ab6a62d6ac8d6097238d84a0b083732c958","node_id":"MDQ6QmxvYjE1NzU5NTY6NTYxODZhYjZhNjJkNmFjOGQ2MDk3MjM4ZDg0YTBiMDgzNzMyYzk1OA==","size":6075,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/56186ab6a62d6ac8d6097238d84a0b083732c958","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuc2VjdXJp\ndHkuR2VuZXJhbFNlY3VyaXR5RXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLk9wZW5DYWxsYmFj\nazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQXN5bmND\nYWxsYmFjay5SZWFkTGFzdENvbmZpcm1lZENhbGxiYWNrOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2VzdFR5\ncGU7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5L\nZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5B\nc3luY0NhbGxiYWNrLkRhdGFDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3Mu\nR2VuZXJpY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nZGF0YS5TdGF0OwoKLyoqCiAqIEVuY2Fwc3VsYXRlcyB0aGUgbGVkZ2VyIG9w\nZW4gb3BlcmF0aW9uCiAqCiAqLwpjbGFzcyBMZWRnZXJPcGVuT3AgaW1wbGVt\nZW50cyBEYXRhQ2FsbGJhY2sgewogICAgc3RhdGljIGZpbmFsIExvZ2dlciBM\nT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMZWRnZXJPcGVuT3AuY2xh\nc3MpOwoKICAgIGZpbmFsIEJvb2tLZWVwZXIgYms7CiAgICBmaW5hbCBsb25n\nIGxlZGdlcklkOwogICAgZmluYWwgT3BlbkNhbGxiYWNrIGNiOwogICAgZmlu\nYWwgT2JqZWN0IGN0eDsKICAgIExlZGdlckhhbmRsZSBsaDsKICAgIGZpbmFs\nIGJ5dGVbXSBwYXNzd2Q7CiAgICBmaW5hbCBEaWdlc3RUeXBlIGRpZ2VzdFR5\ncGU7CiAgICBib29sZWFuIGRvUmVjb3Zlcnk7CgogICAgLyoqCiAgICAgKiBD\nb25zdHJ1Y3Rvci4KICAgICAqCiAgICAgKiBAcGFyYW0gYmsKICAgICAqIEBw\nYXJhbSBsZWRnZXJJZAogICAgICogQHBhcmFtIGRpZ2VzdFR5cGUKICAgICAq\nIEBwYXJhbSBwYXNzd2QKICAgICAqIEBwYXJhbSBjYgogICAgICogQHBhcmFt\nIGN0eAogICAgICovCiAgICBwdWJsaWMgTGVkZ2VyT3Blbk9wKEJvb2tLZWVw\nZXIgYmssIGxvbmcgbGVkZ2VySWQsIERpZ2VzdFR5cGUgZGlnZXN0VHlwZSwg\nYnl0ZVtdIHBhc3N3ZCwgCiAgICAgICAgICAgICAgICAgICAgICAgIE9wZW5D\nYWxsYmFjayBjYiwgT2JqZWN0IGN0eCkgewogICAgICAgIHRoaXMuYmsgPSBi\nazsKICAgICAgICB0aGlzLmxlZGdlcklkID0gbGVkZ2VySWQ7CiAgICAgICAg\ndGhpcy5wYXNzd2QgPSBwYXNzd2Q7CiAgICAgICAgdGhpcy5jYiA9IGNiOwog\nICAgICAgIHRoaXMuY3R4ID0gY3R4OwogICAgICAgIHRoaXMuZGlnZXN0VHlw\nZSA9IGRpZ2VzdFR5cGU7CgogICAgICAgIHRoaXMuZG9SZWNvdmVyeSA9IHRy\ndWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbml0aXRhdGVzIHRoZSBsZWRn\nZXIgb3BlbiBvcGVyYXRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQgaW5p\ndGlhdGUoKSB7CiAgICAgICAgLyoqCiAgICAgICAgICogQXN5bmNocm9ub3Vz\nbHkgcmVhZCB0aGUgbGVkZ2VyIG1ldGFkYXRhIG5vZGUuCiAgICAgICAgICov\nCgogICAgICAgIGJrLmdldFprSGFuZGxlKCkuZ2V0RGF0YShiay5nZXRMZWRn\nZXJNYW5hZ2VyKCkuZ2V0TGVkZ2VyUGF0aChsZWRnZXJJZCksIGZhbHNlLCB0\naGlzLCBjdHgpOwogICAgfQoKICAgIC8qKgogICAgICogSW5pdGl0YXRlcyB0\naGUgbGVkZ2VyIG9wZW4gb3BlcmF0aW9uIHdpdGhvdXQgcmVjb3ZlcnkKICAg\nICAqLwogICAgcHVibGljIHZvaWQgaW5pdGlhdGVXaXRob3V0UmVjb3Zlcnko\nKSB7CiAgICAgICAgdGhpcy5kb1JlY292ZXJ5ID0gZmFsc2U7CiAgICAgICAg\naW5pdGlhdGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudHMg\nWm9vS2VlcGVyIGRhdGEgY2FsbGJhY2suCiAgICAgKiBAc2VlIG9yZy5hcGFj\naGUuem9va2VlcGVyLkFzeW5jQ2FsbGJhY2suRGF0YUNhbGxiYWNrI3Byb2Nl\nc3NSZXN1bHQoaW50LCBTdHJpbmcsIE9iamVjdCwgYnl0ZVtdLCBTdGF0KQog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywg\nU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsIGJ5dGVbXSBkYXRhLCBTdGF0IHN0\nYXQpIHsKCiAgICAgICAgaWYgKHJjID09IEtlZXBlckV4Y2VwdGlvbi5Db2Rl\nLk5PTk9ERS5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgIGlmIChMT0cuaXNE\nZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJO\nbyBzdWNoIGxlZGdlcjogIiArIGxlZGdlcklkLCBLZWVwZXJFeGNlcHRpb24u\nY3JlYXRlKEtlZXBlckV4Y2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBjYi5vcGVuQ29tcGxldGUoQktF\neGNlcHRpb24uQ29kZS5Ob1N1Y2hMZWRnZXJFeGlzdHNFeGNlcHRpb24sIG51\nbGwsIHRoaXMuY3R4KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0K\nICAgICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50\nVmFsdWUoKSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkNvdWxkIG5vdCBy\nZWFkIG1ldGFkYXRhIGZvciBsZWRnZXI6ICIgKyBsZWRnZXJJZCwgS2VlcGVy\nRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZQogICAgICAg\nICAgICAgICAgICAgICAgLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAg\nY2Iub3BlbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24s\nIG51bGwsIHRoaXMuY3R4KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KCiAgICAgICAgTGVkZ2VyTWV0YWRhdGEgbWV0YWRhdGE7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgbWV0YWRhdGEgPSBMZWRnZXJNZXRhZGF0YS5w\nYXJzZUNvbmZpZyhkYXRhLCBzdGF0LmdldFZlcnNpb24oKSk7CiAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJy\nb3IoIkNvdWxkIG5vdCBwYXJzZSBsZWRnZXIgbWV0YWRhdGEgZm9yIGxlZGdl\ncjogIiArIGxlZGdlcklkLCBlKTsKICAgICAgICAgICAgY2Iub3BlbkNvbXBs\nZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51bGwsIHRoaXMu\nY3R4KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgbGggPSBuZXcgUmVhZE9ubHlMZWRnZXJIYW5k\nbGUoYmssIGxlZGdlcklkLCBtZXRhZGF0YSwgZGlnZXN0VHlwZSwgcGFzc3dk\nKTsKICAgICAgICB9IGNhdGNoIChHZW5lcmFsU2VjdXJpdHlFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIlNlY3VyaXR5IGV4Y2VwdGlv\nbiB3aGlsZSBvcGVuaW5nIGxlZGdlcjogIiArIGxlZGdlcklkLCBlKTsKICAg\nICAgICAgICAgY2Iub3BlbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuRGln\nZXN0Tm90SW5pdGlhbGl6ZWRFeGNlcHRpb24sIG51bGwsIHRoaXMuY3R4KTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gY2F0Y2ggKE51bWJlckZv\ncm1hdEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiSW5j\nb3JyZWN0bHkgZW50ZXJlZCBwYXJhbWV0ZXIgdGhyb3R0bGU6ICIgKyBiay5n\nZXRDb25mKCkuZ2V0VGhyb3R0bGVWYWx1ZSgpLCBlKTsKICAgICAgICAgICAg\nY2Iub3BlbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuSW5jb3JyZWN0UGFy\nYW1ldGVyRXhjZXB0aW9uLCBudWxsLCB0aGlzLmN0eCk7CiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChtZXRhZGF0YS5pc0Ns\nb3NlZCgpKSB7CiAgICAgICAgICAgIC8vIExlZGdlciB3YXMgY2xvc2VkIHBy\nb3Blcmx5CiAgICAgICAgICAgIGNiLm9wZW5Db21wbGV0ZShCS0V4Y2VwdGlv\nbi5Db2RlLk9LLCBsaCwgdGhpcy5jdHgpOwogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgfQoKICAgICAgICBpZiAoZG9SZWNvdmVyeSkgewogICAgICAg\nICAgICBsaC5yZWNvdmVyKG5ldyBHZW5lcmljQ2FsbGJhY2s8Vm9pZD4oKSB7\nCiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBW\nb2lkIHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmMg\nIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgY2Iub3BlbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuTGVk\nZ2VyUmVjb3ZlcnlFeGNlcHRpb24sIG51bGwsIExlZGdlck9wZW5PcC50aGlz\nLmN0eCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBjYi5vcGVuQ29tcGxldGUoQktFeGNl\ncHRpb24uQ29kZS5PSywgbGgsIExlZGdlck9wZW5PcC50aGlzLmN0eCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICBsaC5hc3luY1JlYWRMYXN0Q29uZmlybWVkKG5ldyBSZWFkTGFzdENv\nbmZpcm1lZENhbGxiYWNrKCkgewoKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcmVhZExhc3RDb25maXJt\nZWRDb21wbGV0ZShpbnQgcmMsCiAgICAgICAgICAgICAgICAgICAgICAgIGxv\nbmcgbGFzdENvbmZpcm1lZCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAg\nICAgICAgIGlmIChyYyAhPSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGNiLm9wZW5Db21wbGV0ZShCS0V4Y2VwdGlv\nbi5Db2RlLlJlYWRFeGNlcHRpb24sIG51bGwsIExlZGdlck9wZW5PcC50aGlz\nLmN0eCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgbGgubGFzdEFkZENvbmZpcm1lZCA9IGxoLmxhc3RB\nZGRQdXNoZWQgPSBsYXN0Q29uZmlybWVkOwogICAgICAgICAgICAgICAgICAg\nICAgICBjYi5vcGVuQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5PSywgbGgs\nIExlZGdlck9wZW5PcC50aGlzLmN0eCk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAg\nICAgIH0sIG51bGwpOwogICAgICAgICAgICAKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

