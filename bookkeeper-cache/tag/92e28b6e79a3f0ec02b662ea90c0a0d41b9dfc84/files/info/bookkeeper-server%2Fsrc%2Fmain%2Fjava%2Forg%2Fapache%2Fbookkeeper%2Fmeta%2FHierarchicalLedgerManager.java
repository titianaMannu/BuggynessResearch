{"sha":"be965143be207a730852b7e926ab171d48eb02d6","node_id":"MDQ6QmxvYjE1NzU5NTY6YmU5NjUxNDNiZTIwN2E3MzA4NTJiN2U5MjZhYjE3MWQ0OGViMDJkNg==","size":21629,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/be965143be207a730852b7e926ab171d48eb02d6","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCi8qKgogKiBM\naWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFT\nRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBh\nZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgog\nKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGlj\nZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91IG1h\neSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQogKiB3\naXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo\nZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0\nd2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3Bl\nY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBs\naW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50\nLkNvbmN1cnJlbnRNYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5D\nb25jdXJyZW50U2tpcExpc3RNYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5FeGVjdXRvcnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5T\nY2hlZHVsZWRFeGVjdXRvclNlcnZpY2U7CmltcG9ydCBqYXZhLnV0aWwuY29u\nY3VycmVudC5hdG9taWMuQXRvbWljSW50ZWdlcjsKaW1wb3J0IGphdmEudXRp\nbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQWJzdHJhY3RDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJJbnRlcm5hbENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFs\nQ2FsbGJhY2tzLlByb2Nlc3NvcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci51dGlsLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnV0aWwuWmtVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLkFzeW5jQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5Bc3luY0NhbGxiYWNrLlN0cmluZ0NhbGxiYWNrOwppbXBvcnQgb3JnLmFw\nYWNoZS56b29rZWVwZXIuQ3JlYXRlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbi5Db2RlOwppbXBvcnQgb3JnLmFw\nYWNoZS56b29rZWVwZXIuWm9vRGVmcy5JZHM7CmltcG9ydCBvcmcuYXBhY2hl\nLnpvb2tlZXBlci5ab29LZWVwZXI7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIEhp\nZXJhcmNoaWNhbCBMZWRnZXIgTWFuYWdlciB3aGljaCBtYW5hZ2VzIGxlZGdl\nciBtZXRhIGluIHpvb2tlZXBlciB1c2luZyAyLWxldmVsIGhpZXJhcmNoaWNh\nbCB6bm9kZXMuCiAqCiAqIDxwPgogKiBIaWVyYXJjaGljYWwgTGVkZ2VyIE1h\nbmFnZXIgZmlyc3Qgb2J0YWluIGEgZ2xvYmFsIHVuaXF1ZSBpZCBmcm9tIHpv\nb2tlZXBlciB1c2luZyBhIEVQSEVNRVJBTF9TRVFVRU5USUFMCiAqIHpub2Rl\nIDxpPihsZWRnZXJzUm9vdFBhdGgpL2xlZGdlcnMvaWRnZW4vSUQtPC9pPi4K\nICogU2luY2Ugem9va2VlcGVyIHNlcXVlbnRpYWwgY291bnRlciBoYXMgYSBm\nb3JtYXQgb2YgJTEwZCAtLSB0aGF0IGlzIDEwIGRpZ2l0cyB3aXRoIDAgKHpl\ncm8pIHBhZGRpbmcsIGkuZS4KICogIiZsdDtwYXRoJmd0OzAwMDAwMDAwMDEi\nLCBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyIHNwbGl0cyB0aGUgZ2VuZXJh\ndGVkIGlkIGludG8gMyBwYXJ0cyAoMi00LTQpOgogKiA8cHJlPiZsdDtsZXZl\nbDEgKDIgZGlnaXRzKSZndDsmbHQ7bGV2ZWwyICg0IGRpZ2l0cykmZ3Q7Jmx0\nO2xldmVsMyAoNCBkaWdpdHMpJmd0OzwvcHJlPgogKiBUaGVzZSAzIHBhcnRz\nIGFyZSB1c2VkIHRvIGZvcm0gdGhlIGFjdHVhbCBsZWRnZXIgbm9kZSBwYXRo\nIHVzZWQgdG8gc3RvcmUgbGVkZ2VyIG1ldGFkYXRhOgogKiA8cHJlPihsZWRn\nZXJzUm9vdFBhdGgpL2xldmVsMS9sZXZlbDIvTChsZXZlbDMpPC9wcmU+CiAq\nIEUuZyBMZWRnZXIgMDAwMDAwMDAwMSBpcyBzcGxpdCBpbnRvIDMgcGFydHMg\nPGk+MDA8L2k+LCA8aT4wMDAwPC9pPiwgPGk+MDAwMTwvaT4sIHdoaWNoIGlz\nIHN0b3JlZCBpbgogKiA8aT4obGVkZ2Vyc1Jvb3RQYXRoKS8wMC8wMDAwL0ww\nMDAxPC9pPi4gU28gZWFjaCB6bm9kZSBjb3VsZCBoYXZlIGF0IG1vc3QgMTAw\nMDAgbGVkZ2Vycywgd2hpY2ggYXZvaWRzCiAqIGZhaWxlZCB0byBnZXQgY2hp\nbGRyZW4gbGlzdCBvZiBhIHRvbyBiaWcgem5vZGUgZHVyaW5nIGdhcmJhZ2Ug\nY29sbGVjdGlvbi4KICogPHA+CiAqIEFsbCBhY3RpdmVkIGxlZGdlcnMgZm91\nbmQgaW4gYm9va2llIHNlcnZlciBpcyBtYW5hZ2VkIGluIGEgc29ydGVkIG1h\ncCwgd2hpY2ggZWFzZSB1cyB0byBwaWNrCiAqIHVwIGFsbCBhY3RpdmVkIGxl\nZGdlcnMgYmVsb25ncyB0byAobGV2ZWwxLCBsZXZlbDIpLgogKiA8L3A+CiAq\nIDxwPgogKiBHYXJiYWdlIGNvbGxlY3Rpb24gaW4gSGllcmFyY2hpY2FsTGVk\nZ2VyTWFuYWdlciBpcyBwcm9jZXNzZWQgbm9kZSBieSBub2RlIGFzIGJlbG93\nOgogKiA8dWw+CiAqIGZldGNoaW5nIGFsbCBsZXZlbDEgbm9kZXMsIGJ5IGNh\nbGxpbmcgemsjZ2V0Q2hpbGRyZW4obGVkZ2VyUm9vdFBhdGgpLgogKiA8dWw+\nCiAqIGZvciBlYWNoIGxldmVsMSBub2RlLCBmZXRjaGluZyB0aGVpciBsZXZl\nbDIgbm9kZXMsIGJ5IGNhbGxpbmcgemsjZ2V0Q2hpbGRyZW4obGVkZ2VyUm9v\ndFBhdGggKyAiLyIgKyBsZXZlbDEpCiAqIDxsaT4gZmV0Y2ggYWxsIGV4aXN0\nZWQgbGVkZ2VycyBmcm9tIHpvb2tlZXBlciBpbiBsZXZlbDEvbGV2ZWwyIG5v\nZGUsIHNhaWQgPGI+emtBY3RpdmVMZWRnZXJzPC9iPgogKiA8bGk+IGZldGNo\nIGFsbCBhY3RpdmUgbGVkZ2VycyBmcm9tIGJvb2tpZSBzZXJ2ZXIgaW4gbGV2\nZWwxL2xldmVsMiwgc2FpZCA8Yj5ia0FjdGl2ZUxlZGdlcnM8L2I+CiAqIDxs\naT4gbG9vcCBvdmVyIDxiPmJrQWN0aXZlTGVkZ2VyczwvYj4gdG8gZmluZCB0\naG9zZSBsZWRnZXJzIGFyZW4ndCBleGlzdGVkIGluIDxiPnprQWN0aXZlTGVk\nZ2VyczwvYj4sIGRvIGdhcmJhZ2UgY29sbGVjdGlvbiBvbiB0aGVtLgogKiA8\nL3VsPgogKiA8L3VsPgogKiBTaW5jZSBnYXJiYWdlIGNvbGxlY3Rpb24gaXMg\ncnVubmluZyBpbiBiYWNrZ3JvdW5kLCBIaWVyYXJjaGljYWxMZWRnZXJNYW5h\nZ2VyIGRpZCBnYyBvbiBzaW5nbGUgaGFzaAogKiBub2RlIGF0IGEgdGltZSB0\nbyBhdm9pZCBjb25zdW1pbmcgdG9vIG11Y2ggcmVzb3VyY2VzLgogKiA8L3A+\nCiAqLwpjbGFzcyBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyIGV4dGVuZHMg\nQWJzdHJhY3Raa0xlZGdlck1hbmFnZXIgewoKICAgIHN0YXRpYyBmaW5hbCBM\nb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSGllcmFyY2hp\nY2FsTGVkZ2VyTWFuYWdlci5jbGFzcyk7CiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZyBOQU1FID0gImhpZXJhcmNoaWNhbCI7CgogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBpbnQgQ1VSX1ZFUlNJT04gPSAxOwoKICAgIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgSURHRU5FUkFUSU9OX1BSRUZJWCA9ICIvaWRnZW4v\nSUQtIjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBNQVhfSURf\nU1VGRklYID0gIjk5OTkiOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3Ry\naW5nIE1JTl9JRF9TVUZGSVggPSAiMDAwMCI7CgogICAgLy8gUGF0aCB0byBn\nZW5lcmF0ZSBnbG9iYWwgaWQKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIGlk\nR2VuUGF0aDsKICAgIC8vIEEgc29ydGVkIG1hcCB0byBzdG9yZWQgYWxsIGFj\ndGl2ZSBsZWRnZXIgaWRzCiAgICBwcml2YXRlIENvbmN1cnJlbnRTa2lwTGlz\ndE1hcDxMb25nLCBCb29sZWFuPiBhY3RpdmVMZWRnZXJzOwoKICAgIC8vIHdl\nIHVzZSB0aGlzIHRvIHByZXZlbnQgbG9uZyBzdGFjayBjaGFpbnMgZnJvbSBi\ndWlsZGluZyB1cCBpbiBjYWxsYmFja3MKICAgIFNjaGVkdWxlZEV4ZWN1dG9y\nU2VydmljZSBzY2hlZHVsZXI7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rv\ncgogICAgICoKICAgICAqIEBwYXJhbSBjb25mCiAgICAgKiAgICAgICAgICBD\nb25maWd1cmF0aW9uIG9iamVjdAogICAgICogQHBhcmFtIHprCiAgICAgKiAg\nICAgICAgICBab29LZWVwZXIgQ2xpZW50IEhhbmRsZQogICAgICogQHBhcmFt\nIGxlZGdlclJvb3RQYXRoCiAgICAgKiAgICAgICAgICBab29LZWVwZXIgUGF0\naCB0byBzdG9yZSBsZWRnZXIgbWV0YWRhdGEKICAgICAqIEB0aHJvd3MgSU9F\neGNlcHRpb24gd2hlbiB2ZXJzaW9uIGlzIG5vdCBjb21wYXRpYmxlCiAgICAg\nKi8KICAgIHB1YmxpYyBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyKEFic3Ry\nYWN0Q29uZmlndXJhdGlvbiBjb25mLCBab29LZWVwZXIgemssCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbGVkZ2VyUm9v\ndFBhdGgsIGludCBsYXlvdXRWZXJzaW9uKQogICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgc3VwZXIoY29uZiwgemssIGxlZGdlclJvb3RQ\nYXRoKTsKCiAgICAgICAgaWYgKGxheW91dFZlcnNpb24gIT0gQ1VSX1ZFUlNJ\nT04pIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJJbmNv\nbXBhdGlibGUgbGF5b3V0IHZlcnNpb24gZm91bmQgOiAiIAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyBsYXlvdXRWZXJzaW9uKTsKICAg\nICAgICB9CgogICAgICAgIHRoaXMuaWRHZW5QYXRoID0gbGVkZ2VyUm9vdFBh\ndGggKyBJREdFTkVSQVRJT05fUFJFRklYOwogICAgICAgIHRoaXMuYWN0aXZl\nTGVkZ2VycyA9IG5ldyBDb25jdXJyZW50U2tpcExpc3RNYXA8TG9uZywgQm9v\nbGVhbj4oKTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IEV4ZWN1dG9ycy5u\nZXdTaW5nbGVUaHJlYWRTY2hlZHVsZWRFeGVjdXRvcigpOwogICAgICAgIGlm\nIChMT0cuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICBMT0cuZGVi\ndWcoIlVzaW5nIEhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXIgd2l0aCByb290\nIHBhdGggOiAiICsgbGVkZ2VyUm9vdFBhdGgpOwogICAgICAgIH0KICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHNjaGVkdWxlci5zaHV0ZG93bigpOwog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExP\nRy53YXJuKCJFcnJvciB3aGVuIGNsb3NpbmcgSGllcmFyY2hpY2FsTGVkZ2Vy\nTWFuYWdlciA6ICIsIGUpOwogICAgICAgIH0KICAgICAgICBzdXBlci5jbG9z\nZSgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgbmV3\nTGVkZ2VyUGF0aChmaW5hbCBHZW5lcmljQ2FsbGJhY2s8U3RyaW5nPiBsZWRn\nZXJDYikgewogICAgICAgIFprVXRpbHMuY3JlYXRlRnVsbFBhdGhPcHRpbWlz\ndGljKHprLCBpZEdlblBhdGgsIG5ldyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xf\nVU5TQUZFLAogICAgICAgICAgICBDcmVhdGVNb2RlLkVQSEVNRVJBTF9TRVFV\nRU5USUFMLCBuZXcgU3RyaW5nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0\nKGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsIGZpbmFsIFN0cmlu\nZyBpZFBhdGhOYW1lKSB7CiAgICAgICAgICAgICAgICBpZiAocmMgIT0gS2Vl\ncGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAg\nICAgICAgICAgIExPRy5lcnJvcigiQ291bGQgbm90IGdlbmVyYXRlIG5ldyBs\nZWRnZXIgaWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBLZWVw\nZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4Y2VwdGlvbi5Db2RlLmdldChy\nYyksIHBhdGgpKTsKICAgICAgICAgICAgICAgICAgICBsZWRnZXJDYi5vcGVy\nYXRpb25Db21wbGV0ZShyYywgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLyoK\nICAgICAgICAgICAgICAgICAqIEV4dHJhY3QgbGVkZ2VyIGlkIGZyb20gZ2Vu\nIHBhdGgKICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgbG9u\nZyBsZWRnZXJJZDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgbGVkZ2VySWQgPSBnZXRMZWRnZXJJZEZyb21HZW5QYXRoKGlk\nUGF0aE5hbWUpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGQg\nbm90IGV4dHJhY3QgbGVkZ2VyLWlkIGZyb20gaWQgZ2VuIHBhdGg6IiArIHBh\ndGgsIGUpOwogICAgICAgICAgICAgICAgICAgIGxlZGdlckNiLm9wZXJhdGlv\nbkNvbXBsZXRlKEtlZXBlckV4Y2VwdGlvbi5Db2RlLlNZU1RFTUVSUk9SLmlu\ndFZhbHVlKCksIG51bGwpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFN0cmluZ0NhbGxi\nYWNrIHNjYiA9IG5ldyBTdHJpbmdDYWxsYmFjaygpIHsKICAgICAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\ndm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QgY3R4LCBTdHJpbmcgbmFt\nZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmMgIT0gS2VlcGVy\nRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbGVkZ2VyQ2Iub3BlcmF0aW9uQ29tcGxldGUocmMs\nIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbGVkZ2VyQ2Iub3BlcmF0aW9uQ29t\ncGxldGUocmMsIG5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAg\nICAgICAgICAgIFN0cmluZyBsZWRnZXJQYXRoID0gZ2V0TGVkZ2VyUGF0aChs\nZWRnZXJJZCk7CiAgICAgICAgICAgICAgICBaa1V0aWxzLmNyZWF0ZUZ1bGxQ\nYXRoT3B0aW1pc3RpYyh6aywgbGVkZ2VyUGF0aCwgbmV3IGJ5dGVbMF0sCiAg\nICAgICAgICAgICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRl\nTW9kZS5QRVJTSVNURU5ULCBzY2IsIG51bGwpOwogICAgICAgICAgICAgICAg\nLy8gZGVsZXRlIHRoZSB6bm9kZSBmb3IgaWQgZ2VuZXJhdGlvbgogICAgICAg\nICAgICAgICAgc2NoZWR1bGVyLnN1Ym1pdChuZXcgUnVubmFibGUoKSB7CiAg\nICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgICAg\nICB6ay5kZWxldGUoaWRQYXRoTmFtZSwgLTEsIG5ldyBBc3luY0NhbGxiYWNr\nLlZvaWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGlj\nIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmpl\nY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKHJjICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLndhcm4o\nIkV4Y2VwdGlvbiBkdXJpbmcgZGVsZXRpbmcgem5vZGUgZm9yIGlkIGdlbmVy\nYXRpb24gOiAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4Y2Vw\ndGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1\nZygiRGVsZXRpbmcgem5vZGUgZm9yIGlkIGdlbmVyYXRpb24gOiAiICsgaWRQ\nYXRoTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0sIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwgbnVsbCk7CiAgICB9\nCgogICAgLy8gZ2V0IGxlZGdlciBpZCBmcm9tIGdlbmVyYXRpb24gcGF0aAog\nICAgcHJpdmF0ZSBsb25nIGdldExlZGdlcklkRnJvbUdlblBhdGgoU3RyaW5n\nIG5vZGVOYW1lKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGxvbmcg\nbGVkZ2VySWQ7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nIHBh\ncnRzW10gPSBub2RlTmFtZS5zcGxpdChJREdFTkVSQVRJT05fUFJFRklYKTsK\nICAgICAgICAgICAgbGVkZ2VySWQgPSBMb25nLnBhcnNlTG9uZyhwYXJ0c1tw\nYXJ0cy5sZW5ndGggLSAxXSk7CiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9y\nbWF0RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhj\nZXB0aW9uKGUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbGVkZ2VySWQ7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIGdldExl\nZGdlclBhdGgobG9uZyBsZWRnZXJJZCkgewogICAgICAgIFN0cmluZyBsZWRn\nZXJJZFN0ciA9IFN0cmluZ1V0aWxzLmdldFpLU3RyaW5nSWQobGVkZ2VySWQp\nOwogICAgICAgIC8vIGRvIDItNC00IHNwbGl0CiAgICAgICAgU3RyaW5nQnVp\nbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgc2IuYXBw\nZW5kKGxlZGdlclJvb3RQYXRoKS5hcHBlbmQoIi8iKQogICAgICAgICAgLmFw\ncGVuZChsZWRnZXJJZFN0ci5zdWJzdHJpbmcoMCwgMikpLmFwcGVuZCgiLyIp\nCiAgICAgICAgICAuYXBwZW5kKGxlZGdlcklkU3RyLnN1YnN0cmluZygyLCA2\nKSkuYXBwZW5kKCIvIikKICAgICAgICAgIC5hcHBlbmQoTEVER0VSX05PREVf\nUFJFRklYKS5hcHBlbmQobGVkZ2VySWRTdHIuc3Vic3RyaW5nKDYsIDEwKSk7\nCiAgICAgICAgcmV0dXJuIHNiLnRvU3RyaW5nKCk7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgbG9uZyBnZXRMZWRnZXJJZChTdHJpbmcgcGF0\naE5hbWUpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFwYXRo\nTmFtZS5zdGFydHNXaXRoKGxlZGdlclJvb3RQYXRoKSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIml0IGlzIG5vdCBhIHZhbGlkIGhh\nc2hlZCBwYXRoIG5hbWUgOiAiICsgcGF0aE5hbWUpOwogICAgICAgIH0KICAg\nICAgICBTdHJpbmcgaGllcmFyY2hpY2FsUGF0aCA9IHBhdGhOYW1lLnN1YnN0\ncmluZyhsZWRnZXJSb290UGF0aC5sZW5ndGgoKSArIDEpOwogICAgICAgIFN0\ncmluZ1tdIGhpZXJhcmNoaWNhbFBhcnRzID0gaGllcmFyY2hpY2FsUGF0aC5z\ncGxpdCgiLyIpOwogICAgICAgIGlmIChoaWVyYXJjaGljYWxQYXJ0cy5sZW5n\ndGggIT0gMykgewogICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24o\nIml0IGlzIG5vdCBhIHZhbGlkIGhpZXJhcmNoaWNhbCBwYXRoIG5hbWUgOiAi\nICsgcGF0aE5hbWUpOwogICAgICAgIH0KICAgICAgICBoaWVyYXJjaGljYWxQ\nYXJ0c1syXSA9CiAgICAgICAgICAgIGhpZXJhcmNoaWNhbFBhcnRzWzJdLnN1\nYnN0cmluZyhMRURHRVJfTk9ERV9QUkVGSVgubGVuZ3RoKCkpOwogICAgICAg\nIHJldHVybiBnZXRMZWRnZXJJZChoaWVyYXJjaGljYWxQYXJ0cyk7CiAgICB9\nCgogICAgLy8gZ2V0IGxlZGdlciBmcm9tIGFsbCBsZXZlbCBub2RlcwogICAg\ncHJpdmF0ZSBsb25nIGdldExlZGdlcklkKFN0cmluZy4uLmxldmVsTm9kZXMp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAg\nICAgICAgICAgIGZvciAoU3RyaW5nIG5vZGUgOiBsZXZlbE5vZGVzKSB7CiAg\nICAgICAgICAgICAgICBzYi5hcHBlbmQobm9kZSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgcmV0dXJuIExvbmcucGFyc2VMb25nKHNiLnRvU3RyaW5n\nKCkpOwogICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbihlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLy8KICAgIC8vIEFjdGl2ZSBMZWRnZXIgTWFu\nYWdlcgogICAgLy8KCiAgICAvKioKICAgICAqIEdldCB0aGUgc21hbGxlc3Qg\nY2FjaGUgaWQgaW4gYSBzcGVjaWZpZWQgbm9kZSAvbGV2ZWwxL2xldmVsMgog\nICAgICoKICAgICAqIEBwYXJhbSBsZXZlbDEKICAgICAqICAgICAgICAgIDFz\ndCBsZXZlbCBub2RlIG5hbWUKICAgICAqIEBwYXJhbSBsZXZlbDIKICAgICAq\nICAgICAgICAgIDJuZCBsZXZlbCBub2RlIG5hbWUKICAgICAqIEByZXR1cm4g\ndGhlIHNtYWxsZXN0IGxlZGdlciBpZAogICAgICovCiAgICBwcml2YXRlIGxv\nbmcgZ2V0U3RhcnRMZWRnZXJJZEJ5TGV2ZWwoU3RyaW5nIGxldmVsMSwgU3Ry\naW5nIGxldmVsMikgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1\ncm4gZ2V0TGVkZ2VySWQobGV2ZWwxLCBsZXZlbDIsIE1JTl9JRF9TVUZGSVgp\nOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRoZSBsYXJnZXN0IGNhY2hl\nIGlkIGluIGEgc3BlY2lmaWVkIG5vZGUgL2xldmVsMS9sZXZlbDIKICAgICAq\nCiAgICAgKiBAcGFyYW0gbGV2ZWwxCiAgICAgKiAgICAgICAgICAxc3QgbGV2\nZWwgbm9kZSBuYW1lCiAgICAgKiBAcGFyYW0gbGV2ZWwyCiAgICAgKiAgICAg\nICAgICAybmQgbGV2ZWwgbm9kZSBuYW1lCiAgICAgKiBAcmV0dXJuIHRoZSBs\nYXJnZXN0IGxlZGdlciBpZAogICAgICovCiAgICBwcml2YXRlIGxvbmcgZ2V0\nRW5kTGVkZ2VySWRCeUxldmVsKFN0cmluZyBsZXZlbDEsIFN0cmluZyBsZXZl\nbDIpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGdldExl\nZGdlcklkKGxldmVsMSwgbGV2ZWwyLCBNQVhfSURfU1VGRklYKTsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGFzeW5jUHJvY2Vzc0xl\nZGdlcnMoZmluYWwgUHJvY2Vzc29yPExvbmc+IHByb2Nlc3NvciwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgQXN5bmNDYWxs\nYmFjay5Wb2lkQ2FsbGJhY2sgZmluYWxDYiwgZmluYWwgT2JqZWN0IGNvbnRl\neHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFs\nIGludCBzdWNjZXNzUmMsIGZpbmFsIGludCBmYWlsdXJlUmMpIHsKICAgICAg\nICAvLyBwcm9jZXNzIDFzdCBsZXZlbCBub2RlcwogICAgICAgIGFzeW5jUHJv\nY2Vzc0xldmVsTm9kZXMobGVkZ2VyUm9vdFBhdGgsIG5ldyBQcm9jZXNzb3I8\nU3RyaW5nPigpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHByb2Nlc3MoZmluYWwgU3RyaW5nIGwxTm9kZSwgZmlu\nYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sgY2IxKSB7CiAgICAgICAg\nICAgICAgICBpZiAoaXNTcGVjaWFsWm5vZGUobDFOb2RlKSkgewogICAgICAg\nICAgICAgICAgICAgIGNiMS5wcm9jZXNzUmVzdWx0KHN1Y2Nlc3NSYywgbnVs\nbCwgY29udGV4dCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZmluYWwgU3RyaW5nIGwx\nTm9kZVBhdGggPSBsZWRnZXJSb290UGF0aCArICIvIiArIGwxTm9kZTsKICAg\nICAgICAgICAgICAgIC8vIHByb2Nlc3MgbGV2ZWwxIHBhdGgsIGFmdGVyIGFs\nbCBjaGlsZHJlbiBvZiBsZXZlbDEgcHJvY2VzcwogICAgICAgICAgICAgICAg\nLy8gaXQgY2FsbGJhY2sgdG8gY29udGludWUgcHJvY2Vzc2luZyBuZXh0IGxl\ndmVsMSBub2RlCiAgICAgICAgICAgICAgICBhc3luY1Byb2Nlc3NMZXZlbE5v\nZGVzKGwxTm9kZVBhdGgsIG5ldyBQcm9jZXNzb3I8U3RyaW5nPigpIHsKICAg\nICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBwcm9jZXNzKFN0cmluZyBsMk5vZGUsIEFzeW5jQ2Fs\nbGJhY2suVm9pZENhbGxiYWNrIGNiMikgewogICAgICAgICAgICAgICAgICAg\nICAgICAvLyBwcm9jZXNzIGxldmVsMS9sZXZlbDIgcGF0aAogICAgICAgICAg\nICAgICAgICAgICAgICBTdHJpbmcgbDJOb2RlUGF0aCA9IGxlZGdlclJvb3RQ\nYXRoICsgIi8iICsgbDFOb2RlICsgIi8iICsgbDJOb2RlOwogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBwcm9jZXNzIGVhY2ggbGVkZ2VyCiAgICAgICAg\nICAgICAgICAgICAgICAgIC8vIGFmdGVyIGFsbCBsZWRnZXIgYXJlIHByb2Nl\nc3NlZCwgY2IyIHdpbGwgYmUgY2FsbCB0byBjb250aW51ZSBwcm9jZXNzaW5n\nIG5leHQgbGV2ZWwyIG5vZGUKICAgICAgICAgICAgICAgICAgICAgICAgYXN5\nbmNQcm9jZXNzTGVkZ2Vyc0luU2luZ2xlTm9kZShsMk5vZGVQYXRoLCBwcm9j\nZXNzb3IsIGNiMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LCBzdWNjZXNzUmMsIGZh\naWx1cmVSYyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfSwgY2IxLCBjb250ZXh0LCBzdWNjZXNzUmMsIGZhaWx1cmVSYyk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9LCBmaW5hbENiLCBjb250ZXh0LCBzdWNj\nZXNzUmMsIGZhaWx1cmVSYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcm9j\nZXNzIGhhc2ggbm9kZXMgaW4gYSBnaXZlbiBwYXRoCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBhc3luY1Byb2Nlc3NMZXZlbE5vZGVzKAogICAgICAgIGZp\nbmFsIFN0cmluZyBwYXRoLCBmaW5hbCBQcm9jZXNzb3I8U3RyaW5nPiBwcm9j\nZXNzb3IsCiAgICAgICAgZmluYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJh\nY2sgZmluYWxDYiwgZmluYWwgT2JqZWN0IGNvbnRleHQsCiAgICAgICAgZmlu\nYWwgaW50IHN1Y2Nlc3NSYywgZmluYWwgaW50IGZhaWx1cmVSYykgewogICAg\nICAgIHprLnN5bmMocGF0aCwgbmV3IEFzeW5jQ2FsbGJhY2suVm9pZENhbGxi\nYWNrKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBP\nYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICBpZiAocmMgIT0gQ29kZS5P\nSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9y\nKCJFcnJvciBzeW5jaW5nIHBhdGggIiArIHBhdGggKyAiIHdoZW4gZ2V0dGlu\nZyBpdHMgY2hpZHJlbjogIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29k\nZS5nZXQocmMpLCBwYXRoKSk7CiAgICAgICAgICAgICAgICAgICAgZmluYWxD\nYi5wcm9jZXNzUmVzdWx0KGZhaWx1cmVSYywgbnVsbCwgY29udGV4dCk7CiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgIHprLmdldENoaWxkcmVuKHBhdGgsIGZhbHNlLCBu\nZXcgQXN5bmNDYWxsYmFjay5DaGlsZHJlbkNhbGxiYWNrKCkgewogICAgICAg\nICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwg\nT2JqZWN0IGN0eCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIExpc3Q8U3RyaW5nPiBsZXZlbE5vZGVzKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9LLmludFZhbHVl\nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigi\nRXJyb3IgcG9sbGluZyBoYXNoIG5vZGVzIG9mICIgKyBwYXRoLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlv\nbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSwgcGF0aCkp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxDYi5wcm9jZXNz\nUmVzdWx0KGZhaWx1cmVSYywgbnVsbCwgY29udGV4dCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgQXN5bmNMaXN0UHJvY2Vz\nc29yPFN0cmluZz4gbGlzdFByb2Nlc3NvciA9CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbmV3IEFzeW5jTGlzdFByb2Nlc3NvcjxTdHJpbmc+\nKHNjaGVkdWxlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByb2Nl\nc3MgaXRzIGNoaWxkcmVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RQ\ncm9jZXNzb3IucHJvY2VzcyhsZXZlbE5vZGVzLCBwcm9jZXNzb3IsIGZpbmFs\nQ2IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBjb250ZXh0LCBzdWNjZXNzUmMsIGZhaWx1cmVSYyk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgbnVsbCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9LCBudWxsKTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIGFkZEFjdGl2ZUxlZGdlcihsb25nIGxlZGdl\ncklkLCBib29sZWFuIGFjdGl2ZSkgewogICAgICAgIGFjdGl2ZUxlZGdlcnMu\ncHV0KGxlZGdlcklkLCBhY3RpdmUpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIHZvaWQgcmVtb3ZlQWN0aXZlTGVkZ2VyKGxvbmcgbGVkZ2Vy\nSWQpIHsKICAgICAgICBhY3RpdmVMZWRnZXJzLnJlbW92ZShsZWRnZXJJZCk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBjb250\nYWluc0FjdGl2ZUxlZGdlcihsb25nIGxlZGdlcklkKSB7CiAgICAgICAgcmV0\ndXJuIGFjdGl2ZUxlZGdlcnMuY29udGFpbnNLZXkobGVkZ2VySWQpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgZ2FyYmFnZUNvbGxl\nY3RMZWRnZXJzKEdhcmJhZ2VDb2xsZWN0b3IgZ2MpIHsKICAgICAgICB0cnkg\newogICAgICAgICAgICBMaXN0PFN0cmluZz4gbDFOb2RlcyA9IHprLmdldENo\naWxkcmVuKGxlZGdlclJvb3RQYXRoLCBudWxsKTsKICAgICAgICAgICAgZm9y\nIChTdHJpbmcgbDFOb2RlIDogbDFOb2RlcykgewogICAgICAgICAgICAgICAg\naWYgKGlzU3BlY2lhbFpub2RlKGwxTm9kZSkpIHsKICAgICAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGwy\nTm9kZXMgPSB6ay5nZXRDaGlsZHJlbihsZWRnZXJSb290UGF0aCArICIvIiAr\nIGwxTm9kZSwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChTdHJp\nbmcgbDJOb2RlIDogbDJOb2RlcykgewogICAgICAgICAgICAgICAgICAgICAg\nICBkb0djQnlMZXZlbChnYywgbDFOb2RlLCBsMk5vZGUpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLndhcm4oIkV4Y2VwdGlv\nbiBkdXJpbmcgZ2FyYmFnZSBjb2xsZWN0aW5nIGxlZGdlcnMgZm9yICIgKyBs\nMU5vZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIG9mICIgKyBs\nZWRnZXJSb290UGF0aCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICBMT0cud2FybigiRXhjZXB0aW9uIGR1cmluZyBnYXJiYWdlIGNvbGxlY3Rp\nbmcgaW5hY3RpdmUvZGVsZXRlZCBsZWRnZXJzIik7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogR2FyYmFnZSBjb2xsZWN0aW9uIGEgc2luZ2xl\nIG5vZGUgbGV2ZWwxL2xldmVsMgogICAgICoKICAgICAqIEBwYXJhbSBnYwog\nICAgICogICAgICAgICAgR2FyYmFnZSBjb2xsZWN0b3IKICAgICAqIEBwYXJh\nbSBsZXZlbDEKICAgICAqICAgICAgICAgIDFzdCBsZXZlbCBub2RlIG5hbWUK\nICAgICAqIEBwYXJhbSBsZXZlbDIKICAgICAqICAgICAgICAgIDJuZCBsZXZl\nbCBub2RlIG5hbWUKICAgICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAq\nIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqLwogICAgdm9p\nZCBkb0djQnlMZXZlbChHYXJiYWdlQ29sbGVjdG9yIGdjLCBmaW5hbCBTdHJp\nbmcgbGV2ZWwxLCBmaW5hbCBTdHJpbmcgbGV2ZWwyKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewoKICAgICAg\nICBTdHJpbmdCdWlsZGVyIG5vZGVCdWlsZGVyID0gbmV3IFN0cmluZ0J1aWxk\nZXIoKTsKICAgICAgICBub2RlQnVpbGRlci5hcHBlbmQobGVkZ2VyUm9vdFBh\ndGgpLmFwcGVuZCgiLyIpCiAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGxl\ndmVsMSkuYXBwZW5kKCIvIikuYXBwZW5kKGxldmVsMik7CiAgICAgICAgU3Ry\naW5nIG5vZGVQYXRoID0gbm9kZUJ1aWxkZXIudG9TdHJpbmcoKTsKCiAgICAg\nICAgSGFzaFNldDxMb25nPiB6a0FjdGl2ZUxlZGdlcnMgPSBnZXRMZWRnZXJz\nSW5TaW5nbGVOb2RlKG5vZGVQYXRoKTsKICAgICAgICAvLyBnZXQgaG9zdGVk\nIGxlZGdlcnMgaW4gL2xldmVsMS9sZXZlbDIKICAgICAgICBsb25nIHN0YXJ0\nTGVkZ2VySWQgPSBnZXRTdGFydExlZGdlcklkQnlMZXZlbChsZXZlbDEsIGxl\ndmVsMik7CiAgICAgICAgbG9uZyBlbmRMZWRnZXJJZCA9IGdldEVuZExlZGdl\ncklkQnlMZXZlbChsZXZlbDEsIGxldmVsMik7CiAgICAgICAgQ29uY3VycmVu\ndE1hcDxMb25nLCBCb29sZWFuPiBia0FjdGl2ZUxlZGdlcnMgPQogICAgICAg\nICAgICBhY3RpdmVMZWRnZXJzLnN1Yk1hcChzdGFydExlZGdlcklkLCB0cnVl\nLCBlbmRMZWRnZXJJZCwgdHJ1ZSk7CiAgICAgICAgaWYgKExPRy5pc0RlYnVn\nRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiQWxsIGFjdGl2\nZSBsZWRnZXJzIGZyb20gWksgZm9yIGhhc2ggbm9kZSAiCiAgICAgICAgICAg\nICAgICAgICAgICArIGxldmVsMSArICIvIiArIGxldmVsMiArICIgOiAiICsg\nemtBY3RpdmVMZWRnZXJzKTsKICAgICAgICAgICAgTE9HLmRlYnVnKCJDdXJy\nZW50IGFjdGl2ZSBsZWRnZXJzIGZyb20gQm9va2llIGZvciBoYXNoIG5vZGUg\nIgogICAgICAgICAgICAgICAgICAgICAgKyBsZXZlbDEgKyAiLyIgKyBsZXZl\nbDIgKyAiIDogIiArIGJrQWN0aXZlTGVkZ2Vycyk7CiAgICAgICAgfQoKICAg\nICAgICBkb0djKGdjLCBia0FjdGl2ZUxlZGdlcnMsIHprQWN0aXZlTGVkZ2Vy\ncyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEbyBnYXJiYWdlIGNvbGxlY3Rp\nbmcgY29tcGFyaW5nIGhvc3RlZCBsZWRnZXJzIGFuZCB6ayBsZWRnZXJzCiAg\nICAgKgogICAgICogQHBhcmFtIGdjCiAgICAgKiAgICAgICAgICBHYXJiYWdl\nIGNvbGxlY3RvcgogICAgICogQHBhcmFtIGJrQWN0aXZlTGVkZ2VycwogICAg\nICogICAgICAgICAgQWN0aXZlIGxlZGdlcnMgaG9zdGVkIGluIGJvb2tpZSBz\nZXJ2ZXIKICAgICAqIEBwYXJhbSB6a0FsbExlZGdlcnMKICAgICAqICAgICAg\nICAgIEFsbCBsZWRnZXJzIHN0b3JlZCBpbiB6b29rZWVwZXIKICAgICAqLwog\nICAgdm9pZCBkb0djKEdhcmJhZ2VDb2xsZWN0b3IgZ2MsIENvbmN1cnJlbnRN\nYXA8TG9uZywgQm9vbGVhbj4gYmtBY3RpdmVMZWRnZXJzLAogICAgICAgICAg\nICAgIEhhc2hTZXQ8TG9uZz4gemtBbGxMZWRnZXJzKSB7CiAgICAgICAgLy8g\ncmVtb3ZlIGFueSBhY3RpdmUgbGVkZ2VycyB0aGF0IGRvZXNuJ3QgZXhpc3Qg\naW4gemsKICAgICAgICBmb3IgKExvbmcgbGlkIDogYmtBY3RpdmVMZWRnZXJz\nLmtleVNldCgpKSB7CiAgICAgICAgICAgIGlmICghemtBbGxMZWRnZXJzLmNv\nbnRhaW5zKGxpZCkpIHsKICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBpdCBm\ncm9tIGN1cnJlbnQgYWN0aXZlIGxlZGdlcgogICAgICAgICAgICAgICAgYmtB\nY3RpdmVMZWRnZXJzLnJlbW92ZShsaWQpOwogICAgICAgICAgICAgICAgZ2Mu\nZ2MobGlkKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFByb2Nlc3MgbGlzdCBvbmUgYnkgb25lIGluIGFzeW5jaHJv\nbml6ZSB3YXkuIFByb2Nlc3Mgd2lsbCBiZSBzdG9wcGVkIGltbWVkaWF0ZWx5\nCiAgICAgKiB3aGVuIGVycm9yIG9jY3VycmVkLgogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBjbGFzcyBBc3luY0xpc3RQcm9jZXNzb3I8VD4gewogICAg\nICAgIC8vIHVzZSB0aGlzIHRvIHByZXZlbnQgbG9uZyBzdGFjayBjaGFpbnMg\nZnJvbSBidWlsZGluZyB1cCBpbiBjYWxsYmFja3MKICAgICAgICBTY2hlZHVs\nZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1bGVyOwoKICAgICAgICAvKioKICAg\nICAgICAgKiBDb25zdHJ1Y3RvcgogICAgICAgICAqCiAgICAgICAgICogQHBh\ncmFtIHNjaGVkdWxlcgogICAgICAgICAqICAgICAgICAgIEV4ZWN1dG9yIHVz\nZWQgdG8gcHJldmVudCBsb25nIHN0YWNrIGNoYWlucwogICAgICAgICAqLwog\nICAgICAgIHB1YmxpYyBBc3luY0xpc3RQcm9jZXNzb3IoU2NoZWR1bGVkRXhl\nY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcikgewogICAgICAgICAgICB0aGlzLnNj\naGVkdWxlciA9IHNjaGVkdWxlcjsKICAgICAgICB9CgogICAgICAgIC8qKgog\nICAgICAgICAqIFByb2Nlc3MgbGlzdCBvZiBpdGVtcwogICAgICAgICAqCiAg\nICAgICAgICogQHBhcmFtIGRhdGEKICAgICAgICAgKiAgICAgICAgICBMaXN0\nIG9mIGRhdGEgdG8gcHJvY2VzcwogICAgICAgICAqIEBwYXJhbSBwcm9jZXNz\nb3IKICAgICAgICAgKiAgICAgICAgICBDYWxsYmFjayB0byBwcm9jZXNzIGVs\nZW1lbnQgb2YgbGlzdCB3aGVuIHN1Y2Nlc3MKICAgICAgICAgKiBAcGFyYW0g\nZmluYWxDYgogICAgICAgICAqICAgICAgICAgIEZpbmFsIGNhbGxiYWNrIHRv\nIGJlIGNhbGxlZCBhZnRlciBhbGwgZWxlbWVudHMgaW4gdGhlIGxpc3QgYXJl\nIHByb2Nlc3NlZAogICAgICAgICAqIEBwYXJhbSBjb250eHQKICAgICAgICAg\nKiAgICAgICAgICBDb250ZXh0IG9mIGZpbmFsIGNhbGxiYWNrCiAgICAgICAg\nICogQHBhcmFtIHN1Y2Nlc3NSYwogICAgICAgICAqICAgICAgICAgIFJDIHBh\nc3NlZCB0byBmaW5hbCBjYWxsYmFjayBvbiBzdWNjZXNzCiAgICAgICAgICog\nQHBhcmFtIGZhaWx1cmVSYwogICAgICAgICAqICAgICAgICAgIFJDIHBhc3Nl\nZCB0byBmaW5hbCBjYWxsYmFjayBvbiBmYWlsdXJlCiAgICAgICAgICovCiAg\nICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhmaW5hbCBMaXN0PFQ+IGRhdGEs\nIGZpbmFsIFByb2Nlc3NvcjxUPiBwcm9jZXNzb3IsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFj\nayBmaW5hbENiLCBmaW5hbCBPYmplY3QgY29udGV4dCwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGZpbmFsIGludCBzdWNjZXNzUmMsIGZpbmFsIGlu\ndCBmYWlsdXJlUmMpIHsKICAgICAgICAgICAgaWYgKGRhdGEgPT0gbnVsbCB8\nfCBkYXRhLnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICBmaW5hbENi\nLnByb2Nlc3NSZXN1bHQoc3VjY2Vzc1JjLCBudWxsLCBjb250ZXh0KTsKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBmaW5hbCBpbnQgc2l6ZSA9IGRhdGEuc2l6ZSgpOwogICAgICAgICAgICBm\naW5hbCBBdG9taWNJbnRlZ2VyIGN1cnJlbnQgPSBuZXcgQXRvbWljSW50ZWdl\ncigwKTsKICAgICAgICAgICAgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sg\nc3R1YkNhbGxiYWNrID0gbmV3IEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNr\nKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBh\ndGgsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmMg\nIT0gc3VjY2Vzc1JjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRl\ncm1pbmFsIGltbWVkaWF0ZWx5CiAgICAgICAgICAgICAgICAgICAgICAgIGZp\nbmFsQ2IucHJvY2Vzc1Jlc3VsdChmYWlsdXJlUmMsIG51bGwsIGNvbnRleHQp\nOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIHByb2Nlc3MgbmV4\ndCBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgaW50IG5leHQgPSBjdXJy\nZW50LmluY3JlbWVudEFuZEdldCgpOwogICAgICAgICAgICAgICAgICAgIGlm\nIChuZXh0ID49IHNpemUpIHsgLy8gcmVhY2ggdGhlIGVuZCBvZiBsaXN0CiAg\nICAgICAgICAgICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jlc3VsdChz\ndWNjZXNzUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAgICAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIGZpbmFsIFQgZGF0YVRvUHJvY2VzcyA9IGRhdGEuZ2V0KG5l\neHQpOwogICAgICAgICAgICAgICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2su\nVm9pZENhbGxiYWNrIHN0dWIgPSB0aGlzOwogICAgICAgICAgICAgICAgICAg\nIHNjaGVkdWxlci5zdWJtaXQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAg\nICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAg\nICAgcHVibGljIGZpbmFsIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgcHJvY2Vzc29yLnByb2Nlc3MoZGF0YVRvUHJvY2Vzcywg\nc3R1Yik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsK\nICAgICAgICAgICAgVCBmaXJzdEVsZW1lbnQgPSBkYXRhLmdldCgwKTsKICAg\nICAgICAgICAgcHJvY2Vzc29yLnByb2Nlc3MoZmlyc3RFbGVtZW50LCBzdHVi\nQ2FsbGJhY2spOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

