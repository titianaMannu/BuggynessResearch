{"sha":"2a8df38b99bc15d7fe321e8c0e623f58e9d45296","node_id":"MDQ6QmxvYjE1NzU5NTY6MmE4ZGYzOGI5OWJjMTVkN2ZlMzIxZThjMGU2MjNmNThlOWQ0NTI5Ng==","size":18865,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2a8df38b99bc15d7fe321e8c0e623f58e9d45296","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvOwoKaW1wb3J0IGph\ndmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0\nQWRkcmVzczsKaW1wb3J0IGphdmEubmlvLkJ5dGVCdWZmZXI7CmltcG9ydCBq\nYXZhLm5pby5jaGFubmVscy5DYW5jZWxsZWRLZXlFeGNlcHRpb247CmltcG9y\ndCBqYXZhLm5pby5jaGFubmVscy5DaGFubmVsOwppbXBvcnQgamF2YS5uaW8u\nY2hhbm5lbHMuU2VsZWN0aW9uS2V5OwppbXBvcnQgamF2YS5uaW8uY2hhbm5l\nbHMuU2VsZWN0b3I7CmltcG9ydCBqYXZhLm5pby5jaGFubmVscy5TZXJ2ZXJT\nb2NrZXRDaGFubmVsOwppbXBvcnQgamF2YS5uaW8uY2hhbm5lbHMuU29ja2V0\nQ2hhbm5lbDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5MaW5rZWRCbG9j\na2luZ1F1ZXVlOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb247CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFRo\naXMgY2xhc3MgaGFuZGxlcyBjb21tdW5pY2F0aW9uIHdpdGggY2xpZW50cyB1\nc2luZyBOSU8uIFRoZXJlIGlzIG9uZSBDbnhuCiAqIHBlciBjbGllbnQsIGJ1\ndCBvbmx5IG9uZSB0aHJlYWQgZG9pbmcgdGhlIGNvbW11bmljYXRpb24uCiAq\nLwpwdWJsaWMgY2xhc3MgTklPU2VydmVyRmFjdG9yeSBleHRlbmRzIFRocmVh\nZCB7CgogICAgcHVibGljIGludGVyZmFjZSBQYWNrZXRQcm9jZXNzb3Igewog\nICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NQYWNrZXQoQnl0ZUJ1ZmZlciBw\nYWNrZXQsIENueG4gc3JjKTsKICAgIH0KCiAgICBTZXJ2ZXJTdGF0cyBzdGF0\ncyA9IG5ldyBTZXJ2ZXJTdGF0cygpOwoKICAgIExvZ2dlciBMT0cgPSBMb2dn\nZXJGYWN0b3J5LmdldExvZ2dlcihOSU9TZXJ2ZXJGYWN0b3J5LmNsYXNzKTsK\nCiAgICBTZXJ2ZXJTb2NrZXRDaGFubmVsIHNzOwoKICAgIFNlbGVjdG9yIHNl\nbGVjdG9yID0gU2VsZWN0b3Iub3BlbigpOwoKICAgIC8qKgogICAgICogV2Ug\ndXNlIHRoaXMgYnVmZmVyIHRvIGRvIGVmZmljaWVudCBzb2NrZXQgSS9PLiBT\naW5jZSB0aGVyZSBpcyBhIHNpbmdsZQogICAgICogc2VuZGVyIHRocmVhZCBw\nZXIgTklPU2VydmVyQ254biBpbnN0YW5jZSwgd2UgY2FuIHVzZSBhIG1lbWJl\nciB2YXJpYWJsZSB0bwogICAgICogb25seSBhbGxvY2F0ZSBpdCBvbmNlLgog\nICAgICovCiAgICBCeXRlQnVmZmVyIGRpcmVjdEJ1ZmZlciA9IEJ5dGVCdWZm\nZXIuYWxsb2NhdGVEaXJlY3QoNjQgKiAxMDI0KTsKCiAgICBIYXNoU2V0PENu\neG4+IGNueG5zID0gbmV3IEhhc2hTZXQ8Q254bj4oKTsKCiAgICBpbnQgb3V0\nc3RhbmRpbmdMaW1pdCA9IDIwMDA7CgogICAgUGFja2V0UHJvY2Vzc29yIHBy\nb2Nlc3NvcjsKCiAgICBsb25nIG1pbkxhdGVuY3kgPSA5OTk5OTk5OTsKCiAg\nICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmY7CgogICAgcHVibGljIE5JT1Nl\ncnZlckZhY3RvcnkoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLCBQYWNrZXRQ\ncm9jZXNzb3IgcHJvY2Vzc29yKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgIHN1cGVyKCJOSU9TZXJ2ZXJGYWN0b3J5Iik7CiAgICAgICAgc2V0RGFl\nbW9uKHRydWUpOwogICAgICAgIHRoaXMucHJvY2Vzc29yID0gcHJvY2Vzc29y\nOwogICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CiAgICAgICAgdGhpcy5zcyA9\nIFNlcnZlclNvY2tldENoYW5uZWwub3BlbigpOwogICAgICAgIHNzLnNvY2tl\ndCgpLmJpbmQobmV3IEluZXRTb2NrZXRBZGRyZXNzKGNvbmYuZ2V0Qm9va2ll\nUG9ydCgpKSk7CiAgICAgICAgc3MuY29uZmlndXJlQmxvY2tpbmcoZmFsc2Up\nOwogICAgICAgIHNzLnJlZ2lzdGVyKHNlbGVjdG9yLCBTZWxlY3Rpb25LZXku\nT1BfQUNDRVBUKTsKICAgICAgICBzdGFydCgpOwogICAgfQoKICAgIHB1Ymxp\nYyBJbmV0U29ja2V0QWRkcmVzcyBnZXRMb2NhbEFkZHJlc3MoKSB7CiAgICAg\nICAgcmV0dXJuIChJbmV0U29ja2V0QWRkcmVzcykgc3Muc29ja2V0KCkuZ2V0\nTG9jYWxTb2NrZXRBZGRyZXNzKCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIGFkZENueG4oQ254biBjbnhuKSB7CiAgICAgICAgc3luY2hyb25pemVkIChj\nbnhucykgewogICAgICAgICAgICBjbnhucy5hZGQoY254bik7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzUnVubmluZygpIHsKICAg\nICAgICByZXR1cm4gIXNzLnNvY2tldCgpLmlzQ2xvc2VkKCk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nd2hpbGUgKCFzcy5zb2NrZXQoKS5pc0Nsb3NlZCgpKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBzZWxlY3Rvci5zZWxlY3QoMTAwMCk7\nCiAgICAgICAgICAgICAgICBTZXQ8U2VsZWN0aW9uS2V5PiBzZWxlY3RlZDsK\nICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAg\nICAgICAgICAgICAgIHNlbGVjdGVkID0gc2VsZWN0b3Iuc2VsZWN0ZWRLZXlz\nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBBcnJheUxp\nc3Q8U2VsZWN0aW9uS2V5PiBzZWxlY3RlZExpc3QgPSBuZXcgQXJyYXlMaXN0\nPFNlbGVjdGlvbktleT4oc2VsZWN0ZWQpOwogICAgICAgICAgICAgICAgQ29s\nbGVjdGlvbnMuc2h1ZmZsZShzZWxlY3RlZExpc3QpOwogICAgICAgICAgICAg\nICAgZm9yIChTZWxlY3Rpb25LZXkgayA6IHNlbGVjdGVkTGlzdCkgewogICAg\nICAgICAgICAgICAgICAgIGlmICgoay5yZWFkeU9wcygpICYgU2VsZWN0aW9u\nS2V5Lk9QX0FDQ0VQVCkgIT0gMCkgewogICAgICAgICAgICAgICAgICAgICAg\nICBTb2NrZXRDaGFubmVsIHNjID0gKChTZXJ2ZXJTb2NrZXRDaGFubmVsKSBr\nLmNoYW5uZWwoKSkuYWNjZXB0KCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHNjLmNvbmZpZ3VyZUJsb2NraW5nKGZhbHNlKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgU2VsZWN0aW9uS2V5IHNrID0gc2MucmVnaXN0ZXIoc2VsZWN0\nb3IsIFNlbGVjdGlvbktleS5PUF9SRUFEKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgQ254biBjbnhuID0gbmV3IENueG4oc2MsIHNrKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgc2suYXR0YWNoKGNueG4pOwogICAgICAgICAgICAg\nICAgICAgICAgICBhZGRDbnhuKGNueG4pOwogICAgICAgICAgICAgICAgICAg\nIH0gZWxzZSBpZiAoKGsucmVhZHlPcHMoKSAmIChTZWxlY3Rpb25LZXkuT1Bf\nUkVBRCB8IFNlbGVjdGlvbktleS5PUF9XUklURSkpICE9IDApIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgQ254biBjID0gKENueG4pIGsuYXR0YWNobWVu\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICBjLmRvSU8oayk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgc2VsZWN0ZWQuY2xlYXIoKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIExPRy53YXJuKCJFeGNl\ncHRpb24gaW4gc2VydmVyIHNvY2tldCBsb29wOiAiICsgc3Muc29ja2V0KCku\nZ2V0SW5ldEFkZHJlc3MoKSwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgTE9HLmluZm8oIk5JT1NlcnZlckNueG4gZmFjdG9yeSBleGl0\nZWRsb29wLiIpOwogICAgICAgIGNsZWFyKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBjbGVhciBhbGwgdGhlIGNvbm5lY3Rpb25zIGluIHRoZSBzZWxlY3Rv\ncgogICAgICoKICAgICAqLwogICAgc3luY2hyb25pemVkIHB1YmxpYyB2b2lk\nIGNsZWFyKCkgewogICAgICAgIHNlbGVjdG9yLndha2V1cCgpOwogICAgICAg\nIHN5bmNocm9uaXplZCAoY254bnMpIHsKICAgICAgICAgICAgLy8gZ290IHRv\nIGNsZWFyIGFsbCB0aGUgY29ubmVjdGlvbnMgdGhhdCB3ZSBoYXZlIGluIHRo\nZSBzZWxlY3RvcgogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yPENueG4+IGl0\nID0gY254bnMuaXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOykgewogICAgICAg\nICAgICAgICAgQ254biBjbnhuID0gaXQubmV4dCgpOwogICAgICAgICAgICAg\nICAgaXQucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIGNueG4uY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8g\nRG8gbm90aGluZy4KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICB9CgogICAgcHVibGljIHZvaWQgc2h1dGRvd24oKSB7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3MuY2xvc2UoKTsKICAgICAg\nICAgICAgY2xlYXIoKTsKICAgICAgICAgICAgdGhpcy5pbnRlcnJ1cHQoKTsK\nICAgICAgICAgICAgdGhpcy5qb2luKCk7CiAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cud2Fybigi\nSW50ZXJydXB0ZWQiLCBlKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIlVuZXhwZWN0ZWQgZXhjZXB0\naW9uIiwgZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIGJ1ZmZlciB3aWxsIGNhdXNlIHRoZSBjb25uZWN0aW9uIHRvIGJlIGNsb3Nl\nIHdoZW4gd2UgZG8gYSBzZW5kLgogICAgICovCiAgICBzdGF0aWMgZmluYWwg\nQnl0ZUJ1ZmZlciBjbG9zZUNvbm4gPSBCeXRlQnVmZmVyLmFsbG9jYXRlKDAp\nOwoKICAgIHB1YmxpYyBjbGFzcyBDbnhuIHsKCiAgICAgICAgcHJpdmF0ZSBT\nb2NrZXRDaGFubmVsIHNvY2s7CgogICAgICAgIHByaXZhdGUgU2VsZWN0aW9u\nS2V5IHNrOwoKICAgICAgICBib29sZWFuIGluaXRpYWxpemVkOwoKICAgICAg\nICBCeXRlQnVmZmVyIGxlbkJ1ZmZlciA9IEJ5dGVCdWZmZXIuYWxsb2NhdGUo\nNCk7CgogICAgICAgIEJ5dGVCdWZmZXIgaW5jb21pbmdCdWZmZXIgPSBsZW5C\ndWZmZXI7CgogICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qnl0ZUJ1ZmZl\ncj4gb3V0Z29pbmdCdWZmZXJzID0gbmV3IExpbmtlZEJsb2NraW5nUXVldWU8\nQnl0ZUJ1ZmZlcj4oKTsKCiAgICAgICAgaW50IHNlc3Npb25UaW1lb3V0OwoK\nICAgICAgICBpbnQgcGFja2V0c1NlbnQ7CgogICAgICAgIGludCBwYWNrZXRz\nUmVjZWl2ZWQ7CgogICAgICAgIHZvaWQgZG9JTyhTZWxlY3Rpb25LZXkgaykg\ndGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGlmIChzb2NrID09IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICBpZiAoay5pc1JlYWRhYmxlKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBpbnQgcmMgPSBzb2NrLnJlYWQoaW5jb21pbmdCdWZmZXIpOwog\nICAgICAgICAgICAgICAgICAgIGlmIChyYyA8IDApIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJSZWFkIGVycm9y\nIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIGlmIChpbmNvbWluZ0J1ZmZlci5yZW1haW5pbmcoKSA9PSAwKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGluY29taW5nQnVmZmVyLmZsaXAoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGluY29taW5nQnVmZmVyID09IGxl\nbkJ1ZmZlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZExl\nbmd0aChrKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGNueG5TdGF0cy5wYWNrZXRzUmVj\nZWl2ZWQrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRzLmlu\nY3JlbWVudFBhY2tldHNSZWNlaXZlZCgpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICByZWFkUmVxdWVzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs\nZW5CdWZmZXIuY2xlYXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBpbmNvbWluZ0J1ZmZlciA9IGxlbkJ1ZmZlcjsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIGlmIChrLmlzV3JpdGFibGUoKSkgewogICAgICAgICAgICAg\nICAgICAgIGlmIChvdXRnb2luZ0J1ZmZlcnMuc2l6ZSgpID4gMCkgewogICAg\nICAgICAgICAgICAgICAgICAgICAvLyBab29Mb2cubG9nVHJhY2VNZXNzYWdl\nKExPRywKICAgICAgICAgICAgICAgICAgICAgICAgLy8gWm9vTG9nLkNMSUVO\nVF9EQVRBX1BBQ0tFVF9UUkFDRV9NQVNLLAogICAgICAgICAgICAgICAgICAg\nICAgICAvLyAic2sgIiArIGsgKyAiIGlzIHZhbGlkOiAiICsKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gay5pc1ZhbGlkKCkpOwoKICAgICAgICAgICAg\nICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAgICAgICAgICogVGhp\ncyBpcyBnb2luZyB0byByZXNldCB0aGUgYnVmZmVyIHBvc2l0aW9uIHRvIDAg\nYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAqIHRoZSBsaW1pdCB0byB0\naGUgc2l6ZSBvZiB0aGUgYnVmZmVyLCBzbyB0aGF0IHdlIGNhbgogICAgICAg\nICAgICAgICAgICAgICAgICAgKiBmaWxsIGl0IHdpdGggZGF0YSBmcm9tIHRo\nZSBub24tZGlyZWN0IGJ1ZmZlcnMgdGhhdCB3ZQogICAgICAgICAgICAgICAg\nICAgICAgICAgKiBuZWVkIHRvIHNlbmQuCiAgICAgICAgICAgICAgICAgICAg\nICAgICAqLwogICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RCdWZmZXIu\nY2xlYXIoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoQnl0ZUJ1\nZmZlciBiIDogb3V0Z29pbmdCdWZmZXJzKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoZGlyZWN0QnVmZmVyLnJlbWFpbmluZygpIDwgYi5y\nZW1haW5pbmcoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC8qCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV2hlbiB3\nZSBjYWxsIHB1dCBsYXRlciwgaWYgdGhlIGRpcmVjdEJ1ZmZlcgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAqIGlzIHRvIHNtYWxsIHRvIGhv\nbGQgZXZlcnl0aGluZywgbm90aGluZyB3aWxsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICogYmUgY29waWVkLCBzbyB3ZSd2ZSBnb3QgdG8g\nc2xpY2UgdGhlIGJ1ZmZlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAqIGlmIGl0J3MgdG9vIGJpZy4KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBiID0gKEJ5dGVCdWZmZXIpIGIuc2xpY2UoKS5saW1pdChkaXJlY3RCdWZm\nZXIucmVtYWluaW5nKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAqIHB1dCgpIGlzIGdvaW5nIHRvIG1vZGlmeSB0\naGUgcG9zaXRpb25zIG9mIGJvdGgKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAqIGJ1ZmZlcnMsIHB1dCB3ZSBkb24ndCB3YW50IHRvIGNoYW5nZSB0\naGUgcG9zaXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG9m\nIHRoZSBzb3VyY2UgYnVmZmVycyAod2UnbGwgZG8gdGhhdCBhZnRlciB0aGUK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHNlbmQsIGlmIG5lZWRl\nZCksIHNvIHdlIHNhdmUgYW5kIHJlc2V0IHRoZQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICogcG9zaXRpb24gYWZ0ZXIgdGhlIGNvcHkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgaW50IHAgPSBiLnBvc2l0aW9uKCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBkaXJlY3RCdWZmZXIucHV0KGIpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgYi5wb3NpdGlvbihwKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChkaXJlY3RCdWZmZXIucmVtYWluaW5nKCkg\nPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8qCiAgICAg\nICAgICAgICAgICAgICAgICAgICAqIERvIHRoZSBmbGlwOiBsaW1pdCBiZWNv\nbWVzIHBvc2l0aW9uLCBwb3NpdGlvbiBnZXRzCiAgICAgICAgICAgICAgICAg\nICAgICAgICAqIHNldCB0byAwLiBUaGlzIHNldHMgdXMgdXAgZm9yIHRoZSB3\ncml0ZS4KICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAg\nICAgICAgICAgICAgIGRpcmVjdEJ1ZmZlci5mbGlwKCk7CgogICAgICAgICAg\nICAgICAgICAgICAgICBpbnQgc2VudCA9IHNvY2sud3JpdGUoZGlyZWN0QnVm\nZmVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZUJ1ZmZlciBiYjsK\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgYnVmZmVy\ncyB0aGF0IHdlIGhhdmUgc2VudAogICAgICAgICAgICAgICAgICAgICAgICB3\naGlsZSAob3V0Z29pbmdCdWZmZXJzLnNpemUoKSA+IDApIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGJiID0gb3V0Z29pbmdCdWZmZXJzLnBlZWso\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYiA9PSBjbG9z\nZUNvbm4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSU9FeGNlcHRpb24oImNsb3NpbmciKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlu\ndCBsZWZ0ID0gYmIucmVtYWluaW5nKCkgLSBzZW50OwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGxlZnQgPiAwKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgKiBXZSBvbmx5IHBhcnRpYWxseSBzZW50IHRoaXMgYnVmZmVy\nLCBzbyB3ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHVw\nZGF0ZSB0aGUgcG9zaXRpb24gYW5kIGV4aXQgdGhlIGxvb3AuCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgYmIucG9zaXRpb24oYmIucG9zaXRpb24oKSArIHNl\nbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgY254blN0YXRzLnBhY2tldHNTZW50Kys7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAvKiBXZSd2ZSBzZW50IHRoZSB3aG9sZSBi\ndWZmZXIsIHNvIGRyb3AgdGhlIGJ1ZmZlciAqLwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgc2VudCAtPSBiYi5yZW1haW5pbmcoKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIFNlcnZlclN0YXRzLmdldEluc3RhbmNlKCku\naW5jcmVtZW50UGFja2V0c1NlbnQoKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIG91dGdvaW5nQnVmZmVycy5yZW1vdmUoKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAvLyBab29M\nb2cubG9nVHJhY2VNZXNzYWdlKExPRywKICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gWm9vTG9nLkNMSUVOVF9EQVRBX1BBQ0tFVF9UUkFDRV9NQVNLLCAi\nYWZ0ZXIgc2VuZCwKICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3V0Z29p\nbmdCdWZmZXJzLnNpemUoKSA9ICIgKyBvdXRnb2luZ0J1ZmZlcnMuc2l6ZSgp\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmIChvdXRnb2luZ0J1ZmZlcnMuc2l6ZSgpID09IDApIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGlmICghaW5pdGlhbGl6ZWQgJiYgKHNrLmlu\ndGVyZXN0T3BzKCkgJiBTZWxlY3Rpb25LZXkuT1BfUkVBRCkgPT0gMCkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4\nY2VwdGlvbigiUmVzcG9uZGVkIHRvIGluZm8gcHJvYmUiKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHNrLmludGVyZXN0T3BzKHNrLmludGVyZXN0T3BzKCkgJiAoflNlbGVj\ndGlvbktleS5PUF9XUklURSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2suaW50ZXJl\nc3RPcHMoc2suaW50ZXJlc3RPcHMoKSB8IFNlbGVjdGlvbktleS5PUF9XUklU\nRSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2gg\nKENhbmNlbGxlZEtleUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBj\nbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAvLyBMT0cuZXJyb3IoIkZJWE1TRyIsZSk7CiAg\nICAgICAgICAgICAgICBjbG9zZSgpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBwcml2YXRlIHZvaWQgcmVhZFJlcXVlc3QoKSB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgICAgICBpbmNvbWluZ0J1ZmZlciA9IGlu\nY29taW5nQnVmZmVyLnNsaWNlKCk7CiAgICAgICAgICAgIHByb2Nlc3Nvci5w\ncm9jZXNzUGFja2V0KGluY29taW5nQnVmZmVyLCB0aGlzKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIGRpc2FibGVSZWN2KCkgewogICAgICAg\nICAgICBzay5pbnRlcmVzdE9wcyhzay5pbnRlcmVzdE9wcygpICYgKH5TZWxl\nY3Rpb25LZXkuT1BfUkVBRCkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIHZvaWQgZW5hYmxlUmVjdigpIHsKICAgICAgICAgICAgaWYgKHNrLmlzVmFs\naWQoKSkgewogICAgICAgICAgICAgICAgaW50IGludGVyZXN0ID0gc2suaW50\nZXJlc3RPcHMoKTsKICAgICAgICAgICAgICAgIGlmICgoaW50ZXJlc3QgJiBT\nZWxlY3Rpb25LZXkuT1BfUkVBRCkgPT0gMCkgewogICAgICAgICAgICAgICAg\nICAgIHNrLmludGVyZXN0T3BzKGludGVyZXN0IHwgU2VsZWN0aW9uS2V5Lk9Q\nX1JFQUQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgcmVhZExlbmd0aChTZWxlY3Rp\nb25LZXkgaykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgLy8g\nUmVhZCB0aGUgbGVuZ3RoLCBub3cgZ2V0IHRoZSBidWZmZXIKICAgICAgICAg\nICAgaW50IGxlbiA9IGxlbkJ1ZmZlci5nZXRJbnQoKTsKICAgICAgICAgICAg\naWYgKGxlbiA8IDAgfHwgbGVuID4gMHhmZmZmZikgewogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJMZW4gZXJyb3IgIiArIGxlbik7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW5jb21pbmdCdWZmZXIgPSBC\neXRlQnVmZmVyLmFsbG9jYXRlKGxlbik7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIHJlcXVlc3RzIHRoYXQgaGF2\nZSBiZWVuIHN1Ym1pdHRlZCBidXQgbm90IHlldCByZXNwb25kZWQKICAgICAg\nICAgKiB0by4KICAgICAgICAgKi8KICAgICAgICBpbnQgb3V0c3RhbmRpbmdS\nZXF1ZXN0czsKCiAgICAgICAgLyoKICAgICAgICAgKiAobm9uLUphdmFkb2Mp\nCiAgICAgICAgICoKICAgICAgICAgKiBAc2VlIG9yZy5hcGFjaGUuem9va2Vl\ncGVyLnNlcnZlci5TZXJ2ZXJDbnhuSWZhY2UjZ2V0U2Vzc2lvblRpbWVvdXQo\nKQogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBpbnQgZ2V0U2Vzc2lvblRp\nbWVvdXQoKSB7CiAgICAgICAgICAgIHJldHVybiBzZXNzaW9uVGltZW91dDsK\nICAgICAgICB9CgogICAgICAgIFN0cmluZyBwZWVyTmFtZSA9IG51bGw7Cgog\nICAgICAgIHB1YmxpYyBDbnhuKFNvY2tldENoYW5uZWwgc29jaywgU2VsZWN0\naW9uS2V5IHNrKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICB0\naGlzLnNvY2sgPSBzb2NrOwogICAgICAgICAgICB0aGlzLnNrID0gc2s7CiAg\nICAgICAgICAgIHNvY2suc29ja2V0KCkuc2V0VGNwTm9EZWxheShjb25mLmdl\ndFNlcnZlclRjcE5vRGVsYXkoKSk7CiAgICAgICAgICAgIHNvY2suc29ja2V0\nKCkuc2V0U29MaW5nZXIodHJ1ZSwgMik7CiAgICAgICAgICAgIHNrLmludGVy\nZXN0T3BzKFNlbGVjdGlvbktleS5PUF9SRUFEKTsKICAgICAgICAgICAgaWYg\nKExPRy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBwZWVy\nTmFtZSA9IHNvY2suc29ja2V0KCkudG9TdHJpbmcoKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgbGVuQnVmZmVyLmNsZWFyKCk7CiAgICAgICAgICAg\nIGluY29taW5nQnVmZmVyID0gbGVuQnVmZmVyOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygp\nIHsKICAgICAgICAgICAgcmV0dXJuICJOSU9TZXJ2ZXJDbnhuIG9iamVjdCB3\naXRoIHNvY2sgPSAiICsgc29jayArICIgYW5kIHNrID0gIiArIHNrOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRQZWVyTmFtZSgpIHsK\nICAgICAgICAgICAgaWYgKHBlZXJOYW1lID09IG51bGwpIHsKICAgICAgICAg\nICAgICAgIHBlZXJOYW1lID0gc29jay5zb2NrZXQoKS50b1N0cmluZygpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBwZWVyTmFtZTsKICAg\nICAgICB9CgogICAgICAgIGJvb2xlYW4gY2xvc2VkOwoKICAgICAgICAvKgog\nICAgICAgICAqIChub24tSmF2YWRvYykKICAgICAgICAgKgogICAgICAgICAq\nIEBzZWUgb3JnLmFwYWNoZS56b29rZWVwZXIuc2VydmVyLlNlcnZlckNueG5J\nZmFjZSNjbG9zZSgpCiAgICAgICAgICovCiAgICAgICAgcHVibGljIHZvaWQg\nY2xvc2UoKSB7CiAgICAgICAgICAgIGlmIChjbG9zZWQpIHsKICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjbG9z\nZWQgPSB0cnVlOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKGNueG5zKSB7\nCiAgICAgICAgICAgICAgICBjbnhucy5yZW1vdmUodGhpcyk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgTE9HLmRlYnVnKCJjbG9zZSAgTklPU2VydmVy\nQ254bjogIiArIHNvY2spOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgLyoKICAgICAgICAgICAgICAgICAqIFRoZSBmb2xsb3dpbmcgc2Vx\ndWVuY2Ugb2YgY29kZSBpcyBzdHVwaWQhIFlvdSB3b3VsZCB0aGluawogICAg\nICAgICAgICAgICAgICogdGhhdCBvbmx5IHNvY2suY2xvc2UoKSBpcyBuZWVk\nZWQsIGJ1dCBhbGFzLCBpdCBkb2Vzbid0IHdvcmsKICAgICAgICAgICAgICAg\nICAqIHRoYXQgd2F5LiBJZiB5b3UganVzdCBkbyBzb2NrLmNsb3NlKCkgdGhl\ncmUgYXJlIGNhc2VzIHdoZXJlCiAgICAgICAgICAgICAgICAgKiB0aGUgc29j\na2V0IGRvZXNuJ3QgYWN0dWFsbHkgY2xvc2UuLi4KICAgICAgICAgICAgICAg\nICAqLwogICAgICAgICAgICAgICAgc29jay5zb2NrZXQoKS5zaHV0ZG93bk91\ndHB1dCgpOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgcmVsYXRpdmVseSBjb21t\nb24gZXhjZXB0aW9uIHRoYXQgd2UgY2FuJ3QgYXZvaWQKICAgICAgICAgICAg\nfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc29jay5zb2Nr\nZXQoKS5zaHV0ZG93bklucHV0KCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElP\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgc29jay5zb2NrZXQoKS5jbG9zZSgpOwogICAg\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICBMT0cuZXJyb3IoIkZJWE1TRyIsIGUpOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzb2NrLmNsb3NlKCk7\nCiAgICAgICAgICAgICAgICAvLyBYWFggVGhlIG5leHQgbGluZSBkb2Vzbid0\nIHNlZW0gdG8gYmUgbmVlZGVkLCBidXQgc29tZSBwb3N0cwogICAgICAgICAg\nICAgICAgLy8gdG8gZm9ydW1zIHN1Z2dlc3QgdGhhdCBpdCBpcyBuZWVkZWQu\nIEtlZXAgaW4gbWluZCBpZiBlcnJvcnMKICAgICAgICAgICAgICAgIC8vIGlu\nCiAgICAgICAgICAgICAgICAvLyB0aGlzIHNlY3Rpb24gYXJpc2UuCiAgICAg\nICAgICAgICAgICAvLyBmYWN0b3J5LnNlbGVjdG9yLndha2V1cCgpOwogICAg\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICBMT0cuZXJyb3IoIkZJWE1TRyIsIGUpOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHNvY2sgPSBudWxsOwogICAgICAgICAgICBpZiAoc2sgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAvLyBuZWVkIHRvIGNhbmNlbCB0aGlzIHNlbGVjdGlvbiBrZXkgZnJv\nbSB0aGUgc2VsZWN0b3IKICAgICAgICAgICAgICAgICAgICBzay5jYW5jZWwo\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIHByaXZhdGUgdm9pZCBtYWtlV3JpdGFibGUoU2VsZWN0aW9uS2V5IHNr\nKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzZWxlY3Rv\nci53YWtldXAoKTsKICAgICAgICAgICAgICAgIGlmIChzay5pc1ZhbGlkKCkp\nIHsKICAgICAgICAgICAgICAgICAgICBzay5pbnRlcmVzdE9wcyhzay5pbnRl\ncmVzdE9wcygpIHwgU2VsZWN0aW9uS2V5Lk9QX1dSSVRFKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIlByb2JsZW0gc2V0\ndGluZyB3cml0YWJsZSIsIGUpOwogICAgICAgICAgICAgICAgdGhyb3cgZTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lk\nIHNlbmRCdWZmZXJzKEJ5dGVCdWZmZXIgYmJbXSkgewogICAgICAgICAgICBC\neXRlQnVmZmVyIGxlbiA9IEJ5dGVCdWZmZXIuYWxsb2NhdGUoNCk7CiAgICAg\nICAgICAgIGludCB0b3RhbCA9IDA7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgYmIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlm\nIChiYltpXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgdG90YWwg\nKz0gYmJbaV0ucmVtYWluaW5nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgaWYgKExPRy5pc1RyYWNlRW5hYmxlZCgp\nKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoIlNlbmRpbmcgcmVzcG9u\nc2Ugb2Ygc2l6ZSAiICsgdG90YWwgKyAiIHRvICIgKyBwZWVyTmFtZSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgbGVuLnB1dEludCh0b3RhbCk7CiAg\nICAgICAgICAgIGxlbi5mbGlwKCk7CiAgICAgICAgICAgIG91dGdvaW5nQnVm\nZmVycy5hZGQobGVuKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBiYi5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGJiW2ld\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBvdXRnb2luZ0J1ZmZl\ncnMuYWRkKGJiW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgICAgICBtYWtlV3JpdGFibGUoc2spOwogICAgICAgIH0KCiAg\nICAgICAgc3luY2hyb25pemVkIHB1YmxpYyB2b2lkIHNlbmRSZXNwb25zZShC\neXRlQnVmZmVyLi4uIGJiKSB7CiAgICAgICAgICAgIGlmIChjbG9zZWQpIHsK\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBzZW5kQnVmZmVycyhiYik7CiAgICAgICAgICAgIHN5bmNocm9uaXpl\nZCAoTklPU2VydmVyRmFjdG9yeS50aGlzKSB7CiAgICAgICAgICAgICAgICBv\ndXRzdGFuZGluZ1JlcXVlc3RzLS07CiAgICAgICAgICAgICAgICAvLyBjaGVj\nayB0aHJvdHRsaW5nCiAgICAgICAgICAgICAgICBpZiAob3V0c3RhbmRpbmdS\nZXF1ZXN0cyA8IG91dHN0YW5kaW5nTGltaXQpIHsKICAgICAgICAgICAgICAg\nICAgICBzay5zZWxlY3RvcigpLndha2V1cCgpOwogICAgICAgICAgICAgICAg\nICAgIGVuYWJsZVJlY3YoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIEluZXRTb2NrZXRBZGRy\nZXNzIGdldFJlbW90ZUFkZHJlc3MoKSB7CiAgICAgICAgICAgIHJldHVybiAo\nSW5ldFNvY2tldEFkZHJlc3MpIHNvY2suc29ja2V0KCkuZ2V0UmVtb3RlU29j\na2V0QWRkcmVzcygpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBjbGFz\ncyBDbnhuU3RhdHMgewogICAgICAgICAgICBsb25nIHBhY2tldHNSZWNlaXZl\nZDsKCiAgICAgICAgICAgIGxvbmcgcGFja2V0c1NlbnQ7CgogICAgICAgICAg\nICAvKioKICAgICAgICAgICAgICogVGhlIG51bWJlciBvZiByZXF1ZXN0cyB0\naGF0IGhhdmUgYmVlbiBzdWJtaXR0ZWQgYnV0IG5vdCB5ZXQKICAgICAgICAg\nICAgICogcmVzcG9uZGVkIHRvLgogICAgICAgICAgICAgKi8KICAgICAgICAg\nICAgcHVibGljIGxvbmcgZ2V0T3V0c3RhbmRpbmdSZXF1ZXN0cygpIHsKICAg\nICAgICAgICAgICAgIHJldHVybiBvdXRzdGFuZGluZ1JlcXVlc3RzOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgbG9uZyBnZXRQYWNrZXRz\nUmVjZWl2ZWQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcGFja2V0c1Jl\nY2VpdmVkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgbG9u\nZyBnZXRQYWNrZXRzU2VudCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBw\nYWNrZXRzU2VudDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAg\nICAgICAgICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1\naWxkZXIoKTsKICAgICAgICAgICAgICAgIENoYW5uZWwgY2hhbm5lbCA9IHNr\nLmNoYW5uZWwoKTsKICAgICAgICAgICAgICAgIGlmIChjaGFubmVsIGluc3Rh\nbmNlb2YgU29ja2V0Q2hhbm5lbCkgewogICAgICAgICAgICAgICAgICAgIHNi\nLmFwcGVuZCgiICIpLmFwcGVuZCgoKFNvY2tldENoYW5uZWwpIGNoYW5uZWwp\nLnNvY2tldCgpLmdldFJlbW90ZVNvY2tldEFkZHJlc3MoKSkuYXBwZW5kKCJb\nIikKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKEludGVnZXIudG9IZXhT\ndHJpbmcoc2suaW50ZXJlc3RPcHMoKSkpLmFwcGVuZCgiXShxdWV1ZWQ9Iiku\nYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICBnZXRPdXRzdGFuZGlu\nZ1JlcXVlc3RzKCkpLmFwcGVuZCgiLHJlY3ZlZD0iKS5hcHBlbmQoZ2V0UGFj\na2V0c1JlY2VpdmVkKCkpLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICIsc2VudD0iKS5hcHBlbmQoZ2V0UGFja2V0c1NlbnQoKSkuYXBw\nZW5kKCIpXG4iKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIHJldHVybiBzYi50b1N0cmluZygpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBwcml2YXRlIENueG5TdGF0cyBjbnhuU3RhdHMgPSBuZXcg\nQ254blN0YXRzKCk7CgogICAgICAgIHB1YmxpYyBDbnhuU3RhdHMgZ2V0U3Rh\ndHMoKSB7CiAgICAgICAgICAgIHJldHVybiBjbnhuU3RhdHM7CiAgICAgICAg\nfQogICAgfQp9Cg==\n","encoding":"base64"}

