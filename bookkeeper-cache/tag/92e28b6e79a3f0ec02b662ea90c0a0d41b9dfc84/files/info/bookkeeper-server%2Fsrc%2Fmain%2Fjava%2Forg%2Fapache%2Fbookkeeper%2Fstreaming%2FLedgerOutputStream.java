{"sha":"967d27235659b912817ba62986ab1ba7d987bbd9","node_id":"MDQ6QmxvYjE1NzU5NTY6OTY3ZDI3MjM1NjU5YjkxMjgxN2JhNjI5ODZhYjFiYTdkOTg3YmJkOQ==","size":4561,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/967d27235659b912817ba62986ab1ba7d987bbd9","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLnN0cmVhbWluZzsK\nCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5P\ndXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLm5pby5CeXRlQnVmZmVyOwoKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhh\nbmRsZTsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyRmFjdG9yeTsKCi8qKgogKiB0aGlzIGNsYXNzIHByb3ZpZGVz\nIGEgc3RyZWFtaW5nIGFwaSB0byBnZXQgYW4gb3V0cHV0IHN0cmVhbSBmcm9t\nIGEgbGVkZ2VyCiAqIGhhbmRsZSBhbmQgd3JpdGUgdG8gaXQgYXMgYSBzdHJl\nYW0gb2YgYnl0ZXMuIFRoaXMgaXMgYnVpbHQgb24gdG9wIG9mCiAqIGxlZGdl\ncmhhbmRsZSBhcGkgYW5kIHVzZXMgYSBidWZmZXIgdG8gY2FjaGUgdGhlIGRh\ndGEgd3JpdHRlbiB0byBpdCBhbmQgd3JpdGVzCiAqIG91dCB0aGUgZW50cnkg\ndG8gdGhlIGxlZGdlci4KICovCnB1YmxpYyBjbGFzcyBMZWRnZXJPdXRwdXRT\ndHJlYW0gZXh0ZW5kcyBPdXRwdXRTdHJlYW0gewogICAgTG9nZ2VyIExPRyA9\nIExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKExlZGdlck91dHB1dFN0cmVhbS5j\nbGFzcyk7CiAgICBwcml2YXRlIExlZGdlckhhbmRsZSBsaDsKICAgIHByaXZh\ndGUgQnl0ZUJ1ZmZlciBieXRlYnVmZjsKICAgIGJ5dGVbXSBiYnl0ZXM7CiAg\nICBpbnQgZGVmYXVsdFNpemUgPSAxMDI0ICogMTAyNDsgLy8gMU1CIGRlZmF1\nbHQgc2l6ZQoKICAgIC8qKgogICAgICogY29uc3RydWN0IGEgb3V0cHV0c3Ry\nZWFtIGZyb20gYSBsZWRnZXIgaGFuZGxlCiAgICAgKgogICAgICogQHBhcmFt\nIGxoCiAgICAgKiAgICAgICAgICAgIGxlZGdlciBoYW5kbGUKICAgICAqLwog\nICAgcHVibGljIExlZGdlck91dHB1dFN0cmVhbShMZWRnZXJIYW5kbGUgbGgp\nIHsKICAgICAgICB0aGlzLmxoID0gbGg7CiAgICAgICAgYmJ5dGVzID0gbmV3\nIGJ5dGVbZGVmYXVsdFNpemVdOwogICAgICAgIHRoaXMuYnl0ZWJ1ZmYgPSBC\neXRlQnVmZmVyLndyYXAoYmJ5dGVzKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIGNvbnN0cnVjdCBhIG91dHB1dHN0cmVhbSBmcm9tIGEgbGVkZ2VyIGhhbmRs\nZQogICAgICoKICAgICAqIEBwYXJhbSBsaAogICAgICogICAgICAgICAgICB0\naGUgbGVkZ2VyIGhhbmRsZQogICAgICogQHBhcmFtIHNpemUKICAgICAqICAg\nICAgICAgICAgdGhlIHNpemUgb2YgdGhlIGJ1ZmZlcgogICAgICovCiAgICBw\ndWJsaWMgTGVkZ2VyT3V0cHV0U3RyZWFtKExlZGdlckhhbmRsZSBsaCwgaW50\nIHNpemUpIHsKICAgICAgICB0aGlzLmxoID0gbGg7CiAgICAgICAgYmJ5dGVz\nID0gbmV3IGJ5dGVbc2l6ZV07CiAgICAgICAgdGhpcy5ieXRlYnVmZiA9IEJ5\ndGVCdWZmZXIud3JhcChiYnl0ZXMpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgLy8gZmx1c2ggZXZl\ncnl0aGluZwogICAgICAgIC8vIHdlIGhhdmUKICAgICAgICBmbHVzaCgpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHN5bmNocm9uaXplZCB2\nb2lkIGZsdXNoKCkgewogICAgICAgIC8vIGxldHMgZmx1c2ggYWxsIHRoZSBk\nYXRhCiAgICAgICAgLy8gaW50byB0aGUgbGVkZ2VyIGVudHJ5CiAgICAgICAg\naWYgKGJ5dGVidWZmLnBvc2l0aW9uKCkgPiAwKSB7CiAgICAgICAgICAgIC8v\nIGNvcHkgdGhlIGJ5dGVzIGludG8KICAgICAgICAgICAgLy8gYSBuZXcgYnl0\nZSBidWZmZXIgYW5kIHNlbmQgaXQgb3V0CiAgICAgICAgICAgIGJ5dGVbXSBi\nID0gbmV3IGJ5dGVbYnl0ZWJ1ZmYucG9zaXRpb24oKV07CiAgICAgICAgICAg\nIExPRy5pbmZvKCJDb21tZW50OiBmbHVzaGluZyB3aXRoIHBhcmFtcyAiICsg\nIiAiICsgYnl0ZWJ1ZmYucG9zaXRpb24oKSk7CiAgICAgICAgICAgIFN5c3Rl\nbS5hcnJheWNvcHkoYmJ5dGVzLCAwLCBiLCAwLCBieXRlYnVmZi5wb3NpdGlv\nbigpKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxoLmFk\nZEVudHJ5KGIpOwogICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAgTE9HLndhcm4oIkludGVy\ncnVwdGVkIHdoaWxlIGZsdXNpbmcgIiArIGllKTsKICAgICAgICAgICAgICAg\nIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEJLRXhjZXB0aW9uIGJrZSkgewogICAgICAgICAgICAg\nICAgTE9HLndhcm4oIkJvb2tLZWVwZXIgZXhjZXB0aW9uICIsIGJrZSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBt\nYWtlIHNwYWNlIGZvciBsZW4gYnl0ZXMgdG8gYmUgd3JpdHRlbiB0byB0aGUg\nYnVmZmVyLgogICAgICoKICAgICAqIEBwYXJhbSBsZW4KICAgICAqIEByZXR1\ncm4gaWYgdHJ1ZSB0aGVuIHdlIGNhbiBtYWtlIHNwYWNlIGZvciBsZW4gaWYg\nZmFsc2Ugd2UgY2Fubm90CiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBt\nYWtlU3BhY2UoaW50IGxlbikgewogICAgICAgIGlmIChieXRlYnVmZi5yZW1h\naW5pbmcoKSA8IGxlbikgewogICAgICAgICAgICBmbHVzaCgpOwogICAgICAg\nICAgICBieXRlYnVmZi5jbGVhcigpOwogICAgICAgICAgICBpZiAoYnl0ZWJ1\nZmYuY2FwYWNpdHkoKSA8IGxlbikgewogICAgICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHN5bmNo\ncm9uaXplZCB2b2lkIHdyaXRlKGJ5dGVbXSBiKSB7CiAgICAgICAgaWYgKG1h\na2VTcGFjZShiLmxlbmd0aCkpIHsKICAgICAgICAgICAgYnl0ZWJ1ZmYucHV0\nKGIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBsaC5hZGRFbnRyeShiKTsKICAgICAgICAgICAgfSBjYXRj\naCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAg\nIExPRy53YXJuKCJJbnRlcnJ1cHRlZCB3aGlsZSB3cml0aW5nIiwgaWUpOwog\nICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5pbnRlcnJ1\ncHQoKTsKICAgICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24gYmtlKSB7\nCiAgICAgICAgICAgICAgICBMT0cud2FybigiQm9va0tlZXBlciBleGNlcHRp\nb24iLCBia2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIHdyaXRl\nKGJ5dGVbXSBiLCBpbnQgb2ZmLCBpbnQgbGVuKSB7CiAgICAgICAgaWYgKCFt\nYWtlU3BhY2UobGVuKSkgewogICAgICAgICAgICAvLyBsZXRzIHRyeSBtYWtp\nbmcgdGhlIGJ1ZmZlciBiaWdnZXIKICAgICAgICAgICAgYmJ5dGVzID0gbmV3\nIGJ5dGVbbGVuXTsKICAgICAgICAgICAgYnl0ZWJ1ZmYgPSBCeXRlQnVmZmVy\nLndyYXAoYmJ5dGVzKTsKICAgICAgICB9CiAgICAgICAgYnl0ZWJ1ZmYucHV0\nKGIsIG9mZiwgbGVuKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBzeW5jaHJvbml6ZWQgdm9pZCB3cml0ZShpbnQgYikgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBtYWtlU3BhY2UoMSk7CiAgICAgICAgYnl0ZSBv\nbmVCID0gKGJ5dGUpIChiICYgMHhGRik7CiAgICAgICAgYnl0ZWJ1ZmYucHV0\nKG9uZUIpOwogICAgfQp9Cg==\n","encoding":"base64"}

