{"sha":"3a0e261b318c61f471141c51b97ca4169886d325","node_id":"MDQ6QmxvYjE1NzU5NTY6M2EwZTI2MWIzMThjNjFmNDcxMTQxYzUxYjk3Y2E0MTY5ODg2ZDMyNQ==","size":4575,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/3a0e261b318c61f471141c51b97ca4169886d325","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEubmV0LkluZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQg\namF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJy\nZW50LlNlbWFwaG9yZTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0\nb21pYy5BdG9taWNJbnRlZ2VyOwppbXBvcnQgamF2YS5zZWN1cml0eS5HZW5l\ncmFsU2VjdXJpdHlFeGNlcHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmJvb2tpZS5Cb29raWU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuYm9va2llLkJvb2tpZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5ib29raWUuTGVkZ2VyRW50cnlQYWdlOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTWFjRGln\nZXN0TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuV3JpdGVDYWxsYmFjazsK\naW1wb3J0IG9yZy5qdW5pdC5BZnRlcjsKaW1wb3J0IG9yZy5qdW5pdC5CZWZv\ncmU7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKCmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBv\ncnQganVuaXQuZnJhbWV3b3JrLlRlc3RDYXNlOwoKLyoqCiAqIFRlc3RzIHdy\naXRpbmcgdG8gY29uY3VycmVudCBsZWRnZXJzCiAqLwpwdWJsaWMgY2xhc3Mg\nTGVkZ2VyQ2FjaGVUZXN0IGV4dGVuZHMgVGVzdENhc2UgewogICAgc3RhdGlj\nIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMZWRnZXJD\nYWNoZVRlc3QuY2xhc3MpOwoKICAgIEJvb2tpZSBib29raWU7CiAgICBTZXJ2\nZXJDb25maWd1cmF0aW9uIGNvbmY7CiAgICBGaWxlIHR4bkRpciwgbGVkZ2Vy\nRGlyOwoKICAgIGNsYXNzIFRlc3RXcml0ZUNhbGxiYWNrIGltcGxlbWVudHMg\nV3JpdGVDYWxsYmFjayB7CiAgICAgICAgcHVibGljIHZvaWQgd3JpdGVDb21w\nbGV0ZShpbnQgcmMsIGxvbmcgbGVkZ2VySWQsIGxvbmcgZW50cnlJZCwgSW5l\ndFNvY2tldEFkZHJlc3MgYWRkciwgT2JqZWN0IGN0eCkgewogICAgICAgICAg\nICBMT0cuaW5mbygiQWRkZWQgZW50cnk6ICIgKyByYyArICIsICIgKyBsZWRn\nZXJJZCArICIsICIgKyBlbnRyeUlkICsgIiwgIiArIGFkZHIpOwogICAgICAg\nIH0KICAgIH0KCgogICAgQE92ZXJyaWRlCiAgICBAQmVmb3JlCiAgICBwdWJs\naWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN0\ncmluZyB0eG5EaXJOYW1lID0gU3lzdGVtLmdldFByb3BlcnR5KCJ0eG5EaXIi\nKTsKICAgICAgICBpZiAodHhuRGlyTmFtZSAhPSBudWxsKSB7CiAgICAgICAg\nICAgIHR4bkRpciA9IG5ldyBGaWxlKHR4bkRpck5hbWUpOwogICAgICAgIH0K\nICAgICAgICBTdHJpbmcgbGVkZ2VyRGlyTmFtZSA9IFN5c3RlbS5nZXRQcm9w\nZXJ0eSgibGVkZ2VyRGlyIik7CiAgICAgICAgaWYgKGxlZGdlckRpck5hbWUg\nIT0gbnVsbCkgewogICAgICAgICAgICBsZWRnZXJEaXIgPSBuZXcgRmlsZShs\nZWRnZXJEaXJOYW1lKTsKICAgICAgICB9CiAgICAgICAgRmlsZSB0bXBGaWxl\nID0gRmlsZS5jcmVhdGVUZW1wRmlsZSgiYm9vayIsICIudHhuIiwgdHhuRGly\nKTsKICAgICAgICB0bXBGaWxlLmRlbGV0ZSgpOwogICAgICAgIHR4bkRpciA9\nIG5ldyBGaWxlKHRtcEZpbGUuZ2V0UGFyZW50KCksIHRtcEZpbGUuZ2V0TmFt\nZSgpKyIuZGlyIik7CiAgICAgICAgdHhuRGlyLm1rZGlycygpOwogICAgICAg\nIHRtcEZpbGUgPSBGaWxlLmNyZWF0ZVRlbXBGaWxlKCJib29rIiwgIi5sZWRn\nZXIiLCBsZWRnZXJEaXIpOwogICAgICAgIGxlZGdlckRpciA9IG5ldyBGaWxl\nKHRtcEZpbGUuZ2V0UGFyZW50KCksIHRtcEZpbGUuZ2V0TmFtZSgpKyIuZGly\nIik7CiAgICAgICAgbGVkZ2VyRGlyLm1rZGlycygpOwoKICAgICAgICBjb25m\nID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oKTsKICAgICAgICBjb25mLnNl\ndEJvb2tpZVBvcnQoNTAwMCk7CiAgICAgICAgY29uZi5zZXRaa1NlcnZlcnMo\nbnVsbCk7CiAgICAgICAgY29uZi5zZXRKb3VybmFsRGlyTmFtZSh0eG5EaXIu\nZ2V0UGF0aCgpKTsKICAgICAgICBjb25mLnNldExlZGdlckRpck5hbWVzKG5l\ndyBTdHJpbmdbXSB7IGxlZGdlckRpci5nZXRQYXRoKCkgfSk7CiAgICAgICAg\nYm9va2llID0gbmV3IEJvb2tpZShjb25mKTsKICAgIH0KCgogICAgQE92ZXJy\naWRlCiAgICBAQWZ0ZXIKICAgIHB1YmxpYyB2b2lkIHRlYXJEb3duKCkgewog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGJvb2tpZS5zaHV0ZG93bigpOwog\nICAgICAgICAgICByZWN1cnNpdmVEZWxldGUodHhuRGlyKTsKICAgICAgICAg\nICAgcmVjdXJzaXZlRGVsZXRlKGxlZGdlckRpcik7CiAgICAgICAgfSBjYXRj\naCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cu\nZXJyb3IoIkVycm9yIHRlYXJpbmcgZG93biIsIGUpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFJlY3Vyc2l2ZWx5IGRlbGV0ZXMgYSBkaXJl\nY3RvcnkuIFRoaXMgaXMgYSBkdXBsaWNhdGlvbiBvZiBCb29raWVDbGllbnRU\nZXN0LgogICAgICoKICAgICAqIEBwYXJhbSBkaXIKICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgdm9pZCByZWN1cnNpdmVEZWxldGUoRmlsZSBkaXIpIHsK\nICAgICAgICBGaWxlIGNoaWxkcmVuW10gPSBkaXIubGlzdEZpbGVzKCk7CiAg\nICAgICAgaWYgKGNoaWxkcmVuICE9IG51bGwpIHsKICAgICAgICAgICAgZm9y\nIChGaWxlIGNoaWxkIDogY2hpbGRyZW4pIHsKICAgICAgICAgICAgICAgIHJl\nY3Vyc2l2ZURlbGV0ZShjaGlsZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgZGlyLmRlbGV0ZSgpOwogICAgfQoKICAgIEBUZXN0CiAgICBw\ndWJsaWMgdm9pZCB0ZXN0QWRkRW50cnlFeGNlcHRpb24oKQogICAgICAgICAg\nICB0aHJvd3MgR2VuZXJhbFNlY3VyaXR5RXhjZXB0aW9uLCBCb29raWVFeGNl\ncHRpb24gewogICAgICAgIC8qCiAgICAgICAgICogUG9wdWxhdGUgbGVkZ2Vy\nIGNhY2hlCiAgICAgICAgICovCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYnl0ZVtdIG1hc3RlcktleSA9ICJibGFoIi5nZXRCeXRlcygpOwogICAgICAg\nICAgICBmb3IoIGludCBpID0gMDsgaSA8IDMwMDAwOyBpKyspIHsKICAgICAg\nICAgICAgICAgIE1hY0RpZ2VzdE1hbmFnZXIgZG0gPSBuZXcgTWFjRGlnZXN0\nTWFuYWdlcihpLCBtYXN0ZXJLZXkpOwogICAgICAgICAgICAgICAgYnl0ZVtd\nIGRhdGEgPSAiMDEyMzQ1Njc4OSIuZ2V0Qnl0ZXMoKTsKICAgICAgICAgICAg\nICAgIEJ5dGVCdWZmZXIgZW50cnkgPSBkbS5jb21wdXRlRGlnZXN0QW5kUGFj\na2FnZUZvclNlbmRpbmcoMCwgMCwgMTAsIGRhdGEsIDAsIGRhdGEubGVuZ3Ro\nKS50b0J5dGVCdWZmZXIoKTsKICAgICAgICAgICAgICAgIGJvb2tpZS5hZGRF\nbnRyeShlbnRyeSwgbmV3IFRlc3RXcml0ZUNhbGxiYWNrKCksIG51bGwsIG1h\nc3RlcktleSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiR290IElPRXhj\nZXB0aW9uLiIsIGUpOwogICAgICAgICAgICBmYWlsKCJGYWlsZWQgdG8gYWRk\nIGVudHJ5LiIpOwogICAgICAgIH0KICAgIH0KCn0K\n","encoding":"base64"}

