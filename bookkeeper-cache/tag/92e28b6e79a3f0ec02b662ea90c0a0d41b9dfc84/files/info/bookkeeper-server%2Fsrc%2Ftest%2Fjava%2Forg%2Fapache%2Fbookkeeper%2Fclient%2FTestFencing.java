{"sha":"e1e8449eeb99d21172982dfde45f88146756d0fd","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTFlODQ0OWVlYjk5ZDIxMTcyOTgyZGZkZTQ1Zjg4MTQ2NzU2ZDBmZA==","size":11893,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e1e8449eeb99d21172982dfde45f88146756d0fd","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCgpp\nbXBvcnQgb3JnLmp1bml0Lio7CmltcG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0\nQWRkcmVzczsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkN5Y2xpY0JhcnJpZXI7CmltcG9ydCBq\nYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkNsaWVudENvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhh\nbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVk\nZ2VyRW50cnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50\nLkJvb2tLZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xp\nZW50LkJvb2tLZWVwZXJBZG1pbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJhc2VUZXN0Q2FzZTsKCmlt\ncG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\nckZhY3Rvcnk7CgovKioKICogVGhpcyB1bml0IHRlc3QgdGVzdHMgbGVkZ2Vy\nIGZlbmNpbmc7CiAqCiAqLwpwdWJsaWMgY2xhc3MgVGVzdEZlbmNpbmcgZXh0\nZW5kcyBCYXNlVGVzdENhc2UgewogICAgc3RhdGljIExvZ2dlciBMT0cgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihUZXN0RmVuY2luZy5jbGFzcyk7Cgog\nICAgRGlnZXN0VHlwZSBkaWdlc3RUeXBlOwoKICAgIHB1YmxpYyBUZXN0RmVu\nY2luZyhEaWdlc3RUeXBlIGRpZ2VzdFR5cGUpIHsKICAgICAgICBzdXBlcigx\nMCk7CiAgICAgICAgdGhpcy5kaWdlc3RUeXBlID0gZGlnZXN0VHlwZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEJhc2ljIGZlbmNpbmcgdGVzdC4gQ3JlYXRl\nIGxlZGdlciwgd3JpdGUgdG8gaXQsCiAgICAgKiBvcGVuIGxlZGdlciwgd3Jp\ndGUgYWdhaW4gKHNob3VsZCBmYWlsKS4KICAgICAqLwogICAgQFRlc3QKICAg\nIHB1YmxpYyB2b2lkIHRlc3RCYXNpY0ZlbmNpbmcoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICAvKgogICAgICAgICAqIENyZWF0ZSBsZWRnZXIuCiAg\nICAgICAgICovCiAgICAgICAgTGVkZ2VySGFuZGxlIHdyaXRlbGggPSBudWxs\nOwogICAgICAgIHdyaXRlbGggPSBia2MuY3JlYXRlTGVkZ2VyKGRpZ2VzdFR5\ncGUsICIiLmdldEJ5dGVzKCkpOwoKICAgICAgICBTdHJpbmcgdG1wID0gIkJv\nb2tLZWVwZXIgaXMgY29vbCEiOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgMTA7IGkrKykgewogICAgICAgICAgICB3cml0ZWxoLmFkZEVudHJ5KHRt\ncC5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAgICAgIC8qCiAgICAgICAg\nICogVHJ5IHRvIG9wZW4gbGVkZ2VyLgogICAgICAgICAqLwogICAgICAgIExl\nZGdlckhhbmRsZSByZWFkbGggPSBia2Mub3BlbkxlZGdlcih3cml0ZWxoLmdl\ndElkKCksIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIC8v\nIHNob3VsZCBoYXZlIHRyaWdnZXJlZCByZWNvdmVyeSBhbmQgZmVuY2luZwog\nICAgICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlbGguYWRk\nRW50cnkodG1wLmdldEJ5dGVzKCkpOwogICAgICAgICAgICBMT0cuZXJyb3Io\nIlNob3VsZCBoYXZlIHRocm93biBhbiBleGNlcHRpb24iKTsKICAgICAgICAg\nICAgZmFpbCgiU2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiB3aGVu\nIHRyeWluZyB0byB3cml0ZSIpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0\naW9uLkJLTGVkZ2VyRmVuY2VkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nLy8gY29ycmVjdCBiZWhhdmlvdXIKICAgICAgICB9CiAgICAgICAgICAgICAg\nICAKICAgICAgICAvKgogICAgICAgICAqIENoZWNrIGlmIGhhcyByZWNvdmVy\nZWQgcHJvcGVybHkuCiAgICAgICAgICovCiAgICAgICAgYXNzZXJ0VHJ1ZSgi\nSGFzIG5vdCByZWNvdmVyZWQgY29ycmVjdGx5OiAiICsgcmVhZGxoLmdldExh\nc3RBZGRDb25maXJtZWQoKSAKICAgICAgICAgICAgICAgICAgICsgIiBvcmln\naW5hbCAiICsgd3JpdGVsaC5nZXRMYXN0QWRkQ29uZmlybWVkKCksCiAgICAg\nICAgICAgICAgICAgICByZWFkbGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpID09\nIHdyaXRlbGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpKTsKICAgIH0KCiAgICBw\ncml2YXRlIHN0YXRpYyBpbnQgdGhyZWFkQ291bnQgPSAwOwoKICAgIGNsYXNz\nIExlZGdlck9wZW5UaHJlYWQgZXh0ZW5kcyBUaHJlYWQgewogICAgICAgIHBy\naXZhdGUgZmluYWwgbG9uZyBsZWRnZXJJZDsKICAgICAgICBwcml2YXRlIGxv\nbmcgbGFzdENvbmZpcm1lZEVudHJ5ID0gMDsKCiAgICAgICAgCiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBEaWdlc3RUeXBlIGRpZ2VzdFR5cGU7CiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBDeWNsaWNCYXJyaWVyIGJhcnJpZXI7CgogICAgICAg\nIExlZGdlck9wZW5UaHJlYWQgKERpZ2VzdFR5cGUgZGlnZXN0VHlwZSwgbG9u\nZyBsZWRnZXJJZCwgQ3ljbGljQmFycmllciBiYXJyaWVyKQogICAgICAgICAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHN1cGVyKCJU\nZXN0RmVuY2luZy1MZWRnZXJPcGVuVGhyZWFkLSIgKyB0aHJlYWRDb3VudCsr\nKTsKICAgICAgICAgICAgdGhpcy5sZWRnZXJJZCA9IGxlZGdlcklkOwogICAg\nICAgICAgICB0aGlzLmRpZ2VzdFR5cGUgPSBkaWdlc3RUeXBlOwogICAgICAg\nICAgICB0aGlzLmJhcnJpZXIgPSBiYXJyaWVyOwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgIExlZGdlckhhbmRsZSBsaCA9IG51bGw7CiAgICAg\nICAgICAgIEJvb2tLZWVwZXIgYmsgPSBudWxsOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgYmFycmllci5hd2FpdCgpOwogICAgICAgICAg\nICAgICAgd2hpbGUodHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJrID0gbmV3IEJvb2tLZWVwZXIo\nbmV3IENsaWVudENvbmZpZ3VyYXRpb24oYmFzZUNsaWVudENvbmYpLCBia2Mu\nZ2V0WmtIYW5kbGUoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAg\nICAgICAgICAgICAgICAgICAgICBsaCA9IGJrLm9wZW5MZWRnZXIobGVkZ2Vy\nSWQsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGxhc3RDb25maXJtZWRFbnRyeSA9IGxoLmdldExhc3RBZGRD\nb25maXJtZWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGguY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24uWktFeGNlcHRpb24gemtl\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJDb250ZW50\naW9uIHdpdGggc29tZW9uZSBlbHNlIHJlY292ZXJpbmciKTsKICAgICAgICAg\nICAgICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5CS0xlZGdlclJlY292\nZXJ5RXhjZXB0aW9uIGJrcmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nTE9HLmluZm8oIkNvbnRlbnRpb24gd2l0aCBzb21lb25lIGVsc2UgcmVjb3Zl\ncmluZyIpOwogICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChsaCAhPSBudWxsKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBsaC5jbG9zZSgpOwogICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiayAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiay5jbG9z\nZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmsgPSBudWxsOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8ganVzdCBleGl0LCB0ZXN0\nIHNob3VsZCBzcG90IGJhZCBsYXN0IGFkZCBjb25maXJtZWQKICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiRXhjZXB0aW9uIG9jY3VycmVkICIsIGUpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIExPRy5pbmZvKCJUaHJlYWQgZXhp\ndGluZywgbGFzdENvbmZpcm1lZEVudHJ5ID0gIiArIGxhc3RDb25maXJtZWRF\nbnRyeSk7CiAgICAgICAgfQoKICAgICAgICBsb25nIGdldExhc3RDb25maXJt\nZWRFbnRyeSgpIHsKICAgICAgICAgICAgcmV0dXJuIGxhc3RDb25maXJtZWRF\nbnRyeTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcnkgdG8g\nb3BlbiBhIGxlZGdlciBtYW55IHRpbWVzIGluIHBhcmFsbGVsLgogICAgICog\nQWxsIG9wZW5zIHNob3VsZCByZXN1bHQgaW4gYSBsZWRnZXIgd2l0aCBhbiBl\ncXVhbHMgbnVtYmVyIG9mIAogICAgICogZW50cmllcy4KICAgICAqLwogICAg\nQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RNYW55T3BlblBhcmFsbGVsKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLyoKICAgICAgICAgKiBDcmVh\ndGUgbGVkZ2VyLgogICAgICAgICAqLwogICAgICAgIGZpbmFsIExlZGdlckhh\nbmRsZSB3cml0ZWxoID0gYmtjLmNyZWF0ZUxlZGdlcihkaWdlc3RUeXBlLCAi\nIi5nZXRCeXRlcygpKTsKCiAgICAgICAgZmluYWwgU3RyaW5nIHRtcCA9ICJC\nb29rS2VlcGVyIGlzIGNvb2whIjsKICAgICAgICBmaW5hbCBDb3VudERvd25M\nYXRjaCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxMDApOwogICAgICAg\nIFRocmVhZCB3cml0ZXRocmVhZCA9IG5ldyBUaHJlYWQoKSB7CiAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRydWUp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlbGguYWRkRW50\ncnkodG1wLmdldEJ5dGVzKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbGF0Y2guY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiRXhjZXB0aW9u\nIGFkZGluZyBlbnRyeSIsIGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB3cml0ZXRo\ncmVhZC5zdGFydCgpOwoKICAgICAgICBmaW5hbCBpbnQgbnVtUmVjb3Zlcnkg\nPSAxMDA7CiAgICAgICAgQ3ljbGljQmFycmllciBiYXJyaWVyID0gbmV3IEN5\nY2xpY0JhcnJpZXIobnVtUmVjb3ZlcnkrMSk7CiAgICAgICAgTGVkZ2VyT3Bl\nblRocmVhZCB0aHJlYWRzW10gPSBuZXcgTGVkZ2VyT3BlblRocmVhZFtudW1S\nZWNvdmVyeV07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1SZWNv\ndmVyeTsgaSsrKSB7CiAgICAgICAgICAgIHRocmVhZHNbaV0gPSBuZXcgTGVk\nZ2VyT3BlblRocmVhZChkaWdlc3RUeXBlLCB3cml0ZWxoLmdldElkKCksIGJh\ncnJpZXIpOwogICAgICAgICAgICB0aHJlYWRzW2ldLnN0YXJ0KCk7CiAgICAg\nICAgfQogICAgICAgIGxhdGNoLmF3YWl0KCk7CiAgICAgICAgYmFycmllci5h\nd2FpdCgpOyAvLyBzaG91bGQgdHJpZ2dlciB0aHJlYWRzIHRvIGdvCgogICAg\nICAgIHdyaXRldGhyZWFkLmpvaW4oKTsKICAgICAgICBsb25nIGxhc3RDb25m\naXJtZWQgPSB3cml0ZWxoLmdldExhc3RBZGRDb25maXJtZWQoKTsKICAgICAg\nICAKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bVJlY292ZXJ5OyBp\nKyspIHsKICAgICAgICAgICAgdGhyZWFkc1tpXS5qb2luKCk7CiAgICAgICAg\nICAgIGFzc2VydFRydWUoIkFkZGVkIGNvbmZpcm1lZCBpcyBpbmNvcnJlY3Qi\nLCAKICAgICAgICAgICAgICAgICAgICAgICBsYXN0Q29uZmlybWVkIDw9IHRo\ncmVhZHNbaV0uZ2V0TGFzdENvbmZpcm1lZEVudHJ5KCkpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgdGhhdCBvcGVuaW5nIGEgbGVk\nZ2VyIGluIG5vcmVjb3ZlcnkgbW9kZQogICAgICogZG9lc24ndCBmZW5jZSBv\nZmYgYSBsZWRnZXIKICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lk\nIHRlc3ROb1JlY292ZXJ5T3BlbigpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIC8qCiAgICAgICAgICogQ3JlYXRlIGxlZGdlci4KICAgICAgICAgKi8K\nICAgICAgICBMZWRnZXJIYW5kbGUgd3JpdGVsaCA9IG51bGw7CiAgICAgICAg\nd3JpdGVsaCA9IGJrYy5jcmVhdGVMZWRnZXIoZGlnZXN0VHlwZSwgIiIuZ2V0\nQnl0ZXMoKSk7CgogICAgICAgIFN0cmluZyB0bXAgPSAiQm9va0tlZXBlciBp\ncyBjb29sISI7CiAgICAgICAgZmluYWwgaW50IG51bUVudHJpZXMgPSAxMDsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVudHJpZXM7IGkrKykg\newogICAgICAgICAgICB3cml0ZWxoLmFkZEVudHJ5KHRtcC5nZXRCeXRlcygp\nKTsKICAgICAgICB9CgogICAgICAgIC8qCiAgICAgICAgICogVHJ5IHRvIG9w\nZW4gbGVkZ2VyLgogICAgICAgICAqLwogICAgICAgIExlZGdlckhhbmRsZSBy\nZWFkbGggPSBia2Mub3BlbkxlZGdlck5vUmVjb3Zlcnkod3JpdGVsaC5nZXRJ\nZCgpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsK\nICAgICAgICAvLyBzaG91bGQgbm90IGhhdmUgdHJpZ2dlcmVkIHJlY292ZXJ5\nIGFuZCBmZW5jaW5nCiAgICAgICAgCiAgICAgICAgd3JpdGVsaC5hZGRFbnRy\neSh0bXAuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgbG9uZyBudW1SZWFkYWJsZSA9\nIHJlYWRsaC5nZXRMYXN0QWRkQ29uZmlybWVkKCk7CiAgICAgICAgTE9HLmVy\ncm9yKCJudW1SZWFkICIgKyBudW1SZWFkYWJsZSk7CiAgICAgICAgRW51bWVy\nYXRpb248TGVkZ2VyRW50cnk+IGVudHJpZXMgPSByZWFkbGgucmVhZEVudHJp\nZXMoMSwgbnVtUmVhZGFibGUpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHJlYWRsaC5yZWFkRW50cmllcyhudW1SZWFkYWJsZSsxLCBudW1SZWFkYWJs\nZSsxKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0IGhhdmUgYmVlbiBh\nYmxlIHRvIHJlYWQgdGhpcyBmYXIiKTsKICAgICAgICB9IGNhdGNoIChCS0V4\nY2VwdGlvbi5CS1JlYWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBh\nbGwgaXMgZ29vZAogICAgICAgIH0KCiAgICAgICAgd3JpdGVsaC5hZGRFbnRy\neSh0bXAuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgbG9uZyBudW1SZWFkYWJsZTIg\nPSByZWFkbGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpOwogICAgICAgIGFzc2Vy\ndEVxdWFscygiTnVtYmVyIG9mIHJlYWRhYmxlIGVudHJpZXMgaGFzbid0IGNo\nYW5nZWQiLCBudW1SZWFkYWJsZTIsIG51bVJlYWRhYmxlKTsKICAgICAgICBy\nZWFkbGguY2xvc2UoKTsKCiAgICAgICAgd3JpdGVsaC5hZGRFbnRyeSh0bXAu\nZ2V0Qnl0ZXMoKSk7CiAgICAgICAgd3JpdGVsaC5jbG9zZSgpOwogICAgfQoK\nICAgIC8qKgogICAgICogY3JlYXRlIGEgbGVkZ2VyIGFuZCB3cml0ZSBlbnRy\naWVzLiAKICAgICAqIGtpbGwgYSBib29raWUgaW4gdGhlIGVuc2VtYmxlLiBS\nZWNvdmVyLgogICAgICogRmVuY2UgdGhlIGxlZGdlci4gS2lsbCBhbm90aGVy\nIGJvb2tpZS4gUmVjb3Zlci4KICAgICAqLwogICAgQFRlc3QKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RGZW5jaW5nSW50ZXJhY3Rpb25XaXRoQm9va2llUmVjb3Zl\ncnkoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTeXN0ZW0uc2V0UHJv\ncGVydHkoImRpZ2VzdFR5cGUiLCBkaWdlc3RUeXBlLnRvU3RyaW5nKCkpOwog\nICAgICAgIFN5c3RlbS5zZXRQcm9wZXJ0eSgicGFzc3dkIiwgInRlc3RQYXNz\nd2QiKTsKCiAgICAgICAgQm9va0tlZXBlckFkbWluIGFkbWluID0gbmV3IEJv\nb2tLZWVwZXJBZG1pbihIT1NUUE9SVCk7CgogICAgICAgIExlZGdlckhhbmRs\nZSB3cml0ZWxoID0gYmtjLmNyZWF0ZUxlZGdlcihkaWdlc3RUeXBlLCAidGVz\ndFBhc3N3ZCIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgCiAgICAgICAgU3RyaW5n\nIHRtcCA9ICJGb29iYXIiOwogICAgICAgIAogICAgICAgIGZpbmFsIGludCBu\ndW1FbnRyaWVzID0gMTA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBu\ndW1FbnRyaWVzOyBpKyspIHsKICAgICAgICAgICAgd3JpdGVsaC5hZGRFbnRy\neSh0bXAuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgfQoKICAgICAgICBJbmV0U29j\na2V0QWRkcmVzcyBib29raWVUb0tpbGwgCiAgICAgICAgICAgID0gd3JpdGVs\naC5nZXRMZWRnZXJNZXRhZGF0YSgpLmdldEVuc2VtYmxlKG51bUVudHJpZXMp\nLmdldCgwKTsKICAgICAgICBraWxsQm9va2llKGJvb2tpZVRvS2lsbCk7CiAg\nICAgICAgYWRtaW4ucmVjb3ZlckJvb2tpZURhdGEoYm9va2llVG9LaWxsLCBu\ndWxsKTsKICAgICAgICAKICAgICAgICAvKiBUT0RPOiB1bmNvbW1lbnQgdGhp\ncyB3aGVuIEJPT0tLRUVQRVItMTEyIGlzCiAgICAgICAgICAgZml4ZWQKICAg\nICAgICAgICAKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVudHJp\nZXM7IGkrKykgewogICAgICAgICAgICB3cml0ZWxoLmFkZEVudHJ5KHRtcC5n\nZXRCeXRlcygpKTsKICAgICAgICB9CiAgICAgICAgKi8KICAgICAgICAKICAg\nICAgICBMZWRnZXJIYW5kbGUgcmVhZGxoID0gYmtjLm9wZW5MZWRnZXIod3Jp\ndGVsaC5nZXRJZCgpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZGlnZXN0VHlwZSwgInRlc3RQYXNzd2QiLmdldEJ5\ndGVzKCkpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlbGguYWRk\nRW50cnkodG1wLmdldEJ5dGVzKCkpOwogICAgICAgICAgICBMT0cuZXJyb3Io\nIlNob3VsZCBoYXZlIHRocm93biBhbiBleGNlcHRpb24iKTsKICAgICAgICAg\nICAgZmFpbCgiU2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiB3aGVu\nIHRyeWluZyB0byB3cml0ZSIpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0\naW9uLkJLTGVkZ2VyRmVuY2VkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nLy8gY29ycmVjdCBiZWhhdmlvdXIKICAgICAgICB9CgogICAgICAgIHJlYWRs\naC5jbG9zZSgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlbGgu\nY2xvc2UoKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkIGZhaWwgdHJ5aW5n\nIHRvIHVwZGF0ZSBtZXRhZGF0YSIpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhj\nZXB0aW9uLlpLRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gY29ycmVj\ndCBiZWhhdmlvdXIKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBj\ncmVhdGUgYSBsZWRnZXIgYW5kIHdyaXRlIGVudHJpZXMuIAogICAgICogRmVu\nY2UgdGhlIGxlZGdlci4gS2lsbCBhIGJvb2tpZS4gUmVjb3Zlci4KICAgICAq\nIEVuc3VyZSB0aGF0IHJlY292ZXIgZG9lc24ndCByZWFsbG93IGFkZGluZwog\nICAgICovCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEZlbmNpbmdJ\nbnRlcmFjdGlvbldpdGhCb29raWVSZWNvdmVyeTIoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBTeXN0ZW0uc2V0UHJvcGVydHkoImRpZ2VzdFR5cGUi\nLCBkaWdlc3RUeXBlLnRvU3RyaW5nKCkpOwogICAgICAgIFN5c3RlbS5zZXRQ\ncm9wZXJ0eSgicGFzc3dkIiwgInRlc3RQYXNzd2QiKTsKCiAgICAgICAgQm9v\na0tlZXBlckFkbWluIGFkbWluID0gbmV3IEJvb2tLZWVwZXJBZG1pbihIT1NU\nUE9SVCk7CgogICAgICAgIExlZGdlckhhbmRsZSB3cml0ZWxoID0gYmtjLmNy\nZWF0ZUxlZGdlcihkaWdlc3RUeXBlLCAidGVzdFBhc3N3ZCIuZ2V0Qnl0ZXMo\nKSk7CiAgICAgICAgCiAgICAgICAgU3RyaW5nIHRtcCA9ICJGb29iYXIiOwog\nICAgICAgIAogICAgICAgIGZpbmFsIGludCBudW1FbnRyaWVzID0gMTA7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbnRyaWVzOyBpKyspIHsK\nICAgICAgICAgICAgd3JpdGVsaC5hZGRFbnRyeSh0bXAuZ2V0Qnl0ZXMoKSk7\nCiAgICAgICAgfQoKICAgICAgICBMZWRnZXJIYW5kbGUgcmVhZGxoID0gYmtj\nLm9wZW5MZWRnZXIod3JpdGVsaC5nZXRJZCgpLCAKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlnZXN0VHlwZSwgInRl\nc3RQYXNzd2QiLmdldEJ5dGVzKCkpOwogICAgICAgIC8vIHNob3VsZCBiZSBm\nZW5jZWQgYnkgbm93CiAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgYm9va2ll\nVG9LaWxsIAogICAgICAgICAgICA9IHdyaXRlbGguZ2V0TGVkZ2VyTWV0YWRh\ndGEoKS5nZXRFbnNlbWJsZShudW1FbnRyaWVzKS5nZXQoMCk7CiAgICAgICAg\na2lsbEJvb2tpZShib29raWVUb0tpbGwpOwogICAgICAgIGFkbWluLnJlY292\nZXJCb29raWVEYXRhKGJvb2tpZVRvS2lsbCwgbnVsbCk7CgogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHdyaXRlbGguYWRkRW50cnkodG1wLmdldEJ5dGVz\nKCkpOwogICAgICAgICAgICBMT0cuZXJyb3IoIlNob3VsZCBoYXZlIHRocm93\nbiBhbiBleGNlcHRpb24iKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkIGhh\ndmUgdGhyb3duIGFuIGV4Y2VwdGlvbiB3aGVuIHRyeWluZyB0byB3cml0ZSIp\nOwogICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0aW9uLkJLTGVkZ2VyRmVuY2Vk\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gY29ycmVjdCBiZWhhdmlv\ndXIKICAgICAgICB9CgogICAgICAgIHJlYWRsaC5jbG9zZSgpOwoKICAgICAg\nICB0cnkgewogICAgICAgICAgICB3cml0ZWxoLmNsb3NlKCk7CiAgICAgICAg\nICAgIGZhaWwoIlNob3VsZCBmYWlsIHRyeWluZyB0byB1cGRhdGUgbWV0YWRh\ndGEiKTsKICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5aS0V4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIC8vIGNvcnJlY3QgYmVoYXZpb3VyCiAgICAg\nICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

