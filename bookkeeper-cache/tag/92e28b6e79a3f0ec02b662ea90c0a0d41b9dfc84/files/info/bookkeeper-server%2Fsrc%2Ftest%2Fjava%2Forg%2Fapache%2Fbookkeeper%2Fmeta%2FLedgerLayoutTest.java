{"sha":"8235ce522d7be555819cc9a552561db7bead6bd4","node_id":"MDQ6QmxvYjE1NzU5NTY6ODIzNWNlNTIyZDdiZTU1NTgxOWNjOWE1NTI1NjFkYjdiZWFkNmJkNA==","size":5298,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8235ce522d7be555819cc9a552561db7bead6bd4","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhOwoKaW1w\nb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuUmFu\nZG9tOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CgppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2Vz\ndFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGll\nbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nWm9vS2VlcGVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuQ3JlYXRl\nTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRz\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQmFzZVRlc3RD\nYXNlOwppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0\nLkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQgb3JnLmp1\nbml0LkFzc2VydC4qOwoKcHVibGljIGNsYXNzIExlZGdlckxheW91dFRlc3Qg\nZXh0ZW5kcyBCYXNlVGVzdENhc2UgewogICAgRGlnZXN0VHlwZSBkaWdlc3RU\neXBlOwoKICAgIHB1YmxpYyBMZWRnZXJMYXlvdXRUZXN0KERpZ2VzdFR5cGUg\nZGlnZXN0VHlwZSkgewogICAgICAgIHN1cGVyKDApOwogICAgICAgIHRoaXMu\nZGlnZXN0VHlwZSA9IGRpZ2VzdFR5cGU7CiAgICB9CgogICAgQFRlc3QKICAg\nIHB1YmxpYyB2b2lkIHRlc3RMZWRnZXJMYXlvdXQoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcg\nQ2xpZW50Q29uZmlndXJhdGlvbigpOwogICAgICAgIGNvbmYuc2V0TGVkZ2Vy\nTWFuYWdlclR5cGUoSGllcmFyY2hpY2FsTGVkZ2VyTWFuYWdlci5OQU1FKTsK\nICAgICAgICBTdHJpbmcgbGVkZ2VyUm9vdFBhdGggPSAiL3Rlc3RMZWRnZXJM\nYXlvdXQiOwoKICAgICAgICB6a2MuY3JlYXRlKGxlZGdlclJvb3RQYXRoLCBu\nZXcgYnl0ZVswXSwgCiAgICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xf\nVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwoKICAgICAgICBMZWRn\nZXJMYXlvdXQgbGF5b3V0ID0gTGVkZ2VyTGF5b3V0LnJlYWRMYXlvdXQoemtj\nLCBsZWRnZXJSb290UGF0aCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiTGF5b3V0\nIHNob3VsZCBiZSBudWxsIiwgbGF5b3V0ID09IG51bGwpOwoKICAgICAgICBT\ndHJpbmcgdGVzdE5hbWUgPSAiZm9vYmFyIjsKICAgICAgICBpbnQgdGVzdFZl\ncnNpb24gPSAweGRlYWRiZWVmOwogICAgICAgIC8vIHVzZSBsYXlvdXQgZGVm\naW5lZCBpbiBjb25maWd1cmF0aW9uIGFsc28gY3JlYXRlIGl0IGluIHpvb2tl\nZXBlcgogICAgICAgIExlZGdlckxheW91dCBsYXlvdXQyID0gbmV3IExlZGdl\nckxheW91dCh0ZXN0TmFtZSwgdGVzdFZlcnNpb24pOwogICAgICAgIGxheW91\ndDIuc3RvcmUoemtjLCBsZWRnZXJSb290UGF0aCk7CgogICAgICAgIGxheW91\ndCA9IExlZGdlckxheW91dC5yZWFkTGF5b3V0KHprYywgbGVkZ2VyUm9vdFBh\ndGgpOwogICAgICAgIGFzc2VydEVxdWFscyh0ZXN0TmFtZSwgbGF5b3V0Lmdl\ndE1hbmFnZXJUeXBlKCkpOwogICAgICAgIGFzc2VydEVxdWFscyh0ZXN0VmVy\nc2lvbiwgbGF5b3V0LmdldE1hbmFnZXJWZXJzaW9uKCkpOwogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCB3cml0ZUxlZGdlckxheW91dCgKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBsZWRnZXJzUm9vdFBhdGgs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbWFu\nYWdlclR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nbnQgbWFuYWdlclZlcnNpb24sIGludCBsYXlvdXRWZXJzaW9uKQogICAgICAg\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExlZGdlckxheW91dCBsYXlv\ndXQgPSBuZXcgTGVkZ2VyTGF5b3V0KG1hbmFnZXJUeXBlLCBtYW5hZ2VyVmVy\nc2lvbik7CgogICAgICAgIEZpZWxkIGYgPSBMZWRnZXJMYXlvdXQuY2xhc3Mu\nZ2V0RGVjbGFyZWRGaWVsZCgibGF5b3V0Rm9ybWF0VmVyc2lvbiIpOwogICAg\nICAgIGYuc2V0QWNjZXNzaWJsZSh0cnVlKTsKICAgICAgICBmLnNldChsYXlv\ndXQsIGxheW91dFZlcnNpb24pOwoKICAgICAgICBsYXlvdXQuc3RvcmUoemtj\nLCBsZWRnZXJzUm9vdFBhdGgpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJs\naWMgdm9pZCB0ZXN0QmFkVmVyc2lvbkxlZGdlckxheW91dCgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9\nIG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgLy8gd3JpdGUg\nYmFkIHZlcnNpb24gbGVkZ2VyIGxheW91dAogICAgICAgIHdyaXRlTGVkZ2Vy\nTGF5b3V0KGNvbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgoKSwgRmxhdExlZGdl\nck1hbmFnZXIuTkFNRSwKICAgICAgICAgICAgICAgIEZsYXRMZWRnZXJNYW5h\nZ2VyLkNVUl9WRVJTSU9OLCBMZWRnZXJMYXlvdXQuTEFZT1VUX0ZPUk1BVF9W\nRVJTSU9OICsgMSk7CiAgICAgICAgCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgTGVkZ2VyTGF5b3V0LnJlYWRMYXlvdXQoemtjLCBjb25mLmdldFprTGVk\nZ2Vyc1Jvb3RQYXRoKCkpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3Qg\ncmVhY2ggaGVyZSEiKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBp\nZSkgewogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlv\nbiIsIGllLmdldE1lc3NhZ2UoKS5jb250YWlucygidmVyc2lvbiBub3QgY29t\ncGF0aWJsZSIpKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QKICAgIHB1\nYmxpYyB2b2lkIHRlc3RBYnNlbnRMZWRnZXJNYW5hZ2VyTGF5b3V0KCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlvbiBj\nb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBTdHJp\nbmcgbGVkZ2Vyc0xheW91dCA9IGNvbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgo\nKSArICIvIiArIExlZGdlckxheW91dC5MQVlPVVRfWk5PREU7CiAgICAgICAg\nLy8gd3JpdGUgYmFkIGZvcm1hdCBsZWRnZXIgbGF5b3V0CiAgICAgICAgU3Ry\naW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAg\nc2IuYXBwZW5kKExlZGdlckxheW91dC5MQVlPVVRfRk9STUFUX1ZFUlNJT04p\nLmFwcGVuZCgiXG4iKTsKICAgICAgICB6a2MuY3JlYXRlKGxlZGdlcnNMYXlv\ndXQsIHNiLnRvU3RyaW5nKCkuZ2V0Qnl0ZXMoKSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRl\nTW9kZS5QRVJTSVNURU5UKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nTGVkZ2VyTGF5b3V0LnJlYWRMYXlvdXQoemtjLCBjb25mLmdldFprTGVkZ2Vy\nc1Jvb3RQYXRoKCkpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgcmVh\nY2ggaGVyZSEiKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpZSkg\newogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlvbiIs\nIGllLmdldE1lc3NhZ2UoKS5jb250YWlucygidmVyc2lvbiBhYnNlbnQgZnJv\nbSIpKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2\nb2lkIHRlc3RCYXNlTGVkZ2VyTWFuYWdlckxheW91dCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9IG5l\ndyBDbGllbnRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgU3RyaW5nIHJvb3RQ\nYXRoID0gY29uZi5nZXRaa0xlZGdlcnNSb290UGF0aCgpOwogICAgICAgIFN0\ncmluZyBsZWRnZXJzTGF5b3V0ID0gcm9vdFBhdGggKyAiLyIgKyBMZWRnZXJM\nYXlvdXQuTEFZT1VUX1pOT0RFOwogICAgICAgIC8vIHdyaXRlIGJhZCBmb3Jt\nYXQgbGVkZ2VyIGxheW91dAogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBu\nZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNiLmFwcGVuZChMZWRnZXJM\nYXlvdXQuTEFZT1VUX0ZPUk1BVF9WRVJTSU9OKS5hcHBlbmQoIlxuIikKICAg\nICAgICAgIC5hcHBlbmQoRmxhdExlZGdlck1hbmFnZXIuTkFNRSk7CiAgICAg\nICAgemtjLmNyZWF0ZShsZWRnZXJzTGF5b3V0LCBzYi50b1N0cmluZygpLmdl\ndEJ5dGVzKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElk\ncy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lTVEVOVCk7Cgog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIExlZGdlckxheW91dC5yZWFkTGF5\nb3V0KHprYywgcm9vdFBhdGgpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRu\nJ3QgcmVhY2ggaGVyZSEiKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpZSkgewogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2Vw\ndGlvbiIsIGllLmdldE1lc3NhZ2UoKS5jb250YWlucygiSW52YWxpZCBMZWRn\nZXIgTWFuYWdlciIpKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

