{"sha":"5873255bfc99d8df07288b1bbfc7f825bbe58b3a","node_id":"MDQ6QmxvYjE1NzU5NTY6NTg3MzI1NWJmYzk5ZDhkZjA3Mjg4YjFiYmZjN2Y4MjViYmU1OGIzYQ==","size":9799,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5873255bfc99d8df07288b1bbfc7f825bbe58b3a","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdDsKCi8qCiAqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAqLwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247\nCmltcG9ydCBqYXZhLm5pby5CeXRlQnVmZmVyOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5SYW5kb207CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkNsaWVudENvbmZp\nZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50\nLkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyVGVzdENsaWVudDsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRW50\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nckhhbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQu\nQXN5bmNDYWxsYmFjay5SZWFkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29raWVTZXJ2ZXI7\nCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxv\nZ2dlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVw\nZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRj\naGVkRXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVy\nOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5U\nZXN0OwoKLyoqCiAqIFRoaXMgdGVzdCB0ZXN0cyByZWFkIGFuZCB3cml0ZSwg\nc3luY2hyb25vdXMgYW5kIGFzeW5jaHJvbm91cywgc3RyaW5ncyBhbmQKICog\naW50ZWdlcnMgZm9yIGEgQm9va0tlZXBlciBjbGllbnQuIFRoZSB0ZXN0IGRl\ncGxveW1lbnQgdXNlcyBhIFpvb0tlZXBlciBzZXJ2ZXIKICogYW5kIHRocmVl\nIEJvb2tLZWVwZXJzLgogKgogKi8KCnB1YmxpYyBjbGFzcyBCb29raWVGYWls\ndXJlVGVzdCBleHRlbmRzIEJhc2VUZXN0Q2FzZSBpbXBsZW1lbnRzIEFkZENh\nbGxiYWNrLCBSZWFkQ2FsbGJhY2sgewoKICAgIC8vIERlcGVuZGluZyBvbiB0\naGUgdGFzdGUsIHNlbGVjdCB0aGUgYW1vdW50IG9mIGxvZ2dpbmcKICAgIC8v\nIGJ5IGRlY29tbWVudGluZyBvbmUgb2YgdGhlIHR3byBsaW5lcyBiZWxvdwog\nICAgLy8gc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXIuZ2V0Um9vdExvZ2dl\ncigpOwogICAgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihCb29raWVGYWlsdXJlVGVzdC5jbGFzcyk7CgogICAgYnl0ZVtd\nIGxlZGdlclBhc3N3b3JkID0gImFhYSIuZ2V0Qnl0ZXMoKTsKICAgIExlZGdl\nckhhbmRsZSBsaCwgbGgyOwogICAgbG9uZyBsZWRnZXJJZDsKICAgIEVudW1l\ncmF0aW9uPExlZGdlckVudHJ5PiBsczsKCiAgICAvLyB0ZXN0IHJlbGF0ZWQg\ndmFyaWFibGVzCiAgICBpbnQgbnVtRW50cmllc1RvV3JpdGUgPSAyMDA7CiAg\nICBpbnQgbWF4SW50ID0gMjE0NzQ4MzY0NzsKICAgIFJhbmRvbSBybmc7IC8v\nIFJhbmRvbSBOdW1iZXIgR2VuZXJhdG9yCiAgICBBcnJheUxpc3Q8Ynl0ZVtd\nPiBlbnRyaWVzOyAvLyBnZW5lcmF0ZWQgZW50cmllcwogICAgQXJyYXlMaXN0\nPEludGVnZXI+IGVudHJpZXNTaXplOwogICAgRGlnZXN0VHlwZSBkaWdlc3RU\neXBlOwoKICAgIC8vIFN5bmNocm9uaXphdGlvbgogICAgU3luY09iaiBzeW5j\nOwogICAgU2V0PE9iamVjdD4gc3luY09ianM7CgogICAgY2xhc3MgU3luY09i\naiB7CiAgICAgICAgaW50IGNvdW50ZXI7CiAgICAgICAgYm9vbGVhbiB2YWx1\nZTsKCiAgICAgICAgcHVibGljIFN5bmNPYmooKSB7CiAgICAgICAgICAgIGNv\ndW50ZXIgPSAwOwogICAgICAgICAgICB2YWx1ZSA9IGZhbHNlOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgQm9va2llRmFpbHVyZVRlc3QoRGlnZXN0\nVHlwZSBkaWdlc3RUeXBlKSB7CiAgICAgICAgc3VwZXIoNCk7CiAgICAgICAg\ndGhpcy5kaWdlc3RUeXBlID0gZGlnZXN0VHlwZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRlc3RzIHdyaXRlcyBhbmQgcmVhZHMgd2hlbiBhIGJvb2tpZSBm\nYWlscy4KICAgICAqCiAgICAgKiBAdGhyb3dzIHtAbGluayBJT0V4Y2VwdGlv\nbn0KICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RBc3lu\nY0JLMSgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgTE9HLmluZm8o\nIiMjIyMgQksxICMjIyMiKTsKICAgICAgICBhdXhUZXN0UmVhZFdyaXRlQXN5\nbmNTaW5nbGVDbGllbnQoYnMuZ2V0KDApKTsKICAgIH0KCiAgICBAVGVzdAog\nICAgcHVibGljIHZvaWQgdGVzdEFzeW5jQksyKCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBMT0cuaW5mbygiIyMjIyBCSzIgIyMjIyIpOwogICAg\nICAgIGF1eFRlc3RSZWFkV3JpdGVBc3luY1NpbmdsZUNsaWVudChicy5nZXQo\nMSkpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0QXN5\nbmNCSzMoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIExPRy5pbmZv\nKCIjIyMjIEJLMyAjIyMjIik7CiAgICAgICAgYXV4VGVzdFJlYWRXcml0ZUFz\neW5jU2luZ2xlQ2xpZW50KGJzLmdldCgyKSk7CiAgICB9CgogICAgQFRlc3QK\nICAgIHB1YmxpYyB2b2lkIHRlc3RBc3luY0JLNCgpIHRocm93cyBJT0V4Y2Vw\ndGlvbiB7CiAgICAgICAgTE9HLmluZm8oIiMjIyMgQks0ICMjIyMiKTsKICAg\nICAgICBhdXhUZXN0UmVhZFdyaXRlQXN5bmNTaW5nbGVDbGllbnQoYnMuZ2V0\nKDMpKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEJv\nb2tpZVJlY292ZXJ5KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy9T\naHV0ZG93biBhbGwgYnV0IDEgYm9va2llCiAgICAgICAgYnMuZ2V0KDApLnNo\ndXRkb3duKCk7CiAgICAgICAgYnMuZ2V0KDEpLnNodXRkb3duKCk7CiAgICAg\nICAgYnMuZ2V0KDIpLnNodXRkb3duKCk7CgogICAgICAgIGJ5dGVbXSBwYXNz\nd2QgPSAiYmxhaCIuZ2V0Qnl0ZXMoKTsKICAgICAgICBMZWRnZXJIYW5kbGUg\nbGggPSBia2MuY3JlYXRlTGVkZ2VyKDEsIDEsZGlnZXN0VHlwZSwgcGFzc3dk\nKTsKCiAgICAgICAgaW50IG51bUVudHJpZXMgPSAxMDA7CiAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPCBudW1FbnRyaWVzOyBpKyspIHsKICAgICAgICAgICAg\nYnl0ZVtdIGRhdGEgPSAoIiIraSkuZ2V0Qnl0ZXMoKTsKICAgICAgICAgICAg\nbGguYWRkRW50cnkoZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBicy5nZXQo\nMykuc2h1dGRvd24oKTsKICAgICAgICBCb29raWVTZXJ2ZXIgc2VydmVyID0g\nbmV3IEJvb2tpZVNlcnZlcihic0NvbmZzLmdldCgzKSk7CiAgICAgICAgc2Vy\ndmVyLnN0YXJ0KCk7CiAgICAgICAgYnMuc2V0KDMsIHNlcnZlcik7CgogICAg\nICAgIGFzc2VydEVxdWFscyhudW1FbnRyaWVzIC0gMSAsIGxoLmdldExhc3RB\nZGRDb25maXJtZWQoKSk7CiAgICAgICAgRW51bWVyYXRpb248TGVkZ2VyRW50\ncnk+IGVudHJpZXMgPSBsaC5yZWFkRW50cmllcygwLCBsaC5nZXRMYXN0QWRk\nQ29uZmlybWVkKCkpOwoKICAgICAgICBpbnQgbnVtU2Nhbm5lZCA9IDA7CiAg\nICAgICAgd2hpbGUgKGVudHJpZXMuaGFzTW9yZUVsZW1lbnRzKCkpIHsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCgiIitudW1TY2FubmVkKSwgbmV3IFN0\ncmluZyhlbnRyaWVzLm5leHRFbGVtZW50KCkuZ2V0RW50cnkoKSkpOwogICAg\nICAgICAgICBudW1TY2FubmVkKys7CiAgICAgICAgfQogICAgICAgIGFzc2Vy\ndEVxdWFscyhudW1FbnRyaWVzLCBudW1TY2FubmVkKTsKCgogICAgfQoKICAg\nIHZvaWQgYXV4VGVzdFJlYWRXcml0ZUFzeW5jU2luZ2xlQ2xpZW50KEJvb2tp\nZVNlcnZlciBicykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICB0cnkg\newogICAgICAgICAgICAvLyBDcmVhdGUgYSBsZWRnZXIKICAgICAgICAgICAg\nbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDIsIGRpZ2VzdFR5cGUsIGxlZGdl\nclBhc3N3b3JkKTsKCiAgICAgICAgICAgIGxlZGdlcklkID0gbGguZ2V0SWQo\nKTsKICAgICAgICAgICAgTE9HLmluZm8oIkxlZGdlciBJRDogIiArIGxoLmdl\ndElkKCkpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVu\ndHJpZXNUb1dyaXRlOyBpKyspIHsKICAgICAgICAgICAgICAgIEJ5dGVCdWZm\nZXIgZW50cnkgPSBCeXRlQnVmZmVyLmFsbG9jYXRlKDQpOwogICAgICAgICAg\nICAgICAgZW50cnkucHV0SW50KHJuZy5uZXh0SW50KG1heEludCkpOwogICAg\nICAgICAgICAgICAgZW50cnkucG9zaXRpb24oMCk7CgogICAgICAgICAgICAg\nICAgZW50cmllcy5hZGQoZW50cnkuYXJyYXkoKSk7CiAgICAgICAgICAgICAg\nICBlbnRyaWVzU2l6ZS5hZGQoZW50cnkuYXJyYXkoKS5sZW5ndGgpOwogICAg\nICAgICAgICAgICAgbGguYXN5bmNBZGRFbnRyeShlbnRyeS5hcnJheSgpLCB0\naGlzLCBzeW5jKTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIExPRy5p\nbmZvKCJXcm90ZSAiICsgbnVtRW50cmllc1RvV3JpdGUgKyAiIGFuZCBub3cg\nZ29pbmcgdG8gZmFpbCBib29raWUuIik7CiAgICAgICAgICAgIC8vIEJvb2tp\nZSBmYWlsCiAgICAgICAgICAgIGJzLnNodXRkb3duKCk7CgogICAgICAgICAg\nICAvLyB3YWl0IGZvciBhbGwgZW50cmllcyB0byBiZSBhY2tub3dsZWRnZWQK\nICAgICAgICAgICAgc3luY2hyb25pemVkIChzeW5jKSB7CiAgICAgICAgICAg\nICAgICB3aGlsZSAoc3luYy5jb3VudGVyIDwgbnVtRW50cmllc1RvV3JpdGUp\nIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoIkVudHJpZXMgY291\nbnRlciA9ICIgKyBzeW5jLmNvdW50ZXIpOwogICAgICAgICAgICAgICAgICAg\nIHN5bmMud2FpdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCgogICAgICAgICAgICBMT0cuZGVidWcoIioqKiBXUklURSBDT01QTEVURSAq\nKioiKTsKICAgICAgICAgICAgLy8gY2xvc2UgbGVkZ2VyCiAgICAgICAgICAg\nIGxoLmNsb3NlKCk7CgogICAgICAgICAgICAvLyAqKiogV1JJVElORyBQQVJU\nIENPTVBMRVRFIC8vIFJFQUQgUEFSVCBCRUdJTlMgKioqCgogICAgICAgICAg\nICAvLyBvcGVuIGxlZGdlcgogICAgICAgICAgICBia2MuY2xvc2UoKTsKICAg\nICAgICAgICAgYmtjID0gbmV3IEJvb2tLZWVwZXJUZXN0Q2xpZW50KGJhc2VD\nbGllbnRDb25mKTsKICAgICAgICAgICAgbGggPSBia2Mub3BlbkxlZGdlcihs\nZWRnZXJJZCwgZGlnZXN0VHlwZSwgbGVkZ2VyUGFzc3dvcmQpOwogICAgICAg\nICAgICBMT0cuZGVidWcoIk51bWJlciBvZiBlbnRyaWVzIHdyaXR0ZW46ICIg\nKyAobGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpICsgMSkpOwogICAgICAgICAg\nICBhc3NlcnRUcnVlKCJWZXJpZnlpbmcgbnVtYmVyIG9mIGVudHJpZXMgd3Jp\ndHRlbiIsIGxoLmdldExhc3RBZGRDb25maXJtZWQoKSA9PSAobnVtRW50cmll\nc1RvV3JpdGUgLSAxKSk7CgogICAgICAgICAgICAvLyByZWFkIGVudHJpZXMK\nCiAgICAgICAgICAgIGxoLmFzeW5jUmVhZEVudHJpZXMoMCwgbnVtRW50cmll\nc1RvV3JpdGUgLSAxLCB0aGlzLCBzeW5jKTsKCiAgICAgICAgICAgIHN5bmNo\ncm9uaXplZCAoc3luYykgewogICAgICAgICAgICAgICAgd2hpbGUgKHN5bmMu\ndmFsdWUgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBzeW5jLndh\naXQoMTAwMDApOwogICAgICAgICAgICAgICAgICAgIGFzc2VydFRydWUoIkhh\ndmVuJ3QgcmVjZWl2ZWQgZW50cmllcyIsIHN5bmMudmFsdWUpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBMT0cuZGVi\ndWcoIioqKiBSRUFEIENPTVBMRVRFICoqKiIpOwoKICAgICAgICAgICAgLy8g\nYXQgdGhpcyBwb2ludCwgRW51bWVyYXRpb248TGVkZ2VyRW50cnk+IGxzIGlz\nIGZpbGxlZCB3aXRoIHRoZSByZXR1cm5lZAogICAgICAgICAgICAvLyB2YWx1\nZXMKICAgICAgICAgICAgaW50IGkgPSAwOwogICAgICAgICAgICB3aGlsZSAo\nbHMuaGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgICAgIEJ5dGVC\ndWZmZXIgb3JpZ2JiID0gQnl0ZUJ1ZmZlci53cmFwKGVudHJpZXMuZ2V0KGkp\nKTsKICAgICAgICAgICAgICAgIEludGVnZXIgb3JpZ0VudHJ5ID0gb3JpZ2Ji\nLmdldEludCgpOwogICAgICAgICAgICAgICAgYnl0ZVtdIGVudHJ5ID0gbHMu\nbmV4dEVsZW1lbnQoKS5nZXRFbnRyeSgpOwogICAgICAgICAgICAgICAgQnl0\nZUJ1ZmZlciByZXN1bHQgPSBCeXRlQnVmZmVyLndyYXAoZW50cnkpOwoKICAg\nICAgICAgICAgICAgIEludGVnZXIgcmV0ckVudHJ5ID0gcmVzdWx0LmdldElu\ndCgpOwogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJSZXRyaWV2ZWQgZW50\ncnk6ICIgKyBpKTsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUoIkNoZWNr\naW5nIGVudHJ5ICIgKyBpICsgIiBmb3IgZXF1YWxpdHkiLCBvcmlnRW50cnku\nZXF1YWxzKHJldHJFbnRyeSkpOwogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1\nZSgiQ2hlY2tpbmcgZW50cnkgIiArIGkgKyAiIGZvciBzaXplIiwgZW50cnku\nbGVuZ3RoID09IGVudHJpZXNTaXplLmdldChpKS5pbnRWYWx1ZSgpKTsKICAg\nICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZSgiQ2hlY2tpbmcgbnVtYmVyIG9mIHJlYWQgZW50cmllcyIs\nIGkgPT0gbnVtRW50cmllc1RvV3JpdGUpOwoKICAgICAgICAgICAgTE9HLmlu\nZm8oIlZlcmlmaWVkIHRoYXQgZW50cmllcyBhcmUgb2ssIGFuZCBub3cgY2xv\nc2luZyBsZWRnZXIiKTsKICAgICAgICAgICAgbGguY2xvc2UoKTsKICAgICAg\nICB9IGNhdGNoIChLZWVwZXJFeGNlcHRpb24gZSkgewogICAgICAgICAgICBM\nT0cuZXJyb3IoIkNhdWdodCBLZWVwZXJFeGNlcHRpb24iLCBlKTsKICAgICAg\nICAgICAgZmFpbChlLnRvU3RyaW5nKCkpOwogICAgICAgIH0gY2F0Y2ggKEJL\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJDYXVnaHQg\nQktFeGNlcHRpb24iLCBlKTsKICAgICAgICAgICAgZmFpbChlLnRvU3RyaW5n\nKCkpOwogICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJDYXVnaHQgSW50ZXJydXB0ZWRF\neGNlcHRpb24iLCBlKTsKICAgICAgICAgICAgZmFpbChlLnRvU3RyaW5nKCkp\nOwogICAgICAgIH0KCiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkQ29tcGxl\ndGUoaW50IHJjLCBMZWRnZXJIYW5kbGUgbGgsIGxvbmcgZW50cnlJZCwgT2Jq\nZWN0IGN0eCkgewogICAgICAgIGlmIChyYyAhPSAwKQogICAgICAgICAgICBm\nYWlsKCJGYWlsZWQgdG8gd3JpdGUgZW50cnk6ICIgKyBlbnRyeUlkKTsKICAg\nICAgICBTeW5jT2JqIHggPSAoU3luY09iaikgY3R4OwogICAgICAgIHN5bmNo\ncm9uaXplZCAoeCkgewogICAgICAgICAgICB4LmNvdW50ZXIrKzsKICAgICAg\nICAgICAgeC5ub3RpZnkoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgcmVhZENvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBF\nbnVtZXJhdGlvbjxMZWRnZXJFbnRyeT4gc2VxLCBPYmplY3QgY3R4KSB7CiAg\nICAgICAgaWYgKHJjICE9IDApCiAgICAgICAgICAgIGZhaWwoIkZhaWxlZCB0\nbyB3cml0ZSBlbnRyeSIpOwogICAgICAgIGxzID0gc2VxOwogICAgICAgIHN5\nbmNocm9uaXplZCAoc3luYykgewogICAgICAgICAgICBzeW5jLnZhbHVlID0g\ndHJ1ZTsKICAgICAgICAgICAgc3luYy5ub3RpZnkoKTsKICAgICAgICB9Cgog\nICAgfQoKICAgIEBCZWZvcmUKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5z\nZXRVcCgpOwoKICAgICAgICBybmcgPSBuZXcgUmFuZG9tKFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpKTsgLy8gSW5pdGlhbGl6ZSB0aGUgUmFuZG9tCiAg\nICAgICAgLy8gTnVtYmVyIEdlbmVyYXRvcgogICAgICAgIGVudHJpZXMgPSBu\nZXcgQXJyYXlMaXN0PGJ5dGVbXT4oKTsgLy8gaW5pdGlhbGl6ZSB0aGUgZW50\ncmllcyBsaXN0CiAgICAgICAgZW50cmllc1NpemUgPSBuZXcgQXJyYXlMaXN0\nPEludGVnZXI+KCk7CiAgICAgICAgc3luYyA9IG5ldyBTeW5jT2JqKCk7IC8v\nIGluaXRpYWxpemUgdGhlIHN5bmNocm9uaXphdGlvbiBkYXRhIHN0cnVjdHVy\nZQoKICAgICAgICB6a2MuY2xvc2UoKTsKICAgIH0KCgogICAgLyogQ2xlYW4g\ndXAgYSBkaXJlY3RvcnkgcmVjdXJzaXZlbHkgKi8KICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gY2xlYW5VcERpcihGaWxlIGRpcikgewog\nICAgICAgIGlmIChkaXIuaXNEaXJlY3RvcnkoKSkgewogICAgICAgICAgICBM\nT0cuaW5mbygiQ2xlYW5pbmcgdXAgIiArIGRpci5nZXROYW1lKCkpOwogICAg\nICAgICAgICBTdHJpbmdbXSBjaGlsZHJlbiA9IGRpci5saXN0KCk7CiAgICAg\nICAgICAgIGZvciAoU3RyaW5nIHN0cmluZyA6IGNoaWxkcmVuKSB7CiAgICAg\nICAgICAgICAgICBib29sZWFuIHN1Y2Nlc3MgPSBjbGVhblVwRGlyKG5ldyBG\naWxlKGRpciwgc3RyaW5nKSk7CiAgICAgICAgICAgICAgICBpZiAoIXN1Y2Nl\nc3MpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIFRoZSBkaXJlY3RvcnkgaXMg\nbm93IGVtcHR5IHNvIGRlbGV0ZSBpdAogICAgICAgIHJldHVybiBkaXIuZGVs\nZXRlKCk7CiAgICB9CgogICAgLyogVXNlciBmb3IgdGVzdGluZyBwdXJwb3Nl\ncywgdm9pZCAqLwogICAgY2xhc3MgZW1wdHlXYXRjaGVyIGltcGxlbWVudHMg\nV2F0Y2hlciB7CiAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVk\nRXZlbnQgZXZlbnQpIHsKICAgICAgICB9CiAgICB9Cgp9Cg==\n","encoding":"base64"}

