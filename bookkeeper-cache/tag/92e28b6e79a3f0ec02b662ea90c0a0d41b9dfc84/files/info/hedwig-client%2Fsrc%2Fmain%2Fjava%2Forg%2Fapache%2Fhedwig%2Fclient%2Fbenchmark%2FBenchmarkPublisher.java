{"sha":"54c5ce5c7f2d7b33457065089bb30f6f2c37beda","node_id":"MDQ6QmxvYjE1NzU5NTY6NTRjNWNlNWM3ZjJkN2IzMzQ1NzA2NTA4OWJiMzBmNmYyYzM3YmVkYQ==","size":5446,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/54c5ce5c7f2d7b33457065089bb30f6f2c37beda","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrOwoKaW1w\nb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuU3Vic2NyaWJl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5iZW5jaG1hcmsu\nQmVuY2htYXJrVXRpbHMuQmVuY2htYXJrQ2FsbGJhY2s7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrLkJlbmNobWFya1V0aWxz\nLlRocm91Z2hwdXRMYXRlbmN5QWdncmVnYXRvcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbC5TdWJzY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazsKCnB1YmxpYyBjbGFzcyBC\nZW5jaG1hcmtQdWJsaXNoZXIgZXh0ZW5kcyBCZW5jaG1hcmtXb3JrZXIgewog\nICAgUHVibGlzaGVyIHB1Ymxpc2hlcjsKICAgIFN1YnNjcmliZXIgc3Vic2Ny\naWJlcjsKICAgIGludCBtc2dTaXplOwogICAgaW50IG5QYXJhbGxlbDsKICAg\nIGRvdWJsZSByYXRlOwoKICAgIHB1YmxpYyBCZW5jaG1hcmtQdWJsaXNoZXIo\naW50IG51bVRvcGljcywgaW50IG51bU1lc3NhZ2VzLCBpbnQgbnVtUmVnaW9u\ncywgaW50IHN0YXJ0VG9waWNMYWJlbCwgaW50IHBhcnRpdGlvbkluZGV4LAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgbnVtUGFydGl0aW9u\ncywgUHVibGlzaGVyIHB1Ymxpc2hlciwgU3Vic2NyaWJlciBzdWJzY3JpYmVy\nLCBpbnQgbXNnU2l6ZSwgaW50IG5QYXJhbGxlbCwgaW50IHJhdGUpIHsKICAg\nICAgICBzdXBlcihudW1Ub3BpY3MsIG51bU1lc3NhZ2VzLCBudW1SZWdpb25z\nLCBzdGFydFRvcGljTGFiZWwsIHBhcnRpdGlvbkluZGV4LCBudW1QYXJ0aXRp\nb25zKTsKICAgICAgICB0aGlzLnB1Ymxpc2hlciA9IHB1Ymxpc2hlcjsKICAg\nICAgICB0aGlzLm1zZ1NpemUgPSBtc2dTaXplOwogICAgICAgIHRoaXMuc3Vi\nc2NyaWJlciA9IHN1YnNjcmliZXI7CiAgICAgICAgdGhpcy5uUGFyYWxsZWwg\nPSBuUGFyYWxsZWw7CgogICAgICAgIHRoaXMucmF0ZSA9IHJhdGUgLyAobnVt\nUmVnaW9ucyAqIG51bVBhcnRpdGlvbnMgKyAwLjApOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdhcm11cChpbnQgbldhcm11cCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29w\neUZyb21VdGY4KCJ3YXJtdXAiICsgcGFydGl0aW9uSW5kZXgpOwogICAgICAg\nIEJ5dGVTdHJpbmcgc3ViSWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgi\nc3ViIik7CiAgICAgICAgc3Vic2NyaWJlci5zdWJzY3JpYmUodG9waWMsIHN1\nYklkLCBDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKTsKCiAgICAg\nICAgc3Vic2NyaWJlci5zdGFydERlbGl2ZXJ5KHRvcGljLCBzdWJJZCwgbmV3\nIE1lc3NhZ2VIYW5kbGVyKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgcHVibGljIHZvaWQgZGVsaXZlcihCeXRlU3RyaW5nIHRvcGlj\nLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgTWVzc2FnZSBtc2csIENhbGxi\nYWNrPFZvaWQ+IGNhbGxiYWNrLAogICAgICAgICAgICBPYmplY3QgY29udGV4\ndCkgewogICAgICAgICAgICAgICAgLy8gbm9vcAogICAgICAgICAgICAgICAg\nY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY29udGV4dCwgbnVsbCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gcGlja2luZyBj\nb25zdGFudHMgYXJiaXRhcmlseSBmb3Igd2FybXVwIHBoYXNlCiAgICAgICAg\nVGhyb3VnaHB1dExhdGVuY3lBZ2dyZWdhdG9yIGFnZyA9IG5ldyBUaHJvdWdo\ncHV0TGF0ZW5jeUFnZ3JlZ2F0b3IoImFja2VkIHB1YnMiLCBuV2FybXVwLCAx\nMDApOwogICAgICAgIE1lc3NhZ2UgbXNnID0gZ2V0TXNnKDEwMjQpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbldhcm11cDsgaSsrKSB7CiAgICAg\nICAgICAgIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2godG9waWMsIG1zZywgbmV3\nIEJlbmNobWFya0NhbGxiYWNrKGFnZyksIG51bGwpOwogICAgICAgIH0KCiAg\nICAgICAgaWYgKGFnZy50cEFnZy5xdWV1ZS50YWtlKCkgPiAwKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJXYXJtdXAgcHVi\nbGlzaGVzIGZhaWxlZCEiKTsKICAgICAgICB9CgogICAgfQoKICAgIHB1Ymxp\nYyBNZXNzYWdlIGdldE1zZyhpbnQgc2l6ZSkgewogICAgICAgIFN0cmluZ0J1\naWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIHNiLmFw\ncGVuZCgnYScpOwogICAgICAgIH0KICAgICAgICBmaW5hbCBCeXRlU3RyaW5n\nIGJvZHkgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOChzYi50b1N0cmluZygp\nKTsKICAgICAgICBNZXNzYWdlIG1zZyA9IE1lc3NhZ2UubmV3QnVpbGRlcigp\nLnNldEJvZHkoYm9keSkuYnVpbGQoKTsKICAgICAgICByZXR1cm4gbXNnOwog\nICAgfQoKICAgIHB1YmxpYyBWb2lkIGNhbGwoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBNZXNzYWdlIG1zZyA9IGdldE1zZyhtc2dTaXplKTsKCiAg\nICAgICAgLy8gU2luZ2xlIHdhcm11cCBmb3IgZXZlcnkgdG9waWMKICAgICAg\nICBpbnQgbXlQdWJsaXNoQ291bnQgPSAwOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgbnVtVG9waWNzOyBpKyspIHsKICAgICAgICAgICAgaWYgKCFI\nZWR3aWdCZW5jaG1hcmsuYW1JUmVzcG9uc2libGVGb3JUb3BpYyhzdGFydFRv\ncGljTGFiZWwgKyBpLCBwYXJ0aXRpb25JbmRleCwgbnVtUGFydGl0aW9ucykp\nIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNvcHlG\ncm9tVXRmOChIZWR3aWdCZW5jaG1hcmsuVE9QSUNfUFJFRklYICsgKHN0YXJ0\nVG9waWNMYWJlbCArIGkpKTsKICAgICAgICAgICAgcHVibGlzaGVyLnB1Ymxp\nc2godG9waWMsIG1zZyk7CiAgICAgICAgICAgIG15UHVibGlzaENvdW50Kys7\nCiAgICAgICAgfQoKICAgICAgICBsb25nIHN0YXJ0VGltZSA9IFN5c3RlbS5j\ndXJyZW50VGltZU1pbGxpcygpOwogICAgICAgIGludCBteVB1Ymxpc2hMaW1p\ndCA9IG51bU1lc3NhZ2VzIC8gbnVtUmVnaW9ucyAvIG51bVBhcnRpdGlvbnMg\nLSBteVB1Ymxpc2hDb3VudDsKICAgICAgICBteVB1Ymxpc2hDb3VudCA9IDA7\nCiAgICAgICAgVGhyb3VnaHB1dExhdGVuY3lBZ2dyZWdhdG9yIGFnZyA9IG5l\ndyBUaHJvdWdocHV0TGF0ZW5jeUFnZ3JlZ2F0b3IoImFja2VkIHB1YnMiLCBt\neVB1Ymxpc2hMaW1pdCwgblBhcmFsbGVsKTsKCiAgICAgICAgaW50IHRvcGlj\nTGFiZWwgPSAwOwoKICAgICAgICB3aGlsZSAobXlQdWJsaXNoQ291bnQgPCBt\neVB1Ymxpc2hMaW1pdCkgewogICAgICAgICAgICBpbnQgdG9waWNOdW0gPSBz\ndGFydFRvcGljTGFiZWwgKyB0b3BpY0xhYmVsOwogICAgICAgICAgICB0b3Bp\nY0xhYmVsID0gKHRvcGljTGFiZWwgKyAxKSAlIG51bVRvcGljczsKCiAgICAg\nICAgICAgIGlmICghSGVkd2lnQmVuY2htYXJrLmFtSVJlc3BvbnNpYmxlRm9y\nVG9waWModG9waWNOdW0sIHBhcnRpdGlvbkluZGV4LCBudW1QYXJ0aXRpb25z\nKSkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOChIZWR3aWdCZW5jaG1hcmsuVE9QSUNfUFJFRklYICsgdG9w\naWNOdW0pOwoKICAgICAgICAgICAgaWYgKHJhdGUgPiAwKSB7CiAgICAgICAg\nICAgICAgICBsb25nIGRlbGF5ID0gc3RhcnRUaW1lICsgKGxvbmcpICgxMDAw\nICogbXlQdWJsaXNoQ291bnQgLyByYXRlKSAtIFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwogICAgICAgICAgICAgICAgaWYgKGRlbGF5ID4gMCkKICAg\nICAgICAgICAgICAgICAgICBUaHJlYWQuc2xlZXAoZGVsYXkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2godG9w\naWMsIG1zZywgbmV3IEJlbmNobWFya0NhbGxiYWNrKGFnZyksIG51bGwpOwog\nICAgICAgICAgICBteVB1Ymxpc2hDb3VudCsrOwogICAgICAgIH0KCiAgICAg\nICAgU3lzdGVtLm91dC5wcmludGxuKCJGaW5pc2hlZCB1bmFja2VkIHB1YnM6\nIHRwdXQgPSAiICsgQmVuY2htYXJrVXRpbHMuY2FsY1RwKG15UHVibGlzaExp\nbWl0LCBzdGFydFRpbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nIiBvcHMvcyIpOwogICAgICAgIC8vIFdhaXQgdGlsbCB0aGUgYmVuY2htYXJr\nIHRlc3QgaGFzIGNvbXBsZXRlZAogICAgICAgIGFnZy50cEFnZy5xdWV1ZS50\nYWtlKCk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKGFnZy5zdW1tYXJp\nemUoc3RhcnRUaW1lKSk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgp9\nCg==\n","encoding":"base64"}

