{"sha":"5ff4bc8e986cba484fd7316d04d83d1de6fc1824","node_id":"MDQ6QmxvYjE1NzU5NTY6NWZmNGJjOGU5ODZjYmE0ODRmZDczMTZkMDRkODNkMWRlNmZjMTgyNA==","size":5928,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5ff4bc8e986cba484fd7316d04d83d1de6fc1824","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrOwoKaW1w\nb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNhbGxhYmxlOwoKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFj\ndG9yeTsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3NhZ2VI\nYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5T\ndWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmJl\nbmNobWFyay5CZW5jaG1hcmtVdGlscy5CZW5jaG1hcmtDYWxsYmFjazsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5iZW5jaG1hcmsuQmVuY2ht\nYXJrVXRpbHMuVGhyb3VnaHB1dEFnZ3JlZ2F0b3I7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrLkJlbmNobWFya1V0aWxzLlRo\ncm91Z2hwdXRMYXRlbmN5QWdncmVnYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5S\nZWdpb25TcGVjaWZpY1NlcUlkOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVh\ndGVPckF0dGFjaDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2Fs\nbGJhY2s7CgpwdWJsaWMgY2xhc3MgQmVuY2htYXJrU3Vic2NyaWJlciBleHRl\nbmRzIEJlbmNobWFya1dvcmtlciBpbXBsZW1lbnRzIENhbGxhYmxlPFZvaWQ+\nIHsKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoQmVuY2htYXJrU3Vic2NyaWJlci5jbGFzcyk7CiAg\nICBTdWJzY3JpYmVyIHN1YnNjcmliZXI7CiAgICBCeXRlU3RyaW5nIHN1Yklk\nOwoKCiAgICBwdWJsaWMgQmVuY2htYXJrU3Vic2NyaWJlcihpbnQgbnVtVG9w\naWNzLCBpbnQgbnVtTWVzc2FnZXMsIGludCBudW1SZWdpb25zLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgaW50IHN0YXJ0VG9waWNMYWJlbCwg\naW50IHBhcnRpdGlvbkluZGV4LCBpbnQgbnVtUGFydGl0aW9ucywgU3Vic2Ny\naWJlciBzdWJzY3JpYmVyLCBCeXRlU3RyaW5nIHN1YklkKSB7CiAgICAgICAg\nc3VwZXIobnVtVG9waWNzLCBudW1NZXNzYWdlcywgbnVtUmVnaW9ucywgc3Rh\ncnRUb3BpY0xhYmVsLCBwYXJ0aXRpb25JbmRleCwgbnVtUGFydGl0aW9ucyk7\nCiAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjsKICAgICAg\nICB0aGlzLnN1YklkID0gc3ViSWQ7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nd2FybXVwKGludCBudW1XYXJtdXApIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLyoKICAgICAgICAgKiBtdWx0aXBseWluZyB0aGUg\nbnVtYmVyIG9mIG9wcyBieSBudW1QYXJpdGlvbnMgYmVjYXVzZSB3ZSBlbmQg\ndXAKICAgICAgICAgKiBza2lwcGluZyBtYW55IGJlY2F1c2Ugb2YgdGhlIHBh\ncnRpdGlvbmluZyBsb2dpYwogICAgICAgICAqLwogICAgICAgIG11bHRpU3Vi\nKCJ3YXJtdXAiLCAid2FybXVwIiwgMCwgbnVtV2FybXVwLCBudW1XYXJtdXAg\nKiBudW1QYXJ0aXRpb25zKTsKICAgIH0KCiAgICBwdWJsaWMgVm9pZCBjYWxs\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CgogICAgICAgIGZpbmFsIFRocm91Z2hw\ndXRBZ2dyZWdhdG9yIGFnZyA9IG5ldyBUaHJvdWdocHV0QWdncmVnYXRvcigi\ncmVjdnMiLCBudW1NZXNzYWdlcyk7CiAgICAgICAgZmluYWwgTWFwPFN0cmlu\nZywgTG9uZz4gbGFzdFNlcUlkU2Vlbk1hcCA9IG5ldyBIYXNoTWFwPFN0cmlu\nZywgTG9uZz4oKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IHN0YXJ0VG9waWNM\nYWJlbDsgaSA8IHN0YXJ0VG9waWNMYWJlbCArIG51bVRvcGljczsgaSsrKSB7\nCgogICAgICAgICAgICBpZiAoIUhlZHdpZ0JlbmNobWFyay5hbUlSZXNwb25z\naWJsZUZvclRvcGljKGksIHBhcnRpdGlvbkluZGV4LCBudW1QYXJ0aXRpb25z\nKSkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGZpbmFsIFN0cmluZyB0b3BpYyA9IEhlZHdpZ0JlbmNo\nbWFyay5UT1BJQ19QUkVGSVggKyBpOwoKICAgICAgICAgICAgc3Vic2NyaWJl\nci5zdWJzY3JpYmUoQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgodG9waWMpLCBz\ndWJJZCwgQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCk7CiAgICAg\nICAgICAgIHN1YnNjcmliZXIuc3RhcnREZWxpdmVyeShCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOCh0b3BpYyksIHN1YklkLCBuZXcgTWVzc2FnZUhhbmRsZXIo\nKSB7CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBkZWxpdmVyKEJ5dGVTdHJpbmcgdGhpc1RvcGljLCBC\neXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgTWVzc2FnZSBtc2csCiAgICAgICAg\nICAgICAgICBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGNvbnRl\neHQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdF\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1\nZygiR290IG1lc3NhZ2UgZnJvbSBzcmMtcmVnaW9uOiAiICsgbXNnLmdldFNy\nY1JlZ2lvbigpICsgIiB3aXRoIHNlcS1pZDogIgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyBtc2cuZ2V0TXNnSWQoKSk7CgogICAg\nICAgICAgICAgICAgICAgIFN0cmluZyBtYXBLZXkgPSB0b3BpYyArIG1zZy5n\nZXRTcmNSZWdpb24oKS50b1N0cmluZ1V0ZjgoKTsKICAgICAgICAgICAgICAg\nICAgICBMb25nIGxhc3RTZXFJZFNlZW4gPSBsYXN0U2VxSWRTZWVuTWFwLmdl\ndChtYXBLZXkpOwogICAgICAgICAgICAgICAgICAgIGlmIChsYXN0U2VxSWRT\nZWVuID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFNl\ncUlkU2VlbiA9IChsb25nKSAwOwogICAgICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICAgICAgaWYgKGdldFNyY1NlcUlkKG1zZykgPD0gbGFz\ndFNlcUlkU2VlbikgewogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu\naW5mbygiUmVkZWxpdmVyeSBvZiBtZXNzYWdlLCBzcmMtcmVnaW9uOiAiICsg\nbXNnLmdldFNyY1JlZ2lvbigpICsgInNlcS1pZDogIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICArIG1zZy5nZXRNc2dJZCgpKTsKICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICBhZ2cuZGluZyhmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hl\nZChjb250ZXh0LCBudWxsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSk7CiAgICAgICAgfQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigi\nRmluaXNoZWQgc3Vic2NyaWJpbmcgdG8gdG9waWNzIGFuZCBub3cgd2FpdGlu\nZyBmb3IgbWVzc2FnZXMgdG8gY29tZSBpbi4uLiIpOwogICAgICAgIC8vIFdh\naXQgdGlsbCB0aGUgYmVuY2htYXJrIHRlc3QgaGFzIGNvbXBsZXRlZAogICAg\nICAgIGFnZy5xdWV1ZS50YWtlKCk7CiAgICAgICAgU3lzdGVtLm91dC5wcmlu\ndGxuKGFnZy5zdW1tYXJpemUoYWdnLmVhcmxpZXN0LmdldCgpKSk7CiAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgbG9uZyBnZXRTcmNTZXFJZChN\nZXNzYWdlIG1zZykgewogICAgICAgIGlmIChtc2cuZ2V0TXNnSWQoKS5nZXRS\nZW1vdGVDb21wb25lbnRzQ291bnQoKSA9PSAwKSB7CiAgICAgICAgICAgIHJl\ndHVybiBtc2cuZ2V0TXNnSWQoKS5nZXRMb2NhbENvbXBvbmVudCgpOwogICAg\nICAgIH0KCiAgICAgICAgZm9yIChSZWdpb25TcGVjaWZpY1NlcUlkIHJzZXFJ\nZCA6IG1zZy5nZXRNc2dJZCgpLmdldFJlbW90ZUNvbXBvbmVudHNMaXN0KCkp\nIHsKICAgICAgICAgICAgaWYgKHJzZXFJZC5nZXRSZWdpb24oKS5lcXVhbHMo\nbXNnLmdldFNyY1JlZ2lvbigpKSkKICAgICAgICAgICAgICAgIHJldHVybiBy\nc2VxSWQuZ2V0U2VxSWQoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBt\nc2cuZ2V0TXNnSWQoKS5nZXRMb2NhbENvbXBvbmVudCgpOwogICAgfQoKICAg\nIHZvaWQgbXVsdGlTdWIoU3RyaW5nIGxhYmVsLCBTdHJpbmcgdG9waWNQcmVm\naXgsIGludCBzdGFydCwgZmluYWwgaW50IG5wYXIsIGZpbmFsIGludCBjb3Vu\ndCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsK\nICAgICAgICBsb25nIHN0YXJ0VGltZSA9IFN5c3RlbS5jdXJyZW50VGltZU1p\nbGxpcygpOwogICAgICAgIFRocm91Z2hwdXRMYXRlbmN5QWdncmVnYXRvciBh\nZ2cgPSBuZXcgVGhyb3VnaHB1dExhdGVuY3lBZ2dyZWdhdG9yKGxhYmVsLCBj\nb3VudCAvIG51bVBhcnRpdGlvbnMsIG5wYXIpOwogICAgICAgIGludCBlbmQg\nPSBzdGFydCArIGNvdW50OwogICAgICAgIGZvciAoaW50IGkgPSBzdGFydDsg\naSA8IGVuZDsgKytpKSB7CiAgICAgICAgICAgIGlmICghSGVkd2lnQmVuY2ht\nYXJrLmFtSVJlc3BvbnNpYmxlRm9yVG9waWMoaSwgcGFydGl0aW9uSW5kZXgs\nIG51bVBhcnRpdGlvbnMpKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBzdWJzY3JpYmVyLmFzeW5jU3Vi\nc2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KHRvcGljUHJlZml4ICsg\naSksIHN1YklkLCBDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNILAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBCZW5j\naG1hcmtDYWxsYmFjayhhZ2cpLCBudWxsKTsKICAgICAgICB9CiAgICAgICAg\nLy8gV2FpdCB0aWxsIHRoZSBiZW5jaG1hcmsgdGVzdCBoYXMgY29tcGxldGVk\nCiAgICAgICAgYWdnLnRwQWdnLnF1ZXVlLnRha2UoKTsKICAgICAgICBpZiAo\nY291bnQgPiAxKQogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oYWdn\nLnN1bW1hcml6ZShzdGFydFRpbWUpKTsKICAgIH0KCn0K\n","encoding":"base64"}

