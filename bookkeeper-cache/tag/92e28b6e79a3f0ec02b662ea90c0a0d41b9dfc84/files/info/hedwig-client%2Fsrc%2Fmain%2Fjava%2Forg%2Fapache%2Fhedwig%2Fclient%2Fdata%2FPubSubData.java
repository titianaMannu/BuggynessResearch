{"sha":"1b33c2fe1588eba970d78fecc1d999079cc40b5d","node_id":"MDQ6QmxvYjE1NzU5NTY6MWIzM2MyZmUxNTg4ZWJhOTcwZDc4ZmVjYzFkOTk5MDc5Y2M0MGI1ZA==","size":6937,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/1b33c2fe1588eba970d78fecc1d999079cc40b5d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZGF0YTsKCmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5\ndGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5Q\ndWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29s\nLlN1YnNjcmliZVJlcXVlc3QuQ3JlYXRlT3JBdHRhY2g7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNrOwoKLyoqCiAqIFdyYXBwZXIg\nY2xhc3MgdG8gc3RvcmUgYWxsIG9mIHRoZSBkYXRhIHBvaW50cyBuZWVkZWQg\ndG8gZW5jYXBzdWxhdGUgYWxsCiAqIFB1YlN1YiB0eXBlIG9mIHJlcXVlc3Qg\nb3BlcmF0aW9ucyB0aGUgY2xpZW50IHdpbGwgZG8uIFRoaXMgaW5jbHVkZXMg\na25vd2luZwogKiBhbGwgb2YgdGhlIGluZm9ybWF0aW9uIG5lZWRlZCBpZiB3\nZSBuZWVkIHRvIHJlZG8gdGhlIHB1Ymxpc2gvc3Vic2NyaWJlCiAqIHJlcXVl\nc3QgaW4gY2FzZSBvZiBhIHNlcnZlciByZWRpcmVjdC4gVGhpcyB3aWxsIGJl\nIHVzZWQgZm9yIGFsbCBzeW5jL2FzeW5jCiAqIGNhbGxzLCBhbmQgZm9yIGFs\nbCB0aGUga25vd24gdHlwZXMgb2YgcmVxdWVzdCBtZXNzYWdlcyB0byBzZW5k\nIHRvIHRoZSBzZXJ2ZXIKICogaHViczogUHVibGlzaCwgU3Vic2NyaWJlLCBV\nbnN1YnNjcmliZSwgYW5kIENvbnN1bWUuCiAqCiAqLwpwdWJsaWMgY2xhc3Mg\nUHViU3ViRGF0YSB7CiAgICAvLyBTdGF0aWMgc3RyaW5nIGNvbnN0YW50cwog\nICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09NTUEgPSAiLCAi\nOwoKICAgIC8vIE1lbWJlciB2YXJpYWJsZXMgbmVlZGVkIGR1cmluZyBvYmpl\nY3QgY29uc3RydWN0aW9uIHRpbWUuCiAgICBwdWJsaWMgZmluYWwgQnl0ZVN0\ncmluZyB0b3BpYzsKICAgIHB1YmxpYyBmaW5hbCBNZXNzYWdlIG1zZzsKICAg\nIHB1YmxpYyBmaW5hbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZDsKICAgIC8v\nIEVudW0gdG8gaW5kaWNhdGUgd2hhdCB0eXBlIG9mIG9wZXJhdGlvbiB0aGlz\nIFB1YlN1YiByZXF1ZXN0IGRhdGEgb2JqZWN0CiAgICAvLyBpcyBmb3IuCiAg\nICBwdWJsaWMgZmluYWwgT3BlcmF0aW9uVHlwZSBvcGVyYXRpb25UeXBlOwog\nICAgLy8gRW51bSBmb3Igc3Vic2NyaWJlIHJlcXVlc3RzIHRvIGluZGljYXRl\nIGlmIHRoaXMgaXMgYSBDUkVBVEUsIEFUVEFDSCwgb3IKICAgIC8vIENSRUFU\nRV9PUl9BVFRBQ0ggc3Vic2NyaXB0aW9uIHJlcXVlc3QuIEZvciBub24tc3Vi\nc2NyaWJlIHJlcXVlc3RzLAogICAgLy8gdGhpcyB3aWxsIGJlIG51bGwuCiAg\nICBwdWJsaWMgZmluYWwgQ3JlYXRlT3JBdHRhY2ggY3JlYXRlT3JBdHRhY2g7\nCiAgICAvLyBUaGVzZSB0d28gdmFyaWFibGVzIGFyZSBub3QgZmluYWwgc2lu\nY2Ugd2UgbWlnaHQgb3ZlcnJpZGUgdGhlbQogICAgLy8gaW4gdGhlIGNhc2Ug\nb2YgYSBTdWJzY3JpYmUgcmVjb25uZWN0LgogICAgcHVibGljIENhbGxiYWNr\nPFZvaWQ+IGNhbGxiYWNrOwogICAgcHVibGljIE9iamVjdCBjb250ZXh0OwoK\nICAgIC8vIE1lbWJlciB2YXJpYWJsZXMgdXNlZCBhZnRlciBvYmplY3QgaGFz\nIGJlZW4gY29uc3RydWN0ZWQuCiAgICAvLyBMaXN0IG9mIGFsbCBzZXJ2ZXJz\nIHdlJ3ZlIHNlbnQgdGhlIFB1YlN1YlJlcXVlc3QgdG8gc3VjY2Vzc2Z1bGx5\nLgogICAgLy8gVGhpcyBpcyB0byBrZWVwIHRyYWNrIG9mIHJlZGlyZWN0ZWQg\nc2VydmVycyB0aGF0IHJlc3BvbmRlZCBiYWNrIHRvIHVzLgogICAgcHVibGlj\nIExpc3Q8Qnl0ZVN0cmluZz4gdHJpZWRTZXJ2ZXJzOwogICAgLy8gTGlzdCBv\nZiBhbGwgc2VydmVycyB0aGF0IHdlJ3ZlIHRyaWVkIHRvIGNvbm5lY3Qgb3Ig\nd3JpdGUgdG8gYnV0CiAgICAvLyB3YXMgdW5zdWNjZXNzZnVsLiBXZSdsbCBy\nZXRyeSBzZW5kaW5nIHRoZSBQdWJTdWJSZXF1ZXN0IGJ1dCB3aWxsCiAgICAv\nLyBxdWl0IGlmIHdlJ3JlIHRyeWluZyB0byBjb25uZWN0IG9yIHdyaXRlIHRv\nIGEgc2VydmVyIHRoYXQgd2UndmUKICAgIC8vIGF0dGVtcHRlZCB0byBwcmV2\naW91c2x5LgogICAgcHVibGljIExpc3Q8Qnl0ZVN0cmluZz4gY29ubmVjdEZh\naWxlZFNlcnZlcnM7CiAgICBwdWJsaWMgTGlzdDxCeXRlU3RyaW5nPiB3cml0\nZUZhaWxlZFNlcnZlcnM7CiAgICAvLyBCb29sZWFuIHRvIHRoZSBodWIgc2Vy\ndmVyIGluZGljYXRpbmcgaWYgaXQgc2hvdWxkIGNsYWltIG93bmVyc2hpcAog\nICAgLy8gb2YgdGhlIHRvcGljIHRoZSBQdWJTdWJSZXF1ZXN0IGlzIGZvci4g\nVGhpcyBpcyBtYWlubHkgdXNlZCBhZnRlcgogICAgLy8gYSBzZXJ2ZXIgcmVk\naXJlY3QuIERlZmF1bHRzIHRvIGZhbHNlLgogICAgcHVibGljIGJvb2xlYW4g\nc2hvdWxkQ2xhaW0gPSBmYWxzZTsKICAgIC8vIFR4bklEIGZvciB0aGUgUHVi\nU3ViRGF0YSBpZiBpdCB3YXMgc2VudCBhcyBhIFB1YlN1YlJlcXVlc3QgdG8g\ndGhlIGh1YgogICAgLy8gc2VydmVyLiBUaGlzIGlzIHVzZWQgaW4gdGhlIFdy\naXRlQ2FsbGJhY2sgaW4gY2FzZSBvZiBmYWlsdXJlLiBXZSB3YW50CiAgICAv\nLyB0byByZW1vdmUgaXQgZnJvbSB0aGUgUmVzcG9uc2VIYW5kbGVyLnR4bjJQ\ndWJTdWJEYXRhIG1hcCBzaW5jZSB0aGUKICAgIC8vIGZhaWxlZCBQdWJTdWJS\nZXF1ZXN0IHdpbGwgbm90IGdldCBhbiBhY2sgcmVzcG9uc2UgZnJvbSB0aGUg\nc2VydmVyLgogICAgLy8gVGhpcyBpcyBzZXQgbGF0ZXIgaW4gdGhlIFB1YlN1\nYiBmbG93cyBvbmx5IHdoZW4gd2Ugd3JpdGUgdGhlIGFjdHVhbAogICAgLy8g\ncmVxdWVzdC4gVGhlcmVmb3JlIGl0IGlzIG5vdCBhbiBhcmd1bWVudCBpbiB0\naGUgY29uc3RydWN0b3IuCiAgICBwdWJsaWMgbG9uZyB0eG5JZDsKICAgIC8v\nIFRpbWUgaW4gbWlsbGlzZWNvbmRzIHVzaW5nIHRoZSBTeXN0ZW0uY3VycmVu\ndFRpbWVNaWxsaXMoKSBjYWxsIHdoZW4gdGhlCiAgICAvLyBQdWJTdWJSZXF1\nZXN0IHdhcyB3cml0dGVuIG9uIHRoZSBuZXR0eSBDaGFubmVsIHRvIHRoZSBz\nZXJ2ZXIuCiAgICBwdWJsaWMgbG9uZyByZXF1ZXN0V3JpdGVUaW1lOwogICAg\nLy8gRm9yIHN5bmNocm9ub3VzIGNhbGxzLCB0aGlzIHZhcmlhYmxlIGlzIHVz\nZWQgdG8ga25vdyB3aGVuIHRoZSBiYWNrZ3JvdW5kCiAgICAvLyBhc3luYyBw\ncm9jZXNzIGZvciBpdCBoYXMgY29tcGxldGVkLCBzZXQgaW4gdGhlIFZvaWRD\nYWxsYmFjay4KICAgIHB1YmxpYyBib29sZWFuIGlzRG9uZSA9IGZhbHNlOwoK\nICAgIC8vIENvbnN0cnVjdG9yIGZvciBhbGwgdHlwZXMgb2YgUHViU3ViIHJl\ncXVlc3QgZGF0YSB0byBzZW5kIHRvIHRoZSBzZXJ2ZXIKICAgIHB1YmxpYyBQ\ndWJTdWJEYXRhKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIE1lc3Nh\nZ2UgbXNnLCBmaW5hbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAg\nICAgICAgICAgICAgICAgIGZpbmFsIE9wZXJhdGlvblR5cGUgb3BlcmF0aW9u\nVHlwZSwgZmluYWwgQ3JlYXRlT3JBdHRhY2ggY3JlYXRlT3JBdHRhY2gsIGZp\nbmFsIENhbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLAogICAgICAgICAgICAgICAg\nICAgICAgZmluYWwgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICB0aGlzLnRv\ncGljID0gdG9waWM7CiAgICAgICAgdGhpcy5tc2cgPSBtc2c7CiAgICAgICAg\ndGhpcy5zdWJzY3JpYmVySWQgPSBzdWJzY3JpYmVySWQ7CiAgICAgICAgdGhp\ncy5vcGVyYXRpb25UeXBlID0gb3BlcmF0aW9uVHlwZTsKICAgICAgICB0aGlz\nLmNyZWF0ZU9yQXR0YWNoID0gY3JlYXRlT3JBdHRhY2g7CiAgICAgICAgdGhp\ncy5jYWxsYmFjayA9IGNhbGxiYWNrOwogICAgICAgIHRoaXMuY29udGV4dCA9\nIGNvbnRleHQ7CiAgICB9CgogICAgLy8gQ2xlYXIgYWxsIG9mIHRoZSBzdG9y\nZWQgc2VydmVycyB3ZSd2ZSBjb250YWN0ZWQgb3IgYXR0ZW1wdGVkIHRvIGlu\nIHRoaXMKICAgIC8vIHJlcXVlc3QuCiAgICBwdWJsaWMgdm9pZCBjbGVhclNl\ncnZlcnNMaXN0KCkgewogICAgICAgIGlmICh0cmllZFNlcnZlcnMgIT0gbnVs\nbCkKICAgICAgICAgICAgdHJpZWRTZXJ2ZXJzLmNsZWFyKCk7CiAgICAgICAg\naWYgKGNvbm5lY3RGYWlsZWRTZXJ2ZXJzICE9IG51bGwpCiAgICAgICAgICAg\nIGNvbm5lY3RGYWlsZWRTZXJ2ZXJzLmNsZWFyKCk7CiAgICAgICAgaWYgKHdy\naXRlRmFpbGVkU2VydmVycyAhPSBudWxsKQogICAgICAgICAgICB3cml0ZUZh\naWxlZFNlcnZlcnMuY2xlYXIoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgU3RyaW5nQnVp\nbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgaWYgKHRv\ncGljICE9IG51bGwpCiAgICAgICAgICAgIHNiLmFwcGVuZCgiVG9waWM6ICIg\nKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgaWYgKG1zZyAhPSBu\ndWxsKQogICAgICAgICAgICBzYi5hcHBlbmQoQ09NTUEpLmFwcGVuZCgiTWVz\nc2FnZTogIiArIG1zZyk7CiAgICAgICAgaWYgKHN1YnNjcmliZXJJZCAhPSBu\ndWxsKQogICAgICAgICAgICBzYi5hcHBlbmQoQ09NTUEpLmFwcGVuZCgiU3Vi\nc2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpKTsK\nICAgICAgICBpZiAob3BlcmF0aW9uVHlwZSAhPSBudWxsKQogICAgICAgICAg\nICBzYi5hcHBlbmQoQ09NTUEpLmFwcGVuZCgiT3BlcmF0aW9uIFR5cGU6ICIg\nKyBvcGVyYXRpb25UeXBlLnRvU3RyaW5nKCkpOwogICAgICAgIGlmIChjcmVh\ndGVPckF0dGFjaCAhPSBudWxsKQogICAgICAgICAgICBzYi5hcHBlbmQoQ09N\nTUEpLmFwcGVuZCgiQ3JlYXRlIE9yIEF0dGFjaDogIiArIGNyZWF0ZU9yQXR0\nYWNoLnRvU3RyaW5nKCkpOwogICAgICAgIGlmICh0cmllZFNlcnZlcnMgIT0g\nbnVsbCAmJiB0cmllZFNlcnZlcnMuc2l6ZSgpID4gMCkgewogICAgICAgICAg\nICBzYi5hcHBlbmQoQ09NTUEpLmFwcGVuZCgiVHJpZWQgU2VydmVyczogIik7\nCiAgICAgICAgICAgIGZvciAoQnl0ZVN0cmluZyB0cmllZFNlcnZlciA6IHRy\naWVkU2VydmVycykgewogICAgICAgICAgICAgICAgc2IuYXBwZW5kKHRyaWVk\nU2VydmVyLnRvU3RyaW5nVXRmOCgpKS5hcHBlbmQoQ09NTUEpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChjb25uZWN0RmFpbGVkU2Vy\ndmVycyAhPSBudWxsICYmIGNvbm5lY3RGYWlsZWRTZXJ2ZXJzLnNpemUoKSA+\nIDApIHsKICAgICAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBlbmQoIkNv\nbm5lY3QgRmFpbGVkIFNlcnZlcnM6ICIpOwogICAgICAgICAgICBmb3IgKEJ5\ndGVTdHJpbmcgY29ubmVjdEZhaWxlZFNlcnZlciA6IGNvbm5lY3RGYWlsZWRT\nZXJ2ZXJzKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBlbmQoY29ubmVjdEZh\naWxlZFNlcnZlci50b1N0cmluZ1V0ZjgoKSkuYXBwZW5kKENPTU1BKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAod3JpdGVGYWlsZWRT\nZXJ2ZXJzICE9IG51bGwgJiYgd3JpdGVGYWlsZWRTZXJ2ZXJzLnNpemUoKSA+\nIDApIHsKICAgICAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBlbmQoIldy\naXRlIEZhaWxlZCBTZXJ2ZXJzOiAiKTsKICAgICAgICAgICAgZm9yIChCeXRl\nU3RyaW5nIHdyaXRlRmFpbGVkU2VydmVyIDogd3JpdGVGYWlsZWRTZXJ2ZXJz\nKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBlbmQod3JpdGVGYWlsZWRTZXJ2\nZXIudG9TdHJpbmdVdGY4KCkpLmFwcGVuZChDT01NQSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBlbmQo\nIlNob3VsZCBDbGFpbTogIiArIHNob3VsZENsYWltKTsKICAgICAgICBpZiAo\ndHhuSWQgIT0gMCkKICAgICAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBl\nbmQoIlR4bklEOiAiICsgdHhuSWQpOwogICAgICAgIGlmIChyZXF1ZXN0V3Jp\ndGVUaW1lICE9IDApCiAgICAgICAgICAgIHNiLmFwcGVuZChDT01NQSkuYXBw\nZW5kKCJSZXF1ZXN0IFdyaXRlIFRpbWU6ICIgKyByZXF1ZXN0V3JpdGVUaW1l\nKTsKICAgICAgICBzYi5hcHBlbmQoQ09NTUEpLmFwcGVuZCgiSXMgRG9uZTog\nIiArIGlzRG9uZSk7CiAgICAgICAgcmV0dXJuIHNiLnRvU3RyaW5nKCk7CiAg\nICB9Cgp9Cg==\n","encoding":"base64"}

