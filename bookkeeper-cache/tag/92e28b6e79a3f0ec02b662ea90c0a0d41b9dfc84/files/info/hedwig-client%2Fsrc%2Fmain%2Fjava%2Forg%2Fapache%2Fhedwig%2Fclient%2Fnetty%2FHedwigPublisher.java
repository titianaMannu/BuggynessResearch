{"sha":"603766c5f2d96185dd61457197f810cbe0194df7","node_id":"MDQ6QmxvYjE1NzU5NTY6NjAzNzY2YzVmMmQ5NjE4NWRkNjE0NTcxOTdmODEwY2JlMDE5NGRmNw==","size":11992,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/603766c5f2d96185dd61457197f810cbe0194df7","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHk7CgppbXBvcnQg\namF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LkNvbmN1cnJlbnRNYXA7CgppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBv\ncnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbDsKaW1wb3J0IG9y\nZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxGdXR1cmU7CgppbXBvcnQg\nY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5QdWJsaXNoZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5DbGllbnRDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEuUHViU3Vi\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5oYW5kbGVy\ncy5QdWJTdWJDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4\nY2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb24uQ291bGROb3RDb25u\nZWN0RXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0\naW9ucy5QdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wu\nUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlByb3RvY29sVmVy\nc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLlB1YlN1YlJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5QdWJsaXNoUmVxdWVzdDsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7CgovKioK\nICogVGhpcyBpcyB0aGUgSGVkd2lnIE5ldHR5IHNwZWNpZmljIGltcGxlbWVu\ndGF0aW9uIG9mIHRoZSBQdWJsaXNoZXIgaW50ZXJmYWNlLgogKgogKi8KcHVi\nbGljIGNsYXNzIEhlZHdpZ1B1Ymxpc2hlciBpbXBsZW1lbnRzIFB1Ymxpc2hl\nciB7CgogICAgcHJpdmF0ZSBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dl\nckZhY3RvcnkuZ2V0TG9nZ2VyKEhlZHdpZ1B1Ymxpc2hlci5jbGFzcyk7Cgog\nICAgLy8gQ29uY3VycmVudCBNYXAgdG8gc3RvcmUgdGhlIG1hcHBpbmdzIGZv\nciBhIGdpdmVuIEhvc3QgKEhvc3RuYW1lOlBvcnQpIHRvCiAgICAvLyB0aGUg\nQ2hhbm5lbCB0aGF0IGhhcyBiZWVuIGVzdGFibGlzaGVkIGZvciBpdCBwcmV2\naW91c2x5LiBUaGlzIGNoYW5uZWwKICAgIC8vIHdpbGwgYmUgdXNlZCB3aGVu\nZXZlciB3ZSBwdWJsaXNoIG9uIGEgdG9waWMgdGhhdCB0aGUgc2VydmVyIGlz\nIHRoZSBtYXN0ZXIKICAgIC8vIG9mIGN1cnJlbnRseS4gVGhlIGNoYW5uZWxz\nIHVzZWQgaGVyZSB3aWxsIG9ubHkgYmUgdXNlZCBmb3IgcHVibGlzaCBhbmQK\nICAgIC8vIHVuc3Vic2NyaWJlIHJlcXVlc3RzLgogICAgcHJvdGVjdGVkIGZp\nbmFsIENvbmN1cnJlbnRNYXA8SW5ldFNvY2tldEFkZHJlc3MsIENoYW5uZWw+\nIGhvc3QyQ2hhbm5lbCA9IG5ldyBDb25jdXJyZW50SGFzaE1hcDxJbmV0U29j\na2V0QWRkcmVzcywgQ2hhbm5lbD4oKTsKCiAgICBwcml2YXRlIGZpbmFsIEhl\nZHdpZ0NsaWVudEltcGwgY2xpZW50OwogICAgcHJpdmF0ZSBmaW5hbCBDbGll\nbnRDb25maWd1cmF0aW9uIGNmZzsKCiAgICBwcm90ZWN0ZWQgSGVkd2lnUHVi\nbGlzaGVyKEhlZHdpZ0NsaWVudEltcGwgY2xpZW50KSB7CiAgICAgICAgdGhp\ncy5jbGllbnQgPSBjbGllbnQ7CiAgICAgICAgdGhpcy5jZmcgPSBjbGllbnQu\nZ2V0Q29uZmlndXJhdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHB1\nYmxpc2goQnl0ZVN0cmluZyB0b3BpYywgTWVzc2FnZSBtc2cpIHRocm93cyBD\nb3VsZE5vdENvbm5lY3RFeGNlcHRpb24sIFNlcnZpY2VEb3duRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAg\nICAgICAgIGxvZ2dlci5kZWJ1ZygiQ2FsbGluZyBhIHN5bmMgcHVibGlzaCBm\nb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIG1zZzog\nIiArIG1zZyk7CiAgICAgICAgUHViU3ViRGF0YSBwdWJTdWJEYXRhID0gbmV3\nIFB1YlN1YkRhdGEodG9waWMsIG1zZywgbnVsbCwgT3BlcmF0aW9uVHlwZS5Q\nVUJMSVNILCBudWxsLCBudWxsLCBudWxsKTsKICAgICAgICBzeW5jaHJvbml6\nZWQgKHB1YlN1YkRhdGEpIHsKICAgICAgICAgICAgUHViU3ViQ2FsbGJhY2sg\ncHViU3ViQ2FsbGJhY2sgPSBuZXcgUHViU3ViQ2FsbGJhY2socHViU3ViRGF0\nYSk7CiAgICAgICAgICAgIGFzeW5jUHVibGlzaCh0b3BpYywgbXNnLCBwdWJT\ndWJDYWxsYmFjaywgbnVsbCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICB3aGlsZSAoIXB1YlN1YkRhdGEuaXNEb25lKQogICAgICAgICAg\nICAgICAgICAgIHB1YlN1YkRhdGEud2FpdCgpOwogICAgICAgICAgICB9IGNh\ndGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgU2VydmljZURvd25FeGNlcHRpb24oIkludGVycnVwdGVk\nIEV4Y2VwdGlvbiB3aGlsZSB3YWl0aW5nIGZvciBhc3luYyBwdWJsaXNoIGNh\nbGwiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBDaGVjayBmcm9t\nIHRoZSBQdWJTdWJDYWxsYmFjayBpZiBpdCB3YXMgc3VjY2Vzc2Z1bCBvciBu\nb3QuCiAgICAgICAgICAgIGlmICghcHViU3ViQ2FsbGJhY2suZ2V0SXNDYWxs\nU3VjY2Vzc2Z1bCgpKSB7CiAgICAgICAgICAgICAgICAvLyBTZWUgd2hhdCB0\naGUgZXhjZXB0aW9uIHdhcyB0aGF0IHdhcyB0aHJvd24gd2hlbiB0aGUgb3Bl\ncmF0aW9uCiAgICAgICAgICAgICAgICAvLyBmYWlsZWQuCiAgICAgICAgICAg\nICAgICBQdWJTdWJFeGNlcHRpb24gZmFpbHVyZUV4Y2VwdGlvbiA9IHB1YlN1\nYkNhbGxiYWNrLmdldEZhaWx1cmVFeGNlcHRpb24oKTsKICAgICAgICAgICAg\nICAgIGlmIChmYWlsdXJlRXhjZXB0aW9uID09IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICAvLyBUaGlzIHNob3VsZCBub3QgaGFwcGVuIGFzIHRoZSBv\ncGVyYXRpb24gZmFpbGVkIGJ1dCBhIG51bGwKICAgICAgICAgICAgICAgICAg\nICAvLyBQdWJTdWJFeGNlcHRpb24gd2FzIHBhc3NlZC4gTG9nIGEgd2Fybmlu\nZyBtZXNzYWdlIGJ1dAogICAgICAgICAgICAgICAgICAgIC8vIHRocm93IGEg\nZ2VuZXJpYyBTZXJ2aWNlRG93bkV4Y2VwdGlvbi4KICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIlN5bmMgUHVibGlzaCBvcGVyYXRpb24gZmFp\nbGVkIGJ1dCBubyBQdWJTdWJFeGNlcHRpb24gd2FzIHBhc3NlZCEiKTsKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2VydmljZURvd25FeGNlcHRp\nb24oIlNlcnZlciBhY2sgcmVzcG9uc2UgdG8gcHVibGlzaCByZXF1ZXN0IGlz\nIG5vdCBzdWNjZXNzZnVsIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAvLyBGb3IgdGhlIGV4cGVjdGVkIGV4Y2VwdGlvbnMgdGhhdCBj\nb3VsZCBvY2N1ciwganVzdCByZXRocm93CiAgICAgICAgICAgICAgICAvLyB0\naGVtLgogICAgICAgICAgICAgICAgZWxzZSBpZiAoZmFpbHVyZUV4Y2VwdGlv\nbiBpbnN0YW5jZW9mIENvdWxkTm90Q29ubmVjdEV4Y2VwdGlvbikgewogICAg\nICAgICAgICAgICAgICAgIHRocm93IChDb3VsZE5vdENvbm5lY3RFeGNlcHRp\nb24pIGZhaWx1cmVFeGNlcHRpb247CiAgICAgICAgICAgICAgICB9IGVsc2Ug\naWYgKGZhaWx1cmVFeGNlcHRpb24gaW5zdGFuY2VvZiBTZXJ2aWNlRG93bkV4\nY2VwdGlvbikgewogICAgICAgICAgICAgICAgICAgIHRocm93IChTZXJ2aWNl\nRG93bkV4Y2VwdGlvbikgZmFpbHVyZUV4Y2VwdGlvbjsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIG90aGVy\nIHR5cGVzIG9mIFB1YlN1YkV4Y2VwdGlvbnMsIGp1c3QgdGhyb3cgYSBnZW5l\ncmljCiAgICAgICAgICAgICAgICAgICAgLy8gU2VydmljZURvd25FeGNlcHRp\nb24gYnV0IGxvZyBhIHdhcm5pbmcgbWVzc2FnZS4KICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIlVuZXhwZWN0ZWQgZXhjZXB0aW9uIHR5cGUg\nd2hlbiBhIHN5bmMgcHVibGlzaCBvcGVyYXRpb24gZmFpbGVkOiAiICsgZmFp\nbHVyZUV4Y2VwdGlvbik7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIFNlcnZpY2VEb3duRXhjZXB0aW9uKCJTZXJ2ZXIgYWNrIHJlc3BvbnNlIHRv\nIHB1Ymxpc2ggcmVxdWVzdCBpcyBub3Qgc3VjY2Vzc2Z1bCIpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGFzeW5jUHVibGlzaChCeXRlU3RyaW5nIHRvcGljLCBN\nZXNzYWdlIG1zZywgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIE9iamVjdCBj\nb250ZXh0KSB7CiAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgp\nKQogICAgICAgICAgICBsb2dnZXIuZGVidWcoIkNhbGxpbmcgYW4gYXN5bmMg\ncHVibGlzaCBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSAr\nICIsIG1zZzogIiArIG1zZyk7CiAgICAgICAgLy8gQ2hlY2sgaWYgd2UgYWxy\nZWFkeSBoYXZlIGEgQ2hhbm5lbCBjb25uZWN0aW9uIHNldCB1cCB0byB0aGUg\nc2VydmVyCiAgICAgICAgLy8gZm9yIHRoZSBnaXZlbiBUb3BpYy4KICAgICAg\nICBQdWJTdWJEYXRhIHB1YlN1YkRhdGEgPSBuZXcgUHViU3ViRGF0YSh0b3Bp\nYywgbXNnLCBudWxsLCBPcGVyYXRpb25UeXBlLlBVQkxJU0gsIG51bGwsIGNh\nbGxiYWNrLCBjb250ZXh0KTsKICAgICAgICBpZiAoY2xpZW50LnRvcGljMkhv\nc3QuY29udGFpbnNLZXkodG9waWMpKSB7CiAgICAgICAgICAgIEluZXRTb2Nr\nZXRBZGRyZXNzIGhvc3QgPSBjbGllbnQudG9waWMySG9zdC5nZXQodG9waWMp\nOwogICAgICAgICAgICBpZiAoaG9zdDJDaGFubmVsLmNvbnRhaW5zS2V5KGhv\nc3QpKSB7CiAgICAgICAgICAgICAgICAvLyBXZSBhbHJlYWR5IGhhdmUgdGhl\nIENoYW5uZWwgY29ubmVjdGlvbiBmb3IgdGhlIHNlcnZlciBob3N0IHNvCiAg\nICAgICAgICAgICAgICAvLyBkbyB0aGUgcHVibGlzaCBkaXJlY3RseS4gV2Ug\nd2lsbCBkZWFsIHdpdGggcmVkaXJlY3QgbG9naWMKICAgICAgICAgICAgICAg\nIC8vIGxhdGVyIG9uIGlmIHRoYXQgc2VydmVyIGlzIG5vIGxvbmdlciB0aGUg\nY3VycmVudCBob3N0IGZvcgogICAgICAgICAgICAgICAgLy8gdGhlIHRvcGlj\nLgogICAgICAgICAgICAgICAgZG9QdWJsaXNoKHB1YlN1YkRhdGEsIGhvc3Qy\nQ2hhbm5lbC5nZXQoaG9zdCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIG1hcHBpbmcgZm9yIHRoZSB0b3Bp\nYyB0byBob3N0IGJ1dCBkb24ndCBoYXZlIGEKICAgICAgICAgICAgICAgIC8v\nIENoYW5uZWwgZm9yIHRoYXQgc2VydmVyLiBUaGlzIGNhbiBoYXBwZW4gaWYg\ndGhlIENoYW5uZWwKICAgICAgICAgICAgICAgIC8vIGlzIGRpc2Nvbm5lY3Rl\nZCBmb3Igc29tZSByZWFzb24uIERvIHRoZSBjb25uZWN0IHRoZW4gdG8KICAg\nICAgICAgICAgICAgIC8vIHRoZSBzcGVjaWZpZWQgc2VydmVyIGhvc3QgdG8g\nY3JlYXRlIGEgbmV3IENoYW5uZWwgY29ubmVjdGlvbi4KICAgICAgICAgICAg\nICAgIGNsaWVudC5kb0Nvbm5lY3QocHViU3ViRGF0YSwgaG9zdCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBTZXJ2\nZXIgaG9zdCBmb3IgdGhlIGdpdmVuIHRvcGljIGlzIG5vdCBrbm93biB5ZXQg\nc28gdXNlIHRoZQogICAgICAgICAgICAvLyBkZWZhdWx0IHNlcnZlciBob3N0\nL3BvcnQgYXMgZGVmaW5lZCBpbiB0aGUgY29uZmlncy4gVGhpcyBzaG91bGQK\nICAgICAgICAgICAgLy8gcG9pbnQgdG8gdGhlIHNlcnZlciBWSVAgd2hpY2gg\nd291bGQgcmVkaXJlY3QgdG8gYSByYW5kb20gc2VydmVyCiAgICAgICAgICAg\nIC8vICh3aGljaCBtaWdodCBub3QgYmUgdGhlIHNlcnZlciBob3N0aW5nIHRo\nZSB0b3BpYykuCiAgICAgICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGhvc3Qg\nPSBjZmcuZ2V0RGVmYXVsdFNlcnZlckhvc3QoKTsKICAgICAgICAgICAgaWYg\nKGhvc3QyQ2hhbm5lbC5jb250YWluc0tleShob3N0KSkgewogICAgICAgICAg\nICAgICAgLy8gaWYgdGhlcmUgaXMgYSBjaGFubmVsIHRvIGRlZmF1bHQgc2Vy\ndmVyLCB1c2UgaXQhCiAgICAgICAgICAgICAgICBkb1B1Ymxpc2gocHViU3Vi\nRGF0YSwgaG9zdDJDaGFubmVsLmdldChob3N0KSk7CiAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xpZW50LmRv\nQ29ubmVjdChwdWJTdWJEYXRhLCBob3N0KTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGlzIGlzIGEgaGVscGVyIG1ldGhvZCB0byB3cml0\nZSB0aGUgYWN0dWFsIHB1Ymxpc2ggbWVzc2FnZSBvbmNlIHRoZQogICAgICog\nY2xpZW50IGlzIGNvbm5lY3RlZCB0byB0aGUgc2VydmVyIGFuZCBhIENoYW5u\nZWwgaXMgYXZhaWxhYmxlLgogICAgICoKICAgICAqIEBwYXJhbSBwdWJTdWJE\nYXRhCiAgICAgKiAgICAgICAgICAgIFB1Ymxpc2ggY2FsbCdzIGRhdGEgd3Jh\ncHBlciBvYmplY3QKICAgICAqIEBwYXJhbSBjaGFubmVsCiAgICAgKiAgICAg\nICAgICAgIE5ldHR5IEkvTyBjaGFubmVsIGZvciBjb21tdW5pY2F0aW9uIGJl\ndHdlZW4gdGhlIGNsaWVudCBhbmQKICAgICAqICAgICAgICAgICAgc2VydmVy\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGRvUHVibGlzaChQdWJTdWJE\nYXRhIHB1YlN1YkRhdGEsIENoYW5uZWwgY2hhbm5lbCkgewogICAgICAgIC8v\nIENyZWF0ZSBhIFB1YlN1YlJlcXVlc3QKICAgICAgICBQdWJTdWJSZXF1ZXN0\nLkJ1aWxkZXIgcHVic3ViUmVxdWVzdEJ1aWxkZXIgPSBQdWJTdWJSZXF1ZXN0\nLm5ld0J1aWxkZXIoKTsKICAgICAgICBwdWJzdWJSZXF1ZXN0QnVpbGRlci5z\nZXRQcm90b2NvbFZlcnNpb24oUHJvdG9jb2xWZXJzaW9uLlZFUlNJT05fT05F\nKTsKICAgICAgICBwdWJzdWJSZXF1ZXN0QnVpbGRlci5zZXRUeXBlKE9wZXJh\ndGlvblR5cGUuUFVCTElTSCk7CiAgICAgICAgaWYgKHB1YlN1YkRhdGEudHJp\nZWRTZXJ2ZXJzICE9IG51bGwgJiYgcHViU3ViRGF0YS50cmllZFNlcnZlcnMu\nc2l6ZSgpID4gMCkgewogICAgICAgICAgICBwdWJzdWJSZXF1ZXN0QnVpbGRl\nci5hZGRBbGxUcmllZFNlcnZlcnMocHViU3ViRGF0YS50cmllZFNlcnZlcnMp\nOwogICAgICAgIH0KICAgICAgICBsb25nIHR4bklkID0gY2xpZW50Lmdsb2Jh\nbENvdW50ZXIuaW5jcmVtZW50QW5kR2V0KCk7CiAgICAgICAgcHVic3ViUmVx\ndWVzdEJ1aWxkZXIuc2V0VHhuSWQodHhuSWQpOwogICAgICAgIHB1YnN1YlJl\ncXVlc3RCdWlsZGVyLnNldFNob3VsZENsYWltKHB1YlN1YkRhdGEuc2hvdWxk\nQ2xhaW0pOwogICAgICAgIHB1YnN1YlJlcXVlc3RCdWlsZGVyLnNldFRvcGlj\nKHB1YlN1YkRhdGEudG9waWMpOwoKICAgICAgICAvLyBOb3cgY3JlYXRlIHRo\nZSBQdWJsaXNoUmVxdWVzdAogICAgICAgIFB1Ymxpc2hSZXF1ZXN0LkJ1aWxk\nZXIgcHVibGlzaFJlcXVlc3RCdWlsZGVyID0gUHVibGlzaFJlcXVlc3QubmV3\nQnVpbGRlcigpOwoKICAgICAgICBwdWJsaXNoUmVxdWVzdEJ1aWxkZXIuc2V0\nTXNnKHB1YlN1YkRhdGEubXNnKTsKCiAgICAgICAgLy8gU2V0IHRoZSBQdWJs\naXNoUmVxdWVzdCBpbnRvIHRoZSBvdXRlciBQdWJTdWJSZXF1ZXN0CiAgICAg\nICAgcHVic3ViUmVxdWVzdEJ1aWxkZXIuc2V0UHVibGlzaFJlcXVlc3QocHVi\nbGlzaFJlcXVlc3RCdWlsZGVyKTsKCiAgICAgICAgLy8gVXBkYXRlIHRoZSBQ\ndWJTdWJEYXRhIHdpdGggdGhlIHR4bklkIGFuZCB0aGUgcmVxdWVzdFdyaXRl\nVGltZQogICAgICAgIHB1YlN1YkRhdGEudHhuSWQgPSB0eG5JZDsKICAgICAg\nICBwdWJTdWJEYXRhLnJlcXVlc3RXcml0ZVRpbWUgPSBTeXN0ZW0uY3VycmVu\ndFRpbWVNaWxsaXMoKTsKCiAgICAgICAgLy8gQmVmb3JlIHdlIGRvIHRoZSB3\ncml0ZSwgc3RvcmUgdGhpcyBpbmZvcm1hdGlvbiBpbnRvIHRoZQogICAgICAg\nIC8vIFJlc3BvbnNlSGFuZGxlciBzbyB3aGVuIHRoZSBzZXJ2ZXIgcmVzcG9u\nZHMsIHdlIGtub3cgd2hhdAogICAgICAgIC8vIGFwcHJvcHJpYXRlIENhbGxi\nYWNrIERhdGEgdG8gaW52b2tlIGZvciB0aGUgZ2l2ZW4gdHhuIElELgogICAg\nICAgIEhlZHdpZ0NsaWVudEltcGwuZ2V0UmVzcG9uc2VIYW5kbGVyRnJvbUNo\nYW5uZWwoY2hhbm5lbCkudHhuMlB1YlN1YkRhdGEucHV0KHR4bklkLCBwdWJT\ndWJEYXRhKTsKCiAgICAgICAgLy8gRmluYWxseSwgd3JpdGUgdGhlIFB1Ymxp\nc2ggcmVxdWVzdCB0aHJvdWdoIHRoZSBDaGFubmVsLgogICAgICAgIGlmIChs\nb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nZ2VyLmRl\nYnVnKCJXcml0aW5nIGEgUHVibGlzaCByZXF1ZXN0IHRvIGhvc3Q6ICIgKyBI\nZWR3aWdDbGllbnRJbXBsLmdldEhvc3RGcm9tQ2hhbm5lbChjaGFubmVsKQog\nICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGZvciBwdWJTdWJEYXRhOiAi\nICsgcHViU3ViRGF0YSk7CiAgICAgICAgQ2hhbm5lbEZ1dHVyZSBmdXR1cmUg\nPSBjaGFubmVsLndyaXRlKHB1YnN1YlJlcXVlc3RCdWlsZGVyLmJ1aWxkKCkp\nOwogICAgICAgIGZ1dHVyZS5hZGRMaXN0ZW5lcihuZXcgV3JpdGVDYWxsYmFj\nayhwdWJTdWJEYXRhLCBjbGllbnQpKTsKICAgIH0KCiAgICAvLyBTeW5jaHJv\nbml6ZWQgbWV0aG9kIHRvIHN0b3JlIHRoZSBob3N0MkNoYW5uZWwgbWFwcGlu\nZyAoaWYgaXQgZG9lc24ndAogICAgLy8gZXhpc3QgeWV0KS4gUmV0cmlldmUg\ndGhlIGhvc3RuYW1lIGluZm8gZnJvbSB0aGUgQ2hhbm5lbCBjcmVhdGVkIHZp\nYSB0aGUKICAgIC8vIFJlbW90ZUFkZHJlc3MgdGllZCB0byBpdC4KICAgIHBy\nb3RlY3RlZCBzeW5jaHJvbml6ZWQgdm9pZCBzdG9yZUhvc3QyQ2hhbm5lbE1h\ncHBpbmcoQ2hhbm5lbCBjaGFubmVsKSB7CiAgICAgICAgSW5ldFNvY2tldEFk\nZHJlc3MgaG9zdCA9IEhlZHdpZ0NsaWVudEltcGwuZ2V0SG9zdEZyb21DaGFu\nbmVsKGNoYW5uZWwpOwogICAgICAgIGlmICghaG9zdDJDaGFubmVsLmNvbnRh\naW5zS2V5KGhvc3QpKSB7CiAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1\nZ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3Rv\ncmluZyBhIG5ldyBDaGFubmVsIG1hcHBpbmcgZm9yIGhvc3Q6ICIgKyBob3N0\nKTsKICAgICAgICAgICAgaG9zdDJDaGFubmVsLnB1dChob3N0LCBjaGFubmVs\nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBJZiB3ZSd2ZSBy\nZWFjaGVkIGhlcmUsIHRoYXQgbWVhbnMgd2UgYWxyZWFkeSBoYXZlIGEgQ2hh\nbm5lbAogICAgICAgICAgICAvLyBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4gaG9z\ndC4gVGhpcyBzaG91bGQgaWRlYWxseSBub3QgaGFwcGVuCiAgICAgICAgICAg\nIC8vIGFuZCBpdCBtZWFucyB3ZSBhcmUgY3JlYXRpbmcgYW5vdGhlciBDaGFu\nbmVsIHRvIGEgc2VydmVyIGhvc3QKICAgICAgICAgICAgLy8gdG8gcHVibGlz\naCBvbiB3aGVuIHdlIGNvdWxkIGhhdmUgdXNlZCBhbiBleGlzdGluZyBvbmUu\nIFRoaXMgY291bGQKICAgICAgICAgICAgLy8gaGFwcGVuIGR1ZSB0byBhIHJh\nY2UgY29uZGl0aW9uIGlmIGluaXRpYWxseSBtdWx0aXBsZSBjb25jdXJyZW50\nCiAgICAgICAgICAgIC8vIHRocmVhZHMgYXJlIHB1Ymxpc2hpbmcgb24gdGhl\nIHNhbWUgdG9waWMgYW5kIG5vIENoYW5uZWwgZXhpc3RzCiAgICAgICAgICAg\nIC8vIGN1cnJlbnRseSB0byB0aGUgc2VydmVyLiBXZSBhcmUgbm90IHN5bmNo\ncm9uaXppbmcgdGhpcyBpbml0aWFsCiAgICAgICAgICAgIC8vIGNyZWF0aW9u\nIG9mIENoYW5uZWxzIHRvIGEgZ2l2ZW4gaG9zdCBmb3IgcGVyZm9ybWFuY2Uu\nCiAgICAgICAgICAgIC8vIEFub3RoZXIgcG9zc2libGUgd2F5IHRvIGhhdmUg\ncmVkdW5kYW50IENoYW5uZWxzIGNyZWF0ZWQgaXMgaWYKICAgICAgICAgICAg\nLy8gYSBuZXcgdG9waWMgaXMgYmVpbmcgcHVibGlzaGVkIHRvLCB3ZSBjb25u\nZWN0IHRvIHRoZSBkZWZhdWx0CiAgICAgICAgICAgIC8vIHNlcnZlciBob3N0\nIHdoaWNoIHNob3VsZCBiZSBhIFZJUCB0aGF0IHJlZGlyZWN0cyB0byBhICJy\nZWFsIgogICAgICAgICAgICAvLyBzZXJ2ZXIgaG9zdC4gU2luY2Ugd2UgZG9u\nJ3Qga25vdyBiZWZvcmVoYW5kIHdoYXQgaXMgdGhlIGZ1bGwKICAgICAgICAg\nICAgLy8gc2V0IG9mIHNlcnZlciBob3N0cywgd2UgY291bGQgYmUgcmVkaXJl\nY3RlZCB0byBhIHNlcnZlciB0aGF0CiAgICAgICAgICAgIC8vIHdlIGFscmVh\nZHkgaGF2ZSBhIGNoYW5uZWwgY29ubmVjdGlvbiB0byBmcm9tIGEgcHJpb3Ig\nZXhpc3RpbmcKICAgICAgICAgICAgLy8gdG9waWMuIENsb3NlIHRoZXNlIHJl\nZHVuZGFudCBjaGFubmVscyBhcyB0aGV5IHdvbid0IGJlIHVzZWQuCiAgICAg\nICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAg\nICAgICAgIGxvZ2dlci5kZWJ1ZygiQ2hhbm5lbCBtYXBwaW5nIHRvIGhvc3Q6\nICIgKyBob3N0ICsgIiBhbHJlYWR5IGV4aXN0cyBzbyBubyBuZWVkIHRvIHN0\nb3JlIGl0LiIpOwogICAgICAgICAgICBIZWR3aWdDbGllbnRJbXBsLmdldFJl\nc3BvbnNlSGFuZGxlckZyb21DaGFubmVsKGNoYW5uZWwpLmNoYW5uZWxDbG9z\nZWRFeHBsaWNpdGx5ID0gdHJ1ZTsKICAgICAgICAgICAgY2hhbm5lbC5jbG9z\nZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBQdWJsaWMgZ2V0dGVyIGZv\nciBlbnRyaWVzIGluIHRoZSBob3N0MkNoYW5uZWwgTWFwLgogICAgLy8gVGhp\ncyBpcyB1c2VkIGZvciBjbGFzc2VzIHRoYXQgbmVlZCB0aGlzIGluZm9ybWF0\naW9uIGJ1dCBhcmUgbm90IGluIHRoZQogICAgLy8gc2FtZSBjbGFzc3BhdGgu\nCiAgICBwdWJsaWMgQ2hhbm5lbCBnZXRDaGFubmVsRm9ySG9zdChJbmV0U29j\na2V0QWRkcmVzcyBob3N0KSB7CiAgICAgICAgcmV0dXJuIGhvc3QyQ2hhbm5l\nbC5nZXQoaG9zdCk7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

