{"sha":"5fb1d8852652c205519abc875c7280131b439426","node_id":"MDQ6QmxvYjE1NzU5NTY6NWZiMWQ4ODUyNjUyYzIwNTUxOWFiYzg3NWM3MjgwMTMxYjQzOTQyNg==","size":32934,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5fb1d8852652c205519abc875c7280131b439426","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQubmV0dHk7CgppbXBvcnQg\namF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0aWwu\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRI\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVu\ndE1hcDsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlckZhY3Rvcnk7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hh\nbm5lbC5DaGFubmVsOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwu\nQ2hhbm5lbEZ1dHVyZTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVs\nLkNoYW5uZWxGdXR1cmVMaXN0ZW5lcjsKCmltcG9ydCBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5j\nbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LmFwaS5TdWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5kYXRhLlB1YlN1YkRhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZGF0YS5Ub3BpY1N1\nYnNjcmliZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZXhj\nZXB0aW9ucy5JbnZhbGlkU3Vic2NyaWJlcklkRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmhhbmRsZXJzLlB1YlN1YkNhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0aW9ucy5QdWJT\ndWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5leGNlcHRp\nb25zLlB1YlN1YkV4Y2VwdGlvbi5DbGllbnRBbHJlYWR5U3Vic2NyaWJlZEV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMu\nUHViU3ViRXhjZXB0aW9uLkNsaWVudE5vdFN1YnNjcmliZWRFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4\nY2VwdGlvbi5Db3VsZE5vdENvbm5lY3RFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbi5TZXJ2\naWNlRG93bkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvY29sLlB1YlN1YlByb3RvY29sLkNvbnN1bWVSZXF1ZXN0OwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVz\nc2FnZVNlcUlkOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wu\nUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlByb3RvY29sVmVy\nc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLlB1YlN1YlJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1ZXN0\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJv\ndG9jb2wuVW5zdWJzY3JpYmVSZXF1ZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVz\ndC5DcmVhdGVPckF0dGFjaDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvZXh0ZW5zaW9ucy5TdWJzY3JpcHRpb25TdGF0ZVV0aWxzOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazsKCi8qKgogKiBUaGlz\nIGlzIHRoZSBIZWR3aWcgTmV0dHkgc3BlY2lmaWMgaW1wbGVtZW50YXRpb24g\nb2YgdGhlIFN1YnNjcmliZXIgaW50ZXJmYWNlLgogKgogKi8KcHVibGljIGNs\nYXNzIEhlZHdpZ1N1YnNjcmliZXIgaW1wbGVtZW50cyBTdWJzY3JpYmVyIHsK\nCiAgICBwcml2YXRlIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoSGVkd2lnU3Vic2NyaWJlci5jbGFzcyk7CgogICAg\nLy8gQ29uY3VycmVudCBNYXAgdG8gc3RvcmUgdGhlIGNhY2hlZCBDaGFubmVs\nIGNvbm5lY3Rpb25zIG9uIHRoZSBjbGllbnQgc2lkZQogICAgLy8gdG8gYSBz\nZXJ2ZXIgaG9zdCBmb3IgYSBnaXZlbiBUb3BpYyArIFN1YnNjcmliZXJJZCBj\nb21iaW5hdGlvbi4gRm9yIGVhY2gKICAgIC8vIFRvcGljU3Vic2NyaWJlciwg\nd2Ugd2FudCBhIHVuaXF1ZSBDaGFubmVsIGNvbm5lY3Rpb24gdG8gdGhlIHNl\ncnZlciBmb3IKICAgIC8vIGl0LiBXZSBjYW4gYWxzbyBnZXQgdGhlIFJlc3Bv\nbnNlSGFuZGxlciB0aWVkIHRvIHRoZSBDaGFubmVsIHZpYSB0aGUKICAgIC8v\nIENoYW5uZWwgUGlwZWxpbmUuCiAgICBwcm90ZWN0ZWQgZmluYWwgQ29uY3Vy\ncmVudE1hcDxUb3BpY1N1YnNjcmliZXIsIENoYW5uZWw+IHRvcGljU3Vic2Ny\naWJlcjJDaGFubmVsID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPFRvcGljU3Vi\nc2NyaWJlciwgQ2hhbm5lbD4oKTsKCiAgICBwcm90ZWN0ZWQgZmluYWwgSGVk\nd2lnQ2xpZW50SW1wbCBjbGllbnQ7CiAgICBwcm90ZWN0ZWQgZmluYWwgQ2xp\nZW50Q29uZmlndXJhdGlvbiBjZmc7CgogICAgcHVibGljIEhlZHdpZ1N1YnNj\ncmliZXIoSGVkd2lnQ2xpZW50SW1wbCBjbGllbnQpIHsKICAgICAgICB0aGlz\nLmNsaWVudCA9IGNsaWVudDsKICAgICAgICB0aGlzLmNmZyA9IGNsaWVudC5n\nZXRDb25maWd1cmF0aW9uKCk7CiAgICB9CgogICAgLy8gUHJpdmF0ZSBtZXRo\nb2QgdGhhdCBob2xkcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBkb2luZyBzeW5j\naHJvbm91cwogICAgLy8gU3Vic2NyaWJlIG9yIFVuc3Vic2NyaWJlIHJlcXVl\nc3RzLiBUaGlzIGlzIGZvciBjb2RlIHJldXNlIHNpbmNlIHRoZXNlCiAgICAv\nLyB0d28gZmxvd3MgYXJlIHZlcnkgc2ltaWxhci4gVGhlIGFzc3VtcHRpb24g\naXMgdGhhdCB0aGUgaW5wdXQKICAgIC8vIE9wZXJhdGlvblR5cGUgaXMgZWl0\naGVyIFNVQlNDUklCRSBvciBVTlNVQlNDUklCRS4KICAgIHByaXZhdGUgdm9p\nZCBzdWJVbnN1YihCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNj\ncmliZXJJZCwgT3BlcmF0aW9uVHlwZSBvcGVyYXRpb25UeXBlLAogICAgICAg\nICAgICAgICAgICAgICAgICAgIENyZWF0ZU9yQXR0YWNoIGNyZWF0ZU9yQXR0\nYWNoKSB0aHJvd3MgQ291bGROb3RDb25uZWN0RXhjZXB0aW9uLCBDbGllbnRB\nbHJlYWR5U3Vic2NyaWJlZEV4Y2VwdGlvbiwKICAgICAgICBDbGllbnROb3RT\ndWJzY3JpYmVkRXhjZXB0aW9uLCBTZXJ2aWNlRG93bkV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAg\nICBsb2dnZXIuZGVidWcoIkNhbGxpbmcgYSBzeW5jIHN1YlVuc3ViIHJlcXVl\nc3QgZm9yIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAiLCBz\ndWJzY3JpYmVySWQ6ICIKICAgICAgICAgICAgICAgICAgICAgICAgICsgc3Vi\nc2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpICsgIiwgb3BlcmF0aW9uVHlwZTog\nIiArIG9wZXJhdGlvblR5cGUgKyAiLCBjcmVhdGVPckF0dGFjaDogIgogICAg\nICAgICAgICAgICAgICAgICAgICAgKyBjcmVhdGVPckF0dGFjaCk7CiAgICAg\nICAgUHViU3ViRGF0YSBwdWJTdWJEYXRhID0gbmV3IFB1YlN1YkRhdGEodG9w\naWMsIG51bGwsIHN1YnNjcmliZXJJZCwgb3BlcmF0aW9uVHlwZSwgY3JlYXRl\nT3JBdHRhY2gsIG51bGwsIG51bGwpOwogICAgICAgIHN5bmNocm9uaXplZCAo\ncHViU3ViRGF0YSkgewogICAgICAgICAgICBQdWJTdWJDYWxsYmFjayBwdWJT\ndWJDYWxsYmFjayA9IG5ldyBQdWJTdWJDYWxsYmFjayhwdWJTdWJEYXRhKTsK\nICAgICAgICAgICAgYXN5bmNTdWJVbnN1Yih0b3BpYywgc3Vic2NyaWJlcklk\nLCBwdWJTdWJDYWxsYmFjaywgbnVsbCwgb3BlcmF0aW9uVHlwZSwgY3JlYXRl\nT3JBdHRhY2gpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nd2hpbGUgKCFwdWJTdWJEYXRhLmlzRG9uZSkKICAgICAgICAgICAgICAgICAg\nICBwdWJTdWJEYXRhLndhaXQoKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKCJJbnRlcnJ1cHRlZCBFeGNlcHRp\nb24gd2hpbGUgd2FpdGluZyBmb3IgYXN5bmMgc3ViVW5zdWIgY2FsbCIpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIENoZWNrIGZyb20gdGhlIFB1\nYlN1YkNhbGxiYWNrIGlmIGl0IHdhcyBzdWNjZXNzZnVsIG9yIG5vdC4KICAg\nICAgICAgICAgaWYgKCFwdWJTdWJDYWxsYmFjay5nZXRJc0NhbGxTdWNjZXNz\nZnVsKCkpIHsKICAgICAgICAgICAgICAgIC8vIFNlZSB3aGF0IHRoZSBleGNl\ncHRpb24gd2FzIHRoYXQgd2FzIHRocm93biB3aGVuIHRoZSBvcGVyYXRpb24K\nICAgICAgICAgICAgICAgIC8vIGZhaWxlZC4KICAgICAgICAgICAgICAgIFB1\nYlN1YkV4Y2VwdGlvbiBmYWlsdXJlRXhjZXB0aW9uID0gcHViU3ViQ2FsbGJh\nY2suZ2V0RmFpbHVyZUV4Y2VwdGlvbigpOwogICAgICAgICAgICAgICAgaWYg\nKGZhaWx1cmVFeGNlcHRpb24gPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nICAgIC8vIFRoaXMgc2hvdWxkIG5vdCBoYXBwZW4gYXMgdGhlIG9wZXJhdGlv\nbiBmYWlsZWQgYnV0IGEgbnVsbAogICAgICAgICAgICAgICAgICAgIC8vIFB1\nYlN1YkV4Y2VwdGlvbiB3YXMgcGFzc2VkLiBMb2cgYSB3YXJuaW5nIG1lc3Nh\nZ2UgYnV0CiAgICAgICAgICAgICAgICAgICAgLy8gdGhyb3cgYSBnZW5lcmlj\nIFNlcnZpY2VEb3duRXhjZXB0aW9uLgogICAgICAgICAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcigiU3luYyBTdWJVbnN1YiBvcGVyYXRpb24gZmFpbGVkIGJ1\ndCBubyBQdWJTdWJFeGNlcHRpb24gd2FzIHBhc3NlZCEiKTsKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgU2VydmljZURvd25FeGNlcHRpb24oIlNl\ncnZlciBhY2sgcmVzcG9uc2UgdG8gU3ViVW5zdWIgcmVxdWVzdCBpcyBub3Qg\nc3VjY2Vzc2Z1bCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgLy8gRm9yIHRoZSBleHBlY3RlZCBleGNlcHRpb25zIHRoYXQgY291bGQg\nb2NjdXIsIGp1c3QgcmV0aHJvdwogICAgICAgICAgICAgICAgLy8gdGhlbS4K\nICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZhaWx1cmVFeGNlcHRpb24gaW5z\ndGFuY2VvZiBDb3VsZE5vdENvbm5lY3RFeGNlcHRpb24pCiAgICAgICAgICAg\nICAgICAgICAgdGhyb3cgKENvdWxkTm90Q29ubmVjdEV4Y2VwdGlvbikgZmFp\nbHVyZUV4Y2VwdGlvbjsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZhaWx1\ncmVFeGNlcHRpb24gaW5zdGFuY2VvZiBDbGllbnRBbHJlYWR5U3Vic2NyaWJl\nZEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICB0aHJvdyAoQ2xpZW50\nQWxyZWFkeVN1YnNjcmliZWRFeGNlcHRpb24pIGZhaWx1cmVFeGNlcHRpb247\nCiAgICAgICAgICAgICAgICBlbHNlIGlmIChmYWlsdXJlRXhjZXB0aW9uIGlu\nc3RhbmNlb2YgQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbikKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyAoQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2Vw\ndGlvbikgZmFpbHVyZUV4Y2VwdGlvbjsKICAgICAgICAgICAgICAgIGVsc2Ug\naWYgKGZhaWx1cmVFeGNlcHRpb24gaW5zdGFuY2VvZiBTZXJ2aWNlRG93bkV4\nY2VwdGlvbikKICAgICAgICAgICAgICAgICAgICB0aHJvdyAoU2VydmljZURv\nd25FeGNlcHRpb24pIGZhaWx1cmVFeGNlcHRpb247CiAgICAgICAgICAgICAg\nICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIlVu\nZXhwZWN0ZWQgUHViU3ViRXhjZXB0aW9uIHRocm93bjogIiArIGZhaWx1cmVF\neGNlcHRpb24udG9TdHJpbmcoKSk7CiAgICAgICAgICAgICAgICAgICAgLy8g\nVGhyb3cgYSBnZW5lcmljIFNlcnZpY2VEb3duRXhjZXB0aW9uIGJ1dCB3cmFw\nIHRoZQogICAgICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsIFB1YlN1YkV4\nY2VwdGlvbiB3aXRoaW4gaXQuCiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKGZhaWx1cmVFeGNlcHRpb24pOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIC8vIFByaXZhdGUgbWV0aG9kIHRoYXQgaG9sZHMgdGhlIGNvbW1v\nbiBsb2dpYyBmb3IgZG9pbmcgYXN5bmNocm9ub3VzCiAgICAvLyBTdWJzY3Jp\nYmUgb3IgVW5zdWJzY3JpYmUgcmVxdWVzdHMuIFRoaXMgaXMgZm9yIGNvZGUg\ncmV1c2Ugc2luY2UgdGhlc2UgdHdvCiAgICAvLyBmbG93cyBhcmUgdmVyeSBz\naW1pbGFyLiBUaGUgYXNzdW1wdGlvbiBpcyB0aGF0IHRoZSBpbnB1dCBPcGVy\nYXRpb25UeXBlIGlzCiAgICAvLyBlaXRoZXIgU1VCU0NSSUJFIG9yIFVOU1VC\nU0NSSUJFLgogICAgcHJpdmF0ZSB2b2lkIGFzeW5jU3ViVW5zdWIoQnl0ZVN0\ncmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsIENhbGxiYWNr\nPFZvaWQ+IGNhbGxiYWNrLCBPYmplY3QgY29udGV4dCwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIE9wZXJhdGlvblR5cGUgb3BlcmF0aW9uVHlw\nZSwgQ3JlYXRlT3JBdHRhY2ggY3JlYXRlT3JBdHRhY2gpIHsKICAgICAgICBp\nZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZ2dl\nci5kZWJ1ZygiQ2FsbGluZyBhbiBhc3luYyBzdWJVbnN1YiByZXF1ZXN0IGZv\nciB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiwgc3Vic2Ny\naWJlcklkOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICArIHN1YnNjcmli\nZXJJZC50b1N0cmluZ1V0ZjgoKSArICIsIG9wZXJhdGlvblR5cGU6ICIgKyBv\ncGVyYXRpb25UeXBlICsgIiwgY3JlYXRlT3JBdHRhY2g6ICIKICAgICAgICAg\nICAgICAgICAgICAgICAgICsgY3JlYXRlT3JBdHRhY2gpOwogICAgICAgIC8v\nIENoZWNrIGlmIHdlIGtub3cgd2hpY2ggc2VydmVyIGhvc3QgaXMgdGhlIG1h\nc3RlciBmb3IgdGhlIHRvcGljIHdlIGFyZQogICAgICAgIC8vIHN1YnNjcmli\naW5nIHRvLgogICAgICAgIFB1YlN1YkRhdGEgcHViU3ViRGF0YSA9IG5ldyBQ\ndWJTdWJEYXRhKHRvcGljLCBudWxsLCBzdWJzY3JpYmVySWQsIG9wZXJhdGlv\nblR5cGUsIGNyZWF0ZU9yQXR0YWNoLCBjYWxsYmFjaywKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0KTsK\nICAgICAgICBpZiAoY2xpZW50LnRvcGljMkhvc3QuY29udGFpbnNLZXkodG9w\naWMpKSB7CiAgICAgICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGhvc3QgPSBj\nbGllbnQudG9waWMySG9zdC5nZXQodG9waWMpOwogICAgICAgICAgICBpZiAo\nb3BlcmF0aW9uVHlwZS5lcXVhbHMoT3BlcmF0aW9uVHlwZS5VTlNVQlNDUklC\nRSkgJiYgY2xpZW50LmdldFB1Ymxpc2hlcigpLmhvc3QyQ2hhbm5lbC5jb250\nYWluc0tleShob3N0KSkgewogICAgICAgICAgICAgICAgLy8gRm9yIHVuc3Vi\nc2NyaWJlcywgd2UgY2FuIHJldXNlIHRoZSBjaGFubmVsIGNvbm5lY3Rpb25z\nIHRvIHRoZQogICAgICAgICAgICAgICAgLy8gc2VydmVyIGhvc3QgdGhhdCBh\ncmUgY2FjaGVkIGZvciBwdWJsaXNoZXMuIEZvciBwdWJsaXNoIGFuZAogICAg\nICAgICAgICAgICAgLy8gdW5zdWJzY3JpYmUgZmxvd3MsIHdlIHdpbGwgdGh1\ncyB1c2UgdGhlIHNhbWUgQ2hhbm5lbHMgYW5kCiAgICAgICAgICAgICAgICAv\nLyB3aWxsIGNhY2hlIGFuZCBzdG9yZSB0aGVtIGR1cmluZyB0aGUgQ29ubmVj\ndENhbGxiYWNrLgogICAgICAgICAgICAgICAgZG9TdWJVbnN1YihwdWJTdWJE\nYXRhLCBjbGllbnQuZ2V0UHVibGlzaGVyKCkuaG9zdDJDaGFubmVsLmdldCho\nb3N0KSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAv\nLyBXZSBrbm93IHdoaWNoIHNlcnZlciBob3N0IGlzIHRoZSBtYXN0ZXIgZm9y\nIHRoZSB0b3BpYyBzbwogICAgICAgICAgICAgICAgLy8gY29ubmVjdCB0byB0\naGF0IGZpcnN0LiBGb3Igc3Vic2NyaWJlcywgd2Ugd2FudCBhIG5ldyBjaGFu\nbmVsCiAgICAgICAgICAgICAgICAvLyBjb25uZWN0aW9uIGVhY2ggdGltZSBm\nb3IgdGhlIFRvcGljU3Vic2NyaWJlci4gSWYgdGhlCiAgICAgICAgICAgICAg\nICAvLyBUb3BpY1N1YnNjcmliZXIgaXMgYWxyZWFkeSBjb25uZWN0ZWQgYW5k\nIHN1YnNjcmliZWQsCiAgICAgICAgICAgICAgICAvLyB3ZSBhc3N1bWUgdGhl\nIHNlcnZlciB3aWxsIHJlc3BvbmQgd2l0aCBhbiBhcHByb3ByaWF0ZSBzdGF0\ndXMKICAgICAgICAgICAgICAgIC8vIGluZGljYXRpbmcgdGhpcy4gRm9yIHVu\nc3Vic2NyaWJlcywgaXQgaXMgcG9zc2libGUgdGhhdCB0aGUKICAgICAgICAg\nICAgICAgIC8vIGNsaWVudCBpcyBzdWJzY3JpYmVkIHRvIHRoZSB0b3BpYyBh\nbHJlYWR5IGJ1dCBkb2VzIG5vdAogICAgICAgICAgICAgICAgLy8gaGF2ZSBh\nIENoYW5uZWwgY29ubmVjdGlvbiB5ZXQgdG8gdGhlIHNlcnZlciBob3N0LiBl\nLmcuIENsaWVudAogICAgICAgICAgICAgICAgLy8gZ29lcyBkb3duIGFuZCBj\nb21lcyBiYWNrIHVwIGJ1dCBjbGllbnQgc2lkZSBzb2Z0IHN0YXRlIG1lbW9y\neQogICAgICAgICAgICAgICAgLy8gZG9lcyBub3QgaGF2ZSB0aGUgbmV0dHkg\nQ2hhbm5lbCBjb25uZWN0aW9uIGFueW1vcmUuCiAgICAgICAgICAgICAgICBj\nbGllbnQuZG9Db25uZWN0KHB1YlN1YkRhdGEsIGhvc3QpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gU2VydmVyIGhv\nc3QgZm9yIHRoZSBnaXZlbiB0b3BpYyBpcyBub3Qga25vd24geWV0IHNvIHVz\nZSB0aGUKICAgICAgICAgICAgLy8gZGVmYXVsdCBzZXJ2ZXIgaG9zdC9wb3J0\nIGFzIGRlZmluZWQgaW4gdGhlIGNvbmZpZ3MuIFRoaXMgc2hvdWxkCiAgICAg\nICAgICAgIC8vIHBvaW50IHRvIHRoZSBzZXJ2ZXIgVklQIHdoaWNoIHdvdWxk\nIHJlZGlyZWN0IHRvIGEgcmFuZG9tIHNlcnZlcgogICAgICAgICAgICAvLyAo\nd2hpY2ggbWlnaHQgbm90IGJlIHRoZSBzZXJ2ZXIgaG9zdGluZyB0aGUgdG9w\naWMpLgogICAgICAgICAgICBjbGllbnQuZG9Db25uZWN0KHB1YlN1YkRhdGEs\nIGNmZy5nZXREZWZhdWx0U2VydmVySG9zdCgpKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc3Vic2NyaWJlKEJ5dGVTdHJpbmcgdG9waWMs\nIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBDcmVhdGVPckF0dGFjaCBtb2Rl\nKQogICAgICAgICAgICB0aHJvd3MgQ291bGROb3RDb25uZWN0RXhjZXB0aW9u\nLCBDbGllbnRBbHJlYWR5U3Vic2NyaWJlZEV4Y2VwdGlvbiwgU2VydmljZURv\nd25FeGNlcHRpb24sCiAgICAgICAgSW52YWxpZFN1YnNjcmliZXJJZEV4Y2Vw\ndGlvbiB7CiAgICAgICAgc3Vic2NyaWJlKHRvcGljLCBzdWJzY3JpYmVySWQs\nIG1vZGUsIGZhbHNlKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBzdWJz\nY3JpYmUoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsIENyZWF0ZU9yQXR0YWNoIG1vZGUsIGJvb2xlYW4gaXNIdWIpCiAgICAg\nICAgICAgIHRocm93cyBDb3VsZE5vdENvbm5lY3RFeGNlcHRpb24sIENsaWVu\ndEFscmVhZHlTdWJzY3JpYmVkRXhjZXB0aW9uLCBTZXJ2aWNlRG93bkV4Y2Vw\ndGlvbiwKICAgICAgICBJbnZhbGlkU3Vic2NyaWJlcklkRXhjZXB0aW9uIHsK\nICAgICAgICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBmb3JtYXQgb2YgdGhlIHN1\nYnNjcmliZXJJZCBpcyB2YWxpZCBlaXRoZXIgYXMgYQogICAgICAgIC8vIGxv\nY2FsIG9yIGh1YiBzdWJzY3JpYmVyLgogICAgICAgIGlmICghaXNWYWxpZFN1\nYnNjcmliZXJJZChzdWJzY3JpYmVySWQsIGlzSHViKSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSW52YWxpZFN1YnNjcmliZXJJZEV4Y2VwdGlvbigiU3Vi\nc2NyaWJlcklkIHBhc3NlZCBpcyBub3QgdmFsaWQ6ICIgKyBzdWJzY3JpYmVy\nSWQudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyAiLCBpc0h1YjogIiArIGlzSHVi\nKTsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3ViVW5z\ndWIodG9waWMsIHN1YnNjcmliZXJJZCwgT3BlcmF0aW9uVHlwZS5TVUJTQ1JJ\nQkUsIG1vZGUpOwogICAgICAgIH0gY2F0Y2ggKENsaWVudE5vdFN1YnNjcmli\nZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIlVu\nZXhwZWN0ZWQgRXhjZXB0aW9uIHRocm93bjogIiArIGUudG9TdHJpbmcoKSk7\nCiAgICAgICAgICAgIC8vIFRoaXMgZXhjZXB0aW9uIHNob3VsZCBuZXZlciBi\nZSB0aHJvd24gaGVyZS4gQnV0IGp1c3QgaW4gY2FzZSwKICAgICAgICAgICAg\nLy8gdGhyb3cgYSBnZW5lcmljIFNlcnZpY2VEb3duRXhjZXB0aW9uIGJ1dCB3\ncmFwIHRoZSBvcmlnaW5hbAogICAgICAgICAgICAvLyBFeGNlcHRpb24gd2l0\naGluIGl0LgogICAgICAgICAgICB0aHJvdyBuZXcgU2VydmljZURvd25FeGNl\ncHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFz\neW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vi\nc2NyaWJlcklkLCBDcmVhdGVPckF0dGFjaCBtb2RlLCBDYWxsYmFjazxWb2lk\nPiBjYWxsYmFjaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9i\namVjdCBjb250ZXh0KSB7CiAgICAgICAgYXN5bmNTdWJzY3JpYmUodG9waWMs\nIHN1YnNjcmliZXJJZCwgbW9kZSwgY2FsbGJhY2ssIGNvbnRleHQsIGZhbHNl\nKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBhc3luY1N1YnNjcmliZShC\neXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgQ3Jl\nYXRlT3JBdHRhY2ggbW9kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIENhbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLCBPYmplY3QgY29udGV4\ndCwgYm9vbGVhbiBpc0h1YikgewogICAgICAgIC8vIFZhbGlkYXRlIHRoYXQg\ndGhlIGZvcm1hdCBvZiB0aGUgc3Vic2NyaWJlcklkIGlzIHZhbGlkIGVpdGhl\nciBhcyBhCiAgICAgICAgLy8gbG9jYWwgb3IgaHViIHN1YnNjcmliZXIuCiAg\nICAgICAgaWYgKCFpc1ZhbGlkU3Vic2NyaWJlcklkKHN1YnNjcmliZXJJZCwg\naXNIdWIpKSB7CiAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxl\nZChjb250ZXh0LCBuZXcgU2VydmljZURvd25FeGNlcHRpb24obmV3IEludmFs\naWRTdWJzY3JpYmVySWRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIlN1YnNjcmliZXJJZCBwYXNzZWQgaXMg\nbm90IHZhbGlkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpICsg\nIiwgaXNIdWI6ICIgKyBpc0h1YikpKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KICAgICAgICBhc3luY1N1YlVuc3ViKHRvcGljLCBzdWJzY3Jp\nYmVySWQsIGNhbGxiYWNrLCBjb250ZXh0LCBPcGVyYXRpb25UeXBlLlNVQlND\nUklCRSwgbW9kZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdW5zdWJzY3Jp\nYmUoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQp\nIHRocm93cyBDb3VsZE5vdENvbm5lY3RFeGNlcHRpb24sCiAgICAgICAgQ2xp\nZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbiwgU2VydmljZURvd25FeGNlcHRp\nb24sIEludmFsaWRTdWJzY3JpYmVySWRFeGNlcHRpb24gewogICAgICAgIHVu\nc3Vic2NyaWJlKHRvcGljLCBzdWJzY3JpYmVySWQsIGZhbHNlKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCB1bnN1YnNjcmliZShCeXRlU3RyaW5nIHRv\ncGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgYm9vbGVhbiBpc0h1YikK\nICAgICAgICAgICAgdGhyb3dzIENvdWxkTm90Q29ubmVjdEV4Y2VwdGlvbiwg\nQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbiwgU2VydmljZURvd25FeGNl\ncHRpb24sCiAgICAgICAgSW52YWxpZFN1YnNjcmliZXJJZEV4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgZm9ybWF0IG9mIHRoZSBz\ndWJzY3JpYmVySWQgaXMgdmFsaWQgZWl0aGVyIGFzIGEKICAgICAgICAvLyBs\nb2NhbCBvciBodWIgc3Vic2NyaWJlci4KICAgICAgICBpZiAoIWlzVmFsaWRT\ndWJzY3JpYmVySWQoc3Vic2NyaWJlcklkLCBpc0h1YikpIHsKICAgICAgICAg\nICAgdGhyb3cgbmV3IEludmFsaWRTdWJzY3JpYmVySWRFeGNlcHRpb24oIlN1\nYnNjcmliZXJJZCBwYXNzZWQgaXMgbm90IHZhbGlkOiAiICsgc3Vic2NyaWJl\ncklkLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICsgIiwgaXNIdWI6ICIgKyBpc0h1\nYik7CiAgICAgICAgfQogICAgICAgIC8vIFN5bmNocm9ub3VzbHkgY2xvc2Ug\ndGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgY2xpZW50IHNpZGUuIEV2ZW4KICAg\nICAgICAvLyBpZiB0aGUgdW5zdWJzY3JpYmUgcmVxdWVzdCB0byB0aGUgc2Vy\ndmVyIGVycm9ycyBvdXQsIHdlIHdvbid0IGJlCiAgICAgICAgLy8gZGVsaXZl\ncmluZyBtZXNzYWdlcyBmb3IgdGhpcyBzdWJzY3JpcHRpb24gdG8gdGhlIGNs\naWVudC4gVGhlIGNsaWVudAogICAgICAgIC8vIGNhbiBsYXRlciByZXRyeSB0\naGUgdW5zdWJzY3JpYmUgcmVxdWVzdCB0byB0aGUgc2VydmVyIHNvIHRoZXkg\nYXJlCiAgICAgICAgLy8gImZ1bGx5IiB1bnN1YnNjcmliZWQgZnJvbSB0aGUg\nZ2l2ZW4gdG9waWMuCiAgICAgICAgY2xvc2VTdWJzY3JpcHRpb24odG9waWMs\nIHN1YnNjcmliZXJJZCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3Vi\nVW5zdWIodG9waWMsIHN1YnNjcmliZXJJZCwgT3BlcmF0aW9uVHlwZS5VTlNV\nQlNDUklCRSwgbnVsbCk7CiAgICAgICAgfSBjYXRjaCAoQ2xpZW50QWxyZWFk\neVN1YnNjcmliZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBsb2dnZXIu\nZXJyb3IoIlVuZXhwZWN0ZWQgRXhjZXB0aW9uIHRocm93bjogIiArIGUudG9T\ndHJpbmcoKSk7CiAgICAgICAgICAgIC8vIFRoaXMgZXhjZXB0aW9uIHNob3Vs\nZCBuZXZlciBiZSB0aHJvd24gaGVyZS4gQnV0IGp1c3QgaW4gY2FzZSwKICAg\nICAgICAgICAgLy8gdGhyb3cgYSBnZW5lcmljIFNlcnZpY2VEb3duRXhjZXB0\naW9uIGJ1dCB3cmFwIHRoZSBvcmlnaW5hbAogICAgICAgICAgICAvLyBFeGNl\ncHRpb24gd2l0aGluIGl0LgogICAgICAgICAgICB0aHJvdyBuZXcgU2Vydmlj\nZURvd25FeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGFzeW5jVW5zdWJzY3JpYmUoZmluYWwgQnl0ZVN0cmluZyB0b3Bp\nYywgZmluYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsIGZpbmFsIENhbGxi\nYWNrPFZvaWQ+IGNhbGxiYWNrLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBmaW5hbCBPYmplY3QgY29udGV4dCkgewogICAgICAgIGFzeW5j\nVW5zdWJzY3JpYmUodG9waWMsIHN1YnNjcmliZXJJZCwgY2FsbGJhY2ssIGNv\nbnRleHQsIGZhbHNlKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBhc3lu\nY1Vuc3Vic2NyaWJlKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIEJ5\ndGVTdHJpbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywg\nZmluYWwgT2JqZWN0IGNvbnRleHQsIGJvb2xlYW4gaXNIdWIpIHsKICAgICAg\nICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBmb3JtYXQgb2YgdGhlIHN1YnNjcmli\nZXJJZCBpcyB2YWxpZCBlaXRoZXIgYXMgYQogICAgICAgIC8vIGxvY2FsIG9y\nIGh1YiBzdWJzY3JpYmVyLgogICAgICAgIGlmICghaXNWYWxpZFN1YnNjcmli\nZXJJZChzdWJzY3JpYmVySWQsIGlzSHViKSkgewogICAgICAgICAgICBjYWxs\nYmFjay5vcGVyYXRpb25GYWlsZWQoY29udGV4dCwgbmV3IFNlcnZpY2VEb3du\nRXhjZXB0aW9uKG5ldyBJbnZhbGlkU3Vic2NyaWJlcklkRXhjZXB0aW9uKAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTdWJz\nY3JpYmVySWQgcGFzc2VkIGlzIG5vdCB2YWxpZDogIiArIHN1YnNjcmliZXJJ\nZC50b1N0cmluZ1V0ZjgoKSArICIsIGlzSHViOiAiICsgaXNIdWIpKSk7CiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQXN5bmNo\ncm9ub3VzbHkgY2xvc2UgdGhlIHN1YnNjcmlwdGlvbi4gT24gdGhlIGNhbGxi\nYWNrIHRvIHRoYXQKICAgICAgICAvLyBvcGVyYXRpb24gb25jZSBpdCBjb21w\nbGV0ZXMsIHBvc3QgdGhlIGFzeW5jIHVuc3Vic2NyaWJlIHJlcXVlc3QuCiAg\nICAgICAgYXN5bmNDbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3Vic2NyaWJl\ncklkLCBuZXcgQ2FsbGJhY2s8Vm9pZD4oKSB7CiAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5pc2hl\nZChPYmplY3QgY3R4LCBWb2lkIHJlc3VsdE9mT3BlcmF0aW9uKSB7CiAgICAg\nICAgICAgICAgICBhc3luY1N1YlVuc3ViKHRvcGljLCBzdWJzY3JpYmVySWQs\nIGNhbGxiYWNrLCBjb250ZXh0LCBPcGVyYXRpb25UeXBlLlVOU1VCU0NSSUJF\nLCBudWxsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmpl\nY3QgY3R4LCBQdWJTdWJFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAg\nICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY29udGV4dCwgZXhj\nZXB0aW9uKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIG51bGwpOwogICAg\nfQoKICAgIC8vIFRoaXMgaXMgYSBoZWxwZXIgbWV0aG9kIHRvIGRldGVybWlu\nZSBpZiBhIHN1YnNjcmliZXJJZCBpcyB2YWxpZCBhcyBlaXRoZXIKICAgIC8v\nIGEgaHViIG9yIGxvY2FsIHN1YnNjcmliZXIKICAgIHByaXZhdGUgYm9vbGVh\nbiBpc1ZhbGlkU3Vic2NyaWJlcklkKEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklk\nLCBib29sZWFuIGlzSHViKSB7CiAgICAgICAgaWYgKChpc0h1YiAmJiAhU3Vi\nc2NyaXB0aW9uU3RhdGVVdGlscy5pc0h1YlN1YnNjcmliZXIoc3Vic2NyaWJl\ncklkKSkKICAgICAgICAgICAgICAgIHx8ICghaXNIdWIgJiYgU3Vic2NyaXB0\naW9uU3RhdGVVdGlscy5pc0h1YlN1YnNjcmliZXIoc3Vic2NyaWJlcklkKSkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNv\nbnN1bWUoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsIE1lc3NhZ2VTZXFJZCBtZXNzYWdlU2VxSWQpCiAgICAgICAgICAgIHRo\ncm93cyBDbGllbnROb3RTdWJzY3JpYmVkRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZ2dl\nci5kZWJ1ZygiQ2FsbGluZyBjb25zdW1lIGZvciB0b3BpYzogIiArIHRvcGlj\nLnRvU3RyaW5nVXRmOCgpICsgIiwgc3Vic2NyaWJlcklkOiAiCiAgICAgICAg\nICAgICAgICAgICAgICAgICArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0Zjgo\nKSArICIsIG1lc3NhZ2VTZXFJZDogIiArIG1lc3NhZ2VTZXFJZCk7CiAgICAg\nICAgVG9waWNTdWJzY3JpYmVyIHRvcGljU3Vic2NyaWJlciA9IG5ldyBUb3Bp\nY1N1YnNjcmliZXIodG9waWMsIHN1YnNjcmliZXJJZCk7CiAgICAgICAgLy8g\nQ2hlY2sgdGhhdCB0aGlzIHRvcGljIHN1YnNjcmlwdGlvbiBvbiB0aGUgY2xp\nZW50IHNpZGUgZXhpc3RzLgogICAgICAgIGlmICghdG9waWNTdWJzY3JpYmVy\nMkNoYW5uZWwuY29udGFpbnNLZXkodG9waWNTdWJzY3JpYmVyKSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlv\nbigKICAgICAgICAgICAgICAgICJDYW5ub3Qgc2VuZCBjb25zdW1lIG1lc3Nh\nZ2Ugc2luY2UgY2xpZW50IGlzIG5vdCBzdWJzY3JpYmVkIHRvIHRvcGljOiAi\nICsgdG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICsgIiwg\nc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgp\nKTsKICAgICAgICB9CiAgICAgICAgUHViU3ViRGF0YSBwdWJTdWJEYXRhID0g\nbmV3IFB1YlN1YkRhdGEodG9waWMsIG51bGwsIHN1YnNjcmliZXJJZCwgT3Bl\ncmF0aW9uVHlwZS5DT05TVU1FLCBudWxsLCBudWxsLCBudWxsKTsKICAgICAg\nICAvLyBTZW5kIHRoZSBjb25zdW1lIG1lc3NhZ2UgdG8gdGhlIHNlcnZlciB1\nc2luZyB0aGUgc2FtZSBzdWJzY3JpYmUKICAgICAgICAvLyBjaGFubmVsIHRo\nYXQgdGhlIHRvcGljIHN1YnNjcmlwdGlvbiB1c2VzLgogICAgICAgIGRvQ29u\nc3VtZShwdWJTdWJEYXRhLCB0b3BpY1N1YnNjcmliZXIyQ2hhbm5lbC5nZXQo\ndG9waWNTdWJzY3JpYmVyKSwgbWVzc2FnZVNlcUlkKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoaXMgaXMgYSBoZWxwZXIgbWV0aG9kIHRvIHdyaXRlIHRo\nZSBhY3R1YWwgc3Vic2NyaWJlL3Vuc3Vic2NyaWJlIG1lc3NhZ2UKICAgICAq\nIG9uY2UgdGhlIGNsaWVudCBpcyBjb25uZWN0ZWQgdG8gdGhlIHNlcnZlciBh\nbmQgYSBDaGFubmVsIGlzIGF2YWlsYWJsZS4KICAgICAqCiAgICAgKiBAcGFy\nYW0gcHViU3ViRGF0YQogICAgICogICAgICAgICAgICBTdWJzY3JpYmUvVW5z\ndWJzY3JpYmUgY2FsbCdzIGRhdGEgd3JhcHBlciBvYmplY3QuIFdlIGFzc3Vt\nZQogICAgICogICAgICAgICAgICB0aGF0IHRoZSBvcGVyYXRpb25UeXBlIGZp\nZWxkIGlzIGVpdGhlciBTVUJTQ1JJQkUgb3IKICAgICAqICAgICAgICAgICAg\nVU5TVUJTQ1JJQkUuCiAgICAgKiBAcGFyYW0gY2hhbm5lbAogICAgICogICAg\nICAgICAgICBOZXR0eSBJL08gY2hhbm5lbCBmb3IgY29tbXVuaWNhdGlvbiBi\nZXR3ZWVuIHRoZSBjbGllbnQgYW5kCiAgICAgKiAgICAgICAgICAgIHNlcnZl\ncgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBkb1N1YlVuc3ViKFB1YlN1\nYkRhdGEgcHViU3ViRGF0YSwgQ2hhbm5lbCBjaGFubmVsKSB7CiAgICAgICAg\nLy8gQ3JlYXRlIGEgUHViU3ViUmVxdWVzdAogICAgICAgIFB1YlN1YlJlcXVl\nc3QuQnVpbGRlciBwdWJzdWJSZXF1ZXN0QnVpbGRlciA9IFB1YlN1YlJlcXVl\nc3QubmV3QnVpbGRlcigpOwogICAgICAgIHB1YnN1YlJlcXVlc3RCdWlsZGVy\nLnNldFByb3RvY29sVmVyc2lvbihQcm90b2NvbFZlcnNpb24uVkVSU0lPTl9P\nTkUpOwogICAgICAgIHB1YnN1YlJlcXVlc3RCdWlsZGVyLnNldFR5cGUocHVi\nU3ViRGF0YS5vcGVyYXRpb25UeXBlKTsKICAgICAgICBpZiAocHViU3ViRGF0\nYS50cmllZFNlcnZlcnMgIT0gbnVsbCAmJiBwdWJTdWJEYXRhLnRyaWVkU2Vy\ndmVycy5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgIHB1YnN1YlJlcXVlc3RC\ndWlsZGVyLmFkZEFsbFRyaWVkU2VydmVycyhwdWJTdWJEYXRhLnRyaWVkU2Vy\ndmVycyk7CiAgICAgICAgfQogICAgICAgIGxvbmcgdHhuSWQgPSBjbGllbnQu\nZ2xvYmFsQ291bnRlci5pbmNyZW1lbnRBbmRHZXQoKTsKICAgICAgICBwdWJz\ndWJSZXF1ZXN0QnVpbGRlci5zZXRUeG5JZCh0eG5JZCk7CiAgICAgICAgcHVi\nc3ViUmVxdWVzdEJ1aWxkZXIuc2V0U2hvdWxkQ2xhaW0ocHViU3ViRGF0YS5z\naG91bGRDbGFpbSk7CiAgICAgICAgcHVic3ViUmVxdWVzdEJ1aWxkZXIuc2V0\nVG9waWMocHViU3ViRGF0YS50b3BpYyk7CgogICAgICAgIC8vIENyZWF0ZSBl\naXRoZXIgdGhlIFN1YnNjcmliZSBvciBVbnN1YnNjcmliZSBSZXF1ZXN0CiAg\nICAgICAgaWYgKHB1YlN1YkRhdGEub3BlcmF0aW9uVHlwZS5lcXVhbHMoT3Bl\ncmF0aW9uVHlwZS5TVUJTQ1JJQkUpKSB7CiAgICAgICAgICAgIC8vIENyZWF0\nZSB0aGUgU3Vic2NyaWJlUmVxdWVzdAogICAgICAgICAgICBTdWJzY3JpYmVS\nZXF1ZXN0LkJ1aWxkZXIgc3Vic2NyaWJlUmVxdWVzdEJ1aWxkZXIgPSBTdWJz\nY3JpYmVSZXF1ZXN0Lm5ld0J1aWxkZXIoKTsKICAgICAgICAgICAgc3Vic2Ny\naWJlUmVxdWVzdEJ1aWxkZXIuc2V0U3Vic2NyaWJlcklkKHB1YlN1YkRhdGEu\nc3Vic2NyaWJlcklkKTsKICAgICAgICAgICAgc3Vic2NyaWJlUmVxdWVzdEJ1\naWxkZXIuc2V0Q3JlYXRlT3JBdHRhY2gocHViU3ViRGF0YS5jcmVhdGVPckF0\ndGFjaCk7CiAgICAgICAgICAgIC8vIEZvciBub3csIGFsbCBzdWJzY3JpYmVz\nIHNob3VsZCB3YWl0IGZvciBhbGwgY3Jvc3MtcmVnaW9uYWwKICAgICAgICAg\nICAgLy8gc3Vic2NyaXB0aW9ucyB0byBiZSBlc3RhYmxpc2hlZCBiZWZvcmUg\ncmV0dXJuaW5nLgogICAgICAgICAgICBzdWJzY3JpYmVSZXF1ZXN0QnVpbGRl\nci5zZXRTeW5jaHJvbm91cyh0cnVlKTsKCiAgICAgICAgICAgIC8vIFNldCB0\naGUgU3Vic2NyaWJlUmVxdWVzdCBpbnRvIHRoZSBvdXRlciBQdWJTdWJSZXF1\nZXN0CiAgICAgICAgICAgIHB1YnN1YlJlcXVlc3RCdWlsZGVyLnNldFN1YnNj\ncmliZVJlcXVlc3Qoc3Vic2NyaWJlUmVxdWVzdEJ1aWxkZXIpOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgVW5TdWJzY3Jp\nYmVSZXF1ZXN0CiAgICAgICAgICAgIFVuc3Vic2NyaWJlUmVxdWVzdC5CdWls\nZGVyIHVuc3Vic2NyaWJlUmVxdWVzdEJ1aWxkZXIgPSBVbnN1YnNjcmliZVJl\ncXVlc3QubmV3QnVpbGRlcigpOwogICAgICAgICAgICB1bnN1YnNjcmliZVJl\ncXVlc3RCdWlsZGVyLnNldFN1YnNjcmliZXJJZChwdWJTdWJEYXRhLnN1YnNj\ncmliZXJJZCk7CgogICAgICAgICAgICAvLyBTZXQgdGhlIFVuc3Vic2NyaWJl\nUmVxdWVzdCBpbnRvIHRoZSBvdXRlciBQdWJTdWJSZXF1ZXN0CiAgICAgICAg\nICAgIHB1YnN1YlJlcXVlc3RCdWlsZGVyLnNldFVuc3Vic2NyaWJlUmVxdWVz\ndCh1bnN1YnNjcmliZVJlcXVlc3RCdWlsZGVyKTsKICAgICAgICB9CgogICAg\nICAgIC8vIFVwZGF0ZSB0aGUgUHViU3ViRGF0YSB3aXRoIHRoZSB0eG5JZCBh\nbmQgdGhlIHJlcXVlc3RXcml0ZVRpbWUKICAgICAgICBwdWJTdWJEYXRhLnR4\nbklkID0gdHhuSWQ7CiAgICAgICAgcHViU3ViRGF0YS5yZXF1ZXN0V3JpdGVU\naW1lID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CgogICAgICAgIC8v\nIEJlZm9yZSB3ZSBkbyB0aGUgd3JpdGUsIHN0b3JlIHRoaXMgaW5mb3JtYXRp\nb24gaW50byB0aGUKICAgICAgICAvLyBSZXNwb25zZUhhbmRsZXIgc28gd2hl\nbiB0aGUgc2VydmVyIHJlc3BvbmRzLCB3ZSBrbm93IHdoYXQKICAgICAgICAv\nLyBhcHByb3ByaWF0ZSBDYWxsYmFjayBEYXRhIHRvIGludm9rZSBmb3IgdGhl\nIGdpdmVuIHR4biBJRC4KICAgICAgICBIZWR3aWdDbGllbnRJbXBsLmdldFJl\nc3BvbnNlSGFuZGxlckZyb21DaGFubmVsKGNoYW5uZWwpLnR4bjJQdWJTdWJE\nYXRhLnB1dCh0eG5JZCwgcHViU3ViRGF0YSk7CgogICAgICAgIC8vIEZpbmFs\nbHksIHdyaXRlIHRoZSBTdWJzY3JpYmUgcmVxdWVzdCB0aHJvdWdoIHRoZSBD\naGFubmVsLgogICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkK\nICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJXcml0aW5nIGEgU3ViVW5zdWIg\ncmVxdWVzdCB0byBob3N0OiAiICsgSGVkd2lnQ2xpZW50SW1wbC5nZXRIb3N0\nRnJvbUNoYW5uZWwoY2hhbm5lbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICsgIiBmb3IgcHViU3ViRGF0YTogIiArIHB1YlN1YkRhdGEpOwogICAgICAg\nIENoYW5uZWxGdXR1cmUgZnV0dXJlID0gY2hhbm5lbC53cml0ZShwdWJzdWJS\nZXF1ZXN0QnVpbGRlci5idWlsZCgpKTsKICAgICAgICBmdXR1cmUuYWRkTGlz\ndGVuZXIobmV3IFdyaXRlQ2FsbGJhY2socHViU3ViRGF0YSwgY2xpZW50KSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIGlzIGEgaGVscGVyIG1ldGhv\nZCB0byB3cml0ZSBhIGNvbnN1bWUgbWVzc2FnZSB0byB0aGUgc2VydmVyIGFm\ndGVyIGEKICAgICAqIHN1YnNjcmliZSBDaGFubmVsIGNvbm5lY3Rpb24gaXMg\nbWFkZSB0byB0aGUgc2VydmVyIGFuZCBtZXNzYWdlcyBhcmUgYmVpbmcKICAg\nICAqIGNvbnN1bWVkIGJ5IHRoZSBjbGllbnQuCiAgICAgKgogICAgICogQHBh\ncmFtIHB1YlN1YkRhdGEKICAgICAqICAgICAgICAgICAgQ29uc3VtZSBjYWxs\nJ3MgZGF0YSB3cmFwcGVyIG9iamVjdC4gV2UgYXNzdW1lIHRoYXQgdGhlCiAg\nICAgKiAgICAgICAgICAgIG9wZXJhdGlvblR5cGUgZmllbGQgaXMgQ09OU1VN\nRS4KICAgICAqIEBwYXJhbSBjaGFubmVsCiAgICAgKiAgICAgICAgICAgIE5l\ndHR5IEkvTyBjaGFubmVsIGZvciBjb21tdW5pY2F0aW9uIGJldHdlZW4gdGhl\nIGNsaWVudCBhbmQKICAgICAqICAgICAgICAgICAgc2VydmVyCiAgICAgKiBA\ncGFyYW0gbWVzc2FnZVNlcUlkCiAgICAgKiAgICAgICAgICAgIE1lc3NhZ2Ug\nU2VxIElEIGZvciB0aGUgbGF0ZXN0L2xhc3QgbWVzc2FnZSB0aGUgY2xpZW50\nIGhhcwogICAgICogICAgICAgICAgICBjb25zdW1lZC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgZG9Db25zdW1lKGZpbmFsIFB1YlN1YkRhdGEgcHViU3Vi\nRGF0YSwgZmluYWwgQ2hhbm5lbCBjaGFubmVsLCBmaW5hbCBNZXNzYWdlU2Vx\nSWQgbWVzc2FnZVNlcUlkKSB7CiAgICAgICAgLy8gQ3JlYXRlIGEgUHViU3Vi\nUmVxdWVzdAogICAgICAgIFB1YlN1YlJlcXVlc3QuQnVpbGRlciBwdWJzdWJS\nZXF1ZXN0QnVpbGRlciA9IFB1YlN1YlJlcXVlc3QubmV3QnVpbGRlcigpOwog\nICAgICAgIHB1YnN1YlJlcXVlc3RCdWlsZGVyLnNldFByb3RvY29sVmVyc2lv\nbihQcm90b2NvbFZlcnNpb24uVkVSU0lPTl9PTkUpOwogICAgICAgIHB1YnN1\nYlJlcXVlc3RCdWlsZGVyLnNldFR5cGUoT3BlcmF0aW9uVHlwZS5DT05TVU1F\nKTsKICAgICAgICBsb25nIHR4bklkID0gY2xpZW50Lmdsb2JhbENvdW50ZXIu\naW5jcmVtZW50QW5kR2V0KCk7CiAgICAgICAgcHVic3ViUmVxdWVzdEJ1aWxk\nZXIuc2V0VHhuSWQodHhuSWQpOwogICAgICAgIHB1YnN1YlJlcXVlc3RCdWls\nZGVyLnNldFRvcGljKHB1YlN1YkRhdGEudG9waWMpOwoKICAgICAgICAvLyBD\ncmVhdGUgdGhlIENvbnN1bWVSZXF1ZXN0CiAgICAgICAgQ29uc3VtZVJlcXVl\nc3QuQnVpbGRlciBjb25zdW1lUmVxdWVzdEJ1aWxkZXIgPSBDb25zdW1lUmVx\ndWVzdC5uZXdCdWlsZGVyKCk7CiAgICAgICAgY29uc3VtZVJlcXVlc3RCdWls\nZGVyLnNldFN1YnNjcmliZXJJZChwdWJTdWJEYXRhLnN1YnNjcmliZXJJZCk7\nCiAgICAgICAgY29uc3VtZVJlcXVlc3RCdWlsZGVyLnNldE1zZ0lkKG1lc3Nh\nZ2VTZXFJZCk7CgogICAgICAgIC8vIFNldCB0aGUgQ29uc3VtZVJlcXVlc3Qg\naW50byB0aGUgb3V0ZXIgUHViU3ViUmVxdWVzdAogICAgICAgIHB1YnN1YlJl\ncXVlc3RCdWlsZGVyLnNldENvbnN1bWVSZXF1ZXN0KGNvbnN1bWVSZXF1ZXN0\nQnVpbGRlcik7CgogICAgICAgIC8vIEZvciBDb25zdW1lIHJlcXVlc3RzLCB3\nZSB3aWxsIHNlbmQgdGhlbSBmcm9tIHRoZSBjbGllbnQgaW4gYSBmaXJlIGFu\nZAogICAgICAgIC8vIGZvcmdldCBtYW5uZXIuIFdlIGFyZSBub3QgZXhwZWN0\naW5nIHRoZSBzZXJ2ZXIgdG8gc2VuZCBiYWNrIGFuIGFjawogICAgICAgIC8v\nIHJlc3BvbnNlIHNvIG5vIG5lZWQgdG8gcmVnaXN0ZXIgdGhpcyBpbiB0aGUg\nUmVzcG9uc2VIYW5kbGVyLiBUaGVyZQogICAgICAgIC8vIGFyZSBubyBjYWxs\nYmFja3MgdG8gaW52b2tlIHNpbmNlIHRoaXMgaXNuJ3QgYSBjbGllbnQgaW5p\ndGlhdGVkCiAgICAgICAgLy8gYWN0aW9uLiBJbnN0ZWFkLCBqdXN0IGhhdmUg\nYSBmdXR1cmUgbGlzdGVuZXIgdGhhdCB3aWxsIGxvZyBhbiBlcnJvcgogICAg\nICAgIC8vIG1lc3NhZ2UgaWYgdGhlcmUgd2FzIGEgcHJvYmxlbSB3cml0aW5n\nIHRoZSBjb25zdW1lIHJlcXVlc3QuCiAgICAgICAgaWYgKGxvZ2dlci5pc0Rl\nYnVnRW5hYmxlZCgpKQogICAgICAgICAgICBsb2dnZXIuZGVidWcoIldyaXRp\nbmcgYSBDb25zdW1lIHJlcXVlc3QgdG8gaG9zdDogIiArIEhlZHdpZ0NsaWVu\ndEltcGwuZ2V0SG9zdEZyb21DaGFubmVsKGNoYW5uZWwpCiAgICAgICAgICAg\nICAgICAgICAgICAgICArICIgd2l0aCBtZXNzYWdlU2VxSWQ6ICIgKyBtZXNz\nYWdlU2VxSWQgKyAiIGZvciBwdWJTdWJEYXRhOiAiICsgcHViU3ViRGF0YSk7\nCiAgICAgICAgQ2hhbm5lbEZ1dHVyZSBmdXR1cmUgPSBjaGFubmVsLndyaXRl\nKHB1YnN1YlJlcXVlc3RCdWlsZGVyLmJ1aWxkKCkpOwogICAgICAgIGZ1dHVy\nZS5hZGRMaXN0ZW5lcihuZXcgQ2hhbm5lbEZ1dHVyZUxpc3RlbmVyKCkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uQ29tcGxldGUoQ2hhbm5lbEZ1dHVyZSBmdXR1cmUpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKCFmdXR1cmUuaXNT\ndWNjZXNzKCkpIHsKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3Io\nIkVycm9yIHdyaXRpbmcgYSBDb25zdW1lIHJlcXVlc3QgdG8gaG9zdDogIiAr\nIEhlZHdpZ0NsaWVudEltcGwuZ2V0SG9zdEZyb21DaGFubmVsKGNoYW5uZWwp\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiB3aXRoIG1l\nc3NhZ2VTZXFJZDogIiArIG1lc3NhZ2VTZXFJZCArICIgZm9yIHB1YlN1YkRh\ndGE6ICIgKyBwdWJTdWJEYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgIH0pOwoKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBoYXNTdWJzY3JpcHRpb24oQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmlu\nZyBzdWJzY3JpYmVySWQpIHRocm93cyBDb3VsZE5vdENvbm5lY3RFeGNlcHRp\nb24sCiAgICAgICAgU2VydmljZURvd25FeGNlcHRpb24gewogICAgICAgIC8v\nIFRoZSBzdWJzY3JpcHRpb24gdHlwZSBvZiBpbmZvIHNob3VsZCBiZSBzdG9y\nZWQgb24gdGhlIHNlcnZlciBlbmQsIG5vdAogICAgICAgIC8vIHRoZSBjbGll\nbnQgc2lkZS4gRXZlbnR1YWxseSwgdGhlIHNlcnZlciB3aWxsIGhhdmUgdGhl\nIFN1YnNjcmlwdGlvbgogICAgICAgIC8vIE1hbmFnZXIgcGFydCB0aGF0IHRp\nZXMgaW50byBab29rZWVwZXIgdG8gbWFuYWdlIHRoaXMgaW5mby4KICAgICAg\nICAvLyBDb21tZW50aW5nIG91dCB0aGVzZSB0eXBlIG9mIEFQSSdzIHJlbGF0\nZWQgdG8gdGhhdCBoZXJlIGZvciBub3cgdW50aWwKICAgICAgICAvLyB0aGlz\nIGRhdGEgaXMgYXZhaWxhYmxlIG9uIHRoZSBzZXJ2ZXIuIFdpbGwgZmlndXJl\nIG91dCB3aGF0IHRoZQogICAgICAgIC8vIGNvcnJlY3Qgd2F5IHRvIGNvbnRh\nY3QgdGhlIHNlcnZlciB0byBnZXQgdGhpcyBpbmZvIGlzIHRoZW4uCiAgICAg\nICAgLy8gVGhlIGNsaWVudCBzaWRlIGp1c3QgaGFzIHNvZnQgbWVtb3J5IHN0\nYXRlIGZvciBjbGllbnQgc3Vic2NyaXB0aW9uCiAgICAgICAgLy8gaW5mb3Jt\nYXRpb24uCiAgICAgICAgcmV0dXJuIHRvcGljU3Vic2NyaWJlcjJDaGFubmVs\nLmNvbnRhaW5zS2V5KG5ldyBUb3BpY1N1YnNjcmliZXIodG9waWMsIHN1YnNj\ncmliZXJJZCkpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0PEJ5dGVTdHJpbmc+\nIGdldFN1YnNjcmlwdGlvbkxpc3QoQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQp\nIHRocm93cyBDb3VsZE5vdENvbm5lY3RFeGNlcHRpb24sCiAgICAgICAgU2Vy\ndmljZURvd25FeGNlcHRpb24gewogICAgICAgIC8vIFNhbWUgYXMgdGhlIHBy\nZXZpb3VzIGhhc1N1YnNjcmlwdGlvbiBtZXRob2QsIHRoaXMgZGF0YSBzaG91\nbGQgcmVzaWRlCiAgICAgICAgLy8gb24gdGhlIHNlcnZlciBlbmQsIG5vdCB0\naGUgY2xpZW50IHNpZGUuCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc3RhcnREZWxpdmVyeShmaW5hbCBCeXRlU3RyaW5n\nIHRvcGljLCBmaW5hbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgTWVzc2Fn\nZUhhbmRsZXIgbWVzc2FnZUhhbmRsZXIpCiAgICAgICAgICAgIHRocm93cyBD\nbGllbnROb3RTdWJzY3JpYmVkRXhjZXB0aW9uIHsKICAgICAgICBpZiAobG9n\nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1\nZygiU3RhcnRpbmcgZGVsaXZlcnkgZm9yIHRvcGljOiAiICsgdG9waWMudG9T\ndHJpbmdVdGY4KCkgKyAiLCBzdWJzY3JpYmVySWQ6ICIKICAgICAgICAgICAg\nICAgICAgICAgICAgICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpKTsK\nICAgICAgICBUb3BpY1N1YnNjcmliZXIgdG9waWNTdWJzY3JpYmVyID0gbmV3\nIFRvcGljU3Vic2NyaWJlcih0b3BpYywgc3Vic2NyaWJlcklkKTsKICAgICAg\nICAvLyBNYWtlIHN1cmUgd2Uga25vdyBhYm91dCB0aGlzIHRvcGljIHN1YnNj\ncmlwdGlvbiBvbiB0aGUgY2xpZW50IHNpZGUKICAgICAgICAvLyBleGlzdHMu\nIFRoZSBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGNsaWVudCBzaG91bGQgaGF2\nZSBpbiBtZW1vcnkgdGhlCiAgICAgICAgLy8gQ2hhbm5lbCBjcmVhdGVkIGZv\nciB0aGUgVG9waWNTdWJzY3JpYmVyIG9uY2UgdGhlIHNlcnZlciBoYXMgc2Vu\ndAogICAgICAgIC8vIGFuIGFjayByZXNwb25zZSB0byB0aGUgaW5pdGlhbCBz\ndWJzY3JpYmUgcmVxdWVzdC4KICAgICAgICBpZiAoIXRvcGljU3Vic2NyaWJl\ncjJDaGFubmVsLmNvbnRhaW5zS2V5KHRvcGljU3Vic2NyaWJlcikpIHsKICAg\nICAgICAgICAgbG9nZ2VyLmVycm9yKCJDbGllbnQgaXMgbm90IHlldCBzdWJz\nY3JpYmVkIHRvIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAi\nLCBzdWJzY3JpYmVySWQ6ICIKICAgICAgICAgICAgICAgICAgICAgICAgICsg\nc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICAgICAgdGhy\nb3cgbmV3IENsaWVudE5vdFN1YnNjcmliZWRFeGNlcHRpb24oIkNsaWVudCBp\ncyBub3QgeWV0IHN1YnNjcmliZWQgdG8gdG9waWM6ICIgKyB0b3BpYy50b1N0\ncmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICArICIsIHN1YnNjcmliZXJJZDogIiArIHN1YnNj\ncmliZXJJZC50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgfQoKICAgICAgICAv\nLyBSZWdpc3RlciB0aGUgTWVzc2FnZUhhbmRsZXIgd2l0aCB0aGUgc3Vic2Ny\naWJlIENoYW5uZWwncwogICAgICAgIC8vIFJlc3BvbnNlIEhhbmRsZXIuCiAg\nICAgICAgQ2hhbm5lbCB0b3BpY1N1YnNjcmliZXJDaGFubmVsID0gdG9waWNT\ndWJzY3JpYmVyMkNoYW5uZWwuZ2V0KHRvcGljU3Vic2NyaWJlcik7CiAgICAg\nICAgSGVkd2lnQ2xpZW50SW1wbC5nZXRSZXNwb25zZUhhbmRsZXJGcm9tQ2hh\nbm5lbCh0b3BpY1N1YnNjcmliZXJDaGFubmVsKS5nZXRTdWJzY3JpYmVSZXNw\nb25zZUhhbmRsZXIoKQogICAgICAgIC5zZXRNZXNzYWdlSGFuZGxlcihtZXNz\nYWdlSGFuZGxlcik7CiAgICAgICAgLy8gTm93IG1ha2UgdGhlIFRvcGljU3Vi\nc2NyaWJlciBDaGFubmVsIHJlYWRhYmxlIChpdCBpcyBzZXQgdG8gbm90IGJl\nCiAgICAgICAgLy8gcmVhZGFibGUgd2hlbiB0aGUgaW5pdGlhbCBzdWJzY3Jp\ncHRpb24gaXMgZG9uZSkuIE5vdGUgdGhhdCB0aGlzIGlzIGFuCiAgICAgICAg\nLy8gYXN5bmNocm9ub3VzIGNhbGwuIElmIHRoaXMgZmFpbHMgKG5vdCBsaWtl\nbHkpLCB0aGUgZnV0dXJlTGlzdGVuZXIKICAgICAgICAvLyB3aWxsIGp1c3Qg\nbG9nIGFuIGVycm9yIG1lc3NhZ2UgZm9yIG5vdy4KICAgICAgICBDaGFubmVs\nRnV0dXJlIGZ1dHVyZSA9IHRvcGljU3Vic2NyaWJlckNoYW5uZWwuc2V0UmVh\nZGFibGUodHJ1ZSk7CiAgICAgICAgZnV0dXJlLmFkZExpc3RlbmVyKG5ldyBD\naGFubmVsRnV0dXJlTGlzdGVuZXIoKSB7CiAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShD\naGFubmVsRnV0dXJlIGZ1dHVyZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBpZiAoIWZ1dHVyZS5pc1N1Y2Nlc3MoKSkgewogICAgICAg\nICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiVW5hYmxlIHRvIG1ha2Ugc3Vi\nc2NyaWJlciBDaGFubmVsIHJlYWRhYmxlIGluIHN0YXJ0RGVsaXZlcnkgY2Fs\nbCBmb3IgdG9waWM6ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmliZXJJZDog\nIiArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzdG9wRGVsaXZlcnkoZmluYWwgQnl0ZVN0cmluZyB0b3Bp\nYywgZmluYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQpIHRocm93cyBDbGll\nbnROb3RTdWJzY3JpYmVkRXhjZXB0aW9uIHsKICAgICAgICBpZiAobG9nZ2Vy\nLmlzRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygi\nU3RvcHBpbmcgZGVsaXZlcnkgZm9yIHRvcGljOiAiICsgdG9waWMudG9TdHJp\nbmdVdGY4KCkgKyAiLCBzdWJzY3JpYmVySWQ6ICIKICAgICAgICAgICAgICAg\nICAgICAgICAgICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpKTsKICAg\nICAgICBUb3BpY1N1YnNjcmliZXIgdG9waWNTdWJzY3JpYmVyID0gbmV3IFRv\ncGljU3Vic2NyaWJlcih0b3BpYywgc3Vic2NyaWJlcklkKTsKICAgICAgICAv\nLyBNYWtlIHN1cmUgd2Uga25vdyB0aGF0IHRoaXMgdG9waWMgc3Vic2NyaXB0\naW9uIG9uIHRoZSBjbGllbnQgc2lkZQogICAgICAgIC8vIGV4aXN0cy4gVGhl\nIGFzc3VtcHRpb24gaXMgdGhhdCB0aGUgY2xpZW50IHNob3VsZCBoYXZlIGlu\nIG1lbW9yeSB0aGUKICAgICAgICAvLyBDaGFubmVsIGNyZWF0ZWQgZm9yIHRo\nZSBUb3BpY1N1YnNjcmliZXIgb25jZSB0aGUgc2VydmVyIGhhcyBzZW50CiAg\nICAgICAgLy8gYW4gYWNrIHJlc3BvbnNlIHRvIHRoZSBpbml0aWFsIHN1YnNj\ncmliZSByZXF1ZXN0LgogICAgICAgIGlmICghdG9waWNTdWJzY3JpYmVyMkNo\nYW5uZWwuY29udGFpbnNLZXkodG9waWNTdWJzY3JpYmVyKSkgewogICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIkNsaWVudCBpcyBub3QgeWV0IHN1YnNjcmli\nZWQgdG8gdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1\nYnNjcmliZXJJZDogIgogICAgICAgICAgICAgICAgICAgICAgICAgKyBzdWJz\nY3JpYmVySWQudG9TdHJpbmdVdGY4KCkpOwogICAgICAgICAgICB0aHJvdyBu\nZXcgQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbigiQ2xpZW50IGlzIG5v\ndCB5ZXQgc3Vic2NyaWJlZCB0byB0b3BpYzogIiArIHRvcGljLnRvU3RyaW5n\nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICsgIiwgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJl\ncklkLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICB9CgogICAgICAgIC8vIFVu\ncmVnaXN0ZXIgdGhlIE1lc3NhZ2VIYW5kbGVyIGZvciB0aGUgc3Vic2NyaWJl\nIENoYW5uZWwncwogICAgICAgIC8vIFJlc3BvbnNlIEhhbmRsZXIuCiAgICAg\nICAgQ2hhbm5lbCB0b3BpY1N1YnNjcmliZXJDaGFubmVsID0gdG9waWNTdWJz\nY3JpYmVyMkNoYW5uZWwuZ2V0KHRvcGljU3Vic2NyaWJlcik7CiAgICAgICAg\nSGVkd2lnQ2xpZW50SW1wbC5nZXRSZXNwb25zZUhhbmRsZXJGcm9tQ2hhbm5l\nbCh0b3BpY1N1YnNjcmliZXJDaGFubmVsKS5nZXRTdWJzY3JpYmVSZXNwb25z\nZUhhbmRsZXIoKQogICAgICAgIC5zZXRNZXNzYWdlSGFuZGxlcihudWxsKTsK\nICAgICAgICAvLyBOb3cgbWFrZSB0aGUgVG9waWNTdWJzY3JpYmVyIGNoYW5u\nZWwgbm90LXJlYWRhYmxlLiBUaGlzIHdpbGwgYnVmZmVyCiAgICAgICAgLy8g\ndXAgbWVzc2FnZXMgaWYgYW55IGFyZSBzZW50IGZyb20gdGhlIHNlcnZlci4g\nTm90ZSB0aGF0IHRoaXMgaXMgYW4KICAgICAgICAvLyBhc3luY2hyb25vdXMg\nY2FsbC4gSWYgdGhpcyBmYWlscyAobm90IGxpa2VseSksIHRoZSBmdXR1cmVM\naXN0ZW5lcgogICAgICAgIC8vIHdpbGwganVzdCBsb2cgYW4gZXJyb3IgbWVz\nc2FnZSBmb3Igbm93LgogICAgICAgIENoYW5uZWxGdXR1cmUgZnV0dXJlID0g\ndG9waWNTdWJzY3JpYmVyQ2hhbm5lbC5zZXRSZWFkYWJsZShmYWxzZSk7CiAg\nICAgICAgZnV0dXJlLmFkZExpc3RlbmVyKG5ldyBDaGFubmVsRnV0dXJlTGlz\ndGVuZXIoKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShDaGFubmVsRnV0dXJlIGZ1\ndHVyZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAo\nIWZ1dHVyZS5pc1N1Y2Nlc3MoKSkgewogICAgICAgICAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcigiVW5hYmxlIHRvIG1ha2Ugc3Vic2NyaWJlciBDaGFubmVs\nIG5vdCByZWFkYWJsZSBpbiBzdG9wRGVsaXZlcnkgY2FsbCBmb3IgdG9waWM6\nICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB0b3BpYy50\nb1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmli\nZXJJZC50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBj\nbG9zZVN1YnNjcmlwdGlvbihCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5n\nIHN1YnNjcmliZXJJZCkgdGhyb3dzIFNlcnZpY2VEb3duRXhjZXB0aW9uIHsK\nICAgICAgICBQdWJTdWJEYXRhIHB1YlN1YkRhdGEgPSBuZXcgUHViU3ViRGF0\nYSh0b3BpYywgbnVsbCwgc3Vic2NyaWJlcklkLCBudWxsLCBudWxsLCBudWxs\nLCBudWxsKTsKICAgICAgICBzeW5jaHJvbml6ZWQgKHB1YlN1YkRhdGEpIHsK\nICAgICAgICAgICAgUHViU3ViQ2FsbGJhY2sgcHViU3ViQ2FsbGJhY2sgPSBu\nZXcgUHViU3ViQ2FsbGJhY2socHViU3ViRGF0YSk7CiAgICAgICAgICAgIGFz\neW5jQ2xvc2VTdWJzY3JpcHRpb24odG9waWMsIHN1YnNjcmliZXJJZCwgcHVi\nU3ViQ2FsbGJhY2ssIG51bGwpOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgd2hpbGUgKCFwdWJTdWJEYXRhLmlzRG9uZSkKICAgICAgICAg\nICAgICAgICAgICBwdWJTdWJEYXRhLndhaXQoKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKCJJbnRlcnJ1cHRl\nZCBFeGNlcHRpb24gd2hpbGUgd2FpdGluZyBmb3IgYXN5bmNDbG9zZVN1YnNj\ncmlwdGlvbiBjYWxsIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g\nQ2hlY2sgZnJvbSB0aGUgUHViU3ViQ2FsbGJhY2sgaWYgaXQgd2FzIHN1Y2Nl\nc3NmdWwgb3Igbm90LgogICAgICAgICAgICBpZiAoIXB1YlN1YkNhbGxiYWNr\nLmdldElzQ2FsbFN1Y2Nlc3NmdWwoKSkgewogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKCJFeGNlcHRpb24gd2hpbGUg\ndHJ5aW5nIHRvIGNsb3NlIHRoZSBzdWJzY3JpcHRpb24gZm9yIHRvcGljOiAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmliZXJJZDog\nIiArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgYXN5bmNDbG9z\nZVN1YnNjcmlwdGlvbihmaW5hbCBCeXRlU3RyaW5nIHRvcGljLCBmaW5hbCBC\neXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJh\nY2ssIGZpbmFsIE9iamVjdCBjb250ZXh0KSB7CiAgICAgICAgaWYgKGxvZ2dl\nci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAgICBsb2dnZXIuZGVidWco\nIkNsb3Npbmcgc3Vic2NyaXB0aW9uIGFzeW5jaHJvbm91c2x5IGZvciB0b3Bp\nYzogIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiwgc3Vic2NyaWJlcklk\nOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICArIHN1YnNjcmliZXJJZC50\nb1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgVG9waWNTdWJzY3JpYmVyIHRvcGlj\nU3Vic2NyaWJlciA9IG5ldyBUb3BpY1N1YnNjcmliZXIodG9waWMsIHN1YnNj\ncmliZXJJZCk7CiAgICAgICAgaWYgKHRvcGljU3Vic2NyaWJlcjJDaGFubmVs\nLmNvbnRhaW5zS2V5KHRvcGljU3Vic2NyaWJlcikpIHsKICAgICAgICAgICAg\nLy8gUmVtb3ZlIGFsbCBjYWNoZWQgcmVmZXJlbmNlcyBmb3IgdGhlIFRvcGlj\nU3Vic2NyaWJlcgogICAgICAgICAgICBDaGFubmVsIGNoYW5uZWwgPSB0b3Bp\nY1N1YnNjcmliZXIyQ2hhbm5lbC5nZXQodG9waWNTdWJzY3JpYmVyKTsKICAg\nICAgICAgICAgdG9waWNTdWJzY3JpYmVyMkNoYW5uZWwucmVtb3ZlKHRvcGlj\nU3Vic2NyaWJlcik7CiAgICAgICAgICAgIC8vIENsb3NlIHRoZSBzdWJzY3Jp\nYmUgY2hhbm5lbCBhc3luY2hyb25vdXNseS4KICAgICAgICAgICAgSGVkd2ln\nQ2xpZW50SW1wbC5nZXRSZXNwb25zZUhhbmRsZXJGcm9tQ2hhbm5lbChjaGFu\nbmVsKS5jaGFubmVsQ2xvc2VkRXhwbGljaXRseSA9IHRydWU7CiAgICAgICAg\nICAgIENoYW5uZWxGdXR1cmUgZnV0dXJlID0gY2hhbm5lbC5jbG9zZSgpOwog\nICAgICAgICAgICBmdXR1cmUuYWRkTGlzdGVuZXIobmV3IENoYW5uZWxGdXR1\ncmVMaXN0ZW5lcigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoQ2hh\nbm5lbEZ1dHVyZSBmdXR1cmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgICAgIGlmICghZnV0dXJlLmlzU3VjY2VzcygpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRmFpbGVkIHRvIGNs\nb3NlIHRoZSBzdWJzY3JpcHRpb24gY2hhbm5lbCBmb3IgdG9waWM6ICIgKyB0\nb3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiLCBzdWJzY3JpYmVySWQ6ICIgKyBzdWJzY3JpYmVy\nSWQudG9TdHJpbmdVdGY4KCkpOwogICAgICAgICAgICAgICAgICAgICAgICBj\nYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY29udGV4dCwgbmV3IFNlcnZpY2VE\nb3duRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICJGYWlsZWQgdG8gY2xvc2UgdGhlIHN1\nYnNjcmlwdGlvbiBjaGFubmVsIGZvciB0b3BpYzogIiArIHRvcGljLnRvU3Ry\naW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyAiLCBzdWJzY3JpYmVySWQ6ICIgKyBzdWJz\nY3JpYmVySWQudG9TdHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GaW5pc2hlZChjb250ZXh0LCBudWxsKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwog\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxvZ2dlci53YXJuKCJUcnlp\nbmcgdG8gY2xvc2UgYSBzdWJzY3JpcHRpb24gd2hlbiB3ZSBkb24ndCBoYXZl\nIGEgc3Vic2NyaWJlIGNoYW5uZWwgY2FjaGVkIGZvciB0b3BpYzogIgogICAg\nICAgICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsg\nIiwgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRm\nOCgpKTsKICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQo\nY29udGV4dCwgbnVsbCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFB1Ymxp\nYyBnZXR0ZXIgYW5kIHNldHRlcnMgZm9yIGVudHJpZXMgaW4gdGhlIHRvcGlj\nMkhvc3QgTWFwLgogICAgLy8gVGhpcyBpcyB1c2VkIGZvciBjbGFzc2VzIHRo\nYXQgbmVlZCB0aGlzIGluZm9ybWF0aW9uIGJ1dCBhcmUgbm90IGluIHRoZQog\nICAgLy8gc2FtZSBjbGFzc3BhdGguCiAgICBwdWJsaWMgQ2hhbm5lbCBnZXRD\naGFubmVsRm9yVG9waWMoVG9waWNTdWJzY3JpYmVyIHRvcGljKSB7CiAgICAg\nICAgcmV0dXJuIHRvcGljU3Vic2NyaWJlcjJDaGFubmVsLmdldCh0b3BpYyk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2hhbm5lbEZvclRvcGljKFRv\ncGljU3Vic2NyaWJlciB0b3BpYywgQ2hhbm5lbCBjaGFubmVsKSB7CiAgICAg\nICAgdG9waWNTdWJzY3JpYmVyMkNoYW5uZWwucHV0KHRvcGljLCBjaGFubmVs\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVDaGFubmVsRm9yVG9w\naWMoVG9waWNTdWJzY3JpYmVyIHRvcGljKSB7CiAgICAgICAgdG9waWNTdWJz\nY3JpYmVyMkNoYW5uZWwucmVtb3ZlKHRvcGljKTsKICAgIH0KCn0K\n","encoding":"base64"}

