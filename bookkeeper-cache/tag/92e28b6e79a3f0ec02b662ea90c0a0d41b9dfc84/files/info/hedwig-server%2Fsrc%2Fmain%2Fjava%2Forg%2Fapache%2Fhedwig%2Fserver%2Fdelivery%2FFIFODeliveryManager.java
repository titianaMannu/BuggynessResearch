{"sha":"2c9af4d3cd816597fb65f38ffaa740c01951276e","node_id":"MDQ6QmxvYjE1NzU5NTY6MmM5YWY0ZDNjZDgxNjU5N2ZiNjVmMzhmZmFhNzQwYzAxOTUxMjc2ZQ==","size":20694,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2c9af4d3cd816597fb65f38ffaa740c01951276e","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuZGVsaXZlcnk7CgppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUXVl\ndWU7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLlNv\ncnRlZE1hcDsKaW1wb3J0IGphdmEudXRpbC5UcmVlTWFwOwppbXBvcnQgamF2\nYS51dGlsLmNvbmN1cnJlbnQuQmxvY2tpbmdRdWV1ZTsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRMaW5rZWRRdWV1ZTsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBv\ncmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rv\ncnk7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEuVG9waWNTdWJz\nY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2VTZXFJZDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlBy\nb3RvY29sVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLlB1YlN1YlJlc3BvbnNlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3RhdHVz\nQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24u\nU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnNlcnZlci5jb21tb24uVW5leHBlY3RlZEVycm9yOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLkZhY3Rvcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuTWFwTWV0\naG9kczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0\nZW5jZS5QZXJzaXN0ZW5jZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuU2NhbkNhbGxiYWNrOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLlNjYW5SZXF1\nZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnN1YnNjcmlw\ndGlvbnMuTWVzc2FnZUZpbHRlcjsKCnB1YmxpYyBjbGFzcyBGSUZPRGVsaXZl\ncnlNYW5hZ2VyIGltcGxlbWVudHMgUnVubmFibGUsIERlbGl2ZXJ5TWFuYWdl\nciB7CgogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2Vy\nID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoRklGT0RlbGl2ZXJ5TWFuYWdl\nci5jbGFzcyk7CgogICAgcHJvdGVjdGVkIGludGVyZmFjZSBEZWxpdmVyeU1h\nbmFnZXJSZXF1ZXN0IHsKICAgICAgICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVx\ndWVzdCgpOwogICAgfQoKICAgIC8qKgogICAgICogdGhlIG1haW4gcXVldWUg\ndGhhdCB0aGUgc2luZ2xlLXRocmVhZGVkIGRlbGl2ZXJ5IG1hbmFnZXIgd29y\na3Mgb2ZmIG9mCiAgICAgKi8KICAgIEJsb2NraW5nUXVldWU8RGVsaXZlcnlN\nYW5hZ2VyUmVxdWVzdD4gcmVxdWVzdFF1ZXVlID0gbmV3IExpbmtlZEJsb2Nr\naW5nUXVldWU8RGVsaXZlcnlNYW5hZ2VyUmVxdWVzdD4oKTsKCiAgICAvKioK\nICAgICAqIFRoZSBxdWV1ZSBvZiBhbGwgc3Vic2NyaXB0aW9ucyB0aGF0IGFy\nZSBmYWNpbmcgYSB0cmFuc2llbnQgZXJyb3IgZWl0aGVyCiAgICAgKiBpbiBz\nY2FubmluZyBmcm9tIHRoZSBwZXJzaXN0ZW5jZSBtYW5hZ2VyLCBvciBpbiBz\nZW5kaW5nIHRvIHRoZSBjb25zdW1lcgogICAgICovCiAgICBRdWV1ZTxBY3Rp\ndmVTdWJzY3JpYmVyU3RhdGU+IHJldHJ5UXVldWUgPSBuZXcgQ29uY3VycmVu\ndExpbmtlZFF1ZXVlPEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4oKTsKCiAgICAv\nKioKICAgICAqIFN0b3JlcyBhIG1hcHBpbmcgZnJvbSB0b3BpYyB0byB0aGUg\nZGVsaXZlcnkgcG9pbnRlcnMgb24gdGhlIHRvcGljLiBUaGUKICAgICAqIGRl\nbGl2ZXJ5IHBvaW50ZXJzIGFyZSBzdG9yZWQgaW4gYSBzb3J0ZWQgbWFwIGZy\nb20gc2VxLWlkIHRvIHRoZSBzZXQgb2YKICAgICAqIHN1YnNjcmliZXJzIGF0\nIHRoYXQgc2VxLWlkCiAgICAgKi8KICAgIE1hcDxCeXRlU3RyaW5nLCBTb3J0\nZWRNYXA8TG9uZywgU2V0PEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4+PiBwZXJU\nb3BpY0RlbGl2ZXJ5UHRyczsKCiAgICAvKioKICAgICAqIE1hcHBpbmcgZnJv\nbSBkZWxpdmVyeSBlbmQgcG9pbnQgdG8gdGhlIHN1YnNjcmliZXIgc3RhdGUg\ndGhhdCB3ZSBhcmUKICAgICAqIHNlcnZpbmcgYXQgdGhhdCBlbmQgcG9pbnQu\nIFRoaXMgcHJldmVudHMgdXMgZS5nLiwgZnJvbSBzZXJ2aW5nIHR3bwogICAg\nICogc3Vic2NyaXB0aW9ucyB0byB0aGUgc2FtZSBlbmRwb2ludAogICAgICov\nCiAgICBNYXA8VG9waWNTdWJzY3JpYmVyLCBBY3RpdmVTdWJzY3JpYmVyU3Rh\ndGU+IHN1YnNjcmliZXJTdGF0ZXM7CgogICAgcHJpdmF0ZSBQZXJzaXN0ZW5j\nZU1hbmFnZXIgcGVyc2lzdGVuY2VNZ3I7CgogICAgcHJpdmF0ZSBTZXJ2ZXJD\nb25maWd1cmF0aW9uIGNmZzsKCiAgICAvLyBCb29sZWFuIGluZGljYXRpbmcg\naWYgdGhpcyB0aHJlYWQgc2hvdWxkIGNvbnRpbnVlIHJ1bm5pbmcuIFRoaXMg\naXMgdXNlZAogICAgLy8gd2hlbiB3ZSB3YW50IHRvIHN0b3AgdGhlIHRocmVh\nZCBkdXJpbmcgYSBQdWJTdWJTZXJ2ZXIgc2h1dGRvd24uCiAgICBwcm90ZWN0\nZWQgYm9vbGVhbiBrZWVwUnVubmluZyA9IHRydWU7CgogICAgcHVibGljIEZJ\nRk9EZWxpdmVyeU1hbmFnZXIoUGVyc2lzdGVuY2VNYW5hZ2VyIHBlcnNpc3Rl\nbmNlTWdyLCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNmZykgewogICAgICAgIHRo\naXMucGVyc2lzdGVuY2VNZ3IgPSBwZXJzaXN0ZW5jZU1ncjsKICAgICAgICBw\nZXJUb3BpY0RlbGl2ZXJ5UHRycyA9IG5ldyBIYXNoTWFwPEJ5dGVTdHJpbmcs\nIFNvcnRlZE1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4+\nKCk7CiAgICAgICAgc3Vic2NyaWJlclN0YXRlcyA9IG5ldyBIYXNoTWFwPFRv\ncGljU3Vic2NyaWJlciwgQWN0aXZlU3Vic2NyaWJlclN0YXRlPigpOwogICAg\nICAgIG5ldyBUaHJlYWQodGhpcywgIkRlbGl2ZXJ5TWFuYWdlclRocmVhZCIp\nLnN0YXJ0KCk7CiAgICAgICAgdGhpcy5jZmcgPSBjZmc7CiAgICB9CgogICAg\nLyoqCiAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gT3VyCiAgICAg\nKiB1c3VhbCBlbnF1ZXVlIGZ1bmN0aW9uLCBzdG9wIGlmIGVycm9yIGJlY2F1\nc2Ugb2YgdW5ib3VuZGVkIHF1ZXVlLCBzaG91bGQKICAgICAqIG5ldmVyIGhh\ncHBlbgogICAgICoKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZW5xdWV1\nZVdpdGhvdXRGYWlsdXJlKERlbGl2ZXJ5TWFuYWdlclJlcXVlc3QgcmVxdWVz\ndCkgewogICAgICAgIGlmICghcmVxdWVzdFF1ZXVlLm9mZmVyKHJlcXVlc3Qp\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVbmV4cGVjdGVkRXJyb3IoIkNv\ndWxkIG5vdCBlbnF1ZXVlIG9iamVjdDogIiArIHJlcXVlc3QgKyAiIHRvIGRl\nbGl2ZXJ5IG1hbmFnZXIgcmVxdWVzdCBxdWV1ZS4iKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQog\nICAgICogUHVibGljIGludGVyZmFjZSBvZiB0aGUgZGVsaXZlcnkgbWFuYWdl\ncgogICAgICovCgogICAgLyoqCiAgICAgKiBUZWxscyB0aGUgZGVsaXZlcnkg\nbWFuYWdlciB0byBzdGFydCBzZW5kaW5nIG91dCBtZXNzYWdlcyBmb3IgYSBw\nYXJ0aWN1bGFyCiAgICAgKiBzdWJzY3JpcHRpb24KICAgICAqCiAgICAgKiBA\ncGFyYW0gdG9waWMKICAgICAqIEBwYXJhbSBzdWJzY3JpYmVySWQKICAgICAq\nIEBwYXJhbSBzZXFJZFRvU3RhcnRGcm9tCiAgICAgKiAgICAgICAgICAgIE1l\nc3NhZ2Ugc2VxdWVuY2UtaWQgZnJvbSB3aGVyZSBkZWxpdmVyeSBzaG91bGQg\nYmUgc3RhcnRlZAogICAgICogQHBhcmFtIGVuZFBvaW50CiAgICAgKiAgICAg\nICAgICAgIFRoZSBkZWxpdmVyeSBlbmQgcG9pbnQgdG8gd2hpY2ggc2VuZCBt\nZXNzYWdlcyB0bwogICAgICogQHBhcmFtIGZpbHRlcgogICAgICogICAgICAg\nICAgICBPbmx5IG1lc3NhZ2VzIHBhc3NpbmcgdGhpcyBmaWx0ZXIgc2hvdWxk\nIGJlIHNlbnQgdG8gdGhpcwogICAgICogICAgICAgICAgICBzdWJzY3JpYmVy\nCiAgICAgKiBAcGFyYW0gaXNIdWJTdWJzY3JpYmVyCiAgICAgKiAgICAgICAg\nICAgIFRoZXJlIGFyZSBzb21lIHNlcS1pZCBpbnRyaWNhY2llcy4gVG8gYSBo\ndWIgc3Vic2NyaWJlciwgd2UKICAgICAqICAgICAgICAgICAgc2hvdWxkIHNl\nbmQgb25seSBhIHN1YnNldCBvZiB0aGUgc2VxLWlkIHZlY3RvcgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzdGFydFNlcnZpbmdTdWJzY3JpcHRpb24oQnl0\nZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsIE1lc3Nh\nZ2VTZXFJZCBzZXFJZFRvU3RhcnRGcm9tLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIERlbGl2ZXJ5RW5kUG9pbnQgZW5kUG9p\nbnQsIE1lc3NhZ2VGaWx0ZXIgZmlsdGVyLCBib29sZWFuIGlzSHViU3Vic2Ny\naWJlcikgewoKICAgICAgICBBY3RpdmVTdWJzY3JpYmVyU3RhdGUgc3Vic2Ny\naWJlciA9IG5ldyBBY3RpdmVTdWJzY3JpYmVyU3RhdGUodG9waWMsIHN1YnNj\ncmliZXJJZCwgc2VxSWRUb1N0YXJ0RnJvbQogICAgICAgICAgICAgICAgLmdl\ndExvY2FsQ29tcG9uZW50KCkgLSAxLCBlbmRQb2ludCwgZmlsdGVyLCBpc0h1\nYlN1YnNjcmliZXIpOwoKICAgICAgICBlbnF1ZXVlV2l0aG91dEZhaWx1cmUo\nc3Vic2NyaWJlcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgc3RvcFNlcnZp\nbmdTdWJzY3JpYmVyKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vi\nc2NyaWJlcklkKSB7CiAgICAgICAgQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1\nYlN0YXRlID0gc3Vic2NyaWJlclN0YXRlcy5nZXQobmV3IFRvcGljU3Vic2Ny\naWJlcih0b3BpYywgc3Vic2NyaWJlcklkKSk7CgogICAgICAgIGlmIChzdWJT\ndGF0ZSAhPSBudWxsKSB7CiAgICAgICAgICAgIHN0b3BTZXJ2aW5nU3Vic2Ny\naWJlcihzdWJTdGF0ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogRHVlIHRvIHNvbWUgZXJyb3Igb3IgZGlzY29ubmVjdGlvbiBvciB1bnN1\nc2JjcmliZSwgc29tZW9uZSBhc2tzIHVzIHRvCiAgICAgKiBzdG9wIHNlcnZp\nbmcgYSBwYXJ0aWN1bGFyIGVuZHBvaW50CiAgICAgKgogICAgICogQHBhcmFt\nIGVuZFBvaW50CiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0b3BTZXJ2\naW5nU3Vic2NyaWJlcihBY3RpdmVTdWJzY3JpYmVyU3RhdGUgc3Vic2NyaWJl\ncikgewogICAgICAgIGVucXVldWVXaXRob3V0RmFpbHVyZShuZXcgU3RvcFNl\ncnZpbmdTdWJzY3JpYmVyKHN1YnNjcmliZXIpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEluc3RydWN0cyB0aGUgZGVsaXZlcnkgbWFuYWdlciB0byBiYWNr\nb2ZmIG9uIHRoZSBnaXZlbiBzdWJzY3JpYmVyIGFuZAogICAgICogcmV0cnkg\nc2VuZGluZyBhZnRlciBzb21lIHRpbWUKICAgICAqCiAgICAgKiBAcGFyYW0g\nc3Vic2NyaWJlcgogICAgICovCgogICAgcHVibGljIHZvaWQgcmV0cnlFcnJv\ncmVkU3Vic2NyaWJlckFmdGVyRGVsYXkoQWN0aXZlU3Vic2NyaWJlclN0YXRl\nIHN1YnNjcmliZXIpIHsKCiAgICAgICAgc3Vic2NyaWJlci5zZXRMYXN0U2Nh\nbkVycm9yVGltZShTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSk7CgogICAg\nICAgIGlmICghcmV0cnlRdWV1ZS5vZmZlcihzdWJzY3JpYmVyKSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgVW5leHBlY3RlZEVycm9yKCJDb3VsZCBub3Qg\nZW5xdWV1ZSB0byBkZWxpdmVyeSBtYW5hZ2VyIHJldHJ5IHF1ZXVlIik7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogSW5zdHJ1Y3RzIHRoZSBk\nZWxpdmVyeSBtYW5hZ2VyIHRvIG1vdmUgdGhlIGRlbGl2ZXJ5IHBvaW50ZXIg\nZm9yIGEgZ2l2ZW4KICAgICAqIHN1YnNjcmliZXIKICAgICAqCiAgICAgKiBA\ncGFyYW0gc3Vic2NyaWJlcgogICAgICogQHBhcmFtIHByZXZTZXFJZAogICAg\nICogQHBhcmFtIG5ld1NlcUlkCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIG1v\ndmVEZWxpdmVyeVB0ckZvcndhcmQoQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1\nYnNjcmliZXIsIGxvbmcgcHJldlNlcUlkLCBsb25nIG5ld1NlcUlkKSB7CiAg\nICAgICAgZW5xdWV1ZVdpdGhvdXRGYWlsdXJlKG5ldyBEZWxpdmVyeVB0ck1v\ndmUoc3Vic2NyaWJlciwgcHJldlNlcUlkLCBuZXdTZXFJZCkpOwogICAgfQoK\nICAgIC8qCiAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQog\nICAgICogPT0gRW5kIG9mIHB1YmxpYyBpbnRlcmZhY2UsIGludGVybmFsIG1h\nY2hpbmVyeSBiZWdpbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHJ1bigp\nIHsKICAgICAgICB3aGlsZSAoa2VlcFJ1bm5pbmcpIHsKICAgICAgICAgICAg\nRGVsaXZlcnlNYW5hZ2VyUmVxdWVzdCByZXF1ZXN0ID0gbnVsbDsKCiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAvLyBXZSB1c2UgYSB0aW1l\nb3V0IG9mIDEgc2Vjb25kLCBzbyB0aGF0IHdlIGNhbiB3YWtlIHVwIG9uY2Ug\naW4KICAgICAgICAgICAgICAgIC8vIGEgd2hpbGUgdG8gY2hlY2sgaWYgdGhl\ncmUgaXMgc29tZXRoaW5nIGluIHRoZSByZXRyeSBxdWV1ZS4KICAgICAgICAg\nICAgICAgIHJlcXVlc3QgPSByZXF1ZXN0UXVldWUucG9sbCgxLCBUaW1lVW5p\ndC5TRUNPTkRTKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRU\naHJlYWQoKS5pbnRlcnJ1cHQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gRmlyc3QgcmV0cnkgYW55IHN1YnNjcmlwdGlvbnMgdGhhdCBoYWQg\nZmFpbGVkIGFuZCBuZWVkIGEgcmV0cnkKICAgICAgICAgICAgcmV0cnlFcnJv\ncmVkU3Vic2NyaWJlcnMoKTsKCiAgICAgICAgICAgIGlmIChyZXF1ZXN0ID09\nIG51bGwpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICByZXF1ZXN0LnBlcmZvcm1SZXF1ZXN0KCk7Cgog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN0b3AgbWV0aG9kIHdo\naWNoIHdpbGwgZW5xdWV1ZSBhIFNodXRkb3duRGVsaXZlcnlNYW5hZ2VyUmVx\ndWVzdC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc3RvcCgpIHsKICAgICAg\nICBlbnF1ZXVlV2l0aG91dEZhaWx1cmUobmV3IFNodXRkb3duRGVsaXZlcnlN\nYW5hZ2VyUmVxdWVzdCgpKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBy\nZXRyeUVycm9yZWRTdWJzY3JpYmVycygpIHsKICAgICAgICBsb25nIGxhc3RJ\nbnRlcmVzdGluZ0ZhaWx1cmVUaW1lID0gU3lzdGVtLmN1cnJlbnRUaW1lTWls\nbGlzKCkgLSBjZmcuZ2V0U2NhbkJhY2tvZmZQZXJpb2RNcygpOwogICAgICAg\nIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBzdWJzY3JpYmVyOwoKICAgICAgICB3\naGlsZSAoKHN1YnNjcmliZXIgPSByZXRyeVF1ZXVlLnBlZWsoKSkgIT0gbnVs\nbCkgewogICAgICAgICAgICBpZiAoc3Vic2NyaWJlci5nZXRMYXN0U2NhbkVy\ncm9yVGltZSgpID4gbGFzdEludGVyZXN0aW5nRmFpbHVyZVRpbWUpIHsKICAg\nICAgICAgICAgICAgIC8vIE5vdCBlbm91Z2ggdGltZSBoYXMgZWxhcHNlZCB5\nZXQsIHdpbGwgcmV0cnkgbGF0ZXIKICAgICAgICAgICAgICAgIC8vIFNpbmNl\nIHRoZSBxdWV1ZSBpcyBmaWZvLCBubyBuZWVkIHRvIGNoZWNrIGxhdGVyIGl0\nZW1zCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIC8vIHJldHJ5IG5vdwogICAgICAgICAgICBzdWJzY3JpYmVy\nLmRlbGl2ZXJOZXh0TWVzc2FnZSgpOwogICAgICAgICAgICByZXRyeVF1ZXVl\nLnBvbGwoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\ncmVtb3ZlRGVsaXZlcnlQdHIoQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1YnNj\ncmliZXIsIExvbmcgc2VxSWQsIGJvb2xlYW4gaXNBYnNlbmNlT2ssCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuIHBydW5l\nVG9waWMpIHsKCiAgICAgICAgYXNzZXJ0IHNlcUlkICE9IG51bGw7CgogICAg\nICAgIC8vIHJlbW92ZSB0aGlzIHN1YnNjcmliZXIgZnJvbSB0aGUgZGVsaXZl\ncnkgcG9pbnRlcnMgZGF0YSBzdHJ1Y3R1cmUKICAgICAgICBCeXRlU3RyaW5n\nIHRvcGljID0gc3Vic2NyaWJlci5nZXRUb3BpYygpOwogICAgICAgIFNvcnRl\nZE1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4gZGVsaXZl\ncnlQdHJzID0gcGVyVG9waWNEZWxpdmVyeVB0cnMuZ2V0KHRvcGljKTsKCiAg\nICAgICAgaWYgKGRlbGl2ZXJ5UHRycyA9PSBudWxsICYmICFpc0Fic2VuY2VP\naykgewogICAgICAgICAgICB0aHJvdyBuZXcgVW5leHBlY3RlZEVycm9yKCJO\nbyBkZWxpdmVyeSBwb2ludGVycyBmb3VuZCB3aGlsZSBkaXNjb25uZWN0aW5n\nICIgKyAiY2hhbm5lbCBmb3IgdG9waWM6IiArIHRvcGljKTsKICAgICAgICB9\nCgogICAgICAgIGlmKG51bGwgPT0gZGVsaXZlcnlQdHJzKSB7CiAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghTWFwTWV0aG9k\ncy5yZW1vdmVGcm9tTXVsdGlNYXAoZGVsaXZlcnlQdHJzLCBzZXFJZCwgc3Vi\nc2NyaWJlcikgJiYgIWlzQWJzZW5jZU9rKSB7CgogICAgICAgICAgICB0aHJv\ndyBuZXcgVW5leHBlY3RlZEVycm9yKCJDb3VsZCBub3QgZmluZCBzdWJzY3Jp\nYmVyOiIgKyBzdWJzY3JpYmVyICsgIiBhdCB0aGUgZXhwZWN0ZWQgZGVsaXZl\ncnkgcG9pbnRlciIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBydW5lVG9w\naWMgJiYgZGVsaXZlcnlQdHJzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBw\nZXJUb3BpY0RlbGl2ZXJ5UHRycy5yZW1vdmUodG9waWMpOwogICAgICAgIH0K\nCiAgICB9CgogICAgcHJvdGVjdGVkIGxvbmcgZ2V0TWluaW11bVNlcUlkKEJ5\ndGVTdHJpbmcgdG9waWMpIHsKICAgICAgICBTb3J0ZWRNYXA8TG9uZywgU2V0\nPEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4+IGRlbGl2ZXJ5UHRycyA9IHBlclRv\ncGljRGVsaXZlcnlQdHJzLmdldCh0b3BpYyk7CgogICAgICAgIGlmIChkZWxp\ndmVyeVB0cnMgPT0gbnVsbCB8fCBkZWxpdmVyeVB0cnMuaXNFbXB0eSgpKSB7\nCiAgICAgICAgICAgIHJldHVybiBMb25nLk1BWF9WQUxVRSAtIDE7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBkZWxpdmVyeVB0cnMuZmlyc3RLZXkoKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGREZWxpdmVyeVB0cihBY3Rp\ndmVTdWJzY3JpYmVyU3RhdGUgc3Vic2NyaWJlciwgTG9uZyBzZXFJZCkgewoK\nICAgICAgICAvLyBJZiB0aGlzIHRvcGljIGRvZXNuJ3QgZXhpc3QgaW4gdGhl\nIHBlci10b3BpYyBkZWxpdmVyeSBwb2ludGVycyB0YWJsZSwKICAgICAgICAv\nLyBjcmVhdGUgYW4gZW50cnkgZm9yIGl0CiAgICAgICAgU29ydGVkTWFwPExv\nbmcsIFNldDxBY3RpdmVTdWJzY3JpYmVyU3RhdGU+PiBkZWxpdmVyeVB0cnMg\nPSBNYXBNZXRob2RzLmdldEFmdGVySW5zZXJ0aW5nSWZBYnNlbnQoCiAgICAg\nICAgICAgICAgICAgICAgcGVyVG9waWNEZWxpdmVyeVB0cnMsIHN1YnNjcmli\nZXIuZ2V0VG9waWMoKSwgVHJlZU1hcExvbmdUb1NldFN1YnNjcmliZXJGYWN0\nb3J5Lmluc3RhbmNlKTsKCiAgICAgICAgTWFwTWV0aG9kcy5hZGRUb011bHRp\nTWFwKGRlbGl2ZXJ5UHRycywgc2VxSWQsIHN1YnNjcmliZXIsIEhhc2hNYXBT\ndWJzY3JpYmVyRmFjdG9yeS5pbnN0YW5jZSk7CiAgICB9CgogICAgcHVibGlj\nIGNsYXNzIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBpbXBsZW1lbnRzIFNjYW5D\nYWxsYmFjaywgRGVsaXZlcnlDYWxsYmFjaywgRGVsaXZlcnlNYW5hZ2VyUmVx\ndWVzdCB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYzsKICAgICAgICBCeXRl\nU3RyaW5nIHN1YnNjcmliZXJJZDsKICAgICAgICBsb25nIGxhc3RMb2NhbFNl\ncUlkRGVsaXZlcmVkOwogICAgICAgIGJvb2xlYW4gY29ubmVjdGVkID0gdHJ1\nZTsKICAgICAgICBEZWxpdmVyeUVuZFBvaW50IGRlbGl2ZXJ5RW5kUG9pbnQ7\nCiAgICAgICAgbG9uZyBsYXN0U2NhbkVycm9yVGltZSA9IC0xOwogICAgICAg\nIGxvbmcgbG9jYWxTZXFJZERlbGl2ZXJpbmdOb3c7CiAgICAgICAgbG9uZyBs\nYXN0U2VxSWRDb21tdW5pY2F0ZWRFeHRlcm5hbGx5OwogICAgICAgIC8vIFRP\nRE8gbWFrZSB1c2Ugb2YgdGhlc2UgdmFyaWFibGVzCiAgICAgICAgTWVzc2Fn\nZUZpbHRlciBmaWx0ZXI7CiAgICAgICAgYm9vbGVhbiBpc0h1YlN1YnNjcmli\nZXI7CiAgICAgICAgZmluYWwgc3RhdGljIGludCBTRVFfSURfU0xBQ0sgPSAx\nMDsKCiAgICAgICAgcHVibGljIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZShCeXRl\nU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgbG9uZyBs\nYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIERlbGl2ZXJ5RW5kUG9pbnQgZGVsaXZlcnlFbmRQ\nb2ludCwgTWVzc2FnZUZpbHRlciBmaWx0ZXIsIGJvb2xlYW4gaXNIdWJTdWJz\nY3JpYmVyKSB7CiAgICAgICAgICAgIHRoaXMudG9waWMgPSB0b3BpYzsKICAg\nICAgICAgICAgdGhpcy5zdWJzY3JpYmVySWQgPSBzdWJzY3JpYmVySWQ7CiAg\nICAgICAgICAgIHRoaXMubGFzdExvY2FsU2VxSWREZWxpdmVyZWQgPSBsYXN0\nTG9jYWxTZXFJZERlbGl2ZXJlZDsKICAgICAgICAgICAgdGhpcy5kZWxpdmVy\neUVuZFBvaW50ID0gZGVsaXZlcnlFbmRQb2ludDsKICAgICAgICAgICAgdGhp\ncy5maWx0ZXIgPSBmaWx0ZXI7CiAgICAgICAgICAgIHRoaXMuaXNIdWJTdWJz\nY3JpYmVyID0gaXNIdWJTdWJzY3JpYmVyOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgc2V0Tm90Q29ubmVjdGVkKCkgewogICAgICAgICAgICB0\naGlzLmNvbm5lY3RlZCA9IGZhbHNlOwogICAgICAgICAgICBkZWxpdmVyeUVu\nZFBvaW50LmNsb3NlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQnl0\nZVN0cmluZyBnZXRUb3BpYygpIHsKICAgICAgICAgICAgcmV0dXJuIHRvcGlj\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0TGFzdExvY2Fs\nU2VxSWREZWxpdmVyZWQoKSB7CiAgICAgICAgICAgIHJldHVybiBsYXN0TG9j\nYWxTZXFJZERlbGl2ZXJlZDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBs\nb25nIGdldExhc3RTY2FuRXJyb3JUaW1lKCkgewogICAgICAgICAgICByZXR1\ncm4gbGFzdFNjYW5FcnJvclRpbWU7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCBzZXRMYXN0U2NhbkVycm9yVGltZShsb25nIGxhc3RTY2FuRXJy\nb3JUaW1lKSB7CiAgICAgICAgICAgIHRoaXMubGFzdFNjYW5FcnJvclRpbWUg\nPSBsYXN0U2NhbkVycm9yVGltZTsKICAgICAgICB9CgogICAgICAgIHByb3Rl\nY3RlZCBib29sZWFuIGlzQ29ubmVjdGVkKCkgewogICAgICAgICAgICByZXR1\ncm4gY29ubmVjdGVkOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nZGVsaXZlck5leHRNZXNzYWdlKCkgewoKICAgICAgICAgICAgaWYgKCFpc0Nv\nbm5lY3RlZCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIGxvY2FsU2VxSWREZWxpdmVyaW5nTm93ID0g\ncGVyc2lzdGVuY2VNZ3IuZ2V0U2VxSWRBZnRlclNraXBwaW5nKHRvcGljLCBs\nYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCwgMSk7CgogICAgICAgICAgICBTY2Fu\nUmVxdWVzdCBzY2FuUmVxdWVzdCA9IG5ldyBTY2FuUmVxdWVzdCh0b3BpYywg\nbG9jYWxTZXFJZERlbGl2ZXJpbmdOb3csCiAgICAgICAgICAgICAgICAgICAg\nLyogY2FsbGJhY2s9ICovdGhpcywgLyogY3R4PSAqL251bGwpOwoKICAgICAg\nICAgICAgcGVyc2lzdGVuY2VNZ3Iuc2NhblNpbmdsZU1lc3NhZ2Uoc2NhblJl\ncXVlc3QpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogPT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09CiAgICAgICAgICoge0BsaW5rIFNjYW5DYWxsYmFj\na30gbWV0aG9kcwogICAgICAgICAqLwoKICAgICAgICBwdWJsaWMgdm9pZCBt\nZXNzYWdlU2Nhbm5lZChPYmplY3QgY3R4LCBNZXNzYWdlIG1lc3NhZ2UpIHsK\nICAgICAgICAgICAgaWYgKCFjb25uZWN0ZWQpIHsKICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gV2UncmUg\ndXNpbmcgYSBzaW1wbGUgYWxsLXRvLWFsbCBuZXR3b3JrIHRvcG9sb2d5LCBz\nbyBubyByZWdpb24KICAgICAgICAgICAgLy8gc2hvdWxkIGV2ZXIgbmVlZCB0\nbyBmb3J3YXJkIG1lc3NhZ2VzIHRvIGFueSBvdGhlciByZWdpb24uCiAgICAg\nICAgICAgIC8vIE90aGVyd2lzZSwgd2l0aCB0aGUgY3VycmVudCBsb2dpYywg\nbWVzc2FnZXMgd2lsbCBlbmQgdXAKICAgICAgICAgICAgLy8gcGluZy1wb25n\nLWluZyBiYWNrIGFuZCBmb3J0aCBiZXR3ZWVuIHJlZ2lvbnMgd2l0aCBzdWJz\nY3JpcHRpb25zCiAgICAgICAgICAgIC8vIHRvIGVhY2ggb3RoZXIgd2l0aG91\ndCB0ZXJtaW5hdGlvbiAob3IgaW4gYW55IG90aGVyIGN5Y2xpYwogICAgICAg\nICAgICAvLyBjb25maWd1cmF0aW9uKS4KICAgICAgICAgICAgaWYgKGlzSHVi\nU3Vic2NyaWJlciAmJiAhbWVzc2FnZS5nZXRTcmNSZWdpb24oKS5lcXVhbHMo\nY2ZnLmdldE15UmVnaW9uQnl0ZVN0cmluZygpKSkgewogICAgICAgICAgICAg\nICAgc2VuZGluZ0ZpbmlzaGVkKCk7CiAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAg\nKiBUaGUgbWV0aG9kIGJlbG93IHdpbGwgaW52b2tlIG91ciBzZW5kaW5nRmlu\naXNoZWQoKSBtZXRob2Qgd2hlbgogICAgICAgICAgICAgKiBkb25lCiAgICAg\nICAgICAgICAqLwogICAgICAgICAgICBQdWJTdWJSZXNwb25zZSByZXNwb25z\nZSA9IFB1YlN1YlJlc3BvbnNlLm5ld0J1aWxkZXIoKS5zZXRQcm90b2NvbFZl\ncnNpb24oUHJvdG9jb2xWZXJzaW9uLlZFUlNJT05fT05FKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRTdGF0dXNDb2RlKFN0\nYXR1c0NvZGUuU1VDQ0VTUykuc2V0VHhuSWQoMCkuc2V0TWVzc2FnZShtZXNz\nYWdlKS5idWlsZCgpOwoKICAgICAgICAgICAgZGVsaXZlcnlFbmRQb2ludC5z\nZW5kKHJlc3BvbnNlLCAvLwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gY2FsbGJhY2sgPQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdGhpcyk7CgogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgc2NhbkZhaWxlZChPYmplY3QgY3R4LCBFeGNlcHRpb24gZXhjZXB0aW9u\nKSB7CiAgICAgICAgICAgIGlmICghY29ubmVjdGVkKSB7CiAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHdh\naXQgZm9yIHNvbWUgdGltZSBhbmQgdGhlbiByZXRyeQogICAgICAgICAgICBy\nZXRyeUVycm9yZWRTdWJzY3JpYmVyQWZ0ZXJEZWxheSh0aGlzKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNjYW5GaW5pc2hlZChPYmplY3Qg\nY3R4LCBSZWFzb25Gb3JGaW5pc2ggcmVhc29uKSB7CiAgICAgICAgICAgIC8v\nIG5vLW9wCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiA9PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT0KICAgICAgICAgKiB7QGxpbmsgRGVsaXZlcnlDYWxs\nYmFja30gbWV0aG9kcwogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lk\nIHNlbmRpbmdGaW5pc2hlZCgpIHsKICAgICAgICAgICAgaWYgKCFjb25uZWN0\nZWQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgbGFzdExvY2FsU2VxSWREZWxpdmVyZWQgPSBsb2NhbFNl\ncUlkRGVsaXZlcmluZ05vdzsKCiAgICAgICAgICAgIGlmIChsYXN0TG9jYWxT\nZXFJZERlbGl2ZXJlZCA+IGxhc3RTZXFJZENvbW11bmljYXRlZEV4dGVybmFs\nbHkgKyBTRVFfSURfU0xBQ0spIHsKICAgICAgICAgICAgICAgIC8vIE5vdGU6\nIFRoZSBvcmRlciBvZiB0aGUgbmV4dCAyIHN0YXRlbWVudHMgaXMgaW1wb3J0\nYW50LiBXZSBzaG91bGQKICAgICAgICAgICAgICAgIC8vIHN1Ym1pdCBhIHJl\ncXVlc3QgdG8gY2hhbmdlIG91ciBkZWxpdmVyeSBwb2ludGVyIG9ubHkgKmFm\ndGVyKiB3ZQogICAgICAgICAgICAgICAgLy8gaGF2ZSBhY3R1YWxseSBjaGFu\nZ2VkIGl0LiBPdGhlcndpc2UsIHRoZXJlIGlzIGEgcmFjZSBjb25kaXRpb24K\nICAgICAgICAgICAgICAgIC8vIHdpdGggcmVtb3ZhbCBvZiB0aGlzIGNoYW5u\nZWwsIHcuci50LCBtYWludGFpbmluZyB0aGUgZGVsaXZlcnlQdHJzCiAgICAg\nICAgICAgICAgICAvLyB0cmVlIG1hcC4KICAgICAgICAgICAgICAgIGxvbmcg\ncHJldklkID0gbGFzdFNlcUlkQ29tbXVuaWNhdGVkRXh0ZXJuYWxseTsKICAg\nICAgICAgICAgICAgIGxhc3RTZXFJZENvbW11bmljYXRlZEV4dGVybmFsbHkg\nPSBsYXN0TG9jYWxTZXFJZERlbGl2ZXJlZDsKICAgICAgICAgICAgICAgIG1v\ndmVEZWxpdmVyeVB0ckZvcndhcmQodGhpcywgcHJldklkLCBsYXN0TG9jYWxT\nZXFJZERlbGl2ZXJlZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGVs\naXZlck5leHRNZXNzYWdlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nbG9uZyBnZXRMYXN0U2VxSWRDb21tdW5pY2F0ZWRFeHRlcm5hbGx5KCkgewog\nICAgICAgICAgICByZXR1cm4gbGFzdFNlcUlkQ29tbXVuaWNhdGVkRXh0ZXJu\nYWxseTsKICAgICAgICB9CgoKICAgICAgICBwdWJsaWMgdm9pZCBwZXJtYW5l\nbnRFcnJvck9uU2VuZCgpIHsKICAgICAgICAgICAgc3RvcFNlcnZpbmdTdWJz\nY3JpYmVyKHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\ndHJhbnNpZW50RXJyb3JPblNlbmQoKSB7CiAgICAgICAgICAgIHJldHJ5RXJy\nb3JlZFN1YnNjcmliZXJBZnRlckRlbGF5KHRoaXMpOwogICAgICAgIH0KCiAg\nICAgICAgLyoqCiAgICAgICAgICogPT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAg\nICAgICoge0BsaW5rIERlbGl2ZXJ5TWFuYWdlclJlcXVlc3R9IG1ldGhvZHMK\nICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVxdWVz\ndCgpIHsKCiAgICAgICAgICAgIC8vIFB1dCB0aGlzIHN1YnNjcmliZXIgaW4g\ndGhlIGNoYW5uZWwgdG8gc3Vic2NyaWJlciBtYXBwaW5nCiAgICAgICAgICAg\nIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBwcmV2U3Vic2NyaWJlciA9IHN1YnNj\ncmliZXJTdGF0ZXMucHV0KG5ldyBUb3BpY1N1YnNjcmliZXIodG9waWMsIHN1\nYnNjcmliZXJJZCksIHRoaXMpOwoKICAgICAgICAgICAgaWYgKHByZXZTdWJz\nY3JpYmVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHN0b3BTZXJ2aW5n\nU3Vic2NyaWJlcihwcmV2U3Vic2NyaWJlcik7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIGxhc3RTZXFJZENvbW11bmljYXRlZEV4dGVybmFsbHkgPSBs\nYXN0TG9jYWxTZXFJZERlbGl2ZXJlZDsKICAgICAgICAgICAgYWRkRGVsaXZl\ncnlQdHIodGhpcywgbGFzdExvY2FsU2VxSWREZWxpdmVyZWQpOwoKICAgICAg\nICAgICAgZGVsaXZlck5leHRNZXNzYWdlKCk7CiAgICAgICAgfTsKCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygp\nIHsKICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdC\ndWlsZGVyKCk7CiAgICAgICAgICAgIHNiLmFwcGVuZCgiVG9waWM6ICIpOwog\nICAgICAgICAgICBzYi5hcHBlbmQodG9waWMudG9TdHJpbmdVdGY4KCkpOwog\nICAgICAgICAgICBzYi5hcHBlbmQoIkRlbGl2ZXJ5UHRyOiAiKTsKICAgICAg\nICAgICAgc2IuYXBwZW5kKGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkKTsKICAg\nICAgICAgICAgcmV0dXJuIHNiLnRvU3RyaW5nKCk7CgogICAgICAgIH0KICAg\nIH0KCiAgICBwcm90ZWN0ZWQgY2xhc3MgU3RvcFNlcnZpbmdTdWJzY3JpYmVy\nIGltcGxlbWVudHMgRGVsaXZlcnlNYW5hZ2VyUmVxdWVzdCB7CiAgICAgICAg\nQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXI7CgogICAgICAgIHB1\nYmxpYyBTdG9wU2VydmluZ1N1YnNjcmliZXIoQWN0aXZlU3Vic2NyaWJlclN0\nYXRlIHN1YnNjcmliZXIpIHsKICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVy\nID0gc3Vic2NyaWJlcjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyB2b2lkIHBlcmZvcm1SZXF1ZXN0KCkgewoKICAgICAg\nICAgICAgLy8gVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgc3RvcCBkZWxpdmVy\neSwgYW5kIGRpc2Nvbm5lY3QgdGhlIGNoYW5uZWwKICAgICAgICAgICAgc3Vi\nc2NyaWJlci5zZXROb3RDb25uZWN0ZWQoKTsKCiAgICAgICAgICAgIC8vIGlm\nIHRoZSBzdWJzY3JpYmVyIGhhcyBtb3ZlZCBvbiwgYSBtb3ZlIHJlcXVlc3Qg\nZm9yIGl0cyBkZWxpdmVyeQogICAgICAgICAgICAvLyBwb2ludGVyIG11c3Qg\nYmUgcGVuZGluZyBpbiB0aGUgcmVxdWVzdCBxdWV1ZS4gTm90ZSB0aGF0IHRo\nZQogICAgICAgICAgICAvLyBzdWJzY3JpYmVyIGZpcnN0IGNoYW5nZXMgaXRz\nIGRlbGl2ZXJ5IHBvaW50ZXIgYW5kIHRoZW4gc3VibWl0cyBhCiAgICAgICAg\nICAgIC8vIHJlcXVlc3QgdG8gbW92ZSBzbyB0aGlzIHdvcmtzLgogICAgICAg\nICAgICByZW1vdmVEZWxpdmVyeVB0cihzdWJzY3JpYmVyLCBzdWJzY3JpYmVy\nLmdldExhc3RTZXFJZENvbW11bmljYXRlZEV4dGVybmFsbHkoKSwgLy8KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXNBYnNlbmNlT2s9CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIHBydW5lVG9waWM9CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHRydWUpOwogICAgICAgIH0KCiAgICB9Cgog\nICAgcHJvdGVjdGVkIGNsYXNzIERlbGl2ZXJ5UHRyTW92ZSBpbXBsZW1lbnRz\nIERlbGl2ZXJ5TWFuYWdlclJlcXVlc3QgewoKICAgICAgICBBY3RpdmVTdWJz\nY3JpYmVyU3RhdGUgc3Vic2NyaWJlcjsKICAgICAgICBMb25nIG9sZFNlcUlk\nOwogICAgICAgIExvbmcgbmV3U2VxSWQ7CgogICAgICAgIHB1YmxpYyBEZWxp\ndmVyeVB0ck1vdmUoQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXIs\nIExvbmcgb2xkU2VxSWQsIExvbmcgbmV3U2VxSWQpIHsKICAgICAgICAgICAg\ndGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjsKICAgICAgICAgICAgdGhp\ncy5vbGRTZXFJZCA9IG9sZFNlcUlkOwogICAgICAgICAgICB0aGlzLm5ld1Nl\ncUlkID0gbmV3U2VxSWQ7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVxdWVzdCgpIHsKICAgICAg\nICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IHN1YnNjcmliZXIuZ2V0VG9waWMo\nKTsKICAgICAgICAgICAgbG9uZyBwcmV2TWluU2VxSWQgPSBnZXRNaW5pbXVt\nU2VxSWQodG9waWMpOwoKICAgICAgICAgICAgaWYgKHN1YnNjcmliZXIuaXND\nb25uZWN0ZWQoKSkgewogICAgICAgICAgICAgICAgcmVtb3ZlRGVsaXZlcnlQ\ndHIoc3Vic2NyaWJlciwgb2xkU2VxSWQsIC8vCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAvLyBpc0Fic2VuY2VPaz0KICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gcHJ1bmVUb3BpYz0KICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKCiAgICAgICAgICAgICAg\nICBhZGREZWxpdmVyeVB0cihzdWJzY3JpYmVyLCBuZXdTZXFJZCk7CiAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZW1vdmVEZWxpdmVy\neVB0cihzdWJzY3JpYmVyLCBvbGRTZXFJZCwgLy8KICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIGlzQWJzZW5jZU9rPQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIHBydW5lVG9waWM9CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB0cnVlKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgbG9uZyBub3dNaW5TZXFJZCA9IGdldE1pbmltdW1TZXFJ\nZCh0b3BpYyk7CgogICAgICAgICAgICBpZiAobm93TWluU2VxSWQgPiBwcmV2\nTWluU2VxSWQpIHsKICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNlTWdyLmRl\nbGl2ZXJlZFVudGlsKHRvcGljLCBub3dNaW5TZXFJZCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIGNsYXNzIFNodXRk\nb3duRGVsaXZlcnlNYW5hZ2VyUmVxdWVzdCBpbXBsZW1lbnRzIERlbGl2ZXJ5\nTWFuYWdlclJlcXVlc3QgewogICAgICAgIC8vIFRoaXMgaXMgYSBzaW1wbGUg\ndHlwZSBvZiBSZXF1ZXN0IHdlIHdpbGwgZW5xdWV1ZSB3aGVuIHRoZQogICAg\nICAgIC8vIFB1YlN1YlNlcnZlciBpcyBzaHV0IGRvd24gYW5kIHdlIHdhbnQg\ndG8gc3RvcCB0aGUgRGVsaXZlcnlNYW5hZ2VyCiAgICAgICAgLy8gdGhyZWFk\nLgogICAgICAgIHB1YmxpYyB2b2lkIHBlcmZvcm1SZXF1ZXN0KCkgewogICAg\nICAgICAgICBrZWVwUnVubmluZyA9IGZhbHNlOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAg\nKgogICAgICogRHVtYiBmYWN0b3JpZXMgZm9yIG91ciBtYXAgbWV0aG9kcwog\nICAgICovCiAgICBwcm90ZWN0ZWQgc3RhdGljIGNsYXNzIFRyZWVNYXBMb25n\nVG9TZXRTdWJzY3JpYmVyRmFjdG9yeSBpbXBsZW1lbnRzCiAgICAgICAgRmFj\ndG9yeTxTb3J0ZWRNYXA8TG9uZywgU2V0PEFjdGl2ZVN1YnNjcmliZXJTdGF0\nZT4+PiB7CiAgICAgICAgc3RhdGljIFRyZWVNYXBMb25nVG9TZXRTdWJzY3Jp\nYmVyRmFjdG9yeSBpbnN0YW5jZSA9IG5ldyBUcmVlTWFwTG9uZ1RvU2V0U3Vi\nc2NyaWJlckZhY3RvcnkoKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIFNvcnRlZE1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vic2NyaWJlclN0\nYXRlPj4gbmV3SW5zdGFuY2UoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nVHJlZU1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4oKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBI\nYXNoTWFwU3Vic2NyaWJlckZhY3RvcnkgaW1wbGVtZW50cyBGYWN0b3J5PFNl\ndDxBY3RpdmVTdWJzY3JpYmVyU3RhdGU+PiB7CiAgICAgICAgc3RhdGljIEhh\nc2hNYXBTdWJzY3JpYmVyRmFjdG9yeSBpbnN0YW5jZSA9IG5ldyBIYXNoTWFw\nU3Vic2NyaWJlckZhY3RvcnkoKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIFNldDxBY3RpdmVTdWJzY3JpYmVyU3RhdGU+IG5ld0luc3Rh\nbmNlKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEhhc2hTZXQ8QWN0aXZl\nU3Vic2NyaWJlclN0YXRlPigpOwogICAgICAgIH0KICAgIH0KCn0K\n","encoding":"base64"}

