{"sha":"f3b108a1452c5fafdccb8f2b292fd529ba0414c6","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjNiMTA4YTE0NTJjNWZhZmRjY2I4ZjJiMjkyZmQ1MjliYTA0MTRjNg==","size":7289,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f3b108a1452c5fafdccb8f2b292fd529ba0414c6","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaGFuZGxlcnM7CgppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hNYXA7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hh\nbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxG\ndXR1cmVMaXN0ZW5lcjsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5\ndGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZGF0\nYS5Ub3BpY1N1YnNjcmliZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5l\neGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uLlNlcnZlck5vdFJl\nc3BvbnNpYmxlRm9yVG9waWNFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQ7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90\nb2NvbC5QdWJTdWJSZXF1ZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdDsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvZXh0ZW5zaW9ucy5QdWJTdWJS\nZXNwb25zZVV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9l\neHRlbnNpb25zLlN1YnNjcmlwdGlvblN0YXRlVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9uLlNlcnZlckNvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuZGVsaXZlcnku\nQ2hhbm5lbEVuZFBvaW50OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLmRlbGl2ZXJ5LkRlbGl2ZXJ5TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5uZXR0eS5VbWJyZWxsYUhhbmRsZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuUGVyc2lz\ndGVuY2VNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVy\nLnN1YnNjcmlwdGlvbnMuU3Vic2NyaXB0aW9uTWFuYWdlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5zdWJzY3JpcHRpb25zLlRydWVGaWx0\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzLlRv\ncGljTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2Fs\nbGJhY2s7CgpwdWJsaWMgY2xhc3MgU3Vic2NyaWJlSGFuZGxlciBleHRlbmRz\nIEJhc2VIYW5kbGVyIGltcGxlbWVudHMgQ2hhbm5lbERpc2Nvbm5lY3RMaXN0\nZW5lciB7CiAgICBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3Rv\ncnkuZ2V0TG9nZ2VyKFN1YnNjcmliZUhhbmRsZXIuY2xhc3MpOwoKICAgIHBy\naXZhdGUgRGVsaXZlcnlNYW5hZ2VyIGRlbGl2ZXJ5TWdyOwogICAgcHJpdmF0\nZSBQZXJzaXN0ZW5jZU1hbmFnZXIgcGVyc2lzdGVuY2VNZ3I7CiAgICBwcml2\nYXRlIFN1YnNjcmlwdGlvbk1hbmFnZXIgc3ViTWdyOwogICAgQ29uY3VycmVu\ndEhhc2hNYXA8VG9waWNTdWJzY3JpYmVyLCBDaGFubmVsPiBzdWIyQ2hhbm5l\nbDsKICAgIENvbmN1cnJlbnRIYXNoTWFwPENoYW5uZWwsIFRvcGljU3Vic2Ny\naWJlcj4gY2hhbm5lbDJzdWI7CgogICAgcHVibGljIFN1YnNjcmliZUhhbmRs\nZXIoVG9waWNNYW5hZ2VyIHRvcGljTWdyLCBEZWxpdmVyeU1hbmFnZXIgZGVs\naXZlcnlNYW5hZ2VyLCBQZXJzaXN0ZW5jZU1hbmFnZXIgcGVyc2lzdGVuY2VN\nZ3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJzY3JpcHRpb25N\nYW5hZ2VyIHN1Yk1nciwgU2VydmVyQ29uZmlndXJhdGlvbiBjZmcpIHsKICAg\nICAgICBzdXBlcih0b3BpY01nciwgY2ZnKTsKICAgICAgICB0aGlzLmRlbGl2\nZXJ5TWdyID0gZGVsaXZlcnlNYW5hZ2VyOwogICAgICAgIHRoaXMucGVyc2lz\ndGVuY2VNZ3IgPSBwZXJzaXN0ZW5jZU1ncjsKICAgICAgICB0aGlzLnN1Yk1n\nciA9IHN1Yk1ncjsKICAgICAgICBzdWIyQ2hhbm5lbCA9IG5ldyBDb25jdXJy\nZW50SGFzaE1hcDxUb3BpY1N1YnNjcmliZXIsIENoYW5uZWw+KCk7CiAgICAg\nICAgY2hhbm5lbDJzdWIgPSBuZXcgQ29uY3VycmVudEhhc2hNYXA8Q2hhbm5l\nbCwgVG9waWNTdWJzY3JpYmVyPigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGNoYW5uZWxEaXNjb25uZWN0ZWQoQ2hhbm5lbCBjaGFubmVsKSB7CiAgICAg\nICAgLy8gRXZpbHMgb2Ygc3luY2hyb25pemVkIHByb2dyYW1taW5nOiB0aGVy\nZSBpcyBhIHJhY2UgYmV0d2VlbiBhIGNoYW5uZWwKICAgICAgICAvLyBnZXR0\naW5nIGRpc2Nvbm5lY3RlZCwgYW5kIHVzIGFkZGluZyBpdCB0byB0aGUgbWFw\ncyB3aGVuIGEgc3Vic2NyaWJlCiAgICAgICAgLy8gc3VjY2VlZHMKICAgICAg\nICBzeW5jaHJvbml6ZWQgKGNoYW5uZWwpIHsKICAgICAgICAgICAgVG9waWNT\ndWJzY3JpYmVyIHRvcGljU3ViID0gY2hhbm5lbDJzdWIucmVtb3ZlKGNoYW5u\nZWwpOwogICAgICAgICAgICBpZiAodG9waWNTdWIgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgc3ViMkNoYW5uZWwucmVtb3ZlKHRvcGljU3ViKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyB2b2lkIGhhbmRsZVJlcXVlc3RBdE93bmVyKGZpbmFsIFB1YlN1\nYlJlcXVlc3QgcmVxdWVzdCwgZmluYWwgQ2hhbm5lbCBjaGFubmVsKSB7Cgog\nICAgICAgIGlmICghcmVxdWVzdC5oYXNTdWJzY3JpYmVSZXF1ZXN0KCkpIHsK\nICAgICAgICAgICAgVW1icmVsbGFIYW5kbGVyLnNlbmRFcnJvclJlc3BvbnNl\nVG9NYWxmb3JtZWRSZXF1ZXN0KGNoYW5uZWwsIHJlcXVlc3QuZ2V0VHhuSWQo\nKSwKICAgICAgICAgICAgICAgICAgICAiTWlzc2luZyBzdWJzY3JpYmUgcmVx\ndWVzdCBkYXRhIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9Cgog\nICAgICAgIGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMgPSByZXF1ZXN0LmdldFRv\ncGljKCk7CgogICAgICAgIE1lc3NhZ2VTZXFJZCBzZXFJZDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBzZXFJZCA9IHBlcnNpc3RlbmNlTWdyLmdldEN1\ncnJlbnRTZXFJZEZvclRvcGljKHRvcGljKTsKICAgICAgICB9IGNhdGNoIChT\nZXJ2ZXJOb3RSZXNwb25zaWJsZUZvclRvcGljRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgY2hhbm5lbC53cml0ZShQdWJTdWJSZXNwb25zZVV0aWxzLmdl\ndFJlc3BvbnNlRm9yRXhjZXB0aW9uKGUsIHJlcXVlc3QuZ2V0VHhuSWQoKSkp\nLmFkZExpc3RlbmVyKAogICAgICAgICAgICAgICAgQ2hhbm5lbEZ1dHVyZUxp\nc3RlbmVyLkNMT1NFKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0K\nCiAgICAgICAgZmluYWwgU3Vic2NyaWJlUmVxdWVzdCBzdWJSZXF1ZXN0ID0g\ncmVxdWVzdC5nZXRTdWJzY3JpYmVSZXF1ZXN0KCk7CiAgICAgICAgZmluYWwg\nQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQgPSBzdWJSZXF1ZXN0LmdldFN1YnNj\ncmliZXJJZCgpOwoKICAgICAgICBNZXNzYWdlU2VxSWQgbGFzdFNlcUlkUHVi\nbGlzaGVkID0gTWVzc2FnZVNlcUlkLm5ld0J1aWxkZXIoc2VxSWQpLnNldExv\nY2FsQ29tcG9uZW50KHNlcUlkLmdldExvY2FsQ29tcG9uZW50KCkpLmJ1aWxk\nKCk7CgogICAgICAgIHN1Yk1nci5zZXJ2ZVN1YnNjcmliZVJlcXVlc3QodG9w\naWMsIHN1YlJlcXVlc3QsIGxhc3RTZXFJZFB1Ymxpc2hlZCwgbmV3IENhbGxi\nYWNrPE1lc3NhZ2VTZXFJZD4oKSB7CgogICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVj\ndCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAg\nICAgICAgIGNoYW5uZWwud3JpdGUoUHViU3ViUmVzcG9uc2VVdGlscy5nZXRS\nZXNwb25zZUZvckV4Y2VwdGlvbihleGNlcHRpb24sIHJlcXVlc3QuZ2V0VHhu\nSWQoKSkpLmFkZExpc3RlbmVyKAogICAgICAgICAgICAgICAgICAgIENoYW5u\nZWxGdXR1cmVMaXN0ZW5lci5DTE9TRSk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBNZXNzYWdlU2VxSWQgcmVzdWx0\nT2ZPcGVyYXRpb24pIHsKCiAgICAgICAgICAgICAgICBUb3BpY1N1YnNjcmli\nZXIgdG9waWNTdWIgPSBuZXcgVG9waWNTdWJzY3JpYmVyKHRvcGljLCBzdWJz\nY3JpYmVySWQpOwoKICAgICAgICAgICAgICAgIC8vIHJhY2Ugd2l0aCBjaGFu\nbmVsIGdldHRpbmcgZGlzY29ubmVjdGVkIHdoaWxlIHdlIGFyZSBhZGRpbmcg\naXQKICAgICAgICAgICAgICAgIC8vIHRvIHRoZSAyIG1hcHMKICAgICAgICAg\nICAgICAgIHN5bmNocm9uaXplZCAoY2hhbm5lbCkgewogICAgICAgICAgICAg\nICAgICAgIGlmICghY2hhbm5lbC5pc0Nvbm5lY3RlZCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIC8vIGNoYW5uZWwgZ290IGRpc2Nvbm5lY3RlZCB3\naGlsZSB3ZSB3ZXJlIHByb2Nlc3NpbmcgdGhlCiAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIHN1YnNjcmliZSByZXF1ZXN0LAogICAgICAgICAgICAgICAg\nICAgICAgICAvLyBub3RoaW5nIG11Y2ggd2UgY2FuIGRvIGluIHRoaXMgY2Fz\nZQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBz\ndWIyQ2hhbm5lbC5wdXRJZkFic2VudCh0b3BpY1N1YiwgY2hhbm5lbCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUgd2FzIGFub3RoZXIg\nY2hhbm5lbCBtYXBwZWQgdG8gdGhpcyBzdWIKICAgICAgICAgICAgICAgICAg\nICAgICAgUHViU3ViRXhjZXB0aW9uIHBzZSA9IG5ldyBQdWJTdWJFeGNlcHRp\nb24uVG9waWNCdXN5RXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgInN1YnNjcmlwdGlvbiBmb3IgdGhpcyB0b3BpYywgc3Vic2NyaWJl\ncklkIGlzIGFscmVhZHkgYmVpbmcgc2VydmVkIG9uIGEgZGlmZmVyZW50IGNo\nYW5uZWwiKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbC53cml0\nZShQdWJTdWJSZXNwb25zZVV0aWxzLmdldFJlc3BvbnNlRm9yRXhjZXB0aW9u\nKHBzZSwgcmVxdWVzdC5nZXRUeG5JZCgpKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgLmFkZExpc3RlbmVyKENoYW5uZWxGdXR1cmVMaXN0ZW5lci5DTE9T\nRSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAv\nLyBjaGFubmVsMnN1YiBpcyBqdXN0IGEgY2FjaGUsIHNvIHdlIGNhbiBhZGQg\ndG8gaXQKICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2l0aG91dCBzeW5j\naHJvbml6YXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbDJz\ndWIucHV0KGNoYW5uZWwsIHRvcGljU3ViKTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBGaXJz\ndCB3cml0ZSBzdWNjZXNzIGFuZCB0aGVuIHRlbGwgdGhlIGRlbGl2ZXJ5IG1h\nbmFnZXIsCiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgdGhlIGZpcnN0\nIG1lc3NhZ2UgbWlnaHQgZ28gb3V0IGJlZm9yZSB0aGUgcmVzcG9uc2UKICAg\nICAgICAgICAgICAgIC8vIHRvIHRoZSBzdWJzY3JpYmUKICAgICAgICAgICAg\nICAgIGNoYW5uZWwud3JpdGUoUHViU3ViUmVzcG9uc2VVdGlscy5nZXRTdWNj\nZXNzUmVzcG9uc2UocmVxdWVzdC5nZXRUeG5JZCgpKSk7CgogICAgICAgICAg\nICAgICAgLy8gd2FudCB0byBzdGFydCAxIGFoZWFkIG9mIHRoZSBjb25zdW1l\nIHB0cgogICAgICAgICAgICAgICAgTWVzc2FnZVNlcUlkIHNlcUlkVG9TdGFy\ndEZyb20gPSBNZXNzYWdlU2VxSWQubmV3QnVpbGRlcihyZXN1bHRPZk9wZXJh\ndGlvbikuc2V0TG9jYWxDb21wb25lbnQoCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRPZk9wZXJh\ndGlvbi5nZXRMb2NhbENvbXBvbmVudCgpICsgMSkuYnVpbGQoKTsKICAgICAg\nICAgICAgICAgIGRlbGl2ZXJ5TWdyLnN0YXJ0U2VydmluZ1N1YnNjcmlwdGlv\nbih0b3BpYywgc3Vic2NyaWJlcklkLCBzZXFJZFRvU3RhcnRGcm9tLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIG5ldyBDaGFubmVsRW5kUG9pbnQoY2hhbm5lbCksIFRydWVGaWx0ZXIu\naW5zdGFuY2UoKSwgU3Vic2NyaXB0aW9uU3RhdGVVdGlscwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5p\nc0h1YlN1YnNjcmliZXIoc3ViUmVxdWVzdC5nZXRTdWJzY3JpYmVySWQoKSkp\nOwogICAgICAgICAgICB9CiAgICAgICAgfSwgbnVsbCk7CgogICAgfQoKfQo=\n","encoding":"base64"}

