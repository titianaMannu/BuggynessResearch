{"sha":"02615218d0e0c7effa4865ae5332cb5c9d192934","node_id":"MDQ6QmxvYjE1NzU5NTY6MDI2MTUyMThkMGUwYzdlZmZhNDg2NWFlNTMzMmNiNWM5ZDE5MjkzNA==","size":26715,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/02615218d0e0c7effa4865ae5332cb5c9d192934","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFz\naFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEu\ndXRpbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0\nIGphdmEudXRpbC5RdWV1ZTsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuU29ydGVkTWFwOwppbXBvcnQgamF2YS51dGlsLlNvcnRl\nZFNldDsKaW1wb3J0IGphdmEudXRpbC5UcmVlTWFwOwppbXBvcnQgamF2YS51\ndGlsLlRyZWVTZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5CbG9j\na2luZ1F1ZXVlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuTGlua2Vk\nQmxvY2tpbmdRdWV1ZTsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgY29tLmdvb2ds\nZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbi5TZXJ2ZXJO\nb3RSZXNwb25zaWJsZUZvclRvcGljRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3Rv\nY29sLk1lc3NhZ2VTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvZXh0ZW5zaW9ucy5NZXNzYWdlSWRVdGlsczsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uVW5leHBl\nY3RlZEVycm9yOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxs\nYmFjazsKCnB1YmxpYyBjbGFzcyBSZWFkQWhlYWRDYWNoZSBpbXBsZW1lbnRz\nIFBlcnNpc3RlbmNlTWFuYWdlciwgUnVubmFibGUgewoKICAgIHN0YXRpYyBM\nb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoUmVhZEFo\nZWFkQ2FjaGUuY2xhc3MpOwoKICAgIHByb3RlY3RlZCBpbnRlcmZhY2UgQ2Fj\naGVSZXF1ZXN0IHsKICAgICAgICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVxdWVz\ndCgpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHVuZGVybHlpbmcgcGVy\nc2lzdGVuY2UgbWFuYWdlciB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgcGVyc2lz\ndGVuY2UgYW5kCiAgICAgKiBzY2FubmluZyBiZWxvdyB0aGUgY2FjaGUKICAg\nICAqLwogICAgcHJvdGVjdGVkIFBlcnNpc3RlbmNlTWFuYWdlcldpdGhSYW5n\nZVNjYW4gcmVhbFBlcnNpc3RlbmNlTWFuYWdlcjsKCiAgICAvKioKICAgICAq\nIFRoZSBzdHJ1Y3R1cmUgZm9yIHRoZSBjYWNoZQogICAgICovCiAgICBwcm90\nZWN0ZWQgTWFwPENhY2hlS2V5LCBDYWNoZVZhbHVlPiBjYWNoZSA9IG5ldyBI\nYXNoTWFwPENhY2hlS2V5LCBDYWNoZVZhbHVlPigpOwoKICAgIC8qKgogICAg\nICogVG8gc2ltcGxpZnkgc3luY2hyb25pemF0aW9uLCB0aGUgY2FjaGUgd2ls\nbCBiZSBtYWludGFpbmVkIGJ5IGEgc2luZ2xlCiAgICAgKiBjYWNoZSBtYWlu\ndGFpbmVyIHRocmVhZC4gVGhpcyBpcyB0aGUgcXVldWUgdGhhdCB3aWxsIGhv\nbGQgcmVxdWVzdHMgdGhhdAogICAgICogbmVlZCB0byBiZSBzZXJ2ZWQgYnkg\ndGhpcyB0aHJlYWQKICAgICAqLwogICAgcHJvdGVjdGVkIEJsb2NraW5nUXVl\ndWU8Q2FjaGVSZXF1ZXN0PiByZXF1ZXN0UXVldWUgPSBuZXcgTGlua2VkQmxv\nY2tpbmdRdWV1ZTxDYWNoZVJlcXVlc3Q+KCk7CgogICAgLyoqCiAgICAgKiBX\nZSB3YW50IHRvIGtlZXAgdHJhY2sgb2Ygd2hlbiBlbnRyaWVzIHdlcmUgYWRk\nZWQgaW4gdGhlIGNhY2hlLCBzbyB0aGF0IHdlCiAgICAgKiBjYW4gcmVtb3Zl\nIHRoZW0gaW4gYSBGSUZPIGZhc2hpb24KICAgICAqLwogICAgcHJvdGVjdGVk\nIFNvcnRlZE1hcDxMb25nLCBTZXQ8Q2FjaGVLZXk+PiB0aW1lSW5kZXhPZkFk\nZGl0aW9uID0gbmV3IFRyZWVNYXA8TG9uZywgU2V0PENhY2hlS2V5Pj4oKTsK\nCiAgICAvKioKICAgICAqIFdlIGFsc28gd2FudCB0byB0cmFjayB0aGUgZW50\ncmllcyBpbiBzZXEtaWQgb3JkZXIgc28gdGhhdCB3ZSBjYW4gY2xlYW4gdXAK\nICAgICAqIGVudHJpZXMgYWZ0ZXIgdGhlIGxhc3Qgc3Vic2NyaWJlcgogICAg\nICovCiAgICBwcm90ZWN0ZWQgTWFwPEJ5dGVTdHJpbmcsIFNvcnRlZFNldDxM\nb25nPj4gb3JkZXJlZEluZGV4T25TZXFJZCA9IG5ldyBIYXNoTWFwPEJ5dGVT\ndHJpbmcsIFNvcnRlZFNldDxMb25nPj4oKTsKCiAgICAvKioKICAgICAqIFdl\nIG1haW50YWluIGFuIGVzdGltYXRlIG9mIHRoZSBjdXJyZW50IHNpemUgb2Yg\ndGhlIGNhY2hlLCBzbyB0aGF0IHdlIGtub3cKICAgICAqIHdoZW4gdG8gZXZp\nY3QgZW50cmllcy4KICAgICAqLwogICAgcHJvdGVjdGVkIGxvbmcgcHJlc2Vu\ndENhY2hlU2l6ZSA9IDA7CgogICAgLyoqCiAgICAgKiBPbmUgaW5zdGFuY2Ug\nb2YgYSBjYWxsYmFjayB0aGF0IHdlIHdpbGwgcGFzcyB0byB0aGUgdW5kZXJs\neWluZwogICAgICogcGVyc2lzdGVuY2UgbWFuYWdlciB3aGVuIGFza2luZyBp\ndCB0byBwZXJzaXN0IG1lc3NhZ2VzCiAgICAgKi8KICAgIHByb3RlY3RlZCBQ\nZXJzaXN0Q2FsbGJhY2sgcGVyc2lzdENhbGxiYWNrSW5zdGFuY2UgPSBuZXcg\nUGVyc2lzdENhbGxiYWNrKCk7CgogICAgLyoqCiAgICAgKiAyIGtpbmRzIG9m\nIGV4Y2VwdGlvbnMgdGhhdCB3ZSB3aWxsIHVzZSB0byBzaWduYWwgZXJyb3Ig\nZnJvbSByZWFkYWhlYWQKICAgICAqLwogICAgcHJvdGVjdGVkIE5vU3VjaFNl\ncUlkRXhjZXB0aW9uIG5vU3VjaFNlcUlkRXhjZXB0aW9uSW5zdGFuY2UgPSBu\nZXcgTm9TdWNoU2VxSWRFeGNlcHRpb24oKTsKICAgIHByb3RlY3RlZCBSZWFk\nQWhlYWRFeGNlcHRpb24gcmVhZEFoZWFkRXhjZXB0aW9uSW5zdGFuY2UgPSBu\nZXcgUmVhZEFoZWFkRXhjZXB0aW9uKCk7CgogICAgcHJvdGVjdGVkIFNlcnZl\nckNvbmZpZ3VyYXRpb24gY2ZnOwogICAgcHJvdGVjdGVkIFRocmVhZCBjYWNo\nZVRocmVhZDsKICAgIC8vIEJvb2xlYW4gaW5kaWNhdGluZyBpZiB0aGlzIHRo\ncmVhZCBzaG91bGQgY29udGludWUgcnVubmluZy4gVGhpcyBpcyB1c2VkCiAg\nICAvLyB3aGVuIHdlIHdhbnQgdG8gc3RvcCB0aGUgdGhyZWFkIGR1cmluZyBh\nIFB1YlN1YlNlcnZlciBzaHV0ZG93bi4KICAgIHByb3RlY3RlZCBib29sZWFu\nIGtlZXBSdW5uaW5nID0gdHJ1ZTsKCiAgICAvKioKICAgICAqIENvbnN0cnVj\ndG9yLiBTdGFydHMgdGhlIGNhY2hlIG1haW50YWluZXIgdGhyZWFkCiAgICAg\nKgogICAgICogQHBhcmFtIHJlYWxQZXJzaXN0ZW5jZU1hbmFnZXIKICAgICAq\nLwogICAgcHVibGljIFJlYWRBaGVhZENhY2hlKFBlcnNpc3RlbmNlTWFuYWdl\ncldpdGhSYW5nZVNjYW4gcmVhbFBlcnNpc3RlbmNlTWFuYWdlciwgU2VydmVy\nQ29uZmlndXJhdGlvbiBjZmcpIHsKICAgICAgICB0aGlzLnJlYWxQZXJzaXN0\nZW5jZU1hbmFnZXIgPSByZWFsUGVyc2lzdGVuY2VNYW5hZ2VyOwogICAgICAg\nIHRoaXMuY2ZnID0gY2ZnOwogICAgICAgIGNhY2hlVGhyZWFkID0gbmV3IFRo\ncmVhZCh0aGlzLCAiQ2FjaGVUaHJlYWQiKTsKICAgIH0KCiAgICBwdWJsaWMg\nUmVhZEFoZWFkQ2FjaGUgc3RhcnQoKSB7CiAgICAgICAgY2FjaGVUaHJlYWQu\nc3RhcnQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICAvKioK\nICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICogTWV0\naG9kcyBvZiB7QGxpbmsgUGVyc2lzdGVuY2VNYW5hZ2VyfSB0aGF0IHdlIHdp\nbGwgcGFzcyBzdHJhaWdodCBkb3duIHRvCiAgICAgKiB0aGUgcmVhbCBwZXJz\naXN0ZW5jZSBtYW5hZ2VyLgogICAgICovCgogICAgcHVibGljIGxvbmcgZ2V0\nU2VxSWRBZnRlclNraXBwaW5nKEJ5dGVTdHJpbmcgdG9waWMsIGxvbmcgc2Vx\nSWQsIGludCBza2lwQW1vdW50KSB7CiAgICAgICAgcmV0dXJuIHJlYWxQZXJz\naXN0ZW5jZU1hbmFnZXIuZ2V0U2VxSWRBZnRlclNraXBwaW5nKHRvcGljLCBz\nZXFJZCwgc2tpcEFtb3VudCk7CiAgICB9CgogICAgcHVibGljIE1lc3NhZ2VT\nZXFJZCBnZXRDdXJyZW50U2VxSWRGb3JUb3BpYyhCeXRlU3RyaW5nIHRvcGlj\nKSB0aHJvd3MgU2VydmVyTm90UmVzcG9uc2libGVGb3JUb3BpY0V4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHJlYWxQZXJzaXN0ZW5jZU1hbmFnZXIuZ2V0\nQ3VycmVudFNlcUlkRm9yVG9waWModG9waWMpOwogICAgfQoKICAgIC8qKgog\nICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgKiBPdGhl\nciBtZXRob2RzIG9mIHtAbGluayBQZXJzaXN0ZW5jZU1hbmFnZXJ9IHRoYXQg\ndGhlIGNhY2hlIG5lZWRzIHRvIHRha2UKICAgICAqIHNvbWUgYWN0aW9uIG9u\nLgogICAgICoKICAgICAqIDEuIFBlcnNpc3Q6IFdlIHBhc3MgaXQgdGhyb3Vn\naCB0byB0aGUgcmVhbCBwZXJzaXN0ZW5jZSBtYW5hZ2VyIGJ1dCBpbnNlcnQK\nICAgICAqIG91ciBjYWxsYmFjayBvbiB0aGUgcmV0dXJuIHBhdGgKICAgICAq\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHBlcnNpc3RNZXNzYWdlKFBlcnNp\nc3RSZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAgICAvLyBtYWtlIGEgbmV3IFBl\ncnNpc3RSZXF1ZXN0IG9iamVjdCBzbyB0aGF0IHdlIGNhbiBpbnNlcnQgb3Vy\nIG93bgogICAgICAgIC8vIGNhbGxiYWNrIGluIHRoZSBtaWRkbGUuIEFzc2ln\nbiB0aGUgb3JpZ2luYWwgcmVxdWVzdCBhcyB0aGUgY29udGV4dAogICAgICAg\nIC8vIGZvciB0aGUgY2FsbGJhY2suCgogICAgICAgIFBlcnNpc3RSZXF1ZXN0\nIG5ld1JlcXVlc3QgPSBuZXcgUGVyc2lzdFJlcXVlc3QocmVxdWVzdC5nZXRU\nb3BpYygpLCByZXF1ZXN0LmdldE1lc3NhZ2UoKSwKICAgICAgICAgICAgICAg\nIHBlcnNpc3RDYWxsYmFja0luc3RhbmNlLCByZXF1ZXN0KTsKICAgICAgICBy\nZWFsUGVyc2lzdGVuY2VNYW5hZ2VyLnBlcnNpc3RNZXNzYWdlKG5ld1JlcXVl\nc3QpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGNhbGxiYWNrIHRoYXQg\nd2UgaW5zZXJ0IG9uIHRoZSBwZXJzaXN0IHJlcXVlc3QgcmV0dXJuIHBhdGgu\nIFRoZQogICAgICogY2FsbGJhY2sgc2ltcGx5IGZvcm1zIGEge0BsaW5rIFBl\ncnNpc3RSZXNwb25zZX0gb2JqZWN0IGFuZCBpbnNlcnRzIGl0IGluCiAgICAg\nKiB0aGUgcmVxdWVzdCBxdWV1ZSB0byBiZSBoYW5kbGVkIHNlcmlhbGx5IGJ5\nIHRoZSBjYWNoZSBtYWludGFpbmVyIHRocmVhZC4KICAgICAqCiAgICAgKi8K\nICAgIHB1YmxpYyBjbGFzcyBQZXJzaXN0Q2FsbGJhY2sgaW1wbGVtZW50cyBD\nYWxsYmFjazxMb25nPiB7CgogICAgICAgIC8qKgogICAgICAgICAqIEluIGNh\nc2UgdGhlcmUgaXMgYSBmYWlsdXJlIGluIHBlcnNpc3RpbmcsIGp1c3QgcGFz\ncyBpdCB0byB0aGUKICAgICAgICAgKiBvcmlnaW5hbCBjYWxsYmFjawogICAg\nICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChP\nYmplY3QgY3R4LCBQdWJTdWJFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAg\nICAgICAgIFBlcnNpc3RSZXF1ZXN0IG9yaWdpbmFsUmVxdWVzdCA9IChQZXJz\naXN0UmVxdWVzdCkgY3R4OwogICAgICAgICAgICBDYWxsYmFjazxMb25nPiBv\ncmlnaW5hbENhbGxiYWNrID0gb3JpZ2luYWxSZXF1ZXN0LmdldENhbGxiYWNr\nKCk7CiAgICAgICAgICAgIE9iamVjdCBvcmlnaW5hbENvbnRleHQgPSBvcmln\naW5hbFJlcXVlc3QuZ2V0Q3R4KCk7CiAgICAgICAgICAgIG9yaWdpbmFsQ2Fs\nbGJhY2sub3BlcmF0aW9uRmFpbGVkKG9yaWdpbmFsQ29udGV4dCwgZXhjZXB0\naW9uKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFdoZW4g\ndGhlIHBlcnNpc3QgZmluaXNoZXMsIHdlIGZpcnN0IG5vdGlmeSB0aGUgb3Jp\nZ2luYWwgY2FsbGJhY2sgb2YKICAgICAgICAgKiBzdWNjZXNzLCBhbmQgdGhl\nbiBvcHBvcnR1bmlzdGljYWxseSB0cmVhdCB0aGUgbWVzc2FnZSBhcyBpZiBp\ndCBqdXN0CiAgICAgICAgICogY2FtZSBpbiB0aHJvdWdoIGEgc2NhbgogICAg\nICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVk\nKE9iamVjdCBjdHgsIExvbmcgcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAg\nICAgICAgUGVyc2lzdFJlcXVlc3Qgb3JpZ2luYWxSZXF1ZXN0ID0gKFBlcnNp\nc3RSZXF1ZXN0KSBjdHg7CgogICAgICAgICAgICAvLyBMZXRzIGNhbGwgdGhl\nIG9yaWdpbmFsIGNhbGxiYWNrIGZpcnN0IHNvIHRoYXQgdGhlIHB1Ymxpc2hl\nciBjYW4KICAgICAgICAgICAgLy8gaGVhciBzdWNjZXNzCiAgICAgICAgICAg\nIG9yaWdpbmFsUmVxdWVzdC5nZXRDYWxsYmFjaygpLm9wZXJhdGlvbkZpbmlz\naGVkKG9yaWdpbmFsUmVxdWVzdC5nZXRDdHgoKSwgcmVzdWx0T2ZPcGVyYXRp\nb24pOwoKICAgICAgICAgICAgLy8gT3JpZ2luYWwgbWVzc2FnZSB0aGF0IHdh\ncyBwZXJzaXN0ZWQgZGlkbid0IGhhdmUgdGhlIGxvY2FsIHNlcS1pZC4KICAg\nICAgICAgICAgLy8gTGV0cyBhZGQgdGhhdCBpbgogICAgICAgICAgICBNZXNz\nYWdlIG1lc3NhZ2VXaXRoTG9jYWxTZXFJZCA9IE1lc3NhZ2VJZFV0aWxzLm1l\ncmdlTG9jYWxTZXFJZChvcmlnaW5hbFJlcXVlc3QuZ2V0TWVzc2FnZSgpLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl\nc3VsdE9mT3BlcmF0aW9uKTsKCiAgICAgICAgICAgIC8vIE5vdyBlbnF1ZXVl\nIGEgcmVxdWVzdCB0byBhZGQgdGhpcyBuZXdseSBwZXJzaXN0ZWQgbWVzc2Fn\nZSB0byBvdXIKICAgICAgICAgICAgLy8gY2FjaGUKICAgICAgICAgICAgQ2Fj\naGVLZXkgY2FjaGVLZXkgPSBuZXcgQ2FjaGVLZXkob3JpZ2luYWxSZXF1ZXN0\nLmdldFRvcGljKCksIHJlc3VsdE9mT3BlcmF0aW9uKTsKCiAgICAgICAgICAg\nIGVucXVldWVXaXRob3V0RmFpbHVyZShuZXcgU2NhblJlc3BvbnNlKGNhY2hl\nS2V5LCBtZXNzYWdlV2l0aExvY2FsU2VxSWQpKTsKICAgICAgICB9CgogICAg\nfQoKICAgIC8qKgogICAgICogVG9vIGNvbXBsaWNhdGVkIHRvIGRlYWwgd2l0\naCBlbnF1ZXVlIGZhaWx1cmVzIGZyb20gdGhlIGNvbnRleHQgb2Ygb3VyCiAg\nICAgKiBjYWxsYmFja3MuIEl0cyBqdXN0IHNpbXBsZXIgdG8gcXVpdCBhbmQg\ncmVzdGFydCBhZnJlc2guIE1vcmVvdmVyLCB0aGlzCiAgICAgKiBzaG91bGQg\nbm90IGhhcHBlbiBhcyB0aGUgcmVxdWVzdCBxdWV1ZSBmb3IgdGhlIGNhY2hl\nIG1haW50YWluZXIgaXMKICAgICAqIHVuYm91bmRlZC4KICAgICAqCiAgICAg\nKiBAcGFyYW0gb2JqCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGVucXVl\ndWVXaXRob3V0RmFpbHVyZShDYWNoZVJlcXVlc3Qgb2JqKSB7CiAgICAgICAg\naWYgKCFyZXF1ZXN0UXVldWUub2ZmZXIob2JqKSkgewogICAgICAgICAgICB0\naHJvdyBuZXcgVW5leHBlY3RlZEVycm9yKCJDb3VsZCBub3QgZW5xdWV1ZSBv\nYmplY3Q6ICIgKyBvYmoudG9TdHJpbmcoKQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiB0byBjYWNoZSByZXF1ZXN0IHF1ZXVl\nLiBFeGl0aW5nLiIpOwoKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBbm90aGVyIG1ldGhvZCBmcm9tIHtAbGluayBQZXJzaXN0ZW5jZU1hbmFn\nZXJ9LgogICAgICoKICAgICAqIDIuIFNjYW4gLSBTaW5jZSB0aGUgc2NhbiBu\nZWVkcyB0byB0b3VjaCB0aGUgY2FjaGUsIHdlIHdpbGwganVzdCBlbnF1ZXVl\nCiAgICAgKiB0aGUgc2NhbiByZXF1ZXN0IGFuZCBsZXQgdGhlIGNhY2hlIG1h\naW50YWluZXIgdGhyZWFkIGhhbmRsZSBpdC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2NhblNpbmdsZU1lc3NhZ2UoU2NhblJlcXVlc3QgcmVxdWVzdCkg\newogICAgICAgIC8vIExldCB0aGUgc2NhbiByZXF1ZXN0cyBiZSBzZXJpYWxp\nemVkIHRocm91Z2ggdGhlIHF1ZXVlCiAgICAgICAgZW5xdWV1ZVdpdGhvdXRG\nYWlsdXJlKG5ldyBTY2FuUmVxdWVzdFdyYXBwZXIocmVxdWVzdCkpOwogICAg\nfQoKICAgIC8qKgogICAgICogQW5vdGhlciBtZXRob2QgZnJvbSB7QGxpbmsg\nUGVyc2lzdGVuY2VNYW5hZ2VyfS4KICAgICAqCiAgICAgKiAzLiBFbnF1ZXVl\nIHRoZSByZXF1ZXN0IHNvIHRoYXQgdGhlIGNhY2hlIG1haW50YWluZXIgdGhy\nZWFkIGNhbiBkZWxldGUgYWxsCiAgICAgKiBtZXNzYWdlLWlkcyBvbGRlciB0\naGFuIHRoZSBvbmUgc3BlY2lmaWVkCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGRlbGl2ZXJlZFVudGlsKEJ5dGVTdHJpbmcgdG9waWMsIExvbmcgc2VxSWQp\nIHsKICAgICAgICBlbnF1ZXVlV2l0aG91dEZhaWx1cmUobmV3IERlbGl2ZXJl\nZFVudGlsKHRvcGljLCBzZXFJZCkpOwogICAgfQoKICAgIC8qKgogICAgICog\nQW5vdGhlciBtZXRob2QgZnJvbSB7QGxpbmsgUGVyc2lzdGVuY2VNYW5hZ2Vy\nfS4KICAgICAqCiAgICAgKiBTaW5jZSB0aGlzIGlzIGEgY2FjaGUgbGF5ZXIg\nb24gdG9wIG9mIGFuIHVuZGVybHlpbmcgcGVyc2lzdGVuY2UgbWFuYWdlciwK\nICAgICAqIHdlIGNhbiBqdXN0IGNhbGwgdGhlIGNvbnN1bWVkVW50aWwgbWV0\naG9kIHRoZXJlLiBUaGUgbWVzc2FnZXMgb2xkZXIgdGhhbgogICAgICogdGhl\nIGxhdGVzdCBvbmUgcGFzc2VkIGhlcmUgd29uJ3QgYmUgYWNjZXNzZWQgYW55\nbW9yZSBzbyB0aGV5IHNob3VsZCBqdXN0CiAgICAgKiBnZXQgYWdlZCBvdXQg\nb2YgdGhlIGNhY2hlIGV2ZW50dWFsbHkuIEZvciBub3csIHRoZXJlIGlzIG5v\nIG5lZWQgdG8KICAgICAqIHByb2FjdGl2ZWx5IHJlbW92ZSB0aG9zZSBlbnRy\naWVzIGZyb20gdGhlIGNhY2hlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBj\nb25zdW1lZFVudGlsKEJ5dGVTdHJpbmcgdG9waWMsIExvbmcgc2VxSWQpIHsK\nICAgICAgICByZWFsUGVyc2lzdGVuY2VNYW5hZ2VyLmNvbnN1bWVkVW50aWwo\ndG9waWMsIHNlcUlkKTsKICAgIH0KCiAgICAvKioKICAgICAqID09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PQogICAgICogQkVHSU5OSU5HIE9GIENPREUg\nRk9SIFRIRSBDQUNIRSBNQUlOVEFJTkVSIFRIUkVBRAogICAgICoKICAgICAq\nIDEuIFRoZSBydW4gbWV0aG9kLiBJdCBzaW1wbHkgZGVxdWV1ZXMgZnJvbSB0\naGUgcmVxdWVzdCBxdWV1ZSwgY2hlY2tzIHRoZQogICAgICogdHlwZSBvZiBv\nYmplY3QgYW5kIGFjdHMgYWNjb3JkaW5nbHkKICAgICAqLwogICAgcHVibGlj\nIHZvaWQgcnVuKCkgewogICAgICAgIHdoaWxlIChrZWVwUnVubmluZykgewog\nICAgICAgICAgICBDYWNoZVJlcXVlc3Qgb2JqOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgb2JqID0gcmVxdWVzdFF1ZXVlLnRha2UoKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5pbnRl\ncnJ1cHQoKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBvYmoucGVyZm9ybVJlcXVlc3QoKTsKICAgICAgICB9\nCgogICAgfQoKICAgIC8qKgogICAgICogU3RvcCBtZXRob2Qgd2hpY2ggd2ls\nbCBlbnF1ZXVlIGEgU2h1dGRvd25DYWNoZVJlcXVlc3QuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHN0b3AoKSB7CiAgICAgICAgZW5xdWV1ZVdpdGhvdXRG\nYWlsdXJlKG5ldyBTaHV0ZG93bkNhY2hlUmVxdWVzdCgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSByZWFkYWhlYWQgcG9saWN5IGlzIHNpbXBsZTog\nV2UgY2hlY2sgaWYgYW4gZW50cnkgYWxyZWFkeSBleGlzdHMgZm9yCiAgICAg\nKiB0aGUgbWVzc2FnZSBiZWluZyByZXF1ZXN0ZWQuIElmIGFuIGVudHJ5IGV4\naXN0cywgaXQgbWVhbnMgdGhhdCBlaXRoZXIKICAgICAqIHRoYXQgbWVzc2Fn\nZSBpcyBhbHJlYWR5IGluIHRoZSBjYWNoZSwgb3IgYSByZWFkIGZvciB0aGF0\nIG1lc3NhZ2UgaXMKICAgICAqIG91dHN0YW5kaW5nLiBJbiB0aGF0IGNhc2Us\nIHdlIGxvb2sgYSBsaXR0bGUgYWhlYWQgKGJ5IHJlYWRBaGVhZENvdW50LzIp\nCiAgICAgKiBhbmQgaXNzdWUgYSByYW5nZSByZWFkIG9mIHJlYWRBaGVhZENv\ndW50LzIgbWVzc2FnZXMuIFRoZSBpZGVhIGlzIHRvCiAgICAgKiBlbnN1cmUg\ndGhhdCB0aGUgbmV4dCByZWFkQWhlYWRDb3VudCBtZXNzYWdlcyBhcmUgYWx3\nYXlzIGF2YWlsYWJsZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSByYW5n\nZSBzY2FuIHRoYXQgc2hvdWxkIGJlIGlzc3VlZCBmb3IgcmVhZCBhaGVhZAog\nICAgICovCiAgICBwcm90ZWN0ZWQgUmFuZ2VTY2FuUmVxdWVzdCBkb1JlYWRB\naGVhZChTY2FuUmVxdWVzdCByZXF1ZXN0KSB7CiAgICAgICAgQnl0ZVN0cmlu\nZyB0b3BpYyA9IHJlcXVlc3QuZ2V0VG9waWMoKTsKICAgICAgICBMb25nIHNl\ncUlkID0gcmVxdWVzdC5nZXRTdGFydFNlcUlkKCk7CgogICAgICAgIGludCBy\nZWFkQWhlYWRDb3VudCA9IGNmZy5nZXRSZWFkQWhlYWRDb3VudCgpOwogICAg\nICAgIC8vIFRvIHByZXZlbnQgdXMgZnJvbSBnZXR0aW5nIHNjcmV3ZWQgYnkg\nYmFkIGNvbmZpZ3VyYXRpb24KICAgICAgICByZWFkQWhlYWRDb3VudCA9IE1h\ndGgubWF4KDEsIHJlYWRBaGVhZENvdW50KTsKCiAgICAgICAgUmFuZ2VTY2Fu\nUmVxdWVzdCByZWFkQWhlYWRSZXF1ZXN0ID0gZG9SZWFkQWhlYWRTdGFydGlu\nZ0Zyb20odG9waWMsIHNlcUlkLCByZWFkQWhlYWRDb3VudCk7CgogICAgICAg\nIGlmIChyZWFkQWhlYWRSZXF1ZXN0ICE9IG51bGwpIHsKICAgICAgICAgICAg\ncmV0dXJuIHJlYWRBaGVhZFJlcXVlc3Q7CiAgICAgICAgfQoKICAgICAgICAv\nLyBzdGFydCBrZXkgd2FzIGFscmVhZHkgdGhlcmUgaW4gdGhlIGNhY2hlIHNv\nIG5vIHJlYWRhaGVhZCBoYXBwZW5lZCwKICAgICAgICAvLyBsZXRzIGxvb2sg\nYSBsaXR0bGUgYmV5b25kCiAgICAgICAgc2VxSWQgPSByZWFsUGVyc2lzdGVu\nY2VNYW5hZ2VyLmdldFNlcUlkQWZ0ZXJTa2lwcGluZyh0b3BpYywgc2VxSWQs\nIHJlYWRBaGVhZENvdW50IC8gMik7CgogICAgICAgIHJlYWRBaGVhZFJlcXVl\nc3QgPSBkb1JlYWRBaGVhZFN0YXJ0aW5nRnJvbSh0b3BpYywgc2VxSWQsIHJl\nYWRBaGVhZENvdW50IC8gMik7CgogICAgICAgIHJldHVybiByZWFkQWhlYWRS\nZXF1ZXN0OwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QganVz\ndCBjaGVja3MgaWYgdGhlIHByb3ZpZGVkIHNlcS1pZCBhbHJlYWR5IGV4aXN0\ncyBpbiB0aGUKICAgICAqIGNhY2hlLiBJZiBub3QsIGEgcmFuZ2UgcmVhZCBv\nZiB0aGUgc3BlY2lmaWVkIGFtb3VudCBpcyBpc3N1ZWQuCiAgICAgKgogICAg\nICogQHBhcmFtIHRvcGljCiAgICAgKiBAcGFyYW0gc2VxSWQKICAgICAqIEBw\nYXJhbSByZWFkQWhlYWRDb3VudAogICAgICogQHJldHVybiBUaGUgcmFuZ2Ug\ncmVhZCB0aGF0IHNob3VsZCBiZSBpc3N1ZWQKICAgICAqLwogICAgcHJvdGVj\ndGVkIFJhbmdlU2NhblJlcXVlc3QgZG9SZWFkQWhlYWRTdGFydGluZ0Zyb20o\nQnl0ZVN0cmluZyB0b3BpYywgbG9uZyBzZXFJZCwgaW50IHJlYWRBaGVhZENv\ndW50KSB7CgogICAgICAgIGxvbmcgc3RhcnRTZXFJZCA9IHNlcUlkOwogICAg\nICAgIFF1ZXVlPENhY2hlS2V5PiBpbnN0YWxsZWRTdHVicyA9IG5ldyBMaW5r\nZWRMaXN0PENhY2hlS2V5PigpOwoKICAgICAgICBpbnQgaSA9IDA7CgogICAg\nICAgIGZvciAoOyBpIDwgcmVhZEFoZWFkQ291bnQ7IGkrKykgewogICAgICAg\nICAgICBDYWNoZUtleSBjYWNoZUtleSA9IG5ldyBDYWNoZUtleSh0b3BpYywg\nc2VxSWQpOwoKICAgICAgICAgICAgLy8gRXZlbiBpZiBhIHN0dWIgZXhpc3Rz\nLCBpdCBtZWFucyB0aGF0IGEgc2NhbiBmb3IgdGhhdCBpcwogICAgICAgICAg\nICAvLyBvdXRzdGFuZGluZwogICAgICAgICAgICBpZiAoY2FjaGUuY29udGFp\nbnNLZXkoY2FjaGVLZXkpKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgfQogICAgICAgICAgICBDYWNoZVZhbHVlIGNhY2hlVmFsdWUg\nPSBuZXcgQ2FjaGVWYWx1ZSgpOwogICAgICAgICAgICBjYWNoZS5wdXQoY2Fj\naGVLZXksIGNhY2hlVmFsdWUpOwoKICAgICAgICAgICAgaWYgKGxvZ2dlci5p\nc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZGVi\ndWcoIkFkZGluZyBzdHViIGZvciBzZXEtaWQ6ICIgKyBzZXFJZCArICIgdG9w\naWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgaW5zdGFsbGVkU3R1YnMuYWRkKGNhY2hlS2V5KTsKCiAg\nICAgICAgICAgIHNlcUlkID0gcmVhbFBlcnNpc3RlbmNlTWFuYWdlci5nZXRT\nZXFJZEFmdGVyU2tpcHBpbmcodG9waWMsIHNlcUlkLCAxKTsKICAgICAgICB9\nCgogICAgICAgIC8vIHNvIGhvdyBtYW55IGRpZCB3ZSBkZWNpZGUgdG8gcmVh\nZGFoZWFkCiAgICAgICAgaWYgKGkgPT0gMCkgewogICAgICAgICAgICAvLyBu\nbyByZWFkYWhlYWQsIGhlbmNlIHJldHVybiBmYWxzZQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGxvbmcgcmVhZEFoZWFk\nU2l6ZUxpbWl0ID0gY2ZnLmdldFJlYWRBaGVhZFNpemVCeXRlcygpOwogICAg\nICAgIFJlYWRBaGVhZFNjYW5DYWxsYmFjayBjYWxsYmFjayA9IG5ldyBSZWFk\nQWhlYWRTY2FuQ2FsbGJhY2soaW5zdGFsbGVkU3R1YnMsIHRvcGljKTsKICAg\nICAgICBSYW5nZVNjYW5SZXF1ZXN0IHJhbmdlU2NhblJlcXVlc3QgPSBuZXcg\nUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgc3RhcnRTZXFJZCwgaSwgcmVhZEFo\nZWFkU2l6ZUxpbWl0LCBjYWxsYmFjaywKICAgICAgICAgICAgICAgIG51bGwp\nOwoKICAgICAgICByZXR1cm4gcmFuZ2VTY2FuUmVxdWVzdDsKCiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGlzIGlzIHRoZSBjYWxsYmFjayB0aGF0IGlzIHVz\nZWQgZm9yIHRoZSByYW5nZSBzY2Fucy4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGNsYXNzIFJlYWRBaGVhZFNjYW5DYWxsYmFjayBpbXBsZW1lbnRzIFNjYW5D\nYWxsYmFjayB7CiAgICAgICAgUXVldWU8Q2FjaGVLZXk+IGluc3RhbGxlZFN0\ndWJzOwogICAgICAgIEJ5dGVTdHJpbmcgdG9waWM7CgogICAgICAgIC8qKgog\nICAgICAgICAqIENvbnN0cnVjdG9yCiAgICAgICAgICoKICAgICAgICAgKiBA\ncGFyYW0gaW5zdGFsbGVkU3R1YnMKICAgICAgICAgKiAgICAgICAgICAgIFRo\nZSBsaXN0IG9mIHN0dWJzIHRoYXQgd2VyZSBpbnN0YWxsZWQgZm9yIHRoaXMg\ncmFuZ2Ugc2NhbgogICAgICAgICAqIEBwYXJhbSB0b3BpYwogICAgICAgICAq\nLwogICAgICAgIHB1YmxpYyBSZWFkQWhlYWRTY2FuQ2FsbGJhY2soUXVldWU8\nQ2FjaGVLZXk+IGluc3RhbGxlZFN0dWJzLCBCeXRlU3RyaW5nIHRvcGljKSB7\nCiAgICAgICAgICAgIHRoaXMuaW5zdGFsbGVkU3R1YnMgPSBpbnN0YWxsZWRT\ndHViczsKICAgICAgICAgICAgdGhpcy50b3BpYyA9IHRvcGljOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgbWVzc2FnZVNjYW5uZWQoT2JqZWN0\nIGN0eCwgTWVzc2FnZSBtZXNzYWdlKSB7CgogICAgICAgICAgICAvLyBBbnkg\nbWVzc2FnZSB3ZSByZWFkIGlzIHBvdGVudGlhbGx5IHVzZWZ1bCBmb3IgdXMs\nIHNvIGxldHMgZmlyc3QKICAgICAgICAgICAgLy8gZW5xdWV1ZSBpdAogICAg\nICAgICAgICBDYWNoZUtleSBjYWNoZUtleSA9IG5ldyBDYWNoZUtleSh0b3Bp\nYywgbWVzc2FnZS5nZXRNc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCkpOwog\nICAgICAgICAgICBlbnF1ZXVlV2l0aG91dEZhaWx1cmUobmV3IFNjYW5SZXNw\nb25zZShjYWNoZUtleSwgbWVzc2FnZSkpOwoKICAgICAgICAgICAgLy8gTm93\nIGxldHMgc2VlIGlmIHRoaXMgbWVzc2FnZSBpcyB0aGUgb25lIHdlIHdlcmUg\nZXhwZWN0aW5nCiAgICAgICAgICAgIENhY2hlS2V5IGV4cGVjdGVkS2V5ID0g\naW5zdGFsbGVkU3R1YnMucGVlaygpOwoKICAgICAgICAgICAgaWYgKGV4cGVj\ndGVkS2V5ID09IG51bGwpIHsKICAgICAgICAgICAgICAgIC8vIFdhcyBub3Qg\nZXhwZWN0aW5nIGFueSBtb3JlIG1lc3NhZ2VzIHRvIGNvbWUgaW4sIGJ1dCB0\naGV5IGNhbWUKICAgICAgICAgICAgICAgIC8vIGluIHNvIHdlIHdpbGwga2Vl\ncCB0aGVtCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGlmIChleHBlY3RlZEtleS5lcXVhbHMoY2FjaGVLZXkp\nKSB7CiAgICAgICAgICAgICAgICAvLyB3aGF0IHdlIGdvdCBpcyB3aGF0IHdl\nIGV4cGVjdGVkLCBkZXF1ZXVlIGl0IHNvIHdlIGdldCB0aGUKICAgICAgICAg\nICAgICAgIC8vIG5leHQgZXhwZWN0ZWQgb25lCiAgICAgICAgICAgICAgICBp\nbnN0YWxsZWRTdHVicy5wb2xsKCk7CiAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIElmIHJlYWNoZWQgaGVy\nZSwgd2hhdCB3ZSBzY2FubmVkIHdhcyBub3Qgd2hhdCB3ZSB3ZXJlIGV4cGVj\ndGluZy4KICAgICAgICAgICAgLy8gVGhpcyBtZWFucyB0aGF0IHdlIGhhdmUg\nd3Jvbmcgc3R1YnMgaW5zdGFsbGVkIGluIHRoZSBjYWNoZS4gV2UKICAgICAg\nICAgICAgLy8gc2hvdWxkIHJlbW92ZSB0aGVtLCBzbyB0aGF0IHdob2V2ZXIg\naXMgd2FpdGluZyBvbiB0aGVtIGNhbiByZXRyeS4KICAgICAgICAgICAgLy8g\nVGhpcyBzaG91bGRuJ3QgYmUgaGFwcGVuaW5nIHVzdWFsbHkKICAgICAgICAg\nICAgbG9nZ2VyLndhcm4oIlVuZXhwZWN0ZWQgbWVzc2FnZSBzZXEtaWQ6ICIg\nKyBtZXNzYWdlLmdldE1zZ0lkKCkuZ2V0TG9jYWxDb21wb25lbnQoKSArICIg\nb24gdG9waWM6ICIKICAgICAgICAgICAgICAgICAgICAgICAgKyB0b3BpYy50\nb1N0cmluZ1V0ZjgoKSArICIgZnJvbSByZWFkYWhlYWQgc2Nhbiwgd2FzIGV4\ncGVjdGluZyBzZXEtaWQ6ICIgKyBleHBlY3RlZEtleS5zZXFJZAogICAgICAg\nICAgICAgICAgICAgICAgICArICIgdG9waWM6ICIgKyBleHBlY3RlZEtleS50\nb3BpYy50b1N0cmluZ1V0ZjgoKSArICIgaW5zdGFsbGVkU3R1YnM6ICIgKyBp\nbnN0YWxsZWRTdHVicyk7CiAgICAgICAgICAgIGVucXVldWVEZWxldGVPZlJl\nbWFpbmluZ1N0dWJzKG5vU3VjaFNlcUlkRXhjZXB0aW9uSW5zdGFuY2UpOwoK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNjYW5GYWlsZWQoT2Jq\nZWN0IGN0eCwgRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICBl\nbnF1ZXVlRGVsZXRlT2ZSZW1haW5pbmdTdHVicyhleGNlcHRpb24pOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2NhbkZpbmlzaGVkKE9iamVj\ndCBjdHgsIFJlYXNvbkZvckZpbmlzaCByZWFzb24pIHsKICAgICAgICAgICAg\nLy8gSWYgdGhlIHNjYW4gZmluaXNoZWQgYmVjYXVzZSBubyBtb3JlIG1lc3Nh\nZ2VzIGFyZSBwcmVzZW50LCBpdHMgb2sKICAgICAgICAgICAgLy8gdG8gbGVh\ndmUgdGhlIHN0dWJzIGluIHBsYWNlIGJlY2F1c2UgdGhleSB3aWxsIGdldCBm\naWxsZWQgaW4gYXMKICAgICAgICAgICAgLy8gbmV3IHB1Ymxpc2hlcyBoYXBw\nZW4uIEhvd2V2ZXIsIGlmIHRoZSBzY2FuIGZpbmlzaGVkIGR1ZSB0byBzb21l\nCiAgICAgICAgICAgIC8vIG90aGVyIHJlYXNvbiwgZS5nLiwgcmVhZCBhaGVh\nZCBzaXplIGxpbWl0IHdhcyByZWFjaGVkLCB3ZSB3YW50IHRvCiAgICAgICAg\nICAgIC8vIGRlbGV0ZSB0aGUgc3R1YnMsIHNvIHRoYXQgd2hlbiB0aGUgdGlt\nZSBjb21lcywgd2UgY2FuIHNjaGVkdWxlCiAgICAgICAgICAgIC8vIGFub3Ro\nZXIgcmVhZGFoZWFkIHJlcXVlc3QuCiAgICAgICAgICAgIGlmIChyZWFzb24g\nIT0gUmVhc29uRm9yRmluaXNoLk5PX01PUkVfTUVTU0FHRVMpIHsKICAgICAg\nICAgICAgICAgIGVucXVldWVEZWxldGVPZlJlbWFpbmluZ1N0dWJzKHJlYWRB\naGVhZEV4Y2VwdGlvbkluc3RhbmNlKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIGVucXVldWVEZWxldGVPZlJlbWFp\nbmluZ1N0dWJzKEV4Y2VwdGlvbiByZWFzb24pIHsKICAgICAgICAgICAgQ2Fj\naGVLZXkgaW5zdGFsbGVkU3R1YjsKICAgICAgICAgICAgd2hpbGUgKChpbnN0\nYWxsZWRTdHViID0gaW5zdGFsbGVkU3R1YnMucG9sbCgpKSAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBlbnF1ZXVlV2l0aG91dEZhaWx1cmUobmV3IEV4\nY2VwdGlvbk9uQ2FjaGVLZXkoaW5zdGFsbGVkU3R1YiwgcmVhc29uKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHN0\nYXRpYyBjbGFzcyBIYXNoU2V0Q2FjaGVLZXlGYWN0b3J5IGltcGxlbWVudHMg\nRmFjdG9yeTxTZXQ8Q2FjaGVLZXk+PiB7CiAgICAgICAgcHJvdGVjdGVkIHN0\nYXRpYyBIYXNoU2V0Q2FjaGVLZXlGYWN0b3J5IGluc3RhbmNlID0gbmV3IEhh\nc2hTZXRDYWNoZUtleUZhY3RvcnkoKTsKCiAgICAgICAgcHVibGljIFNldDxD\nYWNoZUtleT4gbmV3SW5zdGFuY2UoKSB7CiAgICAgICAgICAgIHJldHVybiBu\nZXcgSGFzaFNldDxDYWNoZUtleT4oKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBUcmVlU2V0TG9uZ0ZhY3RvcnkgaW1w\nbGVtZW50cyBGYWN0b3J5PFNvcnRlZFNldDxMb25nPj4gewogICAgICAgIHBy\nb3RlY3RlZCBzdGF0aWMgVHJlZVNldExvbmdGYWN0b3J5IGluc3RhbmNlID0g\nbmV3IFRyZWVTZXRMb25nRmFjdG9yeSgpOwoKICAgICAgICBwdWJsaWMgU29y\ndGVkU2V0PExvbmc+IG5ld0luc3RhbmNlKCkgewogICAgICAgICAgICByZXR1\ncm4gbmV3IFRyZWVTZXQ8TG9uZz4oKTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBGb3IgYWRkaW5nIHRoZSBtZXNzYWdlIHRvIHRoZSBjYWNo\nZSwgd2UgZG8gc29tZSBib29rZWVwaW5nIHN1Y2ggYXMgdGhlCiAgICAgKiB0\nb3RhbCBzaXplIG9mIGNhY2hlLCBvcmRlciBpbiB3aGljaCBlbnRyaWVzIHdl\ncmUgYWRkZWQgZXRjLiBJZiB0aGUgc2l6ZQogICAgICogb2YgdGhlIGNhY2hl\nIGhhcyBleGNlZWRlZCBvdXIgYnVkZ2V0LCBvbGQgZW50cmllcyBhcmUgY29s\nbGVjdGVkLgogICAgICoKICAgICAqIEBwYXJhbSBjYWNoZUtleQogICAgICog\nQHBhcmFtIG1lc3NhZ2UKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgYWRk\nTWVzc2FnZVRvQ2FjaGUoQ2FjaGVLZXkgY2FjaGVLZXksIE1lc3NhZ2UgbWVz\nc2FnZSwgbG9uZyBjdXJyVGltZSkgewogICAgICAgIGlmIChsb2dnZXIuaXNE\nZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICBsb2dnZXIuZGVidWcoIkFk\nZGluZyBtc2cgKHRvcGljOiAiICsgY2FjaGVLZXkuZ2V0VG9waWMoKS50b1N0\ncmluZ1V0ZjgoKSArICIsIHNlcS1pZDogIgogICAgICAgICAgICAgICAgICAg\nICAgICAgKyBtZXNzYWdlLmdldE1zZ0lkKCkuZ2V0TG9jYWxDb21wb25lbnQo\nKSArICIpIHRvIHJlYWRhaGVhZCBjYWNoZSIpOwogICAgICAgIH0KCiAgICAg\nICAgQ2FjaGVWYWx1ZSBjYWNoZVZhbHVlOwoKICAgICAgICBpZiAoKGNhY2hl\nVmFsdWUgPSBjYWNoZS5nZXQoY2FjaGVLZXkpKSA9PSBudWxsKSB7CiAgICAg\nICAgICAgIGNhY2hlVmFsdWUgPSBuZXcgQ2FjaGVWYWx1ZSgpOwogICAgICAg\nICAgICBjYWNoZS5wdXQoY2FjaGVLZXksIGNhY2hlVmFsdWUpOwogICAgICAg\nIH0KCiAgICAgICAgLy8gdXBkYXRlIHRoZSBjYWNoZSBzaXplCiAgICAgICAg\ncHJlc2VudENhY2hlU2l6ZSArPSBtZXNzYWdlLmdldEJvZHkoKS5zaXplKCk7\nCgogICAgICAgIC8vIG1haW50YWluIHRoZSB0aW1lIGluZGV4IG9mIGFkZGl0\naW9uCiAgICAgICAgTWFwTWV0aG9kcy5hZGRUb011bHRpTWFwKHRpbWVJbmRl\neE9mQWRkaXRpb24sIGN1cnJUaW1lLCBjYWNoZUtleSwgSGFzaFNldENhY2hl\nS2V5RmFjdG9yeS5pbnN0YW5jZSk7CgogICAgICAgIC8vIG1haW50YWluIHRo\nZSBpbmRleCBvZiBzZXEtaWQKICAgICAgICBNYXBNZXRob2RzLmFkZFRvTXVs\ndGlNYXAob3JkZXJlZEluZGV4T25TZXFJZCwgY2FjaGVLZXkuZ2V0VG9waWMo\nKSwgY2FjaGVLZXkuZ2V0U2VxSWQoKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgVHJlZVNldExvbmdGYWN0b3J5Lmluc3RhbmNlKTsKCiAg\nICAgICAgLy8gZmluYWxseSBhZGQgdGhlIG1lc3NhZ2UgdG8gdGhlIGNhY2hl\nCiAgICAgICAgY2FjaGVWYWx1ZS5zZXRNZXNzYWdlQW5kSW52b2tlQ2FsbGJh\nY2tzKG1lc3NhZ2UsIGN1cnJUaW1lKTsKCiAgICAgICAgLy8gaWYgb3Zlcmdy\nb3duLCBjb2xsZWN0IG9sZCBlbnRyaWVzCiAgICAgICAgY29sbGVjdE9sZENh\nY2hlRW50cmllcygpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHJlbW92\nZU1lc3NhZ2VGcm9tQ2FjaGUoQ2FjaGVLZXkgY2FjaGVLZXksIEV4Y2VwdGlv\nbiBleGNlcHRpb24sIGJvb2xlYW4gbWFpbnRhaW5UaW1lSW5kZXgsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW4g\nbWFpbnRhaW5TZXFJZEluZGV4KSB7CiAgICAgICAgQ2FjaGVWYWx1ZSBjYWNo\nZVZhbHVlID0gY2FjaGUucmVtb3ZlKGNhY2hlS2V5KTsKCiAgICAgICAgaWYg\nKGNhY2hlVmFsdWUgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgfQoKICAgICAgICBpZiAoY2FjaGVWYWx1ZS5pc1N0dWIoKSkgewog\nICAgICAgICAgICBjYWNoZVZhbHVlLnNldEVycm9yQW5kSW52b2tlQ2FsbGJh\nY2tzKGV4Y2VwdGlvbik7CiAgICAgICAgICAgIC8vIFN0dWJzIGFyZSBub3Qg\ncHJlc2VudCBpbiB0aGUgaW5kZXhlcywgc28gZG9udCBuZWVkIHRvIG1haW50\nYWluCiAgICAgICAgICAgIC8vIGluZGV4ZXMgaGVyZQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQoKICAgICAgICBwcmVzZW50Q2FjaGVTaXplIC09\nIGNhY2hlVmFsdWUuZ2V0TWVzc2FnZSgpLmdldEJvZHkoKS5zaXplKCk7Cgog\nICAgICAgIC8vIG1haW50YWluIHRoZSAyIGluZGV4ZXMKICAgICAgICAvLyBU\nT0RPOiBjYW4gd2UgbWFpbnRhaW4gdGhlc2UgbGF6aWx5PwogICAgICAgIGlm\nIChtYWludGFpblNlcUlkSW5kZXgpIHsKICAgICAgICAgICAgTWFwTWV0aG9k\ncy5yZW1vdmVGcm9tTXVsdGlNYXAob3JkZXJlZEluZGV4T25TZXFJZCwgY2Fj\naGVLZXkuZ2V0VG9waWMoKSwgY2FjaGVLZXkuZ2V0U2VxSWQoKSk7CiAgICAg\nICAgfQogICAgICAgIGlmIChtYWludGFpblRpbWVJbmRleCkgewogICAgICAg\nICAgICBNYXBNZXRob2RzLnJlbW92ZUZyb21NdWx0aU1hcCh0aW1lSW5kZXhP\nZkFkZGl0aW9uLCBjYWNoZVZhbHVlLmdldFRpbWVPZkFkZGl0aW9uKCksIGNh\nY2hlS2V5KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDb2xs\nZWN0aW9uIG9mIG9sZCBlbnRyaWVzIGlzIHNpbXBsZS4gSnVzdCBjb2xsZWN0\nIGluIGluc2VydC10aW1lIG9yZGVyLAogICAgICogb2xkZXN0IHRvIG5ld2Vz\ndC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgY29sbGVjdE9sZENhY2hl\nRW50cmllcygpIHsKICAgICAgICBsb25nIG1heENhY2hlU2l6ZSA9IGNmZy5n\nZXRNYXhpbXVtQ2FjaGVTaXplKCk7CgogICAgICAgIHdoaWxlIChwcmVzZW50\nQ2FjaGVTaXplID4gbWF4Q2FjaGVTaXplICYmICF0aW1lSW5kZXhPZkFkZGl0\naW9uLmlzRW1wdHkoKSkgewogICAgICAgICAgICBMb25nIGVhcmxpZXN0VGlt\nZSA9IHRpbWVJbmRleE9mQWRkaXRpb24uZmlyc3RLZXkoKTsKICAgICAgICAg\nICAgU2V0PENhY2hlS2V5PiBvbGRDYWNoZUVudHJpZXMgPSB0aW1lSW5kZXhP\nZkFkZGl0aW9uLmdldChlYXJsaWVzdFRpbWUpOwoKICAgICAgICAgICAgLy8g\nTm90ZTogb25seSBjb25jcmV0ZSBjYWNoZSBlbnRyaWVzLCBhbmQgbm90IHN0\ndWJzIGFyZSBpbiB0aGUgdGltZQogICAgICAgICAgICAvLyBpbmRleC4gSGVu\nY2UgdGhlcmUgY2FuIGJlIG5vIGNhbGxiYWNrcyBwZW5kaW5nIG9uIHRoZXNl\nIGNhY2hlCiAgICAgICAgICAgIC8vIGVudHJpZXMuIEhlbmNlIHNhZmUgdG8g\ncmVtb3ZlIHRoZW0gZGlyZWN0bHkuCiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3I8Q2FjaGVLZXk+IGl0ZXIgPSBvbGRDYWNoZUVudHJpZXMuaXRlcmF0b3Io\nKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBDYWNoZUtl\neSBjYWNoZUtleSA9IGl0ZXIubmV4dCgpOwoKICAgICAgICAgICAgICAgIGlm\nIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1ZygiUmVtb3ZpbmcgdG9waWM6ICIgKyBjYWNoZUtl\neS5nZXRUb3BpYygpICsgInNlcS1pZDogIiArIGNhY2hlS2V5LmdldFNlcUlk\nKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGZyb20g\nY2FjaGUgYmVjYXVzZSBpdHMgdGhlIG9sZGVzdCIpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgcmVtb3ZlTWVzc2FnZUZyb21DYWNoZShj\nYWNoZUtleSwgcmVhZEFoZWFkRXhjZXB0aW9uSW5zdGFuY2UsIC8vCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1haW50YWlu\nVGltZUluZGV4PQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gbWFpbnRhaW5TZXFJZEluZGV4PQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB0cnVlKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgdGltZUluZGV4T2ZBZGRpdGlvbi5yZW1vdmUoZWFybGll\nc3RUaW1lKTsKCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogPT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgKiBUaGUgcmVzdCBpcyBq\ndXN0IHNpbXBsZSB3cmFwcGVyIGNsYXNzZXMuCiAgICAgKgogICAgICovCgog\nICAgcHJvdGVjdGVkIGNsYXNzIEV4Y2VwdGlvbk9uQ2FjaGVLZXkgaW1wbGVt\nZW50cyBDYWNoZVJlcXVlc3QgewogICAgICAgIENhY2hlS2V5IGNhY2hlS2V5\nOwogICAgICAgIEV4Y2VwdGlvbiBleGNlcHRpb247CgogICAgICAgIHB1Ymxp\nYyBFeGNlcHRpb25PbkNhY2hlS2V5KENhY2hlS2V5IGNhY2hlS2V5LCBFeGNl\ncHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuY2FjaGVLZXkg\nPSBjYWNoZUtleTsKICAgICAgICAgICAgdGhpcy5leGNlcHRpb24gPSBleGNl\ncHRpb247CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBJZiBm\nb3Igc29tZSByZWFzb24sIGFuIG91dHN0YW5kaW5nIHJlYWQgb24gYSBjYWNo\nZSBzdHViIGZhaWxzLAogICAgICAgICAqIGV4Y2VwdGlvbiBmb3IgdGhhdCBr\nZXkgaXMgZW5xdWV1ZWQgYnkgdGhlCiAgICAgICAgICoge0BsaW5rIFJlYWRB\naGVhZFNjYW5DYWxsYmFja30uIFRvIGhhbmRsZSB0aGlzLCB3ZSBzaW1wbHkg\nc2VuZCBlcnJvcgogICAgICAgICAqIG9uIHRoZSBjYWxsYmFja3MgcmVnaXN0\nZXJlZCBmb3IgdGhhdCBzdHViLCBhbmQgZGVsZXRlIHRoZSBlbnRyeSBmcm9t\nCiAgICAgICAgICogdGhlIGNhY2hlCiAgICAgICAgICovCiAgICAgICAgcHVi\nbGljIHZvaWQgcGVyZm9ybVJlcXVlc3QoKSB7CiAgICAgICAgICAgIHJlbW92\nZU1lc3NhZ2VGcm9tQ2FjaGUoY2FjaGVLZXksIGV4Y2VwdGlvbiwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWludGFpblRpbWVJ\nbmRleD0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVl\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1haW50\nYWluU2VxSWRJbmRleD0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB0cnVlKTsKICAgICAgICB9CgogICAgfQoKICAgIEBTdXBwcmVzc1dh\ncm5pbmdzKCJzZXJpYWwiKQogICAgcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBO\nb1N1Y2hTZXFJZEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CgogICAg\nICAgIHB1YmxpYyBOb1N1Y2hTZXFJZEV4Y2VwdGlvbigpIHsKICAgICAgICAg\nICAgc3VwZXIoIk5vIHN1Y2ggc2VxLWlkIik7CiAgICAgICAgfQogICAgfQoK\nICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJzZXJpYWwiKQogICAgcHJvdGVjdGVk\nIHN0YXRpYyBjbGFzcyBSZWFkQWhlYWRFeGNlcHRpb24gZXh0ZW5kcyBFeGNl\ncHRpb24gewogICAgICAgIHB1YmxpYyBSZWFkQWhlYWRFeGNlcHRpb24oKSB7\nCiAgICAgICAgICAgIHN1cGVyKCJSZWFkYWhlYWQgZmFpbGVkIik7CiAgICAg\nICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBjbGFzcyBTY2FuUmVzcG9uc2Ug\naW1wbGVtZW50cyBDYWNoZVJlcXVlc3QgewogICAgICAgIENhY2hlS2V5IGNh\nY2hlS2V5OwogICAgICAgIE1lc3NhZ2UgbWVzc2FnZTsKCiAgICAgICAgcHVi\nbGljIFNjYW5SZXNwb25zZShDYWNoZUtleSBjYWNoZUtleSwgTWVzc2FnZSBt\nZXNzYWdlKSB7CiAgICAgICAgICAgIHRoaXMuY2FjaGVLZXkgPSBjYWNoZUtl\neTsKICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHBlcmZvcm1SZXF1ZXN0KCkgewog\nICAgICAgICAgICBhZGRNZXNzYWdlVG9DYWNoZShjYWNoZUtleSwgbWVzc2Fn\nZSwgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkpOwogICAgICAgIH0KCiAg\nICB9CgogICAgcHJvdGVjdGVkIGNsYXNzIERlbGl2ZXJlZFVudGlsIGltcGxl\nbWVudHMgQ2FjaGVSZXF1ZXN0IHsKICAgICAgICBCeXRlU3RyaW5nIHRvcGlj\nOwogICAgICAgIExvbmcgc2VxSWQ7CgogICAgICAgIHB1YmxpYyBEZWxpdmVy\nZWRVbnRpbChCeXRlU3RyaW5nIHRvcGljLCBMb25nIHNlcUlkKSB7CiAgICAg\nICAgICAgIHRoaXMudG9waWMgPSB0b3BpYzsKICAgICAgICAgICAgdGhpcy5z\nZXFJZCA9IHNlcUlkOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\ncGVyZm9ybVJlcXVlc3QoKSB7CiAgICAgICAgICAgIFNvcnRlZFNldDxMb25n\nPiBvcmRlcmVkU2VxSWRzID0gb3JkZXJlZEluZGV4T25TZXFJZC5nZXQodG9w\naWMpOwogICAgICAgICAgICBpZiAob3JkZXJlZFNlcUlkcyA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIC8vIGZvY3VzIG9uIHRoZSBzZXQgb2YgbWVzc2FnZXMgd2l0aCBz\nZXEtaWRzIDw9IHRoZSBvbmUgdGhhdAogICAgICAgICAgICAvLyBoYXMgYmVl\nbiBkZWxpdmVyZWQgdW50aWwKICAgICAgICAgICAgU29ydGVkU2V0PExvbmc+\nIGhlYWRTZXQgPSBvcmRlcmVkU2VxSWRzLmhlYWRTZXQoc2VxSWQgKyAxKTsK\nCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8TG9uZz4gaXRlciA9IGhlYWRT\nZXQuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAg\nICAgICBMb25nIHNlcUlkID0gaXRlci5uZXh0KCk7CiAgICAgICAgICAgICAg\nICBDYWNoZUtleSBjYWNoZUtleSA9IG5ldyBDYWNoZUtleSh0b3BpYywgc2Vx\nSWQpOwoKICAgICAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJs\nZWQoKSkgewogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiUmVt\nb3Zpbmcgc2VxLWlkOiAiICsgY2FjaGVLZXkuZ2V0U2VxSWQoKSArICIgdG9w\naWM6ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBjYWNo\nZUtleS5nZXRUb3BpYygpLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiBmcm9tIGNhY2hlIGJlY2F1c2UgZXZl\ncnkgc3Vic2NyaWJlciBoYXMgbW92ZWQgcGFzdCIpOwogICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgIHJlbW92ZU1lc3NhZ2VGcm9tQ2FjaGUo\nY2FjaGVLZXksIHJlYWRBaGVhZEV4Y2VwdGlvbkluc3RhbmNlLCAvLwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWludGFp\nblRpbWVJbmRleD0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gbWFpbnRhaW5TZXFJZEluZGV4PQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSk7CiAgICAgICAgICAgICAg\nICBpdGVyLnJlbW92ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBp\nZiAob3JkZXJlZFNlcUlkcy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgICAg\nIG9yZGVyZWRJbmRleE9uU2VxSWQucmVtb3ZlKHRvcGljKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgY2xhc3MgU2Nh\nblJlcXVlc3RXcmFwcGVyIGltcGxlbWVudHMgQ2FjaGVSZXF1ZXN0IHsKICAg\nICAgICBTY2FuUmVxdWVzdCByZXF1ZXN0OwoKICAgICAgICBwdWJsaWMgU2Nh\nblJlcXVlc3RXcmFwcGVyKFNjYW5SZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAg\nICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDsKICAgICAgICB9CgogICAg\nICAgIC8qKgogICAgICAgICAqIFRvIGhhbmRsZSBhIHNjYW4gcmVxdWVzdCwg\nd2UgZmlyc3QgdHJ5IHRvIGRvIHJlYWRhaGVhZCAod2hpY2ggbWlnaHQKICAg\nICAgICAgKiBjYXVzZSBhIHJhbmdlIHJlYWQgdG8gYmUgaXNzdWVkIHRvIHRo\nZSB1bmRlcmx5aW5nIHBlcnNpc3RlbmNlCiAgICAgICAgICogbWFuYWdlciku\nIFRoZSByZWFkYWhlYWQgd2lsbCBwdXQgYSBzdHViIGluIHRoZSBjYWNoZSwg\naWYgdGhlIG1lc3NhZ2UKICAgICAgICAgKiBpcyBub3QgYWxyZWFkeSBwcmVz\nZW50IGluIHRoZSBjYWNoZS4gVGhlIHNjYW4gY2FsbGJhY2sgdGhhdCBpcyBw\nYXJ0CiAgICAgICAgICogb2YgdGhlIHNjYW4gcmVxdWVzdCBpcyBhZGRlZCB0\nbyB0aGlzIHN0dWIsIGFuZCB3aWxsIGJlIGNhbGxlZCBsYXRlcgogICAgICAg\nICAqIHdoZW4gdGhlIG1lc3NhZ2UgYXJyaXZlcyBhcyBhIHJlc3VsdCBvZiB0\naGUgcmFuZ2Ugc2NhbiBpc3N1ZWQgdG8gdGhlCiAgICAgICAgICogdW5kZXJs\neWluZyBwZXJzaXN0ZW5jZSBtYW5hZ2VyLgogICAgICAgICAqLwoKICAgICAg\nICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVxdWVzdCgpIHsKCiAgICAgICAgICAg\nIFJhbmdlU2NhblJlcXVlc3QgcmVhZEFoZWFkUmVxdWVzdCA9IGRvUmVhZEFo\nZWFkKHJlcXVlc3QpOwoKICAgICAgICAgICAgLy8gUmVhZCBhaGVhZCBtdXN0\nIGhhdmUgaW5zdGFsbGVkIGF0IGxlYXN0IGEgc3R1YiBmb3IgdXMsIHNvIHRo\naXMKICAgICAgICAgICAgLy8gY2FuJ3QgYmUgbnVsbAogICAgICAgICAgICBD\nYWNoZVZhbHVlIGNhY2hlVmFsdWUgPSBjYWNoZS5nZXQobmV3IENhY2hlS2V5\nKHJlcXVlc3QuZ2V0VG9waWMoKSwgcmVxdWVzdC5nZXRTdGFydFNlcUlkKCkp\nKTsKCiAgICAgICAgICAgIC8vIEFkZCBvdXIgY2FsbGJhY2sgdG8gdGhlIHN0\ndWIuIElmIHRoZSBjYWNoZSB2YWx1ZSB3YXMgYWxyZWFkeSBhCiAgICAgICAg\nICAgIC8vIGNvbmNyZXRlIG1lc3NhZ2UsIHRoZSBjYWxsYmFjayB3aWxsIGJl\nIGNhbGxlZCByaWdodCBhd2F5CiAgICAgICAgICAgIGNhY2hlVmFsdWUuYWRk\nQ2FsbGJhY2socmVxdWVzdC5nZXRDYWxsYmFjaygpLCByZXF1ZXN0LmdldEN0\neCgpKTsKCiAgICAgICAgICAgIGlmIChyZWFkQWhlYWRSZXF1ZXN0ICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgIHJlYWxQZXJzaXN0ZW5jZU1hbmFnZXIu\nc2Nhbk1lc3NhZ2VzKHJlYWRBaGVhZFJlcXVlc3QpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBjbGFzcyBTaHV0ZG93\nbkNhY2hlUmVxdWVzdCBpbXBsZW1lbnRzIENhY2hlUmVxdWVzdCB7CiAgICAg\nICAgLy8gVGhpcyBpcyBhIHNpbXBsZSB0eXBlIG9mIENhY2hlUmVxdWVzdCB3\nZSB3aWxsIGVucXVldWUgd2hlbgogICAgICAgIC8vIHRoZSBQdWJTdWJTZXJ2\nZXIgaXMgc2h1dCBkb3duIGFuZCB3ZSB3YW50IHRvIHN0b3AgdGhlIFJlYWRB\naGVhZENhY2hlCiAgICAgICAgLy8gdGhyZWFkLgogICAgICAgIHB1YmxpYyB2\nb2lkIHBlcmZvcm1SZXF1ZXN0KCkgewogICAgICAgICAgICBrZWVwUnVubmlu\nZyA9IGZhbHNlOwogICAgICAgIH0KICAgIH0KCn0K\n","encoding":"base64"}

