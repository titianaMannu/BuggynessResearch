{"sha":"4d39335f7d727ea21f3d0e924287a1bb451c82e6","node_id":"MDQ6QmxvYjE1NzU5NTY6NGQzOTMzNWY3ZDcyN2VhMjFmM2QwZTkyNDI4N2ExYmI0NTFjODJlNg==","size":11491,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/4d39335f7d727ea21f3d0e924287a1bb451c82e6","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9uczsK\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1h\ncDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlNjaGVkdWxlZEV4ZWN1\ndG9yU2VydmljZTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0b21p\nYy5BdG9taWNCb29sZWFuOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQu\nYXRvbWljLkF0b21pY0ludGVnZXI7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuQ3JlYXRlTW9kZTsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLktlZXBlckV4Y2VwdGlvbi5Db2RlOwppbXBvcnQgb3JnLmFwYWNo\nZS56b29rZWVwZXIuWm9vRGVmcy5JZHM7CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5kYXRhLlN0YXQ7CmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVm\nLkJ5dGVTdHJpbmc7CmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFs\naWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2Ny\naXB0aW9uU3RhdGU7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2V4\ndGVuc2lvbnMuU3Vic2NyaXB0aW9uU3RhdGVVdGlsczsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5j\nZS5QZXJzaXN0ZW5jZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5zZXJ2ZXIudG9waWNzLlRvcGljTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy56b29rZWVwZXIuU2FmZUFzeW5jWktDYWxsYmFjazsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnpvb2tlZXBlci5aa1V0aWxzOwoKcHVibGljIGNs\nYXNzIFprU3Vic2NyaXB0aW9uTWFuYWdlciBleHRlbmRzIEFic3RyYWN0U3Vi\nc2NyaXB0aW9uTWFuYWdlciB7CgogICAgWm9vS2VlcGVyIHprOwoKICAgIHBy\nb3RlY3RlZCBmaW5hbCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZh\nY3RvcnkuZ2V0TG9nZ2VyKFprU3Vic2NyaXB0aW9uTWFuYWdlci5jbGFzcyk7\nCgogICAgcHVibGljIFprU3Vic2NyaXB0aW9uTWFuYWdlcihab29LZWVwZXIg\nemssIFRvcGljTWFuYWdlciB0b3BpY01nciwgUGVyc2lzdGVuY2VNYW5hZ2Vy\nIHBtLCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNmZywKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNj\naGVkdWxlcikgewogICAgICAgIHN1cGVyKGNmZywgdG9waWNNZ3IsIHBtLCBz\nY2hlZHVsZXIpOwogICAgICAgIHRoaXMuemsgPSB6azsKICAgIH0KCiAgICBw\ncml2YXRlIFN0cmluZ0J1aWxkZXIgdG9waWNTdWJzY3JpYmVyc1BhdGgoU3Ry\naW5nQnVpbGRlciBzYiwgQnl0ZVN0cmluZyB0b3BpYykgewogICAgICAgIHJl\ndHVybiBjZmcuZ2V0WmtUb3BpY1BhdGgoc2IsIHRvcGljKS5hcHBlbmQoIi9z\ndWJzY3JpYmVycyIpOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIHRvcGlj\nU3Vic2NyaWJlclBhdGgoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBz\ndWJzY3JpYmVyKSB7CiAgICAgICAgcmV0dXJuIHRvcGljU3Vic2NyaWJlcnNQ\nYXRoKG5ldyBTdHJpbmdCdWlsZGVyKCksIHRvcGljKS5hcHBlbmQoIi8iKS5h\ncHBlbmQoc3Vic2NyaWJlci50b1N0cmluZ1V0ZjgoKSkKICAgICAgICAgICAg\nICAgLnRvU3RyaW5nKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90\nZWN0ZWQgdm9pZCByZWFkU3Vic2NyaXB0aW9ucyhmaW5hbCBCeXRlU3RyaW5n\nIHRvcGljLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZmluYWwgQ2FsbGJhY2s8TWFwPEJ5dGVTdHJpbmcsIEluTWVtb3J5U3Vic2Ny\naXB0aW9uU3RhdGU+PiBjYiwgZmluYWwgT2JqZWN0IGN0eCkgewoKICAgICAg\nICBTdHJpbmcgdG9waWNTdWJzY3JpYmVyc1BhdGggPSB0b3BpY1N1YnNjcmli\nZXJzUGF0aChuZXcgU3RyaW5nQnVpbGRlcigpLCB0b3BpYykudG9TdHJpbmco\nKTsKICAgICAgICB6ay5nZXRDaGlsZHJlbih0b3BpY1N1YnNjcmliZXJzUGF0\naCwgZmFsc2UsIG5ldyBTYWZlQXN5bmNaS0NhbGxiYWNrLkNoaWxkcmVuQ2Fs\nbGJhY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBzYWZlUHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBw\nYXRoLCBmaW5hbCBPYmplY3QgY3R4LCBmaW5hbCBMaXN0PFN0cmluZz4gY2hp\nbGRyZW4pIHsKCiAgICAgICAgICAgICAgICBpZiAocmMgIT0gQ29kZS5PSy5p\nbnRWYWx1ZSgpICYmIHJjICE9IENvZGUuTk9OT0RFLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24gZSA9IFprVXRp\nbHMubG9nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigiQ291bGQgbm90IHJl\nYWQgc3Vic2NyaWJlcnMgZm9yIHRvcGljICIKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgdG9waWMudG9TdHJpbmdVdGY4KCks\nIHBhdGgsIHJjKTsKICAgICAgICAgICAgICAgICAgICBjYi5vcGVyYXRpb25G\nYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhj\nZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZmluYWwgTWFwPEJ5dGVT\ndHJpbmcsIEluTWVtb3J5U3Vic2NyaXB0aW9uU3RhdGU+IHRvcGljU3VicyA9\nIG5ldyBDb25jdXJyZW50SGFzaE1hcDxCeXRlU3RyaW5nLCBJbk1lbW9yeVN1\nYnNjcmlwdGlvblN0YXRlPigpOwoKICAgICAgICAgICAgICAgIGlmIChyYyA9\nPSBDb2RlLk5PTk9ERS5pbnRWYWx1ZSgpIHx8IGNoaWxkcmVuLnNpemUoKSA9\nPSAwKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVn\nRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5k\nZWJ1ZygiTm8gc3Vic2NyaXB0aW9ucyBmb3VuZCB3aGlsZSBhY3F1aXJpbmcg\ndG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkZp\nbmlzaGVkKGN0eCwgdG9waWNTdWJzKTsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZmlu\nYWwgQXRvbWljQm9vbGVhbiBmYWlsZWQgPSBuZXcgQXRvbWljQm9vbGVhbigp\nOwogICAgICAgICAgICAgICAgZmluYWwgQXRvbWljSW50ZWdlciBjb3VudCA9\nIG5ldyBBdG9taWNJbnRlZ2VyKCk7CgogICAgICAgICAgICAgICAgZm9yIChm\naW5hbCBTdHJpbmcgY2hpbGQgOiBjaGlsZHJlbikgewoKICAgICAgICAgICAg\nICAgICAgICBmaW5hbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCA9IEJ5dGVT\ndHJpbmcuY29weUZyb21VdGY4KGNoaWxkKTsKICAgICAgICAgICAgICAgICAg\nICBmaW5hbCBTdHJpbmcgY2hpbGRQYXRoID0gcGF0aCArICIvIiArIGNoaWxk\nOwoKICAgICAgICAgICAgICAgICAgICB6ay5nZXREYXRhKGNoaWxkUGF0aCwg\nZmFsc2UsIG5ldyBTYWZlQXN5bmNaS0NhbGxiYWNrLkRhdGFDYWxsYmFjaygp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0\nKGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsIGJ5dGVbXSBkYXRh\nLCBTdGF0IHN0YXQpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGUgPSBaa1V0aWxz\nLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRpb24oCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNv\ndWxkIG5vdCByZWFkIHN1YnNjcmlwdGlvbiBkYXRhIGZvciB0b3BpYzogIiAr\nIHRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiLCBzdWJzY3Jp\nYmVySWQ6ICIgKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCksIHBhdGgs\nIHJjKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnRG\nYWlsdXJlKG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRp\nb24oZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoZmFpbGVkLmdldCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIFN1YnNjcmlwdGlvblN0YXRlIHN0YXRlOwoKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgc3RhdGUgPSBTdWJzY3JpcHRpb25TdGF0ZS5wYXJzZUZyb20oZGF0YSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnZhbGlk\nUHJvdG9jb2xCdWZmZXJFeGNlcHRpb24gZXgpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBTdHJpbmcgbXNnID0gIkZhaWxlZCB0byBkZXNl\ncmlhbGl6ZSBzdGF0ZSBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0\nZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICArICIgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3Ry\naW5nVXRmOCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcihtc2csIGV4KTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICByZXBvcnRGYWlsdXJlKG5ldyBQdWJTdWJFeGNlcHRpb24uVW5l\neHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbihtc2cpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJGb3VuZCBzdWJzY3JpcHRp\nb24gd2hpbGUgYWNxdWlyaW5nIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdV\ndGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIGNoaWxkICsgInN0YXRlOiAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgU3Vic2NyaXB0aW9uU3RhdGVVdGlscy50b1N0cmluZyhzdGF0ZSkpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHRvcGljU3Vicy5wdXQoc3Vic2NyaWJlcklkLCBuZXcg\nSW5NZW1vcnlTdWJzY3JpcHRpb25TdGF0ZShzdGF0ZSkpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKGNvdW50LmluY3JlbWVudEFuZEdldCgp\nID09IGNoaWxkcmVuLnNpemUoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGFzc2VydCB0b3BpY1N1YnMuc2l6ZSgpID09IGNvdW50Lmdl\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJh\ndGlvbkZpbmlzaGVkKGN0eCwgdG9waWNTdWJzKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHJlcG9ydEZhaWx1\ncmUoUHViU3ViRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChmYWlsZWQuY29tcGFyZUFuZFNldChmYWxzZSwgdHJ1ZSkp\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9u\nRmFpbGVkKGN0eCwgZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICB9LCBjdHgpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgfSwgY3R4KTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGNyZWF0ZVN1YnNjcmlwdGlvblN0\nYXRlKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIEJ5dGVTdHJpbmcg\nc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgZmluYWwgU3Vic2NyaXB0aW9uU3RhdGUgc3RhdGUsIGZp\nbmFsIENhbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLCBmaW5hbCBPYmplY3QgY3R4\nKSB7CiAgICAgICAgWmtVdGlscy5jcmVhdGVGdWxsUGF0aE9wdGltaXN0aWMo\nemssIHRvcGljU3Vic2NyaWJlclBhdGgodG9waWMsIHN1YnNjcmliZXJJZCks\nIHN0YXRlLnRvQnl0ZUFycmF5KCksCiAgICAgICAgSWRzLk9QRU5fQUNMX1VO\nU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5ULCBuZXcgU2FmZUFzeW5jWktD\nYWxsYmFjay5TdHJpbmdDYWxsYmFjaygpIHsKCiAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBzYWZlUHJvY2Vzc1Jlc3Vs\ndChpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4LCBTdHJpbmcgbmFt\nZSkgewogICAgICAgICAgICAgICAgaWYgKHJjID09IENvZGUuT0suaW50VmFs\ndWUoKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1\nZ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu\nZGVidWcoIlN1Y2Nlc3NmdWxseSByZWNvcmRlZCBzdWJzY3JpcHRpb24gZm9y\nIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIg\nKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkgKyAiIHN0YXRlOiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFN1YnNjcmlw\ndGlvblN0YXRlVXRpbHMudG9TdHJpbmcoc3RhdGUpKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0\naW9uRmluaXNoZWQoY3R4LCBudWxsKTsKICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGtlID0g\nWmtVdGlscy5sb2dFcnJvckFuZENyZWF0ZVpLRXhjZXB0aW9uKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ291bGQg\nbm90IHJlY29yZCBuZXcgc3Vic2NyaXB0aW9uIGZvciB0b3BpYzogIiArIHRv\ncGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBzdWJz\nY3JpYmVySWQudG9TdHJpbmdVdGY4KCksIHBhdGgsIHJjKTsKICAgICAgICAg\nICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcg\nUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKGtlKSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LCBjdHgp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgdXBk\nYXRlU3Vic2NyaXB0aW9uU3RhdGUoZmluYWwgQnl0ZVN0cmluZyB0b3BpYywg\nZmluYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBTdWJzY3JpcHRp\nb25TdGF0ZSBzdGF0ZSwgZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ss\nIGZpbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICB6ay5zZXREYXRhKHRvcGlj\nU3Vic2NyaWJlclBhdGgodG9waWMsIHN1YnNjcmliZXJJZCksIHN0YXRlLnRv\nQnl0ZUFycmF5KCksIC0xLAogICAgICAgIG5ldyBTYWZlQXN5bmNaS0NhbGxi\nYWNrLlN0YXRDYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCBy\nYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsIFN0YXQgc3RhdCkgewogICAg\nICAgICAgICAgICAgaWYgKHJjICE9IENvZGUuT0suaW50VmFsdWUoKSkgewog\nICAgICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlvbiBlID0gWmtVdGls\ncy5sb2dFcnJvckFuZENyZWF0ZVpLRXhjZXB0aW9uKCJUb3BpYzogIiArIHRv\ncGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICArICIgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJl\ncklkLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICArICIgY291bGQgbm90IHNldCBzdWJzY3JpcHRpb24g\nc3RhdGU6ICIgKyBTdWJzY3JpcHRpb25TdGF0ZVV0aWxzLnRvU3RyaW5nKHN0\nYXRlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHBhdGgsIHJjKTsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVy\nYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VE\nb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3Vj\nY2Vzc2Z1bGx5IHVwZGF0ZWQgc3Vic2NyaXB0aW9uIGZvciB0b3BpYzogIiAr\nIHRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICArICIgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJl\ncklkLnRvU3RyaW5nVXRmOCgpICsgIiBzdGF0ZTogIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyBTdWJzY3JpcHRpb25TdGF0ZVV0\naWxzLnRvU3RyaW5nKHN0YXRlKSk7CiAgICAgICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hl\nZChjdHgsIG51bGwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgfSwgY3R4KTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCB2b2lkIGRlbGV0ZVN1YnNjcmlwdGlvblN0YXRlKGZpbmFsIEJ5\ndGVTdHJpbmcgdG9waWMsIGZpbmFsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklk\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIGZpbmFsIE9iamVjdCBj\ndHgpIHsKICAgICAgICB6ay5kZWxldGUodG9waWNTdWJzY3JpYmVyUGF0aCh0\nb3BpYywgc3Vic2NyaWJlcklkKSwgLTEsIG5ldyBTYWZlQXN5bmNaS0NhbGxi\nYWNrLlZvaWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCBy\nYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAg\nIGlmIChyYyA9PSBDb2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJTdWNjZXNzZnVsbHkg\nZGVsZXRlZCBzdWJzY3JpcHRpb24gZm9yIHRvcGljOiAiICsgdG9waWMudG9T\ndHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBzdWJzY3JpYmVySWQudG9TdHJp\nbmdVdGY4KCkpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAg\nICB9CgogICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGUgPSBaa1V0\naWxzLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRpb24oIlRvcGljOiAiICsg\ndG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJ\nZC50b1N0cmluZ1V0ZjgoKSArICIgZmFpbGVkIHRvIGRlbGV0ZSBzdWJzY3Jp\ncHRpb24iLCBwYXRoLCByYyk7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZp\nY2VEb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgfQogICAgICAgIH0s\nIGN0eCk7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

