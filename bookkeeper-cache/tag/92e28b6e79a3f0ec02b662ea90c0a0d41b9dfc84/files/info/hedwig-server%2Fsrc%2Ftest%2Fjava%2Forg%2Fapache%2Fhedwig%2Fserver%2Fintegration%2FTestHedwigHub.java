{"sha":"f7082a6d53c25a7e3d2420742279a0b297b6a6af","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjcwODJhNmQ1M2MyNWE3ZTNkMjQyMDc0MjI3OWEwYjI5N2I2YTZhZg==","size":29704,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f7082a6d53c25a7e3d2420742279a0b297b6a6af","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaW50ZWdyYXRpb247Cgpp\nbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZh\nLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5jb25j\ndXJyZW50LlN5bmNocm9ub3VzUXVldWU7CgppbXBvcnQgb3JnLmp1bml0LkFm\ndGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5p\ndC5UZXN0OwppbXBvcnQgb3JnLmp1bml0LnJ1bm5lci5SdW5XaXRoOwppbXBv\ncnQgb3JnLmp1bml0LnJ1bm5lcnMuUGFyYW1ldGVyaXplZDsKaW1wb3J0IG9y\nZy5qdW5pdC5ydW5uZXJzLlBhcmFtZXRlcml6ZWQuUGFyYW1ldGVyczsKCmlt\ncG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5TdWJzY3JpYmVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVu\ndC5leGNlcHRpb25zLkludmFsaWRTdWJzY3JpYmVySWRFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuSGVkd2lnQ2xpZW50Owpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5DbGllbnQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuU3Vic2NyaWJl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3Vi\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0aW9u\ncy5QdWJTdWJFeGNlcHRpb24uQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90\nb2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQ7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5PcGVyYXRp\nb25UeXBlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuUHJvdG9jb2xWZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuUHViU3ViUmVxdWVz\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLlB1YlN1YlJlc3BvbnNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3RhcnREZWxpdmVyeVJlcXVl\nc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQ\ncm90b2NvbC5TdGF0dXNDb2RlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVh\ndGVPckF0dGFjaDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvZXh0\nZW5zaW9ucy5TdWJzY3JpcHRpb25TdGF0ZVV0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLkhlZHdpZ0h1YlRlc3RCYXNlOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLm5ldHR5LldyaXRlUmVjb3JkaW5n\nQ2hhbm5lbDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5wcm94\neS5IZWR3aWdQcm94eTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZl\nci5wcm94eS5Qcm94eUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5zZXJ2ZXIucmVnaW9ucy5IZWR3aWdIdWJDbGllbnQ7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcudXRpbC5Db25jdXJyZW5jeVV0aWxzOwoKQFJ1bldp\ndGgoUGFyYW1ldGVyaXplZC5jbGFzcykKcHVibGljIGNsYXNzIFRlc3RIZWR3\naWdIdWIgZXh0ZW5kcyBIZWR3aWdIdWJUZXN0QmFzZSB7CgogICAgLy8gQ2xp\nZW50IHNpZGUgdmFyaWFibGVzCiAgICBwcm90ZWN0ZWQgSGVkd2lnQ2xpZW50\nIGNsaWVudDsKICAgIHByb3RlY3RlZCBQdWJsaXNoZXIgcHVibGlzaGVyOwog\nICAgcHJvdGVjdGVkIFN1YnNjcmliZXIgc3Vic2NyaWJlcjsKCiAgICAvLyBD\nb21tb24gQnl0ZVN0cmluZ3MgdXNlZCBpbiB0ZXN0cy4KICAgIHByaXZhdGUg\nZmluYWwgQnl0ZVN0cmluZyBsb2NhbFN1YnNjcmliZXJJZCA9IEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KCJMb2NhbFN1YnNjcmliZXIiKTsKICAgIHByaXZh\ndGUgZmluYWwgQnl0ZVN0cmluZyBodWJTdWJzY3JpYmVySWQgPSBCeXRlU3Ry\naW5nLmNvcHlGcm9tVXRmOChTdWJzY3JpcHRpb25TdGF0ZVV0aWxzLkhVQl9T\nVUJTQ1JJQkVSX1BSRUZJWAogICAgICAgICAgICArICJIdWJTdWJjcmliZXIi\nKTsKCiAgICBlbnVtIE1vZGUgewogICAgICAgIFJFR1VMQVIsIFBST1hZLCBT\nU0wKICAgIH07CgogICAgQFBhcmFtZXRlcnMKICAgIHB1YmxpYyBzdGF0aWMg\nQ29sbGVjdGlvbjxPYmplY3RbXT4gY29uZmlncygpIHsKICAgICAgICByZXR1\ncm4gQXJyYXlzLmFzTGlzdChuZXcgT2JqZWN0W11bXSB7IHsgTW9kZS5QUk9Y\nWSB9LCB7IE1vZGUuUkVHVUxBUiB9LCB7IE1vZGUuU1NMIH19KTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgTW9kZSBtb2RlOwoKICAgIHB1YmxpYyBUZXN0SGVk\nd2lnSHViKE1vZGUgbW9kZSkgewogICAgICAgIHRoaXMubW9kZSA9IG1vZGU7\nCiAgICB9CgogICAgcHJvdGVjdGVkIEhlZHdpZ1Byb3h5IHByb3h5OwogICAg\ncHJvdGVjdGVkIFByb3h5Q29uZmlndXJhdGlvbiBwcm94eUNvbmYgPSBuZXcg\nUHJveHlDb25maWd1cmF0aW9uKCk7CgogICAgLy8gU3luY2hyb25vdXNRdWV1\nZXMgdG8gdmVyaWZ5IGFzeW5jIGNhbGxzCiAgICBwcml2YXRlIGZpbmFsIFN5\nbmNocm9ub3VzUXVldWU8Qm9vbGVhbj4gcXVldWUgPSBuZXcgU3luY2hyb25v\ndXNRdWV1ZTxCb29sZWFuPigpOwogICAgcHJpdmF0ZSBmaW5hbCBTeW5jaHJv\nbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1bWVRdWV1ZSA9IG5ldyBTeW5jaHJv\nbm91c1F1ZXVlPEJvb2xlYW4+KCk7CgogICAgLy8gVGVzdCBpbXBsZW1lbnRh\ndGlvbiBvZiBDYWxsYmFjayBmb3IgYXN5bmMgY2xpZW50IGFjdGlvbnMuCiAg\nICBzdGF0aWMgY2xhc3MgVGVzdENhbGxiYWNrIGltcGxlbWVudHMgQ2FsbGJh\nY2s8Vm9pZD4gewogICAgICAgIHByaXZhdGUgZmluYWwgU3luY2hyb25vdXNR\ndWV1ZTxCb29sZWFuPiBxdWV1ZTsKCiAgICAgICAgcHVibGljIFRlc3RDYWxs\nYmFjayhTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IHF1ZXVlKSB7CiAgICAg\nICAgICAgIHRoaXMucXVldWUgPSBxdWV1ZTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlz\naGVkKE9iamVjdCBjdHgsIFZvaWQgcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAg\nICAgICAgICAgbmV3IFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVi\ndWdFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5k\nZWJ1ZygiT3BlcmF0aW9uIGZpbmlzaGVkISIpOwogICAgICAgICAgICAgICAg\nICAgIENvbmN1cnJlbmN5VXRpbHMucHV0KHF1ZXVlLCB0cnVlKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfSkuc3RhcnQoKTsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJh\ndGlvbkZhaWxlZChPYmplY3QgY3R4LCBmaW5hbCBQdWJTdWJFeGNlcHRpb24g\nZXhjZXB0aW9uKSB7CiAgICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5h\nYmxlKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAg\nbG9nZ2VyLmVycm9yKCJPcGVyYXRpb24gZmFpbGVkISIsIGV4Y2VwdGlvbik7\nCiAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQocXVl\ndWUsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSku\nc3RhcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gVGVzdCBpbXBsZW1l\nbnRhdGlvbiBvZiBzdWJzY3JpYmVyJ3MgbWVzc2FnZSBoYW5kbGVyLgogICAg\nc3RhdGljIGNsYXNzIFRlc3RNZXNzYWdlSGFuZGxlciBpbXBsZW1lbnRzIE1l\nc3NhZ2VIYW5kbGVyIHsKICAgICAgICAvLyBGb3Igc3Vic2NyaWJlIHJlY29u\nbmVjdCB0ZXN0aW5nLCB0aGUgc2VydmVyIGNvdWxkIHNlbmQgdXMgYmFjawog\nICAgICAgIC8vIG1lc3NhZ2VzIHdlJ3ZlIGFscmVhZHkgcHJvY2Vzc2VkIGFu\nZCBjb25zdW1lZC4gV2UgbmVlZCB0byBrZWVwCiAgICAgICAgLy8gdHJhY2sg\nb2YgdGhlIG9uZXMgd2UndmUgZW5jb3VudGVyZWQgc28gd2Ugb25seSBzaWdu\nYWwgYmFjayB0byB0aGUKICAgICAgICAvLyBjb25zdW1lUXVldWUgb25jZS4K\nICAgICAgICBwcml2YXRlIEhhc2hTZXQ8TWVzc2FnZVNlcUlkPiBjb25zdW1l\nZE1lc3NhZ2VzID0gbmV3IEhhc2hTZXQ8TWVzc2FnZVNlcUlkPigpOwogICAg\nICAgIHByaXZhdGUgbG9uZyBsYXJnZXN0TXNnU2VxSWRDb25zdW1lZCA9IC0x\nOwogICAgICAgIHByaXZhdGUgZmluYWwgU3luY2hyb25vdXNRdWV1ZTxCb29s\nZWFuPiBjb25zdW1lUXVldWU7CgogICAgICAgIHB1YmxpYyBUZXN0TWVzc2Fn\nZUhhbmRsZXIoU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBjb25zdW1lUXVl\ndWUpIHsKICAgICAgICAgICAgdGhpcy5jb25zdW1lUXVldWUgPSBjb25zdW1l\nUXVldWU7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBkZWxpdmVy\nKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBm\naW5hbCBNZXNzYWdlIG1zZywgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QgY29udGV4dCkgewog\nICAgICAgICAgICBpZiAoIWNvbnN1bWVkTWVzc2FnZXMuY29udGFpbnMobXNn\nLmdldE1zZ0lkKCkpKSB7CiAgICAgICAgICAgICAgICAvLyBOZXcgbWVzc2Fn\nZSB0byBjb25zdW1lLiBBZGQgaXQgdG8gdGhlIFNldCBvZiBjb25zdW1lZAog\nICAgICAgICAgICAgICAgLy8gbWVzc2FnZXMuCiAgICAgICAgICAgICAgICBj\nb25zdW1lZE1lc3NhZ2VzLmFkZChtc2cuZ2V0TXNnSWQoKSk7CiAgICAgICAg\nICAgICAgICAvLyBDaGVjayB0aGF0IHRoZSBtc2cgc2VxIElEIGlzIGluY3Jl\nbWVudGluZyBieSAxIGNvbXBhcmVkIHRvCiAgICAgICAgICAgICAgICAvLyB0\naGUgbGFzdCBjb25zdW1lZCBtZXNzYWdlLiBEb24ndCBkbyB0aGlzIGNoZWNr\nIGlmIHRoaXMgaXMgdGhlCiAgICAgICAgICAgICAgICAvLyBpbml0aWFsIG1l\nc3NhZ2UgYmVpbmcgY29uc3VtZWQuCiAgICAgICAgICAgICAgICBpZiAobGFy\nZ2VzdE1zZ1NlcUlkQ29uc3VtZWQgPj0gMCAmJiBtc2cuZ2V0TXNnSWQoKS5n\nZXRMb2NhbENvbXBvbmVudCgpICE9IGxhcmdlc3RNc2dTZXFJZENvbnN1bWVk\nICsgMSkgewogICAgICAgICAgICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1\nbm5hYmxlKCkgewogICAgICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVn\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxv\nZ2dlci5kZWJ1ZygiQ29uc3VtaW5nIG1lc3NhZ2UgdGhhdCBpcyBvdXQgb2Yg\nb3JkZXIgZm9yIG1zZ0lkOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgbXNnLmdldE1zZ0lkKCkuZ2V0TG9jYWxD\nb21wb25lbnQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb25j\ndXJyZW5jeVV0aWxzLnB1dChjb25zdW1lUXVldWUsIGZhbHNlKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLnN0\nYXJ0KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAg\nICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiQ29uc3VtZSBv\ncGVyYXRpb24gZmluaXNoZWQgc3VjY2Vzc2Z1bGx5ISIpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQoY29uc3Vt\nZVF1ZXVlLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgIH0pLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAvLyBTdG9yZSB0aGUgY29uc3VtZWQgbWVzc2Fn\nZSBhcyB0aGUgbmV3IGxhc3QgbXNnIGlkIGNvbnN1bWVkLgogICAgICAgICAg\nICAgICAgbGFyZ2VzdE1zZ1NlcUlkQ29uc3VtZWQgPSBtc2cuZ2V0TXNnSWQo\nKS5nZXRMb2NhbENvbXBvbmVudCgpOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiQ29uc3VtZWQgYSBt\nZXNzYWdlIHRoYXQgd2UndmUgcHJvY2Vzc2VkIGFscmVhZHk6ICIgKyBtc2cp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlv\nbkZpbmlzaGVkKGNvbnRleHQsIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAg\nICBjbGFzcyBUZXN0Q2xpZW50Q29uZmlndXJhdGlvbiBleHRlbmRzIENsaWVu\ndENvbmZpZ3VyYXRpb24gewogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyBJbmV0U29ja2V0QWRkcmVzcyBnZXREZWZhdWx0U2VydmVySG9zdCgp\nIHsKICAgICAgICAgICAgaWYgKG1vZGUgPT0gTW9kZS5QUk9YWSkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIG5ldyBJbmV0U29ja2V0QWRkcmVzcyhwcm94\neUNvbmYuZ2V0UHJveHlQb3J0KCkpOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldERlZmF1bHRTZXJ2ZXJI\nb3N0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBib29sZWFuIGlzU1NMRW5hYmxlZCgpIHsK\nICAgICAgICAgICAgaWYgKG1vZGUgPT0gTW9kZS5TU0wpCiAgICAgICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBD\nbGllbnRDb25maWd1cmF0aW9uIHRvIHVzZSBmb3IgdGhpcyB0ZXN0LgogICAg\ncHJvdGVjdGVkIENsaWVudENvbmZpZ3VyYXRpb24gZ2V0Q2xpZW50Q29uZmln\ndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gbmV3IFRlc3RDbGllbnRDb25m\naWd1cmF0aW9uKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBAQmVmb3Jl\nCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIG51bVNlcnZlcnMgPSAzOwogICAgICAgIHN1cGVyLnNldFVwKCk7\nCiAgICAgICAgaWYgKG1vZGUgPT0gTW9kZS5QUk9YWSkgewogICAgICAgICAg\nICBwcm94eSA9IG5ldyBIZWR3aWdQcm94eShwcm94eUNvbmYpOwogICAgICAg\nIH0KICAgICAgICBjbGllbnQgPSBuZXcgSGVkd2lnQ2xpZW50KGdldENsaWVu\ndENvbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgcHVibGlzaGVyID0gY2xpZW50\nLmdldFB1Ymxpc2hlcigpOwogICAgICAgIHN1YnNjcmliZXIgPSBjbGllbnQu\nZ2V0U3Vic2NyaWJlcigpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgQEFm\ndGVyCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgICAgIGlmIChtb2Rl\nID09IE1vZGUuUFJPWFkpIHsKICAgICAgICAgICAgcHJveHkuc2h1dGRvd24o\nKTsKICAgICAgICB9CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsKCiAgICB9\nCgogICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIE1lc3NhZ2Vz\nCiAgICBwcm90ZWN0ZWQgTWVzc2FnZSBnZXRNc2coaW50IG1zZ051bSkgewog\nICAgICAgIHJldHVybiBNZXNzYWdlLm5ld0J1aWxkZXIoKS5zZXRCb2R5KEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KCJNZXNzYWdlIiArIG1zZ051bSkpLmJ1\naWxkKCk7CiAgICB9CgogICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGdlbmVy\nYXRlIFRvcGljcwogICAgcHJvdGVjdGVkIEJ5dGVTdHJpbmcgZ2V0VG9waWMo\naW50IHRvcGljTnVtKSB7CiAgICAgICAgcmV0dXJuIEJ5dGVTdHJpbmcuY29w\neUZyb21VdGY4KCJUb3BpYyIgKyB0b3BpY051bSk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIHZvaWQgc3RhcnREZWxpdmVyeShCeXRlU3RyaW5nIHRvcGljLCBC\neXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgTWVzc2FnZUhhbmRsZXIgaGFuZGxl\ncikgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3RhcnREZWxpdmVyeShz\ndWJzY3JpYmVyLCB0b3BpYywgc3Vic2NyaWJlcklkLCBoYW5kbGVyKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydERlbGl2ZXJ5KFN1YnNjcmli\nZXIgc3Vic2NyaWJlciwgQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBz\ndWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIE1lc3NhZ2VIYW5kbGVyIGhhbmRsZXIpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHN1YnNjcmliZXIuc3RhcnREZWxpdmVyeSh0b3BpYywgc3Vic2Ny\naWJlcklkLCBoYW5kbGVyKTsKICAgICAgICBpZiAobW9kZSA9PSBNb2RlLlBS\nT1hZKSB7CiAgICAgICAgICAgIFdyaXRlUmVjb3JkaW5nQ2hhbm5lbCBjaGFu\nbmVsID0gbmV3IFdyaXRlUmVjb3JkaW5nQ2hhbm5lbCgpOwogICAgICAgICAg\nICBQdWJTdWJSZXF1ZXN0IHJlcXVlc3QgPSBQdWJTdWJSZXF1ZXN0Lm5ld0J1\naWxkZXIoKS5zZXRQcm90b2NvbFZlcnNpb24oUHJvdG9jb2xWZXJzaW9uLlZF\nUlNJT05fT05FKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAuc2V0VG9waWModG9waWMpLnNldFR4bklkKDApLnNldFR5cGUoT3BlcmF0\naW9uVHlwZS5TVEFSVF9ERUxJVkVSWSkuc2V0U3RhcnREZWxpdmVyeVJlcXVl\nc3QoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBT\ndGFydERlbGl2ZXJ5UmVxdWVzdC5uZXdCdWlsZGVyKCkuc2V0U3Vic2NyaWJl\ncklkKHN1YnNjcmliZXJJZCkpLmJ1aWxkKCk7CiAgICAgICAgICAgIHByb3h5\nLmdldFN0YXJ0RGVsaXZlcnlIYW5kbGVyKCkuaGFuZGxlUmVxdWVzdChyZXF1\nZXN0LCBjaGFubmVsKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFN0YXR1\nc0NvZGUuU1VDQ0VTUywgKChQdWJTdWJSZXNwb25zZSkgY2hhbm5lbC5nZXRN\nZXNzYWdlc1dyaXR0ZW4oKS5nZXQoMCkpLmdldFN0YXR1c0NvZGUoKSk7CiAg\nICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHB1Ymxpc2hGaXJz\ndEJhdGNoKGludCBiYXRjaFNpemUsIGJvb2xlYW4gbWVzc2FnZXNUb0JlQ29u\nc3VtZWQpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChsb2dnZXIu\naXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJQ\ndWJsaXNoaW5nIGZpcnN0IGJhdGNoIG9mIG1lc3NhZ2VzLiIpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAg\nICAgICAgcHVibGlzaGVyLmFzeW5jUHVibGlzaChnZXRUb3BpYyhpKSwgZ2V0\nTXNnKGkpLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAg\nICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAgICAg\naWYgKG1lc3NhZ2VzVG9CZUNvbnN1bWVkKQogICAgICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHJvdGVjdGVkIHZvaWQgcHVibGlzaFNlY29uZEJhdGNoKGludCBi\nYXRjaFNpemUsIGJvb2xlYW4gbWVzc2FnZXNUb0JlQ29uc3VtZWQpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJs\nZWQoKSkKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJQdWJsaXNoaW5nIHNl\nY29uZCBiYXRjaCBvZiBtZXNzYWdlcy4iKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIHB1Ymxp\nc2hlci5hc3luY1B1Ymxpc2goZ2V0VG9waWMoaSksIGdldE1zZyhpICsgYmF0\nY2hTaXplKSwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAg\nICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgICAg\nIGlmIChtZXNzYWdlc1RvQmVDb25zdW1lZCkKICAgICAgICAgICAgICAgIGFz\nc2VydFRydWUoY29uc3VtZVF1ZXVlLnRha2UoKSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHByb3RlY3RlZCB2b2lkIHN1YnNjcmliZVRvVG9waWNzKGludCBi\nYXRjaFNpemUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChsb2dn\nZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nZ2VyLmRlYnVn\nKCJTdWJzY3JpYmluZyB0byB0b3BpY3MgYW5kIHN0YXJ0aW5nIGRlbGl2ZXJ5\nLiIpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBp\nKyspIHsKICAgICAgICAgICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZShn\nZXRUb3BpYyhpKSwgbG9jYWxTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0YWNo\nLkNSRUFURV9PUl9BVFRBQ0gsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwog\nICAgICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAg\nfQoKICAgICAgICAvLyBTdGFydCBkZWxpdmVyeSBmb3IgdGhlIHN1YnNjcmli\nZXIKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsr\nKSB7CiAgICAgICAgICAgIHN0YXJ0RGVsaXZlcnkoZ2V0VG9waWMoaSksIGxv\nY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1\nbWVRdWV1ZSkpOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzaHV0RG93bkxhc3RTZXJ2ZXIoKSB7CiAgICAgICAgaWYgKGxvZ2dlci5p\nc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAgICBsb2dnZXIuZGVidWcoIlNo\ndXR0aW5nIGRvd24gdGhlIGxhc3Qgc2VydmVyIGluIHRoZSBIZWR3aWcgaHVi\nIGNsdXN0ZXIuIik7CiAgICAgICAgc2VydmVyc0xpc3QuZ2V0KHNlcnZlcnNM\naXN0LnNpemUoKSAtIDEpLnNodXRkb3duKCk7CiAgICAgICAgLy8gRHVlIHRv\nIGEgcG9zc2libGUgcmFjZSBjb25kaXRpb24sIGFmdGVyIHdlJ3ZlIHNodXRk\nb3duIHRoZSBzZXJ2ZXIsCiAgICAgICAgLy8gdGhlIGNsaWVudCBjb3VsZCBz\ndGlsbCBiZSBjYWNoaW5nIHRoZSBjaGFubmVsIGNvbm5lY3Rpb24gdG8gdGhh\ndAogICAgICAgIC8vIHNlcnZlci4gSXQgaXMgcG9zc2libGUgZm9yIGEgcHVi\nbGlzaCByZXF1ZXN0IHRvIGdvIHRvIHRoZSBzaHV0ZG93bgogICAgICAgIC8v\nIHNlcnZlciB1c2luZyB0aGUgY2xvc2VkL3NodXRkb3duIGNoYW5uZWwgYmVm\nb3JlIHRoZSBjaGFubmVsCiAgICAgICAgLy8gZGlzY29ubmVjdCBsb2dpYyBr\naWNrcyBpbi4gV2hhdCBjb3VsZCBoYXBwZW4gaXMgdGhhdCB0aGUgcHVibGlz\naAogICAgICAgIC8vIGlzIGRvbmUgc3VjY2Vzc2Z1bGx5IG9uIHRoZSBjaGFu\nbmVsIGJ1dCB0aGUgc2VydmVyIG9uIHRoZSBvdGhlciBlbmQKICAgICAgICAv\nLyBjYW4ndC93b24ndCByZWFkIGl0LiBUaGlzIHB1Ymxpc2ggcmVxdWVzdCB3\naWxsIHRpbWUgb3V0IGFuZCB0aGUKICAgICAgICAvLyBKdW5pdCB0ZXN0IHdp\nbGwgZmFpbC4gU2luY2UgdGhhdCBwYXJ0aWN1bGFyIHNjZW5hcmlvIGlzIG5v\ndCB3aGF0IGlzCiAgICAgICAgLy8gdGVzdGVkIGhlcmUsIHVzZSBhIHdvcmth\ncm91bmQgb2Ygc2xlZXBpbmcgaW4gdGhpcyB0aHJlYWQgKHNvIHRoZQogICAg\nICAgIC8vIGNoYW5uZWwgZGlzY29ubmVjdCBsb2dpYyBjYW4gY29tcGxldGUp\nIGJlZm9yZSB3ZSBwdWJsaXNoIGFnYWluLgogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIFRocmVhZC5zbGVlcCgxMDAwKTsKICAgICAgICB9IGNhdGNoIChJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGxvZ2dlci5l\ncnJvcigiVGhyZWFkIHdhcyBpbnRlcnJ1cHRlZCB3aGlsZSBzbGVlcGluZyBh\nZnRlciBzaHV0dGluZyBkb3duIGxhc3Qgc2VydmVyISIsIGUpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvLyBUaGlzIHRlc3RzIG91dCB0aGUgbWFudWFsIHNl\nbmRpbmcgb2YgY29uc3VtZSBtZXNzYWdlcyB0byB0aGUgc2VydmVyCiAgICAv\nLyBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gdGhlIGF1dG9tYXRpYyBzZW5kaW5n\nIGJ5IHRoZSBjbGllbnQgbGliIGZvciBpdC4KICAgIEBUZXN0CiAgICBwdWJs\naWMgdm9pZCB0ZXN0TWFudWFsQ29uc3VtZUNsaWVudCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIEhlZHdpZ0NsaWVudCBteUNsaWVudCA9IG5ldyBI\nZWR3aWdDbGllbnQobmV3IFRlc3RDbGllbnRDb25maWd1cmF0aW9uKCkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIGJvb2xl\nYW4gaXNBdXRvU2VuZENvbnN1bWVNZXNzYWdlRW5hYmxlZCgpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAg\nICB9KTsKICAgICAgICBTdWJzY3JpYmVyIG15U3Vic2NyaWJlciA9IG15Q2xp\nZW50LmdldFN1YnNjcmliZXIoKTsKICAgICAgICBQdWJsaXNoZXIgbXlQdWJs\naXNoZXIgPSBteUNsaWVudC5nZXRQdWJsaXNoZXIoKTsKICAgICAgICBCeXRl\nU3RyaW5nIG15VG9waWMgPSBnZXRUb3BpYygwKTsKICAgICAgICAvLyBTdWJz\nY3JpYmUgdG8gYSB0b3BpYyBhbmQgc3RhcnQgZGVsaXZlcnkgb24gaXQKICAg\nICAgICBteVN1YnNjcmliZXIuYXN5bmNTdWJzY3JpYmUobXlUb3BpYywgbG9j\nYWxTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRB\nQ0gsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBU\nZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBhc3NlcnRUcnVl\nKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgc3RhcnREZWxpdmVyeShteVN1YnNj\ncmliZXIsIG15VG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1l\nc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIC8vIFB1Ymxp\nc2ggc29tZSBtZXNzYWdlcwogICAgICAgIGludCBiYXRjaFNpemUgPSAxMDsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7\nCiAgICAgICAgICAgIG15UHVibGlzaGVyLmFzeW5jUHVibGlzaChteVRvcGlj\nLCBnZXRNc2coaSksIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsK\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAg\nICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1ZS50YWtlKCkpOwogICAgICAg\nIH0KICAgICAgICAvLyBOb3cgbWFudWFsbHkgc2VuZCBhIGNvbnN1bWUgbWVz\nc2FnZSBmb3IgZWFjaCBtZXNzYWdlIHJlY2VpdmVkCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICBi\nb29sZWFuIHN1Y2Nlc3MgPSB0cnVlOwogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgbXlTdWJzY3JpYmVyLmNvbnN1bWUobXlUb3BpYywgbG9j\nYWxTdWJzY3JpYmVySWQsIE1lc3NhZ2VTZXFJZC5uZXdCdWlsZGVyKCkuc2V0\nTG9jYWxDb21wb25lbnQoaSArIDEpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAuYnVpbGQoKSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKENsaWVudE5vdFN1YnNjcmliZWRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGFzc2VydFRydWUoc3VjY2Vzcyk7CiAgICAgICAgfQogICAgICAgIC8v\nIFNpbmNlIHRoZSBjb25zdW1lIGNhbGwgZXZlbnR1YWxseSBkb2VzIGFuIGFz\neW5jIHdyaXRlIHRvIHRoZSBOZXR0eQogICAgICAgIC8vIGNoYW5uZWwsIHRo\nZSB3cml0aW5nIG9mIHRoZSBjb25zdW1lIHJlcXVlc3RzIG1heSBub3QgaGF2\nZSBjb21wbGV0ZWQKICAgICAgICAvLyB5ZXQgYmVmb3JlIHdlIHN0b3AgdGhl\nIGNsaWVudC4gU2xlZXAgYSBsaXR0bGUgYmVmb3JlIHdlIHN0b3AgdGhlCiAg\nICAgICAgLy8gY2xpZW50IGp1c3Qgc28gZXJyb3IgbWVzc2FnZXMgYXJlIG5v\ndCBsb2dnZWQuCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgVGhyZWFkLnNs\nZWVwKDEwMDApOwogICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJUaHJlYWQgd2Fz\nIGludGVycnVwdGVkIHdoaWxlIHdhaXRpbmcgdG8gc3RvcCBjbGllbnQgZm9y\nIG1hbnVhbCBjb25zdW1lIHRlc3QhISIsIGUpOwogICAgICAgIH0KICAgICAg\nICBteUNsaWVudC5jbG9zZSgpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJs\naWMgdm9pZCB0ZXN0QXR0YWNoVG9TdWJzY3JpcHRpb25TdWNjZXNzKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IGdl\ndFRvcGljKDApOwogICAgICAgIHN1YnNjcmliZXIuYXN5bmNTdWJzY3JpYmUo\ndG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBDcmVhdGVPckF0dGFjaC5DUkVB\nVEVfT1JfQVRUQUNILCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwpOwogICAgICAgIGFz\nc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAvLyBDbG9zZSB0aGUg\nc3Vic2NyaXB0aW9uIGFzeW5jaHJvbm91c2x5CiAgICAgICAgc3Vic2NyaWJl\nci5hc3luY0Nsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBsb2NhbFN1YnNjcmli\nZXJJZCwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAg\nIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAvLyBOb3cgdHJ5\nIHRvIGF0dGFjaCB0byB0aGUgc3Vic2NyaXB0aW9uCiAgICAgICAgc3Vic2Ny\naWJlci5hc3luY1N1YnNjcmliZSh0b3BpYywgbG9jYWxTdWJzY3JpYmVySWQs\nIENyZWF0ZU9yQXR0YWNoLkFUVEFDSCwgbmV3IFRlc3RDYWxsYmFjayhxdWV1\nZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsK\nICAgICAgICAvLyBTdGFydCBkZWxpdmVyeSBhbmQgcHVibGlzaCBzb21lIG1l\nc3NhZ2VzLiBNYWtlIHN1cmUgdGhleSBhcmUgY29uc3VtZWQKICAgICAgICAv\nLyBjb3JyZWN0bHkuCiAgICAgICAgc3RhcnREZWxpdmVyeSh0b3BpYywgbG9j\nYWxTdWJzY3JpYmVySWQsIG5ldyBUZXN0TWVzc2FnZUhhbmRsZXIoY29uc3Vt\nZVF1ZXVlKSk7CiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDU7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAg\nICAgICBwdWJsaXNoZXIuYXN5bmNQdWJsaXNoKHRvcGljLCBnZXRNc2coaSks\nIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKGNvbnN1bWVRdWV1ZS50YWtlKCkpOwogICAgICAgIH0KICAgIH0KCiAg\nICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdFNlcnZlclJlZGlyZWN0KCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDEw\nOwogICAgICAgIHB1Ymxpc2hGaXJzdEJhdGNoKGJhdGNoU2l6ZSwgZmFsc2Up\nOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0U3Vic2Ny\naWJlQW5kQ29uc3VtZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlu\ndCBiYXRjaFNpemUgPSAxMDsKICAgICAgICBzdWJzY3JpYmVUb1RvcGljcyhi\nYXRjaFNpemUpOwogICAgICAgIHB1Ymxpc2hGaXJzdEJhdGNoKGJhdGNoU2l6\nZSwgdHJ1ZSk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRl\nc3RTZXJ2ZXJGYWlsb3ZlclB1Ymxpc2hPbmx5KCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDEwOwogICAgICAgIHB1Ymxp\nc2hGaXJzdEJhdGNoKGJhdGNoU2l6ZSwgZmFsc2UpOwogICAgICAgIHNodXRE\nb3duTGFzdFNlcnZlcigpOwogICAgICAgIHB1Ymxpc2hTZWNvbmRCYXRjaChi\nYXRjaFNpemUsIGZhbHNlKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGlj\nIHZvaWQgdGVzdFNlcnZlckZhaWxvdmVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDEwOwogICAgICAgIHN1YnNjcmli\nZVRvVG9waWNzKGJhdGNoU2l6ZSk7CiAgICAgICAgcHVibGlzaEZpcnN0QmF0\nY2goYmF0Y2hTaXplLCB0cnVlKTsKICAgICAgICBzaHV0RG93bkxhc3RTZXJ2\nZXIoKTsKICAgICAgICBwdWJsaXNoU2Vjb25kQmF0Y2goYmF0Y2hTaXplLCB0\ncnVlKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdFVu\nc3Vic2NyaWJlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0\ncmluZyB0b3BpYyA9IGdldFRvcGljKDApOwogICAgICAgIHN1YnNjcmliZXIu\nYXN5bmNTdWJzY3JpYmUodG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBDcmVh\ndGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNILCBuZXcgVGVzdENhbGxiYWNr\nKHF1ZXVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51\nbGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAg\nICBzdGFydERlbGl2ZXJ5KHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3\nIFRlc3RNZXNzYWdlSGFuZGxlcihjb25zdW1lUXVldWUpKTsKICAgICAgICBw\ndWJsaXNoZXIuYXN5bmNQdWJsaXNoKHRvcGljLCBnZXRNc2coMCksIG5ldyBU\nZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBhc3NlcnRUcnVl\nKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShjb25zdW1lUXVl\ndWUudGFrZSgpKTsKICAgICAgICAvLyBTZW5kIGFuIFVuc3Vic2NyaWJlIHJl\ncXVlc3QKICAgICAgICBzdWJzY3JpYmVyLmFzeW5jVW5zdWJzY3JpYmUodG9w\naWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVl\nKSwgbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwog\nICAgICAgIC8vIE5vdyBwdWJsaXNoIGEgbWVzc2FnZSBhbmQgbWFrZSBzdXJl\nIGl0IGlzIG5vdCBjb25zdW1lZCBieSB0aGUgY2xpZW50CiAgICAgICAgcHVi\nbGlzaGVyLmFzeW5jUHVibGlzaCh0b3BpYywgZ2V0TXNnKDEpLCBuZXcgVGVz\ndENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShx\ndWV1ZS50YWtlKCkpOwogICAgICAgIC8vIFdhaXQgYSBsaXR0bGUgYml0IGp1\nc3QgaW4gY2FzZSB0aGUgbWVzc2FnZSBoYW5kbGVyIGlzIHN0aWxsIGFjdGl2\nZSwKICAgICAgICAvLyBjb25zdW1pbmcgdGhlIG1lc3NhZ2UsIGFuZCB0aGVu\nIHB1dHRpbmcgYSB0cnVlIHZhbHVlIGluIHRoZQogICAgICAgIC8vIGNvbnN1\nbWVRdWV1ZS4KICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAg\nLy8gUHV0IGEgRmFsc2UgdmFsdWUgb24gdGhlIGNvbnN1bWVRdWV1ZSBzbyB3\nZSBjYW4gdmVyaWZ5IHRoYXQgaXQKICAgICAgICAvLyBpcyBub3QgYmxvY2tl\nZCBieSBhIG1lc3NhZ2UgY29uc3VtZSBhY3Rpb24gd2hpY2ggYWxyZWFkeSBw\ndXQgYSBUcnVlCiAgICAgICAgLy8gdmFsdWUgaW50byB0aGUgcXVldWUuCiAg\nICAgICAgbmV3IFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAg\nICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChjb25zdW1lUXVl\ndWUsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLnN0YXJ0KCk7\nCiAgICAgICAgYXNzZXJ0RmFsc2UoY29uc3VtZVF1ZXVlLnRha2UoKSk7CiAg\nICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RTeW5jVW5zdWJz\nY3JpYmVXaXRob3V0U3Vic2NyaXB0aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgYm9vbGVhbiB1bnN1YnNjcmliZVN1Y2Nlc3MgPSBmYWxzZTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBzdWJzY3JpYmVyLnVuc3Vic2Ny\naWJlKGdldFRvcGljKDApLCBsb2NhbFN1YnNjcmliZXJJZCk7CiAgICAgICAg\nfSBjYXRjaCAoQ2xpZW50Tm90U3Vic2NyaWJlZEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIHVuc3Vic2NyaWJlU3VjY2VzcyA9IHRydWU7CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgICAgIHVuc3Vic2Ny\naWJlU3VjY2VzcyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBhc3NlcnRU\ncnVlKHVuc3Vic2NyaWJlU3VjY2Vzcyk7CiAgICB9CgogICAgQFRlc3QKICAg\nIHB1YmxpYyB2b2lkIHRlc3RBc3luY1Vuc3Vic2NyaWJlV2l0aG91dFN1YnNj\ncmlwdGlvbigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1YnNjcmli\nZXIuYXN5bmNVbnN1YnNjcmliZShnZXRUb3BpYygwKSwgbG9jYWxTdWJzY3Jp\nYmVySWQsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAg\nICBhc3NlcnRGYWxzZShxdWV1ZS50YWtlKCkpOwogICAgfQoKICAgIEBUZXN0\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2xvc2VTdWJzY3JpcHRpb24oKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5nIHRvcGljID0gZ2V0\nVG9waWMoMCk7CiAgICAgICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZSh0\nb3BpYywgbG9jYWxTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0YWNoLkNSRUFU\nRV9PUl9BVFRBQ0gsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIHN0YXJ0RGVsaXZlcnko\ndG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1lc3NhZ2VIYW5k\nbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIHB1Ymxpc2hlci5hc3luY1B1\nYmxpc2godG9waWMsIGdldE1zZygwKSwgbmV3IFRlc3RDYWxsYmFjayhxdWV1\nZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsK\nICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1ZS50YWtlKCkpOwogICAg\nICAgIC8vIENsb3NlIHRoZSBzdWJzY3JpcHRpb24gYXN5bmNocm9ub3VzbHkK\nICAgICAgICBzdWJzY3JpYmVyLmFzeW5jQ2xvc2VTdWJzY3JpcHRpb24odG9w\naWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVl\nKSwgbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwog\nICAgICAgIC8vIE5vdyBwdWJsaXNoIGEgbWVzc2FnZSBhbmQgbWFrZSBzdXJl\nIGl0IGlzIG5vdCBjb25zdW1lZCBieSB0aGUgY2xpZW50CiAgICAgICAgcHVi\nbGlzaGVyLmFzeW5jUHVibGlzaCh0b3BpYywgZ2V0TXNnKDEpLCBuZXcgVGVz\ndENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShx\ndWV1ZS50YWtlKCkpOwogICAgICAgIC8vIFdhaXQgYSBsaXR0bGUgYml0IGp1\nc3QgaW4gY2FzZSB0aGUgbWVzc2FnZSBoYW5kbGVyIGlzIHN0aWxsIGFjdGl2\nZSwKICAgICAgICAvLyBjb25zdW1pbmcgdGhlIG1lc3NhZ2UsIGFuZCB0aGVu\nIHB1dHRpbmcgYSB0cnVlIHZhbHVlIGluIHRoZQogICAgICAgIC8vIGNvbnN1\nbWVRdWV1ZS4KICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAg\nLy8gUHV0IGEgRmFsc2UgdmFsdWUgb24gdGhlIGNvbnN1bWVRdWV1ZSBzbyB3\nZSBjYW4gdmVyaWZ5IHRoYXQgaXQKICAgICAgICAvLyBpcyBub3QgYmxvY2tl\nZCBieSBhIG1lc3NhZ2UgY29uc3VtZSBhY3Rpb24gd2hpY2ggYWxyZWFkeSBw\ndXQgYSBUcnVlCiAgICAgICAgLy8gdmFsdWUgaW50byB0aGUgcXVldWUuCiAg\nICAgICAgbmV3IFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAg\nICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChjb25zdW1lUXVl\ndWUsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLnN0YXJ0KCk7\nCiAgICAgICAgYXNzZXJ0RmFsc2UoY29uc3VtZVF1ZXVlLnRha2UoKSk7CiAg\nICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RTdG9wRGVsaXZl\ncnkoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5nIHRv\ncGljID0gZ2V0VG9waWMoMCk7CiAgICAgICAgc3Vic2NyaWJlci5hc3luY1N1\nYnNjcmliZSh0b3BpYywgbG9jYWxTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0\nYWNoLkNSRUFURV9PUl9BVFRBQ0gsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUp\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCk7CiAg\nICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIHN0YXJ0\nRGVsaXZlcnkodG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1l\nc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIHB1Ymxpc2hl\nci5hc3luY1B1Ymxpc2godG9waWMsIGdldE1zZygwKSwgbmV3IFRlc3RDYWxs\nYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUu\ndGFrZSgpKTsKICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1ZS50YWtl\nKCkpOwogICAgICAgIC8vIFN0b3AgdGhlIGRlbGl2ZXJ5IGZvciB0aGlzIHN1\nYnNjcmlwdGlvbgogICAgICAgIHN1YnNjcmliZXIuc3RvcERlbGl2ZXJ5KHRv\ncGljLCBsb2NhbFN1YnNjcmliZXJJZCk7CiAgICAgICAgLy8gUHVibGlzaCBz\nb21lIG1vcmUgbWVzc2FnZXMgc28gdGhleSBhcmUgcXVldWVkIHVwIHRvIGJl\nIGRlbGl2ZXJlZCB0bwogICAgICAgIC8vIHRoZSBjbGllbnQKICAgICAgICBp\nbnQgYmF0Y2hTaXplID0gMTA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBiYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICBwdWJsaXNoZXIuYXN5\nbmNQdWJsaXNoKHRvcGljLCBnZXRNc2coaSArIDEpLCBuZXcgVGVzdENhbGxi\nYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgIGFzc2VydFRydWUocXVl\ndWUudGFrZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gV2FpdCBhIGxpdHRs\nZSBiaXQganVzdCBpbiBjYXNlIHRoZSBtZXNzYWdlIGhhbmRsZXIgaXMgc3Rp\nbGwgYWN0aXZlLAogICAgICAgIC8vIGNvbnN1bWluZyB0aGUgbWVzc2FnZSwg\nYW5kIHRoZW4gcHV0dGluZyBhIHRydWUgdmFsdWUgaW4gdGhlCiAgICAgICAg\nLy8gY29uc3VtZVF1ZXVlLgogICAgICAgIFRocmVhZC5zbGVlcCgxMDAwKTsK\nICAgICAgICAvLyBQdXQgYSBGYWxzZSB2YWx1ZSBvbiB0aGUgY29uc3VtZVF1\nZXVlIHNvIHdlIGNhbiB2ZXJpZnkgdGhhdCBpdAogICAgICAgIC8vIGlzIG5v\ndCBibG9ja2VkIGJ5IGEgbWVzc2FnZSBjb25zdW1lIGFjdGlvbiB3aGljaCBh\nbHJlYWR5IHB1dCBhIFRydWUKICAgICAgICAvLyB2YWx1ZSBpbnRvIHRoZSBx\ndWV1ZS4KICAgICAgICBuZXcgVGhyZWFkKG5ldyBSdW5uYWJsZSgpIHsKICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1\nbigpIHsKICAgICAgICAgICAgICAgIENvbmN1cnJlbmN5VXRpbHMucHV0KGNv\nbnN1bWVRdWV1ZSwgZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfSku\nc3RhcnQoKTsKICAgICAgICBhc3NlcnRGYWxzZShjb25zdW1lUXVldWUudGFr\nZSgpKTsKICAgICAgICAvLyBOb3cgc3RhcnQgZGVsaXZlcnkgYWdhaW4gYW5k\nIHZlcmlmeSB0aGF0IHRoZSBxdWV1ZWQgdXAgbWVzc2FnZXMgYXJlCiAgICAg\nICAgLy8gY29uc3VtZWQKICAgICAgICBzdGFydERlbGl2ZXJ5KHRvcGljLCBs\nb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRlc3RNZXNzYWdlSGFuZGxlcihjb25z\ndW1lUXVldWUpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNo\nU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoY29uc3VtZVF1\nZXVlLnRha2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIEBUZXN0CiAgICBw\ndWJsaWMgdm9pZCB0ZXN0Q29uc3VtZWRNZXNzYWdlc0luT3JkZXIoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5nIHRvcGljID0gZ2V0\nVG9waWMoMCk7CiAgICAgICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZSh0\nb3BpYywgbG9jYWxTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0YWNoLkNSRUFU\nRV9PUl9BVFRBQ0gsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIHN0YXJ0RGVsaXZlcnko\ndG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1lc3NhZ2VIYW5k\nbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIC8vIE5vdyBwdWJsaXNoIHNv\nbWUgbWVzc2FnZXMgYW5kIHZlcmlmeSB0aGF0IHRoZXkgYXJlIGRlbGl2ZXJl\nZCBpbiBvcmRlcgogICAgICAgIC8vIHRvIHRoZSBzdWJzY3JpYmVyCiAgICAg\nICAgaW50IGJhdGNoU2l6ZSA9IDEwMDsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIHB1Ymxpc2hl\nci5hc3luY1B1Ymxpc2godG9waWMsIGdldE1zZyhpKSwgbmV3IFRlc3RDYWxs\nYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIH0KICAgICAgICAvLyBXZSd2\nZSBzZW50IG91dCBhbGwgb2YgdGhlIHB1Ymxpc2ggbWVzc2FnZXMgYXN5bmNo\ncm9ub3VzbHksCiAgICAgICAgLy8gbm93IHZlcmlmeSB0aGF0IHRoZXkgYXJl\nIGNvbnN1bWVkIGluIHRoZSBjb3JyZWN0IG9yZGVyLgogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKGNvbnN1bWVRdWV1ZS50YWtlKCkpOwogICAgICAgIH0KICAgIH0KCiAg\nICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdENyZWF0ZVN1YnNjcmlwdGlv\nbkZhaWx1cmUoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3Ry\naW5nIHRvcGljID0gZ2V0VG9waWMoMCk7CiAgICAgICAgc3Vic2NyaWJlci5h\nc3luY1N1YnNjcmliZSh0b3BpYywgbG9jYWxTdWJzY3JpYmVySWQsIENyZWF0\nZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gsIG5ldyBUZXN0Q2FsbGJhY2so\ncXVldWUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVs\nbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAg\nIC8vIENsb3NlIHRoZSBzdWJzY3JpcHRpb24gYXN5bmNocm9ub3VzbHkKICAg\nICAgICBzdWJzY3JpYmVyLmFzeW5jQ2xvc2VTdWJzY3JpcHRpb24odG9waWMs\nIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwg\nbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAg\nICAgIC8vIE5vdyB0cnkgdG8gY3JlYXRlIHRoZSBzdWJzY3JpcHRpb24gd2hl\nbiBpdCBhbHJlYWR5IGV4aXN0cwogICAgICAgIHN1YnNjcmliZXIuYXN5bmNT\ndWJzY3JpYmUodG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBDcmVhdGVPckF0\ndGFjaC5DUkVBVEUsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsK\nICAgICAgICBhc3NlcnRGYWxzZShxdWV1ZS50YWtlKCkpOwogICAgfQoKICAg\nIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0Q3JlYXRlU3Vic2NyaXB0aW9u\nU3VjY2VzcygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVTdHJp\nbmcgdG9waWMgPSBnZXRUb3BpYygwKTsKICAgICAgICBzdWJzY3JpYmVyLmFz\neW5jU3Vic2NyaWJlKHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgQ3JlYXRl\nT3JBdHRhY2guQ1JFQVRFLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVs\nbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAg\nIHN0YXJ0RGVsaXZlcnkodG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcg\nVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIGlu\ndCBiYXRjaFNpemUgPSA1OwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAgcHVibGlzaGVyLmFzeW5j\nUHVibGlzaCh0b3BpYywgZ2V0TXNnKGkpLCBuZXcgVGVzdENhbGxiYWNrKHF1\nZXVlKSwgbnVsbCk7CiAgICAgICAgICAgIGFzc2VydFRydWUocXVldWUudGFr\nZSgpKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShjb25zdW1lUXVldWUudGFr\nZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2\nb2lkIHRlc3RBdHRhY2hUb1N1YnNjcmlwdGlvbkZhaWx1cmUoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5nIHRvcGljID0gZ2V0VG9w\naWMoMCk7CiAgICAgICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZSh0b3Bp\nYywgbG9jYWxTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0YWNoLkFUVEFDSCwg\nbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2Vy\ndEZhbHNlKHF1ZXVlLnRha2UoKSk7CiAgICB9CgogICAgLy8gVGhlIGZvbGxv\nd2luZyA0IHRlc3RzIGFyZSB0byBtYWtlIHN1cmUgdGhhdCB0aGUgc3Vic2Ny\naWJlcklkIHZhbGlkYXRpb24KICAgIC8vIHdvcmtzIHdoZW4gaXQgaXMgYSBs\nb2NhbCBzdWJzY3JpYmVyIGFuZCB3ZSdyZSBleHBlY3RpbmcgdGhlIHN1YnNj\ncmliZXJJZAogICAgLy8gdG8gYmUgaW4gdGhlICJsb2NhbCIgc3BlY2lmaWMg\nZm9ybWF0LgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RTeW5jU3Vi\nc2NyaWJlV2l0aEludmFsaWRTdWJzY3JpYmVySWQoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBib29sZWFuIHN1YnNjcmliZVN1Y2Nlc3MgPSBmYWxz\nZTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzdWJzY3JpYmVyLnN1YnNj\ncmliZShnZXRUb3BpYygwKSwgaHViU3Vic2NyaWJlcklkLCBDcmVhdGVPckF0\ndGFjaC5DUkVBVEVfT1JfQVRUQUNIKTsKICAgICAgICB9IGNhdGNoIChJbnZh\nbGlkU3Vic2NyaWJlcklkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgc3Vi\nc2NyaWJlU3VjY2VzcyA9IHRydWU7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGV4KSB7CiAgICAgICAgICAgIHN1YnNjcmliZVN1Y2Nlc3MgPSBmYWxz\nZTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0VHJ1ZShzdWJzY3JpYmVTdWNj\nZXNzKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEFz\neW5jU3Vic2NyaWJlV2l0aEludmFsaWRTdWJzY3JpYmVySWQoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBzdWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJl\nKGdldFRvcGljKDApLCBodWJTdWJzY3JpYmVySWQsIENyZWF0ZU9yQXR0YWNo\nLkNSRUFURV9PUl9BVFRBQ0gsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAg\nICAgYXNzZXJ0RmFsc2UocXVldWUudGFrZSgpKTsKICAgIH0KCiAgICBAVGVz\ndAogICAgcHVibGljIHZvaWQgdGVzdFN5bmNVbnN1YnNjcmliZVdpdGhJbnZh\nbGlkU3Vic2NyaWJlcklkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nYm9vbGVhbiB1bnN1YnNjcmliZVN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBzdWJzY3JpYmVyLnVuc3Vic2NyaWJlKGdldFRv\ncGljKDApLCBodWJTdWJzY3JpYmVySWQpOwogICAgICAgIH0gY2F0Y2ggKElu\ndmFsaWRTdWJzY3JpYmVySWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICB1\nbnN1YnNjcmliZVN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBleCkgewogICAgICAgICAgICB1bnN1YnNjcmliZVN1Y2Nlc3Mg\nPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0VHJ1ZSh1bnN1YnNj\ncmliZVN1Y2Nlc3MpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9p\nZCB0ZXN0QXN5bmNVbnN1YnNjcmliZVdpdGhJbnZhbGlkU3Vic2NyaWJlcklk\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3Vic2NyaWJlci5hc3lu\nY1Vuc3Vic2NyaWJlKGdldFRvcGljKDApLCBodWJTdWJzY3JpYmVySWQsIG5l\ndyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBhc3NlcnRG\nYWxzZShxdWV1ZS50YWtlKCkpOwogICAgfQoKICAgIC8vIFRoZSBmb2xsb3dp\nbmcgNCB0ZXN0cyBhcmUgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIHN1YnNjcmli\nZXJJZCB2YWxpZGF0aW9uCiAgICAvLyBhbHNvIHdvcmtzIHdoZW4gaXQgaXMg\nYSBodWIgc3Vic2NyaWJlciBhbmQgd2UncmUgZXhwZWN0aW5nIHRoZQogICAg\nLy8gc3Vic2NyaWJlcklkIHRvIGJlIGluIHRoZSAiaHViIiBzcGVjaWZpYyBm\nb3JtYXQuCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdFN5bmNIdWJT\ndWJzY3JpYmVXaXRoSW52YWxpZFN1YnNjcmliZXJJZCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIENsaWVudCBodWJDbGllbnQgPSBuZXcgSGVkd2ln\nSHViQ2xpZW50KG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCkpOwogICAgICAg\nIFN1YnNjcmliZXIgaHViU3Vic2NyaWJlciA9IGh1YkNsaWVudC5nZXRTdWJz\nY3JpYmVyKCk7CiAgICAgICAgYm9vbGVhbiBzdWJzY3JpYmVTdWNjZXNzID0g\nZmFsc2U7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaHViU3Vic2NyaWJl\nci5zdWJzY3JpYmUoZ2V0VG9waWMoMCksIGxvY2FsU3Vic2NyaWJlcklkLCBD\ncmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKTsKICAgICAgICB9IGNh\ndGNoIChJbnZhbGlkU3Vic2NyaWJlcklkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgc3Vic2NyaWJlU3VjY2VzcyA9IHRydWU7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgICAgIHN1YnNjcmliZVN1Y2Nl\nc3MgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0VHJ1ZShzdWJz\nY3JpYmVTdWNjZXNzKTsKICAgICAgICBodWJDbGllbnQuY2xvc2UoKTsKICAg\nIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEFzeW5jSHViU3Vi\nc2NyaWJlV2l0aEludmFsaWRTdWJzY3JpYmVySWQoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBDbGllbnQgaHViQ2xpZW50ID0gbmV3IEhlZHdpZ0h1\nYkNsaWVudChuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpKTsKICAgICAgICBT\ndWJzY3JpYmVyIGh1YlN1YnNjcmliZXIgPSBodWJDbGllbnQuZ2V0U3Vic2Ny\naWJlcigpOwogICAgICAgIGh1YlN1YnNjcmliZXIuYXN5bmNTdWJzY3JpYmUo\nZ2V0VG9waWMoMCksIGxvY2FsU3Vic2NyaWJlcklkLCBDcmVhdGVPckF0dGFj\naC5DUkVBVEVfT1JfQVRUQUNILCBuZXcgVGVzdENhbGxiYWNrKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlKSwgbnVs\nbCk7CiAgICAgICAgYXNzZXJ0RmFsc2UocXVldWUudGFrZSgpKTsKICAgICAg\nICBodWJDbGllbnQuY2xvc2UoKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVi\nbGljIHZvaWQgdGVzdFN5bmNIdWJVbnN1YnNjcmliZVdpdGhJbnZhbGlkU3Vi\nc2NyaWJlcklkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xpZW50\nIGh1YkNsaWVudCA9IG5ldyBIZWR3aWdIdWJDbGllbnQobmV3IENsaWVudENv\nbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgU3Vic2NyaWJlciBodWJTdWJzY3Jp\nYmVyID0gaHViQ2xpZW50LmdldFN1YnNjcmliZXIoKTsKICAgICAgICBib29s\nZWFuIHVuc3Vic2NyaWJlU3VjY2VzcyA9IGZhbHNlOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGh1YlN1YnNjcmliZXIudW5zdWJzY3JpYmUoZ2V0VG9w\naWMoMCksIGxvY2FsU3Vic2NyaWJlcklkKTsKICAgICAgICB9IGNhdGNoIChJ\nbnZhbGlkU3Vic2NyaWJlcklkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\ndW5zdWJzY3JpYmVTdWNjZXNzID0gdHJ1ZTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZXgpIHsKICAgICAgICAgICAgdW5zdWJzY3JpYmVTdWNjZXNz\nID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGFzc2VydFRydWUodW5zdWJz\nY3JpYmVTdWNjZXNzKTsKICAgICAgICBodWJDbGllbnQuY2xvc2UoKTsKICAg\nIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEFzeW5jSHViVW5z\ndWJzY3JpYmVXaXRoSW52YWxpZFN1YnNjcmliZXJJZCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIENsaWVudCBodWJDbGllbnQgPSBuZXcgSGVkd2ln\nSHViQ2xpZW50KG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCkpOwogICAgICAg\nIFN1YnNjcmliZXIgaHViU3Vic2NyaWJlciA9IGh1YkNsaWVudC5nZXRTdWJz\nY3JpYmVyKCk7CiAgICAgICAgaHViU3Vic2NyaWJlci5hc3luY1Vuc3Vic2Ny\naWJlKGdldFRvcGljKDApLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRlc3RD\nYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydEZhbHNlKHF1\nZXVlLnRha2UoKSk7CiAgICAgICAgaHViQ2xpZW50LmNsb3NlKCk7CiAgICB9\nCgp9Cg==\n","encoding":"base64"}

