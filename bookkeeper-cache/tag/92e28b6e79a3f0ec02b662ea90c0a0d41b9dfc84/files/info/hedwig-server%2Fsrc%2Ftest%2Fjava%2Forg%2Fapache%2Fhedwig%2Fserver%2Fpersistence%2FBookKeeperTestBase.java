{"sha":"ac2d61e5713c7427d6c22f0d3c1ad51ff32dec62","node_id":"MDQ6QmxvYjE1NzU5NTY6YWMyZDYxZTU3MTNjNzQyN2Q2YzIyZjBkM2MxYWQ1MWZmMzJkZWM2Mg==","size":5557,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ac2d61e5713c7427d6c22f0d3c1ad51ff32dec62","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZExp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5S\nYW5kb207CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xp\nZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2llU2VydmVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuQ3JlYXRlTW9kZTsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLlpvb0RlZnMuSWRzOwppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwpp\nbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0\nOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuRmlsZVV0aWxzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuem9va2VlcGVyLlpvb0tlZXBlclRl\nc3RCYXNlOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5z\nbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFRoaXMgaXMgYSBiYXNlIGNs\nYXNzIGZvciBhbnkgdGVzdHMgdGhhdCByZXF1aXJlIGEgQm9va0tlZXBlciBj\nbGllbnQvc2VydmVyCiAqIHNldHVwLgogKgogKi8KcHVibGljIGNsYXNzIEJv\nb2tLZWVwZXJUZXN0QmFzZSBleHRlbmRzIFpvb0tlZXBlclRlc3RCYXNlIHsK\nICAgIHByaXZhdGUgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5\nLmdldExvZ2dlcihCb29rS2VlcGVyVGVzdEJhc2UuY2xhc3MpOwoKICAgIC8v\nIEJvb2tLZWVwZXIgU2VydmVyIHZhcmlhYmxlcwogICAgcHJpdmF0ZSBMaXN0\nPEJvb2tpZVNlcnZlcj4gYm9va2llc0xpc3Q7CiAgICBwcml2YXRlIGludCBp\nbml0aWFsUG9ydCA9IDUwMDA7CiAgICBwcml2YXRlIGludCBuZXh0UG9ydCA9\nIGluaXRpYWxQb3J0OwoKICAgIC8vIFN0cmluZyBjb25zdGFudHMgdXNlZCBm\nb3IgY3JlYXRpbmcgdGhlIGJvb2tpZSBzZXJ2ZXIgZmlsZXMuCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUFJFRklYID0gImJvb2tpZSI7CiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgU1VGRklYID0gInRlc3Qi\nOwoKICAgIC8vIFZhcmlhYmxlIHRvIGRlY2lkZSBob3cgbWFueSBib29raWUg\nc2VydmVycyB0byBzZXQgdXAuCiAgICBwcml2YXRlIGZpbmFsIGludCBudW1C\nb29raWVzOwogICAgLy8gQm9va0tlZXBlciBjbGllbnQgaW5zdGFuY2UKICAg\nIHByb3RlY3RlZCBCb29rS2VlcGVyIGJrOwoKICAgIHByb3RlY3RlZCBTZXJ2\nZXJDb25maWd1cmF0aW9uIGJhc2VDb25mID0gbmV3IFNlcnZlckNvbmZpZ3Vy\nYXRpb24oKTsKICAgIHByb3RlY3RlZCBDbGllbnRDb25maWd1cmF0aW9uIGJh\nc2VDbGllbnRDb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKCiAg\nICAvLyBDb25zdHJ1Y3RvcgogICAgcHVibGljIEJvb2tLZWVwZXJUZXN0QmFz\nZShpbnQgbnVtQm9va2llcykgewogICAgICAgIHRoaXMubnVtQm9va2llcyA9\nIG51bUJvb2tpZXM7CiAgICB9CgogICAgcHVibGljIEJvb2tLZWVwZXJUZXN0\nQmFzZSgpIHsKICAgICAgICAvLyBCeSBkZWZhdWx0LCB1c2UgMyBib29raWVz\nLgogICAgICAgIHRoaXMoMyk7CiAgICB9CgogICAgLy8gR2V0dGVyIGZvciB0\naGUgWm9vS2VlcGVyIGNsaWVudCBpbnN0YW5jZSB0aGF0IHRoZSBwYXJlbnQg\nY2xhc3Mgc2V0cyB1cC4KICAgIHByb3RlY3RlZCBab29LZWVwZXIgZ2V0Wm9v\nS2VlcGVyQ2xpZW50KCkgewogICAgICAgIHJldHVybiB6azsKICAgIH0KCiAg\nICAvLyBHaXZlIGp1bml0IGEgZmFrZSB0ZXN0IHNvIHRoYXQgaXRzIGhhcHB5\nCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdE5vdGhpbmcoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBAQmVm\nb3JlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgLy8gSW5pdGlhbGl6\nZSB0aGUgemsgY2xpZW50IHdpdGggdmFsdWVzCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgemsuY3JlYXRlKCIvbGVkZ2VycyIsIG5ldyBieXRlWzBdLCBJ\nZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwog\nICAgICAgICAgICB6ay5jcmVhdGUoIi9sZWRnZXJzL2F2YWlsYWJsZSIsIG5l\ndyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBF\nUlNJU1RFTlQpOwogICAgICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3Igc2V0dGluZyB1cCIs\nIGUpOwogICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJvciBzZXR0aW5nIHVwIiwg\nZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBDcmVhdGUgQm9va2llIFNlcnZl\ncnMKICAgICAgICBib29raWVzTGlzdCA9IG5ldyBMaW5rZWRMaXN0PEJvb2tp\nZVNlcnZlcj4oKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1C\nb29raWVzOyBpKyspIHsKICAgICAgICAgICAgc3RhcnRVcE5ld0Jvb2tpZVNl\ncnZlcigpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIHRoZSBCb29r\nS2VlcGVyIGNsaWVudAogICAgICAgIGJrID0gbmV3IEJvb2tLZWVwZXIoaG9z\ndFBvcnQpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0WmtIb3N0UG9y\ndCgpIHsKICAgICAgICByZXR1cm4gaG9zdFBvcnQ7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBAQWZ0ZXIKICAgIHB1YmxpYyB2b2lkIHRlYXJEb3duKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gU2h1dGRvd24gYWxsIG9m\nIHRoZSBib29raWUgc2VydmVycwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGZvciAoQm9va2llU2VydmVyIGJzIDogYm9va2llc0xpc3QpIHsKICAgICAg\nICAgICAgICAgIGJzLnNodXRkb3duKCk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIExPRy5lcnJvcigiRXJyb3IgdGVhcmluZyBkb3duIiwgZSk7CiAgICAg\nICAgfQogICAgICAgIC8vIENsb3NlIHRoZSBCb29rS2VlcGVyIGNsaWVudAog\nICAgICAgIGJrLmNsb3NlKCk7CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsK\nICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVhckRvd25PbmVCb29raWVT\nZXJ2ZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBSYW5kb20gciA9\nIG5ldyBSYW5kb20oKTsKICAgICAgICBpbnQgYmkgPSByLm5leHRJbnQoYm9v\na2llc0xpc3Quc2l6ZSgpKTsKICAgICAgICBCb29raWVTZXJ2ZXIgYnMgPSBi\nb29raWVzTGlzdC5nZXQoYmkpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGJzLnNodXRkb3duKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRF\neGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHRl\nYXJpbmcgZG93biIsIGUpOwogICAgICAgIH0KICAgICAgICBib29raWVzTGlz\ndC5yZW1vdmUoYmkpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBzdGFy\ndFVwTmV3Qm9va2llU2VydmVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgRmlsZSB0bXBEaXIgPSBGaWxlVXRpbHMuY3JlYXRlVGVtcERpcmVjdG9y\neSgKICAgICAgICAgICAgICAgIFBSRUZJWCArIChuZXh0UG9ydCAtIGluaXRp\nYWxQb3J0KSwgU1VGRklYKTsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9u\nIGNvbmYgPSBuZXdTZXJ2ZXJDb25maWd1cmF0aW9uKAogICAgICAgICAgICAg\nICAgbmV4dFBvcnQrKywgaG9zdFBvcnQsIHRtcERpciwgbmV3IEZpbGVbXSB7\nIHRtcERpciB9KTsKICAgICAgICBCb29raWVTZXJ2ZXIgYnMgPSBuZXcgQm9v\na2llU2VydmVyKGNvbmYpOwogICAgICAgIGJzLnN0YXJ0KCk7CiAgICAgICAg\nYm9va2llc0xpc3QuYWRkKGJzKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgU2Vy\ndmVyQ29uZmlndXJhdGlvbiBuZXdTZXJ2ZXJDb25maWd1cmF0aW9uKGludCBw\nb3J0LCBTdHJpbmcgemtTZXJ2ZXJzLCBGaWxlIGpvdXJuYWxEaXIsIEZpbGVb\nXSBsZWRnZXJEaXJzKSB7CiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBj\nb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmFzZUNvbmYpOwogICAg\nICAgIGNvbmYuc2V0Qm9va2llUG9ydChwb3J0KTsKICAgICAgICBjb25mLnNl\ndFprU2VydmVycyh6a1NlcnZlcnMpOwogICAgICAgIGNvbmYuc2V0Sm91cm5h\nbERpck5hbWUoam91cm5hbERpci5nZXRQYXRoKCkpOwogICAgICAgIFN0cmlu\nZ1tdIGxlZGdlckRpck5hbWVzID0gbmV3IFN0cmluZ1tsZWRnZXJEaXJzLmxl\nbmd0aF07CiAgICAgICAgZm9yIChpbnQgaT0wOyBpPGxlZGdlckRpcnMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgbGVkZ2VyRGlyTmFtZXNbaV0gPSBs\nZWRnZXJEaXJzW2ldLmdldFBhdGgoKTsKICAgICAgICB9CiAgICAgICAgY29u\nZi5zZXRMZWRnZXJEaXJOYW1lcyhsZWRnZXJEaXJOYW1lcyk7CiAgICAgICAg\ncmV0dXJuIGNvbmY7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

