{"sha":"47c70307ed0489c6c1684a23ff657079ad6e441e","node_id":"MDQ6QmxvYjE1NzU5NTY6NDdjNzAzMDdlZDA0ODljNmMxNjg0YTIzZmY2NTcwNzlhZDZlNDQxZQ==","size":5095,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/47c70307ed0489c6c1684a23ff657079ad6e441e","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuUmFuZG9t\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2\naWNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0Q2FzZTsKCmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7Cmlt\ncG9ydCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVmb3Jl\nOwppbXBvcnQgb3JnLmp1bml0LlRlc3Q7CgppbXBvcnQgY29tLmdvb2dsZS5w\ncm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nSGVscGVyTWV0aG9kczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLlN0dWJD\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1\nYlN1YlByb3RvY29sLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5zZXJ2ZXIuY29tbW9uLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzLlRvcGljTWFuYWdlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci50b3BpY3MuVHJpdmlh\nbE93bkFsbFRvcGljTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnV0aWwuQ29uY3VycmVuY3lVdGlsczsKCnB1YmxpYyBjbGFzcyBUZXN0Qm9v\na2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcldoaXRlQm94IGV4dGVuZHMgVGVz\ndENhc2UgewoKICAgIEJvb2tLZWVwZXJUZXN0QmFzZSBia3RiOwogICAgcHJp\ndmF0ZSBmaW5hbCBpbnQgbnVtQm9va2llcyA9IDM7CiAgICBCb29ra2VlcGVy\nUGVyc2lzdGVuY2VNYW5hZ2VyIGJrcG07CiAgICBTZXJ2ZXJDb25maWd1cmF0\naW9uIGNvbmY7CiAgICBTY2hlZHVsZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1\nbGVyOwogICAgVG9waWNNYW5hZ2VyIHRtOwogICAgQnl0ZVN0cmluZyB0b3Bp\nYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0b3BpYzAiKTsKCiAgICBA\nT3ZlcnJpZGUKICAgIEBCZWZvcmUKICAgIHByb3RlY3RlZCB2b2lkIHNldFVw\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoKTsK\nICAgICAgICBia3RiID0gbmV3IEJvb2tLZWVwZXJUZXN0QmFzZShudW1Cb29r\naWVzKTsKICAgICAgICBia3RiLnNldFVwKCk7CgogICAgICAgIGNvbmYgPSBu\nZXcgU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAgIHNjaGVkdWxlciA9\nIEV4ZWN1dG9ycy5uZXdTY2hlZHVsZWRUaHJlYWRQb29sKDEpOwogICAgICAg\nIHRtID0gbmV3IFRyaXZpYWxPd25BbGxUb3BpY01hbmFnZXIoY29uZiwgc2No\nZWR1bGVyKTsKCiAgICAgICAgYmtwbSA9IG5ldyBCb29ra2VlcGVyUGVyc2lz\ndGVuY2VNYW5hZ2VyKGJrdGIuYmssIGJrdGIuZ2V0Wm9vS2VlcGVyQ2xpZW50\nKCksIHRtLCBjb25mLCBzY2hlZHVsZXIpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgQEFmdGVyCiAgICBwcm90ZWN0ZWQgdm9pZCB0ZWFyRG93bigpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGJrdGIudGVhckRvd24oKTsKICAg\nICAgICBzdXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIEBUZXN0CiAgICBw\ndWJsaWMgdm9pZCB0ZXN0RW1wdHlEaXJ0eUxlZGdlcigpIHRocm93cyBFeGNl\ncHRpb24gewoKICAgICAgICBTdHViQ2FsbGJhY2s8Vm9pZD4gc3R1YkNhbGxi\nYWNrID0gbmV3IFN0dWJDYWxsYmFjazxWb2lkPigpOwogICAgICAgIGJrcG0u\nYWNxdWlyZWRUb3BpYyh0b3BpYywgc3R1YkNhbGxiYWNrLCBudWxsKTsKICAg\nICAgICBhc3NlcnROdWxsKENvbmN1cnJlbmN5VXRpbHMudGFrZShzdHViQ2Fs\nbGJhY2sucXVldWUpLnJpZ2h0KCkpOwogICAgICAgIC8vIG5vdyBhYmFuZG9u\nLCBhbmQgdHJ5IGFub3RoZXIgdGltZSwgdGhlIHByZXYgbGVkZ2VyIHNob3Vs\nZCBiZSBkaXJ0eQoKICAgICAgICBia3BtID0gbmV3IEJvb2trZWVwZXJQZXJz\naXN0ZW5jZU1hbmFnZXIobmV3IEJvb2tLZWVwZXIoYmt0Yi5nZXRaa0hvc3RQ\nb3J0KCkpLCBia3RiLmdldFpvb0tlZXBlckNsaWVudCgpLCB0bSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u\nZiwgc2NoZWR1bGVyKTsKICAgICAgICBia3BtLmFjcXVpcmVkVG9waWModG9w\naWMsIHN0dWJDYWxsYmFjaywgbnVsbCk7CiAgICAgICAgYXNzZXJ0TnVsbChD\nb25jdXJyZW5jeVV0aWxzLnRha2Uoc3R1YkNhbGxiYWNrLnF1ZXVlKS5yaWdo\ndCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMCwgYmtwbS50b3BpY0luZm9z\nLmdldCh0b3BpYykubGVkZ2VyUmFuZ2VzLnNpemUoKSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdGVzdE5vbkVtcHR5RGlydHlMZWRnZXIoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKCiAgICAgICAgUmFuZG9tIHIgPSBuZXcgUmFuZG9tKCk7\nCiAgICAgICAgaW50IE5VTV9NRVNTQUdFU19UT19URVNUID0gMTAwOwogICAg\nICAgIGludCBTSVpFX09GX01FU1NBR0VTX1RPX1RFU1QgPSAxMDA7CiAgICAg\nICAgaW50IGluZGV4ID0gMDsKICAgICAgICBpbnQgbnVtUHJldkxlZGdlcnMg\nPSAwOwogICAgICAgIExpc3Q8TWVzc2FnZT4gbWVzc2FnZXMgPSBIZWxwZXJN\nZXRob2RzLmdldFJhbmRvbVB1Ymxpc2hlZE1lc3NhZ2VzKE5VTV9NRVNTQUdF\nU19UT19URVNULAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBT\nSVpFX09GX01FU1NBR0VTX1RPX1RFU1QpOwoKICAgICAgICB3aGlsZSAoaW5k\nZXggPCBtZXNzYWdlcy5zaXplKCkpIHsKCiAgICAgICAgICAgIFN0dWJDYWxs\nYmFjazxWb2lkPiBzdHViQ2FsbGJhY2sgPSBuZXcgU3R1YkNhbGxiYWNrPFZv\naWQ+KCk7CiAgICAgICAgICAgIGJrcG0uYWNxdWlyZWRUb3BpYyh0b3BpYywg\nc3R1YkNhbGxiYWNrLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0TnVsbChD\nb25jdXJyZW5jeVV0aWxzLnRha2Uoc3R1YkNhbGxiYWNrLnF1ZXVlKS5yaWdo\ndCgpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKG51bVByZXZMZWRnZXJz\nLCBia3BtLnRvcGljSW5mb3MuZ2V0KHRvcGljKS5sZWRnZXJSYW5nZXMuc2l6\nZSgpKTsKCiAgICAgICAgICAgIFN0dWJDYWxsYmFjazxMb25nPiBwZXJzaXN0\nQ2FsbGJhY2sgPSBuZXcgU3R1YkNhbGxiYWNrPExvbmc+KCk7CiAgICAgICAg\nICAgIGJrcG0ucGVyc2lzdE1lc3NhZ2UobmV3IFBlcnNpc3RSZXF1ZXN0KHRv\ncGljLCBtZXNzYWdlcy5nZXQoaW5kZXgpLCBwZXJzaXN0Q2FsbGJhY2ssIG51\nbGwpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKG5ldyBMb25nKGluZGV4\nICsgMSksIENvbmN1cnJlbmN5VXRpbHMudGFrZShwZXJzaXN0Q2FsbGJhY2su\ncXVldWUpLmxlZnQoKSk7CgogICAgICAgICAgICAvLyBvbmNlIGluIGV2ZXJ5\nIDEwIHRpbWVzLCBnaXZlIHVwIGxlZGdlcgogICAgICAgICAgICBpZiAoci5u\nZXh0SW50KDEwKSA9PSA5KSB7CiAgICAgICAgICAgICAgICAvLyBNYWtlIHRo\nZSBia3BtIGxvc2UgaXRzIG1lbW9yeQogICAgICAgICAgICAgICAgYmtwbS50\nb3BpY0luZm9zLmNsZWFyKCk7CiAgICAgICAgICAgICAgICBudW1QcmV2TGVk\nZ2VycysrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGluZGV4Kys7CiAg\nICAgICAgfQoKICAgICAgICAvLyBMZXRzIHNjYW4gbm93CiAgICAgICAgU3R1\nYlNjYW5DYWxsYmFjayBzY2FuQ2FsbGJhY2sgPSBuZXcgU3R1YlNjYW5DYWxs\nYmFjaygpOwogICAgICAgIGJrcG0uc2Nhbk1lc3NhZ2VzKG5ldyBSYW5nZVNj\nYW5SZXF1ZXN0KHRvcGljLCAxLCBOVU1fTUVTU0FHRVNfVE9fVEVTVCwgTG9u\nZy5NQVhfVkFMVUUsIHNjYW5DYWxsYmFjaywgbnVsbCkpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbWVzc2FnZXMuc2l6ZSgpOyBpKyspIHsKICAg\nICAgICAgICAgTWVzc2FnZSBzY2FubmVkTWVzc2FnZSA9IENvbmN1cnJlbmN5\nVXRpbHMudGFrZShzY2FuQ2FsbGJhY2sucXVldWUpLmxlZnQoKTsKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZShtZXNzYWdlcy5nZXQoaSkuZ2V0Qm9keSgpLmVx\ndWFscyhzY2FubmVkTWVzc2FnZS5nZXRCb2R5KCkpKTsKICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKGkgKyAxLCBzY2FubmVkTWVzc2FnZS5nZXRNc2dJZCgp\nLmdldExvY2FsQ29tcG9uZW50KCkpOwogICAgICAgIH0KICAgICAgICBhc3Nl\ncnRUcnVlKFN0dWJTY2FuQ2FsbGJhY2suRU5EX01FU1NBR0UgPT0gQ29uY3Vy\ncmVuY3lVdGlscy50YWtlKHNjYW5DYWxsYmFjay5xdWV1ZSkubGVmdCgpKTsK\nCiAgICB9Cgp9Cg==\n","encoding":"base64"}

