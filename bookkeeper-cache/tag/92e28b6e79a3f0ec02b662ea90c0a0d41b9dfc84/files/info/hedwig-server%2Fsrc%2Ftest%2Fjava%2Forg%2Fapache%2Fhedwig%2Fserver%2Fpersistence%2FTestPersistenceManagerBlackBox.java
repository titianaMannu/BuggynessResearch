{"sha":"ce82c0bae7f9927e6979799c640dd72d1facfc97","node_id":"MDQ6QmxvYjE1NzU5NTY6Y2U4MmMwYmFlN2Y5OTI3ZTY5Nzk3OTljNjQwZGQ3MmQxZmFjZmM5Nw==","size":11155,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ce82c0bae7f9927e6979799c640dd72d1facfc97","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwu\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2Nr\naW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhv\ncmU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmlt\ncG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5Owpp\nbXBvcnQgb3JnLmp1bml0LlRlc3Q7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90\nb2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuSGVs\ncGVyTWV0aG9kczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlv\nbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci50b3BpY3MuVG9waWNPd25lcnNoaXBDaGFu\nZ2VMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2Fs\nbGJhY2s7CgpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgVGVzdFBlcnNpc3RlbmNl\nTWFuYWdlckJsYWNrQm94IGV4dGVuZHMgVGVzdENhc2UgewogICAgcHJvdGVj\ndGVkIFBlcnNpc3RlbmNlTWFuYWdlciBwZXJzaXN0ZW5jZU1hbmFnZXI7CiAg\nICBwcm90ZWN0ZWQgaW50IE5VTV9NRVNTQUdFU19UT19URVNUID0gNTsKICAg\nIHByb3RlY3RlZCBpbnQgTlVNX1RPUElDU19UT19URVNUID0gNTsKICAgIHN0\nYXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIo\nVGVzdFBlcnNpc3RlbmNlTWFuYWdlckJsYWNrQm94LmNsYXNzKTsKICAgIFRl\nc3RDYWxsYmFjayB0ZXN0Q2FsbGJhY2sgPSBuZXcgVGVzdENhbGxiYWNrKCk7\nCgogICAgUnVudGltZUV4Y2VwdGlvbiBmYWlsdXJlRXhjZXB0aW9uOwoKICAg\nIGNsYXNzIFRlc3RDYWxsYmFjayBpbXBsZW1lbnRzIENhbGxiYWNrPExvbmc+\nIHsKCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVj\ndCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAg\nICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2Vw\ndGlvbihleGNlcHRpb24pKTsKICAgICAgICB9CgogICAgICAgIEBTdXBwcmVz\nc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIExvbmcgcmVzdWx0T2ZPcGVy\nYXRpb24pIHsKICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29s\nZWFuPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xl\nYW4+KSBjdHg7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBz\ndGF0dXNRdWV1ZS5wdXQodHJ1ZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElu\ndGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93\nIChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oZSkp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGNsYXNzIFJh\nbmdlU2NhblZlcmlmaWVyTGlzdGVuZXIgaW1wbGVtZW50cyBTY2FuQ2FsbGJh\nY2sgewogICAgICAgIExpc3Q8TWVzc2FnZT4gcHViTXNnczsKCiAgICAgICAg\ncHVibGljIFJhbmdlU2NhblZlcmlmaWVyTGlzdGVuZXIoTGlzdDxNZXNzYWdl\nPiBwdWJNc2dzKSB7CiAgICAgICAgICAgIHRoaXMucHViTXNncyA9IHB1Yk1z\nZ3M7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBtZXNzYWdlU2Nh\nbm5lZChPYmplY3QgY3R4LCBNZXNzYWdlIHJlY3ZNZXNzYWdlKSB7CiAgICAg\nICAgICAgIGlmIChwdWJNc2dzLmlzRW1wdHkoKSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2Vw\ndGlvbigiTWVzc2FnZSByZWNlaXZlZCB3aGVuIG5vbmUgZXhwZWN0ZWQiKSk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1lc3NhZ2UgcHViTXNnID0g\ncHViTXNncy5nZXQoMCk7CiAgICAgICAgICAgIGlmICghSGVscGVyTWV0aG9k\ncy5hcmVFcXVhbChyZWN2TWVzc2FnZSwgcHViTXNnKSkgewogICAgICAgICAg\nICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4\nY2VwdGlvbigiU2Nhbm5lZCBtZXNzYWdlIG5vdCBlcXVhbCB0byBleHBlY3Rl\nZCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwdWJNc2dzLnJlbW92\nZSgwKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNjYW5GYWls\nZWQoT2JqZWN0IGN0eCwgRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAg\nICAgICB0aHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhj\nZXB0aW9uKGV4Y2VwdGlvbikpOwogICAgICAgIH0KCiAgICAgICAgQFN1cHBy\nZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICAgICAgcHVibGljIHZvaWQg\nc2NhbkZpbmlzaGVkKE9iamVjdCBjdHgsIFJlYXNvbkZvckZpbmlzaCByZWFz\nb24pIHsKICAgICAgICAgICAgaWYgKHJlYXNvbiAhPSBSZWFzb25Gb3JGaW5p\nc2guTk9fTU9SRV9NRVNTQUdFUykgewogICAgICAgICAgICAgICAgdGhyb3cg\nKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2VwdGlvbigiU2Nh\nbiBmaW5pc2hlZCBwcmVtYXR1cmVseSAiICsgcmVhc29uKSk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFu\nPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+\nKSBjdHg7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdGF0\ndXNRdWV1ZS5wdXQodHJ1ZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVy\ncnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IChm\nYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oZSkpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICBjbGFzcyBQb2lu\ndFNjYW5WZXJpZmllckxpc3RlbmVyIGltcGxlbWVudHMgU2NhbkNhbGxiYWNr\nIHsKICAgICAgICBMaXN0PE1lc3NhZ2U+IHB1Yk1zZ3M7CiAgICAgICAgQnl0\nZVN0cmluZyB0b3BpYzsKCiAgICAgICAgcHVibGljIFBvaW50U2NhblZlcmlm\naWVyTGlzdGVuZXIoTGlzdDxNZXNzYWdlPiBwdWJNc2dzLCBCeXRlU3RyaW5n\nIHRvcGljKSB7CiAgICAgICAgICAgIHRoaXMudG9waWMgPSB0b3BpYzsKICAg\nICAgICAgICAgdGhpcy5wdWJNc2dzID0gcHViTXNnczsKICAgICAgICB9Cgog\nICAgICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgICAg\nIHB1YmxpYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVjdCBjdHgsIE1lc3Nh\nZ2UgcmVjdk1lc3NhZ2UpIHsKCiAgICAgICAgICAgIE1lc3NhZ2UgcHViTXNn\nID0gcHViTXNncy5nZXQoMCk7CiAgICAgICAgICAgIGlmICghSGVscGVyTWV0\naG9kcy5hcmVFcXVhbChyZWN2TWVzc2FnZSwgcHViTXNnKSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGlt\nZUV4Y2VwdGlvbigiU2Nhbm5lZCBtZXNzYWdlIG5vdCBlcXVhbCB0byBleHBl\nY3RlZCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwdWJNc2dzLnJl\nbW92ZSgwKTsKCiAgICAgICAgICAgIGlmIChwdWJNc2dzLmlzRW1wdHkoKSkg\newogICAgICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFu\nPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+\nKSBjdHg7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIHN0YXR1c1F1ZXVlLnB1dCh0cnVlKTsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgICAgICB0aHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1l\nRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvbmcgc2VxSWQgPSByZWN2TWVz\nc2FnZS5nZXRNc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCk7CiAgICAgICAg\nICAgICAgICBzZXFJZCA9IHBlcnNpc3RlbmNlTWFuYWdlci5nZXRTZXFJZEFm\ndGVyU2tpcHBpbmcodG9waWMsIHNlcUlkLCAxKTsKICAgICAgICAgICAgICAg\nIFNjYW5SZXF1ZXN0IHJlcXVlc3QgPSBuZXcgU2NhblJlcXVlc3QodG9waWMs\nIHNlcUlkLCBuZXcgUG9pbnRTY2FuVmVyaWZpZXJMaXN0ZW5lcihwdWJNc2dz\nLCB0b3BpYyksIGN0eCk7CiAgICAgICAgICAgICAgICBwZXJzaXN0ZW5jZU1h\nbmFnZXIuc2NhblNpbmdsZU1lc3NhZ2UocmVxdWVzdCk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzY2FuRmFpbGVk\nKE9iamVjdCBjdHgsIEV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAg\nICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2Vw\ndGlvbihleGNlcHRpb24pKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIHNjYW5GaW5pc2hlZChPYmplY3QgY3R4LCBSZWFzb25Gb3JGaW5pc2gg\ncmVhc29uKSB7CgogICAgICAgIH0KCiAgICB9CgogICAgY2xhc3MgU2NhblZl\ncmlmaWVyIGltcGxlbWVudHMgUnVubmFibGUgewogICAgICAgIExpc3Q8TWVz\nc2FnZT4gcHViTXNnczsKICAgICAgICBCeXRlU3RyaW5nIHRvcGljOwogICAg\nICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4gc3RhdHVzUXVldWUg\nPSBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPigpOwoKICAgICAg\nICBwdWJsaWMgU2NhblZlcmlmaWVyKEJ5dGVTdHJpbmcgdG9waWMsIExpc3Q8\nTWVzc2FnZT4gcHViTXNncykgewogICAgICAgICAgICB0aGlzLnRvcGljID0g\ndG9waWM7CiAgICAgICAgICAgIHRoaXMucHViTXNncyA9IHB1Yk1zZ3M7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nICAgIC8vIHN0YXJ0IHRoZSBzY2FuCiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBpZiAocGVyc2lzdGVuY2VNYW5hZ2VyIGluc3RhbmNlb2Yg\nUGVyc2lzdGVuY2VNYW5hZ2VyV2l0aFJhbmdlU2NhbikgewoKICAgICAgICAg\nICAgICAgICAgICBTY2FuQ2FsbGJhY2sgbGlzdGVuZXIgPSBuZXcgUmFuZ2VT\nY2FuVmVyaWZpZXJMaXN0ZW5lcihwdWJNc2dzKTsKCiAgICAgICAgICAgICAg\nICAgICAgUGVyc2lzdGVuY2VNYW5hZ2VyV2l0aFJhbmdlU2NhbiByYW5nZVBl\ncnNpc3RlbmNlTWFuYWdlciA9IChQZXJzaXN0ZW5jZU1hbmFnZXJXaXRoUmFu\nZ2VTY2FuKSBwZXJzaXN0ZW5jZU1hbmFnZXI7CgogICAgICAgICAgICAgICAg\nICAgIHJhbmdlUGVyc2lzdGVuY2VNYW5hZ2VyLnNjYW5NZXNzYWdlcyhuZXcg\nUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgZ2V0TG93ZXN0U2VxSWQoKSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgTlVNX01FU1NBR0VTX1RPX1RFU1QgKyAxLCBMb25nLk1BWF9W\nQUxVRSwgbGlzdGVuZXIsIHN0YXR1c1F1ZXVlKSk7CgogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgU2NhbkNhbGxiYWNr\nIGxpc3RlbmVyID0gbmV3IFBvaW50U2NhblZlcmlmaWVyTGlzdGVuZXIocHVi\nTXNncywgdG9waWMpOwogICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNl\nTWFuYWdlcgogICAgICAgICAgICAgICAgICAgIC5zY2FuU2luZ2xlTWVzc2Fn\nZShuZXcgU2NhblJlcXVlc3QodG9waWMsIGdldExvd2VzdFNlcUlkKCksIGxp\nc3RlbmVyLCBzdGF0dXNRdWV1ZSkpOwoKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIC8vIG5vdyBsaXN0ZW4gZm9yIGl0IHRvIGZpbmlzaAog\nICAgICAgICAgICAgICAgLy8gd2FpdCBhIG1heGltdW0gb2YgYSBtaW51dGUK\nICAgICAgICAgICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwo\nNjAsIFRpbWVVbml0LlNFQ09ORFMpOwogICAgICAgICAgICAgICAgaWYgKGIg\nPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IChmYWlsdXJl\nRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oIlNjYW5uaW5nIHRp\nbWVkIG91dCIpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBj\nYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2Vw\ndGlvbihlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nY2xhc3MgUHVibGlzaGVyIGltcGxlbWVudHMgUnVubmFibGUgewogICAgICAg\nIExpc3Q8TWVzc2FnZT4gcHViTXNnczsKICAgICAgICBCeXRlU3RyaW5nIHRv\ncGljOwoKICAgICAgICBwdWJsaWMgUHVibGlzaGVyKEJ5dGVTdHJpbmcgdG9w\naWMsIExpc3Q8TWVzc2FnZT4gcHViTXNncykgewogICAgICAgICAgICB0aGlz\nLnB1Yk1zZ3MgPSBwdWJNc2dzOwogICAgICAgICAgICB0aGlzLnRvcGljID0g\ndG9waWM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7\nCiAgICAgICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4gc3Rh\ndHVzUXVldWUgPSBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPigp\nOwoKICAgICAgICAgICAgZm9yIChNZXNzYWdlIG1zZyA6IHB1Yk1zZ3MpIHsK\nCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHBl\ncnNpc3RlbmNlTWFuYWdlci5wZXJzaXN0TWVzc2FnZShuZXcgUGVyc2lzdFJl\ncXVlc3QodG9waWMsIG1zZywgdGVzdENhbGxiYWNrLCBzdGF0dXNRdWV1ZSkp\nOwogICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgYSBtYXhpbXVtIG9mIGEg\nbWludXRlCiAgICAgICAgICAgICAgICAgICAgQm9vbGVhbiBiID0gc3RhdHVz\nUXVldWUucG9sbCg2MCwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGIgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAg\nICAgICB0aHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhj\nZXB0aW9uKCJTY2FubmluZyB0aW1lZCBvdXQiKSk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIHRocm93IChmYWls\ndXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oZSkpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHNldFVwKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbG9nZ2VyLmluZm8oIlNUQVJUSU5H\nICIgKyBnZXROYW1lKCkpOwogICAgICAgIHBlcnNpc3RlbmNlTWFuYWdlciA9\nIGluc3RhbnRpYXRlUGVyc2lzdGVuY2VNYW5hZ2VyKCk7CiAgICAgICAgZmFp\nbHVyZUV4Y2VwdGlvbiA9IG51bGw7CiAgICAgICAgbG9nZ2VyLmluZm8oIlBl\ncnNpc3RlbmNlIE1hbmFnZXIgdGVzdCBzZXR1cCBmaW5pc2hlZCIpOwogICAg\nfQoKICAgIGFic3RyYWN0IGxvbmcgZ2V0TG93ZXN0U2VxSWQoKTsKCiAgICBh\nYnN0cmFjdCBQZXJzaXN0ZW5jZU1hbmFnZXIgaW5zdGFudGlhdGVQZXJzaXN0\nZW5jZU1hbmFnZXIoKSB0aHJvd3MgRXhjZXB0aW9uOwoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBsb2dnZXIuaW5mbygidGVhckRvd24gc3RhcnRpbmci\nKTsKICAgICAgICBzdXBlci50ZWFyRG93bigpOwogICAgICAgIGxvZ2dlci5p\nbmZvKCJGSU5JU0hFRCAiICsgZ2V0TmFtZSgpKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgQnl0ZVN0cmluZyBnZXRUb3BpY05hbWUoaW50IG51bWJlcikgewog\nICAgICAgIHJldHVybiBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgidG9waWMi\nICsgbnVtYmVyKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQg\ndGVzdFBlcnNpc3RlbmNlTWFuYWdlcigpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIExpc3Q8VGhyZWFkPiBwdWJsaXNoZXJUaHJlYWRzID0gbmV3IExp\nbmtlZExpc3Q8VGhyZWFkPigpOwogICAgICAgIExpc3Q8VGhyZWFkPiBzY2Fu\nbmVyVGhyZWFkcyA9IG5ldyBMaW5rZWRMaXN0PFRocmVhZD4oKTsKICAgICAg\nICBUaHJlYWQgdGhyZWFkOwogICAgICAgIFNlbWFwaG9yZSBsYXRjaCA9IG5l\ndyBTZW1hcGhvcmUoMSk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nTlVNX1RPUElDU19UT19URVNUOyBpKyspIHsKICAgICAgICAgICAgQnl0ZVN0\ncmluZyB0b3BpYyA9IGdldFRvcGljTmFtZShpKTsKCiAgICAgICAgICAgIGlm\nIChwZXJzaXN0ZW5jZU1hbmFnZXIgaW5zdGFuY2VvZiBUb3BpY093bmVyc2hp\ncENoYW5nZUxpc3RlbmVyKSB7CgogICAgICAgICAgICAgICAgVG9waWNPd25l\ncnNoaXBDaGFuZ2VMaXN0ZW5lciB0b2NsID0gKFRvcGljT3duZXJzaGlwQ2hh\nbmdlTGlzdGVuZXIpIHBlcnNpc3RlbmNlTWFuYWdlcjsKCiAgICAgICAgICAg\nICAgICBsYXRjaC5hY3F1aXJlKCk7CgogICAgICAgICAgICAgICAgdG9jbC5h\nY3F1aXJlZFRvcGljKHRvcGljLCBuZXcgQ2FsbGJhY2s8Vm9pZD4oKSB7CiAg\nICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1\nYlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9u\nKGV4Y2VwdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgICgoU2VtYXBo\nb3JlKSBjdHgpLnJlbGVhc2UoKTsKICAgICAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgs\nIFZvaWQgcmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICgoU2VtYXBo\nb3JlKSBjdHgpLnJlbGVhc2UoKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9LCBsYXRjaCk7CgogICAgICAgICAgICAgICAgbGF0\nY2guYWNxdWlyZSgpOwogICAgICAgICAgICAgICAgbGF0Y2gucmVsZWFzZSgp\nOwogICAgICAgICAgICAgICAgaWYgKGZhaWx1cmVFeGNlcHRpb24gIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IChFeGNlcHRpb24pIGZh\naWx1cmVFeGNlcHRpb24uZ2V0Q2F1c2UoKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgICAgICBMaXN0PE1lc3NhZ2U+IG1zZ3Mg\nPSBIZWxwZXJNZXRob2RzLmdldFJhbmRvbVB1Ymxpc2hlZE1lc3NhZ2VzKE5V\nTV9NRVNTQUdFU19UT19URVNULCAxMDI0KTsKCiAgICAgICAgICAgIHRocmVh\nZCA9IG5ldyBUaHJlYWQobmV3IFB1Ymxpc2hlcih0b3BpYywgbXNncykpOwog\nICAgICAgICAgICBwdWJsaXNoZXJUaHJlYWRzLmFkZCh0aHJlYWQpOwogICAg\nICAgICAgICB0aHJlYWQuc3RhcnQoKTsKCiAgICAgICAgICAgIHRocmVhZCA9\nIG5ldyBUaHJlYWQobmV3IFNjYW5WZXJpZmllcih0b3BpYywgbXNncykpOwog\nICAgICAgICAgICBzY2FubmVyVGhyZWFkcy5hZGQodGhyZWFkKTsKICAgICAg\nICB9CiAgICAgICAgZm9yIChUaHJlYWQgdCA6IHB1Ymxpc2hlclRocmVhZHMp\nIHsKICAgICAgICAgICAgdC5qb2luKCk7CiAgICAgICAgfQoKICAgICAgICBm\nb3IgKFRocmVhZCB0IDogc2Nhbm5lclRocmVhZHMpIHsKICAgICAgICAgICAg\ndC5zdGFydCgpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChUaHJlYWQgdCA6\nIHNjYW5uZXJUaHJlYWRzKSB7CiAgICAgICAgICAgIHQuam9pbigpOwogICAg\nICAgIH0KCiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bGwsIGZhaWx1cmVFeGNl\ncHRpb24pOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTlVNX1RPUElD\nU19UT19URVNUOyBpKyspIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHBl\ncnNpc3RlbmNlTWFuYWdlci5nZXRDdXJyZW50U2VxSWRGb3JUb3BpYyhnZXRU\nb3BpY05hbWUoaSkpLmdldExvY2FsQ29tcG9uZW50KCksCiAgICAgICAgICAg\nICAgICAgICAgICAgICBnZXRFeHBlY3RlZFNlcUlkKE5VTV9NRVNTQUdFU19U\nT19URVNUKSk7CiAgICAgICAgfQoKICAgIH0KCiAgICBhYnN0cmFjdCBsb25n\nIGdldEV4cGVjdGVkU2VxSWQoaW50IG51bVB1Ymxpc2hlZCk7Cgp9Cg==\n","encoding":"base64"}

