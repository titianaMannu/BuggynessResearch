{"sha":"33f067a3ee6088bb7434655fa018c3c32ad6e284","node_id":"MDQ6QmxvYjE1NzU5NTY6MzNmMDY3YTNlZTYwODhiYjc0MzQ2NTVmYTAxOGMzYzMyYWQ2ZTI4NA==","size":10811,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/33f067a3ee6088bb7434655fa018c3c32ad6e284","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCmltcG9ydCBqYXZh\nLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9ydCBv\ncmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1bml0LlRlc3Q7CgppbXBv\ncnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuSGVscGVyTWV0aG9kczsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLlN0dWJDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLlN0dWJTY2FuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1vbi5TZXJ2ZXJDb25maWd1cmF0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5Db25jdXJyZW5j\neVV0aWxzOwoKcHVibGljIGNsYXNzIFRlc3RSZWFkQWhlYWRDYWNoZVdoaXRl\nQm94IHsKICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNvcHlG\ncm9tVXRmOCgidGVzdFRvcGljIik7CiAgICBmaW5hbCBzdGF0aWMgaW50IE5V\nTV9NRVNTQUdFUyA9IDEwOwogICAgZmluYWwgc3RhdGljIGludCBNU0dfU0la\nRSA9IDUwOwogICAgTGlzdDxNZXNzYWdlPiBtZXNzYWdlcyA9IEhlbHBlck1l\ndGhvZHMuZ2V0UmFuZG9tUHVibGlzaGVkTWVzc2FnZXMoTlVNX01FU1NBR0VT\nLCBNU0dfU0laRSk7CiAgICBTdHViUGVyc2lzdGVuY2VNYW5hZ2VyIHN0dWJQ\nZXJzaXN0ZW5jZU1hbmFnZXI7CiAgICBSZWFkQWhlYWRDYWNoZSBjYWNoZUJh\nc2VkUGVyc2lzdGVuY2VNYW5hZ2VyOwogICAgTXlTZXJ2ZXJDb25maWd1cmF0\naW9uIG15Q29uZiA9IG5ldyBNeVNlcnZlckNvbmZpZ3VyYXRpb24oKTsKCiAg\nICBjbGFzcyBNeVJlYWRBaGVhZENhY2hlIGV4dGVuZHMgUmVhZEFoZWFkQ2Fj\naGUgewogICAgICAgIHB1YmxpYyBNeVJlYWRBaGVhZENhY2hlKFBlcnNpc3Rl\nbmNlTWFuYWdlcldpdGhSYW5nZVNjYW4gcGVyc2lzdGVuY2VNYW5nZXIsIFNl\ncnZlckNvbmZpZ3VyYXRpb24gY2ZnKSB7CiAgICAgICAgICAgIHN1cGVyKHBl\ncnNpc3RlbmNlTWFuZ2VyLCBjZmcpOwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgZW5xdWV1ZVdpdGhvdXRG\nYWlsdXJlKENhY2hlUmVxdWVzdCBvYmopIHsKICAgICAgICAgICAgLy8gbWFr\nZSBpdCBwZXJmb3JtIGluIHRoZSBzYW1lIHRocmVhZAogICAgICAgICAgICBv\nYmoucGVyZm9ybVJlcXVlc3QoKTsKICAgICAgICB9CiAgICB9CgogICAgY2xh\nc3MgTXlTZXJ2ZXJDb25maWd1cmF0aW9uIGV4dGVuZHMgU2VydmVyQ29uZmln\ndXJhdGlvbiB7CgogICAgICAgIC8vIE5vdGUgdGhlc2UgYXJlIHNldCB1cCwg\nc28gdGhhdCB0aGUgc2l6ZSBsaW1pdCB3aWxsIGJlIHJlYWNoZWQgYmVmb3Jl\nCiAgICAgICAgLy8gdGhlIGNvdW50IGxpbWl0CiAgICAgICAgaW50IHJlYWRB\naGVhZENvdW50ID0gTlVNX01FU1NBR0VTIC8gMjsKICAgICAgICBsb25nIHJl\nYWRBaGVhZFNpemUgPSAobG9uZykgKE1TR19TSVpFICogMi41KTsKICAgICAg\nICBsb25nIG1heENhY2hlU2l6ZSA9IExvbmcuTUFYX1ZBTFVFOwoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50IGdldFJlYWRBaGVhZENv\ndW50KCkgewogICAgICAgICAgICByZXR1cm4gcmVhZEFoZWFkQ291bnQ7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgbG9u\nZyBnZXRSZWFkQWhlYWRTaXplQnl0ZXMoKSB7CiAgICAgICAgICAgIHJldHVy\nbiByZWFkQWhlYWRTaXplOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIGxvbmcgZ2V0TWF4aW11bUNhY2hlU2l6ZSgpIHsK\nICAgICAgICAgICAgcmV0dXJuIG1heENhY2hlU2l6ZTsKICAgICAgICB9CiAg\nICB9CgogICAgQEJlZm9yZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdHViUGVyc2lzdGVuY2VNYW5hZ2Vy\nID0gbmV3IFN0dWJQZXJzaXN0ZW5jZU1hbmFnZXIoKTsKICAgICAgICBjYWNo\nZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyID0gbmV3IE15UmVhZEFoZWFkQ2Fj\naGUoc3R1YlBlcnNpc3RlbmNlTWFuYWdlciwgbXlDb25mKS5zdGFydCgpOwog\nICAgfQoKICAgIEBBZnRlcgogICAgcHVibGljIHZvaWQgdGVhckRvd24oKSB0\naHJvd3MgRXhjZXB0aW9uIHsKCiAgICB9CgogICAgQFRlc3QKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RQZXJzaXN0TWVzc2FnZSgpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIFN0dWJDYWxsYmFjazxMb25nPiBjYWxsYmFjayA9IG5ldyBT\ndHViQ2FsbGJhY2s8TG9uZz4oKTsKICAgICAgICBQZXJzaXN0UmVxdWVzdCBy\nZXF1ZXN0ID0gbmV3IFBlcnNpc3RSZXF1ZXN0KHRvcGljLCBtZXNzYWdlcy5n\nZXQoMCksIGNhbGxiYWNrLCBudWxsKTsKCiAgICAgICAgc3R1YlBlcnNpc3Rl\nbmNlTWFuYWdlci5mYWlsdXJlID0gdHJ1ZTsKICAgICAgICBjYWNoZUJhc2Vk\nUGVyc2lzdGVuY2VNYW5hZ2VyLnBlcnNpc3RNZXNzYWdlKHJlcXVlc3QpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoQ29uY3VycmVuY3lVdGlscy50YWtlKGNh\nbGxiYWNrLnF1ZXVlKS5yaWdodCgpKTsKCiAgICAgICAgQ2FjaGVLZXkga2V5\nID0gbmV3IENhY2hlS2V5KHRvcGljLCBjYWNoZUJhc2VkUGVyc2lzdGVuY2VN\nYW5hZ2VyLmdldEN1cnJlbnRTZXFJZEZvclRvcGljKHRvcGljKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0TG9jYWxDb21wb25l\nbnQoKSk7CiAgICAgICAgYXNzZXJ0RmFsc2UoY2FjaGVCYXNlZFBlcnNpc3Rl\nbmNlTWFuYWdlci5jYWNoZS5jb250YWluc0tleShrZXkpKTsKCiAgICAgICAg\nc3R1YlBlcnNpc3RlbmNlTWFuYWdlci5mYWlsdXJlID0gZmFsc2U7CiAgICAg\nICAgcGVyc2lzdE1lc3NhZ2UobWVzc2FnZXMuZ2V0KDApKTsKICAgIH0KCiAg\nICBwcml2YXRlIHZvaWQgcGVyc2lzdE1lc3NhZ2UoTWVzc2FnZSBtc2cpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIFN0dWJDYWxsYmFjazxMb25nPiBj\nYWxsYmFjayA9IG5ldyBTdHViQ2FsbGJhY2s8TG9uZz4oKTsKICAgICAgICBQ\nZXJzaXN0UmVxdWVzdCByZXF1ZXN0ID0gbmV3IFBlcnNpc3RSZXF1ZXN0KHRv\ncGljLCBtc2csIGNhbGxiYWNrLCBudWxsKTsKICAgICAgICBjYWNoZUJhc2Vk\nUGVyc2lzdGVuY2VNYW5hZ2VyLnBlcnNpc3RNZXNzYWdlKHJlcXVlc3QpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoQ29uY3VycmVuY3lVdGlscy50YWtlKGNh\nbGxiYWNrLnF1ZXVlKS5sZWZ0KCkpOwogICAgICAgIENhY2hlS2V5IGtleSA9\nIG5ldyBDYWNoZUtleSh0b3BpYywgY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFu\nYWdlci5nZXRDdXJyZW50U2VxSWRGb3JUb3BpYyh0b3BpYykKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldExvY2FsQ29tcG9uZW50\nKCkpOwogICAgICAgIENhY2hlVmFsdWUgY2FjaGVWYWx1ZSA9IGNhY2hlQmFz\nZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2FjaGUuZ2V0KGtleSk7CiAgICAgICAg\nYXNzZXJ0Tm90TnVsbChjYWNoZVZhbHVlKTsKICAgICAgICBhc3NlcnRGYWxz\nZShjYWNoZVZhbHVlLmlzU3R1YigpKTsKICAgICAgICBhc3NlcnRUcnVlKEhl\nbHBlck1ldGhvZHMuYXJlRXF1YWwoY2FjaGVWYWx1ZS5nZXRNZXNzYWdlKCks\nIG1zZykpOwoKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVz\ndFNjYW5TaW5nbGVNZXNzYWdlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgU3R1YlNjYW5DYWxsYmFjayBjYWxsYmFjayA9IG5ldyBTdHViU2NhbkNh\nbGxiYWNrKCk7CiAgICAgICAgU2NhblJlcXVlc3QgcmVxdWVzdCA9IG5ldyBT\nY2FuUmVxdWVzdCh0b3BpYywgMSwgY2FsbGJhY2ssIG51bGwpOwogICAgICAg\nIHN0dWJQZXJzaXN0ZW5jZU1hbmFnZXIuZmFpbHVyZSA9IHRydWU7CgogICAg\nICAgIGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuc2NhblNpbmdsZU1l\nc3NhZ2UocmVxdWVzdCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShjYWxsYmFjay5p\nc0ZhaWxlZCgpKTsKICAgICAgICBhc3NlcnRUcnVlKDAgPT0gY2FjaGVCYXNl\nZFBlcnNpc3RlbmNlTWFuYWdlci5jYWNoZS5zaXplKCkpOwoKICAgICAgICBz\ndHViUGVyc2lzdGVuY2VNYW5hZ2VyLmZhaWx1cmUgPSBmYWxzZTsKICAgICAg\nICBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLnNjYW5TaW5nbGVNZXNz\nYWdlKHJlcXVlc3QpOwogICAgICAgIGFzc2VydFRydWUobXlDb25mLnJlYWRB\naGVhZENvdW50ID09IGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2Fj\naGUuc2l6ZSgpKTsKCiAgICAgICAgcGVyc2lzdE1lc3NhZ2UobWVzc2FnZXMu\nZ2V0KDApKTsKICAgICAgICBhc3NlcnRUcnVlKGNhbGxiYWNrLmlzU3VjY2Vz\ncygpKTsKCiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RE\nZWxpdmVyZWRVbnRpbCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGZv\nciAoTWVzc2FnZSBtIDogbWVzc2FnZXMpIHsKICAgICAgICAgICAgcGVyc2lz\ndE1lc3NhZ2UobSk7CiAgICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscygo\nbG9uZykgTlVNX01FU1NBR0VTICogTVNHX1NJWkUsIGNhY2hlQmFzZWRQZXJz\naXN0ZW5jZU1hbmFnZXIucHJlc2VudENhY2hlU2l6ZSk7CiAgICAgICAgbG9u\nZyBtaWRkbGUgPSBtZXNzYWdlcy5zaXplKCkgLyAyOwogICAgICAgIGNhY2hl\nQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuZGVsaXZlcmVkVW50aWwodG9waWMs\nIG1pZGRsZSk7CgogICAgICAgIGFzc2VydEVxdWFscyhtZXNzYWdlcy5zaXpl\nKCkgLSBtaWRkbGUsIGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2Fj\naGUuc2l6ZSgpKTsKCiAgICAgICAgbG9uZyBtaWRkbGUyID0gbWlkZGxlIC0g\nMTsKICAgICAgICBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLmRlbGl2\nZXJlZFVudGlsKHRvcGljLCBtaWRkbGUyKTsKICAgICAgICAvLyBzaG91bGQg\naGF2ZSBubyBlZmZlY3QKICAgICAgICBhc3NlcnRFcXVhbHMobWVzc2FnZXMu\nc2l6ZSgpIC0gbWlkZGxlLCBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2Vy\nLmNhY2hlLnNpemUoKSk7CgogICAgICAgIC8vIGRlbGl2ZXJlZCBhbGwgbWVz\nc2FnZXMKICAgICAgICBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLmRl\nbGl2ZXJlZFVudGlsKHRvcGljLCAobG9uZykgbWVzc2FnZXMuc2l6ZSgpKTsK\nICAgICAgICAvLyBzaG91bGQgaGF2ZSBubyBlZmZlY3QKICAgICAgICBhc3Nl\ncnRUcnVlKGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2FjaGUuaXNF\nbXB0eSgpKTsKICAgICAgICBhc3NlcnRUcnVlKGNhY2hlQmFzZWRQZXJzaXN0\nZW5jZU1hbmFnZXIudGltZUluZGV4T2ZBZGRpdGlvbi5pc0VtcHR5KCkpOwog\nICAgICAgIGFzc2VydFRydWUoY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFuYWdl\nci5vcmRlcmVkSW5kZXhPblNlcUlkLmlzRW1wdHkoKSk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZSgwID09IGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIucHJl\nc2VudENhY2hlU2l6ZSk7CgogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMg\ndm9pZCB0ZXN0RG9SZWFkQWhlYWQoKSB7CiAgICAgICAgU3R1YlNjYW5DYWxs\nYmFjayBjYWxsYmFjayA9IG5ldyBTdHViU2NhbkNhbGxiYWNrKCk7CiAgICAg\nICAgU2NhblJlcXVlc3QgcmVxdWVzdCA9IG5ldyBTY2FuUmVxdWVzdCh0b3Bp\nYywgMSwgY2FsbGJhY2ssIG51bGwpOwogICAgICAgIGNhY2hlQmFzZWRQZXJz\naXN0ZW5jZU1hbmFnZXIuZG9SZWFkQWhlYWQocmVxdWVzdCk7CgogICAgICAg\nIGFzc2VydEVxdWFscyhteUNvbmYucmVhZEFoZWFkQ291bnQsIGNhY2hlQmFz\nZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2FjaGUuc2l6ZSgpKTsKCiAgICAgICAg\ncmVxdWVzdCA9IG5ldyBTY2FuUmVxdWVzdCh0b3BpYywgbXlDb25mLnJlYWRB\naGVhZENvdW50IC8gMiAtIDEsIGNhbGxiYWNrLCBudWxsKTsKICAgICAgICBj\nYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLmRvUmVhZEFoZWFkKHJlcXVl\nc3QpOwogICAgICAgIGFzc2VydEVxdWFscyhteUNvbmYucmVhZEFoZWFkQ291\nbnQsIGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2FjaGUuc2l6ZSgp\nKTsKCiAgICAgICAgcmVxdWVzdCA9IG5ldyBTY2FuUmVxdWVzdCh0b3BpYywg\nbXlDb25mLnJlYWRBaGVhZENvdW50IC8gMiArIDIsIGNhbGxiYWNrLCBudWxs\nKTsKICAgICAgICBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLmRvUmVh\nZEFoZWFkKHJlcXVlc3QpOwogICAgICAgIGFzc2VydEVxdWFscygoaW50KSAo\nMS41ICogbXlDb25mLnJlYWRBaGVhZENvdW50KSwgY2FjaGVCYXNlZFBlcnNp\nc3RlbmNlTWFuYWdlci5jYWNoZS5zaXplKCkpOwoKICAgIH0KCiAgICBAVGVz\ndAogICAgcHVibGljIHZvaWQgdGVzdFJlYWRBaGVhZFNpemVMaW1pdCgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGZvciAoTWVzc2FnZSBtIDogbWVz\nc2FnZXMpIHsKICAgICAgICAgICAgcGVyc2lzdE1lc3NhZ2UobSk7CiAgICAg\nICAgfQogICAgICAgIGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2Fj\naGUuY2xlYXIoKTsKICAgICAgICBTdHViU2NhbkNhbGxiYWNrIGNhbGxiYWNr\nID0gbmV3IFN0dWJTY2FuQ2FsbGJhY2soKTsKICAgICAgICBTY2FuUmVxdWVz\ndCByZXF1ZXN0ID0gbmV3IFNjYW5SZXF1ZXN0KHRvcGljLCAxLCBjYWxsYmFj\naywgbnVsbCk7CiAgICAgICAgY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFuYWdl\nci5zY2FuU2luZ2xlTWVzc2FnZShyZXF1ZXN0KTsKCiAgICAgICAgYXNzZXJ0\nVHJ1ZShjYWxsYmFjay5pc1N1Y2Nlc3MoKSk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKChpbnQpIE1hdGguY2VpbChteUNvbmYucmVhZEFoZWFkU2l6ZSAvIChN\nU0dfU0laRSArIDAuMCkpLCBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2Vy\nLmNhY2hlCiAgICAgICAgICAgICAgICAgICAgIC5zaXplKCkpOwoKICAgIH0K\nCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdERvUmVhZEFoZWFkU3Rh\ncnRpbmdGcm9tKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgcGVyc2lz\ndE1lc3NhZ2UobWVzc2FnZXMuZ2V0KDApKTsKICAgICAgICBpbnQgcmVhZEFo\nZWFkQ291bnQgPSA1OwogICAgICAgIGludCBzdGFydCA9IDE7CiAgICAgICAg\nUmFuZ2VTY2FuUmVxdWVzdCByZWFkQWhlYWRSZXF1ZXN0ID0gY2FjaGVCYXNl\nZFBlcnNpc3RlbmNlTWFuYWdlci5kb1JlYWRBaGVhZFN0YXJ0aW5nRnJvbSh0\nb3BpYywgc3RhcnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgcmVhZEFoZWFkQ291bnQpOwogICAgICAgIGFzc2VydE51\nbGwocmVhZEFoZWFkUmVxdWVzdCk7CgogICAgICAgIFN0dWJTY2FuQ2FsbGJh\nY2sgY2FsbGJhY2sgPSBuZXcgU3R1YlNjYW5DYWxsYmFjaygpOwogICAgICAg\nIGludCBlbmQgPSAxMDA7CiAgICAgICAgU2NhblJlcXVlc3QgcmVxdWVzdCA9\nIG5ldyBTY2FuUmVxdWVzdCh0b3BpYywgZW5kLCBjYWxsYmFjaywgbnVsbCk7\nCiAgICAgICAgY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFuYWdlci5kb1JlYWRB\naGVhZChyZXF1ZXN0KTsKCiAgICAgICAgaW50IHBvcyA9IDk4OwogICAgICAg\nIHJlYWRBaGVhZFJlcXVlc3QgPSBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5h\nZ2VyLmRvUmVhZEFoZWFkU3RhcnRpbmdGcm9tKHRvcGljLCBwb3MsIHJlYWRB\naGVhZENvdW50KTsKICAgICAgICBhc3NlcnRFcXVhbHMocmVhZEFoZWFkUmVx\ndWVzdC5tZXNzYWdlTGltaXQsIGVuZCAtIHBvcyk7CgogICAgICAgIGVuZCA9\nIDIwMDsKICAgICAgICByZXF1ZXN0ID0gbmV3IFNjYW5SZXF1ZXN0KHRvcGlj\nLCBlbmQsIGNhbGxiYWNrLCBudWxsKTsKICAgICAgICBjYWNoZUJhc2VkUGVy\nc2lzdGVuY2VNYW5hZ2VyLmRvUmVhZEFoZWFkKHJlcXVlc3QpOwoKICAgICAg\nICAvLyB0b28gZmFyIGJhY2sKICAgICAgICBwb3MgPSAxNTA7CiAgICAgICAg\ncmVhZEFoZWFkUmVxdWVzdCA9IGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFn\nZXIuZG9SZWFkQWhlYWRTdGFydGluZ0Zyb20odG9waWMsIHBvcywgcmVhZEFo\nZWFkQ291bnQpOwogICAgICAgIGFzc2VydEVxdWFscyhyZWFkQWhlYWRSZXF1\nZXN0Lm1lc3NhZ2VMaW1pdCwgcmVhZEFoZWFkQ291bnQpOwogICAgfQoKICAg\nIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0QWRkTWVzc2FnZVRvQ2FjaGUo\nKSB7CiAgICAgICAgQ2FjaGVLZXkga2V5ID0gbmV3IENhY2hlS2V5KHRvcGlj\nLCAxKTsKICAgICAgICBjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLmFk\nZE1lc3NhZ2VUb0NhY2hlKGtleSwgbWVzc2FnZXMuZ2V0KDApLCBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEs\nIGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIuY2FjaGUuc2l6ZSgpKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoTVNHX1NJWkUsIGNhY2hlQmFzZWRQZXJz\naXN0ZW5jZU1hbmFnZXIucHJlc2VudENhY2hlU2l6ZSk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKDEsIGNhY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIub3Jk\nZXJlZEluZGV4T25TZXFJZC5nZXQodG9waWMpLnNpemUoKSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShjYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLm9yZGVy\nZWRJbmRleE9uU2VxSWQuZ2V0KHRvcGljKS5jb250YWlucygxTCkpOwoKICAg\nICAgICBDYWNoZVZhbHVlIHZhbHVlID0gY2FjaGVCYXNlZFBlcnNpc3RlbmNl\nTWFuYWdlci5jYWNoZS5nZXQoa2V5KTsKICAgICAgICBhc3NlcnRUcnVlKGNh\nY2hlQmFzZWRQZXJzaXN0ZW5jZU1hbmFnZXIudGltZUluZGV4T2ZBZGRpdGlv\nbi5nZXQodmFsdWUudGltZU9mQWRkaXRpb24pLmNvbnRhaW5zKGtleSkpOwog\nICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0UmVtb3ZlTWVz\nc2FnZUZyb21DYWNoZSgpIHsKICAgICAgICBDYWNoZUtleSBrZXkgPSBuZXcg\nQ2FjaGVLZXkodG9waWMsIDEpOwogICAgICAgIGNhY2hlQmFzZWRQZXJzaXN0\nZW5jZU1hbmFnZXIuYWRkTWVzc2FnZVRvQ2FjaGUoa2V5LCBtZXNzYWdlcy5n\nZXQoMCksIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKTsKICAgICAgICBj\nYWNoZUJhc2VkUGVyc2lzdGVuY2VNYW5hZ2VyLnJlbW92ZU1lc3NhZ2VGcm9t\nQ2FjaGUoa2V5LCBuZXcgRXhjZXB0aW9uKCksIHRydWUsIHRydWUpOwogICAg\nICAgIGFzc2VydFRydWUoY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFuYWdlci5j\nYWNoZS5pc0VtcHR5KCkpOwogICAgICAgIGFzc2VydFRydWUoY2FjaGVCYXNl\nZFBlcnNpc3RlbmNlTWFuYWdlci5vcmRlcmVkSW5kZXhPblNlcUlkLmlzRW1w\ndHkoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShjYWNoZUJhc2VkUGVyc2lzdGVu\nY2VNYW5hZ2VyLnRpbWVJbmRleE9mQWRkaXRpb24uaXNFbXB0eSgpKTsKICAg\nIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdENvbGxlY3RPbGRD\nYWNoZUVudHJpZXMoKSB7CiAgICAgICAgaW50IGkgPSAxOwogICAgICAgIGZv\nciAoTWVzc2FnZSBtIDogbWVzc2FnZXMpIHsKICAgICAgICAgICAgQ2FjaGVL\nZXkga2V5ID0gbmV3IENhY2hlS2V5KHRvcGljLCBpKTsKICAgICAgICAgICAg\nY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFuYWdlci5hZGRNZXNzYWdlVG9DYWNo\nZShrZXksIG0sIGkpOwogICAgICAgICAgICBpKys7CiAgICAgICAgfQoKICAg\nICAgICBpbnQgbiA9IDI7CiAgICAgICAgbXlDb25mLm1heENhY2hlU2l6ZSA9\nIG4gKiBNU0dfU0laRTsKICAgICAgICBjYWNoZUJhc2VkUGVyc2lzdGVuY2VN\nYW5hZ2VyLmNvbGxlY3RPbGRDYWNoZUVudHJpZXMoKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMobiwgY2FjaGVCYXNlZFBlcnNpc3RlbmNlTWFuYWdlci5jYWNo\nZS5zaXplKCkpOwogICAgICAgIGFzc2VydEVxdWFscyhuLCBjYWNoZUJhc2Vk\nUGVyc2lzdGVuY2VNYW5hZ2VyLnRpbWVJbmRleE9mQWRkaXRpb24uc2l6ZSgp\nKTsKICAgIH0KfQo=\n","encoding":"base64"}

