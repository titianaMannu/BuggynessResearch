{"sha":"956d31cfd63543e1593839ef18adc761b2d2a752","node_id":"MDQ6QmxvYjE1NzU5NTY6OTU2ZDMxY2ZkNjM1NDNlMTU5MzgzOWVmMThhZGM3NjFiMmQyYTc1Mg==","size":7923,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/956d31cfd63543e1593839ef18adc761b2d2a752","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TeW5jaHJvbm91c1F1ZXVlOwpp\nbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jvb2xl\nYW47CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWlj\nSW50ZWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29u\nZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmNsaWVudC5hcGkuUHVibGlzaGVyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LmFwaS5TdWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJz\nY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLkhlZHdpZ0h1YlRlc3RCYXNlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnV0aWwuQ29uY3VycmVuY3lVdGlsczsKaW1wb3J0IG9yZy5q\ndW5pdC5UZXN0OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0\ncmluZzsKCnB1YmxpYyBjbGFzcyBUZXN0Q29uY3VycmVudFRvcGljQWNxdWlz\naXRpb24gZXh0ZW5kcyBIZWR3aWdIdWJUZXN0QmFzZSB7CgogICAgLy8gQ2xp\nZW50IHZhcmlhYmxlcwogICAgcHJvdGVjdGVkIEhlZHdpZ0NsaWVudCBjbGll\nbnQ7CiAgICBwcm90ZWN0ZWQgUHVibGlzaGVyIHB1Ymxpc2hlcjsKICAgIHBy\nb3RlY3RlZCBTdWJzY3JpYmVyIHN1YnNjcmliZXI7CiAgICAKICAgIGZpbmFs\nIExpbmtlZEJsb2NraW5nUXVldWU8Qnl0ZVN0cmluZz4gc3Vic2NyaWJlcnMg\nPQogICAgICAgICAgICBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCeXRlU3Ry\naW5nPigpOwogICAgZmluYWwgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KCJjb25jdXJyZW50LXRvcGljIik7CiAgICBmaW5h\nbCBpbnQgbnVtU3Vic2NyaWJlcnMgPSAzMDA7CiAgICBmaW5hbCBBdG9taWNJ\nbnRlZ2VyIG51bURvbmUgPSBuZXcgQXRvbWljSW50ZWdlcigwKTsKCiAgICAv\nLyBTeW5jaHJvbm91c1F1ZXVlcyB0byB2ZXJpZnkgYXN5bmMgY2FsbHMKICAg\nIHByaXZhdGUgZmluYWwgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBxdWV1\nZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CiAgICAKICAg\nIGNsYXNzIFN1YkNhbGxiYWNrIGltcGxlbWVudHMgQ2FsbGJhY2s8Vm9pZD4g\newogICAgICAgIAogICAgICAgIEJ5dGVTdHJpbmcgc3ViSWQ7CiAgICAgICAg\nCiAgICAgICAgcHVibGljIFN1YkNhbGxiYWNrKEJ5dGVTdHJpbmcgc3ViSWQp\nIHsKICAgICAgICAgICAgdGhpcy5zdWJJZCA9IHN1YklkOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uRmluaXNoZWQoT2JqZWN0IGN0eCwKICAgICAgICAgICAgICAgIFZvaWQg\ncmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgaWYgKGxvZ2dlci5p\nc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZGVi\ndWcoInN1YnNjcmliZXIgIiArIHN1YklkLnRvU3RyaW5nVXRmOCgpICsgIiBz\ndWNjZWVkLiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGludCBkb25l\nID0gbnVtRG9uZS5pbmNyZW1lbnRBbmRHZXQoKTsKICAgICAgICAgICAgaWYg\nKGRvbmUgPT0gbnVtU3Vic2NyaWJlcnMpIHsKICAgICAgICAgICAgICAgIENv\nbmN1cnJlbmN5VXRpbHMucHV0KHF1ZXVlLCBmYWxzZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LAogICAgICAgICAg\nICAgICAgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAg\nICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1Zygic3Vic2NyaWJlciAiICsgc3ViSWQudG9TdHJp\nbmdVdGY4KCkgKyAiIGZhaWxlZCA6ICIsIGV4Y2VwdGlvbik7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQoc3Vic2Ny\naWJlcnMsIHN1YklkKTsKICAgICAgICAgICAgLy8gQ29uY3VycmVuY3lVdGls\ncy5wdXQocXVldWUsIGZhbHNlKTsKICAgICAgICB9CiAgICB9CiAgICAKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBzdXBlci5zZXRVcCgpOwogICAgICAgIGNsaWVu\ndCA9IG5ldyBIZWR3aWdDbGllbnQobmV3IENsaWVudENvbmZpZ3VyYXRpb24o\nKSk7CgogICAgICAgIHB1Ymxpc2hlciA9IGNsaWVudC5nZXRQdWJsaXNoZXIo\nKTsKICAgICAgICBzdWJzY3JpYmVyID0gY2xpZW50LmdldFN1YnNjcmliZXIo\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHRlYXJE\nb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc3ViLmludGVy\ncnVwdCgpOwogICAgICAgIC8vIHN1Yi5qb2luKCk7CiAgICAgICAgCiAgICAg\nICAgY2xpZW50LmNsb3NlKCk7CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsK\nICAgIH0KICAgIAogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RUb3Bp\nY0FjcXVpc3Rpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBsb2dn\nZXIuaW5mbygiU3RhcnQgY29uY3VycmVudCB0b3BpYyBhY3F1aXN0aW9uIHRl\nc3QuIik7CiAgICAgICAgCiAgICAgICAgLy8gbGV0IG9uZSBib29raWUgZG93\nbiB0byBjYXVzZSBub3QgZW5vdWdoIGJvb2tpZSBleGNlcHRpb24KICAgICAg\nICBsb2dnZXIuaW5mbygiVGVhciBkb3duIG9uZSBib29raWUgc2VydmVyLiIp\nOwogICAgICAgIGJrdGIudGVhckRvd25PbmVCb29raWVTZXJ2ZXIoKTsKICAg\nICAgICAKICAgICAgICAvLyBJbiBjdXJyZW50IGltcGxlbWVudGF0aW9uLCB0\naGUgZmlyc3Qgc2V2ZXJhbCBzdWJzY3JpcHRpb25zIHdpbGwgc3VjY2VlZCB0\nbyBwdXQgdG9waWMgaW4gdG9waWMgbWFuYWdlciBzZXQsCiAgICAgICAgLy8g\nYmVjYXVzZSB0aGUgdGVhciBkb3duIGJvb2tpZSBzZXJ2ZXIncyB6ayBub2Rl\nIG5lZWQgdGltZSB0byBkaXNhcHBlYXIKICAgICAgICAvLyBzb21lIHN1YnNj\ncmlwdGlvbnMgd2lsbCBjcmVhdGUgbGVkZ2VyIHN1Y2Nlc3NmdWxseSwgdGhl\nbiBvdGhlciBzdWJzY3JpcHRpb25zIHdpbGwgZmFpbC4KICAgICAgICAvLyB0\naGUgcmFjZSBjb25kaXRpb24gd2lsbCBiZTogdG9waWMgbWFuYWdlciBvd24g\ndG9waWMgYnV0IHBlcnNpc3RlbmNlIG1hbmFnZXIgZG9lc24ndAogICAgICAg\nIAogICAgICAgIC8vIDMwMCBzdWJzY3JpYmVycyBzdWJzY3JpYmUgdG8gYSBz\nYW1lIHRvcGljCiAgICAgICAgZmluYWwgQXRvbWljQm9vbGVhbiBpblJlZGly\nZWN0TG9vcCA9IG5ldyBBdG9taWNCb29sZWFuKGZhbHNlKTsKICAgICAgICBu\ndW1Eb25lLnNldCgwKTsKICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtU3Vi\nc2NyaWJlcnM7IGkrKykgewogICAgICAgICAgICBCeXRlU3RyaW5nIHN1Yklk\nID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoInN1Yi0iICsgaSk7CiAgICAg\nICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAg\nICAgICAgICAgbG9nZ2VyLmRlYnVnKCJzdWJzY3JpYmVyICIgKyBzdWJJZC50\nb1N0cmluZ1V0ZjgoKSArICIgc3Vic2NyaWJlcyB0b3BpYyAiICsgdG9waWMu\ndG9TdHJpbmdVdGY4KCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN1\nYnNjcmliZXIuYXN5bmNTdWJzY3JpYmUodG9waWMsIHN1YklkLCBDcmVhdGVP\nckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNILAogICAgICAgICAgICAgICAgbmV3\nIENhbGxiYWNrPFZvaWQ+KCkgewogICAgICAgICAgICAgICAgCiAgICAgICAg\nICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHRpY2soKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGlmIChudW1Eb25lLmluY3JlbWVudEFuZEdldCgpID09\nIG51bVN1YnNjcmliZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBDb25jdXJyZW5jeVV0aWxzLnB1dChxdWV1ZSwgdHJ1ZSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBWb2lkIHJlc3VsdE9mT3BlcmF0\naW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2soKTsKICAgICAg\nICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZh\naWxlZChPYmplY3QgY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoZXhjZXB0aW9uIGluc3RhbmNlb2YgUHViU3ViRXhjZXB0\naW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBTdHJpbmcgbXNnID0gZXhjZXB0aW9uLmdldE1lc3NhZ2Uo\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtc2cuaW5kZXhP\nZigiU2VydmVyUmVkaXJlY3RMb29wRXhjZXB0aW9uIikgPiAwKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5SZWRpcmVjdExvb3Auc2V0\nKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2Vy\nLmRlYnVnKCJPcGVyYXRpb24gZmFpbGVkIDogIiwgZXhjZXB0aW9uKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB0aWNrKCk7IAogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAg\nICAgICAgfSwKICAgICAgICAgICAgbnVsbCk7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIHF1ZXVlLnRha2UoKTsKICAgICAgICAKICAgICAgICAvLyBU\nT0RPOiByZW1vdmUgY29tbWVudCBhZnRlciB3ZSBmaXggdGhlIGlzc3VlCiAg\nICAgICAgLy8gQXNzZXJ0LmFzc2VydEVxdWFscyhmYWxzZSwgaW5SZWRpcmVj\ndExvb3AuZ2V0KCkpOwogICAgICAgIAogICAgICAgIC8vIHN0YXJ0IGEgdGhy\nZWFkIHRvIHNlbmQgc3Vic2NyaXB0aW9ucwogICAgICAgIG51bURvbmUuc2V0\nKDApOwogICAgICAgIFRocmVhZCBzdWIgPSBuZXcgVGhyZWFkKG5ldyBSdW5u\nYWJsZSgpIHsKCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuaW5m\nbygic3ViIHRocmVhZCBzdGFydGVkIik7CiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIC8vIDEwMCBzdWJzY3JpYmVycyBzdWJz\nY3JpYmUgdG8gYSBzYW1lIHRvcGljCiAgICAgICAgICAgICAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPG51bVN1YnNjcmliZXJzOyBpKyspIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQgPSBCeXRl\nU3RyaW5nLmNvcHlGcm9tVXRmOCgic3ViLSIgKyBpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgc3Vic2NyaWJlcnMucHV0KHN1YnNjcmliZXJJZCk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAg\nICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcgc3ViSWQ7CiAgICAgICAgICAg\nICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgc3ViSWQgPSBzdWJzY3JpYmVycy50YWtlKCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2Vy\nLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1Zygic3Vic2NyaWJlciAiICsgc3ViSWQudG9TdHJp\nbmdVdGY4KCkgKyAiIHN1YnNjcmliZXMgdG9waWMgIiArIHRvcGljLnRvU3Ry\naW5nVXRmOCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRv\ncGljLCBzdWJJZCwgQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBTdWJDYWxsYmFjayhz\ndWJJZCksIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICAvLyBzdWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRvcGlj\nLCBzdWJzY3JpYmVySWQsIG1vZGUsIGNhbGxiYWNrLCBjb250ZXh0KQogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUp\nIHsKICAgICAgICAgICAgICAgICAgICAvLyBicmVhawogICAgICAgICAgICAg\nICAgICAgIGxvZ2dlci53YXJuKCJJbnRlcnJ1cHRlZCA6ICIsIGllKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICB9KTsKICAg\nICAgICBzdWIuc3RhcnQoKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMjAwMCk7\nCiAgICAgICAgCiAgICAgICAgLy8gc3RhcnQgYSBuZXcgYm9va2llIHNlcnZl\ncgogICAgICAgIGxvZ2dlci5pbmZvKCJzdGFydCBuZXcgYm9va2llIHNlcnZl\nciIpOwogICAgICAgIGJrdGIuc3RhcnRVcE5ld0Jvb2tpZVNlcnZlcigpOwog\nICAgICAgIAogICAgICAgIC8vIGhvcGUgdGhhdCBhbGwgdGhlIHN1YnNjcmlw\ndGlvbnMgd2lsbCBiZSBPSwogICAgICAgIHF1ZXVlLnRha2UoKTsKICAgIH0K\nCn0K\n","encoding":"base64"}

