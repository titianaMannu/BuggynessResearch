{"sha":"8c7cbd2a99f59dd958721c80f53dd160dcb958de","node_id":"MDQ6QmxvYjE1NzU5NTY6OGM3Y2JkMmE5OWY1OWRkOTU4NzIxYzgwZjUzZGQxNjBkY2I5NThkZQ==","size":11595,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8c7cbd2a99f59dd958721c80f53dd160dcb958de","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LlNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZTsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlN5bmNocm9ub3VzUXVldWU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmp1bml0LkFzc2VydDsKaW1wb3J0IG9yZy5qdW5pdC5CZWZv\ncmU7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKCmltcG9ydCBjb20uZ29vZ2xl\nLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uLkNvbXBvc2l0\nZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5j\nb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnV0aWwuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy51dGlsLkNvbmN1cnJlbmN5VXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy51dGlsLkVpdGhlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0\naWwuSGVkd2lnU29ja2V0QWRkcmVzczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnV0aWwuUGFpcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnpvb2tl\nZXBlci5ab29LZWVwZXJUZXN0QmFzZTsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCnB1YmxpYyBj\nbGFzcyBUZXN0WmtUb3BpY01hbmFnZXIgZXh0ZW5kcyBab29LZWVwZXJUZXN0\nQmFzZSB7CgogICAgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5\nLmdldExvZ2dlcihUZXN0WmtUb3BpY01hbmFnZXIuY2xhc3MpOwoKICAgIHBy\nb3RlY3RlZCBaa1RvcGljTWFuYWdlciB0bTsKCiAgICBwcm90ZWN0ZWQgY2xh\nc3MgQ2FsbGJhY2tRdWV1ZTxUPiBpbXBsZW1lbnRzIENhbGxiYWNrPFQ+IHsK\nICAgICAgICBTeW5jaHJvbm91c1F1ZXVlPEVpdGhlcjxULCBFeGNlcHRpb24+\nPiBxID0gbmV3IFN5bmNocm9ub3VzUXVldWU8RWl0aGVyPFQsIEV4Y2VwdGlv\nbj4+KCk7CgogICAgICAgIHB1YmxpYyBTeW5jaHJvbm91c1F1ZXVlPEVpdGhl\ncjxULCBFeGNlcHRpb24+PiBnZXRRdWV1ZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuIHE7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRWl0aGVyPFQsIEV4\nY2VwdGlvbj4gdGFrZSgpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIHJldHVybiBxLnRha2UoKTsKICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZh\naWxlZChPYmplY3QgY3R4LCBmaW5hbCBQdWJTdWJFeGNlcHRpb24gZXhjZXB0\naW9uKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiZ290IGV4Y2VwdGlvbjog\nIiArIGV4Y2VwdGlvbik7CiAgICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1\nbm5hYmxlKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAg\nICAgQ29uY3VycmVuY3lVdGlscy5wdXQocSwgRWl0aGVyLm9mKChUKSBudWxs\nLCAoRXhjZXB0aW9uKSBleGNlcHRpb24pKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfSkuc3RhcnQoKTsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVk\nKE9iamVjdCBjdHgsIGZpbmFsIFQgcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAg\nICAgICAgICAgbmV3IFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxz\nLnB1dChxLCBFaXRoZXIub2YocmVzdWx0T2ZPcGVyYXRpb24sIChFeGNlcHRp\nb24pIG51bGwpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSku\nc3RhcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIENhbGxi\nYWNrUXVldWU8SGVkd2lnU29ja2V0QWRkcmVzcz4gYWRkckNicSA9IG5ldyBD\nYWxsYmFja1F1ZXVlPEhlZHdpZ1NvY2tldEFkZHJlc3M+KCk7CiAgICBwcm90\nZWN0ZWQgQ2FsbGJhY2tRdWV1ZTxCeXRlU3RyaW5nPiBic0NicSA9IG5ldyBD\nYWxsYmFja1F1ZXVlPEJ5dGVTdHJpbmc+KCk7CiAgICBwcm90ZWN0ZWQgQ2Fs\nbGJhY2tRdWV1ZTxWb2lkPiB2b2lkQ2JxID0gbmV3IENhbGxiYWNrUXVldWU8\nVm9pZD4oKTsKCiAgICBwcm90ZWN0ZWQgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KCJ0b3BpYyIpOwogICAgcHJvdGVjdGVk\nIFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnOwogICAgcHJvdGVjdGVkIEhlZHdp\nZ1NvY2tldEFkZHJlc3MgbWU7CiAgICBwcm90ZWN0ZWQgU2NoZWR1bGVkRXhl\nY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcjsKCiAgICBAT3ZlcnJpZGUKICAgIEBC\nZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoKTsKICAgICAgICBjZmcgPSBuZXcg\nU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAgIG1lID0gY2ZnLmdldFNl\ncnZlckFkZHIoKTsKICAgICAgICBzY2hlZHVsZXIgPSBFeGVjdXRvcnMubmV3\nU2luZ2xlVGhyZWFkU2NoZWR1bGVkRXhlY3V0b3IoKTsKICAgICAgICB0bSA9\nIG5ldyBaa1RvcGljTWFuYWdlcih6aywgY2ZnLCBzY2hlZHVsZXIpOwogICAg\nfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0T3duZXJTaW5n\nbGUoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0bS5nZXRPd25lcih0\nb3BpYywgZmFsc2UsIGFkZHJDYnEsIG51bGwpOwogICAgICAgIEFzc2VydC5h\nc3NlcnRFcXVhbHMobWUsIGNoZWNrKGFkZHJDYnEudGFrZSgpKSk7CiAgICB9\nCgogICAgcHJvdGVjdGVkIEJ5dGVTdHJpbmcgbWtUb3BpYyhpbnQgaSkgewog\nICAgICAgIHJldHVybiBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCh0b3BpYy50\nb1N0cmluZ1V0ZjgoKSArIGkpOwogICAgfQoKICAgIHByb3RlY3RlZCA8VD4g\nVCBjaGVjayhFaXRoZXI8VCwgRXhjZXB0aW9uPiBleCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKGV4LmxlZnQoKSA9PSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBleC5yaWdodCgpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgcmV0dXJuIGV4LmxlZnQoKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGlj\nIGNsYXNzIEN1c3RvbVNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5kcyBTZXJ2\nZXJDb25maWd1cmF0aW9uIHsKICAgICAgICBpbnQgcG9ydDsKCiAgICAgICAg\ncHVibGljIEN1c3RvbVNlcnZlckNvbmZpZ3VyYXRpb24oaW50IHBvcnQpIHsK\nICAgICAgICAgICAgdGhpcy5wb3J0ID0gcG9ydDsKICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgZ2V0U2VydmVyUG9y\ndCgpIHsKICAgICAgICAgICAgcmV0dXJuIHBvcnQ7CiAgICAgICAgfQogICAg\nfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0T3duZXJNdWx0\naSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY2ZnMSA9IG5ldyBDdXN0b21TZXJ2ZXJDb25maWd1cmF0aW9uKGNm\nZy5nZXRTZXJ2ZXJQb3J0KCkgKyAxKSwgY2ZnMiA9IG5ldyBDdXN0b21TZXJ2\nZXJDb25maWd1cmF0aW9uKAogICAgICAgICAgICBjZmcuZ2V0U2VydmVyUG9y\ndCgpICsgMik7CiAgICAgICAgLy8gVE9ETyBjaGFuZ2UgY2ZnMSBjZmcyIHBh\ncmFtcwogICAgICAgIFprVG9waWNNYW5hZ2VyIHRtMSA9IG5ldyBaa1RvcGlj\nTWFuYWdlcih6aywgY2ZnMSwgc2NoZWR1bGVyKSwgdG0yID0gbmV3IFprVG9w\naWNNYW5hZ2VyKHprLCBjZmcyLCBzY2hlZHVsZXIpOwoKICAgICAgICB0bS5n\nZXRPd25lcih0b3BpYywgZmFsc2UsIGFkZHJDYnEsIG51bGwpOwogICAgICAg\nIEhlZHdpZ1NvY2tldEFkZHJlc3Mgb3duZXIgPSBjaGVjayhhZGRyQ2JxLnRh\na2UoKSk7CgogICAgICAgIC8vIElmIHdlIHdlcmUgdG9sZCB0byBoYXZlIGFu\nb3RoZXIgcGVyc29uIGNsYWltIHRoZSB0b3BpYywgbWFrZSB0aGVtCiAgICAg\nICAgLy8gY2xhaW0gdGhlIHRvcGljLgogICAgICAgIGlmIChvd25lci5nZXRQ\nb3J0KCkgPT0gY2ZnMS5nZXRTZXJ2ZXJQb3J0KCkpCiAgICAgICAgICAgIHRt\nMS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNicSwgbnVsbCk7CiAgICAg\nICAgZWxzZSBpZiAob3duZXIuZ2V0UG9ydCgpID09IGNmZzIuZ2V0U2VydmVy\nUG9ydCgpKQogICAgICAgICAgICB0bTIuZ2V0T3duZXIodG9waWMsIHRydWUs\nIGFkZHJDYnEsIG51bGwpOwogICAgICAgIGlmIChvd25lci5nZXRQb3J0KCkg\nIT0gY2ZnLmdldFNlcnZlclBvcnQoKSkKICAgICAgICAgICAgQXNzZXJ0LmFz\nc2VydEVxdWFscyhvd25lciwgY2hlY2soYWRkckNicS50YWtlKCkpKTsKCiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxMDA7ICsraSkgewogICAgICAg\nICAgICB0bS5nZXRPd25lcih0b3BpYywgZmFsc2UsIGFkZHJDYnEsIG51bGwp\nOwogICAgICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKG93bmVyLCBjaGVj\nayhhZGRyQ2JxLnRha2UoKSkpOwoKICAgICAgICAgICAgdG0xLmdldE93bmVy\nKHRvcGljLCBmYWxzZSwgYWRkckNicSwgbnVsbCk7CiAgICAgICAgICAgIEFz\nc2VydC5hc3NlcnRFcXVhbHMob3duZXIsIGNoZWNrKGFkZHJDYnEudGFrZSgp\nKSk7CgogICAgICAgICAgICB0bTIuZ2V0T3duZXIodG9waWMsIGZhbHNlLCBh\nZGRyQ2JxLCBudWxsKTsKICAgICAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFs\ncyhvd25lciwgY2hlY2soYWRkckNicS50YWtlKCkpKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIEdpdmUgdXMgMTAwIGNoYW5jZXMgdG8gY2hvb3NlIGFub3Ro\nZXIgb3duZXIgaWYgbm90IHNob3VsZENsYWltLgogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgMTAwOyArK2kpIHsKICAgICAgICAgICAgaWYgKCFvd25l\nci5lcXVhbHMobWUpKQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIHRtLmdldE93bmVyKG1rVG9waWMoaSksIGZhbHNlLCBhZGRyQ2JxLCBu\ndWxsKTsKICAgICAgICAgICAgb3duZXIgPSBjaGVjayhhZGRyQ2JxLnRha2Uo\nKSk7CiAgICAgICAgICAgIGlmIChpID09IDk5KQogICAgICAgICAgICAgICAg\nQXNzZXJ0LmZhaWwoIk5ldmVyIGNob3NlIGFub3RoZXIgb3duZXIiKTsKICAg\nICAgICB9CgogICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBhbHdheXMgY2hvb3Nl\nIG91cnNlbHZlcyBpZiBzaG91bGRDbGFpbS4KICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IDEwMDsgKytpKSB7CiAgICAgICAgICAgIHRtLmdldE93bmVy\nKG1rVG9waWMoMTAwKSwgdHJ1ZSwgYWRkckNicSwgbnVsbCk7CiAgICAgICAg\nICAgIEFzc2VydC5hc3NlcnRFcXVhbHMobWUsIGNoZWNrKGFkZHJDYnEudGFr\nZSgpKSk7CiAgICAgICAgfQogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMg\ndm9pZCB0ZXN0TG9hZEJhbGFuY2luZygpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHRtLmdldE93bmVyKHRvcGljLCBmYWxzZSwgYWRkckNicSwgbnVs\nbCk7CgogICAgICAgIEFzc2VydC5hc3NlcnRFcXVhbHMobWUsIGNoZWNrKGFk\nZHJDYnEudGFrZSgpKSk7CgogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24g\nY2ZnMSA9IG5ldyBDdXN0b21TZXJ2ZXJDb25maWd1cmF0aW9uKGNmZy5nZXRT\nZXJ2ZXJQb3J0KCkgKyAxKTsKICAgICAgICBuZXcgWmtUb3BpY01hbmFnZXIo\nemssIGNmZzEsIHNjaGVkdWxlcik7CgogICAgICAgIEJ5dGVTdHJpbmcgdG9w\naWMxID0gbWtUb3BpYygxKTsKICAgICAgICB0bS5nZXRPd25lcih0b3BpYzEs\nIGZhbHNlLCBhZGRyQ2JxLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0\nRXF1YWxzKGNmZzEuZ2V0U2VydmVyQWRkcigpLCBjaGVjayhhZGRyQ2JxLnRh\na2UoKSkpOwoKICAgIH0KCiAgICBjbGFzcyBTdHViT3duZXJzaGlwQ2hhbmdl\nTGlzdGVuZXIgaW1wbGVtZW50cyBUb3BpY093bmVyc2hpcENoYW5nZUxpc3Rl\nbmVyIHsKICAgICAgICBib29sZWFuIGZhaWx1cmU7CiAgICAgICAgU3luY2hy\nb25vdXNRdWV1ZTxQYWlyPEJ5dGVTdHJpbmcsIEJvb2xlYW4+PiBic1F1ZXVl\nOwoKICAgICAgICBwdWJsaWMgU3R1Yk93bmVyc2hpcENoYW5nZUxpc3RlbmVy\nKFN5bmNocm9ub3VzUXVldWU8UGFpcjxCeXRlU3RyaW5nLCBCb29sZWFuPj4g\nYnNRdWV1ZSkgewogICAgICAgICAgICB0aGlzLmJzUXVldWUgPSBic1F1ZXVl\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0RmFpbHVyZShi\nb29sZWFuIGZhaWx1cmUpIHsKICAgICAgICAgICAgdGhpcy5mYWlsdXJlID0g\nZmFpbHVyZTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyB2b2lkIGxvc3RUb3BpYyhmaW5hbCBCeXRlU3RyaW5nIHRvcGlj\nKSB7CiAgICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewog\nICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJs\naWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVu\nY3lVdGlscy5wdXQoYnNRdWV1ZSwgUGFpci5vZih0b3BpYywgZmFsc2UpKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuc3RhcnQoKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGFjcXVpcmVkVG9waWMoZmlu\nYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2Fs\nbGJhY2ssIGZpbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgbmV3IFRo\ncmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAg\nICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChic1F1ZXVlLCBQ\nYWlyLm9mKHRvcGljLCB0cnVlKSk7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGZhaWx1cmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2su\nb3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2\naWNlRG93bkV4Y2VwdGlvbigiQXNrZWQgdG8gZmFpbCIpKTsKICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBj\nYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjdHgsIG51bGwpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfSkuc3RhcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QKICAgIHB1\nYmxpYyB2b2lkIHRlc3RPd25lcnNoaXBDaGFuZ2UoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBTeW5jaHJvbm91c1F1ZXVlPFBhaXI8Qnl0ZVN0cmlu\nZywgQm9vbGVhbj4+IGJzUXVldWUgPSBuZXcgU3luY2hyb25vdXNRdWV1ZTxQ\nYWlyPEJ5dGVTdHJpbmcsIEJvb2xlYW4+PigpOwoKICAgICAgICBTdHViT3du\nZXJzaGlwQ2hhbmdlTGlzdGVuZXIgbGlzdGVuZXIgPSBuZXcgU3R1Yk93bmVy\nc2hpcENoYW5nZUxpc3RlbmVyKGJzUXVldWUpOwoKICAgICAgICB0bS5hZGRU\nb3BpY093bmVyc2hpcENoYW5nZUxpc3RlbmVyKGxpc3RlbmVyKTsKCiAgICAg\nICAgLy8gcmVndWxhciBhY3F1aXJlCiAgICAgICAgdG0uZ2V0T3duZXIodG9w\naWMsIHRydWUsIGFkZHJDYnEsIG51bGwpOwogICAgICAgIFBhaXI8Qnl0ZVN0\ncmluZywgQm9vbGVhbj4gcGFpciA9IGJzUXVldWUudGFrZSgpOwogICAgICAg\nIEFzc2VydC5hc3NlcnRFcXVhbHModG9waWMsIHBhaXIuZmlyc3QoKSk7CiAg\nICAgICAgQXNzZXJ0LmFzc2VydFRydWUocGFpci5zZWNvbmQoKSk7CiAgICAg\nICAgQXNzZXJ0LmFzc2VydEVxdWFscyhtZSwgY2hlY2soYWRkckNicS50YWtl\nKCkpKTsKICAgICAgICBhc3NlcnRPd25lcnNoaXBOb2RlRXhpc3RzKCk7Cgog\nICAgICAgIC8vIHRvcGljIHRoYXQgSSBhbHJlYWR5IG93bgogICAgICAgIHRt\nLmdldE93bmVyKHRvcGljLCB0cnVlLCBhZGRyQ2JxLCBudWxsKTsKICAgICAg\nICBBc3NlcnQuYXNzZXJ0RXF1YWxzKG1lLCBjaGVjayhhZGRyQ2JxLnRha2Uo\nKSkpOwogICAgICAgIEFzc2VydC5hc3NlcnRUcnVlKGJzUXVldWUuaXNFbXB0\neSgpKTsKICAgICAgICBhc3NlcnRPd25lcnNoaXBOb2RlRXhpc3RzKCk7Cgog\nICAgICAgIC8vIHJlZ3VsYXIgcmVsZWFzZQogICAgICAgIHRtLnJlbGVhc2VU\nb3BpYyh0b3BpYywgY2IsIG51bGwpOwogICAgICAgIHBhaXIgPSBic1F1ZXVl\nLnRha2UoKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKHRvcGljLCBw\nYWlyLmZpcnN0KCkpOwogICAgICAgIEFzc2VydC5hc3NlcnRGYWxzZShwYWly\nLnNlY29uZCgpKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0VHJ1ZShxdWV1ZS50\nYWtlKCkpOwogICAgICAgIGFzc2VydE93bmVyc2hpcE5vZGVEb2VzbnRFeGlz\ndCgpOwoKICAgICAgICAvLyByZWxlYXNpbmcgdG9waWMgdGhhdCBJIGRvbid0\nIG93bgogICAgICAgIHRtLnJlbGVhc2VUb3BpYyhta1RvcGljKDApLCBjYiwg\nbnVsbCk7CiAgICAgICAgQXNzZXJ0LmFzc2VydFRydWUocXVldWUudGFrZSgp\nKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0VHJ1ZShic1F1ZXVlLmlzRW1wdHko\nKSk7CgogICAgICAgIC8vIHNldCBsaXN0ZW5lciB0byByZXR1cm4gZXJyb3IK\nICAgICAgICBsaXN0ZW5lci5zZXRGYWlsdXJlKHRydWUpOwoKICAgICAgICB0\nbS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNicSwgbnVsbCk7CiAgICAg\nICAgcGFpciA9IGJzUXVldWUudGFrZSgpOwogICAgICAgIEFzc2VydC5hc3Nl\ncnRFcXVhbHModG9waWMsIHBhaXIuZmlyc3QoKSk7CiAgICAgICAgQXNzZXJ0\nLmFzc2VydFRydWUocGFpci5zZWNvbmQoKSk7CiAgICAgICAgQXNzZXJ0LmFz\nc2VydEVxdWFscyhQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRp\nb24uY2xhc3MsICgoQ29tcG9zaXRlRXhjZXB0aW9uKSBhZGRyQ2JxLnRha2Uo\nKS5yaWdodCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldEV4\nY2VwdGlvbnMoKS5pdGVyYXRvcigpLm5leHQoKS5nZXRDbGFzcygpKTsKICAg\nICAgICBBc3NlcnQuYXNzZXJ0RmFsc2UodG0udG9waWNzLmNvbnRhaW5zKHRv\ncGljKSk7CiAgICAgICAgVGhyZWFkLnNsZWVwKDEwMCk7CiAgICAgICAgYXNz\nZXJ0T3duZXJzaGlwTm9kZURvZXNudEV4aXN0KCk7CgogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGFzc2VydE93bmVyc2hpcE5vZGVFeGlzdHMoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBieXRlW10gZGF0YSA9IHprLmdldERhdGEo\ndG0uaHViUGF0aCh0b3BpYyksIGZhbHNlLCBudWxsKTsKICAgICAgICBBc3Nl\ncnQuYXNzZXJ0RXF1YWxzKG5ldyBIZWR3aWdTb2NrZXRBZGRyZXNzKG5ldyBT\ndHJpbmcoZGF0YSkpLCB0bS5hZGRyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBhc3NlcnRPd25lcnNoaXBOb2RlRG9lc250RXhpc3QoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICB6ay5nZXREYXRh\nKHRtLmh1YlBhdGgodG9waWMpLCBmYWxzZSwgbnVsbCk7CiAgICAgICAgICAg\nIEFzc2VydC5hc3NlcnRUcnVlKGZhbHNlKTsKICAgICAgICB9IGNhdGNoIChL\nZWVwZXJFeGNlcHRpb24gZSkgewogICAgICAgICAgICBBc3NlcnQuYXNzZXJ0\nRXF1YWxzKGUuY29kZSgpLCBLZWVwZXJFeGNlcHRpb24uQ29kZS5OT05PREUp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQg\ndGVzdFpLQ2xpZW50RGlzY29ubmVjdGVkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gRmlyc3QgYXNzZXJ0IG93bmVyc2hpcCBvZiB0aGUgdG9w\naWMKICAgICAgICB0bS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNicSwg\nbnVsbCk7CiAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhtZSwgY2hlY2so\nYWRkckNicS50YWtlKCkpKTsKCiAgICAgICAgLy8gU3VzcGVuZCB0aGUgWktU\nb3BpY01hbmFnZXIgYW5kIG1ha2Ugc3VyZSBjYWxscyB0byBnZXRPd25lciBl\ncnJvciBvdXQKICAgICAgICB0bS5pc1N1c3BlbmRlZCA9IHRydWU7CiAgICAg\nICAgdG0uZ2V0T3duZXIodG9waWMsIHRydWUsIGFkZHJDYnEsIG51bGwpOwog\nICAgICAgIEFzc2VydC5hc3NlcnRFcXVhbHMoUHViU3ViRXhjZXB0aW9uLlNl\ncnZpY2VEb3duRXhjZXB0aW9uLmNsYXNzLCBhZGRyQ2JxLnRha2UoKS5yaWdo\ndCgpLmdldENsYXNzKCkpOwogICAgICAgIC8vIFJlbGVhc2UgdGhlIHRvcGlj\nLiBUaGlzIHNob3VsZCBub3QgZXJyb3Igb3V0IGV2ZW4gaWYgc3VzcGVuZGVk\nLgogICAgICAgIHRtLnJlbGVhc2VUb3BpYyh0b3BpYywgY2IsIG51bGwpOwog\nICAgICAgIEFzc2VydC5hc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAg\nICAgYXNzZXJ0T3duZXJzaGlwTm9kZURvZXNudEV4aXN0KCk7CgogICAgICAg\nIC8vIFJlc3RhcnQgdGhlIFpLVG9waWNNYW5hZ2VyIGFuZCBtYWtlIHN1cmUg\nY2FsbHMgdG8gZ2V0T3duZXIgYXJlIG9rYXkKICAgICAgICB0bS5pc1N1c3Bl\nbmRlZCA9IGZhbHNlOwogICAgICAgIHRtLmdldE93bmVyKHRvcGljLCB0cnVl\nLCBhZGRyQ2JxLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxz\nKG1lLCBjaGVjayhhZGRyQ2JxLnRha2UoKSkpOwogICAgICAgIGFzc2VydE93\nbmVyc2hpcE5vZGVFeGlzdHMoKTsKICAgIH0KCn0K\n","encoding":"base64"}

