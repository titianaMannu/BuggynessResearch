{"sha":"ec3cd610f532321e7663b6509f167b89065da3b7","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWMzY2Q2MTBmNTMyMzIxZTc2NjNiNjUwOWYxNjdiODkwNjVkYTNiNw==","size":6039,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ec3cd610f532321e7663b6509f167b89065da3b7","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0\naGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z\nIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICov\nCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJlbmNobWFyazsKCmlt\ncG9ydCBvcmcuanVuaXQuQmVmb3JlQ2xhc3M7CmltcG9ydCBvcmcuanVuaXQu\nQWZ0ZXJDbGFzczsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQgb3Jn\nLmp1bml0LkFzc2VydDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkJvb2tLZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5uZXQuQm9va2llU29ja2V0QWRkcmVzczsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVwZXJDbHVzdGVyVGVzdENh\nc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5Mb2NhbEJv\nb2tLZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVk\nRXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlci5FdmVudC5FdmVu\ndFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyLkV2\nZW50LktlZXBlclN0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nWm9vS2VlcGVyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGphdmEudXRpbC5BcnJh\neXM7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVu\ndC5hdG9taWMuQXRvbWljQm9vbGVhbjsKCnB1YmxpYyBjbGFzcyBUZXN0QmVu\nY2htYXJrIGV4dGVuZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CiAg\nICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJG\nYWN0b3J5LmdldExvZ2dlcihUZXN0QmVuY2htYXJrLmNsYXNzKTsKCiAgICBw\ndWJsaWMgVGVzdEJlbmNobWFyaygpIHsKICAgICAgICBzdXBlcig1KTsKICAg\nIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQg\ndGVzdFRocm91Z2hwdXRMYXRlbmN5KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgU3RyaW5nIGxhdGVuY3lGaWxlID0gU3lzdGVtLmdldFByb3BlcnR5\nKCJ0ZXN0LmxhdGVuY3kuZmlsZSIsICJsYXRlbmN5RHVtcC5kYXQiKTsKICAg\nICAgICBCZW5jaFRocm91Z2hwdXRMYXRlbmN5Lm1haW4obmV3IFN0cmluZ1td\nIHsKICAgICAgICAgICAgICAgICItLXpvb2tlZXBlciIsIHprVXRpbC5nZXRa\nb29LZWVwZXJDb25uZWN0U3RyaW5nKCksCiAgICAgICAgICAgICAgICAiLS10\naW1lIiwgIjEwIiwKICAgICAgICAgICAgICAgICItLXNraXB3YXJtdXAiLAog\nICAgICAgICAgICAgICAgIi0tdGhyb3R0bGUiLCAiMSIsCiAgICAgICAgICAg\nICAgICAiLS1zZW5kbGltaXQiLCAiMTAwMDAiLAogICAgICAgICAgICAgICAg\nIi0tbGF0ZW5jeUZpbGUiLCBsYXRlbmN5RmlsZQogICAgICAgICAgICB9KTsK\nICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZv\naWQgdGVzdEJvb2tpZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJv\nb2tpZVNvY2tldEFkZHJlc3MgYm9va2llID0gZ2V0Qm9va2llKDApOwogICAg\nICAgIEJlbmNoQm9va2llLm1haW4obmV3IFN0cmluZ1tdIHsKICAgICAgICAg\nICAgICAgICItLWhvc3QiLCBib29raWUuZ2V0U29ja2V0QWRkcmVzcygpLmdl\ndEhvc3ROYW1lKCksCiAgICAgICAgICAgICAgICAiLS1wb3J0IiwgU3RyaW5n\nLnZhbHVlT2YoYm9va2llLmdldFBvcnQoKSksCiAgICAgICAgICAgICAgICAi\nLS16b29rZWVwZXIiLCB6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmlu\nZygpCiAgICAgICAgICAgICAgICB9KTsKICAgIH0KCiAgICBAVGVzdCh0aW1l\nb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFJlYWRUaHJvdWdocHV0\nTGF0ZW5jeSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGZpbmFsIEF0\nb21pY0Jvb2xlYW4gdGhyZXdFeGNlcHRpb24gPSBuZXcgQXRvbWljQm9vbGVh\nbihmYWxzZSk7CiAgICAgICAgVGhyZWFkIHQgPSBuZXcgVGhyZWFkKCkgewog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEJlbmNo\nUmVhZFRocm91Z2hwdXRMYXRlbmN5Lm1haW4obmV3IFN0cmluZ1tdIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiLS16b29rZWVwZXIiLCB6\na1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICItLWxpc3RlbiIsICIxMCJ9KTsKICAg\nICAgICAgICAgICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHJlYWRpbmci\nLCB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyZXdFeGNlcHRpb24u\nc2V0KHRydWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB0LnN0YXJ0KCk7CgogICAg\nICAgIFRocmVhZC5zbGVlcCgxMDAwMCk7CiAgICAgICAgYnl0ZSBkYXRhW10g\nPSBuZXcgYnl0ZVsxMDI0XTsKICAgICAgICBBcnJheXMuZmlsbChkYXRhLCAo\nYnl0ZSkneCcpOwoKICAgICAgICBsb25nIGxhc3RMZWRnZXJJZCA9IDA7CiAg\nICAgICAgQXNzZXJ0LmFzc2VydFRydWUoIlRocmVhZCBzaG91bGQgYmUgcnVu\nbmluZyIsIHQuaXNBbGl2ZSgpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgQm9va0tlZXBlciBiayA9IG5l\ndyBCb29rS2VlcGVyKHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5n\nKCkpOwogICAgICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBiay5jcmVhdGVM\nZWRnZXIoQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLCAiYmVuY2hQYXNz\nd2QiLmdldEJ5dGVzKCkpOwogICAgICAgICAgICBsYXN0TGVkZ2VySWQgPSBs\naC5nZXRJZCgpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nZm9yIChpbnQgaiA9IDA7IGogPCAxMDA7IGorKykgewogICAgICAgICAgICAg\nICAgICAgIGxoLmFkZEVudHJ5KGRhdGEpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgbGguY2xv\nc2UoKTsKICAgICAgICAgICAgICAgIGJrLmNsb3NlKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA2MDsg\naSsrKSB7CiAgICAgICAgICAgIGlmICghdC5pc0FsaXZlKCkpIHsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRo\ncmVhZC5zbGVlcCgxMDAwKTsgLy8gd2FpdCBmb3IgMTAgc2Vjb25kcyBmb3Ig\ncmVhZGluZyB0byBmaW5pc2gKICAgICAgICB9CgogICAgICAgIEFzc2VydC5h\nc3NlcnRGYWxzZSgiVGhyZWFkIHNob3VsZCBiZSBmaW5pc2hlZCIsIHQuaXNB\nbGl2ZSgpKTsKCiAgICAgICAgQmVuY2hSZWFkVGhyb3VnaHB1dExhdGVuY3ku\nbWFpbihuZXcgU3RyaW5nW10gewogICAgICAgICAgICAgICAgIi0tem9va2Vl\ncGVyIiwgemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwKICAg\nICAgICAgICAgICAgICItLWxlZGdlciIsIFN0cmluZy52YWx1ZU9mKGxhc3RM\nZWRnZXJJZCl9KTsKCiAgICAgICAgZmluYWwgbG9uZyBuZXh0TGVkZ2VySWQg\nPSBsYXN0TGVkZ2VySWQrMTsKICAgICAgICB0ID0gbmV3IFRocmVhZCgpIHsK\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBCZW5j\naFJlYWRUaHJvdWdocHV0TGF0ZW5jeS5tYWluKG5ldyBTdHJpbmdbXSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIi0tem9va2VlcGVyIiwg\nemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAiLS1sZWRnZXIiLCBTdHJpbmcudmFs\ndWVPZihuZXh0TGVkZ2VySWQpfSk7CiAgICAgICAgICAgICAgICAgICAgfSBj\nYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nTE9HLmVycm9yKCJFcnJvciByZWFkaW5nIiwgdCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHRocmV3RXhjZXB0aW9uLnNldCh0cnVlKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07\nCiAgICAgICAgdC5zdGFydCgpOwoKICAgICAgICBBc3NlcnQuYXNzZXJ0VHJ1\nZSgiVGhyZWFkIHNob3VsZCBiZSBydW5uaW5nIiwgdC5pc0FsaXZlKCkpOwog\nICAgICAgIEJvb2tLZWVwZXIgYmsgPSBuZXcgQm9va0tlZXBlcih6a1V0aWwu\nZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpKTsKICAgICAgICBMZWRnZXJI\nYW5kbGUgbGggPSBiay5jcmVhdGVMZWRnZXIoQm9va0tlZXBlci5EaWdlc3RU\neXBlLkNSQzMyLCAiYmVuY2hQYXNzd2QiLmdldEJ5dGVzKCkpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgMTAwOyBq\nKyspIHsKICAgICAgICAgICAgICAgIGxoLmFkZEVudHJ5KGRhdGEpOwogICAg\nICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgbGgu\nY2xvc2UoKTsKICAgICAgICAgICAgYmsuY2xvc2UoKTsKICAgICAgICB9CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA2MDsgaSsrKSB7CiAgICAgICAg\nICAgIGlmICghdC5pc0FsaXZlKCkpIHsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRocmVhZC5zbGVlcCgxMDAw\nKTsgLy8gd2FpdCBmb3IgMTAgc2Vjb25kcyBmb3IgcmVhZGluZyB0byBmaW5p\nc2gKICAgICAgICB9CiAgICAgICAgQXNzZXJ0LmFzc2VydEZhbHNlKCJUaHJl\nYWQgc2hvdWxkIGJlIGZpbmlzaGVkIiwgdC5pc0FsaXZlKCkpOwogICAgICAg\nIEFzc2VydC5hc3NlcnRGYWxzZSgiQSB0aHJlYWQgaGFzIHRocm93biBhbiBl\neGNlcHRpb24sIGNoZWNrIGxvZ3MiLCB0aHJld0V4Y2VwdGlvbi5nZXQoKSk7\nCiAgICB9Cn0K\n","encoding":"base64"}

