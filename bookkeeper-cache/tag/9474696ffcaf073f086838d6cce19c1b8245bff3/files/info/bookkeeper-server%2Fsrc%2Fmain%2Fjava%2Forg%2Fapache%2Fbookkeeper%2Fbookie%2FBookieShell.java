{"sha":"a9af846e642c302d9a1eddfac5ddeba85556e2db","node_id":"MDQ6QmxvYjE1NzU5NTY6YTlhZjg0NmU2NDJjMzAyZDlhMWVkZGZhYzVkZGViYTg1NTU2ZTJkYg==","size":53181,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a9af846e642c302d9a1eddfac5ddeba85556e2db","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVOb3RGb3VuZEV4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZh\nLm5pby5CeXRlQnVmZmVyOwppbXBvcnQgamF2YS51dGlsLkZvcm1hdHRlcjsK\naW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnJlcGxpY2F0aW9uLkF1ZGl0\nb3JFbGVjdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tp\nZS5Cb29raWVFeGNlcHRpb24uSW52YWxpZENvb2tpZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuRW50cnlMb2dnZXIu\nRW50cnlMb2dTY2FubmVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmJvb2tpZS5Kb3VybmFsLkpvdXJuYWxTY2FubmVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlckFkbWluOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJI\nYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50Lkxl\nZGdlck1ldGFkYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNv\nbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyTWFuYWdlci5MZWRn\nZXJSYW5nZUl0ZXJhdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLm1ldGEuTGVkZ2VyTWFuYWdlci5MZWRnZXJSYW5nZTsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlck1hbmFnZXJGYWN0b3J5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyVW5kZXJy\nZXBsaWNhdGlvbk1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIubmV0LkJvb2tpZVNvY2tldEFkZHJlc3M7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIudXRpbC5FbnRyeUZvcm1hdHRlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci51dGlsLlRvb2w7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIudXRpbC5aa1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnZlcnNpb25pbmcuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci52ZXJzaW9uaW5nLlZlcnNpb25lZDsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci56b29rZWVwZXIuWm9vS2VlcGVyV2F0Y2hl\nckJhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7Cgpp\nbXBvcnQgY29tLmdvb2dsZS5jb21tb24udXRpbC5jb25jdXJyZW50LkFic3Ry\nYWN0RnV0dXJlOwppbXBvcnQgc3RhdGljIGNvbS5nb29nbGUuY29tbW9uLmJh\nc2UuQ2hhcnNldHMuVVRGXzg7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmNvbmZpZ3VyYXRpb24uQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5jb25maWd1cmF0aW9uLkNvbXBvc2l0ZUNvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5Q\ncm9wZXJ0aWVzQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5jbGkuQmFzaWNQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMuY2xpLkNvbW1hbmRMaW5lOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmNsaS5IZWxwRm9ybWF0dGVyOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmNsaS5NaXNzaW5nQXJndW1lbnRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmNvbW1vbnMuY2xpLk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY2xpLlBhcnNlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpv\nb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioKICogQm9va2ll\nIFNoZWxsIGlzIHRvIHByb3ZpZGUgdXRpbGl0aWVzIGZvciB1c2VycyB0byBh\nZG1pbmlzdGVyIGEgYm9va2tlZXBlciBjbHVzdGVyLgogKi8KcHVibGljIGNs\nYXNzIEJvb2tpZVNoZWxsIGltcGxlbWVudHMgVG9vbCB7CgogICAgc3RhdGlj\nIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihC\nb29raWVTaGVsbC5jbGFzcyk7CgogICAgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTlRSWV9GT1JNQVRURVJfQ0xBU1MgPSAiZW50cnlGb3JtYXR0ZXJDbGFzcyI7\nCgogICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfTUVUQUZPUk1BVCA9ICJt\nZXRhZm9ybWF0IjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX0JPT0tJ\nRUZPUk1BVCA9ICJib29raWVmb3JtYXQiOwogICAgc3RhdGljIGZpbmFsIFN0\ncmluZyBDTURfUkVDT1ZFUiA9ICJyZWNvdmVyIjsKICAgIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgQ01EX0xFREdFUiA9ICJsZWRnZXIiOwogICAgc3RhdGljIGZp\nbmFsIFN0cmluZyBDTURfTElTVExFREdFUlMgPSAibGlzdGxlZGdlcnMiOwog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfTEVER0VSTUVUQURBVEEgPSAi\nbGVkZ2VybWV0YWRhdGEiOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURf\nTElTVFVOREVSUkVQTElDQVRFRCA9ICJsaXN0dW5kZXJyZXBsaWNhdGVkIjsK\nICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX1dIT0lTQVVESVRPUiA9ICJ3\naG9pc2F1ZGl0b3IiOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfU0lN\nUExFVEVTVCA9ICJzaW1wbGV0ZXN0IjsKICAgIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgQ01EX1JFQURMT0cgPSAicmVhZGxvZyI7CiAgICBzdGF0aWMgZmluYWwg\nU3RyaW5nIENNRF9SRUFESk9VUk5BTCA9ICJyZWFkam91cm5hbCI7CiAgICBz\ndGF0aWMgZmluYWwgU3RyaW5nIENNRF9MQVNUTUFSSyA9ICJsYXN0bWFyayI7\nCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIENNRF9BVVRPUkVDT1ZFUlkgPSAi\nYXV0b3JlY292ZXJ5IjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX0xJ\nU1RCT09LSUVTID0gImxpc3Rib29raWVzIjsKICAgIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgQ01EX1VQREFURUNPT0tJRSA9ICJ1cGRhdGVjb29raWUiOwogICAg\nc3RhdGljIGZpbmFsIFN0cmluZyBDTURfSEVMUCA9ICJoZWxwIjsKCiAgICBm\naW5hbCBTZXJ2ZXJDb25maWd1cmF0aW9uIGJrQ29uZiA9IG5ldyBTZXJ2ZXJD\nb25maWd1cmF0aW9uKCk7CiAgICBGaWxlW10gbGVkZ2VyRGlyZWN0b3JpZXM7\nCiAgICBGaWxlIGpvdXJuYWxEaXJlY3Rvcnk7CgogICAgRW50cnlMb2dnZXIg\nZW50cnlMb2dnZXIgPSBudWxsOwogICAgSm91cm5hbCBqb3VybmFsID0gbnVs\nbDsKICAgIEVudHJ5Rm9ybWF0dGVyIGZvcm1hdHRlcjsKCiAgICBpbnQgcGFn\nZVNpemU7CiAgICBpbnQgZW50cmllc1BlclBhZ2U7CgogICAgaW50ZXJmYWNl\nIENvbW1hbmQgewogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKFN0cmluZ1td\nIGFyZ3MpIHRocm93cyBFeGNlcHRpb247CiAgICAgICAgcHVibGljIHZvaWQg\ncHJpbnRVc2FnZSgpOwogICAgfQoKICAgIGFic3RyYWN0IGNsYXNzIE15Q29t\nbWFuZCBpbXBsZW1lbnRzIENvbW1hbmQgewogICAgICAgIGFic3RyYWN0IE9w\ndGlvbnMgZ2V0T3B0aW9ucygpOwogICAgICAgIGFic3RyYWN0IFN0cmluZyBn\nZXREZXNjcmlwdGlvbigpOwogICAgICAgIGFic3RyYWN0IFN0cmluZyBnZXRV\nc2FnZSgpOwogICAgICAgIGFic3RyYWN0IGludCBydW5DbWQoQ29tbWFuZExp\nbmUgY21kTGluZSkgdGhyb3dzIEV4Y2VwdGlvbjsKCiAgICAgICAgU3RyaW5n\nIGNtZE5hbWU7CgogICAgICAgIE15Q29tbWFuZChTdHJpbmcgY21kTmFtZSkg\newogICAgICAgICAgICB0aGlzLmNtZE5hbWUgPSBjbWROYW1lOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBydW5D\nbWQoU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBCYXNpY1BhcnNlciBwYXJzZXIg\nPSBuZXcgQmFzaWNQYXJzZXIoKTsKICAgICAgICAgICAgICAgIENvbW1hbmRM\naW5lIGNtZExpbmUgPSBwYXJzZXIucGFyc2UoZ2V0T3B0aW9ucygpLCBhcmdz\nKTsKICAgICAgICAgICAgICAgIHJldHVybiBydW5DbWQoY21kTGluZSk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKFBhcnNlRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIExPRy5lcnJvcigiRXJyb3IgcGFyc2luZyBjb21tYW5kIGxp\nbmUgYXJndW1lbnRzIDogIiwgZSk7CiAgICAgICAgICAgICAgICBwcmludFVz\nYWdlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIHByaW50VXNhZ2UoKSB7CiAgICAgICAgICAgIEhlbHBGb3JtYXR0\nZXIgaGYgPSBuZXcgSGVscEZvcm1hdHRlcigpOwogICAgICAgICAgICBTeXN0\nZW0uZXJyLnByaW50bG4oY21kTmFtZSArICI6ICIgKyBnZXREZXNjcmlwdGlv\nbigpKTsKICAgICAgICAgICAgaGYucHJpbnRIZWxwKGdldFVzYWdlKCksIGdl\ndE9wdGlvbnMoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nRm9ybWF0IHRoZSBib29ra2VlcGVyIG1ldGFkYXRhIHByZXNlbnQgaW4gem9v\na2VlcGVyCiAgICAgKi8KICAgIGNsYXNzIE1ldGFGb3JtYXRDbWQgZXh0ZW5k\ncyBNeUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRp\nb25zKCk7CgogICAgICAgIE1ldGFGb3JtYXRDbWQoKSB7CiAgICAgICAgICAg\nIHN1cGVyKENNRF9NRVRBRk9STUFUKTsKICAgICAgICAgICAgb3B0cy5hZGRP\ncHRpb24oIm4iLCAibm9uSW50ZXJhY3RpdmUiLCBmYWxzZSwKICAgICAgICAg\nICAgICAgICAgICAiV2hldGhlciB0byBjb25maXJtIGlmIG9sZCBkYXRhIGV4\naXN0cy4uPyIpOwogICAgICAgICAgICBvcHRzLmFkZE9wdGlvbigiZiIsICJm\nb3JjZSIsIGZhbHNlLAogICAgICAgICAgICAgICAgICAgICJJZiBbbm9uSW50\nZXJhY3RpdmVdIGlzIHNwZWNpZmllZCwgdGhlbiB3aGV0aGVyIgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyAiIHRvIGZvcmNlIGRlbGV0ZSB0aGUg\nb2xkIGRhdGEgd2l0aG91dCBwcm9tcHQuIik7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBPcHRpb25zIGdldE9wdGlvbnMoKSB7CiAg\nICAgICAgICAgIHJldHVybiBvcHRzOwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAg\nICAgICAgICByZXR1cm4gIkZvcm1hdCBib29ra2VlcGVyIG1ldGFkYXRhIGlu\nIHpvb2tlZXBlciI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJldHVybiAi\nbWV0YWZvcm1hdCAgIFstbm9uSW50ZXJhY3RpdmVdIFstZm9yY2VdIjsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIGludCBydW5DbWQo\nQ29tbWFuZExpbmUgY21kTGluZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIGJvb2xlYW4gaW50ZXJhY3RpdmUgPSAoIWNtZExpbmUuaGFzT3B0\naW9uKCJuIikpOwogICAgICAgICAgICBib29sZWFuIGZvcmNlID0gY21kTGlu\nZS5oYXNPcHRpb24oImYiKTsKCiAgICAgICAgICAgIENsaWVudENvbmZpZ3Vy\nYXRpb24gYWRtaW5Db25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oYmtD\nb25mKTsKICAgICAgICAgICAgYm9vbGVhbiByZXN1bHQgPSBCb29rS2VlcGVy\nQWRtaW4uZm9ybWF0KGFkbWluQ29uZiwgaW50ZXJhY3RpdmUsCiAgICAgICAg\nICAgICAgICAgICAgZm9yY2UpOwogICAgICAgICAgICByZXR1cm4gKHJlc3Vs\ndCkgPyAwIDogMTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBG\nb3JtYXRzIHRoZSBsb2NhbCBkYXRhIHByZXNlbnQgaW4gY3VycmVudCBib29r\naWUgc2VydmVyCiAgICAgKi8KICAgIGNsYXNzIEJvb2tpZUZvcm1hdENtZCBl\neHRlbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBvcHRzID0gbmV3\nIE9wdGlvbnMoKTsKCiAgICAgICAgcHVibGljIEJvb2tpZUZvcm1hdENtZCgp\nIHsKICAgICAgICAgICAgc3VwZXIoQ01EX0JPT0tJRUZPUk1BVCk7CiAgICAg\nICAgICAgIG9wdHMuYWRkT3B0aW9uKCJuIiwgIm5vbkludGVyYWN0aXZlIiwg\nZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgIldoZXRoZXIgdG8gY29uZmly\nbSBpZiBvbGQgZGF0YSBleGlzdHMuLj8iKTsKICAgICAgICAgICAgb3B0cy5h\nZGRPcHRpb24oImYiLCAiZm9yY2UiLCBmYWxzZSwKICAgICAgICAgICAgICAg\nICAgICAiSWYgW25vbkludGVyYWN0aXZlXSBpcyBzcGVjaWZpZWQsIHRoZW4g\nd2hldGhlciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiB0byBm\nb3JjZSBkZWxldGUgdGhlIG9sZCBkYXRhIHdpdGhvdXQgcHJvbXB0Li4/Iik7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBPcHRpb25z\nIGdldE9wdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBvcHRzOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldERl\nc2NyaXB0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gIkZvcm1hdCB0aGUg\nY3VycmVudCBzZXJ2ZXIgY29udGVudHMiOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkgewogICAgICAg\nICAgICByZXR1cm4gImJvb2tpZWZvcm1hdCBbLW5vbkludGVyYWN0aXZlXSBb\nLWZvcmNlXSI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNtZExpbmUpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICBib29sZWFuIGludGVyYWN0aXZlID0gKCFj\nbWRMaW5lLmhhc09wdGlvbigibiIpKTsKICAgICAgICAgICAgYm9vbGVhbiBm\nb3JjZSA9IGNtZExpbmUuaGFzT3B0aW9uKCJmIik7CgogICAgICAgICAgICBT\nZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJh\ndGlvbihia0NvbmYpOwogICAgICAgICAgICBib29sZWFuIHJlc3VsdCA9IEJv\nb2tpZS5mb3JtYXQoY29uZiwgaW50ZXJhY3RpdmUsIGZvcmNlKTsKICAgICAg\nICAgICAgcmV0dXJuIChyZXN1bHQpID8gMCA6IDE7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogUmVjb3ZlciBjb21tYW5kIGZvciBsZWRnZXIg\nZGF0YSByZWNvdmVyeSBmb3IgZmFpbGVkIGJvb2tpZQogICAgICovCiAgICBj\nbGFzcyBSZWNvdmVyQ21kIGV4dGVuZHMgTXlDb21tYW5kIHsKICAgICAgICBP\ncHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAgICAgICBwdWJsaWMg\nUmVjb3ZlckNtZCgpIHsKICAgICAgICAgICAgc3VwZXIoQ01EX1JFQ09WRVIp\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9u\ncyBnZXRPcHRpb25zKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXRE\nZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICJSZWNvdmVyIHRo\nZSBsZWRnZXIgZGF0YSBmb3IgZmFpbGVkIGJvb2tpZSI7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7\nCiAgICAgICAgICAgIHJldHVybiAicmVjb3ZlciAgICAgIDxib29raWVTcmM+\nIFtib29raWVEZXN0XSI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNtZExpbmUpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgICAgICBTdHJpbmdbXSBhcmdzID0gY21k\nTGluZS5nZXRBcmdzKCk7CiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8\nIDEpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNaXNzaW5nQXJndW1l\nbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICInYm9va2ll\nU3JjJyBhcmd1bWVudCByZXF1aXJlZCIpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uIGFkbWluQ29uZiA9IG5ldyBD\nbGllbnRDb25maWd1cmF0aW9uKGJrQ29uZik7CiAgICAgICAgICAgIEJvb2tL\nZWVwZXJBZG1pbiBhZG1pbiA9IG5ldyBCb29rS2VlcGVyQWRtaW4oYWRtaW5D\nb25mKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVy\nbiBia1JlY292ZXJ5KGFkbWluLCBhcmdzKTsKICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGFkbWluKSB7CiAg\nICAgICAgICAgICAgICAgICAgYWRtaW4uY2xvc2UoKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0\nZSBpbnQgYmtSZWNvdmVyeShCb29rS2VlcGVyQWRtaW4gYmtBZG1pbiwgU3Ry\naW5nW10gYXJncykKICAgICAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAgICAgICBmaW5hbCBT\ndHJpbmcgYm9va2llU3JjU3RyaW5nW10gPSBhcmdzWzBdLnNwbGl0KCI6Iik7\nCiAgICAgICAgICAgIGlmIChib29raWVTcmNTdHJpbmcubGVuZ3RoICE9IDIp\nIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiQm9va2ll\nU3JjIGlucHV0dGVkIGhhcyBpbnZhbGlkIGZvcm1hdCIKICAgICAgICAgICAg\nICAgICAgICAgICAgKyAiKGhvc3Q6cG9ydCBleHBlY3RlZCk6ICIgKyBhcmdz\nWzBdKTsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBmaW5hbCBCb29raWVTb2NrZXRBZGRyZXNzIGJvb2tp\nZVNyYyA9IG5ldyBCb29raWVTb2NrZXRBZGRyZXNzKAogICAgICAgICAgICAg\nICAgICAgIGJvb2tpZVNyY1N0cmluZ1swXSwgSW50ZWdlci5wYXJzZUludChi\nb29raWVTcmNTdHJpbmdbMV0pKTsKICAgICAgICAgICAgQm9va2llU29ja2V0\nQWRkcmVzcyBib29raWVEZXN0ID0gbnVsbDsKICAgICAgICAgICAgaWYgKGFy\nZ3MubGVuZ3RoID49IDIpIHsKICAgICAgICAgICAgICAgIGZpbmFsIFN0cmlu\nZyBib29raWVEZXN0U3RyaW5nW10gPSBhcmdzWzFdLnNwbGl0KCI6Iik7CiAg\nICAgICAgICAgICAgICBpZiAoYm9va2llRGVzdFN0cmluZy5sZW5ndGggPCAy\nKSB7CiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJC\nb29raWVEZXN0IGlucHV0dGVkIGhhcyBpbnZhbGlkIGZvcm1hdCIKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgIihob3N0OnBvcnQgZXhwZWN0ZWQp\nOiAiICsgYXJnc1sxXSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0x\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYm9va2llRGVz\ndCA9IG5ldyBCb29raWVTb2NrZXRBZGRyZXNzKGJvb2tpZURlc3RTdHJpbmdb\nMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVnZXIucGFyc2VJbnQo\nYm9va2llRGVzdFN0cmluZ1sxXSkpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBia0FkbWluLnJlY292ZXJCb29raWVEYXRhKGJvb2tpZVNyYywgYm9v\na2llRGVzdCk7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIExlZGdlciBDb21tYW5kIEhhbmRsZXMgbGVk\nZ2VyIHJlbGF0ZWQgb3BlcmF0aW9ucwogICAgICovCiAgICBjbGFzcyBMZWRn\nZXJDbWQgZXh0ZW5kcyBNeUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgbE9w\ndHMgPSBuZXcgT3B0aW9ucygpOwoKICAgICAgICBMZWRnZXJDbWQoKSB7CiAg\nICAgICAgICAgIHN1cGVyKENNRF9MRURHRVIpOwogICAgICAgICAgICBsT3B0\ncy5hZGRPcHRpb24oIm0iLCAibWV0YSIsIGZhbHNlLCAiUHJpbnQgbWV0YSBp\nbmZvcm1hdGlvbiIpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHVibGljIGludCBydW5DbWQoQ29tbWFuZExpbmUgY21kTGluZSkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFN0cmluZ1tdIGxlZnRB\ncmdzID0gY21kTGluZS5nZXRBcmdzKCk7CiAgICAgICAgICAgIGlmIChsZWZ0\nQXJncy5sZW5ndGggPD0gMCkgewogICAgICAgICAgICAgICAgU3lzdGVtLmVy\nci5wcmludGxuKCJFUlJPUjogbWlzc2luZyBsZWRnZXIgaWQiKTsKICAgICAg\nICAgICAgICAgIHByaW50VXNhZ2UoKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiAtMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYm9vbGVhbiBwcmlu\ndE1ldGEgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKGNtZExpbmUuaGFzT3B0\naW9uKCJtIikpIHsKICAgICAgICAgICAgICAgIHByaW50TWV0YSA9IHRydWU7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9uZyBsZWRnZXJJZDsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxlZGdlcklkID0gTG9u\nZy5wYXJzZUxvbmcobGVmdEFyZ3NbMF0pOwogICAgICAgICAgICB9IGNhdGNo\nIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gbmZlKSB7CiAgICAgICAgICAgICAg\nICBTeXN0ZW0uZXJyLnByaW50bG4oIkVSUk9SOiBpbnZhbGlkIGxlZGdlciBp\nZCAiICsgbGVmdEFyZ3NbMF0pOwogICAgICAgICAgICAgICAgcHJpbnRVc2Fn\nZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGlmIChwcmludE1ldGEpIHsKICAgICAgICAgICAgICAg\nIC8vIHByaW50IG1ldGEKICAgICAgICAgICAgICAgIHJlYWRMZWRnZXJNZXRh\nKGxlZGdlcklkKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBkdW1w\nIGxlZGdlciBpbmZvCiAgICAgICAgICAgIHJlYWRMZWRnZXJJbmRleEVudHJp\nZXMobGVkZ2VySWQpOwogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlw\ndGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICJEdW1wIGxlZGdlciBpbmRl\neCBlbnRyaWVzIGludG8gcmVhZGFibGUgZm9ybWF0LiI7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7\nCiAgICAgICAgICAgIHJldHVybiAibGVkZ2VyICAgICAgIFstbV0gPGxlZGdl\ncl9pZD4iOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nT3B0aW9ucyBnZXRPcHRpb25zKCkgewogICAgICAgICAgICByZXR1cm4gbE9w\ndHM7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ29tbWFuZCBm\nb3IgbGlzdGluZyB1bmRlcnJlcGxpY2F0ZWQgbGVkZ2VycwogICAgICovCiAg\nICBjbGFzcyBMaXN0VW5kZXJyZXBsaWNhdGVkQ21kIGV4dGVuZHMgTXlDb21t\nYW5kIHsKICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwoK\nICAgICAgICBwdWJsaWMgTGlzdFVuZGVycmVwbGljYXRlZENtZCgpIHsKICAg\nICAgICAgICAgc3VwZXIoQ01EX0xJU1RVTkRFUlJFUExJQ0FURUQpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRP\ncHRpb25zKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlw\ndGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICJMaXN0IGxlZGdlcnMgbWFy\na2VkIGFzIHVuZGVycmVwbGljYXRlZCI7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAg\nICAgIHJldHVybiAibGlzdHVuZGVycmVwbGljYXRlZCI7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRM\naW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBa\nb29LZWVwZXIgemsgPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgWm9vS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVw\nZXJXYXRjaGVyQmFzZShia0NvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAg\nICAgICAgICAgemsgPSBaa1V0aWxzLmNyZWF0ZUNvbm5lY3RlZFpvb2tlZXBl\nckNsaWVudChia0NvbmYuZ2V0WmtTZXJ2ZXJzKCksIHcpOwogICAgICAgICAg\nICAgICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkgbUZhY3RvcnkgPSBMZWRnZXJN\nYW5hZ2VyRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeShia0NvbmYs\nIHprKTsKICAgICAgICAgICAgICAgIExlZGdlclVuZGVycmVwbGljYXRpb25N\nYW5hZ2VyIHVuZGVycmVwbGljYXRpb25NYW5hZ2VyID0gbUZhY3RvcnkubmV3\nTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIoKTsKICAgICAgICAgICAg\nICAgIEl0ZXJhdG9yPExvbmc+IGl0ZXIgPSB1bmRlcnJlcGxpY2F0aW9uTWFu\nYWdlci5saXN0TGVkZ2Vyc1RvUmVyZXBsaWNhdGUoKTsKICAgICAgICAgICAg\nICAgIHdoaWxlIChpdGVyLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbihpdGVyLm5leHQoKSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICBpZiAoemsgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHpr\nLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KCiAgICBmaW5h\nbCBzdGF0aWMgaW50IExJU1RfQkFUQ0hfU0laRSA9IDEwMDA7CiAgICAvKioK\nICAgICAqIENvbW1hbmQgdG8gbGlzdCBhbGwgbGVkZ2VycyBpbiB0aGUgY2x1\nc3RlcgogICAgICovCiAgICBjbGFzcyBMaXN0TGVkZ2Vyc0NtZCBleHRlbmRz\nIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBsT3B0cyA9IG5ldyBPcHRp\nb25zKCk7CgogICAgICAgIExpc3RMZWRnZXJzQ21kKCkgewogICAgICAgICAg\nICBzdXBlcihDTURfTElTVExFREdFUlMpOwogICAgICAgICAgICBsT3B0cy5h\nZGRPcHRpb24oIm0iLCAibWV0YSIsIGZhbHNlLCAiUHJpbnQgbWV0YWRhdGEi\nKTsKCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgaW50IHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgWm9vS2VlcGVyIHprID0gbnVsbDsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFpvb0tlZXBlcldhdGNo\nZXJCYXNlIHcgPSBuZXcgWm9vS2VlcGVyV2F0Y2hlckJhc2UoYmtDb25mLmdl\ndFprVGltZW91dCgpKTsKICAgICAgICAgICAgICAgIHprID0gWmtVdGlscy5j\ncmVhdGVDb25uZWN0ZWRab29rZWVwZXJDbGllbnQoYmtDb25mLmdldFprU2Vy\ndmVycygpLCB3KTsKICAgICAgICAgICAgICAgIExlZGdlck1hbmFnZXJGYWN0\nb3J5IG1GYWN0b3J5ID0gTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2Vy\nTWFuYWdlckZhY3RvcnkoYmtDb25mLCB6ayk7CiAgICAgICAgICAgICAgICBM\nZWRnZXJNYW5hZ2VyIG0gPSBtRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyKCk7\nCiAgICAgICAgICAgICAgICBMZWRnZXJSYW5nZUl0ZXJhdG9yIGl0ZXIgPSBt\nLmdldExlZGdlclJhbmdlcygpOwogICAgICAgICAgICAgICAgaWYgKGNtZExp\nbmUuaGFzT3B0aW9uKCJtIikpIHsKICAgICAgICAgICAgICAgICAgICBMaXN0\nPFJlYWRNZXRhZGF0YUNhbGxiYWNrPiBmdXR1cmVzCiAgICAgICAgICAgICAg\nICAgICAgICAgID0gbmV3IEFycmF5TGlzdDxSZWFkTWV0YWRhdGFDYWxsYmFj\naz4oTElTVF9CQVRDSF9TSVpFKTsKICAgICAgICAgICAgICAgICAgICB3aGls\nZSAoaXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nTGVkZ2VyUmFuZ2UgciA9IGl0ZXIubmV4dCgpOwogICAgICAgICAgICAgICAg\nICAgICAgICBmb3IgKExvbmcgbGlkIDogci5nZXRMZWRnZXJzKCkpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWRNZXRhZGF0YUNhbGxiYWNr\nIGNiID0gbmV3IFJlYWRNZXRhZGF0YUNhbGxiYWNrKGxpZCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBtLnJlYWRMZWRnZXJNZXRhZGF0YShsaWQs\nIGNiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1dHVyZXMuYWRk\nKGNiKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoZnV0dXJlcy5zaXplKCkgPj0gTElTVF9CQVRDSF9T\nSVpFKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZnV0\ndXJlcy5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgUmVhZE1ldGFkYXRhQ2FsbGJhY2sgY2IgPSBmdXR1cmVzLnJlbW92\nZSgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludExl\nZGdlck1ldGFkYXRhKGNiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZnV0dXJlcy5zaXpl\nKCkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWRNZXRhZGF0\nYUNhbGxiYWNrIGNiID0gZnV0dXJlcy5yZW1vdmUoMCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHByaW50TGVkZ2VyTWV0YWRhdGEoY2IpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgd2hpbGUgKGl0ZXIuaGFzTmV4dCgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIExlZGdlclJhbmdlIHIgPSBpdGVyLm5leHQo\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChMb25nIGxpZCA6IHIu\nZ2V0TGVkZ2VycygpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oTG9uZy50b1N0cmluZyhsaWQpKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIGlmICh6ayAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgemsuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0RGVzY3JpcHRpb24oKSB7CiAg\nICAgICAgICAgIHJldHVybiAiTGlzdCBhbGwgbGVkZ2VycyBvbiB0aGUgY2x1\nc3RlciAodGhpcyBtYXkgdGFrZSBhIGxvbmcgdGltZSkiOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkg\newogICAgICAgICAgICByZXR1cm4gImxpc3RsZWRnZXJzICBbLW1ldGFdIjsK\nICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIE9wdGlvbnMg\nZ2V0T3B0aW9ucygpIHsKICAgICAgICAgICAgcmV0dXJuIGxPcHRzOwogICAg\nICAgIH0KICAgIH0KCiAgICBzdGF0aWMgdm9pZCBwcmludExlZGdlck1ldGFk\nYXRhKFJlYWRNZXRhZGF0YUNhbGxiYWNrIGNiKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBMZWRnZXJNZXRhZGF0YSBtZCA9IGNiLmdldCgpOwogICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbigibGVkZ2VySUQ6ICIgKyBjYi5nZXRM\nZWRnZXJJZCgpKTsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4obmV3IFN0\ncmluZyhtZC5zZXJpYWxpemUoKSwgVVRGXzgpKTsKICAgIH0KCiAgICBzdGF0\naWMgY2xhc3MgUmVhZE1ldGFkYXRhQ2FsbGJhY2sgZXh0ZW5kcyBBYnN0cmFj\ndEZ1dHVyZTxMZWRnZXJNZXRhZGF0YT4KICAgICAgICBpbXBsZW1lbnRzIEdl\nbmVyaWNDYWxsYmFjazxMZWRnZXJNZXRhZGF0YT4gewogICAgICAgIGZpbmFs\nIGxvbmcgbGVkZ2VySWQ7CgogICAgICAgIFJlYWRNZXRhZGF0YUNhbGxiYWNr\nKGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICAgICAgdGhpcy5sZWRnZXJJZCA9\nIGxlZGdlcklkOwogICAgICAgIH0KCiAgICAgICAgbG9uZyBnZXRMZWRnZXJJ\nZCgpIHsKICAgICAgICAgICAgcmV0dXJuIGxlZGdlcklkOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJj\nLCBMZWRnZXJNZXRhZGF0YSByZXN1bHQpIHsKICAgICAgICAgICAgaWYgKHJj\nICE9IDApIHsKICAgICAgICAgICAgICAgIHNldEV4Y2VwdGlvbihCS0V4Y2Vw\ndGlvbi5jcmVhdGUocmMpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgIHNldChyZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUHJpbnQgdGhlIG1ldGFkYXRhIGZv\nciBhIGxlZGdlcgogICAgICovCiAgICBjbGFzcyBMZWRnZXJNZXRhZGF0YUNt\nZCBleHRlbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBsT3B0cyA9\nIG5ldyBPcHRpb25zKCk7CgogICAgICAgIExlZGdlck1ldGFkYXRhQ21kKCkg\newogICAgICAgICAgICBzdXBlcihDTURfTEVER0VSTUVUQURBVEEpOwogICAg\nICAgICAgICBsT3B0cy5hZGRPcHRpb24oImwiLCAibGVkZ2VyaWQiLCB0cnVl\nLCAiTGVkZ2VyIElEIik7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgaW50IHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5l\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgZmluYWwgbG9uZyBs\naWQgPSBnZXRPcHRpb25Mb25nVmFsdWUoY21kTGluZSwgImxlZGdlcmlkIiwg\nLTEpOwogICAgICAgICAgICBpZiAobGlkID09IC0xKSB7CiAgICAgICAgICAg\nICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIk11c3Qgc3BlY2lmeSBhIGxlZGdl\nciBpZCIpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBab29LZWVwZXIgemsgPSBudWxsOwogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgWm9vS2VlcGVyV2F0Y2hlckJh\nc2UgdyA9IG5ldyBab29LZWVwZXJXYXRjaGVyQmFzZShia0NvbmYuZ2V0WmtU\naW1lb3V0KCkpOwogICAgICAgICAgICAgICAgemsgPSBaa1V0aWxzLmNyZWF0\nZUNvbm5lY3RlZFpvb2tlZXBlckNsaWVudChia0NvbmYuZ2V0WmtTZXJ2ZXJz\nKCksIHcpOwogICAgICAgICAgICAgICAgTGVkZ2VyTWFuYWdlckZhY3Rvcnkg\nbUZhY3RvcnkgPSBMZWRnZXJNYW5hZ2VyRmFjdG9yeS5uZXdMZWRnZXJNYW5h\nZ2VyRmFjdG9yeShia0NvbmYsIHprKTsKICAgICAgICAgICAgICAgIExlZGdl\nck1hbmFnZXIgbSA9IG1GYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXIoKTsKICAg\nICAgICAgICAgICAgIFJlYWRNZXRhZGF0YUNhbGxiYWNrIGNiID0gbmV3IFJl\nYWRNZXRhZGF0YUNhbGxiYWNrKGxpZCk7CiAgICAgICAgICAgICAgICBtLnJl\nYWRMZWRnZXJNZXRhZGF0YShsaWQsIGNiKTsKICAgICAgICAgICAgICAgIHBy\naW50TGVkZ2VyTWV0YWRhdGEoY2IpOwogICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgaWYgKHprICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICB6ay5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlv\nbigpIHsKICAgICAgICAgICAgcmV0dXJuICJQcmludCB0aGUgbWV0YWRhdGEg\nZm9yIGEgbGVkZ2VyIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJu\nICJsZWRnZXJtZXRhZGF0YSAtbGVkZ2VyaWQgPGxlZGdlcmlkPiI7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBPcHRpb25zIGdldE9w\ndGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBsT3B0czsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTaW1wbGUgdGVzdCB0byBjcmVhdGUg\nYSBsZWRnZXIgYW5kIHdyaXRlIHRvIGl0CiAgICAgKi8KICAgIGNsYXNzIFNp\nbXBsZVRlc3RDbWQgZXh0ZW5kcyBNeUNvbW1hbmQgewogICAgICAgIE9wdGlv\nbnMgbE9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAgICAgICBTaW1wbGVUZXN0\nQ21kKCkgewogICAgICAgICAgICBzdXBlcihDTURfU0lNUExFVEVTVCk7CiAg\nICAgICAgICAgIGxPcHRzLmFkZE9wdGlvbigiZSIsICJlbnNlbWJsZSIsIHRy\ndWUsICJFbnNlbWJsZSBzaXplIChkZWZhdWx0IDMpIik7CiAgICAgICAgICAg\nIGxPcHRzLmFkZE9wdGlvbigidyIsICJ3cml0ZVF1b3J1bSIsIHRydWUsICJX\ncml0ZSBxdW9ydW0gc2l6ZSAoZGVmYXVsdCAyKSIpOwogICAgICAgICAgICBs\nT3B0cy5hZGRPcHRpb24oImEiLCAiYWNrUXVvcnVtIiwgdHJ1ZSwgIkFjayBx\ndW9ydW0gc2l6ZSAoZGVmYXVsdCAyKSIpOwogICAgICAgICAgICBsT3B0cy5h\nZGRPcHRpb24oIm4iLCAibnVtRW50cmllcyIsIHRydWUsICJFbnRyaWVzIHRv\nIHdyaXRlIChkZWZhdWx0IDEwMDApIik7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50IHJ1bkNtZChDb21tYW5kTGlu\nZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgYnl0\nZVtdIGRhdGEgPSBuZXcgYnl0ZVsxMDBdOyAvLyB0ZXN0IGRhdGEKCiAgICAg\nICAgICAgIGludCBlbnNlbWJsZSA9IGdldE9wdGlvbkludFZhbHVlKGNtZExp\nbmUsICJlbnNlbWJsZSIsIDMpOwogICAgICAgICAgICBpbnQgd3JpdGVRdW9y\ndW0gPSBnZXRPcHRpb25JbnRWYWx1ZShjbWRMaW5lLCAid3JpdGVRdW9ydW0i\nLCAyKTsKICAgICAgICAgICAgaW50IGFja1F1b3J1bSA9IGdldE9wdGlvbklu\ndFZhbHVlKGNtZExpbmUsICJhY2tRdW9ydW0iLCAyKTsKICAgICAgICAgICAg\naW50IG51bUVudHJpZXMgPSBnZXRPcHRpb25JbnRWYWx1ZShjbWRMaW5lLCAi\nbnVtRW50cmllcyIsIDEwMDApOwoKICAgICAgICAgICAgQ2xpZW50Q29uZmln\ndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAg\nICAgICAgICAgY29uZi5hZGRDb25maWd1cmF0aW9uKGJrQ29uZik7CiAgICAg\nICAgICAgIEJvb2tLZWVwZXIgYmsgPSBuZXcgQm9va0tlZXBlcihjb25mKTsK\nICAgICAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmsuY3JlYXRlTGVkZ2Vy\nKGVuc2VtYmxlLCB3cml0ZVF1b3J1bSwgYWNrUXVvcnVtLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQm9va0tlZXBl\nci5EaWdlc3RUeXBlLk1BQywgbmV3IGJ5dGVbMF0pOwogICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIkxlZGdlciBJRDogIiArIGxoLmdldElkKCkp\nOwogICAgICAgICAgICBsb25nIGxhc3RSZXBvcnQgPSBTeXN0ZW0ubmFub1Rp\nbWUoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbnRy\naWVzOyBpKyspIHsKICAgICAgICAgICAgICAgIGxoLmFkZEVudHJ5KGRhdGEp\nOwogICAgICAgICAgICAgICAgaWYgKFRpbWVVbml0LlNFQ09ORFMuY29udmVy\ndChTeXN0ZW0ubmFub1RpbWUoKSAtIGxhc3RSZXBvcnQsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpbWVVbml0Lk5B\nTk9TRUNPTkRTKSA+IDEpIHsKICAgICAgICAgICAgICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oaSArICIgZW50cmllcyB3cml0dGVuIik7CiAgICAgICAg\nICAgICAgICAgICAgbGFzdFJlcG9ydCA9IFN5c3RlbS5uYW5vVGltZSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBs\naC5jbG9zZSgpOwogICAgICAgICAgICBiay5jbG9zZSgpOwogICAgICAgICAg\nICBTeXN0ZW0ub3V0LnByaW50bG4obnVtRW50cmllcyArICIgZW50cmllcyB3\ncml0dGVuIHRvIGxlZGdlciAiICsgbGguZ2V0SWQoKSk7CgogICAgICAgICAg\nICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAgcmV0\ndXJuICJTaW1wbGUgdGVzdCB0byBjcmVhdGUgYSBsZWRnZXIgYW5kIHdyaXRl\nIGVudHJpZXMgdG8gaXQiOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkgewogICAgICAgICAgICByZXR1\ncm4gInNpbXBsZXRlc3QgICBbLWVuc2VtYmxlIE5dIFstd3JpdGVRdW9ydW0g\nTl0gWy1hY2tRdW9ydW0gTl0gWy1udW1FbnRyaWVzIE5dIjsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIE9wdGlvbnMgZ2V0T3B0aW9u\ncygpIHsKICAgICAgICAgICAgcmV0dXJuIGxPcHRzOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIENvbW1hbmQgdG8gcmVhZCBlbnRyeSBsb2cg\nZmlsZXMuCiAgICAgKi8KICAgIGNsYXNzIFJlYWRMb2dDbWQgZXh0ZW5kcyBN\neUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgcmxPcHRzID0gbmV3IE9wdGlv\nbnMoKTsKCiAgICAgICAgUmVhZExvZ0NtZCgpIHsKICAgICAgICAgICAgc3Vw\nZXIoQ01EX1JFQURMT0cpOwogICAgICAgICAgICBybE9wdHMuYWRkT3B0aW9u\nKCJtIiwgIm1zZyIsIGZhbHNlLCAiUHJpbnQgbWVzc2FnZSBib2R5Iik7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50\nIHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgU3RyaW5nW10gbGVmdEFyZ3MgPSBjbWRMaW5lLmdl\ndEFyZ3MoKTsKICAgICAgICAgICAgaWYgKGxlZnRBcmdzLmxlbmd0aCA8PSAw\nKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIkVSUk9S\nOiBtaXNzaW5nIGVudHJ5IGxvZyBpZCBvciBlbnRyeSBsb2cgZmlsZSBuYW1l\nIik7CiAgICAgICAgICAgICAgICBwcmludFVzYWdlKCk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJv\nb2xlYW4gcHJpbnRNc2cgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKGNtZExp\nbmUuaGFzT3B0aW9uKCJtIikpIHsKICAgICAgICAgICAgICAgIHByaW50TXNn\nID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsb25nIGxvZ0lk\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbG9nSWQgPSBM\nb25nLnBhcnNlTG9uZyhsZWZ0QXJnc1swXSk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAg\nICAgIC8vIG5vdCBhIGVudHJ5IGxvZyBpZAogICAgICAgICAgICAgICAgRmls\nZSBmID0gbmV3IEZpbGUobGVmdEFyZ3NbMF0pOwogICAgICAgICAgICAgICAg\nU3RyaW5nIG5hbWUgPSBmLmdldE5hbWUoKTsKICAgICAgICAgICAgICAgIGlm\nICghbmFtZS5lbmRzV2l0aCgiLmxvZyIpKSB7CiAgICAgICAgICAgICAgICAg\nICAgLy8gbm90IGEgbG9nIGZpbGUKICAgICAgICAgICAgICAgICAgICBTeXN0\nZW0uZXJyLnByaW50bG4oIkVSUk9SOiBpbnZhbGlkIGVudHJ5IGxvZyBmaWxl\nIG5hbWUgIiArIGxlZnRBcmdzWzBdKTsKICAgICAgICAgICAgICAgICAgICBw\ncmludFVzYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgU3RyaW5nIGlkU3Ry\naW5nID0gbmFtZS5zcGxpdCgiXFwuIilbMF07CiAgICAgICAgICAgICAgICBs\nb2dJZCA9IExvbmcucGFyc2VMb25nKGlkU3RyaW5nLCAxNik7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgLy8gc2NhbiBlbnRyeSBsb2cKICAgICAgICAg\nICAgc2NhbkVudHJ5TG9nKGxvZ0lkLCBwcmludE1zZyk7CiAgICAgICAgICAg\nIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAgICAgICByZXR1\ncm4gIlNjYW4gYW4gZW50cnkgZmlsZSBhbmQgZm9ybWF0IHRoZSBlbnRyaWVz\nIGludG8gcmVhZGFibGUgZm9ybWF0LiI7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAg\nICAgIHJldHVybiAicmVhZGxvZyAgICAgIFstbXNnXSA8ZW50cnlfbG9nX2lk\nIHwgZW50cnlfbG9nX2ZpbGVfbmFtZT4iOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkgewogICAg\nICAgICAgICByZXR1cm4gcmxPcHRzOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIENvbW1hbmQgdG8gcmVhZCBqb3VybmFsIGZpbGVzCiAgICAg\nKi8KICAgIGNsYXNzIFJlYWRKb3VybmFsQ21kIGV4dGVuZHMgTXlDb21tYW5k\nIHsKICAgICAgICBPcHRpb25zIHJqT3B0cyA9IG5ldyBPcHRpb25zKCk7Cgog\nICAgICAgIFJlYWRKb3VybmFsQ21kKCkgewogICAgICAgICAgICBzdXBlcihD\nTURfUkVBREpPVVJOQUwpOwogICAgICAgICAgICByak9wdHMuYWRkT3B0aW9u\nKCJtIiwgIm1zZyIsIGZhbHNlLCAiUHJpbnQgbWVzc2FnZSBib2R5Iik7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50\nIHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgU3RyaW5nW10gbGVmdEFyZ3MgPSBjbWRMaW5lLmdl\ndEFyZ3MoKTsKICAgICAgICAgICAgaWYgKGxlZnRBcmdzLmxlbmd0aCA8PSAw\nKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIkVSUk9S\nOiBtaXNzaW5nIGpvdXJuYWwgaWQgb3Igam91cm5hbCBmaWxlIG5hbWUiKTsK\nICAgICAgICAgICAgICAgIHByaW50VXNhZ2UoKTsKICAgICAgICAgICAgICAg\nIHJldHVybiAtMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYm9vbGVh\nbiBwcmludE1zZyA9IGZhbHNlOwogICAgICAgICAgICBpZiAoY21kTGluZS5o\nYXNPcHRpb24oIm0iKSkgewogICAgICAgICAgICAgICAgcHJpbnRNc2cgPSB0\ncnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxvbmcgam91cm5hbElk\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgam91cm5hbElk\nID0gTG9uZy5wYXJzZUxvbmcobGVmdEFyZ3NbMF0pOwogICAgICAgICAgICB9\nIGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gbmZlKSB7CiAgICAgICAg\nICAgICAgICAvLyBub3QgYSBqb3VybmFsIGlkCiAgICAgICAgICAgICAgICBG\naWxlIGYgPSBuZXcgRmlsZShsZWZ0QXJnc1swXSk7CiAgICAgICAgICAgICAg\nICBTdHJpbmcgbmFtZSA9IGYuZ2V0TmFtZSgpOwogICAgICAgICAgICAgICAg\naWYgKCFuYW1lLmVuZHNXaXRoKCIudHhuIikpIHsKICAgICAgICAgICAgICAg\nICAgICAvLyBub3QgYSBqb3VybmFsIGZpbGUKICAgICAgICAgICAgICAgICAg\nICBTeXN0ZW0uZXJyLnByaW50bG4oIkVSUk9SOiBpbnZhbGlkIGpvdXJuYWwg\nZmlsZSBuYW1lICIgKyBsZWZ0QXJnc1swXSk7CiAgICAgICAgICAgICAgICAg\nICAgcHJpbnRVc2FnZSgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAt\nMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFN0cmluZyBp\nZFN0cmluZyA9IG5hbWUuc3BsaXQoIlxcLiIpWzBdOwogICAgICAgICAgICAg\nICAgam91cm5hbElkID0gTG9uZy5wYXJzZUxvbmcoaWRTdHJpbmcsIDE2KTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBzY2FuIGpvdXJuYWwKICAg\nICAgICAgICAgc2NhbkpvdXJuYWwoam91cm5hbElkLCBwcmludE1zZyk7CiAg\nICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAg\nICAgICByZXR1cm4gIlNjYW4gYSBqb3VybmFsIGZpbGUgYW5kIGZvcm1hdCB0\naGUgZW50cmllcyBpbnRvIHJlYWRhYmxlIGZvcm1hdC4iOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkg\newogICAgICAgICAgICByZXR1cm4gInJlYWRqb3VybmFsICBbLW1zZ10gPGpv\ndXJuYWxfaWQgfCBqb3VybmFsX2ZpbGVfbmFtZT4iOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkg\newogICAgICAgICAgICByZXR1cm4gcmpPcHRzOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIENvbW1hbmQgdG8gcHJpbnQgbGFzdCBsb2cgbWFy\nawogICAgICovCiAgICBjbGFzcyBMYXN0TWFya0NtZCBleHRlbmRzIE15Q29t\nbWFuZCB7CiAgICAgICAgTGFzdE1hcmtDbWQoKSB7CiAgICAgICAgICAgIHN1\ncGVyKENNRF9MQVNUTUFSSyk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgaW50IHJ1bkNtZChDb21tYW5kTGluZSBjKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgcHJpbnRMYXN0TG9nTWFy\naygpOwogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsK\nICAgICAgICAgICAgcmV0dXJuICJQcmludCBsYXN0IGxvZyBtYXJrZXIuIjsK\nICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBn\nZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJuICJsYXN0bWFyayI7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBPcHRpb25zIGdl\ndE9wdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgT3B0aW9ucygp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIExpc3QgYXZhaWxh\nYmxlIGJvb2tpZXMKICAgICAqLwogICAgY2xhc3MgTGlzdEJvb2tpZXNDbWQg\nZXh0ZW5kcyBNeUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5l\ndyBPcHRpb25zKCk7CgogICAgICAgIExpc3RCb29raWVzQ21kKCkgewogICAg\nICAgICAgICBzdXBlcihDTURfTElTVEJPT0tJRVMpOwogICAgICAgICAgICBv\ncHRzLmFkZE9wdGlvbigicnciLCAicmVhZHdyaXRlIiwgZmFsc2UsICJQcmlu\ndCByZWFkd3JpdGUgYm9va2llcyIpOwogICAgICAgICAgICBvcHRzLmFkZE9w\ndGlvbigicm8iLCAicmVhZG9ubHkiLCBmYWxzZSwgIlByaW50IHJlYWRvbmx5\nIGJvb2tpZXMiKTsKICAgICAgICAgICAgb3B0cy5hZGRPcHRpb24oImgiLCAi\naG9zdG5hbWVzIiwgZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgIkFsc28g\ncHJpbnQgaG9zdG5hbWUgb2YgdGhlIGJvb2tpZSIpOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBydW5DbWQoQ29t\nbWFuZExpbmUgY21kTGluZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIGJvb2xlYW4gcmVhZHdyaXRlID0gY21kTGluZS5oYXNPcHRpb24oInJ3\nIik7CiAgICAgICAgICAgIGJvb2xlYW4gcmVhZG9ubHkgPSBjbWRMaW5lLmhh\nc09wdGlvbigicm8iKTsKCiAgICAgICAgICAgIGlmICgoIXJlYWR3cml0ZSAm\nJiAhcmVhZG9ubHkpIHx8IChyZWFkd3JpdGUgJiYgcmVhZG9ubHkpKSB7CiAg\nICAgICAgICAgICAgICBMT0cuZXJyb3IoIk9uZSBhbmQgb25seSBvbmUgb2Yg\nLXJlYWR3cml0ZSBhbmQgLXJlYWRvbmx5IG11c3QgYmUgc3BlY2lmaWVkIik7\nCiAgICAgICAgICAgICAgICBwcmludFVzYWdlKCk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBDbGllbnRD\nb25maWd1cmF0aW9uIGNsaWVudGNvbmYgPSBuZXcgQ2xpZW50Q29uZmlndXJh\ndGlvbihia0NvbmYpCiAgICAgICAgICAgICAgICAuc2V0WmtTZXJ2ZXJzKGJr\nQ29uZi5nZXRaa1NlcnZlcnMoKSk7CiAgICAgICAgICAgIEJvb2tLZWVwZXJB\nZG1pbiBia2EgPSBuZXcgQm9va0tlZXBlckFkbWluKGNsaWVudGNvbmYpOwoK\nICAgICAgICAgICAgaW50IGNvdW50ID0gMDsKICAgICAgICAgICAgQ29sbGVj\ndGlvbjxCb29raWVTb2NrZXRBZGRyZXNzPiBib29raWVzID0gbmV3IEFycmF5\nTGlzdDxCb29raWVTb2NrZXRBZGRyZXNzPigpOwogICAgICAgICAgICBpZiAo\nY21kTGluZS5oYXNPcHRpb24oInJ3IikpIHsKICAgICAgICAgICAgICAgIENv\nbGxlY3Rpb248Qm9va2llU29ja2V0QWRkcmVzcz4gYXZhaWxhYmxlQm9va2ll\ncyA9IGJrYQogICAgICAgICAgICAgICAgICAgICAgICAuZ2V0QXZhaWxhYmxl\nQm9va2llcygpOwogICAgICAgICAgICAgICAgYm9va2llcy5hZGRBbGwoYXZh\naWxhYmxlQm9va2llcyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY21kTGlu\nZS5oYXNPcHRpb24oInJvIikpIHsKICAgICAgICAgICAgICAgIENvbGxlY3Rp\nb248Qm9va2llU29ja2V0QWRkcmVzcz4gcm9Cb29raWVzID0gYmthCiAgICAg\nICAgICAgICAgICAgICAgICAgIC5nZXRSZWFkT25seUJvb2tpZXMoKTsKICAg\nICAgICAgICAgICAgIGJvb2tpZXMuYWRkQWxsKHJvQm9va2llcyk7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgZm9yIChCb29raWVTb2NrZXRBZGRyZXNz\nIGIgOiBib29raWVzKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnBy\naW50KGIpOwogICAgICAgICAgICAgICAgaWYgKGNtZExpbmUuaGFzT3B0aW9u\nKCJoIikpIHsKICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50\nKCJcdCIgKyBiLmdldFNvY2tldEFkZHJlc3MoKS5nZXRIb3N0TmFtZSgpKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQu\ncHJpbnRsbigiIik7CiAgICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGlmIChjb3VudCA9PSAwKSB7CiAgICAgICAg\nICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIk5vIGJvb2tpZSBleGlzdHMh\nIik7CiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAg\nICAgICAgcmV0dXJuICJMaXN0IHRoZSBib29raWVzLCB3aGljaCBhcmUgcnVu\nbmluZyBhcyBlaXRoZXIgcmVhZHdyaXRlIG9yIHJlYWRvbmx5IG1vZGUuIjsK\nICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBn\nZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJuICJsaXN0Ym9va2llcyAg\nWy1yZWFkd3JpdGV8LXJlYWRvbmx5XSBbLWhvc3RuYW1lc10iOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRp\nb25zKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb21tYW5kIHRvIHByaW50IGhlbHAgbWVz\nc2FnZQogICAgICovCiAgICBjbGFzcyBIZWxwQ21kIGV4dGVuZHMgTXlDb21t\nYW5kIHsKICAgICAgICBIZWxwQ21kKCkgewogICAgICAgICAgICBzdXBlcihD\nTURfSEVMUCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgaW50IHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgU3RyaW5nW10gYXJncyA9IGNt\nZExpbmUuZ2V0QXJncygpOwogICAgICAgICAgICBpZiAoYXJncy5sZW5ndGgg\nPT0gMCkgewogICAgICAgICAgICAgICAgcHJpbnRTaGVsbFVzYWdlKCk7CiAg\nICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBTdHJpbmcgY21kTmFtZSA9IGFyZ3NbMF07CiAgICAgICAgICAgIENv\nbW1hbmQgY21kID0gY29tbWFuZHMuZ2V0KGNtZE5hbWUpOwogICAgICAgICAg\nICBpZiAobnVsbCA9PSBjbWQpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5l\ncnIucHJpbnRsbigiVW5rbm93biBjb21tYW5kICIgKyBjbWROYW1lKTsKICAg\nICAgICAgICAgICAgIHByaW50U2hlbGxVc2FnZSgpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNtZC5w\ncmludFVzYWdlKCk7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0\naW9uKCkgewogICAgICAgICAgICByZXR1cm4gIkRlc2NyaWJlIHRoZSB1c2Fn\nZSBvZiB0aGlzIHByb2dyYW0gb3IgaXRzIHN1YmNvbW1hbmRzLiI7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0VXNh\nZ2UoKSB7CiAgICAgICAgICAgIHJldHVybiAiaGVscCAgICAgICAgIFtDT01N\nQU5EXSI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBP\ncHRpb25zIGdldE9wdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nT3B0aW9ucygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENv\nbW1hbmQgZm9yIGFkbWluaXN0cmF0aW9uIG9mIGF1dG9yZWNvdmVyeQogICAg\nICovCiAgICBjbGFzcyBBdXRvUmVjb3ZlcnlDbWQgZXh0ZW5kcyBNeUNvbW1h\nbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7Cgog\nICAgICAgIHB1YmxpYyBBdXRvUmVjb3ZlcnlDbWQoKSB7CiAgICAgICAgICAg\nIHN1cGVyKENNRF9BVVRPUkVDT1ZFUlkpOwogICAgICAgICAgICBvcHRzLmFk\nZE9wdGlvbigiZSIsICJlbmFibGUiLCBmYWxzZSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIkVuYWJsZSBhdXRvIHJlY292ZXJ5IG9mIHVuZGVycmVw\nbGljYXRlZCBsZWRnZXJzIik7CiAgICAgICAgICAgIG9wdHMuYWRkT3B0aW9u\nKCJkIiwgImRpc2FibGUiLCBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIkRpc2FibGUgYXV0byByZWNvdmVyeSBvZiB1bmRlcnJlcGxpY2F0\nZWQgbGVkZ2VycyIpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkgewogICAgICAgICAgICByZXR1\ncm4gb3B0czsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJu\nICJFbmFibGUgb3IgZGlzYWJsZSBhdXRvcmVjb3ZlcnkgaW4gdGhlIGNsdXN0\nZXIuIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0\ncmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJuICJhdXRvcmVj\nb3ZlcnkgWy1lbmFibGV8LWRpc2FibGVdIjsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIGludCBydW5DbWQoQ29tbWFuZExpbmUgY21k\nTGluZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJvb2xlYW4g\nZGlzYWJsZSA9IGNtZExpbmUuaGFzT3B0aW9uKCJkIik7CiAgICAgICAgICAg\nIGJvb2xlYW4gZW5hYmxlID0gY21kTGluZS5oYXNPcHRpb24oImUiKTsKCiAg\nICAgICAgICAgIGlmICgoIWRpc2FibGUgJiYgIWVuYWJsZSkKICAgICAgICAg\nICAgICAgIHx8IChlbmFibGUgJiYgZGlzYWJsZSkpIHsKICAgICAgICAgICAg\nICAgIExPRy5lcnJvcigiT25lIGFuZCBvbmx5IG9uZSBvZiAtZW5hYmxlIGFu\nZCAtZGlzYWJsZSBtdXN0IGJlIHNwZWNpZmllZCIpOwogICAgICAgICAgICAg\nICAgcHJpbnRVc2FnZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgWm9vS2VlcGVyIHprID0gbnVsbDsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFpvb0tlZXBlcldh\ndGNoZXJCYXNlIHcgPSBuZXcgWm9vS2VlcGVyV2F0Y2hlckJhc2UoYmtDb25m\nLmdldFprVGltZW91dCgpKTsKICAgICAgICAgICAgICAgIHprID0gWmtVdGls\ncy5jcmVhdGVDb25uZWN0ZWRab29rZWVwZXJDbGllbnQoYmtDb25mLmdldFpr\nU2VydmVycygpLCB3KTsKICAgICAgICAgICAgICAgIExlZGdlck1hbmFnZXJG\nYWN0b3J5IG1GYWN0b3J5ID0gTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVk\nZ2VyTWFuYWdlckZhY3RvcnkoYmtDb25mLCB6ayk7CiAgICAgICAgICAgICAg\nICBMZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlciB1bmRlcnJlcGxpY2F0\naW9uTWFuYWdlciA9IG1GYWN0b3J5Lm5ld0xlZGdlclVuZGVycmVwbGljYXRp\nb25NYW5hZ2VyKCk7CiAgICAgICAgICAgICAgICBpZiAoZW5hYmxlKSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKHVuZGVycmVwbGljYXRpb25NYW5hZ2Vy\nLmlzTGVkZ2VyUmVwbGljYXRpb25FbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgTE9HLndhcm4oIkF1dG9yZWNvdmVyeSBhbHJlYWR5IGVu\nYWJsZWQuIERvaW5nIG5vdGhpbmciKTsKICAgICAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiRW5h\nYmxpbmcgYXV0b3JlY292ZXJ5Iik7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHVuZGVycmVwbGljYXRpb25NYW5hZ2VyLmVuYWJsZUxlZGdlclJlcGxpY2F0\naW9uKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXVuZGVycmVwbGlj\nYXRpb25NYW5hZ2VyLmlzTGVkZ2VyUmVwbGljYXRpb25FbmFibGVkKCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgTE9HLndhcm4oIkF1dG9yZWNvdmVy\neSBhbHJlYWR5IGRpc2FibGVkLiBEb2luZyBub3RoaW5nIik7CiAgICAgICAg\nICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nTE9HLmluZm8oIkRpc2FibGluZyBhdXRvcmVjb3ZlcnkiKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgdW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIuZGlzYWJs\nZUxlZGdlclJlcGxpY2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgaWYgKHprICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICB6ay5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CgogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQcmludCB3aGljaCBub2RlIGhhcyB0aGUgYXVkaXRv\nciBsb2NrCiAgICAgKi8KICAgIGNsYXNzIFdob0lzQXVkaXRvckNtZCBleHRl\nbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBvcHRzID0gbmV3IE9w\ndGlvbnMoKTsKCiAgICAgICAgcHVibGljIFdob0lzQXVkaXRvckNtZCgpIHsK\nICAgICAgICAgICAgc3VwZXIoQ01EX1dIT0lTQVVESVRPUik7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBPcHRpb25zIGdldE9wdGlv\nbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBvcHRzOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9u\nKCkgewogICAgICAgICAgICByZXR1cm4gIlByaW50IHRoZSBub2RlIHdoaWNo\nIGhvbGRzIHRoZSBhdWRpdG9yIGxvY2siOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkgewogICAgICAg\nICAgICByZXR1cm4gIndob2lzYXVkaXRvciI7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNt\nZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBab29LZWVw\nZXIgemsgPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgWm9vS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVwZXJXYXRj\naGVyQmFzZShia0NvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAgICAgICAg\nICAgemsgPSBaa1V0aWxzLmNyZWF0ZUNvbm5lY3RlZFpvb2tlZXBlckNsaWVu\ndChia0NvbmYuZ2V0WmtTZXJ2ZXJzKCksIHcpOwogICAgICAgICAgICAgICAg\nQm9va2llU29ja2V0QWRkcmVzcyBib29raWVJZCA9IEF1ZGl0b3JFbGVjdG9y\nLmdldEN1cnJlbnRBdWRpdG9yKGJrQ29uZiwgemspOwogICAgICAgICAgICAg\nICAgaWYgKGJvb2tpZUlkID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAg\nICBMT0cuaW5mbygiTm8gYXVkaXRvciBlbGVjdGVkIik7CiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgTE9HLmluZm8oIkF1ZGl0b3I6IHt9L3t9Ont9IiwKICAgICAg\nICAgICAgICAgICAgICAgICAgIG5ldyBPYmplY3RbXSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgYm9va2llSWQuZ2V0U29ja2V0QWRkcmVzcygp\nLmdldEFkZHJlc3MoKS5nZXRDYW5vbmljYWxIb3N0TmFtZSgpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGJvb2tpZUlkLmdldFNvY2tldEFkZHJl\nc3MoKS5nZXRBZGRyZXNzKCkuZ2V0SG9zdEFkZHJlc3MoKSwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBib29raWVJZC5nZXRTb2NrZXRBZGRyZXNz\nKCkuZ2V0UG9ydCgpIH0pOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgaWYgKHprICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICB6ay5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CgogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBVcGRhdGUgY29va2llIGNvbW1hbmQKICAgICAqLwog\nICAgY2xhc3MgVXBkYXRlQ29va2llQ21kIGV4dGVuZHMgTXlDb21tYW5kIHsK\nICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAgICAg\nICBVcGRhdGVDb29raWVDbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9V\nUERBVEVDT09LSUUpOwogICAgICAgICAgICBvcHRzLmFkZE9wdGlvbigiYiIs\nICJib29raWVJZCIsIHRydWUsICJCb29raWUgSWQiKTsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIE9wdGlvbnMgZ2V0T3B0aW9ucygp\nIHsKICAgICAgICAgICAgcmV0dXJuIG9wdHM7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0RGVzY3JpcHRpb24oKSB7\nCiAgICAgICAgICAgIHJldHVybiAiVXBkYXRlIGJvb2tpZSBpZCBpbiBjb29r\naWUiOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3Ry\naW5nIGdldFVzYWdlKCkgewogICAgICAgICAgICByZXR1cm4gInVwZGF0ZWNv\nb2tpZSAtYm9va2llSWQgPGhvc3RuYW1lfGlwPiI7CiAgICAgICAgfQoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRMaW5l\nIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBmaW5h\nbCBTdHJpbmcgYm9va2llSWQgPSBjbWRMaW5lLmdldE9wdGlvblZhbHVlKCJi\nb29raWVJZCIpOwogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNCbGFu\nayhib29raWVJZCkpIHsKICAgICAgICAgICAgICAgIExPRy5lcnJvcigiSW52\nYWxpZCBhcmd1bWVudCBsaXN0ISIpOwogICAgICAgICAgICAgICAgdGhpcy5w\ncmludFVzYWdlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5lcXVhbHMo\nYm9va2llSWQsICJob3N0bmFtZSIpICYmICFTdHJpbmdVdGlscy5lcXVhbHMo\nYm9va2llSWQsICJpcCIpKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3Io\nIkludmFsaWQgb3B0aW9uIHZhbHVlOiIgKyBib29raWVJZCk7CiAgICAgICAg\nICAgICAgICB0aGlzLnByaW50VXNhZ2UoKTsKICAgICAgICAgICAgICAgIHJl\ndHVybiAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBib29sZWFuIHVz\nZUhvc3ROYW1lID0gZ2V0T3B0aW9uYWxWYWx1ZShib29raWVJZCwgImhvc3Ru\nYW1lIik7CiAgICAgICAgICAgIGlmICghYmtDb25mLmdldFVzZUhvc3ROYW1l\nQXNCb29raWVJRCgpICYmIHVzZUhvc3ROYW1lKSB7CiAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIkV4cGVjdHMgY29uZmlndXJhdGlvbiB1c2VIb3N0TmFt\nZUFzQm9va2llSUQ9dHJ1ZSBhcyB0aGUgb3B0aW9uIHZhbHVlIHBhc3NlZCBp\ncyAnaG9zdG5hbWUnIik7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAg\nICAgICAgICAgIH0gZWxzZSBpZiAoYmtDb25mLmdldFVzZUhvc3ROYW1lQXNC\nb29raWVJRCgpICYmICF1c2VIb3N0TmFtZSkgewogICAgICAgICAgICAgICAg\nTE9HLmVycm9yKCJFeHBlY3RzIGNvbmZpZ3VyYXRpb24gdXNlSG9zdE5hbWVB\nc0Jvb2tpZUlEPWZhbHNlIGFzIHRoZSBvcHRpb24gdmFsdWUgcGFzc2VkIGlz\nICdpcCciKTsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICByZXR1cm4gdXBkYXRlQm9va2llSWRJbkNvb2tp\nZShib29raWVJZCwgdXNlSG9zdE5hbWUpOwogICAgICAgIH0KCiAgICAgICAg\ncHJpdmF0ZSBpbnQgdXBkYXRlQm9va2llSWRJbkNvb2tpZShmaW5hbCBTdHJp\nbmcgYm9va2llSWQsIGZpbmFsIGJvb2xlYW4gdXNlSG9zdG5hbWUpIHRocm93\ncyBJT0V4Y2VwdGlvbiwKICAgICAgICAgICAgICAgIEludGVycnVwdGVkRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgWm9vS2VlcGVyIHprID0gbnVsbDsKICAg\nICAgICAgICAgWm9vS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVw\nZXJXYXRjaGVyQmFzZShia0NvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgemsgPSBaa1V0aWxzLmNyZWF0\nZUNvbm5lY3RlZFpvb2tlZXBlckNsaWVudChia0NvbmYuZ2V0WmtTZXJ2ZXJz\nKCksIHcpOwogICAgICAgICAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBj\nb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmtDb25mKTsKICAgICAg\nICAgICAgICAgIFN0cmluZyBuZXdCb29raWVJZCA9IEJvb2tpZS5nZXRCb29r\naWVBZGRyZXNzKGNvbmYpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICAv\nLyByZWFkIG9sZGNvb2tpZQogICAgICAgICAgICAgICAgVmVyc2lvbmVkPENv\nb2tpZT4gb2xkQ29va2llID0gbnVsbDsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgY29uZi5zZXRVc2VIb3N0TmFtZUFzQm9v\na2llSUQoIXVzZUhvc3RuYW1lKTsKICAgICAgICAgICAgICAgICAgICBvbGRD\nb29raWUgPSBDb29raWUucmVhZEZyb21ab29LZWVwZXIoemssIGNvbmYpOwog\nICAgICAgICAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uLk5vTm9k\nZUV4Y2VwdGlvbiBubmUpIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJy\nb3IoIkVpdGhlciBjb29raWUgYWxyZWFkeSB1cGRhdGVkIHdpdGggVXNlSG9z\ndE5hbWVBc0Jvb2tpZUlEPXt9IG9yIG5vIGNvb2tpZSBleGlzdHMhIiwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHVzZUhvc3RuYW1lLCBubmUpOwog\nICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIENvb2tpZSBuZXdDb29raWUgPSBDb29raWUu\nbmV3QnVpbGRlcihvbGRDb29raWUuZ2V0VmFsdWUoKSkuc2V0Qm9va2llSG9z\ndChuZXdCb29raWVJZCkuYnVpbGQoKTsKICAgICAgICAgICAgICAgIGJvb2xl\nYW4gaGFzQ29va2llVXBkYXRlZEluRGlycyA9IHZlcmlmeUNvb2tpZShuZXdD\nb29raWUsIGpvdXJuYWxEaXJlY3RvcnkpOwogICAgICAgICAgICAgICAgZm9y\nIChGaWxlIGRpciA6IGxlZGdlckRpcmVjdG9yaWVzKSB7CiAgICAgICAgICAg\nICAgICAgICAgaGFzQ29va2llVXBkYXRlZEluRGlycyAmPSB2ZXJpZnlDb29r\naWUobmV3Q29va2llLCBkaXIpOwogICAgICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgICAgIGlmIChoYXNDb29raWVVcGRhdGVkSW5EaXJzKSB7CiAgICAg\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAg\nY29uZi5zZXRVc2VIb3N0TmFtZUFzQm9va2llSUQodXNlSG9zdG5hbWUpOwog\nICAgICAgICAgICAgICAgICAgICAgICBDb29raWUucmVhZEZyb21ab29LZWVw\nZXIoemssIGNvbmYpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaW5j\nZSBuZXdjb29raWUgZXhpc3RzLCBqdXN0IGRvIGNsZWFudXAgb2Ygb2xkY29v\na2llIGFuZCByZXR1cm4KICAgICAgICAgICAgICAgICAgICAgICAgY29uZi5z\nZXRVc2VIb3N0TmFtZUFzQm9va2llSUQoIXVzZUhvc3RuYW1lKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgb2xkQ29va2llLmdldFZhbHVlKCkuZGVsZXRl\nRnJvbVpvb0tlZXBlcih6aywgY29uZiwgb2xkQ29va2llLmdldFZlcnNpb24o\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbi5Ob05vZGVF\neGNlcHRpb24gbm5lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5k\nZWJ1ZygiSWdub3JpbmcsIGNvb2tpZSB3aWxsIGJlIHdyaXR0ZW4gdG8gem9v\na2VlcGVyIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyB3cml0ZXMgbmV3\nY29va2llIHRvIGxvY2FsIGRpcnMKICAgICAgICAgICAgICAgICAgICBuZXdD\nb29raWUud3JpdGVUb0RpcmVjdG9yeShqb3VybmFsRGlyZWN0b3J5KTsKICAg\nICAgICAgICAgICAgICAgICBMT0cuaW5mbygiVXBkYXRlZCBjb29raWUgZmls\nZSBwcmVzZW50IGluIGpvdXJuYWxEaXJlY3Rvcnkge30iLCBqb3VybmFsRGly\nZWN0b3J5KTsKICAgICAgICAgICAgICAgICAgICBmb3IgKEZpbGUgZGlyIDog\nbGVkZ2VyRGlyZWN0b3JpZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nbmV3Q29va2llLndyaXRlVG9EaXJlY3RvcnkoZGlyKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIlVwZGF0\nZWQgY29va2llIGZpbGUgcHJlc2VudCBpbiBsZWRnZXJEaXJlY3RvcmllcyB7\nfSIsIGxlZGdlckRpcmVjdG9yaWVzKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIC8vIHdyaXRlcyBuZXdjb29raWUgdG8gem9va2VlcGVy\nCiAgICAgICAgICAgICAgICBjb25mLnNldFVzZUhvc3ROYW1lQXNCb29raWVJ\nRCh1c2VIb3N0bmFtZSk7CiAgICAgICAgICAgICAgICBuZXdDb29raWUud3Jp\ndGVUb1pvb0tlZXBlcih6aywgY29uZiwgVmVyc2lvbi5ORVcpOwoKICAgICAg\nICAgICAgICAgIC8vIGRlbGV0ZSBvbGRjb29raWUKICAgICAgICAgICAgICAg\nIGNvbmYuc2V0VXNlSG9zdE5hbWVBc0Jvb2tpZUlEKCF1c2VIb3N0bmFtZSk7\nCiAgICAgICAgICAgICAgICBvbGRDb29raWUuZ2V0VmFsdWUoKS5kZWxldGVG\ncm9tWm9vS2VlcGVyKHprLCBjb25mLCBvbGRDb29raWUuZ2V0VmVyc2lvbigp\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uIGtlKSB7\nCiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIktlZXBlckV4Y2VwdGlvbiBk\ndXJpbmcgY29va2llIHVwZGF0aW9uISIsIGtlKTsKICAgICAgICAgICAgICAg\nIHJldHVybiAtMTsKICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9lKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIklPRXhjZXB0aW9u\nIGR1cmluZyBjb29raWUgdXBkYXRpb24hIiwgaW9lKTsKICAgICAgICAgICAg\nICAgIHJldHVybiAtMTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIGlmICh6ayAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgemsuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHBy\naXZhdGUgYm9vbGVhbiBnZXRPcHRpb25hbFZhbHVlKFN0cmluZyBvcHRWYWx1\nZSwgU3RyaW5nIG9wdE5hbWUpIHsKICAgICAgICAgICAgaWYgKFN0cmluZ1V0\naWxzLmVxdWFscyhvcHRWYWx1ZSwgb3B0TmFtZSkpIHsKICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUgYm9vbGVh\nbiB2ZXJpZnlDb29raWUoQ29va2llIG9sZENvb2tpZSwgRmlsZSBkaXIpIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBDb29raWUgY29va2llID0gQ29va2llLnJlYWRGcm9tRGlyZWN0\nb3J5KGRpcik7CiAgICAgICAgICAgICAgICBjb29raWUudmVyaWZ5KG9sZENv\nb2tpZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEludmFsaWRDb29raWVFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nICAgIH0KCiAgICBmaW5hbCBNYXA8U3RyaW5nLCBNeUNvbW1hbmQ+IGNvbW1h\nbmRzID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBNeUNvbW1hbmQ+KCk7CiAgICB7\nCiAgICAgICAgY29tbWFuZHMucHV0KENNRF9NRVRBRk9STUFULCBuZXcgTWV0\nYUZvcm1hdENtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01EX0JPT0tJ\nRUZPUk1BVCwgbmV3IEJvb2tpZUZvcm1hdENtZCgpKTsKICAgICAgICBjb21t\nYW5kcy5wdXQoQ01EX1JFQ09WRVIsIG5ldyBSZWNvdmVyQ21kKCkpOwogICAg\nICAgIGNvbW1hbmRzLnB1dChDTURfTEVER0VSLCBuZXcgTGVkZ2VyQ21kKCkp\nOwogICAgICAgIGNvbW1hbmRzLnB1dChDTURfTElTVExFREdFUlMsIG5ldyBM\naXN0TGVkZ2Vyc0NtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01EX0xJ\nU1RVTkRFUlJFUExJQ0FURUQsIG5ldyBMaXN0VW5kZXJyZXBsaWNhdGVkQ21k\nKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChDTURfV0hPSVNBVURJVE9SLCBu\nZXcgV2hvSXNBdWRpdG9yQ21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChD\nTURfTEVER0VSTUVUQURBVEEsIG5ldyBMZWRnZXJNZXRhZGF0YUNtZCgpKTsK\nICAgICAgICBjb21tYW5kcy5wdXQoQ01EX1NJTVBMRVRFU1QsIG5ldyBTaW1w\nbGVUZXN0Q21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChDTURfUkVBRExP\nRywgbmV3IFJlYWRMb2dDbWQoKSk7CiAgICAgICAgY29tbWFuZHMucHV0KENN\nRF9SRUFESk9VUk5BTCwgbmV3IFJlYWRKb3VybmFsQ21kKCkpOwogICAgICAg\nIGNvbW1hbmRzLnB1dChDTURfTEFTVE1BUkssIG5ldyBMYXN0TWFya0NtZCgp\nKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01EX0FVVE9SRUNPVkVSWSwgbmV3\nIEF1dG9SZWNvdmVyeUNtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01E\nX0xJU1RCT09LSUVTLCBuZXcgTGlzdEJvb2tpZXNDbWQoKSk7CiAgICAgICAg\nY29tbWFuZHMucHV0KENNRF9VUERBVEVDT09LSUUsIG5ldyBVcGRhdGVDb29r\naWVDbWQoKSk7CiAgICAgICAgY29tbWFuZHMucHV0KENNRF9IRUxQLCBuZXcg\nSGVscENtZCgpKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHNldENvbmYoQ29uZmlndXJhdGlvbiBjb25mKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBia0NvbmYubG9hZENvbmYoY29uZik7CiAgICAgICAg\nam91cm5hbERpcmVjdG9yeSA9IEJvb2tpZS5nZXRDdXJyZW50RGlyZWN0b3J5\nKGJrQ29uZi5nZXRKb3VybmFsRGlyKCkpOwogICAgICAgIGxlZGdlckRpcmVj\ndG9yaWVzID0gQm9va2llLmdldEN1cnJlbnREaXJlY3Rvcmllcyhia0NvbmYu\nZ2V0TGVkZ2VyRGlycygpKTsKICAgICAgICBmb3JtYXR0ZXIgPSBFbnRyeUZv\ncm1hdHRlci5uZXdFbnRyeUZvcm1hdHRlcihia0NvbmYsIEVOVFJZX0ZPUk1B\nVFRFUl9DTEFTUyk7CiAgICAgICAgTE9HLmRlYnVnKCJVc2luZyBlbnRyeSBm\nb3JtYXR0ZXIge30iLCBmb3JtYXR0ZXIuZ2V0Q2xhc3MoKS5nZXROYW1lKCkp\nOwogICAgICAgIHBhZ2VTaXplID0gYmtDb25mLmdldFBhZ2VTaXplKCk7CiAg\nICAgICAgZW50cmllc1BlclBhZ2UgPSBwYWdlU2l6ZSAvIDg7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIHByaW50U2hlbGxVc2FnZSgpIHsKICAgICAgICBT\neXN0ZW0uZXJyLnByaW50bG4oIlVzYWdlOiBCb29raWVTaGVsbCBbLWNvbmYg\nY29uZmlndXJhdGlvbl0gPGNvbW1hbmQ+Iik7CiAgICAgICAgU3lzdGVtLmVy\nci5wcmludGxuKCk7CiAgICAgICAgTGlzdDxTdHJpbmc+IGNvbW1hbmROYW1l\ncyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAgIGZvciAoTXlD\nb21tYW5kIGMgOiBjb21tYW5kcy52YWx1ZXMoKSkgewogICAgICAgICAgICBj\nb21tYW5kTmFtZXMuYWRkKCIgICAgICAgIiArIGMuZ2V0VXNhZ2UoKSk7CiAg\nICAgICAgfQogICAgICAgIENvbGxlY3Rpb25zLnNvcnQoY29tbWFuZE5hbWVz\nKTsKICAgICAgICBmb3IgKFN0cmluZyBzIDogY29tbWFuZE5hbWVzKSB7CiAg\nICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihzKTsKICAgICAgICB9CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IHJ1bihTdHJpbmdb\nXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYXJncy5s\nZW5ndGggPD0gMCkgewogICAgICAgICAgICBwcmludFNoZWxsVXNhZ2UoKTsK\nICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBTdHJp\nbmcgY21kTmFtZSA9IGFyZ3NbMF07CiAgICAgICAgQ29tbWFuZCBjbWQgPSBj\nb21tYW5kcy5nZXQoY21kTmFtZSk7CiAgICAgICAgaWYgKG51bGwgPT0gY21k\nKSB7CiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiRVJST1I6IFVu\na25vd24gY29tbWFuZCAiICsgY21kTmFtZSk7CiAgICAgICAgICAgIHByaW50\nU2hlbGxVc2FnZSgpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAg\nfQogICAgICAgIC8vIHByZXBhcmUgbmV3IGFyZ3MKICAgICAgICBTdHJpbmdb\nXSBuZXdBcmdzID0gbmV3IFN0cmluZ1thcmdzLmxlbmd0aCAtIDFdOwogICAg\nICAgIFN5c3RlbS5hcnJheWNvcHkoYXJncywgMSwgbmV3QXJncywgMCwgbmV3\nQXJncy5sZW5ndGgpOwogICAgICAgIHJldHVybiBjbWQucnVuQ21kKG5ld0Fy\nZ3MpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmlu\nZyBhcmd2W10pIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNo\nZWxsIHNoZWxsID0gbmV3IEJvb2tpZVNoZWxsKCk7CiAgICAgICAgaWYgKGFy\nZ3YubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAgc2hlbGwucHJpbnRTaGVs\nbFVzYWdlKCk7CiAgICAgICAgICAgIFN5c3RlbS5leGl0KC0xKTsKICAgICAg\nICB9CgogICAgICAgIENvbXBvc2l0ZUNvbmZpZ3VyYXRpb24gY29uZiA9IG5l\ndyBDb21wb3NpdGVDb25maWd1cmF0aW9uKCk7CiAgICAgICAgLy8gbG9hZCBj\nb25maWd1cmF0aW9uCiAgICAgICAgaWYgKCItY29uZiIuZXF1YWxzKGFyZ3Zb\nMF0pKSB7CiAgICAgICAgICAgIGlmIChhcmd2Lmxlbmd0aCA8PSAxKSB7CiAg\nICAgICAgICAgICAgICBzaGVsbC5wcmludFNoZWxsVXNhZ2UoKTsKICAgICAg\nICAgICAgICAgIFN5c3RlbS5leGl0KC0xKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBjb25mLmFkZENvbmZpZ3VyYXRpb24obmV3IFByb3BlcnRpZXND\nb25maWd1cmF0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbmV3IEZpbGUoYXJndlsxXSkudG9VUkkoKS50b1VSTCgpKSk7CgogICAg\nICAgICAgICBTdHJpbmdbXSBuZXdBcmd2ID0gbmV3IFN0cmluZ1thcmd2Lmxl\nbmd0aCAtIDJdOwogICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGFyZ3Ys\nIDIsIG5ld0FyZ3YsIDAsIG5ld0FyZ3YubGVuZ3RoKTsKICAgICAgICAgICAg\nYXJndiA9IG5ld0FyZ3Y7CiAgICAgICAgfQoKCiAgICAgICAgc2hlbGwuc2V0\nQ29uZihjb25mKTsKICAgICAgICBpbnQgcmVzID0gc2hlbGwucnVuKGFyZ3Yp\nOwogICAgICAgIFN5c3RlbS5leGl0KHJlcyk7CiAgICB9CgogICAgLy8vCiAg\nICAvLy8gQm9va2llIEZpbGUgT3BlcmF0aW9ucwogICAgLy8vCgogICAgLyoq\nCiAgICAgKiBHZXQgdGhlIGxlZGdlciBmaWxlIG9mIGEgc3BlY2lmaWVkIGxl\nZGdlci4KICAgICAqCiAgICAgKiBAcGFyYW0gbGVkZ2VySWQKICAgICAqICAg\nICAgICAgIExlZGdlciBJZAogICAgICoKICAgICAqIEByZXR1cm4gZmlsZSBv\nYmplY3QuCiAgICAgKi8KICAgIHByaXZhdGUgRmlsZSBnZXRMZWRnZXJGaWxl\nKGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICBTdHJpbmcgbGVkZ2VyTmFtZSA9\nIEluZGV4UGVyc2lzdGVuY2VNZ3IuZ2V0TGVkZ2VyTmFtZShsZWRnZXJJZCk7\nCiAgICAgICAgRmlsZSBsZiA9IG51bGw7CiAgICAgICAgZm9yIChGaWxlIGQg\nOiBsZWRnZXJEaXJlY3RvcmllcykgewogICAgICAgICAgICBsZiA9IG5ldyBG\naWxlKGQsIGxlZGdlck5hbWUpOwogICAgICAgICAgICBpZiAobGYuZXhpc3Rz\nKCkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGxmID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIGxmOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IEZpbGVJbmZvIGZvciBh\nIHNwZWNpZmllZCBsZWRnZXIuCiAgICAgKgogICAgICogQHBhcmFtIGxlZGdl\ncklkCiAgICAgKiAgICAgICAgICBMZWRnZXIgSWQKICAgICAqIEByZXR1cm4g\ncmVhZCBvbmx5IGZpbGUgaW5mbyBpbnN0YW5jZQogICAgICovCiAgICBSZWFk\nT25seUZpbGVJbmZvIGdldEZpbGVJbmZvKGxvbmcgbGVkZ2VySWQpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgRmlsZSBsZWRnZXJGaWxlID0gZ2V0\nTGVkZ2VyRmlsZShsZWRnZXJJZCk7CiAgICAgICAgaWYgKG51bGwgPT0gbGVk\nZ2VyRmlsZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRmlsZU5vdEZvdW5k\nRXhjZXB0aW9uKCJObyBpbmRleCBmaWxlIGZvdW5kIGZvciBsZWRnZXIgIiAr\nIGxlZGdlcklkICsgIi4gSXQgbWF5IGJlIG5vdCBmbHVzaGVkIHlldC4iKTsK\nICAgICAgICB9CiAgICAgICAgUmVhZE9ubHlGaWxlSW5mbyBmaSA9IG5ldyBS\nZWFkT25seUZpbGVJbmZvKGxlZGdlckZpbGUsIG51bGwpOwogICAgICAgIGZp\nLnJlYWRIZWFkZXIoKTsKICAgICAgICByZXR1cm4gZmk7CiAgICB9CgogICAg\ncHJpdmF0ZSBzeW5jaHJvbml6ZWQgdm9pZCBpbml0RW50cnlMb2dnZXIoKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChudWxsID09IGVudHJ5\nTG9nZ2VyKSB7CiAgICAgICAgICAgIC8vIHByb3ZpZGUgcmVhZCBvbmx5IGVu\ndHJ5IGxvZ2dlcgogICAgICAgICAgICBlbnRyeUxvZ2dlciA9IG5ldyBSZWFk\nT25seUVudHJ5TG9nZ2VyKGJrQ29uZik7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogc2NhbiBvdmVyIGVudHJ5IGxvZwogICAgICoKICAgICAq\nIEBwYXJhbSBsb2dJZAogICAgICogICAgICAgICAgRW50cnkgTG9nIElkCiAg\nICAgKiBAcGFyYW0gc2Nhbm5lcgogICAgICogICAgICAgICAgRW50cnkgTG9n\nIFNjYW5uZXIKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2NhbkVudHJ5\nTG9nKGxvbmcgbG9nSWQsIEVudHJ5TG9nU2Nhbm5lciBzY2FubmVyKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIGluaXRFbnRyeUxvZ2dlcigpOwog\nICAgICAgIGVudHJ5TG9nZ2VyLnNjYW5FbnRyeUxvZyhsb2dJZCwgc2Nhbm5l\ncik7CiAgICB9CgogICAgcHJpdmF0ZSBzeW5jaHJvbml6ZWQgSm91cm5hbCBn\nZXRKb3VybmFsKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nbnVsbCA9PSBqb3VybmFsKSB7CiAgICAgICAgICAgIGpvdXJuYWwgPSBuZXcg\nSm91cm5hbChia0NvbmYsIG5ldyBMZWRnZXJEaXJzTWFuYWdlcihia0NvbmYs\nIGJrQ29uZi5nZXRMZWRnZXJEaXJzKCkpKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGpvdXJuYWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBTY2FuIGpv\ndXJuYWwgZmlsZQogICAgICoKICAgICAqIEBwYXJhbSBqb3VybmFsSWQKICAg\nICAqICAgICAgICAgIEpvdXJuYWwgRmlsZSBJZAogICAgICogQHBhcmFtIHNj\nYW5uZXIKICAgICAqICAgICAgICAgIEpvdXJuYWwgRmlsZSBTY2FubmVyCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNjYW5Kb3VybmFsKGxvbmcgam91\ncm5hbElkLCBKb3VybmFsU2Nhbm5lciBzY2FubmVyKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIGdldEpvdXJuYWwoKS5zY2FuSm91cm5hbChqb3Vy\nbmFsSWQsIDBMLCBzY2FubmVyKTsKICAgIH0KCiAgICAvLy8KICAgIC8vLyBC\nb29raWUgU2hlbGwgQ29tbWFuZHMKICAgIC8vLwoKICAgIC8qKgogICAgICog\nUmVhZCBsZWRnZXIgbWV0YQogICAgICoKICAgICAqIEBwYXJhbSBsZWRnZXJJ\nZAogICAgICogICAgICAgICAgTGVkZ2VyIElkCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHJlYWRMZWRnZXJNZXRhKGxvbmcgbGVkZ2VySWQpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiPT09\nPT0gTEVER0VSOiAiICsgbGVkZ2VySWQgKyAiID09PT09Iik7CiAgICAgICAg\nRmlsZUluZm8gZmkgPSBnZXRGaWxlSW5mbyhsZWRnZXJJZCk7CiAgICAgICAg\nYnl0ZVtdIG1hc3RlcktleSA9IGZpLmdldE1hc3RlcktleSgpOwogICAgICAg\nIGlmIChudWxsID09IG1hc3RlcktleSkgewogICAgICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oIm1hc3RlciBrZXkgIDogTlVMTCIpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigibWFzdGVy\nIGtleSAgOiAiICsgYnl0ZXMySGV4KGZpLmdldE1hc3RlcktleSgpKSk7CiAg\nICAgICAgfQogICAgICAgIGxvbmcgc2l6ZSA9IGZpLnNpemUoKTsKICAgICAg\nICBpZiAoc2l6ZSAlIDggPT0gMCkgewogICAgICAgICAgICBTeXN0ZW0ub3V0\nLnByaW50bG4oInNpemUgICAgICAgIDogIiArIHNpemUpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigic2l6ZSA6\nICIgKyBzaXplICsgIiAobm90IGFsaWduZWQgd2l0aCA4LCBtYXkgYmUgY29y\ncnVwdGVkIG9yIHVuZGVyIGZsdXNoaW5nIG5vdykiKTsKICAgICAgICB9CiAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJlbnRyaWVzICAgICA6ICIgKyAo\nc2l6ZSAvIDgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlYWQgbGVkZ2Vy\nIGluZGV4IGVudGlyZXMKICAgICAqCiAgICAgKiBAcGFyYW0gbGVkZ2VySWQK\nICAgICAqICAgICAgICAgIExlZGdlciBJZAogICAgICogQHRocm93cyBJT0V4\nY2VwdGlvbgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCByZWFkTGVkZ2Vy\nSW5kZXhFbnRyaWVzKGxvbmcgbGVkZ2VySWQpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCI9PT09PSBMRURHRVI6\nICIgKyBsZWRnZXJJZCArICIgPT09PT0iKTsKICAgICAgICBGaWxlSW5mbyBm\naSA9IGdldEZpbGVJbmZvKGxlZGdlcklkKTsKICAgICAgICBsb25nIHNpemUg\nPSBmaS5zaXplKCk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJzaXpl\nICAgICAgICA6ICIgKyBzaXplKTsKICAgICAgICBsb25nIGN1clNpemUgPSAw\nOwogICAgICAgIGxvbmcgY3VyRW50cnkgPSAwOwogICAgICAgIExlZGdlckVu\ndHJ5UGFnZSBsZXAgPSBuZXcgTGVkZ2VyRW50cnlQYWdlKHBhZ2VTaXplLCBl\nbnRyaWVzUGVyUGFnZSk7CiAgICAgICAgbGVwLnVzZVBhZ2UoKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB3aGlsZSAoY3VyU2l6ZSA8IHNpemUpIHsK\nICAgICAgICAgICAgICAgIGxlcC5zZXRMZWRnZXJBbmRGaXJzdEVudHJ5KGxl\nZGdlcklkLCBjdXJFbnRyeSk7CiAgICAgICAgICAgICAgICBsZXAucmVhZFBh\nZ2UoZmkpOwoKICAgICAgICAgICAgICAgIC8vIHByb2Nlc3MgYSBwYWdlCiAg\nICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8ZW50cmllc1BlclBhZ2U7\nIGkrKykgewogICAgICAgICAgICAgICAgICAgIGxvbmcgb2Zmc2V0ID0gbGVw\nLmdldE9mZnNldChpICogOCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKDAg\nPT0gb2Zmc2V0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbigiZW50cnkgIiArIGN1ckVudHJ5ICsgIlx0Olx0Ti9BIik7\nCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgbG9uZyBlbnRyeUxvZ0lkID0gb2Zmc2V0ID4+IDMyTDsKICAg\nICAgICAgICAgICAgICAgICAgICAgbG9uZyBwb3MgPSBvZmZzZXQgJiAweGZm\nZmZmZmZmTDsKICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCJlbnRyeSAiICsgY3VyRW50cnkgKyAiXHQ6XHQobG9nOiIgKyBl\nbnRyeUxvZ0lkICsgIiwgcG9zOiAiICsgcG9zICsgIikiKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKytjdXJFbnRyeTsK\nICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjdXJTaXplICs9\nIHBhZ2VTaXplOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoSU9F\neGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJGYWlsZWQg\ndG8gcmVhZCBpbmRleCBwYWdlIDogIiwgaWUpOwogICAgICAgICAgICBpZiAo\nY3VyU2l6ZSArIHBhZ2VTaXplIDwgc2l6ZSkgewogICAgICAgICAgICAgICAg\nU3lzdGVtLm91dC5wcmludGxuKCJGYWlsZWQgdG8gcmVhZCBpbmRleCBwYWdl\nIEAgIiArIGN1clNpemUgKyAiLCB0aGUgaW5kZXggZmlsZSBtYXkgYmUgY29y\ncnVwdGVkIDogIiArIGllLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkZh\naWxlZCB0byByZWFkIGxhc3QgaW5kZXggcGFnZSBAICIgKyBjdXJTaXplCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiwgdGhlIGluZGV4\nIGZpbGUgbWF5IGJlIGNvcnJ1cHRlZCBvciBsYXN0IGluZGV4IHBhZ2UgaXMg\nbm90IGZ1bGx5IGZsdXNoZWQgeWV0IDogIiArIGllLmdldE1lc3NhZ2UoKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTY2FuIG92ZXIgYW4gZW50cnkgbG9nIGZpbGUuCiAgICAgKgogICAgICog\nQHBhcmFtIGxvZ0lkCiAgICAgKiAgICAgICAgICBFbnRyeSBMb2cgRmlsZSBp\nZC4KICAgICAqIEBwYXJhbSBwcmludE1zZwogICAgICogICAgICAgICAgV2hl\ndGhlciBwcmludGluZyB0aGUgZW50cnkgZGF0YS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgc2NhbkVudHJ5TG9nKGxvbmcgbG9nSWQsIGZpbmFsIGJv\nb2xlYW4gcHJpbnRNc2cpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigiU2NhbiBlbnRyeSBsb2cgIiArIGxvZ0lkICsg\nIiAoIiArIExvbmcudG9IZXhTdHJpbmcobG9nSWQpICsgIi5sb2cpIik7CiAg\nICAgICAgc2NhbkVudHJ5TG9nKGxvZ0lkLCBuZXcgRW50cnlMb2dTY2FubmVy\nKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGlj\nIGJvb2xlYW4gYWNjZXB0KGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKGxvbmcg\nbGVkZ2VySWQsIGxvbmcgc3RhcnRQb3MsIEJ5dGVCdWZmZXIgZW50cnkpIHsK\nICAgICAgICAgICAgICAgIGZvcm1hdEVudHJ5KHN0YXJ0UG9zLCBlbnRyeSwg\ncHJpbnRNc2cpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTY2FuIGEgam91cm5hbCBmaWxlCiAgICAgKgogICAg\nICogQHBhcmFtIGpvdXJuYWxJZAogICAgICogICAgICAgICAgSm91cm5hbCBG\naWxlIElkCiAgICAgKiBAcGFyYW0gcHJpbnRNc2cKICAgICAqICAgICAgICAg\nIFdoZXRoZXIgcHJpbnRpbmcgdGhlIGVudHJ5IGRhdGEuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHNjYW5Kb3VybmFsKGxvbmcgam91cm5hbElkLCBm\naW5hbCBib29sZWFuIHByaW50TXNnKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlNjYW4gam91cm5hbCAiICsgam91\ncm5hbElkICsgIiAoIiArIExvbmcudG9IZXhTdHJpbmcoam91cm5hbElkKSAr\nICIudHhuKSIpOwogICAgICAgIHNjYW5Kb3VybmFsKGpvdXJuYWxJZCwgbmV3\nIEpvdXJuYWxTY2FubmVyKCkgewogICAgICAgICAgICBib29sZWFuIHByaW50\nSm91cm5hbFZlcnNpb24gPSBmYWxzZTsKICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3MoaW50IGpvdXJuYWxW\nZXJzaW9uLCBsb25nIG9mZnNldCwgQnl0ZUJ1ZmZlciBlbnRyeSkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmICghcHJpbnRKb3Vy\nbmFsVmVyc2lvbikgewogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQu\ncHJpbnRsbigiSm91cm5hbCBWZXJzaW9uIDogIiArIGpvdXJuYWxWZXJzaW9u\nKTsKICAgICAgICAgICAgICAgICAgICBwcmludEpvdXJuYWxWZXJzaW9uID0g\ndHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvcm1h\ndEVudHJ5KG9mZnNldCwgZW50cnksIHByaW50TXNnKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogUHJpbnQgbGFz\ndCBsb2cgbWFyawogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwcmludExh\nc3RMb2dNYXJrKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBMb2dN\nYXJrIGxhc3RMb2dNYXJrID0gZ2V0Sm91cm5hbCgpLmdldExhc3RMb2dNYXJr\nKCkuZ2V0Q3VyTWFyaygpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigi\nTGFzdExvZ01hcms6IEpvdXJuYWwgSWQgLSAiICsgbGFzdExvZ01hcmsuZ2V0\nTG9nRmlsZUlkKCkgKyAiKCIKICAgICAgICAgICAgICAgICsgTG9uZy50b0hl\neFN0cmluZyhsYXN0TG9nTWFyay5nZXRMb2dGaWxlSWQoKSkgKyAiLnR4biks\nIFBvcyAtICIKICAgICAgICAgICAgICAgICsgbGFzdExvZ01hcmsuZ2V0TG9n\nRmlsZU9mZnNldCgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZvcm1hdCB0\naGUgbWVzc2FnZSBpbnRvIGEgcmVhZGFibGUgZm9ybWF0LgogICAgICoKICAg\nICAqIEBwYXJhbSBwb3MKICAgICAqICAgICAgICAgIEZpbGUgb2Zmc2V0IG9m\nIHRoZSBtZXNzYWdlIHN0b3JlZCBpbiBlbnRyeSBsb2cgZmlsZQogICAgICog\nQHBhcmFtIHJlY0J1ZmYKICAgICAqICAgICAgICAgIEVudHJ5IERhdGEKICAg\nICAqIEBwYXJhbSBwcmludE1zZwogICAgICogICAgICAgICAgV2hldGhlciBw\ncmludGluZyB0aGUgbWVzc2FnZSBib2R5CiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBmb3JtYXRFbnRyeShsb25nIHBvcywgQnl0ZUJ1ZmZlciByZWNCdWZm\nLCBib29sZWFuIHByaW50TXNnKSB7CiAgICAgICAgbG9uZyBsZWRnZXJJZCA9\nIHJlY0J1ZmYuZ2V0TG9uZygpOwogICAgICAgIGxvbmcgZW50cnlJZCA9IHJl\nY0J1ZmYuZ2V0TG9uZygpOwogICAgICAgIGludCBlbnRyeVNpemUgPSByZWNC\ndWZmLmxpbWl0KCk7CgogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiLS0t\nLS0tLS0tIExpZD0iICsgbGVkZ2VySWQgKyAiLCBFaWQ9IiArIGVudHJ5SWQK\nICAgICAgICAgICAgICAgICAgICAgICAgICsgIiwgQnl0ZU9mZnNldD0iICsg\ncG9zICsgIiwgRW50cnlTaXplPSIgKyBlbnRyeVNpemUgKyAiIC0tLS0tLS0t\nLSIpOwogICAgICAgIGlmIChlbnRyeUlkID09IEJvb2tpZS5NRVRBRU5UUllf\nSURfTEVER0VSX0tFWSkgewogICAgICAgICAgICBpbnQgbWFzdGVyS2V5TGVu\nID0gcmVjQnVmZi5nZXRJbnQoKTsKICAgICAgICAgICAgYnl0ZVtdIG1hc3Rl\ncktleSA9IG5ldyBieXRlW21hc3RlcktleUxlbl07CiAgICAgICAgICAgIHJl\nY0J1ZmYuZ2V0KG1hc3RlcktleSk7CiAgICAgICAgICAgIFN5c3RlbS5vdXQu\ncHJpbnRsbigiVHlwZTogICAgICAgICAgIE1FVEEiKTsKICAgICAgICAgICAg\nU3lzdGVtLm91dC5wcmludGxuKCJNYXN0ZXJLZXk6ICAgICAgIiArIGJ5dGVz\nMkhleChtYXN0ZXJLZXkpKTsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmlu\ndGxuKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAg\naWYgKGVudHJ5SWQgPT0gQm9va2llLk1FVEFFTlRSWV9JRF9GRU5DRV9LRVkp\nIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJUeXBlOiAgICAg\nICAgICAgTUVUQSIpOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nIkZlbmNlZCIpOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyBwcm9j\nZXNzIGEgZGF0YSBlbnRyeQogICAgICAgIGxvbmcgbGFzdEFkZENvbmZpcm1l\nZCA9IHJlY0J1ZmYuZ2V0TG9uZygpOwogICAgICAgIFN5c3RlbS5vdXQucHJp\nbnRsbigiVHlwZTogICAgICAgICAgIERBVEEiKTsKICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oIkxhc3RDb25maXJtZWQ6ICAiICsgbGFzdEFkZENvbmZp\ncm1lZCk7CiAgICAgICAgaWYgKCFwcmludE1zZykgewogICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KICAgICAgICAvLyBza2lwIGRpZ2VzdCBjaGVja2luZwogICAgICAg\nIHJlY0J1ZmYucG9zaXRpb24oMzIgKyA4KTsKICAgICAgICBTeXN0ZW0ub3V0\nLnByaW50bG4oIkRhdGE6Iik7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYnl0ZVtdIHJldCA9IG5l\ndyBieXRlW3JlY0J1ZmYucmVtYWluaW5nKCldOwogICAgICAgICAgICByZWNC\ndWZmLmdldChyZXQpOwogICAgICAgICAgICBmb3JtYXR0ZXIuZm9ybWF0RW50\ncnkocmV0KTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk4vQS4gQ29ycnVwdGVkLiIp\nOwogICAgICAgIH0KICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oKTsKICAg\nIH0KCiAgICBzdGF0aWMgU3RyaW5nIGJ5dGVzMkhleChieXRlW10gZGF0YSkg\newogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRl\ncihkYXRhLmxlbmd0aCAqIDIpOwogICAgICAgIEZvcm1hdHRlciBmb3JtYXR0\nZXIgPSBuZXcgRm9ybWF0dGVyKHNiKTsKICAgICAgICBmb3IgKGJ5dGUgYiA6\nIGRhdGEpIHsKICAgICAgICAgICAgZm9ybWF0dGVyLmZvcm1hdCgiJTAyeCIs\nIGIpOwogICAgICAgIH0KICAgICAgICBmb3JtYXR0ZXIuY2xvc2UoKTsKICAg\nICAgICByZXR1cm4gc2IudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwcml2YXRl\nIHN0YXRpYyBpbnQgZ2V0T3B0aW9uSW50VmFsdWUoQ29tbWFuZExpbmUgY21k\nTGluZSwgU3RyaW5nIG9wdGlvbiwgaW50IGRlZmF1bHRWYWwpIHsKICAgICAg\nICBpZiAoY21kTGluZS5oYXNPcHRpb24ob3B0aW9uKSkgewogICAgICAgICAg\nICBTdHJpbmcgdmFsID0gY21kTGluZS5nZXRPcHRpb25WYWx1ZShvcHRpb24p\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIElu\ndGVnZXIucGFyc2VJbnQodmFsKTsKICAgICAgICAgICAgfSBjYXRjaCAoTnVt\nYmVyRm9ybWF0RXhjZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgU3lz\ndGVtLmVyci5wcmludGxuKCJFUlJPUjogaW52YWxpZCB2YWx1ZSBmb3Igb3B0\naW9uICIgKyBvcHRpb24gKyAiIDogIiArIHZhbCk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gZGVmYXVsdFZhbDsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICByZXR1cm4gZGVmYXVsdFZhbDsKICAgIH0KCiAgICBwcml2YXRl\nIHN0YXRpYyBsb25nIGdldE9wdGlvbkxvbmdWYWx1ZShDb21tYW5kTGluZSBj\nbWRMaW5lLCBTdHJpbmcgb3B0aW9uLCBsb25nIGRlZmF1bHRWYWwpIHsKICAg\nICAgICBpZiAoY21kTGluZS5oYXNPcHRpb24ob3B0aW9uKSkgewogICAgICAg\nICAgICBTdHJpbmcgdmFsID0gY21kTGluZS5nZXRPcHRpb25WYWx1ZShvcHRp\nb24pOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJu\nIExvbmcucGFyc2VMb25nKHZhbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE51\nbWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgICAgIFN5\nc3RlbS5lcnIucHJpbnRsbigiRVJST1I6IGludmFsaWQgdmFsdWUgZm9yIG9w\ndGlvbiAiICsgb3B0aW9uICsgIiA6ICIgKyB2YWwpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIGRlZmF1bHRWYWw7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWw7CiAgICB9Cn0K\n","encoding":"base64"}

