{"sha":"0114043d47e9ce1f642e43606eb3e9f0c8646fee","node_id":"MDQ6QmxvYjE1NzU5NTY6MDExNDA0M2Q0N2U5Y2UxZjY0MmU0MzYwNmViM2U5ZjBjODY0NmZlZQ==","size":4145,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0114043d47e9ce1f642e43606eb3e9f0c8646fee","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwoKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLm5pby5CeXRlQnVmZmVyOwppbXBvcnQgamF2YS5uaW8uY2hhbm5l\nbHMuRmlsZUNoYW5uZWw7CgovKioKICogQSBCdWZmZXJlZCBjaGFubmVsIHdp\ndGhvdXQgYSB3cml0ZSBidWZmZXIuIE9ubHkgcmVhZHMgYXJlIGJ1ZmZlcmVk\nLgogKi8KcHVibGljIGNsYXNzIEJ1ZmZlcmVkUmVhZENoYW5uZWwgZXh0ZW5k\ncyBCdWZmZXJlZENoYW5uZWxCYXNlIHsKICAgIHByaXZhdGUgc3RhdGljIExv\nZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihCdWZmZXJlZFJl\nYWRDaGFubmVsLmNsYXNzKTsKICAgIC8vIFRoZSBjYXBhY2l0eSBvZiB0aGUg\ncmVhZCBidWZmZXIuCiAgICBwcm90ZWN0ZWQgZmluYWwgaW50IHJlYWRDYXBh\nY2l0eTsKICAgIC8vIFRoZSBidWZmZXIgZm9yIHJlYWQgb3BlcmF0aW9ucy4K\nICAgIHByb3RlY3RlZCBCeXRlQnVmZmVyIHJlYWRCdWZmZXI7CiAgICAvLyBU\naGUgc3RhcnRpbmcgcG9zaXRpb24gb2YgdGhlIGRhdGEgY3VycmVudGx5IGlu\nIHRoZSByZWFkIGJ1ZmZlci4KICAgIHByb3RlY3RlZCBsb25nIHJlYWRCdWZm\nZXJTdGFydFBvc2l0aW9uID0gTG9uZy5NSU5fVkFMVUU7CgogICAgbG9uZyBp\nbnZvY2F0aW9uQ291bnQgPSAwOwogICAgbG9uZyBjYWNoZUhpdENvdW50ID0g\nMDsKCiAgICBwdWJsaWMgQnVmZmVyZWRSZWFkQ2hhbm5lbChGaWxlQ2hhbm5l\nbCBmaWxlQ2hhbm5lbCwgaW50IHJlYWRDYXBhY2l0eSkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBzdXBlcihmaWxlQ2hhbm5lbCk7CiAgICAgICAg\ndGhpcy5yZWFkQ2FwYWNpdHkgPSByZWFkQ2FwYWNpdHk7CiAgICAgICAgdGhp\ncy5yZWFkQnVmZmVyID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZURpcmVjdChyZWFk\nQ2FwYWNpdHkpOwogICAgICAgIHRoaXMucmVhZEJ1ZmZlci5saW1pdCgwKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJlYWQgYXMgbWFueSBieXRlcyBpbnRv\nIGRlc3QgYXMgZGVzdC5jYXBhY2l0eSgpIHN0YXJ0aW5nIGF0IHBvc2l0aW9u\nIHBvcyBpbiB0aGUKICAgICAqIEZpbGVDaGFubmVsLiBUaGlzIGZ1bmN0aW9u\nIGNhbiByZWFkIGZyb20gdGhlIGJ1ZmZlciBvciB0aGUgZmlsZSBjaGFubmVs\nCiAgICAgKiBkZXBlbmRpbmcgb24gdGhlIGltcGxlbWVudGF0aW9uLi4KICAg\nICAqIEBwYXJhbSBkZXN0CiAgICAgKiBAcGFyYW0gcG9zCiAgICAgKiBAcmV0\ndXJuIFRoZSB0b3RhbCBudW1iZXIgb2YgYnl0ZXMgcmVhZC4gLTEgaWYgdGhl\nIGdpdmVuIHBvc2l0aW9uIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0\naGUgZmlsZSdzIGN1cnJlbnQgc2l6ZS4KICAgICAqIEB0aHJvd3MgSU9FeGNl\ncHRpb24gaWYgSS9PIGVycm9yIG9jY3VycwogICAgICovCiAgICBzeW5jaHJv\nbml6ZWQgcHVibGljIGludCByZWFkKEJ5dGVCdWZmZXIgZGVzdCwgbG9uZyBw\nb3MpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaW52b2NhdGlvbkNv\ndW50Kys7CiAgICAgICAgbG9uZyBjdXJyZW50UG9zaXRpb24gPSBwb3M7CiAg\nICAgICAgbG9uZyBlb2YgPSB2YWxpZGF0ZUFuZEdldEZpbGVDaGFubmVsKCku\nc2l6ZSgpOwogICAgICAgIC8vIHJldHVybiAtMSBpZiB0aGUgZ2l2ZW4gcG9z\naXRpb24gaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHRoZSBmaWxlJ3Mg\nY3VycmVudCBzaXplLgogICAgICAgIGlmIChwb3MgPj0gZW9mKSB7CiAgICAg\nICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgd2hpbGUgKGRl\nc3QucmVtYWluaW5nKCkgPiAwKSB7CiAgICAgICAgICAgIC8vIENoZWNrIGlm\nIHRoZSBkYXRhIGlzIGluIHRoZSBidWZmZXIsIGlmIHNvLCBjb3B5IGl0Lgog\nICAgICAgICAgICBpZiAocmVhZEJ1ZmZlclN0YXJ0UG9zaXRpb24gPD0gY3Vy\ncmVudFBvc2l0aW9uICYmIGN1cnJlbnRQb3NpdGlvbiA8IHJlYWRCdWZmZXJT\ndGFydFBvc2l0aW9uICsgcmVhZEJ1ZmZlci5saW1pdCgpKSB7CiAgICAgICAg\nICAgICAgICBsb25nIHBvc0luQnVmZmVyID0gY3VycmVudFBvc2l0aW9uIC0g\ncmVhZEJ1ZmZlclN0YXJ0UG9zaXRpb247CiAgICAgICAgICAgICAgICBsb25n\nIGJ5dGVzVG9Db3B5ID0gTWF0aC5taW4oZGVzdC5yZW1haW5pbmcoKSwgcmVh\nZEJ1ZmZlci5saW1pdCgpIC0gcG9zSW5CdWZmZXIpOwogICAgICAgICAgICAg\nICAgQnl0ZUJ1ZmZlciByYkR1cCA9IHJlYWRCdWZmZXIuZHVwbGljYXRlKCk7\nCiAgICAgICAgICAgICAgICByYkR1cC5wb3NpdGlvbigoaW50KXBvc0luQnVm\nZmVyKTsKICAgICAgICAgICAgICAgIHJiRHVwLmxpbWl0KChpbnQpKHBvc0lu\nQnVmZmVyICsgYnl0ZXNUb0NvcHkpKTsKICAgICAgICAgICAgICAgIGRlc3Qu\ncHV0KHJiRHVwKTsKICAgICAgICAgICAgICAgIGN1cnJlbnRQb3NpdGlvbiAr\nPSBieXRlc1RvQ29weTsKICAgICAgICAgICAgICAgIGNhY2hlSGl0Q291bnQr\nKzsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50UG9zaXRpb24gPj0g\nZW9mKSB7CiAgICAgICAgICAgICAgICAvLyBoZXJlIHdlIHJlYWNoZWQgZW9m\nLgogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCBoYXZlIGl0IGluIHRoZSBi\ndWZmZXIsIHNvIHB1dCBuZWNlc3NhcnkgZGF0YSBpbiB0aGUgYnVmZmVyCiAg\nICAgICAgICAgICAgICByZWFkQnVmZmVyLmNsZWFyKCk7CiAgICAgICAgICAg\nICAgICByZWFkQnVmZmVyU3RhcnRQb3NpdGlvbiA9IGN1cnJlbnRQb3NpdGlv\nbjsKICAgICAgICAgICAgICAgIGludCByZWFkQnl0ZXMgPSAwOwogICAgICAg\nICAgICAgICAgaWYgKChyZWFkQnl0ZXMgPSB2YWxpZGF0ZUFuZEdldEZpbGVD\naGFubmVsKCkucmVhZChyZWFkQnVmZmVyLCBjdXJyZW50UG9zaXRpb24pKSA8\nPSAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0\naW9uKCJSZWFkaW5nIGZyb20gZmlsZWNoYW5uZWwgcmV0dXJuZWQgYSBub24t\ncG9zaXRpdmUgdmFsdWUuIFNob3J0IHJlYWQuIik7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICByZWFkQnVmZmVyLmxpbWl0KHJlYWRCeXRl\ncyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIChp\nbnQpKGN1cnJlbnRQb3NpdGlvbiAtIHBvcyk7CiAgICB9CgogICAgc3luY2hy\nb25pemVkIHB1YmxpYyB2b2lkIGNsZWFyKCkgewogICAgICAgIHJlYWRCdWZm\nZXIuY2xlYXIoKTsKICAgICAgICByZWFkQnVmZmVyLmxpbWl0KDApOwogICAg\nfQoKfQo=\n","encoding":"base64"}

