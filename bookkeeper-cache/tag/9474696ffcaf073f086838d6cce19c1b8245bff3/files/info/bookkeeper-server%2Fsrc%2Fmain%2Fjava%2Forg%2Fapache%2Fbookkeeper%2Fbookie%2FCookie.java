{"sha":"9e77029e46622b0611a896b48375f6279b14d73a","node_id":"MDQ6QmxvYjE1NzU5NTY6OWU3NzAyOWU0NjYyMmIwNjExYTg5NmI0ODM3NWY2Mjc5YjE0ZDczYQ==","size":15821,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/9e77029e46622b0611a896b48375f6279b14d73a","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgc3RhdGljIGNvbS5nb29nbGUuY29tbW9uLmJhc2UuQ2hhcnNldHMu\nVVRGXzg7CgppbXBvcnQgamF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0\nIGphdmEuaW8uQnVmZmVyZWRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLkVPRkV4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8u\nRmlsZUlucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5GaWxlT3V0cHV0U3Ry\nZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\naW8uSW5wdXRTdHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0\ncmVhbVdyaXRlcjsKaW1wb3J0IGphdmEuaW8uU3RyaW5nUmVhZGVyOwppbXBv\ncnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLm5l\ndC5Vbmtub3duSG9zdEV4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuWmtWZXJzaW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkRhdGFGb3JtYXRzLkNvb2tpZUZv\ncm1hdDsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLkJvb2tL\nZWVwZXJDb25zdGFudHM7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ndmVyc2lvbmluZy5WZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnZlcnNpb25pbmcuVmVyc2lvbmVkOwppbXBvcnQgb3JnLmFwYWNoZS56\nb29rZWVwZXIuQ3JlYXRlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2Vl\ncGVyLlpvb0RlZnMuSWRzOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nWm9vS2VlcGVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuZGF0YS5T\ndGF0OwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0\nai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYu\nVGV4dEZvcm1hdDsKCi8qKgogKiBXaGVuIGEgYm9va2llIHN0YXJ0cyBmb3Ig\ndGhlIGZpcnN0IHRpbWUgaXQgZ2VuZXJhdGVzICBhIGNvb2tpZSwgYW5kIHN0\nb3JlcwogKiB0aGUgY29va2llIGluIHpvb2tlZXBlciBhcyB3ZWxsIGFzIGlu\nIHRoZSBlYWNoIG9mIHRoZSBsb2NhbCBmaWxlc3lzdGVtCiAqIGRpcmVjdG9y\naWVzIGl0IHVzZXMuIFRoaXMgY29va2llIGlzIHVzZWQgdG8gZW5zdXJlIHRo\nYXQgZm9yIHRoZSBsaWZlIG9mIHRoZQogKiBib29raWUsIGl0cyBjb25maWd1\ncmF0aW9uIHN0YXlzIHRoZSBzYW1lLiBJZiBhbnkgb2YgdGhlIGJvb2tpZSBk\naXJlY3RvcmllcwogKiBiZWNvbWVzIHVuYXZhaWxhYmxlLCB0aGUgYm9va2ll\nIGJlY29tZXMgdW5hdmFpbGFibGUuIElmIHRoZSBib29raWUgY2hhbmdlcwog\nKiBwb3J0LCBpdCBtdXN0IGFsc28gcmVzZXQgYWxsIG9mIGl0cyBkYXRhLgog\nKgogKiBUaGlzIGlzIGRvbmUgdG8gZW5zdXJlIGRhdGEgaW50ZWdyaXR5LiBX\naXRob3V0IHRoZSBjb29raWUgYSBib29raWUgY291bGQKICogc3RhcnQgd2l0\naCBvbmUgb2YgaXRzIGxlZGdlciBkaXJlY3RvcmllcyBtaXNzaW5nLCBzbyBk\nYXRhIHdvdWxkIGJlIG1pc3NpbmcsCiAqIGJ1dCB0aGUgYm9va2llIHdvdWxk\nIGJlIHVwLCBzbyB0aGUgY2xpZW50IHdvdWxkIHRoaW5rIHRoYXQgZXZlcnl0\naGluZyBpcyBvawogKiB3aXRoIHRoZSBjbHVzdGVyLiBJdCdzIGJldHRlciB0\nbyBmYWlsIGVhcmx5IGFuZCBvYnZpb3VzbHkuCiAqLwpjbGFzcyBDb29raWUg\newogICAgcHJpdmF0ZSBmaW5hbCBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dl\nckZhY3RvcnkuZ2V0TG9nZ2VyKENvb2tpZS5jbGFzcyk7CgogICAgc3RhdGlj\nIGZpbmFsIGludCBDVVJSRU5UX0NPT0tJRV9MQVlPVVRfVkVSU0lPTiA9IDQ7\nCiAgICBwcml2YXRlIGZpbmFsIGludCBsYXlvdXRWZXJzaW9uOwogICAgcHJp\ndmF0ZSBmaW5hbCBTdHJpbmcgYm9va2llSG9zdDsKICAgIHByaXZhdGUgZmlu\nYWwgU3RyaW5nIGpvdXJuYWxEaXI7CiAgICBwcml2YXRlIGZpbmFsIFN0cmlu\nZyBsZWRnZXJEaXJzOwogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgaW5zdGFu\nY2VJZDsKCiAgICBwcml2YXRlIENvb2tpZShpbnQgbGF5b3V0VmVyc2lvbiwg\nU3RyaW5nIGJvb2tpZUhvc3QsIFN0cmluZyBqb3VybmFsRGlyLCBTdHJpbmcg\nbGVkZ2VyRGlycywgU3RyaW5nIGluc3RhbmNlSWQpIHsKICAgICAgICB0aGlz\nLmxheW91dFZlcnNpb24gPSBsYXlvdXRWZXJzaW9uOwogICAgICAgIHRoaXMu\nYm9va2llSG9zdCA9IGJvb2tpZUhvc3Q7CiAgICAgICAgdGhpcy5qb3VybmFs\nRGlyID0gam91cm5hbERpcjsKICAgICAgICB0aGlzLmxlZGdlckRpcnMgPSBs\nZWRnZXJEaXJzOwogICAgICAgIHRoaXMuaW5zdGFuY2VJZCA9IGluc3RhbmNl\nSWQ7CiAgICB9CgogICAgcHVibGljIHZvaWQgdmVyaWZ5KENvb2tpZSBjKSB0\naHJvd3MgQm9va2llRXhjZXB0aW9uLkludmFsaWRDb29raWVFeGNlcHRpb24g\newogICAgICAgIFN0cmluZyBlcnJNc2c7CiAgICAgICAgaWYgKGMubGF5b3V0\nVmVyc2lvbiA8IDMgJiYgYy5sYXlvdXRWZXJzaW9uICE9IGxheW91dFZlcnNp\nb24pIHsKICAgICAgICAgICAgZXJyTXNnID0gIkNvb2tpZSBpcyBvZiB0b28g\nb2xkIHZlcnNpb24gIiArIGMubGF5b3V0VmVyc2lvbjsKICAgICAgICAgICAg\nTE9HLmVycm9yKGVyck1zZyk7CiAgICAgICAgICAgIHRocm93IG5ldyBCb29r\naWVFeGNlcHRpb24uSW52YWxpZENvb2tpZUV4Y2VwdGlvbihlcnJNc2cpOwog\nICAgICAgIH0gZWxzZSBpZiAoIShjLmxheW91dFZlcnNpb24gPj0gMyAmJiBj\nLmJvb2tpZUhvc3QuZXF1YWxzKGJvb2tpZUhvc3QpCiAgICAgICAgICAgICAg\nICAmJiBjLmpvdXJuYWxEaXIuZXF1YWxzKGpvdXJuYWxEaXIpICYmIGMubGVk\nZ2VyRGlycwogICAgICAgICAgICAgICAgICAgIC5lcXVhbHMobGVkZ2VyRGly\ncykpKSB7CiAgICAgICAgICAgIGVyck1zZyA9ICJDb29raWUgWyIgKyB0aGlz\nICsgIl0gaXMgbm90IG1hdGNoaW5nIHdpdGggWyIgKyBjICsgIl0iOwogICAg\nICAgICAgICB0aHJvdyBuZXcgQm9va2llRXhjZXB0aW9uLkludmFsaWRDb29r\naWVFeGNlcHRpb24oZXJyTXNnKTsKICAgICAgICB9IGVsc2UgaWYgKChpbnN0\nYW5jZUlkID09IG51bGwgJiYgYy5pbnN0YW5jZUlkICE9IG51bGwpCiAgICAg\nICAgICAgICAgICB8fCAoaW5zdGFuY2VJZCAhPSBudWxsICYmICFpbnN0YW5j\nZUlkLmVxdWFscyhjLmluc3RhbmNlSWQpKSkgewogICAgICAgICAgICAvLyBp\nbnN0YW5jZUlkIHNob3VsZCBiZSBzYW1lIGluIGJvdGggY29va2llcwogICAg\nICAgICAgICBlcnJNc2cgPSAiaW5zdGFuY2VJZCAiICsgaW5zdGFuY2VJZAog\nICAgICAgICAgICAgICAgICAgICsgIiBpcyBub3QgbWF0Y2hpbmcgd2l0aCAi\nICsgYy5pbnN0YW5jZUlkOwogICAgICAgICAgICB0aHJvdyBuZXcgQm9va2ll\nRXhjZXB0aW9uLkludmFsaWRDb29raWVFeGNlcHRpb24oZXJyTXNnKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsK\nICAgICAgICBpZiAobGF5b3V0VmVyc2lvbiA8PSAzKSB7CiAgICAgICAgICAg\nIHJldHVybiB0b1N0cmluZ1ZlcnNpb24zKCk7CiAgICAgICAgfQogICAgICAg\nIENvb2tpZUZvcm1hdC5CdWlsZGVyIGJ1aWxkZXIgPSBDb29raWVGb3JtYXQu\nbmV3QnVpbGRlcigpOwogICAgICAgIGJ1aWxkZXIuc2V0Qm9va2llSG9zdChi\nb29raWVIb3N0KTsKICAgICAgICBidWlsZGVyLnNldEpvdXJuYWxEaXIoam91\ncm5hbERpcik7CiAgICAgICAgYnVpbGRlci5zZXRMZWRnZXJEaXJzKGxlZGdl\nckRpcnMpOwogICAgICAgIGlmIChudWxsICE9IGluc3RhbmNlSWQpIHsKICAg\nICAgICAgICAgYnVpbGRlci5zZXRJbnN0YW5jZUlkKGluc3RhbmNlSWQpOwog\nICAgICAgIH0KICAgICAgICBTdHJpbmdCdWlsZGVyIGIgPSBuZXcgU3RyaW5n\nQnVpbGRlcigpOwogICAgICAgIGIuYXBwZW5kKENVUlJFTlRfQ09PS0lFX0xB\nWU9VVF9WRVJTSU9OKS5hcHBlbmQoIlxuIik7CiAgICAgICAgYi5hcHBlbmQo\nVGV4dEZvcm1hdC5wcmludFRvU3RyaW5nKGJ1aWxkZXIuYnVpbGQoKSkpOwog\nICAgICAgIHJldHVybiBiLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHJpdmF0\nZSBTdHJpbmcgdG9TdHJpbmdWZXJzaW9uMygpIHsKICAgICAgICBTdHJpbmdC\ndWlsZGVyIGIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIGIuYXBw\nZW5kKENVUlJFTlRfQ09PS0lFX0xBWU9VVF9WRVJTSU9OKS5hcHBlbmQoIlxu\nIikKICAgICAgICAgICAgLmFwcGVuZChib29raWVIb3N0KS5hcHBlbmQoIlxu\nIikKICAgICAgICAgICAgLmFwcGVuZChqb3VybmFsRGlyKS5hcHBlbmQoIlxu\nIikKICAgICAgICAgICAgLmFwcGVuZChsZWRnZXJEaXJzKS5hcHBlbmQoIlxu\nIik7CiAgICAgICAgcmV0dXJuIGIudG9TdHJpbmcoKTsKICAgIH0KCiAgICBw\ncml2YXRlIHN0YXRpYyBCdWlsZGVyIHBhcnNlKEJ1ZmZlcmVkUmVhZGVyIHJl\nYWRlcikgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBCdWlsZGVyIGNC\ndWlsZGVyID0gQ29va2llLm5ld0J1aWxkZXIoKTsKICAgICAgICBpbnQgbGF5\nb3V0VmVyc2lvbiA9IDA7CiAgICAgICAgU3RyaW5nIGxpbmUgPSByZWFkZXIu\ncmVhZExpbmUoKTsKICAgICAgICBpZiAobnVsbCA9PSBsaW5lKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBFT0ZFeGNlcHRpb24oIkV4Y2VwdGlvbiBpbiBw\nYXJzaW5nIGNvb2tpZSIpOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAg\nICAgICAgICBsYXlvdXRWZXJzaW9uID0gSW50ZWdlci5wYXJzZUludChsaW5l\nLnRyaW0oKSk7CiAgICAgICAgICAgIGNCdWlsZGVyLnNldExheW91dFZlcnNp\nb24obGF5b3V0VmVyc2lvbik7CiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9y\nbWF0RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhj\nZXB0aW9uKCJJbnZhbGlkIHN0cmluZyAnIiArIGxpbmUudHJpbSgpCiAgICAg\nICAgICAgICAgICAgICAgKyAiJywgY2Fubm90IHBhcnNlIGNvb2tpZS4iKTsK\nICAgICAgICB9CiAgICAgICAgaWYgKGxheW91dFZlcnNpb24gPT0gMykgewog\nICAgICAgICAgICBjQnVpbGRlci5zZXRCb29raWVIb3N0KHJlYWRlci5yZWFk\nTGluZSgpKTsKICAgICAgICAgICAgY0J1aWxkZXIuc2V0Sm91cm5hbERpcihy\nZWFkZXIucmVhZExpbmUoKSk7CiAgICAgICAgICAgIGNCdWlsZGVyLnNldExl\nZGdlckRpcnMocmVhZGVyLnJlYWRMaW5lKCkpOwogICAgICAgIH0gZWxzZSBp\nZiAobGF5b3V0VmVyc2lvbiA+PSA0KSB7CiAgICAgICAgICAgIENvb2tpZUZv\ncm1hdC5CdWlsZGVyIGNmQnVpbGRlciA9IENvb2tpZUZvcm1hdC5uZXdCdWls\nZGVyKCk7CiAgICAgICAgICAgIFRleHRGb3JtYXQubWVyZ2UocmVhZGVyLCBj\nZkJ1aWxkZXIpOwogICAgICAgICAgICBDb29raWVGb3JtYXQgZGF0YSA9IGNm\nQnVpbGRlci5idWlsZCgpOwogICAgICAgICAgICBjQnVpbGRlci5zZXRCb29r\naWVIb3N0KGRhdGEuZ2V0Qm9va2llSG9zdCgpKTsKICAgICAgICAgICAgY0J1\naWxkZXIuc2V0Sm91cm5hbERpcihkYXRhLmdldEpvdXJuYWxEaXIoKSk7CiAg\nICAgICAgICAgIGNCdWlsZGVyLnNldExlZGdlckRpcnMoZGF0YS5nZXRMZWRn\nZXJEaXJzKCkpOwogICAgICAgICAgICAvLyBTaW5jZSBJbnN0YW5jZUlkIGlz\nIG9wdGlvbmFsCiAgICAgICAgICAgIGlmIChudWxsICE9IGRhdGEuZ2V0SW5z\ndGFuY2VJZCgpICYmICFkYXRhLmdldEluc3RhbmNlSWQoKS5pc0VtcHR5KCkp\nIHsKICAgICAgICAgICAgICAgIGNCdWlsZGVyLnNldEluc3RhbmNlSWQoZGF0\nYS5nZXRJbnN0YW5jZUlkKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBjQnVpbGRlcjsKICAgIH0KCiAgICB2b2lkIHdyaXRl\nVG9EaXJlY3RvcnkoRmlsZSBkaXJlY3RvcnkpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgRmlsZSB2ZXJzaW9uRmlsZSA9IG5ldyBGaWxlKGRpcmVj\ndG9yeSwKICAgICAgICAgICAgICAgIEJvb2tLZWVwZXJDb25zdGFudHMuVkVS\nU0lPTl9GSUxFTkFNRSk7CgogICAgICAgIEZpbGVPdXRwdXRTdHJlYW0gZm9z\nID0gbmV3IEZpbGVPdXRwdXRTdHJlYW0odmVyc2lvbkZpbGUpOwogICAgICAg\nIEJ1ZmZlcmVkV3JpdGVyIGJ3ID0gbnVsbDsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBidyA9IG5ldyBCdWZmZXJlZFdyaXRlcihuZXcgT3V0cHV0U3Ry\nZWFtV3JpdGVyKGZvcywgVVRGXzgpKTsKICAgICAgICAgICAgYncud3JpdGUo\ndG9TdHJpbmcoKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\naWYgKGJ3ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGJ3LmNsb3NlKCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9zLmNsb3NlKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogV3JpdGVzIGNvb2tpZSBkZXRh\naWxzIHRvIFpvb0tlZXBlcgogICAgICoKICAgICAqIEBwYXJhbSB6awogICAg\nICogICAgICAgICAgICBab29LZWVwZXIgaW5zdGFuY2UKICAgICAqIEBwYXJh\nbSBjb25mCiAgICAgKiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24KICAgICAq\nIEBwYXJhbSB2ZXJzaW9uCiAgICAgKiAgICAgICAgICAgIHZlcnNpb24KICAg\nICAqCiAgICAgKiBAdGhyb3dzIEtlZXBlckV4Y2VwdGlvbgogICAgICogQHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBVbmtu\nb3duSG9zdEV4Y2VwdGlvbgogICAgICovCiAgICB2b2lkIHdyaXRlVG9ab29L\nZWVwZXIoWm9vS2VlcGVyIHprLCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYs\nIFZlcnNpb24gdmVyc2lvbikKICAgICAgICAgICAgdGhyb3dzIEtlZXBlckV4\nY2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sIFVua25vd25Ib3N0RXhj\nZXB0aW9uIHsKICAgICAgICBTdHJpbmcgYm9va2llQ29va2llUGF0aCA9IGNv\nbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgoKSArICIvIgogICAgICAgICAgICAg\nICAgKyBCb29rS2VlcGVyQ29uc3RhbnRzLkNPT0tJRV9OT0RFOwogICAgICAg\nIFN0cmluZyB6a1BhdGggPSBnZXRaa1BhdGgoY29uZik7CiAgICAgICAgYnl0\nZVtdIGRhdGEgPSB0b1N0cmluZygpLmdldEJ5dGVzKFVURl84KTsKICAgICAg\nICBpZiAoVmVyc2lvbi5ORVcgPT0gdmVyc2lvbikgewogICAgICAgICAgICBp\nZiAoemsuZXhpc3RzKGJvb2tpZUNvb2tpZVBhdGgsIGZhbHNlKSA9PSBudWxs\nKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIHprLmNyZWF0ZShib29raWVDb29raWVQYXRoLCBuZXcgYnl0ZVswXSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUs\nIENyZWF0ZU1vZGUuUEVSU0lTVEVOVCk7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChLZWVwZXJFeGNlcHRpb24uTm9kZUV4aXN0c0V4Y2VwdGlvbiBubmUp\nIHsKICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiTW9yZSB0aGFuIG9u\nZSBib29raWUgdHJpZWQgdG8gY3JlYXRlIHt9IGF0IG9uY2UuIFNhZmUgdG8g\naWdub3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2tpZUNv\nb2tpZVBhdGgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHprLmNyZWF0ZSh6a1BhdGgsIGRhdGEsCiAgICAgICAgICAg\nICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJT\nSVNURU5UKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoISh2\nZXJzaW9uIGluc3RhbmNlb2YgWmtWZXJzaW9uKSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSW52YWxp\nZCB2ZXJzaW9uIHR5cGUsIGV4cGVjdGVkIFprVmVyc2lvbiB0eXBlIik7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgemsuc2V0RGF0YSh6a1BhdGgsIGRh\ndGEsICgoWmtWZXJzaW9uKSB2ZXJzaW9uKS5nZXRabm9kZVZlcnNpb24oKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRGVsZXRlcyBjb29r\naWUgZnJvbSBab29LZWVwZXIgYW5kIHNldHMgem5vZGUgdmVyc2lvbiB0byBE\nRUZBVUxUX0NPT0tJRV9aTk9ERV9WRVJTSU9OCiAgICAgKgogICAgICogQHBh\ncmFtIHprCiAgICAgKiAgICAgICAgICAgIFpvb0tlZXBlciBpbnN0YW5jZQog\nICAgICogQHBhcmFtIGNvbmYKICAgICAqICAgICAgICAgICAgY29uZmlndXJh\ndGlvbgogICAgICogQHBhcmFtIHZlcnNpb24KICAgICAqICAgICAgICAgICAg\nem9va2VlcGVyIHZlcnNpb24KICAgICAqCiAgICAgKiBAdGhyb3dzIEtlZXBl\nckV4Y2VwdGlvbgogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbgogICAgICogQHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlvbgogICAgICov\nCiAgICB2b2lkIGRlbGV0ZUZyb21ab29LZWVwZXIoWm9vS2VlcGVyIHprLCBT\nZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYsIFZlcnNpb24gdmVyc2lvbikgdGhy\nb3dzIEtlZXBlckV4Y2VwdGlvbiwKICAgICAgICAgICAgSW50ZXJydXB0ZWRF\neGNlcHRpb24sIFVua25vd25Ib3N0RXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nISh2ZXJzaW9uIGluc3RhbmNlb2YgWmtWZXJzaW9uKSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZhbGlk\nIHZlcnNpb24gdHlwZSwgZXhwZWN0ZWQgWmtWZXJzaW9uIHR5cGUiKTsKICAg\nICAgICB9CiAgICAgICAgU3RyaW5nIHprUGF0aCA9IGdldFprUGF0aChjb25m\nKTsKICAgICAgICB6ay5kZWxldGUoemtQYXRoLCAoKFprVmVyc2lvbil2ZXJz\naW9uKS5nZXRabm9kZVZlcnNpb24oKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBHZW5lcmF0ZSBjb29raWUgZnJvbSB0aGUgZ2l2ZW4gY29uZmlndXJhdGlv\nbgogICAgICoKICAgICAqIEBwYXJhbSBjb25mCiAgICAgKiAgICAgICAgICAg\nIGNvbmZpZ3VyYXRpb24KICAgICAqCiAgICAgKiBAcmV0dXJuIGNvb2tpZSBi\ndWlsZGVyIG9iamVjdAogICAgICoKICAgICAqIEB0aHJvd3MgVW5rbm93bkhv\nc3RFeGNlcHRpb24KICAgICAqLwogICAgc3RhdGljIEJ1aWxkZXIgZ2VuZXJh\ndGVDb29raWUoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mKQogICAgICAgICAg\nICB0aHJvd3MgVW5rbm93bkhvc3RFeGNlcHRpb24gewogICAgICAgIFN0cmlu\nZ0J1aWxkZXIgYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgU3Ry\naW5nW10gZGlycyA9IGNvbmYuZ2V0TGVkZ2VyRGlyTmFtZXMoKTsKICAgICAg\nICBiLmFwcGVuZChkaXJzLmxlbmd0aCk7CiAgICAgICAgZm9yIChTdHJpbmcg\nZCA6IGRpcnMpIHsKICAgICAgICAgICAgYi5hcHBlbmQoIlx0IikuYXBwZW5k\nKGQpOwogICAgICAgIH0KICAgICAgICBCdWlsZGVyIGJ1aWxkZXIgPSBDb29r\naWUubmV3QnVpbGRlcigpOwogICAgICAgIGJ1aWxkZXIuc2V0TGF5b3V0VmVy\nc2lvbihDVVJSRU5UX0NPT0tJRV9MQVlPVVRfVkVSU0lPTik7CiAgICAgICAg\nYnVpbGRlci5zZXRCb29raWVIb3N0KEJvb2tpZS5nZXRCb29raWVBZGRyZXNz\nKGNvbmYpLnRvU3RyaW5nKCkpOwogICAgICAgIGJ1aWxkZXIuc2V0Sm91cm5h\nbERpcihjb25mLmdldEpvdXJuYWxEaXJOYW1lKCkpOwogICAgICAgIGJ1aWxk\nZXIuc2V0TGVkZ2VyRGlycyhiLnRvU3RyaW5nKCkpOwogICAgICAgIHJldHVy\nbiBidWlsZGVyOwogICAgfQoKICAgIC8qKgogICAgICogUmVhZCBjb29raWUg\nZnJvbSBab29LZWVwZXIuCiAgICAgKgogICAgICogQHBhcmFtIHprCiAgICAg\nKiAgICAgICAgICAgIFpvb0tlZXBlciBpbnN0YW5jZQogICAgICogQHBhcmFt\nIGNvbmYKICAgICAqICAgICAgICAgICAgY29uZmlndXJhdGlvbgogICAgICoK\nICAgICAqIEByZXR1cm4gdmVyc2lvbmVkIGNvb2tpZSBvYmplY3QKICAgICAq\nCiAgICAgKiBAdGhyb3dzIEtlZXBlckV4Y2VwdGlvbgogICAgICogQHRocm93\ncyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBJT0V4Y2Vw\ndGlvbgogICAgICogQHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlvbgogICAg\nICovCiAgICBzdGF0aWMgVmVyc2lvbmVkPENvb2tpZT4gcmVhZEZyb21ab29L\nZWVwZXIoWm9vS2VlcGVyIHprLCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYp\nCiAgICAgICAgICAgIHRocm93cyBLZWVwZXJFeGNlcHRpb24sIEludGVycnVw\ndGVkRXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiwgVW5rbm93bkhvc3RFeGNlcHRp\nb24gewogICAgICAgIFN0cmluZyB6a1BhdGggPSBnZXRaa1BhdGgoY29uZik7\nCgogICAgICAgIFN0YXQgc3RhdCA9IHprLmV4aXN0cyh6a1BhdGgsIGZhbHNl\nKTsKICAgICAgICBieXRlW10gZGF0YSA9IHprLmdldERhdGEoemtQYXRoLCBm\nYWxzZSwgc3RhdCk7CiAgICAgICAgQnVmZmVyZWRSZWFkZXIgcmVhZGVyID0g\nbmV3IEJ1ZmZlcmVkUmVhZGVyKG5ldyBTdHJpbmdSZWFkZXIobmV3IFN0cmlu\nZyhkYXRhLCBVVEZfOCkpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBC\ndWlsZGVyIGJ1aWxkZXIgPSBwYXJzZShyZWFkZXIpOwogICAgICAgICAgICBD\nb29raWUgY29va2llID0gYnVpbGRlci5idWlsZCgpOwogICAgICAgICAgICAv\nLyBzZXRzIHN0YXQgdmVyc2lvbiBmcm9tIFpvb0tlZXBlcgogICAgICAgICAg\nICBaa1ZlcnNpb24gdmVyc2lvbiA9IG5ldyBaa1ZlcnNpb24oc3RhdC5nZXRW\nZXJzaW9uKCkpOwogICAgICAgICAgICByZXR1cm4gbmV3IFZlcnNpb25lZDxD\nb29raWU+KGNvb2tpZSwgdmVyc2lvbik7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgcmVhZGVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJucyBjb29raWUgZnJvbSB0aGUgZ2l2ZW4g\nZGlyZWN0b3J5CiAgICAgKgogICAgICogQHBhcmFtIGRpcmVjdG9yeQogICAg\nICogICAgICAgICAgICBkaXJlY3RvcnkKICAgICAqCiAgICAgKiBAcmV0dXJu\nIGNvb2tpZSBvYmplY3QKICAgICAqCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0\naW9uCiAgICAgKi8KICAgIHN0YXRpYyBDb29raWUgcmVhZEZyb21EaXJlY3Rv\ncnkoRmlsZSBkaXJlY3RvcnkpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgRmlsZSB2ZXJzaW9uRmlsZSA9IG5ldyBGaWxlKGRpcmVjdG9yeSwKICAg\nICAgICAgICAgICAgIEJvb2tLZWVwZXJDb25zdGFudHMuVkVSU0lPTl9GSUxF\nTkFNRSk7CiAgICAgICAgQnVmZmVyZWRSZWFkZXIgcmVhZGVyID0gbmV3IEJ1\nZmZlcmVkUmVhZGVyKAogICAgICAgICAgICAgICAgbmV3IElucHV0U3RyZWFt\nUmVhZGVyKG5ldyBGaWxlSW5wdXRTdHJlYW0odmVyc2lvbkZpbGUpLCBVVEZf\nOCkpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBwYXJzZShy\nZWFkZXIpLmJ1aWxkKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgcmVhZGVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJucyBjb29raWUgcGF0aCBpbiB6b29rZWVwZXIKICAgICAq\nCiAgICAgKiBAcGFyYW0gY29uZgogICAgICogICAgICAgICAgICBjb25maWd1\ncmF0aW9uCiAgICAgKiAgICAgICAgICAKICAgICAqIEByZXR1cm4gY29va2ll\nIHprIHBhdGgKICAgICAqCiAgICAgKiBAdGhyb3dzIFVua25vd25Ib3N0RXhj\nZXB0aW9uCiAgICAgKi8KICAgIHN0YXRpYyBTdHJpbmcgZ2V0WmtQYXRoKFNl\ncnZlckNvbmZpZ3VyYXRpb24gY29uZikKICAgICAgICAgICAgdGhyb3dzIFVu\na25vd25Ib3N0RXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgYm9va2llQ29v\na2llUGF0aCA9IGNvbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgoKSArICIvIgog\nICAgICAgICAgICAgICAgKyBCb29rS2VlcGVyQ29uc3RhbnRzLkNPT0tJRV9O\nT0RFOwogICAgICAgIHJldHVybiBib29raWVDb29raWVQYXRoICsgIi8iICsg\nQm9va2llLmdldEJvb2tpZUFkZHJlc3MoY29uZik7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDaGVjayB3aGV0aGVyIHRoZSAnYm9va2llSG9zdCcgd2FzIGNy\nZWF0ZWQgdXNpbmcgYSBob3N0bmFtZSBvciBhbiBJUAogICAgICogYWRkcmVz\ncy4gUmVwcmVzZW50IGFzICdob3N0bmFtZS9JUGFkZHJlc3MnIGlmIHRoZSBJ\nbmV0U29ja2V0QWRkcmVzcyB3YXMKICAgICAqIGNyZWF0ZWQgdXNpbmcgaG9z\ndG5hbWUuIFJlcHJlc2VudCBhcyAnL0lQYWRkcmVzcycgaWYgdGhlCiAgICAg\nKiBJbmV0U29ja2V0QWRkcmVzcyB3YXMgY3JlYXRlZCB1c2luZyBhbiBJUGFk\nZHJlc3MKICAgICAqIAogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSAnYm9v\na2llSG9zdCcgd2FzIGNyZWF0ZWQgdXNpbmcgYW4gSVAgYWRkcmVzcywgZmFs\nc2UKICAgICAqICAgICAgICAgaWYgdGhlICdib29raWVIb3N0JyB3YXMgY3Jl\nYXRlZCB1c2luZyBhIGhvc3RuYW1lCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGlzQm9va2llSG9zdENyZWF0ZWRGcm9tSXAoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIFN0cmluZyBwYXJ0c1tdID0gYm9va2llSG9zdC5z\ncGxpdCgiOiIpOwogICAgICAgIGlmIChwYXJ0cy5sZW5ndGggIT0gMikgewog\nICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oYm9va2llSG9zdCAr\nICIgZG9lcyBub3QgaGF2ZSB0aGUgZm9ybSBob3N0OnBvcnQiKTsKICAgICAg\nICB9CiAgICAgICAgaW50IHBvcnQ7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgcG9ydCA9IEludGVnZXIucGFyc2VJbnQocGFydHNbMV0pOwogICAgICAg\nIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbihib29raWVIb3N0ICsgIiBkb2Vz\nIG5vdCBoYXZlIHRoZSBmb3JtIGhvc3Q6cG9ydCIpOwogICAgICAgIH0KCiAg\nICAgICAgSW5ldFNvY2tldEFkZHJlc3MgYWRkciA9IG5ldyBJbmV0U29ja2V0\nQWRkcmVzcyhwYXJ0c1swXSwgcG9ydCk7CiAgICAgICAgcmV0dXJuIGFkZHIu\ndG9TdHJpbmcoKS5zdGFydHNXaXRoKCIvIik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb29raWUgYnVpbGRlcgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGNsYXNzIEJ1aWxkZXIgewogICAgICAgIHByaXZhdGUgaW50IGxheW91dFZl\ncnNpb24gPSAwOwogICAgICAgIHByaXZhdGUgU3RyaW5nIGJvb2tpZUhvc3Qg\nPSBudWxsOwogICAgICAgIHByaXZhdGUgU3RyaW5nIGpvdXJuYWxEaXIgPSBu\ndWxsOwogICAgICAgIHByaXZhdGUgU3RyaW5nIGxlZGdlckRpcnMgPSBudWxs\nOwogICAgICAgIHByaXZhdGUgU3RyaW5nIGluc3RhbmNlSWQgPSBudWxsOwoK\nICAgICAgICBwcml2YXRlIEJ1aWxkZXIoKSB7CiAgICAgICAgfQoKICAgICAg\nICBwcml2YXRlIEJ1aWxkZXIoaW50IGxheW91dFZlcnNpb24sIFN0cmluZyBi\nb29raWVIb3N0LCBTdHJpbmcgam91cm5hbERpciwgU3RyaW5nIGxlZGdlckRp\ncnMsIFN0cmluZyBpbnN0YW5jZUlkKSB7CiAgICAgICAgICAgIHRoaXMubGF5\nb3V0VmVyc2lvbiA9IGxheW91dFZlcnNpb247CiAgICAgICAgICAgIHRoaXMu\nYm9va2llSG9zdCA9IGJvb2tpZUhvc3Q7CiAgICAgICAgICAgIHRoaXMuam91\ncm5hbERpciA9IGpvdXJuYWxEaXI7CiAgICAgICAgICAgIHRoaXMubGVkZ2Vy\nRGlycyA9IGxlZGdlckRpcnM7CiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VJ\nZCA9IGluc3RhbmNlSWQ7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQnVp\nbGRlciBzZXRMYXlvdXRWZXJzaW9uKGludCBsYXlvdXRWZXJzaW9uKSB7CiAg\nICAgICAgICAgIHRoaXMubGF5b3V0VmVyc2lvbiA9IGxheW91dFZlcnNpb247\nCiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIEJ1aWxkZXIgc2V0Qm9va2llSG9zdChTdHJpbmcgYm9va2llSG9z\ndCkgewogICAgICAgICAgICB0aGlzLmJvb2tpZUhvc3QgPSBib29raWVIb3N0\nOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBCdWlsZGVyIHNldEpvdXJuYWxEaXIoU3RyaW5nIGpvdXJuYWxE\naXIpIHsKICAgICAgICAgICAgdGhpcy5qb3VybmFsRGlyID0gam91cm5hbERp\ncjsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgQnVpbGRlciBzZXRMZWRnZXJEaXJzKFN0cmluZyBsZWRnZXJE\naXJzKSB7CiAgICAgICAgICAgIHRoaXMubGVkZ2VyRGlycyA9IGxlZGdlckRp\ncnM7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIEJ1aWxkZXIgc2V0SW5zdGFuY2VJZChTdHJpbmcgaW5zdGFu\nY2VJZCkgewogICAgICAgICAgICB0aGlzLmluc3RhbmNlSWQgPSBpbnN0YW5j\nZUlkOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBDb29raWUgYnVpbGQoKSB7CiAgICAgICAgICAgIHJldHVy\nbiBuZXcgQ29va2llKGxheW91dFZlcnNpb24sIGJvb2tpZUhvc3QsIGpvdXJu\nYWxEaXIsIGxlZGdlckRpcnMsIGluc3RhbmNlSWQpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgQ29va2llIGJ1aWxkZXIKICAg\nICAqIAogICAgICogQHJldHVybiBjb29raWUgYnVpbGRlcgogICAgICovCiAg\nICBzdGF0aWMgQnVpbGRlciBuZXdCdWlsZGVyKCkgewogICAgICAgIHJldHVy\nbiBuZXcgQnVpbGRlcigpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\ncyBDb29raWUgYnVpbGRlciB3aXRoIHRoZSBjb3B5IG9mIGdpdmVuIG9sZENv\nb2tpZQogICAgICoKICAgICAqIEBwYXJhbSBvbGRDb29raWUKICAgICAqICAg\nICAgICAgICAgYnVpbGQgbmV3IGNvb2tpZSBmcm9tIHRoaXMgY29va2llCiAg\nICAgKiBAcmV0dXJuIGNvb2tpZSBidWlsZGVyCiAgICAgKi8KICAgIHN0YXRp\nYyBCdWlsZGVyIG5ld0J1aWxkZXIoQ29va2llIG9sZENvb2tpZSkgewogICAg\nICAgIHJldHVybiBuZXcgQnVpbGRlcihvbGRDb29raWUubGF5b3V0VmVyc2lv\nbiwgb2xkQ29va2llLmJvb2tpZUhvc3QsIG9sZENvb2tpZS5qb3VybmFsRGly\nLCBvbGRDb29raWUubGVkZ2VyRGlycywKICAgICAgICAgICAgICAgIG9sZENv\nb2tpZS5pbnN0YW5jZUlkKTsKICAgIH0KfQo=\n","encoding":"base64"}

