{"sha":"0e052b527e215da193a4faa4ce56262344324900","node_id":"MDQ6QmxvYjE1NzU5NTY6MGUwNTJiNTI3ZTIxNWRhMTkzYTRmYWE0Y2U1NjI2MjM0NDMyNDkwMA==","size":32494,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0e052b527e215da193a4faa4ce56262344324900","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgc3RhdGljIGNvbS5nb29nbGUuY29tbW9uLmJhc2UuQ2hhcnNldHMu\nVVRGXzg7CgppbXBvcnQgamF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0\nIGphdmEuaW8uQnVmZmVyZWRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLkZpbGU7\nCmltcG9ydCBqYXZhLmlvLkZpbGVGaWx0ZXI7CmltcG9ydCBqYXZhLmlvLkZp\nbGVJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uRmlsZU5vdEZvdW5kRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS5pby5GaWxlT3V0cHV0U3RyZWFtOwppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRT\ndHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbVdyaXRl\ncjsKaW1wb3J0IGphdmEuaW8uUmFuZG9tQWNjZXNzRmlsZTsKaW1wb3J0IGph\ndmEubmlvLkJ5dGVCdWZmZXI7CmltcG9ydCBqYXZhLm5pby5jaGFubmVscy5G\naWxlQ2hhbm5lbDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuTGlu\na2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51\ndGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNhbGxhYmxl\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ2FuY2VsbGF0aW9uRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVu\ndEhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJy\nZW50TWFwOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0aW9u\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0\nb3JTZXJ2aWNlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0\nb3JzOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRnV0dXJlOwoKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvcHlPbldyaXRlQXJyYXlMaXN0\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jv\nb2xlYW47CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5M\nZWRnZXJEaXJzTWFuYWdlci5MZWRnZXJEaXJzTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuSU9VdGlsczsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyRmFjdG9yeTsKCmltcG9ydCBjb20uZ29vZ2xlLmNvbW1vbi5jb2xsZWN0\nLk1hcE1ha2VyOwoKLyoqCiAqIFRoaXMgY2xhc3MgbWFuYWdlcyB0aGUgd3Jp\ndGluZyBvZiB0aGUgYm9va2tlZXBlciBlbnRyaWVzLiBBbGwgdGhlIG5ldwog\nKiBlbnRyaWVzIGFyZSB3cml0dGVuIHRvIGEgY29tbW9uIGxvZy4gVGhlIExl\nZGdlckNhY2hlIHdpbGwgaGF2ZSBwb2ludGVycwogKiBpbnRvIGZpbGVzIGNy\nZWF0ZWQgYnkgdGhpcyBjbGFzcyB3aXRoIG9mZnNldHMgaW50byB0aGUgZmls\nZXMgdG8gZmluZAogKiB0aGUgYWN0dWFsIGxlZGdlciBlbnRyeS4gVGhlIGVu\ndHJ5IGxvZyBmaWxlcyBjcmVhdGVkIGJ5IHRoaXMgY2xhc3MgYXJlCiAqIGlk\nZW50aWZpZWQgYnkgYSBsb25nLgogKi8KcHVibGljIGNsYXNzIEVudHJ5TG9n\nZ2VyIHsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihFbnRyeUxvZ2dlci5jbGFzcyk7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQnVmZmVyZWRMb2dDaGFubmVsIGV4\ndGVuZHMgQnVmZmVyZWRDaGFubmVsIHsKICAgICAgICBmaW5hbCBwcml2YXRl\nIGxvbmcgbG9nSWQ7CiAgICAgICAgcHVibGljIEJ1ZmZlcmVkTG9nQ2hhbm5l\nbChGaWxlQ2hhbm5lbCBmYywgaW50IHdyaXRlQ2FwYWNpdHksCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgcmVhZENhcGFjaXR5LCBs\nb25nIGxvZ0lkKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBz\ndXBlcihmYywgd3JpdGVDYXBhY2l0eSwgcmVhZENhcGFjaXR5KTsKICAgICAg\nICAgICAgdGhpcy5sb2dJZCA9IGxvZ0lkOwogICAgICAgIH0KICAgICAgICBw\ndWJsaWMgbG9uZyBnZXRMb2dJZCgpIHsKICAgICAgICAgICAgcmV0dXJuIGxv\nZ0lkOwogICAgICAgIH0KICAgIH0KCiAgICB2b2xhdGlsZSBGaWxlIGN1cnJl\nbnREaXI7CiAgICBwcml2YXRlIGZpbmFsIExlZGdlckRpcnNNYW5hZ2VyIGxl\nZGdlckRpcnNNYW5hZ2VyOwogICAgcHJpdmF0ZSBmaW5hbCBBdG9taWNCb29s\nZWFuIHNob3VsZENyZWF0ZU5ld0VudHJ5TG9nID0gbmV3IEF0b21pY0Jvb2xl\nYW4oZmFsc2UpOwoKICAgIHByaXZhdGUgdm9sYXRpbGUgbG9uZyBsZWFzdFVu\nZmx1c2hlZExvZ0lkOwoKICAgIC8qKgogICAgICogVGhlIG1heGltdW0gc2l6\nZSBvZiBhIGVudHJ5IGxvZ2dlciBmaWxlLgogICAgICovCiAgICBmaW5hbCBs\nb25nIGxvZ1NpemVMaW1pdDsKICAgIHByaXZhdGUgTGlzdDxCdWZmZXJlZExv\nZ0NoYW5uZWw+IGxvZ0NoYW5uZWxzVG9GbHVzaDsKICAgIHByaXZhdGUgdm9s\nYXRpbGUgQnVmZmVyZWRMb2dDaGFubmVsIGxvZ0NoYW5uZWw7CiAgICBwcml2\nYXRlIGZpbmFsIEVudHJ5TG9nZ2VyQWxsb2NhdG9yIGVudHJ5TG9nZ2VyQWxs\nb2NhdG9yOwogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIGVudHJ5TG9nUHJl\nQWxsb2NhdGlvbkVuYWJsZWQ7CiAgICBwcml2YXRlIGZpbmFsIENvcHlPbldy\naXRlQXJyYXlMaXN0PEVudHJ5TG9nTGlzdGVuZXI+IGxpc3RlbmVycwogICAg\nICAgID0gbmV3IENvcHlPbldyaXRlQXJyYXlMaXN0PEVudHJ5TG9nTGlzdGVu\nZXI+KCk7CgogICAgLyoqCiAgICAgKiBUaGUgMUsgYmxvY2sgYXQgdGhlIGhl\nYWQgb2YgdGhlIGVudHJ5IGxvZ2dlciBmaWxlCiAgICAgKiB0aGF0IGNvbnRh\naW5zIHRoZSBmaW5nZXJwcmludCBhbmQgKGZ1dHVyZSkgbWV0YS1kYXRhCiAg\nICAgKi8KICAgIGZpbmFsIHN0YXRpYyBpbnQgTE9HRklMRV9IRUFERVJfU0la\nRSA9IDEwMjQ7CiAgICBmaW5hbCBCeXRlQnVmZmVyIExPR0ZJTEVfSEVBREVS\nID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZShMT0dGSUxFX0hFQURFUl9TSVpFKTsK\nICAgIGZpbmFsIHN0YXRpYyBsb25nIElOVkFMSURfTElEID0gLTFMOwoKICAg\nIGZpbmFsIHN0YXRpYyBpbnQgTUlOX1NBTkVfRU5UUllfU0laRSA9IDggKyA4\nOwogICAgZmluYWwgc3RhdGljIGxvbmcgTUIgPSAxMDI0ICogMTAyNDsKCiAg\nICBmaW5hbCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmY7CiAgICAvKioKICAg\nICAqIFNjYW4gZW50cmllcyBpbiBhIGVudHJ5IGxvZyBmaWxlLgogICAgICov\nCiAgICBzdGF0aWMgaW50ZXJmYWNlIEVudHJ5TG9nU2Nhbm5lciB7CiAgICAg\nICAgLyoqCiAgICAgICAgICogVGVzdHMgd2hldGhlciBvciBub3QgdGhlIGVu\ndHJpZXMgYmVsb25ncyB0byB0aGUgc3BlY2lmaWVkIGxlZGdlcgogICAgICAg\nICAqIHNob3VsZCBiZSBwcm9jZXNzZWQuCiAgICAgICAgICoKICAgICAgICAg\nKiBAcGFyYW0gbGVkZ2VySWQKICAgICAgICAgKiAgICAgICAgICBMZWRnZXIg\nSUQuCiAgICAgICAgICogQHJldHVybiB0cnVlIGlmIGFuZCBvbmx5IHRoZSBl\nbnRyaWVzIG9mIHRoZSBsZWRnZXIgc2hvdWxkIGJlIHNjYW5uZWQuCiAgICAg\nICAgICovCiAgICAgICAgcHVibGljIGJvb2xlYW4gYWNjZXB0KGxvbmcgbGVk\nZ2VySWQpOwoKICAgICAgICAvKioKICAgICAgICAgKiBQcm9jZXNzIGFuIGVu\ndHJ5LgogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIGxlZGdlcklkCiAg\nICAgICAgICogICAgICAgICAgTGVkZ2VyIElELgogICAgICAgICAqIEBwYXJh\nbSBvZmZzZXQKICAgICAgICAgKiAgICAgICAgICBGaWxlIG9mZnNldCBvZiB0\naGlzIGVudHJ5LgogICAgICAgICAqIEBwYXJhbSBlbnRyeQogICAgICAgICAq\nICAgICAgICAgIEVudHJ5IEJ5dGVCdWZmZXIKICAgICAgICAgKiBAdGhyb3dz\nIElPRXhjZXB0aW9uCiAgICAgICAgICovCiAgICAgICAgcHVibGljIHZvaWQg\ncHJvY2Vzcyhsb25nIGxlZGdlcklkLCBsb25nIG9mZnNldCwgQnl0ZUJ1ZmZl\nciBlbnRyeSkgdGhyb3dzIElPRXhjZXB0aW9uOwogICAgfQoKICAgIC8qKgog\nICAgICogRW50cnkgTG9nIExpc3RlbmVyCiAgICAgKi8KICAgIHN0YXRpYyBp\nbnRlcmZhY2UgRW50cnlMb2dMaXN0ZW5lciB7CiAgICAgICAgLyoqCiAgICAg\nICAgICogUm90YXRlIGEgbmV3IGVudHJ5IGxvZyB0byB3cml0ZS4KICAgICAg\nICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBvblJvdGF0ZUVudHJ5TG9nKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW4gRW50cnlMb2dnZXIg\ndGhhdCBzdG9yZXMgaXQncyBsb2cgZmlsZXMgaW4gdGhlIGdpdmVuCiAgICAg\nKiBkaXJlY3RvcmllcwogICAgICovCiAgICBwdWJsaWMgRW50cnlMb2dnZXIo\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLAogICAgICAgICAgICBMZWRnZXJE\naXJzTWFuYWdlciBsZWRnZXJEaXJzTWFuYWdlcikgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICB0aGlzKGNvbmYsIGxlZGdlckRpcnNNYW5hZ2VyLCBu\ndWxsKTsKICAgIH0KCiAgICBwdWJsaWMgRW50cnlMb2dnZXIoU2VydmVyQ29u\nZmlndXJhdGlvbiBjb25mLAogICAgICAgICAgICBMZWRnZXJEaXJzTWFuYWdl\nciBsZWRnZXJEaXJzTWFuYWdlciwgRW50cnlMb2dMaXN0ZW5lciBsaXN0ZW5l\ncikKICAgICAgICAgICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIHRoaXMubGVkZ2VyRGlyc01hbmFnZXIgPSBsZWRnZXJEaXJzTWFu\nYWdlcjsKICAgICAgICBpZiAobGlzdGVuZXIgIT0gbnVsbCkgewogICAgICAg\nICAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lcik7CiAgICAgICAgfQogICAgICAg\nIC8vIGxvZyBzaXplIGxpbWl0CiAgICAgICAgdGhpcy5sb2dTaXplTGltaXQg\nPSBjb25mLmdldEVudHJ5TG9nU2l6ZUxpbWl0KCk7CiAgICAgICAgdGhpcy5l\nbnRyeUxvZ1ByZUFsbG9jYXRpb25FbmFibGVkID0gY29uZi5pc0VudHJ5TG9n\nRmlsZVByZUFsbG9jYXRpb25FbmFibGVkKCk7CgogICAgICAgIC8vIEluaXRp\nYWxpemUgdGhlIGVudHJ5IGxvZyBoZWFkZXIgYnVmZmVyLiBUaGlzIGNhbm5v\ndCBiZSBhIHN0YXRpYyBvYmplY3QKICAgICAgICAvLyBzaW5jZSBpbiBvdXIg\ndW5pdCB0ZXN0cywgd2UgcnVuIG11bHRpcGxlIEJvb2tpZXMgYW5kIHRodXMg\nRW50cnlMb2dnZXJzCiAgICAgICAgLy8gd2l0aGluIHRoZSBzYW1lIEpWTS4g\nQWxsIG9mIHRoZXNlIEJvb2tpZSBpbnN0YW5jZXMgYWNjZXNzIHRoaXMgaGVh\nZGVyCiAgICAgICAgLy8gc28gdGhlcmUgY2FuIGJlIHJhY2UgY29uZGl0aW9u\ncyB3aGVuIGVudHJ5IGxvZ3MgYXJlIHJvbGxlZCBvdmVyIGFuZAogICAgICAg\nIC8vIHRoaXMgaGVhZGVyIGJ1ZmZlciBpcyBjbGVhcmVkIGJlZm9yZSB3cml0\naW5nIGl0IGludG8gdGhlIG5ldyBsb2dDaGFubmVsLgogICAgICAgIExPR0ZJ\nTEVfSEVBREVSLnB1dCgiQktMTyIuZ2V0Qnl0ZXMoVVRGXzgpKTsKCiAgICAg\nICAgLy8gRmluZCB0aGUgbGFyZ2VzdCBsb2dJZAogICAgICAgIGxvbmcgbG9n\nSWQgPSBJTlZBTElEX0xJRDsKICAgICAgICBmb3IgKEZpbGUgZGlyIDogbGVk\nZ2VyRGlyc01hbmFnZXIuZ2V0QWxsTGVkZ2VyRGlycygpKSB7CiAgICAgICAg\nICAgIGlmICghZGlyLmV4aXN0cygpKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgRmlsZU5vdEZvdW5kRXhjZXB0aW9uKAogICAgICAgICAgICAgICAg\nICAgICAgICAiRW50cnkgbG9nIGRpcmVjdG9yeSBkb2VzIG5vdCBleGlzdCIp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxvbmcgbGFzdExvZ0lkID0g\nZ2V0TGFzdExvZ0lkKGRpcik7CiAgICAgICAgICAgIGlmIChsYXN0TG9nSWQg\nPiBsb2dJZCkgewogICAgICAgICAgICAgICAgbG9nSWQgPSBsYXN0TG9nSWQ7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5sZWFzdFVu\nZmx1c2hlZExvZ0lkID0gbG9nSWQgKyAxOwogICAgICAgIHRoaXMuZW50cnlM\nb2dnZXJBbGxvY2F0b3IgPSBuZXcgRW50cnlMb2dnZXJBbGxvY2F0b3IobG9n\nSWQpOwogICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CiAgICAgICAgaW5pdGlh\nbGl6ZSgpOwogICAgfQoKICAgIHZvaWQgYWRkTGlzdGVuZXIoRW50cnlMb2dM\naXN0ZW5lciBsaXN0ZW5lcikgewogICAgICAgIGlmIChudWxsICE9IGxpc3Rl\nbmVyKSB7CiAgICAgICAgICAgIGxpc3RlbmVycy5hZGQobGlzdGVuZXIpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIElmIHRoZSBsb2cgaWQg\nb2YgY3VycmVudCB3cml0YWJsZSBjaGFubmVsIGlzIHRoZSBzYW1lIGFzIGVu\ndHJ5TG9nSWQgYW5kIHRoZSBwb3NpdGlvbgogICAgICogd2Ugd2FudCB0byBy\nZWFkIG1pZ2h0IGVuZCB1cCByZWFkaW5nIGZyb20gYSBwb3NpdGlvbiBpbiB0\naGUgd3JpdGUgYnVmZmVyIG9mIHRoZQogICAgICogYnVmZmVyZWQgY2hhbm5l\nbCwgcm91dGUgdGhpcyByZWFkIHRvIHRoZSBjdXJyZW50IGxvZ0NoYW5uZWwu\nIEVsc2UsCiAgICAgKiByZWFkIGZyb20gdGhlIEJ1ZmZlcmVkUmVhZENoYW5u\nZWwgdGhhdCBpcyBwcm92aWRlZC4KICAgICAqIEBwYXJhbSBlbnRyeUxvZ0lk\nCiAgICAgKiBAcGFyYW0gY2hhbm5lbAogICAgICogQHBhcmFtIGJ1ZmYgcmVt\nYWluaW5nKCkgb24gdGhpcyBieXRlYnVmZmVyIHRlbGxzIHVzIHRoZSBsYXN0\nIHBvc2l0aW9uIHRoYXQgd2UKICAgICAqICAgICAgICAgICAgIGV4cGVjdCB0\nbyByZWFkLgogICAgICogQHBhcmFtIHBvcyBUaGUgc3RhcnRpbmcgcG9zaXRp\nb24gZnJvbSB3aGVyZSB3ZSB3YW50IHRvIHJlYWQuCiAgICAgKiBAcmV0dXJu\nCiAgICAgKi8KICAgIHByaXZhdGUgaW50IHJlYWRGcm9tTG9nQ2hhbm5lbChs\nb25nIGVudHJ5TG9nSWQsIEJ1ZmZlcmVkUmVhZENoYW5uZWwgY2hhbm5lbCwg\nQnl0ZUJ1ZmZlciBidWZmLCBsb25nIHBvcykKICAgICAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBCdWZmZXJlZExvZ0NoYW5uZWwgYmMg\nPSBsb2dDaGFubmVsOwogICAgICAgIGlmIChudWxsICE9IGJjKSB7CiAgICAg\nICAgICAgIGlmIChlbnRyeUxvZ0lkID09IGJjLmdldExvZ0lkKCkpIHsKICAg\nICAgICAgICAgICAgIHN5bmNocm9uaXplZCAoYmMpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAocG9zICsgYnVmZi5yZW1haW5pbmcoKSA+PSBiYy5nZXRG\naWxlQ2hhbm5lbFBvc2l0aW9uKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIGJjLnJlYWQoYnVmZiwgcG9zKTsKICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGNoYW5uZWwucmVhZChidWZmLCBwb3MpOwog\nICAgfQoKICAgIC8qKgogICAgICogQSB0aHJlYWQtbG9jYWwgdmFyaWFibGUg\ndGhhdCB3cmFwcyBhIG1hcHBpbmcgb2YgbG9nIGlkcyB0byBidWZmZXJlZGNo\nYW5uZWxzCiAgICAgKiBUaGVzZSBjaGFubmVscyBzaG91bGQgYmUgdXNlZCBv\nbmx5IGZvciByZWFkaW5nLiBsb2dDaGFubmVsIGlzIHRoZSBvbmUKICAgICAq\nIHRoYXQgaXMgdXNlZCBmb3Igd3JpdGVzLgogICAgICovCiAgICBwcml2YXRl\nIGZpbmFsIFRocmVhZExvY2FsPE1hcDxMb25nLCBCdWZmZXJlZFJlYWRDaGFu\nbmVsPj4gbG9naWQyQ2hhbm5lbAogICAgICAgICAgICA9IG5ldyBUaHJlYWRM\nb2NhbDxNYXA8TG9uZywgQnVmZmVyZWRSZWFkQ2hhbm5lbD4+KCkgewogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBNYXA8TG9uZywgQnVmZmVy\nZWRSZWFkQ2hhbm5lbD4gaW5pdGlhbFZhbHVlKCkgewogICAgICAgICAgICAv\nLyBTaW5jZSB0aGlzIGlzIHRocmVhZCBsb2NhbCB0aGVyZSBvbmx5IG9uZSBt\nb2RpZmllcgogICAgICAgICAgICAvLyBXZSBkb250IHJlYWxseSBuZWVkIHRo\nZSBjb25jdXJyZW5jeSwgYnV0IHdlIG5lZWQgdG8gdXNlCiAgICAgICAgICAg\nIC8vIHRoZSB3ZWFrIHZhbHVlcy4gVGhlcmVmb3JlIHVzaW5nIHRoZSBjb25j\ndXJyZW5jeSBsZXZlbCBvZiAxCiAgICAgICAgICAgIHJldHVybiBuZXcgTWFw\nTWFrZXIoKS5jb25jdXJyZW5jeUxldmVsKDEpCiAgICAgICAgICAgICAgICAu\nd2Vha1ZhbHVlcygpCiAgICAgICAgICAgICAgICAubWFrZU1hcCgpOwogICAg\nICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBFYWNoIHRocmVhZCBsb2Nh\nbCBidWZmZXJlZCByZWFkIGNoYW5uZWwgY2FuIHNoYXJlIHRoZSBzYW1lIGZp\nbGUgaGFuZGxlIGJlY2F1c2UgcmVhZHMgYXJlIG5vdCByZWxhdGl2ZQogICAg\nICogYW5kIGRvbid0IGNhdXNlIGEgY2hhbmdlIGluIHRoZSBjaGFubmVsJ3Mg\ncG9zaXRpb24uIFdlIHVzZSB0aGlzIG1hcCB0byBzdG9yZSB0aGUgZmlsZSBj\naGFubmVscy4gRWFjaAogICAgICogZmlsZSBjaGFubmVsIGlzIG1hcHBlZCB0\nbyBhIGxvZyBpZCB3aGljaCByZXByZXNlbnRzIGFuIG9wZW4gbG9nIGZpbGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgZmluYWwgQ29uY3VycmVudE1hcDxMb25n\nLCBGaWxlQ2hhbm5lbD4gbG9naWQyRmlsZUNoYW5uZWwKICAgICAgICAgICAg\nPSBuZXcgQ29uY3VycmVudEhhc2hNYXA8TG9uZywgRmlsZUNoYW5uZWw+KCk7\nCgogICAgLyoqCiAgICAgKiBQdXQgdGhlIGxvZ0lkLCBiYyBwYWlyIGluIHRo\nZSBtYXAgcmVzcG9uc2libGUgZm9yIHRoZSBjdXJyZW50IHRocmVhZC4KICAg\nICAqIEBwYXJhbSBsb2dJZAogICAgICogQHBhcmFtIGJjCiAgICAgKi8KICAg\nIHB1YmxpYyBCdWZmZXJlZFJlYWRDaGFubmVsIHB1dEluUmVhZENoYW5uZWxz\nKGxvbmcgbG9nSWQsIEJ1ZmZlcmVkUmVhZENoYW5uZWwgYmMpIHsKICAgICAg\nICBNYXA8TG9uZywgQnVmZmVyZWRSZWFkQ2hhbm5lbD4gdGhyZWFkTWFwID0g\nbG9naWQyQ2hhbm5lbC5nZXQoKTsKICAgICAgICByZXR1cm4gdGhyZWFkTWFw\nLnB1dChsb2dJZCwgYmMpOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3Zl\nIGFsbCBlbnRyaWVzIGZvciB0aGlzIGxvZyBmaWxlIGluIGVhY2ggdGhyZWFk\nJ3MgY2FjaGUuCiAgICAgKiBAcGFyYW0gbG9nSWQKICAgICAqLwogICAgcHVi\nbGljIHZvaWQgcmVtb3ZlRnJvbUNoYW5uZWxzQW5kQ2xvc2UobG9uZyBsb2dJ\nZCkgewogICAgICAgIEZpbGVDaGFubmVsIGZpbGVDaGFubmVsID0gbG9naWQy\nRmlsZUNoYW5uZWwucmVtb3ZlKGxvZ0lkKTsKICAgICAgICBpZiAobnVsbCAh\nPSBmaWxlQ2hhbm5lbCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgZmlsZUNoYW5uZWwuY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgTE9HLndhcm4o\nIkV4Y2VwdGlvbiB3aGlsZSBjbG9zaW5nIGNoYW5uZWwgZm9yIGxvZyBmaWxl\nOiIgKyBsb2dJZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIEJ1ZmZlcmVkUmVhZENoYW5uZWwgZ2V0RnJvbUNoYW5uZWxz\nKGxvbmcgbG9nSWQpIHsKICAgICAgICByZXR1cm4gbG9naWQyQ2hhbm5lbC5n\nZXQoKS5nZXQobG9nSWQpOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRo\nZSBsZWFzdCB1bmZsdXNoZWQgbG9nIGlkLiBHYXJiYWdlIGNvbGxlY3RvciB0\naHJlYWQgc2hvdWxkIG5vdCBwcm9jZXNzCiAgICAgKiB1bmZsdXNoZWQgZW50\ncnkgbG9nIGZpbGUuCiAgICAgKgogICAgICogQHJldHVybiBsZWFzdCB1bmZs\ndXNoZWQgbG9nIGlkLgogICAgICovCiAgICBzeW5jaHJvbml6ZWQgbG9uZyBn\nZXRMZWFzdFVuZmx1c2hlZExvZ0lkKCkgewogICAgICAgIHJldHVybiBsZWFz\ndFVuZmx1c2hlZExvZ0lkOwogICAgfQoKICAgIHN5bmNocm9uaXplZCBsb25n\nIGdldEN1cnJlbnRMb2dJZCgpIHsKICAgICAgICByZXR1cm4gbG9nQ2hhbm5l\nbC5nZXRMb2dJZCgpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGluaXRp\nYWxpemUoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIC8vIFJlZ2lz\ndGVyIGxpc3RlbmVyIGZvciBkaXNrIGZ1bGwgbm90aWZpY2F0aW9ucy4KICAg\nICAgICBsZWRnZXJEaXJzTWFuYWdlci5hZGRMZWRnZXJEaXJzTGlzdGVuZXIo\nZ2V0TGVkZ2VyRGlyc0xpc3RlbmVyKCkpOwogICAgICAgIC8vIGNyZWF0ZSBh\nIG5ldyBsb2cgdG8gd3JpdGUKICAgICAgICBjcmVhdGVOZXdMb2coKTsKICAg\nIH0KCiAgICBwcml2YXRlIExlZGdlckRpcnNMaXN0ZW5lciBnZXRMZWRnZXJE\naXJzTGlzdGVuZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBMZWRnZXJEaXJz\nTGlzdGVuZXIoKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBkaXNrRnVsbChGaWxlIGRpc2spIHsKICAgICAgICAg\nICAgICAgIC8vIElmIHRoZSBjdXJyZW50IGVudHJ5IGxvZyBkaXNrIGlzIGZ1\nbGwsIHRoZW4gY3JlYXRlIG5ldyBlbnRyeQogICAgICAgICAgICAgICAgLy8g\nbG9nLgogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnREaXIgIT0gbnVsbCAm\nJiBjdXJyZW50RGlyLmVxdWFscyhkaXNrKSkgewogICAgICAgICAgICAgICAg\nICAgIHNob3VsZENyZWF0ZU5ld0VudHJ5TG9nLnNldCh0cnVlKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGRpc2tBbG1vc3RGdWxsKEZp\nbGUgZGlzaykgewogICAgICAgICAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQg\nZW50cnkgbG9nIGRpc2sgaXMgYWxtb3N0IGZ1bGwsIHRoZW4gY3JlYXRlIG5l\ndyBlbnRyeQogICAgICAgICAgICAgICAgLy8gbG9nLgogICAgICAgICAgICAg\nICAgaWYgKGN1cnJlbnREaXIgIT0gbnVsbCAmJiBjdXJyZW50RGlyLmVxdWFs\ncyhkaXNrKSkgewogICAgICAgICAgICAgICAgICAgIHNob3VsZENyZWF0ZU5l\nd0VudHJ5TG9nLnNldCh0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIGRpc2tGYWlsZWQoRmlsZSBkaXNrKSB7CiAgICAgICAgICAg\nICAgICAvLyBOb3RoaW5nIHRvIGhhbmRsZSBoZXJlLiBXaWxsIGJlIGhhbmRs\nZWQgaW4gQm9va2llCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBhbGxEaXNrc0Z1bGwoKSB7\nCiAgICAgICAgICAgICAgICAvLyBOb3RoaW5nIHRvIGhhbmRsZSBoZXJlLiBX\naWxsIGJlIGhhbmRsZWQgaW4gQm9va2llCiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBmYXRh\nbEVycm9yKCkgewogICAgICAgICAgICAgICAgLy8gTm90aGluZyB0byBoYW5k\nbGUgaGVyZS4gV2lsbCBiZSBoYW5kbGVkIGluIEJvb2tpZQogICAgICAgICAg\nICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGlj\nIHZvaWQgZGlza1dyaXRhYmxlKEZpbGUgZGlzaykgewogICAgICAgICAgICAg\nICAgLy8gTm90aGluZyB0byBoYW5kbGUgaGVyZS4gV2lsbCBiZSBoYW5kbGVk\nIGluIEJvb2tpZQogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgZGlza0p1c3RXcml0YWJsZShG\naWxlIGRpc2spIHsKICAgICAgICAgICAgICAgIC8vIE5vdGhpbmcgdG8gaGFu\nZGxlIGhlcmUuIFdpbGwgYmUgaGFuZGxlZCBpbiBCb29raWUKICAgICAgICAg\nICAgfQogICAgICAgIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBSb2xsaW5n\nIGEgbmV3IGxvZyBmaWxlIHRvIHdyaXRlLgogICAgICovCiAgICBzeW5jaHJv\nbml6ZWQgdm9pZCByb2xsTG9nKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBjcmVhdGVOZXdMb2coKTsKICAgIH0KCiAgICAvKioKICAgICAqIENy\nZWF0ZXMgYSBuZXcgbG9nIGZpbGUKICAgICAqLwogICAgdm9pZCBjcmVhdGVO\nZXdMb2coKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIC8vIGZpcnN0\nIHRyaWVkIHRvIGNyZWF0ZSBhIG5ldyBsb2cgY2hhbm5lbC4gYWRkIGN1cnJl\nbnQgbG9nIGNoYW5uZWwgdG8gVG9GbHVzaCBsaXN0IG9ubHkgd2hlbgogICAg\nICAgIC8vIHRoZXJlIGlzIGEgbmV3IGxvZyBjaGFubmVsLiBpdCB3b3VsZCBw\ncmV2ZW50IHRoYXQgYSBsb2cgY2hhbm5lbCBpcyByZWZlcmVuY2VkIGJ5IGJv\ndGgKICAgICAgICAvLyAqbG9nQ2hhbm5lbCogYW5kICpUb0ZsdXNoKiBsaXN0\nLgogICAgICAgIGlmIChudWxsICE9IGxvZ0NoYW5uZWwpIHsKICAgICAgICAg\nICAgaWYgKG51bGwgPT0gbG9nQ2hhbm5lbHNUb0ZsdXNoKSB7CiAgICAgICAg\nICAgICAgICBsb2dDaGFubmVsc1RvRmx1c2ggPSBuZXcgTGlua2VkTGlzdDxC\ndWZmZXJlZExvZ0NoYW5uZWw+KCk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgLy8gZmx1c2ggdGhlIGludGVybmFsIGJ1ZmZlciBiYWNrIHRvIGZpbGVz\neXN0ZW0gYnV0IG5vdCBzeW5jIGRpc2sKICAgICAgICAgICAgLy8gc28gdGhl\nIHJlYWRlcnMgY291bGQgYWNjZXNzIHRoZSBkYXRhIGZyb20gZmlsZXN5c3Rl\nbS4KICAgICAgICAgICAgbG9nQ2hhbm5lbC5mbHVzaChmYWxzZSk7CiAgICAg\nICAgICAgIEJ1ZmZlcmVkTG9nQ2hhbm5lbCBuZXdMb2dDaGFubmVsID0gZW50\ncnlMb2dnZXJBbGxvY2F0b3IuY3JlYXRlTmV3TG9nKCk7CiAgICAgICAgICAg\nIGxvZ0NoYW5uZWxzVG9GbHVzaC5hZGQobG9nQ2hhbm5lbCk7CiAgICAgICAg\nICAgIExPRy5pbmZvKCJGbHVzaGluZyBlbnRyeSBsb2dnZXIge30gYmFjayB0\nbyBmaWxlc3lzdGVtLCBwZW5kaW5nIGZvciBzeW5jaW5nIGVudHJ5IGxvZ2dl\ncnMgOiB7fS4iLAogICAgICAgICAgICAgICAgICAgIGxvZ0NoYW5uZWwuZ2V0\nTG9nSWQoKSwgbG9nQ2hhbm5lbHNUb0ZsdXNoKTsKICAgICAgICAgICAgZm9y\nIChFbnRyeUxvZ0xpc3RlbmVyIGxpc3RlbmVyIDogbGlzdGVuZXJzKSB7CiAg\nICAgICAgICAgICAgICBsaXN0ZW5lci5vblJvdGF0ZUVudHJ5TG9nKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgbG9nQ2hhbm5lbCA9IG5ld0xvZ0No\nYW5uZWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nQ2hhbm5l\nbCA9IGVudHJ5TG9nZ2VyQWxsb2NhdG9yLmNyZWF0ZU5ld0xvZygpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFuIGFsbG9jYXRvciBwcmUt\nYWxsb2NhdGVzIGVudHJ5IGxvZyBmaWxlcy4KICAgICAqLwogICAgY2xhc3Mg\nRW50cnlMb2dnZXJBbGxvY2F0b3IgewoKICAgICAgICBsb25nIHByZWFsbG9j\nYXRlZExvZ0lkOwogICAgICAgIEZ1dHVyZTxCdWZmZXJlZExvZ0NoYW5uZWw+\nIHByZWFsbG9jYXRpb24gPSBudWxsOwogICAgICAgIEV4ZWN1dG9yU2Vydmlj\nZSBhbGxvY2F0b3JFeGVjdXRvcjsKCiAgICAgICAgRW50cnlMb2dnZXJBbGxv\nY2F0b3IobG9uZyBsb2dJZCkgewogICAgICAgICAgICBwcmVhbGxvY2F0ZWRM\nb2dJZCA9IGxvZ0lkOwogICAgICAgICAgICBhbGxvY2F0b3JFeGVjdXRvciA9\nIEV4ZWN1dG9ycy5uZXdTaW5nbGVUaHJlYWRFeGVjdXRvcigpOwogICAgICAg\nIH0KCiAgICAgICAgc3luY2hyb25pemVkIEJ1ZmZlcmVkTG9nQ2hhbm5lbCBj\ncmVhdGVOZXdMb2coKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAg\nICBCdWZmZXJlZExvZ0NoYW5uZWwgYmM7CiAgICAgICAgICAgIGlmICghZW50\ncnlMb2dQcmVBbGxvY2F0aW9uRW5hYmxlZCB8fCBudWxsID09IHByZWFsbG9j\nYXRpb24pIHsKICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemF0aW9uIHRp\nbWUgdG8gY3JlYXRlIGEgbmV3IGxvZwogICAgICAgICAgICAgICAgYmMgPSBh\nbGxvY2F0ZU5ld0xvZygpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgLy8gaGFzIGEgcHJlYWxsb2NhdGVkIGVudHJ5IGxvZwogICAg\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBiYyA9IHBy\nZWFsbG9jYXRpb24uZ2V0KCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChF\neGVjdXRpb25FeGNlcHRpb24gZWUpIHsKICAgICAgICAgICAgICAgICAgICBp\nZiAoZWUuZ2V0Q2F1c2UoKSBpbnN0YW5jZW9mIElPRXhjZXB0aW9uKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHRocm93IChJT0V4Y2VwdGlvbikgKGVl\nLmdldENhdXNlKCkpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigi\nRXJyb3IgdG8gZXhlY3V0ZSBlbnRyeSBsb2cgYWxsb2NhdGlvbi4iLCBlZSk7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRj\naCAoQ2FuY2VsbGF0aW9uRXhjZXB0aW9uIGNlKSB7CiAgICAgICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJUYXNrIHRvIGFsbG9jYXRl\nIGEgbmV3IGVudHJ5IGxvZyBpcyBjYW5jZWxsZWQuIiwgY2UpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIklu\ndHJydXB0ZWQgd2hlbiB3YWl0aW5nIGEgbmV3IGVudHJ5IGxvZyB0byBiZSBh\nbGxvY2F0ZWQuIiwgaWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgcHJlYWxsb2NhdGlvbiA9IGFsbG9jYXRvckV4ZWN1dG9yLnN1Ym1p\ndChuZXcgQ2FsbGFibGU8QnVmZmVyZWRMb2dDaGFubmVsPigpIHsKICAgICAg\nICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBw\ndWJsaWMgQnVmZmVyZWRMb2dDaGFubmVsIGNhbGwoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWxsb2Nh\ndGVOZXdMb2coKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBMT0cuaW5mbygi\nQ3JlYXRlZCBuZXcgZW50cnkgbG9nZ2VyIHt9LiIsIGJjLmdldExvZ0lkKCkp\nOwogICAgICAgICAgICByZXR1cm4gYmM7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBBbGxvY2F0ZSBhIG5ldyBsb2cgZmlsZS4KICAgICAg\nICAgKi8KICAgICAgICBCdWZmZXJlZExvZ0NoYW5uZWwgYWxsb2NhdGVOZXdM\nb2coKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBMaXN0PEZp\nbGU+IGxpc3QgPSBsZWRnZXJEaXJzTWFuYWdlci5nZXRXcml0YWJsZUxlZGdl\nckRpcnMoKTsKICAgICAgICAgICAgQ29sbGVjdGlvbnMuc2h1ZmZsZShsaXN0\nKTsKICAgICAgICAgICAgLy8gSXQgd291bGQgYmV0dGVyIG5vdCB0byBvdmVy\nd3JpdGUgZXhpc3RpbmcgZW50cnkgbG9nIGZpbGVzCiAgICAgICAgICAgIEZp\nbGUgbmV3TG9nRmlsZSA9IG51bGw7CiAgICAgICAgICAgIGRvIHsKICAgICAg\nICAgICAgICAgIFN0cmluZyBsb2dGaWxlTmFtZSA9IExvbmcudG9IZXhTdHJp\nbmcoKytwcmVhbGxvY2F0ZWRMb2dJZCkgKyAiLmxvZyI7CiAgICAgICAgICAg\nICAgICBmb3IgKEZpbGUgZGlyIDogbGlzdCkgewogICAgICAgICAgICAgICAg\nICAgIG5ld0xvZ0ZpbGUgPSBuZXcgRmlsZShkaXIsIGxvZ0ZpbGVOYW1lKTsK\nICAgICAgICAgICAgICAgICAgICBjdXJyZW50RGlyID0gZGlyOwogICAgICAg\nICAgICAgICAgICAgIGlmIChuZXdMb2dGaWxlLmV4aXN0cygpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJGb3VuZCBleGlzdGVkIGVu\ndHJ5IGxvZyAiICsgbmV3TG9nRmlsZQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgKyAiIHdoZW4gdHJ5aW5nIHRvIGNyZWF0ZSBpdCBhcyBhIG5l\ndyBsb2cuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0xvZ0ZpbGUg\nPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0gd2hpbGUgKG5ld0xvZ0ZpbGUgPT0gbnVsbCk7CgogICAgICAgICAgICBG\naWxlQ2hhbm5lbCBjaGFubmVsID0gbmV3IFJhbmRvbUFjY2Vzc0ZpbGUobmV3\nTG9nRmlsZSwgInJ3IikuZ2V0Q2hhbm5lbCgpOwogICAgICAgICAgICBCdWZm\nZXJlZExvZ0NoYW5uZWwgbG9nQ2hhbm5lbCA9IG5ldyBCdWZmZXJlZExvZ0No\nYW5uZWwoY2hhbm5lbCwKICAgICAgICAgICAgICAgICAgICBjb25mLmdldFdy\naXRlQnVmZmVyQnl0ZXMoKSwgY29uZi5nZXRSZWFkQnVmZmVyQnl0ZXMoKSwg\ncHJlYWxsb2NhdGVkTG9nSWQpOwogICAgICAgICAgICBsb2dDaGFubmVsLndy\naXRlKChCeXRlQnVmZmVyKSBMT0dGSUxFX0hFQURFUi5jbGVhcigpKTsKCiAg\nICAgICAgICAgIGZvciAoRmlsZSBmIDogbGlzdCkgewogICAgICAgICAgICAg\nICAgc2V0TGFzdExvZ0lkKGYsIHByZWFsbG9jYXRlZExvZ0lkKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBMT0cuaW5mbygiUHJlYWxsb2NhdGVkIGVu\ndHJ5IGxvZ2dlciB7fS4iLCBwcmVhbGxvY2F0ZWRMb2dJZCk7CiAgICAgICAg\nICAgIHJldHVybiBsb2dDaGFubmVsOwogICAgICAgIH0KCiAgICAgICAgLyoq\nCiAgICAgICAgICogU3RvcCB0aGUgYWxsb2NhdG9yLgogICAgICAgICAqLwog\nICAgICAgIHZvaWQgc3RvcCgpIHsKICAgICAgICAgICAgLy8gd2FpdCB1bnRp\nbCB0aGUgcHJlYWxsb2NhdGlvbiBmaW5pc2hlZC4KICAgICAgICAgICAgYWxs\nb2NhdG9yRXhlY3V0b3Iuc2h1dGRvd24oKTsKICAgICAgICAgICAgTE9HLmlu\nZm8oIlN0b3BwZWQgZW50cnkgbG9nZ2VyIHByZWFsbG9jYXRvci4iKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgZW50cnkgbG9n\nLgogICAgICoKICAgICAqIEBwYXJhbSBlbnRyeUxvZ0lkCiAgICAgKiAgICAg\nICAgICBFbnRyeSBMb2cgRmlsZSBJZAogICAgICovCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiByZW1vdmVFbnRyeUxvZyhsb25nIGVudHJ5TG9nSWQpIHsKICAg\nICAgICByZW1vdmVGcm9tQ2hhbm5lbHNBbmRDbG9zZShlbnRyeUxvZ0lkKTsK\nICAgICAgICBGaWxlIGVudHJ5TG9nRmlsZTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBlbnRyeUxvZ0ZpbGUgPSBmaW5kRmlsZShlbnRyeUxvZ0lkKTsK\nICAgICAgICB9IGNhdGNoIChGaWxlTm90Rm91bmRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBMT0cuZXJyb3IoIlRyeWluZyB0byBkZWxldGUgYW4gZW50\ncnlMb2cgZmlsZSB0aGF0IGNvdWxkIG5vdCBiZSBmb3VuZDogIgogICAgICAg\nICAgICAgICAgICAgICsgZW50cnlMb2dJZCArICIubG9nIik7CiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKCFlbnRy\neUxvZ0ZpbGUuZGVsZXRlKCkpIHsKICAgICAgICAgICAgTE9HLndhcm4oIkNv\ndWxkIG5vdCBkZWxldGUgZW50cnkgbG9nIGZpbGUge30iLCBlbnRyeUxvZ0Zp\nbGUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIHdyaXRlcyB0aGUgZ2l2ZW4gaWQgdG8gdGhlICJsYXN0\nSWQiIGZpbGUgaW4gdGhlIGdpdmVuIGRpcmVjdG9yeS4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHNldExhc3RMb2dJZChGaWxlIGRpciwgbG9uZyBsb2dJ\nZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBGaWxlT3V0cHV0U3Ry\nZWFtIGZvczsKICAgICAgICBmb3MgPSBuZXcgRmlsZU91dHB1dFN0cmVhbShu\nZXcgRmlsZShkaXIsICJsYXN0SWQiKSk7CiAgICAgICAgQnVmZmVyZWRXcml0\nZXIgYncgPSBuZXcgQnVmZmVyZWRXcml0ZXIobmV3IE91dHB1dFN0cmVhbVdy\naXRlcihmb3MsIFVURl84KSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYncud3JpdGUoTG9uZy50b0hleFN0cmluZyhsb2dJZCkgKyAiXG4iKTsKICAg\nICAgICAgICAgYncuZmx1c2goKTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYncuY2xvc2UoKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgTE9HLmVycm9yKCJDb3VsZCBub3QgY2xvc2UgbGFzdElkIGZpbGUg\naW4ge30iLCBkaXIuZ2V0UGF0aCgpKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICBwcml2YXRlIGxvbmcgZ2V0TGFzdExvZ0lkKEZpbGUg\nZGlyKSB7CiAgICAgICAgbG9uZyBpZCA9IHJlYWRMYXN0TG9nSWQoZGlyKTsK\nICAgICAgICAvLyByZWFkIHN1Y2Nlc3MKICAgICAgICBpZiAoaWQgPiAwKSB7\nCiAgICAgICAgICAgIHJldHVybiBpZDsKICAgICAgICB9CiAgICAgICAgLy8g\ncmVhZCBmYWlsZWQsIHNjYW4gdGhlIGxlZGdlciBkaXJlY3RvcmllcyB0byBm\naW5kIGJpZ2dlc3QgbG9nIGlkCiAgICAgICAgRmlsZVtdIGxvZ0ZpbGVzID0g\nZGlyLmxpc3RGaWxlcyhuZXcgRmlsZUZpbHRlcigpIHsKICAgICAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIGFjY2VwdChG\naWxlIGZpbGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmaWxlLmdldE5h\nbWUoKS5lbmRzV2l0aCgiLmxvZyIpOwogICAgICAgICAgICB9CiAgICAgICAg\nfSk7CiAgICAgICAgTGlzdDxMb25nPiBsb2dzID0gbmV3IEFycmF5TGlzdDxM\nb25nPigpOwogICAgICAgIGZvciAoRmlsZSBsZiA6IGxvZ0ZpbGVzKSB7CiAg\nICAgICAgICAgIFN0cmluZyBpZFN0cmluZyA9IGxmLmdldE5hbWUoKS5zcGxp\ndCgiXFwuIilbMF07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBsb25nIGxpZCA9IExvbmcucGFyc2VMb25nKGlkU3RyaW5nLCAxNik7CiAg\nICAgICAgICAgICAgICBsb2dzLmFkZChsaWQpOwogICAgICAgICAgICB9IGNh\ndGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gbmZlKSB7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgLy8gbm8gbG9nIGZpbGUgZm91bmQgaW4g\ndGhpcyBkaXJlY3RvcnkKICAgICAgICBpZiAoMCA9PSBsb2dzLnNpemUoKSkg\newogICAgICAgICAgICByZXR1cm4gSU5WQUxJRF9MSUQ7CiAgICAgICAgfQog\nICAgICAgIC8vIG9yZGVyIHRoZSBjb2xsZWN0aW9ucwogICAgICAgIENvbGxl\nY3Rpb25zLnNvcnQobG9ncyk7CiAgICAgICAgcmV0dXJuIGxvZ3MuZ2V0KGxv\nZ3Muc2l6ZSgpIC0gMSk7CiAgICB9CgogICAgLyoqCiAgICAgKiByZWFkcyBp\nZCBmcm9tIHRoZSAibGFzdElkIiBmaWxlIGluIHRoZSBnaXZlbiBkaXJlY3Rv\ncnkuCiAgICAgKi8KICAgIHByaXZhdGUgbG9uZyByZWFkTGFzdExvZ0lkKEZp\nbGUgZikgewogICAgICAgIEZpbGVJbnB1dFN0cmVhbSBmaXM7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgZmlzID0gbmV3IEZpbGVJbnB1dFN0cmVhbShu\nZXcgRmlsZShmLCAibGFzdElkIikpOwogICAgICAgIH0gY2F0Y2ggKEZpbGVO\nb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHJldHVybiBJTlZB\nTElEX0xJRDsKICAgICAgICB9CiAgICAgICAgQnVmZmVyZWRSZWFkZXIgYnIg\nPSBuZXcgQnVmZmVyZWRSZWFkZXIobmV3IElucHV0U3RyZWFtUmVhZGVyKGZp\ncywgVVRGXzgpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmcg\nbGFzdElkU3RyaW5nID0gYnIucmVhZExpbmUoKTsKICAgICAgICAgICAgcmV0\ndXJuIExvbmcucGFyc2VMb25nKGxhc3RJZFN0cmluZywgMTYpOwogICAgICAg\nIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgcmV0dXJu\nIElOVkFMSURfTElEOwogICAgICAgIH0gY2F0Y2goTnVtYmVyRm9ybWF0RXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgcmV0dXJuIElOVkFMSURfTElEOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBici5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBGbHVzaGVzIGFsbCByb3RhdGVkIGxvZyBjaGFubmVs\ncy4gQWZ0ZXIgbG9nIGNoYW5uZWxzIGFyZSBmbHVzaGVkLAogICAgICogbW92\nZSBsZWFzdFVuZmx1c2hlZExvZ0lkIHB0ciB0byBjdXJyZW50IGxvZ0lkLgog\nICAgICovCiAgICB2b2lkIGNoZWNrcG9pbnQoKSB0aHJvd3MgSU9FeGNlcHRp\nb24gewogICAgICAgIGZsdXNoUm90YXRlZExvZ3MoKTsKICAgIH0KCiAgICB2\nb2lkIGZsdXNoUm90YXRlZExvZ3MoKSB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIExpc3Q8QnVmZmVyZWRMb2dDaGFubmVsPiBjaGFubmVscyA9IG51\nbGw7CiAgICAgICAgbG9uZyBmbHVzaGVkTG9nSWQgPSBJTlZBTElEX0xJRDsK\nICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAgY2hh\nbm5lbHMgPSBsb2dDaGFubmVsc1RvRmx1c2g7CiAgICAgICAgICAgIGxvZ0No\nYW5uZWxzVG9GbHVzaCA9IG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChu\ndWxsID09IGNoYW5uZWxzKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICB9CiAgICAgICAgZm9yIChCdWZmZXJlZExvZ0NoYW5uZWwgY2hhbm5lbCA6\nIGNoYW5uZWxzKSB7CiAgICAgICAgICAgIGNoYW5uZWwuZmx1c2godHJ1ZSk7\nCiAgICAgICAgICAgIC8vIHNpbmNlIHRoaXMgY2hhbm5lbCBpcyBvbmx5IHVz\nZWQgZm9yIHdyaXRpbmcsIGFmdGVyIGZsdXNoaW5nIHRoZSBjaGFubmVsLAog\nICAgICAgICAgICAvLyB3ZSBoYWQgdG8gY2xvc2UgdGhlIHVuZGVybHlpbmcg\nZmlsZSBjaGFubmVsLiBPdGhlcndpc2UsIHdlIG1pZ2h0IGVuZCB1cAogICAg\nICAgICAgICAvLyBsZWFraW5nIGZkcyB3aGljaCBjYXVzZSB0aGUgZGlzayBz\ncGFjZXMgY291bGQgbm90IGJlIHJlY2xhaW1lZC4KICAgICAgICAgICAgY2xv\nc2VGaWxlQ2hhbm5lbChjaGFubmVsKTsKICAgICAgICAgICAgaWYgKGNoYW5u\nZWwuZ2V0TG9nSWQoKSA+IGZsdXNoZWRMb2dJZCkgewogICAgICAgICAgICAg\nICAgZmx1c2hlZExvZ0lkID0gY2hhbm5lbC5nZXRMb2dJZCgpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIExPRy5pbmZvKCJTeW5jZWQgZW50cnkgbG9n\nZ2VyIHt9IHRvIGRpc2suIiwgY2hhbm5lbC5nZXRMb2dJZCgpKTsKICAgICAg\nICB9CiAgICAgICAgLy8gbW92ZSB0aGUgbGVhc3RVbmZsdXNoZWRMb2dJZCBw\ndHIKICAgICAgICBsZWFzdFVuZmx1c2hlZExvZ0lkID0gZmx1c2hlZExvZ0lk\nICsgMTsKICAgIH0KCiAgICB2b2lkIGZsdXNoKCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBmbHVzaFJvdGF0ZWRMb2dzKCk7CiAgICAgICAgZmx1\nc2hDdXJyZW50TG9nKCk7CiAgICB9CgogICAgc3luY2hyb25pemVkIHZvaWQg\nZmx1c2hDdXJyZW50TG9nKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAobG9nQ2hhbm5lbCAhPSBudWxsKSB7CiAgICAgICAgICAgIGxvZ0No\nYW5uZWwuZmx1c2godHJ1ZSk7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiRmx1\nc2ggYW5kIHN5bmMgY3VycmVudCBlbnRyeSBsb2dnZXIge30uIiwgbG9nQ2hh\nbm5lbC5nZXRMb2dJZCgpKTsKICAgICAgICB9CiAgICB9CgogICAgbG9uZyBh\nZGRFbnRyeShsb25nIGxlZGdlciwgQnl0ZUJ1ZmZlciBlbnRyeSkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gYWRkRW50cnkobGVkZ2Vy\nLCBlbnRyeSwgdHJ1ZSk7CiAgICB9CgogICAgc3luY2hyb25pemVkIGxvbmcg\nYWRkRW50cnkobG9uZyBsZWRnZXIsIEJ5dGVCdWZmZXIgZW50cnksIGJvb2xl\nYW4gcm9sbExvZykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ncm9sbExvZykgewogICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGxvZyBpZiBs\nb2dTaXplTGltaXQgcmVhY2hlZCBvciBjdXJyZW50IGRpc2sgaXMgZnVsbAog\nICAgICAgICAgICBib29sZWFuIGNyZWF0ZU5ld0xvZyA9IHNob3VsZENyZWF0\nZU5ld0VudHJ5TG9nLmdldCgpOwogICAgICAgICAgICBpZiAoY3JlYXRlTmV3\nTG9nIHx8IHJlYWNoRW50cnlMb2dMaW1pdChlbnRyeS5yZW1haW5pbmcoKSAr\nIDQpKSB7CiAgICAgICAgICAgICAgICBjcmVhdGVOZXdMb2coKTsKICAgICAg\nICAgICAgICAgIC8vIFJlc2V0IHRoZSBmbGFnCiAgICAgICAgICAgICAgICBp\nZiAoY3JlYXRlTmV3TG9nKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvdWxk\nQ3JlYXRlTmV3RW50cnlMb2cuc2V0KGZhbHNlKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBCeXRlQnVmZmVy\nIGJ1ZmYgPSBCeXRlQnVmZmVyLmFsbG9jYXRlKDQpOwogICAgICAgIGJ1ZmYu\ncHV0SW50KGVudHJ5LnJlbWFpbmluZygpKTsKICAgICAgICBidWZmLmZsaXAo\nKTsKICAgICAgICBsb2dDaGFubmVsLndyaXRlKGJ1ZmYpOwogICAgICAgIGxv\nbmcgcG9zID0gbG9nQ2hhbm5lbC5wb3NpdGlvbigpOwogICAgICAgIGxvZ0No\nYW5uZWwud3JpdGUoZW50cnkpOwoKICAgICAgICByZXR1cm4gKGxvZ0NoYW5u\nZWwuZ2V0TG9nSWQoKSA8PCAzMkwpIHwgcG9zOwogICAgfQoKICAgIHN0YXRp\nYyBsb25nIGxvZ0lkRm9yT2Zmc2V0KGxvbmcgb2Zmc2V0KSB7CiAgICAgICAg\ncmV0dXJuIG9mZnNldCA+PiAzMkw7CiAgICB9CgogICAgc3luY2hyb25pemVk\nIGJvb2xlYW4gcmVhY2hFbnRyeUxvZ0xpbWl0KGxvbmcgc2l6ZSkgewogICAg\nICAgIHJldHVybiBsb2dDaGFubmVsLnBvc2l0aW9uKCkgKyBzaXplID4gbG9n\nU2l6ZUxpbWl0OwogICAgfQoKICAgIGJ5dGVbXSByZWFkRW50cnkobG9uZyBs\nZWRnZXJJZCwgbG9uZyBlbnRyeUlkLCBsb25nIGxvY2F0aW9uKSB0aHJvd3Mg\nSU9FeGNlcHRpb24sIEJvb2tpZS5Ob0VudHJ5RXhjZXB0aW9uIHsKICAgICAg\nICBsb25nIGVudHJ5TG9nSWQgPSBsb2dJZEZvck9mZnNldChsb2NhdGlvbik7\nCiAgICAgICAgbG9uZyBwb3MgPSBsb2NhdGlvbiAmIDB4ZmZmZmZmZmZMOwog\nICAgICAgIEJ5dGVCdWZmZXIgc2l6ZUJ1ZmYgPSBCeXRlQnVmZmVyLmFsbG9j\nYXRlKDQpOwogICAgICAgIHBvcyAtPSA0OyAvLyB3ZSB3YW50IHRvIGdldCB0\naGUgbGVkZ2VySWQgYW5kIGxlbmd0aCB0byBjaGVjawogICAgICAgIEJ1ZmZl\ncmVkUmVhZENoYW5uZWwgZmM7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nZmMgPSBnZXRDaGFubmVsRm9yTG9nSWQoZW50cnlMb2dJZCk7CiAgICAgICAg\nfSBjYXRjaCAoRmlsZU5vdEZvdW5kRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIG5ld2UgPSBuZXcgRmlsZU5vdEZv\ndW5kRXhjZXB0aW9uKGUuZ2V0TWVzc2FnZSgpICsgIiBmb3IgIiArIGxlZGdl\ncklkICsgIiB3aXRoIGxvY2F0aW9uICIgKyBsb2NhdGlvbik7CiAgICAgICAg\nICAgIG5ld2Uuc2V0U3RhY2tUcmFjZShlLmdldFN0YWNrVHJhY2UoKSk7CiAg\nICAgICAgICAgIHRocm93IG5ld2U7CiAgICAgICAgfQogICAgICAgIGlmIChy\nZWFkRnJvbUxvZ0NoYW5uZWwoZW50cnlMb2dJZCwgZmMsIHNpemVCdWZmLCBw\nb3MpICE9IHNpemVCdWZmLmNhcGFjaXR5KCkpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IEJvb2tpZS5Ob0VudHJ5RXhjZXB0aW9uKCJTaG9ydCByZWFkIGZy\nb20gZW50cnlsb2cgIiArIGVudHJ5TG9nSWQsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWRnZXJJZCwgZW50cnlJ\nZCk7CiAgICAgICAgfQogICAgICAgIHBvcyArPSA0OwogICAgICAgIHNpemVC\ndWZmLmZsaXAoKTsKICAgICAgICBpbnQgZW50cnlTaXplID0gc2l6ZUJ1ZmYu\nZ2V0SW50KCk7CiAgICAgICAgLy8gZW50cnlTaXplIGRvZXMgbm90IGluY2x1\nZGUgdGhlIGxlZGdlcklkCiAgICAgICAgaWYgKGVudHJ5U2l6ZSA+IE1CKSB7\nCiAgICAgICAgICAgIExPRy5lcnJvcigiU2FuaXR5IGNoZWNrIGZhaWxlZCBm\nb3IgZW50cnkgc2l6ZSBvZiAiICsgZW50cnlTaXplICsgIiBhdCBsb2NhdGlv\nbiAiICsgcG9zICsgIiBpbiAiICsgZW50cnlMb2dJZCk7CgogICAgICAgIH0K\nICAgICAgICBpZiAoZW50cnlTaXplIDwgTUlOX1NBTkVfRU5UUllfU0laRSkg\newogICAgICAgICAgICBMT0cuZXJyb3IoIlJlYWQgaW52YWxpZCBlbnRyeSBs\nZW5ndGgge30iLCBlbnRyeVNpemUpOwogICAgICAgICAgICB0aHJvdyBuZXcg\nSU9FeGNlcHRpb24oIkludmFsaWQgZW50cnkgbGVuZ3RoICIgKyBlbnRyeVNp\nemUpOwogICAgICAgIH0KICAgICAgICBieXRlIGRhdGFbXSA9IG5ldyBieXRl\nW2VudHJ5U2l6ZV07CiAgICAgICAgQnl0ZUJ1ZmZlciBidWZmID0gQnl0ZUJ1\nZmZlci53cmFwKGRhdGEpOwogICAgICAgIGludCByYyA9IHJlYWRGcm9tTG9n\nQ2hhbm5lbChlbnRyeUxvZ0lkLCBmYywgYnVmZiwgcG9zKTsKICAgICAgICBp\nZiAoIHJjICE9IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgIC8vIE5vdGUg\ndGhhdCB0aHJvd2luZyBOb0VudHJ5RXhjZXB0aW9uIGhlcmUgaW5zdGVhZCBv\nZiBJT0V4Y2VwdGlvbiBpcyBub3QKICAgICAgICAgICAgLy8gd2l0aG91dCBy\naXNrLiBJZiBhbGwgYm9va2llcyBpbiBhIHF1b3J1bSB0aHJvdyB0aGlzIHNh\nbWUgZXhjZXB0aW9uCiAgICAgICAgICAgIC8vIHRoZSBjbGllbnQgd2lsbCBh\nc3N1bWUgdGhhdCBpdCBoYXMgcmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBsZWRn\nZXIuCiAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHRoaXMgbWF5IG5vdCBiZSB0\naGUgY2FzZSwgYXMgYSB2ZXJ5IHNwZWNpZmljIGVycm9yIGNvbmRpdGlvbgog\nICAgICAgICAgICAvLyBjb3VsZCBoYXZlIG9jY3VycmVkLCB3aGVyZSB0aGUg\nbGVuZ3RoIG9mIHRoZSBlbnRyeSB3YXMgY29ycnVwdGVkIG9uIGFsbAogICAg\nICAgICAgICAvLyByZXBsaWNhcy4gSG93ZXZlciwgdGhlIGNoYW5jZSBvZiB0\naGlzIGhhcHBlbmluZyBpcyB2ZXJ5IHZlcnkgbG93LCBzbwogICAgICAgICAg\nICAvLyByZXR1cm5pbmcgTm9FbnRyeUV4Y2VwdGlvbiBpcyBtb3N0bHkgc2Fm\nZS4KICAgICAgICAgICAgdGhyb3cgbmV3IEJvb2tpZS5Ob0VudHJ5RXhjZXB0\naW9uKCJTaG9ydCByZWFkIGZvciAiICsgbGVkZ2VySWQgKyAiQCIKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgZW50\ncnlJZCArICIgaW4gIiArIGVudHJ5TG9nSWQgKyAiQCIKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgcG9zICsgIigi\nK3JjKyIhPSIrZGF0YS5sZW5ndGgrIikiLCBsZWRnZXJJZCwgZW50cnlJZCk7\nCiAgICAgICAgfQogICAgICAgIGJ1ZmYuZmxpcCgpOwogICAgICAgIGxvbmcg\ndGhpc0xlZGdlcklkID0gYnVmZi5nZXRMb25nKCk7CiAgICAgICAgaWYgKHRo\naXNMZWRnZXJJZCAhPSBsZWRnZXJJZCkgewogICAgICAgICAgICB0aHJvdyBu\nZXcgSU9FeGNlcHRpb24oInByb2JsZW0gZm91bmQgaW4gIiArIGVudHJ5TG9n\nSWQgKyAiQCIgKyBlbnRyeUlkICsgIiBhdCBwb3NpdGlvbiArICIgKyBwb3Mg\nKyAiIGVudHJ5IGJlbG9uZ3MgdG8gIiArIHRoaXNMZWRnZXJJZCArICIgbm90\nICIgKyBsZWRnZXJJZCk7CiAgICAgICAgfQogICAgICAgIGxvbmcgdGhpc0Vu\ndHJ5SWQgPSBidWZmLmdldExvbmcoKTsKICAgICAgICBpZiAodGhpc0VudHJ5\nSWQgIT0gZW50cnlJZCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNl\ncHRpb24oInByb2JsZW0gZm91bmQgaW4gIiArIGVudHJ5TG9nSWQgKyAiQCIg\nKyBlbnRyeUlkICsgIiBhdCBwb3NpdGlvbiArICIgKyBwb3MgKyAiIGVudHJ5\nIGlzICIgKyB0aGlzRW50cnlJZCArICIgbm90ICIgKyBlbnRyeUlkKTsKICAg\nICAgICB9CgogICAgICAgIHJldHVybiBkYXRhOwogICAgfQoKICAgIHByaXZh\ndGUgQnVmZmVyZWRSZWFkQ2hhbm5lbCBnZXRDaGFubmVsRm9yTG9nSWQobG9u\nZyBlbnRyeUxvZ0lkKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIEJ1\nZmZlcmVkUmVhZENoYW5uZWwgZmMgPSBnZXRGcm9tQ2hhbm5lbHMoZW50cnlM\nb2dJZCk7CiAgICAgICAgaWYgKGZjICE9IG51bGwpIHsKICAgICAgICAgICAg\ncmV0dXJuIGZjOwogICAgICAgIH0KICAgICAgICBGaWxlIGZpbGUgPSBmaW5k\nRmlsZShlbnRyeUxvZ0lkKTsKICAgICAgICAvLyBnZXQgY2hhbm5lbCBpcyB1\nc2VkIHRvIG9wZW4gYW4gZXhpc3RpbmcgZW50cnkgbG9nIGZpbGUKICAgICAg\nICAvLyBpdCB3b3VsZCBiZSBiZXR0ZXIgdG8gb3BlbiB1c2luZyByZWFkIG1v\nZGUKICAgICAgICBGaWxlQ2hhbm5lbCBuZXdGYyA9IG5ldyBSYW5kb21BY2Nl\nc3NGaWxlKGZpbGUsICJyIikuZ2V0Q2hhbm5lbCgpOwogICAgICAgIEZpbGVD\naGFubmVsIG9sZEZjID0gbG9naWQyRmlsZUNoYW5uZWwucHV0SWZBYnNlbnQo\nZW50cnlMb2dJZCwgbmV3RmMpOwogICAgICAgIGlmIChudWxsICE9IG9sZEZj\nKSB7CiAgICAgICAgICAgIG5ld0ZjLmNsb3NlKCk7CiAgICAgICAgICAgIG5l\nd0ZjID0gb2xkRmM7CiAgICAgICAgfQogICAgICAgIC8vIFdlIHNldCB0aGUg\ncG9zaXRpb24gb2YgdGhlIHdyaXRlIGJ1ZmZlciBvZiB0aGlzIGJ1ZmZlcmVk\nIGNoYW5uZWwgdG8gTG9uZy5NQVhfVkFMVUUKICAgICAgICAvLyBzbyB0aGF0\nIHRoZXJlIGFyZSBubyBvdmVybGFwcyB3aXRoIHRoZSB3cml0ZSBidWZmZXIg\nd2hpbGUgcmVhZGluZwogICAgICAgIGZjID0gbmV3IEJ1ZmZlcmVkUmVhZENo\nYW5uZWwobmV3RmMsIGNvbmYuZ2V0UmVhZEJ1ZmZlckJ5dGVzKCkpOwogICAg\nICAgIHB1dEluUmVhZENoYW5uZWxzKGVudHJ5TG9nSWQsIGZjKTsKICAgICAg\nICByZXR1cm4gZmM7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRo\nZSBsb2cgZmlsZSBleGlzdHMgb3Igbm90LgogICAgICovCiAgICBib29sZWFu\nIGxvZ0V4aXN0cyhsb25nIGxvZ0lkKSB7CiAgICAgICAgZm9yIChGaWxlIGQg\nOiBsZWRnZXJEaXJzTWFuYWdlci5nZXRBbGxMZWRnZXJEaXJzKCkpIHsKICAg\nICAgICAgICAgRmlsZSBmID0gbmV3IEZpbGUoZCwgTG9uZy50b0hleFN0cmlu\nZyhsb2dJZCkgKyAiLmxvZyIpOwogICAgICAgICAgICBpZiAoZi5leGlzdHMo\nKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAg\nIHByaXZhdGUgRmlsZSBmaW5kRmlsZShsb25nIGxvZ0lkKSB0aHJvd3MgRmls\nZU5vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBmb3IgKEZpbGUgZCA6IGxl\nZGdlckRpcnNNYW5hZ2VyLmdldEFsbExlZGdlckRpcnMoKSkgewogICAgICAg\nICAgICBGaWxlIGYgPSBuZXcgRmlsZShkLCBMb25nLnRvSGV4U3RyaW5nKGxv\nZ0lkKSsiLmxvZyIpOwogICAgICAgICAgICBpZiAoZi5leGlzdHMoKSkgewog\nICAgICAgICAgICAgICAgcmV0dXJuIGY7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgdGhyb3cgbmV3IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbigi\nTm8gZmlsZSBmb3IgbG9nICIgKyBMb25nLnRvSGV4U3RyaW5nKGxvZ0lkKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTY2FuIGVudHJ5IGxvZwogICAgICoK\nICAgICAqIEBwYXJhbSBlbnRyeUxvZ0lkCiAgICAgKiAgICAgICAgICBFbnRy\neSBMb2cgSWQKICAgICAqIEBwYXJhbSBzY2FubmVyCiAgICAgKiAgICAgICAg\nICBFbnRyeSBMb2cgU2Nhbm5lcgogICAgICogQHRocm93cyBJT0V4Y2VwdGlv\nbgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzY2FuRW50cnlMb2cobG9u\nZyBlbnRyeUxvZ0lkLCBFbnRyeUxvZ1NjYW5uZXIgc2Nhbm5lcikgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBCeXRlQnVmZmVyIHNpemVCdWZmID0g\nQnl0ZUJ1ZmZlci5hbGxvY2F0ZSg0KTsKICAgICAgICBCeXRlQnVmZmVyIGxp\nZEJ1ZmYgPSBCeXRlQnVmZmVyLmFsbG9jYXRlKDgpOwogICAgICAgIEJ1ZmZl\ncmVkUmVhZENoYW5uZWwgYmM7CiAgICAgICAgLy8gR2V0IHRoZSBCdWZmZXJl\nZENoYW5uZWwgZm9yIHRoZSBjdXJyZW50IGVudHJ5IGxvZyBmaWxlCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgYmMgPSBnZXRDaGFubmVsRm9yTG9nSWQo\nZW50cnlMb2dJZCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkg\newogICAgICAgICAgICBMT0cud2FybigiRmFpbGVkIHRvIGdldCBjaGFubmVs\nIHRvIHNjYW4gZW50cnkgbG9nOiAiICsgZW50cnlMb2dJZCArICIubG9nIik7\nCiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfQogICAgICAgIC8vIFN0\nYXJ0IHRoZSByZWFkIHBvc2l0aW9uIGluIHRoZSBjdXJyZW50IGVudHJ5IGxv\nZyBmaWxlIHRvIGJlIGFmdGVyCiAgICAgICAgLy8gdGhlIGhlYWRlciB3aGVy\nZSBhbGwgb2YgdGhlIGxlZGdlciBlbnRyaWVzIGFyZS4KICAgICAgICBsb25n\nIHBvcyA9IExPR0ZJTEVfSEVBREVSX1NJWkU7CiAgICAgICAgLy8gUmVhZCB0\naHJvdWdoIHRoZSBlbnRyeSBsb2cgZmlsZSBhbmQgZXh0cmFjdCB0aGUgbGVk\nZ2VyIElEJ3MuCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAg\nLy8gQ2hlY2sgaWYgd2UndmUgZmluaXNoZWQgcmVhZGluZyB0aGUgZW50cnkg\nbG9nIGZpbGUuCiAgICAgICAgICAgIGlmIChwb3MgPj0gYmMuc2l6ZSgpKSB7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBpZiAocmVhZEZyb21Mb2dDaGFubmVsKGVudHJ5TG9nSWQsIGJjLCBz\naXplQnVmZiwgcG9zKSAhPSBzaXplQnVmZi5jYXBhY2l0eSgpKSB7CiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIlNob3J0IHJlYWQg\nZm9yIGVudHJ5IHNpemUgZnJvbSBlbnRyeWxvZyAiICsgZW50cnlMb2dJZCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9uZyBvZmZzZXQgPSBwb3M7\nCiAgICAgICAgICAgIHBvcyArPSA0OwogICAgICAgICAgICBzaXplQnVmZi5m\nbGlwKCk7CiAgICAgICAgICAgIGludCBlbnRyeVNpemUgPSBzaXplQnVmZi5n\nZXRJbnQoKTsKICAgICAgICAgICAgaWYgKGVudHJ5U2l6ZSA+IE1CKSB7CiAg\nICAgICAgICAgICAgICBMT0cud2FybigiRm91bmQgbGFyZ2Ugc2l6ZSBlbnRy\neSBvZiAiICsgZW50cnlTaXplICsgIiBhdCBsb2NhdGlvbiAiICsgcG9zICsg\nIiBpbiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgZW50cnlMb2dJZCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2l6ZUJ1ZmYuY2xlYXIoKTsK\nICAgICAgICAgICAgLy8gdHJ5IHRvIHJlYWQgbGVkZ2VyIGlkIGZpcnN0CiAg\nICAgICAgICAgIGlmIChyZWFkRnJvbUxvZ0NoYW5uZWwoZW50cnlMb2dJZCwg\nYmMsIGxpZEJ1ZmYsIHBvcykgIT0gbGlkQnVmZi5jYXBhY2l0eSgpKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIlNob3J0IHJl\nYWQgZm9yIGxlZGdlciBpZCBmcm9tIGVudHJ5bG9nICIgKyBlbnRyeUxvZ0lk\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsaWRCdWZmLmZsaXAoKTsK\nICAgICAgICAgICAgbG9uZyBsaWQgPSBsaWRCdWZmLmdldExvbmcoKTsKICAg\nICAgICAgICAgbGlkQnVmZi5jbGVhcigpOwogICAgICAgICAgICBpZiAoIXNj\nYW5uZXIuYWNjZXB0KGxpZCkpIHsKICAgICAgICAgICAgICAgIC8vIHNraXAg\ndGhpcyBlbnRyeQogICAgICAgICAgICAgICAgcG9zICs9IGVudHJ5U2l6ZTsK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIC8vIHJlYWQgdGhlIGVudHJ5CiAgICAgICAgICAgIGJ5dGUgZGF0\nYVtdID0gbmV3IGJ5dGVbZW50cnlTaXplXTsKICAgICAgICAgICAgQnl0ZUJ1\nZmZlciBidWZmID0gQnl0ZUJ1ZmZlci53cmFwKGRhdGEpOwogICAgICAgICAg\nICBpbnQgcmMgPSByZWFkRnJvbUxvZ0NoYW5uZWwoZW50cnlMb2dJZCwgYmMs\nIGJ1ZmYsIHBvcyk7CiAgICAgICAgICAgIGlmIChyYyAhPSBkYXRhLmxlbmd0\naCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJT\naG9ydCByZWFkIGZvciBsZWRnZXIgZW50cnkgZnJvbSBlbnRyeUxvZyAiICsg\nZW50cnlMb2dJZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICArICJAIiArIHBvcyArICIoIiArIHJjICsgIiE9IiArIGRhdGEubGVuZ3Ro\nICsgIikiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWZmLmZsaXAo\nKTsKICAgICAgICAgICAgLy8gcHJvY2VzcyB0aGUgZW50cnkKICAgICAgICAg\nICAgc2Nhbm5lci5wcm9jZXNzKGxpZCwgb2Zmc2V0LCBidWZmKTsKICAgICAg\nICAgICAgLy8gQWR2YW5jZSBwb3NpdGlvbiB0byB0aGUgbmV4dCBlbnRyeQog\nICAgICAgICAgICBwb3MgKz0gZW50cnlTaXplOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFNodXRkb3duIG1ldGhvZCB0byBncmFjZWZ1bGx5\nIHN0b3AgZW50cnkgbG9nZ2VyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\naHV0ZG93bigpIHsKICAgICAgICAvLyBzaW5jZSBsb2dDaGFubmVsIGlzIGJ1\nZmZlcmVkIGNoYW5uZWwsIGRvIGZsdXNoIHdoZW4gc2h1dHRpbmcgZG93bgog\nICAgICAgIExPRy5pbmZvKCJTdG9wcGluZyBFbnRyeUxvZ2dlciIpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIGZsdXNoKCk7CiAgICAgICAgICAgIGZv\nciAoRmlsZUNoYW5uZWwgZmMgOiBsb2dpZDJGaWxlQ2hhbm5lbC52YWx1ZXMo\nKSkgewogICAgICAgICAgICAgICAgZmMuY2xvc2UoKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICAvLyBjbGVhciB0aGUgbWFwcGluZywgc28gd2UgZG9u\nJ3QgbmVlZCB0byBnbyB0aHJvdWdoIHRoZSBjaGFubmVscyBhZ2FpbiBpbiBm\naW5hbGx5IGJsb2NrIGluIG5vcm1hbCBjYXNlLgogICAgICAgICAgICBsb2dp\nZDJGaWxlQ2hhbm5lbC5jbGVhcigpOwogICAgICAgICAgICAvLyBjbG9zZSBj\ndXJyZW50IHdyaXRpbmcgbG9nIGZpbGUKICAgICAgICAgICAgY2xvc2VGaWxl\nQ2hhbm5lbChsb2dDaGFubmVsKTsKICAgICAgICAgICAgbG9nQ2hhbm5lbCA9\nIG51bGw7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaWUpIHsKICAg\nICAgICAgICAgLy8gd2UgaGF2ZSBubyBpZGVhIGhvdyB0byBhdm9pZCBpbyBl\neGNlcHRpb24gZHVyaW5nIHNodXR0aW5nIGRvd24sIHNvIGp1c3QgaWdub3Jl\nIGl0CiAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3IgZmx1c2ggZW50cnkg\nbG9nIGR1cmluZyBzaHV0dGluZyBkb3duLCB3aGljaCBtYXkgY2F1c2UgZW50\ncnkgbG9nIGNvcnJ1cHRlZC4iLCBpZSk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgZm9yIChGaWxlQ2hhbm5lbCBmYyA6IGxvZ2lkMkZpbGVD\naGFubmVsLnZhbHVlcygpKSB7CiAgICAgICAgICAgICAgICBJT1V0aWxzLmNs\nb3NlKExPRywgZmMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvcmNl\nQ2xvc2VGaWxlQ2hhbm5lbChsb2dDaGFubmVsKTsKICAgICAgICB9CiAgICAg\nICAgLy8gc2h1dGRvd24gdGhlIHByZS1hbGxvY2F0aW9uIHRocmVhZAogICAg\nICAgIGVudHJ5TG9nZ2VyQWxsb2NhdG9yLnN0b3AoKTsKICAgIH0KCiAgICBw\ncml2YXRlIHN0YXRpYyB2b2lkIGNsb3NlRmlsZUNoYW5uZWwoQnVmZmVyZWRD\naGFubmVsQmFzZSBjaGFubmVsKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgIGlmIChudWxsID09IGNoYW5uZWwpIHsKICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIH0KICAgICAgICBGaWxlQ2hhbm5lbCBmaWxlQ2hhbm5lbCA9\nIGNoYW5uZWwuZ2V0RmlsZUNoYW5uZWwoKTsKICAgICAgICBpZiAobnVsbCAh\nPSBmaWxlQ2hhbm5lbCkgewogICAgICAgICAgICBmaWxlQ2hhbm5lbC5jbG9z\nZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyB2b2lk\nIGZvcmNlQ2xvc2VGaWxlQ2hhbm5lbChCdWZmZXJlZENoYW5uZWxCYXNlIGNo\nYW5uZWwpIHsKICAgICAgICBpZiAobnVsbCA9PSBjaGFubmVsKSB7CiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgRmlsZUNoYW5uZWwg\nZmlsZUNoYW5uZWwgPSBjaGFubmVsLmdldEZpbGVDaGFubmVsKCk7CiAgICAg\nICAgaWYgKG51bGwgIT0gZmlsZUNoYW5uZWwpIHsKICAgICAgICAgICAgSU9V\ndGlscy5jbG9zZShMT0csIGZpbGVDaGFubmVsKTsKICAgICAgICB9CiAgICB9\nCgp9Cg==\n","encoding":"base64"}

