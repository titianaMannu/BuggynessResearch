{"sha":"ad46e5cf3a826d9718ce9382d1c028ce7848fb70","node_id":"MDQ6QmxvYjE1NzU5NTY6YWQ0NmU1Y2YzYTgyNmQ5NzE4Y2U5MzgyZDFjMDI4Y2U3ODQ4ZmI3MA==","size":10398,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ad46e5cf3a826d9718ce9382d1c028ce7848fb70","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5DbG9zZWFibGU7CmltcG9ydCBqYXZhLmlvLkZpbGU7\nCmltcG9ydCBqYXZhLmlvLlJhbmRvbUFjY2Vzc0ZpbGU7CmltcG9ydCBqYXZh\nLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uaW8uY2hhbm5lbHMuRmls\nZUNoYW5uZWw7CmltcG9ydCBqYXZhLm5pby5CeXRlQnVmZmVyOwppbXBvcnQg\namF2YS51dGlsLkFycmF5czsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIudXRpbC5OYXRpdmVJTzsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci51dGlsLlplcm9CdWZmZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgc3RhdGlj\nIGNvbS5nb29nbGUuY29tbW9uLmJhc2UuQ2hhcnNldHMuVVRGXzg7CgovKioK\nICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIEZpbGVDaGFubmVsIHRvIGFkZCB2\nZXJzaW9uaW5nCiAqIGluZm9ybWF0aW9uIHRvIHRoZSBmaWxlLgogKi8KY2xh\nc3MgSm91cm5hbENoYW5uZWwgaW1wbGVtZW50cyBDbG9zZWFibGUgewogICAg\ncHJpdmF0ZSBmaW5hbCBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3Rv\ncnkuZ2V0TG9nZ2VyKEpvdXJuYWxDaGFubmVsLmNsYXNzKTsKCiAgICBmaW5h\nbCBSYW5kb21BY2Nlc3NGaWxlIHJhbmRvbUFjY2Vzc0ZpbGU7CiAgICBmaW5h\nbCBpbnQgZmQ7CiAgICBmaW5hbCBGaWxlQ2hhbm5lbCBmYzsKICAgIGZpbmFs\nIEJ1ZmZlcmVkQ2hhbm5lbCBiYzsKICAgIGZpbmFsIGludCBmb3JtYXRWZXJz\naW9uOwogICAgbG9uZyBuZXh0UHJlYWxsb2MgPSAwOwoKICAgIGZpbmFsIGJ5\ndGVbXSBNQUdJQ19XT1JEID0gIkJLTEciLmdldEJ5dGVzKFVURl84KTsKCiAg\nICBmaW5hbCBzdGF0aWMgaW50IFNFQ1RPUl9TSVpFID0gNTEyOwogICAgcHJp\ndmF0ZSBmaW5hbCBzdGF0aWMgaW50IFNUQVJUX09GX0ZJTEUgPSAtMTIzNDU7\nCiAgICBwcml2YXRlIHN0YXRpYyBsb25nIENBQ0hFX0RST1BfTEFHX0JZVEVT\nID0gOCAqIDEwMjQgKiAxMDI0OwoKICAgIC8vIE5vIGhlYWRlcgogICAgc3Rh\ndGljIGZpbmFsIGludCBWMSA9IDE7CiAgICAvLyBBZGRpbmcgaGVhZGVyCiAg\nICBzdGF0aWMgZmluYWwgaW50IFYyID0gMjsKICAgIC8vIEFkZGluZyBsZWRn\nZXIga2V5CiAgICBzdGF0aWMgZmluYWwgaW50IFYzID0gMzsKICAgIC8vIEFk\nZGluZyBmZW5jaW5nIGtleQogICAgc3RhdGljIGZpbmFsIGludCBWNCA9IDQ7\nCiAgICAvLyAxKSBleHBhbmRpbmcgaGVhZGVyIHRvIDUxMgogICAgLy8gMikg\nUGFkZGluZyB3cml0ZXMgdG8gYWxpZ24gc2VjdG9yIHNpemUKICAgIHN0YXRp\nYyBmaW5hbCBpbnQgVjUgPSA1OwoKICAgIHN0YXRpYyBmaW5hbCBpbnQgSEVB\nREVSX1NJWkUgPSBTRUNUT1JfU0laRTsgLy8gYWxpZ24gaGVhZGVyIHRvIHNl\nY3RvciBzaXplCiAgICBzdGF0aWMgZmluYWwgaW50IFZFUlNJT05fSEVBREVS\nX1NJWkUgPSA4OyAvLyA0Ynl0ZSBtYWdpYyB3b3JkLCA0IGJ5dGUgdmVyc2lv\nbgogICAgc3RhdGljIGZpbmFsIGludCBNSU5fQ09NUEFUX0pPVVJOQUxfRk9S\nTUFUX1ZFUlNJT04gPSBWMTsKICAgIHN0YXRpYyBmaW5hbCBpbnQgQ1VSUkVO\nVF9KT1VSTkFMX0ZPUk1BVF9WRVJTSU9OID0gVjU7CgogICAgcHJpdmF0ZSBm\naW5hbCBsb25nIHByZUFsbG9jU2l6ZTsKICAgIHByaXZhdGUgZmluYWwgaW50\nIGpvdXJuYWxBbGlnblNpemU7CiAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4g\nZlJlbW92ZUZyb21QYWdlQ2FjaGU7CiAgICBwdWJsaWMgZmluYWwgQnl0ZUJ1\nZmZlciB6ZXJvczsKCiAgICAvLyBUaGUgcG9zaXRpb24gb2YgdGhlIGZpbGUg\nY2hhbm5lbCdzIGxhc3QgZHJvcCBwb3NpdGlvbgogICAgcHJpdmF0ZSBsb25n\nIGxhc3REcm9wUG9zaXRpb24gPSAwTDsKCiAgICAvLyBNb3N0bHkgdXNlZCBi\neSB0ZXN0cwogICAgSm91cm5hbENoYW5uZWwoRmlsZSBqb3VybmFsRGlyZWN0\nb3J5LCBsb25nIGxvZ0lkKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAg\nIHRoaXMoam91cm5hbERpcmVjdG9yeSwgbG9nSWQsIDQgKiAxMDI0ICogMTAy\nNCwgNjU1MzYsIFNUQVJUX09GX0ZJTEUpOwogICAgfQoKICAgIC8vIE9wZW4g\nam91cm5hbCBmb3Igc2Nhbm5pbmcgc3RhcnRpbmcgZnJvbSB0aGUgZmlyc3Qg\ncmVjb3JkIGluIGpvdXJuYWwuCiAgICBKb3VybmFsQ2hhbm5lbChGaWxlIGpv\ndXJuYWxEaXJlY3RvcnksIGxvbmcgbG9nSWQsIGxvbmcgcHJlQWxsb2NTaXpl\nLCBpbnQgd3JpdGVCdWZmZXJTaXplKSB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIHRoaXMoam91cm5hbERpcmVjdG9yeSwgbG9nSWQsIHByZUFsbG9j\nU2l6ZSwgd3JpdGVCdWZmZXJTaXplLCBTVEFSVF9PRl9GSUxFKTsKICAgIH0K\nCiAgICAvLyBPcGVuIGpvdXJuYWwgZm9yIHNjYW5uaW5nIHN0YXJ0aW5nIGZy\nb20gZ2l2ZW4gcG9zaXRpb24uCiAgICBKb3VybmFsQ2hhbm5lbChGaWxlIGpv\ndXJuYWxEaXJlY3RvcnksIGxvbmcgbG9nSWQsCiAgICAgICAgICAgICAgICAg\nICBsb25nIHByZUFsbG9jU2l6ZSwgaW50IHdyaXRlQnVmZmVyU2l6ZSwgbG9u\nZyBwb3NpdGlvbikgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgdGhp\ncyhqb3VybmFsRGlyZWN0b3J5LCBsb2dJZCwgcHJlQWxsb2NTaXplLCB3cml0\nZUJ1ZmZlclNpemUsIFNFQ1RPUl9TSVpFLCBwb3NpdGlvbiwgZmFsc2UsIFY1\nKTsKICAgIH0KCiAgICAvLyBPcGVuIGpvdXJuYWwgdG8gd3JpdGUKICAgIEpv\ndXJuYWxDaGFubmVsKEZpbGUgam91cm5hbERpcmVjdG9yeSwgbG9uZyBsb2dJ\nZCwKICAgICAgICAgICAgICAgICAgIGxvbmcgcHJlQWxsb2NTaXplLCBpbnQg\nd3JpdGVCdWZmZXJTaXplLCBpbnQgam91cm5hbEFsaWduU2l6ZSwKICAgICAg\nICAgICAgICAgICAgIGJvb2xlYW4gZlJlbW92ZUZyb21QYWdlQ2FjaGUsIGlu\ndCBmb3JtYXRWZXJzaW9uVG9Xcml0ZSkgdGhyb3dzIElPRXhjZXB0aW9uIHsK\nICAgICAgICB0aGlzKGpvdXJuYWxEaXJlY3RvcnksIGxvZ0lkLCBwcmVBbGxv\nY1NpemUsIHdyaXRlQnVmZmVyU2l6ZSwgam91cm5hbEFsaWduU2l6ZSwKICAg\nICAgICAgICAgIFNUQVJUX09GX0ZJTEUsIGZSZW1vdmVGcm9tUGFnZUNhY2hl\nLCBmb3JtYXRWZXJzaW9uVG9Xcml0ZSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDcmVhdGUgYSBqb3VybmFsIGZpbGUuCiAgICAgKgogICAgICogQHBhcmFt\nIGpvdXJuYWxEaXJlY3RvcnkKICAgICAqICAgICAgICAgIGRpcmVjdG9yeSB0\nbyBzdG9yZSB0aGUgam91cm5hbCBmaWxlLgogICAgICogQHBhcmFtIGxvZ0lk\nCiAgICAgKiAgICAgICAgICBsb2cgaWQgZm9yIHRoZSBqb3VybmFsIGZpbGUu\nCiAgICAgKiBAcGFyYW0gcHJlQWxsb2NTaXplCiAgICAgKiAgICAgICAgICBw\ncmUgYWxsb2NhdGlvbiBzaXplLgogICAgICogQHBhcmFtIHdyaXRlQnVmZmVy\nU2l6ZQogICAgICogICAgICAgICAgd3JpdGUgYnVmZmVyIHNpemUuCiAgICAg\nKiBAcGFyYW0gam91cm5hbEFsaWduU2l6ZQogICAgICogICAgICAgICAgc2l6\nZSB0byBhbGlnbiBqb3VybmFsIHdyaXRlcy4KICAgICAqIEBwYXJhbSBwb3Np\ndGlvbgogICAgICogICAgICAgICAgcG9zaXRpb24gdG8gc3RhcnQgcmVhZC93\ncml0ZQogICAgICogQHBhcmFtIGZSZW1vdmVGcm9tUGFnZUNhY2hlCiAgICAg\nKiAgICAgICAgICB3aGV0aGVyIHRvIHJlbW92ZSBjYWNoZWQgcGFnZXMgZnJv\nbSBwYWdlIGNhY2hlLgogICAgICogQHBhcmFtIGZvcm1hdFZlcnNpb25Ub1dy\naXRlCiAgICAgKiAgICAgICAgICBmb3JtYXQgdmVyc2lvbiB0byB3cml0ZQog\nICAgICogQHRocm93cyBJT0V4Y2VwdGlvbgogICAgICovCiAgICBwcml2YXRl\nIEpvdXJuYWxDaGFubmVsKEZpbGUgam91cm5hbERpcmVjdG9yeSwgbG9uZyBs\nb2dJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBwcmVBbGxv\nY1NpemUsIGludCB3cml0ZUJ1ZmZlclNpemUsIGludCBqb3VybmFsQWxpZ25T\naXplLAogICAgICAgICAgICAgICAgICAgICAgICAgICBsb25nIHBvc2l0aW9u\nLCBib29sZWFuIGZSZW1vdmVGcm9tUGFnZUNhY2hlLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICBpbnQgZm9ybWF0VmVyc2lvblRvV3JpdGUpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgdGhpcy5qb3VybmFsQWxpZ25TaXpl\nID0gam91cm5hbEFsaWduU2l6ZTsKICAgICAgICB0aGlzLnplcm9zID0gQnl0\nZUJ1ZmZlci5hbGxvY2F0ZShqb3VybmFsQWxpZ25TaXplKTsKICAgICAgICB0\naGlzLnByZUFsbG9jU2l6ZSA9IHByZUFsbG9jU2l6ZSAtIHByZUFsbG9jU2l6\nZSAlIGpvdXJuYWxBbGlnblNpemU7CiAgICAgICAgdGhpcy5mUmVtb3ZlRnJv\nbVBhZ2VDYWNoZSA9IGZSZW1vdmVGcm9tUGFnZUNhY2hlOwogICAgICAgIEZp\nbGUgZm4gPSBuZXcgRmlsZShqb3VybmFsRGlyZWN0b3J5LCBMb25nLnRvSGV4\nU3RyaW5nKGxvZ0lkKSArICIudHhuIik7CgogICAgICAgIGlmIChmb3JtYXRW\nZXJzaW9uVG9Xcml0ZSA8IFY0KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbigiSW52YWxpZCBqb3VybmFsIGZvcm1hdCB0byB3cml0ZSA6\nIHZlcnNpb24gPSAiICsgZm9ybWF0VmVyc2lvblRvV3JpdGUpOwogICAgICAg\nIH0KCiAgICAgICAgTE9HLmluZm8oIk9wZW5pbmcgam91cm5hbCB7fSIsIGZu\nKTsKICAgICAgICBpZiAoIWZuLmV4aXN0cygpKSB7IC8vIG5ldyBmaWxlLCB3\ncml0ZSB2ZXJzaW9uCiAgICAgICAgICAgIGlmICghZm4uY3JlYXRlTmV3Rmls\nZSgpKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkpvdXJuYWwgZmls\nZSB7fSwgdGhhdCBzaG91bGRuJ3QgZXhpc3QsIGFscmVhZHkgZXhpc3RzLiAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGlzIHRoZXJlIGFub3Ro\nZXIgYm9va2llIHByb2Nlc3MgcnVubmluZz8iLCBmbik7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkZpbGUgIiArIGZuCiAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiBzdWRkZW5seSBhcHBlYXJlZCwgaXMg\nYW5vdGhlciBib29raWUgcHJvY2VzcyBydW5uaW5nPyIpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHJhbmRvbUFjY2Vzc0ZpbGUgPSBuZXcgUmFuZG9t\nQWNjZXNzRmlsZShmbiwgInJ3Iik7CiAgICAgICAgICAgIGZjID0gcmFuZG9t\nQWNjZXNzRmlsZS5nZXRDaGFubmVsKCk7CiAgICAgICAgICAgIGZvcm1hdFZl\ncnNpb24gPSBmb3JtYXRWZXJzaW9uVG9Xcml0ZTsKCiAgICAgICAgICAgIGlu\ndCBoZWFkZXJTaXplID0gKFY0ID09IGZvcm1hdFZlcnNpb24pID8gVkVSU0lP\nTl9IRUFERVJfU0laRSA6IEhFQURFUl9TSVpFOwogICAgICAgICAgICBCeXRl\nQnVmZmVyIGJiID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZShoZWFkZXJTaXplKTsK\nICAgICAgICAgICAgWmVyb0J1ZmZlci5wdXQoYmIpOwogICAgICAgICAgICBi\nYi5jbGVhcigpOwogICAgICAgICAgICBiYi5wdXQoTUFHSUNfV09SRCk7CiAg\nICAgICAgICAgIGJiLnB1dEludChmb3JtYXRWZXJzaW9uKTsKICAgICAgICAg\nICAgYmIuY2xlYXIoKTsKICAgICAgICAgICAgZmMud3JpdGUoYmIpOwoKICAg\nICAgICAgICAgYmMgPSBuZXcgQnVmZmVyZWRDaGFubmVsKGZjLCB3cml0ZUJ1\nZmZlclNpemUpOwogICAgICAgICAgICBmb3JjZVdyaXRlKHRydWUpOwogICAg\nICAgICAgICBuZXh0UHJlYWxsb2MgPSB0aGlzLnByZUFsbG9jU2l6ZTsKICAg\nICAgICAgICAgZmMud3JpdGUoemVyb3MsIG5leHRQcmVhbGxvYyAtIGpvdXJu\nYWxBbGlnblNpemUpOwogICAgICAgIH0gZWxzZSB7ICAvLyBvcGVuIGFuIGV4\naXN0aW5nIGZpbGUKICAgICAgICAgICAgcmFuZG9tQWNjZXNzRmlsZSA9IG5l\ndyBSYW5kb21BY2Nlc3NGaWxlKGZuLCAiciIpOwogICAgICAgICAgICBmYyA9\nIHJhbmRvbUFjY2Vzc0ZpbGUuZ2V0Q2hhbm5lbCgpOwogICAgICAgICAgICBi\nYyA9IG51bGw7IC8vIHJlYWRvbmx5CgogICAgICAgICAgICBCeXRlQnVmZmVy\nIGJiID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZShWRVJTSU9OX0hFQURFUl9TSVpF\nKTsKICAgICAgICAgICAgaW50IGMgPSBmYy5yZWFkKGJiKTsKICAgICAgICAg\nICAgYmIuZmxpcCgpOwoKICAgICAgICAgICAgaWYgKGMgPT0gVkVSU0lPTl9I\nRUFERVJfU0laRSkgewogICAgICAgICAgICAgICAgYnl0ZVtdIGZpcnN0NCA9\nIG5ldyBieXRlWzRdOwogICAgICAgICAgICAgICAgYmIuZ2V0KGZpcnN0NCk7\nCgogICAgICAgICAgICAgICAgaWYgKEFycmF5cy5lcXVhbHMoZmlyc3Q0LCBN\nQUdJQ19XT1JEKSkgewogICAgICAgICAgICAgICAgICAgIGZvcm1hdFZlcnNp\nb24gPSBiYi5nZXRJbnQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgLy8gcHJlIG1hZ2ljIHdvcmQgam91cm5hbCwg\ncmVzZXQgdG8gMDsKICAgICAgICAgICAgICAgICAgICBmb3JtYXRWZXJzaW9u\nID0gVjE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAvLyBubyBoZWFkZXIsIG11c3QgYmUgb2xkIHZl\ncnNpb24KICAgICAgICAgICAgICAgIGZvcm1hdFZlcnNpb24gPSBWMTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGZvcm1hdFZlcnNpb24gPCBN\nSU5fQ09NUEFUX0pPVVJOQUxfRk9STUFUX1ZFUlNJT04KICAgICAgICAgICAg\nICAgIHx8IGZvcm1hdFZlcnNpb24gPiBDVVJSRU5UX0pPVVJOQUxfRk9STUFU\nX1ZFUlNJT04pIHsKICAgICAgICAgICAgICAgIFN0cmluZyBlcnIgPSBTdHJp\nbmcuZm9ybWF0KCJJbnZhbGlkIGpvdXJuYWwgdmVyc2lvbiwgdW5hYmxlIHRv\nIHJlYWQuIgogICAgICAgICAgICAgICAgICAgICAgICArICIgRXhwZWN0ZWQg\nYmV0d2VlbiAoJWQpIGFuZCAoJWQpLCBnb3QgKCVkKSIsCiAgICAgICAgICAg\nICAgICAgICAgICAgIE1JTl9DT01QQVRfSk9VUk5BTF9GT1JNQVRfVkVSU0lP\nTiwgQ1VSUkVOVF9KT1VSTkFMX0ZPUk1BVF9WRVJTSU9OLAogICAgICAgICAg\nICAgICAgICAgICAgICBmb3JtYXRWZXJzaW9uKTsKICAgICAgICAgICAgICAg\nIExPRy5lcnJvcihlcnIpOwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElP\nRXhjZXB0aW9uKGVycik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBpZiAocG9zaXRpb24gPT0gU1RBUlRfT0Zf\nRklMRSkgewogICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXRWZXJzaW9u\nID49IFY1KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZjLnBvc2l0aW9u\nKEhFQURFUl9TSVpFKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYg\nKGZvcm1hdFZlcnNpb24gPj0gVjIpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgZmMucG9zaXRpb24oVkVSU0lPTl9IRUFERVJfU0laRSk7CiAgICAgICAg\nICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nZmMucG9zaXRpb24oMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBmYy5wb3Np\ndGlvbihwb3NpdGlvbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIExP\nRy5lcnJvcigiQm9va2llIGpvdXJuYWwgZmlsZSBjYW4gc2VlayB0byBwb3Np\ndGlvbiA6IiwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\ndGhpcy5mZCA9IE5hdGl2ZUlPLmdldFN5c0ZpbGVEZXNjcmlwdG9yKHJhbmRv\nbUFjY2Vzc0ZpbGUuZ2V0RkQoKSk7CiAgICB9CgogICAgaW50IGdldEZvcm1h\ndFZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdFZlcnNpb247CiAg\nICB9CgogICAgQnVmZmVyZWRDaGFubmVsIGdldEJ1ZmZlcmVkQ2hhbm5lbCgp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGJjID09IG51bGwp\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJSZWFkIG9u\nbHkgam91cm5hbCBjaGFubmVsIik7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBiYzsKICAgIH0KCiAgICB2b2lkIHByZUFsbG9jSWZOZWVkZWQobG9uZyBz\naXplKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChiYy5wb3Np\ndGlvbigpICsgc2l6ZSA+IG5leHRQcmVhbGxvYykgewogICAgICAgICAgICBu\nZXh0UHJlYWxsb2MgKz0gcHJlQWxsb2NTaXplOwogICAgICAgICAgICB6ZXJv\ncy5jbGVhcigpOwogICAgICAgICAgICBmYy53cml0ZSh6ZXJvcywgbmV4dFBy\nZWFsbG9jIC0gam91cm5hbEFsaWduU2l6ZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIGludCByZWFkKEJ5dGVCdWZmZXIgZHN0KQogICAgICAgICAgICB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIHJldHVybiBmYy5yZWFkKGRzdCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIGZjLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgZm9yY2VXcml0ZShib29sZWFuIGZvcmNlTWV0YWRhdGEpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiSm91cm5hbCBGb3JjZVdy\naXRlIik7CiAgICAgICAgfQogICAgICAgIGxvbmcgbmV3Rm9yY2VXcml0ZVBv\nc2l0aW9uID0gYmMuZm9yY2VXcml0ZShmb3JjZU1ldGFkYXRhKTsKICAgICAg\nICAvLwogICAgICAgIC8vIEZvciBQT1NJWF9GQURWX0RPTlRORUVELCB3ZSB3\nYW50IHRvIGRyb3AgZnJvbSB0aGUgYmVnaW5uaW5nCiAgICAgICAgLy8gb2Yg\ndGhlIGZpbGUgdG8gYSBwb3NpdGlvbiBwcmlvciB0byB0aGUgY3VycmVudCBw\nb3NpdGlvbi4KICAgICAgICAvLwogICAgICAgIC8vIFRoZSBDQUNIRV9EUk9Q\nX0xBR19CWVRFUyBpcyB0byBwcmV2ZW50IGRyb3BwaW5nIGEgcGFnZSB0aGF0\nIHdpbGwKICAgICAgICAvLyBiZSBhcHBlbmRlZCBhZ2Fpbiwgd2hpY2ggd291\nbGQgaW50cm9kdWNlIHJhbmRvbSBzZWVraW5nIG9uIGpvdXJuYWwKICAgICAg\nICAvLyBkZXZpY2UuCiAgICAgICAgLy8KICAgICAgICAvLyA8PT09PT09PT0g\nZHJvcCA9PT09PT09PT09PgogICAgICAgIC8vICAgICAgICAgICAgICAgICAg\nICAgICAgICAgPC0tLS0tLS0tLS0tTEFHLS0tLS0tLS0tLS0tPgogICAgICAg\nIC8vICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0t\nLS0tLS0tLS0tLS0tTwogICAgICAgIC8vIGxhc3REcm9wUG9zaXRpb24gICAg\nIG5ld0Ryb3BQb3MgICAgICAgICAgICAgbGFzdEZvcmNlV3JpdGVQb3NpdGlv\nbgogICAgICAgIC8vCiAgICAgICAgaWYgKGZSZW1vdmVGcm9tUGFnZUNhY2hl\nKSB7CiAgICAgICAgICAgIGxvbmcgbmV3RHJvcFBvcyA9IG5ld0ZvcmNlV3Jp\ndGVQb3NpdGlvbiAtIENBQ0hFX0RST1BfTEFHX0JZVEVTOwogICAgICAgICAg\nICBpZiAobGFzdERyb3BQb3NpdGlvbiA8IG5ld0Ryb3BQb3MpIHsKICAgICAg\nICAgICAgICAgIE5hdGl2ZUlPLmJlc3RFZmZvcnRSZW1vdmVGcm9tUGFnZUNh\nY2hlKGZkLCBsYXN0RHJvcFBvc2l0aW9uLCBuZXdEcm9wUG9zIC0gbGFzdERy\nb3BQb3NpdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5s\nYXN0RHJvcFBvc2l0aW9uID0gbmV3RHJvcFBvczsKICAgICAgICB9CiAgICB9\nCn0K\n","encoding":"base64"}

