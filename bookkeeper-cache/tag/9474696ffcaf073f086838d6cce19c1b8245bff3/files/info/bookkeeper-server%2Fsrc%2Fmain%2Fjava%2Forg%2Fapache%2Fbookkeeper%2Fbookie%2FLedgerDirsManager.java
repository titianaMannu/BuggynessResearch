{"sha":"935befb2fd73d07ce2bee150773f9a9705b0df35","node_id":"MDQ6QmxvYjE1NzU5NTY6OTM1YmVmYjJmZDczZDA3Y2UyYmVlMTUwNzczZjlhOTcwNWIwZGYzNQ==","size":14945,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/935befb2fd73d07ce2bee150773f9a9705b0df35","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuUmFuZG9tOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29u\nY3VycmVudEhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5D\nb25jdXJyZW50TWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuc3RhdHMuR2F1Z2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuc3RhdHMuTnVsbFN0YXRzTG9nZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnN0YXRzLlN0YXRzTG9nZ2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnV0aWwuRGlza0NoZWNrZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIudXRpbC5EaXNrQ2hlY2tlci5EaXNrRXJyb3JF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5E\naXNrQ2hlY2tlci5EaXNrT3V0T2ZTcGFjZUV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLkRpc2tDaGVja2VyLkRpc2tXYXJu\nVGhyZXNob2xkRXhjZXB0aW9uOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5n\nb29nbGUuY29tbW9uLmFubm90YXRpb25zLlZpc2libGVGb3JUZXN0aW5nOwoK\naW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJv\nb2tLZWVwZXJTZXJ2ZXJTdGF0cy5MRF9XUklUQUJMRV9ESVJTOwoKLyoqCiAq\nIFRoaXMgY2xhc3MgbWFuYWdlcyBsZWRnZXIgZGlyZWN0b3JpZXMgdXNlZCBi\neSB0aGUgYm9va2llLgogKi8KcHVibGljIGNsYXNzIExlZGdlckRpcnNNYW5h\nZ2VyIHsKICAgIHByaXZhdGUgZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBM\nb2dnZXJGYWN0b3J5CiAgICAgICAgICAgIC5nZXRMb2dnZXIoTGVkZ2VyRGly\nc01hbmFnZXIuY2xhc3MpOwoKICAgIHByaXZhdGUgdm9sYXRpbGUgTGlzdDxG\naWxlPiBmaWxsZWREaXJzOwogICAgcHJpdmF0ZSBmaW5hbCBMaXN0PEZpbGU+\nIGxlZGdlckRpcmVjdG9yaWVzOwogICAgcHJpdmF0ZSB2b2xhdGlsZSBMaXN0\nPEZpbGU+IHdyaXRhYmxlTGVkZ2VyRGlyZWN0b3JpZXM7CiAgICBwcml2YXRl\nIGZpbmFsIERpc2tDaGVja2VyIGRpc2tDaGVja2VyOwogICAgcHJpdmF0ZSBm\naW5hbCBMaXN0PExlZGdlckRpcnNMaXN0ZW5lcj4gbGlzdGVuZXJzOwogICAg\ncHJpdmF0ZSBmaW5hbCBMZWRnZXJEaXJzTW9uaXRvciBtb25pdG9yOwogICAg\ncHJpdmF0ZSBmaW5hbCBSYW5kb20gcmFuZCA9IG5ldyBSYW5kb20oKTsKICAg\nIHByaXZhdGUgZmluYWwgQ29uY3VycmVudE1hcDxGaWxlLCBGbG9hdD4gZGlz\na1VzYWdlcyA9CiAgICAgICAgICAgIG5ldyBDb25jdXJyZW50SGFzaE1hcDxG\naWxlLCBGbG9hdD4oKTsKCiAgICBwdWJsaWMgTGVkZ2VyRGlyc01hbmFnZXIo\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLCBGaWxlW10gZGlycykgewogICAg\nICAgIHRoaXMoY29uZiwgZGlycywgTnVsbFN0YXRzTG9nZ2VyLklOU1RBTkNF\nKTsKICAgIH0KCiAgICBMZWRnZXJEaXJzTWFuYWdlcihTZXJ2ZXJDb25maWd1\ncmF0aW9uIGNvbmYsIEZpbGVbXSBkaXJzLCBTdGF0c0xvZ2dlciBzdGF0c0xv\nZ2dlcikgewogICAgICAgIHRoaXMubGVkZ2VyRGlyZWN0b3JpZXMgPSBBcnJh\neXMuYXNMaXN0KEJvb2tpZQogICAgICAgICAgICAgICAgLmdldEN1cnJlbnRE\naXJlY3RvcmllcyhkaXJzKSk7CiAgICAgICAgdGhpcy53cml0YWJsZUxlZGdl\nckRpcmVjdG9yaWVzID0gbmV3IEFycmF5TGlzdDxGaWxlPihsZWRnZXJEaXJl\nY3Rvcmllcyk7CiAgICAgICAgdGhpcy5maWxsZWREaXJzID0gbmV3IEFycmF5\nTGlzdDxGaWxlPigpOwogICAgICAgIGxpc3RlbmVycyA9IG5ldyBBcnJheUxp\nc3Q8TGVkZ2VyRGlyc0xpc3RlbmVyPigpOwogICAgICAgIGRpc2tDaGVja2Vy\nID0gbmV3IERpc2tDaGVja2VyKGNvbmYuZ2V0RGlza1VzYWdlVGhyZXNob2xk\nKCksIGNvbmYuZ2V0RGlza1VzYWdlV2FyblRocmVzaG9sZCgpKTsKICAgICAg\nICBtb25pdG9yID0gbmV3IExlZGdlckRpcnNNb25pdG9yKGNvbmYuZ2V0RGlz\na0NoZWNrSW50ZXJ2YWwoKSk7CiAgICAgICAgZm9yIChGaWxlIGRpciA6IGRp\ncnMpIHsKICAgICAgICAgICAgZGlza1VzYWdlcy5wdXQoZGlyLCAwZik7CiAg\nICAgICAgICAgIFN0cmluZyBzdGF0TmFtZSA9ICJkaXJfIiArIGRpci5nZXRQ\nYXRoKCkucmVwbGFjZSgnLycsICdfJykgKyAiX3VzYWdlIjsKICAgICAgICAg\nICAgZmluYWwgRmlsZSB0YXJnZXREaXIgPSBkaXI7CiAgICAgICAgICAgIHN0\nYXRzTG9nZ2VyLnJlZ2lzdGVyR2F1Z2Uoc3RhdE5hbWUsIG5ldyBHYXVnZTxO\ndW1iZXI+KCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICBwdWJsaWMgTnVtYmVyIGdldERlZmF1bHRWYWx1ZSgpIHsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1\nYmxpYyBOdW1iZXIgZ2V0U2FtcGxlKCkgewogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBkaXNrVXNhZ2VzLmdldCh0YXJnZXREaXIpICogMTAwOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAg\nICAgc3RhdHNMb2dnZXIucmVnaXN0ZXJHYXVnZShMRF9XUklUQUJMRV9ESVJT\nLCBuZXcgR2F1Z2U8TnVtYmVyPigpIHsKICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgIHB1YmxpYyBOdW1iZXIgZ2V0RGVmYXVsdFZhbHVlKCkg\newogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgTnVtYmVy\nIGdldFNhbXBsZSgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB3cml0YWJs\nZUxlZGdlckRpcmVjdG9yaWVzLnNpemUoKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IGFsbCBsZWRnZXIg\nZGlycyBjb25maWd1cmVkCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0PEZpbGU+\nIGdldEFsbExlZGdlckRpcnMoKSB7CiAgICAgICAgcmV0dXJuIGxlZGdlckRp\ncmVjdG9yaWVzOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IG9ubHkgd3Jp\ndGFibGUgbGVkZ2VyIGRpcnMuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0PEZp\nbGU+IGdldFdyaXRhYmxlTGVkZ2VyRGlycygpCiAgICAgICAgICAgIHRocm93\ncyBOb1dyaXRhYmxlTGVkZ2VyRGlyRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nd3JpdGFibGVMZWRnZXJEaXJlY3Rvcmllcy5pc0VtcHR5KCkpIHsKICAgICAg\nICAgICAgU3RyaW5nIGVyck1zZyA9ICJBbGwgbGVkZ2VyIGRpcmVjdG9yaWVz\nIGFyZSBub24gd3JpdGFibGUiOwogICAgICAgICAgICBOb1dyaXRhYmxlTGVk\nZ2VyRGlyRXhjZXB0aW9uIGUgPSBuZXcgTm9Xcml0YWJsZUxlZGdlckRpckV4\nY2VwdGlvbigKICAgICAgICAgICAgICAgICAgICBlcnJNc2cpOwogICAgICAg\nICAgICBMT0cuZXJyb3IoZXJyTXNnLCBlKTsKICAgICAgICAgICAgdGhyb3cg\nZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdyaXRhYmxlTGVkZ2VyRGly\nZWN0b3JpZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcmV0dXJuIGZ1bGwt\nZmlsbGVkIGxlZGdlciBkaXJzLgogICAgICovCiAgICBwdWJsaWMgTGlzdDxG\naWxlPiBnZXRGdWxsRmlsbGVkTGVkZ2VyRGlycygpIHsKICAgICAgICByZXR1\ncm4gZmlsbGVkRGlyczsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBkaXJz\nLCB3aGljaCBhcmUgZnVsbCBtb3JlIHRoYW4gdGhyZXNob2xkCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGlzRGlyRnVsbChGaWxlIGRpcikgewogICAg\nICAgIHJldHVybiBmaWxsZWREaXJzLmNvbnRhaW5zKGRpcik7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBZGQgdGhlIGRpciB0byBmaWxsZWQgZGlycyBsaXN0\nCiAgICAgKi8KICAgIEBWaXNpYmxlRm9yVGVzdGluZwogICAgcHVibGljIHZv\naWQgYWRkVG9GaWxsZWREaXJzKEZpbGUgZGlyKSB7CiAgICAgICAgaWYgKCFm\naWxsZWREaXJzLmNvbnRhaW5zKGRpcikpIHsKICAgICAgICAgICAgTE9HLndh\ncm4oZGlyICsgIiBpcyBvdXQgb2Ygc3BhY2UuIgogICAgICAgICAgICAgICAg\nICAgICsgIiBBZGRpbmcgaXQgdG8gZmlsbGVkIGRpcnMgbGlzdCIpOwogICAg\nICAgICAgICAvLyBVcGRhdGUgZmlsbGVkIGRpcnMgbGlzdAogICAgICAgICAg\nICBMaXN0PEZpbGU+IHVwZGF0ZWRGaWxsZWREaXJzID0gbmV3IEFycmF5TGlz\ndDxGaWxlPihmaWxsZWREaXJzKTsKICAgICAgICAgICAgdXBkYXRlZEZpbGxl\nZERpcnMuYWRkKGRpcik7CiAgICAgICAgICAgIGZpbGxlZERpcnMgPSB1cGRh\ndGVkRmlsbGVkRGlyczsKICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB3cml0\nYWJsZSBsZWRnZXJzIGxpc3QKICAgICAgICAgICAgTGlzdDxGaWxlPiBuZXdE\naXJzID0gbmV3IEFycmF5TGlzdDxGaWxlPih3cml0YWJsZUxlZGdlckRpcmVj\ndG9yaWVzKTsKICAgICAgICAgICAgbmV3RGlycy5yZW1vdmVBbGwoZmlsbGVk\nRGlycyk7CiAgICAgICAgICAgIHdyaXRhYmxlTGVkZ2VyRGlyZWN0b3JpZXMg\nPSBuZXdEaXJzOwogICAgICAgICAgICAvLyBOb3RpZnkgbGlzdGVuZXJzIGFi\nb3V0IGRpc2sgZnVsbAogICAgICAgICAgICBmb3IgKExlZGdlckRpcnNMaXN0\nZW5lciBsaXN0ZW5lciA6IGxpc3RlbmVycykgewogICAgICAgICAgICAgICAg\nbGlzdGVuZXIuZGlza0Z1bGwoZGlyKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZGlyIHRvIHdyaXRh\nYmxlIGRpcnMgbGlzdC4KICAgICAqCiAgICAgKiBAcGFyYW0gZGlyIERpcgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBhZGRUb1dyaXRhYmxlRGlycyhGaWxl\nIGRpciwgYm9vbGVhbiB1bmRlcldhcm5UaHJlc2hvbGQpIHsKICAgICAgICBp\nZiAod3JpdGFibGVMZWRnZXJEaXJlY3Rvcmllcy5jb250YWlucyhkaXIpKSB7\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgTE9HLmlu\nZm8oInt9IGJlY29tZXMgd3JpdGFibGUuIEFkZGluZyBpdCB0byB3cml0YWJs\nZSBkaXJzIGxpc3QuIiwgZGlyKTsKICAgICAgICAvLyBVcGRhdGUgd3JpdGFi\nbGUgZGlycyBsaXN0CiAgICAgICAgTGlzdDxGaWxlPiB1cGRhdGVkV3JpdGFi\nbGVEaXJzID0gbmV3IEFycmF5TGlzdDxGaWxlPih3cml0YWJsZUxlZGdlckRp\ncmVjdG9yaWVzKTsKICAgICAgICB1cGRhdGVkV3JpdGFibGVEaXJzLmFkZChk\naXIpOwogICAgICAgIHdyaXRhYmxlTGVkZ2VyRGlyZWN0b3JpZXMgPSB1cGRh\ndGVkV3JpdGFibGVEaXJzOwogICAgICAgIC8vIFVwZGF0ZSB0aGUgZmlsbGVk\nIGRpcnMgbGlzdAogICAgICAgIExpc3Q8RmlsZT4gbmV3RGlycyA9IG5ldyBB\ncnJheUxpc3Q8RmlsZT4oZmlsbGVkRGlycyk7CiAgICAgICAgbmV3RGlycy5y\nZW1vdmVBbGwod3JpdGFibGVMZWRnZXJEaXJlY3Rvcmllcyk7CiAgICAgICAg\nZmlsbGVkRGlycyA9IG5ld0RpcnM7CiAgICAgICAgLy8gTm90aWZ5IGxpc3Rl\nbmVycyBhYm91dCBkaXNrIHdyaXRhYmxlCiAgICAgICAgZm9yIChMZWRnZXJE\naXJzTGlzdGVuZXIgbGlzdGVuZXIgOiBsaXN0ZW5lcnMpIHsKICAgICAgICAg\nICAgaWYgKHVuZGVyV2FyblRocmVzaG9sZCkgewogICAgICAgICAgICAgICAg\nbGlzdGVuZXIuZGlza1dyaXRhYmxlKGRpcik7CiAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICBsaXN0ZW5lci5kaXNrSnVzdFdyaXRhYmxl\nKGRpcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIG9uZSBvZiB0aGUgbGVkZ2VyIGRpciBmcm9tIHdy\naXRhYmxlIGRpcnMgbGlzdCByYW5kb21seS4KICAgICAqLwogICAgRmlsZSBw\naWNrUmFuZG9tV3JpdGFibGVEaXIoKSB0aHJvd3MgTm9Xcml0YWJsZUxlZGdl\nckRpckV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHBpY2tSYW5kb21Xcml0\nYWJsZURpcihudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBpY2sgdXAg\nYSB3cml0YWJsZSBkaXIgZnJvbSBhdmFpbGFibGUgZGlycyBsaXN0IHJhbmRv\nbWx5LiBUaGUgPGNvZGU+ZXhjbHVkZWREaXI8L2NvZGU+CiAgICAgKiB3aWxs\nIG5vdCBiZSBwaWNrZWR1cC4KICAgICAqCiAgICAgKiBAcGFyYW0gZXhjbHVk\nZWREaXIKICAgICAqICAgICAgICAgIFRoZSBkaXJlY3RvcnkgdG8gZXhjbHVk\nZSBkdXJpbmcgcGlja3VwLgogICAgICogQHRocm93cyBOb1dyaXRhYmxlTGVk\nZ2VyRGlyRXhjZXB0aW9uIGlmIHRoZXJlIGlzIG5vIHdyaXRhYmxlIGRpciBh\ndmFpbGFibGUuCiAgICAgKi8KICAgIEZpbGUgcGlja1JhbmRvbVdyaXRhYmxl\nRGlyKEZpbGUgZXhjbHVkZWREaXIpIHRocm93cyBOb1dyaXRhYmxlTGVkZ2Vy\nRGlyRXhjZXB0aW9uIHsKICAgICAgICBMaXN0PEZpbGU+IHdyaXRhYmxlRGly\ncyA9IGdldFdyaXRhYmxlTGVkZ2VyRGlycygpOwoKICAgICAgICBmaW5hbCBp\nbnQgc3RhcnQgPSByYW5kLm5leHRJbnQod3JpdGFibGVEaXJzLnNpemUoKSk7\nCiAgICAgICAgaW50IGlkeCA9IHN0YXJ0OwogICAgICAgIEZpbGUgY2FuZGlk\nYXRlID0gd3JpdGFibGVEaXJzLmdldChpZHgpOwogICAgICAgIHdoaWxlIChu\ndWxsICE9IGV4Y2x1ZGVkRGlyICYmIGV4Y2x1ZGVkRGlyLmVxdWFscyhjYW5k\naWRhdGUpKSB7CiAgICAgICAgICAgIGlkeCA9IChpZHggKyAxKSAlIHdyaXRh\nYmxlRGlycy5zaXplKCk7CiAgICAgICAgICAgIGlmIChpZHggPT0gc3RhcnQp\nIHsKICAgICAgICAgICAgICAgIC8vIGFmdGVyIHNlYXJjaGluZyBhbGwgYXZh\naWxhYmxlIGRpcnMsCiAgICAgICAgICAgICAgICAvLyBubyB3cml0YWJsZSBk\naXIgaXMgZm91bmQKICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb1dyaXRh\nYmxlTGVkZ2VyRGlyRXhjZXB0aW9uKCJObyB3cml0YWJsZSBkaXJlY3Rvcmll\ncyBmb3VuZCBmcm9tICIKICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGF2\nYWlsYWJsZSB3cml0YWJsZSBkaXJzICgiICsgd3JpdGFibGVEaXJzICsgIikg\nOiBleGNsdWRlIGRpciAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgZXhj\nbHVkZWREaXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhbmRpZGF0\nZSA9IHdyaXRhYmxlRGlycy5nZXQoaWR4KTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGNhbmRpZGF0ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRM\nZWRnZXJEaXJzTGlzdGVuZXIoTGVkZ2VyRGlyc0xpc3RlbmVyIGxpc3RlbmVy\nKSB7CiAgICAgICAgaWYgKGxpc3RlbmVyICE9IG51bGwpIHsKICAgICAgICAg\nICAgbGlzdGVuZXJzLmFkZChsaXN0ZW5lcik7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogU3dlZXAgdGhyb3VnaCBhbGwgdGhlIGRpcmVjdG9y\naWVzIHRvIGNoZWNrIGRpc2sgZXJyb3JzIG9yIGRpc2sgZnVsbC4KICAgICAq\nCiAgICAgKiBAdGhyb3dzIERpc2tFcnJvckV4Y2VwdGlvbgogICAgICogICAg\nICAgICAgICAgSWYgZGlzayBoYXZpbmcgZXJyb3JzCiAgICAgKiBAdGhyb3dz\nIE5vV3JpdGFibGVMZWRnZXJEaXJFeGNlcHRpb24KICAgICAqICAgICAgICAg\nICAgIElmIGFsbCB0aGUgY29uZmlndXJlZCBsZWRnZXIgZGlyZWN0b3JpZXMg\nYXJlIGZ1bGwgb3IgaGF2aW5nCiAgICAgKiAgICAgICAgICAgICBsZXNzIHNw\nYWNlIHRoYW4gdGhyZXNob2xkCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGlu\naXQoKSB0aHJvd3MgRGlza0Vycm9yRXhjZXB0aW9uLCBOb1dyaXRhYmxlTGVk\nZ2VyRGlyRXhjZXB0aW9uIHsKICAgICAgICBtb25pdG9yLmNoZWNrRGlycyh3\ncml0YWJsZUxlZGdlckRpcmVjdG9yaWVzKTsKICAgIH0KCiAgICAvLyBzdGFy\ndCB0aGUgZGFlbW9uIGZvciBkaXNrIG1vbml0b3JpbmcKICAgIHB1YmxpYyB2\nb2lkIHN0YXJ0KCkgewogICAgICAgIG1vbml0b3Iuc2V0RGFlbW9uKHRydWUp\nOwogICAgICAgIG1vbml0b3Iuc3RhcnQoKTsKICAgIH0KCiAgICAvLyBzaHV0\nZG93biBkaXNrIG1vbml0b3JpbmcgZGFlbW9uCiAgICBwdWJsaWMgdm9pZCBz\naHV0ZG93bigpIHsKICAgICAgICBMT0cuaW5mbygiU2h1dHRpbmcgZG93biBM\nZWRnZXJEaXJzTW9uaXRvciIpOwogICAgICAgIG1vbml0b3IuaW50ZXJydXB0\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbW9uaXRvci5qb2luKCk7\nCiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAvLyBJZ25vcmUKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaHJlYWQgdG8gbW9uaXRvciB0aGUgZGlzayBzcGFjZSBwZXJp\nb2RpY2FsbHkuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgTGVkZ2VyRGly\nc01vbml0b3IgZXh0ZW5kcyBCb29raWVUaHJlYWQgewogICAgICAgIHByaXZh\ndGUgZmluYWwgaW50IGludGVydmFsOwoKICAgICAgICBwdWJsaWMgTGVkZ2Vy\nRGlyc01vbml0b3IoaW50IGludGVydmFsKSB7CiAgICAgICAgICAgIHN1cGVy\nKCJMZWRnZXJEaXJzTW9uaXRvclRocmVhZCIpOwogICAgICAgICAgICB0aGlz\nLmludGVydmFsID0gaW50ZXJ2YWw7CiAgICAgICAgfQoKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAg\nIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgICAgICBMaXN0PEZpbGU+IHdy\naXRhYmxlRGlyczsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgd3JpdGFibGVEaXJzID0gZ2V0V3JpdGFibGVMZWRnZXJEaXJz\nKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChOb1dyaXRhYmxlTGVkZ2Vy\nRGlyRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKExl\nZGdlckRpcnNMaXN0ZW5lciBsaXN0ZW5lciA6IGxpc3RlbmVycykgewogICAg\nICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lci5hbGxEaXNrc0Z1bGwoKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBDaGVj\nayBhbGwgd3JpdGFibGUgZGlycyBkaXNrIHNwYWNlIHVzYWdlLgogICAgICAg\nICAgICAgICAgZm9yIChGaWxlIGRpciA6IHdyaXRhYmxlRGlycykgewogICAg\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGRpc2tVc2FnZXMucHV0KGRpciwgZGlza0NoZWNrZXIuY2hlY2tEaXIoZGly\nKSk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRGlza0Vycm9yRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9y\nKCJMZWRnZXIgZGlyZWN0b3J5IHt9IGZhaWxlZCBvbiBkaXNrIGNoZWNraW5n\nIDogIiwgZGlyLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90\naWZ5IGRpc2sgZmFpbHVyZSB0byBhbGwgbGlzdGVuZXJzCiAgICAgICAgICAg\nICAgICAgICAgICAgIGZvciAoTGVkZ2VyRGlyc0xpc3RlbmVyIGxpc3RlbmVy\nIDogbGlzdGVuZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBs\naXN0ZW5lci5kaXNrRmFpbGVkKGRpcik7CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChEaXNrV2FyblRo\ncmVzaG9sZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy53YXJuKCJMZWRnZXIgZGlyZWN0b3J5IHt9IGlzIGFsbW9zdCBmdWxs\nLiIsIGRpcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2tVc2FnZXMu\ncHV0KGRpciwgZS5nZXRVc2FnZSgpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgZm9yIChMZWRnZXJEaXJzTGlzdGVuZXIgbGlzdGVuZXIgOiBsaXN0ZW5l\ncnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyLmRp\nc2tBbG1vc3RGdWxsKGRpcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChEaXNrT3V0T2ZTcGFjZUV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiTGVkZ2VyIGRpcmVjdG9yeSB7fSBpcyBvdXQtb2Ytc3BhY2UuIiwgZGly\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgZGlza1VzYWdlcy5wdXQoZGly\nLCBlLmdldFVzYWdlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBO\nb3RpZnkgZGlzayBmdWxsIHRvIGFsbCBsaXN0ZW5lcnMKICAgICAgICAgICAg\nICAgICAgICAgICAgYWRkVG9GaWxsZWREaXJzKGRpcik7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nTGlzdDxGaWxlPiBmdWxsZmlsbGVkRGlycyA9IG5ldyBBcnJheUxpc3Q8Rmls\nZT4oZ2V0RnVsbEZpbGxlZExlZGdlckRpcnMoKSk7CiAgICAgICAgICAgICAg\nICAvLyBDaGVjayBhbGwgZnVsbC1maWxsZWQgZGlzayBzcGFjZSB1c2FnZQog\nICAgICAgICAgICAgICAgZm9yIChGaWxlIGRpciA6IGZ1bGxmaWxsZWREaXJz\nKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAgICAgZGlza1VzYWdlcy5wdXQoZGlyLCBkaXNrQ2hlY2tlci5jaGVj\na0RpcihkaXIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9Xcml0\nYWJsZURpcnMoZGlyLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChEaXNrRXJyb3JFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nICAgICAgICAvL05vdGlmeSBkaXNrIGZhaWx1cmUgdG8gYWxsIHRoZSBsaXN0\nZW5lcnMKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChMZWRnZXJEaXJz\nTGlzdGVuZXIgbGlzdGVuZXIgOiBsaXN0ZW5lcnMpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxpc3RlbmVyLmRpc2tGYWlsZWQoZGlyKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKERpc2tXYXJuVGhyZXNob2xkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgZGlza1VzYWdlcy5wdXQoZGlyLCBlLmdldFVz\nYWdlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZnVsbC1m\naWxsZWQgZGlyIGJlY29tZSB3cml0YWJsZSBidXQgc3RpbGwgYWJvdmUgd2Fy\nbiB0aHJlc2hvbGQKICAgICAgICAgICAgICAgICAgICAgICAgYWRkVG9Xcml0\nYWJsZURpcnMoZGlyLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfSBj\nYXRjaCAoRGlza091dE9mU3BhY2VFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgICAgICAgICAvLyB0aGUgZnVsbC1maWxsZWQgZGlyIGlzIHN0aWxs\nIGZ1bGwtZmlsbGVkCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2tVc2Fn\nZXMucHV0KGRpciwgZS5nZXRVc2FnZSgpKTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIFRocmVhZC5zbGVlcChpbnRlcnZhbCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIkxlZGdlckRpcnNN\nb25pdG9yIHRocmVhZCBpcyBpbnRlcnJ1cHRlZCIpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgICAgIExPRy5pbmZvKCJMZWRnZXJEaXJzTW9uaXRvclRocmVh\nZCBleGl0ZWQhIik7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQg\nY2hlY2tEaXJzKExpc3Q8RmlsZT4gd3JpdGFibGVEaXJzKQogICAgICAgICAg\nICAgICAgdGhyb3dzIERpc2tFcnJvckV4Y2VwdGlvbiwgTm9Xcml0YWJsZUxl\nZGdlckRpckV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGZvciAoRmlsZSBkaXIg\nOiB3cml0YWJsZURpcnMpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgZGlza0NoZWNrZXIuY2hlY2tEaXIoZGlyKTsKICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKERpc2tXYXJuVGhyZXNob2xkRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAvLyBub3AKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKERpc2tPdXRPZlNwYWNlRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgICAgICBhZGRUb0ZpbGxlZERpcnMoZGlyKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBnZXRX\ncml0YWJsZUxlZGdlckRpcnMoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBJbmRpY2F0ZXMgQWxsIGNvbmZpZ3VyZWQgbGVkZ2VyIGRpcmVj\ndG9yaWVzIGFyZSBmdWxsLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIE5vV3JpdGFibGVMZWRnZXJEaXJFeGNlcHRpb24gZXh0ZW5kcyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBz\nZXJpYWxWZXJzaW9uVUlEID0gLTg2OTY5MDEyODUwNjE0NDg0MjFMOwoKICAg\nICAgICBwdWJsaWMgTm9Xcml0YWJsZUxlZGdlckRpckV4Y2VwdGlvbihTdHJp\nbmcgZXJyTXNnKSB7CiAgICAgICAgICAgIHN1cGVyKGVyck1zZyk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogTGlzdGVuZXIgZm9yIHRoZSBk\naXNrIGNoZWNrIGV2ZW50cyB3aWxsIGJlIG5vdGlmaWVkIGZyb20gdGhlCiAg\nICAgKiB7QGxpbmsgTGVkZ2VyRGlyc01hbmFnZXJ9IHdoZW5ldmVyIGRpc2sg\nZnVsbC9mYWlsdXJlIGRldGVjdGVkLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGludGVyZmFjZSBMZWRnZXJEaXJzTGlzdGVuZXIgewogICAgICAgIC8q\nKgogICAgICAgICAqIFRoaXMgd2lsbCBiZSBub3RpZmllZCBvbiBkaXNrIGZh\naWx1cmUvZGlzayBlcnJvcgogICAgICAgICAqCiAgICAgICAgICogQHBhcmFt\nIGRpc2sKICAgICAgICAgKiAgICAgICAgICAgIEZhaWxlZCBkaXNrCiAgICAg\nICAgICovCiAgICAgICAgdm9pZCBkaXNrRmFpbGVkKEZpbGUgZGlzayk7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIE5vdGlmaWVkIHdoZW4gdGhlIGRpc2sg\ndXNhZ2Ugd2FybiB0aHJlc2hvbGQgaXMgZXhjZWVkZWQgb24KICAgICAgICAg\nKiB0aGUgZHJpdmUuCiAgICAgICAgICogQHBhcmFtIGRpc2sKICAgICAgICAg\nKi8KICAgICAgICB2b2lkIGRpc2tBbG1vc3RGdWxsKEZpbGUgZGlzayk7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIFRoaXMgd2lsbCBiZSBub3RpZmllZCBv\nbiBkaXNrIGRldGVjdGVkIGFzIGZ1bGwKICAgICAgICAgKgogICAgICAgICAq\nIEBwYXJhbSBkaXNrCiAgICAgICAgICogICAgICAgICAgICBGaWxsZWQgZGlz\nawogICAgICAgICAqLwogICAgICAgIHZvaWQgZGlza0Z1bGwoRmlsZSBkaXNr\nKTsKCiAgICAgICAgLyoqCiAgICAgICAgICogVGhpcyB3aWxsIGJlIG5vdGlm\naWVkIG9uIGRpc2sgZGV0ZWN0ZWQgYXMgd3JpdGFibGUgYW5kIHVuZGVyIHdh\ncm4gdGhyZXNob2xkCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gZGlz\nawogICAgICAgICAqICAgICAgICAgIFdyaXRhYmxlIGRpc2sKICAgICAgICAg\nKi8KICAgICAgICB2b2lkIGRpc2tXcml0YWJsZShGaWxlIGRpc2spOwoKICAg\nICAgICAvKioKICAgICAgICAgKiBUaGlzIHdpbGwgYmUgbm90aWZpZWQgb24g\nZGlzayBkZXRlY3RlZCBhcyB3cml0YWJsZSBidXQgc3RpbGwgaW4gd2FybiB0\naHJlc2hvbGQKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSBkaXNrCiAg\nICAgICAgICogICAgICAgICAgV3JpdGFibGUgZGlzawogICAgICAgICAqLwog\nICAgICAgIHZvaWQgZGlza0p1c3RXcml0YWJsZShGaWxlIGRpc2spOwoKICAg\nICAgICAvKioKICAgICAgICAgKiBUaGlzIHdpbGwgYmUgbm90aWZpZWQgd2hl\nbmV2ZXIgYWxsIGRpc2tzIGFyZSBkZXRlY3RlZCBhcyBmdWxsLgogICAgICAg\nICAqLwogICAgICAgIHZvaWQgYWxsRGlza3NGdWxsKCk7CgogICAgICAgIC8q\nKgogICAgICAgICAqIFRoaXMgd2lsbCBub3RpZnkgdGhlIGZhdGFsIGVycm9y\ncy4KICAgICAgICAgKi8KICAgICAgICB2b2lkIGZhdGFsRXJyb3IoKTsKICAg\nIH0KfQo=\n","encoding":"base64"}

