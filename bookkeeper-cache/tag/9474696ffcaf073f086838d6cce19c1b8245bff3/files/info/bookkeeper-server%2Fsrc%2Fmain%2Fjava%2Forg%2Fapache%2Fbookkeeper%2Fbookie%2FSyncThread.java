{"sha":"71a21580294d18664fa9002bf1fb03bff6b1a78d","node_id":"MDQ6QmxvYjE1NzU5NTY6NzFhMjE1ODAyOTRkMTg2NjRmYTkwMDJiZjFmYjAzYmZmNmIxYTc4ZA==","size":6941,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/71a21580294d18664fa9002bf1fb03bff6b1a78d","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwoKcGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llOwoK\naW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5UaW1lVW5pdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJy\nZW50LlNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZTsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKCmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuYm9va2llLkNoZWNrcG9pbnRTb3VyY2UuQ2hlY2twb2ludDsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuTGVkZ2VyRGly\nc01hbmFnZXIuTGVkZ2VyRGlyc0xpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmJvb2tpZS5MZWRnZXJEaXJzTWFuYWdlci5Ob1dyaXRh\nYmxlTGVkZ2VyRGlyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci51dGlsLk1hdGhVdGlsczsKaW1wb3J0IG9yZy5z\nbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsK\nCmltcG9ydCBjb20uZ29vZ2xlLmNvbW1vbi5hbm5vdGF0aW9ucy5WaXNpYmxl\nRm9yVGVzdGluZzsKaW1wb3J0IGNvbS5nb29nbGUuY29tbW9uLnV0aWwuY29u\nY3VycmVudC5UaHJlYWRGYWN0b3J5QnVpbGRlcjsKCi8qKgogKiBTeW5jVGhy\nZWFkIGlzIGEgYmFja2dyb3VuZCB0aHJlYWQgd2hpY2ggaGVscCBjaGVja3Bv\naW50aW5nIGxlZGdlciBzdG9yYWdlCiAqIHdoZW4gYSBjaGVja3BvaW50IGlz\nIHJlcXVlc3RlZC4gQWZ0ZXIgYSBsZWRnZXIgc3RvcmFnZSBpcyBjaGVja3Bv\naW50ZWQsCiAqIHRoZSBqb3VybmFsIGZpbGVzIGFkZGVkIGJlZm9yZSBjaGVj\na3BvaW50IHdpbGwgYmUgZ2FyYmFnZSBjb2xsZWN0ZWQuCiAqIDxwPgogKiBB\nZnRlciBhbGwgZGF0YSBoYXMgYmVlbiBwZXJzaXN0ZWQgdG8gbGVkZ2VyIGlu\nZGV4IGZpbGVzIGFuZCBlbnRyeQogKiBsb2dnZXJzLCBpdCBpcyBzYWZlIHRv\nIGNvbXBsZXRlIGEgY2hlY2twb2ludCBieSBwZXJzaXN0aW5nIHRoZSBsb2cg\nbWFya2VyCiAqIHRvIGRpc2suIElmIGJvb2tpZSBmYWlsZWQgYWZ0ZXIgcGVy\nc2lzdCBsb2cgbWFyaywgYm9va2llIGlzIGFibGUgdG8gcmVsYXkKICogam91\ncm5hbCBlbnRyaWVzIHN0YXJ0ZWQgZnJvbSBsYXN0IGxvZyBtYXJrIHdpdGhv\ndXQgbG9zaW5nIGFueSBlbnRyaWVzLgogKiA8L3A+CiAqIDxwPgogKiBUaG9z\nZSBqb3VybmFsIGZpbGVzIHdob3NlIGlkIGFyZSBsZXNzIHRoYW4gdGhlIGxv\nZyBpZCBpbiBsYXN0IGxvZyBtYXJrLAogKiBjb3VsZCBiZSByZW1vdmVkIHNh\nZmVseSBhZnRlciBwZXJzaXN0aW5nIGxhc3QgbG9nIG1hcmsuIFdlIHByb3Zp\nZGUgYQogKiBzZXR0aW5nIHRvIGxldCB1c2VyIGtlZXBpbmcgbnVtYmVyIG9m\nIG9sZCBqb3VybmFsIGZpbGVzIHdoaWNoIG1heSBiZSB1c2VkCiAqIGZvciBt\nYW51YWwgcmVjb3ZlcnkgaW4gY3JpdGljYWwgZGlzYXN0ZXIuCiAqIDwvcD4K\nICovCmNsYXNzIFN5bmNUaHJlYWQgewogICAgcHJpdmF0ZSBmaW5hbCBzdGF0\naWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFN5bmNU\naHJlYWQuY2xhc3MpOwoKICAgIGZpbmFsIFNjaGVkdWxlZEV4ZWN1dG9yU2Vy\ndmljZSBleGVjdXRvcjsKICAgIGZpbmFsIGludCBmbHVzaEludGVydmFsOwog\nICAgZmluYWwgTGVkZ2VyU3RvcmFnZSBsZWRnZXJTdG9yYWdlOwogICAgZmlu\nYWwgTGVkZ2VyRGlyc0xpc3RlbmVyIGRpcnNMaXN0ZW5lcjsKICAgIGZpbmFs\nIENoZWNrcG9pbnRTb3VyY2UgY2hlY2twb2ludFNvdXJjZTsKCiAgICBwdWJs\naWMgU3luY1RocmVhZChTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYsCiAgICAg\nICAgICAgICAgICAgICAgICBMZWRnZXJEaXJzTGlzdGVuZXIgZGlyc0xpc3Rl\nbmVyLAogICAgICAgICAgICAgICAgICAgICAgTGVkZ2VyU3RvcmFnZSBsZWRn\nZXJTdG9yYWdlLAogICAgICAgICAgICAgICAgICAgICAgQ2hlY2twb2ludFNv\ndXJjZSBjaGVja3BvaW50U291cmNlKSB7CiAgICAgICAgdGhpcy5kaXJzTGlz\ndGVuZXIgPSBkaXJzTGlzdGVuZXI7CiAgICAgICAgdGhpcy5sZWRnZXJTdG9y\nYWdlID0gbGVkZ2VyU3RvcmFnZTsKICAgICAgICB0aGlzLmNoZWNrcG9pbnRT\nb3VyY2UgPSBjaGVja3BvaW50U291cmNlOwogICAgICAgIFRocmVhZEZhY3Rv\ncnlCdWlsZGVyIHRmYiA9IG5ldyBUaHJlYWRGYWN0b3J5QnVpbGRlcigpCiAg\nICAgICAgICAgIC5zZXROYW1lRm9ybWF0KCJTeW5jVGhyZWFkLSIgKyBjb25m\nLmdldEJvb2tpZVBvcnQoKSArICItJWQiKTsKICAgICAgICB0aGlzLmV4ZWN1\ndG9yID0gRXhlY3V0b3JzLm5ld1NpbmdsZVRocmVhZFNjaGVkdWxlZEV4ZWN1\ndG9yKHRmYi5idWlsZCgpKTsKICAgICAgICBmbHVzaEludGVydmFsID0gY29u\nZi5nZXRGbHVzaEludGVydmFsKCk7CiAgICAgICAgTE9HLmRlYnVnKCJGbHVz\naCBJbnRlcnZhbCA6IHt9IiwgZmx1c2hJbnRlcnZhbCk7CiAgICB9CgogICAg\ndm9pZCBzdGFydCgpIHsKICAgICAgICBleGVjdXRvci5zY2hlZHVsZUF0Rml4\nZWRSYXRlKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICBzeW5jaHJvbml6ZWQgKHN1c3BlbnNpb25M\nb2NrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc3Vz\ncGVuZGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VzcGVu\nc2lvbkxvY2sud2FpdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRU\naHJlYWQoKS5pbnRlcnJ1cHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nIGNoZWNrcG9pbnQoY2hlY2twb2ludFNvdXJjZS5uZXdDaGVja3BvaW50KCkp\nOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0aW9u\nIGluIFN5bmNUaHJlYWQiLCB0KTsKICAgICAgICAgICAgICAgICAgICAgICAg\nZGlyc0xpc3RlbmVyLmZhdGFsRXJyb3IoKTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZsdXNoSW50\nZXJ2YWwsIGZsdXNoSW50ZXJ2YWwsIFRpbWVVbml0Lk1JTExJU0VDT05EUyk7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGZsdXNoKCkgewogICAgICAgIENo\nZWNrcG9pbnQgY2hlY2twb2ludCA9IGNoZWNrcG9pbnRTb3VyY2UubmV3Q2hl\nY2twb2ludCgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxlZGdlclN0\nb3JhZ2UuZmx1c2goKTsKICAgICAgICB9IGNhdGNoIChOb1dyaXRhYmxlTGVk\nZ2VyRGlyRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJO\nbyB3cml0ZWFibGUgbGVkZ2VyIGRpcmVjdG9yaWVzIiwgZSk7CiAgICAgICAg\nICAgIGRpcnNMaXN0ZW5lci5hbGxEaXNrc0Z1bGwoKTsKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24gZmx1c2hpbmcgbGVkZ2Vy\ncyIsIGUpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAg\nICB0cnkgewogICAgICAgICAgICBjaGVja3BvaW50U291cmNlLmNoZWNrcG9p\nbnRDb21wbGV0ZShjaGVja3BvaW50LCBmYWxzZSk7CiAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkV4\nY2VwdGlvbiBtYXJraW5nIGNoZWNrcG9pbnQgYXMgY29tcGxldGUiLCBlKTsK\nICAgICAgICAgICAgZGlyc0xpc3RlbmVyLmFsbERpc2tzRnVsbCgpOwogICAg\nICAgIH0KICAgIH0KCiAgICBAVmlzaWJsZUZvclRlc3RpbmcKICAgIHB1Ymxp\nYyB2b2lkIGNoZWNrcG9pbnQoQ2hlY2twb2ludCBjaGVja3BvaW50KSB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgY2hlY2twb2ludCA9IGxlZGdlclN0\nb3JhZ2UuY2hlY2twb2ludChjaGVja3BvaW50KTsKICAgICAgICB9IGNhdGNo\nIChOb1dyaXRhYmxlTGVkZ2VyRGlyRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgTE9HLmVycm9yKCJObyB3cml0ZWFibGUgbGVkZ2VyIGRpcmVjdG9yaWVz\nIiwgZSk7CiAgICAgICAgICAgIGRpcnNMaXN0ZW5lci5hbGxEaXNrc0Z1bGwo\nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gY2F0Y2ggKElPRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24g\nZmx1c2hpbmcgbGVkZ2VycyIsIGUpOwogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgICBjaGVja3BvaW50\nU291cmNlLmNoZWNrcG9pbnRDb21wbGV0ZShjaGVja3BvaW50LCB0cnVlKTsK\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nIExPRy5lcnJvcigiRXhjZXB0aW9uIG1hcmtpbmcgY2hlY2twb2ludCBhcyBj\nb21wbGV0ZSIsIGUpOwogICAgICAgICAgICBkaXJzTGlzdGVuZXIuYWxsRGlz\na3NGdWxsKCk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgT2JqZWN0\nIHN1c3BlbnNpb25Mb2NrID0gbmV3IE9iamVjdCgpOwogICAgcHJpdmF0ZSBi\nb29sZWFuIHN1c3BlbmRlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogU3Vz\ncGVuZCBzeW5jIHRocmVhZC4gKGZvciB0ZXN0aW5nKQogICAgICovCiAgICBA\nVmlzaWJsZUZvclRlc3RpbmcKICAgIHB1YmxpYyB2b2lkIHN1c3BlbmRTeW5j\nKCkgewogICAgICAgIHN5bmNocm9uaXplZChzdXNwZW5zaW9uTG9jaykgewog\nICAgICAgICAgICBzdXNwZW5kZWQgPSB0cnVlOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFJlc3VtZSBzeW5jIHRocmVhZC4gKGZvciB0ZXN0\naW5nKQogICAgICovCiAgICBAVmlzaWJsZUZvclRlc3RpbmcKICAgIHB1Ymxp\nYyB2b2lkIHJlc3VtZVN5bmMoKSB7CiAgICAgICAgc3luY2hyb25pemVkKHN1\nc3BlbnNpb25Mb2NrKSB7CiAgICAgICAgICAgIHN1c3BlbmRlZCA9IGZhbHNl\nOwogICAgICAgICAgICBzdXNwZW5zaW9uTG9jay5ub3RpZnkoKTsKICAgICAg\nICB9CiAgICB9CgogICAgLy8gc2h1dGRvd24gc3luYyB0aHJlYWQKICAgIHZv\naWQgc2h1dGRvd24oKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gewog\nICAgICAgIExPRy5pbmZvKCJTaHV0dGluZyBkb3duIFN5bmNUaHJlYWQiKTsK\nICAgICAgICBleGVjdXRvci5zdWJtaXQobmV3IFJ1bm5hYmxlKCkgewogICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZsdXNoKCk7\nCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24g\nZmx1c2hpbmcgbGVkZ2VycyBhdCBzaHV0ZG93biIsIHQpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7\nCiAgICAgICAgZXhlY3V0b3Iuc2h1dGRvd24oKTsKICAgICAgICBsb25nIHN0\nYXJ0ID0gTWF0aFV0aWxzLm5vdygpOwogICAgICAgIHdoaWxlICghZXhlY3V0\nb3IuYXdhaXRUZXJtaW5hdGlvbig1LCBUaW1lVW5pdC5NSU5VVEVTKSkgewog\nICAgICAgICAgICBsb25nIG5vdyA9IE1hdGhVdGlscy5ub3coKTsKICAgICAg\nICAgICAgTE9HLmluZm8oIlN5bmNUaHJlYWQgdGFraW5nIGEgbG9uZyB0aW1l\nIHRvIHNodXRkb3duLiBIYXMgdGFrZW4ge30iCiAgICAgICAgICAgICAgICAg\nICAgKyAiIHNlY29uZHMgc28gZmFyIiwgbm93IC0gc3RhcnQpOwogICAgICAg\nIH0KICAgIH0KfQo=\n","encoding":"base64"}

