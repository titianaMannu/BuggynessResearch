{"sha":"204f0dc8c19307efd5c7996a2f7da628c22225bc","node_id":"MDQ6QmxvYjE1NzU5NTY6MjA0ZjBkYzhjMTkzMDdlZmQ1Yzc5OTZhMmY3ZGE2MjhjMjIyMjViYw==","size":13245,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/204f0dc8c19307efd5c7996a2f7da628c22225bc","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKaW1wb3J0IGph\ndmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0\nOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2\nYS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50Lkxpbmtl\nZEJsb2NraW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5S\nZWplY3RlZEV4ZWN1dGlvbkV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LlNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZTsKaW1wb3J0IGph\ndmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0OwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb24uQktOb3RFbm91Z2hC\nb29raWVzRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5uZXQuQm9va2llU29ja2V0QWRkcmVzczsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLkJvb2tLZWVwZXJDb25zdGFudHM7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TYWZlUnVubmFi\nbGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5Bc3luY0NhbGxiYWNr\nLkNoaWxkcmVuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5DcmVhdGVNb2RlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2Vl\ncGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2Vl\ncGVyRXhjZXB0aW9uLkNvZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5LZWVwZXJFeGNlcHRpb24uTm9kZUV4aXN0c0V4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVudDsKaW1wb3J0IG9y\nZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLnpvb2tlZXBlci5XYXRjaGVyLkV2ZW50LkV2ZW50VHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRzOwppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoK\nLyoqCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIG1haW50YWlu\naW5nIGEgY29uc2lzdGVudCB2aWV3IG9mIHdoYXQgYm9va2llcwogKiBhcmUg\nYXZhaWxhYmxlIGJ5IHJlYWRpbmcgWm9va2VlcGVyIChhbmQgc2V0dGluZyB3\nYXRjaGVzIG9uIHRoZSBib29raWUgbm9kZXMpLgogKiBXaGVuIGEgYm9va2ll\nIGZhaWxzLCB0aGUgb3RoZXIgcGFydHMgb2YgdGhlIGNvZGUgdHVybiB0byB0\naGlzIGNsYXNzIHRvIGZpbmQgYQogKiByZXBsYWNlbWVudAogKgogKi8KY2xh\nc3MgQm9va2llV2F0Y2hlciBpbXBsZW1lbnRzIFdhdGNoZXIsIENoaWxkcmVu\nQ2FsbGJhY2sgewogICAgc3RhdGljIGZpbmFsIExvZ2dlciBsb2dnZXIgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihCb29raWVXYXRjaGVyLmNsYXNzKTsK\nCiAgICBwdWJsaWMgc3RhdGljIGludCBaS19DT05ORUNUX0JBQ0tPRkZfU0VD\nID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFNldDxCb29raWVTb2Nr\nZXRBZGRyZXNzPiBFTVBUWV9TRVQgPSBuZXcgSGFzaFNldDxCb29raWVTb2Nr\nZXRBZGRyZXNzPigpOwoKICAgIC8vIEJvb2tpZSByZWdpc3RyYXRpb24gcGF0\naCBpbiBaSwogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgYm9va2llUmVnaXN0\ncmF0aW9uUGF0aDsKCiAgICBmaW5hbCBCb29rS2VlcGVyIGJrOwogICAgZmlu\nYWwgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcjsKICAgIGZp\nbmFsIEVuc2VtYmxlUGxhY2VtZW50UG9saWN5IHBsYWNlbWVudFBvbGljeTsK\nCiAgICBTYWZlUnVubmFibGUgcmVSZWFkVGFzayA9IG5ldyBTYWZlUnVubmFi\nbGUoKSB7CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\nc2FmZVJ1bigpIHsKICAgICAgICAgICAgcmVhZEJvb2tpZXMoKTsKICAgICAg\nICB9CiAgICB9OwogICAgcHJpdmF0ZSBSZWFkT25seUJvb2tpZVdhdGNoZXIg\ncmVhZE9ubHlCb29raWVXYXRjaGVyOwoKICAgIHB1YmxpYyBCb29raWVXYXRj\naGVyKENsaWVudENvbmZpZ3VyYXRpb24gY29uZiwKICAgICAgICAgICAgICAg\nICAgICAgICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hlZHVsZXIs\nCiAgICAgICAgICAgICAgICAgICAgICAgICBFbnNlbWJsZVBsYWNlbWVudFBv\nbGljeSBwbGFjZW1lbnRQb2xpY3ksCiAgICAgICAgICAgICAgICAgICAgICAg\nICBCb29rS2VlcGVyIGJrKSB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uLCBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiAgewogICAgICAgIHRoaXMuYmsgPSBiazsKICAg\nICAgICAvLyBaSyBib29raWUgcmVnaXN0cmF0aW9uIHBhdGgKICAgICAgICB0\naGlzLmJvb2tpZVJlZ2lzdHJhdGlvblBhdGggPSBjb25mLmdldFprQXZhaWxh\nYmxlQm9va2llc1BhdGgoKTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNj\naGVkdWxlcjsKICAgICAgICB0aGlzLnBsYWNlbWVudFBvbGljeSA9IHBsYWNl\nbWVudFBvbGljeTsKICAgICAgICByZWFkT25seUJvb2tpZVdhdGNoZXIgPSBu\nZXcgUmVhZE9ubHlCb29raWVXYXRjaGVyKGNvbmYsIGJrKTsKICAgIH0KCiAg\nICB2b2lkIG5vdGlmeUJvb2tpZXNDaGFuZ2VkKGZpbmFsIEJvb2tpZXNMaXN0\nZW5lciBsaXN0ZW5lcikgdGhyb3dzIEJLRXhjZXB0aW9uIHsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBiay5nZXRaa0hhbmRsZSgpLmdldENoaWxkcmVu\nKHRoaXMuYm9va2llUmVnaXN0cmF0aW9uUGF0aCwKICAgICAgICAgICAgICAg\nICAgICBuZXcgV2F0Y2hlcigpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZlbnQpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxpc3RlbiBjaGlsZHJlbiBj\naGFuZ2VkIGV2ZW50IGZyb20gWm9vS2VlcGVyCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoZXZlbnQuZ2V0VHlwZSgpID09IEV2ZW50VHlwZS5O\nb2RlQ2hpbGRyZW5DaGFuZ2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbGlzdGVuZXIuYXZhaWxhYmxlQm9va2llc0NoYW5nZWQoKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgIH0g\nY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICBsb2dn\nZXIuZXJyb3IoIkVycm9yIHJlZ2lzdGVyaW5nIHdhdGNoZXIgd2l0aCB6b29r\nZWVwZXIiLCBrZSk7CiAgICAgICAgICAgIHRocm93IG5ldyBCS0V4Y2VwdGlv\nbi5aS0V4Y2VwdGlvbigpOwogICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVk\nRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhy\nZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcigi\nSW50ZXJydXB0ZWQgcmVnaXN0ZXJpbmcgd2F0Y2hlciB3aXRoIHpvb2tlZXBl\nciIsIGllKTsKICAgICAgICAgICAgdGhyb3cgbmV3IEJLRXhjZXB0aW9uLkJL\nSW50ZXJydXB0ZWRFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIENvbGxlY3Rpb248Qm9va2llU29ja2V0QWRkcmVzcz4gZ2V0Qm9v\na2llcygpIHRocm93cyBCS0V4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgTGlzdDxTdHJpbmc+IGNoaWxkcmVuID0gYmsuZ2V0WmtIYW5k\nbGUoKS5nZXRDaGlsZHJlbih0aGlzLmJvb2tpZVJlZ2lzdHJhdGlvblBhdGgs\nIGZhbHNlKTsKICAgICAgICAgICAgY2hpbGRyZW4ucmVtb3ZlKEJvb2tLZWVw\nZXJDb25zdGFudHMuUkVBRE9OTFkpOwogICAgICAgICAgICByZXR1cm4gY29u\ndmVydFRvQm9va2llQWRkcmVzc2VzKGNoaWxkcmVuKTsKICAgICAgICB9IGNh\ndGNoIChLZWVwZXJFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgbG9nZ2Vy\nLmVycm9yKCJGYWlsZWQgdG8gZ2V0IGJvb2tpZSBsaXN0IDogIiwga2UpOwog\nICAgICAgICAgICB0aHJvdyBuZXcgQktFeGNlcHRpb24uWktFeGNlcHRpb24o\nKTsKICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkg\newogICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVw\ndCgpOwogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkludGVycnVwdGVkIHJl\nYWRpbmcgYm9va2llIGxpc3QiLCBpZSk7CiAgICAgICAgICAgIHRocm93IG5l\ndyBCS0V4Y2VwdGlvbi5CS0ludGVycnVwdGVkRXhjZXB0aW9uKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIENvbGxlY3Rpb248Qm9va2llU29ja2V0QWRkcmVz\ncz4gZ2V0UmVhZE9ubHlCb29raWVzKCkgewogICAgICAgIHJldHVybiBuZXcg\nSGFzaFNldDxCb29raWVTb2NrZXRBZGRyZXNzPihyZWFkT25seUJvb2tpZVdh\ndGNoZXIuZ2V0UmVhZE9ubHlCb29raWVzKCkpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHJlYWRCb29raWVzKCkgewogICAgICAgIHJlYWRCb29raWVzKHRo\naXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlYWRCb29raWVzKENoaWxk\ncmVuQ2FsbGJhY2sgY2FsbGJhY2spIHsKICAgICAgICBiay5nZXRaa0hhbmRs\nZSgpLmdldENoaWxkcmVuKHRoaXMuYm9va2llUmVnaXN0cmF0aW9uUGF0aCwg\ndGhpcywgY2FsbGJhY2ssIG51bGwpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZlbnQpIHsK\nICAgICAgICByZWFkQm9va2llcygpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBw\nYXRoLCBPYmplY3QgY3R4LCBMaXN0PFN0cmluZz4gY2hpbGRyZW4pIHsKCiAg\nICAgICAgaWYgKHJjICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZh\nbHVlKCkpIHsKICAgICAgICAgICAgLy9sb2dnZXIuZXJyb3IoIkVycm9yIHdo\naWxlIHJlYWRpbmcgYm9va2llcyIsIEtlZXBlckV4Y2VwdGlvbi5jcmVhdGUo\nQ29kZS5nZXQocmMpLCBwYXRoKSk7CiAgICAgICAgICAgIC8vIHRyeSB0aGUg\ncmVhZCBhZnRlciBhIHNlY29uZCBhZ2FpbgogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgc2NoZWR1bGVyLnNjaGVkdWxlKHJlUmVhZFRhc2ss\nIFpLX0NPTk5FQ1RfQkFDS09GRl9TRUMsIFRpbWVVbml0LlNFQ09ORFMpOwog\nICAgICAgICAgICB9IGNhdGNoIChSZWplY3RlZEV4ZWN1dGlvbkV4Y2VwdGlv\nbiByZWUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuKCJGYWlsZWQg\ndG8gc2NoZWR1bGUgcmVhZGluZyBib29raWVzIHRhc2sgOiAiLCByZWUpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9Cgog\nICAgICAgIC8vIEp1c3QgZXhjbHVkZSB0aGUgJ3JlYWRvbmx5JyB6bm9kZSB0\nbyBleGNsdWRlIHItbyBib29raWVzIGZyb20KICAgICAgICAvLyBhdmFpbGFi\nbGUgbm9kZXMgbGlzdC4KICAgICAgICBjaGlsZHJlbi5yZW1vdmUoQm9va0tl\nZXBlckNvbnN0YW50cy5SRUFET05MWSk7CgogICAgICAgIEhhc2hTZXQ8Qm9v\na2llU29ja2V0QWRkcmVzcz4gbmV3Qm9va2llQWRkcnMgPSBjb252ZXJ0VG9C\nb29raWVBZGRyZXNzZXMoY2hpbGRyZW4pOwoKICAgICAgICBmaW5hbCBTZXQ8\nQm9va2llU29ja2V0QWRkcmVzcz4gZGVhZEJvb2tpZXM7CiAgICAgICAgc3lu\nY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIFNldDxCb29raWVTb2Nr\nZXRBZGRyZXNzPiByZWFkb25seUJvb2tpZXMgPSByZWFkT25seUJvb2tpZVdh\ndGNoZXIuZ2V0UmVhZE9ubHlCb29raWVzKCk7CiAgICAgICAgICAgIGRlYWRC\nb29raWVzID0gcGxhY2VtZW50UG9saWN5Lm9uQ2x1c3RlckNoYW5nZWQobmV3\nQm9va2llQWRkcnMsIHJlYWRvbmx5Qm9va2llcyk7CiAgICAgICAgfQoKICAg\nICAgICBpZiAoYmsuZ2V0Qm9va2llQ2xpZW50KCkgIT0gbnVsbCkgewogICAg\nICAgICAgICBiay5nZXRCb29raWVDbGllbnQoKS5jbG9zZUNsaWVudHMoZGVh\nZEJvb2tpZXMpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRp\nYyBIYXNoU2V0PEJvb2tpZVNvY2tldEFkZHJlc3M+IGNvbnZlcnRUb0Jvb2tp\nZUFkZHJlc3NlcyhMaXN0PFN0cmluZz4gY2hpbGRyZW4pIHsKICAgICAgICAv\nLyBSZWFkIHRoZSBib29raWUgYWRkcmVzc2VzIGludG8gYSBzZXQgZm9yIGVm\nZmljaWVudCBsb29rdXAKICAgICAgICBIYXNoU2V0PEJvb2tpZVNvY2tldEFk\nZHJlc3M+IG5ld0Jvb2tpZUFkZHJzID0gbmV3IEhhc2hTZXQ8Qm9va2llU29j\na2V0QWRkcmVzcz4oKTsKICAgICAgICBmb3IgKFN0cmluZyBib29raWVBZGRy\nU3RyaW5nIDogY2hpbGRyZW4pIHsKICAgICAgICAgICAgQm9va2llU29ja2V0\nQWRkcmVzcyBib29raWVBZGRyOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgYm9va2llQWRkciA9IG5ldyBCb29raWVTb2NrZXRBZGRyZXNz\nKGJvb2tpZUFkZHJTdHJpbmcpOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkNv\ndWxkIG5vdCBwYXJzZSBib29raWUgYWRkcmVzczogIiArIGJvb2tpZUFkZHJT\ndHJpbmcgKyAiLCBpZ25vcmluZyB0aGlzIGJvb2tpZSIpOwogICAgICAgICAg\nICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbmV3\nQm9va2llQWRkcnMuYWRkKGJvb2tpZUFkZHIpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gbmV3Qm9va2llQWRkcnM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBCbG9ja3MgdW50aWwgYm9va2llcyBhcmUgcmVhZCBmcm9tIHpvb2tlZXBl\nciwgdXNlZCBpbiB0aGUge0BsaW5rIEJvb2tLZWVwZXJ9IGNvbnN0cnVjdG9y\nLgogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICog\nQHRocm93cyBLZWVwZXJFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZv\naWQgcmVhZEJvb2tpZXNCbG9ja2luZygpIHRocm93cyBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwgS2VlcGVyRXhjZXB0aW9uIHsKICAgICAgICAvLyBSZWFkIHJl\nYWRvbmx5IGJvb2tpZXMgZmlyc3QKICAgICAgICByZWFkT25seUJvb2tpZVdh\ndGNoZXIucmVhZFJPQm9va2llc0Jsb2NraW5nKCk7CgogICAgICAgIGZpbmFs\nIExpbmtlZEJsb2NraW5nUXVldWU8SW50ZWdlcj4gcXVldWUgPSBuZXcgTGlu\na2VkQmxvY2tpbmdRdWV1ZTxJbnRlZ2VyPigpOwogICAgICAgIHJlYWRCb29r\naWVzKG5ldyBDaGlsZHJlbkNhbGxiYWNrKCkgewogICAgICAgICAgICBwdWJs\naWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9i\namVjdCBjdHgsIExpc3Q8U3RyaW5nPiBjaGlsZHJlbikgewogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBCb29raWVXYXRjaGVy\nLnRoaXMucHJvY2Vzc1Jlc3VsdChyYywgcGF0aCwgY3R4LCBjaGlsZHJlbik7\nCiAgICAgICAgICAgICAgICAgICAgcXVldWUucHV0KHJjKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkludGVycnVwZWQgd2hl\nbiB0cnlpbmcgdG8gcmVhZCBib29raWVzIGluIGEgYmxvY2tpbmcgZmFzaGlv\nbiIpOwogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhj\nZXB0aW9uKGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgfSk7CiAgICAgICAgaW50IHJjID0gcXVldWUudGFrZSgpOwoKICAg\nICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFs\ndWUoKSkgewogICAgICAgICAgICB0aHJvdyBLZWVwZXJFeGNlcHRpb24uY3Jl\nYXRlKENvZGUuZ2V0KHJjKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogQ3JlYXRlIGFuIGVuc2VtYmxlIHdpdGggZ2l2ZW4gPGk+ZW5zZW1i\nbGVTaXplPC9pPiBhbmQgPGk+d3JpdGVRdW9ydW1TaXplPC9pPi4KICAgICAq\nCiAgICAgKiBAcGFyYW0gZW5zZW1ibGVTaXplCiAgICAgKiAgICAgICAgICBF\nbnNlbWJsZSBTaXplCiAgICAgKiBAcGFyYW0gd3JpdGVRdW9ydW1TaXplCiAg\nICAgKiAgICAgICAgICBXcml0ZSBRdW9ydW0gU2l6ZQogICAgICogQHJldHVy\nbiBsaXN0IG9mIGJvb2tpZXMgZm9yIG5ldyBlbnNlbWJsZS4KICAgICAqIEB0\naHJvd3MgQktOb3RFbm91Z2hCb29raWVzRXhjZXB0aW9uCiAgICAgKi8KICAg\nIHB1YmxpYyBBcnJheUxpc3Q8Qm9va2llU29ja2V0QWRkcmVzcz4gbmV3RW5z\nZW1ibGUoaW50IGVuc2VtYmxlU2l6ZSwgaW50IHdyaXRlUXVvcnVtU2l6ZSkK\nICAgICAgICAgICAgdGhyb3dzIEJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHBsYWNlbWVudFBvbGljeS5uZXdFbnNlbWJs\nZShlbnNlbWJsZVNpemUsIHdyaXRlUXVvcnVtU2l6ZSwgRU1QVFlfU0VUKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENob29zZSBhIGJvb2tpZSB0byByZXBs\nYWNlIGJvb2tpZSA8aT5ib29raWVJZHg8L2k+IGluIDxpPmV4aXN0aW5nQm9v\na2llczwvaT4uCiAgICAgKiBAcGFyYW0gZXhpc3RpbmdCb29raWVzCiAgICAg\nKiAgICAgICAgICBsaXN0IG9mIGV4aXN0aW5nIGJvb2tpZXMuCiAgICAgKiBA\ncGFyYW0gYm9va2llSWR4CiAgICAgKiAgICAgICAgICBpbmRleCBvZiB0aGUg\nYm9va2llIGluIHRoZSBsaXN0IHRvIGJlIHJlcGxhY2VkLgogICAgICogQHJl\ndHVybiB0aGUgYm9va2llIHRvIHJlcGxhY2UuCiAgICAgKiBAdGhyb3dzIEJL\nTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMg\nQm9va2llU29ja2V0QWRkcmVzcyByZXBsYWNlQm9va2llKExpc3Q8Qm9va2ll\nU29ja2V0QWRkcmVzcz4gZXhpc3RpbmdCb29raWVzLCBpbnQgYm9va2llSWR4\nKQogICAgICAgICAgICB0aHJvd3MgQktOb3RFbm91Z2hCb29raWVzRXhjZXB0\naW9uIHsKICAgICAgICBCb29raWVTb2NrZXRBZGRyZXNzIGFkZHIgPSBleGlz\ndGluZ0Jvb2tpZXMuZ2V0KGJvb2tpZUlkeCk7CiAgICAgICAgcmV0dXJuIHBs\nYWNlbWVudFBvbGljeS5yZXBsYWNlQm9va2llKGFkZHIsIG5ldyBIYXNoU2V0\nPEJvb2tpZVNvY2tldEFkZHJlc3M+KGV4aXN0aW5nQm9va2llcykpOwogICAg\nfQoKICAgIC8qKgogICAgICogV2F0Y2hlciBpbXBsZW1lbnRhdGlvbiB0byB3\nYXRjaCB0aGUgcmVhZG9ubHkgYm9va2llcyB1bmRlcgogICAgICogJmx0O2F2\nYWlsYWJsZSZndDsvcmVhZG9ubHkKICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgY2xhc3MgUmVhZE9ubHlCb29raWVXYXRjaGVyIGltcGxlbWVudHMgV2F0\nY2hlciwgQ2hpbGRyZW5DYWxsYmFjayB7CgogICAgICAgIHByaXZhdGUgZmlu\nYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dl\ncihSZWFkT25seUJvb2tpZVdhdGNoZXIuY2xhc3MpOwogICAgICAgIHByaXZh\ndGUgSGFzaFNldDxCb29raWVTb2NrZXRBZGRyZXNzPiByZWFkT25seUJvb2tp\nZXMgPSBuZXcgSGFzaFNldDxCb29raWVTb2NrZXRBZGRyZXNzPigpOwogICAg\nICAgIHByaXZhdGUgQm9va0tlZXBlciBiazsKICAgICAgICBwcml2YXRlIFN0\ncmluZyByZWFkT25seUJvb2tpZVJlZ1BhdGg7CgogICAgICAgIHB1YmxpYyBS\nZWFkT25seUJvb2tpZVdhdGNoZXIoQ2xpZW50Q29uZmlndXJhdGlvbiBjb25m\nLCBCb29rS2VlcGVyIGJrKSB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uLAogICAg\nICAgICAgICAgICAgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgICAg\nICB0aGlzLmJrID0gYms7CiAgICAgICAgICAgIHJlYWRPbmx5Qm9va2llUmVn\nUGF0aCA9IGNvbmYuZ2V0WmtBdmFpbGFibGVCb29raWVzUGF0aCgpICsgIi8i\nCiAgICAgICAgICAgICAgICAgICAgKyBCb29rS2VlcGVyQ29uc3RhbnRzLlJF\nQURPTkxZOwogICAgICAgICAgICBpZiAobnVsbCA9PSBiay5nZXRaa0hhbmRs\nZSgpLmV4aXN0cyhyZWFkT25seUJvb2tpZVJlZ1BhdGgsIGZhbHNlKSkgewog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBiay5n\nZXRaa0hhbmRsZSgpLmNyZWF0ZShyZWFkT25seUJvb2tpZVJlZ1BhdGgsIG5l\ndyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xfVU5TQUZFLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKE5vZGVFeGlzdHNFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgbm9kZSBpcyBqdXN0IG5vdyBj\ncmVhdGVkIGJ5IHNvbWVvbmUuCiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyB2b2lkIHByb2Nlc3MoV2F0Y2hlZEV2ZW50IGV2ZW50KSB7CiAgICAg\nICAgICAgIHJlYWRST0Jvb2tpZXMoKTsKICAgICAgICB9CgogICAgICAgIC8v\nIHJlYWQgdGhlIHJlYWRvbmx5IGJvb2tpZXMgaW4gYmxvY2tpbmcgZmFzaGlv\nbi4gVXNlZCBvbmx5IGZvciBmaXJzdAogICAgICAgIC8vIHRpbWUuCiAgICAg\nICAgdm9pZCByZWFkUk9Cb29raWVzQmxvY2tpbmcoKSB0aHJvd3MgSW50ZXJy\ndXB0ZWRFeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiB7CgogICAgICAgICAg\nICBmaW5hbCBMaW5rZWRCbG9ja2luZ1F1ZXVlPEludGVnZXI+IHF1ZXVlID0g\nbmV3IExpbmtlZEJsb2NraW5nUXVldWU8SW50ZWdlcj4oKTsKICAgICAgICAg\nICAgcmVhZFJPQm9va2llcyhuZXcgQ2hpbGRyZW5DYWxsYmFjaygpIHsKICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJj\nLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgTGlzdDxTdHJpbmc+IGNoaWxk\ncmVuKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgUmVhZE9ubHlCb29raWVXYXRjaGVyLnRoaXMucHJvY2Vz\nc1Jlc3VsdChyYywgcGF0aCwgY3R4LCBjaGlsZHJlbik7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHF1ZXVlLnB1dChyYyk7CiAgICAgICAgICAgICAgICAg\nICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkludGVycnVwZWQgd2hl\nbiB0cnlpbmcgdG8gcmVhZCByZWFkb25seSBib29raWVzIGluIGEgYmxvY2tp\nbmcgZmFzaGlvbiIpOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgUnVudGltZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAg\nICBpbnQgcmMgPSBxdWV1ZS50YWtlKCk7CgogICAgICAgICAgICBpZiAocmMg\nIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewogICAg\nICAgICAgICAgICAgdGhyb3cgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShDb2Rl\nLmdldChyYykpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAv\nLyBSZWFkIGNoaWxkcmVuIGFuZCByZWdpc3RlciB3YXRjaGVyIGZvciByZWFk\nb25seSBib29raWVzIHBhdGgKICAgICAgICB2b2lkIHJlYWRST0Jvb2tpZXMo\nQ2hpbGRyZW5DYWxsYmFjayBjYWxsYmFjaykgewogICAgICAgICAgICBiay5n\nZXRaa0hhbmRsZSgpLmdldENoaWxkcmVuKHRoaXMucmVhZE9ubHlCb29raWVS\nZWdQYXRoLCB0aGlzLCBjYWxsYmFjaywgbnVsbCk7CiAgICAgICAgfQoKICAg\nICAgICB2b2lkIHJlYWRST0Jvb2tpZXMoKSB7CiAgICAgICAgICAgIHJlYWRS\nT0Jvb2tpZXModGhpcyk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3Ry\naW5nIHBhdGgsIE9iamVjdCBjdHgsIExpc3Q8U3RyaW5nPiBjaGlsZHJlbikg\newogICAgICAgICAgICBpZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7\nCiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIk5vdCBhYmxlIHRvIHJlYWQg\ncmVhZG9ubHkgYm9va2llcyA6ICIsIEtlZXBlckV4Y2VwdGlvbi5jcmVhdGUo\nQ29kZS5nZXQocmMpKSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIEhhc2hTZXQ8Qm9va2llU29ja2V0QWRk\ncmVzcz4gbmV3UmVhZE9ubHlCb29raWVzID0gY29udmVydFRvQm9va2llQWRk\ncmVzc2VzKGNoaWxkcmVuKTsKICAgICAgICAgICAgcmVhZE9ubHlCb29raWVz\nID0gbmV3UmVhZE9ubHlCb29raWVzOwogICAgICAgIH0KCiAgICAgICAgLy8g\ncmV0dXJucyB0aGUgcmVhZG9ubHkgYm9va2llcwogICAgICAgIHB1YmxpYyBI\nYXNoU2V0PEJvb2tpZVNvY2tldEFkZHJlc3M+IGdldFJlYWRPbmx5Qm9va2ll\ncygpIHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5Qm9va2llczsKICAg\nICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

