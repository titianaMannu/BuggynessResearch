{"sha":"fe223af959228c34482ce9c96b25c4559858494b","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmUyMjNhZjk1OTIyOGMzNDQ4MmNlOWM5NmIyNWM0NTU5ODU4NDk0Yg==","size":4897,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fe223af959228c34482ce9c96b25c4559858494b","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5zZWN1cml0eS5HZW5lcmFsU2VjdXJpdHlFeGNlcHRpb247\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuQXN5bmNDYWxsYmFjay5DcmVhdGVDYWxs\nYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktF\neGNlcHRpb24uQktOb3RFbm91Z2hCb29raWVzRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2Vz\ndFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubmV0LkJvb2tp\nZVNvY2tldEFkZHJlc3M7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWNDYWxs\nYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5zdGF0cy5PcFN0\nYXRzTG9nZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwu\nTWF0aFV0aWxzOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIEVuY2Fwc3VsYXRlcyBh\nc3luY2hyb25vdXMgbGVkZ2VyIGNyZWF0ZSBvcGVyYXRpb24KICoKICovCmNs\nYXNzIExlZGdlckNyZWF0ZU9wIGltcGxlbWVudHMgR2VuZXJpY0NhbGxiYWNr\nPExvbmc+IHsKCiAgICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dl\nckZhY3RvcnkuZ2V0TG9nZ2VyKExlZGdlckNyZWF0ZU9wLmNsYXNzKTsKCiAg\nICBDcmVhdGVDYWxsYmFjayBjYjsKICAgIExlZGdlck1ldGFkYXRhIG1ldGFk\nYXRhOwogICAgTGVkZ2VySGFuZGxlIGxoOwogICAgT2JqZWN0IGN0eDsKICAg\nIGJ5dGVbXSBwYXNzd2Q7CiAgICBCb29rS2VlcGVyIGJrOwogICAgRGlnZXN0\nVHlwZSBkaWdlc3RUeXBlOwogICAgbG9uZyBzdGFydFRpbWU7CiAgICBPcFN0\nYXRzTG9nZ2VyIGNyZWF0ZU9wTG9nZ2VyOwoKICAgIC8qKgogICAgICogQ29u\nc3RydWN0b3IKICAgICAqCiAgICAgKiBAcGFyYW0gYmsKICAgICAqICAgICAg\nIEJvb2tLZWVwZXIgb2JqZWN0CiAgICAgKiBAcGFyYW0gZW5zZW1ibGVTaXpl\nCiAgICAgKiAgICAgICBlbnNlbWJsZSBzaXplCiAgICAgKiBAcGFyYW0gcXVv\ncnVtU2l6ZQogICAgICogICAgICAgcXVvcnVtIHNpemUKICAgICAqIEBwYXJh\nbSBkaWdlc3RUeXBlCiAgICAgKiAgICAgICBkaWdlc3QgdHlwZSwgZWl0aGVy\nIE1BQyBvciBDUkMzMgogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogICAg\nICAgcGFzc293cmQKICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAgY2Fs\nbGJhY2sgaW1wbGVtZW50YXRpb24KICAgICAqIEBwYXJhbSBjdHgKICAgICAq\nICAgICAgIG9wdGlvbmFsIGNvbnRyb2wgb2JqZWN0CiAgICAgKi8KCiAgICBM\nZWRnZXJDcmVhdGVPcChCb29rS2VlcGVyIGJrLCBpbnQgZW5zZW1ibGVTaXpl\nLAogICAgICAgICAgICAgICAgICAgaW50IHdyaXRlUXVvcnVtU2l6ZSwgaW50\nIGFja1F1b3J1bVNpemUsCiAgICAgICAgICAgICAgICAgICBEaWdlc3RUeXBl\nIGRpZ2VzdFR5cGUsCiAgICAgICAgICAgICAgICAgICBieXRlW10gcGFzc3dk\nLCBDcmVhdGVDYWxsYmFjayBjYiwgT2JqZWN0IGN0eCkgewogICAgICAgIHRo\naXMuYmsgPSBiazsKICAgICAgICB0aGlzLm1ldGFkYXRhID0gbmV3IExlZGdl\nck1ldGFkYXRhKGVuc2VtYmxlU2l6ZSwgd3JpdGVRdW9ydW1TaXplLCBhY2tR\ndW9ydW1TaXplLCBkaWdlc3RUeXBlLCBwYXNzd2QpOwogICAgICAgIHRoaXMu\nZGlnZXN0VHlwZSA9IGRpZ2VzdFR5cGU7CiAgICAgICAgdGhpcy5wYXNzd2Qg\nPSBwYXNzd2Q7CiAgICAgICAgdGhpcy5jYiA9IGNiOwogICAgICAgIHRoaXMu\nY3R4ID0gY3R4OwogICAgICAgIHRoaXMuc3RhcnRUaW1lID0gTWF0aFV0aWxz\nLm5vd0luTmFubygpOwogICAgICAgIHRoaXMuY3JlYXRlT3BMb2dnZXIgPSBi\nay5nZXRDcmVhdGVPcExvZ2dlcigpOwogICAgfQoKICAgIC8qKgogICAgICog\nSW5pdGlhdGVzIHRoZSBvcGVyYXRpb24KICAgICAqLwogICAgcHVibGljIHZv\naWQgaW5pdGlhdGUoKSB7CiAgICAgICAgLy8gYWxsb2NhdGUgZW5zZW1ibGUg\nZmlyc3QKCiAgICAgICAgLyoKICAgICAgICAgKiBBZGRpbmcgYm9va2llcyB0\nbyBsZWRnZXIgaGFuZGxlCiAgICAgICAgICovCgogICAgICAgIEFycmF5TGlz\ndDxCb29raWVTb2NrZXRBZGRyZXNzPiBlbnNlbWJsZTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBlbnNlbWJsZSA9IGJrLmJvb2tpZVdhdGNoZXIKICAg\nICAgICAgICAgICAgICAgICAubmV3RW5zZW1ibGUobWV0YWRhdGEuZ2V0RW5z\nZW1ibGVTaXplKCksIG1ldGFkYXRhLmdldFdyaXRlUXVvcnVtU2l6ZSgpKTsK\nICAgICAgICB9IGNhdGNoIChCS05vdEVub3VnaEJvb2tpZXNFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIk5vdCBlbm91Z2ggYm9va2ll\ncyB0byBjcmVhdGUgbGVkZ2VyIik7CiAgICAgICAgICAgIGNyZWF0ZUNvbXBs\nZXRlKGUuZ2V0Q29kZSgpLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KCiAgICAgICAgLyoKICAgICAgICAgKiBBZGQgZW5zZW1ibGUg\ndG8gdGhlIGNvbmZpZ3VyYXRpb24KICAgICAgICAgKi8KICAgICAgICBtZXRh\nZGF0YS5hZGRFbnNlbWJsZSgwTCwgZW5zZW1ibGUpOwoKICAgICAgICAvLyBj\ncmVhdGUgYSBsZWRnZXIgd2l0aCBtZXRhZGF0YQogICAgICAgIGJrLmdldExl\nZGdlck1hbmFnZXIoKS5jcmVhdGVMZWRnZXIobWV0YWRhdGEsIHRoaXMpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ2FsbGJhY2sgd2hlbiBjcmVhdGVkIGxl\nZGdlci4KICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBv\ncGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIExvbmcgbGVkZ2VySWQpIHsKICAg\nICAgICBpZiAoQktFeGNlcHRpb24uQ29kZS5PSyAhPSByYykgewogICAgICAg\nICAgICBjcmVhdGVDb21wbGV0ZShyYywgbnVsbCk7CiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxo\nID0gbmV3IExlZGdlckhhbmRsZShiaywgbGVkZ2VySWQsIG1ldGFkYXRhLCBk\naWdlc3RUeXBlLCBwYXNzd2QpOwogICAgICAgIH0gY2F0Y2ggKEdlbmVyYWxT\nZWN1cml0eUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigi\nU2VjdXJpdHkgZXhjZXB0aW9uIHdoaWxlIGNyZWF0aW5nIGxlZGdlcjogIiAr\nIGxlZGdlcklkLCBlKTsKICAgICAgICAgICAgY3JlYXRlQ29tcGxldGUoQktF\neGNlcHRpb24uQ29kZS5EaWdlc3ROb3RJbml0aWFsaXplZEV4Y2VwdGlvbiwg\nbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGNhdGNoIChO\ndW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJy\nb3IoIkluY29ycmVjdGx5IGVudGVyZWQgcGFyYW1ldGVyIHRocm90dGxlOiAi\nICsgYmsuZ2V0Q29uZigpLmdldFRocm90dGxlVmFsdWUoKSwgZSk7CiAgICAg\nICAgICAgIGNyZWF0ZUNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuSW5jb3Jy\nZWN0UGFyYW1ldGVyRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KICAgICAgICAvLyByZXR1cm4gdGhlIGxlZGdlciBo\nYW5kbGUgYmFjawogICAgICAgIGNyZWF0ZUNvbXBsZXRlKEJLRXhjZXB0aW9u\nLkNvZGUuT0ssIGxoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY3JlYXRl\nQ29tcGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUgbGgpIHsKICAgICAgICAv\nLyBPcGVuZWQgYSBuZXcgbGVkZ2VyCiAgICAgICAgaWYgKEJLRXhjZXB0aW9u\nLkNvZGUuT0sgIT0gcmMpIHsKICAgICAgICAgICAgY3JlYXRlT3BMb2dnZXIu\ncmVnaXN0ZXJGYWlsZWRFdmVudChNYXRoVXRpbHMuZWxhcHNlZE1TZWMoc3Rh\ncnRUaW1lKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3JlYXRl\nT3BMb2dnZXIucmVnaXN0ZXJTdWNjZXNzZnVsRXZlbnQoTWF0aFV0aWxzLmVs\nYXBzZWRNU2VjKHN0YXJ0VGltZSkpOwogICAgICAgIH0KICAgICAgICBjYi5j\ncmVhdGVDb21wbGV0ZShyYywgbGgsIGN0eCk7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

