{"sha":"af21f442dba35d8761247d9766a6a1f7a38a89f0","node_id":"MDQ6QmxvYjE1NzU5NTY6YWYyMWY0NDJkYmEzNWQ4NzYxMjQ3ZDk3NjZhNmExZjdhMzhhODlmMA==","size":5636,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/af21f442dba35d8761247d9766a6a1f7a38a89f0","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb24uQktEaWdl\nc3RNYXRjaEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuRGlnZXN0TWFuYWdlci5SZWNvdmVyeURhdGE7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFs\nQ2FsbGJhY2tzLlJlYWRFbnRyeUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVByb3RvY29sOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmJ1ZmZlci5DaGFubmVsQnVmZmVy\nOwoKLyoqCiAqIFRoaXMgY2xhc3MgZW5jYXBzdWxhdGVkIHRoZSByZWFkIGxh\nc3QgY29uZmlybWVkIG9wZXJhdGlvbi4KICoKICovCmNsYXNzIFJlYWRMYXN0\nQ29uZmlybWVkT3AgaW1wbGVtZW50cyBSZWFkRW50cnlDYWxsYmFjayB7CiAg\nICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKFJlYWRMYXN0Q29uZmlybWVkT3AuY2xhc3MpOwogICAgTGVkZ2Vy\nSGFuZGxlIGxoOwogICAgaW50IG51bVJlc3BvbnNlc1BlbmRpbmc7CiAgICBS\nZWNvdmVyeURhdGEgbWF4UmVjb3ZlcmVkRGF0YTsKICAgIHZvbGF0aWxlIGJv\nb2xlYW4gY29tcGxldGVkID0gZmFsc2U7CiAgICBpbnQgbGFzdFNlZW5FcnJv\nciA9IEJLRXhjZXB0aW9uLkNvZGUuUmVhZEV4Y2VwdGlvbjsKCiAgICBMYXN0\nQ29uZmlybWVkRGF0YUNhbGxiYWNrIGNiOwogICAgZmluYWwgRGlzdHJpYnV0\naW9uU2NoZWR1bGUuUXVvcnVtQ292ZXJhZ2VTZXQgY292ZXJhZ2VTZXQ7Cgog\nICAgLyoqCiAgICAgKiBXcmFwcGVyIHRvIGdldCBhbGwgcmVjb3ZlcmVkIGRh\ndGEgZnJvbSB0aGUgcmVxdWVzdAogICAgICovCiAgICBpbnRlcmZhY2UgTGFz\ndENvbmZpcm1lZERhdGFDYWxsYmFjayB7CiAgICAgICAgcHVibGljIHZvaWQg\ncmVhZExhc3RDb25maXJtZWREYXRhQ29tcGxldGUoaW50IHJjLCBSZWNvdmVy\neURhdGEgZGF0YSk7CiAgICB9CgogICAgcHVibGljIFJlYWRMYXN0Q29uZmly\nbWVkT3AoTGVkZ2VySGFuZGxlIGxoLCBMYXN0Q29uZmlybWVkRGF0YUNhbGxi\nYWNrIGNiKSB7CiAgICAgICAgdGhpcy5jYiA9IGNiOwogICAgICAgIHRoaXMu\nbWF4UmVjb3ZlcmVkRGF0YSA9IG5ldyBSZWNvdmVyeURhdGEoTGVkZ2VySGFu\nZGxlLklOVkFMSURfRU5UUllfSUQsIDApOwogICAgICAgIHRoaXMubGggPSBs\naDsKICAgICAgICB0aGlzLm51bVJlc3BvbnNlc1BlbmRpbmcgPSBsaC5tZXRh\nZGF0YS5nZXRFbnNlbWJsZVNpemUoKTsKICAgICAgICB0aGlzLmNvdmVyYWdl\nU2V0ID0gbGguZGlzdHJpYnV0aW9uU2NoZWR1bGUuZ2V0Q292ZXJhZ2VTZXQo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbml0aWF0ZSgpIHsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGxoLm1ldGFkYXRhLmN1cnJlbnRFbnNl\nbWJsZS5zaXplKCk7IGkrKykgewogICAgICAgICAgICBsaC5iay5ib29raWVD\nbGllbnQucmVhZEVudHJ5KGxoLm1ldGFkYXRhLmN1cnJlbnRFbnNlbWJsZS5n\nZXQoaSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbGgubGVkZ2VySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgQm9va2llUHJvdG9jb2wuTEFTVF9BRERfQ09ORklSTUVE\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRo\naXMsIGkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbml0\naWF0ZVdpdGhGZW5jaW5nKCkgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbGgubWV0YWRhdGEuY3VycmVudEVuc2VtYmxlLnNpemUoKTsgaSsrKSB7\nCiAgICAgICAgICAgIGxoLmJrLmJvb2tpZUNsaWVudC5yZWFkRW50cnlBbmRG\nZW5jZUxlZGdlcihsaC5tZXRhZGF0YS5jdXJyZW50RW5zZW1ibGUuZ2V0KGkp\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbGgubGVkZ2VySWQsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaC5sZWRnZXJL\nZXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBCb29raWVQcm90b2NvbC5MQVNUX0FERF9DT05GSVJN\nRUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB0aGlzLCBpKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIHN5bmNocm9uaXplZCB2b2lkIHJlYWRFbnRyeUNvbXBsZXRlKGZp\nbmFsIGludCByYywgZmluYWwgbG9uZyBsZWRnZXJJZCwgZmluYWwgbG9uZyBl\nbnRyeUlkLAogICAgICAgICAgICBmaW5hbCBDaGFubmVsQnVmZmVyIGJ1ZmZl\nciwgZmluYWwgT2JqZWN0IGN0eCkgewogICAgICAgIGludCBib29raWVJbmRl\neCA9IChJbnRlZ2VyKSBjdHg7CgogICAgICAgIG51bVJlc3BvbnNlc1BlbmRp\nbmctLTsKICAgICAgICBib29sZWFuIGhlYXJkVmFsaWRSZXNwb25zZSA9IGZh\nbHNlOwogICAgICAgIGlmIChyYyA9PSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBSZWNvdmVyeURh\ndGEgcmVjb3ZlcnlEYXRhID0gbGgubWFjTWFuYWdlci52ZXJpZnlEaWdlc3RB\nbmRSZXR1cm5MYXN0Q29uZmlybWVkKGJ1ZmZlcik7CiAgICAgICAgICAgICAg\nICBpZiAocmVjb3ZlcnlEYXRhLmxhc3RBZGRDb25maXJtZWQgPiBtYXhSZWNv\ndmVyZWREYXRhLmxhc3RBZGRDb25maXJtZWQpIHsKICAgICAgICAgICAgICAg\nICAgICBtYXhSZWNvdmVyZWREYXRhID0gcmVjb3ZlcnlEYXRhOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgaGVhcmRWYWxpZFJlc3BvbnNl\nID0gdHJ1ZTsKICAgICAgICAgICAgfSBjYXRjaCAoQktEaWdlc3RNYXRjaEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBUb28gYmFkLCB0aGlz\nIGJvb2tpZSBkaWRuJ3QgZ2l2ZSB1cyBhIHZhbGlkIGFuc3dlciwgd2UKICAg\nICAgICAgICAgICAgIC8vIHN0aWxsIG1pZ2h0IGJlIGFibGUgdG8gcmVjb3Zl\nciB0aG91Z2ggc28gY29udGludWUKICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiTWFjIG1pc21hdGNoIGZvciBsZWRnZXI6ICIgKyBsZWRnZXJJZCArICIs\nIGVudHJ5OiAiICsgZW50cnlJZAogICAgICAgICAgICAgICAgICAgICAgICAg\nICsgIiB3aGlsZSByZWFkaW5nIGxhc3QgZW50cnkgZnJvbSBib29raWU6ICIK\nICAgICAgICAgICAgICAgICAgICAgICAgICArIGxoLm1ldGFkYXRhLmN1cnJl\nbnRFbnNlbWJsZS5nZXQoYm9va2llSW5kZXgpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUu\nTm9TdWNoTGVkZ2VyRXhpc3RzRXhjZXB0aW9uIHx8IHJjID09IEJLRXhjZXB0\naW9uLkNvZGUuTm9TdWNoRW50cnlFeGNlcHRpb24pIHsKICAgICAgICAgICAg\nLy8gdGhpcyBzdGlsbCBjb3VudHMgYXMgYSB2YWxpZCByZXNwb25zZSwgZS5n\nLiwgaWYgdGhlIGNsaWVudCBjcmFzaGVkIHdpdGhvdXQgd3JpdGluZyBhbnkg\nZW50cnkKICAgICAgICAgICAgaGVhcmRWYWxpZFJlc3BvbnNlID0gdHJ1ZTsK\nICAgICAgICB9CgogICAgICAgIGlmIChyYyA9PSBCS0V4Y2VwdGlvbi5Db2Rl\nLlVuYXV0aG9yaXplZEFjY2Vzc0V4Y2VwdGlvbiAgJiYgIWNvbXBsZXRlZCkg\newogICAgICAgICAgICBjYi5yZWFkTGFzdENvbmZpcm1lZERhdGFDb21wbGV0\nZShyYywgbWF4UmVjb3ZlcmVkRGF0YSk7CiAgICAgICAgICAgIGNvbXBsZXRl\nZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWhlYXJkVmFsaWRS\nZXNwb25zZSAmJiBCS0V4Y2VwdGlvbi5Db2RlLk9LICE9IHJjKSB7CiAgICAg\nICAgICAgIGxhc3RTZWVuRXJyb3IgPSByYzsKICAgICAgICB9CgogICAgICAg\nIC8vIG90aGVyIHJldHVybiBjb2RlcyBkb250IGNvdW50IGFzIHZhbGlkIHJl\nc3BvbnNlcwogICAgICAgIGlmIChoZWFyZFZhbGlkUmVzcG9uc2UKICAgICAg\nICAgICAgJiYgY292ZXJhZ2VTZXQuYWRkQm9va2llQW5kQ2hlY2tDb3ZlcmVk\nKGJvb2tpZUluZGV4KQogICAgICAgICAgICAmJiAhY29tcGxldGVkKSB7CiAg\nICAgICAgICAgIGNvbXBsZXRlZCA9IHRydWU7CiAgICAgICAgICAgIExPRy5k\nZWJ1ZygiUmVhZCBDb21wbGV0ZSB3aXRoIGVub3VnaCB2YWxpZFJlc3BvbnNl\ncyBmb3IgbGVkZ2VyOiB7fSwgZW50cnk6IHt9IiwKICAgICAgICAgICAgICAg\nIGxlZGdlcklkLCBlbnRyeUlkKTsKCiAgICAgICAgICAgIGNiLnJlYWRMYXN0\nQ29uZmlybWVkRGF0YUNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuT0ssIG1h\neFJlY292ZXJlZERhdGEpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nfQoKICAgICAgICBpZiAobnVtUmVzcG9uc2VzUGVuZGluZyA9PSAwICYmICFj\nb21wbGV0ZWQpIHsKICAgICAgICAgICAgLy8gSGF2ZSBnb3QgYWxsIHJlc3Bv\nbnNlcyBiYWNrIGJ1dCB3YXMgc3RpbGwgbm90IGVub3VnaCwganVzdCBmYWls\nIHRoZSBvcGVyYXRpb24KICAgICAgICAgICAgTE9HLmVycm9yKCJXaGlsZSBy\nZWFkTGFzdENvbmZpcm1lZCBsZWRnZXI6ICIgKyBsZWRnZXJJZCArICIgZGlk\nIG5vdCBoZWFyIHN1Y2Nlc3MgcmVzcG9uc2VzIGZyb20gYWxsIHF1b3J1bXMi\nKTsKICAgICAgICAgICAgY2IucmVhZExhc3RDb25maXJtZWREYXRhQ29tcGxl\ndGUobGFzdFNlZW5FcnJvciwgbWF4UmVjb3ZlcmVkRGF0YSk7CiAgICAgICAg\nfQoKICAgIH0KfQo=\n","encoding":"base64"}

