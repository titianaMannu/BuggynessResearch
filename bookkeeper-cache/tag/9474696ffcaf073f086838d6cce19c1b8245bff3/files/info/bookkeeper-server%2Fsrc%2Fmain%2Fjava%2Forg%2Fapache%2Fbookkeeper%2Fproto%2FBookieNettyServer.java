{"sha":"b623998aea07f564d4fc3bf141e8b890d8d70634","node_id":"MDQ6QmxvYjE1NzU5NTY6YjYyMzk5OGFlYTA3ZjU2NGQ0ZmMzYmYxNDFlOGI4OTBkOGQ3MDYzNA==","size":7356,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/b623998aea07f564d4fc3bf141e8b890d8d70634","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90bzsKCmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuSW5l\ndFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5F\neGVjdXRvcnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMu\nQXRvbWljQm9vbGVhbjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nYm9va2llLkJvb2tpZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5i\nb29raWUuQm9va2llRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm9jZXNzb3IuUmVxdWVzdFByb2Nlc3NvcjsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5ib290c3RyYXAuU2VydmVyQm9vdHN0\ncmFwOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbDsK\naW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxGYWN0b3J5\nOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbEhhbmRs\nZXJDb250ZXh0OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hh\nbm5lbFBpcGVsaW5lOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwu\nQ2hhbm5lbFBpcGVsaW5lRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0\neS5jaGFubmVsLkNoYW5uZWxTdGF0ZUV2ZW50OwppbXBvcnQgb3JnLmpib3Nz\nLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbHM7CmltcG9ydCBvcmcuamJvc3MubmV0\ndHkuY2hhbm5lbC5TaW1wbGVDaGFubmVsSGFuZGxlcjsKaW1wb3J0IG9yZy5q\nYm9zcy5uZXR0eS5jaGFubmVsLmdyb3VwLkNoYW5uZWxHcm91cDsKaW1wb3J0\nIG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLmdyb3VwLkNoYW5uZWxHcm91cEZ1\ndHVyZTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLmdyb3VwLkRl\nZmF1bHRDaGFubmVsR3JvdXA7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hh\nbm5lbC5zb2NrZXQubmlvLk5pb1NlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5\nOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmhhbmRsZXIuY29kZWMuZnJhbWUu\nTGVuZ3RoRmllbGRCYXNlZEZyYW1lRGVjb2RlcjsKaW1wb3J0IG9yZy5qYm9z\ncy5uZXR0eS5oYW5kbGVyLmNvZGVjLmZyYW1lLkxlbmd0aEZpZWxkUHJlcGVu\nZGVyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0\nai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUuY29tbW9uLmFu\nbm90YXRpb25zLlZpc2libGVGb3JUZXN0aW5nOwppbXBvcnQgY29tLmdvb2ds\nZS5jb21tb24udXRpbC5jb25jdXJyZW50LlRocmVhZEZhY3RvcnlCdWlsZGVy\nOwoKLyoqCiAqIE5ldHR5IHNlcnZlciBmb3Igc2VydmluZyBib29raWUgcmVx\ndWVzdHMKICovCmNsYXNzIEJvb2tpZU5ldHR5U2VydmVyIHsKICAgIHByaXZh\ndGUgZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihCb29raWVOZXR0eVNlcnZlci5jbGFzcyk7CgogICAgZmluYWwg\nc3RhdGljIGludCBtYXhNZXNzYWdlU2l6ZSA9IDB4ZmZmZmY7CiAgICBmaW5h\nbCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmY7CiAgICBmaW5hbCBDaGFubmVs\nRmFjdG9yeSBzZXJ2ZXJDaGFubmVsRmFjdG9yeTsKICAgIGZpbmFsIFJlcXVl\nc3RQcm9jZXNzb3IgcmVxdWVzdFByb2Nlc3NvcjsKICAgIGZpbmFsIENoYW5u\nZWxHcm91cCBhbGxDaGFubmVscyA9IG5ldyBDbGVhbnVwQ2hhbm5lbEdyb3Vw\nKCk7CiAgICBmaW5hbCBBdG9taWNCb29sZWFuIGlzUnVubmluZyA9IG5ldyBB\ndG9taWNCb29sZWFuKGZhbHNlKTsKICAgIE9iamVjdCBzdXNwZW5zaW9uTG9j\nayA9IG5ldyBPYmplY3QoKTsKICAgIGJvb2xlYW4gc3VzcGVuZGVkID0gZmFs\nc2U7CgogICAgQm9va2llTmV0dHlTZXJ2ZXIoU2VydmVyQ29uZmlndXJhdGlv\nbiBjb25mLCBSZXF1ZXN0UHJvY2Vzc29yIHByb2Nlc3NvcikKICAgICAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24sIEludGVy\ncnVwdGVkRXhjZXB0aW9uLCBCb29raWVFeGNlcHRpb24gIHsKICAgICAgICB0\naGlzLmNvbmYgPSBjb25mOwogICAgICAgIHRoaXMucmVxdWVzdFByb2Nlc3Nv\nciA9IHByb2Nlc3NvcjsKCiAgICAgICAgVGhyZWFkRmFjdG9yeUJ1aWxkZXIg\ndGZiID0gbmV3IFRocmVhZEZhY3RvcnlCdWlsZGVyKCk7CiAgICAgICAgU3Ry\naW5nIGJhc2UgPSAiYm9va2llLSIgKyBjb25mLmdldEJvb2tpZVBvcnQoKSAr\nICItbmV0dHkiOwogICAgICAgIHNlcnZlckNoYW5uZWxGYWN0b3J5ID0gbmV3\nIE5pb1NlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5KAogICAgICAgICAgICAg\nICAgRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2wodGZiLnNldE5hbWVG\nb3JtYXQoYmFzZSArICItYm9zcy0lZCIpLmJ1aWxkKCkpLAogICAgICAgICAg\nICAgICAgRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2wodGZiLnNldE5h\nbWVGb3JtYXQoYmFzZSArICItd29ya2VyLSVkIikuYnVpbGQoKSkpOwogICAg\nICAgIEluZXRTb2NrZXRBZGRyZXNzIGJpbmRBZGRyZXNzOwogICAgICAgIGlm\nIChjb25mLmdldExpc3RlbmluZ0ludGVyZmFjZSgpID09IG51bGwpIHsKICAg\nICAgICAgICAgLy8gbGlzdGVuIG9uIGFsbCBpbnRlcmZhY2VzCiAgICAgICAg\nICAgIGJpbmRBZGRyZXNzID0gbmV3IEluZXRTb2NrZXRBZGRyZXNzKGNvbmYu\nZ2V0Qm9va2llUG9ydCgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICBiaW5kQWRkcmVzcyA9IEJvb2tpZS5nZXRCb29raWVBZGRyZXNzKGNvbmYp\nLmdldFNvY2tldEFkZHJlc3MoKTsKICAgICAgICB9CiAgICAgICAgbGlzdGVu\nT24oYmluZEFkZHJlc3MpOwogICAgfQoKICAgIGJvb2xlYW4gaXNSdW5uaW5n\nKCkgewogICAgICAgIHJldHVybiBpc1J1bm5pbmcuZ2V0KCk7CiAgICB9Cgog\nICAgQFZpc2libGVGb3JUZXN0aW5nCiAgICB2b2lkIHN1c3BlbmRQcm9jZXNz\naW5nKCkgewogICAgICAgIHN5bmNocm9uaXplZCAoc3VzcGVuc2lvbkxvY2sp\nIHsKICAgICAgICAgICAgc3VzcGVuZGVkID0gdHJ1ZTsKICAgICAgICAgICAg\nYWxsQ2hhbm5lbHMuc2V0UmVhZGFibGUoZmFsc2UpLmF3YWl0VW5pbnRlcnJ1\ncHRpYmx5KCk7CiAgICAgICAgfQogICAgfQoKICAgIEBWaXNpYmxlRm9yVGVz\ndGluZwogICAgdm9pZCByZXN1bWVQcm9jZXNzaW5nKCkgewogICAgICAgIHN5\nbmNocm9uaXplZCAoc3VzcGVuc2lvbkxvY2spIHsKICAgICAgICAgICAgc3Vz\ncGVuZGVkID0gZmFsc2U7CiAgICAgICAgICAgIGFsbENoYW5uZWxzLnNldFJl\nYWRhYmxlKHRydWUpLmF3YWl0VW5pbnRlcnJ1cHRpYmx5KCk7CiAgICAgICAg\nICAgIHN1c3BlbnNpb25Mb2NrLm5vdGlmeUFsbCgpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgbGlzdGVuT24oSW5ldFNvY2tldEFkZHJl\nc3MgYWRkcmVzcykgewogICAgICAgIFNlcnZlckJvb3RzdHJhcCBib290c3Ry\nYXAgPSBuZXcgU2VydmVyQm9vdHN0cmFwKHNlcnZlckNoYW5uZWxGYWN0b3J5\nKTsKICAgICAgICBib290c3RyYXAuc2V0UGlwZWxpbmVGYWN0b3J5KG5ldyBC\nb29raWVQaXBlbGluZUZhY3RvcnkoKSk7CiAgICAgICAgYm9vdHN0cmFwLnNl\ndE9wdGlvbigiY2hpbGQudGNwTm9EZWxheSIsIGNvbmYuZ2V0U2VydmVyVGNw\nTm9EZWxheSgpKTsKICAgICAgICBib290c3RyYXAuc2V0T3B0aW9uKCJjaGls\nZC5zb0xpbmdlciIsIDIpOwoKICAgICAgICBDaGFubmVsIGxpc3RlbiA9IGJv\nb3RzdHJhcC5iaW5kKGFkZHJlc3MpOwogICAgICAgIGFsbENoYW5uZWxzLmFk\nZChsaXN0ZW4pOwogICAgfQoKICAgIHZvaWQgc3RhcnQoKSB7CiAgICAgICAg\naXNSdW5uaW5nLnNldCh0cnVlKTsKICAgIH0KCiAgICB2b2lkIHNodXRkb3du\nKCkgewogICAgICAgIExPRy5pbmZvKCJTaHV0dGluZyBkb3duIEJvb2tpZU5l\ndHR5U2VydmVyIik7CiAgICAgICAgaXNSdW5uaW5nLnNldChmYWxzZSk7CiAg\nICAgICAgYWxsQ2hhbm5lbHMuY2xvc2UoKS5hd2FpdFVuaW50ZXJydXB0aWJs\neSgpOwogICAgICAgIHNlcnZlckNoYW5uZWxGYWN0b3J5LnJlbGVhc2VFeHRl\ncm5hbFJlc291cmNlcygpOwogICAgfQoKICAgIHByaXZhdGUgY2xhc3MgQm9v\na2llUGlwZWxpbmVGYWN0b3J5IGltcGxlbWVudHMgQ2hhbm5lbFBpcGVsaW5l\nRmFjdG9yeSB7CiAgICAgICAgcHVibGljIENoYW5uZWxQaXBlbGluZSBnZXRQ\naXBlbGluZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBzeW5j\naHJvbml6ZWQgKHN1c3BlbnNpb25Mb2NrKSB7CiAgICAgICAgICAgICAgICB3\naGlsZSAoc3VzcGVuZGVkKSB7CiAgICAgICAgICAgICAgICAgICAgc3VzcGVu\nc2lvbkxvY2sud2FpdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgICAgIENoYW5uZWxQaXBlbGluZSBwaXBlbGluZSA9IENo\nYW5uZWxzLnBpcGVsaW5lKCk7CiAgICAgICAgICAgIHBpcGVsaW5lLmFkZExh\nc3QoImxlbmd0aGJhc2VkZGVjb2RlciIsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbmV3IExlbmd0aEZpZWxkQmFzZWRGcmFtZURlY29kZXIobWF4\nTWVzc2FnZVNpemUsIDAsIDQsIDAsIDQpKTsKICAgICAgICAgICAgcGlwZWxp\nbmUuYWRkTGFzdCgibGVuZ3RocHJlcGVuZGVyIiwgbmV3IExlbmd0aEZpZWxk\nUHJlcGVuZGVyKDQpKTsKCiAgICAgICAgICAgIHBpcGVsaW5lLmFkZExhc3Qo\nImJvb2tpZVByb3RvRGVjb2RlciIsIG5ldyBCb29raWVQcm90b0VuY29kaW5n\nLlJlcXVlc3REZWNvZGVyKCkpOwogICAgICAgICAgICBwaXBlbGluZS5hZGRM\nYXN0KCJib29raWVQcm90b0VuY29kZXIiLCBuZXcgQm9va2llUHJvdG9FbmNv\nZGluZy5SZXNwb25zZUVuY29kZXIoKSk7CiAgICAgICAgICAgIFNpbXBsZUNo\nYW5uZWxIYW5kbGVyIHJlcXVlc3RIYW5kbGVyID0gaXNSdW5uaW5nLmdldCgp\nID8KICAgICAgICAgICAgICAgICAgICBuZXcgQm9va2llUmVxdWVzdEhhbmRs\nZXIoY29uZiwgcmVxdWVzdFByb2Nlc3NvciwgYWxsQ2hhbm5lbHMpCiAgICAg\nICAgICAgICAgICAgICAgOiBuZXcgUmVqZWN0UmVxdWVzdEhhbmRsZXIoKTsK\nICAgICAgICAgICAgcGlwZWxpbmUuYWRkTGFzdCgiYm9va2llUmVxdWVzdEhh\nbmRsZXIiLCByZXF1ZXN0SGFuZGxlcik7CiAgICAgICAgICAgIHJldHVybiBw\naXBlbGluZTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMg\nY2xhc3MgUmVqZWN0UmVxdWVzdEhhbmRsZXIgZXh0ZW5kcyBTaW1wbGVDaGFu\nbmVsSGFuZGxlciB7CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIGNoYW5uZWxPcGVuKENoYW5uZWxIYW5kbGVyQ29udGV4dCBjdHgs\nIENoYW5uZWxTdGF0ZUV2ZW50IGUpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgICAgICBjdHguZ2V0Q2hhbm5lbCgpLmNsb3NlKCk7CiAgICAgICAgfQoK\nICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBDbGVhbnVwQ2hhbm5l\nbEdyb3VwIGV4dGVuZHMgRGVmYXVsdENoYW5uZWxHcm91cCB7CiAgICAgICAg\ncHJpdmF0ZSBBdG9taWNCb29sZWFuIGNsb3NlZCA9IG5ldyBBdG9taWNCb29s\nZWFuKGZhbHNlKTsKCiAgICAgICAgQ2xlYW51cENoYW5uZWxHcm91cCgpIHsK\nICAgICAgICAgICAgc3VwZXIoIkJvb2tpZUNoYW5uZWxHcm91cCIpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gYWRkKENoYW5uZWwgY2hhbm5lbCkgewogICAgICAgICAgICBib29sZWFu\nIHJldCA9IHN1cGVyLmFkZChjaGFubmVsKTsKICAgICAgICAgICAgaWYgKGNs\nb3NlZC5nZXQoKSkgewogICAgICAgICAgICAgICAgY2hhbm5lbC5jbG9zZSgp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXQ7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgQ2hhbm5l\nbEdyb3VwRnV0dXJlIGNsb3NlKCkgewogICAgICAgICAgICBjbG9zZWQuc2V0\nKHRydWUpOwogICAgICAgICAgICByZXR1cm4gc3VwZXIuY2xvc2UoKTsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBib29s\nZWFuIGVxdWFscyhPYmplY3QgbykgewogICAgICAgICAgICBpZiAoIShvIGlu\nc3RhbmNlb2YgQ2xlYW51cENoYW5uZWxHcm91cCkpIHsKICAgICAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBD\nbGVhbnVwQ2hhbm5lbEdyb3VwIG90aGVyID0gKENsZWFudXBDaGFubmVsR3Jv\ndXApbzsKICAgICAgICAgICAgcmV0dXJuIG90aGVyLmNsb3NlZC5nZXQoKSA9\nPSBjbG9zZWQuZ2V0KCkKICAgICAgICAgICAgICAgICYmIHN1cGVyLmVxdWFs\ncyhvdGhlcik7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAgICAgICByZXR1cm4g\nc3VwZXIuaGFzaENvZGUoKSAqIDE3ICsgKGNsb3NlZC5nZXQoKSA/IDEgOiAw\nKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

