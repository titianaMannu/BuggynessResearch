{"sha":"9fec15fa6bc0e3a0c5cb62c7b160be9a90b7094b","node_id":"MDQ6QmxvYjE1NzU5NTY6OWZlYzE1ZmE2YmMwZTNhMGM1Y2I2MmM3YjE2MGJlOWE5MGI3MDk0Yg==","size":7471,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/9fec15fa6bc0e3a0c5cb62c7b160be9a90b7094b","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90bzsKCmlt\ncG9ydCBjb20uZ29vZ2xlLmNvbW1vbi51dGlsLmNvbmN1cnJlbnQuVGhyZWFk\nRmFjdG9yeUJ1aWxkZXI7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5F\neGVjdXRvclNlcnZpY2U7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5F\neGVjdXRvcnM7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tp\nZS5Cb29raWU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5T\nZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb2Nlc3Nvci5SZXF1ZXN0UHJvY2Vzc29yOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnN0YXRzLk9wU3RhdHNMb2dnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuc3RhdHMuU3RhdHNMb2dnZXI7CmltcG9y\ndCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5DaGFubmVsOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwoKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2ll\nLkJvb2tLZWVwZXJTZXJ2ZXJTdGF0cy5BRERfRU5UUlk7CmltcG9ydCBzdGF0\naWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5Cb29rS2VlcGVyU2Vy\ndmVyU3RhdHMuQUREX0VOVFJZX1JFUVVFU1Q7CmltcG9ydCBzdGF0aWMgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5Cb29rS2VlcGVyU2VydmVyU3Rh\ndHMuUkVBRF9FTlRSWTsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuYm9va2llLkJvb2tLZWVwZXJTZXJ2ZXJTdGF0cy5SRUFEX0VOVFJZ\nX1JFUVVFU1Q7CgpwdWJsaWMgY2xhc3MgQm9va2llUmVxdWVzdFByb2Nlc3Nv\nciBpbXBsZW1lbnRzIFJlcXVlc3RQcm9jZXNzb3IgewoKICAgIHByaXZhdGUg\nZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihCb29raWVSZXF1ZXN0UHJvY2Vzc29yLmNsYXNzKTsKICAgIC8qKgog\nICAgICogVGhlIHNlcnZlciBjb25maWd1cmF0aW9uLiBXZSB1c2UgdGhpcyBm\nb3IgZ2V0dGluZyB0aGUgbnVtYmVyIG9mIGFkZCBhbmQgcmVhZAogICAgICog\nd29ya2VyIHRocmVhZHMuCiAgICAgKi8KICAgIHByaXZhdGUgZmluYWwgU2Vy\ndmVyQ29uZmlndXJhdGlvbiBzZXJ2ZXJDZmc7CgogICAgLyoqCiAgICAgKiBU\naGlzIGlzIHRoZSBCb29raWUgaW5zdGFuY2UgdGhhdCBpcyB1c2VkIHRvIGhh\nbmRsZSBhbGwgcmVhZCBhbmQgd3JpdGUgcmVxdWVzdHMuCiAgICAgKi8KICAg\nIGZpbmFsIEJvb2tpZSBib29raWU7CgogICAgLyoqCiAgICAgKiBUaGUgdGhy\nZWFkcG9vbCB1c2VkIHRvIGV4ZWN1dGUgYWxsIHJlYWQgZW50cnkgcmVxdWVz\ndHMgaXNzdWVkIHRvIHRoaXMgc2VydmVyLgogICAgICovCiAgICBwcml2YXRl\nIGZpbmFsIEV4ZWN1dG9yU2VydmljZSByZWFkVGhyZWFkUG9vbDsKCiAgICAv\nKioKICAgICAqIFRoZSB0aHJlYWRwb29sIHVzZWQgdG8gZXhlY3V0ZSBhbGwg\nYWRkIGVudHJ5IHJlcXVlc3RzIGlzc3VlZCB0byB0aGlzIHNlcnZlci4KICAg\nICAqLwogICAgcHJpdmF0ZSBmaW5hbCBFeGVjdXRvclNlcnZpY2Ugd3JpdGVU\naHJlYWRQb29sOwoKICAgIC8vIEV4cG9zZSBTdGF0cwogICAgcHJpdmF0ZSBm\naW5hbCBCS1N0YXRzIGJrU3RhdHMgPSBCS1N0YXRzLmdldEluc3RhbmNlKCk7\nCiAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gc3RhdHNFbmFibGVkOwogICAg\nZmluYWwgT3BTdGF0c0xvZ2dlciBhZGRSZXF1ZXN0U3RhdHM7CiAgICBmaW5h\nbCBPcFN0YXRzTG9nZ2VyIGFkZEVudHJ5U3RhdHM7CiAgICBmaW5hbCBPcFN0\nYXRzTG9nZ2VyIHJlYWRSZXF1ZXN0U3RhdHM7CiAgICBmaW5hbCBPcFN0YXRz\nTG9nZ2VyIHJlYWRFbnRyeVN0YXRzOwoKICAgIHB1YmxpYyBCb29raWVSZXF1\nZXN0UHJvY2Vzc29yKFNlcnZlckNvbmZpZ3VyYXRpb24gc2VydmVyQ2ZnLCBC\nb29raWUgYm9va2llLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgU3RhdHNMb2dnZXIgc3RhdHNMb2dnZXIpIHsKICAgICAgICB0aGlzLnNl\ncnZlckNmZyA9IHNlcnZlckNmZzsKICAgICAgICB0aGlzLmJvb2tpZSA9IGJv\nb2tpZTsKICAgICAgICB0aGlzLnJlYWRUaHJlYWRQb29sID0KICAgICAgICAg\nICAgY3JlYXRlRXhlY3V0b3IodGhpcy5zZXJ2ZXJDZmcuZ2V0TnVtUmVhZFdv\ncmtlclRocmVhZHMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJv\nb2tpZVJlYWRUaHJlYWQtIiArIHNlcnZlckNmZy5nZXRCb29raWVQb3J0KCkg\nKyAiLSVkIik7CiAgICAgICAgdGhpcy53cml0ZVRocmVhZFBvb2wgPQogICAg\nICAgICAgICBjcmVhdGVFeGVjdXRvcih0aGlzLnNlcnZlckNmZy5nZXROdW1B\nZGRXb3JrZXJUaHJlYWRzKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICJCb29raWVXcml0ZVRocmVhZC0iICsgc2VydmVyQ2ZnLmdldEJvb2tpZVBv\ncnQoKSArICItJWQiKTsKICAgICAgICAvLyBFeHBvc2UgU3RhdHMKICAgICAg\nICB0aGlzLnN0YXRzRW5hYmxlZCA9IHNlcnZlckNmZy5pc1N0YXRpc3RpY3NF\nbmFibGVkKCk7CiAgICAgICAgdGhpcy5hZGRFbnRyeVN0YXRzID0gc3RhdHNM\nb2dnZXIuZ2V0T3BTdGF0c0xvZ2dlcihBRERfRU5UUlkpOwogICAgICAgIHRo\naXMuYWRkUmVxdWVzdFN0YXRzID0gc3RhdHNMb2dnZXIuZ2V0T3BTdGF0c0xv\nZ2dlcihBRERfRU5UUllfUkVRVUVTVCk7CiAgICAgICAgdGhpcy5yZWFkRW50\ncnlTdGF0cyA9IHN0YXRzTG9nZ2VyLmdldE9wU3RhdHNMb2dnZXIoUkVBRF9F\nTlRSWSk7CiAgICAgICAgdGhpcy5yZWFkUmVxdWVzdFN0YXRzID0gc3RhdHNM\nb2dnZXIuZ2V0T3BTdGF0c0xvZ2dlcihSRUFEX0VOVFJZX1JFUVVFU1QpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7\nCiAgICAgICAgc2h1dGRvd25FeGVjdXRvcih3cml0ZVRocmVhZFBvb2wpOwog\nICAgICAgIHNodXRkb3duRXhlY3V0b3IocmVhZFRocmVhZFBvb2wpOwogICAg\nfQoKICAgIHByaXZhdGUgRXhlY3V0b3JTZXJ2aWNlIGNyZWF0ZUV4ZWN1dG9y\nKGludCBudW1UaHJlYWRzLCBTdHJpbmcgbmFtZUZvcm1hdCkgewogICAgICAg\nIGlmIChudW1UaHJlYWRzIDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIEV4ZWN1\ndG9ycy5uZXdGaXhlZFRocmVhZFBvb2wobnVtVGhyZWFkcywKICAgICAgICAg\nICAgICAgIG5ldyBUaHJlYWRGYWN0b3J5QnVpbGRlcigpLnNldE5hbWVGb3Jt\nYXQobmFtZUZvcm1hdCkuYnVpbGQoKSk7CiAgICAgICAgfQogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCBzaHV0ZG93bkV4ZWN1dG9yKEV4ZWN1dG9yU2Vydmlj\nZSBzZXJ2aWNlKSB7CiAgICAgICAgaWYgKG51bGwgIT0gc2VydmljZSkgewog\nICAgICAgICAgICBzZXJ2aWNlLnNodXRkb3duKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcHJvY2Vzc1JlcXVl\nc3QoT2JqZWN0IG1zZywgQ2hhbm5lbCBjKSB7CiAgICAgICAgLy8gSWYgd2Ug\nY2FuIGRlY29kZSB0aGlzIHBhY2tldCBhcyBhIFJlcXVlc3QgcHJvdG9idWYg\ncGFja2V0LCBwcm9jZXNzCiAgICAgICAgLy8gaXQgYXMgYSB2ZXJzaW9uIDMg\ncGFja2V0LiBFbHNlLCBqdXN0IHVzZSB0aGUgb2xkIHByb3RvY29sLgogICAg\nICAgIGlmIChtc2cgaW5zdGFuY2VvZiBCb29ra2VlcGVyUHJvdG9jb2wuUmVx\ndWVzdCkgewogICAgICAgICAgICBCb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVz\ndCByID0gKEJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0KSBtc2c7CiAgICAg\nICAgICAgIEJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciBoZWFk\nZXIgPSByLmdldEhlYWRlcigpOwogICAgICAgICAgICBzd2l0Y2ggKGhlYWRl\nci5nZXRPcGVyYXRpb24oKSkgewogICAgICAgICAgICAgICAgY2FzZSBBRERf\nRU5UUlk6CiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0FkZFJlcXVlc3RW\nMyhyLCBjKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgUkVBRF9FTlRSWToKICAgICAgICAgICAgICAgICAgICBw\ncm9jZXNzUmVhZFJlcXVlc3RWMyhyLCBjKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAg\nICAgICAgICAgQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNlLkJ1aWxkZXIg\ncmVzcG9uc2UgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQm9va2tl\nZXBlclByb3RvY29sLlJlc3BvbnNlLm5ld0J1aWxkZXIoKS5zZXRIZWFkZXIo\nci5nZXRIZWFkZXIoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5z\nZXRTdGF0dXMoQm9va2tlZXBlclByb3RvY29sLlN0YXR1c0NvZGUuRUJBRFJF\nUSk7CiAgICAgICAgICAgICAgICAgICAgYy53cml0ZShyZXNwb25zZS5idWls\nZCgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHNFbmFibGVkKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJrU3RhdHMuZ2V0T3BTdGF0cyhC\nS1N0YXRzLlNUQVRTX1VOS05PV04pLmluY3JlbWVudEZhaWxlZE9wcygpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nIEJvb2tpZVByb3RvY29sLlJlcXVlc3QgciA9IChCb29raWVQcm90b2NvbC5S\nZXF1ZXN0KSBtc2c7CiAgICAgICAgICAgIC8vIHByb2Nlc3MgcGFja2V0CiAg\nICAgICAgICAgIHN3aXRjaCAoci5nZXRPcENvZGUoKSkgewogICAgICAgICAg\nICAgICAgY2FzZSBCb29raWVQcm90b2NvbC5BRERFTlRSWToKICAgICAgICAg\nICAgICAgICAgICBwcm9jZXNzQWRkUmVxdWVzdChyLCBjKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgQm9va2ll\nUHJvdG9jb2wuUkVBREVOVFJZOgogICAgICAgICAgICAgICAgICAgIHByb2Nl\nc3NSZWFkUmVxdWVzdChyLCBjKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAg\nICAgTE9HLmVycm9yKCJVbmtub3duIG9wIHR5cGUge30sIHNlbmRpbmcgZXJy\nb3IiLCByLmdldE9wQ29kZSgpKTsKICAgICAgICAgICAgICAgICAgICBjLndy\naXRlKFJlc3BvbnNlQnVpbGRlci5idWlsZEVycm9yUmVzcG9uc2UoQm9va2ll\nUHJvdG9jb2wuRUJBRFJFUSwgcikpOwogICAgICAgICAgICAgICAgICAgIGlm\nIChzdGF0c0VuYWJsZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmtT\ndGF0cy5nZXRPcFN0YXRzKEJLU3RhdHMuU1RBVFNfVU5LTk9XTikuaW5jcmVt\nZW50RmFpbGVkT3BzKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgfQoKICAgIHByaXZhdGUgdm9pZCBwcm9jZXNzQWRkUmVxdWVzdFYzKGZp\nbmFsIEJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0IHIsIGZpbmFsIENoYW5u\nZWwgYykgewogICAgICAgIFdyaXRlRW50cnlQcm9jZXNzb3JWMyB3cml0ZSA9\nIG5ldyBXcml0ZUVudHJ5UHJvY2Vzc29yVjMociwgYywgdGhpcyk7CiAgICAg\nICAgaWYgKG51bGwgPT0gd3JpdGVUaHJlYWRQb29sKSB7CiAgICAgICAgICAg\nIHdyaXRlLnJ1bigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHdy\naXRlVGhyZWFkUG9vbC5zdWJtaXQod3JpdGUpOwogICAgICAgIH0KICAgIH0K\nCiAgICBwcml2YXRlIHZvaWQgcHJvY2Vzc1JlYWRSZXF1ZXN0VjMoZmluYWwg\nQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3QgciwgZmluYWwgQ2hhbm5lbCBj\nKSB7CiAgICAgICAgUmVhZEVudHJ5UHJvY2Vzc29yVjMgcmVhZCA9IG5ldyBS\nZWFkRW50cnlQcm9jZXNzb3JWMyhyLCBjLCB0aGlzKTsKICAgICAgICBpZiAo\nbnVsbCA9PSByZWFkVGhyZWFkUG9vbCkgewogICAgICAgICAgICByZWFkLnJ1\nbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlYWRUaHJlYWRQ\nb29sLnN1Ym1pdChyZWFkKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0\nZSB2b2lkIHByb2Nlc3NBZGRSZXF1ZXN0KGZpbmFsIEJvb2tpZVByb3RvY29s\nLlJlcXVlc3QgciwgZmluYWwgQ2hhbm5lbCBjKSB7CiAgICAgICAgV3JpdGVF\nbnRyeVByb2Nlc3NvciB3cml0ZSA9IG5ldyBXcml0ZUVudHJ5UHJvY2Vzc29y\nKHIsIGMsIHRoaXMpOwogICAgICAgIGlmIChudWxsID09IHdyaXRlVGhyZWFk\nUG9vbCkgewogICAgICAgICAgICB3cml0ZS5ydW4oKTsKICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICB3cml0ZVRocmVhZFBvb2wuc3VibWl0KHdyaXRl\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHByb2Nlc3NS\nZWFkUmVxdWVzdChmaW5hbCBCb29raWVQcm90b2NvbC5SZXF1ZXN0IHIsIGZp\nbmFsIENoYW5uZWwgYykgewogICAgICAgIFJlYWRFbnRyeVByb2Nlc3NvciBy\nZWFkID0gbmV3IFJlYWRFbnRyeVByb2Nlc3NvcihyLCBjLCB0aGlzKTsKICAg\nICAgICBpZiAobnVsbCA9PSByZWFkVGhyZWFkUG9vbCkgewogICAgICAgICAg\nICByZWFkLnJ1bigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJl\nYWRUaHJlYWRQb29sLnN1Ym1pdChyZWFkKTsKICAgICAgICB9CiAgICB9Cgp9\nCg==\n","encoding":"base64"}

