{"sha":"57d350328e11dffd224382828ab26abcaafaa8b6","node_id":"MDQ6QmxvYjE1NzU5NTY6NTdkMzUwMzI4ZTExZGZmZDIyNDM4MjgyOGFiMjZhYmNhYWZhYThiNg==","size":180123,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/57d350328e11dffd224382828ab26abcaafaa8b6","content":"Ly8gR2VuZXJhdGVkIGJ5IHRoZSBwcm90b2NvbCBidWZmZXIgY29tcGlsZXIu\nICBETyBOT1QgRURJVCEKLy8gc291cmNlOiBzcmMvbWFpbi9wcm90by9Cb29r\na2VlcGVyUHJvdG9jb2wucHJvdG8KCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvOwoKcHVibGljIGZpbmFsIGNsYXNzIEJvb2trZWVwZXJQ\ncm90b2NvbCB7CiAgcHJpdmF0ZSBCb29ra2VlcGVyUHJvdG9jb2woKSB7fQog\nIHB1YmxpYyBzdGF0aWMgdm9pZCByZWdpc3RlckFsbEV4dGVuc2lvbnMoCiAg\nICAgIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnkgcmVn\naXN0cnkpIHsKICB9CiAgcHVibGljIGVudW0gUHJvdG9jb2xWZXJzaW9uCiAg\nICAgIGltcGxlbWVudHMgY29tLmdvb2dsZS5wcm90b2J1Zi5Qcm90b2NvbE1l\nc3NhZ2VFbnVtIHsKICAgIFZFUlNJT05fT05FKDAsIDEpLAogICAgVkVSU0lP\nTl9UV08oMSwgMiksCiAgICBWRVJTSU9OX1RIUkVFKDIsIDMpLAogICAgOwog\nICAgCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBWRVJTSU9OX09ORV9W\nQUxVRSA9IDE7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBWRVJTSU9O\nX1RXT19WQUxVRSA9IDI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBW\nRVJTSU9OX1RIUkVFX1ZBTFVFID0gMzsKICAgIAogICAgCiAgICBwdWJsaWMg\nZmluYWwgaW50IGdldE51bWJlcigpIHsgcmV0dXJuIHZhbHVlOyB9CiAgICAK\nICAgIHB1YmxpYyBzdGF0aWMgUHJvdG9jb2xWZXJzaW9uIHZhbHVlT2YoaW50\nIHZhbHVlKSB7CiAgICAgIHN3aXRjaCAodmFsdWUpIHsKICAgICAgICBjYXNl\nIDE6IHJldHVybiBWRVJTSU9OX09ORTsKICAgICAgICBjYXNlIDI6IHJldHVy\nbiBWRVJTSU9OX1RXTzsKICAgICAgICBjYXNlIDM6IHJldHVybiBWRVJTSU9O\nX1RIUkVFOwogICAgICAgIGRlZmF1bHQ6IHJldHVybiBudWxsOwogICAgICB9\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY29tLmdvb2dsZS5wcm90\nb2J1Zi5JbnRlcm5hbC5FbnVtTGl0ZU1hcDxQcm90b2NvbFZlcnNpb24+CiAg\nICAgICAgaW50ZXJuYWxHZXRWYWx1ZU1hcCgpIHsKICAgICAgcmV0dXJuIGlu\ndGVybmFsVmFsdWVNYXA7CiAgICB9CiAgICBwcml2YXRlIHN0YXRpYyBjb20u\nZ29vZ2xlLnByb3RvYnVmLkludGVybmFsLkVudW1MaXRlTWFwPFByb3RvY29s\nVmVyc2lvbj4KICAgICAgICBpbnRlcm5hbFZhbHVlTWFwID0KICAgICAgICAg\nIG5ldyBjb20uZ29vZ2xlLnByb3RvYnVmLkludGVybmFsLkVudW1MaXRlTWFw\nPFByb3RvY29sVmVyc2lvbj4oKSB7CiAgICAgICAgICAgIHB1YmxpYyBQcm90\nb2NvbFZlcnNpb24gZmluZFZhbHVlQnlOdW1iZXIoaW50IG51bWJlcikgewog\nICAgICAgICAgICAgIHJldHVybiBQcm90b2NvbFZlcnNpb24udmFsdWVPZihu\ndW1iZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgCiAgICBw\ndWJsaWMgZmluYWwgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5F\nbnVtVmFsdWVEZXNjcmlwdG9yCiAgICAgICAgZ2V0VmFsdWVEZXNjcmlwdG9y\nKCkgewogICAgICByZXR1cm4gZ2V0RGVzY3JpcHRvcigpLmdldFZhbHVlcygp\nLmdldChpbmRleCk7CiAgICB9CiAgICBwdWJsaWMgZmluYWwgY29tLmdvb2ds\nZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5FbnVtRGVzY3JpcHRvcgogICAgICAg\nIGdldERlc2NyaXB0b3JGb3JUeXBlKCkgewogICAgICByZXR1cm4gZ2V0RGVz\nY3JpcHRvcigpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBmaW5hbCBjb20u\nZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3JzLkVudW1EZXNjcmlwdG9yCiAg\nICAgICAgZ2V0RGVzY3JpcHRvcigpIHsKICAgICAgcmV0dXJuIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuZ2V0RGVz\nY3JpcHRvcigpLmdldEVudW1UeXBlcygpLmdldCgwKTsKICAgIH0KICAgIAog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgUHJvdG9jb2xWZXJzaW9uW10gVkFM\nVUVTID0gewogICAgICBWRVJTSU9OX09ORSwgVkVSU0lPTl9UV08sIFZFUlNJ\nT05fVEhSRUUsIAogICAgfTsKICAgIAogICAgcHVibGljIHN0YXRpYyBQcm90\nb2NvbFZlcnNpb24gdmFsdWVPZigKICAgICAgICBjb20uZ29vZ2xlLnByb3Rv\nYnVmLkRlc2NyaXB0b3JzLkVudW1WYWx1ZURlc2NyaXB0b3IgZGVzYykgewog\nICAgICBpZiAoZGVzYy5nZXRUeXBlKCkgIT0gZ2V0RGVzY3JpcHRvcigpKSB7\nCiAgICAgICAgdGhyb3cgbmV3IGphdmEubGFuZy5JbGxlZ2FsQXJndW1lbnRF\neGNlcHRpb24oCiAgICAgICAgICAiRW51bVZhbHVlRGVzY3JpcHRvciBpcyBu\nb3QgZm9yIHRoaXMgdHlwZS4iKTsKICAgICAgfQogICAgICByZXR1cm4gVkFM\nVUVTW2Rlc2MuZ2V0SW5kZXgoKV07CiAgICB9CiAgICAKICAgIHByaXZhdGUg\nZmluYWwgaW50IGluZGV4OwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgdmFsdWU7\nCiAgICAKICAgIHByaXZhdGUgUHJvdG9jb2xWZXJzaW9uKGludCBpbmRleCwg\naW50IHZhbHVlKSB7CiAgICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgICAg\ndGhpcy52YWx1ZSA9IHZhbHVlOwogICAgfQogICAgCiAgICAvLyBAQHByb3Rv\nY19pbnNlcnRpb25fcG9pbnQoZW51bV9zY29wZTpQcm90b2NvbFZlcnNpb24p\nCiAgfQogIAogIHB1YmxpYyBlbnVtIFN0YXR1c0NvZGUKICAgICAgaW1wbGVt\nZW50cyBjb20uZ29vZ2xlLnByb3RvYnVmLlByb3RvY29sTWVzc2FnZUVudW0g\newogICAgRU9LKDAsIDApLAogICAgRU5PTEVER0VSKDEsIDQwMiksCiAgICBF\nTk9FTlRSWSgyLCA0MDMpLAogICAgRUJBRFJFUSgzLCA0MDQpLAogICAgRUlP\nKDQsIDUwMSksCiAgICBFVUEoNSwgNTAyKSwKICAgIEVCQURWRVJTSU9OKDYs\nIDUwMyksCiAgICBFRkVOQ0VEKDcsIDUwNCksCiAgICBFUkVBRE9OTFkoOCwg\nNTA1KSwKICAgIDsKICAgIAogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQg\nRU9LX1ZBTFVFID0gMDsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEVO\nT0xFREdFUl9WQUxVRSA9IDQwMjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IEVOT0VOVFJZX1ZBTFVFID0gNDAzOwogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBpbnQgRUJBRFJFUV9WQUxVRSA9IDQwNDsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IEVJT19WQUxVRSA9IDUwMTsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IEVVQV9WQUxVRSA9IDUwMjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IEVCQURWRVJTSU9OX1ZBTFVFID0gNTAzOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgRUZFTkNFRF9WQUxVRSA9IDUwNDsKICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEVSRUFET05MWV9WQUxVRSA9IDUw\nNTsKICAgIAogICAgCiAgICBwdWJsaWMgZmluYWwgaW50IGdldE51bWJlcigp\nIHsgcmV0dXJuIHZhbHVlOyB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgU3Rh\ndHVzQ29kZSB2YWx1ZU9mKGludCB2YWx1ZSkgewogICAgICBzd2l0Y2ggKHZh\nbHVlKSB7CiAgICAgICAgY2FzZSAwOiByZXR1cm4gRU9LOwogICAgICAgIGNh\nc2UgNDAyOiByZXR1cm4gRU5PTEVER0VSOwogICAgICAgIGNhc2UgNDAzOiBy\nZXR1cm4gRU5PRU5UUlk7CiAgICAgICAgY2FzZSA0MDQ6IHJldHVybiBFQkFE\nUkVROwogICAgICAgIGNhc2UgNTAxOiByZXR1cm4gRUlPOwogICAgICAgIGNh\nc2UgNTAyOiByZXR1cm4gRVVBOwogICAgICAgIGNhc2UgNTAzOiByZXR1cm4g\nRUJBRFZFUlNJT047CiAgICAgICAgY2FzZSA1MDQ6IHJldHVybiBFRkVOQ0VE\nOwogICAgICAgIGNhc2UgNTA1OiByZXR1cm4gRVJFQURPTkxZOwogICAgICAg\nIGRlZmF1bHQ6IHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgICAKICAg\nIHB1YmxpYyBzdGF0aWMgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnRlcm5hbC5F\nbnVtTGl0ZU1hcDxTdGF0dXNDb2RlPgogICAgICAgIGludGVybmFsR2V0VmFs\ndWVNYXAoKSB7CiAgICAgIHJldHVybiBpbnRlcm5hbFZhbHVlTWFwOwogICAg\nfQogICAgcHJpdmF0ZSBzdGF0aWMgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnRl\ncm5hbC5FbnVtTGl0ZU1hcDxTdGF0dXNDb2RlPgogICAgICAgIGludGVybmFs\nVmFsdWVNYXAgPQogICAgICAgICAgbmV3IGNvbS5nb29nbGUucHJvdG9idWYu\nSW50ZXJuYWwuRW51bUxpdGVNYXA8U3RhdHVzQ29kZT4oKSB7CiAgICAgICAg\nICAgIHB1YmxpYyBTdGF0dXNDb2RlIGZpbmRWYWx1ZUJ5TnVtYmVyKGludCBu\ndW1iZXIpIHsKICAgICAgICAgICAgICByZXR1cm4gU3RhdHVzQ29kZS52YWx1\nZU9mKG51bWJlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAK\nICAgIHB1YmxpYyBmaW5hbCBjb20uZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0\nb3JzLkVudW1WYWx1ZURlc2NyaXB0b3IKICAgICAgICBnZXRWYWx1ZURlc2Ny\naXB0b3IoKSB7CiAgICAgIHJldHVybiBnZXREZXNjcmlwdG9yKCkuZ2V0VmFs\ndWVzKCkuZ2V0KGluZGV4KTsKICAgIH0KICAgIHB1YmxpYyBmaW5hbCBjb20u\nZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3JzLkVudW1EZXNjcmlwdG9yCiAg\nICAgICAgZ2V0RGVzY3JpcHRvckZvclR5cGUoKSB7CiAgICAgIHJldHVybiBn\nZXREZXNjcmlwdG9yKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRW51bURlc2NyaXB0\nb3IKICAgICAgICBnZXREZXNjcmlwdG9yKCkgewogICAgICByZXR1cm4gb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5n\nZXREZXNjcmlwdG9yKCkuZ2V0RW51bVR5cGVzKCkuZ2V0KDEpOwogICAgfQog\nICAgCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdGF0dXNDb2RlW10gVkFM\nVUVTID0gewogICAgICBFT0ssIEVOT0xFREdFUiwgRU5PRU5UUlksIEVCQURS\nRVEsIEVJTywgRVVBLCBFQkFEVkVSU0lPTiwgRUZFTkNFRCwgRVJFQURPTkxZ\nLCAKICAgIH07CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgU3RhdHVzQ29kZSB2\nYWx1ZU9mKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRv\ncnMuRW51bVZhbHVlRGVzY3JpcHRvciBkZXNjKSB7CiAgICAgIGlmIChkZXNj\nLmdldFR5cGUoKSAhPSBnZXREZXNjcmlwdG9yKCkpIHsKICAgICAgICB0aHJv\ndyBuZXcgamF2YS5sYW5nLklsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigKICAg\nICAgICAgICJFbnVtVmFsdWVEZXNjcmlwdG9yIGlzIG5vdCBmb3IgdGhpcyB0\neXBlLiIpOwogICAgICB9CiAgICAgIHJldHVybiBWQUxVRVNbZGVzYy5nZXRJ\nbmRleCgpXTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmaW5hbCBpbnQgaW5k\nZXg7CiAgICBwcml2YXRlIGZpbmFsIGludCB2YWx1ZTsKICAgIAogICAgcHJp\ndmF0ZSBTdGF0dXNDb2RlKGludCBpbmRleCwgaW50IHZhbHVlKSB7CiAgICAg\nIHRoaXMuaW5kZXggPSBpbmRleDsKICAgICAgdGhpcy52YWx1ZSA9IHZhbHVl\nOwogICAgfQogICAgCiAgICAvLyBAQHByb3RvY19pbnNlcnRpb25fcG9pbnQo\nZW51bV9zY29wZTpTdGF0dXNDb2RlKQogIH0KICAKICBwdWJsaWMgZW51bSBP\ncGVyYXRpb25UeXBlCiAgICAgIGltcGxlbWVudHMgY29tLmdvb2dsZS5wcm90\nb2J1Zi5Qcm90b2NvbE1lc3NhZ2VFbnVtIHsKICAgIFJFQURfRU5UUlkoMCwg\nMSksCiAgICBBRERfRU5UUlkoMSwgMiksCiAgICBSQU5HRV9SRUFEX0VOVFJZ\nKDIsIDMpLAogICAgUkFOR0VfQUREX0VOVFJZKDMsIDQpLAogICAgOwogICAg\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBSRUFEX0VOVFJZX1ZBTFVF\nID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEFERF9FTlRSWV9W\nQUxVRSA9IDI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBSQU5HRV9S\nRUFEX0VOVFJZX1ZBTFVFID0gMzsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IFJBTkdFX0FERF9FTlRSWV9WQUxVRSA9IDQ7CiAgICAKICAgIAogICAg\ncHVibGljIGZpbmFsIGludCBnZXROdW1iZXIoKSB7IHJldHVybiB2YWx1ZTsg\nfQogICAgCiAgICBwdWJsaWMgc3RhdGljIE9wZXJhdGlvblR5cGUgdmFsdWVP\nZihpbnQgdmFsdWUpIHsKICAgICAgc3dpdGNoICh2YWx1ZSkgewogICAgICAg\nIGNhc2UgMTogcmV0dXJuIFJFQURfRU5UUlk7CiAgICAgICAgY2FzZSAyOiBy\nZXR1cm4gQUREX0VOVFJZOwogICAgICAgIGNhc2UgMzogcmV0dXJuIFJBTkdF\nX1JFQURfRU5UUlk7CiAgICAgICAgY2FzZSA0OiByZXR1cm4gUkFOR0VfQURE\nX0VOVFJZOwogICAgICAgIGRlZmF1bHQ6IHJldHVybiBudWxsOwogICAgICB9\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY29tLmdvb2dsZS5wcm90\nb2J1Zi5JbnRlcm5hbC5FbnVtTGl0ZU1hcDxPcGVyYXRpb25UeXBlPgogICAg\nICAgIGludGVybmFsR2V0VmFsdWVNYXAoKSB7CiAgICAgIHJldHVybiBpbnRl\ncm5hbFZhbHVlTWFwOwogICAgfQogICAgcHJpdmF0ZSBzdGF0aWMgY29tLmdv\nb2dsZS5wcm90b2J1Zi5JbnRlcm5hbC5FbnVtTGl0ZU1hcDxPcGVyYXRpb25U\neXBlPgogICAgICAgIGludGVybmFsVmFsdWVNYXAgPQogICAgICAgICAgbmV3\nIGNvbS5nb29nbGUucHJvdG9idWYuSW50ZXJuYWwuRW51bUxpdGVNYXA8T3Bl\ncmF0aW9uVHlwZT4oKSB7CiAgICAgICAgICAgIHB1YmxpYyBPcGVyYXRpb25U\neXBlIGZpbmRWYWx1ZUJ5TnVtYmVyKGludCBudW1iZXIpIHsKICAgICAgICAg\nICAgICByZXR1cm4gT3BlcmF0aW9uVHlwZS52YWx1ZU9mKG51bWJlcik7CiAg\nICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAKICAgIHB1YmxpYyBmaW5h\nbCBjb20uZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3JzLkVudW1WYWx1ZURl\nc2NyaXB0b3IKICAgICAgICBnZXRWYWx1ZURlc2NyaXB0b3IoKSB7CiAgICAg\nIHJldHVybiBnZXREZXNjcmlwdG9yKCkuZ2V0VmFsdWVzKCkuZ2V0KGluZGV4\nKTsKICAgIH0KICAgIHB1YmxpYyBmaW5hbCBjb20uZ29vZ2xlLnByb3RvYnVm\nLkRlc2NyaXB0b3JzLkVudW1EZXNjcmlwdG9yCiAgICAgICAgZ2V0RGVzY3Jp\ncHRvckZvclR5cGUoKSB7CiAgICAgIHJldHVybiBnZXREZXNjcmlwdG9yKCk7\nCiAgICB9CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGNvbS5nb29nbGUucHJv\ndG9idWYuRGVzY3JpcHRvcnMuRW51bURlc2NyaXB0b3IKICAgICAgICBnZXRE\nZXNjcmlwdG9yKCkgewogICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5nZXREZXNjcmlwdG9yKCku\nZ2V0RW51bVR5cGVzKCkuZ2V0KDIpOwogICAgfQogICAgCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBPcGVyYXRpb25UeXBlW10gVkFMVUVTID0gewogICAg\nICBSRUFEX0VOVFJZLCBBRERfRU5UUlksIFJBTkdFX1JFQURfRU5UUlksIFJB\nTkdFX0FERF9FTlRSWSwgCiAgICB9OwogICAgCiAgICBwdWJsaWMgc3RhdGlj\nIE9wZXJhdGlvblR5cGUgdmFsdWVPZigKICAgICAgICBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkRlc2NyaXB0b3JzLkVudW1WYWx1ZURlc2NyaXB0b3IgZGVzYykg\newogICAgICBpZiAoZGVzYy5nZXRUeXBlKCkgIT0gZ2V0RGVzY3JpcHRvcigp\nKSB7CiAgICAgICAgdGhyb3cgbmV3IGphdmEubGFuZy5JbGxlZ2FsQXJndW1l\nbnRFeGNlcHRpb24oCiAgICAgICAgICAiRW51bVZhbHVlRGVzY3JpcHRvciBp\ncyBub3QgZm9yIHRoaXMgdHlwZS4iKTsKICAgICAgfQogICAgICByZXR1cm4g\nVkFMVUVTW2Rlc2MuZ2V0SW5kZXgoKV07CiAgICB9CiAgICAKICAgIHByaXZh\ndGUgZmluYWwgaW50IGluZGV4OwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgdmFs\ndWU7CiAgICAKICAgIHByaXZhdGUgT3BlcmF0aW9uVHlwZShpbnQgaW5kZXgs\nIGludCB2YWx1ZSkgewogICAgICB0aGlzLmluZGV4ID0gaW5kZXg7CiAgICAg\nIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgIH0KICAgIAogICAgLy8gQEBwcm90\nb2NfaW5zZXJ0aW9uX3BvaW50KGVudW1fc2NvcGU6T3BlcmF0aW9uVHlwZSkK\nICB9CiAgCiAgcHVibGljIGludGVyZmFjZSBCS1BhY2tldEhlYWRlck9yQnVp\nbGRlcgogICAgICBleHRlbmRzIGNvbS5nb29nbGUucHJvdG9idWYuTWVzc2Fn\nZU9yQnVpbGRlciB7CiAgICAKICAgIC8vIHJlcXVpcmVkIC5Qcm90b2NvbFZl\ncnNpb24gdmVyc2lvbiA9IDE7CiAgICBib29sZWFuIGhhc1ZlcnNpb24oKTsK\nICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUHJvdG9jb2xWZXJzaW9uIGdldFZlcnNpb24oKTsKICAgIAogICAg\nLy8gcmVxdWlyZWQgLk9wZXJhdGlvblR5cGUgb3BlcmF0aW9uID0gMjsKICAg\nIGJvb2xlYW4gaGFzT3BlcmF0aW9uKCk7CiAgICBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLk9wZXJhdGlvblR5cGUg\nZ2V0T3BlcmF0aW9uKCk7CiAgICAKICAgIC8vIHJlcXVpcmVkIHVpbnQ2NCB0\neG5JZCA9IDM7CiAgICBib29sZWFuIGhhc1R4bklkKCk7CiAgICBsb25nIGdl\ndFR4bklkKCk7CiAgfQogIHB1YmxpYyBzdGF0aWMgZmluYWwgY2xhc3MgQktQ\nYWNrZXRIZWFkZXIgZXh0ZW5kcwogICAgICBjb20uZ29vZ2xlLnByb3RvYnVm\nLkdlbmVyYXRlZE1lc3NhZ2UKICAgICAgaW1wbGVtZW50cyBCS1BhY2tldEhl\nYWRlck9yQnVpbGRlciB7CiAgICAvLyBVc2UgQktQYWNrZXRIZWFkZXIubmV3\nQnVpbGRlcigpIHRvIGNvbnN0cnVjdC4KICAgIHByaXZhdGUgQktQYWNrZXRI\nZWFkZXIoQnVpbGRlciBidWlsZGVyKSB7CiAgICAgIHN1cGVyKGJ1aWxkZXIp\nOwogICAgfQogICAgcHJpdmF0ZSBCS1BhY2tldEhlYWRlcihib29sZWFuIG5v\nSW5pdCkge30KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgQktQYWNr\nZXRIZWFkZXIgZGVmYXVsdEluc3RhbmNlOwogICAgcHVibGljIHN0YXRpYyBC\nS1BhY2tldEhlYWRlciBnZXREZWZhdWx0SW5zdGFuY2UoKSB7CiAgICAgIHJl\ndHVybiBkZWZhdWx0SW5zdGFuY2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBC\nS1BhY2tldEhlYWRlciBnZXREZWZhdWx0SW5zdGFuY2VGb3JUeXBlKCkgewog\nICAgICByZXR1cm4gZGVmYXVsdEluc3RhbmNlOwogICAgfQogICAgCiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3Jp\ncHRvcnMuRGVzY3JpcHRvcgogICAgICAgIGdldERlc2NyaXB0b3IoKSB7CiAg\nICAgIHJldHVybiBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLmludGVybmFsX3N0YXRpY19CS1BhY2tldEhlYWRlcl9k\nZXNjcmlwdG9yOwogICAgfQogICAgCiAgICBwcm90ZWN0ZWQgY29tLmdvb2ds\nZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJs\nZQogICAgICAgIGludGVybmFsR2V0RmllbGRBY2Nlc3NvclRhYmxlKCkgewog\nICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0aWNfQktQYWNrZXRIZWFkZXJf\nZmllbGRBY2Nlc3NvclRhYmxlOwogICAgfQogICAgCiAgICBwcml2YXRlIGlu\ndCBiaXRGaWVsZDBfOwogICAgLy8gcmVxdWlyZWQgLlByb3RvY29sVmVyc2lv\nbiB2ZXJzaW9uID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFZF\nUlNJT05fRklFTERfTlVNQkVSID0gMTsKICAgIHByaXZhdGUgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2Nv\nbFZlcnNpb24gdmVyc2lvbl87CiAgICBwdWJsaWMgYm9vbGVhbiBoYXNWZXJz\naW9uKCkgewogICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAw\nMSkgPT0gMHgwMDAwMDAwMSk7CiAgICB9CiAgICBwdWJsaWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2Nv\nbFZlcnNpb24gZ2V0VmVyc2lvbigpIHsKICAgICAgcmV0dXJuIHZlcnNpb25f\nOwogICAgfQogICAgCiAgICAvLyByZXF1aXJlZCAuT3BlcmF0aW9uVHlwZSBv\ncGVyYXRpb24gPSAyOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgT1BF\nUkFUSU9OX0ZJRUxEX05VTUJFUiA9IDI7CiAgICBwcml2YXRlIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuT3BlcmF0\naW9uVHlwZSBvcGVyYXRpb25fOwogICAgcHVibGljIGJvb2xlYW4gaGFzT3Bl\ncmF0aW9uKCkgewogICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAw\nMDAwMikgPT0gMHgwMDAwMDAwMik7CiAgICB9CiAgICBwdWJsaWMgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5PcGVy\nYXRpb25UeXBlIGdldE9wZXJhdGlvbigpIHsKICAgICAgcmV0dXJuIG9wZXJh\ndGlvbl87CiAgICB9CiAgICAKICAgIC8vIHJlcXVpcmVkIHVpbnQ2NCB0eG5J\nZCA9IDM7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBUWE5JRF9GSUVM\nRF9OVU1CRVIgPSAzOwogICAgcHJpdmF0ZSBsb25nIHR4bklkXzsKICAgIHB1\nYmxpYyBib29sZWFuIGhhc1R4bklkKCkgewogICAgICByZXR1cm4gKChiaXRG\naWVsZDBfICYgMHgwMDAwMDAwNCkgPT0gMHgwMDAwMDAwNCk7CiAgICB9CiAg\nICBwdWJsaWMgbG9uZyBnZXRUeG5JZCgpIHsKICAgICAgcmV0dXJuIHR4bklk\nXzsKICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGluaXRGaWVsZHMoKSB7\nCiAgICAgIHZlcnNpb25fID0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2NvbFZlcnNpb24uVkVSU0lPTl9P\nTkU7CiAgICAgIG9wZXJhdGlvbl8gPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLk9wZXJhdGlvblR5cGUuUkVBRF9F\nTlRSWTsKICAgICAgdHhuSWRfID0gMEw7CiAgICB9CiAgICBwcml2YXRlIGJ5\ndGUgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gLTE7CiAgICBwdWJsaWMgZmlu\nYWwgYm9vbGVhbiBpc0luaXRpYWxpemVkKCkgewogICAgICBieXRlIGlzSW5p\ndGlhbGl6ZWQgPSBtZW1vaXplZElzSW5pdGlhbGl6ZWQ7CiAgICAgIGlmIChp\nc0luaXRpYWxpemVkICE9IC0xKSByZXR1cm4gaXNJbml0aWFsaXplZCA9PSAx\nOwogICAgICAKICAgICAgaWYgKCFoYXNWZXJzaW9uKCkpIHsKICAgICAgICBt\nZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAwOwogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgfQogICAgICBpZiAoIWhhc09wZXJhdGlvbigpKSB7CiAgICAg\nICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFoYXNUeG5JZCgpKSB7CiAgICAg\nICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgIH0KICAgICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0g\nMTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2\nb2lkIHdyaXRlVG8oY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0\ncmVhbSBvdXRwdXQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93cyBq\nYXZhLmlvLklPRXhjZXB0aW9uIHsKICAgICAgZ2V0U2VyaWFsaXplZFNpemUo\nKTsKICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4\nMDAwMDAwMDEpKSB7CiAgICAgICAgb3V0cHV0LndyaXRlRW51bSgxLCB2ZXJz\naW9uXy5nZXROdW1iZXIoKSk7CiAgICAgIH0KICAgICAgaWYgKCgoYml0Rmll\nbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4MDAwMDAwMDIpKSB7CiAgICAgICAg\nb3V0cHV0LndyaXRlRW51bSgyLCBvcGVyYXRpb25fLmdldE51bWJlcigpKTsK\nICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwNCkg\nPT0gMHgwMDAwMDAwNCkpIHsKICAgICAgICBvdXRwdXQud3JpdGVVSW50NjQo\nMywgdHhuSWRfKTsKICAgICAgfQogICAgICBnZXRVbmtub3duRmllbGRzKCku\nd3JpdGVUbyhvdXRwdXQpOwogICAgfQogICAgCiAgICBwcml2YXRlIGludCBt\nZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gLTE7CiAgICBwdWJsaWMgaW50IGdl\ndFNlcmlhbGl6ZWRTaXplKCkgewogICAgICBpbnQgc2l6ZSA9IG1lbW9pemVk\nU2VyaWFsaXplZFNpemU7CiAgICAgIGlmIChzaXplICE9IC0xKSByZXR1cm4g\nc2l6ZTsKICAgIAogICAgICBzaXplID0gMDsKICAgICAgaWYgKCgoYml0Rmll\nbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpKSB7CiAgICAgICAg\nc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0cHV0U3RyZWFt\nCiAgICAgICAgICAuY29tcHV0ZUVudW1TaXplKDEsIHZlcnNpb25fLmdldE51\nbWJlcigpKTsKICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgw\nMDAwMDAwMikgPT0gMHgwMDAwMDAwMikpIHsKICAgICAgICBzaXplICs9IGNv\nbS5nb29nbGUucHJvdG9idWYuQ29kZWRPdXRwdXRTdHJlYW0KICAgICAgICAg\nIC5jb21wdXRlRW51bVNpemUoMiwgb3BlcmF0aW9uXy5nZXROdW1iZXIoKSk7\nCiAgICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQp\nID09IDB4MDAwMDAwMDQpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xl\nLnByb3RvYnVmLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0\nZVVJbnQ2NFNpemUoMywgdHhuSWRfKTsKICAgICAgfQogICAgICBzaXplICs9\nIGdldFVua25vd25GaWVsZHMoKS5nZXRTZXJpYWxpemVkU2l6ZSgpOwogICAg\nICBtZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gc2l6ZTsKICAgICAgcmV0dXJu\nIHNpemU7CiAgICB9CiAgICAKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGxv\nbmcgc2VyaWFsVmVyc2lvblVJRCA9IDBMOwogICAgQGphdmEubGFuZy5PdmVy\ncmlkZQogICAgcHJvdGVjdGVkIGphdmEubGFuZy5PYmplY3Qgd3JpdGVSZXBs\nYWNlKCkKICAgICAgICB0aHJvd3MgamF2YS5pby5PYmplY3RTdHJlYW1FeGNl\ncHRpb24gewogICAgICByZXR1cm4gc3VwZXIud3JpdGVSZXBsYWNlKCk7CiAg\nICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciBw\nYXJzZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3Ry\naW5nIGRhdGEpCiAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUucHJvdG9idWYu\nSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAgICAgcmV0dXJu\nIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oZGF0YSkuYnVpbGRQYXJzZWQoKTsK\nICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciBwYXJz\nZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5n\nIGRhdGEsCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25S\nZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dz\nIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhj\nZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20o\nZGF0YSwgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5idWls\nZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0\nSGVhZGVyIHBhcnNlRnJvbShieXRlW10gZGF0YSkKICAgICAgICB0aHJvd3Mg\nY29tLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNl\ncHRpb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShk\nYXRhKS5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLkJLUGFja2V0SGVhZGVyIHBhcnNlRnJvbSgKICAgICAgICBieXRlW10gZGF0\nYSwKICAgICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lz\ndHJ5TGl0ZSBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgY29t\nLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRp\nb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShkYXRh\nLCBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFy\nc2VkKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFk\nZXIgcGFyc2VGcm9tKGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQpCiAgICAg\nICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICByZXR1cm4g\nbmV3QnVpbGRlcigpLm1lcmdlRnJvbShpbnB1dCkuYnVpbGRQYXJzZWQoKTsK\nICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciBwYXJz\nZUZyb20oCiAgICAgICAgamF2YS5pby5JbnB1dFN0cmVhbSBpbnB1dCwKICAg\nICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0\nZSBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgamF2YS5pby5J\nT0V4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VG\ncm9tKGlucHV0LCBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAg\nLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQ\nYWNrZXRIZWFkZXIgcGFyc2VEZWxpbWl0ZWRGcm9tKGphdmEuaW8uSW5wdXRT\ndHJlYW0gaW5wdXQpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRp\nb24gewogICAgICBCdWlsZGVyIGJ1aWxkZXIgPSBuZXdCdWlsZGVyKCk7CiAg\nICAgIGlmIChidWlsZGVyLm1lcmdlRGVsaW1pdGVkRnJvbShpbnB1dCkpIHsK\nICAgICAgICByZXR1cm4gYnVpbGRlci5idWlsZFBhcnNlZCgpOwogICAgICB9\nIGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAg\nICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIgcGFyc2VEZWxpbWl0\nZWRGcm9tKAogICAgICAgIGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQsCiAg\nICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxp\ndGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dzIGphdmEuaW8u\nSU9FeGNlcHRpb24gewogICAgICBCdWlsZGVyIGJ1aWxkZXIgPSBuZXdCdWls\nZGVyKCk7CiAgICAgIGlmIChidWlsZGVyLm1lcmdlRGVsaW1pdGVkRnJvbShp\nbnB1dCwgZXh0ZW5zaW9uUmVnaXN0cnkpKSB7CiAgICAgICAgcmV0dXJuIGJ1\naWxkZXIuYnVpbGRQYXJzZWQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQogICAgcHVibGljIHN0YXRpYyBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLkJLUGFja2V0SGVhZGVyIHBhcnNlRnJvbSgKICAgICAgICBjb20uZ29vZ2xl\nLnByb3RvYnVmLkNvZGVkSW5wdXRTdHJlYW0gaW5wdXQpCiAgICAgICAgdGhy\nb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICByZXR1cm4gbmV3QnVp\nbGRlcigpLm1lcmdlRnJvbShpbnB1dCkuYnVpbGRQYXJzZWQoKTsKICAgIH0K\nICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciBwYXJzZUZyb20o\nCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZElucHV0U3RyZWFt\nIGlucHV0LAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9u\nUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93\ncyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxk\nZXIoKS5tZXJnZUZyb20oaW5wdXQsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAg\nICAgICAgICAgICAuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHN0YXRpYyBCdWlsZGVyIG5ld0J1aWxkZXIoKSB7IHJldHVybiBCdWls\nZGVyLmNyZWF0ZSgpOyB9CiAgICBwdWJsaWMgQnVpbGRlciBuZXdCdWlsZGVy\nRm9yVHlwZSgpIHsgcmV0dXJuIG5ld0J1aWxkZXIoKTsgfQogICAgcHVibGlj\nIHN0YXRpYyBCdWlsZGVyIG5ld0J1aWxkZXIob3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciBw\ncm90b3R5cGUpIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZy\nb20ocHJvdG90eXBlKTsKICAgIH0KICAgIHB1YmxpYyBCdWlsZGVyIHRvQnVp\nbGRlcigpIHsgcmV0dXJuIG5ld0J1aWxkZXIodGhpcyk7IH0KICAgIAogICAg\nQGphdmEubGFuZy5PdmVycmlkZQogICAgcHJvdGVjdGVkIEJ1aWxkZXIgbmV3\nQnVpbGRlckZvclR5cGUoCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5H\nZW5lcmF0ZWRNZXNzYWdlLkJ1aWxkZXJQYXJlbnQgcGFyZW50KSB7CiAgICAg\nIEJ1aWxkZXIgYnVpbGRlciA9IG5ldyBCdWlsZGVyKHBhcmVudCk7CiAgICAg\nIHJldHVybiBidWlsZGVyOwogICAgfQogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBjbGFzcyBCdWlsZGVyIGV4dGVuZHMKICAgICAgICBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuQnVpbGRlcjxCdWlsZGVyPgogICAg\nICAgaW1wbGVtZW50cyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyT3JCdWlsZGVyIHsKICAg\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBjb20uZ29vZ2xlLnByb3RvYnVmLkRl\nc2NyaXB0b3JzLkRlc2NyaXB0b3IKICAgICAgICAgIGdldERlc2NyaXB0b3Io\nKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuaW50ZXJuYWxfc3RhdGljX0JLUGFja2V0\nSGVhZGVyX2Rlc2NyaXB0b3I7CiAgICAgIH0KICAgICAgCiAgICAgIHByb3Rl\nY3RlZCBjb20uZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuRmll\nbGRBY2Nlc3NvclRhYmxlCiAgICAgICAgICBpbnRlcm5hbEdldEZpZWxkQWNj\nZXNzb3JUYWJsZSgpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0\naWNfQktQYWNrZXRIZWFkZXJfZmllbGRBY2Nlc3NvclRhYmxlOwogICAgICB9\nCiAgICAgIAogICAgICAvLyBDb25zdHJ1Y3QgdXNpbmcgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhl\nYWRlci5uZXdCdWlsZGVyKCkKICAgICAgcHJpdmF0ZSBCdWlsZGVyKCkgewog\nICAgICAgIG1heWJlRm9yY2VCdWlsZGVySW5pdGlhbGl6YXRpb24oKTsKICAg\nICAgfQogICAgICAKICAgICAgcHJpdmF0ZSBCdWlsZGVyKEJ1aWxkZXJQYXJl\nbnQgcGFyZW50KSB7CiAgICAgICAgc3VwZXIocGFyZW50KTsKICAgICAgICBt\nYXliZUZvcmNlQnVpbGRlckluaXRpYWxpemF0aW9uKCk7CiAgICAgIH0KICAg\nICAgcHJpdmF0ZSB2b2lkIG1heWJlRm9yY2VCdWlsZGVySW5pdGlhbGl6YXRp\nb24oKSB7CiAgICAgICAgaWYgKGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJh\ndGVkTWVzc2FnZS5hbHdheXNVc2VGaWVsZEJ1aWxkZXJzKSB7CiAgICAgICAg\nfQogICAgICB9CiAgICAgIHByaXZhdGUgc3RhdGljIEJ1aWxkZXIgY3JlYXRl\nKCkgewogICAgICAgIHJldHVybiBuZXcgQnVpbGRlcigpOwogICAgICB9CiAg\nICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBjbGVhcigpIHsKICAgICAgICBz\ndXBlci5jbGVhcigpOwogICAgICAgIHZlcnNpb25fID0gb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2NvbFZl\ncnNpb24uVkVSU0lPTl9PTkU7CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRG\naWVsZDBfICYgfjB4MDAwMDAwMDEpOwogICAgICAgIG9wZXJhdGlvbl8gPSBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLk9wZXJhdGlvblR5cGUuUkVBRF9FTlRSWTsKICAgICAgICBiaXRGaWVsZDBf\nID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAwMDAwMik7CiAgICAgICAgdHhuSWRf\nID0gMEw7CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4\nMDAwMDAwMDQpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAg\nIAogICAgICBwdWJsaWMgQnVpbGRlciBjbG9uZSgpIHsKICAgICAgICByZXR1\ncm4gY3JlYXRlKCkubWVyZ2VGcm9tKGJ1aWxkUGFydGlhbCgpKTsKICAgICAg\nfQogICAgICAKICAgICAgcHVibGljIGNvbS5nb29nbGUucHJvdG9idWYuRGVz\nY3JpcHRvcnMuRGVzY3JpcHRvcgogICAgICAgICAgZ2V0RGVzY3JpcHRvckZv\nclR5cGUoKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIuZ2V0\nRGVzY3JpcHRvcigpOwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5C\nS1BhY2tldEhlYWRlciBnZXREZWZhdWx0SW5zdGFuY2VGb3JUeXBlKCkgewog\nICAgICAgIHJldHVybiBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyLmdldERlZmF1bHRJbnN0\nYW5jZSgpOwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tl\ndEhlYWRlciBidWlsZCgpIHsKICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyIHJl\nc3VsdCA9IGJ1aWxkUGFydGlhbCgpOwogICAgICAgIGlmICghcmVzdWx0Lmlz\nSW5pdGlhbGl6ZWQoKSkgewogICAgICAgICAgdGhyb3cgbmV3VW5pbml0aWFs\naXplZE1lc3NhZ2VFeGNlcHRpb24ocmVzdWx0KTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQogICAgICAKICAgICAgcHJpdmF0\nZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3Rv\nY29sLkJLUGFja2V0SGVhZGVyIGJ1aWxkUGFyc2VkKCkKICAgICAgICAgIHRo\ncm93cyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZl\nckV4Y2VwdGlvbiB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlciByZXN1bHQg\nPSBidWlsZFBhcnRpYWwoKTsKICAgICAgICBpZiAoIXJlc3VsdC5pc0luaXRp\nYWxpemVkKCkpIHsKICAgICAgICAgIHRocm93IG5ld1VuaW5pdGlhbGl6ZWRN\nZXNzYWdlRXhjZXB0aW9uKAogICAgICAgICAgICByZXN1bHQpLmFzSW52YWxp\nZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiByZXN1bHQ7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLkJLUGFja2V0SGVhZGVyIGJ1aWxkUGFydGlhbCgpIHsKICAgICAgICBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJL\nUGFja2V0SGVhZGVyIHJlc3VsdCA9IG5ldyBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyKHRo\naXMpOwogICAgICAgIGludCBmcm9tX2JpdEZpZWxkMF8gPSBiaXRGaWVsZDBf\nOwogICAgICAgIGludCB0b19iaXRGaWVsZDBfID0gMDsKICAgICAgICBpZiAo\nKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAx\nKSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAweDAwMDAwMDAxOwog\nICAgICAgIH0KICAgICAgICByZXN1bHQudmVyc2lvbl8gPSB2ZXJzaW9uXzsK\nICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9\nPSAweDAwMDAwMDAyKSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAw\neDAwMDAwMDAyOwogICAgICAgIH0KICAgICAgICByZXN1bHQub3BlcmF0aW9u\nXyA9IG9wZXJhdGlvbl87CiAgICAgICAgaWYgKCgoZnJvbV9iaXRGaWVsZDBf\nICYgMHgwMDAwMDAwNCkgPT0gMHgwMDAwMDAwNCkpIHsKICAgICAgICAgIHRv\nX2JpdEZpZWxkMF8gfD0gMHgwMDAwMDAwNDsKICAgICAgICB9CiAgICAgICAg\ncmVzdWx0LnR4bklkXyA9IHR4bklkXzsKICAgICAgICByZXN1bHQuYml0Rmll\nbGQwXyA9IHRvX2JpdEZpZWxkMF87CiAgICAgICAgb25CdWlsdCgpOwogICAg\nICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KICAgICAgCiAgICAgIHB1Ymxp\nYyBCdWlsZGVyIG1lcmdlRnJvbShjb20uZ29vZ2xlLnByb3RvYnVmLk1lc3Nh\nZ2Ugb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJL\nUGFja2V0SGVhZGVyKSB7CiAgICAgICAgICByZXR1cm4gbWVyZ2VGcm9tKChv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLkJLUGFja2V0SGVhZGVyKW90aGVyKTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgc3VwZXIubWVyZ2VGcm9tKG90aGVyKTsKICAgICAgICAgIHJldHVy\nbiB0aGlzOwogICAgICAgIH0KICAgICAgfQogICAgICAKICAgICAgcHVibGlj\nIEJ1aWxkZXIgbWVyZ2VGcm9tKG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIgb3RoZXIpIHsK\nICAgICAgICBpZiAob3RoZXIgPT0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlci5nZXREZWZh\ndWx0SW5zdGFuY2UoKSkgcmV0dXJuIHRoaXM7CiAgICAgICAgaWYgKG90aGVy\nLmhhc1ZlcnNpb24oKSkgewogICAgICAgICAgc2V0VmVyc2lvbihvdGhlci5n\nZXRWZXJzaW9uKCkpOwogICAgICAgIH0KICAgICAgICBpZiAob3RoZXIuaGFz\nT3BlcmF0aW9uKCkpIHsKICAgICAgICAgIHNldE9wZXJhdGlvbihvdGhlci5n\nZXRPcGVyYXRpb24oKSk7CiAgICAgICAgfQogICAgICAgIGlmIChvdGhlci5o\nYXNUeG5JZCgpKSB7CiAgICAgICAgICBzZXRUeG5JZChvdGhlci5nZXRUeG5J\nZCgpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5tZXJnZVVua25vd25GaWVs\nZHMob3RoZXIuZ2V0VW5rbm93bkZpZWxkcygpKTsKICAgICAgICByZXR1cm4g\ndGhpczsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIGZpbmFsIGJvb2xl\nYW4gaXNJbml0aWFsaXplZCgpIHsKICAgICAgICBpZiAoIWhhc1ZlcnNpb24o\nKSkgewogICAgICAgICAgCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQogICAgICAgIGlmICghaGFzT3BlcmF0aW9uKCkpIHsKICAgICAgICAg\nIAogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBp\nZiAoIWhhc1R4bklkKCkpIHsKICAgICAgICAgIAogICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIgbWVyZ2VGcm9tKAogICAg\nICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZElucHV0U3RyZWFtIGlu\ncHV0LAogICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25S\nZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICB0aHJv\nd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgICAgICAgY29tLmdvb2dsZS5w\ncm90b2J1Zi5Vbmtub3duRmllbGRTZXQuQnVpbGRlciB1bmtub3duRmllbGRz\nID0KICAgICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuVW5rbm93bkZpZWxk\nU2V0Lm5ld0J1aWxkZXIoCiAgICAgICAgICAgIHRoaXMuZ2V0VW5rbm93bkZp\nZWxkcygpKTsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgaW50\nIHRhZyA9IGlucHV0LnJlYWRUYWcoKTsKICAgICAgICAgIHN3aXRjaCAodGFn\nKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB0aGlzLnNl\ndFVua25vd25GaWVsZHModW5rbm93bkZpZWxkcy5idWlsZCgpKTsKICAgICAg\nICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICAgICAgICByZXR1cm4gdGhp\nczsKICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgIGlmICgh\ncGFyc2VVbmtub3duRmllbGQoaW5wdXQsIHVua25vd25GaWVsZHMsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25SZWdp\nc3RyeSwgdGFnKSkgewogICAgICAgICAgICAgICAgdGhpcy5zZXRVbmtub3du\nRmllbGRzKHVua25vd25GaWVsZHMuYnVpbGQoKSk7CiAgICAgICAgICAgICAg\nICBvbkNoYW5nZWQoKTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwog\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBjYXNlIDg6IHsKICAgICAgICAgICAgICBpbnQg\ncmF3VmFsdWUgPSBpbnB1dC5yZWFkRW51bSgpOwogICAgICAgICAgICAgIG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wu\nUHJvdG9jb2xWZXJzaW9uIHZhbHVlID0gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2NvbFZlcnNpb24udmFs\ndWVPZihyYXdWYWx1ZSk7CiAgICAgICAgICAgICAgaWYgKHZhbHVlID09IG51\nbGwpIHsKICAgICAgICAgICAgICAgIHVua25vd25GaWVsZHMubWVyZ2VWYXJp\nbnRGaWVsZCgxLCByYXdWYWx1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMTsKICAg\nICAgICAgICAgICAgIHZlcnNpb25fID0gdmFsdWU7CiAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGNhc2UgMTY6IHsKICAgICAgICAgICAgICBpbnQgcmF3VmFsdWUgPSBp\nbnB1dC5yZWFkRW51bSgpOwogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuT3BlcmF0aW9uVHlw\nZSB2YWx1ZSA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuT3BlcmF0aW9uVHlwZS52YWx1ZU9mKHJhd1ZhbHVlKTsK\nICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgdW5rbm93bkZpZWxkcy5tZXJnZVZhcmludEZpZWxkKDIsIHJhd1Zh\nbHVlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nYml0RmllbGQwXyB8PSAweDAwMDAwMDAyOwogICAgICAgICAgICAgICAgb3Bl\ncmF0aW9uXyA9IHZhbHVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIDI0OiB7\nCiAgICAgICAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDA0OwogICAg\nICAgICAgICAgIHR4bklkXyA9IGlucHV0LnJlYWRVSW50NjQoKTsKICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgfQogICAgICAKICAgICAgcHJpdmF0ZSBpbnQgYml0Rmll\nbGQwXzsKICAgICAgCiAgICAgIC8vIHJlcXVpcmVkIC5Qcm90b2NvbFZlcnNp\nb24gdmVyc2lvbiA9IDE7CiAgICAgIHByaXZhdGUgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2NvbFZlcnNp\nb24gdmVyc2lvbl8gPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLlByb3RvY29sVmVyc2lvbi5WRVJTSU9OX09ORTsK\nICAgICAgcHVibGljIGJvb2xlYW4gaGFzVmVyc2lvbigpIHsKICAgICAgICBy\nZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAwMDAw\nMSk7CiAgICAgIH0KICAgICAgcHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUHJvdG9jb2xWZXJzaW9uIGdl\ndFZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIHZlcnNpb25fOwogICAgICB9\nCiAgICAgIHB1YmxpYyBCdWlsZGVyIHNldFZlcnNpb24ob3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2NvbFZl\ncnNpb24gdmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewog\nICAgICAgICAgdGhyb3cgbmV3IE51bGxQb2ludGVyRXhjZXB0aW9uKCk7CiAg\nICAgICAgfQogICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMTsKICAg\nICAgICB2ZXJzaW9uXyA9IHZhbHVlOwogICAgICAgIG9uQ2hhbmdlZCgpOwog\nICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWls\nZGVyIGNsZWFyVmVyc2lvbigpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJp\ndEZpZWxkMF8gJiB+MHgwMDAwMDAwMSk7CiAgICAgICAgdmVyc2lvbl8gPSBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLlByb3RvY29sVmVyc2lvbi5WRVJTSU9OX09ORTsKICAgICAgICBvbkNoYW5n\nZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICAKICAg\nICAgLy8gcmVxdWlyZWQgLk9wZXJhdGlvblR5cGUgb3BlcmF0aW9uID0gMjsK\nICAgICAgcHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLk9wZXJhdGlvblR5cGUgb3BlcmF0aW9uXyA9IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wu\nT3BlcmF0aW9uVHlwZS5SRUFEX0VOVFJZOwogICAgICBwdWJsaWMgYm9vbGVh\nbiBoYXNPcGVyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuICgoYml0RmllbGQw\nXyAmIDB4MDAwMDAwMDIpID09IDB4MDAwMDAwMDIpOwogICAgICB9CiAgICAg\nIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLk9wZXJhdGlvblR5cGUgZ2V0T3BlcmF0aW9uKCkgewogICAg\nICAgIHJldHVybiBvcGVyYXRpb25fOwogICAgICB9CiAgICAgIHB1YmxpYyBC\ndWlsZGVyIHNldE9wZXJhdGlvbihvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLk9wZXJhdGlvblR5cGUgdmFsdWUpIHsK\nICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAgICAgdGhyb3cg\nbmV3IE51bGxQb2ludGVyRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgICAg\nIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMjsKICAgICAgICBvcGVyYXRpb25f\nID0gdmFsdWU7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xlYXJPcGVy\nYXRpb24oKSB7CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYg\nfjB4MDAwMDAwMDIpOwogICAgICAgIG9wZXJhdGlvbl8gPSBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLk9wZXJhdGlv\nblR5cGUuUkVBRF9FTlRSWTsKICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAg\nICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICAKICAgICAgLy8gcmVxdWly\nZWQgdWludDY0IHR4bklkID0gMzsKICAgICAgcHJpdmF0ZSBsb25nIHR4bklk\nXyA7CiAgICAgIHB1YmxpYyBib29sZWFuIGhhc1R4bklkKCkgewogICAgICAg\nIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAw\nMDA0KTsKICAgICAgfQogICAgICBwdWJsaWMgbG9uZyBnZXRUeG5JZCgpIHsK\nICAgICAgICByZXR1cm4gdHhuSWRfOwogICAgICB9CiAgICAgIHB1YmxpYyBC\ndWlsZGVyIHNldFR4bklkKGxvbmcgdmFsdWUpIHsKICAgICAgICBiaXRGaWVs\nZDBfIHw9IDB4MDAwMDAwMDQ7CiAgICAgICAgdHhuSWRfID0gdmFsdWU7CiAg\nICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xlYXJUeG5JZCgpIHsKICAgICAg\nICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAwMDAwNCk7CiAg\nICAgICAgdHhuSWRfID0gMEw7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAgICAgIC8vIEBAcHJv\ndG9jX2luc2VydGlvbl9wb2ludChidWlsZGVyX3Njb3BlOkJLUGFja2V0SGVh\nZGVyKQogICAgfQogICAgCiAgICBzdGF0aWMgewogICAgICBkZWZhdWx0SW5z\ndGFuY2UgPSBuZXcgQktQYWNrZXRIZWFkZXIodHJ1ZSk7CiAgICAgIGRlZmF1\nbHRJbnN0YW5jZS5pbml0RmllbGRzKCk7CiAgICB9CiAgICAKICAgIC8vIEBA\ncHJvdG9jX2luc2VydGlvbl9wb2ludChjbGFzc19zY29wZTpCS1BhY2tldEhl\nYWRlcikKICB9CiAgCiAgcHVibGljIGludGVyZmFjZSBSZXF1ZXN0T3JCdWls\nZGVyCiAgICAgIGV4dGVuZHMgY29tLmdvb2dsZS5wcm90b2J1Zi5NZXNzYWdl\nT3JCdWlsZGVyIHsKICAgIAogICAgLy8gcmVxdWlyZWQgLkJLUGFja2V0SGVh\nZGVyIGhlYWRlciA9IDE7CiAgICBib29sZWFuIGhhc0hlYWRlcigpOwogICAg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5CS1BhY2tldEhlYWRlciBnZXRIZWFkZXIoKTsKICAgIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRI\nZWFkZXJPckJ1aWxkZXIgZ2V0SGVhZGVyT3JCdWlsZGVyKCk7CiAgICAKICAg\nIC8vIG9wdGlvbmFsIC5SZWFkUmVxdWVzdCByZWFkUmVxdWVzdCA9IDEwMDsK\nICAgIGJvb2xlYW4gaGFzUmVhZFJlcXVlc3QoKTsKICAgIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVl\nc3QgZ2V0UmVhZFJlcXVlc3QoKTsKICAgIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3RPckJ1aWxk\nZXIgZ2V0UmVhZFJlcXVlc3RPckJ1aWxkZXIoKTsKICAgIAogICAgLy8gb3B0\naW9uYWwgLkFkZFJlcXVlc3QgYWRkUmVxdWVzdCA9IDEwMTsKICAgIGJvb2xl\nYW4gaGFzQWRkUmVxdWVzdCgpOwogICAgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0IGdldEFkZFJl\ncXVlc3QoKTsKICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdE9yQnVpbGRlciBnZXRBZGRSZXF1\nZXN0T3JCdWlsZGVyKCk7CiAgfQogIHB1YmxpYyBzdGF0aWMgZmluYWwgY2xh\nc3MgUmVxdWVzdCBleHRlbmRzCiAgICAgIGNvbS5nb29nbGUucHJvdG9idWYu\nR2VuZXJhdGVkTWVzc2FnZQogICAgICBpbXBsZW1lbnRzIFJlcXVlc3RPckJ1\naWxkZXIgewogICAgLy8gVXNlIFJlcXVlc3QubmV3QnVpbGRlcigpIHRvIGNv\nbnN0cnVjdC4KICAgIHByaXZhdGUgUmVxdWVzdChCdWlsZGVyIGJ1aWxkZXIp\nIHsKICAgICAgc3VwZXIoYnVpbGRlcik7CiAgICB9CiAgICBwcml2YXRlIFJl\ncXVlc3QoYm9vbGVhbiBub0luaXQpIHt9CiAgICAKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIFJlcXVlc3QgZGVmYXVsdEluc3RhbmNlOwogICAgcHVibGlj\nIHN0YXRpYyBSZXF1ZXN0IGdldERlZmF1bHRJbnN0YW5jZSgpIHsKICAgICAg\ncmV0dXJuIGRlZmF1bHRJbnN0YW5jZTsKICAgIH0KICAgIAogICAgcHVibGlj\nIFJlcXVlc3QgZ2V0RGVmYXVsdEluc3RhbmNlRm9yVHlwZSgpIHsKICAgICAg\ncmV0dXJuIGRlZmF1bHRJbnN0YW5jZTsKICAgIH0KICAgIAogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBjb20uZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3Jz\nLkRlc2NyaXB0b3IKICAgICAgICBnZXREZXNjcmlwdG9yKCkgewogICAgICBy\nZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQ\ncm90b2NvbC5pbnRlcm5hbF9zdGF0aWNfUmVxdWVzdF9kZXNjcmlwdG9yOwog\nICAgfQogICAgCiAgICBwcm90ZWN0ZWQgY29tLmdvb2dsZS5wcm90b2J1Zi5H\nZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAgICAgIGlu\ndGVybmFsR2V0RmllbGRBY2Nlc3NvclRhYmxlKCkgewogICAgICByZXR1cm4g\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5pbnRlcm5hbF9zdGF0aWNfUmVxdWVzdF9maWVsZEFjY2Vzc29yVGFibGU7\nCiAgICB9CiAgICAKICAgIHByaXZhdGUgaW50IGJpdEZpZWxkMF87CiAgICAv\nLyByZXF1aXJlZCAuQktQYWNrZXRIZWFkZXIgaGVhZGVyID0gMTsKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IEhFQURFUl9GSUVMRF9OVU1CRVIgPSAx\nOwogICAgcHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyIGhlYWRlcl87CiAgICBw\ndWJsaWMgYm9vbGVhbiBoYXNIZWFkZXIoKSB7CiAgICAgIHJldHVybiAoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAxKTsKICAgIH0K\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyIGdldEhlYWRlcigpIHsKICAg\nICAgcmV0dXJuIGhlYWRlcl87CiAgICB9CiAgICBwdWJsaWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tl\ndEhlYWRlck9yQnVpbGRlciBnZXRIZWFkZXJPckJ1aWxkZXIoKSB7CiAgICAg\nIHJldHVybiBoZWFkZXJfOwogICAgfQogICAgCiAgICAvLyBvcHRpb25hbCAu\nUmVhZFJlcXVlc3QgcmVhZFJlcXVlc3QgPSAxMDA7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGludCBSRUFEUkVRVUVTVF9GSUVMRF9OVU1CRVIgPSAxMDA7\nCiAgICBwcml2YXRlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QgcmVhZFJlcXVlc3RfOwogICAg\ncHVibGljIGJvb2xlYW4gaGFzUmVhZFJlcXVlc3QoKSB7CiAgICAgIHJldHVy\nbiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKTsK\nICAgIH0KICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0IGdldFJlYWRSZXF1ZXN0\nKCkgewogICAgICByZXR1cm4gcmVhZFJlcXVlc3RfOwogICAgfQogICAgcHVi\nbGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVhZFJlcXVlc3RPckJ1aWxkZXIgZ2V0UmVhZFJlcXVlc3RPckJ1\naWxkZXIoKSB7CiAgICAgIHJldHVybiByZWFkUmVxdWVzdF87CiAgICB9CiAg\nICAKICAgIC8vIG9wdGlvbmFsIC5BZGRSZXF1ZXN0IGFkZFJlcXVlc3QgPSAx\nMDE7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBBRERSRVFVRVNUX0ZJ\nRUxEX05VTUJFUiA9IDEwMTsKICAgIHByaXZhdGUgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0IGFk\nZFJlcXVlc3RfOwogICAgcHVibGljIGJvb2xlYW4gaGFzQWRkUmVxdWVzdCgp\nIHsKICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQpID09\nIDB4MDAwMDAwMDQpOwogICAgfQogICAgcHVibGljIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdCBn\nZXRBZGRSZXF1ZXN0KCkgewogICAgICByZXR1cm4gYWRkUmVxdWVzdF87CiAg\nICB9CiAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0T3JCdWlsZGVyIGdldEFkZFJl\ncXVlc3RPckJ1aWxkZXIoKSB7CiAgICAgIHJldHVybiBhZGRSZXF1ZXN0XzsK\nICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGluaXRGaWVsZHMoKSB7CiAg\nICAgIGhlYWRlcl8gPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyLmdldERlZmF1bHRJbnN0\nYW5jZSgpOwogICAgICByZWFkUmVxdWVzdF8gPSBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0Lmdl\ndERlZmF1bHRJbnN0YW5jZSgpOwogICAgICBhZGRSZXF1ZXN0XyA9IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRk\nUmVxdWVzdC5nZXREZWZhdWx0SW5zdGFuY2UoKTsKICAgIH0KICAgIHByaXZh\ndGUgYnl0ZSBtZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAtMTsKICAgIHB1Ymxp\nYyBmaW5hbCBib29sZWFuIGlzSW5pdGlhbGl6ZWQoKSB7CiAgICAgIGJ5dGUg\naXNJbml0aWFsaXplZCA9IG1lbW9pemVkSXNJbml0aWFsaXplZDsKICAgICAg\naWYgKGlzSW5pdGlhbGl6ZWQgIT0gLTEpIHJldHVybiBpc0luaXRpYWxpemVk\nID09IDE7CiAgICAgIAogICAgICBpZiAoIWhhc0hlYWRlcigpKSB7CiAgICAg\nICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFnZXRIZWFkZXIoKS5pc0luaXRp\nYWxpemVkKCkpIHsKICAgICAgICBtZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAw\nOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAoaGFz\nUmVhZFJlcXVlc3QoKSkgewogICAgICAgIGlmICghZ2V0UmVhZFJlcXVlc3Qo\nKS5pc0luaXRpYWxpemVkKCkpIHsKICAgICAgICAgIG1lbW9pemVkSXNJbml0\naWFsaXplZCA9IDA7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nfQogICAgICB9CiAgICAgIGlmIChoYXNBZGRSZXF1ZXN0KCkpIHsKICAgICAg\nICBpZiAoIWdldEFkZFJlcXVlc3QoKS5pc0luaXRpYWxpemVkKCkpIHsKICAg\nICAgICAgIG1lbW9pemVkSXNJbml0aWFsaXplZCA9IDA7CiAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICAgIG1lbW9pemVk\nSXNJbml0aWFsaXplZCA9IDE7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQog\nICAgCiAgICBwdWJsaWMgdm9pZCB3cml0ZVRvKGNvbS5nb29nbGUucHJvdG9i\ndWYuQ29kZWRPdXRwdXRTdHJlYW0gb3V0cHV0KQogICAgICAgICAgICAgICAg\nICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgICAgIGdl\ndFNlcmlhbGl6ZWRTaXplKCk7CiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAw\neDAwMDAwMDAxKSA9PSAweDAwMDAwMDAxKSkgewogICAgICAgIG91dHB1dC53\ncml0ZU1lc3NhZ2UoMSwgaGVhZGVyXyk7CiAgICAgIH0KICAgICAgaWYgKCgo\nYml0RmllbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4MDAwMDAwMDIpKSB7CiAg\nICAgICAgb3V0cHV0LndyaXRlTWVzc2FnZSgxMDAsIHJlYWRSZXF1ZXN0Xyk7\nCiAgICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQp\nID09IDB4MDAwMDAwMDQpKSB7CiAgICAgICAgb3V0cHV0LndyaXRlTWVzc2Fn\nZSgxMDEsIGFkZFJlcXVlc3RfKTsKICAgICAgfQogICAgICBnZXRVbmtub3du\nRmllbGRzKCkud3JpdGVUbyhvdXRwdXQpOwogICAgfQogICAgCiAgICBwcml2\nYXRlIGludCBtZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gLTE7CiAgICBwdWJs\naWMgaW50IGdldFNlcmlhbGl6ZWRTaXplKCkgewogICAgICBpbnQgc2l6ZSA9\nIG1lbW9pemVkU2VyaWFsaXplZFNpemU7CiAgICAgIGlmIChzaXplICE9IC0x\nKSByZXR1cm4gc2l6ZTsKICAgIAogICAgICBzaXplID0gMDsKICAgICAgaWYg\nKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpKSB7\nCiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0\ncHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZU1lc3NhZ2VTaXplKDEsIGhl\nYWRlcl8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAweDAw\nMDAwMDAyKSA9PSAweDAwMDAwMDAyKSkgewogICAgICAgIHNpemUgKz0gY29t\nLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0cmVhbQogICAgICAgICAg\nLmNvbXB1dGVNZXNzYWdlU2l6ZSgxMDAsIHJlYWRSZXF1ZXN0Xyk7CiAgICAg\nIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQpID09IDB4\nMDAwMDAwMDQpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3Rv\nYnVmLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZU1lc3Nh\nZ2VTaXplKDEwMSwgYWRkUmVxdWVzdF8pOwogICAgICB9CiAgICAgIHNpemUg\nKz0gZ2V0VW5rbm93bkZpZWxkcygpLmdldFNlcmlhbGl6ZWRTaXplKCk7CiAg\nICAgIG1lbW9pemVkU2VyaWFsaXplZFNpemUgPSBzaXplOwogICAgICByZXR1\ncm4gc2l6ZTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nbG9uZyBzZXJpYWxWZXJzaW9uVUlEID0gMEw7CiAgICBAamF2YS5sYW5nLk92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgamF2YS5sYW5nLk9iamVjdCB3cml0ZVJl\ncGxhY2UoKQogICAgICAgIHRocm93cyBqYXZhLmlvLk9iamVjdFN0cmVhbUV4\nY2VwdGlvbiB7CiAgICAgIHJldHVybiBzdXBlci53cml0ZVJlcGxhY2UoKTsK\nICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3QgcGFyc2VG\ncm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZyBk\nYXRhKQogICAgICAgIHRocm93cyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFs\naWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdC\ndWlsZGVyKCkubWVyZ2VGcm9tKGRhdGEpLmJ1aWxkUGFyc2VkKCk7CiAgICB9\nCiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVzdCBwYXJzZUZyb20oCiAgICAg\nICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nIGRhdGEsCiAgICAg\nICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUg\nZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUu\ncHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAg\nICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oZGF0YSwgZXh0ZW5z\naW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5idWlsZFBhcnNlZCgpOwog\nICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3QgcGFyc2VGcm9tKGJ5\ndGVbXSBkYXRhKQogICAgICAgIHRocm93cyBjb20uZ29vZ2xlLnByb3RvYnVm\nLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiB7CiAgICAgIHJldHVy\nbiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGRhdGEpLmJ1aWxkUGFyc2VkKCk7\nCiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVzdCBwYXJzZUZyb20o\nCiAgICAgICAgYnl0ZVtdIGRhdGEsCiAgICAgICAgY29tLmdvb2dsZS5wcm90\nb2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkp\nCiAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFBy\nb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxk\nZXIoKS5tZXJnZUZyb20oZGF0YSwgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAg\nICAgICAgICAgIC5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0\nYXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLlJlcXVlc3QgcGFyc2VGcm9tKGphdmEuaW8uSW5wdXRTdHJlYW0g\naW5wdXQpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewog\nICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShpbnB1dCkuYnVp\nbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0\nIHBhcnNlRnJvbSgKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0\nLAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0\ncnlMaXRlIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZh\nLmlvLklPRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5t\nZXJnZUZyb20oaW5wdXQsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAg\nICAgICAuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5SZXF1ZXN0IHBhcnNlRGVsaW1pdGVkRnJvbShqYXZhLmlvLklucHV0U3Ry\nZWFtIGlucHV0KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9u\nIHsKICAgICAgQnVpbGRlciBidWlsZGVyID0gbmV3QnVpbGRlcigpOwogICAg\nICBpZiAoYnVpbGRlci5tZXJnZURlbGltaXRlZEZyb20oaW5wdXQpKSB7CiAg\nICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGRQYXJzZWQoKTsKICAgICAgfSBl\nbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQogICAg\ncHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLlJlcXVlc3QgcGFyc2VEZWxpbWl0ZWRGcm9tKAog\nICAgICAgIGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQsCiAgICAgICAgY29t\nLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5z\naW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRp\nb24gewogICAgICBCdWlsZGVyIGJ1aWxkZXIgPSBuZXdCdWlsZGVyKCk7CiAg\nICAgIGlmIChidWlsZGVyLm1lcmdlRGVsaW1pdGVkRnJvbShpbnB1dCwgZXh0\nZW5zaW9uUmVnaXN0cnkpKSB7CiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVp\nbGRQYXJzZWQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgfQogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3Qg\ncGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRJ\nbnB1dFN0cmVhbSBpbnB1dCkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4\nY2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9t\nKGlucHV0KS5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRp\nYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3Rv\nY29sLlJlcXVlc3QgcGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJv\ndG9idWYuQ29kZWRJbnB1dFN0cmVhbSBpbnB1dCwKICAgICAgICBjb20uZ29v\nZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0ZSBleHRlbnNpb25S\nZWdpc3RyeSkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7\nCiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGlucHV0LCBl\neHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFyc2Vk\nKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgQnVpbGRlciBuZXdC\ndWlsZGVyKCkgeyByZXR1cm4gQnVpbGRlci5jcmVhdGUoKTsgfQogICAgcHVi\nbGljIEJ1aWxkZXIgbmV3QnVpbGRlckZvclR5cGUoKSB7IHJldHVybiBuZXdC\ndWlsZGVyKCk7IH0KICAgIHB1YmxpYyBzdGF0aWMgQnVpbGRlciBuZXdCdWls\nZGVyKG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVxdWVzdCBwcm90b3R5cGUpIHsKICAgICAgcmV0dXJuIG5ld0J1\naWxkZXIoKS5tZXJnZUZyb20ocHJvdG90eXBlKTsKICAgIH0KICAgIHB1Ymxp\nYyBCdWlsZGVyIHRvQnVpbGRlcigpIHsgcmV0dXJuIG5ld0J1aWxkZXIodGhp\ncyk7IH0KICAgIAogICAgQGphdmEubGFuZy5PdmVycmlkZQogICAgcHJvdGVj\ndGVkIEJ1aWxkZXIgbmV3QnVpbGRlckZvclR5cGUoCiAgICAgICAgY29tLmdv\nb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkJ1aWxkZXJQYXJlbnQg\ncGFyZW50KSB7CiAgICAgIEJ1aWxkZXIgYnVpbGRlciA9IG5ldyBCdWlsZGVy\nKHBhcmVudCk7CiAgICAgIHJldHVybiBidWlsZGVyOwogICAgfQogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBjbGFzcyBCdWlsZGVyIGV4dGVuZHMKICAgICAg\nICBjb20uZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuQnVpbGRl\ncjxCdWlsZGVyPgogICAgICAgaW1wbGVtZW50cyBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3RPckJ1aWxk\nZXIgewogICAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGNvbS5nb29nbGUucHJv\ndG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRvcgogICAgICAgICAgZ2V0RGVz\nY3JpcHRvcigpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0aWNf\nUmVxdWVzdF9kZXNjcmlwdG9yOwogICAgICB9CiAgICAgIAogICAgICBwcm90\nZWN0ZWQgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZp\nZWxkQWNjZXNzb3JUYWJsZQogICAgICAgICAgaW50ZXJuYWxHZXRGaWVsZEFj\nY2Vzc29yVGFibGUoKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuaW50ZXJuYWxfc3Rh\ndGljX1JlcXVlc3RfZmllbGRBY2Nlc3NvclRhYmxlOwogICAgICB9CiAgICAg\nIAogICAgICAvLyBDb25zdHJ1Y3QgdXNpbmcgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0Lm5ld0J1aWxk\nZXIoKQogICAgICBwcml2YXRlIEJ1aWxkZXIoKSB7CiAgICAgICAgbWF5YmVG\nb3JjZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpOwogICAgICB9CiAgICAgIAog\nICAgICBwcml2YXRlIEJ1aWxkZXIoQnVpbGRlclBhcmVudCBwYXJlbnQpIHsK\nICAgICAgICBzdXBlcihwYXJlbnQpOwogICAgICAgIG1heWJlRm9yY2VCdWls\nZGVySW5pdGlhbGl6YXRpb24oKTsKICAgICAgfQogICAgICBwcml2YXRlIHZv\naWQgbWF5YmVGb3JjZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpIHsKICAgICAg\nICBpZiAoY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLmFs\nd2F5c1VzZUZpZWxkQnVpbGRlcnMpIHsKICAgICAgICAgIGdldEhlYWRlckZp\nZWxkQnVpbGRlcigpOwogICAgICAgICAgZ2V0UmVhZFJlcXVlc3RGaWVsZEJ1\naWxkZXIoKTsKICAgICAgICAgIGdldEFkZFJlcXVlc3RGaWVsZEJ1aWxkZXIo\nKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHJpdmF0ZSBzdGF0aWMgQnVp\nbGRlciBjcmVhdGUoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBCdWlsZGVyKCk7\nCiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFyKCkg\newogICAgICAgIHN1cGVyLmNsZWFyKCk7CiAgICAgICAgaWYgKGhlYWRlckJ1\naWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGhlYWRlcl8gPSBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFj\na2V0SGVhZGVyLmdldERlZmF1bHRJbnN0YW5jZSgpOwogICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICBoZWFkZXJCdWlsZGVyXy5jbGVhcigpOwogICAgICAg\nIH0KICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAw\nMDAwMSk7CiAgICAgICAgaWYgKHJlYWRSZXF1ZXN0QnVpbGRlcl8gPT0gbnVs\nbCkgewogICAgICAgICAgcmVhZFJlcXVlc3RfID0gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5n\nZXREZWZhdWx0SW5zdGFuY2UoKTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgcmVhZFJlcXVlc3RCdWlsZGVyXy5jbGVhcigpOwogICAgICAgIH0KICAg\nICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAwMDAwMik7\nCiAgICAgICAgaWYgKGFkZFJlcXVlc3RCdWlsZGVyXyA9PSBudWxsKSB7CiAg\nICAgICAgICBhZGRSZXF1ZXN0XyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5nZXREZWZhdWx0\nSW5zdGFuY2UoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWRkUmVx\ndWVzdEJ1aWxkZXJfLmNsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGJpdEZp\nZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDA0KTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxk\nZXIgY2xvbmUoKSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZSgpLm1lcmdlRnJv\nbShidWlsZFBhcnRpYWwoKSk7CiAgICAgIH0KICAgICAgCiAgICAgIHB1Ymxp\nYyBjb20uZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3JzLkRlc2NyaXB0b3IK\nICAgICAgICAgIGdldERlc2NyaXB0b3JGb3JUeXBlKCkgewogICAgICAgIHJl\ndHVybiBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLlJlcXVlc3QuZ2V0RGVzY3JpcHRvcigpOwogICAgICB9CiAgICAg\nIAogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0IGdldERlZmF1bHRJbnN0YW5jZUZv\nclR5cGUoKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVzdC5nZXREZWZhdWx0\nSW5zdGFuY2UoKTsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVx\ndWVzdCBidWlsZCgpIHsKICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3QgcmVzdWx0ID0gYnVp\nbGRQYXJ0aWFsKCk7CiAgICAgICAgaWYgKCFyZXN1bHQuaXNJbml0aWFsaXpl\nZCgpKSB7CiAgICAgICAgICB0aHJvdyBuZXdVbmluaXRpYWxpemVkTWVzc2Fn\nZUV4Y2VwdGlvbihyZXN1bHQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\ncmVzdWx0OwogICAgICB9CiAgICAgIAogICAgICBwcml2YXRlIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVz\ndCBidWlsZFBhcnNlZCgpCiAgICAgICAgICB0aHJvd3MgY29tLmdvb2dsZS5w\ncm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb24gewogICAg\nICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVxdWVzdCByZXN1bHQgPSBidWlsZFBhcnRpYWwoKTsKICAgICAg\nICBpZiAoIXJlc3VsdC5pc0luaXRpYWxpemVkKCkpIHsKICAgICAgICAgIHRo\ncm93IG5ld1VuaW5pdGlhbGl6ZWRNZXNzYWdlRXhjZXB0aW9uKAogICAgICAg\nICAgICByZXN1bHQpLmFzSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9u\nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0K\nICAgICAgCiAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3QgYnVpbGRQYXJ0aWFsKCkg\newogICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuUmVxdWVzdCByZXN1bHQgPSBuZXcgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0KHRo\naXMpOwogICAgICAgIGludCBmcm9tX2JpdEZpZWxkMF8gPSBiaXRGaWVsZDBf\nOwogICAgICAgIGludCB0b19iaXRGaWVsZDBfID0gMDsKICAgICAgICBpZiAo\nKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAx\nKSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAweDAwMDAwMDAxOwog\nICAgICAgIH0KICAgICAgICBpZiAoaGVhZGVyQnVpbGRlcl8gPT0gbnVsbCkg\newogICAgICAgICAgcmVzdWx0LmhlYWRlcl8gPSBoZWFkZXJfOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQuaGVhZGVyXyA9IGhlYWRlckJ1\naWxkZXJfLmJ1aWxkKCk7CiAgICAgICAgfQogICAgICAgIGlmICgoKGZyb21f\nYml0RmllbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4MDAwMDAwMDIpKSB7CiAg\nICAgICAgICB0b19iaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAgICAg\nfQogICAgICAgIGlmIChyZWFkUmVxdWVzdEJ1aWxkZXJfID09IG51bGwpIHsK\nICAgICAgICAgIHJlc3VsdC5yZWFkUmVxdWVzdF8gPSByZWFkUmVxdWVzdF87\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdC5yZWFkUmVxdWVz\ndF8gPSByZWFkUmVxdWVzdEJ1aWxkZXJfLmJ1aWxkKCk7CiAgICAgICAgfQog\nICAgICAgIGlmICgoKGZyb21fYml0RmllbGQwXyAmIDB4MDAwMDAwMDQpID09\nIDB4MDAwMDAwMDQpKSB7CiAgICAgICAgICB0b19iaXRGaWVsZDBfIHw9IDB4\nMDAwMDAwMDQ7CiAgICAgICAgfQogICAgICAgIGlmIChhZGRSZXF1ZXN0QnVp\nbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0LmFkZFJlcXVlc3Rf\nID0gYWRkUmVxdWVzdF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJl\nc3VsdC5hZGRSZXF1ZXN0XyA9IGFkZFJlcXVlc3RCdWlsZGVyXy5idWlsZCgp\nOwogICAgICAgIH0KICAgICAgICByZXN1bHQuYml0RmllbGQwXyA9IHRvX2Jp\ndEZpZWxkMF87CiAgICAgICAgb25CdWlsdCgpOwogICAgICAgIHJldHVybiBy\nZXN1bHQ7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVyIG1l\ncmdlRnJvbShjb20uZ29vZ2xlLnByb3RvYnVmLk1lc3NhZ2Ugb3RoZXIpIHsK\nICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3QpIHsKICAg\nICAgICAgIHJldHVybiBtZXJnZUZyb20oKG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVzdClvdGhlcik7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN1cGVyLm1lcmdlRnJvbShvdGhl\ncik7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgIH0K\nICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVyIG1lcmdlRnJvbShvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlcXVl\nc3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0Lmdl\ndERlZmF1bHRJbnN0YW5jZSgpKSByZXR1cm4gdGhpczsKICAgICAgICBpZiAo\nb3RoZXIuaGFzSGVhZGVyKCkpIHsKICAgICAgICAgIG1lcmdlSGVhZGVyKG90\naGVyLmdldEhlYWRlcigpKTsKICAgICAgICB9CiAgICAgICAgaWYgKG90aGVy\nLmhhc1JlYWRSZXF1ZXN0KCkpIHsKICAgICAgICAgIG1lcmdlUmVhZFJlcXVl\nc3Qob3RoZXIuZ2V0UmVhZFJlcXVlc3QoKSk7CiAgICAgICAgfQogICAgICAg\nIGlmIChvdGhlci5oYXNBZGRSZXF1ZXN0KCkpIHsKICAgICAgICAgIG1lcmdl\nQWRkUmVxdWVzdChvdGhlci5nZXRBZGRSZXF1ZXN0KCkpOwogICAgICAgIH0K\nICAgICAgICB0aGlzLm1lcmdlVW5rbm93bkZpZWxkcyhvdGhlci5nZXRVbmtu\nb3duRmllbGRzKCkpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAg\nICAgIAogICAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBpc0luaXRpYWxpemVk\nKCkgewogICAgICAgIGlmICghaGFzSGVhZGVyKCkpIHsKICAgICAgICAgIAog\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAo\nIWdldEhlYWRlcigpLmlzSW5pdGlhbGl6ZWQoKSkgewogICAgICAgICAgCiAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmICho\nYXNSZWFkUmVxdWVzdCgpKSB7CiAgICAgICAgICBpZiAoIWdldFJlYWRSZXF1\nZXN0KCkuaXNJbml0aWFsaXplZCgpKSB7CiAgICAgICAgICAgIAogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIGlmIChoYXNBZGRSZXF1ZXN0KCkpIHsKICAgICAgICAgIGlmICghZ2V0\nQWRkUmVxdWVzdCgpLmlzSW5pdGlhbGl6ZWQoKSkgewogICAgICAgICAgICAK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICAKICAgICAg\ncHVibGljIEJ1aWxkZXIgbWVyZ2VGcm9tKAogICAgICAgICAgY29tLmdvb2ds\nZS5wcm90b2J1Zi5Db2RlZElucHV0U3RyZWFtIGlucHV0LAogICAgICAgICAg\nY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0\nZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4\nY2VwdGlvbiB7CiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5Vbmtub3du\nRmllbGRTZXQuQnVpbGRlciB1bmtub3duRmllbGRzID0KICAgICAgICAgIGNv\nbS5nb29nbGUucHJvdG9idWYuVW5rbm93bkZpZWxkU2V0Lm5ld0J1aWxkZXIo\nCiAgICAgICAgICAgIHRoaXMuZ2V0VW5rbm93bkZpZWxkcygpKTsKICAgICAg\nICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgaW50IHRhZyA9IGlucHV0LnJl\nYWRUYWcoKTsKICAgICAgICAgIHN3aXRjaCAodGFnKSB7CiAgICAgICAgICAg\nIGNhc2UgMDoKICAgICAgICAgICAgICB0aGlzLnNldFVua25vd25GaWVsZHMo\ndW5rbm93bkZpZWxkcy5idWlsZCgpKTsKICAgICAgICAgICAgICBvbkNoYW5n\nZWQoKTsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAg\nZGVmYXVsdDogewogICAgICAgICAgICAgIGlmICghcGFyc2VVbmtub3duRmll\nbGQoaW5wdXQsIHVua25vd25GaWVsZHMsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBleHRlbnNpb25SZWdpc3RyeSwgdGFnKSkgewog\nICAgICAgICAgICAgICAgdGhpcy5zZXRVbmtub3duRmllbGRzKHVua25vd25G\naWVsZHMuYnVpbGQoKSk7CiAgICAgICAgICAgICAgICBvbkNoYW5nZWQoKTsK\nICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBjYXNlIDEwOiB7CiAgICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlci5C\ndWlsZGVyIHN1YkJ1aWxkZXIgPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyLm5ld0J1aWxk\nZXIoKTsKICAgICAgICAgICAgICBpZiAoaGFzSGVhZGVyKCkpIHsKICAgICAg\nICAgICAgICAgIHN1YkJ1aWxkZXIubWVyZ2VGcm9tKGdldEhlYWRlcigpKTsK\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaW5wdXQucmVhZE1lc3Nh\nZ2Uoc3ViQnVpbGRlciwgZXh0ZW5zaW9uUmVnaXN0cnkpOwogICAgICAgICAg\nICAgIHNldEhlYWRlcihzdWJCdWlsZGVyLmJ1aWxkUGFydGlhbCgpKTsKICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBj\nYXNlIDgwMjogewogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QuQnVpbGRl\nciBzdWJCdWlsZGVyID0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5uZXdCdWlsZGVyKCk7CiAg\nICAgICAgICAgICAgaWYgKGhhc1JlYWRSZXF1ZXN0KCkpIHsKICAgICAgICAg\nICAgICAgIHN1YkJ1aWxkZXIubWVyZ2VGcm9tKGdldFJlYWRSZXF1ZXN0KCkp\nOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpbnB1dC5yZWFkTWVz\nc2FnZShzdWJCdWlsZGVyLCBleHRlbnNpb25SZWdpc3RyeSk7CiAgICAgICAg\nICAgICAgc2V0UmVhZFJlcXVlc3Qoc3ViQnVpbGRlci5idWlsZFBhcnRpYWwo\nKSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgY2FzZSA4MTA6IHsKICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3Qu\nQnVpbGRlciBzdWJCdWlsZGVyID0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0Lm5ld0J1aWxkZXIo\nKTsKICAgICAgICAgICAgICBpZiAoaGFzQWRkUmVxdWVzdCgpKSB7CiAgICAg\nICAgICAgICAgICBzdWJCdWlsZGVyLm1lcmdlRnJvbShnZXRBZGRSZXF1ZXN0\nKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpbnB1dC5yZWFk\nTWVzc2FnZShzdWJCdWlsZGVyLCBleHRlbnNpb25SZWdpc3RyeSk7CiAgICAg\nICAgICAgICAgc2V0QWRkUmVxdWVzdChzdWJCdWlsZGVyLmJ1aWxkUGFydGlh\nbCgpKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICAKICAgICAgcHJpdmF0\nZSBpbnQgYml0RmllbGQwXzsKICAgICAgCiAgICAgIC8vIHJlcXVpcmVkIC5C\nS1BhY2tldEhlYWRlciBoZWFkZXIgPSAxOwogICAgICBwcml2YXRlIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQ\nYWNrZXRIZWFkZXIgaGVhZGVyXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIuZ2V0RGVm\nYXVsdEluc3RhbmNlKCk7CiAgICAgIHByaXZhdGUgY29tLmdvb2dsZS5wcm90\nb2J1Zi5TaW5nbGVGaWVsZEJ1aWxkZXI8CiAgICAgICAgICBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0\nSGVhZGVyLCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLkJLUGFja2V0SGVhZGVyLkJ1aWxkZXIsIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRI\nZWFkZXJPckJ1aWxkZXI+IGhlYWRlckJ1aWxkZXJfOwogICAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNIZWFkZXIoKSB7CiAgICAgICAgcmV0dXJuICgoYml0Rmll\nbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpOwogICAgICB9CiAg\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyIGdldEhlYWRlcigpIHsKICAg\nICAgICBpZiAoaGVhZGVyQnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAg\ncmV0dXJuIGhlYWRlcl87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJl\ndHVybiBoZWFkZXJCdWlsZGVyXy5nZXRNZXNzYWdlKCk7CiAgICAgICAgfQog\nICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIHNldEhlYWRlcihvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFj\na2V0SGVhZGVyIHZhbHVlKSB7CiAgICAgICAgaWYgKGhlYWRlckJ1aWxkZXJf\nID09IG51bGwpIHsKICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigpOwog\nICAgICAgICAgfQogICAgICAgICAgaGVhZGVyXyA9IHZhbHVlOwogICAgICAg\nICAgb25DaGFuZ2VkKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhl\nYWRlckJ1aWxkZXJfLnNldE1lc3NhZ2UodmFsdWUpOwogICAgICAgIH0KICAg\nICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDE7CiAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgc2V0SGVhZGVy\nKAogICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlci5CdWlsZGVyIGJ1aWxkZXJG\nb3JWYWx1ZSkgewogICAgICAgIGlmIChoZWFkZXJCdWlsZGVyXyA9PSBudWxs\nKSB7CiAgICAgICAgICBoZWFkZXJfID0gYnVpbGRlckZvclZhbHVlLmJ1aWxk\nKCk7CiAgICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgaGVhZGVyQnVpbGRlcl8uc2V0TWVzc2FnZShidWlsZGVyRm9y\nVmFsdWUuYnVpbGQoKSk7CiAgICAgICAgfQogICAgICAgIGJpdEZpZWxkMF8g\nfD0gMHgwMDAwMDAwMTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQog\nICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUhlYWRlcihvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVh\nZGVyIHZhbHVlKSB7CiAgICAgICAgaWYgKGhlYWRlckJ1aWxkZXJfID09IG51\nbGwpIHsKICAgICAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAx\nKSA9PSAweDAwMDAwMDAxKSAmJgogICAgICAgICAgICAgIGhlYWRlcl8gIT0g\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5CS1BhY2tldEhlYWRlci5nZXREZWZhdWx0SW5zdGFuY2UoKSkgewogICAg\nICAgICAgICBoZWFkZXJfID0KICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVh\nZGVyLm5ld0J1aWxkZXIoaGVhZGVyXykubWVyZ2VGcm9tKHZhbHVlKS5idWls\nZFBhcnRpYWwoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGhl\nYWRlcl8gPSB2YWx1ZTsKICAgICAgICAgIH0KICAgICAgICAgIG9uQ2hhbmdl\nZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoZWFkZXJCdWlsZGVy\nXy5tZXJnZUZyb20odmFsdWUpOwogICAgICAgIH0KICAgICAgICBiaXRGaWVs\nZDBfIHw9IDB4MDAwMDAwMDE7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xlYXJIZWFkZXIoKSB7CiAgICAg\nICAgaWYgKGhlYWRlckJ1aWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGhl\nYWRlcl8gPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLkJLUGFja2V0SGVhZGVyLmdldERlZmF1bHRJbnN0YW5jZSgp\nOwogICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgIGhlYWRlckJ1aWxkZXJfLmNsZWFyKCk7CiAgICAgICAgfQogICAg\nICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDAxKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5C\nS1BhY2tldEhlYWRlci5CdWlsZGVyIGdldEhlYWRlckJ1aWxkZXIoKSB7CiAg\nICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDAxOwogICAgICAgIG9uQ2hh\nbmdlZCgpOwogICAgICAgIHJldHVybiBnZXRIZWFkZXJGaWVsZEJ1aWxkZXIo\nKS5nZXRCdWlsZGVyKCk7CiAgICAgIH0KICAgICAgcHVibGljIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNr\nZXRIZWFkZXJPckJ1aWxkZXIgZ2V0SGVhZGVyT3JCdWlsZGVyKCkgewogICAg\nICAgIGlmIChoZWFkZXJCdWlsZGVyXyAhPSBudWxsKSB7CiAgICAgICAgICBy\nZXR1cm4gaGVhZGVyQnVpbGRlcl8uZ2V0TWVzc2FnZU9yQnVpbGRlcigpOwog\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gaGVhZGVyXzsKICAg\nICAgICB9CiAgICAgIH0KICAgICAgcHJpdmF0ZSBjb20uZ29vZ2xlLnByb3Rv\nYnVmLlNpbmdsZUZpZWxkQnVpbGRlcjwKICAgICAgICAgIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRI\nZWFkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIuQnVpbGRlciwgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhl\nYWRlck9yQnVpbGRlcj4gCiAgICAgICAgICBnZXRIZWFkZXJGaWVsZEJ1aWxk\nZXIoKSB7CiAgICAgICAgaWYgKGhlYWRlckJ1aWxkZXJfID09IG51bGwpIHsK\nICAgICAgICAgIGhlYWRlckJ1aWxkZXJfID0gbmV3IGNvbS5nb29nbGUucHJv\ndG9idWYuU2luZ2xlRmllbGRCdWlsZGVyPAogICAgICAgICAgICAgIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQ\nYWNrZXRIZWFkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIuQnVpbGRlciwgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1Bh\nY2tldEhlYWRlck9yQnVpbGRlcj4oCiAgICAgICAgICAgICAgICAgIGhlYWRl\ncl8sCiAgICAgICAgICAgICAgICAgIGdldFBhcmVudEZvckNoaWxkcmVuKCks\nCiAgICAgICAgICAgICAgICAgIGlzQ2xlYW4oKSk7CiAgICAgICAgICBoZWFk\nZXJfID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGhlYWRlckJ1\naWxkZXJfOwogICAgICB9CiAgICAgIAogICAgICAvLyBvcHRpb25hbCAuUmVh\nZFJlcXVlc3QgcmVhZFJlcXVlc3QgPSAxMDA7CiAgICAgIHByaXZhdGUgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZWFkUmVxdWVzdCByZWFkUmVxdWVzdF8gPSBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0LmdldERl\nZmF1bHRJbnN0YW5jZSgpOwogICAgICBwcml2YXRlIGNvbS5nb29nbGUucHJv\ndG9idWYuU2luZ2xlRmllbGRCdWlsZGVyPAogICAgICAgICAgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVx\ndWVzdCwgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQ\ncm90b2NvbC5SZWFkUmVxdWVzdC5CdWlsZGVyLCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0T3JC\ndWlsZGVyPiByZWFkUmVxdWVzdEJ1aWxkZXJfOwogICAgICBwdWJsaWMgYm9v\nbGVhbiBoYXNSZWFkUmVxdWVzdCgpIHsKICAgICAgICByZXR1cm4gKChiaXRG\naWVsZDBfICYgMHgwMDAwMDAwMikgPT0gMHgwMDAwMDAwMik7CiAgICAgIH0K\nICAgICAgcHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QgZ2V0UmVhZFJlcXVlc3QoKSB7\nCiAgICAgICAgaWYgKHJlYWRSZXF1ZXN0QnVpbGRlcl8gPT0gbnVsbCkgewog\nICAgICAgICAgcmV0dXJuIHJlYWRSZXF1ZXN0XzsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgcmV0dXJuIHJlYWRSZXF1ZXN0QnVpbGRlcl8uZ2V0TWVz\nc2FnZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRl\nciBzZXRSZWFkUmVxdWVzdChvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0IHZhbHVlKSB7CiAgICAg\nICAgaWYgKHJlYWRSZXF1ZXN0QnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAg\nICAgaWYgKHZhbHVlID09IG51bGwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3\nIE51bGxQb2ludGVyRXhjZXB0aW9uKCk7CiAgICAgICAgICB9CiAgICAgICAg\nICByZWFkUmVxdWVzdF8gPSB2YWx1ZTsKICAgICAgICAgIG9uQ2hhbmdlZCgp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZWFkUmVxdWVzdEJ1aWxk\nZXJfLnNldE1lc3NhZ2UodmFsdWUpOwogICAgICAgIH0KICAgICAgICBiaXRG\naWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgc2V0UmVhZFJlcXVlc3QoCiAg\nICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLlJlYWRSZXF1ZXN0LkJ1aWxkZXIgYnVpbGRlckZvclZhbHVl\nKSB7CiAgICAgICAgaWYgKHJlYWRSZXF1ZXN0QnVpbGRlcl8gPT0gbnVsbCkg\newogICAgICAgICAgcmVhZFJlcXVlc3RfID0gYnVpbGRlckZvclZhbHVlLmJ1\naWxkKCk7CiAgICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgcmVhZFJlcXVlc3RCdWlsZGVyXy5zZXRNZXNzYWdlKGJ1\naWxkZXJGb3JWYWx1ZS5idWlsZCgpKTsKICAgICAgICB9CiAgICAgICAgYml0\nRmllbGQwXyB8PSAweDAwMDAwMDAyOwogICAgICAgIHJldHVybiB0aGlzOwog\nICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIG1lcmdlUmVhZFJlcXVlc3Qo\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5SZWFkUmVxdWVzdCB2YWx1ZSkgewogICAgICAgIGlmIChyZWFkUmVxdWVz\ndEJ1aWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGlmICgoKGJpdEZpZWxk\nMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKSAmJgogICAgICAgICAg\nICAgIHJlYWRSZXF1ZXN0XyAhPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0LmdldERlZmF1bHRJ\nbnN0YW5jZSgpKSB7CiAgICAgICAgICAgIHJlYWRSZXF1ZXN0XyA9CiAgICAg\nICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5uZXdCdWlsZGVyKHJlYWRSZXF1ZXN0\nXykubWVyZ2VGcm9tKHZhbHVlKS5idWlsZFBhcnRpYWwoKTsKICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgIHJlYWRSZXF1ZXN0XyA9IHZhbHVlOwog\nICAgICAgICAgfQogICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgIHJlYWRSZXF1ZXN0QnVpbGRlcl8ubWVyZ2VGcm9t\nKHZhbHVlKTsKICAgICAgICB9CiAgICAgICAgYml0RmllbGQwXyB8PSAweDAw\nMDAwMDAyOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1\nYmxpYyBCdWlsZGVyIGNsZWFyUmVhZFJlcXVlc3QoKSB7CiAgICAgICAgaWYg\nKHJlYWRSZXF1ZXN0QnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgcmVh\nZFJlcXVlc3RfID0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5nZXREZWZhdWx0SW5zdGFuY2Uo\nKTsKICAgICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICByZWFkUmVxdWVzdEJ1aWxkZXJfLmNsZWFyKCk7CiAgICAgICAg\nfQogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAw\nMDAyKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBwdWJs\naWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90\nb2NvbC5SZWFkUmVxdWVzdC5CdWlsZGVyIGdldFJlYWRSZXF1ZXN0QnVpbGRl\ncigpIHsKICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAg\nICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIGdldFJlYWRSZXF1ZXN0\nRmllbGRCdWlsZGVyKCkuZ2V0QnVpbGRlcigpOwogICAgICB9CiAgICAgIHB1\nYmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLlJlYWRSZXF1ZXN0T3JCdWlsZGVyIGdldFJlYWRSZXF1ZXN0T3JC\ndWlsZGVyKCkgewogICAgICAgIGlmIChyZWFkUmVxdWVzdEJ1aWxkZXJfICE9\nIG51bGwpIHsKICAgICAgICAgIHJldHVybiByZWFkUmVxdWVzdEJ1aWxkZXJf\nLmdldE1lc3NhZ2VPckJ1aWxkZXIoKTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgcmV0dXJuIHJlYWRSZXF1ZXN0XzsKICAgICAgICB9CiAgICAgIH0K\nICAgICAgcHJpdmF0ZSBjb20uZ29vZ2xlLnByb3RvYnVmLlNpbmdsZUZpZWxk\nQnVpbGRlcjwKICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QsIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVl\nc3QuQnVpbGRlciwgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdE9yQnVpbGRlcj4gCiAgICAgICAg\nICBnZXRSZWFkUmVxdWVzdEZpZWxkQnVpbGRlcigpIHsKICAgICAgICBpZiAo\ncmVhZFJlcXVlc3RCdWlsZGVyXyA9PSBudWxsKSB7CiAgICAgICAgICByZWFk\nUmVxdWVzdEJ1aWxkZXJfID0gbmV3IGNvbS5nb29nbGUucHJvdG9idWYuU2lu\nZ2xlRmllbGRCdWlsZGVyPAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3Qs\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuUmVhZFJlcXVlc3QuQnVpbGRlciwgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdE9yQnVpbGRl\ncj4oCiAgICAgICAgICAgICAgICAgIHJlYWRSZXF1ZXN0XywKICAgICAgICAg\nICAgICAgICAgZ2V0UGFyZW50Rm9yQ2hpbGRyZW4oKSwKICAgICAgICAgICAg\nICAgICAgaXNDbGVhbigpKTsKICAgICAgICAgIHJlYWRSZXF1ZXN0XyA9IG51\nbGw7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZWFkUmVxdWVzdEJ1aWxk\nZXJfOwogICAgICB9CiAgICAgIAogICAgICAvLyBvcHRpb25hbCAuQWRkUmVx\ndWVzdCBhZGRSZXF1ZXN0ID0gMTAxOwogICAgICBwcml2YXRlIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVx\ndWVzdCBhZGRSZXF1ZXN0XyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5nZXREZWZhdWx0SW5z\ndGFuY2UoKTsKICAgICAgcHJpdmF0ZSBjb20uZ29vZ2xlLnByb3RvYnVmLlNp\nbmdsZUZpZWxkQnVpbGRlcjwKICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdCwgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5B\nZGRSZXF1ZXN0LkJ1aWxkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdE9yQnVpbGRlcj4gYWRk\nUmVxdWVzdEJ1aWxkZXJfOwogICAgICBwdWJsaWMgYm9vbGVhbiBoYXNBZGRS\nZXF1ZXN0KCkgewogICAgICAgIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAw\nMDAwMDA0KSA9PSAweDAwMDAwMDA0KTsKICAgICAgfQogICAgICBwdWJsaWMg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5BZGRSZXF1ZXN0IGdldEFkZFJlcXVlc3QoKSB7CiAgICAgICAgaWYgKGFk\nZFJlcXVlc3RCdWlsZGVyXyA9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4g\nYWRkUmVxdWVzdF87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVy\nbiBhZGRSZXF1ZXN0QnVpbGRlcl8uZ2V0TWVzc2FnZSgpOwogICAgICAgIH0K\nICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBzZXRBZGRSZXF1ZXN0KG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wu\nQWRkUmVxdWVzdCB2YWx1ZSkgewogICAgICAgIGlmIChhZGRSZXF1ZXN0QnVp\nbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgaWYgKHZhbHVlID09IG51bGwp\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IE51bGxQb2ludGVyRXhjZXB0aW9u\nKCk7CiAgICAgICAgICB9CiAgICAgICAgICBhZGRSZXF1ZXN0XyA9IHZhbHVl\nOwogICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgIGFkZFJlcXVlc3RCdWlsZGVyXy5zZXRNZXNzYWdlKHZhbHVlKTsK\nICAgICAgICB9CiAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDA0Owog\nICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWls\nZGVyIHNldEFkZFJlcXVlc3QoCiAgICAgICAgICBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QuQnVp\nbGRlciBidWlsZGVyRm9yVmFsdWUpIHsKICAgICAgICBpZiAoYWRkUmVxdWVz\ndEJ1aWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGFkZFJlcXVlc3RfID0g\nYnVpbGRlckZvclZhbHVlLmJ1aWxkKCk7CiAgICAgICAgICBvbkNoYW5nZWQo\nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWRkUmVxdWVzdEJ1aWxk\nZXJfLnNldE1lc3NhZ2UoYnVpbGRlckZvclZhbHVlLmJ1aWxkKCkpOwogICAg\nICAgIH0KICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDQ7CiAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIg\nbWVyZ2VBZGRSZXF1ZXN0KG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdCB2YWx1ZSkgewogICAgICAg\nIGlmIChhZGRSZXF1ZXN0QnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAg\naWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQpID09IDB4MDAwMDAwMDQp\nICYmCiAgICAgICAgICAgICAgYWRkUmVxdWVzdF8gIT0gb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0\nLmdldERlZmF1bHRJbnN0YW5jZSgpKSB7CiAgICAgICAgICAgIGFkZFJlcXVl\nc3RfID0KICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QubmV3QnVpbGRlcihh\nZGRSZXF1ZXN0XykubWVyZ2VGcm9tKHZhbHVlKS5idWlsZFBhcnRpYWwoKTsK\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZFJlcXVlc3RfID0g\ndmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICBvbkNoYW5nZWQoKTsKICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgYWRkUmVxdWVzdEJ1aWxkZXJfLm1l\ncmdlRnJvbSh2YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGJpdEZpZWxkMF8g\nfD0gMHgwMDAwMDAwNDsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQog\nICAgICBwdWJsaWMgQnVpbGRlciBjbGVhckFkZFJlcXVlc3QoKSB7CiAgICAg\nICAgaWYgKGFkZFJlcXVlc3RCdWlsZGVyXyA9PSBudWxsKSB7CiAgICAgICAg\nICBhZGRSZXF1ZXN0XyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5nZXREZWZhdWx0SW5zdGFu\nY2UoKTsKICAgICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICBhZGRSZXF1ZXN0QnVpbGRlcl8uY2xlYXIoKTsKICAgICAg\nICB9CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4MDAw\nMDAwMDQpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1\nYmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLkFkZFJlcXVlc3QuQnVpbGRlciBnZXRBZGRSZXF1ZXN0QnVpbGRl\ncigpIHsKICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDQ7CiAgICAg\nICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIGdldEFkZFJlcXVlc3RG\naWVsZEJ1aWxkZXIoKS5nZXRCdWlsZGVyKCk7CiAgICAgIH0KICAgICAgcHVi\nbGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuQWRkUmVxdWVzdE9yQnVpbGRlciBnZXRBZGRSZXF1ZXN0T3JCdWls\nZGVyKCkgewogICAgICAgIGlmIChhZGRSZXF1ZXN0QnVpbGRlcl8gIT0gbnVs\nbCkgewogICAgICAgICAgcmV0dXJuIGFkZFJlcXVlc3RCdWlsZGVyXy5nZXRN\nZXNzYWdlT3JCdWlsZGVyKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nIHJldHVybiBhZGRSZXF1ZXN0XzsKICAgICAgICB9CiAgICAgIH0KICAgICAg\ncHJpdmF0ZSBjb20uZ29vZ2xlLnByb3RvYnVmLlNpbmdsZUZpZWxkQnVpbGRl\ncjwKICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdCwgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0LkJ1aWxk\nZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuQWRkUmVxdWVzdE9yQnVpbGRlcj4gCiAgICAgICAgICBnZXRBZGRS\nZXF1ZXN0RmllbGRCdWlsZGVyKCkgewogICAgICAgIGlmIChhZGRSZXF1ZXN0\nQnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgYWRkUmVxdWVzdEJ1aWxk\nZXJfID0gbmV3IGNvbS5nb29nbGUucHJvdG9idWYuU2luZ2xlRmllbGRCdWls\nZGVyPAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdCwgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0\nLkJ1aWxkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuQWRkUmVxdWVzdE9yQnVpbGRlcj4oCiAgICAgICAgICAg\nICAgICAgIGFkZFJlcXVlc3RfLAogICAgICAgICAgICAgICAgICBnZXRQYXJl\nbnRGb3JDaGlsZHJlbigpLAogICAgICAgICAgICAgICAgICBpc0NsZWFuKCkp\nOwogICAgICAgICAgYWRkUmVxdWVzdF8gPSBudWxsOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gYWRkUmVxdWVzdEJ1aWxkZXJfOwogICAgICB9CiAgICAg\nIAogICAgICAvLyBAQHByb3RvY19pbnNlcnRpb25fcG9pbnQoYnVpbGRlcl9z\nY29wZTpSZXF1ZXN0KQogICAgfQogICAgCiAgICBzdGF0aWMgewogICAgICBk\nZWZhdWx0SW5zdGFuY2UgPSBuZXcgUmVxdWVzdCh0cnVlKTsKICAgICAgZGVm\nYXVsdEluc3RhbmNlLmluaXRGaWVsZHMoKTsKICAgIH0KICAgIAogICAgLy8g\nQEBwcm90b2NfaW5zZXJ0aW9uX3BvaW50KGNsYXNzX3Njb3BlOlJlcXVlc3Qp\nCiAgfQogIAogIHB1YmxpYyBpbnRlcmZhY2UgUmVhZFJlcXVlc3RPckJ1aWxk\nZXIKICAgICAgZXh0ZW5kcyBjb20uZ29vZ2xlLnByb3RvYnVmLk1lc3NhZ2VP\nckJ1aWxkZXIgewogICAgCiAgICAvLyBvcHRpb25hbCAuUmVhZFJlcXVlc3Qu\nRmxhZyBmbGFnID0gMTAwOwogICAgYm9vbGVhbiBoYXNGbGFnKCk7CiAgICBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29s\nLlJlYWRSZXF1ZXN0LkZsYWcgZ2V0RmxhZygpOwogICAgCiAgICAvLyByZXF1\naXJlZCBpbnQ2NCBsZWRnZXJJZCA9IDE7CiAgICBib29sZWFuIGhhc0xlZGdl\ncklkKCk7CiAgICBsb25nIGdldExlZGdlcklkKCk7CiAgICAKICAgIC8vIHJl\ncXVpcmVkIGludDY0IGVudHJ5SWQgPSAyOwogICAgYm9vbGVhbiBoYXNFbnRy\neUlkKCk7CiAgICBsb25nIGdldEVudHJ5SWQoKTsKICAgIAogICAgLy8gb3B0\naW9uYWwgYnl0ZXMgbWFzdGVyS2V5ID0gMzsKICAgIGJvb2xlYW4gaGFzTWFz\ndGVyS2V5KCk7CiAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmcg\nZ2V0TWFzdGVyS2V5KCk7CiAgfQogIHB1YmxpYyBzdGF0aWMgZmluYWwgY2xh\nc3MgUmVhZFJlcXVlc3QgZXh0ZW5kcwogICAgICBjb20uZ29vZ2xlLnByb3Rv\nYnVmLkdlbmVyYXRlZE1lc3NhZ2UKICAgICAgaW1wbGVtZW50cyBSZWFkUmVx\ndWVzdE9yQnVpbGRlciB7CiAgICAvLyBVc2UgUmVhZFJlcXVlc3QubmV3QnVp\nbGRlcigpIHRvIGNvbnN0cnVjdC4KICAgIHByaXZhdGUgUmVhZFJlcXVlc3Qo\nQnVpbGRlciBidWlsZGVyKSB7CiAgICAgIHN1cGVyKGJ1aWxkZXIpOwogICAg\nfQogICAgcHJpdmF0ZSBSZWFkUmVxdWVzdChib29sZWFuIG5vSW5pdCkge30K\nICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgUmVhZFJlcXVlc3QgZGVm\nYXVsdEluc3RhbmNlOwogICAgcHVibGljIHN0YXRpYyBSZWFkUmVxdWVzdCBn\nZXREZWZhdWx0SW5zdGFuY2UoKSB7CiAgICAgIHJldHVybiBkZWZhdWx0SW5z\ndGFuY2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBSZWFkUmVxdWVzdCBnZXRE\nZWZhdWx0SW5zdGFuY2VGb3JUeXBlKCkgewogICAgICByZXR1cm4gZGVmYXVs\ndEluc3RhbmNlOwogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRvcgog\nICAgICAgIGdldERlc2NyaXB0b3IoKSB7CiAgICAgIHJldHVybiBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLmludGVy\nbmFsX3N0YXRpY19SZWFkUmVxdWVzdF9kZXNjcmlwdG9yOwogICAgfQogICAg\nCiAgICBwcm90ZWN0ZWQgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRN\nZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAgICAgIGludGVybmFsR2V0\nRmllbGRBY2Nlc3NvclRhYmxlKCkgewogICAgICByZXR1cm4gb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRlcm5h\nbF9zdGF0aWNfUmVhZFJlcXVlc3RfZmllbGRBY2Nlc3NvclRhYmxlOwogICAg\nfQogICAgCiAgICBwdWJsaWMgZW51bSBGbGFnCiAgICAgICAgaW1wbGVtZW50\ncyBjb20uZ29vZ2xlLnByb3RvYnVmLlByb3RvY29sTWVzc2FnZUVudW0gewog\nICAgICBGRU5DRV9MRURHRVIoMCwgMSksCiAgICAgIDsKICAgICAgCiAgICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEZFTkNFX0xFREdFUl9WQUxVRSA9\nIDE7CiAgICAgIAogICAgICAKICAgICAgcHVibGljIGZpbmFsIGludCBnZXRO\ndW1iZXIoKSB7IHJldHVybiB2YWx1ZTsgfQogICAgICAKICAgICAgcHVibGlj\nIHN0YXRpYyBGbGFnIHZhbHVlT2YoaW50IHZhbHVlKSB7CiAgICAgICAgc3dp\ndGNoICh2YWx1ZSkgewogICAgICAgICAgY2FzZSAxOiByZXR1cm4gRkVOQ0Vf\nTEVER0VSOwogICAgICAgICAgZGVmYXVsdDogcmV0dXJuIG51bGw7CiAgICAg\nICAgfQogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgc3RhdGljIGNvbS5n\nb29nbGUucHJvdG9idWYuSW50ZXJuYWwuRW51bUxpdGVNYXA8RmxhZz4KICAg\nICAgICAgIGludGVybmFsR2V0VmFsdWVNYXAoKSB7CiAgICAgICAgcmV0dXJu\nIGludGVybmFsVmFsdWVNYXA7CiAgICAgIH0KICAgICAgcHJpdmF0ZSBzdGF0\naWMgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnRlcm5hbC5FbnVtTGl0ZU1hcDxG\nbGFnPgogICAgICAgICAgaW50ZXJuYWxWYWx1ZU1hcCA9CiAgICAgICAgICAg\nIG5ldyBjb20uZ29vZ2xlLnByb3RvYnVmLkludGVybmFsLkVudW1MaXRlTWFw\nPEZsYWc+KCkgewogICAgICAgICAgICAgIHB1YmxpYyBGbGFnIGZpbmRWYWx1\nZUJ5TnVtYmVyKGludCBudW1iZXIpIHsKICAgICAgICAgICAgICAgIHJldHVy\nbiBGbGFnLnZhbHVlT2YobnVtYmVyKTsKICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH07CiAgICAgIAogICAgICBwdWJsaWMgZmluYWwgY29tLmdvb2ds\nZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5FbnVtVmFsdWVEZXNjcmlwdG9yCiAg\nICAgICAgICBnZXRWYWx1ZURlc2NyaXB0b3IoKSB7CiAgICAgICAgcmV0dXJu\nIGdldERlc2NyaXB0b3IoKS5nZXRWYWx1ZXMoKS5nZXQoaW5kZXgpOwogICAg\nICB9CiAgICAgIHB1YmxpYyBmaW5hbCBjb20uZ29vZ2xlLnByb3RvYnVmLkRl\nc2NyaXB0b3JzLkVudW1EZXNjcmlwdG9yCiAgICAgICAgICBnZXREZXNjcmlw\ndG9yRm9yVHlwZSgpIHsKICAgICAgICByZXR1cm4gZ2V0RGVzY3JpcHRvcigp\nOwogICAgICB9CiAgICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgY29tLmdvb2ds\nZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5FbnVtRGVzY3JpcHRvcgogICAgICAg\nICAgZ2V0RGVzY3JpcHRvcigpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVx\ndWVzdC5nZXREZXNjcmlwdG9yKCkuZ2V0RW51bVR5cGVzKCkuZ2V0KDApOwog\nICAgICB9CiAgICAgIAogICAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBGbGFn\nW10gVkFMVUVTID0gewogICAgICAgIEZFTkNFX0xFREdFUiwgCiAgICAgIH07\nCiAgICAgIAogICAgICBwdWJsaWMgc3RhdGljIEZsYWcgdmFsdWVPZigKICAg\nICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRW51bVZh\nbHVlRGVzY3JpcHRvciBkZXNjKSB7CiAgICAgICAgaWYgKGRlc2MuZ2V0VHlw\nZSgpICE9IGdldERlc2NyaXB0b3IoKSkgewogICAgICAgICAgdGhyb3cgbmV3\nIGphdmEubGFuZy5JbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAg\nICAgICJFbnVtVmFsdWVEZXNjcmlwdG9yIGlzIG5vdCBmb3IgdGhpcyB0eXBl\nLiIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gVkFMVUVTW2Rlc2MuZ2V0\nSW5kZXgoKV07CiAgICAgIH0KICAgICAgCiAgICAgIHByaXZhdGUgZmluYWwg\naW50IGluZGV4OwogICAgICBwcml2YXRlIGZpbmFsIGludCB2YWx1ZTsKICAg\nICAgCiAgICAgIHByaXZhdGUgRmxhZyhpbnQgaW5kZXgsIGludCB2YWx1ZSkg\newogICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgICAgICB0aGlzLnZh\nbHVlID0gdmFsdWU7CiAgICAgIH0KICAgICAgCiAgICAgIC8vIEBAcHJvdG9j\nX2luc2VydGlvbl9wb2ludChlbnVtX3Njb3BlOlJlYWRSZXF1ZXN0LkZsYWcp\nCiAgICB9CiAgICAKICAgIHByaXZhdGUgaW50IGJpdEZpZWxkMF87CiAgICAv\nLyBvcHRpb25hbCAuUmVhZFJlcXVlc3QuRmxhZyBmbGFnID0gMTAwOwogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBpbnQgRkxBR19GSUVMRF9OVU1CRVIgPSAx\nMDA7CiAgICBwcml2YXRlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QuRmxhZyBmbGFnXzsKICAg\nIHB1YmxpYyBib29sZWFuIGhhc0ZsYWcoKSB7CiAgICAgIHJldHVybiAoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAxKTsKICAgIH0K\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0LkZsYWcgZ2V0RmxhZygpIHsKICAg\nICAgcmV0dXJuIGZsYWdfOwogICAgfQogICAgCiAgICAvLyByZXF1aXJlZCBp\nbnQ2NCBsZWRnZXJJZCA9IDE7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGlu\ndCBMRURHRVJJRF9GSUVMRF9OVU1CRVIgPSAxOwogICAgcHJpdmF0ZSBsb25n\nIGxlZGdlcklkXzsKICAgIHB1YmxpYyBib29sZWFuIGhhc0xlZGdlcklkKCkg\newogICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMikgPT0g\nMHgwMDAwMDAwMik7CiAgICB9CiAgICBwdWJsaWMgbG9uZyBnZXRMZWRnZXJJ\nZCgpIHsKICAgICAgcmV0dXJuIGxlZGdlcklkXzsKICAgIH0KICAgIAogICAg\nLy8gcmVxdWlyZWQgaW50NjQgZW50cnlJZCA9IDI7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGludCBFTlRSWUlEX0ZJRUxEX05VTUJFUiA9IDI7CiAgICBw\ncml2YXRlIGxvbmcgZW50cnlJZF87CiAgICBwdWJsaWMgYm9vbGVhbiBoYXNF\nbnRyeUlkKCkgewogICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAw\nMDAwNCkgPT0gMHgwMDAwMDAwNCk7CiAgICB9CiAgICBwdWJsaWMgbG9uZyBn\nZXRFbnRyeUlkKCkgewogICAgICByZXR1cm4gZW50cnlJZF87CiAgICB9CiAg\nICAKICAgIC8vIG9wdGlvbmFsIGJ5dGVzIG1hc3RlcktleSA9IDM7CiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIGludCBNQVNURVJLRVlfRklFTERfTlVNQkVS\nID0gMzsKICAgIHByaXZhdGUgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3Ry\naW5nIG1hc3RlcktleV87CiAgICBwdWJsaWMgYm9vbGVhbiBoYXNNYXN0ZXJL\nZXkoKSB7CiAgICAgIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDA4\nKSA9PSAweDAwMDAwMDA4KTsKICAgIH0KICAgIHB1YmxpYyBjb20uZ29vZ2xl\nLnByb3RvYnVmLkJ5dGVTdHJpbmcgZ2V0TWFzdGVyS2V5KCkgewogICAgICBy\nZXR1cm4gbWFzdGVyS2V5XzsKICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lk\nIGluaXRGaWVsZHMoKSB7CiAgICAgIGZsYWdfID0gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5G\nbGFnLkZFTkNFX0xFREdFUjsKICAgICAgbGVkZ2VySWRfID0gMEw7CiAgICAg\nIGVudHJ5SWRfID0gMEw7CiAgICAgIG1hc3RlcktleV8gPSBjb20uZ29vZ2xl\nLnByb3RvYnVmLkJ5dGVTdHJpbmcuRU1QVFk7CiAgICB9CiAgICBwcml2YXRl\nIGJ5dGUgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gLTE7CiAgICBwdWJsaWMg\nZmluYWwgYm9vbGVhbiBpc0luaXRpYWxpemVkKCkgewogICAgICBieXRlIGlz\nSW5pdGlhbGl6ZWQgPSBtZW1vaXplZElzSW5pdGlhbGl6ZWQ7CiAgICAgIGlm\nIChpc0luaXRpYWxpemVkICE9IC0xKSByZXR1cm4gaXNJbml0aWFsaXplZCA9\nPSAxOwogICAgICAKICAgICAgaWYgKCFoYXNMZWRnZXJJZCgpKSB7CiAgICAg\nICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFoYXNFbnRyeUlkKCkpIHsKICAg\nICAgICBtZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAwOwogICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgfQogICAgICBtZW1vaXplZElzSW5pdGlhbGl6ZWQg\nPSAxOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgcHVibGlj\nIHZvaWQgd3JpdGVUbyhjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0cHV0\nU3RyZWFtIG91dHB1dCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3dz\nIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICBnZXRTZXJpYWxpemVkU2l6\nZSgpOwogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMikgPT0g\nMHgwMDAwMDAwMikpIHsKICAgICAgICBvdXRwdXQud3JpdGVJbnQ2NCgxLCBs\nZWRnZXJJZF8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAw\neDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAgICAgIG91dHB1dC53\ncml0ZUludDY0KDIsIGVudHJ5SWRfKTsKICAgICAgfQogICAgICBpZiAoKChi\naXRGaWVsZDBfICYgMHgwMDAwMDAwOCkgPT0gMHgwMDAwMDAwOCkpIHsKICAg\nICAgICBvdXRwdXQud3JpdGVCeXRlcygzLCBtYXN0ZXJLZXlfKTsKICAgICAg\nfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMSkgPT0gMHgw\nMDAwMDAwMSkpIHsKICAgICAgICBvdXRwdXQud3JpdGVFbnVtKDEwMCwgZmxh\nZ18uZ2V0TnVtYmVyKCkpOwogICAgICB9CiAgICAgIGdldFVua25vd25GaWVs\nZHMoKS53cml0ZVRvKG91dHB1dCk7CiAgICB9CiAgICAKICAgIHByaXZhdGUg\naW50IG1lbW9pemVkU2VyaWFsaXplZFNpemUgPSAtMTsKICAgIHB1YmxpYyBp\nbnQgZ2V0U2VyaWFsaXplZFNpemUoKSB7CiAgICAgIGludCBzaXplID0gbWVt\nb2l6ZWRTZXJpYWxpemVkU2l6ZTsKICAgICAgaWYgKHNpemUgIT0gLTEpIHJl\ndHVybiBzaXplOwogICAgCiAgICAgIHNpemUgPSAwOwogICAgICBpZiAoKChi\naXRGaWVsZDBfICYgMHgwMDAwMDAwMikgPT0gMHgwMDAwMDAwMikpIHsKICAg\nICAgICBzaXplICs9IGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRPdXRwdXRT\ndHJlYW0KICAgICAgICAgIC5jb21wdXRlSW50NjRTaXplKDEsIGxlZGdlcklk\nXyk7CiAgICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAw\nMDQpID09IDB4MDAwMDAwMDQpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29v\nZ2xlLnByb3RvYnVmLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29t\ncHV0ZUludDY0U2l6ZSgyLCBlbnRyeUlkXyk7CiAgICAgIH0KICAgICAgaWYg\nKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDgpID09IDB4MDAwMDAwMDgpKSB7\nCiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0\ncHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZUJ5dGVzU2l6ZSgzLCBtYXN0\nZXJLZXlfKTsKICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgw\nMDAwMDAwMSkgPT0gMHgwMDAwMDAwMSkpIHsKICAgICAgICBzaXplICs9IGNv\nbS5nb29nbGUucHJvdG9idWYuQ29kZWRPdXRwdXRTdHJlYW0KICAgICAgICAg\nIC5jb21wdXRlRW51bVNpemUoMTAwLCBmbGFnXy5nZXROdW1iZXIoKSk7CiAg\nICAgIH0KICAgICAgc2l6ZSArPSBnZXRVbmtub3duRmllbGRzKCkuZ2V0U2Vy\naWFsaXplZFNpemUoKTsKICAgICAgbWVtb2l6ZWRTZXJpYWxpemVkU2l6ZSA9\nIHNpemU7CiAgICAgIHJldHVybiBzaXplOwogICAgfQogICAgCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQgPSAwTDsK\nICAgIEBqYXZhLmxhbmcuT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBqYXZhLmxh\nbmcuT2JqZWN0IHdyaXRlUmVwbGFjZSgpCiAgICAgICAgdGhyb3dzIGphdmEu\naW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIHN1cGVy\nLndyaXRlUmVwbGFjZSgpOwogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGlj\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuUmVhZFJlcXVlc3QgcGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUu\ncHJvdG9idWYuQnl0ZVN0cmluZyBkYXRhKQogICAgICAgIHRocm93cyBjb20u\nZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlv\nbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGRhdGEp\nLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVh\nZFJlcXVlc3QgcGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9i\ndWYuQnl0ZVN0cmluZyBkYXRhLAogICAgICAgIGNvbS5nb29nbGUucHJvdG9i\ndWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJlZ2lzdHJ5KQog\nICAgICAgIHRocm93cyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90\nb2NvbEJ1ZmZlckV4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVy\nKCkubWVyZ2VGcm9tKGRhdGEsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAg\nICAgICAgICAuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0\naWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90\nb2NvbC5SZWFkUmVxdWVzdCBwYXJzZUZyb20oYnl0ZVtdIGRhdGEpCiAgICAg\nICAgdGhyb3dzIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFByb3RvY29s\nQnVmZmVyRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5t\nZXJnZUZyb20oZGF0YSkuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1Ymxp\nYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5SZWFkUmVxdWVzdCBwYXJzZUZyb20oCiAgICAgICAgYnl0\nZVtdIGRhdGEsCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNp\nb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhy\nb3dzIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVy\nRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZy\nb20oZGF0YSwgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5i\ndWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRS\nZXF1ZXN0IHBhcnNlRnJvbShqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0KQog\nICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICAgICAgcmV0\ndXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oaW5wdXQpLmJ1aWxkUGFyc2Vk\nKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QgcGFy\nc2VGcm9tKAogICAgICAgIGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQsCiAg\nICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxp\ndGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dzIGphdmEuaW8u\nSU9FeGNlcHRpb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdl\nRnJvbShpbnB1dCwgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAg\nIC5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJl\nYWRSZXF1ZXN0IHBhcnNlRGVsaW1pdGVkRnJvbShqYXZhLmlvLklucHV0U3Ry\nZWFtIGlucHV0KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9u\nIHsKICAgICAgQnVpbGRlciBidWlsZGVyID0gbmV3QnVpbGRlcigpOwogICAg\nICBpZiAoYnVpbGRlci5tZXJnZURlbGltaXRlZEZyb20oaW5wdXQpKSB7CiAg\nICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGRQYXJzZWQoKTsKICAgICAgfSBl\nbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfQogICAg\ncHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0IHBhcnNlRGVsaW1pdGVkRnJv\nbSgKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0LAogICAgICAg\nIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4\ndGVuc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhj\nZXB0aW9uIHsKICAgICAgQnVpbGRlciBidWlsZGVyID0gbmV3QnVpbGRlcigp\nOwogICAgICBpZiAoYnVpbGRlci5tZXJnZURlbGltaXRlZEZyb20oaW5wdXQs\nIGV4dGVuc2lvblJlZ2lzdHJ5KSkgewogICAgICAgIHJldHVybiBidWlsZGVy\nLmJ1aWxkUGFyc2VkKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgIH0KICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFk\nUmVxdWVzdCBwYXJzZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1\nZi5Db2RlZElucHV0U3RyZWFtIGlucHV0KQogICAgICAgIHRocm93cyBqYXZh\nLmlvLklPRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5t\nZXJnZUZyb20oaW5wdXQpLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAgICBwdWJs\naWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QgcGFyc2VGcm9tKAogICAgICAgIGNv\nbS5nb29nbGUucHJvdG9idWYuQ29kZWRJbnB1dFN0cmVhbSBpbnB1dCwKICAg\nICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0\nZSBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgamF2YS5pby5J\nT0V4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VG\ncm9tKGlucHV0LCBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAg\nLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMg\nQnVpbGRlciBuZXdCdWlsZGVyKCkgeyByZXR1cm4gQnVpbGRlci5jcmVhdGUo\nKTsgfQogICAgcHVibGljIEJ1aWxkZXIgbmV3QnVpbGRlckZvclR5cGUoKSB7\nIHJldHVybiBuZXdCdWlsZGVyKCk7IH0KICAgIHB1YmxpYyBzdGF0aWMgQnVp\nbGRlciBuZXdCdWlsZGVyKG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QgcHJvdG90eXBlKSB7CiAg\nICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKHByb3RvdHlwZSk7\nCiAgICB9CiAgICBwdWJsaWMgQnVpbGRlciB0b0J1aWxkZXIoKSB7IHJldHVy\nbiBuZXdCdWlsZGVyKHRoaXMpOyB9CiAgICAKICAgIEBqYXZhLmxhbmcuT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCBCdWlsZGVyIG5ld0J1aWxkZXJGb3JUeXBl\nKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJhdGVkTWVzc2Fn\nZS5CdWlsZGVyUGFyZW50IHBhcmVudCkgewogICAgICBCdWlsZGVyIGJ1aWxk\nZXIgPSBuZXcgQnVpbGRlcihwYXJlbnQpOwogICAgICByZXR1cm4gYnVpbGRl\ncjsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgY2xhc3MgQnVpbGRl\nciBleHRlbmRzCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0\nZWRNZXNzYWdlLkJ1aWxkZXI8QnVpbGRlcj4KICAgICAgIGltcGxlbWVudHMg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5SZWFkUmVxdWVzdE9yQnVpbGRlciB7CiAgICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5EZXNjcmlw\ndG9yCiAgICAgICAgICBnZXREZXNjcmlwdG9yKCkgewogICAgICAgIHJldHVy\nbiBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3Rv\nY29sLmludGVybmFsX3N0YXRpY19SZWFkUmVxdWVzdF9kZXNjcmlwdG9yOwog\nICAgICB9CiAgICAgIAogICAgICBwcm90ZWN0ZWQgY29tLmdvb2dsZS5wcm90\nb2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAg\nICAgICAgaW50ZXJuYWxHZXRGaWVsZEFjY2Vzc29yVGFibGUoKSB7CiAgICAg\nICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuaW50ZXJuYWxfc3RhdGljX1JlYWRSZXF1ZXN0X2ZpZWxk\nQWNjZXNzb3JUYWJsZTsKICAgICAgfQogICAgICAKICAgICAgLy8gQ29uc3Ry\ndWN0IHVzaW5nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QubmV3QnVpbGRlcigpCiAgICAgIHBy\naXZhdGUgQnVpbGRlcigpIHsKICAgICAgICBtYXliZUZvcmNlQnVpbGRlcklu\naXRpYWxpemF0aW9uKCk7CiAgICAgIH0KICAgICAgCiAgICAgIHByaXZhdGUg\nQnVpbGRlcihCdWlsZGVyUGFyZW50IHBhcmVudCkgewogICAgICAgIHN1cGVy\nKHBhcmVudCk7CiAgICAgICAgbWF5YmVGb3JjZUJ1aWxkZXJJbml0aWFsaXph\ndGlvbigpOwogICAgICB9CiAgICAgIHByaXZhdGUgdm9pZCBtYXliZUZvcmNl\nQnVpbGRlckluaXRpYWxpemF0aW9uKCkgewogICAgICAgIGlmIChjb20uZ29v\nZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuYWx3YXlzVXNlRmllbGRC\ndWlsZGVycykgewogICAgICAgIH0KICAgICAgfQogICAgICBwcml2YXRlIHN0\nYXRpYyBCdWlsZGVyIGNyZWF0ZSgpIHsKICAgICAgICByZXR1cm4gbmV3IEJ1\naWxkZXIoKTsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIg\nY2xlYXIoKSB7CiAgICAgICAgc3VwZXIuY2xlYXIoKTsKICAgICAgICBmbGFn\nXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVhZFJlcXVlc3QuRmxhZy5GRU5DRV9MRURHRVI7CiAgICAgICAg\nYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4MDAwMDAwMDEpOwogICAg\nICAgIGxlZGdlcklkXyA9IDBMOwogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0\nRmllbGQwXyAmIH4weDAwMDAwMDAyKTsKICAgICAgICBlbnRyeUlkXyA9IDBM\nOwogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAw\nMDA0KTsKICAgICAgICBtYXN0ZXJLZXlfID0gY29tLmdvb2dsZS5wcm90b2J1\nZi5CeXRlU3RyaW5nLkVNUFRZOwogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0\nRmllbGQwXyAmIH4weDAwMDAwMDA4KTsKICAgICAgICByZXR1cm4gdGhpczsK\nICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIgY2xvbmUoKSB7\nCiAgICAgICAgcmV0dXJuIGNyZWF0ZSgpLm1lcmdlRnJvbShidWlsZFBhcnRp\nYWwoKSk7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBjb20uZ29vZ2xl\nLnByb3RvYnVmLkRlc2NyaXB0b3JzLkRlc2NyaXB0b3IKICAgICAgICAgIGdl\ndERlc2NyaXB0b3JGb3JUeXBlKCkgewogICAgICAgIHJldHVybiBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRS\nZXF1ZXN0LmdldERlc2NyaXB0b3IoKTsKICAgICAgfQogICAgICAKICAgICAg\ncHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuUmVhZFJlcXVlc3QgZ2V0RGVmYXVsdEluc3RhbmNlRm9yVHlw\nZSgpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5nZXREZWZhdWx0\nSW5zdGFuY2UoKTsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVh\nZFJlcXVlc3QgYnVpbGQoKSB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdCByZXN1\nbHQgPSBidWlsZFBhcnRpYWwoKTsKICAgICAgICBpZiAoIXJlc3VsdC5pc0lu\naXRpYWxpemVkKCkpIHsKICAgICAgICAgIHRocm93IG5ld1VuaW5pdGlhbGl6\nZWRNZXNzYWdlRXhjZXB0aW9uKHJlc3VsdCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiByZXN1bHQ7CiAgICAgIH0KICAgICAgCiAgICAgIHByaXZhdGUg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5SZWFkUmVxdWVzdCBidWlsZFBhcnNlZCgpCiAgICAgICAgICB0aHJvd3Mg\nY29tLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNl\ncHRpb24gewogICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QgcmVzdWx0ID0gYnVpbGRQ\nYXJ0aWFsKCk7CiAgICAgICAgaWYgKCFyZXN1bHQuaXNJbml0aWFsaXplZCgp\nKSB7CiAgICAgICAgICB0aHJvdyBuZXdVbmluaXRpYWxpemVkTWVzc2FnZUV4\nY2VwdGlvbigKICAgICAgICAgICAgcmVzdWx0KS5hc0ludmFsaWRQcm90b2Nv\nbEJ1ZmZlckV4Y2VwdGlvbigpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\ncmVzdWx0OwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVx\ndWVzdCBidWlsZFBhcnRpYWwoKSB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdCBy\nZXN1bHQgPSBuZXcgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdCh0aGlzKTsKICAgICAgICBpbnQg\nZnJvbV9iaXRGaWVsZDBfID0gYml0RmllbGQwXzsKICAgICAgICBpbnQgdG9f\nYml0RmllbGQwXyA9IDA7CiAgICAgICAgaWYgKCgoZnJvbV9iaXRGaWVsZDBf\nICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAwMDAwMSkpIHsKICAgICAgICAgIHRv\nX2JpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMTsKICAgICAgICB9CiAgICAgICAg\ncmVzdWx0LmZsYWdfID0gZmxhZ187CiAgICAgICAgaWYgKCgoZnJvbV9iaXRG\naWVsZDBfICYgMHgwMDAwMDAwMikgPT0gMHgwMDAwMDAwMikpIHsKICAgICAg\nICAgIHRvX2JpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMjsKICAgICAgICB9CiAg\nICAgICAgcmVzdWx0LmxlZGdlcklkXyA9IGxlZGdlcklkXzsKICAgICAgICBp\nZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAw\nMDA0KSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAweDAwMDAwMDA0\nOwogICAgICAgIH0KICAgICAgICByZXN1bHQuZW50cnlJZF8gPSBlbnRyeUlk\nXzsKICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDA4\nKSA9PSAweDAwMDAwMDA4KSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8\nPSAweDAwMDAwMDA4OwogICAgICAgIH0KICAgICAgICByZXN1bHQubWFzdGVy\nS2V5XyA9IG1hc3RlcktleV87CiAgICAgICAgcmVzdWx0LmJpdEZpZWxkMF8g\nPSB0b19iaXRGaWVsZDBfOwogICAgICAgIG9uQnVpbHQoKTsKICAgICAgICBy\nZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgQnVp\nbGRlciBtZXJnZUZyb20oY29tLmdvb2dsZS5wcm90b2J1Zi5NZXNzYWdlIG90\naGVyKSB7CiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2Ygb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVx\ndWVzdCkgewogICAgICAgICAgcmV0dXJuIG1lcmdlRnJvbSgob3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVx\ndWVzdClvdGhlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN1cGVy\nLm1lcmdlRnJvbShvdGhlcik7CiAgICAgICAgICByZXR1cm4gdGhpczsKICAg\nICAgICB9CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVyIG1l\ncmdlRnJvbShvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLlJlYWRSZXF1ZXN0IG90aGVyKSB7CiAgICAgICAgaWYgKG90\naGVyID09IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuUmVhZFJlcXVlc3QuZ2V0RGVmYXVsdEluc3RhbmNlKCkpIHJl\ndHVybiB0aGlzOwogICAgICAgIGlmIChvdGhlci5oYXNGbGFnKCkpIHsKICAg\nICAgICAgIHNldEZsYWcob3RoZXIuZ2V0RmxhZygpKTsKICAgICAgICB9CiAg\nICAgICAgaWYgKG90aGVyLmhhc0xlZGdlcklkKCkpIHsKICAgICAgICAgIHNl\ndExlZGdlcklkKG90aGVyLmdldExlZGdlcklkKCkpOwogICAgICAgIH0KICAg\nICAgICBpZiAob3RoZXIuaGFzRW50cnlJZCgpKSB7CiAgICAgICAgICBzZXRF\nbnRyeUlkKG90aGVyLmdldEVudHJ5SWQoKSk7CiAgICAgICAgfQogICAgICAg\nIGlmIChvdGhlci5oYXNNYXN0ZXJLZXkoKSkgewogICAgICAgICAgc2V0TWFz\ndGVyS2V5KG90aGVyLmdldE1hc3RlcktleSgpKTsKICAgICAgICB9CiAgICAg\nICAgdGhpcy5tZXJnZVVua25vd25GaWVsZHMob3RoZXIuZ2V0VW5rbm93bkZp\nZWxkcygpKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICAK\nICAgICAgcHVibGljIGZpbmFsIGJvb2xlYW4gaXNJbml0aWFsaXplZCgpIHsK\nICAgICAgICBpZiAoIWhhc0xlZGdlcklkKCkpIHsKICAgICAgICAgIAogICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIWhh\nc0VudHJ5SWQoKSkgewogICAgICAgICAgCiAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAg\nICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUZyb20oCiAgICAgICAg\nICBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkSW5wdXRTdHJlYW0gaW5wdXQs\nCiAgICAgICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lz\ndHJ5TGl0ZSBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgIHRocm93cyBq\nYXZhLmlvLklPRXhjZXB0aW9uIHsKICAgICAgICBjb20uZ29vZ2xlLnByb3Rv\nYnVmLlVua25vd25GaWVsZFNldC5CdWlsZGVyIHVua25vd25GaWVsZHMgPQog\nICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5Vbmtub3duRmllbGRTZXQu\nbmV3QnVpbGRlcigKICAgICAgICAgICAgdGhpcy5nZXRVbmtub3duRmllbGRz\nKCkpOwogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICBpbnQgdGFn\nID0gaW5wdXQucmVhZFRhZygpOwogICAgICAgICAgc3dpdGNoICh0YWcpIHsK\nICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHRoaXMuc2V0VW5r\nbm93bkZpZWxkcyh1bmtub3duRmllbGRzLmJ1aWxkKCkpOwogICAgICAgICAg\nICAgIG9uQ2hhbmdlZCgpOwogICAgICAgICAgICAgIHJldHVybiB0aGlzOwog\nICAgICAgICAgICBkZWZhdWx0OiB7CiAgICAgICAgICAgICAgaWYgKCFwYXJz\nZVVua25vd25GaWVsZChpbnB1dCwgdW5rbm93bkZpZWxkcywKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvblJlZ2lzdHJ5\nLCB0YWcpKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNldFVua25vd25GaWVs\nZHModW5rbm93bkZpZWxkcy5idWlsZCgpKTsKICAgICAgICAgICAgICAgIG9u\nQ2hhbmdlZCgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGNhc2UgODogewogICAgICAgICAgICAgIGJpdEZpZWxk\nMF8gfD0gMHgwMDAwMDAwMjsKICAgICAgICAgICAgICBsZWRnZXJJZF8gPSBp\nbnB1dC5yZWFkSW50NjQoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBjYXNlIDE2OiB7CiAgICAgICAgICAgICAg\nYml0RmllbGQwXyB8PSAweDAwMDAwMDA0OwogICAgICAgICAgICAgIGVudHJ5\nSWRfID0gaW5wdXQucmVhZEludDY0KCk7CiAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAyNjogewogICAgICAg\nICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwODsKICAgICAgICAgICAg\nICBtYXN0ZXJLZXlfID0gaW5wdXQucmVhZEJ5dGVzKCk7CiAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSA4MDA6\nIHsKICAgICAgICAgICAgICBpbnQgcmF3VmFsdWUgPSBpbnB1dC5yZWFkRW51\nbSgpOwogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QuRmxhZyB2YWx1ZSA9\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuUmVhZFJlcXVlc3QuRmxhZy52YWx1ZU9mKHJhd1ZhbHVlKTsKICAgICAg\nICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\ndW5rbm93bkZpZWxkcy5tZXJnZVZhcmludEZpZWxkKDEwMCwgcmF3VmFsdWUp\nOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBiaXRG\naWVsZDBfIHw9IDB4MDAwMDAwMDE7CiAgICAgICAgICAgICAgICBmbGFnXyA9\nIHZhbHVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQog\nICAgICAKICAgICAgcHJpdmF0ZSBpbnQgYml0RmllbGQwXzsKICAgICAgCiAg\nICAgIC8vIG9wdGlvbmFsIC5SZWFkUmVxdWVzdC5GbGFnIGZsYWcgPSAxMDA7\nCiAgICAgIHByaXZhdGUgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5GbGFnIGZsYWdfID0gb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZWFkUmVxdWVzdC5GbGFnLkZFTkNFX0xFREdFUjsKICAgICAgcHVibGljIGJv\nb2xlYW4gaGFzRmxhZygpIHsKICAgICAgICByZXR1cm4gKChiaXRGaWVsZDBf\nICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAwMDAwMSk7CiAgICAgIH0KICAgICAg\ncHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuUmVhZFJlcXVlc3QuRmxhZyBnZXRGbGFnKCkgewogICAgICAg\nIHJldHVybiBmbGFnXzsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBz\nZXRGbGFnKG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuUmVhZFJlcXVlc3QuRmxhZyB2YWx1ZSkgewogICAgICAgIGlm\nICh2YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgICB0aHJvdyBuZXcgTnVsbFBv\naW50ZXJFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICAgICAgYml0RmllbGQw\nXyB8PSAweDAwMDAwMDAxOwogICAgICAgIGZsYWdfID0gdmFsdWU7CiAgICAg\nICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0K\nICAgICAgcHVibGljIEJ1aWxkZXIgY2xlYXJGbGFnKCkgewogICAgICAgIGJp\ndEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDAxKTsKICAgICAg\nICBmbGFnXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QuRmxhZy5GRU5DRV9MRURHRVI7CiAg\nICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgCiAgICAgIC8vIHJlcXVpcmVkIGludDY0IGxlZGdlcklkID0g\nMTsKICAgICAgcHJpdmF0ZSBsb25nIGxlZGdlcklkXyA7CiAgICAgIHB1Ymxp\nYyBib29sZWFuIGhhc0xlZGdlcklkKCkgewogICAgICAgIHJldHVybiAoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKTsKICAgICAg\nfQogICAgICBwdWJsaWMgbG9uZyBnZXRMZWRnZXJJZCgpIHsKICAgICAgICBy\nZXR1cm4gbGVkZ2VySWRfOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVy\nIHNldExlZGdlcklkKGxvbmcgdmFsdWUpIHsKICAgICAgICBiaXRGaWVsZDBf\nIHw9IDB4MDAwMDAwMDI7CiAgICAgICAgbGVkZ2VySWRfID0gdmFsdWU7CiAg\nICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xlYXJMZWRnZXJJZCgpIHsKICAg\nICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAwMDAwMik7\nCiAgICAgICAgbGVkZ2VySWRfID0gMEw7CiAgICAgICAgb25DaGFuZ2VkKCk7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAgICAgIC8v\nIHJlcXVpcmVkIGludDY0IGVudHJ5SWQgPSAyOwogICAgICBwcml2YXRlIGxv\nbmcgZW50cnlJZF8gOwogICAgICBwdWJsaWMgYm9vbGVhbiBoYXNFbnRyeUlk\nKCkgewogICAgICAgIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDA0\nKSA9PSAweDAwMDAwMDA0KTsKICAgICAgfQogICAgICBwdWJsaWMgbG9uZyBn\nZXRFbnRyeUlkKCkgewogICAgICAgIHJldHVybiBlbnRyeUlkXzsKICAgICAg\nfQogICAgICBwdWJsaWMgQnVpbGRlciBzZXRFbnRyeUlkKGxvbmcgdmFsdWUp\nIHsKICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDQ7CiAgICAgICAg\nZW50cnlJZF8gPSB2YWx1ZTsKICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAg\nICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBj\nbGVhckVudHJ5SWQoKSB7CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVs\nZDBfICYgfjB4MDAwMDAwMDQpOwogICAgICAgIGVudHJ5SWRfID0gMEw7CiAg\nICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgCiAgICAgIC8vIG9wdGlvbmFsIGJ5dGVzIG1hc3RlcktleSA9\nIDM7CiAgICAgIHByaXZhdGUgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3Ry\naW5nIG1hc3RlcktleV8gPSBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJp\nbmcuRU1QVFk7CiAgICAgIHB1YmxpYyBib29sZWFuIGhhc01hc3RlcktleSgp\nIHsKICAgICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwOCkg\nPT0gMHgwMDAwMDAwOCk7CiAgICAgIH0KICAgICAgcHVibGljIGNvbS5nb29n\nbGUucHJvdG9idWYuQnl0ZVN0cmluZyBnZXRNYXN0ZXJLZXkoKSB7CiAgICAg\nICAgcmV0dXJuIG1hc3RlcktleV87CiAgICAgIH0KICAgICAgcHVibGljIEJ1\naWxkZXIgc2V0TWFzdGVyS2V5KGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0\ncmluZyB2YWx1ZSkgewogICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7CiAg\nICB0aHJvdyBuZXcgTnVsbFBvaW50ZXJFeGNlcHRpb24oKTsKICB9CiAgYml0\nRmllbGQwXyB8PSAweDAwMDAwMDA4OwogICAgICAgIG1hc3RlcktleV8gPSB2\nYWx1ZTsKICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICByZXR1cm4gdGhp\nczsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBjbGVhck1hc3Rlcktl\neSgpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgw\nMDAwMDAwOCk7CiAgICAgICAgbWFzdGVyS2V5XyA9IGdldERlZmF1bHRJbnN0\nYW5jZSgpLmdldE1hc3RlcktleSgpOwogICAgICAgIG9uQ2hhbmdlZCgpOwog\nICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIAogICAgICAvLyBA\nQHByb3RvY19pbnNlcnRpb25fcG9pbnQoYnVpbGRlcl9zY29wZTpSZWFkUmVx\ndWVzdCkKICAgIH0KICAgIAogICAgc3RhdGljIHsKICAgICAgZGVmYXVsdElu\nc3RhbmNlID0gbmV3IFJlYWRSZXF1ZXN0KHRydWUpOwogICAgICBkZWZhdWx0\nSW5zdGFuY2UuaW5pdEZpZWxkcygpOwogICAgfQogICAgCiAgICAvLyBAQHBy\nb3RvY19pbnNlcnRpb25fcG9pbnQoY2xhc3Nfc2NvcGU6UmVhZFJlcXVlc3Qp\nCiAgfQogIAogIHB1YmxpYyBpbnRlcmZhY2UgQWRkUmVxdWVzdE9yQnVpbGRl\ncgogICAgICBleHRlbmRzIGNvbS5nb29nbGUucHJvdG9idWYuTWVzc2FnZU9y\nQnVpbGRlciB7CiAgICAKICAgIC8vIG9wdGlvbmFsIC5BZGRSZXF1ZXN0LkZs\nYWcgZmxhZyA9IDEwMDsKICAgIGJvb2xlYW4gaGFzRmxhZygpOwogICAgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5B\nZGRSZXF1ZXN0LkZsYWcgZ2V0RmxhZygpOwogICAgCiAgICAvLyByZXF1aXJl\nZCBpbnQ2NCBsZWRnZXJJZCA9IDE7CiAgICBib29sZWFuIGhhc0xlZGdlcklk\nKCk7CiAgICBsb25nIGdldExlZGdlcklkKCk7CiAgICAKICAgIC8vIHJlcXVp\ncmVkIGludDY0IGVudHJ5SWQgPSAyOwogICAgYm9vbGVhbiBoYXNFbnRyeUlk\nKCk7CiAgICBsb25nIGdldEVudHJ5SWQoKTsKICAgIAogICAgLy8gcmVxdWly\nZWQgYnl0ZXMgbWFzdGVyS2V5ID0gMzsKICAgIGJvb2xlYW4gaGFzTWFzdGVy\nS2V5KCk7CiAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmcgZ2V0\nTWFzdGVyS2V5KCk7CiAgICAKICAgIC8vIHJlcXVpcmVkIGJ5dGVzIGJvZHkg\nPSA0OwogICAgYm9vbGVhbiBoYXNCb2R5KCk7CiAgICBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmcgZ2V0Qm9keSgpOwogIH0KICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGNsYXNzIEFkZFJlcXVlc3QgZXh0ZW5kcwogICAgICBjb20u\nZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UKICAgICAgaW1wbGVt\nZW50cyBBZGRSZXF1ZXN0T3JCdWlsZGVyIHsKICAgIC8vIFVzZSBBZGRSZXF1\nZXN0Lm5ld0J1aWxkZXIoKSB0byBjb25zdHJ1Y3QuCiAgICBwcml2YXRlIEFk\nZFJlcXVlc3QoQnVpbGRlciBidWlsZGVyKSB7CiAgICAgIHN1cGVyKGJ1aWxk\nZXIpOwogICAgfQogICAgcHJpdmF0ZSBBZGRSZXF1ZXN0KGJvb2xlYW4gbm9J\nbml0KSB7fQogICAgCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBBZGRSZXF1\nZXN0IGRlZmF1bHRJbnN0YW5jZTsKICAgIHB1YmxpYyBzdGF0aWMgQWRkUmVx\ndWVzdCBnZXREZWZhdWx0SW5zdGFuY2UoKSB7CiAgICAgIHJldHVybiBkZWZh\ndWx0SW5zdGFuY2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBBZGRSZXF1ZXN0\nIGdldERlZmF1bHRJbnN0YW5jZUZvclR5cGUoKSB7CiAgICAgIHJldHVybiBk\nZWZhdWx0SW5zdGFuY2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5EZXNjcmlw\ndG9yCiAgICAgICAgZ2V0RGVzY3JpcHRvcigpIHsKICAgICAgcmV0dXJuIG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wu\naW50ZXJuYWxfc3RhdGljX0FkZFJlcXVlc3RfZGVzY3JpcHRvcjsKICAgIH0K\nICAgIAogICAgcHJvdGVjdGVkIGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJh\ndGVkTWVzc2FnZS5GaWVsZEFjY2Vzc29yVGFibGUKICAgICAgICBpbnRlcm5h\nbEdldEZpZWxkQWNjZXNzb3JUYWJsZSgpIHsKICAgICAgcmV0dXJuIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuaW50\nZXJuYWxfc3RhdGljX0FkZFJlcXVlc3RfZmllbGRBY2Nlc3NvclRhYmxlOwog\nICAgfQogICAgCiAgICBwdWJsaWMgZW51bSBGbGFnCiAgICAgICAgaW1wbGVt\nZW50cyBjb20uZ29vZ2xlLnByb3RvYnVmLlByb3RvY29sTWVzc2FnZUVudW0g\newogICAgICBSRUNPVkVSWV9BREQoMCwgMSksCiAgICAgIDsKICAgICAgCiAg\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFJFQ09WRVJZX0FERF9WQUxV\nRSA9IDE7CiAgICAgIAogICAgICAKICAgICAgcHVibGljIGZpbmFsIGludCBn\nZXROdW1iZXIoKSB7IHJldHVybiB2YWx1ZTsgfQogICAgICAKICAgICAgcHVi\nbGljIHN0YXRpYyBGbGFnIHZhbHVlT2YoaW50IHZhbHVlKSB7CiAgICAgICAg\nc3dpdGNoICh2YWx1ZSkgewogICAgICAgICAgY2FzZSAxOiByZXR1cm4gUkVD\nT1ZFUllfQUREOwogICAgICAgICAgZGVmYXVsdDogcmV0dXJuIG51bGw7CiAg\nICAgICAgfQogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgc3RhdGljIGNv\nbS5nb29nbGUucHJvdG9idWYuSW50ZXJuYWwuRW51bUxpdGVNYXA8RmxhZz4K\nICAgICAgICAgIGludGVybmFsR2V0VmFsdWVNYXAoKSB7CiAgICAgICAgcmV0\ndXJuIGludGVybmFsVmFsdWVNYXA7CiAgICAgIH0KICAgICAgcHJpdmF0ZSBz\ndGF0aWMgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnRlcm5hbC5FbnVtTGl0ZU1h\ncDxGbGFnPgogICAgICAgICAgaW50ZXJuYWxWYWx1ZU1hcCA9CiAgICAgICAg\nICAgIG5ldyBjb20uZ29vZ2xlLnByb3RvYnVmLkludGVybmFsLkVudW1MaXRl\nTWFwPEZsYWc+KCkgewogICAgICAgICAgICAgIHB1YmxpYyBGbGFnIGZpbmRW\nYWx1ZUJ5TnVtYmVyKGludCBudW1iZXIpIHsKICAgICAgICAgICAgICAgIHJl\ndHVybiBGbGFnLnZhbHVlT2YobnVtYmVyKTsKICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH07CiAgICAgIAogICAgICBwdWJsaWMgZmluYWwgY29tLmdv\nb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5FbnVtVmFsdWVEZXNjcmlwdG9y\nCiAgICAgICAgICBnZXRWYWx1ZURlc2NyaXB0b3IoKSB7CiAgICAgICAgcmV0\ndXJuIGdldERlc2NyaXB0b3IoKS5nZXRWYWx1ZXMoKS5nZXQoaW5kZXgpOwog\nICAgICB9CiAgICAgIHB1YmxpYyBmaW5hbCBjb20uZ29vZ2xlLnByb3RvYnVm\nLkRlc2NyaXB0b3JzLkVudW1EZXNjcmlwdG9yCiAgICAgICAgICBnZXREZXNj\ncmlwdG9yRm9yVHlwZSgpIHsKICAgICAgICByZXR1cm4gZ2V0RGVzY3JpcHRv\ncigpOwogICAgICB9CiAgICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgY29tLmdv\nb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5FbnVtRGVzY3JpcHRvcgogICAg\nICAgICAgZ2V0RGVzY3JpcHRvcigpIHsKICAgICAgICByZXR1cm4gb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRS\nZXF1ZXN0LmdldERlc2NyaXB0b3IoKS5nZXRFbnVtVHlwZXMoKS5nZXQoMCk7\nCiAgICAgIH0KICAgICAgCiAgICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIEZs\nYWdbXSBWQUxVRVMgPSB7CiAgICAgICAgUkVDT1ZFUllfQURELCAKICAgICAg\nfTsKICAgICAgCiAgICAgIHB1YmxpYyBzdGF0aWMgRmxhZyB2YWx1ZU9mKAog\nICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5FbnVt\nVmFsdWVEZXNjcmlwdG9yIGRlc2MpIHsKICAgICAgICBpZiAoZGVzYy5nZXRU\neXBlKCkgIT0gZ2V0RGVzY3JpcHRvcigpKSB7CiAgICAgICAgICB0aHJvdyBu\nZXcgamF2YS5sYW5nLklsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigKICAgICAg\nICAgICAgIkVudW1WYWx1ZURlc2NyaXB0b3IgaXMgbm90IGZvciB0aGlzIHR5\ncGUuIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBWQUxVRVNbZGVzYy5n\nZXRJbmRleCgpXTsKICAgICAgfQogICAgICAKICAgICAgcHJpdmF0ZSBmaW5h\nbCBpbnQgaW5kZXg7CiAgICAgIHByaXZhdGUgZmluYWwgaW50IHZhbHVlOwog\nICAgICAKICAgICAgcHJpdmF0ZSBGbGFnKGludCBpbmRleCwgaW50IHZhbHVl\nKSB7CiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4OwogICAgICAgIHRoaXMu\ndmFsdWUgPSB2YWx1ZTsKICAgICAgfQogICAgICAKICAgICAgLy8gQEBwcm90\nb2NfaW5zZXJ0aW9uX3BvaW50KGVudW1fc2NvcGU6QWRkUmVxdWVzdC5GbGFn\nKQogICAgfQogICAgCiAgICBwcml2YXRlIGludCBiaXRGaWVsZDBfOwogICAg\nLy8gb3B0aW9uYWwgLkFkZFJlcXVlc3QuRmxhZyBmbGFnID0gMTAwOwogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBpbnQgRkxBR19GSUVMRF9OVU1CRVIgPSAx\nMDA7CiAgICBwcml2YXRlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5GbGFnIGZsYWdfOwogICAg\ncHVibGljIGJvb2xlYW4gaGFzRmxhZygpIHsKICAgICAgcmV0dXJuICgoYml0\nRmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpOwogICAgfQog\nICAgcHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5GbGFnIGdldEZsYWcoKSB7CiAgICAg\nIHJldHVybiBmbGFnXzsKICAgIH0KICAgIAogICAgLy8gcmVxdWlyZWQgaW50\nNjQgbGVkZ2VySWQgPSAxOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQg\nTEVER0VSSURfRklFTERfTlVNQkVSID0gMTsKICAgIHByaXZhdGUgbG9uZyBs\nZWRnZXJJZF87CiAgICBwdWJsaWMgYm9vbGVhbiBoYXNMZWRnZXJJZCgpIHsK\nICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4\nMDAwMDAwMDIpOwogICAgfQogICAgcHVibGljIGxvbmcgZ2V0TGVkZ2VySWQo\nKSB7CiAgICAgIHJldHVybiBsZWRnZXJJZF87CiAgICB9CiAgICAKICAgIC8v\nIHJlcXVpcmVkIGludDY0IGVudHJ5SWQgPSAyOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBpbnQgRU5UUllJRF9GSUVMRF9OVU1CRVIgPSAyOwogICAgcHJp\ndmF0ZSBsb25nIGVudHJ5SWRfOwogICAgcHVibGljIGJvb2xlYW4gaGFzRW50\ncnlJZCgpIHsKICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAw\nMDQpID09IDB4MDAwMDAwMDQpOwogICAgfQogICAgcHVibGljIGxvbmcgZ2V0\nRW50cnlJZCgpIHsKICAgICAgcmV0dXJuIGVudHJ5SWRfOwogICAgfQogICAg\nCiAgICAvLyByZXF1aXJlZCBieXRlcyBtYXN0ZXJLZXkgPSAzOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgTUFTVEVSS0VZX0ZJRUxEX05VTUJFUiA9\nIDM7CiAgICBwcml2YXRlIGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmlu\nZyBtYXN0ZXJLZXlfOwogICAgcHVibGljIGJvb2xlYW4gaGFzTWFzdGVyS2V5\nKCkgewogICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwOCkg\nPT0gMHgwMDAwMDAwOCk7CiAgICB9CiAgICBwdWJsaWMgY29tLmdvb2dsZS5w\ncm90b2J1Zi5CeXRlU3RyaW5nIGdldE1hc3RlcktleSgpIHsKICAgICAgcmV0\ndXJuIG1hc3RlcktleV87CiAgICB9CiAgICAKICAgIC8vIHJlcXVpcmVkIGJ5\ndGVzIGJvZHkgPSA0OwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQk9E\nWV9GSUVMRF9OVU1CRVIgPSA0OwogICAgcHJpdmF0ZSBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmcgYm9keV87CiAgICBwdWJsaWMgYm9vbGVhbiBo\nYXNCb2R5KCkgewogICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAw\nMDAxMCkgPT0gMHgwMDAwMDAxMCk7CiAgICB9CiAgICBwdWJsaWMgY29tLmdv\nb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nIGdldEJvZHkoKSB7CiAgICAgIHJl\ndHVybiBib2R5XzsKICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGluaXRG\naWVsZHMoKSB7CiAgICAgIGZsYWdfID0gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0LkZsYWcuUkVD\nT1ZFUllfQUREOwogICAgICBsZWRnZXJJZF8gPSAwTDsKICAgICAgZW50cnlJ\nZF8gPSAwTDsKICAgICAgbWFzdGVyS2V5XyA9IGNvbS5nb29nbGUucHJvdG9i\ndWYuQnl0ZVN0cmluZy5FTVBUWTsKICAgICAgYm9keV8gPSBjb20uZ29vZ2xl\nLnByb3RvYnVmLkJ5dGVTdHJpbmcuRU1QVFk7CiAgICB9CiAgICBwcml2YXRl\nIGJ5dGUgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gLTE7CiAgICBwdWJsaWMg\nZmluYWwgYm9vbGVhbiBpc0luaXRpYWxpemVkKCkgewogICAgICBieXRlIGlz\nSW5pdGlhbGl6ZWQgPSBtZW1vaXplZElzSW5pdGlhbGl6ZWQ7CiAgICAgIGlm\nIChpc0luaXRpYWxpemVkICE9IC0xKSByZXR1cm4gaXNJbml0aWFsaXplZCA9\nPSAxOwogICAgICAKICAgICAgaWYgKCFoYXNMZWRnZXJJZCgpKSB7CiAgICAg\nICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFoYXNFbnRyeUlkKCkpIHsKICAg\nICAgICBtZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAwOwogICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgfQogICAgICBpZiAoIWhhc01hc3RlcktleSgpKSB7\nCiAgICAgICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsKICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFoYXNCb2R5KCkpIHsK\nICAgICAgICBtZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAwOwogICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgfQogICAgICBtZW1vaXplZElzSW5pdGlhbGl6\nZWQgPSAxOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgd3JpdGVUbyhjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0\ncHV0U3RyZWFtIG91dHB1dCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhy\nb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICBnZXRTZXJpYWxpemVk\nU2l6ZSgpOwogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMikg\nPT0gMHgwMDAwMDAwMikpIHsKICAgICAgICBvdXRwdXQud3JpdGVJbnQ2NCgx\nLCBsZWRnZXJJZF8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxkMF8g\nJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAgICAgIG91dHB1\ndC53cml0ZUludDY0KDIsIGVudHJ5SWRfKTsKICAgICAgfQogICAgICBpZiAo\nKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwOCkgPT0gMHgwMDAwMDAwOCkpIHsK\nICAgICAgICBvdXRwdXQud3JpdGVCeXRlcygzLCBtYXN0ZXJLZXlfKTsKICAg\nICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAxMCkgPT0g\nMHgwMDAwMDAxMCkpIHsKICAgICAgICBvdXRwdXQud3JpdGVCeXRlcyg0LCBi\nb2R5Xyk7CiAgICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAw\nMDAwMDEpID09IDB4MDAwMDAwMDEpKSB7CiAgICAgICAgb3V0cHV0LndyaXRl\nRW51bSgxMDAsIGZsYWdfLmdldE51bWJlcigpKTsKICAgICAgfQogICAgICBn\nZXRVbmtub3duRmllbGRzKCkud3JpdGVUbyhvdXRwdXQpOwogICAgfQogICAg\nCiAgICBwcml2YXRlIGludCBtZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gLTE7\nCiAgICBwdWJsaWMgaW50IGdldFNlcmlhbGl6ZWRTaXplKCkgewogICAgICBp\nbnQgc2l6ZSA9IG1lbW9pemVkU2VyaWFsaXplZFNpemU7CiAgICAgIGlmIChz\naXplICE9IC0xKSByZXR1cm4gc2l6ZTsKICAgIAogICAgICBzaXplID0gMDsK\nICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4MDAw\nMDAwMDIpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVm\nLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZUludDY0U2l6\nZSgxLCBsZWRnZXJJZF8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxk\nMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAgICAgIHNp\nemUgKz0gY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0cmVhbQog\nICAgICAgICAgLmNvbXB1dGVJbnQ2NFNpemUoMiwgZW50cnlJZF8pOwogICAg\nICB9CiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDA4KSA9PSAw\neDAwMDAwMDA4KSkgewogICAgICAgIHNpemUgKz0gY29tLmdvb2dsZS5wcm90\nb2J1Zi5Db2RlZE91dHB1dFN0cmVhbQogICAgICAgICAgLmNvbXB1dGVCeXRl\nc1NpemUoMywgbWFzdGVyS2V5Xyk7CiAgICAgIH0KICAgICAgaWYgKCgoYml0\nRmllbGQwXyAmIDB4MDAwMDAwMTApID09IDB4MDAwMDAwMTApKSB7CiAgICAg\nICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0cHV0U3Ry\nZWFtCiAgICAgICAgICAuY29tcHV0ZUJ5dGVzU2l6ZSg0LCBib2R5Xyk7CiAg\nICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09\nIDB4MDAwMDAwMDEpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZUVu\ndW1TaXplKDEwMCwgZmxhZ18uZ2V0TnVtYmVyKCkpOwogICAgICB9CiAgICAg\nIHNpemUgKz0gZ2V0VW5rbm93bkZpZWxkcygpLmdldFNlcmlhbGl6ZWRTaXpl\nKCk7CiAgICAgIG1lbW9pemVkU2VyaWFsaXplZFNpemUgPSBzaXplOwogICAg\nICByZXR1cm4gc2l6ZTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEID0gMEw7CiAgICBAamF2YS5s\nYW5nLk92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgamF2YS5sYW5nLk9iamVjdCB3\ncml0ZVJlcGxhY2UoKQogICAgICAgIHRocm93cyBqYXZhLmlvLk9iamVjdFN0\ncmVhbUV4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBzdXBlci53cml0ZVJlcGxh\nY2UoKTsKICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVl\nc3QgcGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQnl0\nZVN0cmluZyBkYXRhKQogICAgICAgIHRocm93cyBjb20uZ29vZ2xlLnByb3Rv\nYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiB7CiAgICAgIHJl\ndHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGRhdGEpLmJ1aWxkUGFyc2Vk\nKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdCBwYXJz\nZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5n\nIGRhdGEsCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25S\nZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dz\nIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhj\nZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20o\nZGF0YSwgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5idWls\nZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVl\nc3QgcGFyc2VGcm9tKGJ5dGVbXSBkYXRhKQogICAgICAgIHRocm93cyBjb20u\nZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlv\nbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGRhdGEp\nLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRk\nUmVxdWVzdCBwYXJzZUZyb20oCiAgICAgICAgYnl0ZVtdIGRhdGEsCiAgICAg\nICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUg\nZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUu\ncHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAg\nICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oZGF0YSwgZXh0ZW5z\naW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5idWlsZFBhcnNlZCgpOwog\nICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QgcGFyc2VGcm9t\nKGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQpCiAgICAgICAgdGhyb3dzIGph\ndmEuaW8uSU9FeGNlcHRpb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigp\nLm1lcmdlRnJvbShpbnB1dCkuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1\nYmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0IHBhcnNlRnJvbSgKICAgICAgICBq\nYXZhLmlvLklucHV0U3RyZWFtIGlucHV0LAogICAgICAgIGNvbS5nb29nbGUu\ncHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJlZ2lz\ndHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICAg\nICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oaW5wdXQsIGV4dGVu\nc2lvblJlZ2lzdHJ5KQogICAgICAgICAgICAgICAuYnVpbGRQYXJzZWQoKTsK\nICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0IHBhcnNlRGVs\naW1pdGVkRnJvbShqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0KQogICAgICAg\nIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICAgICAgQnVpbGRlciBi\ndWlsZGVyID0gbmV3QnVpbGRlcigpOwogICAgICBpZiAoYnVpbGRlci5tZXJn\nZURlbGltaXRlZEZyb20oaW5wdXQpKSB7CiAgICAgICAgcmV0dXJuIGJ1aWxk\nZXIuYnVpbGRQYXJzZWQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgfQogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFk\nZFJlcXVlc3QgcGFyc2VEZWxpbWl0ZWRGcm9tKAogICAgICAgIGphdmEuaW8u\nSW5wdXRTdHJlYW0gaW5wdXQsCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1\nZi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAg\nICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICBCdWls\nZGVyIGJ1aWxkZXIgPSBuZXdCdWlsZGVyKCk7CiAgICAgIGlmIChidWlsZGVy\nLm1lcmdlRGVsaW1pdGVkRnJvbShpbnB1dCwgZXh0ZW5zaW9uUmVnaXN0cnkp\nKSB7CiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGRQYXJzZWQoKTsKICAg\nICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAg\nfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QgcGFyc2VGcm9tKAog\nICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRJbnB1dFN0cmVhbSBp\nbnB1dCkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAg\nICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGlucHV0KS5idWls\nZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVl\nc3QgcGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQ29k\nZWRJbnB1dFN0cmVhbSBpbnB1dCwKICAgICAgICBjb20uZ29vZ2xlLnByb3Rv\nYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0ZSBleHRlbnNpb25SZWdpc3RyeSkK\nICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgICAgIHJl\ndHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGlucHV0LCBleHRlbnNpb25S\nZWdpc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFyc2VkKCk7CiAgICB9\nCiAgICAKICAgIHB1YmxpYyBzdGF0aWMgQnVpbGRlciBuZXdCdWlsZGVyKCkg\neyByZXR1cm4gQnVpbGRlci5jcmVhdGUoKTsgfQogICAgcHVibGljIEJ1aWxk\nZXIgbmV3QnVpbGRlckZvclR5cGUoKSB7IHJldHVybiBuZXdCdWlsZGVyKCk7\nIH0KICAgIHB1YmxpYyBzdGF0aWMgQnVpbGRlciBuZXdCdWlsZGVyKG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRk\nUmVxdWVzdCBwcm90b3R5cGUpIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIo\nKS5tZXJnZUZyb20ocHJvdG90eXBlKTsKICAgIH0KICAgIHB1YmxpYyBCdWls\nZGVyIHRvQnVpbGRlcigpIHsgcmV0dXJuIG5ld0J1aWxkZXIodGhpcyk7IH0K\nICAgIAogICAgQGphdmEubGFuZy5PdmVycmlkZQogICAgcHJvdGVjdGVkIEJ1\naWxkZXIgbmV3QnVpbGRlckZvclR5cGUoCiAgICAgICAgY29tLmdvb2dsZS5w\ncm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkJ1aWxkZXJQYXJlbnQgcGFyZW50\nKSB7CiAgICAgIEJ1aWxkZXIgYnVpbGRlciA9IG5ldyBCdWlsZGVyKHBhcmVu\ndCk7CiAgICAgIHJldHVybiBidWlsZGVyOwogICAgfQogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBjbGFzcyBCdWlsZGVyIGV4dGVuZHMKICAgICAgICBjb20u\nZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuQnVpbGRlcjxCdWls\nZGVyPgogICAgICAgaW1wbGVtZW50cyBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3RPckJ1aWxkZXIg\newogICAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGNvbS5nb29nbGUucHJvdG9i\ndWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRvcgogICAgICAgICAgZ2V0RGVzY3Jp\ncHRvcigpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0aWNfQWRk\nUmVxdWVzdF9kZXNjcmlwdG9yOwogICAgICB9CiAgICAgIAogICAgICBwcm90\nZWN0ZWQgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZp\nZWxkQWNjZXNzb3JUYWJsZQogICAgICAgICAgaW50ZXJuYWxHZXRGaWVsZEFj\nY2Vzc29yVGFibGUoKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuaW50ZXJuYWxfc3Rh\ndGljX0FkZFJlcXVlc3RfZmllbGRBY2Nlc3NvclRhYmxlOwogICAgICB9CiAg\nICAgIAogICAgICAvLyBDb25zdHJ1Y3QgdXNpbmcgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0Lm5l\nd0J1aWxkZXIoKQogICAgICBwcml2YXRlIEJ1aWxkZXIoKSB7CiAgICAgICAg\nbWF5YmVGb3JjZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpOwogICAgICB9CiAg\nICAgIAogICAgICBwcml2YXRlIEJ1aWxkZXIoQnVpbGRlclBhcmVudCBwYXJl\nbnQpIHsKICAgICAgICBzdXBlcihwYXJlbnQpOwogICAgICAgIG1heWJlRm9y\nY2VCdWlsZGVySW5pdGlhbGl6YXRpb24oKTsKICAgICAgfQogICAgICBwcml2\nYXRlIHZvaWQgbWF5YmVGb3JjZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpIHsK\nICAgICAgICBpZiAoY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNz\nYWdlLmFsd2F5c1VzZUZpZWxkQnVpbGRlcnMpIHsKICAgICAgICB9CiAgICAg\nIH0KICAgICAgcHJpdmF0ZSBzdGF0aWMgQnVpbGRlciBjcmVhdGUoKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBCdWlsZGVyKCk7CiAgICAgIH0KICAgICAgCiAg\nICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFyKCkgewogICAgICAgIHN1cGVyLmNs\nZWFyKCk7CiAgICAgICAgZmxhZ18gPSBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QuRmxhZy5SRUNP\nVkVSWV9BREQ7CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYg\nfjB4MDAwMDAwMDEpOwogICAgICAgIGxlZGdlcklkXyA9IDBMOwogICAgICAg\nIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDAyKTsKICAg\nICAgICBlbnRyeUlkXyA9IDBMOwogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0\nRmllbGQwXyAmIH4weDAwMDAwMDA0KTsKICAgICAgICBtYXN0ZXJLZXlfID0g\nY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nLkVNUFRZOwogICAgICAg\nIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDA4KTsKICAg\nICAgICBib2R5XyA9IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZy5F\nTVBUWTsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgw\nMDAwMDAxMCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAg\nCiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsb25lKCkgewogICAgICAgIHJldHVy\nbiBjcmVhdGUoKS5tZXJnZUZyb20oYnVpbGRQYXJ0aWFsKCkpOwogICAgICB9\nCiAgICAgIAogICAgICBwdWJsaWMgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNj\ncmlwdG9ycy5EZXNjcmlwdG9yCiAgICAgICAgICBnZXREZXNjcmlwdG9yRm9y\nVHlwZSgpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0LmdldERlc2Ny\naXB0b3IoKTsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVx\ndWVzdCBnZXREZWZhdWx0SW5zdGFuY2VGb3JUeXBlKCkgewogICAgICAgIHJl\ndHVybiBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLkFkZFJlcXVlc3QuZ2V0RGVmYXVsdEluc3RhbmNlKCk7CiAgICAg\nIH0KICAgICAgCiAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QgYnVpbGQoKSB7\nCiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5BZGRSZXF1ZXN0IHJlc3VsdCA9IGJ1aWxkUGFydGlhbCgp\nOwogICAgICAgIGlmICghcmVzdWx0LmlzSW5pdGlhbGl6ZWQoKSkgewogICAg\nICAgICAgdGhyb3cgbmV3VW5pbml0aWFsaXplZE1lc3NhZ2VFeGNlcHRpb24o\ncmVzdWx0KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAg\nICAgfQogICAgICAKICAgICAgcHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QgYnVpbGRQ\nYXJzZWQoKQogICAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUucHJvdG9idWYu\nSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAgICAgICBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFk\nZFJlcXVlc3QgcmVzdWx0ID0gYnVpbGRQYXJ0aWFsKCk7CiAgICAgICAgaWYg\nKCFyZXN1bHQuaXNJbml0aWFsaXplZCgpKSB7CiAgICAgICAgICB0aHJvdyBu\nZXdVbmluaXRpYWxpemVkTWVzc2FnZUV4Y2VwdGlvbigKICAgICAgICAgICAg\ncmVzdWx0KS5hc0ludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbigpOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICAg\nIAogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0IGJ1aWxkUGFydGlhbCgpIHsK\nICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLkFkZFJlcXVlc3QgcmVzdWx0ID0gbmV3IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVz\ndCh0aGlzKTsKICAgICAgICBpbnQgZnJvbV9iaXRGaWVsZDBfID0gYml0Rmll\nbGQwXzsKICAgICAgICBpbnQgdG9fYml0RmllbGQwXyA9IDA7CiAgICAgICAg\naWYgKCgoZnJvbV9iaXRGaWVsZDBfICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAw\nMDAwMSkpIHsKICAgICAgICAgIHRvX2JpdEZpZWxkMF8gfD0gMHgwMDAwMDAw\nMTsKICAgICAgICB9CiAgICAgICAgcmVzdWx0LmZsYWdfID0gZmxhZ187CiAg\nICAgICAgaWYgKCgoZnJvbV9iaXRGaWVsZDBfICYgMHgwMDAwMDAwMikgPT0g\nMHgwMDAwMDAwMikpIHsKICAgICAgICAgIHRvX2JpdEZpZWxkMF8gfD0gMHgw\nMDAwMDAwMjsKICAgICAgICB9CiAgICAgICAgcmVzdWx0LmxlZGdlcklkXyA9\nIGxlZGdlcklkXzsKICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAw\neDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAgICAgICAgdG9fYml0\nRmllbGQwXyB8PSAweDAwMDAwMDA0OwogICAgICAgIH0KICAgICAgICByZXN1\nbHQuZW50cnlJZF8gPSBlbnRyeUlkXzsKICAgICAgICBpZiAoKChmcm9tX2Jp\ndEZpZWxkMF8gJiAweDAwMDAwMDA4KSA9PSAweDAwMDAwMDA4KSkgewogICAg\nICAgICAgdG9fYml0RmllbGQwXyB8PSAweDAwMDAwMDA4OwogICAgICAgIH0K\nICAgICAgICByZXN1bHQubWFzdGVyS2V5XyA9IG1hc3RlcktleV87CiAgICAg\nICAgaWYgKCgoZnJvbV9iaXRGaWVsZDBfICYgMHgwMDAwMDAxMCkgPT0gMHgw\nMDAwMDAxMCkpIHsKICAgICAgICAgIHRvX2JpdEZpZWxkMF8gfD0gMHgwMDAw\nMDAxMDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0LmJvZHlfID0gYm9keV87\nCiAgICAgICAgcmVzdWx0LmJpdEZpZWxkMF8gPSB0b19iaXRGaWVsZDBfOwog\nICAgICAgIG9uQnVpbHQoKTsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAg\nICB9CiAgICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUZyb20oY29t\nLmdvb2dsZS5wcm90b2J1Zi5NZXNzYWdlIG90aGVyKSB7CiAgICAgICAgaWYg\nKG90aGVyIGluc3RhbmNlb2Ygb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0KSB7CiAgICAgICAgICBy\nZXR1cm4gbWVyZ2VGcm9tKChvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3Qpb3RoZXIpOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICBzdXBlci5tZXJnZUZyb20ob3RoZXIpOwog\nICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICB9CiAgICAg\nIAogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUZyb20ob3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0\nIG90aGVyKSB7CiAgICAgICAgaWYgKG90aGVyID09IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5n\nZXREZWZhdWx0SW5zdGFuY2UoKSkgcmV0dXJuIHRoaXM7CiAgICAgICAgaWYg\nKG90aGVyLmhhc0ZsYWcoKSkgewogICAgICAgICAgc2V0RmxhZyhvdGhlci5n\nZXRGbGFnKCkpOwogICAgICAgIH0KICAgICAgICBpZiAob3RoZXIuaGFzTGVk\nZ2VySWQoKSkgewogICAgICAgICAgc2V0TGVkZ2VySWQob3RoZXIuZ2V0TGVk\nZ2VySWQoKSk7CiAgICAgICAgfQogICAgICAgIGlmIChvdGhlci5oYXNFbnRy\neUlkKCkpIHsKICAgICAgICAgIHNldEVudHJ5SWQob3RoZXIuZ2V0RW50cnlJ\nZCgpKTsKICAgICAgICB9CiAgICAgICAgaWYgKG90aGVyLmhhc01hc3Rlcktl\neSgpKSB7CiAgICAgICAgICBzZXRNYXN0ZXJLZXkob3RoZXIuZ2V0TWFzdGVy\nS2V5KCkpOwogICAgICAgIH0KICAgICAgICBpZiAob3RoZXIuaGFzQm9keSgp\nKSB7CiAgICAgICAgICBzZXRCb2R5KG90aGVyLmdldEJvZHkoKSk7CiAgICAg\nICAgfQogICAgICAgIHRoaXMubWVyZ2VVbmtub3duRmllbGRzKG90aGVyLmdl\ndFVua25vd25GaWVsZHMoKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgCiAgICAgIHB1YmxpYyBmaW5hbCBib29sZWFuIGlzSW5pdGlh\nbGl6ZWQoKSB7CiAgICAgICAgaWYgKCFoYXNMZWRnZXJJZCgpKSB7CiAgICAg\nICAgICAKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAg\nICAgaWYgKCFoYXNFbnRyeUlkKCkpIHsKICAgICAgICAgIAogICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIWhhc01hc3Rl\ncktleSgpKSB7CiAgICAgICAgICAKICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICB9CiAgICAgICAgaWYgKCFoYXNCb2R5KCkpIHsKICAgICAgICAg\nIAogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxk\nZXIgbWVyZ2VGcm9tKAogICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5D\nb2RlZElucHV0U3RyZWFtIGlucHV0LAogICAgICAgICAgY29tLmdvb2dsZS5w\ncm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0\ncnkpCiAgICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAg\nICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5Vbmtub3duRmllbGRTZXQuQnVp\nbGRlciB1bmtub3duRmllbGRzID0KICAgICAgICAgIGNvbS5nb29nbGUucHJv\ndG9idWYuVW5rbm93bkZpZWxkU2V0Lm5ld0J1aWxkZXIoCiAgICAgICAgICAg\nIHRoaXMuZ2V0VW5rbm93bkZpZWxkcygpKTsKICAgICAgICB3aGlsZSAodHJ1\nZSkgewogICAgICAgICAgaW50IHRhZyA9IGlucHV0LnJlYWRUYWcoKTsKICAg\nICAgICAgIHN3aXRjaCAodGFnKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAg\nICAgICAgICAgICB0aGlzLnNldFVua25vd25GaWVsZHModW5rbm93bkZpZWxk\ncy5idWlsZCgpKTsKICAgICAgICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAg\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgZGVmYXVsdDogewog\nICAgICAgICAgICAgIGlmICghcGFyc2VVbmtub3duRmllbGQoaW5wdXQsIHVu\na25vd25GaWVsZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBleHRlbnNpb25SZWdpc3RyeSwgdGFnKSkgewogICAgICAgICAgICAg\nICAgdGhpcy5zZXRVbmtub3duRmllbGRzKHVua25vd25GaWVsZHMuYnVpbGQo\nKSk7CiAgICAgICAgICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICAgICAg\nICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIDg6IHsK\nICAgICAgICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAg\nICAgICAgICAgbGVkZ2VySWRfID0gaW5wdXQucmVhZEludDY0KCk7CiAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2Fz\nZSAxNjogewogICAgICAgICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAw\nNDsKICAgICAgICAgICAgICBlbnRyeUlkXyA9IGlucHV0LnJlYWRJbnQ2NCgp\nOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGNhc2UgMjY6IHsKICAgICAgICAgICAgICBiaXRGaWVsZDBfIHw9IDB4\nMDAwMDAwMDg7CiAgICAgICAgICAgICAgbWFzdGVyS2V5XyA9IGlucHV0LnJl\nYWRCeXRlcygpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGNhc2UgMzQ6IHsKICAgICAgICAgICAgICBiaXRGaWVs\nZDBfIHw9IDB4MDAwMDAwMTA7CiAgICAgICAgICAgICAgYm9keV8gPSBpbnB1\ndC5yZWFkQnl0ZXMoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBjYXNlIDgwMDogewogICAgICAgICAgICAgIGlu\ndCByYXdWYWx1ZSA9IGlucHV0LnJlYWRFbnVtKCk7CiAgICAgICAgICAgICAg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5BZGRSZXF1ZXN0LkZsYWcgdmFsdWUgPSBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QuRmxhZy52\nYWx1ZU9mKHJhd1ZhbHVlKTsKICAgICAgICAgICAgICBpZiAodmFsdWUgPT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgdW5rbm93bkZpZWxkcy5tZXJnZVZh\ncmludEZpZWxkKDEwMCwgcmF3VmFsdWUpOwogICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDE7\nCiAgICAgICAgICAgICAgICBmbGFnXyA9IHZhbHVlOwogICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgfQogICAgICAKICAgICAgcHJpdmF0ZSBp\nbnQgYml0RmllbGQwXzsKICAgICAgCiAgICAgIC8vIG9wdGlvbmFsIC5BZGRS\nZXF1ZXN0LkZsYWcgZmxhZyA9IDEwMDsKICAgICAgcHJpdmF0ZSBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJl\ncXVlc3QuRmxhZyBmbGFnXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5GbGFnLlJFQ09WRVJZ\nX0FERDsKICAgICAgcHVibGljIGJvb2xlYW4gaGFzRmxhZygpIHsKICAgICAg\nICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAw\nMDAwMSk7CiAgICAgIH0KICAgICAgcHVibGljIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5GbGFn\nIGdldEZsYWcoKSB7CiAgICAgICAgcmV0dXJuIGZsYWdfOwogICAgICB9CiAg\nICAgIHB1YmxpYyBCdWlsZGVyIHNldEZsYWcob3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXF1ZXN0LkZsYWcg\ndmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAg\nICAgdGhyb3cgbmV3IE51bGxQb2ludGVyRXhjZXB0aW9uKCk7CiAgICAgICAg\nfQogICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMTsKICAgICAgICBm\nbGFnXyA9IHZhbHVlOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJl\ndHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFy\nRmxhZygpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+\nMHgwMDAwMDAwMSk7CiAgICAgICAgZmxhZ18gPSBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlcXVlc3QuRmxh\nZy5SRUNPVkVSWV9BREQ7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAgICAgIC8vIHJlcXVpcmVk\nIGludDY0IGxlZGdlcklkID0gMTsKICAgICAgcHJpdmF0ZSBsb25nIGxlZGdl\ncklkXyA7CiAgICAgIHB1YmxpYyBib29sZWFuIGhhc0xlZGdlcklkKCkgewog\nICAgICAgIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAw\neDAwMDAwMDAyKTsKICAgICAgfQogICAgICBwdWJsaWMgbG9uZyBnZXRMZWRn\nZXJJZCgpIHsKICAgICAgICByZXR1cm4gbGVkZ2VySWRfOwogICAgICB9CiAg\nICAgIHB1YmxpYyBCdWlsZGVyIHNldExlZGdlcklkKGxvbmcgdmFsdWUpIHsK\nICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAgICAgbGVk\nZ2VySWRfID0gdmFsdWU7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xl\nYXJMZWRnZXJJZCgpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxk\nMF8gJiB+MHgwMDAwMDAwMik7CiAgICAgICAgbGVkZ2VySWRfID0gMEw7CiAg\nICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nIH0KICAgICAgCiAgICAgIC8vIHJlcXVpcmVkIGludDY0IGVudHJ5SWQgPSAy\nOwogICAgICBwcml2YXRlIGxvbmcgZW50cnlJZF8gOwogICAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNFbnRyeUlkKCkgewogICAgICAgIHJldHVybiAoKGJpdEZp\nZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KTsKICAgICAgfQog\nICAgICBwdWJsaWMgbG9uZyBnZXRFbnRyeUlkKCkgewogICAgICAgIHJldHVy\nbiBlbnRyeUlkXzsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBzZXRF\nbnRyeUlkKGxvbmcgdmFsdWUpIHsKICAgICAgICBiaXRGaWVsZDBfIHw9IDB4\nMDAwMDAwMDQ7CiAgICAgICAgZW50cnlJZF8gPSB2YWx1ZTsKICAgICAgICBv\nbkNoYW5nZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAg\nICBwdWJsaWMgQnVpbGRlciBjbGVhckVudHJ5SWQoKSB7CiAgICAgICAgYml0\nRmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4MDAwMDAwMDQpOwogICAgICAg\nIGVudHJ5SWRfID0gMEw7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAgICAgIC8vIHJlcXVpcmVk\nIGJ5dGVzIG1hc3RlcktleSA9IDM7CiAgICAgIHByaXZhdGUgY29tLmdvb2ds\nZS5wcm90b2J1Zi5CeXRlU3RyaW5nIG1hc3RlcktleV8gPSBjb20uZ29vZ2xl\nLnByb3RvYnVmLkJ5dGVTdHJpbmcuRU1QVFk7CiAgICAgIHB1YmxpYyBib29s\nZWFuIGhhc01hc3RlcktleSgpIHsKICAgICAgICByZXR1cm4gKChiaXRGaWVs\nZDBfICYgMHgwMDAwMDAwOCkgPT0gMHgwMDAwMDAwOCk7CiAgICAgIH0KICAg\nICAgcHVibGljIGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZyBnZXRN\nYXN0ZXJLZXkoKSB7CiAgICAgICAgcmV0dXJuIG1hc3RlcktleV87CiAgICAg\nIH0KICAgICAgcHVibGljIEJ1aWxkZXIgc2V0TWFzdGVyS2V5KGNvbS5nb29n\nbGUucHJvdG9idWYuQnl0ZVN0cmluZyB2YWx1ZSkgewogICAgICAgIGlmICh2\nYWx1ZSA9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgTnVsbFBvaW50ZXJFeGNl\ncHRpb24oKTsKICB9CiAgYml0RmllbGQwXyB8PSAweDAwMDAwMDA4OwogICAg\nICAgIG1hc3RlcktleV8gPSB2YWx1ZTsKICAgICAgICBvbkNoYW5nZWQoKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgQnVp\nbGRlciBjbGVhck1hc3RlcktleSgpIHsKICAgICAgICBiaXRGaWVsZDBfID0g\nKGJpdEZpZWxkMF8gJiB+MHgwMDAwMDAwOCk7CiAgICAgICAgbWFzdGVyS2V5\nXyA9IGdldERlZmF1bHRJbnN0YW5jZSgpLmdldE1hc3RlcktleSgpOwogICAg\nICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9\nCiAgICAgIAogICAgICAvLyByZXF1aXJlZCBieXRlcyBib2R5ID0gNDsKICAg\nICAgcHJpdmF0ZSBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmcgYm9k\neV8gPSBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmcuRU1QVFk7CiAg\nICAgIHB1YmxpYyBib29sZWFuIGhhc0JvZHkoKSB7CiAgICAgICAgcmV0dXJu\nICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMTApID09IDB4MDAwMDAwMTApOwog\nICAgICB9CiAgICAgIHB1YmxpYyBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVT\ndHJpbmcgZ2V0Qm9keSgpIHsKICAgICAgICByZXR1cm4gYm9keV87CiAgICAg\nIH0KICAgICAgcHVibGljIEJ1aWxkZXIgc2V0Qm9keShjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmcgdmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUg\nPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IE51bGxQb2ludGVyRXhjZXB0aW9u\nKCk7CiAgfQogIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAxMDsKICAgICAgICBi\nb2R5XyA9IHZhbHVlOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJl\ndHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFy\nQm9keSgpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+\nMHgwMDAwMDAxMCk7CiAgICAgICAgYm9keV8gPSBnZXREZWZhdWx0SW5zdGFu\nY2UoKS5nZXRCb2R5KCk7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAgICAgIC8vIEBAcHJvdG9j\nX2luc2VydGlvbl9wb2ludChidWlsZGVyX3Njb3BlOkFkZFJlcXVlc3QpCiAg\nICB9CiAgICAKICAgIHN0YXRpYyB7CiAgICAgIGRlZmF1bHRJbnN0YW5jZSA9\nIG5ldyBBZGRSZXF1ZXN0KHRydWUpOwogICAgICBkZWZhdWx0SW5zdGFuY2Uu\naW5pdEZpZWxkcygpOwogICAgfQogICAgCiAgICAvLyBAQHByb3RvY19pbnNl\ncnRpb25fcG9pbnQoY2xhc3Nfc2NvcGU6QWRkUmVxdWVzdCkKICB9CiAgCiAg\ncHVibGljIGludGVyZmFjZSBSZXNwb25zZU9yQnVpbGRlcgogICAgICBleHRl\nbmRzIGNvbS5nb29nbGUucHJvdG9idWYuTWVzc2FnZU9yQnVpbGRlciB7CiAg\nICAKICAgIC8vIHJlcXVpcmVkIC5CS1BhY2tldEhlYWRlciBoZWFkZXIgPSAx\nOwogICAgYm9vbGVhbiBoYXNIZWFkZXIoKTsKICAgIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFk\nZXIgZ2V0SGVhZGVyKCk7CiAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyT3JCdWlsZGVy\nIGdldEhlYWRlck9yQnVpbGRlcigpOwogICAgCiAgICAvLyByZXF1aXJlZCAu\nU3RhdHVzQ29kZSBzdGF0dXMgPSAyOwogICAgYm9vbGVhbiBoYXNTdGF0dXMo\nKTsKICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuU3RhdHVzQ29kZSBnZXRTdGF0dXMoKTsKICAgIAogICAgLy8g\nb3B0aW9uYWwgLlJlYWRSZXNwb25zZSByZWFkUmVzcG9uc2UgPSAxMDA7CiAg\nICBib29sZWFuIGhhc1JlYWRSZXNwb25zZSgpOwogICAgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9u\nc2UgZ2V0UmVhZFJlc3BvbnNlKCk7CiAgICBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZU9yQnVp\nbGRlciBnZXRSZWFkUmVzcG9uc2VPckJ1aWxkZXIoKTsKICAgIAogICAgLy8g\nb3B0aW9uYWwgLkFkZFJlc3BvbnNlIGFkZFJlc3BvbnNlID0gMTAxOwogICAg\nYm9vbGVhbiBoYXNBZGRSZXNwb25zZSgpOwogICAgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZSBn\nZXRBZGRSZXNwb25zZSgpOwogICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZU9yQnVpbGRlciBn\nZXRBZGRSZXNwb25zZU9yQnVpbGRlcigpOwogIH0KICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIGNsYXNzIFJlc3BvbnNlIGV4dGVuZHMKICAgICAgY29tLmdvb2ds\nZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlCiAgICAgIGltcGxlbWVudHMg\nUmVzcG9uc2VPckJ1aWxkZXIgewogICAgLy8gVXNlIFJlc3BvbnNlLm5ld0J1\naWxkZXIoKSB0byBjb25zdHJ1Y3QuCiAgICBwcml2YXRlIFJlc3BvbnNlKEJ1\naWxkZXIgYnVpbGRlcikgewogICAgICBzdXBlcihidWlsZGVyKTsKICAgIH0K\nICAgIHByaXZhdGUgUmVzcG9uc2UoYm9vbGVhbiBub0luaXQpIHt9CiAgICAK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFJlc3BvbnNlIGRlZmF1bHRJbnN0\nYW5jZTsKICAgIHB1YmxpYyBzdGF0aWMgUmVzcG9uc2UgZ2V0RGVmYXVsdElu\nc3RhbmNlKCkgewogICAgICByZXR1cm4gZGVmYXVsdEluc3RhbmNlOwogICAg\nfQogICAgCiAgICBwdWJsaWMgUmVzcG9uc2UgZ2V0RGVmYXVsdEluc3RhbmNl\nRm9yVHlwZSgpIHsKICAgICAgcmV0dXJuIGRlZmF1bHRJbnN0YW5jZTsKICAg\nIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBmaW5hbCBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkRlc2NyaXB0b3JzLkRlc2NyaXB0b3IKICAgICAgICBnZXREZXNj\ncmlwdG9yKCkgewogICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0aWNfUmVz\ncG9uc2VfZGVzY3JpcHRvcjsKICAgIH0KICAgIAogICAgcHJvdGVjdGVkIGNv\nbS5nb29nbGUucHJvdG9idWYuR2VuZXJhdGVkTWVzc2FnZS5GaWVsZEFjY2Vz\nc29yVGFibGUKICAgICAgICBpbnRlcm5hbEdldEZpZWxkQWNjZXNzb3JUYWJs\nZSgpIHsKICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuaW50ZXJuYWxfc3RhdGljX1Jlc3BvbnNl\nX2ZpZWxkQWNjZXNzb3JUYWJsZTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBp\nbnQgYml0RmllbGQwXzsKICAgIC8vIHJlcXVpcmVkIC5CS1BhY2tldEhlYWRl\nciBoZWFkZXIgPSAxOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgSEVB\nREVSX0ZJRUxEX05VTUJFUiA9IDE7CiAgICBwcml2YXRlIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRI\nZWFkZXIgaGVhZGVyXzsKICAgIHB1YmxpYyBib29sZWFuIGhhc0hlYWRlcigp\nIHsKICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09\nIDB4MDAwMDAwMDEpOwogICAgfQogICAgcHVibGljIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFk\nZXIgZ2V0SGVhZGVyKCkgewogICAgICByZXR1cm4gaGVhZGVyXzsKICAgIH0K\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyT3JCdWlsZGVyIGdldEhlYWRl\nck9yQnVpbGRlcigpIHsKICAgICAgcmV0dXJuIGhlYWRlcl87CiAgICB9CiAg\nICAKICAgIC8vIHJlcXVpcmVkIC5TdGF0dXNDb2RlIHN0YXR1cyA9IDI7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBTVEFUVVNfRklFTERfTlVNQkVS\nID0gMjsKICAgIHByaXZhdGUgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIHN0YXR1c187CiAgICBw\ndWJsaWMgYm9vbGVhbiBoYXNTdGF0dXMoKSB7CiAgICAgIHJldHVybiAoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKTsKICAgIH0K\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLlN0YXR1c0NvZGUgZ2V0U3RhdHVzKCkgewogICAgICBy\nZXR1cm4gc3RhdHVzXzsKICAgIH0KICAgIAogICAgLy8gb3B0aW9uYWwgLlJl\nYWRSZXNwb25zZSByZWFkUmVzcG9uc2UgPSAxMDA7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGludCBSRUFEUkVTUE9OU0VfRklFTERfTlVNQkVSID0gMTAw\nOwogICAgcHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZSByZWFkUmVzcG9uc2VfOwog\nICAgcHVibGljIGJvb2xlYW4gaGFzUmVhZFJlc3BvbnNlKCkgewogICAgICBy\nZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwNCkgPT0gMHgwMDAwMDAw\nNCk7CiAgICB9CiAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UgZ2V0UmVhZFJl\nc3BvbnNlKCkgewogICAgICByZXR1cm4gcmVhZFJlc3BvbnNlXzsKICAgIH0K\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLlJlYWRSZXNwb25zZU9yQnVpbGRlciBnZXRSZWFkUmVz\ncG9uc2VPckJ1aWxkZXIoKSB7CiAgICAgIHJldHVybiByZWFkUmVzcG9uc2Vf\nOwogICAgfQogICAgCiAgICAvLyBvcHRpb25hbCAuQWRkUmVzcG9uc2UgYWRk\nUmVzcG9uc2UgPSAxMDE7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBB\nRERSRVNQT05TRV9GSUVMRF9OVU1CRVIgPSAxMDE7CiAgICBwcml2YXRlIG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wu\nQWRkUmVzcG9uc2UgYWRkUmVzcG9uc2VfOwogICAgcHVibGljIGJvb2xlYW4g\naGFzQWRkUmVzcG9uc2UoKSB7CiAgICAgIHJldHVybiAoKGJpdEZpZWxkMF8g\nJiAweDAwMDAwMDA4KSA9PSAweDAwMDAwMDA4KTsKICAgIH0KICAgIHB1Ymxp\nYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3Rv\nY29sLkFkZFJlc3BvbnNlIGdldEFkZFJlc3BvbnNlKCkgewogICAgICByZXR1\ncm4gYWRkUmVzcG9uc2VfOwogICAgfQogICAgcHVibGljIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9u\nc2VPckJ1aWxkZXIgZ2V0QWRkUmVzcG9uc2VPckJ1aWxkZXIoKSB7CiAgICAg\nIHJldHVybiBhZGRSZXNwb25zZV87CiAgICB9CiAgICAKICAgIHByaXZhdGUg\ndm9pZCBpbml0RmllbGRzKCkgewogICAgICBoZWFkZXJfID0gb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tl\ndEhlYWRlci5nZXREZWZhdWx0SW5zdGFuY2UoKTsKICAgICAgc3RhdHVzXyA9\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuU3RhdHVzQ29kZS5FT0s7CiAgICAgIHJlYWRSZXNwb25zZV8gPSBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJl\nYWRSZXNwb25zZS5nZXREZWZhdWx0SW5zdGFuY2UoKTsKICAgICAgYWRkUmVz\ncG9uc2VfID0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5BZGRSZXNwb25zZS5nZXREZWZhdWx0SW5zdGFuY2UoKTsK\nICAgIH0KICAgIHByaXZhdGUgYnl0ZSBtZW1vaXplZElzSW5pdGlhbGl6ZWQg\nPSAtMTsKICAgIHB1YmxpYyBmaW5hbCBib29sZWFuIGlzSW5pdGlhbGl6ZWQo\nKSB7CiAgICAgIGJ5dGUgaXNJbml0aWFsaXplZCA9IG1lbW9pemVkSXNJbml0\naWFsaXplZDsKICAgICAgaWYgKGlzSW5pdGlhbGl6ZWQgIT0gLTEpIHJldHVy\nbiBpc0luaXRpYWxpemVkID09IDE7CiAgICAgIAogICAgICBpZiAoIWhhc0hl\nYWRlcigpKSB7CiAgICAgICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMDsK\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCFoYXNT\ndGF0dXMoKSkgewogICAgICAgIG1lbW9pemVkSXNJbml0aWFsaXplZCA9IDA7\nCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGlmICghZ2V0\nSGVhZGVyKCkuaXNJbml0aWFsaXplZCgpKSB7CiAgICAgICAgbWVtb2l6ZWRJ\nc0luaXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nIH0KICAgICAgaWYgKGhhc1JlYWRSZXNwb25zZSgpKSB7CiAgICAgICAgaWYg\nKCFnZXRSZWFkUmVzcG9uc2UoKS5pc0luaXRpYWxpemVkKCkpIHsKICAgICAg\nICAgIG1lbW9pemVkSXNJbml0aWFsaXplZCA9IDA7CiAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChoYXNBZGRS\nZXNwb25zZSgpKSB7CiAgICAgICAgaWYgKCFnZXRBZGRSZXNwb25zZSgpLmlz\nSW5pdGlhbGl6ZWQoKSkgewogICAgICAgICAgbWVtb2l6ZWRJc0luaXRpYWxp\nemVkID0gMDsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAg\nICAgIH0KICAgICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMTsKICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHdyaXRl\nVG8oY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0cmVhbSBvdXRw\ndXQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93cyBqYXZhLmlvLklP\nRXhjZXB0aW9uIHsKICAgICAgZ2V0U2VyaWFsaXplZFNpemUoKTsKICAgICAg\naWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEp\nKSB7CiAgICAgICAgb3V0cHV0LndyaXRlTWVzc2FnZSgxLCBoZWFkZXJfKTsK\nICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMikg\nPT0gMHgwMDAwMDAwMikpIHsKICAgICAgICBvdXRwdXQud3JpdGVFbnVtKDIs\nIHN0YXR1c18uZ2V0TnVtYmVyKCkpOwogICAgICB9CiAgICAgIGlmICgoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAg\nICAgIG91dHB1dC53cml0ZU1lc3NhZ2UoMTAwLCByZWFkUmVzcG9uc2VfKTsK\nICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwOCkg\nPT0gMHgwMDAwMDAwOCkpIHsKICAgICAgICBvdXRwdXQud3JpdGVNZXNzYWdl\nKDEwMSwgYWRkUmVzcG9uc2VfKTsKICAgICAgfQogICAgICBnZXRVbmtub3du\nRmllbGRzKCkud3JpdGVUbyhvdXRwdXQpOwogICAgfQogICAgCiAgICBwcml2\nYXRlIGludCBtZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gLTE7CiAgICBwdWJs\naWMgaW50IGdldFNlcmlhbGl6ZWRTaXplKCkgewogICAgICBpbnQgc2l6ZSA9\nIG1lbW9pemVkU2VyaWFsaXplZFNpemU7CiAgICAgIGlmIChzaXplICE9IC0x\nKSByZXR1cm4gc2l6ZTsKICAgIAogICAgICBzaXplID0gMDsKICAgICAgaWYg\nKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpKSB7\nCiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkT3V0\ncHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZU1lc3NhZ2VTaXplKDEsIGhl\nYWRlcl8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAweDAw\nMDAwMDAyKSA9PSAweDAwMDAwMDAyKSkgewogICAgICAgIHNpemUgKz0gY29t\nLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0cmVhbQogICAgICAgICAg\nLmNvbXB1dGVFbnVtU2l6ZSgyLCBzdGF0dXNfLmdldE51bWJlcigpKTsKICAg\nICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwNCkgPT0g\nMHgwMDAwMDAwNCkpIHsKICAgICAgICBzaXplICs9IGNvbS5nb29nbGUucHJv\ndG9idWYuQ29kZWRPdXRwdXRTdHJlYW0KICAgICAgICAgIC5jb21wdXRlTWVz\nc2FnZVNpemUoMTAwLCByZWFkUmVzcG9uc2VfKTsKICAgICAgfQogICAgICBp\nZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwOCkgPT0gMHgwMDAwMDAwOCkp\nIHsKICAgICAgICBzaXplICs9IGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRP\ndXRwdXRTdHJlYW0KICAgICAgICAgIC5jb21wdXRlTWVzc2FnZVNpemUoMTAx\nLCBhZGRSZXNwb25zZV8pOwogICAgICB9CiAgICAgIHNpemUgKz0gZ2V0VW5r\nbm93bkZpZWxkcygpLmdldFNlcmlhbGl6ZWRTaXplKCk7CiAgICAgIG1lbW9p\nemVkU2VyaWFsaXplZFNpemUgPSBzaXplOwogICAgICByZXR1cm4gc2l6ZTsK\nICAgIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJp\nYWxWZXJzaW9uVUlEID0gMEw7CiAgICBAamF2YS5sYW5nLk92ZXJyaWRlCiAg\nICBwcm90ZWN0ZWQgamF2YS5sYW5nLk9iamVjdCB3cml0ZVJlcGxhY2UoKQog\nICAgICAgIHRocm93cyBqYXZhLmlvLk9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7\nCiAgICAgIHJldHVybiBzdXBlci53cml0ZVJlcGxhY2UoKTsKICAgIH0KICAg\nIAogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNlIHBhcnNlRnJvbSgKICAg\nICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmcgZGF0YSkKICAg\nICAgICB0aHJvd3MgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9j\nb2xCdWZmZXJFeGNlcHRpb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigp\nLm1lcmdlRnJvbShkYXRhKS5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVi\nbGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLlJlc3BvbnNlIHBhcnNlRnJvbSgKICAgICAgICBjb20u\nZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmcgZGF0YSwKICAgICAgICBjb20u\nZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0ZSBleHRlbnNp\nb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgY29tLmdvb2dsZS5wcm90b2J1\nZi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb24gewogICAgICByZXR1\ncm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShkYXRhLCBleHRlbnNpb25SZWdp\nc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAg\nICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2UgcGFyc2VGcm9tKGJ5dGVbXSBk\nYXRhKQogICAgICAgIHRocm93cyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFs\naWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdC\ndWlsZGVyKCkubWVyZ2VGcm9tKGRhdGEpLmJ1aWxkUGFyc2VkKCk7CiAgICB9\nCiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2UgcGFyc2VGcm9tKAogICAg\nICAgIGJ5dGVbXSBkYXRhLAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYu\nRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAg\nICAgIHRocm93cyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2Nv\nbEJ1ZmZlckV4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCku\nbWVyZ2VGcm9tKGRhdGEsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAg\nICAgICAuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5SZXNwb25zZSBwYXJzZUZyb20oamF2YS5pby5JbnB1dFN0cmVhbSBpbnB1\ndCkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgICAg\nIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGlucHV0KS5idWlsZFBh\ncnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNlIHBh\ncnNlRnJvbSgKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0LAog\nICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlM\naXRlIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlv\nLklPRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJn\nZUZyb20oaW5wdXQsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAgICAg\nICAuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZXNwb25zZSBwYXJzZURlbGltaXRlZEZyb20oamF2YS5pby5JbnB1dFN0cmVh\nbSBpbnB1dCkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7\nCiAgICAgIEJ1aWxkZXIgYnVpbGRlciA9IG5ld0J1aWxkZXIoKTsKICAgICAg\naWYgKGJ1aWxkZXIubWVyZ2VEZWxpbWl0ZWRGcm9tKGlucHV0KSkgewogICAg\nICAgIHJldHVybiBidWlsZGVyLmJ1aWxkUGFyc2VkKCk7CiAgICAgIH0gZWxz\nZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICAgIHB1\nYmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5SZXNwb25zZSBwYXJzZURlbGltaXRlZEZyb20oCiAg\nICAgICAgamF2YS5pby5JbnB1dFN0cmVhbSBpbnB1dCwKICAgICAgICBjb20u\nZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0ZSBleHRlbnNp\nb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlv\nbiB7CiAgICAgIEJ1aWxkZXIgYnVpbGRlciA9IG5ld0J1aWxkZXIoKTsKICAg\nICAgaWYgKGJ1aWxkZXIubWVyZ2VEZWxpbWl0ZWRGcm9tKGlucHV0LCBleHRl\nbnNpb25SZWdpc3RyeSkpIHsKICAgICAgICByZXR1cm4gYnVpbGRlci5idWls\nZFBhcnNlZCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxs\nOwogICAgICB9CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2Ug\ncGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRJ\nbnB1dFN0cmVhbSBpbnB1dCkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4\nY2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9t\nKGlucHV0KS5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRp\nYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3Rv\nY29sLlJlc3BvbnNlIHBhcnNlRnJvbSgKICAgICAgICBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkNvZGVkSW5wdXRTdHJlYW0gaW5wdXQsCiAgICAgICAgY29tLmdv\nb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9u\nUmVnaXN0cnkpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24g\newogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShpbnB1dCwg\nZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5idWlsZFBhcnNl\nZCgpOwogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIEJ1aWxkZXIgbmV3\nQnVpbGRlcigpIHsgcmV0dXJuIEJ1aWxkZXIuY3JlYXRlKCk7IH0KICAgIHB1\nYmxpYyBCdWlsZGVyIG5ld0J1aWxkZXJGb3JUeXBlKCkgeyByZXR1cm4gbmV3\nQnVpbGRlcigpOyB9CiAgICBwdWJsaWMgc3RhdGljIEJ1aWxkZXIgbmV3QnVp\nbGRlcihvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLlJlc3BvbnNlIHByb3RvdHlwZSkgewogICAgICByZXR1cm4gbmV3\nQnVpbGRlcigpLm1lcmdlRnJvbShwcm90b3R5cGUpOwogICAgfQogICAgcHVi\nbGljIEJ1aWxkZXIgdG9CdWlsZGVyKCkgeyByZXR1cm4gbmV3QnVpbGRlcih0\naGlzKTsgfQogICAgCiAgICBAamF2YS5sYW5nLk92ZXJyaWRlCiAgICBwcm90\nZWN0ZWQgQnVpbGRlciBuZXdCdWlsZGVyRm9yVHlwZSgKICAgICAgICBjb20u\nZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuQnVpbGRlclBhcmVu\ndCBwYXJlbnQpIHsKICAgICAgQnVpbGRlciBidWlsZGVyID0gbmV3IEJ1aWxk\nZXIocGFyZW50KTsKICAgICAgcmV0dXJuIGJ1aWxkZXI7CiAgICB9CiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIGNsYXNzIEJ1aWxkZXIgZXh0ZW5kcwogICAg\nICAgIGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJhdGVkTWVzc2FnZS5CdWls\nZGVyPEJ1aWxkZXI+CiAgICAgICBpbXBsZW1lbnRzIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2VPckJ1\naWxkZXIgewogICAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGNvbS5nb29nbGUu\ncHJvdG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRvcgogICAgICAgICAgZ2V0\nRGVzY3JpcHRvcigpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0\naWNfUmVzcG9uc2VfZGVzY3JpcHRvcjsKICAgICAgfQogICAgICAKICAgICAg\ncHJvdGVjdGVkIGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJhdGVkTWVzc2Fn\nZS5GaWVsZEFjY2Vzc29yVGFibGUKICAgICAgICAgIGludGVybmFsR2V0Rmll\nbGRBY2Nlc3NvclRhYmxlKCkgewogICAgICAgIHJldHVybiBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLmludGVybmFs\nX3N0YXRpY19SZXNwb25zZV9maWVsZEFjY2Vzc29yVGFibGU7CiAgICAgIH0K\nICAgICAgCiAgICAgIC8vIENvbnN0cnVjdCB1c2luZyBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNlLm5l\nd0J1aWxkZXIoKQogICAgICBwcml2YXRlIEJ1aWxkZXIoKSB7CiAgICAgICAg\nbWF5YmVGb3JjZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpOwogICAgICB9CiAg\nICAgIAogICAgICBwcml2YXRlIEJ1aWxkZXIoQnVpbGRlclBhcmVudCBwYXJl\nbnQpIHsKICAgICAgICBzdXBlcihwYXJlbnQpOwogICAgICAgIG1heWJlRm9y\nY2VCdWlsZGVySW5pdGlhbGl6YXRpb24oKTsKICAgICAgfQogICAgICBwcml2\nYXRlIHZvaWQgbWF5YmVGb3JjZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpIHsK\nICAgICAgICBpZiAoY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNz\nYWdlLmFsd2F5c1VzZUZpZWxkQnVpbGRlcnMpIHsKICAgICAgICAgIGdldEhl\nYWRlckZpZWxkQnVpbGRlcigpOwogICAgICAgICAgZ2V0UmVhZFJlc3BvbnNl\nRmllbGRCdWlsZGVyKCk7CiAgICAgICAgICBnZXRBZGRSZXNwb25zZUZpZWxk\nQnVpbGRlcigpOwogICAgICAgIH0KICAgICAgfQogICAgICBwcml2YXRlIHN0\nYXRpYyBCdWlsZGVyIGNyZWF0ZSgpIHsKICAgICAgICByZXR1cm4gbmV3IEJ1\naWxkZXIoKTsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIg\nY2xlYXIoKSB7CiAgICAgICAgc3VwZXIuY2xlYXIoKTsKICAgICAgICBpZiAo\naGVhZGVyQnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgaGVhZGVyXyA9\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuQktQYWNrZXRIZWFkZXIuZ2V0RGVmYXVsdEluc3RhbmNlKCk7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgIGhlYWRlckJ1aWxkZXJfLmNsZWFyKCk7\nCiAgICAgICAgfQogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAm\nIH4weDAwMDAwMDAxKTsKICAgICAgICBzdGF0dXNfID0gb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2Rl\nLkVPSzsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgw\nMDAwMDAwMik7CiAgICAgICAgaWYgKHJlYWRSZXNwb25zZUJ1aWxkZXJfID09\nIG51bGwpIHsKICAgICAgICAgIHJlYWRSZXNwb25zZV8gPSBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNw\nb25zZS5nZXREZWZhdWx0SW5zdGFuY2UoKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgcmVhZFJlc3BvbnNlQnVpbGRlcl8uY2xlYXIoKTsKICAgICAg\nICB9CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4MDAw\nMDAwMDQpOwogICAgICAgIGlmIChhZGRSZXNwb25zZUJ1aWxkZXJfID09IG51\nbGwpIHsKICAgICAgICAgIGFkZFJlc3BvbnNlXyA9IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2Uu\nZ2V0RGVmYXVsdEluc3RhbmNlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgIGFkZFJlc3BvbnNlQnVpbGRlcl8uY2xlYXIoKTsKICAgICAgICB9CiAg\nICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4MDAwMDAwMDgp\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIAogICAgICBw\ndWJsaWMgQnVpbGRlciBjbG9uZSgpIHsKICAgICAgICByZXR1cm4gY3JlYXRl\nKCkubWVyZ2VGcm9tKGJ1aWxkUGFydGlhbCgpKTsKICAgICAgfQogICAgICAK\nICAgICAgcHVibGljIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMu\nRGVzY3JpcHRvcgogICAgICAgICAgZ2V0RGVzY3JpcHRvckZvclR5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2UuZ2V0RGVzY3JpcHRvcigpOwog\nICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXNwb25zZSBnZXREZWZh\ndWx0SW5zdGFuY2VGb3JUeXBlKCkgewogICAgICAgIHJldHVybiBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3Bv\nbnNlLmdldERlZmF1bHRJbnN0YW5jZSgpOwogICAgICB9CiAgICAgIAogICAg\nICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5SZXNwb25zZSBidWlsZCgpIHsKICAgICAgICBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3Bv\nbnNlIHJlc3VsdCA9IGJ1aWxkUGFydGlhbCgpOwogICAgICAgIGlmICghcmVz\ndWx0LmlzSW5pdGlhbGl6ZWQoKSkgewogICAgICAgICAgdGhyb3cgbmV3VW5p\nbml0aWFsaXplZE1lc3NhZ2VFeGNlcHRpb24ocmVzdWx0KTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQogICAgICAKICAgICAg\ncHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLlJlc3BvbnNlIGJ1aWxkUGFyc2VkKCkKICAgICAgICAgIHRo\ncm93cyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZl\nckV4Y2VwdGlvbiB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXNwb25zZSByZXN1bHQgPSBidWls\nZFBhcnRpYWwoKTsKICAgICAgICBpZiAoIXJlc3VsdC5pc0luaXRpYWxpemVk\nKCkpIHsKICAgICAgICAgIHRocm93IG5ld1VuaW5pdGlhbGl6ZWRNZXNzYWdl\nRXhjZXB0aW9uKAogICAgICAgICAgICByZXN1bHQpLmFzSW52YWxpZFByb3Rv\nY29sQnVmZmVyRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiByZXN1bHQ7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3Bv\nbnNlIGJ1aWxkUGFydGlhbCgpIHsKICAgICAgICBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNlIHJlc3Vs\ndCA9IG5ldyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLlJlc3BvbnNlKHRoaXMpOwogICAgICAgIGludCBmcm9tX2Jp\ndEZpZWxkMF8gPSBiaXRGaWVsZDBfOwogICAgICAgIGludCB0b19iaXRGaWVs\nZDBfID0gMDsKICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAweDAw\nMDAwMDAxKSA9PSAweDAwMDAwMDAxKSkgewogICAgICAgICAgdG9fYml0Rmll\nbGQwXyB8PSAweDAwMDAwMDAxOwogICAgICAgIH0KICAgICAgICBpZiAoaGVh\nZGVyQnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0LmhlYWRl\ncl8gPSBoZWFkZXJfOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1\nbHQuaGVhZGVyXyA9IGhlYWRlckJ1aWxkZXJfLmJ1aWxkKCk7CiAgICAgICAg\nfQogICAgICAgIGlmICgoKGZyb21fYml0RmllbGQwXyAmIDB4MDAwMDAwMDIp\nID09IDB4MDAwMDAwMDIpKSB7CiAgICAgICAgICB0b19iaXRGaWVsZDBfIHw9\nIDB4MDAwMDAwMDI7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5zdGF0dXNf\nID0gc3RhdHVzXzsKICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAw\neDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAgICAgICAgdG9fYml0\nRmllbGQwXyB8PSAweDAwMDAwMDA0OwogICAgICAgIH0KICAgICAgICBpZiAo\ncmVhZFJlc3BvbnNlQnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgcmVz\ndWx0LnJlYWRSZXNwb25zZV8gPSByZWFkUmVzcG9uc2VfOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICByZXN1bHQucmVhZFJlc3BvbnNlXyA9IHJlYWRS\nZXNwb25zZUJ1aWxkZXJfLmJ1aWxkKCk7CiAgICAgICAgfQogICAgICAgIGlm\nICgoKGZyb21fYml0RmllbGQwXyAmIDB4MDAwMDAwMDgpID09IDB4MDAwMDAw\nMDgpKSB7CiAgICAgICAgICB0b19iaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDg7\nCiAgICAgICAgfQogICAgICAgIGlmIChhZGRSZXNwb25zZUJ1aWxkZXJfID09\nIG51bGwpIHsKICAgICAgICAgIHJlc3VsdC5hZGRSZXNwb25zZV8gPSBhZGRS\nZXNwb25zZV87CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdC5h\nZGRSZXNwb25zZV8gPSBhZGRSZXNwb25zZUJ1aWxkZXJfLmJ1aWxkKCk7CiAg\nICAgICAgfQogICAgICAgIHJlc3VsdC5iaXRGaWVsZDBfID0gdG9fYml0Rmll\nbGQwXzsKICAgICAgICBvbkJ1aWx0KCk7CiAgICAgICAgcmV0dXJuIHJlc3Vs\ndDsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIgbWVyZ2VG\ncm9tKGNvbS5nb29nbGUucHJvdG9idWYuTWVzc2FnZSBvdGhlcikgewogICAg\nICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2UpIHsKICAgICAg\nICAgIHJldHVybiBtZXJnZUZyb20oKG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2Upb3RoZXIpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICBzdXBlci5tZXJnZUZyb20ob3RoZXIp\nOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICB9CiAg\nICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUZyb20ob3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXNwb25z\nZSBvdGhlcikgewogICAgICAgIGlmIChvdGhlciA9PSBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNlLmdl\ndERlZmF1bHRJbnN0YW5jZSgpKSByZXR1cm4gdGhpczsKICAgICAgICBpZiAo\nb3RoZXIuaGFzSGVhZGVyKCkpIHsKICAgICAgICAgIG1lcmdlSGVhZGVyKG90\naGVyLmdldEhlYWRlcigpKTsKICAgICAgICB9CiAgICAgICAgaWYgKG90aGVy\nLmhhc1N0YXR1cygpKSB7CiAgICAgICAgICBzZXRTdGF0dXMob3RoZXIuZ2V0\nU3RhdHVzKCkpOwogICAgICAgIH0KICAgICAgICBpZiAob3RoZXIuaGFzUmVh\nZFJlc3BvbnNlKCkpIHsKICAgICAgICAgIG1lcmdlUmVhZFJlc3BvbnNlKG90\naGVyLmdldFJlYWRSZXNwb25zZSgpKTsKICAgICAgICB9CiAgICAgICAgaWYg\nKG90aGVyLmhhc0FkZFJlc3BvbnNlKCkpIHsKICAgICAgICAgIG1lcmdlQWRk\nUmVzcG9uc2Uob3RoZXIuZ2V0QWRkUmVzcG9uc2UoKSk7CiAgICAgICAgfQog\nICAgICAgIHRoaXMubWVyZ2VVbmtub3duRmllbGRzKG90aGVyLmdldFVua25v\nd25GaWVsZHMoKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAg\nICAgCiAgICAgIHB1YmxpYyBmaW5hbCBib29sZWFuIGlzSW5pdGlhbGl6ZWQo\nKSB7CiAgICAgICAgaWYgKCFoYXNIZWFkZXIoKSkgewogICAgICAgICAgCiAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmICgh\naGFzU3RhdHVzKCkpIHsKICAgICAgICAgIAogICAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIWdldEhlYWRlcigpLmlzSW5p\ndGlhbGl6ZWQoKSkgewogICAgICAgICAgCiAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgfQogICAgICAgIGlmIChoYXNSZWFkUmVzcG9uc2UoKSkg\newogICAgICAgICAgaWYgKCFnZXRSZWFkUmVzcG9uc2UoKS5pc0luaXRpYWxp\nemVkKCkpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGhhc0FkZFJl\nc3BvbnNlKCkpIHsKICAgICAgICAgIGlmICghZ2V0QWRkUmVzcG9uc2UoKS5p\nc0luaXRpYWxpemVkKCkpIHsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVy\nIG1lcmdlRnJvbSgKICAgICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQ29k\nZWRJbnB1dFN0cmVhbSBpbnB1dCwKICAgICAgICAgIGNvbS5nb29nbGUucHJv\ndG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJlZ2lzdHJ5\nKQogICAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAg\nICAgIGNvbS5nb29nbGUucHJvdG9idWYuVW5rbm93bkZpZWxkU2V0LkJ1aWxk\nZXIgdW5rbm93bkZpZWxkcyA9CiAgICAgICAgICBjb20uZ29vZ2xlLnByb3Rv\nYnVmLlVua25vd25GaWVsZFNldC5uZXdCdWlsZGVyKAogICAgICAgICAgICB0\naGlzLmdldFVua25vd25GaWVsZHMoKSk7CiAgICAgICAgd2hpbGUgKHRydWUp\nIHsKICAgICAgICAgIGludCB0YWcgPSBpbnB1dC5yZWFkVGFnKCk7CiAgICAg\nICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICBjYXNlIDA6CiAgICAg\nICAgICAgICAgdGhpcy5zZXRVbmtub3duRmllbGRzKHVua25vd25GaWVsZHMu\nYnVpbGQoKSk7CiAgICAgICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAg\nICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAg\nICAgICAgICAgICBpZiAoIXBhcnNlVW5rbm93bkZpZWxkKGlucHV0LCB1bmtu\nb3duRmllbGRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZXh0ZW5zaW9uUmVnaXN0cnksIHRhZykpIHsKICAgICAgICAgICAgICAg\nIHRoaXMuc2V0VW5rbm93bkZpZWxkcyh1bmtub3duRmllbGRzLmJ1aWxkKCkp\nOwogICAgICAgICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gdGhpczsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAxMDogewog\nICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIuQnVpbGRlciBzdWJCdWls\nZGVyID0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQ\ncm90b2NvbC5CS1BhY2tldEhlYWRlci5uZXdCdWlsZGVyKCk7CiAgICAgICAg\nICAgICAgaWYgKGhhc0hlYWRlcigpKSB7CiAgICAgICAgICAgICAgICBzdWJC\ndWlsZGVyLm1lcmdlRnJvbShnZXRIZWFkZXIoKSk7CiAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgIGlucHV0LnJlYWRNZXNzYWdlKHN1YkJ1aWxkZXIs\nIGV4dGVuc2lvblJlZ2lzdHJ5KTsKICAgICAgICAgICAgICBzZXRIZWFkZXIo\nc3ViQnVpbGRlci5idWlsZFBhcnRpYWwoKSk7CiAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAxNjogewogICAg\nICAgICAgICAgIGludCByYXdWYWx1ZSA9IGlucHV0LnJlYWRFbnVtKCk7CiAg\nICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIHZhbHVlID0gb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2Rl\nLnZhbHVlT2YocmF3VmFsdWUpOwogICAgICAgICAgICAgIGlmICh2YWx1ZSA9\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICB1bmtub3duRmllbGRzLm1lcmdl\nVmFyaW50RmllbGQoMiwgcmF3VmFsdWUpOwogICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDI7\nCiAgICAgICAgICAgICAgICBzdGF0dXNfID0gdmFsdWU7CiAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGNhc2UgODAyOiB7CiAgICAgICAgICAgICAgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9u\nc2UuQnVpbGRlciBzdWJCdWlsZGVyID0gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UubmV3QnVp\nbGRlcigpOwogICAgICAgICAgICAgIGlmIChoYXNSZWFkUmVzcG9uc2UoKSkg\newogICAgICAgICAgICAgICAgc3ViQnVpbGRlci5tZXJnZUZyb20oZ2V0UmVh\nZFJlc3BvbnNlKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBp\nbnB1dC5yZWFkTWVzc2FnZShzdWJCdWlsZGVyLCBleHRlbnNpb25SZWdpc3Ry\neSk7CiAgICAgICAgICAgICAgc2V0UmVhZFJlc3BvbnNlKHN1YkJ1aWxkZXIu\nYnVpbGRQYXJ0aWFsKCkpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGNhc2UgODEwOiB7CiAgICAgICAgICAgICAg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5BZGRSZXNwb25zZS5CdWlsZGVyIHN1YkJ1aWxkZXIgPSBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3Bv\nbnNlLm5ld0J1aWxkZXIoKTsKICAgICAgICAgICAgICBpZiAoaGFzQWRkUmVz\ncG9uc2UoKSkgewogICAgICAgICAgICAgICAgc3ViQnVpbGRlci5tZXJnZUZy\nb20oZ2V0QWRkUmVzcG9uc2UoKSk7CiAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgIGlucHV0LnJlYWRNZXNzYWdlKHN1YkJ1aWxkZXIsIGV4dGVuc2lv\nblJlZ2lzdHJ5KTsKICAgICAgICAgICAgICBzZXRBZGRSZXNwb25zZShzdWJC\ndWlsZGVyLmJ1aWxkUGFydGlhbCgpKTsKICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQog\nICAgICAKICAgICAgcHJpdmF0ZSBpbnQgYml0RmllbGQwXzsKICAgICAgCiAg\nICAgIC8vIHJlcXVpcmVkIC5CS1BhY2tldEhlYWRlciBoZWFkZXIgPSAxOwog\nICAgICBwcml2YXRlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIgaGVhZGVyXyA9IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQ\nYWNrZXRIZWFkZXIuZ2V0RGVmYXVsdEluc3RhbmNlKCk7CiAgICAgIHByaXZh\ndGUgY29tLmdvb2dsZS5wcm90b2J1Zi5TaW5nbGVGaWVsZEJ1aWxkZXI8CiAg\nICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLkJLUGFja2V0SGVhZGVyLCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyLkJ1\naWxkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuQktQYWNrZXRIZWFkZXJPckJ1aWxkZXI+IGhlYWRlckJ1aWxk\nZXJfOwogICAgICBwdWJsaWMgYm9vbGVhbiBoYXNIZWFkZXIoKSB7CiAgICAg\nICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAw\nMDAwMDEpOwogICAgICB9CiAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVy\nIGdldEhlYWRlcigpIHsKICAgICAgICBpZiAoaGVhZGVyQnVpbGRlcl8gPT0g\nbnVsbCkgewogICAgICAgICAgcmV0dXJuIGhlYWRlcl87CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgIHJldHVybiBoZWFkZXJCdWlsZGVyXy5nZXRNZXNz\nYWdlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVy\nIHNldEhlYWRlcihvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyIHZhbHVlKSB7CiAgICAgICAg\naWYgKGhlYWRlckJ1aWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGlmICh2\nYWx1ZSA9PSBudWxsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBOdWxsUG9p\nbnRlckV4Y2VwdGlvbigpOwogICAgICAgICAgfQogICAgICAgICAgaGVhZGVy\nXyA9IHZhbHVlOwogICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgIGhlYWRlckJ1aWxkZXJfLnNldE1lc3NhZ2UodmFs\ndWUpOwogICAgICAgIH0KICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAw\nMDE7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGlj\nIEJ1aWxkZXIgc2V0SGVhZGVyKAogICAgICAgICAgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRl\nci5CdWlsZGVyIGJ1aWxkZXJGb3JWYWx1ZSkgewogICAgICAgIGlmIChoZWFk\nZXJCdWlsZGVyXyA9PSBudWxsKSB7CiAgICAgICAgICBoZWFkZXJfID0gYnVp\nbGRlckZvclZhbHVlLmJ1aWxkKCk7CiAgICAgICAgICBvbkNoYW5nZWQoKTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgaGVhZGVyQnVpbGRlcl8uc2V0\nTWVzc2FnZShidWlsZGVyRm9yVmFsdWUuYnVpbGQoKSk7CiAgICAgICAgfQog\nICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMTsKICAgICAgICByZXR1\ncm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUhl\nYWRlcihvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLkJLUGFja2V0SGVhZGVyIHZhbHVlKSB7CiAgICAgICAgaWYgKGhl\nYWRlckJ1aWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGlmICgoKGJpdEZp\nZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAxKSAmJgogICAgICAg\nICAgICAgIGhlYWRlcl8gIT0gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlci5nZXREZWZhdWx0\nSW5zdGFuY2UoKSkgewogICAgICAgICAgICBoZWFkZXJfID0KICAgICAgICAg\nICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLkJLUGFja2V0SGVhZGVyLm5ld0J1aWxkZXIoaGVhZGVyXykubWVy\nZ2VGcm9tKHZhbHVlKS5idWlsZFBhcnRpYWwoKTsKICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgIGhlYWRlcl8gPSB2YWx1ZTsKICAgICAgICAgIH0K\nICAgICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICBoZWFkZXJCdWlsZGVyXy5tZXJnZUZyb20odmFsdWUpOwogICAgICAg\nIH0KICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDE7CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xl\nYXJIZWFkZXIoKSB7CiAgICAgICAgaWYgKGhlYWRlckJ1aWxkZXJfID09IG51\nbGwpIHsKICAgICAgICAgIGhlYWRlcl8gPSBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVhZGVyLmdl\ndERlZmF1bHRJbnN0YW5jZSgpOwogICAgICAgICAgb25DaGFuZ2VkKCk7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhlYWRlckJ1aWxkZXJfLmNsZWFy\nKCk7CiAgICAgICAgfQogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQw\nXyAmIH4weDAwMDAwMDAxKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAg\nfQogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlci5CdWlsZGVyIGdldEhl\nYWRlckJ1aWxkZXIoKSB7CiAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAw\nMDAxOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJldHVybiBnZXRI\nZWFkZXJGaWVsZEJ1aWxkZXIoKS5nZXRCdWlsZGVyKCk7CiAgICAgIH0KICAg\nICAgcHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXJPckJ1aWxkZXIgZ2V0SGVhZGVy\nT3JCdWlsZGVyKCkgewogICAgICAgIGlmIChoZWFkZXJCdWlsZGVyXyAhPSBu\ndWxsKSB7CiAgICAgICAgICByZXR1cm4gaGVhZGVyQnVpbGRlcl8uZ2V0TWVz\nc2FnZU9yQnVpbGRlcigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBy\nZXR1cm4gaGVhZGVyXzsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHJpdmF0\nZSBjb20uZ29vZ2xlLnByb3RvYnVmLlNpbmdsZUZpZWxkQnVpbGRlcjwKICAg\nICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIuQnVp\nbGRlciwgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQ\ncm90b2NvbC5CS1BhY2tldEhlYWRlck9yQnVpbGRlcj4gCiAgICAgICAgICBn\nZXRIZWFkZXJGaWVsZEJ1aWxkZXIoKSB7CiAgICAgICAgaWYgKGhlYWRlckJ1\naWxkZXJfID09IG51bGwpIHsKICAgICAgICAgIGhlYWRlckJ1aWxkZXJfID0g\nbmV3IGNvbS5nb29nbGUucHJvdG9idWYuU2luZ2xlRmllbGRCdWlsZGVyPAog\nICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIsIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFk\nZXIuQnVpbGRlciwgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5CS1BhY2tldEhlYWRlck9yQnVpbGRlcj4oCiAgICAg\nICAgICAgICAgICAgIGhlYWRlcl8sCiAgICAgICAgICAgICAgICAgIGdldFBh\ncmVudEZvckNoaWxkcmVuKCksCiAgICAgICAgICAgICAgICAgIGlzQ2xlYW4o\nKSk7CiAgICAgICAgICBoZWFkZXJfID0gbnVsbDsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGhlYWRlckJ1aWxkZXJfOwogICAgICB9CiAgICAgIAogICAg\nICAvLyByZXF1aXJlZCAuU3RhdHVzQ29kZSBzdGF0dXMgPSAyOwogICAgICBw\ncml2YXRlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuU3RhdHVzQ29kZSBzdGF0dXNfID0gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlLkVP\nSzsKICAgICAgcHVibGljIGJvb2xlYW4gaGFzU3RhdHVzKCkgewogICAgICAg\nIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAw\nMDAyKTsKICAgICAgfQogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIGdldFN0\nYXR1cygpIHsKICAgICAgICByZXR1cm4gc3RhdHVzXzsKICAgICAgfQogICAg\nICBwdWJsaWMgQnVpbGRlciBzZXRTdGF0dXMob3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIHZhbHVl\nKSB7CiAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHsKICAgICAgICAgIHRo\ncm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigpOwogICAgICAgIH0KICAg\nICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAgICAgc3RhdHVz\nXyA9IHZhbHVlOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJldHVy\nbiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFyU3Rh\ndHVzKCkgewogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4w\neDAwMDAwMDAyKTsKICAgICAgICBzdGF0dXNfID0gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlLkVP\nSzsKICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsK\nICAgICAgfQogICAgICAKICAgICAgLy8gb3B0aW9uYWwgLlJlYWRSZXNwb25z\nZSByZWFkUmVzcG9uc2UgPSAxMDA7CiAgICAgIHByaXZhdGUgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVz\ncG9uc2UgcmVhZFJlc3BvbnNlXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlc3BvbnNlLmdldERlZmF1\nbHRJbnN0YW5jZSgpOwogICAgICBwcml2YXRlIGNvbS5nb29nbGUucHJvdG9i\ndWYuU2luZ2xlRmllbGRCdWlsZGVyPAogICAgICAgICAgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9u\nc2UsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVhZFJlc3BvbnNlLkJ1aWxkZXIsIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlc3BvbnNlT3JC\ndWlsZGVyPiByZWFkUmVzcG9uc2VCdWlsZGVyXzsKICAgICAgcHVibGljIGJv\nb2xlYW4gaGFzUmVhZFJlc3BvbnNlKCkgewogICAgICAgIHJldHVybiAoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KTsKICAgICAg\nfQogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UgZ2V0UmVhZFJlc3BvbnNl\nKCkgewogICAgICAgIGlmIChyZWFkUmVzcG9uc2VCdWlsZGVyXyA9PSBudWxs\nKSB7CiAgICAgICAgICByZXR1cm4gcmVhZFJlc3BvbnNlXzsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgcmV0dXJuIHJlYWRSZXNwb25zZUJ1aWxkZXJf\nLmdldE1lc3NhZ2UoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHVibGlj\nIEJ1aWxkZXIgc2V0UmVhZFJlc3BvbnNlKG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlc3BvbnNlIHZhbHVl\nKSB7CiAgICAgICAgaWYgKHJlYWRSZXNwb25zZUJ1aWxkZXJfID09IG51bGwp\nIHsKICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgICAg\nIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigpOwogICAgICAgICAg\nfQogICAgICAgICAgcmVhZFJlc3BvbnNlXyA9IHZhbHVlOwogICAgICAgICAg\nb25DaGFuZ2VkKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlYWRS\nZXNwb25zZUJ1aWxkZXJfLnNldE1lc3NhZ2UodmFsdWUpOwogICAgICAgIH0K\nICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDQ7CiAgICAgICAgcmV0\ndXJuIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgc2V0UmVh\nZFJlc3BvbnNlKAogICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UuQnVpbGRlciBi\ndWlsZGVyRm9yVmFsdWUpIHsKICAgICAgICBpZiAocmVhZFJlc3BvbnNlQnVp\nbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAgcmVhZFJlc3BvbnNlXyA9IGJ1\naWxkZXJGb3JWYWx1ZS5idWlsZCgpOwogICAgICAgICAgb25DaGFuZ2VkKCk7\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlYWRSZXNwb25zZUJ1aWxk\nZXJfLnNldE1lc3NhZ2UoYnVpbGRlckZvclZhbHVlLmJ1aWxkKCkpOwogICAg\nICAgIH0KICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDQ7CiAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIg\nbWVyZ2VSZWFkUmVzcG9uc2Uob3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UgdmFsdWUpIHsKICAg\nICAgICBpZiAocmVhZFJlc3BvbnNlQnVpbGRlcl8gPT0gbnVsbCkgewogICAg\nICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQpID09IDB4MDAw\nMDAwMDQpICYmCiAgICAgICAgICAgICAgcmVhZFJlc3BvbnNlXyAhPSBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJl\nYWRSZXNwb25zZS5nZXREZWZhdWx0SW5zdGFuY2UoKSkgewogICAgICAgICAg\nICByZWFkUmVzcG9uc2VfID0KICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25z\nZS5uZXdCdWlsZGVyKHJlYWRSZXNwb25zZV8pLm1lcmdlRnJvbSh2YWx1ZSku\nYnVpbGRQYXJ0aWFsKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICByZWFkUmVzcG9uc2VfID0gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAg\nICBvbkNoYW5nZWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVh\nZFJlc3BvbnNlQnVpbGRlcl8ubWVyZ2VGcm9tKHZhbHVlKTsKICAgICAgICB9\nCiAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDA0OwogICAgICAgIHJl\ndHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFy\nUmVhZFJlc3BvbnNlKCkgewogICAgICAgIGlmIChyZWFkUmVzcG9uc2VCdWls\nZGVyXyA9PSBudWxsKSB7CiAgICAgICAgICByZWFkUmVzcG9uc2VfID0gb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZWFkUmVzcG9uc2UuZ2V0RGVmYXVsdEluc3RhbmNlKCk7CiAgICAgICAgICBv\nbkNoYW5nZWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVhZFJl\nc3BvbnNlQnVpbGRlcl8uY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAgYml0\nRmllbGQwXyA9IChiaXRGaWVsZDBfICYgfjB4MDAwMDAwMDQpOwogICAgICAg\nIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNw\nb25zZS5CdWlsZGVyIGdldFJlYWRSZXNwb25zZUJ1aWxkZXIoKSB7CiAgICAg\nICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDA0OwogICAgICAgIG9uQ2hhbmdl\nZCgpOwogICAgICAgIHJldHVybiBnZXRSZWFkUmVzcG9uc2VGaWVsZEJ1aWxk\nZXIoKS5nZXRCdWlsZGVyKCk7CiAgICAgIH0KICAgICAgcHVibGljIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVh\nZFJlc3BvbnNlT3JCdWlsZGVyIGdldFJlYWRSZXNwb25zZU9yQnVpbGRlcigp\nIHsKICAgICAgICBpZiAocmVhZFJlc3BvbnNlQnVpbGRlcl8gIT0gbnVsbCkg\newogICAgICAgICAgcmV0dXJuIHJlYWRSZXNwb25zZUJ1aWxkZXJfLmdldE1l\nc3NhZ2VPckJ1aWxkZXIoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\ncmV0dXJuIHJlYWRSZXNwb25zZV87CiAgICAgICAgfQogICAgICB9CiAgICAg\nIHByaXZhdGUgY29tLmdvb2dsZS5wcm90b2J1Zi5TaW5nbGVGaWVsZEJ1aWxk\nZXI8CiAgICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZSwgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2Uu\nQnVpbGRlciwgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5SZWFkUmVzcG9uc2VPckJ1aWxkZXI+IAogICAgICAgICAg\nZ2V0UmVhZFJlc3BvbnNlRmllbGRCdWlsZGVyKCkgewogICAgICAgIGlmIChy\nZWFkUmVzcG9uc2VCdWlsZGVyXyA9PSBudWxsKSB7CiAgICAgICAgICByZWFk\nUmVzcG9uc2VCdWlsZGVyXyA9IG5ldyBjb20uZ29vZ2xlLnByb3RvYnVmLlNp\nbmdsZUZpZWxkQnVpbGRlcjwKICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25z\nZSwgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90\nb2NvbC5SZWFkUmVzcG9uc2UuQnVpbGRlciwgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2VPckJ1\naWxkZXI+KAogICAgICAgICAgICAgICAgICByZWFkUmVzcG9uc2VfLAogICAg\nICAgICAgICAgICAgICBnZXRQYXJlbnRGb3JDaGlsZHJlbigpLAogICAgICAg\nICAgICAgICAgICBpc0NsZWFuKCkpOwogICAgICAgICAgcmVhZFJlc3BvbnNl\nXyA9IG51bGw7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZWFkUmVzcG9u\nc2VCdWlsZGVyXzsKICAgICAgfQogICAgICAKICAgICAgLy8gb3B0aW9uYWwg\nLkFkZFJlc3BvbnNlIGFkZFJlc3BvbnNlID0gMTAxOwogICAgICBwcml2YXRl\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuQWRkUmVzcG9uc2UgYWRkUmVzcG9uc2VfID0gb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZS5n\nZXREZWZhdWx0SW5zdGFuY2UoKTsKICAgICAgcHJpdmF0ZSBjb20uZ29vZ2xl\nLnByb3RvYnVmLlNpbmdsZUZpZWxkQnVpbGRlcjwKICAgICAgICAgIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRk\nUmVzcG9uc2UsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UuQnVpbGRlciwgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25z\nZU9yQnVpbGRlcj4gYWRkUmVzcG9uc2VCdWlsZGVyXzsKICAgICAgcHVibGlj\nIGJvb2xlYW4gaGFzQWRkUmVzcG9uc2UoKSB7CiAgICAgICAgcmV0dXJuICgo\nYml0RmllbGQwXyAmIDB4MDAwMDAwMDgpID09IDB4MDAwMDAwMDgpOwogICAg\nICB9CiAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3BvbnNlIGdldEFkZFJlc3BvbnNl\nKCkgewogICAgICAgIGlmIChhZGRSZXNwb25zZUJ1aWxkZXJfID09IG51bGwp\nIHsKICAgICAgICAgIHJldHVybiBhZGRSZXNwb25zZV87CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgIHJldHVybiBhZGRSZXNwb25zZUJ1aWxkZXJfLmdl\ndE1lc3NhZ2UoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHVibGljIEJ1\naWxkZXIgc2V0QWRkUmVzcG9uc2Uob3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZSB2YWx1ZSkgewog\nICAgICAgIGlmIChhZGRSZXNwb25zZUJ1aWxkZXJfID09IG51bGwpIHsKICAg\nICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigpOwogICAgICAgICAgfQogICAg\nICAgICAgYWRkUmVzcG9uc2VfID0gdmFsdWU7CiAgICAgICAgICBvbkNoYW5n\nZWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWRkUmVzcG9uc2VC\ndWlsZGVyXy5zZXRNZXNzYWdlKHZhbHVlKTsKICAgICAgICB9CiAgICAgICAg\nYml0RmllbGQwXyB8PSAweDAwMDAwMDA4OwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIHNldEFkZFJlc3BvbnNl\nKAogICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZS5CdWlsZGVyIGJ1aWxkZXJGb3JW\nYWx1ZSkgewogICAgICAgIGlmIChhZGRSZXNwb25zZUJ1aWxkZXJfID09IG51\nbGwpIHsKICAgICAgICAgIGFkZFJlc3BvbnNlXyA9IGJ1aWxkZXJGb3JWYWx1\nZS5idWlsZCgpOwogICAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgIGFkZFJlc3BvbnNlQnVpbGRlcl8uc2V0TWVzc2Fn\nZShidWlsZGVyRm9yVmFsdWUuYnVpbGQoKSk7CiAgICAgICAgfQogICAgICAg\nIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwODsKICAgICAgICByZXR1cm4gdGhp\nczsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUFkZFJlc3Bv\nbnNlKG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuQWRkUmVzcG9uc2UgdmFsdWUpIHsKICAgICAgICBpZiAoYWRkUmVz\ncG9uc2VCdWlsZGVyXyA9PSBudWxsKSB7CiAgICAgICAgICBpZiAoKChiaXRG\naWVsZDBfICYgMHgwMDAwMDAwOCkgPT0gMHgwMDAwMDAwOCkgJiYKICAgICAg\nICAgICAgICBhZGRSZXNwb25zZV8gIT0gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZS5nZXREZWZh\ndWx0SW5zdGFuY2UoKSkgewogICAgICAgICAgICBhZGRSZXNwb25zZV8gPQog\nICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UubmV3QnVpbGRlcihhZGRSZXNw\nb25zZV8pLm1lcmdlRnJvbSh2YWx1ZSkuYnVpbGRQYXJ0aWFsKCk7CiAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICBhZGRSZXNwb25zZV8gPSB2YWx1\nZTsKICAgICAgICAgIH0KICAgICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICBhZGRSZXNwb25zZUJ1aWxkZXJfLm1lcmdl\nRnJvbSh2YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGJpdEZpZWxkMF8gfD0g\nMHgwMDAwMDAwODsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAg\nICBwdWJsaWMgQnVpbGRlciBjbGVhckFkZFJlc3BvbnNlKCkgewogICAgICAg\nIGlmIChhZGRSZXNwb25zZUJ1aWxkZXJfID09IG51bGwpIHsKICAgICAgICAg\nIGFkZFJlc3BvbnNlXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UuZ2V0RGVmYXVsdEluc3Rh\nbmNlKCk7CiAgICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgYWRkUmVzcG9uc2VCdWlsZGVyXy5jbGVhcigpOwogICAg\nICAgIH0KICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgw\nMDAwMDAwOCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAg\ncHVibGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuQWRkUmVzcG9uc2UuQnVpbGRlciBnZXRBZGRSZXNwb25zZUJ1\naWxkZXIoKSB7CiAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDA4Owog\nICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJldHVybiBnZXRBZGRSZXNw\nb25zZUZpZWxkQnVpbGRlcigpLmdldEJ1aWxkZXIoKTsKICAgICAgfQogICAg\nICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5BZGRSZXNwb25zZU9yQnVpbGRlciBnZXRBZGRSZXNwb25z\nZU9yQnVpbGRlcigpIHsKICAgICAgICBpZiAoYWRkUmVzcG9uc2VCdWlsZGVy\nXyAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gYWRkUmVzcG9uc2VCdWls\nZGVyXy5nZXRNZXNzYWdlT3JCdWlsZGVyKCk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgIHJldHVybiBhZGRSZXNwb25zZV87CiAgICAgICAgfQogICAg\nICB9CiAgICAgIHByaXZhdGUgY29tLmdvb2dsZS5wcm90b2J1Zi5TaW5nbGVG\naWVsZEJ1aWxkZXI8CiAgICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3BvbnNlLCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJl\nc3BvbnNlLkJ1aWxkZXIsIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2VPckJ1aWxkZXI+IAogICAg\nICAgICAgZ2V0QWRkUmVzcG9uc2VGaWVsZEJ1aWxkZXIoKSB7CiAgICAgICAg\naWYgKGFkZFJlc3BvbnNlQnVpbGRlcl8gPT0gbnVsbCkgewogICAgICAgICAg\nYWRkUmVzcG9uc2VCdWlsZGVyXyA9IG5ldyBjb20uZ29vZ2xlLnByb3RvYnVm\nLlNpbmdsZUZpZWxkQnVpbGRlcjwKICAgICAgICAgICAgICBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3Bv\nbnNlLCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLkFkZFJlc3BvbnNlLkJ1aWxkZXIsIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2VPckJ1\naWxkZXI+KAogICAgICAgICAgICAgICAgICBhZGRSZXNwb25zZV8sCiAgICAg\nICAgICAgICAgICAgIGdldFBhcmVudEZvckNoaWxkcmVuKCksCiAgICAgICAg\nICAgICAgICAgIGlzQ2xlYW4oKSk7CiAgICAgICAgICBhZGRSZXNwb25zZV8g\nPSBudWxsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYWRkUmVzcG9uc2VC\ndWlsZGVyXzsKICAgICAgfQogICAgICAKICAgICAgLy8gQEBwcm90b2NfaW5z\nZXJ0aW9uX3BvaW50KGJ1aWxkZXJfc2NvcGU6UmVzcG9uc2UpCiAgICB9CiAg\nICAKICAgIHN0YXRpYyB7CiAgICAgIGRlZmF1bHRJbnN0YW5jZSA9IG5ldyBS\nZXNwb25zZSh0cnVlKTsKICAgICAgZGVmYXVsdEluc3RhbmNlLmluaXRGaWVs\nZHMoKTsKICAgIH0KICAgIAogICAgLy8gQEBwcm90b2NfaW5zZXJ0aW9uX3Bv\naW50KGNsYXNzX3Njb3BlOlJlc3BvbnNlKQogIH0KICAKICBwdWJsaWMgaW50\nZXJmYWNlIFJlYWRSZXNwb25zZU9yQnVpbGRlcgogICAgICBleHRlbmRzIGNv\nbS5nb29nbGUucHJvdG9idWYuTWVzc2FnZU9yQnVpbGRlciB7CiAgICAKICAg\nIC8vIHJlcXVpcmVkIC5TdGF0dXNDb2RlIHN0YXR1cyA9IDE7CiAgICBib29s\nZWFuIGhhc1N0YXR1cygpOwogICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIGdldFN0YXR1cygp\nOwogICAgCiAgICAvLyByZXF1aXJlZCBpbnQ2NCBsZWRnZXJJZCA9IDI7CiAg\nICBib29sZWFuIGhhc0xlZGdlcklkKCk7CiAgICBsb25nIGdldExlZGdlcklk\nKCk7CiAgICAKICAgIC8vIHJlcXVpcmVkIGludDY0IGVudHJ5SWQgPSAzOwog\nICAgYm9vbGVhbiBoYXNFbnRyeUlkKCk7CiAgICBsb25nIGdldEVudHJ5SWQo\nKTsKICAgIAogICAgLy8gb3B0aW9uYWwgYnl0ZXMgYm9keSA9IDQ7CiAgICBi\nb29sZWFuIGhhc0JvZHkoKTsKICAgIGNvbS5nb29nbGUucHJvdG9idWYuQnl0\nZVN0cmluZyBnZXRCb2R5KCk7CiAgfQogIHB1YmxpYyBzdGF0aWMgZmluYWwg\nY2xhc3MgUmVhZFJlc3BvbnNlIGV4dGVuZHMKICAgICAgY29tLmdvb2dsZS5w\ncm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlCiAgICAgIGltcGxlbWVudHMgUmVh\nZFJlc3BvbnNlT3JCdWlsZGVyIHsKICAgIC8vIFVzZSBSZWFkUmVzcG9uc2Uu\nbmV3QnVpbGRlcigpIHRvIGNvbnN0cnVjdC4KICAgIHByaXZhdGUgUmVhZFJl\nc3BvbnNlKEJ1aWxkZXIgYnVpbGRlcikgewogICAgICBzdXBlcihidWlsZGVy\nKTsKICAgIH0KICAgIHByaXZhdGUgUmVhZFJlc3BvbnNlKGJvb2xlYW4gbm9J\nbml0KSB7fQogICAgCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBSZWFkUmVz\ncG9uc2UgZGVmYXVsdEluc3RhbmNlOwogICAgcHVibGljIHN0YXRpYyBSZWFk\nUmVzcG9uc2UgZ2V0RGVmYXVsdEluc3RhbmNlKCkgewogICAgICByZXR1cm4g\nZGVmYXVsdEluc3RhbmNlOwogICAgfQogICAgCiAgICBwdWJsaWMgUmVhZFJl\nc3BvbnNlIGdldERlZmF1bHRJbnN0YW5jZUZvclR5cGUoKSB7CiAgICAgIHJl\ndHVybiBkZWZhdWx0SW5zdGFuY2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5E\nZXNjcmlwdG9yCiAgICAgICAgZ2V0RGVzY3JpcHRvcigpIHsKICAgICAgcmV0\ndXJuIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuaW50ZXJuYWxfc3RhdGljX1JlYWRSZXNwb25zZV9kZXNjcmlwdG9y\nOwogICAgfQogICAgCiAgICBwcm90ZWN0ZWQgY29tLmdvb2dsZS5wcm90b2J1\nZi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAgICAg\nIGludGVybmFsR2V0RmllbGRBY2Nlc3NvclRhYmxlKCkgewogICAgICByZXR1\ncm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90\nb2NvbC5pbnRlcm5hbF9zdGF0aWNfUmVhZFJlc3BvbnNlX2ZpZWxkQWNjZXNz\nb3JUYWJsZTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBpbnQgYml0RmllbGQw\nXzsKICAgIC8vIHJlcXVpcmVkIC5TdGF0dXNDb2RlIHN0YXR1cyA9IDE7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBTVEFUVVNfRklFTERfTlVNQkVS\nID0gMTsKICAgIHByaXZhdGUgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIHN0YXR1c187CiAgICBw\ndWJsaWMgYm9vbGVhbiBoYXNTdGF0dXMoKSB7CiAgICAgIHJldHVybiAoKGJp\ndEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAxKTsKICAgIH0K\nICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tl\nZXBlclByb3RvY29sLlN0YXR1c0NvZGUgZ2V0U3RhdHVzKCkgewogICAgICBy\nZXR1cm4gc3RhdHVzXzsKICAgIH0KICAgIAogICAgLy8gcmVxdWlyZWQgaW50\nNjQgbGVkZ2VySWQgPSAyOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQg\nTEVER0VSSURfRklFTERfTlVNQkVSID0gMjsKICAgIHByaXZhdGUgbG9uZyBs\nZWRnZXJJZF87CiAgICBwdWJsaWMgYm9vbGVhbiBoYXNMZWRnZXJJZCgpIHsK\nICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4\nMDAwMDAwMDIpOwogICAgfQogICAgcHVibGljIGxvbmcgZ2V0TGVkZ2VySWQo\nKSB7CiAgICAgIHJldHVybiBsZWRnZXJJZF87CiAgICB9CiAgICAKICAgIC8v\nIHJlcXVpcmVkIGludDY0IGVudHJ5SWQgPSAzOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBpbnQgRU5UUllJRF9GSUVMRF9OVU1CRVIgPSAzOwogICAgcHJp\ndmF0ZSBsb25nIGVudHJ5SWRfOwogICAgcHVibGljIGJvb2xlYW4gaGFzRW50\ncnlJZCgpIHsKICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAw\nMDQpID09IDB4MDAwMDAwMDQpOwogICAgfQogICAgcHVibGljIGxvbmcgZ2V0\nRW50cnlJZCgpIHsKICAgICAgcmV0dXJuIGVudHJ5SWRfOwogICAgfQogICAg\nCiAgICAvLyBvcHRpb25hbCBieXRlcyBib2R5ID0gNDsKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgaW50IEJPRFlfRklFTERfTlVNQkVSID0gNDsKICAgIHBy\naXZhdGUgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nIGJvZHlfOwog\nICAgcHVibGljIGJvb2xlYW4gaGFzQm9keSgpIHsKICAgICAgcmV0dXJuICgo\nYml0RmllbGQwXyAmIDB4MDAwMDAwMDgpID09IDB4MDAwMDAwMDgpOwogICAg\nfQogICAgcHVibGljIGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZyBn\nZXRCb2R5KCkgewogICAgICByZXR1cm4gYm9keV87CiAgICB9CiAgICAKICAg\nIHByaXZhdGUgdm9pZCBpbml0RmllbGRzKCkgewogICAgICBzdGF0dXNfID0g\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5TdGF0dXNDb2RlLkVPSzsKICAgICAgbGVkZ2VySWRfID0gMEw7CiAgICAg\nIGVudHJ5SWRfID0gMEw7CiAgICAgIGJvZHlfID0gY29tLmdvb2dsZS5wcm90\nb2J1Zi5CeXRlU3RyaW5nLkVNUFRZOwogICAgfQogICAgcHJpdmF0ZSBieXRl\nIG1lbW9pemVkSXNJbml0aWFsaXplZCA9IC0xOwogICAgcHVibGljIGZpbmFs\nIGJvb2xlYW4gaXNJbml0aWFsaXplZCgpIHsKICAgICAgYnl0ZSBpc0luaXRp\nYWxpemVkID0gbWVtb2l6ZWRJc0luaXRpYWxpemVkOwogICAgICBpZiAoaXNJ\nbml0aWFsaXplZCAhPSAtMSkgcmV0dXJuIGlzSW5pdGlhbGl6ZWQgPT0gMTsK\nICAgICAgCiAgICAgIGlmICghaGFzU3RhdHVzKCkpIHsKICAgICAgICBtZW1v\naXplZElzSW5pdGlhbGl6ZWQgPSAwOwogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgfQogICAgICBpZiAoIWhhc0xlZGdlcklkKCkpIHsKICAgICAgICBt\nZW1vaXplZElzSW5pdGlhbGl6ZWQgPSAwOwogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgfQogICAgICBpZiAoIWhhc0VudHJ5SWQoKSkgewogICAgICAg\nIG1lbW9pemVkSXNJbml0aWFsaXplZCA9IDA7CiAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICB9CiAgICAgIG1lbW9pemVkSXNJbml0aWFsaXplZCA9IDE7\nCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9p\nZCB3cml0ZVRvKGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRPdXRwdXRTdHJl\nYW0gb3V0cHV0KQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvd3MgamF2\nYS5pby5JT0V4Y2VwdGlvbiB7CiAgICAgIGdldFNlcmlhbGl6ZWRTaXplKCk7\nCiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAw\nMDAwMDAxKSkgewogICAgICAgIG91dHB1dC53cml0ZUVudW0oMSwgc3RhdHVz\nXy5nZXROdW1iZXIoKSk7CiAgICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQw\nXyAmIDB4MDAwMDAwMDIpID09IDB4MDAwMDAwMDIpKSB7CiAgICAgICAgb3V0\ncHV0LndyaXRlSW50NjQoMiwgbGVkZ2VySWRfKTsKICAgICAgfQogICAgICBp\nZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwNCkgPT0gMHgwMDAwMDAwNCkp\nIHsKICAgICAgICBvdXRwdXQud3JpdGVJbnQ2NCgzLCBlbnRyeUlkXyk7CiAg\nICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDgpID09\nIDB4MDAwMDAwMDgpKSB7CiAgICAgICAgb3V0cHV0LndyaXRlQnl0ZXMoNCwg\nYm9keV8pOwogICAgICB9CiAgICAgIGdldFVua25vd25GaWVsZHMoKS53cml0\nZVRvKG91dHB1dCk7CiAgICB9CiAgICAKICAgIHByaXZhdGUgaW50IG1lbW9p\nemVkU2VyaWFsaXplZFNpemUgPSAtMTsKICAgIHB1YmxpYyBpbnQgZ2V0U2Vy\naWFsaXplZFNpemUoKSB7CiAgICAgIGludCBzaXplID0gbWVtb2l6ZWRTZXJp\nYWxpemVkU2l6ZTsKICAgICAgaWYgKHNpemUgIT0gLTEpIHJldHVybiBzaXpl\nOwogICAgCiAgICAgIHNpemUgPSAwOwogICAgICBpZiAoKChiaXRGaWVsZDBf\nICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAwMDAwMSkpIHsKICAgICAgICBzaXpl\nICs9IGNvbS5nb29nbGUucHJvdG9idWYuQ29kZWRPdXRwdXRTdHJlYW0KICAg\nICAgICAgIC5jb21wdXRlRW51bVNpemUoMSwgc3RhdHVzXy5nZXROdW1iZXIo\nKSk7CiAgICAgIH0KICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAw\nMDIpID09IDB4MDAwMDAwMDIpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29v\nZ2xlLnByb3RvYnVmLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29t\ncHV0ZUludDY0U2l6ZSgyLCBsZWRnZXJJZF8pOwogICAgICB9CiAgICAgIGlm\nICgoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkg\newogICAgICAgIHNpemUgKz0gY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91\ndHB1dFN0cmVhbQogICAgICAgICAgLmNvbXB1dGVJbnQ2NFNpemUoMywgZW50\ncnlJZF8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxkMF8gJiAweDAw\nMDAwMDA4KSA9PSAweDAwMDAwMDA4KSkgewogICAgICAgIHNpemUgKz0gY29t\nLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0cmVhbQogICAgICAgICAg\nLmNvbXB1dGVCeXRlc1NpemUoNCwgYm9keV8pOwogICAgICB9CiAgICAgIHNp\nemUgKz0gZ2V0VW5rbm93bkZpZWxkcygpLmdldFNlcmlhbGl6ZWRTaXplKCk7\nCiAgICAgIG1lbW9pemVkU2VyaWFsaXplZFNpemUgPSBzaXplOwogICAgICBy\nZXR1cm4gc2l6ZTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEID0gMEw7CiAgICBAamF2YS5sYW5n\nLk92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgamF2YS5sYW5nLk9iamVjdCB3cml0\nZVJlcGxhY2UoKQogICAgICAgIHRocm93cyBqYXZhLmlvLk9iamVjdFN0cmVh\nbUV4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBzdXBlci53cml0ZVJlcGxhY2Uo\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25z\nZSBwYXJzZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRl\nU3RyaW5nIGRhdGEpCiAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUucHJvdG9i\ndWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAgICAgcmV0\ndXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oZGF0YSkuYnVpbGRQYXJzZWQo\nKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UgcGFy\nc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmlu\nZyBkYXRhLAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9u\nUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93\ncyBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4\nY2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9t\nKGRhdGEsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAgICAgICAuYnVp\nbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVz\ncG9uc2UgcGFyc2VGcm9tKGJ5dGVbXSBkYXRhKQogICAgICAgIHRocm93cyBj\nb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2Vw\ndGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGRh\ndGEpLmJ1aWxkUGFyc2VkKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wu\nUmVhZFJlc3BvbnNlIHBhcnNlRnJvbSgKICAgICAgICBieXRlW10gZGF0YSwK\nICAgICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5\nTGl0ZSBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgY29tLmdv\nb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb24g\newogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShkYXRhLCBl\neHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFyc2Vk\nKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlc3BvbnNlIHBh\ncnNlRnJvbShqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0KQogICAgICAgIHRo\ncm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1\naWxkZXIoKS5tZXJnZUZyb20oaW5wdXQpLmJ1aWxkUGFyc2VkKCk7CiAgICB9\nCiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90\nby5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlc3BvbnNlIHBhcnNlRnJvbSgK\nICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0LAogICAgICAgIGNv\nbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVu\nc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0\naW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oaW5w\ndXQsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAgICAgICAuYnVpbGRQ\nYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9u\nc2UgcGFyc2VEZWxpbWl0ZWRGcm9tKGphdmEuaW8uSW5wdXRTdHJlYW0gaW5w\ndXQpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAg\nICBCdWlsZGVyIGJ1aWxkZXIgPSBuZXdCdWlsZGVyKCk7CiAgICAgIGlmIChi\ndWlsZGVyLm1lcmdlRGVsaW1pdGVkRnJvbShpbnB1dCkpIHsKICAgICAgICBy\nZXR1cm4gYnVpbGRlci5idWlsZFBhcnNlZCgpOwogICAgICB9IGVsc2Ugewog\nICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgICBwdWJsaWMg\nc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuUmVhZFJlc3BvbnNlIHBhcnNlRGVsaW1pdGVkRnJvbSgKICAg\nICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGlucHV0LAogICAgICAgIGNvbS5n\nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVuc2lv\nblJlZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9u\nIHsKICAgICAgQnVpbGRlciBidWlsZGVyID0gbmV3QnVpbGRlcigpOwogICAg\nICBpZiAoYnVpbGRlci5tZXJnZURlbGltaXRlZEZyb20oaW5wdXQsIGV4dGVu\nc2lvblJlZ2lzdHJ5KSkgewogICAgICAgIHJldHVybiBidWlsZGVyLmJ1aWxk\nUGFyc2VkKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgIH0KICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9u\nc2UgcGFyc2VGcm9tKAogICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuQ29k\nZWRJbnB1dFN0cmVhbSBpbnB1dCkKICAgICAgICB0aHJvd3MgamF2YS5pby5J\nT0V4Y2VwdGlvbiB7CiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VG\ncm9tKGlucHV0KS5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0\nYXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLlJlYWRSZXNwb25zZSBwYXJzZUZyb20oCiAgICAgICAgY29tLmdv\nb2dsZS5wcm90b2J1Zi5Db2RlZElucHV0U3RyZWFtIGlucHV0LAogICAgICAg\nIGNvbS5nb29nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4\ndGVuc2lvblJlZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhj\nZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20o\naW5wdXQsIGV4dGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAgICAgICAuYnVp\nbGRQYXJzZWQoKTsKICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBCdWls\nZGVyIG5ld0J1aWxkZXIoKSB7IHJldHVybiBCdWlsZGVyLmNyZWF0ZSgpOyB9\nCiAgICBwdWJsaWMgQnVpbGRlciBuZXdCdWlsZGVyRm9yVHlwZSgpIHsgcmV0\ndXJuIG5ld0J1aWxkZXIoKTsgfQogICAgcHVibGljIHN0YXRpYyBCdWlsZGVy\nIG5ld0J1aWxkZXIob3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UgcHJvdG90eXBlKSB7CiAgICAg\nIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKHByb3RvdHlwZSk7CiAg\nICB9CiAgICBwdWJsaWMgQnVpbGRlciB0b0J1aWxkZXIoKSB7IHJldHVybiBu\nZXdCdWlsZGVyKHRoaXMpOyB9CiAgICAKICAgIEBqYXZhLmxhbmcuT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCBCdWlsZGVyIG5ld0J1aWxkZXJGb3JUeXBlKAog\nICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJhdGVkTWVzc2FnZS5C\ndWlsZGVyUGFyZW50IHBhcmVudCkgewogICAgICBCdWlsZGVyIGJ1aWxkZXIg\nPSBuZXcgQnVpbGRlcihwYXJlbnQpOwogICAgICByZXR1cm4gYnVpbGRlcjsK\nICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgY2xhc3MgQnVpbGRlciBl\neHRlbmRzCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRN\nZXNzYWdlLkJ1aWxkZXI8QnVpbGRlcj4KICAgICAgIGltcGxlbWVudHMgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZWFkUmVzcG9uc2VPckJ1aWxkZXIgewogICAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRv\ncgogICAgICAgICAgZ2V0RGVzY3JpcHRvcigpIHsKICAgICAgICByZXR1cm4g\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2Nv\nbC5pbnRlcm5hbF9zdGF0aWNfUmVhZFJlc3BvbnNlX2Rlc2NyaXB0b3I7CiAg\nICAgIH0KICAgICAgCiAgICAgIHByb3RlY3RlZCBjb20uZ29vZ2xlLnByb3Rv\nYnVmLkdlbmVyYXRlZE1lc3NhZ2UuRmllbGRBY2Nlc3NvclRhYmxlCiAgICAg\nICAgICBpbnRlcm5hbEdldEZpZWxkQWNjZXNzb3JUYWJsZSgpIHsKICAgICAg\nICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5pbnRlcm5hbF9zdGF0aWNfUmVhZFJlc3BvbnNlX2ZpZWxk\nQWNjZXNzb3JUYWJsZTsKICAgICAgfQogICAgICAKICAgICAgLy8gQ29uc3Ry\ndWN0IHVzaW5nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuUmVhZFJlc3BvbnNlLm5ld0J1aWxkZXIoKQogICAgICBw\ncml2YXRlIEJ1aWxkZXIoKSB7CiAgICAgICAgbWF5YmVGb3JjZUJ1aWxkZXJJ\nbml0aWFsaXphdGlvbigpOwogICAgICB9CiAgICAgIAogICAgICBwcml2YXRl\nIEJ1aWxkZXIoQnVpbGRlclBhcmVudCBwYXJlbnQpIHsKICAgICAgICBzdXBl\ncihwYXJlbnQpOwogICAgICAgIG1heWJlRm9yY2VCdWlsZGVySW5pdGlhbGl6\nYXRpb24oKTsKICAgICAgfQogICAgICBwcml2YXRlIHZvaWQgbWF5YmVGb3Jj\nZUJ1aWxkZXJJbml0aWFsaXphdGlvbigpIHsKICAgICAgICBpZiAoY29tLmdv\nb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLmFsd2F5c1VzZUZpZWxk\nQnVpbGRlcnMpIHsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHJpdmF0ZSBz\ndGF0aWMgQnVpbGRlciBjcmVhdGUoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBC\ndWlsZGVyKCk7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVy\nIGNsZWFyKCkgewogICAgICAgIHN1cGVyLmNsZWFyKCk7CiAgICAgICAgc3Rh\ndHVzXyA9IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVy\nUHJvdG9jb2wuU3RhdHVzQ29kZS5FT0s7CiAgICAgICAgYml0RmllbGQwXyA9\nIChiaXRGaWVsZDBfICYgfjB4MDAwMDAwMDEpOwogICAgICAgIGxlZGdlcklk\nXyA9IDBMOwogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4w\neDAwMDAwMDAyKTsKICAgICAgICBlbnRyeUlkXyA9IDBMOwogICAgICAgIGJp\ndEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDA0KTsKICAgICAg\nICBib2R5XyA9IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZy5FTVBU\nWTsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAw\nMDAwOCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAg\nICAgIHB1YmxpYyBCdWlsZGVyIGNsb25lKCkgewogICAgICAgIHJldHVybiBj\ncmVhdGUoKS5tZXJnZUZyb20oYnVpbGRQYXJ0aWFsKCkpOwogICAgICB9CiAg\nICAgIAogICAgICBwdWJsaWMgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlw\ndG9ycy5EZXNjcmlwdG9yCiAgICAgICAgICBnZXREZXNjcmlwdG9yRm9yVHlw\nZSgpIHsKICAgICAgICByZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UuZ2V0RGVzY3Jp\ncHRvcigpOwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVz\ncG9uc2UgZ2V0RGVmYXVsdEluc3RhbmNlRm9yVHlwZSgpIHsKICAgICAgICBy\nZXR1cm4gb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQ\ncm90b2NvbC5SZWFkUmVzcG9uc2UuZ2V0RGVmYXVsdEluc3RhbmNlKCk7CiAg\nICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZSBidWls\nZCgpIHsKICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZSByZXN1bHQgPSBidWlsZFBh\ncnRpYWwoKTsKICAgICAgICBpZiAoIXJlc3VsdC5pc0luaXRpYWxpemVkKCkp\nIHsKICAgICAgICAgIHRocm93IG5ld1VuaW5pdGlhbGl6ZWRNZXNzYWdlRXhj\nZXB0aW9uKHJlc3VsdCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1\nbHQ7CiAgICAgIH0KICAgICAgCiAgICAgIHByaXZhdGUgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9u\nc2UgYnVpbGRQYXJzZWQoKQogICAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUu\ncHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAg\nICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclBy\nb3RvY29sLlJlYWRSZXNwb25zZSByZXN1bHQgPSBidWlsZFBhcnRpYWwoKTsK\nICAgICAgICBpZiAoIXJlc3VsdC5pc0luaXRpYWxpemVkKCkpIHsKICAgICAg\nICAgIHRocm93IG5ld1VuaW5pdGlhbGl6ZWRNZXNzYWdlRXhjZXB0aW9uKAog\nICAgICAgICAgICByZXN1bHQpLmFzSW52YWxpZFByb3RvY29sQnVmZmVyRXhj\nZXB0aW9uKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAg\nICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZSBidWls\nZFBhcnRpYWwoKSB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2UgcmVzdWx0ID0g\nbmV3IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVhZFJlc3BvbnNlKHRoaXMpOwogICAgICAgIGludCBmcm9tX2Jp\ndEZpZWxkMF8gPSBiaXRGaWVsZDBfOwogICAgICAgIGludCB0b19iaXRGaWVs\nZDBfID0gMDsKICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAweDAw\nMDAwMDAxKSA9PSAweDAwMDAwMDAxKSkgewogICAgICAgICAgdG9fYml0Rmll\nbGQwXyB8PSAweDAwMDAwMDAxOwogICAgICAgIH0KICAgICAgICByZXN1bHQu\nc3RhdHVzXyA9IHN0YXR1c187CiAgICAgICAgaWYgKCgoZnJvbV9iaXRGaWVs\nZDBfICYgMHgwMDAwMDAwMikgPT0gMHgwMDAwMDAwMikpIHsKICAgICAgICAg\nIHRvX2JpdEZpZWxkMF8gfD0gMHgwMDAwMDAwMjsKICAgICAgICB9CiAgICAg\nICAgcmVzdWx0LmxlZGdlcklkXyA9IGxlZGdlcklkXzsKICAgICAgICBpZiAo\nKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0\nKSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAweDAwMDAwMDA0Owog\nICAgICAgIH0KICAgICAgICByZXN1bHQuZW50cnlJZF8gPSBlbnRyeUlkXzsK\nICAgICAgICBpZiAoKChmcm9tX2JpdEZpZWxkMF8gJiAweDAwMDAwMDA4KSA9\nPSAweDAwMDAwMDA4KSkgewogICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAw\neDAwMDAwMDA4OwogICAgICAgIH0KICAgICAgICByZXN1bHQuYm9keV8gPSBi\nb2R5XzsKICAgICAgICByZXN1bHQuYml0RmllbGQwXyA9IHRvX2JpdEZpZWxk\nMF87CiAgICAgICAgb25CdWlsdCgpOwogICAgICAgIHJldHVybiByZXN1bHQ7\nCiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVyIG1lcmdlRnJv\nbShjb20uZ29vZ2xlLnByb3RvYnVmLk1lc3NhZ2Ugb3RoZXIpIHsKICAgICAg\nICBpZiAob3RoZXIgaW5zdGFuY2VvZiBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZSkgewogICAg\nICAgICAgcmV0dXJuIG1lcmdlRnJvbSgob3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVzcG9uc2Upb3RoZXIp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdXBlci5tZXJnZUZyb20o\nb3RoZXIpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAg\nICB9CiAgICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUZyb20ob3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZWFkUmVzcG9uc2Ugb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5S\nZWFkUmVzcG9uc2UuZ2V0RGVmYXVsdEluc3RhbmNlKCkpIHJldHVybiB0aGlz\nOwogICAgICAgIGlmIChvdGhlci5oYXNTdGF0dXMoKSkgewogICAgICAgICAg\nc2V0U3RhdHVzKG90aGVyLmdldFN0YXR1cygpKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKG90aGVyLmhhc0xlZGdlcklkKCkpIHsKICAgICAgICAgIHNldExl\nZGdlcklkKG90aGVyLmdldExlZGdlcklkKCkpOwogICAgICAgIH0KICAgICAg\nICBpZiAob3RoZXIuaGFzRW50cnlJZCgpKSB7CiAgICAgICAgICBzZXRFbnRy\neUlkKG90aGVyLmdldEVudHJ5SWQoKSk7CiAgICAgICAgfQogICAgICAgIGlm\nIChvdGhlci5oYXNCb2R5KCkpIHsKICAgICAgICAgIHNldEJvZHkob3RoZXIu\nZ2V0Qm9keSgpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5tZXJnZVVua25v\nd25GaWVsZHMob3RoZXIuZ2V0VW5rbm93bkZpZWxkcygpKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIGZpbmFs\nIGJvb2xlYW4gaXNJbml0aWFsaXplZCgpIHsKICAgICAgICBpZiAoIWhhc1N0\nYXR1cygpKSB7CiAgICAgICAgICAKICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICB9CiAgICAgICAgaWYgKCFoYXNMZWRnZXJJZCgpKSB7CiAgICAg\nICAgICAKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAg\nICAgaWYgKCFoYXNFbnRyeUlkKCkpIHsKICAgICAgICAgIAogICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIgbWVyZ2VGcm9t\nKAogICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZElucHV0U3Ry\nZWFtIGlucHV0LAogICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRl\nbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAg\nICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgICAgICAgY29tLmdv\nb2dsZS5wcm90b2J1Zi5Vbmtub3duRmllbGRTZXQuQnVpbGRlciB1bmtub3du\nRmllbGRzID0KICAgICAgICAgIGNvbS5nb29nbGUucHJvdG9idWYuVW5rbm93\nbkZpZWxkU2V0Lm5ld0J1aWxkZXIoCiAgICAgICAgICAgIHRoaXMuZ2V0VW5r\nbm93bkZpZWxkcygpKTsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAg\nICAgaW50IHRhZyA9IGlucHV0LnJlYWRUYWcoKTsKICAgICAgICAgIHN3aXRj\naCAodGFnKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB0\naGlzLnNldFVua25vd25GaWVsZHModW5rbm93bkZpZWxkcy5idWlsZCgpKTsK\nICAgICAgICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICAgICAgICByZXR1\ncm4gdGhpczsKICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAg\nIGlmICghcGFyc2VVbmtub3duRmllbGQoaW5wdXQsIHVua25vd25GaWVsZHMs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlbnNp\nb25SZWdpc3RyeSwgdGFnKSkgewogICAgICAgICAgICAgICAgdGhpcy5zZXRV\nbmtub3duRmllbGRzKHVua25vd25GaWVsZHMuYnVpbGQoKSk7CiAgICAgICAg\nICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICAgICAgICAgIHJldHVybiB0\naGlzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgfQogICAgICAgICAgICBjYXNlIDg6IHsKICAgICAgICAgICAg\nICBpbnQgcmF3VmFsdWUgPSBpbnB1dC5yZWFkRW51bSgpOwogICAgICAgICAg\nICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuU3RhdHVzQ29kZSB2YWx1ZSA9IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuU3RhdHVzQ29kZS52YWx1ZU9m\nKHJhd1ZhbHVlKTsKICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkg\newogICAgICAgICAgICAgICAgdW5rbm93bkZpZWxkcy5tZXJnZVZhcmludEZp\nZWxkKDEsIHJhd1ZhbHVlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDAxOwogICAgICAg\nICAgICAgICAgc3RhdHVzXyA9IHZhbHVlOwogICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBj\nYXNlIDE2OiB7CiAgICAgICAgICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAw\nMDAyOwogICAgICAgICAgICAgIGxlZGdlcklkXyA9IGlucHV0LnJlYWRJbnQ2\nNCgpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGNhc2UgMjQ6IHsKICAgICAgICAgICAgICBiaXRGaWVsZDBfIHw9\nIDB4MDAwMDAwMDQ7CiAgICAgICAgICAgICAgZW50cnlJZF8gPSBpbnB1dC5y\nZWFkSW50NjQoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBjYXNlIDM0OiB7CiAgICAgICAgICAgICAgYml0Rmll\nbGQwXyB8PSAweDAwMDAwMDA4OwogICAgICAgICAgICAgIGJvZHlfID0gaW5w\ndXQucmVhZEJ5dGVzKCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgCiAg\nICAgIHByaXZhdGUgaW50IGJpdEZpZWxkMF87CiAgICAgIAogICAgICAvLyBy\nZXF1aXJlZCAuU3RhdHVzQ29kZSBzdGF0dXMgPSAxOwogICAgICBwcml2YXRl\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuU3RhdHVzQ29kZSBzdGF0dXNfID0gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlLkVPSzsKICAg\nICAgcHVibGljIGJvb2xlYW4gaGFzU3RhdHVzKCkgewogICAgICAgIHJldHVy\nbiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAxKSA9PSAweDAwMDAwMDAxKTsK\nICAgICAgfQogICAgICBwdWJsaWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIGdldFN0YXR1cygp\nIHsKICAgICAgICByZXR1cm4gc3RhdHVzXzsKICAgICAgfQogICAgICBwdWJs\naWMgQnVpbGRlciBzZXRTdGF0dXMob3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIHZhbHVlKSB7CiAg\nICAgICAgaWYgKHZhbHVlID09IG51bGwpIHsKICAgICAgICAgIHRocm93IG5l\ndyBOdWxsUG9pbnRlckV4Y2VwdGlvbigpOwogICAgICAgIH0KICAgICAgICBi\naXRGaWVsZDBfIHw9IDB4MDAwMDAwMDE7CiAgICAgICAgc3RhdHVzXyA9IHZh\nbHVlOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsZWFyU3RhdHVzKCkg\newogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAw\nMDAxKTsKICAgICAgICBzdGF0dXNfID0gb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlLkVPSzsKICAg\nICAgICBvbkNoYW5nZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAg\nfQogICAgICAKICAgICAgLy8gcmVxdWlyZWQgaW50NjQgbGVkZ2VySWQgPSAy\nOwogICAgICBwcml2YXRlIGxvbmcgbGVkZ2VySWRfIDsKICAgICAgcHVibGlj\nIGJvb2xlYW4gaGFzTGVkZ2VySWQoKSB7CiAgICAgICAgcmV0dXJuICgoYml0\nRmllbGQwXyAmIDB4MDAwMDAwMDIpID09IDB4MDAwMDAwMDIpOwogICAgICB9\nCiAgICAgIHB1YmxpYyBsb25nIGdldExlZGdlcklkKCkgewogICAgICAgIHJl\ndHVybiBsZWRnZXJJZF87CiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIg\nc2V0TGVkZ2VySWQobG9uZyB2YWx1ZSkgewogICAgICAgIGJpdEZpZWxkMF8g\nfD0gMHgwMDAwMDAwMjsKICAgICAgICBsZWRnZXJJZF8gPSB2YWx1ZTsKICAg\nICAgICBvbkNoYW5nZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAg\nfQogICAgICBwdWJsaWMgQnVpbGRlciBjbGVhckxlZGdlcklkKCkgewogICAg\nICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAmIH4weDAwMDAwMDAyKTsK\nICAgICAgICBsZWRnZXJJZF8gPSAwTDsKICAgICAgICBvbkNoYW5nZWQoKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICAKICAgICAgLy8g\ncmVxdWlyZWQgaW50NjQgZW50cnlJZCA9IDM7CiAgICAgIHByaXZhdGUgbG9u\nZyBlbnRyeUlkXyA7CiAgICAgIHB1YmxpYyBib29sZWFuIGhhc0VudHJ5SWQo\nKSB7CiAgICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDQp\nID09IDB4MDAwMDAwMDQpOwogICAgICB9CiAgICAgIHB1YmxpYyBsb25nIGdl\ndEVudHJ5SWQoKSB7CiAgICAgICAgcmV0dXJuIGVudHJ5SWRfOwogICAgICB9\nCiAgICAgIHB1YmxpYyBCdWlsZGVyIHNldEVudHJ5SWQobG9uZyB2YWx1ZSkg\newogICAgICAgIGJpdEZpZWxkMF8gfD0gMHgwMDAwMDAwNDsKICAgICAgICBl\nbnRyeUlkXyA9IHZhbHVlOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAg\nIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIGNs\nZWFyRW50cnlJZCgpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxk\nMF8gJiB+MHgwMDAwMDAwNCk7CiAgICAgICAgZW50cnlJZF8gPSAwTDsKICAg\nICAgICBvbkNoYW5nZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAg\nfQogICAgICAKICAgICAgLy8gb3B0aW9uYWwgYnl0ZXMgYm9keSA9IDQ7CiAg\nICAgIHByaXZhdGUgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nIGJv\nZHlfID0gY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nLkVNUFRZOwog\nICAgICBwdWJsaWMgYm9vbGVhbiBoYXNCb2R5KCkgewogICAgICAgIHJldHVy\nbiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDA4KSA9PSAweDAwMDAwMDA4KTsK\nICAgICAgfQogICAgICBwdWJsaWMgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRl\nU3RyaW5nIGdldEJvZHkoKSB7CiAgICAgICAgcmV0dXJuIGJvZHlfOwogICAg\nICB9CiAgICAgIHB1YmxpYyBCdWlsZGVyIHNldEJvZHkoY29tLmdvb2dsZS5w\ncm90b2J1Zi5CeXRlU3RyaW5nIHZhbHVlKSB7CiAgICAgICAgaWYgKHZhbHVl\nID09IG51bGwpIHsKICAgIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlv\nbigpOwogIH0KICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDg7CiAgICAgICAg\nYm9keV8gPSB2YWx1ZTsKICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBjbGVh\nckJvZHkoKSB7CiAgICAgICAgYml0RmllbGQwXyA9IChiaXRGaWVsZDBfICYg\nfjB4MDAwMDAwMDgpOwogICAgICAgIGJvZHlfID0gZ2V0RGVmYXVsdEluc3Rh\nbmNlKCkuZ2V0Qm9keSgpOwogICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAg\nIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIAogICAgICAvLyBAQHByb3Rv\nY19pbnNlcnRpb25fcG9pbnQoYnVpbGRlcl9zY29wZTpSZWFkUmVzcG9uc2Up\nCiAgICB9CiAgICAKICAgIHN0YXRpYyB7CiAgICAgIGRlZmF1bHRJbnN0YW5j\nZSA9IG5ldyBSZWFkUmVzcG9uc2UodHJ1ZSk7CiAgICAgIGRlZmF1bHRJbnN0\nYW5jZS5pbml0RmllbGRzKCk7CiAgICB9CiAgICAKICAgIC8vIEBAcHJvdG9j\nX2luc2VydGlvbl9wb2ludChjbGFzc19zY29wZTpSZWFkUmVzcG9uc2UpCiAg\nfQogIAogIHB1YmxpYyBpbnRlcmZhY2UgQWRkUmVzcG9uc2VPckJ1aWxkZXIK\nICAgICAgZXh0ZW5kcyBjb20uZ29vZ2xlLnByb3RvYnVmLk1lc3NhZ2VPckJ1\naWxkZXIgewogICAgCiAgICAvLyByZXF1aXJlZCAuU3RhdHVzQ29kZSBzdGF0\ndXMgPSAxOwogICAgYm9vbGVhbiBoYXNTdGF0dXMoKTsKICAgIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuU3RhdHVz\nQ29kZSBnZXRTdGF0dXMoKTsKICAgIAogICAgLy8gcmVxdWlyZWQgaW50NjQg\nbGVkZ2VySWQgPSAyOwogICAgYm9vbGVhbiBoYXNMZWRnZXJJZCgpOwogICAg\nbG9uZyBnZXRMZWRnZXJJZCgpOwogICAgCiAgICAvLyByZXF1aXJlZCBpbnQ2\nNCBlbnRyeUlkID0gMzsKICAgIGJvb2xlYW4gaGFzRW50cnlJZCgpOwogICAg\nbG9uZyBnZXRFbnRyeUlkKCk7CiAgfQogIHB1YmxpYyBzdGF0aWMgZmluYWwg\nY2xhc3MgQWRkUmVzcG9uc2UgZXh0ZW5kcwogICAgICBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UKICAgICAgaW1wbGVtZW50cyBBZGRS\nZXNwb25zZU9yQnVpbGRlciB7CiAgICAvLyBVc2UgQWRkUmVzcG9uc2UubmV3\nQnVpbGRlcigpIHRvIGNvbnN0cnVjdC4KICAgIHByaXZhdGUgQWRkUmVzcG9u\nc2UoQnVpbGRlciBidWlsZGVyKSB7CiAgICAgIHN1cGVyKGJ1aWxkZXIpOwog\nICAgfQogICAgcHJpdmF0ZSBBZGRSZXNwb25zZShib29sZWFuIG5vSW5pdCkg\ne30KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgQWRkUmVzcG9uc2Ug\nZGVmYXVsdEluc3RhbmNlOwogICAgcHVibGljIHN0YXRpYyBBZGRSZXNwb25z\nZSBnZXREZWZhdWx0SW5zdGFuY2UoKSB7CiAgICAgIHJldHVybiBkZWZhdWx0\nSW5zdGFuY2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBBZGRSZXNwb25zZSBn\nZXREZWZhdWx0SW5zdGFuY2VGb3JUeXBlKCkgewogICAgICByZXR1cm4gZGVm\nYXVsdEluc3RhbmNlOwogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRv\ncgogICAgICAgIGdldERlc2NyaXB0b3IoKSB7CiAgICAgIHJldHVybiBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLmlu\ndGVybmFsX3N0YXRpY19BZGRSZXNwb25zZV9kZXNjcmlwdG9yOwogICAgfQog\nICAgCiAgICBwcm90ZWN0ZWQgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0\nZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAgICAgIGludGVybmFs\nR2V0RmllbGRBY2Nlc3NvclRhYmxlKCkgewogICAgICByZXR1cm4gb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5pbnRl\ncm5hbF9zdGF0aWNfQWRkUmVzcG9uc2VfZmllbGRBY2Nlc3NvclRhYmxlOwog\nICAgfQogICAgCiAgICBwcml2YXRlIGludCBiaXRGaWVsZDBfOwogICAgLy8g\ncmVxdWlyZWQgLlN0YXR1c0NvZGUgc3RhdHVzID0gMTsKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgaW50IFNUQVRVU19GSUVMRF9OVU1CRVIgPSAxOwogICAg\ncHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLlN0YXR1c0NvZGUgc3RhdHVzXzsKICAgIHB1YmxpYyBib29s\nZWFuIGhhc1N0YXR1cygpIHsKICAgICAgcmV0dXJuICgoYml0RmllbGQwXyAm\nIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpOwogICAgfQogICAgcHVibGlj\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuU3RhdHVzQ29kZSBnZXRTdGF0dXMoKSB7CiAgICAgIHJldHVybiBzdGF0\ndXNfOwogICAgfQogICAgCiAgICAvLyByZXF1aXJlZCBpbnQ2NCBsZWRnZXJJ\nZCA9IDI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBMRURHRVJJRF9G\nSUVMRF9OVU1CRVIgPSAyOwogICAgcHJpdmF0ZSBsb25nIGxlZGdlcklkXzsK\nICAgIHB1YmxpYyBib29sZWFuIGhhc0xlZGdlcklkKCkgewogICAgICByZXR1\ncm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMikgPT0gMHgwMDAwMDAwMik7\nCiAgICB9CiAgICBwdWJsaWMgbG9uZyBnZXRMZWRnZXJJZCgpIHsKICAgICAg\ncmV0dXJuIGxlZGdlcklkXzsKICAgIH0KICAgIAogICAgLy8gcmVxdWlyZWQg\naW50NjQgZW50cnlJZCA9IDM7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGlu\ndCBFTlRSWUlEX0ZJRUxEX05VTUJFUiA9IDM7CiAgICBwcml2YXRlIGxvbmcg\nZW50cnlJZF87CiAgICBwdWJsaWMgYm9vbGVhbiBoYXNFbnRyeUlkKCkgewog\nICAgICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwNCkgPT0gMHgw\nMDAwMDAwNCk7CiAgICB9CiAgICBwdWJsaWMgbG9uZyBnZXRFbnRyeUlkKCkg\newogICAgICByZXR1cm4gZW50cnlJZF87CiAgICB9CiAgICAKICAgIHByaXZh\ndGUgdm9pZCBpbml0RmllbGRzKCkgewogICAgICBzdGF0dXNfID0gb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0\ndXNDb2RlLkVPSzsKICAgICAgbGVkZ2VySWRfID0gMEw7CiAgICAgIGVudHJ5\nSWRfID0gMEw7CiAgICB9CiAgICBwcml2YXRlIGJ5dGUgbWVtb2l6ZWRJc0lu\naXRpYWxpemVkID0gLTE7CiAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBpc0lu\naXRpYWxpemVkKCkgewogICAgICBieXRlIGlzSW5pdGlhbGl6ZWQgPSBtZW1v\naXplZElzSW5pdGlhbGl6ZWQ7CiAgICAgIGlmIChpc0luaXRpYWxpemVkICE9\nIC0xKSByZXR1cm4gaXNJbml0aWFsaXplZCA9PSAxOwogICAgICAKICAgICAg\naWYgKCFoYXNTdGF0dXMoKSkgewogICAgICAgIG1lbW9pemVkSXNJbml0aWFs\naXplZCA9IDA7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAg\nIGlmICghaGFzTGVkZ2VySWQoKSkgewogICAgICAgIG1lbW9pemVkSXNJbml0\naWFsaXplZCA9IDA7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAg\nICAgIGlmICghaGFzRW50cnlJZCgpKSB7CiAgICAgICAgbWVtb2l6ZWRJc0lu\naXRpYWxpemVkID0gMDsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0K\nICAgICAgbWVtb2l6ZWRJc0luaXRpYWxpemVkID0gMTsKICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHdyaXRlVG8oY29t\nLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1dFN0cmVhbSBvdXRwdXQpCiAg\nICAgICAgICAgICAgICAgICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0\naW9uIHsKICAgICAgZ2V0U2VyaWFsaXplZFNpemUoKTsKICAgICAgaWYgKCgo\nYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpKSB7CiAg\nICAgICAgb3V0cHV0LndyaXRlRW51bSgxLCBzdGF0dXNfLmdldE51bWJlcigp\nKTsKICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAwMDAw\nMikgPT0gMHgwMDAwMDAwMikpIHsKICAgICAgICBvdXRwdXQud3JpdGVJbnQ2\nNCgyLCBsZWRnZXJJZF8pOwogICAgICB9CiAgICAgIGlmICgoKGJpdEZpZWxk\nMF8gJiAweDAwMDAwMDA0KSA9PSAweDAwMDAwMDA0KSkgewogICAgICAgIG91\ndHB1dC53cml0ZUludDY0KDMsIGVudHJ5SWRfKTsKICAgICAgfQogICAgICBn\nZXRVbmtub3duRmllbGRzKCkud3JpdGVUbyhvdXRwdXQpOwogICAgfQogICAg\nCiAgICBwcml2YXRlIGludCBtZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gLTE7\nCiAgICBwdWJsaWMgaW50IGdldFNlcmlhbGl6ZWRTaXplKCkgewogICAgICBp\nbnQgc2l6ZSA9IG1lbW9pemVkU2VyaWFsaXplZFNpemU7CiAgICAgIGlmIChz\naXplICE9IC0xKSByZXR1cm4gc2l6ZTsKICAgIAogICAgICBzaXplID0gMDsK\nICAgICAgaWYgKCgoYml0RmllbGQwXyAmIDB4MDAwMDAwMDEpID09IDB4MDAw\nMDAwMDEpKSB7CiAgICAgICAgc2l6ZSArPSBjb20uZ29vZ2xlLnByb3RvYnVm\nLkNvZGVkT3V0cHV0U3RyZWFtCiAgICAgICAgICAuY29tcHV0ZUVudW1TaXpl\nKDEsIHN0YXR1c18uZ2V0TnVtYmVyKCkpOwogICAgICB9CiAgICAgIGlmICgo\nKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKSkgewog\nICAgICAgIHNpemUgKz0gY29tLmdvb2dsZS5wcm90b2J1Zi5Db2RlZE91dHB1\ndFN0cmVhbQogICAgICAgICAgLmNvbXB1dGVJbnQ2NFNpemUoMiwgbGVkZ2Vy\nSWRfKTsKICAgICAgfQogICAgICBpZiAoKChiaXRGaWVsZDBfICYgMHgwMDAw\nMDAwNCkgPT0gMHgwMDAwMDAwNCkpIHsKICAgICAgICBzaXplICs9IGNvbS5n\nb29nbGUucHJvdG9idWYuQ29kZWRPdXRwdXRTdHJlYW0KICAgICAgICAgIC5j\nb21wdXRlSW50NjRTaXplKDMsIGVudHJ5SWRfKTsKICAgICAgfQogICAgICBz\naXplICs9IGdldFVua25vd25GaWVsZHMoKS5nZXRTZXJpYWxpemVkU2l6ZSgp\nOwogICAgICBtZW1vaXplZFNlcmlhbGl6ZWRTaXplID0gc2l6ZTsKICAgICAg\ncmV0dXJuIHNpemU7CiAgICB9CiAgICAKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIGxvbmcgc2VyaWFsVmVyc2lvblVJRCA9IDBMOwogICAgQGphdmEubGFu\nZy5PdmVycmlkZQogICAgcHJvdGVjdGVkIGphdmEubGFuZy5PYmplY3Qgd3Jp\ndGVSZXBsYWNlKCkKICAgICAgICB0aHJvd3MgamF2YS5pby5PYmplY3RTdHJl\nYW1FeGNlcHRpb24gewogICAgICByZXR1cm4gc3VwZXIud3JpdGVSZXBsYWNl\nKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25z\nZSBwYXJzZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRl\nU3RyaW5nIGRhdGEpCiAgICAgICAgdGhyb3dzIGNvbS5nb29nbGUucHJvdG9i\ndWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uIHsKICAgICAgcmV0\ndXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oZGF0YSkuYnVpbGRQYXJzZWQo\nKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZSBwYXJz\nZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5n\nIGRhdGEsCiAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5FeHRlbnNpb25S\nZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgdGhyb3dz\nIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhj\nZXB0aW9uIHsKICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20o\nZGF0YSwgZXh0ZW5zaW9uUmVnaXN0cnkpCiAgICAgICAgICAgICAgIC5idWls\nZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3Bv\nbnNlIHBhcnNlRnJvbShieXRlW10gZGF0YSkKICAgICAgICB0aHJvd3MgY29t\nLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRp\nb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShkYXRh\nKS5idWlsZFBhcnNlZCgpOwogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFk\nZFJlc3BvbnNlIHBhcnNlRnJvbSgKICAgICAgICBieXRlW10gZGF0YSwKICAg\nICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0\nZSBleHRlbnNpb25SZWdpc3RyeSkKICAgICAgICB0aHJvd3MgY29tLmdvb2ds\nZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb24gewog\nICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShkYXRhLCBleHRl\nbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFyc2VkKCk7\nCiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UgcGFyc2VG\ncm9tKGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQpCiAgICAgICAgdGhyb3dz\nIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICByZXR1cm4gbmV3QnVpbGRl\ncigpLm1lcmdlRnJvbShpbnB1dCkuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAg\nIHB1YmxpYyBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5BZGRSZXNwb25zZSBwYXJzZUZyb20oCiAgICAg\nICAgamF2YS5pby5JbnB1dFN0cmVhbSBpbnB1dCwKICAgICAgICBjb20uZ29v\nZ2xlLnByb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0ZSBleHRlbnNpb25S\nZWdpc3RyeSkKICAgICAgICB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7\nCiAgICAgIHJldHVybiBuZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGlucHV0LCBl\neHRlbnNpb25SZWdpc3RyeSkKICAgICAgICAgICAgICAgLmJ1aWxkUGFyc2Vk\nKCk7CiAgICB9CiAgICBwdWJsaWMgc3RhdGljIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UgcGFy\nc2VEZWxpbWl0ZWRGcm9tKGphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQpCiAg\nICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAgICBCdWls\nZGVyIGJ1aWxkZXIgPSBuZXdCdWlsZGVyKCk7CiAgICAgIGlmIChidWlsZGVy\nLm1lcmdlRGVsaW1pdGVkRnJvbShpbnB1dCkpIHsKICAgICAgICByZXR1cm4g\nYnVpbGRlci5idWlsZFBhcnNlZCgpOwogICAgICB9IGVsc2UgewogICAgICAg\nIHJldHVybiBudWxsOwogICAgICB9CiAgICB9CiAgICBwdWJsaWMgc3RhdGlj\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuQWRkUmVzcG9uc2UgcGFyc2VEZWxpbWl0ZWRGcm9tKAogICAgICAgIGph\ndmEuaW8uSW5wdXRTdHJlYW0gaW5wdXQsCiAgICAgICAgY29tLmdvb2dsZS5w\ncm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeUxpdGUgZXh0ZW5zaW9uUmVnaXN0\ncnkpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogICAg\nICBCdWlsZGVyIGJ1aWxkZXIgPSBuZXdCdWlsZGVyKCk7CiAgICAgIGlmIChi\ndWlsZGVyLm1lcmdlRGVsaW1pdGVkRnJvbShpbnB1dCwgZXh0ZW5zaW9uUmVn\naXN0cnkpKSB7CiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGRQYXJzZWQo\nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nfQogICAgfQogICAgcHVibGljIHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3BvbnNlIHBhcnNl\nRnJvbSgKICAgICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkNvZGVkSW5wdXRT\ndHJlYW0gaW5wdXQpCiAgICAgICAgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRp\nb24gewogICAgICByZXR1cm4gbmV3QnVpbGRlcigpLm1lcmdlRnJvbShpbnB1\ndCkuYnVpbGRQYXJzZWQoKTsKICAgIH0KICAgIHB1YmxpYyBzdGF0aWMgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5B\nZGRSZXNwb25zZSBwYXJzZUZyb20oCiAgICAgICAgY29tLmdvb2dsZS5wcm90\nb2J1Zi5Db2RlZElucHV0U3RyZWFtIGlucHV0LAogICAgICAgIGNvbS5nb29n\nbGUucHJvdG9idWYuRXh0ZW5zaW9uUmVnaXN0cnlMaXRlIGV4dGVuc2lvblJl\nZ2lzdHJ5KQogICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsK\nICAgICAgcmV0dXJuIG5ld0J1aWxkZXIoKS5tZXJnZUZyb20oaW5wdXQsIGV4\ndGVuc2lvblJlZ2lzdHJ5KQogICAgICAgICAgICAgICAuYnVpbGRQYXJzZWQo\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBCdWlsZGVyIG5ld0J1\naWxkZXIoKSB7IHJldHVybiBCdWlsZGVyLmNyZWF0ZSgpOyB9CiAgICBwdWJs\naWMgQnVpbGRlciBuZXdCdWlsZGVyRm9yVHlwZSgpIHsgcmV0dXJuIG5ld0J1\naWxkZXIoKTsgfQogICAgcHVibGljIHN0YXRpYyBCdWlsZGVyIG5ld0J1aWxk\nZXIob3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90\nb2NvbC5BZGRSZXNwb25zZSBwcm90b3R5cGUpIHsKICAgICAgcmV0dXJuIG5l\nd0J1aWxkZXIoKS5tZXJnZUZyb20ocHJvdG90eXBlKTsKICAgIH0KICAgIHB1\nYmxpYyBCdWlsZGVyIHRvQnVpbGRlcigpIHsgcmV0dXJuIG5ld0J1aWxkZXIo\ndGhpcyk7IH0KICAgIAogICAgQGphdmEubGFuZy5PdmVycmlkZQogICAgcHJv\ndGVjdGVkIEJ1aWxkZXIgbmV3QnVpbGRlckZvclR5cGUoCiAgICAgICAgY29t\nLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkJ1aWxkZXJQYXJl\nbnQgcGFyZW50KSB7CiAgICAgIEJ1aWxkZXIgYnVpbGRlciA9IG5ldyBCdWls\nZGVyKHBhcmVudCk7CiAgICAgIHJldHVybiBidWlsZGVyOwogICAgfQogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBjbGFzcyBCdWlsZGVyIGV4dGVuZHMKICAg\nICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2UuQnVp\nbGRlcjxCdWlsZGVyPgogICAgICAgaW1wbGVtZW50cyBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3BvbnNl\nT3JCdWlsZGVyIHsKICAgICAgcHVibGljIHN0YXRpYyBmaW5hbCBjb20uZ29v\nZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3JzLkRlc2NyaXB0b3IKICAgICAgICAg\nIGdldERlc2NyaXB0b3IoKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuaW50ZXJuYWxf\nc3RhdGljX0FkZFJlc3BvbnNlX2Rlc2NyaXB0b3I7CiAgICAgIH0KICAgICAg\nCiAgICAgIHByb3RlY3RlZCBjb20uZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRl\nZE1lc3NhZ2UuRmllbGRBY2Nlc3NvclRhYmxlCiAgICAgICAgICBpbnRlcm5h\nbEdldEZpZWxkQWNjZXNzb3JUYWJsZSgpIHsKICAgICAgICByZXR1cm4gb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5p\nbnRlcm5hbF9zdGF0aWNfQWRkUmVzcG9uc2VfZmllbGRBY2Nlc3NvclRhYmxl\nOwogICAgICB9CiAgICAgIAogICAgICAvLyBDb25zdHJ1Y3QgdXNpbmcgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5B\nZGRSZXNwb25zZS5uZXdCdWlsZGVyKCkKICAgICAgcHJpdmF0ZSBCdWlsZGVy\nKCkgewogICAgICAgIG1heWJlRm9yY2VCdWlsZGVySW5pdGlhbGl6YXRpb24o\nKTsKICAgICAgfQogICAgICAKICAgICAgcHJpdmF0ZSBCdWlsZGVyKEJ1aWxk\nZXJQYXJlbnQgcGFyZW50KSB7CiAgICAgICAgc3VwZXIocGFyZW50KTsKICAg\nICAgICBtYXliZUZvcmNlQnVpbGRlckluaXRpYWxpemF0aW9uKCk7CiAgICAg\nIH0KICAgICAgcHJpdmF0ZSB2b2lkIG1heWJlRm9yY2VCdWlsZGVySW5pdGlh\nbGl6YXRpb24oKSB7CiAgICAgICAgaWYgKGNvbS5nb29nbGUucHJvdG9idWYu\nR2VuZXJhdGVkTWVzc2FnZS5hbHdheXNVc2VGaWVsZEJ1aWxkZXJzKSB7CiAg\nICAgICAgfQogICAgICB9CiAgICAgIHByaXZhdGUgc3RhdGljIEJ1aWxkZXIg\nY3JlYXRlKCkgewogICAgICAgIHJldHVybiBuZXcgQnVpbGRlcigpOwogICAg\nICB9CiAgICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBjbGVhcigpIHsKICAg\nICAgICBzdXBlci5jbGVhcigpOwogICAgICAgIHN0YXR1c18gPSBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlN0YXR1\nc0NvZGUuRU9LOwogICAgICAgIGJpdEZpZWxkMF8gPSAoYml0RmllbGQwXyAm\nIH4weDAwMDAwMDAxKTsKICAgICAgICBsZWRnZXJJZF8gPSAwTDsKICAgICAg\nICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAwMDAwMik7CiAg\nICAgICAgZW50cnlJZF8gPSAwTDsKICAgICAgICBiaXRGaWVsZDBfID0gKGJp\ndEZpZWxkMF8gJiB+MHgwMDAwMDAwNCk7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBCdWlsZGVyIGNsb25lKCkg\newogICAgICAgIHJldHVybiBjcmVhdGUoKS5tZXJnZUZyb20oYnVpbGRQYXJ0\naWFsKCkpOwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgY29tLmdvb2ds\nZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5EZXNjcmlwdG9yCiAgICAgICAgICBn\nZXREZXNjcmlwdG9yRm9yVHlwZSgpIHsKICAgICAgICByZXR1cm4gb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRS\nZXNwb25zZS5nZXREZXNjcmlwdG9yKCk7CiAgICAgIH0KICAgICAgCiAgICAg\nIHB1YmxpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLkFkZFJlc3BvbnNlIGdldERlZmF1bHRJbnN0YW5jZUZvclR5\ncGUoKSB7CiAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UuZ2V0RGVmYXVs\ndEluc3RhbmNlKCk7CiAgICAgIH0KICAgICAgCiAgICAgIHB1YmxpYyBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFk\nZFJlc3BvbnNlIGJ1aWxkKCkgewogICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UgcmVz\ndWx0ID0gYnVpbGRQYXJ0aWFsKCk7CiAgICAgICAgaWYgKCFyZXN1bHQuaXNJ\nbml0aWFsaXplZCgpKSB7CiAgICAgICAgICB0aHJvdyBuZXdVbmluaXRpYWxp\nemVkTWVzc2FnZUV4Y2VwdGlvbihyZXN1bHQpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICAgIAogICAgICBwcml2YXRl\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9j\nb2wuQWRkUmVzcG9uc2UgYnVpbGRQYXJzZWQoKQogICAgICAgICAgdGhyb3dz\nIGNvbS5nb29nbGUucHJvdG9idWYuSW52YWxpZFByb3RvY29sQnVmZmVyRXhj\nZXB0aW9uIHsKICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLkFkZFJlc3BvbnNlIHJlc3VsdCA9IGJ1aWxk\nUGFydGlhbCgpOwogICAgICAgIGlmICghcmVzdWx0LmlzSW5pdGlhbGl6ZWQo\nKSkgewogICAgICAgICAgdGhyb3cgbmV3VW5pbml0aWFsaXplZE1lc3NhZ2VF\neGNlcHRpb24oCiAgICAgICAgICAgIHJlc3VsdCkuYXNJbnZhbGlkUHJvdG9j\nb2xCdWZmZXJFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIHJlc3VsdDsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIG9yZy5hcGFj\naGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVz\ncG9uc2UgYnVpbGRQYXJ0aWFsKCkgewogICAgICAgIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2Ug\ncmVzdWx0ID0gbmV3IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\na2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UodGhpcyk7CiAgICAgICAgaW50\nIGZyb21fYml0RmllbGQwXyA9IGJpdEZpZWxkMF87CiAgICAgICAgaW50IHRv\nX2JpdEZpZWxkMF8gPSAwOwogICAgICAgIGlmICgoKGZyb21fYml0RmllbGQw\nXyAmIDB4MDAwMDAwMDEpID09IDB4MDAwMDAwMDEpKSB7CiAgICAgICAgICB0\nb19iaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDE7CiAgICAgICAgfQogICAgICAg\nIHJlc3VsdC5zdGF0dXNfID0gc3RhdHVzXzsKICAgICAgICBpZiAoKChmcm9t\nX2JpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKSkgewog\nICAgICAgICAgdG9fYml0RmllbGQwXyB8PSAweDAwMDAwMDAyOwogICAgICAg\nIH0KICAgICAgICByZXN1bHQubGVkZ2VySWRfID0gbGVkZ2VySWRfOwogICAg\nICAgIGlmICgoKGZyb21fYml0RmllbGQwXyAmIDB4MDAwMDAwMDQpID09IDB4\nMDAwMDAwMDQpKSB7CiAgICAgICAgICB0b19iaXRGaWVsZDBfIHw9IDB4MDAw\nMDAwMDQ7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5lbnRyeUlkXyA9IGVu\ndHJ5SWRfOwogICAgICAgIHJlc3VsdC5iaXRGaWVsZDBfID0gdG9fYml0Rmll\nbGQwXzsKICAgICAgICBvbkJ1aWx0KCk7CiAgICAgICAgcmV0dXJuIHJlc3Vs\ndDsKICAgICAgfQogICAgICAKICAgICAgcHVibGljIEJ1aWxkZXIgbWVyZ2VG\ncm9tKGNvbS5nb29nbGUucHJvdG9idWYuTWVzc2FnZSBvdGhlcikgewogICAg\nICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UpIHsKICAg\nICAgICAgIHJldHVybiBtZXJnZUZyb20oKG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2Upb3RoZXIp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdXBlci5tZXJnZUZyb20o\nb3RoZXIpOwogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAg\nICB9CiAgICAgIAogICAgICBwdWJsaWMgQnVpbGRlciBtZXJnZUZyb20ob3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5B\nZGRSZXNwb25zZSBvdGhlcikgewogICAgICAgIGlmIChvdGhlciA9PSBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFk\nZFJlc3BvbnNlLmdldERlZmF1bHRJbnN0YW5jZSgpKSByZXR1cm4gdGhpczsK\nICAgICAgICBpZiAob3RoZXIuaGFzU3RhdHVzKCkpIHsKICAgICAgICAgIHNl\ndFN0YXR1cyhvdGhlci5nZXRTdGF0dXMoKSk7CiAgICAgICAgfQogICAgICAg\nIGlmIChvdGhlci5oYXNMZWRnZXJJZCgpKSB7CiAgICAgICAgICBzZXRMZWRn\nZXJJZChvdGhlci5nZXRMZWRnZXJJZCgpKTsKICAgICAgICB9CiAgICAgICAg\naWYgKG90aGVyLmhhc0VudHJ5SWQoKSkgewogICAgICAgICAgc2V0RW50cnlJ\nZChvdGhlci5nZXRFbnRyeUlkKCkpOwogICAgICAgIH0KICAgICAgICB0aGlz\nLm1lcmdlVW5rbm93bkZpZWxkcyhvdGhlci5nZXRVbmtub3duRmllbGRzKCkp\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CiAgICAgIAogICAgICBw\ndWJsaWMgZmluYWwgYm9vbGVhbiBpc0luaXRpYWxpemVkKCkgewogICAgICAg\nIGlmICghaGFzU3RhdHVzKCkpIHsKICAgICAgICAgIAogICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIWhhc0xlZGdlcklk\nKCkpIHsKICAgICAgICAgIAogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KICAgICAgICBpZiAoIWhhc0VudHJ5SWQoKSkgewogICAgICAgICAg\nCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICB9CiAgICAgIAogICAgICBwdWJsaWMgQnVpbGRl\nciBtZXJnZUZyb20oCiAgICAgICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkNv\nZGVkSW5wdXRTdHJlYW0gaW5wdXQsCiAgICAgICAgICBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkV4dGVuc2lvblJlZ2lzdHJ5TGl0ZSBleHRlbnNpb25SZWdpc3Ry\neSkKICAgICAgICAgIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICAg\nICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLlVua25vd25GaWVsZFNldC5CdWls\nZGVyIHVua25vd25GaWVsZHMgPQogICAgICAgICAgY29tLmdvb2dsZS5wcm90\nb2J1Zi5Vbmtub3duRmllbGRTZXQubmV3QnVpbGRlcigKICAgICAgICAgICAg\ndGhpcy5nZXRVbmtub3duRmllbGRzKCkpOwogICAgICAgIHdoaWxlICh0cnVl\nKSB7CiAgICAgICAgICBpbnQgdGFnID0gaW5wdXQucmVhZFRhZygpOwogICAg\nICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAg\nICAgICAgICAgIHRoaXMuc2V0VW5rbm93bkZpZWxkcyh1bmtub3duRmllbGRz\nLmJ1aWxkKCkpOwogICAgICAgICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAg\nICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICBkZWZhdWx0OiB7CiAg\nICAgICAgICAgICAgaWYgKCFwYXJzZVVua25vd25GaWVsZChpbnB1dCwgdW5r\nbm93bkZpZWxkcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGV4dGVuc2lvblJlZ2lzdHJ5LCB0YWcpKSB7CiAgICAgICAgICAgICAg\nICB0aGlzLnNldFVua25vd25GaWVsZHModW5rbm93bkZpZWxkcy5idWlsZCgp\nKTsKICAgICAgICAgICAgICAgIG9uQ2hhbmdlZCgpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgODogewog\nICAgICAgICAgICAgIGludCByYXdWYWx1ZSA9IGlucHV0LnJlYWRFbnVtKCk7\nCiAgICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJv\nb2trZWVwZXJQcm90b2NvbC5TdGF0dXNDb2RlIHZhbHVlID0gb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5TdGF0dXND\nb2RlLnZhbHVlT2YocmF3VmFsdWUpOwogICAgICAgICAgICAgIGlmICh2YWx1\nZSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICB1bmtub3duRmllbGRzLm1l\ncmdlVmFyaW50RmllbGQoMSwgcmF3VmFsdWUpOwogICAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAw\nMDE7CiAgICAgICAgICAgICAgICBzdGF0dXNfID0gdmFsdWU7CiAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGNhc2UgMTY6IHsKICAgICAgICAgICAgICBiaXRGaWVsZDBf\nIHw9IDB4MDAwMDAwMDI7CiAgICAgICAgICAgICAgbGVkZ2VySWRfID0gaW5w\ndXQucmVhZEludDY0KCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgY2FzZSAyNDogewogICAgICAgICAgICAgIGJp\ndEZpZWxkMF8gfD0gMHgwMDAwMDAwNDsKICAgICAgICAgICAgICBlbnRyeUlk\nXyA9IGlucHV0LnJlYWRJbnQ2NCgpOwogICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAg\nICAgIAogICAgICBwcml2YXRlIGludCBiaXRGaWVsZDBfOwogICAgICAKICAg\nICAgLy8gcmVxdWlyZWQgLlN0YXR1c0NvZGUgc3RhdHVzID0gMTsKICAgICAg\ncHJpdmF0ZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nclByb3RvY29sLlN0YXR1c0NvZGUgc3RhdHVzXyA9IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuU3RhdHVzQ29kZS5F\nT0s7CiAgICAgIHB1YmxpYyBib29sZWFuIGhhc1N0YXR1cygpIHsKICAgICAg\nICByZXR1cm4gKChiaXRGaWVsZDBfICYgMHgwMDAwMDAwMSkgPT0gMHgwMDAw\nMDAwMSk7CiAgICAgIH0KICAgICAgcHVibGljIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuU3RhdHVzQ29kZSBnZXRT\ndGF0dXMoKSB7CiAgICAgICAgcmV0dXJuIHN0YXR1c187CiAgICAgIH0KICAg\nICAgcHVibGljIEJ1aWxkZXIgc2V0U3RhdHVzKG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuU3RhdHVzQ29kZSB2YWx1\nZSkgewogICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgICB0\naHJvdyBuZXcgTnVsbFBvaW50ZXJFeGNlcHRpb24oKTsKICAgICAgICB9CiAg\nICAgICAgYml0RmllbGQwXyB8PSAweDAwMDAwMDAxOwogICAgICAgIHN0YXR1\nc18gPSB2YWx1ZTsKICAgICAgICBvbkNoYW5nZWQoKTsKICAgICAgICByZXR1\ncm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBjbGVhclN0\nYXR1cygpIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+\nMHgwMDAwMDAwMSk7CiAgICAgICAgc3RhdHVzXyA9IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuU3RhdHVzQ29kZS5F\nT0s7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICAgIH0KICAgICAgCiAgICAgIC8vIHJlcXVpcmVkIGludDY0IGxlZGdl\ncklkID0gMjsKICAgICAgcHJpdmF0ZSBsb25nIGxlZGdlcklkXyA7CiAgICAg\nIHB1YmxpYyBib29sZWFuIGhhc0xlZGdlcklkKCkgewogICAgICAgIHJldHVy\nbiAoKGJpdEZpZWxkMF8gJiAweDAwMDAwMDAyKSA9PSAweDAwMDAwMDAyKTsK\nICAgICAgfQogICAgICBwdWJsaWMgbG9uZyBnZXRMZWRnZXJJZCgpIHsKICAg\nICAgICByZXR1cm4gbGVkZ2VySWRfOwogICAgICB9CiAgICAgIHB1YmxpYyBC\ndWlsZGVyIHNldExlZGdlcklkKGxvbmcgdmFsdWUpIHsKICAgICAgICBiaXRG\naWVsZDBfIHw9IDB4MDAwMDAwMDI7CiAgICAgICAgbGVkZ2VySWRfID0gdmFs\ndWU7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICAgIH0KICAgICAgcHVibGljIEJ1aWxkZXIgY2xlYXJMZWRnZXJJZCgp\nIHsKICAgICAgICBiaXRGaWVsZDBfID0gKGJpdEZpZWxkMF8gJiB+MHgwMDAw\nMDAwMik7CiAgICAgICAgbGVkZ2VySWRfID0gMEw7CiAgICAgICAgb25DaGFu\nZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KICAgICAgCiAg\nICAgIC8vIHJlcXVpcmVkIGludDY0IGVudHJ5SWQgPSAzOwogICAgICBwcml2\nYXRlIGxvbmcgZW50cnlJZF8gOwogICAgICBwdWJsaWMgYm9vbGVhbiBoYXNF\nbnRyeUlkKCkgewogICAgICAgIHJldHVybiAoKGJpdEZpZWxkMF8gJiAweDAw\nMDAwMDA0KSA9PSAweDAwMDAwMDA0KTsKICAgICAgfQogICAgICBwdWJsaWMg\nbG9uZyBnZXRFbnRyeUlkKCkgewogICAgICAgIHJldHVybiBlbnRyeUlkXzsK\nICAgICAgfQogICAgICBwdWJsaWMgQnVpbGRlciBzZXRFbnRyeUlkKGxvbmcg\ndmFsdWUpIHsKICAgICAgICBiaXRGaWVsZDBfIHw9IDB4MDAwMDAwMDQ7CiAg\nICAgICAgZW50cnlJZF8gPSB2YWx1ZTsKICAgICAgICBvbkNoYW5nZWQoKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgICBwdWJsaWMgQnVp\nbGRlciBjbGVhckVudHJ5SWQoKSB7CiAgICAgICAgYml0RmllbGQwXyA9IChi\naXRGaWVsZDBfICYgfjB4MDAwMDAwMDQpOwogICAgICAgIGVudHJ5SWRfID0g\nMEw7CiAgICAgICAgb25DaGFuZ2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICAgIH0KICAgICAgCiAgICAgIC8vIEBAcHJvdG9jX2luc2VydGlvbl9w\nb2ludChidWlsZGVyX3Njb3BlOkFkZFJlc3BvbnNlKQogICAgfQogICAgCiAg\nICBzdGF0aWMgewogICAgICBkZWZhdWx0SW5zdGFuY2UgPSBuZXcgQWRkUmVz\ncG9uc2UodHJ1ZSk7CiAgICAgIGRlZmF1bHRJbnN0YW5jZS5pbml0RmllbGRz\nKCk7CiAgICB9CiAgICAKICAgIC8vIEBAcHJvdG9jX2luc2VydGlvbl9wb2lu\ndChjbGFzc19zY29wZTpBZGRSZXNwb25zZSkKICB9CiAgCiAgcHJpdmF0ZSBz\ndGF0aWMgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5EZXNjcmlw\ndG9yCiAgICBpbnRlcm5hbF9zdGF0aWNfQktQYWNrZXRIZWFkZXJfZGVzY3Jp\ncHRvcjsKICBwcml2YXRlIHN0YXRpYwogICAgY29tLmdvb2dsZS5wcm90b2J1\nZi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAgICBp\nbnRlcm5hbF9zdGF0aWNfQktQYWNrZXRIZWFkZXJfZmllbGRBY2Nlc3NvclRh\nYmxlOwogIHByaXZhdGUgc3RhdGljIGNvbS5nb29nbGUucHJvdG9idWYuRGVz\nY3JpcHRvcnMuRGVzY3JpcHRvcgogICAgaW50ZXJuYWxfc3RhdGljX1JlcXVl\nc3RfZGVzY3JpcHRvcjsKICBwcml2YXRlIHN0YXRpYwogICAgY29tLmdvb2ds\nZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJs\nZQogICAgICBpbnRlcm5hbF9zdGF0aWNfUmVxdWVzdF9maWVsZEFjY2Vzc29y\nVGFibGU7CiAgcHJpdmF0ZSBzdGF0aWMgY29tLmdvb2dsZS5wcm90b2J1Zi5E\nZXNjcmlwdG9ycy5EZXNjcmlwdG9yCiAgICBpbnRlcm5hbF9zdGF0aWNfUmVh\nZFJlcXVlc3RfZGVzY3JpcHRvcjsKICBwcml2YXRlIHN0YXRpYwogICAgY29t\nLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNz\nb3JUYWJsZQogICAgICBpbnRlcm5hbF9zdGF0aWNfUmVhZFJlcXVlc3RfZmll\nbGRBY2Nlc3NvclRhYmxlOwogIHByaXZhdGUgc3RhdGljIGNvbS5nb29nbGUu\ncHJvdG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRvcgogICAgaW50ZXJuYWxf\nc3RhdGljX0FkZFJlcXVlc3RfZGVzY3JpcHRvcjsKICBwcml2YXRlIHN0YXRp\nYwogICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZp\nZWxkQWNjZXNzb3JUYWJsZQogICAgICBpbnRlcm5hbF9zdGF0aWNfQWRkUmVx\ndWVzdF9maWVsZEFjY2Vzc29yVGFibGU7CiAgcHJpdmF0ZSBzdGF0aWMgY29t\nLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5EZXNjcmlwdG9yCiAgICBp\nbnRlcm5hbF9zdGF0aWNfUmVzcG9uc2VfZGVzY3JpcHRvcjsKICBwcml2YXRl\nIHN0YXRpYwogICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNz\nYWdlLkZpZWxkQWNjZXNzb3JUYWJsZQogICAgICBpbnRlcm5hbF9zdGF0aWNf\nUmVzcG9uc2VfZmllbGRBY2Nlc3NvclRhYmxlOwogIHByaXZhdGUgc3RhdGlj\nIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRGVzY3JpcHRvcgog\nICAgaW50ZXJuYWxfc3RhdGljX1JlYWRSZXNwb25zZV9kZXNjcmlwdG9yOwog\nIHByaXZhdGUgc3RhdGljCiAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkdlbmVy\nYXRlZE1lc3NhZ2UuRmllbGRBY2Nlc3NvclRhYmxlCiAgICAgIGludGVybmFs\nX3N0YXRpY19SZWFkUmVzcG9uc2VfZmllbGRBY2Nlc3NvclRhYmxlOwogIHBy\naXZhdGUgc3RhdGljIGNvbS5nb29nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMu\nRGVzY3JpcHRvcgogICAgaW50ZXJuYWxfc3RhdGljX0FkZFJlc3BvbnNlX2Rl\nc2NyaXB0b3I7CiAgcHJpdmF0ZSBzdGF0aWMKICAgIGNvbS5nb29nbGUucHJv\ndG9idWYuR2VuZXJhdGVkTWVzc2FnZS5GaWVsZEFjY2Vzc29yVGFibGUKICAg\nICAgaW50ZXJuYWxfc3RhdGljX0FkZFJlc3BvbnNlX2ZpZWxkQWNjZXNzb3JU\nYWJsZTsKICAKICBwdWJsaWMgc3RhdGljIGNvbS5nb29nbGUucHJvdG9idWYu\nRGVzY3JpcHRvcnMuRmlsZURlc2NyaXB0b3IKICAgICAgZ2V0RGVzY3JpcHRv\ncigpIHsKICAgIHJldHVybiBkZXNjcmlwdG9yOwogIH0KICBwcml2YXRlIHN0\nYXRpYyBjb20uZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3JzLkZpbGVEZXNj\ncmlwdG9yCiAgICAgIGRlc2NyaXB0b3I7CiAgc3RhdGljIHsKICAgIGphdmEu\nbGFuZy5TdHJpbmdbXSBkZXNjcmlwdG9yRGF0YSA9IHsKICAgICAgIlxuXCdz\ncmMvbWFpbi9wcm90by9Cb29ra2VlcGVyUHJvdG9jb2wucHJvdCIgKwogICAg\nICAib1wiZVxuXDAxNkJLUGFja2V0SGVhZGVyXDAyMiFcblwwMDd2ZXJzaW9u\nXDAzMFwwMDEgXDAwMihcMDE2MlwwMjAuUCIgKwogICAgICAicm90b2NvbFZl\ncnNpb25cMDIyIVxuXHRvcGVyYXRpb25cMDMwXDAwMiBcMDAyKFwwMTYyXDAx\nNi5PcGVyIiArCiAgICAgICJhdGlvblR5cGVcMDIyXHJcblwwMDV0eG5JZFww\nMzBcMDAzIFwwMDIoXDAwNFwiblxuXDAwN1JlcXVlc3RcMDIyXDAzN1xuXDAw\nNmgiICsKICAgICAgImVhZGVyXDAzMFwwMDEgXDAwMihcMDEzMlwwMTcuQktQ\nYWNrZXRIZWFkZXJcMDIyIVxuXDAxM3JlYWRSZXF1IiArCiAgICAgICJlc3Rc\nMDMwZCBcMDAxKFwwMTMyXDAxNC5SZWFkUmVxdWVzdFwwMjJcMDM3XG5cbmFk\nZFJlcXVlc3RcMDMwZSAiICsKICAgICAgIlwwMDEoXDAxMzJcMDEzLkFkZFJl\ncXVlc3RcIn5cblwwMTNSZWFkUmVxdWVzdFwwMjJcMDM3XG5cMDA0ZmxhZ1ww\nMzAiICsKICAgICAgImQgXDAwMShcMDE2MlwwMjEuUmVhZFJlcXVlc3QuRmxh\nZ1wwMjJcMDIwXG5cMDEwbGVkZ2VySWRcMDMwXDAwMSBcMDAyIiArCiAgICAg\nICIoXDAwM1wwMjJcMDE3XG5cMDA3ZW50cnlJZFwwMzBcMDAyIFwwMDIoXDAw\nM1wwMjJcMDIxXG5cdG1hc3RlcktleVwwMzBcMDAzIFwwMDEoXDAxNFwiXDAz\nMCIgKwogICAgICAiXG5cMDA0RmxhZ1wwMjJcMDIwXG5cMDE0RkVOQ0VfTEVE\nR0VSXDAyMFwwMDFcIlwyMTJcMDAxXG5cbkFkZFJlcXVlc3RcMDIyIiwKICAg\nICAgIlwwMzZcblwwMDRmbGFnXDAzMGQgXDAwMShcMDE2MlwwMjAuQWRkUmVx\ndWVzdC5GbGFnXDAyMlwwMjBcblwwMTBsZWRnZSIgKwogICAgICAicklkXDAz\nMFwwMDEgXDAwMihcMDAzXDAyMlwwMTdcblwwMDdlbnRyeUlkXDAzMFwwMDIg\nXDAwMihcMDAzXDAyMlwwMjFcblx0bWFzdGVyS2V5XDAzMCIgKwogICAgICAi\nXDAwMyBcMDAyKFwwMTRcMDIyXDAxNFxuXDAwNGJvZHlcMDMwXDAwNCBcMDAy\nKFwwMTRcIlwwMzBcblwwMDRGbGFnXDAyMlwwMjBcblwwMTRSRUNPVkVSWV8i\nICsKICAgICAgIkFERFwwMjBcMDAxXCJcMjIwXDAwMVxuXDAxMFJlc3BvbnNl\nXDAyMlwwMzdcblwwMDZoZWFkZXJcMDMwXDAwMSBcMDAyKFwwMTMyXDAxNy5C\nS1AiICsKICAgICAgImFja2V0SGVhZGVyXDAyMlwwMzNcblwwMDZzdGF0dXNc\nMDMwXDAwMiBcMDAyKFwwMTYyXDAxMy5TdGF0dXNDb2RlIiArCiAgICAgICJc\nMDIyI1xuXDAxNHJlYWRSZXNwb25zZVwwMzBkIFwwMDEoXDAxMzJcci5SZWFk\nUmVzcG9uc2VcMDIyIVxuIiArCiAgICAgICJcMDEzYWRkUmVzcG9uc2VcMDMw\nZSBcMDAxKFwwMTMyXDAxNC5BZGRSZXNwb25zZVwiXFxcblwwMTRSZWFkIiAr\nCiAgICAgICJSZXNwb25zZVwwMjJcMDMzXG5cMDA2c3RhdHVzXDAzMFwwMDEg\nXDAwMihcMDE2MlwwMTMuU3RhdHVzQ29kZVwwMjJcMDIwXG4iICsKICAgICAg\nIlwwMTBsZWRnZXJJZFwwMzBcMDAyIFwwMDIoXDAwM1wwMjJcMDE3XG5cMDA3\nZW50cnlJZFwwMzBcMDAzIFwwMDIoXDAwM1wwMjJcMDE0XG5cMDA0Ym9keSIg\nKwogICAgICAiXDAzMFwwMDQgXDAwMShcMDE0XCJNXG5cMDEzQWRkUmVzcG9u\nc2VcMDIyXDAzM1xuXDAwNnN0YXR1c1wwMzBcMDAxIFwwMDIoXDAxNjJcMDEz\nLiIsCiAgICAgICJTdGF0dXNDb2RlXDAyMlwwMjBcblwwMTBsZWRnZXJJZFww\nMzBcMDAyIFwwMDIoXDAwM1wwMjJcMDE3XG5cMDA3ZW50cnlJZFwwMzAiICsK\nICAgICAgIlwwMDMgXDAwMihcMDAzKkZcblwwMTdQcm90b2NvbFZlcnNpb25c\nMDIyXDAxN1xuXDAxM1ZFUlNJT05fT05FXDAyMCIgKwogICAgICAiXDAwMVww\nMjJcMDE3XG5cMDEzVkVSU0lPTl9UV09cMDIwXDAwMlwwMjJcMDIxXG5cclZF\nUlNJT05fVEhSRUVcMDIwXDAwMypcMjA2XDAwMSIgKwogICAgICAiXG5cblN0\nYXR1c0NvZGVcMDIyXDAwN1xuXDAwM0VPS1wwMjBcMDAwXDAyMlwwMTZcblx0\nRU5PTEVER0VSXDAyMFwyMjJcMDAzXDAyMlxyXG4iICsKICAgICAgIlwwMTBF\nTk9FTlRSWVwwMjBcMjIzXDAwM1wwMjJcMDE0XG5cMDA3RUJBRFJFUVwwMjBc\nMjI0XDAwM1wwMjJcMDEwXG5cMDAzRUlPXDAyMFwzNjVcMDAzXDAyMlwwMTBc\nblwwMDMiICsKICAgICAgIkVVQVwwMjBcMzY2XDAwM1wwMjJcMDIwXG5cMDEz\nRUJBRFZFUlNJT05cMDIwXDM2N1wwMDNcMDIyXDAxNFxuXDAwN0VGRU5DRURc\nMDIwXDM3MFwwMDNcMDIyXDAxNiIgKwogICAgICAiXG5cdEVSRUFET05MWVww\nMjBcMzcxXDAwMypZXG5cck9wZXJhdGlvblR5cGVcMDIyXDAxNlxuXG5SRUFE\nXyIgKwogICAgICAiRU5UUllcMDIwXDAwMVwwMjJcclxuXHRBRERfRU5UUllc\nMDIwXDAwMlwwMjJcMDI0XG5cMDIwUkFOR0VfUkVBRF9FTlQiICsKICAgICAg\nIlJZXDAyMFwwMDNcMDIyXDAyM1xuXDAxN1JBTkdFX0FERF9FTlRSWVwwMjBc\nMDA0QlwwMzdcblwwMzNvcmcuYXBhY2hlLiIgKwogICAgICAiYm9va2tlZXBl\nci5wcm90b0hcMDAxIgogICAgfTsKICAgIGNvbS5nb29nbGUucHJvdG9idWYu\nRGVzY3JpcHRvcnMuRmlsZURlc2NyaXB0b3IuSW50ZXJuYWxEZXNjcmlwdG9y\nQXNzaWduZXIgYXNzaWduZXIgPQogICAgICBuZXcgY29tLmdvb2dsZS5wcm90\nb2J1Zi5EZXNjcmlwdG9ycy5GaWxlRGVzY3JpcHRvci5JbnRlcm5hbERlc2Ny\naXB0b3JBc3NpZ25lcigpIHsKICAgICAgICBwdWJsaWMgY29tLmdvb2dsZS5w\ncm90b2J1Zi5FeHRlbnNpb25SZWdpc3RyeSBhc3NpZ25EZXNjcmlwdG9ycygK\nICAgICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5EZXNjcmlwdG9ycy5G\naWxlRGVzY3JpcHRvciByb290KSB7CiAgICAgICAgICBkZXNjcmlwdG9yID0g\ncm9vdDsKICAgICAgICAgIGludGVybmFsX3N0YXRpY19CS1BhY2tldEhlYWRl\ncl9kZXNjcmlwdG9yID0KICAgICAgICAgICAgZ2V0RGVzY3JpcHRvcigpLmdl\ndE1lc3NhZ2VUeXBlcygpLmdldCgwKTsKICAgICAgICAgIGludGVybmFsX3N0\nYXRpY19CS1BhY2tldEhlYWRlcl9maWVsZEFjY2Vzc29yVGFibGUgPSBuZXcK\nICAgICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNz\nYWdlLkZpZWxkQWNjZXNzb3JUYWJsZSgKICAgICAgICAgICAgICBpbnRlcm5h\nbF9zdGF0aWNfQktQYWNrZXRIZWFkZXJfZGVzY3JpcHRvciwKICAgICAgICAg\nICAgICBuZXcgamF2YS5sYW5nLlN0cmluZ1tdIHsgIlZlcnNpb24iLCAiT3Bl\ncmF0aW9uIiwgIlR4bklkIiwgfSwKICAgICAgICAgICAgICBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0\nSGVhZGVyLmNsYXNzLAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQktQYWNrZXRIZWFkZXIu\nQnVpbGRlci5jbGFzcyk7CiAgICAgICAgICBpbnRlcm5hbF9zdGF0aWNfUmVx\ndWVzdF9kZXNjcmlwdG9yID0KICAgICAgICAgICAgZ2V0RGVzY3JpcHRvcigp\nLmdldE1lc3NhZ2VUeXBlcygpLmdldCgxKTsKICAgICAgICAgIGludGVybmFs\nX3N0YXRpY19SZXF1ZXN0X2ZpZWxkQWNjZXNzb3JUYWJsZSA9IG5ldwogICAg\nICAgICAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkdlbmVyYXRlZE1lc3NhZ2Uu\nRmllbGRBY2Nlc3NvclRhYmxlKAogICAgICAgICAgICAgIGludGVybmFsX3N0\nYXRpY19SZXF1ZXN0X2Rlc2NyaXB0b3IsCiAgICAgICAgICAgICAgbmV3IGph\ndmEubGFuZy5TdHJpbmdbXSB7ICJIZWFkZXIiLCAiUmVhZFJlcXVlc3QiLCAi\nQWRkUmVxdWVzdCIsIH0sCiAgICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZXF1ZXN0LmNsYXNz\nLAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVyUHJvdG9jb2wuUmVxdWVzdC5CdWlsZGVyLmNsYXNzKTsKICAg\nICAgICAgIGludGVybmFsX3N0YXRpY19SZWFkUmVxdWVzdF9kZXNjcmlwdG9y\nID0KICAgICAgICAgICAgZ2V0RGVzY3JpcHRvcigpLmdldE1lc3NhZ2VUeXBl\ncygpLmdldCgyKTsKICAgICAgICAgIGludGVybmFsX3N0YXRpY19SZWFkUmVx\ndWVzdF9maWVsZEFjY2Vzc29yVGFibGUgPSBuZXcKICAgICAgICAgICAgY29t\nLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZpZWxkQWNjZXNz\nb3JUYWJsZSgKICAgICAgICAgICAgICBpbnRlcm5hbF9zdGF0aWNfUmVhZFJl\ncXVlc3RfZGVzY3JpcHRvciwKICAgICAgICAgICAgICBuZXcgamF2YS5sYW5n\nLlN0cmluZ1tdIHsgIkZsYWciLCAiTGVkZ2VySWQiLCAiRW50cnlJZCIsICJN\nYXN0ZXJLZXkiLCB9LAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVhZFJlcXVlc3QuY2xh\nc3MsCiAgICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJQcm90b2NvbC5SZWFkUmVxdWVzdC5CdWlsZGVyLmNsYXNz\nKTsKICAgICAgICAgIGludGVybmFsX3N0YXRpY19BZGRSZXF1ZXN0X2Rlc2Ny\naXB0b3IgPQogICAgICAgICAgICBnZXREZXNjcmlwdG9yKCkuZ2V0TWVzc2Fn\nZVR5cGVzKCkuZ2V0KDMpOwogICAgICAgICAgaW50ZXJuYWxfc3RhdGljX0Fk\nZFJlcXVlc3RfZmllbGRBY2Nlc3NvclRhYmxlID0gbmV3CiAgICAgICAgICAg\nIGNvbS5nb29nbGUucHJvdG9idWYuR2VuZXJhdGVkTWVzc2FnZS5GaWVsZEFj\nY2Vzc29yVGFibGUoCiAgICAgICAgICAgICAgaW50ZXJuYWxfc3RhdGljX0Fk\nZFJlcXVlc3RfZGVzY3JpcHRvciwKICAgICAgICAgICAgICBuZXcgamF2YS5s\nYW5nLlN0cmluZ1tdIHsgIkZsYWciLCAiTGVkZ2VySWQiLCAiRW50cnlJZCIs\nICJNYXN0ZXJLZXkiLCAiQm9keSIsIH0sCiAgICAgICAgICAgICAgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5BZGRS\nZXF1ZXN0LmNsYXNzLAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVzdC5CdWls\nZGVyLmNsYXNzKTsKICAgICAgICAgIGludGVybmFsX3N0YXRpY19SZXNwb25z\nZV9kZXNjcmlwdG9yID0KICAgICAgICAgICAgZ2V0RGVzY3JpcHRvcigpLmdl\ndE1lc3NhZ2VUeXBlcygpLmdldCg0KTsKICAgICAgICAgIGludGVybmFsX3N0\nYXRpY19SZXNwb25zZV9maWVsZEFjY2Vzc29yVGFibGUgPSBuZXcKICAgICAg\nICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNzYWdlLkZp\nZWxkQWNjZXNzb3JUYWJsZSgKICAgICAgICAgICAgICBpbnRlcm5hbF9zdGF0\naWNfUmVzcG9uc2VfZGVzY3JpcHRvciwKICAgICAgICAgICAgICBuZXcgamF2\nYS5sYW5nLlN0cmluZ1tdIHsgIkhlYWRlciIsICJTdGF0dXMiLCAiUmVhZFJl\nc3BvbnNlIiwgIkFkZFJlc3BvbnNlIiwgfSwKICAgICAgICAgICAgICBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJl\nc3BvbnNlLmNsYXNzLAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2UuQnVpbGRl\nci5jbGFzcyk7CiAgICAgICAgICBpbnRlcm5hbF9zdGF0aWNfUmVhZFJlc3Bv\nbnNlX2Rlc2NyaXB0b3IgPQogICAgICAgICAgICBnZXREZXNjcmlwdG9yKCku\nZ2V0TWVzc2FnZVR5cGVzKCkuZ2V0KDUpOwogICAgICAgICAgaW50ZXJuYWxf\nc3RhdGljX1JlYWRSZXNwb25zZV9maWVsZEFjY2Vzc29yVGFibGUgPSBuZXcK\nICAgICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0ZWRNZXNz\nYWdlLkZpZWxkQWNjZXNzb3JUYWJsZSgKICAgICAgICAgICAgICBpbnRlcm5h\nbF9zdGF0aWNfUmVhZFJlc3BvbnNlX2Rlc2NyaXB0b3IsCiAgICAgICAgICAg\nICAgbmV3IGphdmEubGFuZy5TdHJpbmdbXSB7ICJTdGF0dXMiLCAiTGVkZ2Vy\nSWQiLCAiRW50cnlJZCIsICJCb2R5IiwgfSwKICAgICAgICAgICAgICBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJl\nYWRSZXNwb25zZS5jbGFzcywKICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25z\nZS5CdWlsZGVyLmNsYXNzKTsKICAgICAgICAgIGludGVybmFsX3N0YXRpY19B\nZGRSZXNwb25zZV9kZXNjcmlwdG9yID0KICAgICAgICAgICAgZ2V0RGVzY3Jp\ncHRvcigpLmdldE1lc3NhZ2VUeXBlcygpLmdldCg2KTsKICAgICAgICAgIGlu\ndGVybmFsX3N0YXRpY19BZGRSZXNwb25zZV9maWVsZEFjY2Vzc29yVGFibGUg\nPSBuZXcKICAgICAgICAgICAgY29tLmdvb2dsZS5wcm90b2J1Zi5HZW5lcmF0\nZWRNZXNzYWdlLkZpZWxkQWNjZXNzb3JUYWJsZSgKICAgICAgICAgICAgICBp\nbnRlcm5hbF9zdGF0aWNfQWRkUmVzcG9uc2VfZGVzY3JpcHRvciwKICAgICAg\nICAgICAgICBuZXcgamF2YS5sYW5nLlN0cmluZ1tdIHsgIlN0YXR1cyIsICJM\nZWRnZXJJZCIsICJFbnRyeUlkIiwgfSwKICAgICAgICAgICAgICBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkFkZFJl\nc3BvbnNlLmNsYXNzLAogICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVzcG9uc2UuQnVp\nbGRlci5jbGFzcyk7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9\nCiAgICAgIH07CiAgICBjb20uZ29vZ2xlLnByb3RvYnVmLkRlc2NyaXB0b3Jz\nLkZpbGVEZXNjcmlwdG9yCiAgICAgIC5pbnRlcm5hbEJ1aWxkR2VuZXJhdGVk\nRmlsZUZyb20oZGVzY3JpcHRvckRhdGEsCiAgICAgICAgbmV3IGNvbS5nb29n\nbGUucHJvdG9idWYuRGVzY3JpcHRvcnMuRmlsZURlc2NyaXB0b3JbXSB7CiAg\nICAgICAgfSwgYXNzaWduZXIpOwogIH0KICAKICAvLyBAQHByb3RvY19pbnNl\ncnRpb25fcG9pbnQob3V0ZXJfY2xhc3Nfc2NvcGUpCn0K\n","encoding":"base64"}

