{"sha":"deef9f48f66819280cf496feabaeb08b1564faa7","node_id":"MDQ6QmxvYjE1NzU5NTY6ZGVlZjlmNDhmNjY4MTkyODBjZjQ5NmZlYWJhZWIwOGIxNTY0ZmFhNw==","size":40809,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/deef9f48f66819280cf496feabaeb08b1564faa7","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG87CgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmlvLmNoYW5uZWxzLkNs\nb3NlZENoYW5uZWxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlE\nZXF1ZTsKaW1wb3J0IGphdmEudXRpbC5RdWV1ZTsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LkNvbmN1cnJlbnRIYXNoTWFwOwppbXBvcnQgamF2YS51\ndGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9ydCBqYXZhLnV0aWwuY29u\nY3VycmVudC5hdG9taWMuQXRvbWljTG9uZzsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LmxvY2tzLlJlZW50cmFudFJlYWRXcml0ZUxvY2s7CgppbXBv\ncnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlckNsaWVu\ndFN0YXRzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xp\nZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5uZXQuQm9va2llU29ja2V0QWRkcmVzczsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJvdG9jb2wuQWRkUmVxdWVz\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVyUHJvdG9jb2wuQWRkUmVzcG9uc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLkJLUGFja2V0SGVh\nZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJQcm90b2NvbC5PcGVyYXRpb25UeXBlOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5Qcm90b2Nv\nbFZlcnNpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXF1ZXN0OwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJQcm90b2NvbC5SZWFk\nUmVzcG9uc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2tlZXBlclByb3RvY29sLlJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlc3BvbnNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVw\nZXJQcm90b2NvbC5TdGF0dXNDb2RlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5HZW5l\ncmljQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLlJlYWRFbnRyeUNhbGxi\nYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tr\nZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5Xcml0ZUNhbGxiYWNrOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnN0YXRzLk51bGxTdGF0c0xvZ2dlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5zdGF0cy5TdGF0c0xvZ2dl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5zdGF0cy5PcFN0YXRz\nTG9nZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuTWF0\naFV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuT3Jk\nZXJlZFNhZmVFeGVjdXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci51dGlsLlNhZmVSdW5uYWJsZTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5i\nb290c3RyYXAuQ2xpZW50Qm9vdHN0cmFwOwppbXBvcnQgb3JnLmpib3NzLm5l\ndHR5LmJ1ZmZlci5DaGFubmVsQnVmZmVyOwppbXBvcnQgb3JnLmpib3NzLm5l\ndHR5LmJ1ZmZlci5DaGFubmVsQnVmZmVyczsKaW1wb3J0IG9yZy5qYm9zcy5u\nZXR0eS5jaGFubmVsLkNoYW5uZWw7CmltcG9ydCBvcmcuamJvc3MubmV0dHku\nY2hhbm5lbC5DaGFubmVsRnV0dXJlOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5\nLmNoYW5uZWwuQ2hhbm5lbEZ1dHVyZUxpc3RlbmVyOwppbXBvcnQgb3JnLmpi\nb3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbEhhbmRsZXJDb250ZXh0OwppbXBv\ncnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbFBpcGVsaW5lOwpp\nbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hhbm5lbFBpcGVsaW5l\nRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5u\nZWxTdGF0ZUV2ZW50OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwu\nQ2hhbm5lbHM7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5FeGNl\ncHRpb25FdmVudDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLk1l\nc3NhZ2VFdmVudDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLlNp\nbXBsZUNoYW5uZWxIYW5kbGVyOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNo\nYW5uZWwuc29ja2V0LkNsaWVudFNvY2tldENoYW5uZWxGYWN0b3J5OwppbXBv\ncnQgb3JnLmpib3NzLm5ldHR5LmhhbmRsZXIuY29kZWMuZnJhbWUuQ29ycnVw\ndGVkRnJhbWVFeGNlcHRpb247CmltcG9ydCBvcmcuamJvc3MubmV0dHkuaGFu\nZGxlci5jb2RlYy5mcmFtZS5MZW5ndGhGaWVsZEJhc2VkRnJhbWVEZWNvZGVy\nOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmhhbmRsZXIuY29kZWMuZnJhbWUu\nTGVuZ3RoRmllbGRQcmVwZW5kZXI7CmltcG9ydCBvcmcuamJvc3MubmV0dHku\naGFuZGxlci5jb2RlYy5mcmFtZS5Ub29Mb25nRnJhbWVFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuamJvc3MubmV0dHkuaGFuZGxlci50aW1lb3V0LlJlYWRUaW1l\nb3V0SGFuZGxlcjsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS51dGlsLkhhc2hl\nZFdoZWVsVGltZXI7CmltcG9ydCBvcmcuamJvc3MubmV0dHkudXRpbC5UaW1l\nb3V0OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LnV0aWwuVGltZXJUYXNrOwpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwoKLyoqCiAqIFRoaXMgY2xhc3MgbWFuYWdlcyBhbGwgZGV0\nYWlscyBvZiBjb25uZWN0aW9uIHRvIGEgcGFydGljdWxhciBib29raWUuIEl0\nIGFsc28KICogaGFzIHJlY29ubmVjdCBsb2dpYyBpZiBhIGNvbm5lY3Rpb24g\ndG8gYSBib29raWUgZmFpbHMuCiAqCiAqLwpwdWJsaWMgY2xhc3MgUGVyQ2hh\nbm5lbEJvb2tpZUNsaWVudCBleHRlbmRzIFNpbXBsZUNoYW5uZWxIYW5kbGVy\nIGltcGxlbWVudHMgQ2hhbm5lbFBpcGVsaW5lRmFjdG9yeSB7CgogICAgc3Rh\ndGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dl\ncihQZXJDaGFubmVsQm9va2llQ2xpZW50LmNsYXNzKTsKCiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIGludCBNQVhfRlJBTUVfTEVOR1RIID0gMiAqIDEwMjQg\nKiAxMDI0OyAvLyAyTQogICAgcHVibGljIHN0YXRpYyBmaW5hbCBBdG9taWNM\nb25nIHR4bklkR2VuZXJhdG9yID0gbmV3IEF0b21pY0xvbmcoMCk7CgogICAg\nZmluYWwgQm9va2llU29ja2V0QWRkcmVzcyBhZGRyOwogICAgZmluYWwgQ2xp\nZW50U29ja2V0Q2hhbm5lbEZhY3RvcnkgY2hhbm5lbEZhY3Rvcnk7CiAgICBm\naW5hbCBPcmRlcmVkU2FmZUV4ZWN1dG9yIGV4ZWN1dG9yOwogICAgZmluYWwg\nSGFzaGVkV2hlZWxUaW1lciByZXF1ZXN0VGltZXI7CiAgICBmaW5hbCBpbnQg\nYWRkRW50cnlUaW1lb3V0OwogICAgZmluYWwgaW50IHJlYWRFbnRyeVRpbWVv\ndXQ7CgogICAgcHJpdmF0ZSBmaW5hbCBDb25jdXJyZW50SGFzaE1hcDxDb21w\nbGV0aW9uS2V5LCBDb21wbGV0aW9uVmFsdWU+IGNvbXBsZXRpb25PYmplY3Rz\nID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPENvbXBsZXRpb25LZXksIENvbXBs\nZXRpb25WYWx1ZT4oKTsKCiAgICBwcml2YXRlIGZpbmFsIFN0YXRzTG9nZ2Vy\nIHN0YXRzTG9nZ2VyOwogICAgcHJpdmF0ZSBmaW5hbCBPcFN0YXRzTG9nZ2Vy\nIHJlYWRFbnRyeU9wTG9nZ2VyOwogICAgcHJpdmF0ZSBmaW5hbCBPcFN0YXRz\nTG9nZ2VyIHJlYWRUaW1lb3V0T3BMb2dnZXI7CiAgICBwcml2YXRlIGZpbmFs\nIE9wU3RhdHNMb2dnZXIgYWRkRW50cnlPcExvZ2dlcjsKICAgIHByaXZhdGUg\nZmluYWwgT3BTdGF0c0xvZ2dlciBhZGRUaW1lb3V0T3BMb2dnZXI7CgogICAg\nLyoqCiAgICAgKiBUaGUgZm9sbG93aW5nIG1lbWJlciB2YXJpYWJsZXMgZG8g\nbm90IG5lZWQgdG8gYmUgY29uY3VycmVudCwgb3Igdm9sYXRpbGUKICAgICAq\nIGJlY2F1c2UgdGhleSBhcmUgYWx3YXlzIHVwZGF0ZWQgdW5kZXIgYSBsb2Nr\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9sYXRpbGUgUXVldWU8R2VuZXJpY0Nh\nbGxiYWNrPFBlckNoYW5uZWxCb29raWVDbGllbnQ+PiBwZW5kaW5nT3BzID0K\nICAgICAgICAgICAgbmV3IEFycmF5RGVxdWU8R2VuZXJpY0NhbGxiYWNrPFBl\nckNoYW5uZWxCb29raWVDbGllbnQ+PigpOwogICAgdm9sYXRpbGUgQ2hhbm5l\nbCBjaGFubmVsID0gbnVsbDsKCiAgICBlbnVtIENvbm5lY3Rpb25TdGF0ZSB7\nCiAgICAgICAgRElTQ09OTkVDVEVELCBDT05ORUNUSU5HLCBDT05ORUNURUQs\nIENMT1NFRAogICAgfQoKICAgIHZvbGF0aWxlIENvbm5lY3Rpb25TdGF0ZSBz\ndGF0ZTsKICAgIGZpbmFsIFJlZW50cmFudFJlYWRXcml0ZUxvY2sgY2xvc2VM\nb2NrID0gbmV3IFJlZW50cmFudFJlYWRXcml0ZUxvY2soKTsKICAgIHByaXZh\ndGUgZmluYWwgQ2xpZW50Q29uZmlndXJhdGlvbiBjb25mOwoKICAgIHB1Ymxp\nYyBQZXJDaGFubmVsQm9va2llQ2xpZW50KE9yZGVyZWRTYWZlRXhlY3V0b3Ig\nZXhlY3V0b3IsIENsaWVudFNvY2tldENoYW5uZWxGYWN0b3J5IGNoYW5uZWxG\nYWN0b3J5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQm9v\na2llU29ja2V0QWRkcmVzcyBhZGRyKSB7CiAgICAgICAgdGhpcyhuZXcgQ2xp\nZW50Q29uZmlndXJhdGlvbigpLCBleGVjdXRvciwgY2hhbm5lbEZhY3Rvcnks\nIGFkZHIsIG51bGwsIE51bGxTdGF0c0xvZ2dlci5JTlNUQU5DRSk7CiAgICB9\nCgogICAgcHVibGljIFBlckNoYW5uZWxCb29raWVDbGllbnQoQ2xpZW50Q29u\nZmlndXJhdGlvbiBjb25mLCBPcmRlcmVkU2FmZUV4ZWN1dG9yIGV4ZWN1dG9y\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2xpZW50U29j\na2V0Q2hhbm5lbEZhY3RvcnkgY2hhbm5lbEZhY3RvcnksIEJvb2tpZVNvY2tl\ndEFkZHJlc3MgYWRkciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEhhc2hlZFdoZWVsVGltZXIgcmVxdWVzdFRpbWVyLCBTdGF0c0xvZ2dl\nciBwYXJlbnRTdGF0c0xvZ2dlcikgewogICAgICAgIHRoaXMuY29uZiA9IGNv\nbmY7CiAgICAgICAgdGhpcy5hZGRyID0gYWRkcjsKICAgICAgICB0aGlzLmV4\nZWN1dG9yID0gZXhlY3V0b3I7CiAgICAgICAgdGhpcy5jaGFubmVsRmFjdG9y\neSA9IGNoYW5uZWxGYWN0b3J5OwogICAgICAgIHRoaXMuc3RhdGUgPSBDb25u\nZWN0aW9uU3RhdGUuRElTQ09OTkVDVEVEOwogICAgICAgIHRoaXMucmVxdWVz\ndFRpbWVyID0gcmVxdWVzdFRpbWVyOwogICAgICAgIHRoaXMuYWRkRW50cnlU\naW1lb3V0ID0gY29uZi5nZXRBZGRFbnRyeVRpbWVvdXQoKTsKICAgICAgICB0\naGlzLnJlYWRFbnRyeVRpbWVvdXQgPSBjb25mLmdldFJlYWRFbnRyeVRpbWVv\ndXQoKTsKCiAgICAgICAgU3RyaW5nQnVpbGRlciBuYW1lQnVpbGRlciA9IG5l\ndyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgbmFtZUJ1aWxkZXIuYXBwZW5k\nKGFkZHIuZ2V0SG9zdG5hbWUoKS5yZXBsYWNlKCcuJywgJ18nKS5yZXBsYWNl\nKCctJywgJ18nKSkKICAgICAgICAgICAgLmFwcGVuZCgiXyIpLmFwcGVuZChh\nZGRyLmdldFBvcnQoKSk7CgogICAgICAgIHRoaXMuc3RhdHNMb2dnZXIgPSBw\nYXJlbnRTdGF0c0xvZ2dlci5zY29wZShCb29rS2VlcGVyQ2xpZW50U3RhdHMu\nQ0hBTk5FTF9TQ09QRSkKICAgICAgICAgICAgLnNjb3BlKG5hbWVCdWlsZGVy\nLnRvU3RyaW5nKCkpOwoKICAgICAgICByZWFkRW50cnlPcExvZ2dlciA9IHN0\nYXRzTG9nZ2VyLmdldE9wU3RhdHNMb2dnZXIoQm9va0tlZXBlckNsaWVudFN0\nYXRzLkNIQU5ORUxfUkVBRF9PUCk7CiAgICAgICAgYWRkRW50cnlPcExvZ2dl\nciA9IHN0YXRzTG9nZ2VyLmdldE9wU3RhdHNMb2dnZXIoQm9va0tlZXBlckNs\naWVudFN0YXRzLkNIQU5ORUxfQUREX09QKTsKICAgICAgICByZWFkVGltZW91\ndE9wTG9nZ2VyID0gc3RhdHNMb2dnZXIuZ2V0T3BTdGF0c0xvZ2dlcihCb29r\nS2VlcGVyQ2xpZW50U3RhdHMuQ0hBTk5FTF9USU1FT1VUX1JFQUQpOwogICAg\nICAgIGFkZFRpbWVvdXRPcExvZ2dlciA9IHN0YXRzTG9nZ2VyLmdldE9wU3Rh\ndHNMb2dnZXIoQm9va0tlZXBlckNsaWVudFN0YXRzLkNIQU5ORUxfVElNRU9V\nVF9BREQpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBjb21wbGV0ZU9wZXJh\ndGlvbihHZW5lcmljQ2FsbGJhY2s8UGVyQ2hhbm5lbEJvb2tpZUNsaWVudD4g\nb3AsIGludCByYykgewogICAgICAgIGNsb3NlTG9jay5yZWFkTG9jaygpLmxv\nY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoQ29ubmVjdGlv\nblN0YXRlLkNMT1NFRCA9PSBzdGF0ZSkgewogICAgICAgICAgICAgICAgb3Au\nb3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5DbGllbnRDbG9z\nZWRFeGNlcHRpb24sIHRoaXMpOwogICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgb3Aub3BlcmF0aW9uQ29tcGxldGUocmMsIHRoaXMpOwog\nICAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nY2xvc2VMb2NrLnJlYWRMb2NrKCkudW5sb2NrKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBjb25uZWN0KCkgewogICAgICAgIExPRy5k\nZWJ1ZygiQ29ubmVjdGluZyB0byBib29raWU6IHt9IiwgYWRkcik7CgogICAg\nICAgIC8vIFNldCB1cCB0aGUgQ2xpZW50Qm9vdFN0cmFwIHNvIHdlIGNhbiBj\ncmVhdGUgYSBuZXcgQ2hhbm5lbCBjb25uZWN0aW9uCiAgICAgICAgLy8gdG8g\ndGhlIGJvb2tpZS4KICAgICAgICBDbGllbnRCb290c3RyYXAgYm9vdHN0cmFw\nID0gbmV3IENsaWVudEJvb3RzdHJhcChjaGFubmVsRmFjdG9yeSk7CiAgICAg\nICAgYm9vdHN0cmFwLnNldFBpcGVsaW5lRmFjdG9yeSh0aGlzKTsKICAgICAg\nICBib290c3RyYXAuc2V0T3B0aW9uKCJ0Y3BOb0RlbGF5IiwgY29uZi5nZXRD\nbGllbnRUY3BOb0RlbGF5KCkpOwogICAgICAgIGJvb3RzdHJhcC5zZXRPcHRp\nb24oImtlZXBBbGl2ZSIsIHRydWUpOwoKICAgICAgICBDaGFubmVsRnV0dXJl\nIGZ1dHVyZSA9IGJvb3RzdHJhcC5jb25uZWN0KGFkZHIuZ2V0U29ja2V0QWRk\ncmVzcygpKTsKICAgICAgICBmdXR1cmUuYWRkTGlzdGVuZXIobmV3IENoYW5u\nZWxGdXR1cmVMaXN0ZW5lcigpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBsZXRlKENoYW5u\nZWxGdXR1cmUgZnV0dXJlKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgICAgIExPRy5kZWJ1ZygiQ2hhbm5lbCBjb25uZWN0ZWQgKHt9KSB7fSIs\nIGZ1dHVyZS5pc1N1Y2Nlc3MoKSwgZnV0dXJlLmdldENoYW5uZWwoKSk7CiAg\nICAgICAgICAgICAgICBpbnQgcmM7CiAgICAgICAgICAgICAgICBRdWV1ZTxH\nZW5lcmljQ2FsbGJhY2s8UGVyQ2hhbm5lbEJvb2tpZUNsaWVudD4+IG9sZFBl\nbmRpbmdPcHM7CgogICAgICAgICAgICAgICAgc3luY2hyb25pemVkIChQZXJD\naGFubmVsQm9va2llQ2xpZW50LnRoaXMpIHsKICAgICAgICAgICAgICAgICAg\nICBpZiAoZnV0dXJlLmlzU3VjY2VzcygpICYmIHN0YXRlID09IENvbm5lY3Rp\nb25TdGF0ZS5DT05ORUNUSU5HKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy5pbmZvKCJTdWNjZXNzZnVsbHkgY29ubmVjdGVkIHRvIGJvb2tpZTog\ne30iLCBmdXR1cmUuZ2V0Q2hhbm5lbCgpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcmMgPSBCS0V4Y2VwdGlvbi5Db2RlLk9LOwogICAgICAgICAgICAg\nICAgICAgICAgICBjaGFubmVsID0gZnV0dXJlLmdldENoYW5uZWwoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBDb25uZWN0aW9uU3RhdGUu\nQ09OTkVDVEVEOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZnV0\ndXJlLmlzU3VjY2VzcygpICYmIChzdGF0ZSA9PSBDb25uZWN0aW9uU3RhdGUu\nQ0xPU0VECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHx8IHN0YXRlID09IENvbm5lY3Rpb25TdGF0ZS5E\nSVNDT05ORUNURUQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy53\nYXJuKCJDbG9zZWQgYmVmb3JlIGNvbm5lY3Rpb24gY29tcGxldGVkLCBjbGVh\nbiB1cDoge30sIGN1cnJlbnQgc3RhdGUge30iLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBmdXR1cmUuZ2V0Q2hhbm5lbCgpLCBzdGF0ZSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQ2hhbm5lbChmdXR1cmUu\nZ2V0Q2hhbm5lbCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSBC\nS0V4Y2VwdGlvbi5Db2RlLkJvb2tpZUhhbmRsZU5vdEF2YWlsYWJsZUV4Y2Vw\ndGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbCA9IG51bGw7\nCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmdXR1cmUuaXNTdWNj\nZXNzKCkgJiYgc3RhdGUgPT0gQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RFRCkg\newogICAgICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoIkFscmVhZHkg\nY29ubmVjdGVkIHdpdGggYW5vdGhlciBjaGFubmVsKHt9KSwgc28gY2xvc2Ug\ndGhlIG5ldyBjaGFubmVsKHt9KSIsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjaGFubmVsLCBmdXR1cmUuZ2V0Q2hhbm5lbCgpKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgY2xvc2VDaGFubmVsKGZ1dHVyZS5nZXRD\naGFubmVsKCkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8v\nIHBlbmRpbmdPcHMgc2hvdWxkIGhhdmUgYmVlbiBjb21wbGV0ZWQgd2hlbiBv\ndGhlciBjaGFubmVsIGNvbm5lY3RlZAogICAgICAgICAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiQ291\nbGQgbm90IGNvbm5lY3QgdG8gYm9va2llOiB7fS97fSwgY3VycmVudCBzdGF0\nZSB7fSA6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBu\nZXcgT2JqZWN0W10geyBmdXR1cmUuZ2V0Q2hhbm5lbCgpLCBhZGRyLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nc3RhdGUsIGZ1dHVyZS5nZXRDYXVzZSgpIH0pOwogICAgICAgICAgICAgICAg\nICAgICAgICByYyA9IEJLRXhjZXB0aW9uLkNvZGUuQm9va2llSGFuZGxlTm90\nQXZhaWxhYmxlRXhjZXB0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBj\nbG9zZUNoYW5uZWwoZnV0dXJlLmdldENoYW5uZWwoKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGNoYW5uZWwgPSBudWxsOwogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoc3RhdGUgIT0gQ29ubmVjdGlvblN0YXRlLkNMT1NFRCkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBDb25uZWN0\naW9uU3RhdGUuRElTQ09OTkVDVEVEOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAg\nICAvLyB0cmljayB0byBub3QgZG8gb3BlcmF0aW9ucyB1bmRlciB0aGUgbG9j\naywgdGFrZSB0aGUgbGlzdAogICAgICAgICAgICAgICAgICAgIC8vIG9mIHBl\nbmRpbmcgb3BzIGFuZCBhc3NpZ24gaXQgdG8gYSBuZXcgdmFyaWFibGUsIHdo\naWxlCiAgICAgICAgICAgICAgICAgICAgLy8gZW1wdHlpbmcgdGhlIHBlbmRp\nbmcgb3BzIGJ5IGp1c3QgYXNzaWduaW5nIGl0IHRvIGEgbmV3CiAgICAgICAg\nICAgICAgICAgICAgLy8gbGlzdAogICAgICAgICAgICAgICAgICAgIG9sZFBl\nbmRpbmdPcHMgPSBwZW5kaW5nT3BzOwogICAgICAgICAgICAgICAgICAgIHBl\nbmRpbmdPcHMgPSBuZXcgQXJyYXlEZXF1ZTxHZW5lcmljQ2FsbGJhY2s8UGVy\nQ2hhbm5lbEJvb2tpZUNsaWVudD4+KCk7CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgZm9yIChHZW5lcmljQ2FsbGJhY2s8UGVyQ2hhbm5l\nbEJvb2tpZUNsaWVudD4gcGVuZGluZ09wIDogb2xkUGVuZGluZ09wcykgewog\nICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlT3BlcmF0aW9uKHBlbmRpbmdP\ncCwgcmMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfSk7CiAgICB9CgogICAgdm9pZCBjb25uZWN0SWZOZWVkZWRBbmREb09w\nKEdlbmVyaWNDYWxsYmFjazxQZXJDaGFubmVsQm9va2llQ2xpZW50PiBvcCkg\newogICAgICAgIGJvb2xlYW4gY29tcGxldGVPcE5vdyA9IGZhbHNlOwogICAg\nICAgIGludCBvcFJjID0gQktFeGNlcHRpb24uQ29kZS5PSzsKICAgICAgICAv\nLyBjb21tb24gY2FzZSB3aXRob3V0IGxvY2sgZmlyc3QKICAgICAgICBpZiAo\nY2hhbm5lbCAhPSBudWxsICYmIHN0YXRlID09IENvbm5lY3Rpb25TdGF0ZS5D\nT05ORUNURUQpIHsKICAgICAgICAgICAgY29tcGxldGVPcE5vdyA9IHRydWU7\nCiAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgIHN5bmNocm9uaXplZCAo\ndGhpcykgewogICAgICAgICAgICAgICAgLy8gY2hlY2sgdGhlIGNoYW5uZWwg\nc3RhdHVzIGFnYWluIHVuZGVyIGxvY2sKICAgICAgICAgICAgICAgIGlmIChj\naGFubmVsICE9IG51bGwgJiYgc3RhdGUgPT0gQ29ubmVjdGlvblN0YXRlLkNP\nTk5FQ1RFRCkgewogICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlT3BOb3cg\nPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIG9wUmMgPSBCS0V4Y2VwdGlv\nbi5Db2RlLk9LOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9\nPSBDb25uZWN0aW9uU3RhdGUuQ0xPU0VEKSB7CiAgICAgICAgICAgICAgICAg\nICAgY29tcGxldGVPcE5vdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAg\nb3BSYyA9IEJLRXhjZXB0aW9uLkNvZGUuQm9va2llSGFuZGxlTm90QXZhaWxh\nYmxlRXhjZXB0aW9uOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAvLyBjaGFubmVsIGlzIGVpdGhlciBudWxsIChmaXJz\ndCBjb25uZWN0aW9uIGF0dGVtcHQpLCBvciB0aGUKICAgICAgICAgICAgICAg\nICAgICAvLyBjaGFubmVsIGlzIGRpc2Nvbm5lY3RlZC4gQ29ubmVjdGlvbiBh\ndHRlbXB0IGlzIHN0aWxsIGluCiAgICAgICAgICAgICAgICAgICAgLy8gcHJv\nZ3Jlc3MsIHF1ZXVlIHVwIHRoaXMgb3AuIE9wIHdpbGwgYmUgZXhlY3V0ZWQg\nd2hlbgogICAgICAgICAgICAgICAgICAgIC8vIGNvbm5lY3Rpb24gYXR0ZW1w\ndCBlaXRoZXIgZmFpbHMgb3Igc3VjY2VlZHMKICAgICAgICAgICAgICAgICAg\nICBwZW5kaW5nT3BzLmFkZChvcCk7CgogICAgICAgICAgICAgICAgICAgIGlm\nIChzdGF0ZSA9PSBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVElORykgewogICAg\nICAgICAgICAgICAgICAgICAgICAvLyBqdXN0IHJldHVybiBhcyBjb25uZWN0\naW9uIHJlcXVlc3QgaGFzIGFscmVhZHkgc2VuZAogICAgICAgICAgICAgICAg\nICAgICAgICAvLyBhbmQgd2FpdGluZyBmb3IgdGhlIHJlc3BvbnNlLgogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIC8vIHN3aXRjaCBzdGF0ZSB0byBj\nb25uZWN0aW5nIGFuZCBkbyBjb25uZWN0aW9uIGF0dGVtcHQKICAgICAgICAg\nICAgICAgICAgICBzdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNUSU5H\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGlmICghY29tcGxldGVPcE5vdykgewogICAgICAgICAgICAgICAgLy8gU3Rh\ncnQgY29ubmVjdGlvbiBhdHRlbXB0IHRvIHRoZSBpbnB1dCBzZXJ2ZXIgaG9z\ndC4KICAgICAgICAgICAgICAgIGNvbm5lY3QoKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaWYgKGNvbXBsZXRlT3BOb3cpIHsKICAgICAg\nICAgICAgY29tcGxldGVPcGVyYXRpb24ob3AsIG9wUmMpOwogICAgICAgIH0K\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBzaG91bGQgYmUg\nY2FsbGVkIG9ubHkgYWZ0ZXIgY29ubmVjdGlvbiBoYXMgYmVlbiBjaGVja2Vk\nIGZvcgogICAgICoge0BsaW5rICNjb25uZWN0SWZOZWVkZWRBbmREb09wKEdl\nbmVyaWNDYWxsYmFjayl9CiAgICAgKgogICAgICogQHBhcmFtIGxlZGdlcklk\nCiAgICAgKiAgICAgICAgICBMZWRnZXIgSWQKICAgICAqIEBwYXJhbSBtYXN0\nZXJLZXkKICAgICAqICAgICAgICAgIE1hc3RlciBLZXkKICAgICAqIEBwYXJh\nbSBlbnRyeUlkCiAgICAgKiAgICAgICAgICBFbnRyeSBJZAogICAgICogQHBh\ncmFtIHRvU2VuZAogICAgICogICAgICAgICAgQnVmZmVyIHRvIHNlbmQKICAg\nICAqIEBwYXJhbSBjYgogICAgICogICAgICAgICAgV3JpdGUgY2FsbGJhY2sK\nICAgICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgIFdyaXRlIGNhbGxi\nYWNrIGNvbnRleHQKICAgICAqIEBwYXJhbSBvcHRpb25zCiAgICAgKiAgICAg\nICAgICBBZGQgb3B0aW9ucwogICAgICovCiAgICB2b2lkIGFkZEVudHJ5KGZp\nbmFsIGxvbmcgbGVkZ2VySWQsIGJ5dGVbXSBtYXN0ZXJLZXksIGZpbmFsIGxv\nbmcgZW50cnlJZCwgQ2hhbm5lbEJ1ZmZlciB0b1NlbmQsIFdyaXRlQ2FsbGJh\nY2sgY2IsCiAgICAgICAgICAgICAgICAgIE9iamVjdCBjdHgsIGZpbmFsIGlu\ndCBvcHRpb25zKSB7CiAgICAgICAgZmluYWwgbG9uZyB0eG5JZCA9IGdldFR4\nbklkKCk7CiAgICAgICAgZmluYWwgaW50IGVudHJ5U2l6ZSA9IHRvU2VuZC5y\nZWFkYWJsZUJ5dGVzKCk7CiAgICAgICAgZmluYWwgQ29tcGxldGlvbktleSBj\nb21wbGV0aW9uS2V5ID0gbmV3IENvbXBsZXRpb25LZXkodHhuSWQsIE9wZXJh\ndGlvblR5cGUuQUREX0VOVFJZKTsKICAgICAgICBjb21wbGV0aW9uT2JqZWN0\ncy5wdXQoY29tcGxldGlvbktleSwKICAgICAgICAgICAgICAgIG5ldyBBZGRD\nb21wbGV0aW9uKGFkZEVudHJ5T3BMb2dnZXIsIGNiLCBjdHgsIGxlZGdlcklk\nLCBlbnRyeUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nc2NoZWR1bGVUaW1lb3V0KGNvbXBsZXRpb25LZXksIGFkZEVudHJ5VGltZW91\ndCkpKTsKCiAgICAgICAgLy8gQnVpbGQgdGhlIHJlcXVlc3QgYW5kIGNhbGN1\nbGF0ZSB0aGUgdG90YWwgc2l6ZSB0byBiZSBpbmNsdWRlZCBpbiB0aGUgcGFj\na2V0LgogICAgICAgIEJLUGFja2V0SGVhZGVyLkJ1aWxkZXIgaGVhZGVyQnVp\nbGRlciA9IEJLUGFja2V0SGVhZGVyLm5ld0J1aWxkZXIoKQogICAgICAgICAg\nICAgICAgLnNldFZlcnNpb24oUHJvdG9jb2xWZXJzaW9uLlZFUlNJT05fVEhS\nRUUpCiAgICAgICAgICAgICAgICAuc2V0T3BlcmF0aW9uKE9wZXJhdGlvblR5\ncGUuQUREX0VOVFJZKQogICAgICAgICAgICAgICAgLnNldFR4bklkKHR4bklk\nKTsKCiAgICAgICAgQWRkUmVxdWVzdC5CdWlsZGVyIGFkZEJ1aWxkZXIgPSBB\nZGRSZXF1ZXN0Lm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgLnNldExl\nZGdlcklkKGxlZGdlcklkKQogICAgICAgICAgICAgICAgLnNldEVudHJ5SWQo\nZW50cnlJZCkKICAgICAgICAgICAgICAgIC5zZXRNYXN0ZXJLZXkoQnl0ZVN0\ncmluZy5jb3B5RnJvbShtYXN0ZXJLZXkpKQogICAgICAgICAgICAgICAgLnNl\ndEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJvbSh0b1NlbmQudG9CeXRlQnVmZmVy\nKCkpKTsKCiAgICAgICAgaWYgKCgoc2hvcnQpb3B0aW9ucyAmIEJvb2tpZVBy\nb3RvY29sLkZMQUdfUkVDT1ZFUllfQUREKSA9PSBCb29raWVQcm90b2NvbC5G\nTEFHX1JFQ09WRVJZX0FERCkgewogICAgICAgICAgICBhZGRCdWlsZGVyLnNl\ndEZsYWcoQWRkUmVxdWVzdC5GbGFnLlJFQ09WRVJZX0FERCk7CiAgICAgICAg\nfQoKICAgICAgICBmaW5hbCBSZXF1ZXN0IGFkZFJlcXVlc3QgPSBSZXF1ZXN0\nLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgLnNldEhlYWRlcihoZWFk\nZXJCdWlsZGVyKQogICAgICAgICAgICAgICAgLnNldEFkZFJlcXVlc3QoYWRk\nQnVpbGRlcikKICAgICAgICAgICAgICAgIC5idWlsZCgpOwoKICAgICAgICBm\naW5hbCBDaGFubmVsIGMgPSBjaGFubmVsOwogICAgICAgIGlmIChjID09IG51\nbGwpIHsKICAgICAgICAgICAgZXJyb3JPdXRBZGRLZXkoY29tcGxldGlvbktl\neSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgQ2hhbm5lbEZ1dHVyZSBmdXR1cmUgPSBjLndyaXRl\nKGFkZFJlcXVlc3QpOwogICAgICAgICAgICBmdXR1cmUuYWRkTGlzdGVuZXIo\nbmV3IENoYW5uZWxGdXR1cmVMaXN0ZW5lcigpIHsKICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uQ29tcGxldGUoQ2hhbm5lbEZ1dHVyZSBmdXR1cmUpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgICAgIGlmIChmdXR1cmUuaXNTdWNj\nZXNzKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKExPRy5pc0Rl\nYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBM\nT0cuZGVidWcoIlN1Y2Nlc3NmdWxseSB3cm90ZSByZXF1ZXN0IGZvciBhZGRp\nbmcgZW50cnk6ICIgKyBlbnRyeUlkICsgIiBsZWRnZXItaWQ6ICIgKyBsZWRn\nZXJJZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArICIgYm9va2llOiAiICsgYy5nZXRSZW1v\ndGVBZGRyZXNzKCkgKyAiIGVudHJ5IGxlbmd0aDogIiArIGVudHJ5U2l6ZSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gdG90YWxCeXRlc091dHN0YW5kaW5nLmFkZEFuZEdldChlbnRy\neVNpemUpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmICghKGZ1dHVyZS5nZXRDYXVzZSgpIGluc3Rh\nbmNlb2YgQ2xvc2VkQ2hhbm5lbEV4Y2VwdGlvbikpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIExPRy53YXJuKCJXcml0aW5nIGFkZEVudHJ5KGxp\nZD17fSwgZWlkPXt9KSB0byBjaGFubmVsIHt9IGZhaWxlZCA6ICIsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBPYmplY3RbXSB7\nIGxlZGdlcklkLCBlbnRyeUlkLCBjLCBmdXR1cmUuZ2V0Q2F1c2UoKSB9KTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nICAgICBlcnJvck91dEFkZEtleShjb21wbGV0aW9uS2V5KTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0p\nOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSBlKSB7CiAgICAgICAgICAg\nIExPRy53YXJuKCJBZGQgZW50cnkgb3BlcmF0aW9uIGZhaWxlZCIsIGUpOwog\nICAgICAgICAgICBlcnJvck91dEFkZEtleShjb21wbGV0aW9uS2V5KTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVhZEVudHJ5QW5kRmVu\nY2VMZWRnZXIoZmluYWwgbG9uZyBsZWRnZXJJZCwgYnl0ZVtdIG1hc3Rlcktl\neSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZp\nbmFsIGxvbmcgZW50cnlJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIFJlYWRFbnRyeUNhbGxiYWNrIGNiLCBPYmplY3QgY3R4\nKSB7CiAgICAgICAgZmluYWwgbG9uZyB0eG5JZCA9IGdldFR4bklkKCk7CiAg\nICAgICAgZmluYWwgQ29tcGxldGlvbktleSBjb21wbGV0aW9uS2V5ID0gbmV3\nIENvbXBsZXRpb25LZXkodHhuSWQsIE9wZXJhdGlvblR5cGUuUkVBRF9FTlRS\nWSk7CiAgICAgICAgY29tcGxldGlvbk9iamVjdHMucHV0KGNvbXBsZXRpb25L\nZXksCiAgICAgICAgICAgICAgICBuZXcgUmVhZENvbXBsZXRpb24ocmVhZEVu\ndHJ5T3BMb2dnZXIsIGNiLCBjdHgsIGxlZGdlcklkLCBlbnRyeUlkLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlVGltZW91\ndChjb21wbGV0aW9uS2V5LCByZWFkRW50cnlUaW1lb3V0KSkpOwoKICAgICAg\nICAvLyBCdWlsZCB0aGUgcmVxdWVzdCBhbmQgY2FsY3VsYXRlIHRoZSB0b3Rh\nbCBzaXplIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBwYWNrZXQuCiAgICAgICAg\nQktQYWNrZXRIZWFkZXIuQnVpbGRlciBoZWFkZXJCdWlsZGVyID0gQktQYWNr\nZXRIZWFkZXIubmV3QnVpbGRlcigpCiAgICAgICAgICAgICAgICAuc2V0VmVy\nc2lvbihQcm90b2NvbFZlcnNpb24uVkVSU0lPTl9USFJFRSkKICAgICAgICAg\nICAgICAgIC5zZXRPcGVyYXRpb24oT3BlcmF0aW9uVHlwZS5SRUFEX0VOVFJZ\nKQogICAgICAgICAgICAgICAgLnNldFR4bklkKHR4bklkKTsKCiAgICAgICAg\nUmVhZFJlcXVlc3QuQnVpbGRlciByZWFkQnVpbGRlciA9IFJlYWRSZXF1ZXN0\nLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgLnNldExlZGdlcklkKGxl\nZGdlcklkKQogICAgICAgICAgICAgICAgLnNldEVudHJ5SWQoZW50cnlJZCkK\nICAgICAgICAgICAgICAgIC5zZXRNYXN0ZXJLZXkoQnl0ZVN0cmluZy5jb3B5\nRnJvbShtYXN0ZXJLZXkpKQogICAgICAgICAgICAgICAgLnNldEZsYWcoUmVh\nZFJlcXVlc3QuRmxhZy5GRU5DRV9MRURHRVIpOwoKICAgICAgICBmaW5hbCBS\nZXF1ZXN0IHJlYWRSZXF1ZXN0ID0gUmVxdWVzdC5uZXdCdWlsZGVyKCkKICAg\nICAgICAgICAgICAgIC5zZXRIZWFkZXIoaGVhZGVyQnVpbGRlcikKICAgICAg\nICAgICAgICAgIC5zZXRSZWFkUmVxdWVzdChyZWFkQnVpbGRlcikKICAgICAg\nICAgICAgICAgIC5idWlsZCgpOwoKICAgICAgICBmaW5hbCBDaGFubmVsIGMg\nPSBjaGFubmVsOwogICAgICAgIGlmIChjID09IG51bGwpIHsKICAgICAgICAg\nICAgZXJyb3JPdXRSZWFkS2V5KGNvbXBsZXRpb25LZXkpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAg\nICBDaGFubmVsRnV0dXJlIGZ1dHVyZSA9IGMud3JpdGUocmVhZFJlcXVlc3Qp\nOwogICAgICAgICAgICBmdXR1cmUuYWRkTGlzdGVuZXIobmV3IENoYW5uZWxG\ndXR1cmVMaXN0ZW5lcigpIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25D\nb21wbGV0ZShDaGFubmVsRnV0dXJlIGZ1dHVyZSkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmdXR1cmUuaXNTdWNj\nZXNzKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChMT0cu\naXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIExPRy5kZWJ1ZygiU3VjY2Vzc2Z1bGx5IHdyb3RlIHJlcXVlc3Qg\ne30gdG8ge30iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICByZWFkUmVxdWVzdCwgYy5nZXRSZW1vdGVBZGRyZXNzKCkpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKCEoZnV0dXJlLmdldENhdXNlKCkgaW5zdGFuY2VvZiBDbG9zZWRDaGFu\nbmVsRXhjZXB0aW9uKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIExPRy53YXJuKCJXcml0aW5nIHJlYWRFbnRyeUFuZEZlbmNlTGVkZ2Vy\nKGxpZD17fSwgZWlkPXt9KSB0byBjaGFubmVsIHt9IGZhaWxlZCA6ICIsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgT2Jq\nZWN0W10geyBsZWRnZXJJZCwgZW50cnlJZCwgYywgZnV0dXJlLmdldENhdXNl\nKCkgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBlcnJvck91dFJlYWRLZXkoY29tcGxldGlv\nbktleSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9IGNhdGNo\nKFRocm93YWJsZSBlKSB7CiAgICAgICAgICAgIExPRy53YXJuKCJSZWFkIGVu\ndHJ5IG9wZXJhdGlvbiB7fSBmYWlsZWQiLCBjb21wbGV0aW9uS2V5LCBlKTsK\nICAgICAgICAgICAgZXJyb3JPdXRSZWFkS2V5KGNvbXBsZXRpb25LZXkpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWFkRW50cnkoZmlu\nYWwgbG9uZyBsZWRnZXJJZCwgZmluYWwgbG9uZyBlbnRyeUlkLCBSZWFkRW50\ncnlDYWxsYmFjayBjYiwgT2JqZWN0IGN0eCkgewogICAgICAgIGZpbmFsIGxv\nbmcgdHhuSWQgPSBnZXRUeG5JZCgpOwogICAgICAgIGZpbmFsIENvbXBsZXRp\nb25LZXkgY29tcGxldGlvbktleSA9IG5ldyBDb21wbGV0aW9uS2V5KHR4bklk\nLCBPcGVyYXRpb25UeXBlLlJFQURfRU5UUlkpOwogICAgICAgIGNvbXBsZXRp\nb25PYmplY3RzLnB1dChjb21wbGV0aW9uS2V5LAogICAgICAgICAgICAgICAg\nbmV3IFJlYWRDb21wbGV0aW9uKHJlYWRFbnRyeU9wTG9nZ2VyLCBjYiwgY3R4\nLCBsZWRnZXJJZCwgZW50cnlJZCwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBzY2hlZHVsZVRpbWVvdXQoY29tcGxldGlvbktleSwgcmVh\nZEVudHJ5VGltZW91dCkpKTsKCiAgICAgICAgLy8gQnVpbGQgdGhlIHJlcXVl\nc3QgYW5kIGNhbGN1bGF0ZSB0aGUgdG90YWwgc2l6ZSB0byBiZSBpbmNsdWRl\nZCBpbiB0aGUgcGFja2V0LgogICAgICAgIEJLUGFja2V0SGVhZGVyLkJ1aWxk\nZXIgaGVhZGVyQnVpbGRlciA9IEJLUGFja2V0SGVhZGVyLm5ld0J1aWxkZXIo\nKQogICAgICAgICAgICAgICAgLnNldFZlcnNpb24oUHJvdG9jb2xWZXJzaW9u\nLlZFUlNJT05fVEhSRUUpCiAgICAgICAgICAgICAgICAuc2V0T3BlcmF0aW9u\nKE9wZXJhdGlvblR5cGUuUkVBRF9FTlRSWSkKICAgICAgICAgICAgICAgIC5z\nZXRUeG5JZCh0eG5JZCk7CgogICAgICAgIFJlYWRSZXF1ZXN0LkJ1aWxkZXIg\ncmVhZEJ1aWxkZXIgPSBSZWFkUmVxdWVzdC5uZXdCdWlsZGVyKCkKICAgICAg\nICAgICAgICAgIC5zZXRMZWRnZXJJZChsZWRnZXJJZCkKICAgICAgICAgICAg\nICAgIC5zZXRFbnRyeUlkKGVudHJ5SWQpOwoKICAgICAgICBmaW5hbCBSZXF1\nZXN0IHJlYWRSZXF1ZXN0ID0gUmVxdWVzdC5uZXdCdWlsZGVyKCkKICAgICAg\nICAgICAgICAgIC5zZXRIZWFkZXIoaGVhZGVyQnVpbGRlcikKICAgICAgICAg\nICAgICAgIC5zZXRSZWFkUmVxdWVzdChyZWFkQnVpbGRlcikKICAgICAgICAg\nICAgICAgIC5idWlsZCgpOwoKICAgICAgICBmaW5hbCBDaGFubmVsIGMgPSBj\naGFubmVsOwogICAgICAgIGlmIChjID09IG51bGwpIHsKICAgICAgICAgICAg\nZXJyb3JPdXRSZWFkS2V5KGNvbXBsZXRpb25LZXkpOwogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0cnl7CiAgICAgICAgICAgIENo\nYW5uZWxGdXR1cmUgZnV0dXJlID0gYy53cml0ZShyZWFkUmVxdWVzdCk7CiAg\nICAgICAgICAgIGZ1dHVyZS5hZGRMaXN0ZW5lcihuZXcgQ2hhbm5lbEZ1dHVy\nZUxpc3RlbmVyKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShDaGFu\nbmVsRnV0dXJlIGZ1dHVyZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKGZ1dHVyZS5pc1N1Y2Nlc3MoKSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiU3VjY2Vz\nc2Z1bGx5IHdyb3RlIHJlcXVlc3Qge30gdG8ge30iLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRSZXF1ZXN0LCBjLmdldFJl\nbW90ZUFkZHJlc3MoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAoIShmdXR1cmUuZ2V0Q2F1c2UoKSBpbnN0YW5jZW9mIENsb3Nl\nZENoYW5uZWxFeGNlcHRpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBMT0cud2FybigiV3JpdGluZyByZWFkRW50cnkobGlkPXt9LCBlaWQ9\ne30pIHRvIGNoYW5uZWwge30gZmFpbGVkIDogIiwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdIHsgbGVkZ2VySWQs\nIGVudHJ5SWQsIGMsIGZ1dHVyZS5nZXRDYXVzZSgpIH0pOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9y\nT3V0UmVhZEtleShjb21wbGV0aW9uS2V5KTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAg\nIH0gY2F0Y2goVGhyb3dhYmxlIGUpIHsKICAgICAgICAgICAgTE9HLndhcm4o\nIlJlYWQgZW50cnkgb3BlcmF0aW9uIHt9IGZhaWxlZCIsIHJlYWRSZXF1ZXN0\nLCBlKTsKICAgICAgICAgICAgZXJyb3JPdXRSZWFkS2V5KGNvbXBsZXRpb25L\nZXkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERpc2Nvbm5l\nY3RzIHRoZSBib29raWUgY2xpZW50LiBJdCBjYW4gYmUgcmV1c2VkLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBkaXNjb25uZWN0KCkgewogICAgICAgIGRp\nc2Nvbm5lY3QodHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZGlzY29u\nbmVjdChib29sZWFuIHdhaXQpIHsKICAgICAgICBMT0cuaW5mbygiRGlzY29u\nbmVjdGluZyB0aGUgcGVyIGNoYW5uZWwgYm9va2llIGNsaWVudCBmb3Ige30i\nLCBhZGRyKTsKICAgICAgICBjbG9zZUludGVybmFsKGZhbHNlLCB3YWl0KTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENsb3NlcyB0aGUgYm9va2llIGNsaWVu\ndCBwZXJtYW5lbnRseS4gSXQgY2Fubm90IGJlIHJldXNlZC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgY2xvc2UodHJ1ZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgY2xvc2UoYm9vbGVhbiB3YWl0KSB7\nCiAgICAgICAgTE9HLmluZm8oIkNsb3NpbmcgdGhlIHBlciBjaGFubmVsIGJv\nb2tpZSBjbGllbnQgZm9yIHt9IiwgYWRkcik7CiAgICAgICAgY2xvc2VMb2Nr\nLndyaXRlTG9jaygpLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoQ29ubmVjdGlvblN0YXRlLkNMT1NFRCA9PSBzdGF0ZSkgewogICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIHN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkNMT1NFRDsKICAgICAgICAgICAg\nZXJyb3JPdXRPdXRzdGFuZGluZ0VudHJpZXMoQktFeGNlcHRpb24uQ29kZS5D\nbGllbnRDbG9zZWRFeGNlcHRpb24pOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIGNsb3NlTG9jay53cml0ZUxvY2soKS51bmxvY2soKTsKICAg\nICAgICB9CiAgICAgICAgY2xvc2VJbnRlcm5hbCh0cnVlLCB3YWl0KTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgY2xvc2VJbnRlcm5hbChib29sZWFuIHBl\ncm1hbmVudCwgYm9vbGVhbiB3YWl0KSB7CiAgICAgICAgQ2hhbm5lbCB0b0Ns\nb3NlID0gbnVsbDsKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAg\nICAgICAgICAgaWYgKHBlcm1hbmVudCkgewogICAgICAgICAgICAgICAgc3Rh\ndGUgPSBDb25uZWN0aW9uU3RhdGUuQ0xPU0VEOwogICAgICAgICAgICB9IGVs\nc2UgaWYgKHN0YXRlICE9IENvbm5lY3Rpb25TdGF0ZS5DTE9TRUQpIHsKICAg\nICAgICAgICAgICAgIHN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkRJU0NPTk5F\nQ1RFRDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0b0Nsb3NlID0gY2hh\nbm5lbDsKICAgICAgICAgICAgY2hhbm5lbCA9IG51bGw7CiAgICAgICAgfQog\nICAgICAgIGlmICh0b0Nsb3NlICE9IG51bGwpIHsKICAgICAgICAgICAgQ2hh\nbm5lbEZ1dHVyZSBjZiA9IGNsb3NlQ2hhbm5lbCh0b0Nsb3NlKTsKICAgICAg\nICAgICAgaWYgKHdhaXQpIHsKICAgICAgICAgICAgICAgIGNmLmF3YWl0VW5p\nbnRlcnJ1cHRpYmx5KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCgogICAgcHJpdmF0ZSBDaGFubmVsRnV0dXJlIGNsb3NlQ2hhbm5lbChDaGFu\nbmVsIGMpIHsKICAgICAgICBMT0cuZGVidWcoIkNsb3NpbmcgY2hhbm5lbCB7\nfSIsIGMpOwogICAgICAgIFJlYWRUaW1lb3V0SGFuZGxlciB0aW1lb3V0ID0g\nYy5nZXRQaXBlbGluZSgpLmdldChSZWFkVGltZW91dEhhbmRsZXIuY2xhc3Mp\nOwogICAgICAgIGlmICh0aW1lb3V0ICE9IG51bGwpIHsKICAgICAgICAgICAg\ndGltZW91dC5yZWxlYXNlRXh0ZXJuYWxSZXNvdXJjZXMoKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGMuY2xvc2UoKTsKICAgIH0KCiAgICB2b2lkIGVy\ncm9yT3V0UmVhZEtleShmaW5hbCBDb21wbGV0aW9uS2V5IGtleSkgewogICAg\nICAgIGVycm9yT3V0UmVhZEtleShrZXksIEJLRXhjZXB0aW9uLkNvZGUuQm9v\na2llSGFuZGxlTm90QXZhaWxhYmxlRXhjZXB0aW9uKTsKICAgIH0KCiAgICB2\nb2lkIGVycm9yT3V0UmVhZEtleShmaW5hbCBDb21wbGV0aW9uS2V5IGtleSwg\nZmluYWwgaW50IHJjKSB7CiAgICAgICAgZmluYWwgUmVhZENvbXBsZXRpb24g\ncmVhZENvbXBsZXRpb24gPSAoUmVhZENvbXBsZXRpb24pY29tcGxldGlvbk9i\namVjdHMucmVtb3ZlKGtleSk7CiAgICAgICAgaWYgKG51bGwgPT0gcmVhZENv\nbXBsZXRpb24pIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAg\nICAgICBleGVjdXRvci5zdWJtaXRPcmRlcmVkKHJlYWRDb21wbGV0aW9uLmxl\nZGdlcklkLCBuZXcgU2FmZVJ1bm5hYmxlKCkgewogICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVJ1bigpIHsKICAg\nICAgICAgICAgICAgIFN0cmluZyBiQWRkcmVzcyA9ICJudWxsIjsKICAgICAg\nICAgICAgICAgIENoYW5uZWwgYyA9IGNoYW5uZWw7CiAgICAgICAgICAgICAg\nICBpZiAoYyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgYkFkZHJl\nc3MgPSBjLmdldFJlbW90ZUFkZHJlc3MoKS50b1N0cmluZygpOwogICAgICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiQ291bGQg\nbm90IHdyaXRlIHJlcXVlc3QgZm9yIHJlYWRpbmcgZW50cnk6IHt9IGxlZGdl\nci1pZDoge30gYm9va2llOiB7fSIsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgbmV3IE9iamVjdFtdeyByZWFkQ29tcGxldGlvbi5lbnRyeUlkLCByZWFk\nQ29tcGxldGlvbi5sZWRnZXJJZCwgYkFkZHJlc3MgfSk7CgogICAgICAgICAg\nICAgICAgcmVhZENvbXBsZXRpb24uY2IucmVhZEVudHJ5Q29tcGxldGUocmMs\nIHJlYWRDb21wbGV0aW9uLmxlZGdlcklkLCByZWFkQ29tcGxldGlvbi5lbnRy\neUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbnVsbCwgcmVhZENvbXBsZXRpb24uY3R4KTsKICAgICAg\nICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIHZvaWQgZXJyb3JPdXRB\nZGRLZXkoZmluYWwgQ29tcGxldGlvbktleSBrZXkpIHsKICAgICAgICBlcnJv\nck91dEFkZEtleShrZXksIEJLRXhjZXB0aW9uLkNvZGUuQm9va2llSGFuZGxl\nTm90QXZhaWxhYmxlRXhjZXB0aW9uKTsKICAgIH0KCiAgICB2b2lkIGVycm9y\nT3V0QWRkS2V5KGZpbmFsIENvbXBsZXRpb25LZXkga2V5LCBmaW5hbCBpbnQg\ncmMpIHsKICAgICAgICBmaW5hbCBBZGRDb21wbGV0aW9uIGFkZENvbXBsZXRp\nb24gPSAoQWRkQ29tcGxldGlvbiljb21wbGV0aW9uT2JqZWN0cy5yZW1vdmUo\na2V5KTsKICAgICAgICBpZiAobnVsbCA9PSBhZGRDb21wbGV0aW9uKSB7CiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZXhlY3V0b3Iu\nc3VibWl0T3JkZXJlZChhZGRDb21wbGV0aW9uLmxlZGdlcklkLCBuZXcgU2Fm\nZVJ1bm5hYmxlKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2FmZVJ1bigpIHsKICAgICAgICAgICAgICAgIFN0\ncmluZyBiQWRkcmVzcyA9ICJudWxsIjsKICAgICAgICAgICAgICAgIENoYW5u\nZWwgYyA9IGNoYW5uZWw7CiAgICAgICAgICAgICAgICBpZihjICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgICAgICBiQWRkcmVzcyA9IGMuZ2V0UmVtb3Rl\nQWRkcmVzcygpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICBMT0cuZGVidWcoIkNvdWxkIG5vdCB3cml0ZSByZXF1ZXN0\nIGZvciBhZGRpbmcgZW50cnk6IHt9IGxlZGdlci1pZDoge30gYm9va2llOiB7\nfSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdIHsg\nYWRkQ29tcGxldGlvbi5lbnRyeUlkLCBhZGRDb21wbGV0aW9uLmxlZGdlcklk\nLCBiQWRkcmVzcyB9KTsKCiAgICAgICAgICAgICAgICBhZGRDb21wbGV0aW9u\nLmNiLndyaXRlQ29tcGxldGUocmMsIGFkZENvbXBsZXRpb24ubGVkZ2VySWQs\nIGFkZENvbXBsZXRpb24uZW50cnlJZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyLCBhZGRDb21wbGV0aW9u\nLmN0eCk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoIkludm9rZWQgY2Fs\nbGJhY2sgbWV0aG9kOiB7fSIsIGFkZENvbXBsZXRpb24uZW50cnlJZCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEVycm9ycyBvdXQgcGVuZGluZyBlbnRyaWVzLiBXZSBjYWxsIHRoaXMgbWV0\naG9kIGZyb20gb25lIHRocmVhZCB0byBhdm9pZAogICAgICogY29uY3VycmVu\ndCBleGVjdXRpb25zIHRvIFF1b3J1bU9wTW9uaXRvciAoaW1wbGVtZW50cyBj\nYWxsYmFja3MpLiBJdCBzZWVtcwogICAgICogc2ltcGxlciB0byBjYWxsIGl0\nIGZyb20gQm9va2llSGFuZGxlIGluc3RlYWQgb2YgY2FsbGluZyBkaXJlY3Rs\neSBmcm9tCiAgICAgKiBoZXJlLgogICAgICovCgogICAgdm9pZCBlcnJvck91\ndE91dHN0YW5kaW5nRW50cmllcyhpbnQgcmMpIHsKCiAgICAgICAgLy8gRE8g\nTk9UIHJld3JpdGUgdGhlc2UgdXNpbmcgTWFwLkVudHJ5IGl0ZXJhdGlvbnMu\nIFdlIHdhbnQgdG8gaXRlcmF0ZQogICAgICAgIC8vIG9uIGtleXMgYW5kIHNl\nZSBpZiB3ZSBhcmUgc3VjY2Vzc2Z1bGx5IGFibGUgdG8gcmVtb3ZlIHRoZSBr\nZXkgZnJvbQogICAgICAgIC8vIHRoZSBtYXAuIEJlY2F1c2UgdGhlIGFkZCBh\nbmQgdGhlIHJlYWQgbWV0aG9kcyBhbHNvIGRvIHRoZSBzYW1lIHRoaW5nCiAg\nICAgICAgLy8gaW4gY2FzZSB0aGV5IGdldCBhIHdyaXRlIGZhaWx1cmUgb24g\ndGhlIHNvY2tldC4gVGhlIG9uZSB3aG8KICAgICAgICAvLyBzdWNjZXNzZnVs\nbHkgcmVtb3ZlcyB0aGUga2V5IGZyb20gdGhlIG1hcCBpcyB0aGUgb25lIHJl\nc3BvbnNpYmxlIGZvcgogICAgICAgIC8vIGNhbGxpbmcgdGhlIGFwcGxpY2F0\naW9uIGNhbGxiYWNrLgogICAgICAgIGZvciAoQ29tcGxldGlvbktleSBrZXkg\nOiBjb21wbGV0aW9uT2JqZWN0cy5rZXlTZXQoKSkgewogICAgICAgICAgICBz\nd2l0Y2ggKGtleS5vcGVyYXRpb25UeXBlKSB7CiAgICAgICAgICAgICAgICBj\nYXNlIEFERF9FTlRSWToKICAgICAgICAgICAgICAgICAgICBlcnJvck91dEFk\nZEtleShrZXksIHJjKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgUkVBRF9FTlRSWToKICAgICAgICAgICAgICAg\nICAgICBlcnJvck91dFJlYWRLZXkoa2V5LCByYyk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogSW4gdGhlIG5ldHR5IHBpcGVsaW5lLCB3\nZSBuZWVkIHRvIHNwbGl0IHBhY2tldHMgYmFzZWQgb24gbGVuZ3RoLCBzbyB3\nZQogICAgICogdXNlIHRoZSB7QGxpbmsgTGVuZ3RoRmllbGRCYXNlZEZyYW1l\nRGVjb2Rlcn0uIE90aGVyIHRoYW4gdGhhdCBhbGwgYWN0aW9ucwogICAgICog\nYXJlIGNhcnJpZWQgb3V0IGluIHRoaXMgY2xhc3MsIGUuZy4sIG1ha2luZyBz\nZW5zZSBvZiByZWNlaXZlZCBtZXNzYWdlcywKICAgICAqIHByZXBlbmRpbmcg\ndGhlIGxlbmd0aCB0byBvdXRnb2luZyBwYWNrZXRzIGV0Yy4KICAgICAqLwog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgQ2hhbm5lbFBpcGVsaW5lIGdldFBp\ncGVsaW5lKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2hhbm5lbFBp\ncGVsaW5lIHBpcGVsaW5lID0gQ2hhbm5lbHMucGlwZWxpbmUoKTsKCiAgICAg\nICAgcGlwZWxpbmUuYWRkTGFzdCgibGVuZ3RoYmFzZWRmcmFtZWRlY29kZXIi\nLCBuZXcgTGVuZ3RoRmllbGRCYXNlZEZyYW1lRGVjb2RlcihNQVhfRlJBTUVf\nTEVOR1RILCAwLCA0LCAwLCA0KSk7CiAgICAgICAgcGlwZWxpbmUuYWRkTGFz\ndCgibGVuZ3RocHJlcGVuZGVyIiwgbmV3IExlbmd0aEZpZWxkUHJlcGVuZGVy\nKDQpKTsKICAgICAgICBwaXBlbGluZS5hZGRMYXN0KCJib29raWVQcm90b0Vu\nY29kZXIiLCBuZXcgQm9va2llUHJvdG9FbmNvZGluZy5SZXF1ZXN0RW5jb2Rl\ncigpKTsKICAgICAgICBwaXBlbGluZS5hZGRMYXN0KCJib29raWVQcm90b0Rl\nY29kZXIiLCBuZXcgQm9va2llUHJvdG9FbmNvZGluZy5SZXNwb25zZURlY29k\nZXIoKSk7CiAgICAgICAgcGlwZWxpbmUuYWRkTGFzdCgibWFpbmhhbmRsZXIi\nLCB0aGlzKTsKICAgICAgICByZXR1cm4gcGlwZWxpbmU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJZiBvdXIgY2hhbm5lbCBoYXMgZGlzY29ubmVjdGVkLCB3\nZSBqdXN0IGVycm9yIG91dCB0aGUgcGVuZGluZyBlbnRyaWVzCiAgICAgKi8K\nICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY2hhbm5lbERpc2Nvbm5l\nY3RlZChDaGFubmVsSGFuZGxlckNvbnRleHQgY3R4LCBDaGFubmVsU3RhdGVF\ndmVudCBlKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBDaGFubmVsIGMg\nPSBjdHguZ2V0Q2hhbm5lbCgpOwogICAgICAgIExPRy5pbmZvKCJEaXNjb25u\nZWN0ZWQgZnJvbSBib29raWUgY2hhbm5lbCB7fSIsIGMpOwogICAgICAgIGlm\nIChjICE9IG51bGwpIHsKICAgICAgICAgICAgY2xvc2VDaGFubmVsKGMpOwog\nICAgICAgIH0KCiAgICAgICAgZXJyb3JPdXRPdXRzdGFuZGluZ0VudHJpZXMo\nQktFeGNlcHRpb24uQ29kZS5Cb29raWVIYW5kbGVOb3RBdmFpbGFibGVFeGNl\ncHRpb24pOwoKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAg\nICAgICAgaWYgKHRoaXMuY2hhbm5lbCA9PSBjCiAgICAgICAgICAgICAgICAm\nJiBzdGF0ZSAhPSBDb25uZWN0aW9uU3RhdGUuQ0xPU0VEKSB7CiAgICAgICAg\nICAgICAgICBzdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5ESVNDT05ORUNURUQ7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIHdlIGRvbid0\nIHdhbnQgdG8gcmVjb25uZWN0IHJpZ2h0IGF3YXkuIElmIHNvbWVvbmUgc2Vu\nZHMgYSByZXF1ZXN0IHRvCiAgICAgICAgLy8gdGhpcyBhZGRyZXNzLCB3ZSB3\naWxsIHJlY29ubmVjdC4KICAgIH0KCiAgICAvKioKICAgICAqIENhbGxlZCBi\neSBuZXR0eSB3aGVuIGFuIGV4Y2VwdGlvbiBoYXBwZW5zIGluIG9uZSBvZiB0\naGUgbmV0dHkgdGhyZWFkcwogICAgICogKG1vc3RseSBkdWUgdG8gd2hhdCB3\nZSBkbyBpbiB0aGUgbmV0dHkgdGhyZWFkcykKICAgICAqLwogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCBleGNlcHRpb25DYXVnaHQoQ2hhbm5lbEhh\nbmRsZXJDb250ZXh0IGN0eCwgRXhjZXB0aW9uRXZlbnQgZSkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgVGhyb3dhYmxlIHQgPSBlLmdldENhdXNlKCk7\nCiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBDb3JydXB0ZWRGcmFtZUV4Y2Vw\ndGlvbiB8fCB0IGluc3RhbmNlb2YgVG9vTG9uZ0ZyYW1lRXhjZXB0aW9uKSB7\nCiAgICAgICAgICAgIExPRy5lcnJvcigiQ29ycnVwdGVkIGZyYW1lIHJlY2Vp\ndmVkIGZyb20gYm9va2llOiB7fSIsCiAgICAgICAgICAgICAgICAgICAgICBl\nLmdldENoYW5uZWwoKS5nZXRSZW1vdGVBZGRyZXNzKCkpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodCBpbnN0YW5jZW9m\nIElPRXhjZXB0aW9uKSB7CiAgICAgICAgICAgIC8vIHRoZXNlIGFyZSB0aHJv\nd24gd2hlbiBhIGJvb2tpZSBmYWlscywgbG9nZ2luZyB0aGVtIGp1c3QgcG9s\nbHV0ZXMKICAgICAgICAgICAgLy8gdGhlIGxvZ3MgKHRoZSBmYWlsdXJlIGlz\nIGxvZ2dlZCBmcm9tIHRoZSBsaXN0ZW5lcnMgb24gdGhlIHdyaXRlCiAgICAg\nICAgICAgIC8vIG9wZXJhdGlvbiksIHNvIEknbGwganVzdCBpZ25vcmUgaXQg\naGVyZS4KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAg\nc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIGlmIChzdGF0ZSA9\nPSBDb25uZWN0aW9uU3RhdGUuQ0xPU0VEKSB7CiAgICAgICAgICAgICAgICBM\nT0cuZGVidWcoIlVuZXhwZWN0ZWQgZXhjZXB0aW9uIGNhdWdodCBieSBib29r\naWUgY2xpZW50IGNoYW5uZWwgaGFuZGxlciwgIgogICAgICAgICAgICAgICAg\nICAgICAgICAgICsgImJ1dCB0aGUgY2xpZW50IGlzIGNsb3NlZCwgc28gaXQg\naXNuJ3QgaW1wb3J0YW50IiwgdCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICBMT0cuZXJyb3IoIlVuZXhwZWN0ZWQgZXhjZXB0aW9u\nIGNhdWdodCBieSBib29raWUgY2xpZW50IGNoYW5uZWwgaGFuZGxlciIsIHQp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIFNpbmNlIHdl\nIGFyZSBhIGxpYnJhcnksIGNhbnQgdGVybWluYXRlIEFwcCBoZXJlLCBjYW4g\nd2U/CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxsZWQgYnkgbmV0dHkgd2hl\nbiBhIG1lc3NhZ2UgaXMgcmVjZWl2ZWQgb24gYSBjaGFubmVsCiAgICAgKi8K\nICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgbWVzc2FnZVJlY2VpdmVk\nKENoYW5uZWxIYW5kbGVyQ29udGV4dCBjdHgsIE1lc3NhZ2VFdmVudCBlKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIShlLmdldE1lc3NhZ2Uo\nKSBpbnN0YW5jZW9mIFJlc3BvbnNlKSkgewogICAgICAgICAgICBjdHguc2Vu\nZFVwc3RyZWFtKGUpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoK\nICAgICAgICBmaW5hbCBSZXNwb25zZSByZXNwb25zZSA9IChSZXNwb25zZSkg\nZS5nZXRNZXNzYWdlKCk7CiAgICAgICAgZmluYWwgQktQYWNrZXRIZWFkZXIg\naGVhZGVyID0gcmVzcG9uc2UuZ2V0SGVhZGVyKCk7CgogICAgICAgIGZpbmFs\nIENvbXBsZXRpb25WYWx1ZSBjb21wbGV0aW9uVmFsdWUgPSBjb21wbGV0aW9u\nT2JqZWN0cy5yZW1vdmUobmV3Q29tcGxldGlvbktleShoZWFkZXIuZ2V0VHhu\nSWQoKSwKICAgICAgICAgICAgICAgIGhlYWRlci5nZXRPcGVyYXRpb24oKSkp\nOwoKICAgICAgICBpZiAobnVsbCA9PSBjb21wbGV0aW9uVmFsdWUpIHsKICAg\nICAgICAgICAgLy8gVW5leHBlY3RlZCByZXNwb25zZSwgc28gbG9nIGl0LiBU\naGUgdHhuSWQgc2hvdWxkIGhhdmUgYmVlbiBwcmVzZW50LgogICAgICAgICAg\nICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAg\nIExPRy5kZWJ1ZygiVW5leHBlY3RlZCByZXNwb25zZSByZWNlaXZlZCBmcm9t\nIGJvb2tpZSA6ICIgKyBhZGRyICsgIiBmb3IgdHlwZSA6ICIgKyBoZWFkZXIu\nICAgICAgICAgICAgIGdldE9wZXJhdGlvbigpICsKICAgICAgICAgICAgICAg\nICAgICAgICAgIiBhbmQgdHhuSWQgOiAiICsgaGVhZGVyLmdldFR4bklkKCkp\nOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nIGxvbmcgb3JkZXJpbmdLZXkgPSBjb21wbGV0aW9uVmFsdWUubGVkZ2VySWQ7\nCiAgICAgICAgICAgIGV4ZWN1dG9yLnN1Ym1pdE9yZGVyZWQob3JkZXJpbmdL\nZXksIG5ldyBTYWZlUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVSdW4oKSB7\nCiAgICAgICAgICAgICAgICAgICAgT3BlcmF0aW9uVHlwZSB0eXBlID0gaGVh\nZGVyLmdldE9wZXJhdGlvbigpOwogICAgICAgICAgICAgICAgICAgIHN3aXRj\naCAodHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEFERF9F\nTlRSWToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUFkZFJl\nc3BvbnNlKHJlc3BvbnNlLmdldEFkZFJlc3BvbnNlKCksIGNvbXBsZXRpb25W\nYWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgICAgICAgICAgY2FzZSBSRUFEX0VOVFJZOgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaGFuZGxlUmVhZFJlc3BvbnNlKHJlc3Bv\nbnNlLmdldFJlYWRSZXNwb25zZSgpLCBjb21wbGV0aW9uVmFsdWUpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIlVuZXhwZWN0ZWQgcmVzcG9uc2UsIHR5cGU6e30gcmVj\nZWl2ZWQgZnJvbSBib29raWU6e30sIGlnbm9yaW5nIiwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCBhZGRyKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHZvaWQgaGFuZGxlQWRkUmVzcG9uc2UoQWRkUmVz\ncG9uc2UgcmVzcG9uc2UsIENvbXBsZXRpb25WYWx1ZSBjb21wbGV0aW9uVmFs\ndWUpIHsKICAgICAgICAvLyBUaGUgY29tcGxldGlvbiB2YWx1ZSBzaG91bGQg\nYWx3YXlzIGJlIGFuIGluc3RhbmNlIG9mIGFuIEFkZENvbXBsZXRpb24gb2Jq\nZWN0IHdoZW4gd2UgcmVhY2ggaGVyZS4KICAgICAgICBBZGRDb21wbGV0aW9u\nIGFjID0gKEFkZENvbXBsZXRpb24pY29tcGxldGlvblZhbHVlOwoKICAgICAg\nICBsb25nIGxlZGdlcklkID0gcmVzcG9uc2UuZ2V0TGVkZ2VySWQoKTsKICAg\nICAgICBsb25nIGVudHJ5SWQgPSByZXNwb25zZS5nZXRFbnRyeUlkKCk7CiAg\nICAgICAgU3RhdHVzQ29kZSBzdGF0dXMgPSByZXNwb25zZS5nZXRTdGF0dXMo\nKTsKCiAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAg\nICAgICAgIExPRy5kZWJ1ZygiR290IHJlc3BvbnNlIGZvciBhZGQgcmVxdWVz\ndCBmcm9tIGJvb2tpZTogIiArIGFkZHIgKyAiIGZvciBsZWRnZXI6ICIgKyBs\nZWRnZXJJZCArICIgZW50cnk6ICIKICAgICAgICAgICAgICAgICAgICArIGVu\ndHJ5SWQgKyAiIHJjOiAiICsgc3RhdHVzKTsKICAgICAgICB9CiAgICAgICAg\nLy8gY29udmVydCB0byBCS0V4Y2VwdGlvbiBjb2RlIGJlY2F1c2UgdGhhdHMg\nd2hhdCB0aGUgdXBwcGVyCiAgICAgICAgLy8gbGF5ZXJzIGV4cGVjdC4gVGhp\ncyBpcyBVR0xZLCB0aGVyZSBzaG91bGQganVzdCBiZSBvbmUgc2V0IG9mCiAg\nICAgICAgLy8gZXJyb3IgY29kZXMuCiAgICAgICAgSW50ZWdlciByY1RvUmV0\nID0gc3RhdHVzQ29kZVRvRXhjZXB0aW9uQ29kZShzdGF0dXMpOwogICAgICAg\nIGlmIChudWxsID09IHJjVG9SZXQpIHsKICAgICAgICAgICAgaWYgKExPRy5p\nc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWco\nIkFkZCBmb3IgbGVkZ2VyOiAiICsgbGVkZ2VySWQgKyAiLCBlbnRyeTogIiAr\nIGVudHJ5SWQgKyAiIGZhaWxlZCBvbiBib29raWU6ICIgKyBhZGRyCiAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiB3aXRoIGNvZGU6IiArIHN0YXR1cyk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmNUb1JldCA9IEJLRXhjZXB0\naW9uLkNvZGUuV3JpdGVFeGNlcHRpb247CiAgICAgICAgfQogICAgICAgIGFj\nLmNiLndyaXRlQ29tcGxldGUocmNUb1JldCwgbGVkZ2VySWQsIGVudHJ5SWQs\nIGFkZHIsIGFjLmN0eCk7CiAgICB9CgogICAgdm9pZCBoYW5kbGVSZWFkUmVz\ncG9uc2UoUmVhZFJlc3BvbnNlIHJlc3BvbnNlLCBDb21wbGV0aW9uVmFsdWUg\nY29tcGxldGlvblZhbHVlKSB7CiAgICAgICAgLy8gVGhlIGNvbXBsZXRpb24g\ndmFsdWUgc2hvdWxkIGFsd2F5cyBiZSBhbiBpbnN0YW5jZSBvZiBhIFJlYWRD\nb21wbGV0aW9uIG9iamVjdCB3aGVuIHdlIHJlYWNoIGhlcmUuCiAgICAgICAg\nUmVhZENvbXBsZXRpb24gcmMgPSAoUmVhZENvbXBsZXRpb24pY29tcGxldGlv\nblZhbHVlOwoKICAgICAgICBsb25nIGxlZGdlcklkID0gcmVzcG9uc2UuZ2V0\nTGVkZ2VySWQoKTsKICAgICAgICBsb25nIGVudHJ5SWQgPSByZXNwb25zZS5n\nZXRFbnRyeUlkKCk7CiAgICAgICAgU3RhdHVzQ29kZSBzdGF0dXMgPSByZXNw\nb25zZS5nZXRTdGF0dXMoKTsKICAgICAgICBDaGFubmVsQnVmZmVyIGJ1ZmZl\nciA9IENoYW5uZWxCdWZmZXJzLmJ1ZmZlcigwKTsKCiAgICAgICAgaWYgKHJl\nc3BvbnNlLmhhc0JvZHkoKSkgewogICAgICAgICAgICBidWZmZXIgPSBDaGFu\nbmVsQnVmZmVycy5jb3BpZWRCdWZmZXIocmVzcG9uc2UuZ2V0Qm9keSgpLmFz\nUmVhZE9ubHlCeXRlQnVmZmVyKCkpOwogICAgICAgIH0KCiAgICAgICAgaWYg\nKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIExPRy5kZWJ1\nZygiR290IHJlc3BvbnNlIGZvciByZWFkIHJlcXVlc3QgZnJvbSBib29raWU6\nICIgKyBhZGRyICsgIiBmb3IgbGVkZ2VyOiAiICsgbGVkZ2VySWQgKyAiIGVu\ndHJ5OiAiCiAgICAgICAgICAgICAgICAgICAgKyBlbnRyeUlkICsgIiByYzog\nIiArIHJjICsgIiBlbnRyeSBsZW5ndGg6ICIgKyBidWZmZXIucmVhZGFibGVC\neXRlcygpKTsKICAgICAgICB9CgogICAgICAgIC8vIGNvbnZlcnQgdG8gQktF\neGNlcHRpb24gY29kZSBiZWNhdXNlIHRoYXRzIHdoYXQgdGhlIHVwcHBlcgog\nICAgICAgIC8vIGxheWVycyBleHBlY3QuIFRoaXMgaXMgVUdMWSwgdGhlcmUg\nc2hvdWxkIGp1c3QgYmUgb25lIHNldCBvZgogICAgICAgIC8vIGVycm9yIGNv\nZGVzLgogICAgICAgIEludGVnZXIgcmNUb1JldCA9IHN0YXR1c0NvZGVUb0V4\nY2VwdGlvbkNvZGUoc3RhdHVzKTsKICAgICAgICBpZiAobnVsbCA9PSByY1Rv\nUmV0KSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiUmVhZCBlbnRyeSBmb3Ig\nbGVkZ2VyOnt9LCBlbnRyeTp7fSBmYWlsZWQgb24gYm9va2llOnt9IHdpdGgg\nY29kZTp7fSIsCiAgICAgICAgICAgICAgICAgICAgICBuZXcgT2JqZWN0W10g\neyBsZWRnZXJJZCwgZW50cnlJZCwgYWRkciwgc3RhdHVzIH0pOwogICAgICAg\nICAgICByY1RvUmV0ID0gQktFeGNlcHRpb24uQ29kZS5SZWFkRXhjZXB0aW9u\nOwogICAgICAgIH0KICAgICAgICByYy5jYi5yZWFkRW50cnlDb21wbGV0ZShy\nY1RvUmV0LCBsZWRnZXJJZCwgZW50cnlJZCwgYnVmZmVyLnNsaWNlKCksIHJj\nLmN0eCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBCb2lsZXItcGxhdGUgd3Jh\ncHBlciBjbGFzc2VzIGZvbGxvdwogICAgICoKICAgICAqLwoKICAgIC8vIHZp\nc2libGUgZm9yIHRlc3RpbmcKICAgIHN0YXRpYyBhYnN0cmFjdCBjbGFzcyBD\nb21wbGV0aW9uVmFsdWUgewogICAgICAgIGZpbmFsIE9iamVjdCBjdHg7CiAg\nICAgICAgcHJvdGVjdGVkIGZpbmFsIGxvbmcgbGVkZ2VySWQ7CiAgICAgICAg\ncHJvdGVjdGVkIGZpbmFsIGxvbmcgZW50cnlJZDsKICAgICAgICBwcm90ZWN0\nZWQgZmluYWwgVGltZW91dCB0aW1lb3V0OwoKICAgICAgICBwdWJsaWMgQ29t\ncGxldGlvblZhbHVlKE9iamVjdCBjdHgsIGxvbmcgbGVkZ2VySWQsIGxvbmcg\nZW50cnlJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpbWVv\ndXQgdGltZW91dCkgewogICAgICAgICAgICB0aGlzLmN0eCA9IGN0eDsKICAg\nICAgICAgICAgdGhpcy5sZWRnZXJJZCA9IGxlZGdlcklkOwogICAgICAgICAg\nICB0aGlzLmVudHJ5SWQgPSBlbnRyeUlkOwogICAgICAgICAgICB0aGlzLnRp\nbWVvdXQgPSB0aW1lb3V0OwogICAgICAgIH0KCiAgICAgICAgdm9pZCBjYW5j\nZWxUaW1lb3V0KCkgewogICAgICAgICAgICBpZiAobnVsbCAhPSB0aW1lb3V0\nKSB7CiAgICAgICAgICAgICAgICB0aW1lb3V0LmNhbmNlbCgpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIHZpc2libGUgZm9yIHRl\nc3RpbmcKICAgIHN0YXRpYyBjbGFzcyBSZWFkQ29tcGxldGlvbiBleHRlbmRz\nIENvbXBsZXRpb25WYWx1ZSB7CiAgICAgICAgZmluYWwgUmVhZEVudHJ5Q2Fs\nbGJhY2sgY2I7CgogICAgICAgIHB1YmxpYyBSZWFkQ29tcGxldGlvbihSZWFk\nRW50cnlDYWxsYmFjayBjYiwgT2JqZWN0IGN0eCwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbG9uZyBsZWRnZXJJZCwgbG9uZyBlbnRyeUlkKSB7\nCiAgICAgICAgICAgIHRoaXMobnVsbCwgY2IsIGN0eCwgbGVkZ2VySWQsIGVu\ndHJ5SWQsIG51bGwpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJlYWRD\nb21wbGV0aW9uKGZpbmFsIE9wU3RhdHNMb2dnZXIgcmVhZEVudHJ5T3BMb2dn\nZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIFJlYWRF\nbnRyeUNhbGxiYWNrIG9yaWdpbmFsQ2FsbGJhY2ssCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGZpbmFsIE9iamVjdCBvcmlnaW5hbEN0eCwgZmlu\nYWwgbG9uZyBsZWRnZXJJZCwgZmluYWwgbG9uZyBlbnRyeUlkLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBUaW1lb3V0IHRpbWVvdXQp\nIHsKICAgICAgICAgICAgc3VwZXIob3JpZ2luYWxDdHgsIGxlZGdlcklkLCBl\nbnRyeUlkLCB0aW1lb3V0KTsKICAgICAgICAgICAgZmluYWwgbG9uZyByZXF1\nZXN0VGltZU1pbGxpcyA9IE1hdGhVdGlscy5ub3coKTsKICAgICAgICAgICAg\ndGhpcy5jYiA9IG51bGwgPT0gcmVhZEVudHJ5T3BMb2dnZXIgPyBvcmlnaW5h\nbENhbGxiYWNrIDogbmV3IFJlYWRFbnRyeUNhbGxiYWNrKCkgewogICAgICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCByZWFkRW50cnlDb21wbGV0ZShpbnQgcmMsIGxvbmcgbGVkZ2VySWQsIGxv\nbmcgZW50cnlJZCwgQ2hhbm5lbEJ1ZmZlciBidWZmZXIsIE9iamVjdCBjdHgp\nIHsKICAgICAgICAgICAgICAgICAgICBjYW5jZWxUaW1lb3V0KCk7CiAgICAg\nICAgICAgICAgICAgICAgbG9uZyBsYXRlbmN5TWlsbGlzID0gTWF0aFV0aWxz\nLm5vdygpIC0gcmVxdWVzdFRpbWVNaWxsaXM7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKHJjICE9IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgcmVhZEVudHJ5T3BMb2dnZXIucmVnaXN0ZXJGYWls\nZWRFdmVudChsYXRlbmN5TWlsbGlzKTsKICAgICAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZWFkRW50cnlPcExv\nZ2dlci5yZWdpc3RlclN1Y2Nlc3NmdWxFdmVudChsYXRlbmN5TWlsbGlzKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgb3Jp\nZ2luYWxDYWxsYmFjay5yZWFkRW50cnlDb21wbGV0ZShyYywgbGVkZ2VySWQs\nIGVudHJ5SWQsIGJ1ZmZlciwgb3JpZ2luYWxDdHgpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KCiAgICAvLyB2\naXNpYmxlIGZvciB0ZXN0aW5nCiAgICBzdGF0aWMgY2xhc3MgQWRkQ29tcGxl\ndGlvbiBleHRlbmRzIENvbXBsZXRpb25WYWx1ZSB7CiAgICAgICAgZmluYWwg\nV3JpdGVDYWxsYmFjayBjYjsKCiAgICAgICAgcHVibGljIEFkZENvbXBsZXRp\nb24oV3JpdGVDYWxsYmFjayBjYiwgT2JqZWN0IGN0eCwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBsb25nIGxlZGdlcklkLCBsb25nIGVudHJ5SWQp\nIHsKICAgICAgICAgICAgdGhpcyhudWxsLCBjYiwgY3R4LCBsZWRnZXJJZCwg\nZW50cnlJZCwgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQWRk\nQ29tcGxldGlvbihmaW5hbCBPcFN0YXRzTG9nZ2VyIGFkZEVudHJ5T3BMb2dn\nZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgV3JpdGVD\nYWxsYmFjayBvcmlnaW5hbENhbGxiYWNrLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGZpbmFsIE9iamVjdCBvcmlnaW5hbEN0eCwgZmluYWwgbG9u\nZyBsZWRnZXJJZCwgZmluYWwgbG9uZyBlbnRyeUlkLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGZpbmFsIFRpbWVvdXQgdGltZW91dCkgewogICAg\nICAgICAgICBzdXBlcihvcmlnaW5hbEN0eCwgbGVkZ2VySWQsIGVudHJ5SWQs\nIHRpbWVvdXQpOwogICAgICAgICAgICBmaW5hbCBsb25nIHJlcXVlc3RUaW1l\nTWlsbGlzID0gTWF0aFV0aWxzLm5vdygpOwogICAgICAgICAgICB0aGlzLmNi\nID0gbnVsbCA9PSBhZGRFbnRyeU9wTG9nZ2VyID8gb3JpZ2luYWxDYWxsYmFj\nayA6IG5ldyBXcml0ZUNhbGxiYWNrKCkgewogICAgICAgICAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZUNvbXBs\nZXRlKGludCByYywgbG9uZyBsZWRnZXJJZCwgbG9uZyBlbnRyeUlkLCBCb29r\naWVTb2NrZXRBZGRyZXNzIGFkZHIsIE9iamVjdCBjdHgpIHsKICAgICAgICAg\nICAgICAgICAgICBjYW5jZWxUaW1lb3V0KCk7CiAgICAgICAgICAgICAgICAg\nICAgbG9uZyBsYXRlbmN5TWlsbGlzID0gTWF0aFV0aWxzLm5vdygpIC0gcmVx\ndWVzdFRpbWVNaWxsaXM7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9\nIEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgYWRkRW50cnlPcExvZ2dlci5yZWdpc3RlckZhaWxlZEV2ZW50KGxhdGVu\nY3lNaWxsaXMpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGFkZEVudHJ5T3BMb2dnZXIucmVnaXN0ZXJT\ndWNjZXNzZnVsRXZlbnQobGF0ZW5jeU1pbGxpcyk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsQ2FsbGJhY2su\nd3JpdGVDb21wbGV0ZShyYywgbGVkZ2VySWQsIGVudHJ5SWQsIGFkZHIsIG9y\naWdpbmFsQ3R4KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsK\nICAgICAgICB9CiAgICB9CgogICAgLy8gdmlzYWJsZSBmb3IgdGVzdGluZwog\nICAgQ29tcGxldGlvbktleSBuZXdDb21wbGV0aW9uS2V5KGxvbmcgdHhuSWQs\nIE9wZXJhdGlvblR5cGUgb3BlcmF0aW9uVHlwZSkgewogICAgICAgIHJldHVy\nbiBuZXcgQ29tcGxldGlvbktleSh0eG5JZCwgb3BlcmF0aW9uVHlwZSk7CiAg\nICB9CgogICAgVGltZW91dCBzY2hlZHVsZVRpbWVvdXQoQ29tcGxldGlvbktl\neSBrZXksIGxvbmcgdGltZW91dCkgewogICAgICAgIGlmIChudWxsICE9IHJl\ncXVlc3RUaW1lcikgewogICAgICAgICAgICByZXR1cm4gcmVxdWVzdFRpbWVy\nLm5ld1RpbWVvdXQoa2V5LCB0aW1lb3V0LCBUaW1lVW5pdC5TRUNPTkRTKTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICB9CiAgICB9CgogICAgY2xhc3MgQ29tcGxldGlvbktleSBpbXBsZW1l\nbnRzIFRpbWVyVGFzayB7CiAgICAgICAgZmluYWwgbG9uZyB0eG5JZDsKICAg\nICAgICBmaW5hbCBPcGVyYXRpb25UeXBlIG9wZXJhdGlvblR5cGU7CiAgICAg\nICAgZmluYWwgbG9uZyByZXF1ZXN0QXQ7CgogICAgICAgIENvbXBsZXRpb25L\nZXkobG9uZyB0eG5JZCwgT3BlcmF0aW9uVHlwZSBvcGVyYXRpb25UeXBlKSB7\nCiAgICAgICAgICAgIHRoaXMudHhuSWQgPSB0eG5JZDsKICAgICAgICAgICAg\ndGhpcy5vcGVyYXRpb25UeXBlID0gb3BlcmF0aW9uVHlwZTsKICAgICAgICAg\nICAgdGhpcy5yZXF1ZXN0QXQgPSBNYXRoVXRpbHMubm93SW5OYW5vKCk7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBlcXVhbHMoT2JqZWN0IG9iaikgewogICAgICAgICAgICBpZiAoIShv\nYmogaW5zdGFuY2VvZiBDb21wbGV0aW9uS2V5KSkgewogICAgICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIENv\nbXBsZXRpb25LZXkgdGhhdCA9IChDb21wbGV0aW9uS2V5KSBvYmo7CiAgICAg\nICAgICAgIHJldHVybiB0aGlzLnR4bklkID09IHRoYXQudHhuSWQgJiYgdGhp\ncy5vcGVyYXRpb25UeXBlID09IHRoYXQub3BlcmF0aW9uVHlwZTsKICAgICAg\nICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgaGFz\naENvZGUoKSB7CiAgICAgICAgICAgIHJldHVybiAoKGludCkgdHhuSWQpOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0\ncmluZyB0b1N0cmluZygpIHsKICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5m\nb3JtYXQoIlR4bklkKCVkKSwgT3BlcmF0aW9uVHlwZSglcykiLCB0eG5JZCwg\nb3BlcmF0aW9uVHlwZSk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIGxv\nbmcgZWxhcHNlZFRpbWUoKSB7CiAgICAgICAgICAgIHJldHVybiBNYXRoVXRp\nbHMuZWxhcHNlZE1TZWMocmVxdWVzdEF0KTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHJ1bihUaW1lb3V0IHRp\nbWVvdXQpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBpZiAodGlt\nZW91dC5pc0NhbmNlbGxlZCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKE9wZXJhdGlvblR5cGUu\nQUREX0VOVFJZID09IG9wZXJhdGlvblR5cGUpIHsKICAgICAgICAgICAgICAg\nIGVycm9yT3V0QWRkS2V5KHRoaXMpOwogICAgICAgICAgICAgICAgYWRkVGlt\nZW91dE9wTG9nZ2VyLnJlZ2lzdGVyU3VjY2Vzc2Z1bEV2ZW50KGVsYXBzZWRU\naW1lKCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nZXJyb3JPdXRSZWFkS2V5KHRoaXMpOwogICAgICAgICAgICAgICAgcmVhZFRp\nbWVvdXRPcExvZ2dlci5yZWdpc3RlclN1Y2Nlc3NmdWxFdmVudChlbGFwc2Vk\nVGltZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIE5vdGUgOiBIZWxwZXIgZnVuY3Rpb25zIGZvbGxvdwogICAg\nICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gc3RhdHVzCiAgICAgKiBAcmV0\ndXJuIG51bGwgaWYgdGhlIHN0YXR1c2NvZGUgaXMgdW5rbm93bi4KICAgICAq\nLwogICAgcHJpdmF0ZSBJbnRlZ2VyIHN0YXR1c0NvZGVUb0V4Y2VwdGlvbkNv\nZGUoU3RhdHVzQ29kZSBzdGF0dXMpIHsKICAgICAgICBJbnRlZ2VyIHJjVG9S\nZXQgPSBudWxsOwogICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7CiAgICAgICAg\nICAgIGNhc2UgRU9LOgogICAgICAgICAgICAgICAgcmNUb1JldCA9IEJLRXhj\nZXB0aW9uLkNvZGUuT0s7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBFTk9FTlRSWToKICAgICAgICAgICAgICAgIHJjVG9SZXQg\nPSBCS0V4Y2VwdGlvbi5Db2RlLk5vU3VjaEVudHJ5RXhjZXB0aW9uOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRU5PTEVER0VS\nOgogICAgICAgICAgICAgICAgcmNUb1JldCA9IEJLRXhjZXB0aW9uLkNvZGUu\nTm9TdWNoTGVkZ2VyRXhpc3RzRXhjZXB0aW9uOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRUJBRFZFUlNJT046CiAgICAgICAg\nICAgICAgICByY1RvUmV0ID0gQktFeGNlcHRpb24uQ29kZS5Qcm90b2NvbFZl\ncnNpb25FeGNlcHRpb247CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBFVUE6CiAgICAgICAgICAgICAgICByY1RvUmV0ID0gQktF\neGNlcHRpb24uQ29kZS5VbmF1dGhvcml6ZWRBY2Nlc3NFeGNlcHRpb247CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBFRkVOQ0VE\nOgogICAgICAgICAgICAgICAgcmNUb1JldCA9IEJLRXhjZXB0aW9uLkNvZGUu\nTGVkZ2VyRmVuY2VkRXhjZXB0aW9uOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJjVG9SZXQ7CiAgICB9CgogICAg\ncHJpdmF0ZSBsb25nIGdldFR4bklkKCkgewogICAgICAgIHJldHVybiB0eG5J\nZEdlbmVyYXRvci5pbmNyZW1lbnRBbmRHZXQoKTsKICAgIH0KCn0K\n","encoding":"base64"}

