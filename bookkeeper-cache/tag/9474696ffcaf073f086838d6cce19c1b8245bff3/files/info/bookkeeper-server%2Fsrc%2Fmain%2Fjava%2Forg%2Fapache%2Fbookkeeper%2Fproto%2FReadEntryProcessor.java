{"sha":"385cf022b7b362efdac561fc8bbd8a8e8fc1ec6b","node_id":"MDQ6QmxvYjE1NzU5NTY6Mzg1Y2YwMjJiN2IzNjJlZmRhYzU2MWZjOGJiZDhhOGU4ZmMxZWM2Yg==","size":6018,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/385cf022b7b362efdac561fc8bbd8a8e8fc1ec6b","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG87CgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmlvLkJ5dGVCdWZmZXI7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5FeGVjdXRpb25FeGNlcHRp\nb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5GdXR1cmU7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LlRpbWVvdXRFeGNlcHRpb247CgppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5Cb29raWU7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tpZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29raWVQcm90b2Nv\nbC5SZXF1ZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwu\nTWF0aFV0aWxzOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hh\nbm5lbDsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyRmFjdG9yeTsKCmNsYXNzIFJlYWRFbnRyeVByb2Nlc3NvciBl\neHRlbmRzIFBhY2tldFByb2Nlc3NvckJhc2UgewogICAgcHJpdmF0ZSBmaW5h\nbCBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2Vy\nKFJlYWRFbnRyeVByb2Nlc3Nvci5jbGFzcyk7CgogICAgcHVibGljIFJlYWRF\nbnRyeVByb2Nlc3NvcihSZXF1ZXN0IHJlcXVlc3QsIENoYW5uZWwgY2hhbm5l\nbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQm9va2llUmVxdWVz\ndFByb2Nlc3NvciByZXF1ZXN0UHJvY2Vzc29yKSB7CiAgICAgICAgc3VwZXIo\ncmVxdWVzdCwgY2hhbm5lbCwgcmVxdWVzdFByb2Nlc3Nvcik7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBwcm9jZXNzUGFja2V0\nKCkgewogICAgICAgIGFzc2VydCAocmVxdWVzdCBpbnN0YW5jZW9mIEJvb2tp\nZVByb3RvY29sLlJlYWRSZXF1ZXN0KTsKICAgICAgICBCb29raWVQcm90b2Nv\nbC5SZWFkUmVxdWVzdCByZWFkID0gKEJvb2tpZVByb3RvY29sLlJlYWRSZXF1\nZXN0KSByZXF1ZXN0OwoKICAgICAgICBMT0cuZGVidWcoIlJlY2VpdmVkIG5l\ndyByZWFkIHJlcXVlc3Q6IHt9IiwgcmVxdWVzdCk7CiAgICAgICAgaW50IGVy\ncm9yQ29kZSA9IEJvb2tpZVByb3RvY29sLkVJTzsKICAgICAgICBsb25nIHN0\nYXJ0VGltZU5hbm9zID0gTWF0aFV0aWxzLm5vd0luTmFubygpOwogICAgICAg\nIEJ5dGVCdWZmZXIgZGF0YSA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgRnV0dXJlPEJvb2xlYW4+IGZlbmNlUmVzdWx0ID0gbnVsbDsKICAg\nICAgICAgICAgaWYgKHJlYWQuaXNGZW5jaW5nUmVxdWVzdCgpKSB7CiAgICAg\nICAgICAgICAgICBMT0cud2FybigiTGVkZ2VyICIgKyByZXF1ZXN0LmdldExl\nZGdlcklkKCkgKyAiIGZlbmNlZCBieSAiICsgY2hhbm5lbC5nZXRSZW1vdGVB\nZGRyZXNzKCkpOwoKICAgICAgICAgICAgICAgIGlmIChyZWFkLmhhc01hc3Rl\ncktleSgpKSB7CiAgICAgICAgICAgICAgICAgICAgZmVuY2VSZXN1bHQgPSBy\nZXF1ZXN0UHJvY2Vzc29yLmJvb2tpZS5mZW5jZUxlZGdlcihyZWFkLmdldExl\nZGdlcklkKCksIHJlYWQuZ2V0TWFzdGVyS2V5KCkpOwogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIlBh\nc3N3b3JkIG5vdCBwcm92aWRlZCwgTm90IHNhZmUgdG8gZmVuY2Uge30iLCBy\nZWFkLmdldExlZGdlcklkKCkpOwogICAgICAgICAgICAgICAgICAgIHRocm93\nIEJvb2tpZUV4Y2VwdGlvbi5jcmVhdGUoQm9va2llRXhjZXB0aW9uLkNvZGUu\nVW5hdXRob3JpemVkQWNjZXNzRXhjZXB0aW9uKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBkYXRhID0gcmVxdWVzdFBy\nb2Nlc3Nvci5ib29raWUucmVhZEVudHJ5KHJlcXVlc3QuZ2V0TGVkZ2VySWQo\nKSwgcmVxdWVzdC5nZXRFbnRyeUlkKCkpOwogICAgICAgICAgICBMT0cuZGVi\ndWcoIiMjIyMjIFJlYWQgZW50cnkgIyMjIyMge30iLCBkYXRhLnJlbWFpbmlu\nZygpKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0gZmVuY2VSZXN1bHQpIHsK\nICAgICAgICAgICAgICAgIC8vIFRPRE86CiAgICAgICAgICAgICAgICAvLyBj\ndXJyZW50bHkgd2UgZG9uJ3QgaGF2ZSByZWFkQ2FsbGJhY2sgdG8gcnVuIGlu\nIHNlcGFyYXRlZCByZWFkCiAgICAgICAgICAgICAgICAvLyB0aHJlYWRzLiBh\nZnRlciBCT09LS0VFUEVSLTQyOSBpcyBjb21wbGV0ZSwgd2UgY291bGQgaW1w\ncm92ZQogICAgICAgICAgICAgICAgLy8gZm9sbG93aW5nIGNvZGUgdG8gbWFr\nZSBpdCBub3Qgd2FpdCBoZXJlCiAgICAgICAgICAgICAgICAvLwogICAgICAg\nICAgICAgICAgLy8gRm9yIG5vdywgc2luY2Ugd2Ugb25seSB0cnkgdG8gd2Fp\ndCBhZnRlciByZWFkIGVudHJ5LiBzbyB3cml0aW5nCiAgICAgICAgICAgICAg\nICAvLyB0byBqb3VybmFsIGFuZCByZWFkIGVudHJ5IGFyZSBleGVjdXRlZCBp\nbiBkaWZmZXJlbnQgdGhyZWFkCiAgICAgICAgICAgICAgICAvLyBpdCB3b3Vs\nZCBiZSBmaW5lLgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICBCb29sZWFuIGZlbmNlZCA9IGZlbmNlUmVzdWx0LmdldCgxMDAw\nLCBUaW1lVW5pdC5NSUxMSVNFQ09ORFMpOwogICAgICAgICAgICAgICAgICAg\nIGlmIChudWxsID09IGZlbmNlZCB8fCAhZmVuY2VkKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIC8vIGlmIGZhaWxlZCB0byBmZW5jZSwgZmFpbCB0aGUg\ncmVhZCByZXF1ZXN0IHRvIG1ha2UgaXQgcmV0cnkuCiAgICAgICAgICAgICAg\nICAgICAgICAgIGVycm9yQ29kZSA9IEJvb2tpZVByb3RvY29sLkVJTzsKICAg\nICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG51bGw7CiAgICAgICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXJy\nb3JDb2RlID0gQm9va2llUHJvdG9jb2wuRU9LOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhj\nZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJJ\nbnRlcnJ1cHRpbmcgZmVuY2UgcmVhZCBlbnRyeSAiICsgcmVhZCwgaWUpOwog\nICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9IEJvb2tpZVByb3RvY29s\nLkVJTzsKICAgICAgICAgICAgICAgICAgICBkYXRhID0gbnVsbDsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4ZWN1dGlvbkV4Y2VwdGlvbiBlZSkgewog\nICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRmFpbGVkIHRvIGZlbmNl\nIHJlYWQgZW50cnkgIiArIHJlYWQsIGVlKTsKICAgICAgICAgICAgICAgICAg\nICBlcnJvckNvZGUgPSBCb29raWVQcm90b2NvbC5FSU87CiAgICAgICAgICAg\nICAgICAgICAgZGF0YSA9IG51bGw7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChUaW1lb3V0RXhjZXB0aW9uIHRlKSB7CiAgICAgICAgICAgICAgICAgICAg\nTE9HLmVycm9yKCJUaW1lb3V0IHRvIGZlbmNlIHJlYWQgZW50cnkgIiArIHJl\nYWQsIHRlKTsKICAgICAgICAgICAgICAgICAgICBlcnJvckNvZGUgPSBCb29r\naWVQcm90b2NvbC5FSU87CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG51\nbGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICBlcnJvckNvZGUgPSBCb29raWVQcm90b2NvbC5FT0s7\nCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChCb29raWUuTm9MZWRn\nZXJFeGNlcHRpb24gZSkgewogICAgICAgICAgICBpZiAoTE9HLmlzVHJhY2VF\nbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3Ig\ncmVhZGluZyAiICsgcmVhZCwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgZXJyb3JDb2RlID0gQm9va2llUHJvdG9jb2wuRU5PTEVER0VSOwogICAg\nICAgIH0gY2F0Y2ggKEJvb2tpZS5Ob0VudHJ5RXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgaWYgKExPRy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHJlYWRpbmcgIiArIHJlYWQsIGUp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVycm9yQ29kZSA9IEJvb2tp\nZVByb3RvY29sLkVOT0VOVFJZOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgaWYgKExPRy5pc1RyYWNlRW5hYmxlZCgp\nKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHJlYWRpbmcg\nIiArIHJlYWQsIGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVycm9y\nQ29kZSA9IEJvb2tpZVByb3RvY29sLkVJTzsKICAgICAgICB9IGNhdGNoIChC\nb29raWVFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIlVu\nYXV0aG9yaXplZCBhY2Nlc3MgdG8gbGVkZ2VyICIgKyByZWFkLmdldExlZGdl\ncklkKCksIGUpOwogICAgICAgICAgICBlcnJvckNvZGUgPSBCb29raWVQcm90\nb2NvbC5FVUE7CiAgICAgICAgfQoKICAgICAgICBMT0cudHJhY2UoIlJlYWQg\nZW50cnkgcmMgPSB7fSBmb3Ige30iLAogICAgICAgICAgICAgICAgbmV3IE9i\namVjdFtdIHsgZXJyb3JDb2RlLCByZWFkIH0pOwogICAgICAgIGlmIChlcnJv\nckNvZGUgPT0gQm9va2llUHJvdG9jb2wuRU9LKSB7CiAgICAgICAgICAgIHJl\ncXVlc3RQcm9jZXNzb3IucmVhZEVudHJ5U3RhdHMucmVnaXN0ZXJTdWNjZXNz\nZnVsRXZlbnQoTWF0aFV0aWxzLmVsYXBzZWRNU2VjKHN0YXJ0VGltZU5hbm9z\nKSk7CiAgICAgICAgICAgIHNlbmRSZXNwb25zZShlcnJvckNvZGUsIFJlc3Bv\nbnNlQnVpbGRlci5idWlsZFJlYWRSZXNwb25zZShkYXRhLCByZWFkKSwKICAg\nICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RQcm9jZXNzb3IucmVhZFJl\ncXVlc3RTdGF0cyk7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJl\ncXVlc3RQcm9jZXNzb3IucmVhZEVudHJ5U3RhdHMucmVnaXN0ZXJGYWlsZWRF\ndmVudChNYXRoVXRpbHMuZWxhcHNlZE1TZWMoc3RhcnRUaW1lTmFub3MpKTsK\nICAgICAgICAgICAgc2VuZFJlc3BvbnNlKGVycm9yQ29kZSwgUmVzcG9uc2VC\ndWlsZGVyLmJ1aWxkRXJyb3JSZXNwb25zZShlcnJvckNvZGUsIHJlYWQpLAog\nICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFByb2Nlc3Nvci5yZWFk\nUmVxdWVzdFN0YXRzKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

