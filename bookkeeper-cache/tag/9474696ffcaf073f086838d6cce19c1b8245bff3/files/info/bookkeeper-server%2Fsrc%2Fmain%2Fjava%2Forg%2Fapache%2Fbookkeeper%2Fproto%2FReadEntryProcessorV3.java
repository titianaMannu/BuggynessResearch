{"sha":"03517789625a5c17e474dec00579a6d69b6f6d82","node_id":"MDQ6QmxvYjE1NzU5NTY6MDM1MTc3ODk2MjVhNWMxN2U0NzRkZWMwMDU3OWE2ZDY5YjZmNmQ4Mg==","size":7453,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/03517789625a5c17e474dec00579a6d69b6f6d82","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG87CgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmlvLkJ5dGVCdWZmZXI7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5FeGVjdXRpb25FeGNlcHRp\nb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5GdXR1cmU7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LlRpbWVvdXRFeGNlcHRpb247CgppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5Cb29raWU7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tpZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVhZFJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlJlYWRSZXNwb25zZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVyUHJv\ndG9jb2wuUmVxdWVzdDsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVyUHJvdG9jb2wuUmVzcG9uc2U7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlclByb3RvY29sLlN0\nYXR1c0NvZGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5N\nYXRoVXRpbHM7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5DaGFu\nbmVsOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0\nai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYu\nQnl0ZVN0cmluZzsKCmNsYXNzIFJlYWRFbnRyeVByb2Nlc3NvclYzIGV4dGVu\nZHMgUGFja2V0UHJvY2Vzc29yQmFzZVYzIGltcGxlbWVudHMgUnVubmFibGUg\newoKICAgIHByaXZhdGUgZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dn\nZXJGYWN0b3J5LmdldExvZ2dlcihSZWFkRW50cnlQcm9jZXNzb3JWMy5jbGFz\ncyk7CgogICAgcHVibGljIFJlYWRFbnRyeVByb2Nlc3NvclYzKFJlcXVlc3Qg\ncmVxdWVzdCwgQ2hhbm5lbCBjaGFubmVsLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIEJvb2tpZVJlcXVlc3RQcm9jZXNzb3IgcmVxdWVzdFBy\nb2Nlc3NvcikgewogICAgICAgIHN1cGVyKHJlcXVlc3QsIGNoYW5uZWwsIHJl\ncXVlc3RQcm9jZXNzb3IpOwogICAgfQoKICAgIHByaXZhdGUgUmVhZFJlc3Bv\nbnNlIGdldFJlYWRSZXNwb25zZSgpIHsKICAgICAgICBsb25nIHN0YXJ0VGlt\nZU5hbm9zID0gTWF0aFV0aWxzLm5vd0luTmFubygpOwogICAgICAgIFJlYWRS\nZXF1ZXN0IHJlYWRSZXF1ZXN0ID0gcmVxdWVzdC5nZXRSZWFkUmVxdWVzdCgp\nOwogICAgICAgIGxvbmcgbGVkZ2VySWQgPSByZWFkUmVxdWVzdC5nZXRMZWRn\nZXJJZCgpOwogICAgICAgIGxvbmcgZW50cnlJZCA9IHJlYWRSZXF1ZXN0Lmdl\ndEVudHJ5SWQoKTsKCiAgICAgICAgUmVhZFJlc3BvbnNlLkJ1aWxkZXIgcmVh\nZFJlc3BvbnNlID0gUmVhZFJlc3BvbnNlLm5ld0J1aWxkZXIoKQogICAgICAg\nICAgICAgICAgLnNldExlZGdlcklkKGxlZGdlcklkKQogICAgICAgICAgICAg\nICAgLnNldEVudHJ5SWQoZW50cnlJZCk7CgogICAgICAgIGlmICghaXNWZXJz\naW9uQ29tcGF0aWJsZSgpKSB7CiAgICAgICAgICAgIHJlYWRSZXNwb25zZS5z\nZXRTdGF0dXMoU3RhdHVzQ29kZS5FQkFEVkVSU0lPTik7CiAgICAgICAgICAg\nIHJldHVybiByZWFkUmVzcG9uc2UuYnVpbGQoKTsKICAgICAgICB9CgogICAg\nICAgIExPRy5kZWJ1ZygiUmVjZWl2ZWQgbmV3IHJlYWQgcmVxdWVzdDoge30i\nLCByZXF1ZXN0KTsKICAgICAgICBTdGF0dXNDb2RlIHN0YXR1czsKICAgICAg\nICBCeXRlQnVmZmVyIGVudHJ5Qm9keTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBGdXR1cmU8Qm9vbGVhbj4gZmVuY2VSZXN1bHQgPSBudWxsOwogICAg\nICAgICAgICBpZiAocmVhZFJlcXVlc3QuaGFzRmxhZygpICYmIHJlYWRSZXF1\nZXN0LmdldEZsYWcoKS5lcXVhbHMoUmVhZFJlcXVlc3QuRmxhZy5GRU5DRV9M\nRURHRVIpKSB7CiAgICAgICAgICAgICAgICBMT0cud2FybigiTGVkZ2VyIGZl\nbmNlIHJlcXVlc3QgcmVjZWl2ZWQgZm9yIGxlZGdlcjoge30gZnJvbSBhZGRy\nZXNzOiB7fSIsIGxlZGdlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAg\nY2hhbm5lbC5nZXRSZW1vdGVBZGRyZXNzKCkpOwoKICAgICAgICAgICAgICAg\nIGlmIChyZWFkUmVxdWVzdC5oYXNNYXN0ZXJLZXkoKSkgewogICAgICAgICAg\nICAgICAgICAgIGJ5dGVbXSBtYXN0ZXJLZXkgPSByZWFkUmVxdWVzdC5nZXRN\nYXN0ZXJLZXkoKS50b0J5dGVBcnJheSgpOwogICAgICAgICAgICAgICAgICAg\nIGZlbmNlUmVzdWx0ID0gcmVxdWVzdFByb2Nlc3Nvci5ib29raWUuZmVuY2VM\nZWRnZXIobGVkZ2VySWQsIG1hc3RlcktleSk7CiAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRmVuY2Ug\nbGVkZ2VyIHJlcXVlc3QgcmVjZWl2ZWQgd2l0aG91dCBtYXN0ZXIga2V5IGZv\nciBsZWRnZXI6e30gZnJvbSBhZGRyZXNzOiB7fSIsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxlZGdlcklkLCBjaGFubmVsLmdldFJlbW90ZUFk\nZHJlc3MoKSk7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgQm9va2llRXhj\nZXB0aW9uLmNyZWF0ZShCb29raWVFeGNlcHRpb24uQ29kZS5VbmF1dGhvcml6\nZWRBY2Nlc3NFeGNlcHRpb24pOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGVudHJ5Qm9keSA9IHJlcXVlc3RQcm9jZXNz\nb3IuYm9va2llLnJlYWRFbnRyeShsZWRnZXJJZCwgZW50cnlJZCk7CiAgICAg\nICAgICAgIGlmIChudWxsICE9IGZlbmNlUmVzdWx0KSB7CiAgICAgICAgICAg\nICAgICAvLyBUT0RPOgogICAgICAgICAgICAgICAgLy8gY3VycmVudGx5IHdl\nIGRvbid0IGhhdmUgcmVhZENhbGxiYWNrIHRvIHJ1biBpbiBzZXBhcmF0ZWQg\ncmVhZAogICAgICAgICAgICAgICAgLy8gdGhyZWFkcy4gYWZ0ZXIgQk9PS0tF\nRVBFUi00MjkgaXMgY29tcGxldGUsIHdlIGNvdWxkIGltcHJvdmUKICAgICAg\nICAgICAgICAgIC8vIGZvbGxvd2luZyBjb2RlIHRvIG1ha2UgaXQgbm90IHdh\naXQgaGVyZQogICAgICAgICAgICAgICAgLy8KICAgICAgICAgICAgICAgIC8v\nIEZvciBub3csIHNpbmNlIHdlIG9ubHkgdHJ5IHRvIHdhaXQgYWZ0ZXIgcmVh\nZCBlbnRyeS4gc28gd3JpdGluZwogICAgICAgICAgICAgICAgLy8gdG8gam91\ncm5hbCBhbmQgcmVhZCBlbnRyeSBhcmUgZXhlY3V0ZWQgaW4gZGlmZmVyZW50\nIHRocmVhZAogICAgICAgICAgICAgICAgLy8gaXQgd291bGQgYmUgZmluZS4K\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgQm9v\nbGVhbiBmZW5jZWQgPSBmZW5jZVJlc3VsdC5nZXQoMTAwMCwgVGltZVVuaXQu\nTUlMTElTRUNPTkRTKTsKICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9\nPSBmZW5jZWQgfHwgIWZlbmNlZCkgewogICAgICAgICAgICAgICAgICAgICAg\nICAvLyBpZiBmYWlsZWQgdG8gZmVuY2UsIGZhaWwgdGhlIHJlYWQgcmVxdWVz\ndCB0byBtYWtlIGl0IHJldHJ5LgogICAgICAgICAgICAgICAgICAgICAgICBz\ndGF0dXMgPSBTdGF0dXNDb2RlLkVJTzsKICAgICAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSBTdGF0\ndXNDb2RlLkVPSzsKICAgICAgICAgICAgICAgICAgICAgICAgcmVhZFJlc3Bv\nbnNlLnNldEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJvbShlbnRyeUJvZHkpKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAg\nICAgIExPRy5lcnJvcigiSW50ZXJydXB0aW5nIGZlbmNlIHJlYWQgZW50cnkg\nKGxpZDoge30sIGVpZDoge30pIiwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbmV3IE9iamVjdFtdIHsgbGVkZ2VySWQsIGVudHJ5SWQsIGllIH0p\nOwogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IFN0YXR1c0NvZGUuRUlP\nOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhlY3V0aW9uRXhjZXB0aW9u\nIGVlKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJGYWlsZWQg\ndG8gZmVuY2UgcmVhZCBlbnRyeSAobGlkOiB7fSwgZWlkOiB7fSkiLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgT2JqZWN0W10geyBsZWRn\nZXJJZCwgZW50cnlJZCwgZWUgfSk7CiAgICAgICAgICAgICAgICAgICAgc3Rh\ndHVzID0gU3RhdHVzQ29kZS5FSU87CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChUaW1lb3V0RXhjZXB0aW9uIHRlKSB7CiAgICAgICAgICAgICAgICAgICAg\nTE9HLmVycm9yKCJUaW1lb3V0IHRvIGZlbmNlIHJlYWQgZW50cnkgKGxpZDog\ne30sIGVpZDoge30pIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbmV3IE9iamVjdFtdIHsgbGVkZ2VySWQsIGVudHJ5SWQsIHRlIH0pOwogICAg\nICAgICAgICAgICAgICAgIHN0YXR1cyA9IFN0YXR1c0NvZGUuRUlPOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgcmVhZFJlc3BvbnNlLnNldEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJv\nbShlbnRyeUJvZHkpKTsKICAgICAgICAgICAgICAgIHN0YXR1cyA9IFN0YXR1\nc0NvZGUuRU9LOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoQm9v\na2llLk5vTGVkZ2VyRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgc3RhdHVz\nID0gU3RhdHVzQ29kZS5FTk9MRURHRVI7CiAgICAgICAgICAgIExPRy5lcnJv\ncigiTm8gbGVkZ2VyIGZvdW5kIHdoaWxlIHJlYWRpbmcgZW50cnk6e30gZnJv\nbSBsZWRnZXI6IHt9IiwgZW50cnlJZCwgbGVkZ2VySWQpOwogICAgICAgIH0g\nY2F0Y2ggKEJvb2tpZS5Ob0VudHJ5RXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgc3RhdHVzID0gU3RhdHVzQ29kZS5FTk9FTlRSWTsKICAgICAgICAgICAg\naWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBM\nT0cuZGVidWcoIk5vIGVudHJ5IGZvdW5kIHdoaWxlIHJlYWRpbmcgZW50cnk6\ne30gZnJvbSBsZWRnZXI6e30iLCBlbnRyeUlkLCBsZWRnZXJJZCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIHN0YXR1cyA9IFN0YXR1c0NvZGUuRUlPOwogICAgICAgICAg\nICBMT0cuZXJyb3IoIklPRXhjZXB0aW9uIHdoaWxlIHJlYWRpbmcgZW50cnk6\ne30gZnJvbSBsZWRnZXI6e30iLCBlbnRyeUlkLCBsZWRnZXJJZCk7CiAgICAg\nICAgfSBjYXRjaCAoQm9va2llRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nTE9HLmVycm9yKCJVbmF1dGhvcml6ZWQgYWNjZXNzIHRvIGxlZGdlcjp7fSB3\naGlsZSByZWFkaW5nIGVudHJ5Ont9IGluIHJlcXVlc3QgZnJvbSBhZGRyZXNz\nOiB7fSIsCiAgICAgICAgICAgICAgICAgICAgbmV3IE9iamVjdFtde2xlZGdl\ncklkLCBlbnRyeUlkLCBjaGFubmVsLmdldFJlbW90ZUFkZHJlc3MoKX0pOwog\nICAgICAgICAgICBzdGF0dXMgPSBTdGF0dXNDb2RlLkVVQTsKICAgICAgICB9\nCgogICAgICAgIGlmIChzdGF0dXMgPT0gU3RhdHVzQ29kZS5FT0spIHsKICAg\nICAgICAgICAgcmVxdWVzdFByb2Nlc3Nvci5yZWFkRW50cnlTdGF0cy5yZWdp\nc3RlclN1Y2Nlc3NmdWxFdmVudChNYXRoVXRpbHMuZWxhcHNlZE1TZWMoc3Rh\ncnRUaW1lTmFub3MpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBy\nZXF1ZXN0UHJvY2Vzc29yLnJlYWRFbnRyeVN0YXRzLnJlZ2lzdGVyRmFpbGVk\nRXZlbnQoTWF0aFV0aWxzLmVsYXBzZWRNU2VjKHN0YXJ0VGltZU5hbm9zKSk7\nCiAgICAgICAgfQoKICAgICAgICAvLyBGaW5hbGx5IHNldCBzdGF0dXMgYW5k\nIHJldHVybi4gVGhlIGJvZHkgd291bGQgaGF2ZSBiZWVuIHVwZGF0ZWQgaWYK\nICAgICAgICAvLyBhIHJlYWQgd2VudCB0aHJvdWdoLgogICAgICAgIHJlYWRS\nZXNwb25zZS5zZXRTdGF0dXMoc3RhdHVzKTsKICAgICAgICByZXR1cm4gcmVh\nZFJlc3BvbnNlLmJ1aWxkKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgUmVhZFJlc3BvbnNlIHJlYWRS\nZXNwb25zZSA9IGdldFJlYWRSZXNwb25zZSgpOwogICAgICAgIHNlbmRSZXNw\nb25zZShyZWFkUmVzcG9uc2UpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBz\nZW5kUmVzcG9uc2UoUmVhZFJlc3BvbnNlIHJlYWRSZXNwb25zZSkgewogICAg\nICAgIFJlc3BvbnNlLkJ1aWxkZXIgcmVzcG9uc2UgPSBSZXNwb25zZS5uZXdC\ndWlsZGVyKCkKICAgICAgICAgICAgICAgIC5zZXRIZWFkZXIoZ2V0SGVhZGVy\nKCkpCiAgICAgICAgICAgICAgICAuc2V0U3RhdHVzKHJlYWRSZXNwb25zZS5n\nZXRTdGF0dXMoKSkKICAgICAgICAgICAgICAgIC5zZXRSZWFkUmVzcG9uc2Uo\ncmVhZFJlc3BvbnNlKTsKICAgICAgICBzZW5kUmVzcG9uc2UocmVzcG9uc2Uu\nZ2V0U3RhdHVzKCksCiAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmJ1\naWxkKCksCiAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RQcm9jZXNzb3Iu\ncmVhZFJlcXVlc3RTdGF0cyk7CiAgICB9Cn0KCg==\n","encoding":"base64"}

