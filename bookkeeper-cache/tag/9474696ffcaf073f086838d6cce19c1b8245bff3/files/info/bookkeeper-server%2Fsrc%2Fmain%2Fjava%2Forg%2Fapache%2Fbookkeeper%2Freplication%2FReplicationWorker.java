{"sha":"02154e580512d2e3e3577ba3722a6925d4b98bdb","node_id":"MDQ6QmxvYjE1NzU5NTY6MDIxNTRlNTgwNTEyZDJlM2UzNTc3YmEzNzIyYTY5MjVkNGI5OGJkYg==","size":19322,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/02154e580512d2e3e3577ba3722a6925d4b98bdb","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNo\nZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVp\ncmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5n\nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBp\ncyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VU\nIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0\naGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3Ig\ndGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9u\ncyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAq\nLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlvbjsK\nCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGls\nLlRpbWVyOwppbXBvcnQgamF2YS51dGlsLlRpbWVyVGFzazsKaW1wb3J0IGph\ndmEudXRpbC5Tb3J0ZWRNYXA7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0\nOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKCmltcG9ydCBjb20uZ29v\nZ2xlLmNvbW1vbi5iYXNlLlN0b3B3YXRjaDsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5ib29raWUuQm9va2llVGhyZWFkOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb24uQktCb29r\naWVIYW5kbGVOb3RBdmFpbGFibGVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uLkJLTm9TdWNoTGVk\nZ2VyRXhpc3RzRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5CS0V4Y2VwdGlvbi5CS1JlYWRFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXJB\nZG1pbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVk\nZ2VyQ2hlY2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGll\nbnQuTGVkZ2VyRnJhZ21lbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuTGVkZ2VyTWV0YWRhdGE7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdl\nck1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLm1ldGEuTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIubmV0LkJvb2tpZVNvY2tldEFkZHJlc3M7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBl\nckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWNDYWxsYmFjazsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlvbi5SZXBsaWNhdGlvbkV4\nY2VwdGlvbi5Db21wYXRpYmlsaXR5RXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnJlcGxpY2F0aW9uLlJlcGxpY2F0aW9uRXhjZXB0\naW9uLlVuYXZhaWxhYmxlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnN0YXRzLk51bGxTdGF0c0xvZ2dlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5zdGF0cy5PcFN0YXRzTG9nZ2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnN0YXRzLlN0YXRzTG9nZ2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwoKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGlj\nYXRpb24uUmVwbGljYXRpb25TdGF0cy5CS19DTElFTlRfU0NPUEU7CmltcG9y\ndCBzdGF0aWMgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnJlcGxpY2F0aW9uLlJl\ncGxpY2F0aW9uU3RhdHMuUkVSRVBMSUNBVEVfT1A7CgovKioKICogUmVwbGlj\nYXRpb25Xb3JrZXIgd2lsbCB0YWtlIHRoZSBmcmFnbWVudHMgb25lIGJ5IG9u\nZSBmcm9tCiAqIFpLTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIgYW5k\nIHJlcGxpY2F0ZXMgdG8gaXQuCiAqLwpwdWJsaWMgY2xhc3MgUmVwbGljYXRp\nb25Xb3JrZXIgaW1wbGVtZW50cyBSdW5uYWJsZSB7CiAgICBwcml2YXRlIGZp\nbmFsIHN0YXRpYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeQogICAgICAg\nICAgICAuZ2V0TG9nZ2VyKFJlcGxpY2F0aW9uV29ya2VyLmNsYXNzKTsKICAg\nIGZpbmFsIHByaXZhdGUgTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIg\ndW5kZXJyZXBsaWNhdGlvbk1hbmFnZXI7CiAgICBwcml2YXRlIGZpbmFsIFNl\ncnZlckNvbmZpZ3VyYXRpb24gY29uZjsKICAgIHByaXZhdGUgZmluYWwgWm9v\nS2VlcGVyIHprYzsKICAgIHByaXZhdGUgdm9sYXRpbGUgYm9vbGVhbiB3b3Jr\nZXJSdW5uaW5nID0gZmFsc2U7CiAgICBmaW5hbCBwcml2YXRlIEJvb2tLZWVw\nZXJBZG1pbiBhZG1pbjsKICAgIHByaXZhdGUgZmluYWwgTGVkZ2VyQ2hlY2tl\nciBsZWRnZXJDaGVja2VyOwogICAgcHJpdmF0ZSBmaW5hbCBCb29raWVTb2Nr\nZXRBZGRyZXNzIHRhcmdldEJvb2tpZTsKICAgIHByaXZhdGUgZmluYWwgQm9v\na0tlZXBlciBia2M7CiAgICBwcml2YXRlIGZpbmFsIFRocmVhZCB3b3JrZXJU\naHJlYWQ7CiAgICBwcml2YXRlIGZpbmFsIGxvbmcgb3BlbkxlZGdlclJlcmVw\nbGljYXRpb25HcmFjZVBlcmlvZDsKICAgIHByaXZhdGUgZmluYWwgVGltZXIg\ncGVuZGluZ1JlcGxpY2F0aW9uVGltZXI7CgogICAgLy8gRXhwb3NlIFN0YXRz\nCiAgICBwcml2YXRlIGZpbmFsIE9wU3RhdHNMb2dnZXIgcmVyZXBsaWNhdGVP\ncFN0YXRzOwoKICAgIC8qKgogICAgICogUmVwbGljYXRpb24gd29ya2VyIGZv\nciByZXBsaWNhdGluZyB0aGUgbGVkZ2VyIGZyYWdtZW50cyBmcm9tCiAgICAg\nKiBVbmRlclJlcGxpY2F0aW9uTWFuYWdlciB0byB0aGUgdGFyZ2V0Qm9va2ll\nLiBUaGlzIHRhcmdldCBib29raWUgd2lsbCBiZSBhCiAgICAgKiBsb2NhbCBi\nb29raWUuCiAgICAgKgogICAgICogQHBhcmFtIHprYwogICAgICogICAgICAg\nICAgICAtIFpLIGluc3RhbmNlCiAgICAgKiBAcGFyYW0gY29uZgogICAgICog\nICAgICAgICAgICAtIGNvbmZpZ3VyYXRpb25zCiAgICAgKiBAcGFyYW0gdGFy\nZ2V0QktBZGRyCiAgICAgKiAgICAgICAgICAgIC0gdG8gd2hlcmUgcmVwbGlj\nYXRpb24gc2hvdWxkIGhhcHBlbi4gSWRlYWxseSB0aGlzIHdpbGwgYmUKICAg\nICAqICAgICAgICAgICAgbG9jYWwgQm9va2llIGFkZHJlc3MuCiAgICAgKi8K\nICAgIHB1YmxpYyBSZXBsaWNhdGlvbldvcmtlcihmaW5hbCBab29LZWVwZXIg\nemtjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIFNlcnZl\nckNvbmZpZ3VyYXRpb24gY29uZiwgQm9va2llU29ja2V0QWRkcmVzcyB0YXJn\nZXRCS0FkZHIpCiAgICAgICAgICAgIHRocm93cyBDb21wYXRpYmlsaXR5RXhj\nZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24sCiAgICAgICAgICAgIEludGVycnVw\ndGVkRXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiB7CiAgICAgICAgdGhpcyh6a2Ms\nIGNvbmYsIHRhcmdldEJLQWRkciwgTnVsbFN0YXRzTG9nZ2VyLklOU1RBTkNF\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcGxpY2F0aW9uIHdvcmtlciBm\nb3IgcmVwbGljYXRpbmcgdGhlIGxlZGdlciBmcmFnbWVudHMgZnJvbQogICAg\nICogVW5kZXJSZXBsaWNhdGlvbk1hbmFnZXIgdG8gdGhlIHRhcmdldEJvb2tp\nZS4gVGhpcyB0YXJnZXQgYm9va2llIHdpbGwgYmUgYQogICAgICogbG9jYWwg\nYm9va2llLgogICAgICoKICAgICAqIEBwYXJhbSB6a2MKICAgICAqICAgICAg\nICAgICAgLSBaSyBpbnN0YW5jZQogICAgICogQHBhcmFtIGNvbmYKICAgICAq\nICAgICAgICAgICAgLSBjb25maWd1cmF0aW9ucwogICAgICogQHBhcmFtIHRh\ncmdldEJLQWRkcgogICAgICogICAgICAgICAgICAtIHRvIHdoZXJlIHJlcGxp\nY2F0aW9uIHNob3VsZCBoYXBwZW4uIElkZWFsbHkgdGhpcyB3aWxsIGJlCiAg\nICAgKiAgICAgICAgICAgIGxvY2FsIEJvb2tpZSBhZGRyZXNzLgogICAgICov\nCiAgICBwdWJsaWMgUmVwbGljYXRpb25Xb3JrZXIoZmluYWwgWm9vS2VlcGVy\nIHprYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBTZXJ2\nZXJDb25maWd1cmF0aW9uIGNvbmYsIEJvb2tpZVNvY2tldEFkZHJlc3MgdGFy\nZ2V0QktBZGRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRz\nTG9nZ2VyIHN0YXRzTG9nZ2VyKQogICAgICAgICAgICB0aHJvd3MgQ29tcGF0\naWJpbGl0eUV4Y2VwdGlvbiwgS2VlcGVyRXhjZXB0aW9uLAogICAgICAgICAg\nICBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAgICAg\nIHRoaXMuemtjID0gemtjOwogICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CiAg\nICAgICAgdGhpcy50YXJnZXRCb29raWUgPSB0YXJnZXRCS0FkZHI7CiAgICAg\nICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkgbUZhY3RvcnkgPSBMZWRnZXJNYW5h\nZ2VyRmFjdG9yeQogICAgICAgICAgICAgICAgLm5ld0xlZGdlck1hbmFnZXJG\nYWN0b3J5KHRoaXMuY29uZiwgdGhpcy56a2MpOwogICAgICAgIHRoaXMudW5k\nZXJyZXBsaWNhdGlvbk1hbmFnZXIgPSBtRmFjdG9yeQogICAgICAgICAgICAg\nICAgLm5ld0xlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2VyKCk7CiAgICAg\nICAgdGhpcy5ia2MgPSBCb29rS2VlcGVyLmZvckNvbmZpZyhuZXcgQ2xpZW50\nQ29uZmlndXJhdGlvbihjb25mKSkKICAgICAgICAgICAgICAgIC5zZXRab29r\nZWVwZXIoemtjKQogICAgICAgICAgICAgICAgLnNldFN0YXRzTG9nZ2VyKHN0\nYXRzTG9nZ2VyLnNjb3BlKEJLX0NMSUVOVF9TQ09QRSkpCiAgICAgICAgICAg\nICAgICAuYnVpbGQoKTsKICAgICAgICB0aGlzLmFkbWluID0gbmV3IEJvb2tL\nZWVwZXJBZG1pbihia2MpOwogICAgICAgIHRoaXMubGVkZ2VyQ2hlY2tlciA9\nIG5ldyBMZWRnZXJDaGVja2VyKGJrYyk7CiAgICAgICAgdGhpcy53b3JrZXJU\naHJlYWQgPSBuZXcgQm9va2llVGhyZWFkKHRoaXMsICJSZXBsaWNhdGlvbldv\ncmtlciIpOwogICAgICAgIHRoaXMub3BlbkxlZGdlclJlcmVwbGljYXRpb25H\ncmFjZVBlcmlvZCA9IGNvbmYKICAgICAgICAgICAgICAgIC5nZXRPcGVuTGVk\nZ2VyUmVyZXBsaWNhdGlvbkdyYWNlUGVyaW9kKCk7CiAgICAgICAgdGhpcy5w\nZW5kaW5nUmVwbGljYXRpb25UaW1lciA9IG5ldyBUaW1lcigiUGVuZGluZ1Jl\ncGxpY2F0aW9uVGltZXIiKTsKCiAgICAgICAgLy8gRXhwb3NlIFN0YXRzCiAg\nICAgICAgdGhpcy5yZXJlcGxpY2F0ZU9wU3RhdHMgPSBzdGF0c0xvZ2dlci5n\nZXRPcFN0YXRzTG9nZ2VyKFJFUkVQTElDQVRFX09QKTsKICAgIH0KCiAgICAv\nKiogU3RhcnQgdGhlIHJlcGxpY2F0aW9uIHdvcmtlciAqLwogICAgcHVibGlj\nIHZvaWQgc3RhcnQoKSB7CiAgICAgICAgdGhpcy53b3JrZXJUaHJlYWQuc3Rh\ncnQoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHJ1\nbigpIHsKICAgICAgICB3b3JrZXJSdW5uaW5nID0gdHJ1ZTsKICAgICAgICB3\naGlsZSAod29ya2VyUnVubmluZykgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgcmVyZXBsaWNhdGUoKTsKICAgICAgICAgICAgfSBjYXRj\naCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nc2h1dGRvd24oKTsKICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhy\nZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgICAgICBMT0cuaW5mbygi\nSW50ZXJydXB0ZWRFeGNlcHRpb24gIgogICAgICAgICAgICAgICAgICAgICAg\nICArICJ3aGlsZSByZXBsaWNhdGluZyBmcmFnbWVudHMiLCBlKTsKICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfSBjYXRjaCAoQktFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgc2h1dGRvd24oKTsKICAgICAg\nICAgICAgICAgIExPRy5lcnJvcigiQktFeGNlcHRpb24gd2hpbGUgcmVwbGlj\nYXRpbmcgZnJhZ21lbnRzIiwgZSk7CiAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFVuYXZhaWxhYmxlRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIHNodXRkb3duKCk7CiAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIlVuYXZhaWxhYmxlRXhjZXB0aW9uICIKICAgICAgICAg\nICAgICAgICAgICAgICAgKyAid2hpbGUgcmVwbGljYXRpbmcgZnJhZ21lbnRz\nIiwgZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgTE9HLmluZm8oIlJlcGxpY2F0aW9uV29ya2Vy\nIGV4aXRlZCBsb29wISIpOwogICAgfQoKICAgIC8qKgogICAgICogUmVwbGlj\nYXRlcyB0aGUgdW5kZXIgcmVwbGljYXRlZCBmcmFnbWVudHMgZnJvbSBmYWls\nZWQgYm9va2llIGxlZGdlciB0bwogICAgICogdGFyZ2V0Qm9va2llCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCByZXJlcGxpY2F0ZSgpIHRocm93cyBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24sCiAgICAgICAgICAgIFVu\nYXZhaWxhYmxlRXhjZXB0aW9uIHsKICAgICAgICBsb25nIGxlZGdlcklkVG9S\nZXBsaWNhdGUgPSB1bmRlcnJlcGxpY2F0aW9uTWFuYWdlcgogICAgICAgICAg\nICAgICAgLmdldExlZGdlclRvUmVyZXBsaWNhdGUoKTsKCiAgICAgICAgU3Rv\ncHdhdGNoIHN0b3B3YXRjaCA9IG5ldyBTdG9wd2F0Y2goKS5zdGFydCgpOwog\nICAgICAgIGJvb2xlYW4gc3VjY2VzcyA9IGZhbHNlOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHN1Y2Nlc3MgPSByZXJlcGxpY2F0ZShsZWRnZXJJZFRv\nUmVwbGljYXRlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBs\nb25nIGxhdGVuY3lNaWxsaXMgPSBzdG9wd2F0Y2guc3RvcCgpLmVsYXBzZWRN\naWxsaXMoKTsKICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAg\nICAgICAgIHJlcmVwbGljYXRlT3BTdGF0cy5yZWdpc3RlclN1Y2Nlc3NmdWxF\ndmVudChsYXRlbmN5TWlsbGlzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgICAgIHJlcmVwbGljYXRlT3BTdGF0cy5yZWdpc3RlckZhaWxl\nZEV2ZW50KGxhdGVuY3lNaWxsaXMpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiByZXJlcGxpY2F0ZShsb25n\nIGxlZGdlcklkVG9SZXBsaWNhdGUpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiwgQktFeGNlcHRpb24sCiAgICAgICAgICAgIFVuYXZhaWxhYmxlRXhj\nZXB0aW9uIHsKICAgICAgICBMT0cuZGVidWcoIkdvaW5nIHRvIHJlcGxpY2F0\nZSB0aGUgZnJhZ21lbnRzIG9mIHRoZSBsZWRnZXI6IHt9IiwgbGVkZ2VySWRU\nb1JlcGxpY2F0ZSk7CiAgICAgICAgTGVkZ2VySGFuZGxlIGxoOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGxoID0gYWRtaW4ub3BlbkxlZGdlck5vUmVj\nb3ZlcnkobGVkZ2VySWRUb1JlcGxpY2F0ZSk7CiAgICAgICAgfSBjYXRjaCAo\nQktOb1N1Y2hMZWRnZXJFeGlzdHNFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAvLyBMZWRnZXIgbWlnaHQgaGF2ZSBiZWVuIGRlbGV0ZWQgYnkgdXNlcgog\nICAgICAgICAgICBMT0cuaW5mbygiQktOb1N1Y2hMZWRnZXJFeGlzdHNFeGNl\ncHRpb24gd2hpbGUgb3BlbmluZyAiCiAgICAgICAgICAgICAgICAgICAgKyAi\nbGVkZ2VyIGZvciByZXBsaWNhdGlvbi4gT3RoZXIgY2xpZW50cyAiCiAgICAg\nICAgICAgICAgICAgICAgKyAibWlnaHQgaGF2ZSBkZWxldGVkIHRoZSBsZWRn\nZXIuICIKICAgICAgICAgICAgICAgICAgICArICJTbywgbm8gaGFybSB0byBj\nb250aW51ZSIpOwogICAgICAgICAgICB1bmRlcnJlcGxpY2F0aW9uTWFuYWdl\nci5tYXJrTGVkZ2VyUmVwbGljYXRlZChsZWRnZXJJZFRvUmVwbGljYXRlKTsK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gY2F0Y2ggKEJL\nUmVhZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5pbmZvKCJCS1Jl\nYWRFeGNlcHRpb24gd2hpbGUiCiAgICAgICAgICAgICAgICAgICAgKyAiIG9w\nZW5pbmcgbGVkZ2VyIGZvciByZXBsaWNhdGlvbi4iCiAgICAgICAgICAgICAg\nICAgICAgKyAiIEVub3VnaCBCb29raWVzIG1pZ2h0IG5vdCBoYXZlIGF2YWls\nYWJsZSIKICAgICAgICAgICAgICAgICAgICArICJTbywgbm8gaGFybSB0byBj\nb250aW51ZSIpOwogICAgICAgICAgICB1bmRlcnJlcGxpY2F0aW9uTWFuYWdl\ncgogICAgICAgICAgICAgICAgICAgIC5yZWxlYXNlVW5kZXJyZXBsaWNhdGVk\nTGVkZ2VyKGxlZGdlcklkVG9SZXBsaWNhdGUpOwogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgfSBjYXRjaCAoQktCb29raWVIYW5kbGVOb3RB\ndmFpbGFibGVFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuaW5mbygi\nQktCb29raWVIYW5kbGVOb3RBdmFpbGFibGVFeGNlcHRpb24gd2hpbGUiCiAg\nICAgICAgICAgICAgICAgICAgKyAiIG9wZW5pbmcgbGVkZ2VyIGZvciByZXBs\naWNhdGlvbi4iCiAgICAgICAgICAgICAgICAgICAgKyAiIEVub3VnaCBCb29r\naWVzIG1pZ2h0IG5vdCBoYXZlIGF2YWlsYWJsZSIKICAgICAgICAgICAgICAg\nICAgICArICJTbywgbm8gaGFybSB0byBjb250aW51ZSIpOwogICAgICAgICAg\nICB1bmRlcnJlcGxpY2F0aW9uTWFuYWdlcgogICAgICAgICAgICAgICAgICAg\nIC5yZWxlYXNlVW5kZXJyZXBsaWNhdGVkTGVkZ2VyKGxlZGdlcklkVG9SZXBs\naWNhdGUpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQog\nICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4gZnJhZ21lbnRzID0gZ2V0VW5k\nZXJyZXBsaWNhdGVkRnJhZ21lbnRzKGxoKTsKICAgICAgICBMT0cuZGVidWco\nIkZvdW5kcyBmcmFnbWVudHMge30gZm9yIHJlcGxpY2F0aW9uIGZyb20gbGVk\nZ2VyOiB7fSIsIGZyYWdtZW50cywgbGVkZ2VySWRUb1JlcGxpY2F0ZSk7Cgog\nICAgICAgIGJvb2xlYW4gZm91bmRPcGVuRnJhZ21lbnRzID0gZmFsc2U7CiAg\nICAgICAgZm9yIChMZWRnZXJGcmFnbWVudCBsZWRnZXJGcmFnbWVudCA6IGZy\nYWdtZW50cykgewogICAgICAgICAgICBpZiAoIWxlZGdlckZyYWdtZW50Lmlz\nQ2xvc2VkKCkpIHsKICAgICAgICAgICAgICAgIGZvdW5kT3BlbkZyYWdtZW50\ncyA9IHRydWU7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg\nICAgfSBlbHNlIGlmIChpc1RhcmdldEJvb2tpZUV4aXN0c0luRnJhZ21lbnRF\nbnNlbWJsZShsaCwKICAgICAgICAgICAgICAgICAgICBsZWRnZXJGcmFnbWVu\ndCkpIHsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiVGFyZ2V0IEJvb2tp\nZVt7fV0gZm91bmQgaW4gdGhlIGZyYWdtZW50IGVuc2VtYmxlOiB7fSIsIHRh\ncmdldEJvb2tpZSwKICAgICAgICAgICAgICAgICAgICAgICAgbGVkZ2VyRnJh\nZ21lbnQuZ2V0RW5zZW1ibGUoKSk7CiAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgYWRtaW4ucmVwbGljYXRlTGVkZ2VyRnJhZ21lbnQobGgsIGxlZGdl\nckZyYWdtZW50LCB0YXJnZXRCb29raWUpOwogICAgICAgICAgICB9IGNhdGNo\nIChCS0V4Y2VwdGlvbi5CS0Jvb2tpZUhhbmRsZU5vdEF2YWlsYWJsZUV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICBMT0cud2FybigiQktCb29raWVI\nYW5kbGVOb3RBdmFpbGFibGVFeGNlcHRpb24gIgogICAgICAgICAgICAgICAg\nICAgICAgICArICJ3aGlsZSByZXBsaWNhdGluZyB0aGUgZnJhZ21lbnQiLCBl\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24uQktMZWRnZXJS\nZWNvdmVyeUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBMT0cud2Fy\nbigiQktMZWRnZXJSZWNvdmVyeUV4Y2VwdGlvbiAiCiAgICAgICAgICAgICAg\nICAgICAgICAgICsgIndoaWxlIHJlcGxpY2F0aW5nIHRoZSBmcmFnbWVudCIs\nIGUpOwogICAgICAgICAgICAgICAgaWYgKGFkbWluLmdldFJlYWRPbmx5Qm9v\na2llcygpLmNvbnRhaW5zKHRhcmdldEJvb2tpZSkpIHsKICAgICAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgQktFeGNlcHRpb24uQktXcml0ZU9uUmVhZE9u\nbHlCb29raWVFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGZvdW5kT3BlbkZyYWdt\nZW50cyB8fCBpc0xhc3RTZWdtZW50T3BlbkFuZE1pc3NpbmdCb29raWVzKGxo\nKSkgewogICAgICAgICAgICBkZWZlckxlZGdlckxvY2tSZWxlYXNlKGxlZGdl\ncklkVG9SZXBsaWNhdGUpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgfQoKICAgICAgICBmcmFnbWVudHMgPSBnZXRVbmRlcnJlcGxpY2F0\nZWRGcmFnbWVudHMobGgpOwogICAgICAgIGlmIChmcmFnbWVudHMuc2l6ZSgp\nID09IDApIHsKICAgICAgICAgICAgTE9HLmluZm8oIkxlZGdlciByZXBsaWNh\ndGVkIHN1Y2Nlc3NmdWxseS4gbGVkZ2VyIGlkIGlzOiAiCiAgICAgICAgICAg\nICAgICAgICAgKyBsZWRnZXJJZFRvUmVwbGljYXRlKTsKICAgICAgICAgICAg\ndW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIubWFya0xlZGdlclJlcGxpY2F0ZWQo\nbGVkZ2VySWRUb1JlcGxpY2F0ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFJlbGVhc2luZyB0\naGUgdW5kZXJSZXBsaWNhdGlvbiBsZWRnZXIgbG9jayBhbmQgY29tcGV0ZQog\nICAgICAgICAgICAvLyBmb3IgdGhlIHJlcGxpY2F0aW9uIGFnYWluIGZvciB0\naGUgcGVuZGluZyBmcmFnbWVudHMKICAgICAgICAgICAgdW5kZXJyZXBsaWNh\ndGlvbk1hbmFnZXIKICAgICAgICAgICAgICAgICAgICAucmVsZWFzZVVuZGVy\ncmVwbGljYXRlZExlZGdlcihsZWRnZXJJZFRvUmVwbGljYXRlKTsKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZW4gY2hlY2tpbmcgdGhlIGZyYWdtZW50cyBvZiBhIGxlZGdl\nciwgdGhlcmUgaXMgYSBjb3JuZXIgY2FzZQogICAgICogd2hlcmUgaWYgdGhl\nIGxhc3Qgc2VnbWVudC9lbnNlbWJsZSBpcyBvcGVuLCBidXQgbm90aGluZyBo\nYXMgYmVlbiB3cml0dGVuIHRvCiAgICAgKiBzb21lIG9mIHRoZSBxdW9ydW1z\nIGluIHRoZSBlbnNlbWJsZSwgYm9va2llcyBjYW4gZmFpbCB3aXRob3V0IGFu\neSBhY3Rpb24gYmVpbmcKICAgICAqIHRha2VuLiBUaGlzIGlzIGZpbmUsIHVu\ndGlsIGVub3VnaCBib29raWVzIGZhaWwgdG8gY2F1c2UgYSBxdW9ydW0gdG8g\nYmVjb21lCiAgICAgKiB1bmF2YWlsYWJsZSwgYnkgd2hpY2ggdGltZSB0aGUg\nbGVkZ2VyIGlzIHVucmVjb3ZlcmFibGUuCiAgICAgKgogICAgICogRm9yIGV4\nYW1wbGUsIGlmIGluIGEgRTNRMiwgb25seSAxIGVudHJ5IGlzIHdyaXR0ZW4g\nYW5kIHRoZSBsYXN0IGJvb2tpZQogICAgICogaW4gdGhlIGVuc2VtYmxlIGZh\naWxzLCBub3RoaW5nIGhhcyBiZWVuIHdyaXR0ZW4gdG8gaXQsIHNvIG5vdGhp\nbmcgbmVlZHMgdG8gYmUKICAgICAqIHJlY292ZXJlZC4gQnV0IGlmIHRoZSBz\nZWNvbmQgdG8gbGFzdCBib29raWUgZmFpbHMsIHdlJ3ZlIG5vdyBsb3N0IHF1\nb3J1bSBmb3IKICAgICAqIHRoZSBzZWNvbmQgZW50cnksIHNvIGl0J3MgaW1w\nb3NzaWJsZSB0byBzZWUgaWYgdGhlIHNlY29uZCBoYXMgYmVlbiB3cml0dGVu\nIG9yCiAgICAgKiBub3QuCiAgICAgKgogICAgICogVG8gYXZvaWQgdGhpcyBz\naXR1YXRpb24sIHdlIG5lZWQgdG8gY2hlY2sgaWYgYm9va2llcyBpbiB0aGUg\nZmluYWwgb3BlbiBlbnNlbWJsZQogICAgICogYXJlIHVuYXZhaWxhYmxlLCBh\nbmQgdGFrZSBhY3Rpb24gaWYgc28uIFRoZSBhY3Rpb24gdG8gdGFrZSBpcyB0\nbyBjbG9zZSB0aGUgbGVkZ2VyLAogICAgICogYWZ0ZXIgYSBncmFjZSBwZXJp\nb2QgYXMgdGhlIHdyaXR0aW5nIGNsaWVudCBtYXkgcmVwbGFjZSB0aGUgZmF1\nbHR5IGJvb2tpZSBvbiBpdHMKICAgICAqIG93bi4KICAgICAqCiAgICAgKiBN\naXNzaW5nIGJvb2tpZXMgaW4gY2xvc2VkIGxlZGdlcnMgYXJlIGZpbmUsIGFz\nIHdlIGtub3cgdGhlIGxhc3QgY29uZmlybWVkIGFkZCwgc28KICAgICAqIHdl\nIGNhbiB0ZWxsIHdoaWNoIGVudHJpZXMgYXJlIHN1cHBvc2VkIHRvIGV4aXN0\nIGFuZCByZXJlcGxpY2F0ZSB0aGVtIGlmIG5lY2Vzc2FyeS4KICAgICAqLwog\nICAgcHJpdmF0ZSBib29sZWFuIGlzTGFzdFNlZ21lbnRPcGVuQW5kTWlzc2lu\nZ0Jvb2tpZXMoTGVkZ2VySGFuZGxlIGxoKSB0aHJvd3MgQktFeGNlcHRpb24g\newogICAgICAgIExlZGdlck1ldGFkYXRhIG1kID0gYWRtaW4uZ2V0TGVkZ2Vy\nTWV0YWRhdGEobGgpOwogICAgICAgIGlmIChtZC5pc0Nsb3NlZCgpKSB7CiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIFNv\ncnRlZE1hcDxMb25nLCBBcnJheUxpc3Q8Qm9va2llU29ja2V0QWRkcmVzcz4+\nIGVuc2VtYmxlcwogICAgICAgICAgICA9IGFkbWluLmdldExlZGdlck1ldGFk\nYXRhKGxoKS5nZXRFbnNlbWJsZXMoKTsKICAgICAgICBBcnJheUxpc3Q8Qm9v\na2llU29ja2V0QWRkcmVzcz4gZmluYWxFbnNlbWJsZSA9IGVuc2VtYmxlcy5n\nZXQoZW5zZW1ibGVzLmxhc3RLZXkoKSk7CiAgICAgICAgQ29sbGVjdGlvbjxC\nb29raWVTb2NrZXRBZGRyZXNzPiBhdmFpbGFibGUgPSBhZG1pbi5nZXRBdmFp\nbGFibGVCb29raWVzKCk7CiAgICAgICAgZm9yIChCb29raWVTb2NrZXRBZGRy\nZXNzIGIgOiBmaW5hbEVuc2VtYmxlKSB7CiAgICAgICAgICAgIGlmICghYXZh\naWxhYmxlLmNvbnRhaW5zKGIpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgLyoqIEdldHMgdGhlIHVuZGVyIHJlcGxpY2F0\nZWQgZnJhZ21lbnRzICovCiAgICBwcml2YXRlIFNldDxMZWRnZXJGcmFnbWVu\ndD4gZ2V0VW5kZXJyZXBsaWNhdGVkRnJhZ21lbnRzKExlZGdlckhhbmRsZSBs\naCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsK\nICAgICAgICBDaGVja2VyQ2FsbGJhY2sgY2hlY2tlckNiID0gbmV3IENoZWNr\nZXJDYWxsYmFjaygpOwogICAgICAgIGxlZGdlckNoZWNrZXIuY2hlY2tMZWRn\nZXIobGgsIGNoZWNrZXJDYik7CiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50\nPiBmcmFnbWVudHMgPSBjaGVja2VyQ2Iud2FpdEFuZEdldFJlc3VsdCgpOwog\nICAgICAgIHJldHVybiBmcmFnbWVudHM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTY2hlZHVsZXMgYSB0aW1lciB0YXNrIGZvciByZWxlYXNpbmcgdGhlIGxv\nY2sgd2hpY2ggd2lsbCBiZSBzY2hlZHVsZWQKICAgICAqIGFmdGVyIG9wZW4g\nbGVkZ2VyIGZyYWdtZW50IHJlcGxpY2F0aW9uIHRpbWUuIExlZGdlciB3aWxs\nIGJlIGZlbmNlZCBpZiBpdAogICAgICogaXMgc3RpbGwgaW4gb3BlbiBzdGF0\nZSB3aGVuIHRpbWVyIHRhc2sgZmlyZWQKICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGRlZmVyTGVkZ2VyTG9ja1JlbGVhc2UoZmluYWwgbG9uZyBsZWRnZXJJ\nZCkgewogICAgICAgIGxvbmcgZ3JhY2VQZXJpb2QgPSB0aGlzLm9wZW5MZWRn\nZXJSZXJlcGxpY2F0aW9uR3JhY2VQZXJpb2Q7CiAgICAgICAgVGltZXJUYXNr\nIHRpbWVyVGFzayA9IG5ldyBUaW1lclRhc2soKSB7CiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAg\nICAgICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBudWxsOwogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBsaCA9IGFkbWluLm9w\nZW5MZWRnZXJOb1JlY292ZXJ5KGxlZGdlcklkKTsKICAgICAgICAgICAgICAg\nICAgICBpZiAoaXNMYXN0U2VnbWVudE9wZW5BbmRNaXNzaW5nQm9va2llcyhs\naCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGggPSBhZG1pbi5vcGVu\nTGVkZ2VyKGxlZGdlcklkKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4gZnJhZ21lbnRz\nID0gZ2V0VW5kZXJyZXBsaWNhdGVkRnJhZ21lbnRzKGxoKTsKICAgICAgICAg\nICAgICAgICAgICBmb3IgKExlZGdlckZyYWdtZW50IGZyYWdtZW50IDogZnJh\nZ21lbnRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZnJhZ21l\nbnQuaXNDbG9zZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbGggPSBhZG1pbi5vcGVuTGVkZ2VyKGxlZGdlcklkKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAg\nICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIkludGVycnVwdGVkRXhjZXB0\naW9uICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIndoaWxlIHJl\ncGxpY2F0aW5nIGZyYWdtZW50cyIsIGUpOwogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoQktOb1N1Y2hMZWRnZXJFeGlzdHNFeGNlcHRpb24gYmtuc2xlKSB7\nCiAgICAgICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJMZWRnZXIgd2FzIGRl\nbGV0ZWQsIHNhZmUgdG8gY29udGludWUiLCBia25zbGUpOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiQktFeGNlcHRpb24gd2hpbGUgZmVuY2luZyB0\naGUgbGVkZ2VyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGZv\nciByZXJlcGxpY2F0aW9uIG9mIHBvc3Rwb25lZCBsZWRnZXJzIiwgZSk7CiAg\nICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaCAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaC5jbG9zZSgpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVw\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gd2hpbGUgY2xvc2luZyAiCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyAibGVkZ2VyIiwgZSk7CiAgICAgICAgICAg\nICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBMZXRzIGdvIGFoZWFkIGFuZCByZWxlYXNlIHRo\nZSBsb2NrLiBDYXRjaCBhY3R1YWwKICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gZXhjZXB0aW9uIGluIG5vcm1hbCByZXBsaWNhdGlvbiBmbG93IGFuZCB0\nYWtlCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjdGlvbi4KICAgICAg\nICAgICAgICAgICAgICAgICAgTE9HLndhcm4oIkJLRXhjZXB0aW9uIHdoaWxl\nIGNsb3NpbmcgbGVkZ2VyICIsIGUpOwogICAgICAgICAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB1bmRlcnJlcGxpY2F0aW9uTWFuYWdl\ncgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVsZWFz\nZVVuZGVycmVwbGljYXRlZExlZGdlcihsZWRnZXJJZCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKFVuYXZhaWxhYmxlRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNodXRkb3duKCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIlVuYXZhaWxh\nYmxlRXhjZXB0aW9uICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAid2hpbGUgcmVwbGljYXRpbmcgZnJhZ21lbnRzIiwgZSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9Owog\nICAgICAgIHBlbmRpbmdSZXBsaWNhdGlvblRpbWVyLnNjaGVkdWxlKHRpbWVy\nVGFzaywgZ3JhY2VQZXJpb2QpOwogICAgfQoKICAgIC8qKgogICAgICogU3Rv\ncCB0aGUgcmVwbGljYXRpb24gd29ya2VyIHNlcnZpY2UKICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2h1dGRvd24oKSB7CiAgICAgICAgc3luY2hyb25pemVk\nICh0aGlzKSB7CiAgICAgICAgICAgIGlmICghd29ya2VyUnVubmluZykgewog\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHdvcmtlclJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAg\nTE9HLmluZm8oIlNodXR0aW5nIGRvd24gUmVwbGljYXRpb25Xb3JrZXIiKTsK\nICAgICAgICB0aGlzLnBlbmRpbmdSZXBsaWNhdGlvblRpbWVyLmNhbmNlbCgp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRoaXMud29ya2VyVGhyZWFk\nLmludGVycnVwdCgpOwogICAgICAgICAgICB0aGlzLndvcmtlclRocmVhZC5q\nb2luKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkludGVycnVwdGVkIGR1cmlu\nZyBzaHV0dGluZyBkb3duIHJlcGxpY2F0aW9uIHdvcmtlciA6ICIsCiAgICAg\nICAgICAgICAgICAgICAgZSk7CiAgICAgICAgICAgIFRocmVhZC5jdXJyZW50\nVGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgfQogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGJrYy5jbG9zZSgpOwogICAgICAgIH0gY2F0Y2ggKElu\ndGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLndhcm4o\nIkludGVycnVwdGVkIHdoaWxlIGNsb3NpbmcgdGhlIEJvb2tpZSBjbGllbnQi\nLCBlKTsKICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5pbnRl\ncnJ1cHQoKTsKICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIExPRy53YXJuKCJFeGNlcHRpb24gd2hpbGUgY2xvc2luZyB0\naGUgQm9va2llIGNsaWVudCIsIGUpOwogICAgICAgIH0KICAgICAgICB0cnkg\newogICAgICAgICAgICB1bmRlcnJlcGxpY2F0aW9uTWFuYWdlci5jbG9zZSgp\nOwogICAgICAgIH0gY2F0Y2ggKFVuYXZhaWxhYmxlRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgTE9HLndhcm4oIkV4Y2VwdGlvbiB3aGlsZSBjbG9zaW5n\nIHRoZSAiCiAgICAgICAgICAgICAgICAgICAgKyAiWmtMZWRnZXJVbmRlcnJl\ncGxpYXRpb25NYW5hZ2VyIiwgZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogR2l2ZXMgdGhlIHJ1bm5pbmcgc3RhdHVzIG9mIFJlcGxpY2F0\naW9uV29ya2VyCiAgICAgKi8KICAgIGJvb2xlYW4gaXNSdW5uaW5nKCkgewog\nICAgICAgIHJldHVybiB3b3JrZXJSdW5uaW5nICYmIHdvcmtlclRocmVhZC5p\nc0FsaXZlKCk7CiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGlzVGFyZ2V0\nQm9va2llRXhpc3RzSW5GcmFnbWVudEVuc2VtYmxlKExlZGdlckhhbmRsZSBs\naCwKICAgICAgICAgICAgTGVkZ2VyRnJhZ21lbnQgbGVkZ2VyRnJhZ21lbnQp\nIHsKICAgICAgICBMaXN0PEJvb2tpZVNvY2tldEFkZHJlc3M+IGVuc2VtYmxl\nID0gbGVkZ2VyRnJhZ21lbnQuZ2V0RW5zZW1ibGUoKTsKICAgICAgICBmb3Ig\nKEJvb2tpZVNvY2tldEFkZHJlc3MgYmtBZGRyIDogZW5zZW1ibGUpIHsKICAg\nICAgICAgICAgaWYgKHRhcmdldEJvb2tpZS5lcXVhbHMoYmtBZGRyKSkgewog\nICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKiBM\nZWRnZXIgY2hlY2tlciBjYWxsIGJhY2sgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIGNsYXNzIENoZWNrZXJDYWxsYmFjayBpbXBsZW1lbnRzCiAgICAgICAgICAg\nIEdlbmVyaWNDYWxsYmFjazxTZXQ8TGVkZ2VyRnJhZ21lbnQ+PiB7CiAgICAg\nICAgcHJpdmF0ZSBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IG51bGw7\nCiAgICAgICAgcHJpdmF0ZSBDb3VudERvd25MYXRjaCBsYXRjaCA9IG5ldyBD\nb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBTZXQ8TGVk\nZ2VyRnJhZ21lbnQ+IHJlc3VsdCkgewogICAgICAgICAgICB0aGlzLnJlc3Vs\ndCA9IHJlc3VsdDsKICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAg\nICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBXYWl0IHVudGlsIG9w\nZXJhdGlvbiBjb21wbGV0ZSBjYWxsIGJhY2sgY29tZXMgYW5kIHJldHVybiB0\naGUgbGVkZ2VyCiAgICAgICAgICogZnJhZ21lbnRzIHNldAogICAgICAgICAq\nLwogICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4gd2FpdEFuZEdldFJlc3Vs\ndCgpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGxhdGNoLmF3YWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAg\nICAgICAgfQogICAgfQoKfQo=\n","encoding":"base64"}

