{"sha":"4897883036c0c7fb8e96501d72fae6f48ead06ee","node_id":"MDQ6QmxvYjE1NzU5NTY6NDg5Nzg4MzAzNmMwYzdmYjhlOTY1MDFkNzJmYWU2ZjQ4ZWFkMDZlZQ==","size":9939,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/4897883036c0c7fb8e96501d72fae6f48ead06ee","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbDsKCmltcG9ydCBqYXZh\nLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRT\ndHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsKaW1w\nb3J0IGphdmEubmV0LkluZXRBZGRyZXNzOwppbXBvcnQgamF2YS5uZXQuSW5l\ndFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZhLm5ldC5Tb2NrZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5ib29raWUuQm9va2llRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29r\naWVTZXJ2ZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGlj\nYXRpb24uUmVwbGljYXRpb25FeGNlcHRpb24uQ29tcGF0aWJpbGl0eUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbi5SZXBsaWNhdGlvbkV4Y2VwdGlvbi5VbmF2YWlsYWJsZUV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0\nZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVkRXZl\nbnQ7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlci5FdmVudC5LZWVwZXJTdGF0ZTsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRzOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuc2VydmVyLk5JT1NlcnZlckNueG5G\nYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuc2VydmVyLlpv\nb0tlZXBlclNlcnZlcjsKCmltcG9ydCBzdGF0aWMgY29tLmdvb2dsZS5jb21t\nb24uYmFzZS5DaGFyc2V0cy5VVEZfODsKCnB1YmxpYyBjbGFzcyBMb2NhbEJv\nb2tLZWVwZXIgewogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBMb2dnZXIg\nTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTG9jYWxCb29rS2VlcGVy\nLmNsYXNzKTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IENPTk5FQ1RJ\nT05fVElNRU9VVCA9IDMwMDAwOwoKICAgIGludCBudW1iZXJPZkJvb2tpZXM7\nCgogICAgcHVibGljIExvY2FsQm9va0tlZXBlcigpIHsKICAgICAgICBudW1i\nZXJPZkJvb2tpZXMgPSAzOwogICAgfQoKICAgIHB1YmxpYyBMb2NhbEJvb2tL\nZWVwZXIoaW50IG51bWJlck9mQm9va2llcykgewogICAgICAgIHRoaXMoKTsK\nICAgICAgICB0aGlzLm51bWJlck9mQm9va2llcyA9IG51bWJlck9mQm9va2ll\nczsKICAgICAgICBMT0cuaW5mbygiUnVubmluZyAiICsgdGhpcy5udW1iZXJP\nZkJvb2tpZXMgKyAiIGJvb2tpZShzKS4iKTsKICAgIH0KCiAgICBwcml2YXRl\nIGZpbmFsIFN0cmluZyBIT1NUUE9SVCA9ICIxMjcuMC4wLjE6MjE4MSI7CiAg\nICBOSU9TZXJ2ZXJDbnhuRmFjdG9yeSBzZXJ2ZXJGYWN0b3J5OwogICAgWm9v\nS2VlcGVyU2VydmVyIHprczsKICAgIFpvb0tlZXBlciB6a2M7CiAgICBpbnQg\nWm9vS2VlcGVyRGVmYXVsdFBvcnQgPSAyMTgxOwogICAgc3RhdGljIGludCB6\na1Nlc3Npb25UaW1lT3V0ID0gNTAwMDsKICAgIEZpbGUgWmtUbXBEaXI7Cgog\nICAgLy9Cb29rS2VlcGVyIHZhcmlhYmxlcwogICAgRmlsZSB0bXBEaXJzW107\nCiAgICBCb29raWVTZXJ2ZXIgYnNbXTsKICAgIFNlcnZlckNvbmZpZ3VyYXRp\nb24gYnNDb25mc1tdOwogICAgSW50ZWdlciBpbml0aWFsUG9ydCA9IDUwMDA7\nCgogICAgLyoqCiAgICAgKiBAcGFyYW0gYXJncwogICAgICovCgogICAgcHJp\ndmF0ZSB2b2lkIHJ1blpvb2tlZXBlcihpbnQgbWF4Q0MpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgLy8gY3JlYXRlIGEgWm9vS2VlcGVyIHNlcnZl\ncihkYXRhRGlyLCBkYXRhTG9nRGlyLCBwb3J0KQogICAgICAgIExPRy5pbmZv\nKCJTdGFydGluZyBaSyBzZXJ2ZXIiKTsKICAgICAgICAvL1NlcnZlclN0YXRz\nLnJlZ2lzdGVyQXNDb25jcmV0ZSgpOwogICAgICAgIC8vQ2xpZW50QmFzZS5z\nZXR1cFRlc3RFbnYoKTsKICAgICAgICBaa1RtcERpciA9IEZpbGUuY3JlYXRl\nVGVtcEZpbGUoInpvb2tlZXBlciIsICJ0ZXN0Iik7CiAgICAgICAgaWYgKCFa\na1RtcERpci5kZWxldGUoKSB8fCAhWmtUbXBEaXIubWtkaXIoKSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkNvdWxkbid0IGNyZWF0\nZSB6ayBkaXJlY3RvcnkgIiArIFprVG1wRGlyKTsKICAgICAgICB9CgogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHprcyA9IG5ldyBab29LZWVwZXJTZXJ2\nZXIoWmtUbXBEaXIsIFprVG1wRGlyLCBab29LZWVwZXJEZWZhdWx0UG9ydCk7\nCiAgICAgICAgICAgIHNlcnZlckZhY3RvcnkgPSAgbmV3IE5JT1NlcnZlckNu\neG5GYWN0b3J5KCk7CiAgICAgICAgICAgIHNlcnZlckZhY3RvcnkuY29uZmln\ndXJlKG5ldyBJbmV0U29ja2V0QWRkcmVzcyhab29LZWVwZXJEZWZhdWx0UG9y\ndCksIG1heENDKTsKICAgICAgICAgICAgc2VydmVyRmFjdG9yeS5zdGFydHVw\nKHprcyk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRjaCBibG9jawogICAg\nICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBpbnN0YW50aWF0\naW5nIFpvb0tlZXBlciIsIGUpOwogICAgICAgIH0KCiAgICAgICAgYm9vbGVh\nbiBiID0gd2FpdEZvclNlcnZlclVwKEhPU1RQT1JULCBDT05ORUNUSU9OX1RJ\nTUVPVVQpOwogICAgICAgIExPRy5kZWJ1ZygiWm9vS2VlcGVyIHNlcnZlciB1\ncDoge30iLCBiKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgaW5pdGlhbGl6\nZVpvb2tlcGVyKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBMT0cu\naW5mbygiSW5zdGFudGlhdGUgWksgQ2xpZW50Iik7CiAgICAgICAgLy9pbml0\naWFsaXplIHRoZSB6ayBjbGllbnQgd2l0aCB2YWx1ZXMKICAgICAgICB0cnkg\newogICAgICAgICAgICBaS0Nvbm5lY3Rpb25XYXRjaGVyIHprQ29ubmVjdGlv\nbldhdGNoZXIgPSBuZXcgWktDb25uZWN0aW9uV2F0Y2hlcigpOwogICAgICAg\nICAgICB6a2MgPSBuZXcgWm9vS2VlcGVyKEhPU1RQT1JULCB6a1Nlc3Npb25U\naW1lT3V0LAogICAgICAgICAgICAgICAgICAgIHprQ29ubmVjdGlvbldhdGNo\nZXIpOwogICAgICAgICAgICB6a0Nvbm5lY3Rpb25XYXRjaGVyLndhaXRGb3JD\nb25uZWN0aW9uKCk7CiAgICAgICAgICAgIHprYy5jcmVhdGUoIi9sZWRnZXJz\nIiwgbmV3IGJ5dGVbMF0sIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1v\nZGUuUEVSU0lTVEVOVCk7CiAgICAgICAgICAgIHprYy5jcmVhdGUoIi9sZWRn\nZXJzL2F2YWlsYWJsZSIsIG5ldyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xfVU5T\nQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwogICAgICAgICAgICAvLyBO\nbyBuZWVkIHRvIGNyZWF0ZSBhbiBlbnRyeSBmb3IgZWFjaCByZXF1ZXN0ZWQg\nYm9va2llIGFueW1vcmUgYXMgdGhlCiAgICAgICAgICAgIC8vIEJvb2tpZVNl\ncnZlcnMgd2lsbCByZWdpc3RlciB0aGVtc2VsdmVzIHdpdGggWm9vS2VlcGVy\nIG9uIHN0YXJ0dXAuCiAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgLy8gVE9ETyBBdXRvLWdlbmVyYXRlZCBjYXRj\naCBibG9jawogICAgICAgICAgICBMT0cuZXJyb3IoIkV4Y2VwdGlvbiB3aGls\nZSBjcmVhdGluZyB6bm9kZXMiLCBlKTsKICAgICAgICB9IGNhdGNoIChJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIFRPRE8gQXV0\nby1nZW5lcmF0ZWQgY2F0Y2ggYmxvY2sKICAgICAgICAgICAgTE9HLmVycm9y\nKCJJbnRlcnJ1cHRlZCB3aGlsZSBjcmVhdGluZyB6bm9kZXMiLCBlKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHJ1bkJvb2tpZXMoU2Vy\ndmVyQ29uZmlndXJhdGlvbiBiYXNlQ29uZikgdGhyb3dzIElPRXhjZXB0aW9u\nLAogICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24sIEludGVycnVwdGVkRXhj\nZXB0aW9uLCBCb29raWVFeGNlcHRpb24sCiAgICAgICAgICAgIFVuYXZhaWxh\nYmxlRXhjZXB0aW9uLCBDb21wYXRpYmlsaXR5RXhjZXB0aW9uIHsKICAgICAg\nICBMT0cuaW5mbygiU3RhcnRpbmcgQm9va2llKHMpIik7CiAgICAgICAgLy8g\nQ3JlYXRlIEJvb2tpZSBTZXJ2ZXJzIChCMSwgQjIsIEIzKQoKICAgICAgICB0\nbXBEaXJzID0gbmV3IEZpbGVbbnVtYmVyT2ZCb29raWVzXTsKICAgICAgICBi\ncyA9IG5ldyBCb29raWVTZXJ2ZXJbbnVtYmVyT2ZCb29raWVzXTsKICAgICAg\nICBic0NvbmZzID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb25bbnVtYmVyT2ZC\nb29raWVzXTsKCiAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IG51bWJlck9m\nQm9va2llczsgaSsrKSB7CiAgICAgICAgICAgIHRtcERpcnNbaV0gPSBGaWxl\nLmNyZWF0ZVRlbXBGaWxlKCJib29raWUiICsgSW50ZWdlci50b1N0cmluZyhp\nKSwgInRlc3QiKTsKICAgICAgICAgICAgaWYgKCF0bXBEaXJzW2ldLmRlbGV0\nZSgpIHx8ICF0bXBEaXJzW2ldLm1rZGlyKCkpIHsKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiQ291bGRuJ3QgY3JlYXRlIGJvb2tp\nZSBkaXIgIiArIHRtcERpcnNbaV0pOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBic0NvbmZzW2ldID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmFz\nZUNvbmYpOwogICAgICAgICAgICAvLyBvdmVycmlkZSBzZXR0aW5ncwogICAg\nICAgICAgICBic0NvbmZzW2ldLnNldEJvb2tpZVBvcnQoaW5pdGlhbFBvcnQg\nKyBpKTsKICAgICAgICAgICAgYnNDb25mc1tpXS5zZXRaa1NlcnZlcnMoSW5l\ndEFkZHJlc3MuZ2V0TG9jYWxIb3N0KCkuZ2V0SG9zdEFkZHJlc3MoKSArICI6\nIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBab29LZWVw\nZXJEZWZhdWx0UG9ydCk7CiAgICAgICAgICAgIGJzQ29uZnNbaV0uc2V0Sm91\ncm5hbERpck5hbWUodG1wRGlyc1tpXS5nZXRQYXRoKCkpOwogICAgICAgICAg\nICBic0NvbmZzW2ldLnNldExlZGdlckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7\nIHRtcERpcnNbaV0uZ2V0UGF0aCgpIH0pOwogICAgICAgICAgICBic0NvbmZz\nW2ldLnNldEFsbG93TG9vcGJhY2sodHJ1ZSk7CgogICAgICAgICAgICBic1tp\nXSA9IG5ldyBCb29raWVTZXJ2ZXIoYnNDb25mc1tpXSk7CiAgICAgICAgICAg\nIGJzW2ldLnN0YXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBz\ndGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBJT0V4Y2Vw\ndGlvbiwgS2VlcGVyRXhjZXB0aW9uLAogICAgICAgICAgICBJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiwgQm9va2llRXhjZXB0aW9uLCBVbmF2YWlsYWJsZUV4Y2Vw\ndGlvbiwKICAgICAgICAgICAgQ29tcGF0aWJpbGl0eUV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYoYXJncy5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIHVzYWdl\nKCk7CiAgICAgICAgICAgIFN5c3RlbS5leGl0KC0xKTsKICAgICAgICB9CiAg\nICAgICAgTG9jYWxCb29rS2VlcGVyIGxiID0gbmV3IExvY2FsQm9va0tlZXBl\ncihJbnRlZ2VyLnBhcnNlSW50KGFyZ3NbMF0pKTsKCiAgICAgICAgU2VydmVy\nQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMikgewogICAgICAgICAg\nICBTdHJpbmcgY29uZkZpbGUgPSBhcmdzWzFdOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgY29uZi5sb2FkQ29uZihuZXcgRmlsZShjb25m\nRmlsZSkudG9VUkkoKS50b1VSTCgpKTsKICAgICAgICAgICAgICAgIExPRy5p\nbmZvKCJVc2luZyBjb25maWd1cmF0aW9uIGZpbGUgIiArIGNvbmZGaWxlKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIC8vIGxvYWQgY29uZiBmYWlsZWQKICAgICAgICAgICAgICAgIExP\nRy53YXJuKCJFcnJvciBsb2FkaW5nIGNvbmZpZ3VyYXRpb24gZmlsZSAiICsg\nY29uZkZpbGUsIGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBsYi5ydW5ab29rZWVwZXIoMTAwMCk7CiAgICAgICAgbGIuaW5pdGlhbGl6\nZVpvb2tlcGVyKCk7CiAgICAgICAgbGIucnVuQm9va2llcyhjb25mKTsKICAg\nICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICBUaHJlYWQuc2xlZXAo\nNTAwMCk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIHZv\naWQgdXNhZ2UoKSB7CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJVc2Fn\nZTogTG9jYWxCb29rS2VlcGVyIG51bWJlci1vZi1ib29raWVzIik7CiAgICB9\nCgogICAgLyogV2F0Y2hpbmcgU3luY0Nvbm5lY3RlZCBldmVudCBmcm9tIFpv\nb0tlZXBlciAqLwogICAgc3RhdGljIGNsYXNzIFpLQ29ubmVjdGlvbldhdGNo\nZXIgaW1wbGVtZW50cyBXYXRjaGVyIHsKICAgICAgICBwcml2YXRlIENvdW50\nRG93bkxhdGNoIGNsaWVudENvbm5lY3RMYXRjaCA9IG5ldyBDb3VudERvd25M\nYXRjaCgxKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZv\naWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICAgICAg\naWYgKGV2ZW50LmdldFN0YXRlKCkgPT0gS2VlcGVyU3RhdGUuU3luY0Nvbm5l\nY3RlZCkgewogICAgICAgICAgICAgICAgY2xpZW50Q29ubmVjdExhdGNoLmNv\ndW50RG93bigpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAv\nLyBXYWl0aW5nIGZvciB0aGUgU3luY0Nvbm5lY3RlZCBldmVudCBmcm9tIHRo\nZSBab29LZWVwZXIgc2VydmVyCiAgICAgICAgcHVibGljIHZvaWQgd2FpdEZv\nckNvbm5lY3Rpb24oKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgaWYgKCFjbGllbnRDb25uZWN0TGF0\nY2guYXdhaXQoemtTZXNzaW9uVGltZU91dCwKICAgICAgICAgICAgICAgICAg\nICAgICAgVGltZVVuaXQuTUlMTElTRUNPTkRTKSkgewogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICJDb3VsZG4ndCBjb25uZWN0IHRvIHpvb2tlZXBlciBz\nZXJ2ZXIiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRj\naCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IElPRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAg\nICAiSW50ZXJydXB0ZWQgd2hlbiBjb25uZWN0aW5nIHRvIHpvb2tlZXBlciBz\nZXJ2ZXIiLCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gd2FpdEZvclNlcnZlclVwKFN0cmlu\nZyBocCwgbG9uZyB0aW1lb3V0KSB7CiAgICAgICAgbG9uZyBzdGFydCA9IE1h\ndGhVdGlscy5ub3coKTsKICAgICAgICBTdHJpbmcgc3BsaXRbXSA9IGhwLnNw\nbGl0KCI6Iik7CiAgICAgICAgU3RyaW5nIGhvc3QgPSBzcGxpdFswXTsKICAg\nICAgICBpbnQgcG9ydCA9IEludGVnZXIucGFyc2VJbnQoc3BsaXRbMV0pOwog\nICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBTb2NrZXQgc29jayA9IG5ldyBTb2NrZXQoaG9zdCwgcG9y\ndCk7CiAgICAgICAgICAgICAgICBCdWZmZXJlZFJlYWRlciByZWFkZXIgPSBu\ndWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAg\nICBPdXRwdXRTdHJlYW0gb3V0c3RyZWFtID0gc29jay5nZXRPdXRwdXRTdHJl\nYW0oKTsKICAgICAgICAgICAgICAgICAgICBvdXRzdHJlYW0ud3JpdGUoInN0\nYXQiLmdldEJ5dGVzKFVURl84KSk7CiAgICAgICAgICAgICAgICAgICAgb3V0\nc3RyZWFtLmZsdXNoKCk7CgogICAgICAgICAgICAgICAgICAgIHJlYWRlciA9\nCiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBCdWZmZXJlZFJlYWRlcigK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgSW5wdXRTdHJl\nYW1SZWFkZXIoc29jay5nZXRJbnB1dFN0cmVhbSgpLCBVVEZfOCkpOwogICAg\nICAgICAgICAgICAgICAgIFN0cmluZyBsaW5lID0gcmVhZGVyLnJlYWRMaW5l\nKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUgIT0gbnVsbCAmJiBs\naW5lLnN0YXJ0c1dpdGgoIlpvb2tlZXBlciB2ZXJzaW9uOiIpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJTZXJ2ZXIgVVAiKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgICAgICBzb2NrLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKHJlYWRlciAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHJlYWRlci5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgLy8gaWdub3JlIGFzIHRoaXMgaXMg\nZXhwZWN0ZWQKICAgICAgICAgICAgICAgIExPRy5pbmZvKCJzZXJ2ZXIgIiAr\nIGhwICsgIiBub3QgdXAgIiArIGUpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBpZiAoTWF0aFV0aWxzLm5vdygpID4gc3RhcnQgKyB0aW1lb3V0KSB7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDI1MCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIC8vIGlnbm9yZQogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCn0K\n","encoding":"base64"}

