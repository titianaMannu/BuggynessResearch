{"sha":"5dbfc381359acb9deda890db1b312e4f02dedf22","node_id":"MDQ6QmxvYjE1NzU5NTY6NWRiZmMzODEzNTlhY2I5ZGVkYTg5MGRiMWIzMTJlNGYwMmRlZGYyMg==","size":25159,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5dbfc381359acb9deda890db1b312e4f02dedf22","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbDsKCmltcG9ydCBqYXZh\nLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRT\ndHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQg\namF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5UaW1lcjsKaW1wb3J0\nIGphdmEudXRpbC5UaW1lclRhc2s7CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5hdG9taWMuQXRvbWljQm9vbGVhbjsKCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubG9nZ2luZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMubG9nZ2luZy5Mb2dGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUuY29t\nbW9uLmJhc2UuQ2hhcnNldHM7CgovKioKICogQSBiYXNlIGNsYXNzIGZvciBy\ndW5uaW5nIGEgVW5peCBjb21tYW5kLgogKgogKiA8Y29kZT5TaGVsbDwvY29k\nZT4gY2FuIGJlIHVzZWQgdG8gcnVuIHVuaXggY29tbWFuZHMgbGlrZSA8Y29k\nZT5kdTwvY29kZT4gb3IKICogPGNvZGU+ZGY8L2NvZGU+LiBJdCBhbHNvIG9m\nZmVycyBmYWNpbGl0aWVzIHRvIGdhdGUgY29tbWFuZHMgYnkKICogdGltZS1p\nbnRlcnZhbHMuCiAqLwphYnN0cmFjdCBwdWJsaWMgY2xhc3MgU2hlbGwgewoK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgTG9nIExPRyA9IExvZ0ZhY3Rvcnku\nZ2V0TG9nKFNoZWxsLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBib29s\nZWFuIElTX0pBVkE3X09SX0FCT1ZFID0KICAgICAgICBTeXN0ZW0uZ2V0UHJv\ncGVydHkoImphdmEudmVyc2lvbiIpLnN1YnN0cmluZygwLCAzKS5jb21wYXJl\nVG8oIjEuNyIpID49IDA7CgogICAgcHVibGljIHN0YXRpYyBib29sZWFuIGlz\nSmF2YTdPckFib3ZlKCkgewogICAgICAgIHJldHVybiBJU19KQVZBN19PUl9B\nQk9WRTsKICAgIH0KCiAgICAvKiogYSBVbml4IGNvbW1hbmQgdG8gZ2V0IHRo\nZSBjdXJyZW50IHVzZXIncyBuYW1lICovCiAgICBwdWJsaWMgZmluYWwgc3Rh\ndGljIFN0cmluZyBVU0VSX05BTUVfQ09NTUFORCA9ICJ3aG9hbWkiOwoKICAg\nIC8qKiBXaW5kb3dzIENyZWF0ZVByb2Nlc3Mgc3luY2hyb25pemF0aW9uIG9i\namVjdCAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBPYmplY3QgV2luZG93\nc1Byb2Nlc3NMYXVuY2hMb2NrID0gbmV3IE9iamVjdCgpOwoKICAgIC8qKiBh\nIFVuaXggY29tbWFuZCB0byBnZXQgdGhlIGN1cnJlbnQgdXNlcidzIGdyb3Vw\ncyBsaXN0ICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGdldEdyb3Vw\nc0NvbW1hbmQoKSB7CiAgICAgICAgcmV0dXJuIChXSU5ET1dTKSA/IG5ldyBT\ndHJpbmdbXSB7ICJjbWQiLCAiL2MiLCAiZ3JvdXBzIiB9IDogbmV3IFN0cmlu\nZ1tdIHsgImJhc2giLCAiLWMiLCAiZ3JvdXBzIiB9OwogICAgfQoKICAgIC8q\nKiBhIFVuaXggY29tbWFuZCB0byBnZXQgYSBnaXZlbiB1c2VyJ3MgZ3JvdXBz\nIGxpc3QgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nW10gZ2V0R3JvdXBz\nRm9yVXNlckNvbW1hbmQoZmluYWwgU3RyaW5nIHVzZXIpIHsKICAgICAgICAv\nLydncm91cHMgdXNlcm5hbWUnIGNvbW1hbmQgcmV0dXJuIGlzIG5vbi1jb25z\naXN0ZW50IGFjcm9zcyBkaWZmZXJlbnQgdW5peGVzCiAgICAgICAgcmV0dXJu\nIChXSU5ET1dTKSA/IG5ldyBTdHJpbmdbXSB7IFdJTlVUSUxTLCAiZ3JvdXBz\nIiwgIi1GIiwgIlwiIiArIHVzZXIgKyAiXCIiIH0gOiBuZXcgU3RyaW5nW10g\neyAiYmFzaCIsICItYyIsCiAgICAgICAgICAgICAgICAiaWQgLUduICIgKyB1\nc2VyIH07CiAgICB9CgogICAgLyoqIGEgVW5peCBjb21tYW5kIHRvIGdldCBh\nIGdpdmVuIG5ldGdyb3VwJ3MgdXNlciBsaXN0ICovCiAgICBwdWJsaWMgc3Rh\ndGljIFN0cmluZ1tdIGdldFVzZXJzRm9yTmV0Z3JvdXBDb21tYW5kKGZpbmFs\nIFN0cmluZyBuZXRncm91cCkgewogICAgICAgIC8vJ2dyb3VwcyB1c2VybmFt\nZScgY29tbWFuZCByZXR1cm4gaXMgbm9uLWNvbnNpc3RlbnQgYWNyb3NzIGRp\nZmZlcmVudCB1bml4ZXMKICAgICAgICByZXR1cm4gKFdJTkRPV1MpID8gbmV3\nIFN0cmluZ1tdIHsgImNtZCIsICIvYyIsICJnZXRlbnQgbmV0Z3JvdXAgIiAr\nIG5ldGdyb3VwIH0gOiBuZXcgU3RyaW5nW10geyAiYmFzaCIsICItYyIsCiAg\nICAgICAgICAgICAgICAiZ2V0ZW50IG5ldGdyb3VwICIgKyBuZXRncm91cCB9\nOwogICAgfQoKICAgIC8qKiBSZXR1cm4gYSBjb21tYW5kIHRvIGdldCBwZXJt\naXNzaW9uIGluZm9ybWF0aW9uLiAqLwogICAgcHVibGljIHN0YXRpYyBTdHJp\nbmdbXSBnZXRHZXRQZXJtaXNzaW9uQ29tbWFuZCgpIHsKICAgICAgICByZXR1\ncm4gKFdJTkRPV1MpID8gbmV3IFN0cmluZ1tdIHsgV0lOVVRJTFMsICJscyIs\nICItRiIgfSA6IG5ldyBTdHJpbmdbXSB7ICIvYmluL2xzIiwgIi1sZCIgfTsK\nICAgIH0KCiAgICAvKiogUmV0dXJuIGEgY29tbWFuZCB0byBzZXQgcGVybWlz\nc2lvbiAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmdbXSBnZXRTZXRQZXJt\naXNzaW9uQ29tbWFuZChTdHJpbmcgcGVybSwgYm9vbGVhbiByZWN1cnNpdmUp\nIHsKICAgICAgICBpZiAocmVjdXJzaXZlKSB7CiAgICAgICAgICAgIHJldHVy\nbiAoV0lORE9XUykgPyBuZXcgU3RyaW5nW10geyBXSU5VVElMUywgImNobW9k\nIiwgIi1SIiwgcGVybSB9IDogbmV3IFN0cmluZ1tdIHsgImNobW9kIiwgIi1S\nIiwgcGVybSB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVy\nbiAoV0lORE9XUykgPyBuZXcgU3RyaW5nW10geyBXSU5VVElMUywgImNobW9k\nIiwgcGVybSB9IDogbmV3IFN0cmluZ1tdIHsgImNobW9kIiwgcGVybSB9Owog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIGNvbW1h\nbmQgdG8gc2V0IHBlcm1pc3Npb24gZm9yIHNwZWNpZmljIGZpbGUuCiAgICAg\nKgogICAgICogQHBhcmFtIHBlcm0gU3RyaW5nIHBlcm1pc3Npb24gdG8gc2V0\nCiAgICAgKiBAcGFyYW0gcmVjdXJzaXZlIGJvb2xlYW4gdHJ1ZSB0byBhcHBs\neSB0byBhbGwgc3ViLWRpcmVjdG9yaWVzIHJlY3Vyc2l2ZWx5CiAgICAgKiBA\ncGFyYW0gZmlsZSBTdHJpbmcgZmlsZSB0byBzZXQKICAgICAqIEByZXR1cm4g\nU3RyaW5nW10gY29udGFpbmluZyBjb21tYW5kIGFuZCBhcmd1bWVudHMKICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmdbXSBnZXRTZXRQZXJtaXNz\naW9uQ29tbWFuZChTdHJpbmcgcGVybSwgYm9vbGVhbiByZWN1cnNpdmUsIFN0\ncmluZyBmaWxlKSB7CiAgICAgICAgU3RyaW5nW10gYmFzZUNtZCA9IGdldFNl\ndFBlcm1pc3Npb25Db21tYW5kKHBlcm0sIHJlY3Vyc2l2ZSk7CiAgICAgICAg\nU3RyaW5nW10gY21kV2l0aEZpbGUgPSBBcnJheXMuY29weU9mKGJhc2VDbWQs\nIGJhc2VDbWQubGVuZ3RoICsgMSk7CiAgICAgICAgY21kV2l0aEZpbGVbY21k\nV2l0aEZpbGUubGVuZ3RoIC0gMV0gPSBmaWxlOwogICAgICAgIHJldHVybiBj\nbWRXaXRoRmlsZTsKICAgIH0KCiAgICAvKiogUmV0dXJuIGEgY29tbWFuZCB0\nbyBzZXQgb3duZXIgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nW10gZ2V0\nU2V0T3duZXJDb21tYW5kKFN0cmluZyBvd25lcikgewogICAgICAgIHJldHVy\nbiAoV0lORE9XUykgPyBuZXcgU3RyaW5nW10geyBXSU5VVElMUywgImNob3du\nIiwgIlwiIiArIG93bmVyICsgIlwiIiB9IDogbmV3IFN0cmluZ1tdIHsgImNo\nb3duIiwgb3duZXIgfTsKICAgIH0KCiAgICAvKiogUmV0dXJuIGEgY29tbWFu\nZCB0byBjcmVhdGUgc3ltYm9saWMgbGlua3MgKi8KICAgIHB1YmxpYyBzdGF0\naWMgU3RyaW5nW10gZ2V0U3ltbGlua0NvbW1hbmQoU3RyaW5nIHRhcmdldCwg\nU3RyaW5nIGxpbmspIHsKICAgICAgICByZXR1cm4gV0lORE9XUyA/IG5ldyBT\ndHJpbmdbXSB7IFdJTlVUSUxTLCAic3ltbGluayIsIGxpbmssIHRhcmdldCB9\nIDogbmV3IFN0cmluZ1tdIHsgImxuIiwgIi1zIiwgdGFyZ2V0LCBsaW5rIH07\nCiAgICB9CgogICAgLyoqIFJldHVybiBhIGNvbW1hbmQgZm9yIGRldGVybWlu\naW5nIGlmIHByb2Nlc3Mgd2l0aCBzcGVjaWZpZWQgcGlkIGlzIGFsaXZlLiAq\nLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmdbXSBnZXRDaGVja1Byb2Nlc3NJ\nc0FsaXZlQ29tbWFuZChTdHJpbmcgcGlkKSB7CiAgICAgICAgcmV0dXJuIFNo\nZWxsLldJTkRPV1MgPyBuZXcgU3RyaW5nW10geyBTaGVsbC5XSU5VVElMUywg\nInRhc2siLCAiaXNBbGl2ZSIsIHBpZCB9IDogbmV3IFN0cmluZ1tdIHsgImtp\nbGwiLCAiLTAiLAogICAgICAgICAgICAgICAgaXNTZXRzaWRBdmFpbGFibGUg\nPyAiLSIgKyBwaWQgOiBwaWQgfTsKICAgIH0KCiAgICAvKiogUmV0dXJuIGEg\nY29tbWFuZCB0byBzZW5kIGEgc2lnbmFsIHRvIGEgZ2l2ZW4gcGlkICovCiAg\nICBwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGdldFNpZ25hbEtpbGxDb21tYW5k\nKGludCBjb2RlLCBTdHJpbmcgcGlkKSB7CiAgICAgICAgcmV0dXJuIFNoZWxs\nLldJTkRPV1MgPyBuZXcgU3RyaW5nW10geyBTaGVsbC5XSU5VVElMUywgInRh\nc2siLCAia2lsbCIsIHBpZCB9IDogbmV3IFN0cmluZ1tdIHsgImtpbGwiLAog\nICAgICAgICAgICAgICAgIi0iICsgY29kZSwgaXNTZXRzaWRBdmFpbGFibGUg\nPyAiLSIgKyBwaWQgOiBwaWQgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybnMgYSBGaWxlIHJlZmVyZW5jaW5nIGEgc2NyaXB0IHdpdGggdGhlIGdp\ndmVuIGJhc2VuYW1lLCBpbnNpZGUgdGhlCiAgICAgKiBnaXZlbiBwYXJlbnQg\nZGlyZWN0b3J5LiAgVGhlIGZpbGUgZXh0ZW5zaW9uIGlzIGluZmVycmVkIGJ5\nIHBsYXRmb3JtOiAiLmNtZCIKICAgICAqIG9uIFdpbmRvd3MsIG9yICIuc2gi\nIG90aGVyd2lzZS4KICAgICAqCiAgICAgKiBAcGFyYW0gcGFyZW50IEZpbGUg\ncGFyZW50IGRpcmVjdG9yeQogICAgICogQHBhcmFtIGJhc2VuYW1lIFN0cmlu\nZyBzY3JpcHQgZmlsZSBiYXNlbmFtZQogICAgICogQHJldHVybiBGaWxlIHJl\nZmVyZW5jaW5nIHRoZSBzY3JpcHQgaW4gdGhlIGRpcmVjdG9yeQogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIEZpbGUgYXBwZW5kU2NyaXB0RXh0ZW5zaW9u\nKEZpbGUgcGFyZW50LCBTdHJpbmcgYmFzZW5hbWUpIHsKICAgICAgICByZXR1\ncm4gbmV3IEZpbGUocGFyZW50LCBhcHBlbmRTY3JpcHRFeHRlbnNpb24oYmFz\nZW5hbWUpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYSBzY3Jp\ncHQgZmlsZSBuYW1lIHdpdGggdGhlIGdpdmVuIGJhc2VuYW1lLiAgVGhlIGZp\nbGUgZXh0ZW5zaW9uIGlzCiAgICAgKiBpbmZlcnJlZCBieSBwbGF0Zm9ybTog\nIi5jbWQiIG9uIFdpbmRvd3MsIG9yICIuc2giIG90aGVyd2lzZS4KICAgICAq\nCiAgICAgKiBAcGFyYW0gYmFzZW5hbWUgU3RyaW5nIHNjcmlwdCBmaWxlIGJh\nc2VuYW1lCiAgICAgKiBAcmV0dXJuIFN0cmluZyBzY3JpcHQgZmlsZSBuYW1l\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGFwcGVuZFNjcmlw\ndEV4dGVuc2lvbihTdHJpbmcgYmFzZW5hbWUpIHsKICAgICAgICByZXR1cm4g\nYmFzZW5hbWUgKyAoV0lORE9XUyA/ICIuY21kIiA6ICIuc2giKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybnMgYSBjb21tYW5kIHRvIHJ1biB0aGUg\nZ2l2ZW4gc2NyaXB0LiAgVGhlIHNjcmlwdCBpbnRlcnByZXRlciBpcwogICAg\nICogaW5mZXJyZWQgYnkgcGxhdGZvcm06IGNtZCBvbiBXaW5kb3dzIG9yIGJh\nc2ggb3RoZXJ3aXNlLgogICAgICoKICAgICAqIEBwYXJhbSBzY3JpcHQgRmls\nZSBzY3JpcHQgdG8gcnVuCiAgICAgKiBAcmV0dXJuIFN0cmluZ1tdIGNvbW1h\nbmQgdG8gcnVuIHRoZSBzY3JpcHQKICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBTdHJpbmdbXSBnZXRSdW5TY3JpcHRDb21tYW5kKEZpbGUgc2NyaXB0KSB7\nCiAgICAgICAgU3RyaW5nIGFic29sdXRlUGF0aCA9IHNjcmlwdC5nZXRBYnNv\nbHV0ZVBhdGgoKTsKICAgICAgICByZXR1cm4gV0lORE9XUyA/IG5ldyBTdHJp\nbmdbXSB7ICJjbWQiLCAiL2MiLCBhYnNvbHV0ZVBhdGggfSA6IG5ldyBTdHJp\nbmdbXSB7ICIvYmluL2Jhc2giLCBhYnNvbHV0ZVBhdGggfTsKICAgIH0KCiAg\nICAvKiogYSBVbml4IGNvbW1hbmQgdG8gc2V0IHBlcm1pc3Npb24gKi8KICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFNFVF9QRVJNSVNTSU9OX0NP\nTU1BTkQgPSAiY2htb2QiOwogICAgLyoqIGEgVW5peCBjb21tYW5kIHRvIHNl\ndCBvd25lciAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgU0VU\nX09XTkVSX0NPTU1BTkQgPSAiY2hvd24iOwoKICAgIC8qKiBhIFVuaXggY29t\nbWFuZCB0byBzZXQgdGhlIGNoYW5nZSB1c2VyJ3MgZ3JvdXBzIGxpc3QgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFNFVF9HUk9VUF9DT01N\nQU5EID0gImNoZ3JwIjsKICAgIC8qKiBhIFVuaXggY29tbWFuZCB0byBjcmVh\ndGUgYSBsaW5rICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBM\nSU5LX0NPTU1BTkQgPSAibG4iOwogICAgLyoqIGEgVW5peCBjb21tYW5kIHRv\nIGdldCBhIGxpbmsgdGFyZ2V0ICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBSRUFEX0xJTktfQ09NTUFORCA9ICJyZWFkbGluayI7CgogICAg\nLyoqVGltZSBhZnRlciB3aGljaCB0aGUgZXhlY3V0aW5nIHNjcmlwdCB3b3Vs\nZCBiZSB0aW1lZG91dCovCiAgICBwcm90ZWN0ZWQgbG9uZyB0aW1lT3V0SW50\nZXJ2YWwgPSAwTDsKICAgIC8qKiBJZiBvciBub3Qgc2NyaXB0IHRpbWVkIG91\ndCovCiAgICBwcml2YXRlIEF0b21pY0Jvb2xlYW4gdGltZWRPdXQ7CgogICAg\nLyoqIENlbnRyYWxpemVkIGxvZ2ljIHRvIGRpc2NvdmVyIGFuZCB2YWxpZGF0\nZSB0aGUgc2FuaXR5IG9mIHRoZSBIYWRvb3AKICAgICAqICBob21lIGRpcmVj\ndG9yeS4gUmV0dXJucyBlaXRoZXIgTlVMTCBvciBhIGRpcmVjdG9yeSB0aGF0\nIGV4aXN0cyBhbmQKICAgICAqICB3YXMgc3BlY2lmaWVkIHZpYSBlaXRoZXIg\nLURoYWRvb3AuaG9tZS5kaXIgb3IgdGhlIEhBRE9PUF9IT01FIEVOVgogICAg\nICogIHZhcmlhYmxlLiAgVGhpcyBkb2VzIGEgbG90IG9mIHdvcmsgc28gaXQg\nc2hvdWxkIG9ubHkgYmUgY2FsbGVkCiAgICAgKiAgcHJpdmF0ZWx5IGZvciBp\nbml0aWFsaXphdGlvbiBvbmNlIHBlciBwcm9jZXNzLgogICAgICoqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgU3RyaW5nIGNoZWNrSGFkb29wSG9tZSgpIHsKCiAg\nICAgICAgLy8gZmlyc3QgY2hlY2sgdGhlIERmbGFnIGhhZG9vcC5ob21lLmRp\nciB3aXRoIEpWTSBzY29wZQogICAgICAgIFN0cmluZyBob21lID0gU3lzdGVt\nLmdldFByb3BlcnR5KCJoYWRvb3AuaG9tZS5kaXIiKTsKCiAgICAgICAgLy8g\nZmFsbCBiYWNrIHRvIHRoZSBzeXN0ZW0vdXNlci1nbG9iYWwgZW52IHZhcmlh\nYmxlCiAgICAgICAgaWYgKGhvbWUgPT0gbnVsbCkgewogICAgICAgICAgICBo\nb21lID0gU3lzdGVtLmdldGVudigiSEFET09QX0hPTUUiKTsKICAgICAgICB9\nCgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGNvdWxkbid0IGZpbmQg\nZWl0aGVyIHNldHRpbmcgZm9yIGhhZG9vcCdzIGhvbWUgZGlyZWN0b3J5CiAg\nICAgICAgICAgIGlmIChob21lID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiSEFET09QX0hPTUUgb3IgaGFkb29w\nLmhvbWUuZGlyIGFyZSBub3Qgc2V0LiIpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBpZiAoaG9tZS5zdGFydHNXaXRoKCJcIiIpICYmIGhvbWUuZW5k\nc1dpdGgoIlwiIikpIHsKICAgICAgICAgICAgICAgIGhvbWUgPSBob21lLnN1\nYnN0cmluZygxLCBob21lLmxlbmd0aCgpIC0gMSk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIC8vIGNoZWNrIHRoYXQgdGhlIGhvbWUgc2V0dGluZyBp\ncyBhY3R1YWxseSBhIGRpcmVjdG9yeSB0aGF0IGV4aXN0cwogICAgICAgICAg\nICBGaWxlIGhvbWVkaXIgPSBuZXcgRmlsZShob21lKTsKICAgICAgICAgICAg\naWYgKCFob21lZGlyLmlzQWJzb2x1dGUoKSB8fCAhaG9tZWRpci5leGlzdHMo\nKSB8fCAhaG9tZWRpci5pc0RpcmVjdG9yeSgpKSB7CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkhhZG9vcCBob21lIGRpcmVjdG9y\neSAiICsgaG9tZWRpcgogICAgICAgICAgICAgICAgICAgICAgICArICIgZG9l\ncyBub3QgZXhpc3QsIGlzIG5vdCBhIGRpcmVjdG9yeSwgb3IgaXMgbm90IGFu\nIGFic29sdXRlIHBhdGguIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGhvbWUgPSBob21lZGlyLmdldENhbm9uaWNhbFBhdGgoKTsKCiAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgIExPRy5l\ncnJvcigiRmFpbGVkIHRvIGRldGVjdCBhIHZhbGlkIGhhZG9vcCBob21lIGRp\ncmVjdG9yeSIsIGlvZSk7CiAgICAgICAgICAgIGhvbWUgPSBudWxsOwogICAg\nICAgIH0KCiAgICAgICAgcmV0dXJuIGhvbWU7CiAgICB9CgogICAgcHJpdmF0\nZSBzdGF0aWMgU3RyaW5nIEhBRE9PUF9IT01FX0RJUiA9IGNoZWNrSGFkb29w\nSG9tZSgpOwoKICAgIC8vIFB1YmxpYyBnZXR0ZXIsIHRocm93cyBhbiBleGNl\ncHRpb24gaWYgSEFET09QX0hPTUUgZmFpbGVkIHZhbGlkYXRpb24KICAgIC8v\nIGNoZWNrcyBhbmQgaXMgYmVpbmcgcmVmZXJlbmNlZCBkb3duc3RyZWFtLgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgZ2V0SGFkb29wSG9tZSgp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKEhBRE9PUF9IT01F\nX0RJUiA9PSBudWxsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2Vw\ndGlvbigiTWlzY29uZmlndXJlZCBIQURPT1BfSE9NRSBjYW5ub3QgYmUgcmVm\nZXJlbmNlZC4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBIQURPT1Bf\nSE9NRV9ESVI7CiAgICB9CgogICAgLyoqIGZ1bGx5IHF1YWxpZnkgdGhlIHBh\ndGggdG8gYSBiaW5hcnkgdGhhdCBzaG91bGQgYmUgaW4gYSBrbm93biBoYWRv\nb3AKICAgICAqICBiaW4gbG9jYXRpb24uIFRoaXMgaXMgcHJpbWFyaWx5IHVz\nZWZ1bCBmb3IgZGlzYW1iaWd1YXRpbmcgY2FsbC1vdXRzCiAgICAgKiAgdG8g\nZXhlY3V0YWJsZSBzdWItY29tcG9uZW50cyBvZiBIYWRvb3AgdG8gYXZvaWQg\nY2xhc2hlcyB3aXRoIG90aGVyCiAgICAgKiAgZXhlY3V0YWJsZXMgdGhhdCBt\nYXkgYmUgaW4gdGhlIHBhdGguICBDYXZlYXQ6ICB0aGlzIGNhbGwgZG9lc24n\ndAogICAgICogIGp1c3QgZm9ybWF0IHRoZSBwYXRoIHRvIHRoZSBiaW4gZGly\nZWN0b3J5LiAgSXQgYWxzbyBjaGVja3MgZm9yIGZpbGUKICAgICAqICBleGlz\ndGVuY2Ugb2YgdGhlIGNvbXBvc2VkIHBhdGguIFRoZSBvdXRwdXQgb2YgdGhp\ncyBjYWxsIHNob3VsZCBiZQogICAgICogIGNhY2hlZCBieSBjYWxsZXJzLgog\nICAgICogKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIGdldFF1\nYWxpZmllZEJpblBhdGgoU3RyaW5nIGV4ZWN1dGFibGUpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgLy8gY29uc3RydWN0IGhhZG9vcCBiaW4gcGF0\naCB0byB0aGUgc3BlY2lmaWVkIGV4ZWN1dGFibGUKICAgICAgICBTdHJpbmcg\nZnVsbEV4ZU5hbWUgPSBIQURPT1BfSE9NRV9ESVIgKyBGaWxlLnNlcGFyYXRv\nciArICJiaW4iICsgRmlsZS5zZXBhcmF0b3IgKyBleGVjdXRhYmxlOwoKICAg\nICAgICBGaWxlIGV4ZUZpbGUgPSBuZXcgRmlsZShmdWxsRXhlTmFtZSk7CiAg\nICAgICAgaWYgKCFleGVGaWxlLmV4aXN0cygpKSB7CiAgICAgICAgICAgIHRo\ncm93IG5ldyBJT0V4Y2VwdGlvbigiQ291bGQgbm90IGxvY2F0ZSBleGVjdXRh\nYmxlICIgKyBmdWxsRXhlTmFtZSArICIgaW4gdGhlIEhhZG9vcCBiaW5hcmll\ncy4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBleGVGaWxlLmdldENh\nbm9uaWNhbFBhdGgoKTsKICAgIH0KCiAgICAvKiogU2V0IHRvIHRydWUgb24g\nV2luZG93cyBwbGF0Zm9ybXMgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nYm9vbGVhbiBXSU5ET1dTIC8qIGJvcnJvd2VkIGZyb20gUGF0aC5XSU5ET1dT\nICovCiAgICA9IFN5c3RlbS5nZXRQcm9wZXJ0eSgib3MubmFtZSIpLnN0YXJ0\nc1dpdGgoIldpbmRvd3MiKTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGJv\nb2xlYW4gTElOVVggPSBTeXN0ZW0uZ2V0UHJvcGVydHkoIm9zLm5hbWUiKS5z\ndGFydHNXaXRoKCJMaW51eCIpOwoKICAgIC8qKiBhIFdpbmRvd3MgdXRpbGl0\neSB0byBlbXVsYXRlIFVuaXggY29tbWFuZHMgKi8KICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFdJTlVUSUxTID0gZ2V0V2luVXRpbHNQYXRoKCk7\nCgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgZ2V0V2luVXRpbHNQ\nYXRoKCkgewogICAgICAgIFN0cmluZyB3aW5VdGlsc1BhdGggPSBudWxsOwoK\nICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoV0lORE9XUykgewogICAg\nICAgICAgICAgICAgd2luVXRpbHNQYXRoID0gZ2V0UXVhbGlmaWVkQmluUGF0\naCgid2ludXRpbHMuZXhlIik7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgTE9HLmVycm9y\nKCJGYWlsZWQgdG8gbG9jYXRlIHRoZSB3aW51dGlscyBiaW5hcnkgaW4gdGhl\nIGhhZG9vcCBiaW5hcnkgcGF0aCIsIGlvZSk7CiAgICAgICAgfQoKICAgICAg\nICByZXR1cm4gd2luVXRpbHNQYXRoOwogICAgfQoKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgYm9vbGVhbiBpc1NldHNpZEF2YWlsYWJsZSA9IGlzU2V0c2lk\nU3VwcG9ydGVkKCk7CgogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBpc1Nl\ndHNpZFN1cHBvcnRlZCgpIHsKICAgICAgICBpZiAoU2hlbGwuV0lORE9XUykg\newogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAg\nIFNoZWxsQ29tbWFuZEV4ZWN1dG9yIHNoZXhlYyA9IG51bGw7CiAgICAgICAg\nYm9vbGVhbiBzZXRzaWRTdXBwb3J0ZWQgPSB0cnVlOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIFN0cmluZ1tdIGFyZ3MgPSB7ICJzZXRzaWQiLCAiYmFz\naCIsICItYyIsICJlY2hvICQkIiB9OwogICAgICAgICAgICBzaGV4ZWMgPSBu\nZXcgU2hlbGxDb21tYW5kRXhlY3V0b3IoYXJncyk7CiAgICAgICAgICAgIHNo\nZXhlYy5leGVjdXRlKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9lKSB7CiAgICAgICAgICAgIExPRy53YXJuKCJzZXRzaWQgaXMgbm90IGF2\nYWlsYWJsZSBvbiB0aGlzIG1hY2hpbmUuIFNvIG5vdCB1c2luZyBpdC4iKTsK\nICAgICAgICAgICAgc2V0c2lkU3VwcG9ydGVkID0gZmFsc2U7CiAgICAgICAg\nfSBmaW5hbGx5IHsgLy8gaGFuZGxlIHRoZSBleGl0IGNvZGUKICAgICAgICAg\nICAgaWYgKG51bGwgIT0gc2hleGVjKSB7CiAgICAgICAgICAgICAgICBMT0cu\naW5mbygic2V0c2lkIGV4aXRlZCB3aXRoIGV4aXQgY29kZSAiICsgc2hleGVj\nLmdldEV4aXRDb2RlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBzZXRzaWRTdXBwb3J0ZWQ7CiAgICB9CgogICAgLyoqIFRv\na2VuIHNlcGFyYXRvciByZWdleCB1c2VkIHRvIHBhcnNlIFNoZWxsIHRvb2wg\nb3V0cHV0cyAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgVE9L\nRU5fU0VQQVJBVE9SX1JFR0VYID0gV0lORE9XUyA/ICJbfFxuXHJdIiA6ICJb\nIFx0XG5cclxmXSI7CgogICAgcHJpdmF0ZSBsb25nIGludGVydmFsOyAvLyBy\nZWZyZXNoIGludGVydmFsIGluIG1zZWMKICAgIHByaXZhdGUgbG9uZyBsYXN0\nVGltZTsgLy8gbGFzdCB0aW1lIHRoZSBjb21tYW5kIHdhcyBwZXJmb3JtZWQK\nICAgIHByaXZhdGUgTWFwPFN0cmluZywgU3RyaW5nPiBlbnZpcm9ubWVudDsg\nLy8gZW52IGZvciB0aGUgY29tbWFuZCBleGVjdXRpb24KICAgIHByaXZhdGUg\nRmlsZSBkaXI7CiAgICBwcml2YXRlIFByb2Nlc3MgcHJvY2VzczsgLy8gc3Vi\nIHByb2Nlc3MgdXNlZCB0byBleGVjdXRlIHRoZSBjb21tYW5kCiAgICBwcml2\nYXRlIGludCBleGl0Q29kZTsKCiAgICAvKipJZiBvciBub3Qgc2NyaXB0IGZp\nbmlzaGVkIGV4ZWN1dGluZyovCiAgICBwcml2YXRlIHZvbGF0aWxlIEF0b21p\nY0Jvb2xlYW4gY29tcGxldGVkOwoKICAgIHB1YmxpYyBTaGVsbCgpIHsKICAg\nICAgICB0aGlzKDBMKTsKICAgIH0KCiAgICAvKioKICAgICAqIEBwYXJhbSBp\nbnRlcnZhbCB0aGUgbWluaW11bSBkdXJhdGlvbiB0byB3YWl0IGJlZm9yZSBy\nZS1leGVjdXRpbmcgdGhlCiAgICAgKiAgICAgICAgY29tbWFuZC4KICAgICAq\nLwogICAgcHVibGljIFNoZWxsKGxvbmcgaW50ZXJ2YWwpIHsKICAgICAgICB0\naGlzLmludGVydmFsID0gaW50ZXJ2YWw7CiAgICAgICAgdGhpcy5sYXN0VGlt\nZSA9IChpbnRlcnZhbCA8IDApID8gMCA6IC1pbnRlcnZhbDsKICAgIH0KCiAg\nICAvKiogc2V0IHRoZSBlbnZpcm9ubWVudCBmb3IgdGhlIGNvbW1hbmQKICAg\nICAqIEBwYXJhbSBlbnYgTWFwcGluZyBvZiBlbnZpcm9ubWVudCB2YXJpYWJs\nZXMKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2V0RW52aXJvbm1lbnQo\nTWFwPFN0cmluZywgU3RyaW5nPiBlbnYpIHsKICAgICAgICB0aGlzLmVudmly\nb25tZW50ID0gZW52OwogICAgfQoKICAgIC8qKiBzZXQgdGhlIHdvcmtpbmcg\nZGlyZWN0b3J5CiAgICAgKiBAcGFyYW0gZGlyIFRoZSBkaXJlY3Rvcnkgd2hl\ncmUgdGhlIGNvbW1hbmQgd291bGQgYmUgZXhlY3V0ZWQKICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgc2V0V29ya2luZ0RpcmVjdG9yeShGaWxlIGRpcikg\newogICAgICAgIHRoaXMuZGlyID0gZGlyOwogICAgfQoKICAgIC8qKiBjaGVj\nayB0byBzZWUgaWYgYSBjb21tYW5kIG5lZWRzIHRvIGJlIGV4ZWN1dGVkIGFu\nZCBleGVjdXRlIGlmIG5lZWRlZCAqLwogICAgcHJvdGVjdGVkIHZvaWQgcnVu\nKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAobGFzdFRpbWUg\nKyBpbnRlcnZhbCA+IE1hdGhVdGlscy5ub3coKSkKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIGV4aXRDb2RlID0gMDsgLy8gcmVzZXQgZm9yIG5leHQg\ncnVuCiAgICAgICAgcnVuQ29tbWFuZCgpOwogICAgfQoKICAgIC8qKiBSdW4g\nYSBjb21tYW5kICovCiAgICBwcml2YXRlIHZvaWQgcnVuQ29tbWFuZCgpIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgUHJvY2Vzc0J1aWxkZXIgYnVp\nbGRlciA9IG5ldyBQcm9jZXNzQnVpbGRlcihnZXRFeGVjU3RyaW5nKCkpOwog\nICAgICAgIFRpbWVyIHRpbWVPdXRUaW1lciA9IG51bGw7CiAgICAgICAgU2hl\nbGxUaW1lb3V0VGltZXJUYXNrIHRpbWVvdXRUaW1lclRhc2sgPSBudWxsOwog\nICAgICAgIHRpbWVkT3V0ID0gbmV3IEF0b21pY0Jvb2xlYW4oZmFsc2UpOwog\nICAgICAgIGNvbXBsZXRlZCA9IG5ldyBBdG9taWNCb29sZWFuKGZhbHNlKTsK\nCiAgICAgICAgaWYgKGVudmlyb25tZW50ICE9IG51bGwpIHsKICAgICAgICAg\nICAgYnVpbGRlci5lbnZpcm9ubWVudCgpLnB1dEFsbCh0aGlzLmVudmlyb25t\nZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKGRpciAhPSBudWxsKSB7CiAg\nICAgICAgICAgIGJ1aWxkZXIuZGlyZWN0b3J5KHRoaXMuZGlyKTsKICAgICAg\nICB9CgogICAgICAgIGlmIChTaGVsbC5XSU5ET1dTKSB7CiAgICAgICAgICAg\nIHN5bmNocm9uaXplZCAoV2luZG93c1Byb2Nlc3NMYXVuY2hMb2NrKSB7CiAg\nICAgICAgICAgICAgICAvLyBUbyB3b3JrYXJvdW5kIHRoZSByYWNlIGNvbmRp\ndGlvbiBpc3N1ZSB3aXRoIGNoaWxkIHByb2Nlc3NlcwogICAgICAgICAgICAg\nICAgLy8gaW5oZXJpdGluZyB1bmludGVuZGVkIGhhbmRsZXMgZHVyaW5nIHBy\nb2Nlc3MgbGF1bmNoIHRoYXQgY2FuCiAgICAgICAgICAgICAgICAvLyBsZWFk\nIHRvIGhhbmdzIG9uIHJlYWRpbmcgb3V0cHV0IGFuZCBlcnJvciBzdHJlYW1z\nLCB3ZQogICAgICAgICAgICAgICAgLy8gc2VyaWFsaXplIHByb2Nlc3MgY3Jl\nYXRpb24uIE1vcmUgaW5mbyBhdmFpbGFibGUgYXQ6CiAgICAgICAgICAgICAg\nICAvLyBodHRwOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2tiLzMxNTkzOQog\nICAgICAgICAgICAgICAgcHJvY2VzcyA9IGJ1aWxkZXIuc3RhcnQoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByb2Nl\nc3MgPSBidWlsZGVyLnN0YXJ0KCk7CiAgICAgICAgfQoKICAgICAgICBpZiAo\ndGltZU91dEludGVydmFsID4gMCkgewogICAgICAgICAgICB0aW1lT3V0VGlt\nZXIgPSBuZXcgVGltZXIoIlNoZWxsIGNvbW1hbmQgdGltZW91dCIpOwogICAg\nICAgICAgICB0aW1lb3V0VGltZXJUYXNrID0gbmV3IFNoZWxsVGltZW91dFRp\nbWVyVGFzayh0aGlzKTsKICAgICAgICAgICAgLy9PbmUgdGltZSBzY2hlZHVs\naW5nLgogICAgICAgICAgICB0aW1lT3V0VGltZXIuc2NoZWR1bGUodGltZW91\ndFRpbWVyVGFzaywgdGltZU91dEludGVydmFsKTsKICAgICAgICB9CiAgICAg\nICAgZmluYWwgQnVmZmVyZWRSZWFkZXIgZXJyUmVhZGVyID0gbmV3IEJ1ZmZl\ncmVkUmVhZGVyKG5ldyBJbnB1dFN0cmVhbVJlYWRlcihwcm9jZXNzLmdldEVy\ncm9yU3RyZWFtKCksCiAgICAgICAgICAgICAgICBDaGFyc2V0cy5VVEZfOCkp\nOwogICAgICAgIEJ1ZmZlcmVkUmVhZGVyIGluUmVhZGVyID0gbmV3IEJ1ZmZl\ncmVkUmVhZGVyKG5ldyBJbnB1dFN0cmVhbVJlYWRlcihwcm9jZXNzLmdldElu\ncHV0U3RyZWFtKCksIENoYXJzZXRzLlVURl84KSk7CiAgICAgICAgZmluYWwg\nU3RyaW5nQnVmZmVyIGVyck1zZyA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKCiAg\nICAgICAgLy8gcmVhZCBlcnJvciBhbmQgaW5wdXQgc3RyZWFtcyBhcyB0aGlz\nIHdvdWxkIGZyZWUgdXAgdGhlIGJ1ZmZlcnMKICAgICAgICAvLyBmcmVlIHRo\nZSBlcnJvciBzdHJlYW0gYnVmZmVyCiAgICAgICAgVGhyZWFkIGVyclRocmVh\nZCA9IG5ldyBUaHJlYWQoKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIFN0cmluZyBsaW5lID0gZXJyUmVh\nZGVyLnJlYWRMaW5lKCk7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChs\naW5lICE9IG51bGwpICYmICFpc0ludGVycnVwdGVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgZXJyTXNnLmFwcGVuZChsaW5lKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgZXJyTXNnLmFwcGVuZChTeXN0ZW0uZ2V0UHJvcGVy\ndHkoImxpbmUuc2VwYXJhdG9yIikpOwogICAgICAgICAgICAgICAgICAgICAg\nICBsaW5lID0gZXJyUmVhZGVyLnJlYWRMaW5lKCk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9lKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLndhcm4oIkVycm9yIHJl\nYWRpbmcgdGhlIGVycm9yIHN0cmVhbSIsIGlvZSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGVyclRocmVhZC5zdGFydCgpOwogICAgICAgIH0gY2F0Y2gg\nKElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiBpc2UpIHsKICAgICAgICB9CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcGFyc2VFeGVjUmVzdWx0KGluUmVhZGVy\nKTsgLy8gcGFyc2UgdGhlIG91dHB1dAogICAgICAgICAgICAvLyBjbGVhciB0\naGUgaW5wdXQgc3RyZWFtIGJ1ZmZlcgogICAgICAgICAgICBTdHJpbmcgbGlu\nZSA9IGluUmVhZGVyLnJlYWRMaW5lKCk7CiAgICAgICAgICAgIHdoaWxlIChs\naW5lICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGxpbmUgPSBpblJlYWRl\nci5yZWFkTGluZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHdh\naXQgZm9yIHRoZSBwcm9jZXNzIHRvIGZpbmlzaCBhbmQgY2hlY2sgdGhlIGV4\naXQgY29kZQogICAgICAgICAgICBleGl0Q29kZSA9IHByb2Nlc3Mud2FpdEZv\ncigpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gbWFr\nZSBzdXJlIHRoYXQgdGhlIGVycm9yIHRocmVhZCBleGl0cwogICAgICAgICAg\nICAgICAgZXJyVGhyZWFkLmpvaW4oKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgIExP\nRy53YXJuKCJJbnRlcnJ1cHRlZCB3aGlsZSByZWFkaW5nIHRoZSBlcnJvciBz\ndHJlYW0iLCBpZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29tcGxl\ndGVkLnNldCh0cnVlKTsKICAgICAgICAgICAgLy90aGUgdGltZW91dCB0aHJl\nYWQgaGFuZGxpbmcKICAgICAgICAgICAgLy90YWtlbiBjYXJlIGluIGZpbmFs\nbHkgYmxvY2sKICAgICAgICAgICAgaWYgKGV4aXRDb2RlICE9IDApIHsKICAg\nICAgICAgICAgICAgIHRocm93IG5ldyBFeGl0Q29kZUV4Y2VwdGlvbihleGl0\nQ29kZSwgZXJyTXNnLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB9CiAgICAg\nICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKGllLnRvU3RyaW5nKCkpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmICh0aW1lT3V0VGlt\nZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGltZU91dFRpbWVyLmNh\nbmNlbCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGNsb3NlIHRo\nZSBpbnB1dCBzdHJlYW0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIGluUmVhZGVyLmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElP\nRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAgICAgICAgTE9HLndhcm4oIkVy\ncm9yIHdoaWxlIGNsb3NpbmcgdGhlIGlucHV0IHN0cmVhbSIsIGlvZSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFjb21wbGV0ZWQuZ2V0KCkp\nIHsKICAgICAgICAgICAgICAgIGVyclRocmVhZC5pbnRlcnJ1cHQoKTsKICAg\nICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nZXJyUmVhZGVyLmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhj\nZXB0aW9uIGlvZSkgewogICAgICAgICAgICAgICAgTE9HLndhcm4oIkVycm9y\nIHdoaWxlIGNsb3NpbmcgdGhlIGVycm9yIHN0cmVhbSIsIGlvZSk7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgcHJvY2Vzcy5kZXN0cm95KCk7CiAgICAg\nICAgICAgIGxhc3RUaW1lID0gTWF0aFV0aWxzLm5vdygpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKiogcmV0dXJuIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhl\nIGNvbW1hbmQgbmFtZSAmIGl0cyBwYXJhbWV0ZXJzICovCiAgICBwcm90ZWN0\nZWQgYWJzdHJhY3QgU3RyaW5nW10gZ2V0RXhlY1N0cmluZygpOwoKICAgIC8q\nKiBQYXJzZSB0aGUgZXhlY3V0aW9uIHJlc3VsdCAqLwogICAgcHJvdGVjdGVk\nIGFic3RyYWN0IHZvaWQgcGFyc2VFeGVjUmVzdWx0KEJ1ZmZlcmVkUmVhZGVy\nIGxpbmVzKSB0aHJvd3MgSU9FeGNlcHRpb247CgogICAgLyoqIGdldCB0aGUg\nY3VycmVudCBzdWItcHJvY2VzcyBleGVjdXRpbmcgdGhlIGdpdmVuIGNvbW1h\nbmQKICAgICAqIEByZXR1cm4gcHJvY2VzcyBleGVjdXRpbmcgdGhlIGNvbW1h\nbmQKICAgICAqLwogICAgcHVibGljIFByb2Nlc3MgZ2V0UHJvY2VzcygpIHsK\nICAgICAgICByZXR1cm4gcHJvY2VzczsKICAgIH0KCiAgICAvKiogZ2V0IHRo\nZSBleGl0IGNvZGUKICAgICAqIEByZXR1cm4gdGhlIGV4aXQgY29kZSBvZiB0\naGUgcHJvY2VzcwogICAgICovCiAgICBwdWJsaWMgaW50IGdldEV4aXRDb2Rl\nKCkgewogICAgICAgIHJldHVybiBleGl0Q29kZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoaXMgaXMgYW4gSU9FeGNlcHRpb24gd2l0aCBleGl0IGNvZGUg\nYWRkZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRXhpdENv\nZGVFeGNlcHRpb24gZXh0ZW5kcyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEID0gMjI0\nMTA5NTEyMTYwOTUwMDgxMEw7CgogICAgICAgIGludCBleGl0Q29kZTsKCiAg\nICAgICAgcHVibGljIEV4aXRDb2RlRXhjZXB0aW9uKGludCBleGl0Q29kZSwg\nU3RyaW5nIG1lc3NhZ2UpIHsKICAgICAgICAgICAgc3VwZXIobWVzc2FnZSk7\nCiAgICAgICAgICAgIHRoaXMuZXhpdENvZGUgPSBleGl0Q29kZTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBpbnQgZ2V0RXhpdENvZGUoKSB7CiAgICAg\nICAgICAgIHJldHVybiBleGl0Q29kZTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBIHNpbXBsZSBzaGVsbCBjb21tYW5kIGV4ZWN1dG9yLgog\nICAgICoKICAgICAqIDxjb2RlPlNoZWxsQ29tbWFuZEV4ZWN1dG9yPC9jb2Rl\nPnNob3VsZCBiZSB1c2VkIGluIGNhc2VzIHdoZXJlIHRoZSBvdXRwdXQKICAg\nICAqIG9mIHRoZSBjb21tYW5kIG5lZWRzIG5vIGV4cGxpY2l0IHBhcnNpbmcg\nYW5kIHdoZXJlIHRoZSBjb21tYW5kLCB3b3JraW5nCiAgICAgKiBkaXJlY3Rv\ncnkgYW5kIHRoZSBlbnZpcm9ubWVudCByZW1haW5zIHVuY2hhbmdlZC4gVGhl\nIG91dHB1dCBvZiB0aGUgY29tbWFuZAogICAgICogaXMgc3RvcmVkIGFzLWlz\nIGFuZCBpcyBleHBlY3RlZCB0byBiZSBzbWFsbC4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBTaGVsbENvbW1hbmRFeGVjdXRvciBleHRlbmRz\nIFNoZWxsIHsKCiAgICAgICAgcHJpdmF0ZSBTdHJpbmdbXSBjb21tYW5kOwog\nICAgICAgIHByaXZhdGUgU3RyaW5nQnVmZmVyIG91dHB1dDsKCiAgICAgICAg\ncHVibGljIFNoZWxsQ29tbWFuZEV4ZWN1dG9yKFN0cmluZ1tdIGV4ZWNTdHJp\nbmcpIHsKICAgICAgICAgICAgdGhpcyhleGVjU3RyaW5nLCBudWxsKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBTaGVsbENvbW1hbmRFeGVjdXRvcihT\ndHJpbmdbXSBleGVjU3RyaW5nLCBGaWxlIGRpcikgewogICAgICAgICAgICB0\naGlzKGV4ZWNTdHJpbmcsIGRpciwgbnVsbCk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgU2hlbGxDb21tYW5kRXhlY3V0b3IoU3RyaW5nW10gZXhlY1N0\ncmluZywgRmlsZSBkaXIsIE1hcDxTdHJpbmcsIFN0cmluZz4gZW52KSB7CiAg\nICAgICAgICAgIHRoaXMoZXhlY1N0cmluZywgZGlyLCBlbnYsIDBMKTsKICAg\nICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIENyZWF0ZSBhIG5ldyBp\nbnN0YW5jZSBvZiB0aGUgU2hlbGxDb21tYW5kRXhlY3V0b3IgdG8gZXhlY3V0\nZSBhIGNvbW1hbmQuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gZXhl\nY1N0cmluZyBUaGUgY29tbWFuZCB0byBleGVjdXRlIHdpdGggYXJndW1lbnRz\nCiAgICAgICAgICogQHBhcmFtIGRpciBJZiBub3QtbnVsbCwgc3BlY2lmaWVz\nIHRoZSBkaXJlY3Rvcnkgd2hpY2ggc2hvdWxkIGJlIHNldAogICAgICAgICAq\nICAgICAgICAgICAgYXMgdGhlIGN1cnJlbnQgd29ya2luZyBkaXJlY3Rvcnkg\nZm9yIHRoZSBjb21tYW5kLgogICAgICAgICAqICAgICAgICAgICAgSWYgbnVs\nbCwgdGhlIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnkgaXMgbm90IG1vZGlm\naWVkLgogICAgICAgICAqIEBwYXJhbSBlbnYgSWYgbm90LW51bGwsIGVudmly\nb25tZW50IG9mIHRoZSBjb21tYW5kIHdpbGwgaW5jbHVkZSB0aGUKICAgICAg\nICAgKiAgICAgICAgICAgIGtleS12YWx1ZSBwYWlycyBzcGVjaWZpZWQgaW4g\ndGhlIG1hcC4gSWYgbnVsbCwgdGhlIGN1cnJlbnQKICAgICAgICAgKiAgICAg\nICAgICAgIGVudmlyb25tZW50IGlzIG5vdCBtb2RpZmllZC4KICAgICAgICAg\nKiBAcGFyYW0gdGltZW91dCBTcGVjaWZpZXMgdGhlIHRpbWUgaW4gbWlsbGlz\nZWNvbmRzLCBhZnRlciB3aGljaCB0aGUKICAgICAgICAgKiAgICAgICAgICAg\nICAgICBjb21tYW5kIHdpbGwgYmUga2lsbGVkIGFuZCB0aGUgc3RhdHVzIG1h\ncmtlZCBhcyB0aW1lZG91dC4KICAgICAgICAgKiAgICAgICAgICAgICAgICBJ\nZiAwLCB0aGUgY29tbWFuZCB3aWxsIG5vdCBiZSB0aW1lZCBvdXQuCiAgICAg\nICAgICovCiAgICAgICAgcHVibGljIFNoZWxsQ29tbWFuZEV4ZWN1dG9yKFN0\ncmluZ1tdIGV4ZWNTdHJpbmcsIEZpbGUgZGlyLCBNYXA8U3RyaW5nLCBTdHJp\nbmc+IGVudiwgbG9uZyB0aW1lb3V0KSB7CiAgICAgICAgICAgIGNvbW1hbmQg\nPSBleGVjU3RyaW5nLmNsb25lKCk7CiAgICAgICAgICAgIGlmIChkaXIgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgc2V0V29ya2luZ0RpcmVjdG9yeShk\naXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlbnYgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgc2V0RW52aXJvbm1lbnQoZW52KTsKICAg\nICAgICAgICAgfQogICAgICAgICAgICB0aW1lT3V0SW50ZXJ2YWwgPSB0aW1l\nb3V0OwogICAgICAgIH0KCiAgICAgICAgLyoqIEV4ZWN1dGUgdGhlIHNoZWxs\nIGNvbW1hbmQuICovCiAgICAgICAgcHVibGljIHZvaWQgZXhlY3V0ZSgpIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRoaXMucnVuKCk7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3Ry\naW5nW10gZ2V0RXhlY1N0cmluZygpIHsKICAgICAgICAgICAgcmV0dXJuIGNv\nbW1hbmQuY2xvbmUoKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlRXhlY1Jlc3VsdChCdWZmZXJl\nZFJlYWRlciBsaW5lcykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgb3V0cHV0ID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAgICBj\naGFyW10gYnVmID0gbmV3IGNoYXJbNTEyXTsKICAgICAgICAgICAgaW50IG5S\nZWFkOwogICAgICAgICAgICB3aGlsZSAoKG5SZWFkID0gbGluZXMucmVhZChi\ndWYsIDAsIGJ1Zi5sZW5ndGgpKSA+IDApIHsKICAgICAgICAgICAgICAgIG91\ndHB1dC5hcHBlbmQoYnVmLCAwLCBuUmVhZCk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIC8qKiBHZXQgdGhlIG91dHB1dCBvZiB0aGUgc2hl\nbGwgY29tbWFuZC4qLwogICAgICAgIHB1YmxpYyBTdHJpbmcgZ2V0T3V0cHV0\nKCkgewogICAgICAgICAgICByZXR1cm4gKG91dHB1dCA9PSBudWxsKSA/ICIi\nIDogb3V0cHV0LnRvU3RyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBSZXR1cm5zIHRoZSBjb21tYW5kcyBvZiB0aGlzIGluc3Rh\nbmNlLgogICAgICAgICAqIEFyZ3VtZW50cyB3aXRoIHNwYWNlcyBpbiBhcmUg\ncHJlc2VudGVkIHdpdGggcXVvdGVzIHJvdW5kOyBvdGhlcgogICAgICAgICAq\nIGFyZ3VtZW50cyBhcmUgcHJlc2VudGVkIHJhdwogICAgICAgICAqCiAgICAg\nICAgICogQHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUg\nb2JqZWN0LgogICAgICAgICAqLwogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgICAgIFN0cmlu\nZ0J1aWxkZXIgYnVpbGRlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAg\nICAgICAgIFN0cmluZ1tdIGFyZ3MgPSBnZXRFeGVjU3RyaW5nKCk7CiAgICAg\nICAgICAgIGZvciAoU3RyaW5nIHMgOiBhcmdzKSB7CiAgICAgICAgICAgICAg\nICBpZiAocy5pbmRleE9mKCcgJykgPj0gMCkgewogICAgICAgICAgICAgICAg\nICAgIGJ1aWxkZXIuYXBwZW5kKCciJykuYXBwZW5kKHMpLmFwcGVuZCgnIicp\nOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAg\nICBidWlsZGVyLmFwcGVuZChzKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIGJ1aWxkZXIuYXBwZW5kKCcgJyk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXIudG9TdHJpbmcoKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUbyBjaGVjayBpZiB0aGUgcGFz\nc2VkIHNjcmlwdCB0byBzaGVsbCBjb21tYW5kIGV4ZWN1dG9yIHRpbWVkIG91\ndCBvcgogICAgICogbm90LgogICAgICoKICAgICAqIEByZXR1cm4gaWYgdGhl\nIHNjcmlwdCB0aW1lZCBvdXQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGlzVGltZWRPdXQoKSB7CiAgICAgICAgcmV0dXJuIHRpbWVkT3V0LmdldCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGlmIHRoZSBjb21tYW5kIGhh\ncyB0aW1lZCBvdXQuCiAgICAgKgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nc2V0VGltZWRPdXQoKSB7CiAgICAgICAgdGhpcy50aW1lZE91dC5zZXQodHJ1\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0aWMgbWV0aG9kIHRvIGV4\nZWN1dGUgYSBzaGVsbCBjb21tYW5kLgogICAgICogQ292ZXJzIG1vc3Qgb2Yg\ndGhlIHNpbXBsZSBjYXNlcyB3aXRob3V0IHJlcXVpcmluZyB0aGUgdXNlciB0\nbyBpbXBsZW1lbnQKICAgICAqIHRoZSA8Y29kZT5TaGVsbDwvY29kZT4gaW50\nZXJmYWNlLgogICAgICogQHBhcmFtIGNtZCBzaGVsbCBjb21tYW5kIHRvIGV4\nZWN1dGUuCiAgICAgKiBAcmV0dXJuIHRoZSBvdXRwdXQgb2YgdGhlIGV4ZWN1\ndGVkIGNvbW1hbmQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5n\nIGV4ZWNDb21tYW5kKFN0cmluZy4uLiBjbWQpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIGV4ZWNDb21tYW5kKG51bGwsIGNtZCwgMEwp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3RhdGljIG1ldGhvZCB0byBleGVj\ndXRlIGEgc2hlbGwgY29tbWFuZC4KICAgICAqIENvdmVycyBtb3N0IG9mIHRo\nZSBzaW1wbGUgY2FzZXMgd2l0aG91dCByZXF1aXJpbmcgdGhlIHVzZXIgdG8g\naW1wbGVtZW50CiAgICAgKiB0aGUgPGNvZGU+U2hlbGw8L2NvZGU+IGludGVy\nZmFjZS4KICAgICAqIEBwYXJhbSBlbnYgdGhlIG1hcCBvZiBlbnZpcm9ubWVu\ndCBrZXk9dmFsdWUKICAgICAqIEBwYXJhbSBjbWQgc2hlbGwgY29tbWFuZCB0\nbyBleGVjdXRlLgogICAgICogQHBhcmFtIHRpbWVvdXQgdGltZSBpbiBtaWxs\naXNlY29uZHMgYWZ0ZXIgd2hpY2ggc2NyaXB0IHNob3VsZCBiZSBtYXJrZWQg\ndGltZW91dAogICAgICogQHJldHVybiB0aGUgb3V0cHV0IG9mIHRoZSBleGVj\ndXRlZCBjb21tYW5kLm8KICAgICAqLwoKICAgIHB1YmxpYyBzdGF0aWMgU3Ry\naW5nIGV4ZWNDb21tYW5kKE1hcDxTdHJpbmcsIFN0cmluZz4gZW52LCBTdHJp\nbmdbXSBjbWQsIGxvbmcgdGltZW91dCkgdGhyb3dzIElPRXhjZXB0aW9uIHsK\nICAgICAgICBTaGVsbENvbW1hbmRFeGVjdXRvciBleGVjID0gbmV3IFNoZWxs\nQ29tbWFuZEV4ZWN1dG9yKGNtZCwgbnVsbCwgZW52LCB0aW1lb3V0KTsKICAg\nICAgICBleGVjLmV4ZWN1dGUoKTsKICAgICAgICByZXR1cm4gZXhlYy5nZXRP\ndXRwdXQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXRpYyBtZXRob2Qg\ndG8gZXhlY3V0ZSBhIHNoZWxsIGNvbW1hbmQuCiAgICAgKiBDb3ZlcnMgbW9z\ndCBvZiB0aGUgc2ltcGxlIGNhc2VzIHdpdGhvdXQgcmVxdWlyaW5nIHRoZSB1\nc2VyIHRvIGltcGxlbWVudAogICAgICogdGhlIDxjb2RlPlNoZWxsPC9jb2Rl\nPiBpbnRlcmZhY2UuCiAgICAgKiBAcGFyYW0gZW52IHRoZSBtYXAgb2YgZW52\naXJvbm1lbnQga2V5PXZhbHVlCiAgICAgKiBAcGFyYW0gY21kIHNoZWxsIGNv\nbW1hbmQgdG8gZXhlY3V0ZS4KICAgICAqIEByZXR1cm4gdGhlIG91dHB1dCBv\nZiB0aGUgZXhlY3V0ZWQgY29tbWFuZC4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBTdHJpbmcgZXhlY0NvbW1hbmQoTWFwPFN0cmluZywgU3RyaW5nPiBl\nbnYsIFN0cmluZy4uLiBjbWQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIGV4ZWNDb21tYW5kKGVudiwgY21kLCAwTCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaW1lciB3aGljaCBpcyB1c2VkIHRvIHRpbWVvdXQg\nc2NyaXB0cyBzcGF3bmVkIG9mZiBieSBzaGVsbC4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgY2xhc3MgU2hlbGxUaW1lb3V0VGltZXJUYXNrIGV4dGVu\nZHMgVGltZXJUYXNrIHsKCiAgICAgICAgcHJpdmF0ZSBTaGVsbCBzaGVsbDsK\nCiAgICAgICAgcHVibGljIFNoZWxsVGltZW91dFRpbWVyVGFzayhTaGVsbCBz\naGVsbCkgewogICAgICAgICAgICB0aGlzLnNoZWxsID0gc2hlbGw7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgIFByb2Nlc3MgcCA9IHNoZWxsLmdldFByb2Nl\nc3MoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHAuZXhp\ndFZhbHVlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAvL1Byb2Nlc3MgaGFzIG5vdCB0ZXJtaW5hdGVk\nLgogICAgICAgICAgICAgICAgLy9TbyBjaGVjayBpZiBpdCBoYXMgY29tcGxl\ndGVkCiAgICAgICAgICAgICAgICAvL2lmIG5vdCBqdXN0IGRlc3Ryb3kgaXQu\nCiAgICAgICAgICAgICAgICBpZiAocCAhPSBudWxsICYmICFzaGVsbC5jb21w\nbGV0ZWQuZ2V0KCkpIHsKICAgICAgICAgICAgICAgICAgICBzaGVsbC5zZXRU\naW1lZE91dCgpOwogICAgICAgICAgICAgICAgICAgIHAuZGVzdHJveSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

