{"sha":"871612ef5cade9c7088d300e93235a610973ffc5","node_id":"MDQ6QmxvYjE1NzU5NTY6ODcxNjEyZWY1Y2FkZTljNzA4OGQzMDBlOTMyMzVhNjEwOTczZmZjNQ==","size":5201,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/871612ef5cade9c7088d300e93235a610973ffc5","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci56b29rZWVwZXI7\nCgppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ2FsbGFibGU7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIudXRpbC5NYXRoVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7\nCgovKioKICogUHJvdmlkZSBhIG1lY2hhbmlzbSB0byBwZXJmb3JtIGFuIG9w\nZXJhdGlvbiBvbiBab29LZWVwZXIgdGhhdCBpcyBzYWZlIG9uIGRpc2Nvbm5l\nY3Rpb25zCiAqIGFuZCByZWNvdmVyYWJsZSBlcnJvcnMuCiAqLwpjbGFzcyBa\nb29Xb3JrZXIgewoKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoWm9vV29ya2VyLmNsYXNzKTsKCiAg\nICBpbnQgYXR0ZW1wdHMgPSAwOwogICAgbG9uZyBzdGFydFRpbWVNczsKICAg\nIGxvbmcgZWxhcHNlZFRpbWVNcyA9IDBMOwogICAgZmluYWwgUmV0cnlQb2xp\nY3kgcmV0cnlQb2xpY3k7CgogICAgWm9vV29ya2VyKFJldHJ5UG9saWN5IHJl\ndHJ5UG9saWN5KSB7CiAgICAgICAgdGhpcy5yZXRyeVBvbGljeSA9IHJldHJ5\nUG9saWN5OwogICAgICAgIHRoaXMuc3RhcnRUaW1lTXMgPSBNYXRoVXRpbHMu\nbm93KCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gYWxsb3dSZXRyeShp\nbnQgcmMpIHsKICAgICAgICBpZiAoIVpvb1dvcmtlci5pc1JlY292ZXJhYmxl\nRXhjZXB0aW9uKHJjKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgfQogICAgICAgICsrYXR0ZW1wdHM7CiAgICAgICAgZWxhcHNlZFRp\nbWVNcyA9IE1hdGhVdGlscy5ub3coKSAtIHN0YXJ0VGltZU1zOwogICAgICAg\nIHJldHVybiByZXRyeVBvbGljeS5hbGxvd1JldHJ5KGF0dGVtcHRzLCBlbGFw\nc2VkVGltZU1zKTsKICAgIH0KCiAgICBwdWJsaWMgbG9uZyBuZXh0UmV0cnlX\nYWl0VGltZSgpIHsKICAgICAgICByZXR1cm4gcmV0cnlQb2xpY3kubmV4dFJl\ndHJ5V2FpdFRpbWUoYXR0ZW1wdHMsIGVsYXBzZWRUaW1lTXMpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ2hlY2sgd2hldGhlciB0aGUgZ2l2ZW4gcmVzdWx0\nIGNvZGUgaXMgcmVjb3ZlcmFibGUgYnkgcmV0cnkuCiAgICAgKiAKICAgICAq\nIEBwYXJhbSByYyByZXN1bHQgY29kZQogICAgICogQHJldHVybiB0cnVlIGlm\nIGdpdmVuIHJlc3VsdCBjb2RlIGlzIHJlY292ZXJhYmxlLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNSZWNvdmVyYWJsZUV4Y2VwdGlv\nbihpbnQgcmMpIHsKICAgICAgICByZXR1cm4gS2VlcGVyRXhjZXB0aW9uLkNv\nZGUuQ09OTkVDVElPTkxPU1MuaW50VmFsdWUoKSA9PSByYyB8fAogICAgICAg\nICAgICAgICAgS2VlcGVyRXhjZXB0aW9uLkNvZGUuT1BFUkFUSU9OVElNRU9V\nVC5pbnRWYWx1ZSgpID09IHJjIHx8CiAgICAgICAgICAgICAgICBLZWVwZXJF\neGNlcHRpb24uQ29kZS5TRVNTSU9OTU9WRUQuaW50VmFsdWUoKSA9PSByYyB8\nfAogICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uLkNvZGUuU0VTU0lP\nTkVYUElSRUQuaW50VmFsdWUoKSA9PSByYzsKICAgIH0KCiAgICAvKioKICAg\nICAqIENoZWNrIHdoZXRoZXIgdGhlIGdpdmVuIGV4Y2VwdGlvbiBpcyByZWNv\ndmVyYWJsZSBieSByZXRyeS4KICAgICAqIAogICAgICogQHBhcmFtIGV4Y2Vw\ndGlvbiBnaXZlbiBleGNlcHRpb24KICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBn\naXZlbiBleGNlcHRpb24gaXMgcmVjb3ZlcmFibGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgYm9vbGVhbiBpc1JlY292ZXJhYmxlRXhjZXB0aW9uKEtl\nZXBlckV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICByZXR1cm4gaXNS\nZWNvdmVyYWJsZUV4Y2VwdGlvbihleGNlcHRpb24uY29kZSgpLmludFZhbHVl\nKCkpOwogICAgfQogICAgCiAgICBzdGF0aWMgaW50ZXJmYWNlIFpvb0NhbGxh\nYmxlPFQ+IHsKICAgICAgICAvKioKICAgICAgICAgKiBCZSBjb21wYXRpYmxl\nIHdpdGggWm9vS2VlcGVyIGludGVyZmFjZS4KICAgICAgICAgKgogICAgICAg\nICAqIEByZXR1cm4gdmFsdWUKICAgICAgICAgKiBAdGhyb3dzIEludGVycnVw\ndGVkRXhjZXB0aW9uCiAgICAgICAgICogQHRocm93cyBLZWVwZXJFeGNlcHRp\nb24KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgVCBjYWxsKCkgdGhyb3dz\nIEludGVycnVwdGVkRXhjZXB0aW9uLCBLZWVwZXJFeGNlcHRpb247CiAgICB9\nCgogICAgLyoqCiAgICAgKiBFeGVjdXRlIGEgc3luYyB6b29rZWVwZXIgb3Bl\ncmF0aW9uIHdpdGggYSBnaXZlbiByZXRyeSBwb2xpY3kuCiAgICAgKiAKICAg\nICAqIEBwYXJhbSBjbGllbnQKICAgICAqICAgICAgICAgIFpvb0tlZXBlciBj\nbGllbnQuCiAgICAgKiBAcGFyYW0gcHJvYwogICAgICogICAgICAgICAgU3lu\nY2hyb25vdXMgem9va2VlcGVyIG9wZXJhdGlvbiB3cmFwcGVkIGluIGEge0Bs\naW5rIENhbGxhYmxlfS4KICAgICAqIEBwYXJhbSByZXRyeVBvbGljeQogICAg\nICogICAgICAgICAgUmV0cnkgcG9saWN5IHRvIGV4ZWN1dGUgdGhlIHN5bmNo\ncm9ub3VzIG9wZXJhdGlvbi4KICAgICAqIEByZXR1cm4gcmVzdWx0IG9mIHRo\nZSB6b29rZWVwZXIgb3BlcmF0aW9uCiAgICAgKiBAdGhyb3dzIEtlZXBlckV4\nY2VwdGlvbiBhbnkgbm9uLXJlY292ZXJhYmxlIGV4Y2VwdGlvbiBvciByZWNv\ndmVyYWJsZSBleGNlcHRpb24gZXhoYXVzdGVkIGFsbCByZXRpcmVzLgogICAg\nICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB0aGUgb3BlcmF0aW9u\nIGlzIGludGVycnVwdGVkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljPFQ+\nIFQgc3luY0NhbGxXaXRoUmV0cmllcygKICAgICAgICAgICAgWm9vS2VlcGVy\nQ2xpZW50IGNsaWVudCwgWm9vQ2FsbGFibGU8VD4gcHJvYywgUmV0cnlQb2xp\nY3kgcmV0cnlQb2xpY3kpCiAgICB0aHJvd3MgS2VlcGVyRXhjZXB0aW9uLCBJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgVCByZXN1bHQgPSBudWxs\nOwogICAgICAgIGJvb2xlYW4gaXNEb25lID0gZmFsc2U7CiAgICAgICAgaW50\nIGF0dGVtcHRzID0gMDsKICAgICAgICBsb25nIHN0YXJ0VGltZU1zID0gTWF0\naFV0aWxzLm5vdygpOwogICAgICAgIHdoaWxlICghaXNEb25lKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBjbGll\nbnQpIHsKICAgICAgICAgICAgICAgICAgICBjbGllbnQud2FpdEZvckNvbm5l\nY3Rpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxv\nZ2dlci5kZWJ1ZygiRXhlY3V0ZSB7fSBhdCB7fSByZXRyeSBhdHRlbXB0LiIs\nIHByb2MsIGF0dGVtcHRzKTsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHBy\nb2MuY2FsbCgpOwogICAgICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTsKICAg\nICAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgICsrYXR0ZW1wdHM7CiAgICAgICAgICAgICAgICBib29sZWFu\nIHJldGhyb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgbG9uZyBlbGFwc2Vk\nVGltZSA9IE1hdGhVdGlscy5ub3coKSAtIHN0YXJ0VGltZU1zOwogICAgICAg\nICAgICAgICAgaWYgKCgobnVsbCAhPSBjbGllbnQgJiYgaXNSZWNvdmVyYWJs\nZUV4Y2VwdGlvbihlKSkgfHwgbnVsbCA9PSBjbGllbnQpICYmCiAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHJ5UG9saWN5LmFsbG93UmV0cnkoYXR0ZW1w\ndHMsIGVsYXBzZWRUaW1lKSkgewogICAgICAgICAgICAgICAgICAgIHJldGhy\nb3cgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGlmIChyZXRocm93KSB7CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRl\nYnVnKCJTdG9wcGVkIGV4ZWN1dGluZyB7fSBhZnRlciB7fSBhdHRlbXB0cy4i\nLCBwcm9jLCBhdHRlbXB0cyk7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFRpbWVVbml0\nLk1JTExJU0VDT05EUy5zbGVlcChyZXRyeVBvbGljeS5uZXh0UmV0cnlXYWl0\nVGltZShhdHRlbXB0cywgZWxhcHNlZFRpbWUpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIHN0\nYXRpYzxUPiBUIHN5bmNDYWxsV2l0aFJldHJpZXMoCiAgICAgICAgICAgIFpv\nb0NhbGxhYmxlPFQ+IHByb2MsIFJldHJ5UG9saWN5IHJldHJ5UG9saWN5KSB0\naHJvd3MgS2VlcGVyRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCiAgICAgICAgcmV0dXJuIHN5bmNDYWxsV2l0aFJldHJpZXMobnVsbCwgcHJv\nYywgcmV0cnlQb2xpY3kpOwogICAgfQoKfQo=\n","encoding":"base64"}

