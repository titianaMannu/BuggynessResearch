{"sha":"151feaeb2dc9b5462afd29b1fd536b33e9aecf47","node_id":"MDQ6QmxvYjE1NzU5NTY6MTUxZmVhZWIyZGM5YjU0NjJhZmQyOWIxZmQ1MzZiMzNlOWFlY2Y0Nw==","size":4900,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/151feaeb2dc9b5462afd29b1fd536b33e9aecf47","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llOwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCgpp\nbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9uOwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdl\nc3RUeXBlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9v\na0tlZXBlckNsdXN0ZXJUZXN0Q2FzZTsKCmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQg\nb3JnLmp1bml0LkFzc2VydDsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKaW1w\nb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7CgovKioKICogVGhpcyBj\nbGFzcyB0ZXN0cyB0aGF0IGluZGV4IGNvcnJ1cHRpb24gY2FzZXMKICovCnB1\nYmxpYyBjbGFzcyBJbmRleENvcnJ1cHRpb25UZXN0IGV4dGVuZHMgQm9va0tl\nZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CiAgICBwcml2YXRlIGZpbmFsIHN0YXRp\nYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSW5kZXhD\nb3JydXB0aW9uVGVzdC5jbGFzcyk7CgogICAgRGlnZXN0VHlwZSBkaWdlc3RU\neXBlOwoKICAgIGludCBwYWdlU2l6ZSA9IDEwMjQ7CgogICAgcHVibGljIElu\nZGV4Q29ycnVwdGlvblRlc3QoKSB7CiAgICAgICAgc3VwZXIoMSk7CiAgICAg\nICAgdGhpcy5kaWdlc3RUeXBlID0gRGlnZXN0VHlwZS5DUkMzMjsKICAgICAg\nICBiYXNlQ29uZi5zZXRQYWdlU2l6ZShwYWdlU2l6ZSk7CiAgICB9CgogICAg\nQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3ROb1N1\nY2hMZWRnZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMT0cuZGVi\ndWcoIlRlc3RpbmcgTm9TdWNoTGVkZ2VyIik7CgogICAgICAgIFN5bmNUaHJl\nYWQgc3luY1RocmVhZCA9IGJzLmdldCgwKS5nZXRCb29raWUoKS5zeW5jVGhy\nZWFkOwogICAgICAgIHN5bmNUaHJlYWQuc3VzcGVuZFN5bmMoKTsKICAgICAg\nICAvLyBDcmVhdGUgYSBsZWRnZXIKICAgICAgICBMZWRnZXJIYW5kbGUgbGgg\nPSBia2MuY3JlYXRlTGVkZ2VyKDEsIDEsIGRpZ2VzdFR5cGUsICIiLmdldEJ5\ndGVzKCkpOwoKICAgICAgICAvLyBDbG9zZSB0aGUgbGVkZ2VyIHdoaWNoIGNh\ndXNlIGEgcmVhZEVudHJ5KDApIGNhbGwKICAgICAgICBMZWRnZXJIYW5kbGUg\nbmV3TGggPSBia2Mub3BlbkxlZGdlcihsaC5nZXRJZCgpLCBkaWdlc3RUeXBl\nLCAiIi5nZXRCeXRlcygpKTsKCiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGxl\nZGdlciB0byB3cml0ZSBlbnRyaWVzCiAgICAgICAgU3RyaW5nIGR1bW15TXNn\nID0gIk5vU3VjaExlZGdlciI7CiAgICAgICAgaW50IG51bU1zZ3MgPSAzOwog\nICAgICAgIExlZGdlckhhbmRsZSB3bGggPSBia2MuY3JlYXRlTGVkZ2VyKDEs\nIDEsIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIGZvciAo\naW50IGk9MDsgaTxudW1Nc2dzOyBpKyspIHsKICAgICAgICAgICAgd2xoLmFk\nZEVudHJ5KGR1bW15TXNnLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAg\nICAgc3luY1RocmVhZC5yZXN1bWVTeW5jKCk7CgogICAgICAgIC8vIHRyaWdn\nZXIgc3luYwogICAgICAgIFRocmVhZC5zbGVlcCgyICogYmFzZUNvbmYuZ2V0\nRmx1c2hJbnRlcnZhbCgpKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVz\nCiAgICAgICAgcmVzdGFydEJvb2tpZXMoKTsKCiAgICAgICAgRW51bWVyYXRp\nb248TGVkZ2VyRW50cnk+IHNlcSA9IHdsaC5yZWFkRW50cmllcygwLCBudW1N\nc2dzIC0gMSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiRW51bWVyYXRpb24gb2Yg\nbGVkZ2VyIGVudHJpZXMgaGFzIG5vIGVsZW1lbnQiLCBzZXEuaGFzTW9yZUVs\nZW1lbnRzKCkgPT0gdHJ1ZSk7CiAgICAgICAgaW50IGVudHJ5SWQgPSAwOwog\nICAgICAgIHdoaWxlIChzZXEuaGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAg\nICAgICAgTGVkZ2VyRW50cnkgZSA9IHNlcS5uZXh0RWxlbWVudCgpOwogICAg\nICAgICAgICBhc3NlcnRFcXVhbHMoZW50cnlJZCwgZS5nZXRFbnRyeUlkKCkp\nOwoKICAgICAgICAgICAgQXNzZXJ0LmFzc2VydEFycmF5RXF1YWxzKGR1bW15\nTXNnLmdldEJ5dGVzKCksIGUuZ2V0RW50cnkoKSk7CiAgICAgICAgICAgICsr\nZW50cnlJZDsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0RXF1YWxzKGVudHJ5\nSWQsIG51bU1zZ3MpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDAp\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0RW1wdHlJbmRleFBhZ2UoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBMT0cuZGVidWcoIlRlc3RpbmcgRW1wdHlJ\nbmRleFBhZ2UiKTsKCiAgICAgICAgU3luY1RocmVhZCBzeW5jVGhyZWFkID0g\nYnMuZ2V0KDApLmdldEJvb2tpZSgpLnN5bmNUaHJlYWQ7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbCgiTm90IGZvdW5kIFN5bmNUaHJlYWQuIiwgc3luY1RocmVh\nZCk7CgogICAgICAgIHN5bmNUaHJlYWQuc3VzcGVuZFN5bmMoKTsKCiAgICAg\nICAgLy8gQ3JlYXRlIGEgbGVkZ2VyCiAgICAgICAgTGVkZ2VySGFuZGxlIGxo\nMSA9IGJrYy5jcmVhdGVMZWRnZXIoMSwgMSwgZGlnZXN0VHlwZSwgIiIuZ2V0\nQnl0ZXMoKSk7CgogICAgICAgIFN0cmluZyBkdW1teU1zZyA9ICJOb1N1Y2hM\nZWRnZXIiOwoKICAgICAgICAvLyB3cml0ZSB0d28gcGFnZSBlbnRyaWVzIHRv\nIGxlZGdlciAyCiAgICAgICAgaW50IG51bU1zZ3MgPSAyICogcGFnZVNpemUg\nLyA4OwogICAgICAgIExlZGdlckhhbmRsZSBsaDIgPSBia2MuY3JlYXRlTGVk\nZ2VyKDEsIDEsIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAg\nIGZvciAoaW50IGk9MDsgaTxudW1Nc2dzOyBpKyspIHsKICAgICAgICAgICAg\nbGgyLmFkZEVudHJ5KGR1bW15TXNnLmdldEJ5dGVzKCkpOwogICAgICAgIH0K\nCiAgICAgICAgc3luY1RocmVhZC5yZXN1bWVTeW5jKCk7CgogICAgICAgIC8v\nIHRyaWdnZXIgc3luYwogICAgICAgIFRocmVhZC5zbGVlcCgyICogYmFzZUNv\nbmYuZ2V0Rmx1c2hJbnRlcnZhbCgpKTsKCiAgICAgICAgc3luY1RocmVhZC5z\ndXNwZW5kU3luYygpOwoKICAgICAgICAvLyBDbG9zZSBsZWRnZXIgMSB3aGlj\naCBjYXVzZSBhIHJlYWRFbnRyeSgwKSBjYWxsCiAgICAgICAgTGVkZ2VySGFu\nZGxlIG5ld0xoMSA9IGJrYy5vcGVuTGVkZ2VyKGxoMS5nZXRJZCgpLCBkaWdl\nc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKCiAgICAgICAgLy8gd3JpdGUgYW5v\ndGhlciAzIGVudHJpZXMgdG8gbGVkZ2VyIDIKICAgICAgICBmb3IgKGludCBp\nPTA7IGk8MzsgaSsrKSB7CiAgICAgICAgICAgIGxoMi5hZGRFbnRyeShkdW1t\neU1zZy5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAgICAgIHN5bmNUaHJl\nYWQucmVzdW1lU3luYygpOwoKICAgICAgICAvLyB3YWl0IGZvciBzeW5jIGFn\nYWluCiAgICAgICAgVGhyZWFkLnNsZWVwKDIgKiBiYXNlQ29uZi5nZXRGbHVz\naEludGVydmFsKCkpOwoKICAgICAgICAvLyByZXN0YXJ0IGJvb2tpZXMKICAg\nICAgICByZXN0YXJ0Qm9va2llcygpOwoKICAgICAgICBudW1Nc2dzICs9IDM7\nCiAgICAgICAgRW51bWVyYXRpb248TGVkZ2VyRW50cnk+IHNlcSA9IGxoMi5y\nZWFkRW50cmllcygwLCBudW1Nc2dzIC0gMSk7CiAgICAgICAgYXNzZXJ0VHJ1\nZSgiRW51bWVyYXRpb24gb2YgbGVkZ2VyIGVudHJpZXMgaGFzIG5vIGVsZW1l\nbnQiLCBzZXEuaGFzTW9yZUVsZW1lbnRzKCkgPT0gdHJ1ZSk7CiAgICAgICAg\naW50IGVudHJ5SWQgPSAwOwogICAgICAgIHdoaWxlIChzZXEuaGFzTW9yZUVs\nZW1lbnRzKCkpIHsKICAgICAgICAgICAgTGVkZ2VyRW50cnkgZSA9IHNlcS5u\nZXh0RWxlbWVudCgpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoZW50cnlJ\nZCwgZS5nZXRFbnRyeUlkKCkpOwoKICAgICAgICAgICAgQXNzZXJ0LmFzc2Vy\ndEFycmF5RXF1YWxzKGR1bW15TXNnLmdldEJ5dGVzKCksIGUuZ2V0RW50cnko\nKSk7CiAgICAgICAgICAgICsrZW50cnlJZDsKICAgICAgICB9CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKGVudHJ5SWQsIG51bU1zZ3MpOwogICAgfQp9Cg==\n","encoding":"base64"}

