{"sha":"eef56b07f0f735e0a094e80523aae2778ba29130","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWVmNTZiMDdmMGY3MzVlMGEwOTRlODA1MjNhYWUyNzc4YmEyOTEzMA==","size":9794,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/eef56b07f0f735e0a094e80523aae2778ba29130","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgaHR0cDovL3d3dy5hcGFj\naGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1\naXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGlu\nZywgc29mdHdhcmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2Ug\naXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9V\nVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhl\nciBleHByZXNzIG9yIGltcGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3Ig\ndGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQKICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7CgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmlvLkJ5dGVCdWZmZXI7\nCmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1\ncnJlbnQuQ291bnREb3duTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5UaW1lVW5pdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0\nb21pYy5BdG9taWNJbnRlZ2VyOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5ib29raWUuQm9va2llOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmJvb2tpZS5Cb29raWVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVw\nZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nb25mLkNsaWVudENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLm5ldC5Cb29raWVTb2NrZXRBZGRyZXNzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJ\nbnRlcm5hbENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2Fs\nbGJhY2tzLldyaXRlQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIudGVzdC5Cb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlOwppbXBvcnQg\nb3JnLmp1bml0LlRlc3Q7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgc3RhdGljIG9y\nZy5qdW5pdC5Bc3NlcnQuKjsKCi8qKgogKiBUaGlzIGNsYXNzIHRlc3RzIHRo\nZSBsZWRnZXIgY2xvc2UgbG9naWMuCiAqLwpAU3VwcHJlc3NXYXJuaW5ncygi\nZGVwcmVjYXRpb24iKQpwdWJsaWMgY2xhc3MgTGVkZ2VyQ2xvc2VUZXN0IGV4\ndGVuZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CgogICAgcHJpdmF0\nZSBmaW5hbCBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKExlZGdlckNsb3NlVGVzdC5jbGFzcyk7CgogICAgc3RhdGljIGZp\nbmFsIGludCBSRUFEX1RJTUVPVVQgPSAxOwoKICAgIGZpbmFsIERpZ2VzdFR5\ncGUgZGlnZXN0VHlwZTsKCiAgICBwdWJsaWMgTGVkZ2VyQ2xvc2VUZXN0KCkg\newogICAgICAgIHN1cGVyKDYpOwogICAgICAgIHRoaXMuZGlnZXN0VHlwZSA9\nIERpZ2VzdFR5cGUuQ1JDMzI7CiAgICAgICAgLy8gc2V0IHRpbWVvdXQgdG8g\nYSBsYXJnZSB2YWx1ZSB3aGljaCBkaXNhYmxlIGl0LgogICAgICAgIGJhc2VD\nbGllbnRDb25mLnNldFJlYWRUaW1lb3V0KDk5OTk5KTsKICAgICAgICBiYXNl\nQ29uZi5zZXRHY1dhaXRUaW1lKDk5OTk5OSk7CiAgICB9CgogICAgQFRlc3Qo\ndGltZW91dCA9IDYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdExlZGdlckNs\nb3NlV2l0aENvbnNpc3RlbnRMZW5ndGgoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgQ2xpZW50\nQ29uZmlndXJhdGlvbigpOwogICAgICAgIGNvbmYuc2V0WmtTZXJ2ZXJzKHpr\nVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCkpLnNldFJlYWRUaW1l\nb3V0KDEpOwoKICAgICAgICBCb29rS2VlcGVyIGJrYyA9IG5ldyBCb29rS2Vl\ncGVyKGNvbmYpOwogICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5jcmVh\ndGVMZWRnZXIoNiwgMywgRGlnZXN0VHlwZS5DUkMzMiwgbmV3IGJ5dGVbXSB7\nfSk7CiAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggbGF0Y2ggPSBuZXcg\nQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgc3RvcEJLQ2x1c3RlcigpOwog\nICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIgaSA9IG5ldyBBdG9taWNJbnRl\nZ2VyKDB4ZGVhZGJlZWYpOwogICAgICAgIEFzeW5jQ2FsbGJhY2suQWRkQ2Fs\nbGJhY2sgY2IgPSBuZXcgQXN5bmNDYWxsYmFjay5BZGRDYWxsYmFjaygpIHsK\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIGFkZENvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBsb25nIGVu\ndHJ5SWQsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgIGkuc2V0KHJj\nKTsKICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigpOwogICAgICAg\nICAgICB9CiAgICAgICAgfTsKICAgICAgICBsaC5hc3luY0FkZEVudHJ5KCJU\nZXN0IEVudHJ5Ii5nZXRCeXRlcygpLCBjYiwgbnVsbCk7CiAgICAgICAgbGF0\nY2guYXdhaXQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoaS5nZXQoKSwgQktF\neGNlcHRpb24uQ29kZS5Ob3RFbm91Z2hCb29raWVzRXhjZXB0aW9uKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMCwgbGguZ2V0TGVuZ3RoKCkpOwogICAgICAg\nIGFzc2VydEVxdWFscyhMZWRnZXJIYW5kbGUuSU5WQUxJRF9FTlRSWV9JRCwg\nbGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpKTsKICAgICAgICBzdGFydEJLQ2x1\nc3RlcigpOwogICAgICAgIExlZGdlckhhbmRsZSBuZXdMaCA9IGJrYy5vcGVu\nTGVkZ2VyKGxoLmdldElkKCksIERpZ2VzdFR5cGUuQ1JDMzIsIG5ldyBieXRl\nW10ge30pOwogICAgICAgIGFzc2VydEVxdWFscygwLCBuZXdMaC5nZXRMZW5n\ndGgoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKExlZGdlckhhbmRsZS5JTlZB\nTElEX0VOVFJZX0lELCBuZXdMaC5nZXRMYXN0QWRkQ29uZmlybWVkKCkpOwog\nICAgfQoKICAgIEBUZXN0KHRpbWVvdXQgPSA2MDAwMCkKICAgIHB1YmxpYyB2\nb2lkIHRlc3RMZWRnZXJDbG9zZUR1cmluZ1VucmVjb3ZlcmFibGVFcnJvcnMo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbnVtRW50cmllcyA9\nIDM7CiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxlZGdl\ncigzLCAzLCAzLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKICAgICAg\nICB2ZXJpZnlNZXRhZGF0YUNvbnNpc3RlbmN5KG51bUVudHJpZXMsIGxoKTsK\nICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0ID0gNjAwMDApCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0TGVkZ2VyQ2hlY2tlclNob3VsZG5vdFNlbGVjdEludmFsaWRM\nYXN0RnJhZ21lbnRzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50\nIG51bUVudHJpZXMgPSAxMDsKICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBi\na2MuY3JlYXRlTGVkZ2VyKDMsIDMsIDMsIGRpZ2VzdFR5cGUsICIiLmdldEJ5\ndGVzKCkpOwogICAgICAgIC8vIEFkZCBzb21lIGVudHJpZXMgYmVmb3JlIGJv\nb2tpZSBmYWlsdXJlcwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVt\nRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGxoLmFkZEVudHJ5KCJkYXRh\nIi5nZXRCeXRlcygpKTsKICAgICAgICB9CiAgICAgICAgbnVtRW50cmllcyA9\nIDQ7IC8vIGFkZCBuKmVuc2VtbGVTaXplKzEgZW50cmllcyBhc3luYyBhZnRl\nciBib29raWVzCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhaWxlZC4K\nICAgICAgICB2ZXJpZnlNZXRhZGF0YUNvbnNpc3RlbmN5KG51bUVudHJpZXMs\nIGxoKTsKCiAgICAgICAgTGVkZ2VyQ2hlY2tlciBjaGVja2VyID0gbmV3IExl\nZGdlckNoZWNrZXIoYmtjKTsKICAgICAgICBDaGVja2VyQ2FsbGJhY2sgY2Ig\nPSBuZXcgQ2hlY2tlckNhbGxiYWNrKCk7CiAgICAgICAgY2hlY2tlci5jaGVj\na0xlZGdlcihsaCwgY2IpOwogICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4g\ncmVzdWx0ID0gY2Iud2FpdEFuZEdldFJlc3VsdCgpOwogICAgICAgIGFzc2Vy\ndEVxdWFscygiTm8gZnJhZ21lbnRzIHNob3VsZCBiZSBzZWxlY3RlZCIsIDAs\nIHJlc3VsdC5zaXplKCkpOwogICAgfQoKICAgIGNsYXNzIENoZWNrZXJDYWxs\nYmFjayBpbXBsZW1lbnRzIEdlbmVyaWNDYWxsYmFjazxTZXQ8TGVkZ2VyRnJh\nZ21lbnQ+PiB7CiAgICAgICAgcHJpdmF0ZSBTZXQ8TGVkZ2VyRnJhZ21lbnQ+\nIHJlc3VsdCA9IG51bGw7CiAgICAgICAgcHJpdmF0ZSBDb3VudERvd25MYXRj\naCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBTZXQ8TGVkZ2Vy\nRnJhZ21lbnQ+IHJlc3VsdCkgewogICAgICAgICAgICB0aGlzLnJlc3VsdCA9\nIHJlc3VsdDsKICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAgICAg\nICAgfQoKICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHdhaXRBbmRHZXRS\nZXN1bHQoKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAg\nICAgICBsYXRjaC5hd2FpdCgpOwogICAgICAgICAgICByZXR1cm4gcmVzdWx0\nOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgdmVyaWZ5TWV0\nYWRhdGFDb25zaXN0ZW5jeShpbnQgbnVtRW50cmllcywgTGVkZ2VySGFuZGxl\nIGxoKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBm\naW5hbCBDb3VudERvd25MYXRjaCBhZGREb25lTGF0Y2ggPSBuZXcgQ291bnRE\nb3duTGF0Y2goMSk7CiAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggZGVh\nZElPTGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgZmlu\nYWwgQ291bnREb3duTGF0Y2ggcmVjb3ZlckRvbmVMYXRjaCA9IG5ldyBDb3Vu\ndERvd25MYXRjaCgxKTsKICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBm\nYWlsZWRMYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICAv\nLyBraWxsIGZpcnN0IGJvb2tpZSB0byByZXBsYWNlIHdpdGggYSB1bmF1dGhv\ncml6ZSBib29raWUKICAgICAgICBCb29raWVTb2NrZXRBZGRyZXNzIGJvb2tp\nZSA9IGxoLmdldExlZGdlck1ldGFkYXRhKCkuY3VycmVudEVuc2VtYmxlLmdl\ndCgwKTsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBraWxs\nQm9va2llKGJvb2tpZSk7CiAgICAgICAgLy8gcmVwbGFjZSBhIHVuYXV0aG9y\naXplIGJvb2tpZQogICAgICAgIHN0YXJ0VW5hdXRob3JpemVkQm9va2llKGNv\nbmYsIGFkZERvbmVMYXRjaCk7CiAgICAgICAgLy8ga2lsbCBzZWNvbmQgYm9v\na2llIHRvIHJlcGxhY2Ugd2l0aCBhIGRlYWQgYm9va2llCiAgICAgICAgYm9v\na2llID0gbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKS5jdXJyZW50RW5zZW1ibGUu\nZ2V0KDEpOwogICAgICAgIGNvbmYgPSBraWxsQm9va2llKGJvb2tpZSk7CiAg\nICAgICAgLy8gcmVwbGFjZSBhIHNsb3cgZGVhZCBib29raWUKICAgICAgICBz\ndGFydERlYWRCb29raWUoY29uZiwgZGVhZElPTGF0Y2gpOwoKICAgICAgICAv\nLyB0cmllZCB0byBhZGQgZW50cmllcwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbnVtRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGxoLmFzeW5j\nQWRkRW50cnkoImRhdGEiLmdldEJ5dGVzKCksIG5ldyBBZGRDYWxsYmFjaygp\nIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgYWRkQ29tcGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUg\nbGgsIGxvbmcgZW50cnlJZCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAg\nICAgICAgIGlmIChCS0V4Y2VwdGlvbi5Db2RlLk9LICE9IHJjKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGZhaWxlZExhdGNoLmNvdW50RG93bigpOwog\nICAgICAgICAgICAgICAgICAgICAgICBkZWFkSU9MYXRjaC5jb3VudERvd24o\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\naWYgKDAgPT0gZW50cnlJZCkgewogICAgICAgICAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3ZlckRvbmVM\nYXRjaC5hd2FpdCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNo\nIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9LCBudWxsKTsKICAgICAgICB9CiAgICAgICAg\nLy8gYWRkIGZpbmlzaGVkCiAgICAgICAgYWRkRG9uZUxhdGNoLmNvdW50RG93\nbigpOwogICAgICAgIC8vIHdhaXQgdW50aWwgZW50cmllcyBmYWlsZWQgZHVl\nIHRvIFVuYXV0aG9yaXplZEFjY2Vzc0V4Y2VwdGlvbgogICAgICAgIGZhaWxl\nZExhdGNoLmF3YWl0KCk7CiAgICAgICAgLy8gc2ltdWxhdGUgdGhlIG93bmVy\nc2hpcCBvZiB0aGlzIGxlZGdlciBpcyB0cmFuc2ZlciB0byBhbm90aGVyIGhv\nc3QgKHdoaWNoIGlzIGFjdHVhbGx5CiAgICAgICAgLy8gd2hhdCB3ZSBkaWQg\naW4gSGVkd2lnKS4KICAgICAgICBMT0cuaW5mbygiUmVjb3ZlciBsZWRnZXIg\ne30uIiwgbGguZ2V0SWQoKSk7CiAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlv\nbiBuZXdDb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAgICAg\nICBuZXdDb25mLmFkZENvbmZpZ3VyYXRpb24oYmFzZUNsaWVudENvbmYpOwog\nICAgICAgIEJvb2tLZWVwZXIgbmV3QmtjID0gbmV3IEJvb2tLZWVwZXJUZXN0\nQ2xpZW50KG5ld0NvbmYuc2V0UmVhZFRpbWVvdXQoMSkpOwogICAgICAgIExl\nZGdlckhhbmRsZSByZWNvdmVyZWRMaCA9IG5ld0JrYy5vcGVuTGVkZ2VyKGxo\nLmdldElkKCksIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAg\nIExPRy5pbmZvKCJSZWNvdmVyIGxlZGdlciB7fSBkb25lLiIsIGxoLmdldElk\nKCkpOwogICAgICAgIHJlY292ZXJEb25lTGF0Y2guY291bnREb3duKCk7CiAg\nICAgICAgLy8gd2FpdCBhIGJpdCB1bnRpbCBhZGQgb3BlcmF0aW9ucyBmYWls\nZWQgZnJvbSBzZWNvbmQgYm9va2llIGR1ZSB0byBJT0V4Y2VwdGlvbgogICAg\nICAgIFRpbWVVbml0LlNFQ09ORFMuc2xlZXAoNSk7CiAgICAgICAgLy8gb3Bl\nbiB0aGUgbGVkZ2VyIGFnYWluIHRvIG1ha2Ugc3VyZSB3ZSBnZSB0aGUgcmln\naHQgbGFzdCBjb25maXJtZWQuCiAgICAgICAgTGVkZ2VySGFuZGxlIG5ld0xo\nID0gbmV3QmtjLm9wZW5MZWRnZXIobGguZ2V0SWQoKSwgZGlnZXN0VHlwZSwg\nIiIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJNZXRhZGF0\nYSBzaG91bGQgYmUgY29uc2lzdGVudCBhY3Jvc3MgZGlmZmVyZW50IG9wZW5l\nZCBsZWRnZXJzIiwKICAgICAgICAgICAgICAgIHJlY292ZXJlZExoLmdldExh\nc3RBZGRDb25maXJtZWQoKSwgbmV3TGguZ2V0TGFzdEFkZENvbmZpcm1lZCgp\nKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgc3RhcnRVbmF1dGhvcml6ZWRC\nb29raWUoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLCBmaW5hbCBDb3VudERv\nd25MYXRjaCBsYXRjaCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgQm9va2llIHNCb29raWUgPSBuZXcgQm9va2llKGNvbmYpIHsK\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIGFkZEVudHJ5KEJ5dGVCdWZmZXIgZW50cnksIFdyaXRlQ2FsbGJhY2sgY2Is\nIE9iamVjdCBjdHgsIGJ5dGVbXSBtYXN0ZXJLZXkpCiAgICAgICAgICAgICAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBCb29raWVFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBsYXRj\naC5hd2FpdCgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0\nZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgdGhyb3cgQm9va2llRXhjZXB0aW9uLmNyZWF0ZShCb29raWVFeGNl\ncHRpb24uQ29kZS5VbmF1dGhvcml6ZWRBY2Nlc3NFeGNlcHRpb24pOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\ncHVibGljIHZvaWQgcmVjb3ZlcnlBZGRFbnRyeShCeXRlQnVmZmVyIGVudHJ5\nLCBXcml0ZUNhbGxiYWNrIGNiLCBPYmplY3QgY3R4LCBieXRlW10gbWFzdGVy\nS2V5KQogICAgICAgICAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwg\nQm9va2llRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbigiRGVhZCBib29raWUgZm9yIHJlY292ZXJ5IGFkZHMuIik7\nCiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGJzQ29uZnMuYWRk\nKGNvbmYpOwogICAgICAgIGJzLmFkZChzdGFydEJvb2tpZShjb25mLCBzQm9v\na2llKSk7CiAgICB9CgogICAgLy8gc2ltdWxhdGUgc2xvdyBhZGRzLCB0aGVu\nIGJlY29tZSBub3JtYWwgd2hlbiByZWNvdmVyLAogICAgLy8gc28gbm8gZW5z\nZW1ibGUgY2hhbmdlIHdoZW4gcmVjb3ZlcmluZyBsZWRnZXIgb24gdGhpcyBi\nb29raWUuCiAgICBwcml2YXRlIHZvaWQgc3RhcnREZWFkQm9va2llKFNlcnZl\nckNvbmZpZ3VyYXRpb24gY29uZiwgZmluYWwgQ291bnREb3duTGF0Y2ggbGF0\nY2gpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZSBkQm9va2ll\nID0gbmV3IEJvb2tpZShjb25mKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRFbnRyeShCeXRlQnVmZmVyIGVu\ndHJ5LCBXcml0ZUNhbGxiYWNrIGNiLCBPYmplY3QgY3R4LCBieXRlW10gbWFz\ndGVyS2V5KQogICAgICAgICAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlv\nbiwgQm9va2llRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgbGF0Y2guYXdhaXQoKTsKICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIHNpbXVsYXRlIHNsb3cg\nYWRkcy4KICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigi\nRGVhZCBib29raWUiKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAg\nICAgYnNDb25mcy5hZGQoY29uZik7CiAgICAgICAgYnMuYWRkKHN0YXJ0Qm9v\na2llKGNvbmYsIGRCb29raWUpKTsKICAgIH0KfQo=\n","encoding":"base64"}

