{"sha":"eb61c2120790af7058997dfcd9942240b6a1d039","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWI2MWMyMTIwNzkwYWY3MDU4OTk3ZGZjZDk5NDIyNDBiNmExZDAzOQ==","size":18435,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/eb61c2120790af7058997dfcd9942240b6a1d039","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5T\nZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRj\naDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubmV0LkJvb2tpZVNv\nY2tldEFkZHJlc3M7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJv\ndG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWNDYWxsYmFj\nazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVw\nZXJDbHVzdGVyVGVzdENhc2U7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKaW1w\nb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2Vy\nRmFjdG9yeTsKCmltcG9ydCBzdGF0aWMgb3JnLmp1bml0LkFzc2VydC4qOwoK\nLyoqCiAqIFRlc3RzIHRoZSBmdW5jdGlvbmFsaXR5IG9mIExlZGdlckNoZWNr\nZXIuIFRoaXMgTGVkZ2VyIGNoZWNrZXIgc2hvdWxkIGJlIGFibGUKICogdG8g\nZGV0ZWN0IHRoZSBjb3JyZWN0IHVuZGVyUmVwbGljYXRlZCBmcmFnbWVudAog\nKi8KcHVibGljIGNsYXNzIFRlc3RMZWRnZXJDaGVja2VyIGV4dGVuZHMgQm9v\na0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBieXRlW10gVEVTVF9MRURHRVJfRU5UUllfREFUQSA9ICJUZXN0Q2hl\nY2tlckRhdGEiCiAgICAgICAgICAgIC5nZXRCeXRlcygpOwogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgYnl0ZVtdIFRFU1RfTEVER0VSX1BBU1NXT1JEID0g\nInRlc3RwYXNzd2QiLmdldEJ5dGVzKCk7CiAgICBwcml2YXRlIGZpbmFsIHN0\nYXRpYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoVGVz\ndExlZGdlckNoZWNrZXIuY2xhc3MpOwoKICAgIHB1YmxpYyBUZXN0TGVkZ2Vy\nQ2hlY2tlcigpIHsKICAgICAgICBzdXBlcigzKTsKICAgIH0KCiAgICBjbGFz\ncyBDaGVja2VyQ2FsbGJhY2sgaW1wbGVtZW50cyBHZW5lcmljQ2FsbGJhY2s8\nU2V0PExlZGdlckZyYWdtZW50Pj4gewogICAgICAgIHByaXZhdGUgU2V0PExl\nZGdlckZyYWdtZW50PiByZXN1bHQgPSBudWxsOwogICAgICAgIHByaXZhdGUg\nQ291bnREb3duTGF0Y2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7\nCgogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBsZXRlKGludCBy\nYywgU2V0PExlZGdlckZyYWdtZW50PiByZXN1bHQpIHsKICAgICAgICAgICAg\ndGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgICAgIGxhdGNoLmNvdW50\nRG93bigpOwogICAgICAgIH0KCiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50\nPiB3YWl0QW5kR2V0UmVzdWx0KCkgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0\naW9uIHsKICAgICAgICAgICAgbGF0Y2guYXdhaXQoKTsKICAgICAgICAgICAg\ncmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUZXN0cyB0aGF0IHRoZSBMZWRnZXJDaGVja2VyIHNob3VsZCBkZXRlY3Qg\ndGhlIHVuZGVyUmVwbGljYXRlZCBmcmFnbWVudHMKICAgICAqIG9uIG11bHRp\ncGxlIEJvb2tpZSBjcmFzaGVzCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9\nNjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2hlY2tlcigpIHRocm93cyBF\neGNlcHRpb24gewoKICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3Jl\nYXRlTGVkZ2VyKEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAg\nICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsKICAgICAgICBzdGFy\ndE5ld0Jvb2tpZSgpOwoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEw\nOyBpKyspIHsKICAgICAgICAgICAgbGguYWRkRW50cnkoVEVTVF9MRURHRVJf\nRU5UUllfREFUQSk7CiAgICAgICAgfQogICAgICAgIEJvb2tpZVNvY2tldEFk\nZHJlc3MgcmVwbGljYVRvS2lsbCA9IGxoLmdldExlZGdlck1ldGFkYXRhKCku\nZ2V0RW5zZW1ibGVzKCkKICAgICAgICAgICAgICAgIC5nZXQoMEwpLmdldCgw\nKTsKICAgICAgICBMT0cuaW5mbygiS2lsbGluZyB7fSIsIHJlcGxpY2FUb0tp\nbGwpOwogICAgICAgIGtpbGxCb29raWUocmVwbGljYVRvS2lsbCk7CgogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgICAgICAg\nICBsaC5hZGRFbnRyeShURVNUX0xFREdFUl9FTlRSWV9EQVRBKTsKICAgICAg\nICB9CgogICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4gcmVzdWx0ID0gZ2V0\nVW5kZXJSZXBsaWNhdGVkRnJhZ21lbnRzKGxoKTsKICAgICAgICBhc3NlcnRO\nb3ROdWxsKCJSZXN1bHQgc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQpOwog\nICAgICAgIGZvciAoTGVkZ2VyRnJhZ21lbnQgciA6IHJlc3VsdCkgewogICAg\nICAgICAgICBMT0cuaW5mbygidW5yZXBsaWNhdGVkIGZyYWdtZW50OiB7fSIs\nIHIpOwogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBo\nYXZlIG9uZSBtaXNzaW5nIGZyYWdtZW50IiwgMSwgcmVzdWx0LnNpemUoKSk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJGcmFnbWVudCBzaG91bGQgYmUgbWlz\nc2luZyBmcm9tIGZpcnN0IHJlcGxpY2EiLCByZXN1bHQKICAgICAgICAgICAg\nICAgIC5pdGVyYXRvcigpLm5leHQoKS5nZXRBZGRyZXNzKCksIHJlcGxpY2FU\nb0tpbGwpOwoKICAgICAgICBCb29raWVTb2NrZXRBZGRyZXNzIHJlcGxpY2FU\nb0tpbGwyID0gbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKQogICAgICAgICAgICAg\nICAgLmdldEVuc2VtYmxlcygpLmdldCgwTCkuZ2V0KDEpOwogICAgICAgIExP\nRy5pbmZvKCJLaWxsaW5nIHt9IiwgcmVwbGljYVRvS2lsbDIpOwogICAgICAg\nIGtpbGxCb29raWUocmVwbGljYVRvS2lsbDIpOwoKICAgICAgICByZXN1bHQg\nPSBnZXRVbmRlclJlcGxpY2F0ZWRGcmFnbWVudHMobGgpOwogICAgICAgIGFz\nc2VydE5vdE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVsbCIsIHJlc3Vs\ndCk7CiAgICAgICAgZm9yIChMZWRnZXJGcmFnbWVudCByIDogcmVzdWx0KSB7\nCiAgICAgICAgICAgIExPRy5pbmZvKCJ1bnJlcGxpY2F0ZWQgZnJhZ21lbnQ6\nIHt9Iiwgcik7CiAgICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscygiU2hv\ndWxkIGhhdmUgdGhyZWUgbWlzc2luZyBmcmFnbWVudHMiLCAzLCByZXN1bHQu\nc2l6ZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3RzIHRoYXQgbGVk\nZ2VyIGNoZWNrZXIgc2hvdWxkIHBpY2sgdGhlIGZyYWdtZW50IGFzIGJhZCBv\nbmx5IGlmIGFueSBvZgogICAgICogdGhlIGZyYWdtZW50IGVudHJpZXMgbm90\nIG1lZXRpbmcgdGhlIHF1b3J1bS4KICAgICAqLwogICAgLy8gLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8K\nICAgIC8vIC8vLy8vLy8vL0Vuc2VtYmxlID0gMywgUXVvcnVtID0gMiAvLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyAvU2FtcGxlIExlZGdlciBtZXRhIGRh\ndGEgc2hvdWxkIGxvb2sgbGlrZS8vLy8vLy8vLy8vLwogICAgLy8gLzAgYSBi\nIGMgLy8vLy8qZW50cnkgcHJlc2VudCBpbiBhLGIuIE5vdyBraWxsIGMvLy8v\nLy8KICAgIC8vIC8xIGEgYiBkIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyAvSGVyZSBldmVuIHRob3VnaCBv\nbmUgQksgZmFpbGVkIGF0IHRoaXMgc3RhZ2UsIC8vLy8vLwogICAgLy8gL3dl\nIGRvbid0IGhhdmUgYW55IG1pc3NlZCBlbnRyaWVzLiBRdW9ydW0gc2F0aXNm\naWVkLy8KICAgIC8vIC9TbywgdGhlcmUgc2hvdWxkIG5vdCBiZSBhbnkgbWlz\nc2luZyByZXBsaWNhcy4vLy8vLy8vCiAgICAvLyAvLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgQFRl\nc3QodGltZW91dCA9IDMwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2hvdWxk\nTm90R2V0VGhlRnJhZ21lbnRJZlRoZXJlSXNOb01pc3NlZEVudHJ5KCkKICAg\nICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CgogICAgICAgIExlZGdlckhh\nbmRsZSBsaCA9IGJrYy5jcmVhdGVMZWRnZXIoMywgMiwgQm9va0tlZXBlci5E\naWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAgVEVTVF9MRURHRVJf\nUEFTU1dPUkQpOwogICAgICAgIGxoLmFkZEVudHJ5KFRFU1RfTEVER0VSX0VO\nVFJZX0RBVEEpOwoKICAgICAgICAvLyBFbnRyeSBzaG91bGQgaGF2ZSBhZGRl\nZCBpbiBmaXJzdCAyIEJvb2tpZXMuCgogICAgICAgIC8vIEtpbGwgdGhlIDNy\nZCBCSyBmcm9tIGVuc2VtYmxlLgogICAgICAgIEFycmF5TGlzdDxCb29raWVT\nb2NrZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0gbGguZ2V0TGVkZ2VyTWV0\nYWRhdGEoKQogICAgICAgICAgICAgICAgLmdldEVuc2VtYmxlcygpLmdldCgw\nTCk7CiAgICAgICAgQm9va2llU29ja2V0QWRkcmVzcyBsYXN0Qm9va2llRnJv\nbUVuc2VtYmxlID0gZmlyc3RFbnNlbWJsZS5nZXQoMik7CiAgICAgICAgTE9H\nLmluZm8oIktpbGxpbmcgIiArIGxhc3RCb29raWVGcm9tRW5zZW1ibGUgKyAi\nIGZyb20gZW5zZW1ibGU9IgogICAgICAgICAgICAgICAgKyBmaXJzdEVuc2Vt\nYmxlKTsKICAgICAgICBraWxsQm9va2llKGxhc3RCb29raWVGcm9tRW5zZW1i\nbGUpOwoKICAgICAgICBzdGFydE5ld0Jvb2tpZSgpOwoKICAgICAgICBMT0cu\naW5mbygiRW5zZW1ibGVzIGFmdGVyIGZpcnN0IGVudHJ5IDoiCiAgICAgICAg\nICAgICAgICArIGxoLmdldExlZGdlck1ldGFkYXRhKCkuZ2V0RW5zZW1ibGVz\nKCkpOwoKICAgICAgICAvLyBBZGRpbmcgb25lIG1vcmUgZW50cnkuIEhlcmUg\nZW5zZWJsZSBzaG91bGQgYmUgcmVmb3JtZWQuCiAgICAgICAgbGguYWRkRW50\ncnkoVEVTVF9MRURHRVJfRU5UUllfREFUQSk7CgogICAgICAgIExPRy5pbmZv\nKCJFbnNlbWJsZXMgYWZ0ZXIgc2Vjb25kIGVudHJ5IDoiCiAgICAgICAgICAg\nICAgICArIGxoLmdldExlZGdlck1ldGFkYXRhKCkuZ2V0RW5zZW1ibGVzKCkp\nOwoKICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVu\nZGVyUmVwbGljYXRlZEZyYWdtZW50cyhsaCk7CgogICAgICAgIGFzc2VydE5v\ndE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7Cgog\nICAgICAgIGZvciAoTGVkZ2VyRnJhZ21lbnQgciA6IHJlc3VsdCkgewogICAg\nICAgICAgICBMT0cuaW5mbygidW5yZXBsaWNhdGVkIGZyYWdtZW50OiB7fSIs\nIHIpOwogICAgICAgIH0KCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJTaG91bGQg\nbm90IGhhdmUgYW55IG1pc3NpbmcgZnJhZ21lbnQiLCAwLCByZXN1bHQuc2l6\nZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3RzIHRoYXQgTGVkZ2Vy\nQ2hlY2tlciBzaG91bGQgZ2l2ZSB0d28gZnJhZ21lbnRzIHdoZW4gMiBib29r\naWVzIGZhaWxlZAogICAgICogaW4gc2FtZSBlbnNlbWJsZSB3aGVuIGVuc2Vt\nYmxlID0gMywgcXVvcnVtID0gMgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0\nID0gMzAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTaG91bGRHZXRUd29Gcmdh\nbWVudHNJZlR3b0Jvb2tpZXNGYWlsZWRJblNhbWVFbnNlbWJsZSgpCiAgICAg\nICAgICAgIHRocm93cyBFeGNlcHRpb24gewoKICAgICAgICBMZWRnZXJIYW5k\nbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDIsIEJvb2tLZWVwZXIuRGln\nZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BB\nU1NXT1JEKTsKICAgICAgICBzdGFydE5ld0Jvb2tpZSgpOwogICAgICAgIHN0\nYXJ0TmV3Qm9va2llKCk7CiAgICAgICAgbGguYWRkRW50cnkoVEVTVF9MRURH\nRVJfRU5UUllfREFUQSk7CgogICAgICAgIEFycmF5TGlzdDxCb29raWVTb2Nr\nZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0gbGguZ2V0TGVkZ2VyTWV0YWRh\ndGEoKQogICAgICAgICAgICAgICAgLmdldEVuc2VtYmxlcygpLmdldCgwTCk7\nCgogICAgICAgIEJvb2tpZVNvY2tldEFkZHJlc3MgZmlyc3RCb29raWVGcm9t\nRW5zZW1ibGUgPSBmaXJzdEVuc2VtYmxlLmdldCgwKTsKICAgICAgICBraWxs\nQm9va2llKGZpcnN0RW5zZW1ibGUsIGZpcnN0Qm9va2llRnJvbUVuc2VtYmxl\nKTsKCiAgICAgICAgQm9va2llU29ja2V0QWRkcmVzcyBzZWNvbmRCb29raWVG\ncm9tRW5zZW1ibGUgPSBmaXJzdEVuc2VtYmxlLmdldCgxKTsKICAgICAgICBr\naWxsQm9va2llKGZpcnN0RW5zZW1ibGUsIHNlY29uZEJvb2tpZUZyb21FbnNl\nbWJsZSk7CiAgICAgICAgbGguYWRkRW50cnkoVEVTVF9MRURHRVJfRU5UUllf\nREFUQSk7CiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50PiByZXN1bHQgPSBn\nZXRVbmRlclJlcGxpY2F0ZWRGcmFnbWVudHMobGgpOwoKICAgICAgICBhc3Nl\ncnROb3ROdWxsKCJSZXN1bHQgc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQp\nOwoKICAgICAgICBmb3IgKExlZGdlckZyYWdtZW50IHIgOiByZXN1bHQpIHsK\nICAgICAgICAgICAgTE9HLmluZm8oInVucmVwbGljYXRlZCBmcmFnbWVudDog\ne30iLCByKTsKICAgICAgICB9CgogICAgICAgIGFzc2VydEVxdWFscygiVGhl\ncmUgc2hvdWxkIGJlIDIgZnJhZ21lbnRzIiwgMiwgcmVzdWx0LnNpemUoKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyB0aGF0IExlZGdlckNoZWNr\nZXIgc2hvdWxkIG5vdCBnZXQgYW55IHVuZGVyUmVwbGljYXRlZCBmcmFnbWVu\ndHMsIGlmCiAgICAgKiBjb3JyZXNwb25kaW5nIGxlZGdlciBkb2VzIG5vdCBl\neGlzdHMuCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQgPSAzMDAwKQogICAg\ncHVibGljIHZvaWQgdGVzdFNob3VsZE5vdEdldEFueUZyYWdtZW50SWZOb0xl\nZGdlclByZXNlbnQoKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nCiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxlZGdlcigz\nLCAyLCBCb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JDMzIsCiAgICAgICAgICAg\nICAgICBURVNUX0xFREdFUl9QQVNTV09SRCk7CgogICAgICAgIEFycmF5TGlz\ndDxCb29raWVTb2NrZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0gbGguZ2V0\nTGVkZ2VyTWV0YWRhdGEoKQogICAgICAgICAgICAgICAgLmdldEVuc2VtYmxl\ncygpLmdldCgwTCk7CiAgICAgICAgQm9va2llU29ja2V0QWRkcmVzcyBmaXJz\ndEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0KDApOwog\nICAgICAgIGtpbGxCb29raWUoZmlyc3RCb29raWVGcm9tRW5zZW1ibGUpOwog\nICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CiAgICAgICAgbGguYWRkRW50cnko\nVEVTVF9MRURHRVJfRU5UUllfREFUQSk7CiAgICAgICAgYmtjLmRlbGV0ZUxl\nZGdlcihsaC5nZXRJZCgpKTsKCiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50\nPiByZXN1bHQgPSBnZXRVbmRlclJlcGxpY2F0ZWRGcmFnbWVudHMobGgpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVs\nbCIsIHJlc3VsdCk7CgogICAgICAgIGFzc2VydEVxdWFscygiVGhlcmUgc2hv\ndWxkIGJlIDAgZnJhZ21lbnRzLiBCdXQgcmV0dXJuZWQgZnJhZ21lbnRzIGFy\nZSAiCiAgICAgICAgICAgICAgICArIHJlc3VsdCwgMCwgcmVzdWx0LnNpemUo\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyB0aGF0IExlZGdlckNo\nZWNrZXIgc2hvdWxkIGdldCBmYWlsZWQgZW5zZW1ibGUgbnVtYmVyIG9mIGZy\nYWdtZW50cwogICAgICogaWYgZW5zZW1ibGUgYm9va2llIGZhaWx1cmVzIG9u\nIG5leHQgZW50cnkKICAgICAqLwogICAgQFRlc3QodGltZW91dCA9IDMwMDAp\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2hvdWxkR2V0RmFpbGVkRW5zZW1ibGVO\ndW1iZXJPZkZnbW50c0lmRW5zZW1ibGVCb29raWVzRmFpbGVkT25OZXh0V3Jp\ndGUoKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKCiAgICAgICAg\nc3RhcnROZXdCb29raWUoKTsKICAgICAgICBzdGFydE5ld0Jvb2tpZSgpOwog\nICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5jcmVhdGVMZWRnZXIoMywg\nMiwgQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAg\nICAgVEVTVF9MRURHRVJfUEFTU1dPUkQpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgICAgIGxoLmFkZEVudHJ5KFRF\nU1RfTEVER0VSX0VOVFJZX0RBVEEpOwogICAgICAgIH0KCiAgICAgICAgLy8g\nS2lsbCBhbGwgdGhyZWUgYm9va2llcwogICAgICAgIEFycmF5TGlzdDxCb29r\naWVTb2NrZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0gbGguZ2V0TGVkZ2Vy\nTWV0YWRhdGEoKQogICAgICAgICAgICAgICAgLmdldEVuc2VtYmxlcygpLmdl\ndCgwTCk7CiAgICAgICAgZm9yIChCb29raWVTb2NrZXRBZGRyZXNzIGJrQWRk\nciA6IGZpcnN0RW5zZW1ibGUpIHsKICAgICAgICAgICAga2lsbEJvb2tpZShm\naXJzdEVuc2VtYmxlLCBia0FkZHIpOwogICAgICAgIH0KCiAgICAgICAgU2V0\nPExlZGdlckZyYWdtZW50PiByZXN1bHQgPSBnZXRVbmRlclJlcGxpY2F0ZWRG\ncmFnbWVudHMobGgpOwoKICAgICAgICBhc3NlcnROb3ROdWxsKCJSZXN1bHQg\nc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQpOwoKICAgICAgICBmb3IgKExl\nZGdlckZyYWdtZW50IHIgOiByZXN1bHQpIHsKICAgICAgICAgICAgTE9HLmlu\nZm8oInVucmVwbGljYXRlZCBmcmFnbWVudDoge30iLCByKTsKICAgICAgICB9\nCgogICAgICAgIGFzc2VydEVxdWFscygiVGhlcmUgc2hvdWxkIGJlIDMgZnJh\nZ21lbnRzIiwgMywgcmVzdWx0LnNpemUoKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUZXN0cyB0aGF0IExlZGdlckNoZWNrZXIgc2hvdWxkIG5vdCBnZXQg\nYW55IGZyYWdtZW50cyBhcyB1bmRlclJlcGxpY2F0ZWQKICAgICAqIGlmIExl\nZGdlciBpdHNlbGYgaXMgZW1wdHkKICAgICAqLwogICAgQFRlc3QodGltZW91\ndCA9IDMwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2hvdWxkTm90R2V0QW55\nRnJhZ21lbnRXaXRoRW1wdHlMZWRnZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMs\nIDIsIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAg\nICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsKICAgICAgICBTZXQ8TGVkZ2Vy\nRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZyYWdtZW50\ncyhsaCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiUmVzdWx0IHNob3VsZG4n\ndCBiZSBudWxsIiwgcmVzdWx0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlRo\nZXJlIHNob3VsZCBiZSAwIGZyYWdtZW50cy4gQnV0IHJldHVybmVkIGZyYWdt\nZW50cyBhcmUgIgogICAgICAgICAgICAgICAgKyByZXN1bHQsIDAsIHJlc3Vs\ndC5zaXplKCkpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdHMgdGhhdCBM\nZWRnZXJDaGVja2VyIHNob3VsZCBnZXQgYWxsIGZyYWdtZW50cyBpZiBsZWRn\nZXIgaXMgZW1wdHkKICAgICAqIGJ1dCBhbGwgYm9va2llcyBpbiB0aGUgZW5z\nZW1ibGUgYXJlIGRvd24uCiAgICAgKiBJbiB0aGlzIGNhc2UsIHRoZXJlJ3Mg\nbm8gd2F5IHRvIHRlbGwgd2hldGhlciBkYXRhIHdhcyB3cml0dGVuIG9yIG5v\ndC4KICAgICAqIEluIHRoaXMgY2FzZSwgdGhlcmUnbGwgb25seSBiZSB0d28g\nZnJhZ21lbnRzLCBhcyBxdW9ydW0gaXMgMiBhbmQgd2Ugb25seQogICAgICog\nc3VzcGVjdCB0aGF0IHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUgbGVkZ2VyIGNv\ndWxkIGV4aXN0LgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0ID0gMzAwMCkK\nICAgIHB1YmxpYyB2b2lkIHRlc3RTaG91bGRHZXQyRnJhZ21lbnRzV2l0aEVt\ncHR5TGVkZ2VyQnV0Qm9va2llc0RlYWQoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMs\nIDIsIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAg\nICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsKICAgICAgICBmb3IgKEJvb2tp\nZVNvY2tldEFkZHJlc3MgYiA6IGxoLmdldExlZGdlck1ldGFkYXRhKCkuZ2V0\nRW5zZW1ibGVzKCkuZ2V0KDBMKSkgewogICAgICAgICAgICBraWxsQm9va2ll\nKGIpOwogICAgICAgIH0KICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJl\nc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZyYWdtZW50cyhsaCk7CiAgICAg\nICAgYXNzZXJ0Tm90TnVsbCgiUmVzdWx0IHNob3VsZG4ndCBiZSBudWxsIiwg\ncmVzdWx0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlRoZXJlIHNob3VsZCBi\nZSAyIGZyYWdtZW50cy4iLCAyLCByZXN1bHQuc2l6ZSgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRlc3RzIHRoYXQgTGVkZ2VyQ2hlY2tlciBzaG91bGQg\nb25lIGZyYWdtZW50IGFzIHVuZGVyUmVwbGljYXRlZAogICAgICogaWYgdGhl\ncmUgaXMgYW4gb3BlbiBsZWRnZXIgd2l0aCBzaW5nbGUgZW50cnkgd3JpdHRl\nbi4KICAgICAqLwogICAgQFRlc3QodGltZW91dCA9IDMwMDApCiAgICBwdWJs\naWMgdm9pZCB0ZXN0U2hvdWxkR2V0T25lRnJhZ21lbnRXaXRoU2luZ2xlRW50\ncnlPcGVuZWRMZWRnZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBM\nZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDMsIEJvb2tL\nZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1Rf\nTEVER0VSX1BBU1NXT1JEKTsKICAgICAgICBsaC5hZGRFbnRyeShURVNUX0xF\nREdFUl9FTlRSWV9EQVRBKTsKICAgICAgICBBcnJheUxpc3Q8Qm9va2llU29j\na2V0QWRkcmVzcz4gZmlyc3RFbnNlbWJsZSA9IGxoLmdldExlZGdlck1ldGFk\nYXRhKCkKICAgICAgICAgICAgICAgIC5nZXRFbnNlbWJsZXMoKS5nZXQoMEwp\nOwogICAgICAgIEJvb2tpZVNvY2tldEFkZHJlc3MgbGFzdEJvb2tpZUZyb21F\nbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0KDApOwogICAgICAgIExPRy5p\nbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2llRnJvbUVuc2VtYmxlICsgIiBm\ncm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAgICAgICsgZmlyc3RFbnNlbWJs\nZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0Qm9va2llRnJvbUVuc2VtYmxl\nKTsKCiAgICAgICAgc3RhcnROZXdCb29raWUoKTsKCiAgICAgICAgLy9PcGVu\nIGxlZGdlciBzZXBhcmF0ZWx5IGZvciBMZWRnZXIgY2hlY2tlci4KICAgICAg\nICBMZWRnZXJIYW5kbGUgbGgxID1ia2Mub3BlbkxlZGdlck5vUmVjb3Zlcnko\nbGguZ2V0SWQoKSwgQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAg\nICAgICAgICAgICAgVEVTVF9MRURHRVJfUEFTU1dPUkQpOwoKICAgICAgICBT\nZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVuZGVyUmVwbGljYXRl\nZEZyYWdtZW50cyhsaDEpOwogICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3Vs\ndCBzaG91bGRuJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKCJUaGVyZSBzaG91bGQgYmUgMSBmcmFnbWVudC4gQnV0IHJldHVy\nbmVkIGZyYWdtZW50cyBhcmUgIgogICAgICAgICAgICAgICAgKyByZXN1bHQs\nIDEsIHJlc3VsdC5zaXplKCkpOwogICAgfQoKICAgIC8qKgogICAgICogVGVz\ndHMgdGhhdCBMZWRnZXJDaGVja2VyIGNvcnJlY3RseSBpZGVudGlmaWVzIG1p\nc3NpbmcgZnJhZ21lbnRzCiAgICAgKiB3aGVuIGEgc2luZ2xlIGVudHJ5IGlz\nIHdyaXR0ZW4gYWZ0ZXIgYW4gZW5zZW1ibGUgY2hhbmdlLgogICAgICogVGhp\ncyBpcyBpbXBvcnRhbnQsIGFzIHRoZSBsYXN0IGFkZCBjb25maXJtZWQgbWF5\nIGJlIGxlc3MgdGhhbiB0aGUKICAgICAqIGZpcnN0IGVudHJ5IGlkIG9mIHRo\nZSBmaW5hbCBzZWdtZW50LgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0ID0g\nMzAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTaW5nbGVFbnRyeUFmdGVyRW5z\nZW1ibGVDaGFuZ2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMZWRn\nZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDMsIEJvb2tLZWVw\nZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVE\nR0VSX1BBU1NXT1JEKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEw\nOyBpKyspIHsKICAgICAgICAgICAgbGguYWRkRW50cnkoVEVTVF9MRURHRVJf\nRU5UUllfREFUQSk7CiAgICAgICAgfQogICAgICAgIEFycmF5TGlzdDxCb29r\naWVTb2NrZXRBZGRyZXNzPiBmaXJzdEVuc2VtYmxlID0gbGguZ2V0TGVkZ2Vy\nTWV0YWRhdGEoKQogICAgICAgICAgICAgICAgLmdldEVuc2VtYmxlcygpLmdl\ndCgwTCk7CiAgICAgICAgQm9va2llU29ja2V0QWRkcmVzcyBsYXN0Qm9va2ll\nRnJvbUVuc2VtYmxlID0gZmlyc3RFbnNlbWJsZS5nZXQoCiAgICAgICAgICAg\nICAgICBsaC5nZXREaXN0cmlidXRpb25TY2hlZHVsZSgpLmdldFdyaXRlU2V0\nKGxoLmdldExhc3RBZGRQdXNoZWQoKSkuZ2V0KDApKTsKICAgICAgICBMT0cu\naW5mbygiS2lsbGluZyAiICsgbGFzdEJvb2tpZUZyb21FbnNlbWJsZSArICIg\nZnJvbSBlbnNlbWJsZT0iCiAgICAgICAgICAgICAgICArIGZpcnN0RW5zZW1i\nbGUpOwogICAgICAgIGtpbGxCb29raWUobGFzdEJvb2tpZUZyb21FbnNlbWJs\nZSk7CiAgICAgICAgc3RhcnROZXdCb29raWUoKTsKCiAgICAgICAgbGguYWRk\nRW50cnkoVEVTVF9MRURHRVJfRU5UUllfREFUQSk7CgogICAgICAgIGxhc3RC\nb29raWVGcm9tRW5zZW1ibGUgPSBmaXJzdEVuc2VtYmxlLmdldCgKICAgICAg\nICAgICAgICAgIGxoLmdldERpc3RyaWJ1dGlvblNjaGVkdWxlKCkuZ2V0V3Jp\ndGVTZXQobGguZ2V0TGFzdEFkZFB1c2hlZCgpKS5nZXQoMSkpOwogICAgICAg\nIExPRy5pbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2llRnJvbUVuc2VtYmxl\nICsgIiBmcm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAgICAgICsgZmlyc3RF\nbnNlbWJsZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0Qm9va2llRnJvbUVu\nc2VtYmxlKTsKCiAgICAgICAgLy9PcGVuIGxlZGdlciBzZXBhcmF0ZWx5IGZv\nciBMZWRnZXIgY2hlY2tlci4KICAgICAgICBMZWRnZXJIYW5kbGUgbGgxID1i\na2Mub3BlbkxlZGdlck5vUmVjb3ZlcnkobGguZ2V0SWQoKSwgQm9va0tlZXBl\nci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAgVEVTVF9MRURH\nRVJfUEFTU1dPUkQpOwoKICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21lbnQ+IHJl\nc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZyYWdtZW50cyhsaDEpOwogICAg\nICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUgbnVsbCIs\nIHJlc3VsdCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUaGVyZSBzaG91bGQg\nYmUgMyBmcmFnbWVudC4gQnV0IHJldHVybmVkIGZyYWdtZW50cyBhcmUgIgog\nICAgICAgICAgICAgICAgKyByZXN1bHQsIDMsIHJlc3VsdC5zaXplKCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogVGVzdHMgdGhhdCBMZWRnZXJDaGVja2Vy\nIGRvZXMgbm90IHJldHVybiBhbnkgZnJhZ21lbnRzCiAgICAgKiBmcm9tIGEg\nY2xvc2VkIGxlZGdlciB3aXRoIDAgZW50cmllcy4KICAgICAqLwogICAgQFRl\nc3QodGltZW91dCA9IDMwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2xvc2Vk\nRW1wdHlMZWRnZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMZWRn\nZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDMsIEJvb2tLZWVw\nZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVE\nR0VSX1BBU1NXT1JEKTsKICAgICAgICBBcnJheUxpc3Q8Qm9va2llU29ja2V0\nQWRkcmVzcz4gZmlyc3RFbnNlbWJsZSA9IGxoLmdldExlZGdlck1ldGFkYXRh\nKCkKICAgICAgICAgICAgICAgIC5nZXRFbnNlbWJsZXMoKS5nZXQoMEwpOwog\nICAgICAgIGxoLmNsb3NlKCk7CgogICAgICAgIEJvb2tpZVNvY2tldEFkZHJl\nc3MgbGFzdEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0\nKDApOwogICAgICAgIExPRy5pbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2ll\nRnJvbUVuc2VtYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAg\nICAgICsgZmlyc3RFbnNlbWJsZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0\nQm9va2llRnJvbUVuc2VtYmxlKTsKCiAgICAgICAgLy9PcGVuIGxlZGdlciBz\nZXBhcmF0ZWx5IGZvciBMZWRnZXIgY2hlY2tlci4KICAgICAgICBMZWRnZXJI\nYW5kbGUgbGgxID1ia2Mub3BlbkxlZGdlck5vUmVjb3ZlcnkobGguZ2V0SWQo\nKSwgQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAg\nICAgVEVTVF9MRURHRVJfUEFTU1dPUkQpOwoKICAgICAgICBTZXQ8TGVkZ2Vy\nRnJhZ21lbnQ+IHJlc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZyYWdtZW50\ncyhsaDEpOwogICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBzaG91bGRu\nJ3QgYmUgbnVsbCIsIHJlc3VsdCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJU\naGVyZSBzaG91bGQgYmUgMCBmcmFnbWVudC4gQnV0IHJldHVybmVkIGZyYWdt\nZW50cyBhcmUgIgogICAgICAgICAgICAgICAgKyByZXN1bHQsIDAsIHJlc3Vs\ndC5zaXplKCkpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdHMgdGhhdCBM\nZWRnZXJDaGVja2VyIGRvZXMgbm90IHJldHVybiBhbnkgZnJhZ21lbnRzCiAg\nICAgKiBmcm9tIGEgY2xvc2VkIGxlZGdlciB3aXRoIDAgZW50cmllcy4KICAg\nICAqLwogICAgQFRlc3QodGltZW91dCA9IDMwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0Q2xvc2VkU2luZ2xlRW50cnlMZWRnZXIoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVk\nZ2VyKDMsIDIsIEJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAg\nICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NXT1JEKTsKICAgICAgICBBcnJh\neUxpc3Q8Qm9va2llU29ja2V0QWRkcmVzcz4gZmlyc3RFbnNlbWJsZSA9IGxo\nLmdldExlZGdlck1ldGFkYXRhKCkKICAgICAgICAgICAgLmdldEVuc2VtYmxl\ncygpLmdldCgwTCk7CiAgICAgICAgbGguYWRkRW50cnkoVEVTVF9MRURHRVJf\nRU5UUllfREFUQSk7CiAgICAgICAgbGguY2xvc2UoKTsKCiAgICAgICAgLy8g\na2lsbCBib29raWUgMgogICAgICAgIEJvb2tpZVNvY2tldEFkZHJlc3MgbGFz\ndEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0RW5zZW1ibGUuZ2V0KDIpOwog\nICAgICAgIExPRy5pbmZvKCJLaWxsaW5nICIgKyBsYXN0Qm9va2llRnJvbUVu\nc2VtYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIKICAgICAgICAgICAgICAgICsg\nZmlyc3RFbnNlbWJsZSk7CiAgICAgICAga2lsbEJvb2tpZShsYXN0Qm9va2ll\nRnJvbUVuc2VtYmxlKTsKCiAgICAgICAgLy9PcGVuIGxlZGdlciBzZXBhcmF0\nZWx5IGZvciBMZWRnZXIgY2hlY2tlci4KICAgICAgICBMZWRnZXJIYW5kbGUg\nbGgxID1ia2Mub3BlbkxlZGdlck5vUmVjb3ZlcnkobGguZ2V0SWQoKSwgQm9v\na0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAgVEVT\nVF9MRURHRVJfUEFTU1dPUkQpOwoKICAgICAgICBTZXQ8TGVkZ2VyRnJhZ21l\nbnQ+IHJlc3VsdCA9IGdldFVuZGVyUmVwbGljYXRlZEZyYWdtZW50cyhsaDEp\nOwogICAgICAgIGFzc2VydE5vdE51bGwoIlJlc3VsdCBzaG91bGRuJ3QgYmUg\nbnVsbCIsIHJlc3VsdCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUaGVyZSBz\naG91bGQgYmUgMCBmcmFnbWVudC4gQnV0IHJldHVybmVkIGZyYWdtZW50cyBh\ncmUgIgogICAgICAgICAgICAgICAgKyByZXN1bHQsIDAsIHJlc3VsdC5zaXpl\nKCkpOwogICAgICAgIGxoMS5jbG9zZSgpOwoKICAgICAgICAvLyBraWxsIGJv\nb2tpZSAxCiAgICAgICAgbGFzdEJvb2tpZUZyb21FbnNlbWJsZSA9IGZpcnN0\nRW5zZW1ibGUuZ2V0KDEpOwogICAgICAgIExPRy5pbmZvKCJLaWxsaW5nICIg\nKyBsYXN0Qm9va2llRnJvbUVuc2VtYmxlICsgIiBmcm9tIGVuc2VtYmxlPSIK\nICAgICAgICAgICAgICAgICsgZmlyc3RFbnNlbWJsZSk7CiAgICAgICAga2ls\nbEJvb2tpZShsYXN0Qm9va2llRnJvbUVuc2VtYmxlKTsKICAgICAgICBzdGFy\ndE5ld0Jvb2tpZSgpOwoKICAgICAgICAvL09wZW4gbGVkZ2VyIHNlcGFyYXRl\nbHkgZm9yIExlZGdlciBjaGVja2VyLgogICAgICAgIGxoMSA9YmtjLm9wZW5M\nZWRnZXJOb1JlY292ZXJ5KGxoLmdldElkKCksIEJvb2tLZWVwZXIuRGlnZXN0\nVHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgIFRFU1RfTEVER0VSX1BBU1NX\nT1JEKTsKCiAgICAgICAgcmVzdWx0ID0gZ2V0VW5kZXJSZXBsaWNhdGVkRnJh\nZ21lbnRzKGxoMSk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiUmVzdWx0IHNo\nb3VsZG4ndCBiZSBudWxsIiwgcmVzdWx0KTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoIlRoZXJlIHNob3VsZCBiZSAxIGZyYWdtZW50LiBCdXQgcmV0dXJuZWQg\nZnJhZ21lbnRzIGFyZSAiCiAgICAgICAgICAgICAgICArIHJlc3VsdCwgMSwg\ncmVzdWx0LnNpemUoKSk7CiAgICAgICAgbGgxLmNsb3NlKCk7CgogICAgICAg\nIC8vIGtpbGwgYm9va2llIDAKICAgICAgICBsYXN0Qm9va2llRnJvbUVuc2Vt\nYmxlID0gZmlyc3RFbnNlbWJsZS5nZXQoMCk7CiAgICAgICAgTE9HLmluZm8o\nIktpbGxpbmcgIiArIGxhc3RCb29raWVGcm9tRW5zZW1ibGUgKyAiIGZyb20g\nZW5zZW1ibGU9IgogICAgICAgICAgICAgICAgKyBmaXJzdEVuc2VtYmxlKTsK\nICAgICAgICBraWxsQm9va2llKGxhc3RCb29raWVGcm9tRW5zZW1ibGUpOwog\nICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CgogICAgICAgIC8vT3BlbiBsZWRn\nZXIgc2VwYXJhdGVseSBmb3IgTGVkZ2VyIGNoZWNrZXIuCiAgICAgICAgbGgx\nID1ia2Mub3BlbkxlZGdlck5vUmVjb3ZlcnkobGguZ2V0SWQoKSwgQm9va0tl\nZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAgVEVTVF9M\nRURHRVJfUEFTU1dPUkQpOwoKICAgICAgICByZXN1bHQgPSBnZXRVbmRlclJl\ncGxpY2F0ZWRGcmFnbWVudHMobGgxKTsKICAgICAgICBhc3NlcnROb3ROdWxs\nKCJSZXN1bHQgc2hvdWxkbid0IGJlIG51bGwiLCByZXN1bHQpOwogICAgICAg\nIGFzc2VydEVxdWFscygiVGhlcmUgc2hvdWxkIGJlIDIgZnJhZ21lbnQuIEJ1\ndCByZXR1cm5lZCBmcmFnbWVudHMgYXJlICIKICAgICAgICAgICAgICAgICsg\ncmVzdWx0LCAyLCByZXN1bHQuc2l6ZSgpKTsKICAgICAgICBsaDEuY2xvc2Uo\nKTsKICAgIH0KCiAgICBwcml2YXRlIFNldDxMZWRnZXJGcmFnbWVudD4gZ2V0\nVW5kZXJSZXBsaWNhdGVkRnJhZ21lbnRzKExlZGdlckhhbmRsZSBsaCkKICAg\nICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAg\nICBMZWRnZXJDaGVja2VyIGNoZWNrZXIgPSBuZXcgTGVkZ2VyQ2hlY2tlcihi\na2MpOwogICAgICAgIENoZWNrZXJDYWxsYmFjayBjYiA9IG5ldyBDaGVja2Vy\nQ2FsbGJhY2soKTsKICAgICAgICBjaGVja2VyLmNoZWNrTGVkZ2VyKGxoLCBj\nYik7CiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50PiByZXN1bHQgPSBjYi53\nYWl0QW5kR2V0UmVzdWx0KCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQga2lsbEJvb2tpZShBcnJheUxpc3Q8Qm9v\na2llU29ja2V0QWRkcmVzcz4gZmlyc3RFbnNlbWJsZSwgQm9va2llU29ja2V0\nQWRkcmVzcyBlbnNlbWJsZSkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgTE9HLmluZm8oIktpbGxpbmcgIiArIGVuc2VtYmxlICsg\nIiBmcm9tIGVuc2VtYmxlPSIgKyBmaXJzdEVuc2VtYmxlKTsKICAgICAgICBr\naWxsQm9va2llKGVuc2VtYmxlKTsKICAgIH0KCn0K\n","encoding":"base64"}

