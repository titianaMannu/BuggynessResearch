{"sha":"eb833a3e0d554ff223024e5ada540d4911d91a16","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWI4MzNhM2UwZDU1NGZmMjIzMDI0ZTVhZGE1NDBkNDkxMWQ5MWExNg==","size":5846,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/eb833a3e0d554ff223024e5ada540d4911d91a16","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIu\nRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRh\nLkZsYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5tZXRhLkhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXJGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2Vy\nTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxl\nZGdlck1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLm1ldGEuTVNMZWRnZXJNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5uZXQuQm9va2llU29ja2V0QWRkcmVzczsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50\nZXJuYWxDYWxsYmFja3M7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ncHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkxlZGdlck1ldGFk\nYXRhTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVz\ndC5Cb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnV0aWwuUmVmbGVjdGlvblV0aWxzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnZlcnNpb25pbmcuVmVyc2lvbjsKaW1wb3J0\nIG9yZy5qdW5pdC5UZXN0OwppbXBvcnQgb3JnLmp1bml0LnJ1bm5lci5SdW5X\naXRoOwppbXBvcnQgb3JnLmp1bml0LnJ1bm5lcnMuUGFyYW1ldGVyaXplZDsK\naW1wb3J0IG9yZy5qdW5pdC5ydW5uZXJzLlBhcmFtZXRlcml6ZWQuUGFyYW1l\ndGVyczsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZl\ncjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0OwoKaW1wb3J0IHN0YXRp\nYyBvcmcuanVuaXQuQXNzZXJ0Lio7CgpAUnVuV2l0aChQYXJhbWV0ZXJpemVk\nLmNsYXNzKQpwdWJsaWMgY2xhc3MgVGVzdFdhdGNoRW5zZW1ibGVDaGFuZ2Ug\nZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKCiAgICBzdGF0\naWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFRlc3RX\nYXRjaEVuc2VtYmxlQ2hhbmdlLmNsYXNzKTsKCiAgICBmaW5hbCBEaWdlc3RU\neXBlIGRpZ2VzdFR5cGU7CiAgICBmaW5hbCBDbGFzczw/IGV4dGVuZHMgTGVk\nZ2VyTWFuYWdlckZhY3Rvcnk+IGxtRmFjdG9yeUNsczsKCiAgICBwdWJsaWMg\nVGVzdFdhdGNoRW5zZW1ibGVDaGFuZ2UoQ2xhc3M8PyBleHRlbmRzIExlZGdl\nck1hbmFnZXJGYWN0b3J5PiBsbUZhY3RvcnlDbHMpIHsKICAgICAgICBzdXBl\ncig3KTsKICAgICAgICB0aGlzLmRpZ2VzdFR5cGUgPSBEaWdlc3RUeXBlLkNS\nQzMyOwogICAgICAgIHRoaXMubG1GYWN0b3J5Q2xzID0gbG1GYWN0b3J5Q2xz\nOwogICAgICAgIGJhc2VDbGllbnRDb25mLnNldExlZGdlck1hbmFnZXJGYWN0\nb3J5Q2xhc3MobG1GYWN0b3J5Q2xzKTsKICAgICAgICBiYXNlQ29uZi5zZXRM\nZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNzKGxtRmFjdG9yeUNscyk7CiAgICB9\nCgogICAgQFBhcmFtZXRlcnMKICAgIHB1YmxpYyBzdGF0aWMgQ29sbGVjdGlv\nbjxPYmplY3RbXT4gY29uZmlncygpIHsKICAgICAgICByZXR1cm4gQXJyYXlz\nLmFzTGlzdChuZXcgT2JqZWN0W11bXSB7CiAgICAgICAgICAgICAgICB7IEZs\nYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcyB9LAogICAgICAgICAgICAg\nICAgeyBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcyB9\nLAogICAgICAgICAgICAgICAgeyBNU0xlZGdlck1hbmFnZXJGYWN0b3J5LmNs\nYXNzIH0KICAgICAgICB9KTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0ID0g\nNjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0V2F0Y2hFbnNlbWJsZUNoYW5n\nZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBudW1FbnRyaWVz\nID0gMTA7CiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxl\nZGdlcigzLCAzLCAzLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKICAg\nICAgICBmb3IgKGludCBpPTA7IGk8bnVtRW50cmllczsgaSsrKSB7CiAgICAg\nICAgICAgIGxoLmFkZEVudHJ5KCgiZGF0YSIgKyBpKS5nZXRCeXRlcygpKTsK\nICAgICAgICAgICAgTE9HLmluZm8oIkFkZGVkIGVudHJ5IHt9LiIsIGkpOwog\nICAgICAgIH0KICAgICAgICBMZWRnZXJIYW5kbGUgcmVhZExoID0gYmtjLm9w\nZW5MZWRnZXJOb1JlY292ZXJ5KGxoLmdldElkKCksIGRpZ2VzdFR5cGUsICIi\nLmdldEJ5dGVzKCkpOwogICAgICAgIGxvbmcgbGFzdExBQyA9IHJlYWRMaC5n\nZXRMYXN0QWRkQ29uZmlybWVkKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG51\nbUVudHJpZXMgLSAyLCBsYXN0TEFDKTsKICAgICAgICBBcnJheUxpc3Q8Qm9v\na2llU29ja2V0QWRkcmVzcz4gZW5zZW1ibGUgPQogICAgICAgICAgICAgICAg\nbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKS5jdXJyZW50RW5zZW1ibGU7CiAgICAg\nICAgZm9yIChCb29raWVTb2NrZXRBZGRyZXNzIGFkZHIgOiBlbnNlbWJsZSkg\newogICAgICAgICAgICBraWxsQm9va2llKGFkZHIpOwogICAgICAgIH0KICAg\nICAgICAvLyB3cml0ZSBhbm90aGVyIGJhdGNoIG9mIGVudHJpZXMsIHdoaWNo\nIHdpbGwgdHJpZ2dlciBlbnNlbWJsZSBjaGFuZ2UKICAgICAgICBmb3IgKGlu\ndCBpPTA7IGk8bnVtRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGxoLmFk\nZEVudHJ5KCgiZGF0YSIgKyAobnVtRW50cmllcyArIGkpKS5nZXRCeXRlcygp\nKTsKICAgICAgICAgICAgTE9HLmluZm8oIkFkZGVkIGVudHJ5IHt9LiIsIChu\ndW1FbnRyaWVzICsgaSkpOwogICAgICAgIH0KICAgICAgICBUaW1lVW5pdC5T\nRUNPTkRTLnNsZWVwKDUpOwogICAgICAgIHJlYWRMaC5yZWFkTGFzdENvbmZp\ncm1lZCgpOwogICAgICAgIGFzc2VydEVxdWFscygyICogbnVtRW50cmllcyAt\nIDIsIHJlYWRMaC5nZXRMYXN0QWRkQ29uZmlybWVkKCkpOwogICAgICAgIHJl\nYWRMaC5jbG9zZSgpOwogICAgICAgIGxoLmNsb3NlKCk7CiAgICB9CgogICAg\nQFRlc3QodGltZW91dCA9IDYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFdh\ndGNoTWV0YWRhdGFSZW1vdmFsKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICBMZWRnZXJNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5ID0gUmVmbGVjdGlvblV0\naWxzLm5ld0luc3RhbmNlKGxtRmFjdG9yeUNscyk7CiAgICAgICBmYWN0b3J5\nLmluaXRpYWxpemUoYmFzZUNvbmYsIHN1cGVyLnprYywgZmFjdG9yeS5nZXRD\ndXJyZW50VmVyc2lvbigpKTsKICAgICAgIExlZGdlck1hbmFnZXIgbWFuYWdl\nciA9IGZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlcigpOwogICAgICAgZmluYWwg\nQnl0ZUJ1ZmZlciBiYkxlZGdlcklkID0gQnl0ZUJ1ZmZlci5hbGxvY2F0ZSg4\nKTsKICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIGNyZWF0ZUxhdGNoID0g\nbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgZmluYWwgQ291bnREb3du\nTGF0Y2ggcmVtb3ZlTGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7Cgog\nICAgICAgbWFuYWdlci5jcmVhdGVMZWRnZXIoIG5ldyBMZWRnZXJNZXRhZGF0\nYSg0LCAyLCAyLCBkaWdlc3RUeXBlLCAiZnBqIHdhcyBoZXJlIi5nZXRCeXRl\ncygpKSwKICAgICAgICAgICAgICAgIG5ldyBCb29ra2VlcGVySW50ZXJuYWxD\nYWxsYmFja3MuR2VuZXJpY0NhbGxiYWNrPExvbmc+KCl7CgogICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkNv\nbXBsZXRlKGludCByYywgTG9uZyByZXN1bHQpIHsKICAgICAgICAgICAgICAg\nYmJMZWRnZXJJZC5wdXRMb25nKHJlc3VsdCk7CiAgICAgICAgICAgICAgIGJi\nTGVkZ2VySWQuZmxpcCgpOwogICAgICAgICAgICAgICBjcmVhdGVMYXRjaC5j\nb3VudERvd24oKTsKICAgICAgICAgICB9CiAgICAgICB9KTsKICAgICAgIGFz\nc2VydFRydWUoY3JlYXRlTGF0Y2guYXdhaXQoMjAwMCwgVGltZVVuaXQuTUlM\nTElTRUNPTkRTKSk7CiAgICAgICBmaW5hbCBsb25nIGNyZWF0ZWRMaWQgPSBi\nYkxlZGdlcklkLmdldExvbmcoKTsKCiAgICAgICBtYW5hZ2VyLnJlZ2lzdGVy\nTGVkZ2VyTWV0YWRhdGFMaXN0ZW5lciggY3JlYXRlZExpZCwKICAgICAgICAg\nICAgICAgbmV3IExlZGdlck1ldGFkYXRhTGlzdGVuZXIoKSB7CgogICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgIHB1YmxpYyB2b2lkIG9uQ2hhbmdl\nZCggbG9uZyBsZWRnZXJJZCwgTGVkZ2VyTWV0YWRhdGEgbWV0YWRhdGEgKSB7\nCiAgICAgICAgICAgICAgIGFzc2VydEVxdWFscyhsZWRnZXJJZCwgY3JlYXRl\nZExpZCk7CiAgICAgICAgICAgICAgIGFzc2VydEVxdWFscyhtZXRhZGF0YSwg\nbnVsbCk7CiAgICAgICAgICAgICAgIHJlbW92ZUxhdGNoLmNvdW50RG93bigp\nOwogICAgICAgICAgIH0KICAgICAgIH0pOwoKICAgICAgIG1hbmFnZXIucmVt\nb3ZlTGVkZ2VyTWV0YWRhdGEoIGNyZWF0ZWRMaWQsIFZlcnNpb24uQU5ZLAog\nICAgICAgICAgICAgICBuZXcgQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tz\nLkdlbmVyaWNDYWxsYmFjazxWb2lkPigpIHsKCiAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUo\naW50IHJjLCBWb2lkIHJlc3VsdCkgewogICAgICAgICAgICAgICBhc3NlcnRF\ncXVhbHMocmMsIEJLRXhjZXB0aW9uLkNvZGUuT0spOwogICAgICAgICAgIH0K\nICAgICAgIH0pOwogICAgICAgYXNzZXJ0VHJ1ZShyZW1vdmVMYXRjaC5hd2Fp\ndCgyMDAwLCBUaW1lVW5pdC5NSUxMSVNFQ09ORFMpKTsKICAgIH0KfQo=\n","encoding":"base64"}

