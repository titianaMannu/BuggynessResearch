{"sha":"19aab44e772d5ecaa83acf9ebc83d6f54ac56f13","node_id":"MDQ6QmxvYjE1NzU5NTY6MTlhYWI0NGU3NzJkNWVjYWE4M2FjZjllYmM4M2Q2ZjU0YWM1NmYxMw==","size":10563,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/19aab44e772d5ecaa83acf9ebc83d6f54ac56f13","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhOwoKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGph\ndmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuUmFuZG9t\nOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5Tb3J0\nZWRTZXQ7CmltcG9ydCBqYXZhLnV0aWwuVHJlZVNldDsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51\ndGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9ydCBqYXZhLnV0aWwuY29u\nY3VycmVudC5hdG9taWMuQXRvbWljSW50ZWdlcjsKCmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuYm9va2llLkdhcmJhZ2VDb2xsZWN0b3I7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLlNjYW5BbmRDb21wYXJl\nR2FyYmFnZUNvbGxlY3RvcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyTWV0YWRhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2Vy\nLkxlZGdlclJhbmdlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1l\ndGEuTGVkZ2VyTWFuYWdlci5MZWRnZXJSYW5nZUl0ZXJhdG9yOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5h\nbENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIudmVyc2lvbmluZy5WZXJzaW9uOwppbXBvcnQgb3JnLmp1\nbml0LlRlc3Q7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgc3RhdGljIG9yZy5qdW5p\ndC5Bc3NlcnQuKjsKCi8qKgogKiBUZXN0IGdhcmJhZ2UgY29sbGVjdGlvbiBs\nZWRnZXJzIGluIGxlZGdlciBtYW5hZ2VyCiAqLwpwdWJsaWMgY2xhc3MgR2NM\nZWRnZXJzVGVzdCBleHRlbmRzIExlZGdlck1hbmFnZXJUZXN0Q2FzZSB7CiAg\nICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKEdjTGVkZ2Vyc1Rlc3QuY2xhc3MpOwoKICAgIHB1YmxpYyBHY0xl\nZGdlcnNUZXN0KENsYXNzPD8gZXh0ZW5kcyBMZWRnZXJNYW5hZ2VyRmFjdG9y\neT4gbG1GYWN0b3J5Q2xzKSB7CiAgICAgICAgc3VwZXIobG1GYWN0b3J5Q2xz\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBsZWRnZXJzCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBjcmVhdGVMZWRnZXJzKGludCBudW1MZWRn\nZXJzLCBmaW5hbCBTZXQ8TG9uZz4gY3JlYXRlZExlZGdlcnMpIHsKICAgICAg\nICBmaW5hbCBBdG9taWNJbnRlZ2VyIGV4cGVjdGVkID0gbmV3IEF0b21pY0lu\ndGVnZXIobnVtTGVkZ2Vycyk7CiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51\nbUxlZGdlcnM7IGkrKykgewogICAgICAgICAgICBnZXRMZWRnZXJNYW5hZ2Vy\nKCkuY3JlYXRlTGVkZ2VyKG5ldyBMZWRnZXJNZXRhZGF0YSgxLCAxLCAxLCBE\naWdlc3RUeXBlLk1BQywgIiIuZ2V0Qnl0ZXMoKSksCiAgICAgICAgICAgICAg\nICBuZXcgR2VuZXJpY0NhbGxiYWNrPExvbmc+KCkgewogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25Db21wbGV0ZShpbnQgcmMsIExvbmcgbGVkZ2VySWQpIHsKICAgICAg\nICAgICAgICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29kZS5PSykg\newogICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVMZWRnZXJzLnB1dChs\nZWRnZXJJZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0\nZWRMZWRnZXJzLmFkZChsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAoZXhwZWN0ZWQp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IG51bSA9IGV4cGVjdGVk\nLmRlY3JlbWVudEFuZEdldCgpOwogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAobnVtID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4\ncGVjdGVkLm5vdGlmeSgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9KTsKICAgICAgICB9CiAgICAgICAgc3luY2hyb25pemVkIChleHBl\nY3RlZCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgd2hp\nbGUgKGV4cGVjdGVkLmdldCgpID4gMCkgewogICAgICAgICAgICAgICAgICAg\nIGV4cGVjdGVkLndhaXQoMTAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\ncmVtb3ZlTGVkZ2VyKGxvbmcgbGVkZ2VySWQpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIgcmMgPSBuZXcgQXRvbWlj\nSW50ZWdlcigwKTsKICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBsYXRj\naCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICBnZXRMZWRnZXJN\nYW5hZ2VyKCkucmVtb3ZlTGVkZ2VyTWV0YWRhdGEobGVkZ2VySWQsIFZlcnNp\nb24uQU5ZLAogICAgICAgICAgICAgICAgbmV3IEdlbmVyaWNDYWxsYmFjazxW\nb2lkPigpIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShp\nbnQgcmMyLCBWb2lkIHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAg\nICByYy5zZXQocmMyKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGF0Y2gu\nY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgfSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShsYXRjaC5hd2FpdCgx\nMCwgVGltZVVuaXQuU0VDT05EUykpOwogICAgICAgIGFzc2VydEVxdWFscygi\nUmVtb3ZlIHNob3VsZCBoYXZlIHN1Y2NlZWRlZCIsIDAsIHJjLmdldCgpKTsK\nICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZv\naWQgdGVzdEdhcmJhZ2VDb2xsZWN0TGVkZ2VycygpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIGludCBudW1MZWRnZXJzID0gMTAwOwogICAgICAgIGlu\ndCBudW1SZW1vdmVkTGVkZ2VycyA9IDEwOwoKICAgICAgICBmaW5hbCBTZXQ8\nTG9uZz4gY3JlYXRlZExlZGdlcnMgPSBuZXcgSGFzaFNldDxMb25nPigpOwog\nICAgICAgIGZpbmFsIFNldDxMb25nPiByZW1vdmVkTGVkZ2VycyA9IG5ldyBI\nYXNoU2V0PExvbmc+KCk7CgogICAgICAgIC8vIGNyZWF0ZSAxMDAgbGVkZ2Vy\ncwogICAgICAgIGNyZWF0ZUxlZGdlcnMobnVtTGVkZ2VycywgY3JlYXRlZExl\nZGdlcnMpOwoKICAgICAgICBSYW5kb20gciA9IG5ldyBSYW5kb20oU3lzdGVt\nLmN1cnJlbnRUaW1lTWlsbGlzKCkpOwogICAgICAgIGZpbmFsIExpc3Q8TG9u\nZz4gdG1wTGlzdCA9IG5ldyBBcnJheUxpc3Q8TG9uZz4oKTsKICAgICAgICB0\nbXBMaXN0LmFkZEFsbChjcmVhdGVkTGVkZ2Vycyk7CiAgICAgICAgQ29sbGVj\ndGlvbnMuc2h1ZmZsZSh0bXBMaXN0LCByKTsKICAgICAgICAvLyByYW5kb20g\ncmVtb3ZlIHNldmVyYWwgbGVkZ2VycwogICAgICAgIGZvciAoaW50IGk9MDsg\naTxudW1SZW1vdmVkTGVkZ2VyczsgaSsrKSB7CiAgICAgICAgICAgIGxvbmcg\nbGVkZ2VySWQgPSB0bXBMaXN0LmdldChpKTsKICAgICAgICAgICAgc3luY2hy\nb25pemVkIChyZW1vdmVkTGVkZ2VycykgewogICAgICAgICAgICAgICAgZ2V0\nTGVkZ2VyTWFuYWdlcigpLnJlbW92ZUxlZGdlck1ldGFkYXRhKGxlZGdlcklk\nLCBWZXJzaW9uLkFOWSwKICAgICAgICAgICAgICAgICAgICBuZXcgR2VuZXJp\nY0NhbGxiYWNrPFZvaWQ+KCkgewogICAgICAgICAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBWb2lkIHJlc3VsdCkgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgc3luY2hyb25pemVkIChyZW1vdmVk\nTGVkZ2VycykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl\nbW92ZWRMZWRnZXJzLm5vdGlmeSgpOwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJlbW92ZWRMZWRnZXJzLndh\naXQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZW1vdmVkTGVkZ2Vy\ncy5hZGQobGVkZ2VySWQpOwogICAgICAgICAgICBjcmVhdGVkTGVkZ2Vycy5y\nZW1vdmUobGVkZ2VySWQpOwogICAgICAgIH0KICAgICAgICBmaW5hbCBDb3Vu\ndERvd25MYXRjaCBpbkdjUHJvZ3Jlc3MgPSBuZXcgQ291bnREb3duTGF0Y2go\nMSk7CiAgICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggY3JlYXRlTGF0Y2gg\nPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgZmluYWwgQ291bnRE\nb3duTGF0Y2ggZW5kTGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMik7CiAg\nICAgICAgZmluYWwgR2FyYmFnZUNvbGxlY3RvciBnYXJiYWdlQ29sbGVjdG9y\nID0KICAgICAgICAgICAgICAgIG5ldyBTY2FuQW5kQ29tcGFyZUdhcmJhZ2VD\nb2xsZWN0b3IoZ2V0TGVkZ2VyTWFuYWdlcigpLCBhY3RpdmVMZWRnZXJzKTsK\nICAgICAgICBUaHJlYWQgZ2NUaHJlYWQgPSBuZXcgVGhyZWFkKCkgewogICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgcnVu\nKCkgewogICAgICAgICAgICAgICAgZ2FyYmFnZUNvbGxlY3Rvci5nYyhuZXcg\nR2FyYmFnZUNvbGxlY3Rvci5HYXJiYWdlQ2xlYW5lcigpIHsKICAgICAgICAg\nICAgICAgICAgICBib29sZWFuIHBhdXNlZCA9IGZhbHNlOwogICAgICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIGNsZWFuKGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKCFwYXVzZWQpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGluR2NQcm9ncmVzcy5jb3VudERvd24oKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgY3JlYXRlTGF0Y2guYXdhaXQoKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGll\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBwYXVzZWQgPSB0cnVlOwogICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZv\nKCJHYXJiYWdlIENvbGxlY3RlZCBsZWRnZXIge30iLCBsZWRnZXJJZCk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAg\nICAgICAgICAgICBMT0cuaW5mbygiR2MgVGhyZWFkIHF1aXRzLiIpOwogICAg\nICAgICAgICAgICAgZW5kTGF0Y2guY291bnREb3duKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9OwoKICAgICAgICBUaHJlYWQgY3JlYXRlVGhyZWFkID0g\nbmV3IFRocmVhZCgpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgaW5HY1Byb2dyZXNzLmF3YWl0KCk7CiAg\nICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIDEwIG1vcmUgbGVkZ2Vycwog\nICAgICAgICAgICAgICAgICAgIGNyZWF0ZUxlZGdlcnMoMTAsIGNyZWF0ZWRM\nZWRnZXJzKTsKICAgICAgICAgICAgICAgICAgICBMT0cuaW5mbygiRmluaXNo\nZWQgY3JlYXRpbmcgMTAgbW9yZSBsZWRnZXJzLiIpOwogICAgICAgICAgICAg\nICAgICAgIGNyZWF0ZUxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIExPRy5pbmZvKCJDcmVhdGUgVGhyZWFkIHF1aXRz\nLiIpOwogICAgICAgICAgICAgICAgZW5kTGF0Y2guY291bnREb3duKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBjcmVhdGVUaHJlYWQu\nc3RhcnQoKTsKICAgICAgICBnY1RocmVhZC5zdGFydCgpOwoKICAgICAgICBl\nbmRMYXRjaC5hd2FpdCgpOwoKICAgICAgICAvLyB0ZXN0IGxlZGdlcnMKICAg\nICAgICBmb3IgKExvbmcgbGVkZ2VyIDogcmVtb3ZlZExlZGdlcnMpIHsKICAg\nICAgICAgICAgYXNzZXJ0RmFsc2UoYWN0aXZlTGVkZ2Vycy5jb250YWluc0tl\neShsZWRnZXIpKTsKICAgICAgICB9CiAgICAgICAgZm9yIChMb25nIGxlZGdl\nciA6IGNyZWF0ZWRMZWRnZXJzKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUo\nYWN0aXZlTGVkZ2Vycy5jb250YWluc0tleShsZWRnZXIpKTsKICAgICAgICB9\nCiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2\nb2lkIHRlc3RHY0xlZGdlcnNPdXRzaWRlUmFuZ2UoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBmaW5hbCBTb3J0ZWRTZXQ8TG9uZz4gY3JlYXRlZExl\nZGdlcnMgPSBDb2xsZWN0aW9ucy5zeW5jaHJvbml6ZWRTb3J0ZWRTZXQobmV3\nIFRyZWVTZXQ8TG9uZz4oKSk7CiAgICAgICAgZmluYWwgUXVldWU8TG9uZz4g\nY2xlYW5lZCA9IG5ldyBMaW5rZWRMaXN0PExvbmc+KCk7CiAgICAgICAgaW50\nIG51bUxlZGdlcnMgPSAxMDA7CgogICAgICAgIGNyZWF0ZUxlZGdlcnMobnVt\nTGVkZ2VycywgY3JlYXRlZExlZGdlcnMpOwoKICAgICAgICBmaW5hbCBHYXJi\nYWdlQ29sbGVjdG9yIGdhcmJhZ2VDb2xsZWN0b3IgPQogICAgICAgICAgICAg\nICAgbmV3IFNjYW5BbmRDb21wYXJlR2FyYmFnZUNvbGxlY3RvcihnZXRMZWRn\nZXJNYW5hZ2VyKCksIGFjdGl2ZUxlZGdlcnMpOwogICAgICAgIEdhcmJhZ2VD\nb2xsZWN0b3IuR2FyYmFnZUNsZWFuZXIgY2xlYW5lciA9IG5ldyBHYXJiYWdl\nQ29sbGVjdG9yLkdhcmJhZ2VDbGVhbmVyKCkgewogICAgICAgICAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBjbGVhbihs\nb25nIGxlZGdlcklkKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8o\nIkNsZWFuZWQge30iLCBsZWRnZXJJZCk7CiAgICAgICAgICAgICAgICAgICAg\nY2xlYW5lZC5hZGQobGVkZ2VySWQpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9OwoKICAgICAgICBnYXJiYWdlQ29sbGVjdG9yLmdjKGNsZWFu\nZXIpOwogICAgICAgIGFzc2VydE51bGwoIlNob3VsZCBoYXZlIGNsZWFuZWQg\nbm90aGluZyIsIGNsZWFuZWQucG9sbCgpKTsKCiAgICAgICAgbG9uZyBsYXN0\nID0gY3JlYXRlZExlZGdlcnMubGFzdCgpOwogICAgICAgIHJlbW92ZUxlZGdl\ncihsYXN0KTsKICAgICAgICBnYXJiYWdlQ29sbGVjdG9yLmdjKGNsZWFuZXIp\nOwogICAgICAgIGFzc2VydE5vdE51bGwoIlNob3VsZCBoYXZlIGNsZWFuZWQg\nc29tZXRoaW5nIiwgY2xlYW5lZC5wZWVrKCkpOwogICAgICAgIGFzc2VydEVx\ndWFscygiU2hvdWxkIGhhdmUgY2xlYW5lZCBsYXN0IGxlZGdlciIgKyBsYXN0\nLCAobG9uZylsYXN0LCAobG9uZyljbGVhbmVkLnBvbGwoKSk7CgogICAgICAg\nIGxvbmcgZmlyc3QgPSBjcmVhdGVkTGVkZ2Vycy5maXJzdCgpOwogICAgICAg\nIHJlbW92ZUxlZGdlcihmaXJzdCk7CiAgICAgICAgZ2FyYmFnZUNvbGxlY3Rv\nci5nYyhjbGVhbmVyKTsKICAgICAgICBhc3NlcnROb3ROdWxsKCJTaG91bGQg\naGF2ZSBjbGVhbmVkIHNvbWV0aGluZyIsIGNsZWFuZWQucGVlaygpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBoYXZlIGNsZWFuZWQgZmlyc3Qg\nbGVkZ2VyIiArIGZpcnN0LCAobG9uZylmaXJzdCwgKGxvbmcpY2xlYW5lZC5w\nb2xsKCkpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0R2NMZWRnZXJzTm90TGFzdCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIGZpbmFsIFNvcnRlZFNldDxMb25nPiBjcmVhdGVk\nTGVkZ2VycyA9IENvbGxlY3Rpb25zLnN5bmNocm9uaXplZFNvcnRlZFNldChu\nZXcgVHJlZVNldDxMb25nPigpKTsKICAgICAgICBmaW5hbCBMaXN0PExvbmc+\nIGNsZWFuZWQgPSBuZXcgQXJyYXlMaXN0PExvbmc+KCk7CgogICAgICAgIC8v\nIENyZWF0ZSBlbm91Z2ggbGVkZ2VycyB0byBzcGFuIG92ZXIgNCByYW5nZXMg\naW4gdGhlIGhpZXJhcmNoaWNhbCBsZWRnZXIgbWFuYWdlciBpbXBsZW1lbnRh\ndGlvbgogICAgICAgIGZpbmFsIGludCBudW1MZWRnZXJzID0gMzAwMDE7Cgog\nICAgICAgIGNyZWF0ZUxlZGdlcnMobnVtTGVkZ2VycywgY3JlYXRlZExlZGdl\ncnMpOwoKICAgICAgICBmaW5hbCBHYXJiYWdlQ29sbGVjdG9yIGdhcmJhZ2VD\nb2xsZWN0b3IgPQogICAgICAgICAgICAgICAgbmV3IFNjYW5BbmRDb21wYXJl\nR2FyYmFnZUNvbGxlY3RvcihnZXRMZWRnZXJNYW5hZ2VyKCksIGFjdGl2ZUxl\nZGdlcnMpOwogICAgICAgIEdhcmJhZ2VDb2xsZWN0b3IuR2FyYmFnZUNsZWFu\nZXIgY2xlYW5lciA9IG5ldyBHYXJiYWdlQ29sbGVjdG9yLkdhcmJhZ2VDbGVh\nbmVyKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBjbGVhbihsb25nIGxlZGdlcklkKSB7CiAgICAg\nICAgICAgICAgICAgICAgTE9HLmluZm8oIkNsZWFuZWQge30iLCBsZWRnZXJJ\nZCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYW5lZC5hZGQobGVkZ2VySWQp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICBT\nb3J0ZWRTZXQ8TG9uZz4gc2Nhbm5lZExlZGdlcnMgPSBuZXcgVHJlZVNldDxM\nb25nPigpOwogICAgICAgIExlZGdlclJhbmdlSXRlcmF0b3IgaXRlcmF0b3Ig\nPSBnZXRMZWRnZXJNYW5hZ2VyKCkuZ2V0TGVkZ2VyUmFuZ2VzKCk7CiAgICAg\nICAgd2hpbGUgKGl0ZXJhdG9yLmhhc05leHQoKSkgewogICAgICAgICAgICBM\nZWRnZXJSYW5nZSBsZWRnZXJSYW5nZSA9IGl0ZXJhdG9yLm5leHQoKTsKICAg\nICAgICAgICAgc2Nhbm5lZExlZGdlcnMuYWRkQWxsKGxlZGdlclJhbmdlLmdl\ndExlZGdlcnMoKSk7CiAgICAgICAgfQoKICAgICAgICBhc3NlcnRFcXVhbHMo\nY3JlYXRlZExlZGdlcnMsIHNjYW5uZWRMZWRnZXJzKTsKCiAgICAgICAgZ2Fy\nYmFnZUNvbGxlY3Rvci5nYyhjbGVhbmVyKTsKICAgICAgICBhc3NlcnRUcnVl\nKCJTaG91bGQgaGF2ZSBjbGVhbmVkIG5vdGhpbmciLCBjbGVhbmVkLmlzRW1w\ndHkoKSk7CgogICAgICAgIGxvbmcgZmlyc3QgPSBjcmVhdGVkTGVkZ2Vycy5m\naXJzdCgpOwogICAgICAgIHJlbW92ZUxlZGdlcihmaXJzdCk7CiAgICAgICAg\nZ2FyYmFnZUNvbGxlY3Rvci5nYyhjbGVhbmVyKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoIlNob3VsZCBoYXZlIGNsZWFuZWQgc29tZXRoaW5nIiwgMSwgY2xl\nYW5lZC5zaXplKCkpOwogICAgICAgIGFzc2VydEVxdWFscygiU2hvdWxkIGhh\ndmUgY2xlYW5lZCBmaXJzdCBsZWRnZXIiICsgZmlyc3QsIChsb25nKWZpcnN0\nLCAobG9uZyljbGVhbmVkLmdldCgwKSk7CiAgICB9Cn0K\n","encoding":"base64"}

