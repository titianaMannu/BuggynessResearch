{"sha":"18a818aeaab3c1709a0dce06c7bece06bc171f96","node_id":"MDQ6QmxvYjE1NzU5NTY6MThhODE4YWVhYWIzYzE3MDlhMGRjZTA2YzdiZWNlMDZiYzE3MWY5Ng==","size":6106,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/18a818aeaab3c1709a0dce06c7bece06bc171f96","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwoKcGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuRmllbGQ7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNv\nbmYuQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5ab29EZWZzLklkczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci50\nZXN0LkJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2U7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIudXRpbC5Cb29rS2VlcGVyQ29uc3RhbnRzOwppbXBv\ncnQgb3JnLmp1bml0LlRlc3Q7CgppbXBvcnQgc3RhdGljIG9yZy5qdW5pdC5B\nc3NlcnQuKjsKCnB1YmxpYyBjbGFzcyBMZWRnZXJMYXlvdXRUZXN0IGV4dGVu\nZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CgogICAgcHVibGljIExl\nZGdlckxheW91dFRlc3QoKSB7CiAgICAgICAgc3VwZXIoMCk7CiAgICB9Cgog\nICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RM\nZWRnZXJMYXlvdXQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBDbGll\nbnRDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgQ2xpZW50Q29uZmlndXJhdGlv\nbigpOwogICAgICAgIGNvbmYuc2V0TGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFz\ncyhIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcyk7CiAg\nICAgICAgU3RyaW5nIGxlZGdlclJvb3RQYXRoID0gIi90ZXN0TGVkZ2VyTGF5\nb3V0IjsKCiAgICAgICAgemtjLmNyZWF0ZShsZWRnZXJSb290UGF0aCwgbmV3\nIGJ5dGVbMF0sCiAgICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5T\nQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQpOwoKICAgICAgICBMZWRnZXJM\nYXlvdXQgbGF5b3V0ID0gTGVkZ2VyTGF5b3V0LnJlYWRMYXlvdXQoemtjLCBs\nZWRnZXJSb290UGF0aCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiTGF5b3V0IHNo\nb3VsZCBiZSBudWxsIiwgbGF5b3V0ID09IG51bGwpOwoKICAgICAgICBTdHJp\nbmcgdGVzdE5hbWUgPSAiZm9vYmFyIjsKICAgICAgICBpbnQgdGVzdFZlcnNp\nb24gPSAweGRlYWRiZWVmOwogICAgICAgIC8vIHVzZSBsYXlvdXQgZGVmaW5l\nZCBpbiBjb25maWd1cmF0aW9uIGFsc28gY3JlYXRlIGl0IGluIHpvb2tlZXBl\ncgogICAgICAgIExlZGdlckxheW91dCBsYXlvdXQyID0gbmV3IExlZGdlckxh\neW91dCh0ZXN0TmFtZSwgdGVzdFZlcnNpb24pOwogICAgICAgIGxheW91dDIu\nc3RvcmUoemtjLCBsZWRnZXJSb290UGF0aCk7CgogICAgICAgIGxheW91dCA9\nIExlZGdlckxheW91dC5yZWFkTGF5b3V0KHprYywgbGVkZ2VyUm9vdFBhdGgp\nOwogICAgICAgIGFzc2VydEVxdWFscyh0ZXN0TmFtZSwgbGF5b3V0LmdldE1h\nbmFnZXJGYWN0b3J5Q2xhc3MoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHRl\nc3RWZXJzaW9uLCBsYXlvdXQuZ2V0TWFuYWdlclZlcnNpb24oKSk7CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIHdyaXRlTGVkZ2VyTGF5b3V0KAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGxlZGdlcnNSb290\nUGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0cmlu\nZyBtYW5hZ2VyVHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGludCBtYW5hZ2VyVmVyc2lvbiwgaW50IGxheW91dFZlcnNpb24pCiAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTGVkZ2VyTGF5b3V0\nIGxheW91dCA9IG5ldyBMZWRnZXJMYXlvdXQobWFuYWdlclR5cGUsIG1hbmFn\nZXJWZXJzaW9uKTsKCiAgICAgICAgRmllbGQgZiA9IExlZGdlckxheW91dC5j\nbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJsYXlvdXRGb3JtYXRWZXJzaW9uIik7\nCiAgICAgICAgZi5zZXRBY2Nlc3NpYmxlKHRydWUpOwogICAgICAgIGYuc2V0\nKGxheW91dCwgbGF5b3V0VmVyc2lvbik7CgogICAgICAgIGxheW91dC5zdG9y\nZSh6a2MsIGxlZGdlcnNSb290UGF0aCk7CiAgICB9CgogICAgQFRlc3QodGlt\nZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RCYWRWZXJzaW9uTGVk\nZ2VyTGF5b3V0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xpZW50\nQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICAvLyB3cml0ZSBiYWQgdmVyc2lvbiBsZWRnZXIgbGF5b3V0\nCiAgICAgICAgd3JpdGVMZWRnZXJMYXlvdXQoY29uZi5nZXRaa0xlZGdlcnNS\nb290UGF0aCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgIEZsYXRMZWRn\nZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcy5nZXROYW1lKCksCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgRmxhdExlZGdlck1hbmFnZXJGYWN0b3J5LkNVUl9W\nRVJTSU9OLAogICAgICAgICAgICAgICAgICAgICAgICAgIExlZGdlckxheW91\ndC5MQVlPVVRfRk9STUFUX1ZFUlNJT04gKyAxKTsKCiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgTGVkZ2VyTGF5b3V0LnJlYWRMYXlvdXQoemtjLCBjb25m\nLmdldFprTGVkZ2Vyc1Jvb3RQYXRoKCkpOwogICAgICAgICAgICBmYWlsKCJT\naG91bGRuJ3QgcmVhY2ggaGVyZSEiKTsKICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBpZSkgewogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlk\nIGV4Y2VwdGlvbiIsIGllLmdldE1lc3NhZ2UoKS5jb250YWlucygidmVyc2lv\nbiBub3QgY29tcGF0aWJsZSIpKTsKICAgICAgICB9CiAgICB9CgogICAgQFRl\nc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RBYnNlbnRM\nZWRnZXJNYW5hZ2VyTGF5b3V0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgQ2xpZW50Q29uZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZp\nZ3VyYXRpb24oKTsKICAgICAgICBTdHJpbmcgbGVkZ2Vyc0xheW91dCA9IGNv\nbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgoKSArICIvIgogICAgICAgICAgICAg\nICAgKyBCb29rS2VlcGVyQ29uc3RhbnRzLkxBWU9VVF9aTk9ERTsKICAgICAg\nICAvLyB3cml0ZSBiYWQgZm9ybWF0IGxlZGdlciBsYXlvdXQKICAgICAgICBT\ndHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAg\nICBzYi5hcHBlbmQoTGVkZ2VyTGF5b3V0LkxBWU9VVF9GT1JNQVRfVkVSU0lP\nTikuYXBwZW5kKCJcbiIpOwogICAgICAgIHprYy5jcmVhdGUobGVkZ2Vyc0xh\neW91dCwgc2IudG9TdHJpbmcoKS5nZXRCeXRlcygpLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVh\ndGVNb2RlLlBFUlNJU1RFTlQpOwoKICAgICAgICB0cnkgewogICAgICAgICAg\nICBMZWRnZXJMYXlvdXQucmVhZExheW91dCh6a2MsIGNvbmYuZ2V0WmtMZWRn\nZXJzUm9vdFBhdGgoKSk7CiAgICAgICAgICAgIGZhaWwoIlNob3VsZG4ndCBy\nZWFjaCBoZXJlISIpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGll\nKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoIkludmFsaWQgZXhjZXB0aW9u\nIiwgaWUuZ2V0TWVzc2FnZSgpLmNvbnRhaW5zKCJ2ZXJzaW9uIGFic2VudCBm\ncm9tIikpOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYw\nMDAwKQogICAgcHVibGljIHZvaWQgdGVzdEJhc2VMZWRnZXJNYW5hZ2VyTGF5\nb3V0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xpZW50Q29uZmln\ndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAg\nICAgICBTdHJpbmcgcm9vdFBhdGggPSBjb25mLmdldFprTGVkZ2Vyc1Jvb3RQ\nYXRoKCk7CiAgICAgICAgU3RyaW5nIGxlZGdlcnNMYXlvdXQgPSByb290UGF0\naCArICIvIgogICAgICAgICAgICAgICAgKyBCb29rS2VlcGVyQ29uc3RhbnRz\nLkxBWU9VVF9aTk9ERTsKICAgICAgICAvLyB3cml0ZSBiYWQgZm9ybWF0IGxl\nZGdlciBsYXlvdXQKICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0\ncmluZ0J1aWxkZXIoKTsKICAgICAgICBzYi5hcHBlbmQoTGVkZ2VyTGF5b3V0\nLkxBWU9VVF9GT1JNQVRfVkVSU0lPTikuYXBwZW5kKCJcbiIpCiAgICAgICAg\nICAuYXBwZW5kKEZsYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcy5nZXRO\nYW1lKCkpOwogICAgICAgIHprYy5jcmVhdGUobGVkZ2Vyc0xheW91dCwgc2Iu\ndG9TdHJpbmcoKS5nZXRCeXRlcygpLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBF\nUlNJU1RFTlQpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBMZWRnZXJM\nYXlvdXQucmVhZExheW91dCh6a2MsIHJvb3RQYXRoKTsKICAgICAgICAgICAg\nZmFpbCgiU2hvdWxkbid0IHJlYWNoIGhlcmUhIik7CiAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgi\nSW52YWxpZCBleGNlcHRpb24iLCBpZS5nZXRNZXNzYWdlKCkuY29udGFpbnMo\nIkludmFsaWQgTGVkZ2VyIE1hbmFnZXIiKSk7CiAgICAgICAgfQogICAgfQoK\nICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nUmVhZFYxTGVkZ2VyTWFuYWdlckxheW91dCgpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBDbGll\nbnRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgLy8gd3JpdGUgdjEgbGVkZ2Vy\nIGxheW91dAogICAgICAgIHdyaXRlTGVkZ2VyTGF5b3V0KGNvbmYuZ2V0WmtM\nZWRnZXJzUm9vdFBhdGgoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICBG\nbGF0TGVkZ2VyTWFuYWdlckZhY3RvcnkuTkFNRSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICBGbGF0TGVkZ2VyTWFuYWdlckZhY3RvcnkuQ1VSX1ZFUlNJ\nT04sIDEpOwoKICAgICAgICBMZWRnZXJMYXlvdXQgbGF5b3V0ID0gTGVkZ2Vy\nTGF5b3V0LnJlYWRMYXlvdXQoemtjLCBjb25mLmdldFprTGVkZ2Vyc1Jvb3RQ\nYXRoKCkpOwogICAgICAgIGFzc2VydE5vdE51bGwoIlNob3VsZCBub3QgYmUg\nbnVsbCIsIGxheW91dCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKEZsYXRMZWRn\nZXJNYW5hZ2VyRmFjdG9yeS5OQU1FLCBsYXlvdXQuZ2V0TWFuYWdlckZhY3Rv\ncnlDbGFzcygpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoRmxhdExlZGdlck1h\nbmFnZXJGYWN0b3J5LkNVUl9WRVJTSU9OLCBsYXlvdXQuZ2V0TWFuYWdlclZl\ncnNpb24oKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGxheW91dC5nZXRM\nYXlvdXRGb3JtYXRWZXJzaW9uKCkpOwogICAgfQp9Cg==\n","encoding":"base64"}

