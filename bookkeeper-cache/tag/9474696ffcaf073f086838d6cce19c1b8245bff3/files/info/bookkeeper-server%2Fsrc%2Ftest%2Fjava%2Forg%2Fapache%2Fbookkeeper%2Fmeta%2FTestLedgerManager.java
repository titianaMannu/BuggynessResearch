{"sha":"8fd40c9e57e25de43ca35f92b6546bff5e837a05","node_id":"MDQ6QmxvYjE1NzU5NTY6OGZkNDBjOWU1N2UyNWRlNDNjYTM1ZjkyYjY1NDZiZmY1ZTgzN2EwNQ==","size":11545,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8fd40c9e57e25de43ca35f92b6546bff5e837a05","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGE7CgppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVu\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5DcmVhdGVNb2RlOwppbXBvcnQgb3JnLmFwYWNo\nZS56b29rZWVwZXIuWm9vRGVmcy5JZHM7CmltcG9ydCBqYXZhLnV0aWwuY29u\nY3VycmVudC5DeWNsaWNCYXJyaWVyOwppbXBvcnQgamF2YS51dGlsLmNvbmN1\ncnJlbnQuQ291bnREb3duTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsK\naW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5GaWVsZDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ndGVzdC5Cb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlOwppbXBvcnQgb3JnLmp1\nbml0LlRlc3Q7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IHN0YXRpYyBvcmcuanVu\naXQuQXNzZXJ0Lio7CgpwdWJsaWMgY2xhc3MgVGVzdExlZGdlck1hbmFnZXIg\nZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKICAgIHByaXZh\ndGUgZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihUZXN0TGVkZ2VyTWFuYWdlci5jbGFzcyk7CgogICAgcHVibGlj\nIFRlc3RMZWRnZXJNYW5hZ2VyKCkgewogICAgICAgIHN1cGVyKDApOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCB3cml0ZUxlZGdlckxheW91dChTdHJpbmcg\nbGVkZ2Vyc1Jvb3RQYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIFN0cmluZyBtYW5hZ2VyVHlwZSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBpbnQgbWFuYWdlclZlcnNpb24sIGludCBsYXlv\ndXRWZXJzaW9uKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIExlZGdlckxheW91dCBsYXlvdXQgPSBuZXcgTGVkZ2VyTGF5b3V0KG1hbmFn\nZXJUeXBlLCBtYW5hZ2VyVmVyc2lvbik7CgogICAgICAgIEZpZWxkIGYgPSBM\nZWRnZXJMYXlvdXQuY2xhc3MuZ2V0RGVjbGFyZWRGaWVsZCgibGF5b3V0Rm9y\nbWF0VmVyc2lvbiIpOwogICAgICAgIGYuc2V0QWNjZXNzaWJsZSh0cnVlKTsK\nICAgICAgICBmLnNldChsYXlvdXQsIGxheW91dFZlcnNpb24pOwoKICAgICAg\nICBsYXlvdXQuc3RvcmUoemtjLCBsZWRnZXJzUm9vdFBhdGgpOwogICAgfQoK\nICAgIC8qKgogICAgICogVGVzdCBiYWQgY2xpZW50IGNvbmZpZ3VyYXRpb24K\nICAgICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2\nb2lkIHRlc3RCYWRDb25mKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nQ2xpZW50Q29uZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3Vy\nYXRpb24oKTsKCiAgICAgICAgLy8gc3VjY2VzcyBjYXNlCiAgICAgICAgU3Ry\naW5nIHJvb3QwID0gIi9nb29kY29uZjAiOwogICAgICAgIHprYy5jcmVhdGUo\ncm9vdDAsIG5ldyBieXRlWzBdLAogICAgICAgICAgICAgICAgICAgSWRzLk9Q\nRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKICAgICAg\nICBjb25mLnNldFprTGVkZ2Vyc1Jvb3RQYXRoKHJvb3QwKTsKCiAgICAgICAg\nTGVkZ2VyTWFuYWdlckZhY3RvcnkgbSA9IExlZGdlck1hbmFnZXJGYWN0b3J5\nLm5ld0xlZGdlck1hbmFnZXJGYWN0b3J5KGNvbmYsIHprYyk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZSgiTGVkZ2VyIG1hbmFnZXIgaXMgdW5leHBlY3RlZCB0eXBl\nIiwKICAgICAgICAgICAgICAgICAgIChtIGluc3RhbmNlb2YgRmxhdExlZGdl\nck1hbmFnZXJGYWN0b3J5KSk7CiAgICAgICAgbS51bmluaXRpYWxpemUoKTsK\nCiAgICAgICAgLy8gbWlzbWF0Y2hpbmcgY29uZgogICAgICAgIGNvbmYuc2V0\nTGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFzcyhIaWVyYXJjaGljYWxMZWRnZXJN\nYW5hZ2VyRmFjdG9yeS5jbGFzcyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZhY3Rv\ncnkoY29uZiwgemtjKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0IHJl\nYWNoIGhlcmUiKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBMT0cuZXJyb3IoIlJlY2VpdmVkIGV4Y2VwdGlvbiIsIGUp\nOwogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlvbiIs\nCiAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRNZXNzYWdlKCkuY29udGFp\nbnMoImRvZXMgbm90IG1hdGNoIGV4aXN0aW5nIGxheW91dCIpKTsKICAgICAg\nICB9CgogICAgICAgIC8vIGludmFsaWQgbGVkZ2VyIG1hbmFnZXIKICAgICAg\nICBTdHJpbmcgcm9vdDEgPSAiL2JhZGNvbmYxIjsKICAgICAgICB6a2MuY3Jl\nYXRlKHJvb3QxLCBuZXcgYnl0ZVswXSwKICAgICAgICAgICAgICAgICAgIElk\ncy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lTVEVOVCk7CiAg\nICAgICAgY29uZi5zZXRaa0xlZGdlcnNSb290UGF0aChyb290MSk7CgogICAg\nICAgIGNvbmYuc2V0TGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFzc05hbWUoIkRv\nZXNOb3RFeGlzdCIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIExlZGdl\nck1hbmFnZXJGYWN0b3J5IGYgPSBMZWRnZXJNYW5hZ2VyRmFjdG9yeS5uZXdM\nZWRnZXJNYW5hZ2VyRmFjdG9yeShjb25mLCB6a2MpOwogICAgICAgICAgICBm\nYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSIpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiUmVjZWl2\nZWQgZXhjZXB0aW9uIiwgZSk7CiAgICAgICAgICAgIGFzc2VydFRydWUoIklu\ndmFsaWQgZXhjZXB0aW9uIiwKICAgICAgICAgICAgICAgICAgICBlLmdldE1l\nc3NhZ2UoKS5jb250YWlucygiRmFpbGVkIHRvIGdldCBsZWRnZXIgbWFuYWdl\nciBmYWN0b3J5IGNsYXNzIGZyb20gY29uZmlndXJhdGlvbiIpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IGJhZCBjbGllbnQgY29u\nZmlndXJhdGlvbgogICAgICovCiAgICBAU3VwcHJlc3NXYXJuaW5ncygiZGVw\ncmVjYXRpb24iKQogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RCYWRDb25mVjEoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBDbGllbnRDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgQ2xpZW50Q29u\nZmlndXJhdGlvbigpOwoKICAgICAgICBTdHJpbmcgcm9vdDAgPSAiL2dvb2Rj\nb25mMCI7CiAgICAgICAgemtjLmNyZWF0ZShyb290MCwgbmV3IGJ5dGVbMF0s\nCiAgICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVh\ndGVNb2RlLlBFUlNJU1RFTlQpOwogICAgICAgIGNvbmYuc2V0WmtMZWRnZXJz\nUm9vdFBhdGgocm9vdDApOwogICAgICAgIC8vIHdyaXRlIHYxIGxheW91dAog\nICAgICAgIHdyaXRlTGVkZ2VyTGF5b3V0KHJvb3QwLCBGbGF0TGVkZ2VyTWFu\nYWdlckZhY3RvcnkuTkFNRSwKICAgICAgICAgICAgICAgICAgICAgICAgICBG\nbGF0TGVkZ2VyTWFuYWdlckZhY3RvcnkuQ1VSX1ZFUlNJT04sIDEpOwoKICAg\nICAgICBjb25mLnNldExlZGdlck1hbmFnZXJGYWN0b3J5Q2xhc3MoRmxhdExl\nZGdlck1hbmFnZXJGYWN0b3J5LmNsYXNzKTsKCiAgICAgICAgTGVkZ2VyTWFu\nYWdlckZhY3RvcnkgbSA9IExlZGdlck1hbmFnZXJGYWN0b3J5Lm5ld0xlZGdl\nck1hbmFnZXJGYWN0b3J5KGNvbmYsIHprYyk7CiAgICAgICAgYXNzZXJ0VHJ1\nZSgiTGVkZ2VyIG1hbmFnZXIgaXMgdW5leHBlY3RlZCB0eXBlIiwKICAgICAg\nICAgICAgICAgICAgIChtIGluc3RhbmNlb2YgRmxhdExlZGdlck1hbmFnZXJG\nYWN0b3J5KSk7CiAgICAgICAgbS51bmluaXRpYWxpemUoKTsKCiAgICAgICAg\nLy8gdjIgc2V0dGluZyBkb2Vzbid0IGVmZmVjdCB2MQogICAgICAgIGNvbmYu\nc2V0TGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFzcyhIaWVyYXJjaGljYWxMZWRn\nZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcyk7CiAgICAgICAgbSA9IExlZGdlck1h\nbmFnZXJGYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXJGYWN0b3J5KGNvbmYsIHpr\nYyk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiTGVkZ2VyIG1hbmFnZXIgaXMgdW5l\neHBlY3RlZCB0eXBlIiwKICAgICAgICAgICAgICAgICAgIChtIGluc3RhbmNl\nb2YgRmxhdExlZGdlck1hbmFnZXJGYWN0b3J5KSk7CiAgICAgICAgbS51bmlu\naXRpYWxpemUoKTsKCiAgICAgICAgLy8gbWlzbWF0Y2hpbmcgY29uZgogICAg\nICAgIGNvbmYuc2V0TGVkZ2VyTWFuYWdlclR5cGUoSGllcmFyY2hpY2FsTGVk\nZ2VyTWFuYWdlckZhY3RvcnkuTkFNRSk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZh\nY3RvcnkoY29uZiwgemtjKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0\nIHJlYWNoIGhlcmUiKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICBMT0cuZXJyb3IoIlJlY2VpdmVkIGV4Y2VwdGlvbiIs\nIGUpOwogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlv\nbiIsCiAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRNZXNzYWdlKCkuY29u\ndGFpbnMoImRvZXMgbm90IG1hdGNoIGV4aXN0aW5nIGxheW91dCIpKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IGJhZCB6ayBjb25m\naWd1cmF0aW9uCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0QmFkWmtDb250ZW50cygpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9IG5l\ndyBDbGllbnRDb25maWd1cmF0aW9uKCk7CgogICAgICAgIC8vIGJhZCB0eXBl\nIGluIHpvb2tlZXBlcgogICAgICAgIFN0cmluZyByb290MCA9ICIvYmFkemsw\nIjsKICAgICAgICB6a2MuY3JlYXRlKHJvb3QwLCBuZXcgYnl0ZVswXSwKICAg\nICAgICAgICAgICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1v\nZGUuUEVSU0lTVEVOVCk7CiAgICAgICAgY29uZi5zZXRaa0xlZGdlcnNSb290\nUGF0aChyb290MCk7CgogICAgICAgIG5ldyBMZWRnZXJMYXlvdXQoIkRvZXNO\nb3RFeGlzdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAweGRlYWRiZWVm\nKS5zdG9yZSh6a2MsIHJvb3QwKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3TGVkZ2VyTWFuYWdlckZhY3Rv\ncnkoY29uZiwgemtjKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0IHJl\nYWNoIGhlcmUiKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBMT0cuZXJyb3IoIlJlY2VpdmVkIGV4Y2VwdGlvbiIsIGUp\nOwogICAgICAgICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlvbiIs\nCiAgICAgICAgICAgICAgICAgICAgZS5nZXRNZXNzYWdlKCkuY29udGFpbnMo\nIkZhaWxlZCB0byBpbnN0YW50aWF0ZSBsZWRnZXIgbWFuYWdlciBmYWN0b3J5\nIikpOwogICAgICAgIH0KCiAgICAgICAgLy8gYmFkIHZlcnNpb24gaW4gem9v\na2VlcGVyCiAgICAgICAgU3RyaW5nIHJvb3QxID0gIi9iYWR6azEiOwogICAg\nICAgIHprYy5jcmVhdGUocm9vdDEsIG5ldyBieXRlWzBdLAogICAgICAgICAg\nICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJT\nSVNURU5UKTsKICAgICAgICBjb25mLnNldFprTGVkZ2Vyc1Jvb3RQYXRoKHJv\nb3QxKTsKCiAgICAgICAgbmV3IExlZGdlckxheW91dChGbGF0TGVkZ2VyTWFu\nYWdlckZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgpLAogICAgICAgICAgICAgICAg\nICAgICAgICAgMHhkZWFkYmVlZikuc3RvcmUoemtjLCByb290MSk7CgogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIExlZGdlck1hbmFnZXJGYWN0b3J5Lm5l\nd0xlZGdlck1hbmFnZXJGYWN0b3J5KGNvbmYsIHprYyk7CiAgICAgICAgICAg\nIGZhaWwoIlNob3VsZG4ndCByZWFjaCBoZXJlIik7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9yKCJSZWNl\naXZlZCBleGNlcHRpb24iLCBlKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgi\nSW52YWxpZCBleGNlcHRpb24iLAogICAgICAgICAgICAgICAgICAgIGUuZ2V0\nTWVzc2FnZSgpLmNvbnRhaW5zKCJJbmNvbXBhdGlibGUgbGF5b3V0IHZlcnNp\nb24gZm91bmQiKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3Rh\ndGljIGNsYXNzIENyZWF0ZUxNVGhyZWFkIGV4dGVuZHMgVGhyZWFkIHsKICAg\nICAgICBwcml2YXRlIGJvb2xlYW4gc3VjY2VzcyA9IGZhbHNlOwogICAgICAg\nIHByaXZhdGUgZmluYWwgU3RyaW5nIGZhY3RvcnlDbHM7CiAgICAgICAgcHJp\ndmF0ZSBmaW5hbCBTdHJpbmcgcm9vdDsKICAgICAgICBwcml2YXRlIGZpbmFs\nIEN5Y2xpY0JhcnJpZXIgYmFycmllcjsKICAgICAgICBwcml2YXRlIFpvb0tl\nZXBlciB6a2M7CgogICAgICAgIENyZWF0ZUxNVGhyZWFkKFN0cmluZyB6a0Nv\nbm5lY3RTdHJpbmcsIFN0cmluZyByb290LAogICAgICAgICAgICAgICAgICAg\nICAgIFN0cmluZyBmYWN0b3J5Q2xzLCBDeWNsaWNCYXJyaWVyIGJhcnJpZXIp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICB0aGlzLmZhY3RvcnlD\nbHMgPSBmYWN0b3J5Q2xzOwogICAgICAgICAgICB0aGlzLmJhcnJpZXIgPSBi\nYXJyaWVyOwogICAgICAgICAgICB0aGlzLnJvb3QgPSByb290OwogICAgICAg\nICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBsYXRjaCA9IG5ldyBDb3VudERv\nd25MYXRjaCgxKTsKICAgICAgICAgICAgemtjID0gbmV3IFpvb0tlZXBlcih6\na0Nvbm5lY3RTdHJpbmcsIDEwMDAwLCBuZXcgV2F0Y2hlcigpIHsKICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKFdhdGNoZWRFdmVu\ndCBldmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICBsYXRjaC5jb3Vu\ndERvd24oKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9KTsKICAgICAgICAgICAgbGF0Y2guYXdhaXQoKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgQ2xpZW50\nQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICAgICAgY29uZi5zZXRMZWRnZXJNYW5hZ2VyRmFjdG9yeUNs\nYXNzTmFtZShmYWN0b3J5Q2xzKTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBiYXJyaWVyLmF3YWl0KCk7CiAgICAgICAgICAgICAgICBM\nZWRnZXJNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5ID0KICAgICAgICAgICAgICAg\nICAgICBMZWRnZXJNYW5hZ2VyRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyRmFj\ndG9yeShjb25mLCB6a2MpOwogICAgICAgICAgICAgICAgZmFjdG9yeS51bmlu\naXRpYWxpemUoKTsKCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZTsK\nICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIExPRy5lcnJvcigiRmFpbGVkIHRvIGNyZWF0ZSBsZWRnZXIgbWFu\nYWdlciIsIGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBpc1N1Y2Nlc3NmdWwoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBzdWNjZXNzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nY2xvc2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgemtjLmNs\nb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIHRlc3QgY29uY3VycmVu\ndAogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRl\nc3RDb25jdXJyZW50MSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8v\nLyBldmVyeW9uZSBjcmVhdGVzIHRoZSBzYW1lCiAgICAgICAgaW50IG51bVRo\ncmVhZHMgPSA1MDsKCiAgICAgICAgLy8gYmFkIHZlcnNpb24gaW4gem9va2Vl\ncGVyCiAgICAgICAgU3RyaW5nIHJvb3QwID0gIi9sbXJvb3QwIjsKICAgICAg\nICB6a2MuY3JlYXRlKHJvb3QwLCBuZXcgYnl0ZVswXSwKICAgICAgICAgICAg\nICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUuUEVSU0lT\nVEVOVCk7CgogICAgICAgIEN5Y2xpY0JhcnJpZXIgYmFycmllciA9IG5ldyBD\neWNsaWNCYXJyaWVyKG51bVRocmVhZHMrMSk7CiAgICAgICAgTGlzdDxDcmVh\ndGVMTVRocmVhZD4gdGhyZWFkcyA9IG5ldyBBcnJheUxpc3Q8Q3JlYXRlTE1U\naHJlYWQ+KG51bVRocmVhZHMpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbnVtVGhyZWFkczsgaSsrKSB7CiAgICAgICAgICAgIENyZWF0ZUxNVGhy\nZWFkIHQgPSBuZXcgQ3JlYXRlTE1UaHJlYWQoemtVdGlsLmdldFpvb0tlZXBl\nckNvbm5lY3RTdHJpbmcoKSwKICAgICAgICAgICAgICAgICAgICByb290MCwg\nRmxhdExlZGdlck1hbmFnZXJGYWN0b3J5LmNsYXNzLmdldE5hbWUoKSwgYmFy\ncmllcik7CiAgICAgICAgICAgIHQuc3RhcnQoKTsKICAgICAgICAgICAgdGhy\nZWFkcy5hZGQodCk7CiAgICAgICAgfQoKICAgICAgICBiYXJyaWVyLmF3YWl0\nKCk7CgogICAgICAgIGJvb2xlYW4gc3VjY2VzcyA9IHRydWU7CiAgICAgICAg\nZm9yIChDcmVhdGVMTVRocmVhZCB0IDogdGhyZWFkcykgewogICAgICAgICAg\nICB0LmpvaW4oKTsKICAgICAgICAgICAgdC5jbG9zZSgpOwogICAgICAgICAg\nICBzdWNjZXNzID0gdC5pc1N1Y2Nlc3NmdWwoKSAmJiBzdWNjZXNzOwogICAg\nICAgIH0KICAgICAgICBhc3NlcnRUcnVlKCJOb3QgYWxsIGxlZGdlciBtYW5h\nZ2VycyBjcmVhdGVkIiwgc3VjY2Vzcyk7CiAgICB9CgogICAgQFRlc3QodGlt\nZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RDb25jdXJyZW50Migp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vLyBvZGQgY3JlYXRlIGRp\nZmZlcmVudAogICAgICAgIGludCBudW1UaHJlYWRzRWFjaCA9IDI1OwoKICAg\nICAgICAvLyBiYWQgdmVyc2lvbiBpbiB6b29rZWVwZXIKICAgICAgICBTdHJp\nbmcgcm9vdDAgPSAiL2xtcm9vdDAiOwogICAgICAgIHprYy5jcmVhdGUocm9v\ndDAsIG5ldyBieXRlWzBdLAogICAgICAgICAgICAgICAgICAgSWRzLk9QRU5f\nQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKCiAgICAgICAg\nQ3ljbGljQmFycmllciBiYXJyaWVyID0gbmV3IEN5Y2xpY0JhcnJpZXIobnVt\nVGhyZWFkc0VhY2gqMisxKTsKICAgICAgICBMaXN0PENyZWF0ZUxNVGhyZWFk\nPiB0aHJlYWRzQSA9IG5ldyBBcnJheUxpc3Q8Q3JlYXRlTE1UaHJlYWQ+KG51\nbVRocmVhZHNFYWNoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51\nbVRocmVhZHNFYWNoOyBpKyspIHsKICAgICAgICAgICAgQ3JlYXRlTE1UaHJl\nYWQgdCA9IG5ldyBDcmVhdGVMTVRocmVhZCh6a1V0aWwuZ2V0Wm9vS2VlcGVy\nQ29ubmVjdFN0cmluZygpLAogICAgICAgICAgICAgICAgICAgIHJvb3QwLCBG\nbGF0TGVkZ2VyTWFuYWdlckZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgpLCBiYXJy\naWVyKTsKICAgICAgICAgICAgdC5zdGFydCgpOwogICAgICAgICAgICB0aHJl\nYWRzQS5hZGQodCk7CiAgICAgICAgfQogICAgICAgIExpc3Q8Q3JlYXRlTE1U\naHJlYWQ+IHRocmVhZHNCID0gbmV3IEFycmF5TGlzdDxDcmVhdGVMTVRocmVh\nZD4obnVtVGhyZWFkc0VhY2gpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbnVtVGhyZWFkc0VhY2g7IGkrKykgewogICAgICAgICAgICBDcmVhdGVM\nTVRocmVhZCB0ID0gbmV3IENyZWF0ZUxNVGhyZWFkKHprVXRpbC5nZXRab29L\nZWVwZXJDb25uZWN0U3RyaW5nKCksCiAgICAgICAgICAgICAgICAgICAgcm9v\ndDAsIEhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXJGYWN0b3J5LmNsYXNzLmdl\ndE5hbWUoKSwgYmFycmllcik7CiAgICAgICAgICAgIHQuc3RhcnQoKTsKICAg\nICAgICAgICAgdGhyZWFkc0IuYWRkKHQpOwogICAgICAgIH0KCiAgICAgICAg\nYmFycmllci5hd2FpdCgpOwoKICAgICAgICBpbnQgbnVtU3VjY2VzcyA9IDA7\nCiAgICAgICAgaW50IG51bUZhaWxzID0gMDsKICAgICAgICBmb3IgKENyZWF0\nZUxNVGhyZWFkIHQgOiB0aHJlYWRzQSkgewogICAgICAgICAgICB0LmpvaW4o\nKTsKICAgICAgICAgICAgdC5jbG9zZSgpOwogICAgICAgICAgICBpZiAodC5p\nc1N1Y2Nlc3NmdWwoKSkgewogICAgICAgICAgICAgICAgbnVtU3VjY2Vzcysr\nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbnVtRmFp\nbHMrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yIChD\ncmVhdGVMTVRocmVhZCB0IDogdGhyZWFkc0IpIHsKICAgICAgICAgICAgdC5q\nb2luKCk7CiAgICAgICAgICAgIHQuY2xvc2UoKTsKICAgICAgICAgICAgaWYg\nKHQuaXNTdWNjZXNzZnVsKCkpIHsKICAgICAgICAgICAgICAgIG51bVN1Y2Nl\nc3MrKzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG51\nbUZhaWxzKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKCJJbmNvcnJlY3QgbnVtYmVyIG9mIHN1Y2Nlc3NlcyIsIG51\nbVRocmVhZHNFYWNoLCBudW1TdWNjZXNzKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoIkluY29ycmVjdCBudW1iZXIgb2YgZmFpbHVyZXMiLCBudW1UaHJlYWRz\nRWFjaCwgbnVtRmFpbHMpOwogICAgfQp9Cg==\n","encoding":"base64"}

