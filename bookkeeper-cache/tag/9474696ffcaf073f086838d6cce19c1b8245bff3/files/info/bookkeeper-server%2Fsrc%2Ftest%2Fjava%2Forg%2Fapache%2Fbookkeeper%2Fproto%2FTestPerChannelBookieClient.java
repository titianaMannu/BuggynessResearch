{"sha":"675c2fd564bce54f97c39d6cb03746205a09d4ac","node_id":"MDQ6QmxvYjE1NzU5NTY6Njc1YzJmZDU2NGJjZTU0Zjk3YzM5ZDZjYjAzNzQ2MjA1YTA5ZDRhYw==","size":12146,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/675c2fd564bce54f97c39d6cb03746205a09d4ac","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvOwoKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuQm9va2llOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZp\nZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubmV0LkJv\nb2tpZVNvY2tldEFkZHJlc3M7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWND\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5C\nb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuUmVhZEVudHJ5Q2FsbGJhY2s7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uUGVyQ2hhbm5l\nbEJvb2tpZUNsaWVudC5Db25uZWN0aW9uU3RhdGU7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIudGVzdC5Cb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuT3JkZXJlZFNh\nZmVFeGVjdXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGls\nLlNhZmVSdW5uYWJsZTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5idWZmZXIu\nQ2hhbm5lbEJ1ZmZlcjsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVs\nLkNoYW5uZWw7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5zb2Nr\nZXQuQ2xpZW50U29ja2V0Q2hhbm5lbEZhY3Rvcnk7CmltcG9ydCBvcmcuamJv\nc3MubmV0dHkuY2hhbm5lbC5zb2NrZXQubmlvLk5pb0NsaWVudFNvY2tldENo\nYW5uZWxGYWN0b3J5OwppbXBvcnQgb3JnLmp1bml0LlRlc3Q7CmltcG9ydCBv\ncmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rv\ncnk7CgppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\nbmlvLkJ5dGVCdWZmZXI7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5D\nb3VudERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4\nZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jv\nb2xlYW47CgppbXBvcnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCi8q\nKgogKiBUZXN0cyBmb3IgUGVyQ2hhbm5lbEJvb2tpZUNsaWVudC4gSGlzdG9y\naWNhbGx5LCB0aGlzIGNsYXNzIGhhcwogKiBoYWQgYSBmZXcgcmFjZSBjb25k\naXRpb25zLCBzbyB0aGlzIGlzIHdoYXQgdGhlc2UgdGVzdHMgZm9jdXMgb24u\nCiAqLwpwdWJsaWMgY2xhc3MgVGVzdFBlckNoYW5uZWxCb29raWVDbGllbnQg\nZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKICAgIHByaXZh\ndGUgZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihUZXN0UGVyQ2hhbm5lbEJvb2tpZUNsaWVudC5jbGFzcyk7Cgog\nICAgcHVibGljIFRlc3RQZXJDaGFubmVsQm9va2llQ2xpZW50KCkgewogICAg\nICAgIHN1cGVyKDEpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdCB0aGF0\nIGEgcmFjZSBkb2VzIG5vdCBleGlzdCBiZXR3ZWVuIGNvbm5lY3Rpb24gY29t\ncGxldGlvbgogICAgICogYW5kIGNsaWVudCBjbG9zdXJlLiBJZiBhIHJhY2Ug\nZG9lcyBleGlzdCwgdGhpcyB0ZXN0IHdpbGwgc2ltcGx5CiAgICAgKiBoYW5n\nIGF0IHJlbGVhc2VFeHRlcm5hbFJlc291cmNlcygpIGFzIGl0IGlzIHVuaW50\nZXJydXB0aWJsZS4KICAgICAqIFRoaXMgc3BlY2lmaWMgcmFjZSB3YXMgZm91\nbmQgaW4KICAgICAqIHtAbGluayBodHRwczovL2lzc3Vlcy5hcGFjaGUub3Jn\nL2ppcmEvYnJvd3NlL0JPT0tLRUVQRVItNDg1fS4KICAgICAqLwogICAgQFRl\nc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RDb25uZWN0\nQ2xvc2VSYWNlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xpZW50\nU29ja2V0Q2hhbm5lbEZhY3RvcnkgY2hhbm5lbEZhY3RvcnkKICAgICAgICAg\nICAgPSBuZXcgTmlvQ2xpZW50U29ja2V0Q2hhbm5lbEZhY3RvcnkoRXhlY3V0\nb3JzLm5ld0NhY2hlZFRocmVhZFBvb2woKSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXhlY3V0b3JzLm5ld0Nh\nY2hlZFRocmVhZFBvb2woKSk7CiAgICAgICAgT3JkZXJlZFNhZmVFeGVjdXRv\nciBleGVjdXRvciA9IG5ldyBPcmRlcmVkU2FmZUV4ZWN1dG9yKDEsCiAgICAg\nICAgICAgICAgICAiQktDbGllbnRPcmRlcmVkU2FmZUV4ZWN1dG9yIik7Cgog\nICAgICAgIEJvb2tpZVNvY2tldEFkZHJlc3MgYWRkciA9IGdldEJvb2tpZSgw\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewog\nICAgICAgICAgICBQZXJDaGFubmVsQm9va2llQ2xpZW50IGNsaWVudCA9IG5l\ndyBQZXJDaGFubmVsQm9va2llQ2xpZW50KGV4ZWN1dG9yLCBjaGFubmVsRmFj\ndG9yeSwgYWRkcik7CiAgICAgICAgICAgIGNsaWVudC5jb25uZWN0SWZOZWVk\nZWRBbmREb09wKG5ldyBHZW5lcmljQ2FsbGJhY2s8UGVyQ2hhbm5lbEJvb2tp\nZUNsaWVudD4oKSB7CiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxl\ndGUoaW50IHJjLCBQZXJDaGFubmVsQm9va2llQ2xpZW50IGNsaWVudCkgewog\nICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBub3RoaW5nLCB3ZSBkb24n\ndCBjYXJlIGFib3V0IGRvaW5nIGFueXRoaW5nIHdpdGggdGhlIGNvbm5lY3Rp\nb24sCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIGp1c3Qgd2FudCB0\nbyB0cmlnZ2VyIGl0IGNvbm5lY3RpbmcuCiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNsaWVudC5jbG9z\nZSgpOwogICAgICAgIH0KICAgICAgICBjaGFubmVsRmFjdG9yeS5yZWxlYXNl\nRXh0ZXJuYWxSZXNvdXJjZXMoKTsKICAgICAgICBleGVjdXRvci5zaHV0ZG93\nbigpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdCByYWNlIHNjZW5hcmlv\nIGZvdW5kIGluIHtAbGluayBodHRwczovL2lzc3Vlcy5hcGFjaGUub3JnL2pp\ncmEvYnJvd3NlL0JPT0tLRUVQRVItNX0KICAgICAqIHdoZXJlIG11bHRpcGxl\nIGNsaWVudHMgdHJ5IHRvIGNvbm5lY3QgYSBjaGFubmVsIHNpbXVsdGFuZW91\nc2x5LiBJZiBub3Qgc3luY2hyb25pc2VkCiAgICAgKiBjb3JyZWN0bHksIHRo\naXMgY2F1c2VzIHRoZSBuZXR0eSBjaGFubmVsIHRvIGdldCBvcnBoYW5lZC4K\nICAgICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2\nb2lkIHRlc3RDb25uZWN0UmFjZSgpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIEdlbmVyaWNDYWxsYmFjazxQZXJDaGFubmVsQm9va2llQ2xpZW50PiBu\ndWxsb3AgPSBuZXcgR2VuZXJpY0NhbGxiYWNrPFBlckNoYW5uZWxCb29raWVD\nbGllbnQ+KCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\ncHVibGljIHZvaWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBQZXJDaGFu\nbmVsQm9va2llQ2xpZW50IHBjYmMpIHsKICAgICAgICAgICAgICAgIC8vIGRv\nIG5vdGhpbmcsIHdlIGRvbid0IGNhcmUgYWJvdXQgZG9pbmcgYW55dGhpbmcg\nd2l0aCB0aGUgY29ubmVjdGlvbiwKICAgICAgICAgICAgICAgIC8vIHdlIGp1\nc3Qgd2FudCB0byB0cmlnZ2VyIGl0IGNvbm5lY3RpbmcuCiAgICAgICAgICAg\nIH0KICAgICAgICB9OwogICAgICAgIENsaWVudFNvY2tldENoYW5uZWxGYWN0\nb3J5IGNoYW5uZWxGYWN0b3J5CiAgICAgICAgICAgID0gbmV3IE5pb0NsaWVu\ndFNvY2tldENoYW5uZWxGYWN0b3J5KEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJl\nYWRQb29sKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCkp\nOwogICAgICAgIE9yZGVyZWRTYWZlRXhlY3V0b3IgZXhlY3V0b3IgPSBuZXcg\nT3JkZXJlZFNhZmVFeGVjdXRvcigxLAogICAgICAgICAgICAgICAgIkJLQ2xp\nZW50T3JkZXJlZFNhZmVFeGVjdXRvciIpOwoKICAgICAgICBCb29raWVTb2Nr\nZXRBZGRyZXNzIGFkZHIgPSBnZXRCb29raWUoMCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCAxMDA7IGkrKykgewogICAgICAgICAgICBQZXJDaGFu\nbmVsQm9va2llQ2xpZW50IGNsaWVudCA9IG5ldyBQZXJDaGFubmVsQm9va2ll\nQ2xpZW50KGV4ZWN1dG9yLCBjaGFubmVsRmFjdG9yeSwgYWRkcik7CiAgICAg\nICAgICAgIGZvciAoaW50IGogPSBpOyBqIDwgMTA7IGorKykgewogICAgICAg\nICAgICAgICAgY2xpZW50LmNvbm5lY3RJZk5lZWRlZEFuZERvT3AobnVsbG9w\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjbGllbnQuY2xvc2UoKTsK\nICAgICAgICB9CiAgICAgICAgY2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVy\nbmFsUmVzb3VyY2VzKCk7CiAgICAgICAgZXhlY3V0b3Iuc2h1dGRvd24oKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgdGhhdCBhbGwgcmVzb3VyY2Vz\nIGFyZSBmcmVlZCBpZiBjb25uZWN0aW9ucyBhbmQgZGlzY29ubmVjdGlvbnMK\nICAgICAqIGFyZSBpbnRlcmxlYXZlZCByYW5kb21seS4KICAgICAqCiAgICAg\nKiB7QGxpbmsgaHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dz\nZS9CT09LS0VFUEVSLTYyMH0KICAgICAqLwogICAgQFRlc3QodGltZW91dD02\nMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3REaXNjb25uZWN0UmFjZSgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGZpbmFsIEdlbmVyaWNDYWxsYmFj\nazxQZXJDaGFubmVsQm9va2llQ2xpZW50PiBudWxsb3AgPSBuZXcgR2VuZXJp\nY0NhbGxiYWNrPFBlckNoYW5uZWxCb29raWVDbGllbnQ+KCkgewogICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uQ29tcGxldGUoaW50IHJjLCBQZXJDaGFubmVsQm9va2llQ2xpZW50IGNs\naWVudCkgewogICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZywgd2UgZG9u\nJ3QgY2FyZSBhYm91dCBkb2luZyBhbnl0aGluZyB3aXRoIHRoZSBjb25uZWN0\naW9uLAogICAgICAgICAgICAgICAgLy8gd2UganVzdCB3YW50IHRvIHRyaWdn\nZXIgaXQgY29ubmVjdGluZy4KICAgICAgICAgICAgfQogICAgICAgIH07CiAg\nICAgICAgZmluYWwgaW50IElURVJBVElPTlMgPSAxMDAwMDA7CiAgICAgICAg\nQ2xpZW50U29ja2V0Q2hhbm5lbEZhY3RvcnkgY2hhbm5lbEZhY3RvcnkKICAg\nICAgICAgICAgPSBuZXcgTmlvQ2xpZW50U29ja2V0Q2hhbm5lbEZhY3Rvcnko\nRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2woKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXhlY3V0b3Jz\nLm5ld0NhY2hlZFRocmVhZFBvb2woKSk7CiAgICAgICAgT3JkZXJlZFNhZmVF\neGVjdXRvciBleGVjdXRvciA9IG5ldyBPcmRlcmVkU2FmZUV4ZWN1dG9yKDEs\nCiAgICAgICAgICAgICAgICAiQktDbGllbnRPcmRlcmVkU2FmZUV4ZWN1dG9y\nIik7CiAgICAgICAgQm9va2llU29ja2V0QWRkcmVzcyBhZGRyID0gZ2V0Qm9v\na2llKDApOwoKICAgICAgICBmaW5hbCBQZXJDaGFubmVsQm9va2llQ2xpZW50\nIGNsaWVudCA9IG5ldyBQZXJDaGFubmVsQm9va2llQ2xpZW50KGV4ZWN1dG9y\nLCBjaGFubmVsRmFjdG9yeSwgYWRkcik7CiAgICAgICAgZmluYWwgQXRvbWlj\nQm9vbGVhbiBzaG91bGRGYWlsID0gbmV3IEF0b21pY0Jvb2xlYW4oZmFsc2Up\nOwogICAgICAgIGZpbmFsIEF0b21pY0Jvb2xlYW4gaW5jb25zaXN0ZW50ID0g\nbmV3IEF0b21pY0Jvb2xlYW4oZmFsc2UpOwogICAgICAgIGZpbmFsIEF0b21p\nY0Jvb2xlYW4gcnVubmluZyA9IG5ldyBBdG9taWNCb29sZWFuKHRydWUpOwog\nICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIGRpc2Nvbm5lY3RSdW5uaW5n\nID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgIFRocmVhZCBjb25u\nZWN0VGhyZWFkID0gbmV3IFRocmVhZCgpIHsKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRpc2Nvbm5lY3RSdW5uaW5n\nLmF3YWl0KDEwLCBUaW1lVW5pdC5TRUNPTkRTKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgTE9HLmVycm9yKCJEaXNjb25uZWN0IHRocmVhZCBu\nZXZlciBzdGFydGVkIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBz\naG91bGRGYWlsLnNldCh0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhj\nZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiQ29ubmVjdCB0aHJlYWQgaW50ZXJydXB0ZWQiLCBpZSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJy\ndXB0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmcuc2V0KGZh\nbHNlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBJVEVSQVRJT05TICYmIHJ1bm5pbmcu\nZ2V0KCk7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQu\nY29ubmVjdElmTmVlZGVkQW5kRG9PcChudWxsb3ApOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBydW5uaW5nLnNldChmYWxz\nZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAg\nVGhyZWFkIGRpc2Nvbm5lY3RUaHJlYWQgPSBuZXcgVGhyZWFkKCkgewogICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAg\nICAgICAgIGRpc2Nvbm5lY3RSdW5uaW5nLmNvdW50RG93bigpOwogICAgICAg\nICAgICAgICAgICAgIHdoaWxlIChydW5uaW5nLmdldCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGNsaWVudC5kaXNjb25uZWN0KCk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nOwogICAgICAgIFRocmVhZCBjaGVja1RocmVhZCA9IG5ldyBUaHJlYWQoKSB7\nCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nICAgICAgICAgICAgQ29ubmVjdGlvblN0YXRlIHN0YXRlOwogICAgICAgICAg\nICAgICAgICAgIENoYW5uZWwgY2hhbm5lbDsKICAgICAgICAgICAgICAgICAg\nICB3aGlsZSAocnVubmluZy5nZXQoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBzeW5jaHJvbml6ZWQgKGNsaWVudCkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgc3RhdGUgPSBjbGllbnQuc3RhdGU7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBjaGFubmVsID0gY2xpZW50LmNoYW5uZWw7Cgog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChzdGF0ZSA9PSBDb25u\nZWN0aW9uU3RhdGUuQ09OTkVDVEVECiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICYmIChjaGFubmVsID09IG51bGwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHx8ICFjaGFubmVsLmlzQ29ubmVjdGVk\nKCkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IChzdGF0\nZSAhPSBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVEVECiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICYmIGNoYW5uZWwgIT0gbnVsbAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBjaGFubmVsLmlz\nQ29ubmVjdGVkKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgTE9HLmVycm9yKCJTdGF0ZSh7fSkgYW5kIGNoYW5uZWwoe30pIGluY29u\nc2lzdGVudCAiICsgY2hhbm5lbCwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgc3RhdGUsIGNoYW5uZWwgPT0gbnVsbCA/IG51\nbGwgOiBjaGFubmVsLmlzQ29ubmVjdGVkKCkpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHNob3VsZEZhaWwuc2V0KHRydWUpOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmcuc2V0KGZhbHNlKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICBjb25uZWN0VGhyZWFkLnN0\nYXJ0KCk7CiAgICAgICAgZGlzY29ubmVjdFRocmVhZC5zdGFydCgpOwogICAg\nICAgIGNoZWNrVGhyZWFkLnN0YXJ0KCk7CgogICAgICAgIGNvbm5lY3RUaHJl\nYWQuam9pbigpOwogICAgICAgIGRpc2Nvbm5lY3RUaHJlYWQuam9pbigpOwog\nICAgICAgIGNoZWNrVGhyZWFkLmpvaW4oKTsKICAgICAgICBhc3NlcnRGYWxz\nZSgiRmFpbHVyZSBpbiB0aHJlYWRzLCBjaGVjayBsb2dzIiwgc2hvdWxkRmFp\nbC5nZXQoKSk7CiAgICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAgICAgY2hh\nbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7CiAgICAg\nICAgZXhlY3V0b3Iuc2h1dGRvd24oKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRlc3QgdGhhdCByZXF1ZXN0cyBhcmUgY29tcGxldGVkIGV2ZW4gaWYgdGhl\nIGNoYW5uZWwgaXMgZGlzY29ubmVjdGVkCiAgICAgKiB7QGxpbmsgaHR0cHM6\nLy9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jyb3dzZS9CT09LS0VFUEVSLTY2\nOH0KICAgICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RSZXF1ZXN0Q29tcGxldGVzQWZ0ZXJEaXNjb25uZWN0UmFj\nZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY29uZiA9IGtpbGxCb29raWUoMCk7CgogICAgICAgIEJvb2tpZSBk\nZWxheUJvb2tpZSA9IG5ldyBCb29raWUoY29uZikgewogICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIEJ5dGVCdWZmZXIgcmVhZEVu\ndHJ5KGxvbmcgbGVkZ2VySWQsIGxvbmcgZW50cnlJZCkKICAgICAgICAgICAg\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIE5vTGVkZ2VyRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\nVGhyZWFkLnNsZWVwKDMwMDApOwogICAgICAgICAgICAgICAgfSBjYXRjaCAo\nSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkludGVycnVwdGVkIHdhaXRpbmci\nLCBpZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwZXIucmVhZEVudHJ5KGxlZGdlcklkLCBlbnRyeUlkKTsKICAgICAg\nICAgICAgfQogICAgICAgIH07CiAgICAgICAgYnNDb25mcy5hZGQoY29uZik7\nCiAgICAgICAgYnMuYWRkKHN0YXJ0Qm9va2llKGNvbmYsIGRlbGF5Qm9va2ll\nKSk7CgogICAgICAgIENsaWVudFNvY2tldENoYW5uZWxGYWN0b3J5IGNoYW5u\nZWxGYWN0b3J5CiAgICAgICAgICAgID0gbmV3IE5pb0NsaWVudFNvY2tldENo\nYW5uZWxGYWN0b3J5KEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCkpOwogICAgICAg\nIGZpbmFsIE9yZGVyZWRTYWZlRXhlY3V0b3IgZXhlY3V0b3IgPSBuZXcgT3Jk\nZXJlZFNhZmVFeGVjdXRvcigxLAogICAgICAgICAgICAgICAgIkJLQ2xpZW50\nT3JkZXJlZFNhZmVFeGVjdXRvciIpOwogICAgICAgIEJvb2tpZVNvY2tldEFk\nZHJlc3MgYWRkciA9IGdldEJvb2tpZSgwKTsKCiAgICAgICAgZmluYWwgUGVy\nQ2hhbm5lbEJvb2tpZUNsaWVudCBjbGllbnQgPSBuZXcgUGVyQ2hhbm5lbEJv\nb2tpZUNsaWVudChleGVjdXRvciwgY2hhbm5lbEZhY3RvcnksIGFkZHIpOwog\nICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIGNvbXBsZXRpb24gPSBuZXcg\nQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAgZmluYWwgUmVhZEVudHJ5Q2Fs\nbGJhY2sgY2IgPSBuZXcgUmVhZEVudHJ5Q2FsbGJhY2soKSB7CiAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHJlYWRFbnRyeUNvbXBsZXRlKGludCByYywgbG9uZyBsZWRnZXJJZCwgbG9u\nZyBlbnRyeUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgQ2hhbm5lbEJ1ZmZlciBidWZmZXIsIE9iamVjdCBjdHgp\nIHsKICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uLmNvdW50RG93bigp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICBj\nbGllbnQuY29ubmVjdElmTmVlZGVkQW5kRG9PcChuZXcgR2VuZXJpY0NhbGxi\nYWNrPFBlckNoYW5uZWxCb29raWVDbGllbnQ+KCkgewogICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uQ29t\ncGxldGUoZmluYWwgaW50IHJjLCBQZXJDaGFubmVsQm9va2llQ2xpZW50IHBj\nYmMpIHsKICAgICAgICAgICAgICAgIGlmIChyYyAhPSBCS0V4Y2VwdGlvbi5D\nb2RlLk9LKSB7CiAgICAgICAgICAgICAgICAgICAgZXhlY3V0b3Iuc3VibWl0\nT3JkZXJlZCgxLCBuZXcgU2FmZVJ1bm5hYmxlKCkgewogICAgICAgICAgICAg\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgc2FmZVJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGNiLnJlYWRFbnRyeUNvbXBsZXRlKHJjLCAxLCAxLCBudWxsLCBu\ndWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjbGllbnQucmVhZEVudHJ5\nQW5kRmVuY2VMZWRnZXIoMSwgIjAwMDAwMTExMTEyMjIyMjMzMzMzIi5nZXRC\neXRlcygpLCAxLCBjYiwgbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nKTsKCiAgICAgICAgVGhyZWFkLnNsZWVwKDEwMDApOwogICAgICAgIGNsaWVu\ndC5kaXNjb25uZWN0KCk7CiAgICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAg\nICAgY2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7\nCiAgICAgICAgZXhlY3V0b3Iuc2h1dGRvd24oKTsKCiAgICAgICAgYXNzZXJ0\nVHJ1ZSgiUmVxdWVzdCBzaG91bGQgaGF2ZSBjb21wbGV0ZWQiLCBjb21wbGV0\naW9uLmF3YWl0KDUsIFRpbWVVbml0LlNFQ09ORFMpKTsKICAgIH0KfQo=\n","encoding":"base64"}

