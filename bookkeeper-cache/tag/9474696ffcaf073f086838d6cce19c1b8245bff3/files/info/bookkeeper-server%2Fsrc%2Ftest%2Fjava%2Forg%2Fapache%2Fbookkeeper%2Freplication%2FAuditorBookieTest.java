{"sha":"6fbfdb0a4c535b23f7aebc576bbd0276b970eab2","node_id":"MDQ6QmxvYjE1NzU5NTY6NmZiZmRiMGE0YzUzNWIyM2Y3YWViYzU3NmJiZDAyNzZiOTcwZWFiMg==","size":10367,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/6fbfdb0a4c535b23f7aebc576bbd0276b970eab2","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQg\nanVuaXQuZnJhbWV3b3JrLkFzc2VydDsKCmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVwZXJDbHVzdGVy\nVGVzdENhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5a\na1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnpvb2tlZXBl\nci5ab29LZWVwZXJXYXRjaGVyQmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9v\na2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJG\nYWN0b3J5OwoKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7Cgov\nKioKICogVGhpcyB0ZXN0IHZlcmlmaWVzIHRoZSBhdWRpdG9yIGJvb2tpZSBz\nY2VuYXJpb3Mgd2hpY2ggd2lsbCBiZSBtb25pdG9yaW5nIHRoZQogKiBib29r\naWUgZmFpbHVyZXMKICovCnB1YmxpYyBjbGFzcyBBdWRpdG9yQm9va2llVGVz\ndCBleHRlbmRzIEJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2UgewogICAgLy8g\nRGVwZW5kaW5nIG9uIHRoZSB0YXN0ZSwgc2VsZWN0IHRoZSBhbW91bnQgb2Yg\nbG9nZ2luZwogICAgLy8gYnkgZGVjb21tZW50aW5nIG9uZSBvZiB0aGUgdHdv\nIGxpbmVzIGJlbG93CiAgICAvLyBwcml2YXRlIGZpbmFsIHN0YXRpYyBMb2dn\nZXIgTE9HID0gTG9nZ2VyLmdldFJvb3RMb2dnZXIoKTsKICAgIHByaXZhdGUg\nZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5CiAgICAg\nICAgICAgIC5nZXRMb2dnZXIoQXVkaXRvckJvb2tpZVRlc3QuY2xhc3MpOwog\nICAgcHJpdmF0ZSBTdHJpbmcgZWxlY3Rpb25QYXRoOwogICAgcHJpdmF0ZSBI\nYXNoTWFwPFN0cmluZywgQXVkaXRvckVsZWN0b3I+IGF1ZGl0b3JFbGVjdG9y\ncyA9IG5ldyBIYXNoTWFwPFN0cmluZywgQXVkaXRvckVsZWN0b3I+KCk7CiAg\nICBwcml2YXRlIExpc3Q8Wm9vS2VlcGVyPiB6a0NsaWVudHMgPSBuZXcgTGlu\na2VkTGlzdDxab29LZWVwZXI+KCk7CgogICAgcHVibGljIEF1ZGl0b3JCb29r\naWVUZXN0KCkgewogICAgICAgIHN1cGVyKDYpOwogICAgICAgIGVsZWN0aW9u\nUGF0aCA9IGJhc2VDb25mLmdldFprTGVkZ2Vyc1Jvb3RQYXRoKCkKICAgICAg\nICAgICAgICAgICsgIi91bmRlcnJlcGxpY2F0aW9uL2F1ZGl0b3JlbGVjdGlv\nbiI7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRV\ncCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNldFVwKCk7\nCiAgICAgICAgc3RhcnRBdWRpdG9yRWxlY3RvcnMoKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgc3RvcEF1ZGl0b3JFbGVjdG9ycygpOwogICAg\nICAgIGZvciAoWm9vS2VlcGVyIHprIDogemtDbGllbnRzKSB7CiAgICAgICAg\nICAgIHprLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIHprQ2xpZW50cy5j\nbGVhcigpOwogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUZXN0IHNob3VsZCBlbnN1cmUgb25seSBvbmUgc2hvdWxk\nIGFjdCBhcyBBdWRpdG9yLiBTdGFydGluZy9zaHV0ZG93bgogICAgICogb3Ro\nZXIgdGhhbiBhdWRpdG9yIGJvb2tpZSBzaG91bGRuJ3QgaW5pdGlhdGUgcmUt\nZWxlY3Rpb24gYW5kIG11bHRpcGxlCiAgICAgKiBhdWRpdG9ycy4KICAgICAq\nLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRl\nc3RFbnN1cmVPbmx5U2luZ2xlQXVkaXRvcigpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIEJvb2tpZVNlcnZlciBhdWRpdG9yID0gdmVyaWZ5QXVkaXRv\ncigpOwoKICAgICAgICAvLyBzaHV0ZG93biBib29raWUgd2hpY2ggaXMgbm90\nIGFuIGF1ZGl0b3IKICAgICAgICBpbnQgaW5kZXhPZiA9IGJzLmluZGV4T2Yo\nYXVkaXRvcik7CiAgICAgICAgaW50IGJrSW5kZXhEb3duQm9va2llOwogICAg\nICAgIGlmIChpbmRleE9mIDwgYnMuc2l6ZSgpIC0gMSkgewogICAgICAgICAg\nICBia0luZGV4RG93bkJvb2tpZSA9IGluZGV4T2YgKyAxOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIGJrSW5kZXhEb3duQm9va2llID0gaW5kZXhP\nZiAtIDE7CiAgICAgICAgfQogICAgICAgIHNodXRkb3duQm9va2llKGJzLmdl\ndChia0luZGV4RG93bkJvb2tpZSkpOwoKICAgICAgICBzdGFydE5ld0Jvb2tp\nZSgpOwogICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CiAgICAgICAgLy8gZ3Jh\nY2UgcGVyaW9kIGZvciB0aGUgYXVkaXRvciByZS1lbGVjdGlvbiBpZiBhbnkK\nICAgICAgICBCb29raWVTZXJ2ZXIgbmV3QXVkaXRvciA9IHdhaXRGb3JOZXdB\ndWRpdG9yKGF1ZGl0b3IpOwogICAgICAgIEFzc2VydC5hc3NlcnRTYW1lKAog\nICAgICAgICAgICAgICAgIkF1ZGl0b3IgcmUtZWxlY3Rpb24gaXMgbm90IGhh\ncHBlbmVkIGZvciBhdWRpdG9yIGZhaWx1cmUhIiwKICAgICAgICAgICAgICAg\nIGF1ZGl0b3IsIG5ld0F1ZGl0b3IpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGVzdCBBdWRpdG9yIGNyYXNoZXMgc2hvdWxkIHRyaWdnZXIgcmUtZWxlY3Rp\nb24gYW5kIGFub3RoZXIgYm9va2llIHNob3VsZAogICAgICogdGFrZSBvdmVy\nIHRoZSBhdWRpdG9yIHNoaXAKICAgICAqLwogICAgQFRlc3QodGltZW91dD02\nMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTdWNjZXNzaXZlQXVkaXRvckNy\nYXNoZXMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCb29raWVTZXJ2\nZXIgYXVkaXRvciA9IHZlcmlmeUF1ZGl0b3IoKTsKICAgICAgICBzaHV0ZG93\nbkJvb2tpZShhdWRpdG9yKTsKCiAgICAgICAgQm9va2llU2VydmVyIG5ld0F1\nZGl0b3IxID0gd2FpdEZvck5ld0F1ZGl0b3IoYXVkaXRvcik7CiAgICAgICAg\nYnMucmVtb3ZlKGF1ZGl0b3IpOwoKICAgICAgICBzaHV0ZG93bkJvb2tpZShu\nZXdBdWRpdG9yMSk7CiAgICAgICAgQm9va2llU2VydmVyIG5ld0F1ZGl0b3Iy\nID0gd2FpdEZvck5ld0F1ZGl0b3IobmV3QXVkaXRvcjEpOwogICAgICAgIEFz\nc2VydC5hc3NlcnROb3RTYW1lKAogICAgICAgICAgICAgICAgIkF1ZGl0b3Ig\ncmUtZWxlY3Rpb24gaXMgbm90IGhhcHBlbmVkIGZvciBhdWRpdG9yIGZhaWx1\ncmUhIiwKICAgICAgICAgICAgICAgIGF1ZGl0b3IsIG5ld0F1ZGl0b3IyKTsK\nICAgICAgICBicy5yZW1vdmUobmV3QXVkaXRvcjEpOwogICAgfQoKICAgIC8q\nKgogICAgICogVGVzdCByZXN0YXJ0aW5nIHRoZSBlbnRpcmUgYm9va2llIGNs\ndXN0ZXIuIEl0IHNob3VsZG4ndCBjcmVhdGUgbXVsdGlwbGUKICAgICAqIGJv\nb2tpZSBhdWRpdG9ycwogICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAw\nKQogICAgcHVibGljIHZvaWQgdGVzdEJvb2tpZUNsdXN0ZXJSZXN0YXJ0KCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQm9va2llU2VydmVyIGF1ZGl0\nb3IgPSB2ZXJpZnlBdWRpdG9yKCk7CiAgICAgICAgZm9yIChBdWRpdG9yRWxl\nY3RvciBhdWRpdG9yRWxlY3RvciA6IGF1ZGl0b3JFbGVjdG9ycy52YWx1ZXMo\nKSkgewogICAgICAgICAgICBhc3NlcnRUcnVlKCJBdWRpdG9yIGVsZWN0b3Ig\naXMgbm90IHJ1bm5pbmchIiwgYXVkaXRvckVsZWN0b3IKICAgICAgICAgICAg\nICAgICAgICAuaXNSdW5uaW5nKCkpOwogICAgICAgIH0KICAgICAgICBzdG9w\nQktDbHVzdGVyKCk7CiAgICAgICAgc3RvcEF1ZGl0b3JFbGVjdG9ycygpOwoK\nICAgICAgICBzdGFydEJLQ2x1c3RlcigpOwogICAgICAgIHN0YXJ0QXVkaXRv\nckVsZWN0b3JzKCk7CiAgICAgICAgQm9va2llU2VydmVyIG5ld0F1ZGl0b3Ig\nPSB3YWl0Rm9yTmV3QXVkaXRvcihhdWRpdG9yKTsKICAgICAgICBBc3NlcnQu\nYXNzZXJ0Tm90U2FtZSgKICAgICAgICAgICAgICAgICJBdWRpdG9yIHJlLWVs\nZWN0aW9uIGlzIG5vdCBoYXBwZW5lZCBmb3IgYXVkaXRvciBmYWlsdXJlISIs\nCiAgICAgICAgICAgICAgICBhdWRpdG9yLCBuZXdBdWRpdG9yKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRlc3QgdGhlIHZvdGUgaXMgZGVsZXRpbmcgZnJv\nbSB0aGUgWm9vS2VlcGVyIGR1cmluZyBzaHV0ZG93bi4KICAgICAqLwogICAg\nQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTaHV0\nZG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNlcnZl\nciBhdWRpdG9yID0gdmVyaWZ5QXVkaXRvcigpOwogICAgICAgIHNodXRkb3du\nQm9va2llKGF1ZGl0b3IpOwoKICAgICAgICAvLyB3YWl0aW5nIGZvciBuZXcg\nYXVkaXRvcgogICAgICAgIEJvb2tpZVNlcnZlciBuZXdBdWRpdG9yID0gd2Fp\ndEZvck5ld0F1ZGl0b3IoYXVkaXRvcik7CiAgICAgICAgQXNzZXJ0LmFzc2Vy\ndE5vdFNhbWUoCiAgICAgICAgICAgICAgICAiQXVkaXRvciByZS1lbGVjdGlv\nbiBpcyBub3QgaGFwcGVuZWQgZm9yIGF1ZGl0b3IgZmFpbHVyZSEiLAogICAg\nICAgICAgICAgICAgYXVkaXRvciwgbmV3QXVkaXRvcik7CiAgICAgICAgaW50\nIGluZGV4T2ZEb3duQm9va2llID0gYnMuaW5kZXhPZihhdWRpdG9yKTsKICAg\nICAgICBicy5yZW1vdmUoaW5kZXhPZkRvd25Cb29raWUpOwogICAgICAgIGJz\nQ29uZnMucmVtb3ZlKGluZGV4T2ZEb3duQm9va2llKTsKICAgICAgICB0bXBE\naXJzLnJlbW92ZShpbmRleE9mRG93bkJvb2tpZSk7CiAgICAgICAgTGlzdDxT\ndHJpbmc+IGNoaWxkcmVuID0gemtjLmdldENoaWxkcmVuKGVsZWN0aW9uUGF0\naCwgZmFsc2UpOwogICAgICAgIGZvciAoU3RyaW5nIGNoaWxkIDogY2hpbGRy\nZW4pIHsKICAgICAgICAgICAgYnl0ZVtdIGRhdGEgPSB6a2MuZ2V0RGF0YShl\nbGVjdGlvblBhdGggKyAnLycgKyBjaGlsZCwgZmFsc2UsIG51bGwpOwogICAg\nICAgICAgICBTdHJpbmcgYm9va2llSVAgPSBuZXcgU3RyaW5nKGRhdGEpOwog\nICAgICAgICAgICBTdHJpbmcgYWRkciA9IGF1ZGl0b3IuZ2V0TG9jYWxBZGRy\nZXNzKCkudG9TdHJpbmcoKTsKICAgICAgICAgICAgQXNzZXJ0LmFzc2VydEZh\nbHNlKCJBdWRpdG9yRWxlY3Rpb24gY2xlYW51cCBmYWlscyIsIGJvb2tpZUlQ\nCiAgICAgICAgICAgICAgICAgICAgLmNvbnRhaW5zKGFkZHIpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHJlc3RhcnQgb2YgdGhl\nIHByZXZpb3VzIEF1ZGl0b3IgYm9va2llIHNob3VsZG4ndCBpbml0aWF0ZQog\nICAgICogcmUtZWxlY3Rpb24gYW5kIHNob3VsZCBjcmVhdGUgbmV3IHZvdGUg\nYWZ0ZXIgcmVzdGFydGluZy4KICAgICAqLwogICAgQFRlc3QodGltZW91dD02\nMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RSZXN0YXJ0QXVkaXRvckJvb2tp\nZUFmdGVyQ3Jhc2hpbmcoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBC\nb29raWVTZXJ2ZXIgYXVkaXRvciA9IHZlcmlmeUF1ZGl0b3IoKTsKCiAgICAg\nICAgc2h1dGRvd25Cb29raWUoYXVkaXRvcik7CiAgICAgICAgU3RyaW5nIGFk\nZHIgPSBhdWRpdG9yLmdldExvY2FsQWRkcmVzcygpLnRvU3RyaW5nKCk7Cgog\nICAgICAgIC8vIHJlc3RhcnRpbmcgQm9va2llIHdpdGggc2FtZSBjb25maWd1\ncmF0aW9ucy4KICAgICAgICBpbnQgaW5kZXhPZkRvd25Cb29raWUgPSBicy5p\nbmRleE9mKGF1ZGl0b3IpOwogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24g\nc2VydmVyQ29uZmlndXJhdGlvbiA9IGJzQ29uZnMKICAgICAgICAgICAgICAg\nIC5nZXQoaW5kZXhPZkRvd25Cb29raWUpOwogICAgICAgIGJzLnJlbW92ZShp\nbmRleE9mRG93bkJvb2tpZSk7CiAgICAgICAgYnNDb25mcy5yZW1vdmUoaW5k\nZXhPZkRvd25Cb29raWUpOwogICAgICAgIHRtcERpcnMucmVtb3ZlKGluZGV4\nT2ZEb3duQm9va2llKTsKICAgICAgICBhdWRpdG9yRWxlY3RvcnMucmVtb3Zl\nKGFkZHIpOwogICAgICAgIHN0YXJ0Qm9va2llKHNlcnZlckNvbmZpZ3VyYXRp\nb24pOwogICAgICAgIC8vIHN0YXJ0aW5nIGNvcnJlc3BvbmRpbmcgYXVkaXRv\nciBlbGVjdG9yCgogICAgICAgIExPRy5kZWJ1ZygiUGVyZm9ybWluZyBBdWRp\ndG9yIEVsZWN0aW9uOiIgKyBhZGRyKTsKICAgICAgICBzdGFydEF1ZGl0b3JF\nbGVjdG9yKGFkZHIpOwoKICAgICAgICAvLyB3YWl0aW5nIGZvciBuZXcgYXVk\naXRvciB0byBjb21lCiAgICAgICAgQm9va2llU2VydmVyIG5ld0F1ZGl0b3Ig\nPSB3YWl0Rm9yTmV3QXVkaXRvcihhdWRpdG9yKTsKICAgICAgICBBc3NlcnQu\nYXNzZXJ0Tm90U2FtZSgKICAgICAgICAgICAgICAgICJBdWRpdG9yIHJlLWVs\nZWN0aW9uIGlzIG5vdCBoYXBwZW5lZCBmb3IgYXVkaXRvciBmYWlsdXJlISIs\nCiAgICAgICAgICAgICAgICBhdWRpdG9yLCBuZXdBdWRpdG9yKTsKICAgICAg\nICBBc3NlcnQuYXNzZXJ0RmFsc2UoIk5vIHJlbGVjdGlvbiBhZnRlciBvbGQg\nYXVkaXRvciByZWpvaW5zIiwgYXVkaXRvcgogICAgICAgICAgICAgICAgLmdl\ndExvY2FsQWRkcmVzcygpLmdldFBvcnQoKSA9PSBuZXdBdWRpdG9yLmdldExv\nY2FsQWRkcmVzcygpCiAgICAgICAgICAgICAgICAuZ2V0UG9ydCgpKTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgc3RhcnRBdWRpdG9yRWxlY3RvcihTdHJp\nbmcgYWRkcikgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgWm9vS2VlcGVy\nV2F0Y2hlckJhc2UgdyA9IG5ldyBab29LZWVwZXJXYXRjaGVyQmFzZSgxMDAw\nMCk7CiAgICAgICAgWm9vS2VlcGVyIHprID0gWmtVdGlscy5jcmVhdGVDb25u\nZWN0ZWRab29rZWVwZXJDbGllbnQoCiAgICAgICAgICAgICAgICB6a1V0aWwu\nZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLCB3KTsKICAgICAgICB6a0Ns\naWVudHMuYWRkKHprKTsKCiAgICAgICAgQXVkaXRvckVsZWN0b3IgYXVkaXRv\nckVsZWN0b3IgPSBuZXcgQXVkaXRvckVsZWN0b3IoYWRkciwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBiYXNlQ29uZiwgemspOwogICAgICAgIGF1ZGl0b3JFbGVjdG9ycy5w\ndXQoYWRkciwgYXVkaXRvckVsZWN0b3IpOwogICAgICAgIGF1ZGl0b3JFbGVj\ndG9yLnN0YXJ0KCk7CiAgICAgICAgTE9HLmRlYnVnKCJTdGFydGluZyBBdWRp\ndG9yIEVsZWN0b3IiKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgc3RhcnRB\ndWRpdG9yRWxlY3RvcnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBm\nb3IgKEJvb2tpZVNlcnZlciBic2VydmVyIDogYnMpIHsKICAgICAgICAgICAg\nU3RyaW5nIGFkZHIgPSBic2VydmVyLmdldExvY2FsQWRkcmVzcygpLnRvU3Ry\naW5nKCk7CiAgICAgICAgICAgIHN0YXJ0QXVkaXRvckVsZWN0b3IoYWRkcik7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzdG9wQXVkaXRv\nckVsZWN0b3JzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZm9yIChB\ndWRpdG9yRWxlY3RvciBhdWRpdG9yRWxlY3RvciA6IGF1ZGl0b3JFbGVjdG9y\ncy52YWx1ZXMoKSkgewogICAgICAgICAgICBhdWRpdG9yRWxlY3Rvci5zaHV0\nZG93bigpOwogICAgICAgICAgICBMT0cuZGVidWcoIlN0b3BwaW5nIEF1ZGl0\nb3IgRWxlY3RvciEiKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBC\nb29raWVTZXJ2ZXIgdmVyaWZ5QXVkaXRvcigpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIExpc3Q8Qm9va2llU2VydmVyPiBhdWRpdG9ycyA9IGdldEF1\nZGl0b3JCb29raWUoKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKCJN\ndWx0aXBsZSBCb29raWVzIGFjdGluZyBhcyBBdWRpdG9yISIsIDEsIGF1ZGl0\nb3JzCiAgICAgICAgICAgICAgICAuc2l6ZSgpKTsKICAgICAgICBMT0cuZGVi\ndWcoIkJvb2tpZSBydW5uaW5nIGFzIEF1ZGl0b3I6IiArIGF1ZGl0b3JzLmdl\ndCgwKSk7CiAgICAgICAgcmV0dXJuIGF1ZGl0b3JzLmdldCgwKTsKICAgIH0K\nCiAgICBwcml2YXRlIExpc3Q8Qm9va2llU2VydmVyPiBnZXRBdWRpdG9yQm9v\na2llKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTGlzdDxCb29raWVT\nZXJ2ZXI+IGF1ZGl0b3JzID0gbmV3IExpbmtlZExpc3Q8Qm9va2llU2VydmVy\nPigpOwogICAgICAgIGJ5dGVbXSBkYXRhID0gemtjLmdldERhdGEoZWxlY3Rp\nb25QYXRoLCBmYWxzZSwgbnVsbCk7CiAgICAgICAgQXNzZXJ0LmFzc2VydE5v\ndE51bGwoIkF1ZGl0b3IgZWxlY3Rpb24gZmFpbGVkIiwgZGF0YSk7CiAgICAg\nICAgZm9yIChCb29raWVTZXJ2ZXIgYmtzIDogYnMpIHsKICAgICAgICAgICAg\naWYgKG5ldyBTdHJpbmcoZGF0YSkuY29udGFpbnMoYmtzLmdldExvY2FsQWRk\ncmVzcygpLmdldFBvcnQoKSArICIiKSkgewogICAgICAgICAgICAgICAgYXVk\naXRvcnMuYWRkKGJrcyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGF1ZGl0b3JzOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBz\naHV0ZG93bkJvb2tpZShCb29raWVTZXJ2ZXIgYmtTZXJ2ZXIpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIFN0cmluZyBhZGRyID0gYmtTZXJ2ZXIuZ2V0\nTG9jYWxBZGRyZXNzKCkudG9TdHJpbmcoKTsKICAgICAgICBMT0cuZGVidWco\nIlNodXR0aW5nIGRvd24gYm9va2llOiIgKyBhZGRyKTsKCiAgICAgICAgLy8g\nc2h1dGRvd24gYm9va2llIHdoaWNoIGlzIGFuIGF1ZGl0b3IKICAgICAgICBi\na1NlcnZlci5zaHV0ZG93bigpOwogICAgICAgIC8vIHN0b3BwaW5nIGNvcnJl\nc3BvbmRpbmcgYXVkaXRvciBlbGVjdG9yCiAgICAgICAgYXVkaXRvckVsZWN0\nb3JzLmdldChhZGRyKS5zaHV0ZG93bigpOwogICAgfQoKICAgIHByaXZhdGUg\nQm9va2llU2VydmVyIHdhaXRGb3JOZXdBdWRpdG9yKEJvb2tpZVNlcnZlciBh\ndWRpdG9yKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBCb29raWVTZXJ2ZXIgbmV3QXVkaXRvciA9IG51bGw7CiAgICAgICAgaW50\nIHJldHJ5Q291bnQgPSA4OwogICAgICAgIHdoaWxlIChyZXRyeUNvdW50ID4g\nMCkgewogICAgICAgICAgICBMaXN0PEJvb2tpZVNlcnZlcj4gYXVkaXRvcnMg\nPSBnZXRBdWRpdG9yQm9va2llKCk7CiAgICAgICAgICAgIGlmIChhdWRpdG9y\ncy5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgICAgICBuZXdBdWRpdG9yID0g\nYXVkaXRvcnMuZ2V0KDApOwogICAgICAgICAgICAgICAgaWYgKGF1ZGl0b3Ig\nIT0gbmV3QXVkaXRvcikgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIFRo\ncmVhZC5zbGVlcCg1MDApOwogICAgICAgICAgICByZXRyeUNvdW50LS07CiAg\nICAgICAgfQogICAgICAgIEFzc2VydC5hc3NlcnROb3ROdWxsKAogICAgICAg\nICAgICAgICAgIk5ldyBBdWRpdG9yIGlzIG5vdCByZWVsZWN0ZWQgYWZ0ZXIg\nYXVkaXRvciBjcmFzaGVzIiwKICAgICAgICAgICAgICAgIG5ld0F1ZGl0b3Ip\nOwogICAgICAgIHZlcmlmeUF1ZGl0b3IoKTsKICAgICAgICByZXR1cm4gbmV3\nQXVkaXRvcjsKICAgIH0KfQo=\n","encoding":"base64"}

