{"sha":"91aae77fe2e00487c929b69cfd1be416f6e0c67d","node_id":"MDQ6QmxvYjE1NzU5NTY6OTFhYWU3N2ZlMmUwMDQ4N2M5MjliNjljZmQxYmU0MTZmNmUwYzY3ZA==","size":4674,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/91aae77fe2e00487c929b69cfd1be416f6e0c67d","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdC5Cb29rS2Vl\ncGVyQ2x1c3RlclRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnRlc3QuVGVzdENhbGxiYWNrczsKCmltcG9ydCBqYXZhLnV0aWwuTGlz\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5uZXQuQm9va2llU29j\na2V0QWRkcmVzczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci56b29r\nZWVwZXIuWm9vS2VlcGVyV2F0Y2hlckJhc2U7CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VySGFuZGxl\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJI\nYW5kbGVBZGFwdGVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNs\naWVudC5MZWRnZXJNZXRhZGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY29uZi5UZXN0QktDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyTWFuYWdlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlck1hbmFn\nZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEu\nTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXI7CgppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnV0aWwuWmtVdGlsczsKCmltcG9ydCBvcmcuYXBh\nY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuanVuaXQuQmVm\nb3JlOwppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0\nLlRlc3Q7CmltcG9ydCBzdGF0aWMgb3JnLmp1bml0LkFzc2VydC5hc3NlcnRF\ncXVhbHM7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5z\nbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFRoaXMgdGVzdCB2ZXJpZmll\ncyB0aGF0IHRoZSBwZXJpb2QgY2hlY2sgb24gdGhlIGF1ZGl0b3IKICogd2ls\nbCBwaWNrIHVwIG9uIG1pc3NpbmcgZGF0YSBpbiB0aGUgY2xpZW50CiAqLwpw\ndWJsaWMgY2xhc3MgQXVkaXRvclBlcmlvZGljQm9va2llQ2hlY2tUZXN0IGV4\ndGVuZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CiAgICBwcml2YXRl\nIGZpbmFsIHN0YXRpYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeQogICAg\nICAgICAgICAuZ2V0TG9nZ2VyKEF1ZGl0b3JQZXJpb2RpY0Jvb2tpZUNoZWNr\nVGVzdC5jbGFzcyk7CgogICAgcHJpdmF0ZSBBdWRpdG9yRWxlY3RvciBhdWRp\ndG9yRWxlY3RvciA9IG51bGw7CiAgICBwcml2YXRlIFpvb0tlZXBlciBhdWRp\ndG9yWm9va2VlcGVyID0gbnVsbDsKCiAgICBwcml2YXRlIGZpbmFsIHN0YXRp\nYyBpbnQgQ0hFQ0tfSU5URVJWQUwgPSAxOyAvLyBydW4gZXZlcnkgc2Vjb25k\nCgogICAgcHVibGljIEF1ZGl0b3JQZXJpb2RpY0Jvb2tpZUNoZWNrVGVzdCgp\nIHsKICAgICAgICBzdXBlcigzKTsKICAgICAgICBiYXNlQ29uZi5zZXRQYWdl\nTGltaXQoMSk7IC8vIHRvIG1ha2UgaXQgZWFzeSB0byBwdXNoIGxlZGdlciBv\ndXQgb2YgY2FjaGUKICAgIH0KCiAgICBAQmVmb3JlCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgc3VwZXIuc2V0VXAoKTsKCiAgICAgICAgU2VydmVyQ29uZmlndXJh\ndGlvbiBjb25mID0gVGVzdEJLQ29uZmlndXJhdGlvbi5uZXdTZXJ2ZXJDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgY29uZi5zZXRBdWRpdG9yUGVyaW9kaWNC\nb29raWVDaGVja0ludGVydmFsKENIRUNLX0lOVEVSVkFMKTsKICAgICAgICBT\ndHJpbmcgYWRkciA9IGJzLmdldCgwKS5nZXRMb2NhbEFkZHJlc3MoKS50b1N0\ncmluZygpOwoKICAgICAgICBab29LZWVwZXJXYXRjaGVyQmFzZSB3ID0gbmV3\nIFpvb0tlZXBlcldhdGNoZXJCYXNlKDEwMDAwKTsKICAgICAgICBhdWRpdG9y\nWm9va2VlcGVyID0gWmtVdGlscy5jcmVhdGVDb25uZWN0ZWRab29rZWVwZXJD\nbGllbnQoCiAgICAgICAgICAgICAgICB6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29u\nbmVjdFN0cmluZygpLCB3KTsKCiAgICAgICAgYXVkaXRvckVsZWN0b3IgPSBu\nZXcgQXVkaXRvckVsZWN0b3IoYWRkciwgY29uZiwKICAgICAgICAgICAgICAg\nIGF1ZGl0b3Jab29rZWVwZXIpOwogICAgICAgIGF1ZGl0b3JFbGVjdG9yLnN0\nYXJ0KCk7CiAgICB9CgogICAgQEFmdGVyCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgYXVkaXRvckVsZWN0b3Iuc2h1dGRvd24oKTsKICAgICAgICBhdWRpdG9y\nWm9va2VlcGVyLmNsb3NlKCk7CgogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgdGhlIHBlcmlvZGlj\nIGJvb2tpZSBjaGVja2VyIHdvcmtzCiAgICAgKi8KICAgIEBUZXN0KHRpbWVv\ndXQ9MzAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0UGVyaW9kaWNCb29raWVD\naGVja0ludGVydmFsKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTGVk\nZ2VyTWFuYWdlckZhY3RvcnkgbUZhY3RvcnkgPSBMZWRnZXJNYW5hZ2VyRmFj\ndG9yeS5uZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeShic0NvbmZzLmdldCgwKSwg\nemtjKTsKICAgICAgICBMZWRnZXJNYW5hZ2VyIGxlZGdlck1hbmFnZXIgPSBt\nRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyKCk7CiAgICAgICAgZmluYWwgTGVk\nZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIgdW5kZXJSZXBsaWNhdGlvbk1h\nbmFnZXIgPSBtRmFjdG9yeS5uZXdMZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFu\nYWdlcigpOwogICAgICAgIGZpbmFsIGludCBudW1MZWRnZXJzID0gMTsKCiAg\nICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLmNyZWF0ZUxlZGdlcigzLCAz\nLCBEaWdlc3RUeXBlLkNSQzMyLCAicGFzc3dkIi5nZXRCeXRlcygpKTsKICAg\nICAgICBMZWRnZXJNZXRhZGF0YSBtZCA9IExlZGdlckhhbmRsZUFkYXB0ZXIu\nZ2V0TGVkZ2VyTWV0YWRhdGEobGgpOwogICAgICAgIExpc3Q8Qm9va2llU29j\na2V0QWRkcmVzcz4gZW5zZW1ibGUgPSBtZC5nZXRFbnNlbWJsZXMoKS5nZXQo\nMEwpOwogICAgICAgIGVuc2VtYmxlLnNldCgwLCBuZXcgQm9va2llU29ja2V0\nQWRkcmVzcygiMS4xLjEuMSIsIDEwMDApKTsKCiAgICAgICAgVGVzdENhbGxi\nYWNrcy5HZW5lcmljQ2FsbGJhY2tGdXR1cmU8Vm9pZD4gY2IgPSBuZXcgVGVz\ndENhbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2tGdXR1cmU8Vm9pZD4oKTsKICAg\nICAgICBsZWRnZXJNYW5hZ2VyLndyaXRlTGVkZ2VyTWV0YWRhdGEobGguZ2V0\nSWQoKSwgbWQsIGNiKTsKICAgICAgICBjYi5nZXQoKTsKCiAgICAgICAgbG9u\nZyB1bmRlclJlcGxpY2F0ZWRMZWRnZXIgPSAtMTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgdW5kZXJSZXBs\naWNhdGVkTGVkZ2VyID0gdW5kZXJSZXBsaWNhdGlvbk1hbmFnZXIucG9sbExl\nZGdlclRvUmVyZXBsaWNhdGUoKTsKICAgICAgICAgICAgaWYgKHVuZGVyUmVw\nbGljYXRlZExlZGdlciAhPSAtMSkgewogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgVGhyZWFkLnNsZWVwKENIRUNL\nX0lOVEVSVkFMKjEwMDApOwogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVh\nbHMoIkxlZGdlciBzaG91bGQgYmUgdW5kZXIgcmVwbGljYXRlZCIsIGxoLmdl\ndElkKCksIHVuZGVyUmVwbGljYXRlZExlZGdlcik7CiAgICB9Cn0K\n","encoding":"base64"}

