{"sha":"2ece28dd2d2eec2f2fd8aa11221915b9c1eddc1f","node_id":"MDQ6QmxvYjE1NzU5NTY6MmVjZTI4ZGQyZDJlZWMyZjJmZDhhYTExMjIxOTE1YjljMWVkZGMxZg==","size":13730,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2ece28dd2d2eec2f2fd8aa11221915b9c1eddc1f","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdDsKCi8qCiAqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAqLwoKaW1w\nb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLm5pby5CeXRl\nQnVmZmVyOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGph\ndmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRpbC5SYW5kb207\nCgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0Nh\nbGxiYWNrLkFkZENhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuQm9va0tlZXBlclRlc3RDbGllbnQ7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckVudHJ5OwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2Fs\nbGJhY2suUmVhZENhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2VzdFR5cGU7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2llU2VydmVyOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5p\ndC5UZXN0OwoKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7Cgov\nKioKICogVGhpcyB0ZXN0IHRlc3RzIHJlYWQgYW5kIHdyaXRlLCBzeW5jaHJv\nbm91cyBhbmQgYXN5bmNocm9ub3VzLCBzdHJpbmdzIGFuZAogKiBpbnRlZ2Vy\ncyBmb3IgYSBCb29rS2VlcGVyIGNsaWVudC4gVGhlIHRlc3QgZGVwbG95bWVu\ndCB1c2VzIGEgWm9vS2VlcGVyIHNlcnZlcgogKiBhbmQgdGhyZWUgQm9va0tl\nZXBlcnMuCiAqCiAqLwoKcHVibGljIGNsYXNzIEJvb2tpZUZhaWx1cmVUZXN0\nIGV4dGVuZHMgTXVsdGlMZWRnZXJNYW5hZ2VyTXVsdGlEaWdlc3RUZXN0Q2Fz\nZQogICAgaW1wbGVtZW50cyBBZGRDYWxsYmFjaywgUmVhZENhbGxiYWNrIHsK\nCiAgICAvLyBEZXBlbmRpbmcgb24gdGhlIHRhc3RlLCBzZWxlY3QgdGhlIGFt\nb3VudCBvZiBsb2dnaW5nCiAgICAvLyBieSBkZWNvbW1lbnRpbmcgb25lIG9m\nIHRoZSB0d28gbGluZXMgYmVsb3cKICAgIC8vIHByaXZhdGUgZmluYWwgc3Rh\ndGljIExvZ2dlciBMT0cgPSBMb2dnZXIuZ2V0Um9vdExvZ2dlcigpOwogICAg\ncHJpdmF0ZSBmaW5hbCBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3Rv\ncnkuZ2V0TG9nZ2VyKEJvb2tpZUZhaWx1cmVUZXN0LmNsYXNzKTsKCiAgICBi\neXRlW10gbGVkZ2VyUGFzc3dvcmQgPSAiYWFhIi5nZXRCeXRlcygpOwogICAg\nTGVkZ2VySGFuZGxlIGxoLCBsaDI7CiAgICBsb25nIGxlZGdlcklkOwoKICAg\nIC8vIHRlc3QgcmVsYXRlZCB2YXJpYWJsZXMKICAgIGludCBudW1FbnRyaWVz\nVG9Xcml0ZSA9IDIwMDsKICAgIGludCBtYXhJbnQgPSAyMTQ3NDgzNjQ3Owog\nICAgUmFuZG9tIHJuZzsgLy8gUmFuZG9tIE51bWJlciBHZW5lcmF0b3IKICAg\nIEFycmF5TGlzdDxieXRlW10+IGVudHJpZXM7IC8vIGdlbmVyYXRlZCBlbnRy\naWVzCiAgICBBcnJheUxpc3Q8SW50ZWdlcj4gZW50cmllc1NpemU7CiAgICBE\naWdlc3RUeXBlIGRpZ2VzdFR5cGU7CgogICAgY2xhc3MgU3luY09iaiB7CiAg\nICAgICAgaW50IGNvdW50ZXI7CiAgICAgICAgYm9vbGVhbiB2YWx1ZTsKICAg\nICAgICBib29sZWFuIGZhaWx1cmVPY2N1cnJlZDsKICAgICAgICBFbnVtZXJh\ndGlvbjxMZWRnZXJFbnRyeT4gbHM7CgogICAgICAgIHB1YmxpYyBTeW5jT2Jq\nKCkgewogICAgICAgICAgICBjb3VudGVyID0gMDsKICAgICAgICAgICAgdmFs\ndWUgPSBmYWxzZTsKICAgICAgICAgICAgZmFpbHVyZU9jY3VycmVkID0gZmFs\nc2U7CiAgICAgICAgICAgIGxzID0gbnVsbDsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIEJvb2tpZUZhaWx1cmVUZXN0KFN0cmluZyBsZWRnZXJNYW5h\nZ2VyRmFjdG9yeSwgRGlnZXN0VHlwZSBkaWdlc3RUeXBlKSB7CiAgICAgICAg\nc3VwZXIoNCk7CiAgICAgICAgdGhpcy5kaWdlc3RUeXBlID0gZGlnZXN0VHlw\nZTsKICAgICAgICAvLyBzZXQgbGVkZ2VyIG1hbmFnZXIKICAgICAgICBiYXNl\nQ29uZi5zZXRMZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNzTmFtZShsZWRnZXJN\nYW5hZ2VyRmFjdG9yeSk7CiAgICAgICAgYmFzZUNsaWVudENvbmYuc2V0TGVk\nZ2VyTWFuYWdlckZhY3RvcnlDbGFzc05hbWUobGVkZ2VyTWFuYWdlckZhY3Rv\ncnkpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdHMgd3JpdGVzIGFuZCBy\nZWFkcyB3aGVuIGEgYm9va2llIGZhaWxzLgogICAgICoKICAgICAqIEB0aHJv\nd3Mge0BsaW5rIElPRXhjZXB0aW9ufQogICAgICovCiAgICBAVGVzdCh0aW1l\nb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdEFzeW5jQksxKCkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBMT0cuaW5mbygiIyMjIyBCSzEg\nIyMjIyIpOwogICAgICAgIGF1eFRlc3RSZWFkV3JpdGVBc3luY1NpbmdsZUNs\naWVudChicy5nZXQoMCkpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAw\nMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0QXN5bmNCSzIoKSB0aHJvd3MgSU9F\neGNlcHRpb24gewogICAgICAgIExPRy5pbmZvKCIjIyMjIEJLMiAjIyMjIik7\nCiAgICAgICAgYXV4VGVzdFJlYWRXcml0ZUFzeW5jU2luZ2xlQ2xpZW50KGJz\nLmdldCgxKSk7CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAg\nIHB1YmxpYyB2b2lkIHRlc3RBc3luY0JLMygpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgTE9HLmluZm8oIiMjIyMgQkszICMjIyMiKTsKICAgICAg\nICBhdXhUZXN0UmVhZFdyaXRlQXN5bmNTaW5nbGVDbGllbnQoYnMuZ2V0KDIp\nKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGlj\nIHZvaWQgdGVzdEFzeW5jQks0KCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBMT0cuaW5mbygiIyMjIyBCSzQgIyMjIyIpOwogICAgICAgIGF1eFRl\nc3RSZWFkV3JpdGVBc3luY1NpbmdsZUNsaWVudChicy5nZXQoMykpOwogICAg\nfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0\nZXN0Qm9va2llUmVjb3ZlcnkoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICAvL1NodXRkb3duIGFsbCBidXQgMSBib29raWUKICAgICAgICBicy5nZXQo\nMCkuc2h1dGRvd24oKTsKICAgICAgICBicy5nZXQoMSkuc2h1dGRvd24oKTsK\nICAgICAgICBicy5nZXQoMikuc2h1dGRvd24oKTsKCiAgICAgICAgYnl0ZVtd\nIHBhc3N3ZCA9ICJibGFoIi5nZXRCeXRlcygpOwogICAgICAgIExlZGdlckhh\nbmRsZSBsaCA9IGJrYy5jcmVhdGVMZWRnZXIoMSwgMSxkaWdlc3RUeXBlLCBw\nYXNzd2QpOwoKICAgICAgICBpbnQgbnVtRW50cmllcyA9IDEwMDsKICAgICAg\nICBmb3IgKGludCBpPTA7IGk8IG51bUVudHJpZXM7IGkrKykgewogICAgICAg\nICAgICBieXRlW10gZGF0YSA9ICgiIitpKS5nZXRCeXRlcygpOwogICAgICAg\nICAgICBsaC5hZGRFbnRyeShkYXRhKTsKICAgICAgICB9CgogICAgICAgIGJz\nLmdldCgzKS5zaHV0ZG93bigpOwogICAgICAgIEJvb2tpZVNlcnZlciBzZXJ2\nZXIgPSBuZXcgQm9va2llU2VydmVyKGJzQ29uZnMuZ2V0KDMpKTsKICAgICAg\nICBzZXJ2ZXIuc3RhcnQoKTsKICAgICAgICBicy5zZXQoMywgc2VydmVyKTsK\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bUVudHJpZXMgLSAxICwgbGguZ2V0\nTGFzdEFkZENvbmZpcm1lZCgpKTsKICAgICAgICBFbnVtZXJhdGlvbjxMZWRn\nZXJFbnRyeT4gZW50cmllcyA9IGxoLnJlYWRFbnRyaWVzKDAsIGxoLmdldExh\nc3RBZGRDb25maXJtZWQoKSk7CgogICAgICAgIGludCBudW1TY2FubmVkID0g\nMDsKICAgICAgICB3aGlsZSAoZW50cmllcy5oYXNNb3JlRWxlbWVudHMoKSkg\newogICAgICAgICAgICBhc3NlcnRFcXVhbHMoKCIiK251bVNjYW5uZWQpLCBu\nZXcgU3RyaW5nKGVudHJpZXMubmV4dEVsZW1lbnQoKS5nZXRFbnRyeSgpKSk7\nCiAgICAgICAgICAgIG51bVNjYW5uZWQrKzsKICAgICAgICB9CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKG51bUVudHJpZXMsIG51bVNjYW5uZWQpOwogICAgfQoK\nICAgIHZvaWQgYXV4VGVzdFJlYWRXcml0ZUFzeW5jU2luZ2xlQ2xpZW50KEJv\nb2tpZVNlcnZlciBicykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBT\neW5jT2JqIHN5bmMgPSBuZXcgU3luY09iaigpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIC8vIENyZWF0ZSBhIGxlZGdlcgogICAgICAgICAgICBsaCA9\nIGJrYy5jcmVhdGVMZWRnZXIoMywgMiwgZGlnZXN0VHlwZSwgbGVkZ2VyUGFz\nc3dvcmQpOwoKICAgICAgICAgICAgbGVkZ2VySWQgPSBsaC5nZXRJZCgpOwog\nICAgICAgICAgICBMT0cuaW5mbygiTGVkZ2VyIElEOiAiICsgbGguZ2V0SWQo\nKSk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRW50cmll\nc1RvV3JpdGU7IGkrKykgewogICAgICAgICAgICAgICAgQnl0ZUJ1ZmZlciBl\nbnRyeSA9IEJ5dGVCdWZmZXIuYWxsb2NhdGUoNCk7CiAgICAgICAgICAgICAg\nICBlbnRyeS5wdXRJbnQocm5nLm5leHRJbnQobWF4SW50KSk7CiAgICAgICAg\nICAgICAgICBlbnRyeS5wb3NpdGlvbigwKTsKCiAgICAgICAgICAgICAgICBl\nbnRyaWVzLmFkZChlbnRyeS5hcnJheSgpKTsKICAgICAgICAgICAgICAgIGVu\ndHJpZXNTaXplLmFkZChlbnRyeS5hcnJheSgpLmxlbmd0aCk7CiAgICAgICAg\nICAgICAgICBsaC5hc3luY0FkZEVudHJ5KGVudHJ5LmFycmF5KCksIHRoaXMs\nIHN5bmMpOwoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgTE9HLmluZm8o\nIldyb3RlICIgKyBudW1FbnRyaWVzVG9Xcml0ZSArICIgYW5kIG5vdyBnb2lu\nZyB0byBmYWlsIGJvb2tpZS4iKTsKICAgICAgICAgICAgLy8gQm9va2llIGZh\naWwKICAgICAgICAgICAgYnMuc2h1dGRvd24oKTsKCiAgICAgICAgICAgIC8v\nIHdhaXQgZm9yIGFsbCBlbnRyaWVzIHRvIGJlIGFja25vd2xlZGdlZAogICAg\nICAgICAgICBzeW5jaHJvbml6ZWQgKHN5bmMpIHsKICAgICAgICAgICAgICAg\nIHdoaWxlIChzeW5jLmNvdW50ZXIgPCBudW1FbnRyaWVzVG9Xcml0ZSkgewog\nICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiRW50cmllcyBjb3VudGVy\nID0gIiArIHN5bmMuY291bnRlcik7CiAgICAgICAgICAgICAgICAgICAgc3lu\nYy53YWl0KDEwMDAwKTsKICAgICAgICAgICAgICAgICAgICBhc3NlcnRGYWxz\nZSgiRmFpbHVyZSBvY2N1cnJlZCBkdXJpbmcgd3JpdGUiLCBzeW5jLmZhaWx1\ncmVPY2N1cnJlZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIExPRy5kZWJ1ZygiKioqIFdSSVRFIENPTVBMRVRFICoq\nKiIpOwogICAgICAgICAgICAvLyBjbG9zZSBsZWRnZXIKICAgICAgICAgICAg\nbGguY2xvc2UoKTsKCiAgICAgICAgICAgIC8vICoqKiBXUklUSU5HIFBBUlQg\nQ09NUExFVEUgLy8gUkVBRCBQQVJUIEJFR0lOUyAqKioKCiAgICAgICAgICAg\nIC8vIG9wZW4gbGVkZ2VyCiAgICAgICAgICAgIGJrYy5jbG9zZSgpOwogICAg\nICAgICAgICBia2MgPSBuZXcgQm9va0tlZXBlclRlc3RDbGllbnQoYmFzZUNs\naWVudENvbmYpOwogICAgICAgICAgICBsaCA9IGJrYy5vcGVuTGVkZ2VyKGxl\nZGdlcklkLCBkaWdlc3RUeXBlLCBsZWRnZXJQYXNzd29yZCk7CiAgICAgICAg\nICAgIExPRy5kZWJ1ZygiTnVtYmVyIG9mIGVudHJpZXMgd3JpdHRlbjogIiAr\nIChsaC5nZXRMYXN0QWRkQ29uZmlybWVkKCkgKyAxKSk7CiAgICAgICAgICAg\nIGFzc2VydFRydWUoIlZlcmlmeWluZyBudW1iZXIgb2YgZW50cmllcyB3cml0\ndGVuIiwgbGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpID09IChudW1FbnRyaWVz\nVG9Xcml0ZSAtIDEpKTsKCiAgICAgICAgICAgIC8vIHJlYWQgZW50cmllcwoK\nICAgICAgICAgICAgbGguYXN5bmNSZWFkRW50cmllcygwLCBudW1FbnRyaWVz\nVG9Xcml0ZSAtIDEsIHRoaXMsIHN5bmMpOwoKICAgICAgICAgICAgc3luY2hy\nb25pemVkIChzeW5jKSB7CiAgICAgICAgICAgICAgICBpbnQgaSA9IDA7CiAg\nICAgICAgICAgICAgICBzeW5jLndhaXQoMTAwMDApOwogICAgICAgICAgICAg\nICAgYXNzZXJ0RmFsc2UoIkZhaWx1cmUgb2NjdXJyZWQgZHVyaW5nIHJlYWQi\nLCBzeW5jLmZhaWx1cmVPY2N1cnJlZCk7CiAgICAgICAgICAgICAgICBhc3Nl\ncnRUcnVlKCJIYXZlbid0IHJlY2VpdmVkIGVudHJpZXMiLCBzeW5jLnZhbHVl\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgTE9HLmRlYnVnKCIqKiog\nUkVBRCBDT01QTEVURSAqKioiKTsKCiAgICAgICAgICAgIC8vIGF0IHRoaXMg\ncG9pbnQsIEVudW1lcmF0aW9uPExlZGdlckVudHJ5PiBscyBpcyBmaWxsZWQg\nd2l0aCB0aGUgcmV0dXJuZWQKICAgICAgICAgICAgLy8gdmFsdWVzCiAgICAg\nICAgICAgIGludCBpID0gMDsKICAgICAgICAgICAgd2hpbGUgKHN5bmMubHMu\naGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgICAgIEJ5dGVCdWZm\nZXIgb3JpZ2JiID0gQnl0ZUJ1ZmZlci53cmFwKGVudHJpZXMuZ2V0KGkpKTsK\nICAgICAgICAgICAgICAgIEludGVnZXIgb3JpZ0VudHJ5ID0gb3JpZ2JiLmdl\ndEludCgpOwogICAgICAgICAgICAgICAgYnl0ZVtdIGVudHJ5ID0gc3luYy5s\ncy5uZXh0RWxlbWVudCgpLmdldEVudHJ5KCk7CiAgICAgICAgICAgICAgICBC\neXRlQnVmZmVyIHJlc3VsdCA9IEJ5dGVCdWZmZXIud3JhcChlbnRyeSk7Cgog\nICAgICAgICAgICAgICAgSW50ZWdlciByZXRyRW50cnkgPSByZXN1bHQuZ2V0\nSW50KCk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoIlJldHJpZXZlZCBl\nbnRyeTogIiArIGkpOwogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiQ2hl\nY2tpbmcgZW50cnkgIiArIGkgKyAiIGZvciBlcXVhbGl0eSIsIG9yaWdFbnRy\neS5lcXVhbHMocmV0ckVudHJ5KSk7CiAgICAgICAgICAgICAgICBhc3NlcnRU\ncnVlKCJDaGVja2luZyBlbnRyeSAiICsgaSArICIgZm9yIHNpemUiLCBlbnRy\neS5sZW5ndGggPT0gZW50cmllc1NpemUuZ2V0KGkpLmludFZhbHVlKCkpOwog\nICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBhc3NlcnRUcnVlKCJDaGVja2luZyBudW1iZXIgb2YgcmVhZCBlbnRyaWVz\nIiwgaSA9PSBudW1FbnRyaWVzVG9Xcml0ZSk7CgogICAgICAgICAgICBMT0cu\naW5mbygiVmVyaWZpZWQgdGhhdCBlbnRyaWVzIGFyZSBvaywgYW5kIG5vdyBj\nbG9zaW5nIGxlZGdlciIpOwogICAgICAgICAgICBsaC5jbG9zZSgpOwogICAg\nICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nIExPRy5lcnJvcigiQ2F1Z2h0IEtlZXBlckV4Y2VwdGlvbiIsIGUpOwogICAg\nICAgICAgICBmYWlsKGUudG9TdHJpbmcoKSk7CiAgICAgICAgfSBjYXRjaCAo\nQktFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkNhdWdo\ndCBCS0V4Y2VwdGlvbiIsIGUpOwogICAgICAgICAgICBmYWlsKGUudG9TdHJp\nbmcoKSk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkNhdWdodCBJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiIsIGUpOwogICAgICAgICAgICBmYWlsKGUudG9TdHJpbmco\nKSk7CiAgICAgICAgfQoKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyB2b2lkIGFkZENvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBs\nb25nIGVudHJ5SWQsIE9iamVjdCBjdHgpIHsKICAgICAgICBTeW5jT2JqIHgg\nPSAoU3luY09iaikgY3R4OwogICAgICAgIGlmIChyYyAhPSAwKSB7CiAgICAg\nICAgICAgIExPRy5lcnJvcigiRmFpbHVyZSBkdXJpbmcgYWRkIHt9IHt9Iiwg\nZW50cnlJZCwgcmMpOwogICAgICAgICAgICB4LmZhaWx1cmVPY2N1cnJlZCA9\nIHRydWU7CiAgICAgICAgfQogICAgICAgIHN5bmNocm9uaXplZCAoeCkgewog\nICAgICAgICAgICB4LmNvdW50ZXIrKzsKICAgICAgICAgICAgeC5ub3RpZnko\nKTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCByZWFkQ29tcGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUgbGgsIEVu\ndW1lcmF0aW9uPExlZGdlckVudHJ5PiBzZXEsIE9iamVjdCBjdHgpIHsKICAg\nICAgICBTeW5jT2JqIHggPSAoU3luY09iaikgY3R4OwogICAgICAgIGlmIChy\nYyAhPSAwKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiRmFpbHVyZSBkdXJp\nbmcgYWRkIHt9IiwgcmMpOwogICAgICAgICAgICB4LmZhaWx1cmVPY2N1cnJl\nZCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHN5bmNocm9uaXplZCAoeCkg\newogICAgICAgICAgICB4LnZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgeC5s\ncyA9IHNlcTsKICAgICAgICAgICAgeC5ub3RpZnkoKTsKICAgICAgICB9CiAg\nICB9CgogICAgQEJlZm9yZQogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNl\ndFVwKCk7CgogICAgICAgIHJuZyA9IG5ldyBSYW5kb20oU3lzdGVtLmN1cnJl\nbnRUaW1lTWlsbGlzKCkpOyAvLyBJbml0aWFsaXplIHRoZSBSYW5kb20KICAg\nICAgICAvLyBOdW1iZXIgR2VuZXJhdG9yCiAgICAgICAgZW50cmllcyA9IG5l\ndyBBcnJheUxpc3Q8Ynl0ZVtdPigpOyAvLyBpbml0aWFsaXplIHRoZSBlbnRy\naWVzIGxpc3QKICAgICAgICBlbnRyaWVzU2l6ZSA9IG5ldyBBcnJheUxpc3Q8\nSW50ZWdlcj4oKTsKCiAgICAgICAgemtjLmNsb3NlKCk7CiAgICB9CgogICAg\nQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RMZWRn\nZXJOb1JlY292ZXJ5T3BlbkFmdGVyQktDcmFzaGVkKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLy8gQ3JlYXRlIGEgbGVkZ2VyCiAgICAgICAgTGVk\nZ2VySGFuZGxlIGJlZm9yZWxoID0gYmtjLmNyZWF0ZUxlZGdlcihudW1Cb29r\naWVzLCBudW1Cb29raWVzLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsK\nCiAgICAgICAgaW50IG51bUVudHJpZXMgPSAxMDsKICAgICAgICBTdHJpbmcg\ndG1wID0gIkJvb2tLZWVwZXIgaXMgY29vbCEiOwogICAgICAgIGZvciAoaW50\nIGk9MDsgaTxudW1FbnRyaWVzOyBpKyspIHsKICAgICAgICAgICAgYmVmb3Jl\nbGguYWRkRW50cnkodG1wLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAg\nICAgLy8gc2h1dGRvd24gZmlyc3QgYm9va2llIHNlcnZlcgogICAgICAgIGtp\nbGxCb29raWUoMCk7CgogICAgICAgIC8vIHRyeSB0byBvcGVuIGxlZGdlciBu\nbyByZWNvdmVyeQogICAgICAgIExlZGdlckhhbmRsZSBhZnRlcmxoID0gYmtj\nLm9wZW5MZWRnZXJOb1JlY292ZXJ5KGJlZm9yZWxoLmdldElkKCksIGRpZ2Vz\ndFR5cGUsICIiLmdldEJ5dGVzKCkpOwoKICAgICAgICBhc3NlcnRFcXVhbHMo\nbnVtRW50cmllcyAtIDIsIGFmdGVybGguZ2V0TGFzdEFkZENvbmZpcm1lZCgp\nKTsKCiAgICAgICAgc3RhcnROZXdCb29raWUoKTsKICAgICAgICBMZWRnZXJI\nYW5kbGUgYmVmb3JlbGgyID0gYmtjLmNyZWF0ZUxlZGdlcihudW1Cb29raWVz\nLCAxLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKCiAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPG51bUVudHJpZXM7IGkrKykgewogICAgICAgICAgICBi\nZWZvcmVsaDIuYWRkRW50cnkodG1wLmdldEJ5dGVzKCkpOwogICAgICAgIH0K\nCiAgICAgICAgLy8gc2h1dGRvd24gZmlyc3QgYm9va2llIHNlcnZlcgogICAg\nICAgIGtpbGxCb29raWUoMCk7CgogICAgICAgIC8vIHRyeSB0byBvcGVuIGxl\nZGdlciBubyByZWNvdmVyeQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGJr\nYy5vcGVuTGVkZ2VyTm9SZWNvdmVyeShiZWZvcmVsaDIuZ2V0SWQoKSwgZGln\nZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgICAgIGZhaWwoIlNo\nb3VsZCBoYXZlIHRocm93biBleGNlcHRpb24iKTsKICAgICAgICB9IGNhdGNo\nIChCS0V4Y2VwdGlvbi5CS1JlYWRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAvLyBjb3JyZWN0IGJlaGF2aW91cgogICAgICAgIH0KICAgIH0KCiAgICBA\nVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdExlZGdl\nck9wZW5BZnRlckJLQ3Jhc2hlZCgpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIC8vIENyZWF0ZSBhIGxlZGdlcgogICAgICAgIExlZGdlckhhbmRsZSBi\nZWZvcmVsaCA9IGJrYy5jcmVhdGVMZWRnZXIobnVtQm9va2llcywgbnVtQm9v\na2llcywgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CgogICAgICAgIGlu\ndCBudW1FbnRyaWVzID0gMTA7CiAgICAgICAgU3RyaW5nIHRtcCA9ICJCb29r\nS2VlcGVyIGlzIGNvb2whIjsKICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVt\nRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGJlZm9yZWxoLmFkZEVudHJ5\nKHRtcC5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAgICAgIC8vIHNodXRk\nb3duIGZpcnN0IGJvb2tpZSBzZXJ2ZXIKICAgICAgICBraWxsQm9va2llKDAp\nOwogICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CgogICAgICAgIC8vIHRyeSB0\nbyBvcGVuIGxlZGdlciBubyByZWNvdmVyeQogICAgICAgIExlZGdlckhhbmRs\nZSBhZnRlcmxoID0gYmtjLm9wZW5MZWRnZXIoYmVmb3JlbGguZ2V0SWQoKSwg\nZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CgogICAgICAgIGFzc2VydEVx\ndWFscyhiZWZvcmVsaC5nZXRMYXN0QWRkUHVzaGVkKCksIGFmdGVybGguZ2V0\nTGFzdEFkZENvbmZpcm1lZCgpKTsKCiAgICAgICAgTGVkZ2VySGFuZGxlIGJl\nZm9yZWxoMiA9IGJrYy5jcmVhdGVMZWRnZXIobnVtQm9va2llcywgMSwgZGln\nZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CgogICAgICAgIGZvciAoaW50IGk9\nMDsgaTxudW1FbnRyaWVzOyBpKyspIHsKICAgICAgICAgICAgYmVmb3JlbGgy\nLmFkZEVudHJ5KHRtcC5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAgICAg\nIC8vIHNodXRkb3duIGZpcnN0IGJvb2tpZSBzZXJ2ZXIKICAgICAgICBraWxs\nQm9va2llKDApOwoKICAgICAgICAvLyB0cnkgdG8gb3BlbiBsZWRnZXIgbm8g\ncmVjb3ZlcnkKICAgICAgICB0cnkgewogICAgICAgICAgICBia2Mub3Blbkxl\nZGdlcihiZWZvcmVsaDIuZ2V0SWQoKSwgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0\nZXMoKSk7CiAgICAgICAgICAgIGZhaWwoIlNob3VsZCBoYXZlIHRocm93biBl\neGNlcHRpb24iKTsKICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5CS0xl\nZGdlclJlY292ZXJ5RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gY29y\ncmVjdCBiZWhhdmlvdXIKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBWZXJpZnkgcmVhZCBsYXN0IGNvbmZpcm1lZCBvcCwgaXQgc2hvdWxkbid0\nIGNhdXNlIGFueSBkZWFkbG9jayBhcyBuZXcKICAgICAqIGJvb2tpZSBjb25u\nZWN0aW9uIGlzIGJlaW5nIGVzdGFibGlzaGVkIGFuZCByZXR1cm5pbmcgdGhl\nIGNvbm5lY3Rpb24KICAgICAqIG5vdGlmaWNhdGlvbiBpbiB0aGUgc2FtZSBj\nYWxsZXIgdGhyZWFkLiBJdCB3b3VsZCBiZSBzaW11bGF0ZWQgYnkgZGVsYXlp\nbmcKICAgICAqIHRoZSBmdXR1cmUuYWRkbGlzdGVuZXIoKSBpbiBQZXJDaGFu\nbmVsQm9va2llQ2xpZW50IGFmdGVyIHRoZSBjb25uZWN0aW9uCiAgICAgKiBl\nc3RhYmxpc2htZW50LiBOb3cgdGhlIGZ1dHVyZS5hZGRsaXN0ZW5lcigpIHdp\nbGwgbm90aWZ5IGJhY2sgaW4gdGhlIHNhbWUKICAgICAqIHRocmVhZCBhbmQg\nc2ltdWx0YW5lb3VzbHkgaW52b2tlIHRoZSBwZW5kaW5nT3Aub3BlcmF0aW9u\nQ29tcGxldGUoKSBldmVudC4KICAgICAqCiAgICAgKiBCT09LS0VFUEVSLTMy\nNgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGlj\nIHZvaWQgdGVzdFJlYWRMYXN0Q29uZmlybWVkT3AoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBzdGFydE5ld0Jvb2tpZSgpOwogICAgICAgIHN0YXJ0\nTmV3Qm9va2llKCk7CiAgICAgICAgLy8gQ3JlYXRlIGEgbGVkZ2VyCiAgICAg\nICAgTGVkZ2VySGFuZGxlIGJlZm9yZWxoID0gYmtjLmNyZWF0ZUxlZGdlcihu\ndW1Cb29raWVzICsgMiwKICAgICAgICAgICAgICAgIG51bUJvb2tpZXMgKyAy\nLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKCiAgICAgICAgaW50IG51\nbUVudHJpZXMgPSAxMDsKICAgICAgICBTdHJpbmcgdG1wID0gIkJvb2tLZWVw\nZXIgaXMgY29vbCEiOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVt\nRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGJlZm9yZWxoLmFkZEVudHJ5\nKHRtcC5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAgICAgIC8vIHNodXRk\nb3duIGZpcnN0IGJvb2tpZSBzZXJ2ZXIKICAgICAgICBraWxsQm9va2llKDAp\nOwogICAgICAgIHN0YXJ0TmV3Qm9va2llKCk7CgogICAgICAgIC8vIGNyZWF0\nZSBuZXcgYm9va2llIGNsaWVudCwgYW5kIGZvcmNpbmcgdG8gZXN0YWJsaXNo\nIG5ldwogICAgICAgIC8vIFBlckNoYW5uZWxCb29raWVDbGllbnQgY29ubmVj\ndGlvbnMgZm9yIHJlY292ZXJ5IGZsb3dzLgogICAgICAgIEJvb2tLZWVwZXJU\nZXN0Q2xpZW50IGJrYzEgPSBuZXcgQm9va0tlZXBlclRlc3RDbGllbnQoYmFz\nZUNsaWVudENvbmYpOwogICAgICAgIC8vIHRyeSB0byBvcGVuIGxlZGdlciB3\naXRoIHJlY292ZXJ5CiAgICAgICAgTGVkZ2VySGFuZGxlIGFmdGVybGggPSBi\na2MxLm9wZW5MZWRnZXIoYmVmb3JlbGguZ2V0SWQoKSwgZGlnZXN0VHlwZSwg\nIiIKICAgICAgICAgICAgICAgIC5nZXRCeXRlcygpKTsKCiAgICAgICAgYXNz\nZXJ0RXF1YWxzKCJFbnRyaWVzIGdvdCBtaXNzZWQiLCBiZWZvcmVsaC5nZXRM\nYXN0QWRkUHVzaGVkKCksIGFmdGVybGgKICAgICAgICAgICAgICAgIC5nZXRM\nYXN0QWRkQ29uZmlybWVkKCkpOwogICAgICAgIGJrYzEuY2xvc2UoKTsKICAg\nIH0KfQo=\n","encoding":"base64"}

