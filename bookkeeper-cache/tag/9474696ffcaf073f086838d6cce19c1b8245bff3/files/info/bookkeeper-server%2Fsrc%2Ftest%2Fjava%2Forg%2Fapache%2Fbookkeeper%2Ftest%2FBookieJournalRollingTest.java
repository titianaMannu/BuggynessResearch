{"sha":"a72bf578cddb3bd34526a9b1c107eabf541dff49","node_id":"MDQ6QmxvYjE1NzU5NTY6YTcyYmY1NzhjZGRiM2JkMzQ1MjZhOWIxYzEwN2VhYmY1NDFkZmY0OQ==","size":9885,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a72bf578cddb3bd34526a9b1c107eabf541dff49","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdDsKCi8qCiAqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAqLwppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9u\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0Y2g7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWljSW50\nZWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFz\neW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2VzdFR5cGU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckVudHJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJI\nYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5TZXJ2\nZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNvbmYuVGVzdEJLQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5qdW5pdC5B\nZnRlcjsKaW1wb3J0IG9yZy5qdW5pdC5Bc3NlcnQ7CmltcG9ydCBvcmcuanVu\naXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1bml0LlRlc3Q7CmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7\nCgppbXBvcnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCi8qKgogKiBU\naGlzIGNsYXNzIHRlc3RzIHRoYXQgYm9va2llIHJvbGxpbmcgam91cm5hbHMK\nICovCnB1YmxpYyBjbGFzcyBCb29raWVKb3VybmFsUm9sbGluZ1Rlc3QgZXh0\nZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKICAgIHByaXZhdGUg\nZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihCb29raWVKb3VybmFsUm9sbGluZ1Rlc3QuY2xhc3MpOwoKICAgIERp\nZ2VzdFR5cGUgZGlnZXN0VHlwZTsKCiAgICBwdWJsaWMgQm9va2llSm91cm5h\nbFJvbGxpbmdUZXN0KCkgewogICAgICAgIHN1cGVyKDEpOwogICAgICAgIHRo\naXMuZGlnZXN0VHlwZSA9IERpZ2VzdFR5cGUuQ1JDMzI7CiAgICB9CgogICAg\nQEJlZm9yZQogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIFNldCB1cCB0aGUgY29u\nZmlndXJhdGlvbiBwcm9wZXJ0aWVzIG5lZWRlZC4KICAgICAgICBiYXNlQ29u\nZi5zZXRNYXhKb3VybmFsU2l6ZU1CKDEpOwogICAgICAgIGJhc2VDb25mLnNl\ndE1heEJhY2t1cEpvdXJuYWxzKDEpOwogICAgICAgIHN1cGVyLnNldFVwKCk7\nCiAgICB9CgogICAgQEFmdGVyCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3Vw\nZXIudGVhckRvd24oKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbW1vbiBt\nZXRob2QgdG8gY3JlYXRlIGxlZGdlcnMgYW5kIHdyaXRlIGVudHJpZXMgdG8g\ndGhlbS4KICAgICAqLwogICAgcHJpdmF0ZSBMZWRnZXJIYW5kbGVbXSB3cml0\nZUxlZGdlckVudHJpZXMoaW50IG51bUxlZGdlcnMsIGludCBtc2dTaXplLCBp\nbnQgbnVtTXNncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gQ3Jl\nYXRlIHRoZSBsZWRnZXJzCiAgICAgICAgTGVkZ2VySGFuZGxlW10gbGhzID0g\nbmV3IExlZGdlckhhbmRsZVtudW1MZWRnZXJzXTsKICAgICAgICBsb25nW10g\nbGVkZ2VySWRzID0gbmV3IGxvbmdbbnVtTGVkZ2Vyc107CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBudW1MZWRnZXJzOyBpKyspIHsKICAgICAgICAg\nICAgbGhzW2ldID0gYmtjLmNyZWF0ZUxlZGdlcigxLCAxLCBkaWdlc3RUeXBl\nLCAiIi5nZXRCeXRlcygpKTsKICAgICAgICAgICAgbGVkZ2VySWRzW2ldID0g\nbGhzW2ldLmdldElkKCk7CiAgICAgICAgfQogICAgICAgIHdyaXRlTGVkZ2Vy\nRW50cmllcyhsaHMsIG1zZ1NpemUsIG51bU1zZ3MpOwogICAgICAgIC8vIFJl\ndHVybiB0aGUgbGVkZ2VyIGhhbmRsZXMgdG8gdGhlIGluc2VydGVkIGxlZGdl\ncnMgYW5kIGVudHJpZXMKICAgICAgICByZXR1cm4gbGhzOwogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCB3cml0ZUxlZGdlckVudHJpZXMoTGVkZ2VySGFuZGxl\nW10gbGhzLCBpbnQgbXNnU2l6ZSwgaW50IG51bU1zZ3MpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIC8vIENyZWF0ZSBhIGR1bW15IG1lc3NhZ2Ugc3Ry\naW5nIHRvIHdyaXRlIGFzIGxlZGdlciBlbnRyaWVzCiAgICAgICAgU3RyaW5n\nQnVpbGRlciBtc2dTQiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBtc2dTaXplOyBpKyspIHsKICAgICAgICAg\nICAgbXNnU0IuYXBwZW5kKCJhIik7CiAgICAgICAgfQogICAgICAgIFN0cmlu\nZyBtc2cgPSBtc2dTQi50b1N0cmluZygpOwoKICAgICAgICBmaW5hbCBDb3Vu\ndERvd25MYXRjaCBjb21wbGV0ZUxhdGNoID0gbmV3IENvdW50RG93bkxhdGNo\nKG51bU1zZ3MqbGhzLmxlbmd0aCk7CiAgICAgICAgZmluYWwgQXRvbWljSW50\nZWdlciByYyA9IG5ldyBBdG9taWNJbnRlZ2VyKEJLRXhjZXB0aW9uLkNvZGUu\nT0spOwoKICAgICAgICAvLyBXcml0ZSBhbGwgb2YgdGhlIGVudHJpZXMgZm9y\nIGFsbCBvZiB0aGUgbGVkZ2VycwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbnVtTXNnczsgaSsrKSB7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAw\nOyBqIDwgbGhzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBTdHJp\nbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAg\nICAgICAgIHNiLmFwcGVuZChsaHNbal0uZ2V0SWQoKSkuYXBwZW5kKCctJyku\nYXBwZW5kKGkpLmFwcGVuZCgnLScpCiAgICAgICAgICAgICAgICAgIC5hcHBl\nbmQobXNnKTsKICAgICAgICAgICAgICAgIGxoc1tqXS5hc3luY0FkZEVudHJ5\nKHNiLnRvU3RyaW5nKCkuZ2V0Qnl0ZXMoKSwgbmV3IEFkZENhbGxiYWNrKCkg\newogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRDb21w\nbGV0ZShpbnQgcmMyLCBMZWRnZXJIYW5kbGUgbGgsIGxvbmcgZW50cnlJZCwg\nT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMu\nY29tcGFyZUFuZFNldChCS0V4Y2VwdGlvbi5Db2RlLk9LLCByYzIpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGVMYXRjaC5jb3VudERv\nd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIH0sIG51bGwpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIGNvbXBsZXRlTGF0Y2guYXdhaXQoKTsKICAgICAgICBpZiAocmMuZ2V0\nKCkgIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAgICB0aHJv\ndyBCS0V4Y2VwdGlvbi5jcmVhdGUocmMuZ2V0KCkpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgdmFsaWRMZWRnZXJFbnRyaWVzKGxvbmdb\nXSBsZWRnZXJJZHMsIGludCBtc2dTaXplLCBpbnQgbnVtTXNncykgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gT3BlbiB0aGUgbGVkZ2VycwogICAg\nICAgIExlZGdlckhhbmRsZVtdIGxocyA9IG5ldyBMZWRnZXJIYW5kbGVbbGVk\nZ2VySWRzLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBs\naHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgbGhzW2ldID0gYmtjLm9w\nZW5MZWRnZXIobGVkZ2VySWRzW2ldLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRl\ncygpKTsKICAgICAgICB9CgogICAgICAgIFN0cmluZ0J1aWxkZXIgbXNnU0Ig\nPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbXNnU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIG1zZ1NCLmFwcGVu\nZCgiYSIpOwogICAgICAgIH0KICAgICAgICBTdHJpbmcgbXNnID0gbXNnU0Iu\ndG9TdHJpbmcoKTsKCiAgICAgICAgaW50IG51bVRvUmVhZCA9IDEwOwogICAg\nICAgIC8vIHJlYWQgYWxsIG9mIHRoZSBlbnRyaWVzIGZvciBhbGwgdGhlIGxl\nZGdlcnMKICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGxocy5sZW5ndGg7\nIGorKykgewogICAgICAgICAgICBpbnQgc3RhcnQgPSAwOwogICAgICAgICAg\nICBpbnQgcmVhZCA9IE1hdGgubWluKG51bVRvUmVhZCwgbnVtTXNncyAtIHN0\nYXJ0KTsKICAgICAgICAgICAgaW50IGVuZCA9IHN0YXJ0ICsgcmVhZCAtIDE7\nCiAgICAgICAgICAgIGludCBlbnRyeUlkID0gMDsKICAgICAgICAgICAgaWYg\nKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBMT0cu\nZGVidWcoIlZhbGlkYXRpbmcgRW50cmllcyBvZiBMZWRnZXIgIiArIGxlZGdl\ncklkc1tqXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgd2hpbGUgKHN0\nYXJ0IDwgbnVtTXNncykgewogICAgICAgICAgICAgICAgRW51bWVyYXRpb248\nTGVkZ2VyRW50cnk+IHNlcSA9IGxoc1tqXS5yZWFkRW50cmllcyhzdGFydCwg\nZW5kKTsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUoIkVudW1lcmF0aW9u\nIG9mIGxlZGdlciBlbnRyaWVzIGhhcyBubyBlbGVtZW50Iiwgc2VxLmhhc01v\ncmVFbGVtZW50cygpID09IHRydWUpOwogICAgICAgICAgICAgICAgd2hpbGUg\nKHNlcS5oYXNNb3JlRWxlbWVudHMoKSkgewogICAgICAgICAgICAgICAgICAg\nIExlZGdlckVudHJ5IGUgPSBzZXEubmV4dEVsZW1lbnQoKTsKICAgICAgICAg\nICAgICAgICAgICBhc3NlcnRFcXVhbHMoZW50cnlJZCwgZS5nZXRFbnRyeUlk\nKCkpOwoKICAgICAgICAgICAgICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0g\nbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgICAgICAgICBzYi5h\ncHBlbmQobGVkZ2VySWRzW2pdKS5hcHBlbmQoJy0nKS5hcHBlbmQoZW50cnlJ\nZCkuYXBwZW5kKCctJykKICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQo\nbXNnKTsKICAgICAgICAgICAgICAgICAgICBBc3NlcnQuYXNzZXJ0QXJyYXlF\ncXVhbHMoc2IudG9TdHJpbmcoKS5nZXRCeXRlcygpLCBlLmdldEVudHJ5KCkp\nOwogICAgICAgICAgICAgICAgICAgIGVudHJ5SWQrKzsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIGFzc2VydEVxdWFscyhlbnRyeUlkIC0g\nMSwgZW5kKTsKICAgICAgICAgICAgICAgIHN0YXJ0ID0gZW5kICsgMTsKICAg\nICAgICAgICAgICAgIHJlYWQgPSBNYXRoLm1pbihudW1Ub1JlYWQsIG51bU1z\nZ3MgLSBzdGFydCk7CiAgICAgICAgICAgICAgICBlbmQgPSBzdGFydCArIHJl\nYWQgLSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogVGhpcyB0ZXN0IHdyaXRlcyBlbm91Z2ggbGVkZ2VyIGVudHJp\nZXMgdG8gcm9sbCBvdmVyIHRoZSBqb3VybmFscwogICAgICoKICAgICAqIEl0\nIHdpbGwgdGhlbiBrZWVwIG9ubHkgMSBqb3VybmFsIGZpbGUgYmVmb3JlIGxh\nc3QgbWFya2VkIGpvdXJuYWwKICAgICAqCiAgICAgKiBAdGhyb3dzIEV4Y2Vw\ndGlvbgogICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVi\nbGljIHZvaWQgdGVzdEpvdXJuYWxSb2xsaW5nKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAg\nICAgICAgIExPRy5kZWJ1ZygiVGVzdGluZyBKb3VybmFsIFJvbGxpbmciKTsK\nICAgICAgICB9CiAgICAgICAgLy8gV3JpdGUgZW5vdWdoIGxlZGdlciBlbnRy\naWVzIHNvIHRoYXQgd2Ugcm9sbCBvdmVyIGpvdXJuYWxzCiAgICAgICAgTGVk\nZ2VySGFuZGxlW10gbGhzID0gd3JpdGVMZWRnZXJFbnRyaWVzKDQsIDEwMjQs\nIDEwMjQpOwogICAgICAgIGxvbmdbXSBsZWRnZXJJZHMgPSBuZXcgbG9uZ1ts\naHMubGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpPTA7IGk8bGhzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGxlZGdlcklkc1tpXSA9IGxoc1tpXS5n\nZXRJZCgpOwogICAgICAgICAgICBsaHNbaV0uY2xvc2UoKTsKICAgICAgICB9\nCgogICAgICAgIC8vIFNsZWVwIGZvciBhIHdoaWxlIHRvIGVuc3VyZSBkYXRh\nIGFyZSBmbHVzaGVkCiAgICAgICAgVGhyZWFkLnNsZWVwKDIwMDApOwoKICAg\nICAgICAvLyB2ZXJpZnkgdGhhdCB3ZSBvbmx5IGtlZXAgYXQgbW9zdCBqb3Vy\nbmFsIGZpbGVzCiAgICAgICAgZm9yIChGaWxlIGpvdXJuYWxEaXIgOiB0bXBE\naXJzKSB7CiAgICAgICAgICAgIEZpbGVbXSBqb3VybmFscyA9IGpvdXJuYWxE\naXIubGlzdEZpbGVzKCk7CiAgICAgICAgICAgIGludCBudW1Kb3VybmFscyA9\nIDA7CiAgICAgICAgICAgIGZvciAoRmlsZSBmIDogam91cm5hbHMpIHsKICAg\nICAgICAgICAgICAgIGlmICghZi5nZXROYW1lKCkuZW5kc1dpdGgoIi50eG4i\nKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgKytudW1Kb3VybmFsczsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBhc3NlcnRUcnVlKG51bUpvdXJuYWxzIDw9\nIDIpOwogICAgICAgIH0KCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzCiAg\nICAgICAgLy8gZW5zdXJlIGFmdGVyIHJlc3RhcnQgd2UgY2FuIHJlYWQgdGhl\nIGVudHJpZXMgc2luY2Ugam91cm5hbHMgcm9sbHMKICAgICAgICByZXN0YXJ0\nQm9va2llcygpOwogICAgICAgIHZhbGlkTGVkZ2VyRW50cmllcyhsZWRnZXJJ\nZHMsIDEwMjQsIDEwMjQpOwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyB0\nZXN0IHdyaXRlcyBlbm91Z2ggbGVkZ2VyIGVudHJpZXMgdG8gcm9sbCBvdmVy\nIHRoZSBqb3VybmFscwogICAgICogd2l0aG91dCBzeW5jIHVwCiAgICAgKgog\nICAgICogQHRocm93cyBFeGNlcHRpb24KICAgICAqLwogICAgQFRlc3QodGlt\nZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RKb3VybmFsUm9sbGlu\nZ1dpdGhvdXRTeW5jdXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgTE9HLmRl\nYnVnKCJUZXN0aW5nIEpvdXJuYWwgUm9sbGluZyB3aXRob3V0IHN5bmMgdXAi\nKTsKICAgICAgICB9CgogICAgICAgIC8vIHNldCBmbHVzaCBpbnRlcnZhbCB0\nbyBhIGxhcmdlIHZhbHVlCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBu\nZXdDb25mID0gVGVzdEJLQ29uZmlndXJhdGlvbi5uZXdTZXJ2ZXJDb25maWd1\ncmF0aW9uKCk7CiAgICAgICAgbmV3Q29uZi5zZXRGbHVzaEludGVydmFsKDk5\nOTk5OTk5OSk7CiAgICAgICAgLy8gcmVzdGFydCBib29raWVzCiAgICAgICAg\ncmVzdGFydEJvb2tpZXMobmV3Q29uZik7CgogICAgICAgIC8vIFdyaXRlIGVu\nb3VnaCBsZWRnZXIgZW50cmllcyBzbyB0aGF0IHdlIHJvbGwgb3ZlciBqb3Vy\nbmFscwogICAgICAgIExlZGdlckhhbmRsZVtdIGxocyA9IHdyaXRlTGVkZ2Vy\nRW50cmllcyg0LCAxMDI0LCAxMDI0KTsKICAgICAgICBsb25nW10gbGVkZ2Vy\nSWRzID0gbmV3IGxvbmdbbGhzLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQg\naT0wOyBpPGxocy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBsZWRnZXJJ\nZHNbaV0gPSBsaHNbaV0uZ2V0SWQoKTsKICAgICAgICAgICAgbGhzW2ldLmNs\nb3NlKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBsZWRnZXIgaW5kZXhlcyBh\ncmUgbm90IGZsdXNoZWQKICAgICAgICAvLyBhbmQgYWZ0ZXIgYm9va2llcyBy\nZXN0YXJ0ZWQsIGpvdXJuYWxzIHdpbGwgYmUgcmVsYXllZAogICAgICAgIC8v\nIGVuc3VyZSB0aGF0IHdlIGNhbiBzdGlsbCByZWFkIHRoZSBlbnRyaWVzCiAg\nICAgICAgcmVzdGFydEJvb2tpZXMobmV3Q29uZik7CiAgICAgICAgdmFsaWRM\nZWRnZXJFbnRyaWVzKGxlZGdlcklkcywgMTAyNCwgMTAyNCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGlzIHRlc3Qgd3JpdGVzIGVub3VnaCBsZWRnZXIg\nZW50cmllcyB0byByb2xsIG92ZXIgdGhlIGpvdXJuYWxzCiAgICAgKiB3aXRo\nb3V0IHN5bmMgdXAKICAgICAqCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgog\nICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZv\naWQgdGVzdFJlcGxheURlbGV0ZWRMZWRnZXJKb3VybmFsRW50cmllcygpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChMT0cuaXNEZWJ1Z0VuYWJs\nZWQoKSkgewogICAgICAgICAgICBMT0cuZGVidWcoIlRlc3RpbmcgcmVwbGF5\naW5nIGpvdXJuYWwgZW50cmllcyB3aG9zZSBsZWRnZXIgaGFzIGJlZW4gcmVt\nb3ZlZC4iKTsKICAgICAgICB9CgogICAgICAgIC8vIFdyaXRlIGVudHJpZXMK\nICAgICAgICBMZWRnZXJIYW5kbGVbXSBsaHMgPSB3cml0ZUxlZGdlckVudHJp\nZXMoMSwgMTAyNCwgMTApOwogICAgICAgIC8vIFdhaXQgdW50aWwgYWxsIGVu\ndHJpZXMgYXJlIGZsdXNoZWQgYW5kIGxhc3QgbWFyayByb2xscwogICAgICAg\nIFRocmVhZC5zbGVlcCgzICogYmFzZUNvbmYuZ2V0Rmx1c2hJbnRlcnZhbCgp\nKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzIHdpdGggZmx1c2ggaW50\nZXJ2YWwgc2V0IHRvIGEgbGFyZ2UgdmFsdWUKICAgICAgICBTZXJ2ZXJDb25m\naWd1cmF0aW9uIG5ld0NvbmYgPSBUZXN0QktDb25maWd1cmF0aW9uLm5ld1Nl\ncnZlckNvbmZpZ3VyYXRpb24oKTsKICAgICAgICBuZXdDb25mLnNldEZsdXNo\nSW50ZXJ2YWwoOTk5OTk5OTk5KTsKICAgICAgICAvLyByZXN0YXJ0IGJvb2tp\nZXMKICAgICAgICByZXN0YXJ0Qm9va2llcyhuZXdDb25mKTsKCiAgICAgICAg\nLy8gV3JpdGUgZW50cmllcyBhZ2FpbiB0byBsZXQgdGhlbSBleGlzdGVkIGlu\nIGpvdXJuYWwKICAgICAgICB3cml0ZUxlZGdlckVudHJpZXMobGhzLCAxMDI0\nLCAxMCk7CgogICAgICAgIC8vIGRlbGV0ZSB0aGVtCiAgICAgICAgZm9yIChM\nZWRnZXJIYW5kbGUgbGggOiBsaHMpIHsKICAgICAgICAgICAgYmtjLmRlbGV0\nZUxlZGdlcihsaC5nZXRJZCgpKTsKICAgICAgICB9CiAgICAgICAgLy8gd2Fp\ndCBmb3IgZ2MKICAgICAgICBUaHJlYWQuc2xlZXAoMiAqIG5ld0NvbmYuZ2V0\nR2NXYWl0VGltZSgpKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzIGFn\nYWluIHRvIHRyaWdnZXIgcmVwbGF5aW5nIGpvdXJuYWwKICAgICAgICByZXN0\nYXJ0Qm9va2llcyhuZXdDb25mKTsKICAgIH0KCn0K\n","encoding":"base64"}

