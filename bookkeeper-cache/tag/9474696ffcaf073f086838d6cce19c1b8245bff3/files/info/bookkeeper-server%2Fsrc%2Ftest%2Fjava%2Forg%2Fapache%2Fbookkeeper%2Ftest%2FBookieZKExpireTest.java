{"sha":"93256a7c3dec8714b8c42dd3e41f2d23b60624db","node_id":"MDQ6QmxvYjE1NzU5NTY6OTMyNTZhN2MzZGVjODcxNGI4YzQyZGQzZTQxZjJkMjNiNjA2MjRkYg==","size":3898,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/93256a7c3dec8714b8c42dd3e41f2d23b60624db","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBv\ncnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5BZnRlcjsK\naW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbjsK\naW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnByb3RvLkJvb2tpZVNlcnZlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5ib29raWUuQm9va2llOwoKcHVibGljIGNsYXNzIEJv\nb2tpZVpLRXhwaXJlVGVzdCBleHRlbmRzIEJvb2tLZWVwZXJDbHVzdGVyVGVz\ndENhc2UgewoKICAgIHB1YmxpYyBCb29raWVaS0V4cGlyZVRlc3QoKSB7CiAg\nICAgICAgc3VwZXIoMCk7CiAgICAgICAgLy8gNjAwMCBpcyBtaW5pbXVtIGR1\nZSB0byBkZWZhdWx0IHRpY2sgdGltZQogICAgICAgIGJhc2VDb25mLnNldFpr\nVGltZW91dCg2MDAwKTsKICAgICAgICBiYXNlQ2xpZW50Q29uZi5zZXRaa1Rp\nbWVvdXQoNjAwMCk7CiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoImRl\ncHJlY2F0aW9uIikKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJs\naWMgdm9pZCB0ZXN0Qm9va2llU2VydmVyWktFeHBpcmVCZWhhdmlvdXIoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCb29raWVTZXJ2ZXIgc2VydmVy\nID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBGaWxlIGYgPSBG\naWxlLmNyZWF0ZVRlbXBGaWxlKCJib29raWVzZXJ2ZXIiLCAidGVzdCIpOwog\nICAgICAgICAgICBmLmRlbGV0ZSgpOwogICAgICAgICAgICBmLm1rZGlyKCk7\nCgogICAgICAgICAgICBIYXNoU2V0PFRocmVhZD4gdGhyZWFkc2V0ID0gbmV3\nIEhhc2hTZXQ8VGhyZWFkPigpOwogICAgICAgICAgICBpbnQgdGhyZWFkQ291\nbnQgPSBUaHJlYWQuYWN0aXZlQ291bnQoKTsKICAgICAgICAgICAgVGhyZWFk\nIHRocmVhZHNbXSA9IG5ldyBUaHJlYWRbdGhyZWFkQ291bnQqMl07CiAgICAg\nICAgICAgIHRocmVhZENvdW50ID0gVGhyZWFkLmVudW1lcmF0ZSh0aHJlYWRz\nKTsKICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IHRocmVhZENvdW50\nOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmICh0aHJlYWRzW2ldLmdldE5h\nbWUoKS5pbmRleE9mKCJTZW5kVGhyZWFkIikgIT0gLTEpIHsKICAgICAgICAg\nICAgICAgICAgICB0aHJlYWRzZXQuYWRkKHRocmVhZHNbaV0pOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBTZXJ2ZXJD\nb25maWd1cmF0aW9uIGNvbmYgPSBuZXdTZXJ2ZXJDb25maWd1cmF0aW9uKFBv\ncnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpr\nVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3RyaW5nKCksIGYsIG5ldyBGaWxl\nW10geyBmIH0pOwogICAgICAgICAgICBzZXJ2ZXIgPSBuZXcgQm9va2llU2Vy\ndmVyKGNvbmYpOwogICAgICAgICAgICBzZXJ2ZXIuc3RhcnQoKTsKCiAgICAg\nICAgICAgIGludCBzZWNvbmRzVG9XYWl0ID0gNTsKICAgICAgICAgICAgd2hp\nbGUgKCFzZXJ2ZXIuaXNSdW5uaW5nKCkpIHsKICAgICAgICAgICAgICAgIFRo\ncmVhZC5zbGVlcCgxMDAwKTsKICAgICAgICAgICAgICAgIGlmIChzZWNvbmRz\nVG9XYWl0LS0gPD0gMCkgewogICAgICAgICAgICAgICAgICAgIGZhaWwoIkJv\nb2tpZSBuZXZlciBzdGFydGVkIik7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgVGhyZWFkIHNlbmR0aHJlYWQgPSBudWxs\nOwogICAgICAgICAgICB0aHJlYWRDb3VudCA9IFRocmVhZC5hY3RpdmVDb3Vu\ndCgpOwogICAgICAgICAgICB0aHJlYWRzID0gbmV3IFRocmVhZFt0aHJlYWRD\nb3VudCoyXTsKICAgICAgICAgICAgdGhyZWFkQ291bnQgPSBUaHJlYWQuZW51\nbWVyYXRlKHRocmVhZHMpOwogICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBp\nIDwgdGhyZWFkQ291bnQ7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHRo\ncmVhZHNbaV0uZ2V0TmFtZSgpLmluZGV4T2YoIlNlbmRUaHJlYWQiKSAhPSAt\nMQogICAgICAgICAgICAgICAgICAgICAgICAmJiAhdGhyZWFkc2V0LmNvbnRh\naW5zKHRocmVhZHNbaV0pKSB7CiAgICAgICAgICAgICAgICAgICAgc2VuZHRo\ncmVhZCA9IHRocmVhZHNbaV07CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nYXNzZXJ0Tm90TnVsbCgiU2VuZCB0aHJlYWQgbm90IGZvdW5kIiwgc2VuZHRo\ncmVhZCk7CgogICAgICAgICAgICBzZW5kdGhyZWFkLnN1c3BlbmQoKTsKICAg\nICAgICAgICAgVGhyZWFkLnNsZWVwKDIqY29uZi5nZXRaa1RpbWVvdXQoKSk7\nCiAgICAgICAgICAgIHNlbmR0aHJlYWQucmVzdW1lKCk7CgogICAgICAgICAg\nICAvLyBhbGxvdyB3YXRjaGVyIHRocmVhZCB0byBydW4KICAgICAgICAgICAg\nc2Vjb25kc1RvV2FpdCA9IDIwOwogICAgICAgICAgICB3aGlsZSAoc2VydmVy\nLmlzQm9va2llUnVubmluZygpCiAgICAgICAgICAgICAgICAgICB8fCBzZXJ2\nZXIuaXNSdW5uaW5nKCkpIHsKICAgICAgICAgICAgICAgIFRocmVhZC5zbGVl\ncCgxMDAwKTsKICAgICAgICAgICAgICAgIGlmIChzZWNvbmRzVG9XYWl0LS0g\nPD0gMCkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFzc2VydEZhbHNl\nKCJCb29raWUgc2hvdWxkIGhhdmUgc2h1dGRvd24gb24gbG9zaW5nIHprIHNl\nc3Npb24iLCBzZXJ2ZXIuaXNCb29raWVSdW5uaW5nKCkpOwogICAgICAgICAg\nICBhc3NlcnRGYWxzZSgiQm9va2llIFNlcnZlciBzaG91bGQgaGF2ZSBzaHV0\nZG93biBvbiBsb3Npbmcgemsgc2Vzc2lvbiIsIHNlcnZlci5pc1J1bm5pbmco\nKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgc2VydmVyLnNo\ndXRkb3duKCk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

