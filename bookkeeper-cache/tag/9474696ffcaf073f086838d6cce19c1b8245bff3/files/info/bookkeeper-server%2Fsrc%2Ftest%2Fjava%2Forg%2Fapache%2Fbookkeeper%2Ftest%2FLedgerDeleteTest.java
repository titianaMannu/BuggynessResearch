{"sha":"d45a2f31003e3fd5f24810a73ca5415cb42e843c","node_id":"MDQ6QmxvYjE1NzU5NTY6ZDQ1YTJmMzEwMDNlM2ZkNWYyNDgxMGE3M2NhNTQxNWNiNDJlODQzYw==","size":7030,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/d45a2f31003e3fd5f24810a73ca5415cb42e843c","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdDsKCi8qCiAqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAqLwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50\nLmF0b21pYy5BdG9taWNJbnRlZ2VyOwppbXBvcnQgamF2YS51dGlsLmNvbmN1\ncnJlbnQuQ291bnREb3duTGF0Y2g7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJh\nY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tL\nZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci51dGlsLlRlc3RVdGlsczsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7Cmlt\ncG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5qdW5p\ndC5CZWZvcmU7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKCmltcG9ydCBzdGF0\naWMgb3JnLmp1bml0LkFzc2VydC4qOwoKLyoqCiAqIFRoaXMgY2xhc3MgdGVz\ndHMgdGhlIGxlZGdlciBkZWxldGUgZnVuY3Rpb25hbGl0eSBib3RoIGZyb20g\ndGhlIEJvb2tLZWVwZXIKICogY2xpZW50IGFuZCB0aGUgc2VydmVyIHNpZGUu\nCiAqLwpwdWJsaWMgY2xhc3MgTGVkZ2VyRGVsZXRlVGVzdCBleHRlbmRzIE11\nbHRpTGVkZ2VyTWFuYWdlclRlc3RDYXNlIHsKICAgIHByaXZhdGUgZmluYWwg\nc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihM\nZWRnZXJEZWxldGVUZXN0LmNsYXNzKTsKICAgIERpZ2VzdFR5cGUgZGlnZXN0\nVHlwZTsKCiAgICBwdWJsaWMgTGVkZ2VyRGVsZXRlVGVzdChTdHJpbmcgbGVk\nZ2VyTWFuYWdlckZhY3RvcnkpIHsKICAgICAgICBzdXBlcigxKTsKICAgICAg\nICBMT0cuaW5mbygiUnVubmluZyB0ZXN0IGNhc2UgdXNpbmcgbGVkZ2VyIG1h\nbmFnZXIgOiAiICsgbGVkZ2VyTWFuYWdlckZhY3RvcnkpOwogICAgICAgIHRo\naXMuZGlnZXN0VHlwZSA9IERpZ2VzdFR5cGUuQ1JDMzI7CiAgICAgICAgLy8g\nc2V0IGxlZGdlciBtYW5hZ2VyIG5hbWUKICAgICAgICBiYXNlQ29uZi5zZXRM\nZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNzTmFtZShsZWRnZXJNYW5hZ2VyRmFj\ndG9yeSk7CiAgICAgICAgYmFzZUNsaWVudENvbmYuc2V0TGVkZ2VyTWFuYWdl\nckZhY3RvcnlDbGFzc05hbWUobGVkZ2VyTWFuYWdlckZhY3RvcnkpOwogICAg\nfQoKICAgIEBCZWZvcmUKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQg\nc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBTZXQgdXAg\ndGhlIGNvbmZpZ3VyYXRpb24gcHJvcGVydGllcyBuZWVkZWQuCiAgICAgICAg\nYmFzZUNvbmYuc2V0RW50cnlMb2dTaXplTGltaXQoMiAqIDEwMjQgKiAxMDI0\nTCk7CiAgICAgICAgYmFzZUNvbmYuc2V0R2NXYWl0VGltZSgxMDAwKTsKICAg\nICAgICBiYXNlQ29uZi5zZXRFbnRyeUxvZ0ZpbGVQcmVBbGxvY2F0aW9uRW5h\nYmxlZChmYWxzZSk7CiAgICAgICAgYmFzZUNvbmYuc2V0U29ydGVkTGVkZ2Vy\nU3RvcmFnZUVuYWJsZWQoZmFsc2UpOwogICAgICAgIHN1cGVyLnNldFVwKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb21tb24gbWV0aG9kIHRvIGNyZWF0\nZSBsZWRnZXJzIGFuZCB3cml0ZSBlbnRyaWVzIHRvIHRoZW0uCiAgICAgKi8K\nICAgIHByaXZhdGUgTGVkZ2VySGFuZGxlW10gd3JpdGVMZWRnZXJFbnRyaWVz\nKGludCBudW1MZWRnZXJzLCBpbnQgbXNnU2l6ZSwgaW50IG51bU1zZ3MpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIENyZWF0ZSB0aGUgbGVkZ2Vy\ncwogICAgICAgIExlZGdlckhhbmRsZVtdIGxocyA9IG5ldyBMZWRnZXJIYW5k\nbGVbbnVtTGVkZ2Vyc107CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBu\ndW1MZWRnZXJzOyBpKyspIHsKICAgICAgICAgICAgbGhzW2ldID0gYmtjLmNy\nZWF0ZUxlZGdlcigxLCAxLCBkaWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsK\nICAgICAgICB9CgogICAgICAgIC8vIENyZWF0ZSBhIGR1bW15IG1lc3NhZ2Ug\nc3RyaW5nIHRvIHdyaXRlIGFzIGxlZGdlciBlbnRyaWVzCiAgICAgICAgU3Ry\naW5nQnVpbGRlciBtc2dTQiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtc2dTaXplOyBpKyspIHsKICAgICAg\nICAgICAgbXNnU0IuYXBwZW5kKCJhIik7CiAgICAgICAgfQogICAgICAgIFN0\ncmluZyBtc2cgPSBtc2dTQi50b1N0cmluZygpOwogICAgICAgIGZpbmFsIENv\ndW50RG93bkxhdGNoIGNvbXBsZXRlTGF0Y2ggPSBuZXcgQ291bnREb3duTGF0\nY2gobnVtTXNncypudW1MZWRnZXJzKTsKICAgICAgICBmaW5hbCBBdG9taWNJ\nbnRlZ2VyIHJjID0gbmV3IEF0b21pY0ludGVnZXIoQktFeGNlcHRpb24uQ29k\nZS5PSyk7CiAgICAgICAgLy8gV3JpdGUgYWxsIG9mIHRoZSBlbnRyaWVzIGZv\nciBhbGwgb2YgdGhlIGxlZGdlcnMKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IG51bU1zZ3M7IGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0g\nMDsgaiA8IG51bUxlZGdlcnM7IGorKykgewogICAgICAgICAgICAgICAgbGhz\nW2pdLmFzeW5jQWRkRW50cnkobXNnLmdldEJ5dGVzKCksIG5ldyBBZGRDYWxs\nYmFjaygpIHsKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRD\nb21wbGV0ZShpbnQgcmMyLCBMZWRnZXJIYW5kbGUgbGgsIGxvbmcgZW50cnlJ\nZCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAgICAgICByYy5j\nb21wYXJlQW5kU2V0KEJLRXhjZXB0aW9uLkNvZGUuT0ssIHJjMik7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlTGF0Y2guY291bnREb3duKCk7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgbnVs\nbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29tcGxldGVM\nYXRjaC5hd2FpdCgpOwogICAgICAgIGlmIChyYy5nZXQoKSAhPSBCS0V4Y2Vw\ndGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIHRocm93IEJLRXhjZXB0aW9u\nLmNyZWF0ZShyYy5nZXQoKSk7CiAgICAgICAgfQoKICAgICAgICAvLyBSZXR1\ncm4gdGhlIGxlZGdlciBoYW5kbGVzIHRvIHRoZSBpbnNlcnRlZCBsZWRnZXJz\nIGFuZCBlbnRyaWVzCiAgICAgICAgcmV0dXJuIGxoczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoaXMgdGVzdCB3cml0ZXMgZW5vdWdoIGxlZGdlciBlbnRy\naWVzIHRvIHJvbGwgb3ZlciB0aGUgZW50cnkgbG9nIGZpbGUuCiAgICAgKiBJ\ndCB3aWxsIHRoZW4gZGVsZXRlIGFsbCBvZiB0aGUgbGVkZ2VycyBmcm9tIHRo\nZSBjbGllbnQgYW5kIGxldCB0aGUKICAgICAqIHNlcnZlcidzIEVudHJ5TG9n\nZ2VyIGdhcmJhZ2UgY29sbGVjdG9yIHRocmVhZCBkZWxldGUgdGhlIGluaXRp\nYWwgZW50cnkKICAgICAqIGxvZyBmaWxlLgogICAgICoKICAgICAqIEB0aHJv\nd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDAp\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGVkZ2VyRGVsZXRlKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gV3JpdGUgZW5vdWdoIGxlZGdlciBlbnRy\naWVzIHNvIHRoYXQgd2Ugcm9sbCBvdmVyIHRoZSBpbml0aWFsIGVudHJ5TG9n\nICgwLmxvZykKICAgICAgICBMZWRnZXJIYW5kbGVbXSBsaHMgPSB3cml0ZUxl\nZGdlckVudHJpZXMoMywgMTAyNCwgMTAyNCk7CiAgICAgICAgLy8gcmVzdGFy\ndCBib29raWVzIHRvIGZvcmNlIHJvbGxpbmcgZW50cnkgbG9nIGZpbGVzCiAg\nICAgICAgcmVzdGFydEJvb2tpZXMoKTsKCiAgICAgICAgLy8gRGVsZXRlIGFs\nbCBvZiB0aGVzZSBsZWRnZXJzIGZyb20gdGhlIEJvb2tLZWVwZXIgY2xpZW50\nCiAgICAgICAgZm9yIChMZWRnZXJIYW5kbGUgbGggOiBsaHMpIHsKICAgICAg\nICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaC5nZXRJZCgpKTsKICAgICAgICB9\nCiAgICAgICAgTE9HLmluZm8oIkZpbmlzaGVkIGRlbGV0aW5nIGFsbCBsZWRn\nZXJzIHNvIHdhaXRpbmcgZm9yIHRoZSBHQyB0aHJlYWQgdG8gY2xlYW4gdXAg\ndGhlIGVudHJ5TG9ncyIpOwogICAgICAgIFRocmVhZC5zbGVlcCgyMDAwKTsK\nCiAgICAgICAgLy8gVmVyaWZ5IHRoYXQgdGhlIGZpcnN0IGVudHJ5IGxvZyAo\nMC5sb2cpIGhhcyBiZWVuIGRlbGV0ZWQgZnJvbSBhbGwgb2YgdGhlIEJvb2tp\nZSBTZXJ2ZXJzLgogICAgICAgIGZvciAoRmlsZSBsZWRnZXJEaXJlY3Rvcnkg\nOiB0bXBEaXJzKSB7CiAgICAgICAgICAgIGFzc2VydEZhbHNlKCJGb3VuZCB0\naGUgZW50cnkgbG9nIGZpbGUgKDAubG9nKSB0aGF0IHNob3VsZCBoYXZlIGJl\nZW4gZGVsZXRlZCBpbiBsZWRnZXJEaXJlY3Rvcnk6ICIKICAgICAgICAgICAg\nICAgICsgbGVkZ2VyRGlyZWN0b3J5LCBUZXN0VXRpbHMuaGFzTG9nRmlsZXMo\nbGVkZ2VyRGlyZWN0b3J5LCB0cnVlLCAwKSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogVGhpcyB0ZXN0IGlzIHNpbWlsYXIgdG8gdGVzdExl\nZGdlckRlbGV0ZSgpIGV4Y2VwdCBpdCB3aWxsIHN0b3AgYW5kCiAgICAgKiBy\nZXN0YXJ0IHRoZSBCb29raWUgU2VydmVycyBhZnRlciBpdCBoYXMgd3JpdHRl\nbiBvdXQgdGhlIGxlZGdlciBlbnRyaWVzLgogICAgICogT24gcmVzdGFydCwg\ndGhlcmUgd2lsbCBiZSBleGlzdGluZyBlbnRyeSBsb2dzIGFuZCBsZWRnZXIg\naW5kZXggZmlsZXMgZm9yCiAgICAgKiB0aGUgRW50cnlMb2dnZXIgYW5kIExl\nZGdlckNhY2hlIHRvIHJlYWQgYW5kIHN0b3JlIGludG8gbWVtb3J5LgogICAg\nICoKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIEBUZXN0\nKHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGVkZ2VyRGVs\nZXRlV2l0aEV4aXN0aW5nRW50cnlMb2dzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gV3JpdGUgZW5vdWdoIGxlZGdlciBlbnRyaWVzIHNvIHRo\nYXQgd2Ugcm9sbCBvdmVyIHRoZSBpbml0aWFsIGVudHJ5TG9nICgwLmxvZykK\nICAgICAgICBMZWRnZXJIYW5kbGVbXSBsaHMgPSB3cml0ZUxlZGdlckVudHJp\nZXMoMywgMTAyNCwgMTAyNCk7CgogICAgICAgIC8qCiAgICAgICAgICogU2h1\ndGRvd24gdGhlIEJvb2tpZSBTZXJ2ZXJzIGFuZCByZXN0YXJ0IHRoZW0gdXNp\nbmcgdGhlIHNhbWUgbGVkZ2VyCiAgICAgICAgICogZGlyZWN0b3JpZXMuIFRo\naXMgd2lsbCB0ZXN0IHRoZSByZWFkaW5nIG9mIHByZS1leGlzdGluZyBsZWRn\nZXIgaW5kZXgKICAgICAgICAgKiBmaWxlcyBpbiB0aGUgTGVkZ2VyQ2FjaGUg\nZHVyaW5nIHN0YXJ0dXAgb2YgYSBCb29raWUgU2VydmVyLgogICAgICAgICAq\nLwogICAgICAgIHJlc3RhcnRCb29raWVzKCk7CgogICAgICAgIC8vIERlbGV0\nZSBhbGwgb2YgdGhlc2UgbGVkZ2VycyBmcm9tIHRoZSBCb29rS2VlcGVyIGNs\naWVudAogICAgICAgIGZvciAoTGVkZ2VySGFuZGxlIGxoIDogbGhzKSB7CiAg\nICAgICAgICAgIGJrYy5kZWxldGVMZWRnZXIobGguZ2V0SWQoKSk7CiAgICAg\nICAgfQogICAgICAgIExPRy5pbmZvKCJGaW5pc2hlZCBkZWxldGluZyBhbGwg\nbGVkZ2VycyBzbyB3YWl0aW5nIGZvciB0aGUgR0MgdGhyZWFkIHRvIGNsZWFu\nIHVwIHRoZSBlbnRyeUxvZ3MiKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMiAq\nIGJhc2VDb25mLmdldEdjV2FpdFRpbWUoKSk7CgogICAgICAgIC8qCiAgICAg\nICAgICogVmVyaWZ5IHRoYXQgdGhlIGZpcnN0IHR3byBlbnRyeSBsb2dzIChb\nMCwxXS5sb2cpIGhhdmUgYmVlbiBkZWxldGVkCiAgICAgICAgICogZnJvbSBh\nbGwgb2YgdGhlIEJvb2tpZSBTZXJ2ZXJzLiBXaGVuIHdlIHJlc3RhcnQgdGhl\nIHNlcnZlcnMgaW4gdGhpcwogICAgICAgICAqIHRlc3QsIGEgbmV3IGVudHJ5\nIGxvZyBpcyBjcmVhdGVkLiBXZSBrbm93IHRoZW4gdGhhdCB0aGUgZmlyc3Qg\ndHdvCiAgICAgICAgICogZW50cnkgbG9ncyBzaG91bGQgYmUgZGVsZXRlZC4K\nICAgICAgICAgKi8KICAgICAgICBmb3IgKEZpbGUgbGVkZ2VyRGlyZWN0b3J5\nIDogdG1wRGlycykgewogICAgICAgICAgICBhc3NlcnRGYWxzZSgiRm91bmQg\ndGhlIGVudHJ5IGxvZyBmaWxlIChbMCwxXS5sb2cpIHRoYXQgc2hvdWxkIGhh\ndmUgYmVlbiBkZWxldGVkIGluIGxlZGdlckRpcmVjdG9yeTogIgogICAgICAg\nICAgICAgICAgKyBsZWRnZXJEaXJlY3RvcnksIFRlc3RVdGlscy5oYXNMb2dG\naWxlcyhsZWRnZXJEaXJlY3RvcnksIHRydWUsIDAsIDEpKTsKICAgICAgICB9\nCiAgICB9Cgp9Cg==\n","encoding":"base64"}

