{"sha":"fd61d2d0f18411920f52bbb1ad2671e66d0213de","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmQ2MWQyZDBmMTg0MTE5MjBmNTJiYmIxYWQyNjcxZTY2ZDAyMTNkZQ==","size":5709,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fd61d2d0f18411920f52bbb1ad2671e66d0213de","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247\nCgppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CgppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuWmtVdGlsczsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci56b29rZWVwZXIuWm9vS2VlcGVyV2F0Y2hl\nckJhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuaW8uRmlsZVV0aWxz\nOwoKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNo\nOwoKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBv\ncmcuYXBhY2hlLnpvb2tlZXBlci5ab29EZWZzLklkczsKCmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5zZXJ2ZXIuTklPU2VydmVyQ254bkZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5zZXJ2ZXIuWm9vS2VlcGVy\nU2VydmVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIudGVzdC5DbGll\nbnRCYXNlOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBzdGF0aWMgb3JnLmp1bml0\nLkFzc2VydC4qOwoKcHVibGljIGNsYXNzIFpvb0tlZXBlclV0aWwgewogICAg\nc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihab29LZWVwZXJVdGlsLmNsYXNzKTsKCiAgICAvLyBab29LZWVwZXIg\ncmVsYXRlZCB2YXJpYWJsZXMKICAgIHByb3RlY3RlZCBmaW5hbCBzdGF0aWMg\nSW50ZWdlciB6b29LZWVwZXJQb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQ\nb3J0KCk7CiAgICBwcml2YXRlIGZpbmFsIEluZXRTb2NrZXRBZGRyZXNzIHpr\nYWRkcjsKCiAgICBwcm90ZWN0ZWQgWm9vS2VlcGVyU2VydmVyIHprczsKICAg\nIHByb3RlY3RlZCBab29LZWVwZXIgemtjOyAvLyB6b29rZWVwZXIgY2xpZW50\nCiAgICBwcm90ZWN0ZWQgTklPU2VydmVyQ254bkZhY3Rvcnkgc2VydmVyRmFj\ndG9yeTsKICAgIHByb3RlY3RlZCBGaWxlIFprVG1wRGlyOwogICAgcHJpdmF0\nZSBmaW5hbCBTdHJpbmcgY29ubmVjdFN0cmluZzsKCiAgICBwdWJsaWMgWm9v\nS2VlcGVyVXRpbCgpIHsKICAgICAgICB6a2FkZHIgPSBuZXcgSW5ldFNvY2tl\ndEFkZHJlc3Moem9vS2VlcGVyUG9ydCk7CiAgICAgICAgY29ubmVjdFN0cmlu\nZz0gImxvY2FsaG9zdDoiICsgem9vS2VlcGVyUG9ydDsKICAgIH0KCiAgICBw\ndWJsaWMgWm9vS2VlcGVyIGdldFpvb0tlZXBlckNsaWVudCgpIHsKICAgICAg\nICByZXR1cm4gemtjOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0Wm9v\nS2VlcGVyQ29ubmVjdFN0cmluZygpIHsKICAgICAgICByZXR1cm4gY29ubmVj\ndFN0cmluZzsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydFNlcnZlcigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIGNyZWF0ZSBhIFpvb0tl\nZXBlciBzZXJ2ZXIoZGF0YURpciwgZGF0YUxvZ0RpciwgcG9ydCkKICAgICAg\nICBMT0cuZGVidWcoIlJ1bm5pbmcgWksgc2VydmVyIik7CiAgICAgICAgLy8g\nU2VydmVyU3RhdHMucmVnaXN0ZXJBc0NvbmNyZXRlKCk7CiAgICAgICAgQ2xp\nZW50QmFzZS5zZXR1cFRlc3RFbnYoKTsKICAgICAgICBaa1RtcERpciA9IEZp\nbGUuY3JlYXRlVGVtcEZpbGUoInpvb2tlZXBlciIsICJ0ZXN0Iik7CiAgICAg\nICAgWmtUbXBEaXIuZGVsZXRlKCk7CiAgICAgICAgWmtUbXBEaXIubWtkaXIo\nKTsKCiAgICAgICAgLy8gc3RhcnQgdGhlIHNlcnZlciBhbmQgY2xpZW50Lgog\nICAgICAgIHJlc3RhcnRTZXJ2ZXIoKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6\nZSB0aGUgemsgY2xpZW50IHdpdGggdmFsdWVzCiAgICAgICAgemtjLmNyZWF0\nZSgiL2xlZGdlcnMiLCBuZXcgYnl0ZVswXSwgSWRzLk9QRU5fQUNMX1VOU0FG\nRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKICAgICAgICB6a2MuY3JlYXRl\nKCIvbGVkZ2Vycy9hdmFpbGFibGUiLCBuZXcgYnl0ZVswXSwgSWRzLk9QRU5f\nQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCByZXN0YXJ0U2VydmVyKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgemtzID0gbmV3IFpvb0tlZXBlclNlcnZlcihaa1RtcERp\nciwgWmtUbXBEaXIsCiAgICAgICAgICAgICAgICBab29LZWVwZXJTZXJ2ZXIu\nREVGQVVMVF9USUNLX1RJTUUpOwogICAgICAgIHNlcnZlckZhY3RvcnkgPSBu\nZXcgTklPU2VydmVyQ254bkZhY3RvcnkoKTsKICAgICAgICBzZXJ2ZXJGYWN0\nb3J5LmNvbmZpZ3VyZSh6a2FkZHIsIDEwMCk7CiAgICAgICAgc2VydmVyRmFj\ndG9yeS5zdGFydHVwKHprcyk7CgogICAgICAgIGJvb2xlYW4gYiA9IENsaWVu\ndEJhc2Uud2FpdEZvclNlcnZlclVwKGdldFpvb0tlZXBlckNvbm5lY3RTdHJp\nbmcoKSwKICAgICAgICAgICAgICAgIENsaWVudEJhc2UuQ09OTkVDVElPTl9U\nSU1FT1VUKTsKICAgICAgICBMT0cuZGVidWcoIlNlcnZlciB1cDogIiArIGIp\nOwoKICAgICAgICAvLyBjcmVhdGUgYSB6b29rZWVwZXIgY2xpZW50CiAgICAg\nICAgTE9HLmRlYnVnKCJJbnN0YW50aWF0ZSBaSyBDbGllbnQiKTsKICAgICAg\nICBab29LZWVwZXJXYXRjaGVyQmFzZSB3ID0gbmV3IFpvb0tlZXBlcldhdGNo\nZXJCYXNlKDEwMDAwKTsKICAgICAgICB6a2MgPSBaa1V0aWxzLmNyZWF0ZUNv\nbm5lY3RlZFpvb2tlZXBlckNsaWVudCgKICAgICAgICAgICAgICAgIGdldFpv\nb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwgdyk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2xlZXBTZXJ2ZXIoZmluYWwgaW50IHNlY29uZHMsIGZpbmFsIENv\ndW50RG93bkxhdGNoIGwpCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAgICAgIFRocmVhZFtdIGFs\nbHRocmVhZHMgPSBuZXcgVGhyZWFkW1RocmVhZC5hY3RpdmVDb3VudCgpXTsK\nICAgICAgICBUaHJlYWQuZW51bWVyYXRlKGFsbHRocmVhZHMpOwogICAgICAg\nIGZvciAoZmluYWwgVGhyZWFkIHQgOiBhbGx0aHJlYWRzKSB7CiAgICAgICAg\nICAgIGlmICh0LmdldE5hbWUoKS5jb250YWlucygiU3luY1RocmVhZDowIikp\nIHsKICAgICAgICAgICAgICAgIFRocmVhZCBzbGVlcGVyID0gbmV3IFRocmVh\nZCgpIHsKICAgICAgICAgICAgICAgICAgICBAU3VwcHJlc3NXYXJuaW5ncygi\nZGVwcmVjYXRpb24iKQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHQuc3VzcGVuZCgpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgbC5jb3VudERvd24oKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIFRocmVhZC5zbGVlcChzZWNvbmRzKjEwMDApOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5yZXN1bWUoKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3Igc3Vz\ncGVuZGluZyB0aHJlYWQiLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAg\nICAgICAgICAgICAgICBzbGVlcGVyLnN0YXJ0KCk7CiAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhy\nb3cgbmV3IElPRXhjZXB0aW9uKCJab29LZWVwZXIgdGhyZWFkIG5vdCBmb3Vu\nZCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV4cGlyZVNlc3Npb24oWm9v\nS2VlcGVyIHprKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBsb25nIGlk\nID0gemsuZ2V0U2Vzc2lvbklkKCk7CiAgICAgICAgYnl0ZVtdIHBhc3N3b3Jk\nID0gemsuZ2V0U2Vzc2lvblBhc3N3ZCgpOwogICAgICAgIFpvb0tlZXBlcldh\ndGNoZXJCYXNlIHcgPSBuZXcgWm9vS2VlcGVyV2F0Y2hlckJhc2UoMTAwMDAp\nOwogICAgICAgIFpvb0tlZXBlciB6azIgPSBuZXcgWm9vS2VlcGVyKGdldFpv\nb0tlZXBlckNvbm5lY3RTdHJpbmcoKSwKICAgICAgICAgICAgICAgIHprLmdl\ndFNlc3Npb25UaW1lb3V0KCksIHcsIGlkLCBwYXNzd29yZCk7CiAgICAgICAg\ndy53YWl0Rm9yQ29ubmVjdGlvbigpOwogICAgICAgIHprMi5jbG9zZSgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0b3BTZXJ2ZXIoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoemtjICE9IG51bGwpIHsKICAgICAgICAg\nICAgemtjLmNsb3NlKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBzaHV0ZG93\nbiBaSyBzZXJ2ZXIKICAgICAgICBpZiAoc2VydmVyRmFjdG9yeSAhPSBudWxs\nKSB7CiAgICAgICAgICAgIHNlcnZlckZhY3Rvcnkuc2h1dGRvd24oKTsKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZSgid2FpdGluZyBmb3Igc2VydmVyIGRvd24i\nLAogICAgICAgICAgICAgICAgICAgIENsaWVudEJhc2Uud2FpdEZvclNlcnZl\nckRvd24oZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQ2xpZW50QmFzZS5DT05ORUNUSU9OX1RJTUVP\nVVQpKTsKICAgICAgICB9CiAgICAgICAgaWYgKHprcyAhPSBudWxsKSB7CiAg\nICAgICAgICAgIHprcy5nZXRUeG5Mb2dGYWN0b3J5KCkuY2xvc2UoKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQga2lsbFNlcnZlcigpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIHN0b3BTZXJ2ZXIoKTsKICAgICAg\nICAvLyBTZXJ2ZXJTdGF0cy51bnJlZ2lzdGVyKCk7CiAgICAgICAgRmlsZVV0\naWxzLmRlbGV0ZURpcmVjdG9yeShaa1RtcERpcik7CiAgICB9Cn0K\n","encoding":"base64"}

