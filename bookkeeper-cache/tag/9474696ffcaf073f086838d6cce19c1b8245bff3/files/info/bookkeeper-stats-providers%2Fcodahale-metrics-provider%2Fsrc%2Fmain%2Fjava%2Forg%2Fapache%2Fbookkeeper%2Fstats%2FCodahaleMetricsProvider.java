{"sha":"a434b3c64200a622b1a01b53edf49c49dd7cb49d","node_id":"MDQ6QmxvYjE1NzU5NTY6YTQzNGIzYzY0MjAwYTYyMmIxYTAxYjUzZWRmNDljNDlkZDdjYjQ5ZA==","size":5747,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a434b3c64200a622b1a01b53edf49c49dd7cb49d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuIFNlZSB0aGUgTk9USUNFIGZpbGUgZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzCiAqIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24gcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuIFRoZSBBU0YK\nICogbGljZW5zZXMgdGhpcyBmaWxlIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hl\nIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91\nIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3\naXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xp\nY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBh\ncHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdh\ncmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJp\nYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywgV0lUSE9VVAogKiBXQVJSQU5U\nSUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNz\nIG9yIGltcGxpZWQuIFNlZSB0aGUKICogTGljZW5zZSBmb3IgdGhlIHNwZWNp\nZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRh\ndGlvbnMgdW5kZXIKICogdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5zdGF0czsKCmltcG9ydCBqYXZhLm5ldC5JbmV0\nU29ja2V0QWRkcmVzczsKCmltcG9ydCBjb20uY29kYWhhbGUubWV0cmljcy5D\nc3ZSZXBvcnRlcjsKaW1wb3J0IGNvbS5jb2RhaGFsZS5tZXRyaWNzLk1ldHJp\nY0ZpbHRlcjsKaW1wb3J0IGNvbS5jb2RhaGFsZS5tZXRyaWNzLk1ldHJpY1Jl\nZ2lzdHJ5OwppbXBvcnQgY29tLmNvZGFoYWxlLm1ldHJpY3MuU2NoZWR1bGVk\nUmVwb3J0ZXI7CmltcG9ydCBjb20uY29kYWhhbGUubWV0cmljcy5TbGY0alJl\ncG9ydGVyOwppbXBvcnQgY29tLmNvZGFoYWxlLm1ldHJpY3MuSm14UmVwb3J0\nZXI7CmltcG9ydCBjb20uZ29vZ2xlLmNvbW1vbi5iYXNlLlN0cmluZ3M7Cmlt\ncG9ydCBjb20uZ29vZ2xlLmNvbW1vbi5uZXQuSG9zdEFuZFBvcnQ7CmltcG9y\ndCBzdGF0aWMgY29tLmNvZGFoYWxlLm1ldHJpY3MuTWV0cmljUmVnaXN0cnku\nbmFtZTsKaW1wb3J0IGNvbS5jb2RhaGFsZS5tZXRyaWNzLmdyYXBoaXRlLkdy\nYXBoaXRlOwppbXBvcnQgY29tLmNvZGFoYWxlLm1ldHJpY3MuZ3JhcGhpdGUu\nR3JhcGhpdGVSZXBvcnRlcjsKCmltcG9ydCBjb20uY29kYWhhbGUubWV0cmlj\ncy5qdm0uR2FyYmFnZUNvbGxlY3Rvck1ldHJpY1NldDsKaW1wb3J0IGNvbS5j\nb2RhaGFsZS5tZXRyaWNzLmp2bS5NZW1vcnlVc2FnZUdhdWdlU2V0OwoKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5zdGF0cy5TdGF0c0xvZ2dlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5zdGF0cy5TdGF0c1Byb3Zp\nZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbmZpZ3VyYXRpb24u\nQ29uZmlndXJhdGlvbjsKCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5UaW1lVW5pdDsKCmltcG9ydCBqYXZhLmlvLkZpbGU7CgppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwoKcHVibGljIGNsYXNzIENvZGFoYWxlTWV0cmljc1Byb3ZpZGVyIGlt\ncGxlbWVudHMgU3RhdHNQcm92aWRlciB7CgogICAgc3RhdGljIGZpbmFsIExv\nZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihDb2RhaGFsZU1l\ndHJpY3NQcm92aWRlci5jbGFzcyk7CgogICAgTWV0cmljUmVnaXN0cnkgbWV0\ncmljcyA9IG51bGw7CiAgICBMaXN0PFNjaGVkdWxlZFJlcG9ydGVyPiByZXBv\ncnRlcnMgPSBuZXcgQXJyYXlMaXN0PFNjaGVkdWxlZFJlcG9ydGVyPigpOwog\nICAgSm14UmVwb3J0ZXIgam14ID0gbnVsbDsKCiAgICBzeW5jaHJvbml6ZWQg\ndm9pZCBpbml0SWZOZWNlc3NhcnkoKSB7CiAgICAgICAgaWYgKG1ldHJpY3Mg\nPT0gbnVsbCkgewogICAgICAgICAgICBtZXRyaWNzID0gbmV3IE1ldHJpY1Jl\nZ2lzdHJ5KCk7CiAgICAgICAgICAgIG1ldHJpY3MucmVnaXN0ZXJBbGwobmV3\nIE1lbW9yeVVzYWdlR2F1Z2VTZXQoKSk7CiAgICAgICAgICAgIG1ldHJpY3Mu\ncmVnaXN0ZXJBbGwobmV3IEdhcmJhZ2VDb2xsZWN0b3JNZXRyaWNTZXQoKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIHN5bmNocm9uaXplZCBNZXRyaWNSZWdp\nc3RyeSBnZXRNZXRyaWNzKCkgewogICAgICAgIHJldHVybiBtZXRyaWNzOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc3RhcnQoQ29u\nZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgaW5pdElmTmVjZXNzYXJ5KCk7\nCgogICAgICAgIGludCBtZXRyaWNzT3V0cHV0RnJlcXVlbmN5ID0gY29uZi5n\nZXRJbnQoImNvZGFoYWxlU3RhdHNPdXRwdXRGcmVxdWVuY3lTZWNvbmRzIiwg\nNjApOwogICAgICAgIFN0cmluZyBwcmVmaXggPSBjb25mLmdldFN0cmluZygi\nY29kYWhhbGVTdGF0c1ByZWZpeCIsICIiKTsKICAgICAgICBTdHJpbmcgZ3Jh\ncGhpdGVIb3N0ID0gY29uZi5nZXRTdHJpbmcoImNvZGFoYWxlU3RhdHNHcmFw\naGl0ZUVuZHBvaW50Iik7CiAgICAgICAgU3RyaW5nIGNzdkRpciA9IGNvbmYu\nZ2V0U3RyaW5nKCJjb2RhaGFsZVN0YXRzQ1NWRW5kcG9pbnQiKTsKICAgICAg\nICBTdHJpbmcgc2xmNGpDYXQgPSBjb25mLmdldFN0cmluZygiY29kYWhhbGVT\ndGF0c1NsZjRqRW5kcG9pbnQiKTsKICAgICAgICBTdHJpbmcgam14RG9tYWlu\nID0gY29uZi5nZXRTdHJpbmcoImNvZGFoYWxlU3RhdHNKbXhFbmRwb2ludCIp\nOwoKICAgICAgICBpZiAoIVN0cmluZ3MuaXNOdWxsT3JFbXB0eShncmFwaGl0\nZUhvc3QpKSB7CiAgICAgICAgICAgIExPRy5pbmZvKCJDb25maWd1cmluZyBz\ndGF0cyB3aXRoIGdyYXBoaXRlIik7CiAgICAgICAgICAgIEhvc3RBbmRQb3J0\nIGFkZHIgPSBIb3N0QW5kUG9ydC5mcm9tU3RyaW5nKGdyYXBoaXRlSG9zdCk7\nCiAgICAgICAgICAgIGZpbmFsIEdyYXBoaXRlIGdyYXBoaXRlID0gbmV3IEdy\nYXBoaXRlKAogICAgICAgICAgICAgICAgICAgIG5ldyBJbmV0U29ja2V0QWRk\ncmVzcyhhZGRyLmdldEhvc3RUZXh0KCksIGFkZHIuZ2V0UG9ydCgpKSk7CiAg\nICAgICAgICAgIHJlcG9ydGVycy5hZGQoR3JhcGhpdGVSZXBvcnRlci5mb3JS\nZWdpc3RyeShnZXRNZXRyaWNzKCkpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgLnByZWZpeGVkV2l0aChwcmVmaXgpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgLmNvbnZlcnRSYXRlc1RvKFRpbWVVbml0LlNFQ09ORFMpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgLmNvbnZlcnREdXJhdGlvbnNUbyhUaW1l\nVW5pdC5NSUxMSVNFQ09ORFMpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nLmZpbHRlcihNZXRyaWNGaWx0ZXIuQUxMKQogICAgICAgICAgICAgICAgICAg\nICAgICAgIC5idWlsZChncmFwaGl0ZSkpOwogICAgICAgIH0KICAgICAgICBp\nZiAoIVN0cmluZ3MuaXNOdWxsT3JFbXB0eShjc3ZEaXIpKSB7CiAgICAgICAg\nICAgIC8vIE5PVEU6IDEvIG1ldHJpY3Mgb3V0cHV0IGZpbGVzIGFyZSBleGNs\ndXNpdmUgdG8gYSBnaXZlbiBwcm9jZXNzCiAgICAgICAgICAgIC8vIDIvIHRo\nZSBvdXRwdXQgZGlyZWN0b3J5IG11c3QgZXhpc3QKICAgICAgICAgICAgLy8g\nMy8gaWYgb3V0cHV0IGZpbGVzIGFscmVhZHkgZXhpc3QgdGhleSBhcmUgbm90\nIG92ZXJ3cml0dGVuIGFuZCB0aGVyZSBpcyBubyBtZXRyaWNzIG91dHB1dAog\nICAgICAgICAgICBGaWxlIG91dGRpcjsKICAgICAgICAgICAgaWYgKFN0cmlu\nZ3MuaXNOdWxsT3JFbXB0eShwcmVmaXgpKSB7CiAgICAgICAgICAgICAgICBv\ndXRkaXIgPSBuZXcgRmlsZShjc3ZEaXIsIHByZWZpeCk7CiAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBvdXRkaXIgPSBuZXcgRmlsZShj\nc3ZEaXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIExPRy5pbmZvKCJD\nb25maWd1cmluZyBzdGF0cyB3aXRoIGNzdiBvdXRwdXQgdG8gZGlyZWN0b3J5\nIFt7fV0iLCBvdXRkaXIuZ2V0QWJzb2x1dGVQYXRoKCkpOwogICAgICAgICAg\nICByZXBvcnRlcnMuYWRkKENzdlJlcG9ydGVyLmZvclJlZ2lzdHJ5KGdldE1l\ndHJpY3MoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAuY29udmVydFJh\ndGVzVG8oVGltZVVuaXQuU0VDT05EUykKICAgICAgICAgICAgICAgICAgICAg\nICAgICAuY29udmVydER1cmF0aW9uc1RvKFRpbWVVbml0Lk1JTExJU0VDT05E\nUykKICAgICAgICAgICAgICAgICAgICAgICAgICAuYnVpbGQob3V0ZGlyKSk7\nCiAgICAgICAgfQogICAgICAgIGlmICghU3RyaW5ncy5pc051bGxPckVtcHR5\nKHNsZjRqQ2F0KSkgewogICAgICAgICAgICBMT0cuaW5mbygiQ29uZmlndXJp\nbmcgc3RhdHMgd2l0aCBzbGY0aiIpOwogICAgICAgICAgICByZXBvcnRlcnMu\nYWRkKFNsZjRqUmVwb3J0ZXIuZm9yUmVnaXN0cnkoZ2V0TWV0cmljcygpKQog\nICAgICAgICAgICAgICAgICAgICAgICAgIC5vdXRwdXRUbyhMb2dnZXJGYWN0\nb3J5LmdldExvZ2dlcihzbGY0akNhdCkpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgLmNvbnZlcnRSYXRlc1RvKFRpbWVVbml0LlNFQ09ORFMpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgLmNvbnZlcnREdXJhdGlvbnNUbyhUaW1l\nVW5pdC5NSUxMSVNFQ09ORFMpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nLmJ1aWxkKCkpOwogICAgICAgIH0KICAgICAgICBpZiAoIVN0cmluZ3MuaXNO\ndWxsT3JFbXB0eShqbXhEb21haW4pKSB7CiAgICAgICAgICAgIExPRy5pbmZv\nKCJDb25maWd1cmluZyBzdGF0cyB3aXRoIGpteCIpOwogICAgICAgICAgICBq\nbXggPSBKbXhSZXBvcnRlci5mb3JSZWdpc3RyeShnZXRNZXRyaWNzKCkpCiAg\nICAgICAgICAgICAgICAuaW5Eb21haW4oam14RG9tYWluKQogICAgICAgICAg\nICAgICAgLmNvbnZlcnRSYXRlc1RvKFRpbWVVbml0LlNFQ09ORFMpCiAgICAg\nICAgICAgICAgICAuY29udmVydER1cmF0aW9uc1RvKFRpbWVVbml0Lk1JTExJ\nU0VDT05EUykKICAgICAgICAgICAgICAgIC5idWlsZCgpOwogICAgICAgICAg\nICBqbXguc3RhcnQoKTsKICAgICAgICB9CgogICAgICAgIGZvciAoU2NoZWR1\nbGVkUmVwb3J0ZXIgciA6IHJlcG9ydGVycykgewogICAgICAgICAgICByLnN0\nYXJ0KG1ldHJpY3NPdXRwdXRGcmVxdWVuY3ksIFRpbWVVbml0LlNFQ09ORFMp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHN0b3AoKSB7CiAgICAgICAgZm9yIChTY2hlZHVsZWRSZXBvcnRlciBy\nIDogcmVwb3J0ZXJzKSB7CiAgICAgICAgICAgIHIucmVwb3J0KCk7CiAgICAg\nICAgICAgIHIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAoam14ICE9\nIG51bGwpIHsKICAgICAgICAgICAgam14LnN0b3AoKTsKICAgICAgICB9CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RhdHNMb2dnZXIgZ2V0\nU3RhdHNMb2dnZXIoU3RyaW5nIG5hbWUpIHsKICAgICAgICBpbml0SWZOZWNl\nc3NhcnkoKTsKICAgICAgICByZXR1cm4gbmV3IENvZGFoYWxlU3RhdHNMb2dn\nZXIoZ2V0TWV0cmljcygpLCBuYW1lKTsKICAgIH0KfQo=\n","encoding":"base64"}

