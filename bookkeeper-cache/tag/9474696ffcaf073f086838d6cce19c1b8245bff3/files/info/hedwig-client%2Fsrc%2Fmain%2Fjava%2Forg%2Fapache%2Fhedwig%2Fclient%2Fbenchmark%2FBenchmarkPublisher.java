{"sha":"af075c02dae745b39c4d9c244b1f1e9e83bbe87a","node_id":"MDQ6QmxvYjE1NzU5NTY6YWYwNzVjMDJkYWU3NDViMzljNGQ5YzI0NGIxZjFlOWU4M2JiZTg3YQ==","size":5713,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/af075c02dae745b39c4d9c244b1f1e9e83bbe87a","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrOwoKaW1w\nb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKCmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5NYXRoVXRpbHM7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5QdWJsaXNoZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLlN1YnNjcmli\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJr\nLkJlbmNobWFya1V0aWxzLkJlbmNobWFya0NhbGxiYWNrOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuY2xpZW50LmJlbmNobWFyay5CZW5jaG1hcmtVdGls\ncy5UaHJvdWdocHV0TGF0ZW5jeUFnZ3JlZ2F0b3I7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuU3Vic2NyaXB0aW9uT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmliZVJlcXVlc3Qu\nQ3JlYXRlT3JBdHRhY2g7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGls\nLkNhbGxiYWNrOwoKcHVibGljIGNsYXNzIEJlbmNobWFya1B1Ymxpc2hlciBl\neHRlbmRzIEJlbmNobWFya1dvcmtlciB7CiAgICBQdWJsaXNoZXIgcHVibGlz\naGVyOwogICAgU3Vic2NyaWJlciBzdWJzY3JpYmVyOwogICAgaW50IG1zZ1Np\nemU7CiAgICBpbnQgblBhcmFsbGVsOwogICAgZG91YmxlIHJhdGU7CgogICAg\ncHVibGljIEJlbmNobWFya1B1Ymxpc2hlcihpbnQgbnVtVG9waWNzLCBpbnQg\nbnVtTWVzc2FnZXMsIGludCBudW1SZWdpb25zLCBpbnQgc3RhcnRUb3BpY0xh\nYmVsLCBpbnQgcGFydGl0aW9uSW5kZXgsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGludCBudW1QYXJ0aXRpb25zLCBQdWJsaXNoZXIgcHVibGlz\naGVyLCBTdWJzY3JpYmVyIHN1YnNjcmliZXIsIGludCBtc2dTaXplLCBpbnQg\nblBhcmFsbGVsLCBpbnQgcmF0ZSkgewogICAgICAgIHN1cGVyKG51bVRvcGlj\ncywgbnVtTWVzc2FnZXMsIG51bVJlZ2lvbnMsIHN0YXJ0VG9waWNMYWJlbCwg\ncGFydGl0aW9uSW5kZXgsIG51bVBhcnRpdGlvbnMpOwogICAgICAgIHRoaXMu\ncHVibGlzaGVyID0gcHVibGlzaGVyOwogICAgICAgIHRoaXMubXNnU2l6ZSA9\nIG1zZ1NpemU7CiAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJl\ncjsKICAgICAgICB0aGlzLm5QYXJhbGxlbCA9IG5QYXJhbGxlbDsKCiAgICAg\nICAgdGhpcy5yYXRlID0gcmF0ZSAvIChudW1SZWdpb25zICogbnVtUGFydGl0\naW9ucyArIDAuMCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgd2FybXVwKGlu\ndCBuV2FybXVwKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3Ry\naW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIndhcm11cCIg\nKyBwYXJ0aXRpb25JbmRleCk7CiAgICAgICAgQnl0ZVN0cmluZyBzdWJJZCA9\nIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJzdWIiKTsKICAgICAgICBTdWJz\nY3JpcHRpb25PcHRpb25zIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5l\nd0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3Jl\nYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAg\nICBzdWJzY3JpYmVyLnN1YnNjcmliZSh0b3BpYywgc3ViSWQsIG9wdHMpOwoK\nICAgICAgICBzdWJzY3JpYmVyLnN0YXJ0RGVsaXZlcnkodG9waWMsIHN1Yklk\nLCBuZXcgTWVzc2FnZUhhbmRsZXIoKSB7CiAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBkZWxpdmVyKEJ5dGVTdHJpbmcg\ndG9waWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBNZXNzYWdlIG1zZywg\nQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssCiAgICAgICAgICAgIE9iamVjdCBj\nb250ZXh0KSB7CiAgICAgICAgICAgICAgICAvLyBub29wCiAgICAgICAgICAg\nICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjb250ZXh0LCBudWxs\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyBwaWNr\naW5nIGNvbnN0YW50cyBhcmJpdGFyaWx5IGZvciB3YXJtdXAgcGhhc2UKICAg\nICAgICBUaHJvdWdocHV0TGF0ZW5jeUFnZ3JlZ2F0b3IgYWdnID0gbmV3IFRo\ncm91Z2hwdXRMYXRlbmN5QWdncmVnYXRvcigiYWNrZWQgcHVicyIsIG5XYXJt\ndXAsIDEwMCk7CiAgICAgICAgYWdnLnN0YXJ0UHJvZ3Jlc3MoKTsKCiAgICAg\nICAgTWVzc2FnZSBtc2cgPSBnZXRNc2coMTAyNCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBuV2FybXVwOyBpKyspIHsKICAgICAgICAgICAgcHVi\nbGlzaGVyLmFzeW5jUHVibGlzaCh0b3BpYywgbXNnLCBuZXcgQmVuY2htYXJr\nQ2FsbGJhY2soYWdnKSwgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICBpZiAo\nYWdnLnRwQWdnLnF1ZXVlLnRha2UoKSA+IDApIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oIldhcm11cCBwdWJsaXNoZXMgZmFp\nbGVkISIpOwogICAgICAgIH0KCiAgICB9CgogICAgcHVibGljIE1lc3NhZ2Ug\nZ2V0TXNnKGludCBzaXplKSB7CiAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9\nIG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzaXplOyBpKyspIHsKICAgICAgICAgICAgc2IuYXBwZW5kKCdhJyk7\nCiAgICAgICAgfQogICAgICAgIGZpbmFsIEJ5dGVTdHJpbmcgYm9keSA9IEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KHNiLnRvU3RyaW5nKCkpOwogICAgICAg\nIE1lc3NhZ2UgbXNnID0gTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keShi\nb2R5KS5idWlsZCgpOwogICAgICAgIHJldHVybiBtc2c7CiAgICB9CgogICAg\ncHVibGljIFZvaWQgY2FsbCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIE1lc3NhZ2UgbXNnID0gZ2V0TXNnKG1zZ1NpemUpOwoKICAgICAgICAvLyBT\naW5nbGUgd2FybXVwIGZvciBldmVyeSB0b3BpYwogICAgICAgIGludCBteVB1\nYmxpc2hDb3VudCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBu\ndW1Ub3BpY3M7IGkrKykgewogICAgICAgICAgICBpZiAoIUhlZHdpZ0JlbmNo\nbWFyay5hbUlSZXNwb25zaWJsZUZvclRvcGljKHN0YXJ0VG9waWNMYWJlbCAr\nIGksIHBhcnRpdGlvbkluZGV4LCBudW1QYXJ0aXRpb25zKSkgewogICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KEhl\nZHdpZ0JlbmNobWFyay5UT1BJQ19QUkVGSVggKyAoc3RhcnRUb3BpY0xhYmVs\nICsgaSkpOwogICAgICAgICAgICBwdWJsaXNoZXIucHVibGlzaCh0b3BpYywg\nbXNnKTsKICAgICAgICAgICAgbXlQdWJsaXNoQ291bnQrKzsKICAgICAgICB9\nCgogICAgICAgIGxvbmcgc3RhcnRUaW1lID0gTWF0aFV0aWxzLm5vdygpOwog\nICAgICAgIGludCBteVB1Ymxpc2hMaW1pdCA9IG51bU1lc3NhZ2VzIC8gbnVt\nUmVnaW9ucyAvIG51bVBhcnRpdGlvbnMgLSBteVB1Ymxpc2hDb3VudDsKICAg\nICAgICBteVB1Ymxpc2hDb3VudCA9IDA7CiAgICAgICAgVGhyb3VnaHB1dExh\ndGVuY3lBZ2dyZWdhdG9yIGFnZyA9IG5ldyBUaHJvdWdocHV0TGF0ZW5jeUFn\nZ3JlZ2F0b3IoImFja2VkIHB1YnMiLCBteVB1Ymxpc2hMaW1pdCwgblBhcmFs\nbGVsKTsKICAgICAgICBhZ2cuc3RhcnRQcm9ncmVzcygpOwoKICAgICAgICBp\nbnQgdG9waWNMYWJlbCA9IDA7CgogICAgICAgIHdoaWxlIChteVB1Ymxpc2hD\nb3VudCA8IG15UHVibGlzaExpbWl0KSB7CiAgICAgICAgICAgIGludCB0b3Bp\nY051bSA9IHN0YXJ0VG9waWNMYWJlbCArIHRvcGljTGFiZWw7CiAgICAgICAg\nICAgIHRvcGljTGFiZWwgPSAodG9waWNMYWJlbCArIDEpICUgbnVtVG9waWNz\nOwoKICAgICAgICAgICAgaWYgKCFIZWR3aWdCZW5jaG1hcmsuYW1JUmVzcG9u\nc2libGVGb3JUb3BpYyh0b3BpY051bSwgcGFydGl0aW9uSW5kZXgsIG51bVBh\ncnRpdGlvbnMpKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVT\ndHJpbmcuY29weUZyb21VdGY4KEhlZHdpZ0JlbmNobWFyay5UT1BJQ19QUkVG\nSVggKyB0b3BpY051bSk7CgogICAgICAgICAgICBpZiAocmF0ZSA+IDApIHsK\nICAgICAgICAgICAgICAgIGxvbmcgZGVsYXkgPSBzdGFydFRpbWUgKyAobG9u\nZykgKDEwMDAgKiBteVB1Ymxpc2hDb3VudCAvIHJhdGUpIC0gTWF0aFV0aWxz\nLm5vdygpOwogICAgICAgICAgICAgICAgaWYgKGRlbGF5ID4gMCkKICAgICAg\nICAgICAgICAgICAgICBUaHJlYWQuc2xlZXAoZGVsYXkpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2godG9waWMs\nIG1zZywgbmV3IEJlbmNobWFya0NhbGxiYWNrKGFnZyksIG51bGwpOwogICAg\nICAgICAgICBteVB1Ymxpc2hDb3VudCsrOwogICAgICAgIH0KCiAgICAgICAg\nU3lzdGVtLm91dC5wcmludGxuKCJGaW5pc2hlZCB1bmFja2VkIHB1YnM6IHRw\ndXQgPSAiICsgQmVuY2htYXJrVXRpbHMuY2FsY1RwKG15UHVibGlzaExpbWl0\nLCBzdGFydFRpbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBv\ncHMvcyIpOwogICAgICAgIC8vIFdhaXQgdGlsbCB0aGUgYmVuY2htYXJrIHRl\nc3QgaGFzIGNvbXBsZXRlZAogICAgICAgIGFnZy50cEFnZy5xdWV1ZS50YWtl\nKCk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKGFnZy5zdW1tYXJpemUo\nc3RhcnRUaW1lKSk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

