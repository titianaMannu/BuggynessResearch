{"sha":"0f8cb7f381c7407e63601cf737cddab530d20123","node_id":"MDQ6QmxvYjE1NzU5NTY6MGY4Y2I3ZjM4MWM3NDA3ZTYzNjAxY2Y3MzdjZGRhYjUzMGQyMDEyMw==","size":6306,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0f8cb7f381c7407e63601cf737cddab530d20123","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrOwoKaW1w\nb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNhbGxhYmxlOwoKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFj\ndG9yeTsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7\nCgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuTWF0aFV0aWxz\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5NZXNzYWdl\nSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGku\nU3Vic2NyaWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5i\nZW5jaG1hcmsuQmVuY2htYXJrVXRpbHMuQmVuY2htYXJrQ2FsbGJhY2s7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrLkJlbmNo\nbWFya1V0aWxzLlRocm91Z2hwdXRBZ2dyZWdhdG9yOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuY2xpZW50LmJlbmNobWFyay5CZW5jaG1hcmtVdGlscy5U\naHJvdWdocHV0TGF0ZW5jeUFnZ3JlZ2F0b3I7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nUmVnaW9uU3BlY2lmaWNTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmliZVJlcXVlc3QuQ3Jl\nYXRlT3JBdHRhY2g7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazsKCnB1YmxpYyBjbGFz\ncyBCZW5jaG1hcmtTdWJzY3JpYmVyIGV4dGVuZHMgQmVuY2htYXJrV29ya2Vy\nIGltcGxlbWVudHMgQ2FsbGFibGU8Vm9pZD4gewogICAgc3RhdGljIGZpbmFs\nIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihCZW5j\naG1hcmtTdWJzY3JpYmVyLmNsYXNzKTsKICAgIFN1YnNjcmliZXIgc3Vic2Ny\naWJlcjsKICAgIEJ5dGVTdHJpbmcgc3ViSWQ7CgoKICAgIHB1YmxpYyBCZW5j\naG1hcmtTdWJzY3JpYmVyKGludCBudW1Ub3BpY3MsIGludCBudW1NZXNzYWdl\ncywgaW50IG51bVJlZ2lvbnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBpbnQgc3RhcnRUb3BpY0xhYmVsLCBpbnQgcGFydGl0aW9uSW5kZXgs\nIGludCBudW1QYXJ0aXRpb25zLCBTdWJzY3JpYmVyIHN1YnNjcmliZXIsIEJ5\ndGVTdHJpbmcgc3ViSWQpIHsKICAgICAgICBzdXBlcihudW1Ub3BpY3MsIG51\nbU1lc3NhZ2VzLCBudW1SZWdpb25zLCBzdGFydFRvcGljTGFiZWwsIHBhcnRp\ndGlvbkluZGV4LCBudW1QYXJ0aXRpb25zKTsKICAgICAgICB0aGlzLnN1YnNj\ncmliZXIgPSBzdWJzY3JpYmVyOwogICAgICAgIHRoaXMuc3ViSWQgPSBzdWJJ\nZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3YXJtdXAoaW50IG51bVdhcm11\ncCkgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAvKgog\nICAgICAgICAqIG11bHRpcGx5aW5nIHRoZSBudW1iZXIgb2Ygb3BzIGJ5IG51\nbVBhcml0aW9ucyBiZWNhdXNlIHdlIGVuZCB1cAogICAgICAgICAqIHNraXBw\naW5nIG1hbnkgYmVjYXVzZSBvZiB0aGUgcGFydGl0aW9uaW5nIGxvZ2ljCiAg\nICAgICAgICovCiAgICAgICAgbXVsdGlTdWIoIndhcm11cCIsICJ3YXJtdXAi\nLCAwLCBudW1XYXJtdXAsIG51bVdhcm11cCAqIG51bVBhcnRpdGlvbnMpOwog\nICAgfQoKICAgIHB1YmxpYyBWb2lkIGNhbGwoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKCiAgICAgICAgZmluYWwgVGhyb3VnaHB1dEFnZ3JlZ2F0b3IgYWdnID0g\nbmV3IFRocm91Z2hwdXRBZ2dyZWdhdG9yKCJyZWN2cyIsIG51bU1lc3NhZ2Vz\nKTsKICAgICAgICBhZ2cuc3RhcnRQcm9ncmVzcygpOwoKICAgICAgICBmaW5h\nbCBNYXA8U3RyaW5nLCBMb25nPiBsYXN0U2VxSWRTZWVuTWFwID0gbmV3IEhh\nc2hNYXA8U3RyaW5nLCBMb25nPigpOwoKICAgICAgICBmb3IgKGludCBpID0g\nc3RhcnRUb3BpY0xhYmVsOyBpIDwgc3RhcnRUb3BpY0xhYmVsICsgbnVtVG9w\naWNzOyBpKyspIHsKCiAgICAgICAgICAgIGlmICghSGVkd2lnQmVuY2htYXJr\nLmFtSVJlc3BvbnNpYmxlRm9yVG9waWMoaSwgcGFydGl0aW9uSW5kZXgsIG51\nbVBhcnRpdGlvbnMpKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgZmluYWwgU3RyaW5nIHRvcGljID0g\nSGVkd2lnQmVuY2htYXJrLlRPUElDX1BSRUZJWCArIGk7CgogICAgICAgICAg\nICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRp\nb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgLnNldENyZWF0ZU9y\nQXR0YWNoKENyZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxk\nKCk7CiAgICAgICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KHRvcGljKSwgc3ViSWQsIG9wdHMpOwogICAgICAg\nICAgICBzdWJzY3JpYmVyLnN0YXJ0RGVsaXZlcnkoQnl0ZVN0cmluZy5jb3B5\nRnJvbVV0ZjgodG9waWMpLCBzdWJJZCwgbmV3IE1lc3NhZ2VIYW5kbGVyKCkg\newoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgZGVsaXZlcihCeXRlU3RyaW5nIHRoaXNUb3BpYywgQnl0\nZVN0cmluZyBzdWJzY3JpYmVySWQsIE1lc3NhZ2UgbXNnLAogICAgICAgICAg\nICAgICAgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIE9iamVjdCBjb250ZXh0\nKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJHb3QgbWVz\nc2FnZSBmcm9tIHNyYy1yZWdpb246IHt9IHdpdGggc2VxLWlkOiB7fSIsCiAg\nICAgICAgICAgICAgICAgICAgICAgIG1zZy5nZXRTcmNSZWdpb24oKSwgbXNn\nLmdldE1zZ0lkKCkpOwoKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbWFw\nS2V5ID0gdG9waWMgKyBtc2cuZ2V0U3JjUmVnaW9uKCkudG9TdHJpbmdVdGY4\nKCk7CiAgICAgICAgICAgICAgICAgICAgTG9uZyBsYXN0U2VxSWRTZWVuID0g\nbGFzdFNlcUlkU2Vlbk1hcC5nZXQobWFwS2V5KTsKICAgICAgICAgICAgICAg\nICAgICBpZiAobGFzdFNlcUlkU2VlbiA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGxhc3RTZXFJZFNlZW4gPSAobG9uZykgMDsKICAgICAg\nICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChnZXRT\ncmNTZXFJZChtc2cpIDw9IGxhc3RTZXFJZFNlZW4pIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlJlZGVsaXZlcnkgb2YgbWVzc2Fn\nZSwgc3JjLXJlZ2lvbjogIiArIG1zZy5nZXRTcmNSZWdpb24oKSArICJzZXEt\naWQ6ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBt\nc2cuZ2V0TXNnSWQoKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgYWdnLmRpbmcoZmFsc2UpOwogICAg\nICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY2FsbGJh\nY2sub3BlcmF0aW9uRmluaXNoZWQoY29udGV4dCwgbnVsbCk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIkZpbmlzaGVkIHN1YnNjcmliaW5nIHRvIHRv\ncGljcyBhbmQgbm93IHdhaXRpbmcgZm9yIG1lc3NhZ2VzIHRvIGNvbWUgaW4u\nLi4iKTsKICAgICAgICAvLyBXYWl0IHRpbGwgdGhlIGJlbmNobWFyayB0ZXN0\nIGhhcyBjb21wbGV0ZWQKICAgICAgICBhZ2cucXVldWUudGFrZSgpOwogICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbihhZ2cuc3VtbWFyaXplKGFnZy5lYXJs\naWVzdC5nZXQoKSkpOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAg\nIGxvbmcgZ2V0U3JjU2VxSWQoTWVzc2FnZSBtc2cpIHsKICAgICAgICBpZiAo\nbXNnLmdldE1zZ0lkKCkuZ2V0UmVtb3RlQ29tcG9uZW50c0NvdW50KCkgPT0g\nMCkgewogICAgICAgICAgICByZXR1cm4gbXNnLmdldE1zZ0lkKCkuZ2V0TG9j\nYWxDb21wb25lbnQoKTsKICAgICAgICB9CgogICAgICAgIGZvciAoUmVnaW9u\nU3BlY2lmaWNTZXFJZCByc2VxSWQgOiBtc2cuZ2V0TXNnSWQoKS5nZXRSZW1v\ndGVDb21wb25lbnRzTGlzdCgpKSB7CiAgICAgICAgICAgIGlmIChyc2VxSWQu\nZ2V0UmVnaW9uKCkuZXF1YWxzKG1zZy5nZXRTcmNSZWdpb24oKSkpCiAgICAg\nICAgICAgICAgICByZXR1cm4gcnNlcUlkLmdldFNlcUlkKCk7CiAgICAgICAg\nfQoKICAgICAgICByZXR1cm4gbXNnLmdldE1zZ0lkKCkuZ2V0TG9jYWxDb21w\nb25lbnQoKTsKICAgIH0KCiAgICB2b2lkIG11bHRpU3ViKFN0cmluZyBsYWJl\nbCwgU3RyaW5nIHRvcGljUHJlZml4LCBpbnQgc3RhcnQsIGZpbmFsIGludCBu\ncGFyLCBmaW5hbCBpbnQgY291bnQpCiAgICAgICAgICAgIHRocm93cyBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgbG9uZyBzdGFydFRpbWUgPSBN\nYXRoVXRpbHMubm93KCk7CiAgICAgICAgVGhyb3VnaHB1dExhdGVuY3lBZ2dy\nZWdhdG9yIGFnZyA9IG5ldyBUaHJvdWdocHV0TGF0ZW5jeUFnZ3JlZ2F0b3Io\nbGFiZWwsIGNvdW50IC8gbnVtUGFydGl0aW9ucywgbnBhcik7CiAgICAgICAg\nYWdnLnN0YXJ0UHJvZ3Jlc3MoKTsKCiAgICAgICAgaW50IGVuZCA9IHN0YXJ0\nICsgY291bnQ7CiAgICAgICAgZm9yIChpbnQgaSA9IHN0YXJ0OyBpIDwgZW5k\nOyArK2kpIHsKICAgICAgICAgICAgaWYgKCFIZWR3aWdCZW5jaG1hcmsuYW1J\nUmVzcG9uc2libGVGb3JUb3BpYyhpLCBwYXJ0aXRpb25JbmRleCwgbnVtUGFy\ndGl0aW9ucykpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0cyA9\nIFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAg\nICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRF\nX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICAgICAgc3Vic2NyaWJlci5h\nc3luY1N1YnNjcmliZShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCh0b3BpY1By\nZWZpeCArIGkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHN1YklkLCBvcHRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG5ldyBCZW5jaG1hcmtDYWxsYmFjayhhZ2cpLCBudWxsKTsK\nICAgICAgICB9CiAgICAgICAgLy8gV2FpdCB0aWxsIHRoZSBiZW5jaG1hcmsg\ndGVzdCBoYXMgY29tcGxldGVkCiAgICAgICAgYWdnLnRwQWdnLnF1ZXVlLnRh\na2UoKTsKICAgICAgICBpZiAoY291bnQgPiAxKQogICAgICAgICAgICBTeXN0\nZW0ub3V0LnByaW50bG4oYWdnLnN1bW1hcml6ZShzdGFydFRpbWUpKTsKICAg\nIH0KCn0K\n","encoding":"base64"}

