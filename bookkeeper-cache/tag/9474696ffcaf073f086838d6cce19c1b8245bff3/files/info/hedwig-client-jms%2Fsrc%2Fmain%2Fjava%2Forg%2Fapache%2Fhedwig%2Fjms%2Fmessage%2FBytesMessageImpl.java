{"sha":"fb564dcd5c23e9471741c7a8c439ef48140482cb","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmI1NjRkY2Q1YzIzZTk0NzE3NDFjN2E4YzQzOWVmNDgxNDA0ODJjYg==","size":22759,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fb564dcd5c23e9471741c7a8c439ef48140482cb","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMubWVzc2FnZTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5qbXMuU2Vzc2lvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbDsKCmltcG9ydCBqYXZh\neC5qbXMuQnl0ZXNNZXNzYWdlOwppbXBvcnQgamF2YXguam1zLkpNU0V4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmF4Lmptcy5NZXNzYWdlOwppbXBvcnQgamF2YXgu\nam1zLk1lc3NhZ2VFT0ZFeGNlcHRpb247CmltcG9ydCBqYXZheC5qbXMuTWVz\nc2FnZU5vdFJlYWRhYmxlRXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1l\nc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLkJ5\ndGVBcnJheUlucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5CeXRlQXJyYXlP\ndXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkRhdGFJbnB1dFN0cmVhbTsK\naW1wb3J0IGphdmEuaW8uRGF0YU91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKLyoqCiAq\nIFRvIGJlIHVzZWQgZm9yIHJhdyBieXRlcyAuLi4KICovCnB1YmxpYyBjbGFz\ncyBCeXRlc01lc3NhZ2VJbXBsIGV4dGVuZHMgTWVzc2FnZUltcGwgaW1wbGVt\nZW50cyBCeXRlc01lc3NhZ2UgewogICAgcHJpdmF0ZSBSZWFkT25seU1lc3Nh\nZ2UgcmVhZE9ubHlNZXNzYWdlOwogICAgcHJpdmF0ZSBXcml0ZU9ubHlNZXNz\nYWdlIHdyaXRlT25seU1lc3NhZ2U7CiAgICBwcml2YXRlIGJvb2xlYW4gcmVh\nZE1vZGU7CgogICAgcHVibGljIEJ5dGVzTWVzc2FnZUltcGwoU2Vzc2lvbklt\ncGwgc2Vzc2lvbikgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgc3Vw\nZXIoc2Vzc2lvbik7CiAgICAgICAgY2xlYXJCb2R5KCk7CiAgICB9CgogICAg\nLy8gVG8gY2xvbmUgYSBtZXNzYWdlCiAgICBwdWJsaWMgQnl0ZXNNZXNzYWdl\nSW1wbChTZXNzaW9uSW1wbCBzZXNzaW9uLCBCeXRlc01lc3NhZ2VJbXBsIG1l\nc3NhZ2UsIFN0cmluZyBzb3VyY2VUb3BpY05hbWUsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBTdHJpbmcgc3Vic2NyaWJlcklkKSB0aHJvd3MgSk1T\nRXhjZXB0aW9uIHsKICAgICAgICBzdXBlcihzZXNzaW9uLCAoTWVzc2FnZUlt\ncGwpIG1lc3NhZ2UsIHNvdXJjZVRvcGljTmFtZSwgc3Vic2NyaWJlcklkKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAobWVzc2FnZS5yZWFkTW9k\nZSl7CiAgICAgICAgICAgICAgICB0aGlzLnJlYWRPbmx5TWVzc2FnZSA9IG5l\ndyBSZWFkT25seU1lc3NhZ2UobWVzc2FnZS5yZWFkT25seU1lc3NhZ2UuZ2V0\nRGF0YUNvcHkoKSk7CiAgICAgICAgICAgICAgICB0aGlzLndyaXRlT25seU1l\nc3NhZ2UgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2Ug\newogICAgICAgICAgICAgICAgdGhpcy5yZWFkT25seU1lc3NhZ2UgPSBudWxs\nOwogICAgICAgICAgICAgICAgdGhpcy53cml0ZU9ubHlNZXNzYWdlID0gbmV3\nIFdyaXRlT25seU1lc3NhZ2UobWVzc2FnZS53cml0ZU9ubHlNZXNzYWdlLmdl\ndFBheWxvYWRBc0J5dGVzKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSBj\nYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICBKTVNFeGNlcHRp\nb24gZXggPSBuZXcgSk1TRXhjZXB0aW9uKCJVbmFibGUgdG8gY2xvbmUvY29w\neSBpbnB1dCBtZXNzYWdlICIgKyBtZXNzYWdlICsgIiAuLiAiICsgZSk7CiAg\nICAgICAgICAgIGV4LnNldExpbmtlZEV4Y2VwdGlvbihlKTsKICAgICAgICAg\nICAgdGhyb3cgZXg7CiAgICAgICAgfQogICAgICAgIHRoaXMucmVhZE1vZGUg\nPSBtZXNzYWdlLnJlYWRNb2RlOwogICAgfQoKICAgIC8vIFRvIGNsb25lIGEg\nbWVzc2FnZSBmcm9tIGEgQnl0ZXNNZXNzYWdlIHdoaWNoIGlzIE5PVCBCeXRl\nc01lc3NhZ2VJbXBsCiAgICAvLyBDaGFuZ2luZyBvcmRlciBvZiBwYXJhbWV0\nZXIgdG8gTk9UIGFjY2lkZW50YWxseSBjbGFzaCB3aXRoIHRoZSBjb25zdHJ1\nY3RvciBhYm92ZS4KICAgIC8vIFRoaXMgaXMgbWlkbHkgY29uZnVzaW5nLCBi\ndXQgaGVscHMgYSBsb3QgaW4gcHJldmVudGluZyBhY2NpZGVudGFsIGJ1Z3Mg\nIQogICAgcHVibGljIEJ5dGVzTWVzc2FnZUltcGwoQnl0ZXNNZXNzYWdlIG1l\nc3NhZ2UsIFNlc3Npb25JbXBsIHNlc3Npb24pIHRocm93cyBKTVNFeGNlcHRp\nb24gewogICAgICAgIHN1cGVyKChNZXNzYWdlKSBtZXNzYWdlLCBzZXNzaW9u\nKTsKCiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBCeXRlc01lc3Nh\nZ2VJbXBsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBKTVNFeGNlcHRpb24o\nIkNvZGluZyBidWcgLSBzaG91bGQgdXNlIHRoaXMgY29uc3RydWN0b3IgT05M\nWSBmb3Igbm9uICIgKwogICAgICAgICAgICAgICAgIkJ5dGVzTWVzc2FnZUlt\ncGwgbWVzc2FnZXMiKTsKICAgICAgICB9CgogICAgICAgIC8vIGNvcHkgdGhl\nIGJ5dGVzIC4uLgogICAgICAgIGZpbmFsIGJ5dGVbXSBkYXRhOwogICAgICAg\nIHsKICAgICAgICAgICAgZmluYWwgbG9uZyBsZW5ndGggPSBtZXNzYWdlLmdl\ndEJvZHlMZW5ndGgoKTsKICAgICAgICAgICAgaWYgKGxlbmd0aCA8IDAgfHwg\nbGVuZ3RoID49IEludGVnZXIuTUFYX1ZBTFVFKSB0aHJvdyBuZXcgSk1TRXhj\nZXB0aW9uKCJVbnJlYXNvbmFibHkgIiArCiAgICAgICAgICAgICAgICAibGFy\nZ2UgdmFsdWUgZm9yIGJvZHkgTGVuZ3RoIDogIiArIGxlbmd0aCk7CgogICAg\nICAgICAgICBkYXRhID0gbmV3IGJ5dGVbKGludCkgbGVuZ3RoXTsKICAgICAg\nICAgICAgaW50IHJlYWQgPSAwOwogICAgICAgICAgICB3aGlsZSAocmVhZCA8\nIGxlbmd0aCl7CiAgICAgICAgICAgICAgICBpbnQgc3ogPSBtZXNzYWdlLnJl\nYWRCeXRlcyhkYXRhLCByZWFkKTsKICAgICAgICAgICAgICAgIHJlYWQgKz0g\nc3o7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIHRoaXMud3JpdGVPbmx5TWVzc2FnZSA9IG5ldyBXcml0ZU9u\nbHlNZXNzYWdlKGRhdGEpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgSk1TRXhjZXB0aW9uIGV4ID0gbmV3IEpNU0V4\nY2VwdGlvbigiVW5hYmxlIHRvIGNsb25lL2NvcHkgaW5wdXQgbWVzc2FnZSAi\nICsgbWVzc2FnZSArICIgLi4gIiArIGUpOwogICAgICAgICAgICBleC5zZXRM\naW5rZWRFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIHRocm93IGV4OwogICAg\nICAgIH0KICAgICAgICB0aGlzLnJlYWRPbmx5TWVzc2FnZSAgPSBudWxsOwog\nICAgICAgIHRoaXMucmVhZE1vZGUgPSB0cnVlOwogICAgfQoKICAgIHB1Ymxp\nYyBCeXRlc01lc3NhZ2VJbXBsKFNlc3Npb25JbXBsIHNlc3Npb24sIFB1YlN1\nYlByb3RvY29sLk1lc3NhZ2UgbWVzc2FnZSwgTWFwPFN0cmluZywgT2JqZWN0\nPiBwcm9wZXJ0aWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Ry\naW5nIHNvdXJjZVRvcGljTmFtZSwgU3RyaW5nIHN1YnNjcmliZXJJZCwgUnVu\nbmFibGUgYWNrUnVubmFibGUpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAg\nICAgIHN1cGVyKHNlc3Npb24sIG1lc3NhZ2UsIHByb3BlcnRpZXMsIHNvdXJj\nZVRvcGljTmFtZSwgc3Vic2NyaWJlcklkLCBhY2tSdW5uYWJsZSk7CgogICAg\nICAgIHRoaXMucmVhZE9ubHlNZXNzYWdlID0gbmV3IFJlYWRPbmx5TWVzc2Fn\nZShtZXNzYWdlLmdldEJvZHkoKS50b0J5dGVBcnJheSgpKTsKICAgICAgICB0\naGlzLndyaXRlT25seU1lc3NhZ2UgPSBudWxsOwogICAgICAgIHRoaXMucmVh\nZE1vZGUgPSB0cnVlOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIE1lc3NhZ2VVdGlsLlN1cHBvcnRlZE1lc3NhZ2VUeXBlcyAgZ2V0Sm1z\nTWVzc2FnZVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIE1lc3NhZ2VVdGlsLlN1\ncHBvcnRlZE1lc3NhZ2VUeXBlcy5CWVRFUzsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgYm9vbGVhbiBpc0JvZHlFbXB0eSgpewogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBQdWJTdWJQcm90\nb2NvbC5NZXNzYWdlIGdlbmVyYXRlSGVkd2lnTWVzc2FnZSgpIHRocm93cyBK\nTVNFeGNlcHRpb24gewogICAgICAgIFB1YlN1YlByb3RvY29sLk1lc3NhZ2Uu\nQnVpbGRlciBidWlsZGVyID0gUHViU3ViUHJvdG9jb2wuTWVzc2FnZS5uZXdC\ndWlsZGVyKCk7CiAgICAgICAgc3VwZXIucG9wdWxhdGVCdWlsZGVyV2l0aEhl\nYWRlcnMoYnVpbGRlcik7CgogICAgICAgIC8vIE5vdyBzZXQgYm9keSBhbmQg\ndHlwZS4KICAgICAgICB0cnkgewogICAgICAgICAgICBidWlsZGVyLnNldEJv\nZHkoQnl0ZVN0cmluZy5jb3B5RnJvbShnZXRQYXlsb2FkRGF0YSgpKSk7CiAg\nICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICBK\nTVNFeGNlcHRpb24gZXggPSBuZXcgSk1TRXhjZXB0aW9uKCJVbmFibGUgdG8g\ncmVhZCBtZXNzYWdlIGRhdGEgLi4gIiArIGUpOwogICAgICAgICAgICBleC5z\nZXRMaW5rZWRFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIHRocm93IGV4Owog\nICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGQoKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBsb25nIGdldEJvZHlMZW5n\ndGgoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIXJlYWRN\nb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFJlYWRhYmxlRXhjZXB0aW9uKCJN\nZXNzYWdlIG5vdCByZWFkYWJsZSIpOwogICAgICAgIHJldHVybiByZWFkT25s\neU1lc3NhZ2UuZ2V0Qm9keUxlbmd0aCgpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIGJvb2xlYW4gcmVhZEJvb2xlYW4oKSB0aHJvd3MgSk1T\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIXJlYWRNb2RlKSB0aHJvdyBuZXcg\nTWVzc2FnZU5vdFJlYWRhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCByZWFk\nYWJsZSIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiByZWFk\nT25seU1lc3NhZ2UucmVhZEJvb2xlYW4oKTsKICAgICAgICB9IGNhdGNoIChJ\nT0V4Y2VwdGlvbiBlb2YpewogICAgICAgICAgICBNZXNzYWdlRU9GRXhjZXB0\naW9uIGVvZkV4ID0gbmV3IE1lc3NhZ2VFT0ZFeGNlcHRpb24oImVvZiA/Iik7\nCiAgICAgICAgICAgIGVvZkV4LnNldExpbmtlZEV4Y2VwdGlvbihlb2YpOwog\nICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgYnl0ZSByZWFkQnl0ZSgpIHRocm93cyBK\nTVNFeGNlcHRpb24gewogICAgICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5l\ndyBNZXNzYWdlTm90UmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJl\nYWRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJl\nYWRPbmx5TWVzc2FnZS5yZWFkQnl0ZSgpOwogICAgICAgIH0gY2F0Y2ggKElP\nRXhjZXB0aW9uIGVvZil7CiAgICAgICAgICAgIE1lc3NhZ2VFT0ZFeGNlcHRp\nb24gZW9mRXggPSBuZXcgTWVzc2FnZUVPRkV4Y2VwdGlvbigiZW9mID8iKTsK\nICAgICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhjZXB0aW9uKGVvZik7CiAg\nICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBpbnQgcmVhZFVuc2lnbmVkQnl0ZSgpIHRo\ncm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmICghcmVhZE1vZGUpIHRo\ncm93IG5ldyBNZXNzYWdlTm90UmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ug\nbm90IHJlYWRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0\ndXJuIHJlYWRPbmx5TWVzc2FnZS5yZWFkVW5zaWduZWRCeXRlKCk7CiAgICAg\nICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZW9mKXsKICAgICAgICAgICAgTWVz\nc2FnZUVPRkV4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBNZXNzYWdlRU9GRXhjZXB0\naW9uKCJlb2YgPyIpOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNl\ncHRpb24oZW9mKTsKICAgICAgICAgICAgdGhyb3cgZW9mRXg7CiAgICAgICAg\nfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHNob3J0IHJlYWRT\naG9ydCgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmICghcmVh\nZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90UmVhZGFibGVFeGNlcHRpb24o\nIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2FnZS5yZWFkU2hvcnQoKTsKICAg\nICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlb2YpewogICAgICAgICAgICBN\nZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0gbmV3IE1lc3NhZ2VFT0ZFeGNl\ncHRpb24oImVvZiA/Iik7CiAgICAgICAgICAgIGVvZkV4LnNldExpbmtlZEV4\nY2VwdGlvbihlb2YpOwogICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAg\nICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IHJlYWRV\nbnNpZ25lZFNob3J0KCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKCFyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RSZWFkYWJsZUV4\nY2VwdGlvbigiTWVzc2FnZSBub3QgcmVhZGFibGUiKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICByZXR1cm4gcmVhZE9ubHlNZXNzYWdlLnJlYWRVbnNp\nZ25lZFNob3J0KCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZW9m\nKXsKICAgICAgICAgICAgTWVzc2FnZUVPRkV4Y2VwdGlvbiBlb2ZFeCA9IG5l\ndyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJlb2YgPyIpOwogICAgICAgICAgICBl\nb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oZW9mKTsKICAgICAgICAgICAgdGhy\nb3cgZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIGNoYXIgcmVhZENoYXIoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIXJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFJl\nYWRhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCByZWFkYWJsZSIpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiByZWFkT25seU1lc3NhZ2Uu\ncmVhZENoYXIoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlb2Yp\newogICAgICAgICAgICBNZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0gbmV3\nIE1lc3NhZ2VFT0ZFeGNlcHRpb24oImVvZiA/Iik7CiAgICAgICAgICAgIGVv\nZkV4LnNldExpbmtlZEV4Y2VwdGlvbihlb2YpOwogICAgICAgICAgICB0aHJv\ndyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgaW50IHJlYWRJbnQoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoIXJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFJlYWRh\nYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCByZWFkYWJsZSIpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHJldHVybiByZWFkT25seU1lc3NhZ2UucmVh\nZEludCgpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGVvZil7CiAg\nICAgICAgICAgIE1lc3NhZ2VFT0ZFeGNlcHRpb24gZW9mRXggPSBuZXcgTWVz\nc2FnZUVPRkV4Y2VwdGlvbigiZW9mID8iKTsKICAgICAgICAgICAgZW9mRXgu\nc2V0TGlua2VkRXhjZXB0aW9uKGVvZik7CiAgICAgICAgICAgIHRocm93IGVv\nZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBsb25nIHJlYWRMb25nKCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKCFyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RSZWFkYWJs\nZUV4Y2VwdGlvbigiTWVzc2FnZSBub3QgcmVhZGFibGUiKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICByZXR1cm4gcmVhZE9ubHlNZXNzYWdlLnJlYWRM\nb25nKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZW9mKXsKICAg\nICAgICAgICAgTWVzc2FnZUVPRkV4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBNZXNz\nYWdlRU9GRXhjZXB0aW9uKCJlb2YgPyIpOwogICAgICAgICAgICBlb2ZFeC5z\nZXRMaW5rZWRFeGNlcHRpb24oZW9mKTsKICAgICAgICAgICAgdGhyb3cgZW9m\nRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIGZsb2F0IHJlYWRGbG9hdCgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAg\nICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90UmVhZGFi\nbGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2FnZS5yZWFk\nRmxvYXQoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlb2Ypewog\nICAgICAgICAgICBNZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0gbmV3IE1l\nc3NhZ2VFT0ZFeGNlcHRpb24oImVvZiA/Iik7CiAgICAgICAgICAgIGVvZkV4\nLnNldExpbmtlZEV4Y2VwdGlvbihlb2YpOwogICAgICAgICAgICB0aHJvdyBl\nb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgZG91YmxlIHJlYWREb3VibGUoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIXJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFJl\nYWRhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCByZWFkYWJsZSIpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiByZWFkT25seU1lc3NhZ2Uu\ncmVhZERvdWJsZSgpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGVv\nZil7CiAgICAgICAgICAgIE1lc3NhZ2VFT0ZFeGNlcHRpb24gZW9mRXggPSBu\nZXcgTWVzc2FnZUVPRkV4Y2VwdGlvbigiZW9mID8iKTsKICAgICAgICAgICAg\nZW9mRXguc2V0TGlua2VkRXhjZXB0aW9uKGVvZik7CiAgICAgICAgICAgIHRo\ncm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBTdHJpbmcgcmVhZFVURigpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90\nUmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2Fn\nZS5yZWFkVVRGKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZW9m\nKXsKICAgICAgICAgICAgTWVzc2FnZUVPRkV4Y2VwdGlvbiBlb2ZFeCA9IG5l\ndyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJlb2YgPyIpOwogICAgICAgICAgICBl\nb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oZW9mKTsKICAgICAgICAgICAgdGhy\nb3cgZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIGludCByZWFkQnl0ZXMoYnl0ZVtdIGRhdGEpIHRocm93cyBKTVNF\neGNlcHRpb24gewogICAgICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBN\nZXNzYWdlTm90UmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRh\nYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRP\nbmx5TWVzc2FnZS5yZWFkQnl0ZXMoZGF0YSk7CiAgICAgICAgfSBjYXRjaCAo\nSU9FeGNlcHRpb24gZW9mKXsKICAgICAgICAgICAgTWVzc2FnZUVPRkV4Y2Vw\ndGlvbiBlb2ZFeCA9IG5ldyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJlb2YgPyIp\nOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oZW9mKTsK\nICAgICAgICAgICAgdGhyb3cgZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIGludCByZWFkQnl0ZXMoYnl0ZVtdIGRh\ndGEsIGludCBsZW5ndGgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAg\nIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90UmVhZGFibGVF\neGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2FnZS5yZWFkQnl0\nZXMoZGF0YSwgbGVuZ3RoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBlb2YpewogICAgICAgICAgICBNZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4\nID0gbmV3IE1lc3NhZ2VFT0ZFeGNlcHRpb24oImVvZiA/Iik7CiAgICAgICAg\nICAgIGVvZkV4LnNldExpbmtlZEV4Y2VwdGlvbihlb2YpOwogICAgICAgICAg\nICB0aHJvdyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgdm9pZCB3cml0ZUJvb2xlYW4oYm9vbGVhbiB2YWwpIHRo\ncm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmIChyZWFkTW9kZSkgdGhy\nb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ug\nbm90IHdyaXRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgd3Jp\ndGVPbmx5TWVzc2FnZS53cml0ZUJvb2xlYW4odmFsKTsKICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBpb0V4KXsKICAgICAgICAgICAgTWVzc2FnZUVP\nRkV4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJV\nbmV4cGVjdGVkIGlvZXggOiAiICsgaW9FeCk7CiAgICAgICAgICAgIGVvZkV4\nLnNldExpbmtlZEV4Y2VwdGlvbihpb0V4KTsKICAgICAgICAgICAgdGhyb3cg\nZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIHZvaWQgd3JpdGVCeXRlKGJ5dGUgdmFsKSB0aHJvd3MgSk1TRXhjZXB0\naW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdl\nTm90V3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlT25seU1lc3NhZ2Uu\nd3JpdGVCeXRlKHZhbCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9FeCl7CiAgICAgICAgICAgIE1lc3NhZ2VFT0ZFeGNlcHRpb24gZW9mRXgg\nPSBuZXcgTWVzc2FnZUVPRkV4Y2VwdGlvbigiVW5leHBlY3RlZCBpb2V4IDog\nIiArIGlvRXgpOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRp\nb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0K\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHdyaXRlU2hv\ncnQoc2hvcnQgdmFsKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAocmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90V3JpdGVhYmxlRXhj\nZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHdyaXRlT25seU1lc3NhZ2Uud3JpdGVTaG9ydCh2YWwp\nOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvRXgpewogICAgICAg\nICAgICBNZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0gbmV3IE1lc3NhZ2VF\nT0ZFeGNlcHRpb24oIlVuZXhwZWN0ZWQgaW9leCA6ICIgKyBpb0V4KTsKICAg\nICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhjZXB0aW9uKGlvRXgpOwogICAg\nICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgdm9pZCB3cml0ZUNoYXIoY2hhciB2YWwpIHRo\ncm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmIChyZWFkTW9kZSkgdGhy\nb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ug\nbm90IHdyaXRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgd3Jp\ndGVPbmx5TWVzc2FnZS53cml0ZUNoYXIodmFsKTsKICAgICAgICB9IGNhdGNo\nIChJT0V4Y2VwdGlvbiBpb0V4KXsKICAgICAgICAgICAgTWVzc2FnZUVPRkV4\nY2VwdGlvbiBlb2ZFeCA9IG5ldyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJVbmV4\ncGVjdGVkIGlvZXggOiAiICsgaW9FeCk7CiAgICAgICAgICAgIGVvZkV4LnNl\ndExpbmtlZEV4Y2VwdGlvbihpb0V4KTsKICAgICAgICAgICAgdGhyb3cgZW9m\nRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIHZvaWQgd3JpdGVJbnQoaW50IHZhbCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdy\naXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRl\nSW50KHZhbCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7\nCiAgICAgICAgICAgIE1lc3NhZ2VFT0ZFeGNlcHRpb24gZW9mRXggPSBuZXcg\nTWVzc2FnZUVPRkV4Y2VwdGlvbigiVW5leHBlY3RlZCBpb2V4IDogIiArIGlv\nRXgpOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9F\neCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHdyaXRlTG9uZyhsb25n\nIHZhbCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRN\nb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigi\nTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRlTG9uZyh2YWwpOwogICAgICAg\nIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvRXgpewogICAgICAgICAgICBNZXNz\nYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0gbmV3IE1lc3NhZ2VFT0ZFeGNlcHRp\nb24oIlVuZXhwZWN0ZWQgaW9leCA6ICIgKyBpb0V4KTsKICAgICAgICAgICAg\nZW9mRXguc2V0TGlua2VkRXhjZXB0aW9uKGlvRXgpOwogICAgICAgICAgICB0\naHJvdyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgdm9pZCB3cml0ZUZsb2F0KGZsb2F0IHZhbCkgdGhyb3dzIEpN\nU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcg\nTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3Jp\ndGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB3cml0ZU9ubHlN\nZXNzYWdlLndyaXRlRmxvYXQodmFsKTsKICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBpb0V4KXsKICAgICAgICAgICAgTWVzc2FnZUVPRkV4Y2VwdGlv\nbiBlb2ZFeCA9IG5ldyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJVbmV4cGVjdGVk\nIGlvZXggOiAiICsgaW9FeCk7CiAgICAgICAgICAgIGVvZkV4LnNldExpbmtl\nZEV4Y2VwdGlvbihpb0V4KTsKICAgICAgICAgICAgdGhyb3cgZW9mRXg7CiAg\nICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQg\nd3JpdGVEb3VibGUoZG91YmxlIHZhbCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdy\naXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRl\nRG91YmxlKHZhbCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9F\neCl7CiAgICAgICAgICAgIE1lc3NhZ2VFT0ZFeGNlcHRpb24gZW9mRXggPSBu\nZXcgTWVzc2FnZUVPRkV4Y2VwdGlvbigiVW5leHBlY3RlZCBpb2V4IDogIiAr\nIGlvRXgpOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24o\naW9FeCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHdyaXRlVVRGKFN0\ncmluZyB2YWwpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmIChy\nZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRp\nb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgd3JpdGVPbmx5TWVzc2FnZS53cml0ZVVURih2YWwpOwogICAg\nICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvRXgpewogICAgICAgICAgICBN\nZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0gbmV3IE1lc3NhZ2VFT0ZFeGNl\ncHRpb24oIlVuZXhwZWN0ZWQgaW9leCA6ICIgKyBpb0V4KTsKICAgICAgICAg\nICAgZW9mRXguc2V0TGlua2VkRXhjZXB0aW9uKGlvRXgpOwogICAgICAgICAg\nICB0aHJvdyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgdm9pZCB3cml0ZUJ5dGVzKGJ5dGVbXSBkYXRhKSB0aHJv\nd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93\nIG5ldyBNZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5v\ndCB3cml0YWJsZSIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRl\nT25seU1lc3NhZ2Uud3JpdGVCeXRlcyhkYXRhKTsKICAgICAgICB9IGNhdGNo\nIChJT0V4Y2VwdGlvbiBpb0V4KXsKICAgICAgICAgICAgTWVzc2FnZUVPRkV4\nY2VwdGlvbiBlb2ZFeCA9IG5ldyBNZXNzYWdlRU9GRXhjZXB0aW9uKCJVbmV4\ncGVjdGVkIGlvZXggOiAiICsgaW9FeCk7CiAgICAgICAgICAgIGVvZkV4LnNl\ndExpbmtlZEV4Y2VwdGlvbihpb0V4KTsKICAgICAgICAgICAgdGhyb3cgZW9m\nRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIHZvaWQgd3JpdGVCeXRlcyhieXRlW10gZGF0YSwgaW50IG9mZnNldCwgaW50\nIGxlbmd0aCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJl\nYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlv\nbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRlQnl0ZXMoZGF0YSwgb2Zm\nc2V0LCBsZW5ndGgpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlv\nRXgpewogICAgICAgICAgICBNZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4ID0g\nbmV3IE1lc3NhZ2VFT0ZFeGNlcHRpb24oIlVuZXhwZWN0ZWQgaW9leCA6ICIg\nKyBpb0V4KTsKICAgICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhjZXB0aW9u\nKGlvRXgpOwogICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAgICB9CiAg\nICB9CgogICAgLy8gVGhpcyBtZXRob2QgaXMgT05MWSBzdXBwb3NlZCB0byBi\nZSB1c2VkIGZvciBvYmplY3QgZm9ybSBvZiBwcmltaXRpdmUgdHlwZXMgIQog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCB3cml0ZU9iamVjdChPYmpl\nY3Qgb2JqKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAocmVh\nZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0aW9u\nKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIC8vIHVucm9sbGluZyBpdAogICAgICAgICAgICBpZiAob2JqIGlu\nc3RhbmNlb2YgQm9vbGVhbikgewogICAgICAgICAgICAgICAgd3JpdGVPbmx5\nTWVzc2FnZS53cml0ZUJvb2xlYW4oKEJvb2xlYW4pIG9iaik7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgQnl0\nZSkgewogICAgICAgICAgICAgICAgd3JpdGVPbmx5TWVzc2FnZS53cml0ZUJ5\ndGUoKEJ5dGUpIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxz\nZSBpZiAob2JqIGluc3RhbmNlb2YgU2hvcnQpIHsKICAgICAgICAgICAgICAg\nIHdyaXRlT25seU1lc3NhZ2Uud3JpdGVTaG9ydCgoU2hvcnQpIG9iaik7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob2JqIGluc3RhbmNl\nb2YgQ2hhcmFjdGVyKSB7CiAgICAgICAgICAgICAgICB3cml0ZU9ubHlNZXNz\nYWdlLndyaXRlQ2hhcigoQ2hhcmFjdGVyKSBvYmopOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIEludGVnZXIp\nIHsKICAgICAgICAgICAgICAgIHdyaXRlT25seU1lc3NhZ2Uud3JpdGVJbnQo\nKEludGVnZXIpIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxz\nZSBpZiAob2JqIGluc3RhbmNlb2YgTG9uZykgewogICAgICAgICAgICAgICAg\nd3JpdGVPbmx5TWVzc2FnZS53cml0ZUxvbmcoKExvbmcpIG9iaik7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob2JqIGluc3RhbmNlb2Yg\nRmxvYXQpIHsKICAgICAgICAgICAgICAgIHdyaXRlT25seU1lc3NhZ2Uud3Jp\ndGVGbG9hdCgoRmxvYXQpIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgRG91YmxlKSB7CiAgICAgICAg\nICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRlRG91YmxlKChEb3VibGUp\nIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob2Jq\nIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAgICAgICB3cml0ZU9u\nbHlNZXNzYWdlLndyaXRlVVRGKChTdHJpbmcpIG9iaik7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgZWxzZSBpZiAob2JqIGluc3RhbmNlb2YgYnl0ZVtd\nKSB7CiAgICAgICAgICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRlQnl0\nZXMoKGJ5dGVbXSkgb2JqKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBl\nbHNlewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpNU0V4Y2VwdGlvbigi\nVW5zdXBwb3J0ZWQgdHlwZSBmb3Igb2JqIDogIiArIG9iai5nZXRDbGFzcygp\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9u\nIGlvRXgpewogICAgICAgICAgICBNZXNzYWdlRU9GRXhjZXB0aW9uIGVvZkV4\nID0gbmV3IE1lc3NhZ2VFT0ZFeGNlcHRpb24oIlVuZXhwZWN0ZWQgaW9leCA6\nICIgKyBpb0V4KTsKICAgICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhjZXB0\naW9uKGlvRXgpOwogICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAgICB9\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCByZXNldCgp\nIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmICh0aGlzLnJlYWRN\nb2RlKSByZXR1cm4gOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRoaXMu\ncmVhZE9ubHlNZXNzYWdlID0gbmV3IFJlYWRPbmx5TWVzc2FnZSh3cml0ZU9u\nbHlNZXNzYWdlLmdldFBheWxvYWRBc0J5dGVzKCkpOwogICAgICAgIH0gY2F0\nY2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgSk1TRXhjZXB0aW9u\nIGV4ID0gbmV3IEpNU0V4Y2VwdGlvbigiVW5hYmxlIHRvIGNvbnZlcnQgd3Jp\ndGUtb25seSBtZXNzYWdlIHRvIHJlYWQtb25seSBtZXNzYWdlIC4uICIgKyBl\nKTsKICAgICAgICAgICAgZXguc2V0TGlua2VkRXhjZXB0aW9uKGUpOwogICAg\nICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CiAgICAgICAgdGhpcy5yZWFk\nTW9kZSA9IHRydWU7CiAgICAgICAgdGhpcy53cml0ZU9ubHlNZXNzYWdlID0g\nbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGNs\nZWFyQm9keSgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHN1cGVy\nLmNsZWFyQm9keSgpOwogICAgICAgIHRoaXMud3JpdGVPbmx5TWVzc2FnZSA9\nIG5ldyBXcml0ZU9ubHlNZXNzYWdlKCk7CiAgICAgICAgdGhpcy5yZWFkT25s\neU1lc3NhZ2UgPSBudWxsOwogICAgICAgIHRoaXMucmVhZE1vZGUgPSBmYWxz\nZTsKICAgIH0KCiAgICBwcml2YXRlIGJ5dGVbXSBnZXRQYXlsb2FkRGF0YSgp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSBy\nZXR1cm4gcmVhZE9ubHlNZXNzYWdlLmdldERhdGFDb3B5KCk7CiAgICAgICAg\ncmV0dXJuIHdyaXRlT25seU1lc3NhZ2UuZ2V0UGF5bG9hZEFzQnl0ZXMoKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIEJ5dGVzTWVzc2FnZUltcGwgY3Jl\nYXRlQ2xvbmUoU2Vzc2lvbkltcGwgc2Vzc2lvbiwgU3RyaW5nIHNvdXJjZVRv\ncGljTmFtZSwgU3RyaW5nIHN1YnNjcmliZXJJZCkKICAgICAgICB0aHJvd3Mg\nSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbmV3IEJ5dGVzTWVzc2Fn\nZUltcGwoc2Vzc2lvbiwgdGhpcywgc291cmNlVG9waWNOYW1lLCBzdWJzY3Jp\nYmVySWQpOwogICAgfQoKICAgIC8vIFVzaW5nIGphdmEgb2JqZWN0J3MgaW5z\ndGVhZCBvZiBwcmltaXRpdmVzIHRvIGF2b2lkIGhhdmluZyB0byBzdG9yZSBz\nY2hlbWEgc2VwYXJhdGVseS4KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFJl\nYWRPbmx5TWVzc2FnZSB7CgogICAgICAgIHByaXZhdGUgZmluYWwgRGF0YUlu\ncHV0U3RyZWFtIGRpczsKICAgICAgICBwcml2YXRlIGZpbmFsIGJ5dGVbXSBk\nYXRhOwoKICAgICAgICBwdWJsaWMgUmVhZE9ubHlNZXNzYWdlKGJ5dGVbXSBk\nYXRhKSB7CiAgICAgICAgICAgIHRoaXMuZGlzID0gbmV3IERhdGFJbnB1dFN0\ncmVhbShuZXcgQnl0ZUFycmF5SW5wdXRTdHJlYW0oZGF0YSkpOwogICAgICAg\nICAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIGJ5dGVbXSBnZXREYXRhQ29weSgpewogICAgICAgICAgICBieXRlW10g\ncmV0dmFsID0gbmV3IGJ5dGVbZGF0YS5sZW5ndGhdOwogICAgICAgICAgICBT\neXN0ZW0uYXJyYXljb3B5KGRhdGEsIDAsIHJldHZhbCwgMCwgcmV0dmFsLmxl\nbmd0aCk7CiAgICAgICAgICAgIHJldHVybiByZXR2YWw7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgaW50IGdldEJvZHlMZW5ndGgoKSB7CiAgICAgICAg\nICAgIHJldHVybiBkYXRhLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBib29sZWFuIHJlYWRCb29sZWFuKCkgdGhyb3dzIElPRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgcmV0dXJuIGRpcy5yZWFkQm9vbGVhbigpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIGJ5dGUgcmVhZEJ5dGUoKSB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gZGlzLnJlYWRCeXRl\nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IHJlYWRVbnNpZ25l\nZEJ5dGUoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICByZXR1\ncm4gZGlzLnJlYWRVbnNpZ25lZEJ5dGUoKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBzaG9ydCByZWFkU2hvcnQoKSB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgICAgICByZXR1cm4gZGlzLnJlYWRTaG9ydCgpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGludCByZWFkVW5zaWduZWRTaG9ydCgpIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBkaXMucmVh\nZFVuc2lnbmVkU2hvcnQoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBj\naGFyIHJlYWRDaGFyKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgcmV0dXJuIGRpcy5yZWFkQ2hhcigpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGludCByZWFkSW50KCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgcmV0dXJuIGRpcy5yZWFkSW50KCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgbG9uZyByZWFkTG9uZygpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIHJldHVybiBkaXMucmVhZExvbmcoKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBmbG9hdCByZWFkRmxvYXQoKSB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gZGlzLnJlYWRGbG9h\ndCgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGRvdWJsZSByZWFkRG91\nYmxlKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJu\nIGRpcy5yZWFkRG91YmxlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nU3RyaW5nIHJlYWRVVEYoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAg\nICAgICByZXR1cm4gZGlzLnJlYWRVVEYoKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBpbnQgcmVhZEJ5dGVzKGJ5dGVbXSBkYXRhKSB0aHJvd3MgSU9F\neGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gZGlzLnJlYWQoZGF0YSk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IHJlYWRCeXRlcyhieXRl\nW10gZGF0YSwgaW50IGxlbmd0aCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgaWYgKGxlbmd0aCA8IDAgfHwgbGVuZ3RoID4gZGF0YS5sZW5n\ndGgpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEluZGV4T3V0T2ZCb3VuZHNF\neGNlcHRpb24oIkludmFsaWQgbGVuZ3RoIHNwZWNpZmllZCA6ICIgKyBsZW5n\ndGggKyAiLCBkYXRhIDogIiArIGRhdGEubGVuZ3RoKTsKICAgICAgICAgICAg\ncmV0dXJuIGRpcy5yZWFkKGRhdGEsIDAsIGxlbmd0aCk7CiAgICAgICAgfQog\nICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFdyaXRlT25seU1lc3Nh\nZ2UgewoKICAgICAgICBwcml2YXRlIGZpbmFsIEJ5dGVBcnJheU91dHB1dFN0\ncmVhbSBiYW9zOwogICAgICAgIHByaXZhdGUgZmluYWwgRGF0YU91dHB1dFN0\ncmVhbSBkb3M7CgogICAgICAgIHB1YmxpYyBXcml0ZU9ubHlNZXNzYWdlKCl7\nCiAgICAgICAgICAgIGJhb3MgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFt\nKCk7CiAgICAgICAgICAgIGRvcyA9IG5ldyBEYXRhT3V0cHV0U3RyZWFtKGJh\nb3MpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFdyaXRlT25seU1lc3Nh\nZ2UoYnl0ZVtdIGRhdGEpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIGJhb3MgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgICAg\nICAgICAgIGRvcyA9IG5ldyBEYXRhT3V0cHV0U3RyZWFtKGJhb3MpOwogICAg\nICAgICAgICBkb3Mud3JpdGUoZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgYnl0ZVtdIGdldFBheWxvYWRBc0J5dGVzKCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgZG9zLmZsdXNoKCk7CiAgICAgICAgICAg\nIHJldHVybiBiYW9zLnRvQnl0ZUFycmF5KCk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCB3cml0ZUJvb2xlYW4oYm9vbGVhbiB2YWwpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGRvcy53cml0ZUJvb2xlYW4o\ndmFsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlQnl0\nZShieXRlIHZhbCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nZG9zLndyaXRlQnl0ZSh2YWwpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIHZvaWQgd3JpdGVTaG9ydChzaG9ydCB2YWwpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIGRvcy53cml0ZVNob3J0KHZhbCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZUNoYXIoY2hhciB2YWwpIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGRvcy53cml0ZUNoYXIo\ndmFsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlSW50\nKGludCB2YWwpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGRv\ncy53cml0ZUludCh2YWwpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgd3JpdGVMb25nKGxvbmcgdmFsKSB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgICAgICBkb3Mud3JpdGVMb25nKHZhbCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCB3cml0ZUZsb2F0KGZsb2F0IHZhbCkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgZG9zLndyaXRlRmxvYXQodmFs\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlRG91Ymxl\nKGRvdWJsZSB2YWwpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGRvcy53cml0ZURvdWJsZSh2YWwpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgd3JpdGVVVEYoU3RyaW5nIHZhbCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICAgICAgZG9zLndyaXRlVVRGKHZhbCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZUJ5dGVzKGJ5dGVbXSBkYXRh\nKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBkb3Mud3JpdGUo\nZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZUJ5\ndGVzKGJ5dGVbXSBkYXRhLCBpbnQgb2Zmc2V0LCBpbnQgbGVuZ3RoKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBkb3Mud3JpdGUoZGF0YSwg\nb2Zmc2V0LCBsZW5ndGgpOwogICAgICAgIH0KICAgIH0KfQ==\n","encoding":"base64"}

