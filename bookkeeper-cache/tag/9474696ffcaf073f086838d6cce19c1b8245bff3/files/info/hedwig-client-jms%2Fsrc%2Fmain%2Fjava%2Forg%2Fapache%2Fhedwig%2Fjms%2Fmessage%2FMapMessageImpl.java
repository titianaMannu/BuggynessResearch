{"sha":"af806fb4a5bbd39d078da93df892e424f9b036c2","node_id":"MDQ6QmxvYjE1NzU5NTY6YWY4MDZmYjRhNWJiZDM5ZDA3OGRhOTNkZjg5MmU0MjRmOWIwMzZjMg==","size":10662,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/af806fb4a5bbd39d078da93df892e424f9b036c2","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMubWVzc2FnZTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5qbXMuU2Vzc2lvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbDsKCmltcG9ydCBqYXZh\neC5qbXMuSk1TRXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1hcE1lc3Nh\nZ2U7CmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZTsKaW1wb3J0IGphdmF4Lmpt\ncy5NZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0aW9uOwppbXBvcnQgamF2YS5p\nby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsK\naW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRIYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCi8qKgog\nKiBUaGVyZSBpcyBhIHdlYWtlciBleHBlY3RhdGlvbiBvZiBvcmRlcmluZyBh\nbmQgc3Ryb25nIGV4cGVjdGF0aW9uIG9mICZsdDtrZXksIHZhbHVlJmd0OyBj\nb250YWluZXIgZm9yIGRhdGEuCiAqLwpwdWJsaWMgY2xhc3MgTWFwTWVzc2Fn\nZUltcGwgZXh0ZW5kcyBNZXNzYWdlSW1wbCBpbXBsZW1lbnRzIE1hcE1lc3Nh\nZ2UgewogICAgcHJpdmF0ZSBmaW5hbCBNYXA8U3RyaW5nLCBPYmplY3Q+IHBh\neWxvYWQgPSBuZXcgTGlua2VkSGFzaE1hcDxTdHJpbmcsIE9iamVjdD4oNCk7\nCiAgICBwcml2YXRlIGJvb2xlYW4gcmVhZE1vZGU7CgogICAgcHVibGljIE1h\ncE1lc3NhZ2VJbXBsKFNlc3Npb25JbXBsIHNlc3Npb24pIHRocm93cyBKTVNF\neGNlcHRpb24gewogICAgICAgIHN1cGVyKHNlc3Npb24pOwogICAgICAgIGNs\nZWFyQm9keSgpOwogICAgfQoKICAgIHB1YmxpYyBNYXBNZXNzYWdlSW1wbChT\nZXNzaW9uSW1wbCBzZXNzaW9uLCBNYXBNZXNzYWdlSW1wbCBtZXNzYWdlLCBT\ndHJpbmcgc291cmNlVG9waWNOYW1lLAogICAgICAgICAgICAgICAgICAgICAg\nICAgIFN0cmluZyBzdWJzY3JpYmVySWQpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIHN1cGVyKHNlc3Npb24sIChNZXNzYWdlSW1wbCkgbWVzc2Fn\nZSwgc291cmNlVG9waWNOYW1lLCBzdWJzY3JpYmVySWQpOwogICAgICAgIHRo\naXMucGF5bG9hZC5wdXRBbGwobWVzc2FnZS5wYXlsb2FkKTsKICAgICAgICB0\naGlzLnJlYWRNb2RlID0gbWVzc2FnZS5yZWFkTW9kZTsKICAgIH0KCiAgICAv\nLyBUbyBjbG9uZSBhIG1lc3NhZ2UgZnJvbSBhIE1hcE1lc3NhZ2Ugd2hpY2gg\naXMgTk9UIE1hcE1lc3NhZ2VJbXBsCiAgICAvLyBDaGFuZ2luZyBvcmRlciBv\nZiBwYXJhbWV0ZXIgdG8gTk9UIGFjY2lkZW50YWxseSBjbGFzaCB3aXRoIHRo\nZSBjb25zdHJ1Y3RvciBhYm92ZS4KICAgIC8vIFRoaXMgaXMgbWlkbHkgY29u\nZnVzaW5nLCBidXQgaGVscHMgYSBsb3QgaW4gcHJldmVudGluZyBhY2NpZGVu\ndGFsIGJ1Z3MgIQogICAgcHVibGljIE1hcE1lc3NhZ2VJbXBsKE1hcE1lc3Nh\nZ2UgbWVzc2FnZSwgU2Vzc2lvbkltcGwgc2Vzc2lvbikgdGhyb3dzIEpNU0V4\nY2VwdGlvbiB7CiAgICAgICAgc3VwZXIoKE1lc3NhZ2UpIG1lc3NhZ2UsIHNl\nc3Npb24pOwoKICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIE1hcE1l\nc3NhZ2VJbXBsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBKTVNFeGNlcHRp\nb24oIkNvZGluZyBidWcgLSBzaG91bGQgdXNlIHRoaXMgY29uc3RydWN0b3Ig\nT05MWSBmb3Igbm9uIE1hcE1lc3NhZ2VJbXBsIG1lc3NhZ2VzIik7CiAgICAg\nICAgfQoKCiAgICAgICAgRW51bWVyYXRpb24ga2V5cyA9IG1lc3NhZ2UuZ2V0\nTWFwTmFtZXMoKTsKICAgICAgICB3aGlsZSAoa2V5cy5oYXNNb3JlRWxlbWVu\ndHMoKSl7CiAgICAgICAgICAgIE9iamVjdCBrZXkgPSBrZXlzLm5leHRFbGVt\nZW50KCk7CiAgICAgICAgICAgIGlmICghKGtleSBpbnN0YW5jZW9mIFN0cmlu\nZykpCiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpNU0V4Y2VwdGlvbigiVW5z\ndXBwb3J0ZWQgdHlwZSAoZXhwZWN0ZWQgU3RyaW5nKSBmb3Iga2V5IDogIiAr\nIGtleSk7CgogICAgICAgICAgICBTdHJpbmcgc2tleSA9IChTdHJpbmcpIGtl\neTsKICAgICAgICAgICAgdGhpcy5wYXlsb2FkLnB1dChza2V5LCBtZXNzYWdl\nLmdldE9iamVjdChza2V5KSk7CiAgICAgICAgfQogICAgICAgIHRoaXMucmVh\nZE1vZGUgPSBmYWxzZTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygi\ndW5jaGVja2VkIikKICAgIHB1YmxpYyBNYXBNZXNzYWdlSW1wbChTZXNzaW9u\nSW1wbCBzZXNzaW9uLCBQdWJTdWJQcm90b2NvbC5NZXNzYWdlIG1lc3NhZ2Us\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0\nPiBwcm9wZXJ0aWVzLCBTdHJpbmcgc291cmNlVG9waWNOYW1lLCBTdHJpbmcg\nc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgICAgIFJ1bm5h\nYmxlIGFja1J1bm5hYmxlKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAg\nICBzdXBlcihzZXNzaW9uLCBtZXNzYWdlLCBwcm9wZXJ0aWVzLCBzb3VyY2VU\nb3BpY05hbWUsIHN1YnNjcmliZXJJZCwgYWNrUnVubmFibGUpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHRoaXMucGF5bG9hZC5wdXRBbGwoKE1hcDxT\ndHJpbmcsIE9iamVjdD4pIE1lc3NhZ2VVdGlsLmJ5dGVzVG9PYmplY3QobWVz\nc2FnZS5nZXRCb2R5KCkudG9CeXRlQXJyYXkoKSkpOwogICAgICAgIH0gY2F0\nY2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgSk1TRXhjZXB0aW9u\nIGV4ID0gbmV3IEpNU0V4Y2VwdGlvbigiVW5hYmxlIHRvIHJlYWQgbWVzc2Fn\nZSBkYXRhIC4uICIgKyBlKTsKICAgICAgICAgICAgZXguc2V0TGlua2VkRXhj\nZXB0aW9uKGUpOwogICAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CiAg\nICAgICAgdGhpcy5yZWFkTW9kZSA9IHRydWU7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgTWVzc2FnZVV0aWwuU3VwcG9ydGVkTWVzc2Fn\nZVR5cGVzICBnZXRKbXNNZXNzYWdlVHlwZSgpIHsKICAgICAgICByZXR1cm4g\nTWVzc2FnZVV0aWwuU3VwcG9ydGVkTWVzc2FnZVR5cGVzLk1BUDsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0JvZHlFbXB0eSgpewogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBQdWJTdWJQcm90b2NvbC5NZXNzYWdlIGdlbmVyYXRlSGVkd2lnTWVzc2Fn\nZSgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIFB1YlN1YlByb3Rv\nY29sLk1lc3NhZ2UuQnVpbGRlciBidWlsZGVyID0gUHViU3ViUHJvdG9jb2wu\nTWVzc2FnZS5uZXdCdWlsZGVyKCk7CiAgICAgICAgc3VwZXIucG9wdWxhdGVC\ndWlsZGVyV2l0aEhlYWRlcnMoYnVpbGRlcik7CgogICAgICAgIC8vIE5vdyBz\nZXQgYm9keSBhbmQgdHlwZS4KICAgICAgICB0cnkgewogICAgICAgICAgICBi\ndWlsZGVyLnNldEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJvbShNZXNzYWdlVXRp\nbC5vYmplY3RUb0J5dGVzKHRoaXMucGF5bG9hZCkpKTsKICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlv\nbiBleCA9IG5ldyBKTVNFeGNlcHRpb24oIlVuYWJsZSB0byByZWFkIG1lc3Nh\nZ2UgZGF0YSAuLiAiICsgZSk7CiAgICAgICAgICAgIGV4LnNldExpbmtlZEV4\nY2VwdGlvbihlKTsKICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoK\nICAgICAgICByZXR1cm4gYnVpbGRlci5idWlsZCgpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gZ2V0Qm9vbGVhbihTdHJpbmcg\nbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIE1l\nc3NhZ2VVdGlsLmFzQm9vbGVhbihwYXlsb2FkLmdldChuYW1lKSk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYnl0ZSBnZXRCeXRlKFN0cmlu\nZyBuYW1lKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4g\nTWVzc2FnZVV0aWwuYXNCeXRlKHBheWxvYWQuZ2V0KG5hbWUpKTsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBzaG9ydCBnZXRTaG9ydChTdHJp\nbmcgbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIE1lc3NhZ2VVdGlsLmFzU2hvcnQocGF5bG9hZC5nZXQobmFtZSkpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGNoYXIgZ2V0Q2hhcihTdHJp\nbmcgbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIE1lc3NhZ2VVdGlsLmFzQ2hhcihwYXlsb2FkLmdldChuYW1lKSk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGdldEludChTdHJpbmcg\nbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIE1l\nc3NhZ2VVdGlsLmFzSW50ZWdlcihwYXlsb2FkLmdldChuYW1lKSk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgbG9uZyBnZXRMb25nKFN0cmlu\nZyBuYW1lKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4g\nTWVzc2FnZVV0aWwuYXNMb25nKHBheWxvYWQuZ2V0KG5hbWUpKTsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBmbG9hdCBnZXRGbG9hdChTdHJp\nbmcgbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIE1lc3NhZ2VVdGlsLmFzRmxvYXQocGF5bG9hZC5nZXQobmFtZSkpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGRvdWJsZSBnZXREb3VibGUo\nU3RyaW5nIG5hbWUpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiBNZXNzYWdlVXRpbC5hc0RvdWJsZShwYXlsb2FkLmdldChuYW1lKSk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIGdldFN0\ncmluZyhTdHJpbmcgbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIE1lc3NhZ2VVdGlsLmFzU3RyaW5nKHBheWxvYWQuZ2V0KG5h\nbWUpKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBieXRlW10g\nZ2V0Qnl0ZXMoU3RyaW5nIG5hbWUpIHRocm93cyBKTVNFeGNlcHRpb24gewog\nICAgICAgIHJldHVybiBNZXNzYWdlVXRpbC5hc0J5dGVzKHBheWxvYWQuZ2V0\nKG5hbWUpKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBPYmpl\nY3QgZ2V0T2JqZWN0KFN0cmluZyBuYW1lKSB0aHJvd3MgSk1TRXhjZXB0aW9u\nIHsKICAgICAgICByZXR1cm4gcGF5bG9hZC5nZXQobmFtZSk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgRW51bWVyYXRpb24gZ2V0TWFwTmFt\nZXMoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gQ29s\nbGVjdGlvbnMuZW51bWVyYXRpb24ocGF5bG9hZC5rZXlTZXQoKSk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRCb29sZWFuKFN0\ncmluZyBuYW1lLCBib29sZWFuIHZhbHVlKSB0aHJvd3MgSk1TRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90\nV3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIpOwog\nICAgICAgIGlmICghTWVzc2FnZVV0aWwuaXNWYWxpZEtleShuYW1lKSkgdGhy\nb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSW52YWxpZCBrZXkg\nIiArIG5hbWUpOwogICAgICAgIHBheWxvYWQucHV0KG5hbWUsIHZhbHVlKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldEJ5dGUo\nU3RyaW5nIG5hbWUsIGJ5dGUgdmFsdWUpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIGlmIChyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RX\ncml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlIik7CiAg\nICAgICAgaWYgKCFNZXNzYWdlVXRpbC5pc1ZhbGlkS2V5KG5hbWUpKSB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZhbGlkIGtleSAi\nICsgbmFtZSk7CiAgICAgICAgcGF5bG9hZC5wdXQobmFtZSwgdmFsdWUpOwoK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldFNob3J0\nKFN0cmluZyBuYW1lLCBzaG9ydCB2YWx1ZSkgdGhyb3dzIEpNU0V4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5v\ndFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsK\nICAgICAgICBpZiAoIU1lc3NhZ2VVdGlsLmlzVmFsaWRLZXkobmFtZSkpIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIkludmFsaWQga2V5\nICIgKyBuYW1lKTsKICAgICAgICBwYXlsb2FkLnB1dChuYW1lLCB2YWx1ZSk7\nCgogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0Q2hh\ncihTdHJpbmcgbmFtZSwgY2hhciB2YWx1ZSkgdGhyb3dzIEpNU0V4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5v\ndFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsK\nICAgICAgICBpZiAoIU1lc3NhZ2VVdGlsLmlzVmFsaWRLZXkobmFtZSkpIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIkludmFsaWQga2V5\nICIgKyBuYW1lKTsKICAgICAgICBwYXlsb2FkLnB1dChuYW1lLCB2YWx1ZSk7\nCgogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0SW50\nKFN0cmluZyBuYW1lLCBpbnQgdmFsdWUpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIGlmIChyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RX\ncml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlIik7CiAg\nICAgICAgaWYgKCFNZXNzYWdlVXRpbC5pc1ZhbGlkS2V5KG5hbWUpKSB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZhbGlkIGtleSAi\nICsgbmFtZSk7CiAgICAgICAgcGF5bG9hZC5wdXQobmFtZSwgdmFsdWUpOwoK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldExvbmco\nU3RyaW5nIG5hbWUsIGxvbmcgdmFsdWUpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIGlmIChyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RX\ncml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlIik7CiAg\nICAgICAgaWYgKCFNZXNzYWdlVXRpbC5pc1ZhbGlkS2V5KG5hbWUpKSB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZhbGlkIGtleSAi\nICsgbmFtZSk7CiAgICAgICAgcGF5bG9hZC5wdXQobmFtZSwgdmFsdWUpOwoK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldEZsb2F0\nKFN0cmluZyBuYW1lLCBmbG9hdCB2YWx1ZSkgdGhyb3dzIEpNU0V4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5v\ndFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsK\nICAgICAgICBpZiAoIU1lc3NhZ2VVdGlsLmlzVmFsaWRLZXkobmFtZSkpIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIkludmFsaWQga2V5\nICIgKyBuYW1lKTsKICAgICAgICBwYXlsb2FkLnB1dChuYW1lLCB2YWx1ZSk7\nCgogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0RG91\nYmxlKFN0cmluZyBuYW1lLCBkb3VibGUgdmFsdWUpIHRocm93cyBKTVNFeGNl\ncHRpb24gewogICAgICAgIGlmIChyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3Nh\nZ2VOb3RXcml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxl\nIik7CiAgICAgICAgaWYgKCFNZXNzYWdlVXRpbC5pc1ZhbGlkS2V5KG5hbWUp\nKSB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZhbGlk\nIGtleSAiICsgbmFtZSk7CiAgICAgICAgcGF5bG9hZC5wdXQobmFtZSwgdmFs\ndWUpOwoKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNl\ndFN0cmluZyhTdHJpbmcgbmFtZSwgU3RyaW5nIHZhbHVlKSB0aHJvd3MgSk1T\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93IG5ldyBN\nZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0\nYWJsZSIpOwogICAgICAgIGlmICghTWVzc2FnZVV0aWwuaXNWYWxpZEtleShu\nYW1lKSkgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSW52\nYWxpZCBrZXkgIiArIG5hbWUpOwogICAgICAgIHBheWxvYWQucHV0KG5hbWUs\nIHZhbHVlKTsKCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBzZXRCeXRlcyhTdHJpbmcgbmFtZSwgYnl0ZVtdIHZhbHVlKSB0aHJvd3Mg\nSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93IG5l\ndyBNZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3\ncml0YWJsZSIpOwogICAgICAgIGlmICghTWVzc2FnZVV0aWwuaXNWYWxpZEtl\neShuYW1lKSkgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigi\nSW52YWxpZCBrZXkgIiArIG5hbWUpOwogICAgICAgIHBheWxvYWQucHV0KG5h\nbWUsIHZhbHVlKTsKCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCBzZXRCeXRlcyhTdHJpbmcgbmFtZSwgYnl0ZVtdIHZhbHVlLCBpbnQg\naSwgaW50IGkxKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ncmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0\naW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIpOwogICAgICAgIGlmICghTWVz\nc2FnZVV0aWwuaXNWYWxpZEtleShuYW1lKSkgdGhyb3cgbmV3IElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbigiSW52YWxpZCBrZXkgIiArIG5hbWUpOwogICAg\nICAgIHBheWxvYWQucHV0KG5hbWUsIHZhbHVlKTsKCiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRPYmplY3QoU3RyaW5nIG5hbWUs\nIE9iamVjdCB2YWx1ZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4\nY2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsKICAgICAgICBpZiAo\nIU1lc3NhZ2VVdGlsLmlzVmFsaWRLZXkobmFtZSkpIHRocm93IG5ldyBJbGxl\nZ2FsQXJndW1lbnRFeGNlcHRpb24oIkludmFsaWQga2V5ICIgKyBuYW1lKTsK\nICAgICAgICBwYXlsb2FkLnB1dChuYW1lLCB2YWx1ZSk7CgogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gaXRlbUV4aXN0cyhTdHJp\nbmcgbmFtZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIHBheWxvYWQuY29udGFpbnNLZXkobmFtZSk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCBjbGVhckJvZHkoKSB0aHJvd3MgSk1TRXhj\nZXB0aW9uIHsKICAgICAgICBzdXBlci5jbGVhckJvZHkoKTsKICAgICAgICAv\nLyBhbGxvdyByZWFkIGFuZCB3cml0ZS4KICAgICAgICB0aGlzLnBheWxvYWQu\nY2xlYXIoKTsKICAgICAgICB0aGlzLnJlYWRNb2RlID0gZmFsc2U7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCByZXNldCgpIHRocm93\ncyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmICh0aGlzLnJlYWRNb2RlKSBy\nZXR1cm4gOwogICAgICAgIHRoaXMucmVhZE1vZGUgPSB0cnVlOwogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgTWFwTWVzc2FnZUltcGwgY3JlYXRlQ2xvbmUo\nU2Vzc2lvbkltcGwgc2Vzc2lvbiwgU3RyaW5nIHNvdXJjZVRvcGljTmFtZSwg\nU3RyaW5nIHN1YnNjcmliZXJJZCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAg\nICAgICAgcmV0dXJuIG5ldyBNYXBNZXNzYWdlSW1wbChzZXNzaW9uLCB0aGlz\nLCBzb3VyY2VUb3BpY05hbWUsIHN1YnNjcmliZXJJZCk7CiAgICB9Cn0K\n","encoding":"base64"}

