{"sha":"d13feb033427fbe9cdce8118224ccd66df3ad838","node_id":"MDQ6QmxvYjE1NzU5NTY6ZDEzZmViMDMzNDI3ZmJlOWNkY2U4MTE4MjI0Y2NkNjZkZjNhZDgzOA==","size":34845,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/d13feb033427fbe9cdce8118224ccd66df3ad838","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMubWVzc2FnZTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5qbXMuU2Vzc2lvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5qbXMubWVzc2FnZS5oZWFkZXIuTWV0YWRhdGFQcm9jZXNzb3I7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5qbXMuc2VsZWN0b3IuU2VsZWN0\nb3JFdmFsdWF0aW9uRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2w7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBv\ncnQgamF2YXguam1zLkRlbGl2ZXJ5TW9kZTsKaW1wb3J0IGphdmF4Lmptcy5E\nZXN0aW5hdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5KTVNFeGNlcHRpb247Cmlt\ncG9ydCBqYXZheC5qbXMuTWVzc2FnZTsKaW1wb3J0IGphdmF4Lmptcy5NZXNz\nYWdlRm9ybWF0RXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2VO\nb3RXcml0ZWFibGVFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVj\ndGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuRW51bWVyYXRpb247CmltcG9ydCBq\nYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0Owpp\nbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgovKioKICogSW1wbGVtZW50YXRp\nb24gb2YgYSBtZXNzYWdlLgogKi8KcHVibGljIGNsYXNzIE1lc3NhZ2VJbXBs\nIGltcGxlbWVudHMgTWVzc2FnZSB7CgogICAgLy8gVGhpcyBpcyBvZiB0eXBl\nIGJ5dGUgZm9yIG5vdyAtIGVub3VnaCA/CiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZyBKTVNfTUVTU0FHRV9UWVBFX0tFWSA9ICJqbXNCb2R5VHlw\nZSI7CiAgICAvLyAnb3RoZXJzJyAobm9uLWptcyBjbGllbnRzKSBjYW4gZGVw\nZW5kIG9uIHRoaXMgYm9vbGVhbiBtZXRhZGF0YSBwcm9wZXJ0eSA6IGZvciBu\nb3csIHBhcnQKICAgIC8vIG9mIGptcyB2YWx1ZXMgZGlyZWN0bHkgZHVlIHRv\nIGhvdyBtZXRhZGF0YSBpcyBiZWluZyBkZXNpZ25lZCAhCiAgICAvLyBzaWdo\nIDotKAogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgRU1QVFlfQk9E\nWV9LRVkgPSAiYm9keUVtcHR5IjsKCgogICAgcHJpdmF0ZSBmaW5hbCBzdGF0\naWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKE1l\nc3NhZ2VJbXBsLmNsYXNzKTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0\ncmluZyBKTVNfTUVTU0FHRV9JRCA9ICJKTVNNZXNzYWdlSUQiOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgSk1TX1RJTUVTVEFNUCA9ICJKTVNU\naW1lc3RhbXAiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgSk1T\nX0NPUlJFTEFUSU9OX0lEID0gIkpNU0NvcnJlbGF0aW9uSUQiOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgSk1TX1JFUExZX1RPID0gIkpNU1Jl\ncGx5VG8iOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgSk1TX0RF\nU1RJTkFUSU9OID0gIkpNU0Rlc3RpbmF0aW9uIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIEpNU19ERUxJVkVSWV9NT0RFID0gIkpNU0RlbGl2\nZXJ5TW9kZSI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBKTVNf\nUkVERUxJVkVSRUQgPSAiSk1TUmVkZWxpdmVyZWQiOwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgSk1TX1RZUEUgPSAiSk1TVHlwZSI7CiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBKTVNfRVhQSVJBVElPTiA9ICJK\nTVNFeHBpcmF0aW9uIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n\nIEpNU19QUklPUklUWSA9ICJKTVNQcmlvcml0eSI7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgU2V0PFN0cmluZz4gc3RhbmRhcmRQcm9wZXJ0aWVzOwog\nICAgc3RhdGljIHsKICAgICAgICBTZXQ8U3RyaW5nPiBzZXQgPSBuZXcgSGFz\naFNldDxTdHJpbmc+KDE2KTsKICAgICAgICBzZXQuYWRkKEpNU19NRVNTQUdF\nX0lEKTsKICAgICAgICBzZXQuYWRkKEpNU19USU1FU1RBTVApOwogICAgICAg\nIHNldC5hZGQoSk1TX0NPUlJFTEFUSU9OX0lEKTsKCiAgICAgICAgc2V0LmFk\nZChKTVNfUkVQTFlfVE8pOwogICAgICAgIHNldC5hZGQoSk1TX0RFU1RJTkFU\nSU9OKTsKICAgICAgICBzZXQuYWRkKEpNU19ERUxJVkVSWV9NT0RFKTsKCiAg\nICAgICAgLy8gQ3VycmVudGx5IHNpbXVsYXRlZCBpbiBwcm92aWRlciAtIE5P\nVCBmcm9tIGhlZHdpZy4KICAgICAgICBzZXQuYWRkKEpNU19SRURFTElWRVJF\nRCk7CiAgICAgICAgc2V0LmFkZChKTVNfVFlQRSk7CgogICAgICAgIHNldC5h\nZGQoSk1TX0VYUElSQVRJT04pOwogICAgICAgIHNldC5hZGQoSk1TX1BSSU9S\nSVRZKTsKCiAgICAgICAgc3RhbmRhcmRQcm9wZXJ0aWVzID0gQ29sbGVjdGlv\nbnMudW5tb2RpZmlhYmxlU2V0KHNldCk7CiAgICB9CgogICAgcHJpdmF0ZSBm\naW5hbCBTZXNzaW9uSW1wbCBzZXNzaW9uOwogICAgcHJpdmF0ZSBmaW5hbCBT\ndHJpbmcgc2VydmVySm1zTWVzc2FnZUlkOwoKICAgIHByaXZhdGUgU3RyaW5n\nIGptc01lc3NhZ2VJZDsKICAgIHByaXZhdGUgbG9uZyBqbXNUaW1lc3RhbXAg\nPSAwOwogICAgcHJpdmF0ZSBTdHJpbmcgam1zQ29ycmVsYXRpb25JRDsKCiAg\nICBwcml2YXRlIERlc3RpbmF0aW9uIGptc1JlcGx5VG87CiAgICBwcml2YXRl\nIERlc3RpbmF0aW9uIGptc0Rlc3RpbmF0aW9uOwogICAgcHJpdmF0ZSBpbnQg\nam1zRGVsaXZlcnlNb2RlID0gRGVsaXZlcnlNb2RlLlBFUlNJU1RFTlQ7Cgog\nICAgcHJpdmF0ZSBib29sZWFuIGptc1JlZGVsaXZlcmVkOwogICAgcHJpdmF0\nZSBTdHJpbmcgam1zVHlwZTsKCiAgICBwcml2YXRlIGxvbmcgam1zRXhwaXJh\ndGlvbiA9IDBMOwogICAgcHJpdmF0ZSBpbnQgam1zUHJpb3JpdHkgPSBNZXNz\nYWdlLkRFRkFVTFRfUFJJT1JJVFk7CgogICAgLy8gTm90ZTogdGhpcyBET0VT\nIE5PVCBjb250YWluIHN0YW5kYXJkIGhlYWRlcnMgLSB3aGljaCBhcmUgZXhw\nbGljaXRseSBoYW5kbGVkLgogICAgcHJpdmF0ZSBib29sZWFuIHByb3BlcnRp\nZXNSZWFkT25seSA9IGZhbHNlOwogICAgcHJvdGVjdGVkIE1hcDxTdHJpbmcs\nIE9iamVjdD4gcHJvcGVydGllcyA9IG5ldyBIYXNoTWFwPFN0cmluZywgT2Jq\nZWN0Pig0KTsKCiAgICAvLyBrZXkgPT0gc3RhbmRhcmQgcHJvcGVydHkuCiAg\nICBwcml2YXRlIFNldDxTdHJpbmc+IHN0YW5kYXJkUHJvcGVydGllc0V4aXN0\ncyA9IG5ldyBIYXNoU2V0PFN0cmluZz4oMTYpOwogICAgcHJpdmF0ZSBTZXQ8\nU3RyaW5nPiBzdGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JXaXJlID0gbmV3\nIEhhc2hTZXQ8U3RyaW5nPigxNik7CgogICAgcHJpdmF0ZSBmaW5hbCBTdHJp\nbmcgc291cmNlTmFtZTsKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIHN1YnNj\ncmliZXJJZDsKCiAgICBwcml2YXRlIGZpbmFsIFJ1bm5hYmxlIGFja1J1bm5h\nYmxlOwoKICAgIC8vIFRoaXMgaXMgdG8gYmUgc2V0IHRvIHRydWUgT05MWSBm\nb3IgdGVzdGluZyAtIE5PVCBvdGhlcndpc2UgIQogICAgLy8gVGhlIEpNUyBh\ncGkgRE9FUyBOT1QgZXhwb3NlIHRoaXMgLi4uCiAgICAvLyBwcml2YXRlIGJv\nb2xlYW4gYWxsb3dTcGVjaWZ5Sk1TTWVzc2FnZUlERm9yVGVzdDsKCiAgICAv\nL3ByaXZhdGUgZmluYWwgUHViU3ViUHJvdG9jb2wuTWVzc2FnZSByYXdNZXNz\nYWdlOwoKICAgIHB1YmxpYyBNZXNzYWdlSW1wbChTZXNzaW9uSW1wbCBzZXNz\naW9uKXsKICAgICAgICB0aGlzLnNlc3Npb24gPSBzZXNzaW9uOwoKICAgICAg\nICB0aGlzLnNvdXJjZU5hbWUgPSBudWxsOwogICAgICAgIHRoaXMuc3Vic2Ny\naWJlcklkID0gbnVsbDsKICAgICAgICB0aGlzLmFja1J1bm5hYmxlID0gbnVs\nbDsKICAgICAgICB0aGlzLnNlcnZlckptc01lc3NhZ2VJZCA9IG51bGw7CiAg\nICAgICAgLy8gdGhpcy5yYXdNZXNzYWdlID0gbnVsbDsKICAgIH0KCiAgICBN\nZXNzYWdlSW1wbChTZXNzaW9uSW1wbCBzZXNzaW9uLCBNZXNzYWdlSW1wbCBt\nZXNzYWdlLCBTdHJpbmcgc291cmNlTmFtZSwgU3RyaW5nIHN1YnNjcmliZXJJ\nZCkKICAgICAgICB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICB0aGlz\nLnNlc3Npb24gPSBzZXNzaW9uOwogICAgICAgIHRoaXMuc291cmNlTmFtZSA9\nIHNvdXJjZU5hbWU7CiAgICAgICAgdGhpcy5zdWJzY3JpYmVySWQgPSBzdWJz\nY3JpYmVySWQ7CiAgICAgICAgdGhpcy5hY2tSdW5uYWJsZSA9IG1lc3NhZ2Uu\nZ2V0QWNrUnVubmFibGUoKTsKICAgICAgICB0aGlzLnNlcnZlckptc01lc3Nh\nZ2VJZCA9IG1lc3NhZ2UuZ2V0U2VydmVySm1zTWVzc2FnZUlkKCk7CiAgICAg\nICAgLy8gdGhpcy5yYXdNZXNzYWdlID0gbnVsbDsKCiAgICAgICAgLy8gQ29w\neSBhbGwgcHJvcGVydGllcyBmcm9tIG1lc3NhZ2UgdG8gdGhpcyBjbGFzcy4K\nCiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnB1dEFsbChtZXNzYWdlLnByb3Bl\ncnRpZXMpOwoKICAgICAgICAvLyBOb3cgY29weSByZXN0IG9mIHRoZSBzdGF0\nZSBvdmVyIC4uLgogICAgICAgIGlmIChtZXNzYWdlLnByb3BlcnR5RXhpc3Rz\nKEpNU19NRVNTQUdFX0lEKSkgc2V0Sk1TTWVzc2FnZUlESW50ZXJuYWwobWVz\nc2FnZS5nZXRKTVNNZXNzYWdlSUQoKSk7CiAgICAgICAgaWYgKG1lc3NhZ2Uu\ncHJvcGVydHlFeGlzdHMoSk1TX1RJTUVTVEFNUCkpIHNldEpNU1RpbWVzdGFt\ncChtZXNzYWdlLmdldEpNU1RpbWVzdGFtcCgpKTsKICAgICAgICBpZiAobWVz\nc2FnZS5wcm9wZXJ0eUV4aXN0cyhKTVNfQ09SUkVMQVRJT05fSUQpKSBzZXRK\nTVNDb3JyZWxhdGlvbklEKG1lc3NhZ2UuZ2V0Sk1TQ29ycmVsYXRpb25JRCgp\nKTsKICAgICAgICAvLyBXZSBkbyBub3Qgc3VwcG9ydCB0aGlzIHJpZ2h0IG5v\ndy4KICAgICAgICAvLyBpZiAobWVzc2FnZS5wcm9wZXJ0eUV4aXN0cyhKTVNf\nQ09SUkVMQVRJT05fSURfQVNfQllURVMpKQogICAgICAgIC8vICAgIHNldEpN\nU0NvcnJlbGF0aW9uSURBc0J5dGVzKG1lc3NhZ2UuZ2V0Sk1TQ29ycmVsYXRp\nb25JREFzQnl0ZXMoKSk7CiAgICAgICAgaWYgKG1lc3NhZ2UucHJvcGVydHlF\neGlzdHMoSk1TX1JFUExZX1RPKSkgc2V0Sk1TUmVwbHlUbyhtZXNzYWdlLmdl\ndEpNU1JlcGx5VG8oKSk7CiAgICAgICAgaWYgKG1lc3NhZ2UucHJvcGVydHlF\neGlzdHMoSk1TX0RFU1RJTkFUSU9OKSkgc2V0Sk1TRGVzdGluYXRpb24obWVz\nc2FnZS5nZXRKTVNEZXN0aW5hdGlvbigpKTsKICAgICAgICBpZiAobWVzc2Fn\nZS5wcm9wZXJ0eUV4aXN0cyhKTVNfREVMSVZFUllfTU9ERSkpIHNldEpNU0Rl\nbGl2ZXJ5TW9kZShtZXNzYWdlLmdldEpNU0RlbGl2ZXJ5TW9kZSgpKTsKICAg\nICAgICBpZiAobWVzc2FnZS5wcm9wZXJ0eUV4aXN0cyhKTVNfUkVERUxJVkVS\nRUQpKSBzZXRKTVNSZWRlbGl2ZXJlZChtZXNzYWdlLmdldEpNU1JlZGVsaXZl\ncmVkKCkpOwogICAgICAgIGlmIChtZXNzYWdlLnByb3BlcnR5RXhpc3RzKEpN\nU19UWVBFKSkgc2V0Sk1TVHlwZShtZXNzYWdlLmdldEpNU1R5cGUoKSk7CiAg\nICAgICAgaWYgKG1lc3NhZ2UucHJvcGVydHlFeGlzdHMoSk1TX0VYUElSQVRJ\nT04pKSBzZXRKTVNFeHBpcmF0aW9uKG1lc3NhZ2UuZ2V0Sk1TRXhwaXJhdGlv\nbigpKTsKICAgICAgICBpZiAobWVzc2FnZS5wcm9wZXJ0eUV4aXN0cyhKTVNf\nUFJJT1JJVFkpKSBzZXRKTVNQcmlvcml0eShtZXNzYWdlLmdldEpNU1ByaW9y\naXR5KCkpOwoKICAgICAgICB0aGlzLnByb3BlcnRpZXNSZWFkT25seSA9IG1l\nc3NhZ2UucHJvcGVydGllc1JlYWRPbmx5OwogICAgfQoKICAgIC8vIFRvIGNs\nb25lIGEgbWVzc2FnZSBmcm9tIGEgTWVzc2FnZSB3aGljaCBpcyBOT1QgTWVz\nc2FnZUltcGwKICAgIC8vIENoYW5naW5nIG9yZGVyIG9mIHBhcmFtZXRlciB0\nbyBOT1QgYWNjaWRlbnRhbGx5IGNsYXNoIHdpdGggdGhlIGNvbnN0cnVjdG9y\nIGFib3ZlLgogICAgLy8gVGhpcyBpcyBtaWRseSBjb25mdXNpbmcsIGJ1dCBo\nZWxwcyBhIGxvdCBpbiBwcmV2ZW50aW5nIGFjY2lkZW50YWwgYnVncyAhCiAg\nICBNZXNzYWdlSW1wbChNZXNzYWdlIG1lc3NhZ2UsIFNlc3Npb25JbXBsIHNl\nc3Npb24pIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHRoaXMuc2Vz\nc2lvbiA9IHNlc3Npb247CiAgICAgICAgdGhpcy5zb3VyY2VOYW1lID0gbnVs\nbDsKICAgICAgICB0aGlzLnN1YnNjcmliZXJJZCA9IG51bGw7CiAgICAgICAg\ndGhpcy5hY2tSdW5uYWJsZSA9IG51bGw7CiAgICAgICAgdGhpcy5zZXJ2ZXJK\nbXNNZXNzYWdlSWQgPSBudWxsOwogICAgICAgIC8vIHRoaXMucmF3TWVzc2Fn\nZSA9IG51bGw7CgogICAgICAgIGFzc2VydCAoISAobWVzc2FnZSBpbnN0YW5j\nZW9mIE1lc3NhZ2VJbXBsICkpOwoKICAgICAgICAvLyBDb3B5IGFsbCBwcm9w\nZXJ0aWVzIGZyb20gbWVzc2FnZSB0byB0aGlzIGNsYXNzLgogICAgICAgIEVu\ndW1lcmF0aW9uIG5hbWVzID0gbWVzc2FnZS5nZXRQcm9wZXJ0eU5hbWVzKCk7\nCiAgICAgICAgd2hpbGUgKG5hbWVzLmhhc01vcmVFbGVtZW50cygpKXsKICAg\nICAgICAgICAgT2JqZWN0IG5hbWUgPSBuYW1lcy5uZXh0RWxlbWVudCgpOwog\nICAgICAgICAgICBpZiAoIShuYW1lIGluc3RhbmNlb2YgU3RyaW5nKSkKICAg\nICAgICAgICAgICB0aHJvdyBuZXcgSk1TRXhjZXB0aW9uKCJVbnN1cHBvcnRl\nZCB0eXBlIChleHBlY3RlZCBTdHJpbmcpIGZvciBrZXkgOiAiICsgbmFtZSk7\nCgogICAgICAgICAgICBTdHJpbmcgc25hbWUgPSAoU3RyaW5nKSBuYW1lOwog\nICAgICAgICAgICB0aGlzLnByb3BlcnRpZXMucHV0KHNuYW1lLCBtZXNzYWdl\nLmdldE9iamVjdFByb3BlcnR5KHNuYW1lKSk7CiAgICAgICAgfQoKICAgICAg\nICAvLyBOb3cgY29weSByZXN0IG9mIHRoZSBzdGF0ZSBvdmVyIC4uLgogICAg\nICAgIC8vIEpNUyBWSU9MQVRJT046IHdlIHdpbGwgYmUgdW5hYmxlIHRvIGNo\nZWNrIGZvciBwcm9wZXJ0eUV4aXN0cyBhZnRlciB0aGlzLAogICAgICAgIC8v\nICBhdCBzZW5kZXIgYW5kIHJlY2VpdmVyIHNpZGUgLi4uIHNpZ2ggOi0oCiAg\nICAgICAgc2V0Sk1TTWVzc2FnZUlESW50ZXJuYWwobWVzc2FnZS5nZXRKTVNN\nZXNzYWdlSUQoKSk7CiAgICAgICAgc2V0Sk1TVGltZXN0YW1wKG1lc3NhZ2Uu\nZ2V0Sk1TVGltZXN0YW1wKCkpOwogICAgICAgIHNldEpNU0NvcnJlbGF0aW9u\nSUQobWVzc2FnZS5nZXRKTVNDb3JyZWxhdGlvbklEKCkpOwogICAgICAgIC8v\nIFdlIGRvIG5vdCBzdXBwb3J0IHRoaXMgcmlnaHQgbm93LgogICAgICAgIC8v\nIHNldEpNU0NvcnJlbGF0aW9uSURBc0J5dGVzKG1lc3NhZ2UuZ2V0Sk1TQ29y\ncmVsYXRpb25JREFzQnl0ZXMoKSk7CiAgICAgICAgc2V0Sk1TUmVwbHlUbyht\nZXNzYWdlLmdldEpNU1JlcGx5VG8oKSk7CiAgICAgICAgc2V0Sk1TRGVzdGlu\nYXRpb24obWVzc2FnZS5nZXRKTVNEZXN0aW5hdGlvbigpKTsKICAgICAgICBz\nZXRKTVNEZWxpdmVyeU1vZGUobWVzc2FnZS5nZXRKTVNEZWxpdmVyeU1vZGUo\nKSk7CiAgICAgICAgc2V0Sk1TUmVkZWxpdmVyZWQobWVzc2FnZS5nZXRKTVNS\nZWRlbGl2ZXJlZCgpKTsKICAgICAgICBzZXRKTVNUeXBlKG1lc3NhZ2UuZ2V0\nSk1TVHlwZSgpKTsKICAgICAgICBzZXRKTVNFeHBpcmF0aW9uKG1lc3NhZ2Uu\nZ2V0Sk1TRXhwaXJhdGlvbigpKTsKICAgICAgICBzZXRKTVNQcmlvcml0eSht\nZXNzYWdlLmdldEpNU1ByaW9yaXR5KCkpOwoKICAgICAgICAvLyBTaG91bGQg\nYmUgYWJsZSB0byBtb2RpZnksIHJpZ2h0ID8KICAgICAgICB0aGlzLnByb3Bl\ncnRpZXNSZWFkT25seSA9IGZhbHNlOwoKICAgICAgICAvLyByZW1vdmUgYWxs\nIGptcyBzdGFuZGFyZCBrZXlzIGZyb20gcHJvcGVydGllcyBub3cgOiB0aGlz\nIHNob3VsZCBpZGVhbGx5IHJlc3VsdCBpbiB6ZXJvCiAgICAgICAgLy8gcmVt\nb3ZhbHMgLi4uIGJ1dCB3ZSBuZXZlciBrbm93IHdpdGggY2xpZW50IGNvZGUg\nIQogICAgICAgIGZvciAoU3RyaW5nIGtleSA6IHN0YW5kYXJkUHJvcGVydGll\ncykgcHJvcGVydGllcy5yZW1vdmUoa2V5KTsKICAgIH0KCiAgICBNZXNzYWdl\nSW1wbChTZXNzaW9uSW1wbCBzZXNzaW9uLCBQdWJTdWJQcm90b2NvbC5NZXNz\nYWdlIG1lc3NhZ2UsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcywK\nICAgICAgICAgICAgICAgIFN0cmluZyBzb3VyY2VOYW1lLCBTdHJpbmcgc3Vi\nc2NyaWJlcklkLCBSdW5uYWJsZSBhY2tSdW5uYWJsZSkgdGhyb3dzIEpNU0V4\nY2VwdGlvbiB7CiAgICAgICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjsKICAg\nICAgICB0aGlzLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lOwogICAgICAgIHRo\naXMuc3Vic2NyaWJlcklkID0gc3Vic2NyaWJlcklkOwogICAgICAgIHRoaXMu\nYWNrUnVubmFibGUgPSBhY2tSdW5uYWJsZTsKICAgICAgICAvLyB0aGlzLnJh\nd01lc3NhZ2UgPSBtZXNzYWdlOwoKICAgICAgICAvLyBzZXRKTVNNZXNzYWdl\nSUQoZ2V0U3RyaW5nUHJvcGVydHkocHJvcGVydGllcywgSk1TX01FU1NBR0Vf\nSUQpKTsKICAgICAgICBzZXRKTVNNZXNzYWdlSURJbnRlcm5hbChNZXNzYWdl\nVXRpbC5nZW5lcmF0ZUpNU01lc3NhZ2VJZEZyb21TZXFJZChtZXNzYWdlLmdl\ndE1zZ0lkKCkpKTsKICAgICAgICB0aGlzLnNlcnZlckptc01lc3NhZ2VJZCA9\nIGdldEpNU01lc3NhZ2VJRCgpOwoKICAgICAgICBpZiAocHJvcGVydGllcy5j\nb250YWluc0tleShKTVNfVElNRVNUQU1QKSkgc2V0Sk1TVGltZXN0YW1wKGdl\ndExvbmdQcm9wZXJ0eShwcm9wZXJ0aWVzLCBKTVNfVElNRVNUQU1QKSk7CiAg\nICAgICAgaWYgKHByb3BlcnRpZXMuY29udGFpbnNLZXkoSk1TX0NPUlJFTEFU\nSU9OX0lEKSkgc2V0Sk1TQ29ycmVsYXRpb25JRCgKICAgICAgICAgICAgZ2V0\nU3RyaW5nUHJvcGVydHkocHJvcGVydGllcywgSk1TX0NPUlJFTEFUSU9OX0lE\nKSk7CiAgICAgICAgaWYgKG51bGwgIT0gZ2V0U3RyaW5nUHJvcGVydHkocHJv\ncGVydGllcywgSk1TX1JFUExZX1RPKSkgewogICAgICAgICAgICBzZXRKTVNS\nZXBseVRvKAogICAgICAgICAgICAgICAgICAgIHNlc3Npb24uZ2V0RGVzdGlu\nYXRpb24oc2Vzc2lvbi5maW5kRGVzdGluYXRpb25UeXBlKGdldFN0cmluZ1By\nb3BlcnR5KHByb3BlcnRpZXMsIEpNU19SRVBMWV9UTykpLAogICAgICAgICAg\nICAgICAgICAgICAgICBnZXRTdHJpbmdQcm9wZXJ0eShwcm9wZXJ0aWVzLCBK\nTVNfUkVQTFlfVE8pCiAgICAgICAgICAgICAgICAgICAgKSk7CiAgICAgICAg\nfQogICAgICAgIGlmIChudWxsICE9IGdldFN0cmluZ1Byb3BlcnR5KHByb3Bl\ncnRpZXMsIEpNU19ERVNUSU5BVElPTikpIHsKICAgICAgICAgICAgc2V0Sk1T\nRGVzdGluYXRpb24oCiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbi5nZXRE\nZXN0aW5hdGlvbihzZXNzaW9uLmZpbmREZXN0aW5hdGlvblR5cGUoCiAgICAg\nICAgICAgICAgICAgICAgICAgIGdldFN0cmluZ1Byb3BlcnR5KHByb3BlcnRp\nZXMsIEpNU19ERVNUSU5BVElPTikpLAogICAgICAgICAgICAgICAgICAgICAg\nICBnZXRTdHJpbmdQcm9wZXJ0eShwcm9wZXJ0aWVzLCBKTVNfREVTVElOQVRJ\nT04pCiAgICAgICAgICAgICAgICAgICAgKSk7CiAgICAgICAgfQoKICAgICAg\nICBpZiAocHJvcGVydGllcy5jb250YWluc0tleShKTVNfREVMSVZFUllfTU9E\nRSkpIHNldEpNU0RlbGl2ZXJ5TW9kZSgKICAgICAgICAgICAgZ2V0SW50UHJv\ncGVydHkocHJvcGVydGllcywgSk1TX0RFTElWRVJZX01PREUpKTsKICAgICAg\nICBpZiAocHJvcGVydGllcy5jb250YWluc0tleShKTVNfVFlQRSkpIHNldEpN\nU1R5cGUoZ2V0U3RyaW5nUHJvcGVydHkocHJvcGVydGllcywgSk1TX1RZUEUp\nKTsKCiAgICAgICAgaWYgKHByb3BlcnRpZXMuY29udGFpbnNLZXkoSk1TX0VY\nUElSQVRJT04pKSBzZXRKTVNFeHBpcmF0aW9uKAogICAgICAgICAgICBnZXRM\nb25nUHJvcGVydHkocHJvcGVydGllcywgSk1TX0VYUElSQVRJT04pKTsKICAg\nICAgICBpZiAocHJvcGVydGllcy5jb250YWluc0tleShKTVNfUFJJT1JJVFkp\nKSBzZXRKTVNQcmlvcml0eSgKICAgICAgICAgICAgZ2V0SW50UHJvcGVydHko\ncHJvcGVydGllcywgSk1TX1BSSU9SSVRZKSk7CgoKICAgICAgICAvLyByZW1v\ndmUgYWxsIGptcyBzdGFuZGFyZCBrZXlzIGZyb20gcHJvcGVydGllcyBub3cg\nOiB0aGlzIHNob3VsZCByZXN1bHQgaW4gemVybyByZW1vdmFscyAuLi4KICAg\nICAgICAvLyBidXQgYWRkaW5nIGFueXdheS4KICAgICAgICBmb3IgKFN0cmlu\nZyBrZXkgOiBzdGFuZGFyZFByb3BlcnRpZXMpIHByb3BlcnRpZXMucmVtb3Zl\nKGtleSk7CgogICAgICAgIC8vIEltbXV0YWJsZSBhZnRlciByZWFkaW5nIGZy\nb20gc3RyZWFtICEKICAgICAgICB0aGlzLnByb3BlcnRpZXNSZWFkT25seSA9\nIHRydWU7CiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnB1dEFsbChwcm9wZXJ0\naWVzKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgTWVzc2FnZVV0aWwuU3VwcG9y\ndGVkTWVzc2FnZVR5cGVzIGdldEptc01lc3NhZ2VUeXBlKCl7CiAgICAgICAg\nLy8gVmFsaWRhdGUgYWdhaW5zdCBjb2RpbmcgYnVnIC4uLiB0aGlzIE1VU1Qg\nYmUgb3ZlcnJpZGRlbiBpbiBhbGwgc3ViY2xhc3Nlcy4KICAgICAgICBpZiAo\nZ2V0Q2xhc3MoKSAhPSBNZXNzYWdlSW1wbC5jbGFzcykKICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oIlRoaXMgbWV0aG9kIG11\nc3QgYmUgb3ZlcnJpZGRlbiBieSBzdWJjbGFzc2VzLiBjbGFzcyA6ICIgKyBn\nZXRDbGFzcygpKTsKICAgICAgICByZXR1cm4gTWVzc2FnZVV0aWwuU3VwcG9y\ndGVkTWVzc2FnZVR5cGVzLk9OTFlfTUVTU0FHRTsKICAgIH0KCiAgICBwdWJs\naWMgUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBnZW5lcmF0ZUhlZHdpZ01lc3Nh\nZ2UoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICAvLyBUaGlzIGlz\nIHRvIGJlIGNhbGxlZCBPTkxZIGZyb20gdGhlIGJhc2UgY2xhc3MgLSBhbGwg\nY2hpbGRyZW4gTVVTVCBvdmVycmlkZSBpdCBhbmQgTk9UIGRlbGVnYXRlIHRv\nIGl0LgogICAgICAgIGlmIChnZXRDbGFzcygpICE9IE1lc3NhZ2VJbXBsLmNs\nYXNzKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBKTVNFeGNlcHRpb24oIlVu\nZXhwZWN0ZWQgdG8gY2FsbCBNZXNzYWdlSW1wbCdzIGdlbmVyYXRlSGVkd2ln\nTWVzc2FnZSBmcm9tIHN1YmNsYXNzICIgKwogICAgICAgICAgICAgICAgZ2V0\nQ2xhc3MoKSk7CiAgICAgICAgfQoKICAgICAgICBQdWJTdWJQcm90b2NvbC5N\nZXNzYWdlLkJ1aWxkZXIgYnVpbGRlciA9IFB1YlN1YlByb3RvY29sLk1lc3Nh\nZ2UubmV3QnVpbGRlcigpOwogICAgICAgIHBvcHVsYXRlQnVpbGRlcldpdGhI\nZWFkZXJzKGJ1aWxkZXIpOwogICAgICAgIC8vIG5vIGJvZHkgLSB3aWxsIGJl\nIGFwcHJvcHJpYXRlbHkgc2V0IGluIHBvcHVsYXRlQnVpbGRlcldpdGhIZWFk\nZXJzKCkuCiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGQoKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0JvZHlFbXB0eSgpewogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qCiAgICBwcm90ZWN0ZWQgdm9p\nZCBtYXJrRW1wdHlCb2R5KFB1YlN1YlByb3RvY29sLk1lc3NhZ2UuQnVpbGRl\nciBidWlsZGVyKSB7CiAgICAgICAgTWV0YWRhdGFQcm9jZXNzb3IuYWRkQm9v\nbGVhblByb3BlcnR5KGJ1aWxkZXIsIEVNUFRZX0JPRFlfS0VZLCB0cnVlKTsK\nICAgICAgICBidWlsZGVyLnNldEJvZHkoQnl0ZVN0cmluZy5FTVBUWSk7CiAg\nICB9CiAgICAqLwoKICAgIHByb3RlY3RlZCBib29sZWFuIGhhc0JvZHlGcm9t\nUHJvcGVydGllcygpIHsKICAgICAgICAvLyBpZiBrZXkgbWlzc2luZyAoY29t\nbW9uIGNhc2UpLCB0aGVuIHRoZXJlIGlzIGJvZHkuCiAgICAgICAgaWYgKCFw\ncm9wZXJ0aWVzLmNvbnRhaW5zS2V5KEVNUFRZX0JPRFlfS0VZKSkgcmV0dXJu\nIHRydWU7CiAgICAgICAgLy8gSWYgcHJlc2VudCwgdGhlbiBjaGVjayBpZiBp\ndCBpcyBhIGJvb2xlYW4gb2YgdmFsdWUgdHJ1ZS4KICAgICAgICBPYmplY3Qg\ndmFsdWUgPSBwcm9wZXJ0aWVzLmdldChFTVBUWV9CT0RZX0tFWSk7CgogICAg\nICAgIC8vIHNwZWNpYWwgY2FzZSBudWxsLgogICAgICAgIGlmIChudWxsID09\nIHZhbHVlKSByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAodmFsdWUgaW5zdGFu\nY2VvZiBCb29sZWFuKSByZXR1cm4gISAoQm9vbGVhbikgdmFsdWU7CgogICAg\nICAgIC8vIHVua25vd24gdHlwZSAuLi4KICAgICAgICBsb2dnZXIuaW5mbygi\nVW5rbm93biB0eXBlIGZvciB2YWx1ZSBvZiAiICsgRU1QVFlfQk9EWV9LRVkg\nKyAiIGluIG1lc3NhZ2UgcHJvcGVydGllcyA6ICIgKyB2YWx1ZSk7CiAgICAg\nICAgLy8gYXNzdW1lIHRydWUgYnkgZGVmYXVsdC4KICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCgogICAgcHJvdGVjdGVkIGZpbmFsIHZvaWQgcG9wdWxh\ndGVCdWlsZGVyV2l0aEhlYWRlcnMoUHViU3ViUHJvdG9jb2wuTWVzc2FnZS5C\ndWlsZGVyIGJ1aWxkZXIpIHRocm93cyBKTVNFeGNlcHRpb24gewoKICAgICAg\nICBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXNDb3B5ID0gbmV3IEhh\nc2hNYXA8U3RyaW5nLCBPYmplY3Q+KHByb3BlcnRpZXMpOwogICAgICAgIGlm\nIChpc0JvZHlFbXB0eSgpKSB7CiAgICAgICAgICAgIHByb3BlcnRpZXNDb3B5\nLnB1dChFTVBUWV9CT0RZX0tFWSwgdHJ1ZSk7CiAgICAgICAgICAgIGJ1aWxk\nZXIuc2V0Qm9keShCeXRlU3RyaW5nLkVNUFRZKTsKICAgICAgICB9CiAgICAg\nICAgLy8gTm90IHNldHRpbmcgdW5sZXNzIHJlcXVpcmVkIHRvIHJlZHVjZSBt\nZXNzYWdlIHNpemUgLSBjaGFuZ2UgdGhpcyA/CiAgICAgICAgLy8gZWxzZSBw\ncm9wZXJ0aWVzQ29weS5wdXQoRU1QVFlfQk9EWV9LRVksIGZhbHNlKTsKCiAg\nICAgICAgSXRlcmF0b3I8TWFwLkVudHJ5PFN0cmluZywgT2JqZWN0Pj4gaXRl\nciA9IHByb3BlcnRpZXNDb3B5LmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAg\nICAgICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpewogICAgICAgICAgICBNYXAu\nRW50cnk8U3RyaW5nLCBPYmplY3Q+IGVudHJ5ID0gaXRlci5uZXh0KCk7CiAg\nICAgICAgICAgIGlmIChzdGFuZGFyZFByb3BlcnRpZXMuY29udGFpbnMoZW50\ncnkuZ2V0S2V5KCkpKSB7CiAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlz\nSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8o\nIklnbm9yaW5nIHVzZXIgYXR0ZW1wdCB0byBzZXQgc3RhbmRhcmQgcHJvcGVy\ndHkgYXMgYXBwbGljYXRpb24gcHJvcGVydHkgOiAiICsgZW50cnkpOwogICAg\nICAgICAgICAgICAgaXRlci5yZW1vdmUoKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCgogICAgICAgIC8vIHNldCBqbXMgbWVzc2FnZSB0eXBlLgogICAg\nICAgIHByb3BlcnRpZXNDb3B5LnB1dChKTVNfTUVTU0FHRV9UWVBFX0tFWSwg\nZ2V0Sm1zTWVzc2FnZVR5cGUoKS5nZXRUeXBlKCkpOwogICAgICAgIGlmIChz\ndGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JXaXJlLmNvbnRhaW5zKEpNU19D\nT1JSRUxBVElPTl9JRCkpCiAgICAgICAgICBwcm9wZXJ0aWVzQ29weS5wdXQo\nSk1TX0NPUlJFTEFUSU9OX0lELCBnZXRKTVNDb3JyZWxhdGlvbklEKCkpOwoK\nICAgICAgICAvLyB1bnN1cHBvcnRlZCBmb3Igbm93LgogICAgICAgIC8vIGlm\nIChzdGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JXaXJlLmNvbnRhaW5zKEpN\nU19DT1JSRUxBVElPTl9JRF9BU19CWVRFUykpCiAgICAgICAgLy8gICAgcHJv\ncGVydGllc0NvcHkucHV0KEpNU19DT1JSRUxBVElPTl9JRF9BU19CWVRFUywg\nZ2V0Sk1TQ29ycmVsYXRpb25JREFzQnl0ZXMoKSk7CiAgICAgICAgaWYgKHN0\nYW5kYXJkUHJvcGVydGllc0V4aXN0c0ZvcldpcmUuY29udGFpbnMoSk1TX0RF\nTElWRVJZX01PREUpKQogICAgICAgICAgcHJvcGVydGllc0NvcHkucHV0KEpN\nU19ERUxJVkVSWV9NT0RFLCBnZXRKTVNEZWxpdmVyeU1vZGUoKSk7CgogICAg\nICAgIGlmIChzdGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JXaXJlLmNvbnRh\naW5zKEpNU19ERVNUSU5BVElPTikpCiAgICAgICAgICBwcm9wZXJ0aWVzQ29w\neS5wdXQoSk1TX0RFU1RJTkFUSU9OLCBzZXNzaW9uLnRvTmFtZShnZXRKTVNE\nZXN0aW5hdGlvbigpKSk7CiAgICAgICAgaWYgKHN0YW5kYXJkUHJvcGVydGll\nc0V4aXN0c0ZvcldpcmUuY29udGFpbnMoSk1TX0VYUElSQVRJT04pKQogICAg\nICAgICAgcHJvcGVydGllc0NvcHkucHV0KEpNU19FWFBJUkFUSU9OLCBnZXRK\nTVNFeHBpcmF0aW9uKCkpOwoKICAgICAgICAvLyBUaGlzIGNhbiBiZSBzZXQg\nYnkgY2xpZW50IC0gYnV0IHdlIGlnbm9yZSBpdCBpbiBoZWR3aWcuCiAgICAg\nICAgLy8gaWYgKHN0YW5kYXJkUHJvcGVydGllc0V4aXN0c0ZvcldpcmUuY29u\ndGFpbnMoSk1TX01FU1NBR0VfSUQpKQogICAgICAgIC8vICAgIHByb3BlcnRp\nZXNDb3B5LnB1dChKTVNfTUVTU0FHRV9JRCwgZ2V0Sk1TTWVzc2FnZUlEKCkp\nOwoKICAgICAgICAvLyBXZSBkbyBub3Qgc3VwcG9ydCBwcmlvcml0eSAtIGJ1\ndCB3ZSBhcmUgZ29uZyB0byBhbGxvdyBpdCB0byBiZSBzcGVjaWZpZWQgOiB0\naGlzIGlzCiAgICAgICAgLy8gZm9yIHNlbGVjdG9ycyB0byBzZXQgY29uZGl0\naW9ucyBvbiBpdCAhCiAgICAgICAgaWYgKHN0YW5kYXJkUHJvcGVydGllc0V4\naXN0c0ZvcldpcmUuY29udGFpbnMoSk1TX1BSSU9SSVRZKSkKICAgICAgICAg\nIHByb3BlcnRpZXNDb3B5LnB1dChKTVNfUFJJT1JJVFksIGdldEpNU1ByaW9y\naXR5KCkpOwoKICAgICAgICAvLyB0aGlzIGlzIG5vdCB0byBiZSBzZW50IHRv\nIGhlZHdpZy4KICAgICAgICAvLyBpZiAoc3RhbmRhcmRQcm9wZXJ0aWVzRXhp\nc3RzRm9yV2lyZS5jb250YWlucyhKTVNfUkVERUxJVkVSRUQpKQogICAgICAg\nIC8vICAgIHByb3BlcnRpZXNDb3B5LnB1dChKTVNfUkVERUxJVkVSRUQsIGdl\ndEpNU1JlZGVsaXZlcmVkKCkpOwoKICAgICAgICBpZiAoc3RhbmRhcmRQcm9w\nZXJ0aWVzRXhpc3RzRm9yV2lyZS5jb250YWlucyhKTVNfUkVQTFlfVE8pKQog\nICAgICAgICAgcHJvcGVydGllc0NvcHkucHV0KEpNU19SRVBMWV9UTywgc2Vz\nc2lvbi50b05hbWUoZ2V0Sk1TUmVwbHlUbygpKSk7CgoKICAgICAgICBwcm9w\nZXJ0aWVzQ29weS5wdXQoSk1TX1RJTUVTVEFNUCwgZ2V0Sk1TVGltZXN0YW1w\nKCkpOwogICAgICAgIGlmIChzdGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JX\naXJlLmNvbnRhaW5zKEpNU19UWVBFKSkgcHJvcGVydGllc0NvcHkucHV0KEpN\nU19UWVBFLCBnZXRKTVNUeXBlKCkpOwoKCiAgICAgICAgTWV0YWRhdGFQcm9j\nZXNzb3IuYWRkSGVhZGVycyhidWlsZGVyLCBwcm9wZXJ0aWVzQ29weSk7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIGdldEpNU01l\nc3NhZ2VJRCgpIHsKICAgICAgICByZXR1cm4gam1zTWVzc2FnZUlkOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0Sk1TTWVzc2Fn\nZUlEKFN0cmluZyBqbXNNZXNzYWdlSWQpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIC8vIEpNUyBWSU9MQVRJT04gLi4uIHdlIGFyZSBOT1QgYWxs\nb3dpbmcgY2xpZW50IHRvIG92ZXJyaWRlIGptcyBtZXNzYWdlLWlkLgogICAg\nICAgIC8vIGlmICghYWxsb3dTcGVjaWZ5Sk1TTWVzc2FnZUlERm9yVGVzdCkK\nICAgICAgICAvLyAgICB0aHJvdyBuZXcgSk1TRXhjZXB0aW9uKCJXZSBkbyBu\nb3QgYWxsb3cgc2V0dGluZyBqbXMgbWVzc2FnZSBpZC4gVGhpcyB3aWxsIGJl\nIGlnbm9yZWQgYnkgaGVkd2lnIGFueXdheS4iKTsKICAgICAgICBpZiAobG9n\nZ2VyLmlzRGVidWdFbmFibGVkKCkpIGxvZ2dlci5kZWJ1ZygiU2V0dGluZyB0\naGlzIGlzIGlycmVsZXZhbnQgLSB3ZSBvdmVycmlkZSBpdCBhbnl3YXkgLSAi\nICsKICAgICAgICAgICAgIiBoZWR3aWcgZG9lcyBub3QgYWxsb3cgc3BlY2lm\neWluZyBpdCBleHBsaWN0bHkuIik7CiAgICAgICAgc2V0Sk1TTWVzc2FnZUlE\nSW50ZXJuYWwoam1zTWVzc2FnZUlkKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRKTVNNZXNzYWdlSURJbnRlcm5hbChTdHJpbmcgam1zTWVzc2FnZUlk\nKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICB0aGlzLmptc01lc3Nh\nZ2VJZCA9IGptc01lc3NhZ2VJZDsKICAgICAgICBpZiAobnVsbCAhPSBqbXNN\nZXNzYWdlSWQpewogICAgICAgICAgICAvLyBXZSBkbyBub3QgYWxsb3cgc2Vu\nZGluZyB0aGUgcHJvcGVydHkgb3ZlciB3aXJlLgogICAgICAgICAgICB0aGlz\nLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0cy5hZGQoSk1TX01FU1NBR0VfSUQp\nOwogICAgICAgICAgICAvLyB0aGlzLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0\nc0ZvcldpcmUuYWRkKEpNU19NRVNTQUdFX0lEKTsKICAgICAgICB9CiAgICAg\nICAgZWxzZSB7CiAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVz\nRXhpc3RzLnJlbW92ZShKTVNfTUVTU0FHRV9JRCk7CiAgICAgICAgICAgIC8v\nIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzRm9yV2lyZS5yZW1vdmUo\nSk1TX01FU1NBR0VfSUQpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBUaGUg\naW1tdXRhYmxlIG1lc3NhZ2UgSWQgc2V0IGJ5IHRoZSBzZXJ2ZXIuCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFNlcnZlckptc01lc3NhZ2VJZCgpIHsKICAgICAg\nICByZXR1cm4gc2VydmVySm1zTWVzc2FnZUlkOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIGxvbmcgZ2V0Sk1TVGltZXN0YW1wKCkgewogICAg\nICAgIHJldHVybiBqbXNUaW1lc3RhbXA7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgdm9pZCBzZXRKTVNUaW1lc3RhbXAobG9uZyBqbXNUaW1l\nc3RhbXApIHsKICAgICAgICB0aGlzLmptc1RpbWVzdGFtcCA9IGptc1RpbWVz\ndGFtcDsKICAgICAgICB0aGlzLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0cy5h\nZGQoSk1TX1RJTUVTVEFNUCk7CiAgICAgICAgLy8gdGhpcy5zdGFuZGFyZFBy\nb3BlcnRpZXNFeGlzdHNGb3JXaXJlLmFkZChKTVNfVElNRVNUQU1QKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBieXRlW10gZ2V0Sk1TQ29y\ncmVsYXRpb25JREFzQnl0ZXMoKSB7CiAgICAgICAgdGhyb3cgbmV3IFVuc3Vw\ncG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCJ1bnN1cHBvcnRlZCIpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0Sk1TQ29ycmVs\nYXRpb25JREFzQnl0ZXMoYnl0ZVtdIGJ5dGVzKSB7CiAgICAgICAgdGhyb3cg\nbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCJ1bnN1cHBvcnRl\nZCIpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0\nSk1TQ29ycmVsYXRpb25JRChTdHJpbmcgam1zQ29ycmVsYXRpb25JRCkgewog\nICAgICAgIHRoaXMuam1zQ29ycmVsYXRpb25JRCA9IGptc0NvcnJlbGF0aW9u\nSUQ7CiAgICAgICAgaWYgKG51bGwgIT0gam1zQ29ycmVsYXRpb25JRCl7CiAg\nICAgICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzLmFkZChK\nTVNfQ09SUkVMQVRJT05fSUQpOwogICAgICAgICAgICB0aGlzLnN0YW5kYXJk\nUHJvcGVydGllc0V4aXN0c0ZvcldpcmUuYWRkKEpNU19DT1JSRUxBVElPTl9J\nRCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB0aGlz\nLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0cy5yZW1vdmUoSk1TX0NPUlJFTEFU\nSU9OX0lEKTsKICAgICAgICAgICAgdGhpcy5zdGFuZGFyZFByb3BlcnRpZXNF\neGlzdHNGb3JXaXJlLnJlbW92ZShKTVNfQ09SUkVMQVRJT05fSUQpOwogICAg\nICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0Sk1TQ29ycmVsYXRpb25JRCgpIHsKICAgICAgICByZXR1cm4gam1zQ29y\ncmVsYXRpb25JRDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBE\nZXN0aW5hdGlvbiBnZXRKTVNSZXBseVRvKCkgewogICAgICAgIHJldHVybiBq\nbXNSZXBseVRvOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgc2V0Sk1TUmVwbHlUbyhEZXN0aW5hdGlvbiBqbXNSZXBseVRvKSB7CiAg\nICAgICAgdGhpcy5qbXNSZXBseVRvID0gam1zUmVwbHlUbzsKICAgICAgICBp\nZiAobnVsbCAhPSBqbXNSZXBseVRvKXsKICAgICAgICAgICAgdGhpcy5zdGFu\nZGFyZFByb3BlcnRpZXNFeGlzdHMuYWRkKEpNU19SRVBMWV9UTyk7CiAgICAg\nICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzRm9yV2lyZS5h\nZGQoSk1TX1JFUExZX1RPKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzLnJlbW92\nZShKTVNfUkVQTFlfVE8pOwogICAgICAgICAgICB0aGlzLnN0YW5kYXJkUHJv\ncGVydGllc0V4aXN0c0ZvcldpcmUucmVtb3ZlKEpNU19SRVBMWV9UTyk7CiAg\nICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIERlc3Rp\nbmF0aW9uIGdldEpNU0Rlc3RpbmF0aW9uKCkgewogICAgICAgIHJldHVybiBq\nbXNEZXN0aW5hdGlvbjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyB2b2lkIHNldEpNU0Rlc3RpbmF0aW9uKERlc3RpbmF0aW9uIGptc0Rlc3Rp\nbmF0aW9uKSB7CiAgICAgICAgdGhpcy5qbXNEZXN0aW5hdGlvbiA9IGptc0Rl\nc3RpbmF0aW9uOwogICAgICAgIGlmIChudWxsICE9IGptc0Rlc3RpbmF0aW9u\nKXsKICAgICAgICAgICAgdGhpcy5zdGFuZGFyZFByb3BlcnRpZXNFeGlzdHMu\nYWRkKEpNU19ERVNUSU5BVElPTik7CiAgICAgICAgICAgIHRoaXMuc3RhbmRh\ncmRQcm9wZXJ0aWVzRXhpc3RzRm9yV2lyZS5hZGQoSk1TX0RFU1RJTkFUSU9O\nKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRoaXMu\nc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzLnJlbW92ZShKTVNfREVTVElOQVRJ\nT04pOwogICAgICAgICAgICB0aGlzLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0\nc0ZvcldpcmUucmVtb3ZlKEpNU19ERVNUSU5BVElPTik7CiAgICAgICAgfQog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGludCBnZXRKTVNEZWxp\ndmVyeU1vZGUoKSB7CiAgICAgICAgcmV0dXJuIGptc0RlbGl2ZXJ5TW9kZTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldEpNU0Rl\nbGl2ZXJ5TW9kZShpbnQgam1zRGVsaXZlcnlNb2RlKSB7CiAgICAgICAgdGhp\ncy5qbXNEZWxpdmVyeU1vZGUgPSBqbXNEZWxpdmVyeU1vZGU7CiAgICAgICAg\ndGhpcy5zdGFuZGFyZFByb3BlcnRpZXNFeGlzdHMuYWRkKEpNU19ERUxJVkVS\nWV9NT0RFKTsKICAgICAgICB0aGlzLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0\nc0ZvcldpcmUuYWRkKEpNU19ERUxJVkVSWV9NT0RFKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBib29sZWFuIGdldEpNU1JlZGVsaXZlcmVk\nKCkgewogICAgICAgIHJldHVybiBqbXNSZWRlbGl2ZXJlZDsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldEpNU1JlZGVsaXZlcmVk\nKGJvb2xlYW4gam1zUmVkZWxpdmVyZWQpIHsKICAgICAgICB0aGlzLmptc1Jl\nZGVsaXZlcmVkID0gam1zUmVkZWxpdmVyZWQ7CiAgICAgICAgdGhpcy5zdGFu\nZGFyZFByb3BlcnRpZXNFeGlzdHMuYWRkKEpNU19SRURFTElWRVJFRCk7CiAg\nICAgICAgLy8gdGhpcy5zdGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JXaXJl\nLmFkZChKTVNfUkVERUxJVkVSRUQpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIFN0cmluZyBnZXRKTVNUeXBlKCkgewogICAgICAgIHJldHVy\nbiBqbXNUeXBlOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgc2V0Sk1TVHlwZShTdHJpbmcgam1zVHlwZSkgewogICAgICAgIHRoaXMu\nam1zVHlwZSA9IGptc1R5cGU7CiAgICAgICAgaWYgKG51bGwgIT0gam1zVHlw\nZSl7CiAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3Rz\nLmFkZChKTVNfVFlQRSk7CiAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRQcm9w\nZXJ0aWVzRXhpc3RzRm9yV2lyZS5hZGQoSk1TX1RZUEUpOwogICAgICAgIH0K\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdGhpcy5zdGFuZGFyZFByb3Bl\ncnRpZXNFeGlzdHMucmVtb3ZlKEpNU19UWVBFKTsKICAgICAgICAgICAgdGhp\ncy5zdGFuZGFyZFByb3BlcnRpZXNFeGlzdHNGb3JXaXJlLnJlbW92ZShKTVNf\nVFlQRSk7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIGxvbmcgZ2V0Sk1TRXhwaXJhdGlvbigpIHsKICAgICAgICByZXR1cm4g\nam1zRXhwaXJhdGlvbjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyB2b2lkIHNldEpNU0V4cGlyYXRpb24obG9uZyBqbXNFeHBpcmF0aW9uKSB7\nCiAgICAgICAgLy8gV2Ugc2ltdWxhdGUgaXQgbm93ICEKICAgICAgICAvLyBp\nZiAobG9nZ2VyLmlzSW5mb0VuYWJsZWQoKSkgbG9nZ2VyLmluZm8oIkpNU0V4\ncGlyYXRpb24gaXMgbm90IHN1cHBvcnRlZCByaWdodCBub3cgYnkgSGVkd2ln\nIC4uLiIpOwogICAgICAgIHRoaXMuam1zRXhwaXJhdGlvbiA9IGptc0V4cGly\nYXRpb247CgogICAgICAgIGlmICgwICE9IGptc0V4cGlyYXRpb24pewogICAg\nICAgICAgICB0aGlzLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0cy5hZGQoSk1T\nX0VYUElSQVRJT04pOwogICAgICAgICAgICB0aGlzLnN0YW5kYXJkUHJvcGVy\ndGllc0V4aXN0c0ZvcldpcmUuYWRkKEpNU19FWFBJUkFUSU9OKTsKICAgICAg\nICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRoaXMuc3RhbmRhcmRQ\ncm9wZXJ0aWVzRXhpc3RzLnJlbW92ZShKTVNfRVhQSVJBVElPTik7CiAgICAg\nICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzRm9yV2lyZS5y\nZW1vdmUoSk1TX0VYUElSQVRJT04pOwogICAgICAgIH0KICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBpbnQgZ2V0Sk1TUHJpb3JpdHkoKSB7CiAg\nICAgICAgcmV0dXJuIGptc1ByaW9yaXR5OwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIHZvaWQgc2V0Sk1TUHJpb3JpdHkoaW50IGptc1ByaW9y\naXR5KSB7CiAgICAgICAgdGhpcy5qbXNQcmlvcml0eSA9IGptc1ByaW9yaXR5\nOwogICAgICAgIHRoaXMuc3RhbmRhcmRQcm9wZXJ0aWVzRXhpc3RzLmFkZChK\nTVNfUFJJT1JJVFkpOwogICAgICAgIC8vIFNlbnQgb3ZlciB3aXJlID8KICAg\nICAgICB0aGlzLnN0YW5kYXJkUHJvcGVydGllc0V4aXN0c0ZvcldpcmUuYWRk\nKEpNU19QUklPUklUWSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgdm9pZCBjbGVhclByb3BlcnRpZXMoKSB7CiAgICAgICAgdGhpcy5wcm9w\nZXJ0aWVzUmVhZE9ubHkgPSBmYWxzZTsKICAgICAgICBwcm9wZXJ0aWVzLmNs\nZWFyKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBKTVMgVklPTEFUSU9OID8g\nVGhlIHNwZWMgJiBqYXZhZG9jIGlzIHVuY2xlYXIgYXMgdG8gd2hldGhlciB0\naGlzIG1ldGhvZCBtdXN0IGluY2x1ZGUgam1zCiAgICAgKiBzdGFuZGFyZCBw\ncm9wZXJ0aWVzIG9yIG5vdC4KICAgICAqIEJ1dCBnb2luZyBieSBqYXZhZG9j\nIG9mCiAgICAgKiBAc2VlICNnZXRQcm9wZXJ0eU5hbWVzKCkgLCB3ZSBoYXZl\nIHRoaXMgc3BlY2lmaWVkIDoKICAgICAqICJOb3RlIHRoYXQgSk1TIHN0YW5k\nYXJkIGhlYWRlciBmaWVsZHMgYXJlIG5vdCBjb25zaWRlcmVkIHByb3BlcnRp\nZXMgYW5kIGFyZSBub3QgcmV0dXJuZWQKICAgICAqIGluIHRoaXMgZW51bWVy\nYXRpb24uIgogICAgICogV2hpY2ggaW5kaWNhdGVzIHRoaXMgbWV0aG9kIG11\nc3Qgbm90IGluY2x1ZGUgc3RhbmRhcmQgcHJvcGVydGllcy4KICAgICAqLwog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBwcm9wZXJ0eUV4aXN0\ncyhTdHJpbmcga2V5KSB7CiAgICAgICAgaWYgKCFzdGFuZGFyZFByb3BlcnRp\nZXMuY29udGFpbnMoa2V5KSkgcmV0dXJuIHByb3BlcnRpZXMuY29udGFpbnNL\nZXkoa2V5KTsKCiAgICAgICAgLy8gRXZhbHVhdGUgZGVwZW5kaW5nIG9uIHR5\ncGUgb2YgcHJvcGVydHkuCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUHJvcGVy\ndGllc0V4aXN0cy5jb250YWlucyhrZXkpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIGJvb2xlYW4gZ2V0Qm9vbGVhblByb3BlcnR5KFN0cmlu\nZyBrZXkpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGNoZWNrSWZT\ndGFuZGFyZFByb3BlcnR5KGtleSk7CiAgICAgICAgcmV0dXJuIGdldEJvb2xl\nYW5Qcm9wZXJ0eShwcm9wZXJ0aWVzLCBrZXkpOwogICAgfQoKICAgIHByaXZh\ndGUgYm9vbGVhbiBnZXRCb29sZWFuUHJvcGVydHkoTWFwPFN0cmluZywgT2Jq\nZWN0PiBwcm9wZXJ0aWVzLCBTdHJpbmcga2V5KSB0aHJvd3MgSk1TRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gTWVzc2FnZVV0aWwuYXNCb29sZWFuKHBy\nb3BlcnRpZXMuZ2V0KGtleSkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIGJ5dGUgZ2V0Qnl0ZVByb3BlcnR5KFN0cmluZyBrZXkpIHRocm93\ncyBKTVNFeGNlcHRpb24gewogICAgICAgIGNoZWNrSWZTdGFuZGFyZFByb3Bl\ncnR5KGtleSk7CiAgICAgICAgcmV0dXJuIGdldEJ5dGVQcm9wZXJ0eShwcm9w\nZXJ0aWVzLCBrZXkpOwogICAgfQoKICAgIHByaXZhdGUgYnl0ZSBnZXRCeXRl\nUHJvcGVydHkoTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzLCBTdHJp\nbmcga2V5KSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4g\nTWVzc2FnZVV0aWwuYXNCeXRlKHByb3BlcnRpZXMuZ2V0KGtleSkpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHNob3J0IGdldFNob3J0UHJv\ncGVydHkoU3RyaW5nIGtleSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAg\nICAgY2hlY2tJZlN0YW5kYXJkUHJvcGVydHkoa2V5KTsKICAgICAgICByZXR1\ncm4gZ2V0U2hvcnRQcm9wZXJ0eShwcm9wZXJ0aWVzLCBrZXkpOwogICAgfQoK\nICAgIHByaXZhdGUgc2hvcnQgZ2V0U2hvcnRQcm9wZXJ0eShNYXA8U3RyaW5n\nLCBPYmplY3Q+IHByb3BlcnRpZXMsIFN0cmluZyBrZXkpIHRocm93cyBKTVNF\neGNlcHRpb24gewogICAgICAgIHJldHVybiBNZXNzYWdlVXRpbC5hc1Nob3J0\nKHByb3BlcnRpZXMuZ2V0KGtleSkpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIGludCBnZXRJbnRQcm9wZXJ0eShTdHJpbmcga2V5KSB0aHJv\nd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBjaGVja0lmU3RhbmRhcmRQcm9w\nZXJ0eShrZXkpOwogICAgICAgIHJldHVybiBnZXRJbnRQcm9wZXJ0eShwcm9w\nZXJ0aWVzLCBrZXkpOwogICAgfQoKICAgIHByaXZhdGUgaW50IGdldEludFBy\nb3BlcnR5KE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcywgU3RyaW5n\nIGtleSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIE1l\nc3NhZ2VVdGlsLmFzSW50ZWdlcihwcm9wZXJ0aWVzLmdldChrZXkpKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBsb25nIGdldExvbmdQcm9w\nZXJ0eShTdHJpbmcga2V5KSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAg\nICBjaGVja0lmU3RhbmRhcmRQcm9wZXJ0eShrZXkpOwogICAgICAgIHJldHVy\nbiBnZXRMb25nUHJvcGVydHkocHJvcGVydGllcywga2V5KTsKICAgIH0KCiAg\nICBwcml2YXRlIGxvbmcgZ2V0TG9uZ1Byb3BlcnR5KE1hcDxTdHJpbmcsIE9i\namVjdD4gcHJvcGVydGllcywgU3RyaW5nIGtleSkgdGhyb3dzIEpNU0V4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIE1lc3NhZ2VVdGlsLmFzTG9uZyhwcm9w\nZXJ0aWVzLmdldChrZXkpKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBmbG9hdCBnZXRGbG9hdFByb3BlcnR5KFN0cmluZyBrZXkpIHRocm93\ncyBKTVNFeGNlcHRpb24gewogICAgICAgIGNoZWNrSWZTdGFuZGFyZFByb3Bl\ncnR5KGtleSk7CiAgICAgICAgcmV0dXJuIGdldEZsb2F0UHJvcGVydHkocHJv\ncGVydGllcywga2V5KTsKICAgIH0KCiAgICBwcml2YXRlIGZsb2F0IGdldEZs\nb2F0UHJvcGVydHkoTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzLCBT\ndHJpbmcga2V5KSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1\ncm4gTWVzc2FnZVV0aWwuYXNGbG9hdChwcm9wZXJ0aWVzLmdldChrZXkpKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBkb3VibGUgZ2V0RG91\nYmxlUHJvcGVydHkoU3RyaW5nIGtleSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgY2hlY2tJZlN0YW5kYXJkUHJvcGVydHkoa2V5KTsKICAgICAg\nICByZXR1cm4gZ2V0RG91YmxlUHJvcGVydHkocHJvcGVydGllcywga2V5KTsK\nICAgIH0KCiAgICBwcml2YXRlIGRvdWJsZSBnZXREb3VibGVQcm9wZXJ0eShN\nYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXMsIFN0cmluZyBrZXkpIHRo\ncm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHJldHVybiBNZXNzYWdlVXRp\nbC5hc0RvdWJsZShwcm9wZXJ0aWVzLmdldChrZXkpKTsKICAgIH0KCiAgICBw\ndWJsaWMgT2JqZWN0IGdldFNlbGVjdG9yUHJvY2Vzc2luZ1Byb3BlcnR5VmFs\ndWUoU3RyaW5nIGtleSkgdGhyb3dzIFNlbGVjdG9yRXZhbHVhdGlvbkV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKHByb3BlcnRpZXMuY29udGFpbnNLZXkoa2V5\nKSkgcmV0dXJuIHByb3BlcnRpZXMuZ2V0KGtleSk7CiAgICAgICAgaWYgKCEg\nc3RhbmRhcmRQcm9wZXJ0aWVzLmNvbnRhaW5zKGtleSkpIHJldHVybiBudWxs\nOwoKICAgICAgICBpZiAoSk1TX01FU1NBR0VfSUQuZXF1YWxzKGtleSkpIHJl\ndHVybiBnZXRKTVNNZXNzYWdlSUQoKTsKICAgICAgICBpZiAoSk1TX1RJTUVT\nVEFNUC5lcXVhbHMoa2V5KSkgcmV0dXJuIGdldEpNU1RpbWVzdGFtcCgpOwog\nICAgICAgIGlmIChKTVNfQ09SUkVMQVRJT05fSUQuZXF1YWxzKGtleSkpIHJl\ndHVybiBnZXRKTVNDb3JyZWxhdGlvbklEKCk7CiAgICAgICAgLy8gV2UgZG8g\nbm90IHN1cHBvcnQgdGhpcyByaWdodCBub3cuCiAgICAgICAgLy8gaWYgKEpN\nU19DT1JSRUxBVElPTl9JRF9BU19CWVRFUy5lcXVhbHMoa2V5KSkgcmV0dXJu\nIGdldEpNU0NvcnJlbGF0aW9uSURBc0J5dGVzKCk7CiAgICAgICAgaWYgKEpN\nU19SRVBMWV9UTy5lcXVhbHMoa2V5KSkgcmV0dXJuIGdldEpNU1JlcGx5VG8o\nKTsKICAgICAgICBpZiAoSk1TX0RFU1RJTkFUSU9OLmVxdWFscyhrZXkpKSBy\nZXR1cm4gZ2V0Sk1TRGVzdGluYXRpb24oKTsKICAgICAgICBpZiAoSk1TX0RF\nTElWRVJZX01PREUuZXF1YWxzKGtleSkpIHsKICAgICAgICAgICAgLy8gMy44\nLjEuMyBTcGVjaWFsIE5vdGVzICJXaGVuIHVzZWQgaW4gYSBtZXNzYWdlIHNl\nbGVjdG9yIEpNU0RlbGl2ZXJ5TW9kZSBpcyB0cmVhdGVkIGFzIGhhdmluZyB0\naGUKICAgICAgICAgICAgLy8gdmFsdWVzIOKAmFBFUlNJU1RFTlTigJkgYW5k\nIOKAmE5PTl9QRVJTSVNURU5U4oCZLiIKICAgICAgICAgICAgZmluYWwgaW50\nIGRlbGl2ZXJ5TW9kZSA9IGdldEpNU0RlbGl2ZXJ5TW9kZSgpOwogICAgICAg\nICAgICBpZiAoRGVsaXZlcnlNb2RlLlBFUlNJU1RFTlQgPT0gZGVsaXZlcnlN\nb2RlKSByZXR1cm4gIlBFUlNJU1RFTlQiOwogICAgICAgICAgICBpZiAoRGVs\naXZlcnlNb2RlLk5PTl9QRVJTSVNURU5UID09IGRlbGl2ZXJ5TW9kZSkgcmV0\ndXJuICJOT05fUEVSU0lTVEVOVCI7CiAgICAgICAgICAgIC8vIHVua25vd24g\nIQogICAgICAgICAgICBpZiAobG9nZ2VyLmlzSW5mb0VuYWJsZWQoKSkgbG9n\nZ2VyLmluZm8oIlVua25vd24gZGVsaXZlcnkgbW9kZSBzcGVjaWZpZWQgLi4u\nICIgKyBkZWxpdmVyeU1vZGUpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICB9CiAgICAgICAgaWYgKEpNU19SRURFTElWRVJFRC5lcXVhbHMo\na2V5KSkgcmV0dXJuIGdldEpNU1JlZGVsaXZlcmVkKCk7CiAgICAgICAgaWYg\nKEpNU19UWVBFLmVxdWFscyhrZXkpKSByZXR1cm4gZ2V0Sk1TVHlwZSgpOwog\nICAgICAgIGlmIChKTVNfRVhQSVJBVElPTi5lcXVhbHMoa2V5KSkgcmV0dXJu\nIGdldEpNU0V4cGlyYXRpb24oKTsKICAgICAgICBpZiAoSk1TX1BSSU9SSVRZ\nLmVxdWFscyhrZXkpKSByZXR1cm4gZ2V0Sk1TUHJpb3JpdHkoKTsKCiAgICAg\nICAgdGhyb3cgbmV3IFNlbGVjdG9yRXZhbHVhdGlvbkV4Y2VwdGlvbigiVW5h\nYmxlIHRvIHJldHJpZXZlIHZhbHVlIGZvciBrZXkgOiAnIiArIGtleSArICIn\nIik7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFN0cmluZ1Byb3BlcnR5KFN0cmluZyBrZXkpIHRocm93cyBKTVNFeGNlcHRp\nb24gewogICAgICAgIGNoZWNrSWZTdGFuZGFyZFByb3BlcnR5KGtleSk7CiAg\nICAgICAgcmV0dXJuIGdldFN0cmluZ1Byb3BlcnR5KHByb3BlcnRpZXMsIGtl\neSk7CiAgICB9CgogICAgcHJpdmF0ZSBTdHJpbmcgZ2V0U3RyaW5nUHJvcGVy\ndHkoTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzLCBTdHJpbmcga2V5\nKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gTWVzc2Fn\nZVV0aWwuYXNTdHJpbmcocHJvcGVydGllcy5nZXQoa2V5KSk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgT2JqZWN0IGdldE9iamVjdFByb3Bl\ncnR5KFN0cmluZyBrZXkpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAg\nIGNoZWNrSWZTdGFuZGFyZFByb3BlcnR5KGtleSk7CiAgICAgICAgLy8gaWYg\nKCFwcm9wZXJ0eUV4aXN0cyhrZXkpKSByZXR1cm4gbnVsbDsKCiAgICAgICAg\ncmV0dXJuIHByb3BlcnRpZXMuZ2V0KGtleSk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgRW51bWVyYXRpb248U3RyaW5nPiBnZXRQcm9wZXJ0\neU5hbWVzKCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIENvbGxlY3Rpb25zLmVudW1lcmF0aW9uKHByb3BlcnRpZXMua2V5U2V0KCkp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0Qm9v\nbGVhblByb3BlcnR5KFN0cmluZyBrZXksIGJvb2xlYW4gdmFsdWUpIHRocm93\ncyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmICghTWVzc2FnZVV0aWwuaXNW\nYWxpZEtleShrZXkpKSB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0\naW9uKCJJbnZhbGlkIGtleSAiICsga2V5KTsKICAgICAgICBpZiAocHJvcGVy\ndGllc1JlYWRPbmx5KQogICAgICAgICAgdGhyb3cgbmV3IE1lc3NhZ2VOb3RX\ncml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlLiBhdHRl\nbXB0IHRvIHNldCBwcm9wZXJ0eSAiICsKICAgICAgICAgICAgICBrZXkgKyAi\nID0gIiArIHZhbHVlKTsKICAgICAgICBjaGVja0lmU3RhbmRhcmRQcm9wZXJ0\neShrZXkpOwogICAgICAgIHByb3BlcnRpZXMucHV0KGtleSwgdmFsdWUpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0Qnl0ZVBy\nb3BlcnR5KFN0cmluZyBrZXksIGJ5dGUgdmFsdWUpIHRocm93cyBKTVNFeGNl\ncHRpb24gewogICAgICAgIGlmICghTWVzc2FnZVV0aWwuaXNWYWxpZEtleShr\nZXkpKSB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZh\nbGlkIGtleSAiICsga2V5KTsKICAgICAgICBpZiAocHJvcGVydGllc1JlYWRP\nbmx5KQogICAgICAgICAgdGhyb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVF\neGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlLiBhdHRlbXB0IHRvIHNl\ndCBwcm9wZXJ0eSAiICsKICAgICAgICAgICAgICBrZXkgKyAiID0gIiArIHZh\nbHVlKTsKICAgICAgICBjaGVja0lmU3RhbmRhcmRQcm9wZXJ0eShrZXkpOwog\nICAgICAgIHByb3BlcnRpZXMucHV0KGtleSwgdmFsdWUpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0U2hvcnRQcm9wZXJ0eShT\ndHJpbmcga2V5LCBzaG9ydCB2YWx1ZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKCFNZXNzYWdlVXRpbC5pc1ZhbGlkS2V5KGtleSkpIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIkludmFsaWQga2V5\nICIgKyBrZXkpOwogICAgICAgIGlmIChwcm9wZXJ0aWVzUmVhZE9ubHkpCiAg\nICAgICAgICB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlv\nbigiTWVzc2FnZSBub3Qgd3JpdGFibGUuIGF0dGVtcHQgdG8gc2V0IHByb3Bl\ncnR5ICIgKwogICAgICAgICAgICAgIGtleSArICIgPSAiICsgdmFsdWUpOwog\nICAgICAgIGNoZWNrSWZTdGFuZGFyZFByb3BlcnR5KGtleSk7CiAgICAgICAg\ncHJvcGVydGllcy5wdXQoa2V5LCB2YWx1ZSk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCBzZXRJbnRQcm9wZXJ0eShTdHJpbmcga2V5\nLCBpbnQgdmFsdWUpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlm\nICghTWVzc2FnZVV0aWwuaXNWYWxpZEtleShrZXkpKSB0aHJvdyBuZXcgSWxs\nZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJJbnZhbGlkIGtleSAiICsga2V5KTsK\nICAgICAgICBpZiAocHJvcGVydGllc1JlYWRPbmx5KQogICAgICAgICAgdGhy\nb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ug\nbm90IHdyaXRhYmxlLiBhdHRlbXB0IHRvIHNldCBwcm9wZXJ0eSAiICsKICAg\nICAgICAgICAgICBrZXkgKyAiID0gIiArIHZhbHVlKTsKICAgICAgICBjaGVj\na0lmU3RhbmRhcmRQcm9wZXJ0eShrZXkpOwogICAgICAgIHByb3BlcnRpZXMu\ncHV0KGtleSwgdmFsdWUpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIHZvaWQgc2V0TG9uZ1Byb3BlcnR5KFN0cmluZyBrZXksIGxvbmcgdmFs\ndWUpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmICghTWVzc2Fn\nZVV0aWwuaXNWYWxpZEtleShrZXkpKSB0aHJvdyBuZXcgSWxsZWdhbEFyZ3Vt\nZW50RXhjZXB0aW9uKCJJbnZhbGlkIGtleSAiICsga2V5KTsKICAgICAgICBp\nZiAocHJvcGVydGllc1JlYWRPbmx5KQogICAgICAgICAgdGhyb3cgbmV3IE1l\nc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRh\nYmxlLiBhdHRlbXB0IHRvIHNldCBwcm9wZXJ0eSAiICsKICAgICAgICAgICAg\nICBrZXkgKyAiID0gIiArIHZhbHVlKTsKICAgICAgICBjaGVja0lmU3RhbmRh\ncmRQcm9wZXJ0eShrZXkpOwogICAgICAgIHByb3BlcnRpZXMucHV0KGtleSwg\ndmFsdWUpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQg\nc2V0RmxvYXRQcm9wZXJ0eShTdHJpbmcga2V5LCBmbG9hdCB2YWx1ZSkgdGhy\nb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFNZXNzYWdlVXRpbC5p\nc1ZhbGlkS2V5KGtleSkpIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNl\ncHRpb24oIkludmFsaWQga2V5ICIgKyBrZXkpOwogICAgICAgIGlmIChwcm9w\nZXJ0aWVzUmVhZE9ubHkpCiAgICAgICAgICB0aHJvdyBuZXcgTWVzc2FnZU5v\ndFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUuIGF0\ndGVtcHQgdG8gc2V0IHByb3BlcnR5ICIgKwogICAgICAgICAgICAgIGtleSAr\nICIgPSAiICsgdmFsdWUpOwogICAgICAgIGNoZWNrSWZTdGFuZGFyZFByb3Bl\ncnR5KGtleSk7CiAgICAgICAgcHJvcGVydGllcy5wdXQoa2V5LCB2YWx1ZSk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXREb3Vi\nbGVQcm9wZXJ0eShTdHJpbmcga2V5LCBkb3VibGUgdmFsdWUpIHRocm93cyBK\nTVNFeGNlcHRpb24gewogICAgICAgIGlmICghTWVzc2FnZVV0aWwuaXNWYWxp\nZEtleShrZXkpKSB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9u\nKCJJbnZhbGlkIGtleSAiICsga2V5KTsKICAgICAgICBpZiAocHJvcGVydGll\nc1JlYWRPbmx5KQogICAgICAgICAgdGhyb3cgbmV3IE1lc3NhZ2VOb3RXcml0\nZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlLiBhdHRlbXB0\nIHRvIHNldCBwcm9wZXJ0eSAiICsKICAgICAgICAgICAgICBrZXkgKyAiID0g\nIiArIHZhbHVlKTsKICAgICAgICBjaGVja0lmU3RhbmRhcmRQcm9wZXJ0eShr\nZXkpOwogICAgICAgIHByb3BlcnRpZXMucHV0KGtleSwgdmFsdWUpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0U3RyaW5nUHJv\ncGVydHkoU3RyaW5nIGtleSwgU3RyaW5nIHZhbHVlKSB0aHJvd3MgSk1TRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoIU1lc3NhZ2VVdGlsLmlzVmFsaWRLZXko\na2V5KSkgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSW52\nYWxpZCBrZXkgIiArIGtleSk7CiAgICAgICAgaWYgKHByb3BlcnRpZXNSZWFk\nT25seSkKICAgICAgICAgIHRocm93IG5ldyBNZXNzYWdlTm90V3JpdGVhYmxl\nRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZS4gYXR0ZW1wdCB0byBz\nZXQgcHJvcGVydHkgIiArCiAgICAgICAgICAgICAga2V5ICsgIiA9ICIgKyB2\nYWx1ZSk7CiAgICAgICAgY2hlY2tJZlN0YW5kYXJkUHJvcGVydHkoa2V5KTsK\nICAgICAgICBwcm9wZXJ0aWVzLnB1dChrZXksIHZhbHVlKTsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHNldE9iamVjdFByb3BlcnR5\nKFN0cmluZyBrZXksIE9iamVjdCB2YWx1ZSkgdGhyb3dzIEpNU0V4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKCFNZXNzYWdlVXRpbC5pc1ZhbGlkS2V5KGtleSkp\nIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oIkludmFsaWQg\na2V5ICIgKyBrZXkpOwogICAgICAgIGlmIChwcm9wZXJ0aWVzUmVhZE9ubHkp\nCiAgICAgICAgICB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2Vw\ndGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUuIGF0dGVtcHQgdG8gc2V0IHBy\nb3BlcnR5ICIgKwogICAgICAgICAgICAgIGtleSArICIgPSAiICsgdmFsdWUp\nOwogICAgICAgIGNoZWNrSWZTdGFuZGFyZFByb3BlcnR5KGtleSk7CgogICAg\nICAgIGlmIChudWxsID09IHZhbHVlIHx8CiAgICAgICAgICAgICAgICB2YWx1\nZSBpbnN0YW5jZW9mIEJvb2xlYW4gfHwKICAgICAgICAgICAgICAgIHZhbHVl\nIGluc3RhbmNlb2YgQnl0ZSB8fAogICAgICAgICAgICAgICAgdmFsdWUgaW5z\ndGFuY2VvZiBTaG9ydCB8fAogICAgICAgICAgICAgICAgdmFsdWUgaW5zdGFu\nY2VvZiBJbnRlZ2VyIHx8CiAgICAgICAgICAgICAgICB2YWx1ZSBpbnN0YW5j\nZW9mIExvbmcgfHwKICAgICAgICAgICAgICAgIHZhbHVlIGluc3RhbmNlb2Yg\nRmxvYXQgfHwKICAgICAgICAgICAgICAgIHZhbHVlIGluc3RhbmNlb2YgRG91\nYmxlIHx8CiAgICAgICAgICAgICAgICB2YWx1ZSBpbnN0YW5jZW9mIGJ5dGVb\nXSB8fAogICAgICAgICAgICAgICAgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcp\nIHsKICAgICAgICAgICAgcHJvcGVydGllcy5wdXQoa2V5LCB2YWx1ZSk7CiAg\nICAgICAgICAgIHJldHVybiA7ICAgICAgICB9CgogICAgICAgIHRocm93IG5l\ndyBNZXNzYWdlRm9ybWF0RXhjZXB0aW9uKCJVbnN1cHBvcnRlZCB0eXBlIGZv\nciB2YWx1ZSAiICsgdmFsdWUuZ2V0Q2xhc3MoKSk7CiAgICB9CgogICAgLy8g\nSk1TIFZJT0xBVElPTiA/CiAgICAvLyBJIGFtIG5vdCBzdXJlIGlmIGdldHRp\nbmcgYW5kIHNldHRpbmcgc3RhbmRhcmQgcHJvcGVydGllcyBpcyBhbGxvd2Vk\nIHZpYSB0aGUgZ2VuZXJpYwogICAgLy8gZ2V0L3NldCBtZXRob2RzIDogdGhl\nIHNwZWMgc2VlbXMgdW5jbGVhciBvbiBpdC4KICAgIC8vIFNvbWUgamF2YWRv\nY3Mgc2VlbSB0byBpbmRpY2F0ZSBpdCBpcyBOT1QgYWxsb3dlZC4gSGVuY2Ug\ndGhpcyBjaGVjayAuLi4KICAgIC8vIElmIGl0IGlzIGFsbG93ZWQgaW4gSk1T\nIC0gdG8gc3VwcG9ydCBpdCwgd2Ugd2lsbCBuZWVkIHRvIGhhdmUgYSBpZi9l\nbHNlIGJsb2NrIHdpdGhpbiBlYWNoIHNldC9nZXQKICAgIC8vIHdoaWNoIGRl\nbGVnYXRlcyB0byBjb3JyZXNwb25kaW5nIGptcyBoZWFkZXIgc2V0L2dldCAu\nLi4KICAgIHByaXZhdGUgdm9pZCBjaGVja0lmU3RhbmRhcmRQcm9wZXJ0eShT\ndHJpbmcga2V5KSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nc3RhbmRhcmRQcm9wZXJ0aWVzLmNvbnRhaW5zKGtleSkpCiAgICAgICAgICB0\naHJvdyBuZXcgSk1TRXhjZXB0aW9uKCJDYW5ub3QgZ2V0L3NldCBzdGFuZGFy\nZCBKTVMgcHJvcGVydGllcyB1c2luZyAqUHJvcGVydHkgYXBpIik7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBhY2tub3dsZWRnZSgp\nIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHNlc3Npb24uYWNrbm93\nbGVkZ2UodGhpcyk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCBjbGVhckJvZHkoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAg\nICAvLyBDbGVhciB0aGUgYm9keSBvZiB0aGUgbWVzc2FnZS4KICAgIH0KCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFNvdXJjZU5hbWUoKSB7CiAgICAgICAgcmV0\ndXJuIHNvdXJjZU5hbWU7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRT\ndWJzY3JpYmVySWQoKSB7CiAgICAgICAgcmV0dXJuIHN1YnNjcmliZXJJZDsK\nICAgIH0KCiAgICBNZXNzYWdlSW1wbCBjcmVhdGVDbG9uZShTZXNzaW9uSW1w\nbCBzZXNzaW9uLCBTdHJpbmcgc291cmNlVG9waWNOYW1lLCBTdHJpbmcgc3Vi\nc2NyaWJlcklkKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nTWVzc2FnZUltcGwuY2xhc3MgIT0gZ2V0Q2xhc3MoKSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSk1TRXhjZXB0aW9uKCJVbmV4cGVjdGVkIHRvIGNhbGwg\nTWVzc2FnZUltcGwncyBjcmVhdGVDbG9uZSBmcm9tIHN1YmNsYXNzICIgKyBn\nZXRDbGFzcygpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBNZXNz\nYWdlSW1wbChzZXNzaW9uLCB0aGlzLCBzb3VyY2VUb3BpY05hbWUsIHN1YnNj\ncmliZXJJZCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3Ry\naW5nIHRvU3RyaW5nKCkgewogICAgICAgIGZpbmFsIFN0cmluZ0J1aWxkZXIg\nc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNiLmFwcGVuZCgi\nTWVzc2FnZUltcGwiKTsKICAgICAgICBzYi5hcHBlbmQoIntzZXNzaW9uPSIp\nLmFwcGVuZChzZXNzaW9uKTsKICAgICAgICBzYi5hcHBlbmQoIiwgam1zTWVz\nc2FnZUlkPSciKS5hcHBlbmQoam1zTWVzc2FnZUlkKS5hcHBlbmQoJ1wnJyk7\nCiAgICAgICAgc2IuYXBwZW5kKCIsIGptc1RpbWVzdGFtcD0iKS5hcHBlbmQo\nam1zVGltZXN0YW1wKTsKICAgICAgICBzYi5hcHBlbmQoIiwgam1zQ29ycmVs\nYXRpb25JRD0nIikuYXBwZW5kKGptc0NvcnJlbGF0aW9uSUQpLmFwcGVuZCgn\nXCcnKTsKICAgICAgICBzYi5hcHBlbmQoIiwgam1zUmVwbHlUbz0iKS5hcHBl\nbmQoam1zUmVwbHlUbyk7CiAgICAgICAgc2IuYXBwZW5kKCIsIGptc0Rlc3Rp\nbmF0aW9uPSIpLmFwcGVuZChqbXNEZXN0aW5hdGlvbik7CiAgICAgICAgc2Iu\nYXBwZW5kKCIsIGptc0RlbGl2ZXJ5TW9kZT0iKS5hcHBlbmQoam1zRGVsaXZl\ncnlNb2RlKTsKICAgICAgICBzYi5hcHBlbmQoIiwgam1zUmVkZWxpdmVyZWQ9\nIikuYXBwZW5kKGptc1JlZGVsaXZlcmVkKTsKICAgICAgICBzYi5hcHBlbmQo\nIiwgam1zVHlwZT0nIikuYXBwZW5kKGptc1R5cGUpLmFwcGVuZCgnXCcnKTsK\nICAgICAgICBzYi5hcHBlbmQoIiwgam1zRXhwaXJhdGlvbj0iKS5hcHBlbmQo\nam1zRXhwaXJhdGlvbik7CiAgICAgICAgc2IuYXBwZW5kKCIsIGptc1ByaW9y\naXR5PSIpLmFwcGVuZChqbXNQcmlvcml0eSk7CiAgICAgICAgc2IuYXBwZW5k\nKCIsIHByb3BlcnRpZXM9IikuYXBwZW5kKHByb3BlcnRpZXMpOwogICAgICAg\nIHNiLmFwcGVuZCgiLCBzdGFuZGFyZFByb3BlcnRpZXNFeGlzdHM9IikuYXBw\nZW5kKHN0YW5kYXJkUHJvcGVydGllc0V4aXN0cyk7CiAgICAgICAgc2IuYXBw\nZW5kKCIsIHN0YW5kYXJkUHJvcGVydGllc0V4aXN0c0ZvcldpcmU9IikuYXBw\nZW5kKHN0YW5kYXJkUHJvcGVydGllc0V4aXN0c0ZvcldpcmUpOwogICAgICAg\nIHNiLmFwcGVuZCgiLCBzb3VyY2VOYW1lPSciKS5hcHBlbmQoc291cmNlTmFt\nZSkuYXBwZW5kKCdcJycpOwogICAgICAgIHNiLmFwcGVuZCgiLCBzdWJzY3Jp\nYmVySWQ9JyIpLmFwcGVuZChzdWJzY3JpYmVySWQpLmFwcGVuZCgnXCcnKTsK\nICAgICAgICBzYi5hcHBlbmQoJ30nKTsKICAgICAgICByZXR1cm4gc2IudG9T\ndHJpbmcoKTsKICAgIH0KCiAgICB2b2lkIHJlc2V0KCkgdGhyb3dzIEpNU0V4\nY2VwdGlvbiB7CiAgICAgICAgLy8gbm9vcCAuLi4gY2hpbGRyZW4gd2lsbCBv\ndmVycmlkZSB0byBkbyBuZWVkZnVsLgogICAgfQoKICAgIHB1YmxpYyBSdW5u\nYWJsZSBnZXRBY2tSdW5uYWJsZSgpIHsKICAgICAgICByZXR1cm4gYWNrUnVu\nbmFibGU7CiAgICB9Cn0K\n","encoding":"base64"}

