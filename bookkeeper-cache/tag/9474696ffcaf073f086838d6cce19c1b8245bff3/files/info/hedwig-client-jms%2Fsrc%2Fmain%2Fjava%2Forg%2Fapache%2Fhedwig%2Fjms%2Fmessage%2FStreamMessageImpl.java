{"sha":"2aa74a2e690aabe2300d5a9e34d85b06d1bb0e71","node_id":"MDQ6QmxvYjE1NzU5NTY6MmFhNzRhMmU2OTBhYWJlMjMwMGQ1YTllMzRkODViMDZkMWJiMGU3MQ==","size":26036,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2aa74a2e690aabe2300d5a9e34d85b06d1bb0e71","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMubWVzc2FnZTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5qbXMuTXV0YWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmptcy5TZXNzaW9uSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvY29sLlB1YlN1YlByb3RvY29sOwoKaW1wb3J0IGphdmF4Lmptcy5J\nbGxlZ2FsU3RhdGVFeGNlcHRpb247CmltcG9ydCBqYXZheC5qbXMuSk1TRXhj\nZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2U7CmltcG9ydCBqYXZh\neC5qbXMuTWVzc2FnZUVPRkV4Y2VwdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5N\nZXNzYWdlTm90UmVhZGFibGVFeGNlcHRpb247CmltcG9ydCBqYXZheC5qbXMu\nTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbjsKaW1wb3J0IGphdmF4Lmpt\ncy5TdHJlYW1NZXNzYWdlOwppbXBvcnQgamF2YS5pby5CeXRlQXJyYXlJbnB1\ndFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFt\nOwppbXBvcnQgamF2YS5pby5FT0ZFeGNlcHRpb247CmltcG9ydCBqYXZhLmlv\nLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5PYmplY3RJbnB1dFN0cmVh\nbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0U3RyZWFtOwppbXBvcnQg\namF2YS51dGlsLkFycmF5RGVxdWU7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlz\nOwppbXBvcnQgamF2YS51dGlsLkRlcXVlOwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKCi8qKgogKiBUaG91Z2ggc2ltaWxhciB0byBCeXRlc01lc3NhZ2VJbXBs\nLCB0aGUgZGlmZmVyZW5jZSBpcyB0aGF0IEJ5dGVzTWVzc2FnZSBleHBlY3Rz\nIHRoZSB1c2VyIHRvIGtub3cKICogdGhlIHNjaGVtYSB3aGlsZQogKiBTdHJl\nYW1NZXNzYWdlIHVzZXIgZXhwZWN0cyB0eXBlIGNvbnZlcnNpb24sIGV0Yy4K\nICoKICogSW4gb3VyIGNhc2UsIHRoZSBzdHJlYW0gaXMgbm90IGEgdHJ1ZSBv\ncGVuIHN0cmVhbSB0byB0aGUgc2VydmVyOyBpdCBpcyBidWZmZXJlZCBpbiBt\nZW1vcnkuCiAqLwpwdWJsaWMgY2xhc3MgU3RyZWFtTWVzc2FnZUltcGwgZXh0\nZW5kcyBNZXNzYWdlSW1wbCBpbXBsZW1lbnRzIFN0cmVhbU1lc3NhZ2Ugewog\nICAgcHJpdmF0ZSBSZWFkT25seU1lc3NhZ2UgcmVhZE9ubHlNZXNzYWdlOwog\nICAgcHJpdmF0ZSBXcml0ZU9ubHlNZXNzYWdlIHdyaXRlT25seU1lc3NhZ2U7\nCiAgICBwcml2YXRlIGJvb2xlYW4gcmVhZE1vZGU7CgogICAgcHVibGljIFN0\ncmVhbU1lc3NhZ2VJbXBsKFNlc3Npb25JbXBsIHNlc3Npb24pIHRocm93cyBK\nTVNFeGNlcHRpb24gewogICAgICAgIHN1cGVyKHNlc3Npb24pOwogICAgICAg\nIGNsZWFyQm9keSgpOwogICAgfQoKICAgIC8vIFRvIGNsb25lIGEgbWVzc2Fn\nZQogICAgcHVibGljIFN0cmVhbU1lc3NhZ2VJbXBsKFNlc3Npb25JbXBsIHNl\nc3Npb24sIFN0cmVhbU1lc3NhZ2VJbXBsIG1lc3NhZ2UsIFN0cmluZyBzb3Vy\nY2VUb3BpY05hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Ry\naW5nIHN1YnNjcmliZXJJZCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAg\nICAgc3VwZXIoc2Vzc2lvbiwgKE1lc3NhZ2VJbXBsKSBtZXNzYWdlLCBzb3Vy\nY2VUb3BpY05hbWUsIHN1YnNjcmliZXJJZCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgaWYgKG1lc3NhZ2UucmVhZE1vZGUpewogICAgICAgICAgICAg\nICAgdGhpcy5yZWFkT25seU1lc3NhZ2UgPSBuZXcgUmVhZE9ubHlNZXNzYWdl\nKG1lc3NhZ2UuZ2V0UGF5bG9hZERhdGEoKSk7CiAgICAgICAgICAgICAgICB0\naGlzLndyaXRlT25seU1lc3NhZ2UgPSBudWxsOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5yZWFkT25s\neU1lc3NhZ2UgPSBudWxsOwogICAgICAgICAgICAgICAgdGhpcy53cml0ZU9u\nbHlNZXNzYWdlID0gbmV3IFdyaXRlT25seU1lc3NhZ2UobWVzc2FnZS5nZXRQ\nYXlsb2FkRGF0YSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2gg\nKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgSk1TRXhjZXB0aW9uIGV4\nID0gbmV3IEpNU0V4Y2VwdGlvbigiVW5hYmxlIHRvIGNsb25lL2NvcHkgaW5w\ndXQgbWVzc2FnZSAiICsgbWVzc2FnZSArICIgLi4gIiArIGUpOwogICAgICAg\nICAgICBleC5zZXRMaW5rZWRFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIHRo\ncm93IGV4OwogICAgICAgIH0KCiAgICAgICAgdGhpcy5yZWFkTW9kZSA9IG1l\nc3NhZ2UucmVhZE1vZGU7CiAgICB9CgogICAgLy8gVG8gY2xvbmUgYSBtZXNz\nYWdlIGZyb20gYSBTdHJlYW1NZXNzYWdlIHdoaWNoIGlzIE5PVCBTdHJlYW1N\nZXNzYWdlSW1wbAogICAgLy8gQ2hhbmdpbmcgb3JkZXIgb2YgcGFyYW1ldGVy\nIHRvIE5PVCBhY2NpZGVudGFsbHkgY2xhc2ggd2l0aCB0aGUgY29uc3RydWN0\nb3IgYWJvdmUuCiAgICAvLyBUaGlzIGlzIG1pZGx5IGNvbmZ1c2luZywgYnV0\nIGhlbHBzIGEgbG90IGluIHByZXZlbnRpbmcgYWNjaWRlbnRhbCBidWdzICEK\nICAgIHB1YmxpYyBTdHJlYW1NZXNzYWdlSW1wbChTdHJlYW1NZXNzYWdlIG1l\nc3NhZ2UsIFNlc3Npb25JbXBsIHNlc3Npb24pIHRocm93cyBKTVNFeGNlcHRp\nb24gewogICAgICAgIHN1cGVyKChNZXNzYWdlKSBtZXNzYWdlLCBzZXNzaW9u\nKTsKCiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBTdHJlYW1NZXNz\nYWdlSW1wbCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSk1TRXhjZXB0aW9u\nKCJDb2RpbmcgYnVnIC0gc2hvdWxkIHVzZSB0aGlzIGNvbnN0cnVjdG9yIE9O\nTFkgZm9yIG5vbiBTdHJlYW1NZXNzYWdlSW1wbCBtZXNzYWdlcyIpOwogICAg\nICAgIH0KCiAgICAgICAgZmluYWwgYnl0ZVtdIGRhdGE7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgV3JpdGVPbmx5TWVzc2FnZSB3b20gPSBuZXcgV3Jp\ndGVPbmx5TWVzc2FnZSgpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgT2JqZWN0IG9iajsKICAgICAgICAgICAgICAgIHdoaWxlIChudWxs\nICE9IChvYmogPSBtZXNzYWdlLnJlYWRPYmplY3QoKSkpewogICAgICAgICAg\nICAgICAgICAgIHdvbS53cml0ZU9iamVjdChvYmopOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9IGNhdGNoIChFT0ZFeGNlcHRpb24gZW9mKXsK\nICAgICAgICAgICAgICAgIC8vIGlnbm9yZSAuLi4KICAgICAgICAgICAgfQog\nICAgICAgICAgICBkYXRhID0gd29tLmdldFBheWxvYWRBc0J5dGVzKG51bGwp\nOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgSk1TRXhjZXB0aW9uIGpFeCA9IG5ldyBKTVNFeGNlcHRpb24oIlVuYWJs\nZSB0byB3cml0ZSB0byBpbnRlcm5hbCBtZXNzYWdlIC4uICIgKyBlKTsKICAg\nICAgICAgICAgakV4LnNldExpbmtlZEV4Y2VwdGlvbihlKTsKICAgICAgICAg\nICAgdGhyb3cgakV4OwogICAgICAgIH0KCiAgICAgICAgdGhpcy53cml0ZU9u\nbHlNZXNzYWdlID0gbmV3IFdyaXRlT25seU1lc3NhZ2UoZGF0YSk7CgogICAg\nICAgIHRoaXMucmVhZE9ubHlNZXNzYWdlICA9IG51bGw7CiAgICAgICAgdGhp\ncy5yZWFkTW9kZSA9IGZhbHNlOwogICAgfQoKICAgIFN0cmVhbU1lc3NhZ2VJ\nbXBsKFNlc3Npb25JbXBsIHNlc3Npb24sIFB1YlN1YlByb3RvY29sLk1lc3Nh\nZ2UgbWVzc2FnZSwgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzLAog\nICAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHNvdXJjZVRvcGljTmFtZSwg\nU3RyaW5nIHN1YnNjcmliZXJJZCwgUnVubmFibGUgYWNrUnVubmFibGUpIHRo\ncm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHN1cGVyKHNlc3Npb24sIG1l\nc3NhZ2UsIHByb3BlcnRpZXMsIHNvdXJjZVRvcGljTmFtZSwgc3Vic2NyaWJl\ncklkLCBhY2tSdW5uYWJsZSk7CgogICAgICAgIGZpbmFsIGJ5dGVbXSBkYXRh\nID0gbWVzc2FnZS5nZXRCb2R5KCkudG9CeXRlQXJyYXkoKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICB0aGlzLnJlYWRPbmx5TWVzc2FnZSA9IG5ldyBS\nZWFkT25seU1lc3NhZ2UoZGF0YSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBKTVNFeGNlcHRpb24gZXggPSBuZXcg\nSk1TRXhjZXB0aW9uKCJVbmFibGUgdG8gY2xvbmUvY29weSBpbnB1dCBtZXNz\nYWdlICIgKyBtZXNzYWdlICsgIiAuLiAiICsgZSk7CiAgICAgICAgICAgIGV4\nLnNldExpbmtlZEV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgdGhyb3cgZXg7\nCiAgICAgICAgfQoKICAgICAgICB0aGlzLndyaXRlT25seU1lc3NhZ2UgPSBu\ndWxsOwogICAgICAgIHRoaXMucmVhZE1vZGUgPSB0cnVlOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIE1lc3NhZ2VVdGlsLlN1cHBvcnRl\nZE1lc3NhZ2VUeXBlcyBnZXRKbXNNZXNzYWdlVHlwZSgpIHsKICAgICAgICBy\nZXR1cm4gTWVzc2FnZVV0aWwuU3VwcG9ydGVkTWVzc2FnZVR5cGVzLlNUUkVB\nTTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0JvZHlFbXB0eSgp\newogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyBQdWJTdWJQcm90b2NvbC5NZXNzYWdlIGdlbmVyYXRlSGVk\nd2lnTWVzc2FnZSgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIFB1\nYlN1YlByb3RvY29sLk1lc3NhZ2UuQnVpbGRlciBidWlsZGVyID0gUHViU3Vi\nUHJvdG9jb2wuTWVzc2FnZS5uZXdCdWlsZGVyKCk7CiAgICAgICAgc3VwZXIu\ncG9wdWxhdGVCdWlsZGVyV2l0aEhlYWRlcnMoYnVpbGRlcik7CgogICAgICAg\nIC8vIE5vdyBzZXQgYm9keSBhbmQgdHlwZS4KICAgICAgICB0cnkgewogICAg\nICAgICAgICBieXRlW10gZGF0YSA9IGdldFBheWxvYWREYXRhKCk7CiAgICAg\nICAgICAgIGJ1aWxkZXIuc2V0Qm9keShCeXRlU3RyaW5nLmNvcHlGcm9tKGRh\ndGEpKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIEpNU0V4Y2VwdGlvbiBleCA9IG5ldyBKTVNFeGNlcHRpb24oIlVu\nYWJsZSB0byByZWFkIG1lc3NhZ2UgZGF0YSAuLiAiICsgZSk7CiAgICAgICAg\nICAgIGV4LnNldExpbmtlZEV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgdGhy\nb3cgZXg7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYnVpbGRlci5idWls\nZCgpOwogICAgfQoKCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBib29sZWFu\nIHJlYWRCb29sZWFuKCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKCFyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RSZWFkYWJsZUV4\nY2VwdGlvbigiTWVzc2FnZSBub3QgcmVhZGFibGUiKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICByZXR1cm4gcmVhZE9ubHlNZXNzYWdlLnJlYWRCb29s\nZWFuKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7CiAg\nICAgICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRp\nb24oImlvRXggPyIpOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNl\ncHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAg\nIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBieXRlIHJlYWRC\neXRlKCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFyZWFk\nTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RSZWFkYWJsZUV4Y2VwdGlvbigi\nTWVzc2FnZSBub3QgcmVhZGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICByZXR1cm4gcmVhZE9ubHlNZXNzYWdlLnJlYWRCeXRlKCk7CiAgICAg\nICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpN\nU0V4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oImlvRXggPyIp\nOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7\nCiAgICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBzaG9ydCByZWFkU2hvcnQoKSB0aHJv\nd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIXJlYWRNb2RlKSB0aHJv\ndyBuZXcgTWVzc2FnZU5vdFJlYWRhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5v\ndCByZWFkYWJsZSIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVy\nbiByZWFkT25seU1lc3NhZ2UucmVhZFNob3J0KCk7CiAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlv\nbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oImlvRXggPyIpOwogICAgICAg\nICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAg\nICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyBjaGFyIHJlYWRDaGFyKCkgdGhyb3dzIEpNU0V4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3Nh\nZ2VOb3RSZWFkYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3QgcmVhZGFibGUi\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gcmVhZE9ubHlN\nZXNzYWdlLnJlYWRDaGFyKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9IG5l\ndyBKTVNFeGNlcHRpb24oImlvRXggPyIpOwogICAgICAgICAgICBlb2ZFeC5z\nZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVv\nZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBpbnQgcmVhZEludCgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAg\nIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90UmVhZGFibGVF\neGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2FnZS5yZWFkSW50\nKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAg\nICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24o\nImlvRXggPyIpOwogICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRp\nb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0K\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBsb25nIHJlYWRMb25n\nKCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFyZWFkTW9k\nZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RSZWFkYWJsZUV4Y2VwdGlvbigiTWVz\nc2FnZSBub3QgcmVhZGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICByZXR1cm4gcmVhZE9ubHlNZXNzYWdlLnJlYWRMb25nKCk7CiAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4\nY2VwdGlvbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oImlvRXggPyIpOwog\nICAgICAgICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAg\nICAgICAgICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBmbG9hdCByZWFkRmxvYXQoKSB0aHJvd3Mg\nSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIXJlYWRNb2RlKSB0aHJvdyBu\nZXcgTWVzc2FnZU5vdFJlYWRhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCBy\nZWFkYWJsZSIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBy\nZWFkT25seU1lc3NhZ2UucmVhZEZsb2F0KCk7CiAgICAgICAgfSBjYXRjaCAo\nSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBl\nb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oImlvRXggPyIpOwogICAgICAgICAg\nICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAg\nIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyBkb3VibGUgcmVhZERvdWJsZSgpIHRocm93cyBKTVNFeGNl\ncHRpb24gewogICAgICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNz\nYWdlTm90UmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxl\nIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5\nTWVzc2FnZS5yZWFkRG91YmxlKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNl\ncHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9\nIG5ldyBKTVNFeGNlcHRpb24oImlvRXggPyIpOwogICAgICAgICAgICBlb2ZF\neC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93\nIGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBTdHJpbmcgcmVhZFN0cmluZygpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90\nUmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2Fn\nZS5yZWFkU3RyaW5nKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBK\nTVNFeGNlcHRpb24oImlvRXggPyIpOwogICAgICAgICAgICBlb2ZFeC5zZXRM\naW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBp\nbnQgcmVhZEJ5dGVzKGJ5dGVbXSBkYXRhKSB0aHJvd3MgSk1TRXhjZXB0aW9u\nIHsKICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNl\ncHRpb24oIlBsZWFzZSB1c2UgcmVhZE9iamVjdCAtIHRoaXMgbWV0aG9kIGlz\nIG5vdCBzdXBwb3J0ZWQiKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBPYmplY3QgcmVhZE9iamVjdCgpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIGlmICghcmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90\nUmVhZGFibGVFeGNlcHRpb24oIk1lc3NhZ2Ugbm90IHJlYWRhYmxlIik7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHJlYWRPbmx5TWVzc2Fn\nZS5yZWFkT2JqZWN0KCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBK\nTVNFeGNlcHRpb24oImlvRXggPyIpOwogICAgICAgICAgICBlb2ZFeC5zZXRM\naW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVvZkV4\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHdyaXRlQm9vbGVhbihib29sZWFuIHZhbCkgdGhyb3dzIEpNU0V4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2Fn\nZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUi\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB3cml0ZU9ubHlNZXNzYWdl\nLndyaXRlQm9vbGVhbih2YWwpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0\naW9uIGlvRXgpewogICAgICAgICAgICBKTVNFeGNlcHRpb24gZW9mRXggPSBu\nZXcgSk1TRXhjZXB0aW9uKCJVbmV4cGVjdGVkIGlvZXggOiAiICsgaW9FeCk7\nCiAgICAgICAgICAgIGVvZkV4LnNldExpbmtlZEV4Y2VwdGlvbihpb0V4KTsK\nICAgICAgICAgICAgdGhyb3cgZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgd3JpdGVCeXRlKGJ5dGUgdmFs\nKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUp\nIHRocm93IG5ldyBNZXNzYWdlTm90V3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNz\nYWdlIG5vdCB3cml0YWJsZSIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHdyaXRlT25seU1lc3NhZ2Uud3JpdGVCeXRlKHZhbCk7CiAgICAgICAgfSBj\nYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2Vw\ndGlvbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oIlVuZXhwZWN0ZWQgaW9l\neCA6ICIgKyBpb0V4KTsKICAgICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhj\nZXB0aW9uKGlvRXgpOwogICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAg\nICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCB3cml0\nZVNob3J0KHNob3J0IHZhbCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJs\nZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndyaXRlU2hvcnQo\ndmFsKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb0V4KXsKICAg\nICAgICAgICAgSk1TRXhjZXB0aW9uIGVvZkV4ID0gbmV3IEpNU0V4Y2VwdGlv\nbigiVW5leHBlY3RlZCBpb2V4IDogIiArIGlvRXgpOwogICAgICAgICAgICBl\nb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRo\ncm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyB2b2lkIHdyaXRlQ2hhcihjaGFyIHZhbCkgdGhyb3dzIEpNU0V4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVz\nc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFi\nbGUiKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB3cml0ZU9ubHlNZXNz\nYWdlLndyaXRlQ2hhcih2YWwpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0\naW9uIGlvRXgpewogICAgICAgICAgICBKTVNFeGNlcHRpb24gZW9mRXggPSBu\nZXcgSk1TRXhjZXB0aW9uKCJVbmV4cGVjdGVkIGlvZXggOiAiICsgaW9FeCk7\nCiAgICAgICAgICAgIGVvZkV4LnNldExpbmtlZEV4Y2VwdGlvbihpb0V4KTsK\nICAgICAgICAgICAgdGhyb3cgZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgd3JpdGVJbnQoaW50IHZhbCkg\ndGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0\naHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2Fn\nZSBub3Qgd3JpdGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB3\ncml0ZU9ubHlNZXNzYWdlLndyaXRlSW50KHZhbCk7CiAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlv\nbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oIlVuZXhwZWN0ZWQgaW9leCA6\nICIgKyBpb0V4KTsKICAgICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhjZXB0\naW9uKGlvRXgpOwogICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAgICB9\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCB3cml0ZUxv\nbmcobG9uZyB2YWwpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlm\nIChyZWFkTW9kZSkgdGhyb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVFeGNl\ncHRpb24oIk1lc3NhZ2Ugbm90IHdyaXRhYmxlIik7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgd3JpdGVPbmx5TWVzc2FnZS53cml0ZUxvbmcodmFsKTsK\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb0V4KXsKICAgICAgICAg\nICAgSk1TRXhjZXB0aW9uIGVvZkV4ID0gbmV3IEpNU0V4Y2VwdGlvbigiVW5l\neHBlY3RlZCBpb2V4IDogIiArIGlvRXgpOwogICAgICAgICAgICBlb2ZFeC5z\nZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAgICAgIHRocm93IGVv\nZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyB2b2lkIHdyaXRlRmxvYXQoZmxvYXQgdmFsKSB0aHJvd3MgSk1TRXhjZXB0\naW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdl\nTm90V3JpdGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlT25seU1lc3NhZ2Uu\nd3JpdGVGbG9hdCh2YWwpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9u\nIGlvRXgpewogICAgICAgICAgICBKTVNFeGNlcHRpb24gZW9mRXggPSBuZXcg\nSk1TRXhjZXB0aW9uKCJVbmV4cGVjdGVkIGlvZXggOiAiICsgaW9FeCk7CiAg\nICAgICAgICAgIGVvZkV4LnNldExpbmtlZEV4Y2VwdGlvbihpb0V4KTsKICAg\nICAgICAgICAgdGhyb3cgZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIHZvaWQgd3JpdGVEb3VibGUoZG91YmxlIHZh\nbCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2Rl\nKSB0aHJvdyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVz\nc2FnZSBub3Qgd3JpdGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICB3cml0ZU9ubHlNZXNzYWdlLndyaXRlRG91YmxlKHZhbCk7CiAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9FeCl7CiAgICAgICAgICAgIEpNU0V4\nY2VwdGlvbiBlb2ZFeCA9IG5ldyBKTVNFeGNlcHRpb24oIlVuZXhwZWN0ZWQg\naW9leCA6ICIgKyBpb0V4KTsKICAgICAgICAgICAgZW9mRXguc2V0TGlua2Vk\nRXhjZXB0aW9uKGlvRXgpOwogICAgICAgICAgICB0aHJvdyBlb2ZFeDsKICAg\nICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCB3\ncml0ZVN0cmluZyhTdHJpbmcgdmFsKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAocmVhZE1vZGUpIHRocm93IG5ldyBNZXNzYWdlTm90V3Jp\ndGVhYmxlRXhjZXB0aW9uKCJNZXNzYWdlIG5vdCB3cml0YWJsZSIpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlT25seU1lc3NhZ2Uud3JpdGVT\ndHJpbmcodmFsKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb0V4\nKXsKICAgICAgICAgICAgSk1TRXhjZXB0aW9uIGVvZkV4ID0gbmV3IEpNU0V4\nY2VwdGlvbigiVW5leHBlY3RlZCBpb2V4IDogIiArIGlvRXgpOwogICAgICAg\nICAgICBlb2ZFeC5zZXRMaW5rZWRFeGNlcHRpb24oaW9FeCk7CiAgICAgICAg\nICAgIHRocm93IGVvZkV4OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIHdyaXRlQnl0ZXMoYnl0ZVtdIGRhdGEpIHRo\ncm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmIChyZWFkTW9kZSkgdGhy\nb3cgbmV3IE1lc3NhZ2VOb3RXcml0ZWFibGVFeGNlcHRpb24oIk1lc3NhZ2Ug\nbm90IHdyaXRhYmxlIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgd3Jp\ndGVPbmx5TWVzc2FnZS53cml0ZUJ5dGVzKGRhdGEpOwogICAgICAgIH0gY2F0\nY2ggKElPRXhjZXB0aW9uIGlvRXgpewogICAgICAgICAgICBKTVNFeGNlcHRp\nb24gZW9mRXggPSBuZXcgSk1TRXhjZXB0aW9uKCJVbmV4cGVjdGVkIGlvZXgg\nOiAiICsgaW9FeCk7CiAgICAgICAgICAgIGVvZkV4LnNldExpbmtlZEV4Y2Vw\ndGlvbihpb0V4KTsKICAgICAgICAgICAgdGhyb3cgZW9mRXg7CiAgICAgICAg\nfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgd3JpdGVC\neXRlcyhieXRlW10gZGF0YSwgaW50IG9mZnNldCwgaW50IGxlbmd0aCkgdGhy\nb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJv\ndyBuZXcgTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBu\nb3Qgd3JpdGFibGUiKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB3cml0\nZU9ubHlNZXNzYWdlLndyaXRlQnl0ZXMoZGF0YSwgb2Zmc2V0LCBsZW5ndGgp\nOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvRXgpewogICAgICAg\nICAgICBKTVNFeGNlcHRpb24gZW9mRXggPSBuZXcgSk1TRXhjZXB0aW9uKCJV\nbmV4cGVjdGVkIGlvZXggOiAiICsgaW9FeCk7CiAgICAgICAgICAgIGVvZkV4\nLnNldExpbmtlZEV4Y2VwdGlvbihpb0V4KTsKICAgICAgICAgICAgdGhyb3cg\nZW9mRXg7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRoaXMgbWV0aG9kIGlz\nIE9OTFkgc3VwcG9zZWQgdG8gYmUgdXNlZCBmb3Igb2JqZWN0IGZvcm0gb2Yg\ncHJpbWl0aXZlIHR5cGVzICEKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgd3JpdGVPYmplY3QoT2JqZWN0IG9iaikgdGhyb3dzIEpNU0V4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcgTWVzc2FnZU5v\ndFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3JpdGFibGUiKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICB3cml0ZU9ubHlNZXNzYWdlLndy\naXRlT2JqZWN0KG9iaik7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9FeCl7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBlb2ZFeCA9IG5ldyBK\nTVNFeGNlcHRpb24oIlVuZXhwZWN0ZWQgaW9leCA6ICIgKyBpb0V4KTsKICAg\nICAgICAgICAgZW9mRXguc2V0TGlua2VkRXhjZXB0aW9uKGlvRXgpOwogICAg\nICAgICAgICB0aHJvdyBlb2ZFeDsKICAgICAgICB9CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgdm9pZCByZXNldCgpIHRocm93cyBKTVNFeGNl\ncHRpb24gewogICAgICAgIGlmICh0aGlzLnJlYWRNb2RlKSByZXR1cm4gOwog\nICAgICAgIHRoaXMucmVhZE1vZGUgPSB0cnVlOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGJ5dGVbXSBkYXRhID0gd3JpdGVPbmx5TWVzc2FnZS5nZXRQ\nYXlsb2FkQXNCeXRlcyhudWxsKTsKICAgICAgICAgICAgdGhpcy5yZWFkT25s\neU1lc3NhZ2UgPSBuZXcgUmVhZE9ubHlNZXNzYWdlKGRhdGEpOwogICAgICAg\nIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgSk1TRXhj\nZXB0aW9uIGV4ID0gbmV3IEpNU0V4Y2VwdGlvbigiY2FudCBjb252ZXJ0IHRv\nIHJlYWQgb25seSBtZXNzYWdlIC4uLiB1bmV4cGVjdGVkIGFjdHVhbGx5IC4u\nICIgKyBlKTsKICAgICAgICAgICAgZXguc2V0TGlua2VkRXhjZXB0aW9uKGUp\nOwogICAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CiAgICAgICAgdGhp\ncy53cml0ZU9ubHlNZXNzYWdlID0gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIGNsZWFyQm9keSgpIHRocm93cyBKTVNFeGNl\ncHRpb24gewogICAgICAgIHN1cGVyLmNsZWFyQm9keSgpOwogICAgICAgIHRo\naXMud3JpdGVPbmx5TWVzc2FnZSA9IG5ldyBXcml0ZU9ubHlNZXNzYWdlKCk7\nCiAgICAgICAgdGhpcy5yZWFkT25seU1lc3NhZ2UgPSBudWxsOwogICAgICAg\nIHRoaXMucmVhZE1vZGUgPSBmYWxzZTsKICAgIH0KCiAgICBwcml2YXRlIGJ5\ndGVbXSBnZXRQYXlsb2FkRGF0YSgpIHRocm93cyBJT0V4Y2VwdGlvbiwgSWxs\nZWdhbFN0YXRlRXhjZXB0aW9uIHsKICAgICAgICBpZiAocmVhZE1vZGUpIHJl\ndHVybiByZWFkT25seU1lc3NhZ2UuZ2V0RGF0YUNvcHkoKTsKCiAgICAgICAg\nTXV0YWJsZTxieXRlW10+IHByZUNsb3NlRGF0YSA9IG5ldyBNdXRhYmxlPGJ5\ndGVbXT4obnVsbCk7CiAgICAgICAgYnl0ZVtdIGRhdGEgPSB3cml0ZU9ubHlN\nZXNzYWdlLmdldFBheWxvYWRBc0J5dGVzKHByZUNsb3NlRGF0YSk7CgogICAg\nICAgIHdyaXRlT25seU1lc3NhZ2UgPSBuZXcgV3JpdGVPbmx5TWVzc2FnZShw\ncmVDbG9zZURhdGEuZ2V0VmFsdWUoKSk7CiAgICAgICAgcmV0dXJuIGRhdGE7\nCiAgICB9CgoKICAgIEBPdmVycmlkZQogICAgU3RyZWFtTWVzc2FnZUltcGwg\nY3JlYXRlQ2xvbmUoU2Vzc2lvbkltcGwgc2Vzc2lvbiwgU3RyaW5nIHNvdXJj\nZVRvcGljTmFtZSwgU3RyaW5nIHN1YnNjcmliZXJJZCkKICAgICAgICB0aHJv\nd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbmV3IFN0cmVhbU1l\nc3NhZ2VJbXBsKHNlc3Npb24sIHRoaXMsIHNvdXJjZVRvcGljTmFtZSwgc3Vi\nc2NyaWJlcklkKTsKICAgIH0KCiAgICAvLyBVc2luZyBqYXZhIG9iamVjdCdz\nIGluc3RlYWQgb2YgcHJpbWl0aXZlcyB0byBhdm9pZCBoYXZpbmcgdG8gc3Rv\ncmUgc2NoZW1hIHNlcGFyYXRlbHkuCiAgICBwcml2YXRlIHN0YXRpYyBjbGFz\ncyBSZWFkT25seU1lc3NhZ2UgewoKICAgICAgICBwcml2YXRlIGZpbmFsIE9i\namVjdElucHV0U3RyZWFtIG9pczsKICAgICAgICBwcml2YXRlIGZpbmFsIGJ5\ndGVbXSBkYXRhOwogICAgICAgIHByaXZhdGUgZmluYWwgRGVxdWU8T2JqZWN0\nPiB1bnJlYWRPYmplY3RzID0gbmV3IEFycmF5RGVxdWU8T2JqZWN0Pig0KTsK\nCiAgICAgICAgcHVibGljIFJlYWRPbmx5TWVzc2FnZShieXRlW10gZGF0YSkg\ndGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgdGhpcy5kYXRhID0g\nZGF0YTsKICAgICAgICAgICAgdGhpcy5vaXMgPSBuZXcgT2JqZWN0SW5wdXRT\ndHJlYW0obmV3IEJ5dGVBcnJheUlucHV0U3RyZWFtKGRhdGEpKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBieXRlW10gZ2V0RGF0YUNvcHkoKXsKICAg\nICAgICAgICAgcmV0dXJuIEFycmF5cy5jb3B5T2YoZGF0YSwgZGF0YS5sZW5n\ndGgpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIHVucmVhZE9i\namVjdChPYmplY3Qgb2JqKSB7CiAgICAgICAgICAgIHVucmVhZE9iamVjdHMu\ncHVzaChvYmopOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBPYmplY3Qg\ncmVhZE5leHRPYmplY3QoKSB0aHJvd3MgSU9FeGNlcHRpb24sIEpNU0V4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAo\nISB1bnJlYWRPYmplY3RzLmlzRW1wdHkoKSkgcmV0dXJuIHVucmVhZE9iamVj\ndHMucG9wKCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIG9pcy5yZWFkT2Jq\nZWN0KCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gdW5leHBlY3RlZCAhCiAg\nICAgICAgICAgICAgICBqYXZheC5qbXMuSWxsZWdhbFN0YXRlRXhjZXB0aW9u\nIGpFeCA9CiAgICAgICAgICAgICAgICAgICAgbmV3IGphdmF4Lmptcy5JbGxl\nZ2FsU3RhdGVFeGNlcHRpb24oIlVuZXhwZWN0ZWQgbm90IHRvIGJlIGFibGUg\ndG8gcmVzb2x2ZSBjbGFzcyIpOwogICAgICAgICAgICAgICAgakV4LnNldExp\nbmtlZEV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgICAgIHRocm93IGpFeDsK\nICAgICAgICAgICAgfSBjYXRjaCAoRU9GRXhjZXB0aW9uIGVvZikgewogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IE1lc3NhZ2VFT0ZFeGNlcHRpb24oImVv\nZiIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiByZWFkQm9vbGVhbigpIHRocm93cyBJT0V4Y2VwdGlvbiwgSk1T\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgT2JqZWN0IG9iaiA9IHJlYWROZXh0\nT2JqZWN0KCk7CiAgICAgICAgICAgIGJvb2xlYW4gZmFpbGVkID0gdHJ1ZTsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIEJvb2xlYW4gdmFs\ndWUgPSBNZXNzYWdlVXRpbC5hc0Jvb2xlYW4ob2JqKTsKICAgICAgICAgICAg\nICAgIGZhaWxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuIHZh\nbHVlOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\naWYgKGZhaWxlZCkgdW5yZWFkT2JqZWN0KG9iaik7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBieXRlIHJlYWRCeXRlKCkgdGhy\nb3dzIElPRXhjZXB0aW9uLCBKTVNFeGNlcHRpb24gewogICAgICAgICAgICBP\nYmplY3Qgb2JqID0gcmVhZE5leHRPYmplY3QoKTsKICAgICAgICAgICAgYm9v\nbGVhbiBmYWlsZWQgPSB0cnVlOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgQnl0ZSB2YWx1ZSA9IE1lc3NhZ2VVdGlsLmFzQnl0ZShvYmop\nOwogICAgICAgICAgICAgICAgZmFpbGVkID0gZmFsc2U7CiAgICAgICAgICAg\nICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICBpZiAoZmFpbGVkKSB1bnJlYWRPYmplY3Qob2JqKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIHNob3J0\nIHJlYWRTaG9ydCgpIHRocm93cyBJT0V4Y2VwdGlvbiwgSk1TRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgT2JqZWN0IG9iaiA9IHJlYWROZXh0T2JqZWN0KCk7\nCiAgICAgICAgICAgIGJvb2xlYW4gZmFpbGVkID0gdHJ1ZTsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIFNob3J0IHZhbHVlID0gTWVzc2Fn\nZVV0aWwuYXNTaG9ydChvYmopOwogICAgICAgICAgICAgICAgZmFpbGVkID0g\nZmFsc2U7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoZmFpbGVkKSB1\nbnJlYWRPYmplY3Qob2JqKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGNoYXIgcmVhZENoYXIoKSB0aHJvd3MgSU9FeGNlcHRp\nb24sIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIE9iamVjdCBvYmogPSBy\nZWFkTmV4dE9iamVjdCgpOwogICAgICAgICAgICBib29sZWFuIGZhaWxlZCA9\nIHRydWU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBDaGFy\nYWN0ZXIgdmFsdWUgPSBNZXNzYWdlVXRpbC5hc0NoYXIob2JqKTsKICAgICAg\nICAgICAgICAgIGZhaWxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0\ndXJuIHZhbHVlOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICAgICAgaWYgKGZhaWxlZCkgdW5yZWFkT2JqZWN0KG9iaik7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgcmVhZEludCgp\nIHRocm93cyBJT0V4Y2VwdGlvbiwgSk1TRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgT2JqZWN0IG9iaiA9IHJlYWROZXh0T2JqZWN0KCk7CiAgICAgICAgICAg\nIGJvb2xlYW4gZmFpbGVkID0gdHJ1ZTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIEludGVnZXIgdmFsdWUgPSBNZXNzYWdlVXRpbC5hc0lu\ndGVnZXIob2JqKTsKICAgICAgICAgICAgICAgIGZhaWxlZCA9IGZhbHNlOwog\nICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKGZhaWxlZCkgdW5yZWFkT2Jq\nZWN0KG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBsb25nIHJlYWRMb25nKCkgdGhyb3dzIElPRXhjZXB0aW9uLCBKTVNF\neGNlcHRpb24gewogICAgICAgICAgICBPYmplY3Qgb2JqID0gcmVhZE5leHRP\nYmplY3QoKTsKICAgICAgICAgICAgYm9vbGVhbiBmYWlsZWQgPSB0cnVlOwog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgTG9uZyB2YWx1ZSA9\nIE1lc3NhZ2VVdGlsLmFzTG9uZyhvYmopOwogICAgICAgICAgICAgICAgZmFp\nbGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAg\nICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoZmFp\nbGVkKSB1bnJlYWRPYmplY3Qob2JqKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGZsb2F0IHJlYWRGbG9hdCgpIHRocm93cyBJ\nT0V4Y2VwdGlvbiwgSk1TRXhjZXB0aW9uIHsKICAgICAgICAgICAgT2JqZWN0\nIG9iaiA9IHJlYWROZXh0T2JqZWN0KCk7CiAgICAgICAgICAgIGJvb2xlYW4g\nZmFpbGVkID0gdHJ1ZTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIEZsb2F0IHZhbHVlID0gTWVzc2FnZVV0aWwuYXNGbG9hdChvYmopOwog\nICAgICAgICAgICAgICAgZmFpbGVkID0gZmFsc2U7CiAgICAgICAgICAgICAg\nICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICBpZiAoZmFpbGVkKSB1bnJlYWRPYmplY3Qob2JqKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIGRvdWJsZSBy\nZWFkRG91YmxlKCkgdGhyb3dzIElPRXhjZXB0aW9uLCBKTVNFeGNlcHRpb24g\newogICAgICAgICAgICBPYmplY3Qgb2JqID0gcmVhZE5leHRPYmplY3QoKTsK\nICAgICAgICAgICAgYm9vbGVhbiBmYWlsZWQgPSB0cnVlOwogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgRG91YmxlIHZhbHVlID0gTWVzc2Fn\nZVV0aWwuYXNEb3VibGUob2JqKTsKICAgICAgICAgICAgICAgIGZhaWxlZCA9\nIGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKGZhaWxlZCkg\ndW5yZWFkT2JqZWN0KG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBTdHJpbmcgcmVhZFN0cmluZygpIHRocm93cyBJT0V4\nY2VwdGlvbiwgSk1TRXhjZXB0aW9uIHsKICAgICAgICAgICAgT2JqZWN0IG9i\naiA9IHJlYWROZXh0T2JqZWN0KCk7CiAgICAgICAgICAgIGJvb2xlYW4gZmFp\nbGVkID0gdHJ1ZTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIFN0cmluZyB2YWx1ZSA9IE1lc3NhZ2VVdGlsLmFzU3RyaW5nKG9iaik7CiAg\nICAgICAgICAgICAgICBmYWlsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAg\nIHJldHVybiB2YWx1ZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIGlmIChmYWlsZWQpIHVucmVhZE9iamVjdChvYmopOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IHJl\nYWRPYmplY3QoKSB0aHJvd3MgSU9FeGNlcHRpb24sIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIHJldHVybiByZWFkTmV4dE9iamVjdCgpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBXcml0ZU9ubHlN\nZXNzYWdlIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBCeXRlQXJyYXlPdXRw\ndXRTdHJlYW0gYmFvczsKICAgICAgICAvLyBwcml2YXRlIE9iamVjdE91dHB1\ndFN0cmVhbSBvb3M7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBPYmplY3RPdXRw\ndXRTdHJlYW0gb29zOwoKICAgICAgICBwdWJsaWMgV3JpdGVPbmx5TWVzc2Fn\nZSgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgICAgICBiYW9zID0g\nbmV3IEJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgb29zID0gbmV3IE9iamVjdE91dHB1dFN0cmVh\nbShiYW9zKTsKICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uIGpFeCA9\nCiAgICAgICAgICAgICAgICAgICAgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlv\nbigiVW5leHBlY3RlZCB0byBub3QgYmUgYWJsZSB0byBjcmVhdGUgZW1wdHkg\nd3JpdGUgb25seSBtZXNzYWdlIik7CiAgICAgICAgICAgICAgICBqRXguc2V0\nTGlua2VkRXhjZXB0aW9uKGUpOwogICAgICAgICAgICAgICAgdGhyb3cgakV4\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIFdy\naXRlT25seU1lc3NhZ2UoZmluYWwgYnl0ZVtdIGRhdGEpIHRocm93cyBJbGxl\nZ2FsU3RhdGVFeGNlcHRpb24gewogICAgICAgICAgICBiYW9zID0gbmV3IEJ5\ndGVBcnJheU91dHB1dFN0cmVhbSgpOwogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgaWYgKG51bGwgIT0gZGF0YSkgYmFvcy53cml0ZShkYXRh\nKTsKICAgICAgICAgICAgICAgIGJhb3MuZmx1c2goKTsKICAgICAgICAgICAg\nICAgIG9vcyA9IG5ldyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyl7CiAgICAg\nICAgICAgICAgICAgICAgLy8gRG8gbm90IHdyaXRlIHRoZSBoZWFkZXIgaWYg\nZGF0YSBpcyBiYXNlZCBvbiBhbHJlYWR5IG1hdGVyaWFsaXplZCBzdHJlYW0u\nCiAgICAgICAgICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgd3JpdGVTdHJl\nYW1IZWFkZXIoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAobnVsbCA9PSBkYXRhIHx8IDAgPT0gZGF0YS5sZW5n\ndGgpIHN1cGVyLndyaXRlU3RyZWFtSGVhZGVyKCk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgSWxsZWdhbFN0\nYXRlRXhjZXB0aW9uIGpFeCA9CiAgICAgICAgICAgICAgICAgICAgbmV3IEls\nbGVnYWxTdGF0ZUV4Y2VwdGlvbigiVW5leHBlY3RlZCB0byBub3QgYmUgYWJs\nZSB0byBjcmVhdGUgZW1wdHkgd3JpdGUgb25seSBtZXNzYWdlIik7CiAgICAg\nICAgICAgICAgICBqRXguc2V0TGlua2VkRXhjZXB0aW9uKGUpOwogICAgICAg\nICAgICAgICAgdGhyb3cgakV4OwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgYnl0ZVtdIGdldFBheWxvYWRBc0J5dGVzKE11dGFi\nbGU8Ynl0ZVtdPiBwcmVDbG9zZURhdGEpIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIG9vcy5mbHVzaCgpOwogICAgICAgICAgICBiYW9zLmZs\ndXNoKCk7CiAgICAgICAgICAgIGlmIChudWxsICE9IHByZUNsb3NlRGF0YSkg\ncHJlQ2xvc2VEYXRhLnNldFZhbHVlKGJhb3MudG9CeXRlQXJyYXkoKSk7CiAg\nICAgICAgICAgIG9vcy5jbG9zZSgpOwogICAgICAgICAgICBiYW9zLmZsdXNo\nKCk7CiAgICAgICAgICAgIGJhb3MuY2xvc2UoKTsKICAgICAgICAgICAgLy8g\nb29zID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIGJhb3MudG9CeXRlQXJy\nYXkoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlQm9v\nbGVhbihib29sZWFuIHZhbCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgb29zLndyaXRlT2JqZWN0KHZhbCk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCB3cml0ZUJ5dGUoYnl0ZSB2YWwpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgICAgIG9vcy53cml0ZU9iamVjdCh2YWwpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgd3JpdGVTaG9ydChzaG9y\ndCB2YWwpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIG9vcy53\ncml0ZU9iamVjdCh2YWwpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgd3JpdGVDaGFyKGNoYXIgdmFsKSB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgICAgICBvb3Mud3JpdGVPYmplY3QodmFsKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlSW50KGludCB2YWwpIHRocm93cyBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIG9vcy53cml0ZU9iamVjdCh2YWwp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgd3JpdGVMb25nKGxv\nbmcgdmFsKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBvb3Mu\nd3JpdGVPYmplY3QodmFsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIHdyaXRlRmxvYXQoZmxvYXQgdmFsKSB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgICAgICBvb3Mud3JpdGVPYmplY3QodmFsKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlRG91YmxlKGRvdWJsZSB2YWwp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIG9vcy53cml0ZU9i\namVjdCh2YWwpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgd3Jp\ndGVTdHJpbmcoU3RyaW5nIHZhbCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgb29zLndyaXRlT2JqZWN0KHZhbCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCB3cml0ZUJ5dGVzKGJ5dGVbXSBkYXRhKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBvb3Mud3JpdGVPYmplY3Qo\nZGF0YSk7CiAgICAgICAgfQoKICAgICAgICAvLyBjb3B5IGFuZCB3cml0ZSBh\ncyBhIHNpbmdsZSBieXRlIGFycmF5LgogICAgICAgIHB1YmxpYyB2b2lkIHdy\naXRlQnl0ZXMoYnl0ZVtdIGRhdGEsIGludCBvZmZzZXQsIGludCBsZW5ndGgp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJ5dGVbXSBhcnIg\nPSBuZXcgYnl0ZVtsZW5ndGhdOwogICAgICAgICAgICBTeXN0ZW0uYXJyYXlj\nb3B5KGRhdGEsIG9mZnNldCwgYXJyLCAwLCBsZW5ndGgpOwogICAgICAgICAg\nICB3cml0ZUJ5dGVzKGFycik7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCB3cml0ZU9iamVjdChPYmplY3Qgb2JqKSB0aHJvd3MgSk1TRXhjZXB0\naW9uLCBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIC8vIHVucm9sbGluZyBp\ndAogICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgQm9vbGVhbikgewog\nICAgICAgICAgICAgICAgd3JpdGVCb29sZWFuKChCb29sZWFuKSBvYmopOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKG9iaiBpbnN0YW5j\nZW9mIEJ5dGUpIHsKICAgICAgICAgICAgICAgIHdyaXRlQnl0ZSgoQnl0ZSkg\nb2JqKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChvYmog\naW5zdGFuY2VvZiBTaG9ydCkgewogICAgICAgICAgICAgICAgd3JpdGVTaG9y\ndCgoU2hvcnQpIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxz\nZSBpZiAob2JqIGluc3RhbmNlb2YgQ2hhcmFjdGVyKSB7CiAgICAgICAgICAg\nICAgICB3cml0ZUNoYXIoKENoYXJhY3Rlcikgb2JqKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBJbnRlZ2Vy\nKSB7CiAgICAgICAgICAgICAgICB3cml0ZUludCgoSW50ZWdlcikgb2JqKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChvYmogaW5zdGFu\nY2VvZiBMb25nKSB7CiAgICAgICAgICAgICAgICB3cml0ZUxvbmcoKExvbmcp\nIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob2Jq\nIGluc3RhbmNlb2YgRmxvYXQpIHsKICAgICAgICAgICAgICAgIHdyaXRlRmxv\nYXQoKEZsb2F0KSBvYmopOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVs\nc2UgaWYgKG9iaiBpbnN0YW5jZW9mIERvdWJsZSkgewogICAgICAgICAgICAg\nICAgd3JpdGVEb3VibGUoKERvdWJsZSkgb2JqKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBTdHJpbmcpIHsK\nICAgICAgICAgICAgICAgIHdyaXRlU3RyaW5nKChTdHJpbmcpIG9iaik7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAob2JqIGluc3RhbmNl\nb2YgYnl0ZVtdKSB7CiAgICAgICAgICAgICAgICB3cml0ZUJ5dGVzKChieXRl\nW10pIG9iaik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZXsKICAg\nICAgICAgICAgICAgIHRocm93IG5ldyBKTVNFeGNlcHRpb24oIlVuc3VwcG9y\ndGVkIHR5cGUgZm9yIG9iaiA6ICIgKyBvYmouZ2V0Q2xhc3MoKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0=\n","encoding":"base64"}

