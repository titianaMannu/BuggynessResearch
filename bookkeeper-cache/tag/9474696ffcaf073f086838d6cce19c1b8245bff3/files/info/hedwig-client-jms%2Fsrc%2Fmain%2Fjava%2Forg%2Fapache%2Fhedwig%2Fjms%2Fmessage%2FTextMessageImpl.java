{"sha":"dc3a3ca4e8298471e06fc307d37a3cdc40da70b3","node_id":"MDQ6QmxvYjE1NzU5NTY6ZGMzYTNjYTRlODI5ODQ3MWUwNmZjMzA3ZDM3YTNjZGM0MGRhNzBiMw==","size":4761,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/dc3a3ca4e8298471e06fc307d37a3cdc40da70b3","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMubWVzc2FnZTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5qbXMuU2Vzc2lvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbDsKCmltcG9ydCBqYXZh\neC5qbXMuSk1TRXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2U7\nCmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmF4Lmptcy5UZXh0TWVzc2FnZTsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CgovKioKICogcmVhZC93cml0ZSB0ZXh0IG1lc3NhZ2UgLi4u\nCiAqLwpwdWJsaWMgY2xhc3MgVGV4dE1lc3NhZ2VJbXBsIGV4dGVuZHMgTWVz\nc2FnZUltcGwgaW1wbGVtZW50cyBUZXh0TWVzc2FnZSB7CiAgICBwcml2YXRl\nIFN0cmluZyBwYXlsb2FkOwogICAgcHJpdmF0ZSBib29sZWFuIHJlYWRNb2Rl\nOwoKICAgIHB1YmxpYyBUZXh0TWVzc2FnZUltcGwoU2Vzc2lvbkltcGwgc2Vz\nc2lvbikgewogICAgICAgIHN1cGVyKHNlc3Npb24pOwogICAgICAgIHRoaXMu\ncmVhZE1vZGUgPSBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMgVGV4dE1lc3Nh\nZ2VJbXBsKFNlc3Npb25JbXBsIHNlc3Npb24sIFN0cmluZyBwYXlsb2FkKSB7\nCiAgICAgICAgc3VwZXIoc2Vzc2lvbik7CiAgICAgICAgdGhpcy5wYXlsb2Fk\nID0gcGF5bG9hZDsKICAgICAgICB0aGlzLnJlYWRNb2RlID0gZmFsc2U7CiAg\nICB9CgogICAgcHVibGljIFRleHRNZXNzYWdlSW1wbChTZXNzaW9uSW1wbCBz\nZXNzaW9uLCBUZXh0TWVzc2FnZUltcGwgbWVzc2FnZSwgU3RyaW5nIHNvdXJj\nZVRvcGljTmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5n\nIHN1YnNjcmliZXJJZCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAg\nc3VwZXIoc2Vzc2lvbiwgKE1lc3NhZ2VJbXBsKSBtZXNzYWdlLCBzb3VyY2VU\nb3BpY05hbWUsIHN1YnNjcmliZXJJZCk7CgogICAgICAgIHRoaXMucGF5bG9h\nZCA9IG1lc3NhZ2UuZ2V0VGV4dCgpOwogICAgICAgIHRoaXMucmVhZE1vZGUg\nPSBtZXNzYWdlLnJlYWRNb2RlOwogICAgfQoKCiAgICAvLyBUbyBjbG9uZSBh\nIG1lc3NhZ2UgZnJvbSBhIFRleHRNZXNzYWdlIHdoaWNoIGlzIE5PVCBUZXh0\nTWVzc2FnZUltcGwKICAgIC8vIENoYW5naW5nIG9yZGVyIG9mIHBhcmFtZXRl\nciB0byBOT1QgYWNjaWRlbnRhbGx5IGNsYXNoIHdpdGggdGhlIGNvbnN0cnVj\ndG9yIGFib3ZlLgogICAgLy8gVGhpcyBpcyBtaWRseSBjb25mdXNpbmcsIGJ1\ndCBoZWxwcyBhIGxvdCBpbiBwcmV2ZW50aW5nIGFjY2lkZW50YWwgYnVncyAh\nCiAgICBwdWJsaWMgVGV4dE1lc3NhZ2VJbXBsKFRleHRNZXNzYWdlIG1lc3Nh\nZ2UsIFNlc3Npb25JbXBsIHNlc3Npb24pIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIHN1cGVyKChNZXNzYWdlKSBtZXNzYWdlLCBzZXNzaW9uKTsK\nCiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBUZXh0TWVzc2FnZUlt\ncGwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEpNU0V4Y2VwdGlvbigiQ29k\naW5nIGJ1ZyAtIHNob3VsZCB1c2UgdGhpcyBjb25zdHJ1Y3RvciBPTkxZIGZv\nciBub24gVGV4dE1lc3NhZ2VJbXBsIG1lc3NhZ2VzIik7CiAgICAgICAgfQoK\nICAgICAgICB0aGlzLnBheWxvYWQgPSBtZXNzYWdlLmdldFRleHQoKTsKICAg\nICAgICB0aGlzLnJlYWRNb2RlID0gZmFsc2U7CiAgICB9CgogICAgcHVibGlj\nIFRleHRNZXNzYWdlSW1wbChTZXNzaW9uSW1wbCBzZXNzaW9uLCBQdWJTdWJQ\ncm90b2NvbC5NZXNzYWdlIG1lc3NhZ2UsIE1hcDxTdHJpbmcsIE9iamVjdD4g\ncHJvcGVydGllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5n\nIHNvdXJjZVRvcGljTmFtZSwgU3RyaW5nIHN1YnNjcmliZXJJZCwgUnVubmFi\nbGUgYWNrUnVubmFibGUpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAg\nIHN1cGVyKHNlc3Npb24sIG1lc3NhZ2UsIHByb3BlcnRpZXMsIHNvdXJjZVRv\ncGljTmFtZSwgc3Vic2NyaWJlcklkLCBhY2tSdW5uYWJsZSk7CgogICAgICAg\nIHRoaXMucGF5bG9hZCA9IGhhc0JvZHlGcm9tUHJvcGVydGllcygpID8gbWVz\nc2FnZS5nZXRCb2R5KCkudG9TdHJpbmdVdGY4KCkgOiBudWxsOwogICAgICAg\nIHRoaXMucmVhZE1vZGUgPSB0cnVlOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIE1lc3NhZ2VVdGlsLlN1cHBvcnRlZE1lc3NhZ2VUeXBl\ncyBnZXRKbXNNZXNzYWdlVHlwZSgpIHsKICAgICAgICByZXR1cm4gTWVzc2Fn\nZVV0aWwuU3VwcG9ydGVkTWVzc2FnZVR5cGVzLlRFWFQ7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgUHViU3ViUHJvdG9jb2wuTWVzc2FnZSBn\nZW5lcmF0ZUhlZHdpZ01lc3NhZ2UoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsK\nICAgICAgICBQdWJTdWJQcm90b2NvbC5NZXNzYWdlLkJ1aWxkZXIgYnVpbGRl\nciA9IFB1YlN1YlByb3RvY29sLk1lc3NhZ2UubmV3QnVpbGRlcigpOwogICAg\nICAgIHN1cGVyLnBvcHVsYXRlQnVpbGRlcldpdGhIZWFkZXJzKGJ1aWxkZXIp\nOwogICAgICAgIGlmICghIGlzQm9keUVtcHR5KCkpIGJ1aWxkZXIuc2V0Qm9k\neShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCh0aGlzLnBheWxvYWQpKTsKICAg\nICAgICByZXR1cm4gYnVpbGRlci5idWlsZCgpOwogICAgfQoKICAgIHByb3Rl\nY3RlZCBib29sZWFuIGlzQm9keUVtcHR5KCl7CiAgICAgICAgcmV0dXJuIG51\nbGwgPT0gdGhpcy5wYXlsb2FkOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIHZvaWQgc2V0VGV4dChTdHJpbmcgcGF5bG9hZCkgdGhyb3dzIEpN\nU0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJlYWRNb2RlKSB0aHJvdyBuZXcg\nTWVzc2FnZU5vdFdyaXRlYWJsZUV4Y2VwdGlvbigiTWVzc2FnZSBub3Qgd3Jp\ndGFibGUiKTsKICAgICAgICB0aGlzLnBheWxvYWQgPSBwYXlsb2FkOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXRUZXh0KCkg\ndGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHBheWxvYWQ7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjbGVhckJv\nZHkoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5jbGVh\nckJvZHkoKTsKICAgICAgICB0aGlzLnBheWxvYWQgPSBudWxsOwogICAgICAg\nIHRoaXMucmVhZE1vZGUgPSBmYWxzZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyB2b2lkIHJlc2V0KCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKHRoaXMucmVhZE1vZGUpIHJldHVybiA7CiAgICAgICAg\ndGhpcy5yZWFkTW9kZSA9IHRydWU7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBUZXh0TWVzc2FnZUltcGwgY3JlYXRlQ2xvbmUoU2Vzc2lvbkltcGwgc2Vz\nc2lvbiwgU3RyaW5nIHNvdXJjZVRvcGljTmFtZSwgU3RyaW5nIHN1YnNjcmli\nZXJJZCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG5l\ndyBUZXh0TWVzc2FnZUltcGwoc2Vzc2lvbiwgdGhpcywgc291cmNlVG9waWNO\nYW1lLCBzdWJzY3JpYmVySWQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICBmaW5hbCBTdHJp\nbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBz\nYi5hcHBlbmQoIlRleHRNZXNzYWdlSW1wbCIpOwogICAgICAgIHNiLmFwcGVu\nZCgie3BheWxvYWQ9JyIpLmFwcGVuZChwYXlsb2FkKS5hcHBlbmQoJ1wnJyk7\nCiAgICAgICAgc2IuYXBwZW5kKCIsIHJlYWRNb2RlPSIpLmFwcGVuZChyZWFk\nTW9kZSk7CiAgICAgICAgc2IuYXBwZW5kKCIsIHBhcmVudD0iKS5hcHBlbmQo\nc3VwZXIudG9TdHJpbmcoKSk7CiAgICAgICAgc2IuYXBwZW5kKCd9Jyk7CiAg\nICAgICAgcmV0dXJuIHNiLnRvU3RyaW5nKCk7CiAgICB9Cn0K\n","encoding":"base64"}

