{"sha":"a2845be563110ae8fd0e7cf36bc085b51e0d5196","node_id":"MDQ6QmxvYjE1NzU5NTY6YTI4NDViZTU2MzExMGFlOGZkMGU3Y2YzNmJjMDg1YjUxZTBkNTE5Ng==","size":7823,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a2845be563110ae8fd0e7cf36bc085b51e0d5196","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMuc2VsZWN0b3I7CgppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuam1zLm1lc3NhZ2UuTWVzc2FnZUltcGw7Cgov\nKioKICogQmluYXJ5IGFyaXRoZW1hdGljIG9mIHZhbHVlcyAuLgogKi8KcHVi\nbGljIGFic3RyYWN0IGNsYXNzIEJpbmFyeUFyaXRobWV0aWNGdW5jdGlvbiBl\neHRlbmRzIEJpbmFyeUV4cHJGdW5jdGlvbiB7CgogICAgcHJvdGVjdGVkIFNl\nbGVjdG9yQ29uc3RhbnQgZXZhbHVhdGVJbXBsKFNlbGVjdG9yQ29uc3RhbnQg\nbGVmdCwgU2VsZWN0b3JDb25zdGFudCByaWdodCwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlSW1wbCBtZXNz\nYWdlKSB0aHJvd3MgU2VsZWN0b3JFdmFsdWF0aW9uRXhjZXB0aW9uIHsKCiAg\nICAgICAgc3dpdGNoIChsZWZ0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSBJ\nTlQ6IHsKICAgICAgICAgICAgICAgIHN3aXRjaCAocmlnaHQudHlwZSkgewog\nICAgICAgICAgICAgICAgICAgIGNhc2UgSU5UOgogICAgICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IFNlbGVjdG9yQ29uc3RhbnQoY29tcHV0ZVdp\ndGhJbnQobGVmdC5nZXRJbnRWYWx1ZSgpLCByaWdodC5nZXRJbnRWYWx1ZSgp\nKSk7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBET1VCTEU6CiAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0b3JDb25zdGFudChj\nb21wdXRlV2l0aEludChsZWZ0LmdldEludFZhbHVlKCksIHJpZ2h0LmdldERv\ndWJsZVZhbHVlKCkpKTsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Ogog\nICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU2VsZWN0b3JFdmFs\ndWF0aW9uRXhjZXB0aW9uKGdldENsYXNzKCkgKyAiIFVuZXhwZWN0ZWQgdHlw\nZSA6ICIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQudHlw\nZSArICIuIGxlZnQgOiAiICsgbGVmdCArICIsIHJpZ2h0IDogIiArIHJpZ2h0\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBjYXNlIERPVUJMRTogewogICAgICAgICAgICAgICAgc3dpdGNoIChyaWdo\ndC50eXBlKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBJTlQ6CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0b3JDb25zdGFu\ndChjb21wdXRlV2l0aERvdWJsZShsZWZ0LmdldERvdWJsZVZhbHVlKCksIHJp\nZ2h0LmdldEludFZhbHVlKCkpKTsKICAgICAgICAgICAgICAgICAgICBjYXNl\nIERPVUJMRToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBT\nZWxlY3RvckNvbnN0YW50KGNvbXB1dGVXaXRoRG91YmxlKGxlZnQuZ2V0RG91\nYmxlVmFsdWUoKSwgcmlnaHQuZ2V0RG91YmxlVmFsdWUoKSkpOwogICAgICAg\nICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBTZWxlY3RvckV2YWx1YXRpb25FeGNlcHRpb24oZ2V0Q2xh\nc3MoKSArICIgVW5leHBlY3RlZCB0eXBlIDogIiArCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICByaWdodC50eXBlICsgIi4gbGVmdCA6ICIgKyBsZWZ0\nICsgIiwgcmlnaHQgOiAiICsgcmlnaHQpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgQk9PTEVBTjoKICAgICAg\nICAgICAgY2FzZSBTVFJJTkc6CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgU2VsZWN0b3JFdmFsdWF0aW9uRXhjZXB0\naW9uKGdldENsYXNzKCkgKyAiIFVuc3VwcG9ydGVkIHR5cGUgOiAiICsgbGVm\ndC50eXBlICsKICAgICAgICAgICAgICAgICAgICAiLiBsZWZ0IDogIiArIGxl\nZnQgKyAiLCByaWdodCA6ICIgKyByaWdodCk7CiAgICAgICAgfQogICAgfQoK\nCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgRG91YmxlIGNvbXB1dGVXaXRoSW50\nKEludGVnZXIgbGVmdCwgRG91YmxlIHJpZ2h0KSB0aHJvd3MgU2VsZWN0b3JF\ndmFsdWF0aW9uRXhjZXB0aW9uOwoKICAgIHByb3RlY3RlZCBhYnN0cmFjdCBJ\nbnRlZ2VyIGNvbXB1dGVXaXRoSW50KEludGVnZXIgbGVmdCwgSW50ZWdlciBy\naWdodCkgdGhyb3dzIFNlbGVjdG9yRXZhbHVhdGlvbkV4Y2VwdGlvbjsKCiAg\nICBwcm90ZWN0ZWQgYWJzdHJhY3QgRG91YmxlIGNvbXB1dGVXaXRoRG91Ymxl\nKERvdWJsZSBsZWZ0LCBEb3VibGUgcmlnaHQpIHRocm93cyBTZWxlY3RvckV2\nYWx1YXRpb25FeGNlcHRpb247CgogICAgcHJvdGVjdGVkIGFic3RyYWN0IERv\ndWJsZSBjb21wdXRlV2l0aERvdWJsZShEb3VibGUgbGVmdCwgSW50ZWdlciBy\naWdodCkgdGhyb3dzIFNlbGVjdG9yRXZhbHVhdGlvbkV4Y2VwdGlvbjsKCgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBCaW5hcnlBcml0aG1ldGljRnVuY3Rp\nb24gQUREX0ZVTkNUSU9OID0gbmV3IEJpbmFyeUFyaXRobWV0aWNGdW5jdGlv\nbigpIHsKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgRG91\nYmxlIGNvbXB1dGVXaXRoSW50KEludGVnZXIgbGVmdCwgRG91YmxlIHJpZ2h0\nKSB0aHJvd3MgU2VsZWN0b3JFdmFsdWF0aW9uRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgaWYgKG51bGwgPT0gbGVmdCB8fCBudWxsID09IHJpZ2h0KSByZXR1\ncm4gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIChkb3VibGUpIGxlZnQgKyBy\naWdodDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHBy\nb3RlY3RlZCBJbnRlZ2VyIGNvbXB1dGVXaXRoSW50KEludGVnZXIgbGVmdCwg\nSW50ZWdlciByaWdodCkgdGhyb3dzIFNlbGVjdG9yRXZhbHVhdGlvbkV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIGlmIChudWxsID09IGxlZnQgfHwgbnVsbCA9\nPSByaWdodCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIHJldHVybiBsZWZ0\nICsgcmlnaHQ7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwcm90ZWN0ZWQgRG91YmxlIGNvbXB1dGVXaXRoRG91YmxlKERvdWJsZSBs\nZWZ0LCBEb3VibGUgcmlnaHQpIHRocm93cyBTZWxlY3RvckV2YWx1YXRpb25F\neGNlcHRpb24gewogICAgICAgICAgICBpZiAobnVsbCA9PSBsZWZ0IHx8IG51\nbGwgPT0gcmlnaHQpIHJldHVybiBudWxsOwogICAgICAgICAgICByZXR1cm4g\nbGVmdCArIHJpZ2h0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHJvdGVjdGVkIERvdWJsZSBjb21wdXRlV2l0aERvdWJsZShEb3Vi\nbGUgbGVmdCwgSW50ZWdlciByaWdodCkgdGhyb3dzIFNlbGVjdG9yRXZhbHVh\ndGlvbkV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChudWxsID09IGxlZnQg\nfHwgbnVsbCA9PSByaWdodCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIHJl\ndHVybiBsZWZ0ICsgKGRvdWJsZSkgcmlnaHQ7CiAgICAgICAgfQogICAgfTsK\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIEJpbmFyeUFyaXRobWV0aWNGdW5j\ndGlvbiBTVUJfRlVOQ1RJT04gPSBuZXcgQmluYXJ5QXJpdGhtZXRpY0Z1bmN0\naW9uKCkgewogICAgICAgIEBPdmVycmlkZQogICAgICAgIHByb3RlY3RlZCBE\nb3VibGUgY29tcHV0ZVdpdGhJbnQoSW50ZWdlciBsZWZ0LCBEb3VibGUgcmln\naHQpIHRocm93cyBTZWxlY3RvckV2YWx1YXRpb25FeGNlcHRpb24gewogICAg\nICAgICAgICBpZiAobnVsbCA9PSBsZWZ0IHx8IG51bGwgPT0gcmlnaHQpIHJl\ndHVybiBudWxsOwogICAgICAgICAgICByZXR1cm4gKGRvdWJsZSkgbGVmdCAt\nIHJpZ2h0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHJvdGVjdGVkIEludGVnZXIgY29tcHV0ZVdpdGhJbnQoSW50ZWdlciBsZWZ0\nLCBJbnRlZ2VyIHJpZ2h0KSB0aHJvd3MgU2VsZWN0b3JFdmFsdWF0aW9uRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgaWYgKG51bGwgPT0gbGVmdCB8fCBudWxs\nID09IHJpZ2h0KSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIGxl\nZnQgLSByaWdodDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHByb3RlY3RlZCBEb3VibGUgY29tcHV0ZVdpdGhEb3VibGUoRG91Ymxl\nIGxlZnQsIERvdWJsZSByaWdodCkgdGhyb3dzIFNlbGVjdG9yRXZhbHVhdGlv\nbkV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChudWxsID09IGxlZnQgfHwg\nbnVsbCA9PSByaWdodCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIHJldHVy\nbiBsZWZ0IC0gcmlnaHQ7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwcm90ZWN0ZWQgRG91YmxlIGNvbXB1dGVXaXRoRG91YmxlKERv\ndWJsZSBsZWZ0LCBJbnRlZ2VyIHJpZ2h0KSB0aHJvd3MgU2VsZWN0b3JFdmFs\ndWF0aW9uRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKG51bGwgPT0gbGVm\ndCB8fCBudWxsID09IHJpZ2h0KSByZXR1cm4gbnVsbDsKICAgICAgICAgICAg\ncmV0dXJuIGxlZnQgLSAoZG91YmxlKSByaWdodDsKICAgICAgICB9CiAgICB9\nOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgQmluYXJ5QXJpdGhtZXRpY0Z1\nbmN0aW9uIE1VTFRJUExZX0ZVTkNUSU9OID0gbmV3IEJpbmFyeUFyaXRobWV0\naWNGdW5jdGlvbigpIHsKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90\nZWN0ZWQgRG91YmxlIGNvbXB1dGVXaXRoSW50KEludGVnZXIgbGVmdCwgRG91\nYmxlIHJpZ2h0KSB0aHJvd3MgU2VsZWN0b3JFdmFsdWF0aW9uRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgaWYgKG51bGwgPT0gbGVmdCB8fCBudWxsID09IHJp\nZ2h0KSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIChkb3VibGUp\nIGxlZnQgKiByaWdodDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHByb3RlY3RlZCBJbnRlZ2VyIGNvbXB1dGVXaXRoSW50KEludGVn\nZXIgbGVmdCwgSW50ZWdlciByaWdodCkgdGhyb3dzIFNlbGVjdG9yRXZhbHVh\ndGlvbkV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChudWxsID09IGxlZnQg\nfHwgbnVsbCA9PSByaWdodCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIHJl\ndHVybiBsZWZ0ICogcmlnaHQ7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwcm90ZWN0ZWQgRG91YmxlIGNvbXB1dGVXaXRoRG91Ymxl\nKERvdWJsZSBsZWZ0LCBEb3VibGUgcmlnaHQpIHRocm93cyBTZWxlY3RvckV2\nYWx1YXRpb25FeGNlcHRpb24gewogICAgICAgICAgICBpZiAobnVsbCA9PSBs\nZWZ0IHx8IG51bGwgPT0gcmlnaHQpIHJldHVybiBudWxsOwogICAgICAgICAg\nICByZXR1cm4gbGVmdCAqIHJpZ2h0OwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHJvdGVjdGVkIERvdWJsZSBjb21wdXRlV2l0aERv\ndWJsZShEb3VibGUgbGVmdCwgSW50ZWdlciByaWdodCkgdGhyb3dzIFNlbGVj\ndG9yRXZhbHVhdGlvbkV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChudWxs\nID09IGxlZnQgfHwgbnVsbCA9PSByaWdodCkgcmV0dXJuIG51bGw7CiAgICAg\nICAgICAgIHJldHVybiBsZWZ0ICogKGRvdWJsZSkgcmlnaHQ7CiAgICAgICAg\nfQogICAgfTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIEJpbmFyeUFyaXRo\nbWV0aWNGdW5jdGlvbiBESVZJREVfRlVOQ1RJT04gPSBuZXcgQmluYXJ5QXJp\ndGhtZXRpY0Z1bmN0aW9uKCkgewogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHByb3RlY3RlZCBEb3VibGUgY29tcHV0ZVdpdGhJbnQoSW50ZWdlciBsZWZ0\nLCBEb3VibGUgcmlnaHQpIHRocm93cyBTZWxlY3RvckV2YWx1YXRpb25FeGNl\ncHRpb24gewogICAgICAgICAgICBpZiAobnVsbCA9PSBsZWZ0IHx8IG51bGwg\nPT0gcmlnaHQpIHJldHVybiBudWxsOwogICAgICAgICAgICBpZiAoKGRvdWJs\nZSkgMCA9PSByaWdodCkgdGhyb3cgbmV3IFNlbGVjdG9yRXZhbHVhdGlvbkV4\nY2VwdGlvbihnZXRDbGFzcygpICsgIiBkZW5vbWluYXRvciA9PSAwIik7CiAg\nICAgICAgICAgIHJldHVybiAoZG91YmxlKSBsZWZ0IC8gcmlnaHQ7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgSW50\nZWdlciBjb21wdXRlV2l0aEludChJbnRlZ2VyIGxlZnQsIEludGVnZXIgcmln\naHQpIHRocm93cyBTZWxlY3RvckV2YWx1YXRpb25FeGNlcHRpb24gewogICAg\nICAgICAgICBpZiAobnVsbCA9PSBsZWZ0IHx8IG51bGwgPT0gcmlnaHQpIHJl\ndHVybiBudWxsOwogICAgICAgICAgICBpZiAoKGludCkgMCA9PSByaWdodCkg\ndGhyb3cgbmV3IFNlbGVjdG9yRXZhbHVhdGlvbkV4Y2VwdGlvbihnZXRDbGFz\ncygpICsgIiBkZW5vbWluYXRvciA9PSAwIik7CiAgICAgICAgICAgIHJldHVy\nbiBsZWZ0IC8gcmlnaHQ7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwcm90ZWN0ZWQgRG91YmxlIGNvbXB1dGVXaXRoRG91YmxlKERv\ndWJsZSBsZWZ0LCBEb3VibGUgcmlnaHQpIHRocm93cyBTZWxlY3RvckV2YWx1\nYXRpb25FeGNlcHRpb24gewogICAgICAgICAgICBpZiAobnVsbCA9PSBsZWZ0\nIHx8IG51bGwgPT0gcmlnaHQpIHJldHVybiBudWxsOwogICAgICAgICAgICBp\nZiAoKGRvdWJsZSkgMCA9PSByaWdodCkgdGhyb3cgbmV3IFNlbGVjdG9yRXZh\nbHVhdGlvbkV4Y2VwdGlvbihnZXRDbGFzcygpICsgIiBkZW5vbWluYXRvciA9\nPSAwIik7CiAgICAgICAgICAgIHJldHVybiBsZWZ0IC8gcmlnaHQ7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgRG91\nYmxlIGNvbXB1dGVXaXRoRG91YmxlKERvdWJsZSBsZWZ0LCBJbnRlZ2VyIHJp\nZ2h0KSB0aHJvd3MgU2VsZWN0b3JFdmFsdWF0aW9uRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgaWYgKG51bGwgPT0gbGVmdCB8fCBudWxsID09IHJpZ2h0KSBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgaWYgKDAgPT0gcmlnaHQpIHRocm93\nIG5ldyBTZWxlY3RvckV2YWx1YXRpb25FeGNlcHRpb24oZ2V0Q2xhc3MoKSAr\nICIgZGVub21pbmF0b3IgPT0gMCIpOwogICAgICAgICAgICByZXR1cm4gbGVm\ndCAvIChkb3VibGUpIHJpZ2h0OwogICAgICAgIH0KICAgIH07CgoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpewogICAgICAg\nIHJldHVybiBnZXRDbGFzcygpLmdldE5hbWUoKTsKICAgIH0KfQo=\n","encoding":"base64"}

