{"sha":"98f4273c6715040f358c35df6036ccfa359ce639","node_id":"MDQ6QmxvYjE1NzU5NTY6OThmNDI3M2M2NzE1MDQwZjM1OGMzNWRmNjAzNmNjZmEzNTljZTYzOQ==","size":6800,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/98f4273c6715040f358c35df6036ccfa359ce639","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5qbXMuc3BpOwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5jb25maWd1cmF0aW9uLkNvbmZpZ3VyYXRpb25FeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5D\nbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nam1zLkNvbm5lY3Rpb25JbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nam1zLk1lc3NhZ2luZ1Nlc3Npb25GYWNhZGU7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5qbXMuU2Vzc2lvbkltcGw7CgppbXBvcnQgamF2YXguam1zLkpN\nU0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5NYWxmb3JtZWRVUkxF\neGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5VUkw7CmltcG9ydCBqYXZhLm5l\ndC5VUkxDb25uZWN0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJMU3RyZWFtSGFu\nZGxlcjsKCi8qKgogKiBSZXR1cm5zIHRoZSBoZWR3aWcgc3BlY2lmaWMgZnVu\nY3Rpb25hbGl0eSBvZiB0aGUgQ29ubmVjdGlvbiAtIHdoaWNoIGlzIHRpZWQg\ndG8gdGhpcyBzcGkgaW1wbC4KICogQ291cGxlZCB3aXRoIEhlZHdpZ01lc3Nh\nZ2luZ1Nlc3Npb25GYWNhZGUuCiAqCiAqLwpwdWJsaWMgY2xhc3MgSGVkd2ln\nQ29ubmVjdGlvbkltcGwgZXh0ZW5kcyBDb25uZWN0aW9uSW1wbCB7CgogICAg\ncHJpdmF0ZSBDbGllbnRDb25maWd1cmF0aW9uIGhlZHdpZ0NsaWVudENvbmZp\nZzsKCiAgICBwdWJsaWMgSGVkd2lnQ29ubmVjdGlvbkltcGwoKSB0aHJvd3Mg\nSk1TRXhjZXB0aW9uIHsKICAgICAgICBzdXBlcigpOwogICAgICAgIGluaXQo\nZ2V0VXNlcigpLCBnZXRQYXNzd29yZCgpKTsKICAgIH0KCiAgICBwdWJsaWMg\nSGVkd2lnQ29ubmVjdGlvbkltcGwoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNz\nd29yZCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIgKHVz\nZXIsIHBhc3N3b3JkKTsKICAgICAgICBpbml0KGdldFVzZXIoKSwgZ2V0UGFz\nc3dvcmQoKSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nU2Vzc2lvbkltcGwgY3JlYXRlU2Vzc2lvbkluc3RhbmNlKGJvb2xlYW4gdHJh\nbnNhY3RlZCwgaW50IGFja25vd2xlZGdlTW9kZSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWVzc2FnaW5nU2Vz\nc2lvbkZhY2FkZS5EZXN0aW5hdGlvblR5cGUgdHlwZSkgdGhyb3dzIEpNU0V4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKG51bGwgPT0gdHlwZSkgcmV0dXJuIG5l\ndyBTZXNzaW9uSW1wbCh0aGlzLCB0cmFuc2FjdGVkLCBhY2tub3dsZWRnZU1v\nZGUpOwogICAgICAgIHN3aXRjaCAodHlwZSl7CiAgICAgICAgICAgIGNhc2Ug\nUVVFVUU6CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFF1ZXVlU2Vzc2lv\nbkltcGwodGhpcywgdHJhbnNhY3RlZCwgYWNrbm93bGVkZ2VNb2RlKTsKICAg\nICAgICAgICAgY2FzZSBUT1BJQzoKICAgICAgICAgICAgICAgIHJldHVybiBu\nZXcgVG9waWNTZXNzaW9uSW1wbCh0aGlzLCB0cmFuc2FjdGVkLCBhY2tub3ds\nZWRnZU1vZGUpOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IEpNU0V4Y2VwdGlvbigiVW5rbm93biB0eXBlICIgKyB0\neXBlKTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90\nZWN0ZWQgdm9pZCBkb1N0YXJ0KFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzc3dv\ncmQpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIC8vIG5vb3AgZm9y\nIG5vdyAuLi4KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBpbml0KFN0cmlu\nZyB1c2VyLCBTdHJpbmcgcGFzc3dvcmQpIHRocm93cyBKTVNFeGNlcHRpb24g\newogICAgICAgIC8vIGxvYWQgdG8gY2hlY2sgc2FuaXR5LgogICAgICAgIGhl\nZHdpZ0NsaWVudENvbmZpZyA9IGxvYWRDb25maWcoKTsKCiAgICAgICAgLy8g\nVE9ETzogU2V0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBzcGVjaWZpZWQgYnkg\ndGhlIHVzZXIgb2YgYXBpIC0gdXNlci9wYXNzd2QvZXRjLgogICAgfQoKICAg\nIC8vIGNvcGllZCBmcm9tIGVhcmxpZXIgY29kZSAuLi4KICAgIHByaXZhdGUg\nQ2xpZW50Q29uZmlndXJhdGlvbiBsb2FkQ29uZmlnKCkgdGhyb3dzIEpNU0V4\nY2VwdGlvbiB7CiAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlvbiBjb25maWcg\nPSBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpOwoKICAgICAgICAvLyBUT0RP\nOiBUaGlzIGlzIG5vdCB2ZXJ5IGV4dGVuc2libGUgYW5kIHVzZWZ1bCAuLi4g\nd2UgbmVlZCB0byBwaWNrIHRoZSBpbmZvIGZyb20KICAgICAgICAvLyBjb25m\naWd1cmF0aW9uIHNwZWNpZmllZCBieSB1c2VyLCBOT1Qgb25seSBmcm9tIHN0\nYXRpYyBmaWxlcyAhCiAgICAgICAgLy8gQWxzbywgd2UgbmVlZCB0byBiZSBh\nYmxlIHRvIHN1cHBvcnQgbXVsdGlwbGUgY29uZmlndXJhdGlvbiBpbiBhIHNp\nbmdsZSBjbGllbnQgIQogICAgICAgIC8vIFdlIG5lZWQgYSBiZXR0ZXIgc29s\ndXRpb24gLi4uLgoKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyAxLiB0\ncnkgdG8gbG9hZCB0aGUgY2xpZW50IGNvbmZpZ3VyYXRpb24gYXMgc3BlY2lm\naWVkIGZyb20gYQogICAgICAgICAgICAvLyBzeXN0ZW0gcHJvcGVydHkKICAg\nICAgICAgICAgaWYgKFN5c3RlbS5nZXRQcm9wZXJ0eShIRURXSUdfQ0xJRU5U\nX0NPTkZJR19GSUxFKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBGaWxl\nIGNvbmZpZ0ZpbGUgPSBuZXcgRmlsZShTeXN0ZW0uZ2V0UHJvcGVydHkoSEVE\nV0lHX0NMSUVOVF9DT05GSUdfRklMRSkpOwogICAgICAgICAgICAgICAgaWYg\nKCFjb25maWdGaWxlLmV4aXN0cygpKSB7CiAgICAgICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IEpNU0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICJDYW5ub3QgY3JlYXRlIGNvbm5lY3Rpb246IGNhbm5vdCBmaW5k\nIEhlZHdpZyBjbGllbnQgY29uZmlndXJhdGlvbiBmaWxlIHNwZWNpZmllZCBh\ncyBbIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFN5\nc3RlbS5nZXRQcm9wZXJ0eShIRURXSUdfQ0xJRU5UX0NPTkZJR19GSUxFKSAr\nICJdIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25m\naWcubG9hZENvbmYoY29uZmlnRmlsZS50b1VSSSgpLnRvVVJMKCkpOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gMi4gdHJ5IHRv\nIGxvYWQgYSAiaGVkd2lnLWNsaWVudC5jZmciIGZpbGUgZnJvbSB0aGUgY2xh\nc3NwYXRoCiAgICAgICAgICAgICAgICBjb25maWcubG9hZENvbmYobmV3IFVS\nTChudWxsLCAiY2xhc3NwYXRoOi8vaGVkd2lnLWNsaWVudC5jZmciLCBuZXcg\nVVJMU3RyZWFtSGFuZGxlcigpIHsKICAgICAgICAgICAgICAgICAgICBwcm90\nZWN0ZWQgVVJMQ29ubmVjdGlvbiBvcGVuQ29ubmVjdGlvbihVUkwgdSkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g\ncmVseSBvbiB0aGUgcmVsZXZhbnQgY2xhc3Nsb2FkZXIgLSBub3Qgc3lzdGVt\nIGNsYXNzbG9hZGVyLgogICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBV\nUkwgcmVzb3VyY2VVcmwgPSBIZWR3aWdDb25uZWN0aW9uSW1wbC50aGlzLmdl\ndENsYXNzKCkuZ2V0Q2xhc3NMb2FkZXIoKS4KICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGdldFJlc291cmNlKHUuZ2V0UGF0aCgpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlVXJsLm9wZW5Db25uZWN0\naW9uKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfSkpOwogICAgICAgICAgICB9CgogICAgICAgIH0gY2F0Y2ggKE1hbGZvcm1l\nZFVSTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIEpNU0V4Y2VwdGlvbiBq\nZSA9IG5ldyBKTVNFeGNlcHRpb24oIkNhbm5vdCBsb2FkIEhlZHdpZyBjbGll\nbnQgY29uZmlndXJhdGlvbiBmaWxlICIgKyBlKTsKICAgICAgICAgICAgamUu\nc2V0TGlua2VkRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB0aHJvdyBqZTsK\nICAgICAgICB9IGNhdGNoIChDb25maWd1cmF0aW9uRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgSk1TRXhjZXB0aW9uIGplID0gbmV3IEpNU0V4Y2VwdGlv\nbigiQ2Fubm90IGxvYWQgSGVkd2lnIGNsaWVudCBjb25maWd1cmF0aW9uICIg\nKyBlKTsKICAgICAgICAgICAgamUuc2V0TGlua2VkRXhjZXB0aW9uKGUpOwog\nICAgICAgICAgICB0aHJvdyBqZTsKICAgICAgICB9CgogICAgICAgIC8qCiAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJnZXRDb25zdW1lZE1lc3NhZ2Vz\nQnVmZmVyU2l6ZSA6ICIgKyBjb25maWcuZ2V0Q29uc3VtZWRNZXNzYWdlc0J1\nZmZlclNpemUoKSk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJnZXRE\nZWZhdWx0U2VydmVySG9zdCA6ICIgKyBjb25maWcuZ2V0RGVmYXVsdFNlcnZl\nckhvc3QoKSk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJpc1NTTEVu\nYWJsZWQgOiAiICsgY29uZmlnLmlzU1NMRW5hYmxlZCgpKTsKICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oImdldE1heGltdW1NZXNzYWdlU2l6ZSA6ICIg\nKyBjb25maWcuZ2V0TWF4aW11bU1lc3NhZ2VTaXplKCkpOwogICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigiZ2V0TWF4aW11bU91dHN0YW5kaW5nTWVzc2Fn\nZXMgOiAiICsgY29uZmlnLmdldE1heGltdW1PdXRzdGFuZGluZ01lc3NhZ2Vz\nKCkpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiZ2V0TWF4aW11bVNl\ncnZlclJlZGlyZWN0cyA6ICIgICsgY29uZmlnLmdldE1heGltdW1TZXJ2ZXJS\nZWRpcmVjdHMoKSk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJnZXRT\nZXJ2ZXJBY2tSZXNwb25zZVRpbWVvdXQgOiAiICArIGNvbmZpZy5nZXRTZXJ2\nZXJBY2tSZXNwb25zZVRpbWVvdXQoKSk7CiAgICAgICAgKi8KCiAgICAgICAg\ncmV0dXJuIGNvbmZpZzsKICAgIH0KCiAgICBwdWJsaWMgQ2xpZW50Q29uZmln\ndXJhdGlvbiBnZXRIZWR3aWdDbGllbnRDb25maWcoKSB7CiAgICAgICAgcmV0\ndXJuIGhlZHdpZ0NsaWVudENvbmZpZzsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCB2b2lkIGRvU3RvcCgpIHsKICAgICAgICAvLyBub3Ro\naW5nIHNwZWNpZmljIHRvIGJlIGRvbmUuCiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwcm90ZWN0ZWQgdm9pZCBkb0Nsb3NlKCl7CiAgICAgICAgLy8gbm90\naGluZyBzcGVjaWZpYyB0byBiZSBkb25lLgogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIE1lc3NhZ2luZ1Nlc3Npb25GYWNhZGUgY3JlYXRl\nTWVzc2FnaW5nU2Vzc2lvbkZhY2FkZShTZXNzaW9uSW1wbCBzZXNzaW9uKSB0\naHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbmV3IEhlZHdp\nZ01lc3NhZ2luZ1Nlc3Npb25GYWNhZGUodGhpcywgc2Vzc2lvbik7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgVG9waWNTZXNzaW9uSW1wbCBj\ncmVhdGVUb3BpY1Nlc3Npb24oYm9vbGVhbiB0cmFuc2FjdGVkLCBpbnQgYWNr\nbm93bGVkZ2VNb2RlKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gKFRvcGljU2Vzc2lvbkltcGwpIGNyZWF0ZVNlc3Npb25JbXBsKHRy\nYW5zYWN0ZWQsIGFja25vd2xlZGdlTW9kZSwKICAgICAgICAgICAgTWVzc2Fn\naW5nU2Vzc2lvbkZhY2FkZS5EZXN0aW5hdGlvblR5cGUuVE9QSUMpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFF1ZXVlU2Vzc2lvbkltcGwg\nY3JlYXRlUXVldWVTZXNzaW9uKGJvb2xlYW4gdHJhbnNhY3RlZCwgaW50IGFj\na25vd2xlZGdlTW9kZSkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIChRdWV1ZVNlc3Npb25JbXBsKSBjcmVhdGVTZXNzaW9uSW1wbCh0\ncmFuc2FjdGVkLCBhY2tub3dsZWRnZU1vZGUsCiAgICAgICAgICAgIE1lc3Nh\nZ2luZ1Nlc3Npb25GYWNhZGUuRGVzdGluYXRpb25UeXBlLlFVRVVFKTsKICAg\nIH0KfQo=\n","encoding":"base64"}

