{"sha":"f4c0f7ec023e63a073597fa5540b5fb07ecbfda9","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjRjMGY3ZWMwMjNlNjNhMDczNTk3ZmE1NTQwYjVmYjA3ZWNiZmRhOQ==","size":5296,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f4c0f7ec023e63a073597fa5540b5fb07ecbfda9","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmEudXRpbC5NYXA7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwLkVudHJ5OwppbXBvcnQgamF2YS51dGls\nLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jvb2xlYW47CgppbXBvcnQganVu\naXQuZnJhbWV3b3JrLlRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuSm1zVGVzdEJhc2U7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioKICogRW5mb3JjZXMg\nYSB0ZXN0IGNhc2UgdG8gcnVuIGZvciBvbmx5IGFuIGFsbG90dGVkIHRpbWUg\ndG8gcHJldmVudCB0aGVtIGZyb20KICogaGFuZ2luZyBhbmQgYnJlYWtpbmcg\ndGhlIHdob2xlIHRlc3RpbmcuCiAqLwoKcHVibGljIGFic3RyYWN0IGNsYXNz\nIEF1dG9GYWlsVGVzdFN1cHBvcnQgZXh0ZW5kcyBKbXNUZXN0QmFzZSB7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBFWElUX1NVQ0NFU1MgPSAwOwog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgRVhJVF9FUlJPUiA9IDE7CiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoQXV0b0ZhaWxUZXN0U3VwcG9ydC5jbGFzcyk7Cgog\nICAgcHJpdmF0ZSBsb25nIG1heFRlc3RUaW1lID0gNSAqIDYwICogMTAwMDsg\nLy8gNSBtaW5zIGJ5IGRlZmF1bHQKICAgIHByaXZhdGUgVGhyZWFkIGF1dG9G\nYWlsVGhyZWFkOwoKICAgIHByaXZhdGUgYm9vbGVhbiB2ZXJib3NlID0gdHJ1\nZTsKICAgIHByaXZhdGUgYm9vbGVhbiB1c2VBdXRvRmFpbDsgLy8gRGlzYWJs\nZSBhdXRvIGZhaWwgYnkgZGVmYXVsdAogICAgcHJpdmF0ZSBBdG9taWNCb29s\nZWFuIGlzVGVzdFN1Y2Nlc3M7CgogICAgcHJvdGVjdGVkIHZvaWQgc2V0VXAo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBSdW5zIHRoZSBhdXRv\nIGZhaWwgdGhyZWFkIGJlZm9yZSBwZXJmb3JtaW5nIGFueSBzZXR1cAogICAg\nICAgIGlmIChpc0F1dG9GYWlsKCkpIHsKICAgICAgICAgICAgc3RhcnRBdXRv\nRmFpbFRocmVhZCgpOwogICAgICAgIH0KICAgICAgICBzdXBlci5zZXRVcCgp\nOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHRlYXJEb3duKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsKCiAgICAg\nICAgLy8gU3RvcHMgdGhlIGF1dG8gZmFpbCB0aHJlYWQgb25seSBhZnRlciBw\nZXJmb3JtaW5nIGFueSBjbGVhbiB1cAogICAgICAgIHN0b3BBdXRvRmFpbFRo\ncmVhZCgpOwogICAgfQoKICAgIC8qKgogICAgICogTWFudWFsbHkgc3RhcnQg\ndGhlIGF1dG8gZmFpbCB0aHJlYWQuIFRvIHN0YXJ0IGl0IGF1dG9tYXRpY2Fs\nbHksIGp1c3Qgc2V0CiAgICAgKiB0aGUgYXV0byBmYWlsIHRvIHRydWUgYmVm\nb3JlIGNhbGxpbmcgYW55IHNldHVwIG1ldGhvZHMuIEFzIGEgcnVsZSwgdGhp\ncwogICAgICogbWV0aG9kIGlzIHVzZWQgb25seSB3aGVuIHlvdSBhcmUgbm90\nIHN1cmUsIGlmIHRoZSBzZXRVcCBhbmQgdGVhckRvd24KICAgICAqIG1ldGhv\nZCBpcyBwcm9wYWdhdGVkIGNvcnJlY3RseS4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc3RhcnRBdXRvRmFpbFRocmVhZCgpIHsKICAgICAgICBzZXRBdXRv\nRmFpbCh0cnVlKTsKICAgICAgICBpc1Rlc3RTdWNjZXNzID0gbmV3IEF0b21p\nY0Jvb2xlYW4oZmFsc2UpOwogICAgICAgIGF1dG9GYWlsVGhyZWFkID0gbmV3\nIFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgLy8gV2FpdCBmb3IgdGVzdCB0byBmaW5pc2ggc3VjY2VzZnVs\nbHkKICAgICAgICAgICAgICAgICAgICBUaHJlYWQuc2xlZXAoZ2V0TWF4VGVz\ndFRpbWUoKSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB1\nc3VhbGx5IG1lYW5zIHRoZSB0ZXN0IHdhcyBzdWNjZXNzZnVsCiAgICAgICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIC8vIENo\nZWNrIGlmIHRoZSB0ZXN0IHdhcyBhYmxlIHRvIHRlYXIgZG93biBzdWNjZXNm\ndWxseSwKICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCB1c3VhbGx5IG1l\nYW5zLCBpdCBoYXMgZmluaXNoZWQgaXRzIHJ1bi4KICAgICAgICAgICAgICAg\nICAgICBpZiAoIWlzVGVzdFN1Y2Nlc3MuZ2V0KCkpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgTE9HLmVycm9yKCJUZXN0IGNhc2UgaGFzIGV4Y2VlZGVk\nIHRoZSBtYXhpbXVtIGFsbG90dGVkIHRpbWUgdG8gcnVuIG9mOiAiCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGdldE1heFRlc3RUaW1l\nKCkgKyAiIG1zLiIpOwogICAgICAgICAgICAgICAgICAgICAgICBkdW1wQWxs\nVGhyZWFkcyhnZXROYW1lKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBT\neXN0ZW0uZXhpdChFWElUX0VSUk9SKTsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LCAi\nQXV0b0ZhaWxUaHJlYWQiKTsKCiAgICAgICAgaWYgKHZlcmJvc2UpIHsKICAg\nICAgICAgICAgTE9HLmluZm8oIlN0YXJ0aW5nIGF1dG8gZmFpbCB0aHJlYWQu\nLi4iKTsKICAgICAgICB9CgogICAgICAgIExPRy5pbmZvKCJTdGFydGluZyBh\ndXRvIGZhaWwgdGhyZWFkLi4uIik7CiAgICAgICAgYXV0b0ZhaWxUaHJlYWQu\nc3RhcnQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1hbnVhbGx5IHN0b3Bz\nIHRoZSBhdXRvIGZhaWwgdGhyZWFkLiBBcyBhIHJ1bGUsIHRoaXMgbWV0aG9k\nIGlzIHVzZWQgb25seQogICAgICogd2hlbiB5b3UgYXJlIG5vdCBzdXJlLCBp\nZiB0aGUgc2V0VXAgYW5kIHRlYXJEb3duIG1ldGhvZCBpcyBwcm9wYWdhdGVk\nCiAgICAgKiBjb3JyZWN0bHkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHN0\nb3BBdXRvRmFpbFRocmVhZCgpIHsKICAgICAgICBpZiAoaXNBdXRvRmFpbCgp\nICYmIGF1dG9GYWlsVGhyZWFkICE9IG51bGwgJiYgYXV0b0ZhaWxUaHJlYWQu\naXNBbGl2ZSgpKSB7CiAgICAgICAgICAgIGlzVGVzdFN1Y2Nlc3Muc2V0KHRy\ndWUpOwoKICAgICAgICAgICAgaWYgKHZlcmJvc2UpIHsKICAgICAgICAgICAg\nICAgIExPRy5pbmZvKCJTdG9wcGluZyBhdXRvIGZhaWwgdGhyZWFkLi4uIik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIExPRy5pbmZvKCJTdG9wcGlu\nZyBhdXRvIGZhaWwgdGhyZWFkLi4uIik7CiAgICAgICAgICAgIGF1dG9GYWls\nVGhyZWFkLmludGVycnVwdCgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFNldHMgdGhlIGF1dG8gZmFpbCB2YWx1ZS4gQXMgYSBydWxlLCB0\naGlzIHNob3VsZCBiZSB1c2VkIG9ubHkgYmVmb3JlIGFueQogICAgICogc2V0\ndXAgbWV0aG9kcyBpcyBjYWxsZWQgdG8gYXV0b21hdGljYWxseSBlbmFibGUg\ndGhlIGF1dG8gZmFpbCB0aHJlYWQgaW4KICAgICAqIHRoZSBzZXR1cCBtZXRo\nb2Qgb2YgdGhlIHRlc3QgY2FzZS4KICAgICAqCiAgICAgKiBAcGFyYW0gdmFs\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEF1dG9GYWlsKGJvb2xlYW4g\ndmFsKSB7CiAgICAgICAgdGhpcy51c2VBdXRvRmFpbCA9IHZhbDsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc0F1dG9GYWlsKCkgewogICAgICAgIHJl\ndHVybiB0aGlzLnVzZUF1dG9GYWlsOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGFzc2lnbmVkIHZhbHVlIHdpbGwgb25seSBiZSByZWZsZWN0ZWQgd2hl\nbiB0aGUgYXV0byBmYWlsIHRocmVhZCBoYXMKICAgICAqIHN0YXJ0ZWQgaXRz\nIHJ1bi4gVmFsdWUgaXMgaW4gbWlsbGlzZWNvbmRzLgogICAgICoKICAgICAq\nIEBwYXJhbSB2YWwKICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWF4VGVz\ndFRpbWUobG9uZyB2YWwpIHsKICAgICAgICB0aGlzLm1heFRlc3RUaW1lID0g\ndmFsOwogICAgfQoKICAgIHB1YmxpYyBsb25nIGdldE1heFRlc3RUaW1lKCkg\newogICAgICAgIHJldHVybiB0aGlzLm1heFRlc3RUaW1lOwogICAgfQoKICAg\nIHB1YmxpYyBzdGF0aWMgdm9pZCBkdW1wQWxsVGhyZWFkcyhTdHJpbmcgcHJl\nZml4KSB7CiAgICAgICAgTWFwPFRocmVhZCwgU3RhY2tUcmFjZUVsZW1lbnRb\nXT4gc3RhY2tzID0gVGhyZWFkLmdldEFsbFN0YWNrVHJhY2VzKCk7CiAgICAg\nICAgZm9yIChFbnRyeTxUaHJlYWQsIFN0YWNrVHJhY2VFbGVtZW50W10+IHN0\nYWNrRW50cnkgOiBzdGFja3MuZW50cnlTZXQoKSkgewogICAgICAgICAgICBT\neXN0ZW0uZXJyLnByaW50bG4ocHJlZml4ICsgIiAiICsgc3RhY2tFbnRyeS5n\nZXRLZXkoKSk7CiAgICAgICAgICAgIGZvcihTdGFja1RyYWNlRWxlbWVudCBl\nbGVtZW50IDogc3RhY2tFbnRyeS5nZXRWYWx1ZSgpKSB7CiAgICAgICAgICAg\nICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIiAgICAgIiArIGVsZW1lbnQpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

