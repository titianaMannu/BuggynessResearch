{"sha":"dd914b5f2fda3e934a93539c8a2bfa35e8d17cb2","node_id":"MDQ6QmxvYjE1NzU5NTY6ZGQ5MTRiNWYyZmRhM2U5MzRhOTM1MzljOGEyYmZhMzVlOGQxN2NiMg==","size":7726,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/dd914b5f2fda3e934a93539c8a2bfa35e8d17cb2","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmF4Lmptcy5Ub3Bp\nYzsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmptcy5TZXNzaW9uSW1wbDsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmptcy5zcGkuSGVkd2lnQ29ubmVj\ndGlvbkZhY3RvcnlJbXBsOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubmV0LlVSSTsKaW1wb3J0IGphdmEubmV0LlVSSVN5bnRh\neEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNhbGxh\nYmxlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0\nY2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhvcmU7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKaW1wb3J0IGph\ndmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5BdG9taWNJbnRlZ2VyOwoKaW1w\nb3J0IGphdmF4Lmptcy5CeXRlc01lc3NhZ2U7CmltcG9ydCBqYXZheC5qbXMu\nQ29ubmVjdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5Db25uZWN0aW9uRmFjdG9y\neTsKaW1wb3J0IGphdmF4Lmptcy5EZWxpdmVyeU1vZGU7CmltcG9ydCBqYXZh\neC5qbXMuSk1TRXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2U7\nCmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZUNvbnN1bWVyOwppbXBvcnQgamF2\nYXguam1zLk1lc3NhZ2VMaXN0ZW5lcjsKaW1wb3J0IGphdmF4Lmptcy5NZXNz\nYWdlUHJvZHVjZXI7CmltcG9ydCBqYXZheC5qbXMuU2Vzc2lvbjsKCmltcG9y\ndCBqdW5pdC5mcmFtZXdvcmsuVGVzdDsKCgoKaW1wb3J0IGphdmF4Lmptcy5E\nZXN0aW5hdGlvbjsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioKICogQmVuY2htYXJrcyB0\naGUgYnJva2VyIGJ5IHN0YXJ0aW5nIG1hbnkgY29uc3VtZXIgYW5kIHByb2R1\nY2VycyBhZ2FpbnN0IHRoZQogKiBzYW1lIGRlc3RpbmF0aW9uLiBNYWtlIHN1\ncmUgeW91IHJ1biB3aXRoIGp2bSBvcHRpb24gLXNlcnZlciAobWFrZXMgYSBi\naWcKICogZGlmZmVyZW5jZSkuIFRoZSB0ZXN0cyBzaW11bGF0ZSBzdG9yaW5n\nIDEwMDAgMWsgam1zIG1lc3NhZ2VzIHRvIHNlZSB0aGUgcmF0ZQogKiBvZiBw\ncm9jZXNzaW5nIG1zZy9zZWMuCiAqLwpwdWJsaWMgY2xhc3MgSm1zQmVuY2ht\nYXJrIGV4dGVuZHMgSm1zVGVzdFN1cHBvcnQgewogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgdHJhbnNpZW50IExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5\nLmdldExvZ2dlcihKbXNCZW5jaG1hcmsuY2xhc3MpOwoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGxvbmcgU0FNUExFX0RFTEFZID0gSW50ZWdlci5wYXJz\nZUludChTeXN0ZW0uZ2V0UHJvcGVydHkoIlNBTVBMRV9ERUxBWSIsICIiICsg\nMTAwMCAqIDUpKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGxvbmcgU0FN\nUExFUyA9IEludGVnZXIucGFyc2VJbnQoU3lzdGVtLmdldFByb3BlcnR5KCJT\nQU1QTEVTIiwgIjEwIikpOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9u\nZyBTQU1QTEVfRFVSQVRJT04gPSBJbnRlZ2VyLnBhcnNlSW50KFN5c3RlbS5n\nZXRQcm9wZXJ0eSgiU0FNUExFU19EVVJBVElPTiIsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICIiICsgMTAwMCAqIDYwKSk7CiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgUFJPRFVDRVJfQ09VTlQgPSBJ\nbnRlZ2VyLnBhcnNlSW50KFN5c3RlbS5nZXRQcm9wZXJ0eSgiUFJPRFVDRVJf\nQ09VTlQiLCAiMTAiKSk7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQg\nQ09OU1VNRVJfQ09VTlQgPSBJbnRlZ2VyLnBhcnNlSW50KFN5c3RlbS5nZXRQ\ncm9wZXJ0eSgiQ09OU1VNRVJfQ09VTlQiLCAiMTAiKSk7CgogICAgcHVibGlj\nIERlc3RpbmF0aW9uIGRlc3RpbmF0aW9uOwoKICAgIHB1YmxpYyBzdGF0aWMg\nVGVzdCBzdWl0ZSgpIHsKICAgICAgICByZXR1cm4gc3VpdGUoSm1zQmVuY2ht\nYXJrLmNsYXNzKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFp\nbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAganVuaXQudGV4dHVpLlRlc3RS\ndW5uZXIucnVuKEptc0JlbmNobWFyay5jbGFzcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgaW5pdENvbWJvcygpIHsKICAgICAgICBhZGRDb21iaW5hdGlv\nblZhbHVlcygiZGVzdGluYXRpb24iLCBuZXcgT2JqZWN0W10ge1Nlc3Npb25J\nbXBsLmFzVG9waWMoIlRFU1QiKX0pOwogICAgfQoKICAgIHByb3RlY3RlZCBD\nb25uZWN0aW9uRmFjdG9yeSBjcmVhdGVDb25uZWN0aW9uRmFjdG9yeSgpIHRo\ncm93cyBVUklTeW50YXhFeGNlcHRpb24sIElPRXhjZXB0aW9uIHsKICAgICAg\nICByZXR1cm4gbmV3IEhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbCgpOwog\nICAgfQoKICAgIC8qKgogICAgICogQHRocm93cyBUaHJvd2FibGUKICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdENvbmN1cnJlbnRTZW5kUmVjZWl2ZSgp\nIHRocm93cyBUaHJvd2FibGUgewoKICAgICAgICBmaW5hbCBTZW1hcGhvcmUg\nY29ubmVjdGlvbnNFc3RhYmxpc2hlZCA9IG5ldyBTZW1hcGhvcmUoMSAtIChD\nT05TVU1FUl9DT1VOVCArIFBST0RVQ0VSX0NPVU5UKSk7CiAgICAgICAgZmlu\nYWwgU2VtYXBob3JlIHdvcmtlckRvbmUgPSBuZXcgU2VtYXBob3JlKDEgLSAo\nQ09OU1VNRVJfQ09VTlQgKyBQUk9EVUNFUl9DT1VOVCkpOwogICAgICAgIGZp\nbmFsIENvdW50RG93bkxhdGNoIHNhbXBsZVRpbWVEb25lID0gbmV3IENvdW50\nRG93bkxhdGNoKDEpOwoKICAgICAgICBmaW5hbCBBdG9taWNJbnRlZ2VyIHBy\nb2R1Y2VkTWVzc2FnZXMgPSBuZXcgQXRvbWljSW50ZWdlcigwKTsKICAgICAg\nICBmaW5hbCBBdG9taWNJbnRlZ2VyIHJlY2VpdmVkTWVzc2FnZXMgPSBuZXcg\nQXRvbWljSW50ZWdlcigwKTsKCiAgICAgICAgZmluYWwgQ2FsbGFibGUgcHJv\nZHVjZXIgPSBuZXcgQ2FsbGFibGUoKSB7CiAgICAgICAgICAgIHB1YmxpYyBP\nYmplY3QgY2FsbCgpIHRocm93cyBKTVNFeGNlcHRpb24sIEludGVycnVwdGVk\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubmVj\ndGlvbiA9IGZhY3RvcnkuY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgICAg\nICAgICAgY29ubmVjdGlvbnMuYWRkKGNvbm5lY3Rpb24pOwogICAgICAgICAg\nICAgICAgU2Vzc2lvbiBzZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNz\naW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAg\nICAgICAgICAgTWVzc2FnZVByb2R1Y2VyIHByb2R1Y2VyID0gc2Vzc2lvbi5j\ncmVhdGVQcm9kdWNlcihkZXN0aW5hdGlvbik7CiAgICAgICAgICAgICAgICBw\ncm9kdWNlci5zZXREZWxpdmVyeU1vZGUoRGVsaXZlcnlNb2RlLk5PTl9QRVJT\nSVNURU5UKTsKICAgICAgICAgICAgICAgIEJ5dGVzTWVzc2FnZSBtZXNzYWdl\nID0gc2Vzc2lvbi5jcmVhdGVCeXRlc01lc3NhZ2UoKTsKICAgICAgICAgICAg\nICAgIG1lc3NhZ2Uud3JpdGVCeXRlcyhuZXcgYnl0ZVsxMDI0XSk7CiAgICAg\nICAgICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CiAgICAgICAgICAgICAg\nICBjb25uZWN0aW9uc0VzdGFibGlzaGVkLnJlbGVhc2UoKTsKCiAgICAgICAg\nICAgICAgICB3aGlsZSAoIXNhbXBsZVRpbWVEb25lLmF3YWl0KDAsIFRpbWVV\nbml0Lk1JTExJU0VDT05EUykpIHsKICAgICAgICAgICAgICAgICAgICBwcm9k\ndWNlci5zZW5kKG1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIHByb2R1\nY2VkTWVzc2FnZXMuaW5jcmVtZW50QW5kR2V0KCk7CiAgICAgICAgICAgICAg\nICB9CgogICAgICAgICAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpOwogICAg\nICAgICAgICAgICAgd29ya2VyRG9uZS5yZWxlYXNlKCk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH07Cgog\nICAgICAgIGZpbmFsIENhbGxhYmxlIGNvbnN1bWVyID0gbmV3IENhbGxhYmxl\nKCkgewogICAgICAgICAgICBwdWJsaWMgT2JqZWN0IGNhbGwoKSB0aHJvd3Mg\nSk1TRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBDb25uZWN0aW9uIGNvbm5lY3Rpb24gPSBmYWN0b3J5LmNyZWF0\nZUNvbm5lY3Rpb24oKTsKICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zLmFk\nZChjb25uZWN0aW9uKTsKICAgICAgICAgICAgICAgIFNlc3Npb24gc2Vzc2lv\nbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5B\nVVRPX0FDS05PV0xFREdFKTsKICAgICAgICAgICAgICAgIE1lc3NhZ2VDb25z\ndW1lciBjb25zdW1lciA9IHNlc3Npb24uY3JlYXRlQ29uc3VtZXIoZGVzdGlu\nYXRpb24pOwoKICAgICAgICAgICAgICAgIGNvbnN1bWVyLnNldE1lc3NhZ2VM\naXN0ZW5lcihuZXcgTWVzc2FnZUxpc3RlbmVyKCkgewogICAgICAgICAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIG9uTWVzc2FnZShNZXNzYWdlIG1zZykgewog\nICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlZE1lc3NhZ2VzLmluY3Jl\nbWVudEFuZEdldCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29ubmVjdGlvbi5zdGFydCgp\nOwoKICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25zRXN0YWJsaXNoZWQucmVs\nZWFzZSgpOwogICAgICAgICAgICAgICAgc2FtcGxlVGltZURvbmUuYXdhaXQo\nKTsKCiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLmNsb3NlKCk7CiAgICAg\nICAgICAgICAgICB3b3JrZXJEb25lLnJlbGVhc2UoKTsKICAgICAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAg\nICAgICAgZmluYWwgVGhyb3dhYmxlIHdvcmtlckVycm9yW10gPSBuZXcgVGhy\nb3dhYmxlWzFdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgUFJPRFVD\nRVJfQ09VTlQ7IGkrKykgewogICAgICAgICAgICBuZXcgVGhyZWFkKCJQcm9k\ndWNlcjoiICsgaSkgewogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVu\nKCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHByb2R1Y2VyLmNhbGwoKTsKICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChUaHJvd2FibGUgZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgICAgICAgICAgICAg\nICAgICB3b3JrZXJFcnJvclswXSA9IGU7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LnN0YXJ0KCk7CiAg\nICAgICAgfQoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IENPTlNVTUVS\nX0NPVU5UOyBpKyspIHsKICAgICAgICAgICAgbmV3IFRocmVhZCgiQ29uc3Vt\nZXI6IiArIGkpIHsKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigp\nIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgICAgICBjb25zdW1lci5jYWxsKCk7CiAgICAgICAgICAgICAgICAgICAg\nfSBjYXRjaCAoVGhyb3dhYmxlIGUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgd29ya2VyRXJyb3JbMF0gPSBlOwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfS5zdGFydCgpOwogICAg\nICAgIH0KCiAgICAgICAgTE9HLmluZm8oZ2V0TmFtZSgpICsgIjogV2FpdGlu\nZyBmb3IgUHJvZHVjZXJzIGFuZCBDb25zdW1lcnMgdG8gc3RhcnR1cC4iKTsK\nICAgICAgICBjb25uZWN0aW9uc0VzdGFibGlzaGVkLmFjcXVpcmUoKTsKICAg\nICAgICBMT0cuaW5mbygiUHJvZHVjZXJzIGFuZCBDb25zdW1lcnMgYXJlIG5v\ndyBydW5uaW5nLiAgV2FpdGluZyBmb3Igc3lzdGVtIHRvIHJlYWNoIHN0ZWFk\neSBzdGF0ZTogIgogICAgICAgICAgICAgICAgICsgKFNBTVBMRV9ERUxBWSAv\nIDEwMDAuMGYpICsgIiBzZWNvbmRzIik7CiAgICAgICAgVGhyZWFkLnNsZWVw\nKDEwMDAgKiAxMCk7CgogICAgICAgIExPRy5pbmZvKCJTdGFydGluZyBzYW1w\nbGU6ICIgKyBTQU1QTEVTICsgIiBlYWNoIGxhc3RpbmcgIiArIChTQU1QTEVf\nRFVSQVRJT04gLyAxMDAwLjBmKSArICIgc2Vjb25kcyIpOwoKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IFNBTVBMRVM7IGkrKykgewoKICAgICAgICAg\nICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICBwcm9kdWNlZE1lc3NhZ2VzLnNldCgwKTsKICAgICAgICAg\nICAgcmVjZWl2ZWRNZXNzYWdlcy5zZXQoMCk7CgogICAgICAgICAgICBUaHJl\nYWQuc2xlZXAoU0FNUExFX0RVUkFUSU9OKTsKCiAgICAgICAgICAgIGxvbmcg\nZW5kID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAg\nIGludCByID0gcmVjZWl2ZWRNZXNzYWdlcy5nZXQoKTsKICAgICAgICAgICAg\naW50IHAgPSBwcm9kdWNlZE1lc3NhZ2VzLmdldCgpOwoKICAgICAgICAgICAg\nTE9HLmluZm8oInB1Ymxpc2hlZDogIiArIHAgKyAiIG1zZ3MgYXQgIiArIChw\nICogMTAwMGYgLyAoZW5kIC0gc3RhcnQpKSArICIgbXNncy9zZWMsICIKICAg\nICAgICAgICAgICAgICAgICAgKyAiY29uc3VtZWQ6ICIgKyByICsgIiBtc2dz\nIGF0ICIgKyAociAqIDEwMDBmIC8gKGVuZCAtIHN0YXJ0KSkgKyAiIG1zZ3Mv\nc2VjIik7CiAgICAgICAgfQoKICAgICAgICBMT0cuaW5mbygiU2FtcGxlIGRv\nbmUuIik7CiAgICAgICAgc2FtcGxlVGltZURvbmUuY291bnREb3duKCk7Cgog\nICAgICAgIHdvcmtlckRvbmUuYWNxdWlyZSgpOwogICAgICAgIGlmICh3b3Jr\nZXJFcnJvclswXSAhPSBudWxsKSB7CiAgICAgICAgICAgIHRocm93IHdvcmtl\nckVycm9yWzBdOwogICAgICAgIH0KCiAgICB9Cgp9Cg==\n","encoding":"base64"}

