{"sha":"36496146654eafde7506438d53f85f762dff51e7","node_id":"MDQ6QmxvYjE1NzU5NTY6MzY0OTYxNDY2NTRlYWZkZTc1MDY0MzhkNTNmODVmNzYyZGZmNTFlNw==","size":6178,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/36496146654eafde7506438d53f85f762dff51e7","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmptcy5EZWJ1Z1V0aWw7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5q\nbXMuc3BpLkhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbDsKaW1wb3J0IGph\ndmEudXRpbC5SYW5kb207CmltcG9ydCBqYXZhLnV0aWwuVmVjdG9yOwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0Y2g7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5TeW5jaHJvbm91c1F1ZXVlOwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGhyZWFkUG9vbEV4ZWN1dG9yOwpp\nbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9ydCBq\nYXZheC5qbXMuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5KTVNFeGNl\ncHRpb247CmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZTsKaW1wb3J0IGphdmF4\nLmptcy5NZXNzYWdlQ29uc3VtZXI7CmltcG9ydCBqYXZheC5qbXMuTWVzc2Fn\nZVByb2R1Y2VyOwppbXBvcnQgamF2YXguam1zLlNlc3Npb247CmltcG9ydCBq\nYXZheC5qbXMuVGV4dE1lc3NhZ2U7CmltcG9ydCBqYXZheC5qbXMuVG9waWM7\nCgpwdWJsaWMgY2xhc3MgSm1zQ29ubmVjdGlvblN0YXJ0U3RvcFRlc3QgZXh0\nZW5kcyBUZXN0U3VwcG9ydCB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nb3JnLmFwYWNoZS5jb21tb25zLmxvZ2dpbmcuTG9nIExPRyA9IG9yZy5hcGFj\naGUuY29tbW9ucy5sb2dnaW5nLkxvZ0ZhY3RvcnkKICAgICAgICAuZ2V0TG9n\nKEptc0Nvbm5lY3Rpb25TdGFydFN0b3BUZXN0LmNsYXNzKTsKCiAgICBwcml2\nYXRlIENvbm5lY3Rpb24gc3RhcnRlZENvbm5lY3Rpb247CiAgICBwcml2YXRl\nIENvbm5lY3Rpb24gc3RvcHBlZENvbm5lY3Rpb247CgogICAgLyoqCiAgICAg\nKiBAc2VlIGp1bml0LmZyYW1ld29yay5UZXN0Q2FzZSNzZXRVcCgpCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CgogICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgTE9HLmluZm8o\nZ2V0Q2xhc3MoKS5nZXRDbGFzc0xvYWRlcigpLmdldFJlc291cmNlKCJsb2c0\nai5wcm9wZXJ0aWVzIikpOwoKICAgICAgICBIZWR3aWdDb25uZWN0aW9uRmFj\ndG9yeUltcGwgZmFjdG9yeSA9IGNyZWF0ZUNvbm5lY3Rpb25GYWN0b3J5KCk7\nCiAgICAgICAgc3RhcnRlZENvbm5lY3Rpb24gPSBmYWN0b3J5LmNyZWF0ZUNv\nbm5lY3Rpb24oKTsKICAgICAgICBzdGFydGVkQ29ubmVjdGlvbi5zdGFydCgp\nOwogICAgICAgIHN0b3BwZWRDb25uZWN0aW9uID0gZmFjdG9yeS5jcmVhdGVD\nb25uZWN0aW9uKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAc2VlIGp1bml0\nLmZyYW1ld29yay5UZXN0Q2FzZSN0ZWFyRG93bigpCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgc3RvcHBlZENvbm5lY3Rpb24uY2xvc2UoKTsKICAgICAgICBzdGFy\ndGVkQ29ubmVjdGlvbi5jbG9zZSgpOwogICAgICAgIHN1cGVyLnRlYXJEb3du\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyBpZiB0aGUgY29uc3Vt\nZXIgcmVjZWl2ZXMgdGhlIG1lc3NhZ2VzIHRoYXQgd2VyZSBzZW50IGJlZm9y\nZSB0aGUKICAgICAqIGNvbm5lY3Rpb24gd2FzIHN0YXJ0ZWQuCiAgICAgKgog\nICAgICogQHRocm93cyBKTVNFeGNlcHRpb24KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgdGVzdFN0b3BwZWRDb25zdW1lckhvbGRzTWVzc2FnZXNUaWxsU3Rh\ncnRlZCgpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIFNlc3Npb24g\nc3RhcnRlZFNlc3Npb24gPSBzdGFydGVkQ29ubmVjdGlvbi5jcmVhdGVTZXNz\naW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAg\nIFNlc3Npb24gc3RvcHBlZFNlc3Npb24gPSBzdG9wcGVkQ29ubmVjdGlvbi5j\ncmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0Up\nOwoKICAgICAgICAvLyBTZXR1cCB0aGUgY29uc3VtZXJzLgogICAgICAgIFRv\ncGljIHRvcGljID0gc3RhcnRlZFNlc3Npb24uY3JlYXRlVG9waWMoInRlc3Qi\nKTsKICAgICAgICBNZXNzYWdlQ29uc3VtZXIgc3RhcnRlZENvbnN1bWVyID0g\nc3RhcnRlZFNlc3Npb24uY3JlYXRlQ29uc3VtZXIodG9waWMpOwogICAgICAg\nIE1lc3NhZ2VDb25zdW1lciBzdG9wcGVkQ29uc3VtZXIgPSBzdG9wcGVkU2Vz\nc2lvbi5jcmVhdGVDb25zdW1lcih0b3BpYyk7CgogICAgICAgIC8vIFNlbmQg\ndGhlIG1lc3NhZ2UuCiAgICAgICAgTWVzc2FnZVByb2R1Y2VyIHByb2R1Y2Vy\nID0gc3RhcnRlZFNlc3Npb24uY3JlYXRlUHJvZHVjZXIodG9waWMpOwogICAg\nICAgIFRleHRNZXNzYWdlIG1lc3NhZ2UgPSBzdGFydGVkU2Vzc2lvbi5jcmVh\ndGVUZXh0TWVzc2FnZSgiSGVsbG8iKTsKICAgICAgICBwcm9kdWNlci5zZW5k\nKG1lc3NhZ2UpOwoKICAgICAgICAvLyBUZXN0IHRoZSBhc3NlcnRpb25zLgog\nICAgICAgIE1lc3NhZ2UgbSA9IHN0YXJ0ZWRDb25zdW1lci5yZWNlaXZlKDEw\nMDApOwogICAgICAgIGFzc2VydE5vdE51bGwobSk7CgogICAgICAgIG0gPSBz\ndG9wcGVkQ29uc3VtZXIucmVjZWl2ZSgxMDAwKTsKICAgICAgICBhc3NlcnRO\ndWxsKG0pOwoKICAgICAgICBzdG9wcGVkQ29ubmVjdGlvbi5zdGFydCgpOwog\nICAgICAgIG0gPSBzdG9wcGVkQ29uc3VtZXIucmVjZWl2ZSg1MDAwKTsKICAg\nICAgICBhc3NlcnROb3ROdWxsKG0pOwoKICAgICAgICBzdGFydGVkU2Vzc2lv\nbi5jbG9zZSgpOwogICAgICAgIHN0b3BwZWRTZXNzaW9uLmNsb3NlKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyBpZiB0aGUgY29uc3VtZXIgaXMg\nYWJsZSB0byByZWNlaXZlIG1lc3NhZ2VzIGV2ZWIgd2hlbiB0aGUKICAgICAq\nIGNvbm5lY2N0aW9uIHJlc3RhcnRzIG11bHRpcGxlIHRpbWVzLgogICAgICoK\nICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHRlc3RNdWx0aXBsZUNvbm5lY3Rpb25TdG9wcygpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIHRlc3RTdG9wcGVkQ29uc3VtZXJIb2xkc01lc3Nh\nZ2VzVGlsbFN0YXJ0ZWQoKTsKICAgICAgICBzdG9wcGVkQ29ubmVjdGlvbi5z\ndG9wKCk7CiAgICAgICAgdGVzdFN0b3BwZWRDb25zdW1lckhvbGRzTWVzc2Fn\nZXNUaWxsU3RhcnRlZCgpOwogICAgICAgIHN0b3BwZWRDb25uZWN0aW9uLnN0\nb3AoKTsKICAgICAgICB0ZXN0U3RvcHBlZENvbnN1bWVySG9sZHNNZXNzYWdl\nc1RpbGxTdGFydGVkKCk7CiAgICB9CgoKICAgIHB1YmxpYyB2b2lkIHRlc3RD\nb25jdXJyZW50U2Vzc2lvbkNyZWF0ZVdpdGhTdGFydCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIFRocmVhZFBvb2xFeGVjdXRvciBleGVjdXRvciA9\nIG5ldyBUaHJlYWRQb29sRXhlY3V0b3IoNTAsIEludGVnZXIuTUFYX1ZBTFVF\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDYwTCwg\nVGltZVVuaXQuU0VDT05EUywKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBuZXcgU3luY2hyb25vdXNRdWV1ZTxSdW5uYWJsZT4oKSk7\nCiAgICAgICAgZmluYWwgVmVjdG9yPFRocm93YWJsZT4gZXhjZXB0aW9ucyA9\nIG5ldyBWZWN0b3I8VGhyb3dhYmxlPigpOwogICAgICAgIGZpbmFsIFJhbmRv\nbSByYW5kID0gbmV3IFJhbmRvbSgpOwogICAgICAgIGZpbmFsIGludCBudW1J\ndGVyYXRpb25zID0gMTAwOwogICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNo\nIGxhdGNoID0gbmV3IENvdW50RG93bkxhdGNoKG51bUl0ZXJhdGlvbnMgKiAy\nKTsKICAgICAgICBSdW5uYWJsZSBjcmVhdGVTZXNzaW9uVGFzayA9IG5ldyBS\ndW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBUaW1l\nVW5pdC5NSUxMSVNFQ09ORFMuc2xlZXAocmFuZC5uZXh0SW50KDEwKSk7CiAg\nICAgICAgICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAgICAgICAg\nICAgICAgICAgICAgc3RvcHBlZENvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihm\nYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAg\nICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAgICAgICAgICBl\neGNlcHRpb25zLmFkZChlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH07CgogICAgICAgIFJ1bm5hYmxlIHN0YXJ0U3RvcFRh\nc2sgPSBuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHJ1bigpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICAgICAgVGltZVVuaXQuTUlMTElTRUNPTkRTLnNsZWVwKHJhbmQubmV4dElu\ndCgxMCkpOwogICAgICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigp\nOwogICAgICAgICAgICAgICAgICAgIHN0b3BwZWRDb25uZWN0aW9uLnN0YXJ0\nKCk7CiAgICAgICAgICAgICAgICAgICAgc3RvcHBlZENvbm5lY3Rpb24uc3Rv\ncCgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAg\nICAgICAgICAgICAgICAgIGV4Y2VwdGlvbnMuYWRkKGUpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPG51bUl0ZXJhdGlvbnM7IGkrKykgewogICAgICAgICAg\nICBleGVjdXRvci5leGVjdXRlKGNyZWF0ZVNlc3Npb25UYXNrKTsKICAgICAg\nICAgICAgZXhlY3V0b3IuZXhlY3V0ZShzdGFydFN0b3BUYXNrKTsKICAgICAg\nICB9CgogICAgICAgIGV4ZWN1dG9yLnNodXRkb3duKCk7CiAgICAgICAgZmlu\nYWwgbG9uZyByZW1haW5pbmc7CiAgICAgICAgewogICAgICAgICAgICBib29s\nZWFuIHRlcm1pbmF0ZWQgPSBleGVjdXRvci5hd2FpdFRlcm1pbmF0aW9uKDMw\nLCBUaW1lVW5pdC5TRUNPTkRTKTsKICAgICAgICAgICAgcmVtYWluaW5nID0g\nbGF0Y2guZ2V0Q291bnQoKTsKICAgICAgICAgICAgaWYgKCF0ZXJtaW5hdGVk\nKXsKICAgICAgICAgICAgICAgIERlYnVnVXRpbC5kdW1wQWxsU3RhY2t0cmFj\nZXMoU3lzdGVtLmVycik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZSgiZXhlY3V0b3IgdGVybWluYXRlZC4gcmVtYWluaW5nIDogIiAr\nIHJlbWFpbmluZywgdGVybWluYXRlZCk7CiAgICAgICAgfQogICAgICAgIGFz\nc2VydFRydWUoInJlbWFpbmluZyA6ICIgKyByZW1haW5pbmcgKyAiLCBubyBl\neGNlcHRpb25zOiAiICsgZXhjZXB0aW9ucywgZXhjZXB0aW9ucy5pc0VtcHR5\nKCkpOwogICAgfQp9Cg==\n","encoding":"base64"}

