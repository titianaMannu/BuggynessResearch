{"sha":"aaf47f2d0ad64e2c6ea314250d293bc95b12d689","node_id":"MDQ6QmxvYjE1NzU5NTY6YWFmNDdmMmQwYWQ2NGUyYzZlYTMxNDI1MGQyOTNiYzk1YjEyZDY4OQ==","size":5944,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/aaf47f2d0ad64e2c6ea314250d293bc95b12d689","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmF4Lmptcy5Ub3Bp\nYzsKaW1wb3J0IGphdmEudXRpbC5WZWN0b3I7CgppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuSm1zVGVzdEJhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5qbXMuc3BpLkhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbDsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQg\namF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5hdG9taWMuQXRvbWljQm9vbGVhbjsKCmltcG9ydCBq\nYXZheC5qbXMuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5EZWxpdmVy\neU1vZGU7CmltcG9ydCBqYXZheC5qbXMuRGVzdGluYXRpb247CmltcG9ydCBq\nYXZheC5qbXMuSk1TRXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLk1lc3Nh\nZ2U7CmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZUNvbnN1bWVyOwppbXBvcnQg\namF2YXguam1zLk1lc3NhZ2VMaXN0ZW5lcjsKaW1wb3J0IGphdmF4Lmptcy5N\nZXNzYWdlUHJvZHVjZXI7CmltcG9ydCBqYXZheC5qbXMuU2Vzc2lvbjsKaW1w\nb3J0IGphdmF4Lmptcy5UZXh0TWVzc2FnZTsKCmltcG9ydCBqdW5pdC5mcmFt\nZXdvcmsuVGVzdENhc2U7CgoKcHVibGljIGNsYXNzIEptc0NvbnN1bWVyUmVz\nZXRBY3RpdmVMaXN0ZW5lclRlc3QgZXh0ZW5kcyBKbXNUZXN0QmFzZSB7Cgog\nICAgcHJpdmF0ZSBDb25uZWN0aW9uIGNvbm5lY3Rpb247CiAgICBwcml2YXRl\nIEhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbCBmYWN0b3J5OwoKICAgIHBy\nb3RlY3RlZCB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgc3VwZXIuc2V0VXAoKTsKICAgICAgICBmYWN0b3J5ID0gbmV3IEhlZHdp\nZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbCgpOwogICAgICAgIGNvbm5lY3Rpb24g\nPSBmYWN0b3J5LmNyZWF0ZUNvbm5lY3Rpb24oKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIGlmIChjb25uZWN0aW9uICE9IG51bGwpIHsKICAgICAgICAgICAgY29u\nbmVjdGlvbi5jbG9zZSgpOwogICAgICAgICAgICBjb25uZWN0aW9uID0gbnVs\nbDsKICAgICAgICB9CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIHZlcmlmeSB0aGUgKHVuZGVmaW5lZCBieSBzcGVj\nKSBiZWhhdmlvdXIgb2Ygc2V0dGluZyBhIGxpc3RlbmVyIHdoaWxlIHJlY2Vp\ndmluZyBhIG1lc3NhZ2UuCiAgICAgKgogICAgICogQHRocm93cyBFeGNlcHRp\nb24KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdFNldExpc3RlbmVyRnJv\nbUxpc3RlbmVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgU2Vzc2lv\nbiBzZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBT\nZXNzaW9uLkNMSUVOVF9BQ0tOT1dMRURHRSk7CiAgICAgICAgRGVzdGluYXRp\nb24gZGVzdCA9IHNlc3Npb24uY3JlYXRlVG9waWMoIlF1ZXVlLSIgKyBnZXRO\nYW1lKCkpOwogICAgICAgIGZpbmFsIE1lc3NhZ2VDb25zdW1lciBjb25zdW1l\nciA9IHNlc3Npb24uY3JlYXRlQ29uc3VtZXIoZGVzdCk7CgogICAgICAgIGZp\nbmFsIENvdW50RG93bkxhdGNoIGxhdGNoID0gbmV3IENvdW50RG93bkxhdGNo\nKDIpOwogICAgICAgIGZpbmFsIEF0b21pY0Jvb2xlYW4gZmlyc3QgPSBuZXcg\nQXRvbWljQm9vbGVhbih0cnVlKTsKICAgICAgICBmaW5hbCBWZWN0b3I8T2Jq\nZWN0PiByZXN1bHRzID0gbmV3IFZlY3RvcjxPYmplY3Q+KCk7CiAgICAgICAg\nY29uc3VtZXIuc2V0TWVzc2FnZUxpc3RlbmVyKG5ldyBNZXNzYWdlTGlzdGVu\nZXIoKSB7CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBvbk1lc3NhZ2UoTWVz\nc2FnZSBtZXNzYWdlKSB7CiAgICAgICAgICAgICAgICBpZiAoZmlyc3QuY29t\ncGFyZUFuZFNldCh0cnVlLCBmYWxzZSkpIHsKICAgICAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdW1lci5zZXRN\nZXNzYWdlTGlzdGVuZXIodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHJlc3VsdHMuYWRkKG1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEpNU0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHJlc3VsdHMuYWRkKGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmVz\ndWx0cy5hZGQobWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBsYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0pOwoKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CgogICAgICAg\nIE1lc3NhZ2VQcm9kdWNlciBwcm9kdWNlciA9IHNlc3Npb24uY3JlYXRlUHJv\nZHVjZXIoZGVzdCk7CiAgICAgICAgcHJvZHVjZXIuc2V0RGVsaXZlcnlNb2Rl\nKERlbGl2ZXJ5TW9kZS5OT05fUEVSU0lTVEVOVCk7CiAgICAgICAgcHJvZHVj\nZXIuc2VuZChzZXNzaW9uLmNyZWF0ZVRleHRNZXNzYWdlKCJGaXJzdCIpKTsK\nICAgICAgICBwcm9kdWNlci5zZW5kKHNlc3Npb24uY3JlYXRlVGV4dE1lc3Nh\nZ2UoIlNlY29uZCIpKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZSgid2UgZGlkIG5v\ndCB0aW1lb3V0IiwgbGF0Y2guYXdhaXQoNSwgVGltZVVuaXQuU0VDT05EUykp\nOwoKICAgICAgICBhc3NlcnRFcXVhbHMoIndlIGhhdmUgYSByZXN1bHQiLCAy\nLCByZXN1bHRzLnNpemUoKSk7CiAgICAgICAgT2JqZWN0IHJlc3VsdCA9IHJl\nc3VsdHMuZ2V0KDApOwogICAgICAgIGFzc2VydFRydWUocmVzdWx0IGluc3Rh\nbmNlb2YgVGV4dE1lc3NhZ2UpOwogICAgICAgIGFzc2VydEVxdWFscygicmVz\ndWx0IGlzIGZpcnN0IiwgIkZpcnN0IiwgKChUZXh0TWVzc2FnZSlyZXN1bHQp\nLmdldFRleHQoKSk7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0cy5nZXQoMSk7\nCiAgICAgICAgYXNzZXJ0VHJ1ZShyZXN1bHQgaW5zdGFuY2VvZiBUZXh0TWVz\nc2FnZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJyZXN1bHQgaXMgZmlyc3Qi\nLCAiU2Vjb25kIiwgKChUZXh0TWVzc2FnZSlyZXN1bHQpLmdldFRleHQoKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBhbmQgYSBsaXN0ZW5lciBvbiBhIG5l\ndyBjb25zdW1lciwganVzdCBpbiBjYXNlLgogICAgICAqCiAgICAgKiBAdGhy\nb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0TmV3\nQ29uc3VtZXJTZXRMaXN0ZW5lckZyb21MaXN0ZW5lcigpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIGZpbmFsIFNlc3Npb24gc2Vzc2lvbiA9IGNvbm5l\nY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5DTElFTlRfQUNL\nTk9XTEVER0UpOwogICAgICAgIGZpbmFsIERlc3RpbmF0aW9uIGRlc3QgPSBz\nZXNzaW9uLmNyZWF0ZVRvcGljKCJRdWV1ZS0iICsgZ2V0TmFtZSgpKTsKICAg\nICAgICBmaW5hbCBNZXNzYWdlQ29uc3VtZXIgY29uc3VtZXIgPSBzZXNzaW9u\nLmNyZWF0ZUNvbnN1bWVyKGRlc3QpOwoKICAgICAgICBmaW5hbCBDb3VudERv\nd25MYXRjaCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgyKTsKICAgICAg\nICBmaW5hbCBBdG9taWNCb29sZWFuIGZpcnN0ID0gbmV3IEF0b21pY0Jvb2xl\nYW4odHJ1ZSk7CiAgICAgICAgZmluYWwgVmVjdG9yPE9iamVjdD4gcmVzdWx0\ncyA9IG5ldyBWZWN0b3I8T2JqZWN0PigpOwogICAgICAgIGNvbnN1bWVyLnNl\ndE1lc3NhZ2VMaXN0ZW5lcihuZXcgTWVzc2FnZUxpc3RlbmVyKCkgewoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgb25NZXNzYWdlKE1lc3NhZ2UgbWVzc2Fn\nZSkgewogICAgICAgICAgICAgICAgaWYgKGZpcnN0LmNvbXBhcmVBbmRTZXQo\ndHJ1ZSwgZmFsc2UpKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZUNvbnN1bWVyIGFub3RoZXJD\nb25zdW1lciA9IHNlc3Npb24uY3JlYXRlQ29uc3VtZXIoZGVzdCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGFub3RoZXJDb25zdW1lci5zZXRNZXNzYWdl\nTGlzdGVuZXIodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3Vs\ndHMuYWRkKG1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKEpNU0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl\nc3VsdHMuYWRkKGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5h\nZGQobWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBsYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0p\nOwoKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CgogICAgICAgIE1lc3Nh\nZ2VQcm9kdWNlciBwcm9kdWNlciA9IHNlc3Npb24uY3JlYXRlUHJvZHVjZXIo\nZGVzdCk7CiAgICAgICAgcHJvZHVjZXIuc2V0RGVsaXZlcnlNb2RlKERlbGl2\nZXJ5TW9kZS5OT05fUEVSU0lTVEVOVCk7CiAgICAgICAgcHJvZHVjZXIuc2Vu\nZChzZXNzaW9uLmNyZWF0ZVRleHRNZXNzYWdlKCJGaXJzdCIpKTsKICAgICAg\nICBwcm9kdWNlci5zZW5kKHNlc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UoIlNl\nY29uZCIpKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZSgid2UgZGlkIG5vdCB0aW1l\nb3V0IiwgbGF0Y2guYXdhaXQoNSwgVGltZVVuaXQuU0VDT05EUykpOwoKICAg\nICAgICBhc3NlcnRFcXVhbHMoIndlIGhhdmUgYSByZXN1bHQiLCAyLCByZXN1\nbHRzLnNpemUoKSk7CiAgICAgICAgT2JqZWN0IHJlc3VsdCA9IHJlc3VsdHMu\nZ2V0KDApOwogICAgICAgIGFzc2VydFRydWUocmVzdWx0IGluc3RhbmNlb2Yg\nVGV4dE1lc3NhZ2UpOwogICAgICAgIGFzc2VydEVxdWFscygicmVzdWx0IGlz\nIGZpcnN0IiwgIkZpcnN0IiwgKChUZXh0TWVzc2FnZSlyZXN1bHQpLmdldFRl\neHQoKSk7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0cy5nZXQoMSk7CiAgICAg\nICAgYXNzZXJ0VHJ1ZShyZXN1bHQgaW5zdGFuY2VvZiBUZXh0TWVzc2FnZSk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJyZXN1bHQgaXMgZmlyc3QiLCAiU2Vj\nb25kIiwgKChUZXh0TWVzc2FnZSlyZXN1bHQpLmdldFRleHQoKSk7CiAgICB9\nCiB9Cg==\n","encoding":"base64"}

