{"sha":"fba706456fdcb2fc0e88bd39de9cddae63a53f38","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmJhNzA2NDU2ZmRjYjJmYzBlODhiZDM5ZGU5Y2RkYWU2M2E1M2YzOA==","size":13592,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fba706456fdcb2fc0e88bd39de9cddae63a53f38","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmF4Lmptcy5Db25u\nZWN0aW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLkptc1Rlc3RCYXNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuam1zLnNwaS5IZWR3aWdDb25u\nZWN0aW9uRmFjdG9yeUltcGw7CmltcG9ydCBqYXZheC5qbXMuRGVsaXZlcnlN\nb2RlOwppbXBvcnQgamF2YXguam1zLkRlc3RpbmF0aW9uOwppbXBvcnQgamF2\nYXguam1zLkpNU0V4Y2VwdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5NZXNzYWdl\nOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2VDb25zdW1lcjsKaW1wb3J0IGph\ndmF4Lmptcy5NZXNzYWdlUHJvZHVjZXI7CmltcG9ydCBqYXZheC5qbXMuU2Vz\nc2lvbjsKaW1wb3J0IGphdmF4Lmptcy5UZXh0TWVzc2FnZTsKaW1wb3J0IGph\ndmF4Lmptcy5Ub3BpYzsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdDsK\naW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0Q2FzZTsKaW1wb3J0IGp1bml0\nLmZyYW1ld29yay5UZXN0U3VpdGU7CgpwdWJsaWMgY2xhc3MgSm1zUmVkZWxp\ndmVyZWRUZXN0IGV4dGVuZHMgSm1zVGVzdEJhc2UgewoKICAgIHByaXZhdGUg\nQ29ubmVjdGlvbiBjb25uZWN0aW9uOwoKICAgIC8qCiAgICAgKiAobm9uLUph\ndmFkb2MpCiAgICAgKgogICAgICogQHNlZSBqdW5pdC5mcmFtZXdvcmsuVGVz\ndENhc2Ujc2V0VXAoKQogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRV\ncCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNldFVwKCk7\nCiAgICAgICAgY29ubmVjdGlvbiA9IGNyZWF0ZUNvbm5lY3Rpb24oKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEBzZWUganVuaXQuZnJhbWV3b3JrLlRlc3RD\nYXNlI3RlYXJEb3duKCkKICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgdGVh\nckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY29ubmVj\ndGlvbiAhPSBudWxsKSB7CiAgICAgICAgICAgIGNvbm5lY3Rpb24uY2xvc2Uo\nKTsKICAgICAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7CiAgICAgICAgfQog\nICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDcmVhdGVzIGEgY29ubmVjdGlvbi4KICAgICAqCiAgICAgKiBAcmV0dXJu\nIGNvbm5lY3Rpb24KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBDb25uZWN0aW9uIGNyZWF0ZUNvbm5lY3Rpb24oKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBIZWR3aWdDb25uZWN0aW9uRmFj\ndG9yeUltcGwgZmFjdG9yeSA9IG5ldyBIZWR3aWdDb25uZWN0aW9uRmFjdG9y\neUltcGwoKTsKICAgICAgICByZXR1cm4gZmFjdG9yeS5jcmVhdGVDb25uZWN0\naW9uKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyBpZiBhIG1lc3Nh\nZ2UgdW5hY2tub3dsZWRnZWQgbWVzc2FnZSBnZXRzIHRvIGJlIHJlc2VudCB3\naGVuIHRoZQogICAgICogc2Vzc2lvbiBpcyBjbG9zZWQgYW5kIHRoZW4gYSBu\nZXcgY29uc3VtZXIgc2Vzc2lvbiBpcyBjcmVhdGVkLgogICAgICoKICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdFRvcGljU2Vzc2lvbkNsb3NlTWFya3NN\nZXNzYWdlUmVkZWxpdmVyZWQoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAg\nICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CgogICAgICAgIFNlc3Npb24gc2Vz\nc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lv\nbi5DTElFTlRfQUNLTk9XTEVER0UpOwogICAgICAgIFRvcGljIHF1ZXVlID0g\nc2Vzc2lvbi5jcmVhdGVUb3BpYygicXVldWUtIiArIGdldE5hbWUoKSk7CiAg\nICAgICAgTWVzc2FnZVByb2R1Y2VyIHByb2R1Y2VyID0gY3JlYXRlUHJvZHVj\nZXIoc2Vzc2lvbiwgcXVldWUpOwogICAgICAgIE1lc3NhZ2VDb25zdW1lciBj\nb25zdW1lciA9IHNlc3Npb24uY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIocXVl\ndWUsICJzdWJzY3JpYmVyLWlkMSIpOwogICAgICAgIHByb2R1Y2VyLnNlbmQo\nY3JlYXRlVGV4dE1lc3NhZ2Uoc2Vzc2lvbikpOwoKICAgICAgICAvLyBDb25z\ndW1lIHRoZSBtZXNzYWdlLi4uCiAgICAgICAgTWVzc2FnZSBtc2cgPSBjb25z\ndW1lci5yZWNlaXZlKDEwMDApOwogICAgICAgIGFzc2VydE5vdE51bGwobXNn\nKTsKICAgICAgICBhc3NlcnRGYWxzZSgiTWVzc2FnZSBzaG91bGQgbm90IGJl\nIHJlZGVsaXZlcmVkLiIsIG1zZy5nZXRKTVNSZWRlbGl2ZXJlZCgpKTsKICAg\nICAgICAvLyBEb24ndCBhY2sgdGhlIG1lc3NhZ2UuCgogICAgICAgIC8vIFJl\nc2V0IHRoZSBzZXNzaW9uLiBUaGlzIHNob3VsZCBjYXVzZSB0aGUgVW5hY2tl\nZCBtZXNzYWdlIHRvIGJlCiAgICAgICAgLy8gcmVkZWxpdmVyZWQuCiAgICAg\nICAgc2Vzc2lvbi5jbG9zZSgpOwogICAgICAgIHNlc3Npb24gPSBjb25uZWN0\naW9uLmNyZWF0ZVNlc3Npb24oZmFsc2UsIFNlc3Npb24uQ0xJRU5UX0FDS05P\nV0xFREdFKTsKCiAgICAgICAgLy8gQXR0ZW1wdCB0byBDb25zdW1lIHRoZSBt\nZXNzYWdlLi4uCiAgICAgICAgY29uc3VtZXIgPSBzZXNzaW9uLmNyZWF0ZUR1\ncmFibGVTdWJzY3JpYmVyKHF1ZXVlLCAic3Vic2NyaWJlci1pZDEiKTsKICAg\nICAgICBtc2cgPSBjb25zdW1lci5yZWNlaXZlKDIwMDApOwogICAgICAgIGFz\nc2VydE5vdE51bGwobXNnKTsKICAgICAgICAvLyBTaW5jZSB3ZSBvbmx5IHNp\nbXVsYXRlIHRoaXMgaW4gcHJvdmlkZXIsIHdlIGNhbm5vdCBkbyB0aGlzIGFj\ncm9zcyBjb25zdW1lcnMgIQogICAgICAgIC8vIGFzc2VydFRydWUoIk1lc3Nh\nZ2Ugc2hvdWxkIGJlIHJlZGVsaXZlcmVkLiIsIG1zZy5nZXRKTVNSZWRlbGl2\nZXJlZCgpKTsKICAgICAgICBtc2cuYWNrbm93bGVkZ2UoKTsKCiAgICAgICAg\nc2Vzc2lvbi5jbG9zZSgpOwogICAgfQoKCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nVG9waWNTZXNzaW9uQ2xvc2VNYXJrc1VuQWNrZWRNZXNzYWdlUmVkZWxpdmVy\nZWQoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBjb25uZWN0aW9u\nLnN0YXJ0KCk7CgogICAgICAgIFNlc3Npb24gc2Vzc2lvbiA9IGNvbm5lY3Rp\nb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5DTElFTlRfQUNLTk9X\nTEVER0UpOwogICAgICAgIFRvcGljIHF1ZXVlID0gc2Vzc2lvbi5jcmVhdGVU\nb3BpYygicXVldWUtIiArIGdldE5hbWUoKSk7CiAgICAgICAgTWVzc2FnZVBy\nb2R1Y2VyIHByb2R1Y2VyID0gY3JlYXRlUHJvZHVjZXIoc2Vzc2lvbiwgcXVl\ndWUpOwogICAgICAgIE1lc3NhZ2VDb25zdW1lciBjb25zdW1lciA9IHNlc3Np\nb24uY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIocXVldWUsICJzdWJzY3JpYmVy\nLWlkMiIpOwogICAgICAgIHByb2R1Y2VyLnNlbmQoY3JlYXRlVGV4dE1lc3Nh\nZ2Uoc2Vzc2lvbiwgIjEiKSk7CiAgICAgICAgcHJvZHVjZXIuc2VuZChjcmVh\ndGVUZXh0TWVzc2FnZShzZXNzaW9uLCAiMiIpKTsKCiAgICAgICAgLy8gQ29u\nc3VtZSB0aGUgbWVzc2FnZS4uLgogICAgICAgIE1lc3NhZ2UgbXNnID0gY29u\nc3VtZXIucmVjZWl2ZSgxMDAwKTsKICAgICAgICBhc3NlcnROb3ROdWxsKG1z\nZyk7CiAgICAgICAgYXNzZXJ0RmFsc2UoIk1lc3NhZ2Ugc2hvdWxkIG5vdCBi\nZSByZWRlbGl2ZXJlZC4iLCBtc2cuZ2V0Sk1TUmVkZWxpdmVyZWQoKSk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKCIxIiwgKChUZXh0TWVzc2FnZSltc2cpLmdl\ndFRleHQoKSk7CiAgICAgICAgbXNnLmFja25vd2xlZGdlKCk7CgogICAgICAg\nIC8vIERvbid0IGFjayB0aGUgbWVzc2FnZS4KICAgICAgICBtc2cgPSBjb25z\ndW1lci5yZWNlaXZlKDEwMDApOwogICAgICAgIGFzc2VydE5vdE51bGwobXNn\nKTsKICAgICAgICBhc3NlcnRGYWxzZSgiTWVzc2FnZSBzaG91bGQgbm90IGJl\nIHJlZGVsaXZlcmVkLiIsIG1zZy5nZXRKTVNSZWRlbGl2ZXJlZCgpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoIjIiLCAoKFRleHRNZXNzYWdlKW1zZykuZ2V0\nVGV4dCgpKTsKCiAgICAgICAgLy8gUmVzZXQgdGhlIHNlc3Npb24uIFRoaXMg\nc2hvdWxkIGNhdXNlIHRoZSBVbmFja2VkIG1lc3NhZ2UgdG8gYmUKICAgICAg\nICAvLyByZWRlbGl2ZXJlZC4KICAgICAgICBzZXNzaW9uLmNsb3NlKCk7CiAg\nICAgICAgc2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxz\nZSwgU2Vzc2lvbi5DTElFTlRfQUNLTk9XTEVER0UpOwoKICAgICAgICAvLyBB\ndHRlbXB0IHRvIENvbnN1bWUgdGhlIG1lc3NhZ2UuLi4KICAgICAgICBjb25z\ndW1lciA9IHNlc3Npb24uY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIocXVldWUs\nICJzdWJzY3JpYmVyLWlkMiIpOwogICAgICAgIG1zZyA9IGNvbnN1bWVyLnJl\nY2VpdmUoMjAwMCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChtc2cpOwogICAg\nICAgIGFzc2VydEVxdWFscygiMiIsICgoVGV4dE1lc3NhZ2UpbXNnKS5nZXRU\nZXh0KCkpOwogICAgICAgIC8vIFNpbmNlIHdlIG9ubHkgc2ltdWxhdGUgdGhp\ncyBpbiBwcm92aWRlciwgd2UgY2Fubm90IGRvIHRoaXMgYWNyb3NzIGNvbnN1\nbWVycyAhCiAgICAgICAgLy8gYXNzZXJ0VHJ1ZSgiTWVzc2FnZSBzaG91bGQg\nYmUgcmVkZWxpdmVyZWQuIiwgbXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwog\nICAgICAgIG1zZy5hY2tub3dsZWRnZSgpOwoKICAgICAgICBzZXNzaW9uLmNs\nb3NlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyBzZXNzaW9uIHJl\nY292ZXJ5IGFuZCB0aGF0IHRoZSByZWRlbGl2ZXJlZCBtZXNzYWdlIGlzIG1h\ncmtlZCBhcwogICAgICogc3VjaC4gU2Vzc2lvbiB1c2VzIGNsaWVudCBhY2tu\nb3dsZWRnZW1lbnQsIHRoZSBkZXN0aW5hdGlvbiBpcyBhIHF1ZXVlLgogICAg\nICoKICAgICAqIEB0aHJvd3MgSk1TRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHRlc3RUb3BpY1JlY292ZXJNYXJrc01lc3NhZ2VSZWRlbGl2\nZXJlZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGNvbm5lY3Rpb24u\nc2V0Q2xpZW50SUQoZ2V0TmFtZSgpKTsKICAgICAgICBjb25uZWN0aW9uLnN0\nYXJ0KCk7CgogICAgICAgIFNlc3Npb24gc2Vzc2lvbiA9IGNvbm5lY3Rpb24u\nY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5DTElFTlRfQUNLTk9XTEVE\nR0UpOwogICAgICAgIFRvcGljIHF1ZXVlID0gc2Vzc2lvbi5jcmVhdGVUb3Bp\nYygicXVldWUtIiArIGdldE5hbWUoKSk7CiAgICAgICAgTWVzc2FnZVByb2R1\nY2VyIHByb2R1Y2VyID0gY3JlYXRlUHJvZHVjZXIoc2Vzc2lvbiwgcXVldWUp\nOwogICAgICAgIE1lc3NhZ2VDb25zdW1lciBjb25zdW1lciA9IHNlc3Npb24u\nY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIocXVldWUsIGdldE5hbWUoKSArICIg\nLSBzdWJzY3JpYmVyIik7CiAgICAgICAgcHJvZHVjZXIuc2VuZChjcmVhdGVU\nZXh0TWVzc2FnZShzZXNzaW9uKSk7CgogICAgICAgIC8vIENvbnN1bWUgdGhl\nIG1lc3NhZ2UuLi4KICAgICAgICBNZXNzYWdlIG1zZyA9IGNvbnN1bWVyLnJl\nY2VpdmUoMTAwMCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChtc2cpOwogICAg\nICAgIGFzc2VydEZhbHNlKCJNZXNzYWdlIHNob3VsZCBub3QgYmUgcmVkZWxp\ndmVyZWQuIiwgbXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwogICAgICAgIC8v\nIERvbid0IGFjayB0aGUgbWVzc2FnZS4KCiAgICAgICAgLy8gV2UgRE8gTk9U\nIHN1cHBvcnQgc2Vzc2lvbiByZWNvdmVyeQogICAgICAgIC8vIC0gdG8gdW5i\nbG9jayB0aGlzIHRlc3QsIEkgYW0gc3RvcHAnaW5nIGFuZCBzdGFydCdpbmcg\nY29ubmVjdGlvbiA6IG5vdCB0aGUgc2FtZSwgYnV0IC4uLgogICAgICAgIC8v\nIFJlc2V0IHRoZSBzZXNzaW9uLiBUaGlzIHNob3VsZCBjYXVzZSB0aGUgVW5h\nY2tlZCBtZXNzYWdlIHRvIGJlCiAgICAgICAgLy8gcmVkZWxpdmVyZWQuCiAg\nICAgICAgLy8gc2Vzc2lvbi5yZWNvdmVyKCk7CiAgICAgICAgY29ubmVjdGlv\nbi5jbG9zZSgpOwogICAgICAgIGNvbm5lY3Rpb24gPSBjcmVhdGVDb25uZWN0\naW9uKCk7CiAgICAgICAgY29ubmVjdGlvbi5zZXRDbGllbnRJRChnZXROYW1l\nKCkpOwogICAgICAgIHNlc3Npb24gPSBjb25uZWN0aW9uLmNyZWF0ZVNlc3Np\nb24oZmFsc2UsIFNlc3Npb24uQ0xJRU5UX0FDS05PV0xFREdFKTsKICAgICAg\nICBjb25zdW1lciA9IHNlc3Npb24uY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIo\ncXVldWUsIGdldE5hbWUoKSArICIgLSBzdWJzY3JpYmVyIik7CiAgICAgICAg\nY29ubmVjdGlvbi5zdGFydCgpOwoKICAgICAgICAvLyBBdHRlbXB0IHRvIENv\nbnN1bWUgdGhlIG1lc3NhZ2UuLi4KICAgICAgICBtc2cgPSBjb25zdW1lci5y\nZWNlaXZlKDIwMDApOwogICAgICAgIGFzc2VydE5vdE51bGwobXNnKTsKICAg\nICAgICAvLyBhc3NlcnRUcnVlKCJNZXNzYWdlIHNob3VsZCBiZSByZWRlbGl2\nZXJlZC4iLCBtc2cuZ2V0Sk1TUmVkZWxpdmVyZWQoKSk7CiAgICAgICAgbXNn\nLmFja25vd2xlZGdlKCk7CgogICAgICAgIHNlc3Npb24uY2xvc2UoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRlc3RzIHJvbGxiYWNrIG1lc3NhZ2UgdG8g\nYmUgbWFya2VkIGFzIHJlZGVsaXZlcmVkLiBTZXNzaW9uIHVzZXMgY2xpZW50\nCiAgICAgKiBhY2tub3dsZWRnZW1lbnQgYW5kIHRoZSBkZXN0aW5hdGlvbiBp\ncyBhIHF1ZXVlLgogICAgICoKICAgICAqIEB0aHJvd3MgSk1TRXhjZXB0aW9u\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RUb3BpY1JvbGxiYWNrTWFy\na3NNZXNzYWdlUmVkZWxpdmVyZWQoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsK\nICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CgogICAgICAgIFNlc3Npb24g\nc2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbih0cnVlLCBTZXNz\naW9uLkNMSUVOVF9BQ0tOT1dMRURHRSk7CiAgICAgICAgVG9waWMgcXVldWUg\nPSBzZXNzaW9uLmNyZWF0ZVRvcGljKCJxdWV1ZS0iICsgZ2V0TmFtZSgpKTsK\nICAgICAgICBNZXNzYWdlUHJvZHVjZXIgcHJvZHVjZXIgPSBjcmVhdGVQcm9k\ndWNlcihzZXNzaW9uLCBxdWV1ZSk7CiAgICAgICAgTWVzc2FnZUNvbnN1bWVy\nIGNvbnN1bWVyID0gc2Vzc2lvbi5jcmVhdGVDb25zdW1lcihxdWV1ZSk7CiAg\nICAgICAgcHJvZHVjZXIuc2VuZChjcmVhdGVUZXh0TWVzc2FnZShzZXNzaW9u\nKSk7CiAgICAgICAgc2Vzc2lvbi5jb21taXQoKTsKCiAgICAgICAgLy8gR2V0\nIHRoZSBtZXNzYWdlLi4uIFNob3VsZCBub3QgYmUgcmVkZWxpdmVyZWQuCiAg\nICAgICAgTWVzc2FnZSBtc2cgPSBjb25zdW1lci5yZWNlaXZlKDEwMDApOwog\nICAgICAgIGFzc2VydE5vdE51bGwobXNnKTsKICAgICAgICBhc3NlcnRGYWxz\nZSgiTWVzc2FnZSBzaG91bGQgbm90IGJlIHJlZGVsaXZlcmVkLiIsIG1zZy5n\nZXRKTVNSZWRlbGl2ZXJlZCgpKTsKCiAgICAgICAgLy8gUm9sbGJhY2suLiBz\naG91bGQgY2F1c2UgcmVkZWxpdmVyeS4KICAgICAgICBzZXNzaW9uLnJvbGxi\nYWNrKCk7CgogICAgICAgIC8vIEF0dGVtcHQgdG8gQ29uc3VtZSB0aGUgbWVz\nc2FnZS4uLgogICAgICAgIG1zZyA9IGNvbnN1bWVyLnJlY2VpdmUoMjAwMCk7\nCiAgICAgICAgYXNzZXJ0Tm90TnVsbChtc2cpOwogICAgICAgIGFzc2VydFRy\ndWUoIk1lc3NhZ2Ugc2hvdWxkIGJlIHJlZGVsaXZlcmVkLiIsIG1zZy5nZXRK\nTVNSZWRlbGl2ZXJlZCgpKTsKCiAgICAgICAgc2Vzc2lvbi5jb21taXQoKTsK\nICAgICAgICBzZXNzaW9uLmNsb3NlKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUZXN0cyBpZiB0aGUgbWVzc2FnZSBnZXRzIHRvIGJlIHJlLWRlbGl2ZXJl\nZCB3aGVuIHRoZSBzZXNzaW9uIGNsb3NlcyBhbmQKICAgICAqIHRoYXQgdGhl\nIHJlLWRlbGl2ZXJlZCBtZXNzYWdlIGlzIG1hcmtlZCBhcyBzdWNoLiBTZXNz\naW9uIHVzZXMgY2xpZW50CiAgICAgKiBhY2tub3dsZWRnbWVudCwgdGhlIGRl\nc3RpbmF0aW9uIGlzIGEgdG9waWMgYW5kIHRoZSBjb25zdW1lciBpcyBhIGR1\ncmFibGUKICAgICAqIHN1YnNjcmliZXIuCiAgICAgKgogICAgICogQHRocm93\ncyBKTVNFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdER1\ncmFibGVUb3BpY1Nlc3Npb25DbG9zZU1hcmtzTWVzc2FnZVJlZGVsaXZlcmVk\nKCkgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7CiAgICAgICAgY29ubmVjdGlvbi5z\nZXRDbGllbnRJRChnZXROYW1lKCkpOwogICAgICAgIGNvbm5lY3Rpb24uc3Rh\ncnQoKTsKCiAgICAgICAgU2Vzc2lvbiBzZXNzaW9uID0gY29ubmVjdGlvbi5j\ncmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkNMSUVOVF9BQ0tOT1dMRURH\nRSk7CiAgICAgICAgVG9waWMgdG9waWMgPSBzZXNzaW9uLmNyZWF0ZVRvcGlj\nKCJ0b3BpYy0iICsgZ2V0TmFtZSgpKTsKICAgICAgICBNZXNzYWdlQ29uc3Vt\nZXIgY29uc3VtZXIgPSBzZXNzaW9uLmNyZWF0ZUR1cmFibGVTdWJzY3JpYmVy\nKHRvcGljLCAic3ViMSIpOwoKICAgICAgICAvLyBUaGlzIGNhc2Ugb25seSB3\nb3JrcyB3aXRoIHBlcnNpc3RlbnQgbWVzc2FnZXMgc2luY2UgdHJhbnNpZW50\nCiAgICAgICAgLy8gbWVzc2FnZXMKICAgICAgICAvLyBhcmUgZHJvcHBlZCB3\naGVuIHRoZSBjb25zdW1lciBnb2VzIG9mZmxpbmUuCiAgICAgICAgTWVzc2Fn\nZVByb2R1Y2VyIHByb2R1Y2VyID0gc2Vzc2lvbi5jcmVhdGVQcm9kdWNlcih0\nb3BpYyk7CiAgICAgICAgcHJvZHVjZXIuc2V0RGVsaXZlcnlNb2RlKERlbGl2\nZXJ5TW9kZS5QRVJTSVNURU5UKTsKICAgICAgICBwcm9kdWNlci5zZW5kKGNy\nZWF0ZVRleHRNZXNzYWdlKHNlc3Npb24pKTsKCiAgICAgICAgLy8gQ29uc3Vt\nZSB0aGUgbWVzc2FnZS4uLgogICAgICAgIE1lc3NhZ2UgbXNnID0gY29uc3Vt\nZXIucmVjZWl2ZSgxMDAwKTsKICAgICAgICBhc3NlcnROb3ROdWxsKG1zZyk7\nCiAgICAgICAgYXNzZXJ0RmFsc2UoIk1lc3NhZ2Ugc2hvdWxkIG5vdCBiZSBy\nZS1kZWxpdmVyZWQuIiwgbXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwogICAg\nICAgIC8vIERvbid0IGFjayB0aGUgbWVzc2FnZS4KCiAgICAgICAgLy8gUmVz\nZXQgdGhlIHNlc3Npb24uIFRoaXMgc2hvdWxkIGNhdXNlIHRoZSBVbmFja2Vk\nIG1lc3NhZ2UgdG8gYmUKICAgICAgICAvLyByZS1kZWxpdmVyZWQuCiAgICAg\nICAgc2Vzc2lvbi5jbG9zZSgpOwogICAgICAgIHNlc3Npb24gPSBjb25uZWN0\naW9uLmNyZWF0ZVNlc3Npb24oZmFsc2UsIFNlc3Npb24uQ0xJRU5UX0FDS05P\nV0xFREdFKTsKCiAgICAgICAgLy8gQXR0ZW1wdCB0byBDb25zdW1lIHRoZSBt\nZXNzYWdlLi4uCiAgICAgICAgY29uc3VtZXIgPSBzZXNzaW9uLmNyZWF0ZUR1\ncmFibGVTdWJzY3JpYmVyKHRvcGljLCAic3ViMSIpOwogICAgICAgIG1zZyA9\nIGNvbnN1bWVyLnJlY2VpdmUoMjAwMCk7CiAgICAgICAgYXNzZXJ0Tm90TnVs\nbChtc2cpOwogICAgICAgIC8vIFNpbmNlIHdlIG9ubHkgc2ltdWxhdGUgdGhp\ncyBpbiBwcm92aWRlciwgd2UgY2Fubm90IGRvIHRoaXMgYWNyb3NzIGNvbnN1\nbWVycyAhCiAgICAgICAgLy8gYXNzZXJ0VHJ1ZSgiTWVzc2FnZSBzaG91bGQg\nYmUgcmVkZWxpdmVyZWQuIiwgbXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwog\nICAgICAgIG1zZy5hY2tub3dsZWRnZSgpOwoKICAgICAgICBzZXNzaW9uLmNs\nb3NlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyByb2xsYmFjayBt\nZXNzYWdlIHRvIGJlIG1hcmtlZCBhcyByZWRlbGl2ZXJlZC4gU2Vzc2lvbiB1\nc2VzIGNsaWVudAogICAgICogYWNrbm93bGVkZ2VtZW50IGFuZCB0aGUgZGVz\ndGluYXRpb24gaXMgYSB0b3BpYy4KICAgICAqCiAgICAgKiBAdGhyb3dzIEpN\nU0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0RHVyYWJs\nZVRvcGljUm9sbGJhY2tNYXJrc01lc3NhZ2VSZWRlbGl2ZXJlZCgpIHRocm93\ncyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmIChudWxsID09IGNvbm5lY3Rp\nb24uZ2V0Q2xpZW50SUQoKSkgY29ubmVjdGlvbi5zZXRDbGllbnRJRChnZXRO\nYW1lKCkpOwogICAgICAgIGNvbm5lY3Rpb24uc3RhcnQoKTsKCiAgICAgICAg\nU2Vzc2lvbiBzZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKHRy\ndWUsIFNlc3Npb24uQ0xJRU5UX0FDS05PV0xFREdFKTsKICAgICAgICBUb3Bp\nYyB0b3BpYyA9IHNlc3Npb24uY3JlYXRlVG9waWMoInRvcGljLSIgKyBnZXRO\nYW1lKCkpOwogICAgICAgIE1lc3NhZ2VDb25zdW1lciBjb25zdW1lciA9IHNl\nc3Npb24uY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIodG9waWMsICJzdWIxIik7\nCgogICAgICAgIE1lc3NhZ2VQcm9kdWNlciBwcm9kdWNlciA9IGNyZWF0ZVBy\nb2R1Y2VyKHNlc3Npb24sIHRvcGljKTsKICAgICAgICBwcm9kdWNlci5zZW5k\nKGNyZWF0ZVRleHRNZXNzYWdlKHNlc3Npb24pKTsKICAgICAgICBzZXNzaW9u\nLmNvbW1pdCgpOwoKICAgICAgICAvLyBHZXQgdGhlIG1lc3NhZ2UuLi4gU2hv\ndWxkIG5vdCBiZSByZWRlbGl2ZXJlZC4KICAgICAgICBNZXNzYWdlIG1zZyA9\nIGNvbnN1bWVyLnJlY2VpdmUoMTAwMCk7CiAgICAgICAgYXNzZXJ0Tm90TnVs\nbChtc2cpOwogICAgICAgIGFzc2VydEZhbHNlKCJNZXNzYWdlIHNob3VsZCBu\nb3QgYmUgcmVkZWxpdmVyZWQuIiwgbXNnLmdldEpNU1JlZGVsaXZlcmVkKCkp\nOwoKICAgICAgICAvLyBSb2xsYmFjay4uIHNob3VsZCBjYXVzZSByZWRlbGl2\nZXJ5LgogICAgICAgIHNlc3Npb24ucm9sbGJhY2soKTsKCiAgICAgICAgLy8g\nQXR0ZW1wdCB0byBDb25zdW1lIHRoZSBtZXNzYWdlLi4uCiAgICAgICAgbXNn\nID0gY29uc3VtZXIucmVjZWl2ZSgyMDAwKTsKICAgICAgICBhc3NlcnROb3RO\ndWxsKG1zZyk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiTWVzc2FnZSBzaG91bGQg\nYmUgcmVkZWxpdmVyZWQuIiwgbXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwoK\nICAgICAgICBzZXNzaW9uLmNvbW1pdCgpOwogICAgICAgIHNlc3Npb24uY2xv\nc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSB0ZXh0IG1l\nc3NhZ2UuCiAgICAgKgogICAgICogQHBhcmFtIHNlc3Npb24KICAgICAqIEBy\nZXR1cm4gVGV4dE1lc3NhZ2UuCiAgICAgKiBAdGhyb3dzIEpNU0V4Y2VwdGlv\nbgogICAgICovCiAgICBwcml2YXRlIFRleHRNZXNzYWdlIGNyZWF0ZVRleHRN\nZXNzYWdlKFNlc3Npb24gc2Vzc2lvbikgdGhyb3dzIEpNU0V4Y2VwdGlvbiB7\nCiAgICAgICAgcmV0dXJuIGNyZWF0ZVRleHRNZXNzYWdlKHNlc3Npb24sICJI\nZWxsbyIpOwogICAgfQoKICAgIHByaXZhdGUgVGV4dE1lc3NhZ2UgY3JlYXRl\nVGV4dE1lc3NhZ2UoU2Vzc2lvbiBzZXNzaW9uLCBTdHJpbmcgdHh0KSB0aHJv\nd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gc2Vzc2lvbi5jcmVh\ndGVUZXh0TWVzc2FnZSh0eHQpOwogICAgfQoKICAgIC8qKgogICAgICogQ3Jl\nYXRlcyBhIHByb2R1Y2VyLgogICAgICoKICAgICAqIEBwYXJhbSBzZXNzaW9u\nCiAgICAgKiBAcGFyYW0gcXVldWUgLSBkZXN0aW5hdGlvbi4KICAgICAqIEBy\nZXR1cm4gTWVzc2FnZVByb2R1Y2VyCiAgICAgKiBAdGhyb3dzIEpNU0V4Y2Vw\ndGlvbgogICAgICovCiAgICBwcml2YXRlIE1lc3NhZ2VQcm9kdWNlciBjcmVh\ndGVQcm9kdWNlcihTZXNzaW9uIHNlc3Npb24sIERlc3RpbmF0aW9uIHF1ZXVl\nKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBNZXNzYWdlUHJvZHVj\nZXIgcHJvZHVjZXIgPSBzZXNzaW9uLmNyZWF0ZVByb2R1Y2VyKHF1ZXVlKTsK\nICAgICAgICBwcm9kdWNlci5zZXREZWxpdmVyeU1vZGUoZ2V0RGVsaXZlcnlN\nb2RlKCkpOwogICAgICAgIHJldHVybiBwcm9kdWNlcjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybnMgZGVsaXZlcnkgbW9kZS4KICAgICAqCiAgICAg\nKiBAcmV0dXJuIGludCAtIHBlcnNpc3RlbnQgZGVsaXZlcnkgbW9kZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGludCBnZXREZWxpdmVyeU1vZGUoKSB7CiAg\nICAgICAgcmV0dXJuIERlbGl2ZXJ5TW9kZS5QRVJTSVNURU5UOwogICAgfQoK\nICAgIC8qKgogICAgICogUnVuIHRoZSBKbXNSZWRlbGl2ZXJUZXN0IHdpdGgg\ndGhlIGRlbGl2ZXJ5IG1vZGUgc2V0IGFzIHBlcnNpc3RlbnQuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgY2xhc3MgUGVyc2lzdGVudENhc2Ug\nZXh0ZW5kcyBKbXNSZWRlbGl2ZXJlZFRlc3QgewoKICAgICAgICAvKioKICAg\nICAgICAgKiBSZXR1cm5zIGRlbGl2ZXJ5IG1vZGUuCiAgICAgICAgICoKICAg\nICAgICAgKiBAcmV0dXJuIGludCAtIHBlcnNpc3RlbnQgZGVsaXZlcnkgbW9k\nZS4KICAgICAgICAgKi8KICAgICAgICBwcm90ZWN0ZWQgaW50IGdldERlbGl2\nZXJ5TW9kZSgpIHsKICAgICAgICAgICAgcmV0dXJuIERlbGl2ZXJ5TW9kZS5Q\nRVJTSVNURU5UOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJ1\nbiB0aGUgSm1zUmVkZWxpdmVyVGVzdCB3aXRoIHRoZSBkZWxpdmVyeSBtb2Rl\nIHNldCBhcyBub24tcGVyc2lzdGVudC4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBjbGFzcyBUcmFuc2llbnRDYXNlIGV4dGVuZHMgSm1zUmVk\nZWxpdmVyZWRUZXN0IHsKCiAgICAgICAgLyoqCiAgICAgICAgICogUmV0dXJu\ncyBkZWxpdmVyeSBtb2RlLgogICAgICAgICAqCiAgICAgICAgICogQHJldHVy\nbiBpbnQgLSBub24tcGVyc2lzdGVudCBkZWxpdmVyeSBtb2RlLgogICAgICAg\nICAqLwogICAgICAgIHByb3RlY3RlZCBpbnQgZ2V0RGVsaXZlcnlNb2RlKCkg\newogICAgICAgICAgICByZXR1cm4gRGVsaXZlcnlNb2RlLk5PTl9QRVJTSVNU\nRU5UOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIFRlc3Qg\nc3VpdGUoKSB7CiAgICAgICAgVGVzdFN1aXRlIHN1aXRlID0gbmV3IFRlc3RT\ndWl0ZSgpOwogICAgICAgIHN1aXRlLmFkZFRlc3RTdWl0ZShQZXJzaXN0ZW50\nQ2FzZS5jbGFzcyk7CiAgICAgICAgc3VpdGUuYWRkVGVzdFN1aXRlKFRyYW5z\naWVudENhc2UuY2xhc3MpOwogICAgICAgIHJldHVybiBzdWl0ZTsKICAgIH0K\nfQo=\n","encoding":"base64"}

