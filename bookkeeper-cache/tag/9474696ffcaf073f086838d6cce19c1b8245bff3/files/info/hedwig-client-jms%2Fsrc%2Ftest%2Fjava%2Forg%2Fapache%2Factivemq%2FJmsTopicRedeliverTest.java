{"sha":"ac25e58e066bd54e8f2b6b32db71fbf8b0757886","node_id":"MDQ6QmxvYjE1NzU5NTY6YWMyNWU1OGUwNjZiZDU0ZThmMmI2YjMyZGI3MWZiZjhiMDc1Nzg4Ng==","size":6357,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ac25e58e066bd54e8f2b6b32db71fbf8b0757886","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmF4Lmptcy5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YXguam1zLkRlc3RpbmF0aW9uOwppbXBvcnQg\namF2YXguam1zLkpNU0V4Y2VwdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5NZXNz\nYWdlOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2VDb25zdW1lcjsKaW1wb3J0\nIGphdmF4Lmptcy5NZXNzYWdlUHJvZHVjZXI7CmltcG9ydCBqYXZheC5qbXMu\nU2Vzc2lvbjsKaW1wb3J0IGphdmF4Lmptcy5UZXh0TWVzc2FnZTsKaW1wb3J0\nIGphdmF4Lmptcy5Ub3BpYzsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5q\nbXMuc3BpLkhlZHdpZ0Nvbm5lY3Rpb25JbXBsOwppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKcHVi\nbGljIGNsYXNzIEptc1RvcGljUmVkZWxpdmVyVGVzdCBleHRlbmRzIFRlc3RT\ndXBwb3J0IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9H\nID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSm1zVG9waWNSZWRlbGl2ZXJU\nZXN0LmNsYXNzKTsKCiAgICBwcm90ZWN0ZWQgQ29ubmVjdGlvbiBjb25uZWN0\naW9uOwogICAgcHJvdGVjdGVkIFNlc3Npb24gc2Vzc2lvbjsKICAgIHByb3Rl\nY3RlZCBTZXNzaW9uIGNvbnN1bWVTZXNzaW9uOwogICAgcHJvdGVjdGVkIE1l\nc3NhZ2VDb25zdW1lciBjb25zdW1lcjsKICAgIHByb3RlY3RlZCBNZXNzYWdl\nUHJvZHVjZXIgcHJvZHVjZXI7CiAgICBwcm90ZWN0ZWQgRGVzdGluYXRpb24g\nY29uc3VtZXJEZXN0aW5hdGlvbjsKICAgIHByb3RlY3RlZCBEZXN0aW5hdGlv\nbiBwcm9kdWNlckRlc3RpbmF0aW9uOwogICAgcHJvdGVjdGVkIGJvb2xlYW4g\ndG9waWMgPSB0cnVlOwogICAgcHJvdGVjdGVkIGJvb2xlYW4gZHVyYWJsZSA9\nIHRydWU7CiAgICBwcm90ZWN0ZWQgYm9vbGVhbiB2ZXJib3NlOwogICAgLy8g\naGFyZGNvZGVkIHRvIHNvbWUgcmFuZG9tIGRlZmF1bHQuCiAgICBwcm90ZWN0\nZWQgbG9uZyBpbml0UmVkZWxpdmVyeURlbGF5ID0gMTAwMEw7CgogICAgcHJv\ndGVjdGVkIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBzdXBlci5zZXRVcCgpOwoKICAgICAgICBjb25uZWN0aW9uRmFjdG9yeSA9\nIGNyZWF0ZUNvbm5lY3Rpb25GYWN0b3J5KCk7CiAgICAgICAgY29ubmVjdGlv\nbiA9IGNyZWF0ZUNvbm5lY3Rpb24oKTsKCiAgICAgICAgaWYgKGR1cmFibGUg\nJiYgbnVsbCA9PSBjb25uZWN0aW9uLmdldENsaWVudElEKCkpIHsKICAgICAg\nICAgICAgY29ubmVjdGlvbi5zZXRDbGllbnRJRChnZXRDbGFzcygpLmdldE5h\nbWUoKSk7CiAgICAgICAgfQoKICAgICAgICBMT0cuaW5mbygiQ3JlYXRlZCBj\nb25uZWN0aW9uOiAiICsgY29ubmVjdGlvbik7CgogICAgICAgIHNlc3Npb24g\nPSBjb25uZWN0aW9uLmNyZWF0ZVNlc3Npb24oZmFsc2UsIFNlc3Npb24uQ0xJ\nRU5UX0FDS05PV0xFREdFKTsKICAgICAgICBjb25zdW1lU2Vzc2lvbiA9IGNv\nbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5DTElFTlRf\nQUNLTk9XTEVER0UpOwoKICAgICAgICBMT0cuaW5mbygiQ3JlYXRlZCBzZXNz\naW9uOiAiICsgc2Vzc2lvbik7CiAgICAgICAgTE9HLmluZm8oIkNyZWF0ZWQg\nY29uc3VtZVNlc3Npb246ICIgKyBjb25zdW1lU2Vzc2lvbik7CiAgICAgICAg\ncHJvZHVjZXIgPSBzZXNzaW9uLmNyZWF0ZVByb2R1Y2VyKG51bGwpOwogICAg\nICAgIC8vIHByb2R1Y2VyLnNldERlbGl2ZXJ5TW9kZShkZWxpdmVyeU1vZGUp\nOwoKICAgICAgICBMT0cuaW5mbygiQ3JlYXRlZCBwcm9kdWNlcjogIiArIHBy\nb2R1Y2VyKTsKCiAgICAgICAgaWYgKHRvcGljKSB7CiAgICAgICAgICAgIGNv\nbnN1bWVyRGVzdGluYXRpb24gPSBzZXNzaW9uLmNyZWF0ZVRvcGljKGdldENv\nbnN1bWVyU3ViamVjdCgpKTsKICAgICAgICAgICAgcHJvZHVjZXJEZXN0aW5h\ndGlvbiA9IHNlc3Npb24uY3JlYXRlVG9waWMoZ2V0UHJvZHVjZXJTdWJqZWN0\nKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN1bWVyRGVz\ndGluYXRpb24gPSBzZXNzaW9uLmNyZWF0ZVRvcGljKGdldENvbnN1bWVyU3Vi\namVjdCgpKTsKICAgICAgICAgICAgcHJvZHVjZXJEZXN0aW5hdGlvbiA9IHNl\nc3Npb24uY3JlYXRlVG9waWMoZ2V0UHJvZHVjZXJTdWJqZWN0KCkpOwogICAg\nICAgIH0KCiAgICAgICAgTE9HLmluZm8oIkNyZWF0ZWQgIGNvbnN1bWVyIGRl\nc3RpbmF0aW9uOiAiCiAgICAgICAgICAgICAgICAgKyBjb25zdW1lckRlc3Rp\nbmF0aW9uICsgIiBvZiB0eXBlOiAiICsgY29uc3VtZXJEZXN0aW5hdGlvbi5n\nZXRDbGFzcygpKTsKICAgICAgICBMT0cuaW5mbygiQ3JlYXRlZCAgcHJvZHVj\nZXIgZGVzdGluYXRpb246ICIKICAgICAgICAgICAgICAgICArIHByb2R1Y2Vy\nRGVzdGluYXRpb24gKyAiIG9mIHR5cGU6ICIgKyBwcm9kdWNlckRlc3RpbmF0\naW9uLmdldENsYXNzKCkpOwogICAgICAgIGNvbnN1bWVyID0gY3JlYXRlQ29u\nc3VtZXIoKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CgogICAgICAg\nIExPRy5pbmZvKCJDcmVhdGVkIGNvbm5lY3Rpb246ICIgKyBjb25uZWN0aW9u\nKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCB0ZWFyRG93bigpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIGlmIChjb25uZWN0aW9uICE9IG51bGwp\nIHsKICAgICAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpOwogICAgICAgIH0K\nICAgICAgICBzdXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyB0aGUgY29uc3VtZXIgc3ViamVjdC4KICAgICAqCiAgICAg\nKiBAcmV0dXJuIFN0cmluZyAtIGNvbnN1bWVyIHN1YmplY3QKICAgICAqIEBz\nZWUgb3JnLmFwYWNoZS5hY3RpdmVtcS50ZXN0LlRlc3RTdXBwb3J0I2dldENv\nbnN1bWVyU3ViamVjdCgpCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcg\nZ2V0Q29uc3VtZXJTdWJqZWN0KCkgewogICAgICAgIHJldHVybiAiVEVTVCI7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBwcm9kdWNlciBz\ndWJqZWN0LgogICAgICoKICAgICAqIEByZXR1cm4gU3RyaW5nIC0gcHJvZHVj\nZXIgc3ViamVjdAogICAgICogQHNlZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLnRl\nc3QuVGVzdFN1cHBvcnQjZ2V0UHJvZHVjZXJTdWJqZWN0KCkKICAgICAqLwog\nICAgcHJvdGVjdGVkIFN0cmluZyBnZXRQcm9kdWNlclN1YmplY3QoKSB7CiAg\nICAgICAgcmV0dXJuICJURVNUIjsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\nbmRzIGFuZCBjb25zdW1lcyB0aGUgbWVzc2FnZXMuCiAgICAgKgogICAgICog\nQHRocm93cyBFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVz\ndFJlY292ZXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcg\ndGV4dCA9ICJURVNUIjsKICAgICAgICBNZXNzYWdlIHNlbmRNZXNzYWdlID0g\nc2Vzc2lvbi5jcmVhdGVUZXh0TWVzc2FnZSh0ZXh0KTsKCiAgICAgICAgaWYg\nKHZlcmJvc2UpIHsKICAgICAgICAgICAgTE9HLmluZm8oIkFib3V0IHRvIHNl\nbmQgYSBtZXNzYWdlOiAiICsgc2VuZE1lc3NhZ2UgKyAiIHdpdGggdGV4dDog\nIiArIHRleHQpOwogICAgICAgIH0KICAgICAgICBwcm9kdWNlci5zZW5kKHBy\nb2R1Y2VyRGVzdGluYXRpb24sIHNlbmRNZXNzYWdlKTsKCiAgICAgICAgLy8g\ncmVjZWl2ZSBidXQgZG9uJ3QgYWNrbm93bGVkZ2UKICAgICAgICBNZXNzYWdl\nIHVuYWNrTWVzc2FnZSA9IGNvbnN1bWVyLnJlY2VpdmUoaW5pdFJlZGVsaXZl\ncnlEZWxheSArIDEwMDApOwogICAgICAgIGFzc2VydE5vdE51bGwodW5hY2tN\nZXNzYWdlKTsKICAgICAgICBTdHJpbmcgdW5hY2tJZCA9IHVuYWNrTWVzc2Fn\nZS5nZXRKTVNNZXNzYWdlSUQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoKChU\nZXh0TWVzc2FnZSl1bmFja01lc3NhZ2UpLmdldFRleHQoKSwgdGV4dCk7CiAg\nICAgICAgYXNzZXJ0RmFsc2UodW5hY2tNZXNzYWdlLmdldEpNU1JlZGVsaXZl\ncmVkKCkpOwoKICAgICAgICAvLyBXZSBETyBOT1Qgc3VwcG9ydCBzZXNzaW9u\nIHJlY292ZXJ5CiAgICAgICAgLy8gLSB0byB1bmJsb2NrIHRoaXMgdGVzdCwg\nSSBhbSBzdG9wcCdpbmcgYW5kIHN0YXJ0J2luZyBjb25uZWN0aW9uIDogbm90\nIHRoZSBzYW1lLCBidXQgLi4uCiAgICAgICAgLy8gcmVjZWl2ZSB0aGVuIGFj\na25vd2xlZGdlCiAgICAgICAgLy8gY29uc3VtZVNlc3Npb24ucmVjb3Zlcigp\nOwogICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsKICAgICAgICBjb25uZWN0\naW9uID0gY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIGNvbnN1bWVTZXNz\naW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9u\nLkNMSUVOVF9BQ0tOT1dMRURHRSk7CiAgICAgICAgY29uc3VtZXIgPSBjcmVh\ndGVDb25zdW1lcigpOwogICAgICAgIGNvbm5lY3Rpb24uc3RhcnQoKTsKCiAg\nICAgICAgTWVzc2FnZSBhY2tNZXNzYWdlID0gY29uc3VtZXIucmVjZWl2ZShp\nbml0UmVkZWxpdmVyeURlbGF5ICsgMTAwMCk7CiAgICAgICAgYXNzZXJ0Tm90\nTnVsbChhY2tNZXNzYWdlKTsKICAgICAgICBhY2tNZXNzYWdlLmFja25vd2xl\nZGdlKCk7CiAgICAgICAgU3RyaW5nIGFja0lkID0gYWNrTWVzc2FnZS5nZXRK\nTVNNZXNzYWdlSUQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoKChUZXh0TWVz\nc2FnZSlhY2tNZXNzYWdlKS5nZXRUZXh0KCksIHRleHQpOwogICAgICAgIC8v\nIGFzc2VydFRydWUoYWNrTWVzc2FnZS5nZXRKTVNSZWRlbGl2ZXJlZCgpKTsK\nICAgICAgICBhc3NlcnRFcXVhbHModW5hY2tJZCwgYWNrSWQpOwoKICAgICAg\nICAvLyBXZSBETyBOT1Qgc3VwcG9ydCBzZXNzaW9uIHJlY292ZXJ5CiAgICAg\nICAgLy8gLSB0byB1bmJsb2NrIHRoaXMgdGVzdCwgSSBhbSBzdG9wcCdpbmcg\nYW5kIHN0YXJ0J2luZyBjb25uZWN0aW9uIDogbm90IHRoZSBzYW1lLCBidXQg\nLi4uCiAgICAgICAgLy8gY29uc3VtZVNlc3Npb24ucmVjb3ZlcigpOwogICAg\nICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsKICAgICAgICBjb25uZWN0aW9uID0g\nY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIGNvbnN1bWVTZXNzaW9uID0g\nY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkNMSUVO\nVF9BQ0tOT1dMRURHRSk7CiAgICAgICAgY29uc3VtZXIgPSBjcmVhdGVDb25z\ndW1lcigpOwogICAgICAgIGNvbm5lY3Rpb24uc3RhcnQoKTsKCiAgICAgICAg\nYXNzZXJ0TnVsbChjb25zdW1lci5yZWNlaXZlTm9XYWl0KCkpOwogICAgfQoK\nICAgIHByb3RlY3RlZCBNZXNzYWdlQ29uc3VtZXIgY3JlYXRlQ29uc3VtZXIo\nKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAoZHVyYWJsZSkg\newogICAgICAgICAgICBMT0cuaW5mbygiQ3JlYXRpbmcgZHVyYWJsZSBjb25z\ndW1lciIpOwogICAgICAgICAgICByZXR1cm4gY29uc3VtZVNlc3Npb24uY3Jl\nYXRlRHVyYWJsZVN1YnNjcmliZXIoKFRvcGljKWNvbnN1bWVyRGVzdGluYXRp\nb24sIGdldE5hbWUoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb25z\ndW1lU2Vzc2lvbi5jcmVhdGVDb25zdW1lcihjb25zdW1lckRlc3RpbmF0aW9u\nKTsKICAgIH0KCn0K\n","encoding":"base64"}

