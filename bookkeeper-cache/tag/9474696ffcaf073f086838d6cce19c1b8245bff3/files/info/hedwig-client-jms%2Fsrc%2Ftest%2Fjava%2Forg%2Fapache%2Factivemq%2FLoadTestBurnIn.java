{"sha":"5593dafc59d5e4ab78c40103ac48bc89e36281da","node_id":"MDQ6QmxvYjE1NzU5NTY6NTU5M2RhZmM1OWQ1ZTRhYjc4YzQwMTAzYWM0OGJjODllMzYyODFkYQ==","size":6161,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5593dafc59d5e4ab78c40103ac48bc89e36281da","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmEuaW8uSU9FeGNl\ncHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuam1zLk1lc3NhZ2lu\nZ1Nlc3Npb25GYWNhZGU7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5qbXMu\nc3BpLkhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbDsKaW1wb3J0IGphdmEu\nbmV0LlVSSTsKaW1wb3J0IGphdmEubmV0LlVSSVN5bnRheEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwpp\nbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CgppbXBvcnQg\namF2YXguam1zLkJ5dGVzTWVzc2FnZTsKaW1wb3J0IGphdmF4Lmptcy5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YXguam1zLkNvbm5lY3Rpb25GYWN0b3J5Owpp\nbXBvcnQgamF2YXguam1zLkRlbGl2ZXJ5TW9kZTsKaW1wb3J0IGphdmF4Lmpt\ncy5KTVNFeGNlcHRpb247CmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZTsKaW1w\nb3J0IGphdmF4Lmptcy5NZXNzYWdlQ29uc3VtZXI7CmltcG9ydCBqYXZheC5q\nbXMuTWVzc2FnZVByb2R1Y2VyOwppbXBvcnQgamF2YXguam1zLlNlc3Npb247\nCmltcG9ydCBqYXZheC5qbXMuVG9waWM7CgppbXBvcnQganVuaXQuZnJhbWV3\nb3JrLlRlc3Q7CgoKCmltcG9ydCBqYXZheC5qbXMuRGVzdGluYXRpb247Cmlt\ncG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\nckZhY3Rvcnk7CgovKioKICogU21hbGwgYnVybiB0ZXN0IG1vdmVzIHNlbmRz\nIGEgbW9kZXJhdGUgYW1vdW50IG9mIG1lc3NhZ2VzIHRocm91Z2ggdGhlIGJy\nb2tlciwKICogdG8gY2hlY2tpbmcgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIGJy\nb2tlciBkb2VzIG5vdCBsb2NrIHVwIGFmdGVyIGEgd2hpbGUgb2YKICogc3Vz\ndGFpbmVkIG1lc3NhZ2luZy4KICovCnB1YmxpYyBjbGFzcyBMb2FkVGVzdEJ1\ncm5JbiBleHRlbmRzIEptc1Rlc3RTdXBwb3J0IHsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIHRyYW5zaWVudCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9y\neS5nZXRMb2dnZXIoTG9hZFRlc3RCdXJuSW4uY2xhc3MpOwoKICAgIHB1Ymxp\nYyBEZXN0aW5hdGlvbiBkZXN0aW5hdGlvbjsKICAgIHB1YmxpYyBpbnQgZGVs\naXZlcnlNb2RlOwogICAgcHVibGljIE1lc3NhZ2luZ1Nlc3Npb25GYWNhZGUu\nRGVzdGluYXRpb25UeXBlIGRlc3RpbmF0aW9uVHlwZTsKICAgIHB1YmxpYyBi\nb29sZWFuIGR1cmFibGVDb25zdW1lcjsKICAgIHB1YmxpYyBpbnQgbWVzc2Fn\nZUNvdW50ID0gNTAwMDA7CiAgICBwdWJsaWMgaW50IG1lc3NhZ2VTaXplID0g\nMTAyNDsKCiAgICBwdWJsaWMgc3RhdGljIFRlc3Qgc3VpdGUoKSB7CiAgICAg\nICAgcmV0dXJuIHN1aXRlKExvYWRUZXN0QnVybkluLmNsYXNzKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIExPRy5pbmZvKCJTdGFydDogIiArIGdldE5hbWUoKSk7CiAg\nICAgICAgc3VwZXIuc2V0VXAoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9p\nZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICAgICAgfSBjYXRj\naCAoVGhyb3dhYmxlIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJh\nY2UoU3lzdGVtLm91dCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgTE9HLmluZm8oIkVuZDogIiArIGdldE5hbWUoKSk7CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFy\nZ3MpIHsKICAgICAgICBqdW5pdC50ZXh0dWkuVGVzdFJ1bm5lci5ydW4oc3Vp\ndGUoKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIENvbm5lY3Rpb25GYWN0b3J5\nIGNyZWF0ZUNvbm5lY3Rpb25GYWN0b3J5KCkgdGhyb3dzIFVSSVN5bnRheEV4\nY2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAgICAgIHJldHVybiBuZXcgSGVk\nd2lnQ29ubmVjdGlvbkZhY3RvcnlJbXBsKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgaW5pdENvbWJvc0ZvclRlc3RTZW5kUmVjZWl2ZSgpIHsKICAgICAg\nICBhZGRDb21iaW5hdGlvblZhbHVlcygiZGVsaXZlcnlNb2RlIiwgbmV3IE9i\namVjdFtdIHtJbnRlZ2VyLnZhbHVlT2YoRGVsaXZlcnlNb2RlLk5PTl9QRVJT\nSVNURU5UKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBJbnRlZ2VyLnZhbHVlT2YoRGVsaXZl\ncnlNb2RlLlBFUlNJU1RFTlQpfSk7CiAgICAgICAgYWRkQ29tYmluYXRpb25W\nYWx1ZXMoImRlc3RpbmF0aW9uVHlwZSIsIG5ldyBPYmplY3RbXSB7TWVzc2Fn\naW5nU2Vzc2lvbkZhY2FkZS5EZXN0aW5hdGlvblR5cGUuVE9QSUN9KTsKICAg\nICAgICBhZGRDb21iaW5hdGlvblZhbHVlcygiZHVyYWJsZUNvbnN1bWVyIiwg\nbmV3IE9iamVjdFtdIHtCb29sZWFuLlRSVUV9KTsKICAgICAgICBhZGRDb21i\naW5hdGlvblZhbHVlcygibWVzc2FnZVNpemUiLCBuZXcgT2JqZWN0W10ge0lu\ndGVnZXIudmFsdWVPZigxMDEpLCBJbnRlZ2VyLnZhbHVlT2YoMTAyKSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIEludGVnZXIudmFsdWVPZigxMDMpLCBJbnRlZ2VyLnZhbHVl\nT2YoMTA0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIEludGVnZXIudmFsdWVPZigxMDUpLCBJ\nbnRlZ2VyLnZhbHVlT2YoMTA2KSwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVnZXIudmFs\ndWVPZigxMDcpLCBJbnRlZ2VyLnZhbHVlT2YoMTA4KX0pOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RTZW5kUmVjZWl2ZSgpIHRocm93cyBFeGNlcHRp\nb24gewoKICAgICAgICAvLyBEdXJhYmxlIGNvbnN1bWVyIGNvbWJpbmF0aW9u\nIGlzIG9ubHkgdmFsaWQgd2l0aCB0b3BpY3MKICAgICAgICBpZiAoZHVyYWJs\nZUNvbnN1bWVyICYmIGRlc3RpbmF0aW9uVHlwZSAhPSBNZXNzYWdpbmdTZXNz\naW9uRmFjYWRlLkRlc3RpbmF0aW9uVHlwZS5UT1BJQykgewogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobnVsbCA9PSBjb25u\nZWN0aW9uLmdldENsaWVudElEKCkpIGNvbm5lY3Rpb24uc2V0Q2xpZW50SUQo\nZ2V0TmFtZSgpKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0KCk7CgogICAg\nICAgIFNlc3Npb24gc2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lv\nbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICBk\nZXN0aW5hdGlvbiA9IGNyZWF0ZURlc3RpbmF0aW9uKHNlc3Npb24sIGRlc3Rp\nbmF0aW9uVHlwZSk7CiAgICAgICAgTWVzc2FnZUNvbnN1bWVyIGNvbnN1bWVy\nOwogICAgICAgIGlmIChkdXJhYmxlQ29uc3VtZXIpIHsKICAgICAgICAgICAg\nY29uc3VtZXIgPSBzZXNzaW9uLmNyZWF0ZUR1cmFibGVTdWJzY3JpYmVyKChU\nb3BpYylkZXN0aW5hdGlvbiwgInN1YjE6IgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKTsKICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdW1lciA9IHNlc3Npb24u\nY3JlYXRlQ29uc3VtZXIoZGVzdGluYXRpb24pOwogICAgICAgIH0KICAgICAg\nICBwcm9maWxlclBhdXNlKCJSZWFkeTogIik7CgogICAgICAgIGZpbmFsIENv\ndW50RG93bkxhdGNoIHByb2R1Y2VyRG9uZUxhdGNoID0gbmV3IENvdW50RG93\nbkxhdGNoKDEpOwoKICAgICAgICAvLyBTZW5kIHRoZSBtZXNzYWdlcywgYXN5\nbmMKICAgICAgICBuZXcgVGhyZWFkKCkgewogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICBDb25uZWN0aW9uIGNvbm5l\nY3Rpb24yID0gbnVsbDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgY29ubmVjdGlvbjIgPSBmYWN0b3J5LmNyZWF0ZUNvbm5l\nY3Rpb24oKTsKICAgICAgICAgICAgICAgICAgICBTZXNzaW9uIHNlc3Npb24g\nPSBjb25uZWN0aW9uMi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFV\nVE9fQUNLTk9XTEVER0UpOwogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VQ\ncm9kdWNlciBwcm9kdWNlciA9IHNlc3Npb24uY3JlYXRlUHJvZHVjZXIoZGVz\ndGluYXRpb24pOwogICAgICAgICAgICAgICAgICAgIHByb2R1Y2VyLnNldERl\nbGl2ZXJ5TW9kZShkZWxpdmVyeU1vZGUpOwogICAgICAgICAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgbWVzc2FnZUNvdW50OyBpKyspIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgQnl0ZXNNZXNzYWdlIG0gPSBzZXNzaW9u\nLmNyZWF0ZUJ5dGVzTWVzc2FnZSgpOwogICAgICAgICAgICAgICAgICAgICAg\nICBtLndyaXRlQnl0ZXMobmV3IGJ5dGVbbWVzc2FnZVNpemVdKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgcHJvZHVjZXIuc2VuZChtKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcHJvZHVjZXIuY2xv\nc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEpNU0V4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsK\nICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAg\nICAgc2FmZUNsb3NlKGNvbm5lY3Rpb24yKTsKICAgICAgICAgICAgICAgICAg\nICBwcm9kdWNlckRvbmVMYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIH0KICAgICAgICB9LnN0YXJ0KCk7CgogICAg\nICAgIC8vIE1ha2Ugc3VyZSBhbGwgdGhlIG1lc3NhZ2VzIHdlcmUgZGVsaXZl\ncmVkLgogICAgICAgIE1lc3NhZ2UgbWVzc2FnZSA9IG51bGw7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBtZXNzYWdlQ291bnQ7IGkrKykgewogICAg\nICAgICAgICBtZXNzYWdlID0gY29uc3VtZXIucmVjZWl2ZSg1MDAwKTsKICAg\nICAgICAgICAgYXNzZXJ0Tm90TnVsbCgiRGlkIG5vdCBnZXQgbWVzc2FnZTog\nIiArIGksIG1lc3NhZ2UpOwogICAgICAgIH0KCiAgICAgICAgcHJvZmlsZXJQ\nYXVzZSgiRG9uZTogIik7CgogICAgICAgIGFzc2VydE51bGwoY29uc3VtZXIu\ncmVjZWl2ZU5vV2FpdCgpKTsKICAgICAgICBtZXNzYWdlLmFja25vd2xlZGdl\nKCk7CgogICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgcHJvZHVjZXIgdGhyZWFk\nIGZpbmlzaGVzLgogICAgICAgIGFzc2VydFRydWUocHJvZHVjZXJEb25lTGF0\nY2guYXdhaXQoNSwgVGltZVVuaXQuU0VDT05EUykpOwogICAgfQoKfQo=\n","encoding":"base64"}

