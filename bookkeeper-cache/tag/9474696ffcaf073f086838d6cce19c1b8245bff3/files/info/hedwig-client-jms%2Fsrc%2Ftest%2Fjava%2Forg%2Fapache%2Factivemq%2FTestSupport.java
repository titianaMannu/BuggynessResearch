{"sha":"fd838ab28f9011c6f5b84ce12c0655beba6bf2a6","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmQ4MzhhYjI4ZjkwMTFjNmY1Yjg0Y2UxMmMwNjU1YmViYTZiZjJhNg==","size":5094,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fd838ab28f9011c6f5b84ce12c0655beba6bf2a6","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xOwoKaW1wb3J0IGphdmF4Lmptcy5Ub3Bp\nYzsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNl\ncHRpb247CmltcG9ydCBqYXZhLnV0aWwuRW51bWVyYXRpb247CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwoKaW1wb3J0IGphdmF4Lmptcy5Db25uZWN0aW9uOwpp\nbXBvcnQgamF2YXguam1zLkRlc3RpbmF0aW9uOwppbXBvcnQgamF2YXguam1z\nLkpNU0V4Y2VwdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5NZXNzYWdlOwppbXBv\ncnQgamF2YXguam1zLlRleHRNZXNzYWdlOwoKCmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5qbXMuU2Vzc2lvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5qbXMubWVzc2FnZS5NZXNzYWdlSW1wbDsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmptcy5zcGkuSGVkd2lnQ29ubmVjdGlvbkZhY3RvcnlJbXBs\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuam1zLnNwaS5IZWR3aWdDb25u\nZWN0aW9uSW1wbDsKCgovKioKICogVXNlZnVsIGJhc2UgY2xhc3MgZm9yIHVu\naXQgdGVzdCBjYXNlcwogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIFRlc3RT\ndXBwb3J0IGV4dGVuZHMgQ29tYmluYXRpb25UZXN0U3VwcG9ydCB7CgogICAg\ncHJvdGVjdGVkIEhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbCBjb25uZWN0\naW9uRmFjdG9yeTsKICAgIHByb3RlY3RlZCBib29sZWFuIHRvcGljID0gdHJ1\nZTsKCiAgICBwcm90ZWN0ZWQgTWVzc2FnZUltcGwgY3JlYXRlTWVzc2FnZSgp\nIHsKICAgICAgICByZXR1cm4gbmV3IE1lc3NhZ2VJbXBsKG51bGwpOwogICAg\nfQoKICAgIHByb3RlY3RlZCBEZXN0aW5hdGlvbiBjcmVhdGVEZXN0aW5hdGlv\nbihTdHJpbmcgc3ViamVjdCkgewogICAgICAgIGlmICh0b3BpYykgewogICAg\nICAgICAgICByZXR1cm4gU2Vzc2lvbkltcGwuYXNUb3BpYyhzdWJqZWN0KTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdh\nbEFyZ3VtZW50RXhjZXB0aW9uKCJRdWV1ZSBOT1Qgc3VwcG9ydGVkIik7CiAg\nICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBEZXN0aW5hdGlvbiBjcmVh\ndGVEZXN0aW5hdGlvbigpIHsKICAgICAgICByZXR1cm4gY3JlYXRlRGVzdGlu\nYXRpb24oZ2V0RGVzdGluYXRpb25TdHJpbmcoKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBkZXN0aW5hdGlvbiB1\nc2VkIGluIHRoaXMgdGVzdCBjYXNlCiAgICAgKi8KICAgIHByb3RlY3RlZCBT\ndHJpbmcgZ2V0RGVzdGluYXRpb25TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJu\nIGdldENsYXNzKCkuZ2V0TmFtZSgpICsgIi4iICsgZ2V0TmFtZSh0cnVlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEBwYXJhbSBtZXNzc2FnZQogICAgICog\nQHBhcmFtIGZpcnN0U2V0CiAgICAgKiBAcGFyYW0gc2Vjb25kU2V0CiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIGFzc2VydFRleHRNZXNzYWdlc0VxdWFs\nKFN0cmluZyBtZXNzc2FnZSwgTWVzc2FnZVtdIGZpcnN0U2V0LCBNZXNzYWdl\nW10gc2Vjb25kU2V0KQogICAgICAgIHRocm93cyBKTVNFeGNlcHRpb24gewog\nICAgICAgIGFzc2VydEVxdWFscygiTWVzc2FnZSBjb3VudCBkb2VzIG5vdCBt\nYXRjaDogIiArIG1lc3NzYWdlLCBmaXJzdFNldC5sZW5ndGgsIHNlY29uZFNl\ndC5sZW5ndGgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vjb25k\nU2V0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIFRleHRNZXNzYWdlIG0x\nID0gKFRleHRNZXNzYWdlKWZpcnN0U2V0W2ldOwogICAgICAgICAgICBUZXh0\nTWVzc2FnZSBtMiA9IChUZXh0TWVzc2FnZSlzZWNvbmRTZXRbaV07CiAgICAg\nICAgICAgIGFzc2VydEZhbHNlKCJNZXNzYWdlICIgKyAoaSArIDEpICsgIiBk\naWQgbm90IG1hdGNoIDogIiArIG1lc3NzYWdlICsgIjogZXhwZWN0ZWQgeyIg\nKyBtMQogICAgICAgICAgICAgICAgICAgICAgICArICJ9LCBidXQgd2FzIHsi\nICsgbTIgKyAifSIsIG0xID09IG51bGwgXiBtMiA9PSBudWxsKTsKICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKCJNZXNzYWdlICIgKyAoaSArIDEpICsgIiBk\naWQgbm90IG1hdGNoOiAiICsgbWVzc3NhZ2UgKyAiOiBleHBlY3RlZCB7IiAr\nIG0xCiAgICAgICAgICAgICAgICAgICAgICAgICArICJ9LCBidXQgd2FzIHsi\nICsgbTIgKyAifSIsIG0xLmdldFRleHQoKSwgbTIuZ2V0VGV4dCgpKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIEhlZHdpZ0Nvbm5lY3Rpb25G\nYWN0b3J5SW1wbCBjcmVhdGVDb25uZWN0aW9uRmFjdG9yeSgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHJldHVybiBuZXcgSGVkd2lnQ29ubmVjdGlv\nbkZhY3RvcnlJbXBsKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGYWN0b3J5\nIG1ldGhvZCB0byBjcmVhdGUgYSBuZXcgY29ubmVjdGlvbgogICAgICovCiAg\nICBwcm90ZWN0ZWQgQ29ubmVjdGlvbiBjcmVhdGVDb25uZWN0aW9uKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZUNvbm5lY3Rp\nb24odHJ1ZSk7CiAgICB9CgogICAgcHJvdGVjdGVkIENvbm5lY3Rpb24gY3Jl\nYXRlQ29ubmVjdGlvbihib29sZWFuIHNldENsaWVudElkKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBIZWR3aWdDb25uZWN0aW9uSW1wbCBjb25uZWN0\naW9uID0gZ2V0Q29ubmVjdGlvbkZhY3RvcnkoKS5jcmVhdGVDb25uZWN0aW9u\nKCk7CiAgICAgICAgaWYgKHNldENsaWVudElkKSBjb25uZWN0aW9uLnNldENs\naWVudElEKGdldE5hbWUoKSk7CiAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb247\nCiAgICB9CgogICAgcHVibGljIEhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1w\nbCBnZXRDb25uZWN0aW9uRmFjdG9yeSgpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGlmIChjb25uZWN0aW9uRmFjdG9yeSA9PSBudWxsKSB7CiAgICAg\nICAgICAgIGNvbm5lY3Rpb25GYWN0b3J5ID0gY3JlYXRlQ29ubmVjdGlvbkZh\nY3RvcnkoKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiU2hvdWxkIGhhdmUg\nY3JlYXRlZCBhIGNvbm5lY3Rpb24gZmFjdG9yeSEiLCBjb25uZWN0aW9uRmFj\ndG9yeSAhPSBudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbm5l\nY3Rpb25GYWN0b3J5OwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0\nQ29uc3VtZXJTdWJqZWN0KCkgewogICAgICAgIHJldHVybiBnZXRTdWJqZWN0\nKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRQcm9kdWNlclN1\nYmplY3QoKSB7CiAgICAgICAgcmV0dXJuIGdldFN1YmplY3QoKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFN1YmplY3QoKSB7CiAgICAgICAg\ncmV0dXJuIGdldE5hbWUoKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZv\naWQgcmVjdXJzaXZlRGVsZXRlKEZpbGUgZikgewogICAgICAgIGlmIChmLmlz\nRGlyZWN0b3J5KCkpIHsKICAgICAgICAgICAgRmlsZVtdIGZpbGVzID0gZi5s\naXN0RmlsZXMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBm\naWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgcmVjdXJzaXZl\nRGVsZXRlKGZpbGVzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBmLmRlbGV0ZSgpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9p\nZCByZW1vdmVNZXNzYWdlU3RvcmUoKSB7CiAgICAgICAgaWYgKFN5c3RlbS5n\nZXRQcm9wZXJ0eSgiYWN0aXZlbXEuc3RvcmUuZGlyIikgIT0gbnVsbCkgewog\nICAgICAgICAgICByZWN1cnNpdmVEZWxldGUobmV3IEZpbGUoU3lzdGVtLmdl\ndFByb3BlcnR5KCJhY3RpdmVtcS5zdG9yZS5kaXIiKSkpOwogICAgICAgIH0K\nICAgICAgICBpZiAoU3lzdGVtLmdldFByb3BlcnR5KCJkZXJieS5zeXN0ZW0u\naG9tZSIpICE9IG51bGwpIHsKICAgICAgICAgICAgcmVjdXJzaXZlRGVsZXRl\nKG5ldyBGaWxlKFN5c3RlbS5nZXRQcm9wZXJ0eSgiZGVyYnkuc3lzdGVtLmhv\nbWUiKSkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRlc3Qg\naWYgYmFzZSBkaXJlY3RvcnkgY29udGFpbnMgc3BhY2VzCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIGFzc2VydEJhc2VEaXJlY3RvcnlDb250YWluc1Nw\nYWNlcygpIHsKICAgICAgICBhc3NlcnRGYWxzZSgiQmFzZSBkaXJlY3Rvcnkg\nY2Fubm90IGNvbnRhaW4gc3BhY2VzLiIsCiAgICAgICAgICAgICAgICAgICAg\nbmV3IEZpbGUoU3lzdGVtLmdldFByb3BlcnR5KCJiYXNlZGlyIiwgIi4iKSku\nZ2V0QWJzb2x1dGVGaWxlKCkudG9TdHJpbmcoKS5jb250YWlucygiICIpKTsK\nICAgIH0KCn0K\n","encoding":"base64"}

