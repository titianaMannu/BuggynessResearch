{"sha":"c5d9b0c2fcf4a1408481b01968e758aaba370a96","node_id":"MDQ6QmxvYjE1NzU5NTY6YzVkOWIwYzJmY2Y0YTE0MDg0ODFiMDE5NjhlNzU4YWFiYTM3MGE5Ng==","size":6358,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/c5d9b0c2fcf4a1408481b01968e758aaba370a96","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLmxvYWQ7CgppbXBvcnQgamF2YXguam1z\nLkNvbm5lY3Rpb247CmltcG9ydCBqYXZheC5qbXMuQ29ubmVjdGlvbkZhY3Rv\ncnk7CmltcG9ydCBqYXZheC5qbXMuRGVsaXZlcnlNb2RlOwppbXBvcnQgamF2\nYXguam1zLkRlc3RpbmF0aW9uOwppbXBvcnQgamF2YXguam1zLkpNU0V4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmF4Lmptcy5NZXNzYWdlQ29uc3VtZXI7CmltcG9y\ndCBqYXZheC5qbXMuTWVzc2FnZVByb2R1Y2VyOwppbXBvcnQgamF2YXguam1z\nLlNlc3Npb247CmltcG9ydCBqYXZheC5qbXMuVGV4dE1lc3NhZ2U7CgppbXBv\ncnQgb3JnLmFwYWNoZS5hY3RpdmVtcS5wZXJmLlBlcmZSYXRlOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuam1zLkxSVUNhY2hlU2V0OwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwoKcHVibGljIGNsYXNzIExvYWRDbGllbnQgaW1wbGVtZW50cyBSdW5uYWJs\nZXsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dn\nZXJGYWN0b3J5LmdldExvZ2dlcihMb2FkQ2xpZW50LmNsYXNzKTsKICAgIHBy\nb3RlY3RlZCBzdGF0aWMgaW50IFNMRUVQX1RJTUUgPSAyOwogICAgcHJvdGVj\ndGVkIFN0cmluZyBuYW1lOwogICAgcHJvdGVjdGVkIENvbm5lY3Rpb25GYWN0\nb3J5IGZhY3Rvcnk7CiAgICBwcm90ZWN0ZWQgQ29ubmVjdGlvbiBjb25uZWN0\naW9uOwogICAgcHJvdGVjdGVkIERlc3RpbmF0aW9uIHN0YXJ0RGVzdGluYXRp\nb247CiAgICBwcm90ZWN0ZWQgRGVzdGluYXRpb24gbmV4dERlc3RpbmF0aW9u\nOwogICAgcHJvdGVjdGVkIFNlc3Npb24gc2Vzc2lvbjsKICAgIHByb3RlY3Rl\nZCBNZXNzYWdlQ29uc3VtZXIgY29uc3VtZXI7CiAgICBwcm90ZWN0ZWQgTWVz\nc2FnZVByb2R1Y2VyIHByb2R1Y2VyOwogICAgcHJvdGVjdGVkIFBlcmZSYXRl\nIHJhdGUgPSBuZXcgUGVyZlJhdGUoKTsKICAgIHByb3RlY3RlZCBpbnQgZGVs\naXZlcnlNb2RlID0gRGVsaXZlcnlNb2RlLlBFUlNJU1RFTlQ7CiAgICBwcm90\nZWN0ZWQgYm9vbGVhbiBjb25uZWN0aW9uUGVyTWVzc2FnZSA9IGZhbHNlOwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gcnVubmluZzsKICAgIHByb3RlY3RlZCBp\nbnQgdGltZW91dCA9IDEwMDAwOwoKICAgIHB1YmxpYyBMb2FkQ2xpZW50KFN0\ncmluZyBuYW1lLENvbm5lY3Rpb25GYWN0b3J5IGZhY3RvcnkpIHsKICAgICAg\nIHRoaXMubmFtZT1uYW1lOwogICAgICAgdGhpcy5mYWN0b3J5ID0gZmFjdG9y\neTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgc3RhcnQo\nKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIXJ1bm5pbmcp\nIHsKICAgICAgICAgICAgcmF0ZS5yZXNldCgpOwogICAgICAgICAgICBydW5u\naW5nID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKCFjb25uZWN0aW9uUGVyTWVz\nc2FnZSkgewogICAgICAgICAgICAgICAgY29ubmVjdGlvbiA9IGZhY3Rvcnku\nY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgICAgICAgICAgY29ubmVjdGlv\nbi5zdGFydCgpOwogICAgICAgICAgICAgICAgc2Vzc2lvbiA9IGNvbm5lY3Rp\nb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xF\nREdFKTsKICAgICAgICAgICAgICAgIGNvbnN1bWVyID0gc2Vzc2lvbi5jcmVh\ndGVDb25zdW1lcihnZXRDb25zdW1lRGVzdGluYXRpb24oKSk7CiAgICAgICAg\nICAgICAgICBwcm9kdWNlciA9IHNlc3Npb24uY3JlYXRlUHJvZHVjZXIoZ2V0\nU2VuZERlc3RpbmF0aW9uKCkpOwogICAgICAgICAgICAgICAgcHJvZHVjZXIu\nc2V0RGVsaXZlcnlNb2RlKHRoaXMuZGVsaXZlcnlNb2RlKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBUaHJlYWQgdCA9IG5ldyAgVGhyZWFkKHRoaXMp\nOwogICAgICAgICAgICB0LnNldE5hbWUobmFtZSk7CiAgICAgICAgICAgIHQu\nc3RhcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgc3Rv\ncCgpIHRocm93cyBKTVNFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9u\nIHsKICAgICAgICBydW5uaW5nID0gZmFsc2U7CiAgICAgICAgaWYoY29ubmVj\ndGlvbiAhPSBudWxsKSB7CiAgICAgICAgICAgIGNvbm5lY3Rpb24uc3RvcCgp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgd2hpbGUgKHJ1bm5pbmcpIHsKICAg\nICAgICAgICAgICAgIFN0cmluZyByZXN1bHQgPSBjb25zdW1lKCk7CiAgICAg\nICAgICAgICAgICBpZihyZXN1bHQgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIHNlbmQocmVzdWx0KTsKICAgICAgICAgICAgICAgICAgICByYXRl\nLmluY3JlbWVudCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgZWxzZSBpZiAocnVubmluZykgewogICAgICAgICAgICAgICAgICAgIExP\nRy5lcnJvcihuYW1lICsgIiBGYWlsZWQgdG8gY29uc3VtZSEiKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSBlKSB7CiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgTFJVQ2FjaGVTZXQ8U3Ry\naW5nPiBtZXNzYWdlSWRDYWNoZSA9IG5ldyBMUlVDYWNoZVNldDxTdHJpbmc+\nKDIwNDgsIGZhbHNlKTsKICAgIHByb3RlY3RlZCBTdHJpbmcgY29uc3VtZSgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENvbm5lY3Rpb24gY29uICA9\nIG51bGw7CiAgICAgICAgTWVzc2FnZUNvbnN1bWVyIGMgPSBjb25zdW1lcjsK\nICAgICAgICBpZiAoY29ubmVjdGlvblBlck1lc3NhZ2UpewogICAgICAgICAg\nICBjb24gPSBmYWN0b3J5LmNyZWF0ZUNvbm5lY3Rpb24oKTsKICAgICAgICAg\nICAgY29uLnN0YXJ0KCk7CiAgICAgICAgICAgIFNlc3Npb24gcyA9IGNvbi5j\ncmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0Up\nOwogICAgICAgICAgICBjID0gcy5jcmVhdGVDb25zdW1lcihnZXRDb25zdW1l\nRGVzdGluYXRpb24oKSk7CiAgICAgICAgfQogICAgICAgIFRleHRNZXNzYWdl\nIHJlc3VsdCA9IChUZXh0TWVzc2FnZSkgYy5yZWNlaXZlKHRpbWVvdXQpOwog\nICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAo\nbWVzc2FnZUlkQ2FjaGUuY29udGFpbnMocmVzdWx0LmdldEpNU01lc3NhZ2VJ\nRCgpKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpNU0V4Y2VwdGlv\nbigiUmVjZWl2ZWQgZHVwbGljYXRlICIgKyByZXN1bHQuZ2V0VGV4dCgpKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBtZXNzYWdlSWRDYWNoZS5hZGQo\ncmVzdWx0LmdldEpNU01lc3NhZ2VJRCgpKTsKCiAgICAgICAgICAgIGlmIChj\nb25uZWN0aW9uUGVyTWVzc2FnZSkgewogICAgICAgICAgICAgICAgVGhyZWFk\nLnNsZWVwKFNMRUVQX1RJTUUpOy8vZ2l2ZSB0aGUgYnJva2VyIGEgY2hhbmNl\nCiAgICAgICAgICAgICAgICBjb24uY2xvc2UoKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0ICE9IG51bGwgPyByZXN1\nbHQuZ2V0VGV4dCgpIDogbnVsbDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzZW5kKFN0cmluZyB0ZXh0KSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBDb25uZWN0aW9uIGNvbiAgPSBjb25uZWN0aW9uOwogICAgICAgIE1lc3Nh\nZ2VQcm9kdWNlciBwID0gcHJvZHVjZXI7CiAgICAgICAgU2Vzc2lvbiBzID0g\nc2Vzc2lvbjsKICAgICAgICBpZiAoY29ubmVjdGlvblBlck1lc3NhZ2Upewog\nICAgICAgICAgICBjb24gPSBmYWN0b3J5LmNyZWF0ZUNvbm5lY3Rpb24oKTsK\nICAgICAgICAgICAgY29uLnN0YXJ0KCk7CiAgICAgICAgICAgIHMgPSBjb24u\nY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdF\nKTsKICAgICAgICAgICAgcCA9IHMuY3JlYXRlUHJvZHVjZXIoZ2V0U2VuZERl\nc3RpbmF0aW9uKCkpOwogICAgICAgICAgICBwLnNldERlbGl2ZXJ5TW9kZShk\nZWxpdmVyeU1vZGUpOwogICAgICAgIH0KICAgICAgICBUZXh0TWVzc2FnZSBt\nZXNzYWdlID0gcy5jcmVhdGVUZXh0TWVzc2FnZSh0ZXh0KTsKICAgICAgICBw\nLnNlbmQobWVzc2FnZSk7CiAgICAgICAgaWYgKGNvbm5lY3Rpb25QZXJNZXNz\nYWdlKSB7CiAgICAgICAgICAgIFRocmVhZC5zbGVlcChTTEVFUF9USU1FKTsv\nL2dpdmUgdGhlIGJyb2tlciBhIGNoYW5jZQogICAgICAgICAgICBjb24uY2xv\nc2UoKTsKICAgICAgICB9CiAgICB9CgoKCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndE5hbWUoKSB7CiAgICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CgoKCiAgICBw\ndWJsaWMgdm9pZCBzZXROYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgdGhp\ncy5uYW1lID0gbmFtZTsKICAgIH0KCgoKICAgIHB1YmxpYyBEZXN0aW5hdGlv\nbiBnZXRTdGFydERlc3RpbmF0aW9uKCkgewogICAgICAgIHJldHVybiBzdGFy\ndERlc3RpbmF0aW9uOwogICAgfQoKCgogICAgcHVibGljIHZvaWQgc2V0U3Rh\ncnREZXN0aW5hdGlvbihEZXN0aW5hdGlvbiBzdGFydERlc3RpbmF0aW9uKSB7\nCiAgICAgICAgdGhpcy5zdGFydERlc3RpbmF0aW9uID0gc3RhcnREZXN0aW5h\ndGlvbjsKICAgIH0KCgoKICAgIHB1YmxpYyBEZXN0aW5hdGlvbiBnZXROZXh0\nRGVzdGluYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIG5leHREZXN0aW5hdGlv\nbjsKICAgIH0KCgoKICAgIHB1YmxpYyB2b2lkIHNldE5leHREZXN0aW5hdGlv\nbihEZXN0aW5hdGlvbiBuZXh0RGVzdGluYXRpb24pIHsKICAgICAgICB0aGlz\nLm5leHREZXN0aW5hdGlvbiA9IG5leHREZXN0aW5hdGlvbjsKICAgIH0KCgoK\nICAgIHB1YmxpYyBpbnQgZ2V0RGVsaXZlcnlNb2RlKCkgewogICAgICAgIHJl\ndHVybiBkZWxpdmVyeU1vZGU7CiAgICB9CgoKCiAgICBwdWJsaWMgdm9pZCBz\nZXREZWxpdmVyeU1vZGUoaW50IGRlbGl2ZXJ5TW9kZSkgewogICAgICAgIHRo\naXMuZGVsaXZlcnlNb2RlID0gZGVsaXZlcnlNb2RlOwogICAgfQoKCgogICAg\ncHVibGljIGJvb2xlYW4gaXNDb25uZWN0aW9uUGVyTWVzc2FnZSgpIHsKICAg\nICAgICByZXR1cm4gY29ubmVjdGlvblBlck1lc3NhZ2U7CiAgICB9CgoKCiAg\nICBwdWJsaWMgdm9pZCBzZXRDb25uZWN0aW9uUGVyTWVzc2FnZShib29sZWFu\nIGNvbm5lY3Rpb25QZXJNZXNzYWdlKSB7CiAgICAgICAgdGhpcy5jb25uZWN0\naW9uUGVyTWVzc2FnZSA9IGNvbm5lY3Rpb25QZXJNZXNzYWdlOwogICAgfQoK\nCgogICAgcHVibGljIGludCBnZXRUaW1lb3V0KCkgewogICAgICAgIHJldHVy\nbiB0aW1lb3V0OwogICAgfQoKCgogICAgcHVibGljIHZvaWQgc2V0VGltZW91\ndChpbnQgdGltZW91dCkgewogICAgICAgIHRoaXMudGltZW91dCA9IHRpbWVv\ndXQ7CiAgICB9CgogICAgcHJvdGVjdGVkIERlc3RpbmF0aW9uIGdldFNlbmRE\nZXN0aW5hdGlvbigpIHsKICAgICAgICByZXR1cm4gbmV4dERlc3RpbmF0aW9u\nOwogICAgfQoKICAgIHByb3RlY3RlZCBEZXN0aW5hdGlvbiBnZXRDb25zdW1l\nRGVzdGluYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIHN0YXJ0RGVzdGluYXRp\nb247CiAgICB9Cgp9Cg==\n","encoding":"base64"}

