{"sha":"5df97e5a84237ac364dec016699f2a272ef75130","node_id":"MDQ6QmxvYjE1NzU5NTY6NWRmOTdlNWE4NDIzN2FjMzY0ZGVjMDE2Njk5ZjJhMjcyZWY3NTEzMA==","size":7091,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5df97e5a84237ac364dec016699f2a272ef75130","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLnBlcmY7CgppbXBvcnQgamF2YXguam1z\nLkNvbm5lY3Rpb247CmltcG9ydCBqYXZheC5qbXMuQ29ubmVjdGlvbkZhY3Rv\ncnk7CmltcG9ydCBqYXZheC5qbXMuRGVzdGluYXRpb247CmltcG9ydCBqYXZh\neC5qbXMuSk1TRXhjZXB0aW9uOwppbXBvcnQgamF2YXguam1zLlNlc3Npb247\nCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5KbXNUZXN0QmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmptcy5zcGkuSGVkd2lnQ29ubmVjdGlvbkZhY3RvcnlJbXBsOwoK\naW1wb3J0IG9yZy5qdW5pdC5JZ25vcmU7CmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgovKioKICoK\nICovCi8vIEZvciBub3csIGlnbm9yZSBpdCAuLi4KQElnbm9yZQpwdWJsaWMg\nY2xhc3MgU2ltcGxlVG9waWNUZXN0IGV4dGVuZHMgSm1zVGVzdEJhc2UgewoK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJG\nYWN0b3J5LmdldExvZ2dlcihTaW1wbGVUb3BpY1Rlc3QuY2xhc3MpOwoKICAg\nIHByb3RlY3RlZCBQZXJmUHJvZHVjZXJbXSBwcm9kdWNlcnM7CiAgICBwcm90\nZWN0ZWQgUGVyZkNvbnN1bWVyW10gY29uc3VtZXJzOwogICAgcHJvdGVjdGVk\nIFN0cmluZyBkZXN0aW5hdGlvbk5hbWUgPSBnZXRDbGFzcygpLmdldE5hbWUo\nKTsKICAgIC8vIHByb3RlY3RlZCBpbnQgc2FtcGxlQ291bnQgPSAyMDsKICAg\nIC8vIHByb3RlY3RlZCBsb25nIHNhbXBsZUludGVybmFsID0gMTAwMDA7CiAg\nICBwcm90ZWN0ZWQgaW50IHNhbXBsZUNvdW50ID0gNTsKICAgIHByb3RlY3Rl\nZCBsb25nIHNhbXBsZUludGVybmFsID0gNTAwMDsKICAgIHByb3RlY3RlZCBp\nbnQgbnVtYmVyT2ZEZXN0aW5hdGlvbnM9MTsKICAgIHByb3RlY3RlZCBpbnQg\nbnVtYmVyT2ZDb25zdW1lcnMgPSAxOwogICAgcHJvdGVjdGVkIGludCBudW1i\nZXJvZlByb2R1Y2VycyA9IDE7CiAgICBwcm90ZWN0ZWQgaW50IHRvdGFsTnVt\nYmVyT2ZQcm9kdWNlcnM7CiAgICBwcm90ZWN0ZWQgaW50IHRvdGFsTnVtYmVy\nT2ZDb25zdW1lcnM7CiAgICBwcm90ZWN0ZWQgaW50IHBsYXlsb2FkU2l6ZSA9\nIDEyOwogICAgcHJvdGVjdGVkIGJ5dGVbXSBhcnJheTsKICAgIHByb3RlY3Rl\nZCBDb25uZWN0aW9uRmFjdG9yeSBmYWN0b3J5OwoKICAgIC8qKgogICAgICog\nU2V0cyB1cCBhIHRlc3Qgd2hlcmUgdGhlIHByb2R1Y2VyIGFuZCBjb25zdW1l\nciBoYXZlIHRoZWlyIG93biBjb25uZWN0aW9uLgogICAgICoKICAgICAqIEBz\nZWUganVuaXQuZnJhbWV3b3JrLlRlc3RDYXNlI3NldFVwKCkKICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBzdXBlci5zZXRVcCgpOwogICAgICAgIGZhY3RvcnkgPSBjcmVh\ndGVDb25uZWN0aW9uRmFjdG9yeSgpOwogICAgICAgIENvbm5lY3Rpb24gY29u\nID0gZmFjdG9yeS5jcmVhdGVDb25uZWN0aW9uKCk7CiAgICAgICAgU2Vzc2lv\nbiBzZXNzaW9uID0gY29uLmNyZWF0ZVNlc3Npb24oZmFsc2UsIFNlc3Npb24u\nQVVUT19BQ0tOT1dMRURHRSk7CgogICAgICAgIExPRy5pbmZvKCJSdW5uaW5n\nICIgKyBudW1iZXJvZlByb2R1Y2VycyArICIgcHJvZHVjZXIocykgYW5kICIg\nKyBudW1iZXJPZkNvbnN1bWVycwogICAgICAgICAgICAgICAgICsgIiBjb25z\ndW1lcihzKSBwZXIgIiArIG51bWJlck9mRGVzdGluYXRpb25zICsgIiBEZXN0\naW5hdGlvbihzKSIpOwoKICAgICAgICB0b3RhbE51bWJlck9mQ29uc3VtZXJz\nPW51bWJlck9mQ29uc3VtZXJzKm51bWJlck9mRGVzdGluYXRpb25zOwogICAg\nICAgIHRvdGFsTnVtYmVyT2ZQcm9kdWNlcnM9bnVtYmVyb2ZQcm9kdWNlcnMq\nbnVtYmVyT2ZEZXN0aW5hdGlvbnM7CiAgICAgICAgcHJvZHVjZXJzID0gbmV3\nIFBlcmZQcm9kdWNlclt0b3RhbE51bWJlck9mUHJvZHVjZXJzXTsKICAgICAg\nICBjb25zdW1lcnMgPSBuZXcgUGVyZkNvbnN1bWVyW3RvdGFsTnVtYmVyT2ZD\nb25zdW1lcnNdOwogICAgICAgIGludCBjb25zdW1lckNvdW50ID0gMDsKICAg\nICAgICBpbnQgcHJvZHVjZXJDb3VudCA9IDA7CiAgICAgICAgZm9yIChpbnQg\nayA9MDsgayA8IG51bWJlck9mRGVzdGluYXRpb25zO2srKykgewogICAgICAg\nICAgICBEZXN0aW5hdGlvbiBkZXN0aW5hdGlvbiA9IGNyZWF0ZURlc3RpbmF0\naW9uKHNlc3Npb24sIGRlc3RpbmF0aW9uTmFtZSsiOiIrayk7CiAgICAgICAg\nICAgIExPRy5pbmZvKCJUZXN0aW5nIGFnYWluc3QgZGVzdGluYXRpb246ICIg\nKyBkZXN0aW5hdGlvbik7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbnVtYmVyT2ZDb25zdW1lcnM7IGkrKykgewogICAgICAgICAgICAgICAg\nY29uc3VtZXJzW2NvbnN1bWVyQ291bnRdID0gY3JlYXRlQ29uc3VtZXIoZmFj\ndG9yeSwgZGVzdGluYXRpb24sIGNvbnN1bWVyQ291bnQpOwogICAgICAgICAg\nICAgICAgY29uc3VtZXJDb3VudCsrOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtYmVyb2ZQcm9kdWNlcnM7IGkr\nKykgewogICAgICAgICAgICAgICAgYXJyYXkgPSBuZXcgYnl0ZVtwbGF5bG9h\nZFNpemVdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IGk7IGogPCBh\ncnJheS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGFycmF5\nW2pdID0gKGJ5dGUpajsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIHByb2R1Y2Vyc1twcm9kdWNlckNvdW50XSA9IGNyZWF0ZVByb2R1Y2Vy\nKGZhY3RvcnksIGRlc3RpbmF0aW9uLCBpLCBhcnJheSk7CiAgICAgICAgICAg\nICAgICBwcm9kdWNlckNvdW50Kys7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgY29uLmNsb3NlKCk7CiAgICAgICAgLy8gc3VwZXIuc2V0VXAo\nKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCB0ZWFyRG93bigpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1iZXJPZkNvbnN1bWVyczsgaSsr\nKSB7CiAgICAgICAgICAgIGNvbnN1bWVyc1tpXS5zaHV0RG93bigpOwogICAg\nICAgIH0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bWJlcm9mUHJv\nZHVjZXJzOyBpKyspIHsKICAgICAgICAgICAgcHJvZHVjZXJzW2ldLnNodXRE\nb3duKCk7CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBEZXN0aW5h\ndGlvbiBjcmVhdGVEZXN0aW5hdGlvbihTZXNzaW9uIHMsIFN0cmluZyBkZXN0\naW5hdGlvbk5hbWUpIHRocm93cyBKTVNFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiBzLmNyZWF0ZVRvcGljKGRlc3RpbmF0aW9uTmFtZSk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIFBlcmZQcm9kdWNlciBjcmVhdGVQcm9kdWNlcihDb25u\nZWN0aW9uRmFjdG9yeSBmYWMsIERlc3RpbmF0aW9uIGRlc3QsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBudW1iZXIs\nIGJ5dGVbXSBwYXlsb2FkKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAg\nICByZXR1cm4gbmV3IFBlcmZQcm9kdWNlcihmYWMsIGRlc3QsIHBheWxvYWQp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBQZXJmQ29uc3VtZXIgY3JlYXRlQ29u\nc3VtZXIoQ29ubmVjdGlvbkZhY3RvcnkgZmFjLCBEZXN0aW5hdGlvbiBkZXN0\nLCBpbnQgbnVtYmVyKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gbmV3IFBlcmZDb25zdW1lcihmYWMsIGRlc3QpOwogICAgfQoKICAg\nIHByb3RlY3RlZCBIZWR3aWdDb25uZWN0aW9uRmFjdG9yeUltcGwgY3JlYXRl\nQ29ubmVjdGlvbkZhY3RvcnkoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICByZXR1cm4gbmV3IEhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbCgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RQZXJmb3JtYW5jZSgpIHRocm93\ncyBKTVNFeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHRvdGFsTnVtYmVyT2ZDb25zdW1lcnM7\nIGkrKykgewogICAgICAgICAgICBjb25zdW1lcnNbaV0uc3RhcnQoKTsKICAg\nICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0b3RhbE51bWJl\nck9mUHJvZHVjZXJzOyBpKyspIHsKICAgICAgICAgICAgcHJvZHVjZXJzW2ld\nLnN0YXJ0KCk7CiAgICAgICAgfQogICAgICAgIExPRy5pbmZvKCJTYW1wbGlu\nZyBwZXJmb3JtYW5jZSAiICsgc2FtcGxlQ291bnQgKyAiIHRpbWVzIGF0IGEg\nIiArIHNhbXBsZUludGVybmFsICsgIiBtcyBpbnRlcnZhbC4iKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNhbXBsZUNvdW50OyBpKyspIHsKICAg\nICAgICAgICAgVGhyZWFkLnNsZWVwKHNhbXBsZUludGVybmFsKTsKICAgICAg\nICAgICAgZHVtcFByb2R1Y2VyUmF0ZSgpOwogICAgICAgICAgICBkdW1wQ29u\nc3VtZXJSYXRlKCk7CiAgICAgICAgfQogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgdG90YWxOdW1iZXJPZlByb2R1Y2VyczsgaSsrKSB7CiAgICAgICAg\nICAgIHByb2R1Y2Vyc1tpXS5zdG9wKCk7CiAgICAgICAgfQogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgdG90YWxOdW1iZXJPZkNvbnN1bWVyczsgaSsr\nKSB7CiAgICAgICAgICAgIGNvbnN1bWVyc1tpXS5zdG9wKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGR1bXBQcm9kdWNlclJhdGUo\nKSB7CiAgICAgICAgaW50IHRvdGFsUmF0ZSA9IDA7CiAgICAgICAgaW50IHRv\ndGFsQ291bnQgPSAwOwogICAgICAgIFN0cmluZyBwcm9kdWNlclN0cmluZz0i\nUHJvZHVjZXJzOiI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwcm9k\ndWNlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgUGVyZlJhdGUgcmF0\nZSA9IHByb2R1Y2Vyc1tpXS5nZXRSYXRlKCkuY2xvbmVBbmRSZXNldCgpOwog\nICAgICAgICAgICB0b3RhbFJhdGUgKz0gcmF0ZS5nZXRSYXRlKCk7CiAgICAg\nICAgICAgIHRvdGFsQ291bnQgKz0gcmF0ZS5nZXRUb3RhbENvdW50KCk7CiAg\nICAgICAgICAgIHByb2R1Y2VyU3RyaW5nKz0iWyIraSsiOiIrcmF0ZS5nZXRS\nYXRlKCkgKyAiLCIrcmF0ZS5nZXRUb3RhbENvdW50KCkrIl07IjsKICAgICAg\nICB9CiAgICAgICAgaWYgKHByb2R1Y2VycyAhPSBudWxsICYmIHByb2R1Y2Vy\ncy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGludCBhdmdSYXRlID0gdG90\nYWxSYXRlIC8gcHJvZHVjZXJzLmxlbmd0aDsKICAgICAgICAgICAgU3lzdGVt\nLm91dC5wcmludGxuKCJBdmcgcHJvZHVjZXIgcmF0ZSA9ICIgKyBhdmdSYXRl\nCiAgICAgICAgICAgICAgICAgICAgKyAiIG1zZy9zZWMgfCBUb3RhbCByYXRl\nID0gIiArIHRvdGFsUmF0ZSArICIsIHNlbnQgPSAiCiAgICAgICAgICAgICAg\nICAgICAgKyB0b3RhbENvdW50KTsKICAgICAgICAgICAvLyBTeXN0ZW0ub3V0\nLnByaW50bG4ocHJvZHVjZXJTdHJpbmcpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBkdW1wQ29uc3VtZXJSYXRlKCkgewogICAgICAg\nIGludCB0b3RhbFJhdGUgPSAwOwogICAgICAgIGludCB0b3RhbENvdW50ID0g\nMDsKICAgICAgICBTdHJpbmcgY29uc3VtZXJTdHJpbmc9IkNvbnN1bWVyczoi\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29uc3VtZXJzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIFBlcmZSYXRlIHJhdGUgPSBjb25zdW1l\ncnNbaV0uZ2V0UmF0ZSgpLmNsb25lQW5kUmVzZXQoKTsKICAgICAgICAgICAg\ndG90YWxSYXRlICs9IHJhdGUuZ2V0UmF0ZSgpOwogICAgICAgICAgICB0b3Rh\nbENvdW50ICs9IHJhdGUuZ2V0VG90YWxDb3VudCgpOwogICAgICAgICAgICBj\nb25zdW1lclN0cmluZys9IlsiK2krIjoiK3JhdGUuZ2V0UmF0ZSgpICsgIiwi\nK3JhdGUuZ2V0VG90YWxDb3VudCgpKyJdOyI7CiAgICAgICAgfQogICAgICAg\nIGlmIChjb25zdW1lcnMgIT0gbnVsbCAmJiBjb25zdW1lcnMubGVuZ3RoID4g\nMCkgewogICAgICAgICAgICBpbnQgYXZnUmF0ZSA9IHRvdGFsUmF0ZSAvIGNv\nbnN1bWVycy5sZW5ndGg7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbigiQXZnIGNvbnN1bWVyIHJhdGUgPSAiICsgYXZnUmF0ZSArICIgbXNnL3Nl\nYyB8IFRvdGFsIHJhdGUgPSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICArIHRvdGFsUmF0ZSArICIsIHJlY2VpdmVkID0gIiArIHRvdGFsQ291\nbnQpOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oY29uc3VtZXJT\ndHJpbmcpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

