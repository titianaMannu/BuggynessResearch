{"sha":"087c5ef4ba9e928700c844dfcf53357248a767da","node_id":"MDQ6QmxvYjE1NzU5NTY6MDg3YzVlZjRiYTllOTI4NzAwYzg0NGRmY2Y1MzM1NzI0OGE3NjdkYQ==","size":17325,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/087c5ef4ba9e928700c844dfcf53357248a767da","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLnVzZWNhc2VzOwoKaW1wb3J0IGphdmEu\ndXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZh\nLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1wb3J0IGph\ndmEudXRpbC5jb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2\nYS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBvcnQgamF2YS51dGls\nLmNvbmN1cnJlbnQuVGhyZWFkRmFjdG9yeTsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LlRpbWVVbml0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJl\nbnQuYXRvbWljLkF0b21pY0xvbmc7CmltcG9ydCBqYXZheC5qbXMuQ29ubmVj\ndGlvbjsKaW1wb3J0IGphdmF4Lmptcy5Db25uZWN0aW9uRmFjdG9yeTsKaW1w\nb3J0IGphdmF4Lmptcy5EZWxpdmVyeU1vZGU7CmltcG9ydCBqYXZheC5qbXMu\nRGVzdGluYXRpb247CmltcG9ydCBqYXZheC5qbXMuSk1TRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YXguam1zLk1lc3NhZ2U7CmltcG9ydCBqYXZheC5qbXMuTWVz\nc2FnZUNvbnN1bWVyOwppbXBvcnQgamF2YXguam1zLk1lc3NhZ2VMaXN0ZW5l\ncjsKaW1wb3J0IGphdmF4Lmptcy5NZXNzYWdlUHJvZHVjZXI7CmltcG9ydCBq\nYXZheC5qbXMuU2Vzc2lvbjsKaW1wb3J0IGphdmF4Lmptcy5UZXh0TWVzc2Fn\nZTsKaW1wb3J0IGphdmF4Lmptcy5Ub3BpY1N1YnNjcmliZXI7CmltcG9ydCBq\ndW5pdC5mcmFtZXdvcmsuVGVzdDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLmptcy5zcGkuSGVkd2lnQ29ubmVjdGlvbkZhY3RvcnlJbXBsOwppbXBvcnQg\nb3JnLmFwYWNoZS5hY3RpdmVtcS5UZXN0U3VwcG9ydDsKCmltcG9ydCBvcmcu\nYXBhY2hlLmFjdGl2ZW1xLnV0aWwuTWVzc2FnZUlkTGlzdDsKaW1wb3J0IG9y\nZy5hcGFjaGUuYWN0aXZlbXEudXRpbC5XYWl0OwovL2ltcG9ydCBvcmcuYXBh\nY2hlLmNvbW1vbnMuZGJjcC5CYXNpY0RhdGFTb3VyY2U7CmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7\nCgpwdWJsaWMgY2xhc3MgQ29uY3VycmVudFByb2R1Y2VyRHVyYWJsZUNvbnN1\nbWVyVGVzdCBleHRlbmRzIFRlc3RTdXBwb3J0IHsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dl\ncihDb25jdXJyZW50UHJvZHVjZXJEdXJhYmxlQ29uc3VtZXJUZXN0LmNsYXNz\nKTsKICAgIHByaXZhdGUgaW50IGNvbnN1bWVyQ291bnQgPSA1OwogICAgcHJv\ndGVjdGVkIExpc3Q8Q29ubmVjdGlvbj4gY29ubmVjdGlvbnMgPSBDb2xsZWN0\naW9ucy5zeW5jaHJvbml6ZWRMaXN0KG5ldyBBcnJheUxpc3Q8Q29ubmVjdGlv\nbj4oKSk7CiAgICBwcm90ZWN0ZWQgTWFwPE1lc3NhZ2VDb25zdW1lciwgVGlt\nZWRNZXNzYWdlTGlzdGVuZXI+IGNvbnN1bWVycwogICAgICAgID0gbmV3IEhh\nc2hNYXA8TWVzc2FnZUNvbnN1bWVyLCBUaW1lZE1lc3NhZ2VMaXN0ZW5lcj4o\nKTsKICAgIHByb3RlY3RlZCBNZXNzYWdlSWRMaXN0IGFsbE1lc3NhZ2VzTGlz\ndCA9IG5ldyBNZXNzYWdlSWRMaXN0KCk7CiAgICBwcml2YXRlIGludCBtZXNz\nYWdlU2l6ZSA9IDEwMjQ7CgogICAgcHVibGljIHZvaWQgdGVzdFNlbmRSYXRl\nV2l0aEFjdGl2YXRpbmdDb25zdW1lcnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBmaW5hbCBEZXN0aW5hdGlvbiBkZXN0aW5hdGlvbiA9IGNyZWF0\nZURlc3RpbmF0aW9uKCk7CiAgICAgICAgZmluYWwgQ29ubmVjdGlvbkZhY3Rv\ncnkgZmFjdG9yeSA9IGNyZWF0ZUNvbm5lY3Rpb25GYWN0b3J5KCk7CiAgICAg\nICAgc3RhcnRJbmFjdGl2ZUNvbnN1bWVycyhmYWN0b3J5LCBkZXN0aW5hdGlv\nbik7CgogICAgICAgIENvbm5lY3Rpb24gY29ubmVjdGlvbiA9IGZhY3Rvcnku\nY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIFNlc3Npb24gc2Vzc2lvbiA9\nIGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5BVVRP\nX0FDS05PV0xFREdFKTsKICAgICAgICBNZXNzYWdlUHJvZHVjZXIgcHJvZHVj\nZXIgPSBjcmVhdGVNZXNzYWdlUHJvZHVjZXIoc2Vzc2lvbiwgZGVzdGluYXRp\nb24pOwoKICAgICAgICAvLyBwcmVsb2FkIHRoZSBkdXJhYmxlIGNvbnN1bWVy\ncwogICAgICAgIGRvdWJsZVtdIGluYWN0aXZlQ29uc3VtZXJTdGF0cyA9IHBy\nb2R1Y2VNZXNzYWdlcyhkZXN0aW5hdGlvbiwgNTAwLCAxMCwgc2Vzc2lvbiwg\ncHJvZHVjZXIsIG51bGwpOwogICAgICAgIExPRy5pbmZvKCJXaXRoIGluYWN0\naXZlIGNvbnN1bWVyczogYXZlOiAiICsgaW5hY3RpdmVDb25zdW1lclN0YXRz\nWzFdCiAgICAgICAgICAgICAgICArICIsIG1heDogIiArIGluYWN0aXZlQ29u\nc3VtZXJTdGF0c1swXSArICIsIG11bHRpcGxpZXI6ICIKICAgICAgICAgICAg\nICAgICArIChpbmFjdGl2ZUNvbnN1bWVyU3RhdHNbMF0vaW5hY3RpdmVDb25z\ndW1lclN0YXRzWzFdKSk7CgogICAgICAgIC8vIHBlcmlvZGljYWxseSBzdGFy\ndCBhIGR1cmFibGUgc3ViIHRoYXQgaGFzIGEgYmFja2xvZwogICAgICAgIGZp\nbmFsIGludCBjb25zdW1lcnNUb0FjdGl2YXRlID0gNTsKICAgICAgICBmaW5h\nbCBPYmplY3QgYWRkQ29uc3VtZXJTaWduYWwgPSBuZXcgT2JqZWN0KCk7CiAg\nICAgICAgRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2wobmV3IFRocmVh\nZEZhY3RvcnkoKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICBwdWJsaWMgVGhyZWFkIG5ld1RocmVhZChSdW5uYWJsZSByKSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gbmV3IFRocmVhZChyLCAiQWN0aXZhdGVDb25z\ndW1lciIgKyB0aGlzKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLmV4ZWN1\ndGUobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlQ29uc3VtZXIgY29u\nc3VtZXIgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29uc3VtZXJzVG9BY3RpdmF0ZTsgaSsrKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIExPRy5pbmZvKCJXYWl0aW5nIGZvciBhZGQgc2ln\nbmFsIGZyb20gcHJvZHVjZXIuLi4iKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgc3luY2hyb25pemVkIChhZGRDb25zdW1lclNpZ25hbCkgewogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgYWRkQ29uc3VtZXJTaWduYWwud2FpdCgz\nMCAqIDYwICogMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAgICAgVGltZWRNZXNzYWdlTGlzdGVuZXIgbGlz\ndGVuZXIgPSBuZXcgVGltZWRNZXNzYWdlTGlzdGVuZXIoKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgY29uc3VtZXIgPSBjcmVhdGVEdXJhYmxlU3Vic2Ny\naWJlcihmYWN0b3J5LmNyZWF0ZUNvbm5lY3Rpb24oKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBkZXN0aW5hdGlvbiwgImNvbnN1bWVyIiArIChpICsgMSkpOwogICAgICAg\nICAgICAgICAgICAgICAgICBMT0cuaW5mbygiQ3JlYXRlZCBjb25zdW1lciAi\nICsgY29uc3VtZXIpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdW1l\nci5zZXRNZXNzYWdlTGlzdGVuZXIobGlzdGVuZXIpOwogICAgICAgICAgICAg\nICAgICAgICAgICBjb25zdW1lcnMucHV0KGNvbnN1bWVyLCBsaXN0ZW5lcik7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICBMT0cuZXJy\nb3IoImZhaWxlZCB0byBzdGFydCBjb25zdW1lciIsIGUpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CgoKICAgICAgICBk\nb3VibGVbXSBzdGF0c1dpdGhBY3RpdmUgPSBwcm9kdWNlTWVzc2FnZXMoZGVz\ndGluYXRpb24sIDUwMCwgMTAsIHNlc3Npb24sIHByb2R1Y2VyLCBhZGRDb25z\ndW1lclNpZ25hbCk7CgogICAgICAgIExPRy5pbmZvKCIgd2l0aCBjb25jdXJy\nZW50IGFjdGl2YXRlLCBhdmU6ICIgKyBzdGF0c1dpdGhBY3RpdmVbMV0KICAg\nICAgICAgICAgICAgICArICIsIG1heDogIiArIHN0YXRzV2l0aEFjdGl2ZVsw\nXSArICIsIG11bHRpcGxpZXI6ICIgKyAoc3RhdHNXaXRoQWN0aXZlWzBdLyBz\ndGF0c1dpdGhBY3RpdmVbMV0pKTsKCiAgICAgICAgd2hpbGUoY29uc3VtZXJz\nLnNpemUoKSA8IGNvbnN1bWVyc1RvQWN0aXZhdGUpIHsKICAgICAgICAgICAg\nVGltZVVuaXQuU0VDT05EUy5zbGVlcCgyKTsKICAgICAgICB9CgogICAgICAg\nIGxvbmcgdGltZVRvRmlyc3RBY2N1bXVsYXRvciA9IDA7CiAgICAgICAgZm9y\nIChUaW1lZE1lc3NhZ2VMaXN0ZW5lciBsaXN0ZW5lciA6IGNvbnN1bWVycy52\nYWx1ZXMoKSkgewogICAgICAgICAgICBsb25nIHRpbWUgPSBsaXN0ZW5lci5n\nZXRGaXJzdFJlY2VpcHQoKTsKICAgICAgICAgICAgdGltZVRvRmlyc3RBY2N1\nbXVsYXRvciArPSB0aW1lOwogICAgICAgICAgICBMT0cuaW5mbygiVGltZSB0\nbyBmaXJzdCAiICsgdGltZSk7CiAgICAgICAgfQogICAgICAgIExPRy5pbmZv\nKCJBdmUgdGltZSB0byBmaXJzdCBtZXNzYWdlID0iICsgdGltZVRvRmlyc3RB\nY2N1bXVsYXRvci9jb25zdW1lcnMuc2l6ZSgpKTsKCiAgICAgICAgZm9yIChU\naW1lZE1lc3NhZ2VMaXN0ZW5lciBsaXN0ZW5lciA6IGNvbnN1bWVycy52YWx1\nZXMoKSkgewogICAgICAgICAgICBMT0cuaW5mbygiQXZlIGJhdGNoIHJlY2Vp\ncHQgdGltZTogIiArIGxpc3RlbmVyLndhaXRGb3JSZWNlaXZlZExpbWl0KDEw\nMDAwKQogICAgICAgICAgICAgICAgICAgICArICIgbWF4IHJlY2VpcHQ6ICIg\nKyBsaXN0ZW5lci5tYXhSZWNlaXB0VGltZSk7CiAgICAgICAgfQoKICAgICAg\nICAvL2Fzc2VydFRydWUoIm1heCAoIiArIHN0YXRzV2l0aEFjdGl2ZVswXSAr\nICIpIHdpdGhpbiByZWFzb25hYmxlCiAgICAgICAgLy8gbXVsdGlwbGllciBv\nZiBhdmUgKCIgKyBzdGF0c1dpdGhBY3RpdmVbMV0gKyAiKSIsCiAgICAgICAg\nLy8gICAgICAgIHN0YXRzV2l0aEFjdGl2ZVswXSA8IDUgKiBzdGF0c1dpdGhB\nY3RpdmVbMV0pOwoKICAgICAgICAvLyBjb21wYXJlIG5vIGFjdGl2ZSB0byBh\nY3RpdmUKICAgICAgICBMT0cuaW5mbygiQXZlIHNlbmQgdGltZSB3aXRoIGFj\ndGl2ZTogIiArIHN0YXRzV2l0aEFjdGl2ZVsxXQogICAgICAgICAgICAgICAg\nKyAiIGFzIG11bHRpcGxpZXIgb2YgYXZlIHdpdGggbm9uZSBhY3RpdmU6ICIg\nKyBpbmFjdGl2ZUNvbnN1bWVyU3RhdHNbMV0KICAgICAgICAgICAgICAgICsg\nIiwgbXVsdGlwbGllcj0iICsgKHN0YXRzV2l0aEFjdGl2ZVsxXS9pbmFjdGl2\nZUNvbnN1bWVyU3RhdHNbMV0pKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZSgiQXZl\nIHNlbmQgdGltZSB3aXRoIGFjdGl2ZTogIiArIHN0YXRzV2l0aEFjdGl2ZVsx\nXQogICAgICAgICAgICAgICAgKyAiIHdpdGhpbiByZWFzb25hYmxlIG11bHRw\nbGVyIG9mIGF2ZSB3aXRoIG5vbmUgYWN0aXZlOiAiICsgaW5hY3RpdmVDb25z\ndW1lclN0YXRzWzFdCiAgICAgICAgICAgICAgICArICIsIG11bHRpcGxpZXIg\nIiArIChzdGF0c1dpdGhBY3RpdmVbMV0vaW5hY3RpdmVDb25zdW1lclN0YXRz\nWzFdKSwKICAgICAgICAgICAgICAgIHN0YXRzV2l0aEFjdGl2ZVsxXSA8IDE1\nICogaW5hY3RpdmVDb25zdW1lclN0YXRzWzFdKTsKICAgIH0KCgogICAgcHVi\nbGljIHZvaWQgeF90ZXN0U2VuZFdpdGhJbmFjdGl2ZUFuZEFjdGl2ZUNvbnN1\nbWVycygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIERlc3RpbmF0aW9u\nIGRlc3RpbmF0aW9uID0gY3JlYXRlRGVzdGluYXRpb24oKTsKICAgICAgICBD\nb25uZWN0aW9uRmFjdG9yeSBmYWN0b3J5ID0gY3JlYXRlQ29ubmVjdGlvbkZh\nY3RvcnkoKTsKICAgICAgICBzdGFydEluYWN0aXZlQ29uc3VtZXJzKGZhY3Rv\ncnksIGRlc3RpbmF0aW9uKTsKCiAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0\naW9uID0gZmFjdG9yeS5jcmVhdGVDb25uZWN0aW9uKCk7CiAgICAgICAgU2Vz\nc2lvbiBzZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNzaW9uKGZhbHNl\nLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAgIE1lc3NhZ2VQ\ncm9kdWNlciBwcm9kdWNlciA9IHNlc3Npb24uY3JlYXRlUHJvZHVjZXIoZGVz\ndGluYXRpb24pOwogICAgICAgIHByb2R1Y2VyLnNldERlbGl2ZXJ5TW9kZShE\nZWxpdmVyeU1vZGUuUEVSU0lTVEVOVCk7CgogICAgICAgIGZpbmFsIGludCB0\nb1NlbmQgPSAxMDA7CiAgICAgICAgZmluYWwgaW50IG51bUl0ZXJhdGlvbnMg\nPSA1OwoKICAgICAgICBkb3VibGVbXSBub0NvbnN1bWVyU3RhdHMgPSBwcm9k\ndWNlTWVzc2FnZXMoZGVzdGluYXRpb24sIHRvU2VuZCwgbnVtSXRlcmF0aW9u\ncywgc2Vzc2lvbiwgcHJvZHVjZXIsIG51bGwpOwoKICAgICAgICBzdGFydENv\nbnN1bWVycyhmYWN0b3J5LCBkZXN0aW5hdGlvbik7CiAgICAgICAgTE9HLmlu\nZm8oIkFjdGl2YXRlZCBjb25zdW1lciIpOwoKICAgICAgICBkb3VibGVbXSB3\naXRoQ29uc3VtZXJTdGF0cyA9IHByb2R1Y2VNZXNzYWdlcyhkZXN0aW5hdGlv\nbiwgdG9TZW5kLCBudW1JdGVyYXRpb25zLCBzZXNzaW9uLCBwcm9kdWNlciwg\nbnVsbCk7CgogICAgICAgIExPRy5pbmZvKCJXaXRoIGNvbnN1bWVyOiAiICsg\nd2l0aENvbnN1bWVyU3RhdHNbMV0gKyAiICwgd2l0aCBub0NvbnN1bWVyOiAi\nICsgbm9Db25zdW1lclN0YXRzWzFdCiAgICAgICAgICAgICAgICArICIsIG11\nbHRpcGxpZXI6ICIgKyAod2l0aENvbnN1bWVyU3RhdHNbMV0vbm9Db25zdW1l\nclN0YXRzWzFdKSk7CiAgICAgICAgZmluYWwgaW50IHJlYXNvbmFibGVNdWx0\naXBsaWVyID0gMTU7IC8vIG5vdCBzbyByZWFzb25hYmxlIGJ1dCBpbXByb3Zp\nbmcKICAgICAgICBhc3NlcnRUcnVlKCJtYXggWCB0aW1lcyBhcyBzbG93IHdp\ndGggY29uc3VtZXI6ICIgKyB3aXRoQ29uc3VtZXJTdGF0c1sxXSArICIsIHdp\ndGggbm8gQ29uc3VtZXI6ICIKICAgICAgICAgICAgICAgICsgbm9Db25zdW1l\nclN0YXRzWzFdICsgIiwgbXVsdGlwbGllcjogIiArICh3aXRoQ29uc3VtZXJT\ndGF0c1sxXS9ub0NvbnN1bWVyU3RhdHNbMV0pLAogICAgICAgICAgICAgICAg\nd2l0aENvbnN1bWVyU3RhdHNbMV0gPCBub0NvbnN1bWVyU3RhdHNbMV0gKiBy\nZWFzb25hYmxlTXVsdGlwbGllcik7CgogICAgICAgIGZpbmFsIGludCB0b1Jl\nY2VpdmUgPSB0b1NlbmQgKiBudW1JdGVyYXRpb25zICogY29uc3VtZXJDb3Vu\ndCAqIDI7CiAgICAgICAgV2FpdC53YWl0Rm9yKG5ldyBXYWl0LkNvbmRpdGlv\nbigpIHsKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaXNTYXRpc2lmaWVk\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBMT0cuaW5m\nbygiY291bnQ6ICIgKyBhbGxNZXNzYWdlc0xpc3QuZ2V0TWVzc2FnZUNvdW50\nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRvUmVjZWl2ZSA9PSBhbGxN\nZXNzYWdlc0xpc3QuZ2V0TWVzc2FnZUNvdW50KCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9LCA2MCAqIDEwMDApOwoKICAgICAgICBhc3NlcnRFcXVhbHMo\nImdvdCBhbGwgbWVzc2FnZXMiLCB0b1JlY2VpdmUsIGFsbE1lc3NhZ2VzTGlz\ndC5nZXRNZXNzYWdlQ291bnQoKSk7CiAgICB9CgoKICAgIHByaXZhdGUgTWVz\nc2FnZVByb2R1Y2VyIGNyZWF0ZU1lc3NhZ2VQcm9kdWNlcihTZXNzaW9uIHNl\nc3Npb24sIERlc3RpbmF0aW9uIGRlc3RpbmF0aW9uKSB0aHJvd3MgSk1TRXhj\nZXB0aW9uIHsKICAgICAgICBNZXNzYWdlUHJvZHVjZXIgcHJvZHVjZXIgPSBz\nZXNzaW9uLmNyZWF0ZVByb2R1Y2VyKGRlc3RpbmF0aW9uKTsKICAgICAgICBw\ncm9kdWNlci5zZXREZWxpdmVyeU1vZGUoRGVsaXZlcnlNb2RlLlBFUlNJU1RF\nTlQpOwogICAgICAgIHJldHVybiBwcm9kdWNlcjsKICAgIH0KCgogICAgcHJp\ndmF0ZSB2b2lkIHN0YXJ0SW5hY3RpdmVDb25zdW1lcnMoQ29ubmVjdGlvbkZh\nY3RvcnkgZmFjdG9yeSwgRGVzdGluYXRpb24gZGVzdGluYXRpb24pIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIC8vIGNyZWF0ZSBvZmYgbGluZSBjb25z\ndW1lcnMKICAgICAgICBzdGFydENvbnN1bWVycyhmYWN0b3J5LCBkZXN0aW5h\ndGlvbik7CiAgICAgICAgZm9yIChDb25uZWN0aW9uIGNvbm5lY3Rpb246IGNv\nbm5lY3Rpb25zKSB7CiAgICAgICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsK\nICAgICAgICB9CiAgICAgICAgY29ubmVjdGlvbnMuY2xlYXIoKTsKICAgICAg\nICBjb25zdW1lcnMuY2xlYXIoKTsKICAgIH0KCgogICAgcHJvdGVjdGVkIHZv\naWQgc3RhcnRDb25zdW1lcnMoQ29ubmVjdGlvbkZhY3RvcnkgZmFjdG9yeSwg\nRGVzdGluYXRpb24gZGVzdCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nTWVzc2FnZUNvbnN1bWVyIGNvbnN1bWVyOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29uc3VtZXJDb3VudDsgaSsrKSB7CiAgICAgICAgICAgIFRp\nbWVkTWVzc2FnZUxpc3RlbmVyIGxpc3QgPSBuZXcgVGltZWRNZXNzYWdlTGlz\ndGVuZXIoKTsKICAgICAgICAgICAgY29uc3VtZXIgPSBjcmVhdGVEdXJhYmxl\nU3Vic2NyaWJlcihmYWN0b3J5LmNyZWF0ZUNvbm5lY3Rpb24oKSwgZGVzdCwg\nImNvbnN1bWVyIiArIChpICsgMSkpOwogICAgICAgICAgICBjb25zdW1lci5z\nZXRNZXNzYWdlTGlzdGVuZXIobGlzdCk7CiAgICAgICAgICAgIGNvbnN1bWVy\ncy5wdXQoY29uc3VtZXIsIGxpc3QpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncm90ZWN0ZWQgVG9waWNTdWJzY3JpYmVyIGNyZWF0ZUR1cmFibGVTdWJzY3Jp\nYmVyKENvbm5lY3Rpb24gY29ubiwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzdGluYXRpb24gZGVz\ndCwgU3RyaW5nIG5hbWUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGNv\nbm4uc2V0Q2xpZW50SUQobmFtZSk7CiAgICAgICAgY29ubmVjdGlvbnMuYWRk\nKGNvbm4pOwogICAgICAgIGNvbm4uc3RhcnQoKTsKCiAgICAgICAgU2Vzc2lv\nbiBzZXNzID0gY29ubi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFV\nVE9fQUNLTk9XTEVER0UpOwogICAgICAgIGZpbmFsIFRvcGljU3Vic2NyaWJl\nciBjb25zdW1lciA9IHNlc3MuY3JlYXRlRHVyYWJsZVN1YnNjcmliZXIoKGph\ndmF4Lmptcy5Ub3BpYylkZXN0LCBuYW1lKTsKCiAgICAgICAgcmV0dXJuIGNv\nbnN1bWVyOwogICAgfQoKICAgIC8qKgogICAgICogQHJldHVybiBtYXggYW5k\nIGF2ZSBzZW5kIHRpbWUKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAg\nKi8KICAgIHByaXZhdGUgZG91YmxlW10gcHJvZHVjZU1lc3NhZ2VzKERlc3Rp\nbmF0aW9uIGRlc3RpbmF0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgZmluYWwgaW50IHRvU2VuZCwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIGludCBudW1JdGVyYXRpb25z\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2Vzc2lv\nbiBzZXNzaW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgTWVzc2FnZVByb2R1Y2VyIHByb2R1Y2VyLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgT2JqZWN0IGFkZENvbnN1bWVyU2lnbmFs\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBsb25nIHN0YXJ0OwogICAg\nICAgIGxvbmcgY291bnQgPSAwOwogICAgICAgIGRvdWJsZSBiYXRjaE1heCA9\nIDAsIG1heCA9IDAsIHN1bSA9IDA7CiAgICAgICAgZm9yIChpbnQgaT0wOyBp\nPG51bUl0ZXJhdGlvbnM7IGkrKykgewogICAgICAgICAgICBzdGFydCA9IFN5\nc3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICBmb3IgKGlu\ndCBqPTA7IGogPCB0b1NlbmQ7IGorKykgewogICAgICAgICAgICAgICAgbG9u\nZyBzaW5nbGVTZW5kc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMo\nKTsKICAgICAgICAgICAgICAgIFRleHRNZXNzYWdlIG1zZyA9IGNyZWF0ZVRl\neHRNZXNzYWdlKHNlc3Npb24sICIiICsgaik7CiAgICAgICAgICAgICAgICAv\nLyByb3RhdGUKICAgICAgICAgICAgICAgIGludCBwcmlvcml0eSA9ICgoaW50\nKWNvdW50JTEwKTsKICAgICAgICAgICAgICAgIHByb2R1Y2VyLnNlbmQobXNn\nLCBEZWxpdmVyeU1vZGUuUEVSU0lTVEVOVCwgcHJpb3JpdHksIDApOwogICAg\nICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXgobWF4LCAoU3lzdGVtLmN1cnJl\nbnRUaW1lTWlsbGlzKCkgLSBzaW5nbGVTZW5kc3RhcnQpKTsKICAgICAgICAg\nICAgICAgIGlmICgrK2NvdW50ICUgNTAwID09IDApIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoYWRkQ29uc3VtZXJTaWduYWwgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBzeW5jaHJvbml6ZWQgKGFkZENvbnN1bWVy\nU2lnbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRDb25z\ndW1lclNpZ25hbC5ub3RpZnlBbGwoKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIExPRy5pbmZvKCJTaWduYWxsZWQgYWRkIGNvbnN1bWVyIik7CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICA7CiAgICAgICAg\nICAgICAgICBpZiAoY291bnQgJSA1MDAwID09IDApIHsKICAgICAgICAgICAg\nICAgICAgICBMT0cuaW5mbygiU2VudCAiICsgY291bnQgKyAiLCBzaW5nbGVT\nZW5kTWF4OiIgKyBtYXgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgfQogICAgICAgICAgICBsb25nIGR1cmF0aW9uID0gU3lzdGVtLmN1cnJl\nbnRUaW1lTWlsbGlzKCkgLSBzdGFydDsKICAgICAgICAgICAgYmF0Y2hNYXgg\nPSBNYXRoLm1heChiYXRjaE1heCwgZHVyYXRpb24pOwogICAgICAgICAgICBz\ndW0gKz0gZHVyYXRpb247CiAgICAgICAgICAgIExPRy5pbmZvKCJJdGVyYXRp\nb24gIiArIGkgKyAiLCBzZW50ICIgKyB0b1NlbmQgKyAiLCB0aW1lOiAiCiAg\nICAgICAgICAgICAgICAgICAgKyBkdXJhdGlvbiArICIsIGJhdGNoTWF4OiIg\nKyBiYXRjaE1heCArICIsIHNpbmdsZVNlbmRNYXg6IiArIG1heCk7CiAgICAg\nICAgfQoKICAgICAgICBMT0cuaW5mbygiU2VudDogIiArIHRvU2VuZCAqIG51\nbUl0ZXJhdGlvbnMgKyAiLCBiYXRjaE1heDogIiArIGJhdGNoTWF4ICsgIiBz\naW5nbGVTZW5kTWF4OiAiICsgbWF4KTsKICAgICAgICByZXR1cm4gbmV3IGRv\ndWJsZVtde2JhdGNoTWF4LCBzdW0vbnVtSXRlcmF0aW9uc307CiAgICB9Cgog\nICAgcHJvdGVjdGVkIFRleHRNZXNzYWdlIGNyZWF0ZVRleHRNZXNzYWdlKFNl\nc3Npb24gc2Vzc2lvbiwgU3RyaW5nIGluaXRUZXh0KSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBUZXh0TWVzc2FnZSBtc2cgPSBzZXNzaW9uLmNyZWF0\nZVRleHRNZXNzYWdlKCk7CgogICAgICAgIC8vIFBhZCBtZXNzYWdlIHRleHQK\nICAgICAgICBpZiAoaW5pdFRleHQubGVuZ3RoKCkgPCBtZXNzYWdlU2l6ZSkg\newogICAgICAgICAgICBjaGFyW10gZGF0YSA9IG5ldyBjaGFyW21lc3NhZ2VT\naXplIC0gaW5pdFRleHQubGVuZ3RoKCldOwogICAgICAgICAgICBBcnJheXMu\nZmlsbChkYXRhLCAnKicpOwogICAgICAgICAgICBTdHJpbmcgc3RyID0gbmV3\nIFN0cmluZyhkYXRhKTsKICAgICAgICAgICAgbXNnLnNldFRleHQoaW5pdFRl\neHQgKyBzdHIpOwoKICAgICAgICAgICAgLy8gRG8gbm90IHBhZCBtZXNzYWdl\nIHRleHQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtc2cuc2V0VGV4\ndChpbml0VGV4dCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbXNnOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgc2V0VXAo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0b3BpYyA9IHRydWU7CiAg\nICAgICAgc3VwZXIuc2V0VXAoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgZm9yIChJdGVyYXRvcjxDb25uZWN0aW9uPiBpdGVyID0gY29u\nbmVjdGlvbnMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgIENvbm5lY3Rpb24gY29ubiA9IGl0ZXIubmV4dCgpOwogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgY29ubi5jbG9zZSgpOwogICAg\nICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgZSkgewogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIGFsbE1lc3NhZ2VzTGlzdC5mbHVzaE1lc3Nh\nZ2VzKCk7CiAgICAgICAgY29uc3VtZXJzLmNsZWFyKCk7CiAgICAgICAgc3Vw\nZXIudGVhckRvd24oKTsKICAgIH0KCgogICAgcHJvdGVjdGVkIEhlZHdpZ0Nv\nbm5lY3Rpb25GYWN0b3J5SW1wbCBjcmVhdGVDb25uZWN0aW9uRmFjdG9yeSgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEhlZHdpZ0Nvbm5lY3Rpb25G\nYWN0b3J5SW1wbCBmYWN0b3J5ID0gbmV3IEhlZHdpZ0Nvbm5lY3Rpb25GYWN0\nb3J5SW1wbCgpOwogICAgICAgIHJldHVybiBmYWN0b3J5OwogICAgfQoKICAg\nIHB1YmxpYyBzdGF0aWMgVGVzdCBzdWl0ZSgpIHsKICAgICAgICByZXR1cm4g\nc3VpdGUoQ29uY3VycmVudFByb2R1Y2VyRHVyYWJsZUNvbnN1bWVyVGVzdC5j\nbGFzcyk7CiAgICB9CgogICAgY2xhc3MgVGltZWRNZXNzYWdlTGlzdGVuZXIg\naW1wbGVtZW50cyBNZXNzYWdlTGlzdGVuZXIgewogICAgICAgIGZpbmFsIGlu\ndCBiYXRjaFNpemUgPSAxMDAwOwogICAgICAgIENvdW50RG93bkxhdGNoIGZp\ncnN0UmVjZWlwdExhdGNoID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAg\nICAgIGxvbmcgbWFyayA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgIGxvbmcgZmlyc3RSZWNlaXB0ID0gMGw7CiAgICAgICAgbG9uZyBy\nZWNlaXB0QWNjdW11bGF0b3IgPSAwOwogICAgICAgIGxvbmcgYmF0Y2hSZWNl\naXB0QWNjdW11bGF0b3IgPSAwOwogICAgICAgIGxvbmcgbWF4UmVjZWlwdFRp\nbWUgPSAwOwogICAgICAgIEF0b21pY0xvbmcgY291bnQgPSBuZXcgQXRvbWlj\nTG9uZygwKTsKICAgICAgICBNYXA8SW50ZWdlciwgTWVzc2FnZUlkTGlzdD4g\nbWVzc2FnZUxpc3RzCiAgICAgICAgICAgID0gbmV3IENvbmN1cnJlbnRIYXNo\nTWFwPEludGVnZXIsIE1lc3NhZ2VJZExpc3Q+KG5ldyBIYXNoTWFwPEludGVn\nZXIsIE1lc3NhZ2VJZExpc3Q+KCkpOwoKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBwdWJsaWMgdm9pZCBvbk1lc3NhZ2UoTWVzc2FnZSBtZXNzYWdlKSB7\nCiAgICAgICAgICAgIGZpbmFsIGxvbmcgY3VycmVudCA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICBmaW5hbCBsb25nIGR1cmF0\naW9uID0gY3VycmVudCAtIG1hcms7CiAgICAgICAgICAgIHJlY2VpcHRBY2N1\nbXVsYXRvciArPSBkdXJhdGlvbjsKICAgICAgICAgICAgaW50IHByaW9yaXR5\nID0gMDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHByaW9y\naXR5ID0gbWVzc2FnZS5nZXRKTVNQcmlvcml0eSgpOwogICAgICAgICAgICB9\nIGNhdGNoIChKTVNFeGNlcHRpb24gaWdub3JlZCkge30KICAgICAgICAgICAg\naWYgKCFtZXNzYWdlTGlzdHMuY29udGFpbnNLZXkocHJpb3JpdHkpKSB7CiAg\nICAgICAgICAgICAgICBtZXNzYWdlTGlzdHMucHV0KHByaW9yaXR5LCBuZXcg\nTWVzc2FnZUlkTGlzdCgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBt\nZXNzYWdlTGlzdHMuZ2V0KHByaW9yaXR5KS5vbk1lc3NhZ2UobWVzc2FnZSk7\nCiAgICAgICAgICAgIGlmIChjb3VudC5pbmNyZW1lbnRBbmRHZXQoKSA9PSAx\nKSB7CiAgICAgICAgICAgICAgICBmaXJzdFJlY2VpcHQgPSBkdXJhdGlvbjsK\nICAgICAgICAgICAgICAgIGZpcnN0UmVjZWlwdExhdGNoLmNvdW50RG93bigp\nOwogICAgICAgICAgICAgICAgTE9HLmluZm8oIkZpcnN0IHJlY2VpcHQgaW4g\nIiArIGZpcnN0UmVjZWlwdCArICJtcyIpOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKGNvdW50LmdldCgpICUgYmF0Y2hTaXplID09IDApIHsKICAgICAgICAg\nICAgICAgIExPRy5pbmZvKCJDb25zdW1lZCAiICsgY291bnQuZ2V0KCkgKyAi\nIGluICIKICAgICAgICAgICAgICAgICAgICAgICAgICsgYmF0Y2hSZWNlaXB0\nQWNjdW11bGF0b3IgKyAibXMiICsgIiwgcHJpb3JpdHk6IiArIHByaW9yaXR5\nKTsKICAgICAgICAgICAgICAgIGJhdGNoUmVjZWlwdEFjY3VtdWxhdG9yPTA7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWF4UmVjZWlwdFRpbWUgPSBN\nYXRoLm1heChtYXhSZWNlaXB0VGltZSwgZHVyYXRpb24pOwogICAgICAgICAg\nICByZWNlaXB0QWNjdW11bGF0b3IgKz0gZHVyYXRpb247CiAgICAgICAgICAg\nIGJhdGNoUmVjZWlwdEFjY3VtdWxhdG9yICs9IGR1cmF0aW9uOwogICAgICAg\nICAgICBtYXJrID0gY3VycmVudDsKICAgICAgICB9CgogICAgICAgIGxvbmcg\nZ2V0TWVzc2FnZUNvdW50KCkgewogICAgICAgICAgICByZXR1cm4gY291bnQu\nZ2V0KCk7CiAgICAgICAgfQoKICAgICAgICBsb25nIGdldEZpcnN0UmVjZWlw\ndCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBmaXJzdFJlY2Vp\ncHRMYXRjaC5hd2FpdCgzMCwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAgICAg\nICAgIHJldHVybiBmaXJzdFJlY2VpcHQ7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgbG9uZyB3YWl0Rm9yUmVjZWl2ZWRMaW1pdChsb25nIGxpbWl0KSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgZmluYWwgbG9uZyBleHBp\ncnkgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSArIDMwKjYwKjEwMDA7\nCiAgICAgICAgICAgIHdoaWxlIChjb3VudC5nZXQoKSA8IGxpbWl0KSB7CiAg\nICAgICAgICAgICAgICBpZiAoU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkg\nPiBleHBpcnkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVu\ndGltZUV4Y2VwdGlvbigiRXhwaXJlZCB3YWl0aW5nIGZvciBYIG1lc3NhZ2Vz\nLCAiICsgbGltaXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgVGltZVVuaXQuU0VDT05EUy5zbGVlcCgyKTsKICAgICAgICAgICAgICAg\nIFN0cmluZyBtaXNzaW5nID0gZmluZEZpcnN0TWlzc2luZ01lc3NhZ2UoKTsK\nICAgICAgICAgICAgICAgIGlmIChtaXNzaW5nICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICBMT0cuaW5mbygiZmlyc3QgbWlzc2luZyA9ICIgKyBt\naXNzaW5nKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGlt\nZUV4Y2VwdGlvbigiV2UgaGF2ZSBhIG1pc3NpbmcgbWVzc2FnZS4gIiArIG1p\nc3NpbmcpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAg\nICAgICAgICByZXR1cm4gcmVjZWlwdEFjY3VtdWxhdG9yLyhsaW1pdC9iYXRj\naFNpemUpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBTdHJpbmcgZmlu\nZEZpcnN0TWlzc2luZ01lc3NhZ2UoKSB7CiAgICAgICAgICAgIC8qCiAgICAg\nICAgICAgIE1lc3NhZ2VJZCBjdXJyZW50ID0gbmV3IE1lc3NhZ2VJZCgpOwog\nICAgICAgICAgICBmb3IgKE1lc3NhZ2VJZExpc3QgcHJpb3JpdHlMaXN0IDog\nbWVzc2FnZUxpc3RzLnZhbHVlcygpKSB7CiAgICAgICAgICAgICAgICBNZXNz\nYWdlSWQgcHJldmlvdXMgPSBudWxsOwogICAgICAgICAgICAgICAgZm9yIChT\ndHJpbmcgaWQgOiBwcmlvcml0eUxpc3QuZ2V0TWVzc2FnZUlkcygpKSB7CiAg\nICAgICAgICAgICAgICAgICAgY3VycmVudC5zZXRWYWx1ZShpZCk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzID09IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgcHJldmlvdXMgPSBjdXJyZW50LmNvcHkoKTsK\nICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoY3VycmVudC5nZXRQcm9kdWNlclNlcXVlbmNlSWQoKSAt\nIDEgIT0gcHJldmlvdXMuZ2V0UHJvZHVjZXJTZXF1ZW5jZUlkKCkgJiYKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuZ2V0UHJvZHVjZXJT\nZXF1ZW5jZUlkKCkgLSAxMCAhPSAgcHJldmlvdXMuZ2V0UHJvZHVjZXJTZXF1\nZW5jZUlkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gIk1pc3NpbmcgbmV4dCBhZnRlcjogIiArIHByZXZpb3VzICsgIiwg\nZ290OiAiICsgY3VycmVudDsKICAgICAgICAgICAgICAgICAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0g\nY3VycmVudC5jb3B5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICov\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCn0K\n","encoding":"base64"}

