{"sha":"fa79d69ea1a85ad6ff7a2840847e267efad82f5e","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmE3OWQ2OWVhMWE4NWFkNmZmN2EyODQwODQ3ZTI2N2VmYWQ4MmY1ZQ==","size":7537,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fa79d69ea1a85ad6ff7a2840847e267efad82f5e","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLnVzZWNhc2VzOwoKaW1wb3J0IGphdmF4\nLmptcy5Ub3BpYzsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvdW50\nRG93bkxhdGNoOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLkptc1Rlc3RC\nYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuam1zLlNlc3Npb25JbXBs\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0lu\ndGVnZXI7CmltcG9ydCBqYXZheC5qbXMuQ29ubmVjdGlvbjsKaW1wb3J0IGph\ndmF4Lmptcy5EZXN0aW5hdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5KTVNFeGNl\ncHRpb247CmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZTsKaW1wb3J0IGphdmF4\nLmptcy5NZXNzYWdlQ29uc3VtZXI7CmltcG9ydCBqYXZheC5qbXMuTWVzc2Fn\nZVByb2R1Y2VyOwppbXBvcnQgamF2YXguam1zLlNlc3Npb247CmltcG9ydCBq\ndW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5qbXMuc3BpLkhlZHdpZ0Nvbm5lY3Rpb25GYWN0b3J5SW1wbDsKCgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwoKcHVibGljIGNsYXNzIERpc3BhdGNoTXVsdGlwbGVDb25z\ndW1lcnNUZXN0IGV4dGVuZHMgSm1zVGVzdEJhc2UgewogICAgcHJpdmF0ZSBm\naW5hbCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKERpc3BhdGNoTXVsdGlwbGVDb25zdW1lcnNUZXN0LmNsYXNzKTsK\nICAgIERlc3RpbmF0aW9uIGRlc3Q7CiAgICBTdHJpbmcgZGVzdGluYXRpb25O\nYW1lID0gIlRFU1QuUSI7CiAgICBTdHJpbmcgbXNnU3RyID0gIlRlc3QgdGV4\ndCBtZXNzYWdlIjsKICAgIGludCBtZXNzYWdlc1BlclRocmVhZCA9IDIwOwog\nICAgaW50IHByb2R1Y2VyVGhyZWFkcyA9IDUwOwogICAgaW50IGNvbnN1bWVy\nQ291bnQgPSAyOwogICAgQXRvbWljSW50ZWdlciBzZW50Q291bnQ7CiAgICBB\ndG9taWNJbnRlZ2VyIGNvbnN1bWVkQ291bnQ7CiAgICBDb3VudERvd25MYXRj\naCBwcm9kdWNlckxhdGNoOwogICAgQ291bnREb3duTGF0Y2ggY29uc3VtZXJM\nYXRjaDsKICAgIFN0cmluZyB1c2VyTmFtZSA9ICIiOwogICAgU3RyaW5nIHBh\nc3N3b3JkID0gIiI7CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNl\ndFVwKCk7CiAgICAgICAgZGVzdCA9IFNlc3Npb25JbXBsLmFzVG9waWMoZGVz\ndGluYXRpb25OYW1lKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgcmVzZXRD\nb3VudGVycygpIHsKICAgICAgICBzZW50Q291bnQgPSBuZXcgQXRvbWljSW50\nZWdlcigwKTsKICAgICAgICBjb25zdW1lZENvdW50ID0gbmV3IEF0b21pY0lu\ndGVnZXIoMCk7CiAgICAgICAgcHJvZHVjZXJMYXRjaCA9IG5ldyBDb3VudERv\nd25MYXRjaChwcm9kdWNlclRocmVhZHMpOwogICAgICAgIGNvbnN1bWVyTGF0\nY2ggPSBuZXcgQ291bnREb3duTGF0Y2goY29uc3VtZXJDb3VudCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdERpc3BhdGNoMSgpIHsKICAgICAgICBm\nb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspIHsKICAgICAgICAgICAgcmVz\nZXRDb3VudGVycygpOwogICAgICAgICAgICBkaXNwYXRjaCgpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBtZXNzYWdlcyBpbiBJdGVy\nYXRpb24gIiArIGksIHNlbnRDb3VudC5nZXQoKSAqIGNvbnN1bWVyQ291bnQs\nIGNvbnN1bWVkQ291bnQuZ2V0KCkpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgZGlzcGF0Y2goKSB7CiAgICAgICAgc3RhcnRDb25zdW1l\ncnMoKTsKICAgICAgICBzdGFydFByb2R1Y2VycygpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHByb2R1Y2VyTGF0Y2guYXdhaXQoKTsKICAgICAgICAg\nICAgY29uc3VtZXJMYXRjaC5hd2FpdCgpOwogICAgICAgIH0gY2F0Y2ggKElu\ndGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgZmFpbCgidGVz\ndCBpbnRlcnJ1cHRlZCEiKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0\nZSB2b2lkIHN0YXJ0Q29uc3VtZXJzKCkgewogICAgICAgIEhlZHdpZ0Nvbm5l\nY3Rpb25GYWN0b3J5SW1wbCBjb25uRmFjdG9yeSA9IG5ldyBIZWR3aWdDb25u\nZWN0aW9uRmFjdG9yeUltcGwoKTsKICAgICAgICBDb25uZWN0aW9uIGNvbm47\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29ubiA9IGNvbm5GYWN0b3J5\nLmNyZWF0ZUNvbm5lY3Rpb24odXNlck5hbWUsIHBhc3N3b3JkKTsKICAgICAg\nICAgICAgY29ubi5zdGFydCgpOwogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbnN1bWVyQ291bnQ7IGkrKykgewogICAgICAgICAgICAgICAg\nQ29uc3VtZXJUaHJlYWQgdGggPSBuZXcgQ29uc3VtZXJUaHJlYWQoY29ubiwg\nIkNvbnN1bWVyVGhyZWFkIitpKTsKICAgICAgICAgICAgICAgIHRoLnN0YXJ0\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChKTVNFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkZhaWxlZCB0byBz\ndGFydCBjb25zdW1lcnMiLCBlKTsKICAgICAgICB9CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIHN0YXJ0UHJvZHVjZXJzKCkgewogICAgICAgIEhlZHdpZ0Nv\nbm5lY3Rpb25GYWN0b3J5SW1wbCBjb25uRmFjdG9yeSA9IG5ldyBIZWR3aWdD\nb25uZWN0aW9uRmFjdG9yeUltcGwoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHByb2R1Y2VyVGhyZWFkczsgaSsrKSB7CiAgICAgICAgICAgIFRo\ncmVhZCB0aCA9IG5ldyBQcm9kdWNlclRocmVhZChjb25uRmFjdG9yeSwgbWVz\nc2FnZXNQZXJUaHJlYWQsICJQcm9kdWNlclRocmVhZCIraSk7CiAgICAgICAg\nICAgIHRoLnN0YXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\nY2xhc3MgQ29uc3VtZXJUaHJlYWQgZXh0ZW5kcyBUaHJlYWQgewogICAgICAg\nIHByaXZhdGUgU2Vzc2lvbiBzZXNzaW9uOwogICAgICAgIHByaXZhdGUgTWVz\nc2FnZUNvbnN1bWVyIGNvbnN1bWVyOwoKICAgICAgICBwdWJsaWMgQ29uc3Vt\nZXJUaHJlYWQoQ29ubmVjdGlvbiBjb25uLCBTdHJpbmcgbmFtZSkgewogICAg\nICAgICAgICBzdXBlcigpOwogICAgICAgICAgICB0aGlzLnNldE5hbWUobmFt\nZSk7CiAgICAgICAgICAgIGxvZ2dlci50cmFjZSgiQ3JlYXRlZCBuZXcgY29u\nc3VtZXIgdGhyZWFkOiIgKyBuYW1lKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHNlc3Npb24gPSBjb25uLmNyZWF0ZVNlc3Npb24oZmFs\nc2UsIFNlc3Npb24uQVVUT19BQ0tOT1dMRURHRSk7CiAgICAgICAgICAgICAg\nICBjb25zdW1lciA9IHNlc3Npb24uY3JlYXRlQ29uc3VtZXIoZGVzdCk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKEpNU0V4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICBsb2dnZXIuZXJyb3IoIkZhaWxlZCB0byBzdGFydCBjb25zdW1l\nciB0aHJlYWQ6IiArIG5hbWUsIGUpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgIGludCBtc2dDb3VudCA9IDA7CiAgICAgICAgICAg\nIGludCBudWxsQ291bnQgPSAwOwogICAgICAgICAgICB3aGlsZSAodHJ1ZSkg\newogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBN\nZXNzYWdlIG1zZyA9IGNvbnN1bWVyLnJlY2VpdmUoMjAwKTsKICAgICAgICAg\nICAgICAgICAgICBpZiAobXNnID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKHByb2R1Y2VyTGF0Y2guZ2V0Q291bnQoKSA+IDApIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIG51\nbGxDb3VudCsrOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbENv\ndW50ID4gMTApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYXNz\ndW1lIHRoYXQgd2UgYXJlIG5vdCBnZXR0aW5nIGFueSBtb3JlIG1lc3NhZ2Vz\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgbnVsbENvdW50ID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgLy8gVGhyZWFkLnNsZWVwKDEwMCk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc1RyYWNlRW5hYmxlZCgpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci50cmFjZSgiTWVzc2Fn\nZSByZWNlaXZlZDoiICsgbXNnLmdldEpNU01lc3NhZ2VJRCgpKTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbXNnQ291bnQr\nKzsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEpNU0V4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJGYWlsZWQgdG8g\nY29uc3VtZToiLCBlKTsKICAgICAgICAgICAgICAgICAgICAvKgogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiSW50ZXJydXB0ZWQh\nIiwgZSk7CiAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgY29uc3VtZXIuY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nSk1TRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJv\ncigiRmFpbGVkIHRvIGNsb3NlIGNvbnN1bWVyICIgKyBnZXROYW1lKCksIGUp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN1bWVkQ291bnQuYWRk\nQW5kR2V0KG1zZ0NvdW50KTsKICAgICAgICAgICAgY29uc3VtZXJMYXRjaC5j\nb3VudERvd24oKTsKICAgICAgICAgICAgbG9nZ2VyLnRyYWNlKCJDb25zdW1l\nZCAiICsgbXNnQ291bnQgKyAiIG1lc3NhZ2VzIHVzaW5nIHRocmVhZCAiICsg\nZ2V0TmFtZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBjbGFz\ncyBQcm9kdWNlclRocmVhZCBleHRlbmRzIFRocmVhZCB7CiAgICAgICAgcHJp\ndmF0ZSBpbnQgY291bnQ7CiAgICAgICAgcHJpdmF0ZSBDb25uZWN0aW9uIGNv\nbm47CiAgICAgICAgcHJpdmF0ZSBTZXNzaW9uIHNlc3Npb247CiAgICAgICAg\ncHJpdmF0ZSBNZXNzYWdlUHJvZHVjZXIgcHJvZHVjZXI7CgogICAgICAgIHB1\nYmxpYyBQcm9kdWNlclRocmVhZChIZWR3aWdDb25uZWN0aW9uRmFjdG9yeUlt\ncGwgY29ubkZhY3RvcnksIGludCBjb3VudCwgU3RyaW5nIG5hbWUpIHsKICAg\nICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgdGhpcy5jb3VudCA9IGNv\ndW50OwogICAgICAgICAgICB0aGlzLnNldE5hbWUobmFtZSk7CiAgICAgICAg\nICAgIGxvZ2dlci50cmFjZSgiQ3JlYXRlZCBuZXcgcHJvZHVjZXIgdGhyZWFk\nOiIgKyBuYW1lKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGNvbm4gPSBjb25uRmFjdG9yeS5jcmVhdGVDb25uZWN0aW9uKCk7CiAgICAg\nICAgICAgICAgICBjb25uLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICBzZXNz\naW9uID0gY29ubi5jcmVhdGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkFVVE9f\nQUNLTk9XTEVER0UpOwogICAgICAgICAgICAgICAgcHJvZHVjZXIgPSBzZXNz\naW9uLmNyZWF0ZVByb2R1Y2VyKGRlc3QpOwogICAgICAgICAgICB9IGNhdGNo\nIChKTVNFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJGYWlsZWQgdG8gc3RhcnQgcHJvZHVjZXIgdGhyZWFkOiIgKyBuYW1l\nLCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICBp\nbnQgaSA9IDA7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBm\nb3IgKDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBw\ncm9kdWNlci5zZW5kKHNlc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UobXNnU3Ry\nKSk7CiAgICAgICAgICAgICAgICAgICAgLy8gVGhyZWFkLnNsZWVwKDUwMCk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25uLmNsb3Nl\nKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEpNU0V4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZS5nZXRNZXNzYWdlKCksIGUp\nOwogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9nZ2Vy\nLmVycm9yKCJJbnRlcnJ1cHRlZCEiLCBlKTsKICAgICAgICAgICAgICAgICov\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VudENvdW50LmFkZEFuZEdl\ndChpKTsKICAgICAgICAgICAgcHJvZHVjZXJMYXRjaC5jb3VudERvd24oKTsK\nICAgICAgICAgICAgaWYgKGxvZ2dlci5pc1RyYWNlRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgICAgICBsb2dnZXIudHJhY2UoIlNlbnQgIiArIGkgKyAiIG1l\nc3NhZ2VzIGZyb20gdGhyZWFkICIgKyBnZXROYW1lKCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

