{"sha":"c4fa74de491bf5d9b53c7d747c0212fa5abc7033","node_id":"MDQ6QmxvYjE1NzU5NTY6YzRmYTc0ZGU0OTFiZjVkOWI1M2M3ZDc0N2MwMjEyZmE1YWJjNzAzMw==","size":6272,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/c4fa74de491bf5d9b53c7d747c0212fa5abc7033","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLnVzZWNhc2VzOwoKaW1wb3J0IGphdmF4\nLmptcy5Db25uZWN0aW9uOwppbXBvcnQgamF2YXguam1zLkRlbGl2ZXJ5TW9k\nZTsKaW1wb3J0IGphdmF4Lmptcy5EZXN0aW5hdGlvbjsKaW1wb3J0IGphdmF4\nLmptcy5KTVNFeGNlcHRpb247CmltcG9ydCBqYXZheC5qbXMuTWVzc2FnZTsK\naW1wb3J0IGphdmF4Lmptcy5NZXNzYWdlQ29uc3VtZXI7CmltcG9ydCBqYXZh\neC5qbXMuTWVzc2FnZVByb2R1Y2VyOwppbXBvcnQgamF2YXguam1zLlNlc3Np\nb247CmltcG9ydCBqYXZheC5qbXMuVGV4dE1lc3NhZ2U7CmltcG9ydCBqYXZh\neC5qbXMuVG9waWM7CgppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuam1zLnNw\naS5IZWR3aWdDb25uZWN0aW9uRmFjdG9yeUltcGw7CmltcG9ydCBvcmcuYXBh\nY2hlLmFjdGl2ZW1xLnRlc3QuVGVzdFN1cHBvcnQ7CmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7Cgpw\ndWJsaWMgY2xhc3MgRHVyYWJsZUNvbnN1bWVyQ2xvc2VBbmRSZWNvbm5lY3RU\nZXN0IGV4dGVuZHMgVGVzdFN1cHBvcnQgewogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBsb25nIFJFQ0VJVkVfVElNRU9VVCA9IDUwMDBMOwogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3Rvcnku\nZ2V0TG9nZ2VyKER1cmFibGVDb25zdW1lckNsb3NlQW5kUmVjb25uZWN0VGVz\ndC5jbGFzcyk7CgogICAgcHJvdGVjdGVkIENvbm5lY3Rpb24gY29ubmVjdGlv\nbjsKICAgIHByaXZhdGUgU2Vzc2lvbiBzZXNzaW9uOwogICAgcHJpdmF0ZSBN\nZXNzYWdlQ29uc3VtZXIgY29uc3VtZXI7CiAgICBwcml2YXRlIE1lc3NhZ2VQ\ncm9kdWNlciBwcm9kdWNlcjsKICAgIHByaXZhdGUgRGVzdGluYXRpb24gZGVz\ndGluYXRpb247CiAgICBwcml2YXRlIGludCBtZXNzYWdlQ291bnQ7CgogICAg\nQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRVcCgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgZGVs\nZXRlQWxsTWVzc2FnZXMoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgc3VwZXIudGVhckRvd24oKTsKICAgICAgICBkZWxldGVBbGxNZXNz\nYWdlcygpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBkZWxldGVBbGxNZXNz\nYWdlcygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEhlZHdpZ0Nvbm5l\nY3Rpb25GYWN0b3J5SW1wbCBmYWMgPSBuZXcgSGVkd2lnQ29ubmVjdGlvbkZh\nY3RvcnlJbXBsKCk7CiAgICAgICAgQ29ubmVjdGlvbiBkdW1teUNvbm5lY3Rp\nb24gPSBmYWMuY3JlYXRlQ29ubmVjdGlvbigpOwogICAgICAgIGR1bW15Q29u\nbmVjdGlvbi5zdGFydCgpOwogICAgICAgIGR1bW15Q29ubmVjdGlvbi5jbG9z\nZSgpOwogICAgfQoKICAgIHByb3RlY3RlZCBIZWR3aWdDb25uZWN0aW9uRmFj\ndG9yeUltcGwgY3JlYXRlQ29ubmVjdGlvbkZhY3RvcnkoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICByZXR1cm4gbmV3IEhlZHdpZ0Nvbm5lY3Rpb25G\nYWN0b3J5SW1wbCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RDcmVh\ndGVEdXJhYmxlQ29uc3VtZXJDbG9zZVRoZW5SZWNvbm5lY3QoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBmb3JjZSB0aGUgc2VydmVyIHRvIHN0\nYXkgdXAgYWNyb3NzIGJvdGggY29ubmVjdGlvbiB0ZXN0cwogICAgICAgIENv\nbm5lY3Rpb24gZHVtbXlDb25uZWN0aW9uID0gY3JlYXRlQ29ubmVjdGlvbigp\nOwogICAgICAgIGR1bW15Q29ubmVjdGlvbi5zdGFydCgpOwoKICAgICAgICBj\nb25zdW1lTWVzc2FnZXNEZWxpdmVyZWRXaGlsZUNvbnN1bWVyQ2xvc2VkKCk7\nCgogICAgICAgIGR1bW15Q29ubmVjdGlvbi5jbG9zZSgpOwoKICAgICAgICAv\nLyBub3cgbGV0cyB0cnkgYWdhaW4gd2l0aG91dCBvbmUgY29ubmVjdGlvbiBv\ncGVuCiAgICAgICAgY29uc3VtZU1lc3NhZ2VzRGVsaXZlcmVkV2hpbGVDb25z\ndW1lckNsb3NlZCgpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGNvbnN1\nbWVNZXNzYWdlc0RlbGl2ZXJlZFdoaWxlQ29uc3VtZXJDbG9zZWQoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBtYWtlQ29uc3VtZXIoKTsKICAgICAg\nICBjbG9zZUNvbnN1bWVyKCk7CgogICAgICAgIHB1Ymxpc2goKTsKCiAgICAg\nICAgLy8gd2FpdCBhIGZldyBtb21lbnRzIGZvciB0aGUgY2xvc2UgdG8gcmVh\nbGx5IG9jY3VyCiAgICAgICAgVGhyZWFkLnNsZWVwKDEwMDApOwoKICAgICAg\nICBtYWtlQ29uc3VtZXIoKTsKCiAgICAgICAgTWVzc2FnZSBtZXNzYWdlID0g\nY29uc3VtZXIucmVjZWl2ZShSRUNFSVZFX1RJTUVPVVQpOwogICAgICAgIGFz\nc2VydFRydWUoIlNob3VsZCBoYXZlIHJlY2VpdmVkIGEgbWVzc2FnZSEiLCBt\nZXNzYWdlICE9IG51bGwpOwoKICAgICAgICBjbG9zZUNvbnN1bWVyKCk7Cgog\nICAgICAgIExPRy5pbmZvKCJOb3cgbGV0cyBjcmVhdGUgdGhlIGNvbnN1bWVy\nIGFnYWluIGFuZCBiZWNhdXNlIHdlIGRpZG4ndCBhY2ssIHdlIHNob3VsZCBn\nZXQgaXQgYWdhaW4iKTsKICAgICAgICBtYWtlQ29uc3VtZXIoKTsKCiAgICAg\nICAgbWVzc2FnZSA9IGNvbnN1bWVyLnJlY2VpdmUoUkVDRUlWRV9USU1FT1VU\nKTsKICAgICAgICBhc3NlcnRUcnVlKCJTaG91bGQgaGF2ZSByZWNlaXZlZCBh\nIG1lc3NhZ2UhIiwgbWVzc2FnZSAhPSBudWxsKTsKICAgICAgICBtZXNzYWdl\nLmFja25vd2xlZGdlKCk7CgogICAgICAgIGNsb3NlQ29uc3VtZXIoKTsKCiAg\nICAgICAgTE9HLmluZm8oIk5vdyBsZXRzIGNyZWF0ZSB0aGUgY29uc3VtZXIg\nYWdhaW4gYW5kIGJlY2F1c2Ugd2UgZGlkIGFjaywgd2Ugc2hvdWxkIG5vdCBn\nZXQgaXQgYWdhaW4iKTsKICAgICAgICBtYWtlQ29uc3VtZXIoKTsKCiAgICAg\nICAgbWVzc2FnZSA9IGNvbnN1bWVyLnJlY2VpdmUoMjAwMCk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZSgiU2hvdWxkIGhhdmUgbm8gbW9yZSBtZXNzYWdlcyBsZWZ0\nISIsIG1lc3NhZ2UgPT0gbnVsbCk7CgogICAgICAgIGNsb3NlQ29uc3VtZXIo\nKTsKCiAgICAgICAgTE9HLmluZm8oIkxldHMgcHVibGlzaCBvbmUgbW9yZSBt\nZXNzYWdlIG5vdyIpOwogICAgICAgIHB1Ymxpc2goKTsKCiAgICAgICAgbWFr\nZUNvbnN1bWVyKCk7CiAgICAgICAgbWVzc2FnZSA9IGNvbnN1bWVyLnJlY2Vp\ndmUoUkVDRUlWRV9USU1FT1VUKTsKICAgICAgICBhc3NlcnRUcnVlKCJTaG91\nbGQgaGF2ZSByZWNlaXZlZCBhIG1lc3NhZ2UhIiwgbWVzc2FnZSAhPSBudWxs\nKTsKICAgICAgICBtZXNzYWdlLmFja25vd2xlZGdlKCk7CgogICAgICAgIGNs\nb3NlQ29uc3VtZXIoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBwdWJs\naXNoKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgY29ubmVjdGlvbiA9\nIGNyZWF0ZUNvbm5lY3Rpb24oKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0\nKCk7CgogICAgICAgIHNlc3Npb24gPSBjb25uZWN0aW9uLmNyZWF0ZVNlc3Np\nb24oZmFsc2UsIFNlc3Npb24uQ0xJRU5UX0FDS05PV0xFREdFKTsKICAgICAg\nICBkZXN0aW5hdGlvbiA9IGNyZWF0ZURlc3RpbmF0aW9uKCk7CgogICAgICAg\nIHByb2R1Y2VyID0gc2Vzc2lvbi5jcmVhdGVQcm9kdWNlcihkZXN0aW5hdGlv\nbik7CiAgICAgICAgcHJvZHVjZXIuc2V0RGVsaXZlcnlNb2RlKERlbGl2ZXJ5\nTW9kZS5QRVJTSVNURU5UKTsKICAgICAgICBUZXh0TWVzc2FnZSBtc2cgPSBz\nZXNzaW9uLmNyZWF0ZVRleHRNZXNzYWdlKCJUaGlzIGlzIGEgdGVzdDogIiAr\nIG1lc3NhZ2VDb3VudCsrKTsKICAgICAgICBwcm9kdWNlci5zZW5kKG1zZyk7\nCgogICAgICAgIHByb2R1Y2VyLmNsb3NlKCk7CiAgICAgICAgcHJvZHVjZXIg\nPSBudWxsOwogICAgICAgIGNsb3NlU2Vzc2lvbigpOwogICAgfQoKICAgIHBy\nb3RlY3RlZCBEZXN0aW5hdGlvbiBjcmVhdGVEZXN0aW5hdGlvbigpIHRocm93\ncyBKTVNFeGNlcHRpb24gewogICAgICAgIGlmIChpc1RvcGljKCkpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlc3Npb24uY3JlYXRlVG9waWMoZ2V0U3ViamVj\ndCgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gc2Vz\nc2lvbi5jcmVhdGVUb3BpYyhnZXRTdWJqZWN0KCkpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc1RvcGljKCkgewogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGNsb3Nl\nQ29uc3VtZXIoKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBjb25z\ndW1lci5jbG9zZSgpOwogICAgICAgIGNvbnN1bWVyID0gbnVsbDsKICAgICAg\nICBjbG9zZVNlc3Npb24oKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBj\nbG9zZVNlc3Npb24oKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBz\nZXNzaW9uLmNsb3NlKCk7CiAgICAgICAgc2Vzc2lvbiA9IG51bGw7CiAgICAg\nICAgY29ubmVjdGlvbi5jbG9zZSgpOwogICAgICAgIGNvbm5lY3Rpb24gPSBu\ndWxsOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIG1ha2VDb25zdW1lcigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBkdXJhYmxlTmFt\nZSA9IGdldE5hbWUoKTsKICAgICAgICBTdHJpbmcgY2xpZW50SUQgPSBnZXRT\ndWJqZWN0KCk7CiAgICAgICAgTE9HLmluZm8oIkNyZWF0aW5nIGEgZHVyYWJs\nZSBzdWJzY3JpYmUgZm9yIGNsaWVudElEOiAiICsgY2xpZW50SUQgKyAiIGFu\nZCBkdXJhYmxlIG5hbWU6ICIgKyBkdXJhYmxlTmFtZSk7CiAgICAgICAgY3Jl\nYXRlU2Vzc2lvbihjbGllbnRJRCk7CiAgICAgICAgY29uc3VtZXIgPSBjcmVh\ndGVDb25zdW1lcihkdXJhYmxlTmFtZSk7CiAgICB9CgogICAgcHJpdmF0ZSBN\nZXNzYWdlQ29uc3VtZXIgY3JlYXRlQ29uc3VtZXIoU3RyaW5nIGR1cmFibGVO\nYW1lKSB0aHJvd3MgSk1TRXhjZXB0aW9uIHsKICAgICAgICBpZiAoZGVzdGlu\nYXRpb24gaW5zdGFuY2VvZiBUb3BpYykgewogICAgICAgICAgICByZXR1cm4g\nc2Vzc2lvbi5jcmVhdGVEdXJhYmxlU3Vic2NyaWJlcigoVG9waWMpZGVzdGlu\nYXRpb24sIGR1cmFibGVOYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICByZXR1cm4gc2Vzc2lvbi5jcmVhdGVDb25zdW1lcihkZXN0aW5hdGlv\nbik7CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGNyZWF0\nZVNlc3Npb24oU3RyaW5nIGNsaWVudElEKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBjb25uZWN0aW9uID0gY3JlYXRlQ29ubmVjdGlvbigpOwogICAg\nICAgIGNvbm5lY3Rpb24uc2V0Q2xpZW50SUQoY2xpZW50SUQpOwogICAgICAg\nIGNvbm5lY3Rpb24uc3RhcnQoKTsKCiAgICAgICAgc2Vzc2lvbiA9IGNvbm5l\nY3Rpb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5DTElFTlRfQUNL\nTk9XTEVER0UpOwogICAgICAgIGRlc3RpbmF0aW9uID0gY3JlYXRlRGVzdGlu\nYXRpb24oKTsKICAgIH0KfQo=\n","encoding":"base64"}

