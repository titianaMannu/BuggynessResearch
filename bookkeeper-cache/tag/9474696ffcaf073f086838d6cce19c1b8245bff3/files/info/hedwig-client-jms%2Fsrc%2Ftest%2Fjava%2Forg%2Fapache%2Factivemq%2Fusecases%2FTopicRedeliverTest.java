{"sha":"2c1e24ce4287859f7e4c06615bbbc9169e5e3fb1","node_id":"MDQ6QmxvYjE1NzU5NTY6MmMxZTI0Y2U0Mjg3ODU5ZjdlNGMwNjYxNWJiYmM5MTY5ZTVlM2ZiMQ==","size":12011,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2c1e24ce4287859f7e4c06615bbbc9169e5e3fb1","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogKiBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3Ry\naWJ1dGVkIHdpdGgKICogdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLgogKiBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byBZb3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogKiAodGhlICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug\nd2l0aAogKiB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5k\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLmFjdGl2ZW1xLnVzZWNhc2VzOwoKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LmF0b21pYy5BdG9taWNCb29sZWFuOwppbXBvcnQg\namF2YXguam1zLkNvbm5lY3Rpb247CmltcG9ydCBqYXZheC5qbXMuRGVsaXZl\ncnlNb2RlOwppbXBvcnQgamF2YXguam1zLkRlc3RpbmF0aW9uOwppbXBvcnQg\namF2YXguam1zLkV4Y2VwdGlvbkxpc3RlbmVyOwppbXBvcnQgamF2YXguam1z\nLkpNU0V4Y2VwdGlvbjsKaW1wb3J0IGphdmF4Lmptcy5NZXNzYWdlOwppbXBv\ncnQgamF2YXguam1zLk1lc3NhZ2VDb25zdW1lcjsKaW1wb3J0IGphdmF4Lmpt\ncy5NZXNzYWdlUHJvZHVjZXI7CmltcG9ydCBqYXZheC5qbXMuU2Vzc2lvbjsK\naW1wb3J0IGphdmF4Lmptcy5UZXh0TWVzc2FnZTsKaW1wb3J0IGphdmF4Lmpt\ncy5Ub3BpYzsKCmltcG9ydCBvcmcuYXBhY2hlLmFjdGl2ZW1xLnRlc3QuVGVz\ndFN1cHBvcnQ7CmltcG9ydCBvcmcuYXBhY2hlLmFjdGl2ZW1xLnV0aWwuSWRH\nZW5lcmF0b3I7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgpwdWJsaWMgY2xhc3MgVG9waWNSZWRl\nbGl2ZXJUZXN0IGV4dGVuZHMgVGVzdFN1cHBvcnQgewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihUb3BpY1JlZGVsaXZlclRlc3QuY2xhc3MpOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IFJFQ0VJVkVfVElNRU9VVCA9IDEwMDAwOwoKICAg\nIHByb3RlY3RlZCBpbnQgZGVsaXZlcnlNb2RlID0gRGVsaXZlcnlNb2RlLlBF\nUlNJU1RFTlQ7CiAgICBwcml2YXRlIElkR2VuZXJhdG9yIGlkR2VuID0gbmV3\nIElkR2VuZXJhdG9yKCk7CgogICAgcHVibGljIFRvcGljUmVkZWxpdmVyVGVz\ndCgpIHsKICAgIH0KCiAgICBwdWJsaWMgVG9waWNSZWRlbGl2ZXJUZXN0KFN0\ncmluZyBuKSB7CiAgICAgICAgc3VwZXIobik7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBz\ndXBlci5zZXRVcCgpOwogICAgICAgIHRvcGljID0gdHJ1ZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIHRlc3QgbWVzc2FnZXMgYXJlIGFja25vd2xlZGdlZCBh\nbmQgcmVjb3ZlcmVkIHByb3Blcmx5CiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlv\nbgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2xpZW50QWNrbm93bGVk\nZ2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBEZXN0aW5hdGlvbiBk\nZXN0aW5hdGlvbiA9IGNyZWF0ZURlc3RpbmF0aW9uKGdldENsYXNzKCkuZ2V0\nTmFtZSgpKTsKICAgICAgICBDb25uZWN0aW9uIGNvbm5lY3Rpb24gPSBjcmVh\ndGVDb25uZWN0aW9uKCk7CiAgICAgICAgZmluYWwgU3RyaW5nIGNsaWVudElk\nID0gaWRHZW4uZ2VuZXJhdGVJZCgpOwogICAgICAgIGNvbm5lY3Rpb24uc2V0\nQ2xpZW50SUQoY2xpZW50SWQpOwogICAgICAgIGNvbm5lY3Rpb24uc3RhcnQo\nKTsKICAgICAgICBTZXNzaW9uIGNvbnN1bWVyU2Vzc2lvbiA9IGNvbm5lY3Rp\nb24uY3JlYXRlU2Vzc2lvbihmYWxzZSwgU2Vzc2lvbi5DTElFTlRfQUNLTk9X\nTEVER0UpOwogICAgICAgIE1lc3NhZ2VDb25zdW1lciBjb25zdW1lciA9IGNv\nbnN1bWVyU2Vzc2lvbi5jcmVhdGVEdXJhYmxlU3Vic2NyaWJlcigoVG9waWMp\nIGRlc3RpbmF0aW9uLCAic3Vic2NyaWJlci1pZDEiKTsKICAgICAgICBTZXNz\naW9uIHByb2R1Y2VyU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lv\nbihmYWxzZSwgU2Vzc2lvbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICBN\nZXNzYWdlUHJvZHVjZXIgcHJvZHVjZXIgPSBwcm9kdWNlclNlc3Npb24uY3Jl\nYXRlUHJvZHVjZXIoZGVzdGluYXRpb24pOwogICAgICAgIHByb2R1Y2VyLnNl\ndERlbGl2ZXJ5TW9kZShkZWxpdmVyeU1vZGUpOwoKICAgICAgICAvLyBzZW5k\nIHNvbWUgbWVzc2FnZXMKCiAgICAgICAgVGV4dE1lc3NhZ2Ugc2VudDEgPSBw\ncm9kdWNlclNlc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UoKTsKICAgICAgICBz\nZW50MS5zZXRUZXh0KCJtc2cxIik7CiAgICAgICAgcHJvZHVjZXIuc2VuZChz\nZW50MSk7CgogICAgICAgIFRleHRNZXNzYWdlIHNlbnQyID0gcHJvZHVjZXJT\nZXNzaW9uLmNyZWF0ZVRleHRNZXNzYWdlKCk7CiAgICAgICAgc2VudDEuc2V0\nVGV4dCgibXNnMiIpOwogICAgICAgIHByb2R1Y2VyLnNlbmQoc2VudDIpOwoK\nICAgICAgICBUZXh0TWVzc2FnZSBzZW50MyA9IHByb2R1Y2VyU2Vzc2lvbi5j\ncmVhdGVUZXh0TWVzc2FnZSgpOwogICAgICAgIHNlbnQxLnNldFRleHQoIm1z\nZzMiKTsKICAgICAgICBwcm9kdWNlci5zZW5kKHNlbnQzKTsKCiAgICAgICAg\nY29uc3VtZXIucmVjZWl2ZShSRUNFSVZFX1RJTUVPVVQpOwogICAgICAgIE1l\nc3NhZ2UgcmVjMiA9IGNvbnN1bWVyLnJlY2VpdmUoUkVDRUlWRV9USU1FT1VU\nKTsKICAgICAgICBjb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7\nCgogICAgICAgIC8vIGFjayByZWMyIC0gaW4gaGVkd2lnLCB0aGlzIGltcGxp\nY2l0bHkgYWNrJ3MgcmVjMSB0b28gLi4uCiAgICAgICAgcmVjMi5hY2tub3ds\nZWRnZSgpOwoKICAgICAgICBUZXh0TWVzc2FnZSBzZW50NCA9IHByb2R1Y2Vy\nU2Vzc2lvbi5jcmVhdGVUZXh0TWVzc2FnZSgpOwogICAgICAgIHNlbnQ0LnNl\ndFRleHQoIm1zZzQiKTsKICAgICAgICBwcm9kdWNlci5zZW5kKHNlbnQ0KTsK\nCiAgICAgICAgTWVzc2FnZSByZWM0ID0gY29uc3VtZXIucmVjZWl2ZShSRUNF\nSVZFX1RJTUVPVVQpOwogICAgICAgIC8vIGFzc2VydFRydWUocmVjNC5lcXVh\nbHMoc2VudDQpKTsKICAgICAgICBhc3NlcnQgcmVjNCBpbnN0YW5jZW9mIFRl\neHRNZXNzYWdlOwogICAgICAgIGFzc2VydFRydWUoKChUZXh0TWVzc2FnZSkg\ncmVjNCkuZ2V0VGV4dCgpLmVxdWFscyhzZW50NC5nZXRUZXh0KCkpKTsKICAg\nICAgICAvLyBXZSBETyBOT1Qgc3VwcG9ydCBzZXNzaW9uIHJlY292ZXJ5IC0g\ndG8gdW5ibG9jayB0aGlzIHRlc3QsCiAgICAgICAgLy8gSSBhbSBzdG9wcCdp\nbmcgYW5kIHN0YXJ0J2luZyBjb25uZWN0aW9uIDogbm90IHRoZSBzYW1lLCBi\ndXQgLi4uCiAgICAgICAgLy8gY29uc3VtZXJTZXNzaW9uLnJlY292ZXIoKTsK\nICAgICAgICBjb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgICAgY29ubmVjdGlv\nbiA9IGNyZWF0ZUNvbm5lY3Rpb24oKTsKICAgICAgICAvLyBzYW1lIGNsaWVu\ndCBpZCAhCiAgICAgICAgY29ubmVjdGlvbi5zZXRDbGllbnRJRChjbGllbnRJ\nZCk7CiAgICAgICAgY29uc3VtZXJTZXNzaW9uID0gY29ubmVjdGlvbi5jcmVh\ndGVTZXNzaW9uKGZhbHNlLCBTZXNzaW9uLkNMSUVOVF9BQ0tOT1dMRURHRSk7\nCiAgICAgICAgY29uc3VtZXIgPSBjb25zdW1lclNlc3Npb24uY3JlYXRlRHVy\nYWJsZVN1YnNjcmliZXIoKFRvcGljKSBkZXN0aW5hdGlvbiwgInN1YnNjcmli\nZXItaWQxIik7CiAgICAgICAgY29ubmVjdGlvbi5zdGFydCgpOwoKICAgICAg\nICBjb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7CiAgICAgICAg\ncmVjNCA9IGNvbnN1bWVyLnJlY2VpdmUoUkVDRUlWRV9USU1FT1VUKTsKICAg\nICAgICAvLyBhc3NlcnRUcnVlKHJlYzQuZXF1YWxzKHNlbnQ0KSk7CiAgICAg\nICAgYXNzZXJ0IHJlYzQgaW5zdGFuY2VvZiBUZXh0TWVzc2FnZSA6ICJyZWM0\nID09ICIgKyByZWM0OwogICAgICAgIGFzc2VydFRydWUoKChUZXh0TWVzc2Fn\nZSkgcmVjNCkuZ2V0VGV4dCgpLmVxdWFscyhzZW50NC5nZXRUZXh0KCkpKTsK\nICAgICAgICAvLyBhc3NlcnRUcnVlKHJlYzQuZ2V0Sk1TUmVkZWxpdmVyZWQo\nKSk7CiAgICAgICAgcmVjNC5hY2tub3dsZWRnZSgpOwogICAgICAgIGNvbm5l\nY3Rpb24uY2xvc2UoKTsKCiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHJl\nZGVsaXZlcmVkIGZsYWcgaXMgc2V0IG9uIHJvbGxiYWNrZWQgdHJhbnNhY3Rp\nb25zCiAgICAgKgogICAgICogQHRocm93cyBFeGNlcHRpb24KICAgICAqLwog\nICAgcHVibGljIHZvaWQgdGVzdFJlZGlsdmVyZWRGbGFnU2V0T25Sb2xsYmFj\naygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIERlc3RpbmF0aW9uIGRl\nc3RpbmF0aW9uID0gY3JlYXRlRGVzdGluYXRpb24oZ2V0Q2xhc3MoKS5nZXRO\nYW1lKCkpOwogICAgICAgIENvbm5lY3Rpb24gY29ubmVjdGlvbiA9IGNyZWF0\nZUNvbm5lY3Rpb24oKTsKICAgICAgICBjb25uZWN0aW9uLnNldENsaWVudElE\nKGlkR2VuLmdlbmVyYXRlSWQoKSk7CiAgICAgICAgY29ubmVjdGlvbi5zdGFy\ndCgpOwogICAgICAgIFNlc3Npb24gY29uc3VtZXJTZXNzaW9uID0gY29ubmVj\ndGlvbi5jcmVhdGVTZXNzaW9uKHRydWUsIFNlc3Npb24uQ0xJRU5UX0FDS05P\nV0xFREdFKTsKICAgICAgICBNZXNzYWdlQ29uc3VtZXIgY29uc3VtZXIgPSBu\ndWxsOwogICAgICAgIGlmICh0b3BpYykgewogICAgICAgICAgICBjb25zdW1l\nciA9IGNvbnN1bWVyU2Vzc2lvbi5jcmVhdGVEdXJhYmxlU3Vic2NyaWJlcigo\nVG9waWMpZGVzdGluYXRpb24sICJURVNUUkVEIik7CiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgY29uc3VtZXIgPSBjb25zdW1lclNlc3Npb24uY3Jl\nYXRlQ29uc3VtZXIoZGVzdGluYXRpb24pOwogICAgICAgIH0KICAgICAgICBT\nZXNzaW9uIHByb2R1Y2VyU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vz\nc2lvbih0cnVlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAg\nIE1lc3NhZ2VQcm9kdWNlciBwcm9kdWNlciA9IHByb2R1Y2VyU2Vzc2lvbi5j\ncmVhdGVQcm9kdWNlcihkZXN0aW5hdGlvbik7CiAgICAgICAgcHJvZHVjZXIu\nc2V0RGVsaXZlcnlNb2RlKGRlbGl2ZXJ5TW9kZSk7CgogICAgICAgIFRleHRN\nZXNzYWdlIHNlbnRNc2cgPSBwcm9kdWNlclNlc3Npb24uY3JlYXRlVGV4dE1l\nc3NhZ2UoKTsKICAgICAgICBzZW50TXNnLnNldFRleHQoIm1zZzEiKTsKICAg\nICAgICBwcm9kdWNlci5zZW5kKHNlbnRNc2cpOwogICAgICAgIHByb2R1Y2Vy\nU2Vzc2lvbi5jb21taXQoKTsKCiAgICAgICAgTWVzc2FnZSByZWNNc2cgPSBj\nb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7CiAgICAgICAgYXNz\nZXJ0RmFsc2UocmVjTXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwogICAgICAg\nIHJlY01zZyA9IGNvbnN1bWVyLnJlY2VpdmUoUkVDRUlWRV9USU1FT1VUKTsK\nICAgICAgICBjb25zdW1lclNlc3Npb24ucm9sbGJhY2soKTsKICAgICAgICBy\nZWNNc2cgPSBjb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7CiAg\nICAgICAgYXNzZXJ0VHJ1ZShyZWNNc2cuZ2V0Sk1TUmVkZWxpdmVyZWQoKSk7\nCiAgICAgICAgY29uc3VtZXJTZXNzaW9uLmNvbW1pdCgpOwogICAgICAgIC8v\nIGFzc2VydFRydWUocmVjTXNnLmVxdWFscyhzZW50TXNnKSk7CiAgICAgICAg\nYXNzZXJ0IHJlY01zZyBpbnN0YW5jZW9mIFRleHRNZXNzYWdlOwogICAgICAg\nIGFzc2VydFRydWUoKChUZXh0TWVzc2FnZSkgcmVjTXNnKS5nZXRUZXh0KCku\nZXF1YWxzKHNlbnRNc2cuZ2V0VGV4dCgpKSk7CiAgICAgICAgYXNzZXJ0VHJ1\nZShyZWNNc2cuZ2V0Sk1TUmVkZWxpdmVyZWQoKSk7CiAgICAgICAgY29ubmVj\ndGlvbi5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb0V4\nY2VwdGlvbk9uUmVkZWxpdmVyeUFja1dpdGhTaW1wbGVUb3BpY0NvbnN1bWVy\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgRGVzdGluYXRpb24gZGVz\ndGluYXRpb24gPSBjcmVhdGVEZXN0aW5hdGlvbihnZXRDbGFzcygpLmdldE5h\nbWUoKSk7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0aW9uID0gY3JlYXRl\nQ29ubmVjdGlvbigpOwogICAgICAgIGZpbmFsIEF0b21pY0Jvb2xlYW4gZ290\nRXhjZXB0aW9uID0gbmV3IEF0b21pY0Jvb2xlYW4oKTsKICAgICAgICBjb25u\nZWN0aW9uLnNldEV4Y2VwdGlvbkxpc3RlbmVyKG5ldyBFeGNlcHRpb25MaXN0\nZW5lcigpIHsKICAgICAgICAgICAgcHVibGljIHZvaWQgb25FeGNlcHRpb24o\nSk1TRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgTE9H\nLmVycm9yKCJ1bmV4cGVjdGVkIGV4OiIgKyBleGNlcHRpb24pOwogICAgICAg\nICAgICAgICAgICAgIGdvdEV4Y2VwdGlvbi5zZXQodHJ1ZSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9KTsKICAgICAgICBjb25uZWN0aW9uLnNldENsaWVu\ndElEKGlkR2VuLmdlbmVyYXRlSWQoKSk7CiAgICAgICAgY29ubmVjdGlvbi5z\ndGFydCgpOwogICAgICAgIFNlc3Npb24gY29uc3VtZXJTZXNzaW9uID0gY29u\nbmVjdGlvbi5jcmVhdGVTZXNzaW9uKHRydWUsIFNlc3Npb24uQ0xJRU5UX0FD\nS05PV0xFREdFKTsKICAgICAgICBNZXNzYWdlQ29uc3VtZXIgY29uc3VtZXIg\nPSBudWxsOwogICAgICAgIGlmICh0b3BpYykgewogICAgICAgICAgICBjb25z\ndW1lciA9IGNvbnN1bWVyU2Vzc2lvbi5jcmVhdGVDb25zdW1lcigoVG9waWMp\nZGVzdGluYXRpb24pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNv\nbnN1bWVyID0gY29uc3VtZXJTZXNzaW9uLmNyZWF0ZUNvbnN1bWVyKGRlc3Rp\nbmF0aW9uKTsKICAgICAgICB9CiAgICAgICAgU2Vzc2lvbiBwcm9kdWNlclNl\nc3Npb24gPSBjb25uZWN0aW9uLmNyZWF0ZVNlc3Npb24odHJ1ZSwgU2Vzc2lv\nbi5BVVRPX0FDS05PV0xFREdFKTsKICAgICAgICBNZXNzYWdlUHJvZHVjZXIg\ncHJvZHVjZXIgPSBwcm9kdWNlclNlc3Npb24uY3JlYXRlUHJvZHVjZXIoZGVz\ndGluYXRpb24pOwogICAgICAgIHByb2R1Y2VyLnNldERlbGl2ZXJ5TW9kZShk\nZWxpdmVyeU1vZGUpOwoKICAgICAgICBUZXh0TWVzc2FnZSBzZW50TXNnID0g\ncHJvZHVjZXJTZXNzaW9uLmNyZWF0ZVRleHRNZXNzYWdlKCk7CiAgICAgICAg\nc2VudE1zZy5zZXRUZXh0KCJtc2cxIik7CiAgICAgICAgcHJvZHVjZXIuc2Vu\nZChzZW50TXNnKTsKICAgICAgICBwcm9kdWNlclNlc3Npb24uY29tbWl0KCk7\nCgogICAgICAgIE1lc3NhZ2UgcmVjTXNnID0gY29uc3VtZXIucmVjZWl2ZShS\nRUNFSVZFX1RJTUVPVVQpOwogICAgICAgIGFzc2VydEZhbHNlKHJlY01zZy5n\nZXRKTVNSZWRlbGl2ZXJlZCgpKTsKICAgICAgICByZWNNc2cgPSBjb25zdW1l\nci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7CiAgICAgICAgY29uc3VtZXJT\nZXNzaW9uLnJvbGxiYWNrKCk7CiAgICAgICAgcmVjTXNnID0gY29uc3VtZXIu\ncmVjZWl2ZShSRUNFSVZFX1RJTUVPVVQpOwogICAgICAgIGFzc2VydFRydWUo\ncmVjTXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwogICAgICAgIGNvbnN1bWVy\nU2Vzc2lvbi5yb2xsYmFjaygpOwogICAgICAgIHJlY01zZyA9IGNvbnN1bWVy\nLnJlY2VpdmUoUkVDRUlWRV9USU1FT1VUKTsKICAgICAgICBhc3NlcnRUcnVl\nKHJlY01zZy5nZXRKTVNSZWRlbGl2ZXJlZCgpKTsKICAgICAgICBjb25zdW1l\nclNlc3Npb24uY29tbWl0KCk7CiAgICAgICAgLy8gYXNzZXJ0VHJ1ZShyZWNN\nc2cuZXF1YWxzKHNlbnRNc2cpKTsKICAgICAgICBhc3NlcnQgcmVjTXNnIGlu\nc3RhbmNlb2YgVGV4dE1lc3NhZ2U7CiAgICAgICAgYXNzZXJ0VHJ1ZSgoKFRl\neHRNZXNzYWdlKSByZWNNc2cpLmdldFRleHQoKS5lcXVhbHMoc2VudE1zZy5n\nZXRUZXh0KCkpKTsKICAgICAgICBhc3NlcnRUcnVlKHJlY01zZy5nZXRKTVNS\nZWRlbGl2ZXJlZCgpKTsKICAgICAgICBjb25uZWN0aW9uLmNsb3NlKCk7Cgog\nICAgICAgIGFzc2VydEZhbHNlKCJubyBleGNlcHRpb24iLCBnb3RFeGNlcHRp\nb24uZ2V0KCkpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgYSBzZXNz\naW9uIGlzIHJvbGxiYWNrZWQgb24gYSBTZXNzaW9uIGNsb3NlKCk7CiAgICAg\nKgogICAgICogQHRocm93cyBFeGNlcHRpb24KICAgICAqLwoKICAgIHB1Ymxp\nYyB2b2lkIHh0ZXN0VHJhbnNhY3Rpb25Sb2xsYmFja09uU2Vzc2lvbkNsb3Nl\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgRGVzdGluYXRpb24gZGVz\ndGluYXRpb24gPSBjcmVhdGVEZXN0aW5hdGlvbihnZXRDbGFzcygpLmdldE5h\nbWUoKSk7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0aW9uID0gY3JlYXRl\nQ29ubmVjdGlvbigpOwogICAgICAgIGNvbm5lY3Rpb24uc2V0Q2xpZW50SUQo\naWRHZW4uZ2VuZXJhdGVJZCgpKTsKICAgICAgICBjb25uZWN0aW9uLnN0YXJ0\nKCk7CiAgICAgICAgU2Vzc2lvbiBjb25zdW1lclNlc3Npb24gPSBjb25uZWN0\naW9uLmNyZWF0ZVNlc3Npb24odHJ1ZSwgU2Vzc2lvbi5DTElFTlRfQUNLTk9X\nTEVER0UpOwogICAgICAgIE1lc3NhZ2VDb25zdW1lciBjb25zdW1lciA9IG51\nbGw7CiAgICAgICAgaWYgKHRvcGljKSB7CiAgICAgICAgICAgIGNvbnN1bWVy\nID0gY29uc3VtZXJTZXNzaW9uLmNyZWF0ZUR1cmFibGVTdWJzY3JpYmVyKChU\nb3BpYylkZXN0aW5hdGlvbiwgIlRFU1RSRUQiKTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICBjb25zdW1lciA9IGNvbnN1bWVyU2Vzc2lvbi5jcmVh\ndGVDb25zdW1lcihkZXN0aW5hdGlvbik7CiAgICAgICAgfQogICAgICAgIFNl\nc3Npb24gcHJvZHVjZXJTZXNzaW9uID0gY29ubmVjdGlvbi5jcmVhdGVTZXNz\naW9uKHRydWUsIFNlc3Npb24uQVVUT19BQ0tOT1dMRURHRSk7CiAgICAgICAg\nTWVzc2FnZVByb2R1Y2VyIHByb2R1Y2VyID0gcHJvZHVjZXJTZXNzaW9uLmNy\nZWF0ZVByb2R1Y2VyKGRlc3RpbmF0aW9uKTsKICAgICAgICBwcm9kdWNlci5z\nZXREZWxpdmVyeU1vZGUoZGVsaXZlcnlNb2RlKTsKCiAgICAgICAgVGV4dE1l\nc3NhZ2Ugc2VudE1zZyA9IHByb2R1Y2VyU2Vzc2lvbi5jcmVhdGVUZXh0TWVz\nc2FnZSgpOwogICAgICAgIHNlbnRNc2cuc2V0VGV4dCgibXNnMSIpOwogICAg\nICAgIHByb2R1Y2VyLnNlbmQoc2VudE1zZyk7CgogICAgICAgIHByb2R1Y2Vy\nU2Vzc2lvbi5jb21taXQoKTsKCiAgICAgICAgTWVzc2FnZSByZWNNc2cgPSBj\nb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7CiAgICAgICAgYXNz\nZXJ0RmFsc2UocmVjTXNnLmdldEpNU1JlZGVsaXZlcmVkKCkpOwogICAgICAg\nIGNvbnN1bWVyU2Vzc2lvbi5jbG9zZSgpOwogICAgICAgIGNvbnN1bWVyU2Vz\nc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vzc2lvbih0cnVlLCBTZXNzaW9u\nLkNMSUVOVF9BQ0tOT1dMRURHRSk7CiAgICAgICAgY29uc3VtZXIgPSBjb25z\ndW1lclNlc3Npb24uY3JlYXRlQ29uc3VtZXIoZGVzdGluYXRpb24pOwoKICAg\nICAgICByZWNNc2cgPSBjb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9V\nVCk7CiAgICAgICAgY29uc3VtZXJTZXNzaW9uLmNvbW1pdCgpOwogICAgICAg\nIC8vIGFzc2VydFRydWUocmVjTXNnLmVxdWFscyhzZW50TXNnKSk7CiAgICAg\nICAgYXNzZXJ0IHJlY01zZyBpbnN0YW5jZW9mIFRleHRNZXNzYWdlOwogICAg\nICAgIGFzc2VydFRydWUoKChUZXh0TWVzc2FnZSkgcmVjTXNnKS5nZXRUZXh0\nKCkuZXF1YWxzKHNlbnRNc2cuZ2V0VGV4dCgpKSk7CiAgICAgICAgY29ubmVj\ndGlvbi5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogY2hlY2sgbWVz\nc2FnZXMgYXJlIGFjdHVhbGxseSBzZW50IG9uIGEgdHggcm9sbGJhY2sKICAg\nICAqCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCgogICAgcHVi\nbGljIHZvaWQgdGVzdFRyYW5zYWN0aW9uUm9sbGJhY2tPblNlbmQoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBEZXN0aW5hdGlvbiBkZXN0aW5hdGlv\nbiA9IGNyZWF0ZURlc3RpbmF0aW9uKGdldENsYXNzKCkuZ2V0TmFtZSgpKTsK\nICAgICAgICBDb25uZWN0aW9uIGNvbm5lY3Rpb24gPSBjcmVhdGVDb25uZWN0\naW9uKCk7CiAgICAgICAgY29ubmVjdGlvbi5zZXRDbGllbnRJRChpZEdlbi5n\nZW5lcmF0ZUlkKCkpOwogICAgICAgIGNvbm5lY3Rpb24uc3RhcnQoKTsKICAg\nICAgICBTZXNzaW9uIGNvbnN1bWVyU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3Jl\nYXRlU2Vzc2lvbih0cnVlLCBTZXNzaW9uLkNMSUVOVF9BQ0tOT1dMRURHRSk7\nCiAgICAgICAgTWVzc2FnZUNvbnN1bWVyIGNvbnN1bWVyID0gY29uc3VtZXJT\nZXNzaW9uLmNyZWF0ZUNvbnN1bWVyKGRlc3RpbmF0aW9uKTsKICAgICAgICBT\nZXNzaW9uIHByb2R1Y2VyU2Vzc2lvbiA9IGNvbm5lY3Rpb24uY3JlYXRlU2Vz\nc2lvbih0cnVlLCBTZXNzaW9uLkFVVE9fQUNLTk9XTEVER0UpOwogICAgICAg\nIE1lc3NhZ2VQcm9kdWNlciBwcm9kdWNlciA9IHByb2R1Y2VyU2Vzc2lvbi5j\ncmVhdGVQcm9kdWNlcihkZXN0aW5hdGlvbik7CiAgICAgICAgcHJvZHVjZXIu\nc2V0RGVsaXZlcnlNb2RlKGRlbGl2ZXJ5TW9kZSk7CgogICAgICAgIFRleHRN\nZXNzYWdlIHNlbnRNc2cgPSBwcm9kdWNlclNlc3Npb24uY3JlYXRlVGV4dE1l\nc3NhZ2UoKTsKICAgICAgICBzZW50TXNnLnNldFRleHQoIm1zZzEiKTsKICAg\nICAgICBwcm9kdWNlci5zZW5kKHNlbnRNc2cpOwogICAgICAgIHByb2R1Y2Vy\nU2Vzc2lvbi5jb21taXQoKTsKCiAgICAgICAgTWVzc2FnZSByZWNNc2cgPSBj\nb25zdW1lci5yZWNlaXZlKFJFQ0VJVkVfVElNRU9VVCk7CiAgICAgICAgY29u\nc3VtZXJTZXNzaW9uLmNvbW1pdCgpOwogICAgICAgIC8vIGFzc2VydFRydWUo\ncmVjTXNnLmVxdWFscyhzZW50TXNnKSk7CiAgICAgICAgYXNzZXJ0IHJlY01z\nZyBpbnN0YW5jZW9mIFRleHRNZXNzYWdlOwogICAgICAgIGFzc2VydFRydWUo\nKChUZXh0TWVzc2FnZSkgcmVjTXNnKS5nZXRUZXh0KCkuZXF1YWxzKHNlbnRN\nc2cuZ2V0VGV4dCgpKSk7CgogICAgICAgIHNlbnRNc2cgPSBwcm9kdWNlclNl\nc3Npb24uY3JlYXRlVGV4dE1lc3NhZ2UoKTsKICAgICAgICBzZW50TXNnLnNl\ndFRleHQoIm1zZzIiKTsKICAgICAgICBwcm9kdWNlci5zZW5kKHNlbnRNc2cp\nOwogICAgICAgIHByb2R1Y2VyU2Vzc2lvbi5yb2xsYmFjaygpOwoKICAgICAg\nICBzZW50TXNnID0gcHJvZHVjZXJTZXNzaW9uLmNyZWF0ZVRleHRNZXNzYWdl\nKCk7CiAgICAgICAgc2VudE1zZy5zZXRUZXh0KCJtc2czIik7CiAgICAgICAg\ncHJvZHVjZXIuc2VuZChzZW50TXNnKTsKICAgICAgICBwcm9kdWNlclNlc3Np\nb24uY29tbWl0KCk7CgogICAgICAgIHJlY01zZyA9IGNvbnN1bWVyLnJlY2Vp\ndmUoUkVDRUlWRV9USU1FT1VUKTsKICAgICAgICAvLyBhc3NlcnRUcnVlKHJl\nY01zZy5lcXVhbHMoc2VudE1zZykpOwogICAgICAgIGFzc2VydCByZWNNc2cg\naW5zdGFuY2VvZiBUZXh0TWVzc2FnZTsKICAgICAgICBhc3NlcnRUcnVlKCgo\nVGV4dE1lc3NhZ2UpIHJlY01zZykuZ2V0VGV4dCgpLmVxdWFscyhzZW50TXNn\nLmdldFRleHQoKSkpOwogICAgICAgIGNvbnN1bWVyU2Vzc2lvbi5jb21taXQo\nKTsKCiAgICAgICAgY29ubmVjdGlvbi5jbG9zZSgpOwogICAgfQoKfQo=\n","encoding":"base64"}

