{"sha":"7e084ec074ab4eb58b70c8cad825dd96ba449b8c","node_id":"MDQ6QmxvYjE1NzU5NTY6N2UwODRlYzA3NGFiNGViNThiNzBjOGNhZDgyNWRkOTZiYTQ0OWI4Yw==","size":18888,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/7e084ec074ab4eb58b70c8cad825dd96ba449b8c","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW47CgppbXBvcnQgamF2YS51\ndGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRv\ncjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRIYXNo\nTWFwOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0\nY2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5C\nS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGll\nbnQuQm9va0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nbGllbnQuQm9va0tlZXBlci5EaWdlc3RUeXBlOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIudmVyc2lvbmluZy5WZXJzaW9uZWQ7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLkxlZGdlclJhbmdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTGVkZ2VyUmFuZ2VzOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVz\nc2FnZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLk1lc3NhZ2VTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbkRhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9uLlNlcnZl\nckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2\nZXIubWV0YS5NZXRhZGF0YU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLm1ldGEuRmFjdG9yeUxheW91dDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRhLlN1YnNjcmlwdGlvbkRh\ndGFNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLm1l\ndGEuVG9waWNPd25lcnNoaXBNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuc2VydmVyLm1ldGEuVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9ucy5J\nbk1lbW9yeVN1YnNjcmlwdGlvblN0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuc2VydmVyLnRvcGljcy5IdWJJbmZvOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLnRvcGljcy5IdWJMb2FkOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnV0aWwuSGVkd2lnU29ja2V0QWRkcmVzczsKaW1wb3J0IG9yZy5z\nbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLktlZXBlckV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVudDsKaW1w\nb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLnpvb2tlZXBlci5kYXRhLlN0YXQ7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90\nb2J1Zi5CeXRlU3RyaW5nOwppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5J\nbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb247CmltcG9ydCBzdGF0aWMg\nY29tLmdvb2dsZS5jb21tb24uYmFzZS5DaGFyc2V0cy5VVEZfODsKCi8qKgog\nKiBIZWR3aWcgQWRtaW4KICovCnB1YmxpYyBjbGFzcyBIZWR3aWdBZG1pbiB7\nCiAgICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3Rvcnku\nZ2V0TG9nZ2VyKEhlZHdpZ0FkbWluLmNsYXNzKTsKCiAgICAvLyBOT1RFOiBu\nb3cgaXQgaXMgZml4ZWQgcGFzc3dkIHVzZWQgaW4gaGVkd2lnCiAgICBzdGF0\naWMgYnl0ZVtdIHBhc3N3ZCA9ICJzaWxseXNlY3JldCIuZ2V0Qnl0ZXMoVVRG\nXzgpOwoKICAgIHByb3RlY3RlZCBmaW5hbCBab29LZWVwZXIgems7CiAgICBw\ncm90ZWN0ZWQgZmluYWwgQm9va0tlZXBlciBiazsKICAgIHByb3RlY3RlZCBm\naW5hbCBNZXRhZGF0YU1hbmFnZXJGYWN0b3J5IG1tRmFjdG9yeTsKICAgIHBy\nb3RlY3RlZCBmaW5hbCBTdWJzY3JpcHRpb25EYXRhTWFuYWdlciBzZG07CiAg\nICBwcm90ZWN0ZWQgZmluYWwgVG9waWNPd25lcnNoaXBNYW5hZ2VyIHRvbTsK\nICAgIHByb3RlY3RlZCBmaW5hbCBUb3BpY1BlcnNpc3RlbmNlTWFuYWdlciB0\ncG07CgogICAgLy8gaHViIGNvbmZpZ3VyYXRpb25zCiAgICBwcm90ZWN0ZWQg\nZmluYWwgU2VydmVyQ29uZmlndXJhdGlvbiBzZXJ2ZXJDb25mOwogICAgLy8g\nYm9va2tlZXBlciBjb25maWd1cmF0aW9ucwogICAgcHJvdGVjdGVkIGZpbmFs\nIENsaWVudENvbmZpZ3VyYXRpb24gYmtDbGllbnRDb25mOwoKICAgIHByb3Rl\nY3RlZCBmaW5hbCBDb3VudERvd25MYXRjaCB6a1JlYWR5TGF0Y2ggPSBuZXcg\nQ291bnREb3duTGF0Y2goMSk7CgogICAgLy8gRW1wdHkgd2F0Y2hlcgogICAg\ncHJpdmF0ZSBjbGFzcyBNeVdhdGNoZXIgaW1wbGVtZW50cyBXYXRjaGVyIHsK\nICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKFdhdGNoZWRFdmVudCBldmVu\ndCkgewogICAgICAgICAgICBpZiAoRXZlbnQuS2VlcGVyU3RhdGUuU3luY0Nv\nbm5lY3RlZC5lcXVhbHMoZXZlbnQuZ2V0U3RhdGUoKSkpIHsKICAgICAgICAg\nICAgICAgIHprUmVhZHlMYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KCiAgICBzdGF0aWMgY2xhc3MgU3luY09iajxU\nPiB7CiAgICAgICAgYm9vbGVhbiBmaW5pc2hlZCA9IGZhbHNlOwogICAgICAg\nIGJvb2xlYW4gc3VjY2VzcyA9IGZhbHNlOwogICAgICAgIFQgdmFsdWUgPSBu\ndWxsOwogICAgICAgIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24gPSBudWxs\nOwoKICAgICAgICBzeW5jaHJvbml6ZWQgdm9pZCBzdWNjZXNzKFQgdikgewog\nICAgICAgICAgICBmaW5pc2hlZCA9IHRydWU7CiAgICAgICAgICAgIHN1Y2Nl\nc3MgPSB0cnVlOwogICAgICAgICAgICB2YWx1ZSA9IHY7CiAgICAgICAgICAg\nIG5vdGlmeSgpOwogICAgICAgIH0KCiAgICAgICAgc3luY2hyb25pemVkIHZv\naWQgZmFpbChQdWJTdWJFeGNlcHRpb24gcHNlKSB7CiAgICAgICAgICAgIGZp\nbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwog\nICAgICAgICAgICBleGNlcHRpb24gPSBwc2U7CiAgICAgICAgICAgIG5vdGlm\neSgpOwogICAgICAgIH0KCiAgICAgICAgc3luY2hyb25pemVkIHZvaWQgYmxv\nY2soKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB3aGls\nZSAoIWZpbmlzaGVkKSB7CiAgICAgICAgICAgICAgICAgICAgd2FpdCgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBzeW5jaHJvbml6ZWQgYm9vbGVhbiBpc1N1Y2Nlc3MoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzdWNjZXNzOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFN0YXRzIG9mIGEgaHViCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgY2xhc3MgSHViU3RhdHMgewogICAgICAgIEh1YkluZm8gaHVi\nSW5mbzsKICAgICAgICBIdWJMb2FkIGh1YkxvYWQ7CgogICAgICAgIHB1Ymxp\nYyBIdWJTdGF0cyhIdWJJbmZvIGluZm8sIEh1YkxvYWQgbG9hZCkgewogICAg\nICAgICAgICB0aGlzLmh1YkluZm8gPSBpbmZvOwogICAgICAgICAgICB0aGlz\nLmh1YkxvYWQgPSBsb2FkOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICAg\nICAgU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAg\nICAgICAgICAgIHNiLmFwcGVuZCgiaW5mbyA6IFsiKS5hcHBlbmQoaHViSW5m\nby50b1N0cmluZygpLnRyaW0oKS5yZXBsYWNlQWxsKCJcbiIsICIsICIpKQog\nICAgICAgICAgICAgIC5hcHBlbmQoIl0sIGxvYWQgOiBbIikuYXBwZW5kKGh1\nYkxvYWQudG9TdHJpbmcoKS50cmltKCkucmVwbGFjZUFsbCgiXG4iLCAiLCAi\nKSkKICAgICAgICAgICAgICAuYXBwZW5kKCJdIik7CiAgICAgICAgICAgIHJl\ndHVybiBzYi50b1N0cmluZygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIEhlZHdpZyBBZG1pbiBDb25zdHJ1Y3RvcgogICAgICoKICAgICAq\nIEBwYXJhbSBia0NvbmYKICAgICAqICAgICAgICAgIEJvb2tLZWVwZXIgQ2xp\nZW50IENvbmZpZ3VyYXRpb24uCiAgICAgKiBAcGFyYW0gaHViQ29uZgogICAg\nICogICAgICAgICAgSHViIFNlcnZlciBDb25maWd1cmF0aW9uLgogICAgICog\nQHRocm93cyBFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIEhlZHdpZ0Fk\nbWluKENsaWVudENvbmZpZ3VyYXRpb24gYmtDb25mLCBTZXJ2ZXJDb25maWd1\ncmF0aW9uIGh1YkNvbmYpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRo\naXMuc2VydmVyQ29uZiA9IGh1YkNvbmY7CiAgICAgICAgdGhpcy5ia0NsaWVu\ndENvbmYgPSBia0NvbmY7CgogICAgICAgIC8vIGNvbm5lY3QgdG8gem9va2Vl\ncGVyCiAgICAgICAgemsgPSBuZXcgWm9vS2VlcGVyKGh1YkNvbmYuZ2V0WmtI\nb3N0KCksIGh1YkNvbmYuZ2V0WmtUaW1lb3V0KCksIG5ldyBNeVdhdGNoZXIo\nKSk7CiAgICAgICAgTE9HLmRlYnVnKCJDb25uZWN0aW5nIHRvIHpvb2tlZXBl\nciB7fSwgdGltZW91dCA9IHt9IiwKICAgICAgICAgICAgICAgIGh1YkNvbmYu\nZ2V0WmtIb3N0KCksIGh1YkNvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAg\nIC8vIHdhaXQgdW50aWwgY29ubmVjdGlvbiBpcyByZWFkeQogICAgICAgIGlm\nICghemtSZWFkeUxhdGNoLmF3YWl0KGh1YkNvbmYuZ2V0WmtUaW1lb3V0KCkg\nKiAyLCBUaW1lVW5pdC5NSUxMSVNFQ09ORFMpKSB7CiAgICAgICAgICAgIHRo\ncm93IG5ldyBFeGNlcHRpb24oIkNvdW50IG5vdCBlc3RhYmxpc2ggY29ubmVj\ndGlvbiB3aXRoIFpvb0tlZXBlciBhZnRlciAiICsgaHViQ29uZi5nZXRaa1Rp\nbWVvdXQoKSAqIDIgKyAiIG1zLiIpOwogICAgICAgIH0KCiAgICAgICAgLy8g\nY29uc3RydWN0IHRoZSBtZXRhZGF0YSBtYW5hZ2VyIGZhY3RvcnkKICAgICAg\nICBtbUZhY3RvcnkgPSBNZXRhZGF0YU1hbmFnZXJGYWN0b3J5Lm5ld01ldGFk\nYXRhTWFuYWdlckZhY3RvcnkoaHViQ29uZiwgemspOwogICAgICAgIHRwbSA9\nIG1tRmFjdG9yeS5uZXdUb3BpY1BlcnNpc3RlbmNlTWFuYWdlcigpOwogICAg\nICAgIHRvbSA9IG1tRmFjdG9yeS5uZXdUb3BpY093bmVyc2hpcE1hbmFnZXIo\nKTsKICAgICAgICBzZG0gPSBtbUZhY3RvcnkubmV3U3Vic2NyaXB0aW9uRGF0\nYU1hbmFnZXIoKTsKCiAgICAgICAgLy8gY29ubmVjdCB0byBib29ra2VlcGVy\nCiAgICAgICAgYmsgPSBuZXcgQm9va0tlZXBlcihia0NsaWVudENvbmYsIHpr\nKTsKICAgICAgICBMT0cuZGVidWcoIkNvbm5lY3RpbmcgdG8gYm9va2tlZXBl\nciIpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xvc2UgdGhlIGhlZHdpZyBh\nZG1pbi4KICAgICAqCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHRwbS5jbG9zZSgpOwogICAgICAgIHRvbS5jbG9zZSgpOwogICAg\nICAgIHNkbS5jbG9zZSgpOwogICAgICAgIG1tRmFjdG9yeS5zaHV0ZG93bigp\nOwogICAgICAgIGJrLmNsb3NlKCk7CiAgICAgICAgemsuY2xvc2UoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB6b29rZWVwZXIgaGFuZGxlIHVz\nZWQgaW4gaGVkd2lnIGFkbWluLgogICAgICoKICAgICAqIEByZXR1cm4gem9v\na2VlcGVyIGhhbmRsZQogICAgICovCiAgICBwdWJsaWMgWm9vS2VlcGVyIGdl\ndFprSGFuZGxlKCkgewogICAgICAgIHJldHVybiB6azsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBib29ra2VlcGVyIGhhbmRsZSB1c2VkIGluIGhl\nZHdpZyBhZG1pbi4KICAgICAqCiAgICAgKiBAcmV0dXJuIGJvb2trZWVwZXIg\naGFuZGxlCiAgICAgKi8KICAgIHB1YmxpYyBCb29rS2VlcGVyIGdldEJrSGFu\nZGxlKCkgewogICAgICAgIHJldHVybiBiazsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBodWIgc2VydmVyIGNvbmZpZ3VyYXRpb24gdXNlZCBpbiBo\nZWR3aWcgYWRtaW4KICAgICAqCiAgICAgKiBAcmV0dXJuIGh1YiBzZXJ2ZXIg\nY29uZmlndXJhdGlvbgogICAgICovCiAgICBwdWJsaWMgU2VydmVyQ29uZmln\ndXJhdGlvbiBnZXRIdWJTZXJ2ZXJDb25mKCkgewogICAgICAgIHJldHVybiBz\nZXJ2ZXJDb25mOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIG1ldGFk\nYXRhIG1hbmFnZXIgZmFjdG9yeS4KICAgICAqCiAgICAgKiBAcmV0dXJuIG1l\ndGFkYXRhIG1hbmFnZXIgZmFjdG9yeSBpbnN0YW5jZS4KICAgICAqLwogICAg\ncHVibGljIE1ldGFkYXRhTWFuYWdlckZhY3RvcnkgZ2V0TWV0YWRhdGFNYW5h\nZ2VyRmFjdG9yeSgpIHsKICAgICAgICByZXR1cm4gbW1GYWN0b3J5OwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIGJvb2tlZXBlciBwYXNzd2QgdXNl\nZCBpbiBoZWR3aWcgYWRtaW4KICAgICAqCiAgICAgKiBAcmV0dXJuIGJvb2tl\nZXBlciBwYXNzd2QKICAgICAqLwogICAgcHVibGljIGJ5dGVbXSBnZXRCa1Bh\nc3N3ZCgpIHsKICAgICAgICByZXR1cm4gQXJyYXlzLmNvcHlPZihwYXNzd2Qs\nIHBhc3N3ZC5sZW5ndGgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIGRpZ2VzdCB0eXBlIHVzZWQgaW4gaGVkd2lnIGFkbWluCiAgICAgKgogICAg\nICogQHJldHVybiBib29rZWVwZXIgZGlnZXN0IHR5cGUKICAgICAqLwogICAg\ncHVibGljIERpZ2VzdFR5cGUgZ2V0QmtEaWdlc3RUeXBlKCkgewogICAgICAg\nIHJldHVybiBEaWdlc3RUeXBlLkNSQzMyOwogICAgfQoKICAgIC8qKgogICAg\nICogRG9zZSB0b3BpYyBleGlzdD8KICAgICAqCiAgICAgKiBAcGFyYW0gdG9w\naWMKICAgICAqICAgICAgICAgICAgVG9waWMgbmFtZQogICAgICogQHJldHVy\nbiB3aGV0aGVyIHRvcGljIGV4aXN0cyBvciBub3Q/CiAgICAgKiBAdGhyb3dz\nIEV4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNUb3Bp\nYyhCeXRlU3RyaW5nIHRvcGljKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICAvLyBjdXJyZW50IHBlcnNpc3RlbmNlIGluZm8gaXMgYm91bmQgd2l0aCBh\nIHRvcGljLCBzbyBpZiB0aGVyZSBpcyBwZXJzaXN0ZW5jZSBpbmZvCiAgICAg\nICAgLy8gdGhlcmUgaXMgdG9waWMuCiAgICAgICAgZmluYWwgU3luY09iajxC\nb29sZWFuPiBzeW5jT2JqID0gbmV3IFN5bmNPYmo8Qm9vbGVhbj4oKTsKICAg\nICAgICB0cG0ucmVhZFRvcGljUGVyc2lzdGVuY2VJbmZvKHRvcGljLCBuZXcg\nQ2FsbGJhY2s8VmVyc2lvbmVkPExlZGdlclJhbmdlcz4+KCkgewogICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVmVyc2lvbmVkPExlZGdlclJhbmdl\ncz4gcmVzdWx0KSB7CiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSByZXN1\nbHQpIHsKICAgICAgICAgICAgICAgICAgICBzeW5jT2JqLnN1Y2Nlc3MoZmFs\nc2UpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICBzeW5jT2JqLnN1Y2Nlc3ModHJ1ZSk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBQ\ndWJTdWJFeGNlcHRpb24gcHNlKSB7CiAgICAgICAgICAgICAgICBzeW5jT2Jq\nLmZhaWwocHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIHN5bmNPYmop\nOwoKICAgICAgICBzeW5jT2JqLmJsb2NrKCk7CgogICAgICAgIGlmICghc3lu\nY09iai5pc1N1Y2Nlc3MoKSkgewogICAgICAgICAgICB0aHJvdyBzeW5jT2Jq\nLmV4Y2VwdGlvbjsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzeW5jT2Jq\nLnZhbHVlOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IGF2YWlsYWJsZSBo\ndWJzLgogICAgICoKICAgICAqIEByZXR1cm4gYXZhaWxhYmxlIGh1YnMgYW5k\nIHRoZWlyIGxvYWRzCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICov\nCiAgICBwdWJsaWMgTWFwPEhlZHdpZ1NvY2tldEFkZHJlc3MsIEh1YlN0YXRz\nPiBnZXRBdmFpbGFibGVIdWJzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgU3RyaW5nIHprSHVic1BhdGggPSBzZXJ2ZXJDb25mLmdldFprSG9zdHNQ\ncmVmaXgobmV3IFN0cmluZ0J1aWxkZXIoKSkudG9TdHJpbmcoKTsKICAgICAg\nICBNYXA8SGVkd2lnU29ja2V0QWRkcmVzcywgSHViU3RhdHM+IGh1YnMgPQog\nICAgICAgICAgICBuZXcgSGFzaE1hcDxIZWR3aWdTb2NrZXRBZGRyZXNzLCBI\ndWJTdGF0cz4oKTsKICAgICAgICBMaXN0PFN0cmluZz4gaG9zdHMgPSB6ay5n\nZXRDaGlsZHJlbih6a0h1YnNQYXRoLCBmYWxzZSk7CiAgICAgICAgZm9yIChT\ndHJpbmcgaG9zdCA6IGhvc3RzKSB7CiAgICAgICAgICAgIFN0cmluZyB6a0h1\nYlBhdGggPSBzZXJ2ZXJDb25mLmdldFprSG9zdHNQcmVmaXgobmV3IFN0cmlu\nZ0J1aWxkZXIoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAuYXBwZW5kKCIvIikuYXBwZW5kKGhvc3QpLnRvU3RyaW5nKCk7\nCiAgICAgICAgICAgIEhlZHdpZ1NvY2tldEFkZHJlc3MgYWRkciA9IG5ldyBI\nZWR3aWdTb2NrZXRBZGRyZXNzKGhvc3QpOwogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgU3RhdCBzdGF0ID0gbmV3IFN0YXQoKTsKICAgICAg\nICAgICAgICAgIGJ5dGVbXSBkYXRhID0gemsuZ2V0RGF0YSh6a0h1YlBhdGgs\nIGZhbHNlLCBzdGF0KTsKICAgICAgICAgICAgICAgIGlmIChkYXRhID09IG51\nbGwpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIEh1YkxvYWQgbG9hZCA9IEh1Ykxv\nYWQucGFyc2UobmV3IFN0cmluZyhkYXRhLCBVVEZfOCkpOwogICAgICAgICAg\nICAgICAgSHViSW5mbyBpbmZvID0gbmV3IEh1YkluZm8oYWRkciwgc3RhdC5n\nZXRDenhpZCgpKTsKICAgICAgICAgICAgICAgIGh1YnMucHV0KGFkZHIsIG5l\ndyBIdWJTdGF0cyhpbmZvLCBsb2FkKSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEtlZXBlckV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICAgICAgTE9HLndh\ncm4oIkNvdWxkbid0IHJlYWQgaHViIGRhdGEgZnJvbSBab29LZWVwZXIiLCBr\nZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9u\nIGllKSB7CiAgICAgICAgICAgICAgICBMT0cud2FybigiSW50ZXJydXB0ZWQg\nZHVyaW5nIHJlYWQiLCBpZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIGh1YnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQg\nbGlzdCBvZiB0b3BpY3MKICAgICAqCiAgICAgKiBAcmV0dXJuIGxpc3Qgb2Yg\ndG9waWNzCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBw\ndWJsaWMgSXRlcmF0b3I8Qnl0ZVN0cmluZz4gZ2V0VG9waWNzKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG1tRmFjdG9yeS5nZXRUb3Bp\nY3MoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdG9waWMg\nb3duZXIgb2YgYSB0b3BpYwogICAgICoKICAgICAqIEBwYXJhbSB0b3BpYwog\nICAgICogICAgICAgICAgICBUb3BpYyBuYW1lCiAgICAgKiBAcmV0dXJuIHRo\nZSBhZGRyZXNzIG9mIHRoZSBvd25lciBvZiBhIHRvcGljCiAgICAgKiBAdGhy\nb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgSHViSW5mbyBnZXRU\nb3BpY093bmVyKEJ5dGVTdHJpbmcgdG9waWMpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIGZpbmFsIFN5bmNPYmo8SHViSW5mbz4gc3luY09iaiA9IG5l\ndyBTeW5jT2JqPEh1YkluZm8+KCk7CiAgICAgICAgdG9tLnJlYWRPd25lcklu\nZm8odG9waWMsIG5ldyBDYWxsYmFjazxWZXJzaW9uZWQ8SHViSW5mbz4+KCkg\newogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZv\naWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVmVyc2lvbmVkPEh1\nYkluZm8+IHJlc3VsdCkgewogICAgICAgICAgICAgICAgaWYgKG51bGwgPT0g\ncmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgc3luY09iai5zdWNjZXNz\nKG51bGwpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgICAgICBzeW5jT2JqLnN1Y2Nlc3MocmVzdWx0LmdldFZhbHVlKCkpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWls\nZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIHBzZSkgewogICAgICAg\nICAgICAgICAgc3luY09iai5mYWlsKHBzZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9LCBzeW5jT2JqKTsKCiAgICAgICAgc3luY09iai5ibG9jaygpOwoK\nICAgICAgICBpZiAoIXN5bmNPYmouaXNTdWNjZXNzKCkpIHsKICAgICAgICAg\nICAgdGhyb3cgc3luY09iai5leGNlcHRpb247CiAgICAgICAgfQoKICAgICAg\nICByZXR1cm4gc3luY09iai52YWx1ZTsKICAgIH0KCiAgICBwcml2YXRlIHN0\nYXRpYyBMZWRnZXJSYW5nZSBidWlsZExlZGdlclJhbmdlKGxvbmcgbGVkZ2Vy\nSWQsIGxvbmcgc3RhcnRPZkxlZGdlciwgTWVzc2FnZVNlcUlkIGVuZE9mTGVk\nZ2VyKSB7CiAgICAgICAgTGVkZ2VyUmFuZ2UuQnVpbGRlciBidWlsZGVyID0K\nICAgICAgICAgICAgTGVkZ2VyUmFuZ2UubmV3QnVpbGRlcigpLnNldExlZGdl\ncklkKGxlZGdlcklkKS5zZXRTdGFydFNlcUlkSW5jbHVkZWQoc3RhcnRPZkxl\nZGdlcikKICAgICAgICAgICAgICAgICAgICAgICAuc2V0RW5kU2VxSWRJbmNs\ndWRlZChlbmRPZkxlZGdlcik7CiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuYnVp\nbGQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbGVkZ2Vy\nIHJhbmdlIGZvcm1pbmcgdGhlIHRvcGljCiAgICAgKgogICAgICogQHBhcmFt\nIHRvcGljCiAgICAgKiAgICAgICAgICBUb3BpYyBuYW1lCiAgICAgKiBAcmV0\ndXJuIGxlZGdlciByYW5nZXMgZm9ybWluZyB0aGUgdG9waWMKICAgICAqIEB0\naHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0PExlZGdl\nclJhbmdlPiBnZXRUb3BpY0xlZGdlcnMoQnl0ZVN0cmluZyB0b3BpYykgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZmluYWwgU3luY09iajxMZWRnZXJS\nYW5nZXM+IHN5bmNPYmogPSBuZXcgU3luY09iajxMZWRnZXJSYW5nZXM+KCk7\nCiAgICAgICAgdHBtLnJlYWRUb3BpY1BlcnNpc3RlbmNlSW5mbyh0b3BpYywg\nbmV3IENhbGxiYWNrPFZlcnNpb25lZDxMZWRnZXJSYW5nZXM+PigpIHsKICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZlcnNpb25lZDxMZWRnZXJS\nYW5nZXM+IHJlc3VsdCkgewogICAgICAgICAgICAgICAgaWYgKG51bGwgPT0g\ncmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgc3luY09iai5zdWNjZXNz\nKG51bGwpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgICAgICBzeW5jT2JqLnN1Y2Nlc3MocmVzdWx0LmdldFZhbHVlKCkpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWls\nZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIHBzZSkgewogICAgICAg\nICAgICAgICAgc3luY09iai5mYWlsKHBzZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9LCBzeW5jT2JqKTsKCiAgICAgICAgc3luY09iai5ibG9jaygpOwoK\nICAgICAgICBpZiAoIXN5bmNPYmouaXNTdWNjZXNzKCkpIHsKICAgICAgICAg\nICAgdGhyb3cgc3luY09iai5leGNlcHRpb247CiAgICAgICAgfQoKICAgICAg\nICBMZWRnZXJSYW5nZXMgcmFuZ2VzID0gc3luY09iai52YWx1ZTsKICAgICAg\nICBpZiAobnVsbCA9PSByYW5nZXMpIHsKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgfQogICAgICAgIExpc3Q8TGVkZ2VyUmFuZ2U+IHJlc3Vs\ndHMgPSBuZXcgQXJyYXlMaXN0PExlZGdlclJhbmdlPigpOwogICAgICAgIExp\nc3Q8TGVkZ2VyUmFuZ2U+IGxycyA9IHJhbmdlcy5nZXRSYW5nZXNMaXN0KCk7\nCiAgICAgICAgbG9uZyBzdGFydFNlcUlkID0gMUw7CiAgICAgICAgaWYgKCFs\ncnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIExlZGdlclJhbmdlIHJhbmdl\nID0gbHJzLmdldCgwKTsKICAgICAgICAgICAgaWYgKCFyYW5nZS5oYXNTdGFy\ndFNlcUlkSW5jbHVkZWQoKSAmJiByYW5nZS5oYXNFbmRTZXFJZEluY2x1ZGVk\nKCkpIHsKICAgICAgICAgICAgICAgIGxvbmcgbGVkZ2VySWQgPSByYW5nZS5n\nZXRMZWRnZXJJZCgpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBiay5vcGVuTGVkZ2VyTm9S\nZWNvdmVyeShsZWRnZXJJZCwgRGlnZXN0VHlwZS5DUkMzMiwgcGFzc3dkKTsK\nICAgICAgICAgICAgICAgICAgICBsb25nIG51bUVudHJpZXMgPSBsaC5yZWFk\nTGFzdENvbmZpcm1lZCgpICsgMTsKICAgICAgICAgICAgICAgICAgICBsb25n\nIGVuZE9mTGVkZ2VyID0gcmFuZ2UuZ2V0RW5kU2VxSWRJbmNsdWRlZCgpLmdl\ndExvY2FsQ29tcG9uZW50KCk7CiAgICAgICAgICAgICAgICAgICAgc3RhcnRT\nZXFJZCA9IGVuZE9mTGVkZ2VyIC0gbnVtRW50cmllcyArIDE7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbi5CS05vU3VjaExlZGdlckV4\naXN0c0V4Y2VwdGlvbiBiZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGln\nbm9yZSBpdAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIEl0ZXJhdG9yPExlZGdlclJhbmdlPiBsckl0ZXIgPSBs\ncnMuaXRlcmF0b3IoKTsKICAgICAgICB3aGlsZSAobHJJdGVyLmhhc05leHQo\nKSkgewogICAgICAgICAgICBMZWRnZXJSYW5nZSByYW5nZSA9IGxySXRlci5u\nZXh0KCk7CiAgICAgICAgICAgIGlmIChyYW5nZS5oYXNFbmRTZXFJZEluY2x1\nZGVkKCkpIHsKICAgICAgICAgICAgICAgIGxvbmcgZW5kT2ZMZWRnZXIgPSBy\nYW5nZS5nZXRFbmRTZXFJZEluY2x1ZGVkKCkuZ2V0TG9jYWxDb21wb25lbnQo\nKTsKICAgICAgICAgICAgICAgIGlmIChyYW5nZS5oYXNTdGFydFNlcUlkSW5j\nbHVkZWQoKSkgewogICAgICAgICAgICAgICAgICAgIHN0YXJ0U2VxSWQgPSBy\nYW5nZS5nZXRTdGFydFNlcUlkSW5jbHVkZWQoKTsKICAgICAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBidWlsZExl\nZGdlclJhbmdlKHJhbmdlLmdldExlZGdlcklkKCksIHN0YXJ0U2VxSWQsIHJh\nbmdlLmdldEVuZFNlcUlkSW5jbHVkZWQoKSk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICByZXN1bHRzLmFkZChyYW5nZSk7CiAgICAgICAg\nICAgICAgICBpZiAoc3RhcnRTZXFJZCA8IGVuZE9mTGVkZ2VyICsgMSkgewog\nICAgICAgICAgICAgICAgICAgIHN0YXJ0U2VxSWQgPSBlbmRPZkxlZGdlciAr\nIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobHJJdGVyLmhhc05l\neHQoKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0\nZUV4Y2VwdGlvbigiTGVkZ2VyICIgKyByYW5nZS5nZXRMZWRnZXJJZCgpICsg\nIiBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nKCkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIGlzIG5v\ndCB0aGUgbGFzdCBvbmUgYnV0IHN0aWxsIGRvZXMgbm90IGhhdmUgYW4gZW5k\nIHNlcS1pZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAocmFu\nZ2UuaGFzU3RhcnRTZXFJZEluY2x1ZGVkKCkpIHsKICAgICAgICAgICAgICAg\nIHN0YXJ0U2VxSWQgPSByYW5nZS5nZXRTdGFydFNlcUlkSW5jbHVkZWQoKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0g\nYmsub3BlbkxlZGdlck5vUmVjb3ZlcnkocmFuZ2UuZ2V0TGVkZ2VySWQoKSwg\nRGlnZXN0VHlwZS5DUkMzMiwgcGFzc3dkKTsKICAgICAgICAgICAgbG9uZyBl\nbmRPZkxlZGdlciA9IHN0YXJ0U2VxSWQgKyBsaC5yZWFkTGFzdENvbmZpcm1l\nZCgpOwogICAgICAgICAgICBNZXNzYWdlU2VxSWQgZW5kU2VxSWQgPSBNZXNz\nYWdlU2VxSWQubmV3QnVpbGRlcigpLnNldExvY2FsQ29tcG9uZW50KGVuZE9m\nTGVkZ2VyKS5idWlsZCgpOwogICAgICAgICAgICByZXN1bHRzLmFkZChidWls\nZExlZGdlclJhbmdlKHJhbmdlLmdldExlZGdlcklkKCksIHN0YXJ0U2VxSWQs\nIGVuZFNlcUlkKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHRz\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHN1YnNjcmlwdGlvbnMg\nb2YgYSB0b3BpYwogICAgICoKICAgICAqIEBwYXJhbSB0b3BpYwogICAgICog\nICAgICAgICAgVG9waWMgbmFtZQogICAgICogQHJldHVybiBzdWJzY3JpcHRp\nb25zIG9mIGEgdG9waWMKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAg\nKi8KICAgIHB1YmxpYyBNYXA8Qnl0ZVN0cmluZywgU3Vic2NyaXB0aW9uRGF0\nYT4gZ2V0VG9waWNTdWJzY3JpcHRpb25zKEJ5dGVTdHJpbmcgdG9waWMpCiAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CgogICAgICAgIGZpbmFsIFN5bmNP\nYmo8TWFwPEJ5dGVTdHJpbmcsIFN1YnNjcmlwdGlvbkRhdGE+PiBzeW5jT2Jq\nID0KICAgICAgICAgICAgbmV3IFN5bmNPYmo8TWFwPEJ5dGVTdHJpbmcsIFN1\nYnNjcmlwdGlvbkRhdGE+PigpOwogICAgICAgIHNkbS5yZWFkU3Vic2NyaXB0\naW9ucyh0b3BpYywgbmV3IENhbGxiYWNrPE1hcDxCeXRlU3RyaW5nLCBWZXJz\naW9uZWQ8U3Vic2NyaXB0aW9uRGF0YT4+PigpIHsKICAgICAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlz\naGVkKE9iamVjdCBjdHgsIE1hcDxCeXRlU3RyaW5nLCBWZXJzaW9uZWQ8U3Vi\nc2NyaXB0aW9uRGF0YT4+IHJlc3VsdCkgewogICAgICAgICAgICAgICAgLy8g\nSXQgd2FzIGp1c3QgdXNlZCB0byBjb25zb2xlIHRvb2wgdG8gcHJpbnQgc29t\nZSBpbmZvcm1hdGlvbiwgc28gZG9uJ3QgbmVlZCB0byByZXR1cm4gdmVyc2lv\nbiBmb3IgaXQKICAgICAgICAgICAgICAgIC8vIGp1c3Qga2VlcCB0aGUgZ2V0\nVG9waWNTdWJzY3JpcHRpb25zIGludGVyZmFjZSBhcyBiZWZvcmUKICAgICAg\nICAgICAgICAgIE1hcDxCeXRlU3RyaW5nLCBTdWJzY3JpcHRpb25EYXRhPiBz\ndWJzID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPEJ5dGVTdHJpbmcsIFN1YnNj\ncmlwdGlvbkRhdGE+KCk7CiAgICAgICAgICAgICAgICBmb3IgKE1hcC5FbnRy\neTxCeXRlU3RyaW5nLCBWZXJzaW9uZWQ8U3Vic2NyaXB0aW9uRGF0YT4+IHN1\nYkVudHJ5IDogcmVzdWx0LmVudHJ5U2V0KCkpIHsKICAgICAgICAgICAgICAg\nICAgICBzdWJzLnB1dChzdWJFbnRyeS5nZXRLZXkoKSwgc3ViRW50cnkuZ2V0\nVmFsdWUoKS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIHN5bmNPYmouc3VjY2VzcyhzdWJzKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZv\naWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlv\nbiBwc2UpIHsKICAgICAgICAgICAgICAgIHN5bmNPYmouZmFpbChwc2UpOwog\nICAgICAgICAgICB9CiAgICAgICAgfSwgc3luY09iaik7CgogICAgICAgIHN5\nbmNPYmouYmxvY2soKTsKCiAgICAgICAgaWYgKCFzeW5jT2JqLmlzU3VjY2Vz\ncygpKSB7CiAgICAgICAgICAgIHRocm93IHN5bmNPYmouZXhjZXB0aW9uOwog\nICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHN5bmNPYmoudmFsdWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gc3Vic2NyaXB0aW9uIHN0YXRlIG9m\nIGEgc3Vic2NyaWJlciBvZiB0b3BpYwogICAgICoKICAgICAqIEBwYXJhbSB0\nb3BpYwogICAgICogICAgICAgICAgVG9waWMgbmFtZQogICAgICogQHBhcmFt\nIHN1YnNjcmliZXIKICAgICAqICAgICAgICAgIFN1YnNjcmliZXIgbmFtZQog\nICAgICogQHJldHVybiBzdWJzY3JpcHRpb24gc3RhdGUKICAgICAqIEB0aHJv\nd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBTdWJzY3JpcHRpb25E\nYXRhIGdldFN1YnNjcmlwdGlvbihCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3Ry\naW5nIHN1YnNjcmliZXIpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGZp\nbmFsIFN5bmNPYmo8U3Vic2NyaXB0aW9uRGF0YT4gc3luY09iaiA9IG5ldyBT\neW5jT2JqPFN1YnNjcmlwdGlvbkRhdGE+KCk7CiAgICAgICAgc2RtLnJlYWRT\ndWJzY3JpcHRpb25EYXRhKHRvcGljLCBzdWJzY3JpYmVyLCBuZXcgQ2FsbGJh\nY2s8VmVyc2lvbmVkPFN1YnNjcmlwdGlvbkRhdGE+PigpIHsKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlv\nbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZlcnNpb25lZDxTdWJzY3JpcHRpb25E\nYXRhPiByZXN1bHQpIHsKICAgICAgICAgICAgICAgIGlmIChudWxsID09IHJl\nc3VsdCkgewogICAgICAgICAgICAgICAgICAgIHN5bmNPYmouc3VjY2Vzcyhu\ndWxsKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgc3luY09iai5zdWNjZXNzKHJlc3VsdC5nZXRWYWx1ZSgpKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVk\nKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBwc2UpIHsKICAgICAgICAg\nICAgICAgIHN5bmNPYmouZmFpbChwc2UpOwogICAgICAgICAgICB9CiAgICAg\nICAgfSwgc3luY09iaik7CgogICAgICAgIHN5bmNPYmouYmxvY2soKTsKCiAg\nICAgICAgaWYgKCFzeW5jT2JqLmlzU3VjY2VzcygpKSB7CiAgICAgICAgICAg\nIHRocm93IHN5bmNPYmouZXhjZXB0aW9uOwogICAgICAgIH0KCiAgICAgICAg\ncmV0dXJuIHN5bmNPYmoudmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBG\nb3JtYXQgbWV0YWRhdGEgZm9yIEhlZHdpZy4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgZm9ybWF0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8g\nZm9ybWF0IG1ldGFkYXRhIGZpcnN0CiAgICAgICAgbW1GYWN0b3J5LmZvcm1h\ndChzZXJ2ZXJDb25mLCB6ayk7CiAgICAgICAgTE9HLmluZm8oIkZvcm1hdHRl\nZCBIZWR3aWcgbWV0YWRhdGEgc3VjY2Vzc2Z1bGx5LiIpOwogICAgICAgIC8v\nIHJlbW92ZSBtZXRhZGF0YSBsYXlvdXQKICAgICAgICBGYWN0b3J5TGF5b3V0\nLmRlbGV0ZUxheW91dCh6aywgc2VydmVyQ29uZik7CiAgICAgICAgTE9HLmlu\nZm8oIlJlbW92ZWQgb2xkIGZhY3RvcnkgbGF5b3V0LiIpOwogICAgICAgIC8v\nIGNyZWF0ZSBuZXcgbWV0YWRhdGEgbWFuYWdlciBmYWN0b3J5IGFuZCB3cml0\nZSBuZXcgbWV0YWRhdGEgbGF5b3V0CiAgICAgICAgTWV0YWRhdGFNYW5hZ2Vy\nRmFjdG9yeS5jcmVhdGVNZXRhZGF0YU1hbmFnZXJGYWN0b3J5KHNlcnZlckNv\nbmYsIHprLAogICAgICAgICAgICBzZXJ2ZXJDb25mLmdldE1ldGFkYXRhTWFu\nYWdlckZhY3RvcnlDbGFzcygpKTsKICAgICAgICBMT0cuaW5mbygiQ3JlYXRl\nZCBuZXcgZmFjdG9yeSBsYXlvdXQuIik7CiAgICB9Cn0K\n","encoding":"base64"}

