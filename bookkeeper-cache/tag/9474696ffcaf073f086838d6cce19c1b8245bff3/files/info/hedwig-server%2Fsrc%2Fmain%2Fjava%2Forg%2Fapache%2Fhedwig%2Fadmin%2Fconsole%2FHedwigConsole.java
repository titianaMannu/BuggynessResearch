{"sha":"3a5ef5a5bd4920eebb34e5fbbf8297519a3cdf82","node_id":"MDQ6QmxvYjE1NzU5NTY6M2E1ZWY1YTViZDQ5MjBlZWJiMzRlNWZiYmY4Mjk3NTE5YTNjZGY4Mg==","size":36452,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/3a5ef5a5bd4920eebb34e5fbbf8297519a3cdf82","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW4uY29uc29sZTsKCmltcG9y\ndCBqbGluZS5Db25zb2xlUmVhZGVyOwppbXBvcnQgamxpbmUuSGlzdG9yeTsK\naW1wb3J0IGpsaW5lLlRlcm1pbmFsOwoKaW1wb3J0IGphdmEuaW8uQnVmZmVy\nZWRSZWFkZXI7CmltcG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlv\nLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbVJlYWRl\ncjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBq\nYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkSGFz\naE1hcDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9u\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0Y2g7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5NYXRoVXRpbHM7CmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5Db25maWd1cmF0\naW9uRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW4u\nSGVkd2lnQWRtaW47CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQu\nYXBpLk1lc3NhZ2VIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nY2xpZW50LmFwaS5QdWJsaXNoZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5jbGllbnQuYXBpLlN1YnNjcmliZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLkxl\nZGdlclJhbmdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wu\nUHViU3ViUHJvdG9jb2wuTGVkZ2VyUmFuZ2VzOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29s\nLk1lc3NhZ2VTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmliZVJlcXVlc3QuQ3JlYXRlT3JB\ndHRhY2g7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5TdWJzY3JpcHRpb25EYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9u\nRXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5TdWJzY3JpcHRpb25PcHRpb25zOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25zLlN1YnNjcmlwdGlvblN0YXRl\nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9u\nLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5zZXJ2ZXIudG9waWNzLkh1YkluZm87CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ndXRpbC5IZWR3aWdTb2NrZXRBZGRyZXNzOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcudXRpbC5TdWJzY3JpcHRpb25MaXN0ZW5lcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuem9va2VlcGVyLldhdGNoZWRFdmVudDsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLldhdGNoZXI7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNv\nbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0IHN0YXRpYyBj\nb20uZ29vZ2xlLmNvbW1vbi5iYXNlLkNoYXJzZXRzLlVURl84OwoKaW1wb3J0\nIHN0YXRpYyBvcmcuYXBhY2hlLmhlZHdpZy5hZG1pbi5jb25zb2xlLkhlZHdp\nZ0NvbW1hbmRzLio7CmltcG9ydCBzdGF0aWMgb3JnLmFwYWNoZS5oZWR3aWcu\nYWRtaW4uY29uc29sZS5IZWR3aWdDb21tYW5kcy5DT01NQU5ELio7CgovKioK\nICogQ29uc29sZSBDbGllbnQgdG8gSGVkd2lnCiAqLwpwdWJsaWMgY2xhc3Mg\nSGVkd2lnQ29uc29sZSB7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dn\nZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSGVkd2lnQ29uc29s\nZS5jbGFzcyk7CiAgICAvLyBOT1RFOiBub3cgaXQgaXMgZml4ZWQgcGFzc3dk\nIGluIGJvb2trZWVwZXIKICAgIHN0YXRpYyBieXRlW10gcGFzc3dkID0gInNp\nbGx5c2VjcmV0Ii5nZXRCeXRlcyhVVEZfOCk7CgogICAgLy8gaGlzdG9yeSBm\naWxlIG5hbWUKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgSFdfSElTVE9SWV9G\nSUxFID0gIi5od19oaXN0b3J5IjsKCiAgICBzdGF0aWMgZmluYWwgY2hhcltd\nIENPTlRJTlVFX09SX1FVSVQgPSBuZXcgY2hhcltdIHsgJ1EnLCAncScsICdc\nbicgfTsKCiAgICBwcm90ZWN0ZWQgTXlDb21tYW5kT3B0aW9ucyBjbCA9IG5l\ndyBNeUNvbW1hbmRPcHRpb25zKCk7CiAgICBwcm90ZWN0ZWQgSGFzaE1hcDxJ\nbnRlZ2VyLCBTdHJpbmc+IGhpc3RvcnkgPSBuZXcgTGlua2VkSGFzaE1hcDxJ\nbnRlZ2VyLCBTdHJpbmc+KCk7CiAgICBwcm90ZWN0ZWQgaW50IGNvbW1hbmRD\nb3VudCA9IDA7CiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBwcmludFdhdGNoZXMg\nPSB0cnVlOwogICAgcHJvdGVjdGVkIE1hcDxTdHJpbmcsIE15Q29tbWFuZD4g\nbXlDb21tYW5kczsKCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpbkNvbnNvbGUg\nPSB0cnVlOwogICAgcHJvdGVjdGVkIENvbnNvbGVSZWFkZXIgY29uc29sZSA9\nIG51bGw7CgogICAgcHJvdGVjdGVkIEhlZHdpZ0FkbWluIGFkbWluOwogICAg\ncHJvdGVjdGVkIEhlZHdpZ0NsaWVudCBodWJDbGllbnQ7CiAgICBwcm90ZWN0\nZWQgUHVibGlzaGVyIHB1Ymxpc2hlcjsKICAgIHByb3RlY3RlZCBTdWJzY3Jp\nYmVyIHN1YnNjcmliZXI7CiAgICBwcm90ZWN0ZWQgQ29uc29sZU1lc3NhZ2VI\nYW5kbGVyIGNvbnNvbGVIYW5kbGVyID0KICAgICAgICAgICAgbmV3IENvbnNv\nbGVNZXNzYWdlSGFuZGxlcigpOwogICAgcHJvdGVjdGVkIFRlcm1pbmFsIHRl\ncm1pbmFsOwoKICAgIHByb3RlY3RlZCBTdHJpbmcgbXlSZWdpb247CgogICAg\naW50ZXJmYWNlIE15Q29tbWFuZCB7CiAgICAgICAgYm9vbGVhbiBydW5DbWQo\nU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbjsKICAgIH0KCiAgICBz\ndGF0aWMgY2xhc3MgSGVscENtZCBpbXBsZW1lbnRzIE15Q29tbWFuZCB7Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBib29sZWFuIHJ1bkNt\nZChTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgYm9vbGVhbiBwcmludFVzYWdlID0gdHJ1ZTsKICAgICAgICAgICAgaWYg\nKGFyZ3MubGVuZ3RoID49IDIpIHsKICAgICAgICAgICAgICAgIFN0cmluZyBj\nb21tYW5kID0gYXJnc1sxXTsKICAgICAgICAgICAgICAgIENPTU1BTkQgYyA9\nIGdldEhlZHdpZ0NvbW1hbmRzKCkuZ2V0KGNvbW1hbmQpOwogICAgICAgICAg\nICAgICAgaWYgKGMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGMu\ncHJpbnRVc2FnZSgpOwogICAgICAgICAgICAgICAgICAgIHByaW50VXNhZ2Ug\nPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAocHJpbnRVc2FnZSkgewogICAgICAgICAgICAgICAgdXNh\nZ2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICB9CiAgICB9CgogICAgY2xhc3MgRXhpdENtZCBpbXBsZW1lbnRz\nIE15Q29tbWFuZCB7CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBib29sZWFuIHJ1bkNtZChTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICAgICAgcHJpbnRNZXNzYWdlKCJRdWl0dGluZyAuLi4i\nKTsKICAgICAgICAgICAgaHViQ2xpZW50LmNsb3NlKCk7CiAgICAgICAgICAg\nIGFkbWluLmNsb3NlKCk7CiAgICAgICAgICAgIFJ1bnRpbWUuZ2V0UnVudGlt\nZSgpLmV4aXQoMCk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nIH0KICAgIH0KCiAgICBjbGFzcyBSZWRvQ21kIGltcGxlbWVudHMgTXlDb21t\nYW5kIHsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gcnVuQ21kKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGludCBpbmRleDsKICAgICAgICAgICAgaWYgKCIhIi5lcXVhbHMoYXJnc1sx\nXSkpIHsKICAgICAgICAgICAgICAgIGluZGV4ID0gY29tbWFuZENvdW50IC0g\nMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGluZGV4\nID0gSW50ZWdlci5kZWNvZGUoYXJnc1sxXSk7CiAgICAgICAgICAgICAgICBp\nZiAoY29tbWFuZENvdW50IDw9IGluZGV4KSB7CiAgICAgICAgICAgICAgICAg\nICAgU3lzdGVtLmVyci5wcmludGxuKCJDb21tYW5kIGluZGV4IG91dCBvZiBy\nYW5nZSIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbC5w\nYXJzZUNvbW1hbmQoaGlzdG9yeS5nZXQoaW5kZXgpKTsKICAgICAgICAgICAg\naWYgKGNsLmdldENvbW1hbmQoKS5lcXVhbHMoInJlZG8iKSkgewogICAgICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJObyByZWRvaW5nIHJlZG9z\nIik7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgaGlzdG9yeS5wdXQoY29tbWFuZENvdW50LCBoaXN0\nb3J5LmdldChpbmRleCkpOwogICAgICAgICAgICBwcm9jZXNzQ21kKGNsKTsK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIAog\nICAgfQoKICAgIGNsYXNzIEhpc3RvcnlDbWQgaW1wbGVtZW50cyBNeUNvbW1h\nbmQgewoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBydW5DbWQoU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIGZvciAoaW50IGk9Y29tbWFuZENvdW50IC0gMTA7IGk8PWNv\nbW1hbmRDb3VudDsgKytpKSB7CiAgICAgICAgICAgICAgICBpZiAoaSA8IDAp\nIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihpICsg\nIiAtICIgKyBoaXN0b3J5LmdldChpKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIAogICAgfQoK\nICAgIGNsYXNzIFNldENtZCBpbXBsZW1lbnRzIE15Q29tbWFuZCB7CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBib29sZWFuIHJ1bkNtZChT\ndHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAg\naWYgKGFyZ3MubGVuZ3RoIDwgMyB8fCAhInByaW50d2F0Y2hlcyIuZXF1YWxz\nKGFyZ3NbMV0pKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgICAgIH0gZWxzZSBpZiAoYXJncy5sZW5ndGggPT0gMikgewogICAg\nICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJwcmludHdhdGNoZXMg\naXMgIiArIChwcmludFdhdGNoZXMgPyAib24iIDogIm9mZiIpKTsKICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHByaW50V2F0Y2hlcyA9\nIGFyZ3NbMl0uZXF1YWxzKCJvbiIpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICAKICAgIH0KCiAg\nICBjbGFzcyBQdWJDbWQgaW1wbGVtZW50cyBNeUNvbW1hbmQgewoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgYm9vbGVhbiBydW5DbWQoU3Ry\naW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlm\nIChhcmdzLmxlbmd0aCA8IDMpIHsKICAgICAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBCeXRlU3RyaW5nIHRv\ncGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoYXJnc1sxXSk7CgogICAg\nICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1aWxkZXIo\nKTsKICAgICAgICAgICAgZm9yIChpbnQgaT0yOyBpPGFyZ3MubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgICAgIHNiLmFwcGVuZChhcmdzW2ldKTsKICAg\nICAgICAgICAgICAgIGlmIChpICE9IGFyZ3MubGVuZ3RoIC0gMSkgewogICAg\nICAgICAgICAgICAgICAgIHNiLmFwcGVuZCgnICcpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIEJ5dGVTdHJpbmcgbXNn\nQm9keSA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KHNiLnRvU3RyaW5nKCkp\nOwogICAgICAgICAgICBNZXNzYWdlIG1zZyA9IE1lc3NhZ2UubmV3QnVpbGRl\ncigpLnNldEJvZHkobXNnQm9keSkuYnVpbGQoKTsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljLCBt\nc2cpOwogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJQVUIg\nRE9ORSIpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJQVUIgRkFJTEVE\nIik7CiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nICAgICAgICAKICAgIH0KCiAgICBzdGF0aWMgY2xhc3MgQ29uc29sZU1lc3Nh\nZ2VIYW5kbGVyIGltcGxlbWVudHMgTWVzc2FnZUhhbmRsZXIgewoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBkZWxpdmVyKEJ5dGVT\ndHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLAogICAgICAg\nICAgICAgICAgTWVzc2FnZSBtc2csIENhbGxiYWNrPFZvaWQ+IGNhbGxiYWNr\nLCBPYmplY3QgY29udGV4dCkgewogICAgICAgICAgICBTeXN0ZW0ub3V0LnBy\naW50bG4oIlJlY2VpdmVkIG1lc3NhZ2UgZnJvbSB0b3BpYyAiICsgdG9waWMu\ndG9TdHJpbmdVdGY4KCkgKyAKICAgICAgICAgICAgICAgICAgICAiIGZvciBz\ndWJzY3JpYmVyICIgKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkgKyAi\nIDogIgogICAgICAgICAgICAgICAgICAgICsgbXNnLmdldEJvZHkoKS50b1N0\ncmluZ1V0ZjgoKSk7CiAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZp\nbmlzaGVkKGNvbnRleHQsIG51bGwpOwogICAgICAgIH0KICAgICAgICAKICAg\nIH0KCiAgICBzdGF0aWMgY2xhc3MgQ29uc29sZVN1YnNjcmlwdGlvbkxpc3Rl\nbmVyIGltcGxlbWVudHMgU3Vic2NyaXB0aW9uTGlzdGVuZXIgewoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzRXZlbnQo\nQnl0ZVN0cmluZyB0LCBCeXRlU3RyaW5nIHMsIFN1YnNjcmlwdGlvbkV2ZW50\nIGV2ZW50KSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiU3Vi\nc2NyaXB0aW9uIENoYW5uZWwgZm9yICh0b3BpYzoiICsgdC50b1N0cmluZ1V0\nZjgoKSArICIsIHN1YnNjcmliZXI6IgogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgcy50b1N0cmluZ1V0ZjgoKSArICIpIHJlY2VpdmVkIGV2\nZW50IDogIiArIGV2ZW50KTsKICAgICAgICB9CiAgICB9CgogICAgY2xhc3Mg\nU3ViQ21kIGltcGxlbWVudHMgTXlDb21tYW5kIHsKCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gcnVuQ21kKFN0cmluZ1tdIGFy\nZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBDcmVhdGVPckF0\ndGFjaCBtb2RlOwogICAgICAgICAgICBib29sZWFuIHJlY2VpdmUgPSB0cnVl\nOwogICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAzKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0gZWxzZSBpZiAo\nYXJncy5sZW5ndGggPT0gMykgewogICAgICAgICAgICAgICAgbW9kZSA9IENy\nZWF0ZU9yQXR0YWNoLkFUVEFDSDsKICAgICAgICAgICAgICAgIHJlY2VpdmUg\nPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICBtb2RlID0gQ3JlYXRlT3JBdHRh\nY2gudmFsdWVPZihJbnRlZ2VyLnBhcnNlSW50KGFyZ3NbM10pKTsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJVbmtub3cgbW9kZSA6ICIg\nKyBhcmdzWzNdKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoYXJncy5s\nZW5ndGggPj0gNSkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJlY2VpdmUgPSBCb29sZWFuLnBhcnNlQm9v\nbGVhbihhcmdzWzRdKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZl\nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtb2RlID09IG51\nbGwpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiVW5r\nbm93IG1vZGUgOiAiICsgYXJnc1szXSk7CiAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgQnl0ZVN0cmlu\nZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KGFyZ3NbMV0pOwog\nICAgICAgICAgICBCeXRlU3RyaW5nIHN1YklkID0gQnl0ZVN0cmluZy5jb3B5\nRnJvbVV0ZjgoYXJnc1syXSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdGlvbnMgPQogICAgICAg\nICAgICAgICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigp\nLnNldENyZWF0ZU9yQXR0YWNoKG1vZGUpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC5zZXRGb3JjZUF0dGFjaChmYWxzZSkuYnVp\nbGQoKTsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKHRv\ncGljLCBzdWJJZCwgb3B0aW9ucyk7CiAgICAgICAgICAgICAgICBpZiAocmVj\nZWl2ZSkgewogICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuc3RhcnRE\nZWxpdmVyeSh0b3BpYywgc3ViSWQsIGNvbnNvbGVIYW5kbGVyKTsKICAgICAg\nICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlNVQiBET05FIEFO\nRCBSRUNFSVZFIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiU1VCIERPTkUgQlVU\nIE5PVCBSRUNFSVZFIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBTeXN0\nZW0uZXJyLnByaW50bG4oIlNVQiBGQUlMRUQiKTsKICAgICAgICAgICAgICAg\nIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIGNsYXNzIFVu\nc3ViQ21kIGltcGxlbWVudHMgTXlDb21tYW5kIHsKCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gcnVuQ21kKFN0cmluZ1tdIGFy\nZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBpZiAoYXJncy5s\nZW5ndGggPCAzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5\ndGVTdHJpbmcuY29weUZyb21VdGY4KGFyZ3NbMV0pOwogICAgICAgICAgICBC\neXRlU3RyaW5nIHN1YklkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoYXJn\nc1syXSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdWJz\nY3JpYmVyLnN0b3BEZWxpdmVyeSh0b3BpYywgc3ViSWQpOwogICAgICAgICAg\nICAgICAgc3Vic2NyaWJlci51bnN1YnNjcmliZSh0b3BpYywgc3ViSWQpOwog\nICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJVTlNVQiBET05F\nIik7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIlVOU1VCIEZBSUxFRCIp\nOwogICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAg\nICAgICAgCiAgICB9CgogICAgY2xhc3MgUm1zdWJDbWQgaW1wbGVtZW50cyBN\neUNvbW1hbmQgewoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBydW5DbWQoU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IDcpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBTdHJpbmcgdG9waWNQcmVmaXggPSBhcmdzWzFdOwogICAgICAgICAg\nICBpbnQgc3RhcnRUb3BpYyA9IEludGVnZXIucGFyc2VJbnQoYXJnc1syXSk7\nCiAgICAgICAgICAgIGludCBlbmRUb3BpYyA9IEludGVnZXIucGFyc2VJbnQo\nYXJnc1szXSk7CiAgICAgICAgICAgIFN0cmluZyBzdWJQcmVmaXggPSBhcmdz\nWzRdOwogICAgICAgICAgICBpbnQgc3RhcnRTdWIgPSBJbnRlZ2VyLnBhcnNl\nSW50KGFyZ3NbNV0pOwogICAgICAgICAgICBpbnQgZW5kU3ViID0gSW50ZWdl\nci5wYXJzZUludChhcmdzWzZdKTsKICAgICAgICAgICAgaWYgKHN0YXJ0VG9w\naWMgPiBlbmRUb3BpYyB8fCBlbmRTdWIgPCBzdGFydFN1YikgewogICAgICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGZvciAoaW50IGk9c3RhcnRUb3BpYzsgaTw9ZW5kVG9waWM7IGkrKykg\newogICAgICAgICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KHRvcGljUHJlZml4ICsgaSk7CiAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGo9c3Rh\ncnRTdWI7IGo8PWVuZFN1YjsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIEJ5dGVTdHJpbmcgc3ViID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0Zjgo\nc3ViUHJlZml4ICsgaik7CiAgICAgICAgICAgICAgICAgICAgICAgIFN1YnNj\ncmlwdGlvbk9wdGlvbnMgb3B0cyA9IFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3\nQnVpbGRlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0Q3Jl\nYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCku\nYnVpbGQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5z\ndWJzY3JpYmUodG9waWMsIHN1Yiwgb3B0cyk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHN1YnNjcmliZXIudW5zdWJzY3JpYmUodG9waWMsIHN1Yik7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIFN5c3Rl\nbS5vdXQucHJpbnRsbigiUk1TVUIgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgp\nICsgIiBET05FIik7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRs\nbigiUk1TVUIgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiBGQUlMRUQi\nKTsKICAgICAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgIH0KCiAgICB9CiAgICAKICAgIGNsYXNzIENs\nb3NlU3Vic2NyaXB0aW9uQ21kIGltcGxlbWVudHMgTXlDb21tYW5kIHsKCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gcnVuQ21k\nKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAoYXJncy5sZW5ndGggPCAzKSB7CiAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgQnl0ZVN0cmlu\nZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KGFyZ3NbMV0pOwog\nICAgICAgICAgICBCeXRlU3RyaW5nIHN1ZElkID0gQnl0ZVN0cmluZy5jb3B5\nRnJvbVV0ZjgoYXJnc1syXSk7CiAgICAgICAgICAgIAogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgc3Vic2NyaWJlci5zdG9wRGVsaXZlcnko\ndG9waWMsIHN1ZElkKTsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY2xv\nc2VTdWJzY3JpcHRpb24odG9waWMsIHN1ZElkKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5l\ncnIucHJpbnRsbigiQ0xPU0VTVUIgRkFJTEVEIik7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIAog\nICAgfQogICAgCiAgICBjbGFzcyBDb25zdW1lVG9DbWQgaW1wbGVtZW50cyBN\neUNvbW1hbmQgewoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBydW5DbWQoU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IDQpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0\nZjgoYXJnc1sxXSk7CiAgICAgICAgICAgIEJ5dGVTdHJpbmcgc3ViSWQgPSBC\neXRlU3RyaW5nLmNvcHlGcm9tVXRmOChhcmdzWzJdKTsKICAgICAgICAgICAg\nbG9uZyBtc2dJZCA9IExvbmcucGFyc2VMb25nKGFyZ3NbM10pOwogICAgICAg\nICAgICBNZXNzYWdlU2VxSWQgY29uc3VtZUlkID0gTWVzc2FnZVNlcUlkLm5l\nd0J1aWxkZXIoKS5zZXRMb2NhbENvbXBvbmVudChtc2dJZCkuYnVpbGQoKTsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIu\nY29uc3VtZSh0b3BpYywgc3ViSWQsIGNvbnN1bWVJZCk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBTeXN0\nZW0uZXJyLnByaW50bG4oIkNPTlNVTUVUTyBGQUlMRUQiKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAg\nICAgCiAgICB9CiAgICAKICAgIGNsYXNzIENvbnN1bWVDbWQgaW1wbGVtZW50\ncyBNeUNvbW1hbmQgewoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBydW5DbWQoU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IDQpIHsKICAg\nICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBsb25nIGxhc3RDb25zdW1lZElkID0gMDsKICAgICAgICAgICAg\nU3Vic2NyaXB0aW9uRGF0YSBzdWJEYXRhID0gYWRtaW4uZ2V0U3Vic2NyaXB0\naW9uKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KGFyZ3NbMV0pLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoYXJnc1syXSkpOwog\nICAgICAgICAgICBpZiAobnVsbCA9PSBzdWJEYXRhKSB7CiAgICAgICAgICAg\nICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIkZhaWxlZCB0byByZWFkIHN1YnNj\ncmlwdGlvbiBmb3IgdG9waWM6ICIgKyBhcmdzWzFdCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVyOiAiICsgYXJnc1sy\nXSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBsYXN0Q29uc3VtZWRJZCA9IHN1YkRhdGEuZ2V0U3Rh\ndGUoKS5nZXRNc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCk7CiAgICAgICAg\nICAgIGxvbmcgbnVtTWVzc2FnZXNUb0NvbnN1bWUgPSBMb25nLnBhcnNlTG9u\nZyhhcmdzWzNdKTsKICAgICAgICAgICAgbG9uZyBpZFRvQ29uc3VtZWQgPSBs\nYXN0Q29uc3VtZWRJZCArIG51bU1lc3NhZ2VzVG9Db25zdW1lOwogICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlRyeSB0byBtb3ZlIHN1YnNjcmli\nZXIoIiArIGFyZ3NbMl0gKyAiKSBjb25zdW1lIHB0ciBvZiB0b3BpYygiICsg\nYXJnc1sxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIikgZnJv\nbSAiICsgbGFzdENvbnN1bWVkSWQgKyAiIHRvICIgKyBpZFRvQ29uc3VtZWQp\nOwogICAgICAgICAgICBNZXNzYWdlU2VxSWQgY29uc3VtZUlkID0gTWVzc2Fn\nZVNlcUlkLm5ld0J1aWxkZXIoKS5zZXRMb2NhbENvbXBvbmVudChpZFRvQ29u\nc3VtZWQpLmJ1aWxkKCk7CiAgICAgICAgICAgIEJ5dGVTdHJpbmcgdG9waWMg\nPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOChhcmdzWzFdKTsKICAgICAgICAg\nICAgQnl0ZVN0cmluZyBzdWJJZCA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKGFyZ3NbMl0pOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nc3Vic2NyaWJlci5jb25zdW1lKHRvcGljLCBzdWJJZCwgY29uc3VtZUlkKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiQ09OU1VNRSBGQUlMRUQiKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICB9CiAgICAgICAgCiAgICB9CgogICAgY2xhc3MgUHViU3ViQ21kIGltcGxl\nbWVudHMgTXlDb21tYW5kIHsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gcnVuQ21kKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCA1KSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgZmluYWwgbG9uZyBzdGFydFRpbWUgPSBNYXRoVXRpbHMu\nbm93KCk7CgogICAgICAgICAgICBmaW5hbCBCeXRlU3RyaW5nIHRvcGljID0g\nQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoYXJnc1sxXSk7CiAgICAgICAgICAg\nIGZpbmFsIEJ5dGVTdHJpbmcgc3ViSWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9t\nVXRmOChhcmdzWzJdICsgIi0iICsgc3RhcnRUaW1lKTsKICAgICAgICAgICAg\naW50IHRpbWVvdXRTZWNzID0gNjA7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICB0aW1lb3V0U2VjcyA9IEludGVnZXIucGFyc2VJbnQoYXJn\nc1szXSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2Vw\ndGlvbiBuZmUpIHsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgU3RyaW5n\nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgICAg\nIGZvciAoaW50IGk9NDsgaTxhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgICAgICBzYi5hcHBlbmQoYXJnc1tpXSk7CiAgICAgICAgICAgICAgICBp\nZiAoaSAhPSBhcmdzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICAgICAg\nICBzYi5hcHBlbmQoJyAnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgICAgICAvLyBhcHBlbmQgYSB0aW1lc3RhbXAgdGFnCiAg\nICAgICAgICAgIEJ5dGVTdHJpbmcgbXNnQm9keSA9IEJ5dGVTdHJpbmcuY29w\neUZyb21VdGY4KHNiLnRvU3RyaW5nKCkgKyAiLSIgKyBzdGFydFRpbWUpOwog\nICAgICAgICAgICBmaW5hbCBNZXNzYWdlIG1zZyA9IE1lc3NhZ2UubmV3QnVp\nbGRlcigpLnNldEJvZHkobXNnQm9keSkuYnVpbGQoKTsKCiAgICAgICAgICAg\nIGJvb2xlYW4gc3Vic2NyaWJlZCA9IGZhbHNlOwogICAgICAgICAgICBib29s\nZWFuIHN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICAgICAgZmluYWwgQ291bnRE\nb3duTGF0Y2ggaXNEb25lID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAg\nICAgICAgICBsb25nIGVsYXBzZWRUaW1lID0gMEw7CgogICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIlN0YXJ0aW5nIFBVQlNVQiB0ZXN0IC4uLiIp\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gc3ViIHRo\nZSB0b3BpYwogICAgICAgICAgICAgICAgU3Vic2NyaXB0aW9uT3B0aW9ucyBv\ncHRzID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVyKCkKICAgICAg\nICAgICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRh\nY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICAgICAgICAg\nIHN1YnNjcmliZXIuc3Vic2NyaWJlKHRvcGljLCBzdWJJZCwgb3B0cyk7CiAg\nICAgICAgICAgICAgICBzdWJzY3JpYmVkID0gdHJ1ZTsKCiAgICAgICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlN1YiB0b3BpYyAiICsgdG9waWMu\ndG9TdHJpbmdVdGY4KCkgKyAiLCBzdWJzY3JpYmVyIGlkICIgKyBzdWJJZC50\nb1N0cmluZ1V0ZjgoKSk7CgogICAgICAgICAgICAgICAgCgogICAgICAgICAg\nICAgICAgLy8gcHViIHRvcGljCiAgICAgICAgICAgICAgICBwdWJsaXNoZXIu\ncHVibGlzaCh0b3BpYywgbXNnKTsKICAgICAgICAgICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbigiUHViIHRvcGljICIgKyB0b3BpYy50b1N0cmluZ1V0Zjgo\nKSArICIgOiAiICsgbXNnLmdldEJvZHkoKS50b1N0cmluZ1V0ZjgoKSk7Cgog\nICAgICAgICAgICAgICAgLy8gZW5zdXJlIHN1YnNjcmliZXIgZmlyc3QsIHB1\nYmxpc2ggbmV4dCwgdGhlbiB3ZSBzdGFydCBkZWxpdmVyeSB0byByZWNlaXZl\nIG1lc3NhZ2UKICAgICAgICAgICAgICAgIC8vIGlmIHN0YXJ0IGRlbGl2ZXJ5\nIGZpcnN0IGJlZm9yZSBwdWJsaXNoLCBpc0RvbmUgbWF5IG5vdGlmeSBiZWZv\ncmUgd2FpdAogICAgICAgICAgICAgICAgc3Vic2NyaWJlci5zdGFydERlbGl2\nZXJ5KHRvcGljLCBzdWJJZCwgbmV3IE1lc3NhZ2VIYW5kbGVyKCkgewoKICAg\nICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBkZWxpdmVyKEJ5dGVTdHJpbmcgdGhpc1RvcGljLCBC\neXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIE1lc3NhZ2UgbWVzc2FnZSwgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJh\nY2ssIE9iamVjdCBjb250ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmICh0aGlzVG9waWMuZXF1YWxzKHRvcGljKSAmJiBzdWJzY3JpYmVySWQu\nZXF1YWxzKHN1YklkKSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbXNnLmdldEJvZHkoKS5lcXVhbHMobWVzc2FnZS5nZXRCb2R5KCkpKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nIlJlY2VpdmVkIG1lc3NhZ2UgOiAiICsgbWVzc2FnZS5nZXRCb2R5KCkudG9T\ndHJpbmdVdGY4KCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNE\nb25lLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlz\naGVkKGNvbnRleHQsIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAvLyB3YWl0IGZv\nciB0aGUgbWVzc2FnZQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGlzRG9u\nZS5hd2FpdCh0aW1lb3V0U2VjcywgVGltZVVuaXQuU0VDT05EUyk7CiAgICAg\nICAgICAgICAgICBlbGFwc2VkVGltZSA9IE1hdGhVdGlscy5ub3coKSAtIHN0\nYXJ0VGltZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmliZWQp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5zdG9wRGVs\naXZlcnkodG9waWMsIHN1YklkKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nc3Vic2NyaWJlci51bnN1YnNjcmliZSh0b3BpYywgc3ViSWQpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJQVUJTVUIgU1VDQ0VT\nUy4gVElNRTogIiArIGVsYXBzZWRUaW1lICsgIiBNUyIpOwogICAgICAgICAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigiUFVCU1VCIEZBSUxFRC4gIik7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWNj\nZXNzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgIH0KICAgIAogICAgY2xhc3MgUmVhZFRvcGljQ21kIGltcGxlbWVu\ndHMgTXlDb21tYW5kIHsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gcnVuQ21kKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgUmVhZFRvcGljIHJ0OwogICAgICAgICAgICBCeXRlU3RyaW5n\nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoYXJnc1sxXSk7CiAg\nICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAyKSB7CiAgICAgICAgICAg\nICAgICBydCA9IG5ldyBSZWFkVG9waWMoYWRtaW4sIHRvcGljLCBpbkNvbnNv\nbGUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcnQg\nPSBuZXcgUmVhZFRvcGljKGFkbWluLCB0b3BpYywgTG9uZy5wYXJzZUxvbmco\nYXJnc1syXSksIGluQ29uc29sZSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgcnQucmVhZFRvcGljKCk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIH0KICAgICAgICAKICAgIH0KCiAgICBjbGFzcyBTaG93Q21kIGlt\ncGxlbWVudHMgTXlDb21tYW5kIHsKCiAgICAgICAgc3RhdGljIGZpbmFsIGlu\ndCBNQVhfVE9QSUNTX1BFUl9TSE9XID0gMTAwOwoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgYm9vbGVhbiBydW5DbWQoU3RyaW5nW10gYXJn\ncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChhcmdzLmxl\nbmd0aCA8IDIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICAgICAgfQogICAgICAgICAgICBTdHJpbmcgZXJyb3JNc2cgPSBudWxs\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKEhlZHdp\nZ0NvbW1hbmRzLlNIT1dfSFVCUy5lcXVhbHMoYXJnc1sxXSkpIHsKICAgICAg\nICAgICAgICAgICAgICBlcnJvck1zZyA9ICJVbmFibGUgdG8gZmV0Y2ggdGhl\nIGxpc3Qgb2YgaHViIHNlcnZlcnMiOwogICAgICAgICAgICAgICAgICAgIHNo\nb3dIdWJzKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEhlZHdpZ0Nv\nbW1hbmRzLlNIT1dfVE9QSUNTLmVxdWFscyhhcmdzWzFdKSkgewogICAgICAg\nICAgICAgICAgICAgIGVycm9yTXNnID0gIlVuYWJsZSB0byBmZXRjaCB0aGUg\nbGlzdCBvZiB0b3BpY3MiOwogICAgICAgICAgICAgICAgICAgIHNob3dUb3Bp\nY3MoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJFUlJPUjogVW5rbm93biBzaG93\nIGNvbW1hbmQgJyIgKyBhcmdzWzFdICsgIiciKTsKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBp\nZiAobnVsbCAhPSBlcnJvck1zZykgewogICAgICAgICAgICAgICAgICAgIFN5\nc3RlbS5lcnIucHJpbnRsbihlcnJvck1zZyk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAg\nICAgICAgcHJvdGVjdGVkIHZvaWQgc2hvd0h1YnMoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICAgICAgTWFwPEhlZHdpZ1NvY2tldEFkZHJlc3MsIEhl\nZHdpZ0FkbWluLkh1YlN0YXRzPiBodWJzID0gYWRtaW4uZ2V0QXZhaWxhYmxl\nSHVicygpOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkF2YWls\nYWJsZSBIdWIgU2VydmVyczoiKTsKICAgICAgICAgICAgZm9yIChNYXAuRW50\ncnk8SGVkd2lnU29ja2V0QWRkcmVzcywgSGVkd2lnQWRtaW4uSHViU3RhdHM+\nIGVudHJ5IDogaHVicy5lbnRyeVNldCgpKSB7CiAgICAgICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIlx0IiArIGVudHJ5LmdldEtleSgpICsgIiA6\nXHQiICsgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIHByb3RlY3RlZCB2b2lkIHNob3dUb3BpY3MoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgTGlzdDxTdHJpbmc+IHRvcGlj\ncyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAgICAgICBJdGVy\nYXRvcjxCeXRlU3RyaW5nPiBpdGVyID0gYWRtaW4uZ2V0VG9waWNzKCk7Cgog\nICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlRvcGljIExpc3Q6Iik7\nCiAgICAgICAgICAgIGJvb2xlYW4gc3RvcCA9IGZhbHNlOwogICAgICAgICAg\nICB3aGlsZSAoaXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgIGlm\nICh0b3BpY3Muc2l6ZSgpID49IE1BWF9UT1BJQ1NfUEVSX1NIT1cpIHsKICAg\nICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4odG9waWNzKTsK\nICAgICAgICAgICAgICAgICAgICB0b3BpY3MuY2xlYXIoKTsKICAgICAgICAg\nICAgICAgICAgICBzdG9wID0gIWNvbnRpbnVlT3JRdWl0KCk7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKHN0b3ApIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgQnl0ZVN0cmluZyB0ID0gaXRlci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICB0b3BpY3MuYWRkKHQudG9TdHJpbmdVdGY4\nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghc3RvcCkgewog\nICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKHRvcGljcyk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIAogICAgICAgIAogICAg\nfQoKICAgIGNsYXNzIERlc2NyaWJlQ21kIGltcGxlbWVudHMgTXlDb21tYW5k\nIHsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4g\ncnVuQ21kKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAzKSB7CiAgICAgICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKEhlZHdpZ0NvbW1hbmRzLkRFU0NSSUJFX1RPUElDLmVxdWFscyhhcmdzWzFd\nKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGRlc2NyaWJlVG9waWMoYXJn\nc1syXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIHByb3RlY3RlZCBib29sZWFuIGRlc2NyaWJlVG9waWMoU3RyaW5nIHRvcGlj\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgQnl0ZVN0cmluZyBi\ndG9waWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCh0b3BpYyk7CiAgICAg\nICAgICAgIEh1YkluZm8gb3duZXIgPSBhZG1pbi5nZXRUb3BpY093bmVyKGJ0\nb3BpYyk7CiAgICAgICAgICAgIExpc3Q8TGVkZ2VyUmFuZ2U+IHJhbmdlcyA9\nIGFkbWluLmdldFRvcGljTGVkZ2VycyhidG9waWMpOwogICAgICAgICAgICBN\nYXA8Qnl0ZVN0cmluZywgU3Vic2NyaXB0aW9uRGF0YT4gc3RhdGVzID0gYWRt\naW4uZ2V0VG9waWNTdWJzY3JpcHRpb25zKGJ0b3BpYyk7CgogICAgICAgICAg\nICBTeXN0ZW0ub3V0LnByaW50bG4oIj09PT09IFRvcGljIEluZm9ybWF0aW9u\nIDogIiArIHRvcGljICsgIiA9PT09PSIpOwogICAgICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oKTsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCJPd25lciA6ICIgKyAob3duZXIgPT0gbnVsbCA/ICJOVUxMIiA6CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBvd25lci50b1N0cmluZygpLnRy\naW0oKS5yZXBsYWNlQWxsKCJcbiIsICIsICIpKSk7CiAgICAgICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigpOwoKICAgICAgICAgICAgLy8gcHJpbnQgbGVk\nZ2VycwogICAgICAgICAgICBwcmludFRvcGljTGVkZ2VycyhyYW5nZXMpOwog\nICAgICAgICAgICAvLyBwcmludCBzdWJzY3JpcHRpb25zCiAgICAgICAgICAg\nIHByaW50VG9waWNTdWJzY3JpcHRpb25zKHN0YXRlcyk7CgogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUgdm9p\nZCBwcmludFRvcGljTGVkZ2VycyhMaXN0PExlZGdlclJhbmdlPiByYW5nZXMp\nIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCI+Pj4gUGVyc2lz\ndGVuY2UgSW5mbyA8PDwiKTsKICAgICAgICAgICAgaWYgKG51bGwgPT0gcmFu\nZ2VzKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk4v\nQSIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGlmIChyYW5nZXMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk5vIExlZGdlciB1c2VkLiIpOwog\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGZvciAoTGVkZ2VyUmFuZ2UgcmFuZ2UgOiByYW5nZXMpIHsKICAgICAg\nICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTGVkZ2VyICIgKyByYW5n\nZS5nZXRMZWRnZXJJZCgpICsgIiBbICIKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICArIHJhbmdlLmdldFN0YXJ0U2VxSWRJbmNsdWRlZCgp\nICsgIiB+ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr\nIHJhbmdlLmdldEVuZFNlcUlkSW5jbHVkZWQoKS5nZXRMb2NhbENvbXBvbmVu\ndCgpICsgIiBdIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3lzdGVt\nLm91dC5wcmludGxuKCk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZv\naWQgcHJpbnRUb3BpY1N1YnNjcmlwdGlvbnMoTWFwPEJ5dGVTdHJpbmcsIFN1\nYnNjcmlwdGlvbkRhdGE+IHN0YXRlcykgewogICAgICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oIj4+PiBTdWJzY3JpcHRpb24gSW5mbyA8PDwiKTsKICAg\nICAgICAgICAgaWYgKDAgPT0gc3RhdGVzLnNpemUoKSkgewogICAgICAgICAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJObyBzdWJzY3JpYmVyLiIpOwog\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGZvciAoTWFwLkVudHJ5PEJ5dGVTdHJpbmcsIFN1YnNjcmlwdGlvbkRh\ndGE+IGVudHJ5IDogc3RhdGVzLmVudHJ5U2V0KCkpIHsKICAgICAgICAgICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbigiU3Vic2NyaWJlciAiICsgZW50cnku\nZ2V0S2V5KCkudG9TdHJpbmdVdGY4KCkgKyAiIDogIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIFN1YnNjcmlwdGlvblN0YXRlVXRpbHMu\ndG9TdHJpbmcoZW50cnkuZ2V0VmFsdWUoKSkpOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigpOwogICAgICAgIH0KCiAg\nICB9CgogICAgY2xhc3MgRm9ybWF0Q21kIGltcGxlbWVudHMgTXlDb21tYW5k\nIHsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4g\ncnVuQ21kKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgICAgICBib29sZWFuIGZvcmNlID0gZmFsc2U7CiAgICAgICAgICAgIGlm\nIChhcmdzLmxlbmd0aCA+PSAyICYmICItZm9yY2UiLmVxdWFscyhhcmdzWzFd\nKSkgewogICAgICAgICAgICAgICAgZm9yY2UgPSB0cnVlOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGJvb2xlYW4gZG9Gb3JtYXQgPSB0cnVlOwogICAg\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIllvdSBhc2sgdG8gZm9ybWF0\nIGhlZHdpZyBtZXRhZGF0YSBzdG9yZWQgaW4gIgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyBhZG1pbi5nZXRNZXRhZGF0YU1hbmFnZXJGYWN0\nb3J5KCkuZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiLiIpOwogICAgICAgICAg\nICBpZiAoIWZvcmNlKSB7CiAgICAgICAgICAgICAgICBkb0Zvcm1hdCA9IGNv\nbnRpbnVlT3JRdWl0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKGRvRm9ybWF0KSB7CiAgICAgICAgICAgICAgICBhZG1pbi5mb3JtYXQoKTsK\nICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiRm9ybWF0dGVk\nIGhlZHdpZyBtZXRhZGF0YSBzdWNjZXNzZnVsbHkuIik7CiAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nIkdpdmVuIHVwIGZvcm1hdHRpbmcgaGVkd2lnIG1ldGFkYXRhLiIpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nCiAgICB9CgogICAgcHJvdGVjdGVkIE1hcDxTdHJpbmcsIE15Q29tbWFuZD4g\nYnVpbGRNeUNvbW1hbmRzKCkgewogICAgICAgIE1hcDxTdHJpbmcsIE15Q29t\nbWFuZD4gY21kcyA9CiAgICAgICAgICAgICAgICBuZXcgSGFzaE1hcDxTdHJp\nbmcsIE15Q29tbWFuZD4oKTsKCiAgICAgICAgRXhpdENtZCBleGl0Q21kID0g\nbmV3IEV4aXRDbWQoKTsKICAgICAgICBjbWRzLnB1dChFWElULCBleGl0Q21k\nKTsKICAgICAgICBjbWRzLnB1dChRVUlULCBleGl0Q21kKTsKICAgICAgICBj\nbWRzLnB1dChIRUxQLCBuZXcgSGVscENtZCgpKTsKICAgICAgICBjbWRzLnB1\ndChISVNUT1JZLCBuZXcgSGlzdG9yeUNtZCgpKTsKICAgICAgICBjbWRzLnB1\ndChSRURPLCBuZXcgUmVkb0NtZCgpKTsKICAgICAgICBjbWRzLnB1dChTRVQs\nIG5ldyBTZXRDbWQoKSk7CiAgICAgICAgY21kcy5wdXQoUFVCLCBuZXcgUHVi\nQ21kKCkpOwogICAgICAgIGNtZHMucHV0KFNVQiwgbmV3IFN1YkNtZCgpKTsK\nICAgICAgICBjbWRzLnB1dChQVUJTVUIsIG5ldyBQdWJTdWJDbWQoKSk7CiAg\nICAgICAgY21kcy5wdXQoQ0xPU0VTVUIsIG5ldyBDbG9zZVN1YnNjcmlwdGlv\nbkNtZCgpKTsKICAgICAgICBjbWRzLnB1dChVTlNVQiwgbmV3IFVuc3ViQ21k\nKCkpOwogICAgICAgIGNtZHMucHV0KFJNU1VCLCBuZXcgUm1zdWJDbWQoKSk7\nCiAgICAgICAgY21kcy5wdXQoQ09OU1VNRSwgbmV3IENvbnN1bWVDbWQoKSk7\nCiAgICAgICAgY21kcy5wdXQoQ09OU1VNRVRPLCBuZXcgQ29uc3VtZVRvQ21k\nKCkpOwogICAgICAgIGNtZHMucHV0KFNIT1csIG5ldyBTaG93Q21kKCkpOwog\nICAgICAgIGNtZHMucHV0KERFU0NSSUJFLCBuZXcgRGVzY3JpYmVDbWQoKSk7\nCiAgICAgICAgY21kcy5wdXQoUkVBRFRPUElDLCBuZXcgUmVhZFRvcGljQ21k\nKCkpOwogICAgICAgIGNtZHMucHV0KEZPUk1BVCwgbmV3IEZvcm1hdENtZCgp\nKTsKCiAgICAgICAgcmV0dXJuIGNtZHM7CiAgICB9CgogICAgc3RhdGljIHZv\naWQgdXNhZ2UoKSB7CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJIZWR3\naWdDb25zb2xlIFtvcHRpb25zXSBbY29tbWFuZF0gW2FyZ3NdIik7CiAgICAg\nICAgU3lzdGVtLmVyci5wcmludGxuKCk7CiAgICAgICAgU3lzdGVtLmVyci5w\ncmludGxuKCJBdmFpYWJsZSBjb21tYW5kczoiKTsKICAgICAgICBmb3IgKFN0\ncmluZyBjbWQgOiBnZXRIZWR3aWdDb21tYW5kcygpLmtleVNldCgpKSB7CiAg\nICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiXHQiICsgY21kKTsKICAg\nICAgICB9CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBIHN0b3JhZ2UgY2xhc3MgZm9yIGJvdGggY29tbWFu\nZCBsaW5lIG9wdGlvbnMgYW5kIHNoZWxsIGNvbW1hbmRzLgogICAgICovCiAg\nICBzdGF0aWMgcHJpdmF0ZSBjbGFzcyBNeUNvbW1hbmRPcHRpb25zIHsKCiAg\nICAgICAgcHJpdmF0ZSBNYXA8U3RyaW5nLFN0cmluZz4gb3B0aW9ucyA9IG5l\ndyBIYXNoTWFwPFN0cmluZyxTdHJpbmc+KCk7CiAgICAgICAgcHJpdmF0ZSBM\naXN0PFN0cmluZz4gY21kQXJncyA9IG51bGw7CiAgICAgICAgcHJpdmF0ZSBT\ndHJpbmcgY29tbWFuZCA9IG51bGw7CgogICAgICAgIHB1YmxpYyBNeUNvbW1h\nbmRPcHRpb25zKCkgewogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmlu\nZyBnZXRPcHRpb24oU3RyaW5nIG9wdCkgewogICAgICAgICAgICByZXR1cm4g\nb3B0aW9ucy5nZXQob3B0KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0Q29tbWFuZCggKSB7CiAgICAgICAgICAgIHJldHVybiBjb21t\nYW5kOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRDbWRB\ncmd1bWVudCggaW50IGluZGV4ICkgewogICAgICAgICAgICByZXR1cm4gY21k\nQXJncy5nZXQoaW5kZXgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGlu\ndCBnZXROdW1Bcmd1bWVudHMoICkgewogICAgICAgICAgICByZXR1cm4gY21k\nQXJncy5zaXplKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5n\nW10gZ2V0QXJnQXJyYXkoKSB7CiAgICAgICAgICAgIHJldHVybiBjbWRBcmdz\nLnRvQXJyYXkobmV3IFN0cmluZ1swXSk7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBQYXJzZXMgYSBjb21tYW5kIGxpbmUgdGhhdCBtYXkg\nY29udGFpbiBvbmUgb3IgbW9yZSBmbGFncwogICAgICAgICAqIGJlZm9yZSBh\nbiBvcHRpb25hbCBjb21tYW5kIHN0cmluZwogICAgICAgICAqIEBwYXJhbSBh\ncmdzIGNvbW1hbmQgbGluZSBhcmd1bWVudHMKICAgICAgICAgKiBAcmV0dXJu\nIHRydWUgaWYgcGFyc2luZyBzdWNjZWVkZWQsIGZhbHNlIG90aGVyd2lzZS4K\nICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgYm9vbGVhbiBwYXJzZU9wdGlv\nbnMoU3RyaW5nW10gYXJncykgewogICAgICAgICAgICBMaXN0PFN0cmluZz4g\nYXJnTGlzdCA9IEFycmF5cy5hc0xpc3QoYXJncyk7CiAgICAgICAgICAgIEl0\nZXJhdG9yPFN0cmluZz4gaXQgPSBhcmdMaXN0Lml0ZXJhdG9yKCk7CgogICAg\nICAgICAgICB3aGlsZSAoaXQuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAg\nICBTdHJpbmcgb3B0ID0gaXQubmV4dCgpOwogICAgICAgICAgICAgICAgaWYg\nKCFvcHQuc3RhcnRzV2l0aCgiLSIpKSB7CiAgICAgICAgICAgICAgICAgICAg\nY29tbWFuZCA9IG9wdDsKICAgICAgICAgICAgICAgICAgICBjbWRBcmdzID0g\nbmV3IEFycmF5TGlzdDxTdHJpbmc+KCApOwogICAgICAgICAgICAgICAgICAg\nIGNtZEFyZ3MuYWRkKCBjb21tYW5kICk7CiAgICAgICAgICAgICAgICAgICAg\nd2hpbGUgKGl0Lmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICBjbWRBcmdzLmFkZChpdC5uZXh0KCkpOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5wdXQob3B0LnN1YnN0cmlu\nZygxKSwgaXQubmV4dCgpKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNo\nIChOb1N1Y2hFbGVtZW50RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJFcnJvcjogbm8gYXJndW1l\nbnQgZm91bmQgZm9yIG9wdGlvbiAiCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgKyBvcHQpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogQnJlYWtzIGEgc3Ry\naW5nIGludG8gY29tbWFuZCArIGFyZ3VtZW50cy4KICAgICAgICAgKiBAcGFy\nYW0gY21kc3RyaW5nIHN0cmluZyBvZiBmb3JtICJjbWQgYXJnMSBhcmcyLi5l\ndGMiCiAgICAgICAgICogQHJldHVybiB0cnVlIGlmIHBhcnNpbmcgc3VjY2Vl\nZGVkLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBib29sZWFuIHBhcnNl\nQ29tbWFuZCggU3RyaW5nIGNtZHN0cmluZyApIHsKICAgICAgICAgICAgU3Ry\naW5nW10gYXJncyA9IGNtZHN0cmluZy5zcGxpdCgiICIpOwogICAgICAgICAg\nICBpZiAoYXJncy5sZW5ndGggPT0gMCl7CiAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29tbWFuZCA9\nIGFyZ3NbMF07CiAgICAgICAgICAgIGNtZEFyZ3MgPSBBcnJheXMuYXNMaXN0\nKGFyZ3MpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJpdmF0ZSBjbGFzcyBNeVdhdGNoZXIgaW1wbGVtZW50cyBX\nYXRjaGVyIHsKICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKFdhdGNoZWRF\ndmVudCBldmVudCkgewogICAgICAgICAgICBpZiAoZ2V0UHJpbnRXYXRjaGVz\nKCkpIHsKICAgICAgICAgICAgICAgIHByaW50TWVzc2FnZSgiV0FUQ0hFUjo6\nIik7CiAgICAgICAgICAgICAgICBwcmludE1lc3NhZ2UoZXZlbnQudG9TdHJp\nbmcoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcHJpbnRNZXNzYWdlKFN0cmluZyBtc2cpIHsKICAgICAgICBp\nZiAoaW5Db25zb2xlKSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbigiXG4iK21zZyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nSGVkd2lnIENvbnNvbGUKICAgICAqCiAgICAgKiBAcGFyYW0gYXJncyBhcmd1\nbWVudHMKICAgICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAqIEB0aHJv\nd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gCiAgICAgKi8KICAgIHB1YmxpYyBI\nZWR3aWdDb25zb2xlKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBJT0V4Y2VwdGlv\nbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIC8vIFNldHVwIFRl\ncm1pbmFsCiAgICAgICAgdGVybWluYWwgPSBUZXJtaW5hbC5zZXR1cFRlcm1p\nbmFsKCk7CiAgICAgICAgSGVkd2lnQ29tbWFuZHMuaW5pdCgpOwogICAgICAg\nIGNsLnBhcnNlT3B0aW9ucyhhcmdzKTsKCiAgICAgICAgaWYgKGNsLmdldENv\nbW1hbmQoKSA9PSBudWxsKSB7CiAgICAgICAgICAgIGluQ29uc29sZSA9IHRy\ndWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaW5Db25zb2xlID0g\nZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uIGJrQ2xpZW50Q29uZiA9CiAg\nICAgICAgICAgIG5ldyBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGll\nbnRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlv\nbiBodWJTZXJ2ZXJDb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oKTsK\nICAgICAgICBTdHJpbmcgc2VydmVyQ2ZnRmlsZSA9IGNsLmdldE9wdGlvbigi\nc2VydmVyLWNmZyIpOwogICAgICAgIGlmIChzZXJ2ZXJDZmdGaWxlICE9IG51\nbGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGh1YlNl\ncnZlckNvbmYubG9hZENvbmYobmV3IEZpbGUoc2VydmVyQ2ZnRmlsZSkudG9V\nUkkoKS50b1VSTCgpKTsKICAgICAgICAgICAgfSBjYXRjaCAoQ29uZmlndXJh\ndGlvbkV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nSU9FeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGJrQ2xpZW50Q29uZi5sb2FkQ29uZihuZXcg\nRmlsZShzZXJ2ZXJDZmdGaWxlKS50b1VSSSgpLnRvVVJMKCkpOwogICAgICAg\nICAgICB9IGNhdGNoIChDb25maWd1cmF0aW9uRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbihlKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlv\nbiBodWJDbGllbnRDZmcgPSBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpOwog\nICAgICAgIFN0cmluZyBjbGllbnRDZmdGaWxlID0gY2wuZ2V0T3B0aW9uKCJj\nbGllbnQtY2ZnIik7CiAgICAgICAgaWYgKGNsaWVudENmZ0ZpbGUgIT0gbnVs\nbCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaHViQ2xp\nZW50Q2ZnLmxvYWRDb25mKG5ldyBGaWxlKGNsaWVudENmZ0ZpbGUpLnRvVVJJ\nKCkudG9VUkwoKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKENvbmZpZ3VyYXRp\nb25FeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElP\nRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBwcmludE1lc3NhZ2UoIkNvbm5lY3RpbmcgdG8gem9va2VlcGVyL2Jvb2tr\nZWVwZXIgdXNpbmcgSGVkd2lnQWRtaW4iKTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBhZG1pbiA9IG5ldyBIZWR3aWdBZG1pbihia0NsaWVudENvbmYs\nIGh1YlNlcnZlckNvbmYpOwogICAgICAgICAgICBhZG1pbi5nZXRaa0hhbmRs\nZSgpLnJlZ2lzdGVyKG5ldyBNeVdhdGNoZXIoKSk7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhj\nZXB0aW9uKGUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwcmludE1l\nc3NhZ2UoIkNvbm5lY3RpbmcgdG8gZGVmYXVsdCBodWIgc2VydmVyICIgKyBo\ndWJDbGllbnRDZmcuZ2V0RGVmYXVsdFNlcnZlckhvc3QoKSk7CiAgICAgICAg\naHViQ2xpZW50ID0gbmV3IEhlZHdpZ0NsaWVudChodWJDbGllbnRDZmcpOwog\nICAgICAgIHB1Ymxpc2hlciA9IGh1YkNsaWVudC5nZXRQdWJsaXNoZXIoKTsK\nICAgICAgICBzdWJzY3JpYmVyID0gaHViQ2xpZW50LmdldFN1YnNjcmliZXIo\nKTsKICAgICAgICBzdWJzY3JpYmVyLmFkZFN1YnNjcmlwdGlvbkxpc3RlbmVy\nKG5ldyBDb25zb2xlU3Vic2NyaXB0aW9uTGlzdGVuZXIoKSk7CiAgICAgICAg\nCiAgICAgICAgLy8gb3RoZXIgcGFyYW1ldGVycwogICAgICAgIG15UmVnaW9u\nID0gaHViU2VydmVyQ29uZi5nZXRNeVJlZ2lvbigpOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGdldFByaW50V2F0Y2hlcygpIHsKICAgICAgICByZXR1\ncm4gcHJpbnRXYXRjaGVzOwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcg\nZ2V0UHJvbXB0KCkgewogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcg\nU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNiLmFwcGVuZCgiW2hlZHdpZzog\nKCIpLmFwcGVuZChteVJlZ2lvbikuYXBwZW5kKCIpICIpLmFwcGVuZChjb21t\nYW5kQ291bnQpLmFwcGVuZCgiXSAiKTsKICAgICAgICByZXR1cm4gc2IudG9T\ndHJpbmcoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBjb250aW51\nZU9yUXVpdCgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgU3lzdGVt\nLm91dC5wcmludGxuKCJQcmVzcyA8UmV0dXJuPiB0byBjb250aW51ZSwgb3Ig\nUSB0byBjYW5jZWwgLi4uIik7CiAgICAgICAgaW50IGNoOwogICAgICAgIGlm\nIChudWxsICE9IGNvbnNvbGUpIHsKICAgICAgICAgICAgY2ggPSBjb25zb2xl\nLnJlYWRDaGFyYWN0ZXIoQ09OVElOVUVfT1JfUVVJVCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgY2ggPSB0\nZXJtaW5hbC5yZWFkQ2hhcmFjdGVyKFN5c3RlbS5pbik7CiAgICAgICAgICAg\nIH0gd2hpbGUgKGNoICE9ICdxJyAmJiBjaCAhPSAnUScgJiYgY2ggIT0gJ1xu\nJyk7CiAgICAgICAgfQogICAgICAgIGlmIChjaCA9PSAncScgfHwKICAgICAg\nICAgICAgY2ggPT0gJ1EnKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJv\ndGVjdGVkIHZvaWQgYWRkVG9IaXN0b3J5KGludCBpLCBTdHJpbmcgY21kKSB7\nCiAgICAgICAgaGlzdG9yeS5wdXQoaSwgY21kKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBleGVjdXRlTGluZShTdHJpbmcgbGluZSkgewogICAgICAgIGlm\nICghbGluZS5lcXVhbHMoIiIpKSB7CiAgICAgICAgICAgIGNsLnBhcnNlQ29t\nbWFuZChsaW5lKTsKICAgICAgICAgICAgYWRkVG9IaXN0b3J5KGNvbW1hbmRD\nb3VudCwgbGluZSk7CiAgICAgICAgICAgIHByb2Nlc3NDbWQoY2wpOwogICAg\nICAgICAgICBjb21tYW5kQ291bnQrKzsKICAgICAgICB9CiAgICB9CgogICAg\ncHJvdGVjdGVkIGJvb2xlYW4gcHJvY2Vzc0NtZChNeUNvbW1hbmRPcHRpb25z\nIGNvKSB7CiAgICAgICAgU3RyaW5nW10gYXJncyA9IGNvLmdldEFyZ0FycmF5\nKCk7CiAgICAgICAgU3RyaW5nIGNtZCA9IGNvLmdldENvbW1hbmQoKTsKICAg\nICAgICBpZiAoYXJncy5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgIHVzYWdl\nKCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAg\nICAgaWYgKCFnZXRIZWR3aWdDb21tYW5kcygpLmNvbnRhaW5zS2V5KGNtZCkp\nIHsKICAgICAgICAgICAgdXNhZ2UoKTsKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICAgIH0KCiAgICAgICAgTE9HLmRlYnVnKCJQcm9jZXNzaW5n\nIHt9IiwgY21kKTsKCiAgICAgICAgTXlDb21tYW5kIG15Q29tbWFuZCA9IG15\nQ29tbWFuZHMuZ2V0KGNtZCk7CiAgICAgICAgaWYgKG15Q29tbWFuZCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiTm8gQ29t\nbWFuZCBQcm9jZXNzb3IgZm91bmQgZm9yIGNvbW1hbmQgIiArIGNtZCk7CiAg\nICAgICAgICAgIHVzYWdlKCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICB9CgogICAgICAgIGxvbmcgc3RhcnRUaW1lID0gTWF0aFV0aWxz\nLm5vdygpOwogICAgICAgIGJvb2xlYW4gc3VjY2VzcyA9IGZhbHNlOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHN1Y2Nlc3MgPSBteUNvbW1hbmQucnVu\nQ21kKGFyZ3MpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAgIHN1\nY2Nlc3MgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgbG9uZyBlbGFwc2Vk\nVGltZSA9IE1hdGhVdGlscy5ub3coKSAtIHN0YXJ0VGltZTsKICAgICAgICBp\nZiAoaW5Db25zb2xlKSB7CiAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7CiAg\nICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkZpbmlzaGVkICIg\nKyAoKGRvdWJsZSllbGFwc2VkVGltZSAvIDEwMDApICsgIiBzLiIpOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgQ09NTUFORCBjID0g\nZ2V0SGVkd2lnQ29tbWFuZHMoKS5nZXQoY21kKTsKICAgICAgICAgICAgICAg\nIGlmIChjICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBjLnByaW50\nVXNhZ2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXR1cm4gc3VjY2VzczsKICAgIH0KCiAgICBAU3Vw\ncHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHZvaWQgcnVuKCkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpbkNvbnNvbGUgPSB0cnVlOwog\nICAgICAgIG15Q29tbWFuZHMgPSBidWlsZE15Q29tbWFuZHMoKTsKICAgICAg\nICBpZiAoY2wuZ2V0Q29tbWFuZCgpID09IG51bGwpIHsKICAgICAgICAgICAg\nU3lzdGVtLm91dC5wcmludGxuKCJXZWxjb21lIHRvIEhlZHdpZyEiKTsKICAg\nICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJKTGluZSBzdXBwb3J0IGlz\nIGVuYWJsZWQiKTsKCiAgICAgICAgICAgIGNvbnNvbGUgPSBuZXcgQ29uc29s\nZVJlYWRlcigpOwogICAgICAgICAgICBKTGluZUhlZHdpZ0NvbXBsZXRvciBj\nb21wbGV0b3IgPSBuZXcgSkxpbmVIZWR3aWdDb21wbGV0b3IoYWRtaW4pOwog\nICAgICAgICAgICBjb25zb2xlLmFkZENvbXBsZXRvcihjb21wbGV0b3IpOwoK\nICAgICAgICAgICAgLy8gbG9hZCBoaXN0b3J5IGZpbGUKICAgICAgICAgICAg\nSGlzdG9yeSBoaXN0b3J5ID0gbmV3IEhpc3RvcnkoKTsKICAgICAgICAgICAg\nRmlsZSBmaWxlID0gbmV3IEZpbGUoU3lzdGVtLmdldFByb3BlcnR5KCJody5o\naXN0b3J5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3\nIEZpbGUoU3lzdGVtLmdldFByb3BlcnR5KCJ1c2VyLmhvbWUiKSwgSFdfSElT\nVE9SWV9GSUxFKS50b1N0cmluZygpKSk7CiAgICAgICAgICAgIGlmIChMT0cu\naXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVn\nKCJIaXN0b3J5IGZpbGUgaXMgIiArIGZpbGUudG9TdHJpbmcoKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgaGlzdG9yeS5zZXRIaXN0b3J5RmlsZShm\naWxlKTsKICAgICAgICAgICAgLy8gc2V0IGhpc3RvcnkgdG8gY29uc29sZSBy\nZWFkZXIKICAgICAgICAgICAgY29uc29sZS5zZXRIaXN0b3J5KGhpc3Rvcnkp\nOwogICAgICAgICAgICAvLyBsb2FkIGhpc3RvcnkgZnJvbSBoaXN0b3J5IGZp\nbGUKICAgICAgICAgICAgaGlzdG9yeS5tb3ZlVG9GaXJzdEVudHJ5KCk7Cgog\nICAgICAgICAgICB3aGlsZSAoaGlzdG9yeS5uZXh0KCkpIHsKICAgICAgICAg\nICAgICAgIFN0cmluZyBlbnRyeSA9IGhpc3RvcnkuY3VycmVudCgpOwogICAg\nICAgICAgICAgICAgaWYgKCFlbnRyeS5lcXVhbHMoIiIpKSB7CiAgICAgICAg\nICAgICAgICAgICAgYWRkVG9IaXN0b3J5KGNvbW1hbmRDb3VudCwgZW50cnkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29tbWFuZENv\ndW50Kys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCJKTGluZSBoaXN0b3J5IHN1cHBvcnQgaXMgZW5hYmxlZCIpOwoK\nICAgICAgICAgICAgU3RyaW5nIGxpbmU7CiAgICAgICAgICAgIHdoaWxlICgo\nbGluZSA9IGNvbnNvbGUucmVhZExpbmUoZ2V0UHJvbXB0KCkpKSAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBleGVjdXRlTGluZShsaW5lKTsKICAgICAg\nICAgICAgICAgIGhpc3RvcnkuYWRkVG9IaXN0b3J5KGxpbmUpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICBpbkNvbnNvbGUgPSBmYWxzZTsK\nICAgICAgICBwcm9jZXNzQ21kKGNsKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBteUNvbW1hbmRzLmdldChFWElUKS5ydW5DbWQobmV3IFN0cmluZ1sw\nXSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10g\nYXJncykgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiB7CiAgICAgICAgSGVkd2lnQ29uc29sZSBjb25zb2xlID0gbmV3IEhlZHdp\nZ0NvbnNvbGUoYXJncyk7CiAgICAgICAgY29uc29sZS5ydW4oKTsKICAgIH0K\nfQo=\n","encoding":"base64"}

