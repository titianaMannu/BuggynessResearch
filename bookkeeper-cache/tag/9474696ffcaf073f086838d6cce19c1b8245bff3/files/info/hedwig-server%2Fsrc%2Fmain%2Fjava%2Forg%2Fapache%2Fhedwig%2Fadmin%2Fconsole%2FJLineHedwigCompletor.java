{"sha":"cdc0c339a1917f6da3212bd40f2ead3161e8cce2","node_id":"MDQ6QmxvYjE1NzU5NTY6Y2RjMGMzMzlhMTkxN2Y2ZGEzMjEyYmQ0MGYyZWFkMzE2MWU4Y2NlMg==","size":3825,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/cdc0c339a1917f6da3212bd40f2ead3161e8cce2","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW4uY29uc29sZTsKCmltcG9y\ndCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsK\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5hZG1pbi5IZWR3aWdBZG1pbjsK\nCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CgppbXBv\ncnQgamxpbmUuQ29tcGxldG9yOwoKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hl\nLmhlZHdpZy5hZG1pbi5jb25zb2xlLkhlZHdpZ0NvbW1hbmRzLio7CgovKioK\nICogQSBqbGluZSBjb21wbGV0b3IgZm9yIGhlZHdpZyBjb25zb2xlCiAqLwpw\ndWJsaWMgY2xhc3MgSkxpbmVIZWR3aWdDb21wbGV0b3IgaW1wbGVtZW50cyBD\nb21wbGV0b3IgewogICAgLy8gZm9yIHRvcGljIGNvbXBsZXRpb24KICAgIHN0\nYXRpYyBmaW5hbCBpbnQgTUFYX1RPUElDU19UT19TRUFSQ0ggPSAxMDAwOwoK\nICAgIHByaXZhdGUgSGVkd2lnQWRtaW4gYWRtaW47CgogICAgcHVibGljIEpM\naW5lSGVkd2lnQ29tcGxldG9yKEhlZHdpZ0FkbWluIGFkbWluKSB7CiAgICAg\nICAgdGhpcy5hZG1pbiA9IGFkbWluOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIGludCBjb21wbGV0ZShTdHJpbmcgYnVmZmVyLCBpbnQgY3Vy\nc29yLCBMaXN0IGNhbmRpZGF0ZXMpIHsKICAgICAgICAvLyBHdWFyYW50ZWUg\ndGhhdCB0aGUgZmluYWwgdG9rZW4gaXMgdGhlIG9uZSB3ZSdyZSBleHBhbmRp\nbmcKICAgICAgICBidWZmZXIgPSBidWZmZXIuc3Vic3RyaW5nKDAsY3Vyc29y\nKTsKICAgICAgICBTdHJpbmdbXSB0b2tlbnMgPSBidWZmZXIuc3BsaXQoIiAi\nKTsKICAgICAgICBpZiAoYnVmZmVyLmVuZHNXaXRoKCIgIikpIHsKICAgICAg\nICAgICAgU3RyaW5nW10gbmV3VG9rZW5zID0gbmV3IFN0cmluZ1t0b2tlbnMu\nbGVuZ3RoICsgMV07CiAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkodG9r\nZW5zLCAwLCBuZXdUb2tlbnMsIDAsIHRva2Vucy5sZW5ndGgpOwogICAgICAg\nICAgICBuZXdUb2tlbnNbbmV3VG9rZW5zLmxlbmd0aCAtIDFdID0gIiI7CiAg\nICAgICAgICAgIHRva2VucyA9IG5ld1Rva2VuczsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgaWYgKHRva2Vucy5sZW5ndGggPiAyICYmCiAgICAgICAg\nICAgIERFU0NSSUJFLmVxdWFsc0lnbm9yZUNhc2UodG9rZW5zWzBdKSAmJgog\nICAgICAgICAgICBERVNDUklCRV9UT1BJQy5lcXVhbHNJZ25vcmVDYXNlKHRv\na2Vuc1sxXSkpIHsKICAgICAgICAgICAgcmV0dXJuIGNvbXBsZXRlVG9waWMo\nYnVmZmVyLCB0b2tlbnNbMl0sIGNhbmRpZGF0ZXMpOwogICAgICAgIH0gZWxz\nZSBpZiAodG9rZW5zLmxlbmd0aCA+IDEgJiYKICAgICAgICAgICAgICAgICAg\nIChTVUIuZXF1YWxzSWdub3JlQ2FzZSh0b2tlbnNbMF0pIHx8CiAgICAgICAg\nICAgICAgICAgICAgUFVCLmVxdWFsc0lnbm9yZUNhc2UodG9rZW5zWzBdKSB8\nfAogICAgICAgICAgICAgICAgICAgIENMT1NFU1VCLmVxdWFsc0lnbm9yZUNh\nc2UodG9rZW5zWzBdKSB8fAogICAgICAgICAgICAgICAgICAgIENPTlNVTUUu\nZXF1YWxzSWdub3JlQ2FzZSh0b2tlbnNbMF0pIHx8CiAgICAgICAgICAgICAg\nICAgICAgQ09OU1VNRVRPLmVxdWFsc0lnbm9yZUNhc2UodG9rZW5zWzBdKSB8\nfAogICAgICAgICAgICAgICAgICAgIFJFQURUT1BJQy5lcXVhbHNJZ25vcmVD\nYXNlKHRva2Vuc1swXSkpKSB7CiAgICAgICAgICAgIHJldHVybiBjb21wbGV0\nZVRvcGljKGJ1ZmZlciwgdG9rZW5zWzFdLCBjYW5kaWRhdGVzKTsKICAgICAg\nICB9CiAgICAgICAgTGlzdCBjbWRzID0gSGVkd2lnQ29tbWFuZHMuZmluZENh\nbmRpZGF0ZUNvbW1hbmRzKHRva2Vucyk7CiAgICAgICAgcmV0dXJuIGNvbXBs\nZXRlQ29tbWFuZChidWZmZXIsIHRva2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV0s\nIGNtZHMsIGNhbmRpZGF0ZXMpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5p\nbmdzKCJ1bmNoZWNrZWQiKQogICAgcHJpdmF0ZSBpbnQgY29tcGxldGVDb21t\nYW5kKFN0cmluZyBidWZmZXIsIFN0cmluZyB0b2tlbiwKICAgICAgICAgICAg\nTGlzdCBjb21tYW5kcywgTGlzdCBjYW5kaWRhdGVzKSB7CiAgICAgICAgZm9y\nIChPYmplY3QgY21kbyA6IGNvbW1hbmRzKSB7CiAgICAgICAgICAgIGFzc2Vy\ndCAoY21kbyBpbnN0YW5jZW9mIFN0cmluZyk7CiAgICAgICAgICAgIGlmICgo\nKFN0cmluZyljbWRvKS5zdGFydHNXaXRoKHRva2VuKSkgewogICAgICAgICAg\nICAgICAgY2FuZGlkYXRlcy5hZGQoY21kbyk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGJ1ZmZlci5sYXN0SW5kZXhPZigiICIp\nICsgMTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2Vk\nIikKICAgIHByaXZhdGUgaW50IGNvbXBsZXRlVG9waWMoU3RyaW5nIGJ1ZmZl\nciwgU3RyaW5nIHRva2VuLCBMaXN0IGNhbmRpZGF0ZXMpIHsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBJdGVyYXRvcjxCeXRlU3RyaW5nPiBjaGlsZHJl\nbiA9IGFkbWluLmdldFRvcGljcygpOwogICAgICAgICAgICBpbnQgaSA9IDA7\nCiAgICAgICAgICAgIHdoaWxlIChjaGlsZHJlbi5oYXNOZXh0KCkgJiYgaSA8\nPSBNQVhfVE9QSUNTX1RPX1NFQVJDSCkgewogICAgICAgICAgICAgICAgU3Ry\naW5nIGNoaWxkID0gY2hpbGRyZW4ubmV4dCgpLnRvU3RyaW5nVXRmOCgpOwog\nICAgICAgICAgICAgICAgaWYgKGNoaWxkLnN0YXJ0c1dpdGgodG9rZW4pKSB7\nCiAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlcy5hZGQoY2hpbGQpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKytpOwogICAgICAg\nICAgICB9CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgcmV0dXJuIGJ1ZmZlci5sZW5ndGgoKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGNhbmRpZGF0ZXMuc2l6ZSgpID09IDAgPyBidWZmZXIubGVu\nZ3RoKCkgOiBidWZmZXIubGFzdEluZGV4T2YoIiAiKSArIDE7CiAgICB9Cn0K\n","encoding":"base64"}

