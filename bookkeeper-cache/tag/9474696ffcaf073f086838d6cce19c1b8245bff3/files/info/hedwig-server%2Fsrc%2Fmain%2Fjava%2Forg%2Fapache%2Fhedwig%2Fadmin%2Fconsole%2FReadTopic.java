{"sha":"edad190bd2860efa94e89f0b740255d28d9ec191","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWRhZDE5MGJkMjg2MGVmYTk0ZTg5ZjBiNzQwMjU1ZDI4ZDllYzE5MQ==","size":12053,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/edad190bd2860efa94e89f0b740255d28d9ec191","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW4uY29uc29sZTsKCmltcG9y\ndCBqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5pby5JT0V4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW1SZWFkZXI7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkVu\ndW1lcmF0aW9uOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQg\namF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVw\nZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmFkbWluLkhlZHdpZ0FkbWluOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTGVkZ2VyUmFuZ2U7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5M\nZWRnZXJSYW5nZXM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuUmVnaW9uU3BlY2lmaWNTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbkRhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5kYXRhLlN0YXQ7CgppbXBvcnQgc3Rh\ndGljIGNvbS5nb29nbGUuY29tbW9uLmJhc2UuQ2hhcnNldHMuVVRGXzg7Cmlt\ncG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2Vw\ndGlvbjsKCi8qKgogKiBBIHRvb2wgdG8gcmVhZCB0b3BpYyBtZXNzYWdlcy4K\nICoKICogVGhpcyB0b29sIDoKICogMSkgcmVhZCBwZXJzaXN0ZW5jZSBpbmZv\nIGZyb20gem9va2VlcGVyOiBsZWRnZXIgcmFuZ2VzCiAqIDIpIHJlYWQgc3Vi\nc2NyaXB0aW9uIGluZm9yIGZyb20gem9va2VlcGVyOiB3ZSBjYW4ga25vdyB0\naGUgbGVhc3QgbWVzc2FnZSBpZCAobGVkZ2VyIGlkKSAKICogMykgdXNlIGJr\nIGNsaWVudCB0byByZWFkIG1lc3NhZ2Ugc3RhcnRpbmcgZnJvbSBsZWFzdCBt\nZXNzYWdlIGlkCiAqLwpwdWJsaWMgY2xhc3MgUmVhZFRvcGljIHsKICAgIAog\nICAgZmluYWwgSGVkd2lnQWRtaW4gYWRtaW47CiAgICBmaW5hbCBCeXRlU3Ry\naW5nIHRvcGljOwogICAgbG9uZyBzdGFydFNlcUlkOwogICAgbG9uZyBsZWFz\ndENvbnN1bWVkU2VxSWQgPSBMb25nLk1BWF9WQUxVRTsKICAgIGZpbmFsIGJv\nb2xlYW4gaW5Db25zb2xlOwoKICAgIHN0YXRpYyBmaW5hbCBpbnQgUkNfT0sg\nPSAwOwogICAgc3RhdGljIGZpbmFsIGludCBSQ19FUlJPUiA9IC0xOwogICAg\nc3RhdGljIGZpbmFsIGludCBSQ19OT1RPUElDID0gLTI7CiAgICBzdGF0aWMg\nZmluYWwgaW50IFJDX05PTEVER0VSUyA9IC0zOwogICAgc3RhdGljIGZpbmFs\nIGludCBSQ19OT1NVQlNDUklCRVJTID0gLTQ7CiAgICAKICAgIHN0YXRpYyBm\naW5hbCBpbnQgTlVNX01FU1NBR0VTX1RPX1BSSU5UID0gMTU7CgogICAgTGlz\ndDxMZWRnZXJSYW5nZT4gbGVkZ2VycyA9IG5ldyBBcnJheUxpc3Q8TGVkZ2Vy\nUmFuZ2U+KCk7CiAgICAKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IKICAg\nICAqLwogICAgcHVibGljIFJlYWRUb3BpYyhIZWR3aWdBZG1pbiBhZG1pbiwg\nQnl0ZVN0cmluZyB0b3BpYywgYm9vbGVhbiBpbkNvbnNvbGUpIHsKICAgICAg\nICB0aGlzKGFkbWluLCB0b3BpYywgMSwgaW5Db25zb2xlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENvbnN0cnVjdG9yCiAgICAgKi8KICAgIHB1YmxpYyBS\nZWFkVG9waWMoSGVkd2lnQWRtaW4gYWRtaW4sIEJ5dGVTdHJpbmcgdG9waWMs\nIGxvbmcgbXNnU2VxSWQsIGJvb2xlYW4gaW5Db25zb2xlKSB7CiAgICAgICAg\ndGhpcy5hZG1pbiA9IGFkbWluOwogICAgICAgIHRoaXMudG9waWMgPSB0b3Bp\nYzsKICAgICAgICB0aGlzLnN0YXJ0U2VxSWQgPSBtc2dTZXFJZDsKICAgICAg\nICB0aGlzLmluQ29uc29sZSA9IGluQ29uc29sZTsKICAgIH0KICAgIAogICAg\nLyoqCiAgICAgKiBDaGVjayB3aGV0aGVyIHRoZSB0b3BpYyBleGlzdGVkIG9y\nIG5vdAogICAgICoKICAgICAqIEByZXR1cm4gUkNfT0sgaWYgdG9waWMgaXMg\nZXhpc3RlZDsgUkNfTk9UT1BJQyBpZiBub3QuCiAgICAgKiBAdGhyb3dzIEV4\nY2VwdGlvbgogICAgICovCiAgICBwcm90ZWN0ZWQgaW50IGNoZWNrVG9waWMo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gYWRtaW4uaGFz\nVG9waWModG9waWMpID8gUkNfT0sgOiBSQ19OT1RPUElDOwogICAgfQogICAg\nCiAgICAvKioKICAgICAqIEdldCB0aGUgbGVkZ2VycyB1c2VkIGJ5IHRoaXMg\ndG9waWMgdG8gc3RvcmUgbWVzc2FnZXMKICAgICAqCiAgICAgKiBAcmV0dXJu\nIFJDX09LIGlmIHRvcGljIGhhcyBtZXNzYWdlczsgUkNfTk9MRURHRVJTIGlm\nIG5vdC4KICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBpbnQgZ2V0VG9waWNMZWRnZXJzKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgTGlzdDxMZWRnZXJSYW5nZT4gcmFuZ2VzID0gYWRtaW4u\nZ2V0VG9waWNMZWRnZXJzKHRvcGljKTsgCiAgICAgICAgaWYgKG51bGwgPT0g\ncmFuZ2VzIHx8IHJhbmdlcy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgcmV0\ndXJuIFJDX05PTEVER0VSUzsKICAgICAgICB9CiAgICAgICAgbGVkZ2Vycy5h\nZGRBbGwocmFuZ2VzKTsKICAgICAgICByZXR1cm4gUkNfT0s7CiAgICB9CiAg\nICAKICAgIHByb3RlY3RlZCBpbnQgZ2V0TGVhc3RTdWJzY3JpcHRpb24oKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBNYXA8Qnl0ZVN0cmluZywgU3Vi\nc2NyaXB0aW9uRGF0YT4gc3RhdGVzID0gYWRtaW4uZ2V0VG9waWNTdWJzY3Jp\ncHRpb25zKHRvcGljKTsgCiAgICAgICAgaWYgKHN0YXRlcy5pc0VtcHR5KCkp\nIHsKICAgICAgICAgICAgcmV0dXJuIFJDX05PU1VCU0NSSUJFUlM7CiAgICAg\nICAgfQogICAgICAgIGZvciAoTWFwLkVudHJ5PEJ5dGVTdHJpbmcsIFN1YnNj\ncmlwdGlvbkRhdGE+IGVudHJ5IDogc3RhdGVzLmVudHJ5U2V0KCkpIHsKICAg\nICAgICAgICAgU3Vic2NyaXB0aW9uRGF0YSBzdGF0ZSA9IGVudHJ5LmdldFZh\nbHVlKCk7CiAgICAgICAgICAgIGxvbmcgbG9jYWxNc2dJZCA9IHN0YXRlLmdl\ndFN0YXRlKCkuZ2V0TXNnSWQoKS5nZXRMb2NhbENvbXBvbmVudCgpOwogICAg\nICAgICAgICBpZiAobG9jYWxNc2dJZCA8IGxlYXN0Q29uc3VtZWRTZXFJZCkg\newogICAgICAgICAgICAgICAgbGVhc3RDb25zdW1lZFNlcUlkID0gbG9jYWxN\nc2dJZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobGVh\nc3RDb25zdW1lZFNlcUlkID09IExvbmcuTUFYX1ZBTFVFKSB7CiAgICAgICAg\nICAgIGxlYXN0Q29uc3VtZWRTZXFJZCA9IDA7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBSQ19PSzsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgcmVh\nZFRvcGljKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGludCByYyA9\nIF9yZWFkVG9waWMoKTsKICAgICAgICAgICAgc3dpdGNoIChyYykgewogICAg\nICAgICAgICBjYXNlIFJDX05PVE9QSUM6CiAgICAgICAgICAgICAgICBTeXN0\nZW0uZXJyLnByaW50bG4oIk5vIHRvcGljICIgKyB0b3BpYyArICIgZm91bmQu\nIik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBS\nQ19OT0xFREdFUlM6CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50\nbG4oIk5vIG1lc3NhZ2UgaXMgcHVibGlzaGVkIHRvIHRvcGljICIgKyB0b3Bp\nYyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVs\ndDoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgU3lzdGVt\nLmVyci5wcmludGxuKCJFUlJPUjogcmVhZCBtZXNzYWdlcyBvZiB0b3BpYyAi\nICsgdG9waWMgKyAiIGZhaWxlZC4iKTsKICAgICAgICAgICAgZS5wcmludFN0\nYWNrVHJhY2UoKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByb3RlY3Rl\nZCBpbnQgX3JlYWRUb3BpYygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIGludCByYzsKICAgICAgICAvLyBjaGVjayB0b3BpYwogICAgICAgIHJjID0g\nY2hlY2tUb3BpYygpOwogICAgICAgIGlmIChSQ19PSyAhPSByYykgewogICAg\nICAgICAgICByZXR1cm4gcmM7CiAgICAgICAgfQogICAgICAgIC8vIGdldCB0\nb3BpYyBsZWRnZXJzCiAgICAgICAgcmMgPSBnZXRUb3BpY0xlZGdlcnMoKTsK\nICAgICAgICBpZiAoUkNfT0sgIT0gcmMpIHsKICAgICAgICAgICAgcmV0dXJu\nIHJjOwogICAgICAgIH0KICAgICAgICAvLyBnZXQgdG9waWMgc3Vic2NyaXB0\naW9uIHRvIGZpbmQgdGhlIGxlYXN0IG9uZQogICAgICAgIHJjID0gZ2V0TGVh\nc3RTdWJzY3JpcHRpb24oKTsKICAgICAgICBpZiAoUkNfTk9TVUJTQ1JJQkVS\nUyA9PSByYykgewogICAgICAgICAgICBzdGFydFNlcUlkID0gMTsKICAgICAg\nICB9IGVsc2UgaWYgKFJDX09LID09IHJjKSB7CiAgICAgICAgICAgIGlmIChs\nZWFzdENvbnN1bWVkU2VxSWQgPiBzdGFydFNlcUlkKSB7CiAgICAgICAgICAg\nICAgICBzdGFydFNlcUlkID0gbGVhc3RDb25zdW1lZFNlcUlkICsgMTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVy\nbiByYzsKICAgICAgICB9CgogICAgICAgIGZvciAoTGVkZ2VyUmFuZ2UgcmFu\nZ2UgOiBsZWRnZXJzKSB7CiAgICAgICAgICAgIGxvbmcgZW5kU2VxSWQgPSBy\nYW5nZS5nZXRFbmRTZXFJZEluY2x1ZGVkKCkuZ2V0TG9jYWxDb21wb25lbnQo\nKTsKICAgICAgICAgICAgaWYgKGVuZFNlcUlkIDwgc3RhcnRTZXFJZCkgewog\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgYm9vbGVhbiB0b0NvbnRpbnVlID0gcmVhZExlZGdlcihyYW5nZSk7\nCiAgICAgICAgICAgIHN0YXJ0U2VxSWQgPSBlbmRTZXFJZCArIDE7CiAgICAg\nICAgICAgIGlmICghdG9Db250aW51ZSkgewogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\ncmV0dXJuIFJDX09LOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJlYWQg\nYSBzcGVjaWZpYyBsZWRnZXIKICAgICAqCiAgICAgKiBAcGFyYW0gbGVkZ2Vy\nIGluIG1lbW9yeSBsZWRnZXIgcmFuZ2UKICAgICAqIEBwYXJhbSBlbmRTZXFJ\nZCBlbmQgc2VxIGlkCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgY29udGludWUs\nIG90aGVyd2lzZSBmYWxzZQogICAgICogQHRocm93cyBCS0V4Y2VwdGlvbgog\nICAgICogQHRocm93cyBJT0V4Y2VwdGlvbgogICAgICogQHRocm93cyBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVh\nbiByZWFkTGVkZ2VyKExlZGdlclJhbmdlIGxlZGdlcikKICAgIHRocm93cyBC\nS0V4Y2VwdGlvbiwgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9u\nIHsKICAgICAgICBsb25nIHRFbmRTZXFJZCA9IGxlZGdlci5nZXRFbmRTZXFJ\nZEluY2x1ZGVkKCkuZ2V0TG9jYWxDb21wb25lbnQoKTsKCiAgICAgICAgaWYg\nKHRFbmRTZXFJZCA8IHRoaXMuc3RhcnRTZXFJZCkgewogICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgLy8gT3BlbiBMZWRnZXIg\nSGFuZGxlCiAgICAgICAgbG9uZyBsZWRnZXJJZCA9IGxlZGdlci5nZXRMZWRn\nZXJJZCgpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiXG4+Pj4+PiAi\nICsgbGVkZ2VyICsgIiA8PDw8PFxuIik7CiAgICAgICAgTGVkZ2VySGFuZGxl\nIGxoID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBsaCA9IGFk\nbWluLmdldEJrSGFuZGxlKCkub3BlbkxlZGdlck5vUmVjb3ZlcnkobGVkZ2Vy\nSWQsIGFkbWluLmdldEJrRGlnZXN0VHlwZSgpLCBhZG1pbi5nZXRCa1Bhc3N3\nZCgpKTsKICAgICAgICB9IGNhdGNoIChCS0V4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiRVJST1I6IE5vIGxlZGdlciAi\nICsgbGVkZ2VySWQgKyAiIGZvdW5kLiBtYXliZSBnYXJiYWdlIGNvbGxlY3Rl\nZCBkdWUgdG8gdGhlIG1lc3NhZ2VzIGFyZSBjb25zdW1lZC4iKTsKICAgICAg\nICB9CiAgICAgICAgaWYgKG51bGwgPT0gbGgpIHsKICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGxvbmcgZXhwZWN0ZWRFbnRy\neUlkID0gc3RhcnRTZXFJZCAtIGxlZGdlci5nZXRTdGFydFNlcUlkSW5jbHVk\nZWQoKTsKICAgICAgICAKICAgICAgICBsb25nIGNvcnJlY3RlZEVuZFNlcUlk\nID0gdEVuZFNlcUlkOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdoaWxl\nIChzdGFydFNlcUlkIDw9IHRFbmRTZXFJZCkgewogICAgICAgICAgICAgICAg\nY29ycmVjdGVkRW5kU2VxSWQgPSBNYXRoLm1pbihzdGFydFNlcUlkICsgTlVN\nX01FU1NBR0VTX1RPX1BSSU5UIC0gMSwgdEVuZFNlcUlkKTsKICAgICAgICAg\nICAgICAgIAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICBFbnVtZXJhdGlvbjxMZWRnZXJFbnRyeT4gc2VxID0KICAgICAgICAg\nICAgICAgICAgICAgICAgbGgucmVhZEVudHJpZXMoc3RhcnRTZXFJZCAtIGxl\nZGdlci5nZXRTdGFydFNlcUlkSW5jbHVkZWQoKSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdGVkRW5kU2VxSWQgLSBs\nZWRnZXIuZ2V0U3RhcnRTZXFJZEluY2x1ZGVkKCkpOwogICAgICAgICAgICAg\nICAgICAgIExlZGdlckVudHJ5IGVudHJ5ID0gbnVsbDsKICAgICAgICAgICAg\nICAgICAgICB3aGlsZSAoc2VxLmhhc01vcmVFbGVtZW50cygpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGVudHJ5ID0gc2VxLm5leHRFbGVtZW50KCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgbWVzc2FnZTsKICAg\nICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG1lc3NhZ2UgPSBNZXNzYWdlLnBhcnNlRnJvbShlbnRyeS5n\nZXRFbnRyeUlucHV0U3RyZWFtKCkpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIldBUk46IFVucmVhZGFi\nbGUgbWVzc2FnZSBmb3VuZFxuIik7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBleHBlY3RlZEVudHJ5SWQrKzsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBlY3RlZEVudHJ5SWQgIT0g\nZW50cnkuZ2V0RW50cnlJZCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB8fCAobWVzc2FnZS5nZXRNc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCkg\nLSBsZWRnZXIuZ2V0U3RhcnRTZXFJZEluY2x1ZGVkKCkpICE9IGV4cGVjdGVk\nRW50cnlJZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IElPRXhjZXB0aW9uKCJFUlJPUjogTWVzc2FnZSBpZHMgYXJlIG91dCBv\nZiBvcmRlciA6IGV4cGVjdGVkIGVudHJ5IGlkICIgKyBleHBlY3RlZEVudHJ5\nSWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAiLCBjdXJyZW50IGVudHJ5IGlkICIgKyBlbnRyeS5nZXRFbnRy\neUlkKCkgKyAiLCBtc2cgc2VxIGlkICIgKyBtZXNzYWdlLmdldE1zZ0lkKCku\nZ2V0TG9jYWxDb21wb25lbnQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRFbnRyeUlkKys7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdE1lc3NhZ2UobWVzc2Fn\nZSk7CgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICBzdGFydFNlcUlkID0gY29ycmVjdGVkRW5kU2VxSWQgKyAxOwogICAgICAg\nICAgICAgICAgICAgIGlmIChpbkNvbnNvbGUpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKCFwcmVzc0tleVRvQ29udGludWUoKSkgewogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoQktFeGNlcHRpb24uQktSZWFkRXhjZXB0aW9u\nIGJlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgYmU7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChCS0V4\nY2VwdGlvbiBia2UpIHsKICAgICAgICAgICAgaWYgKHRFbmRTZXFJZCAhPSBM\nb25nLk1BWF9WQUxVRSkgewogICAgICAgICAgICAgICAgU3lzdGVtLmVyci5w\ncmludGxuKCJFUlJPUjogbGVkZ2VyICIgKyBsZWRnZXJJZCArICIgbWF5IGJl\nIGNvcnJ1cHRlZCwgc2luY2UgcmVhZCBtZXNzYWdlcyBbIgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICArIHN0YXJ0U2VxSWQgKyAiIH4gIiAr\nIGNvcnJlY3RlZEVuZFNlcUlkICsgIiBdIGZhaWxlZCA6Iik7CiAgICAgICAg\nICAgICAgICB0aHJvdyBia2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJcbiIpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQogICAgCiAgICBwcm90ZWN0ZWQgdm9pZCBmb3JtYXRN\nZXNzYWdlKE1lc3NhZ2UgbWVzc2FnZSkgewogICAgICAgIC8vIHByaW50IG1z\nZyBpZAogICAgICAgIFN0cmluZyBtc2dJZDsKICAgICAgICBpZiAoIW1lc3Nh\nZ2UuaGFzTXNnSWQoKSkgewogICAgICAgICAgICBtc2dJZCA9ICJOL0EiOwog\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIE1lc3NhZ2VTZXFJZCBzZXFJ\nZCA9IG1lc3NhZ2UuZ2V0TXNnSWQoKTsKICAgICAgICAgICAgU3RyaW5nQnVp\nbGRlciBpZEJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nICAgICBpZiAoc2VxSWQuaGFzTG9jYWxDb21wb25lbnQoKSkgewogICAgICAg\nICAgICAgICAgaWRCdWlsZGVyLmFwcGVuZCgiTE9DQUwoIikuYXBwZW5kKHNl\ncUlkLmdldExvY2FsQ29tcG9uZW50KCkpLmFwcGVuZCgiKSIpOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgTGlzdDxSZWdpb25TcGVj\naWZpY1NlcUlkPiByZW1vdGVJZHMgPSBzZXFJZC5nZXRSZW1vdGVDb21wb25l\nbnRzTGlzdCgpOwogICAgICAgICAgICAgICAgaW50IGkgPSAwLCBudW1SZWdp\nb25zID0gcmVtb3RlSWRzLnNpemUoKTsKICAgICAgICAgICAgICAgIGlkQnVp\nbGRlci5hcHBlbmQoIlJFTU9URSgiKTsKICAgICAgICAgICAgICAgIGZvciAo\nUmVnaW9uU3BlY2lmaWNTZXFJZCByc3NpZCA6IHJlbW90ZUlkcykgewogICAg\nICAgICAgICAgICAgICAgIGlkQnVpbGRlci5hcHBlbmQocnNzaWQuZ2V0UmVn\naW9uKCkudG9TdHJpbmdVdGY4KCkpOwogICAgICAgICAgICAgICAgICAgIGlk\nQnVpbGRlci5hcHBlbmQoIlsiKTsKICAgICAgICAgICAgICAgICAgICBpZEJ1\naWxkZXIuYXBwZW5kKHJzc2lkLmdldFNlcUlkKCkpOwogICAgICAgICAgICAg\nICAgICAgIGlkQnVpbGRlci5hcHBlbmQoIl0iKTsKICAgICAgICAgICAgICAg\nICAgICArK2k7CiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBudW1SZWdp\nb25zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlkQnVpbGRlci5hcHBl\nbmQoIiwiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBpZEJ1aWxkZXIuYXBwZW5kKCIpIik7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgbXNnSWQgPSBpZEJ1aWxkZXIudG9T\ndHJpbmcoKTsKICAgICAgICB9CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCItLS0tLS0tLS0tIE1TR0lEPSIgKyBtc2dJZCArICIgLS0tLS0tLS0tLSIp\nOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTXNnSWQ6ICAgICAiICsg\nbXNnSWQpOwogICAgICAgIC8vIHByaW50IHNvdXJjZSByZWdpb24KICAgICAg\nICBpZiAobWVzc2FnZS5oYXNTcmNSZWdpb24oKSkgewogICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oIlNyY1JlZ2lvbjogIiArIG1lc3NhZ2UuZ2V0\nU3JjUmVnaW9uKCkudG9TdHJpbmdVdGY4KCkpOwogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiU3JjUmVnaW9uOiBO\nL0EiKTsKICAgICAgICB9CiAgICAgICAgLy8gcHJpbnQgbWVzc2FnZSBib2R5\nCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJNZXNzYWdlOiIpOwogICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbigpOwogICAgICAgIGlmIChtZXNzYWdl\nLmhhc0JvZHkoKSkgewogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nbWVzc2FnZS5nZXRCb2R5KCkudG9TdHJpbmdVdGY4KCkpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTi9BIik7\nCiAgICAgICAgfQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigpOwogICAg\nfQogICAgCiAgICBib29sZWFuIHByZXNzS2V5VG9Db250aW51ZSgpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJQ\ncmVzcyBZIHRvIGNvbnRpbnVlLi4uIik7CiAgICAgICAgQnVmZmVyZWRSZWFk\nZXIgc3RkaW4gPSBuZXcgQnVmZmVyZWRSZWFkZXIobmV3IElucHV0U3RyZWFt\nUmVhZGVyKFN5c3RlbS5pbiwgVVRGXzgpKTsKICAgICAgICBpbnQgY2ggPSBz\ndGRpbi5yZWFkKCk7CiAgICAgICAgaWYgKGNoID09ICd5JyB8fAogICAgICAg\nICAgICBjaCA9PSAnWScpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQo=\n","encoding":"base64"}

