{"sha":"9b5fe08bd146bb937908c47d2a625f48f1916924","node_id":"MDQ6QmxvYjE1NzU5NTY6OWI1ZmUwOGJkMTQ2YmI5Mzc5MDhjNDdkMmE2MjVmNDhmMTkxNjkyNA==","size":42290,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/9b5fe08bd146bb937908c47d2a625f48f1916924","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubWV0YTsKCmltcG9ydCBq\nYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hN\nYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWlj\nQm9vbGVhbjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5B\ndG9taWNJbnRlZ2VyOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9y\ndCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb24uQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLlpLVXRpbDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0Rl\nZnMuSWRzOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuZGF0YS5TdGF0\nOwppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwppbXBv\ncnQgY29tLmdvb2dsZS5wcm90b2J1Zi5JbnZhbGlkUHJvdG9jb2xCdWZmZXJF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudmVyc2lv\nbmluZy5WZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnZl\ncnNpb25pbmcuVmVyc2lvbmVkOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5tZXRhLlprVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTGVkZ2VyUmFu\nZ2VzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3Vi\nUHJvdG9jb2wuU3RhdHVzQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlwdGlvbkRhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbC5TdWJzY3JpcHRpb25TdGF0ZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvZXh0ZW5zaW9ucy5TdWJzY3JpcHRpb25TdGF0ZVV0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1vbi5TZXJ2ZXJDb25m\naWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRv\ncGljcy5IdWJJbmZvOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5D\nYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnpvb2tlZXBlci5T\nYWZlQXN5bmNaS0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nem9va2VlcGVyLlprVXRpbHM7CmltcG9ydCBzdGF0aWMgY29tLmdvb2dsZS5j\nb21tb24uYmFzZS5DaGFyc2V0cy5VVEZfODsKCi8qKgogKiBab29LZWVwZXIt\nYmFzZWQgTWV0YWRhdGEgTWFuYWdlci4KICovCnB1YmxpYyBjbGFzcyBaa01l\ndGFkYXRhTWFuYWdlckZhY3RvcnkgZXh0ZW5kcyBNZXRhZGF0YU1hbmFnZXJG\nYWN0b3J5IHsKICAgIHByb3RlY3RlZCBmaW5hbCBzdGF0aWMgTG9nZ2VyIGxv\nZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFprTWV0YWRhdGFNYW5h\nZ2VyRmFjdG9yeS5jbGFzcyk7CgogICAgc3RhdGljIGZpbmFsIGludCBDVVJf\nVkVSU0lPTiA9IDE7CgogICAgWm9vS2VlcGVyIHprOwogICAgU2VydmVyQ29u\nZmlndXJhdGlvbiBjZmc7CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50\nIGdldEN1cnJlbnRWZXJzaW9uKCkgewogICAgICAgIHJldHVybiBDVVJfVkVS\nU0lPTjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBNZXRhZGF0\nYU1hbmFnZXJGYWN0b3J5IGluaXRpYWxpemUoU2VydmVyQ29uZmlndXJhdGlv\nbiBjZmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIFpvb0tlZXBlciB6aywKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaW50IHZlcnNpb24pCiAgICB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgIGlmIChDVVJfVkVSU0lPTiAhPSB2ZXJz\naW9uKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiSW5j\nb21wYXRpYmxlIFprTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSB2ZXJzaW9uICIg\nKyB2ZXJzaW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAi\nIGZvdW5kLCBleHBlY3RlZCB2ZXJzaW9uICIgKyBDVVJfVkVSU0lPTik7CiAg\nICAgICAgfQogICAgICAgIHRoaXMuY2ZnID0gY2ZnOwogICAgICAgIHRoaXMu\nemsgPSB6azsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyB2b2lkIHNodXRkb3duKCkgewogICAgICAgIC8v\nIGRvIG5vdGhpbmcgaGVyZSwgYmVjYXVzZSB6b29rZWVwZXIgaGFuZGxlIGlz\nIHBhc3NlZCBmcm9tIG91dHNpZGUKICAgICAgICAvLyB3ZSBkb24ndCBuZWVk\nIHRvIHN0b3AgaXQuCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\nSXRlcmF0b3I8Qnl0ZVN0cmluZz4gZ2V0VG9waWNzKCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBMaXN0PFN0cmluZz4gdG9waWNzOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHRvcGljcyA9IHprLmdldENoaWxkcmVuKGNm\nZy5nZXRaa1RvcGljc1ByZWZpeChuZXcgU3RyaW5nQnVpbGRlcigpKS50b1N0\ncmluZygpLCBmYWxzZSk7CiAgICAgICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0\naW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigi\nRmFpbGVkIHRvIGdldCB0b3BpY3MgbGlzdCA6ICIsIGtlKTsKICAgICAgICB9\nIGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkludGVycnVwdGVkIG9uIGdldHRp\nbmcgdG9waWNzIGxpc3QgOiAiLCBpZSk7CiAgICAgICAgfQogICAgICAgIGZp\nbmFsIEl0ZXJhdG9yPFN0cmluZz4gaXRlciA9IHRvcGljcy5pdGVyYXRvcigp\nOwogICAgICAgIHJldHVybiBuZXcgSXRlcmF0b3I8Qnl0ZVN0cmluZz4oKSB7\nCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBoYXNOZXh0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZXIu\naGFzTmV4dCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICBwdWJsaWMgQnl0ZVN0cmluZyBuZXh0KCkgewogICAg\nICAgICAgICAgICAgU3RyaW5nIHQgPSBpdGVyLm5leHQoKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCh0KTsKICAg\nICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\ncHVibGljIHZvaWQgcmVtb3ZlKCkgewogICAgICAgICAgICAgICAgaXRlci5y\nZW1vdmUoKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXIg\nbmV3VG9waWNQZXJzaXN0ZW5jZU1hbmFnZXIoKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBaa1RvcGljUGVyc2lzdGVuY2VNYW5hZ2VySW1wbChjZmcsIHprKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdWJzY3JpcHRpb25E\nYXRhTWFuYWdlciBuZXdTdWJzY3JpcHRpb25EYXRhTWFuYWdlcigpIHsKICAg\nICAgICByZXR1cm4gbmV3IFprU3Vic2NyaXB0aW9uRGF0YU1hbmFnZXJJbXBs\nKGNmZywgemspOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFRv\ncGljT3duZXJzaGlwTWFuYWdlciBuZXdUb3BpY093bmVyc2hpcE1hbmFnZXIo\nKSB7CiAgICAgICAgcmV0dXJuIG5ldyBaa1RvcGljT3duZXJzaGlwTWFuYWdl\nckltcGwoY2ZnLCB6ayk7CiAgICB9CgogICAgLyoqCiAgICAgKiBab29LZWVw\nZXIgYmFzZWQgdG9waWMgcGVyc2lzdGVuY2UgbWFuYWdlci4KICAgICAqLwog\nICAgc3RhdGljIGNsYXNzIFprVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXJJbXBs\nIGltcGxlbWVudHMgVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXIgewoKICAgICAg\nICBab29LZWVwZXIgems7CiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBj\nZmc7CgogICAgICAgIFprVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXJJbXBsKFNl\ncnZlckNvbmZpZ3VyYXRpb24gY29uZiwgWm9vS2VlcGVyIHprKSB7CiAgICAg\nICAgICAgIHRoaXMuY2ZnID0gY29uZjsKICAgICAgICAgICAgdGhpcy56ayA9\nIHprOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAg\nICAgICAvLyBkbyBub3RoaW5nIGluIHpvb2tlZXBlciBiYXNlZCBpbXBsCiAg\nICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBHZXQgem5vZGUgcGF0\naCB0byBzdG9yZSBwZXJzaXN0ZW5jZSBpbmZvIG9mIGEgdG9waWMuCiAgICAg\nICAgICoKICAgICAgICAgKiBAcGFyYW0gdG9waWMKICAgICAgICAgKiAgICAg\nICAgICBUb3BpYyBuYW1lCiAgICAgICAgICogQHJldHVybiB6bm9kZSBwYXRo\nIHRvIHN0b3JlIHBlcnNpc3RlbmNlIGluZm8uCiAgICAgICAgICovCiAgICAg\nICAgcHJpdmF0ZSBTdHJpbmcgbGVkZ2Vyc1BhdGgoQnl0ZVN0cmluZyB0b3Bp\nYykgewogICAgICAgICAgICByZXR1cm4gY2ZnLmdldFprVG9waWNQYXRoKG5l\ndyBTdHJpbmdCdWlsZGVyKCksIHRvcGljKS5hcHBlbmQoIi9sZWRnZXJzIiku\ndG9TdHJpbmcoKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIFBhcnNlIGxlZGdlciByYW5nZXMgZGF0YSBhbmQgcmV0dXJuIGl0IHRocnUg\nY2FsbGJhY2suCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gdG9waWMK\nICAgICAgICAgKiAgICAgICAgICBUb3BpYyBuYW1lCiAgICAgICAgICogQHBh\ncmFtIGRhdGEKICAgICAgICAgKiAgICAgICAgICBUb3BpYyBMZWRnZXIgUmFu\nZ2VzIGRhdGEKICAgICAgICAgKiBAcGFyYW0gdmVyc2lvbgogICAgICAgICAq\nICAgICAgICAgIFZlcnNpb24gb2YgdGhlIHRvcGljIGxlZGdlciByYW5nZXMg\nZGF0YQogICAgICAgICAqIEBwYXJhbSBjYWxsYmFjawogICAgICAgICAqICAg\nICAgICAgIENhbGxiYWNrIHRvIHJldHVybiBsZWRnZXIgcmFuZ2VzCiAgICAg\nICAgICogQHBhcmFtIGN0eAogICAgICAgICAqICAgICAgICAgIENvbnRleHQg\nb2YgdGhlIGNhbGxiYWNrCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSB2\nb2lkIHBhcnNlQW5kUmV0dXJuVG9waWNMZWRnZXJSYW5nZXMoQnl0ZVN0cmlu\nZyB0b3BpYywgYnl0ZVtdIGRhdGEsIGludCB2ZXJzaW9uLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENh\nbGxiYWNrPFZlcnNpb25lZDxMZWRnZXJSYW5nZXM+PiBjYWxsYmFjaywgT2Jq\nZWN0IGN0eCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nVmVyc2lvbmVkPExlZGdlclJhbmdlcz4gcmFuZ2VzID0gbmV3IFZlcnNpb25l\nZDxMZWRnZXJSYW5nZXM+KExlZGdlclJhbmdlcy5wYXJzZUZyb20oZGF0YSks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFprVmVyc2lv\nbih2ZXJzaW9uKSk7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GaW5pc2hlZChjdHgsIHJhbmdlcyk7CiAgICAgICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgICAgIH0gY2F0Y2ggKEludmFsaWRQcm90b2NvbEJ1ZmZl\nckV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgbXNnID0g\nIkxlZGdlciByYW5nZXMgZm9yIHRvcGljOiIgKyB0b3BpYy50b1N0cmluZ1V0\nZjgoKSArICIgY291bGQgbm90IGJlIGRlc2VyaWFsaXplZCI7CiAgICAgICAg\nICAgICAgICBsb2dnZXIuZXJyb3IobXNnLCBlKTsKICAgICAgICAgICAgICAg\nIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNl\ncHRpb24uVW5leHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbihtc2cpKTsKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcmVhZFRv\ncGljUGVyc2lzdGVuY2VJbmZvKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZp\nbmFsIENhbGxiYWNrPFZlcnNpb25lZDxMZWRnZXJSYW5nZXM+PiBjYWxsYmFj\naywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAvLyByZWFkIHRvcGljIGxl\nZGdlcnMgbm9kZSBkYXRhCiAgICAgICAgICAgIGZpbmFsIFN0cmluZyB6Tm9k\nZVBhdGggPSBsZWRnZXJzUGF0aCh0b3BpYyk7CgogICAgICAgICAgICB6ay5n\nZXREYXRhKHpOb2RlUGF0aCwgZmFsc2UsIG5ldyBTYWZlQXN5bmNaS0NhbGxi\nYWNrLkRhdGFDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1\nbHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgYnl0ZVtdIGRh\ndGEsIFN0YXQgc3RhdCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyYyA9\nPSBDb2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgcGFyc2VBbmRSZXR1cm5Ub3BpY0xlZGdlclJhbmdlcyh0b3BpYywgZGF0\nYSwgc3RhdC5nZXRWZXJzaW9uKCksIGNhbGxiYWNrLCBjdHgpOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQ29kZS5OT05PREUu\naW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBk\nb24ndCBjcmVhdGUgdGhlIHpub2RlIHVudGlsIHdlIGZpcnN0IHdyaXRlIGl0\nLgogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25G\naW5pc2hlZChjdHgsIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAg\nICAgICAvLyBvdGhlcndpc2Ugc29tZSBvdGhlciBlcnJvcgogICAgICAgICAg\nICAgICAgICAgIEtlZXBlckV4Y2VwdGlvbiBrZSA9CiAgICAgICAgICAgICAg\nICAgICAgICAgIFprVXRpbHMubG9nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlv\nbigiQ291bGQgbm90IHJlYWQgbGVkZ2VycyBub2RlIGZvciB0b3BpYzogIgog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSwgcGF0aCwg\ncmMpOwogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZh\naWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNl\ncHRpb24oa2UpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwg\nY3R4KTsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUgdm9pZCBjcmVhdGVU\nb3BpY1BlcnNpc3RlbmNlSW5mbyhmaW5hbCBCeXRlU3RyaW5nIHRvcGljLCBM\nZWRnZXJSYW5nZXMgcmFuZ2VzLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBDYWxsYmFjazxWZXJzaW9u\nPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAgICAgICAgICBmaW5hbCBT\ndHJpbmcgek5vZGVQYXRoID0gbGVkZ2Vyc1BhdGgodG9waWMpOwogICAgICAg\nICAgICBmaW5hbCBieXRlW10gZGF0YSA9IHJhbmdlcy50b0J5dGVBcnJheSgp\nOwogICAgICAgICAgICAvLyBjcmVhdGUgaXQKICAgICAgICAgICAgWmtVdGls\ncy5jcmVhdGVGdWxsUGF0aE9wdGltaXN0aWMoemssIHpOb2RlUGF0aCwgZGF0\nYSwgSWRzLk9QRU5fQUNMX1VOU0FGRSwKICAgICAgICAgICAgQ3JlYXRlTW9k\nZS5QRVJTSVNURU5ULCBuZXcgU2FmZUFzeW5jWktDYWxsYmFjay5TdHJpbmdD\nYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAg\nICAgICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJj\nLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgU3RyaW5nIG5hbWUpIHsKICAg\nICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQ29kZS5OT0RFRVhJU1RTLmlu\ndFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2su\nb3BlcmF0aW9uRmFpbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0ZShT\ndGF0dXNDb2RlLlRPUElDX1BFUlNJU1RFTkNFX0lORk9fRVhJU1RTLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAiUGVyc2lzdGVuY2UgaW5mbyBvZiB0b3BpYyAiICsgdG9waWMudG9T\ndHJpbmdVdGY4KCkgKyAiIGV4aXN0ZWQuIikpOwogICAgICAgICAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIGlmIChyYyAhPSBDb2RlLk9LLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGtlID0g\nWmtVdGlscy5sb2dFcnJvckFuZENyZWF0ZVpLRXhjZXB0aW9uKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ291bGQg\nbm90IGNyZWF0ZSBsZWRnZXJzIG5vZGUgZm9yIHRvcGljOiAiICsgdG9waWMu\ndG9TdHJpbmdVdGY4KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHBhdGgsIHJjKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1\nYkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbihrZSkpOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIC8vIGluaXRpYWwgdmVyc2lvbiBpcyB2\nZXJzaW9uIDAKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GaW5pc2hlZChjdHgsIG5ldyBaa1ZlcnNpb24oMCkpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9LCBjdHgpOwogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgdm9pZCB3cml0ZVRvcGljUGVyc2lzdGVuY2VJbmZvKGZpbmFsIEJ5dGVT\ndHJpbmcgdG9waWMsIExlZGdlclJhbmdlcyByYW5nZXMsIGZpbmFsIFZlcnNp\nb24gdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGZpbmFsIENhbGxiYWNrPFZlcnNpb24+IGNhbGxiYWNr\nLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgIGlmIChWZXJzaW9uLk5FVyA9\nPSB2ZXJzaW9uKSB7CiAgICAgICAgICAgICAgICBjcmVhdGVUb3BpY1BlcnNp\nc3RlbmNlSW5mbyh0b3BpYywgcmFuZ2VzLCBjYWxsYmFjaywgY3R4KTsKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgZmluYWwgU3RyaW5nIHpOb2RlUGF0aCA9IGxlZGdlcnNQYXRoKHRvcGlj\nKTsKICAgICAgICAgICAgZmluYWwgYnl0ZVtdIGRhdGEgPSByYW5nZXMudG9C\neXRlQXJyYXkoKTsKCiAgICAgICAgICAgIGlmICghKHZlcnNpb24gaW5zdGFu\nY2VvZiBaa1ZlcnNpb24pKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVuZXhw\nZWN0ZWRDb25kaXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAiSW52YWxpZCB2ZXJzaW9uIHBy\nb3ZpZGVkIHRvIHVwZGF0ZSBwZXJzaXN0ZW5jZSBpbmZvIGZvciB0b3BpYyAi\nICsgdG9waWMudG9TdHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaW50IHpub2RlVmVy\nc2lvbiA9ICgoWmtWZXJzaW9uKXZlcnNpb24pLmdldFpub2RlVmVyc2lvbigp\nOwogICAgICAgICAgICB6ay5zZXREYXRhKHpOb2RlUGF0aCwgZGF0YSwgem5v\nZGVWZXJzaW9uLCBuZXcgU2FmZUFzeW5jWktDYWxsYmFjay5TdGF0Q2FsbGJh\nY2soKSB7CiAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50\nIHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgU3RhdCBzdGF0KSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmIChyYyA9PSBDb2RlLk5PTk9ERS5p\nbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBu\nbyBub2RlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GYWlsZWQoY3R4LCBQdWJTdWJFeGNlcHRpb24uY3JlYXRlKFN0\nYXR1c0NvZGUuTk9fVE9QSUNfUEVSU0lTVEVOQ0VfSU5GTywKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICJObyBwZXJzaXN0ZW5jZSBpbmZvIGZvdW5kIGZvciB0b3BpYyAiICsg\ndG9waWMudG9TdHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNl\nIGlmIChyYyA9PSBDb2RlLkJBRFZFUlNJT04uaW50VmFsdWUoKSkgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFkIHZlcnNpb24KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxl\nZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29kZS5CQURf\nVkVSU0lPTiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICJCYWQgdmVyc2lvbiBwcm92aWRlZCB0\nbyB1cGRhdGUgcGVyc2lzdGVuY2UgaW5mbyBvZiB0b3BpYyAiICsgdG9waWMu\ndG9TdHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChy\nYyA9PSBDb2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbmV3\nIFprVmVyc2lvbihzdGF0LmdldFZlcnNpb24oKSkpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVy\nRXhjZXB0aW9uIGtlID0gWmtVdGlscy5sb2dFcnJvckFuZENyZWF0ZVpLRXhj\nZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi\nQ291bGQgbm90IHdyaXRlIGxlZGdlcnMgbm9kZSBmb3IgdG9waWM6ICIgKyB0\nb3BpYy50b1N0cmluZ1V0ZjgoKSwgcGF0aCwgcmMpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwg\nbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbihrZSkp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9LCBjdHgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIHZvaWQgZGVsZXRlVG9waWNQZXJzaXN0ZW5jZUlu\nZm8oZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgVmVyc2lvbiB2ZXJz\naW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsIENhbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLCBPYmplY3Qg\nY3R4KSB7CiAgICAgICAgICAgIGZpbmFsIFN0cmluZyB6Tm9kZVBhdGggPSBs\nZWRnZXJzUGF0aCh0b3BpYyk7CgogICAgICAgICAgICBpbnQgem5vZGVWZXJz\naW9uID0gLTE7CiAgICAgICAgICAgIGlmIChWZXJzaW9uLkFOWSAhPSB2ZXJz\naW9uKSB7CiAgICAgICAgICAgICAgICBpZiAoISh2ZXJzaW9uIGluc3RhbmNl\nb2YgWmtWZXJzaW9uKSkgewogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNr\nLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uVW5l\neHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW52YWxpZCB2ZXJz\naW9uIHByb3ZpZGVkIHRvIGRlbGV0ZSBwZXJzaXN0ZW5jZSBpbmZvIGZvciB0\nb3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkpKTsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgIHpub2RlVmVyc2lvbiA9ICgoWmtWZXJzaW9uKXZl\ncnNpb24pLmdldFpub2RlVmVyc2lvbigpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHprLmRlbGV0ZSh6Tm9kZVBhdGgs\nIHpub2RlVmVyc2lvbiwgbmV3IFNhZmVBc3luY1pLQ2FsbGJhY2suVm9pZENh\nbGxiYWNrKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBzYWZlUHJvY2Vzc1Jlc3VsdChpbnQgcmMs\nIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKHJjID09IENvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAg\nICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjdHgs\nIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyYyA9PSBDb2RlLk5PTk9ERS5p\nbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIG5v\nZGUKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9u\nRmFpbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2Rl\nLk5PX1RPUElDX1BFUlNJU1RFTkNFX0lORk8sCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJObyBwZXJz\naXN0ZW5jZSBpbmZvIGZvdW5kIGZvciB0b3BpYyAiICsgdG9waWMudG9TdHJp\nbmdVdGY4KCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmMgPT0gQ29kZS5CQURW\nRVJTSU9OLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gYmFkIHZlcnNpb24KICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJh\nY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0\nZShTdGF0dXNDb2RlLkJBRF9WRVJTSU9OLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFkIHZlcnNp\nb24gcHJvdmlkZWQgdG8gZGVsZXRlIHBlcnNpc3RlbmNlIGluZm8gb2YgdG9w\naWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpKSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlvbiBlID0gWmtVdGlscy5s\nb2dFcnJvckFuZENyZWF0ZVpLRXhjZXB0aW9uKCJUb3BpYzogIiArIHRvcGlj\nLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArICIgZmFpbGVkIHRvIGRlbGV0ZSBwZXJzaXN0ZW5jZSBp\nbmZvIEB2ZXJzaW9uICIgKyB2ZXJzaW9uICsgIiA6ICIsIHBhdGgsIHJjKTsK\nICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQo\nY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9u\nKGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgY3R4KTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBab29LZWVwZXIgYmFz\nZWQgc3Vic2NyaXB0aW9uIGRhdGEgbWFuYWdlci4KICAgICAqLwogICAgc3Rh\ndGljIGNsYXNzIFprU3Vic2NyaXB0aW9uRGF0YU1hbmFnZXJJbXBsIGltcGxl\nbWVudHMgU3Vic2NyaXB0aW9uRGF0YU1hbmFnZXIgewoKICAgICAgICBab29L\nZWVwZXIgems7CiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBjZmc7Cgog\nICAgICAgIFprU3Vic2NyaXB0aW9uRGF0YU1hbmFnZXJJbXBsKFNlcnZlckNv\nbmZpZ3VyYXRpb24gY29uZiwgWm9vS2VlcGVyIHprKSB7CiAgICAgICAgICAg\nIHRoaXMuY2ZnID0gY29uZjsKICAgICAgICAgICAgdGhpcy56ayA9IHprOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZv\naWQgY2xvc2UoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICAv\nLyBkbyBub3RoaW5nIGluIHpvb2tlZXBlciBiYXNlZCBpbXBsCiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBHZXQgem5vZGUgcGF0aCB0byBz\ndG9yZSBzdWJzY3JpcHRpb24gc3RhdGVzLgogICAgICAgICAqCiAgICAgICAg\nICogQHBhcmFtIHNiCiAgICAgICAgICogICAgICAgICAgU3RyaW5nIGJ1aWxk\nZXIgdG8gc3RvcmUgdGhlIHpub2RlIHBhdGguCiAgICAgICAgICogQHBhcmFt\nIHRvcGljCiAgICAgICAgICogICAgICAgICAgVG9waWMgbmFtZS4KICAgICAg\nICAgKgogICAgICAgICAqIEByZXR1cm4gc3RyaW5nIGJ1aWxkZXIgdG8gc3Rv\ncmUgem5vZGUgcGF0aC4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIFN0\ncmluZ0J1aWxkZXIgdG9waWNTdWJzY3JpYmVyc1BhdGgoU3RyaW5nQnVpbGRl\nciBzYiwgQnl0ZVN0cmluZyB0b3BpYykgewogICAgICAgICAgICByZXR1cm4g\nY2ZnLmdldFprVG9waWNQYXRoKHNiLCB0b3BpYykuYXBwZW5kKCIvc3Vic2Ny\naWJlcnMiKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEdl\ndCB6bm9kZSBwYXRoIHRvIHN0b3JlIHN1YnNjcmlwdGlvbiBzdGF0ZSBmb3Ig\nYSBzcGVjaWZpZWQgc3Vic2NyaWJlci4KICAgICAgICAgKgogICAgICAgICAq\nIEBwYXJhbSB0b3BpYwogICAgICAgICAqICAgICAgICAgIFRvcGljIG5hbWUu\nCiAgICAgICAgICogQHBhcmFtIHN1YnNjcmliZXIKICAgICAgICAgKiAgICAg\nICAgICBTdWJzY3JpYmVyIGlkLgogICAgICAgICAqIEByZXR1cm4gem5vZGUg\ncGF0aCB0byBzdG9yZSBzdWJzY3JpcHRpb24gc3RhdGUuCiAgICAgICAgICov\nCiAgICAgICAgcHJpdmF0ZSBTdHJpbmcgdG9waWNTdWJzY3JpYmVyUGF0aChC\neXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXIpIHsKICAg\nICAgICAgICAgcmV0dXJuIHRvcGljU3Vic2NyaWJlcnNQYXRoKG5ldyBTdHJp\nbmdCdWlsZGVyKCksIHRvcGljKS5hcHBlbmQoIi8iKS5hcHBlbmQoc3Vic2Ny\naWJlci50b1N0cmluZ1V0ZjgoKSkKICAgICAgICAgICAgICAgICAgIC50b1N0\ncmluZygpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gaXNQYXJ0aWFsVXBkYXRlU3VwcG9ydGVkKCkgewog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBjcmVhdGVTdWJzY3JpcHRp\nb25EYXRhKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFsIEJ5dGVTdHJp\nbmcgc3Vic2NyaWJlcklkLCBmaW5hbCBTdWJzY3JpcHRpb25EYXRhIGRhdGEs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm\naW5hbCBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgZmluYWwgT2JqZWN0\nIGN0eCkgewogICAgICAgICAgICBaa1V0aWxzLmNyZWF0ZUZ1bGxQYXRoT3B0\naW1pc3RpYyh6aywgdG9waWNTdWJzY3JpYmVyUGF0aCh0b3BpYywgc3Vic2Ny\naWJlcklkKSwgZGF0YS50b0J5dGVBcnJheSgpLAogICAgICAgICAgICBJZHMu\nT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RFTlQsIG5ldyBT\nYWZlQXN5bmNaS0NhbGxiYWNrLlN0cmluZ0NhbGxiYWNrKCkgewoKICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZv\naWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2Jq\nZWN0IGN0eCwgU3RyaW5nIG5hbWUpIHsKCiAgICAgICAgICAgICAgICAgICAg\naWYgKHJjID09IENvZGUuTk9ERUVYSVNUUy5pbnRWYWx1ZSgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChj\ndHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29kZS5TVUJTQ1JJ\nUFRJT05fU1RBVEVfRVhJU1RTLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3Vic2NyaXB0aW9uIHN0\nYXRlIGZvciAodG9waWM6IiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiwg\nc3Vic2NyaWJlcjoiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgc3Vic2NyaWJlcklkLnRvU3RyaW5n\nVXRmOCgpICsgIikgZXhpc3RlZC4iKSk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJj\nID09IENvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3VjY2Vzc2Z1bGx5\nIHJlY29yZGVkIHN1YnNjcmlwdGlvbiBmb3IgdG9waWM6ICIgKyB0b3BpYy50\nb1N0cmluZ1V0ZjgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBzdWJzY3JpYmVySWQu\ndG9TdHJpbmdVdGY4KCkgKyAiIGRhdGE6ICIKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICArIFN1YnNjcmlwdGlvblN0YXRlVXRp\nbHMudG9TdHJpbmcoZGF0YSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZp\nbmlzaGVkKGN0eCwgbmV3IFprVmVyc2lvbigwKSk7CiAgICAgICAgICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVy\nRXhjZXB0aW9uIGtlID0gWmtVdGlscy5sb2dFcnJvckFuZENyZWF0ZVpLRXhj\nZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIkNvdWxkIG5vdCByZWNvcmQgbmV3IHN1YnNjcmlwdGlv\nbiBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAi\nIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0Zjgo\nKSwgcGF0aCwgcmMpOwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNl\ncnZpY2VEb3duRXhjZXB0aW9uKGtlKSk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBjdHgpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\ndXBkYXRlU3Vic2NyaXB0aW9uRGF0YShmaW5hbCBCeXRlU3RyaW5nIHRvcGlj\nLCBmaW5hbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgZmluYWwgU3Vic2Ny\naXB0aW9uRGF0YSBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWwgVmVyc2lvbiB2ZXJzaW9uLCBmaW5hbCBD\nYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgZmluYWwgT2JqZWN0IGN0eCkg\newogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25F\neGNlcHRpb24oIlpvb0tlZXBlciBiYXNlZCBtZXRhZGF0YSBtYW5hZ2VyIGRv\nZXNuJ3Qgc3VwcG9ydCBwYXJ0aWFsIHVwZGF0ZSEiKTsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHJlcGxhY2VT\ndWJzY3JpcHRpb25EYXRhKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsIGZpbmFs\nIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBmaW5hbCBTdWJzY3JpcHRpb25E\nYXRhIGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZmluYWwgVmVyc2lvbiB2ZXJzaW9uLCBmaW5hbCBDYWxsYmFj\nazxWZXJzaW9uPiBjYWxsYmFjaywgZmluYWwgT2JqZWN0IGN0eCkgewogICAg\nICAgICAgICBpbnQgem5vZGVWZXJzaW9uID0gLTE7CiAgICAgICAgICAgIGlm\nIChWZXJzaW9uLk5FVyA9PSB2ZXJzaW9uKSB7CiAgICAgICAgICAgICAgICBj\nYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCAKICAgICAgICAgICAgICAg\nICAgICAgICAgbmV3IFB1YlN1YkV4Y2VwdGlvbi5CYWRWZXJzaW9uRXhjZXB0\naW9uKCJDYW4gbm90IHJlcGxhY2UgVmVyc2lvbi5OZXcgc3Vic2NyaXB0aW9u\nIGRhdGEiKSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nIH0gZWxzZSBpZiAoVmVyc2lvbi5BTlkgIT0gdmVyc2lvbikgewogICAgICAg\nICAgICAgICAgaWYgKCEodmVyc2lvbiBpbnN0YW5jZW9mIFprVmVyc2lvbikp\nIHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWls\nZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRDb25kaXRp\nb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIkludmFsaWQgdmVyc2lvbiBwcm92aWRlZCB0\nbyByZXBsYWNlIHN1YnNjcmlwdGlvbiBkYXRhIGZvciB0b3BpYyAgIiAKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiBzdWJzY3JpYmUgaWQ6ICIg\nKyBzdWJzY3JpYmVySWQpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIHpub2RlVmVyc2lvbiA9ICgoWmtWZXJzaW9uKXZlcnNpb24pLmdldFpub2Rl\nVmVyc2lvbigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHprLnNldERhdGEodG9waWNTdWJzY3JpYmVyUGF0aCh0b3Bp\nYywgc3Vic2NyaWJlcklkKSwgZGF0YS50b0J5dGVBcnJheSgpLCAKICAgICAg\nICAgICAgICAgICAgICB6bm9kZVZlcnNpb24sIG5ldyBTYWZlQXN5bmNaS0Nh\nbGxiYWNrLlN0YXRDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NS\nZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgU3RhdCBz\ndGF0KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjID09IENvZGUuTk9O\nT0RFLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nbm8gbm9kZQogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVy\nYXRpb25GYWlsZWQoY3R4LCBQdWJTdWJFeGNlcHRpb24uY3JlYXRlKFN0YXR1\nc0NvZGUuTk9fU1VCU0NSSVBUSU9OX1NUQVRFLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm8gc3Vi\nc2NyaXB0aW9uIHN0YXRlIGZvdW5kIGZvciAodG9waWM6IiArIHRvcGljLnRv\nU3RyaW5nVXRmOCgpICsgIiwgc3Vic2NyaWJlcjoiCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgc3Vi\nc2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpICsgIikuIikpOwogICAgICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfSBl\nbHNlIGlmIChyYyA9PSBDb2RlLkJBRFZFUlNJT04uaW50VmFsdWUoKSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWQgdmVyc2lvbgogICAgICAg\nICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4\nLCBQdWJTdWJFeGNlcHRpb24uY3JlYXRlKFN0YXR1c0NvZGUuQkFEX1ZFUlNJ\nT04sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICJCYWQgdmVyc2lvbiBwcm92aWRlZCB0byByZXBsYWNl\nIHN1YnNjcmlwdGlvbiBkYXRhIG9mIHRvcGljICIgCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgdG9w\naWMudG9TdHJpbmdVdGY4KCkgKyAiIHN1YnNjcmliZXJJZCAiICsgc3Vic2Ny\naWJlcklkKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJjICE9IENvZGUuT0suaW50\nVmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNl\ncHRpb24gZSA9IFprVXRpbHMubG9nRXJyb3JBbmRDcmVhdGVaS0V4Y2VwdGlv\nbigiVG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3Jp\nYmVySWQ6ICIgKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgY291\nbGQgbm90IHNldCBzdWJzY3JpcHRpb24gZGF0YTogIiArIFN1YnNjcmlwdGlv\nblN0YXRlVXRpbHMudG9TdHJpbmcoZGF0YSksCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCwgcmMpOwogICAgICAg\nICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4\nLCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKGUp\nKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3VjY2Vz\nc2Z1bGx5IHVwZGF0ZWQgc3Vic2NyaXB0aW9uIGZvciB0b3BpYzogIiArIHRv\ncGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmli\nZXJJZC50b1N0cmluZ1V0ZjgoKSArICIgZGF0YTogIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgU3Vic2NyaXB0aW9uU3Rh\ndGVVdGlscy50b1N0cmluZyhkYXRhKSk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJh\ndGlvbkZpbmlzaGVkKGN0eCwgbmV3IFprVmVyc2lvbihzdGF0LmdldFZlcnNp\nb24oKSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfSwgY3R4KTsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIGRlbGV0ZVN1YnNjcmlwdGlv\nbkRhdGEoZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgQnl0ZVN0cmlu\nZyBzdWJzY3JpYmVySWQsIFZlcnNpb24gdmVyc2lvbiwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIENhbGxiYWNr\nPFZvaWQ+IGNhbGxiYWNrLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgIAog\nICAgICAgICAgICBpbnQgem5vZGVWZXJzaW9uID0gLTE7CiAgICAgICAgICAg\nIGlmIChWZXJzaW9uLk5FVyA9PSB2ZXJzaW9uKSB7CiAgICAgICAgICAgICAg\nICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCAKICAgICAgICAgICAg\nICAgICAgICAgICAgbmV3IFB1YlN1YkV4Y2VwdGlvbi5CYWRWZXJzaW9uRXhj\nZXB0aW9uKCJDYW4gbm90IGRlbGV0ZSBWZXJzaW9uLk5ldyBzdWJzY3JpcHRp\nb24gZGF0YSIpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgfSBlbHNlIGlmIChWZXJzaW9uLkFOWSAhPSB2ZXJzaW9uKSB7CiAgICAg\nICAgICAgICAgICBpZiAoISh2ZXJzaW9uIGluc3RhbmNlb2YgWmtWZXJzaW9u\nKSkgewogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZh\naWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uVW5leHBlY3RlZENvbmRp\ndGlvbkV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAiSW52YWxpZCB2ZXJzaW9uIHByb3ZpZGVk\nIHRvIGRlbGV0ZSBzdWJzY3JpcHRpb24gZGF0YSBmb3IgdG9waWMgICIgCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIgc3Vic2NyaWJlIGlkOiAi\nICsgc3Vic2NyaWJlcklkKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAg\nICB6bm9kZVZlcnNpb24gPSAoKFprVmVyc2lvbil2ZXJzaW9uKS5nZXRabm9k\nZVZlcnNpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgICAgICAKICAgICAgICAgICAgemsuZGVsZXRlKHRvcGljU3Vic2Ny\naWJlclBhdGgodG9waWMsIHN1YnNjcmliZXJJZCksIHpub2RlVmVyc2lvbiwg\nbmV3IFNhZmVBc3luY1pLQ2FsbGJhY2suVm9pZENhbGxiYWNrKCkgewogICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMg\ndm9pZCBzYWZlUHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBP\nYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJjID09IENv\nZGUuTk9OT0RFLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gbm8gbm9kZQogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LCBQdWJTdWJFeGNlcHRpb24uY3JlYXRl\nKFN0YXR1c0NvZGUuTk9fU1VCU0NSSVBUSU9OX1NUQVRFLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi\nTm8gc3Vic2NyaXB0aW9uIHN0YXRlIGZvdW5kIGZvciAodG9waWM6IiArIHRv\ncGljLnRvU3RyaW5nVXRmOCgpICsgIiwgc3Vic2NyaWJlcjoiCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpICsgIikuIikpOwogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAg\nICAgfSBlbHNlIGlmIChyYyA9PSBDb2RlLkJBRFZFUlNJT04uaW50VmFsdWUo\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBiYWQgdmVyc2lvbgog\nICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GYWls\nZWQoY3R4LCBQdWJTdWJFeGNlcHRpb24uY3JlYXRlKFN0YXR1c0NvZGUuQkFE\nX1ZFUlNJT04sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICJCYWQgdmVyc2lvbiBwcm92aWRlZCB0byBk\nZWxldGUgc3Vic2NyaXB0aW9uIGRhdGEgb2YgdG9waWMgIiAKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSArICIgc3Vic2NyaWJlcklkICIgKyBz\ndWJzY3JpYmVySWQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmMgPT0gQ29kZS5P\nSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChs\nb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbG9nZ2VyLmRlYnVnKCJTdWNjZXNzZnVsbHkgZGVsZXRlZCBz\ndWJzY3JpcHRpb24gZm9yIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4\nKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr\nICIgc3Vic2NyaWJlcklkOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRm\nOCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBu\ndWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhj\nZXB0aW9uIGUgPSBaa1V0aWxzLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRp\nb24oIlRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVy\nSWQ6ICIgKyBzdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCkgKyAiIGZhaWxl\nZCB0byBkZWxldGUgc3Vic2NyaXB0aW9uIiwgcGF0aCwgcmMpOwogICAgICAg\nICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5l\ndyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRpb24oZSkpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBjdHgpOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcmVh\nZFN1YnNjcmlwdGlvbkRhdGEoZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgZmlu\nYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgQ2FsbGJhY2s8VmVyc2lv\nbmVkPFN1YnNjcmlwdGlvbkRhdGE+PiBjYWxsYmFjaywgZmluYWwgT2JqZWN0\nIGN0eCkgewogICAgICAgICAgICB6ay5nZXREYXRhKHRvcGljU3Vic2NyaWJl\nclBhdGgodG9waWMsIHN1YnNjcmliZXJJZCksIGZhbHNlLCBuZXcgU2FmZUFz\neW5jWktDYWxsYmFjay5EYXRhQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVQ\ncm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgs\nIGJ5dGVbXSBkYXRhLCBTdGF0IHN0YXQpIHsKICAgICAgICAgICAgICAgICAg\nICBpZiAocmMgPT0gQ29kZS5OT05PREUuaW50VmFsdWUoKSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChj\ndHgsIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChy\nYyAhPSBDb2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgS2VlcGVyRXhjZXB0aW9uIGUgPSBaa1V0aWxzLmxvZ0Vycm9yQW5k\nQ3JlYXRlWktFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICJDb3VsZCBub3QgcmVhZCBzdWJzY3Jp\ncHRpb24gZGF0YSBmb3IgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0Zjgo\nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICArICIsIHN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJZC50b1N0\ncmluZ1V0ZjgoKSwgcGF0aCwgcmMpOwogICAgICAgICAgICAgICAgICAgICAg\nICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhj\nZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBWZXJzaW9u\nZWQ8U3Vic2NyaXB0aW9uRGF0YT4gc3ViRGF0YTsKICAgICAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJEYXRhID0g\nbmV3IFZlcnNpb25lZDxTdWJzY3JpcHRpb25EYXRhPigKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1YnNjcmlwdGlvblN0YXRl\nVXRpbHMucGFyc2VTdWJzY3JpcHRpb25EYXRhKGRhdGEpLCAKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBaa1ZlcnNpb24o\nc3RhdC5nZXRWZXJzaW9uKCkpKTsKICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChJbnZhbGlkUHJvdG9jb2xCdWZmZXJFeGNlcHRpb24gZXgpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgU3RyaW5nIG1zZyA9ICJGYWlsZWQgdG8g\nZGVzZXJpYWxpemUgc3Vic2NyaXB0aW9uIGRhdGEgZm9yIHRvcGljOiAiICsg\ndG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBzdWJzY3JpYmVy\nSWQudG9TdHJpbmdVdGY4KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcihtc2csIGV4KTsKICAgICAgICAgICAgICAgICAgICAgICAg\nY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2Vw\ndGlvbi5VbmV4cGVjdGVkQ29uZGl0aW9uRXhjZXB0aW9uKG1zZykpOwogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdF\nbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRl\nYnVnKCJGb3VuZCBzdWJzY3JpcHRpb24gd2hpbGUgYWNxdWlyaW5nIHRvcGlj\nOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBzdWJz\nY3JpYmVySWQudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICsgIiBkYXRhOiAiICsgU3Vic2NyaXB0aW9uU3Rh\ndGVVdGlscy50b1N0cmluZyhzdWJEYXRhLmdldFZhbHVlKCkpKTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2su\nb3BlcmF0aW9uRmluaXNoZWQoY3R4LCBzdWJEYXRhKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSwgY3R4KTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHJlYWRTdWJzY3JpcHRp\nb25zKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgZmluYWwgQ2FsbGJhY2s8TWFwPEJ5dGVT\ndHJpbmcsIFZlcnNpb25lZDxTdWJzY3JpcHRpb25EYXRhPj4+IGNiLCBmaW5h\nbCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgIFN0cmluZyB0b3BpY1N1YnNj\ncmliZXJzUGF0aCA9IHRvcGljU3Vic2NyaWJlcnNQYXRoKG5ldyBTdHJpbmdC\ndWlsZGVyKCksIHRvcGljKS50b1N0cmluZygpOwogICAgICAgICAgICB6ay5n\nZXRDaGlsZHJlbih0b3BpY1N1YnNjcmliZXJzUGF0aCwgZmFsc2UsIG5ldyBT\nYWZlQXN5bmNaS0NhbGxiYWNrLkNoaWxkcmVuQ2FsbGJhY2soKSB7CiAgICAg\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIGZp\nbmFsIE9iamVjdCBjdHgsIGZpbmFsIExpc3Q8U3RyaW5nPiBjaGlsZHJlbikg\newoKICAgICAgICAgICAgICAgICAgICBpZiAocmMgIT0gQ29kZS5PSy5pbnRW\nYWx1ZSgpICYmIHJjICE9IENvZGUuTk9OT0RFLmludFZhbHVlKCkpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9uIGUgPSBaa1V0\naWxzLmxvZ0Vycm9yQW5kQ3JlYXRlWktFeGNlcHRpb24oIkNvdWxkIG5vdCBy\nZWFkIHN1YnNjcmliZXJzIGZvciB0b3BpYyAiCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB0b3BpYy50b1N0cmluZ1V0\nZjgoKSwgcGF0aCwgcmMpOwogICAgICAgICAgICAgICAgICAgICAgICBjYi5v\ncGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9uLlNlcnZp\nY2VEb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAg\nICAgICAgZmluYWwgTWFwPEJ5dGVTdHJpbmcsIFZlcnNpb25lZDxTdWJzY3Jp\ncHRpb25EYXRhPj4gdG9waWNTdWJzID0gCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBuZXcgQ29uY3VycmVudEhhc2hNYXA8Qnl0ZVN0cmluZywgVmVy\nc2lvbmVkPFN1YnNjcmlwdGlvbkRhdGE+PigpOwoKICAgICAgICAgICAgICAg\nICAgICBpZiAocmMgPT0gQ29kZS5OT05PREUuaW50VmFsdWUoKSB8fCBjaGls\nZHJlbi5zaXplKCkgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiTm8gc3Vic2NyaXB0aW9ucyBm\nb3VuZCB3aGlsZSBhY3F1aXJpbmcgdG9waWM6ICIgKyB0b3BpYy50b1N0cmlu\nZ1V0ZjgoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9uRmluaXNoZWQoY3R4LCB0b3Bp\nY1N1YnMpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmaW5hbCBB\ndG9taWNCb29sZWFuIGZhaWxlZCA9IG5ldyBBdG9taWNCb29sZWFuKCk7CiAg\nICAgICAgICAgICAgICAgICAgZmluYWwgQXRvbWljSW50ZWdlciBjb3VudCA9\nIG5ldyBBdG9taWNJbnRlZ2VyKCk7CgogICAgICAgICAgICAgICAgICAgIGZv\nciAoZmluYWwgU3RyaW5nIGNoaWxkIDogY2hpbGRyZW4pIHsKCiAgICAgICAg\nICAgICAgICAgICAgICAgIGZpbmFsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklk\nID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoY2hpbGQpOwogICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbCBTdHJpbmcgY2hpbGRQYXRoID0gcGF0aCAr\nICIvIiArIGNoaWxkOwoKICAgICAgICAgICAgICAgICAgICAgICAgemsuZ2V0\nRGF0YShjaGlsZFBhdGgsIGZhbHNlLCBuZXcgU2FmZUFzeW5jWktDYWxsYmFj\nay5EYXRhQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgs\nIE9iamVjdCBjdHgsIGJ5dGVbXSBkYXRhLCBTdGF0IHN0YXQpIHsKCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjICE9IENvZGUuT0su\naW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBLZWVwZXJFeGNlcHRpb24gZSA9IFprVXRpbHMubG9nRXJyb3JBbmRD\ncmVhdGVaS0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkIG5vdCBy\nZWFkIHN1YnNjcmlwdGlvbiBkYXRhIGZvciB0b3BpYzogIiArIHRvcGljLnRv\nU3RyaW5nVXRmOCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIiwgc3Vic2NyaWJlcklk\nOiAiICsgc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpLCBwYXRoLCByYyk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydEZh\naWx1cmUobmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlv\nbihlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsZWQuZ2V0KCkp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgVmVyc2lvbmVkPFN1YnNjcmlwdGlv\nbkRhdGE+IHN1YkRhdGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nc3ViRGF0YSA9IG5ldyBWZXJzaW9uZWQ8U3Vic2NyaXB0aW9uRGF0YT4oCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3Vi\nc2NyaXB0aW9uU3RhdGVVdGlscy5wYXJzZVN1YnNjcmlwdGlvbkRhdGEoZGF0\nYSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIG5ldyBaa1ZlcnNpb24oc3RhdC5nZXRWZXJzaW9uKCkpKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnZhbGlkUHJv\ndG9jb2xCdWZmZXJFeGNlcHRpb24gZXgpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgU3RyaW5nIG1zZyA9ICJGYWlsZWQgdG8gZGVz\nZXJpYWxpemUgc3Vic2NyaXB0aW9uIGRhdGEgZm9yIHRvcGljOiAiICsgdG9w\naWMudG9TdHJpbmdVdGY4KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgIiBzdWJzY3JpYmVySWQ6ICIgKyBz\ndWJzY3JpYmVySWQudG9TdHJpbmdVdGY4KCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihtc2csIGV4KTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0RmFpbHVy\nZShuZXcgUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRDb25kaXRpb25FeGNl\ncHRpb24obXNnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9\nCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2dnZXIu\naXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBsb2dnZXIuZGVidWcoIkZvdW5kIHN1YnNjcmlwdGlvbiB3\naGlsZSBhY3F1aXJpbmcgdG9waWM6ICIgKyB0b3BpYy50b1N0cmluZ1V0Zjgo\nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAiIHN1YnNjcmliZXJJZDogIiArIGNoaWxkICsgInN0YXRlOiAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICArIFN1YnNjcmlwdGlvblN0YXRlVXRpbHMudG9TdHJpbmcoc3ViRGF0\nYS5nZXRWYWx1ZSgpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3BpY1N1\nYnMucHV0KHN1YnNjcmliZXJJZCwgc3ViRGF0YSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKGNvdW50LmluY3JlbWVudEFuZEdldCgp\nID09IGNoaWxkcmVuLnNpemUoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBhc3NlcnQgdG9waWNTdWJzLnNpemUoKSA9PSBjb3Vu\ndC5nZXQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nY2Iub3BlcmF0aW9uRmluaXNoZWQoY3R4LCB0b3BpY1N1YnMpOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcml2\nYXRlIHZvaWQgcmVwb3J0RmFpbHVyZShQdWJTdWJFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsZWQuY29t\ncGFyZUFuZFNldChmYWxzZSwgdHJ1ZSkpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkZhaWxlZChjdHgsIGUpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgICAgICB9LCBjdHgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfSwgY3R4KTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBab29LZWVwZXIgYmFzZSB0b3BpYyBvd25l\ncnNoaXAgbWFuYWdlci4KICAgICAqLwogICAgc3RhdGljIGNsYXNzIFprVG9w\naWNPd25lcnNoaXBNYW5hZ2VySW1wbCBpbXBsZW1lbnRzIFRvcGljT3duZXJz\naGlwTWFuYWdlciB7CgogICAgICAgIFpvb0tlZXBlciB6azsKICAgICAgICBT\nZXJ2ZXJDb25maWd1cmF0aW9uIGNmZzsKCiAgICAgICAgWmtUb3BpY093bmVy\nc2hpcE1hbmFnZXJJbXBsKFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiwgWm9v\nS2VlcGVyIHprKSB7CiAgICAgICAgICAgIHRoaXMuY2ZnID0gY29uZjsKICAg\nICAgICAgICAgdGhpcy56ayA9IHprOwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9F\neGNlcHRpb24gewogICAgICAgICAgICAvLyBkbyBub3RoaW5nIGluIHpvb2tl\nZXBlciBiYXNlZCBpbXBsCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAg\nICAgKiBSZXR1cm4gem5vZGUgcGF0aCB0byBzdG9yZSB0b3BpYyBvd25lci4K\nICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB0b3BpYwogICAgICAgICAq\nICAgICAgICAgIFRvcGljIE5hbWUKICAgICAgICAgKiBAcmV0dXJuIHpub2Rl\nIHBhdGggdG8gc3RvcmUgdG9waWMgb3duZXIuCiAgICAgICAgICovCiAgICAg\nICAgU3RyaW5nIGh1YlBhdGgoQnl0ZVN0cmluZyB0b3BpYykgewogICAgICAg\nICAgICByZXR1cm4gY2ZnLmdldFprVG9waWNQYXRoKG5ldyBTdHJpbmdCdWls\nZGVyKCksIHRvcGljKS5hcHBlbmQoIi9odWIiKS50b1N0cmluZygpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\ncmVhZE93bmVySW5mbyhmaW5hbCBCeXRlU3RyaW5nIHRvcGljLCBmaW5hbCBD\nYWxsYmFjazxWZXJzaW9uZWQ8SHViSW5mbz4+IGNhbGxiYWNrLCBPYmplY3Qg\nY3R4KSB7CiAgICAgICAgICAgIFN0cmluZyBvd25lclBhdGggPSBodWJQYXRo\nKHRvcGljKTsKICAgICAgICAgICAgemsuZ2V0RGF0YShvd25lclBhdGgsIGZh\nbHNlLCBuZXcgU2FmZUFzeW5jWktDYWxsYmFjay5EYXRhQ2FsbGJhY2soKSB7\nCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHNhZmVQcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBh\ndGgsIE9iamVjdCBjdHgsIGJ5dGVbXSBkYXRhLCBTdGF0IHN0YXQpIHsKICAg\nICAgICAgICAgICAgICAgICBpZiAoQ29kZS5OT05PREUuaW50VmFsdWUoKSA9\nPSByYykgewogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVy\nYXRpb25GaW5pc2hlZChjdHgsIG51bGwpOwogICAgICAgICAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgICAgICAgICBpZiAoQ29kZS5PSy5pbnRWYWx1ZSgpICE9IHJjKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlvbiBlID0gWmtV\ndGlscy5sb2dFcnJvckFuZENyZWF0ZVpLRXhjZXB0aW9uKCJDb3VsZCBub3Qg\ncmVhZCBvd25lcnNoaXAgZm9yIHRvcGljOiAiCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB0b3BpYy50b1N0cmluZ1V0\nZjgoKSwgcGF0aCwgcmMpOwogICAgICAgICAgICAgICAgICAgICAgICBjYWxs\nYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9u\nLlNlcnZpY2VEb3duRXhjZXB0aW9uKGUpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICBIdWJJbmZvIG93bmVyID0gbnVsbDsKICAgICAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBvd25lciA9\nIEh1YkluZm8ucGFyc2UobmV3IFN0cmluZyhkYXRhLCBVVEZfOCkpOwogICAg\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEh1YkluZm8uSW52YWxpZEh1Yklu\nZm9FeGNlcHRpb24gaWhpZSkgewogICAgICAgICAgICAgICAgICAgICAgICBs\nb2dnZXIud2FybigiRmFpbGVkIHRvIHBhcnNlIGh1YiBpbmZvIGZvciB0b3Bp\nYyAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAiIDogIiwgaWhpZSk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGludCB2\nZXJzaW9uID0gc3RhdC5nZXRWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICAg\nICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBuZXcgVmVyc2lv\nbmVkPEh1YkluZm8+KG93bmVyLCBuZXcgWmtWZXJzaW9uKHZlcnNpb24pKSk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9LCBjdHgpOwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgd3JpdGVPd25lckluZm8oZmlu\nYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgSHViSW5mbyBvd25lciwgZmlu\nYWwgVmVyc2lvbiB2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGZpbmFsIENhbGxiYWNrPFZlcnNpb24+IGNhbGxiYWNrLCBP\nYmplY3QgY3R4KSB7CiAgICAgICAgICAgIGlmIChWZXJzaW9uLk5FVyA9PSB2\nZXJzaW9uKSB7CiAgICAgICAgICAgICAgICBjcmVhdGVPd25lckluZm8odG9w\naWMsIG93bmVyLCBjYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEodmVyc2lv\nbiBpbnN0YW5jZW9mIFprVmVyc2lvbikpIHsKICAgICAgICAgICAgICAgIGNh\nbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRp\nb24uVW5leHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbigKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJJbnZhbGlkIHZl\ncnNpb24gcHJvdmlkZWQgdG8gdXBkYXRlIG93bmVyIGluZm8gZm9yIHRvcGlj\nICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSkpOwogICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpbnQgem5vZGVW\nZXJzaW9uID0gKChaa1ZlcnNpb24pdmVyc2lvbikuZ2V0Wm5vZGVWZXJzaW9u\nKCk7CiAgICAgICAgICAgIHprLnNldERhdGEoaHViUGF0aCh0b3BpYyksIG93\nbmVyLnRvU3RyaW5nKCkuZ2V0Qnl0ZXMoVVRGXzgpLCB6bm9kZVZlcnNpb24s\nCiAgICAgICAgICAgICAgICAgICAgICAgbmV3IFNhZmVBc3luY1pLQ2FsbGJh\nY2suU3RhdENhbGxiYWNrKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBzYWZlUHJvY2Vzc1Jlc3Vs\ndChpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4LCBTdGF0IHN0YXQp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmMgPT0gQ29kZS5OT05PREUu\naW50VmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBu\nb2RlCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlv\nbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29k\nZS5OT19UT1BJQ19PV05FUl9JTkZPLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm8gb3duZXIgaW5m\nbyBmb3VuZCBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpKSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9IGVsc2UgaWYgKHJjID09IENvZGUuQkFEVkVSU0lPTi5pbnRW\nYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhZCB2ZXJz\naW9uCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlv\nbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29k\nZS5CQURfVkVSU0lPTiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIkJhZCB2ZXJzaW9uIHByb3ZpZGVk\nIHRvIHVwZGF0ZSBvd25lciBpbmZvIG9mIHRvcGljICIgKyB0b3BpYy50b1N0\ncmluZ1V0ZjgoKSkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChDb2RlLk9LLmludFZh\nbHVlKCkgPT0gcmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJh\nY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBuZXcgWmtWZXJzaW9uKHN0YXQu\nZ2V0VmVyc2lvbigpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24gZSA9IFprVXRpbHMubG9nRXJy\nb3JBbmRDcmVhdGVaS0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICJGYWlsZWQgdG8gdXBkYXRlIG93bmVyc2hpcCBvZiB0b3BpYyAi\nICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIiB0byAiICsgb3duZXIsIHBhdGgsIHJjKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwg\nbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbihlKSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGN0\neCk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgdm9pZCBjcmVhdGVP\nd25lckluZm8oZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgSHViSW5m\nbyBvd25lciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZmluYWwgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9iamVjdCBj\ndHgpIHsKICAgICAgICAgICAgU3RyaW5nIG93bmVyUGF0aCA9IGh1YlBhdGgo\ndG9waWMpOwogICAgICAgICAgICBaa1V0aWxzLmNyZWF0ZUZ1bGxQYXRoT3B0\naW1pc3RpYyh6aywgb3duZXJQYXRoLCBvd25lci50b1N0cmluZygpLmdldEJ5\ndGVzKFVURl84KSwgSWRzLk9QRU5fQUNMX1VOU0FGRSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ3JlYXRlTW9kZS5Q\nRVJTSVNURU5ULCBuZXcgU2FmZUFzeW5jWktDYWxsYmFjay5TdHJpbmdDYWxs\nYmFjaygpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2FmZVByb2Nlc3NSZXN1bHQoaW50IHJjLCBT\ndHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgU3RyaW5nIG5hbWUpIHsKICAgICAg\nICAgICAgICAgICAgICBpZiAoQ29kZS5PSy5pbnRWYWx1ZSgpID09IHJjKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzc3VtZSB0aGUgaW5pdGlh\nbCB2ZXJzaW9uIGlzIDAKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJh\nY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBuZXcgWmtWZXJzaW9uKDApKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgICAgIH0gZWxzZSBpZiAoQ29kZS5OT0RFRVhJU1RTLmludFZhbHVlKCkg\nPT0gcmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9kZSBleGlz\ndGVkCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlv\nbkZhaWxlZChjdHgsIFB1YlN1YkV4Y2VwdGlvbi5jcmVhdGUoU3RhdHVzQ29k\nZS5UT1BJQ19PV05FUl9JTkZPX0VYSVNUUywKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk93bmVyIGlu\nZm8gb2YgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsgIiBleGlz\ndGVkLiIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIEtlZXBlckV4Y2VwdGlvbiBlID0gWmtVdGlscy5sb2dFcnJvckFuZENy\nZWF0ZVpLRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAiRmFpbGVkIHRvIGNyZWF0ZSB6bm9kZSBm\nb3Igb3duZXJzaGlwIG9mIHRvcGljOiAiCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgdG9waWMudG9TdHJpbmdV\ndGY4KCksIHBhdGgsIHJjKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2Fs\nbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlv\nbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0sIGN0eCk7CiAgICAgICAgfQoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBkZWxldGVPd25l\nckluZm8oZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgVmVyc2lvbiB2\nZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBm\naW5hbCBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewog\nICAgICAgICAgICBpbnQgem5vZGVWZXJzaW9uID0gLTE7CiAgICAgICAgICAg\nIGlmIChWZXJzaW9uLkFOWSAhPSB2ZXJzaW9uKSB7CiAgICAgICAgICAgICAg\nICBpZiAoISh2ZXJzaW9uIGluc3RhbmNlb2YgWmtWZXJzaW9uKSkgewogICAg\nICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgs\nIG5ldyBQdWJTdWJFeGNlcHRpb24uVW5leHBlY3RlZENvbmRpdGlvbkV4Y2Vw\ndGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAiSW52YWxpZCB2ZXJzaW9uIHByb3ZpZGVkIHRvIGRlbGV0\nZSBvd25lciBpbmZvIGZvciB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4\nKCkpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHpub2RlVmVyc2lv\nbiA9ICgoWmtWZXJzaW9uKXZlcnNpb24pLmdldFpub2RlVmVyc2lvbigpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB6\nay5kZWxldGUoaHViUGF0aCh0b3BpYyksIHpub2RlVmVyc2lvbiwgbmV3IFNh\nZmVBc3luY1pLQ2FsbGJhY2suVm9pZENhbGxiYWNrKCkgewogICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBz\nYWZlUHJvY2Vzc1Jlc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3Qg\nY3R4KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKENvZGUuT0suaW50VmFs\ndWUoKSA9PSByYykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9n\nZ2VyLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGxvZ2dlci5kZWJ1ZygiU3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgb3du\nZXIgaW5mbyBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpICsg\nIi4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjdHgsIG51\nbGwpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgICAgICAgICAgfSBlbHNlIGlmIChDb2RlLk5PTk9ERS5pbnRWYWx1ZSgp\nID09IHJjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIG5vZGUK\nICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFp\nbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2RlLk5P\nX1RPUElDX09XTkVSX0lORk8sCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICJObyBvd25lciBpbmZvIGZv\ndW5kIGZvciB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkpKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAg\nICAgIH0gZWxzZSBpZiAoQ29kZS5CQURWRVJTSU9OLmludFZhbHVlKCkgPT0g\ncmMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFkIHZlcnNpb24K\nICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFp\nbGVkKGN0eCwgUHViU3ViRXhjZXB0aW9uLmNyZWF0ZShTdGF0dXNDb2RlLkJB\nRF9WRVJTSU9OLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAiQmFkIHZlcnNpb24gcHJvdmlkZWQgdG8g\nZGVsZXRlIG93bmVyIGluZm8gb2YgdG9waWMgIiArIHRvcGljLnRvU3RyaW5n\nVXRmOCgpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICBLZWVwZXJFeGNlcHRpb24gZSA9IFprVXRpbHMubG9nRXJyb3JBbmRD\ncmVhdGVaS0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIkZhaWxlZCB0byBkZWxldGUgb3duZXIg\naW5mbyBmb3IgdG9waWMgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpLCBw\nYXRoLCByYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9w\nZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2Vydmlj\nZURvd25FeGNlcHRpb24oZSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgY3R4KTsKICAgICAgICB9\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBmb3JtYXQo\nU2VydmVyQ29uZmlndXJhdGlvbiBjZmcsIFpvb0tlZXBlciB6aykgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBaS1V0\naWwuZGVsZXRlUmVjdXJzaXZlKHprLCBjZmcuZ2V0WmtUb3BpY3NQcmVmaXgo\nbmV3IFN0cmluZ0J1aWxkZXIoKSkudG9TdHJpbmcoKSk7CiAgICAgICAgfSBj\nYXRjaCAoS2VlcGVyRXhjZXB0aW9uLk5vTm9kZUV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiSGVkd2lnIHJvb3Qgbm9kZSBkb2Vz\nbid0IGV4aXN0IGluIHpvb2tlZXBlciB0byBkZWxldGUiKTsKICAgICAgICB9\nIGNhdGNoIChLZWVwZXJFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IElPRXhjZXB0aW9uKGtlKTsKICAgICAgICB9IGNhdGNoIChJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nSU9FeGNlcHRpb24oaWUpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

