{"sha":"a3be99a1d4add961fd794c3bdbed1988ef0c00ae","node_id":"MDQ6QmxvYjE1NzU5NTY6YTNiZTk5YTFkNGFkZDk2MWZkNzk0YzNiZGJlZDE5ODhlZjBjMDBhZQ==","size":6702,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a3be99a1d4add961fd794c3bdbed1988ef0c00ae","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubmV0dHk7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5NYXA7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuQ2hh\nbm5lbDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxG\ndXR1cmU7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5DaGFubmVs\nRnV0dXJlTGlzdGVuZXI7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5l\nbC5DaGFubmVsSGFuZGxlckNvbnRleHQ7CmltcG9ydCBvcmcuamJvc3MubmV0\ndHkuY2hhbm5lbC5DaGFubmVsSGFuZGxlci5TaGFyYWJsZTsKaW1wb3J0IG9y\nZy5qYm9zcy5uZXR0eS5jaGFubmVsLkNoYW5uZWxTdGF0ZUV2ZW50OwppbXBv\ncnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuRXhjZXB0aW9uRXZlbnQ7Cmlt\ncG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5NZXNzYWdlRXZlbnQ7Cmlt\ncG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5TaW1wbGVDaGFubmVsSGFu\nZGxlcjsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLmdyb3VwLkNo\nYW5uZWxHcm91cDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5oYW5kbGVyLmNv\nZGVjLmZyYW1lLkNvcnJ1cHRlZEZyYW1lRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmpib3NzLm5ldHR5LmhhbmRsZXIuY29kZWMuZnJhbWUuVG9vTG9uZ0ZyYW1l\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmhhbmRsZXIuc3Ns\nLlNzbEhhbmRsZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0\naW9ucy5QdWJTdWJFeGNlcHRpb24uTWFsZm9ybWVkUmVxdWVzdEV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlB1YlN1YlJlc3BvbnNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25zLlB1\nYlN1YlJlc3BvbnNlVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5z\nZXJ2ZXIuaGFuZGxlcnMuQ2hhbm5lbERpc2Nvbm5lY3RMaXN0ZW5lcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVycy5IYW5kbGVy\nOwoKQFNoYXJhYmxlCnB1YmxpYyBjbGFzcyBVbWJyZWxsYUhhbmRsZXIgZXh0\nZW5kcyBTaW1wbGVDaGFubmVsSGFuZGxlciB7CiAgICBzdGF0aWMgTG9nZ2Vy\nIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFVtYnJlbGxhSGFu\nZGxlci5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBNYXA8T3BlcmF0aW9u\nVHlwZSwgSGFuZGxlcj4gaGFuZGxlcnM7CiAgICBwcml2YXRlIGZpbmFsIENo\nYW5uZWxHcm91cCBhbGxDaGFubmVsczsKICAgIHByaXZhdGUgZmluYWwgQ2hh\nbm5lbERpc2Nvbm5lY3RMaXN0ZW5lciBjaGFubmVsRGlzY29ubmVjdExpc3Rl\nbmVyOwogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIGlzU1NMRW5hYmxlZDsg\nCgogICAgcHVibGljIFVtYnJlbGxhSGFuZGxlcihDaGFubmVsR3JvdXAgYWxs\nQ2hhbm5lbHMsIE1hcDxPcGVyYXRpb25UeXBlLCBIYW5kbGVyPiBoYW5kbGVy\ncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2hhbm5lbERpc2Nvbm5l\nY3RMaXN0ZW5lciBjaGFubmVsRGlzY29ubmVjdExpc3RlbmVyLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICBib29sZWFuIGlzU1NMRW5hYmxlZCkgewog\nICAgICAgIHRoaXMuYWxsQ2hhbm5lbHMgPSBhbGxDaGFubmVsczsKICAgICAg\nICB0aGlzLmlzU1NMRW5hYmxlZCA9IGlzU1NMRW5hYmxlZDsKICAgICAgICB0\naGlzLmhhbmRsZXJzID0gaGFuZGxlcnM7CiAgICAgICAgdGhpcy5jaGFubmVs\nRGlzY29ubmVjdExpc3RlbmVyID0gY2hhbm5lbERpc2Nvbm5lY3RMaXN0ZW5l\ncjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGV4Y2Vw\ndGlvbkNhdWdodChDaGFubmVsSGFuZGxlckNvbnRleHQgY3R4LCBFeGNlcHRp\nb25FdmVudCBlKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBUaHJvd2Fi\nbGUgdGhyb3dhYmxlID0gZS5nZXRDYXVzZSgpOwoKICAgICAgICAvLyBBZGQg\naGVyZSBpZiB0aGVyZSBhcmUgbW9yZSBleGNlcHRpb25zIHdlIG5lZWQgdG8g\nYmUgYWJsZSB0byB0b2xlcmF0ZS4KICAgICAgICAvLyAxLiBJT0V4Y2VwdGlv\nbiBtYXkgYmUgdGhyb3duIHdoZW4gYSBjaGFubmVsIGlzIGZvcmNlZnVsbHkg\nY2xvc2VkIGJ5CiAgICAgICAgLy8gdGhlIG90aGVyIGVuZCwgb3IgYnkgdGhl\nIFByb3RvYnVmRGVjb2RlciB3aGVuIGFuIGludmFsaWQgcHJvdG9idWYgaXMK\nICAgICAgICAvLyByZWNlaXZlZAogICAgICAgIC8vIDIuIFRvb0xvbmdGcmFt\nZUV4Y2VwdGlvbiBpcyB0aHJvd24gYnkgdGhlIExlbmd0aEJhc2VkRGVjb2Rl\nciBpZiBpdAogICAgICAgIC8vIHJlY2VpdmVzIGEgcGFja2V0IHRoYXQgaXMg\ndG9vIGJpZwogICAgICAgIC8vIDMuIENvcnJ1cHRlZEZyYW1FeGNlcHRpb24g\naXMgdGhyb3duIGJ5IHRoZSBMZW5ndGhCYXNlZERlY29kZXIgd2hlbgogICAg\nICAgIC8vIHRoZSBsZW5ndGggaXMgbmVnYXRpdmUgZXRjLgogICAgICAgIGlm\nICh0aHJvd2FibGUgaW5zdGFuY2VvZiBJT0V4Y2VwdGlvbiB8fCB0aHJvd2Fi\nbGUgaW5zdGFuY2VvZiBUb29Mb25nRnJhbWVFeGNlcHRpb24KICAgICAgICAg\nICAgICAgIHx8IHRocm93YWJsZSBpbnN0YW5jZW9mIENvcnJ1cHRlZEZyYW1l\nRXhjZXB0aW9uKSB7CiAgICAgICAgICAgIGUuZ2V0Q2hhbm5lbCgpLmNsb3Nl\nKCk7CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVW5jYXVnaHQgZXhjZXB0\naW9uIiwgdGhyb3dhYmxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAvLyBjYWxsIG91ciB1bmNhdWdodCBleGNlcHRpb24gaGFuZGxlciwgd2hp\nY2ggbWlnaHQgZGVjaWRlIHRvCiAgICAgICAgICAgIC8vIHNodXRkb3duIHRo\nZSBzeXN0ZW0KICAgICAgICAgICAgVGhyZWFkIHRocmVhZCA9IFRocmVhZC5j\ndXJyZW50VGhyZWFkKCk7CiAgICAgICAgICAgIHRocmVhZC5nZXRVbmNhdWdo\ndEV4Y2VwdGlvbkhhbmRsZXIoKS51bmNhdWdodEV4Y2VwdGlvbih0aHJlYWQs\nIHRocm93YWJsZSk7CiAgICAgICAgfQoKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyB2b2lkIGNoYW5uZWxPcGVuKENoYW5uZWxIYW5kbGVyQ29u\ndGV4dCBjdHgsIENoYW5uZWxTdGF0ZUV2ZW50IGUpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIC8vIElmIFNTTCBpcyBOT1QgZW5hYmxlZCwgdGhlbiB3\nZSBjYW4gYWRkIHRoaXMgY2hhbm5lbCB0byB0aGUKICAgICAgICAvLyBDaGFu\nbmVsR3JvdXAuIE90aGVyd2lzZSwgdGhhdCBpcyBkb25lIHdoZW4gdGhlIGNo\nYW5uZWwgaXMgY29ubmVjdGVkCiAgICAgICAgLy8gYW5kIHRoZSBTU0wgaGFu\nZHNoYWtlIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LgogICAgICAgIGlm\nICghaXNTU0xFbmFibGVkKSB7CiAgICAgICAgICAgIGFsbENoYW5uZWxzLmFk\nZChjdHguZ2V0Q2hhbm5lbCgpKTsKICAgICAgICB9CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjaGFubmVsQ29ubmVjdGVkKENoYW5u\nZWxIYW5kbGVyQ29udGV4dCBjdHgsIENoYW5uZWxTdGF0ZUV2ZW50IGUpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChpc1NTTEVuYWJsZWQpIHsK\nICAgICAgICAgICAgY3R4LmdldFBpcGVsaW5lKCkuZ2V0KFNzbEhhbmRsZXIu\nY2xhc3MpLmhhbmRzaGFrZSgpLmFkZExpc3RlbmVyKG5ldyBDaGFubmVsRnV0\ndXJlTGlzdGVuZXIoKSB7CiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBv\ncGVyYXRpb25Db21wbGV0ZShDaGFubmVsRnV0dXJlIGZ1dHVyZSkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZ1dHVyZS5p\nc1N1Y2Nlc3MoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu\nZGVidWcoIlNTTCBoYW5kc2hha2UgaGFzIGNvbXBsZXRlZCBzdWNjZXNzZnVs\nbHkhIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsbENoYW5uZWxzLmFk\nZChmdXR1cmUuZ2V0Q2hhbm5lbCgpKTsKICAgICAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBmdXR1cmUuZ2V0Q2hh\nbm5lbCgpLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjaGFubmVsRGlzY29ubmVj\ndGVkKENoYW5uZWxIYW5kbGVyQ29udGV4dCBjdHgsIENoYW5uZWxTdGF0ZUV2\nZW50IGUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENoYW5uZWwgY2hh\nbm5lbCA9IGN0eC5nZXRDaGFubmVsKCk7CiAgICAgICAgLy8gc3Vic2NyaWJl\nIGhhbmRsZXIgbmVlZHMgdG8ga25vdyBhYm91dCBjaGFubmVsIGRpc2Nvbm5l\nY3RzCiAgICAgICAgY2hhbm5lbERpc2Nvbm5lY3RMaXN0ZW5lci5jaGFubmVs\nRGlzY29ubmVjdGVkKGNoYW5uZWwpOwogICAgICAgIGNoYW5uZWwuY2xvc2Uo\nKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2VuZEVycm9yUmVz\ncG9uc2VUb01hbGZvcm1lZFJlcXVlc3QoQ2hhbm5lbCBjaGFubmVsLCBsb25n\nIHR4bklkLCBTdHJpbmcgbXNnKSB7CiAgICAgICAgbG9nZ2VyLmRlYnVnKCJN\nYWxmb3JtZWQgcmVxdWVzdCBmcm9tIHt9LCBtc2cgPSB7fSIsIGNoYW5uZWwu\nZ2V0UmVtb3RlQWRkcmVzcygpLCBtc2cpOwogICAgICAgIE1hbGZvcm1lZFJl\ncXVlc3RFeGNlcHRpb24gbXJlID0gbmV3IE1hbGZvcm1lZFJlcXVlc3RFeGNl\ncHRpb24obXNnKTsKICAgICAgICBQdWJTdWJSZXNwb25zZSByZXNwb25zZSA9\nIFB1YlN1YlJlc3BvbnNlVXRpbHMuZ2V0UmVzcG9uc2VGb3JFeGNlcHRpb24o\nbXJlLCB0eG5JZCk7CiAgICAgICAgY2hhbm5lbC53cml0ZShyZXNwb25zZSk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBtZXNzYWdl\nUmVjZWl2ZWQoQ2hhbm5lbEhhbmRsZXJDb250ZXh0IGN0eCwgTWVzc2FnZUV2\nZW50IGUpIHRocm93cyBFeGNlcHRpb24gewoKICAgICAgICBpZiAoIShlLmdl\ndE1lc3NhZ2UoKSBpbnN0YW5jZW9mIFB1YlN1YlByb3RvY29sLlB1YlN1YlJl\ncXVlc3QpKSB7CiAgICAgICAgICAgIGN0eC5zZW5kVXBzdHJlYW0oZSk7CiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIFB1YlN1YlBy\nb3RvY29sLlB1YlN1YlJlcXVlc3QgcmVxdWVzdCA9IChQdWJTdWJQcm90b2Nv\nbC5QdWJTdWJSZXF1ZXN0KSBlLmdldE1lc3NhZ2UoKTsKCiAgICAgICAgSGFu\nZGxlciBoYW5kbGVyID0gaGFuZGxlcnMuZ2V0KHJlcXVlc3QuZ2V0VHlwZSgp\nKTsKICAgICAgICBDaGFubmVsIGNoYW5uZWwgPSBjdHguZ2V0Q2hhbm5lbCgp\nOwogICAgICAgIGxvbmcgdHhuSWQgPSByZXF1ZXN0LmdldFR4bklkKCk7Cgog\nICAgICAgIGlmIChoYW5kbGVyID09IG51bGwpIHsKICAgICAgICAgICAgc2Vu\nZEVycm9yUmVzcG9uc2VUb01hbGZvcm1lZFJlcXVlc3QoY2hhbm5lbCwgdHhu\nSWQsICJSZXF1ZXN0IHR5cGUgIiArIHJlcXVlc3QuZ2V0VHlwZSgpLmdldE51\nbWJlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIiB1bmtub3duIik7CiAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICB9CgogICAgICAgIGhhbmRsZXIuaGFuZGxlUmVxdWVzdChyZXF1\nZXN0LCBjaGFubmVsKTsKICAgICAgICBTZXJ2ZXJTdGF0cy5nZXRJbnN0YW5j\nZSgpLmluY3JlbWVudFJlcXVlc3RzUmVjZWl2ZWQoKTsKICAgIH0KCn0K\n","encoding":"base64"}

