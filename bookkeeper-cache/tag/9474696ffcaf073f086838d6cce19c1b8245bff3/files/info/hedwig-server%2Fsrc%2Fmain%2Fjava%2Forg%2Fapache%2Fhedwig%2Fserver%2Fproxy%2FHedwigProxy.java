{"sha":"b01f179688b80f6c1acfd89635cb54a633aa016b","node_id":"MDQ6QmxvYjE1NzU5NTY6YjAxZjE3OTY4OGI4MGY2YzFhY2ZkODk2MzVjYjU0YTYzM2FhMDE2Yg==","size":7645,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/b01f179688b80f6c1acfd89635cb54a633aa016b","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucHJveHk7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5sYW5nLlRocmVhZC5VbmNhdWdo\ndEV4Y2VwdGlvbkhhbmRsZXI7CmltcG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0\nQWRkcmVzczsKaW1wb3J0IGphdmEubmV0Lk1hbGZvcm1lZFVSTEV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4ZWN1dG9yczsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2NraW5nUXVl\ndWU7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5D\nb25maWd1cmF0aW9uRXhjZXB0aW9uOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3Jn\nLmpib3NzLm5ldHR5LmJvb3RzdHJhcC5TZXJ2ZXJCb290c3RyYXA7CmltcG9y\ndCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5ncm91cC5DaGFubmVsR3JvdXA7\nCmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5ncm91cC5EZWZhdWx0\nQ2hhbm5lbEdyb3VwOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwu\nc29ja2V0LlNlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5OwppbXBvcnQgb3Jn\nLmpib3NzLm5ldHR5LmNoYW5uZWwuc29ja2V0Lm5pby5OaW9TZXJ2ZXJTb2Nr\nZXRDaGFubmVsRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5sb2dn\naW5nLkludGVybmFsTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5u\nZXR0eS5sb2dnaW5nLkxvZzRKTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuSGVkd2lnQ2xpZW50OwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0\naW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21t\nb24uVGVybWluYXRlSlZNRXhjZXB0aW9uSGFuZGxlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVycy5DaGFubmVsRGlzY29ubmVj\ndExpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmhh\nbmRsZXJzLkhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2\nZXIubmV0dHkuUHViU3ViU2VydmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLm5ldHR5LlB1YlN1YlNlcnZlclBpcGVsaW5lRmFjdG9yeTsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5uZXR0eS5VbWJyZWxs\nYUhhbmRsZXI7CgppbXBvcnQgY29tLmdvb2dsZS5jb21tb24udXRpbC5jb25j\ndXJyZW50LlRocmVhZEZhY3RvcnlCdWlsZGVyOwoKcHVibGljIGNsYXNzIEhl\nZHdpZ1Byb3h5IHsKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSGVkd2lnUHJveHkuY2xhc3MpOwoK\nICAgIEhlZHdpZ0NsaWVudCBjbGllbnQ7CiAgICBTZXJ2ZXJTb2NrZXRDaGFu\nbmVsRmFjdG9yeSBzZXJ2ZXJTb2NrZXRDaGFubmVsRmFjdG9yeTsKICAgIENo\nYW5uZWxHcm91cCBhbGxDaGFubmVsczsKICAgIE1hcDxPcGVyYXRpb25UeXBl\nLCBIYW5kbGVyPiBoYW5kbGVyczsKICAgIFByb3h5Q29uZmlndXJhdGlvbiBj\nZmc7CiAgICBDaGFubmVsVHJhY2tlciB0cmFja2VyOwogICAgVGhyZWFkR3Jv\ndXAgdGc7CgogICAgcHVibGljIEhlZHdpZ1Byb3h5KGZpbmFsIFByb3h5Q29u\nZmlndXJhdGlvbiBjZmcsIGZpbmFsIFVuY2F1Z2h0RXhjZXB0aW9uSGFuZGxl\nciBleGNlcHRpb25IYW5kbGVyKSB7CiAgICAgICAgdGhpcy5jZmcgPSBjZmc7\nCgogICAgICAgIHRnID0gbmV3IFRocmVhZEdyb3VwKCJoZWR3aWdwcm94eSIp\nIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHVuY2F1Z2h0RXhjZXB0aW9uKFRocmVhZCB0LCBUaHJvd2FibGUgZSkg\newogICAgICAgICAgICAgICAgZXhjZXB0aW9uSGFuZGxlci51bmNhdWdodEV4\nY2VwdGlvbih0LCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICB9\nCgogICAgcHVibGljIEhlZHdpZ1Byb3h5KFByb3h5Q29uZmlndXJhdGlvbiBj\nb25mKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIHRo\naXMoY29uZiwgbmV3IFRlcm1pbmF0ZUpWTUV4Y2VwdGlvbkhhbmRsZXIoKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc3RhcnQoKSB0aHJvd3MgSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gewogICAgICAgIGZpbmFsIExpbmtlZEJsb2NraW5n\nUXVldWU8Qm9vbGVhbj4gcXVldWUgPSBuZXcgTGlua2VkQmxvY2tpbmdRdWV1\nZTxCb29sZWFuPigpOwoKICAgICAgICBuZXcgVGhyZWFkKHRnLCBuZXcgUnVu\nbmFibGUoKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICBjbGllbnQgPSBu\nZXcgSGVkd2lnQ2xpZW50KGNmZyk7CiAgICAgICAgICAgICAgICBUaHJlYWRG\nYWN0b3J5QnVpbGRlciB0ZmIgPSBuZXcgVGhyZWFkRmFjdG9yeUJ1aWxkZXIo\nKTsKICAgICAgICAgICAgICAgIHNlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5\nID0gbmV3IE5pb1NlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5KAogICAgICAg\nICAgICAgICAgICAgICAgICBFeGVjdXRvcnMubmV3Q2FjaGVkVGhyZWFkUG9v\nbCh0ZmIuc2V0TmFtZUZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAiSGVkd2lnUHJveHktTklPQm9zcy0lZCIpLmJ1aWxkKCkpLAog\nICAgICAgICAgICAgICAgICAgICAgICBFeGVjdXRvcnMubmV3Q2FjaGVkVGhy\nZWFkUG9vbCh0ZmIuc2V0TmFtZUZvcm1hdCgKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAiSGVkd2lnUHJveHktTklPV29ya2VyLSVkIikuYnVp\nbGQoKSkpOwogICAgICAgICAgICAgICAgaW5pdGlhbGl6ZUhhbmRsZXJzKCk7\nCiAgICAgICAgICAgICAgICBpbml0aWFsaXplTmV0dHkoKTsKCiAgICAgICAg\nICAgICAgICBxdWV1ZS5vZmZlcih0cnVlKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0pLnN0YXJ0KCk7CgogICAgICAgIHF1ZXVlLnRha2UoKTsKICAgIH0K\nCiAgICAvLyB1c2VkIGZvciB0ZXN0aW5nCiAgICBwdWJsaWMgQ2hhbm5lbFRy\nYWNrZXIgZ2V0Q2hhbm5lbFRyYWNrZXIoKSB7CiAgICAgICAgcmV0dXJuIHRy\nYWNrZXI7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgaW5pdGlhbGl6ZUhh\nbmRsZXJzKCkgewogICAgICAgIGhhbmRsZXJzID0gbmV3IEhhc2hNYXA8T3Bl\ncmF0aW9uVHlwZSwgSGFuZGxlcj4oKTsKICAgICAgICB0cmFja2VyID0gbmV3\nIENoYW5uZWxUcmFja2VyKGNsaWVudC5nZXRTdWJzY3JpYmVyKCkpOwoKICAg\nICAgICBoYW5kbGVycy5wdXQoT3BlcmF0aW9uVHlwZS5QVUJMSVNILCBuZXcg\nUHJveHlQdWJsaXNoSGFuZGVyKGNsaWVudC5nZXRQdWJsaXNoZXIoKSkpOwog\nICAgICAgIGhhbmRsZXJzLnB1dChPcGVyYXRpb25UeXBlLlNVQlNDUklCRSwg\nbmV3IFByb3h5U3Vic2NyaWJlSGFuZGxlcihjbGllbnQuZ2V0U3Vic2NyaWJl\ncigpLCB0cmFja2VyKSk7CiAgICAgICAgaGFuZGxlcnMucHV0KE9wZXJhdGlv\nblR5cGUuVU5TVUJTQ1JJQkUsIG5ldyBQcm94eVVuc3Vic2NyaWJlSGFuZGxl\ncihjbGllbnQuZ2V0U3Vic2NyaWJlcigpLCB0cmFja2VyKSk7CiAgICAgICAg\naGFuZGxlcnMucHV0KE9wZXJhdGlvblR5cGUuQ09OU1VNRSwgbmV3IFByb3h5\nQ29uc3VtZUhhbmRsZXIoY2xpZW50LmdldFN1YnNjcmliZXIoKSkpOwogICAg\nICAgIGhhbmRsZXJzLnB1dChPcGVyYXRpb25UeXBlLlNUT1BfREVMSVZFUlks\nIG5ldyBQcm94eVN0b3BEZWxpdmVyeUhhbmRsZXIoY2xpZW50LmdldFN1YnNj\ncmliZXIoKSwgdHJhY2tlcikpOwogICAgICAgIGhhbmRsZXJzLnB1dChPcGVy\nYXRpb25UeXBlLlNUQVJUX0RFTElWRVJZLCBuZXcgUHJveHlTdGFydERlbGl2\nZXJ5SGFuZGxlcihjbGllbnQuZ2V0U3Vic2NyaWJlcigpLCB0cmFja2VyKSk7\nCiAgICAgICAgaGFuZGxlcnMucHV0KE9wZXJhdGlvblR5cGUuQ0xPU0VTVUJT\nQ1JJUFRJT04sCiAgICAgICAgICAgICAgICAgICAgIG5ldyBQcm94eUNsb3Nl\nU3Vic2NyaXB0aW9uSGFuZGxlcihjbGllbnQuZ2V0U3Vic2NyaWJlcigpLCB0\ncmFja2VyKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgaW5pdGlhbGl6\nZU5ldHR5KCkgewogICAgICAgIEludGVybmFsTG9nZ2VyRmFjdG9yeS5zZXRE\nZWZhdWx0RmFjdG9yeShuZXcgTG9nNEpMb2dnZXJGYWN0b3J5KCkpOwogICAg\nICAgIGFsbENoYW5uZWxzID0gbmV3IERlZmF1bHRDaGFubmVsR3JvdXAoImhl\nZHdpZ3Byb3h5Iik7CiAgICAgICAgU2VydmVyQm9vdHN0cmFwIGJvb3RzdHJh\ncCA9IG5ldyBTZXJ2ZXJCb290c3RyYXAoc2VydmVyU29ja2V0Q2hhbm5lbEZh\nY3RvcnkpOwogICAgICAgIENoYW5uZWxEaXNjb25uZWN0TGlzdGVuZXIgZGlz\nY29ubmVjdExpc3RlbmVyID0KICAgICAgICAgICAgKENoYW5uZWxEaXNjb25u\nZWN0TGlzdGVuZXIpIGhhbmRsZXJzLmdldChPcGVyYXRpb25UeXBlLlNVQlND\nUklCRSk7CiAgICAgICAgVW1icmVsbGFIYW5kbGVyIHVtYnJlbGxhSGFuZGxl\nciA9CiAgICAgICAgICAgIG5ldyBVbWJyZWxsYUhhbmRsZXIoYWxsQ2hhbm5l\nbHMsIGhhbmRsZXJzLCBkaXNjb25uZWN0TGlzdGVuZXIsIGZhbHNlKTsKICAg\nICAgICBQdWJTdWJTZXJ2ZXJQaXBlbGluZUZhY3RvcnkgcGlwZWxpbmUgPSBu\nZXcgUHViU3ViU2VydmVyUGlwZWxpbmVGYWN0b3J5KHVtYnJlbGxhSGFuZGxl\nciwgbnVsbCwgY2ZnCiAgICAgICAgICAgICAgICAuZ2V0TWF4aW11bU1lc3Nh\nZ2VTaXplKCkpOwoKICAgICAgICBib290c3RyYXAuc2V0UGlwZWxpbmVGYWN0\nb3J5KHBpcGVsaW5lKTsKICAgICAgICBib290c3RyYXAuc2V0T3B0aW9uKCJj\naGlsZC50Y3BOb0RlbGF5IiwgdHJ1ZSk7CiAgICAgICAgYm9vdHN0cmFwLnNl\ndE9wdGlvbigiY2hpbGQua2VlcEFsaXZlIiwgdHJ1ZSk7CiAgICAgICAgYm9v\ndHN0cmFwLnNldE9wdGlvbigicmV1c2VBZGRyZXNzIiwgdHJ1ZSk7CgogICAg\nICAgIC8vIEJpbmQgYW5kIHN0YXJ0IHRvIGFjY2VwdCBpbmNvbWluZyBjb25u\nZWN0aW9ucy4KICAgICAgICBhbGxDaGFubmVscy5hZGQoYm9vdHN0cmFwLmJp\nbmQobmV3IEluZXRTb2NrZXRBZGRyZXNzKGNmZy5nZXRQcm94eVBvcnQoKSkp\nKTsKICAgICAgICBsb2dnZXIuaW5mbygiR29pbmcgaW50byByZWNlaXZlIGxv\nb3AiKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzaHV0ZG93bigpIHsKICAg\nICAgICBhbGxDaGFubmVscy5jbG9zZSgpLmF3YWl0VW5pbnRlcnJ1cHRpYmx5\nKCk7CiAgICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAgICAgc2VydmVyU29j\na2V0Q2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7\nCiAgICB9CgogICAgLy8gdGhlIGZvbGxvd2luZyBtZXRob2Qgb25seSBleGlz\ndHMgZm9yIHVuaXQtdGVzdGluZyBwdXJwb3Nlcywgc2hvdWxkIGdvCiAgICAv\nLyBhd2F5IG9uY2Ugd2UgbWFrZSBzdGFydCBkZWxpdmVyeSB0b3RhbGx5IHNl\ncnZlci1zaWRlCiAgICBwdWJsaWMgSGFuZGxlciBnZXRTdGFydERlbGl2ZXJ5\nSGFuZGxlcigpIHsKICAgICAgICByZXR1cm4gaGFuZGxlcnMuZ2V0KE9wZXJh\ndGlvblR5cGUuU1RBUlRfREVMSVZFUlkpOwogICAgfQoKICAgIHB1YmxpYyBI\nYW5kbGVyIGdldFN0b3BEZWxpdmVyeUhhbmRsZXIoKSB7CiAgICAgICAgcmV0\ndXJuIGhhbmRsZXJzLmdldChPcGVyYXRpb25UeXBlLlNUT1BfREVMSVZFUlkp\nOwogICAgfQoKICAgIC8qKgogICAgICogQHBhcmFtIGFyZ3MKICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgewoK\nICAgICAgICBsb2dnZXIuaW5mbygiQXR0ZW1wdGluZyB0byBzdGFydCBIZWR3\naWcgUHJveHkiKTsKICAgICAgICBQcm94eUNvbmZpZ3VyYXRpb24gY29uZiA9\nIG5ldyBQcm94eUNvbmZpZ3VyYXRpb24oKTsKICAgICAgICBpZiAoYXJncy5s\nZW5ndGggPiAwKSB7CiAgICAgICAgICAgIFN0cmluZyBjb25mRmlsZSA9IGFy\nZ3NbMF07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25m\nLmxvYWRDb25mKG5ldyBGaWxlKGNvbmZGaWxlKS50b1VSSSgpLnRvVVJMKCkp\nOwogICAgICAgICAgICB9IGNhdGNoIChNYWxmb3JtZWRVUkxFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgU3RyaW5nIG1zZyA9ICJDb3VsZCBub3Qg\nb3BlbiBjb25maWd1cmF0aW9uIGZpbGU6ICIgKyBjb25mRmlsZTsKICAgICAg\nICAgICAgICAgIFB1YlN1YlNlcnZlci5lcnJvck1zZ0FuZEV4aXQobXNnLCBl\nLCBQdWJTdWJTZXJ2ZXIuUkNfSU5WQUxJRF9DT05GX0ZJTEUpOwogICAgICAg\nICAgICB9IGNhdGNoIChDb25maWd1cmF0aW9uRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIFN0cmluZyBtc2cgPSAiTWFsZm9ybWVkIGNvbmZpZ3Vy\nYXRpb24gZmlsZTogIiArIGNvbmZGaWxlOwogICAgICAgICAgICAgICAgUHVi\nU3ViU2VydmVyLmVycm9yTXNnQW5kRXhpdChtc2csIGUsIFB1YlN1YlNlcnZl\nci5SQ19NSVNDT05GSUdVUkVEKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBsb2dnZXIuaW5mbygiVXNpbmcgY29uZmlndXJhdGlvbiBmaWxlICIgKyBj\nb25mRmlsZSk7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIG5ldyBIZWR3aWdQcm94eShjb25mKS5zdGFydCgpOwogICAgICAgIH0gY2F0\nY2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgIFB1YlN1YlNlcnZlci5l\ncnJvck1zZ0FuZEV4aXQoIkVycm9yIGR1cmluZyBzdGFydHVwIiwgdCwgUHVi\nU3ViU2VydmVyLlJDX09USEVSKTsKICAgICAgICB9CiAgICB9Cgp9Cg==\n","encoding":"base64"}

