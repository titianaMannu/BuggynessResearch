{"sha":"2d9aba23e71a2ac9166f3706681d8f4961c64356","node_id":"MDQ6QmxvYjE1NzU5NTY6MmQ5YWJhMjNlNzFhMmFjOTE2NmYzNzA2NjgxZDhmNDk2MWM2NDM1Ng==","size":12291,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2d9aba23e71a2ac9166f3706681d8f4961c64356","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKaW1wb3J0\nIGphdmEubmV0LlVua25vd25Ib3N0RXhjZXB0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1\ncnJlbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlOwppbXBvcnQgamF2YS51\ndGlsLmNvbmN1cnJlbnQuVGltZVVuaXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9uLlNlcnZlckNvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9uLlRv\ncGljT3BRdWV1ZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNh\nbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5DYWxsYmFj\na1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5IZWR3aWdT\nb2NrZXRBZGRyZXNzOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUu\nY29tbW9uLmNhY2hlLkNhY2hlOwppbXBvcnQgY29tLmdvb2dsZS5jb21tb24u\nY2FjaGUuQ2FjaGVCdWlsZGVyOwppbXBvcnQgY29tLmdvb2dsZS5jb21tb24u\nY2FjaGUuUmVtb3ZhbExpc3RlbmVyOwppbXBvcnQgY29tLmdvb2dsZS5jb21t\nb24uY2FjaGUuUmVtb3ZhbE5vdGlmaWNhdGlvbjsKaW1wb3J0IGNvbS5nb29n\nbGUuY29tbW9uLmNvbGxlY3QuTGlzdHM7CmltcG9ydCBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmc7CgpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJz\ndHJhY3RUb3BpY01hbmFnZXIgaW1wbGVtZW50cyBUb3BpY01hbmFnZXIgewoK\nICAgIC8qKgogICAgICogU3RhdHMgZm9yIGEgdG9waWMuIEZvciBub3cgaXQg\nanVzdCBhbiBlbXB0eSBzdHViIGNsYXNzLgogICAgICovCiAgICBzdGF0aWMg\nY2xhc3MgVG9waWNTdGF0cyB7CiAgICB9CgogICAgZmluYWwgc3RhdGljIFRv\ncGljU3RhdHMgU1RVQl9UT1BJQ19TVEFUUyA9IG5ldyBUb3BpY1N0YXRzKCk7\nCgogICAgLyoqCiAgICAgKiBNeSBuYW1lLgogICAgICovCiAgICBwcm90ZWN0\nZWQgSGVkd2lnU29ja2V0QWRkcmVzcyBhZGRyOwoKICAgIC8qKgogICAgICog\nVG9waWMgY2hhbmdlIGxpc3RlbmVycy4KICAgICAqLwogICAgcHJvdGVjdGVk\nIEFycmF5TGlzdDxUb3BpY093bmVyc2hpcENoYW5nZUxpc3RlbmVyPiBsaXN0\nZW5lcnMgPSBuZXcgQXJyYXlMaXN0PFRvcGljT3duZXJzaGlwQ2hhbmdlTGlz\ndGVuZXI+KCk7CgogICAgLyoqCiAgICAgKiBMaXN0IG9mIHRvcGljcyBJIGJl\nbGlldmUgSSBhbSByZXNwb25zaWJsZSBmb3IuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBDYWNoZTxCeXRlU3RyaW5nLCBUb3BpY1N0YXRzPiB0b3BpY3M7Cgog\nICAgcHJvdGVjdGVkIFRvcGljT3BRdWV1ZXIgcXVldWVyOwogICAgcHJvdGVj\ndGVkIFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnOwogICAgcHJvdGVjdGVkIFNj\naGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hlZHVsZXI7CgogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3Rvcnku\nZ2V0TG9nZ2VyKEFic3RyYWN0VG9waWNNYW5hZ2VyLmNsYXNzKTsKCiAgICBw\ncml2YXRlIGNsYXNzIEdldE93bmVyT3AgZXh0ZW5kcyBUb3BpY09wUXVldWVy\nLkFzeW5jaHJvbm91c09wPEhlZHdpZ1NvY2tldEFkZHJlc3M+IHsKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBzaG91bGRDbGFpbTsKCiAgICAgICAgcHVibGlj\nIEdldE93bmVyT3AoZmluYWwgQnl0ZVN0cmluZyB0b3BpYywgYm9vbGVhbiBz\naG91bGRDbGFpbSwKICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBD\nYWxsYmFjazxIZWR3aWdTb2NrZXRBZGRyZXNzPiBjYiwgT2JqZWN0IGN0eCkg\newogICAgICAgICAgICBxdWV1ZXIuc3VwZXIodG9waWMsIGNiLCBjdHgpOwog\nICAgICAgICAgICB0aGlzLnNob3VsZENsYWltID0gc2hvdWxkQ2xhaW07CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9p\nZCBydW4oKSB7CiAgICAgICAgICAgIHJlYWxHZXRPd25lcih0b3BpYywgc2hv\ndWxkQ2xhaW0sIGNiLCBjdHgpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2\nYXRlIGNsYXNzIFJlbGVhc2VPcCBleHRlbmRzIFRvcGljT3BRdWV1ZXIuQXN5\nbmNocm9ub3VzT3A8Vm9pZD4gewogICAgICAgIGZpbmFsIGJvb2xlYW4gY2hl\nY2tFeGlzdGVuY2U7CgogICAgICAgIHB1YmxpYyBSZWxlYXNlT3AoQnl0ZVN0\ncmluZyB0b3BpYywgQ2FsbGJhY2s8Vm9pZD4gY2IsIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgdGhpcyh0b3BpYywgY2IsIGN0eCwgdHJ1ZSk7CiAgICAg\nICAgfQoKICAgICAgICBSZWxlYXNlT3AoQnl0ZVN0cmluZyB0b3BpYywgQ2Fs\nbGJhY2s8Vm9pZD4gY2IsIE9iamVjdCBjdHgsCiAgICAgICAgICAgICAgICAg\nIGJvb2xlYW4gY2hlY2tFeGlzdGVuY2UpIHsKICAgICAgICAgICAgcXVldWVy\nLnN1cGVyKHRvcGljLCBjYiwgY3R4KTsKICAgICAgICAgICAgdGhpcy5jaGVj\na0V4aXN0ZW5jZSA9IGNoZWNrRXhpc3RlbmNlOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAg\nICAgICAgICBpZiAoY2hlY2tFeGlzdGVuY2UpIHsKICAgICAgICAgICAgICAg\nIFRvcGljU3RhdHMgc3RhdHMgPSB0b3BpY3MuZ2V0SWZQcmVzZW50KHRvcGlj\nKTsKICAgICAgICAgICAgICAgIGlmIChudWxsID09IHN0YXRzKSB7CiAgICAg\nICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVhbFJlbGVhc2VUb3Bp\nYyh0b3BpYywgY2IsIGN0eCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmVsZWFzZSB0b3BpYyB3aGVuIHRoZSB0b3BpYyBpcyByZW1vdmVk\nIGZyb20gdG9waWNzIGNhY2hlLgogICAgICovCiAgICBjbGFzcyBSZWxlYXNl\nVG9waWNMaXN0ZW5lciBpbXBsZW1lbnRzIFJlbW92YWxMaXN0ZW5lcjxCeXRl\nU3RyaW5nLCBUb3BpY1N0YXRzPiB7CiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIHZvaWQgb25SZW1vdmFsKFJlbW92YWxOb3RpZmljYXRpb248\nQnl0ZVN0cmluZywgVG9waWNTdGF0cz4gbm90aWZpY2F0aW9uKSB7CiAgICAg\nICAgICAgIGlmIChub3RpZmljYXRpb24ud2FzRXZpY3RlZCgpKSB7CiAgICAg\nICAgICAgICAgICBsb2dnZXIuaW5mbygidG9waWMge30gaXMgZXZpY3RlZCIs\nIG5vdGlmaWNhdGlvbi5nZXRLZXkoKS50b1N0cmluZ1V0ZjgoKSk7CiAgICAg\nICAgICAgICAgICAvLyBpZiB0aGUgdG9waWMgaXMgZXZpY3RlZCwgd2UgbmVl\nZCB0byByZWxlYXNlIHRoZSB0b3BpYy4KICAgICAgICAgICAgICAgIHJlbGVh\nc2VUb3BpY0ludGVybmFsbHkobm90aWZpY2F0aW9uLmdldEtleSgpLCBmYWxz\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIEFic3RyYWN0VG9waWNNYW5hZ2VyKFNlcnZlckNvbmZpZ3VyYXRpb24gY2Zn\nLCBTY2hlZHVsZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1bGVyKQogICAgICAg\nICAgICB0aHJvd3MgVW5rbm93bkhvc3RFeGNlcHRpb24gewogICAgICAgIHRo\naXMuY2ZnID0gY2ZnOwogICAgICAgIHRoaXMucXVldWVyID0gbmV3IFRvcGlj\nT3BRdWV1ZXIoc2NoZWR1bGVyKTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9\nIHNjaGVkdWxlcjsKICAgICAgICBhZGRyID0gY2ZnLmdldFNlcnZlckFkZHIo\nKTsKCiAgICAgICAgLy8gYnVpbGQgdGhlIHRvcGljIGNhY2hlCiAgICAgICAg\nQ2FjaGVCdWlsZGVyPEJ5dGVTdHJpbmcsIFRvcGljU3RhdHM+IGNhY2hlQnVp\nbGRlciA9IENhY2hlQnVpbGRlci5uZXdCdWlsZGVyKCkKICAgICAgICAgICAg\nLm1heGltdW1TaXplKGNmZy5nZXRNYXhOdW1Ub3BpY3MoKSkKICAgICAgICAg\nICAgLmluaXRpYWxDYXBhY2l0eShjZmcuZ2V0SW5pdE51bVRvcGljcygpKQog\nICAgICAgICAgICAvLyBUT0RPOiBjaGFuZ2UgdG8gc2FtZSBudW1iZXIgYXMg\ndG9waWMgb3AgcXVldWVyIHRocmVhZHMKICAgICAgICAgICAgLmNvbmN1cnJl\nbmN5TGV2ZWwoUnVudGltZS5nZXRSdW50aW1lKCkuYXZhaWxhYmxlUHJvY2Vz\nc29ycygpKQogICAgICAgICAgICAucmVtb3ZhbExpc3RlbmVyKG5ldyBSZWxl\nYXNlVG9waWNMaXN0ZW5lcigpKTsKICAgICAgICBpZiAoY2ZnLmdldFJldGVu\ndGlvblNlY3NBZnRlckFjY2VzcygpID4gMCkgewogICAgICAgICAgICBjYWNo\nZUJ1aWxkZXIuZXhwaXJlQWZ0ZXJBY2Nlc3MoY2ZnLmdldFJldGVudGlvblNl\nY3NBZnRlckFjY2VzcygpLCBUaW1lVW5pdC5TRUNPTkRTKTsKICAgICAgICB9\nCiAgICAgICAgdG9waWNzID0gY2FjaGVCdWlsZGVyLmJ1aWxkKCk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBpbmNyZW1lbnRUb3Bp\nY0FjY2Vzc1RpbWVzKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAgICAgICAvLyBs\nZXQgZ3VhdmEgY2FjaGUgaGFuZGxlIGhpdHMgY291bnRpbmcKICAgICAgICB0\nb3BpY3MuZ2V0SWZQcmVzZW50KHRvcGljKTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBhZGRUb3BpY093bmVy\nc2hpcENoYW5nZUxpc3RlbmVyKFRvcGljT3duZXJzaGlwQ2hhbmdlTGlzdGVu\nZXIgbGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lcnMuYWRkKGxpc3RlbmVy\nKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgcmVsZWFzZVRvcGljSW50ZXJu\nYWxseShmaW5hbCBCeXRlU3RyaW5nIHRvcGljLCBib29sZWFuIGNoZWNrRXhp\nc3RlbmNlKSB7CiAgICAgICAgLy8gRW5xdWV1ZSBhIHJlbGVhc2Ugb3BlcmF0\naW9uLiAoUmVjYWxsIHRoYXQgcmVsZWFzZQogICAgICAgIC8vIGRvZXNuJ3Qg\nImZhaWwiIGV2ZW4gaWYgdGhlIHRvcGljIGlzIG1pc3NpbmcuKQogICAgICAg\nIHF1ZXVlci5wdXNoQW5kTWF5YmVSdW4odG9waWMsIG5ldyBSZWxlYXNlT3Ao\ndG9waWMsIG5ldyBDYWxsYmFjazxWb2lkPigpIHsKCiAgICAgICAgICAgIEBP\ndmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWls\nZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewog\nICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJmYWlsdXJlIHRoYXQgc2hv\ndWxkIG5ldmVyIGhhcHBlbiB3aGVuIHJlbGVhc2luZyB0b3BpYyAiCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyB0b3BpYywgZXhjZXB0aW9uKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgs\nIFZvaWQgcmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgICAgICAg\nICBsb2dnZXIuaW5mbygic3VjY2Vzc2Z1bGx5IHJlbGVhc2Ugb2YgdG9waWMg\nIgogICAgICAgICAgICAgICAgICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRm\nOCgpKTsKICAgICAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJs\nZWQoKSkgewogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zygic3Vj\nY2Vzc2Z1bGx5IHJlbGVhc2Ugb2YgdG9waWMgIgogICAgICAgICAgICAgICAg\nICAgICAgICArIHRvcGljLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICB9LCBudWxsLCBjaGVja0V4\naXN0ZW5jZSkpOwogICAgfQoKICAgIHByb3RlY3RlZCBmaW5hbCBzeW5jaHJv\nbml6ZWQgdm9pZCBub3RpZnlMaXN0ZW5lcnNBbmRBZGRUb093bmVkVG9waWNz\nKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMsCiAgICAgICAgICAgIGZpbmFsIENh\nbGxiYWNrPEhlZHdpZ1NvY2tldEFkZHJlc3M+IG9yaWdpbmFsQ2FsbGJhY2ss\nIGZpbmFsIE9iamVjdCBvcmlnaW5hbENvbnRleHQpIHsKCiAgICAgICAgQ2Fs\nbGJhY2s8Vm9pZD4gcG9zdENiID0gbmV3IENhbGxiYWNrPFZvaWQ+KCkgewoK\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZvaWQgcmVzdWx0T2ZP\ncGVyYXRpb24pIHsKICAgICAgICAgICAgICAgIHRvcGljcy5wdXQodG9waWMs\nIFNUVUJfVE9QSUNfU1RBVFMpOwogICAgICAgICAgICAgICAgaWYgKGNmZy5n\nZXRSZXRlbnRpb25TZWNzKCkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAg\nc2NoZWR1bGVyLnNjaGVkdWxlKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHJlbGVhc2VUb3BpY0ludGVybmFsbHkodG9waWMsIHRydWUpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nfSwgY2ZnLmdldFJldGVudGlvblNlY3MoKSwgVGltZVVuaXQuU0VDT05EUyk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvcmlnaW5hbENh\nbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKG9yaWdpbmFsQ29udGV4dCwgYWRk\ncik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoZmluYWwgT2Jq\nZWN0IGN0eCwgZmluYWwgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewog\nICAgICAgICAgICAgICAgLy8gVE9ETzogb3B0aW1pemF0aW9uOiB3ZSBjYW4g\ncmVsZWFzZSB0aGlzIGFzIHNvb24gYXMgd2UgZXhwZXJpZW5jZSB0aGUgZmly\nc3QgZXJyb3IuCiAgICAgICAgICAgICAgICBDYWxsYmFjazxWb2lkPiBjYiA9\nIG5ldyBDYWxsYmFjazxWb2lkPigpIHsKICAgICAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25GaW5pc2hlZChPYmplY3QgX2N0eCwgVm9pZCBfcmVzdWx0T2ZPcGVy\nYXRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxDYWxs\nYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBleGNlcHRpb24pOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWls\nZWQoT2JqZWN0IF9jdHgsIFB1YlN1YkV4Y2VwdGlvbiBfZXhjZXB0aW9uKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXhjZXB0\naW9uIHJlbGVhc2luZyB0b3BpYyIsIF9leGNlcHRpb24pOwogICAgICAgICAg\nICAgICAgICAgICAgICBvcmlnaW5hbENhbGxiYWNrLm9wZXJhdGlvbkZhaWxl\nZChjdHgsIGV4Y2VwdGlvbik7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICByZWFsUmVsZWFzZVRv\ncGljKHRvcGljLCBjYiwgb3JpZ2luYWxDb250ZXh0KTsKICAgICAgICAgICAg\nfQogICAgICAgIH07CgogICAgICAgIENhbGxiYWNrPFZvaWQ+IG1jYiA9IENh\nbGxiYWNrVXRpbHMubXVsdGlDYWxsYmFjayhsaXN0ZW5lcnMuc2l6ZSgpLCBw\nb3N0Q2IsIG51bGwpOwogICAgICAgIGZvciAoVG9waWNPd25lcnNoaXBDaGFu\nZ2VMaXN0ZW5lciBsaXN0ZW5lciA6IGxpc3RlbmVycykgewogICAgICAgICAg\nICBsaXN0ZW5lci5hY3F1aXJlZFRvcGljKHRvcGljLCBtY2IsIG51bGwpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgcmVhbFJlbGVhc2VU\nb3BpYyhCeXRlU3RyaW5nIHRvcGljLCBDYWxsYmFjazxWb2lkPiBjYWxsYmFj\naywgT2JqZWN0IGN0eCkgewogICAgICAgIGZvciAoVG9waWNPd25lcnNoaXBD\naGFuZ2VMaXN0ZW5lciBsaXN0ZW5lciA6IGxpc3RlbmVycykKICAgICAgICAg\nICAgbGlzdGVuZXIubG9zdFRvcGljKHRvcGljKTsKICAgICAgICB0b3BpY3Mu\naW52YWxpZGF0ZSh0b3BpYyk7CiAgICAgICAgcG9zdFJlbGVhc2VDbGVhbnVw\nKHRvcGljLCBjYWxsYmFjaywgY3R4KTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyBmaW5hbCB2b2lkIGdldE93bmVyKEJ5dGVTdHJpbmcgdG9w\naWMsIGJvb2xlYW4gc2hvdWxkQ2xhaW0sCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBDYWxsYmFjazxIZWR3aWdTb2NrZXRBZGRyZXNzPiBjYiwg\nT2JqZWN0IGN0eCkgewogICAgICAgIHF1ZXVlci5wdXNoQW5kTWF5YmVSdW4o\ndG9waWMsIG5ldyBHZXRPd25lck9wKHRvcGljLCBzaG91bGRDbGFpbSwgY2Is\nIGN0eCkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGZpbmFs\nIHZvaWQgcmVsZWFzZVRvcGljKEJ5dGVTdHJpbmcgdG9waWMsIENhbGxiYWNr\nPFZvaWQ+IGNiLCBPYmplY3QgY3R4KSB7CiAgICAgICAgcXVldWVyLnB1c2hB\nbmRNYXliZVJ1bih0b3BpYywgbmV3IFJlbGVhc2VPcCh0b3BpYywgY2IsIGN0\neCkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGZpbmFsIHZv\naWQgcmVsZWFzZVRvcGljcyhpbnQgbnVtVG9waWNzLCBmaW5hbCBDYWxsYmFj\nazxMb25nPiBjYWxsYmFjaywgZmluYWwgT2JqZWN0IGN0eCkgewogICAgICAg\nIC8vIFRoaXMgaXMgYSBiZXN0IGVmZm9ydCBmdW5jdGlvbi4gV2Ugc2Fjcmlm\naWNlIGFjY3VyYWN5IHRvIG5vdCBob2xkIGEgbG9jayBvbiB0aGUgdG9waWNz\nIHNldC4KICAgICAgICBMaXN0PEJ5dGVTdHJpbmc+IHRvcGljTGlzdCA9IGdl\ndFRvcGljTGlzdCgpOwogICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSByZWxlYXNl\nIG9ubHkgYXMgbWFueSB0b3BpY3MgYXMgd2Ugb3duLgogICAgICAgIGZpbmFs\nIGxvbmcgbnVtVG9waWNzVG9SZWxlYXNlID0gTWF0aC5taW4odG9waWNMaXN0\nLnNpemUoKSwgbnVtVG9waWNzKTsKICAgICAgICAvLyBTaHVmZmxlIHRoZSBs\naXN0IG9mIHRvcGljcyB3ZSBvd24sIHNvIHRoYXQgd2UgcmVsZWFzZSBhIHJh\nbmRvbSBzdWJzZXQuCiAgICAgICAgQ29sbGVjdGlvbnMuc2h1ZmZsZSh0b3Bp\nY0xpc3QpOwogICAgICAgIENhbGxiYWNrPFZvaWQ+IG1jYiA9IENhbGxiYWNr\nVXRpbHMubXVsdGlDYWxsYmFjaygoaW50KW51bVRvcGljc1RvUmVsZWFzZSwg\nbmV3IENhbGxiYWNrPFZvaWQ+KCkgewogICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2Jq\nZWN0IGN0eCwgVm9pZCBpZ25vcmVWYWwpIHsKICAgICAgICAgICAgICAgIGNh\nbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgbnVtVG9waWNzVG9SZWxl\nYXNlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3Qg\nY3R4LCBQdWJTdWJFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9u\nZyBub3RSZWxlYXNlZCA9IDA7CiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0\nYW5jZW9mIFB1YlN1YkV4Y2VwdGlvbi5Db21wb3NpdGVFeGNlcHRpb24pIHsK\nICAgICAgICAgICAgICAgICAgICBub3RSZWxlYXNlZCA9ICgoUHViU3ViRXhj\nZXB0aW9uLkNvbXBvc2l0ZUV4Y2VwdGlvbillKS5nZXRFeGNlcHRpb25zKCku\nc2l6ZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2Fs\nbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCBudW1Ub3BpY3NUb1JlbGVh\nc2UgLSBub3RSZWxlYXNlZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCBj\ndHgpOwoKICAgICAgICAvLyBUcnkgdG8gcmVsZWFzZSAibnVtVG9waWNzVG9S\nZWxlYXNlIiB0b3BpY3MuIEl0J3Mgb2theSBpZiB3ZSdyZSBub3QKICAgICAg\nICAvLyBhYmxlIHRvIHJlbGVhc2Ugc29tZSB0b3BpY3MuIFdlIHNpZ25hbCB0\naGF0IHdlIHRyaWVkIGJ5IGludm9raW5nIHRoZSBjYWxsYmFjaydzCiAgICAg\nICAgLy8gb3BlcmF0aW9uRmluaXNoZWQoKSB3aXRoIHRoZSBhY3R1YWwgbnVt\nYmVyIG9mIHRvcGljcyByZWxlYXNlZC4KICAgICAgICBsb2dnZXIuaW5mbygi\nVGhpcyBodWIgaXMgcmVsZWFzaW5nIHt9IHRvcGljcyIsIG51bVRvcGljc1Rv\nUmVsZWFzZSk7CiAgICAgICAgbG9uZyByZWxlYXNlQ291bnQgPSAwOwogICAg\nICAgIGZvciAoQnl0ZVN0cmluZyB0b3BpYyA6IHRvcGljTGlzdCkgewogICAg\nICAgICAgICBpZiAoKytyZWxlYXNlQ291bnQgPiBudW1Ub3BpY3NUb1JlbGVh\nc2UpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHJlbGVhc2VUb3BpYyh0b3BpYywgbWNiLCBjdHgpOwogICAg\nICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBMaXN0PEJ5\ndGVTdHJpbmc+IGdldFRvcGljTGlzdCgpIHsKICAgICAgICBMaXN0PEJ5dGVT\ndHJpbmc+IHRvcGljTGlzdDsKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMu\ndG9waWNzKSB7CiAgICAgICAgICAgIHRvcGljTGlzdCA9IExpc3RzLm5ld0Fy\ncmF5TGlzdCh0aGlzLnRvcGljcy5hc01hcCgpLmtleVNldCgpKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIHRvcGljTGlzdDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoaXMgbWV0aG9kIHNob3VsZCAicmV0dXJuIiB0aGUgb3duZXIg\nb2YgdGhlIHRvcGljIGlmIG9uZSBoYXMgYmVlbiBjaG9zZW4KICAgICAqIGFs\ncmVhZHkuIElmIHRoZXJlIGlzIG5vIHByZS1jaG9zZW4gb3duZXIsIGVpdGhl\nciB0aGlzIGh1YiBvciBzb21lIG90aGVyCiAgICAgKiBzaG91bGQgYmUgY2hv\nc2VuIGJhc2VkIG9uIHRoZSBzaG91bGRDbGFpbSBwYXJhbWV0ZXIuIElmIGl0\ncyBlbmRzIHVwCiAgICAgKiBjaG9vc2luZyB0aGlzIGh1YiBhcyB0aGUgb3du\nZXIsIHRoZSB7QGNvZGUKICAgICAqIEFic3RyYWN0VG9waWNNYW5hZ2VyI25v\ndGlmeUxpc3RlbmVyc0FuZEFkZFRvT3duZWRUb3BpY3MoQnl0ZVN0cmluZywK\nICAgICAqIE9wZXJhdGlvbkNhbGxiYWNrLCBPYmplY3QpfSBtZXRob2QgbXVz\ndCBiZSBjYWxsZWQuCiAgICAgKgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJz\ndHJhY3Qgdm9pZCByZWFsR2V0T3duZXIoQnl0ZVN0cmluZyB0b3BpYywgYm9v\nbGVhbiBzaG91bGRDbGFpbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBDYWxsYmFjazxIZWR3aWdTb2NrZXRBZGRyZXNzPiBj\nYiwgT2JqZWN0IGN0eCk7CgogICAgLyoqCiAgICAgKiBUaGUgbWV0aG9kIHNo\nb3VsZCBkbyBhbnkgY2xlYW51cCBuZWNlc3NhcnkgdG8gaW5kaWNhdGUgdG8g\nb3RoZXIgaHVicyB0aGF0CiAgICAgKiB0aGlzIHRvcGljIGhhcyBiZWVuIHJl\nbGVhc2VkCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCB2b2lkIHBv\nc3RSZWxlYXNlQ2xlYW51cChCeXRlU3RyaW5nIHRvcGljLCBDYWxsYmFjazxW\nb2lkPiBjYiwgT2JqZWN0IGN0eCk7CgogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgdm9pZCBzdG9wKCkgewogICAgICAgIC8vIGRvIG5vdGhpbmcgbm93CiAg\nICB9Cn0K\n","encoding":"base64"}

