{"sha":"2f76020408120c289d8d3c7821e6a2acebbd6f2c","node_id":"MDQ6QmxvYjE1NzU5NTY6MmY3NjAyMDQwODEyMGMyODlkOGQzYzc4MjFlNmEyYWNlYmJkNmYyYw==","size":4395,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2f76020408120c289d8d3c7821e6a2acebbd6f2c","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljczsK\nCmltcG9ydCBqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyOwppbXBvcnQgamF2YS5p\nby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyaW5nUmVhZGVyOwoK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3Rv\nY29sLkh1YkxvYWREYXRhOwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYu\nSW52YWxpZFByb3RvY29sQnVmZmVyRXhjZXB0aW9uOwppbXBvcnQgY29tLmdv\nb2dsZS5wcm90b2J1Zi5UZXh0Rm9ybWF0OwoKLyoqCiAqIFRoaXMgY2xhc3Mg\nZW5jYXBzdWxhdGVzIG1ldHJpY3MgZm9yIGRldGVybWluaW5nIHRoZSBsb2Fk\nIG9uIGEgaHViIHNlcnZlci4KICovCnB1YmxpYyBjbGFzcyBIdWJMb2FkIGlt\ncGxlbWVudHMgQ29tcGFyYWJsZTxIdWJMb2FkPiB7CgogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBIdWJMb2FkIE1BWF9MT0FEID0gbmV3IEh1YkxvYWQoTG9u\nZy5NQVhfVkFMVUUpOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBIdWJMb2Fk\nIE1JTl9MT0FEID0gbmV3IEh1YkxvYWQoMCk7CgogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJp\nYWxWZXJzaW9uVUlEID0gNTg3MDQ4NzE3Njk1NjQxMzM4N0w7CgogICAgICAg\nIHB1YmxpYyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbihTdHJpbmcgbXNnKSB7\nCiAgICAgICAgICAgIHN1cGVyKG1zZyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgSW52YWxpZEh1YkxvYWRFeGNlcHRpb24oU3RyaW5nIG1zZywgVGhy\nb3dhYmxlIHQpIHsKICAgICAgICAgICAgc3VwZXIobXNnLCB0KTsKICAgICAg\nICB9CiAgICB9CgogICAgLy8gaG93IG1hbnkgdG9waWNzIHRoYXQgYSBodWIg\nc2VydmVyIHNlcnZlcwogICAgbG9uZyBudW1Ub3BpY3M7CgogICAgcHVibGlj\nIEh1YkxvYWQobG9uZyBudW0pIHsKICAgICAgICB0aGlzLm51bVRvcGljcyA9\nIG51bTsKICAgIH0KCiAgICBwdWJsaWMgSHViTG9hZChIdWJMb2FkRGF0YSBk\nYXRhKSB7CiAgICAgICAgdGhpcy5udW1Ub3BpY3MgPSBkYXRhLmdldE51bVRv\ncGljcygpOwogICAgfQoKICAgIC8vIFRPRE86IE1ha2UgdGhpcyB0aHJlYWRz\nYWZlIChCT09LS0VFUEVSLTM3OSkKICAgIHB1YmxpYyBIdWJMb2FkIHNldE51\nbVRvcGljcyhsb25nIG51bVRvcGljcykgewogICAgICAgIHRoaXMubnVtVG9w\naWNzID0gbnVtVG9waWNzOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoK\nICAgIHB1YmxpYyBsb25nIGdldE51bVRvcGljcygpIHsKICAgICAgICByZXR1\ncm4gdGhpcy5udW1Ub3BpY3M7CiAgICB9CgogICAgcHVibGljIEh1YkxvYWRE\nYXRhIHRvSHViTG9hZERhdGEoKSB7CiAgICAgICAgcmV0dXJuIEh1YkxvYWRE\nYXRhLm5ld0J1aWxkZXIoKS5zZXROdW1Ub3BpY3MobnVtVG9waWNzKS5idWls\nZCgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyB0\nb1N0cmluZygpIHsKICAgICAgICByZXR1cm4gVGV4dEZvcm1hdC5wcmludFRv\nU3RyaW5nKHRvSHViTG9hZERhdGEoKSk7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG8pIHsKICAgICAg\nICBpZiAobnVsbCA9PSBvIHx8CiAgICAgICAgICAgICEobyBpbnN0YW5jZW9m\nIEh1YkxvYWQpKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIDAgPT0gY29tcGFyZVRvKChIdWJMb2FkKW8p\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGludCBjb21wYXJl\nVG8oSHViTG9hZCBvdGhlcikgewogICAgICAgIHJldHVybiBudW1Ub3BpY3Mg\nPiBvdGhlci5udW1Ub3BpY3MgPwogICAgICAgICAgICAgICAxIDogKG51bVRv\ncGljcyA8IG90aGVyLm51bVRvcGljcyA/IC0xIDogMCk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAg\nIHJldHVybiAoaW50KW51bVRvcGljczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlIGh1YiBsb2FkIGZyb20gYSBzdHJpbmcuCiAgICAgKgogICAgICog\nQHBhcmFtIGh1YkxvYWRTdHIKICAgICAqICAgICAgICAgIFN0cmluZyByZXBy\nZXNlbnRhdGlvbiBvZiBodWIgbG9hZAogICAgICogQHJldHVybiBodWIgbG9h\nZAogICAgICogQHRocm93cyBJbnZhbGlkSHViTG9hZEV4Y2VwdGlvbiB3aGVu\nIDxjb2RlPmh1YkxvYWRTdHI8L2NvZGU+IGlzIG5vdCBhIHZhbGlkCiAgICAg\nKiAgICAgICAgIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBodWIgbG9hZC4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBIdWJMb2FkIHBhcnNlKFN0cmlu\nZyBodWJMb2FkU3RyKSB0aHJvd3MgSW52YWxpZEh1YkxvYWRFeGNlcHRpb24g\newogICAgICAgIC8vIGl0IGlzIG5vIHByb3RvYnVmIGVuY29kZWQgaHViIGlu\nZm8sIGl0IG1pZ2h0IGJlIGdlbmVyYXRlZCBieSBaa1RvcGljTWFuYWdlcgog\nICAgICAgIGlmICghaHViTG9hZFN0ci5zdGFydHNXaXRoKCJudW1Ub3BpY3Mi\nKSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbG9uZyBu\ndW1Ub3BpY3MgPSBMb25nLnBhcnNlTG9uZyhodWJMb2FkU3RyLCAxMCk7CiAg\nICAgICAgICAgICAgICByZXR1cm4gbmV3IEh1YkxvYWQobnVtVG9waWNzKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIG5m\nZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRIdWJMb2Fk\nRXhjZXB0aW9uKCJDb3JydXB0ZWQgaHViIGxvYWQgZGF0YSA6ICIgKyBodWJM\nb2FkU3RyLCBuZmUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAg\nIC8vIGl0IGl0IGEgcHJvdG9idWYgZW5jb2RlZCBodWIgbG9hZCBkYXRhLgog\nICAgICAgIEh1YkxvYWREYXRhIGh1YkxvYWREYXRhOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIEJ1ZmZlcmVkUmVhZGVyIHJlYWRlciA9IG5ldyBCdWZm\nZXJlZFJlYWRlcigKICAgICAgICAgICAgICAgIG5ldyBTdHJpbmdSZWFkZXIo\naHViTG9hZFN0cikpOwogICAgICAgICAgICBIdWJMb2FkRGF0YS5CdWlsZGVy\nIGRhdGFCdWlsZGVyID0gSHViTG9hZERhdGEubmV3QnVpbGRlcigpOwogICAg\nICAgICAgICBUZXh0Rm9ybWF0Lm1lcmdlKHJlYWRlciwgZGF0YUJ1aWxkZXIp\nOwogICAgICAgICAgICBodWJMb2FkRGF0YSA9IGRhdGFCdWlsZGVyLmJ1aWxk\nKCk7CiAgICAgICAgfSBjYXRjaCAoSW52YWxpZFByb3RvY29sQnVmZmVyRXhj\nZXB0aW9uIGlwYmUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRI\ndWJMb2FkRXhjZXB0aW9uKCJDb3JydXB0ZWQgaHViIGxvYWQgZGF0YSA6ICIg\nKyBodWJMb2FkU3RyLCBpcGJlKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2Vw\ndGlvbiBpZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEh1Ykxv\nYWRFeGNlcHRpb24oIkNvcnJ1cHRlZCBodWIgbG9hZCBkYXRhIDogIiArIGh1\nYkxvYWRTdHIsIGllKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXcg\nSHViTG9hZChodWJMb2FkRGF0YSk7CiAgICB9Cn0K\n","encoding":"base64"}

