{"sha":"2a0dcc04b09f8694c86063b6427650ab72c8519c","node_id":"MDQ6QmxvYjE1NzU5NTY6MmEwZGNjMDRiMDlmODY5NGM4NjA2M2I2NDI3NjUwYWI3MmM4NTE5Yw==","size":6687,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2a0dcc04b09f8694c86063b6427650ab72c8519c","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKaW1wb3J0\nIGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7Cmlt\ncG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\nckZhY3Rvcnk7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3Ry\naW5nOwoKLyoqCiAqIFNoZWQgbG9hZCBieSByZWxlYXNpbmcgdG9waWNzLgog\nKi8KcHVibGljIGNsYXNzIFRvcGljQmFzZWRMb2FkU2hlZGRlciB7CiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoVG9waWNCYXNlZExvYWRTaGVkZGVyLmNsYXNzKTsK\nICAgIHByaXZhdGUgZmluYWwgZG91YmxlIHRvbGVyYW5jZVBlcmNlbnRhZ2U7\nCiAgICBwcml2YXRlIGZpbmFsIGxvbmcgbWF4TG9hZFRvU2hlZDsKICAgIHBy\naXZhdGUgZmluYWwgVG9waWNNYW5hZ2VyIHRtOwogICAgcHJpdmF0ZSBmaW5h\nbCBMaXN0PEJ5dGVTdHJpbmc+IHRvcGljTGlzdDsKCiAgICAvKioKICAgICAq\nIEBwYXJhbSB0bSBUaGUgdG9waWMgbWFuYWdlciB1c2VkIHRvIGhhbmRsZSBs\nb2FkIHNoZWRkaW5nCiAgICAgKiBAcGFyYW0gdG9sZXJhbmNlUGVyY2VudGFn\nZSBUaGUgdG9sZXJhbmNlIHBlcmNlbnRhZ2UgZm9yIHNoZWRkaW5nIGxvYWQK\nICAgICAqIEBwYXJhbSBtYXhMb2FkVG9TaGVkIFRoZSBtYXhpbXVtIGFtb3Vu\nZyBvZiBsb2FkIHRvIHNoZWQgaW4gb25lIGNhbGwuCiAgICAgKi8KICAgIHB1\nYmxpYyBUb3BpY0Jhc2VkTG9hZFNoZWRkZXIoVG9waWNNYW5hZ2VyIHRtLCBk\nb3VibGUgdG9sZXJhbmNlUGVyY2VudGFnZSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgSHViTG9hZCBtYXhMb2FkVG9TaGVkKSB7CiAgICAg\nICAgLy8gTWFrZSBzdXJlIHRoYXQgYWxsIGZ1bmN0aW9ucyBpbiB0aGlzIGNs\nYXNzIGhhdmUgYSBjb25zaXN0ZW50IHZpZXcKICAgICAgICAvLyBvZiB0aGUg\nbG9hZC4gU28sIHdlIHVzZSB0aGUgc2FtZSB0b3BpYyBsaXN0IHRocm91Z2hv\ndXQuCiAgICAgICAgdGhpcyh0bSwgdG0uZ2V0VG9waWNMaXN0KCksIHRvbGVy\nYW5jZVBlcmNlbnRhZ2UsIG1heExvYWRUb1NoZWQpOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhpcyBpcyBwdWJsaWMgYmVjYXVzZSBpdCBtYWtlcyB0ZXN0\naW5nIGVhc2llci4KICAgICAqIEBwYXJhbSB0bSBUaGUgdG9waWMgbWFuYWdl\nciB1c2VkIHRvIGhhbmRsZSBsb2FkIHNoZWRkaW5nCiAgICAgKiBAcGFyYW0g\ndG9waWNMaXN0IFRoZSB0b3BpYyBsaXN0IHJlcHJlc2VudGluZyB0b3BpY3Mg\nb3duZWQgYnkgdGhpcyBodWIuCiAgICAgKiBAcGFyYW0gdG9sZXJhbmNlUGVy\nY2VudGFnZSBUaGUgdG9sZXJhbmNlIHBlcmNlbnRhZ2UgZm9yIHNoZWRkaW5n\nIGxvYWQKICAgICAqIEBwYXJhbSBtYXhMb2FkVG9TaGVkIFRoZSBtYXhpbXVt\nIGFtb3VuZyBvZiBsb2FkIHRvIHNoZWQgaW4gb25lIGNhbGwuCiAgICAgKi8K\nICAgIFRvcGljQmFzZWRMb2FkU2hlZGRlcihUb3BpY01hbmFnZXIgdG0sIExp\nc3Q8Qnl0ZVN0cmluZz4gdG9waWNMaXN0LAogICAgICAgICAgICAgICAgICAg\nICAgICAgIGRvdWJsZSB0b2xlcmFuY2VQZXJjZW50YWdlLAogICAgICAgICAg\nICAgICAgICAgICAgICAgIEh1YkxvYWQgbWF4TG9hZFRvU2hlZCkgewogICAg\nICAgIHRoaXMudG9sZXJhbmNlUGVyY2VudGFnZSA9IHRvbGVyYW5jZVBlcmNl\nbnRhZ2U7CiAgICAgICAgdGhpcy5tYXhMb2FkVG9TaGVkID0gbWF4TG9hZFRv\nU2hlZC5nZXROdW1Ub3BpY3MoKTsKICAgICAgICB0aGlzLnRtID0gdG07CiAg\nICAgICAgdGhpcy50b3BpY0xpc3QgPSB0b3BpY0xpc3Q7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZWR1Y2UgdGhlIGxvYWQgb24gdGhlIGN1cnJlbnQgaHVi\nIHNvIHRoYXQgaXQgcmVhY2hlcyB0aGUgdGFyZ2V0IGxvYWQuCiAgICAgKiBX\nZSByZWR1Y2UgbG9hZCBieSByZWxlYXNpbmcgdG9waWNzIHVzaW5nIHRoZSB7\nQGxpbmsgVG9waWNNYW5hZ2VyfSBwYXNzZWQKICAgICAqIHRvIHRoZSBjb25z\ndHJ1Y3Rvci4gV2UgdXNlIHtAbGluayBUb3BpY01hbmFnZXIjcmVsZWFzZVRv\ncGljcyhpbnQsIG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2ssIE9i\namVjdCl9CiAgICAgKiB0byBhY3R1YWxseSByZWxlYXNlIHRvcGljcy4KICAg\nICAqCiAgICAgKiBAcGFyYW0gdGFyZ2V0TG9hZAogICAgICogQHBhcmFtIGNh\nbGxiYWNrCiAgICAgKiAgICAgICAgICAgICAgYSBDYWxsYmFjazxMb25nPiB0\naGF0IGluZGljYXRlcyBob3cgbWFueSB0b3BpY3Mgd2UgdHJpZWQgdG8gcmVs\nZWFzZS4KICAgICAqIEBwYXJhbSBjdHgKICAgICAqLwogICAgcHVibGljIHZv\naWQgcmVkdWNlTG9hZFRvKEh1YkxvYWQgdGFyZ2V0TG9hZCwgZmluYWwgQ2Fs\nbGJhY2s8TG9uZz4gY2FsbGJhY2ssIGZpbmFsIE9iamVjdCBjdHgpIHsKICAg\nICAgICBpbnQgdGFyZ2V0VG9waWNzID0gKGludCl0YXJnZXRMb2FkLnRvSHVi\nTG9hZERhdGEoKS5nZXROdW1Ub3BpY3MoKTsKICAgICAgICBpbnQgbnVtVG9w\naWNzVG9SZWxlYXNlID0gdG9waWNMaXN0LnNpemUoKSAtIHRhcmdldFRvcGlj\nczsKCiAgICAgICAgLy8gVGhlIG51bWJlciBvZiB0b3BpY3Mgd2Ugb3duIGlz\nIGxlc3MgdGhhbiB0aGUgdGFyZ2V0IHRvcGljIHNpemUuIFdlIGRvbid0IHJl\nbGVhc2UKICAgICAgICAvLyBhbnkgdG9waWNzIGluIHRoaXMgY2FzZS4KICAg\nICAgICBpZiAobnVtVG9waWNzVG9SZWxlYXNlIDw9IDApIHsKICAgICAgICAg\nICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNoZWQoY3R4LCAwTCk7CiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsbCByZWxl\nYXNlVG9waWNzKCkgb24gdGhlIHRvcGljIG1hbmFnZXIgdG8gZG8gdGhpcy4g\nV2UgbGV0IHRoZSBtYW5hZ2VyIGhhbmRsZSB0aGUgcmVsZWFzZQogICAgICAg\nIC8vIHBvbGljeS4KICAgICAgICB0bS5yZWxlYXNlVG9waWNzKG51bVRvcGlj\nc1RvUmVsZWFzZSwgY2FsbGJhY2ssIGN0eCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgbnVtYmVyIG9mIHRvcGljcyBv\nbiB0aGUgY3VycmVudGx5IGFjdGl2ZSBodWJzIGFuZCByZWxlYXNlIHRvcGlj\ncwogICAgICogaWYgcmVxdWlyZWQuCiAgICAgKiBXZSBzaGVkIHRvcGljcyBp\nZiB3ZSBjdXJyZW50bHkgaG9sZCB0b3BpY3MgZ3JlYXRlciB0aGFuIGF2ZXJh\nZ2UgKyBhdmVyYWdlICogdG9sZXJhbmNlUGVyY2VudGFnZS8xMDAuMAogICAg\nICogV2Ugc2hlZCBhIG1heGltdW0gb2YgbWF4TG9hZFRvU2hlZCB0b3BpY3MK\nICAgICAqIFdlIGFsc28gaG9sZCBvbiB0byBhdCBsZWFzdCBvbmUgdG9waWMu\nCiAgICAgKiBAcGFyYW0gbG9hZE1hcAogICAgICogQHBhcmFtIGNhbGxiYWNr\nCiAgICAgKiAgICAgICAgICBBIHJldHVybiB2YWx1ZSBvZiB0cnVlIG1lYW5z\nIHdlIHRyaWVkIHRvIHJlYmFsYW5jZS4gRmFsc2UgbWVhbnMgdGhhdCB0aGVy\nZSB3YXMKICAgICAqICAgICAgICAgIG5vIG5lZWQgdG8gcmViYWxhbmNlLgog\nICAgICogQHBhcmFtIGN0eAogICAgICovCiAgICBwdWJsaWMgdm9pZCBzaGVk\nTG9hZChmaW5hbCBNYXA8SHViSW5mbywgSHViTG9hZD4gbG9hZE1hcCwgZmlu\nYWwgQ2FsbGJhY2s8Qm9vbGVhbj4gY2FsbGJhY2ssCiAgICAgICAgICAgICAg\nICAgICAgICAgICBmaW5hbCBPYmplY3QgY3R4KSB7CgogICAgICAgIGxvbmcg\ndG90YWxUb3BpY3MgPSAwTDsKICAgICAgICBsb25nIG15VG9waWNzID0gdG9w\naWNMaXN0LnNpemUoKTsKICAgICAgICBmb3IgKE1hcC5FbnRyeTxIdWJJbmZv\nLCBIdWJMb2FkPiBlbnRyeSA6IGxvYWRNYXAuZW50cnlTZXQoKSkgewogICAg\nICAgICAgICBpZiAobnVsbCA9PSBlbnRyeS5nZXRLZXkoKSB8fCBudWxsID09\nIGVudHJ5LmdldFZhbHVlKCkpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRvdGFsVG9waWNzICs9IGVu\ndHJ5LmdldFZhbHVlKCkudG9IdWJMb2FkRGF0YSgpLmdldE51bVRvcGljcygp\nOwogICAgICAgIH0KCiAgICAgICAgZG91YmxlIGF2ZXJhZ2VUb3BpY3MgPSAo\nZG91YmxlKXRvdGFsVG9waWNzL2xvYWRNYXAuc2l6ZSgpOwogICAgICAgIGxv\nZ2dlci5pbmZvKCJUb3RhbCB0b3BpY3MgaW4gdGhlIGNsdXN0ZXIgOiB7fS4g\nQXZlcmFnZSA6IHt9LiIsIHRvdGFsVG9waWNzLCBhdmVyYWdlVG9waWNzKTsK\nCiAgICAgICAgLy8gSGFuZGxlIHRoZSBjYXNlIHdoZW4gYXZlcmFnZVRvcGlj\ncyA9PSAwLiBXZSBob2xkIG9uIHRvIGF0IGxlYXN0IDEgdG9waWMuCiAgICAg\nICAgbG9uZyBwZXJtaXNzaWJsZVRvcGljcyA9CiAgICAgICAgICAgIE1hdGgu\nbWF4KDFMLCAobG9uZykgTWF0aC5jZWlsKGF2ZXJhZ2VUb3BpY3MgKyBhdmVy\nYWdlVG9waWNzICogdG9sZXJhbmNlUGVyY2VudGFnZSAvIDEwMC4wKSk7CiAg\nICAgICAgbG9nZ2VyLmluZm8oIlBlcm1pc3NpYmxlIHRvcGljcyA6IHt9LiBO\ndW1iZXIgb2YgdG9waWNzIHRoaXMgaHViIGhvbGRzIDoge30uIiwgcGVybWlz\nc2libGVUb3BpY3MsIG15VG9waWNzKTsKICAgICAgICBpZiAobXlUb3BpY3Mg\nPD0gcGVybWlzc2libGVUb3BpY3MpIHsKICAgICAgICAgICAgLy8gTXkgb3du\nZWQgdG9waWNzIGFyZSBsZXNzIHRoYW4gdGhvc2UgcGVybWl0dGVkIGJ5IHRo\nZSBjdXJyZW50IHRvbGVyYW5jZSBsZXZlbC4gTm8gbmVlZCB0byByZWxlYXNl\nCiAgICAgICAgICAgIC8vIGFueSB0b3BpY3MuCiAgICAgICAgICAgIGNhbGxi\nYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGN0eCwgZmFsc2UpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBUaGUgbnVtYmVyIG9m\nIHRvcGljcyBJIG93biBpcyBtb3JlIHRoYW4gd2hhdCBJIHNob3VsZCBiZSBo\nb2xkaW5nLiBXZSBzaGFsbCBub3cgYXR0ZW1wdCB0byBzaGVkIHNvbWUgbG9h\nZC4KICAgICAgICAvLyBXZSBzaGVkIGF0IG1vc3QgbWF4TG9hZFRvU2hlZCBu\ndW1iZXIgb2YgdG9waWNzLiBXZSBhbHNvIGhvbGQgb24gdG8gYXQgbGVhc3Qg\nMSB0b3BpYy4KICAgICAgICBsb25nIHRhcmdldE51bVRvcGljcyA9IE1hdGgu\nbWF4KDFMLCBNYXRoLm1heCgobG9uZylNYXRoLmNlaWwoYXZlcmFnZVRvcGlj\ncyksIG15VG9waWNzIC0gbWF4TG9hZFRvU2hlZCkpOwoKICAgICAgICAvLyBS\nZWR1Y2UgdGhlIGxvYWQgb24gdGhlIGN1cnJlbnQgaHViIHRvIHRoZSB0YXJn\nZXQgbG9hZCB3ZSBjYWxjdWxhdGVkIGFib3ZlLgogICAgICAgIGxvZ2dlci5p\nbmZvKCJSZWR1Y2luZyBsb2FkIG9uIHRoaXMgaHViIHRvIHt9IHRvcGljcy4i\nLCB0YXJnZXROdW1Ub3BpY3MpOwogICAgICAgIHJlZHVjZUxvYWRUbyhuZXcg\nSHViTG9hZCh0YXJnZXROdW1Ub3BpY3MpLCBuZXcgQ2FsbGJhY2s8TG9uZz4o\nKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBvcGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBMb25nIG51bVJl\nbGVhc2VkKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiUmVsZWFz\nZWQge30gdG9waWNzIHRvIHNoZWQgbG9hZC4iLCBudW1SZWxlYXNlZCk7CiAg\nICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjdHgs\nIHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVj\ndCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBj\nYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBlKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0sIGN0eCk7CiAgICB9Cn0K\n","encoding":"base64"}

