{"sha":"ecc444e1fe9984c931cbc344214b52d0eff8c3d4","node_id":"MDQ6QmxvYjE1NzU5NTY6ZWNjNDQ0ZTFmZTk5ODRjOTMxY2JjMzQ0MjE0YjUyZDBlZmY4YzNkNA==","size":6260,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ecc444e1fe9984c931cbc344214b52d0eff8c3d4","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXI7CgppbXBvcnQgamF2YS51\ndGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9y\ndCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CmltcG9y\ndCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwoK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5jb25mLkNsaWVudENv\nbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIu\nY29tbW9uLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5zZXJ2ZXIubmV0dHkuUHViU3ViU2VydmVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLkJvb2tLZWVwZXJU\nZXN0QmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuSGVkd2ln\nU29ja2V0QWRkcmVzczsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ndGVzdC5Qb3J0TWFuYWdlcjsKCi8qKgogKiBUaGlzIGlzIGEgYmFzZSBjbGFz\ncyBmb3IgYW55IHRlc3RzIHRoYXQgbmVlZCBhIEhlZHdpZyBIdWIocykgc2V0\ndXAgd2l0aCBhbgogKiBhc3NvY2lhdGVkIEJvb2tLZWVwZXIgYW5kIFpvb0tl\nZXBlciBpbnN0YW5jZS4KICoKICovCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBI\nZWR3aWdIdWJUZXN0QmFzZSBleHRlbmRzIFRlc3RDYXNlIHsKCiAgICBwcm90\nZWN0ZWQgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihIZWR3aWdIdWJUZXN0QmFzZS5jbGFzcyk7CgogICAgLy8gQm9v\na0tlZXBlciB2YXJpYWJsZXMKICAgIC8vIERlZmF1bHQgbnVtYmVyIG9mIGJv\nb2tpZSBzZXJ2ZXJzIHRvIHNldHVwLiBFeHRlbmRpbmcgY2xhc3NlcyBjYW4K\nICAgIC8vIG92ZXJyaWRlIHRoaXMuCiAgICBwcm90ZWN0ZWQgaW50IG51bUJv\nb2tpZXMgPSAzOwogICAgcHJvdGVjdGVkIGxvbmcgcmVhZERlbGF5ID0gMEw7\nCiAgICBwcm90ZWN0ZWQgQm9va0tlZXBlclRlc3RCYXNlIGJrdGI7CgogICAg\nLy8gUHViU3ViU2VydmVyIHZhcmlhYmxlcwogICAgLy8gRGVmYXVsdCBudW1i\nZXIgb2YgUHViU3ViU2VydmVyIGh1YnMgdG8gc2V0dXAuIEV4dGVuZGluZyBj\nbGFzc2VzIGNhbgogICAgLy8gb3ZlcnJpZGUgdGhpcy4KICAgIHByb3RlY3Rl\nZCBmaW5hbCBpbnQgbnVtU2VydmVyczsKICAgIHByb3RlY3RlZCBMaXN0PFB1\nYlN1YlNlcnZlcj4gc2VydmVyc0xpc3Q7CiAgICBwcm90ZWN0ZWQgTGlzdDxI\nZWR3aWdTb2NrZXRBZGRyZXNzPiBzZXJ2ZXJBZGRyZXNzZXM7CgogICAgcHJv\ndGVjdGVkIGJvb2xlYW4gc3NsRW5hYmxlZCA9IHRydWU7CiAgICBwcm90ZWN0\nZWQgYm9vbGVhbiBzdGFuZGFsb25lID0gZmFsc2U7CgogICAgcHJvdGVjdGVk\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgSE9TVCA9ICJsb2NhbGhvc3QiOwoKICAg\nIHB1YmxpYyBIZWR3aWdIdWJUZXN0QmFzZSgpIHsKICAgICAgICB0aGlzKDEp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBIZWR3aWdIdWJUZXN0QmFzZShpbnQg\nbnVtU2VydmVycykgewogICAgICAgIHRoaXMubnVtU2VydmVycyA9IG51bVNl\ncnZlcnM7CgogICAgICAgIGluaXQoKTsKICAgIH0KCiAgICBwdWJsaWMgSGVk\nd2lnSHViVGVzdEJhc2UoU3RyaW5nIG5hbWUsIGludCBudW1TZXJ2ZXJzKSB7\nCiAgICAgICAgdGhpcy5udW1TZXJ2ZXJzID0gbnVtU2VydmVyczsKICAgICAg\nICBpbml0KCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGluaXQoKSB7Cgog\nICAgICAgIHNlcnZlckFkZHJlc3NlcyA9IG5ldyBMaW5rZWRMaXN0PEhlZHdp\nZ1NvY2tldEFkZHJlc3M+KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBudW1TZXJ2ZXJzOyBpKyspIHsKICAgICAgICAgICAgc2VydmVyQWRkcmVz\nc2VzLmFkZChuZXcgSGVkd2lnU29ja2V0QWRkcmVzcyhIT1NULAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9ydE1hbmFnZXIu\nbmV4dEZyZWVQb3J0KCksIFBvcnRNYW5hZ2VyLm5leHRGcmVlUG9ydCgpKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8vIERlZmF1bHQgY2hpbGQgY2xhc3Mg\nb2YgdGhlIFNlcnZlckNvbmZpZ3VyYXRpb24gdG8gYmUgdXNlZCBoZXJlLgog\nICAgLy8gRXh0ZW5kaW5nIGNsYXNzZXMgY2FuIGRlZmluZSB0aGVpciBvd24g\nKHBvc3NpYmx5IGV4dGVuZGluZyBmcm9tIHRoaXMpIGFuZAogICAgLy8gb3Zl\ncnJpZGUgdGhlIGdldFNlcnZlckNvbmZpZ3VyYXRpb24gbWV0aG9kIGJlbG93\nIHRvIHJldHVybiB0aGVpciBvd24KICAgIC8vIGNvbmZpZ3VyYXRpb24uCiAg\nICBwcm90ZWN0ZWQgY2xhc3MgSHViU2VydmVyQ29uZmlndXJhdGlvbiBleHRl\nbmRzIFNlcnZlckNvbmZpZ3VyYXRpb24gewogICAgICAgIHByaXZhdGUgZmlu\nYWwgaW50IHNlcnZlclBvcnQsIHNzbFNlcnZlclBvcnQ7CgogICAgICAgIHB1\nYmxpYyBIdWJTZXJ2ZXJDb25maWd1cmF0aW9uKGludCBzZXJ2ZXJQb3J0LCBp\nbnQgc3NsU2VydmVyUG9ydCkgewogICAgICAgICAgICB0aGlzLnNlcnZlclBv\ncnQgPSBzZXJ2ZXJQb3J0OwogICAgICAgICAgICB0aGlzLnNzbFNlcnZlclBv\ncnQgPSBzc2xTZXJ2ZXJQb3J0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gaXNTdGFuZGFsb25lKCkgewog\nICAgICAgICAgICByZXR1cm4gc3RhbmRhbG9uZTsKICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgZ2V0U2VydmVyUG9y\ndCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlcnZlclBvcnQ7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50IGdldFNT\nTFNlcnZlclBvcnQoKSB7CiAgICAgICAgICAgIHJldHVybiBzc2xTZXJ2ZXJQ\nb3J0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFN0cmluZyBnZXRaa0hvc3QoKSB7CiAgICAgICAgICAgIHJldHVybiBu\ndWxsICE9IGJrdGIgPyBia3RiLmdldFprSG9zdFBvcnQoKSA6IG51bGw7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBpc1NTTEVuYWJsZWQoKSB7CiAgICAgICAgICAgIHJldHVybiBzc2xF\nbmFibGVkOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIFN0cmluZyBnZXRDZXJ0TmFtZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuIGlzU1NMRW5hYmxlZCgpID8gIi9zZXJ2ZXIucDEyIiA6IG51bGw7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3Ry\naW5nIGdldFBhc3N3b3JkKCkgewogICAgICAgICAgICByZXR1cm4gaXNTU0xF\nbmFibGVkKCkgPyAiZVV5U3ZwMnBoTTJXayIgOiBudWxsOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgY2xhc3MgSHViQ2xpZW50Q29uZmlndXJhdGlv\nbiBleHRlbmRzIENsaWVudENvbmZpZ3VyYXRpb24gewogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBIZWR3aWdTb2NrZXRBZGRyZXNzIGdldERl\nZmF1bHRTZXJ2ZXJIZWR3aWdTb2NrZXRBZGRyZXNzKCkgewogICAgICAgICAg\nICByZXR1cm4gc2VydmVyQWRkcmVzc2VzLmdldCgwKTsKICAgICAgICB9CiAg\nICB9CgogICAgLy8gTWV0aG9kIHRvIGdldCBhIFNlcnZlckNvbmZpZ3VyYXRp\nb24gZm9yIHRoZSBQdWJTdWJTZXJ2ZXJzIGNyZWF0ZWQgdXNpbmcKICAgIC8v\nIHRoZSBzcGVjaWZpZWQgcG9ydHMuIEV4dGVuZGluZyBjaGlsZCBjbGFzc2Vz\nIGNhbiBvdmVycmlkZSB0aGlzLiBUaGlzCiAgICAvLyBkZWZhdWx0IGltcGxl\nbWVudGF0aW9uIHdpbGwgcmV0dXJuIHRoZSBIdWJTZXJ2ZXJDb25maWd1cmF0\naW9uIG9iamVjdAogICAgLy8gZGVmaW5lZCBhYm92ZS4KICAgIHByb3RlY3Rl\nZCBTZXJ2ZXJDb25maWd1cmF0aW9uIGdldFNlcnZlckNvbmZpZ3VyYXRpb24o\naW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0KSB7CiAgICAgICAg\ncmV0dXJuIG5ldyBIdWJTZXJ2ZXJDb25maWd1cmF0aW9uKHNlcnZlclBvcnQs\nIHNzbFNlcnZlclBvcnQpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHN0\nYXJ0SHViU2VydmVycygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8v\nIE5vdyBjcmVhdGUgdGhlIFB1YlN1YlNlcnZlciBIdWJzCiAgICAgICAgc2Vy\ndmVyc0xpc3QgPSBuZXcgTGlua2VkTGlzdDxQdWJTdWJTZXJ2ZXI+KCk7Cgog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtU2VydmVyczsgaSsrKSB7\nCiAgICAgICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiA9IGdldFNl\ncnZlckNvbmZpZ3VyYXRpb24oc2VydmVyQWRkcmVzc2VzLmdldChpKS5nZXRQ\nb3J0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgc3NsRW5hYmxlZCA/IHNlcnZlckFk\nZHJlc3Nlcy5nZXQoaSkuZ2V0U1NMUG9ydCgpIDogLTEpOwogICAgICAgICAg\nICBQdWJTdWJTZXJ2ZXIgcyA9IG5ldyBQdWJTdWJTZXJ2ZXIoY29uZiwgbmV3\nIENsaWVudENvbmZpZ3VyYXRpb24oKSwgbmV3IExvZ2dpbmdFeGNlcHRpb25I\nYW5kbGVyKCkpOwogICAgICAgICAgICBzZXJ2ZXJzTGlzdC5hZGQocyk7CiAg\nICAgICAgICAgIHMuc3RhcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJv\ndGVjdGVkIHZvaWQgc3RvcEh1YlNlcnZlcnMoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICAvLyBTaHV0ZG93biBhbGwgb2YgdGhlIFB1YlN1YlNlcnZl\ncnMKICAgICAgICBmb3IgKFB1YlN1YlNlcnZlciBzZXJ2ZXIgOiBzZXJ2ZXJz\nTGlzdCkgewogICAgICAgICAgICBzZXJ2ZXIuc2h1dGRvd24oKTsKICAgICAg\nICB9CiAgICAgICAgc2VydmVyc0xpc3QuY2xlYXIoKTsKICAgIH0KCiAgICBA\nQmVmb3JlCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIGxvZ2dlci5pbmZvKCJTVEFSVElORyAiICsgZ2V0\nQ2xhc3MoKSk7CiAgICAgICAgaWYgKCEgc3RhbmRhbG9uZSkgewogICAgICAg\nICAgICBia3RiID0gbmV3IEJvb2tLZWVwZXJUZXN0QmFzZShudW1Cb29raWVz\nLCByZWFkRGVsYXkpOwogICAgICAgICAgICBia3RiLnNldFVwKCk7CiAgICAg\nICAgfQogICAgICAgIHN0YXJ0SHViU2VydmVycygpOwogICAgICAgIGxvZ2dl\nci5pbmZvKCJIZWR3aWdIdWIgdGVzdCBzZXR1cCBmaW5pc2hlZCIpOwogICAg\nfQoKICAgIEBBZnRlcgogICAgcHJvdGVjdGVkIHZvaWQgdGVhckRvd24oKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBsb2dnZXIuaW5mbygidGVhckRv\nd24gc3RhcnRpbmciKTsKICAgICAgICBzdG9wSHViU2VydmVycygpOwogICAg\nICAgIGlmIChudWxsICE9IGJrdGIpIGJrdGIudGVhckRvd24oKTsKICAgICAg\nICBsb2dnZXIuaW5mbygiRklOSVNIRUQgIiArIGdldENsYXNzKCkpOwogICAg\nfQoKfQo=\n","encoding":"base64"}

