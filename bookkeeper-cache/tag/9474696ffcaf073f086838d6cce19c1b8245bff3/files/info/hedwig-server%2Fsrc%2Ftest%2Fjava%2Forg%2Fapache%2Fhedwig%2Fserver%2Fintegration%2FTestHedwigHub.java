{"sha":"1867f9c27d52dd309eadf5d0078e6b267686a25e","node_id":"MDQ6QmxvYjE1NzU5NTY6MTg2N2Y5YzI3ZDUyZGQzMDllYWRmNWQwMDc4ZTZiMjY3Njg2YTI1ZQ==","size":34161,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/1867f9c27d52dd309eadf5d0078e6b267686a25e","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaW50ZWdyYXRpb247Cgpp\nbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tldEFkZHJlc3M7CmltcG9ydCBqYXZh\nLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlN5\nbmNocm9ub3VzUXVldWU7CgppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBv\ncnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoK\naW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLlN1YnNjcmli\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5DbGll\nbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xp\nZW50LmV4Y2VwdGlvbnMuSW52YWxpZFN1YnNjcmliZXJJZEV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5leGNlcHRpb25zLkFs\ncmVhZHlTdGFydERlbGl2ZXJ5RXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmNsaWVudC5hcGkuQ2xpZW50OwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuY2xpZW50LmFwaS5QdWJsaXNoZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9u\nLkNsaWVudE5vdFN1YnNjcmliZWRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTWVzc2FnZVNlcUlkOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlByb3Rv\nY29sVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29s\nLlB1YlN1YlByb3RvY29sLlB1YlN1YlJlcXVlc3Q7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5QdWJTdWJSZXNw\nb25zZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1\nYlByb3RvY29sLlN0YXJ0RGVsaXZlcnlSZXF1ZXN0OwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3RvcERlbGl2\nZXJ5UmVxdWVzdDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29s\nLlB1YlN1YlByb3RvY29sLlN0YXR1c0NvZGU7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25P\ncHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVhdGVPckF0dGFjaDsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvZXh0ZW5zaW9ucy5TdWJz\nY3JpcHRpb25TdGF0ZVV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nc2VydmVyLkhlZHdpZ0h1YlRlc3RCYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuc2VydmVyLm5ldHR5LldyaXRlUmVjb3JkaW5nQ2hhbm5lbDsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5wcm94eS5IZWR3aWdQcm94\neTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5wcm94eS5Qcm94\neUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2\nZXIucmVnaW9ucy5IZWR3aWdIdWJDbGllbnQ7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcudXRpbC5Db25jdXJyZW5jeVV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcudXRpbC5IZWR3aWdTb2NrZXRBZGRyZXNzOwppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLnRlc3QuUG9ydE1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuTG9nZ2luZ0V4Y2VwdGlvbkhhbmRsZXI7\nCgppbXBvcnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCnB1YmxpYyBh\nYnN0cmFjdCBjbGFzcyBUZXN0SGVkd2lnSHViIGV4dGVuZHMgSGVkd2lnSHVi\nVGVzdEJhc2UgewoKICAgIC8vIENsaWVudCBzaWRlIHZhcmlhYmxlcwogICAg\ncHJvdGVjdGVkIEhlZHdpZ0NsaWVudCBjbGllbnQ7CiAgICBwcm90ZWN0ZWQg\nUHVibGlzaGVyIHB1Ymxpc2hlcjsKICAgIHByb3RlY3RlZCBTdWJzY3JpYmVy\nIHN1YnNjcmliZXI7CgogICAgLy8gQ29tbW9uIEJ5dGVTdHJpbmdzIHVzZWQg\naW4gdGVzdHMuCiAgICBwcml2YXRlIGZpbmFsIEJ5dGVTdHJpbmcgbG9jYWxT\ndWJzY3JpYmVySWQgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiTG9jYWxT\ndWJzY3JpYmVyIik7CiAgICBwcml2YXRlIGZpbmFsIEJ5dGVTdHJpbmcgaHVi\nU3Vic2NyaWJlcklkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoU3Vic2Ny\naXB0aW9uU3RhdGVVdGlscy5IVUJfU1VCU0NSSUJFUl9QUkVGSVgKICAgICAg\nICAgICAgKyAiSHViU3ViY3JpYmVyIik7CgogICAgZW51bSBNb2RlIHsKICAg\nICAgICBSRUdVTEFSLCBQUk9YWSwgU1NMCiAgICB9OwoKICAgIHByb3RlY3Rl\nZCBNb2RlIG1vZGU7CiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc1N1YnNjcmlw\ndGlvbkNoYW5uZWxTaGFyaW5nRW5hYmxlZDsKCiAgICBwdWJsaWMgVGVzdEhl\nZHdpZ0h1YihNb2RlIG1vZGUsIGJvb2xlYW4gaXNTdWJzY3JpcHRpb25DaGFu\nbmVsU2hhcmluZ0VuYWJsZWQpIHsKICAgICAgICBzdXBlcigzKTsKICAgICAg\nICB0aGlzLm1vZGUgPSBtb2RlOwogICAgICAgIHRoaXMuaXNTdWJzY3JpcHRp\nb25DaGFubmVsU2hhcmluZ0VuYWJsZWQgPSBpc1N1YnNjcmlwdGlvbkNoYW5u\nZWxTaGFyaW5nRW5hYmxlZDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgSGVkd2ln\nUHJveHkgcHJveHk7CiAgICBwcm90ZWN0ZWQgUHJveHlDb25maWd1cmF0aW9u\nIHByb3h5Q29uZiA9IG5ldyBQcm94eUNvbmZpZ3VyYXRpb24oKSB7CiAgICAg\nICAgICAgIGZpbmFsIGludCBwcm94eVBvcnQgPSBQb3J0TWFuYWdlci5uZXh0\nRnJlZVBvcnQoKTsKCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICBwdWJsaWMgSGVkd2lnU29ja2V0QWRkcmVzcyBnZXREZWZhdWx0U2VydmVy\nSGVkd2lnU29ja2V0QWRkcmVzcygpIHsKICAgICAgICAgICAgICAgIHJldHVy\nbiBzZXJ2ZXJBZGRyZXNzZXMuZ2V0KDApOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIGludCBnZXRQ\ncm94eVBvcnQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJveHlQb3J0\nOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBTeW5jaHJvbm91\nc1F1ZXVlcyB0byB2ZXJpZnkgYXN5bmMgY2FsbHMKICAgIHByaXZhdGUgZmlu\nYWwgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBxdWV1ZSA9IG5ldyBTeW5j\naHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CiAgICBwcml2YXRlIGZpbmFsIFN5\nbmNocm9ub3VzUXVldWU8Qm9vbGVhbj4gY29uc3VtZVF1ZXVlID0gbmV3IFN5\nbmNocm9ub3VzUXVldWU8Qm9vbGVhbj4oKTsKCiAgICAvLyBUZXN0IGltcGxl\nbWVudGF0aW9uIG9mIENhbGxiYWNrIGZvciBhc3luYyBjbGllbnQgYWN0aW9u\ncy4KICAgIHN0YXRpYyBjbGFzcyBUZXN0Q2FsbGJhY2sgaW1wbGVtZW50cyBD\nYWxsYmFjazxWb2lkPiB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTeW5jaHJv\nbm91c1F1ZXVlPEJvb2xlYW4+IHF1ZXVlOwoKICAgICAgICBwdWJsaWMgVGVz\ndENhbGxiYWNrKFN5bmNocm9ub3VzUXVldWU8Qm9vbGVhbj4gcXVldWUpIHsK\nICAgICAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9u\nRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9pZCByZXN1bHRPZk9wZXJhdGlvbikg\newogICAgICAgICAgICBuZXcgVGhyZWFkKG5ldyBSdW5uYWJsZSgpIHsKICAg\nICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGlj\nIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgIGlmIChsb2dnZXIu\naXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9n\nZ2VyLmRlYnVnKCJPcGVyYXRpb24gZmluaXNoZWQhIik7CiAgICAgICAgICAg\nICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQocXVldWUsIHRydWUpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5zdGFydCgpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIGZpbmFsIFB1YlN1YkV4Y2Vw\ndGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgbmV3IFRocmVhZChuZXcg\nUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIk9wZXJhdGlvbiBmYWlsZWQhIiwgZXhjZXB0\naW9uKTsKICAgICAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1\ndChxdWV1ZSwgZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9KS5zdGFydCgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBUZXN0IGlt\ncGxlbWVudGF0aW9uIG9mIHN1YnNjcmliZXIncyBtZXNzYWdlIGhhbmRsZXIu\nCiAgICBzdGF0aWMgY2xhc3MgVGVzdE1lc3NhZ2VIYW5kbGVyIGltcGxlbWVu\ndHMgTWVzc2FnZUhhbmRsZXIgewogICAgICAgIC8vIEZvciBzdWJzY3JpYmUg\ncmVjb25uZWN0IHRlc3RpbmcsIHRoZSBzZXJ2ZXIgY291bGQgc2VuZCB1cyBi\nYWNrCiAgICAgICAgLy8gbWVzc2FnZXMgd2UndmUgYWxyZWFkeSBwcm9jZXNz\nZWQgYW5kIGNvbnN1bWVkLiBXZSBuZWVkIHRvIGtlZXAKICAgICAgICAvLyB0\ncmFjayBvZiB0aGUgb25lcyB3ZSd2ZSBlbmNvdW50ZXJlZCBzbyB3ZSBvbmx5\nIHNpZ25hbCBiYWNrIHRvIHRoZQogICAgICAgIC8vIGNvbnN1bWVRdWV1ZSBv\nbmNlLgogICAgICAgIHByaXZhdGUgSGFzaFNldDxNZXNzYWdlU2VxSWQ+IGNv\nbnN1bWVkTWVzc2FnZXMgPSBuZXcgSGFzaFNldDxNZXNzYWdlU2VxSWQ+KCk7\nCiAgICAgICAgcHJpdmF0ZSBsb25nIGxhcmdlc3RNc2dTZXFJZENvbnN1bWVk\nID0gLTE7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTeW5jaHJvbm91c1F1ZXVl\nPEJvb2xlYW4+IGNvbnN1bWVRdWV1ZTsKCiAgICAgICAgcHVibGljIFRlc3RN\nZXNzYWdlSGFuZGxlcihTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1\nbWVRdWV1ZSkgewogICAgICAgICAgICB0aGlzLmNvbnN1bWVRdWV1ZSA9IGNv\nbnN1bWVRdWV1ZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGRl\nbGl2ZXIoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsIGZpbmFsIE1lc3NhZ2UgbXNnLCBDYWxsYmFjazxWb2lkPiBjYWxsYmFj\naywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdCBjb250ZXh0\nKSB7CiAgICAgICAgICAgIGlmICghY29uc3VtZWRNZXNzYWdlcy5jb250YWlu\ncyhtc2cuZ2V0TXNnSWQoKSkpIHsKICAgICAgICAgICAgICAgIC8vIE5ldyBt\nZXNzYWdlIHRvIGNvbnN1bWUuIEFkZCBpdCB0byB0aGUgU2V0IG9mIGNvbnN1\nbWVkCiAgICAgICAgICAgICAgICAvLyBtZXNzYWdlcy4KICAgICAgICAgICAg\nICAgIGNvbnN1bWVkTWVzc2FnZXMuYWRkKG1zZy5nZXRNc2dJZCgpKTsKICAg\nICAgICAgICAgICAgIC8vIENoZWNrIHRoYXQgdGhlIG1zZyBzZXEgSUQgaXMg\naW5jcmVtZW50aW5nIGJ5IDEgY29tcGFyZWQgdG8KICAgICAgICAgICAgICAg\nIC8vIHRoZSBsYXN0IGNvbnN1bWVkIG1lc3NhZ2UuIERvbid0IGRvIHRoaXMg\nY2hlY2sgaWYgdGhpcyBpcyB0aGUKICAgICAgICAgICAgICAgIC8vIGluaXRp\nYWwgbWVzc2FnZSBiZWluZyBjb25zdW1lZC4KICAgICAgICAgICAgICAgIGlm\nIChsYXJnZXN0TXNnU2VxSWRDb25zdW1lZCA+PSAwICYmIG1zZy5nZXRNc2dJ\nZCgpLmdldExvY2FsQ29tcG9uZW50KCkgIT0gbGFyZ2VzdE1zZ1NlcUlkQ29u\nc3VtZWQgKyAxKSB7CiAgICAgICAgICAgICAgICAgICAgbmV3IFRocmVhZChu\nZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlz\nRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbG9nZ2VyLmRlYnVnKCJDb25zdW1pbmcgbWVzc2FnZSB0aGF0IGlzIG91\ndCBvZiBvcmRlciBmb3IgbXNnSWQ6ICIKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyBtc2cuZ2V0TXNnSWQoKS5nZXRM\nb2NhbENvbXBvbmVudCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIENvbmN1cnJlbmN5VXRpbHMucHV0KGNvbnN1bWVRdWV1ZSwgZmFsc2UpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nfSkuc3RhcnQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgbmV3IFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJDb25z\ndW1lIG9wZXJhdGlvbiBmaW5pc2hlZCBzdWNjZXNzZnVsbHkhIik7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChj\nb25zdW1lUXVldWUsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgfSkuc3RhcnQoKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIC8vIFN0b3JlIHRoZSBjb25zdW1lZCBt\nZXNzYWdlIGFzIHRoZSBuZXcgbGFzdCBtc2cgaWQgY29uc3VtZWQuCiAgICAg\nICAgICAgICAgICBsYXJnZXN0TXNnU2VxSWRDb25zdW1lZCA9IG1zZy5nZXRN\nc2dJZCgpLmdldExvY2FsQ29tcG9uZW50KCk7CiAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJDb25zdW1l\nZCBhIG1lc3NhZ2UgdGhhdCB3ZSd2ZSBwcm9jZXNzZWQgYWxyZWFkeTogIiAr\nIG1zZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FsbGJhY2sub3Bl\ncmF0aW9uRmluaXNoZWQoY29udGV4dCwgbnVsbCk7CiAgICAgICAgfQogICAg\nfQoKICAgIGNsYXNzIFRlc3RDbGllbnRDb25maWd1cmF0aW9uIGV4dGVuZHMg\nSHViQ2xpZW50Q29uZmlndXJhdGlvbiB7CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBJbmV0U29ja2V0QWRkcmVzcyBnZXREZWZhdWx0U2Vy\ndmVySG9zdCgpIHsKICAgICAgICAgICAgaWYgKG1vZGUgPT0gTW9kZS5QUk9Y\nWSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbmV0U29ja2V0QWRk\ncmVzcyhwcm94eUNvbmYuZ2V0UHJveHlQb3J0KCkpOwogICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldERlZmF1\nbHRTZXJ2ZXJIb3N0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBib29sZWFuIGlzU1NMRW5h\nYmxlZCgpIHsKICAgICAgICAgICAgaWYgKG1vZGUgPT0gTW9kZS5TU0wpCiAg\nICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gaXNTdWJzY3Jp\ncHRpb25DaGFubmVsU2hhcmluZ0VuYWJsZWQoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBpc1N1YnNjcmlwdGlvbkNoYW5uZWxTaGFyaW5nRW5hYmxlZDsKICAg\nICAgICB9CiAgICB9CgogICAgLy8gQ2xpZW50Q29uZmlndXJhdGlvbiB0byB1\nc2UgZm9yIHRoaXMgdGVzdC4KICAgIHByb3RlY3RlZCBDbGllbnRDb25maWd1\ncmF0aW9uIGdldENsaWVudENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBUZXN0Q2xpZW50Q29uZmlndXJhdGlvbigpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgQEJlZm9yZQogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5zZXRVcCgpOwog\nICAgICAgIGlmIChtb2RlID09IE1vZGUuUFJPWFkpIHsKICAgICAgICAgICAg\ncHJveHkgPSBuZXcgSGVkd2lnUHJveHkocHJveHlDb25mLCBuZXcgTG9nZ2lu\nZ0V4Y2VwdGlvbkhhbmRsZXIoKSk7CiAgICAgICAgICAgIHByb3h5LnN0YXJ0\nKCk7CiAgICAgICAgfQogICAgICAgIGNsaWVudCA9IG5ldyBIZWR3aWdDbGll\nbnQoZ2V0Q2xpZW50Q29uZmlndXJhdGlvbigpKTsKICAgICAgICBwdWJsaXNo\nZXIgPSBjbGllbnQuZ2V0UHVibGlzaGVyKCk7CiAgICAgICAgc3Vic2NyaWJl\nciA9IGNsaWVudC5nZXRTdWJzY3JpYmVyKCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBAQWZ0ZXIKICAgIHB1YmxpYyB2b2lkIHRlYXJEb3duKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAg\nICAgaWYgKG1vZGUgPT0gTW9kZS5QUk9YWSkgewogICAgICAgICAgICBwcm94\neS5zaHV0ZG93bigpOwogICAgICAgIH0KICAgICAgICBzdXBlci50ZWFyRG93\nbigpOwoKICAgIH0KCiAgICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2VuZXJh\ndGUgTWVzc2FnZXMKICAgIHByb3RlY3RlZCBNZXNzYWdlIGdldE1zZyhpbnQg\nbXNnTnVtKSB7CiAgICAgICAgcmV0dXJuIE1lc3NhZ2UubmV3QnVpbGRlcigp\nLnNldEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIk1lc3NhZ2UiICsg\nbXNnTnVtKSkuYnVpbGQoKTsKICAgIH0KCiAgICAvLyBIZWxwZXIgZnVuY3Rp\nb24gdG8gZ2VuZXJhdGUgVG9waWNzCiAgICBwcm90ZWN0ZWQgQnl0ZVN0cmlu\nZyBnZXRUb3BpYyhpbnQgdG9waWNOdW0pIHsKICAgICAgICByZXR1cm4gQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRvcGljIiArIHRvcGljTnVtKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydERlbGl2ZXJ5KEJ5dGVTdHJp\nbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBNZXNzYWdlSGFu\nZGxlciBoYW5kbGVyKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdGFy\ndERlbGl2ZXJ5KHN1YnNjcmliZXIsIHRvcGljLCBzdWJzY3JpYmVySWQsIGhh\nbmRsZXIpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0RGVsaXZl\ncnkoU3Vic2NyaWJlciBzdWJzY3JpYmVyLCBCeXRlU3RyaW5nIHRvcGljLCBC\neXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgTWVzc2FnZUhhbmRsZXIgaGFuZGxlcikgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgc3Vic2NyaWJlci5zdGFydERlbGl2ZXJ5KHRv\ncGljLCBzdWJzY3JpYmVySWQsIGhhbmRsZXIpOwogICAgICAgIGlmIChtb2Rl\nID09IE1vZGUuUFJPWFkpIHsKICAgICAgICAgICAgV3JpdGVSZWNvcmRpbmdD\naGFubmVsIGNoYW5uZWwgPSBuZXcgV3JpdGVSZWNvcmRpbmdDaGFubmVsKCk7\nCiAgICAgICAgICAgIFB1YlN1YlJlcXVlc3QgcmVxdWVzdCA9IFB1YlN1YlJl\ncXVlc3QubmV3QnVpbGRlcigpLnNldFByb3RvY29sVmVyc2lvbihQcm90b2Nv\nbFZlcnNpb24uVkVSU0lPTl9PTkUpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIC5zZXRUb3BpYyh0b3BpYykuc2V0VHhuSWQoMCkuc2V0\nVHlwZShPcGVyYXRpb25UeXBlLlNUQVJUX0RFTElWRVJZKS5zZXRTdGFydERl\nbGl2ZXJ5UmVxdWVzdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIFN0YXJ0RGVsaXZlcnlSZXF1ZXN0Lm5ld0J1aWxkZXIoKS5z\nZXRTdWJzY3JpYmVySWQoc3Vic2NyaWJlcklkKSkuYnVpbGQoKTsKICAgICAg\nICAgICAgcHJveHkuZ2V0U3RhcnREZWxpdmVyeUhhbmRsZXIoKS5oYW5kbGVS\nZXF1ZXN0KHJlcXVlc3QsIGNoYW5uZWwpOwogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoU3RhdHVzQ29kZS5TVUNDRVNTLCAoKFB1YlN1YlJlc3BvbnNlKSBj\naGFubmVsLmdldE1lc3NhZ2VzV3JpdHRlbigpLmdldCgwKSkuZ2V0U3RhdHVz\nQ29kZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nc3RvcERlbGl2ZXJ5KEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vi\nc2NyaWJlcklkKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdG9wRGVs\naXZlcnkoc3Vic2NyaWJlciwgdG9waWMsIHN1YnNjcmliZXJJZCk7CiAgICB9\nCgogICAgcHJvdGVjdGVkIHZvaWQgc3RvcERlbGl2ZXJ5KFN1YnNjcmliZXIg\nc3Vic2NyaWJlciwgQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJz\nY3JpYmVySWQpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1YnNjcmli\nZXIuc3RvcERlbGl2ZXJ5KHRvcGljLCBzdWJzY3JpYmVySWQpOwogICAgICAg\nIGlmIChtb2RlID09IE1vZGUuUFJPWFkpIHsKICAgICAgICAgICAgUHViU3Vi\nUmVxdWVzdCByZXF1ZXN0ID0gUHViU3ViUmVxdWVzdC5uZXdCdWlsZGVyKCku\nc2V0UHJvdG9jb2xWZXJzaW9uKFByb3RvY29sVmVyc2lvbi5WRVJTSU9OX09O\nRSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFRv\ncGljKHRvcGljKS5zZXRUeG5JZCgxKS5zZXRUeXBlKE9wZXJhdGlvblR5cGUu\nU1RPUF9ERUxJVkVSWSkuc2V0U3RvcERlbGl2ZXJ5UmVxdWVzdCgKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN0b3BEZWxpdmVy\neVJlcXVlc3QubmV3QnVpbGRlcigpLnNldFN1YnNjcmliZXJJZChzdWJzY3Jp\nYmVySWQpKS5idWlsZCgpOwogICAgICAgICAgICBwcm94eS5nZXRTdG9wRGVs\naXZlcnlIYW5kbGVyKCkuaGFuZGxlUmVxdWVzdChyZXF1ZXN0LCBwcm94eS5n\nZXRDaGFubmVsVHJhY2tlcigpLmdldENoYW5uZWwodG9waWMsIHN1YnNjcmli\nZXJJZCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBw\ndWJsaXNoQmF0Y2goaW50IGJhdGNoU2l6ZSwgYm9vbGVhbiBleHBlY3RlZCwg\nYm9vbGVhbiBtZXNzYWdlc1RvQmVDb25zdW1lZCwgaW50IGxvb3ApIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJs\nZWQoKSkKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJQdWJsaXNoaW5nICIg\nKyBsb29wICsgIiBiYXRjaCBvZiBtZXNzYWdlcy4iKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAg\nIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2goZ2V0VG9waWMoaSksIGdldE1zZyhp\nICsgbG9vcCAqIGJhdGNoU2l6ZSksIG5ldyBUZXN0Q2FsbGJhY2socXVldWUp\nLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShleHBlY3RlZCA9PSBx\ndWV1ZS50YWtlKCkpOwogICAgICAgICAgICBpZiAobWVzc2FnZXNUb0JlQ29u\nc3VtZWQpCiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1\nZS50YWtlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzdWJzY3JpYmVUb1RvcGljcyhpbnQgYmF0Y2hTaXplKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkp\nCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU3Vic2NyaWJpbmcgdG8gdG9w\naWNzIGFuZCBzdGFydGluZyBkZWxpdmVyeS4iKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIFN1\nYnNjcmlwdGlvbk9wdGlvbnMgb3B0cyA9IFN1YnNjcmlwdGlvbk9wdGlvbnMu\nbmV3QnVpbGRlcigpCiAgICAgICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRh\nY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsK\nICAgICAgICAgICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZShnZXRUb3Bp\nYyhpKSwgbG9jYWxTdWJzY3JpYmVySWQsIG9wdHMsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFRlc3RDYWxsYmFjayhxdWV1\nZSksIG51bGwpOwogICAgICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2Uo\nKSk7CiAgICAgICAgfQoKICAgICAgICAvLyBTdGFydCBkZWxpdmVyeSBmb3Ig\ndGhlIHN1YnNjcmliZXIKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJh\ndGNoU2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIHN0YXJ0RGVsaXZlcnkoZ2V0\nVG9waWMoaSksIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1lc3NhZ2VI\nYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncm90ZWN0ZWQgdm9pZCBzaHV0RG93bkxhc3RTZXJ2ZXIoKSB7CiAgICAgICAg\naWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAgICBsb2dn\nZXIuZGVidWcoIlNodXR0aW5nIGRvd24gdGhlIGxhc3Qgc2VydmVyIGluIHRo\nZSBIZWR3aWcgaHViIGNsdXN0ZXIuIik7CiAgICAgICAgc2VydmVyc0xpc3Qu\nZ2V0KHNlcnZlcnNMaXN0LnNpemUoKSAtIDEpLnNodXRkb3duKCk7CiAgICAg\nICAgLy8gRHVlIHRvIGEgcG9zc2libGUgcmFjZSBjb25kaXRpb24sIGFmdGVy\nIHdlJ3ZlIHNodXRkb3duIHRoZSBzZXJ2ZXIsCiAgICAgICAgLy8gdGhlIGNs\naWVudCBjb3VsZCBzdGlsbCBiZSBjYWNoaW5nIHRoZSBjaGFubmVsIGNvbm5l\nY3Rpb24gdG8gdGhhdAogICAgICAgIC8vIHNlcnZlci4gSXQgaXMgcG9zc2li\nbGUgZm9yIGEgcHVibGlzaCByZXF1ZXN0IHRvIGdvIHRvIHRoZSBzaHV0ZG93\nbgogICAgICAgIC8vIHNlcnZlciB1c2luZyB0aGUgY2xvc2VkL3NodXRkb3du\nIGNoYW5uZWwgYmVmb3JlIHRoZSBjaGFubmVsCiAgICAgICAgLy8gZGlzY29u\nbmVjdCBsb2dpYyBraWNrcyBpbi4gV2hhdCBjb3VsZCBoYXBwZW4gaXMgdGhh\ndCB0aGUgcHVibGlzaAogICAgICAgIC8vIGlzIGRvbmUgc3VjY2Vzc2Z1bGx5\nIG9uIHRoZSBjaGFubmVsIGJ1dCB0aGUgc2VydmVyIG9uIHRoZSBvdGhlciBl\nbmQKICAgICAgICAvLyBjYW4ndC93b24ndCByZWFkIGl0LiBUaGlzIHB1Ymxp\nc2ggcmVxdWVzdCB3aWxsIHRpbWUgb3V0IGFuZCB0aGUKICAgICAgICAvLyBK\ndW5pdCB0ZXN0IHdpbGwgZmFpbC4gU2luY2UgdGhhdCBwYXJ0aWN1bGFyIHNj\nZW5hcmlvIGlzIG5vdCB3aGF0IGlzCiAgICAgICAgLy8gdGVzdGVkIGhlcmUs\nIHVzZSBhIHdvcmthcm91bmQgb2Ygc2xlZXBpbmcgaW4gdGhpcyB0aHJlYWQg\nKHNvIHRoZQogICAgICAgIC8vIGNoYW5uZWwgZGlzY29ubmVjdCBsb2dpYyBj\nYW4gY29tcGxldGUpIGJlZm9yZSB3ZSBwdWJsaXNoIGFnYWluLgogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIFRocmVhZC5zbGVlcCgxMDAwKTsKICAgICAg\nICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIGxvZ2dlci5lcnJvcigiVGhyZWFkIHdhcyBpbnRlcnJ1cHRlZCB3aGls\nZSBzbGVlcGluZyBhZnRlciBzaHV0dGluZyBkb3duIGxhc3Qgc2VydmVyISIs\nIGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBUaGlzIHRlc3RzIG91dCB0\naGUgbWFudWFsIHNlbmRpbmcgb2YgY29uc3VtZSBtZXNzYWdlcyB0byB0aGUg\nc2VydmVyCiAgICAvLyBpbnN0ZWFkIG9mIHJlbHlpbmcgb24gdGhlIGF1dG9t\nYXRpYyBzZW5kaW5nIGJ5IHRoZSBjbGllbnQgbGliIGZvciBpdC4KICAgIEBU\nZXN0KHRpbWVvdXQ9MTAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFudWFs\nQ29uc3VtZUNsaWVudCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEhl\nZHdpZ0NsaWVudCBteUNsaWVudCA9IG5ldyBIZWR3aWdDbGllbnQobmV3IFRl\nc3RDbGllbnRDb25maWd1cmF0aW9uKCkgewogICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaXNBdXRvU2VuZENvbnN1\nbWVNZXNzYWdlRW5hYmxlZCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9KTsKICAgICAgICBTdWJz\nY3JpYmVyIG15U3Vic2NyaWJlciA9IG15Q2xpZW50LmdldFN1YnNjcmliZXIo\nKTsKICAgICAgICBQdWJsaXNoZXIgbXlQdWJsaXNoZXIgPSBteUNsaWVudC5n\nZXRQdWJsaXNoZXIoKTsKICAgICAgICBCeXRlU3RyaW5nIG15VG9waWMgPSBn\nZXRUb3BpYygwKTsKICAgICAgICAvLyBTdWJzY3JpYmUgdG8gYSB0b3BpYyBh\nbmQgc3RhcnQgZGVsaXZlcnkgb24gaXQKICAgICAgICBTdWJzY3JpcHRpb25P\ncHRpb25zIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIo\nKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRh\nY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICBteVN1YnNj\ncmliZXIuYXN5bmNTdWJzY3JpYmUobXlUb3BpYywgbG9jYWxTdWJzY3JpYmVy\nSWQsIG9wdHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBhc3Nl\ncnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgc3RhcnREZWxpdmVyeSht\neVN1YnNjcmliZXIsIG15VG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcg\nVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIC8v\nIFB1Ymxpc2ggc29tZSBtZXNzYWdlcwogICAgICAgIGludCBiYXRjaFNpemUg\nPSAxMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsg\naSsrKSB7CiAgICAgICAgICAgIG15UHVibGlzaGVyLmFzeW5jUHVibGlzaCht\neVRvcGljLCBnZXRNc2coaSksIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBu\ndWxsKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwog\nICAgICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1ZS50YWtlKCkpOwog\nICAgICAgIH0KICAgICAgICAvLyBOb3cgbWFudWFsbHkgc2VuZCBhIGNvbnN1\nbWUgbWVzc2FnZSBmb3IgZWFjaCBtZXNzYWdlIHJlY2VpdmVkCiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAg\nICAgICBib29sZWFuIHN1Y2Nlc3MgPSB0cnVlOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgbXlTdWJzY3JpYmVyLmNvbnN1bWUobXlUb3Bp\nYywgbG9jYWxTdWJzY3JpYmVySWQsIE1lc3NhZ2VTZXFJZC5uZXdCdWlsZGVy\nKCkuc2V0TG9jYWxDb21wb25lbnQoaSArIDEpCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAuYnVpbGQoKSk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKENsaWVudE5vdFN1YnNjcmliZWRFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGFzc2VydFRydWUoc3VjY2Vzcyk7CiAgICAgICAgfQogICAg\nICAgIC8vIFNpbmNlIHRoZSBjb25zdW1lIGNhbGwgZXZlbnR1YWxseSBkb2Vz\nIGFuIGFzeW5jIHdyaXRlIHRvIHRoZSBOZXR0eQogICAgICAgIC8vIGNoYW5u\nZWwsIHRoZSB3cml0aW5nIG9mIHRoZSBjb25zdW1lIHJlcXVlc3RzIG1heSBu\nb3QgaGF2ZSBjb21wbGV0ZWQKICAgICAgICAvLyB5ZXQgYmVmb3JlIHdlIHN0\nb3AgdGhlIGNsaWVudC4gU2xlZXAgYSBsaXR0bGUgYmVmb3JlIHdlIHN0b3Ag\ndGhlCiAgICAgICAgLy8gY2xpZW50IGp1c3Qgc28gZXJyb3IgbWVzc2FnZXMg\nYXJlIG5vdCBsb2dnZWQuCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgVGhy\nZWFkLnNsZWVwKDEwMDApOwogICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVk\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJUaHJl\nYWQgd2FzIGludGVycnVwdGVkIHdoaWxlIHdhaXRpbmcgdG8gc3RvcCBjbGll\nbnQgZm9yIG1hbnVhbCBjb25zdW1lIHRlc3QhISIsIGUpOwogICAgICAgIH0K\nICAgICAgICBteUNsaWVudC5jbG9zZSgpOwogICAgfQoKICAgIEBUZXN0KHRp\nbWVvdXQ9MTAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0QXR0YWNoVG9TdWJz\nY3JpcHRpb25TdWNjZXNzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nQnl0ZVN0cmluZyB0b3BpYyA9IGdldFRvcGljKDApOwogICAgICAgIFN1YnNj\ncmlwdGlvbk9wdGlvbnMgb3B0czEgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5l\nd0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3Jl\nYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKCiAgICAg\nICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZSh0b3BpYywgbG9jYWxTdWJz\nY3JpYmVySWQsIG9wdHMxLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwpOwogICAgICAg\nIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAvLyBDbG9zZSB0\naGUgc3Vic2NyaXB0aW9uIGFzeW5jaHJvbm91c2x5CiAgICAgICAgc3Vic2Ny\naWJlci5hc3luY0Nsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBsb2NhbFN1YnNj\ncmliZXJJZCwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAg\nICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKCiAgICAgICAgU3Vic2Ny\naXB0aW9uT3B0aW9ucyBvcHRzMiA9IFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3\nQnVpbGRlcigpCiAgICAgICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2go\nQ3JlYXRlT3JBdHRhY2guQVRUQUNIKS5idWlsZCgpOwogICAgICAgIC8vIE5v\ndyB0cnkgdG8gYXR0YWNoIHRvIHRoZSBzdWJzY3JpcHRpb24KICAgICAgICBz\ndWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRvcGljLCBsb2NhbFN1YnNjcmli\nZXJJZCwgb3B0czIsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsK\nICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgLy8g\nU3RhcnQgZGVsaXZlcnkgYW5kIHB1Ymxpc2ggc29tZSBtZXNzYWdlcy4gTWFr\nZSBzdXJlIHRoZXkgYXJlIGNvbnN1bWVkCiAgICAgICAgLy8gY29ycmVjdGx5\nLgogICAgICAgIHN0YXJ0RGVsaXZlcnkodG9waWMsIGxvY2FsU3Vic2NyaWJl\ncklkLCBuZXcgVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwog\nICAgICAgIGludCBiYXRjaFNpemUgPSA1OwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAgcHVibGlz\naGVyLmFzeW5jUHVibGlzaCh0b3BpYywgZ2V0TXNnKGkpLCBuZXcgVGVzdENh\nbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgIGFzc2VydFRydWUo\ncXVldWUudGFrZSgpKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShjb25zdW1l\nUXVldWUudGFrZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QodGlt\nZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTZXJ2ZXJSZWRpcmVj\ndCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBiYXRjaFNpemUg\nPSAxMDsKICAgICAgICBwdWJsaXNoQmF0Y2goYmF0Y2hTaXplLCB0cnVlLCBm\nYWxzZSwgMCk7CiAgICB9CgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAg\nIHB1YmxpYyB2b2lkIHRlc3RTdWJzY3JpYmVBbmRDb25zdW1lKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDEwOwogICAg\nICAgIHN1YnNjcmliZVRvVG9waWNzKGJhdGNoU2l6ZSk7CiAgICAgICAgcHVi\nbGlzaEJhdGNoKGJhdGNoU2l6ZSwgdHJ1ZSwgdHJ1ZSwgMCk7CiAgICB9Cgog\nICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RT\nZXJ2ZXJGYWlsb3ZlclB1Ymxpc2hPbmx5KCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDEwOwogICAgICAgIHB1Ymxpc2hC\nYXRjaChiYXRjaFNpemUsIHRydWUsIGZhbHNlLCAwKTsKICAgICAgICBzaHV0\nRG93bkxhc3RTZXJ2ZXIoKTsKICAgICAgICBwdWJsaXNoQmF0Y2goYmF0Y2hT\naXplLCB0cnVlLCBmYWxzZSwgMSk7CiAgICB9CgogICAgQFRlc3QodGltZW91\ndD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RTZXJ2ZXJGYWlsb3Zlcigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBiYXRjaFNpemUgPSAx\nMDsKICAgICAgICBzdWJzY3JpYmVUb1RvcGljcyhiYXRjaFNpemUpOwogICAg\nICAgIHB1Ymxpc2hCYXRjaChiYXRjaFNpemUsIHRydWUsIHRydWUsIDApOwog\nICAgICAgIHNodXREb3duTGFzdFNlcnZlcigpOwogICAgICAgIHB1Ymxpc2hC\nYXRjaChiYXRjaFNpemUsIHRydWUsIHRydWUsIDEpOwogICAgfQoKICAgIEBU\nZXN0KHRpbWVvdXQ9MTAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0VW5zdWJz\nY3JpYmUoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5n\nIHRvcGljID0gZ2V0VG9waWMoMCk7CiAgICAgICAgU3Vic2NyaXB0aW9uT3B0\naW9ucyBvcHRzID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVyKCkK\nICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0YWNo\nLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxkKCk7CgogICAgICAgIHN1YnNjcmli\nZXIuYXN5bmNTdWJzY3JpYmUodG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBv\ncHRzLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIHN0YXJ0RGVsaXZl\ncnkodG9waWMsIGxvY2FsU3Vic2NyaWJlcklkLCBuZXcgVGVzdE1lc3NhZ2VI\nYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAgICAgIHB1Ymxpc2hlci5hc3lu\nY1B1Ymxpc2godG9waWMsIGdldE1zZygwKSwgbmV3IFRlc3RDYWxsYmFjayhx\ndWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgp\nKTsKICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1ZS50YWtlKCkpOwog\nICAgICAgIC8vIFNlbmQgYW4gVW5zdWJzY3JpYmUgcmVxdWVzdAogICAgICAg\nIHN1YnNjcmliZXIuYXN5bmNVbnN1YnNjcmliZSh0b3BpYywgbG9jYWxTdWJz\nY3JpYmVySWQsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAg\nICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgLy8gTm93\nIHB1Ymxpc2ggYSBtZXNzYWdlIGFuZCBtYWtlIHN1cmUgaXQgaXMgbm90IGNv\nbnN1bWVkIGJ5IHRoZSBjbGllbnQKICAgICAgICBwdWJsaXNoZXIuYXN5bmNQ\ndWJsaXNoKHRvcGljLCBnZXRNc2coMSksIG5ldyBUZXN0Q2FsbGJhY2socXVl\ndWUpLCBudWxsKTsKICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7\nCiAgICAgICAgLy8gV2FpdCBhIGxpdHRsZSBiaXQganVzdCBpbiBjYXNlIHRo\nZSBtZXNzYWdlIGhhbmRsZXIgaXMgc3RpbGwgYWN0aXZlLAogICAgICAgIC8v\nIGNvbnN1bWluZyB0aGUgbWVzc2FnZSwgYW5kIHRoZW4gcHV0dGluZyBhIHRy\ndWUgdmFsdWUgaW4gdGhlCiAgICAgICAgLy8gY29uc3VtZVF1ZXVlLgogICAg\nICAgIFRocmVhZC5zbGVlcCgxMDAwKTsKICAgICAgICAvLyBQdXQgYSBGYWxz\nZSB2YWx1ZSBvbiB0aGUgY29uc3VtZVF1ZXVlIHNvIHdlIGNhbiB2ZXJpZnkg\ndGhhdCBpdAogICAgICAgIC8vIGlzIG5vdCBibG9ja2VkIGJ5IGEgbWVzc2Fn\nZSBjb25zdW1lIGFjdGlvbiB3aGljaCBhbHJlYWR5IHB1dCBhIFRydWUKICAg\nICAgICAvLyB2YWx1ZSBpbnRvIHRoZSBxdWV1ZS4KICAgICAgICBuZXcgVGhy\nZWFkKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAg\nIENvbmN1cnJlbmN5VXRpbHMucHV0KGNvbnN1bWVRdWV1ZSwgZmFsc2UpOwog\nICAgICAgICAgICB9CiAgICAgICAgfSkuc3RhcnQoKTsKICAgICAgICBhc3Nl\ncnRGYWxzZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgIH0KCiAgICBAVGVz\ndCh0aW1lb3V0PTEwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFN5bmNVbnN1\nYnNjcmliZVdpdGhvdXRTdWJzY3JpcHRpb24oKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBib29sZWFuIHVuc3Vic2NyaWJlU3VjY2VzcyA9IGZhbHNl\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIudW5zdWJz\nY3JpYmUoZ2V0VG9waWMoMCksIGxvY2FsU3Vic2NyaWJlcklkKTsKICAgICAg\nICB9IGNhdGNoIChDbGllbnROb3RTdWJzY3JpYmVkRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgdW5zdWJzY3JpYmVTdWNjZXNzID0gdHJ1ZTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHsKICAgICAgICAgICAgdW5zdWJz\nY3JpYmVTdWNjZXNzID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGFzc2Vy\ndFRydWUodW5zdWJzY3JpYmVTdWNjZXNzKTsKICAgIH0KCiAgICBAVGVzdCh0\naW1lb3V0PTEwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdEFzeW5jVW5zdWJz\nY3JpYmVXaXRob3V0U3Vic2NyaXB0aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgc3Vic2NyaWJlci5hc3luY1Vuc3Vic2NyaWJlKGdldFRvcGlj\nKDApLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRlc3RDYWxsYmFjayhxdWV1\nZSksIG51bGwpOwogICAgICAgIGFzc2VydEZhbHNlKHF1ZXVlLnRha2UoKSk7\nCiAgICB9CgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2\nb2lkIHRlc3RDbG9zZVN1YnNjcmlwdGlvbigpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBnZXRUb3BpYygwKTsKICAg\nICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdHMgPSBTdWJzY3JpcHRpb25P\ncHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JB\ndHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQo\nKTsKICAgICAgICBzdWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRvcGljLCBs\nb2NhbFN1YnNjcmliZXJJZCwgb3B0cywgbmV3IFRlc3RDYWxsYmFjayhxdWV1\nZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsK\nICAgICAgICBzdGFydERlbGl2ZXJ5KHRvcGljLCBsb2NhbFN1YnNjcmliZXJJ\nZCwgbmV3IFRlc3RNZXNzYWdlSGFuZGxlcihjb25zdW1lUXVldWUpKTsKICAg\nICAgICBwdWJsaXNoZXIuYXN5bmNQdWJsaXNoKHRvcGljLCBnZXRNc2coMCks\nIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBhc3Nl\ncnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShjb25z\ndW1lUXVldWUudGFrZSgpKTsKICAgICAgICAvLyBDbG9zZSB0aGUgc3Vic2Ny\naXB0aW9uIGFzeW5jaHJvbm91c2x5CiAgICAgICAgc3Vic2NyaWJlci5hc3lu\nY0Nsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwg\nbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2Vy\ndFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAvLyBOb3cgcHVibGlzaCBh\nIG1lc3NhZ2UgYW5kIG1ha2Ugc3VyZSBpdCBpcyBub3QgY29uc3VtZWQgYnkg\ndGhlIGNsaWVudAogICAgICAgIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2godG9w\naWMsIGdldE1zZygxKSwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwp\nOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAv\nLyBXYWl0IGEgbGl0dGxlIGJpdCBqdXN0IGluIGNhc2UgdGhlIG1lc3NhZ2Ug\naGFuZGxlciBpcyBzdGlsbCBhY3RpdmUsCiAgICAgICAgLy8gY29uc3VtaW5n\nIHRoZSBtZXNzYWdlLCBhbmQgdGhlbiBwdXR0aW5nIGEgdHJ1ZSB2YWx1ZSBp\nbiB0aGUKICAgICAgICAvLyBjb25zdW1lUXVldWUuCiAgICAgICAgVGhyZWFk\nLnNsZWVwKDEwMDApOwogICAgICAgIC8vIFB1dCBhIEZhbHNlIHZhbHVlIG9u\nIHRoZSBjb25zdW1lUXVldWUgc28gd2UgY2FuIHZlcmlmeSB0aGF0IGl0CiAg\nICAgICAgLy8gaXMgbm90IGJsb2NrZWQgYnkgYSBtZXNzYWdlIGNvbnN1bWUg\nYWN0aW9uIHdoaWNoIGFscmVhZHkgcHV0IGEgVHJ1ZQogICAgICAgIC8vIHZh\nbHVlIGludG8gdGhlIHF1ZXVlLgogICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1\nbm5hYmxlKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAg\ncHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgQ29uY3VycmVu\nY3lVdGlscy5wdXQoY29uc3VtZVF1ZXVlLCBmYWxzZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9KS5zdGFydCgpOwogICAgICAgIGFzc2VydEZhbHNlKGNv\nbnN1bWVRdWV1ZS50YWtlKCkpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9\nMTAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3RhcnREZWxpdmVyeVR3aWNl\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3Bp\nYyA9IGdldFRvcGljKDApOwogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMg\nb3B0cyA9IFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAg\nICAgICAgIC5zZXRDcmVhdGVPckF0dGFjaChDcmVhdGVPckF0dGFjaC5DUkVB\nVEVfT1JfQVRUQUNIKS5idWlsZCgpOwoKICAgICAgICBzdWJzY3JpYmVyLmFz\neW5jU3Vic2NyaWJlKHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgb3B0cywg\nbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2Vy\ndFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICBzdGFydERlbGl2ZXJ5KHRv\ncGljLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRlc3RNZXNzYWdlSGFuZGxl\ncihjb25zdW1lUXVldWUpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBz\ndGFydERlbGl2ZXJ5KHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRl\nc3RNZXNzYWdlSGFuZGxlcihjb25zdW1lUXVldWUpKTsKICAgICAgICAgICAg\nZmFpbCgiU2hvdWxkIG5vdCByZWFjaCBoZXJlISIpOwogICAgICAgIH0gY2F0\nY2ggKEFscmVhZHlTdGFydERlbGl2ZXJ5RXhjZXB0aW9uIGUpIHsKICAgICAg\nICB9CiAgICB9CgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RTdG9wRGVsaXZlcnkoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBCeXRlU3RyaW5nIHRvcGljID0gZ2V0VG9waWMoMCk7CiAgICAg\nICAgU3Vic2NyaXB0aW9uT3B0aW9ucyBvcHRzID0gU3Vic2NyaXB0aW9uT3B0\naW9ucy5uZXdCdWlsZGVyKCkKICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0\nYWNoKENyZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxkKCk7\nCgogICAgICAgIHN1YnNjcmliZXIuYXN5bmNTdWJzY3JpYmUodG9waWMsIGxv\nY2FsU3Vic2NyaWJlcklkLCBvcHRzLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVl\nKSwgbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwog\nICAgICAgIHN0YXJ0RGVsaXZlcnkodG9waWMsIGxvY2FsU3Vic2NyaWJlcklk\nLCBuZXcgVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1ZSkpOwogICAg\nICAgIHB1Ymxpc2hlci5hc3luY1B1Ymxpc2godG9waWMsIGdldE1zZygwKSwg\nbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2Vy\ndFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICBhc3NlcnRUcnVlKGNvbnN1\nbWVRdWV1ZS50YWtlKCkpOwogICAgICAgIC8vIFN0b3AgdGhlIGRlbGl2ZXJ5\nIGZvciB0aGlzIHN1YnNjcmlwdGlvbgogICAgICAgIHN0b3BEZWxpdmVyeSh0\nb3BpYywgbG9jYWxTdWJzY3JpYmVySWQpOwogICAgICAgIC8vIFB1Ymxpc2gg\nc29tZSBtb3JlIG1lc3NhZ2VzIHNvIHRoZXkgYXJlIHF1ZXVlZCB1cCB0byBi\nZSBkZWxpdmVyZWQgdG8KICAgICAgICAvLyB0aGUgY2xpZW50CiAgICAgICAg\naW50IGJhdGNoU2l6ZSA9IDEwOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAgICAgICAgcHVibGlzaGVyLmFz\neW5jUHVibGlzaCh0b3BpYywgZ2V0TXNnKGkgKyAxKSwgbmV3IFRlc3RDYWxs\nYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgICAgICBhc3NlcnRUcnVlKHF1\nZXVlLnRha2UoKSk7CiAgICAgICAgfQogICAgICAgIC8vIFdhaXQgYSBsaXR0\nbGUgYml0IGp1c3QgaW4gY2FzZSB0aGUgbWVzc2FnZSBoYW5kbGVyIGlzIHN0\naWxsIGFjdGl2ZSwKICAgICAgICAvLyBjb25zdW1pbmcgdGhlIG1lc3NhZ2Us\nIGFuZCB0aGVuIHB1dHRpbmcgYSB0cnVlIHZhbHVlIGluIHRoZQogICAgICAg\nIC8vIGNvbnN1bWVRdWV1ZS4KICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7\nCiAgICAgICAgLy8gUHV0IGEgRmFsc2UgdmFsdWUgb24gdGhlIGNvbnN1bWVR\ndWV1ZSBzbyB3ZSBjYW4gdmVyaWZ5IHRoYXQgaXQKICAgICAgICAvLyBpcyBu\nb3QgYmxvY2tlZCBieSBhIG1lc3NhZ2UgY29uc3VtZSBhY3Rpb24gd2hpY2gg\nYWxyZWFkeSBwdXQgYSBUcnVlCiAgICAgICAgLy8gdmFsdWUgaW50byB0aGUg\ncXVldWUuCiAgICAgICAgbmV3IFRocmVhZChuZXcgUnVubmFibGUoKSB7CiAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChj\nb25zdW1lUXVldWUsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgIH0p\nLnN0YXJ0KCk7CiAgICAgICAgYXNzZXJ0RmFsc2UoY29uc3VtZVF1ZXVlLnRh\na2UoKSk7CiAgICAgICAgLy8gTm93IHN0YXJ0IGRlbGl2ZXJ5IGFnYWluIGFu\nZCB2ZXJpZnkgdGhhdCB0aGUgcXVldWVkIHVwIG1lc3NhZ2VzIGFyZQogICAg\nICAgIC8vIGNvbnN1bWVkCiAgICAgICAgc3RhcnREZWxpdmVyeSh0b3BpYywg\nbG9jYWxTdWJzY3JpYmVySWQsIG5ldyBUZXN0TWVzc2FnZUhhbmRsZXIoY29u\nc3VtZVF1ZXVlKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRj\naFNpemU7IGkrKykgewogICAgICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVR\ndWV1ZS50YWtlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0aW1l\nb3V0PTEwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdENvbnN1bWVkTWVzc2Fn\nZXNJbk9yZGVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0\ncmluZyB0b3BpYyA9IGdldFRvcGljKDApOwogICAgICAgIFN1YnNjcmlwdGlv\nbk9wdGlvbnMgb3B0cyA9IFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRl\ncigpCiAgICAgICAgICAgIC5zZXRDcmVhdGVPckF0dGFjaChDcmVhdGVPckF0\ndGFjaC5DUkVBVEVfT1JfQVRUQUNIKS5idWlsZCgpOwoKICAgICAgICBzdWJz\nY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRvcGljLCBsb2NhbFN1YnNjcmliZXJJ\nZCwgb3B0cywgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAg\nICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICBzdGFydERl\nbGl2ZXJ5KHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRlc3RNZXNz\nYWdlSGFuZGxlcihjb25zdW1lUXVldWUpKTsKICAgICAgICAvLyBOb3cgcHVi\nbGlzaCBzb21lIG1lc3NhZ2VzIGFuZCB2ZXJpZnkgdGhhdCB0aGV5IGFyZSBk\nZWxpdmVyZWQgaW4gb3JkZXIKICAgICAgICAvLyB0byB0aGUgc3Vic2NyaWJl\ncgogICAgICAgIGludCBiYXRjaFNpemUgPSAxMDA7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICBw\ndWJsaXNoZXIuYXN5bmNQdWJsaXNoKHRvcGljLCBnZXRNc2coaSksIG5ldyBU\nZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICB9CiAgICAgICAg\nLy8gV2UndmUgc2VudCBvdXQgYWxsIG9mIHRoZSBwdWJsaXNoIG1lc3NhZ2Vz\nIGFzeW5jaHJvbm91c2x5LAogICAgICAgIC8vIG5vdyB2ZXJpZnkgdGhhdCB0\naGV5IGFyZSBjb25zdW1lZCBpbiB0aGUgY29ycmVjdCBvcmRlci4KICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAgICAg\nICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgICAgICB9CiAg\nICB9CgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RDcmVhdGVTdWJzY3JpcHRpb25GYWlsdXJlKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IGdldFRvcGljKDAp\nOwogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0cyA9IFN1YnNjcmlw\ndGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgIC5zZXRDcmVh\ndGVPckF0dGFjaChDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKS5i\ndWlsZCgpOwoKICAgICAgICBzdWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRv\ncGljLCBsb2NhbFN1YnNjcmliZXJJZCwgb3B0cywgbmV3IFRlc3RDYWxsYmFj\nayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUudGFr\nZSgpKTsKICAgICAgICAvLyBDbG9zZSB0aGUgc3Vic2NyaXB0aW9uIGFzeW5j\naHJvbm91c2x5CiAgICAgICAgc3Vic2NyaWJlci5hc3luY0Nsb3NlU3Vic2Ny\naXB0aW9uKHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgbmV3IFRlc3RDYWxs\nYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydFRydWUocXVldWUu\ndGFrZSgpKTsKICAgICAgICAvLyBOb3cgdHJ5IHRvIGNyZWF0ZSB0aGUgc3Vi\nc2NyaXB0aW9uIHdoZW4gaXQgYWxyZWFkeSBleGlzdHMKICAgICAgICBTdWJz\nY3JpcHRpb25PcHRpb25zIG9wdHNDcmVhdGUgPSBTdWJzY3JpcHRpb25PcHRp\nb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRh\nY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFKS5idWlsZCgpOwoKICAgICAgICBz\ndWJzY3JpYmVyLmFzeW5jU3Vic2NyaWJlKHRvcGljLCBsb2NhbFN1YnNjcmli\nZXJJZCwgb3B0c0NyZWF0ZSwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51\nbGwpOwogICAgICAgIGFzc2VydEZhbHNlKHF1ZXVlLnRha2UoKSk7CiAgICB9\nCgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRl\nc3RDcmVhdGVTdWJzY3JpcHRpb25TdWNjZXNzKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IGdldFRvcGljKDApOwog\nICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0cyA9IFN1YnNjcmlwdGlv\nbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgIC5zZXRDcmVhdGVP\nckF0dGFjaChDcmVhdGVPckF0dGFjaC5DUkVBVEUpLmJ1aWxkKCk7CiAgICAg\nICAgc3Vic2NyaWJlci5hc3luY1N1YnNjcmliZSh0b3BpYywgbG9jYWxTdWJz\nY3JpYmVySWQsIG9wdHMsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxs\nKTsKICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAg\nc3RhcnREZWxpdmVyeSh0b3BpYywgbG9jYWxTdWJzY3JpYmVySWQsIG5ldyBU\nZXN0TWVzc2FnZUhhbmRsZXIoY29uc3VtZVF1ZXVlKSk7CiAgICAgICAgaW50\nIGJhdGNoU2l6ZSA9IDU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBi\nYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICBwdWJsaXNoZXIuYXN5bmNQ\ndWJsaXNoKHRvcGljLCBnZXRNc2coaSksIG5ldyBUZXN0Q2FsbGJhY2socXVl\ndWUpLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtl\nKCkpOwogICAgICAgICAgICBhc3NlcnRUcnVlKGNvbnN1bWVRdWV1ZS50YWtl\nKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTEwMDAw\nKQogICAgcHVibGljIHZvaWQgdGVzdEF0dGFjaFRvU3Vic2NyaXB0aW9uRmFp\nbHVyZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVTdHJpbmcg\ndG9waWMgPSBnZXRUb3BpYygwKTsKICAgICAgICBTdWJzY3JpcHRpb25PcHRp\nb25zIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQog\nICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2gu\nQVRUQUNIKS5idWlsZCgpOwoKICAgICAgICBzdWJzY3JpYmVyLmFzeW5jU3Vi\nc2NyaWJlKHRvcGljLCBsb2NhbFN1YnNjcmliZXJJZCwgb3B0cywgbmV3IFRl\nc3RDYWxsYmFjayhxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydEZhbHNl\nKHF1ZXVlLnRha2UoKSk7CiAgICB9CgogICAgLy8gVGhlIGZvbGxvd2luZyA0\nIHRlc3RzIGFyZSB0byBtYWtlIHN1cmUgdGhhdCB0aGUgc3Vic2NyaWJlcklk\nIHZhbGlkYXRpb24KICAgIC8vIHdvcmtzIHdoZW4gaXQgaXMgYSBsb2NhbCBz\ndWJzY3JpYmVyIGFuZCB3ZSdyZSBleHBlY3RpbmcgdGhlIHN1YnNjcmliZXJJ\nZAogICAgLy8gdG8gYmUgaW4gdGhlICJsb2NhbCIgc3BlY2lmaWMgZm9ybWF0\nLgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRl\nc3RTeW5jU3Vic2NyaWJlV2l0aEludmFsaWRTdWJzY3JpYmVySWQoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBib29sZWFuIHN1YnNjcmliZVN1Y2Nl\nc3MgPSBmYWxzZTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTdWJzY3Jp\ncHRpb25PcHRpb25zIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1\naWxkZXIoKQogICAgICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENy\nZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxkKCk7CiAgICAg\nICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKGdldFRvcGljKDApLCBodWJT\ndWJzY3JpYmVySWQsIG9wdHMpOwogICAgICAgIH0gY2F0Y2ggKEludmFsaWRT\ndWJzY3JpYmVySWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBzdWJzY3Jp\nYmVTdWNjZXNzID0gdHJ1ZTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZXgpIHsKICAgICAgICAgICAgc3Vic2NyaWJlU3VjY2VzcyA9IGZhbHNlOwog\nICAgICAgIH0KICAgICAgICBhc3NlcnRUcnVlKHN1YnNjcmliZVN1Y2Nlc3Mp\nOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9MTAwMDApCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0QXN5bmNTdWJzY3JpYmVXaXRoSW52YWxpZFN1YnNjcmliZXJJ\nZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN1YnNjcmlwdGlvbk9w\ndGlvbnMgb3B0cyA9IFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigp\nCiAgICAgICAgICAgIC5zZXRDcmVhdGVPckF0dGFjaChDcmVhdGVPckF0dGFj\naC5DUkVBVEVfT1JfQVRUQUNIKS5idWlsZCgpOwogICAgICAgIHN1YnNjcmli\nZXIuYXN5bmNTdWJzY3JpYmUoZ2V0VG9waWMoMCksIGh1YlN1YnNjcmliZXJJ\nZCwgb3B0cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5l\ndyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBhc3NlcnRG\nYWxzZShxdWV1ZS50YWtlKCkpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9\nMTAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3luY1Vuc3Vic2NyaWJlV2l0\naEludmFsaWRTdWJzY3JpYmVySWQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBib29sZWFuIHVuc3Vic2NyaWJlU3VjY2VzcyA9IGZhbHNlOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIudW5zdWJzY3JpYmUo\nZ2V0VG9waWMoMCksIGh1YlN1YnNjcmliZXJJZCk7CiAgICAgICAgfSBjYXRj\naCAoSW52YWxpZFN1YnNjcmliZXJJZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHVuc3Vic2NyaWJlU3VjY2VzcyA9IHRydWU7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgICAgIHVuc3Vic2NyaWJlU3Vj\nY2VzcyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBhc3NlcnRUcnVlKHVu\nc3Vic2NyaWJlU3VjY2Vzcyk7CiAgICB9CgogICAgQFRlc3QodGltZW91dD0x\nMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RBc3luY1Vuc3Vic2NyaWJlV2l0\naEludmFsaWRTdWJzY3JpYmVySWQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBzdWJzY3JpYmVyLmFzeW5jVW5zdWJzY3JpYmUoZ2V0VG9waWMoMCks\nIGh1YlN1YnNjcmliZXJJZCwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51\nbGwpOwogICAgICAgIGFzc2VydEZhbHNlKHF1ZXVlLnRha2UoKSk7CiAgICB9\nCgogICAgLy8gVGhlIGZvbGxvd2luZyA0IHRlc3RzIGFyZSB0byBtYWtlIHN1\ncmUgdGhhdCB0aGUgc3Vic2NyaWJlcklkIHZhbGlkYXRpb24KICAgIC8vIGFs\nc28gd29ya3Mgd2hlbiBpdCBpcyBhIGh1YiBzdWJzY3JpYmVyIGFuZCB3ZSdy\nZSBleHBlY3RpbmcgdGhlCiAgICAvLyBzdWJzY3JpYmVySWQgdG8gYmUgaW4g\ndGhlICJodWIiIHNwZWNpZmljIGZvcm1hdC4KICAgIEBUZXN0KHRpbWVvdXQ9\nMTAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3luY0h1YlN1YnNjcmliZVdp\ndGhJbnZhbGlkU3Vic2NyaWJlcklkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgQ2xpZW50IGh1YkNsaWVudCA9IG5ldyBIZWR3aWdIdWJDbGllbnQo\nbmV3IEh1YkNsaWVudENvbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgU3Vic2Ny\naWJlciBodWJTdWJzY3JpYmVyID0gaHViQ2xpZW50LmdldFN1YnNjcmliZXIo\nKTsKICAgICAgICBib29sZWFuIHN1YnNjcmliZVN1Y2Nlc3MgPSBmYWxzZTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25z\nIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAg\nICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0YWNo\nLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxkKCk7CiAgICAgICAgICAgIGh1YlN1\nYnNjcmliZXIuc3Vic2NyaWJlKGdldFRvcGljKDApLCBsb2NhbFN1YnNjcmli\nZXJJZCwgb3B0cyk7CiAgICAgICAgfSBjYXRjaCAoSW52YWxpZFN1YnNjcmli\nZXJJZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHN1YnNjcmliZVN1Y2Nl\nc3MgPSB0cnVlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCkgewog\nICAgICAgICAgICBzdWJzY3JpYmVTdWNjZXNzID0gZmFsc2U7CiAgICAgICAg\nfQogICAgICAgIGFzc2VydFRydWUoc3Vic2NyaWJlU3VjY2Vzcyk7CiAgICAg\nICAgaHViQ2xpZW50LmNsb3NlKCk7CiAgICB9CgogICAgQFRlc3QodGltZW91\ndD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RBc3luY0h1YlN1YnNjcmli\nZVdpdGhJbnZhbGlkU3Vic2NyaWJlcklkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgQ2xpZW50IGh1YkNsaWVudCA9IG5ldyBIZWR3aWdIdWJDbGll\nbnQobmV3IEh1YkNsaWVudENvbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgU3Vi\nc2NyaWJlciBodWJTdWJzY3JpYmVyID0gaHViQ2xpZW50LmdldFN1YnNjcmli\nZXIoKTsKICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdHMgPSBTdWJz\nY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0\nQ3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFD\nSCkuYnVpbGQoKTsKICAgICAgICBodWJTdWJzY3JpYmVyLmFzeW5jU3Vic2Ny\naWJlKGdldFRvcGljKDApLCBsb2NhbFN1YnNjcmliZXJJZCwgb3B0cywgbmV3\nIFRlc3RDYWxsYmFjaygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBxdWV1ZSksIG51bGwpOwogICAgICAgIGFzc2VydEZhbHNl\nKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgaHViQ2xpZW50LmNsb3NlKCk7CiAg\nICB9CgogICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RTeW5jSHViVW5zdWJzY3JpYmVXaXRoSW52YWxpZFN1YnNjcmliZXJJ\nZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENsaWVudCBodWJDbGll\nbnQgPSBuZXcgSGVkd2lnSHViQ2xpZW50KG5ldyBIdWJDbGllbnRDb25maWd1\ncmF0aW9uKCkpOwogICAgICAgIFN1YnNjcmliZXIgaHViU3Vic2NyaWJlciA9\nIGh1YkNsaWVudC5nZXRTdWJzY3JpYmVyKCk7CiAgICAgICAgYm9vbGVhbiB1\nbnN1YnNjcmliZVN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBodWJTdWJzY3JpYmVyLnVuc3Vic2NyaWJlKGdldFRvcGljKDAp\nLCBsb2NhbFN1YnNjcmliZXJJZCk7CiAgICAgICAgfSBjYXRjaCAoSW52YWxp\nZFN1YnNjcmliZXJJZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHVuc3Vi\nc2NyaWJlU3VjY2VzcyA9IHRydWU7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGV4KSB7CiAgICAgICAgICAgIHVuc3Vic2NyaWJlU3VjY2VzcyA9IGZh\nbHNlOwogICAgICAgIH0KICAgICAgICBhc3NlcnRUcnVlKHVuc3Vic2NyaWJl\nU3VjY2Vzcyk7CiAgICAgICAgaHViQ2xpZW50LmNsb3NlKCk7CiAgICB9Cgog\nICAgQFRlc3QodGltZW91dD0xMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RB\nc3luY0h1YlVuc3Vic2NyaWJlV2l0aEludmFsaWRTdWJzY3JpYmVySWQoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBDbGllbnQgaHViQ2xpZW50ID0g\nbmV3IEhlZHdpZ0h1YkNsaWVudChuZXcgSHViQ2xpZW50Q29uZmlndXJhdGlv\nbigpKTsKICAgICAgICBTdWJzY3JpYmVyIGh1YlN1YnNjcmliZXIgPSBodWJD\nbGllbnQuZ2V0U3Vic2NyaWJlcigpOwogICAgICAgIGh1YlN1YnNjcmliZXIu\nYXN5bmNVbnN1YnNjcmliZShnZXRUb3BpYygwKSwgbG9jYWxTdWJzY3JpYmVy\nSWQsIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICBh\nc3NlcnRGYWxzZShxdWV1ZS50YWtlKCkpOwogICAgICAgIGh1YkNsaWVudC5j\nbG9zZSgpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9MTAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0UHVibGlzaFdpdGhCb29rS2VlcGVyRXJyb3IoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgYmF0Y2hTaXplID0gMTA7\nCiAgICAgICAgcHVibGlzaEJhdGNoKGJhdGNoU2l6ZSwgdHJ1ZSwgZmFsc2Us\nIDApOwogICAgICAgIC8vIHN0b3AgYWxsIGJvb2tpZSBzZXJ2ZXJzCiAgICAg\nICAgYmt0Yi5zdG9wQWxsQm9va2llU2VydmVycygpOwogICAgICAgIC8vIGZv\nbGxvd2luZyBwdWJsaXNoIHdvdWxkIGZhaWxlZCB3aXRoIE5vdEVub3VnaEJv\nb2tpZXMKICAgICAgICBwdWJsaXNoQmF0Y2goYmF0Y2hTaXplLCBmYWxzZSwg\nZmFsc2UsIDEpOwogICAgICAgIC8vIHN0YXJ0IGFsbCBib29raWUgc2VydmVy\ncwogICAgICAgIGJrdGIuc3RhcnRBbGxCb29raWVTZXJ2ZXJzKCk7CiAgICAg\nICAgLy8gZm9sbG93aW5nIHB1Ymxpc2ggc2hvdWxkIHN1Y2NlZWQKICAgICAg\nICBwdWJsaXNoQmF0Y2goYmF0Y2hTaXplLCB0cnVlLCBmYWxzZSwgMSk7CiAg\nICB9Cn0K\n","encoding":"base64"}

