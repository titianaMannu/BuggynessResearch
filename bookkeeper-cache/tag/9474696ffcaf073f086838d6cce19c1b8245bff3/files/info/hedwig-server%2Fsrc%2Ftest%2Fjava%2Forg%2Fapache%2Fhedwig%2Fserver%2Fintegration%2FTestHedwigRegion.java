{"sha":"bce41e57525dc593e9fe65a45e32004b99ee0cfc","node_id":"MDQ6QmxvYjE1NzU5NTY6YmNlNDFlNTc1MjVkYzU5M2U5ZmU2NWE0NWUzMjAwNGI5OWVlMGNmYw==","size":13234,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/bce41e57525dc593e9fe65a45e32004b99ee0cfc","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaW50ZWdyYXRpb247Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5SYW5kb207CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TeW5jaHJv\nbm91c1F1ZXVlOwoKaW1wb3J0IG9yZy5qdW5pdC5CZWZvcmU7CmltcG9ydCBv\ncmcuanVuaXQuVGVzdDsKaW1wb3J0IG9yZy5qdW5pdC5ydW5uZXIuUnVuV2l0\naDsKaW1wb3J0IG9yZy5qdW5pdC5ydW5uZXJzLlBhcmFtZXRlcml6ZWQ7Cmlt\ncG9ydCBvcmcuanVuaXQucnVubmVycy5QYXJhbWV0ZXJpemVkLlBhcmFtZXRl\ncnM7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LkhlZHdpZ0NsaWVudDsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuUHVibGlzaGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1\nZXN0LkNyZWF0ZU9yQXR0YWNoOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uT3B0aW9uczsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5IZWR3aWdSZWdpb25U\nZXN0QmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21t\nb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnNlcnZlci5pbnRlZ3JhdGlvbi5UZXN0SGVkd2lnSHViLlRlc3RDYWxs\nYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5pbnRlZ3Jh\ndGlvbi5UZXN0SGVkd2lnSHViLlRlc3RNZXNzYWdlSGFuZGxlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuSGVkd2lnU29ja2V0QWRkcmVzczsK\nCmltcG9ydCBzdGF0aWMgb3JnLmp1bml0LkFzc2VydC4qOwoKQFJ1bldpdGgo\nUGFyYW1ldGVyaXplZC5jbGFzcykKcHVibGljIGNsYXNzIFRlc3RIZWR3aWdS\nZWdpb24gZXh0ZW5kcyBIZWR3aWdSZWdpb25UZXN0QmFzZSB7CgogICAgLy8g\nU3luY2hyb25vdXNRdWV1ZXMgdG8gdmVyaWZ5IGFzeW5jIGNhbGxzCiAgICBw\ncml2YXRlIGZpbmFsIFN5bmNocm9ub3VzUXVldWU8Qm9vbGVhbj4gcXVldWUg\nPSBuZXcgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPigpOwogICAgcHJpdmF0\nZSBmaW5hbCBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1bWVRdWV1\nZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgaW50IFRFU1RfUkVUUllfUkVNT1RFX1NVQlND\nUklCRV9JTlRFUlZBTF9WQUxVRSA9IDMwMDA7CgogICAgcHJvdGVjdGVkIGNs\nYXNzIE5ld1JlZ2lvblNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5kcyBSZWdp\nb25TZXJ2ZXJDb25maWd1cmF0aW9uIHsKCiAgICAgICAgcHVibGljIE5ld1Jl\nZ2lvblNlcnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBz\nc2xTZXJ2ZXJQb3J0LAogICAgICAgICAgICAgICAgU3RyaW5nIHJlZ2lvbk5h\nbWUpIHsKICAgICAgICAgICAgc3VwZXIoc2VydmVyUG9ydCwgc3NsU2VydmVy\nUG9ydCwgcmVnaW9uTmFtZSk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgaW50IGdldFJldHJ5UmVtb3RlU3Vic2NyaWJl\nVGhyZWFkUnVuSW50ZXJ2YWwoKSB7CiAgICAgICAgICAgIHJldHVybiBURVNU\nX1JFVFJZX1JFTU9URV9TVUJTQ1JJQkVfSU5URVJWQUxfVkFMVUU7CiAgICAg\nICAgfQoKICAgIH0KCiAgICBwcm90ZWN0ZWQgY2xhc3MgTmV3UmVnaW9uQ2xp\nZW50Q29uZmlndXJhdGlvbiBleHRlbmRzIENsaWVudENvbmZpZ3VyYXRpb24g\newogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBib29sZWFuIGlz\nU3Vic2NyaXB0aW9uQ2hhbm5lbFNoYXJpbmdFbmFibGVkKCkgewogICAgICAg\nICAgICByZXR1cm4gaXNTdWJzY3JpcHRpb25DaGFubmVsU2hhcmluZ0VuYWJs\nZWQ7CiAgICAgICAgfQogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBIZWR3aWdTb2NrZXRBZGRyZXNzIGdldERlZmF1bHRTZXJ2ZXJIZWR3aWdT\nb2NrZXRBZGRyZXNzKCkgewogICAgICAgICAgICByZXR1cm4gcmVnaW9uSHVi\nQWRkcmVzc2VzLmdldCgwKS5nZXQoMCk7CiAgICAgICAgfQogICAgfQoKICAg\nIHByb3RlY3RlZCBTZXJ2ZXJDb25maWd1cmF0aW9uIGdldFNlcnZlckNvbmZp\nZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0LCBT\ndHJpbmcgcmVnaW9uTmFtZSkgewogICAgICAgIHJldHVybiBuZXcgTmV3UmVn\naW9uU2VydmVyQ29uZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQ\nb3J0LCByZWdpb25OYW1lKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xpZW50\nQ29uZmlndXJhdGlvbiBnZXRSZWdpb25DbGllbnRDb25maWd1cmF0aW9uKCkg\newogICAgICAgIHJldHVybiBuZXcgTmV3UmVnaW9uQ2xpZW50Q29uZmlndXJh\ndGlvbigpOwogICAgfQoKICAgIEBQYXJhbWV0ZXJzCiAgICBwdWJsaWMgc3Rh\ndGljIENvbGxlY3Rpb248T2JqZWN0W10+IGNvbmZpZ3MoKSB7CiAgICAgICAg\ncmV0dXJuIEFycmF5cy5hc0xpc3QobmV3IE9iamVjdFtdW10geyB7IGZhbHNl\nIH0sIHsgdHJ1ZSB9IH0pOwogICAgfQoKICAgIHByb3RlY3RlZCBib29sZWFu\nIGlzU3Vic2NyaXB0aW9uQ2hhbm5lbFNoYXJpbmdFbmFibGVkOwoKICAgIHB1\nYmxpYyBUZXN0SGVkd2lnUmVnaW9uKGJvb2xlYW4gaXNTdWJzY3JpcHRpb25D\naGFubmVsU2hhcmluZ0VuYWJsZWQpIHsKICAgICAgICB0aGlzLmlzU3Vic2Ny\naXB0aW9uQ2hhbm5lbFNoYXJpbmdFbmFibGVkID0gaXNTdWJzY3JpcHRpb25D\naGFubmVsU2hhcmluZ0VuYWJsZWQ7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBAQmVmb3JlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIG51bVJlZ2lvbnMgPSAzOwogICAgICAgIG51bVNl\ncnZlcnNQZXJSZWdpb24gPSA0OwogICAgICAgIHN1cGVyLnNldFVwKCk7CiAg\nICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RNdWx0aVJlZ2lvblN1YnNjcmliZUFuZENvbnN1bWUoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpbnQgYmF0Y2hTaXplID0gMTA7CiAgICAg\nICAgLy8gU3Vic2NyaWJlIHRvIHRvcGljcyBmb3IgY2xpZW50cyBpbiBhbGwg\ncmVnaW9ucwogICAgICAgIGZvciAoSGVkd2lnQ2xpZW50IGNsaWVudCA6IHJl\nZ2lvbkNsaWVudHNNYXAudmFsdWVzKCkpIHsKICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICAg\nICAgU3Vic2NyaXB0aW9uT3B0aW9ucyBvcHRzID0gU3Vic2NyaXB0aW9uT3B0\naW9ucy5uZXdCdWlsZGVyKCkKICAgICAgICAgICAgICAgICAgICAuc2V0Q3Jl\nYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCku\nYnVpbGQoKTsKCiAgICAgICAgICAgICAgICBjbGllbnQuZ2V0U3Vic2NyaWJl\ncigpLmFzeW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJU\nb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmlu\nZy5jb3B5RnJvbVV0ZjgoIkxvY2FsU3Vic2NyaWJlciIpLCBvcHRzLCBuZXcg\nVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgICAgICBh\nc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIC8vIFN0YXJ0IGRlbGl2ZXJ5IGZvciB0aGUgbG9jYWwg\nc3Vic2NyaWJlcnMgaW4gYWxsIHJlZ2lvbnMKICAgICAgICBmb3IgKEhlZHdp\nZ0NsaWVudCBjbGllbnQgOiByZWdpb25DbGllbnRzTWFwLnZhbHVlcygpKSB7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBp\nKyspIHsKICAgICAgICAgICAgICAgIGNsaWVudC5nZXRTdWJzY3JpYmVyKCku\nc3RhcnREZWxpdmVyeShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVG9waWMi\nICsgaSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkxvY2Fs\nU3Vic2NyaWJlciIpLCBuZXcgVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1bWVR\ndWV1ZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBO\nb3cgc3RhcnQgcHVibGlzaGluZyBtZXNzYWdlcyBmb3IgdGhlIHN1YnNjcmli\nZWQgdG9waWNzIGluIG9uZSBvZiB0aGUKICAgICAgICAvLyByZWdpb25zIGFu\nZCB2ZXJpZnkgdGhhdCBpdCBnZXRzIGRlbGl2ZXJlZCBhbmQgY29uc3VtZWQg\naW4gYWxsIG9mIHRoZQogICAgICAgIC8vIG90aGVyIG9uZXMuCiAgICAgICAg\nUHVibGlzaGVyIHB1Ymxpc2hlciA9IHJlZ2lvbkNsaWVudHNNYXAudmFsdWVz\nKCkuaXRlcmF0b3IoKS5uZXh0KCkuZ2V0UHVibGlzaGVyKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAg\nICAgICBwdWJsaXNoZXIuYXN5bmNQdWJsaXNoKEJ5dGVTdHJpbmcuY29weUZy\nb21VdGY4KCJUb3BpYyIgKyBpKSwgTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0\nQm9keSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIk1lc3NhZ2UiICsgaSkpLmJ1aWxk\nKCksIG5ldyBUZXN0Q2FsbGJhY2socXVldWUpLCBudWxsKTsKICAgICAgICAg\nICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIH0KICAgICAg\nICAvLyBNYWtlIHN1cmUgZWFjaCByZWdpb24gY29uc3VtZXMgdGhlIHNhbWUg\nc2V0IG9mIHB1Ymxpc2hlZCBtZXNzYWdlcy4KICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHJlZ2lvbkNsaWVudHNNYXAuc2l6ZSgpOyBpKyspIHsKICAg\nICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBiYXRjaFNpemU7IGorKykg\newogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShjb25zdW1lUXVldWUudGFr\nZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFRlc3QgcmVnaW9uIHNodXRzIGRvd24gd2hlbiBmaXJzdCBzdWJz\nY3JpcHRpb24uCiAgICAgKgogICAgICogQHRocm93cyBFeGNlcHRpb24KICAg\nICAqLwogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RTdWJzY3JpYmVBbmRDb25zdW1lV2hlbkFSZWdpb25Eb3duKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IGJhdGNoU2l6ZSA9IDEwOwoK\nICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdHMgPSBTdWJzY3JpcHRp\nb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRl\nT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVp\nbGQoKTsKCiAgICAgICAgLy8gZmlyc3Qgc2h1dCBkb3duIGEgcmVnaW9uCiAg\nICAgICAgUmFuZG9tIHIgPSBuZXcgUmFuZG9tKCk7CiAgICAgICAgaW50IHJl\nZ2lvbklkID0gci5uZXh0SW50KG51bVJlZ2lvbnMpOwogICAgICAgIHN0b3BS\nZWdpb24ocmVnaW9uSWQpOwogICAgICAgIC8vIHN1YnNjcmliZSB0byB0b3Bp\nY3Mgd2hlbiBhIHJlZ2lvbiBzaHV0cyBkb3duCiAgICAgICAgZm9yIChIZWR3\naWdDbGllbnQgY2xpZW50IDogcmVnaW9uQ2xpZW50c01hcC52YWx1ZXMoKSkg\newogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsg\naSsrKSB7CiAgICAgICAgICAgICAgICBjbGllbnQuZ2V0U3Vic2NyaWJlcigp\nLmFzeW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUb3Bp\nYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkxv\nY2FsU3Vic2NyaWJlciIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRzLCBuZXcgVGVzdENhbGxi\nYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgICAgICBhc3NlcnRGYWxz\nZShxdWV1ZS50YWtlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICAvLyBzdGFydCByZWdpb24gZ2FpbgogICAgICAgIHN0YXJ0UmVnaW9u\nKHJlZ2lvbklkKTsKCiAgICAgICAgLy8gc3ViIGl0IGFnYWluCiAgICAgICAg\nZm9yIChNYXAuRW50cnk8U3RyaW5nLCBIZWR3aWdDbGllbnQ+IGVudHJ5IDog\ncmVnaW9uQ2xpZW50c01hcC5lbnRyeVNldCgpKSB7CiAgICAgICAgICAgIEhl\nZHdpZ0NsaWVudCBjbGllbnQgPSBlbnRyeS5nZXRWYWx1ZSgpOwogICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6ZTsgaSsrKSB7CiAg\nICAgICAgICAgICAgICBjbGllbnQuZ2V0U3Vic2NyaWJlcigpLmFzeW5jU3Vi\nc2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUb3BpYyIgKyBpKSwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkxvY2FsU3Vic2Ny\naWJlciIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBvcHRzLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVl\nKSwgbnVsbCk7CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRh\na2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFN0\nYXJ0IGRlbGl2ZXJ5IGZvciBsb2NhbCBzdWJzY3JpYmVycyBpbiBhbGwgcmVn\naW9ucwogICAgICAgIGZvciAoTWFwLkVudHJ5PFN0cmluZywgSGVkd2lnQ2xp\nZW50PiBlbnRyeSA6IHJlZ2lvbkNsaWVudHNNYXAuZW50cnlTZXQoKSkgewog\nICAgICAgICAgICBIZWR3aWdDbGllbnQgY2xpZW50ID0gZW50cnkuZ2V0VmFs\ndWUoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBiYXRjaFNp\nemU7IGkrKykgewogICAgICAgICAgICAgICAgY2xpZW50LmdldFN1YnNjcmli\nZXIoKS5zdGFydERlbGl2ZXJ5KEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJU\nb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgi\nTG9jYWxTdWJzY3JpYmVyIiksIG5ldyBUZXN0TWVzc2FnZUhhbmRsZXIoY29u\nc3VtZVF1ZXVlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8vIE5vdyBzdGFydCBwdWJsaXNoaW5nIG1lc3NhZ2VzIGZvciB0aGUgc3Vi\nc2NyaWJlZCB0b3BpY3MgaW4gb25lIG9mIHRoZQogICAgICAgIC8vIHJlZ2lv\nbnMgYW5kIHZlcmlmeSB0aGF0IGl0IGdldHMgZGVsaXZlcmVkIGFuZCBjb25z\ndW1lZCBpbiBhbGwgb2YgdGhlCiAgICAgICAgLy8gb3RoZXIgb25lcy4KICAg\nICAgICBpbnQgcmlkID0gci5uZXh0SW50KG51bVJlZ2lvbnMpOwogICAgICAg\nIFN0cmluZyByZWdpb25OYW1lID0gUkVHSU9OX1BSRUZJWCArIHJpZDsKICAg\nICAgICBQdWJsaXNoZXIgcHVibGlzaGVyID0gcmVnaW9uQ2xpZW50c01hcC5n\nZXQocmVnaW9uTmFtZSkuZ2V0UHVibGlzaGVyKCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICBw\ndWJsaXNoZXIuYXN5bmNQdWJsaXNoKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKCJUb3BpYyIgKyBpKSwgTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keSgK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5n\nLmNvcHlGcm9tVXRmOChyZWdpb25OYW1lICsgIi1NZXNzYWdlIiArIGkpKS5i\ndWlsZCgpLCBuZXcgVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAg\nICAgICAgIGFzc2VydFRydWUocXVldWUudGFrZSgpKTsKICAgICAgICB9CiAg\nICAgICAgLy8gTWFrZSBzdXJlIGVhY2ggcmVnaW9uIGNvbnN1bWVzIHRoZSBz\nYW1lIHNldCBvZiBwdWJsaXNoZWQgbWVzc2FnZXMuCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCByZWdpb25DbGllbnRzTWFwLnNpemUoKTsgaSsrKSB7\nCiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgYmF0Y2hTaXplOyBq\nKyspIHsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUoY29uc3VtZVF1ZXVl\nLnRha2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUZXN0IHJlZ2lvbiBzaHV0cyBkb3duIHdoZW4gYXR0YWNo\naW5nIGV4aXN0aW5nIHN1YnNjcmlwdGlvbnMuCiAgICAgKgogICAgICogQHRo\ncm93cyBFeGNlcHRpb24KICAgICAqLwogICAgQFRlc3QodGltZW91dD02MDAw\nMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RBdHRhY2hFeGlzdGluZ1N1YnNjcmlw\ndGlvbnNXaGVuQVJlZ2lvbkRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBpbnQgYmF0Y2hTaXplID0gMTA7CgogICAgICAgIFN1YnNjcmlwdGlv\nbk9wdGlvbnMgb3B0cyA9IFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRl\ncigpCiAgICAgICAgICAgIC5zZXRDcmVhdGVPckF0dGFjaChDcmVhdGVPckF0\ndGFjaC5DUkVBVEVfT1JfQVRUQUNIKS5idWlsZCgpOwoKICAgICAgICAvLyBz\ndWIgaXQgcmVtb3RlbHkgdG8gbWFrZSBzdWJzY3JpcHRpb25zIGV4aXN0ZWQK\nICAgICAgICBmb3IgKE1hcC5FbnRyeTxTdHJpbmcsIEhlZHdpZ0NsaWVudD4g\nZW50cnkgOiByZWdpb25DbGllbnRzTWFwLmVudHJ5U2V0KCkpIHsKICAgICAg\nICAgICAgSGVkd2lnQ2xpZW50IGNsaWVudCA9IGVudHJ5LmdldFZhbHVlKCk7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBp\nKyspIHsKICAgICAgICAgICAgICAgIGNsaWVudC5nZXRTdWJzY3JpYmVyKCku\nYXN5bmNTdWJzY3JpYmUoQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRvcGlj\nIiArIGkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiTG9j\nYWxTdWJzY3JpYmVyIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIG9wdHMsIG5ldyBUZXN0Q2FsbGJh\nY2socXVldWUpLCBudWxsKTsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUo\ncXVldWUudGFrZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgLy8gc3RvcCByZWdpb25zCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51\nbVJlZ2lvbnM7IGkrKykgewogICAgICAgICAgICBzdG9wUmVnaW9uKGkpOwog\nICAgICAgIH0KICAgICAgICAvLyBzdGFydCByZWdpb25zIGFnYWluCiAgICAg\nICAgZm9yIChpbnQgaT0wOyBpPG51bVJlZ2lvbnM7IGkrKykgewogICAgICAg\nICAgICBzdGFydFJlZ2lvbihpKTsKICAgICAgICB9CgogICAgICAgIC8vIGZp\ncnN0IHNodXQgZG93biBhIHJlZ2lvbgogICAgICAgIFJhbmRvbSByID0gbmV3\nIFJhbmRvbSgpOwogICAgICAgIGludCByZWdpb25JZCA9IHIubmV4dEludChu\ndW1SZWdpb25zKTsKICAgICAgICBzdG9wUmVnaW9uKHJlZ2lvbklkKTsKICAg\nICAgICAvLyBzdWJzY3JpYmUgdG8gdG9waWNzIHdoZW4gYSByZWdpb24gc2h1\ndHMgZG93bgogICAgICAgIC8vIGl0IHNob3VsZCBzdWNjZWVkIHNpbmNlIHRo\nZSBzdWJzY3JpcHRpb25zIGV4aXN0ZWQgYmVmb3JlCiAgICAgICAgZm9yIChI\nZWR3aWdDbGllbnQgY2xpZW50IDogcmVnaW9uQ2xpZW50c01hcC52YWx1ZXMo\nKSkgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJhdGNoU2l6\nZTsgaSsrKSB7CiAgICAgICAgICAgICAgICBjbGllbnQuZ2V0U3Vic2NyaWJl\ncigpLmFzeW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJU\nb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0Zjgo\nIkxvY2FsU3Vic2NyaWJlciIpLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRzLCBuZXcgVGVzdENh\nbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgICAgICBhc3NlcnRU\ncnVlKHF1ZXVlLnRha2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIC8vIFN0YXJ0IGRlbGl2ZXJ5IGZvciBsb2NhbCBzdWJzY3JpYmVy\ncyBpbiBhbGwgcmVnaW9ucwogICAgICAgIGZvciAoTWFwLkVudHJ5PFN0cmlu\nZywgSGVkd2lnQ2xpZW50PiBlbnRyeSA6IHJlZ2lvbkNsaWVudHNNYXAuZW50\ncnlTZXQoKSkgewogICAgICAgICAgICBIZWR3aWdDbGllbnQgY2xpZW50ID0g\nZW50cnkuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBiYXRjaFNpemU7IGkrKykgewogICAgICAgICAgICAgICAgY2xpZW50\nLmdldFN1YnNjcmliZXIoKS5zdGFydERlbGl2ZXJ5KEJ5dGVTdHJpbmcuY29w\neUZyb21VdGY4KCJUb3BpYyIgKyBpKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOCgiTG9jYWxTdWJzY3JpYmVyIiksIG5ldyBUZXN0TWVzc2Fn\nZUhhbmRsZXIoY29uc3VtZVF1ZXVlKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIC8vIHN0YXJ0IHJlZ2lvbiBhZ2FpbgogICAgICAgIHN0\nYXJ0UmVnaW9uKHJlZ2lvbklkKTsKICAgICAgICAvLyB3YWl0IGZvciByZXRy\neQogICAgICAgIFRocmVhZC5zbGVlcCgzICogVEVTVF9SRVRSWV9SRU1PVEVf\nU1VCU0NSSUJFX0lOVEVSVkFMX1ZBTFVFKTsKCiAgICAgICAgU3RyaW5nIHJl\nZ2lvbk5hbWUgPSBSRUdJT05fUFJFRklYICsgcmVnaW9uSWQ7CiAgICAgICAg\nSGVkd2lnQ2xpZW50IGNsaWVudCA9IHJlZ2lvbkNsaWVudHNNYXAuZ2V0KHJl\nZ2lvbk5hbWUpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hT\naXplOyBpKyspIHsKICAgICAgICAgICAgY2xpZW50LmdldFN1YnNjcmliZXIo\nKS5hc3luY1N1YnNjcmliZShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVG9w\naWMiICsgaSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkxvY2Fs\nU3Vic2NyaWJlciIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG9wdHMsIG5ldyBUZXN0Q2FsbGJhY2socXVl\ndWUpLCBudWxsKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtl\nKCkpOwogICAgICAgICAgICBjbGllbnQuZ2V0U3Vic2NyaWJlcigpLnN0YXJ0\nRGVsaXZlcnkoQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRvcGljIiArIGkp\nLAogICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKCJMb2NhbFN1YnNjcmliZXIiKSwgbmV3IFRlc3RNZXNzYWdlSGFuZGxlcihj\nb25zdW1lUXVldWUpKTsKICAgICAgICB9CgogICAgICAgIC8vIE5vdyBzdGFy\ndCBwdWJsaXNoaW5nIG1lc3NhZ2VzIGZvciB0aGUgc3Vic2NyaWJlZCB0b3Bp\nY3MgaW4gb25lIG9mIHRoZQogICAgICAgIC8vIHJlZ2lvbnMgYW5kIHZlcmlm\neSB0aGF0IGl0IGdldHMgZGVsaXZlcmVkIGFuZCBjb25zdW1lZCBpbiBhbGwg\nb2YgdGhlCiAgICAgICAgLy8gb3RoZXIgb25lcy4KICAgICAgICBQdWJsaXNo\nZXIgcHVibGlzaGVyID0gY2xpZW50LmdldFB1Ymxpc2hlcigpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHsKICAgICAg\nICAgICAgcHVibGlzaGVyLmFzeW5jUHVibGlzaChCeXRlU3RyaW5nLmNvcHlG\ncm9tVXRmOCgiVG9waWMiICsgaSksIE1lc3NhZ2UubmV3QnVpbGRlcigpLnNl\ndEJvZHkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgocmVnaW9uTmFtZSArICItTWVzc2FnZSIg\nKyBpKSkuYnVpbGQoKSwgbmV3IFRlc3RDYWxsYmFjayhxdWV1ZSksIG51bGwp\nOwogICAgICAgICAgICBhc3NlcnRUcnVlKHF1ZXVlLnRha2UoKSk7CiAgICAg\nICAgfQogICAgICAgIC8vIE1ha2Ugc3VyZSBlYWNoIHJlZ2lvbiBjb25zdW1l\ncyB0aGUgc2FtZSBzZXQgb2YgcHVibGlzaGVkIG1lc3NhZ2VzLgogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcmVnaW9uQ2xpZW50c01hcC5zaXplKCk7\nIGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGJhdGNo\nU2l6ZTsgaisrKSB7CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKGNvbnN1\nbWVRdWV1ZS50YWtlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

