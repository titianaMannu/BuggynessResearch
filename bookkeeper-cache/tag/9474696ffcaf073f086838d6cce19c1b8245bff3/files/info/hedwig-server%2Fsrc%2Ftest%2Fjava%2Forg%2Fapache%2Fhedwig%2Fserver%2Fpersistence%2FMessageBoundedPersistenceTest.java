{"sha":"8d78fc5c64fef3eeebfce7893c5fcad575a33f24","node_id":"MDQ6QmxvYjE1NzU5NTY6OGQ3OGZjNWM2NGZlZjNlZWViZmNlNzg5M2M1ZmNhZDU3NWEzM2YyNA==","size":12384,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8d78fc5c64fef3eeebfce7893c5fcad575a33f24","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3Jn\nLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQg\nc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LlRpbWVVbml0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJl\nbnQuYXRvbWljLkF0b21pY0ludGVnZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmNsaWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7CmltcG9ydCBjb20u\nZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nU3Vic2NyaWJlUmVxdWVzdC5DcmVhdGVPckF0dGFjaDsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNjcmlw\ndGlvbk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2Nv\nbC5QdWJTdWJQcm90b2NvbC5MZWRnZXJSYW5nZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLkxlZGdlclJhbmdl\nczsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLkNsaWVu\ndDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuU3Vic2Ny\naWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5hcGkuUHVi\nbGlzaGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYu\nQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnV0aWwuQ2FsbGJhY2s7CgppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLkhlZHdpZ0h1YlRlc3RCYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLmNvbW1vbi5TZXJ2ZXJDb25maWd1cmF0aW9uOwoKcHVibGlj\nIGNsYXNzIE1lc3NhZ2VCb3VuZGVkUGVyc2lzdGVuY2VUZXN0IGV4dGVuZHMg\nSGVkd2lnSHViVGVzdEJhc2UgewogICAgcHJvdGVjdGVkIHN0YXRpYyBMb2dn\nZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTWVzc2FnZUJv\ndW5kZWRQZXJzaXN0ZW5jZVRlc3QuY2xhc3MpOwoKICAgIHByb3RlY3RlZCBj\nbGFzcyBTbWFsbFJlYWRBaGVhZFNlcnZlckNvbmZpZ3VyYXRpb24KICAgICAg\nICBleHRlbmRzIEhlZHdpZ0h1YlRlc3RCYXNlLkh1YlNlcnZlckNvbmZpZ3Vy\nYXRpb24gewogICAgICAgIFNtYWxsUmVhZEFoZWFkU2VydmVyQ29uZmlndXJh\ndGlvbihpbnQgc2VydmVyUG9ydCwgaW50IHNzbFNlcnZlclBvcnQpIHsKICAg\nICAgICAgICAgc3VwZXIoc2VydmVyUG9ydCwgc3NsU2VydmVyUG9ydCk7CiAg\nICAgICAgfQogICAgICAgIHB1YmxpYyBsb25nIGdldE1heGltdW1DYWNoZVNp\nemUoKSB7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGludCBnZXRSZWFkQWhlYWRDb3VudCgpIHsKICAgICAgICAg\nICAgcmV0dXJuIDE7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdl\ndE1lc3NhZ2VzQ29uc3VtZWRUaHJlYWRSdW5JbnRlcnZhbCgpIHsKICAgICAg\nICAgICAgcmV0dXJuIDEwMDA7IC8vIHJ1biBldmVyeSBzZWNvbmQKICAgICAg\nICB9CiAgICB9CgogICAgcHJvdGVjdGVkIFNlcnZlckNvbmZpZ3VyYXRpb24g\nZ2V0U2VydmVyQ29uZmlndXJhdGlvbihpbnQgc2VydmVyUG9ydCwgaW50IHNz\nbFNlcnZlclBvcnQpIHsKICAgICAgICByZXR1cm4gbmV3IFNtYWxsUmVhZEFo\nZWFkU2VydmVyQ29uZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQ\nb3J0KTsKICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIE1lc3NhZ2VCb3VuZENs\naWVudENvbmZpZ3VyYXRpb24gZXh0ZW5kcyBIdWJDbGllbnRDb25maWd1cmF0\naW9uIHsKICAgICAgICBmaW5hbCBpbnQgbWVzc2FnZUJvdW5kOwoKICAgICAg\nICBwdWJsaWMgTWVzc2FnZUJvdW5kQ2xpZW50Q29uZmlndXJhdGlvbihpbnQg\nYm91bmQpIHsKICAgICAgICAgICAgdGhpcy5tZXNzYWdlQm91bmQgPSBib3Vu\nZDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBNZXNzYWdlQm91bmRDbGll\nbnRDb25maWd1cmF0aW9uKCkgewogICAgICAgICAgICB0aGlzKDUpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIGludCBnZXRTdWJzY3JpcHRpb25NZXNz\nYWdlQm91bmQoKSB7CiAgICAgICAgICAgIHJldHVybiBtZXNzYWdlQm91bmQ7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzZW5kWEV4cGVj\ndExhc3RZKFB1Ymxpc2hlciBwdWIsIFN1YnNjcmliZXIgc3ViLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYywg\nQnl0ZVN0cmluZyBzdWJpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsIGludCBYLCBmaW5hbCBpbnQgWSkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBYOyBpKyspIHsK\nICAgICAgICAgICAgcHViLnB1Ymxpc2godG9waWMsIE1lc3NhZ2UubmV3QnVp\nbGRlcigpLnNldEJvZHkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoU3RyaW5nLnZhbHVlT2YoaSkp\nKS5idWlsZCgpKTsKICAgICAgICB9CiAgICAgICAgU3Vic2NyaXB0aW9uT3B0\naW9ucyBvcHRzID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVyKCkK\nICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0YWNo\nLkFUVEFDSCkuYnVpbGQoKTsKICAgICAgICBzdWIuc3Vic2NyaWJlKHRvcGlj\nLCBzdWJpZCwgb3B0cyk7CgogICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIg\nZXhwZWN0ZWQgPSBuZXcgQXRvbWljSW50ZWdlcihYIC0gWSk7CiAgICAgICAg\nZmluYWwgQ291bnREb3duTGF0Y2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0\nY2goMSk7CiAgICAgICAgc3ViLnN0YXJ0RGVsaXZlcnkodG9waWMsIHN1Ymlk\nLCBuZXcgTWVzc2FnZUhhbmRsZXIgKCkgewogICAgICAgICAgICAgICAgc3lu\nY2hyb25pemVkIHB1YmxpYyB2b2lkIGRlbGl2ZXIoQnl0ZVN0cmluZyB0b3Bp\nYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgbXNnLCBDYWxsYmFjazxWb2lk\nPiBjYWxsYmFjaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgICAgICBpbnQgdmFsdWUgPSBJbnRlZ2Vy\nLnZhbHVlT2YobXNnLmdldEJvZHkoKS50b1N0cmluZ1V0ZjgoKSk7CgogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gZXhwZWN0ZWQuZ2V0\nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkLmlu\nY3JlbWVudEFuZEdldCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3IgY29u\nZGl0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJy\nb3IoIkRpZCBub3QgcmVjZWl2ZSBleHBlY3RlZCB2YWx1ZSwgZXhwZWN0ZWQg\ne30sIGdvdCB7fSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZXhwZWN0ZWQuZ2V0KCksIHZhbHVlKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGV4cGVjdGVkLnNldCgwKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChl\neHBlY3RlZC5nZXQoKSA9PSBYKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBsYXRjaC5jb3VudERvd24oKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRp\nb25GaW5pc2hlZChjb250ZXh0LCBudWxsKTsKICAgICAgICAgICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIlJlY2VpdmVkIGJhZCBtZXNzYWdlIiwgZSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGNoLmNvdW50RG93bigpOy8v\nIHdpbGwgZXJyb3Igb24gbWF0Y2gKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIGFzc2Vy\ndFRydWUoIlRpbWVkIG91dCB3YWl0aW5nIGZvciBtZXNzYWdlcyBZIGlzICIg\nKyBZCiAgICAgICAgICAgICAgICArICIgZXhwZWN0ZWQgaXMgY3VycmVudGx5\nICIgKyBleHBlY3RlZC5nZXQoKSwgbGF0Y2guYXdhaXQoMTAsIFRpbWVVbml0\nLlNFQ09ORFMpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBiZSBl\neHBlY3RlZCBtZXNzYWdlIHdpdGggIiArIFgsIFgsIGV4cGVjdGVkLmdldCgp\nKTsKCiAgICAgICAgc3ViLnN0b3BEZWxpdmVyeSh0b3BpYywgc3ViaWQpOwog\nICAgICAgIHN1Yi5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwog\nICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0QmFzaWNCb3VuZGluZygpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIENsaWVudCBjbGllbnQgPSBuZXcgSGVkd2lnQ2xpZW50KG5ldyBNZXNz\nYWdlQm91bmRDbGllbnRDb25maWd1cmF0aW9uKDUpKTsKICAgICAgICBQdWJs\naXNoZXIgcHViID0gY2xpZW50LmdldFB1Ymxpc2hlcigpOwogICAgICAgIFN1\nYnNjcmliZXIgc3ViID0gY2xpZW50LmdldFN1YnNjcmliZXIoKTsKCiAgICAg\nICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKCJiYXNpY0JvdW5kaW5nVG9waWMiKTsKICAgICAgICBCeXRlU3RyaW5nIHN1\nYmlkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoImJhc2ljQm91bmRpbmdT\ndWJJZCIpOwogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0cyA9IFN1\nYnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgIC5z\nZXRDcmVhdGVPckF0dGFjaChDcmVhdGVPckF0dGFjaC5DUkVBVEUpLmJ1aWxk\nKCk7CiAgICAgICAgc3ViLnN1YnNjcmliZSh0b3BpYywgc3ViaWQsIG9wdHMp\nOwogICAgICAgIHN1Yi5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQp\nOwoKICAgICAgICBzZW5kWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywg\nc3ViaWQsIDEwMDAsIDUpOwoKICAgICAgICBjbGllbnQuY2xvc2UoKTsKICAg\nIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQg\ndGVzdE11bHRpcGxlU3Vic2NyaWJlcnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJv\nbVV0ZjgoIm11bHRpU3ViVG9waWMiKTsKCiAgICAgICAgQ2xpZW50IGNsaWVu\ndCA9IG5ldyBIZWR3aWdDbGllbnQobmV3IEh1YkNsaWVudENvbmZpZ3VyYXRp\nb24oKSk7CiAgICAgICAgUHVibGlzaGVyIHB1YiA9IGNsaWVudC5nZXRQdWJs\naXNoZXIoKTsKICAgICAgICBTdWJzY3JpYmVyIHN1YiA9IGNsaWVudC5nZXRT\ndWJzY3JpYmVyKCk7CgogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0\naW9uczUgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAg\nICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JF\nQVRFKS5zZXRNZXNzYWdlQm91bmQoNSkuYnVpbGQoKTsKICAgICAgICBTdWJz\nY3JpcHRpb25PcHRpb25zIG9wdGlvbnMyMCA9IFN1YnNjcmlwdGlvbk9wdGlv\nbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAgIC5zZXRDcmVhdGVPckF0dGFj\naChDcmVhdGVPckF0dGFjaC5DUkVBVEUpLnNldE1lc3NhZ2VCb3VuZCgyMCku\nYnVpbGQoKTsKICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9wdGlvbnNV\nbmJvdW5kZWQgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQog\nICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2gu\nQ1JFQVRFKS5idWlsZCgpOwoKICAgICAgICBCeXRlU3RyaW5nIHN1YmlkNSA9\nIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJib3VuZDVTdWJJZCIpOwogICAg\nICAgIEJ5dGVTdHJpbmcgc3ViaWQyMCA9IEJ5dGVTdHJpbmcuY29weUZyb21V\ndGY4KCJib3VuZDIwU3ViSWQiKTsKICAgICAgICBCeXRlU3RyaW5nIHN1Ymlk\nVW5ib3VuZGVkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIm5vYm91bmRT\ndWJJZCIpOwoKICAgICAgICBzdWIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZDUs\nIG9wdGlvbnM1KTsKICAgICAgICBzdWIuY2xvc2VTdWJzY3JpcHRpb24odG9w\naWMsIHN1YmlkNSk7CiAgICAgICAgc2VuZFhFeHBlY3RMYXN0WShwdWIsIHN1\nYiwgdG9waWMsIHN1YmlkNSwgMTAwMCwgNSk7CgogICAgICAgIHN1Yi5zdWJz\nY3JpYmUodG9waWMsIHN1YmlkMjAsIG9wdGlvbnMyMCk7CiAgICAgICAgc3Vi\nLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZDIwKTsKICAgICAgICBz\nZW5kWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQyMCwgMTAw\nMCwgMjApOwoKICAgICAgICBzdWIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZFVu\nYm91bmRlZCwgb3B0aW9uc1VuYm91bmRlZCk7CiAgICAgICAgc3ViLmNsb3Nl\nU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZFVuYm91bmRlZCk7CgogICAgICAg\nIHNlbmRYRXhwZWN0TGFzdFkocHViLCBzdWIsIHRvcGljLCBzdWJpZFVuYm91\nbmRlZCwgMTAwMDAsIDEwMDAwKTsKICAgICAgICBzdWIudW5zdWJzY3JpYmUo\ndG9waWMsIHN1YmlkVW5ib3VuZGVkKTsKCiAgICAgICAgc2VuZFhFeHBlY3RM\nYXN0WShwdWIsIHN1YiwgdG9waWMsIHN1YmlkMjAsIDEwMDAsIDIwKTsKICAg\nICAgICBzdWIudW5zdWJzY3JpYmUodG9waWMsIHN1YmlkMjApOwoKICAgICAg\nICBzZW5kWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQ1LCAx\nMDAwLCA1KTsKICAgICAgICBzdWIudW5zdWJzY3JpYmUodG9waWMsIHN1Ymlk\nNSk7CgogICAgICAgIGNsaWVudC5jbG9zZSgpOwogICAgfQoKICAgIEBUZXN0\nKHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0VXBkYXRlTWVz\nc2FnZUJvdW5kKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0\ncmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJVcGRhdGVN\nZXNzYWdlQm91bmQiKTsKCiAgICAgICAgQ2xpZW50IGNsaWVudCA9IG5ldyBI\nZWR3aWdDbGllbnQobmV3IEh1YkNsaWVudENvbmZpZ3VyYXRpb24oKSk7CiAg\nICAgICAgUHVibGlzaGVyIHB1YiA9IGNsaWVudC5nZXRQdWJsaXNoZXIoKTsK\nICAgICAgICBTdWJzY3JpYmVyIHN1YiA9IGNsaWVudC5nZXRTdWJzY3JpYmVy\nKCk7CgogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0aW9uczUgPSBT\ndWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAu\nc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FU\nVEFDSCkuc2V0TWVzc2FnZUJvdW5kKDUpLmJ1aWxkKCk7CiAgICAgICAgU3Vi\nc2NyaXB0aW9uT3B0aW9ucyBvcHRpb25zMjAgPSBTdWJzY3JpcHRpb25PcHRp\nb25zLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRh\nY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuc2V0TWVzc2Fn\nZUJvdW5kKDIwKS5idWlsZCgpOwogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlv\nbnMgb3B0aW9uczEwID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVy\nKCkKICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0\nYWNoLkNSRUFURV9PUl9BVFRBQ0gpLnNldE1lc3NhZ2VCb3VuZCgxMCkuYnVp\nbGQoKTsKCiAgICAgICAgQnl0ZVN0cmluZyBzdWJpZCA9IEJ5dGVTdHJpbmcu\nY29weUZyb21VdGY4KCJ1cGRhdGVTdWJJZCIpOwoKICAgICAgICBzdWIuc3Vi\nc2NyaWJlKHRvcGljLCBzdWJpZCwgb3B0aW9uczUpOwogICAgICAgIHN1Yi5j\nbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwogICAgICAgIHNlbmRY\nRXhwZWN0TGFzdFkocHViLCBzdWIsIHRvcGljLCBzdWJpZCwgNTAsIDUpOwoK\nICAgICAgICAvLyB1cGRhdGUgYm91bmQgdG8gMjAKICAgICAgICBzdWIuc3Vi\nc2NyaWJlKHRvcGljLCBzdWJpZCwgb3B0aW9uczIwKTsKICAgICAgICBzdWIu\nY2xvc2VTdWJzY3JpcHRpb24odG9waWMsIHN1YmlkKTsKICAgICAgICBzZW5k\nWEV4cGVjdExhc3RZKHB1Yiwgc3ViLCB0b3BpYywgc3ViaWQsIDUwLCAyMCk7\nCgogICAgICAgIC8vIHVwZGF0ZSBib3VuZCB0byAxMAogICAgICAgIHN1Yi5z\ndWJzY3JpYmUodG9waWMsIHN1YmlkLCBvcHRpb25zMTApOwogICAgICAgIHN1\nYi5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3ViaWQpOwogICAgICAgIHNl\nbmRYRXhwZWN0TGFzdFkocHViLCBzdWIsIHRvcGljLCBzdWJpZCwgNTAsIDEw\nKTsKCiAgICAgICAgLy8gbWVzc2FnZSBib3VuZCBpcyBub3QgcHJvdmlkZWQs\nIG5vIHVwZGF0ZQogICAgICAgIFN1YnNjcmlwdGlvbk9wdGlvbnMgb3B0cyA9\nIFN1YnNjcmlwdGlvbk9wdGlvbnMubmV3QnVpbGRlcigpCiAgICAgICAgICAg\nIC5zZXRDcmVhdGVPckF0dGFjaChDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1Jf\nQVRUQUNIKS5idWlsZCgpOwogICAgICAgIHN1Yi5zdWJzY3JpYmUodG9waWMs\nIHN1YmlkLCBvcHRzKTsKICAgICAgICBzdWIuY2xvc2VTdWJzY3JpcHRpb24o\ndG9waWMsIHN1YmlkKTsKICAgICAgICBzZW5kWEV4cGVjdExhc3RZKHB1Yiwg\nc3ViLCB0b3BpYywgc3ViaWQsIDUwLCAxMCk7CgogICAgICAgIGNsaWVudC5j\nbG9zZSgpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0TGVkZ2VyR0MoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBDbGllbnQgY2xpZW50ID0gbmV3IEhlZHdpZ0NsaWVudChuZXcg\nTWVzc2FnZUJvdW5kQ2xpZW50Q29uZmlndXJhdGlvbigpKTsKICAgICAgICBQ\ndWJsaXNoZXIgcHViID0gY2xpZW50LmdldFB1Ymxpc2hlcigpOwogICAgICAg\nIFN1YnNjcmliZXIgc3ViID0gY2xpZW50LmdldFN1YnNjcmliZXIoKTsKCiAg\nICAgICAgU3RyaW5nIGxlZGdlcnNQYXRoID0gIi9oZWR3aWcvc3RhbmRhbG9u\nZS90b3BpY3MvdGVzdEdDVG9waWMvbGVkZ2VycyI7CiAgICAgICAgQnl0ZVN0\ncmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0ZXN0R0NU\nb3BpYyIpOwogICAgICAgIEJ5dGVTdHJpbmcgc3ViaWQgPSBCeXRlU3RyaW5n\nLmNvcHlGcm9tVXRmOCgidGVzdEdDU3ViSWQiKTsKICAgICAgICBTdWJzY3Jp\ncHRpb25PcHRpb25zIG9wdHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1\naWxkZXIoKQogICAgICAgICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRl\nT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICBz\ndWIuc3Vic2NyaWJlKHRvcGljLCBzdWJpZCwgb3B0cyk7CiAgICAgICAgc3Vi\nLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJpZCk7CgogICAgICAgIGZv\nciAoaW50IGkgPSAxOyBpIDw9IDEwMDsgaSsrKSB7CiAgICAgICAgICAgIHB1\nYi5wdWJsaXNoKHRvcGljLCBNZXNzYWdlLm5ld0J1aWxkZXIoKS5zZXRCb2R5\nKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcu\nY29weUZyb21VdGY4KFN0cmluZy52YWx1ZU9mKGkpKSkuYnVpbGQoKSk7CiAg\nICAgICAgfQogICAgICAgIExlZGdlclJhbmdlcyByID0gTGVkZ2VyUmFuZ2Vz\nLnBhcnNlRnJvbShia3RiLmdldFpvb0tlZXBlckNsaWVudCgpLmdldERhdGEo\nbGVkZ2Vyc1BhdGgsIGZhbHNlLCBudWxsKSk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJTaG91bGQgb25seSBoYXZlIDEgbGVkZ2VyIHlldCIsIDEsIHIuZ2V0\nUmFuZ2VzTGlzdCgpLnNpemUoKSk7CiAgICAgICAgbG9uZyBmaXJzdExlZGdl\nciA9IHIuZ2V0UmFuZ2VzTGlzdCgpLmdldCgwKS5nZXRMZWRnZXJJZCgpOwoK\nICAgICAgICBzdG9wSHViU2VydmVycygpOwogICAgICAgIHN0YXJ0SHViU2Vy\ndmVycygpOwoKICAgICAgICBwdWIucHVibGlzaCh0b3BpYywgTWVzc2FnZS5u\nZXdCdWlsZGVyKCkuc2V0Qm9keSgKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KFN0cmluZy52YWx1ZU9mKDB4\nZGVhZGJlZWYpKSkuYnVpbGQoKSk7CgogICAgICAgIHIgPSBMZWRnZXJSYW5n\nZXMucGFyc2VGcm9tKGJrdGIuZ2V0Wm9vS2VlcGVyQ2xpZW50KCkuZ2V0RGF0\nYShsZWRnZXJzUGF0aCwgZmFsc2UsIG51bGwpKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoIlNob3VsZCBoYXZlIDIgbGVkZ2VycyBhZnRlciByZXN0YXJ0Iiwg\nMiwgci5nZXRSYW5nZXNMaXN0KCkuc2l6ZSgpKTsKCiAgICAgICAgZm9yIChp\nbnQgaSA9IDEwMDsgaSA8PSAyMDA7IGkrKykgewogICAgICAgICAgICBwdWIu\ncHVibGlzaCh0b3BpYywgTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keSgK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOChTdHJpbmcudmFsdWVPZihpKSkpLmJ1aWxkKCkpOwogICAg\nICAgIH0KICAgICAgICBUaHJlYWQuc2xlZXAoNTAwMCk7IC8vIGdpdmUgR0Mg\nYSBjaGFuY2UgdG8gaGFwcGVuCgogICAgICAgIHIgPSBMZWRnZXJSYW5nZXMu\ncGFyc2VGcm9tKGJrdGIuZ2V0Wm9vS2VlcGVyQ2xpZW50KCkuZ2V0RGF0YShs\nZWRnZXJzUGF0aCwgZmFsc2UsIG51bGwpKTsKICAgICAgICBsb25nIHNlY29u\nZExlZGdlciA9IHIuZ2V0UmFuZ2VzTGlzdCgpLmdldCgwKS5nZXRMZWRnZXJJ\nZCgpOwoKICAgICAgICBhc3NlcnRFcXVhbHMoIlNob3VsZCBvbmx5IGhhdmUg\nMSBsZWRnZXIgYWZ0ZXIgR0MiLCAxLCByLmdldFJhbmdlc0xpc3QoKS5zaXpl\nKCkpOwoKICAgICAgICAvLyBlbnN1cmUgb3JpZ2luYWwgbGVkZ2VyIGRvZXNu\nJ3QgZXhpc3QKICAgICAgICBTdHJpbmcgZmlyc3RMZWRnZXJQYXRoID0gU3Ry\naW5nLmZvcm1hdCgiL2xlZGdlcnMvTCUwMTBkIiwgZmlyc3RMZWRnZXIpOwog\nICAgICAgIFN0cmluZyBzZWNvbmRMZWRnZXJQYXRoID0gU3RyaW5nLmZvcm1h\ndCgiL2xlZGdlcnMvTCUwMTBkIiwgc2Vjb25kTGVkZ2VyKTsKICAgICAgICBh\nc3NlcnROdWxsKCJMZWRnZXIgc2hvdWxkIG5vdCBleGlzdCIsIGJrdGIuZ2V0\nWm9vS2VlcGVyQ2xpZW50KCkuZXhpc3RzKGZpcnN0TGVkZ2VyUGF0aCwgZmFs\nc2UpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKCJMZWRnZXIgc2hvdWxkIGV4\naXN0IiwgYmt0Yi5nZXRab29LZWVwZXJDbGllbnQoKS5leGlzdHMoc2Vjb25k\nTGVkZ2VyUGF0aCwgZmFsc2UpKTsKCiAgICAgICAgY2xpZW50LmNsb3NlKCk7\nCiAgICB9Cn0K\n","encoding":"base64"}

