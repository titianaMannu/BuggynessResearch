{"sha":"045935912951da96ad42aad36a6ef9a4ba6fac9d","node_id":"MDQ6QmxvYjE1NzU5NTY6MDQ1OTM1OTEyOTUxZGE5NmFkNDJhYWQzNmE2ZWY5YTRiYTZmYWM5ZA==","size":32974,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/045935912951da96ad42aad36a6ef9a4ba6fac9d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25j\ndXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5TY2hlZHVsZWRFeGVjdXRvclNlcnZpY2U7CmltcG9ydCBq\nYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhvcmU7CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIudmVyc2lvbmluZy5WZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLnZlcnNpb25pbmcuVmVyc2lvbmVkOwoKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLkhlbHBlck1ldGhvZHM7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5TdHViQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTGVk\nZ2VyUmFuZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5Q\ndWJTdWJQcm90b2NvbC5MZWRnZXJSYW5nZXM7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nTWVzc2FnZVNlcUlkOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9j\nb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdDsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlN1YnNj\ncmliZVJlcXVlc3QuQ3JlYXRlT3JBdHRhY2g7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25E\nYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLmNvbW1vbi5T\nZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nc2VydmVyLm1ldGEuTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRhLlN1YnNjcmlwdGlvbkRhdGFN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLm1ldGEu\nVG9waWNPd25lcnNoaXBNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLm1ldGEuVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9ucy5NTVN1\nYnNjcmlwdGlvbk1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5z\nZXJ2ZXIudG9waWNzLlRvcGljTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnNlcnZlci50b3BpY3MuVHJpdmlhbE93bkFsbFRvcGljTWFuYWdl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNvbmN1cnJlbmN5VXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkVpdGhlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5q\ndW5pdC5BZnRlcjsKaW1wb3J0IG9yZy5qdW5pdC5CZWZvcmU7CmltcG9ydCBv\ncmcuanVuaXQuVGVzdDsKaW1wb3J0IG9yZy5qdW5pdC5ydW5uZXIuUnVuV2l0\naDsKaW1wb3J0IG9yZy5qdW5pdC5ydW5uZXJzLlBhcmFtZXRlcml6ZWQ7Cmlt\ncG9ydCBvcmcuanVuaXQucnVubmVycy5QYXJhbWV0ZXJpemVkLlBhcmFtZXRl\ncnM7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5C\neXRlU3RyaW5nOwoKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7\nCgpAUnVuV2l0aChQYXJhbWV0ZXJpemVkLmNsYXNzKQpwdWJsaWMgY2xhc3Mg\nVGVzdEJvb2tLZWVwZXJQZXJzaXN0ZW5jZU1hbmFnZXIgewogICAgc3RhdGlj\nIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihUZXN0\nUGVyc2lzdGVuY2VNYW5hZ2VyQmxhY2tCb3guY2xhc3MpOwoKICAgIEJvb2tL\nZWVwZXJUZXN0QmFzZSBia3RiOwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgbnVt\nQm9va2llcyA9IDM7CiAgICBwcml2YXRlIGZpbmFsIGxvbmcgcmVhZERlbGF5\nID0gMjAwMEw7CiAgICBwcml2YXRlIGZpbmFsIGludCBtYXhFbnRyaWVzUGVy\nTGVkZ2VyID0gMTA7CgogICAgU2VydmVyQ29uZmlndXJhdGlvbiBjb25mOwog\nICAgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcjsKCiAgICBU\nb3BpY01hbmFnZXIgdG07CiAgICBCb29ra2VlcGVyUGVyc2lzdGVuY2VNYW5h\nZ2VyIG1hbmFnZXI7CiAgICBQdWJTdWJFeGNlcHRpb24gZmFpbHVyZUV4Y2Vw\ndGlvbiA9IG51bGw7CiAgICBUZXN0TWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSBt\nZXRhZGF0YU1hbmFnZXJGYWN0b3J5OwogICAgVG9waWNQZXJzaXN0ZW5jZU1h\nbmFnZXIgdHBNYW5hZ2VyOwogICAgTU1TdWJzY3JpcHRpb25NYW5hZ2VyIHNt\nOwoKICAgIGJvb2xlYW4gcmVtb3ZlU3RhcnRTZXFJZDsKCiAgICBzdGF0aWMg\nY2xhc3MgVGVzdE1ldGFkYXRhTWFuYWdlckZhY3RvcnkgZXh0ZW5kcyBNZXRh\nZGF0YU1hbmFnZXJGYWN0b3J5IHsKCiAgICAgICAgZmluYWwgTWV0YWRhdGFN\nYW5hZ2VyRmFjdG9yeSBmYWN0b3J5OwogICAgICAgIGludCBzZXJ2aWNlRG93\nbkNvdW50ID0gMDsKCiAgICAgICAgVGVzdE1ldGFkYXRhTWFuYWdlckZhY3Rv\ncnkoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLCBab29LZWVwZXIgemspIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBmYWN0b3J5ID0gTWV0YWRh\ndGFNYW5hZ2VyRmFjdG9yeS5uZXdNZXRhZGF0YU1hbmFnZXJGYWN0b3J5KGNv\nbmYsIHprKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldFNl\ncnZpY2VEb3duQ291bnQoaW50IGNvdW50KSB7CiAgICAgICAgICAgIHRoaXMu\nc2VydmljZURvd25Db3VudCA9IGNvdW50OwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBnZXRDdXJyZW50VmVyc2lv\nbigpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuZ2V0Q3VycmVudFZl\ncnNpb24oKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHByb3RlY3RlZCBNZXRhZGF0YU1hbmFnZXJGYWN0b3J5IGluaXRpYWxpemUo\nCiAgICAgICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnLCBab29LZWVw\nZXIgemssIGludCB2ZXJzaW9uKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgICAgICAvLyBkbyBub3RoaW5nCiAgICAgICAgICAgIHJldHVybiBmYWN0\nb3J5OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIHZvaWQgc2h1dGRvd24oKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgICAgICBmYWN0b3J5LnNodXRkb3duKCk7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgSXRlcmF0b3I8Qnl0ZVN0cmlu\nZz4gZ2V0VG9waWNzKCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgcmV0dXJuIGZhY3RvcnkuZ2V0VG9waWNzKCk7CiAgICAgICAgfQoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVG9waWNQZXJzaXN0ZW5j\nZU1hbmFnZXIgbmV3VG9waWNQZXJzaXN0ZW5jZU1hbmFnZXIoKSB7CiAgICAg\nICAgICAgIGZpbmFsIFRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyIG1hbmFnZXIg\nPSBmYWN0b3J5Lm5ld1RvcGljUGVyc2lzdGVuY2VNYW5hZ2VyKCk7CiAgICAg\nICAgICAgIHJldHVybiBuZXcgVG9waWNQZXJzaXN0ZW5jZU1hbmFnZXIoKSB7\nCgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBw\ndWJsaWMgdm9pZCBjbG9zZSgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICAgICAgbWFuYWdlci5jbG9zZSgpOwogICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgcmVhZFRvcGljUGVyc2lzdGVuY2VJbmZvKEJ5dGVT\ndHJpbmcgdG9waWMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2s8VmVyc2lvbmVkPExlZGdl\nclJhbmdlcz4+IGNhbGxiYWNrLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHNlcnZpY2VEb3duQ291bnQgPiAwKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIC0tc2VydmljZURvd25Db3VudDsKICAgICAgICAg\nICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwg\nbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbigiTWV0\nYWRhdGEgU3RvcmUgaXMgZG93biIpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICBtYW5hZ2VyLnJlYWRUb3BpY1BlcnNpc3RlbmNlSW5mbyh0b3Bp\nYywgY2FsbGJhY2ssIGN0eCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHdyaXRlVG9waWNQZXJzaXN0ZW5jZUluZm8oQnl0ZVN0cmluZyB0b3BpYywg\nTGVkZ2VyUmFuZ2VzIHJhbmdlcywgVmVyc2lvbiB2ZXJzaW9uLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBDYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewog\nICAgICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlRG93bkNvdW50ID4gMCkg\newogICAgICAgICAgICAgICAgICAgICAgICAtLXNlcnZpY2VEb3duQ291bnQ7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZh\naWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNl\ncHRpb24oIk1ldGFkYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgbWFuYWdlci53cml0ZVRvcGljUGVyc2lzdGVu\nY2VJbmZvKHRvcGljLCByYW5nZXMsIHZlcnNpb24sIGNhbGxiYWNrLCBjdHgp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBkZWxldGVUb3BpY1BlcnNp\nc3RlbmNlSW5mbyhCeXRlU3RyaW5nIHRvcGljLCBWZXJzaW9uIHZlcnNpb24s\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGN0\neCkgewogICAgICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlRG93bkNvdW50\nID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAtLXNlcnZpY2VEb3du\nQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJh\ndGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURv\nd25FeGNlcHRpb24oIk1ldGFkYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5kZWxldGVUb3BpY1Bl\ncnNpc3RlbmNlSW5mbyh0b3BpYywgdmVyc2lvbiwgY2FsbGJhY2ssIGN0eCk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3Vic2NyaXB0aW9u\nRGF0YU1hbmFnZXIgbmV3U3Vic2NyaXB0aW9uRGF0YU1hbmFnZXIoKSB7CiAg\nICAgICAgICAgIGZpbmFsIFN1YnNjcmlwdGlvbkRhdGFNYW5hZ2VyIHNkbSA9\nIGZhY3RvcnkubmV3U3Vic2NyaXB0aW9uRGF0YU1hbmFnZXIoKTsKICAgICAg\nICAgICAgcmV0dXJuIG5ldyBTdWJzY3JpcHRpb25EYXRhTWFuYWdlcigpIHsK\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgICAgIHNkbS5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgY3JlYXRlU3Vic2NyaXB0aW9uRGF0YShCeXRlU3RyaW5nIHRv\ncGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwgU3Vic2NyaXB0aW9uRGF0\nYSBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjazxWZXJz\naW9uPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAg\nICAgIHNkbS5jcmVhdGVTdWJzY3JpcHRpb25EYXRhKHRvcGljLCBzdWJzY3Jp\nYmVySWQsIGRhdGEsIGNhbGxiYWNrLCBjdHgpOwogICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\ncHVibGljIGJvb2xlYW4gaXNQYXJ0aWFsVXBkYXRlU3VwcG9ydGVkKCkgewog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBzZG0uaXNQYXJ0aWFsVXBkYXRl\nU3VwcG9ydGVkKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCB1cGRh\ndGVTdWJzY3JpcHRpb25EYXRhKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVTdHJp\nbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgICBTdWJz\nY3JpcHRpb25EYXRhIGRhdGFUb1VwZGF0ZSwgVmVyc2lvbiB2ZXJzaW9uLCBD\nYWxsYmFjazxWZXJzaW9uPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAg\nICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlRG93bkNvdW50ID4gMCkgewog\nICAgICAgICAgICAgICAgICAgICAgICAtLXNlcnZpY2VEb3duQ291bnQ7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxl\nZChjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFB1\nYlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbigiTWV0YWRhdGEg\nU3RvcmUgaXMgZG93biIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICBzZG0udXBkYXRlU3Vic2NyaXB0aW9uRGF0YSh0b3BpYywgc3Vic2NyaWJl\ncklkLCBkYXRhVG9VcGRhdGUsIHZlcnNpb24sIGNhbGxiYWNrLCBjdHgpOwog\nICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcmVwbGFjZVN1YnNjcmlwdGlv\nbkRhdGEoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIFN1YnNjcmlwdGlvbkRhdGEg\nZGF0YVRvUmVwbGFjZSwgVmVyc2lvbiB2ZXJzaW9uLCBDYWxsYmFjazxWZXJz\naW9uPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAg\nICAgIGlmIChzZXJ2aWNlRG93bkNvdW50ID4gMCkgewogICAgICAgICAgICAg\nICAgICAgICAgICAtLXNlcnZpY2VEb3duQ291bnQ7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFB1YlN1YkV4Y2VwdGlv\nbi5TZXJ2aWNlRG93bkV4Y2VwdGlvbigiTWV0YWRhdGEgU3RvcmUgaXMgZG93\nbiIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzZG0ucmVwbGFj\nZVN1YnNjcmlwdGlvbkRhdGEodG9waWMsIHN1YnNjcmliZXJJZCwgZGF0YVRv\nUmVwbGFjZSwgdmVyc2lvbiwgY2FsbGJhY2ssIGN0eCk7CiAgICAgICAgICAg\nICAgICB9CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBkZWxldGVTdWJzY3JpcHRpb25EYXRhKEJ5dGVT\ndHJpbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBWZXJzaW9u\nIHZlcnNpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrPFZv\naWQ+IGNhbGxiYWNrLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgICAgICAg\nICAgc2RtLmRlbGV0ZVN1YnNjcmlwdGlvbkRhdGEodG9waWMsIHN1YnNjcmli\nZXJJZCwgdmVyc2lvbiwgY2FsbGJhY2ssIGN0eCk7CiAgICAgICAgICAgICAg\nICB9CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCByZWFkU3Vic2NyaXB0aW9uRGF0YShCeXRlU3RyaW5n\nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAg\nICAgICAgICAgICAgQ2FsbGJhY2s8VmVyc2lvbmVkPFN1YnNjcmlwdGlvbkRh\ndGE+PiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAg\nICAgIHNkbS5yZWFkU3Vic2NyaXB0aW9uRGF0YSh0b3BpYywgc3Vic2NyaWJl\ncklkLCBjYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHJlYWRTdWJzY3JpcHRpb25zKEJ5dGVTdHJpbmcgdG9waWMsCiAgICAg\nICAgICAgICAgICAgICAgICAgIENhbGxiYWNrPE1hcDxCeXRlU3RyaW5nLCBW\nZXJzaW9uZWQ8U3Vic2NyaXB0aW9uRGF0YT4+PiBjYiwgT2JqZWN0IGN0eCkg\newogICAgICAgICAgICAgICAgICAgIHNkbS5yZWFkU3Vic2NyaXB0aW9ucyh0\nb3BpYywgY2IsIGN0eCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH07CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgVG9waWNPd25lcnNoaXBNYW5hZ2VyIG5ld1RvcGljT3duZXJzaGlwTWFu\nYWdlcigpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkubmV3VG9waWNP\nd25lcnNoaXBNYW5hZ2VyKCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgdm9pZCBmb3JtYXQoU2VydmVyQ29uZmlndXJh\ndGlvbiBjZmcsIFpvb0tlZXBlciB6aykgdGhyb3dzIElPRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgZmFjdG9yeS5mb3JtYXQoY2ZnLCB6ayk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyBUZXN0Qm9va0tlZXBlclBlcnNpc3RlbmNl\nTWFuYWdlcihib29sZWFuIHJlbW92ZVN0YXJ0U2VxSWQpIHsKICAgICAgICB0\naGlzLnJlbW92ZVN0YXJ0U2VxSWQgPSByZW1vdmVTdGFydFNlcUlkOwogICAg\nfQoKICAgIEBQYXJhbWV0ZXJzCiAgICBwdWJsaWMgc3RhdGljIENvbGxlY3Rp\nb248T2JqZWN0W10+IGNvbmZpZ3MoKSB7CiAgICAgICAgcmV0dXJuIEFycmF5\ncy5hc0xpc3QobmV3IE9iamVjdFtdW10gewogICAgICAgICAgICB7IHRydWUg\nfSwgeyBmYWxzZSB9CiAgICAgICAgfSk7CiAgICB9CgogICAgQFN1cHByZXNz\nV2FybmluZ3MoImRlcHJlY2F0aW9uIikKICAgIHByaXZhdGUgdm9pZCBzdGFy\ndENsdXN0ZXIobG9uZyBkZWxheSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgYmt0YiA9IG5ldyBCb29rS2VlcGVyVGVzdEJhc2UobnVtQm9va2llcywg\nMEwpOwogICAgICAgIGJrdGIuc2V0VXAoKTsKCiAgICAgICAgY29uZiA9IG5l\ndyBTZXJ2ZXJDb25maWd1cmF0aW9uKCkgewogICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgcHVibGljIGludCBnZXRNZXNzYWdlc0NvbnN1bWVk\nVGhyZWFkUnVuSW50ZXJ2YWwoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nMjAwMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgcHVibGljIGludCBnZXRDb25zdW1lSW50ZXJ2YWwoKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIGxvbmcgZ2V0TWF4\nRW50cmllc1BlckxlZGdlcigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBt\nYXhFbnRyaWVzUGVyTGVkZ2VyOwogICAgICAgICAgICB9CiAgICAgICAgfTsK\nICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25m\naWd1cmF0aW9uIGJrQ2xpZW50Q29uZiA9CiAgICAgICAgICAgICAgICBuZXcg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlv\nbigpOwogICAgICAgIGJrQ2xpZW50Q29uZi5zZXROdW1Xb3JrZXJUaHJlYWRz\nKDEpLnNldFJlYWRUaW1lb3V0KDk5OTkpCiAgICAgICAgLnNldFRocm90dGxl\nVmFsdWUoMyk7CiAgICAgICAgY29uZi5hZGRDb25mKGJrQ2xpZW50Q29uZik7\nCgogICAgICAgIG1ldGFkYXRhTWFuYWdlckZhY3RvcnkgPSBuZXcgVGVzdE1l\ndGFkYXRhTWFuYWdlckZhY3RvcnkoY29uZiwgYmt0Yi5nZXRab29LZWVwZXJD\nbGllbnQoKSk7CiAgICAgICAgdHBNYW5hZ2VyID0gbWV0YWRhdGFNYW5hZ2Vy\nRmFjdG9yeS5uZXdUb3BpY1BlcnNpc3RlbmNlTWFuYWdlcigpOwoKICAgICAg\nICBzY2hlZHVsZXIgPSBFeGVjdXRvcnMubmV3U2NoZWR1bGVkVGhyZWFkUG9v\nbCgxKTsKICAgICAgICB0bSA9IG5ldyBUcml2aWFsT3duQWxsVG9waWNNYW5h\nZ2VyKGNvbmYsIHNjaGVkdWxlcik7CiAgICAgICAgbWFuYWdlciA9IG5ldyBC\nb29ra2VlcGVyUGVyc2lzdGVuY2VNYW5hZ2VyKGJrdGIuYmssIG1ldGFkYXRh\nTWFuYWdlckZhY3RvcnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHRtLCBjb25mLCBzY2hlZHVsZXIpOwog\nICAgICAgIHNtID0gbmV3IE1NU3Vic2NyaXB0aW9uTWFuYWdlcihjb25mLCBt\nZXRhZGF0YU1hbmFnZXJGYWN0b3J5LCB0bSwgbWFuYWdlciwgbnVsbCwgc2No\nZWR1bGVyKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgc3RvcENsdXN0ZXIo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0bS5zdG9wKCk7CiAgICAg\nICAgbWFuYWdlci5zdG9wKCk7CiAgICAgICAgc20uc3RvcCgpOwogICAgICAg\nIHRwTWFuYWdlci5jbG9zZSgpOwogICAgICAgIG1ldGFkYXRhTWFuYWdlckZh\nY3Rvcnkuc2h1dGRvd24oKTsKICAgICAgICBzY2hlZHVsZXIuc2h1dGRvd24o\nKTsKICAgICAgICBia3RiLnRlYXJEb3duKCk7CiAgICB9CgogICAgQEJlZm9y\nZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBzdGFydENsdXN0ZXIoMEwpOwogICAgfQoKICAgIEBBZnRlcgog\nICAgcHVibGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBzdG9wQ2x1c3RlcigpOwogICAgfQoKICAgIGNsYXNzIFJhbmdl\nU2NhblZlcmlmaWVyIGltcGxlbWVudHMgU2NhbkNhbGxiYWNrIHsKICAgICAg\nICBMaW5rZWRMaXN0PE1lc3NhZ2U+IHB1Yk1zZ3M7CiAgICAgICAgYm9vbGVh\nbiBydW5OZXh0U2NhbiA9IGZhbHNlOwogICAgICAgIFJhbmdlU2NhblJlcXVl\nc3QgbmV4dFNjYW4gPSBudWxsOwoKICAgICAgICBwdWJsaWMgUmFuZ2VTY2Fu\nVmVyaWZpZXIoTGlua2VkTGlzdDxNZXNzYWdlPiBwdWJNc2dzLCBSYW5nZVNj\nYW5SZXF1ZXN0IG5leHRTY2FuKSB7CiAgICAgICAgICAgIHRoaXMucHViTXNn\ncyA9IHB1Yk1zZ3M7CiAgICAgICAgICAgIHRoaXMubmV4dFNjYW4gPSBuZXh0\nU2NhbjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVjdCBjdHgsIE1lc3NhZ2Ug\ncmVjdk1lc3NhZ2UpIHsKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlNjYW5u\nZWQgbWVzc2FnZSA6IHt9IiwgcmVjdk1lc3NhZ2UuZ2V0TXNnSWQoKS5nZXRM\nb2NhbENvbXBvbmVudCgpKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0gbmV4\ndFNjYW4gJiYgIXJ1bk5leHRTY2FuKSB7CiAgICAgICAgICAgICAgICBydW5O\nZXh0U2NhbiA9IHRydWU7CiAgICAgICAgICAgICAgICBtYW5hZ2VyLnNjYW5N\nZXNzYWdlcyhuZXh0U2Nhbik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGlmIChwdWJNc2dzLnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1lc3NhZ2UgcHVi\nTXNnID0gcHViTXNncy5yZW1vdmVGaXJzdCgpOwogICAgICAgICAgICBpZiAo\nIUhlbHBlck1ldGhvZHMuYXJlRXF1YWwocmVjdk1lc3NhZ2UsIHB1Yk1zZykp\nIHsKICAgICAgICAgICAgICAgIGZhaWwoIlNjYW5uZWQgbWVzc2FnZSBub3Qg\nZXF1YWwgdG8gZXhwZWN0ZWQiKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgc2NhbkZh\naWxlZChPYmplY3QgY3R4LCBFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAg\nICAgICAgIGZhaWwoIkZhaWxlZCB0byBzY2FuIG1lc3NhZ2VzLiIpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgQFN1cHByZXNzV2Fy\nbmluZ3MoInVuY2hlY2tlZCIpCiAgICAgICAgcHVibGljIHZvaWQgc2NhbkZp\nbmlzaGVkKE9iamVjdCBjdHgsIFJlYXNvbkZvckZpbmlzaCByZWFzb24pIHsK\nICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPiBzdGF0\ndXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+KSBjdHg7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdGF0dXNRdWV1\nZS5wdXQocHViTXNncy5pc0VtcHR5KCkpOwogICAgICAgICAgICB9IGNhdGNo\nIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICB9CgogICAgcHJpdmF0ZSBMaW5rZWRMaXN0PE1lc3Nh\nZ2U+IHN1Yk1lc3NhZ2VzKExpc3Q8TWVzc2FnZT4gbXNncywgaW50IHN0YXJ0\nLCBpbnQgZW5kKSB7CiAgICAgICAgTGlua2VkTGlzdDxNZXNzYWdlPiByZXN1\nbHQgPSBuZXcgTGlua2VkTGlzdDxNZXNzYWdlPigpOwogICAgICAgIGZvciAo\naW50IGk9c3RhcnQ7IGk8PWVuZDsgaSsrKSB7CiAgICAgICAgICAgIHJlc3Vs\ndC5hZGQobXNncy5nZXQoaSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\ncmVzdWx0OwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0U2Nhbk1lc3NhZ2VzT25DbG9zZWRMZWRnZXJBZnRl\nckRlbGV0ZUxlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHNj\nYW5NZXNzYWdlc0FmdGVyRGVsZXRlTGVkZ2VyVGVzdCgyKTsKICAgIH0KCiAg\nICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFNj\nYW5NZXNzYWdlc09uVW5jbG9zZWRMZWRnZXJBZnRlckRlbGV0ZUxlZGdlcigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHNjYW5NZXNzYWdlc0FmdGVy\nRGVsZXRlTGVkZ2VyVGVzdCgxKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\nc2Nhbk1lc3NhZ2VzQWZ0ZXJEZWxldGVMZWRnZXJUZXN0KGludCBudW1MZWRn\nZXJzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5nIHRv\ncGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRlc3RTY2FuTWVzc2Fn\nZXNBZnRlckRlbGV0ZUxlZGdlciIpOwoKICAgICAgICBMaXN0PE1lc3NhZ2U+\nIG1zZ3MgPSBuZXcgQXJyYXlMaXN0PE1lc3NhZ2U+KCk7CgogICAgICAgIGFj\ncXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAgbXNncy5hZGRBbGwocHVibGlz\naE1lc3NhZ2VzKHRvcGljLCAyKSk7CgogICAgICAgIGZvciAoaW50IGk9MDsg\naTxudW1MZWRnZXJzOyBpKyspIHsKICAgICAgICAgICAgcmVsZWFzZVRvcGlj\nKHRvcGljKTsKICAgICAgICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbiB0\nbyBmb3JjZSBhIG5ldyBsZWRnZXIKICAgICAgICAgICAgYWNxdWlyZVRvcGlj\nKHRvcGljKTsKICAgICAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3Nh\nZ2VzKHRvcGljLCAyKSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdW1lZFVu\ndGlsKHRvcGljLCAyTCk7CiAgICAgICAgLy8gV2FpdCB1bnRpbCBsZWRnZXIg\ncmFuZ2VzIGlzIHVwZGF0ZWQuCiAgICAgICAgVGhyZWFkLnNsZWVwKDIwMDBM\nKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAgICAgICAvLyBh\nY3F1aXJlIHRvcGljIGFnYWluCiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGlj\nKTsKICAgICAgICAvLyBzY2FuIG1lc3NhZ2VzIHN0YXJ0aW5nIGZyb20gMwog\nICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4gc3RhdHVzUXVl\ndWUgPQogICAgICAgICAgICBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29s\nZWFuPigpOwogICAgICAgIG1hbmFnZXIuc2Nhbk1lc3NhZ2VzKG5ldyBSYW5n\nZVNjYW5SZXF1ZXN0KHRvcGljLCAzLCAyLCBMb25nLk1BWF9WQUxVRSwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUmFuZ2VTY2FuVmVyaWZp\nZXIoc3ViTWVzc2FnZXMobXNncywgMiwgMyksIG51bGwpLCBzdGF0dXNRdWV1\nZSkpOwogICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwoMTAg\nKiByZWFkRGVsYXksIFRpbWVVbml0Lk1JTExJU0VDT05EUyk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZSgiU2hvdWxkIHN1Y2NlZWQgdG8gc2NhbiBtZXNzYWdlcyBh\nZnRlciBkZWxldGVkIGNvbnN1bWVkIGxlZGdlci4iLCBiKTsKICAgIH0KCiAg\nICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFNj\nYW5NZXNzYWdlc09uRW1wdHlMZWRnZXJBZnRlckRlbGV0ZUxlZGdlcigpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVTdHJpbmcgdG9waWMgPSBC\neXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdFNjYW5NZXNzYWdlc09uRW1w\ndHlMZWRnZXJBZnRlckRlbGV0ZUxlZGdlciIpOwoKICAgICAgICBMaXN0PE1l\nc3NhZ2U+IG1zZ3MgPSBuZXcgQXJyYXlMaXN0PE1lc3NhZ2U+KCk7CgogICAg\nICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAgbXNncy5hZGRBbGwo\ncHVibGlzaE1lc3NhZ2VzKHRvcGljLCAyKSk7CiAgICAgICAgcmVsZWFzZVRv\ncGljKHRvcGljKTsKCiAgICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbiB0\nbyBmb3JjZSBhIG5ldyBsZWRnZXIKICAgICAgICBhY3F1aXJlVG9waWModG9w\naWMpOwogICAgICAgIGxvZ2dlci5pbmZvKCJDb25zdW1lZCBtZXNzYWdlcy4i\nKTsKICAgICAgICBjb25zdW1lZFVudGlsKHRvcGljLCAyTCk7CiAgICAgICAg\nLy8gV2FpdCB1bnRpbCBsZWRnZXIgcmFuZ2VzIGlzIHVwZGF0ZWQuCiAgICAg\nICAgVGhyZWFkLnNsZWVwKDIwMDBMKTsKICAgICAgICBsb2dnZXIuaW5mbygi\nUmVsZWFzZWQgdG9waWMgd2l0aCBhbiBlbXB0eSBsZWRnZXIuIik7CiAgICAg\nICAgLy8gcmVsZWFzZSB0b3BpYyB0byBmb3JjZSBhbiBlbXB0eSBsZWRnZXIK\nICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAgICAgICAvLyBwdWJs\naXNoIDIgbW9yZSBtZXNzYWdlcywgdGhlc2UgbWVzc2FnZSBleHBlY3RlZCB0\nbyBiZSBpZCAzIGFuZCA0CiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGljKTsK\nICAgICAgICBsb2dnZXIuaW5mbygiUHVibGlzaGVkIG1vcmUgbWVzc2FnZXMu\nIik7CiAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3NhZ2VzKHRvcGlj\nLCAyKSk7CiAgICAgICAgcmVsZWFzZVRvcGljKHRvcGljKTsKCiAgICAgICAg\nLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbgogICAgICAgIGFjcXVpcmVUb3BpYyh0\nb3BpYyk7CiAgICAgICAgLy8gc2NhbiBtZXNzYWdlcyBzdGFydGluZyBmcm9t\nIDMKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1\nc1F1ZXVlID0KICAgICAgICAgICAgbmV3IExpbmtlZEJsb2NraW5nUXVldWU8\nQm9vbGVhbj4oKTsKICAgICAgICBsb25nIHN0YXJ0U2VxSWQgPSByZW1vdmVT\ndGFydFNlcUlkID8gMSA6IDM7CiAgICAgICAgbWFuYWdlci5zY2FuTWVzc2Fn\nZXMobmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMsIHN0YXJ0U2VxSWQsIDIs\nIExvbmcuTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBSYW5nZVNjYW5WZXJpZmllcihzdWJNZXNzYWdlcyhtc2dzLCAyLCAz\nKSwgbnVsbCksIHN0YXR1c1F1ZXVlKSk7CiAgICAgICAgQm9vbGVhbiBiID0g\nc3RhdHVzUXVldWUucG9sbCgxMCAqIHJlYWREZWxheSwgVGltZVVuaXQuTUlM\nTElTRUNPTkRTKTsKICAgICAgICBhc3NlcnRUcnVlKCJTaG91bGQgc3VjY2Vl\nZCB0byBzY2FuIG1lc3NhZ2VzIGFmdGVyIGRlbGV0ZWQgY29uc3VtZWQgbGVk\nZ2VyLiIsIGIpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0RmFpbGVkVG9EZWxldGVMZWRnZXIxKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZmFpbGVkVG9EZWxldGVMZWRnZXJz\nVGVzdCgxKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAg\ncHVibGljIHZvaWQgdGVzdEZhaWxlZFRvRGVsZXRlTGVkZ2VyMigpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIC8vIHN1Y2NlZWQgdG8gZGVsZXRlIHNl\nY29uZCBsZWRnZXIKICAgICAgICBmYWlsZWRUb0RlbGV0ZUxlZGdlcnNUZXN0\nKDIpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBmYWlsZWRUb0RlbGV0ZUxl\nZGdlcnNUZXN0KGludCBudW1MZWRnZXJzKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBmaW5hbCBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5j\nb3B5RnJvbVV0ZjgoIlRlc3RGYWlsZWRUb0RlbGV0ZUxlZGdlciIpOwogICAg\nICAgIGZpbmFsIGludCBzZXJ2aWNlRG93bkNvdW50ID0gMTsKCiAgICAgICAg\nTGlzdDxNZXNzYWdlPiBtc2dzID0gbmV3IEFycmF5TGlzdDxNZXNzYWdlPigp\nOwoKICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtTGVkZ2VyczsgaSsrKSB7\nCiAgICAgICAgICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAgICAg\nIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdlcyh0b3BpYywgMikpOwogICAg\nICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwogICAgICAgIH0KCiAgICAg\nICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbiB0byBmb3JjZSBhIG5ldyBsZWRn\nZXIKICAgICAgICBhY3F1aXJlVG9waWModG9waWMpOwogICAgICAgIGxvZ2dl\nci5pbmZvKCJDb25zdW1lZCBtZXNzYWdlcy4iKTsKICAgICAgICBtZXRhZGF0\nYU1hbmFnZXJGYWN0b3J5LnNldFNlcnZpY2VEb3duQ291bnQoc2VydmljZURv\nd25Db3VudCk7CiAgICAgICAgLy8gZmFpbGVkIGNvbnN1bWVkCiAgICAgICAg\nY29uc3VtZWRVbnRpbCh0b3BpYywgMkwgKiBudW1MZWRnZXJzKTsKICAgICAg\nICAvLyBXYWl0IHVudGlsIGxlZGdlciByYW5nZXMgaXMgdXBkYXRlZC4KICAg\nICAgICBUaHJlYWQuc2xlZXAoMjAwMEwpOwogICAgICAgIGxvZ2dlci5pbmZv\nKCJSZWxlYXNlZCB0b3BpYyB3aXRoIGFuIGVtcHR5IGxlZGdlci4iKTsKICAg\nICAgICAvLyByZWxlYXNlIHRvcGljIHRvIGZvcmNlIGFuIGVtcHR5IGxlZGdl\ncgogICAgICAgIHJlbGVhc2VUb3BpYyh0b3BpYyk7CgogICAgICAgIC8vIHB1\nYmxpc2ggMiBtb3JlIG1lc3NhZ2VzLCB0aGVzZSBtZXNzYWdlIGV4cGVjdGVk\nIHRvIGJlIGlkIDMgYW5kIDQKICAgICAgICBhY3F1aXJlVG9waWModG9waWMp\nOwogICAgICAgIGxvZ2dlci5pbmZvKCJQdWJsaXNoZWQgbW9yZSBtZXNzYWdl\ncy4iKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXModG9w\naWMsIDIpKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAgICAg\nICAvLyBhY3F1aXJlIHRvcGljIGFnYWluCiAgICAgICAgYWNxdWlyZVRvcGlj\nKHRvcGljKTsKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+\nIHN0YXR1c1F1ZXVlID0KICAgICAgICAgICAgbmV3IExpbmtlZEJsb2NraW5n\nUXVldWU8Qm9vbGVhbj4oKTsKICAgICAgICBtYW5hZ2VyLnNjYW5NZXNzYWdl\ncyhuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgbnVtTGVkZ2VycyAqIDIg\nKyAxLCAyLCBMb25nLk1BWF9WQUxVRSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBuZXcgUmFuZ2VTY2FuVmVyaWZpZXIoc3ViTWVzc2FnZXMobXNn\ncywgbnVtTGVkZ2VycyAqIDIsIG51bUxlZGdlcnMgKiAyICsgMSksIG51bGwp\nLCBzdGF0dXNRdWV1ZSkpOwogICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1\nZXVlLnBvbGwoMTAgKiByZWFkRGVsYXksIFRpbWVVbml0Lk1JTExJU0VDT05E\nUyk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiU2hvdWxkIHN1Y2NlZWQgdG8gc2Nh\nbiBtZXNzYWdlcyBhZnRlciBkZWxldGVkIGNvbnN1bWVkIGxlZGdlci4iLCBi\nKTsKCiAgICAgICAgLy8gY29uc3VtZWQKICAgICAgICBjb25zdW1lZFVudGls\nKHRvcGljLCAobnVtTGVkZ2VycyArIDEpICogMkwpOwogICAgICAgIC8vIFdh\naXQgdW50aWwgbGVkZ2VyIHJhbmdlcyBpcyB1cGRhdGVkLgogICAgICAgIFRo\ncmVhZC5zbGVlcCgyMDAwTCk7CgogICAgICAgIFNlbWFwaG9yZSBsYXRjaCA9\nIG5ldyBTZW1hcGhvcmUoMSk7CiAgICAgICAgbGF0Y2guYWNxdWlyZSgpOwog\nICAgICAgIHRwTWFuYWdlci5yZWFkVG9waWNQZXJzaXN0ZW5jZUluZm8odG9w\naWMsIG5ldyBDYWxsYmFjazxWZXJzaW9uZWQ8TGVkZ2VyUmFuZ2VzPj4oKSB7\nCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBvcGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBWZXJzaW9uZWQ8TGVk\nZ2VyUmFuZ2VzPiByYW5nZXMpIHsKICAgICAgICAgICAgICAgIGlmIChudWxs\nID09IHJhbmdlcyB8fCByYW5nZXMuZ2V0VmFsdWUoKS5nZXRSYW5nZXNMaXN0\nKCkuc2l6ZSgpID4gMSkgewogICAgICAgICAgICAgICAgICAgIGZhaWx1cmVF\neGNlcHRpb24gPSBuZXcgUHViU3ViRXhjZXB0aW9uLk5vVG9waWNQZXJzaXN0\nZW5jZUluZm9FeGNlcHRpb24oIkludmFsaWQgcGVyc2lzdGVuY2UgaW5mbyBm\nb3VuZCBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpKTsKICAg\nICAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gbnVsbDsKICAg\nICAgICAgICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgUHViU3Vi\nRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgZmFpbHVy\nZUV4Y2VwdGlvbiA9IGV4Y2VwdGlvbjsKICAgICAgICAgICAgICAgICgoU2Vt\nYXBob3JlKWN0eCkucmVsZWFzZSgpOwogICAgICAgICAgICB9CiAgICAgICAg\nfSwgbGF0Y2gpOwogICAgICAgIGxhdGNoLmFjcXVpcmUoKTsKICAgICAgICBs\nYXRjaC5yZWxlYXNlKCk7CiAgICAgICAgYXNzZXJ0TnVsbCgiU2hvdWxkIG5v\ndCBmYWlsIHdpdGggZXhjZXB0aW9uLiIsIGZhaWx1cmVFeGNlcHRpb24pOwog\nICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0U2Nhbk1lc3NhZ2VzT25Ud29MZWRnZXJzKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgc3RvcENsdXN0ZXIoKTsKICAgICAgICBzdGFydENs\ndXN0ZXIocmVhZERlbGF5KTsKCiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9\nIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJUZXN0U2Nhbk1lc3NhZ2VzT25U\nd29MZWRnZXJzIik7CgogICAgICAgIExpc3Q8TWVzc2FnZT4gbXNncyA9IG5l\ndyBBcnJheUxpc3Q8TWVzc2FnZT4oKTsKCiAgICAgICAgYWNxdWlyZVRvcGlj\nKHRvcGljKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXMo\ndG9waWMsIDEpKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAg\nICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluIHRvIGZvcmNlIGEgbmV3IGxl\nZGdlcgogICAgICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAgbXNn\ncy5hZGRBbGwocHVibGlzaE1lc3NhZ2VzKHRvcGljLCAzKSk7CgogICAgICAg\nIC8vIHNjYW4gbWVzc2FnZXMKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVl\nPEJvb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtlZEJsb2NraW5nUXVl\ndWU8Qm9vbGVhbj4oKTsKICAgICAgICBSYW5nZVNjYW5SZXF1ZXN0IG5leHRT\nY2FuID0gbmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMsIDMsIDIsIExvbmcu\nTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgbmV3IFJhbmdlU2NhblZlcmlm\naWVyKHN1Yk1lc3NhZ2VzKG1zZ3MsIDIsIDMpLCBudWxsKSwgc3RhdHVzUXVl\ndWUpOwogICAgICAgIG1hbmFnZXIuc2Nhbk1lc3NhZ2VzKG5ldyBSYW5nZVNj\nYW5SZXF1ZXN0KHRvcGljLCAxLCAyLCBMb25nLk1BWF9WQUxVRSwKICAgICAg\nICAgICAgICAgIG5ldyBSYW5nZVNjYW5WZXJpZmllcihzdWJNZXNzYWdlcyht\nc2dzLCAwLCAxKSwgbmV4dFNjYW4pLCBzdGF0dXNRdWV1ZSkpOwogICAgICAg\nIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwoMTAgKiByZWFkRGVsYXks\nIFRpbWVVbml0Lk1JTExJU0VDT05EUyk7CiAgICAgICAgaWYgKGIgPT0gbnVs\nbCkgewogICAgICAgICAgICBmYWlsKCJPbmUgc2NhbiByZXF1ZXN0IGRvZXNu\nJ3QgZmluaXNoIik7CiAgICAgICAgfQogICAgICAgIGIgPSBzdGF0dXNRdWV1\nZS5wb2xsKDEwICogcmVhZERlbGF5LCBUaW1lVW5pdC5NSUxMSVNFQ09ORFMp\nOwogICAgICAgIGlmIChiID09IG51bGwpIHsKICAgICAgICAgICAgZmFpbCgi\nT25lIHNjYW4gcmVxdWVzdCBkb2Vzbid0IGZpbmlzaCIpOwogICAgICAgIH0K\nICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZv\naWQgdGVzdEluY29uc2lzdGVudFN1YnNjcmlwdGlvblN0YXRlQW5kTGVkZ2Vy\nUmFuZ2VzMSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIFNlZSB0\naGUgY29tbWVudCBvZiBpbmNvbnNpc3RlbnRTdWJzY3JpcHRpb25TdGF0ZUFu\nZExlZGdlclJhbmdlcy4KICAgICAgICAvLyBGb3IgdGhpcyBjYXNlLCBTdGVw\nICgyKSBmYWlsZWQgdG8gdXBkYXRlIHN1YnNjcmlwdGlvbiBzdGF0ZSBtZXRh\nZGF0YSwKICAgICAgICAvLyBidXQgTGVkZ2VyUmFuZ2VzIGlzIHVwZGF0ZWQg\nc3VjY2Vzcy4KICAgICAgICAvLyBSZXN1bHQ6IHNjYW4gbWVzc2FnZXMgZnJv\nbSAxIHRvIDQgdGFrZSBwbGFjZSBvbiBsZWRnZXIgTDIuCiAgICAgICAgaW5j\nb25zaXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVBbmRMZWRnZXJSYW5nZXMoMSk7\nCiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2\nb2lkIHRlc3RJbmNvbnNpc3RlbnRTdWJzY3JpcHRpb25TdGF0ZUFuZExlZGdl\nclJhbmdlczIoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBTZWUg\ndGhlIGNvbW1lbnQgb2YgaW5jb25zaXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVB\nbmRMZWRnZXJSYW5nZXMuCiAgICAgICAgLy8gRm9yIHRoaXMgY2FzZSwgc3Rl\ncCAoMikgZmFpbGVkIHRvIHVwZGF0ZSBzdWJzY3JpcHRpb24gc3RhdGUgbWV0\nYWRhdGEsCiAgICAgICAgLy8gc3RlcCAoMykgc3VjY2Vzc2Z1bGx5IGRlbGV0\nZSBMMSBidXQgZmFpbGVkIHRvIHVwZGF0ZSBMZWRnZXJSYW5nZXMuCiAgICAg\nICAgLy8gUmVzdWx0OiBzY2FuIG1lc3NhZ2VzIGZyb20gMSB0byA0IGZhbGxz\nIGluIEwxIGFuZCBMMiwKICAgICAgICAvLyAgICAgICAgIGJ1dCBCb29rS2Vl\ncGVyIG1heSBjb21wbGFpbiBMMSBub3QgZm91bmQuCiAgICAgICAgaW5jb25z\naXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVBbmRMZWRnZXJSYW5nZXMoMik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTaW5jZSBJbk1lbW9yeVN1YnNjcmlwdGlv\nblN0YXRlIGFuZCBMZWRnZXJSYW5nZXMgaXMgbWFpbnRhaW5lZAogICAgICog\nc2VwYXJhdGVseSwgdGhlcmUgbWF5IGV4aXN0IHN1Y2ggaW5jb25zaXN0ZW50\nIHN0YXRlOgogICAgICogKDEpLiBUb3BpYyBsZWRnZXJzOiBMMSBbMSB+IDJd\nLCBMMiBbMyB+IF0KICAgICAqICgyKS4gU3Vic2NyaWJlciBjb25zdW1lcyB0\nbyAyIGFuZCBJbk1lbW9yeVN1YnNjcmlwdGlvblN0YXRlIGlzIHVwZGF0ZWQK\nICAgICAqICAgICAgc3VjY2Vzc2Z1bGx5IGJ1dCBmYWlsZWQgd2hlbiB1cGRh\ndGluZyBzdWJzY3JpcHRpb24gc3RhdGUgbWV0YWRhdGEKICAgICAqICgzKS4g\nQWJzdHJhY3RTdWJzY3JpcHRpb25NYW5hZ2VyI01lc3NhZ2VzQ29uc3VtZWRU\nYXNrIHVzZQogICAgICogICAgICBJbk1lbW9yeVN1YnNjcmlwdGlvblN0YXRl\nIHRvIGRvIGdhcmJhZ2UgY29sbGVjdGlvbgogICAgICogICAgICBhbmQgTDEg\naXMgZGVsZXRlCiAgICAgKiAoNCkuIElmIEh1YiByZXN0YXJ0cyBhdCB0aGlz\nIHRpbWUsIG9sZCBzdWJzY3JpcHRpb24gc3RhdGUgaXMgcmVhZCBhbmQKICAg\nICAqICAgICAgSHViIHdpbGwgdHJ5IHRvIGRlbGl2ZXIgbWVzc2FnZSBmcm9t\nIDEKICAgICAqLwogICAgcHVibGljIHZvaWQgaW5jb25zaXN0ZW50U3Vic2Ny\naXB0aW9uU3RhdGVBbmRMZWRnZXJSYW5nZXMoaW50IGZhaWxlZENvdW50KSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBCeXRlU3RyaW5nIHRv\ncGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoImluY29uc2lzdGVudFN1\nYnNjcmlwdGlvblN0YXRlQW5kTGVkZ2VyUmFuZ2VzIik7CiAgICAgICAgZmlu\nYWwgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQgPSBCeXRlU3RyaW5nLmNvcHlG\ncm9tVXRmOCgic3ViSWQiKTsKICAgICAgICBMaW5rZWRMaXN0PE1lc3NhZ2U+\nIG1zZ3MgPSBuZXcgTGlua2VkTGlzdDxNZXNzYWdlPigpOwoKICAgICAgICAv\nLyBtYWtlIGxlZGdlciBMMSBbMSB+IDJdCiAgICAgICAgYWNxdWlyZVRvcGlj\nKHRvcGljKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXMo\ndG9waWMsIDIpKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAg\nICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluIHRvIGZvcmNlIGEgbmV3IGxl\nZGdlciBMMiBbMyB+IF0KICAgICAgICBhY3F1aXJlVG9waWModG9waWMpOwog\nICAgICAgIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdlcyh0b3BpYywgMikp\nOwoKICAgICAgICBTdHViQ2FsbGJhY2s8Vm9pZD4gdm9pZENiID0gbmV3IFN0\ndWJDYWxsYmFjazxWb2lkPigpOwogICAgICAgIFN0dWJDYWxsYmFjazxTdWJz\nY3JpcHRpb25EYXRhPiBzdWJEYXRhQ2IgPSBuZXcgU3R1YkNhbGxiYWNrPFN1\nYnNjcmlwdGlvbkRhdGE+KCk7CiAgICAgICAgRWl0aGVyPFZvaWQsIFB1YlN1\nYkV4Y2VwdGlvbj4gdm9pZFJlc3VsdDsKICAgICAgICBFaXRoZXI8U3Vic2Ny\naXB0aW9uRGF0YSwgUHViU3ViRXhjZXB0aW9uPiBzdWJEYXRhUmVzdWx0OwoK\nICAgICAgICAvLyBwcmVwYXJlIGZvciBzdWJzY3JpcHRpb24KICAgICAgICBz\nbS5hY3F1aXJlZFRvcGljKHRvcGljLCB2b2lkQ2IsIG51bGwpOwogICAgICAg\nIHZvaWRSZXN1bHQgPSBDb25jdXJyZW5jeVV0aWxzLnRha2Uodm9pZENiLnF1\nZXVlKTsKICAgICAgICBhc3NlcnROdWxsKHZvaWRSZXN1bHQucmlnaHQoKSk7\nIC8vIG5vIGV4Y2VwdGlvbgoKICAgICAgICAvLyBEbyBzdWJzY3JpcHRpb24K\nICAgICAgICBTdWJzY3JpYmVSZXF1ZXN0IHN1YlJlcXVlc3QgPSBTdWJzY3Jp\nYmVSZXF1ZXN0Lm5ld0J1aWxkZXIoKS5zZXRTdWJzY3JpYmVySWQoc3Vic2Ny\naWJlcklkKQogICAgICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENy\nZWF0ZU9yQXR0YWNoLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxkKCk7CiAgICAg\nICAgc20uc2VydmVTdWJzY3JpYmVSZXF1ZXN0KHRvcGljLCBzdWJSZXF1ZXN0\nLCBNZXNzYWdlU2VxSWQubmV3QnVpbGRlcigpLnNldExvY2FsQ29tcG9uZW50\nKDApLmJ1aWxkKCksIHN1YkRhdGFDYiwKICAgICAgICAgICAgICAgIG51bGwp\nOwogICAgICAgIHN1YkRhdGFSZXN1bHQgPSBDb25jdXJyZW5jeVV0aWxzLnRh\na2Uoc3ViRGF0YUNiLnF1ZXVlKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHN1\nYkRhdGFSZXN1bHQubGVmdCgpKTsgLy8gc2VydmVTdWJzY3JpYmVSZXF1ZXN0\nIHN1Y2Nlc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gYW5kIHJldHVybiBhIFN1YnNjcmlwdGlvbkRhdGEKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nb2JqZWN0CiAgICAgICAgYXNzZXJ0TnVsbChzdWJEYXRhUmVzdWx0LnJpZ2h0\nKCkpOyAvLyBubyBleGNlcHRpb24KCiAgICAgICAgLy8gc2ltdWxhdGUgaW5j\nb25zaXN0ZW50IHNpdHVhdGlvbiBiZXR3ZWVuIEluTWVtb3J5U3Vic2NyaXB0\naW9uU3RhdGUgYW5kCiAgICAgICAgLy8gTGVkZ2VyUmFuZ2VzCiAgICAgICAg\nbWV0YWRhdGFNYW5hZ2VyRmFjdG9yeS5zZXRTZXJ2aWNlRG93bkNvdW50KGZh\naWxlZENvdW50KTsKICAgICAgICBzbS5zZXRDb25zdW1lU2VxSWRGb3JTdWJz\nY3JpYmVyKHRvcGljLCBzdWJzY3JpYmVySWQsIE1lc3NhZ2VTZXFJZC5uZXdC\ndWlsZGVyKCkuc2V0TG9jYWxDb21wb25lbnQoMikuYnVpbGQoKSwKICAgICAg\nICAgICAgICAgIHZvaWRDYiwgbnVsbCk7CiAgICAgICAgdm9pZFJlc3VsdCA9\nIENvbmN1cnJlbmN5VXRpbHMudGFrZSh2b2lkQ2IucXVldWUpOwogICAgICAg\nIGFzc2VydE5vdE51bGwodm9pZFJlc3VsdC5yaWdodCgpKTsgLy8gdXBkYXRl\nIHN1YnNjcmlwdGlvbiBzdGF0ZSBmYWlsZWQKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBleHBlY3QgYSBleGNl\ncHRpb24KCiAgICAgICAgLy8gd2FpdCBBYnN0cmFjdFN1YnNjcmlwdGlvbk1h\nbmFnZXIjTWVzc2FnZXNDb25zdW1lZFRhc2sgdG8gZ2FyYmFnZQogICAgICAg\nIC8vIGNvbGxlY3QgbGVkZ2VyIEwxCiAgICAgICAgVGhyZWFkLnNsZWVwKGNv\nbmYuZ2V0TWVzc2FnZXNDb25zdW1lZFRocmVhZFJ1bkludGVydmFsKCkgKiAy\nKTsKCiAgICAgICAgLy8gc2ltdWxhdGUgaHViIHJlc3RhcnQ6IHJlYWQgb2xk\nIHN1YnNjcmlwdGlvbiBzdGF0ZSBtZXRhZGF0YSBhbmQgZGVsaXZlcgogICAg\nICAgIC8vIG1lc3NhZ2VzIGZyb20gMQogICAgICAgIExpbmtlZEJsb2NraW5n\nUXVldWU8Qm9vbGVhbj4gc3RhdHVzUXVldWUgPSBuZXcgTGlua2VkQmxvY2tp\nbmdRdWV1ZTxCb29sZWFuPigpOwogICAgICAgIFJhbmdlU2NhblJlcXVlc3Qg\nc2NhbiA9IG5ldyBSYW5nZVNjYW5SZXF1ZXN0KHRvcGljLCAxLCA0LCBMb25n\nLk1BWF9WQUxVRSwgbmV3IFJhbmdlU2NhblZlcmlmaWVyKG1zZ3MsIG51bGwp\nLAogICAgICAgICAgICAgICAgc3RhdHVzUXVldWUpOwogICAgICAgIG1hbmFn\nZXIuc2Nhbk1lc3NhZ2VzKHNjYW4pOwogICAgICAgIEJvb2xlYW4gYiA9IHN0\nYXR1c1F1ZXVlLnBvbGwoMTAgKiByZWFkRGVsYXksIFRpbWVVbml0Lk1JTExJ\nU0VDT05EUyk7CiAgICAgICAgaWYgKGIgPT0gbnVsbCkgewogICAgICAgICAg\nICBmYWlsKCJTY2FuIHJlcXVlc3QgZG9lc24ndCBmaW5pc2giKTsKICAgICAg\nICB9CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIC8vIEFk\nZCB0aGlzIHRlc3QgY2FzZSBmb3IgQk9PS0tFRVBFUi00NTgKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RSZWFkV2hlblRvcGljQ2hhbmdlTGVkZ2VyKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgZmluYWwgQnl0ZVN0cmluZyB0b3BpYyA9\nIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJ0ZXN0UmVhZFdoZW5Ub3BpY0No\nYW5nZUxlZGdlciIpOwogICAgICAgIExpbmtlZExpc3Q8TWVzc2FnZT4gbXNn\ncyA9IG5ldyBMaW5rZWRMaXN0PE1lc3NhZ2U+KCk7CgogICAgICAgIC8vIFdy\naXRlIG1heEVudHJpZXNQZXJMZWRnZXIgZW50cmllcyB0byBtYWtlIHRvcGlj\nIGNoYW5nZSBsZWRnZXIKICAgICAgICBhY3F1aXJlVG9waWModG9waWMpOwog\nICAgICAgIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdlcyh0b3BpYywgbWF4\nRW50cmllc1BlckxlZGdlcikpOwoKICAgICAgICAvLyBOb3RpY2UsIGNoYW5n\nZSBsZWRnZXIgb3BlcmF0aW9uIGlzIGFzeW5jaHJvbm91cywgc28gd2Ugc2hv\ndWxkIHdhaXQhISEKICAgICAgICBUaHJlYWQuc2xlZXAoMjAwMCk7CgogICAg\nICAgIC8vIElzc3VlIGEgc2NhbiByZXF1ZXN0IHJpZ2h0IHN0YXJ0IGZyb20g\ndGhlIG5ldyBsZWRnZXIKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJv\nb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtlZEJsb2NraW5nUXVldWU8\nQm9vbGVhbj4oKTsKICAgICAgICBSYW5nZVNjYW5SZXF1ZXN0IHNjYW4gPSBu\nZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgbWF4RW50cmllc1BlckxlZGdl\nciArIDEsIDEsIExvbmcuTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgbmV3\nIFJhbmdlU2NhblZlcmlmaWVyKG1zZ3MsIG51bGwpLCBzdGF0dXNRdWV1ZSk7\nCiAgICAgICAgbWFuYWdlci5zY2FuTWVzc2FnZXMoc2Nhbik7CiAgICAgICAg\nQm9vbGVhbiBiID0gc3RhdHVzUXVldWUucG9sbCgxMCAqIHJlYWREZWxheSwg\nVGltZVVuaXQuTUlMTElTRUNPTkRTKTsKICAgICAgICBpZiAoYiA9PSBudWxs\nKSB7CiAgICAgICAgICAgIGZhaWwoIlNjYW4gcmVxdWVzdCB0aW1lb3V0Iik7\nCiAgICAgICAgfQogICAgICAgIGFzc2VydEZhbHNlKCJFeHBlY3Qgbm9uZSBt\nZXNzYWdlIGlzIHNjYW5uZWQgb24gdGhlIG5ldyBjcmVhdGVkIGxlZGdlciIs\nIGIpOwogICAgfQoKICAgIGNsYXNzIFRlc3RDYWxsYmFjayBpbXBsZW1lbnRz\nIENhbGxiYWNrPFB1YlN1YlByb3RvY29sLk1lc3NhZ2VTZXFJZD4gewoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5j\naGVja2VkIikKICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GYWlsZWQo\nT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAg\nICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1\nZXVlID0gKExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4pIGN0eDsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0YXR1c1F1ZXVlLnB1\ndChmYWxzZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1l\nRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVj\na2VkIikKICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5pc2hlZChP\nYmplY3QgY3R4LCBQdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQgcmVzdWx0\nT2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1\nZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVl\nPEJvb2xlYW4+KSBjdHg7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBzdGF0dXNRdWV1ZS5wdXQodHJ1ZSk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBMaXN0PE1lc3NhZ2U+\nIHB1Ymxpc2hNZXNzYWdlcyhCeXRlU3RyaW5nIHRvcGljLCBpbnQgbnVtTXNn\ncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTGlzdDxNZXNzYWdlPiBt\nc2dzID0gSGVscGVyTWV0aG9kcy5nZXRSYW5kb21QdWJsaXNoZWRNZXNzYWdl\ncyhudW1Nc2dzLCAxMDI0KTsKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVl\nPEJvb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtlZEJsb2NraW5nUXVl\ndWU8Qm9vbGVhbj4oKTsKICAgICAgICBmb3IgKE1lc3NhZ2UgbXNnIDogbXNn\ncykgewoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIG1hbmFn\nZXIucGVyc2lzdE1lc3NhZ2UobmV3IFBlcnNpc3RSZXF1ZXN0KHRvcGljLCBt\nc2csIG5ldyBUZXN0Q2FsbGJhY2soKSwgc3RhdHVzUXVldWUpKTsKICAgICAg\nICAgICAgICAgIC8vIHdhaXQgYSBtYXhpbXVtIG9mIGEgbWludXRlCiAgICAg\nICAgICAgICAgICBCb29sZWFuIGIgPSBzdGF0dXNRdWV1ZS5wb2xsKDYwLCBU\naW1lVW5pdC5TRUNPTkRTKTsKICAgICAgICAgICAgICAgIGlmIChiID09IG51\nbGwpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4\nY2VwdGlvbigiUHVibGlzaCB0aW1lZCBvdXQiKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRp\nb24oZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIG1zZ3M7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYWNxdWlyZVRvcGlj\nKEJ5dGVTdHJpbmcgdG9waWMpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIFNlbWFwaG9yZSBsYXRjaCA9IG5ldyBTZW1hcGhvcmUoMSk7CiAgICAgICAg\nbGF0Y2guYWNxdWlyZSgpOwogICAgICAgIG1hbmFnZXIuYWNxdWlyZWRUb3Bp\nYyh0b3BpYywgbmV3IENhbGxiYWNrPFZvaWQ+KCkgewogICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmlu\naXNoZWQoT2JqZWN0IGN0eCwgVm9pZCByZXN1bHRPZk9wZXJhdGlvbikgewog\nICAgICAgICAgICAgICAgZmFpbHVyZUV4Y2VwdGlvbiA9IG51bGw7CiAgICAg\nICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4\nY2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIGZhaWx1cmVF\neGNlcHRpb24gPSBleGNlcHRpb247CiAgICAgICAgICAgICAgICAoKFNlbWFw\naG9yZSljdHgpLnJlbGVhc2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0s\nIGxhdGNoKTsKICAgICAgICBsYXRjaC5hY3F1aXJlKCk7CiAgICAgICAgbGF0\nY2gucmVsZWFzZSgpOwogICAgICAgIGlmIChudWxsICE9IGZhaWx1cmVFeGNl\ncHRpb24pIHsKICAgICAgICAgICAgdGhyb3cgZmFpbHVyZUV4Y2VwdGlvbjsK\nICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgcmVsZWFzZVRv\ncGljKGZpbmFsIEJ5dGVTdHJpbmcgdG9waWMpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIG1hbmFnZXIubG9zdFRvcGljKHRvcGljKTsKICAgICAgICAv\nLyBiYWNrd2FyZCB0ZXN0aW5nIGxlZGdlciByYW5nZXMgd2l0aG91dCBzdGFy\ndCBzZXEgaWQKICAgICAgICBpZiAocmVtb3ZlU3RhcnRTZXFJZCkgewogICAg\nICAgICAgICBTZW1hcGhvcmUgbGF0Y2ggPSBuZXcgU2VtYXBob3JlKDEpOwog\nICAgICAgICAgICBsYXRjaC5hY3F1aXJlKCk7CiAgICAgICAgICAgIHRwTWFu\nYWdlci5yZWFkVG9waWNQZXJzaXN0ZW5jZUluZm8odG9waWMsIG5ldyBDYWxs\nYmFjazxWZXJzaW9uZWQ8TGVkZ2VyUmFuZ2VzPj4oKSB7CiAgICAgICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZlcnNpb25lZDxMZWRnZXJS\nYW5nZXM+IHJhbmdlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChudWxs\nID09IHJhbmdlcykgewogICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJl\nRXhjZXB0aW9uID0gbmV3IFB1YlN1YkV4Y2VwdGlvbi5Ob1RvcGljUGVyc2lz\ndGVuY2VJbmZvRXhjZXB0aW9uKCJObyBwZXJzaXN0ZW5jZSBpbmZvIGZvdW5k\nIGZvciB0b3BpYyAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkpOwogICAgICAg\nICAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gYnVpbGQgYSBuZXcg\nbGVkZ2VyIHJhbmdlcyB3L28gc3RhcnQgc2VxIGlkLgogICAgICAgICAgICAg\nICAgICAgIExlZGdlclJhbmdlcy5CdWlsZGVyIGJ1aWxkZXIgPSBMZWRnZXJS\nYW5nZXMubmV3QnVpbGRlcigpOwogICAgICAgICAgICAgICAgICAgIGZpbmFs\nIExpc3Q8TGVkZ2VyUmFuZ2U+IHJhbmdlc0xpc3QgPSByYW5nZXMuZ2V0VmFs\ndWUoKS5nZXRSYW5nZXNMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgZm9y\nIChMZWRnZXJSYW5nZSByYW5nZSA6IHJhbmdlc0xpc3QpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgTGVkZ2VyUmFuZ2UuQnVpbGRlciBuZXdSYW5nZUJ1\naWxkZXIgPSBMZWRnZXJSYW5nZS5uZXdCdWlsZGVyKCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIG5ld1JhbmdlQnVpbGRlci5zZXRMZWRnZXJJZChyYW5n\nZS5nZXRMZWRnZXJJZCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKHJhbmdlLmhhc0VuZFNlcUlkSW5jbHVkZWQoKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbmV3UmFuZ2VCdWlsZGVyLnNldEVuZFNlcUlkSW5j\nbHVkZWQocmFuZ2UuZ2V0RW5kU2VxSWRJbmNsdWRlZCgpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBidWls\nZGVyLmFkZFJhbmdlcyhuZXdSYW5nZUJ1aWxkZXIuYnVpbGQoKSk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRwTWFuYWdl\nci53cml0ZVRvcGljUGVyc2lzdGVuY2VJbmZvKHRvcGljLCBidWlsZGVyLmJ1\naWxkKCksIHJhbmdlcy5nZXRWZXJzaW9uKCksCiAgICAgICAgICAgICAgICAg\nICAgbmV3IENhbGxiYWNrPFZlcnNpb24+KCkgewogICAgICAgICAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVmVyc2lv\nbiBuZXdWZXJzaW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBm\nYWlsdXJlRXhjZXB0aW9uID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgUHViU3ViRXhjZXB0aW9uIGV4Y2Vw\ndGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbHVyZUV4\nY2VwdGlvbiA9IGV4Y2VwdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgpOwogICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwgY3R4KTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVj\ndCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAg\nICAgICAgICAgICBmYWlsdXJlRXhjZXB0aW9uID0gZXhjZXB0aW9uOwogICAg\nICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKWN0eCkucmVsZWFzZSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBsYXRjaCk7CiAgICAg\nICAgICAgIGxhdGNoLmFjcXVpcmUoKTsKICAgICAgICAgICAgbGF0Y2gucmVs\nZWFzZSgpOwogICAgICAgICAgICBpZiAobnVsbCAhPSBmYWlsdXJlRXhjZXB0\naW9uKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBmYWlsdXJlRXhjZXB0aW9u\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3Rl\nZCB2b2lkIGNvbnN1bWVkVW50aWwoQnl0ZVN0cmluZyB0b3BpYywgbG9uZyBz\nZXFJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbWFuYWdlci5jb25z\ndW1lZFVudGlsKHRvcGljLCBzZXFJZCk7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

