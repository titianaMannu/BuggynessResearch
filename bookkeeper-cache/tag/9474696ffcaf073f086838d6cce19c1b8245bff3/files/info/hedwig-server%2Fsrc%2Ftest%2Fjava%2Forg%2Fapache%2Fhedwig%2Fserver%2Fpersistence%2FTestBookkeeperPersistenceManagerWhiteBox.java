{"sha":"f9dde4fb86f2d8f613542bfb85a254820c8ec5aa","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjlkZGU0ZmI4NmYyZDhmNjEzNTQyYmZiODVhMjU0ODIwYzhlYzVhYQ==","size":15279,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f9dde4fb86f2d8f613542bfb85a254820c8ec5aa","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuUmFuZG9t\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2\naWNlOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9v\na0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1\nYlN1YlByb3RvY29sOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9j\nb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwppbXBvcnQgb3JnLmp1\nbml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9y\nZy5qdW5pdC5UZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5F\naXRoZXI7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5n\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuSGVscGVyTWV0aG9kczsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLlN0dWJDYWxsYmFjazsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5j\nb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnNlcnZlci5tZXRhLk1ldGFkYXRhTWFuYWdlckZhY3Rvcnk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzLlRvcGljTWFu\nYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci50b3BpY3Mu\nVHJpdmlhbE93bkFsbFRvcGljTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnV0aWwuQ29uY3VycmVuY3lVdGlsczsKCmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7Cgpp\nbXBvcnQgc3RhdGljIG9yZy5qdW5pdC5Bc3NlcnQuKjsKCnB1YmxpYyBjbGFz\ncyBUZXN0Qm9va2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcldoaXRlQm94IHsK\nCiAgICBwcm90ZWN0ZWQgc3RhdGljIExvZ2dlciBsb2dnZXIgPQogICAgICAg\nIExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFRlc3RCb29ra2VlcGVyUGVyc2lz\ndGVuY2VNYW5hZ2VyV2hpdGVCb3guY2xhc3MpOwoKICAgIEJvb2tLZWVwZXJU\nZXN0QmFzZSBia3RiOwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgbnVtQm9va2ll\ncyA9IDM7CiAgICBCb29ra2VlcGVyUGVyc2lzdGVuY2VNYW5hZ2VyIGJrcG07\nCiAgICBNZXRhZGF0YU1hbmFnZXJGYWN0b3J5IG1tOwogICAgU2VydmVyQ29u\nZmlndXJhdGlvbiBjb25mOwogICAgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNl\nIHNjaGVkdWxlcjsKICAgIFRvcGljTWFuYWdlciB0bTsKICAgIEJ5dGVTdHJp\nbmcgdG9waWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgidG9waWMwIik7\nCgogICAgQEJlZm9yZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBia3RiID0gbmV3IEJvb2tLZWVwZXJUZXN0\nQmFzZShudW1Cb29raWVzKTsKICAgICAgICBia3RiLnNldFVwKCk7CgogICAg\nICAgIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAg\nIHNjaGVkdWxlciA9IEV4ZWN1dG9ycy5uZXdTY2hlZHVsZWRUaHJlYWRQb29s\nKDEpOwogICAgICAgIHRtID0gbmV3IFRyaXZpYWxPd25BbGxUb3BpY01hbmFn\nZXIoY29uZiwgc2NoZWR1bGVyKTsKCiAgICAgICAgbW0gPSBNZXRhZGF0YU1h\nbmFnZXJGYWN0b3J5Lm5ld01ldGFkYXRhTWFuYWdlckZhY3RvcnkoY29uZiwg\nYmt0Yi5nZXRab29LZWVwZXJDbGllbnQoKSk7CgogICAgICAgIGJrcG0gPSBu\nZXcgQm9va2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcihia3RiLmJrLCBtbSwg\ndG0sIGNvbmYsIHNjaGVkdWxlcik7CiAgICB9CgogICAgQEFmdGVyCiAgICBw\ndWJsaWMgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIG1tLnNodXRkb3duKCk7CiAgICAgICAgYmt0Yi50ZWFyRG93bigpOwog\nICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0RW1wdHlEaXJ0eUxlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewoK\nICAgICAgICBTdHViQ2FsbGJhY2s8Vm9pZD4gc3R1YkNhbGxiYWNrID0gbmV3\nIFN0dWJDYWxsYmFjazxWb2lkPigpOwogICAgICAgIGJrcG0uYWNxdWlyZWRU\nb3BpYyh0b3BpYywgc3R1YkNhbGxiYWNrLCBudWxsKTsKICAgICAgICBhc3Nl\ncnROdWxsKENvbmN1cnJlbmN5VXRpbHMudGFrZShzdHViQ2FsbGJhY2sucXVl\ndWUpLnJpZ2h0KCkpOwogICAgICAgIC8vIG5vdyBhYmFuZG9uLCBhbmQgdHJ5\nIGFub3RoZXIgdGltZSwgdGhlIHByZXYgbGVkZ2VyIHNob3VsZCBiZSBkaXJ0\neQoKICAgICAgICBia3BtID0gbmV3IEJvb2trZWVwZXJQZXJzaXN0ZW5jZU1h\nbmFnZXIobmV3IEJvb2tLZWVwZXIoYmt0Yi5nZXRaa0hvc3RQb3J0KCkpLCBt\nbSwgdG0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGNvbmYsIHNjaGVkdWxlcik7CiAgICAgICAgYmtwbS5hY3F1\naXJlZFRvcGljKHRvcGljLCBzdHViQ2FsbGJhY2ssIG51bGwpOwogICAgICAg\nIGFzc2VydE51bGwoQ29uY3VycmVuY3lVdGlscy50YWtlKHN0dWJDYWxsYmFj\nay5xdWV1ZSkucmlnaHQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIGJr\ncG0udG9waWNJbmZvcy5nZXQodG9waWMpLmxlZGdlclJhbmdlcy5zaXplKCkp\nOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0Tm9uRW1wdHlEaXJ0eUxlZGdlcigpIHRocm93cyBFeGNlcHRp\nb24gewoKICAgICAgICBSYW5kb20gciA9IG5ldyBSYW5kb20oKTsKICAgICAg\nICBpbnQgTlVNX01FU1NBR0VTX1RPX1RFU1QgPSAxMDA7CiAgICAgICAgaW50\nIFNJWkVfT0ZfTUVTU0FHRVNfVE9fVEVTVCA9IDEwMDsKICAgICAgICBpbnQg\naW5kZXggPSAwOwogICAgICAgIGludCBudW1QcmV2TGVkZ2VycyA9IDA7CiAg\nICAgICAgTGlzdDxNZXNzYWdlPiBtZXNzYWdlcyA9IEhlbHBlck1ldGhvZHMu\nZ2V0UmFuZG9tUHVibGlzaGVkTWVzc2FnZXMoTlVNX01FU1NBR0VTX1RPX1RF\nU1QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNJWkVfT0Zf\nTUVTU0FHRVNfVE9fVEVTVCk7CgogICAgICAgIHdoaWxlIChpbmRleCA8IG1l\nc3NhZ2VzLnNpemUoKSkgewoKICAgICAgICAgICAgU3R1YkNhbGxiYWNrPFZv\naWQ+IHN0dWJDYWxsYmFjayA9IG5ldyBTdHViQ2FsbGJhY2s8Vm9pZD4oKTsK\nICAgICAgICAgICAgYmtwbS5hY3F1aXJlZFRvcGljKHRvcGljLCBzdHViQ2Fs\nbGJhY2ssIG51bGwpOwogICAgICAgICAgICBhc3NlcnROdWxsKENvbmN1cnJl\nbmN5VXRpbHMudGFrZShzdHViQ2FsbGJhY2sucXVldWUpLnJpZ2h0KCkpOwog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMobnVtUHJldkxlZGdlcnMsIGJrcG0u\ndG9waWNJbmZvcy5nZXQodG9waWMpLmxlZGdlclJhbmdlcy5zaXplKCkpOwoK\nICAgICAgICAgICAgU3R1YkNhbGxiYWNrPFB1YlN1YlByb3RvY29sLk1lc3Nh\nZ2VTZXFJZD4gcGVyc2lzdENhbGxiYWNrID0gbmV3IFN0dWJDYWxsYmFjazxQ\ndWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQ+KCk7CiAgICAgICAgICAgIGJr\ncG0ucGVyc2lzdE1lc3NhZ2UobmV3IFBlcnNpc3RSZXF1ZXN0KHRvcGljLCBt\nZXNzYWdlcy5nZXQoaW5kZXgpLCBwZXJzaXN0Q2FsbGJhY2ssIG51bGwpKTsK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGluZGV4ICsgMSwgQ29uY3VycmVu\nY3lVdGlscy50YWtlKHBlcnNpc3RDYWxsYmFjay5xdWV1ZSkubGVmdCgpLmdl\ndExvY2FsQ29tcG9uZW50KCkpOwoKICAgICAgICAgICAgaW5kZXgrKzsKICAg\nICAgICAgICAgLy8gb25jZSBpbiBldmVyeSAxMCB0aW1lcywgZ2l2ZSB1cCBs\nZWRnZXIKICAgICAgICAgICAgaWYgKHIubmV4dEludCgxMCkgPT0gOSkgewog\nICAgICAgICAgICAgICAgLy8gc2hvdWxkIG5vdCByZWxlYXNlIHRvcGljIHdo\nZW4gdGhlIG1lc3NhZ2UgaXMgbGFzdCBtZXNzYWdlCiAgICAgICAgICAgICAg\nICAvLyBvdGhlcndpc2Ugd2hlbiB3ZSBjYWxsIHNjYW4sIGJvb2trZWVwZXIg\ncGVyc2lzdGVuY2UgbWFuYWdlciBkb2Vzbid0IG93biB0aGUgdG9waWMKICAg\nICAgICAgICAgICAgIGlmIChpbmRleCA8IG1lc3NhZ2VzLnNpemUoKSkgewog\nICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIGJrcG0gbG9zZSBpdHMg\nbWVtb3J5CiAgICAgICAgICAgICAgICAgICAgYmtwbS50b3BpY0luZm9zLmNs\nZWFyKCk7CiAgICAgICAgICAgICAgICAgICAgbnVtUHJldkxlZGdlcnMrKzsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgLy8gTGV0cyBzY2FuIG5vdwogICAgICAgIFN0dWJTY2FuQ2FsbGJh\nY2sgc2NhbkNhbGxiYWNrID0gbmV3IFN0dWJTY2FuQ2FsbGJhY2soKTsKICAg\nICAgICBia3BtLnNjYW5NZXNzYWdlcyhuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0\nb3BpYywgMSwgTlVNX01FU1NBR0VTX1RPX1RFU1QsIExvbmcuTUFYX1ZBTFVF\nLCBzY2FuQ2FsbGJhY2ssIG51bGwpKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IG1lc3NhZ2VzLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIE1l\nc3NhZ2Ugc2Nhbm5lZE1lc3NhZ2UgPSBDb25jdXJyZW5jeVV0aWxzLnRha2Uo\nc2NhbkNhbGxiYWNrLnF1ZXVlKS5sZWZ0KCk7CiAgICAgICAgICAgIGFzc2Vy\ndFRydWUobWVzc2FnZXMuZ2V0KGkpLmdldEJvZHkoKS5lcXVhbHMoc2Nhbm5l\nZE1lc3NhZ2UuZ2V0Qm9keSgpKSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncyhpICsgMSwgc2Nhbm5lZE1lc3NhZ2UuZ2V0TXNnSWQoKS5nZXRMb2NhbENv\nbXBvbmVudCgpKTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0VHJ1ZShTdHVi\nU2NhbkNhbGxiYWNrLkVORF9NRVNTQUdFID09IENvbmN1cnJlbmN5VXRpbHMu\ndGFrZShzY2FuQ2FsbGJhY2sucXVldWUpLmxlZnQoKSk7CgogICAgfQoKICAg\nIHN0YXRpYyBmaW5hbCBsb25nIG1heEVudHJpZXNQZXJMZWRnZXIgPSAxMDsK\nCiAgICBjbGFzcyBDaGFuZ2VMZWRnZXJTZXJ2ZXJDb25maWd1cmF0aW9uIGV4\ndGVuZHMgU2VydmVyQ29uZmlndXJhdGlvbiB7CiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIGxvbmcgZ2V0TWF4RW50cmllc1BlckxlZGdlcigp\nIHsKICAgICAgICAgICAgcmV0dXJuIG1heEVudHJpZXNQZXJMZWRnZXI7CiAg\nICAgICAgfQogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0U3luY0NoYW5nZUxlZGdlcnMoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBpbnQgTlVNX01FU1NBR0VTX1RPX1RFU1QgPSAx\nMDE7CiAgICAgICAgaW50IFNJWkVfT0ZfTUVTU0FHRVNfVE9fVEVTVCA9IDEw\nMDsKICAgICAgICBpbnQgaW5kZXggPSAwOwogICAgICAgIExpc3Q8TWVzc2Fn\nZT4gbWVzc2FnZXMgPSBIZWxwZXJNZXRob2RzLmdldFJhbmRvbVB1Ymxpc2hl\nZE1lc3NhZ2VzKE5VTV9NRVNTQUdFU19UT19URVNULAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBTSVpFX09GX01FU1NBR0VTX1RPX1RFU1Qp\nOwoKICAgICAgICBia3BtID0gbmV3IEJvb2trZWVwZXJQZXJzaXN0ZW5jZU1h\nbmFnZXIoYmt0Yi5iaywgbW0sIHRtLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQ2hhbmdlTGVkZ2VyU2Vy\ndmVyQ29uZmlndXJhdGlvbigpLCBzY2hlZHVsZXIpOwoKICAgICAgICAvLyBh\nY3F1aXJlIHRoZSB0b3BpYwogICAgICAgIFN0dWJDYWxsYmFjazxWb2lkPiBz\ndHViQ2FsbGJhY2sgPSBuZXcgU3R1YkNhbGxiYWNrPFZvaWQ+KCk7CiAgICAg\nICAgYmtwbS5hY3F1aXJlZFRvcGljKHRvcGljLCBzdHViQ2FsbGJhY2ssIG51\nbGwpOwogICAgICAgIGFzc2VydE51bGwoQ29uY3VycmVuY3lVdGlscy50YWtl\nKHN0dWJDYWxsYmFjay5xdWV1ZSkucmlnaHQoKSk7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKDAsIGJrcG0udG9waWNJbmZvcy5nZXQodG9waWMpLmxlZGdlclJh\nbmdlcy5zaXplKCkpOwoKICAgICAgICB3aGlsZSAoaW5kZXggPCBtZXNzYWdl\ncy5zaXplKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCJQZXJzaXN0\nIG1lc3NhZ2Uge30iLCAoaW5kZXggKyAxKSk7CiAgICAgICAgICAgIFN0dWJD\nYWxsYmFjazxNZXNzYWdlU2VxSWQ+IHBlcnNpc3RDYWxsYmFjayA9IG5ldyBT\ndHViQ2FsbGJhY2s8TWVzc2FnZVNlcUlkPigpOwogICAgICAgICAgICBia3Bt\nLnBlcnNpc3RNZXNzYWdlKG5ldyBQZXJzaXN0UmVxdWVzdCh0b3BpYywgbWVz\nc2FnZXMuZ2V0KGluZGV4KSwgcGVyc2lzdENhbGxiYWNrLCBudWxsKSk7CiAg\nICAgICAgICAgIGFzc2VydEVxdWFscyhpbmRleCArIDEsIENvbmN1cnJlbmN5\nVXRpbHMudGFrZShwZXJzaXN0Q2FsbGJhY2sucXVldWUpLmxlZnQoKS5nZXRM\nb2NhbENvbXBvbmVudCgpKTsKCiAgICAgICAgICAgIGluZGV4Kys7CiAgICAg\nICAgICAgIGlmIChpbmRleCAlIG1heEVudHJpZXNQZXJMZWRnZXIgPT0gMSkg\newogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGluZGV4IC8gbWF4RW50\ncmllc1BlckxlZGdlciwgYmtwbS50b3BpY0luZm9zLmdldCh0b3BpYykubGVk\nZ2VyUmFuZ2VzLnNpemUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKE5VTV9NRVNTQUdFU19UT19URVNUIC8gbWF4\nRW50cmllc1BlckxlZGdlciwgYmtwbS50b3BpY0luZm9zLmdldCh0b3BpYyku\nbGVkZ2VyUmFuZ2VzLnNpemUoKSk7CgogICAgICAgIC8vIExldHMgc2NhbiBu\nb3cKICAgICAgICBTdHViU2NhbkNhbGxiYWNrIHNjYW5DYWxsYmFjayA9IG5l\ndyBTdHViU2NhbkNhbGxiYWNrKCk7CiAgICAgICAgYmtwbS5zY2FuTWVzc2Fn\nZXMobmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMsIDEsIE5VTV9NRVNTQUdF\nU19UT19URVNULCBMb25nLk1BWF9WQUxVRSwgc2NhbkNhbGxiYWNrLCBudWxs\nKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtZXNzYWdlcy5zaXpl\nKCk7IGkrKykgewogICAgICAgICAgICBNZXNzYWdlIHNjYW5uZWRNZXNzYWdl\nID0gQ29uY3VycmVuY3lVdGlscy50YWtlKHNjYW5DYWxsYmFjay5xdWV1ZSku\nbGVmdCgpOwogICAgICAgICAgICBhc3NlcnRUcnVlKG1lc3NhZ2VzLmdldChp\nKS5nZXRCb2R5KCkuZXF1YWxzKHNjYW5uZWRNZXNzYWdlLmdldEJvZHkoKSkp\nOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoaSArIDEsIHNjYW5uZWRNZXNz\nYWdlLmdldE1zZ0lkKCkuZ2V0TG9jYWxDb21wb25lbnQoKSk7CiAgICAgICAg\nfQogICAgICAgIGFzc2VydFRydWUoU3R1YlNjYW5DYWxsYmFjay5FTkRfTUVT\nU0FHRSA9PSBDb25jdXJyZW5jeVV0aWxzLnRha2Uoc2NhbkNhbGxiYWNrLnF1\nZXVlKS5sZWZ0KCkpOwoKICAgICAgICAvLyBNYWtlIHRoZSBia3BtIGxvc2Ug\naXRzIG1lbW9yeQogICAgICAgIGJrcG0udG9waWNJbmZvcy5jbGVhcigpOwoK\nICAgICAgICAvLyBhY3F1aXJlIHRoZSB0b3BpYyBhZ2FpbgogICAgICAgIHN0\ndWJDYWxsYmFjayA9IG5ldyBTdHViQ2FsbGJhY2s8Vm9pZD4oKTsKICAgICAg\nICBia3BtLmFjcXVpcmVkVG9waWModG9waWMsIHN0dWJDYWxsYmFjaywgbnVs\nbCk7CiAgICAgICAgYXNzZXJ0TnVsbChDb25jdXJyZW5jeVV0aWxzLnRha2Uo\nc3R1YkNhbGxiYWNrLnF1ZXVlKS5yaWdodCgpKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoTlVNX01FU1NBR0VTX1RPX1RFU1QgLyBtYXhFbnRyaWVzUGVyTGVk\nZ2VyICsgMSwgYmtwbS50b3BpY0luZm9zLmdldCh0b3BpYykubGVkZ2VyUmFu\nZ2VzLnNpemUoKSk7CiAgICB9CgogICAgY2xhc3MgT3JkZXJDaGVja2luZ0Nh\nbGxiYWNrIGV4dGVuZHMgU3R1YkNhbGxiYWNrPE1lc3NhZ2VTZXFJZD4gewog\nICAgICAgIGxvbmcgY3VyTXNnSWQ7CiAgICAgICAgaW50IG51bU1lc3NhZ2Vz\nOwogICAgICAgIGludCBudW1Qcm9jZXNzZWQ7CiAgICAgICAgaW50IG51bVN1\nY2Nlc3M7CiAgICAgICAgaW50IG51bUZhaWxlZDsKCiAgICAgICAgT3JkZXJD\naGVja2luZ0NhbGxiYWNrKGxvbmcgc3RhcnRNc2dJZCwgaW50IG51bU1lc3Nh\nZ2VzKSB7CiAgICAgICAgICAgIHRoaXMuY3VyTXNnSWQgPSBzdGFydE1zZ0lk\nOwogICAgICAgICAgICB0aGlzLm51bU1lc3NhZ2VzID0gbnVtTWVzc2FnZXM7\nCiAgICAgICAgICAgIG51bVByb2Nlc3NlZCA9IG51bVN1Y2Nlc3MgPSBudW1G\nYWlsZWQgPSAwOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIGZp\nbmFsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAg\nc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgICAgICArK251bUZh\naWxlZDsKICAgICAgICAgICAgICAgICsrbnVtUHJvY2Vzc2VkOwogICAgICAg\nICAgICAgICAgaWYgKG51bVByb2Nlc3NlZCA9PSBudW1NZXNzYWdlcykgewog\nICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTZXFJZC5CdWlsZGVyIHNlcUlk\nQnVpbGRlciA9CiAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTZXFJ\nZC5uZXdCdWlsZGVyKCkuc2V0TG9jYWxDb21wb25lbnQoY3VyTXNnSWQpOwog\nICAgICAgICAgICAgICAgICAgIHN1cGVyLm9wZXJhdGlvbkZpbmlzaGVkKGN0\neCwgc2VxSWRCdWlsZGVyLmJ1aWxkKCkpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4\nLCBmaW5hbCBNZXNzYWdlU2VxSWQgc2VxSWQpIHsKICAgICAgICAgICAgc3lu\nY2hyb25pemVkKHRoaXMpIHsKICAgICAgICAgICAgICAgIGxvbmcgbXNnSWQg\nPSBzZXFJZC5nZXRMb2NhbENvbXBvbmVudCgpOwogICAgICAgICAgICAgICAg\naWYgKG1zZ0lkID09IGN1ck1zZ0lkKSB7CiAgICAgICAgICAgICAgICAgICAg\nKytjdXJNc2dJZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICsrbnVtU3VjY2VzczsKICAgICAgICAgICAgICAgICsrbnVtUHJvY2Vzc2Vk\nOwogICAgICAgICAgICAgICAgaWYgKG51bVByb2Nlc3NlZCA9PSBudW1NZXNz\nYWdlcykgewogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VTZXFJZC5CdWls\nZGVyIHNlcUlkQnVpbGRlciA9CiAgICAgICAgICAgICAgICAgICAgICAgIE1l\nc3NhZ2VTZXFJZC5uZXdCdWlsZGVyKCkuc2V0TG9jYWxDb21wb25lbnQoY3Vy\nTXNnSWQpOwogICAgICAgICAgICAgICAgICAgIHN1cGVyLm9wZXJhdGlvbkZp\nbmlzaGVkKGN0eCwgc2VxSWRCdWlsZGVyLmJ1aWxkKCkpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIEBU\nZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0QXN5bmND\naGFuZ2VMZWRnZXJzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50\nIE5VTV9NRVNTQUdFU19UT19URVNUID0gMTAxOwogICAgICAgIGludCBTSVpF\nX09GX01FU1NBR0VTX1RPX1RFU1QgPSAxMDA7CiAgICAgICAgTGlzdDxNZXNz\nYWdlPiBtZXNzYWdlcyA9IEhlbHBlck1ldGhvZHMuZ2V0UmFuZG9tUHVibGlz\naGVkTWVzc2FnZXMoTlVNX01FU1NBR0VTX1RPX1RFU1QsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIFNJWkVfT0ZfTUVTU0FHRVNfVE9fVEVT\nVCk7CgogICAgICAgIGJrcG0gPSBuZXcgQm9va2tlZXBlclBlcnNpc3RlbmNl\nTWFuYWdlcihia3RiLmJrLCBtbSwgdG0sCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBDaGFuZ2VMZWRnZXJT\nZXJ2ZXJDb25maWd1cmF0aW9uKCksIHNjaGVkdWxlcik7CgogICAgICAgIC8v\nIGFjcXVpcmUgdGhlIHRvcGljCiAgICAgICAgU3R1YkNhbGxiYWNrPFZvaWQ+\nIHN0dWJDYWxsYmFjayA9IG5ldyBTdHViQ2FsbGJhY2s8Vm9pZD4oKTsKICAg\nICAgICBia3BtLmFjcXVpcmVkVG9waWModG9waWMsIHN0dWJDYWxsYmFjaywg\nbnVsbCk7CiAgICAgICAgYXNzZXJ0TnVsbChDb25jdXJyZW5jeVV0aWxzLnRh\na2Uoc3R1YkNhbGxiYWNrLnF1ZXVlKS5yaWdodCgpKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMCwgYmtwbS50b3BpY0luZm9zLmdldCh0b3BpYykubGVkZ2Vy\nUmFuZ2VzLnNpemUoKSk7CgogICAgICAgIE9yZGVyQ2hlY2tpbmdDYWxsYmFj\nayBwZXJzaXN0Q2FsbGJhY2sgPQogICAgICAgICAgICBuZXcgT3JkZXJDaGVj\na2luZ0NhbGxiYWNrKDEsIE5VTV9NRVNTQUdFU19UT19URVNUKTsKICAgICAg\nICBmb3IgKE1lc3NhZ2UgbWVzc2FnZSA6IG1lc3NhZ2VzKSB7CiAgICAgICAg\nICAgIGJrcG0ucGVyc2lzdE1lc3NhZ2UobmV3IFBlcnNpc3RSZXF1ZXN0KHRv\ncGljLCBtZXNzYWdlLCBwZXJzaXN0Q2FsbGJhY2ssIG51bGwpKTsKICAgICAg\nICB9CiAgICAgICAgYXNzZXJ0RXF1YWxzKE5VTV9NRVNTQUdFU19UT19URVNU\nICsgMSwKICAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy50\nYWtlKHBlcnNpc3RDYWxsYmFjay5xdWV1ZSkubGVmdCgpLmdldExvY2FsQ29t\ncG9uZW50KCkpOwogICAgICAgIGFzc2VydEVxdWFscyhOVU1fTUVTU0FHRVNf\nVE9fVEVTVCwgcGVyc2lzdENhbGxiYWNrLm51bVN1Y2Nlc3MpOwogICAgICAg\nIGFzc2VydEVxdWFscygwLCBwZXJzaXN0Q2FsbGJhY2subnVtRmFpbGVkKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoTlVNX01FU1NBR0VTX1RPX1RFU1QgLyBt\nYXhFbnRyaWVzUGVyTGVkZ2VyLAogICAgICAgICAgICAgICAgICAgICBia3Bt\nLnRvcGljSW5mb3MuZ2V0KHRvcGljKS5sZWRnZXJSYW5nZXMuc2l6ZSgpKTsK\nCiAgICAgICAgLy8gZW5zdXJlIHRoZSBia3BtIGhhcyB0aGUgdG9waWMgYmVm\nb3JlIHNjYW5uaW5nCiAgICAgICAgc3R1YkNhbGxiYWNrID0gbmV3IFN0dWJD\nYWxsYmFjazxWb2lkPigpOwogICAgICAgIGJrcG0uYWNxdWlyZWRUb3BpYyh0\nb3BpYywgc3R1YkNhbGxiYWNrLCBudWxsKTsKCiAgICAgICAgLy8gTGV0cyBz\nY2FuIG5vdwogICAgICAgIFN0dWJTY2FuQ2FsbGJhY2sgc2NhbkNhbGxiYWNr\nID0gbmV3IFN0dWJTY2FuQ2FsbGJhY2soKTsKICAgICAgICBia3BtLnNjYW5N\nZXNzYWdlcyhuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgMSwgTlVNX01F\nU1NBR0VTX1RPX1RFU1QsIExvbmcuTUFYX1ZBTFVFLCBzY2FuQ2FsbGJhY2ss\nIG51bGwpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1lc3NhZ2Vz\nLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIEVpdGhlcjxNZXNzYWdlLEV4\nY2VwdGlvbj4gZSA9IENvbmN1cnJlbmN5VXRpbHMudGFrZShzY2FuQ2FsbGJh\nY2sucXVldWUpOwogICAgICAgICAgICBNZXNzYWdlIHNjYW5uZWRNZXNzYWdl\nID0gZS5sZWZ0KCk7CiAgICAgICAgICAgIGlmIChzY2FubmVkTWVzc2FnZSA9\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBlLnJpZ2h0KCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIGFzc2VydFRydWUobWVzc2FnZXMu\nZ2V0KGkpLmdldEJvZHkoKS5lcXVhbHMoc2Nhbm5lZE1lc3NhZ2UuZ2V0Qm9k\neSgpKSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhpICsgMSwgc2Nhbm5l\nZE1lc3NhZ2UuZ2V0TXNnSWQoKS5nZXRMb2NhbENvbXBvbmVudCgpKTsKICAg\nICAgICB9CiAgICAgICAgYXNzZXJ0VHJ1ZShTdHViU2NhbkNhbGxiYWNrLkVO\nRF9NRVNTQUdFID09IENvbmN1cnJlbmN5VXRpbHMudGFrZShzY2FuQ2FsbGJh\nY2sucXVldWUpLmxlZnQoKSk7CgogICAgICAgIC8vIE1ha2UgdGhlIGJrcG0g\nbG9zZSBpdHMgbWVtb3J5CiAgICAgICAgYmtwbS50b3BpY0luZm9zLmNsZWFy\nKCk7CgogICAgICAgIC8vIGFjcXVpcmUgdGhlIHRvcGljIGFnYWluCiAgICAg\nICAgc3R1YkNhbGxiYWNrID0gbmV3IFN0dWJDYWxsYmFjazxWb2lkPigpOwog\nICAgICAgIGJrcG0uYWNxdWlyZWRUb3BpYyh0b3BpYywgc3R1YkNhbGxiYWNr\nLCBudWxsKTsKICAgICAgICBhc3NlcnROdWxsKENvbmN1cnJlbmN5VXRpbHMu\ndGFrZShzdHViQ2FsbGJhY2sucXVldWUpLnJpZ2h0KCkpOwogICAgICAgIGFz\nc2VydEVxdWFscyhOVU1fTUVTU0FHRVNfVE9fVEVTVCAvIG1heEVudHJpZXNQ\nZXJMZWRnZXIgKyAxLAogICAgICAgICAgICAgICAgICAgICBia3BtLnRvcGlj\nSW5mb3MuZ2V0KHRvcGljKS5sZWRnZXJSYW5nZXMuc2l6ZSgpKTsKICAgIH0K\nCiAgICBjbGFzcyBDaGFuZ2VMZWRnZXJDYWxsYmFjayBleHRlbmRzIE9yZGVy\nQ2hlY2tpbmdDYWxsYmFjayB7CiAgICAgICAgYm9vbGVhbiB0ZWFyRG93biA9\nIGZhbHNlOwogICAgICAgIENoYW5nZUxlZGdlckNhbGxiYWNrKGxvbmcgc3Rh\ncnRNc2dJZCwgaW50IG51bU1lc3NhZ2VzKSB7CiAgICAgICAgICAgIHN1cGVy\nKHN0YXJ0TXNnSWQsIG51bU1lc3NhZ2VzKTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlz\naGVkKE9iamVjdCBjdHgsIGZpbmFsIE1lc3NhZ2VTZXFJZCBtc2dJZCkgewog\nICAgICAgICAgICBzdXBlci5vcGVyYXRpb25GaW5pc2hlZChjdHgsIG1zZ0lk\nKTsKICAgICAgICAgICAgLy8gc2h1dGRvd24gYm9va2llIHNlcnZlciB3aGVu\nIGNoYW5naW5nIGxlZGdlcgogICAgICAgICAgICAvLyBzbyBmb2xsb3dpbmcg\ncmVxdWVzdHMgc2hvdWxkIGZhaWwKICAgICAgICAgICAgaWYgKG1zZ0lkLmdl\ndExvY2FsQ29tcG9uZW50KCkgPj0gbWF4RW50cmllc1BlckxlZGdlciAmJiAh\ndGVhckRvd24pIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgYmt0Yi50ZWFyRG93bk9uZUJvb2tpZVNlcnZlcigpOwogICAg\nICAgICAgICAgICAgICAgIGJrdGIudGVhckRvd25PbmVCb29raWVTZXJ2ZXIo\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJGYWlsZWQgdG8gdGVh\nciBkb3duIGJvb2tpZSBzZXJ2ZXIuIik7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB0ZWFyRG93biA9IHRydWU7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAg\nIHB1YmxpYyB2b2lkIHRlc3RDaGFuZ2VMZWRnZXJGYWlsdXJlKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IE5VTV9NRVNTQUdFU19UT19URVNU\nID0gMTAxOwogICAgICAgIGludCBTSVpFX09GX01FU1NBR0VTX1RPX1RFU1Qg\nPSAxMDA7CiAgICAgICAgTGlzdDxNZXNzYWdlPiBtZXNzYWdlcyA9IEhlbHBl\nck1ldGhvZHMuZ2V0UmFuZG9tUHVibGlzaGVkTWVzc2FnZXMoTlVNX01FU1NB\nR0VTX1RPX1RFU1QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIFNJWkVfT0ZfTUVTU0FHRVNfVE9fVEVTVCk7CgogICAgICAgIGJrcG0gPSBu\nZXcgQm9va2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcihia3RiLmJrLCBtbSwg\ndG0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIG5ldyBDaGFuZ2VMZWRnZXJTZXJ2ZXJDb25maWd1cmF0aW9uKCks\nIHNjaGVkdWxlcik7CgogICAgICAgIC8vIGFjcXVpcmUgdGhlIHRvcGljCiAg\nICAgICAgU3R1YkNhbGxiYWNrPFZvaWQ+IHN0dWJDYWxsYmFjayA9IG5ldyBT\ndHViQ2FsbGJhY2s8Vm9pZD4oKTsKICAgICAgICBia3BtLmFjcXVpcmVkVG9w\naWModG9waWMsIHN0dWJDYWxsYmFjaywgbnVsbCk7CiAgICAgICAgYXNzZXJ0\nTnVsbChDb25jdXJyZW5jeVV0aWxzLnRha2Uoc3R1YkNhbGxiYWNrLnF1ZXVl\nKS5yaWdodCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMCwgYmtwbS50b3Bp\nY0luZm9zLmdldCh0b3BpYykubGVkZ2VyUmFuZ2VzLnNpemUoKSk7CgogICAg\nICAgIENoYW5nZUxlZGdlckNhbGxiYWNrIHBlcnNpc3RDYWxsYmFjayA9CiAg\nICAgICAgICAgIG5ldyBDaGFuZ2VMZWRnZXJDYWxsYmFjaygxLCBOVU1fTUVT\nU0FHRVNfVE9fVEVTVCk7CiAgICAgICAgZm9yIChNZXNzYWdlIG1lc3NhZ2Ug\nOiBtZXNzYWdlcykgewogICAgICAgICAgICBia3BtLnBlcnNpc3RNZXNzYWdl\nKG5ldyBQZXJzaXN0UmVxdWVzdCh0b3BpYywgbWVzc2FnZSwgcGVyc2lzdENh\nbGxiYWNrLCBudWxsKSk7CiAgICAgICAgfQogICAgICAgIGFzc2VydEVxdWFs\ncyhtYXhFbnRyaWVzUGVyTGVkZ2VyICsgMSwKICAgICAgICAgICAgICAgICAg\nICAgQ29uY3VycmVuY3lVdGlscy50YWtlKHBlcnNpc3RDYWxsYmFjay5xdWV1\nZSkubGVmdCgpLmdldExvY2FsQ29tcG9uZW50KCkpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhtYXhFbnRyaWVzUGVyTGVkZ2VyLCBwZXJzaXN0Q2FsbGJhY2su\nbnVtU3VjY2Vzcyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKE5VTV9NRVNTQUdF\nU19UT19URVNUIC0gbWF4RW50cmllc1BlckxlZGdlciwgcGVyc2lzdENhbGxi\nYWNrLm51bUZhaWxlZCk7CiAgICB9Cn0K\n","encoding":"base64"}

