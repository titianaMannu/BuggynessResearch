{"sha":"6e81fc7d6c2e64f301f7f1b55aa4bc2719896a30","node_id":"MDQ6QmxvYjE1NzU5NTY6NmU4MWZjN2Q2YzJlNjRmMzAxZjdmMWI1NWFhNGJjMjcxOTg5NmEzMA==","size":10248,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/6e81fc7d6c2e64f301f7f1b55aa4bc2719896a30","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuU3luY2hyb25vdXNRdWV1ZTsKCmltcG9ydCBvcmcuanVuaXQu\nQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1\nbml0LlRlc3Q7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJv\ndG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNs\naWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmNsaWVudC5hcGkuU3Vic2NyaWJlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1l\nc3NhZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1ZXN0LkNyZWF0ZU9yQXR0YWNoOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuU3Vic2NyaXB0aW9uT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVk\nd2lnLnNlcnZlci5IZWR3aWdIdWJUZXN0QmFzZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNvbmN1cnJlbmN5VXRpbHM7Cgpw\ndWJsaWMgY2xhc3MgVGVzdERlYWRsb2NrIGV4dGVuZHMgSGVkd2lnSHViVGVz\ndEJhc2UgewoKICAgIHByb3RlY3RlZCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9\nIExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFRlc3REZWFkbG9jay5jbGFzcyk7\nCgogICAgLy8gQ2xpZW50IHNpZGUgdmFyaWFibGVzCiAgICBwcm90ZWN0ZWQg\nSGVkd2lnQ2xpZW50IGNsaWVudDsKICAgIHByb3RlY3RlZCBQdWJsaXNoZXIg\ncHVibGlzaGVyOwogICAgcHJvdGVjdGVkIFN1YnNjcmliZXIgc3Vic2NyaWJl\ncjsKCiAgICBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJv\nbVV0ZjgoIkRlYWRMb2NrVG9waWMiKTsKICAgIEJ5dGVTdHJpbmcgc3Vic2Ny\naWJlcklkID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoImRsIik7CgogICAg\ncHVibGljIFRlc3REZWFkbG9jaygpIHsKICAgICAgICBzdXBlcigxKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lk\nIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbnVtQm9va2ll\ncyA9IDE7CiAgICAgICAgcmVhZERlbGF5ID0gMTAwMEw7IC8vIDFzCiAgICAg\nICAgc3VwZXIuc2V0VXAoKTsKICAgICAgICBjbGllbnQgPSBuZXcgSGVkd2ln\nQ2xpZW50KG5ldyBIdWJDbGllbnRDb25maWd1cmF0aW9uKCkpOwogICAgICAg\nIHB1Ymxpc2hlciA9IGNsaWVudC5nZXRQdWJsaXNoZXIoKTsKICAgICAgICBz\ndWJzY3JpYmVyID0gY2xpZW50LmdldFN1YnNjcmliZXIoKTsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIEBBZnRlcgogICAgcHVibGljIHZvaWQgdGVhckRv\nd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBjbGllbnQuY2xvc2Uo\nKTsKICAgICAgICBzdXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIC8vIFRl\nc3QgaW1wbGVtZW50YXRpb24gb2YgQ2FsbGJhY2sgZm9yIGFzeW5jIGNsaWVu\ndCBhY3Rpb25zLgogICAgc3RhdGljIGNsYXNzIFRlc3RDYWxsYmFjayBpbXBs\nZW1lbnRzIENhbGxiYWNrPFZvaWQ+IHsKICAgICAgICBwcml2YXRlIGZpbmFs\nIFN5bmNocm9ub3VzUXVldWU8Qm9vbGVhbj4gcXVldWU7CgogICAgICAgIHB1\nYmxpYyBUZXN0Q2FsbGJhY2soU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBx\ndWV1ZSkgewogICAgICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBv\ncGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBWb2lkIHJlc3VsdE9mT3Bl\ncmF0aW9uKSB7CiAgICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxl\nKCkgewogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAg\nICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAg\nICAgICBsb2dnZXIuZGVidWcoIk9wZXJhdGlvbiBmaW5pc2hlZCEiKTsKICAg\nICAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChxdWV1ZSwg\ndHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnN0YXJ0\nKCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgdm9pZCBvcGVyYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgZmluYWwgUHVi\nU3ViRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICBuZXcgVGhy\nZWFkKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAg\nICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiT3BlcmF0aW9uIGZhaWxlZCEi\nLCBleGNlcHRpb24pOwogICAgICAgICAgICAgICAgICAgIENvbmN1cnJlbmN5\nVXRpbHMucHV0KHF1ZXVlLCBmYWxzZSk7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0pLnN0YXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8v\nIFRlc3QgaW1wbGVtZW50YXRpb24gb2Ygc3Vic2NyaWJlcidzIG1lc3NhZ2Ug\naGFuZGxlci4KICAgIGNsYXNzIFRlc3RNZXNzYWdlSGFuZGxlciBpbXBsZW1l\nbnRzIE1lc3NhZ2VIYW5kbGVyIHsKICAgICAgICBwcml2YXRlIGZpbmFsIFN5\nbmNocm9ub3VzUXVldWU8Qm9vbGVhbj4gY29uc3VtZVF1ZXVlOwogICAgICAg\nIGJvb2xlYW4gZG9BZGQgPSBmYWxzZTsKCiAgICAgICAgcHVibGljIFRlc3RN\nZXNzYWdlSGFuZGxlcihTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1\nbWVRdWV1ZSkgewogICAgICAgICAgICB0aGlzLmNvbnN1bWVRdWV1ZSA9IGNv\nbnN1bWVRdWV1ZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGRl\nbGl2ZXIoQnl0ZVN0cmluZyB0LCBCeXRlU3RyaW5nIHN1YiwgZmluYWwgTWVz\nc2FnZSBtc2csIENhbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAg\nICAgaWYgKCFkb0FkZCkgewogICAgICAgICAgICAgICAgLy8gYWZ0ZXIgcmVj\nZWl2aW5nIGZpcnN0IG1lc3NhZ2UsIHdlIHNlbmQgYSBwdWJsaXNoCiAgICAg\nICAgICAgICAgICAvLyB0byBvYnRhaW4gcGVybWl0IG9mIHNlY29uZCBsZWRn\nZXIKICAgICAgICAgICAgICAgIGRvQWRkID0gdHJ1ZTsKICAgICAgICAgICAg\nICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVibGlz\naCBtZXNzYWdlcyBhZ2FpbiB0byBvYnRhaW4gcGVybWl0cwogICAgICAgICAg\nICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiU3RhcnQgcHVibGlzaGluZyBt\nZXNzYWdlIHRvIG9idGFpbiBwZXJtaXQiKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gaXQgb2J0YWlucyB0aGUgcGVybWl0IGFuZCB3YWl0IGZvciBh\nIHJlc3BvbnNlLAogICAgICAgICAgICAgICAgICAgICAgICAvLyBidXQgdGhl\nIHJlc3BvbnNlIGlzIGRlbGF5ZWQgYW5kIHJlYWRFbnRyaWVzIGlzIGNhbGxl\nZAogICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiB0aGUgcmVhZENvbXBs\nZXRlIGNhbGxiYWNrIHRvIHJlYWQgZW50cmllcyBvZiB0aGUKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gc2FtZSBsZWRnZXIuIHNpbmNlIHRoZXJlIGlz\nIG5vIHBlcm1pdCwgaXQgYmxvY2tzCiAgICAgICAgICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudERvd25M\nYXRjaCBsYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHNsZWVwQm9va2llcyg4LCBsYXRjaCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRjaC5hd2FpdCgpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgU3luY2hyb25vdXNRdWV1ZTxCb29s\nZWFuPiBxdWV1ZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8\nMzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVi\nbGlzaGVyLmFzeW5jUHVibGlzaCh0b3BpYywgZ2V0TXNnKDk5OTkpLCBuZXcg\nVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Ig\nKGludCBpPTA7IGk8MzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKCFxdWV1ZS50YWtlKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJFcnJvciBwdWJs\naXNoaW5nIHRvIHRvcGljIHt9IiwgdG9waWMpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChjb25z\ndW1lUXVldWUsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkZhaWxlZCB0\nbyBwdWJsaXNoIG1lc3NhZ2UgdG8gb2J0YWluIHBlcm1pdC4iKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0pLnN0YXJ0KCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5w\ndXQoY29uc3VtZVF1ZXVlLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfSkuc3RhcnQoKTsKICAgICAgICAgICAgY2FsbGJhY2sub3Bl\ncmF0aW9uRmluaXNoZWQoY29udGV4dCwgbnVsbCk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZW5lcmF0ZSBNZXNzYWdl\ncwogICAgcHJvdGVjdGVkIE1lc3NhZ2UgZ2V0TXNnKGludCBtc2dOdW0pIHsK\nICAgICAgICByZXR1cm4gTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keShC\neXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiTWVzc2FnZSIgKyBtc2dOdW0pKS5i\ndWlsZCgpOwogICAgfQoKICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZW5l\ncmF0ZSBUb3BpY3MKICAgIHByb3RlY3RlZCBCeXRlU3RyaW5nIGdldFRvcGlj\nKGludCB0b3BpY051bSkgewogICAgICAgIHJldHVybiBCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOCgiRGVhZExvY2tUb3BpYyIgKyB0b3BpY051bSk7CiAgICB9\nCgogICAgY2xhc3MgVGVzdFNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5kcyBI\ndWJTZXJ2ZXJDb25maWd1cmF0aW9uIHsKICAgICAgICBwdWJsaWMgVGVzdFNl\ncnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2\nZXJQb3J0KSB7CiAgICAgICAgICAgIHN1cGVyKHNlcnZlclBvcnQsIHNzbFNl\ncnZlclBvcnQpOwogICAgICAgIH0KICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgaW50IGdldEJrRW5zZW1ibGVTaXplKCkgewogICAgICAgICAg\nICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIGludCBnZXRCa1dyaXRlUXVvcnVtU2l6ZSgpIHsKICAgICAg\nICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBpbnQgZ2V0QmtBY2tRdW9ydW1TaXplKCkgewogICAg\nICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIGludCBnZXRSZWFkQWhlYWRDb3VudCgpIHsKICAg\nICAgICAgICAgcmV0dXJuIDQ7CiAgICAgICAgfQogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBsb25nIGdldE1heGltdW1DYWNoZVNpemUoKSB7\nCiAgICAgICAgICAgIHJldHVybiAzMjsKICAgICAgICB9CiAgICB9CgogICAg\nQFN1cHByZXNzV2FybmluZ3MoImRlcHJlY2F0aW9uIikKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIFNlcnZlckNvbmZpZ3VyYXRpb24gZ2V0U2VydmVy\nQ29uZmlndXJhdGlvbihpbnQgc2VydmVyUG9ydCwgaW50IHNzbFNlcnZlclBv\ncnQpIHsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIHNlcnZlckNvbmYg\nPSBuZXcgVGVzdFNlcnZlckNvbmZpZ3VyYXRpb24oc2VydmVyUG9ydCwgc3Ns\nU2VydmVyUG9ydCk7CgogICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nb25mLkNsaWVudENvbmZpZ3VyYXRpb24gYmtDbGllbnRDb25mID0KICAgICAg\nICAgICAgbmV3IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkNsaWVudENv\nbmZpZ3VyYXRpb24oKTsKICAgICAgICBia0NsaWVudENvbmYuc2V0TnVtV29y\na2VyVGhyZWFkcygxKS5zZXRSZWFkVGltZW91dCg5OTk5KQogICAgICAgICAg\nICAgICAgICAgIC5zZXRUaHJvdHRsZVZhbHVlKDMpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHNlcnZlckNvbmYuYWRkQ29uZihia0NsaWVudENvbmYp\nOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBzZXJ2ZXJDb25mOwogICAgfQoKICAgIEBUZXN0KHRp\nbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGVhZGxvY2soKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbnVtTWVzc2FnZXMgPSA1\nOwoKICAgICAgICBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1bWVR\ndWV1ZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CgogICAg\nICAgIC8vIHN1YnNjcmliZSB0byB0b3BpYwogICAgICAgIGxvZ2dlci5pbmZv\nKCJTZXR1cCBzdWJzY3JpcHRpb25zIik7CiAgICAgICAgU3Vic2NyaXB0aW9u\nT3B0aW9ucyBvcHRzID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVy\nKCkKICAgICAgICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0\nYWNoLkNSRUFURV9PUl9BVFRBQ0gpLmJ1aWxkKCk7CiAgICAgICAgc3Vic2Ny\naWJlci5zdWJzY3JpYmUodG9waWMsIHN1YnNjcmliZXJJZCwgb3B0cyk7CiAg\nICAgICAgc3Vic2NyaWJlci5jbG9zZVN1YnNjcmlwdGlvbih0b3BpYywgc3Vi\nc2NyaWJlcklkKTsKCiAgICAgICAgLy8gcHVibGlzaCA1IG1lc3NhZ2VzIHRv\nIGZvcm0gZmlyc3QgbGVkZ2VyCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51\nbU1lc3NhZ2VzOyBpKyspIHsKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlN0\nYXJ0IHB1Ymxpc2hpbmcgbWVzc2FnZSB7fSIsIGkpOwogICAgICAgICAgICBw\ndWJsaXNoZXIucHVibGlzaCh0b3BpYywgZ2V0TXNnKGkpKTsKICAgICAgICB9\nCgogICAgICAgIHN0b3BIdWJTZXJ2ZXJzKCk7CiAgICAgICAgVGhyZWFkLnNs\nZWVwKDEwMDApOwogICAgICAgIHN0YXJ0SHViU2VydmVycygpOwoKICAgICAg\nICBsb2dnZXIuaW5mbygiU3RhcnQgcHVibGlzaGluZyBtZXNzYWdlcyIpOwog\nICAgICAgIC8vIHB1Ymxpc2ggZW5vdWdoIG1lc3NhZ2VzIHRvIHNlY29uZCBs\nZWRnZXIKICAgICAgICAvLyBzbyBhIHNjYW4gcmVxdWVzdCBuZWVkIHRvIHNj\nYW4gb3ZlciB0d28gbGVkZ2Vycywgd2hpY2gKICAgICAgICAvLyBjYXVzZSBy\nZWFkRW50cmllcyBleGVjdXRlZCBpbiB0aGUgcHJldmlvdXMgcmVhZEVudHJp\nZXMKICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtTWVzc2FnZXM7IGkrKykg\newogICAgICAgICAgICBsb2dnZXIuaW5mbygiU3RhcnQgcHVibGlzaGluZyBt\nZXNzYWdlIHt9IiwgaSs1KTsKICAgICAgICAgICAgcHVibGlzaGVyLnB1Ymxp\nc2godG9waWMsIGdldE1zZyhpKSk7CiAgICAgICAgfQoKICAgICAgICBsb2dn\nZXIuaW5mbygiU3RhcnQgc3Vic2NyaWJlIHRvcGljcyBhZ2FpbiBhbmQgcmVj\nZWl2ZSBtZXNzYWdlcyIpOwogICAgICAgIC8vIHN1YnNjcmliZSB0byB0b3Bp\nYwogICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKHRvcGljLCBzdWJzY3Jp\nYmVySWQsIG9wdHMpOwogICAgICAgIHN1YnNjcmliZXIuc3RhcnREZWxpdmVy\neSh0b3BpYywgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBuZXcgVGVzdE1lc3NhZ2VIYW5kbGVyKGNvbnN1bWVRdWV1\nZSkpOwogICAgICAgIGZvciAoaW50IGk9MDsgaTwoMipudW1NZXNzYWdlcysz\nKTsgaSsrKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoY29uc3VtZVF1ZXVl\nLnRha2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lk\nIHNsZWVwQm9va2llcyhmaW5hbCBpbnQgc2Vjb25kcywgZmluYWwgQ291bnRE\nb3duTGF0Y2ggbCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhj\nZXB0aW9uLCBJT0V4Y2VwdGlvbiB7CiAgICAgICAgVGhyZWFkIHNsZWVwZXIg\nPSBuZXcgVGhyZWFkKCkgewogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\ncnVuKCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGJrdGIuc3VzcGVuZEFsbEJvb2tpZVNlcnZlcnMoKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgbC5jb3VudERvd24oKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKHNlY29uZHMgKiAxMDAw\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYmt0Yi5yZXN1bWVBbGxCb29r\naWVTZXJ2ZXJzKCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJFcnJvciBzdXNwZW5kaW5nIHRocmVhZCIsIGUpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsK\nICAgICAgICBzbGVlcGVyLnN0YXJ0KCk7CiAgICB9Cn0K\n","encoding":"base64"}

