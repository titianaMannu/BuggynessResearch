{"sha":"0133d10e0b4129a764632af48f5e4e0b76e219b9","node_id":"MDQ6QmxvYjE1NzU5NTY6MDEzM2QxMGUwYjQxMjlhNzY0NjMyYWY0OGY1ZTRlMGI3NmUyMTliOQ==","size":11227,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0133d10e0b4129a764632af48f5e4e0b76e219b9","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwu\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2Nr\naW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhv\ncmU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbDsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKaW1wb3J0\nIGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLkhlbHBlck1ldGhvZHM7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3Nh\nZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzLlRv\ncGljT3duZXJzaGlwQ2hhbmdlTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy51dGlsLkNhbGxiYWNrOwoKaW1wb3J0IHN0YXRpYyBvcmcuanVu\naXQuQXNzZXJ0Lio7CgpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgVGVzdFBlcnNp\nc3RlbmNlTWFuYWdlckJsYWNrQm94IHsKICAgIHByb3RlY3RlZCBQZXJzaXN0\nZW5jZU1hbmFnZXIgcGVyc2lzdGVuY2VNYW5hZ2VyOwogICAgcHJvdGVjdGVk\nIGludCBOVU1fTUVTU0FHRVNfVE9fVEVTVCA9IDU7CiAgICBwcm90ZWN0ZWQg\naW50IE5VTV9UT1BJQ1NfVE9fVEVTVCA9IDU7CiAgICBzdGF0aWMgTG9nZ2Vy\nIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFRlc3RQZXJzaXN0\nZW5jZU1hbmFnZXJCbGFja0JveC5jbGFzcyk7CiAgICBUZXN0Q2FsbGJhY2sg\ndGVzdENhbGxiYWNrID0gbmV3IFRlc3RDYWxsYmFjaygpOwoKICAgIFJ1bnRp\nbWVFeGNlcHRpb24gZmFpbHVyZUV4Y2VwdGlvbjsKCiAgICBjbGFzcyBUZXN0\nQ2FsbGJhY2sgaW1wbGVtZW50cyBDYWxsYmFjazxQdWJTdWJQcm90b2NvbC5N\nZXNzYWdlU2VxSWQ+IHsKCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9u\nRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24p\nIHsKICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24gPSBuZXcg\nUnVudGltZUV4Y2VwdGlvbihleGNlcHRpb24pKTsKICAgICAgICB9CgogICAg\nICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgICAgIHB1\nYmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFB1YlN1\nYlByb3RvY29sLk1lc3NhZ2VTZXFJZCByZXN1bHRPZk9wZXJhdGlvbikgewog\nICAgICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1\nc1F1ZXVlID0gKExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4pIGN0eDsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0YXR1c1F1ZXVl\nLnB1dCh0cnVlKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVF\neGNlcHRpb24gPSBuZXcgUnVudGltZUV4Y2VwdGlvbihlKSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgY2xhc3MgUmFuZ2VTY2FuVmVy\naWZpZXJMaXN0ZW5lciBpbXBsZW1lbnRzIFNjYW5DYWxsYmFjayB7CiAgICAg\nICAgTGlzdDxNZXNzYWdlPiBwdWJNc2dzOwoKICAgICAgICBwdWJsaWMgUmFu\nZ2VTY2FuVmVyaWZpZXJMaXN0ZW5lcihMaXN0PE1lc3NhZ2U+IHB1Yk1zZ3Mp\nIHsKICAgICAgICAgICAgdGhpcy5wdWJNc2dzID0gcHViTXNnczsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVj\ndCBjdHgsIE1lc3NhZ2UgcmVjdk1lc3NhZ2UpIHsKICAgICAgICAgICAgaWYg\nKHB1Yk1zZ3MuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAo\nZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJNZXNz\nYWdlIHJlY2VpdmVkIHdoZW4gbm9uZSBleHBlY3RlZCIpKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgTWVzc2FnZSBwdWJNc2cgPSBwdWJNc2dzLmdl\ndCgwKTsKICAgICAgICAgICAgaWYgKCFIZWxwZXJNZXRob2RzLmFyZUVxdWFs\nKHJlY3ZNZXNzYWdlLCBwdWJNc2cpKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJT\nY2FubmVkIG1lc3NhZ2Ugbm90IGVxdWFsIHRvIGV4cGVjdGVkIikpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHB1Yk1zZ3MucmVtb3ZlKDApOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2NhbkZhaWxlZChPYmplY3Qg\nY3R4LCBFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgIHRocm93\nIChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXhj\nZXB0aW9uKSk7CiAgICAgICAgfQoKICAgICAgICBAU3VwcHJlc3NXYXJuaW5n\ncygidW5jaGVja2VkIikKICAgICAgICBwdWJsaWMgdm9pZCBzY2FuRmluaXNo\nZWQoT2JqZWN0IGN0eCwgUmVhc29uRm9yRmluaXNoIHJlYXNvbikgewogICAg\nICAgICAgICBpZiAocmVhc29uICE9IFJlYXNvbkZvckZpbmlzaC5OT19NT1JF\nX01FU1NBR0VTKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAoZmFpbHVyZUV4\nY2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJTY2FuIGZpbmlzaGVk\nIHByZW1hdHVyZWx5ICIgKyByZWFzb24pKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1\nZXVlID0gKExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4pIGN0eDsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0YXR1c1F1ZXVlLnB1\ndCh0cnVlKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNl\ncHRpb24gPSBuZXcgUnVudGltZUV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgfQoKICAgIGNsYXNzIFBvaW50U2NhblZlcmlm\naWVyTGlzdGVuZXIgaW1wbGVtZW50cyBTY2FuQ2FsbGJhY2sgewogICAgICAg\nIExpc3Q8TWVzc2FnZT4gcHViTXNnczsKICAgICAgICBCeXRlU3RyaW5nIHRv\ncGljOwoKICAgICAgICBwdWJsaWMgUG9pbnRTY2FuVmVyaWZpZXJMaXN0ZW5l\ncihMaXN0PE1lc3NhZ2U+IHB1Yk1zZ3MsIEJ5dGVTdHJpbmcgdG9waWMpIHsK\nICAgICAgICAgICAgdGhpcy50b3BpYyA9IHRvcGljOwogICAgICAgICAgICB0\naGlzLnB1Yk1zZ3MgPSBwdWJNc2dzOwogICAgICAgIH0KCiAgICAgICAgQFN1\ncHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICAgICAgcHVibGljIHZv\naWQgbWVzc2FnZVNjYW5uZWQoT2JqZWN0IGN0eCwgTWVzc2FnZSByZWN2TWVz\nc2FnZSkgewoKICAgICAgICAgICAgTWVzc2FnZSBwdWJNc2cgPSBwdWJNc2dz\nLmdldCgwKTsKICAgICAgICAgICAgaWYgKCFIZWxwZXJNZXRob2RzLmFyZUVx\ndWFsKHJlY3ZNZXNzYWdlLCBwdWJNc2cpKSB7CiAgICAgICAgICAgICAgICB0\naHJvdyAoZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9u\nKCJTY2FubmVkIG1lc3NhZ2Ugbm90IGVxdWFsIHRvIGV4cGVjdGVkIikpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHB1Yk1zZ3MucmVtb3ZlKDApOwoK\nICAgICAgICAgICAgaWYgKHB1Yk1zZ3MuaXNFbXB0eSgpKSB7CiAgICAgICAg\nICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1\nZXVlID0gKExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4pIGN0eDsKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVz\nUXVldWUucHV0KHRydWUpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIHRo\ncm93IChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24o\nZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgbG9uZyBzZXFJZCA9IHJlY3ZNZXNzYWdlLmdldE1z\nZ0lkKCkuZ2V0TG9jYWxDb21wb25lbnQoKTsKICAgICAgICAgICAgICAgIHNl\ncUlkID0gcGVyc2lzdGVuY2VNYW5hZ2VyLmdldFNlcUlkQWZ0ZXJTa2lwcGlu\nZyh0b3BpYywgc2VxSWQsIDEpOwogICAgICAgICAgICAgICAgU2NhblJlcXVl\nc3QgcmVxdWVzdCA9IG5ldyBTY2FuUmVxdWVzdCh0b3BpYywgc2VxSWQsIG5l\ndyBQb2ludFNjYW5WZXJpZmllckxpc3RlbmVyKHB1Yk1zZ3MsIHRvcGljKSwg\nY3R4KTsKICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNlTWFuYWdlci5zY2Fu\nU2luZ2xlTWVzc2FnZShyZXF1ZXN0KTsKICAgICAgICAgICAgfQoKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNjYW5GYWlsZWQoT2JqZWN0IGN0\neCwgRXhjZXB0aW9uIGV4Y2VwdGlvbikgewogICAgICAgICAgICB0aHJvdyAo\nZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKGV4Y2Vw\ndGlvbikpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2NhbkZp\nbmlzaGVkKE9iamVjdCBjdHgsIFJlYXNvbkZvckZpbmlzaCByZWFzb24pIHsK\nCiAgICAgICAgfQoKICAgIH0KCiAgICBjbGFzcyBTY2FuVmVyaWZpZXIgaW1w\nbGVtZW50cyBSdW5uYWJsZSB7CiAgICAgICAgTGlzdDxNZXNzYWdlPiBwdWJN\nc2dzOwogICAgICAgIEJ5dGVTdHJpbmcgdG9waWM7CiAgICAgICAgTGlua2Vk\nQmxvY2tpbmdRdWV1ZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IG5ldyBMaW5r\nZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+KCk7CgogICAgICAgIHB1YmxpYyBT\nY2FuVmVyaWZpZXIoQnl0ZVN0cmluZyB0b3BpYywgTGlzdDxNZXNzYWdlPiBw\ndWJNc2dzKSB7CiAgICAgICAgICAgIHRoaXMudG9waWMgPSB0b3BpYzsKICAg\nICAgICAgICAgdGhpcy5wdWJNc2dzID0gcHViTXNnczsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgLy8gc3Rh\ncnQgdGhlIHNjYW4KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGlmIChwZXJzaXN0ZW5jZU1hbmFnZXIgaW5zdGFuY2VvZiBQZXJzaXN0ZW5j\nZU1hbmFnZXJXaXRoUmFuZ2VTY2FuKSB7CgogICAgICAgICAgICAgICAgICAg\nIFNjYW5DYWxsYmFjayBsaXN0ZW5lciA9IG5ldyBSYW5nZVNjYW5WZXJpZmll\nckxpc3RlbmVyKHB1Yk1zZ3MpOwoKICAgICAgICAgICAgICAgICAgICBQZXJz\naXN0ZW5jZU1hbmFnZXJXaXRoUmFuZ2VTY2FuIHJhbmdlUGVyc2lzdGVuY2VN\nYW5hZ2VyID0gKFBlcnNpc3RlbmNlTWFuYWdlcldpdGhSYW5nZVNjYW4pIHBl\ncnNpc3RlbmNlTWFuYWdlcjsKCiAgICAgICAgICAgICAgICAgICAgcmFuZ2VQ\nZXJzaXN0ZW5jZU1hbmFnZXIuc2Nhbk1lc3NhZ2VzKG5ldyBSYW5nZVNjYW5S\nZXF1ZXN0KHRvcGljLCBnZXRMb3dlc3RTZXFJZCgpLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBO\nVU1fTUVTU0FHRVNfVE9fVEVTVCArIDEsIExvbmcuTUFYX1ZBTFVFLCBsaXN0\nZW5lciwgc3RhdHVzUXVldWUpKTsKCiAgICAgICAgICAgICAgICB9IGVsc2Ug\newoKICAgICAgICAgICAgICAgICAgICBTY2FuQ2FsbGJhY2sgbGlzdGVuZXIg\nPSBuZXcgUG9pbnRTY2FuVmVyaWZpZXJMaXN0ZW5lcihwdWJNc2dzLCB0b3Bp\nYyk7CiAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVuY2VNYW5hZ2VyCiAg\nICAgICAgICAgICAgICAgICAgLnNjYW5TaW5nbGVNZXNzYWdlKG5ldyBTY2Fu\nUmVxdWVzdCh0b3BpYywgZ2V0TG93ZXN0U2VxSWQoKSwgbGlzdGVuZXIsIHN0\nYXR1c1F1ZXVlKSk7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgLy8gbm93IGxpc3RlbiBmb3IgaXQgdG8gZmluaXNoCiAgICAgICAgICAg\nICAgICAvLyB3YWl0IGEgbWF4aW11bSBvZiBhIG1pbnV0ZQogICAgICAgICAg\nICAgICAgQm9vbGVhbiBiID0gc3RhdHVzUXVldWUucG9sbCg2MCwgVGltZVVu\naXQuU0VDT05EUyk7CiAgICAgICAgICAgICAgICBpZiAoYiA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRpb24g\nPSBuZXcgUnVudGltZUV4Y2VwdGlvbigiU2Nhbm5pbmcgdGltZWQgb3V0Iikp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyAo\nZmFpbHVyZUV4Y2VwdGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKGUpKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBjbGFzcyBQdWJs\naXNoZXIgaW1wbGVtZW50cyBSdW5uYWJsZSB7CiAgICAgICAgTGlzdDxNZXNz\nYWdlPiBwdWJNc2dzOwogICAgICAgIEJ5dGVTdHJpbmcgdG9waWM7CgogICAg\nICAgIHB1YmxpYyBQdWJsaXNoZXIoQnl0ZVN0cmluZyB0b3BpYywgTGlzdDxN\nZXNzYWdlPiBwdWJNc2dzKSB7CiAgICAgICAgICAgIHRoaXMucHViTXNncyA9\nIHB1Yk1zZ3M7CiAgICAgICAgICAgIHRoaXMudG9waWMgPSB0b3BpYzsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAg\nICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9\nIG5ldyBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+KCk7CgogICAgICAg\nICAgICBmb3IgKE1lc3NhZ2UgbXNnIDogcHViTXNncykgewoKICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVuY2VN\nYW5hZ2VyLnBlcnNpc3RNZXNzYWdlKG5ldyBQZXJzaXN0UmVxdWVzdCh0b3Bp\nYywgbXNnLCB0ZXN0Q2FsbGJhY2ssIHN0YXR1c1F1ZXVlKSk7CiAgICAgICAg\nICAgICAgICAgICAgLy8gd2FpdCBhIG1heGltdW0gb2YgYSBtaW51dGUKICAg\nICAgICAgICAgICAgICAgICBCb29sZWFuIGIgPSBzdGF0dXNRdWV1ZS5wb2xs\nKDYwLCBUaW1lVW5pdC5TRUNPTkRTKTsKICAgICAgICAgICAgICAgICAgICBp\nZiAoYiA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93\nIChmYWlsdXJlRXhjZXB0aW9uID0gbmV3IFJ1bnRpbWVFeGNlcHRpb24oIlNj\nYW5uaW5nIHRpbWVkIG91dCIpKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKGZhaWx1cmVFeGNlcHRp\nb24gPSBuZXcgUnVudGltZUV4Y2VwdGlvbihlKSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbG9n\nZ2VyLmluZm8oIlNUQVJUSU5HICIgKyBnZXRDbGFzcygpKTsKICAgICAgICBw\nZXJzaXN0ZW5jZU1hbmFnZXIgPSBpbnN0YW50aWF0ZVBlcnNpc3RlbmNlTWFu\nYWdlcigpOwogICAgICAgIGZhaWx1cmVFeGNlcHRpb24gPSBudWxsOwogICAg\nICAgIGxvZ2dlci5pbmZvKCJQZXJzaXN0ZW5jZSBNYW5hZ2VyIHRlc3Qgc2V0\ndXAgZmluaXNoZWQiKTsKICAgIH0KCiAgICBhYnN0cmFjdCBsb25nIGdldExv\nd2VzdFNlcUlkKCk7CgogICAgYWJzdHJhY3QgUGVyc2lzdGVuY2VNYW5hZ2Vy\nIGluc3RhbnRpYXRlUGVyc2lzdGVuY2VNYW5hZ2VyKCkgdGhyb3dzIEV4Y2Vw\ndGlvbjsKCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIGxvZ2dlci5pbmZvKCJ0ZWFyRG93biBzdGFydGlu\nZyIpOwogICAgICAgIHBlcnNpc3RlbmNlTWFuYWdlci5zdG9wKCk7CiAgICAg\nICAgbG9nZ2VyLmluZm8oIkZJTklTSEVEICIgKyBnZXRDbGFzcygpKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgQnl0ZVN0cmluZyBnZXRUb3BpY05hbWUoaW50\nIG51bWJlcikgewogICAgICAgIHJldHVybiBCeXRlU3RyaW5nLmNvcHlGcm9t\nVXRmOCgidG9waWMiICsgbnVtYmVyKTsKICAgIH0KCiAgICBAVGVzdCh0aW1l\nb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdFBlcnNpc3RlbmNlTWFu\nYWdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExpc3Q8VGhyZWFk\nPiBwdWJsaXNoZXJUaHJlYWRzID0gbmV3IExpbmtlZExpc3Q8VGhyZWFkPigp\nOwogICAgICAgIExpc3Q8VGhyZWFkPiBzY2FubmVyVGhyZWFkcyA9IG5ldyBM\naW5rZWRMaXN0PFRocmVhZD4oKTsKICAgICAgICBUaHJlYWQgdGhyZWFkOwog\nICAgICAgIFNlbWFwaG9yZSBsYXRjaCA9IG5ldyBTZW1hcGhvcmUoMSk7Cgog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTlVNX1RPUElDU19UT19URVNU\nOyBpKyspIHsKICAgICAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IGdldFRv\ncGljTmFtZShpKTsKCiAgICAgICAgICAgIGlmIChwZXJzaXN0ZW5jZU1hbmFn\nZXIgaW5zdGFuY2VvZiBUb3BpY093bmVyc2hpcENoYW5nZUxpc3RlbmVyKSB7\nCgogICAgICAgICAgICAgICAgVG9waWNPd25lcnNoaXBDaGFuZ2VMaXN0ZW5l\nciB0b2NsID0gKFRvcGljT3duZXJzaGlwQ2hhbmdlTGlzdGVuZXIpIHBlcnNp\nc3RlbmNlTWFuYWdlcjsKCiAgICAgICAgICAgICAgICBsYXRjaC5hY3F1aXJl\nKCk7CgogICAgICAgICAgICAgICAgdG9jbC5hY3F1aXJlZFRvcGljKHRvcGlj\nLCBuZXcgQ2FsbGJhY2s8Vm9pZD4oKSB7CiAgICAgICAgICAgICAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgb3Bl\ncmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNl\ncHRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmFpbHVyZUV4Y2Vw\ndGlvbiA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKGV4Y2VwdGlvbik7CiAgICAg\nICAgICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKSBjdHgpLnJlbGVhc2Uo\nKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZvaWQgcmVzKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICgoU2VtYXBob3JlKSBjdHgpLnJlbGVhc2Uo\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBs\nYXRjaCk7CgogICAgICAgICAgICAgICAgbGF0Y2guYWNxdWlyZSgpOwogICAg\nICAgICAgICAgICAgbGF0Y2gucmVsZWFzZSgpOwogICAgICAgICAgICAgICAg\naWYgKGZhaWx1cmVFeGNlcHRpb24gIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIHRocm93IChFeGNlcHRpb24pIGZhaWx1cmVFeGNlcHRpb24uZ2V0\nQ2F1c2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgICAgICBMaXN0PE1lc3NhZ2U+IG1zZ3MgPSBIZWxwZXJNZXRob2RzLmdl\ndFJhbmRvbVB1Ymxpc2hlZE1lc3NhZ2VzKE5VTV9NRVNTQUdFU19UT19URVNU\nLCAxMDI0KTsKCiAgICAgICAgICAgIHRocmVhZCA9IG5ldyBUaHJlYWQobmV3\nIFB1Ymxpc2hlcih0b3BpYywgbXNncykpOwogICAgICAgICAgICBwdWJsaXNo\nZXJUaHJlYWRzLmFkZCh0aHJlYWQpOwogICAgICAgICAgICB0aHJlYWQuc3Rh\ncnQoKTsKCiAgICAgICAgICAgIHRocmVhZCA9IG5ldyBUaHJlYWQobmV3IFNj\nYW5WZXJpZmllcih0b3BpYywgbXNncykpOwogICAgICAgICAgICBzY2FubmVy\nVGhyZWFkcy5hZGQodGhyZWFkKTsKICAgICAgICB9CiAgICAgICAgZm9yIChU\naHJlYWQgdCA6IHB1Ymxpc2hlclRocmVhZHMpIHsKICAgICAgICAgICAgdC5q\nb2luKCk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKFRocmVhZCB0IDogc2Nh\nbm5lclRocmVhZHMpIHsKICAgICAgICAgICAgdC5zdGFydCgpOwogICAgICAg\nIH0KCiAgICAgICAgZm9yIChUaHJlYWQgdCA6IHNjYW5uZXJUaHJlYWRzKSB7\nCiAgICAgICAgICAgIHQuam9pbigpOwogICAgICAgIH0KCiAgICAgICAgYXNz\nZXJ0RXF1YWxzKG51bGwsIGZhaWx1cmVFeGNlcHRpb24pOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgTlVNX1RPUElDU19UT19URVNUOyBpKyspIHsK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHBlcnNpc3RlbmNlTWFuYWdlci5n\nZXRDdXJyZW50U2VxSWRGb3JUb3BpYyhnZXRUb3BpY05hbWUoaSkpLmdldExv\nY2FsQ29tcG9uZW50KCksCiAgICAgICAgICAgICAgICAgICAgICAgICBnZXRF\neHBlY3RlZFNlcUlkKE5VTV9NRVNTQUdFU19UT19URVNUKSk7CiAgICAgICAg\nfQoKICAgIH0KCiAgICBhYnN0cmFjdCBsb25nIGdldEV4cGVjdGVkU2VxSWQo\naW50IG51bVB1Ymxpc2hlZCk7Cgp9Cg==\n","encoding":"base64"}

