{"sha":"f185bb4ce11b6e22495afce584c2bdea0c2121f5","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjE4NWJiNGNlMTFiNmUyMjQ5NWFmY2U1ODRjMmJkZWEwYzIxMjFmNQ==","size":9209,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f185bb4ce11b6e22495afce584c2bdea0c2121f5","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuc3Vic2NyaXB0aW9uczsK\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TeW5jaHJvbm91c1F1ZXVl\nOwoKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5IZWR3aWdDbGll\nbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3Nh\nZ2VIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFw\naS5QdWJsaXNoZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQu\nYXBpLlN1YnNjcmliZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90\nb2NvbC5QdWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9u\nT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1\nYlN1YlByb3RvY29sLlN1YnNjcmliZVJlcXVlc3QuQ3JlYXRlT3JBdHRhY2g7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuSGVkd2lnSHViVGVz\ndEJhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuY29tbW9u\nLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRp\nbC5Db25jdXJyZW5jeVV0aWxzOwppbXBvcnQgb3JnLmp1bml0LkFmdGVyOwpp\nbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0\nOwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsKCmlt\ncG9ydCBzdGF0aWMgb3JnLmp1bml0LkFzc2VydC4qOwoKcHVibGljIGNsYXNz\nIFRlc3RVcGRhdGVTdWJzY3JpcHRpb25TdGF0ZSBleHRlbmRzIEhlZHdpZ0h1\nYlRlc3RCYXNlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgUkVU\nRU5USU9OX1NFQ1NfVkFMVUUgPSAxMDA7CgogICAgLy8gQ2xpZW50IHNpZGUg\ndmFyaWFibGVzCiAgICBwcm90ZWN0ZWQgSGVkd2lnQ2xpZW50IGNsaWVudDsK\nICAgIHByb3RlY3RlZCBQdWJsaXNoZXIgcHVibGlzaGVyOwogICAgcHJvdGVj\ndGVkIFN1YnNjcmliZXIgc3Vic2NyaWJlcjsKCiAgICAvLyBTeW5jaHJvbm91\nc1F1ZXVlcyB0byB2ZXJpZnkgYXN5bmMgY2FsbHMKICAgIHByaXZhdGUgZmlu\nYWwgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBxdWV1ZSA9IG5ldyBTeW5j\naHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CgogICAgLy8gVGVzdCBpbXBsZW1l\nbnRhdGlvbiBvZiBzdWJzY3JpYmVyJ3MgbWVzc2FnZSBoYW5kbGVyCiAgICBj\nbGFzcyBPcmRlckNoZWNraW5nTWVzc2FnZUhhbmRsZXIgaW1wbGVtZW50cyBN\nZXNzYWdlSGFuZGxlciB7CgogICAgICAgIEJ5dGVTdHJpbmcgdG9waWM7CiAg\nICAgICAgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQ7CiAgICAgICAgaW50IHN0\nYXJ0TXNnSWQ7CiAgICAgICAgaW50IG51bU1zZ3M7CiAgICAgICAgaW50IGVu\nZE1zZ0lkOwogICAgICAgIGJvb2xlYW4gaW5PcmRlciA9IHRydWU7CgogICAg\nICAgIE9yZGVyQ2hlY2tpbmdNZXNzYWdlSGFuZGxlcihCeXRlU3RyaW5nIHRv\ncGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaW50IHN0YXJ0TXNnSWQsIGludCBudW1N\nc2dzKSB7CiAgICAgICAgICAgIHRoaXMudG9waWMgPSB0b3BpYzsKICAgICAg\nICAgICAgdGhpcy5zdWJzY3JpYmVySWQgPSBzdWJzY3JpYmVySWQ7CiAgICAg\nICAgICAgIHRoaXMuc3RhcnRNc2dJZCA9IHN0YXJ0TXNnSWQ7CiAgICAgICAg\nICAgIHRoaXMubnVtTXNncyA9IG51bU1zZ3M7CiAgICAgICAgICAgIHRoaXMu\nZW5kTXNnSWQgPSBzdGFydE1zZ0lkICsgbnVtTXNncyAtIDE7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBkZWxp\ndmVyKEJ5dGVTdHJpbmcgdGhpc1RvcGljLCBCeXRlU3RyaW5nIHRoaXNTdWJz\nY3JpYmVySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdl\nIG1zZywgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2ssIE9iamVjdCBjb250ZXh0\nKSB7CiAgICAgICAgICAgIGlmICghdG9waWMuZXF1YWxzKHRoaXNUb3BpYykg\nfHwKICAgICAgICAgICAgICAgICFzdWJzY3JpYmVySWQuZXF1YWxzKHRoaXNT\ndWJzY3JpYmVySWQpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgLy8gY2hlY2sgb3JkZXIKICAgICAgICAg\nICAgaW50IG1zZ0lkID0gSW50ZWdlci5wYXJzZUludChtc2cuZ2V0Qm9keSgp\nLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0Rl\nYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWco\nIlJlY2VpdmVkIG1lc3NhZ2UgOiAiICsgbXNnSWQpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBpZiAoaW5PcmRlcikgewogICAgICAgICAgICAgICAg\naWYgKHN0YXJ0TXNnSWQgIT0gbXNnSWQpIHsKICAgICAgICAgICAgICAgICAg\nICBsb2dnZXIuZXJyb3IoIkV4cGVjdGVkIG1lc3NhZ2UgIiArIHN0YXJ0TXNn\nSWQgKyAiLCBidXQgcmVjZWl2ZWQgbWVzc2FnZSAiICsgbXNnSWQpOwogICAg\nICAgICAgICAgICAgICAgIGluT3JkZXIgPSBmYWxzZTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgKytzdGFydE1zZ0lk\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGNvbnRleHQsIG51bGwpOwog\nICAgICAgICAgICBpZiAobXNnSWQgPT0gZW5kTXNnSWQpIHsKICAgICAgICAg\nICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAg\nICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxv\nZ2dlci5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBsb2dnZXIuZGVidWcoIkRlbGl2ZXIgZmluaXNoZWQhIik7CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAg\nICAgQ29uY3VycmVuY3lVdGlscy5wdXQocXVldWUsIHRydWUpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLnN0YXJ0KCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIGlzSW5PcmRlcigpIHsKICAgICAgICAgICAgcmV0dXJuIGluT3JkZXI7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBUZXN0VXBkYXRlU3Vic2NyaXB0\naW9uU3RhdGUoKSB7CiAgICAgICAgc3VwZXIoMSk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIGNsYXNzIE5ld0h1YlNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5k\ncyBIdWJTZXJ2ZXJDb25maWd1cmF0aW9uIHsKCiAgICAgICAgcHVibGljIE5l\nd0h1YlNlcnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBz\nc2xTZXJ2ZXJQb3J0KSB7CiAgICAgICAgICAgIHN1cGVyKHNlcnZlclBvcnQs\nIHNzbFNlcnZlclBvcnQpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIGludCBnZXRSZXRlbnRpb25TZWNzKCkgewogICAg\nICAgICAgICByZXR1cm4gUkVURU5USU9OX1NFQ1NfVkFMVUU7CiAgICAgICAg\nfQoKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBTZXJ2ZXJD\nb25maWd1cmF0aW9uIGdldFNlcnZlckNvbmZpZ3VyYXRpb24oaW50IHNlcnZl\nclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0KSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBOZXdIdWJTZXJ2ZXJDb25maWd1cmF0aW9uKHNlcnZlclBvcnQsIHNzbFNl\ncnZlclBvcnQpOwogICAgfQoKICAgIHByb3RlY3RlZCBjbGFzcyBUZXN0Q2xp\nZW50Q29uZmlndXJhdGlvbiBleHRlbmRzIEh1YkNsaWVudENvbmZpZ3VyYXRp\nb24gewogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBib29sZWFu\nIGlzQXV0b1NlbmRDb25zdW1lTWVzc2FnZUVuYWJsZWQoKSB7CiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoKTsKICAgICAgICBj\nbGllbnQgPSBuZXcgSGVkd2lnQ2xpZW50KG5ldyBUZXN0Q2xpZW50Q29uZmln\ndXJhdGlvbigpKTsKICAgICAgICBwdWJsaXNoZXIgPSBjbGllbnQuZ2V0UHVi\nbGlzaGVyKCk7CiAgICAgICAgc3Vic2NyaWJlciA9IGNsaWVudC5nZXRTdWJz\nY3JpYmVyKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBAQWZ0ZXIKICAg\nIHB1YmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgY2xpZW50LmNsb3NlKCk7CiAgICAgICAgc3VwZXIudGVhckRvd24o\nKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGlj\nIHZvaWQgdGVzdENvbnN1bWVXaGVuVG9waWNSZWxlYXNlKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KCJUZXN0Q29uc3VtZVdoZW5Ub3BpY1JlbGVhc2Ui\nKTsKICAgICAgICBCeXRlU3RyaW5nIHN1YklkID0gQnl0ZVN0cmluZy5jb3B5\nRnJvbVV0ZjgoIm15c3ViIik7CgogICAgICAgIGludCBzdGFydE1zZ0lkID0g\nMDsKICAgICAgICBpbnQgbnVtTXNncyA9IDEwOwogICAgICAgIC8vIHN1YnNj\ncmliZXIgaW4gY2xpZW50CiAgICAgICAgU3Vic2NyaXB0aW9uT3B0aW9ucyBv\ncHRzID0gU3Vic2NyaXB0aW9uT3B0aW9ucy5uZXdCdWlsZGVyKCkKICAgICAg\nICAgICAgLnNldENyZWF0ZU9yQXR0YWNoKENyZWF0ZU9yQXR0YWNoLkNSRUFU\nRV9PUl9BVFRBQ0gpLmJ1aWxkKCk7CiAgICAgICAgc3Vic2NyaWJlci5zdWJz\nY3JpYmUodG9waWMsIHN1YklkLCBvcHRzKTsKICAgICAgICAvLyBzdGFydCBk\nZWxpdmVyeQogICAgICAgIE9yZGVyQ2hlY2tpbmdNZXNzYWdlSGFuZGxlciBv\nY20gPSBuZXcgT3JkZXJDaGVja2luZ01lc3NhZ2VIYW5kbGVyKAogICAgICAg\nICAgICAgICAgdG9waWMsIHN1YklkLCBzdGFydE1zZ0lkLCBudW1Nc2dzKTsK\nICAgICAgICBzdWJzY3JpYmVyLnN0YXJ0RGVsaXZlcnkodG9waWMsIHN1Yklk\nLCBvY20pOwogICAgICAgIGZvciAoaW50IGk9MDsgaTxudW1Nc2dzOyBpKysp\nIHsKICAgICAgICAgICAgTWVzc2FnZSBtc2cgPSBNZXNzYWdlLm5ld0J1aWxk\nZXIoKS5zZXRCb2R5KAogICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcu\nY29weUZyb21VdGY4KEludGVnZXIudG9TdHJpbmcoc3RhcnRNc2dJZCArIGkp\nKSkuYnVpbGQoKTsKICAgICAgICAgICAgcHVibGlzaGVyLnB1Ymxpc2godG9w\naWMsIG1zZyk7CiAgICAgICAgfQogICAgICAgIGxvZ2dlci5pbmZvKCJQdWJs\naXNoIGZpbmlzaGVkLiIpOwogICAgICAgIHF1ZXVlLnRha2UoKTsKICAgICAg\nICBsb2dnZXIuaW5mbygiRGVsaXZlciBmaW5pc2hlZC4iKTsKICAgICAgICAv\nLyBjaGVjayBtZXNzYWdlcyByZWNlaXZlZCBpbiBvcmRlcgogICAgICAgIGFz\nc2VydFRydWUob2NtLmlzSW5PcmRlcigpKTsKCiAgICAgICAgLy8gd2FpdCBm\nb3IgcmV0ZW50aW9uIHNlY3MKICAgICAgICBUaHJlYWQuc2xlZXAoKFJFVEVO\nVElPTl9TRUNTX1ZBTFVFICsgMikgKiAxMDAwKTsKCiAgICAgICAgc3Vic2Ny\naWJlci5zdG9wRGVsaXZlcnkodG9waWMsIHN1YklkKTsKICAgICAgICBzdWJz\nY3JpYmVyLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJJZCk7CgogICAg\nICAgIHN0YXJ0TXNnSWQgPSAyMDsKICAgICAgICAvLyByZWNvbm5lY3QgaXQg\nYWdhaW4KICAgICAgICBzdWJzY3JpYmVyLnN1YnNjcmliZSh0b3BpYywgc3Vi\nSWQsIG9wdHMpOwogICAgICAgIG9jbSA9IG5ldyBPcmRlckNoZWNraW5nTWVz\nc2FnZUhhbmRsZXIodG9waWMsIHN1YklkLCBzdGFydE1zZ0lkLCBudW1Nc2dz\nKTsKICAgICAgICBzdWJzY3JpYmVyLnN0YXJ0RGVsaXZlcnkodG9waWMsIHN1\nYklkLCBvY20pOwogICAgICAgIGZvciAoaW50IGk9MDsgaTxudW1Nc2dzOyBp\nKyspIHsKICAgICAgICAgICAgTWVzc2FnZSBtc2cgPSBNZXNzYWdlLm5ld0J1\naWxkZXIoKS5zZXRCb2R5KAogICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJp\nbmcuY29weUZyb21VdGY4KEludGVnZXIudG9TdHJpbmcoc3RhcnRNc2dJZCAr\nIGkpKSkuYnVpbGQoKTsKICAgICAgICAgICAgcHVibGlzaGVyLnB1Ymxpc2go\ndG9waWMsIG1zZyk7CiAgICAgICAgfQogICAgICAgIHF1ZXVlLnRha2UoKTsK\nICAgICAgICAvLyBjaGVjayBtZXNzYWdlcyByZWNlaXZlZCBpbiBvcmRlcgog\nICAgICAgIGFzc2VydFRydWUob2NtLmlzSW5PcmRlcigpKTsKICAgIH0KCiAg\nICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdENv\nbnN1bWVXaGVuSHViU2h1dGRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0\nZjgoIlRlc3RDb25zdW1lV2hlbkh1YlNodXRkb3duIik7CiAgICAgICAgQnl0\nZVN0cmluZyBzdWJJZCA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJteXN1\nYiIpOwoKICAgICAgICBpbnQgc3RhcnRNc2dJZCA9IDA7CiAgICAgICAgaW50\nIG51bU1zZ3MgPSAxMDsKICAgICAgICBTdWJzY3JpcHRpb25PcHRpb25zIG9w\ndHMgPSBTdWJzY3JpcHRpb25PcHRpb25zLm5ld0J1aWxkZXIoKQogICAgICAg\nICAgICAuc2V0Q3JlYXRlT3JBdHRhY2goQ3JlYXRlT3JBdHRhY2guQ1JFQVRF\nX09SX0FUVEFDSCkuYnVpbGQoKTsKICAgICAgICAvLyBzdWJzY3JpYmVyIGlu\nIGNsaWVudAogICAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKHRvcGljLCBz\ndWJJZCwgb3B0cyk7CiAgICAgICAgLy8gc3RhcnQgZGVsaXZlcnkKICAgICAg\nICBPcmRlckNoZWNraW5nTWVzc2FnZUhhbmRsZXIgb2NtID0gbmV3IE9yZGVy\nQ2hlY2tpbmdNZXNzYWdlSGFuZGxlcigKICAgICAgICAgICAgICAgIHRvcGlj\nLCBzdWJJZCwgc3RhcnRNc2dJZCwgbnVtTXNncyk7CiAgICAgICAgc3Vic2Ny\naWJlci5zdGFydERlbGl2ZXJ5KHRvcGljLCBzdWJJZCwgb2NtKTsKICAgICAg\nICBmb3IgKGludCBpPTA7IGk8bnVtTXNnczsgaSsrKSB7CiAgICAgICAgICAg\nIE1lc3NhZ2UgbXNnID0gTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keSgK\nICAgICAgICAgICAgICAgICAgICBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOChJ\nbnRlZ2VyLnRvU3RyaW5nKHN0YXJ0TXNnSWQgKyBpKSkpLmJ1aWxkKCk7CiAg\nICAgICAgICAgIHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljLCBtc2cpOwogICAg\nICAgIH0KICAgICAgICBsb2dnZXIuaW5mbygiUHVibGlzaCBmaW5pc2hlZC4i\nKTsKICAgICAgICBxdWV1ZS50YWtlKCk7CiAgICAgICAgbG9nZ2VyLmluZm8o\nIkRlbGl2ZXIgZmluaXNoZWQuIik7CiAgICAgICAgLy8gY2hlY2sgbWVzc2Fn\nZXMgcmVjZWl2ZWQgaW4gb3JkZXIKICAgICAgICBhc3NlcnRUcnVlKG9jbS5p\nc0luT3JkZXIoKSk7CiAgICAgICAgLy8gbWFrZSBzdXJlIGNvbnN1bWUgcmVx\ndWVzdCBzZW50IHRvIGh1YiBzZXJ2ZXIgYmVmb3JlIHNodXQgZG93bgogICAg\nICAgIFRocmVhZC5zbGVlcCgyMDAwKTsKICAgICAgICBzdWJzY3JpYmVyLnN0\nb3BEZWxpdmVyeSh0b3BpYywgc3ViSWQpOwogICAgICAgIHN1YnNjcmliZXIu\nY2xvc2VTdWJzY3JpcHRpb24odG9waWMsIHN1YklkKTsKCiAgICAgICAgc3Rv\ncEh1YlNlcnZlcnMoKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAg\nICAgICAgc3RhcnRIdWJTZXJ2ZXJzKCk7CgogICAgICAgIHN0YXJ0TXNnSWQg\nPSAyMDsKICAgICAgICAvLyByZWNvbm5lY3QgaXQgYWdhaW4KICAgICAgICBz\ndWJzY3JpYmVyLnN1YnNjcmliZSh0b3BpYywgc3ViSWQsIG9wdHMpOwogICAg\nICAgIG9jbSA9IG5ldyBPcmRlckNoZWNraW5nTWVzc2FnZUhhbmRsZXIodG9w\naWMsIHN1YklkLCBzdGFydE1zZ0lkLCBudW1Nc2dzKTsKICAgICAgICBzdWJz\nY3JpYmVyLnN0YXJ0RGVsaXZlcnkodG9waWMsIHN1YklkLCBvY20pOwogICAg\nICAgIGZvciAoaW50IGk9MDsgaTxudW1Nc2dzOyBpKyspIHsKICAgICAgICAg\nICAgTWVzc2FnZSBtc2cgPSBNZXNzYWdlLm5ld0J1aWxkZXIoKS5zZXRCb2R5\nKAogICAgICAgICAgICAgICAgICAgIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKEludGVnZXIudG9TdHJpbmcoc3RhcnRNc2dJZCArIGkpKSkuYnVpbGQoKTsK\nICAgICAgICAgICAgcHVibGlzaGVyLnB1Ymxpc2godG9waWMsIG1zZyk7CiAg\nICAgICAgfQogICAgICAgIHF1ZXVlLnRha2UoKTsKICAgICAgICAvLyBjaGVj\nayBtZXNzYWdlcyByZWNlaXZlZCBpbiBvcmRlcgogICAgICAgIGFzc2VydFRy\ndWUob2NtLmlzSW5PcmRlcigpKTsKICAgIH0KfQo=\n","encoding":"base64"}

