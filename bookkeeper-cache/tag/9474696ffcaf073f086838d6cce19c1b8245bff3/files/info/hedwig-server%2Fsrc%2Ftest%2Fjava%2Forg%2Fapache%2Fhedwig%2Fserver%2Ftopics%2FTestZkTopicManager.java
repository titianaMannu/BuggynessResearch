{"sha":"2f016f5f9ba8267ecc9722049878d27c22839801","node_id":"MDQ6QmxvYjE1NzU5NTY6MmYwMTZmNWY5YmE4MjY3ZWNjOTcyMjA0OTg3OGQyN2MyMjgzOTgwMQ==","size":13671,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2f016f5f9ba8267ecc9722049878d27c22839801","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIudG9waWNzOwoKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LlNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZTsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlN5bmNocm9ub3VzUXVldWU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkFzc2Vy\ndDsKaW1wb3J0IG9yZy5qdW5pdC5CZWZvcmU7CmltcG9ydCBvcmcuanVuaXQu\nVGVzdDsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMu\nUHViU3ViRXhjZXB0aW9uLkNvbXBvc2l0ZUV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkNvbmN1cnJlbmN5VXRp\nbHM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy51dGlsLkVpdGhlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuSGVkd2lnU29ja2V0QWRkcmVz\nczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuUGFpcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnpvb2tlZXBlci5ab29LZWVwZXJUZXN0QmFz\nZTsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKCnB1YmxpYyBjbGFzcyBUZXN0WmtUb3BpY01hbmFn\nZXIgZXh0ZW5kcyBab29LZWVwZXJUZXN0QmFzZSB7CgogICAgc3RhdGljIExv\nZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihUZXN0WmtUb3Bp\nY01hbmFnZXIuY2xhc3MpOwoKICAgIHByb3RlY3RlZCBaa1RvcGljTWFuYWdl\nciB0bTsKCiAgICBwcm90ZWN0ZWQgY2xhc3MgQ2FsbGJhY2tRdWV1ZTxUPiBp\nbXBsZW1lbnRzIENhbGxiYWNrPFQ+IHsKICAgICAgICBTeW5jaHJvbm91c1F1\nZXVlPEVpdGhlcjxULCBFeGNlcHRpb24+PiBxID0gbmV3IFN5bmNocm9ub3Vz\nUXVldWU8RWl0aGVyPFQsIEV4Y2VwdGlvbj4+KCk7CgogICAgICAgIHB1Ymxp\nYyBTeW5jaHJvbm91c1F1ZXVlPEVpdGhlcjxULCBFeGNlcHRpb24+PiBnZXRR\ndWV1ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHE7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgRWl0aGVyPFQsIEV4Y2VwdGlvbj4gdGFrZSgpIHRocm93\ncyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBx\nLnRha2UoKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBmaW5h\nbCBQdWJTdWJFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgIExP\nRy5lcnJvcigiZ290IGV4Y2VwdGlvbjogIiArIGV4Y2VwdGlvbik7CiAgICAg\nICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBy\ndW4oKSB7CiAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5w\ndXQocSwgRWl0aGVyLm9mKChUKSBudWxsLCAoRXhjZXB0aW9uKSBleGNlcHRp\nb24pKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuc3RhcnQo\nKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIGZpbmFsIFQg\ncmVzdWx0T2ZPcGVyYXRpb24pIHsKICAgICAgICAgICAgbmV3IFRocmVhZChu\nZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAg\nICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChxLCBFaXRoZXIub2YocmVz\ndWx0T2ZPcGVyYXRpb24sIChFeGNlcHRpb24pIG51bGwpKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSkuc3RhcnQoKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJvdGVjdGVkIENhbGxiYWNrUXVldWU8SGVkd2lnU29ja2V0\nQWRkcmVzcz4gYWRkckNicSA9IG5ldyBDYWxsYmFja1F1ZXVlPEhlZHdpZ1Nv\nY2tldEFkZHJlc3M+KCk7CiAgICBwcm90ZWN0ZWQgQ2FsbGJhY2tRdWV1ZTxC\neXRlU3RyaW5nPiBic0NicSA9IG5ldyBDYWxsYmFja1F1ZXVlPEJ5dGVTdHJp\nbmc+KCk7CiAgICBwcm90ZWN0ZWQgQ2FsbGJhY2tRdWV1ZTxWb2lkPiB2b2lk\nQ2JxID0gbmV3IENhbGxiYWNrUXVldWU8Vm9pZD4oKTsKCiAgICBwcm90ZWN0\nZWQgQnl0ZVN0cmluZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKCJ0b3BpYyIpOwogICAgcHJvdGVjdGVkIFNlcnZlckNvbmZpZ3VyYXRpb24g\nY2ZnOwogICAgcHJvdGVjdGVkIEhlZHdpZ1NvY2tldEFkZHJlc3MgbWU7CiAg\nICBwcm90ZWN0ZWQgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNjaGVkdWxl\ncjsKCiAgICBwcml2YXRlIHZvbGF0aWxlIGludCBERUZBVUxUX01BWF9OVU1f\nVE9QSUNTID0gSW50ZWdlci5NQVhfVkFMVUU7CiAgICBwcml2YXRlIHZvbGF0\naWxlIGludCBERUZBVUxUX1JFVEVOVElPTl9TRUNTX0FGVEVSX0FDQ0VTUyA9\nIDA7CgogICAgQE92ZXJyaWRlCiAgICBAQmVmb3JlCiAgICBwdWJsaWMgdm9p\nZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNl\ndFVwKCk7CiAgICAgICAgY2ZnID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24o\nKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMg\naW50IGdldFJldGVudGlvblNlY3NBZnRlckFjY2VzcygpIHsKICAgICAgICAg\nICAgICAgIHJldHVybiBERUZBVUxUX1JFVEVOVElPTl9TRUNTX0FGVEVSX0FD\nQ0VTUzsKICAgICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgcHVibGljIGludCBnZXRNYXhOdW1Ub3BpY3MoKSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gREVGQVVMVF9NQVhfTlVNX1RPUElDUzsKICAg\nICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgbWUgPSBjZmcuZ2V0U2Vy\ndmVyQWRkcigpOwogICAgICAgIHNjaGVkdWxlciA9IEV4ZWN1dG9ycy5uZXdT\naW5nbGVUaHJlYWRTY2hlZHVsZWRFeGVjdXRvcigpOwogICAgICAgIHRtID0g\nbmV3IFprVG9waWNNYW5hZ2VyKHprLCBjZmcsIHNjaGVkdWxlcik7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBAQWZ0ZXIKICAgIHB1YmxpYyB2b2lkIHRl\nYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdG0uc3RvcCgp\nOwogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICB9CgogICAgQFRlc3Qo\ndGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RHZXRPd25lclNp\nbmdsZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRtLmdldE93bmVy\nKHRvcGljLCBmYWxzZSwgYWRkckNicSwgbnVsbCk7CiAgICAgICAgQXNzZXJ0\nLmFzc2VydEVxdWFscyhtZSwgY2hlY2soYWRkckNicS50YWtlKCkpKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgQnl0ZVN0cmluZyBta1RvcGljKGludCBpKSB7\nCiAgICAgICAgcmV0dXJuIEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KHRvcGlj\nLnRvU3RyaW5nVXRmOCgpICsgaSk7CiAgICB9CgogICAgcHJvdGVjdGVkIDxU\nPiBUIGNoZWNrKEVpdGhlcjxULCBFeGNlcHRpb24+IGV4KSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoZXgubGVmdCgpID09IG51bGwpCiAgICAg\nICAgICAgIHRocm93IGV4LnJpZ2h0KCk7CiAgICAgICAgZWxzZQogICAgICAg\nICAgICByZXR1cm4gZXgubGVmdCgpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0\naWMgY2xhc3MgQ3VzdG9tU2VydmVyQ29uZmlndXJhdGlvbiBleHRlbmRzIFNl\ncnZlckNvbmZpZ3VyYXRpb24gewogICAgICAgIGludCBwb3J0OwoKICAgICAg\nICBwdWJsaWMgQ3VzdG9tU2VydmVyQ29uZmlndXJhdGlvbihpbnQgcG9ydCkg\newogICAgICAgICAgICB0aGlzLnBvcnQgPSBwb3J0OwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBnZXRTZXJ2ZXJQ\nb3J0KCkgewogICAgICAgICAgICByZXR1cm4gcG9ydDsKICAgICAgICB9CiAg\nICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RHZXRPd25lck11bHRpKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgU2VydmVyQ29uZmlndXJhdGlvbiBjZmcxID0gbmV3IEN1c3RvbVNlcnZl\nckNvbmZpZ3VyYXRpb24oY2ZnLmdldFNlcnZlclBvcnQoKSArIDEpLCBjZmcy\nID0gbmV3IEN1c3RvbVNlcnZlckNvbmZpZ3VyYXRpb24oCiAgICAgICAgICAg\nIGNmZy5nZXRTZXJ2ZXJQb3J0KCkgKyAyKTsKICAgICAgICAvLyBUT0RPIGNo\nYW5nZSBjZmcxIGNmZzIgcGFyYW1zCiAgICAgICAgWmtUb3BpY01hbmFnZXIg\ndG0xID0gbmV3IFprVG9waWNNYW5hZ2VyKHprLCBjZmcxLCBzY2hlZHVsZXIp\nLAogICAgICAgICAgICAgICAgICAgICAgIHRtMiA9IG5ldyBaa1RvcGljTWFu\nYWdlcih6aywgY2ZnMiwgc2NoZWR1bGVyKTsKCiAgICAgICAgdG0uZ2V0T3du\nZXIodG9waWMsIGZhbHNlLCBhZGRyQ2JxLCBudWxsKTsKICAgICAgICBIZWR3\naWdTb2NrZXRBZGRyZXNzIG93bmVyID0gY2hlY2soYWRkckNicS50YWtlKCkp\nOwoKICAgICAgICAvLyBJZiB3ZSB3ZXJlIHRvbGQgdG8gaGF2ZSBhbm90aGVy\nIHBlcnNvbiBjbGFpbSB0aGUgdG9waWMsIG1ha2UgdGhlbQogICAgICAgIC8v\nIGNsYWltIHRoZSB0b3BpYy4KICAgICAgICBpZiAob3duZXIuZ2V0UG9ydCgp\nID09IGNmZzEuZ2V0U2VydmVyUG9ydCgpKQogICAgICAgICAgICB0bTEuZ2V0\nT3duZXIodG9waWMsIHRydWUsIGFkZHJDYnEsIG51bGwpOwogICAgICAgIGVs\nc2UgaWYgKG93bmVyLmdldFBvcnQoKSA9PSBjZmcyLmdldFNlcnZlclBvcnQo\nKSkKICAgICAgICAgICAgdG0yLmdldE93bmVyKHRvcGljLCB0cnVlLCBhZGRy\nQ2JxLCBudWxsKTsKICAgICAgICBpZiAob3duZXIuZ2V0UG9ydCgpICE9IGNm\nZy5nZXRTZXJ2ZXJQb3J0KCkpCiAgICAgICAgICAgIEFzc2VydC5hc3NlcnRF\ncXVhbHMob3duZXIsIGNoZWNrKGFkZHJDYnEudGFrZSgpKSk7CgogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgMTAwOyArK2kpIHsKICAgICAgICAgICAg\ndG0uZ2V0T3duZXIodG9waWMsIGZhbHNlLCBhZGRyQ2JxLCBudWxsKTsKICAg\nICAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhvd25lciwgY2hlY2soYWRk\nckNicS50YWtlKCkpKTsKCiAgICAgICAgICAgIHRtMS5nZXRPd25lcih0b3Bp\nYywgZmFsc2UsIGFkZHJDYnEsIG51bGwpOwogICAgICAgICAgICBBc3NlcnQu\nYXNzZXJ0RXF1YWxzKG93bmVyLCBjaGVjayhhZGRyQ2JxLnRha2UoKSkpOwoK\nICAgICAgICAgICAgdG0yLmdldE93bmVyKHRvcGljLCBmYWxzZSwgYWRkckNi\ncSwgbnVsbCk7CiAgICAgICAgICAgIEFzc2VydC5hc3NlcnRFcXVhbHMob3du\nZXIsIGNoZWNrKGFkZHJDYnEudGFrZSgpKSk7CiAgICAgICAgfQoKICAgICAg\nICAvLyBHaXZlIHVzIDEwMCBjaGFuY2VzIHRvIGNob29zZSBhbm90aGVyIG93\nbmVyIGlmIG5vdCBzaG91bGRDbGFpbS4KICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IDEwMDsgKytpKSB7CiAgICAgICAgICAgIGlmICghb3duZXIuZXF1\nYWxzKG1lKSkKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB0\nbS5nZXRPd25lcihta1RvcGljKGkpLCBmYWxzZSwgYWRkckNicSwgbnVsbCk7\nCiAgICAgICAgICAgIG93bmVyID0gY2hlY2soYWRkckNicS50YWtlKCkpOwog\nICAgICAgICAgICBpZiAoaSA9PSA5OSkKICAgICAgICAgICAgICAgIEFzc2Vy\ndC5mYWlsKCJOZXZlciBjaG9zZSBhbm90aGVyIG93bmVyIik7CiAgICAgICAg\nfQoKICAgICAgICAvLyBNYWtlIHN1cmUgd2UgYWx3YXlzIGNob29zZSBvdXJz\nZWx2ZXMgaWYgc2hvdWxkQ2xhaW0uCiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCAxMDA7ICsraSkgewogICAgICAgICAgICB0bS5nZXRPd25lcihta1Rv\ncGljKDEwMCksIHRydWUsIGFkZHJDYnEsIG51bGwpOwogICAgICAgICAgICBB\nc3NlcnQuYXNzZXJ0RXF1YWxzKG1lLCBjaGVjayhhZGRyQ2JxLnRha2UoKSkp\nOwogICAgICAgIH0KCiAgICAgICAgdG0xLnN0b3AoKTsKICAgICAgICB0bTIu\nc3RvcCgpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0TG9hZEJhbGFuY2luZygpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIHRtLmdldE93bmVyKHRvcGljLCBmYWxzZSwgYWRkckNi\ncSwgbnVsbCk7CgogICAgICAgIEFzc2VydC5hc3NlcnRFcXVhbHMobWUsIGNo\nZWNrKGFkZHJDYnEudGFrZSgpKSk7CgogICAgICAgIFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY2ZnMSA9IG5ldyBDdXN0b21TZXJ2ZXJDb25maWd1cmF0aW9uKGNm\nZy5nZXRTZXJ2ZXJQb3J0KCkgKyAxKTsKICAgICAgICBUb3BpY01hbmFnZXIg\ndG0xID0gbmV3IFprVG9waWNNYW5hZ2VyKHprLCBjZmcxLCBzY2hlZHVsZXIp\nOwoKICAgICAgICBCeXRlU3RyaW5nIHRvcGljMSA9IG1rVG9waWMoMSk7CiAg\nICAgICAgdG0uZ2V0T3duZXIodG9waWMxLCBmYWxzZSwgYWRkckNicSwgbnVs\nbCk7CiAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhjZmcxLmdldFNlcnZl\nckFkZHIoKSwgY2hlY2soYWRkckNicS50YWtlKCkpKTsKCiAgICAgICAgdG0x\nLnN0b3AoKTsKICAgIH0KCiAgICBjbGFzcyBTdHViT3duZXJzaGlwQ2hhbmdl\nTGlzdGVuZXIgaW1wbGVtZW50cyBUb3BpY093bmVyc2hpcENoYW5nZUxpc3Rl\nbmVyIHsKICAgICAgICBib29sZWFuIGZhaWx1cmU7CiAgICAgICAgU3luY2hy\nb25vdXNRdWV1ZTxQYWlyPEJ5dGVTdHJpbmcsIEJvb2xlYW4+PiBic1F1ZXVl\nOwoKICAgICAgICBwdWJsaWMgU3R1Yk93bmVyc2hpcENoYW5nZUxpc3RlbmVy\nKFN5bmNocm9ub3VzUXVldWU8UGFpcjxCeXRlU3RyaW5nLCBCb29sZWFuPj4g\nYnNRdWV1ZSkgewogICAgICAgICAgICB0aGlzLmJzUXVldWUgPSBic1F1ZXVl\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0RmFpbHVyZShi\nb29sZWFuIGZhaWx1cmUpIHsKICAgICAgICAgICAgdGhpcy5mYWlsdXJlID0g\nZmFpbHVyZTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyB2b2lkIGxvc3RUb3BpYyhmaW5hbCBCeXRlU3RyaW5nIHRvcGlj\nKSB7CiAgICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewog\nICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJs\naWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVu\nY3lVdGlscy5wdXQoYnNRdWV1ZSwgUGFpci5vZih0b3BpYywgZmFsc2UpKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuc3RhcnQoKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGFjcXVpcmVkVG9waWMoZmlu\nYWwgQnl0ZVN0cmluZyB0b3BpYywgZmluYWwgQ2FsbGJhY2s8Vm9pZD4gY2Fs\nbGJhY2ssIGZpbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgbmV3IFRo\ncmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAg\nICAgICAgICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChic1F1ZXVlLCBQ\nYWlyLm9mKHRvcGljLCB0cnVlKSk7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGZhaWx1cmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2su\nb3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFB1YlN1YkV4Y2VwdGlvbi5TZXJ2\naWNlRG93bkV4Y2VwdGlvbigiQXNrZWQgdG8gZmFpbCIpKTsKICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBj\nYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjdHgsIG51bGwpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfSkuc3RhcnQoKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QodGltZW91\ndD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RPd25lcnNoaXBDaGFuZ2Uo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTeW5jaHJvbm91c1F1ZXVl\nPFBhaXI8Qnl0ZVN0cmluZywgQm9vbGVhbj4+IGJzUXVldWUgPSBuZXcgU3lu\nY2hyb25vdXNRdWV1ZTxQYWlyPEJ5dGVTdHJpbmcsIEJvb2xlYW4+PigpOwoK\nICAgICAgICBTdHViT3duZXJzaGlwQ2hhbmdlTGlzdGVuZXIgbGlzdGVuZXIg\nPSBuZXcgU3R1Yk93bmVyc2hpcENoYW5nZUxpc3RlbmVyKGJzUXVldWUpOwoK\nICAgICAgICB0bS5hZGRUb3BpY093bmVyc2hpcENoYW5nZUxpc3RlbmVyKGxp\nc3RlbmVyKTsKCiAgICAgICAgLy8gcmVndWxhciBhY3F1aXJlCiAgICAgICAg\ndG0uZ2V0T3duZXIodG9waWMsIHRydWUsIGFkZHJDYnEsIG51bGwpOwogICAg\nICAgIFBhaXI8Qnl0ZVN0cmluZywgQm9vbGVhbj4gcGFpciA9IGJzUXVldWUu\ndGFrZSgpOwogICAgICAgIEFzc2VydC5hc3NlcnRFcXVhbHModG9waWMsIHBh\naXIuZmlyc3QoKSk7CiAgICAgICAgQXNzZXJ0LmFzc2VydFRydWUocGFpci5z\nZWNvbmQoKSk7CiAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhtZSwgY2hl\nY2soYWRkckNicS50YWtlKCkpKTsKICAgICAgICBhc3NlcnRPd25lcnNoaXBO\nb2RlRXhpc3RzKCk7CgogICAgICAgIC8vIHRvcGljIHRoYXQgSSBhbHJlYWR5\nIG93bgogICAgICAgIHRtLmdldE93bmVyKHRvcGljLCB0cnVlLCBhZGRyQ2Jx\nLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKG1lLCBjaGVj\nayhhZGRyQ2JxLnRha2UoKSkpOwogICAgICAgIEFzc2VydC5hc3NlcnRUcnVl\nKGJzUXVldWUuaXNFbXB0eSgpKTsKICAgICAgICBhc3NlcnRPd25lcnNoaXBO\nb2RlRXhpc3RzKCk7CgogICAgICAgIC8vIHJlZ3VsYXIgcmVsZWFzZQogICAg\nICAgIHRtLnJlbGVhc2VUb3BpYyh0b3BpYywgY2IsIG51bGwpOwogICAgICAg\nIHBhaXIgPSBic1F1ZXVlLnRha2UoKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0\nRXF1YWxzKHRvcGljLCBwYWlyLmZpcnN0KCkpOwogICAgICAgIEFzc2VydC5h\nc3NlcnRGYWxzZShwYWlyLnNlY29uZCgpKTsKICAgICAgICBBc3NlcnQuYXNz\nZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIGFzc2VydE93bmVyc2hp\ncE5vZGVEb2VzbnRFeGlzdCgpOwoKICAgICAgICAvLyByZWxlYXNpbmcgdG9w\naWMgdGhhdCBJIGRvbid0IG93bgogICAgICAgIHRtLnJlbGVhc2VUb3BpYyht\na1RvcGljKDApLCBjYiwgbnVsbCk7CiAgICAgICAgQXNzZXJ0LmFzc2VydFRy\ndWUocXVldWUudGFrZSgpKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0VHJ1ZShi\nc1F1ZXVlLmlzRW1wdHkoKSk7CgogICAgICAgIC8vIHNldCBsaXN0ZW5lciB0\nbyByZXR1cm4gZXJyb3IKICAgICAgICBsaXN0ZW5lci5zZXRGYWlsdXJlKHRy\ndWUpOwoKICAgICAgICB0bS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNi\ncSwgbnVsbCk7CiAgICAgICAgcGFpciA9IGJzUXVldWUudGFrZSgpOwogICAg\nICAgIEFzc2VydC5hc3NlcnRFcXVhbHModG9waWMsIHBhaXIuZmlyc3QoKSk7\nCiAgICAgICAgQXNzZXJ0LmFzc2VydFRydWUocGFpci5zZWNvbmQoKSk7CiAg\nICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhQdWJTdWJFeGNlcHRpb24uU2Vy\ndmljZURvd25FeGNlcHRpb24uY2xhc3MsICgoQ29tcG9zaXRlRXhjZXB0aW9u\nKSBhZGRyQ2JxLnRha2UoKS5yaWdodCgpKQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLmdldEV4Y2VwdGlvbnMoKS5pdGVyYXRvcigpLm5leHQoKS5n\nZXRDbGFzcygpKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RmFsc2UobnVsbCAh\nPSB0bS50b3BpY3MuZ2V0SWZQcmVzZW50KHRvcGljKSk7CiAgICAgICAgVGhy\nZWFkLnNsZWVwKDEwMCk7CiAgICAgICAgYXNzZXJ0T3duZXJzaGlwTm9kZURv\nZXNudEV4aXN0KCk7CgogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFzc2VydE93\nbmVyc2hpcE5vZGVFeGlzdHMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBieXRlW10gZGF0YSA9IHprLmdldERhdGEodG0uaHViUGF0aCh0b3BpYyks\nIGZhbHNlLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKEh1\nYkluZm8ucGFyc2UobmV3IFN0cmluZyhkYXRhKSkuZ2V0QWRkcmVzcygpLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgdG0uYWRkcik7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgYXNzZXJ0T3duZXJzaGlwTm9kZURvZXNudEV4aXN0\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgemsuZ2V0RGF0YSh0bS5odWJQYXRoKHRvcGljKSwgZmFsc2UsIG51bGwp\nOwogICAgICAgICAgICBBc3NlcnQuYXNzZXJ0VHJ1ZShmYWxzZSk7CiAgICAg\nICAgfSBjYXRjaCAoS2VlcGVyRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nQXNzZXJ0LmFzc2VydEVxdWFscyhlLmNvZGUoKSwgS2VlcGVyRXhjZXB0aW9u\nLkNvZGUuTk9OT0RFKTsKICAgICAgICB9CiAgICB9CgogICAgQFRlc3QodGlt\nZW91dD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RaS0NsaWVudERpc2Nv\nbm5lY3RlZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIEZpcnN0\nIGFzc2VydCBvd25lcnNoaXAgb2YgdGhlIHRvcGljCiAgICAgICAgdG0uZ2V0\nT3duZXIodG9waWMsIHRydWUsIGFkZHJDYnEsIG51bGwpOwogICAgICAgIEFz\nc2VydC5hc3NlcnRFcXVhbHMobWUsIGNoZWNrKGFkZHJDYnEudGFrZSgpKSk7\nCgogICAgICAgIC8vIFN1c3BlbmQgdGhlIFpLVG9waWNNYW5hZ2VyIGFuZCBt\nYWtlIHN1cmUgY2FsbHMgdG8gZ2V0T3duZXIgZXJyb3Igb3V0CiAgICAgICAg\ndG0uaXNTdXNwZW5kZWQgPSB0cnVlOwogICAgICAgIHRtLmdldE93bmVyKHRv\ncGljLCB0cnVlLCBhZGRyQ2JxLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNz\nZXJ0RXF1YWxzKFB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNlRG93bkV4Y2VwdGlv\nbi5jbGFzcywgYWRkckNicS50YWtlKCkucmlnaHQoKS5nZXRDbGFzcygpKTsK\nICAgICAgICAvLyBSZWxlYXNlIHRoZSB0b3BpYy4gVGhpcyBzaG91bGQgbm90\nIGVycm9yIG91dCBldmVuIGlmIHN1c3BlbmRlZC4KICAgICAgICB0bS5yZWxl\nYXNlVG9waWModG9waWMsIGNiLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNz\nZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgIGFzc2VydE93bmVyc2hp\ncE5vZGVEb2VzbnRFeGlzdCgpOwoKICAgICAgICAvLyBSZXN0YXJ0IHRoZSBa\nS1RvcGljTWFuYWdlciBhbmQgbWFrZSBzdXJlIGNhbGxzIHRvIGdldE93bmVy\nIGFyZSBva2F5CiAgICAgICAgdG0uaXNTdXNwZW5kZWQgPSBmYWxzZTsKICAg\nICAgICB0bS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNicSwgbnVsbCk7\nCiAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhtZSwgY2hlY2soYWRkckNi\ncS50YWtlKCkpKTsKICAgICAgICBhc3NlcnRPd25lcnNoaXBOb2RlRXhpc3Rz\nKCk7CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RSZXRlbnRpb25BZnRlckFjY2VzcygpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIERFRkFVTFRfUkVURU5USU9OX1NFQ1NfQUZURVJf\nQUNDRVNTID0gNTsKICAgICAgICBaa1RvcGljTWFuYWdlciB0bTEgPSBuZXcg\nWmtUb3BpY01hbmFnZXIoemssIGNmZywgc2NoZWR1bGVyKTsKICAgICAgICB0\nbTEuZ2V0T3duZXIodG9waWMsIHRydWUsIGFkZHJDYnEsIG51bGwpOwogICAg\nICAgIEFzc2VydC5hc3NlcnRFcXVhbHMobWUsIGNoZWNrKGFkZHJDYnEudGFr\nZSgpKSk7CiAgICAgICAgVGhyZWFkLnNsZWVwKDYwMDBMKTsKICAgICAgICB0\nbTEudG9waWNzLmNsZWFuVXAoKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMjAw\nMEwpOwogICAgICAgIGFzc2VydE93bmVyc2hpcE5vZGVEb2VzbnRFeGlzdCgp\nOwogICAgICAgIHRtMS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNicSwg\nbnVsbCk7CiAgICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhtZSwgY2hlY2so\nYWRkckNicS50YWtlKCkpKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMEwp\nOwogICAgICAgIHRtMS50b3BpY3MuY2xlYW5VcCgpOwogICAgICAgIFRocmVh\nZC5zbGVlcCgyMDAwTCk7CiAgICAgICAgYXNzZXJ0T3duZXJzaGlwTm9kZUV4\naXN0cygpOwoKICAgICAgICB0bTEuc3RvcCgpOwogICAgfQoKICAgIEBUZXN0\nKHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWF4TnVtVG9w\naWNzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgREVGQVVMVF9NQVhf\nTlVNX1RPUElDUyA9IDE7CiAgICAgICAgVG9waWNNYW5hZ2VyIHRtMSA9IG5l\ndyBaa1RvcGljTWFuYWdlcih6aywgY2ZnLCBzY2hlZHVsZXIpOwogICAgICAg\nIHRtMS5nZXRPd25lcih0b3BpYywgdHJ1ZSwgYWRkckNicSwgbnVsbCk7CiAg\nICAgICAgQXNzZXJ0LmFzc2VydEVxdWFscyhtZSwgY2hlY2soYWRkckNicS50\nYWtlKCkpKTsKICAgICAgICBhc3NlcnRPd25lcnNoaXBOb2RlRXhpc3RzKCk7\nCiAgICAgICAgdG0xLmdldE93bmVyKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKCJNYXhOdW1Ub3BpYyIpLAogICAgICAgICAgICAgICAgICAgICB0cnVlLCBh\nZGRyQ2JxLCBudWxsKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKG1l\nLCBjaGVjayhhZGRyQ2JxLnRha2UoKSkpOwogICAgICAgIFRocmVhZC5zbGVl\ncCgyMDAwTCk7CiAgICAgICAgYXNzZXJ0T3duZXJzaGlwTm9kZURvZXNudEV4\naXN0KCk7CiAgICAgICAgdG0xLnN0b3AoKTsKICAgIH0KCn0K\n","encoding":"base64"}

