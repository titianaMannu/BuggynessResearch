{"sha":"a08f84a294e13919fae280056869f279dce3c08d","node_id":"MDQ6QmxvYjE1NzU5NTY6YTA4Zjg0YTI5NGUxMzkxOWZhZTI4MDA1Njg2OWYyNzlkY2UzYzA4ZA==","size":17417,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a08f84a294e13919fae280056869f279dce3c08d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0\naGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z\nIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICov\nCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJlbmNobWFyazsKCmlt\ncG9ydCBqYXZhLmlvLkJ1ZmZlcmVkT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2\nYS5pby5GaWxlT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuaW8uT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2\nYS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwu\nUmFuZG9tOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3du\nTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhvcmU7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5BdG9taWNMb25nOwppbXBv\ncnQgamF2YS51dGlsLlRpbWVyOwppbXBvcnQgamF2YS51dGlsLlRpbWVyVGFz\nazsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5C\nb29rS2VlcGVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVu\ndC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNsaS5Db21tYW5kTGluZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jbGkuQ29tbWFuZExpbmVQYXJzZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLkhlbHBGb3JtYXR0ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLk9wdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLlBhcnNlRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5jb21tb25zLmNsaS5Qb3NpeFBhcnNlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVkRXZlbnQ7CmltcG9ydCBvcmcuYXBh\nY2hlLnpvb2tlZXBlci5XYXRjaGVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29r\nZWVwZXIuWm9vRGVmczsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpv\nb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldhdGNoZXIu\nRXZlbnQuRXZlbnRUeXBlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nV2F0Y2hlci5FdmVudC5LZWVwZXJTdGF0ZTsKaW1wb3J0IG9yZy5zbGY0ai5M\nb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCnB1Ymxp\nYyBjbGFzcyBCZW5jaFRocm91Z2hwdXRMYXRlbmN5IGltcGxlbWVudHMgQWRk\nQ2FsbGJhY2ssIFJ1bm5hYmxlIHsKICAgIHN0YXRpYyBMb2dnZXIgTE9HID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoQmVuY2hUaHJvdWdocHV0TGF0ZW5j\neS5jbGFzcyk7CgogICAgQm9va0tlZXBlciBiazsKICAgIExlZGdlckhhbmRs\nZSBsaFtdOwogICAgQXRvbWljTG9uZyBjb3VudGVyOwoKICAgIFNlbWFwaG9y\nZSBzZW07CiAgICBpbnQgbnVtYmVyT2ZMZWRnZXJzID0gMTsKICAgIGZpbmFs\nIGludCBzZW5kTGltaXQ7CiAgICBmaW5hbCBsb25nIGxhdGVuY2llc1tdOwoK\nICAgIHN0YXRpYyBjbGFzcyBDb250ZXh0IHsKICAgICAgICBsb25nIGxvY2Fs\nU3RhcnRUaW1lOwogICAgICAgIGxvbmcgaWQ7CgogICAgICAgIENvbnRleHQo\nbG9uZyBpZCwgbG9uZyB0aW1lKXsKICAgICAgICAgICAgdGhpcy5pZCA9IGlk\nOwogICAgICAgICAgICB0aGlzLmxvY2FsU3RhcnRUaW1lID0gdGltZTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIEJlbmNoVGhyb3VnaHB1dExhdGVu\nY3koaW50IGVuc2VtYmxlLCBpbnQgd3JpdGVRdW9ydW1TaXplLCBpbnQgYWNr\nUXVvcnVtU2l6ZSwgYnl0ZVtdIHBhc3N3ZCwKICAgICAgICAgICAgaW50IG51\nbWJlck9mTGVkZ2VycywgaW50IHNlbmRMaW1pdCwgQ2xpZW50Q29uZmlndXJh\ndGlvbiBjb25mKQogICAgICAgICAgICB0aHJvd3MgS2VlcGVyRXhjZXB0aW9u\nLCBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAg\nIHRoaXMuc2VtID0gbmV3IFNlbWFwaG9yZShjb25mLmdldFRocm90dGxlVmFs\ndWUoKSk7CiAgICAgICAgYmsgPSBuZXcgQm9va0tlZXBlcihjb25mKTsKICAg\nICAgICB0aGlzLmNvdW50ZXIgPSBuZXcgQXRvbWljTG9uZygwKTsKICAgICAg\nICB0aGlzLm51bWJlck9mTGVkZ2VycyA9IG51bWJlck9mTGVkZ2VyczsKICAg\nICAgICB0aGlzLnNlbmRMaW1pdCA9IHNlbmRMaW1pdDsKICAgICAgICB0aGlz\nLmxhdGVuY2llcyA9IG5ldyBsb25nW3NlbmRMaW1pdF07CiAgICAgICAgdHJ5\newogICAgICAgICAgICBsaCA9IG5ldyBMZWRnZXJIYW5kbGVbdGhpcy5udW1i\nZXJPZkxlZGdlcnNdOwoKICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8\nIHRoaXMubnVtYmVyT2ZMZWRnZXJzOyBpKyspIHsKICAgICAgICAgICAgICAg\nIGxoW2ldID0gYmsuY3JlYXRlTGVkZ2VyKGVuc2VtYmxlLCB3cml0ZVF1b3J1\nbVNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBhY2tRdW9ydW1TaXplLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dkKTsK\nICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiTGVkZ2VyIEhhbmRsZTogIiAr\nIGxoW2ldLmdldElkKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRj\naCAoQktFeGNlcHRpb24gZSkgewogICAgICAgICAgICBlLnByaW50U3RhY2tU\ncmFjZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBSYW5kb20gcmFuZCA9IG5l\ndyBSYW5kb20oKTsKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIElu\ndGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgZm9y\nKGludCBpID0gMDsgaSA8IG51bWJlck9mTGVkZ2VyczsgaSsrKSB7CiAgICAg\nICAgICAgIGxoW2ldLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGJrLmNs\nb3NlKCk7CiAgICB9CgogICAgbG9uZyBwcmV2aW91cyA9IDA7CiAgICBieXRl\nIGJ5dGVzW107CgogICAgdm9pZCBzZXRFbnRyeURhdGEoYnl0ZSBkYXRhW10p\nIHsKICAgICAgICBieXRlcyA9IGRhdGE7CiAgICB9CgogICAgaW50IGxhc3RM\nZWRnZXIgPSAwOwogICAgcHJpdmF0ZSBpbnQgZ2V0UmFuZG9tTGVkZ2VyKCkg\newogICAgICAgICByZXR1cm4gcmFuZC5uZXh0SW50KG51bWJlck9mTGVkZ2Vy\ncyk7CiAgICB9CgogICAgaW50IGxhdGVuY3lJbmRleCA9IC0xOwogICAgQXRv\nbWljTG9uZyBjb21wbGV0ZWRSZXF1ZXN0cyA9IG5ldyBBdG9taWNMb25nKDAp\nOwoKICAgIGxvbmcgZHVyYXRpb24gPSAtMTsKICAgIHN5bmNocm9uaXplZCBw\ndWJsaWMgbG9uZyBnZXREdXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gZHVy\nYXRpb247CiAgICB9CgogICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAg\nIExPRy5pbmZvKCJSdW5uaW5nLi4uIik7CiAgICAgICAgbG9uZyBzdGFydCA9\nIHByZXZpb3VzID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CgogICAg\nICAgIGludCBzZW50ID0gMDsKCiAgICAgICAgVGhyZWFkIHJlcG9ydGVyID0g\nbmV3IFRocmVhZCgpIHsKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1\nbigpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgICAgICB3aGlsZSh0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBMT0cuaW5mbygibXM6IHt9IHJlcToge30iLCBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKSwgY29tcGxldGVkUmVxdWVzdHMuZ2V0QW5k\nU2V0KDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJDYXVnaHQgaW50\nZXJydXB0ZWQgZXhjZXB0aW9uLCBnb2luZyBhd2F5Iik7CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9Owog\nICAgICAgIHJlcG9ydGVyLnN0YXJ0KCk7CiAgICAgICAgbG9uZyBiZWZvcmVT\nZW5kID0gU3lzdGVtLm5hbm9UaW1lKCk7CgogICAgICAgIHdoaWxlKCFUaHJl\nYWQuY3VycmVudFRocmVhZCgpLmlzSW50ZXJydXB0ZWQoKSAmJiBzZW50IDwg\nc2VuZExpbWl0KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBzZW0uYWNxdWlyZSgpOwogICAgICAgICAgICAgICAgaWYgKHNlbnQgPT0g\nMTAwMDApIHsKICAgICAgICAgICAgICAgICAgICBsb25nIGFmdGVyU2VuZCA9\nIFN5c3RlbS5uYW5vVGltZSgpOwogICAgICAgICAgICAgICAgICAgIGxvbmcg\ndGltZSA9IGFmdGVyU2VuZCAtIGJlZm9yZVNlbmQ7CiAgICAgICAgICAgICAg\nICAgICAgTE9HLmluZm8oIlRpbWUgdG8gc2VuZCBmaXJzdCBiYXRjaDoge31z\nIHt9bnMgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lLzEw\nMDAvMTAwMC8xMDAwLCB0aW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGZpbmFsIGludCBpbmRleCA9IGdldFJhbmRvbUxlZGdlcigpOwogICAgICAg\nICAgICBMZWRnZXJIYW5kbGUgaCA9IGxoW2luZGV4XTsKICAgICAgICAgICAg\naWYgKGggPT0gbnVsbCkgewogICAgICAgICAgICAgICAgTE9HLmVycm9yKCJI\nYW5kbGUgIiArIGluZGV4ICsgIiBpcyBudWxsISIpOwogICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgbG9uZyBuYW5vVGltZSA9IFN5c3Rl\nbS5uYW5vVGltZSgpOwogICAgICAgICAgICAgICAgbGhbaW5kZXhdLmFzeW5j\nQWRkRW50cnkoYnl0ZXMsIHRoaXMsIG5ldyBDb250ZXh0KHNlbnQsIG5hbm9U\naW1lKSk7CiAgICAgICAgICAgICAgICBjb3VudGVyLmluY3JlbWVudEFuZEdl\ndCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbnQrKzsKICAgICAg\nICB9CiAgICAgICAgTE9HLmluZm8oIlNlbnQ6ICIgICsgc2VudCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaW50IGkgPSAwOwogICAgICAgICAgICB3\naGlsZSh0aGlzLmNvdW50ZXIuZ2V0KCkgPiAwKSB7CiAgICAgICAgICAgICAg\nICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAgICAgICAgICAgICBpKys7CiAg\nICAgICAgICAgICAgICBpZiAoaSA+IDMwKSB7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9IGNhdGNoKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgTE9HLmVycm9yKCJJbnRlcnJ1cHRlZCB3aGlsZSB3YWl0aW5nIiwg\nZSk7CiAgICAgICAgfQogICAgICAgIHN5bmNocm9uaXplZCh0aGlzKSB7CiAg\nICAgICAgICAgIGR1cmF0aW9uID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlz\nKCkgLSBzdGFydDsKICAgICAgICB9CiAgICAgICAgdGhyb3VnaHB1dCA9IHNl\nbnQqMTAwMC9nZXREdXJhdGlvbigpOwoKICAgICAgICByZXBvcnRlci5pbnRl\ncnJ1cHQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXBvcnRlci5q\nb2luKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24g\naWUpIHsKICAgICAgICAgICAgLy8gaWdub3JlCiAgICAgICAgfQogICAgICAg\nIExPRy5pbmZvKCJGaW5pc2hlZCBwcm9jZXNzaW5nIGluIG1zOiAiICsgZ2V0\nRHVyYXRpb24oKSArICIgdHAgPSAiICsgdGhyb3VnaHB1dCk7CiAgICB9Cgog\nICAgbG9uZyB0aHJvdWdocHV0ID0gLTE7CiAgICBwdWJsaWMgbG9uZyBnZXRU\naHJvdWdocHV0KCkgewogICAgICAgIHJldHVybiB0aHJvdWdocHV0OwogICAg\nfQoKICAgIGxvbmcgdGhyZXNob2xkID0gMjAwMDA7CiAgICBsb25nIHJ1bm5p\nbmdBdmVyYWdlQ291bnRlciA9IDA7CiAgICBsb25nIHRvdGFsVGltZSA9IDA7\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGFkZENvbXBsZXRlKGlu\ndCByYywgTGVkZ2VySGFuZGxlIGxoLCBsb25nIGVudHJ5SWQsIE9iamVjdCBj\ndHgpIHsKICAgICAgICBDb250ZXh0IGNvbnRleHQgPSAoQ29udGV4dCkgY3R4\nOwoKICAgICAgICAvLyB3ZSBuZWVkIHRvIHVzZSB0aGUgaWQgcGFzc2VkIGlu\nIHRoZSBjb250ZXh0IGluIHRoZSBjYXNlIG9mCiAgICAgICAgLy8gbXVsdGlw\nbGUgbGVkZ2VycywgYW5kIGl0IHdvcmtzIGV2ZW4gd2l0aCBvbmUgbGVkZ2Vy\nCiAgICAgICAgZW50cnlJZCA9IGNvbnRleHQuaWQ7CiAgICAgICAgbG9uZyBu\nZXdUaW1lID0gU3lzdGVtLm5hbm9UaW1lKCkgLSBjb250ZXh0LmxvY2FsU3Rh\ncnRUaW1lOwoKICAgICAgICBzZW0ucmVsZWFzZSgpOwogICAgICAgIGNvdW50\nZXIuZGVjcmVtZW50QW5kR2V0KCk7CgogICAgICAgIGlmIChyYyA9PSAwKSB7\nCiAgICAgICAgICAgIGxhdGVuY2llc1soaW50KWVudHJ5SWRdID0gbmV3VGlt\nZTsKICAgICAgICAgICAgY29tcGxldGVkUmVxdWVzdHMuaW5jcmVtZW50QW5k\nR2V0KCk7CiAgICAgICAgfQogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdz\nKCJkZXByZWNhdGlvbiIpCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihT\ndHJpbmdbXSBhcmdzKQogICAgICAgICAgICB0aHJvd3MgS2VlcGVyRXhjZXB0\naW9uLCBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sIFBhcnNl\nRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgT3B0aW9ucyBvcHRp\nb25zID0gbmV3IE9wdGlvbnMoKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlv\nbigidGltZSIsIHRydWUsICJSdW5uaW5nIHRpbWUgKHNlY29uZHMpLCBkZWZh\ndWx0IDYwIik7CiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24oImVudHJ5c2l6\nZSIsIHRydWUsICJFbnRyeSBzaXplIChieXRlcyksIGRlZmF1bHQgMTAyNCIp\nOwogICAgICAgIG9wdGlvbnMuYWRkT3B0aW9uKCJlbnNlbWJsZSIsIHRydWUs\nICJFbnNlbWJsZSBzaXplLCBkZWZhdWx0IDMiKTsKICAgICAgICBvcHRpb25z\nLmFkZE9wdGlvbigicXVvcnVtIiwgdHJ1ZSwgIlF1b3J1bSBzaXplLCBkZWZh\ndWx0IDIiKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigiYWNrUXVvcnVt\nIiwgdHJ1ZSwgIkFjayBxdW9ydW0gc2l6ZSwgZGVmYXVsdCBpcyBzYW1lIGFz\nIHF1b3J1bSIpOwogICAgICAgIG9wdGlvbnMuYWRkT3B0aW9uKCJ0aHJvdHRs\nZSIsIHRydWUsICJNYXggb3V0c3RhbmRpbmcgcmVxdWVzdHMsIGRlZmF1bHQg\nMTAwMDAiKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigibGVkZ2VycyIs\nIHRydWUsICJOdW1iZXIgb2YgbGVkZ2VycywgZGVmYXVsdCAxIik7CiAgICAg\nICAgb3B0aW9ucy5hZGRPcHRpb24oInpvb2tlZXBlciIsIHRydWUsICJab29r\nZWVwZXIgZW5zZW1ibGUsIGRlZmF1bHQgXCJsb2NhbGhvc3Q6MjE4MVwiIik7\nCiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24oInBhc3N3b3JkIiwgdHJ1ZSwg\nIlBhc3N3b3JkIHVzZWQgdG8gY3JlYXRlIGxlZGdlcnMgKGRlZmF1bHQgJ2Jl\nbmNoUGFzc3dkJykiKTsKICAgICAgICBvcHRpb25zLmFkZE9wdGlvbigiY29v\ncmRub2RlIiwgdHJ1ZSwgIkNvb3JkaW5hdGlvbiB6bm9kZSBmb3IgbXVsdGkg\nY2xpZW50IGJlbmNobWFya3MgKG9wdGlvbmFsKSIpOwogICAgICAgIG9wdGlv\nbnMuYWRkT3B0aW9uKCJ0aW1lb3V0IiwgdHJ1ZSwgIk51bWJlciBvZiBzZWNv\nbmRzIGFmdGVyIHdoaWNoIHRvIGdpdmUgdXAiKTsKICAgICAgICBvcHRpb25z\nLmFkZE9wdGlvbigic29ja2V0dGltZW91dCIsIHRydWUsICJTb2NrZXQgdGlt\nZW91dCBmb3IgYm9va2tlZXBlciBjbGllbnQuIEluIHNlY29uZHMuIERlZmF1\nbHQgNSIpOwogICAgICAgIG9wdGlvbnMuYWRkT3B0aW9uKCJza2lwd2FybXVw\nIiwgZmFsc2UsICJTa2lwIHdhcm0gdXAsIGRlZmF1bHQgZmFsc2UiKTsKICAg\nICAgICBvcHRpb25zLmFkZE9wdGlvbigic2VuZGxpbWl0IiwgdHJ1ZSwgIk1h\neCBudW1iZXIgb2YgZW50cmllcyB0byBzZW5kLiBEZWZhdWx0IDIwMDAwMDAw\nIik7CiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24oImxhdGVuY3lGaWxlIiwg\ndHJ1ZSwgIkZpbGUgdG8gZHVtcCBsYXRlbmNpZXMuIERlZmF1bHQgaXMgbGF0\nZW5jeUR1bXAuZGF0Iik7CiAgICAgICAgb3B0aW9ucy5hZGRPcHRpb24oImhl\nbHAiLCBmYWxzZSwgIlRoaXMgbWVzc2FnZSIpOwoKICAgICAgICBDb21tYW5k\nTGluZVBhcnNlciBwYXJzZXIgPSBuZXcgUG9zaXhQYXJzZXIoKTsKICAgICAg\nICBDb21tYW5kTGluZSBjbWQgPSBwYXJzZXIucGFyc2Uob3B0aW9ucywgYXJn\ncyk7CgogICAgICAgIGlmIChjbWQuaGFzT3B0aW9uKCJoZWxwIikpIHsKICAg\nICAgICAgICAgSGVscEZvcm1hdHRlciBmb3JtYXR0ZXIgPSBuZXcgSGVscEZv\ncm1hdHRlcigpOwogICAgICAgICAgICBmb3JtYXR0ZXIucHJpbnRIZWxwKCJC\nZW5jaFRocm91Z2hwdXRMYXRlbmN5IDxvcHRpb25zPiIsIG9wdGlvbnMpOwog\nICAgICAgICAgICBTeXN0ZW0uZXhpdCgtMSk7CiAgICAgICAgfQoKICAgICAg\nICBsb25nIHJ1bm5pbmdUaW1lID0gTG9uZy52YWx1ZU9mKGNtZC5nZXRPcHRp\nb25WYWx1ZSgidGltZSIsICI2MCIpKTsKICAgICAgICBTdHJpbmcgc2VydmVy\ncyA9IGNtZC5nZXRPcHRpb25WYWx1ZSgiem9va2VlcGVyIiwgImxvY2FsaG9z\ndDoyMTgxIik7CiAgICAgICAgaW50IGVudHJ5c2l6ZSA9IEludGVnZXIudmFs\ndWVPZihjbWQuZ2V0T3B0aW9uVmFsdWUoImVudHJ5c2l6ZSIsICIxMDI0Iikp\nOwoKICAgICAgICBpbnQgbGVkZ2VycyA9IEludGVnZXIudmFsdWVPZihjbWQu\nZ2V0T3B0aW9uVmFsdWUoImxlZGdlcnMiLCAiMSIpKTsKICAgICAgICBpbnQg\nZW5zZW1ibGUgPSBJbnRlZ2VyLnZhbHVlT2YoY21kLmdldE9wdGlvblZhbHVl\nKCJlbnNlbWJsZSIsICIzIikpOwogICAgICAgIGludCBxdW9ydW0gPSBJbnRl\nZ2VyLnZhbHVlT2YoY21kLmdldE9wdGlvblZhbHVlKCJxdW9ydW0iLCAiMiIp\nKTsKICAgICAgICBpbnQgYWNrUXVvcnVtID0gcXVvcnVtOwogICAgICAgIGlm\nIChjbWQuaGFzT3B0aW9uKCJhY2tRdW9ydW0iKSkgewogICAgICAgICAgICBh\nY2tRdW9ydW0gPSBJbnRlZ2VyLnZhbHVlT2YoY21kLmdldE9wdGlvblZhbHVl\nKCJhY2tRdW9ydW0iKSk7CiAgICAgICAgfQogICAgICAgIGludCB0aHJvdHRs\nZSA9IEludGVnZXIudmFsdWVPZihjbWQuZ2V0T3B0aW9uVmFsdWUoInRocm90\ndGxlIiwgIjEwMDAwIikpOwogICAgICAgIGludCBzZW5kTGltaXQgPSBJbnRl\nZ2VyLnZhbHVlT2YoY21kLmdldE9wdGlvblZhbHVlKCJzZW5kbGltaXQiLCAi\nMjAwMDAwMDAiKSk7CgogICAgICAgIGZpbmFsIGludCBzb2NrVGltZW91dCA9\nIEludGVnZXIudmFsdWVPZihjbWQuZ2V0T3B0aW9uVmFsdWUoInNvY2tldHRp\nbWVvdXQiLCAiNSIpKTsKCiAgICAgICAgU3RyaW5nIGNvb3JkaW5hdGlvblpu\nb2RlID0gY21kLmdldE9wdGlvblZhbHVlKCJjb29yZG5vZGUiKTsKICAgICAg\nICBmaW5hbCBieXRlW10gcGFzc3dkID0gY21kLmdldE9wdGlvblZhbHVlKCJw\nYXNzd29yZCIsICJiZW5jaFBhc3N3ZCIpLmdldEJ5dGVzKCk7CgogICAgICAg\nIFN0cmluZyBsYXRlbmN5RmlsZSA9IGNtZC5nZXRPcHRpb25WYWx1ZSgibGF0\nZW5jeUZpbGUiLCAibGF0ZW5jeUR1bXAuZGF0Iik7CgogICAgICAgIFRpbWVy\nIHRpbWVvdXRlciA9IG5ldyBUaW1lcigpOwogICAgICAgIGlmIChjbWQuaGFz\nT3B0aW9uKCJ0aW1lb3V0IikpIHsKICAgICAgICAgICAgZmluYWwgbG9uZyB0\naW1lb3V0ID0gTG9uZy52YWx1ZU9mKGNtZC5nZXRPcHRpb25WYWx1ZSgidGlt\nZW91dCIsICIzNjAiKSkgKiAxMDAwOwoKICAgICAgICAgICAgdGltZW91dGVy\nLnNjaGVkdWxlKG5ldyBUaW1lclRhc2soKSB7CiAgICAgICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgICAg\nICBTeXN0ZW0uZXJyLnByaW50bG4oIlRpbWluZyBvdXQgYmVuY2htYXJrIGFm\ndGVyICIgKyB0aW1lb3V0ICsgIm1zIik7CiAgICAgICAgICAgICAgICAgICAg\nICAgIFN5c3RlbS5leGl0KC0xKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9LCB0aW1lb3V0KTsKICAgICAgICB9CgogICAgICAg\nIExPRy53YXJuKCIoUGFyYW1ldGVycyByZWNlaXZlZCkgcnVubmluZyB0aW1l\nOiAiICsgcnVubmluZ1RpbWUgKwogICAgICAgICAgICAgICAgIiwgZW50cnkg\nc2l6ZTogIiArIGVudHJ5c2l6ZSArICIsIGVuc2VtYmxlIHNpemU6ICIgKyBl\nbnNlbWJsZSArCiAgICAgICAgICAgICAgICAiLCBxdW9ydW0gc2l6ZTogIiAr\nIHF1b3J1bSArCiAgICAgICAgICAgICAgICAiLCB0aHJvdHRsZTogIiArIHRo\ncm90dGxlICsKICAgICAgICAgICAgICAgICIsIG51bWJlciBvZiBsZWRnZXJz\nOiAiICsgbGVkZ2VycyArCiAgICAgICAgICAgICAgICAiLCB6ayBzZXJ2ZXJz\nOiAiICsgc2VydmVycyArCiAgICAgICAgICAgICAgICAiLCBsYXRlbmN5IGZp\nbGU6ICIgKyBsYXRlbmN5RmlsZSk7CgogICAgICAgIGxvbmcgdG90YWxUaW1l\nID0gcnVubmluZ1RpbWUqMTAwMDsKCiAgICAgICAgLy8gRG8gYSB3YXJtdXAg\ncnVuCiAgICAgICAgVGhyZWFkIHRocmVhZDsKCiAgICAgICAgYnl0ZSBkYXRh\nW10gPSBuZXcgYnl0ZVtlbnRyeXNpemVdOwogICAgICAgIEFycmF5cy5maWxs\nKGRhdGEsIChieXRlKSd4Jyk7CgogICAgICAgIENsaWVudENvbmZpZ3VyYXRp\nb24gY29uZiA9IG5ldyBDbGllbnRDb25maWd1cmF0aW9uKCk7CiAgICAgICAg\nY29uZi5zZXRUaHJvdHRsZVZhbHVlKHRocm90dGxlKS5zZXRSZWFkVGltZW91\ndChzb2NrVGltZW91dCkuc2V0WmtTZXJ2ZXJzKHNlcnZlcnMpOwoKICAgICAg\nICBpZiAoIWNtZC5oYXNPcHRpb24oInNraXB3YXJtdXAiKSkgewogICAgICAg\nICAgICBsb25nIHRocm91Z2hwdXQ7CiAgICAgICAgICAgIExPRy5pbmZvKCJT\ndGFydGluZyB3YXJtdXAiKTsKCiAgICAgICAgICAgIHRocm91Z2hwdXQgPSB3\nYXJtVXAoZGF0YSwgbGVkZ2VycywgZW5zZW1ibGUsIHF1b3J1bSwgcGFzc3dk\nLCBjb25mKTsKICAgICAgICAgICAgTE9HLmluZm8oIldhcm11cCB0cDogIiAr\nIHRocm91Z2hwdXQpOwogICAgICAgICAgICBMT0cuaW5mbygiV2FybXVwIHBo\nYXNlIGZpbmlzaGVkIik7CiAgICAgICAgfQoKCiAgICAgICAgLy8gTm93IGRv\nIHRoZSBiZW5jaG1hcmsKICAgICAgICBCZW5jaFRocm91Z2hwdXRMYXRlbmN5\nIGJlbmNoID0gbmV3IEJlbmNoVGhyb3VnaHB1dExhdGVuY3koZW5zZW1ibGUs\nIHF1b3J1bSwgYWNrUXVvcnVtLAogICAgICAgICAgICAgICAgcGFzc3dkLCBs\nZWRnZXJzLCBzZW5kTGltaXQsIGNvbmYpOwogICAgICAgIGJlbmNoLnNldEVu\ndHJ5RGF0YShkYXRhKTsKICAgICAgICB0aHJlYWQgPSBuZXcgVGhyZWFkKGJl\nbmNoKTsKICAgICAgICBab29LZWVwZXIgemsgPSBudWxsOwoKICAgICAgICBp\nZiAoY29vcmRpbmF0aW9uWm5vZGUgIT0gbnVsbCkgewogICAgICAgICAgICBm\naW5hbCBDb3VudERvd25MYXRjaCBjb25uZWN0TGF0Y2ggPSBuZXcgQ291bnRE\nb3duTGF0Y2goMSk7CiAgICAgICAgICAgIHprID0gbmV3IFpvb0tlZXBlcihz\nZXJ2ZXJzLCAxNTAwMCwgbmV3IFdhdGNoZXIoKSB7CiAgICAgICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgcHVibGljIHZv\naWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKGV2ZW50LmdldFN0YXRlKCkgPT0gS2VlcGVyU3Rh\ndGUuU3luY0Nvbm5lY3RlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY29ubmVjdExhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfX0pOwogICAgICAgICAg\nICBpZiAoIWNvbm5lY3RMYXRjaC5hd2FpdCgxMCwgVGltZVVuaXQuU0VDT05E\nUykpIHsKICAgICAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGRuJ3QgY29u\nbmVjdCB0byB6b29rZWVwZXIgYXQgIiArIHNlcnZlcnMpOwogICAgICAgICAg\nICAgICAgemsuY2xvc2UoKTsKICAgICAgICAgICAgICAgIFN5c3RlbS5leGl0\nKC0xKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmluYWwgQ291bnRE\nb3duTGF0Y2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAg\nICAgICAgIExPRy5pbmZvKCJXYWl0aW5nIGZvciAiICsgY29vcmRpbmF0aW9u\nWm5vZGUpOwogICAgICAgICAgICBpZiAoemsuZXhpc3RzKGNvb3JkaW5hdGlv\nblpub2RlLCBuZXcgV2F0Y2hlcigpIHsKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRj\naGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZXZl\nbnQuZ2V0VHlwZSgpID09IEV2ZW50VHlwZS5Ob2RlQ3JlYXRlZCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9fSkgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgbGF0Y2guY291bnREb3duKCk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgbGF0Y2guYXdhaXQoKTsKICAgICAgICAgICAg\nTE9HLmluZm8oIkNvb3JkaW5hdGlvbiB6bm9kZSBjcmVhdGVkIik7CiAgICAg\nICAgfQogICAgICAgIHRocmVhZC5zdGFydCgpOwogICAgICAgIFRocmVhZC5z\nbGVlcCh0b3RhbFRpbWUpOwogICAgICAgIHRocmVhZC5pbnRlcnJ1cHQoKTsK\nICAgICAgICB0aHJlYWQuam9pbigpOwoKICAgICAgICBMT0cuaW5mbygiQ2Fs\nY3VsYXRpbmcgcGVyY2VudGlsZXMiKTsKCiAgICAgICAgaW50IG51bWxhdCA9\nIDA7CiAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGJlbmNoLmxhdGVuY2ll\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoYmVuY2gubGF0ZW5j\naWVzW2ldID4gMCkgewogICAgICAgICAgICAgICAgbnVtbGF0Kys7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaW50IG51bWNvbXBsZXRpb25z\nID0gbnVtbGF0OwogICAgICAgIG51bWxhdCA9IE1hdGgubWluKGJlbmNoLnNl\nbmRMaW1pdCwgbnVtbGF0KTsKICAgICAgICBsb25nW10gbGF0ZW5jeSA9IG5l\ndyBsb25nW251bWxhdF07CiAgICAgICAgaW50IGogPTA7CiAgICAgICAgZm9y\nKGludCBpID0gMDsgaSA8IGJlbmNoLmxhdGVuY2llcy5sZW5ndGggJiYgaiA8\nIG51bWxhdDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChiZW5jaC5sYXRlbmNp\nZXNbaV0gPiAwKSB7CiAgICAgICAgICAgICAgICBsYXRlbmN5W2orK10gPSBi\nZW5jaC5sYXRlbmNpZXNbaV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgQXJyYXlzLnNvcnQobGF0ZW5jeSk7CgogICAgICAgIGxvbmcgdHAg\nPSAobG9uZykoKGRvdWJsZSkobnVtY29tcGxldGlvbnMqMTAwMC4wKS8oZG91\nYmxlKWJlbmNoLmdldER1cmF0aW9uKCkpOwoKICAgICAgICBMT0cuaW5mbyhu\ndW1jb21wbGV0aW9ucyArICIgY29tcGxldGlvbnMgaW4gIiArIGJlbmNoLmdl\ndER1cmF0aW9uKCkgKyAiIHNlY29uZHM6ICIgKyB0cCArICIgb3BzL3NlYyIp\nOwoKICAgICAgICBpZiAoemsgIT0gbnVsbCkgewogICAgICAgICAgICB6ay5j\ncmVhdGUoY29vcmRpbmF0aW9uWm5vZGUgKyAiL3dvcmtlci0iLAogICAgICAg\nICAgICAgICAgICAgICAgKCJ0cCAiICsgdHAgKyAiIGR1cmF0aW9uICIgKyBi\nZW5jaC5nZXREdXJhdGlvbigpKS5nZXRCeXRlcygpLAogICAgICAgICAgICAg\nICAgICAgICAgWm9vRGVmcy5JZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVN\nb2RlLlBFUlNJU1RFTlRfU0VRVUVOVElBTCk7CiAgICAgICAgICAgIHprLmNs\nb3NlKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBkdW1wIHRoZSBsYXRlbmNp\nZXMgZm9yIGxhdGVyIGRlYnVnZ2luZyAoaXQgd2lsbCBiZSBzb3J0ZWQgYnkg\nZW50cnlpZCkKICAgICAgICBPdXRwdXRTdHJlYW0gZm9zID0gbmV3IEJ1ZmZl\ncmVkT3V0cHV0U3RyZWFtKG5ldyBGaWxlT3V0cHV0U3RyZWFtKGxhdGVuY3lG\naWxlKSk7CgogICAgICAgIGZvcihMb25nIGw6IGxhdGVuY3kpIHsKICAgICAg\nICAgICAgZm9zLndyaXRlKChMb25nLnRvU3RyaW5nKGwpKyJcdCIrKGwvMTAw\nMDAwMCkrICJtc1xuIikuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgfQogICAgICAg\nIGZvcy5mbHVzaCgpOwogICAgICAgIGZvcy5jbG9zZSgpOwoKICAgICAgICAv\nLyBub3cgZ2V0IHRoZSBsYXRlbmNpZXMKICAgICAgICBMT0cuaW5mbygiOTl0\naCBwZXJjZW50aWxlIGxhdGVuY3k6IHt9IiwgcGVyY2VudGlsZShsYXRlbmN5\nLCA5OSkpOwogICAgICAgIExPRy5pbmZvKCI5NXRoIHBlcmNlbnRpbGUgbGF0\nZW5jeToge30iLCBwZXJjZW50aWxlKGxhdGVuY3ksIDk1KSk7CgogICAgICAg\nIGJlbmNoLmNsb3NlKCk7CiAgICAgICAgdGltZW91dGVyLmNhbmNlbCgpOwog\nICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGRvdWJsZSBwZXJjZW50aWxlKGxv\nbmdbXSBsYXRlbmN5LCBpbnQgcGVyY2VudGlsZSkgewogICAgICAgIGludCBz\naXplID0gbGF0ZW5jeS5sZW5ndGg7CiAgICAgICAgaW50IHNhbXBsZVNpemUg\nPSAoc2l6ZSAqIHBlcmNlbnRpbGUpIC8gMTAwOwogICAgICAgIGxvbmcgdG90\nYWwgPSAwOwogICAgICAgIGludCBjb3VudCA9IDA7CiAgICAgICAgZm9yKGlu\ndCBpID0gMDsgaSA8IHNhbXBsZVNpemU7IGkrKykgewogICAgICAgICAgICB0\nb3RhbCArPSBsYXRlbmN5W2ldOwogICAgICAgICAgICBjb3VudCsrOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gKChkb3VibGUpdG90YWwvKGRvdWJsZSlj\nb3VudCkvMTAwMDAwMC4wOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGxv\nbmcgd2FybVVwKGJ5dGVbXSBkYXRhLCBpbnQgbGVkZ2VycywgaW50IGVuc2Vt\nYmxlLCBpbnQgcVNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBieXRlW10gcGFzc3dkLCBDbGllbnRDb25maWd1cmF0aW9uIGNvbmYpCiAg\nICAgICAgICAgIHRocm93cyBLZWVwZXJFeGNlcHRpb24sIElPRXhjZXB0aW9u\nLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAg\nIGZpbmFsIENvdW50RG93bkxhdGNoIGNvbm5lY3RMYXRjaCA9IG5ldyBDb3Vu\ndERvd25MYXRjaCgxKTsKICAgICAgICBmaW5hbCBpbnQgYm9va2llczsKICAg\nICAgICBTdHJpbmcgYm9va2llUmVnaXN0cmF0aW9uUGF0aCA9IGNvbmYuZ2V0\nWmtBdmFpbGFibGVCb29raWVzUGF0aCgpOwogICAgICAgIFpvb0tlZXBlciB6\nayA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmluYWwgU3Ry\naW5nIHNlcnZlcnMgPSBjb25mLmdldFprU2VydmVycygpOwogICAgICAgICAg\nICB6ayA9IG5ldyBab29LZWVwZXIoc2VydmVycywgMTUwMDAsIG5ldyBXYXRj\naGVyKCkgewogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3MoV2F0Y2hlZEV2ZW50\nIGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5n\nZXRTdGF0ZSgpID09IEtlZXBlclN0YXRlLlN5bmNDb25uZWN0ZWQpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RMYXRjaC5jb3VudERv\nd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIH19KTsKICAgICAgICAgICAgaWYgKCFjb25uZWN0TGF0Y2guYXdh\naXQoMTAsIFRpbWVVbml0LlNFQ09ORFMpKSB7CiAgICAgICAgICAgICAgICBM\nT0cuZXJyb3IoIkNvdWxkbid0IGNvbm5lY3QgdG8gem9va2VlcGVyIGF0ICIg\nKyBzZXJ2ZXJzKTsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2Vw\ndGlvbigiQ291bGRuJ3QgY29ubmVjdCB0byB6b29rZWVwZXIgIiArIHNlcnZl\ncnMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJvb2tpZXMgPSB6ay5n\nZXRDaGlsZHJlbihib29raWVSZWdpc3RyYXRpb25QYXRoLCBmYWxzZSkuc2l6\nZSgpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmICh6ayAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICB6ay5jbG9zZSgpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICBCZW5jaFRocm91Z2hwdXRMYXRl\nbmN5IHdhcm11cCA9IG5ldyBCZW5jaFRocm91Z2hwdXRMYXRlbmN5KGJvb2tp\nZXMsIGJvb2tpZXMsIGJvb2tpZXMsIHBhc3N3ZCwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGxlZGdlcnMsIDEwMDAwLCBjb25mKTsKICAgICAgICB3YXJtdXAu\nc2V0RW50cnlEYXRhKGRhdGEpOwogICAgICAgIFRocmVhZCB0aHJlYWQgPSBu\nZXcgVGhyZWFkKHdhcm11cCk7CiAgICAgICAgdGhyZWFkLnN0YXJ0KCk7CiAg\nICAgICAgdGhyZWFkLmpvaW4oKTsKICAgICAgICB3YXJtdXAuY2xvc2UoKTsK\nICAgICAgICByZXR1cm4gd2FybXVwLmdldFRocm91Z2hwdXQoKTsKICAgIH0K\nfQo=\n","encoding":"base64"}

