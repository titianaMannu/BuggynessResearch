{"sha":"e09cbb82c230d482c8ad61ebcbb6ed6c209c8645","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTA5Y2JiODJjMjMwZDQ4MmM4YWQ2MWViY2JiNmVkNmMyMDljODY0NQ==","size":44393,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e09cbb82c230d482c8ad61ebcbb6ed6c209c8645","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVOb3RGb3VuZEV4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZh\nLm5ldC5JbmV0U29ja2V0QWRkcmVzczsKCmltcG9ydCBqYXZhLm5pby5CeXRl\nQnVmZmVyOwppbXBvcnQgamF2YS51dGlsLkZvcm1hdHRlcjsKaW1wb3J0IGph\ndmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyRmFjdG9yeTsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlclVuZGVy\ncmVwbGljYXRpb25NYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnpvb2tlZXBlci5ab29LZWVwZXJXYXRjaGVyQmFzZTsKCmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5p\ndDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucmVwbGljYXRpb24u\nQXVkaXRvckVsZWN0b3I7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nYm9va2llLkVudHJ5TG9nZ2VyLkVudHJ5TG9nU2Nhbm5lcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuSm91cm5hbC5Kb3VybmFsU2Nh\nbm5lcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuSm91\ncm5hbC5MYXN0TG9nTWFyazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJvb2tLZWVwZXJBZG1pbjsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VySGFuZGxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJNZXRhZGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkNsaWVudENvbmZp\nZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5T\nZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLm1ldGEuTGVkZ2VyTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5tZXRhLkxlZGdlck1hbmFnZXIuTGVkZ2VyUmFuZ2VJdGVyYXRv\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxlZGdlck1h\nbmFnZXIuTGVkZ2VyUmFuZ2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIudXRpbC5FbnRyeUZvcm1hdHRlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci51dGlsLlRvb2w7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIudXRpbC5aa1V0aWxzOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0Nh\nbGxiYWNrOwoKaW1wb3J0IGNvbS5nb29nbGUuY29tbW9uLnV0aWwuY29uY3Vy\ncmVudC5BYnN0cmFjdEZ1dHVyZTsKaW1wb3J0IHN0YXRpYyBjb20uZ29vZ2xl\nLmNvbW1vbi5iYXNlLkNoYXJzZXRzLlVURl84OwoKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5jb25maWd1cmF0aW9uLkNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5Db21wb3NpdGVD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbmZp\nZ3VyYXRpb24uUHJvcGVydGllc0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLmNvbW1vbnMuY2xpLkJhc2ljUGFyc2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5jb21tb25zLmNsaS5NaXNzaW5nQXJndW1lbnRFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY2xpLk9wdGlvbnM7CmltcG9ydCBv\ncmcuYXBhY2hlLmNvbW1vbnMuY2xpLkNvbW1hbmRMaW5lOwppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmNsaS5IZWxwRm9ybWF0dGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmNsaS5QYXJzZUV4Y2VwdGlvbjsKCmltcG9ydCBv\ncmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rv\ncnk7CgovKioKICogQm9va2llIFNoZWxsIGlzIHRvIHByb3ZpZGUgdXRpbGl0\naWVzIGZvciB1c2VycyB0byBhZG1pbmlzdGVyIGEgYm9va2tlZXBlciBjbHVz\ndGVyLgogKi8KcHVibGljIGNsYXNzIEJvb2tpZVNoZWxsIGltcGxlbWVudHMg\nVG9vbCB7CgogICAgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJG\nYWN0b3J5LmdldExvZ2dlcihCb29raWVTaGVsbC5jbGFzcyk7CgogICAgc3Rh\ndGljIGZpbmFsIFN0cmluZyBFTlRSWV9GT1JNQVRURVJfQ0xBU1MgPSAiZW50\ncnlGb3JtYXR0ZXJDbGFzcyI7CgogICAgc3RhdGljIGZpbmFsIFN0cmluZyBD\nTURfTUVUQUZPUk1BVCA9ICJtZXRhZm9ybWF0IjsKICAgIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgQ01EX0JPT0tJRUZPUk1BVCA9ICJib29raWVmb3JtYXQiOwog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfUkVDT1ZFUiA9ICJyZWNvdmVy\nIjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX0xFREdFUiA9ICJsZWRn\nZXIiOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURfTElTVExFREdFUlMg\nPSAibGlzdGxlZGdlcnMiOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBDTURf\nTEVER0VSTUVUQURBVEEgPSAibGVkZ2VybWV0YWRhdGEiOwogICAgc3RhdGlj\nIGZpbmFsIFN0cmluZyBDTURfTElTVFVOREVSUkVQTElDQVRFRCA9ICJsaXN0\ndW5kZXJyZXBsaWNhdGVkIjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01E\nX1dIT0lTQVVESVRPUiA9ICJ3aG9pc2F1ZGl0b3IiOwogICAgc3RhdGljIGZp\nbmFsIFN0cmluZyBDTURfU0lNUExFVEVTVCA9ICJzaW1wbGV0ZXN0IjsKICAg\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ01EX1JFQURMT0cgPSAicmVhZGxvZyI7\nCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIENNRF9SRUFESk9VUk5BTCA9ICJy\nZWFkam91cm5hbCI7CiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIENNRF9MQVNU\nTUFSSyA9ICJsYXN0bWFyayI7CiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIENN\nRF9BVVRPUkVDT1ZFUlkgPSAiYXV0b3JlY292ZXJ5IjsKICAgIHN0YXRpYyBm\naW5hbCBTdHJpbmcgQ01EX0hFTFAgPSAiaGVscCI7CgogICAgZmluYWwgU2Vy\ndmVyQ29uZmlndXJhdGlvbiBia0NvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJh\ndGlvbigpOwogICAgRmlsZVtdIGxlZGdlckRpcmVjdG9yaWVzOwogICAgRmls\nZSBqb3VybmFsRGlyZWN0b3J5OwoKICAgIEVudHJ5TG9nZ2VyIGVudHJ5TG9n\nZ2VyID0gbnVsbDsKICAgIEpvdXJuYWwgam91cm5hbCA9IG51bGw7CiAgICBF\nbnRyeUZvcm1hdHRlciBmb3JtYXR0ZXI7CgogICAgaW50IHBhZ2VTaXplOwog\nICAgaW50IGVudHJpZXNQZXJQYWdlOwoKICAgIGludGVyZmFjZSBDb21tYW5k\nIHsKICAgICAgICBwdWJsaWMgaW50IHJ1bkNtZChTdHJpbmdbXSBhcmdzKSB0\naHJvd3MgRXhjZXB0aW9uOwogICAgICAgIHB1YmxpYyB2b2lkIHByaW50VXNh\nZ2UoKTsKICAgIH0KCiAgICBhYnN0cmFjdCBjbGFzcyBNeUNvbW1hbmQgaW1w\nbGVtZW50cyBDb21tYW5kIHsKICAgICAgICBhYnN0cmFjdCBPcHRpb25zIGdl\ndE9wdGlvbnMoKTsKICAgICAgICBhYnN0cmFjdCBTdHJpbmcgZ2V0RGVzY3Jp\ncHRpb24oKTsKICAgICAgICBhYnN0cmFjdCBTdHJpbmcgZ2V0VXNhZ2UoKTsK\nICAgICAgICBhYnN0cmFjdCBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNtZExp\nbmUpIHRocm93cyBFeGNlcHRpb247CgogICAgICAgIFN0cmluZyBjbWROYW1l\nOwoKICAgICAgICBNeUNvbW1hbmQoU3RyaW5nIGNtZE5hbWUpIHsKICAgICAg\nICAgICAgdGhpcy5jbWROYW1lID0gY21kTmFtZTsKICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKFN0cmlu\nZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgQmFzaWNQYXJzZXIgcGFyc2VyID0gbmV3IEJh\nc2ljUGFyc2VyKCk7CiAgICAgICAgICAgICAgICBDb21tYW5kTGluZSBjbWRM\naW5lID0gcGFyc2VyLnBhcnNlKGdldE9wdGlvbnMoKSwgYXJncyk7CiAgICAg\nICAgICAgICAgICByZXR1cm4gcnVuQ21kKGNtZExpbmUpOwogICAgICAgICAg\nICB9IGNhdGNoIChQYXJzZUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIkVycm9yIHBhcnNpbmcgY29tbWFuZCBsaW5lIGFyZ3Vt\nZW50cyA6ICIsIGUpOwogICAgICAgICAgICAgICAgcHJpbnRVc2FnZSgpOwog\nICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBw\ncmludFVzYWdlKCkgewogICAgICAgICAgICBIZWxwRm9ybWF0dGVyIGhmID0g\nbmV3IEhlbHBGb3JtYXR0ZXIoKTsKICAgICAgICAgICAgU3lzdGVtLmVyci5w\ncmludGxuKGNtZE5hbWUgKyAiOiAiICsgZ2V0RGVzY3JpcHRpb24oKSk7CiAg\nICAgICAgICAgIGhmLnByaW50SGVscChnZXRVc2FnZSgpLCBnZXRPcHRpb25z\nKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEZvcm1hdCB0\naGUgYm9va2tlZXBlciBtZXRhZGF0YSBwcmVzZW50IGluIHpvb2tlZXBlcgog\nICAgICovCiAgICBjbGFzcyBNZXRhRm9ybWF0Q21kIGV4dGVuZHMgTXlDb21t\nYW5kIHsKICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwoK\nICAgICAgICBNZXRhRm9ybWF0Q21kKCkgewogICAgICAgICAgICBzdXBlcihD\nTURfTUVUQUZPUk1BVCk7CiAgICAgICAgICAgIG9wdHMuYWRkT3B0aW9uKCJu\nIiwgIm5vbkludGVyYWN0aXZlIiwgZmFsc2UsCiAgICAgICAgICAgICAgICAg\nICAgIldoZXRoZXIgdG8gY29uZmlybSBpZiBvbGQgZGF0YSBleGlzdHMuLj8i\nKTsKICAgICAgICAgICAgb3B0cy5hZGRPcHRpb24oImYiLCAiZm9yY2UiLCBm\nYWxzZSwKICAgICAgICAgICAgICAgICAgICAiSWYgW25vbkludGVyYWN0aXZl\nXSBpcyBzcGVjaWZpZWQsIHRoZW4gd2hldGhlciIKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICsgIiB0byBmb3JjZSBkZWxldGUgdGhlIG9sZCBkYXRh\nIHdpdGhvdXQgcHJvbXB0LiIpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkgewogICAgICAgICAg\nICByZXR1cm4gb3B0czsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAg\ncmV0dXJuICJGb3JtYXQgYm9va2tlZXBlciBtZXRhZGF0YSBpbiB6b29rZWVw\nZXIiOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3Ry\naW5nIGdldFVzYWdlKCkgewogICAgICAgICAgICByZXR1cm4gIm1ldGFmb3Jt\nYXQgICBbLW5vbkludGVyYWN0aXZlXSBbLWZvcmNlXSI7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRM\naW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBi\nb29sZWFuIGludGVyYWN0aXZlID0gKCFjbWRMaW5lLmhhc09wdGlvbigibiIp\nKTsKICAgICAgICAgICAgYm9vbGVhbiBmb3JjZSA9IGNtZExpbmUuaGFzT3B0\naW9uKCJmIik7CgogICAgICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uIGFk\nbWluQ29uZiA9IG5ldyBDbGllbnRDb25maWd1cmF0aW9uKGJrQ29uZik7CiAg\nICAgICAgICAgIGJvb2xlYW4gcmVzdWx0ID0gQm9va0tlZXBlckFkbWluLmZv\ncm1hdChhZG1pbkNvbmYsIGludGVyYWN0aXZlLAogICAgICAgICAgICAgICAg\nICAgIGZvcmNlKTsKICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQpID8gMCA6\nIDE7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRm9ybWF0cyB0\naGUgbG9jYWwgZGF0YSBwcmVzZW50IGluIGN1cnJlbnQgYm9va2llIHNlcnZl\ncgogICAgICovCiAgICBjbGFzcyBCb29raWVGb3JtYXRDbWQgZXh0ZW5kcyBN\neUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25z\nKCk7CgogICAgICAgIHB1YmxpYyBCb29raWVGb3JtYXRDbWQoKSB7CiAgICAg\nICAgICAgIHN1cGVyKENNRF9CT09LSUVGT1JNQVQpOwogICAgICAgICAgICBv\ncHRzLmFkZE9wdGlvbigibiIsICJub25JbnRlcmFjdGl2ZSIsIGZhbHNlLAog\nICAgICAgICAgICAgICAgICAgICJXaGV0aGVyIHRvIGNvbmZpcm0gaWYgb2xk\nIGRhdGEgZXhpc3RzLi4/Iik7CiAgICAgICAgICAgIG9wdHMuYWRkT3B0aW9u\nKCJmIiwgImZvcmNlIiwgZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgIklm\nIFtub25JbnRlcmFjdGl2ZV0gaXMgc3BlY2lmaWVkLCB0aGVuIHdoZXRoZXIi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgdG8gZm9yY2UgZGVs\nZXRlIHRoZSBvbGQgZGF0YSB3aXRob3V0IHByb21wdC4uPyIpOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRp\nb25zKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlv\nbigpIHsKICAgICAgICAgICAgcmV0dXJuICJGb3JtYXQgdGhlIGN1cnJlbnQg\nc2VydmVyIGNvbnRlbnRzIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuICJib29raWVmb3JtYXQgWy1ub25JbnRlcmFjdGl2ZV0gWy1mb3JjZV0i\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgaW50IHJ1\nbkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgYm9vbGVhbiBpbnRlcmFjdGl2ZSA9ICghY21kTGluZS5o\nYXNPcHRpb24oIm4iKSk7CiAgICAgICAgICAgIGJvb2xlYW4gZm9yY2UgPSBj\nbWRMaW5lLmhhc09wdGlvbigiZiIpOwoKICAgICAgICAgICAgU2VydmVyQ29u\nZmlndXJhdGlvbiBjb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmtD\nb25mKTsKICAgICAgICAgICAgYm9vbGVhbiByZXN1bHQgPSBCb29raWUuZm9y\nbWF0KGNvbmYsIGludGVyYWN0aXZlLCBmb3JjZSk7CiAgICAgICAgICAgIHJl\ndHVybiAocmVzdWx0KSA/IDAgOiAxOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJlY292ZXIgY29tbWFuZCBmb3IgbGVkZ2VyIGRhdGEgcmVj\nb3ZlcnkgZm9yIGZhaWxlZCBib29raWUKICAgICAqLwogICAgY2xhc3MgUmVj\nb3ZlckNtZCBleHRlbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBv\ncHRzID0gbmV3IE9wdGlvbnMoKTsKCiAgICAgICAgcHVibGljIFJlY292ZXJD\nbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9SRUNPVkVSKTsKICAgICAg\nICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIE9wdGlvbnMgZ2V0T3B0\naW9ucygpIHsKICAgICAgICAgICAgcmV0dXJuIG9wdHM7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0RGVzY3JpcHRp\nb24oKSB7CiAgICAgICAgICAgIHJldHVybiAiUmVjb3ZlciB0aGUgbGVkZ2Vy\nIGRhdGEgZm9yIGZhaWxlZCBib29raWUiOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkgewogICAgICAg\nICAgICByZXR1cm4gInJlY292ZXIgICAgICA8Ym9va2llU3JjPiBbYm9va2ll\nRGVzdF0iOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\naW50IHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICAgICAgU3RyaW5nW10gYXJncyA9IGNtZExpbmUuZ2V0\nQXJncygpOwogICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAxKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgTWlzc2luZ0FyZ3VtZW50RXhjZXB0\naW9uKAogICAgICAgICAgICAgICAgICAgICAgICAiJ2Jvb2tpZVNyYycgYXJn\ndW1lbnQgcmVxdWlyZWQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nQ2xpZW50Q29uZmlndXJhdGlvbiBhZG1pbkNvbmYgPSBuZXcgQ2xpZW50Q29u\nZmlndXJhdGlvbihia0NvbmYpOwogICAgICAgICAgICBCb29rS2VlcGVyQWRt\naW4gYWRtaW4gPSBuZXcgQm9va0tlZXBlckFkbWluKGFkbWluQ29uZik7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYmtSZWNv\ndmVyeShhZG1pbiwgYXJncyk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICBpZiAobnVsbCAhPSBhZG1pbikgewogICAgICAgICAg\nICAgICAgICAgIGFkbWluLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZhdGUgaW50IGJr\nUmVjb3ZlcnkoQm9va0tlZXBlckFkbWluIGJrQWRtaW4sIFN0cmluZ1tdIGFy\nZ3MpCiAgICAgICAgICAgICAgICB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRp\nb24sIEJLRXhjZXB0aW9uIHsKICAgICAgICAgICAgZmluYWwgU3RyaW5nIGJv\nb2tpZVNyY1N0cmluZ1tdID0gYXJnc1swXS5zcGxpdCgiOiIpOwogICAgICAg\nICAgICBpZiAoYm9va2llU3JjU3RyaW5nLmxlbmd0aCAhPSAyKSB7CiAgICAg\nICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIkJvb2tpZVNyYyBpbnB1\ndHRlZCBoYXMgaW52YWxpZCBmb3JtYXQiCiAgICAgICAgICAgICAgICAgICAg\nICAgICsgIihob3N0OnBvcnQgZXhwZWN0ZWQpOiAiICsgYXJnc1swXSk7CiAg\nICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgZmluYWwgSW5ldFNvY2tldEFkZHJlc3MgYm9va2llU3JjID0gbmV3\nIEluZXRTb2NrZXRBZGRyZXNzKAogICAgICAgICAgICAgICAgICAgIGJvb2tp\nZVNyY1N0cmluZ1swXSwgSW50ZWdlci5wYXJzZUludChib29raWVTcmNTdHJp\nbmdbMV0pKTsKICAgICAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgYm9va2ll\nRGVzdCA9IG51bGw7CiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA+PSAy\nKSB7CiAgICAgICAgICAgICAgICBmaW5hbCBTdHJpbmcgYm9va2llRGVzdFN0\ncmluZ1tdID0gYXJnc1sxXS5zcGxpdCgiOiIpOwogICAgICAgICAgICAgICAg\naWYgKGJvb2tpZURlc3RTdHJpbmcubGVuZ3RoIDwgMikgewogICAgICAgICAg\nICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiQm9va2llRGVzdCBpbnB1\ndHRlZCBoYXMgaW52YWxpZCBmb3JtYXQiCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICArICIoaG9zdDpwb3J0IGV4cGVjdGVkKTogIiArIGFyZ3NbMV0p\nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIGJvb2tpZURlc3QgPSBuZXcgSW5ldFNv\nY2tldEFkZHJlc3MoYm9va2llRGVzdFN0cmluZ1swXSwKICAgICAgICAgICAg\nICAgICAgICAgICAgSW50ZWdlci5wYXJzZUludChib29raWVEZXN0U3RyaW5n\nWzFdKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJrQWRtaW4ucmVj\nb3ZlckJvb2tpZURhdGEoYm9va2llU3JjLCBib29raWVEZXN0KTsKICAgICAg\nICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogTGVkZ2VyIENvbW1hbmQgSGFuZGxlcyBsZWRnZXIgcmVsYXRlZCBvcGVy\nYXRpb25zCiAgICAgKi8KICAgIGNsYXNzIExlZGdlckNtZCBleHRlbmRzIE15\nQ29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBsT3B0cyA9IG5ldyBPcHRpb25z\nKCk7CgogICAgICAgIExlZGdlckNtZCgpIHsKICAgICAgICAgICAgc3VwZXIo\nQ01EX0xFREdFUik7CiAgICAgICAgICAgIGxPcHRzLmFkZE9wdGlvbigibSIs\nICJtZXRhIiwgZmFsc2UsICJQcmludCBtZXRhIGluZm9ybWF0aW9uIik7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50\nIHJ1bkNtZChDb21tYW5kTGluZSBjbWRMaW5lKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgU3RyaW5nW10gbGVmdEFyZ3MgPSBjbWRMaW5lLmdl\ndEFyZ3MoKTsKICAgICAgICAgICAgaWYgKGxlZnRBcmdzLmxlbmd0aCA8PSAw\nKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIkVSUk9S\nOiBtaXNzaW5nIGxlZGdlciBpZCIpOwogICAgICAgICAgICAgICAgcHJpbnRV\nc2FnZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBib29sZWFuIHByaW50TWV0YSA9IGZhbHNlOwog\nICAgICAgICAgICBpZiAoY21kTGluZS5oYXNPcHRpb24oIm0iKSkgewogICAg\nICAgICAgICAgICAgcHJpbnRNZXRhID0gdHJ1ZTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBsb25nIGxlZGdlcklkOwogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgbGVkZ2VySWQgPSBMb25nLnBhcnNlTG9uZyhsZWZ0\nQXJnc1swXSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4\nY2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJp\nbnRsbigiRVJST1I6IGludmFsaWQgbGVkZ2VyIGlkICIgKyBsZWZ0QXJnc1sw\nXSk7CiAgICAgICAgICAgICAgICBwcmludFVzYWdlKCk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKHByaW50TWV0YSkgewogICAgICAgICAgICAgICAgLy8gcHJpbnQgbWV0YQog\nICAgICAgICAgICAgICAgcmVhZExlZGdlck1ldGEobGVkZ2VySWQpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIC8vIGR1bXAgbGVkZ2VyIGluZm8KICAg\nICAgICAgICAgcmVhZExlZGdlckluZGV4RW50cmllcyhsZWRnZXJJZCk7CiAg\nICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAg\nICAgICByZXR1cm4gIkR1bXAgbGVkZ2VyIGluZGV4IGVudHJpZXMgaW50byBy\nZWFkYWJsZSBmb3JtYXQuIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuICJsZWRnZXIgICAgICAgWy1tXSA8bGVkZ2VyX2lkPiI7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBPcHRpb25zIGdldE9wdGlv\nbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBsT3B0czsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb21tYW5kIGZvciBsaXN0aW5nIHVuZGVy\ncmVwbGljYXRlZCBsZWRnZXJzCiAgICAgKi8KICAgIGNsYXNzIExpc3RVbmRl\ncnJlcGxpY2F0ZWRDbWQgZXh0ZW5kcyBNeUNvbW1hbmQgewogICAgICAgIE9w\ndGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CgogICAgICAgIHB1YmxpYyBM\naXN0VW5kZXJyZXBsaWNhdGVkQ21kKCkgewogICAgICAgICAgICBzdXBlcihD\nTURfTElTVFVOREVSUkVQTElDQVRFRCk7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBPcHRpb25zIGdldE9wdGlvbnMoKSB7CiAgICAg\nICAgICAgIHJldHVybiBvcHRzOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAg\nICAgICByZXR1cm4gIkxpc3QgbGVkZ2VycyBtYXJrZWQgYXMgdW5kZXJyZXBs\naWNhdGVkIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJuICJsaXN0\ndW5kZXJyZXBsaWNhdGVkIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIGludCBydW5DbWQoQ29tbWFuZExpbmUgY21kTGluZSkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFpvb0tlZXBlciB6ayA9IG51\nbGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBab29LZWVw\nZXJXYXRjaGVyQmFzZSB3ID0gbmV3IFpvb0tlZXBlcldhdGNoZXJCYXNlKGJr\nQ29uZi5nZXRaa1RpbWVvdXQoKSk7CiAgICAgICAgICAgICAgICB6ayA9IFpr\nVXRpbHMuY3JlYXRlQ29ubmVjdGVkWm9va2VlcGVyQ2xpZW50KGJrQ29uZi5n\nZXRaa1NlcnZlcnMoKSwgdyk7CiAgICAgICAgICAgICAgICBMZWRnZXJNYW5h\nZ2VyRmFjdG9yeSBtRmFjdG9yeSA9IExlZGdlck1hbmFnZXJGYWN0b3J5Lm5l\nd0xlZGdlck1hbmFnZXJGYWN0b3J5KGJrQ29uZiwgemspOwogICAgICAgICAg\nICAgICAgTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIgdW5kZXJyZXBs\naWNhdGlvbk1hbmFnZXIgPSBtRmFjdG9yeS5uZXdMZWRnZXJVbmRlcnJlcGxp\nY2F0aW9uTWFuYWdlcigpOwogICAgICAgICAgICAgICAgSXRlcmF0b3I8TG9u\nZz4gaXRlciA9IHVuZGVycmVwbGljYXRpb25NYW5hZ2VyLmxpc3RMZWRnZXJz\nVG9SZXJlcGxpY2F0ZSgpOwogICAgICAgICAgICAgICAgd2hpbGUgKGl0ZXIu\naGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKGl0ZXIubmV4dCgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmICh6ayAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgemsuY2xvc2UoKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJu\nIDA7CiAgICAgICAgfQogICAgfQoKICAgIGZpbmFsIHN0YXRpYyBpbnQgTElT\nVF9CQVRDSF9TSVpFID0gMTAwMDsKICAgIC8qKgogICAgICogQ29tbWFuZCB0\nbyBsaXN0IGFsbCBsZWRnZXJzIGluIHRoZSBjbHVzdGVyCiAgICAgKi8KICAg\nIGNsYXNzIExpc3RMZWRnZXJzQ21kIGV4dGVuZHMgTXlDb21tYW5kIHsKICAg\nICAgICBPcHRpb25zIGxPcHRzID0gbmV3IE9wdGlvbnMoKTsKCiAgICAgICAg\nTGlzdExlZGdlcnNDbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9MSVNU\nTEVER0VSUyk7CiAgICAgICAgICAgIGxPcHRzLmFkZE9wdGlvbigibSIsICJt\nZXRhIiwgZmFsc2UsICJQcmludCBtZXRhZGF0YSIpOwoKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKENv\nbW1hbmRMaW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBab29LZWVwZXIgemsgPSBudWxsOwogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgWm9vS2VlcGVyV2F0Y2hlckJhc2UgdyA9IG5ldyBa\nb29LZWVwZXJXYXRjaGVyQmFzZShia0NvbmYuZ2V0WmtUaW1lb3V0KCkpOwog\nICAgICAgICAgICAgICAgemsgPSBaa1V0aWxzLmNyZWF0ZUNvbm5lY3RlZFpv\nb2tlZXBlckNsaWVudChia0NvbmYuZ2V0WmtTZXJ2ZXJzKCksIHcpOwogICAg\nICAgICAgICAgICAgTGVkZ2VyTWFuYWdlckZhY3RvcnkgbUZhY3RvcnkgPSBM\nZWRnZXJNYW5hZ2VyRmFjdG9yeS5uZXdMZWRnZXJNYW5hZ2VyRmFjdG9yeShi\na0NvbmYsIHprKTsKICAgICAgICAgICAgICAgIExlZGdlck1hbmFnZXIgbSA9\nIG1GYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXIoKTsKICAgICAgICAgICAgICAg\nIExlZGdlclJhbmdlSXRlcmF0b3IgaXRlciA9IG0uZ2V0TGVkZ2VyUmFuZ2Vz\nKCk7CiAgICAgICAgICAgICAgICBpZiAoY21kTGluZS5oYXNPcHRpb24oIm0i\nKSkgewogICAgICAgICAgICAgICAgICAgIExpc3Q8UmVhZE1ldGFkYXRhQ2Fs\nbGJhY2s+IGZ1dHVyZXMKICAgICAgICAgICAgICAgICAgICAgICAgPSBuZXcg\nQXJyYXlMaXN0PFJlYWRNZXRhZGF0YUNhbGxiYWNrPihMSVNUX0JBVENIX1NJ\nWkUpOwogICAgICAgICAgICAgICAgICAgIHdoaWxlIChpdGVyLmhhc05leHQo\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBMZWRnZXJSYW5nZSByID0g\naXRlci5uZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoTG9u\nZyBsaWQgOiByLmdldExlZGdlcnMoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgUmVhZE1ldGFkYXRhQ2FsbGJhY2sgY2IgPSBuZXcgUmVhZE1l\ndGFkYXRhQ2FsbGJhY2sobGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIG0ucmVhZExlZGdlck1ldGFkYXRhKGxpZCwgY2IpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZnV0dXJlcy5hZGQoY2IpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChm\ndXR1cmVzLnNpemUoKSA+PSBMSVNUX0JBVENIX1NJWkUpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHdoaWxlIChmdXR1cmVzLnNpemUoKSA+IDAp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFkTWV0YWRh\ndGFDYWxsYmFjayBjYiA9IGZ1dHVyZXMucmVtb3ZlKDApOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHByaW50TGVkZ2VyTWV0YWRhdGEoY2Ip\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIHdoaWxlIChmdXR1cmVzLnNpemUoKSA+IDApIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgUmVhZE1ldGFkYXRhQ2FsbGJhY2sgY2IgPSBm\ndXR1cmVzLnJlbW92ZSgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJp\nbnRMZWRnZXJNZXRhZGF0YShjYik7CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB3\naGlsZSAoaXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgTGVkZ2VyUmFuZ2UgciA9IGl0ZXIubmV4dCgpOwogICAgICAgICAgICAg\nICAgICAgICAgICBmb3IgKExvbmcgbGlkIDogci5nZXRMZWRnZXJzKCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbihMb25nLnRvU3RyaW5nKGxpZCkpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKHpr\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB6ay5jbG9zZSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBy\nZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIFN0cmluZyBnZXREZXNjcmlwdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJu\nICJMaXN0IGFsbCBsZWRnZXJzIG9uIHRoZSBjbHVzdGVyICh0aGlzIG1heSB0\nYWtlIGEgbG9uZyB0aW1lKSI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJl\ndHVybiAibGlzdGxlZGdlcnMgIFstbWV0YV0iOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkgewog\nICAgICAgICAgICByZXR1cm4gbE9wdHM7CiAgICAgICAgfQogICAgfQoKICAg\nIHN0YXRpYyB2b2lkIHByaW50TGVkZ2VyTWV0YWRhdGEoUmVhZE1ldGFkYXRh\nQ2FsbGJhY2sgY2IpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExlZGdl\nck1ldGFkYXRhIG1kID0gY2IuZ2V0KCk7CiAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCJsZWRnZXJJRDogIiArIGNiLmdldExlZGdlcklkKCkpOwogICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbihuZXcgU3RyaW5nKG1kLnNlcmlhbGl6\nZSgpLCBVVEZfOCkpOwogICAgfQoKICAgIHN0YXRpYyBjbGFzcyBSZWFkTWV0\nYWRhdGFDYWxsYmFjayBleHRlbmRzIEFic3RyYWN0RnV0dXJlPExlZGdlck1l\ndGFkYXRhPgogICAgICAgIGltcGxlbWVudHMgR2VuZXJpY0NhbGxiYWNrPExl\nZGdlck1ldGFkYXRhPiB7CiAgICAgICAgZmluYWwgbG9uZyBsZWRnZXJJZDsK\nCiAgICAgICAgUmVhZE1ldGFkYXRhQ2FsbGJhY2sobG9uZyBsZWRnZXJJZCkg\newogICAgICAgICAgICB0aGlzLmxlZGdlcklkID0gbGVkZ2VySWQ7CiAgICAg\nICAgfQoKICAgICAgICBsb25nIGdldExlZGdlcklkKCkgewogICAgICAgICAg\nICByZXR1cm4gbGVkZ2VySWQ7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIExlZGdlck1ldGFkYXRh\nIHJlc3VsdCkgewogICAgICAgICAgICBpZiAocmMgIT0gMCkgewogICAgICAg\nICAgICAgICAgc2V0RXhjZXB0aW9uKEJLRXhjZXB0aW9uLmNyZWF0ZShyYykp\nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2V0KHJl\nc3VsdCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQcmludCB0aGUgbWV0YWRhdGEgZm9yIGEgbGVkZ2VyCiAgICAg\nKi8KICAgIGNsYXNzIExlZGdlck1ldGFkYXRhQ21kIGV4dGVuZHMgTXlDb21t\nYW5kIHsKICAgICAgICBPcHRpb25zIGxPcHRzID0gbmV3IE9wdGlvbnMoKTsK\nCiAgICAgICAgTGVkZ2VyTWV0YWRhdGFDbWQoKSB7CiAgICAgICAgICAgIHN1\ncGVyKENNRF9MRURHRVJNRVRBREFUQSk7CiAgICAgICAgICAgIGxPcHRzLmFk\nZE9wdGlvbigibCIsICJsZWRnZXJpZCIsIHRydWUsICJMZWRnZXIgSUQiKTsK\nICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBp\nbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgICAgICBmaW5hbCBsb25nIGxpZCA9IGdldE9wdGlvbkxv\nbmdWYWx1ZShjbWRMaW5lLCAibGVkZ2VyaWQiLCAtMSk7CiAgICAgICAgICAg\nIGlmIChsaWQgPT0gLTEpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIu\ncHJpbnRsbigiTXVzdCBzcGVjaWZ5IGEgbGVkZ2VyIGlkIik7CiAgICAgICAg\nICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIFpvb0tlZXBlciB6ayA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBab29LZWVwZXJXYXRjaGVyQmFzZSB3ID0gbmV3IFpvb0tl\nZXBlcldhdGNoZXJCYXNlKGJrQ29uZi5nZXRaa1RpbWVvdXQoKSk7CiAgICAg\nICAgICAgICAgICB6ayA9IFprVXRpbHMuY3JlYXRlQ29ubmVjdGVkWm9va2Vl\ncGVyQ2xpZW50KGJrQ29uZi5nZXRaa1NlcnZlcnMoKSwgdyk7CiAgICAgICAg\nICAgICAgICBMZWRnZXJNYW5hZ2VyRmFjdG9yeSBtRmFjdG9yeSA9IExlZGdl\nck1hbmFnZXJGYWN0b3J5Lm5ld0xlZGdlck1hbmFnZXJGYWN0b3J5KGJrQ29u\nZiwgemspOwogICAgICAgICAgICAgICAgTGVkZ2VyTWFuYWdlciBtID0gbUZh\nY3RvcnkubmV3TGVkZ2VyTWFuYWdlcigpOwogICAgICAgICAgICAgICAgUmVh\nZE1ldGFkYXRhQ2FsbGJhY2sgY2IgPSBuZXcgUmVhZE1ldGFkYXRhQ2FsbGJh\nY2sobGlkKTsKICAgICAgICAgICAgICAgIG0ucmVhZExlZGdlck1ldGFkYXRh\nKGxpZCwgY2IpOwogICAgICAgICAgICAgICAgcHJpbnRMZWRnZXJNZXRhZGF0\nYShjYik7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICBpZiAoemsgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHprLmNs\nb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAgICAg\nICByZXR1cm4gIlByaW50IHRoZSBtZXRhZGF0YSBmb3IgYSBsZWRnZXIiOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdl\ndFVzYWdlKCkgewogICAgICAgICAgICByZXR1cm4gImxlZGdlcm1ldGFkYXRh\nIC1sZWRnZXJpZCA8bGVkZ2VyaWQ+IjsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIE9wdGlvbnMgZ2V0T3B0aW9ucygpIHsKICAgICAg\nICAgICAgcmV0dXJuIGxPcHRzOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFNpbXBsZSB0ZXN0IHRvIGNyZWF0ZSBhIGxlZGdlciBhbmQgd3Jp\ndGUgdG8gaXQKICAgICAqLwogICAgY2xhc3MgU2ltcGxlVGVzdENtZCBleHRl\nbmRzIE15Q29tbWFuZCB7CiAgICAgICAgT3B0aW9ucyBsT3B0cyA9IG5ldyBP\ncHRpb25zKCk7CgogICAgICAgIFNpbXBsZVRlc3RDbWQoKSB7CiAgICAgICAg\nICAgIHN1cGVyKENNRF9TSU1QTEVURVNUKTsKICAgICAgICAgICAgbE9wdHMu\nYWRkT3B0aW9uKCJlIiwgImVuc2VtYmxlIiwgdHJ1ZSwgIkVuc2VtYmxlIHNp\nemUgKGRlZmF1bHQgMykiKTsKICAgICAgICAgICAgbE9wdHMuYWRkT3B0aW9u\nKCJ3IiwgIndyaXRlUXVvcnVtIiwgdHJ1ZSwgIldyaXRlIHF1b3J1bSBzaXpl\nIChkZWZhdWx0IDIpIik7CiAgICAgICAgICAgIGxPcHRzLmFkZE9wdGlvbigi\nYSIsICJhY2tRdW9ydW0iLCB0cnVlLCAiQWNrIHF1b3J1bSBzaXplIChkZWZh\ndWx0IDIpIik7CiAgICAgICAgICAgIGxPcHRzLmFkZE9wdGlvbigibiIsICJu\ndW1FbnRyaWVzIiwgdHJ1ZSwgIkVudHJpZXMgdG8gd3JpdGUgKGRlZmF1bHQg\nMTAwMCkiKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNtZExpbmUpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgICAgICBieXRlW10gZGF0YSA9IG5ldyBi\neXRlWzEwMF07IC8vIHRlc3QgZGF0YQoKICAgICAgICAgICAgaW50IGVuc2Vt\nYmxlID0gZ2V0T3B0aW9uSW50VmFsdWUoY21kTGluZSwgImVuc2VtYmxlIiwg\nMyk7CiAgICAgICAgICAgIGludCB3cml0ZVF1b3J1bSA9IGdldE9wdGlvbklu\ndFZhbHVlKGNtZExpbmUsICJ3cml0ZVF1b3J1bSIsIDIpOwogICAgICAgICAg\nICBpbnQgYWNrUXVvcnVtID0gZ2V0T3B0aW9uSW50VmFsdWUoY21kTGluZSwg\nImFja1F1b3J1bSIsIDIpOwogICAgICAgICAgICBpbnQgbnVtRW50cmllcyA9\nIGdldE9wdGlvbkludFZhbHVlKGNtZExpbmUsICJudW1FbnRyaWVzIiwgMTAw\nMCk7CgogICAgICAgICAgICBDbGllbnRDb25maWd1cmF0aW9uIGNvbmYgPSBu\nZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBjb25mLmFk\nZENvbmZpZ3VyYXRpb24oYmtDb25mKTsKICAgICAgICAgICAgQm9va0tlZXBl\nciBiayA9IG5ldyBCb29rS2VlcGVyKGNvbmYpOwogICAgICAgICAgICBMZWRn\nZXJIYW5kbGUgbGggPSBiay5jcmVhdGVMZWRnZXIoZW5zZW1ibGUsIHdyaXRl\nUXVvcnVtLCBhY2tRdW9ydW0sCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBCb29rS2VlcGVyLkRpZ2VzdFR5cGUuTUFD\nLCBuZXcgYnl0ZVswXSk7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbigiTGVkZ2VyIElEOiAiICsgbGguZ2V0SWQoKSk7CiAgICAgICAgICAgIGxv\nbmcgbGFzdFJlcG9ydCA9IFN5c3RlbS5uYW5vVGltZSgpOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVudHJpZXM7IGkrKykgewogICAg\nICAgICAgICAgICAgbGguYWRkRW50cnkoZGF0YSk7CiAgICAgICAgICAgICAg\nICBpZiAoVGltZVVuaXQuU0VDT05EUy5jb252ZXJ0KFN5c3RlbS5uYW5vVGlt\nZSgpIC0gbGFzdFJlcG9ydCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgVGltZVVuaXQuTkFOT1NFQ09ORFMpID4gMSkg\newogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihpICsg\nIiBlbnRyaWVzIHdyaXR0ZW4iKTsKICAgICAgICAgICAgICAgICAgICBsYXN0\nUmVwb3J0ID0gU3lzdGVtLm5hbm9UaW1lKCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxoLmNsb3NlKCk7CiAgICAg\nICAgICAgIGJrLmNsb3NlKCk7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJp\nbnRsbihudW1FbnRyaWVzICsgIiBlbnRyaWVzIHdyaXR0ZW4gdG8gbGVkZ2Vy\nICIgKyBsaC5nZXRJZCgpKTsKCiAgICAgICAgICAgIHJldHVybiAwOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldERl\nc2NyaXB0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gIlNpbXBsZSB0ZXN0\nIHRvIGNyZWF0ZSBhIGxlZGdlciBhbmQgd3JpdGUgZW50cmllcyB0byBpdCI7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcg\nZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJldHVybiAic2ltcGxldGVzdCAg\nIFstZW5zZW1ibGUgTl0gWy13cml0ZVF1b3J1bSBOXSBbLWFja1F1b3J1bSBO\nXSBbLW51bUVudHJpZXMgTl0iOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25zKCkgewogICAgICAgICAg\nICByZXR1cm4gbE9wdHM7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQ29tbWFuZCB0byByZWFkIGVudHJ5IGxvZyBmaWxlcy4KICAgICAqLwog\nICAgY2xhc3MgUmVhZExvZ0NtZCBleHRlbmRzIE15Q29tbWFuZCB7CiAgICAg\nICAgT3B0aW9ucyBybE9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAgICAgICBS\nZWFkTG9nQ21kKCkgewogICAgICAgICAgICBzdXBlcihDTURfUkVBRExPRyk7\nCiAgICAgICAgICAgIHJsT3B0cy5hZGRPcHRpb24oIm0iLCAibXNnIiwgZmFs\nc2UsICJQcmludCBtZXNzYWdlIGJvZHkiKTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKENvbW1hbmRM\naW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBT\ndHJpbmdbXSBsZWZ0QXJncyA9IGNtZExpbmUuZ2V0QXJncygpOwogICAgICAg\nICAgICBpZiAobGVmdEFyZ3MubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAg\nICAgIFN5c3RlbS5lcnIucHJpbnRsbigiRVJST1I6IG1pc3NpbmcgZW50cnkg\nbG9nIGlkIG9yIGVudHJ5IGxvZyBmaWxlIG5hbWUiKTsKICAgICAgICAgICAg\nICAgIHByaW50VXNhZ2UoKTsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgYm9vbGVhbiBwcmludE1zZyA9\nIGZhbHNlOwogICAgICAgICAgICBpZiAoY21kTGluZS5oYXNPcHRpb24oIm0i\nKSkgewogICAgICAgICAgICAgICAgcHJpbnRNc2cgPSB0cnVlOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGxvbmcgbG9nSWQ7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBsb2dJZCA9IExvbmcucGFyc2VMb25nKGxl\nZnRBcmdzWzBdKTsKICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0\nRXhjZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgLy8gbm90IGEgZW50\ncnkgbG9nIGlkCiAgICAgICAgICAgICAgICBGaWxlIGYgPSBuZXcgRmlsZShs\nZWZ0QXJnc1swXSk7CiAgICAgICAgICAgICAgICBTdHJpbmcgbmFtZSA9IGYu\nZ2V0TmFtZSgpOwogICAgICAgICAgICAgICAgaWYgKCFuYW1lLmVuZHNXaXRo\nKCIubG9nIikpIHsKICAgICAgICAgICAgICAgICAgICAvLyBub3QgYSBsb2cg\nZmlsZQogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigi\nRVJST1I6IGludmFsaWQgZW50cnkgbG9nIGZpbGUgbmFtZSAiICsgbGVmdEFy\nZ3NbMF0pOwogICAgICAgICAgICAgICAgICAgIHByaW50VXNhZ2UoKTsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBTdHJpbmcgaWRTdHJpbmcgPSBuYW1lLnNwbGl0\nKCJcXC4iKVswXTsKICAgICAgICAgICAgICAgIGxvZ0lkID0gTG9uZy5wYXJz\nZUxvbmcoaWRTdHJpbmcsIDE2KTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICAvLyBzY2FuIGVudHJ5IGxvZwogICAgICAgICAgICBzY2FuRW50cnlMb2co\nbG9nSWQsIHByaW50TXNnKTsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJpbmcgZ2V0RGVz\nY3JpcHRpb24oKSB7CiAgICAgICAgICAgIHJldHVybiAiU2NhbiBhbiBlbnRy\neSBmaWxlIGFuZCBmb3JtYXQgdGhlIGVudHJpZXMgaW50byByZWFkYWJsZSBm\nb3JtYXQuIjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAgICAgcmV0dXJuICJyZWFk\nbG9nICAgICAgWy1tc2ddIDxlbnRyeV9sb2dfaWQgfCBlbnRyeV9sb2dfZmls\nZV9uYW1lPiI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBPcHRpb25zIGdldE9wdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBy\nbE9wdHM7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ29tbWFu\nZCB0byByZWFkIGpvdXJuYWwgZmlsZXMKICAgICAqLwogICAgY2xhc3MgUmVh\nZEpvdXJuYWxDbWQgZXh0ZW5kcyBNeUNvbW1hbmQgewogICAgICAgIE9wdGlv\nbnMgcmpPcHRzID0gbmV3IE9wdGlvbnMoKTsKCiAgICAgICAgUmVhZEpvdXJu\nYWxDbWQoKSB7CiAgICAgICAgICAgIHN1cGVyKENNRF9SRUFESk9VUk5BTCk7\nCiAgICAgICAgICAgIHJqT3B0cy5hZGRPcHRpb24oIm0iLCAibXNnIiwgZmFs\nc2UsICJQcmludCBtZXNzYWdlIGJvZHkiKTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgcnVuQ21kKENvbW1hbmRM\naW5lIGNtZExpbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBT\ndHJpbmdbXSBsZWZ0QXJncyA9IGNtZExpbmUuZ2V0QXJncygpOwogICAgICAg\nICAgICBpZiAobGVmdEFyZ3MubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAg\nICAgIFN5c3RlbS5lcnIucHJpbnRsbigiRVJST1I6IG1pc3Npbmcgam91cm5h\nbCBpZCBvciBqb3VybmFsIGZpbGUgbmFtZSIpOwogICAgICAgICAgICAgICAg\ncHJpbnRVc2FnZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBib29sZWFuIHByaW50TXNnID0gZmFs\nc2U7CiAgICAgICAgICAgIGlmIChjbWRMaW5lLmhhc09wdGlvbigibSIpKSB7\nCiAgICAgICAgICAgICAgICBwcmludE1zZyA9IHRydWU7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgbG9uZyBqb3VybmFsSWQ7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBqb3VybmFsSWQgPSBMb25nLnBhcnNlTG9u\nZyhsZWZ0QXJnc1swXSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE51bWJlckZv\ncm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgICAgIC8vIG5vdCBh\nIGpvdXJuYWwgaWQKICAgICAgICAgICAgICAgIEZpbGUgZiA9IG5ldyBGaWxl\nKGxlZnRBcmdzWzBdKTsKICAgICAgICAgICAgICAgIFN0cmluZyBuYW1lID0g\nZi5nZXROYW1lKCk7CiAgICAgICAgICAgICAgICBpZiAoIW5hbWUuZW5kc1dp\ndGgoIi50eG4iKSkgewogICAgICAgICAgICAgICAgICAgIC8vIG5vdCBhIGpv\ndXJuYWwgZmlsZQogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJp\nbnRsbigiRVJST1I6IGludmFsaWQgam91cm5hbCBmaWxlIG5hbWUgIiArIGxl\nZnRBcmdzWzBdKTsKICAgICAgICAgICAgICAgICAgICBwcmludFVzYWdlKCk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgU3RyaW5nIGlkU3RyaW5nID0gbmFtZS5z\ncGxpdCgiXFwuIilbMF07CiAgICAgICAgICAgICAgICBqb3VybmFsSWQgPSBM\nb25nLnBhcnNlTG9uZyhpZFN0cmluZywgMTYpOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIC8vIHNjYW4gam91cm5hbAogICAgICAgICAgICBzY2FuSm91\ncm5hbChqb3VybmFsSWQsIHByaW50TXNnKTsKICAgICAgICAgICAgcmV0dXJu\nIDA7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJp\nbmcgZ2V0RGVzY3JpcHRpb24oKSB7CiAgICAgICAgICAgIHJldHVybiAiU2Nh\nbiBhIGpvdXJuYWwgZmlsZSBhbmQgZm9ybWF0IHRoZSBlbnRyaWVzIGludG8g\ncmVhZGFibGUgZm9ybWF0LiI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBTdHJpbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJl\ndHVybiAicmVhZGpvdXJuYWwgIFstbXNnXSA8am91cm5hbF9pZCB8IGpvdXJu\nYWxfZmlsZV9uYW1lPiI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBPcHRpb25zIGdldE9wdGlvbnMoKSB7CiAgICAgICAgICAgIHJl\ndHVybiByak9wdHM7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nQ29tbWFuZCB0byBwcmludCBsYXN0IGxvZyBtYXJrCiAgICAgKi8KICAgIGNs\nYXNzIExhc3RNYXJrQ21kIGV4dGVuZHMgTXlDb21tYW5kIHsKICAgICAgICBM\nYXN0TWFya0NtZCgpIHsKICAgICAgICAgICAgc3VwZXIoQ01EX0xBU1RNQVJL\nKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGMpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgICAgICBwcmludExhc3RMb2dNYXJrKCk7CiAgICAgICAgICAg\nIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgU3RyaW5nIGdldERlc2NyaXB0aW9uKCkgewogICAgICAgICAgICByZXR1\ncm4gIlByaW50IGxhc3QgbG9nIG1hcmtlci4iOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdlKCkgewogICAg\nICAgICAgICByZXR1cm4gImxhc3RtYXJrIjsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIE9wdGlvbnMgZ2V0T3B0aW9ucygpIHsKICAg\nICAgICAgICAgcmV0dXJuIG5ldyBPcHRpb25zKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogQ29tbWFuZCB0byBwcmludCBoZWxwIG1lc3Nh\nZ2UKICAgICAqLwogICAgY2xhc3MgSGVscENtZCBleHRlbmRzIE15Q29tbWFu\nZCB7CiAgICAgICAgSGVscENtZCgpIHsKICAgICAgICAgICAgc3VwZXIoQ01E\nX0hFTFApOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIGludCBydW5DbWQoQ29tbWFuZExpbmUgY21kTGluZSkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFN0cmluZ1tdIGFyZ3MgPSBjbWRM\naW5lLmdldEFyZ3MoKTsKICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09\nIDApIHsKICAgICAgICAgICAgICAgIHByaW50U2hlbGxVc2FnZSgpOwogICAg\nICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgU3RyaW5nIGNtZE5hbWUgPSBhcmdzWzBdOwogICAgICAgICAgICBDb21t\nYW5kIGNtZCA9IGNvbW1hbmRzLmdldChjbWROYW1lKTsKICAgICAgICAgICAg\naWYgKG51bGwgPT0gY21kKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJy\nLnByaW50bG4oIlVua25vd24gY29tbWFuZCAiICsgY21kTmFtZSk7CiAgICAg\nICAgICAgICAgICBwcmludFNoZWxsVXNhZ2UoKTsKICAgICAgICAgICAgICAg\nIHJldHVybiAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjbWQucHJp\nbnRVc2FnZSgpOwogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlv\nbigpIHsKICAgICAgICAgICAgcmV0dXJuICJEZXNjcmliZSB0aGUgdXNhZ2Ug\nb2YgdGhpcyBwcm9ncmFtIG9yIGl0cyBzdWJjb21tYW5kcy4iOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgU3RyaW5nIGdldFVzYWdl\nKCkgewogICAgICAgICAgICByZXR1cm4gImhlbHAgICAgICAgICBbQ09NTUFO\nRF0iOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0\naW9ucyBnZXRPcHRpb25zKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IE9w\ndGlvbnMoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDb21t\nYW5kIGZvciBhZG1pbmlzdHJhdGlvbiBvZiBhdXRvcmVjb3ZlcnkKICAgICAq\nLwogICAgY2xhc3MgQXV0b1JlY292ZXJ5Q21kIGV4dGVuZHMgTXlDb21tYW5k\nIHsKICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwoKICAg\nICAgICBwdWJsaWMgQXV0b1JlY292ZXJ5Q21kKCkgewogICAgICAgICAgICBz\ndXBlcihDTURfQVVUT1JFQ09WRVJZKTsKICAgICAgICAgICAgb3B0cy5hZGRP\ncHRpb24oImUiLCAiZW5hYmxlIiwgZmFsc2UsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICJFbmFibGUgYXV0byByZWNvdmVyeSBvZiB1bmRlcnJlcGxp\nY2F0ZWQgbGVkZ2VycyIpOwogICAgICAgICAgICBvcHRzLmFkZE9wdGlvbigi\nZCIsICJkaXNhYmxlIiwgZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICJEaXNhYmxlIGF1dG8gcmVjb3Zlcnkgb2YgdW5kZXJyZXBsaWNhdGVk\nIGxlZGdlcnMiKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIE9wdGlvbnMgZ2V0T3B0aW9ucygpIHsKICAgICAgICAgICAgcmV0dXJu\nIG9wdHM7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBT\ndHJpbmcgZ2V0RGVzY3JpcHRpb24oKSB7CiAgICAgICAgICAgIHJldHVybiAi\nRW5hYmxlIG9yIGRpc2FibGUgYXV0b3JlY292ZXJ5IGluIHRoZSBjbHVzdGVy\nLiI7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBTdHJp\nbmcgZ2V0VXNhZ2UoKSB7CiAgICAgICAgICAgIHJldHVybiAiYXV0b3JlY292\nZXJ5IFstZW5hYmxlfC1kaXNhYmxlXSI7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBpbnQgcnVuQ21kKENvbW1hbmRMaW5lIGNtZExp\nbmUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBib29sZWFuIGRp\nc2FibGUgPSBjbWRMaW5lLmhhc09wdGlvbigiZCIpOwogICAgICAgICAgICBi\nb29sZWFuIGVuYWJsZSA9IGNtZExpbmUuaGFzT3B0aW9uKCJlIik7CgogICAg\nICAgICAgICBpZiAoKCFkaXNhYmxlICYmICFlbmFibGUpCiAgICAgICAgICAg\nICAgICB8fCAoZW5hYmxlICYmIGRpc2FibGUpKSB7CiAgICAgICAgICAgICAg\nICBMT0cuZXJyb3IoIk9uZSBhbmQgb25seSBvbmUgb2YgLWVuYWJsZSBhbmQg\nLWRpc2FibGUgbXVzdCBiZSBzcGVjaWZpZWQiKTsKICAgICAgICAgICAgICAg\nIHByaW50VXNhZ2UoKTsKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIFpvb0tlZXBlciB6ayA9IG51bGw7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBab29LZWVwZXJXYXRj\naGVyQmFzZSB3ID0gbmV3IFpvb0tlZXBlcldhdGNoZXJCYXNlKGJrQ29uZi5n\nZXRaa1RpbWVvdXQoKSk7CiAgICAgICAgICAgICAgICB6ayA9IFprVXRpbHMu\nY3JlYXRlQ29ubmVjdGVkWm9va2VlcGVyQ2xpZW50KGJrQ29uZi5nZXRaa1Nl\ncnZlcnMoKSwgdyk7CiAgICAgICAgICAgICAgICBMZWRnZXJNYW5hZ2VyRmFj\ndG9yeSBtRmFjdG9yeSA9IExlZGdlck1hbmFnZXJGYWN0b3J5Lm5ld0xlZGdl\nck1hbmFnZXJGYWN0b3J5KGJrQ29uZiwgemspOwogICAgICAgICAgICAgICAg\nTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFnZXIgdW5kZXJyZXBsaWNhdGlv\nbk1hbmFnZXIgPSBtRmFjdG9yeS5uZXdMZWRnZXJVbmRlcnJlcGxpY2F0aW9u\nTWFuYWdlcigpOwogICAgICAgICAgICAgICAgaWYgKGVuYWJsZSkgewogICAg\nICAgICAgICAgICAgICAgIGlmICh1bmRlcnJlcGxpY2F0aW9uTWFuYWdlci5p\nc0xlZGdlclJlcGxpY2F0aW9uRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIExPRy53YXJuKCJBdXRvcmVjb3ZlcnkgYWxyZWFkeSBlbmFi\nbGVkLiBEb2luZyBub3RoaW5nIik7CiAgICAgICAgICAgICAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIkVuYWJs\naW5nIGF1dG9yZWNvdmVyeSIpOwogICAgICAgICAgICAgICAgICAgICAgICB1\nbmRlcnJlcGxpY2F0aW9uTWFuYWdlci5lbmFibGVMZWRnZXJSZXBsaWNhdGlv\nbigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF1bmRlcnJlcGxpY2F0\naW9uTWFuYWdlci5pc0xlZGdlclJlcGxpY2F0aW9uRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJBdXRvcmVjb3Zlcnkg\nYWxyZWFkeSBkaXNhYmxlZC4gRG9pbmcgbm90aGluZyIpOwogICAgICAgICAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExP\nRy5pbmZvKCJEaXNhYmxpbmcgYXV0b3JlY292ZXJ5Iik7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHVuZGVycmVwbGljYXRpb25NYW5hZ2VyLmRpc2FibGVM\nZWRnZXJSZXBsaWNhdGlvbigpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIGlmICh6ayAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgemsuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUHJpbnQgd2hpY2ggbm9kZSBoYXMgdGhlIGF1ZGl0b3Ig\nbG9jawogICAgICovCiAgICBjbGFzcyBXaG9Jc0F1ZGl0b3JDbWQgZXh0ZW5k\ncyBNeUNvbW1hbmQgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRp\nb25zKCk7CgogICAgICAgIHB1YmxpYyBXaG9Jc0F1ZGl0b3JDbWQoKSB7CiAg\nICAgICAgICAgIHN1cGVyKENNRF9XSE9JU0FVRElUT1IpOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgT3B0aW9ucyBnZXRPcHRpb25z\nKCkgewogICAgICAgICAgICByZXR1cm4gb3B0czsKICAgICAgICB9CgogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIFN0cmluZyBnZXREZXNjcmlwdGlvbigp\nIHsKICAgICAgICAgICAgcmV0dXJuICJQcmludCB0aGUgbm9kZSB3aGljaCBo\nb2xkcyB0aGUgYXVkaXRvciBsb2NrIjsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIFN0cmluZyBnZXRVc2FnZSgpIHsKICAgICAgICAg\nICAgcmV0dXJuICJ3aG9pc2F1ZGl0b3IiOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgaW50IHJ1bkNtZChDb21tYW5kTGluZSBjbWRM\naW5lKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgWm9vS2VlcGVy\nIHprID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIFpvb0tlZXBlcldhdGNoZXJCYXNlIHcgPSBuZXcgWm9vS2VlcGVyV2F0Y2hl\nckJhc2UoYmtDb25mLmdldFprVGltZW91dCgpKTsKICAgICAgICAgICAgICAg\nIHprID0gWmtVdGlscy5jcmVhdGVDb25uZWN0ZWRab29rZWVwZXJDbGllbnQo\nYmtDb25mLmdldFprU2VydmVycygpLCB3KTsKICAgICAgICAgICAgICAgIElu\nZXRTb2NrZXRBZGRyZXNzIGJvb2tpZUlkID0gQXVkaXRvckVsZWN0b3IuZ2V0\nQ3VycmVudEF1ZGl0b3IoYmtDb25mLCB6ayk7CiAgICAgICAgICAgICAgICBp\nZiAoYm9va2llSWQgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIExP\nRy5pbmZvKCJObyBhdWRpdG9yIGVsZWN0ZWQiKTsKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBMT0cuaW5mbygiQXVkaXRvcjoge30ve306e30iLAogICAgICAgICAg\nICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBib29raWVJZC5nZXRBZGRyZXNzKCkuZ2V0Q2Fub25p\nY2FsSG9zdE5hbWUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBi\nb29raWVJZC5nZXRBZGRyZXNzKCkuZ2V0SG9zdEFkZHJlc3MoKSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBib29raWVJZC5nZXRQb3J0KCkgfSk7\nCiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAo\nemsgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHprLmNsb3NlKCk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHJldHVybiAwOwogICAgICAgIH0KICAgIH0KCiAgICBmaW5hbCBNYXA8U3Ry\naW5nLCBNeUNvbW1hbmQ+IGNvbW1hbmRzID0gbmV3IEhhc2hNYXA8U3RyaW5n\nLCBNeUNvbW1hbmQ+KCk7CiAgICB7CiAgICAgICAgY29tbWFuZHMucHV0KENN\nRF9NRVRBRk9STUFULCBuZXcgTWV0YUZvcm1hdENtZCgpKTsKICAgICAgICBj\nb21tYW5kcy5wdXQoQ01EX0JPT0tJRUZPUk1BVCwgbmV3IEJvb2tpZUZvcm1h\ndENtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01EX1JFQ09WRVIsIG5l\ndyBSZWNvdmVyQ21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChDTURfTEVE\nR0VSLCBuZXcgTGVkZ2VyQ21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChD\nTURfTElTVExFREdFUlMsIG5ldyBMaXN0TGVkZ2Vyc0NtZCgpKTsKICAgICAg\nICBjb21tYW5kcy5wdXQoQ01EX0xJU1RVTkRFUlJFUExJQ0FURUQsIG5ldyBM\naXN0VW5kZXJyZXBsaWNhdGVkQ21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1\ndChDTURfV0hPSVNBVURJVE9SLCBuZXcgV2hvSXNBdWRpdG9yQ21kKCkpOwog\nICAgICAgIGNvbW1hbmRzLnB1dChDTURfTEVER0VSTUVUQURBVEEsIG5ldyBM\nZWRnZXJNZXRhZGF0YUNtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQoQ01E\nX1NJTVBMRVRFU1QsIG5ldyBTaW1wbGVUZXN0Q21kKCkpOwogICAgICAgIGNv\nbW1hbmRzLnB1dChDTURfUkVBRExPRywgbmV3IFJlYWRMb2dDbWQoKSk7CiAg\nICAgICAgY29tbWFuZHMucHV0KENNRF9SRUFESk9VUk5BTCwgbmV3IFJlYWRK\nb3VybmFsQ21kKCkpOwogICAgICAgIGNvbW1hbmRzLnB1dChDTURfTEFTVE1B\nUkssIG5ldyBMYXN0TWFya0NtZCgpKTsKICAgICAgICBjb21tYW5kcy5wdXQo\nQ01EX0FVVE9SRUNPVkVSWSwgbmV3IEF1dG9SZWNvdmVyeUNtZCgpKTsKICAg\nICAgICBjb21tYW5kcy5wdXQoQ01EX0hFTFAsIG5ldyBIZWxwQ21kKCkpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0Q29uZihD\nb25maWd1cmF0aW9uIGNvbmYpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIGJrQ29uZi5sb2FkQ29uZihjb25mKTsKICAgICAgICBqb3VybmFsRGlyZWN0\nb3J5ID0gQm9va2llLmdldEN1cnJlbnREaXJlY3RvcnkoYmtDb25mLmdldEpv\ndXJuYWxEaXIoKSk7CiAgICAgICAgbGVkZ2VyRGlyZWN0b3JpZXMgPSBCb29r\naWUuZ2V0Q3VycmVudERpcmVjdG9yaWVzKGJrQ29uZi5nZXRMZWRnZXJEaXJz\nKCkpOwogICAgICAgIGZvcm1hdHRlciA9IEVudHJ5Rm9ybWF0dGVyLm5ld0Vu\ndHJ5Rm9ybWF0dGVyKGJrQ29uZiwgRU5UUllfRk9STUFUVEVSX0NMQVNTKTsK\nICAgICAgICBMT0cuaW5mbygiVXNpbmcgZW50cnkgZm9ybWF0dGVyICIgKyBm\nb3JtYXR0ZXIuZ2V0Q2xhc3MoKS5nZXROYW1lKCkpOwogICAgICAgIHBhZ2VT\naXplID0gYmtDb25mLmdldFBhZ2VTaXplKCk7CiAgICAgICAgZW50cmllc1Bl\nclBhZ2UgPSBwYWdlU2l6ZSAvIDg7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIHByaW50U2hlbGxVc2FnZSgpIHsKICAgICAgICBTeXN0ZW0uZXJyLnByaW50\nbG4oIlVzYWdlOiBCb29raWVTaGVsbCBbLWNvbmYgY29uZmlndXJhdGlvbl0g\nPGNvbW1hbmQ+Iik7CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCk7CiAg\nICAgICAgTGlzdDxTdHJpbmc+IGNvbW1hbmROYW1lcyA9IG5ldyBBcnJheUxp\nc3Q8U3RyaW5nPigpOwogICAgICAgIGZvciAoTXlDb21tYW5kIGMgOiBjb21t\nYW5kcy52YWx1ZXMoKSkgewogICAgICAgICAgICBjb21tYW5kTmFtZXMuYWRk\nKCIgICAgICAgIiArIGMuZ2V0VXNhZ2UoKSk7CiAgICAgICAgfQogICAgICAg\nIENvbGxlY3Rpb25zLnNvcnQoY29tbWFuZE5hbWVzKTsKICAgICAgICBmb3Ig\nKFN0cmluZyBzIDogY29tbWFuZE5hbWVzKSB7CiAgICAgICAgICAgIFN5c3Rl\nbS5lcnIucHJpbnRsbihzKTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgaW50IHJ1bihTdHJpbmdbXSBhcmdzKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPD0gMCkgewog\nICAgICAgICAgICBwcmludFNoZWxsVXNhZ2UoKTsKICAgICAgICAgICAgcmV0\ndXJuIC0xOwogICAgICAgIH0KICAgICAgICBTdHJpbmcgY21kTmFtZSA9IGFy\nZ3NbMF07CiAgICAgICAgQ29tbWFuZCBjbWQgPSBjb21tYW5kcy5nZXQoY21k\nTmFtZSk7CiAgICAgICAgaWYgKG51bGwgPT0gY21kKSB7CiAgICAgICAgICAg\nIFN5c3RlbS5lcnIucHJpbnRsbigiRVJST1I6IFVua25vd24gY29tbWFuZCAi\nICsgY21kTmFtZSk7CiAgICAgICAgICAgIHByaW50U2hlbGxVc2FnZSgpOwog\nICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIC8vIHBy\nZXBhcmUgbmV3IGFyZ3MKICAgICAgICBTdHJpbmdbXSBuZXdBcmdzID0gbmV3\nIFN0cmluZ1thcmdzLmxlbmd0aCAtIDFdOwogICAgICAgIFN5c3RlbS5hcnJh\neWNvcHkoYXJncywgMSwgbmV3QXJncywgMCwgbmV3QXJncy5sZW5ndGgpOwog\nICAgICAgIHJldHVybiBjbWQucnVuQ21kKG5ld0FyZ3MpOwogICAgfQoKICAg\nIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZyBhcmd2W10pIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZVNoZWxsIHNoZWxsID0gbmV3\nIEJvb2tpZVNoZWxsKCk7CiAgICAgICAgaWYgKGFyZ3YubGVuZ3RoIDw9IDAp\nIHsKICAgICAgICAgICAgc2hlbGwucHJpbnRTaGVsbFVzYWdlKCk7CiAgICAg\nICAgICAgIFN5c3RlbS5leGl0KC0xKTsKICAgICAgICB9CgogICAgICAgIENv\nbXBvc2l0ZUNvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBDb21wb3NpdGVDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgLy8gbG9hZCBjb25maWd1cmF0aW9uCiAg\nICAgICAgaWYgKCItY29uZiIuZXF1YWxzKGFyZ3ZbMF0pKSB7CiAgICAgICAg\nICAgIGlmIChhcmd2Lmxlbmd0aCA8PSAxKSB7CiAgICAgICAgICAgICAgICBz\naGVsbC5wcmludFNoZWxsVXNhZ2UoKTsKICAgICAgICAgICAgICAgIFN5c3Rl\nbS5leGl0KC0xKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25mLmFk\nZENvbmZpZ3VyYXRpb24obmV3IFByb3BlcnRpZXNDb25maWd1cmF0aW9uKAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZpbGUoYXJn\ndlsxXSkudG9VUkkoKS50b1VSTCgpKSk7CgogICAgICAgICAgICBTdHJpbmdb\nXSBuZXdBcmd2ID0gbmV3IFN0cmluZ1thcmd2Lmxlbmd0aCAtIDJdOwogICAg\nICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGFyZ3YsIDIsIG5ld0FyZ3YsIDAs\nIG5ld0FyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgYXJndiA9IG5ld0FyZ3Y7\nCiAgICAgICAgfQoKCiAgICAgICAgc2hlbGwuc2V0Q29uZihjb25mKTsKICAg\nICAgICBpbnQgcmVzID0gc2hlbGwucnVuKGFyZ3YpOwogICAgICAgIFN5c3Rl\nbS5leGl0KHJlcyk7CiAgICB9CgogICAgLy8vCiAgICAvLy8gQm9va2llIEZp\nbGUgT3BlcmF0aW9ucwogICAgLy8vCgogICAgLyoqCiAgICAgKiBHZXQgdGhl\nIGxlZGdlciBmaWxlIG9mIGEgc3BlY2lmaWVkIGxlZGdlci4KICAgICAqCiAg\nICAgKiBAcGFyYW0gbGVkZ2VySWQKICAgICAqICAgICAgICAgIExlZGdlciBJ\nZAogICAgICoKICAgICAqIEByZXR1cm4gZmlsZSBvYmplY3QuCiAgICAgKi8K\nICAgIHByaXZhdGUgRmlsZSBnZXRMZWRnZXJGaWxlKGxvbmcgbGVkZ2VySWQp\nIHsKICAgICAgICBTdHJpbmcgbGVkZ2VyTmFtZSA9IExlZGdlckNhY2hlSW1w\nbC5nZXRMZWRnZXJOYW1lKGxlZGdlcklkKTsKICAgICAgICBGaWxlIGxmID0g\nbnVsbDsKICAgICAgICBmb3IgKEZpbGUgZCA6IGxlZGdlckRpcmVjdG9yaWVz\nKSB7CiAgICAgICAgICAgIGxmID0gbmV3IEZpbGUoZCwgbGVkZ2VyTmFtZSk7\nCiAgICAgICAgICAgIGlmIChsZi5leGlzdHMoKSkgewogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGYgPSBudWxs\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbGY7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBHZXQgRmlsZUluZm8gZm9yIGEgc3BlY2lmaWVkIGxlZGdlci4K\nICAgICAqCiAgICAgKiBAcGFyYW0gbGVkZ2VySWQKICAgICAqICAgICAgICAg\nIExlZGdlciBJZAogICAgICogQHJldHVybiByZWFkIG9ubHkgZmlsZSBpbmZv\nIGluc3RhbmNlCiAgICAgKi8KICAgIFJlYWRPbmx5RmlsZUluZm8gZ2V0Rmls\nZUluZm8obG9uZyBsZWRnZXJJZCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBGaWxlIGxlZGdlckZpbGUgPSBnZXRMZWRnZXJGaWxlKGxlZGdlcklk\nKTsKICAgICAgICBpZiAobnVsbCA9PSBsZWRnZXJGaWxlKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBGaWxlTm90Rm91bmRFeGNlcHRpb24oIk5vIGluZGV4\nIGZpbGUgZm91bmQgZm9yIGxlZGdlciAiICsgbGVkZ2VySWQgKyAiLiBJdCBt\nYXkgYmUgbm90IGZsdXNoZWQgeWV0LiIpOwogICAgICAgIH0KICAgICAgICBS\nZWFkT25seUZpbGVJbmZvIGZpID0gbmV3IFJlYWRPbmx5RmlsZUluZm8obGVk\nZ2VyRmlsZSwgbnVsbCk7CiAgICAgICAgZmkucmVhZEhlYWRlcigpOwogICAg\nICAgIHJldHVybiBmaTsKICAgIH0KCiAgICBwcml2YXRlIHN5bmNocm9uaXpl\nZCB2b2lkIGluaXRFbnRyeUxvZ2dlcigpIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKG51bGwgPT0gZW50cnlMb2dnZXIpIHsKICAgICAgICAg\nICAgLy8gcHJvdmlkZSByZWFkIG9ubHkgZW50cnkgbG9nZ2VyCiAgICAgICAg\nICAgIGVudHJ5TG9nZ2VyID0gbmV3IFJlYWRPbmx5RW50cnlMb2dnZXIoYmtD\nb25mKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBzY2FuIG92\nZXIgZW50cnkgbG9nCiAgICAgKgogICAgICogQHBhcmFtIGxvZ0lkCiAgICAg\nKiAgICAgICAgICBFbnRyeSBMb2cgSWQKICAgICAqIEBwYXJhbSBzY2FubmVy\nCiAgICAgKiAgICAgICAgICBFbnRyeSBMb2cgU2Nhbm5lcgogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBzY2FuRW50cnlMb2cobG9uZyBsb2dJZCwgRW50\ncnlMb2dTY2FubmVyIHNjYW5uZXIpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAg\nICAgICAgaW5pdEVudHJ5TG9nZ2VyKCk7CiAgICAgICAgZW50cnlMb2dnZXIu\nc2NhbkVudHJ5TG9nKGxvZ0lkLCBzY2FubmVyKTsKICAgIH0KCiAgICBwcml2\nYXRlIHN5bmNocm9uaXplZCBKb3VybmFsIGdldEpvdXJuYWwoKSB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgIGlmIChudWxsID09IGpvdXJuYWwpIHsK\nICAgICAgICAgICAgam91cm5hbCA9IG5ldyBKb3VybmFsKGJrQ29uZiwgbmV3\nIExlZGdlckRpcnNNYW5hZ2VyKGJrQ29uZikpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gam91cm5hbDsKICAgIH0KCiAgICAvKioKICAgICAqIFNjYW4g\nam91cm5hbCBmaWxlCiAgICAgKgogICAgICogQHBhcmFtIGpvdXJuYWxJZAog\nICAgICogICAgICAgICAgSm91cm5hbCBGaWxlIElkCiAgICAgKiBAcGFyYW0g\nc2Nhbm5lcgogICAgICogICAgICAgICAgSm91cm5hbCBGaWxlIFNjYW5uZXIK\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2NhbkpvdXJuYWwobG9uZyBq\nb3VybmFsSWQsIEpvdXJuYWxTY2FubmVyIHNjYW5uZXIpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgZ2V0Sm91cm5hbCgpLnNjYW5Kb3VybmFsKGpv\ndXJuYWxJZCwgMEwsIHNjYW5uZXIpOwogICAgfQoKICAgIC8vLwogICAgLy8v\nIEJvb2tpZSBTaGVsbCBDb21tYW5kcwogICAgLy8vCgogICAgLyoqCiAgICAg\nKiBSZWFkIGxlZGdlciBtZXRhCiAgICAgKgogICAgICogQHBhcmFtIGxlZGdl\ncklkCiAgICAgKiAgICAgICAgICBMZWRnZXIgSWQKICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgcmVhZExlZGdlck1ldGEobG9uZyBsZWRnZXJJZCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCI9\nPT09PSBMRURHRVI6ICIgKyBsZWRnZXJJZCArICIgPT09PT0iKTsKICAgICAg\nICBGaWxlSW5mbyBmaSA9IGdldEZpbGVJbmZvKGxlZGdlcklkKTsKICAgICAg\nICBieXRlW10gbWFzdGVyS2V5ID0gZmkuZ2V0TWFzdGVyS2V5KCk7CiAgICAg\nICAgaWYgKG51bGwgPT0gbWFzdGVyS2V5KSB7CiAgICAgICAgICAgIFN5c3Rl\nbS5vdXQucHJpbnRsbigibWFzdGVyIGtleSAgOiBOVUxMIik7CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJtYXN0\nZXIga2V5ICA6ICIgKyBieXRlczJIZXgoZmkuZ2V0TWFzdGVyS2V5KCkpKTsK\nICAgICAgICB9CiAgICAgICAgbG9uZyBzaXplID0gZmkuc2l6ZSgpOwogICAg\nICAgIGlmIChzaXplICUgOCA9PSAwKSB7CiAgICAgICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbigic2l6ZSAgICAgICAgOiAiICsgc2l6ZSk7CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJzaXpl\nIDogIiArIHNpemUgKyAiIChub3QgYWxpZ25lZCB3aXRoIDgsIG1heSBiZSBj\nb3JydXB0ZWQgb3IgdW5kZXIgZmx1c2hpbmcgbm93KSIpOwogICAgICAgIH0K\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oImVudHJpZXMgICAgIDogIiAr\nIChzaXplIC8gOCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmVhZCBsZWRn\nZXIgaW5kZXggZW50aXJlcwogICAgICoKICAgICAqIEBwYXJhbSBsZWRnZXJJ\nZAogICAgICogICAgICAgICAgTGVkZ2VyIElkCiAgICAgKiBAdGhyb3dzIElP\nRXhjZXB0aW9uCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHJlYWRMZWRn\nZXJJbmRleEVudHJpZXMobG9uZyBsZWRnZXJJZCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIj09PT09IExFREdF\nUjogIiArIGxlZGdlcklkICsgIiA9PT09PSIpOwogICAgICAgIEZpbGVJbmZv\nIGZpID0gZ2V0RmlsZUluZm8obGVkZ2VySWQpOwogICAgICAgIGxvbmcgc2l6\nZSA9IGZpLnNpemUoKTsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oInNp\nemUgICAgICAgIDogIiArIHNpemUpOwogICAgICAgIGxvbmcgY3VyU2l6ZSA9\nIDA7CiAgICAgICAgbG9uZyBjdXJFbnRyeSA9IDA7CiAgICAgICAgTGVkZ2Vy\nRW50cnlQYWdlIGxlcCA9IG5ldyBMZWRnZXJFbnRyeVBhZ2UocGFnZVNpemUs\nIGVudHJpZXNQZXJQYWdlKTsKICAgICAgICBsZXAudXNlUGFnZSgpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHdoaWxlIChjdXJTaXplIDwgc2l6ZSkg\newogICAgICAgICAgICAgICAgbGVwLnNldExlZGdlcihsZWRnZXJJZCk7CiAg\nICAgICAgICAgICAgICBsZXAuc2V0Rmlyc3RFbnRyeShjdXJFbnRyeSk7CiAg\nICAgICAgICAgICAgICBsZXAucmVhZFBhZ2UoZmkpOwoKICAgICAgICAgICAg\nICAgIC8vIHByb2Nlc3MgYSBwYWdlCiAgICAgICAgICAgICAgICBmb3IgKGlu\ndCBpPTA7IGk8ZW50cmllc1BlclBhZ2U7IGkrKykgewogICAgICAgICAgICAg\nICAgICAgIGxvbmcgb2Zmc2V0ID0gbGVwLmdldE9mZnNldChpICogOCk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKDAgPT0gb2Zmc2V0KSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiZW50cnkgIiAr\nIGN1ckVudHJ5ICsgIlx0Olx0Ti9BIik7CiAgICAgICAgICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBlbnRyeUxv\nZ0lkID0gb2Zmc2V0ID4+IDMyTDsKICAgICAgICAgICAgICAgICAgICAgICAg\nbG9uZyBwb3MgPSBvZmZzZXQgJiAweGZmZmZmZmZmTDsKICAgICAgICAgICAg\nICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJlbnRyeSAiICsgY3Vy\nRW50cnkgKyAiXHQ6XHQobG9nOiIgKyBlbnRyeUxvZ0lkICsgIiwgcG9zOiAi\nICsgcG9zICsgIikiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgKytjdXJFbnRyeTsKICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICBjdXJTaXplICs9IHBhZ2VTaXplOwogICAgICAgICAg\nICB9CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaWUpIHsKICAgICAg\nICAgICAgTE9HLmVycm9yKCJGYWlsZWQgdG8gcmVhZCBpbmRleCBwYWdlIDog\nIiwgaWUpOwogICAgICAgICAgICBpZiAoY3VyU2l6ZSArIHBhZ2VTaXplIDwg\nc2l6ZSkgewogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJG\nYWlsZWQgdG8gcmVhZCBpbmRleCBwYWdlIEAgIiArIGN1clNpemUgKyAiLCB0\naGUgaW5kZXggZmlsZSBtYXkgYmUgY29ycnVwdGVkIDogIiArIGllLmdldE1l\nc3NhZ2UoKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICBTeXN0ZW0ub3V0LnByaW50bG4oIkZhaWxlZCB0byByZWFkIGxhc3QgaW5k\nZXggcGFnZSBAICIgKyBjdXJTaXplCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIiwgdGhlIGluZGV4IGZpbGUgbWF5IGJlIGNvcnJ1cHRl\nZCBvciBsYXN0IGluZGV4IHBhZ2UgaXMgbm90IGZ1bGx5IGZsdXNoZWQgeWV0\nIDogIiArIGllLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTY2FuIG92ZXIgYW4gZW50cnkg\nbG9nIGZpbGUuCiAgICAgKgogICAgICogQHBhcmFtIGxvZ0lkCiAgICAgKiAg\nICAgICAgICBFbnRyeSBMb2cgRmlsZSBpZC4KICAgICAqIEBwYXJhbSBwcmlu\ndE1zZwogICAgICogICAgICAgICAgV2hldGhlciBwcmludGluZyB0aGUgZW50\ncnkgZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2NhbkVudHJ5\nTG9nKGxvbmcgbG9nSWQsIGZpbmFsIGJvb2xlYW4gcHJpbnRNc2cpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiU2Nh\nbiBlbnRyeSBsb2cgIiArIGxvZ0lkICsgIiAoIiArIExvbmcudG9IZXhTdHJp\nbmcobG9nSWQpICsgIi5sb2cpIik7CiAgICAgICAgc2NhbkVudHJ5TG9nKGxv\nZ0lkLCBuZXcgRW50cnlMb2dTY2FubmVyKCkgewogICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gYWNjZXB0KGxvbmcg\nbGVkZ2VySWQpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBwcm9jZXNzKGxvbmcgbGVkZ2VySWQsIGxvbmcgc3RhcnRQ\nb3MsIEJ5dGVCdWZmZXIgZW50cnkpIHsKICAgICAgICAgICAgICAgIGZvcm1h\ndEVudHJ5KHN0YXJ0UG9zLCBlbnRyeSwgcHJpbnRNc2cpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTY2FuIGEg\nam91cm5hbCBmaWxlCiAgICAgKgogICAgICogQHBhcmFtIGpvdXJuYWxJZAog\nICAgICogICAgICAgICAgSm91cm5hbCBGaWxlIElkCiAgICAgKiBAcGFyYW0g\ncHJpbnRNc2cKICAgICAqICAgICAgICAgIFdoZXRoZXIgcHJpbnRpbmcgdGhl\nIGVudHJ5IGRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNjYW5K\nb3VybmFsKGxvbmcgam91cm5hbElkLCBmaW5hbCBib29sZWFuIHByaW50TXNn\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50\nbG4oIlNjYW4gam91cm5hbCAiICsgam91cm5hbElkICsgIiAoIiArIExvbmcu\ndG9IZXhTdHJpbmcoam91cm5hbElkKSArICIudHhuKSIpOwogICAgICAgIHNj\nYW5Kb3VybmFsKGpvdXJuYWxJZCwgbmV3IEpvdXJuYWxTY2FubmVyKCkgewog\nICAgICAgICAgICBib29sZWFuIHByaW50Sm91cm5hbFZlcnNpb24gPSBmYWxz\nZTsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHByb2Nlc3MoaW50IGpvdXJuYWxWZXJzaW9uLCBsb25nIG9mZnNldCwg\nQnl0ZUJ1ZmZlciBlbnRyeSkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIGlmICghcHJpbnRKb3VybmFsVmVyc2lvbikgewogICAgICAg\nICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiSm91cm5hbCBWZXJz\naW9uIDogIiArIGpvdXJuYWxWZXJzaW9uKTsKICAgICAgICAgICAgICAgICAg\nICBwcmludEpvdXJuYWxWZXJzaW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIGZvcm1hdEVudHJ5KG9mZnNldCwgZW50cnks\nIHByaW50TXNnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoK\nICAgIC8qKgogICAgICogUHJpbnQgbGFzdCBsb2cgbWFyawogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBwcmludExhc3RMb2dNYXJrKCkgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICBMYXN0TG9nTWFyayBsYXN0TG9nTWFyayA9\nIGdldEpvdXJuYWwoKS5nZXRMYXN0TG9nTWFyaygpOwogICAgICAgIFN5c3Rl\nbS5vdXQucHJpbnRsbigiTGFzdExvZ01hcms6IEpvdXJuYWwgSWQgLSAiICsg\nbGFzdExvZ01hcmsuZ2V0VHhuTG9nSWQoKSArICIoIgogICAgICAgICAgICAg\nICAgKyBMb25nLnRvSGV4U3RyaW5nKGxhc3RMb2dNYXJrLmdldFR4bkxvZ0lk\nKCkpICsgIi50eG4pLCBQb3MgLSAiCiAgICAgICAgICAgICAgICArIGxhc3RM\nb2dNYXJrLmdldFR4bkxvZ1Bvc2l0aW9uKCkpOwogICAgfQoKICAgIC8qKgog\nICAgICogRm9ybWF0IHRoZSBtZXNzYWdlIGludG8gYSByZWFkYWJsZSBmb3Jt\nYXQuCiAgICAgKgogICAgICogQHBhcmFtIHBvcwogICAgICogICAgICAgICAg\nRmlsZSBvZmZzZXQgb2YgdGhlIG1lc3NhZ2Ugc3RvcmVkIGluIGVudHJ5IGxv\nZyBmaWxlCiAgICAgKiBAcGFyYW0gcmVjQnVmZgogICAgICogICAgICAgICAg\nRW50cnkgRGF0YQogICAgICogQHBhcmFtIHByaW50TXNnCiAgICAgKiAgICAg\nICAgICBXaGV0aGVyIHByaW50aW5nIHRoZSBtZXNzYWdlIGJvZHkKICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGZvcm1hdEVudHJ5KGxvbmcgcG9zLCBCeXRl\nQnVmZmVyIHJlY0J1ZmYsIGJvb2xlYW4gcHJpbnRNc2cpIHsKICAgICAgICBs\nb25nIGxlZGdlcklkID0gcmVjQnVmZi5nZXRMb25nKCk7CiAgICAgICAgbG9u\nZyBlbnRyeUlkID0gcmVjQnVmZi5nZXRMb25nKCk7CiAgICAgICAgaW50IGVu\ndHJ5U2l6ZSA9IHJlY0J1ZmYubGltaXQoKTsKCiAgICAgICAgU3lzdGVtLm91\ndC5wcmludGxuKCItLS0tLS0tLS0gTGlkPSIgKyBsZWRnZXJJZCArICIsIEVp\nZD0iICsgZW50cnlJZAogICAgICAgICAgICAgICAgICAgICAgICAgKyAiLCBC\neXRlT2Zmc2V0PSIgKyBwb3MgKyAiLCBFbnRyeVNpemU9IiArIGVudHJ5U2l6\nZSArICIgLS0tLS0tLS0tIik7CiAgICAgICAgaWYgKGVudHJ5SWQgPT0gQm9v\na2llLk1FVEFFTlRSWV9JRF9MRURHRVJfS0VZKSB7CiAgICAgICAgICAgIGlu\ndCBtYXN0ZXJLZXlMZW4gPSByZWNCdWZmLmdldEludCgpOwogICAgICAgICAg\nICBieXRlW10gbWFzdGVyS2V5ID0gbmV3IGJ5dGVbbWFzdGVyS2V5TGVuXTsK\nICAgICAgICAgICAgcmVjQnVmZi5nZXQobWFzdGVyS2V5KTsKICAgICAgICAg\nICAgU3lzdGVtLm91dC5wcmludGxuKCJUeXBlOiAgICAgICAgICAgTUVUQSIp\nOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIk1hc3RlcktleTog\nICAgICAiICsgYnl0ZXMySGV4KG1hc3RlcktleSkpOwogICAgICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KICAgICAgICBpZiAoZW50cnlJZCA9PSBCb29raWUuTUVUQUVOVFJZ\nX0lEX0ZFTkNFX0tFWSkgewogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50\nbG4oIlR5cGU6ICAgICAgICAgICBNRVRBIik7CiAgICAgICAgICAgIFN5c3Rl\nbS5vdXQucHJpbnRsbigiRmVuY2VkIik7CiAgICAgICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbigpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQog\nICAgICAgIC8vIHByb2Nlc3MgYSBkYXRhIGVudHJ5CiAgICAgICAgbG9uZyBs\nYXN0QWRkQ29uZmlybWVkID0gcmVjQnVmZi5nZXRMb25nKCk7CiAgICAgICAg\nU3lzdGVtLm91dC5wcmludGxuKCJUeXBlOiAgICAgICAgICAgREFUQSIpOwog\nICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTGFzdENvbmZpcm1lZDogICIg\nKyBsYXN0QWRkQ29uZmlybWVkKTsKICAgICAgICBpZiAoIXByaW50TXNnKSB7\nCiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIHNraXAgZGlnZXN0IGNo\nZWNraW5nCiAgICAgICAgcmVjQnVmZi5wb3NpdGlvbigzMiArIDgpOwogICAg\nICAgIFN5c3RlbS5vdXQucHJpbnRsbigiRGF0YToiKTsKICAgICAgICBTeXN0\nZW0ub3V0LnByaW50bG4oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBi\neXRlW10gcmV0ID0gbmV3IGJ5dGVbcmVjQnVmZi5yZW1haW5pbmcoKV07CiAg\nICAgICAgICAgIHJlY0J1ZmYuZ2V0KHJldCk7CiAgICAgICAgICAgIGZvcm1h\ndHRlci5mb3JtYXRFbnRyeShyZXQpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTi9B\nLiBDb3JydXB0ZWQuIik7CiAgICAgICAgfQogICAgICAgIFN5c3RlbS5vdXQu\ncHJpbnRsbigpOwogICAgfQoKICAgIHN0YXRpYyBTdHJpbmcgYnl0ZXMySGV4\nKGJ5dGVbXSBkYXRhKSB7CiAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9IG5l\ndyBTdHJpbmdCdWlsZGVyKGRhdGEubGVuZ3RoICogMik7CiAgICAgICAgRm9y\nbWF0dGVyIGZvcm1hdHRlciA9IG5ldyBGb3JtYXR0ZXIoc2IpOwogICAgICAg\nIGZvciAoYnl0ZSBiIDogZGF0YSkgewogICAgICAgICAgICBmb3JtYXR0ZXIu\nZm9ybWF0KCIlMDJ4IiwgYik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBz\nYi50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGludCBn\nZXRPcHRpb25JbnRWYWx1ZShDb21tYW5kTGluZSBjbWRMaW5lLCBTdHJpbmcg\nb3B0aW9uLCBpbnQgZGVmYXVsdFZhbCkgewogICAgICAgIGlmIChjbWRMaW5l\nLmhhc09wdGlvbihvcHRpb24pKSB7CiAgICAgICAgICAgIFN0cmluZyB2YWwg\nPSBjbWRMaW5lLmdldE9wdGlvblZhbHVlKG9wdGlvbik7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci5wYXJzZUlu\ndCh2YWwpOwogICAgICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNl\ncHRpb24gbmZlKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50\nbG4oIkVSUk9SOiBpbnZhbGlkIHZhbHVlIGZvciBvcHRpb24gIiArIG9wdGlv\nbiArICIgOiAiICsgdmFsKTsKICAgICAgICAgICAgICAgIHJldHVybiBkZWZh\ndWx0VmFsOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBkZWZhdWx0VmFsOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGxvbmcg\nZ2V0T3B0aW9uTG9uZ1ZhbHVlKENvbW1hbmRMaW5lIGNtZExpbmUsIFN0cmlu\nZyBvcHRpb24sIGxvbmcgZGVmYXVsdFZhbCkgewogICAgICAgIGlmIChjbWRM\naW5lLmhhc09wdGlvbihvcHRpb24pKSB7CiAgICAgICAgICAgIFN0cmluZyB2\nYWwgPSBjbWRMaW5lLmdldE9wdGlvblZhbHVlKG9wdGlvbik7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gTG9uZy5wYXJzZUxv\nbmcodmFsKTsKICAgICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhj\nZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmlu\ndGxuKCJFUlJPUjogaW52YWxpZCB2YWx1ZSBmb3Igb3B0aW9uICIgKyBvcHRp\nb24gKyAiIDogIiArIHZhbCk7CiAgICAgICAgICAgICAgICByZXR1cm4gZGVm\nYXVsdFZhbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gZGVmYXVsdFZhbDsKICAgIH0KfQo=\n","encoding":"base64"}

