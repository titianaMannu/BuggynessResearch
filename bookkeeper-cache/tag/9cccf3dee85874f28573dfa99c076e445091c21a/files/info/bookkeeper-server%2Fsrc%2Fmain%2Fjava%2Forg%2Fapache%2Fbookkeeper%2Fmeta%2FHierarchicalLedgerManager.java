{"sha":"2c3c4cd17825f7fc6a20334d24ff8500cf1844ba","node_id":"MDQ6QmxvYjE1NzU5NTY6MmMzYzRjZDE3ODI1ZjdmYzZhMjAzMzRkMjRmZjg1MDBjZjE4NDRiYQ==","size":20482,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/2c3c4cd17825f7fc6a20334d24ff8500cf1844ba","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25z\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTmF2aWdhYmxlU2V0OwppbXBvcnQg\namF2YS51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb247CmltcG9ydCBqYXZh\nLnV0aWwuY29uY3VycmVudC5FeGVjdXRvcnM7CmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5TY2hlZHVsZWRFeGVjdXRvclNlcnZpY2U7CmltcG9ydCBq\nYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWljSW50ZWdlcjsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJN\nZXRhZGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkFi\nc3RyYWN0Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJp\nY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5Qcm9jZXNzb3I7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TdHJpbmdVdGlsczsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLlprVXRpbHM7CmltcG9y\ndCBvcmcuYXBhY2hlLnpvb2tlZXBlci5Bc3luY0NhbGxiYWNrOwppbXBvcnQg\nb3JnLmFwYWNoZS56b29rZWVwZXIuQXN5bmNDYWxsYmFjay5TdHJpbmdDYWxs\nYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkNyZWF0ZU1vZGU7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb24u\nQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRz\nOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBv\ncnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJG\nYWN0b3J5OwoKLyoqCiAqIEhpZXJhcmNoaWNhbCBMZWRnZXIgTWFuYWdlciB3\naGljaCBtYW5hZ2VzIGxlZGdlciBtZXRhIGluIHpvb2tlZXBlciB1c2luZyAy\nLWxldmVsIGhpZXJhcmNoaWNhbCB6bm9kZXMuCiAqCiAqIDxwPgogKiBIaWVy\nYXJjaGljYWwgTGVkZ2VyIE1hbmFnZXIgZmlyc3Qgb2J0YWluIGEgZ2xvYmFs\nIHVuaXF1ZSBpZCBmcm9tIHpvb2tlZXBlciB1c2luZyBhIEVQSEVNRVJBTF9T\nRVFVRU5USUFMCiAqIHpub2RlIDxpPihsZWRnZXJzUm9vdFBhdGgpL2xlZGdl\ncnMvaWRnZW4vSUQtPC9pPi4KICogU2luY2Ugem9va2VlcGVyIHNlcXVlbnRp\nYWwgY291bnRlciBoYXMgYSBmb3JtYXQgb2YgJTEwZCAtLSB0aGF0IGlzIDEw\nIGRpZ2l0cyB3aXRoIDAgKHplcm8pIHBhZGRpbmcsIGkuZS4KICogIiZsdDtw\nYXRoJmd0OzAwMDAwMDAwMDEiLCBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2Vy\nIHNwbGl0cyB0aGUgZ2VuZXJhdGVkIGlkIGludG8gMyBwYXJ0cyAoMi00LTQp\nOgogKiA8cHJlPiZsdDtsZXZlbDEgKDIgZGlnaXRzKSZndDsmbHQ7bGV2ZWwy\nICg0IGRpZ2l0cykmZ3Q7Jmx0O2xldmVsMyAoNCBkaWdpdHMpJmd0OzwvcHJl\nPgogKiBUaGVzZSAzIHBhcnRzIGFyZSB1c2VkIHRvIGZvcm0gdGhlIGFjdHVh\nbCBsZWRnZXIgbm9kZSBwYXRoIHVzZWQgdG8gc3RvcmUgbGVkZ2VyIG1ldGFk\nYXRhOgogKiA8cHJlPihsZWRnZXJzUm9vdFBhdGgpL2xldmVsMS9sZXZlbDIv\nTChsZXZlbDMpPC9wcmU+CiAqIEUuZyBMZWRnZXIgMDAwMDAwMDAwMSBpcyBz\ncGxpdCBpbnRvIDMgcGFydHMgPGk+MDA8L2k+LCA8aT4wMDAwPC9pPiwgPGk+\nMDAwMTwvaT4sIHdoaWNoIGlzIHN0b3JlZCBpbgogKiA8aT4obGVkZ2Vyc1Jv\nb3RQYXRoKS8wMC8wMDAwL0wwMDAxPC9pPi4gU28gZWFjaCB6bm9kZSBjb3Vs\nZCBoYXZlIGF0IG1vc3QgMTAwMDAgbGVkZ2Vycywgd2hpY2ggYXZvaWRzCiAq\nIGVycm9ycyBkdXJpbmcgZ2FyYmFnZSBjb2xsZWN0aW9uIGR1ZSB0byBsaXN0\ncyBvZiBjaGlsZHJlbiB0aGF0IGFyZSB0b28gbG9uZy4KICovCmNsYXNzIEhp\nZXJhcmNoaWNhbExlZGdlck1hbmFnZXIgZXh0ZW5kcyBBYnN0cmFjdFprTGVk\nZ2VyTWFuYWdlciB7CgogICAgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBM\nb2dnZXJGYWN0b3J5LmdldExvZ2dlcihIaWVyYXJjaGljYWxMZWRnZXJNYW5h\nZ2VyLmNsYXNzKTsKCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIElER0VOX1pO\nT0RFID0gImlkZ2VuIjsKICAgIHN0YXRpYyBmaW5hbCBTdHJpbmcgSURHRU5F\nUkFUSU9OX1BSRUZJWCA9ICIvIiArIElER0VOX1pOT0RFICsgIi9JRC0iOwog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIE1BWF9JRF9TVUZGSVgg\nPSAiOTk5OSI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgTUlO\nX0lEX1NVRkZJWCA9ICIwMDAwIjsKCiAgICAvLyBQYXRoIHRvIGdlbmVyYXRl\nIGdsb2JhbCBpZAogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgaWRHZW5QYXRo\nOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IKICAgICAqCiAgICAgKiBA\ncGFyYW0gY29uZgogICAgICogICAgICAgICAgQ29uZmlndXJhdGlvbiBvYmpl\nY3QKICAgICAqIEBwYXJhbSB6awogICAgICogICAgICAgICAgWm9vS2VlcGVy\nIENsaWVudCBIYW5kbGUKICAgICAqLwogICAgcHVibGljIEhpZXJhcmNoaWNh\nbExlZGdlck1hbmFnZXIoQWJzdHJhY3RDb25maWd1cmF0aW9uIGNvbmYsIFpv\nb0tlZXBlciB6aykgewogICAgICAgIHN1cGVyKGNvbmYsIHprKTsKCiAgICAg\nICAgdGhpcy5pZEdlblBhdGggPSBsZWRnZXJSb290UGF0aCArIElER0VORVJB\nVElPTl9QUkVGSVg7CiAgICAgICAgTE9HLmRlYnVnKCJVc2luZyBIaWVyYXJj\naGljYWxMZWRnZXJNYW5hZ2VyIHdpdGggcm9vdCBwYXRoIDoge30iLCBsZWRn\nZXJSb290UGF0aCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCBjcmVhdGVMZWRnZXIoZmluYWwgTGVkZ2VyTWV0YWRhdGEgbWV0YWRh\ndGEsIGZpbmFsIEdlbmVyaWNDYWxsYmFjazxMb25nPiBsZWRnZXJDYikgewog\nICAgICAgIFprVXRpbHMuYXN5bmNDcmVhdGVGdWxsUGF0aE9wdGltaXN0aWMo\nemssIGlkR2VuUGF0aCwgbmV3IGJ5dGVbMF0sIElkcy5PUEVOX0FDTF9VTlNB\nRkUsCiAgICAgICAgICAgIENyZWF0ZU1vZGUuRVBIRU1FUkFMX1NFUVVFTlRJ\nQUwsIG5ldyBTdHJpbmdDYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50\nIHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwgZmluYWwgU3RyaW5nIGlk\nUGF0aE5hbWUpIHsKICAgICAgICAgICAgICAgIGlmIChyYyAhPSBLZWVwZXJF\neGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgTE9HLmVycm9yKCJDb3VsZCBub3QgZ2VuZXJhdGUgbmV3IGxlZGdl\nciBpZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtlZXBlckV4\nY2VwdGlvbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSwg\ncGF0aCkpOwogICAgICAgICAgICAgICAgICAgIGxlZGdlckNiLm9wZXJhdGlv\nbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIG51bGwp\nOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgKiBFeHRy\nYWN0IGxlZGdlciBpZCBmcm9tIGdlbiBwYXRoCiAgICAgICAgICAgICAgICAg\nKi8KICAgICAgICAgICAgICAgIGxvbmcgbGVkZ2VySWQ7CiAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGxlZGdlcklkID0gZ2V0\nTGVkZ2VySWRGcm9tR2VuUGF0aChpZFBhdGhOYW1lKTsKICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nICAgICBMT0cuZXJyb3IoIkNvdWxkIG5vdCBleHRyYWN0IGxlZGdlci1pZCBm\ncm9tIGlkIGdlbiBwYXRoOiIgKyBwYXRoLCBlKTsKICAgICAgICAgICAgICAg\nICAgICBsZWRnZXJDYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5D\nb2RlLlpLRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTdHJp\nbmcgbGVkZ2VyUGF0aCA9IGdldExlZGdlclBhdGgobGVkZ2VySWQpOwogICAg\nICAgICAgICAgICAgZmluYWwgbG9uZyBsaWQgPSBsZWRnZXJJZDsKICAgICAg\nICAgICAgICAgIFN0cmluZ0NhbGxiYWNrIHNjYiA9IG5ldyBTdHJpbmdDYWxs\nYmFjaygpIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0KGludCBy\nYywgU3RyaW5nIHBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBP\nYmplY3QgY3R4LCBTdHJpbmcgbmFtZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFs\ndWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9y\nKCJDb3VsZCBub3QgY3JlYXRlIG5vZGUgZm9yIGxlZGdlciIsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2VlcGVyRXhjZXB0aW9u\nLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24uQ29kZS5nZXQocmMpLCBwYXRoKSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWRnZXJDYi5vcGVyYXRp\nb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uLCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB2ZXJzaW9uCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS5zZXRWZXJzaW9uKG5ldyBa\na1ZlcnNpb24oMCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVk\nZ2VyQ2Iub3BlcmF0aW9uQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5PSywg\nbGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBa\na1V0aWxzLmFzeW5jQ3JlYXRlRnVsbFBhdGhPcHRpbWlzdGljKHprLCBsZWRn\nZXJQYXRoLCBtZXRhZGF0YS5zZXJpYWxpemUoKSwKICAgICAgICAgICAgICAg\nICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVNb2RlLlBFUlNJU1RF\nTlQsIHNjYiwgbnVsbCk7CiAgICAgICAgICAgICAgICAvLyBkZWxldGUgdGhl\nIHpub2RlIGZvciBpZCBnZW5lcmF0aW9uCiAgICAgICAgICAgICAgICBzY2hl\nZHVsZXIuc3VibWl0KG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHprLmRlbGV0ZShp\nZFBhdGhOYW1lLCAtMSwgbmV3IEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNr\nKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNz\nUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmMgIT0gS2VlcGVy\nRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBMT0cud2FybigiRXhjZXB0aW9uIGR1\ncmluZyBkZWxldGluZyB6bm9kZSBmb3IgaWQgZ2VuZXJhdGlvbiA6ICIsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtl\nZXBlckV4Y2VwdGlvbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0\nKHJjKSwgcGF0aCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIExPRy5kZWJ1ZygiRGVsZXRpbmcgem5vZGUgZm9yIGlkIGdlbmVyYXRpb24g\nOiB7fSIsIGlkUGF0aE5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICAgICAgfSwgbnVsbCk7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9LCBudWxsKTsKICAgIH0KCiAgICAvLyBnZXQgbGVkZ2VyIGlkIGZyb20g\nZ2VuZXJhdGlvbiBwYXRoCiAgICBwcml2YXRlIGxvbmcgZ2V0TGVkZ2VySWRG\ncm9tR2VuUGF0aChTdHJpbmcgbm9kZU5hbWUpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgbG9uZyBsZWRnZXJJZDsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBTdHJpbmcgcGFydHNbXSA9IG5vZGVOYW1lLnNwbGl0KElER0VO\nRVJBVElPTl9QUkVGSVgpOwogICAgICAgICAgICBsZWRnZXJJZCA9IExvbmcu\ncGFyc2VMb25nKHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdKTsKICAgICAgICB9\nIGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBsZWRnZXJJZDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0TGVkZ2VyUGF0aChsb25nIGxlZGdlcklkKSB7CiAg\nICAgICAgcmV0dXJuIGxlZGdlclJvb3RQYXRoICsgU3RyaW5nVXRpbHMuZ2V0\nSGllcmFyY2hpY2FsTGVkZ2VyUGF0aChsZWRnZXJJZCk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgbG9uZyBnZXRMZWRnZXJJZChTdHJpbmcg\ncGF0aE5hbWUpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFw\nYXRoTmFtZS5zdGFydHNXaXRoKGxlZGdlclJvb3RQYXRoKSkgewogICAgICAg\nICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIml0IGlzIG5vdCBhIHZhbGlk\nIGhhc2hlZCBwYXRoIG5hbWUgOiAiICsgcGF0aE5hbWUpOwogICAgICAgIH0K\nICAgICAgICBTdHJpbmcgaGllcmFyY2hpY2FsUGF0aCA9IHBhdGhOYW1lLnN1\nYnN0cmluZyhsZWRnZXJSb290UGF0aC5sZW5ndGgoKSArIDEpOwogICAgICAg\nIHJldHVybiBTdHJpbmdVdGlscy5zdHJpbmdUb0hpZXJhcmNoaWNhbExlZGdl\ncklkKGhpZXJhcmNoaWNhbFBhdGgpOwogICAgfQoKICAgIC8vIGdldCBsZWRn\nZXIgZnJvbSBhbGwgbGV2ZWwgbm9kZXMKICAgIHByaXZhdGUgbG9uZyBnZXRM\nZWRnZXJJZChTdHJpbmcuLi5sZXZlbE5vZGVzKSB0aHJvd3MgSU9FeGNlcHRp\nb24gewogICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5zdHJpbmdUb0hpZXJh\ncmNoaWNhbExlZGdlcklkKGxldmVsTm9kZXMpOwogICAgfQoKICAgIC8vCiAg\nICAvLyBBY3RpdmUgTGVkZ2VyIE1hbmFnZXIKICAgIC8vCgogICAgLyoqCiAg\nICAgKiBHZXQgdGhlIHNtYWxsZXN0IGNhY2hlIGlkIGluIGEgc3BlY2lmaWVk\nIG5vZGUgL2xldmVsMS9sZXZlbDIKICAgICAqCiAgICAgKiBAcGFyYW0gbGV2\nZWwxCiAgICAgKiAgICAgICAgICAxc3QgbGV2ZWwgbm9kZSBuYW1lCiAgICAg\nKiBAcGFyYW0gbGV2ZWwyCiAgICAgKiAgICAgICAgICAybmQgbGV2ZWwgbm9k\nZSBuYW1lCiAgICAgKiBAcmV0dXJuIHRoZSBzbWFsbGVzdCBsZWRnZXIgaWQK\nICAgICAqLwogICAgcHJpdmF0ZSBsb25nIGdldFN0YXJ0TGVkZ2VySWRCeUxl\ndmVsKFN0cmluZyBsZXZlbDEsIFN0cmluZyBsZXZlbDIpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGdldExlZGdlcklkKGxldmVsMSwg\nbGV2ZWwyLCBNSU5fSURfU1VGRklYKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEdldCB0aGUgbGFyZ2VzdCBjYWNoZSBpZCBpbiBhIHNwZWNpZmllZCBub2Rl\nIC9sZXZlbDEvbGV2ZWwyCiAgICAgKgogICAgICogQHBhcmFtIGxldmVsMQog\nICAgICogICAgICAgICAgMXN0IGxldmVsIG5vZGUgbmFtZQogICAgICogQHBh\ncmFtIGxldmVsMgogICAgICogICAgICAgICAgMm5kIGxldmVsIG5vZGUgbmFt\nZQogICAgICogQHJldHVybiB0aGUgbGFyZ2VzdCBsZWRnZXIgaWQKICAgICAq\nLwogICAgcHJpdmF0ZSBsb25nIGdldEVuZExlZGdlcklkQnlMZXZlbChTdHJp\nbmcgbGV2ZWwxLCBTdHJpbmcgbGV2ZWwyKSB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgIHJldHVybiBnZXRMZWRnZXJJZChsZXZlbDEsIGxldmVsMiwg\nTUFYX0lEX1NVRkZJWCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgdm9pZCBhc3luY1Byb2Nlc3NMZWRnZXJzKGZpbmFsIFByb2Nlc3NvcjxM\nb25nPiBwcm9jZXNzb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGZpbmFs\nQ2IsIGZpbmFsIE9iamVjdCBjb250ZXh0LAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBmaW5hbCBpbnQgc3VjY2Vzc1JjLCBmaW5hbCBp\nbnQgZmFpbHVyZVJjKSB7CiAgICAgICAgLy8gcHJvY2VzcyAxc3QgbGV2ZWwg\nbm9kZXMKICAgICAgICBhc3luY1Byb2Nlc3NMZXZlbE5vZGVzKGxlZGdlclJv\nb3RQYXRoLCBuZXcgUHJvY2Vzc29yPFN0cmluZz4oKSB7CiAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzKGZp\nbmFsIFN0cmluZyBsMU5vZGUsIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENh\nbGxiYWNrIGNiMSkgewogICAgICAgICAgICAgICAgaWYgKGlzU3BlY2lhbFpu\nb2RlKGwxTm9kZSkpIHsKICAgICAgICAgICAgICAgICAgICBjYjEucHJvY2Vz\nc1Jlc3VsdChzdWNjZXNzUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIGZpbmFsIFN0cmluZyBsMU5vZGVQYXRoID0gbGVkZ2VyUm9vdFBh\ndGggKyAiLyIgKyBsMU5vZGU7CiAgICAgICAgICAgICAgICAvLyBwcm9jZXNz\nIGxldmVsMSBwYXRoLCBhZnRlciBhbGwgY2hpbGRyZW4gb2YgbGV2ZWwxIHBy\nb2Nlc3MKICAgICAgICAgICAgICAgIC8vIGl0IGNhbGxiYWNrIHRvIGNvbnRp\nbnVlIHByb2Nlc3NpbmcgbmV4dCBsZXZlbDEgbm9kZQogICAgICAgICAgICAg\nICAgYXN5bmNQcm9jZXNzTGV2ZWxOb2RlcyhsMU5vZGVQYXRoLCBuZXcgUHJv\nY2Vzc29yPFN0cmluZz4oKSB7CiAgICAgICAgICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhT\ndHJpbmcgbDJOb2RlLCBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBjYjIp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBsZXZlbDEv\nbGV2ZWwyIHBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGwy\nTm9kZVBhdGggPSBsZWRnZXJSb290UGF0aCArICIvIiArIGwxTm9kZSArICIv\nIiArIGwyTm9kZTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2Vz\ncyBlYWNoIGxlZGdlcgogICAgICAgICAgICAgICAgICAgICAgICAvLyBhZnRl\nciBhbGwgbGVkZ2VyIGFyZSBwcm9jZXNzZWQsIGNiMiB3aWxsIGJlIGNhbGwg\ndG8gY29udGludWUgcHJvY2Vzc2luZyBuZXh0IGxldmVsMiBub2RlCiAgICAg\nICAgICAgICAgICAgICAgICAgIGFzeW5jUHJvY2Vzc0xlZGdlcnNJblNpbmds\nZU5vZGUobDJOb2RlUGF0aCwgcHJvY2Vzc29yLCBjYjIsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIGNiMSwgY29udGV4dCwgc3Vj\nY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAgICAgICAgICB9CiAgICAgICAgfSwg\nZmluYWxDYiwgY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAg\nfQoKICAgIC8qKgogICAgICogUHJvY2VzcyBoYXNoIG5vZGVzIGluIGEgZ2l2\nZW4gcGF0aAogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXN5bmNQcm9jZXNz\nTGV2ZWxOb2RlcygKICAgICAgICBmaW5hbCBTdHJpbmcgcGF0aCwgZmluYWwg\nUHJvY2Vzc29yPFN0cmluZz4gcHJvY2Vzc29yLAogICAgICAgIGZpbmFsIEFz\neW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGZpbmFsQ2IsIGZpbmFsIE9iamVj\ndCBjb250ZXh0LAogICAgICAgIGZpbmFsIGludCBzdWNjZXNzUmMsIGZpbmFs\nIGludCBmYWlsdXJlUmMpIHsKICAgICAgICB6ay5zeW5jKHBhdGgsIG5ldyBB\nc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQo\naW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCkgewogICAgICAgICAg\nICAgICAgaWYgKHJjICE9IENvZGUuT0suaW50VmFsdWUoKSkgewogICAgICAg\nICAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3Igc3luY2luZyBwYXRoICIg\nKyBwYXRoICsgIiB3aGVuIGdldHRpbmcgaXRzIGNoaWRyZW46ICIsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIEtlZXBlckV4Y2VwdGlvbi5jcmVh\ndGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0KHJjKSwgcGF0aCkpOwogICAg\nICAgICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jlc3VsdChmYWlsdXJl\nUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB6ay5nZXRD\naGlsZHJlbihwYXRoLCBmYWxzZSwgbmV3IEFzeW5jQ2FsbGJhY2suQ2hpbGRy\nZW5DYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNzUmVzdWx0\nKGludCByYywgU3RyaW5nIHBhdGgsIE9iamVjdCBjdHgsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0PFN0cmlu\nZz4gbGV2ZWxOb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\ncmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHBvbGxpbmcgaGFzaCBub2Rl\ncyBvZiAiICsgcGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3JlYXRlKEtlZXBlckV4Y2VwdGlv\nbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jlc3VsdChmYWlsdXJlUmMsIG51bGws\nIGNvbnRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgICAgIEFzeW5jTGlzdFByb2Nlc3NvcjxTdHJpbmc+IGxpc3RQcm9jZXNz\nb3IgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBc3lu\nY0xpc3RQcm9jZXNzb3I8U3RyaW5nPihzY2hlZHVsZXIpOwogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBwcm9jZXNzIGl0cyBjaGlsZHJlbgogICAgICAg\nICAgICAgICAgICAgICAgICBsaXN0UHJvY2Vzc29yLnByb2Nlc3MobGV2ZWxO\nb2RlcywgcHJvY2Vzc29yLCBmaW5hbENiLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dCwgc3VjY2Vzc1Jj\nLCBmYWlsdXJlUmMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0sIG51bGwpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgbnVs\nbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcm9jZXNzIGxpc3Qgb25lIGJ5\nIG9uZSBpbiBhc3luY2hyb25pemUgd2F5LiBQcm9jZXNzIHdpbGwgYmUgc3Rv\ncHBlZCBpbW1lZGlhdGVseQogICAgICogd2hlbiBlcnJvciBvY2N1cnJlZC4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQXN5bmNMaXN0UHJv\nY2Vzc29yPFQ+IHsKICAgICAgICAvLyB1c2UgdGhpcyB0byBwcmV2ZW50IGxv\nbmcgc3RhY2sgY2hhaW5zIGZyb20gYnVpbGRpbmcgdXAgaW4gY2FsbGJhY2tz\nCiAgICAgICAgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcjsK\nCiAgICAgICAgLyoqCiAgICAgICAgICogQ29uc3RydWN0b3IKICAgICAgICAg\nKgogICAgICAgICAqIEBwYXJhbSBzY2hlZHVsZXIKICAgICAgICAgKiAgICAg\nICAgICBFeGVjdXRvciB1c2VkIHRvIHByZXZlbnQgbG9uZyBzdGFjayBjaGFp\nbnMKICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgQXN5bmNMaXN0UHJvY2Vz\nc29yKFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hlZHVsZXIpIHsKICAg\nICAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBQcm9jZXNzIGxpc3Qgb2YgaXRl\nbXMKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSBkYXRhCiAgICAgICAg\nICogICAgICAgICAgTGlzdCBvZiBkYXRhIHRvIHByb2Nlc3MKICAgICAgICAg\nKiBAcGFyYW0gcHJvY2Vzc29yCiAgICAgICAgICogICAgICAgICAgQ2FsbGJh\nY2sgdG8gcHJvY2VzcyBlbGVtZW50IG9mIGxpc3Qgd2hlbiBzdWNjZXNzCiAg\nICAgICAgICogQHBhcmFtIGZpbmFsQ2IKICAgICAgICAgKiAgICAgICAgICBG\naW5hbCBjYWxsYmFjayB0byBiZSBjYWxsZWQgYWZ0ZXIgYWxsIGVsZW1lbnRz\nIGluIHRoZSBsaXN0IGFyZSBwcm9jZXNzZWQKICAgICAgICAgKiBAcGFyYW0g\nY29udHh0CiAgICAgICAgICogICAgICAgICAgQ29udGV4dCBvZiBmaW5hbCBj\nYWxsYmFjawogICAgICAgICAqIEBwYXJhbSBzdWNjZXNzUmMKICAgICAgICAg\nKiAgICAgICAgICBSQyBwYXNzZWQgdG8gZmluYWwgY2FsbGJhY2sgb24gc3Vj\nY2VzcwogICAgICAgICAqIEBwYXJhbSBmYWlsdXJlUmMKICAgICAgICAgKiAg\nICAgICAgICBSQyBwYXNzZWQgdG8gZmluYWwgY2FsbGJhY2sgb24gZmFpbHVy\nZQogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3MoZmlu\nYWwgTGlzdDxUPiBkYXRhLCBmaW5hbCBQcm9jZXNzb3I8VD4gcHJvY2Vzc29y\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgQXN5bmNDYWxs\nYmFjay5Wb2lkQ2FsbGJhY2sgZmluYWxDYiwgZmluYWwgT2JqZWN0IGNvbnRl\neHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBpbnQgc3Vj\nY2Vzc1JjLCBmaW5hbCBpbnQgZmFpbHVyZVJjKSB7CiAgICAgICAgICAgIGlm\nIChkYXRhID09IG51bGwgfHwgZGF0YS5zaXplKCkgPT0gMCkgewogICAgICAg\nICAgICAgICAgZmluYWxDYi5wcm9jZXNzUmVzdWx0KHN1Y2Nlc3NSYywgbnVs\nbCwgY29udGV4dCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgZmluYWwgaW50IHNpemUgPSBkYXRhLnNpemUo\nKTsKICAgICAgICAgICAgZmluYWwgQXRvbWljSW50ZWdlciBjdXJyZW50ID0g\nbmV3IEF0b21pY0ludGVnZXIoMCk7CiAgICAgICAgICAgIEFzeW5jQ2FsbGJh\nY2suVm9pZENhbGxiYWNrIHN0dWJDYWxsYmFjayA9IG5ldyBBc3luY0NhbGxi\nYWNrLlZvaWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jlc3VsdChp\nbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHJjICE9IHN1Y2Nlc3NSYykgewogICAgICAgICAgICAg\nICAgICAgICAgICAvLyB0ZXJtaW5hbCBpbW1lZGlhdGVseQogICAgICAgICAg\nICAgICAgICAgICAgICBmaW5hbENiLnByb2Nlc3NSZXN1bHQoZmFpbHVyZVJj\nLCBudWxsLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAvLyBwcm9jZXNzIG5leHQgZWxlbWVudAogICAgICAgICAgICAgICAgICAg\nIGludCBuZXh0ID0gY3VycmVudC5pbmNyZW1lbnRBbmRHZXQoKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAobmV4dCA+PSBzaXplKSB7IC8vIHJlYWNoIHRo\nZSBlbmQgb2YgbGlzdAogICAgICAgICAgICAgICAgICAgICAgICBmaW5hbENi\nLnByb2Nlc3NSZXN1bHQoc3VjY2Vzc1JjLCBudWxsLCBjb250ZXh0KTsKICAg\nICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICBmaW5hbCBUIGRhdGFUb1Byb2Nl\nc3MgPSBkYXRhLmdldChuZXh0KTsKICAgICAgICAgICAgICAgICAgICBmaW5h\nbCBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBzdHViID0gdGhpczsKICAg\nICAgICAgICAgICAgICAgICBzY2hlZHVsZXIuc3VibWl0KG5ldyBSdW5uYWJs\nZSgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgICAgICAgICAgICAgICAgIHB1YmxpYyBmaW5hbCB2b2lkIHJ1bigpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3Nvci5wcm9jZXNz\nKGRhdGFUb1Byb2Nlc3MsIHN0dWIpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIFQgZmlyc3RFbGVtZW50ID0g\nZGF0YS5nZXQoMCk7CiAgICAgICAgICAgIHByb2Nlc3Nvci5wcm9jZXNzKGZp\ncnN0RWxlbWVudCwgc3R1YkNhbGxiYWNrKTsKICAgICAgICB9CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc1NwZWNpYWxa\nbm9kZShTdHJpbmcgem5vZGUpIHsKICAgICAgICByZXR1cm4gSURHRU5fWk5P\nREUuZXF1YWxzKHpub2RlKSB8fCBzdXBlci5pc1NwZWNpYWxabm9kZSh6bm9k\nZSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgTGVkZ2VyUmFu\nZ2VJdGVyYXRvciBnZXRMZWRnZXJSYW5nZXMoKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBIaWVyYXJjaGljYWxMZWRnZXJSYW5nZUl0ZXJhdG9yKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJdGVyYXRvciB0aHJvdWdoIGVhY2ggbWV0YWRh\ndGEgYnVja2V0IHdpdGggaGllcmFyY2hpY2FsIG1vZGUKICAgICAqLwogICAg\ncHJpdmF0ZSBjbGFzcyBIaWVyYXJjaGljYWxMZWRnZXJSYW5nZUl0ZXJhdG9y\nIGltcGxlbWVudHMgTGVkZ2VyUmFuZ2VJdGVyYXRvciB7CiAgICAgICAgcHJp\ndmF0ZSBJdGVyYXRvcjxTdHJpbmc+IGwxTm9kZXNJdGVyID0gbnVsbDsKICAg\nICAgICBwcml2YXRlIEl0ZXJhdG9yPFN0cmluZz4gbDJOb2Rlc0l0ZXIgPSBu\ndWxsOwogICAgICAgIHByaXZhdGUgU3RyaW5nIGN1ckwxTm9kZXMgPSAiIjsK\nICAgICAgICBwcml2YXRlIGJvb2xlYW4gaXRlcmF0b3JEb25lID0gZmFsc2U7\nCiAgICAgICAgcHJpdmF0ZSBMZWRnZXJSYW5nZSBuZXh0UmFuZ2UgPSBudWxs\nOwoKICAgICAgICAvKioKICAgICAgICAgKiBpdGVyYXRlIG5leHQgbGV2ZWwx\nIHpub2RlCiAgICAgICAgICoKICAgICAgICAgKiBAcmV0dXJuIGZhbHNlIGlm\nIGhhdmUgdmlzaXRlZCBhbGwgbGV2ZWwxIG5vZGVzCiAgICAgICAgICogQHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbi9LZWVwZXJFeGNlcHRpb24gaWYg\nZXJyb3Igb2NjdXJzIHJlYWRpbmcgem9va2VlcGVyIGNoaWxkcmVuCiAgICAg\nICAgICovCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIG5leHRMMU5vZGUoKSB0\naHJvd3MgS2VlcGVyRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIGwyTm9kZXNJdGVyID0gbnVsbDsKICAgICAgICAgICAg\nd2hpbGUgKGwyTm9kZXNJdGVyID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIGlmIChsMU5vZGVzSXRlci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAg\nICAgICBjdXJMMU5vZGVzID0gbDFOb2Rlc0l0ZXIubmV4dCgpOwogICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAo\naXNTcGVjaWFsWm5vZGUoY3VyTDFOb2RlcykpIHsKICAgICAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIExpc3Q8U3RyaW5nPiBsMk5vZGVzID0gemsuZ2V0Q2hpbGRyZW4obGVk\nZ2VyUm9vdFBhdGggKyAiLyIgKyBjdXJMMU5vZGVzLCBudWxsKTsKICAgICAg\nICAgICAgICAgIENvbGxlY3Rpb25zLnNvcnQobDJOb2Rlcyk7CiAgICAgICAg\nICAgICAgICBsMk5vZGVzSXRlciA9IGwyTm9kZXMuaXRlcmF0b3IoKTsKICAg\nICAgICAgICAgICAgIGlmICghbDJOb2Rlc0l0ZXIuaGFzTmV4dCgpKSB7CiAg\nICAgICAgICAgICAgICAgICAgbDJOb2Rlc0l0ZXIgPSBudWxsOwogICAgICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nCiAgICAgICAgc3luY2hyb25pemVkIHByaXZhdGUgdm9pZCBwcmVsb2FkKCkg\ndGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgd2hpbGUgKG5leHRS\nYW5nZSA9PSBudWxsICYmICFpdGVyYXRvckRvbmUpIHsKICAgICAgICAgICAg\nICAgIGJvb2xlYW4gaGFzTW9yZUVsZW1lbnRzID0gZmFsc2U7CiAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGlmIChsMU5vZGVz\nSXRlciA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGwxTm9k\nZXNJdGVyID0gemsuZ2V0Q2hpbGRyZW4obGVkZ2VyUm9vdFBhdGgsIG51bGwp\nLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhhc01vcmVF\nbGVtZW50cyA9IG5leHRMMU5vZGUoKTsKICAgICAgICAgICAgICAgICAgICB9\nIGVsc2UgaWYgKGwyTm9kZXNJdGVyID09IG51bGwgfHwgIWwyTm9kZXNJdGVy\nLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBoYXNNb3Jl\nRWxlbWVudHMgPSBuZXh0TDFOb2RlKCk7CiAgICAgICAgICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaGFzTW9yZUVsZW1l\nbnRzID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChLZWVwZXJFeGNlcHRpb24ga2UpIHsKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkVycm9yIHByZWxv\nYWRpbmcgbmV4dCByYW5nZSIsIGtlKTsKICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGllKSB7CiAgICAgICAgICAgICAg\nICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5pbnRlcnJ1cHQoKTsKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkludGVy\ncnVwdGVkIHdoaWxlIHByZWxvYWRpbmciLCBpZSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBpZiAoaGFzTW9yZUVsZW1lbnRzKSB7CiAg\nICAgICAgICAgICAgICAgICAgbmV4dFJhbmdlID0gZ2V0TGVkZ2VyUmFuZ2VC\neUxldmVsKGN1ckwxTm9kZXMsIGwyTm9kZXNJdGVyLm5leHQoKSk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKG5leHRSYW5nZS5zaXplKCkgPT0gMCkgewog\nICAgICAgICAgICAgICAgICAgICAgICBuZXh0UmFuZ2UgPSBudWxsOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgaXRlcmF0b3JEb25lID0gdHJ1ZTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgc3luY2hyb25pemVkIHB1YmxpYyBib29sZWFu\nIGhhc05leHQoKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBw\ncmVsb2FkKCk7CiAgICAgICAgICAgIHJldHVybiBuZXh0UmFuZ2UgIT0gbnVs\nbCAmJiAhaXRlcmF0b3JEb25lOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgc3luY2hyb25pemVkIHB1YmxpYyBMZWRnZXJSYW5nZSBu\nZXh0KCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKCFo\nYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb1N1Y2hF\nbGVtZW50RXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nTGVkZ2VyUmFuZ2UgciA9IG5leHRSYW5nZTsKICAgICAgICAgICAgbmV4dFJh\nbmdlID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfQoK\nICAgICAgICAvKioKICAgICAgICAgKiBHZXQgYSBzaW5nbGUgbm9kZSBsZXZl\nbDEvbGV2ZWwyCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gbGV2ZWwx\nCiAgICAgICAgICogICAgICAgICAgMXN0IGxldmVsIG5vZGUgbmFtZQogICAg\nICAgICAqIEBwYXJhbSBsZXZlbDIKICAgICAgICAgKiAgICAgICAgICAybmQg\nbGV2ZWwgbm9kZSBuYW1lCiAgICAgICAgICogQHRocm93cyBJT0V4Y2VwdGlv\nbgogICAgICAgICAqLwogICAgICAgIExlZGdlclJhbmdlIGdldExlZGdlclJh\nbmdlQnlMZXZlbChmaW5hbCBTdHJpbmcgbGV2ZWwxLCBmaW5hbCBTdHJpbmcg\nbGV2ZWwyKQogICAgICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBub2RlQnVpbGRlciA9IG5ldyBT\ndHJpbmdCdWlsZGVyKCk7CiAgICAgICAgICAgIG5vZGVCdWlsZGVyLmFwcGVu\nZChsZWRnZXJSb290UGF0aCkuYXBwZW5kKCIvIikKICAgICAgICAgICAgICAg\nICAgICAgICAuYXBwZW5kKGxldmVsMSkuYXBwZW5kKCIvIikuYXBwZW5kKGxl\ndmVsMik7CiAgICAgICAgICAgIFN0cmluZyBub2RlUGF0aCA9IG5vZGVCdWls\nZGVyLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIExpc3Q8U3RyaW5nPiBsZWRn\nZXJOb2RlcyA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBsZWRnZXJOb2RlcyA9IFprVXRpbHMuZ2V0Q2hpbGRyZW5JblNpbmds\nZU5vZGUoemssIG5vZGVQYXRoKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IElPRXhjZXB0aW9uKCJFcnJvciB3aGVuIGdldCBjaGlsZCBub2RlcyBm\ncm9tIHprIiwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgTmF2aWdh\nYmxlU2V0PExvbmc+IHprQWN0aXZlTGVkZ2VycyA9IGxlZGdlckxpc3RUb1Nl\ndChsZWRnZXJOb2Rlcywgbm9kZVBhdGgpOwogICAgICAgICAgICBpZiAoTE9H\nLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIExPRy5kZWJ1\nZygiQWxsIGFjdGl2ZSBsZWRnZXJzIGZyb20gWksgZm9yIGhhc2ggbm9kZSAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgKyBsZXZlbDEgKyAiLyIgKyBs\nZXZlbDIgKyAiIDogIiArIHprQWN0aXZlTGVkZ2Vycyk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHJldHVybiBuZXcgTGVkZ2VyUmFuZ2UoemtBY3Rp\ndmVMZWRnZXJzLnN1YlNldChnZXRTdGFydExlZGdlcklkQnlMZXZlbChsZXZl\nbDEsIGxldmVsMiksIHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRFbmRMZWRnZXJJ\nZEJ5TGV2ZWwobGV2ZWwxLCBsZXZlbDIpLCB0cnVlKSk7CiAgICAgICAgfQog\nICAgfQp9Cg==\n","encoding":"base64"}

