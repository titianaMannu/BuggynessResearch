{"sha":"e9596fec2da9bf81b2d05a5199f193b4bc355d01","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTk1OTZmZWMyZGE5YmY4MWIyZDA1YTUxOTlmMTkzYjRiYzM1NWQwMQ==","size":9572,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e9596fec2da9bf81b2d05a5199f193b4bc355d01","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLklPRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuTWFsZm9ybWVkVVJMRXhjZXB0aW9u\nOwoKaW1wb3J0IGNvbS5nb29nbGUuY29tbW9uLmFubm90YXRpb25zLlZpc2li\nbGVGb3JUZXN0aW5nOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5i\nb29raWUuQm9va2llOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJv\nb2tpZS5FeGl0Q29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucmVwbGljYXRpb24uUmVwbGljYXRpb25FeGNlcHRpb24uQ29t\ncGF0aWJpbGl0eUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5yZXBsaWNhdGlvbi5SZXBsaWNhdGlvbkV4Y2VwdGlvbi5VbmF2YWls\nYWJsZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51\ndGlsLlprVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRp\nbC5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci56\nb29rZWVwZXIuWm9vS2VlcGVyV2F0Y2hlckJhc2U7CmltcG9ydCBvcmcuYXBh\nY2hlLmNvbW1vbnMuY2xpLkJhc2ljUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5jb21tb25zLmNsaS5Db21tYW5kTGluZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5jbGkuSGVscEZvcm1hdHRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5jbGkuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5jbGkuUGFyc2VFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMuY29uZmlndXJhdGlvbi5Db25maWd1cmF0aW9uRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlZEV2ZW50OwppbXBvcnQg\nb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCi8qKgogKiBD\nbGFzcyB0byBzdGFydC9zdG9wIHRoZSBBdXRvUmVjb3ZlcnkgZGFlbW9ucyBB\ndWRpdG9yIGFuZCBSZXBsaWNhdGlvbldvcmtlcgogKi8KcHVibGljIGNsYXNz\nIEF1dG9SZWNvdmVyeU1haW4gewogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkKICAgICAgICAgICAgLmdldExv\nZ2dlcihBdXRvUmVjb3ZlcnlNYWluLmNsYXNzKTsKCiAgICBwcml2YXRlIFNl\ncnZlckNvbmZpZ3VyYXRpb24gY29uZjsKICAgIFpvb0tlZXBlciB6azsKICAg\nIEF1ZGl0b3JFbGVjdG9yIGF1ZGl0b3JFbGVjdG9yOwogICAgUmVwbGljYXRp\nb25Xb3JrZXIgcmVwbGljYXRpb25Xb3JrZXI7CiAgICBwcml2YXRlIEF1dG9S\nZWNvdmVyeURlYXRoV2F0Y2hlciBkZWF0aFdhdGNoZXI7CiAgICBwcml2YXRl\nIGludCBleGl0Q29kZTsKICAgIHByaXZhdGUgdm9sYXRpbGUgYm9vbGVhbiBz\naHV0dGluZ0Rvd24gPSBmYWxzZTsKICAgIHByaXZhdGUgdm9sYXRpbGUgYm9v\nbGVhbiBydW5uaW5nID0gZmFsc2U7CgogICAgcHVibGljIEF1dG9SZWNvdmVy\neU1haW4oU2VydmVyQ29uZmlndXJhdGlvbiBjb25mKSB0aHJvd3MgSU9FeGNl\ncHRpb24sCiAgICAgICAgICAgIEludGVycnVwdGVkRXhjZXB0aW9uLCBLZWVw\nZXJFeGNlcHRpb24sIFVuYXZhaWxhYmxlRXhjZXB0aW9uLAogICAgICAgICAg\nICBDb21wYXRpYmlsaXR5RXhjZXB0aW9uIHsKICAgICAgICB0aGlzLmNvbmYg\nPSBjb25mOwogICAgICAgIFpvb0tlZXBlcldhdGNoZXJCYXNlIHcgPSBuZXcg\nWm9vS2VlcGVyV2F0Y2hlckJhc2UoY29uZi5nZXRaa1RpbWVvdXQoKSkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\ncHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICAgICAgICAg\nIC8vIENoZWNrIGZvciBleHBpcmVkIGNvbm5lY3Rpb24uCiAgICAgICAgICAg\nICAgICBpZiAoZXZlbnQuZ2V0U3RhdGUoKS5lcXVhbHMoV2F0Y2hlci5FdmVu\ndC5LZWVwZXJTdGF0ZS5FeHBpcmVkKSkgewogICAgICAgICAgICAgICAgICAg\nIExPRy5lcnJvcigiWksgY2xpZW50IGNvbm5lY3Rpb24gdG8gdGhlIgogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyAiIFpLIHNlcnZlciBoYXMgZXhw\naXJlZCEiKTsKICAgICAgICAgICAgICAgICAgICBzaHV0ZG93bihFeGl0Q29k\nZS5aS19FWFBJUkVEKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgc3VwZXIucHJvY2VzcyhldmVudCk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHpr\nID0gWmtVdGlscy5jcmVhdGVDb25uZWN0ZWRab29rZWVwZXJDbGllbnQoY29u\nZi5nZXRaa1NlcnZlcnMoKSwgdyk7CiAgICAgICAgYXVkaXRvckVsZWN0b3Ig\nPSBuZXcgQXVkaXRvckVsZWN0b3IoCiAgICAgICAgICAgICAgICBTdHJpbmdV\ndGlscy5hZGRyVG9TdHJpbmcoQm9va2llLmdldEJvb2tpZUFkZHJlc3MoY29u\nZikpLCBjb25mLCB6ayk7CiAgICAgICAgcmVwbGljYXRpb25Xb3JrZXIgPSBu\nZXcgUmVwbGljYXRpb25Xb3JrZXIoemssIGNvbmYsCiAgICAgICAgICAgICAg\nICBCb29raWUuZ2V0Qm9va2llQWRkcmVzcyhjb25mKSk7CiAgICAgICAgZGVh\ndGhXYXRjaGVyID0gbmV3IEF1dG9SZWNvdmVyeURlYXRoV2F0Y2hlcih0aGlz\nKTsKICAgIH0KCiAgICAvKgogICAgICogU3RhcnQgZGFlbW9ucwogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzdGFydCgpIHRocm93cyBVbmF2YWlsYWJsZUV4\nY2VwdGlvbiB7CiAgICAgICAgYXVkaXRvckVsZWN0b3Iuc3RhcnQoKTsKICAg\nICAgICByZXBsaWNhdGlvbldvcmtlci5zdGFydCgpOwogICAgICAgIGRlYXRo\nV2F0Y2hlci5zdGFydCgpOwogICAgICAgIHJ1bm5pbmcgPSB0cnVlOwogICAg\nfQoKICAgIC8qCiAgICAgKiBXYWl0cyB0aWxsIGFsbCBkYWVtb25zIGpvaW5z\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGpvaW4oKSB0aHJvd3MgSW50ZXJy\ndXB0ZWRFeGNlcHRpb24gewogICAgICAgIGRlYXRoV2F0Y2hlci5qb2luKCk7\nCiAgICB9CgogICAgLyoKICAgICAqIFNodXRkb3duIGFsbCBkYWVtb25zIGdy\nYWNlZnVsbHkKICAgICAqLwogICAgcHVibGljIHZvaWQgc2h1dGRvd24oKSB7\nCiAgICAgICAgc2h1dGRvd24oRXhpdENvZGUuT0spOwogICAgfQoKICAgIHBy\naXZhdGUgdm9pZCBzaHV0ZG93bihpbnQgZXhpdENvZGUpIHsKICAgICAgICBp\nZiAoc2h1dHRpbmdEb3duKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICB9CiAgICAgICAgc2h1dHRpbmdEb3duID0gdHJ1ZTsKICAgICAgICBydW5u\naW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5leGl0Q29kZSA9IGV4aXRDb2Rl\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGRlYXRoV2F0Y2hlci5pbnRl\ncnJ1cHQoKTsKICAgICAgICAgICAgZGVhdGhXYXRjaGVyLmpvaW4oKTsKCiAg\nICAgICAgICAgIGF1ZGl0b3JFbGVjdG9yLnNodXRkb3duKCk7CiAgICAgICAg\nfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICBUaHJlYWQuY3VycmVudFRocmVhZCgpLmludGVycnVwdCgpOwogICAgICAg\nICAgICBMT0cud2FybigiSW50ZXJydXB0ZWQgc2h1dHRpbmcgZG93biBhdXRv\nIHJlY292ZXJ5IiwgZSk7CiAgICAgICAgfQoKICAgICAgICByZXBsaWNhdGlv\nbldvcmtlci5zaHV0ZG93bigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHprLmNsb3NlKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgp\nLmludGVycnVwdCgpOwogICAgICAgICAgICBMT0cud2FybigiSW50ZXJydXB0\nZWQgc2h1dHRpbmcgZG93biBhdXRvIHJlY292ZXJ5IiwgZSk7CiAgICAgICAg\nfQogICAgfQoKICAgIHByaXZhdGUgaW50IGdldEV4aXRDb2RlKCkgewogICAg\nICAgIHJldHVybiBleGl0Q29kZTsKICAgIH0KCiAgICBAVmlzaWJsZUZvclRl\nc3RpbmcKICAgIHB1YmxpYyBBdWRpdG9yIGdldEF1ZGl0b3IoKSB7CiAgICAg\nICAgcmV0dXJuIGF1ZGl0b3JFbGVjdG9yLmdldEF1ZGl0b3IoKTsKICAgIH0K\nCiAgICAvKiogSXMgYXV0by1yZWNvdmVyeSBzZXJ2aWNlIHJ1bm5pbmc/ICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc0F1dG9SZWNvdmVyeVJ1bm5pbmcoKSB7\nCiAgICAgICAgcmV0dXJuIHJ1bm5pbmc7CiAgICB9CgogICAgLyoKICAgICAq\nIERlYXRoV2F0Y2hlciBmb3IgQXV0b1JlY292ZXJ5IGRhZW1vbnMuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIEF1dG9SZWNvdmVyeURlYXRo\nV2F0Y2hlciBleHRlbmRzIFRocmVhZCB7CiAgICAgICAgcHJpdmF0ZSBpbnQg\nd2F0Y2hJbnRlcnZhbDsKICAgICAgICBwcml2YXRlIEF1dG9SZWNvdmVyeU1h\naW4gYXV0b1JlY292ZXJ5TWFpbjsKCiAgICAgICAgcHVibGljIEF1dG9SZWNv\ndmVyeURlYXRoV2F0Y2hlcihBdXRvUmVjb3ZlcnlNYWluIGF1dG9SZWNvdmVy\neU1haW4pIHsKICAgICAgICAgICAgc3VwZXIoIkF1dG9SZWNvdmVyeURlYXRo\nV2F0Y2hlci0iCiAgICAgICAgICAgICAgICAgICAgKyBhdXRvUmVjb3ZlcnlN\nYWluLmNvbmYuZ2V0Qm9va2llUG9ydCgpKTsKICAgICAgICAgICAgdGhpcy5h\ndXRvUmVjb3ZlcnlNYWluID0gYXV0b1JlY292ZXJ5TWFpbjsKICAgICAgICAg\nICAgd2F0Y2hJbnRlcnZhbCA9IGF1dG9SZWNvdmVyeU1haW4uY29uZi5nZXRE\nZWF0aFdhdGNoSW50ZXJ2YWwoKTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAg\nd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgVGhyZWFkLnNsZWVwKHdhdGNoSW50ZXJ2YWwpOwogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUp\nIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIC8vIElmIGFueSBvbmUgc2VydmljZSBub3Qg\ncnVubmluZywgdGhlbiBzaHV0ZG93biBwZWVyLgogICAgICAgICAgICAgICAg\naWYgKCFhdXRvUmVjb3ZlcnlNYWluLmF1ZGl0b3JFbGVjdG9yLmlzUnVubmlu\nZygpCiAgICAgICAgICAgICAgICAgICAgfHwgIWF1dG9SZWNvdmVyeU1haW4u\ncmVwbGljYXRpb25Xb3JrZXIuaXNSdW5uaW5nKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBhdXRvUmVjb3ZlcnlNYWluLnNodXRkb3duKEV4aXRDb2RlLlNF\nUlZFUl9FWENFUFRJT04pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE9wdGlvbnMgb3B0cyA9IG5l\ndyBPcHRpb25zKCk7CiAgICBzdGF0aWMgewogICAgICAgIG9wdHMuYWRkT3B0\naW9uKCJjIiwgImNvbmYiLCB0cnVlLCAiQm9va2llIHNlcnZlciBjb25maWd1\ncmF0aW9uIik7CiAgICAgICAgb3B0cy5hZGRPcHRpb24oImgiLCAiaGVscCIs\nIGZhbHNlLCAiUHJpbnQgaGVscCBtZXNzYWdlIik7CiAgICB9CgogICAgLyoK\nICAgICAqIFByaW50IHVzYWdlCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIHZvaWQgcHJpbnRVc2FnZSgpIHsKICAgICAgICBIZWxwRm9ybWF0dGVyIGhm\nID0gbmV3IEhlbHBGb3JtYXR0ZXIoKTsKICAgICAgICBoZi5wcmludEhlbHAo\nIkF1dG9SZWNvdmVyeU1haW4gW29wdGlvbnNdXG4iLCBvcHRzKTsKICAgIH0K\nCiAgICAvKgogICAgICogbG9hZCBjb25maWd1cmF0aW9ucyBmcm9tIGZpbGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgbG9hZENvbmZGaWxl\nKFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5nIGNvbmZGaWxlKQog\nICAgICAgICAgICB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIHsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBjb25mLmxvYWRDb25mKG5ldyBG\naWxlKGNvbmZGaWxlKS50b1VSSSgpLnRvVVJMKCkpOwogICAgICAgIH0gY2F0\nY2ggKE1hbGZvcm1lZFVSTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExP\nRy5lcnJvcigiQ291bGQgbm90IG9wZW4gY29uZmlndXJhdGlvbiBmaWxlOiAi\nICsgY29uZkZpbGUsIGUpOwogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdh\nbEFyZ3VtZW50RXhjZXB0aW9uKCk7CiAgICAgICAgfSBjYXRjaCAoQ29uZmln\ndXJhdGlvbkV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigi\nTWFsZm9ybWVkIGNvbmZpZ3VyYXRpb24gZmlsZTogIiArIGNvbmZGaWxlLCBl\nKTsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw\ndGlvbigpOwogICAgICAgIH0KICAgICAgICBMT0cuaW5mbygiVXNpbmcgY29u\nZmlndXJhdGlvbiBmaWxlICIgKyBjb25mRmlsZSk7CiAgICB9CgogICAgLyoK\nICAgICAqIFBhcnNlIGNvbnNvbGUgYXJncwogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBTZXJ2ZXJDb25maWd1cmF0aW9uIHBhcnNlQXJncyhTdHJpbmdb\nXSBhcmdzKQogICAgICAgICAgICB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhj\nZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBCYXNpY1BhcnNl\nciBwYXJzZXIgPSBuZXcgQmFzaWNQYXJzZXIoKTsKICAgICAgICAgICAgQ29t\nbWFuZExpbmUgY21kTGluZSA9IHBhcnNlci5wYXJzZShvcHRzLCBhcmdzKTsK\nCiAgICAgICAgICAgIGlmIChjbWRMaW5lLmhhc09wdGlvbignaCcpKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0\naW9uKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFNlcnZlckNvbmZp\nZ3VyYXRpb24gY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgICAgIFN0cmluZ1tdIGxlZnRBcmdzID0gY21kTGluZS5nZXRBcmdz\nKCk7CgogICAgICAgICAgICBpZiAoY21kTGluZS5oYXNPcHRpb24oJ2MnKSkg\newogICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gbGVmdEFyZ3MgJiYgbGVm\ndEFyZ3MubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIFN0cmluZyBjb25mRmlsZSA9IGNtZExp\nbmUuZ2V0T3B0aW9uVmFsdWUoImMiKTsKICAgICAgICAgICAgICAgIGxvYWRD\nb25mRmlsZShjb25mLCBjb25mRmlsZSk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIGlmIChudWxsICE9IGxlZnRBcmdzICYmIGxlZnRBcmdzLmxlbmd0\naCA+IDApIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJn\ndW1lbnRFeGNlcHRpb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBy\nZXR1cm4gY29uZjsKICAgICAgICB9IGNhdGNoIChQYXJzZUV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNl\ncHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMg\ndm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBTZXJ2ZXJDb25m\naWd1cmF0aW9uIGNvbmYgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGNvbmYgPSBwYXJzZUFyZ3MoYXJncyk7CiAgICAgICAgfSBjYXRjaCAo\nSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlhZSkgewogICAgICAgICAgICBM\nT0cuZXJyb3IoIkVycm9yIHBhcnNpbmcgY29tbWFuZCBsaW5lIGFyZ3VtZW50\ncyA6ICIsIGlhZSk7CiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihp\nYWUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgcHJpbnRVc2FnZSgpOwog\nICAgICAgICAgICBTeXN0ZW0uZXhpdChFeGl0Q29kZS5JTlZBTElEX0NPTkYp\nOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmluYWwg\nQXV0b1JlY292ZXJ5TWFpbiBhdXRvUmVjb3ZlcnlNYWluID0gbmV3IEF1dG9S\nZWNvdmVyeU1haW4oY29uZik7CiAgICAgICAgICAgIGF1dG9SZWNvdmVyeU1h\naW4uc3RhcnQoKTsKICAgICAgICAgICAgUnVudGltZS5nZXRSdW50aW1lKCku\nYWRkU2h1dGRvd25Ib29rKG5ldyBUaHJlYWQoKSB7CiAgICAgICAgICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigp\nIHsKICAgICAgICAgICAgICAgICAgICBhdXRvUmVjb3ZlcnlNYWluLnNodXRk\nb3duKCk7CiAgICAgICAgICAgICAgICAgICAgTE9HLmluZm8oIlNodXRkb3du\nIEF1dG9SZWNvdmVyeU1haW4gc3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBMT0cuaW5mbygi\nUmVnaXN0ZXIgc2h1dGRvd24gaG9vayBzdWNjZXNzZnVsbHkiKTsKICAgICAg\nICAgICAgYXV0b1JlY292ZXJ5TWFpbi5qb2luKCk7CiAgICAgICAgICAgIFN5\nc3RlbS5leGl0KGF1dG9SZWNvdmVyeU1haW4uZ2V0RXhpdENvZGUoKSk7CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9H\nLmVycm9yKCJFeGNlcHRpb24gcnVubmluZyBBdXRvUmVjb3ZlcnlNYWluIDog\nIiwgZSk7CiAgICAgICAgICAgIFN5c3RlbS5leGl0KEV4aXRDb2RlLlNFUlZF\nUl9FWENFUFRJT04pOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

