{"sha":"e84183c06bf6fe8cf06a7859d3c4f8822536d602","node_id":"MDQ6QmxvYjE1NzU5NTY6ZTg0MTgzYzA2YmY2ZmU4Y2YwNmE3ODU5ZDNjNGY4ODIyNTM2ZDYwMg==","size":17200,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/e84183c06bf6fe8cf06a7859d3c4f8822536d602","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZTsKCmlt\ncG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmlv\nLkJ5dGVCdWZmZXI7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2\nYS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jvb2xlYW47CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5F\nbnVtZXJhdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0\nYS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RU\neXBlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9va0tl\nZXBlckNsdXN0ZXJUZXN0Q2FzZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci51dGlsLlRlc3RVdGlsczsKCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5Bc3luY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5MZWRnZXJNZXRhZGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3Mu\nR2VuZXJpY0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5MZWRnZXJNZXRh\nZGF0YUxpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2trZWVwZXJJbnRlcm5hbENhbGxiYWNrcy5Qcm9jZXNzb3I7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudmVyc2lvbmluZy5WZXJzaW9u\nOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBv\ncnQgb3JnLmp1bml0LlRlc3Q7CgovKioKICogVGhpcyBjbGFzcyB0ZXN0cyB0\naGUgZW50cnkgbG9nIGNvbXBhY3Rpb24gZnVuY3Rpb25hbGl0eS4KICovCnB1\nYmxpYyBjbGFzcyBDb21wYWN0aW9uVGVzdCBleHRlbmRzIEJvb2tLZWVwZXJD\nbHVzdGVyVGVzdENhc2UgewogICAgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dn\nZXJGYWN0b3J5LmdldExvZ2dlcihDb21wYWN0aW9uVGVzdC5jbGFzcyk7CiAg\nICBEaWdlc3RUeXBlIGRpZ2VzdFR5cGU7CgogICAgc3RhdGljIGludCBFTlRS\nWV9TSVpFID0gMTAyNDsKICAgIHN0YXRpYyBpbnQgTlVNX0JPT0tJRVMgPSAx\nOwoKICAgIGludCBudW1FbnRyaWVzOwogICAgaW50IGdjV2FpdFRpbWU7CiAg\nICBkb3VibGUgbWlub3JDb21wYWN0aW9uVGhyZXNob2xkOwogICAgZG91Ymxl\nIG1ham9yQ29tcGFjdGlvblRocmVzaG9sZDsKICAgIGxvbmcgbWlub3JDb21w\nYWN0aW9uSW50ZXJ2YWw7CiAgICBsb25nIG1ham9yQ29tcGFjdGlvbkludGVy\ndmFsOwoKICAgIFN0cmluZyBtc2c7CgogICAgcHVibGljIENvbXBhY3Rpb25U\nZXN0KCkgewogICAgICAgIHN1cGVyKE5VTV9CT09LSUVTKTsKCiAgICAgICAg\ndGhpcy5kaWdlc3RUeXBlID0gRGlnZXN0VHlwZS5DUkMzMjsKCiAgICAgICAg\nbnVtRW50cmllcyA9IDEwMDsKICAgICAgICBnY1dhaXRUaW1lID0gMTAwMDsK\nICAgICAgICBtaW5vckNvbXBhY3Rpb25UaHJlc2hvbGQgPSAwLjFmOwogICAg\nICAgIG1ham9yQ29tcGFjdGlvblRocmVzaG9sZCA9IDAuNWY7CiAgICAgICAg\nbWlub3JDb21wYWN0aW9uSW50ZXJ2YWwgPSAyICogZ2NXYWl0VGltZSAvIDEw\nMDA7CiAgICAgICAgbWFqb3JDb21wYWN0aW9uSW50ZXJ2YWwgPSA0ICogZ2NX\nYWl0VGltZSAvIDEwMDA7CgogICAgICAgIC8vIGEgZHVtbXkgbWVzc2FnZQog\nICAgICAgIFN0cmluZ0J1aWxkZXIgbXNnU0IgPSBuZXcgU3RyaW5nQnVpbGRl\ncigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgRU5UUllfU0laRTsg\naSsrKSB7CiAgICAgICAgICAgIG1zZ1NCLmFwcGVuZCgiYSIpOwogICAgICAg\nIH0KICAgICAgICBtc2cgPSBtc2dTQi50b1N0cmluZygpOwogICAgfQoKICAg\nIEBCZWZvcmUKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBTZXQgdXAgdGhlIGNv\nbmZpZ3VyYXRpb24gcHJvcGVydGllcyBuZWVkZWQuCiAgICAgICAgYmFzZUNv\nbmYuc2V0RW50cnlMb2dTaXplTGltaXQobnVtRW50cmllcyAqIEVOVFJZX1NJ\nWkUpOwogICAgICAgIGJhc2VDb25mLnNldEdjV2FpdFRpbWUoZ2NXYWl0VGlt\nZSk7CiAgICAgICAgYmFzZUNvbmYuc2V0TWlub3JDb21wYWN0aW9uVGhyZXNo\nb2xkKG1pbm9yQ29tcGFjdGlvblRocmVzaG9sZCk7CiAgICAgICAgYmFzZUNv\nbmYuc2V0TWFqb3JDb21wYWN0aW9uVGhyZXNob2xkKG1ham9yQ29tcGFjdGlv\nblRocmVzaG9sZCk7CiAgICAgICAgYmFzZUNvbmYuc2V0TWlub3JDb21wYWN0\naW9uSW50ZXJ2YWwobWlub3JDb21wYWN0aW9uSW50ZXJ2YWwpOwogICAgICAg\nIGJhc2VDb25mLnNldE1ham9yQ29tcGFjdGlvbkludGVydmFsKG1ham9yQ29t\ncGFjdGlvbkludGVydmFsKTsKCiAgICAgICAgc3VwZXIuc2V0VXAoKTsKICAg\nIH0KCiAgICBMZWRnZXJIYW5kbGVbXSBwcmVwYXJlRGF0YShpbnQgbnVtRW50\ncnlMb2dzLCBib29sZWFuIGNoYW5nZU51bSkKICAgICAgICB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICAvLyBzaW5jZSBhbiBlbnRyeSBsb2cgZmlsZSBj\nYW4gaG9sZCBhdCBtb3N0IDEwMCBlbnRyaWVzCiAgICAgICAgLy8gZmlyc3Qg\nbGVkZ2VyIHdyaXRlIDIgZW50cmllcywgd2hpY2ggaXMgbGVzcyB0aGFuIGxv\ndyB3YXRlciBtYXJrCiAgICAgICAgaW50IG51bTEgPSAyOwogICAgICAgIC8v\nIHRoaXJkIGxlZGdlciB3cml0ZSBtb3JlIHRoYW4gaGlnaCB3YXRlciBtYXJr\nIGVudHJpZXMKICAgICAgICBpbnQgbnVtMyA9IChpbnQpKG51bUVudHJpZXMg\nKiAwLjdmKTsKICAgICAgICAvLyBzZWNvbmQgbGVkZ2VyIHdyaXRlIHJlbWFp\nbmluZyBlbnRyaWVzLCB3aGljaCBpcyBoaWdoZXIgdGhhbiBsb3cgd2F0ZXIg\nbWFyawogICAgICAgIC8vIGFuZCBsZXNzIHRoYW4gaGlnaCB3YXRlciBtYXJr\nCiAgICAgICAgaW50IG51bTIgPSBudW1FbnRyaWVzIC0gbnVtMyAtIG51bTE7\nCgogICAgICAgIExlZGdlckhhbmRsZVtdIGxocyA9IG5ldyBMZWRnZXJIYW5k\nbGVbM107CiAgICAgICAgZm9yIChpbnQgaT0wOyBpPDM7ICsraSkgewogICAg\nICAgICAgICBsaHNbaV0gPSBia2MuY3JlYXRlTGVkZ2VyKE5VTV9CT09LSUVT\nLCBOVU1fQk9PS0lFUywgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CiAg\nICAgICAgfQoKICAgICAgICBmb3IgKGludCBuID0gMDsgbiA8IG51bUVudHJ5\nTG9nczsgbisrKSB7CiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwg\nbnVtMTsgaysrKSB7CiAgICAgICAgICAgICAgICBsaHNbMF0uYWRkRW50cnko\nbXNnLmdldEJ5dGVzKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZv\nciAoaW50IGsgPSAwOyBrIDwgbnVtMjsgaysrKSB7CiAgICAgICAgICAgICAg\nICBsaHNbMV0uYWRkRW50cnkobXNnLmdldEJ5dGVzKCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgbnVtMzsgaysr\nKSB7CiAgICAgICAgICAgICAgICBsaHNbMl0uYWRkRW50cnkobXNnLmdldEJ5\ndGVzKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjaGFuZ2VO\ndW0pIHsKICAgICAgICAgICAgICAgIC0tbnVtMjsKICAgICAgICAgICAgICAg\nICsrbnVtMzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0\ndXJuIGxoczsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgdmVyaWZ5TGVkZ2Vy\nKGxvbmcgbGlkLCBsb25nIHN0YXJ0RW50cnlJZCwgbG9uZyBlbmRFbnRyeUlk\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMZWRnZXJIYW5kbGUgbGgg\nPSBia2Mub3BlbkxlZGdlcihsaWQsIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVz\nKCkpOwogICAgICAgIEVudW1lcmF0aW9uPExlZGdlckVudHJ5PiBlbnRyaWVz\nID0gbGgucmVhZEVudHJpZXMoc3RhcnRFbnRyeUlkLCBlbmRFbnRyeUlkKTsK\nICAgICAgICB3aGlsZSAoZW50cmllcy5oYXNNb3JlRWxlbWVudHMoKSkgewog\nICAgICAgICAgICBMZWRnZXJFbnRyeSBlbnRyeSA9IGVudHJpZXMubmV4dEVs\nZW1lbnQoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKG1zZywgbmV3IFN0\ncmluZyhlbnRyeS5nZXRFbnRyeSgpKSk7CiAgICAgICAgfQogICAgfQoKICAg\nIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGlz\nYWJsZUNvbXBhY3Rpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAv\nLyBwcmVwYXJlIGRhdGEKICAgICAgICBMZWRnZXJIYW5kbGVbXSBsaHMgPSBw\ncmVwYXJlRGF0YSgzLCBmYWxzZSk7CgogICAgICAgIC8vIGRpc2FibGUgY29t\ncGFjdGlvbgogICAgICAgIGJhc2VDb25mLnNldE1pbm9yQ29tcGFjdGlvblRo\ncmVzaG9sZCgwLjBmKTsKICAgICAgICBiYXNlQ29uZi5zZXRNYWpvckNvbXBh\nY3Rpb25UaHJlc2hvbGQoMC4wZik7CgogICAgICAgIC8vIHJlc3RhcnQgYm9v\na2llcwogICAgICAgIHJlc3RhcnRCb29raWVzKGJhc2VDb25mKTsKCiAgICAg\nICAgLy8gcmVtb3ZlIGxlZGdlcjIgYW5kIGxlZGdlcjMKICAgICAgICAvLyBz\nbyBlbnRyeSBsb2cgMSBhbmQgMiB3b3VsZCBoYXZlIGxlZGdlcjEgZW50cmll\ncyBsZWZ0CiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNbMV0uZ2V0SWQo\nKSk7CiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNbMl0uZ2V0SWQoKSk7\nCiAgICAgICAgTE9HLmluZm8oIkZpbmlzaGVkIGRlbGV0aW5nIHRoZSBsZWRn\nZXJzIGNvbnRhaW5zIG1vc3QgZW50cmllcy4iKTsKICAgICAgICBUaHJlYWQu\nc2xlZXAoYmFzZUNvbmYuZ2V0TWFqb3JDb21wYWN0aW9uSW50ZXJ2YWwoKSAq\nIDEwMDAKICAgICAgICAgICAgICAgICAgICsgYmFzZUNvbmYuZ2V0R2NXYWl0\nVGltZSgpKTsKCiAgICAgICAgLy8gZW50cnkgbG9ncyAoWzAsMV0ubG9nKSBz\naG91bGQgbm90IGJlIGNvbXBhY3RlZC4KICAgICAgICBmb3IgKEZpbGUgbGVk\nZ2VyRGlyZWN0b3J5IDogdG1wRGlycykgewogICAgICAgICAgICBhc3NlcnRU\ncnVlKCJOb3QgRm91bmQgZW50cnkgbG9nIGZpbGUgKFswLDFdLmxvZyB0aGF0\nIHNob3VsZCBoYXZlIGJlZW4gY29tcGFjdGVkIGluIGxlZGdlckRpcmVjdG9y\neTogIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBsZWRnZXJEaXJl\nY3RvcnksIFRlc3RVdGlscy5oYXNMb2dGaWxlcyhsZWRnZXJEaXJlY3Rvcnks\nIGZhbHNlLCAwLCAxKSk7CiAgICAgICAgfQogICAgfQoKICAgIEBUZXN0KHRp\nbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWlub3JDb21wYWN0\naW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gcHJlcGFyZSBk\nYXRhCiAgICAgICAgTGVkZ2VySGFuZGxlW10gbGhzID0gcHJlcGFyZURhdGEo\nMywgZmFsc2UpOwoKICAgICAgICBmb3IgKExlZGdlckhhbmRsZSBsaCA6IGxo\ncykgewogICAgICAgICAgICBsaC5jbG9zZSgpOwogICAgICAgIH0KCiAgICAg\nICAgLy8gZGlzYWJsZSBtYWpvciBjb21wYWN0aW9uCiAgICAgICAgYmFzZUNv\nbmYuc2V0TWFqb3JDb21wYWN0aW9uVGhyZXNob2xkKDAuMGYpOwoKICAgICAg\nICAvLyByZXN0YXJ0IGJvb2tpZXMKICAgICAgICByZXN0YXJ0Qm9va2llcyhi\nYXNlQ29uZik7CgogICAgICAgIC8vIHJlbW92ZSBsZWRnZXIyIGFuZCBsZWRn\nZXIzCiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNbMV0uZ2V0SWQoKSk7\nCiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNbMl0uZ2V0SWQoKSk7Cgog\nICAgICAgIExPRy5pbmZvKCJGaW5pc2hlZCBkZWxldGluZyB0aGUgbGVkZ2Vy\ncyBjb250YWlucyBtb3N0IGVudHJpZXMuIik7CiAgICAgICAgVGhyZWFkLnNs\nZWVwKGJhc2VDb25mLmdldE1pbm9yQ29tcGFjdGlvbkludGVydmFsKCkgKiAx\nMDAwCiAgICAgICAgICAgICAgICAgICArIGJhc2VDb25mLmdldEdjV2FpdFRp\nbWUoKSk7CgogICAgICAgIC8vIGVudHJ5IGxvZ3MgKFswLDEsMl0ubG9nKSBz\naG91bGQgYmUgY29tcGFjdGVkLgogICAgICAgIGZvciAoRmlsZSBsZWRnZXJE\naXJlY3RvcnkgOiB0bXBEaXJzKSB7CiAgICAgICAgICAgIGFzc2VydEZhbHNl\nKCJGb3VuZCBlbnRyeSBsb2cgZmlsZSAoWzAsMSwyXS5sb2cgdGhhdCBzaG91\nbGQgaGF2ZSBub3QgYmVlbiBjb21wYWN0ZWQgaW4gbGVkZ2VyRGlyZWN0b3J5\nOiAiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBsZWRnZXJEaXJl\nY3RvcnksIFRlc3RVdGlscy5oYXNMb2dGaWxlcyhsZWRnZXJEaXJlY3Rvcnks\nIHRydWUsIDAsIDEsIDIpKTsKICAgICAgICB9CgogICAgICAgIC8vIGV2ZW4g\nZW50cnkgbG9nIGZpbGVzIGFyZSByZW1vdmVkLCB3ZSBzdGlsbCBjYW4gYWNj\nZXNzIGVudHJpZXMgZm9yIGxlZGdlcjEKICAgICAgICAvLyBzaW5jZSB0aG9z\nZSBlbnRyaWVzIGhhcyBiZWVuIGNvbXBhY3RlZCB0byBuZXcgZW50cnkgbG9n\nCiAgICAgICAgdmVyaWZ5TGVkZ2VyKGxoc1swXS5nZXRJZCgpLCAwLCBsaHNb\nMF0uZ2V0TGFzdEFkZENvbmZpcm1lZCgpKTsKICAgIH0KCiAgICBAVGVzdCh0\naW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdE1ham9yQ29tcGFj\ndGlvbigpIHRocm93cyBFeGNlcHRpb24gewoKICAgICAgICAvLyBwcmVwYXJl\nIGRhdGEKICAgICAgICBMZWRnZXJIYW5kbGVbXSBsaHMgPSBwcmVwYXJlRGF0\nYSgzLCB0cnVlKTsKCiAgICAgICAgZm9yIChMZWRnZXJIYW5kbGUgbGggOiBs\naHMpIHsKICAgICAgICAgICAgbGguY2xvc2UoKTsKICAgICAgICB9CgogICAg\nICAgIC8vIGRpc2FibGUgbWlub3IgY29tcGFjdGlvbgogICAgICAgIGJhc2VD\nb25mLnNldE1pbm9yQ29tcGFjdGlvblRocmVzaG9sZCgwLjBmKTsKCiAgICAg\nICAgLy8gcmVzdGFydCBib29raWVzCiAgICAgICAgcmVzdGFydEJvb2tpZXMo\nYmFzZUNvbmYpOwoKICAgICAgICAvLyByZW1vdmUgbGVkZ2VyMSBhbmQgbGVk\nZ2VyMwogICAgICAgIGJrYy5kZWxldGVMZWRnZXIobGhzWzBdLmdldElkKCkp\nOwogICAgICAgIGJrYy5kZWxldGVMZWRnZXIobGhzWzJdLmdldElkKCkpOwog\nICAgICAgIExPRy5pbmZvKCJGaW5pc2hlZCBkZWxldGluZyB0aGUgbGVkZ2Vy\ncyBjb250YWlucyBtb3N0IGVudHJpZXMuIik7CgogICAgICAgIFRocmVhZC5z\nbGVlcChiYXNlQ29uZi5nZXRNYWpvckNvbXBhY3Rpb25JbnRlcnZhbCgpICog\nMTAwMAogICAgICAgICAgICAgICAgICAgKyBiYXNlQ29uZi5nZXRHY1dhaXRU\naW1lKCkpOwoKICAgICAgICAvLyBlbnRyeSBsb2dzIChbMCwxLDJdLmxvZykg\nc2hvdWxkIGJlIGNvbXBhY3RlZAogICAgICAgIGZvciAoRmlsZSBsZWRnZXJE\naXJlY3RvcnkgOiB0bXBEaXJzKSB7CiAgICAgICAgICAgIGFzc2VydEZhbHNl\nKCJGb3VuZCBlbnRyeSBsb2cgZmlsZSAoWzAsMSwyXS5sb2cgdGhhdCBzaG91\nbGQgaGF2ZSBub3QgYmVlbiBjb21wYWN0ZWQgaW4gbGVkZ2VyRGlyZWN0b3J5\nOiAiCiAgICAgICAgICAgICAgICAgICAgICArIGxlZGdlckRpcmVjdG9yeSwg\nVGVzdFV0aWxzLmhhc0xvZ0ZpbGVzKGxlZGdlckRpcmVjdG9yeSwgdHJ1ZSwg\nMCwgMSwgMikpOwogICAgICAgIH0KCiAgICAgICAgLy8gZXZlbiBlbnRyeSBs\nb2cgZmlsZXMgYXJlIHJlbW92ZWQsIHdlIHN0aWxsIGNhbiBhY2Nlc3MgZW50\ncmllcyBmb3IgbGVkZ2VyMgogICAgICAgIC8vIHNpbmNlIHRob3NlIGVudHJp\nZXMgaGFzIGJlZW4gY29tcGFjdGVkIHRvIG5ldyBlbnRyeSBsb2cKICAgICAg\nICB2ZXJpZnlMZWRnZXIobGhzWzFdLmdldElkKCksIDAsIGxoc1sxXS5nZXRM\nYXN0QWRkQ29uZmlybWVkKCkpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9\nNjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFqb3JDb21wYWN0aW9uQWJv\ndmVUaHJlc2hvbGQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBw\ncmVwYXJlIGRhdGEKICAgICAgICBMZWRnZXJIYW5kbGVbXSBsaHMgPSBwcmVw\nYXJlRGF0YSgzLCBmYWxzZSk7CgogICAgICAgIGZvciAoTGVkZ2VySGFuZGxl\nIGxoIDogbGhzKSB7CiAgICAgICAgICAgIGxoLmNsb3NlKCk7CiAgICAgICAg\nfQoKICAgICAgICAvLyByZW1vdmUgbGVkZ2VyMSBhbmQgbGVkZ2VyMgogICAg\nICAgIGJrYy5kZWxldGVMZWRnZXIobGhzWzBdLmdldElkKCkpOwogICAgICAg\nIGJrYy5kZWxldGVMZWRnZXIobGhzWzFdLmdldElkKCkpOwogICAgICAgIExP\nRy5pbmZvKCJGaW5pc2hlZCBkZWxldGluZyB0aGUgbGVkZ2VycyBjb250YWlu\ncyBsZXNzIGVudHJpZXMuIik7CiAgICAgICAgVGhyZWFkLnNsZWVwKGJhc2VD\nb25mLmdldE1ham9yQ29tcGFjdGlvbkludGVydmFsKCkgKiAxMDAwCiAgICAg\nICAgICAgICAgICAgICArIGJhc2VDb25mLmdldEdjV2FpdFRpbWUoKSk7Cgog\nICAgICAgIC8vIGVudHJ5IGxvZ3MgKFswLDEsMl0ubG9nKSBzaG91bGQgbm90\nIGJlIGNvbXBhY3RlZAogICAgICAgIGZvciAoRmlsZSBsZWRnZXJEaXJlY3Rv\ncnkgOiB0bXBEaXJzKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoIk5vdCBG\nb3VuZCBlbnRyeSBsb2cgZmlsZSAoWzEsMl0ubG9nIHRoYXQgc2hvdWxkIGhh\ndmUgYmVlbiBjb21wYWN0ZWQgaW4gbGVkZ2VyRGlyZWN0b3J5OiAiCiAgICAg\nICAgICAgICAgICAgICAgICsgbGVkZ2VyRGlyZWN0b3J5LCBUZXN0VXRpbHMu\naGFzTG9nRmlsZXMobGVkZ2VyRGlyZWN0b3J5LCBmYWxzZSwgMCwgMSwgMikp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQog\nICAgcHVibGljIHZvaWQgdGVzdENvbXBhY3Rpb25TbWFsbEVudHJ5TG9ncygp\nIHRocm93cyBFeGNlcHRpb24gewoKICAgICAgICAvLyBjcmVhdGUgYSBsZWRn\nZXIgdG8gd3JpdGUgYSBmZXcgZW50cmllcwogICAgICAgIExlZGdlckhhbmRs\nZSBhbGggPSBia2MuY3JlYXRlTGVkZ2VyKE5VTV9CT09LSUVTLCBOVU1fQk9P\nS0lFUywgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPDM7IGkrKykgewogICAgICAgICAgIGFsaC5hZGRFbnRy\neShtc2cuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgfQogICAgICAgIGFsaC5jbG9z\nZSgpOwoKICAgICAgICAvLyByZXN0YXJ0IGJvb2tpZSB0byByb2xsIGVudHJ5\nIGxvZyBmaWxlcwogICAgICAgIHJlc3RhcnRCb29raWVzKCk7CgogICAgICAg\nIC8vIHByZXBhcmUgZGF0YQogICAgICAgIExlZGdlckhhbmRsZVtdIGxocyA9\nIHByZXBhcmVEYXRhKDMsIGZhbHNlKTsKCiAgICAgICAgZm9yIChMZWRnZXJI\nYW5kbGUgbGggOiBsaHMpIHsKICAgICAgICAgICAgbGguY2xvc2UoKTsKICAg\nICAgICB9CgogICAgICAgIC8vIHJlbW92ZSBsZWRnZXIyIGFuZCBsZWRnZXIz\nCiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNbMV0uZ2V0SWQoKSk7CiAg\nICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNbMl0uZ2V0SWQoKSk7CiAgICAg\nICAgTE9HLmluZm8oIkZpbmlzaGVkIGRlbGV0aW5nIHRoZSBsZWRnZXJzIGNv\nbnRhaW5zIG1vc3QgZW50cmllcy4iKTsKICAgICAgICBUaHJlYWQuc2xlZXAo\nYmFzZUNvbmYuZ2V0TWFqb3JDb21wYWN0aW9uSW50ZXJ2YWwoKSAqIDEwMDAK\nICAgICAgICAgICAgICAgICAgICsgYmFzZUNvbmYuZ2V0R2NXYWl0VGltZSgp\nKTsKCiAgICAgICAgLy8gZW50cnkgbG9ncyAoMC5sb2cpIHNob3VsZCBub3Qg\nYmUgY29tcGFjdGVkCiAgICAgICAgLy8gZW50cnkgbG9ncyAoWzEsMiwzXS5s\nb2cpIHNob3VsZCBiZSBjb21wYWN0ZWQuCiAgICAgICAgZm9yIChGaWxlIGxl\nZGdlckRpcmVjdG9yeSA6IHRtcERpcnMpIHsKICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZSgiTm90IEZvdW5kIGVudHJ5IGxvZyBmaWxlIChbMF0ubG9nIHRoYXQg\nc2hvdWxkIGhhdmUgYmVlbiBjb21wYWN0ZWQgaW4gbGVkZ2VyRGlyZWN0b3J5\nOiAiCiAgICAgICAgICAgICAgICAgICAgICsgbGVkZ2VyRGlyZWN0b3J5LCBU\nZXN0VXRpbHMuaGFzTG9nRmlsZXMobGVkZ2VyRGlyZWN0b3J5LCB0cnVlLCAw\nKSk7CiAgICAgICAgICAgIGFzc2VydEZhbHNlKCJGb3VuZCBlbnRyeSBsb2cg\nZmlsZSAoWzEsMiwzXS5sb2cgdGhhdCBzaG91bGQgaGF2ZSBub3QgYmVlbiBj\nb21wYWN0ZWQgaW4gbGVkZ2VyRGlyZWN0b3J5OiAiCiAgICAgICAgICAgICAg\nICAgICAgICArIGxlZGdlckRpcmVjdG9yeSwgVGVzdFV0aWxzLmhhc0xvZ0Zp\nbGVzKGxlZGdlckRpcmVjdG9yeSwgdHJ1ZSwgMSwgMiwgMykpOwogICAgICAg\nIH0KCiAgICAgICAgLy8gZXZlbiBlbnRyeSBsb2cgZmlsZXMgYXJlIHJlbW92\nZWQsIHdlIHN0aWxsIGNhbiBhY2Nlc3MgZW50cmllcyBmb3IgbGVkZ2VyMQog\nICAgICAgIC8vIHNpbmNlIHRob3NlIGVudHJpZXMgaGFzIGJlZW4gY29tcGFj\ndGVkIHRvIG5ldyBlbnRyeSBsb2cKICAgICAgICB2ZXJpZnlMZWRnZXIobGhz\nWzBdLmdldElkKCksIDAsIGxoc1swXS5nZXRMYXN0QWRkQ29uZmlybWVkKCkp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdCB0aGF0IGNvbXBhY3Rpb24g\nZG9lc250IGFkZCB0byBpbmRleCB3aXRob3V0IGhhdmluZyBwZXJzaXN0ZWQK\nICAgICAqIGVudHJ5bG9nIGZpcnN0LiBUaGlzIGlzIG5lZWRlZCBiZWNhdXNl\nIGNvbXBhY3Rpb24gZG9lc24ndCBnbyB0aHJvdWdoIHRoZSBqb3VybmFsLgog\nICAgICoge0BzZWUgaHR0cHM6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJhL2Jy\nb3dzZS9CT09LS0VFUEVSLTUzMH0KICAgICAqIHtAc2VlIGh0dHBzOi8vaXNz\ndWVzLmFwYWNoZS5vcmcvamlyYS9icm93c2UvQk9PS0tFRVBFUi02NjR9CiAg\nICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0Q29tcGFjdGlvblNhZmV0eSgpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHRlYXJEb3duKCk7IC8vIEkgZG9udCB3YW50IHRoZSB0ZXN0IGlu\nZnJhc3RydWN0dXJlCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBjb25m\nID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oKS5zZXRBbGxvd0xvb3BiYWNr\nKHRydWUpOwogICAgICAgIGZpbmFsIFNldDxMb25nPiBsZWRnZXJzID0gQ29s\nbGVjdGlvbnMubmV3U2V0RnJvbU1hcChuZXcgQ29uY3VycmVudEhhc2hNYXA8\nTG9uZywgQm9vbGVhbj4oKSk7CiAgICAgICAgTGVkZ2VyTWFuYWdlciBtYW5h\nZ2VyID0gbmV3IExlZGdlck1hbmFnZXIoKSB7CiAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUxl\nZGdlcihMZWRnZXJNZXRhZGF0YSBtZXRhZGF0YSwgR2VuZXJpY0NhbGxiYWNr\nPExvbmc+IGNiKSB7CiAgICAgICAgICAgICAgICAgICAgdW5zdXBwb3J0ZWQo\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcmVtb3ZlTGVkZ2VyTWV0\nYWRhdGEobG9uZyBsZWRnZXJJZCwgVmVyc2lvbiB2ZXJzaW9uLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2Vu\nZXJpY0NhbGxiYWNrPFZvaWQ+IHZiKSB7CiAgICAgICAgICAgICAgICAgICAg\ndW5zdXBwb3J0ZWQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcmVh\nZExlZGdlck1ldGFkYXRhKGxvbmcgbGVkZ2VySWQsIEdlbmVyaWNDYWxsYmFj\nazxMZWRnZXJNZXRhZGF0YT4gcmVhZENiKSB7CiAgICAgICAgICAgICAgICAg\nICAgdW5zdXBwb3J0ZWQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nd3JpdGVMZWRnZXJNZXRhZGF0YShsb25nIGxlZGdlcklkLCBMZWRnZXJNZXRh\nZGF0YSBtZXRhZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgR2VuZXJp\nY0NhbGxiYWNrPFZvaWQ+IGNiKSB7CiAgICAgICAgICAgICAgICAgICAgdW5z\ndXBwb3J0ZWQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgYXN5bmNQ\ncm9jZXNzTGVkZ2VycyhQcm9jZXNzb3I8TG9uZz4gcHJvY2Vzc29yLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBB\nc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjayBmaW5hbENiLAogICAgICAgICAg\nICAgICAgICAgICAgICBPYmplY3QgY29udGV4dCwgaW50IHN1Y2Nlc3NSYywg\naW50IGZhaWx1cmVSYykgewogICAgICAgICAgICAgICAgICAgIHVuc3VwcG9y\ndGVkKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJlZ2lzdGVyTGVk\nZ2VyTWV0YWRhdGFMaXN0ZW5lcihsb25nIGxlZGdlcklkLAogICAgICAgICAg\nICAgICAgICAgICAgICBMZWRnZXJNZXRhZGF0YUxpc3RlbmVyIGxpc3RlbmVy\nKSB7CiAgICAgICAgICAgICAgICAgICAgdW5zdXBwb3J0ZWQoKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAg\nICAgICAgICAgcHVibGljIHZvaWQgdW5yZWdpc3RlckxlZGdlck1ldGFkYXRh\nTGlzdGVuZXIobG9uZyBsZWRnZXJJZCwKICAgICAgICAgICAgICAgICAgICAg\nICAgTGVkZ2VyTWV0YWRhdGFMaXN0ZW5lciBsaXN0ZW5lcikgewogICAgICAg\nICAgICAgICAgICAgIHVuc3VwcG9ydGVkKCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIElPRXhjZXB0aW9uIHt9CgogICAg\nICAgICAgICAgICAgdm9pZCB1bnN1cHBvcnRlZCgpIHsKICAgICAgICAgICAg\nICAgICAgICBMT0cuZXJyb3IoIlVuc3VwcG9ydGVkIG9wZXJhdGlvbiBjYWxs\nZWQiLCBuZXcgRXhjZXB0aW9uKCkpOwogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJVbnN1cHBvcnRlZCBvcCIpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgICAgICAgICBwdWJsaWMgTGVkZ2VyUmFuZ2VJdGVyYXRvciBnZXRM\nZWRnZXJSYW5nZXMoKSB7CiAgICAgICAgICAgICAgICAgICAgZmluYWwgQXRv\nbWljQm9vbGVhbiBoYXNuZXh0ID0gbmV3IEF0b21pY0Jvb2xlYW4odHJ1ZSk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMZWRnZXJNYW5hZ2Vy\nLkxlZGdlclJhbmdlSXRlcmF0b3IoKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNOZXh0KCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoYXNuZXh0LmdldCgpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\nTGVkZ2VyTWFuYWdlci5MZWRnZXJSYW5nZSBuZXh0KCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc25leHQu\nc2V0KGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBuZXcgTGVkZ2VyTWFuYWdlci5MZWRnZXJSYW5nZShsZWRnZXJzKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH07\nCiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICBG\naWxlIHRtcERpciA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoImJrVGVzdCIsICIu\nZGlyIik7CiAgICAgICAgdG1wRGlyLmRlbGV0ZSgpOwogICAgICAgIHRtcERp\nci5ta2RpcigpOwogICAgICAgIEZpbGUgY3VyRGlyID0gQm9va2llLmdldEN1\ncnJlbnREaXJlY3RvcnkodG1wRGlyKTsKICAgICAgICBCb29raWUuY2hlY2tE\naXJlY3RvcnlTdHJ1Y3R1cmUoY3VyRGlyKTsKICAgICAgICBjb25mLnNldExl\nZGdlckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7dG1wRGlyLnRvU3RyaW5nKCl9\nKTsKCiAgICAgICAgY29uZi5zZXRFbnRyeUxvZ1NpemVMaW1pdChFbnRyeUxv\nZ2dlci5MT0dGSUxFX0hFQURFUl9TSVpFICsgMyAqICg0K0VOVFJZX1NJWkUp\nKTsKICAgICAgICBjb25mLnNldEdjV2FpdFRpbWUoMTAwKTsKICAgICAgICBj\nb25mLnNldE1pbm9yQ29tcGFjdGlvblRocmVzaG9sZCgwLjdmKTsKICAgICAg\nICBjb25mLnNldE1ham9yQ29tcGFjdGlvblRocmVzaG9sZCgwLjBmKTsKICAg\nICAgICBjb25mLnNldE1pbm9yQ29tcGFjdGlvbkludGVydmFsKDEpOwogICAg\nICAgIGNvbmYuc2V0TWFqb3JDb21wYWN0aW9uSW50ZXJ2YWwoMTApOwogICAg\nICAgIGNvbmYuc2V0UGFnZUxpbWl0KDEpOwoKICAgICAgICBmaW5hbCBieXRl\nW10gS0VZID0gImZvb2JhciIuZ2V0Qnl0ZXMoKTsKICAgICAgICBGaWxlIGxv\nZzAgPSBuZXcgRmlsZShjdXJEaXIsICIwLmxvZyIpOwogICAgICAgIExlZGdl\nckRpcnNNYW5hZ2VyIGRpcnMgPSBuZXcgTGVkZ2VyRGlyc01hbmFnZXIoY29u\nZik7CiAgICAgICAgYXNzZXJ0RmFsc2UoIkxvZyBzaG91bGRudCBleGlzdCIs\nIGxvZzAuZXhpc3RzKCkpOwogICAgICAgIEludGVybGVhdmVkTGVkZ2VyU3Rv\ncmFnZSBzdG9yYWdlID0gbmV3IEludGVybGVhdmVkTGVkZ2VyU3RvcmFnZShj\nb25mLCBtYW5hZ2VyLCBkaXJzKTsKICAgICAgICBsZWRnZXJzLmFkZCgxbCk7\nCiAgICAgICAgbGVkZ2Vycy5hZGQoMmwpOwogICAgICAgIGxlZGdlcnMuYWRk\nKDNsKTsKICAgICAgICBzdG9yYWdlLnNldE1hc3RlcktleSgxLCBLRVkpOwog\nICAgICAgIHN0b3JhZ2Uuc2V0TWFzdGVyS2V5KDIsIEtFWSk7CiAgICAgICAg\nc3RvcmFnZS5zZXRNYXN0ZXJLZXkoMywgS0VZKTsKICAgICAgICBzdG9yYWdl\nLmFkZEVudHJ5KGdlbkVudHJ5KDEsIDEsIEVOVFJZX1NJWkUpKTsKICAgICAg\nICBzdG9yYWdlLmFkZEVudHJ5KGdlbkVudHJ5KDIsIDEsIEVOVFJZX1NJWkUp\nKTsKICAgICAgICBzdG9yYWdlLmFkZEVudHJ5KGdlbkVudHJ5KDIsIDIsIEVO\nVFJZX1NJWkUpKTsKICAgICAgICBzdG9yYWdlLmFkZEVudHJ5KGdlbkVudHJ5\nKDMsIDIsIEVOVFJZX1NJWkUpKTsKICAgICAgICBzdG9yYWdlLmZsdXNoKCk7\nCiAgICAgICAgc3RvcmFnZS5zaHV0ZG93bigpOwoKICAgICAgICBhc3NlcnRU\ncnVlKCJMb2cgc2hvdWxkIGV4aXN0IiwgbG9nMC5leGlzdHMoKSk7CiAgICAg\nICAgbGVkZ2Vycy5yZW1vdmUoMmwpOwogICAgICAgIGxlZGdlcnMucmVtb3Zl\nKDNsKTsKCiAgICAgICAgc3RvcmFnZSA9IG5ldyBJbnRlcmxlYXZlZExlZGdl\nclN0b3JhZ2UoY29uZiwgbWFuYWdlciwgZGlycyk7CiAgICAgICAgc3RvcmFn\nZS5zdGFydCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMTA7IGkr\nKykgewogICAgICAgICAgICBpZiAoIWxvZzAuZXhpc3RzKCkpIHsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFRo\ncmVhZC5zbGVlcCgxMDAwKTsKICAgICAgICAgICAgc3RvcmFnZS5lbnRyeUxv\nZ2dlci5mbHVzaCgpOyAvLyBzaW11bGF0ZSBzeW5jIHRocmVhZAogICAgICAg\nIH0KICAgICAgICBhc3NlcnRGYWxzZSgiTG9nIHNob3VsZG50IGV4aXN0Iiwg\nbG9nMC5leGlzdHMoKSk7CgogICAgICAgIGxlZGdlcnMuYWRkKDRsKTsKICAg\nICAgICBzdG9yYWdlLnNldE1hc3RlcktleSg0LCBLRVkpOwogICAgICAgIHN0\nb3JhZ2UuYWRkRW50cnkoZ2VuRW50cnkoNCwgMSwgRU5UUllfU0laRSkpOyAv\nLyBmb3JjZSBsZWRnZXIgMSBwYWdlIHRvIGZsdXNoCgogICAgICAgIHN0b3Jh\nZ2UgPSBuZXcgSW50ZXJsZWF2ZWRMZWRnZXJTdG9yYWdlKGNvbmYsIG1hbmFn\nZXIsIGRpcnMpOwogICAgICAgIHN0b3JhZ2UuZ2V0RW50cnkoMSwgMSk7IC8v\nIGVudHJ5IHNob3VsZCBleGlzdAogICAgfQoKICAgIHByaXZhdGUgQnl0ZUJ1\nZmZlciBnZW5FbnRyeShsb25nIGxlZGdlciwgbG9uZyBlbnRyeSwgaW50IHNp\nemUpIHsKICAgICAgICBieXRlW10gZGF0YSA9IG5ldyBieXRlW3NpemVdOwog\nICAgICAgIEJ5dGVCdWZmZXIgYmIgPSBCeXRlQnVmZmVyLndyYXAobmV3IGJ5\ndGVbc2l6ZV0pOwogICAgICAgIGJiLnB1dExvbmcobGVkZ2VyKTsKICAgICAg\nICBiYi5wdXRMb25nKGVudHJ5KTsKICAgICAgICB3aGlsZSAoYmIuaGFzUmVt\nYWluaW5nKCkpIHsKICAgICAgICAgICAgYmIucHV0KChieXRlKTB4RkYpOwog\nICAgICAgIH0KICAgICAgICBiYi5mbGlwKCk7CiAgICAgICAgcmV0dXJuIGJi\nOwogICAgfQp9Cg==\n","encoding":"base64"}

