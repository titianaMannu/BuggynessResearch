{"sha":"85cd27169e98d933d7f392c3c803a689937eba28","node_id":"MDQ6QmxvYjE1NzU5NTY6ODVjZDI3MTY5ZTk4ZDkzM2Q3ZjM5MmMzYzgwM2E2ODk5MzdlYmEyOA==","size":9698,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/85cd27169e98d933d7f392c3c803a689937eba28","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgICAgaHR0cDovL3d3dy5hcGFj\naGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1\naXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGlu\nZywgc29mdHdhcmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2Ug\naXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9V\nVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhl\nciBleHByZXNzIG9yIGltcGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3Ig\ndGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQKICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7CgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0LkluZXRTb2NrZXRB\nZGRyZXNzOwppbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGph\ndmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3Vu\ndERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVV\nbml0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21p\nY0ludGVnZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tp\nZS5Cb29raWU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2ll\nLkJvb2tpZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuQXN5bmNDYWxsYmFjay5BZGRDYWxsYmFjazsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RU\neXBlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5j\nb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdl\nbmVyaWNDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuV3JpdGVDYWxsYmFj\nazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVw\nZXJDbHVzdGVyVGVzdENhc2U7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKaW1w\nb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2Vy\nRmFjdG9yeTsKCi8qKgogKiBUaGlzIGNsYXNzIHRlc3RzIHRoZSBsZWRnZXIg\nY2xvc2UgbG9naWMuCiAqLwpAU3VwcHJlc3NXYXJuaW5ncygiZGVwcmVjYXRp\nb24iKQpwdWJsaWMgY2xhc3MgTGVkZ2VyQ2xvc2VUZXN0IGV4dGVuZHMgQm9v\na0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CgogICAgc3RhdGljIExvZ2dlciBM\nT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMZWRnZXJDbG9zZVRlc3Qu\nY2xhc3MpOwoKICAgIHN0YXRpYyBmaW5hbCBpbnQgUkVBRF9USU1FT1VUID0g\nMTsKCiAgICBmaW5hbCBEaWdlc3RUeXBlIGRpZ2VzdFR5cGU7CgogICAgcHVi\nbGljIExlZGdlckNsb3NlVGVzdCgpIHsKICAgICAgICBzdXBlcig2KTsKICAg\nICAgICB0aGlzLmRpZ2VzdFR5cGUgPSBEaWdlc3RUeXBlLkNSQzMyOwogICAg\nICAgIC8vIHNldCB0aW1lb3V0IHRvIGEgbGFyZ2UgdmFsdWUgd2hpY2ggZGlz\nYWJsZSBpdC4KICAgICAgICBiYXNlQ2xpZW50Q29uZi5zZXRSZWFkVGltZW91\ndCg5OTk5OSk7CiAgICAgICAgYmFzZUNvbmYuc2V0R2NXYWl0VGltZSg5OTk5\nOTkpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQgPSA2MDAwMCkKICAgIHB1\nYmxpYyB2b2lkIHRlc3RMZWRnZXJDbG9zZVdpdGhDb25zaXN0ZW50TGVuZ3Ro\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xpZW50Q29uZmlndXJh\ndGlvbiBjb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAgICAg\nICBjb25mLnNldFprU2VydmVycyh6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVj\ndFN0cmluZygpKS5zZXRSZWFkVGltZW91dCgxKTsKCiAgICAgICAgQm9va0tl\nZXBlciBia2MgPSBuZXcgQm9va0tlZXBlcihjb25mKTsKICAgICAgICBMZWRn\nZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDYsIDMsIERpZ2VzdFR5\ncGUuQ1JDMzIsIG5ldyBieXRlW10ge30pOwogICAgICAgIGZpbmFsIENvdW50\nRG93bkxhdGNoIGxhdGNoID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAg\nICAgIHN0b3BCS0NsdXN0ZXIoKTsKICAgICAgICBmaW5hbCBBdG9taWNJbnRl\nZ2VyIGkgPSBuZXcgQXRvbWljSW50ZWdlcigweGRlYWRiZWVmKTsKICAgICAg\nICBBc3luY0NhbGxiYWNrLkFkZENhbGxiYWNrIGNiID0gbmV3IEFzeW5jQ2Fs\nbGJhY2suQWRkQ2FsbGJhY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRDb21wbGV0ZShpbnQgcmMsIExl\nZGdlckhhbmRsZSBsaCwgbG9uZyBlbnRyeUlkLCBPYmplY3QgY3R4KSB7CiAg\nICAgICAgICAgICAgICBpLnNldChyYyk7CiAgICAgICAgICAgICAgICBsYXRj\naC5jb3VudERvd24oKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAg\nICAgbGguYXN5bmNBZGRFbnRyeSgiVGVzdCBFbnRyeSIuZ2V0Qnl0ZXMoKSwg\nY2IsIG51bGwpOwogICAgICAgIGxhdGNoLmF3YWl0KCk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKGkuZ2V0KCksIEJLRXhjZXB0aW9uLkNvZGUuTm90RW5vdWdo\nQm9va2llc0V4Y2VwdGlvbik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIGxo\nLmdldExlbmd0aCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoTGVkZ2VySGFu\nZGxlLklOVkFMSURfRU5UUllfSUQsIGxoLmdldExhc3RBZGRDb25maXJtZWQo\nKSk7CiAgICAgICAgTGVkZ2VySGFuZGxlIG5ld0xoID0gYmtjLm9wZW5MZWRn\nZXIobGguZ2V0SWQoKSwgRGlnZXN0VHlwZS5DUkMzMiwgbmV3IGJ5dGVbXSB7\nfSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIG5ld0xoLmdldExlbmd0aCgp\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoTGVkZ2VySGFuZGxlLklOVkFMSURf\nRU5UUllfSUQsIG5ld0xoLmdldExhc3RBZGRDb25maXJtZWQoKSk7CiAgICB9\nCgogICAgQFRlc3QodGltZW91dCA9IDYwMDAwKQogICAgcHVibGljIHZvaWQg\ndGVzdExlZGdlckNsb3NlRHVyaW5nVW5yZWNvdmVyYWJsZUVycm9ycygpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBudW1FbnRyaWVzID0gMzsK\nICAgICAgICBMZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMs\nIDMsIDMsIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIHZl\ncmlmeU1ldGFkYXRhQ29uc2lzdGVuY3kobnVtRW50cmllcywgbGgpOwogICAg\nfQoKICAgIEBUZXN0KHRpbWVvdXQgPSA2MDAwMCkKICAgIHB1YmxpYyB2b2lk\nIHRlc3RMZWRnZXJDaGVja2VyU2hvdWxkbm90U2VsZWN0SW52YWxpZExhc3RG\ncmFnbWVudHMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbnVt\nRW50cmllcyA9IDEwOwogICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5j\ncmVhdGVMZWRnZXIoMywgMywgMywgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMo\nKSk7CiAgICAgICAgLy8gQWRkIHNvbWUgZW50cmllcyBiZWZvcmUgYm9va2ll\nIGZhaWx1cmVzCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbnRy\naWVzOyBpKyspIHsKICAgICAgICAgICAgbGguYWRkRW50cnkoImRhdGEiLmdl\ndEJ5dGVzKCkpOwogICAgICAgIH0KICAgICAgICBudW1FbnRyaWVzID0gNDsg\nLy8gYWRkIG4qZW5zZW1sZVNpemUrMSBlbnRyaWVzIGFzeW5jIGFmdGVyIGJv\nb2tpZXMKICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmFpbGVkLgogICAg\nICAgIHZlcmlmeU1ldGFkYXRhQ29uc2lzdGVuY3kobnVtRW50cmllcywgbGgp\nOwoKICAgICAgICBMZWRnZXJDaGVja2VyIGNoZWNrZXIgPSBuZXcgTGVkZ2Vy\nQ2hlY2tlcihia2MpOwogICAgICAgIENoZWNrZXJDYWxsYmFjayBjYiA9IG5l\ndyBDaGVja2VyQ2FsbGJhY2soKTsKICAgICAgICBjaGVja2VyLmNoZWNrTGVk\nZ2VyKGxoLCBjYik7CiAgICAgICAgU2V0PExlZGdlckZyYWdtZW50PiByZXN1\nbHQgPSBjYi53YWl0QW5kR2V0UmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJObyBmcmFnbWVudHMgc2hvdWxkIGJlIHNlbGVjdGVkIiwgMCwgcmVz\ndWx0LnNpemUoKSk7CiAgICB9CgogICAgY2xhc3MgQ2hlY2tlckNhbGxiYWNr\nIGltcGxlbWVudHMgR2VuZXJpY0NhbGxiYWNrPFNldDxMZWRnZXJGcmFnbWVu\ndD4+IHsKICAgICAgICBwcml2YXRlIFNldDxMZWRnZXJGcmFnbWVudD4gcmVz\ndWx0ID0gbnVsbDsKICAgICAgICBwcml2YXRlIENvdW50RG93bkxhdGNoIGxh\ndGNoID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwoKICAgICAgICBwdWJsaWMg\ndm9pZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIFNldDxMZWRnZXJGcmFn\nbWVudD4gcmVzdWx0KSB7CiAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gcmVz\ndWx0OwogICAgICAgICAgICBsYXRjaC5jb3VudERvd24oKTsKICAgICAgICB9\nCgogICAgICAgIFNldDxMZWRnZXJGcmFnbWVudD4gd2FpdEFuZEdldFJlc3Vs\ndCgpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGxhdGNoLmF3YWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAg\nICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCB2ZXJpZnlNZXRhZGF0\nYUNvbnNpc3RlbmN5KGludCBudW1FbnRyaWVzLCBMZWRnZXJIYW5kbGUgbGgp\nCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGZpbmFs\nIENvdW50RG93bkxhdGNoIGFkZERvbmVMYXRjaCA9IG5ldyBDb3VudERvd25M\nYXRjaCgxKTsKICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCBkZWFkSU9M\nYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICBmaW5hbCBD\nb3VudERvd25MYXRjaCByZWNvdmVyRG9uZUxhdGNoID0gbmV3IENvdW50RG93\nbkxhdGNoKDEpOwogICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIGZhaWxl\nZExhdGNoID0gbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgIC8vIGtp\nbGwgZmlyc3QgYm9va2llIHRvIHJlcGxhY2Ugd2l0aCBhIHVuYXV0aG9yaXpl\nIGJvb2tpZQogICAgICAgIEluZXRTb2NrZXRBZGRyZXNzIGJvb2tpZSA9IGxo\nLmdldExlZGdlck1ldGFkYXRhKCkuY3VycmVudEVuc2VtYmxlLmdldCgwKTsK\nICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBraWxsQm9va2ll\nKGJvb2tpZSk7CiAgICAgICAgLy8gcmVwbGFjZSBhIHVuYXV0aG9yaXplIGJv\nb2tpZQogICAgICAgIHN0YXJ0VW5hdXRob3JpemVkQm9va2llKGNvbmYsIGFk\nZERvbmVMYXRjaCk7CiAgICAgICAgLy8ga2lsbCBzZWNvbmQgYm9va2llIHRv\nIHJlcGxhY2Ugd2l0aCBhIGRlYWQgYm9va2llCiAgICAgICAgYm9va2llID0g\nbGguZ2V0TGVkZ2VyTWV0YWRhdGEoKS5jdXJyZW50RW5zZW1ibGUuZ2V0KDEp\nOwogICAgICAgIGNvbmYgPSBraWxsQm9va2llKGJvb2tpZSk7CiAgICAgICAg\nLy8gcmVwbGFjZSBhIHNsb3cgZGVhZCBib29raWUKICAgICAgICBzdGFydERl\nYWRCb29raWUoY29uZiwgZGVhZElPTGF0Y2gpOwoKICAgICAgICAvLyB0cmll\nZCB0byBhZGQgZW50cmllcwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nbnVtRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGxoLmFzeW5jQWRkRW50\ncnkoImRhdGEiLmdldEJ5dGVzKCksIG5ldyBBZGRDYWxsYmFjaygpIHsKICAg\nICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGlj\nIHZvaWQgYWRkQ29tcGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUgbGgsIGxv\nbmcgZW50cnlJZCwgT2JqZWN0IGN0eCkgewogICAgICAgICAgICAgICAgICAg\nIGlmIChCS0V4Y2VwdGlvbi5Db2RlLk9LICE9IHJjKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGZhaWxlZExhdGNoLmNvdW50RG93bigpOwogICAgICAg\nICAgICAgICAgICAgICAgICBkZWFkSU9MYXRjaC5jb3VudERvd24oKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKDAg\nPT0gZW50cnlJZCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3ZlckRvbmVMYXRjaC5h\nd2FpdCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9LCBudWxsKTsKICAgICAgICB9CiAgICAgICAgLy8gYWRk\nIGZpbmlzaGVkCiAgICAgICAgYWRkRG9uZUxhdGNoLmNvdW50RG93bigpOwog\nICAgICAgIC8vIHdhaXQgdW50aWwgZW50cmllcyBmYWlsZWQgZHVlIHRvIFVu\nYXV0aG9yaXplZEFjY2Vzc0V4Y2VwdGlvbgogICAgICAgIGZhaWxlZExhdGNo\nLmF3YWl0KCk7CiAgICAgICAgLy8gc2ltdWxhdGUgdGhlIG93bmVyc2hpcCBv\nZiB0aGlzIGxlZGdlciBpcyB0cmFuc2ZlciB0byBhbm90aGVyIGhvc3QgKHdo\naWNoIGlzIGFjdHVhbGx5CiAgICAgICAgLy8gd2hhdCB3ZSBkaWQgaW4gSGVk\nd2lnKS4KICAgICAgICBMT0cuaW5mbygiUmVjb3ZlciBsZWRnZXIge30uIiwg\nbGguZ2V0SWQoKSk7CiAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlvbiBuZXdD\nb25mID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBuZXdD\nb25mLmFkZENvbmZpZ3VyYXRpb24oYmFzZUNsaWVudENvbmYpOwogICAgICAg\nIEJvb2tLZWVwZXIgbmV3QmtjID0gbmV3IEJvb2tLZWVwZXJUZXN0Q2xpZW50\nKG5ld0NvbmYuc2V0UmVhZFRpbWVvdXQoMSkpOwogICAgICAgIExlZGdlckhh\nbmRsZSByZWNvdmVyZWRMaCA9IG5ld0JrYy5vcGVuTGVkZ2VyKGxoLmdldElk\nKCksIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIExPRy5p\nbmZvKCJSZWNvdmVyIGxlZGdlciB7fSBkb25lLiIsIGxoLmdldElkKCkpOwog\nICAgICAgIHJlY292ZXJEb25lTGF0Y2guY291bnREb3duKCk7CiAgICAgICAg\nLy8gd2FpdCBhIGJpdCB1bnRpbCBhZGQgb3BlcmF0aW9ucyBmYWlsZWQgZnJv\nbSBzZWNvbmQgYm9va2llIGR1ZSB0byBJT0V4Y2VwdGlvbgogICAgICAgIFRp\nbWVVbml0LlNFQ09ORFMuc2xlZXAoNSk7CiAgICAgICAgLy8gb3BlbiB0aGUg\nbGVkZ2VyIGFnYWluIHRvIG1ha2Ugc3VyZSB3ZSBnZSB0aGUgcmlnaHQgbGFz\ndCBjb25maXJtZWQuCiAgICAgICAgTGVkZ2VySGFuZGxlIG5ld0xoID0gbmV3\nQmtjLm9wZW5MZWRnZXIobGguZ2V0SWQoKSwgZGlnZXN0VHlwZSwgIiIuZ2V0\nQnl0ZXMoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJNZXRhZGF0YSBzaG91\nbGQgYmUgY29uc2lzdGVudCBhY3Jvc3MgZGlmZmVyZW50IG9wZW5lZCBsZWRn\nZXJzIiwKICAgICAgICAgICAgICAgIHJlY292ZXJlZExoLmdldExhc3RBZGRD\nb25maXJtZWQoKSwgbmV3TGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpKTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgc3RhcnRVbmF1dGhvcml6ZWRCb29raWUo\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mLCBmaW5hbCBDb3VudERvd25MYXRj\naCBsYXRjaCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgQm9va2llIHNCb29raWUgPSBuZXcgQm9va2llKGNvbmYpIHsKICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFkZEVu\ndHJ5KEJ5dGVCdWZmZXIgZW50cnksIFdyaXRlQ2FsbGJhY2sgY2IsIE9iamVj\ndCBjdHgsIGJ5dGVbXSBtYXN0ZXJLZXkpCiAgICAgICAgICAgICAgICAgICAg\ndGhyb3dzIElPRXhjZXB0aW9uLCBCb29raWVFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBsYXRjaC5hd2Fp\ndCgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\ndGhyb3cgQm9va2llRXhjZXB0aW9uLmNyZWF0ZShCb29raWVFeGNlcHRpb24u\nQ29kZS5VbmF1dGhvcml6ZWRBY2Nlc3NFeGNlcHRpb24pOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGlj\nIHZvaWQgcmVjb3ZlcnlBZGRFbnRyeShCeXRlQnVmZmVyIGVudHJ5LCBXcml0\nZUNhbGxiYWNrIGNiLCBPYmplY3QgY3R4LCBieXRlW10gbWFzdGVyS2V5KQog\nICAgICAgICAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQm9va2ll\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2Vw\ndGlvbigiRGVhZCBib29raWUgZm9yIHJlY292ZXJ5IGFkZHMuIik7CiAgICAg\nICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGJzQ29uZnMuYWRkKGNvbmYp\nOwogICAgICAgIGJzLmFkZChzdGFydEJvb2tpZShjb25mLCBzQm9va2llKSk7\nCiAgICB9CgogICAgLy8gc2ltdWxhdGUgc2xvdyBhZGRzLCB0aGVuIGJlY29t\nZSBub3JtYWwgd2hlbiByZWNvdmVyLAogICAgLy8gc28gbm8gZW5zZW1ibGUg\nY2hhbmdlIHdoZW4gcmVjb3ZlcmluZyBsZWRnZXIgb24gdGhpcyBib29raWUu\nCiAgICBwcml2YXRlIHZvaWQgc3RhcnREZWFkQm9va2llKFNlcnZlckNvbmZp\nZ3VyYXRpb24gY29uZiwgZmluYWwgQ291bnREb3duTGF0Y2ggbGF0Y2gpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIEJvb2tpZSBkQm9va2llID0gbmV3\nIEJvb2tpZShjb25mKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAg\nICAgICBwdWJsaWMgdm9pZCBhZGRFbnRyeShCeXRlQnVmZmVyIGVudHJ5LCBX\ncml0ZUNhbGxiYWNrIGNiLCBPYmplY3QgY3R4LCBieXRlW10gbWFzdGVyS2V5\nKQogICAgICAgICAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQm9v\na2llRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgbGF0Y2guYXdhaXQoKTsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIC8vIHNpbXVsYXRlIHNsb3cgYWRkcy4K\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiRGVhZCBi\nb29raWUiKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgYnND\nb25mcy5hZGQoY29uZik7CiAgICAgICAgYnMuYWRkKHN0YXJ0Qm9va2llKGNv\nbmYsIGRCb29raWUpKTsKICAgIH0KfQo=\n","encoding":"base64"}

