{"sha":"227647b17f9197bd3f820fde9ff437e686595aaf","node_id":"MDQ6QmxvYjE1NzU5NTY6MjI3NjQ3YjE3ZjkxOTdiZDNmODIwZmRlOWZmNDM3ZTY4NjU5NWFhZg==","size":5832,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/227647b17f9197bd3f820fde9ff437e686595aaf","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIu\nRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRh\nLkZsYXRMZWRnZXJNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5tZXRhLkhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXJGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2Vy\nTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhLkxl\nZGdlck1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLm1ldGEuTVNMZWRnZXJNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxs\nYmFja3M7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkxlZGdlck1ldGFkYXRhTGlzdGVu\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdC5Cb29rS2Vl\ncGVyQ2x1c3RlclRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnV0aWwuUmVmbGVjdGlvblV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnZlcnNpb25pbmcuVmVyc2lvbjsKCmltcG9ydCBvcmcuanVu\naXQuVGVzdDsKaW1wb3J0IG9yZy5qdW5pdC5ydW5uZXIuUnVuV2l0aDsKaW1w\nb3J0IG9yZy5qdW5pdC5ydW5uZXJzLlBhcmFtZXRlcml6ZWQ7CmltcG9ydCBv\ncmcuanVuaXQucnVubmVycy5QYXJhbWV0ZXJpemVkLlBhcmFtZXRlcnM7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwoKaW1wb3J0IGphdmEubmV0LkluZXRTb2NrZXRBZGRyZXNz\nOwppbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEudXRp\nbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQg\namF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJy\nZW50LlRpbWVVbml0OwoKQFJ1bldpdGgoUGFyYW1ldGVyaXplZC5jbGFzcykK\ncHVibGljIGNsYXNzIFRlc3RXYXRjaEVuc2VtYmxlQ2hhbmdlIGV4dGVuZHMg\nQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSB7CgogICAgc3RhdGljIExvZ2dl\nciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihUZXN0V2F0Y2hFbnNl\nbWJsZUNoYW5nZS5jbGFzcyk7CgogICAgZmluYWwgRGlnZXN0VHlwZSBkaWdl\nc3RUeXBlOwogICAgZmluYWwgQ2xhc3M8PyBleHRlbmRzIExlZGdlck1hbmFn\nZXJGYWN0b3J5PiBsbUZhY3RvcnlDbHM7CgogICAgcHVibGljIFRlc3RXYXRj\naEVuc2VtYmxlQ2hhbmdlKENsYXNzPD8gZXh0ZW5kcyBMZWRnZXJNYW5hZ2Vy\nRmFjdG9yeT4gbG1GYWN0b3J5Q2xzKSB7CiAgICAgICAgc3VwZXIoNyk7CiAg\nICAgICAgdGhpcy5kaWdlc3RUeXBlID0gRGlnZXN0VHlwZS5DUkMzMjsKICAg\nICAgICB0aGlzLmxtRmFjdG9yeUNscyA9IGxtRmFjdG9yeUNsczsKICAgICAg\nICBiYXNlQ2xpZW50Q29uZi5zZXRMZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNz\nKGxtRmFjdG9yeUNscyk7CiAgICAgICAgYmFzZUNvbmYuc2V0TGVkZ2VyTWFu\nYWdlckZhY3RvcnlDbGFzcyhsbUZhY3RvcnlDbHMpOwogICAgfQogICAgCiAg\nICBAUGFyYW1ldGVycwogICAgcHVibGljIHN0YXRpYyBDb2xsZWN0aW9uPE9i\namVjdFtdPiBjb25maWdzKCkgewogICAgICAgIHJldHVybiBBcnJheXMuYXNM\naXN0KG5ldyBPYmplY3RbXVtdIHsKICAgICAgICAgICAgeyBGbGF0TGVkZ2Vy\nTWFuYWdlckZhY3RvcnkuY2xhc3MgfSwKICAgICAgICAgICAgeyBIaWVyYXJj\naGljYWxMZWRnZXJNYW5hZ2VyRmFjdG9yeS5jbGFzcyB9LAogICAgICAgICAg\nICB7IE1TTGVkZ2VyTWFuYWdlckZhY3RvcnkuY2xhc3MgfQogICAgICAgIH0p\nOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQgPSA2MDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RXYXRjaEVuc2VtYmxlQ2hhbmdlKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaW50IG51bUVudHJpZXMgPSAxMDsKICAgICAgICBM\nZWRnZXJIYW5kbGUgbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDMsIDMsIGRp\nZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIGZvciAoaW50IGk9\nMDsgaTxudW1FbnRyaWVzOyBpKyspIHsKICAgICAgICAgICAgbGguYWRkRW50\ncnkoKCJkYXRhIiArIGkpLmdldEJ5dGVzKCkpOwogICAgICAgICAgICBMT0cu\naW5mbygiQWRkZWQgZW50cnkge30uIiwgaSk7CiAgICAgICAgfQogICAgICAg\nIExlZGdlckhhbmRsZSByZWFkTGggPSBia2Mub3BlbkxlZGdlck5vUmVjb3Zl\ncnkobGguZ2V0SWQoKSwgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CiAg\nICAgICAgbG9uZyBsYXN0TEFDID0gcmVhZExoLmdldExhc3RBZGRDb25maXJt\nZWQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMobnVtRW50cmllcyAtIDIsIGxh\nc3RMQUMpOwogICAgICAgIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVzcz4g\nZW5zZW1ibGUgPQogICAgICAgICAgICAgICAgbGguZ2V0TGVkZ2VyTWV0YWRh\ndGEoKS5jdXJyZW50RW5zZW1ibGU7CiAgICAgICAgZm9yIChJbmV0U29ja2V0\nQWRkcmVzcyBhZGRyIDogZW5zZW1ibGUpIHsKICAgICAgICAgICAga2lsbEJv\nb2tpZShhZGRyKTsKICAgICAgICB9CiAgICAgICAgLy8gd3JpdGUgYW5vdGhl\nciBiYXRjaCBvZiBlbnRyaWVzLCB3aGljaCB3aWxsIHRyaWdnZXIgZW5zZW1i\nbGUgY2hhbmdlCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bUVudHJpZXM7\nIGkrKykgewogICAgICAgICAgICBsaC5hZGRFbnRyeSgoImRhdGEiICsgKG51\nbUVudHJpZXMgKyBpKSkuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgICAgIExPRy5p\nbmZvKCJBZGRlZCBlbnRyeSB7fS4iLCAobnVtRW50cmllcyArIGkpKTsKICAg\nICAgICB9CiAgICAgICAgVGltZVVuaXQuU0VDT05EUy5zbGVlcCg1KTsKICAg\nICAgICByZWFkTGgucmVhZExhc3RDb25maXJtZWQoKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMiAqIG51bUVudHJpZXMgLSAyLCByZWFkTGguZ2V0TGFzdEFk\nZENvbmZpcm1lZCgpKTsKICAgICAgICByZWFkTGguY2xvc2UoKTsKICAgICAg\nICBsaC5jbG9zZSgpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQgPSA2MDAw\nMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RXYXRjaE1ldGFkYXRhUmVtb3ZhbCgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgTGVkZ2VyTWFuYWdlckZhY3Rv\ncnkgZmFjdG9yeSA9IFJlZmxlY3Rpb25VdGlscy5uZXdJbnN0YW5jZShsbUZh\nY3RvcnlDbHMpOwogICAgICAgZmFjdG9yeS5pbml0aWFsaXplKGJhc2VDb25m\nLCBzdXBlci56a2MsIGZhY3RvcnkuZ2V0Q3VycmVudFZlcnNpb24oKSk7CiAg\nICAgICBMZWRnZXJNYW5hZ2VyIG1hbmFnZXIgPSBmYWN0b3J5Lm5ld0xlZGdl\nck1hbmFnZXIoKTsKICAgICAgIGZpbmFsIEJ5dGVCdWZmZXIgYmJMZWRnZXJJ\nZCA9IEJ5dGVCdWZmZXIuYWxsb2NhdGUoOCk7CiAgICAgICBmaW5hbCBDb3Vu\ndERvd25MYXRjaCBjcmVhdGVMYXRjaCA9IG5ldyBDb3VudERvd25MYXRjaCgx\nKTsKICAgICAgIGZpbmFsIENvdW50RG93bkxhdGNoIHJlbW92ZUxhdGNoID0g\nbmV3IENvdW50RG93bkxhdGNoKDEpOwogICAgICAgCiAgICAgICBtYW5hZ2Vy\nLmNyZWF0ZUxlZGdlciggbmV3IExlZGdlck1ldGFkYXRhKDQsIDIsIDIsIGRp\nZ2VzdFR5cGUsICJmcGogd2FzIGhlcmUiLmdldEJ5dGVzKCkpLCAKICAgICAg\nICAgICAgICAgIG5ldyBCb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2Vu\nZXJpY0NhbGxiYWNrPExvbmc+KCl7CiAgICAgICAgICAKICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21w\nbGV0ZShpbnQgcmMsIExvbmcgcmVzdWx0KSB7CiAgICAgICAgICAgICAgIGJi\nTGVkZ2VySWQucHV0TG9uZyhyZXN1bHQpOwogICAgICAgICAgICAgICBiYkxl\nZGdlcklkLmZsaXAoKTsKICAgICAgICAgICAgICAgY3JlYXRlTGF0Y2guY291\nbnREb3duKCk7CiAgICAgICAgICAgfQogICAgICAgfSk7IAogICAgICAgYXNz\nZXJ0VHJ1ZShjcmVhdGVMYXRjaC5hd2FpdCgyMDAwLCBUaW1lVW5pdC5NSUxM\nSVNFQ09ORFMpKTsKICAgICAgIGZpbmFsIGxvbmcgY3JlYXRlZExpZCA9IGJi\nTGVkZ2VySWQuZ2V0TG9uZygpOwogICAgICAgCiAgICAgICBtYW5hZ2VyLnJl\nZ2lzdGVyTGVkZ2VyTWV0YWRhdGFMaXN0ZW5lciggY3JlYXRlZExpZCwgCiAg\nICAgICAgICAgICAgIG5ldyBMZWRnZXJNZXRhZGF0YUxpc3RlbmVyKCkgewoK\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICBwdWJsaWMgdm9pZCBv\nbkNoYW5nZWQoIGxvbmcgbGVkZ2VySWQsIExlZGdlck1ldGFkYXRhIG1ldGFk\nYXRhICkgewogICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMobGVkZ2VySWQs\nIGNyZWF0ZWRMaWQpOwogICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMobWV0\nYWRhdGEsIG51bGwpOwogICAgICAgICAgICAgICByZW1vdmVMYXRjaC5jb3Vu\ndERvd24oKTsKICAgICAgICAgICB9ICAgCiAgICAgICB9KTsKICAgICAgIAog\nICAgICAgbWFuYWdlci5yZW1vdmVMZWRnZXJNZXRhZGF0YSggY3JlYXRlZExp\nZCwgVmVyc2lvbi5BTlksCiAgICAgICAgICAgICAgIG5ldyBCb29ra2VlcGVy\nSW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0NhbGxiYWNrPFZvaWQ+KCkgewog\nICAgICAgICAgIAogICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgIHB1\nYmxpYyB2b2lkIG9wZXJhdGlvbkNvbXBsZXRlKGludCByYywgVm9pZCByZXN1\nbHQpIHsKICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHJjLCBCS0V4Y2Vw\ndGlvbi5Db2RlLk9LKTsKICAgICAgICAgICB9CiAgICAgICB9KTsKICAgICAg\nIGFzc2VydFRydWUocmVtb3ZlTGF0Y2guYXdhaXQoMjAwMCwgVGltZVVuaXQu\nTUlMTElTRUNPTkRTKSk7ICAgCiAgICB9Cn0K\n","encoding":"base64"}

