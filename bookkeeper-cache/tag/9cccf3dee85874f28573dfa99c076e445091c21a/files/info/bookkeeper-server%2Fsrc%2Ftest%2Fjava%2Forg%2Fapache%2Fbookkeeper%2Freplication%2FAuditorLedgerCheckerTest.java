{"sha":"75f84326b431b60e652fb65f6148b345c9f9800a","node_id":"MDQ6QmxvYjE1NzU5NTY6NzVmODQzMjZiNDMxYjYwZTY1MmZiNjVmNjE0OGIzNDVjOWY5ODAwYQ==","size":15211,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/75f84326b431b60e652fb65f6148b345c9f9800a","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5yZXBsaWNhdGlv\nbjsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5u\naW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkhhc2hN\nYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5SYW5kb207CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51\ndGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0Y2g7CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlw\nZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNv\nbmZpZ3VyYXRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1l\ndGEuWmtMZWRnZXJVbmRlcnJlcGxpY2F0aW9uTWFuYWdlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29raWVTZXJ2ZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uRGF0YUZvcm1hdHMuVW5k\nZXJyZXBsaWNhdGVkTGVkZ2VyRm9ybWF0OwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLnJlcGxpY2F0aW9uLlJlcGxpY2F0aW9uRXhjZXB0aW9uLkNv\nbXBhdGliaWxpdHlFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIucmVwbGljYXRpb24uUmVwbGljYXRpb25FeGNlcHRpb24uVW5hdmFp\nbGFibGVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\ndGVzdC5NdWx0aUxlZGdlck1hbmFnZXJUZXN0Q2FzZTsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci51dGlsLlN0cmluZ1V0aWxzOwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlZEV2ZW50OwppbXBvcnQgb3JnLmFw\nYWNoZS56b29rZWVwZXIuV2F0Y2hlcjsKaW1wb3J0IG9yZy5qdW5pdC5CZWZv\ncmU7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsKaW1wb3J0IG9yZy5zbGY0ai5M\nb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCi8qKgog\nKiBUZXN0cyBwdWJsaXNoaW5nIG9mIHVuZGVyIHJlcGxpY2F0ZWQgbGVkZ2Vy\ncyBieSB0aGUgQXVkaXRvciBib29raWUgbm9kZSB3aGVuCiAqIGNvcnJlc3Bv\nbmRpbmcgYm9va2llcyBpZGVudGlmZXMgYXMgbm90IHJ1bm5pbmcKICovCnB1\nYmxpYyBjbGFzcyBBdWRpdG9yTGVkZ2VyQ2hlY2tlclRlc3QgZXh0ZW5kcyBN\ndWx0aUxlZGdlck1hbmFnZXJUZXN0Q2FzZSB7CgogICAgLy8gRGVwZW5kaW5n\nIG9uIHRoZSB0YXN0ZSwgc2VsZWN0IHRoZSBhbW91bnQgb2YgbG9nZ2luZwog\nICAgLy8gYnkgZGVjb21tZW50aW5nIG9uZSBvZiB0aGUgdHdvIGxpbmVzIGJl\nbG93CiAgICAvLyBzdGF0aWMgTG9nZ2VyIExPRyA9IExvZ2dlci5nZXRSb290\nTG9nZ2VyKCk7CiAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBMb2dnZXIgTE9H\nID0gTG9nZ2VyRmFjdG9yeQogICAgICAgICAgICAuZ2V0TG9nZ2VyKEF1ZGl0\nb3JMZWRnZXJDaGVja2VyVGVzdC5jbGFzcyk7CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgYnl0ZVtdIGxlZGdlclBhc3N3b3JkID0gImFhYSIuZ2V0Qnl0\nZXMoKTsKICAgIHByaXZhdGUgUmFuZG9tIHJuZzsgLy8gUmFuZG9tIE51bWJl\nciBHZW5lcmF0b3IKCiAgICBwcml2YXRlIERpZ2VzdFR5cGUgZGlnZXN0VHlw\nZTsKCiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyBVTkRFUlJFUExJQ0FURURf\nUEFUSCA9IGJhc2VDbGllbnRDb25mCiAgICAgICAgICAgIC5nZXRaa0xlZGdl\ncnNSb290UGF0aCgpCiAgICAgICAgICAgICsgIi91bmRlcnJlcGxpY2F0aW9u\nL2xlZGdlcnMiOwogICAgcHJpdmF0ZSBIYXNoTWFwPFN0cmluZywgQXVkaXRv\nckVsZWN0b3I+IGF1ZGl0b3JFbGVjdG9ycyA9IG5ldyBIYXNoTWFwPFN0cmlu\nZywgQXVkaXRvckVsZWN0b3I+KCk7CiAgICBwcml2YXRlIFprTGVkZ2VyVW5k\nZXJyZXBsaWNhdGlvbk1hbmFnZXIgdXJMZWRnZXJNZ3I7CiAgICBwcml2YXRl\nIFNldDxMb25nPiB1ckxlZGdlckxpc3Q7CgogICAgcHJpdmF0ZSBMaXN0PExv\nbmc+IGxlZGdlckxpc3Q7CgogICAgcHVibGljIEF1ZGl0b3JMZWRnZXJDaGVj\na2VyVGVzdChTdHJpbmcgbGVkZ2VyTWFuYWdlckZhY3RvcnlDbGFzcykKICAg\nICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24s\nIEludGVycnVwdGVkRXhjZXB0aW9uLAogICAgICAgICAgICBDb21wYXRpYmls\naXR5RXhjZXB0aW9uIHsKICAgICAgICBzdXBlcigzKTsKICAgICAgICBMT0cu\naW5mbygiUnVubmluZyB0ZXN0IGNhc2UgdXNpbmcgbGVkZ2VyIG1hbmFnZXIg\nOiAiCiAgICAgICAgICAgICAgICArIGxlZGdlck1hbmFnZXJGYWN0b3J5Q2xh\nc3MpOwogICAgICAgIHRoaXMuZGlnZXN0VHlwZSA9IERpZ2VzdFR5cGUuQ1JD\nMzI7CiAgICAgICAgLy8gc2V0IGxlZGdlciBtYW5hZ2VyIG5hbWUKICAgICAg\nICBiYXNlQ29uZi5zZXRMZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNzTmFtZShs\nZWRnZXJNYW5hZ2VyRmFjdG9yeUNsYXNzKTsKICAgICAgICBiYXNlQ2xpZW50\nQ29uZgogICAgICAgICAgICAgICAgLnNldExlZGdlck1hbmFnZXJGYWN0b3J5\nQ2xhc3NOYW1lKGxlZGdlck1hbmFnZXJGYWN0b3J5Q2xhc3MpOwogICAgfQoK\nICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoKTsKICAgICAgICB1ckxl\nZGdlck1nciA9IG5ldyBaa0xlZGdlclVuZGVycmVwbGljYXRpb25NYW5hZ2Vy\nKGJhc2VDbGllbnRDb25mLCB6a2MpOwogICAgICAgIHN0YXJ0QXVkaXRvckVs\nZWN0b3JzKCk7CiAgICAgICAgcm5nID0gbmV3IFJhbmRvbShTeXN0ZW0uY3Vy\ncmVudFRpbWVNaWxsaXMoKSk7IC8vIEluaXRpYWxpemUgdGhlIFJhbmRvbQog\nICAgICAgIHVyTGVkZ2VyTGlzdCA9IG5ldyBIYXNoU2V0PExvbmc+KCk7CiAg\nICAgICAgbGVkZ2VyTGlzdCA9IG5ldyBBcnJheUxpc3Q8TG9uZz4oMik7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN0b3BBdWRpdG9yRWxlY3Rv\ncnMoKTsKICAgICAgICBzdXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIHBy\naXZhdGUgdm9pZCBzdGFydEF1ZGl0b3JFbGVjdG9ycygpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIGZvciAoQm9va2llU2VydmVyIGJzZXJ2ZXIgOiBi\ncykgewogICAgICAgICAgICBTdHJpbmcgYWRkciA9IFN0cmluZ1V0aWxzLmFk\nZHJUb1N0cmluZyhic2VydmVyLmdldExvY2FsQWRkcmVzcygpKTsKICAgICAg\nICAgICAgQXVkaXRvckVsZWN0b3IgYXVkaXRvckVsZWN0b3IgPSBuZXcgQXVk\naXRvckVsZWN0b3IoYWRkciwKICAgICAgICAgICAgICAgICAgICBiYXNlQ29u\nZiwgemtjKTsKICAgICAgICAgICAgYXVkaXRvckVsZWN0b3JzLnB1dChhZGRy\nLCBhdWRpdG9yRWxlY3Rvcik7CiAgICAgICAgICAgIGF1ZGl0b3JFbGVjdG9y\nLnN0YXJ0KCk7CiAgICAgICAgICAgIExPRy5kZWJ1ZygiU3RhcnRpbmcgQXVk\naXRvciBFbGVjdG9yIik7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBzdG9wQXVkaXRvckVsZWN0b3JzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgZm9yIChBdWRpdG9yRWxlY3RvciBhdWRpdG9yRWxlY3RvciA6\nIGF1ZGl0b3JFbGVjdG9ycy52YWx1ZXMoKSkgewogICAgICAgICAgICBhdWRp\ndG9yRWxlY3Rvci5zaHV0ZG93bigpOwogICAgICAgICAgICBMT0cuZGVidWco\nIlN0b3BwaW5nIEF1ZGl0b3IgRWxlY3RvciEiKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUZXN0IHB1Ymxpc2hpbmcgb2YgdW5kZXIgcmVw\nbGljYXRlZCBsZWRnZXJzIGJ5IHRoZSBhdWRpdG9yIGJvb2tpZQogICAgICov\nCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVz\ndFNpbXBsZUxlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExl\nZGdlckhhbmRsZSBsaDEgPSBjcmVhdGVBbmRBZGRFbnRyaWVzVG9MZWRnZXIo\nKTsKICAgICAgICBMb25nIGxlZGdlcklkID0gbGgxLmdldElkKCk7CiAgICAg\nICAgTE9HLmRlYnVnKCJDcmVhdGVkIGxlZGdlciA6ICIgKyBsZWRnZXJJZCk7\nCiAgICAgICAgbGVkZ2VyTGlzdC5hZGQobGVkZ2VySWQpOwogICAgICAgIGxo\nMS5jbG9zZSgpOwoKICAgICAgICBmaW5hbCBDb3VudERvd25MYXRjaCB1bmRl\nclJlcGxpY2FMYXRjaCA9IHJlZ2lzdGVyVXJMZWRnZXJXYXRjaGVyKGxlZGdl\nckxpc3QKICAgICAgICAgICAgICAgIC5zaXplKCkpOwoKICAgICAgICBpbnQg\nYmtTaHV0ZG93bkluZGV4ID0gYnMuc2l6ZSgpIC0gMTsKICAgICAgICBTdHJp\nbmcgc2h1dGRvd25Cb29raWUgPSBzaHV0ZG93bkJvb2tpZShia1NodXRkb3du\nSW5kZXgpOwoKICAgICAgICAvLyBncmFjZSBwZXJpb2QgZm9yIHB1Ymxpc2hp\nbmcgdGhlIGJrLWxlZGdlcgogICAgICAgIExPRy5kZWJ1ZygiV2FpdGluZyBm\nb3IgbGVkZ2VycyB0byBiZSBtYXJrZWQgYXMgdW5kZXIgcmVwbGljYXRlZCIp\nOwogICAgICAgIHVuZGVyUmVwbGljYUxhdGNoLmF3YWl0KDUsIFRpbWVVbml0\nLlNFQ09ORFMpOwogICAgICAgIE1hcDxMb25nLCBTdHJpbmc+IHVyTGVkZ2Vy\nRGF0YSA9IGdldFVyTGVkZ2VyRGF0YSh1ckxlZGdlckxpc3QpOwogICAgICAg\nIGFzc2VydEVxdWFscygiTWlzc2VkIGlkZW50aWZ5aW5nIHVuZGVyIHJlcGxp\nY2F0ZWQgbGVkZ2VycyIsIDEsCiAgICAgICAgICAgICAgICB1ckxlZGdlckxp\nc3Quc2l6ZSgpKTsKCiAgICAgICAgLyoKICAgICAgICAgKiBTYW1wbGUgZGF0\nYSBmb3JtYXQgcHJlc2VudCBpbiB0aGUgdW5kZXIgcmVwbGljYXRlZCBsZWRn\nZXIgcGF0aAogICAgICAgICAqIAogICAgICAgICAqIHs0PXJlcGxpY2E6ICIx\nMC4xOC44OS4xNTM6NTAwMiJ9CiAgICAgICAgICovCiAgICAgICAgYXNzZXJ0\nVHJ1ZSgiTGVkZ2VyIGlzIG5vdCBtYXJrZWQgYXMgdW5kZXJyZXBsaWNhdGVk\nOiIgKyBsZWRnZXJJZCwKICAgICAgICAgICAgICAgIHVyTGVkZ2VyTGlzdC5j\nb250YWlucyhsZWRnZXJJZCkpOwogICAgICAgIFN0cmluZyBkYXRhID0gdXJM\nZWRnZXJEYXRhLmdldChsZWRnZXJJZCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgi\nQm9va2llICIgKyBzaHV0ZG93bkJvb2tpZQogICAgICAgICAgICAgICAgKyAi\naXMgbm90IGxpc3RlZCBpbiB0aGUgbGVkZ2VyIGFzIG1pc3NpbmcgcmVwbGlj\nYSA6IiArIGRhdGEsCiAgICAgICAgICAgICAgICBkYXRhLmNvbnRhaW5zKHNo\ndXRkb3duQm9va2llKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IG9u\nY2UgcHVibGlzaGVkIHVuZGVyIHJlcGxpY2F0ZWQgbGVkZ2VyIHNob3VsZCBl\neGlzdHMgZXZlbiBhZnRlcgogICAgICogcmVzdGFydGluZyByZXNwZWN0aXZl\nIGJvb2tpZQogICAgICovCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAg\ncHVibGljIHZvaWQgdGVzdFJlc3RhcnRCb29raWUoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBMZWRnZXJIYW5kbGUgbGgxID0gY3JlYXRlQW5kQWRk\nRW50cmllc1RvTGVkZ2VyKCk7CiAgICAgICAgTGVkZ2VySGFuZGxlIGxoMiA9\nIGNyZWF0ZUFuZEFkZEVudHJpZXNUb0xlZGdlcigpOwoKICAgICAgICBMT0cu\nZGVidWcoIkNyZWF0ZWQgZm9sbG93aW5nIGxlZGdlcnMgOiB7fSwge30iLCBs\naDEsIGxoMik7CgogICAgICAgIGludCBia1NodXRkb3duSW5kZXggPSBicy5z\naXplKCkgLSAxOwogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gYm9va2ll\nQ29uZjEgPSBic0NvbmZzLmdldChia1NodXRkb3duSW5kZXgpOwogICAgICAg\nIFN0cmluZyBzaHV0ZG93bkJvb2tpZSA9IHNodXRkb3duQm9va2llKGJrU2h1\ndGRvd25JbmRleCk7CgogICAgICAgIC8vIHJlc3RhcnQgdGhlIGZhaWxlZCBi\nb29raWUKICAgICAgICBicy5hZGQoc3RhcnRCb29raWUoYm9va2llQ29uZjEp\nKTsKCiAgICAgICAgd2FpdEZvckxlZGdlck1pc3NpbmdSZXBsaWNhcyhsaDEu\nZ2V0SWQoKSwgMTAsIHNodXRkb3duQm9va2llKTsKICAgICAgICB3YWl0Rm9y\nTGVkZ2VyTWlzc2luZ1JlcGxpY2FzKGxoMi5nZXRJZCgpLCAxMCwgc2h1dGRv\nd25Cb29raWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdCBwdWJsaXNo\naW5nIG9mIHVuZGVyIHJlcGxpY2F0ZWQgbGVkZ2VycyB3aGVuIG11bHRpcGxl\nIGJvb2tpZSBmYWlsdXJlcwogICAgICogb25lIGFmdGVyIGFub3RoZXIuCiAg\nICAgKi8KICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0TXVsdGlwbGVCb29raWVGYWlsdXJlcygpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIExlZGdlckhhbmRsZSBsaDEgPSBjcmVhdGVBbmRBZGRF\nbnRyaWVzVG9MZWRnZXIoKTsKCiAgICAgICAgLy8gZmFpbGluZyBmaXJzdCBi\nb29raWUKICAgICAgICBzaHV0ZG93bkJvb2tpZShicy5zaXplKCkgLSAxKTsK\nCiAgICAgICAgLy8gc2ltdWxhdGUgcmUtcmVwbGljYXRpb24KICAgICAgICBk\nb0xlZGdlclJlcmVwbGljYXRpb24obGgxLmdldElkKCkpOwoKICAgICAgICAv\nLyBmYWlsaW5nIGFub3RoZXIgYm9va2llCiAgICAgICAgU3RyaW5nIHNodXRk\nb3duQm9va2llID0gc2h1dGRvd25Cb29raWUoYnMuc2l6ZSgpIC0gMSk7Cgog\nICAgICAgIC8vIGdyYWNlIHBlcmlvZCBmb3IgcHVibGlzaGluZyB0aGUgYmst\nbGVkZ2VyCiAgICAgICAgTE9HLmRlYnVnKCJXYWl0aW5nIGZvciBsZWRnZXJz\nIHRvIGJlIG1hcmtlZCBhcyB1bmRlciByZXBsaWNhdGVkIik7CiAgICAgICAg\nYXNzZXJ0VHJ1ZSgiTGVkZ2VyIHNob3VsZCBiZSBtaXNzaW5nIHNlY29uZCBy\nZXBsaWNhIiwKICAgICAgICAgICAgICAgICAgIHdhaXRGb3JMZWRnZXJNaXNz\naW5nUmVwbGljYXMobGgxLmdldElkKCksIDEwLCBzaHV0ZG93bkJvb2tpZSkp\nOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQgPSAzMDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RUb2dnbGVMZWRnZXJSZXBsaWNhdGlvbigpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIExlZGdlckhhbmRsZSBsaDEgPSBjcmVhdGVB\nbmRBZGRFbnRyaWVzVG9MZWRnZXIoKTsKICAgICAgICBsZWRnZXJMaXN0LmFk\nZChsaDEuZ2V0SWQoKSk7CiAgICAgICAgTE9HLmRlYnVnKCJDcmVhdGVkIGZv\nbGxvd2luZyBsZWRnZXJzIDogIiArIGxlZGdlckxpc3QpOwoKICAgICAgICAv\nLyBmYWlsaW5nIGFub3RoZXIgYm9va2llCiAgICAgICAgQ291bnREb3duTGF0\nY2ggdXJSZXBsaWNhTGF0Y2ggPSByZWdpc3RlclVyTGVkZ2VyV2F0Y2hlcihs\nZWRnZXJMaXN0CiAgICAgICAgICAgICAgICAuc2l6ZSgpKTsKCiAgICAgICAg\nLy8gZGlzYWJsaW5nIGxlZGdlciByZXBsaWNhdGlvbgogICAgICAgIHVyTGVk\nZ2VyTWdyLmRpc2FibGVMZWRnZXJSZXBsaWNhdGlvbigpOwogICAgICAgIEFy\ncmF5TGlzdDxTdHJpbmc+IHNodXRkb3duQm9va2llTGlzdCA9IG5ldyBBcnJh\neUxpc3Q8U3RyaW5nPigpOwogICAgICAgIHNodXRkb3duQm9va2llTGlzdC5h\nZGQoc2h1dGRvd25Cb29raWUoYnMuc2l6ZSgpIC0gMSkpOwogICAgICAgIHNo\ndXRkb3duQm9va2llTGlzdC5hZGQoc2h1dGRvd25Cb29raWUoYnMuc2l6ZSgp\nIC0gMSkpOwoKICAgICAgICBhc3NlcnRGYWxzZSgiTGVkZ2VyIHJlcGxpY2F0\naW9uIGlzIG5vdCBkaXNhYmxlZCEiLCB1clJlcGxpY2FMYXRjaAogICAgICAg\nICAgICAgICAgLmF3YWl0KDUsIFRpbWVVbml0LlNFQ09ORFMpKTsKCiAgICAg\nICAgLy8gZW5hYmxpbmcgbGVkZ2VyIHJlcGxpY2F0aW9uCiAgICAgICAgdXJM\nZWRnZXJNZ3IuZW5hYmxlTGVkZ2VyUmVwbGljYXRpb24oKTsKICAgICAgICBh\nc3NlcnRUcnVlKCJMZWRnZXIgcmVwbGljYXRpb24gaXMgbm90IGVuYWJsZWQh\nIiwgdXJSZXBsaWNhTGF0Y2guYXdhaXQoCiAgICAgICAgICAgICAgICA1LCBU\naW1lVW5pdC5TRUNPTkRTKSk7CiAgICB9CgogICAgQFRlc3QodGltZW91dCA9\nIDIwMDAwKQogICAgcHVibGljIHZvaWQgdGVzdER1cGxpY2F0ZUVuRGlzYWJs\nZUF1dG9SZWNvdmVyeSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHVy\nTGVkZ2VyTWdyLmRpc2FibGVMZWRnZXJSZXBsaWNhdGlvbigpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHVyTGVkZ2VyTWdyLmRpc2FibGVMZWRnZXJS\nZXBsaWNhdGlvbigpOwogICAgICAgICAgICBmYWlsKCJNdXN0IHRocm93IGV4\nY2VwdGlvbiwgc2luY2UgQXV0b1JlY292ZXJ5IGlzIGFscmVhZHkgZGlzYWJs\nZWQiKTsKICAgICAgICB9IGNhdGNoIChVbmF2YWlsYWJsZUV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoIkF1dG9SZWNvdmVyeSBpcyBu\nb3QgZGlzYWJsZWQgcHJldmlvdXNseSEiLAogICAgICAgICAgICAgICAgICAg\nIGUuZ2V0Q2F1c2UoKSBpbnN0YW5jZW9mIEtlZXBlckV4Y2VwdGlvbi5Ob2Rl\nRXhpc3RzRXhjZXB0aW9uKTsKICAgICAgICB9CiAgICAgICAgdXJMZWRnZXJN\nZ3IuZW5hYmxlTGVkZ2VyUmVwbGljYXRpb24oKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICB1ckxlZGdlck1nci5lbmFibGVMZWRnZXJSZXBsaWNhdGlv\nbigpOwogICAgICAgICAgICBmYWlsKCJNdXN0IHRocm93IGV4Y2VwdGlvbiwg\nc2luY2UgQXV0b1JlY292ZXJ5IGlzIGFscmVhZHkgZW5hYmxlZCIpOwogICAg\nICAgIH0gY2F0Y2ggKFVuYXZhaWxhYmxlRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZSgiQXV0b1JlY292ZXJ5IGlzIG5vdCBlbmFibGVk\nIHByZXZpb3VzbHkhIiwKICAgICAgICAgICAgICAgICAgICBlLmdldENhdXNl\nKCkgaW5zdGFuY2VvZiBLZWVwZXJFeGNlcHRpb24uTm9Ob2RlRXhjZXB0aW9u\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IEF1ZGl0\nb3Igc2hvdWxkIGNvbnNpZGVyIFJlYWRvbmx5IGJvb2tpZSBhcyBhdmFpbGFi\nbGUgYm9va2llLiBTaG91bGQgbm90IHB1Ymxpc2ggdXIgbGVkZ2VycyBmb3IK\nICAgICAqIHJlYWRvbmx5IGJvb2tpZXMuCiAgICAgKi8KICAgIEBUZXN0KHRp\nbWVvdXQgPSAyMDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RSZWFkT25seUJv\nb2tpZUV4Y2x1c2lvbkZyb21VUkxlZGdlcnNDaGVjaygpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGNyZWF0ZUFuZEFk\nZEVudHJpZXNUb0xlZGdlcigpOwogICAgICAgIGxlZGdlckxpc3QuYWRkKGxo\nLmdldElkKCkpOwogICAgICAgIExPRy5kZWJ1ZygiQ3JlYXRlZCBmb2xsb3dp\nbmcgbGVkZ2VycyA6ICIgKyBsZWRnZXJMaXN0KTsKCiAgICAgICAgaW50IGNv\ndW50ID0gbGVkZ2VyTGlzdC5zaXplKCk7CiAgICAgICAgZmluYWwgQ291bnRE\nb3duTGF0Y2ggdW5kZXJSZXBsaWNhTGF0Y2ggPSByZWdpc3RlclVyTGVkZ2Vy\nV2F0Y2hlcihjb3VudCk7CgogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24g\nYm9va2llQ29uZiA9IGJzQ29uZnMuZ2V0KDIpOwogICAgICAgIEJvb2tpZVNl\ncnZlciBiayA9IGJzLmdldCgyKTsKICAgICAgICBib29raWVDb25mLnNldFJl\nYWRPbmx5TW9kZUVuYWJsZWQodHJ1ZSk7CiAgICAgICAgYmsuZ2V0Qm9va2ll\nKCkudHJhbnNpdGlvblRvUmVhZE9ubHlNb2RlKCk7CgogICAgICAgIC8vIGdy\nYWNlIHBlcmlvZCBmb3IgcHVibGlzaGluZyB0aGUgYmstbGVkZ2VyCiAgICAg\nICAgTE9HLmRlYnVnKCJXYWl0aW5nIGZvciBBdWRpdG9yIHRvIGZpbmlzaCBs\nZWRnZXIgY2hlY2suIik7CiAgICAgICAgYXNzZXJ0RmFsc2UoImxhdGNoIHNo\nb3VsZCBub3QgaGF2ZSBjb21wbGV0ZWQiLCB1bmRlclJlcGxpY2FMYXRjaC5h\nd2FpdCg1LCBUaW1lVW5pdC5TRUNPTkRTKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXYWl0IGZvciBsZWRnZXIgdG8gYmUgdW5kZXJyZXBsaWNhdGVkLCBh\nbmQgdG8gYmUgbWlzc2luZyBhbGwgcmVwbGljYXMgc3BlY2lmaWVkCiAgICAg\nKi8KICAgIHByaXZhdGUgYm9vbGVhbiB3YWl0Rm9yTGVkZ2VyTWlzc2luZ1Jl\ncGxpY2FzKExvbmcgbGVkZ2VySWQsIGxvbmcgc2Vjb25kc1RvV2FpdCwgU3Ry\naW5nLi4uIHJlcGxpY2FzKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlY29uZHNUb1dhaXQ7\nIGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgVW5k\nZXJyZXBsaWNhdGVkTGVkZ2VyRm9ybWF0IGRhdGEgPSB1ckxlZGdlck1nci5n\nZXRMZWRnZXJVbnJlcGxpY2F0aW9uSW5mbyhsZWRnZXJJZCk7CiAgICAgICAg\nICAgICAgICBib29sZWFuIGFsbCA9IHRydWU7CiAgICAgICAgICAgICAgICBm\nb3IgKFN0cmluZyByIDogcmVwbGljYXMpIHsKICAgICAgICAgICAgICAgICAg\nICBhbGwgPSBhbGwgJiYgZGF0YS5nZXRSZXBsaWNhTGlzdCgpLmNvbnRhaW5z\nKHIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGFs\nbCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgLy8gbWF5IG5vdCBmaW5kIG5vZGUKICAgICAg\nICAgICAgfQogICAgICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBwcml2YXRl\nIENvdW50RG93bkxhdGNoIHJlZ2lzdGVyVXJMZWRnZXJXYXRjaGVyKGludCBj\nb3VudCkKICAgICAgICAgICAgdGhyb3dzIEtlZXBlckV4Y2VwdGlvbiwgSW50\nZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIGZpbmFsIENvdW50RG93bkxh\ndGNoIHVuZGVyUmVwbGljYUxhdGNoID0gbmV3IENvdW50RG93bkxhdGNoKGNv\ndW50KTsKICAgICAgICBmb3IgKExvbmcgbGVkZ2VySWQgOiBsZWRnZXJMaXN0\nKSB7CiAgICAgICAgICAgIFdhdGNoZXIgdXJMZWRnZXJXYXRjaGVyID0gbmV3\nIENoaWxkV2F0Y2hlcih1bmRlclJlcGxpY2FMYXRjaCk7CiAgICAgICAgICAg\nIFN0cmluZyB6bm9kZSA9IFprTGVkZ2VyVW5kZXJyZXBsaWNhdGlvbk1hbmFn\nZXIuZ2V0VXJMZWRnZXJabm9kZShVTkRFUlJFUExJQ0FURURfUEFUSCwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZGdlcklkKTsKICAgICAg\nICAgICAgemtjLmV4aXN0cyh6bm9kZSwgdXJMZWRnZXJXYXRjaGVyKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIHVuZGVyUmVwbGljYUxhdGNoOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBkb0xlZGdlclJlcmVwbGljYXRpb24oTG9u\nZy4uLiBsZWRnZXJJZHMpCiAgICAgICAgICAgIHRocm93cyBVbmF2YWlsYWJs\nZUV4Y2VwdGlvbiB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBsZWRn\nZXJJZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgbG9uZyBsaWQgPSB1\nckxlZGdlck1nci5nZXRMZWRnZXJUb1JlcmVwbGljYXRlKCk7CiAgICAgICAg\nICAgIGFzc2VydFRydWUoIlJlY2VpdmVkIHVuZXhwZWN0ZWQgbGVkZ2VyaWQi\nLCBBcnJheXMuYXNMaXN0KGxlZGdlcklkcykuY29udGFpbnMobGlkKSk7CiAg\nICAgICAgICAgIHVyTGVkZ2VyTWdyLm1hcmtMZWRnZXJSZXBsaWNhdGVkKGxp\nZCk7CiAgICAgICAgICAgIHVyTGVkZ2VyTWdyLnJlbGVhc2VVbmRlcnJlcGxp\nY2F0ZWRMZWRnZXIobGlkKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0\nZSBTdHJpbmcgc2h1dGRvd25Cb29raWUoaW50IGJrU2h1dGRvd25JbmRleCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQm9va2llU2VydmVyIGJrU2Vy\ndmVyID0gYnMuZ2V0KGJrU2h1dGRvd25JbmRleCk7CiAgICAgICAgU3RyaW5n\nIGJvb2tpZUFkZHIgPSBTdHJpbmdVdGlscy5hZGRyVG9TdHJpbmcoYmtTZXJ2\nZXIuZ2V0TG9jYWxBZGRyZXNzKCkpOwogICAgICAgIExPRy5kZWJ1ZygiU2h1\ndHRpbmcgZG93biBib29raWU6IiArIGJvb2tpZUFkZHIpOwogICAgICAgIGtp\nbGxCb29raWUoYmtTaHV0ZG93bkluZGV4KTsKICAgICAgICBhdWRpdG9yRWxl\nY3RvcnMuZ2V0KGJvb2tpZUFkZHIpLnNodXRkb3duKCk7CiAgICAgICAgYXVk\naXRvckVsZWN0b3JzLnJlbW92ZShib29raWVBZGRyKTsKICAgICAgICByZXR1\ncm4gYm9va2llQWRkcjsKICAgIH0KCiAgICBwcml2YXRlIExlZGdlckhhbmRs\nZSBjcmVhdGVBbmRBZGRFbnRyaWVzVG9MZWRnZXIoKSB0aHJvd3MgQktFeGNl\ncHRpb24sCiAgICAgICAgICAgIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAg\nICAgICBpbnQgbnVtRW50cmllc1RvV3JpdGUgPSAxMDA7CiAgICAgICAgLy8g\nQ3JlYXRlIGEgbGVkZ2VyCiAgICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtj\nLmNyZWF0ZUxlZGdlcihkaWdlc3RUeXBlLCBsZWRnZXJQYXNzd29yZCk7CiAg\nICAgICAgTE9HLmluZm8oIkxlZGdlciBJRDogIiArIGxoLmdldElkKCkpOwog\nICAgICAgIGFkZEVudHJ5KG51bUVudHJpZXNUb1dyaXRlLCBsaCk7CiAgICAg\nICAgcmV0dXJuIGxoOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhZGRFbnRy\neShpbnQgbnVtRW50cmllc1RvV3JpdGUsIExlZGdlckhhbmRsZSBsaCkKICAg\nICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2Vw\ndGlvbiB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbnRyaWVz\nVG9Xcml0ZTsgaSsrKSB7CiAgICAgICAgICAgIEJ5dGVCdWZmZXIgZW50cnkg\nPSBCeXRlQnVmZmVyLmFsbG9jYXRlKDQpOwogICAgICAgICAgICBlbnRyeS5w\ndXRJbnQocm5nLm5leHRJbnQoSW50ZWdlci5NQVhfVkFMVUUpKTsKICAgICAg\nICAgICAgZW50cnkucG9zaXRpb24oMCk7CiAgICAgICAgICAgIGxoLmFkZEVu\ndHJ5KGVudHJ5LmFycmF5KCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2\nYXRlIE1hcDxMb25nLCBTdHJpbmc+IGdldFVyTGVkZ2VyRGF0YShTZXQ8TG9u\nZz4gdXJMZWRnZXJMaXN0KQogICAgICAgICAgICB0aHJvd3MgS2VlcGVyRXhj\nZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgTWFwPExv\nbmcsIFN0cmluZz4gdXJMZWRnZXJEYXRhID0gbmV3IEhhc2hNYXA8TG9uZywg\nU3RyaW5nPigpOwogICAgICAgIGZvciAoTG9uZyBsZWRnZXJJZCA6IHVyTGVk\nZ2VyTGlzdCkgewogICAgICAgICAgICBTdHJpbmcgem5vZGUgPSBaa0xlZGdl\nclVuZGVycmVwbGljYXRpb25NYW5hZ2VyLmdldFVyTGVkZ2VyWm5vZGUoVU5E\nRVJSRVBMSUNBVEVEX1BBVEgsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBsZWRnZXJJZCk7CiAgICAgICAgICAgIGJ5dGVbXSBkYXRhID0gemtj\nLmdldERhdGEoem5vZGUsIGZhbHNlLCBudWxsKTsKICAgICAgICAgICAgdXJM\nZWRnZXJEYXRhLnB1dChsZWRnZXJJZCwgbmV3IFN0cmluZyhkYXRhKSk7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiB1ckxlZGdlckRhdGE7CiAgICB9Cgog\nICAgcHJpdmF0ZSBjbGFzcyBDaGlsZFdhdGNoZXIgaW1wbGVtZW50cyBXYXRj\naGVyIHsKICAgICAgICBwcml2YXRlIGZpbmFsIENvdW50RG93bkxhdGNoIHVu\nZGVyUmVwbGljYUxhdGNoOwoKICAgICAgICBwdWJsaWMgQ2hpbGRXYXRjaGVy\nKENvdW50RG93bkxhdGNoIHVuZGVyUmVwbGljYUxhdGNoKSB7CiAgICAgICAg\nICAgIHRoaXMudW5kZXJSZXBsaWNhTGF0Y2ggPSB1bmRlclJlcGxpY2FMYXRj\naDsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyB2b2lkIHByb2Nlc3MoV2F0Y2hlZEV2ZW50IGV2ZW50KSB7CiAgICAgICAg\nICAgIExPRy5pbmZvKCJSZWNlaXZlZCBub3RpZmljYXRpb24gZm9yIHRoZSBs\nZWRnZXIgcGF0aCA6ICIKICAgICAgICAgICAgICAgICAgICArIGV2ZW50Lmdl\ndFBhdGgoKSk7CiAgICAgICAgICAgIGZvciAoTG9uZyBsZWRnZXJJZCA6IGxl\nZGdlckxpc3QpIHsKICAgICAgICAgICAgICAgIGlmIChldmVudC5nZXRQYXRo\nKCkuY29udGFpbnMobGVkZ2VySWQgKyAiIikpIHsKICAgICAgICAgICAgICAg\nICAgICB1ckxlZGdlckxpc3QuYWRkKExvbmcudmFsdWVPZihsZWRnZXJJZCkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAg\nIExPRy5kZWJ1ZygiQ291bnQgZG93biBhbmQgd2FpdGluZyBmb3IgbmV4dCBu\nb3RpZmljYXRpb24iKTsKICAgICAgICAgICAgLy8gY291bnQgZG93biBhbmQg\nd2FpdGluZyBmb3IgbmV4dCBub3RpZmljYXRpb24KICAgICAgICAgICAgdW5k\nZXJSZXBsaWNhTGF0Y2guY291bnREb3duKCk7CiAgICAgICAgfQogICAgfQp9\nCg==\n","encoding":"base64"}

