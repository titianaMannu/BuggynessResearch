{"sha":"18a4265f4a4be8d7c6c743eed369705b495515c0","node_id":"MDQ6QmxvYjE1NzU5NTY6MThhNDI2NWY0YTRiZThkN2M2Yzc0M2VlZDM2OTcwNWI0OTU1MTVjMA==","size":21384,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/18a4265f4a4be8d7c6c743eed369705b495515c0","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKCmltcG9ydCBqYXZhLnV0aWwuRW51bWVyYXRp\nb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS5uZXQu\nSW5ldEFkZHJlc3M7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IG9yZy5qdW5pdC5U\nZXN0OwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5p\ndC5BZnRlcjsKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5Cb29raWU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tpZUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuRmls\nZVN5c3RlbVVwZ3JhZGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkJvb2tLZWVwZXJBZG1pbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jb25mLkNsaWVudENvbmZpZ3VyYXRpb247CgpwdWJsaWMgY2xh\nc3MgVGVzdEJhY2t3YXJkQ29tcGF0IHsKICAgIHN0YXRpYyBMb2dnZXIgTE9H\nID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoVGVzdEJhY2t3YXJkQ29tcGF0\nLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBab29LZWVwZXJVdGlsIHpr\nVXRpbCA9IG5ldyBab29LZWVwZXJVdGlsKCk7OwogICAgcHJpdmF0ZSBzdGF0\naWMgYnl0ZVtdIEVOVFJZX0RBVEEgPSAiVGhpc0lzQW5FbnRyeSIuZ2V0Qnl0\nZXMoKTsKCiAgICBzdGF0aWMgdm9pZCB3YWl0VXAoaW50IHBvcnQpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIHdoaWxlKHprVXRpbC5nZXRab29LZWVw\nZXJDbGllbnQoKS5leGlzdHMoCiAgICAgICAgICAgICAgICAgICAgICAiL2xl\nZGdlcnMvYXZhaWxhYmxlLyIgKyBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3Qo\nKS5nZXRIb3N0QWRkcmVzcygpICsgIjoiICsgcG9ydCwKICAgICAgICAgICAg\nICAgICAgICAgIGZhbHNlKSA9PSBudWxsKSB7CiAgICAgICAgICAgIFRocmVh\nZC5zbGVlcCg1MDApOwogICAgICAgIH0KICAgIH0KICAgIEBCZWZvcmUKICAg\nIHB1YmxpYyB2b2lkIHN0YXJ0Wm9vS2VlcGVyU2VydmVyKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgemtVdGlsLnN0YXJ0U2VydmVyKCk7CiAgICB9\nCgogICAgQEFmdGVyCiAgICBwdWJsaWMgdm9pZCBzdG9wWm9vS2VlcGVyU2Vy\ndmVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgemtVdGlsLmtpbGxT\nZXJ2ZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFZlcnNpb24gNC4wLjAg\nY2xhc3NlcwogICAgICovCiAgICBzdGF0aWMgY2xhc3MgU2VydmVyNDAwIHsK\nICAgICAgICBvcmcuYXBhY2hlLmJrX3Y0XzBfMC5ib29ra2VlcGVyLmNvbmYu\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mOwogICAgICAgIG9yZy5hcGFjaGUu\nYmtfdjRfMF8wLmJvb2trZWVwZXIucHJvdG8uQm9va2llU2VydmVyIHNlcnZl\nciA9IG51bGw7CgogICAgICAgIFNlcnZlcjQwMChGaWxlIGpvdXJuYWxEaXIs\nIEZpbGUgbGVkZ2VyRGlyLCBpbnQgcG9ydCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIGNvbmYgPSBuZXcgb3JnLmFwYWNoZS5ia192NF8wXzAu\nYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24oKTsKICAgICAg\nICAgICAgY29uZi5zZXRCb29raWVQb3J0KHBvcnQpOwogICAgICAgICAgICBj\nb25mLnNldFprU2VydmVycyh6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0\ncmluZygpKTsKICAgICAgICAgICAgY29uZi5zZXRKb3VybmFsRGlyTmFtZShq\nb3VybmFsRGlyLmdldFBhdGgoKSk7CiAgICAgICAgICAgIGNvbmYuc2V0TGVk\nZ2VyRGlyTmFtZXMobmV3IFN0cmluZ1tdIHsgbGVkZ2VyRGlyLmdldFBhdGgo\nKSB9KTsKICAgICAgICB9CgogICAgICAgIHZvaWQgc3RhcnQoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgc2VydmVyID0gbmV3IG9yZy5hcGFj\naGUuYmtfdjRfMF8wLmJvb2trZWVwZXIucHJvdG8uQm9va2llU2VydmVyKGNv\nbmYpOwogICAgICAgICAgICBzZXJ2ZXIuc3RhcnQoKTsKICAgICAgICAgICAg\nd2FpdFVwKGNvbmYuZ2V0Qm9va2llUG9ydCgpKTsKICAgICAgICB9CgogICAg\nICAgIG9yZy5hcGFjaGUuYmtfdjRfMF8wLmJvb2trZWVwZXIuY29uZi5TZXJ2\nZXJDb25maWd1cmF0aW9uIGdldENvbmYoKSB7CiAgICAgICAgICAgIHJldHVy\nbiBjb25mOwogICAgICAgIH0KCiAgICAgICAgdm9pZCBzdG9wKCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChzZXJ2ZXIgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgc2VydmVyLnNodXRkb3duKCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgc3RhdGljIGNsYXNzIExlZGdl\ncjQwMCB7CiAgICAgICAgb3JnLmFwYWNoZS5ia192NF8wXzAuYm9va2tlZXBl\nci5jbGllbnQuQm9va0tlZXBlciBiazsKICAgICAgICBvcmcuYXBhY2hlLmJr\nX3Y0XzBfMC5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGUgbGg7Cgog\nICAgICAgIHByaXZhdGUgTGVkZ2VyNDAwKG9yZy5hcGFjaGUuYmtfdjRfMF8w\nLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIgYmssCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5ia192NF8wXzAuYm9va2tlZXBl\nci5jbGllbnQuTGVkZ2VySGFuZGxlIGxoKSB7CiAgICAgICAgICAgIHRoaXMu\nYmsgPSBiazsKICAgICAgICAgICAgdGhpcy5saCA9IGxoOwogICAgICAgIH0K\nCiAgICAgICAgc3RhdGljIExlZGdlcjQwMCBuZXdMZWRnZXIoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgb3JnLmFwYWNoZS5ia192NF8wXzAu\nYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlciBuZXdiawogICAgICAgICAg\nICAgICAgPSBuZXcgb3JnLmFwYWNoZS5ia192NF8wXzAuYm9va2tlZXBlci5j\nbGllbnQuQm9va0tlZXBlcih6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0\ncmluZygpKTsKICAgICAgICAgICAgb3JnLmFwYWNoZS5ia192NF8wXzAuYm9v\na2tlZXBlci5jbGllbnQuTGVkZ2VySGFuZGxlIG5ld2xoCiAgICAgICAgICAg\nICAgICA9IG5ld2JrLmNyZWF0ZUxlZGdlcigxLCAxLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5ia192NF8wXzAuYm9v\na2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImZvb2JhciIuZ2V0\nQnl0ZXMoKSk7CiAgICAgICAgICAgIHJldHVybiBuZXcgTGVkZ2VyNDAwKG5l\nd2JrLCBuZXdsaCk7CiAgICAgICAgfQoKICAgICAgICBzdGF0aWMgTGVkZ2Vy\nNDAwIG9wZW5MZWRnZXIobG9uZyBpZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIG9yZy5hcGFjaGUuYmtfdjRfMF8wLmJvb2trZWVwZXIuY2xp\nZW50LkJvb2tLZWVwZXIgbmV3YmsKICAgICAgICAgICAgICAgID0gbmV3IG9y\nZy5hcGFjaGUuYmtfdjRfMF8wLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVw\nZXIoemtVdGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSk7CiAgICAg\nICAgICAgIG9yZy5hcGFjaGUuYmtfdjRfMF8wLmJvb2trZWVwZXIuY2xpZW50\nLkxlZGdlckhhbmRsZSBuZXdsaAogICAgICAgICAgICAgICAgPSBuZXdiay5v\ncGVuTGVkZ2VyKGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG9yZy5hcGFjaGUuYmtfdjRfMF8wLmJvb2trZWVwZXIuY2xpZW50LkJvb2tL\nZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAiZm9vYmFyIi5nZXRCeXRlcygpKTsKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBMZWRnZXI0MDAobmV3YmssIG5ld2xoKTsKICAgICAgICB9\nCgogICAgICAgIGxvbmcgZ2V0SWQoKSB7CiAgICAgICAgICAgIHJldHVybiBs\naC5nZXRJZCgpOwogICAgICAgIH0KCiAgICAgICAgdm9pZCB3cml0ZTEwMCgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IDEwMDsgaSsrKSB7CiAgICAgICAgICAgICAgICBsaC5hZGRFbnRy\neShFTlRSWV9EQVRBKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgbG9uZyByZWFkQWxsKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIGxvbmcgY291bnQgPSAwOwogICAgICAgICAgICBFbnVtZXJhdGlvbjxv\ncmcuYXBhY2hlLmJrX3Y0XzBfMC5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJF\nbnRyeT4gZW50cmllcwogICAgICAgICAgICAgICAgPSBsaC5yZWFkRW50cmll\ncygwLCBsaC5nZXRMYXN0QWRkQ29uZmlybWVkKCkpOwogICAgICAgICAgICB3\naGlsZSAoZW50cmllcy5oYXNNb3JlRWxlbWVudHMoKSkgewogICAgICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZSgiZW50cnkgZGF0YSBkb2Vzbid0IG1hdGNoIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXlzLmVxdWFscyhlbnRy\naWVzLm5leHRFbGVtZW50KCkuZ2V0RW50cnkoKSwgRU5UUllfREFUQSkpOwog\nICAgICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgICAgfQogICAgICAg\nICAgICByZXR1cm4gY291bnQ7CiAgICAgICAgfQoKICAgICAgICB2b2lkIGNs\nb3NlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBpZiAobGggIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIGxoLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoYmsgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgIGJrLmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBWZXJzaW9uIDQuMS4wIGNsYXNzZXMKICAgICAqLwogICAg\nc3RhdGljIGNsYXNzIFNlcnZlcjQxMCB7CiAgICAgICAgb3JnLmFwYWNoZS5i\na192NF8xXzAuYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb24g\nY29uZjsKICAgICAgICBvcmcuYXBhY2hlLmJrX3Y0XzFfMC5ib29ra2VlcGVy\nLnByb3RvLkJvb2tpZVNlcnZlciBzZXJ2ZXIgPSBudWxsOwoKICAgICAgICBT\nZXJ2ZXI0MTAoRmlsZSBqb3VybmFsRGlyLCBGaWxlIGxlZGdlckRpciwgaW50\nIHBvcnQpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBjb25mID0g\nbmV3IG9yZy5hcGFjaGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY29uZi5TZXJ2\nZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGNvbmYuc2V0Qm9va2ll\nUG9ydChwb3J0KTsKICAgICAgICAgICAgY29uZi5zZXRaa1NlcnZlcnMoemtV\ndGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSk7CiAgICAgICAgICAg\nIGNvbmYuc2V0Sm91cm5hbERpck5hbWUoam91cm5hbERpci5nZXRQYXRoKCkp\nOwogICAgICAgICAgICBjb25mLnNldExlZGdlckRpck5hbWVzKG5ldyBTdHJp\nbmdbXSB7IGxlZGdlckRpci5nZXRQYXRoKCkgfSk7CiAgICAgICAgfQoKICAg\nICAgICB2b2lkIHN0YXJ0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIHNlcnZlciA9IG5ldyBvcmcuYXBhY2hlLmJrX3Y0XzFfMC5ib29ra2Vl\ncGVyLnByb3RvLkJvb2tpZVNlcnZlcihjb25mKTsKICAgICAgICAgICAgc2Vy\ndmVyLnN0YXJ0KCk7CiAgICAgICAgICAgIHdhaXRVcChjb25mLmdldEJvb2tp\nZVBvcnQoKSk7CiAgICAgICAgfQoKICAgICAgICBvcmcuYXBhY2hlLmJrX3Y0\nXzFfMC5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbiBnZXRD\nb25mKCkgewogICAgICAgICAgICByZXR1cm4gY29uZjsKICAgICAgICB9Cgog\nICAgICAgIHZvaWQgc3RvcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBpZiAoc2VydmVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHNl\ncnZlci5zaHV0ZG93bigpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIHN0YXRpYyBjbGFzcyBMZWRnZXI0MTAgewogICAgICAgIG9yZy5h\ncGFjaGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIg\nYms7CiAgICAgICAgb3JnLmFwYWNoZS5ia192NF8xXzAuYm9va2tlZXBlci5j\nbGllbnQuTGVkZ2VySGFuZGxlIGxoOwoKICAgICAgICBwcml2YXRlIExlZGdl\ncjQxMChvcmcuYXBhY2hlLmJrX3Y0XzFfMC5ib29ra2VlcGVyLmNsaWVudC5C\nb29rS2VlcGVyIGJrLAogICAgICAgICAgICAgICAgICAgICAgICAgIG9yZy5h\ncGFjaGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRs\nZSBsaCkgewogICAgICAgICAgICB0aGlzLmJrID0gYms7CiAgICAgICAgICAg\nIHRoaXMubGggPSBsaDsKICAgICAgICB9CgogICAgICAgIHN0YXRpYyBMZWRn\nZXI0MTAgbmV3TGVkZ2VyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIG9yZy5hcGFjaGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY2xpZW50LkJv\nb2tLZWVwZXIgbmV3YmsKICAgICAgICAgICAgICAgID0gbmV3IG9yZy5hcGFj\naGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIoemtV\ndGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSk7CiAgICAgICAgICAg\nIG9yZy5hcGFjaGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nckhhbmRsZSBuZXdsaAogICAgICAgICAgICAgICAgPSBuZXdiay5jcmVhdGVM\nZWRnZXIoMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG9yZy5hcGFjaGUuYmtfdjRfMV8wLmJvb2trZWVwZXIuY2xpZW50LkJvb2tL\nZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICJmb29iYXIiLmdldEJ5dGVzKCkpOwogICAgICAgICAg\nICByZXR1cm4gbmV3IExlZGdlcjQxMChuZXdiaywgbmV3bGgpOwogICAgICAg\nIH0KCiAgICAgICAgc3RhdGljIExlZGdlcjQxMCBvcGVuTGVkZ2VyKGxvbmcg\naWQpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBvcmcuYXBhY2hl\nLmJrX3Y0XzFfMC5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyIG5ld2Jr\nCiAgICAgICAgICAgICAgICA9IG5ldyBvcmcuYXBhY2hlLmJrX3Y0XzFfMC5i\nb29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyKHprVXRpbC5nZXRab29LZWVw\nZXJDb25uZWN0U3RyaW5nKCkpOwogICAgICAgICAgICBvcmcuYXBhY2hlLmJr\nX3Y0XzFfMC5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGUgbmV3bGgK\nICAgICAgICAgICAgICAgID0gbmV3Ymsub3BlbkxlZGdlcihpZCwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJrX3Y0XzFf\nMC5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2VzdFR5cGUuQ1JD\nMzIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImZvb2JhciIu\nZ2V0Qnl0ZXMoKSk7CiAgICAgICAgICAgIHJldHVybiBuZXcgTGVkZ2VyNDEw\nKG5ld2JrLCBuZXdsaCk7CiAgICAgICAgfQoKICAgICAgICBsb25nIGdldElk\nKCkgewogICAgICAgICAgICByZXR1cm4gbGguZ2V0SWQoKTsKICAgICAgICB9\nCgogICAgICAgIHZvaWQgd3JpdGUxMDAoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxMDA7IGkrKykgewog\nICAgICAgICAgICAgICAgbGguYWRkRW50cnkoRU5UUllfREFUQSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGxvbmcgcmVhZEFsbCgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIGNvdW50ID0gMDsK\nICAgICAgICAgICAgRW51bWVyYXRpb248b3JnLmFwYWNoZS5ia192NF8xXzAu\nYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRW50cnk+IGVudHJpZXMKICAgICAg\nICAgICAgICAgID0gbGgucmVhZEVudHJpZXMoMCwgbGguZ2V0TGFzdEFkZENv\nbmZpcm1lZCgpKTsKICAgICAgICAgICAgd2hpbGUgKGVudHJpZXMuaGFzTW9y\nZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUoImVu\ndHJ5IGRhdGEgZG9lc24ndCBtYXRjaCIsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgIEFycmF5cy5lcXVhbHMoZW50cmllcy5uZXh0RWxlbWVudCgpLmdl\ndEVudHJ5KCksIEVOVFJZX0RBVEEpKTsKICAgICAgICAgICAgICAgIGNvdW50\nKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGNvdW50Owog\nICAgICAgIH0KCiAgICAgICAgdm9pZCBjbG9zZSgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKGxo\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBsaC5jbG9zZSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgaWYgKGJrICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICBiay5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3VycmVudCB2\nZXJpb24gY2xhc3NlcwogICAgICovCiAgICBzdGF0aWMgY2xhc3MgU2VydmVy\nQ3VycmVudCB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYu\nU2VydmVyQ29uZmlndXJhdGlvbiBjb25mOwogICAgICAgIG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5wcm90by5Cb29raWVTZXJ2ZXIgc2VydmVyID0gbnVsbDsK\nCiAgICAgICAgU2VydmVyQ3VycmVudChGaWxlIGpvdXJuYWxEaXIsIEZpbGUg\nbGVkZ2VyRGlyLCBpbnQgcG9ydCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIGNvbmYgPSBuZXcgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYu\nU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBjb25mLnNldEJv\nb2tpZVBvcnQocG9ydCk7CiAgICAgICAgICAgIGNvbmYuc2V0QWxsb3dMb29w\nYmFjayh0cnVlKTsKICAgICAgICAgICAgY29uZi5zZXRaa1NlcnZlcnMoemtV\ndGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSk7CiAgICAgICAgICAg\nIGNvbmYuc2V0Sm91cm5hbERpck5hbWUoam91cm5hbERpci5nZXRQYXRoKCkp\nOwogICAgICAgICAgICBjb25mLnNldExlZGdlckRpck5hbWVzKG5ldyBTdHJp\nbmdbXSB7IGxlZGdlckRpci5nZXRQYXRoKCkgfSk7CiAgICAgICAgfQoKICAg\nICAgICB2b2lkIHN0YXJ0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIHNlcnZlciA9IG5ldyBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8u\nQm9va2llU2VydmVyKGNvbmYpOwogICAgICAgICAgICBzZXJ2ZXIuc3RhcnQo\nKTsKICAgICAgICAgICAgd2FpdFVwKGNvbmYuZ2V0Qm9va2llUG9ydCgpKTsK\nICAgICAgICB9CgogICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25m\nLlNlcnZlckNvbmZpZ3VyYXRpb24gZ2V0Q29uZigpIHsKICAgICAgICAgICAg\ncmV0dXJuIGNvbmY7CiAgICAgICAgfQoKICAgICAgICB2b2lkIHN0b3AoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKHNlcnZlciAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICBzZXJ2ZXIuc2h1dGRvd24oKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBzdGF0aWMgY2xhc3Mg\nTGVkZ2VyQ3VycmVudCB7CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNsaWVudC5Cb29rS2VlcGVyIGJrOwogICAgICAgIG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuTGVkZ2VySGFuZGxlIGxoOwoKICAgICAgICBwcml2\nYXRlIExlZGdlckN1cnJlbnQob3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVu\ndC5Cb29rS2VlcGVyIGJrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZSBs\naCkgewogICAgICAgICAgICB0aGlzLmJrID0gYms7CiAgICAgICAgICAgIHRo\naXMubGggPSBsaDsKICAgICAgICB9CgogICAgICAgIHN0YXRpYyBMZWRnZXJD\ndXJyZW50IG5ld0xlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIg\nbmV3YmsKICAgICAgICAgICAgICAgID0gbmV3IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jbGllbnQuQm9va0tlZXBlcih6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29u\nbmVjdFN0cmluZygpKTsKICAgICAgICAgICAgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5MZWRnZXJIYW5kbGUgbmV3bGgKICAgICAgICAgICAgICAg\nID0gbmV3YmsuY3JlYXRlTGVkZ2VyKDEsIDEsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xp\nZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZS5DUkMzMiwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICJmb29iYXIiLmdldEJ5dGVzKCkp\nOwogICAgICAgICAgICByZXR1cm4gbmV3IExlZGdlckN1cnJlbnQobmV3Ymss\nIG5ld2xoKTsKICAgICAgICB9CgogICAgICAgIHN0YXRpYyBMZWRnZXJDdXJy\nZW50IG9wZW5MZWRnZXIobG9uZyBpZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tl\nZXBlciBuZXdiawogICAgICAgICAgICAgICAgPSBuZXcgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyKHprVXRpbC5nZXRab29LZWVw\nZXJDb25uZWN0U3RyaW5nKCkpOwogICAgICAgICAgICBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZSBuZXdsaAogICAgICAgICAg\nICAgICAgPSBuZXdiay5vcGVuTGVkZ2VyKGlkLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQu\nQm9va0tlZXBlci5EaWdlc3RUeXBlLkNSQzMyLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICJmb29iYXIiLmdldEJ5dGVzKCkpOwogICAgICAg\nICAgICByZXR1cm4gbmV3IExlZGdlckN1cnJlbnQobmV3YmssIG5ld2xoKTsK\nICAgICAgICB9CgogICAgICAgIGxvbmcgZ2V0SWQoKSB7CiAgICAgICAgICAg\nIHJldHVybiBsaC5nZXRJZCgpOwogICAgICAgIH0KCiAgICAgICAgdm9pZCB3\ncml0ZTEwMCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7CiAgICAgICAgICAgICAgICBs\naC5hZGRFbnRyeShFTlRSWV9EQVRBKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgbG9uZyByZWFkQWxsKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIGxvbmcgY291bnQgPSAwOwogICAgICAgICAgICBFbnVt\nZXJhdGlvbjxvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckVu\ndHJ5PiBlbnRyaWVzCiAgICAgICAgICAgICAgICA9IGxoLnJlYWRFbnRyaWVz\nKDAsIGxoLmdldExhc3RBZGRDb25maXJtZWQoKSk7CiAgICAgICAgICAgIHdo\naWxlIChlbnRyaWVzLmhhc01vcmVFbGVtZW50cygpKSB7CiAgICAgICAgICAg\nICAgICBhc3NlcnRUcnVlKCJlbnRyeSBkYXRhIGRvZXNuJ3QgbWF0Y2giLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheXMuZXF1YWxzKGVudHJp\nZXMubmV4dEVsZW1lbnQoKS5nZXRFbnRyeSgpLCBFTlRSWV9EQVRBKSk7CiAg\nICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHJldHVybiBjb3VudDsKICAgICAgICB9CgogICAgICAgIHZvaWQgY2xv\nc2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIGlmIChsaCAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgbGguY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChiayAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICAgICAgYmsuY2xvc2UoKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAv\nKgogICAgICogVGVzdCBvbGQgY29va2llIGFjY2Vzc2luZyB0aGUgbmV3IHZl\ncnNpb24gZm9ybWF0dGVkIGNsdXN0ZXIuCiAgICAgKi8KICAgIEBUZXN0KHRp\nbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0T2xkQ29va2llQWNj\nZXNzaW5nTmV3Q2x1c3RlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIEZpbGUgam91cm5hbERpciA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoImJvb2tp\nZSIsICJqb3VybmFsIik7CiAgICAgICAgam91cm5hbERpci5kZWxldGUoKTsK\nICAgICAgICBqb3VybmFsRGlyLm1rZGlyKCk7CiAgICAgICAgRmlsZSBsZWRn\nZXJEaXIgPSBGaWxlLmNyZWF0ZVRlbXBGaWxlKCJib29raWUiLCAibGVkZ2Vy\nIik7CiAgICAgICAgbGVkZ2VyRGlyLmRlbGV0ZSgpOwogICAgICAgIGxlZGdl\nckRpci5ta2RpcigpOwoKICAgICAgICBpbnQgcG9ydCA9IFBvcnRNYW5hZ2Vy\nLm5leHRGcmVlUG9ydCgpOwoKICAgICAgICAvLyBzdGFydCBvbGQgc2VydmVy\nCiAgICAgICAgU2VydmVyNDEwIHM0MTAgPSBuZXcgU2VydmVyNDEwKGpvdXJu\nYWxEaXIsIGxlZGdlckRpciwgcG9ydCk7CiAgICAgICAgczQxMC5zdGFydCgp\nOwoKICAgICAgICBMZWRnZXI0MTAgbDQxMCA9IExlZGdlcjQxMC5uZXdMZWRn\nZXIoKTsKICAgICAgICBsNDEwLndyaXRlMTAwKCk7CiAgICAgICAgbDQxMC5n\nZXRJZCgpOwogICAgICAgIGw0MTAuY2xvc2UoKTsKICAgICAgICBzNDEwLnN0\nb3AoKTsKCiAgICAgICAgLy8gRm9ybWF0IHRoZSBtZXRhZGF0YSB1c2luZyBj\ndXJyZW50IHZlcnNpb24KICAgICAgICBTZXJ2ZXJDdXJyZW50IGN1cnJlbnRT\nZXJ2ZXIgPSBuZXcgU2VydmVyQ3VycmVudChqb3VybmFsRGlyLCBsZWRnZXJE\naXIsCiAgICAgICAgICAgICAgICBwb3J0KTsKICAgICAgICBCb29rS2VlcGVy\nQWRtaW4uZm9ybWF0KG5ldyBDbGllbnRDb25maWd1cmF0aW9uKGN1cnJlbnRT\nZXJ2ZXIuY29uZiksCiAgICAgICAgICAgICAgICBmYWxzZSwgdHJ1ZSk7CiAg\nICAgICAgLy8gc3RhcnQgdGhlIGN1cnJlbnQgdmVyc2lvbiBzZXJ2ZXIgd2l0\naCBvbGQgdmVyc2lvbiBjb29raWUKICAgICAgICB0cnkgewogICAgICAgICAg\nICBjdXJyZW50U2VydmVyLnN0YXJ0KCk7CiAgICAgICAgICAgIGZhaWwoIkJv\nb2tpZSBzaG91bGQgbm90IHN0YXJ0IHdpdGggb2xkIGNvb2tpZSIpOwogICAg\nICAgIH0gY2F0Y2ggKEJvb2tpZUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nIGFzc2VydFRydWUoIk9sZCBDb29raWUgc2hvdWxkIG5vdCBiZSBhYmxlIHRv\nIGFjY2VzcyIsIGUKICAgICAgICAgICAgICAgICAgICAuZ2V0TWVzc2FnZSgp\nLmNvbnRhaW5zKCJpbnN0YW5jZUlkIikpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIGN1cnJlbnRTZXJ2ZXIuc3RvcCgpOwogICAgICAgIH0K\nCiAgICAgICAgLy8gRm9ybWF0IHRoZSBib29raWUgYWxzbyBhbmQgcmVzdGFy\ndAogICAgICAgIGFzc2VydFRydWUoIkZvcm1hdCBzaG91bGQgYmUgc3VjY2Vz\ncyIsCiAgICAgICAgICAgICAgICBCb29raWUuZm9ybWF0KGN1cnJlbnRTZXJ2\nZXIuY29uZiwgZmFsc2UsIHRydWUpKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBjdXJyZW50U2VydmVyID0gbnVsbDsKICAgICAgICAgICAgY3VycmVu\ndFNlcnZlciA9IG5ldyBTZXJ2ZXJDdXJyZW50KGpvdXJuYWxEaXIsIGxlZGdl\nckRpciwgcG9ydCk7CiAgICAgICAgICAgIGN1cnJlbnRTZXJ2ZXIuc3RhcnQo\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAobnVsbCAh\nPSBjdXJyZW50U2VydmVyKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50U2Vy\ndmVyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFRlc3QgY29tcGF0YWJpbGl0eSBiZXR3ZWVuIHZlcnNp\nb24gNC4wLjAgYW5kIHRoZSBjdXJyZW50IHZlcnNpb24uCiAgICAgKiBJbmNv\nbXBhdGFiaWxpdGllcyBhcmU6CiAgICAgKiAgLSBDdXJyZW50IGNsaWVudCB3\naWxsIG5vdCBiZSBhYmxlIHRvIHRhbGsgdG8gNC4wLjAgc2VydmVyLgogICAg\nICogIC0gNC4wLjAgY2xpZW50IHdpbGwgbm90IGJlIGFibGUgdG8gZmVuY2Ug\nbGVkZ2VycyBvbiBjdXJyZW50IHNlcnZlci4KICAgICAqICAtIEN1cnJlbnQg\nc2VydmVyIHdvbid0IHN0YXJ0IHdpdGggNC4wLjAgc2VydmVyIGRpcmVjdG9y\naWVzIHdpdGhvdXQgdXBncmFkZS4KICAgICAqLwogICAgQFRlc3QodGltZW91\ndD02MDAwMCkKICAgIHB1YmxpYyB2b2lkIHRlc3RDb21wYXQ0MDAoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBGaWxlIGpvdXJuYWxEaXIgPSBGaWxl\nLmNyZWF0ZVRlbXBGaWxlKCJib29raWUiLCAiam91cm5hbCIpOwogICAgICAg\nIGpvdXJuYWxEaXIuZGVsZXRlKCk7CiAgICAgICAgam91cm5hbERpci5ta2Rp\ncigpOwogICAgICAgIEZpbGUgbGVkZ2VyRGlyID0gRmlsZS5jcmVhdGVUZW1w\nRmlsZSgiYm9va2llIiwgImxlZGdlciIpOwogICAgICAgIGxlZGdlckRpci5k\nZWxldGUoKTsKICAgICAgICBsZWRnZXJEaXIubWtkaXIoKTsKCiAgICAgICAg\naW50IHBvcnQgPSBQb3J0TWFuYWdlci5uZXh0RnJlZVBvcnQoKTsKICAgICAg\nICAvLyBzdGFydCBzZXJ2ZXIsIHVwZ3JhZGUKICAgICAgICBTZXJ2ZXI0MDAg\nczQwMCA9IG5ldyBTZXJ2ZXI0MDAoam91cm5hbERpciwgbGVkZ2VyRGlyLCBw\nb3J0KTsKICAgICAgICBzNDAwLnN0YXJ0KCk7CgogICAgICAgIExlZGdlcjQw\nMCBsNDAwID0gTGVkZ2VyNDAwLm5ld0xlZGdlcigpOwogICAgICAgIGw0MDAu\nd3JpdGUxMDAoKTsKICAgICAgICBsb25nIG9sZExlZGdlcklkID0gbDQwMC5n\nZXRJZCgpOwogICAgICAgIGw0MDAuY2xvc2UoKTsKCiAgICAgICAgLy8gQ2hl\nY2sgdGhhdCBjdXJyZW50IGNsaWVudCBpc24ndCBhYmxlIHRvIHdyaXRlIHRv\nIG9sZCBzZXJ2ZXIKICAgICAgICBMZWRnZXJDdXJyZW50IGxjdXIgPSBMZWRn\nZXJDdXJyZW50Lm5ld0xlZGdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGxjdXIud3JpdGUxMDAoKTsKICAgICAgICAgICAgZmFpbCgiQ3VycmVu\ndCBzaG91bGRuJ3QgYmUgYWJsZSB0byB3cml0ZSB0byA0LjAuMCBzZXJ2ZXIi\nKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgIH0K\nICAgICAgICBsY3VyLmNsb3NlKCk7CgogICAgICAgIHM0MDAuc3RvcCgpOwoK\nICAgICAgICAvLyBTdGFydCB0aGUgY3VycmVudCBzZXJ2ZXIsIHdpbGwgcmVx\ndWlyZSBhIGZpbGVzeXN0ZW0gdXBncmFkZQogICAgICAgIFNlcnZlckN1cnJl\nbnQgc2N1ciA9IG5ldyBTZXJ2ZXJDdXJyZW50KGpvdXJuYWxEaXIsIGxlZGdl\nckRpciwgcG9ydCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2N1ci5z\ndGFydCgpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgYmUgYWJsZSB0\nbyBzdGFydCB3aXRob3V0IGRpcmVjdG9yeSB1cGdyYWRlIik7CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CiAgICAgICAgRmls\nZVN5c3RlbVVwZ3JhZGUudXBncmFkZShzY3VyLmdldENvbmYoKSk7CgogICAg\nICAgIHNjdXIuc3RhcnQoKTsKCiAgICAgICAgLy8gY2hlY2sgdGhhdCBvbGQg\nY2xpZW50IGNhbiByZWFkIGl0cyBvbGQgbGVkZ2VycyBvbiBuZXcgc2VydmVy\nCiAgICAgICAgbDQwMCA9IExlZGdlcjQwMC5vcGVuTGVkZ2VyKG9sZExlZGdl\ncklkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMTAwLCBsNDAwLnJlYWRBbGwo\nKSk7CiAgICAgICAgbDQwMC5jbG9zZSgpOwoKICAgICAgICAvLyBjaGVjayB0\naGF0IG9sZCBjbGllbnQgY2FuIGNyZWF0ZSBsZWRnZXJzIG9uIG5ldyBzZXJ2\nZXIKICAgICAgICBsNDAwID0gTGVkZ2VyNDAwLm5ld0xlZGdlcigpOwogICAg\nICAgIGw0MDAud3JpdGUxMDAoKTsKICAgICAgICBsNDAwLmNsb3NlKCk7Cgog\nICAgICAgIC8vIGNoZWNrIHRoYXQgY3VycmVudCBjbGllbnQgY2FuIHJlYWQg\nb2xkIGxlZGdlcgogICAgICAgIGxjdXIgPSBMZWRnZXJDdXJyZW50Lm9wZW5M\nZWRnZXIob2xkTGVkZ2VySWQpOwogICAgICAgIGFzc2VydEVxdWFscygxMDAs\nIGxjdXIucmVhZEFsbCgpKTsKICAgICAgICBsY3VyLmNsb3NlKCk7CgogICAg\nICAgIC8vIGNoZWNrIHRoYXQgb2xkIGNsaWVudCBjYW4gcmVhZCBjdXJyZW50\nIGNsaWVudCdzIGxlZGdlcnMKICAgICAgICBsY3VyID0gTGVkZ2VyQ3VycmVu\ndC5vcGVuTGVkZ2VyKG9sZExlZGdlcklkKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoMTAwLCBsY3VyLnJlYWRBbGwoKSk7CiAgICAgICAgbGN1ci5jbG9zZSgp\nOwoKICAgICAgICAvLyBjaGVjayB0aGF0IG9sZCBjbGllbnQgY2FuIG5vdCBm\nZW5jZSBhIGN1cnJlbnQgY2xpZW50CiAgICAgICAgLy8gZHVlIHRvIGxhY2sg\nb2YgcGFzc3dvcmQKICAgICAgICBsY3VyID0gTGVkZ2VyQ3VycmVudC5uZXdM\nZWRnZXIoKTsKICAgICAgICBsY3VyLndyaXRlMTAwKCk7CiAgICAgICAgbG9u\nZyBmZW5jZUxlZGdlcklkID0gbGN1ci5nZXRJZCgpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGw0MDAgPSBMZWRnZXI0MDAub3BlbkxlZGdlcihmZW5j\nZUxlZGdlcklkKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0IGJlIGFi\nbGUgdG8gb3BlbiBsZWRnZXIiKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAvLyBjb3JyZWN0IGJlaGF2aW91cgogICAg\nICAgIH0KICAgICAgICBsY3VyLndyaXRlMTAwKCk7CiAgICAgICAgbGN1ci5j\nbG9zZSgpOwoKICAgICAgICBsY3VyID0gTGVkZ2VyQ3VycmVudC5vcGVuTGVk\nZ2VyKGZlbmNlTGVkZ2VySWQpOwogICAgICAgIGFzc2VydEVxdWFscygyMDAs\nIGxjdXIucmVhZEFsbCgpKTsKICAgICAgICBsY3VyLmNsb3NlKCk7CgogICAg\nICAgIHNjdXIuc3RvcCgpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdCBj\nb21wYXRhYmlsaXR5IGJldHdlZW4gdmVyc2lvbiA0LjEuMCBhbmQgdGhlIGN1\ncnJlbnQgdmVyc2lvbi4KICAgICAqICAtIEEgNC4xLjAgY2xpZW50IGlzIG5v\ndCBhYmxlIHRvIG9wZW4gYSBsZWRnZXIgY3JlYXRlZCBieSB0aGUgY3VycmVu\ndAogICAgICogICAgdmVyc2lvbiBkdWUgdG8gYSBjaGFuZ2UgaW4gdGhlIGxl\nZGdlciBtZXRhZGF0YSBmb3JtYXQuCiAgICAgKiAgLSBPdGhlcndpc2UsIHRo\nZXkgc2hvdWxkIGJlIGNvbXBhdGlibGUuCiAgICAgKi8KICAgIEBUZXN0KHRp\nbWVvdXQ9NjAwMDApCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q29tcGF0NDEwKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgRmlsZSBqb3VybmFsRGlyID0g\nRmlsZS5jcmVhdGVUZW1wRmlsZSgiYm9va2llIiwgImpvdXJuYWwiKTsKICAg\nICAgICBqb3VybmFsRGlyLmRlbGV0ZSgpOwogICAgICAgIGpvdXJuYWxEaXIu\nbWtkaXIoKTsKICAgICAgICBGaWxlIGxlZGdlckRpciA9IEZpbGUuY3JlYXRl\nVGVtcEZpbGUoImJvb2tpZSIsICJsZWRnZXIiKTsKICAgICAgICBsZWRnZXJE\naXIuZGVsZXRlKCk7CiAgICAgICAgbGVkZ2VyRGlyLm1rZGlyKCk7CgogICAg\nICAgIGludCBwb3J0ID0gUG9ydE1hbmFnZXIubmV4dEZyZWVQb3J0KCk7CiAg\nICAgICAgLy8gc3RhcnQgc2VydmVyLCB1cGdyYWRlCiAgICAgICAgU2VydmVy\nNDEwIHM0MTAgPSBuZXcgU2VydmVyNDEwKGpvdXJuYWxEaXIsIGxlZGdlckRp\nciwgcG9ydCk7CiAgICAgICAgczQxMC5zdGFydCgpOwoKICAgICAgICBMZWRn\nZXI0MTAgbDQxMCA9IExlZGdlcjQxMC5uZXdMZWRnZXIoKTsKICAgICAgICBs\nNDEwLndyaXRlMTAwKCk7CiAgICAgICAgbG9uZyBvbGRMZWRnZXJJZCA9IGw0\nMTAuZ2V0SWQoKTsKICAgICAgICBsNDEwLmNsb3NlKCk7CgogICAgICAgIC8v\nIENoZWNrIHRoYXQgY3VycmVudCBjbGllbnQgY2FuIHRvIHdyaXRlIHRvIG9s\nZCBzZXJ2ZXIKICAgICAgICBMZWRnZXJDdXJyZW50IGxjdXIgPSBMZWRnZXJD\ndXJyZW50Lm5ld0xlZGdlcigpOwogICAgICAgIGxjdXIud3JpdGUxMDAoKTsK\nICAgICAgICBsY3VyLmNsb3NlKCk7CgogICAgICAgIHM0MTAuc3RvcCgpOwoK\nICAgICAgICAvLyBTdGFydCB0aGUgY3VycmVudCBzZXJ2ZXIsIHdpbGwgbm90\nIHJlcXVpcmUgYSBmaWxlc3lzdGVtIHVwZ3JhZGUKICAgICAgICBTZXJ2ZXJD\ndXJyZW50IHNjdXIgPSBuZXcgU2VydmVyQ3VycmVudChqb3VybmFsRGlyLCBs\nZWRnZXJEaXIsIHBvcnQpOwogICAgICAgIHNjdXIuc3RhcnQoKTsKCiAgICAg\nICAgLy8gY2hlY2sgdGhhdCBvbGQgY2xpZW50IGNhbiByZWFkIGl0cyBvbGQg\nbGVkZ2VycyBvbiBuZXcgc2VydmVyCiAgICAgICAgbDQxMCA9IExlZGdlcjQx\nMC5vcGVuTGVkZ2VyKG9sZExlZGdlcklkKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoMTAwLCBsNDEwLnJlYWRBbGwoKSk7CiAgICAgICAgbDQxMC5jbG9zZSgp\nOwoKICAgICAgICAvLyBjaGVjayB0aGF0IG9sZCBjbGllbnQgY2FuIGNyZWF0\nZSBsZWRnZXJzIG9uIG5ldyBzZXJ2ZXIKICAgICAgICBsNDEwID0gTGVkZ2Vy\nNDEwLm5ld0xlZGdlcigpOwogICAgICAgIGw0MTAud3JpdGUxMDAoKTsKICAg\nICAgICBsNDEwLmNsb3NlKCk7CgogICAgICAgIC8vIGNoZWNrIHRoYXQgYW4g\nb2xkIGNsaWVudCBjYW4gZmVuY2UgYW4gb2xkIGNsaWVudAogICAgICAgIGw0\nMTAgPSBMZWRnZXI0MTAubmV3TGVkZ2VyKCk7CiAgICAgICAgbDQxMC53cml0\nZTEwMCgpOwoKICAgICAgICBMZWRnZXI0MTAgbDQxMGYgPSBMZWRnZXI0MTAu\nb3BlbkxlZGdlcihsNDEwLmdldElkKCkpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGw0MTAud3JpdGUxMDAoKTsKICAgICAgICAgICAgZmFpbCgiU2hv\ndWxkbid0IGJlIGFibGUgdG8gd3JpdGUiKTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBjb3JyZWN0IGJlaGF2aW91\ncgogICAgICAgIH0KICAgICAgICBsNDEwZi5jbG9zZSgpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGw0MTAuY2xvc2UoKTsKICAgICAgICAgICAgZmFp\nbCgiU2hvdWxkbid0IGJlIGFibGUgdG8gY2xvc2UiKTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBjb3JyZWN0CiAg\nICAgICAgfQoKICAgICAgICAvLyBjaGVjayB0aGF0IGEgbmV3IGNsaWVudCBj\nYW4gZmVuY2UgYW4gb2xkIGNsaWVudAogICAgICAgIC8vIGFuZCB0aGUgb2xk\nIGNsaWVudCBjYW4gY29udGludWUgdG8gcmVhZCB0aGF0IGxlZGdlcgogICAg\nICAgIGw0MTAgPSBMZWRnZXI0MTAubmV3TGVkZ2VyKCk7CiAgICAgICAgbDQx\nMC53cml0ZTEwMCgpOwoKICAgICAgICBvbGRMZWRnZXJJZCA9IGw0MTAuZ2V0\nSWQoKTsKICAgICAgICBsY3VyID0gTGVkZ2VyQ3VycmVudC5vcGVuTGVkZ2Vy\nKG9sZExlZGdlcklkKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBsNDEw\nLndyaXRlMTAwKCk7CiAgICAgICAgICAgIGZhaWwoIlNob3VsZG4ndCBiZSBh\nYmxlIHRvIHdyaXRlIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgLy8gY29ycmVjdCBiZWhhdmlvdXIKICAgICAgICB9\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbDQxMC5jbG9zZSgpOwogICAg\nICAgICAgICBmYWlsKCJTaG91bGRuJ3QgYmUgYWJsZSB0byBjbG9zZSIpOwog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8v\nIGNvcnJlY3QKICAgICAgICB9CiAgICAgICAgbGN1ci5jbG9zZSgpOwoKICAg\nICAgICBsNDEwID0gTGVkZ2VyNDEwLm9wZW5MZWRnZXIob2xkTGVkZ2VySWQp\nOwoKICAgICAgICBhc3NlcnRFcXVhbHMoMTAwLCBsNDEwLnJlYWRBbGwoKSk7\nCiAgICAgICAgbDQxMC5jbG9zZSgpOwoKICAgICAgICAvLyBjaGVjayB0aGF0\nIGN1cnJlbnQgY2xpZW50IGNhbiByZWFkIG9sZCBsZWRnZXIKICAgICAgICBs\nY3VyID0gTGVkZ2VyQ3VycmVudC5vcGVuTGVkZ2VyKG9sZExlZGdlcklkKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoMTAwLCBsY3VyLnJlYWRBbGwoKSk7CiAg\nICAgICAgbGN1ci5jbG9zZSgpOwoKICAgICAgICAvLyBjaGVjayB0aGF0IG9s\nZCBjbGllbnQgY2FuIHJlYWQgY3VycmVudCBjbGllbnQncyBsZWRnZXJzCiAg\nICAgICAgbGN1ciA9IExlZGdlckN1cnJlbnQub3BlbkxlZGdlcihvbGRMZWRn\nZXJJZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEwMCwgbGN1ci5yZWFkQWxs\nKCkpOwogICAgICAgIGxjdXIuY2xvc2UoKTsKCiAgICAgICAgLy8gY2hlY2sg\ndGhhdCBvbGQgY2xpZW50IGNhbiBub3QgZmVuY2UgYSBjdXJyZW50IGNsaWVu\ndAogICAgICAgIC8vIHNpbmNlIGl0IGNhbm5vdCBvcGVuIGEgbmV3IGxlZGdl\nciBkdWUgdG8gdGhlIGZvcm1hdCBjaGFuZ2VzCiAgICAgICAgbGN1ciA9IExl\nZGdlckN1cnJlbnQubmV3TGVkZ2VyKCk7CiAgICAgICAgbGN1ci53cml0ZTEw\nMCgpOwogICAgICAgIGxvbmcgZmVuY2VMZWRnZXJJZCA9IGxjdXIuZ2V0SWQo\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBsNDEwID0gTGVkZ2VyNDEw\nLm9wZW5MZWRnZXIoZmVuY2VMZWRnZXJJZCk7CiAgICAgICAgICAgIGZhaWwo\nIlNob3VsZG4ndCBiZSBhYmxlIHRvIG9wZW4gbGVkZ2VyIik7CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gY29ycmVj\ndCBiZWhhdmlvdXIKICAgICAgICB9CiAgICAgICAgbGN1ci53cml0ZTEwMCgp\nOwogICAgICAgIGxjdXIuY2xvc2UoKTsKCiAgICAgICAgc2N1ci5zdG9wKCk7\nCiAgICB9Cn0K\n","encoding":"base64"}

