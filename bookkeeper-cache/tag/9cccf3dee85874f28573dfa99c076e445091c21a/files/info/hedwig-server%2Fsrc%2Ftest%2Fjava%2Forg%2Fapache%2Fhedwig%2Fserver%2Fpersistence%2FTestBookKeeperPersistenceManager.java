{"sha":"c69da18bb98d194154467821fd7b67b8979bd2fc","node_id":"MDQ6QmxvYjE1NzU5NTY6YzY5ZGExOGJiOThkMTk0MTU0NDY3ODIxZmQ3YjY3Yjg5NzliZDJmYw==","size":33068,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/c69da18bb98d194154467821fd7b67b8979bd2fc","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LkV4ZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25j\ndXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwu\nY29uY3VycmVudC5TY2hlZHVsZWRFeGVjdXRvclNlcnZpY2U7CmltcG9ydCBq\nYXZhLnV0aWwuY29uY3VycmVudC5TZW1hcGhvcmU7CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBqdW5pdC5mcmFtZXdv\ncmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnZl\ncnNpb25pbmcuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci52ZXJzaW9uaW5nLlZlcnNpb25lZDsKCmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5IZWxwZXJNZXRob2RzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nU3R1YkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuZXhjZXB0\naW9ucy5QdWJTdWJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbDsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLkxlZGdlclJhbmdlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9j\nb2wuTGVkZ2VyUmFuZ2VzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2VTZXFJ\nZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlBy\nb3RvY29sLlN1YnNjcmliZVJlcXVlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpYmVSZXF1ZXN0\nLkNyZWF0ZU9yQXR0YWNoOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJv\ndG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaXB0aW9uRGF0YTsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRh\nLk1ldGFkYXRhTWFuYWdlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5zZXJ2ZXIubWV0YS5TdWJzY3JpcHRpb25EYXRhTWFuYWdlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5tZXRhLlRvcGljT3duZXJz\naGlwTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5t\nZXRhLlRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuc2VydmVyLnN1YnNjcmlwdGlvbnMuTU1TdWJzY3JpcHRpb25N\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGlj\ncy5Ub3BpY01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2\nZXIudG9waWNzLlRyaXZpYWxPd25BbGxUb3BpY01hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcudXRpbC5Db25jdXJyZW5jeVV0aWxzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcudXRpbC5FaXRoZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLnpvb2tlZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7\nCmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1bml0LlRl\nc3Q7CmltcG9ydCBvcmcuanVuaXQucnVubmVyLlJ1bldpdGg7CmltcG9ydCBv\ncmcuanVuaXQucnVubmVycy5QYXJhbWV0ZXJpemVkOwppbXBvcnQgb3JnLmp1\nbml0LnJ1bm5lcnMuUGFyYW1ldGVyaXplZC5QYXJhbWV0ZXJzOwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmluZzsK\nCkBSdW5XaXRoKFBhcmFtZXRlcml6ZWQuY2xhc3MpCnB1YmxpYyBjbGFzcyBU\nZXN0Qm9va0tlZXBlclBlcnNpc3RlbmNlTWFuYWdlciBleHRlbmRzIFRlc3RD\nYXNlIHsKICAgIHN0YXRpYyBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9y\neS5nZXRMb2dnZXIoVGVzdFBlcnNpc3RlbmNlTWFuYWdlckJsYWNrQm94LmNs\nYXNzKTsKCiAgICBCb29rS2VlcGVyVGVzdEJhc2UgYmt0YjsKICAgIHByaXZh\ndGUgZmluYWwgaW50IG51bUJvb2tpZXMgPSAzOwogICAgcHJpdmF0ZSBmaW5h\nbCBsb25nIHJlYWREZWxheSA9IDIwMDBMOwogICAgcHJpdmF0ZSBmaW5hbCBp\nbnQgbWF4RW50cmllc1BlckxlZGdlciA9IDEwOwoKICAgIFNlcnZlckNvbmZp\nZ3VyYXRpb24gY29uZjsKICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBz\nY2hlZHVsZXI7CgogICAgVG9waWNNYW5hZ2VyIHRtOwogICAgQm9va2tlZXBl\nclBlcnNpc3RlbmNlTWFuYWdlciBtYW5hZ2VyOwogICAgUHViU3ViRXhjZXB0\naW9uIGZhaWx1cmVFeGNlcHRpb24gPSBudWxsOwogICAgVGVzdE1ldGFkYXRh\nTWFuYWdlckZhY3RvcnkgbWV0YWRhdGFNYW5hZ2VyRmFjdG9yeTsKICAgIFRv\ncGljUGVyc2lzdGVuY2VNYW5hZ2VyIHRwTWFuYWdlcjsKICAgIE1NU3Vic2Ny\naXB0aW9uTWFuYWdlciBzbTsKCiAgICBib29sZWFuIHJlbW92ZVN0YXJ0U2Vx\nSWQ7CgogICAgc3RhdGljIGNsYXNzIFRlc3RNZXRhZGF0YU1hbmFnZXJGYWN0\nb3J5IGV4dGVuZHMgTWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSB7CgogICAgICAg\nIGZpbmFsIE1ldGFkYXRhTWFuYWdlckZhY3RvcnkgZmFjdG9yeTsKICAgICAg\nICBpbnQgc2VydmljZURvd25Db3VudCA9IDA7CgogICAgICAgIFRlc3RNZXRh\nZGF0YU1hbmFnZXJGYWN0b3J5KFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiwg\nWm9vS2VlcGVyIHprKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nZmFjdG9yeSA9IE1ldGFkYXRhTWFuYWdlckZhY3RvcnkubmV3TWV0YWRhdGFN\nYW5hZ2VyRmFjdG9yeShjb25mLCB6ayk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRTZXJ2aWNlRG93bkNvdW50KGludCBjb3VudCkgewog\nICAgICAgICAgICB0aGlzLnNlcnZpY2VEb3duQ291bnQgPSBjb3VudDsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQg\nZ2V0Q3VycmVudFZlcnNpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0\nb3J5LmdldEN1cnJlbnRWZXJzaW9uKCk7CiAgICAgICAgfQoKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgTWV0YWRhdGFNYW5hZ2VyRmFj\ndG9yeSBpbml0aWFsaXplKAogICAgICAgICAgICBTZXJ2ZXJDb25maWd1cmF0\naW9uIGNmZywgWm9vS2VlcGVyIHprLCBpbnQgdmVyc2lvbikgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgLy8gZG8gbm90aGluZwogICAgICAg\nICAgICByZXR1cm4gZmFjdG9yeTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHNodXRkb3duKCkgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgZmFjdG9yeS5zaHV0ZG93bigpOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIEl0\nZXJhdG9yPEJ5dGVTdHJpbmc+IGdldFRvcGljcygpIHRocm93cyBJT0V4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LmdldFRvcGljcygp\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFRvcGljUGVyc2lzdGVuY2VNYW5hZ2VyIG5ld1RvcGljUGVyc2lzdGVuY2VN\nYW5hZ2VyKCkgewogICAgICAgICAgICBmaW5hbCBUb3BpY1BlcnNpc3RlbmNl\nTWFuYWdlciBtYW5hZ2VyID0gZmFjdG9yeS5uZXdUb3BpY1BlcnNpc3RlbmNl\nTWFuYWdlcigpOwogICAgICAgICAgICByZXR1cm4gbmV3IFRvcGljUGVyc2lz\ndGVuY2VNYW5hZ2VyKCkgewoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgSU9F\neGNlcHRpb24gewogICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJlYWRUb3BpY1BlcnNp\nc3RlbmNlSW5mbyhCeXRlU3RyaW5nIHRvcGljLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNr\nPFZlcnNpb25lZDxMZWRnZXJSYW5nZXM+PiBjYWxsYmFjaywgT2JqZWN0IGN0\neCkgewogICAgICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlRG93bkNvdW50\nID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAtLXNlcnZpY2VEb3du\nQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJh\ndGlvbkZhaWxlZChjdHgsIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURv\nd25FeGNlcHRpb24oIk1ldGFkYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgbWFuYWdlci5yZWFkVG9waWNQZXJz\naXN0ZW5jZUluZm8odG9waWMsIGNhbGxiYWNrLCBjdHgpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCB3cml0ZVRvcGljUGVyc2lzdGVuY2VJbmZvKEJ5\ndGVTdHJpbmcgdG9waWMsIExlZGdlclJhbmdlcyByYW5nZXMsIFZlcnNpb24g\ndmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ss\nIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2Vydmlj\nZURvd25Db3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLS1z\nZXJ2aWNlRG93bkNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICBjYWxs\nYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhjZXB0aW9u\nLlNlcnZpY2VEb3duRXhjZXB0aW9uKCJNZXRhZGF0YSBTdG9yZSBpcyBkb3du\nIikpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG1hbmFnZXIud3Jp\ndGVUb3BpY1BlcnNpc3RlbmNlSW5mbyh0b3BpYywgcmFuZ2VzLCB2ZXJzaW9u\nLCBjYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nZGVsZXRlVG9waWNQZXJzaXN0ZW5jZUluZm8oQnl0ZVN0cmluZyB0b3BpYywg\nVmVyc2lvbiB2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2s8Vm9pZD4gY2Fs\nbGJhY2ssIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAo\nc2VydmljZURvd25Db3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgLS1zZXJ2aWNlRG93bkNvdW50OwogICAgICAgICAgICAgICAgICAgICAg\nICBjYWxsYmFjay5vcGVyYXRpb25GYWlsZWQoY3R4LCBuZXcgUHViU3ViRXhj\nZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uKCJNZXRhZGF0YSBTdG9yZSBp\ncyBkb3duIikpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG1hbmFn\nZXIuZGVsZXRlVG9waWNQZXJzaXN0ZW5jZUluZm8odG9waWMsIHZlcnNpb24s\nIGNhbGxiYWNrLCBjdHgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFN1YnNjcmlwdGlvbkRhdGFNYW5hZ2VyIG5ld1N1YnNjcmlwdGlvbkRh\ndGFNYW5hZ2VyKCkgewogICAgICAgICAgICBmaW5hbCBTdWJzY3JpcHRpb25E\nYXRhTWFuYWdlciBzZG0gPSBmYWN0b3J5Lm5ld1N1YnNjcmlwdGlvbkRhdGFN\nYW5hZ2VyKCk7CiAgICAgICAgICAgIHJldHVybiBuZXcgU3Vic2NyaXB0aW9u\nRGF0YU1hbmFnZXIoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgICAgICBzZG0uY2xvc2UoKTsKICAg\nICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNyZWF0ZVN1YnNjcmlwdGlvbkRh\ndGEoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQs\nIFN1YnNjcmlwdGlvbkRhdGEgZGF0YSwKICAgICAgICAgICAgICAgICAgICAg\nICAgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICBzZG0uY3JlYXRlU3Vic2NyaXB0aW9uRGF0\nYSh0b3BpYywgc3Vic2NyaWJlcklkLCBkYXRhLCBjYWxsYmFjaywgY3R4KTsK\nICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIGlzUGFydGlhbFVwZGF0\nZVN1cHBvcnRlZCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2Rt\nLmlzUGFydGlhbFVwZGF0ZVN1cHBvcnRlZCgpOwogICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgdXBkYXRlU3Vic2NyaXB0aW9uRGF0YShCeXRlU3RyaW5n\nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCwKICAgICAgICAgICAg\nICAgICAgICAgICAgU3Vic2NyaXB0aW9uRGF0YSBkYXRhVG9VcGRhdGUsIFZl\ncnNpb24gdmVyc2lvbiwgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9i\namVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2VydmljZURv\nd25Db3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLS1zZXJ2\naWNlRG93bkNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFj\nay5vcGVyYXRpb25GYWlsZWQoY3R4LAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG5ldyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNl\ncHRpb24oIk1ldGFkYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgc2RtLnVwZGF0ZVN1YnNjcmlwdGlvbkRhdGEo\ndG9waWMsIHN1YnNjcmliZXJJZCwgZGF0YVRvVXBkYXRlLCB2ZXJzaW9uLCBj\nYWxsYmFjaywgY3R4KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJl\ncGxhY2VTdWJzY3JpcHRpb25EYXRhKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVT\ndHJpbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgICBT\ndWJzY3JpcHRpb25EYXRhIGRhdGFUb1JlcGxhY2UsIFZlcnNpb24gdmVyc2lv\nbiwgQ2FsbGJhY2s8VmVyc2lvbj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAoc2VydmljZURvd25Db3VudCA+IDAp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgLS1zZXJ2aWNlRG93bkNvdW50\nOwogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5vcGVyYXRpb25G\nYWlsZWQoY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5l\ndyBQdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25FeGNlcHRpb24oIk1ldGFk\nYXRhIFN0b3JlIGlzIGRvd24iKSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgc2RtLnJlcGxhY2VTdWJzY3JpcHRpb25EYXRhKHRvcGljLCBzdWJz\nY3JpYmVySWQsIGRhdGFUb1JlcGxhY2UsIHZlcnNpb24sIGNhbGxiYWNrLCBj\ndHgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgZGVsZXRlU3Vic2Ny\naXB0aW9uRGF0YShCeXRlU3RyaW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNj\ncmliZXJJZCwgVmVyc2lvbiB2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAg\nICAgICBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGN0eCkgewog\nICAgICAgICAgICAgICAgICAgIHNkbS5kZWxldGVTdWJzY3JpcHRpb25EYXRh\nKHRvcGljLCBzdWJzY3JpYmVySWQsIHZlcnNpb24sIGNhbGxiYWNrLCBjdHgp\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEBPdmVycmlk\nZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcmVhZFN1YnNjcmlwdGlv\nbkRhdGEoQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVy\nSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrPFZlcnNpb25l\nZDxTdWJzY3JpcHRpb25EYXRhPj4gY2FsbGJhY2ssIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgICAgICAgICBzZG0ucmVhZFN1YnNjcmlwdGlvbkRhdGEo\ndG9waWMsIHN1YnNjcmliZXJJZCwgY2FsbGJhY2ssIGN0eCk7CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCByZWFkU3Vic2NyaXB0aW9ucyhCeXRlU3Ry\naW5nIHRvcGljLAogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjazxN\nYXA8Qnl0ZVN0cmluZywgVmVyc2lvbmVkPFN1YnNjcmlwdGlvbkRhdGE+Pj4g\nY2IsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAgICAgICAgICBzZG0ucmVh\nZFN1YnNjcmlwdGlvbnModG9waWMsIGNiLCBjdHgpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIFRvcGljT3duZXJzaGlwTWFuYWdlciBuZXdU\nb3BpY093bmVyc2hpcE1hbmFnZXIoKSB7CiAgICAgICAgICAgIHJldHVybiBm\nYWN0b3J5Lm5ld1RvcGljT3duZXJzaGlwTWFuYWdlcigpOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgZm9ybWF0\nKFNlcnZlckNvbmZpZ3VyYXRpb24gY2ZnLCBab29LZWVwZXIgemspIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGZhY3RvcnkuZm9ybWF0KGNm\nZywgemspOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgVGVzdEJvb2tL\nZWVwZXJQZXJzaXN0ZW5jZU1hbmFnZXIoYm9vbGVhbiByZW1vdmVTdGFydFNl\ncUlkKSB7CiAgICAgICAgdGhpcy5yZW1vdmVTdGFydFNlcUlkID0gcmVtb3Zl\nU3RhcnRTZXFJZDsKICAgIH0KCiAgICBAUGFyYW1ldGVycwogICAgcHVibGlj\nIHN0YXRpYyBDb2xsZWN0aW9uPE9iamVjdFtdPiBjb25maWdzKCkgewogICAg\nICAgIHJldHVybiBBcnJheXMuYXNMaXN0KG5ldyBPYmplY3RbXVtdIHsKICAg\nICAgICAgICAgeyB0cnVlIH0sIHsgZmFsc2UgfQogICAgICAgIH0pOwogICAg\nfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJkZXByZWNhdGlvbiIpCiAgICBw\ncml2YXRlIHZvaWQgc3RhcnRDbHVzdGVyKGxvbmcgZGVsYXkpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGJrdGIgPSBuZXcgQm9va0tlZXBlclRlc3RC\nYXNlKG51bUJvb2tpZXMsIDBMKTsKICAgICAgICBia3RiLnNldFVwKCk7Cgog\nICAgICAgIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbigpIHsKICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyBpbnQgZ2V0\nTWVzc2FnZXNDb25zdW1lZFRocmVhZFJ1bkludGVydmFsKCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIDIwMDA7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyBpbnQgZ2V0Q29uc3Vt\nZUludGVydmFsKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1\nYmxpYyBsb25nIGdldE1heEVudHJpZXNQZXJMZWRnZXIoKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gbWF4RW50cmllc1BlckxlZGdlcjsKICAgICAgICAg\nICAgfQogICAgICAgIH07CiAgICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbiBia0NsaWVudENvbmYgPQogICAg\nICAgICAgICAgICAgbmV3IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkNs\naWVudENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBia0NsaWVudENvbmYuc2V0\nTnVtV29ya2VyVGhyZWFkcygxKS5zZXRSZWFkVGltZW91dCg5OTk5KQogICAg\nICAgIC5zZXRUaHJvdHRsZVZhbHVlKDMpOwogICAgICAgIGNvbmYuYWRkQ29u\nZihia0NsaWVudENvbmYpOwoKICAgICAgICBtZXRhZGF0YU1hbmFnZXJGYWN0\nb3J5ID0gbmV3IFRlc3RNZXRhZGF0YU1hbmFnZXJGYWN0b3J5KGNvbmYsIGJr\ndGIuZ2V0Wm9vS2VlcGVyQ2xpZW50KCkpOwogICAgICAgIHRwTWFuYWdlciA9\nIG1ldGFkYXRhTWFuYWdlckZhY3RvcnkubmV3VG9waWNQZXJzaXN0ZW5jZU1h\nbmFnZXIoKTsKCiAgICAgICAgc2NoZWR1bGVyID0gRXhlY3V0b3JzLm5ld1Nj\naGVkdWxlZFRocmVhZFBvb2woMSk7CiAgICAgICAgdG0gPSBuZXcgVHJpdmlh\nbE93bkFsbFRvcGljTWFuYWdlcihjb25mLCBzY2hlZHVsZXIpOwogICAgICAg\nIG1hbmFnZXIgPSBuZXcgQm9va2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcihi\na3RiLmJrLCBtZXRhZGF0YU1hbmFnZXJGYWN0b3J5LAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bSwgY29u\nZiwgc2NoZWR1bGVyKTsKICAgICAgICBzbSA9IG5ldyBNTVN1YnNjcmlwdGlv\nbk1hbmFnZXIoY29uZiwgbWV0YWRhdGFNYW5hZ2VyRmFjdG9yeSwgdG0sIG1h\nbmFnZXIsIG51bGwsIHNjaGVkdWxlcik7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIHN0b3BDbHVzdGVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\ndG0uc3RvcCgpOwogICAgICAgIG1hbmFnZXIuc3RvcCgpOwogICAgICAgIHNt\nLnN0b3AoKTsKICAgICAgICB0cE1hbmFnZXIuY2xvc2UoKTsKICAgICAgICBt\nZXRhZGF0YU1hbmFnZXJGYWN0b3J5LnNodXRkb3duKCk7CiAgICAgICAgc2No\nZWR1bGVyLnNodXRkb3duKCk7CiAgICAgICAgYmt0Yi50ZWFyRG93bigpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgQEJlZm9yZQogICAgcHVibGljIHZv\naWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5z\nZXRVcCgpOwogICAgICAgIHN0YXJ0Q2x1c3RlcigwTCk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBAQWZ0ZXIKICAgIHB1YmxpYyB2b2lkIHRlYXJEb3du\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3RvcENsdXN0ZXIoKTsK\nICAgICAgICBzdXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIGNsYXNzIFJh\nbmdlU2NhblZlcmlmaWVyIGltcGxlbWVudHMgU2NhbkNhbGxiYWNrIHsKICAg\nICAgICBMaW5rZWRMaXN0PE1lc3NhZ2U+IHB1Yk1zZ3M7CiAgICAgICAgYm9v\nbGVhbiBydW5OZXh0U2NhbiA9IGZhbHNlOwogICAgICAgIFJhbmdlU2NhblJl\ncXVlc3QgbmV4dFNjYW4gPSBudWxsOwoKICAgICAgICBwdWJsaWMgUmFuZ2VT\nY2FuVmVyaWZpZXIoTGlua2VkTGlzdDxNZXNzYWdlPiBwdWJNc2dzLCBSYW5n\nZVNjYW5SZXF1ZXN0IG5leHRTY2FuKSB7CiAgICAgICAgICAgIHRoaXMucHVi\nTXNncyA9IHB1Yk1zZ3M7CiAgICAgICAgICAgIHRoaXMubmV4dFNjYW4gPSBu\nZXh0U2NhbjsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVjdCBjdHgsIE1lc3Nh\nZ2UgcmVjdk1lc3NhZ2UpIHsKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlNj\nYW5uZWQgbWVzc2FnZSA6IHt9IiwgcmVjdk1lc3NhZ2UuZ2V0TXNnSWQoKS5n\nZXRMb2NhbENvbXBvbmVudCgpKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0g\nbmV4dFNjYW4gJiYgIXJ1bk5leHRTY2FuKSB7CiAgICAgICAgICAgICAgICBy\ndW5OZXh0U2NhbiA9IHRydWU7CiAgICAgICAgICAgICAgICBtYW5hZ2VyLnNj\nYW5NZXNzYWdlcyhuZXh0U2Nhbik7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIGlmIChwdWJNc2dzLnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1lc3NhZ2Ug\ncHViTXNnID0gcHViTXNncy5yZW1vdmVGaXJzdCgpOwogICAgICAgICAgICBp\nZiAoIUhlbHBlck1ldGhvZHMuYXJlRXF1YWwocmVjdk1lc3NhZ2UsIHB1Yk1z\nZykpIHsKICAgICAgICAgICAgICAgIGZhaWwoIlNjYW5uZWQgbWVzc2FnZSBu\nb3QgZXF1YWwgdG8gZXhwZWN0ZWQiKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgc2Nh\nbkZhaWxlZChPYmplY3QgY3R4LCBFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAg\nICAgICAgICAgIGZhaWwoIkZhaWxlZCB0byBzY2FuIG1lc3NhZ2VzLiIpOwog\nICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgQFN1cHByZXNz\nV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICAgICAgcHVibGljIHZvaWQgc2Nh\nbkZpbmlzaGVkKE9iamVjdCBjdHgsIFJlYXNvbkZvckZpbmlzaCByZWFzb24p\nIHsKICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPiBz\ndGF0dXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+KSBj\ndHg7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdGF0dXNR\ndWV1ZS5wdXQocHViTXNncy5pc0VtcHR5KCkpOwogICAgICAgICAgICB9IGNh\ndGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICB9CgogICAgcHJpdmF0ZSBMaW5rZWRMaXN0PE1l\nc3NhZ2U+IHN1Yk1lc3NhZ2VzKExpc3Q8TWVzc2FnZT4gbXNncywgaW50IHN0\nYXJ0LCBpbnQgZW5kKSB7CiAgICAgICAgTGlua2VkTGlzdDxNZXNzYWdlPiBy\nZXN1bHQgPSBuZXcgTGlua2VkTGlzdDxNZXNzYWdlPigpOwogICAgICAgIGZv\nciAoaW50IGk9c3RhcnQ7IGk8PWVuZDsgaSsrKSB7CiAgICAgICAgICAgIHJl\nc3VsdC5hZGQobXNncy5nZXQoaSkpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gcmVzdWx0OwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0U2Nhbk1lc3NhZ2VzT25DbG9zZWRMZWRnZXJB\nZnRlckRlbGV0ZUxlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIHNjYW5NZXNzYWdlc0FmdGVyRGVsZXRlTGVkZ2VyVGVzdCgyKTsKICAgIH0K\nCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVz\ndFNjYW5NZXNzYWdlc09uVW5jbG9zZWRMZWRnZXJBZnRlckRlbGV0ZUxlZGdl\ncigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHNjYW5NZXNzYWdlc0Fm\ndGVyRGVsZXRlTGVkZ2VyVGVzdCgxKTsKICAgIH0KCiAgICBwcml2YXRlIHZv\naWQgc2Nhbk1lc3NhZ2VzQWZ0ZXJEZWxldGVMZWRnZXJUZXN0KGludCBudW1M\nZWRnZXJzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCeXRlU3RyaW5n\nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIlRlc3RTY2FuTWVz\nc2FnZXNBZnRlckRlbGV0ZUxlZGdlciIpOwoKICAgICAgICBMaXN0PE1lc3Nh\nZ2U+IG1zZ3MgPSBuZXcgQXJyYXlMaXN0PE1lc3NhZ2U+KCk7CgogICAgICAg\nIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAgbXNncy5hZGRBbGwocHVi\nbGlzaE1lc3NhZ2VzKHRvcGljLCAyKSk7CgogICAgICAgIGZvciAoaW50IGk9\nMDsgaTxudW1MZWRnZXJzOyBpKyspIHsKICAgICAgICAgICAgcmVsZWFzZVRv\ncGljKHRvcGljKTsKICAgICAgICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2Fp\nbiB0byBmb3JjZSBhIG5ldyBsZWRnZXIKICAgICAgICAgICAgYWNxdWlyZVRv\ncGljKHRvcGljKTsKICAgICAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1l\nc3NhZ2VzKHRvcGljLCAyKSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdW1l\nZFVudGlsKHRvcGljLCAyTCk7CiAgICAgICAgLy8gV2FpdCB1bnRpbCBsZWRn\nZXIgcmFuZ2VzIGlzIHVwZGF0ZWQuCiAgICAgICAgVGhyZWFkLnNsZWVwKDIw\nMDBMKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAgICAgICAv\nLyBhY3F1aXJlIHRvcGljIGFnYWluCiAgICAgICAgYWNxdWlyZVRvcGljKHRv\ncGljKTsKICAgICAgICAvLyBzY2FuIG1lc3NhZ2VzIHN0YXJ0aW5nIGZyb20g\nMwogICAgICAgIExpbmtlZEJsb2NraW5nUXVldWU8Qm9vbGVhbj4gc3RhdHVz\nUXVldWUgPQogICAgICAgICAgICBuZXcgTGlua2VkQmxvY2tpbmdRdWV1ZTxC\nb29sZWFuPigpOwogICAgICAgIG1hbmFnZXIuc2Nhbk1lc3NhZ2VzKG5ldyBS\nYW5nZVNjYW5SZXF1ZXN0KHRvcGljLCAzLCAyLCBMb25nLk1BWF9WQUxVRSwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgUmFuZ2VTY2FuVmVy\naWZpZXIoc3ViTWVzc2FnZXMobXNncywgMiwgMyksIG51bGwpLCBzdGF0dXNR\ndWV1ZSkpOwogICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwo\nMTAgKiByZWFkRGVsYXksIFRpbWVVbml0Lk1JTExJU0VDT05EUyk7CiAgICAg\nICAgYXNzZXJ0VHJ1ZSgiU2hvdWxkIHN1Y2NlZWQgdG8gc2NhbiBtZXNzYWdl\ncyBhZnRlciBkZWxldGVkIGNvbnN1bWVkIGxlZGdlci4iLCBiKTsKICAgIH0K\nCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGljIHZvaWQgdGVz\ndFNjYW5NZXNzYWdlc09uRW1wdHlMZWRnZXJBZnRlckRlbGV0ZUxlZGdlcigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJ5dGVTdHJpbmcgdG9waWMg\nPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdFNjYW5NZXNzYWdlc09u\nRW1wdHlMZWRnZXJBZnRlckRlbGV0ZUxlZGdlciIpOwoKICAgICAgICBMaXN0\nPE1lc3NhZ2U+IG1zZ3MgPSBuZXcgQXJyYXlMaXN0PE1lc3NhZ2U+KCk7Cgog\nICAgICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAgbXNncy5hZGRB\nbGwocHVibGlzaE1lc3NhZ2VzKHRvcGljLCAyKSk7CiAgICAgICAgcmVsZWFz\nZVRvcGljKHRvcGljKTsKCiAgICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2Fp\nbiB0byBmb3JjZSBhIG5ldyBsZWRnZXIKICAgICAgICBhY3F1aXJlVG9waWMo\ndG9waWMpOwogICAgICAgIGxvZ2dlci5pbmZvKCJDb25zdW1lZCBtZXNzYWdl\ncy4iKTsKICAgICAgICBjb25zdW1lZFVudGlsKHRvcGljLCAyTCk7CiAgICAg\nICAgLy8gV2FpdCB1bnRpbCBsZWRnZXIgcmFuZ2VzIGlzIHVwZGF0ZWQuCiAg\nICAgICAgVGhyZWFkLnNsZWVwKDIwMDBMKTsKICAgICAgICBsb2dnZXIuaW5m\nbygiUmVsZWFzZWQgdG9waWMgd2l0aCBhbiBlbXB0eSBsZWRnZXIuIik7CiAg\nICAgICAgLy8gcmVsZWFzZSB0b3BpYyB0byBmb3JjZSBhbiBlbXB0eSBsZWRn\nZXIKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAgICAgICAvLyBw\ndWJsaXNoIDIgbW9yZSBtZXNzYWdlcywgdGhlc2UgbWVzc2FnZSBleHBlY3Rl\nZCB0byBiZSBpZCAzIGFuZCA0CiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGlj\nKTsKICAgICAgICBsb2dnZXIuaW5mbygiUHVibGlzaGVkIG1vcmUgbWVzc2Fn\nZXMuIik7CiAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3NhZ2VzKHRv\ncGljLCAyKSk7CiAgICAgICAgcmVsZWFzZVRvcGljKHRvcGljKTsKCiAgICAg\nICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbgogICAgICAgIGFjcXVpcmVUb3Bp\nYyh0b3BpYyk7CiAgICAgICAgLy8gc2NhbiBtZXNzYWdlcyBzdGFydGluZyBm\ncm9tIDMKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+IHN0\nYXR1c1F1ZXVlID0KICAgICAgICAgICAgbmV3IExpbmtlZEJsb2NraW5nUXVl\ndWU8Qm9vbGVhbj4oKTsKICAgICAgICBsb25nIHN0YXJ0U2VxSWQgPSByZW1v\ndmVTdGFydFNlcUlkID8gMSA6IDM7CiAgICAgICAgbWFuYWdlci5zY2FuTWVz\nc2FnZXMobmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMsIHN0YXJ0U2VxSWQs\nIDIsIExvbmcuTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIG5ldyBSYW5nZVNjYW5WZXJpZmllcihzdWJNZXNzYWdlcyhtc2dzLCAy\nLCAzKSwgbnVsbCksIHN0YXR1c1F1ZXVlKSk7CiAgICAgICAgQm9vbGVhbiBi\nID0gc3RhdHVzUXVldWUucG9sbCgxMCAqIHJlYWREZWxheSwgVGltZVVuaXQu\nTUlMTElTRUNPTkRTKTsKICAgICAgICBhc3NlcnRUcnVlKCJTaG91bGQgc3Vj\nY2VlZCB0byBzY2FuIG1lc3NhZ2VzIGFmdGVyIGRlbGV0ZWQgY29uc3VtZWQg\nbGVkZ2VyLiIsIGIpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDAp\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0RmFpbGVkVG9EZWxldGVMZWRnZXIxKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZmFpbGVkVG9EZWxldGVMZWRn\nZXJzVGVzdCgxKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQog\nICAgcHVibGljIHZvaWQgdGVzdEZhaWxlZFRvRGVsZXRlTGVkZ2VyMigpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIHN1Y2NlZWQgdG8gZGVsZXRl\nIHNlY29uZCBsZWRnZXIKICAgICAgICBmYWlsZWRUb0RlbGV0ZUxlZGdlcnNU\nZXN0KDIpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBmYWlsZWRUb0RlbGV0\nZUxlZGdlcnNUZXN0KGludCBudW1MZWRnZXJzKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBmaW5hbCBCeXRlU3RyaW5nIHRvcGljID0gQnl0ZVN0cmlu\nZy5jb3B5RnJvbVV0ZjgoIlRlc3RGYWlsZWRUb0RlbGV0ZUxlZGdlciIpOwog\nICAgICAgIGZpbmFsIGludCBzZXJ2aWNlRG93bkNvdW50ID0gMTsKCiAgICAg\nICAgTGlzdDxNZXNzYWdlPiBtc2dzID0gbmV3IEFycmF5TGlzdDxNZXNzYWdl\nPigpOwoKICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtTGVkZ2VyczsgaSsr\nKSB7CiAgICAgICAgICAgIGFjcXVpcmVUb3BpYyh0b3BpYyk7CiAgICAgICAg\nICAgIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdlcyh0b3BpYywgMikpOwog\nICAgICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwogICAgICAgIH0KCiAg\nICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbiB0byBmb3JjZSBhIG5ldyBs\nZWRnZXIKICAgICAgICBhY3F1aXJlVG9waWModG9waWMpOwogICAgICAgIGxv\nZ2dlci5pbmZvKCJDb25zdW1lZCBtZXNzYWdlcy4iKTsKICAgICAgICBtZXRh\nZGF0YU1hbmFnZXJGYWN0b3J5LnNldFNlcnZpY2VEb3duQ291bnQoc2Vydmlj\nZURvd25Db3VudCk7CiAgICAgICAgLy8gZmFpbGVkIGNvbnN1bWVkCiAgICAg\nICAgY29uc3VtZWRVbnRpbCh0b3BpYywgMkwgKiBudW1MZWRnZXJzKTsKICAg\nICAgICAvLyBXYWl0IHVudGlsIGxlZGdlciByYW5nZXMgaXMgdXBkYXRlZC4K\nICAgICAgICBUaHJlYWQuc2xlZXAoMjAwMEwpOwogICAgICAgIGxvZ2dlci5p\nbmZvKCJSZWxlYXNlZCB0b3BpYyB3aXRoIGFuIGVtcHR5IGxlZGdlci4iKTsK\nICAgICAgICAvLyByZWxlYXNlIHRvcGljIHRvIGZvcmNlIGFuIGVtcHR5IGxl\nZGdlcgogICAgICAgIHJlbGVhc2VUb3BpYyh0b3BpYyk7CgogICAgICAgIC8v\nIHB1Ymxpc2ggMiBtb3JlIG1lc3NhZ2VzLCB0aGVzZSBtZXNzYWdlIGV4cGVj\ndGVkIHRvIGJlIGlkIDMgYW5kIDQKICAgICAgICBhY3F1aXJlVG9waWModG9w\naWMpOwogICAgICAgIGxvZ2dlci5pbmZvKCJQdWJsaXNoZWQgbW9yZSBtZXNz\nYWdlcy4iKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXMo\ndG9waWMsIDIpKTsKICAgICAgICByZWxlYXNlVG9waWModG9waWMpOwoKICAg\nICAgICAvLyBhY3F1aXJlIHRvcGljIGFnYWluCiAgICAgICAgYWNxdWlyZVRv\ncGljKHRvcGljKTsKICAgICAgICBMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xl\nYW4+IHN0YXR1c1F1ZXVlID0KICAgICAgICAgICAgbmV3IExpbmtlZEJsb2Nr\naW5nUXVldWU8Qm9vbGVhbj4oKTsKICAgICAgICBtYW5hZ2VyLnNjYW5NZXNz\nYWdlcyhuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgbnVtTGVkZ2VycyAq\nIDIgKyAxLCAyLCBMb25nLk1BWF9WQUxVRSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBuZXcgUmFuZ2VTY2FuVmVyaWZpZXIoc3ViTWVzc2FnZXMo\nbXNncywgbnVtTGVkZ2VycyAqIDIsIG51bUxlZGdlcnMgKiAyICsgMSksIG51\nbGwpLCBzdGF0dXNRdWV1ZSkpOwogICAgICAgIEJvb2xlYW4gYiA9IHN0YXR1\nc1F1ZXVlLnBvbGwoMTAgKiByZWFkRGVsYXksIFRpbWVVbml0Lk1JTExJU0VD\nT05EUyk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiU2hvdWxkIHN1Y2NlZWQgdG8g\nc2NhbiBtZXNzYWdlcyBhZnRlciBkZWxldGVkIGNvbnN1bWVkIGxlZGdlci4i\nLCBiKTsKCiAgICAgICAgLy8gY29uc3VtZWQgCiAgICAgICAgY29uc3VtZWRV\nbnRpbCh0b3BpYywgKG51bUxlZGdlcnMgKyAxKSAqIDJMKTsKICAgICAgICAv\nLyBXYWl0IHVudGlsIGxlZGdlciByYW5nZXMgaXMgdXBkYXRlZC4KICAgICAg\nICBUaHJlYWQuc2xlZXAoMjAwMEwpOwoKICAgICAgICBTZW1hcGhvcmUgbGF0\nY2ggPSBuZXcgU2VtYXBob3JlKDEpOwogICAgICAgIGxhdGNoLmFjcXVpcmUo\nKTsKICAgICAgICB0cE1hbmFnZXIucmVhZFRvcGljUGVyc2lzdGVuY2VJbmZv\nKHRvcGljLCBuZXcgQ2FsbGJhY2s8VmVyc2lvbmVkPExlZGdlclJhbmdlcz4+\nKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGlj\nIHZvaWQgb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVmVyc2lvbmVk\nPExlZGdlclJhbmdlcz4gcmFuZ2VzKSB7CiAgICAgICAgICAgICAgICBpZiAo\nbnVsbCA9PSByYW5nZXMgfHwgcmFuZ2VzLmdldFZhbHVlKCkuZ2V0UmFuZ2Vz\nTGlzdCgpLnNpemUoKSA+IDEpIHsKICAgICAgICAgICAgICAgICAgICBmYWls\ndXJlRXhjZXB0aW9uID0gbmV3IFB1YlN1YkV4Y2VwdGlvbi5Ob1RvcGljUGVy\nc2lzdGVuY2VJbmZvRXhjZXB0aW9uKCJJbnZhbGlkIHBlcnNpc3RlbmNlIGlu\nZm8gZm91bmQgZm9yIHRvcGljICIgKyB0b3BpYy50b1N0cmluZ1V0ZjgoKSk7\nCiAgICAgICAgICAgICAgICAgICAgKChTZW1hcGhvcmUpY3R4KS5yZWxlYXNl\nKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgZmFpbHVyZUV4Y2VwdGlvbiA9IG51bGw7\nCiAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAg\nICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1\nYlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIGZh\naWx1cmVFeGNlcHRpb24gPSBleGNlcHRpb247CiAgICAgICAgICAgICAgICAo\nKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0sIGxhdGNoKTsKICAgICAgICBsYXRjaC5hY3F1aXJlKCk7CiAgICAg\nICAgbGF0Y2gucmVsZWFzZSgpOwogICAgICAgIGFzc2VydE51bGwoIlNob3Vs\nZCBub3QgZmFpbCB3aXRoIGV4Y2VwdGlvbi4iLCBmYWlsdXJlRXhjZXB0aW9u\nKTsKICAgIH0KCiAgICBAVGVzdCh0aW1lb3V0PTYwMDAwKQogICAgcHVibGlj\nIHZvaWQgdGVzdFNjYW5NZXNzYWdlc09uVHdvTGVkZ2VycygpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHN0b3BDbHVzdGVyKCk7CiAgICAgICAgc3Rh\ncnRDbHVzdGVyKHJlYWREZWxheSk7CgogICAgICAgIEJ5dGVTdHJpbmcgdG9w\naWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgiVGVzdFNjYW5NZXNzYWdl\nc09uVHdvTGVkZ2VycyIpOwoKICAgICAgICBMaXN0PE1lc3NhZ2U+IG1zZ3Mg\nPSBuZXcgQXJyYXlMaXN0PE1lc3NhZ2U+KCk7CgogICAgICAgIGFjcXVpcmVU\nb3BpYyh0b3BpYyk7CiAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3Nh\nZ2VzKHRvcGljLCAxKSk7CiAgICAgICAgcmVsZWFzZVRvcGljKHRvcGljKTsK\nCiAgICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbiB0byBmb3JjZSBhIG5l\ndyBsZWRnZXIKICAgICAgICBhY3F1aXJlVG9waWModG9waWMpOwogICAgICAg\nIG1zZ3MuYWRkQWxsKHB1Ymxpc2hNZXNzYWdlcyh0b3BpYywgMykpOwoKICAg\nICAgICAvLyBzY2FuIG1lc3NhZ2VzCiAgICAgICAgTGlua2VkQmxvY2tpbmdR\ndWV1ZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IG5ldyBMaW5rZWRCbG9ja2lu\nZ1F1ZXVlPEJvb2xlYW4+KCk7CiAgICAgICAgUmFuZ2VTY2FuUmVxdWVzdCBu\nZXh0U2NhbiA9IG5ldyBSYW5nZVNjYW5SZXF1ZXN0KHRvcGljLCAzLCAyLCBM\nb25nLk1BWF9WQUxVRSwKICAgICAgICAgICAgICAgIG5ldyBSYW5nZVNjYW5W\nZXJpZmllcihzdWJNZXNzYWdlcyhtc2dzLCAyLCAzKSwgbnVsbCksIHN0YXR1\nc1F1ZXVlKTsKICAgICAgICBtYW5hZ2VyLnNjYW5NZXNzYWdlcyhuZXcgUmFu\nZ2VTY2FuUmVxdWVzdCh0b3BpYywgMSwgMiwgTG9uZy5NQVhfVkFMVUUsCiAg\nICAgICAgICAgICAgICBuZXcgUmFuZ2VTY2FuVmVyaWZpZXIoc3ViTWVzc2Fn\nZXMobXNncywgMCwgMSksIG5leHRTY2FuKSwgc3RhdHVzUXVldWUpKTsKICAg\nICAgICBCb29sZWFuIGIgPSBzdGF0dXNRdWV1ZS5wb2xsKDEwICogcmVhZERl\nbGF5LCBUaW1lVW5pdC5NSUxMSVNFQ09ORFMpOwogICAgICAgIGlmIChiID09\nIG51bGwpIHsKICAgICAgICAgICAgZmFpbCgiT25lIHNjYW4gcmVxdWVzdCBk\nb2Vzbid0IGZpbmlzaCIpOwogICAgICAgIH0KICAgICAgICBiID0gc3RhdHVz\nUXVldWUucG9sbCgxMCAqIHJlYWREZWxheSwgVGltZVVuaXQuTUlMTElTRUNP\nTkRTKTsKICAgICAgICBpZiAoYiA9PSBudWxsKSB7CiAgICAgICAgICAgIGZh\naWwoIk9uZSBzY2FuIHJlcXVlc3QgZG9lc24ndCBmaW5pc2giKTsKICAgICAg\nICB9CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RJbmNvbnNpc3RlbnRTdWJzY3JpcHRpb25TdGF0ZUFuZExl\nZGdlclJhbmdlczEoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBT\nZWUgdGhlIGNvbW1lbnQgb2YgaW5jb25zaXN0ZW50U3Vic2NyaXB0aW9uU3Rh\ndGVBbmRMZWRnZXJSYW5nZXMuCiAgICAgICAgLy8gRm9yIHRoaXMgY2FzZSwg\nU3RlcCAoMikgZmFpbGVkIHRvIHVwZGF0ZSBzdWJzY3JpcHRpb24gc3RhdGUg\nbWV0YWRhdGEsCiAgICAgICAgLy8gYnV0IExlZGdlclJhbmdlcyBpcyB1cGRh\ndGVkIHN1Y2Nlc3MuCiAgICAgICAgLy8gUmVzdWx0OiBzY2FuIG1lc3NhZ2Vz\nIGZyb20gMSB0byA0IHRha2UgcGxhY2Ugb24gbGVkZ2VyIEwyLgogICAgICAg\nIGluY29uc2lzdGVudFN1YnNjcmlwdGlvblN0YXRlQW5kTGVkZ2VyUmFuZ2Vz\nKDEpOwogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICBwdWJs\naWMgdm9pZCB0ZXN0SW5jb25zaXN0ZW50U3Vic2NyaXB0aW9uU3RhdGVBbmRM\nZWRnZXJSYW5nZXMyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8g\nU2VlIHRoZSBjb21tZW50IG9mIGluY29uc2lzdGVudFN1YnNjcmlwdGlvblN0\nYXRlQW5kTGVkZ2VyUmFuZ2VzLgogICAgICAgIC8vIEZvciB0aGlzIGNhc2Us\nIHN0ZXAgKDIpIGZhaWxlZCB0byB1cGRhdGUgc3Vic2NyaXB0aW9uIHN0YXRl\nIG1ldGFkYXRhLAogICAgICAgIC8vIHN0ZXAgKDMpIHN1Y2Nlc3NmdWxseSBk\nZWxldGUgTDEgYnV0IGZhaWxlZCB0byB1cGRhdGUgTGVkZ2VyUmFuZ2VzLgog\nICAgICAgIC8vIFJlc3VsdDogc2NhbiBtZXNzYWdlcyBmcm9tIDEgdG8gNCBm\nYWxscyBpbiBMMSBhbmQgTDIsCiAgICAgICAgLy8gICAgICAgICBidXQgQm9v\na0tlZXBlciBtYXkgY29tcGxhaW4gTDEgbm90IGZvdW5kLgogICAgICAgIGlu\nY29uc2lzdGVudFN1YnNjcmlwdGlvblN0YXRlQW5kTGVkZ2VyUmFuZ2VzKDIp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2luY2UgSW5NZW1vcnlTdWJzY3Jp\ncHRpb25TdGF0ZSBhbmQgTGVkZ2VyUmFuZ2VzIGlzIG1haW50YWluZWQKICAg\nICAqIHNlcGFyYXRlbHksIHRoZXJlIG1heSBleGlzdCBzdWNoIGluY29uc2lz\ndGVudCBzdGF0ZToKICAgICAqICgxKS4gVG9waWMgbGVkZ2VyczogTDEgWzEg\nfiAyXSwgTDIgWzMgfiBdCiAgICAgKiAoMikuIFN1YnNjcmliZXIgY29uc3Vt\nZXMgdG8gMiBhbmQgSW5NZW1vcnlTdWJzY3JpcHRpb25TdGF0ZSBpcyB1cGRh\ndGVkCiAgICAgKiAgICAgIHN1Y2Nlc3NmdWxseSBidXQgZmFpbGVkIHdoZW4g\ndXBkYXRpbmcgc3Vic2NyaXB0aW9uIHN0YXRlIG1ldGFkYXRhCiAgICAgKiAo\nMykuIEFic3RyYWN0U3Vic2NyaXB0aW9uTWFuYWdlciNNZXNzYWdlc0NvbnN1\nbWVkVGFzayB1c2UKICAgICAqICAgICAgSW5NZW1vcnlTdWJzY3JpcHRpb25T\ndGF0ZSB0byBkbyBnYXJiYWdlIGNvbGxlY3Rpb24KICAgICAqICAgICAgYW5k\nIEwxIGlzIGRlbGV0ZQogICAgICogKDQpLiBJZiBIdWIgcmVzdGFydHMgYXQg\ndGhpcyB0aW1lLCBvbGQgc3Vic2NyaXB0aW9uIHN0YXRlIGlzIHJlYWQgYW5k\nCiAgICAgKiAgICAgIEh1YiB3aWxsIHRyeSB0byBkZWxpdmVyIG1lc3NhZ2Ug\nZnJvbSAxCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGluY29uc2lzdGVudFN1\nYnNjcmlwdGlvblN0YXRlQW5kTGVkZ2VyUmFuZ2VzKGludCBmYWlsZWRDb3Vu\ndCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZmluYWwgQnl0ZVN0cmlu\nZyB0b3BpYyA9IEJ5dGVTdHJpbmcuY29weUZyb21VdGY4KCJpbmNvbnNpc3Rl\nbnRTdWJzY3JpcHRpb25TdGF0ZUFuZExlZGdlclJhbmdlcyIpOwogICAgICAg\nIGZpbmFsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkID0gQnl0ZVN0cmluZy5j\nb3B5RnJvbVV0ZjgoInN1YklkIik7CiAgICAgICAgTGlua2VkTGlzdDxNZXNz\nYWdlPiBtc2dzID0gbmV3IExpbmtlZExpc3Q8TWVzc2FnZT4oKTsKCiAgICAg\nICAgLy8gbWFrZSBsZWRnZXIgTDEgWzEgfiAyXQogICAgICAgIGFjcXVpcmVU\nb3BpYyh0b3BpYyk7CiAgICAgICAgbXNncy5hZGRBbGwocHVibGlzaE1lc3Nh\nZ2VzKHRvcGljLCAyKSk7CiAgICAgICAgcmVsZWFzZVRvcGljKHRvcGljKTsK\nCiAgICAgICAgLy8gYWNxdWlyZSB0b3BpYyBhZ2FpbiB0byBmb3JjZSBhIG5l\ndyBsZWRnZXIgTDIgWzMgfiBdCiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGlj\nKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXModG9waWMs\nIDIpKTsKCiAgICAgICAgU3R1YkNhbGxiYWNrPFZvaWQ+IHZvaWRDYiA9IG5l\ndyBTdHViQ2FsbGJhY2s8Vm9pZD4oKTsKICAgICAgICBTdHViQ2FsbGJhY2s8\nU3Vic2NyaXB0aW9uRGF0YT4gc3ViRGF0YUNiID0gbmV3IFN0dWJDYWxsYmFj\nazxTdWJzY3JpcHRpb25EYXRhPigpOwogICAgICAgIEVpdGhlcjxWb2lkLCBQ\ndWJTdWJFeGNlcHRpb24+IHZvaWRSZXN1bHQ7CiAgICAgICAgRWl0aGVyPFN1\nYnNjcmlwdGlvbkRhdGEsIFB1YlN1YkV4Y2VwdGlvbj4gc3ViRGF0YVJlc3Vs\ndDsKCiAgICAgICAgLy8gcHJlcGFyZSBmb3Igc3Vic2NyaXB0aW9uCiAgICAg\nICAgc20uYWNxdWlyZWRUb3BpYyh0b3BpYywgdm9pZENiLCBudWxsKTsKICAg\nICAgICB2b2lkUmVzdWx0ID0gQ29uY3VycmVuY3lVdGlscy50YWtlKHZvaWRD\nYi5xdWV1ZSk7CiAgICAgICAgYXNzZXJ0TnVsbCh2b2lkUmVzdWx0LnJpZ2h0\nKCkpOyAvLyBubyBleGNlcHRpb24KCiAgICAgICAgLy8gRG8gc3Vic2NyaXB0\naW9uCiAgICAgICAgU3Vic2NyaWJlUmVxdWVzdCBzdWJSZXF1ZXN0ID0gU3Vi\nc2NyaWJlUmVxdWVzdC5uZXdCdWlsZGVyKCkuc2V0U3Vic2NyaWJlcklkKHN1\nYnNjcmliZXJJZCkKICAgICAgICAgICAgICAgIC5zZXRDcmVhdGVPckF0dGFj\naChDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKS5idWlsZCgpOwog\nICAgICAgIHNtLnNlcnZlU3Vic2NyaWJlUmVxdWVzdCh0b3BpYywgc3ViUmVx\ndWVzdCwgTWVzc2FnZVNlcUlkLm5ld0J1aWxkZXIoKS5zZXRMb2NhbENvbXBv\nbmVudCgwKS5idWlsZCgpLCBzdWJEYXRhQ2IsCiAgICAgICAgICAgICAgICBu\ndWxsKTsKICAgICAgICBzdWJEYXRhUmVzdWx0ID0gQ29uY3VycmVuY3lVdGls\ncy50YWtlKHN1YkRhdGFDYi5xdWV1ZSk7CiAgICAgICAgYXNzZXJ0Tm90TnVs\nbChzdWJEYXRhUmVzdWx0LmxlZnQoKSk7IC8vIHNlcnZlU3Vic2NyaWJlUmVx\ndWVzdCBzdWNjZXNzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gYSBTdWJzY3JpcHRpb25EYXRh\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC8vIG9iamVjdAogICAgICAgIGFzc2VydE51bGwoc3ViRGF0YVJlc3VsdC5y\naWdodCgpKTsgLy8gbm8gZXhjZXB0aW9uCgogICAgICAgIC8vIHNpbXVsYXRl\nIGluY29uc2lzdGVudCBzaXR1YXRpb24gYmV0d2VlbiBJbk1lbW9yeVN1YnNj\ncmlwdGlvblN0YXRlIGFuZAogICAgICAgIC8vIExlZGdlclJhbmdlcwogICAg\nICAgIG1ldGFkYXRhTWFuYWdlckZhY3Rvcnkuc2V0U2VydmljZURvd25Db3Vu\ndChmYWlsZWRDb3VudCk7CiAgICAgICAgc20uc2V0Q29uc3VtZVNlcUlkRm9y\nU3Vic2NyaWJlcih0b3BpYywgc3Vic2NyaWJlcklkLCBNZXNzYWdlU2VxSWQu\nbmV3QnVpbGRlcigpLnNldExvY2FsQ29tcG9uZW50KDIpLmJ1aWxkKCksCiAg\nICAgICAgICAgICAgICB2b2lkQ2IsIG51bGwpOwogICAgICAgIHZvaWRSZXN1\nbHQgPSBDb25jdXJyZW5jeVV0aWxzLnRha2Uodm9pZENiLnF1ZXVlKTsKICAg\nICAgICBhc3NlcnROb3ROdWxsKHZvaWRSZXN1bHQucmlnaHQoKSk7IC8vIHVw\nZGF0ZSBzdWJzY3JpcHRpb24gc3RhdGUgZmFpbGVkCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgZXhwZWN0IGEg\nZXhjZXB0aW9uCgogICAgICAgIC8vIHdhaXQgQWJzdHJhY3RTdWJzY3JpcHRp\nb25NYW5hZ2VyI01lc3NhZ2VzQ29uc3VtZWRUYXNrIHRvIGdhcmJhZ2UKICAg\nICAgICAvLyBjb2xsZWN0IGxlZGdlciBMMQogICAgICAgIFRocmVhZC5zbGVl\ncChjb25mLmdldE1lc3NhZ2VzQ29uc3VtZWRUaHJlYWRSdW5JbnRlcnZhbCgp\nICogMik7CgogICAgICAgIC8vIHNpbXVsYXRlIGh1YiByZXN0YXJ0OiByZWFk\nIG9sZCBzdWJzY3JpcHRpb24gc3RhdGUgbWV0YWRhdGEgYW5kIGRlbGl2ZXIK\nICAgICAgICAvLyBtZXNzYWdlcyBmcm9tIDEKICAgICAgICBMaW5rZWRCbG9j\na2luZ1F1ZXVlPEJvb2xlYW4+IHN0YXR1c1F1ZXVlID0gbmV3IExpbmtlZEJs\nb2NraW5nUXVldWU8Qm9vbGVhbj4oKTsKICAgICAgICBSYW5nZVNjYW5SZXF1\nZXN0IHNjYW4gPSBuZXcgUmFuZ2VTY2FuUmVxdWVzdCh0b3BpYywgMSwgNCwg\nTG9uZy5NQVhfVkFMVUUsIG5ldyBSYW5nZVNjYW5WZXJpZmllcihtc2dzLCBu\ndWxsKSwKICAgICAgICAgICAgICAgIHN0YXR1c1F1ZXVlKTsKICAgICAgICBt\nYW5hZ2VyLnNjYW5NZXNzYWdlcyhzY2FuKTsKICAgICAgICBCb29sZWFuIGIg\nPSBzdGF0dXNRdWV1ZS5wb2xsKDEwICogcmVhZERlbGF5LCBUaW1lVW5pdC5N\nSUxMSVNFQ09ORFMpOwogICAgICAgIGlmIChiID09IG51bGwpIHsKICAgICAg\nICAgICAgZmFpbCgiU2NhbiByZXF1ZXN0IGRvZXNuJ3QgZmluaXNoIik7CiAg\nICAgICAgfQogICAgfQoKICAgIEBUZXN0KHRpbWVvdXQ9NjAwMDApCiAgICAv\nLyBBZGQgdGhpcyB0ZXN0IGNhc2UgZm9yIEJPT0tLRUVQRVItNDU4CiAgICBw\ndWJsaWMgdm9pZCB0ZXN0UmVhZFdoZW5Ub3BpY0NoYW5nZUxlZGdlcigpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIGZpbmFsIEJ5dGVTdHJpbmcgdG9w\naWMgPSBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgidGVzdFJlYWRXaGVuVG9w\naWNDaGFuZ2VMZWRnZXIiKTsKICAgICAgICBMaW5rZWRMaXN0PE1lc3NhZ2U+\nIG1zZ3MgPSBuZXcgTGlua2VkTGlzdDxNZXNzYWdlPigpOwoKICAgICAgICAv\nLyBXcml0ZSBtYXhFbnRyaWVzUGVyTGVkZ2VyIGVudHJpZXMgdG8gbWFrZSB0\nb3BpYyBjaGFuZ2UgbGVkZ2VyCiAgICAgICAgYWNxdWlyZVRvcGljKHRvcGlj\nKTsKICAgICAgICBtc2dzLmFkZEFsbChwdWJsaXNoTWVzc2FnZXModG9waWMs\nIG1heEVudHJpZXNQZXJMZWRnZXIpKTsKCiAgICAgICAgLy8gTm90aWNlLCBj\naGFuZ2UgbGVkZ2VyIG9wZXJhdGlvbiBpcyBhc3luY2hyb25vdXMsIHNvIHdl\nIHNob3VsZCB3YWl0ISEhCiAgICAgICAgVGhyZWFkLnNsZWVwKDIwMDApOwoK\nICAgICAgICAvLyBJc3N1ZSBhIHNjYW4gcmVxdWVzdCByaWdodCBzdGFydCBm\ncm9tIHRoZSBuZXcgbGVkZ2VyCiAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1\nZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IG5ldyBMaW5rZWRCbG9ja2luZ1F1\nZXVlPEJvb2xlYW4+KCk7CiAgICAgICAgUmFuZ2VTY2FuUmVxdWVzdCBzY2Fu\nID0gbmV3IFJhbmdlU2NhblJlcXVlc3QodG9waWMsIG1heEVudHJpZXNQZXJM\nZWRnZXIgKyAxLCAxLCBMb25nLk1BWF9WQUxVRSwKICAgICAgICAgICAgICAg\nIG5ldyBSYW5nZVNjYW5WZXJpZmllcihtc2dzLCBudWxsKSwgc3RhdHVzUXVl\ndWUpOwogICAgICAgIG1hbmFnZXIuc2Nhbk1lc3NhZ2VzKHNjYW4pOwogICAg\nICAgIEJvb2xlYW4gYiA9IHN0YXR1c1F1ZXVlLnBvbGwoMTAgKiByZWFkRGVs\nYXksIFRpbWVVbml0Lk1JTExJU0VDT05EUyk7CiAgICAgICAgaWYgKGIgPT0g\nbnVsbCkgewogICAgICAgICAgICBmYWlsKCJTY2FuIHJlcXVlc3QgdGltZW91\ndCIpOwogICAgICAgIH0KICAgICAgICBhc3NlcnRGYWxzZSgiRXhwZWN0IG5v\nbmUgbWVzc2FnZSBpcyBzY2FubmVkIG9uIHRoZSBuZXcgY3JlYXRlZCBsZWRn\nZXIiLCBiKTsKICAgIH0KCiAgICBjbGFzcyBUZXN0Q2FsbGJhY2sgaW1wbGVt\nZW50cyBDYWxsYmFjazxQdWJTdWJQcm90b2NvbC5NZXNzYWdlU2VxSWQ+IHsK\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgQFN1cHByZXNzV2FybmluZ3Mo\nInVuY2hlY2tlZCIpCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmFp\nbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsK\nICAgICAgICAgICAgTGlua2VkQmxvY2tpbmdRdWV1ZTxCb29sZWFuPiBzdGF0\ndXNRdWV1ZSA9IChMaW5rZWRCbG9ja2luZ1F1ZXVlPEJvb2xlYW4+KSBjdHg7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdGF0dXNRdWV1\nZS5wdXQoZmFsc2UpOwogICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVu\ndGltZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgQFN1cHByZXNzV2FybmluZ3MoInVu\nY2hlY2tlZCIpCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uRmluaXNo\nZWQoT2JqZWN0IGN0eCwgUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkIHJl\nc3VsdE9mT3BlcmF0aW9uKSB7CiAgICAgICAgICAgIExpbmtlZEJsb2NraW5n\nUXVldWU8Qm9vbGVhbj4gc3RhdHVzUXVldWUgPSAoTGlua2VkQmxvY2tpbmdR\ndWV1ZTxCb29sZWFuPikgY3R4OwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgc3RhdHVzUXVldWUucHV0KHRydWUpOwogICAgICAgICAgICB9\nIGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihlKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgTGlzdDxNZXNz\nYWdlPiBwdWJsaXNoTWVzc2FnZXMoQnl0ZVN0cmluZyB0b3BpYywgaW50IG51\nbU1zZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExpc3Q8TWVzc2Fn\nZT4gbXNncyA9IEhlbHBlck1ldGhvZHMuZ2V0UmFuZG9tUHVibGlzaGVkTWVz\nc2FnZXMobnVtTXNncywgMTAyNCk7CiAgICAgICAgTGlua2VkQmxvY2tpbmdR\ndWV1ZTxCb29sZWFuPiBzdGF0dXNRdWV1ZSA9IG5ldyBMaW5rZWRCbG9ja2lu\nZ1F1ZXVlPEJvb2xlYW4+KCk7CiAgICAgICAgZm9yIChNZXNzYWdlIG1zZyA6\nIG1zZ3MpIHsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBt\nYW5hZ2VyLnBlcnNpc3RNZXNzYWdlKG5ldyBQZXJzaXN0UmVxdWVzdCh0b3Bp\nYywgbXNnLCBuZXcgVGVzdENhbGxiYWNrKCksIHN0YXR1c1F1ZXVlKSk7CiAg\nICAgICAgICAgICAgICAvLyB3YWl0IGEgbWF4aW11bSBvZiBhIG1pbnV0ZQog\nICAgICAgICAgICAgICAgQm9vbGVhbiBiID0gc3RhdHVzUXVldWUucG9sbCg2\nMCwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAgICAgICAgICAgICBpZiAoYiA9\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRp\nbWVFeGNlcHRpb24oIlB1Ymxpc2ggdGltZWQgb3V0Iik7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhj\nZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBtc2dzOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFjcXVpcmVU\nb3BpYyhCeXRlU3RyaW5nIHRvcGljKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBTZW1hcGhvcmUgbGF0Y2ggPSBuZXcgU2VtYXBob3JlKDEpOwogICAg\nICAgIGxhdGNoLmFjcXVpcmUoKTsKICAgICAgICBtYW5hZ2VyLmFjcXVpcmVk\nVG9waWModG9waWMsIG5ldyBDYWxsYmFjazxWb2lkPigpIHsKICAgICAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlv\nbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZvaWQgcmVzdWx0T2ZPcGVyYXRpb24p\nIHsKICAgICAgICAgICAgICAgIGZhaWx1cmVFeGNlcHRpb24gPSBudWxsOwog\nICAgICAgICAgICAgICAgKChTZW1hcGhvcmUpY3R4KS5yZWxlYXNlKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChPYmplY3QgY3R4LCBQdWJT\ndWJFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICBmYWls\ndXJlRXhjZXB0aW9uID0gZXhjZXB0aW9uOwogICAgICAgICAgICAgICAgKChT\nZW1hcGhvcmUpY3R4KS5yZWxlYXNlKCk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9LCBsYXRjaCk7CiAgICAgICAgbGF0Y2guYWNxdWlyZSgpOwogICAgICAg\nIGxhdGNoLnJlbGVhc2UoKTsKICAgICAgICBpZiAobnVsbCAhPSBmYWlsdXJl\nRXhjZXB0aW9uKSB7CiAgICAgICAgICAgIHRocm93IGZhaWx1cmVFeGNlcHRp\nb247CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHJlbGVh\nc2VUb3BpYyhmaW5hbCBCeXRlU3RyaW5nIHRvcGljKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBtYW5hZ2VyLmxvc3RUb3BpYyh0b3BpYyk7CiAgICAg\nICAgLy8gYmFja3dhcmQgdGVzdGluZyBsZWRnZXIgcmFuZ2VzIHdpdGhvdXQg\nc3RhcnQgc2VxIGlkCiAgICAgICAgaWYgKHJlbW92ZVN0YXJ0U2VxSWQpIHsK\nICAgICAgICAgICAgU2VtYXBob3JlIGxhdGNoID0gbmV3IFNlbWFwaG9yZSgx\nKTsKICAgICAgICAgICAgbGF0Y2guYWNxdWlyZSgpOwogICAgICAgICAgICB0\ncE1hbmFnZXIucmVhZFRvcGljUGVyc2lzdGVuY2VJbmZvKHRvcGljLCBuZXcg\nQ2FsbGJhY2s8VmVyc2lvbmVkPExlZGdlclJhbmdlcz4+KCkgewogICAgICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBvcGVyYXRpb25GaW5pc2hlZChPYmplY3QgY3R4LCBWZXJzaW9uZWQ8TGVk\nZ2VyUmFuZ2VzPiByYW5nZXMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAo\nbnVsbCA9PSByYW5nZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmFp\nbHVyZUV4Y2VwdGlvbiA9IG5ldyBQdWJTdWJFeGNlcHRpb24uTm9Ub3BpY1Bl\ncnNpc3RlbmNlSW5mb0V4Y2VwdGlvbigiTm8gcGVyc2lzdGVuY2UgaW5mbyBm\nb3VuZCBmb3IgdG9waWMgIiArIHRvcGljLnRvU3RyaW5nVXRmOCgpKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgKChTZW1hcGhvcmUpY3R4KS5yZWxlYXNl\nKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIGJ1aWxkIGEg\nbmV3IGxlZGdlciByYW5nZXMgdy9vIHN0YXJ0IHNlcSBpZC4KICAgICAgICAg\nICAgICAgICAgICBMZWRnZXJSYW5nZXMuQnVpbGRlciBidWlsZGVyID0gTGVk\nZ2VyUmFuZ2VzLm5ld0J1aWxkZXIoKTsKICAgICAgICAgICAgICAgICAgICBm\naW5hbCBMaXN0PExlZGdlclJhbmdlPiByYW5nZXNMaXN0ID0gcmFuZ2VzLmdl\ndFZhbHVlKCkuZ2V0UmFuZ2VzTGlzdCgpOwogICAgICAgICAgICAgICAgICAg\nIGZvciAoTGVkZ2VyUmFuZ2UgcmFuZ2UgOiByYW5nZXNMaXN0KSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIExlZGdlclJhbmdlLkJ1aWxkZXIgbmV3UmFu\nZ2VCdWlsZGVyID0gTGVkZ2VyUmFuZ2UubmV3QnVpbGRlcigpOwogICAgICAg\nICAgICAgICAgICAgICAgICBuZXdSYW5nZUJ1aWxkZXIuc2V0TGVkZ2VySWQo\ncmFuZ2UuZ2V0TGVkZ2VySWQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmIChyYW5nZS5oYXNFbmRTZXFJZEluY2x1ZGVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG5ld1JhbmdlQnVpbGRlci5zZXRFbmRTZXFJ\nZEluY2x1ZGVkKHJhbmdlLmdldEVuZFNlcUlkSW5jbHVkZWQoKSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nYnVpbGRlci5hZGRSYW5nZXMobmV3UmFuZ2VCdWlsZGVyLmJ1aWxkKCkpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0cE1h\nbmFnZXIud3JpdGVUb3BpY1BlcnNpc3RlbmNlSW5mbyh0b3BpYywgYnVpbGRl\nci5idWlsZCgpLCByYW5nZXMuZ2V0VmVyc2lvbigpLAogICAgICAgICAgICAg\nICAgICAgIG5ldyBDYWxsYmFjazxWZXJzaW9uPigpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZpbmlzaGVkKE9iamVjdCBjdHgsIFZl\ncnNpb24gbmV3VmVyc2lvbikgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZmFpbHVyZUV4Y2VwdGlvbiA9IG51bGw7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIFB1YlN1YkV4Y2VwdGlvbiBl\neGNlcHRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWx1\ncmVFeGNlcHRpb24gPSBleGNlcHRpb247CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2UoKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIGN0eCk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9wZXJhdGlvbkZhaWxlZChP\nYmplY3QgY3R4LCBQdWJTdWJFeGNlcHRpb24gZXhjZXB0aW9uKSB7CiAgICAg\nICAgICAgICAgICAgICAgZmFpbHVyZUV4Y2VwdGlvbiA9IGV4Y2VwdGlvbjsK\nICAgICAgICAgICAgICAgICAgICAoKFNlbWFwaG9yZSljdHgpLnJlbGVhc2Uo\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgbGF0Y2gpOwog\nICAgICAgICAgICBsYXRjaC5hY3F1aXJlKCk7CiAgICAgICAgICAgIGxhdGNo\nLnJlbGVhc2UoKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0gZmFpbHVyZUV4\nY2VwdGlvbikgewogICAgICAgICAgICAgICAgdGhyb3cgZmFpbHVyZUV4Y2Vw\ndGlvbjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBjb25zdW1lZFVudGlsKEJ5dGVTdHJpbmcgdG9waWMsIGxv\nbmcgc2VxSWQpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIG1hbmFnZXIu\nY29uc3VtZWRVbnRpbCh0b3BpYywgc2VxSWQpOwogICAgfQoKfQo=\n","encoding":"base64"}

