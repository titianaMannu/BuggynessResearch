{"sha":"b46ffb464d4f133c7eff395c6ef6ee9b1dc901ce","node_id":"MDQ6QmxvYjE1NzU5NTY6YjQ2ZmZiNDY0ZDRmMTMzYzdlZmYzOTVjNmVmNmVlOWIxZGM5MDFjZQ==","size":10052,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/b46ffb464d4f133c7eff395c6ef6ee9b1dc901ce","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuU3luY2hyb25vdXNRdWV1ZTsKCmltcG9ydCBvcmcuanVuaXQu\nQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1\nbml0LlRlc3Q7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJv\ndG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNs\naWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmNsaWVudC5hcGkuU3Vic2NyaWJlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5IZWR3aWdD\nbGllbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVh\ndGVPckF0dGFjaDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5I\nZWR3aWdIdWJUZXN0QmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy51dGlsLkNvbmN1cnJlbmN5VXRpbHM7CgpwdWJsaWMgY2xhc3Mg\nVGVzdERlYWRsb2NrIGV4dGVuZHMgSGVkd2lnSHViVGVzdEJhc2UgewoKICAg\nIHByb3RlY3RlZCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3Rv\ncnkuZ2V0TG9nZ2VyKFRlc3REZWFkbG9jay5jbGFzcyk7CgogICAgLy8gQ2xp\nZW50IHNpZGUgdmFyaWFibGVzCiAgICBwcm90ZWN0ZWQgSGVkd2lnQ2xpZW50\nIGNsaWVudDsKICAgIHByb3RlY3RlZCBQdWJsaXNoZXIgcHVibGlzaGVyOwog\nICAgcHJvdGVjdGVkIFN1YnNjcmliZXIgc3Vic2NyaWJlcjsKCiAgICBCeXRl\nU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkRlYWRM\nb2NrVG9waWMiKTsKICAgIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkID0gQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgoImRsIik7CgogICAgcHVibGljIFRlc3RE\nZWFkbG9jaygpIHsKICAgICAgICBzdXBlcigxKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgbnVtQm9va2llcyA9IDE7CiAgICAg\nICAgcmVhZERlbGF5ID0gMTAwMEw7IC8vIDFzCiAgICAgICAgc3VwZXIuc2V0\nVXAoKTsKICAgICAgICBjbGllbnQgPSBuZXcgSGVkd2lnQ2xpZW50KG5ldyBI\ndWJDbGllbnRDb25maWd1cmF0aW9uKCkpOwogICAgICAgIHB1Ymxpc2hlciA9\nIGNsaWVudC5nZXRQdWJsaXNoZXIoKTsKICAgICAgICBzdWJzY3JpYmVyID0g\nY2xpZW50LmdldFN1YnNjcmliZXIoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIEBBZnRlcgogICAgcHVibGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBjbGllbnQuY2xvc2UoKTsKICAgICAgICBz\ndXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIC8vIFRlc3QgaW1wbGVtZW50\nYXRpb24gb2YgQ2FsbGJhY2sgZm9yIGFzeW5jIGNsaWVudCBhY3Rpb25zLgog\nICAgc3RhdGljIGNsYXNzIFRlc3RDYWxsYmFjayBpbXBsZW1lbnRzIENhbGxi\nYWNrPFZvaWQ+IHsKICAgICAgICBwcml2YXRlIGZpbmFsIFN5bmNocm9ub3Vz\nUXVldWU8Qm9vbGVhbj4gcXVldWU7CgogICAgICAgIHB1YmxpYyBUZXN0Q2Fs\nbGJhY2soU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBxdWV1ZSkgewogICAg\nICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7CiAgICAgICAgfQoKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25GaW5p\nc2hlZChPYmplY3QgY3R4LCBWb2lkIHJlc3VsdE9mT3BlcmF0aW9uKSB7CiAg\nICAgICAgICAgIG5ldyBUaHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2dlci5pc0Rl\nYnVnRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIu\nZGVidWcoIk9wZXJhdGlvbiBmaW5pc2hlZCEiKTsKICAgICAgICAgICAgICAg\nICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChxdWV1ZSwgdHJ1ZSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnN0YXJ0KCk7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBvcGVy\nYXRpb25GYWlsZWQoT2JqZWN0IGN0eCwgZmluYWwgUHViU3ViRXhjZXB0aW9u\nIGV4Y2VwdGlvbikgewogICAgICAgICAgICBuZXcgVGhyZWFkKG5ldyBSdW5u\nYWJsZSgpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAg\nIGxvZ2dlci5lcnJvcigiT3BlcmF0aW9uIGZhaWxlZCEiLCBleGNlcHRpb24p\nOwogICAgICAgICAgICAgICAgICAgIENvbmN1cnJlbmN5VXRpbHMucHV0KHF1\nZXVlLCBmYWxzZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0p\nLnN0YXJ0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRlc3QgaW1wbGVt\nZW50YXRpb24gb2Ygc3Vic2NyaWJlcidzIG1lc3NhZ2UgaGFuZGxlci4KICAg\nIGNsYXNzIFRlc3RNZXNzYWdlSGFuZGxlciBpbXBsZW1lbnRzIE1lc3NhZ2VI\nYW5kbGVyIHsKICAgICAgICBwcml2YXRlIGZpbmFsIFN5bmNocm9ub3VzUXVl\ndWU8Qm9vbGVhbj4gY29uc3VtZVF1ZXVlOwogICAgICAgIGJvb2xlYW4gZG9B\nZGQgPSBmYWxzZTsKCiAgICAgICAgcHVibGljIFRlc3RNZXNzYWdlSGFuZGxl\ncihTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1bWVRdWV1ZSkgewog\nICAgICAgICAgICB0aGlzLmNvbnN1bWVRdWV1ZSA9IGNvbnN1bWVRdWV1ZTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGRlbGl2ZXIoQnl0ZVN0\ncmluZyB0LCBCeXRlU3RyaW5nIHN1YiwgZmluYWwgTWVzc2FnZSBtc2csIENh\nbGxiYWNrPFZvaWQ+IGNhbGxiYWNrLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAgICAgaWYgKCFkb0Fk\nZCkgewogICAgICAgICAgICAgICAgLy8gYWZ0ZXIgcmVjZWl2aW5nIGZpcnN0\nIG1lc3NhZ2UsIHdlIHNlbmQgYSBwdWJsaXNoCiAgICAgICAgICAgICAgICAv\nLyB0byBvYnRhaW4gcGVybWl0IG9mIHNlY29uZCBsZWRnZXIKICAgICAgICAg\nICAgICAgIGRvQWRkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIG5ldyBUaHJl\nYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAgICAgICAgICAgIEBPdmVy\ncmlkZQogICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHVibGlzaCBtZXNzYWdlcyBh\nZ2FpbiB0byBvYnRhaW4gcGVybWl0cwogICAgICAgICAgICAgICAgICAgICAg\nICBsb2dnZXIuaW5mbygiU3RhcnQgcHVibGlzaGluZyBtZXNzYWdlIHRvIG9i\ndGFpbiBwZXJtaXQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQg\nb2J0YWlucyB0aGUgcGVybWl0IGFuZCB3YWl0IGZvciBhIHJlc3BvbnNlLAog\nICAgICAgICAgICAgICAgICAgICAgICAvLyBidXQgdGhlIHJlc3BvbnNlIGlz\nIGRlbGF5ZWQgYW5kIHJlYWRFbnRyaWVzIGlzIGNhbGxlZAogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBpbiB0aGUgcmVhZENvbXBsZXRlIGNhbGxiYWNr\nIHRvIHJlYWQgZW50cmllcyBvZiB0aGUKICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gc2FtZSBsZWRnZXIuIHNpbmNlIHRoZXJlIGlzIG5vIHBlcm1pdCwg\naXQgYmxvY2tzCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBDb3VudERvd25MYXRjaCBsYXRjaCA9\nIG5ldyBDb3VudERvd25MYXRjaCgxKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHNsZWVwQm9va2llcyg4LCBsYXRjaCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBsYXRjaC5hd2FpdCgpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBxdWV1ZSA9\nIG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8MzsgaSsrKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGlzaGVyLmFzeW5j\nUHVibGlzaCh0b3BpYywgZ2V0TXNnKDk5OTkpLCBuZXcgVGVzdENhbGxiYWNr\nKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8\nMzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKCFxdWV1ZS50YWtlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbG9nZ2VyLmVycm9yKCJFcnJvciBwdWJsaXNoaW5nIHRvIHRv\ncGljIHt9IiwgdG9waWMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChjb25zdW1lUXVldWUsIGZh\nbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkZhaWxlZCB0byBwdWJsaXNoIG1l\nc3NhZ2UgdG8gb2J0YWluIHBlcm1pdC4iKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0pLnN0YXJ0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5ldyBU\naHJlYWQobmV3IFJ1bm5hYmxlKCkgewogICAgICAgICAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAg\nICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQoY29uc3VtZVF1\nZXVlLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSku\nc3RhcnQoKTsKICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmluaXNo\nZWQoY29udGV4dCwgbnVsbCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEhl\nbHBlciBmdW5jdGlvbiB0byBnZW5lcmF0ZSBNZXNzYWdlcwogICAgcHJvdGVj\ndGVkIE1lc3NhZ2UgZ2V0TXNnKGludCBtc2dOdW0pIHsKICAgICAgICByZXR1\ncm4gTWVzc2FnZS5uZXdCdWlsZGVyKCkuc2V0Qm9keShCeXRlU3RyaW5nLmNv\ncHlGcm9tVXRmOCgiTWVzc2FnZSIgKyBtc2dOdW0pKS5idWlsZCgpOwogICAg\nfQoKICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZW5lcmF0ZSBUb3BpY3MK\nICAgIHByb3RlY3RlZCBCeXRlU3RyaW5nIGdldFRvcGljKGludCB0b3BpY051\nbSkgewogICAgICAgIHJldHVybiBCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCgi\nRGVhZExvY2tUb3BpYyIgKyB0b3BpY051bSk7CiAgICB9CgogICAgY2xhc3Mg\nVGVzdFNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5kcyBIdWJTZXJ2ZXJDb25m\naWd1cmF0aW9uIHsKICAgICAgICBwdWJsaWMgVGVzdFNlcnZlckNvbmZpZ3Vy\nYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0KSB7CiAg\nICAgICAgICAgIHN1cGVyKHNlcnZlclBvcnQsIHNzbFNlcnZlclBvcnQpOwog\nICAgICAgIH0KICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50\nIGdldEJrRW5zZW1ibGVTaXplKCkgewogICAgICAgICAgICByZXR1cm4gMTsK\nICAgICAgICB9CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGlu\ndCBnZXRCa1F1b3J1bVNpemUoKSB7CiAgICAgICAgICAgIHJldHVybiAxOwog\nICAgICAgIH0KICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgaW50\nIGdldFJlYWRBaGVhZENvdW50KCkgewogICAgICAgICAgICByZXR1cm4gNDsK\nICAgICAgICB9CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGxv\nbmcgZ2V0TWF4aW11bUNhY2hlU2l6ZSgpIHsKICAgICAgICAgICAgcmV0dXJu\nIDMyOwogICAgICAgIH0KICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygi\nZGVwcmVjYXRpb24iKQogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgU2Vy\ndmVyQ29uZmlndXJhdGlvbiBnZXRTZXJ2ZXJDb25maWd1cmF0aW9uKGludCBz\nZXJ2ZXJQb3J0LCBpbnQgc3NsU2VydmVyUG9ydCkgewogICAgICAgIFNlcnZl\nckNvbmZpZ3VyYXRpb24gc2VydmVyQ29uZiA9IG5ldyBUZXN0U2VydmVyQ29u\nZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0KTsKCiAgICAg\nICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJh\ndGlvbiBia0NsaWVudENvbmYgPQogICAgICAgICAgICBuZXcgb3JnLmFwYWNo\nZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbigpOwogICAg\nICAgIGJrQ2xpZW50Q29uZi5zZXROdW1Xb3JrZXJUaHJlYWRzKDEpLnNldFJl\nYWRUaW1lb3V0KDk5OTkpCiAgICAgICAgICAgICAgICAgICAgLnNldFRocm90\ndGxlVmFsdWUoMyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2VydmVy\nQ29uZi5hZGRDb25mKGJrQ2xpZW50Q29uZik7CiAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlcnZl\nckNvbmY7CiAgICB9CgogICAgQFRlc3QodGltZW91dD02MDAwMCkKICAgIHB1\nYmxpYyB2b2lkIHRlc3REZWFkbG9jaygpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGludCBudW1NZXNzYWdlcyA9IDU7CgogICAgICAgIFN5bmNocm9u\nb3VzUXVldWU8Qm9vbGVhbj4gY29uc3VtZVF1ZXVlID0gbmV3IFN5bmNocm9u\nb3VzUXVldWU8Qm9vbGVhbj4oKTsKCiAgICAgICAgLy8gc3Vic2NyaWJlIHRv\nIHRvcGljCiAgICAgICAgbG9nZ2VyLmluZm8oIlNldHVwIHN1YnNjcmlwdGlv\nbnMiKTsKICAgICAgICBzdWJzY3JpYmVyLnN1YnNjcmliZSh0b3BpYywgc3Vi\nc2NyaWJlcklkLCBDcmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKTsK\nICAgICAgICBzdWJzY3JpYmVyLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBz\ndWJzY3JpYmVySWQpOwoKICAgICAgICAvLyBwdWJsaXNoIDUgbWVzc2FnZXMg\ndG8gZm9ybSBmaXJzdCBsZWRnZXIKICAgICAgICBmb3IgKGludCBpPTA7IGk8\nbnVtTWVzc2FnZXM7IGkrKykgewogICAgICAgICAgICBsb2dnZXIuaW5mbygi\nU3RhcnQgcHVibGlzaGluZyBtZXNzYWdlIHt9IiwgaSk7CiAgICAgICAgICAg\nIHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljLCBnZXRNc2coaSkpOwogICAgICAg\nIH0KCiAgICAgICAgc3RvcEh1YlNlcnZlcnMoKTsKICAgICAgICBUaHJlYWQu\nc2xlZXAoMTAwMCk7CiAgICAgICAgc3RhcnRIdWJTZXJ2ZXJzKCk7CgogICAg\nICAgIGxvZ2dlci5pbmZvKCJTdGFydCBwdWJsaXNoaW5nIG1lc3NhZ2VzIik7\nCiAgICAgICAgLy8gcHVibGlzaCBlbm91Z2ggbWVzc2FnZXMgdG8gc2Vjb25k\nIGxlZGdlcgogICAgICAgIC8vIHNvIGEgc2NhbiByZXF1ZXN0IG5lZWQgdG8g\nc2NhbiBvdmVyIHR3byBsZWRnZXJzLCB3aGljaAogICAgICAgIC8vIGNhdXNl\nIHJlYWRFbnRyaWVzIGV4ZWN1dGVkIGluIHRoZSBwcmV2aW91cyByZWFkRW50\ncmllcwogICAgICAgIGZvciAoaW50IGk9MDsgaTxudW1NZXNzYWdlczsgaSsr\nKSB7CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJTdGFydCBwdWJsaXNoaW5n\nIG1lc3NhZ2Uge30iLCBpKzUpOwogICAgICAgICAgICBwdWJsaXNoZXIucHVi\nbGlzaCh0b3BpYywgZ2V0TXNnKGkpKTsKICAgICAgICB9CgogICAgICAgIGxv\nZ2dlci5pbmZvKCJTdGFydCBzdWJzY3JpYmUgdG9waWNzIGFnYWluIGFuZCBy\nZWNlaXZlIG1lc3NhZ2VzIik7CiAgICAgICAgLy8gc3Vic2NyaWJlIHRvIHRv\ncGljCiAgICAgICAgc3Vic2NyaWJlci5zdWJzY3JpYmUodG9waWMsIHN1YnNj\ncmliZXJJZCwgQ3JlYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCk7CiAg\nICAgICAgc3Vic2NyaWJlci5zdGFydERlbGl2ZXJ5KHRvcGljLCBzdWJzY3Jp\nYmVySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBU\nZXN0TWVzc2FnZUhhbmRsZXIoY29uc3VtZVF1ZXVlKSk7CiAgICAgICAgZm9y\nIChpbnQgaT0wOyBpPCgyKm51bU1lc3NhZ2VzKzMpOyBpKyspIHsKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgc2xlZXBCb29raWVzKGZp\nbmFsIGludCBzZWNvbmRzLCBmaW5hbCBDb3VudERvd25MYXRjaCBsKQogICAg\nICAgICAgICB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24sIElPRXhjZXB0\naW9uIHsKICAgICAgICBUaHJlYWQgc2xlZXBlciA9IG5ldyBUaHJlYWQoKSB7\nCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgYmt0\nYi5zdXNwZW5kQWxsQm9va2llU2VydmVycygpOwogICAgICAgICAgICAgICAg\nICAgICAgICBsLmNvdW50RG93bigpOwogICAgICAgICAgICAgICAgICAgICAg\nICBUaHJlYWQuc2xlZXAoc2Vjb25kcyAqIDEwMDApOwogICAgICAgICAgICAg\nICAgICAgICAgICBia3RiLnJlc3VtZUFsbEJvb2tpZVNlcnZlcnMoKTsKICAg\nICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIHN1c3Bl\nbmRpbmcgdGhyZWFkIiwgZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIHNsZWVwZXIu\nc3RhcnQoKTsKICAgIH0KfQo=\n","encoding":"base64"}

