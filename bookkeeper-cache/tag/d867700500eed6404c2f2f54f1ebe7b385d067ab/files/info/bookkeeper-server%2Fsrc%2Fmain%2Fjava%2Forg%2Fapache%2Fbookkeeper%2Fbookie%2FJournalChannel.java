{"sha":"8f4deec236052782297bd58d887060426e15ed28","node_id":"MDQ6QmxvYjE1NzU5NTY6OGY0ZGVlYzIzNjA1Mjc4MjI5N2JkNThkODg3MDYwNDI2ZTE1ZWQyOA==","size":5124,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8f4deec236052782297bd58d887060426e15ed28","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5czsKCmltcG9ydCBqYXZhLmlvLkNsb3Nl\nYWJsZTsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uUmFu\nZG9tQWNjZXNzRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLm5pby5jaGFubmVscy5GaWxlQ2hhbm5lbDsKaW1wb3J0IGph\ndmEubmlvLkJ5dGVCdWZmZXI7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsK\naW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIFNpbXBs\nZSB3cmFwcGVyIGFyb3VuZCBGaWxlQ2hhbm5lbCB0byBhZGQgdmVyc2lvbmlu\nZwogKiBpbmZvcm1hdGlvbiB0byB0aGUgZmlsZS4KICovCmNsYXNzIEpvdXJu\nYWxDaGFubmVsIGltcGxlbWVudHMgQ2xvc2VhYmxlIHsKICAgIHN0YXRpYyBM\nb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSm91cm5hbENo\nYW5uZWwuY2xhc3MpOwoKICAgIGZpbmFsIEZpbGVDaGFubmVsIGZjOwogICAg\nZmluYWwgQnVmZmVyZWRDaGFubmVsIGJjOwogICAgZmluYWwgaW50IGZvcm1h\ndFZlcnNpb247CiAgICBsb25nIG5leHRQcmVhbGxvYyA9IDA7CgogICAgZmlu\nYWwgYnl0ZVtdIE1BR0lDX1dPUkQgPSAiQktMRyIuZ2V0Qnl0ZXMoKTsKCiAg\nICBwcml2YXRlIGZpbmFsIHN0YXRpYyBpbnQgU1RBUlRfT0ZfRklMRSA9IC0x\nMjM0NTsKCiAgICBpbnQgSEVBREVSX1NJWkUgPSA4OyAvLyA0Ynl0ZSBtYWdp\nYyB3b3JkLCA0IGJ5dGUgdmVyc2lvbgogICAgaW50IE1JTl9DT01QQVRfSk9V\nUk5BTF9GT1JNQVRfVkVSU0lPTiA9IDE7CiAgICBpbnQgQ1VSUkVOVF9KT1VS\nTkFMX0ZPUk1BVF9WRVJTSU9OID0gMzsKCiAgICBwdWJsaWMgZmluYWwgc3Rh\ndGljIGxvbmcgcHJlQWxsb2NTaXplID0gNCoxMDI0KjEwMjQ7CiAgICBwdWJs\naWMgZmluYWwgc3RhdGljIEJ5dGVCdWZmZXIgemVyb3MgPSBCeXRlQnVmZmVy\nLmFsbG9jYXRlKDUxMik7CgogICAgSm91cm5hbENoYW5uZWwoRmlsZSBqb3Vy\nbmFsRGlyZWN0b3J5LCBsb25nIGxvZ0lkKSB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgIHRoaXMoam91cm5hbERpcmVjdG9yeSwgbG9nSWQsIFNUQVJU\nX09GX0ZJTEUpOwogICAgfQoKICAgIEpvdXJuYWxDaGFubmVsKEZpbGUgam91\ncm5hbERpcmVjdG9yeSwgbG9uZyBsb2dJZCwgbG9uZyBwb3NpdGlvbikgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBGaWxlIGZuID0gbmV3IEZpbGUo\nam91cm5hbERpcmVjdG9yeSwgTG9uZy50b0hleFN0cmluZyhsb2dJZCkgKyAi\nLnR4biIpOwoKICAgICAgICBMT0cuaW5mbygiT3BlbmluZyBqb3VybmFsIHt9\nIiwgZm4pOwogICAgICAgIGlmICghZm4uZXhpc3RzKCkpIHsgLy8gbmV3IGZp\nbGUsIHdyaXRlIHZlcnNpb24KICAgICAgICAgICAgZmMgPSBuZXcgUmFuZG9t\nQWNjZXNzRmlsZShmbiwgInJ3IikuZ2V0Q2hhbm5lbCgpOwogICAgICAgICAg\nICBmb3JtYXRWZXJzaW9uID0gQ1VSUkVOVF9KT1VSTkFMX0ZPUk1BVF9WRVJT\nSU9OOwoKICAgICAgICAgICAgQnl0ZUJ1ZmZlciBiYiA9IEJ5dGVCdWZmZXIu\nYWxsb2NhdGUoSEVBREVSX1NJWkUpOwogICAgICAgICAgICBiYi5wdXQoTUFH\nSUNfV09SRCk7CiAgICAgICAgICAgIGJiLnB1dEludChmb3JtYXRWZXJzaW9u\nKTsKICAgICAgICAgICAgYmIuZmxpcCgpOwogICAgICAgICAgICBmYy53cml0\nZShiYik7CiAgICAgICAgICAgIGZjLmZvcmNlKHRydWUpOwoKICAgICAgICAg\nICAgYmMgPSBuZXcgQnVmZmVyZWRDaGFubmVsKGZjLCA2NTUzNik7CgogICAg\nICAgICAgICBuZXh0UHJlYWxsb2MgPSBwcmVBbGxvY1NpemU7CiAgICAgICAg\nICAgIGZjLndyaXRlKHplcm9zLCBuZXh0UHJlYWxsb2MpOwogICAgICAgIH0g\nZWxzZSB7ICAvLyBvcGVuIGFuIGV4aXN0aW5nIGZpbGUKICAgICAgICAgICAg\nZmMgPSBuZXcgUmFuZG9tQWNjZXNzRmlsZShmbiwgInIiKS5nZXRDaGFubmVs\nKCk7CiAgICAgICAgICAgIGJjID0gbnVsbDsgLy8gcmVhZG9ubHkKCiAgICAg\nICAgICAgIEJ5dGVCdWZmZXIgYmIgPSBCeXRlQnVmZmVyLmFsbG9jYXRlKEhF\nQURFUl9TSVpFKTsKICAgICAgICAgICAgaW50IGMgPSBmYy5yZWFkKGJiKTsK\nICAgICAgICAgICAgYmIuZmxpcCgpOwoKICAgICAgICAgICAgaWYgKGMgPT0g\nSEVBREVSX1NJWkUpIHsKICAgICAgICAgICAgICAgIGJ5dGVbXSBmaXJzdDQg\nPSBuZXcgYnl0ZVs0XTsKICAgICAgICAgICAgICAgIGJiLmdldChmaXJzdDQp\nOwoKICAgICAgICAgICAgICAgIGlmIChBcnJheXMuZXF1YWxzKGZpcnN0NCwg\nTUFHSUNfV09SRCkpIHsKICAgICAgICAgICAgICAgICAgICBmb3JtYXRWZXJz\naW9uID0gYmIuZ2V0SW50KCk7CiAgICAgICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgICAgIC8vIHByZSBtYWdpYyB3b3JkIGpvdXJuYWws\nIHJlc2V0IHRvIDA7CiAgICAgICAgICAgICAgICAgICAgZm9ybWF0VmVyc2lv\nbiA9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAvLyBubyBoZWFkZXIsIG11c3QgYmUgb2xkIHZl\ncnNpb24KICAgICAgICAgICAgICAgIGZvcm1hdFZlcnNpb24gPSAxOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBpZiAoZm9ybWF0VmVyc2lvbiA8IE1J\nTl9DT01QQVRfSk9VUk5BTF9GT1JNQVRfVkVSU0lPTgogICAgICAgICAgICAg\nICAgfHwgZm9ybWF0VmVyc2lvbiA+IENVUlJFTlRfSk9VUk5BTF9GT1JNQVRf\nVkVSU0lPTikgewogICAgICAgICAgICAgICAgU3RyaW5nIGVyciA9IFN0cmlu\nZy5mb3JtYXQoIkludmFsaWQgam91cm5hbCB2ZXJzaW9uLCB1bmFibGUgdG8g\ncmVhZC4iCiAgICAgICAgICAgICAgICAgICAgICAgICsgIiBFeHBlY3RlZCBi\nZXR3ZWVuICglZCkgYW5kICglZCksIGdvdCAoJWQpIiwKICAgICAgICAgICAg\nICAgICAgICAgICAgTUlOX0NPTVBBVF9KT1VSTkFMX0ZPUk1BVF9WRVJTSU9O\nLCBDVVJSRU5UX0pPVVJOQUxfRk9STUFUX1ZFUlNJT04sCiAgICAgICAgICAg\nICAgICAgICAgICAgIGZvcm1hdFZlcnNpb24pOwogICAgICAgICAgICAgICAg\nTE9HLmVycm9yKGVycik7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSU9F\neGNlcHRpb24oZXJyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbiA9PSBTVEFSVF9PRl9G\nSUxFKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdFZlcnNpb24g\nPj0gMikgewogICAgICAgICAgICAgICAgICAgICAgICBmYy5wb3NpdGlvbihI\nRUFERVJfU0laRSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgZmMucG9zaXRpb24oMCk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICBmYy5wb3NpdGlvbihwb3NpdGlvbik7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIExPRy5lcnJvcigiQm9va2llIGpvdXJuYWwg\nZmlsZSBjYW4gc2VlayB0byBwb3NpdGlvbiA6IiwgZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgaW50IGdldEZvcm1hdFZlcnNpb24o\nKSB7CiAgICAgICAgcmV0dXJuIGZvcm1hdFZlcnNpb247CiAgICB9CgogICAg\nQnVmZmVyZWRDaGFubmVsIGdldEJ1ZmZlcmVkQ2hhbm5lbCgpIHRocm93cyBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGJjID09IG51bGwpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJSZWFkIG9ubHkgam91cm5h\nbCBjaGFubmVsIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiYzsKICAg\nIH0KCiAgICB2b2lkIHByZUFsbG9jSWZOZWVkZWQoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIGlmIChiYy5wb3NpdGlvbigpID4gbmV4dFByZWFs\nbG9jKSB7CiAgICAgICAgICAgIG5leHRQcmVhbGxvYyA9ICgoZmMuc2l6ZSgp\nICsgSEVBREVSX1NJWkUpIC8gcHJlQWxsb2NTaXplICsgMSkgKiBwcmVBbGxv\nY1NpemU7CiAgICAgICAgICAgIHplcm9zLmNsZWFyKCk7CiAgICAgICAgICAg\nIGZjLndyaXRlKHplcm9zLCBuZXh0UHJlYWxsb2MpOwogICAgICAgIH0KICAg\nIH0KCiAgICBpbnQgcmVhZChCeXRlQnVmZmVyIGRzdCkKICAgICAgICAgICAg\ndGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gZmMucmVhZChk\nc3QpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICBmYy5jbG9zZSgpOwogICAgfQp9\n","encoding":"base64"}

