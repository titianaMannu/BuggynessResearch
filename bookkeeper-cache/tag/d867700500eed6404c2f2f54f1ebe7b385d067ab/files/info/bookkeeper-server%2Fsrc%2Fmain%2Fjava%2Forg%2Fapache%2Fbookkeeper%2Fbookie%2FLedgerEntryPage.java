{"sha":"8395a2f776feadd87652fcad8b2e59d0b64190de","node_id":"MDQ6QmxvYjE1NzU5NTY6ODM5NWEyZjc3NmZlYWRkODc2NTJmY2FkOGIyZTU5ZDBiNjQxOTBkZQ==","size":4935,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8395a2f776feadd87652fcad8b2e59d0b64190de","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmlvLkJ5\ndGVCdWZmZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3Rv\nLkJvb2tpZVByb3RvY29sOwoKLyoqCiAqIFRoaXMgaXMgYSBwYWdlIGluIHRo\nZSBMZWRnZXJDYWNoZS4gSXQgaG9sZHMgdGhlIGxvY2F0aW9ucwogKiAoZW50\ncnlsb2dmaWxlLCBvZmZzZXQpIGZvciBlbnRyeSBpZHMuCiAqLwpwdWJsaWMg\nY2xhc3MgTGVkZ2VyRW50cnlQYWdlIHsKICAgIHByaXZhdGUgZmluYWwgaW50\nIHBhZ2VTaXplOwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgZW50cmllc1BlclBh\nZ2U7CiAgICBwcml2YXRlIGxvbmcgbGVkZ2VyID0gLTE7CiAgICBwcml2YXRl\nIGxvbmcgZmlyc3RFbnRyeSA9IEJvb2tpZVByb3RvY29sLklOVkFMSURfRU5U\nUllfSUQ7CiAgICBwcml2YXRlIGZpbmFsIEJ5dGVCdWZmZXIgcGFnZTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBjbGVhbiA9IHRydWU7CiAgICBwcml2YXRlIGJv\nb2xlYW4gcGlubmVkID0gZmFsc2U7CiAgICBwcml2YXRlIGludCB1c2VDb3Vu\ndDsKICAgIHByaXZhdGUgaW50IHZlcnNpb247CgogICAgcHVibGljIExlZGdl\nckVudHJ5UGFnZShpbnQgcGFnZVNpemUsIGludCBlbnRyaWVzUGVyUGFnZSkg\newogICAgICAgIHRoaXMucGFnZVNpemUgPSBwYWdlU2l6ZTsKICAgICAgICB0\naGlzLmVudHJpZXNQZXJQYWdlID0gZW50cmllc1BlclBhZ2U7CiAgICAgICAg\ncGFnZSA9IEJ5dGVCdWZmZXIuYWxsb2NhdGVEaXJlY3QocGFnZVNpemUpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyB0b1N0cmlu\nZygpIHsKICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1\naWxkZXIoKTsKICAgICAgICBzYi5hcHBlbmQoZ2V0TGVkZ2VyKCkpOwogICAg\nICAgIHNiLmFwcGVuZCgnQCcpOwogICAgICAgIHNiLmFwcGVuZChnZXRGaXJz\ndEVudHJ5KCkpOwogICAgICAgIHNiLmFwcGVuZChjbGVhbiA/ICIgY2xlYW4g\nIiA6ICIgZGlydHkgIik7CiAgICAgICAgc2IuYXBwZW5kKHVzZUNvdW50KTsK\nICAgICAgICByZXR1cm4gc2IudG9TdHJpbmcoKTsKICAgIH0KICAgIHN5bmNo\ncm9uaXplZCBwdWJsaWMgdm9pZCB1c2VQYWdlKCkgewogICAgICAgIHVzZUNv\ndW50Kys7CiAgICB9CiAgICBzeW5jaHJvbml6ZWQgcHVibGljIHZvaWQgcGlu\nKCkgewogICAgICAgIHBpbm5lZCA9IHRydWU7CiAgICB9CiAgICBzeW5jaHJv\nbml6ZWQgcHVibGljIHZvaWQgdW5waW4oKSB7CiAgICAgICAgcGlubmVkID0g\nZmFsc2U7CiAgICB9CiAgICBzeW5jaHJvbml6ZWQgcHVibGljIGJvb2xlYW4g\naXNQaW5uZWQoKSB7CiAgICAgICAgcmV0dXJuIHBpbm5lZDsKICAgIH0KICAg\nIHN5bmNocm9uaXplZCBwdWJsaWMgdm9pZCByZWxlYXNlUGFnZSgpIHsKICAg\nICAgICB1c2VDb3VudC0tOwogICAgICAgIGlmICh1c2VDb3VudCA8IDApIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigi\nVXNlIGNvdW50IGhhcyBnb25lIGJlbG93IDAiKTsKICAgICAgICB9CiAgICB9\nCiAgICBzeW5jaHJvbml6ZWQgcHJpdmF0ZSB2b2lkIGNoZWNrUGFnZSgpIHsK\nICAgICAgICBpZiAodXNlQ291bnQgPD0gMCkgewogICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCJQYWdlIG5vdCBtYXJrZWQg\naW4gdXNlIik7CiAgICAgICAgfQogICAgfQogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7CiAgICAgICAg\naWYgKG90aGVyIGluc3RhbmNlb2YgTGVkZ2VyRW50cnlQYWdlKSB7CiAgICAg\nICAgICAgIExlZGdlckVudHJ5UGFnZSBvdGhlckxFUCA9IChMZWRnZXJFbnRy\neVBhZ2UpIG90aGVyOwogICAgICAgICAgICByZXR1cm4gb3RoZXJMRVAuZ2V0\nTGVkZ2VyKCkgPT0gZ2V0TGVkZ2VyKCkgJiYgb3RoZXJMRVAuZ2V0Rmlyc3RF\nbnRyeSgpID09IGdldEZpcnN0RW50cnkoKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAg\nIHJldHVybiAoaW50KWdldExlZGdlcigpIF4gKGludCkoZ2V0Rmlyc3RFbnRy\neSgpKTsKICAgIH0KICAgIHZvaWQgc2V0Q2xlYW4oaW50IHZlcnNpb25PZkNs\nZWFuaW5nKSB7CiAgICAgICAgdGhpcy5jbGVhbiA9ICh2ZXJzaW9uT2ZDbGVh\nbmluZyA9PSB2ZXJzaW9uKTsKICAgIH0KICAgIGJvb2xlYW4gaXNDbGVhbigp\nIHsKICAgICAgICByZXR1cm4gY2xlYW47CiAgICB9CiAgICBwdWJsaWMgdm9p\nZCBzZXRPZmZzZXQobG9uZyBvZmZzZXQsIGludCBwb3NpdGlvbikgewogICAg\nICAgIGNoZWNrUGFnZSgpOwogICAgICAgIHZlcnNpb24rKzsKICAgICAgICB0\naGlzLmNsZWFuID0gZmFsc2U7CiAgICAgICAgcGFnZS5wdXRMb25nKHBvc2l0\naW9uLCBvZmZzZXQpOwogICAgfQogICAgcHVibGljIGxvbmcgZ2V0T2Zmc2V0\nKGludCBwb3NpdGlvbikgewogICAgICAgIGNoZWNrUGFnZSgpOwogICAgICAg\nIHJldHVybiBwYWdlLmdldExvbmcocG9zaXRpb24pOwogICAgfQogICAgc3Rh\ndGljIGZpbmFsIGJ5dGUgemVyb1BhZ2VbXSA9IG5ldyBieXRlWzY0KjEwMjRd\nOwogICAgcHVibGljIHZvaWQgemVyb1BhZ2UoKSB7CiAgICAgICAgY2hlY2tQ\nYWdlKCk7CiAgICAgICAgcGFnZS5jbGVhcigpOwogICAgICAgIHBhZ2UucHV0\nKHplcm9QYWdlLCAwLCBwYWdlLnJlbWFpbmluZygpKTsKICAgICAgICBjbGVh\nbiA9IHRydWU7CiAgICB9CiAgICBwdWJsaWMgdm9pZCByZWFkUGFnZShGaWxl\nSW5mbyBmaSkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBjaGVja1Bh\nZ2UoKTsKICAgICAgICBwYWdlLmNsZWFyKCk7CiAgICAgICAgd2hpbGUocGFn\nZS5yZW1haW5pbmcoKSAhPSAwKSB7CiAgICAgICAgICAgIGlmIChmaS5yZWFk\nKHBhZ2UsIGdldEZpcnN0RW50cnkoKSo4KSA8PSAwKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIlNob3J0IHBhZ2UgcmVhZCBv\nZiBsZWRnZXIgIiArIGdldExlZGdlcigpICsgIiB0cmllZCB0byBnZXQgIiAr\nIHBhZ2UuY2FwYWNpdHkoKSArICIgZnJvbSBwb3NpdGlvbiAiICsgZ2V0Rmly\nc3RFbnRyeSgpKjggKyAiIHN0aWxsIG5lZWQgIiArIHBhZ2UucmVtYWluaW5n\nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNsZWFuID0g\ndHJ1ZTsKICAgIH0KICAgIHB1YmxpYyBCeXRlQnVmZmVyIGdldFBhZ2VUb1dy\naXRlKCkgewogICAgICAgIGNoZWNrUGFnZSgpOwogICAgICAgIHBhZ2UuY2xl\nYXIoKTsKICAgICAgICByZXR1cm4gcGFnZTsKICAgIH0KICAgIHZvaWQgc2V0\nTGVkZ2VyKGxvbmcgbGVkZ2VyKSB7CiAgICAgICAgdGhpcy5sZWRnZXIgPSBs\nZWRnZXI7CiAgICB9CiAgICBsb25nIGdldExlZGdlcigpIHsKICAgICAgICBy\nZXR1cm4gbGVkZ2VyOwogICAgfQogICAgaW50IGdldFZlcnNpb24oKSB7CiAg\nICAgICAgcmV0dXJuIHZlcnNpb247CiAgICB9CiAgICB2b2lkIHNldEZpcnN0\nRW50cnkobG9uZyBmaXJzdEVudHJ5KSB7CiAgICAgICAgaWYgKGZpcnN0RW50\ncnkgJSBlbnRyaWVzUGVyUGFnZSAhPSAwKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oZmlyc3RFbnRyeSArICIg\naXMgbm90IGEgbXVsdGlwbGUgb2YgIiArIGVudHJpZXNQZXJQYWdlKTsKICAg\nICAgICB9CiAgICAgICAgdGhpcy5maXJzdEVudHJ5ID0gZmlyc3RFbnRyeTsK\nICAgIH0KICAgIGxvbmcgZ2V0Rmlyc3RFbnRyeSgpIHsKICAgICAgICByZXR1\ncm4gZmlyc3RFbnRyeTsKICAgIH0KICAgIHB1YmxpYyBib29sZWFuIGluVXNl\nKCkgewogICAgICAgIHJldHVybiB1c2VDb3VudCA+IDA7CiAgICB9CiAgICBw\ndWJsaWMgbG9uZyBnZXRMYXN0RW50cnkoKSB7CiAgICAgICAgZm9yKGludCBp\nID0gZW50cmllc1BlclBhZ2UgLSAxOyBpID49IDA7IGktLSkgewogICAgICAg\nICAgICBpZiAoZ2V0T2Zmc2V0KGkqOCkgPiAwKSB7CiAgICAgICAgICAgICAg\nICByZXR1cm4gaSArIGZpcnN0RW50cnk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9Cn0K\n","encoding":"base64"}

