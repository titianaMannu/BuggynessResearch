{"sha":"fd879ed8feb3596d99bb1d1890b64b6255650d22","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmQ4NzllZDhmZWIzNTk2ZDk5YmIxZDE4OTBiNjRiNjI1NTY1MGQyMg==","size":20780,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fd879ed8feb3596d99bb1d1890b64b6255650d22","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkV4ZWN1dG9yczsKCmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5Db3VudERvd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJy\nZW50LlRpbWVVbml0OwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5t\nZXRhLkxlZGdlck1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIubWV0YS5MZWRnZXJNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jb25mLkNsaWVudENvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2su\nQ3JlYXRlQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkFzeW5jQ2FsbGJhY2suRGVsZXRlQ2FsbGJhY2s7CmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suT3Bl\nbkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVu\ndC5CS0V4Y2VwdGlvbi5Db2RlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLnByb3RvLkJvb2tpZUNsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci51dGlsLk9yZGVyZWRTYWZlRXhlY3V0b3I7CmltcG9ydCBvcmcu\nc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVkRXZlbnQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVyOwppbXBvcnQgb3JnLmpib3Nz\nLm5ldHR5LmNoYW5uZWwuc29ja2V0LkNsaWVudFNvY2tldENoYW5uZWxGYWN0\nb3J5OwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuc29ja2V0Lm5p\nby5OaW9DbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUuYm9va2tlZXBlci51dGlsLlNhZmVSdW5uYWJsZTsKCi8qKgogKiBC\nb29rS2VlcGVyIGNsaWVudC4gV2UgYXNzdW1lIHRoZXJlIGlzIG9uZSBzaW5n\nbGUgd3JpdGVyIHRvIGEgbGVkZ2VyIGF0IGFueQogKiB0aW1lLgogKgogKiBU\naGVyZSBhcmUgZm91ciBwb3NzaWJsZSBvcGVyYXRpb25zOiBzdGFydCBhIG5l\ndyBsZWRnZXIsIHdyaXRlIHRvIGEgbGVkZ2VyLAogKiByZWFkIGZyb20gYSBs\nZWRnZXIgYW5kIGRlbGV0ZSBhIGxlZGdlci4KICoKICogVGhlIGV4Y2VwdGlv\nbnMgcmVzdWx0aW5nIGZyb20gc3luY2hyb25vdXMgY2FsbHMgYW5kIGVycm9y\nIGNvZGUgcmVzdWx0aW5nIGZyb20KICogYXN5bmNocm9ub3VzIGNhbGxzIGNh\nbiBiZSBmb3VuZCBpbiB0aGUgY2xhc3Mge0BsaW5rIEJLRXhjZXB0aW9ufS4K\nICoKICoKICovCgpwdWJsaWMgY2xhc3MgQm9va0tlZXBlciB7CgogICAgc3Rh\ndGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dl\ncihCb29rS2VlcGVyLmNsYXNzKTsKCiAgICBmaW5hbCBab29LZWVwZXIgems7\nCiAgICBmaW5hbCBDb3VudERvd25MYXRjaCBjb25uZWN0TGF0Y2ggPSBuZXcg\nQ291bnREb3duTGF0Y2goMSk7CiAgICBmaW5hbCBzdGF0aWMgaW50IHprQ29u\nbmVjdFRpbWVvdXRNcyA9IDUwMDA7CiAgICBmaW5hbCBDbGllbnRTb2NrZXRD\naGFubmVsRmFjdG9yeSBjaGFubmVsRmFjdG9yeTsKCiAgICAvLyB3aGV0aGVy\nIHRoZSBzb2NrZXQgZmFjdG9yeSBpcyBvbmUgd2UgY3JlYXRlZCwgb3IgaXMg\nb3duZWQgYnkgd2hvZXZlcgogICAgLy8gaW5zdGFudGlhdGVkIHVzCiAgICBi\nb29sZWFuIG93bkNoYW5uZWxGYWN0b3J5ID0gZmFsc2U7CiAgICAvLyB3aGV0\naGVyIHRoZSB6ayBoYW5kbGUgaXMgb25lIHdlIGNyZWF0ZWQsIG9yIGlzIG93\nbmVkIGJ5IHdob2V2ZXIKICAgIC8vIGluc3RhbnRpYXRlZCB1cwogICAgYm9v\nbGVhbiBvd25aS0hhbmRsZSA9IGZhbHNlOwoKICAgIGZpbmFsIEJvb2tpZUNs\naWVudCBib29raWVDbGllbnQ7CiAgICBmaW5hbCBCb29raWVXYXRjaGVyIGJv\nb2tpZVdhdGNoZXI7CgogICAgZmluYWwgT3JkZXJlZFNhZmVFeGVjdXRvciBt\nYWluV29ya2VyUG9vbDsKCiAgICAvLyBMZWRnZXIgbWFuYWdlciByZXNwb25z\naWJsZSBmb3IgaG93IHRvIHN0b3JlIGxlZGdlciBtZXRhIGRhdGEKICAgIGZp\nbmFsIExlZGdlck1hbmFnZXIgbGVkZ2VyTWFuYWdlcjsKCiAgICBmaW5hbCBD\nbGllbnRDb25maWd1cmF0aW9uIGNvbmY7CgogICAgaW50ZXJmYWNlIFpLQ29u\nbmVjdENhbGxiYWNrIHsKICAgICAgICBwdWJsaWMgdm9pZCBjb25uZWN0ZWQo\nKTsKICAgICAgICBwdWJsaWMgdm9pZCBjb25uZWN0aW9uRmFpbGVkKGludCBj\nb2RlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIGJvb2trZWVw\nZXIgY2xpZW50LiBBIHpvb2tlZXBlciBjbGllbnQgYW5kIGEgY2xpZW50IHNv\nY2tldCBmYWN0b3J5CiAgICAgKiB3aWxsIGJlIGluc3RhbnRpYXRlZCBhcyBw\nYXJ0IG9mIHRoaXMgY29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBhcmFt\nIHNlcnZlcnMKICAgICAqICAgICAgICAgIEEgbGlzdCBvZiBvbmUgb2YgbW9y\nZSBzZXJ2ZXJzIG9uIHdoaWNoIHpvb2tlZXBlciBpcyBydW5uaW5nLiBUaGUK\nICAgICAqICAgICAgICAgIGNsaWVudCBhc3N1bWVzIHRoYXQgdGhlIHJ1bm5p\nbmcgYm9va2llcyBoYXZlIGJlZW4gcmVnaXN0ZXJlZCB3aXRoCiAgICAgKiAg\nICAgICAgICB6b29rZWVwZXIgdW5kZXIgdGhlIHBhdGgKICAgICAqICAgICAg\nICAgIHtAbGluayBCb29raWVXYXRjaGVyI2Jvb2tpZVJlZ2lzdHJhdGlvblBh\ndGh9CiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dz\nIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIEtlZXBlckV4\nY2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgQm9va0tlZXBlcihTdHJpbmcg\nc2VydmVycykgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiwKICAgICAgICBLZWVwZXJFeGNlcHRpb24gewogICAgICAgIHRoaXMo\nbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKS5zZXRaa1NlcnZlcnMoc2VydmVy\ncykpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgYm9va2tlZXBl\nciBjbGllbnQgdXNpbmcgYSBjb25maWd1cmF0aW9uIG9iamVjdC4KICAgICAq\nIEEgem9va2VlcGVyIGNsaWVudCBhbmQgYSBjbGllbnQgc29ja2V0IGZhY3Rv\ncnkgd2lsbCBiZSAKICAgICAqIGluc3RhbnRpYXRlZCBhcyBwYXJ0IG9mIHRo\naXMgY29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIGNvbmYKICAg\nICAqICAgICAgICAgIENsaWVudCBDb25maWd1cmF0aW9uIG9iamVjdAogICAg\nICogQHRocm93cyBJT0V4Y2VwdGlvbgogICAgICogQHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBLZWVwZXJFeGNlcHRpb24K\nICAgICAqLwogICAgcHVibGljIEJvb2tLZWVwZXIoZmluYWwgQ2xpZW50Q29u\nZmlndXJhdGlvbiBjb25mKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24sIEludGVycnVwdGVkRXhjZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24gewog\nICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CgogICAgICAgIGZpbmFsIENvdW50\nRG93bkxhdGNoIHprQ29ubmVjdExhdGNoID0gbmV3IENvdW50RG93bkxhdGNo\nKDEpOwogICAgICAgIHRoaXMuemsgPSBuZXcgWm9vS2VlcGVyKGNvbmYuZ2V0\nWmtTZXJ2ZXJzKCksIGNvbmYuZ2V0WmtUaW1lb3V0KCksCiAgICAgICAgICAg\nICAgICBuZXcgV2F0Y2hlcigpIHsKICAgICAgICAgICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNz\nKFdhdGNoZWRFdmVudCBldmVudCkgewogICAgICAgICAgICAgICAgICAgICAg\nICAvLyBjb3VudGRvd24gdGhlIGxhdGNoIG9uIGFsbCBldmVudHMsIGV2ZW4g\naWYgd2UgaGF2ZW4ndAogICAgICAgICAgICAgICAgICAgICAgICAvLyBzdWNj\nZXNzZnVsbHkgY29ubmVjdGVkLgogICAgICAgICAgICAgICAgICAgICAgICB6\na0Nvbm5lY3RMYXRjaC5jb3VudERvd24oKTsKCiAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIFRPRE86IGhhbmRsZSBzZXNzaW9uIGRpc2Nvbm5lY3RzIGFu\nZCBleHBpcmVzCiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1Zygi\nUHJvY2Vzczoge30ge30iLCBldmVudC5nZXRUeXBlKCksIGV2ZW50LmdldFBh\ndGgoKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfSk7CiAgICAgICAgaWYgKCF6a0Nvbm5lY3RMYXRjaC5hd2FpdChjb25mLmdl\ndFprVGltZW91dCgpLCBUaW1lVW5pdC5NSUxMSVNFQ09ORFMpCiAgICAgICAg\nICAgIHx8ICF6ay5nZXRTdGF0ZSgpLmlzQ29ubmVjdGVkKCkpIHsKICAgICAg\nICAgICAgdGhyb3cgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNl\ncHRpb24uQ29kZS5DT05ORUNUSU9OTE9TUyk7CiAgICAgICAgfQoKICAgICAg\nICB0aGlzLmNoYW5uZWxGYWN0b3J5ID0gbmV3IE5pb0NsaWVudFNvY2tldENo\nYW5uZWxGYWN0b3J5KEV4ZWN1dG9ycy5uZXdDYWNoZWRUaHJlYWRQb29sKCks\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBFeGVjdXRvcnMubmV3Q2FjaGVkVGhyZWFk\nUG9vbCgpKTsKICAgICAgICBtYWluV29ya2VyUG9vbCA9IG5ldyBPcmRlcmVk\nU2FmZUV4ZWN1dG9yKGNvbmYuZ2V0TnVtV29ya2VyVGhyZWFkcygpKTsKICAg\nICAgICBib29raWVDbGllbnQgPSBuZXcgQm9va2llQ2xpZW50KGNvbmYsIGNo\nYW5uZWxGYWN0b3J5LCBtYWluV29ya2VyUG9vbCk7CiAgICAgICAgYm9va2ll\nV2F0Y2hlciA9IG5ldyBCb29raWVXYXRjaGVyKGNvbmYsIHRoaXMpOwogICAg\nICAgIGJvb2tpZVdhdGNoZXIucmVhZEJvb2tpZXNCbG9ja2luZygpOwoKICAg\nICAgICBsZWRnZXJNYW5hZ2VyID0gTGVkZ2VyTWFuYWdlckZhY3RvcnkubmV3\nTGVkZ2VyTWFuYWdlcihjb25mLCB6ayk7CgogICAgICAgIG93bkNoYW5uZWxG\nYWN0b3J5ID0gdHJ1ZTsKICAgICAgICBvd25aS0hhbmRsZSA9IHRydWU7CiAg\nICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgYm9va2tlZXBlciBjbGll\nbnQgYnV0IHVzZSB0aGUgcGFzc2VkIGluIHpvb2tlZXBlciBjbGllbnQgaW5z\ndGVhZAogICAgICogb2YgaW5zdGFudGlhdGluZyBvbmUuCiAgICAgKgogICAg\nICogQHBhcmFtIGNvbmYKICAgICAqICAgICAgICAgIENsaWVudCBDb25maWd1\ncmF0aW9uIG9iamVjdAogICAgICogICAgICAgICAge0BsaW5rIENsaWVudENv\nbmZpZ3VyYXRpb259CiAgICAgKiBAcGFyYW0gemsKICAgICAqICAgICAgICAg\nIFpvb2tlZXBlciBjbGllbnQgaW5zdGFuY2UgY29ubmVjdGVkIHRvIHRoZSB6\nb29rZWVwZXIgd2l0aCB3aGljaAogICAgICogICAgICAgICAgdGhlIGJvb2tp\nZXMgaGF2ZSByZWdpc3RlcmVkCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9u\nCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAgKiBA\ndGhyb3dzIEtlZXBlckV4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgQm9v\na0tlZXBlcihDbGllbnRDb25maWd1cmF0aW9uIGNvbmYsIFpvb0tlZXBlciB6\naykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhj\nZXB0aW9uLCBLZWVwZXJFeGNlcHRpb24gewogICAgICAgIHRoaXMoY29uZiwg\nemssIG5ldyBOaW9DbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeShFeGVjdXRv\ncnMubmV3Q2FjaGVkVGhyZWFkUG9vbCgpLAogICAgICAgICAgICAgICAgRXhl\nY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2woKSkpOwogICAgICAgIG93bkNo\nYW5uZWxGYWN0b3J5ID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIENy\nZWF0ZSBhIGJvb2trZWVwZXIgY2xpZW50IGJ1dCB1c2UgdGhlIHBhc3NlZCBp\nbiB6b29rZWVwZXIgY2xpZW50IGFuZAogICAgICogY2xpZW50IHNvY2tldCBj\naGFubmVsIGZhY3RvcnkgaW5zdGVhZCBvZiBpbnN0YW50aWF0aW5nIHRob3Nl\nLgogICAgICoKICAgICAqIEBwYXJhbSBjb25mCiAgICAgKiAgICAgICAgICBD\nbGllbnQgQ29uZmlndXJhdGlvbiBPYmplY3QKICAgICAqICAgICAgICAgIHtA\nbGluayBDbGllbnRDb25maWd1cmF0aW9ufQogICAgICogQHBhcmFtIHprCiAg\nICAgKiAgICAgICAgICBab29rZWVwZXIgY2xpZW50IGluc3RhbmNlIGNvbm5l\nY3RlZCB0byB0aGUgem9va2VlcGVyIHdpdGggd2hpY2gKICAgICAqICAgICAg\nICAgIHRoZSBib29raWVzIGhhdmUgcmVnaXN0ZXJlZC4gVGhlIFpvb0tlZXBl\nciBjbGllbnQgbXVzdCBiZSBjb25uZWN0ZWQKICAgICAqICAgICAgICAgIGJl\nZm9yZSBpdCBpcyBwYXNzZWQgdG8gQm9va0tlZXBlci4gT3RoZXJ3aXNlIGEg\nS2VlcGVyRXhjZXB0aW9uIGlzIHRocm93bi4KICAgICAqIEBwYXJhbSBjaGFu\nbmVsRmFjdG9yeQogICAgICogICAgICAgICAgQSBmYWN0b3J5IHRoYXQgd2ls\nbCBiZSB1c2VkIHRvIGNyZWF0ZSBjb25uZWN0aW9ucyB0byB0aGUgYm9va2ll\ncwogICAgICogQHRocm93cyBJT0V4Y2VwdGlvbgogICAgICogQHRocm93cyBJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBLZWVwZXJFeGNl\ncHRpb24gaWYgdGhlIHBhc3NlZCB6ayBoYW5kbGUgaXMgbm90IGNvbm5lY3Rl\nZAogICAgICovCiAgICBwdWJsaWMgQm9va0tlZXBlcihDbGllbnRDb25maWd1\ncmF0aW9uIGNvbmYsIFpvb0tlZXBlciB6aywgQ2xpZW50U29ja2V0Q2hhbm5l\nbEZhY3RvcnkgY2hhbm5lbEZhY3RvcnkpCiAgICAgICAgICAgIHRocm93cyBJ\nT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sIEtlZXBlckV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKHprID09IG51bGwgfHwgY2hhbm5lbEZhY3Rv\ncnkgPT0gbnVsbCkgewogICAgICAgICAgICB0aHJvdyBuZXcgTnVsbFBvaW50\nZXJFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICAgICAgaWYgKCF6ay5nZXRT\ndGF0ZSgpLmlzQ29ubmVjdGVkKCkpIHsKICAgICAgICAgICAgTE9HLmVycm9y\nKCJVbmNvbm5lY3RlZCB6b29rZWVwZXIgaGFuZGxlIHBhc3NlZCB0byBib29r\na2VlcGVyIik7CiAgICAgICAgICAgIHRocm93IEtlZXBlckV4Y2VwdGlvbi5j\ncmVhdGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuQ09OTkVDVElPTkxPU1MpOwog\nICAgICAgIH0KICAgICAgICB0aGlzLmNvbmYgPSBjb25mOwogICAgICAgIHRo\naXMuemsgPSB6azsKICAgICAgICB0aGlzLmNoYW5uZWxGYWN0b3J5ID0gY2hh\nbm5lbEZhY3Rvcnk7CgogICAgICAgIG1haW5Xb3JrZXJQb29sID0gbmV3IE9y\nZGVyZWRTYWZlRXhlY3V0b3IoY29uZi5nZXROdW1Xb3JrZXJUaHJlYWRzKCkp\nOwogICAgICAgIGJvb2tpZUNsaWVudCA9IG5ldyBCb29raWVDbGllbnQoY29u\nZiwgY2hhbm5lbEZhY3RvcnksIG1haW5Xb3JrZXJQb29sKTsKICAgICAgICBi\nb29raWVXYXRjaGVyID0gbmV3IEJvb2tpZVdhdGNoZXIoY29uZiwgdGhpcyk7\nCiAgICAgICAgYm9va2llV2F0Y2hlci5yZWFkQm9va2llc0Jsb2NraW5nKCk7\nCgogICAgICAgIGxlZGdlck1hbmFnZXIgPSBMZWRnZXJNYW5hZ2VyRmFjdG9y\neS5uZXdMZWRnZXJNYW5hZ2VyKGNvbmYsIHprKTsKICAgIH0KCiAgICBMZWRn\nZXJNYW5hZ2VyIGdldExlZGdlck1hbmFnZXIoKSB7CiAgICAgICAgcmV0dXJu\nIGxlZGdlck1hbmFnZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGVyZSBh\ncmUgMiBkaWdlc3QgdHlwZXMgdGhhdCBjYW4gYmUgdXNlZCBmb3IgdmVyaWZp\nY2F0aW9uLiBUaGUgQ1JDMzIgaXMKICAgICAqIGNoZWFwIHRvIGNvbXB1dGUg\nYnV0IGRvZXMgbm90IHByb3RlY3QgYWdhaW5zdCBieXphbnRpbmUgYm9va2ll\ncyAoaS5lLiwgYQogICAgICogYm9va2llIG1pZ2h0IHJlcG9ydCBmYWtlIGJ5\ndGVzIGFuZCBhIG1hdGNoaW5nIENSQzMyKS4gVGhlIE1BQyBjb2RlIGlzIG1v\ncmUKICAgICAqIGV4cGVuc2l2ZSB0byBjb21wdXRlLCBidXQgaXMgcHJvdGVj\ndGVkIGJ5IGEgcGFzc3dvcmQsIGkuZS4sIGEgYm9va2llIGNhbid0CiAgICAg\nKiByZXBvcnQgZmFrZSBieXRlcyB3aXRoIGEgbWF0aGNoaW5nIE1BQyB1bmxl\nc3MgaXQga25vd3MgdGhlIHBhc3N3b3JkCiAgICAgKi8KICAgIHB1YmxpYyBl\nbnVtIERpZ2VzdFR5cGUgewogICAgICAgIE1BQywgQ1JDMzIKICAgIH07Cgog\nICAgWm9vS2VlcGVyIGdldFprSGFuZGxlKCkgewogICAgICAgIHJldHVybiB6\nazsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xpZW50Q29uZmlndXJhdGlvbiBn\nZXRDb25mKCkgewogICAgICAgIHJldHVybiBjb25mOwogICAgfQoKICAgIC8q\nKgogICAgICogR2V0IHRoZSBCb29raWVDbGllbnQsIGN1cnJlbnRseSB1c2Vk\nIGZvciBkb2luZyBib29raWUgcmVjb3ZlcnkuCiAgICAgKgogICAgICogQHJl\ndHVybiBCb29raWVDbGllbnQgZm9yIHRoZSBCb29rS2VlcGVyIGluc3RhbmNl\nLgogICAgICovCiAgICBCb29raWVDbGllbnQgZ2V0Qm9va2llQ2xpZW50KCkg\newogICAgICAgIHJldHVybiBib29raWVDbGllbnQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGVzIGEgbmV3IGxlZGdlciBhc3luY2hyb25vdXNseS4g\nVG8gY3JlYXRlIGEgbGVkZ2VyLCB3ZSBuZWVkIHRvIHNwZWNpZnkKICAgICAq\nIHRoZSBlbnNlbWJsZSBzaXplLCB0aGUgcXVvcnVtIHNpemUsIHRoZSBkaWdl\nc3QgdHlwZSwgYSBwYXNzd29yZCwgYSBjYWxsYmFjawogICAgICogaW1wbGVt\nZW50YXRpb24sIGFuZCBhbiBvcHRpb25hbCBjb250cm9sIG9iamVjdC4gVGhl\nIGVuc2VtYmxlIHNpemUgaXMgaG93CiAgICAgKiBtYW55IGJvb2tpZXMgdGhl\nIGVudHJpZXMgc2hvdWxkIGJlIHN0cmlwZWQgYW1vbmcgYW5kIHRoZSBxdW9y\ndW0gc2l6ZSBpcyB0aGUKICAgICAqIGRlZ3JlZSBvZiByZXBsaWNhdGlvbiBv\nZiBlYWNoIGVudHJ5LiBUaGUgZGlnZXN0IHR5cGUgaXMgZWl0aGVyIGEgTUFD\nIG9yIGEKICAgICAqIENSQy4gTm90ZSB0aGF0IHRoZSBDUkMgb3B0aW9uIGlz\nIG5vdCBhYmxlIHRvIHByb3RlY3QgYSBjbGllbnQgYWdhaW5zdCBhCiAgICAg\nKiBib29raWUgdGhhdCByZXBsYWNlcyBhbiBlbnRyeS4gVGhlIHBhc3N3b3Jk\nIGlzIHVzZWQgbm90IG9ubHkgdG8KICAgICAqIGF1dGhlbnRpY2F0ZSBhY2Nl\nc3MgdG8gYSBsZWRnZXIsIGJ1dCBhbHNvIHRvIHZlcmlmeSBlbnRyaWVzIGlu\nIGxlZGdlcnMuCiAgICAgKgogICAgICogQHBhcmFtIGVuc1NpemUKICAgICAq\nICAgICAgICAgIGVuc2VtYmxlIHNpemUKICAgICAqIEBwYXJhbSBxU2l6ZQog\nICAgICogICAgICAgICAgcXVvcnVtIHNpemUKICAgICAqIEBwYXJhbSBkaWdl\nc3RUeXBlCiAgICAgKiAgICAgICAgICBkaWdlc3QgdHlwZSwgZWl0aGVyIE1B\nQyBvciBDUkMzMgogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogICAgICAg\nICAgcGFzc3dvcmQKICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAgICAg\nY3JlYXRlQ2FsbGJhY2sgaW1wbGVtZW50YXRpb24KICAgICAqIEBwYXJhbSBj\ndHgKICAgICAqICAgICAgICAgIG9wdGlvbmFsIGNvbnRyb2wgb2JqZWN0CiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGFzeW5jQ3JlYXRlTGVkZ2VyKGZpbmFs\nIGludCBlbnNTaXplLCBmaW5hbCBpbnQgcVNpemUsIGZpbmFsIERpZ2VzdFR5\ncGUgZGlnZXN0VHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGZpbmFsIGJ5dGVbXSBwYXNzd2QsIGZpbmFsIENyZWF0ZUNhbGxiYWNr\nIGNiLCBmaW5hbCBPYmplY3QgY3R4KSB7CiAgICAgICAgbmV3IExlZGdlckNy\nZWF0ZU9wKEJvb2tLZWVwZXIudGhpcywgZW5zU2l6ZSwgcVNpemUsIGRpZ2Vz\ndFR5cGUsIHBhc3N3ZCwgY2IsIGN0eCkKICAgICAgICAgICAgLmluaXRpYXRl\nKCk7CiAgICB9CgoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIG5ldyBsZWRn\nZXIuIERlZmF1bHQgb2YgMyBzZXJ2ZXJzLCBhbmQgcXVvcnVtIG9mIDIgc2Vy\ndmVycy4KICAgICAqCiAgICAgKiBAcGFyYW0gZGlnZXN0VHlwZQogICAgICog\nICAgICAgICAgZGlnZXN0IHR5cGUsIGVpdGhlciBNQUMgb3IgQ1JDMzIKICAg\nICAqIEBwYXJhbSBwYXNzd2QKICAgICAqICAgICAgICAgIHBhc3N3b3JkCiAg\nICAgKiBAcmV0dXJuIGEgaGFuZGxlIHRvIHRoZSBuZXdseSBjcmVhdGVkIGxl\nZGdlcgogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAg\nICogQHRocm93cyBCS0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgTGVk\nZ2VySGFuZGxlIGNyZWF0ZUxlZGdlcihEaWdlc3RUeXBlIGRpZ2VzdFR5cGUs\nIGJ5dGUgcGFzc3dkW10pCiAgICAgICAgICAgIHRocm93cyBCS0V4Y2VwdGlv\nbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIHJldHVybiBjcmVh\ndGVMZWRnZXIoMywgMiwgZGlnZXN0VHlwZSwgcGFzc3dkKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFN5bmNocm9ub3VzIGNhbGwgdG8gY3JlYXRlIGxlZGdl\nci4gUGFyYW1ldGVycyBtYXRjaCB0aG9zZSBvZgogICAgICoge0BsaW5rICNh\nc3luY0NyZWF0ZUxlZGdlcihpbnQsIGludCwgRGlnZXN0VHlwZSwgYnl0ZVtd\nLCAKICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgQXN5bmNDYWxs\nYmFjay5DcmVhdGVDYWxsYmFjaywgT2JqZWN0KX0KICAgICAqCiAgICAgKiBA\ncGFyYW0gZW5zU2l6ZQogICAgICogQHBhcmFtIHFTaXplCiAgICAgKiBAcGFy\nYW0gZGlnZXN0VHlwZQogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogQHJl\ndHVybiBhIGhhbmRsZSB0byB0aGUgbmV3bHkgY3JlYXRlZCBsZWRnZXIKICAg\nICAqIEB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqIEB0aHJv\nd3MgQktFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIExlZGdlckhhbmRs\nZSBjcmVhdGVMZWRnZXIoaW50IGVuc1NpemUsIGludCBxU2l6ZSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERpZ2VzdFR5cGUgZGln\nZXN0VHlwZSwgYnl0ZSBwYXNzd2RbXSkgCiAgICAgICAgICAgIHRocm93cyBJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24gewogICAgICAgIFN5\nbmNDb3VudGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAg\nICBjb3VudGVyLmluYygpOwogICAgICAgIC8qCiAgICAgICAgICogQ2FsbHMg\nYXN5bmNocm9ub3VzIHZlcnNpb24KICAgICAgICAgKi8KICAgICAgICBhc3lu\nY0NyZWF0ZUxlZGdlcihlbnNTaXplLCBxU2l6ZSwgZGlnZXN0VHlwZSwgcGFz\nc3dkLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgU3luY0NyZWF0\nZUNhbGxiYWNrKCksIGNvdW50ZXIpOwoKICAgICAgICAvKgogICAgICAgICAq\nIFdhaXQKICAgICAgICAgKi8KICAgICAgICBjb3VudGVyLmJsb2NrKDApOwog\nICAgICAgIGlmIChjb3VudGVyLmdldExoKCkgPT0gbnVsbCkgewogICAgICAg\nICAgICBMT0cuZXJyb3IoIlpvb0tlZXBlciBlcnJvcjogIiArIGNvdW50ZXIu\nZ2V0cmMoKSk7CiAgICAgICAgICAgIHRocm93IEJLRXhjZXB0aW9uLmNyZWF0\nZShDb2RlLlpLRXhjZXB0aW9uKTsKICAgICAgICB9CgogICAgICAgIHJldHVy\nbiBjb3VudGVyLmdldExoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBPcGVu\nIGV4aXN0aW5nIGxlZGdlciBhc3luY2hyb25vdXNseSBmb3IgcmVhZGluZy4K\nICAgICAqIAogICAgICogT3BlbmluZyBhIGxlZGdlciB3aXRoIHRoaXMgbWV0\naG9kIGludm9rZXMgZmVuY2luZyBhbmQgcmVjb3Zlcnkgb24gdGhlIGxlZGdl\nciAKICAgICAqIGlmIHRoZSBsZWRnZXIgaGFzIG5vdCBiZWVuIGNsb3NlZC4g\nRmVuY2luZyB3aWxsIGJsb2NrIGFsbCBvdGhlciBjbGllbnRzIGZyb20gCiAg\nICAgKiB3cml0aW5nIHRvIHRoZSBsZWRnZXIuIFJlY292ZXJ5IHdpbGwgbWFr\nZSBzdXJlIHRoYXQgdGhlIGxlZGdlciBpcyBjbG9zZWQgCiAgICAgKiBiZWZv\ncmUgcmVhZGluZyBmcm9tIGl0LiAKICAgICAqCiAgICAgKiBSZWNvdmVyeSBh\nbHNvIG1ha2VzIHN1cmUgdGhhdCBhbnkgZW50cmllcyB3aGljaCByZWFjaGVk\nIG9uZSBib29raWUsIGJ1dCBub3QgYSAKICAgICAqIHF1b3J1bSwgd2lsbCBi\nZSByZXBsaWNhdGVkIHRvIGEgcXVvcnVtIG9mIGJvb2tpZXMuIFRoaXMgb2Nj\ndXJzIGluIGNhc2VzIHdlcmUKICAgICAqIHRoZSB3cml0ZXIgb2YgYSBsZWRn\nZXIgY3Jhc2hlcyBhZnRlciBzZW5kaW5nIGEgd3JpdGUgcmVxdWVzdCB0byBv\nbmUgYm9va2llIGJ1dAogICAgICogYmVmb3JlIGJlaW5nIGFibGUgdG8gc2Vu\nZCBpdCB0byB0aGUgcmVzdCBvZiB0aGUgYm9va2llcyBpbiB0aGUgcXVvcnVt\nLiAKICAgICAqCiAgICAgKiBJZiB0aGUgbGVkZ2VyIGlzIGFscmVhZHkgY2xv\nc2VkLCBuZWl0aGVyIGZlbmNpbmcgbm9yIHJlY292ZXJ5IHdpbGwgYmUgYXBw\nbGllZC4KICAgICAqIAogICAgICogQHNlZSBMZWRnZXJIYW5kbGUjYXN5bmND\nbG9zZQogICAgICoKICAgICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAgICAg\nIGxlZGdlciBpZGVudGlmaWVyCiAgICAgKiBAcGFyYW0gZGlnZXN0VHlwZQog\nICAgICogICAgICAgICAgZGlnZXN0IHR5cGUsIGVpdGhlciBNQUMgb3IgQ1JD\nMzIKICAgICAqIEBwYXJhbSBwYXNzd2QKICAgICAqICAgICAgICAgIHBhc3N3\nb3JkCiAgICAgKiBAcGFyYW0gY3R4CiAgICAgKiAgICAgICAgICBvcHRpb25h\nbCBjb250cm9sIG9iamVjdAogICAgICovCiAgICBwdWJsaWMgdm9pZCBhc3lu\nY09wZW5MZWRnZXIoZmluYWwgbG9uZyBsSWQsIGZpbmFsIERpZ2VzdFR5cGUg\nZGlnZXN0VHlwZSwgZmluYWwgYnl0ZSBwYXNzd2RbXSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBmaW5hbCBPcGVuQ2FsbGJhY2sgY2IsIGZp\nbmFsIE9iamVjdCBjdHgpIHsKICAgICAgICBuZXcgTGVkZ2VyT3Blbk9wKEJv\nb2tLZWVwZXIudGhpcywgbElkLCBkaWdlc3RUeXBlLCBwYXNzd2QsIGNiLCBj\ndHgpLmluaXRpYXRlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBPcGVuIGV4\naXN0aW5nIGxlZGdlciBhc3luY2hyb25vdXNseSBmb3IgcmVhZGluZywgYnV0\nIGl0IGRvZXMgbm90IHRyeSB0bwogICAgICogcmVjb3ZlciB0aGUgbGVkZ2Vy\nIGlmIGl0IGlzIG5vdCB5ZXQgY2xvc2VkLiBUaGUgYXBwbGljYXRpb24gbmVl\nZHMgdG8gdXNlCiAgICAgKiBpdCBjYXJlZnVsbHksIHNpbmNlIHRoZSB3cml0\nZXIgbWlnaHQgaGF2ZSBjcmFzaGVkIGFuZCBsZWRnZXIgd2lsbCByZW1haW4K\nICAgICAqIHVuc2VhbGVkIGZvcmV2ZXIgaWYgdGhlcmUgaXMgbm8gZXh0ZXJu\nYWwgbWVjaGFuaXNtIHRvIGRldGVjdCB0aGUgZmFpbHVyZQogICAgICogb2Yg\ndGhlIHdyaXRlciBhbmQgdGhlIGxlZGdlciBpcyBub3Qgb3BlbiBpbiBhIHNh\nZmUgbWFubmVyLCBpbnZva2luZyB0aGUKICAgICAqIHJlY292ZXJ5IHByb2Nl\nZHVyZS4KICAgICAqIAogICAgICogT3BlbmluZyBhIGxlZGdlciB3aXRob3V0\nIHJlY292ZXJ5IGRvZXMgbm90IGZlbmNlIHRoZSBsZWRnZXIuIEFzIHN1Y2gs\nIG90aGVyCiAgICAgKiBjbGllbnRzIGNhbiBjb250aW51ZSB0byB3cml0ZSB0\nbyB0aGUgbGVkZ2VyLiAKICAgICAqCiAgICAgKiBUaGlzIG1ldGhvZCByZXR1\ncm5zIGEgcmVhZCBvbmx5IGxlZGdlciBoYW5kbGUuIEl0IHdpbGwgbm90IGJl\nIHBvc3NpYmxlIAogICAgICogdG8gYWRkIGVudHJpZXMgdG8gdGhlIGxlZGdl\nci4gQW55IGF0dGVtcHQgdG8gYWRkIGVudHJpZXMgd2lsbCB0aHJvdyBhbiAK\nICAgICAqIGV4Y2VwdGlvbi4KICAgICAqIAogICAgICogUmVhZHMgZnJvbSB0\naGUgcmV0dXJuZWQgbGVkZ2VyIHdpbGwgb25seSBiZSBhYmxlIHRvIHJlYWQg\nZW50cmllcyB1cCB1bnRpbAogICAgICogdGhlIGxhc3RDb25maXJtZWRFbnRy\neSBhdCB0aGUgcG9pbnQgaW4gdGltZSBhdCB3aGljaCB0aGUgbGVkZ2VyIHdh\ncyBvcGVuZWQuCiAgICAgKgogICAgICogQHBhcmFtIGxJZAogICAgICogICAg\nICAgICAgbGVkZ2VyIGlkZW50aWZpZXIKICAgICAqIEBwYXJhbSBkaWdlc3RU\neXBlCiAgICAgKiAgICAgICAgICBkaWdlc3QgdHlwZSwgZWl0aGVyIE1BQyBv\nciBDUkMzMgogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogICAgICAgICAg\ncGFzc3dvcmQKICAgICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgIG9w\ndGlvbmFsIGNvbnRyb2wgb2JqZWN0CiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGFzeW5jT3BlbkxlZGdlck5vUmVjb3ZlcnkoZmluYWwgbG9uZyBsSWQsIGZp\nbmFsIERpZ2VzdFR5cGUgZGlnZXN0VHlwZSwgZmluYWwgYnl0ZSBwYXNzd2Rb\nXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZmluYWwgT3BlbkNhbGxiYWNrIGNiLCBmaW5hbCBPYmplY3QgY3R4KSB7CiAg\nICAgICAgbmV3IExlZGdlck9wZW5PcChCb29rS2VlcGVyLnRoaXMsIGxJZCwg\nZGlnZXN0VHlwZSwgcGFzc3dkLCBjYiwgY3R4KS5pbml0aWF0ZVdpdGhvdXRS\nZWNvdmVyeSgpOwogICAgfQoKCiAgICAvKioKICAgICAqIFN5bmNocm9ub3Vz\nIG9wZW4gbGVkZ2VyIGNhbGwKICAgICAqCiAgICAgKiBAc2VlICNhc3luY09w\nZW5MZWRnZXIKICAgICAqIEBwYXJhbSBsSWQKICAgICAqICAgICAgICAgIGxl\nZGdlciBpZGVudGlmaWVyCiAgICAgKiBAcGFyYW0gZGlnZXN0VHlwZQogICAg\nICogICAgICAgICAgZGlnZXN0IHR5cGUsIGVpdGhlciBNQUMgb3IgQ1JDMzIK\nICAgICAqIEBwYXJhbSBwYXNzd2QKICAgICAqICAgICAgICAgIHBhc3N3b3Jk\nCiAgICAgKiBAcmV0dXJuIGEgaGFuZGxlIHRvIHRoZSBvcGVuIGxlZGdlcgog\nICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRo\ncm93cyBCS0V4Y2VwdGlvbgogICAgICovCgogICAgcHVibGljIExlZGdlckhh\nbmRsZSBvcGVuTGVkZ2VyKGxvbmcgbElkLCBEaWdlc3RUeXBlIGRpZ2VzdFR5\ncGUsIGJ5dGUgcGFzc3dkW10pCiAgICAgICAgICAgIHRocm93cyBCS0V4Y2Vw\ndGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIFN5bmNDb3Vu\ndGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAgICBjb3Vu\ndGVyLmluYygpOwoKICAgICAgICAvKgogICAgICAgICAqIENhbGxzIGFzeW5j\nIG9wZW4gbGVkZ2VyCiAgICAgICAgICovCiAgICAgICAgYXN5bmNPcGVuTGVk\nZ2VyKGxJZCwgZGlnZXN0VHlwZSwgcGFzc3dkLCBuZXcgU3luY09wZW5DYWxs\nYmFjaygpLCBjb3VudGVyKTsKCiAgICAgICAgLyoKICAgICAgICAgKiBXYWl0\nCiAgICAgICAgICovCiAgICAgICAgY291bnRlci5ibG9jaygwKTsKICAgICAg\nICBpZiAoY291bnRlci5nZXRyYygpICE9IEJLRXhjZXB0aW9uLkNvZGUuT0sp\nCiAgICAgICAgICAgIHRocm93IEJLRXhjZXB0aW9uLmNyZWF0ZShjb3VudGVy\nLmdldHJjKCkpOwoKICAgICAgICByZXR1cm4gY291bnRlci5nZXRMaCgpOwog\nICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25vdXMsIHVuc2FmZSBvcGVu\nIGxlZGdlciBjYWxsCiAgICAgKgogICAgICogQHNlZSAjYXN5bmNPcGVuTGVk\nZ2VyTm9SZWNvdmVyeQogICAgICogQHBhcmFtIGxJZAogICAgICogICAgICAg\nICAgbGVkZ2VyIGlkZW50aWZpZXIKICAgICAqIEBwYXJhbSBkaWdlc3RUeXBl\nCiAgICAgKiAgICAgICAgICBkaWdlc3QgdHlwZSwgZWl0aGVyIE1BQyBvciBD\nUkMzMgogICAgICogQHBhcmFtIHBhc3N3ZAogICAgICogICAgICAgICAgcGFz\nc3dvcmQKICAgICAqIEByZXR1cm4gYSBoYW5kbGUgdG8gdGhlIG9wZW4gbGVk\nZ2VyCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAg\nKiBAdGhyb3dzIEJLRXhjZXB0aW9uCiAgICAgKi8KCiAgICBwdWJsaWMgTGVk\nZ2VySGFuZGxlIG9wZW5MZWRnZXJOb1JlY292ZXJ5KGxvbmcgbElkLCBEaWdl\nc3RUeXBlIGRpZ2VzdFR5cGUsIGJ5dGUgcGFzc3dkW10pCiAgICAgICAgICAg\nIHRocm93cyBCS0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewog\nICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIgPSBuZXcgU3luY0NvdW50ZXIo\nKTsKICAgICAgICBjb3VudGVyLmluYygpOwoKICAgICAgICAvKgogICAgICAg\nICAqIENhbGxzIGFzeW5jIG9wZW4gbGVkZ2VyCiAgICAgICAgICovCiAgICAg\nICAgYXN5bmNPcGVuTGVkZ2VyTm9SZWNvdmVyeShsSWQsIGRpZ2VzdFR5cGUs\nIHBhc3N3ZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5l\ndyBTeW5jT3BlbkNhbGxiYWNrKCksIGNvdW50ZXIpOwoKICAgICAgICAvKgog\nICAgICAgICAqIFdhaXQKICAgICAgICAgKi8KICAgICAgICBjb3VudGVyLmJs\nb2NrKDApOwogICAgICAgIGlmIChjb3VudGVyLmdldHJjKCkgIT0gQktFeGNl\ncHRpb24uQ29kZS5PSykKICAgICAgICAgICAgdGhyb3cgQktFeGNlcHRpb24u\nY3JlYXRlKGNvdW50ZXIuZ2V0cmMoKSk7CgogICAgICAgIHJldHVybiBjb3Vu\ndGVyLmdldExoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxldGVzIGEg\nbGVkZ2VyIGFzeW5jaHJvbm91c2x5LgogICAgICoKICAgICAqIEBwYXJhbSBs\nSWQKICAgICAqICAgICAgICAgICAgbGVkZ2VyIElkCiAgICAgKiBAcGFyYW0g\nY2IKICAgICAqICAgICAgICAgICAgZGVsZXRlQ2FsbGJhY2sgaW1wbGVtZW50\nYXRpb24KICAgICAqIEBwYXJhbSBjdHgKICAgICAqICAgICAgICAgICAgb3B0\naW9uYWwgY29udHJvbCBvYmplY3QKICAgICAqLwogICAgcHVibGljIHZvaWQg\nYXN5bmNEZWxldGVMZWRnZXIoZmluYWwgbG9uZyBsSWQsIGZpbmFsIERlbGV0\nZUNhbGxiYWNrIGNiLCBmaW5hbCBPYmplY3QgY3R4KSB7CiAgICAgICAgbmV3\nIExlZGdlckRlbGV0ZU9wKEJvb2tLZWVwZXIudGhpcywgbElkLCBjYiwgY3R4\nKS5pbml0aWF0ZSgpOwogICAgfQoKCiAgICAvKioKICAgICAqIFN5bmNocm9u\nb3VzIGNhbGwgdG8gZGVsZXRlIGEgbGVkZ2VyLiBQYXJhbWV0ZXJzIG1hdGNo\nIHRob3NlIG9mCiAgICAgKiB7QGxpbmsgI2FzeW5jRGVsZXRlTGVkZ2VyKGxv\nbmcsIEFzeW5jQ2FsbGJhY2suRGVsZXRlQ2FsbGJhY2ssIE9iamVjdCl9CiAg\nICAgKgogICAgICogQHBhcmFtIGxJZAogICAgICogICAgICAgICAgICBsZWRn\nZXJJZAogICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAg\nICogQHRocm93cyBCS0V4Y2VwdGlvbi5CS05vU3VjaExlZGdlckV4aXN0c0V4\nY2VwdGlvbiBpZiB0aGUgbGVkZ2VyIGRvZXNuJ3QgZXhpc3QKICAgICAqIEB0\naHJvd3MgQktFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQgZGVs\nZXRlTGVkZ2VyKGxvbmcgbElkKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRp\nb24sIEJLRXhjZXB0aW9uIHsKICAgICAgICBTeW5jQ291bnRlciBjb3VudGVy\nID0gbmV3IFN5bmNDb3VudGVyKCk7CiAgICAgICAgY291bnRlci5pbmMoKTsK\nICAgICAgICAvLyBDYWxsIGFzeW5jaHJvbm91cyB2ZXJzaW9uCiAgICAgICAg\nYXN5bmNEZWxldGVMZWRnZXIobElkLCBuZXcgU3luY0RlbGV0ZUNhbGxiYWNr\nKCksIGNvdW50ZXIpOwogICAgICAgIC8vIFdhaXQKICAgICAgICBjb3VudGVy\nLmJsb2NrKDApOwogICAgICAgIGlmIChjb3VudGVyLmdldHJjKCkgPT0gS2Vl\ncGVyRXhjZXB0aW9uLkNvZGUuTk9OT0RFLmludFZhbHVlKCkpIHsKICAgICAg\nICAgICAgTE9HLndhcm4oIkxlZGdlciBub2RlIGRvZXMgbm90IGV4aXN0IGlu\nIFpvb0tlZXBlcjogbGVkZ2VySWQ9e30iLCBsSWQpOwogICAgICAgICAgICB0\naHJvdyBCS0V4Y2VwdGlvbi5jcmVhdGUoQ29kZS5Ob1N1Y2hMZWRnZXJFeGlz\ndHNFeGNlcHRpb24pOwogICAgICAgIH0gZWxzZSBpZiAoY291bnRlci5nZXRy\nYygpICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsK\nICAgICAgICAgICAgTE9HLmVycm9yKCJab29LZWVwZXIgZXJyb3IgZGVsZXRp\nbmcgbGVkZ2VyIG5vZGU6ICIgKyBjb3VudGVyLmdldHJjKCkpOwogICAgICAg\nICAgICB0aHJvdyBCS0V4Y2VwdGlvbi5jcmVhdGUoQ29kZS5aS0V4Y2VwdGlv\nbik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2h1dHMgZG93\nbiBjbGllbnQuCiAgICAgKgogICAgICovCiAgICBwdWJsaWMgdm9pZCBjbG9z\nZSgpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgQktFeGNlcHRpb24g\newogICAgICAgIGJvb2tpZUNsaWVudC5jbG9zZSgpOwogICAgICAgIGxlZGdl\nck1hbmFnZXIuY2xvc2UoKTsKICAgICAgICBib29raWVXYXRjaGVyLmhhbHQo\nKTsKICAgICAgICBpZiAob3duQ2hhbm5lbEZhY3RvcnkpIHsKICAgICAgICAg\nICAgY2hhbm5lbEZhY3RvcnkucmVsZWFzZUV4dGVybmFsUmVzb3VyY2VzKCk7\nCiAgICAgICAgfQogICAgICAgIGlmIChvd25aS0hhbmRsZSkgewogICAgICAg\nICAgICB6ay5jbG9zZSgpOwogICAgICAgIH0KICAgICAgICBtYWluV29ya2Vy\nUG9vbC5zaHV0ZG93bigpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGNs\nYXNzIFN5bmNDcmVhdGVDYWxsYmFjayBpbXBsZW1lbnRzIENyZWF0ZUNhbGxi\nYWNrIHsKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGUgY2FsbGJhY2sg\naW1wbGVtZW50YXRpb24gZm9yIHN5bmNocm9ub3VzIGNyZWF0ZSBjYWxsLgog\nICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHJjCiAgICAgICAgICogICAg\nICAgICAgcmV0dXJuIGNvZGUKICAgICAgICAgKiBAcGFyYW0gbGgKICAgICAg\nICAgKiAgICAgICAgICBsZWRnZXIgaGFuZGxlIG9iamVjdAogICAgICAgICAq\nIEBwYXJhbSBjdHgKICAgICAgICAgKiAgICAgICAgICBvcHRpb25hbCBjb250\ncm9sIG9iamVjdAogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGNy\nZWF0ZUNvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBPYmplY3Qg\nY3R4KSB7CiAgICAgICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIgPSAoU3lu\nY0NvdW50ZXIpIGN0eDsKICAgICAgICAgICAgY291bnRlci5zZXRMaChsaCk7\nCiAgICAgICAgICAgIGNvdW50ZXIuc2V0cmMocmMpOwogICAgICAgICAgICBj\nb3VudGVyLmRlYygpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0\nYXRpYyBjbGFzcyBTeW5jT3BlbkNhbGxiYWNrIGltcGxlbWVudHMgT3BlbkNh\nbGxiYWNrIHsKICAgICAgICAvKioKICAgICAgICAgKiBDYWxsYmFjayBtZXRo\nb2QgZm9yIHN5bmNocm9ub3VzIG9wZW4gb3BlcmF0aW9uCiAgICAgICAgICoK\nICAgICAgICAgKiBAcGFyYW0gcmMKICAgICAgICAgKiAgICAgICAgICByZXR1\ncm4gY29kZQogICAgICAgICAqIEBwYXJhbSBsaAogICAgICAgICAqICAgICAg\nICAgIGxlZGdlciBoYW5kbGUKICAgICAgICAgKiBAcGFyYW0gY3R4CiAgICAg\nICAgICogICAgICAgICAgb3B0aW9uYWwgY29udHJvbCBvYmplY3QKICAgICAg\nICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBvcGVuQ29tcGxldGUoaW50IHJj\nLCBMZWRnZXJIYW5kbGUgbGgsIE9iamVjdCBjdHgpIHsKICAgICAgICAgICAg\nU3luY0NvdW50ZXIgY291bnRlciA9IChTeW5jQ291bnRlcikgY3R4OwogICAg\nICAgICAgICBjb3VudGVyLnNldExoKGxoKTsKICAgICAgICAgICAgCiAgICAg\nICAgICAgIExPRy5kZWJ1ZygiT3BlbiBjb21wbGV0ZTogIiArIHJjKTsKICAg\nICAgICAgICAgCiAgICAgICAgICAgIGNvdW50ZXIuc2V0cmMocmMpOwogICAg\nICAgICAgICBjb3VudGVyLmRlYygpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncml2YXRlIHN0YXRpYyBjbGFzcyBTeW5jRGVsZXRlQ2FsbGJhY2sgaW1wbGVt\nZW50cyBEZWxldGVDYWxsYmFjayB7CiAgICAgICAgLyoqCiAgICAgICAgICog\nRGVsZXRlIGNhbGxiYWNrIGltcGxlbWVudGF0aW9uIGZvciBzeW5jaHJvbm91\ncyBkZWxldGUgY2FsbC4KICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSBy\nYwogICAgICAgICAqICAgICAgICAgICAgcmV0dXJuIGNvZGUKICAgICAgICAg\nKiBAcGFyYW0gY3R4CiAgICAgICAgICogICAgICAgICAgICBvcHRpb25hbCBj\nb250cm9sIG9iamVjdAogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lk\nIGRlbGV0ZUNvbXBsZXRlKGludCByYywgT2JqZWN0IGN0eCkgewogICAgICAg\nICAgICBTeW5jQ291bnRlciBjb3VudGVyID0gKFN5bmNDb3VudGVyKSBjdHg7\nCiAgICAgICAgICAgIGNvdW50ZXIuc2V0cmMocmMpOwogICAgICAgICAgICBj\nb3VudGVyLmRlYygpOwogICAgICAgIH0KICAgIH0KCgoKfQo=\n","encoding":"base64"}

