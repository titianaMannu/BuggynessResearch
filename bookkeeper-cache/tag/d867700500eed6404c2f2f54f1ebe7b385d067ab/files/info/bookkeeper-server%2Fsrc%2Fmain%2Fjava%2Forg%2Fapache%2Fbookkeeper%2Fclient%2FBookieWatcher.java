{"sha":"7ce7ee1a163968a4446262d859d7f808483564b2","node_id":"MDQ6QmxvYjE1NzU5NTY6N2NlN2VlMWExNjM5NjhhNDQ0NjI2MmQ4NTlkN2Y4MDg0ODM1NjRiMg==","size":7784,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/7ce7ee1a163968a4446262d859d7f808483564b2","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNv\nZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq\nIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmltcG9ydCBq\nYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tl\ndEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQg\namF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhhc2hT\nZXQ7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5T\nZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5FeGVjdXRvcnM7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5MaW5rZWRCbG9ja2luZ1F1ZXVl\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuU2NoZWR1bGVkRXhlY3V0\nb3JTZXJ2aWNlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGltZVVu\naXQ7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhj\nZXB0aW9uLkJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLkNsaWVudENvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TYWZlUnVubmFi\nbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TdHJpbmdV\ndGlsczsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xm\nNGouTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLldhdGNoZWRFdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldh\ndGNoZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5Bc3luY0NhbGxi\nYWNrLkNoaWxkcmVuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb24uQ29kZTsKCi8qKgogKiBUaGlzIGNsYXNz\nIGlzIHJlc3BvbnNpYmxlIGZvciBtYWludGFpbmluZyBhIGNvbnNpc3RlbnQg\ndmlldyBvZiB3aGF0IGJvb2tpZXMKICogYXJlIGF2YWlsYWJsZSBieSByZWFk\naW5nIFpvb2tlZXBlciAoYW5kIHNldHRpbmcgd2F0Y2hlcyBvbiB0aGUgYm9v\na2llIG5vZGVzKS4KICogV2hlbiBhIGJvb2tpZSBmYWlscywgdGhlIG90aGVy\nIHBhcnRzIG9mIHRoZSBjb2RlIHR1cm4gdG8gdGhpcyBjbGFzcyB0byBmaW5k\nIGEKICogcmVwbGFjZW1lbnQKICoKICovCmNsYXNzIEJvb2tpZVdhdGNoZXIg\naW1wbGVtZW50cyBXYXRjaGVyLCBDaGlsZHJlbkNhbGxiYWNrIHsKICAgIHN0\nYXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRM\nb2dnZXIoQm9va2llV2F0Y2hlci5jbGFzcyk7CgogICAgLy8gQm9va2llIHJl\nZ2lzdHJhdGlvbiBwYXRoIGluIFpLCiAgICBwcml2YXRlIGZpbmFsIFN0cmlu\nZyBib29raWVSZWdpc3RyYXRpb25QYXRoOwogICAgc3RhdGljIGZpbmFsIFNl\ndDxJbmV0U29ja2V0QWRkcmVzcz4gRU1QVFlfU0VUID0gbmV3IEhhc2hTZXQ8\nSW5ldFNvY2tldEFkZHJlc3M+KCk7CiAgICBwdWJsaWMgc3RhdGljIGludCBa\nS19DT05ORUNUX0JBQ0tPRkZfU0VDID0gMTsKCiAgICBCb29rS2VlcGVyIGJr\nOwogICAgU2NoZWR1bGVkRXhlY3V0b3JTZXJ2aWNlIHNjaGVkdWxlcjsKCiAg\nICBIYXNoU2V0PEluZXRTb2NrZXRBZGRyZXNzPiBrbm93bkJvb2tpZXMgPSBu\nZXcgSGFzaFNldDxJbmV0U29ja2V0QWRkcmVzcz4oKTsKCiAgICBTYWZlUnVu\nbmFibGUgcmVSZWFkVGFzayA9IG5ldyBTYWZlUnVubmFibGUoKSB7CiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgc2FmZVJ1bigpIHsK\nICAgICAgICAgICAgcmVhZEJvb2tpZXMoKTsKICAgICAgICB9CiAgICB9OwoK\nICAgIHB1YmxpYyBCb29raWVXYXRjaGVyKENsaWVudENvbmZpZ3VyYXRpb24g\nY29uZiwgQm9va0tlZXBlciBiaykgewogICAgICAgIHRoaXMuYmsgPSBiazsK\nICAgICAgICAvLyBaSyBib29raWUgcmVnaXN0cmF0aW9uIHBhdGgKICAgICAg\nICB0aGlzLmJvb2tpZVJlZ2lzdHJhdGlvblBhdGggPSBjb25mLmdldFprQXZh\naWxhYmxlQm9va2llc1BhdGgoKTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9\nIEV4ZWN1dG9ycy5uZXdTaW5nbGVUaHJlYWRTY2hlZHVsZWRFeGVjdXRvcigp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGhhbHQoKSB7CiAgICAgICAgc2No\nZWR1bGVyLnNodXRkb3duKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVh\nZEJvb2tpZXMoKSB7CiAgICAgICAgcmVhZEJvb2tpZXModGhpcyk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgcmVhZEJvb2tpZXMoQ2hpbGRyZW5DYWxsYmFj\nayBjYWxsYmFjaykgewogICAgICAgIGJrLmdldFprSGFuZGxlKCkuZ2V0Q2hp\nbGRyZW4odGhpcy5ib29raWVSZWdpc3RyYXRpb25QYXRoLCB0aGlzLCBjYWxs\nYmFjaywgbnVsbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCBwcm9jZXNzKFdhdGNoZWRFdmVudCBldmVudCkgewogICAgICAgIHJl\nYWRCb29raWVzKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\ndm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVj\ndCBjdHgsIExpc3Q8U3RyaW5nPiBjaGlsZHJlbikgewoKICAgICAgICBpZiAo\ncmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewog\nICAgICAgICAgICAvL2xvZ2dlci5lcnJvcigiRXJyb3Igd2hpbGUgcmVhZGlu\nZyBib29raWVzIiwgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShDb2RlLmdldChy\nYyksIHBhdGgpKTsKICAgICAgICAgICAgLy8gdHJ5IHRoZSByZWFkIGFmdGVy\nIGEgc2Vjb25kIGFnYWluCiAgICAgICAgICAgIHNjaGVkdWxlci5zY2hlZHVs\nZShyZVJlYWRUYXNrLCBaS19DT05ORUNUX0JBQ0tPRkZfU0VDLCBUaW1lVW5p\ndC5TRUNPTkRTKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAg\nICAgICAgLy8gUmVhZCB0aGUgYm9va2llIGFkZHJlc3NlcyBpbnRvIGEgc2V0\nIGZvciBlZmZpY2llbnQgbG9va3VwCiAgICAgICAgSGFzaFNldDxJbmV0U29j\na2V0QWRkcmVzcz4gbmV3Qm9va2llQWRkcnMgPSBuZXcgSGFzaFNldDxJbmV0\nU29ja2V0QWRkcmVzcz4oKTsKICAgICAgICBmb3IgKFN0cmluZyBib29raWVB\nZGRyU3RyaW5nIDogY2hpbGRyZW4pIHsKICAgICAgICAgICAgSW5ldFNvY2tl\ndEFkZHJlc3MgYm9va2llQWRkcjsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIGJvb2tpZUFkZHIgPSBTdHJpbmdVdGlscy5wYXJzZUFkZHIo\nYm9va2llQWRkclN0cmluZyk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiQ291\nbGQgbm90IHBhcnNlIGJvb2tpZSBhZGRyZXNzOiAiICsgYm9va2llQWRkclN0\ncmluZyArICIsIGlnbm9yaW5nIHRoaXMgYm9va2llIik7CiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBuZXdC\nb29raWVBZGRycy5hZGQoYm9va2llQWRkcik7CiAgICAgICAgfQoKICAgICAg\nICBmaW5hbCBIYXNoU2V0PEluZXRTb2NrZXRBZGRyZXNzPiBkZWFkQm9va2ll\nczsKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAg\nZGVhZEJvb2tpZXMgPSAoSGFzaFNldDxJbmV0U29ja2V0QWRkcmVzcz4pa25v\nd25Cb29raWVzLmNsb25lKCk7CiAgICAgICAgICAgIGRlYWRCb29raWVzLnJl\nbW92ZUFsbChuZXdCb29raWVBZGRycyk7CiAgICAgICAgICAgIGtub3duQm9v\na2llcyA9IG5ld0Jvb2tpZUFkZHJzOwogICAgICAgIH0KCiAgICAgICAgaWYg\nKGJrLmdldEJvb2tpZUNsaWVudCgpICE9IG51bGwpIHsKICAgICAgICAgICAg\nYmsuZ2V0Qm9va2llQ2xpZW50KCkuY2xvc2VDbGllbnRzKGRlYWRCb29raWVz\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBCbG9ja3MgdW50\naWwgYm9va2llcyBhcmUgcmVhZCBmcm9tIHpvb2tlZXBlciwgdXNlZCBpbiB0\naGUge0BsaW5rIEJvb2tLZWVwZXJ9IGNvbnN0cnVjdG9yLgogICAgICogQHRo\ncm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBLZWVw\nZXJFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVhZEJvb2tp\nZXNCbG9ja2luZygpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgS2Vl\ncGVyRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBMaW5rZWRCbG9ja2luZ1F1\nZXVlPEludGVnZXI+IHF1ZXVlID0gbmV3IExpbmtlZEJsb2NraW5nUXVldWU8\nSW50ZWdlcj4oKTsKICAgICAgICByZWFkQm9va2llcyhuZXcgQ2hpbGRyZW5D\nYWxsYmFjaygpIHsKICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2Vzc1Jl\nc3VsdChpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4LCBMaXN0PFN0\ncmluZz4gY2hpbGRyZW4pIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgQm9va2llV2F0Y2hlci50aGlzLnByb2Nlc3NSZXN1\nbHQocmMsIHBhdGgsIGN0eCwgY2hpbGRyZW4pOwogICAgICAgICAgICAgICAg\nICAgIHF1ZXVlLnB1dChyYyk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAg\nbG9nZ2VyLmVycm9yKCJJbnRlcnJ1cGVkIHdoZW4gdHJ5aW5nIHRvIHJlYWQg\nYm9va2llcyBpbiBhIGJsb2NraW5nIGZhc2hpb24iKTsKICAgICAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihlKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAg\nIGludCByYyA9IHF1ZXVlLnRha2UoKTsKCiAgICAgICAgaWYgKHJjICE9IEtl\nZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsKICAgICAgICAg\nICAgdGhyb3cgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShDb2RlLmdldChyYykp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdyYXBwZXIgb3Zl\nciB0aGUge0BsaW5rICNnZXRBZGRpdGlvbmFsQm9va2llcyhTZXQsIGludCl9\nIG1ldGhvZCB3aGVuIHRoZXJlIGlzIG5vIGV4Y2x1c2lvbiBsaXN0IChvciBl\neGlzaXRpbmcgYm9va2llcykKICAgICAqIEBwYXJhbSBudW1Cb29raWVzTmVl\nZGVkCiAgICAgKiBAcmV0dXJuCiAgICAgKiBAdGhyb3dzIEJLTm90RW5vdWdo\nQm9va2llc0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgQXJyYXlMaXN0\nPEluZXRTb2NrZXRBZGRyZXNzPiBnZXROZXdCb29raWVzKGludCBudW1Cb29r\naWVzTmVlZGVkKSB0aHJvd3MgQktOb3RFbm91Z2hCb29raWVzRXhjZXB0aW9u\nIHsKICAgICAgICByZXR1cm4gZ2V0QWRkaXRpb25hbEJvb2tpZXMoRU1QVFlf\nU0VULCBudW1Cb29raWVzTmVlZGVkKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdyYXBwZXIgb3ZlciB0aGUge0BsaW5rICNnZXRBZGRpdGlvbmFsQm9va2ll\ncyhTZXQsIGludCl9IG1ldGhvZCB3aGVuIHlvdSBqdXN0IG5lZWQgMSBleHRy\nYSBib29raWUKICAgICAqIEBwYXJhbSBleGlzdGluZ0Jvb2tpZXMKICAgICAq\nIEByZXR1cm4KICAgICAqIEB0aHJvd3MgQktOb3RFbm91Z2hCb29raWVzRXhj\nZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBJbmV0U29ja2V0QWRkcmVzcyBn\nZXRBZGRpdGlvbmFsQm9va2llKExpc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGV4\naXN0aW5nQm9va2llcykKICAgICAgICAgICAgdGhyb3dzIEJLTm90RW5vdWdo\nQm9va2llc0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGdldEFkZGl0aW9u\nYWxCb29raWVzKG5ldyBIYXNoU2V0PEluZXRTb2NrZXRBZGRyZXNzPihleGlz\ndGluZ0Jvb2tpZXMpLCAxKS5nZXQoMCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm5zIGFkZGl0aW9uYWwgYm9va2llcyBnaXZlbiBhbiBleGNsdXNp\nb24gbGlzdCBhbmQgaG93IG1hbnkgYXJlIG5lZWRlZAogICAgICogQHBhcmFt\nIGV4aXN0aW5nQm9va2llcwogICAgICogQHBhcmFtIG51bUFkZGl0aW9uYWxC\nb29raWVzTmVlZGVkCiAgICAgKiBAcmV0dXJuCiAgICAgKiBAdGhyb3dzIEJL\nTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMg\nQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBnZXRBZGRpdGlvbmFsQm9v\na2llcyhTZXQ8SW5ldFNvY2tldEFkZHJlc3M+IGV4aXN0aW5nQm9va2llcywK\nICAgICAgICAgICAgaW50IG51bUFkZGl0aW9uYWxCb29raWVzTmVlZGVkKSB0\naHJvd3MgQktOb3RFbm91Z2hCb29raWVzRXhjZXB0aW9uIHsKCiAgICAgICAg\nQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPiBuZXdCb29raWVzID0gbmV3\nIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVzcz4oKTsKCiAgICAgICAgaWYg\nKG51bUFkZGl0aW9uYWxCb29raWVzTmVlZGVkIDw9IDApIHsKICAgICAgICAg\nICAgcmV0dXJuIG5ld0Jvb2tpZXM7CiAgICAgICAgfQoKICAgICAgICBMaXN0\nPEluZXRTb2NrZXRBZGRyZXNzPiBhbGxCb29raWVzOwoKICAgICAgICBzeW5j\naHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAgYWxsQm9va2llcyA9IG5l\ndyBBcnJheUxpc3Q8SW5ldFNvY2tldEFkZHJlc3M+KGtub3duQm9va2llcyk7\nCiAgICAgICAgfQoKICAgICAgICBDb2xsZWN0aW9ucy5zaHVmZmxlKGFsbEJv\nb2tpZXMpOwoKICAgICAgICBmb3IgKEluZXRTb2NrZXRBZGRyZXNzIGJvb2tp\nZSA6IGFsbEJvb2tpZXMpIHsKICAgICAgICAgICAgaWYgKGV4aXN0aW5nQm9v\na2llcy5jb250YWlucyhib29raWUpKSB7CiAgICAgICAgICAgICAgICBjb250\naW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV3Qm9va2llcy5h\nZGQoYm9va2llKTsKICAgICAgICAgICAgbnVtQWRkaXRpb25hbEJvb2tpZXNO\nZWVkZWQtLTsKCiAgICAgICAgICAgIGlmIChudW1BZGRpdGlvbmFsQm9va2ll\nc05lZWRlZCA9PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Qm9v\na2llczsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhyb3cg\nbmV3IEJLTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbigpOwogICAgfQoKfQo=\n","encoding":"base64"}

