{"sha":"8c5bce3af10561c7f74c49f8a733c780567884b5","node_id":"MDQ6QmxvYjE1NzU5NTY6OGM1YmNlM2FmMTA1NjFjN2Y3NGM0OWY4YTczM2M3ODA1Njc4ODRiNQ==","size":4842,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8c5bce3af10561c7f74c49f8a733c780567884b5","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQ7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0Lklu\nZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS5zZWN1cml0eS5HZW5lcmFs\nU2VjdXJpdHlFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0Nh\nbGxiYWNrLkNyZWF0ZUNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5CS0V4Y2VwdGlvbi5CS05vdEVub3VnaEJvb2tpZXNF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50\nLkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5wcm90by5Cb29ra2VlcGVySW50ZXJuYWxDYWxsYmFja3MuR2Vu\nZXJpY0NhbGxiYWNrOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS56\nb29rZWVwZXIuS2VlcGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56\nb29rZWVwZXIuZGF0YS5TdGF0OwoKLyoqCiAqIEVuY2Fwc3VsYXRlcyBhc3lu\nY2hyb25vdXMgbGVkZ2VyIGNyZWF0ZSBvcGVyYXRpb24KICoKICovCmNsYXNz\nIExlZGdlckNyZWF0ZU9wIGltcGxlbWVudHMgR2VuZXJpY0NhbGxiYWNrPFN0\ncmluZz4gewoKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2Vy\nRmFjdG9yeS5nZXRMb2dnZXIoTGVkZ2VyQ3JlYXRlT3AuY2xhc3MpOwoKICAg\nIENyZWF0ZUNhbGxiYWNrIGNiOwogICAgTGVkZ2VyTWV0YWRhdGEgbWV0YWRh\ndGE7CiAgICBMZWRnZXJIYW5kbGUgbGg7CiAgICBPYmplY3QgY3R4OwogICAg\nYnl0ZVtdIHBhc3N3ZDsKICAgIEJvb2tLZWVwZXIgYms7CiAgICBEaWdlc3RU\neXBlIGRpZ2VzdFR5cGU7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcgog\nICAgICoKICAgICAqIEBwYXJhbSBiawogICAgICogICAgICAgQm9va0tlZXBl\nciBvYmplY3QKICAgICAqIEBwYXJhbSBlbnNlbWJsZVNpemUKICAgICAqICAg\nICAgIGVuc2VtYmxlIHNpemUKICAgICAqIEBwYXJhbSBxdW9ydW1TaXplCiAg\nICAgKiAgICAgICBxdW9ydW0gc2l6ZQogICAgICogQHBhcmFtIGRpZ2VzdFR5\ncGUKICAgICAqICAgICAgIGRpZ2VzdCB0eXBlLCBlaXRoZXIgTUFDIG9yIENS\nQzMyCiAgICAgKiBAcGFyYW0gcGFzc3dkCiAgICAgKiAgICAgICBwYXNzb3dy\nZAogICAgICogQHBhcmFtIGNiCiAgICAgKiAgICAgICBjYWxsYmFjayBpbXBs\nZW1lbnRhdGlvbgogICAgICogQHBhcmFtIGN0eAogICAgICogICAgICAgb3B0\naW9uYWwgY29udHJvbCBvYmplY3QKICAgICAqLwoKICAgIExlZGdlckNyZWF0\nZU9wKEJvb2tLZWVwZXIgYmssIGludCBlbnNlbWJsZVNpemUsIGludCBxdW9y\ndW1TaXplLCBEaWdlc3RUeXBlIGRpZ2VzdFR5cGUsIGJ5dGVbXSBwYXNzd2Qs\nIENyZWF0ZUNhbGxiYWNrIGNiLCBPYmplY3QgY3R4KSB7CiAgICAgICAgdGhp\ncy5iayA9IGJrOwogICAgICAgIHRoaXMubWV0YWRhdGEgPSBuZXcgTGVkZ2Vy\nTWV0YWRhdGEoZW5zZW1ibGVTaXplLCBxdW9ydW1TaXplKTsKICAgICAgICB0\naGlzLmRpZ2VzdFR5cGUgPSBkaWdlc3RUeXBlOwogICAgICAgIHRoaXMucGFz\nc3dkID0gcGFzc3dkOwogICAgICAgIHRoaXMuY2IgPSBjYjsKICAgICAgICB0\naGlzLmN0eCA9IGN0eDsKICAgIH0KCiAgICAvKioKICAgICAqIEluaXRpYXRl\ncyB0aGUgb3BlcmF0aW9uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGluaXRp\nYXRlKCkgewogICAgICAgIC8vIGFsbG9jYXRlIGVuc2VtYmxlIGZpcnN0Cgog\nICAgICAgIC8qCiAgICAgICAgICogQWRkaW5nIGJvb2tpZXMgdG8gbGVkZ2Vy\nIGhhbmRsZQogICAgICAgICAqLwoKICAgICAgICBBcnJheUxpc3Q8SW5ldFNv\nY2tldEFkZHJlc3M+IGVuc2VtYmxlOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGVuc2VtYmxlID0gYmsuYm9va2llV2F0Y2hlci5nZXROZXdCb29raWVz\nKG1ldGFkYXRhLmVuc2VtYmxlU2l6ZSk7CiAgICAgICAgfSBjYXRjaCAoQktO\nb3RFbm91Z2hCb29raWVzRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9H\nLmVycm9yKCJOb3QgZW5vdWdoIGJvb2tpZXMgdG8gY3JlYXRlIGxlZGdlciIp\nOwogICAgICAgICAgICBjYi5jcmVhdGVDb21wbGV0ZShlLmdldENvZGUoKSwg\nbnVsbCwgdGhpcy5jdHgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nfQoKICAgICAgICAvKgogICAgICAgICAqIEFkZCBlbnNlbWJsZSB0byB0aGUg\nY29uZmlndXJhdGlvbgogICAgICAgICAqLwogICAgICAgIG1ldGFkYXRhLmFk\nZEVuc2VtYmxlKDBMLCBlbnNlbWJsZSk7CgogICAgICAgIC8vIGNyZWF0ZSBh\nIGxlZGdlciBwYXRoIHdpdGggbWV0YWRhdGEKICAgICAgICBiay5nZXRMZWRn\nZXJNYW5hZ2VyKCkubmV3TGVkZ2VyUGF0aCh0aGlzLCBtZXRhZGF0YSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDYWxsYmFjayB3aGVuIGNyZWF0ZWQgbGVk\nZ2VyIHBhdGguCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgb3BlcmF0aW9uQ29tcGxldGUoaW50IHJjLCBTdHJpbmcgbGVkZ2VyUGF0\naCkgewoKICAgICAgICBpZiAocmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUu\nT0suaW50VmFsdWUoKSkgewogICAgICAgICAgICBMT0cuZXJyb3IoIkNvdWxk\nIG5vdCBjcmVhdGUgbm9kZSBmb3IgbGVkZ2VyIiwKICAgICAgICAgICAgICAg\nICAgICAgIEtlZXBlckV4Y2VwdGlvbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9u\nLkNvZGUuZ2V0KHJjKSwgbGVkZ2VyUGF0aCkpOwogICAgICAgICAgICBjYi5j\ncmVhdGVDb21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uLCBu\ndWxsLCB0aGlzLmN0eCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCgogICAgICAgIC8qCiAgICAgICAgICogRXh0cmFjdCBsZWRnZXIgaWQuCiAg\nICAgICAgICovCiAgICAgICAgbG9uZyBsZWRnZXJJZDsKICAgICAgICB0cnkg\newogICAgICAgICAgICBsZWRnZXJJZCA9IGJrLmdldExlZGdlck1hbmFnZXIo\nKS5nZXRMZWRnZXJJZChsZWRnZXJQYXRoKTsKICAgICAgICB9IGNhdGNoIChJ\nT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiQ291bGQg\nbm90IGV4dHJhY3QgbGVkZ2VyLWlkIGZyb20gcGF0aDoiICsgbGVkZ2VyUGF0\naCwgZSk7CiAgICAgICAgICAgIGNiLmNyZWF0ZUNvbXBsZXRlKEJLRXhjZXB0\naW9uLkNvZGUuWktFeGNlcHRpb24sIG51bGwsIHRoaXMuY3R4KTsKICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgbGggPSBuZXcgTGVkZ2VySGFuZGxlKGJrLCBsZWRnZXJJZCwgbWV0\nYWRhdGEsIGRpZ2VzdFR5cGUsIHBhc3N3ZCk7CiAgICAgICAgfSBjYXRjaCAo\nR2VuZXJhbFNlY3VyaXR5RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9H\nLmVycm9yKCJTZWN1cml0eSBleGNlcHRpb24gd2hpbGUgY3JlYXRpbmcgbGVk\nZ2VyOiAiICsgbGVkZ2VySWQsIGUpOwogICAgICAgICAgICBjYi5jcmVhdGVD\nb21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLkRpZ2VzdE5vdEluaXRpYWxpemVk\nRXhjZXB0aW9uLCBudWxsLCB0aGlzLmN0eCk7CiAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkg\newogICAgICAgICAgICBMT0cuZXJyb3IoIkluY29ycmVjdGx5IGVudGVyZWQg\ncGFyYW1ldGVyIHRocm90dGxlOiAiICsgYmsuZ2V0Q29uZigpLmdldFRocm90\ndGxlVmFsdWUoKSwgZSk7CiAgICAgICAgICAgIGNiLmNyZWF0ZUNvbXBsZXRl\nKEJLRXhjZXB0aW9uLkNvZGUuSW5jb3JyZWN0UGFyYW1ldGVyRXhjZXB0aW9u\nLCBudWxsLCB0aGlzLmN0eCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICB9CgogICAgICAgIC8vIHJldHVybiB0aGUgbGVkZ2VyIGhhbmRsZSBiYWNr\nCiAgICAgICAgY2IuY3JlYXRlQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5P\nSywgbGgsIHRoaXMuY3R4KTsKICAgIH0KCn0K\n","encoding":"base64"}

