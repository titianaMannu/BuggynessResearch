{"sha":"fd4ff032c30a97d6a8ca7bf3f2fd7a2fa2d6551e","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmQ0ZmYwMzJjMzBhOTdkNmE4Y2E3YmYzZjJmZDdhMmZhMmQ2NTUxZQ==","size":34272,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fd4ff032c30a97d6a8ca7bf3f2fd7a2fa2d6551e","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0Lklu\nZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS5zZWN1cml0eS5HZW5lcmFs\nU2VjdXJpdHlFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVu\ndC5Db25jdXJyZW50TGlua2VkUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRpbC5RdWV1ZTsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlNlbWFwaG9yZTsKCmltcG9ydCBv\ncmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suUmVh\nZExhc3RDb25maXJtZWRDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2FsbGJhY2suQWRkQ2FsbGJhY2s7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkFzeW5jQ2Fs\nbGJhY2suQ2xvc2VDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jbGllbnQuQXN5bmNDYWxsYmFjay5SZWFkQ2FsbGJhY2s7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uLkJL\nTm90RW5vdWdoQm9va2llc0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RUeXBlOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJNZXRhZGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90by5Cb29ra2Vl\ncGVySW50ZXJuYWxDYWxsYmFja3MuR2VuZXJpY0NhbGxiYWNrOwppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2tpZVByb3RvY29sOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwuU2FmZVJ1bm5hYmxl\nOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5L\nZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5B\nc3luY0NhbGxiYWNrLlN0YXRDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\nem9va2VlcGVyLkFzeW5jQ2FsbGJhY2suRGF0YUNhbGxiYWNrOwppbXBvcnQg\nb3JnLmFwYWNoZS56b29rZWVwZXIuZGF0YS5TdGF0OwppbXBvcnQgb3JnLmpi\nb3NzLm5ldHR5LmJ1ZmZlci5DaGFubmVsQnVmZmVyOwoKLyoqCiAqIExlZGdl\nciBoYW5kbGUgY29udGFpbnMgbGVkZ2VyIG1ldGFkYXRhIGFuZCBpcyB1c2Vk\nIHRvIGFjY2VzcyB0aGUgcmVhZCBhbmQKICogd3JpdGUgb3BlcmF0aW9ucyB0\nbyBhIGxlZGdlci4KICovCnB1YmxpYyBjbGFzcyBMZWRnZXJIYW5kbGUgewog\nICAgZmluYWwgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihMZWRnZXJIYW5kbGUuY2xhc3MpOwoKICAgIGZpbmFsIGJ5dGVb\nXSBsZWRnZXJLZXk7CiAgICBMZWRnZXJNZXRhZGF0YSBtZXRhZGF0YTsKICAg\nIGZpbmFsIEJvb2tLZWVwZXIgYms7CiAgICBmaW5hbCBsb25nIGxlZGdlcklk\nOwogICAgbG9uZyBsYXN0QWRkUHVzaGVkOwogICAgbG9uZyBsYXN0QWRkQ29u\nZmlybWVkOwogICAgbG9uZyBsZW5ndGg7CiAgICBmaW5hbCBEaWdlc3RNYW5h\nZ2VyIG1hY01hbmFnZXI7CiAgICBmaW5hbCBEaXN0cmlidXRpb25TY2hlZHVs\nZSBkaXN0cmlidXRpb25TY2hlZHVsZTsKCiAgICBmaW5hbCBTZW1hcGhvcmUg\nb3BDb3VudGVyU2VtOwogICAgcHJpdmF0ZSBmaW5hbCBJbnRlZ2VyIHRocm90\ndGxpbmc7CgogICAgLyoqCiAgICAgKiBJbnZhbGlkIGVudHJ5IGlkLiBUaGlz\nIHZhbHVlIGlzIHJldHVybmVkIGZyb20gbWV0aG9kcyB3aGljaAogICAgICog\nc2hvdWxkIHJldHVybiBhbiBlbnRyeSBpZCBidXQgdGhlcmUgaXMgbm8gdmFs\naWQgZW50cnkgYXZhaWxhYmxlLgogICAgICovCiAgICBmaW5hbCBzdGF0aWMg\ncHVibGljIGxvbmcgSU5WQUxJRF9FTlRSWV9JRCA9IEJvb2tpZVByb3RvY29s\nLklOVkFMSURfRU5UUllfSUQ7CgogICAgZmluYWwgUXVldWU8UGVuZGluZ0Fk\nZE9wPiBwZW5kaW5nQWRkT3BzID0gbmV3IENvbmN1cnJlbnRMaW5rZWRRdWV1\nZTxQZW5kaW5nQWRkT3A+KCk7CgogICAgTGVkZ2VySGFuZGxlKEJvb2tLZWVw\nZXIgYmssIGxvbmcgbGVkZ2VySWQsIExlZGdlck1ldGFkYXRhIG1ldGFkYXRh\nLAogICAgICAgICAgICAgICAgIERpZ2VzdFR5cGUgZGlnZXN0VHlwZSwgYnl0\nZVtdIHBhc3N3b3JkKQogICAgICAgICAgICB0aHJvd3MgR2VuZXJhbFNlY3Vy\naXR5RXhjZXB0aW9uLCBOdW1iZXJGb3JtYXRFeGNlcHRpb24gewogICAgICAg\nIHRoaXMuYmsgPSBiazsKICAgICAgICB0aGlzLm1ldGFkYXRhID0gbWV0YWRh\ndGE7CgogICAgICAgIGlmIChtZXRhZGF0YS5pc0Nsb3NlZCgpKSB7CiAgICAg\nICAgICAgIGxhc3RBZGRDb25maXJtZWQgPSBsYXN0QWRkUHVzaGVkID0gbWV0\nYWRhdGEuY2xvc2U7CiAgICAgICAgICAgIGxlbmd0aCA9IG1ldGFkYXRhLmxl\nbmd0aDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsYXN0QWRkQ29u\nZmlybWVkID0gbGFzdEFkZFB1c2hlZCA9IElOVkFMSURfRU5UUllfSUQ7CiAg\nICAgICAgICAgIGxlbmd0aCA9IDA7CiAgICAgICAgfQoKICAgICAgICB0aGlz\nLmxlZGdlcklkID0gbGVkZ2VySWQ7CgogICAgICAgIHRoaXMudGhyb3R0bGlu\nZyA9IGJrLmdldENvbmYoKS5nZXRUaHJvdHRsZVZhbHVlKCk7CiAgICAgICAg\ndGhpcy5vcENvdW50ZXJTZW0gPSBuZXcgU2VtYXBob3JlKHRocm90dGxpbmcp\nOwoKICAgICAgICBtYWNNYW5hZ2VyID0gRGlnZXN0TWFuYWdlci5pbnN0YW50\naWF0ZShsZWRnZXJJZCwgcGFzc3dvcmQsIGRpZ2VzdFR5cGUpOwogICAgICAg\nIHRoaXMubGVkZ2VyS2V5ID0gTWFjRGlnZXN0TWFuYWdlci5nZW5EaWdlc3Qo\nImxlZGdlciIsIHBhc3N3b3JkKTsKICAgICAgICBkaXN0cmlidXRpb25TY2hl\nZHVsZSA9IG5ldyBSb3VuZFJvYmluRGlzdHJpYnV0aW9uU2NoZWR1bGUoCiAg\nICAgICAgICAgIG1ldGFkYXRhLnF1b3J1bVNpemUsIG1ldGFkYXRhLmVuc2Vt\nYmxlU2l6ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhlIGlkIG9m\nIHRoZSBjdXJyZW50IGxlZGdlcgogICAgICoKICAgICAqIEByZXR1cm4gdGhl\nIGlkIG9mIHRoZSBsZWRnZXIKICAgICAqLwogICAgcHVibGljIGxvbmcgZ2V0\nSWQoKSB7CiAgICAgICAgcmV0dXJuIGxlZGdlcklkOwogICAgfQoKICAgIC8q\nKgogICAgICogR2V0IHRoZSBsYXN0IGNvbmZpcm1lZCBlbnRyeSBpZCBvbiB0\naGlzIGxlZGdlci4gSXQgcmVhZHMKICAgICAqIHRoZSBsb2NhbCBzdGF0ZSBv\nZiB0aGUgbGVkZ2VyIGhhbmRsZSwgd2hpY2ggaXMgZGlmZmVyZW50CiAgICAg\nKiBmcm9tIHRoZSByZWFkTGFzdENvbmZpcm1lZCBjYWxsLiBJbiB0aGUgY2Fz\nZSB0aGUgbGVkZ2VyCiAgICAgKiBpcyBub3QgY2xvc2VkIGFuZCB0aGUgY2xp\nZW50IGlzIGEgcmVhZGVyLCBpdCBpcyBuZWNlc3NhcnkKICAgICAqIHRvIGNh\nbGwgcmVhZExhc3RDb25maXJtZWQgdG8gb2J0YWluIGFuIGVzdGltYXRlIG9m\nIHRoZQogICAgICogbGFzdCBhZGQgb3BlcmF0aW9uIHRoYXQgaGFzIGJlZW4g\nY29uZmlybWVkLgogICAgICoKICAgICAqIEBzZWUgI3JlYWRMYXN0Q29uZmly\nbWVkKCkKICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBsYXN0IGNvbmZpcm1l\nZCBlbnRyeSBpZCBvciB7QGxpbmsgI0lOVkFMSURfRU5UUllfSUQgSU5WQUxJ\nRF9FTlRSWV9JRH0gaWYgbm8gZW50cnkgaGFzIGJlZW4gY29uZmlybWVkCiAg\nICAgKi8KICAgIHB1YmxpYyBsb25nIGdldExhc3RBZGRDb25maXJtZWQoKSB7\nCiAgICAgICAgcmV0dXJuIGxhc3RBZGRDb25maXJtZWQ7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBHZXQgdGhlIGVudHJ5IGlkIG9mIHRoZSBsYXN0IGVudHJ5\nIHRoYXQgaGFzIGJlZW4gZW5xdWV1ZWQgZm9yIGFkZGl0aW9uIChidXQKICAg\nICAqIG1heSBub3QgaGF2ZSBwb3NzaWJseSBiZWVuIHBlcnNpdGVkIHRvIHRo\nZSBsZWRnZXIpCiAgICAgKgogICAgICogQHJldHVybiB0aGUgaWQgb2YgdGhl\nIGxhc3QgZW50cnkgcHVzaGVkIG9yIHtAbGluayAjSU5WQUxJRF9FTlRSWV9J\nRCBJTlZBTElEX0VOVFJZX0lEfSBpZiBubyBlbnRyeSBoYXMgYmVlbiBwdXNo\nZWQKICAgICAqLwogICAgc3luY2hyb25pemVkIHB1YmxpYyBsb25nIGdldExh\nc3RBZGRQdXNoZWQoKSB7CiAgICAgICAgcmV0dXJuIGxhc3RBZGRQdXNoZWQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhlIExlZGdlcidzIGtleS9w\nYXNzd29yZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIGJ5dGUgYXJyYXkgZm9y\nIHRoZSBsZWRnZXIncyBrZXkvcGFzc3dvcmQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBieXRlW10gZ2V0TGVkZ2VyS2V5KCkgewogICAgICAgIHJldHVybiBBcnJh\neXMuY29weU9mKGxlZGdlcktleSwgbGVkZ2VyS2V5Lmxlbmd0aCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBHZXQgdGhlIExlZGdlck1ldGFkYXRhCiAgICAg\nKgogICAgICogQHJldHVybiBMZWRnZXJNZXRhZGF0YSBmb3IgdGhlIExlZGdl\nckhhbmRsZQogICAgICovCiAgICBMZWRnZXJNZXRhZGF0YSBnZXRMZWRnZXJN\nZXRhZGF0YSgpIHsKICAgICAgICByZXR1cm4gbWV0YWRhdGE7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBHZXQgdGhlIERpZ2VzdE1hbmFnZXIKICAgICAqCiAg\nICAgKiBAcmV0dXJuIERpZ2VzdE1hbmFnZXIgZm9yIHRoZSBMZWRnZXJIYW5k\nbGUKICAgICAqLwogICAgRGlnZXN0TWFuYWdlciBnZXREaWdlc3RNYW5hZ2Vy\nKCkgewogICAgICAgIHJldHVybiBtYWNNYW5hZ2VyOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRvdGFsIG51bWJlciBvZiBhdmFpbGFibGUgc2xv\ndHMuCiAgICAgKgogICAgICogQHJldHVybiBpbnQgICAgYXZhaWxhYmxlIHNs\nb3RzCiAgICAgKi8KICAgIFNlbWFwaG9yZSBnZXRBdmFpbGFibGVQZXJtaXRz\nKCkgewogICAgICAgIHJldHVybiB0aGlzLm9wQ291bnRlclNlbTsKICAgIH0K\nCiAgICAvKioKICAgICAqICBBZGQgdG8gdGhlIGxlbmd0aCBvZiB0aGUgbGVk\nZ2VyIGluIGJ5dGVzLgogICAgICoKICAgICAqIEBwYXJhbSBkZWx0YQogICAg\nICogQHJldHVybgogICAgICovCiAgICBsb25nIGFkZFRvTGVuZ3RoKGxvbmcg\nZGVsdGEpIHsKICAgICAgICB0aGlzLmxlbmd0aCArPSBkZWx0YTsKICAgICAg\nICByZXR1cm4gdGhpcy5sZW5ndGg7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm5zIHRoZSBsZW5ndGggb2YgdGhlIGxlZGdlciBpbiBieXRlcy4KICAg\nICAqCiAgICAgKiBAcmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIGxlZGdlciBp\nbiBieXRlcwogICAgICovCiAgICBzeW5jaHJvbml6ZWQgcHVibGljIGxvbmcg\nZ2V0TGVuZ3RoKCkgewogICAgICAgIHJldHVybiB0aGlzLmxlbmd0aDsKICAg\nIH0KCiAgICAvKioKICAgICAqIEdldCB0aGUgRGlzdHJpYnV0aW9uIFNjaGVk\ndWxlCiAgICAgKgogICAgICogQHJldHVybiBEaXN0cmlidXRpb25TY2hlZHVs\nZSBmb3IgdGhlIExlZGdlckhhbmRsZQogICAgICovCiAgICBEaXN0cmlidXRp\nb25TY2hlZHVsZSBnZXREaXN0cmlidXRpb25TY2hlZHVsZSgpIHsKICAgICAg\nICByZXR1cm4gZGlzdHJpYnV0aW9uU2NoZWR1bGU7CiAgICB9CgogICAgdm9p\nZCB3cml0ZUxlZGdlckNvbmZpZyhTdGF0Q2FsbGJhY2sgY2FsbGJhY2ssIE9i\namVjdCBjdHgpIHsKICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkp\nIHsKICAgICAgICAgICAgTE9HLmRlYnVnKCJXcml0aW5nIG1ldGFkYXRhIHRv\nIFpvb0tlZXBlcjogIiArIHRoaXMubGVkZ2VySWQgKyAiLCAiICsgbWV0YWRh\ndGEuZ2V0Wm5vZGVWZXJzaW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgYmsu\nZ2V0WmtIYW5kbGUoKS5zZXREYXRhKGJrLmdldExlZGdlck1hbmFnZXIoKS5n\nZXRMZWRnZXJQYXRoKGxlZGdlcklkKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbWV0YWRhdGEuc2VyaWFsaXplKCksIG1ldGFkYXRhLmdl\ndFpub2RlVmVyc2lvbigpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBjYWxsYmFjaywgY3R4KTsKICAgIH0KCiAgICAvKioKICAgICAqIENs\nb3NlIHRoaXMgbGVkZ2VyIHN5bmNocm9ub3VzbHkuCiAgICAgKiBAc2VlICNh\nc3luY0Nsb3NlCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgCiAg\nICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgQktFeGNl\ncHRpb24gewogICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIgPSBuZXcgU3lu\nY0NvdW50ZXIoKTsKICAgICAgICBjb3VudGVyLmluYygpOwoKICAgICAgICBh\nc3luY0Nsb3NlKG5ldyBTeW5jQ2xvc2VDYWxsYmFjaygpLCBjb3VudGVyKTsK\nCiAgICAgICAgY291bnRlci5ibG9jaygwKTsKICAgICAgICBpZiAoY291bnRl\nci5nZXRyYygpICE9IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAgICAg\nICAgdGhyb3cgQktFeGNlcHRpb24uY3JlYXRlKGNvdW50ZXIuZ2V0cmMoKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQXN5bmNocm9ub3Vz\nIGNsb3NlLCBhbnkgYWRkcyBpbiBmbGlnaHQgd2lsbCByZXR1cm4gZXJyb3Jz\nLgogICAgICogCiAgICAgKiBDbG9zaW5nIGEgbGVkZ2VyIHdpbGwgZW5zdXJl\nIHRoYXQgYWxsIGNsaWVudHMgYWdyZWUgb24gd2hhdCB0aGUgbGFzdCBlbnRy\neSAKICAgICAqIG9mIHRoZSBsZWRnZXIgaXMuIFRoaXMgZW5zdXJlcyB0aGF0\nLCBvbmNlIHRoZSBsZWRnZXIgaGFzIGJlZW4gY2xvc2VkLCBhbGwgCiAgICAg\nKiByZWFkcyBmcm9tIHRoZSBsZWRnZXIgd2lsbCByZXR1cm4gdGhlIHNhbWUg\nc2V0IG9mIGVudHJpZXMuIAogICAgICogCiAgICAgKiBAcGFyYW0gY2IKICAg\nICAqICAgICAgICAgIGNhbGxiYWNrIGltcGxlbWVudGF0aW9uCiAgICAgKiBA\ncGFyYW0gY3R4CiAgICAgKiAgICAgICAgICBjb250cm9sIG9iamVjdAogICAg\nICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBhc3luY0Nsb3NlKENsb3NlQ2FsbGJhY2sgY2IsIE9iamVj\ndCBjdHgpIHsKICAgICAgICBhc3luY0Nsb3NlSW50ZXJuYWwoY2IsIGN0eCwg\nQktFeGNlcHRpb24uQ29kZS5MZWRnZXJDbG9zZWRFeGNlcHRpb24pOwogICAg\nfQoKICAgIC8qKgogICAgICogU2FtZSBhcyBwdWJsaWMgdmVyc2lvbiBvZiBh\nc3luY0Nsb3NlIGV4Y2VwdCB0aGF0IHRoaXMgb25lIHRha2VzIGFuCiAgICAg\nKiBhZGRpdGlvbmFsIHBhcmFtZXRlciB3aGljaCBpcyB0aGUgcmV0dXJuIGNv\nZGUgdG8gaGFuZCB0byBhbGwgdGhlIHBlbmRpbmcKICAgICAqIGFkZCBvcHMK\nICAgICAqCiAgICAgKiBAcGFyYW0gY2IKICAgICAqIEBwYXJhbSBjdHgKICAg\nICAqIEBwYXJhbSByYwogICAgICovCiAgICB2b2lkIGFzeW5jQ2xvc2VJbnRl\ncm5hbChmaW5hbCBDbG9zZUNhbGxiYWNrIGNiLCBmaW5hbCBPYmplY3QgY3R4\nLCBmaW5hbCBpbnQgcmMpIHsKICAgICAgICBiay5tYWluV29ya2VyUG9vbC5z\ndWJtaXRPcmRlcmVkKGxlZGdlcklkLCBuZXcgU2FmZVJ1bm5hYmxlKCkgewog\nICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2FmZVJ1bigpIHsKICAgICAgICAgICAgICAgIGZpbmFsIGxvbmcgcHJldkNs\nb3NlOwogICAgICAgICAgICAgICAgZmluYWwgbG9uZyBwcmV2TGVuZ3RoOwoK\nICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZChMZWRnZXJIYW5kbGUudGhp\ncykgewogICAgICAgICAgICAgICAgICAgIHByZXZDbG9zZSA9IG1ldGFkYXRh\nLmNsb3NlOwogICAgICAgICAgICAgICAgICAgIHByZXZMZW5ndGggPSBtZXRh\nZGF0YS5sZW5ndGg7CgogICAgICAgICAgICAgICAgICAgIC8vIHN5bmNocm9u\naXplZCBvbiBMZWRnZXJIYW5kbGUudGhpcyB0byBlbnN1cmUgdGhhdCAKICAg\nICAgICAgICAgICAgICAgICAvLyBsYXN0QWRkUHVzaGVkIGNhbiBub3QgYmUg\ndXBkYXRlZCBhZnRlciB0aGUgbWV0YWRhdGEgCiAgICAgICAgICAgICAgICAg\nICAgLy8gaXMgY2xvc2VkLiAKICAgICAgICAgICAgICAgICAgICBtZXRhZGF0\nYS5sZW5ndGggPSBsZW5ndGg7CgogICAgICAgICAgICAgICAgICAgIC8vIENs\nb3NlIG9wZXJhdGlvbiBpcyBpZGVtcG90ZW50LCBzbyBubyBuZWVkIHRvIGNo\nZWNrIGlmIHdlIGFyZQogICAgICAgICAgICAgICAgICAgIC8vIGFscmVhZHkg\nY2xvc2VkCiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEuY2xvc2UobGFz\ndEFkZENvbmZpcm1lZCk7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JPdXRQ\nZW5kaW5nQWRkcyhyYyk7CiAgICAgICAgICAgICAgICAgICAgbGFzdEFkZFB1\nc2hlZCA9IGxhc3RBZGRDb25maXJtZWQ7CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJDbG9zaW5nIGxlZGdlcjog\nIiArIGxlZGdlcklkICsgIiBhdCBlbnRyeUlkOiAiCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICsgbWV0YWRhdGEuY2xvc2UgKyAiIHdpdGggdGhp\ncyBtYW55IGJ5dGVzOiAiICsgbWV0YWRhdGEubGVuZ3RoKTsKICAgICAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgICAgICBmaW5hbCBjbGFzcyBDbG9zZUNi\nIGltcGxlbWVudHMgU3RhdENhbGxiYWNrIHsKICAgICAgICAgICAgICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBw\ncm9jZXNzUmVzdWx0KGZpbmFsIGludCByYywgU3RyaW5nIHBhdGgsIE9iamVj\ndCBzdWJjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBmaW5hbCBTdGF0IHN0YXQpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKHJjID09IEtlZXBlckV4Y2VwdGlvbi5Db2RlLkJhZFZl\ncnNpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcmVhZE1l\ndGFkYXRhKG5ldyBHZW5lcmljQ2FsbGJhY2s8TGVkZ2VyTWV0YWRhdGE+KCkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIG9w\nZXJhdGlvbkNvbXBsZXRlKGludCBuZXdyYywgTGVkZ2VyTWV0YWRhdGEgbmV3\nTWV0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nZiAobmV3cmMgIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJv\nciByZWFkaW5nIG5ldyBtZXRhZGF0YSBmcm9tIGxlZGdlciAiICsgbGVkZ2Vy\nSWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICArICIgd2hlbiBjbG9zaW5nLCBjb2RlPSIgKyBuZXdyYyk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYi5jbG9z\nZUNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNlcHRpb24sIExlZGdl\nckhhbmRsZS50aGlzLCBjdHgpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbWV0YWRhdGEuY2xvc2UocHJldkNsb3NlKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRh\nLmxlbmd0aCA9IHByZXZMZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEucmVzb2x2ZUNvbmZsaWN0\nKG5ld01ldGEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgbWV0YWRhdGEubGVuZ3RoID0gbGVuZ3RoOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRh\nLmNsb3NlKGxhc3RBZGRDb25maXJtZWQpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlTGVkZ2VyQ29uZmlnKG5l\ndyBDbG9zZUNiKCksIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEubGVuZ3Ro\nID0gbGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG1ldGFkYXRhLmNsb3NlKGxhc3RBZGRDb25maXJtZWQpOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExP\nRy53YXJuKCJDb25kaXRpb25hbCB3cml0ZSBmYWlsZWQ6ICIKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr\nIEtlZXBlckV4Y2VwdGlvbi5Db2RlLmdldChLZWVwZXJFeGNlcHRpb24uQ29k\nZS5CYWRWZXJzaW9uKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY2IuY2xvc2VDb21wbGV0ZShCS0V4Y2VwdGlvbi5D\nb2RlLlpLRXhjZXB0aW9uLCBMZWRnZXJIYW5kbGUudGhpcywgY3R4KTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJj\nICE9IEtlZXBlckV4Y2VwdGlvbi5Db2RlLk9LLmludFZhbHVlKCkpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJDb25kaXRpb25h\nbCB3cml0ZSBmYWlsZWQ6ICIgKyBLZWVwZXJFeGNlcHRpb24uQ29kZS5nZXQo\ncmMpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNiLmNsb3NlQ29t\ncGxldGUoQktFeGNlcHRpb24uQ29kZS5aS0V4Y2VwdGlvbiwgTGVkZ2VySGFu\nZGxlLnRoaXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGN0eCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS51cGRh\ndGVabm9kZVN0YXR1cyhzdGF0KTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGNiLmNsb3NlQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5PSywgTGVk\nZ2VySGFuZGxlLnRoaXMsIGN0eCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwoK\nICAgICAgICAgICAgICAgIHdyaXRlTGVkZ2VyQ29uZmlnKG5ldyBDbG9zZUNi\nKCksIG51bGwpOwoKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoK\nICAgIC8qKgogICAgICogUmVhZCBhIHNlcXVlbmNlIG9mIGVudHJpZXMgc3lu\nY2hyb25vdXNseS4KICAgICAqCiAgICAgKiBAcGFyYW0gZmlyc3RFbnRyeQog\nICAgICogICAgICAgICAgaWQgb2YgZmlyc3QgZW50cnkgb2Ygc2VxdWVuY2Ug\nKGluY2x1ZGVkKQogICAgICogQHBhcmFtIGxhc3RFbnRyeQogICAgICogICAg\nICAgICAgaWQgb2YgbGFzdCBlbnRyeSBvZiBzZXF1ZW5jZSAoaW5jbHVkZWQp\nCiAgICAgKgogICAgICovCiAgICBwdWJsaWMgRW51bWVyYXRpb248TGVkZ2Vy\nRW50cnk+IHJlYWRFbnRyaWVzKGxvbmcgZmlyc3RFbnRyeSwgbG9uZyBsYXN0\nRW50cnkpCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiwgQktFeGNlcHRpb24gewogICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIg\nPSBuZXcgU3luY0NvdW50ZXIoKTsKICAgICAgICBjb3VudGVyLmluYygpOwoK\nICAgICAgICBhc3luY1JlYWRFbnRyaWVzKGZpcnN0RW50cnksIGxhc3RFbnRy\neSwgbmV3IFN5bmNSZWFkQ2FsbGJhY2soKSwgY291bnRlcik7CgogICAgICAg\nIGNvdW50ZXIuYmxvY2soMCk7CiAgICAgICAgaWYgKGNvdW50ZXIuZ2V0cmMo\nKSAhPSBCS0V4Y2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgIHRocm93\nIEJLRXhjZXB0aW9uLmNyZWF0ZShjb3VudGVyLmdldHJjKCkpOwogICAgICAg\nIH0KCiAgICAgICAgcmV0dXJuIGNvdW50ZXIuZ2V0U2VxdWVuY2UoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlYWQgYSBzZXF1ZW5jZSBvZiBlbnRyaWVz\nIGFzeW5jaHJvbm91c2x5LgogICAgICoKICAgICAqIEBwYXJhbSBmaXJzdEVu\ndHJ5CiAgICAgKiAgICAgICAgICBpZCBvZiBmaXJzdCBlbnRyeSBvZiBzZXF1\nZW5jZQogICAgICogQHBhcmFtIGxhc3RFbnRyeQogICAgICogICAgICAgICAg\naWQgb2YgbGFzdCBlbnRyeSBvZiBzZXF1ZW5jZQogICAgICogQHBhcmFtIGNi\nCiAgICAgKiAgICAgICAgICBvYmplY3QgaW1wbGVtZW50aW5nIHJlYWQgY2Fs\nbGJhY2sgaW50ZXJmYWNlCiAgICAgKiBAcGFyYW0gY3R4CiAgICAgKiAgICAg\nICAgICBjb250cm9sIG9iamVjdAogICAgICovCiAgICBwdWJsaWMgdm9pZCBh\nc3luY1JlYWRFbnRyaWVzKGxvbmcgZmlyc3RFbnRyeSwgbG9uZyBsYXN0RW50\ncnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWRDYWxs\nYmFjayBjYiwgT2JqZWN0IGN0eCkgewogICAgICAgIC8vIExpdHRsZSBzYW5p\ndHkgY2hlY2sKICAgICAgICBpZiAoZmlyc3RFbnRyeSA8IDAgfHwgbGFzdEVu\ndHJ5ID4gbGFzdEFkZENvbmZpcm1lZAogICAgICAgICAgICAgICAgfHwgZmly\nc3RFbnRyeSA+IGxhc3RFbnRyeSkgewogICAgICAgICAgICBjYi5yZWFkQ29t\ncGxldGUoQktFeGNlcHRpb24uQ29kZS5SZWFkRXhjZXB0aW9uLCB0aGlzLCBu\ndWxsLCBjdHgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAg\nICAgICB0cnkgewogICAgICAgICAgICBuZXcgUGVuZGluZ1JlYWRPcCh0aGlz\nLCBmaXJzdEVudHJ5LCBsYXN0RW50cnksIGNiLCBjdHgpLmluaXRpYXRlKCk7\nCiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBjYi5yZWFkQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5J\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgdGhpcywgbnVsbCwgY3R4KTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgZW50cnkgc3luY2hyb25v\ndXNseSB0byBhbiBvcGVuIGxlZGdlci4KICAgICAqCiAgICAgKiBAcGFyYW0g\nZGF0YQogICAgICogICAgICAgICBhcnJheSBvZiBieXRlcyB0byBiZSB3cml0\ndGVuIHRvIHRoZSBsZWRnZXIKICAgICAqLwogICAgcHVibGljIHZvaWQgYWRk\nRW50cnkoYnl0ZVtdIGRhdGEpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiwgQktFeGNlcHRpb24gewogICAgICAgIGFkZEVudHJ5KGRhdGEsIDAsIGRh\ndGEubGVuZ3RoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBlbnRyeSBz\neW5jaHJvbm91c2x5IHRvIGFuIG9wZW4gbGVkZ2VyLgogICAgICoKICAgICAq\nIEBwYXJhbSBkYXRhCiAgICAgKiAgICAgICAgIGFycmF5IG9mIGJ5dGVzIHRv\nIGJlIHdyaXR0ZW4gdG8gdGhlIGxlZGdlcgogICAgICogQHBhcmFtIG9mZnNl\ndAogICAgICogICAgICAgICAgb2Zmc2V0IGZyb20gd2hpY2ggdG8gdGFrZSBi\neXRlcyBmcm9tIGRhdGEKICAgICAqIEBwYXJhbSBsZW5ndGgKICAgICAqICAg\nICAgICAgIG51bWJlciBvZiBieXRlcyB0byB0YWtlIGZyb20gZGF0YQogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBhZGRFbnRyeShieXRlW10gZGF0YSwgaW50\nIG9mZnNldCwgaW50IGxlbmd0aCkKICAgICAgICAgICAgdGhyb3dzIEludGVy\ncnVwdGVkRXhjZXB0aW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgTE9HLmRl\nYnVnKCJBZGRpbmcgZW50cnkge30iLCBkYXRhKTsKCiAgICAgICAgU3luY0Nv\ndW50ZXIgY291bnRlciA9IG5ldyBTeW5jQ291bnRlcigpOwogICAgICAgIGNv\ndW50ZXIuaW5jKCk7CgogICAgICAgIGFzeW5jQWRkRW50cnkoZGF0YSwgb2Zm\nc2V0LCBsZW5ndGgsIG5ldyBTeW5jQWRkQ2FsbGJhY2soKSwgY291bnRlcik7\nCiAgICAgICAgY291bnRlci5ibG9jaygwKTsKICAgICAgICAKICAgICAgICBp\nZiAoY291bnRlci5nZXRyYygpICE9IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsK\nICAgICAgICAgICAgdGhyb3cgQktFeGNlcHRpb24uY3JlYXRlKGNvdW50ZXIu\nZ2V0cmMoKSk7CiAgICAgICAgfQoKICAgICAgICBpZihjb3VudGVyLmdldHJj\nKCkgIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewogICAgICAgICAgICB0aHJv\ndyBCS0V4Y2VwdGlvbi5jcmVhdGUoY291bnRlci5nZXRyYygpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgZW50cnkgYXN5bmNocm9u\nb3VzbHkgdG8gYW4gb3BlbiBsZWRnZXIuCiAgICAgKgogICAgICogQHBhcmFt\nIGRhdGEKICAgICAqICAgICAgICAgIGFycmF5IG9mIGJ5dGVzIHRvIGJlIHdy\naXR0ZW4KICAgICAqIEBwYXJhbSBjYgogICAgICogICAgICAgICAgb2JqZWN0\nIGltcGxlbWVudGluZyBjYWxsYmFja2ludGVyZmFjZQogICAgICogQHBhcmFt\nIGN0eAogICAgICogICAgICAgICAgc29tZSBjb250cm9sIG9iamVjdAogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBhc3luY0FkZEVudHJ5KGZpbmFsIGJ5dGVb\nXSBkYXRhLCBmaW5hbCBBZGRDYWxsYmFjayBjYiwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmluYWwgT2JqZWN0IGN0eCkgewogICAgICAgIGFz\neW5jQWRkRW50cnkoZGF0YSwgMCwgZGF0YS5sZW5ndGgsIGNiLCBjdHgpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIGVudHJ5IGFzeW5jaHJvbm91c2x5\nIHRvIGFuIG9wZW4gbGVkZ2VyLCB1c2luZyBhbiBvZmZzZXQgYW5kIHJhbmdl\nLgogICAgICoKICAgICAqIEBwYXJhbSBkYXRhCiAgICAgKiAgICAgICAgICBh\ncnJheSBvZiBieXRlcyB0byBiZSB3cml0dGVuCiAgICAgKiBAcGFyYW0gb2Zm\nc2V0CiAgICAgKiAgICAgICAgICBvZmZzZXQgZnJvbSB3aGljaCB0byB0YWtl\nIGJ5dGVzIGZyb20gZGF0YQogICAgICogQHBhcmFtIGxlbmd0aAogICAgICog\nICAgICAgICAgbnVtYmVyIG9mIGJ5dGVzIHRvIHRha2UgZnJvbSBkYXRhCiAg\nICAgKiBAcGFyYW0gY2IKICAgICAqICAgICAgICAgIG9iamVjdCBpbXBsZW1l\nbnRpbmcgY2FsbGJhY2tpbnRlcmZhY2UKICAgICAqIEBwYXJhbSBjdHgKICAg\nICAqICAgICAgICAgIHNvbWUgY29udHJvbCBvYmplY3QKICAgICAqIEB0aHJv\nd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIG9mZnNldCBv\nciBsZW5ndGggaXMgbmVnYXRpdmUgb3IKICAgICAqICAgICAgICAgIG9mZnNl\ndCBhbmQgbGVuZ3RoIHN1bSB0byBhIHZhbHVlIGhpZ2hlciB0aGFuIHRoZSBs\nZW5ndGggb2YgZGF0YS4KICAgICAqLwogICAgcHVibGljIHZvaWQgYXN5bmNB\nZGRFbnRyeShmaW5hbCBieXRlW10gZGF0YSwgZmluYWwgaW50IG9mZnNldCwg\nZmluYWwgaW50IGxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZmluYWwgQWRkQ2FsbGJhY2sgY2IsIGZpbmFsIE9iamVjdCBjdHgpIHsK\nICAgICAgICBQZW5kaW5nQWRkT3Agb3AgPSBuZXcgUGVuZGluZ0FkZE9wKExl\nZGdlckhhbmRsZS50aGlzLCBjYiwgY3R4KTsKICAgICAgICBkb0FzeW5jQWRk\nRW50cnkob3AsIGRhdGEsIG9mZnNldCwgbGVuZ3RoLCBjYiwgY3R4KTsKICAg\nIH0KCiAgICAvKioKICAgICAqIE1ha2UgYSByZWNvdmVyeSBhZGQgZW50cnkg\ncmVxdWVzdC4gUmVjb3ZlcnkgYWRkcyBjYW4gYWRkIHRvIGEgbGVkZ2VyIGV2\nZW4gaWYKICAgICAqIGl0IGhhcyBiZWVuIGZlbmNlZC4KICAgICAqCiAgICAg\nKiBUaGlzIGlzIG9ubHkgdmFsaWQgZm9yIGJvb2tpZSBhbmQgbGVkZ2VyIHJl\nY292ZXJ5LCB3aGljaCBtYXkgbmVlZCB0byByZXBsaWNhdGUKICAgICAqIGVu\ndHJpZXMgdG8gYSBxdW9ydW0gb2YgYm9va2llcyB0byBlbnN1cmUgZGF0YSBz\nYWZldHkuCiAgICAgKgogICAgICogTm9ybWFsIGNsaWVudCBzaG91bGQgbmV2\nZXIgY2FsbCB0aGlzIG1ldGhvZC4KICAgICAqLwogICAgdm9pZCBhc3luY1Jl\nY292ZXJ5QWRkRW50cnkoZmluYWwgYnl0ZVtdIGRhdGEsIGZpbmFsIGludCBv\nZmZzZXQsIGZpbmFsIGludCBsZW5ndGgsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBmaW5hbCBBZGRDYWxsYmFjayBjYiwgZmluYWwgT2JqZWN0\nIGN0eCkgewogICAgICAgIFBlbmRpbmdBZGRPcCBvcCA9IG5ldyBQZW5kaW5n\nQWRkT3AoTGVkZ2VySGFuZGxlLnRoaXMsIGNiLCBjdHgpLmVuYWJsZVJlY292\nZXJ5QWRkKCk7CiAgICAgICAgZG9Bc3luY0FkZEVudHJ5KG9wLCBkYXRhLCBv\nZmZzZXQsIGxlbmd0aCwgY2IsIGN0eCk7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIGRvQXN5bmNBZGRFbnRyeShmaW5hbCBQZW5kaW5nQWRkT3Agb3AsIGZp\nbmFsIGJ5dGVbXSBkYXRhLCBmaW5hbCBpbnQgb2Zmc2V0LCBmaW5hbCBpbnQg\nbGVuZ3RoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5h\nbCBBZGRDYWxsYmFjayBjYiwgZmluYWwgT2JqZWN0IGN0eCkgewogICAgICAg\nIGlmIChvZmZzZXQgPCAwIHx8IGxlbmd0aCA8IDAKICAgICAgICAgICAgICAg\nIHx8IChvZmZzZXQgKyBsZW5ndGgpID4gZGF0YS5sZW5ndGgpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlv\nbigKICAgICAgICAgICAgICAgICJJbnZhbGlkIHZhbHVlcyBmb3Igb2Zmc2V0\nKCIrb2Zmc2V0CiAgICAgICAgICAgICAgICArIikgb3IgbGVuZ3RoKCIrbGVu\nZ3RoKyIpIik7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIG9wQ291bnRlclNlbS5hY3F1aXJlKCk7CiAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICBjYi5hZGRDb21w\nbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLkludGVycnVwdGVkRXhjZXB0aW9uLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICBMZWRnZXJIYW5kbGUudGhpcywg\nSU5WQUxJRF9FTlRSWV9JRCwgY3R4KTsKICAgICAgICB9CgogICAgICAgIGZp\nbmFsIGxvbmcgZW50cnlJZDsKICAgICAgICBmaW5hbCBsb25nIGN1cnJlbnRM\nZW5ndGg7CiAgICAgICAgc3luY2hyb25pemVkKHRoaXMpIHsKICAgICAgICAg\nICAgLy8gc3luY2hyb25pemVkIG9uIHRoaXMgdG8gZW5zdXJlIHRoYXQKICAg\nICAgICAgICAgLy8gdGhlIGxlZGdlciBpc24ndCBjbG9zZWQgYmV0d2VlbiBj\naGVja2luZyBhbmQgCiAgICAgICAgICAgIC8vIHVwZGF0aW5nIGxhc3RBZGRQ\ndXNoZWQKICAgICAgICAgICAgaWYgKG1ldGFkYXRhLmlzQ2xvc2VkKCkpIHsK\nICAgICAgICAgICAgICAgIExPRy53YXJuKCJBdHRlbXB0IHRvIGFkZCB0byBj\nbG9zZWQgbGVkZ2VyOiAiICsgbGVkZ2VySWQpOwogICAgICAgICAgICAgICAg\nTGVkZ2VySGFuZGxlLnRoaXMub3BDb3VudGVyU2VtLnJlbGVhc2UoKTsKICAg\nICAgICAgICAgICAgIGNiLmFkZENvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUu\nTGVkZ2VyQ2xvc2VkRXhjZXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgTGVkZ2VySGFuZGxlLnRoaXMsIElOVkFMSURfRU5UUllfSUQs\nIGN0eCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGVudHJ5SWQgPSArK2xhc3RBZGRQdXNoZWQ7CiAgICAg\nICAgICAgIGN1cnJlbnRMZW5ndGggPSBhZGRUb0xlbmd0aChsZW5ndGgpOwog\nICAgICAgICAgICBvcC5zZXRFbnRyeUlkKGVudHJ5SWQpOwogICAgICAgICAg\nICBwZW5kaW5nQWRkT3BzLmFkZChvcCk7CiAgICAgICAgfQoKICAgICAgICB0\ncnkgewogICAgICAgICAgICBiay5tYWluV29ya2VyUG9vbC5zdWJtaXQobmV3\nIFNhZmVSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgc2FmZVJ1bigpIHsKICAgICAg\nICAgICAgICAgICAgICBDaGFubmVsQnVmZmVyIHRvU2VuZCA9IG1hY01hbmFn\nZXIuY29tcHV0ZURpZ2VzdEFuZFBhY2thZ2VGb3JTZW5kaW5nKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5\nSWQsIGxhc3RBZGRDb25maXJtZWQsIGN1cnJlbnRMZW5ndGgsIGRhdGEsIG9m\nZnNldCwgbGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICBvcC5pbml0aWF0\nZSh0b1NlbmQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsK\nICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgb3BDb3VudGVyU2VtLnJlbGVhc2UoKTsKICAgICAgICAgICAgdGhy\nb3cgZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBPYnRhaW5z\nIGFzeW5jaHJvbm91c2x5IHRoZSBsYXN0IGNvbmZpcm1lZCB3cml0ZSBmcm9t\nIGEgcXVvcnVtIG9mIGJvb2tpZXMuIFRoaXMgCiAgICAgKiBjYWxsIG9idGFp\nbnMgdGhlIHRoZSBsYXN0IGFkZCBjb25maXJtZWQgZWFjaCBib29raWUgaGFz\nIHJlY2VpdmVkIGZvciB0aGlzIGxlZGdlcgogICAgICogYW5kIHJldHVybnMg\ndGhlIG1heGltdW0uIElmIHRoZSBsZWRnZXIgaGFzIGJlZW4gY2xvc2VkLCB0\naGUgdmFsdWUgcmV0dXJuZWQgYnkgdGhpcwogICAgICogY2FsbCBtYXkgbm90\nIGNvcnJlc3BvbmQgdG8gdGhlIGlkIG9mIHRoZSBsYXN0IGVudHJ5IG9mIHRo\nZSBsZWRnZXIsIHNpbmNlIGl0IHJlYWRzCiAgICAgKiB0aGUgaGludCBvZiBi\nb29raWVzLiBDb25zZXF1ZW50bHksIGluIHRoZSBjYXNlIHRoZSBsZWRnZXIg\naGFzIGJlZW4gY2xvc2VkLCBpdCBtYXkgCiAgICAgKiByZXR1cm4gYSBkaWZm\nZXJlbnQgdmFsdWUgdGhhbiBnZXRMYXN0QWRkQ29uZmlybWVkLCB3aGljaCBy\nZXR1cm5zIHRoZSBsb2NhbCB2YWx1ZSAKICAgICAqIG9mIHRoZSBsZWRnZXIg\naGFuZGxlLgogICAgICogCiAgICAgKiBAc2VlICNnZXRMYXN0QWRkQ29uZmly\nbWVkKCkKICAgICAqCiAgICAgKiBAcGFyYW0gY2IKICAgICAqIEBwYXJhbSBj\ndHgKICAgICAqLwoKICAgIHB1YmxpYyB2b2lkIGFzeW5jUmVhZExhc3RDb25m\naXJtZWQoZmluYWwgUmVhZExhc3RDb25maXJtZWRDYWxsYmFjayBjYiwgZmlu\nYWwgT2JqZWN0IGN0eCkgewogICAgICAgIFJlYWRMYXN0Q29uZmlybWVkT3Au\nTGFzdENvbmZpcm1lZERhdGFDYWxsYmFjayBpbm5lcmNiID0gbmV3IFJlYWRM\nYXN0Q29uZmlybWVkT3AuTGFzdENvbmZpcm1lZERhdGFDYWxsYmFjaygpIHsK\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJlYWRMYXN0Q29uZmlybWVk\nRGF0YUNvbXBsZXRlKGludCByYywgRGlnZXN0TWFuYWdlci5SZWNvdmVyeURh\ndGEgZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGlmIChyYyA9PSBCS0V4\nY2VwdGlvbi5Db2RlLk9LKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxh\nc3RBZGRDb25maXJtZWQgPSBNYXRoLm1heChsYXN0QWRkQ29uZmlybWVkLCBk\nYXRhLmxhc3RBZGRDb25maXJtZWQpOwogICAgICAgICAgICAgICAgICAgICAg\nICBsYXN0QWRkUHVzaGVkID0gTWF0aC5tYXgobGFzdEFkZFB1c2hlZCwgZGF0\nYS5sYXN0QWRkQ29uZmlybWVkKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nbGVuZ3RoID0gTWF0aC5tYXgobGVuZ3RoLCBkYXRhLmxlbmd0aCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGNiLnJlYWRMYXN0Q29uZmlybWVkQ29tcGxl\ndGUocmMsIGRhdGEubGFzdEFkZENvbmZpcm1lZCwgY3R4KTsKICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBj\nYi5yZWFkTGFzdENvbmZpcm1lZENvbXBsZXRlKHJjLCBJTlZBTElEX0VOVFJZ\nX0lELCBjdHgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICBuZXcgUmVhZExhc3RDb25m\naXJtZWRPcCh0aGlzLCBpbm5lcmNiKS5pbml0aWF0ZSgpOwogICAgfQoKCiAg\nICAvKioKICAgICAqIENvbnRleHQgb2JqZWN0cyBmb3Igc3luY2hyb25vdXMg\nY2FsbCB0byByZWFkIGxhc3QgY29uZmlybWVkLgogICAgICovCiAgICBzdGF0\naWMgY2xhc3MgTGFzdENvbmZpcm1lZEN0eCB7CiAgICAgICAgZmluYWwgc3Rh\ndGljIGxvbmcgRU5UUllfSURfUEVORElORyA9IC0xMDsKICAgICAgICBsb25n\nIHJlc3BvbnNlOwogICAgICAgIGludCByYzsKCiAgICAgICAgTGFzdENvbmZp\ncm1lZEN0eCgpIHsKICAgICAgICAgICAgdGhpcy5yZXNwb25zZSA9IEVOVFJZ\nX0lEX1BFTkRJTkc7CiAgICAgICAgfQoKICAgICAgICB2b2lkIHNldExhc3RD\nb25maXJtZWQobG9uZyBsYXN0Q29uZmlybWVkKSB7CiAgICAgICAgICAgIHRo\naXMucmVzcG9uc2UgPSBsYXN0Q29uZmlybWVkOwogICAgICAgIH0KCiAgICAg\nICAgbG9uZyBnZXRsYXN0Q29uZmlybWVkKCkgewogICAgICAgICAgICByZXR1\ncm4gdGhpcy5yZXNwb25zZTsKICAgICAgICB9CgogICAgICAgIHZvaWQgc2V0\nUkMoaW50IHJjKSB7CiAgICAgICAgICAgIHRoaXMucmMgPSByYzsKICAgICAg\nICB9CgogICAgICAgIGludCBnZXRSQygpIHsKICAgICAgICAgICAgcmV0dXJu\nIHRoaXMucmM7CiAgICAgICAgfQoKICAgICAgICBib29sZWFuIHJlYWR5KCkg\newogICAgICAgICAgICByZXR1cm4gKHRoaXMucmVzcG9uc2UgIT0gRU5UUllf\nSURfUEVORElORyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nT2J0YWlucyBzeW5jaHJvbm91c2x5IHRoZSBsYXN0IGNvbmZpcm1lZCB3cml0\nZSBmcm9tIGEgcXVvcnVtIG9mIGJvb2tpZXMuIFRoaXMgY2FsbAogICAgICog\nb2J0YWlucyB0aGUgdGhlIGxhc3QgYWRkIGNvbmZpcm1lZCBlYWNoIGJvb2tp\nZSBoYXMgcmVjZWl2ZWQgZm9yIHRoaXMgbGVkZ2VyCiAgICAgKiBhbmQgcmV0\ndXJucyB0aGUgbWF4aW11bS4gSWYgdGhlIGxlZGdlciBoYXMgYmVlbiBjbG9z\nZWQsIHRoZSB2YWx1ZSByZXR1cm5lZCBieSB0aGlzCiAgICAgKiBjYWxsIG1h\neSBub3QgY29ycmVzcG9uZCB0byB0aGUgaWQgb2YgdGhlIGxhc3QgZW50cnkg\nb2YgdGhlIGxlZGdlciwgc2luY2UgaXQgcmVhZHMKICAgICAqIHRoZSBoaW50\nIG9mIGJvb2tpZXMuIENvbnNlcXVlbnRseSwgaW4gdGhlIGNhc2UgdGhlIGxl\nZGdlciBoYXMgYmVlbiBjbG9zZWQsIGl0IG1heSAKICAgICAqIHJldHVybiBh\nIGRpZmZlcmVudCB2YWx1ZSB0aGFuIGdldExhc3RBZGRDb25maXJtZWQsIHdo\naWNoIHJldHVybnMgdGhlIGxvY2FsIHZhbHVlIAogICAgICogb2YgdGhlIGxl\nZGdlciBoYW5kbGUuCiAgICAgKiAKICAgICAqIEBzZWUgI2dldExhc3RBZGRD\nb25maXJtZWQoKQogICAgICogCiAgICAgKiBAcmV0dXJuIFRoZSBlbnRyeSBp\nZCBvZiB0aGUgbGFzdCBjb25maXJtZWQgd3JpdGUgb3Ige0BsaW5rICNJTlZB\nTElEX0VOVFJZX0lEIElOVkFMSURfRU5UUllfSUR9CiAgICAgKiAgICAgICAg\nIGlmIG5vIGVudHJ5IGhhcyBiZWVuIGNvbmZpcm1lZAogICAgICogQHRocm93\ncyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBCS0V4Y2Vw\ndGlvbgogICAgICovCiAgICAKICAgIHB1YmxpYyBsb25nIHJlYWRMYXN0Q29u\nZmlybWVkKCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0\naW9uLCBCS0V4Y2VwdGlvbiB7CiAgICAgICAgTGFzdENvbmZpcm1lZEN0eCBj\ndHggPSBuZXcgTGFzdENvbmZpcm1lZEN0eCgpOwogICAgICAgIGFzeW5jUmVh\nZExhc3RDb25maXJtZWQobmV3IFN5bmNSZWFkTGFzdENvbmZpcm1lZENhbGxi\nYWNrKCksIGN0eCk7CiAgICAgICAgc3luY2hyb25pemVkKGN0eCkgewogICAg\nICAgICAgICB3aGlsZSghY3R4LnJlYWR5KCkpIHsKICAgICAgICAgICAgICAg\nIGN0eC53YWl0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIGlmKGN0eC5nZXRSQygpICE9IEJLRXhjZXB0aW9uLkNvZGUuT0spIHRocm93\nIEJLRXhjZXB0aW9uLmNyZWF0ZShjdHguZ2V0UkMoKSk7CiAgICAgICAgcmV0\ndXJuIGN0eC5nZXRsYXN0Q29uZmlybWVkKCk7CiAgICB9CgogICAgLy8gY2xv\nc2UgdGhlIGxlZGdlciBhbmQgc2VuZCBmYWlscyB0byBhbGwgdGhlIGFkZHMg\naW4gdGhlIHBpcGVsaW5lCiAgICB2b2lkIGhhbmRsZVVucmVjb3ZlcmFibGVF\ncnJvckR1cmluZ0FkZChpbnQgcmMpIHsKICAgICAgICBpZiAobWV0YWRhdGEu\naXNJblJlY292ZXJ5KCkpIHsKICAgICAgICAgICAgLy8gd2Ugc2hvdWxkIG5v\ndCBjbG9zZSBsZWRnZXIgaWYgbGVkZ2VyIGlzIHJlY292ZXJ5IG1vZGUKICAg\nICAgICAgICAgLy8gb3RoZXJ3aXNlIHdlIG1heSBsb3NlIGVudHJ5LgogICAg\nICAgICAgICBlcnJvck91dFBlbmRpbmdBZGRzKHJjKTsKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIH0KICAgICAgICBhc3luY0Nsb3NlSW50ZXJuYWwo\nTm9vcENsb3NlQ2FsbGJhY2suaW5zdGFuY2UsIG51bGwsIHJjKTsKICAgIH0K\nCiAgICB2b2lkIGVycm9yT3V0UGVuZGluZ0FkZHMoaW50IHJjKSB7CiAgICAg\nICAgUGVuZGluZ0FkZE9wIHBlbmRpbmdBZGRPcDsKICAgICAgICB3aGlsZSAo\nKHBlbmRpbmdBZGRPcCA9IHBlbmRpbmdBZGRPcHMucG9sbCgpKSAhPSBudWxs\nKSB7CiAgICAgICAgICAgIHBlbmRpbmdBZGRPcC5zdWJtaXRDYWxsYmFjayhy\nYyk7CiAgICAgICAgfQogICAgfQoKICAgIHZvaWQgc2VuZEFkZFN1Y2Nlc3ND\nYWxsYmFja3MoKSB7CiAgICAgICAgLy8gU3RhcnQgZnJvbSB0aGUgaGVhZCBv\nZiB0aGUgcXVldWUgYW5kIHByb2NlZWQgd2hpbGUgdGhlcmUgYXJlCiAgICAg\nICAgLy8gZW50cmllcyB0aGF0IGhhdmUgaGFkIGFsbCB0aGVpciByZXNwb25z\nZXMgY29tZSBiYWNrCiAgICAgICAgUGVuZGluZ0FkZE9wIHBlbmRpbmdBZGRP\ncDsKICAgICAgICB3aGlsZSAoKHBlbmRpbmdBZGRPcCA9IHBlbmRpbmdBZGRP\ncHMucGVlaygpKSAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChwZW5kaW5n\nQWRkT3AubnVtUmVzcG9uc2VzUGVuZGluZyAhPSAwKSB7CiAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGVuZGlu\nZ0FkZE9wcy5yZW1vdmUoKTsKICAgICAgICAgICAgbGFzdEFkZENvbmZpcm1l\nZCA9IHBlbmRpbmdBZGRPcC5lbnRyeUlkOwogICAgICAgICAgICBwZW5kaW5n\nQWRkT3Auc3VibWl0Q2FsbGJhY2soQktFeGNlcHRpb24uQ29kZS5PSyk7CiAg\nICAgICAgfQoKICAgIH0KCiAgICB2b2lkIGhhbmRsZUJvb2tpZUZhaWx1cmUo\nSW5ldFNvY2tldEFkZHJlc3MgYWRkciwgZmluYWwgaW50IGJvb2tpZUluZGV4\nKSB7CiAgICAgICAgSW5ldFNvY2tldEFkZHJlc3MgbmV3Qm9va2llOwoKICAg\nICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAg\nTE9HLmRlYnVnKCJIYW5kbGluZyBmYWlsdXJlIG9mIGJvb2tpZTogIiArIGFk\nZHIgKyAiIGluZGV4OiAiCiAgICAgICAgICAgICAgICAgICAgICArIGJvb2tp\nZUluZGV4KTsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIG5ld0Jvb2tpZSA9IGJrLmJvb2tpZVdhdGNoZXIKICAgICAgICAgICAgICAg\nICAgICAgICAgLmdldEFkZGl0aW9uYWxCb29raWUobWV0YWRhdGEuY3VycmVu\ndEVuc2VtYmxlKTsKICAgICAgICB9IGNhdGNoIChCS05vdEVub3VnaEJvb2tp\nZXNFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cKICAgICAgICAgICAg\nLmVycm9yKCJDb3VsZCBub3QgZ2V0IGFkZGl0aW9uYWwgYm9va2llIHRvIHJl\nbWFrZSBlbnNlbWJsZSwgY2xvc2luZyBsZWRnZXI6ICIKICAgICAgICAgICAg\nICAgICAgICsgbGVkZ2VySWQpOwogICAgICAgICAgICBoYW5kbGVVbnJlY292\nZXJhYmxlRXJyb3JEdXJpbmdBZGQoZS5nZXRDb2RlKCkpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBmaW5hbCBBcnJheUxpc3Q8\nSW5ldFNvY2tldEFkZHJlc3M+IG5ld0Vuc2VtYmxlID0gbmV3IEFycmF5TGlz\ndDxJbmV0U29ja2V0QWRkcmVzcz4oCiAgICAgICAgICAgIG1ldGFkYXRhLmN1\ncnJlbnRFbnNlbWJsZSk7CiAgICAgICAgbmV3RW5zZW1ibGUuc2V0KGJvb2tp\nZUluZGV4LCBuZXdCb29raWUpOwoKICAgICAgICBpZiAoTE9HLmlzRGVidWdF\nbmFibGVkKCkpIHsKICAgICAgICAgICAgTE9HLmRlYnVnKCJDaGFuZ2luZyBl\nbnNlbWJsZSBmcm9tOiAiICsgbWV0YWRhdGEuY3VycmVudEVuc2VtYmxlICsg\nIiB0bzogIgogICAgICAgICAgICAgICAgICAgICAgKyBuZXdFbnNlbWJsZSAr\nICIgZm9yIGxlZGdlcjogIiArIGxlZGdlcklkICsgIiBzdGFydGluZyBhdCBl\nbnRyeTogIgogICAgICAgICAgICAgICAgICAgICAgKyAobGFzdEFkZENvbmZp\ncm1lZCArIDEpKTsKICAgICAgICB9CgogICAgICAgIGZpbmFsIGxvbmcgbmV3\nRW5zZW1ibGVTdGFydEVudHJ5ID0gbGFzdEFkZENvbmZpcm1lZCArIDE7CiAg\nICAgICAgbWV0YWRhdGEuYWRkRW5zZW1ibGUobmV3RW5zZW1ibGVTdGFydEVu\ndHJ5LCBuZXdFbnNlbWJsZSk7CgogICAgICAgIGZpbmFsIGNsYXNzIENoYW5n\nZUVuc2VtYmxlQ2IgaW1wbGVtZW50cyBTdGF0Q2FsbGJhY2sgewogICAgICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2Vz\nc1Jlc3VsdChmaW5hbCBpbnQgcmMsIFN0cmluZyBwYXRoLCBPYmplY3QgY3R4\nLCBmaW5hbCBTdGF0IHN0YXQpIHsKCiAgICAgICAgICAgICAgICBiay5tYWlu\nV29ya2VyUG9vbC5zdWJtaXRPcmRlcmVkKGxlZGdlcklkLCBuZXcgU2FmZVJ1\nbm5hYmxlKCkgewogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAg\nICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNhZmVSdW4oKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChyYyA9PSBLZWVwZXJFeGNlcHRpb24u\nQ29kZS5CYWRWZXJzaW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICByZXJlYWRNZXRhZGF0YShuZXcgR2VuZXJpY0NhbGxiYWNrPExlZGdlck1l\ndGFkYXRhPigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJs\naWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgbmV3cmMsIExlZGdlck1l\ndGFkYXRhIG5ld01ldGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKG5ld3JjICE9IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5l\ncnJvcigiRXJyb3IgcmVhZGluZyBuZXcgbWV0YWRhdGEgZnJvbSBsZWRnZXIg\nYWZ0ZXIgY2hhbmdpbmcgZW5zZW1ibGUsIGNvZGU9IiArIG5ld3JjKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVVu\ncmVjb3ZlcmFibGVFcnJvckR1cmluZ0FkZChCS0V4Y2VwdGlvbi5Db2RlLlpL\nRXhjZXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIGEgbmV3IGVuc2VtYmxlIGlzIGFkZGVkIG9ubHkgd2hlbiB0\naGUgc3RhcnQgZW50cnkgaXMgbGFyZ2VyIHRoYW4gemVybwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0Vuc2VtYmxl\nU3RhcnRFbnRyeSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBtZXRhZGF0YS5nZXRFbnNlbWJsZXMoKS5yZW1v\ndmUobmV3RW5zZW1ibGVTdGFydEVudHJ5KTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS5yZXNvbHZlQ29uZmxp\nY3QobmV3TWV0YSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBtZXRhZGF0YS5hZGRFbnNlbWJsZShuZXdFbnNlbWJs\nZVN0YXJ0RW50cnksIG5ld0Vuc2VtYmxlKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZUxlZGdlckNvbmZpZyhu\nZXcgQ2hhbmdlRW5zZW1ibGVDYigpLCBudWxsKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy5l\ncnJvcigiQ291bGQgbm90IHJlc29sdmUgbGVkZ2VyIG1ldGFkYXRhIGNvbmZs\naWN0IHdoaWxlIGNoYW5naW5nIGVuc2VtYmxlIHRvOiAiCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nbmV3RW5zZW1ibGUgKyAiLCBvbGQgbWV0YSBkYXRhIGlzIFxuIiArIG5ldyBT\ndHJpbmcobWV0YWRhdGEuc2VyaWFsaXplKCkpCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIlxuLCBu\nZXcgbWV0YSBkYXRhIGlzIFxuIiArIG5ldyBTdHJpbmcobmV3TWV0YS5zZXJp\nYWxpemUoKSkgKyAiXG4gLGNsb3NpbmcgbGVkZ2VyIik7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlVW5yZWNv\ndmVyYWJsZUVycm9yRHVyaW5nQWRkKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNl\ncHRpb24pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAo\ncmMgIT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuT0suaW50VmFsdWUoKSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAuZXJyb3IoIkNvdWxkIG5vdCBwZXJzaXN0IGxlZGdl\nciBtZXRhZGF0YSB3aGlsZSBjaGFuZ2luZyBlbnNlbWJsZSB0bzogIgogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgbmV3RW5zZW1ibGUg\nKyAiICwgY2xvc2luZyBsZWRnZXIiKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGhhbmRsZVVucmVjb3ZlcmFibGVFcnJvckR1cmluZ0FkZChCS0V4\nY2VwdGlvbi5Db2RlLlpLRXhjZXB0aW9uKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEudXBkYXRlWm5vZGVT\ndGF0dXMoc3RhdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoUGVu\nZGluZ0FkZE9wIHBlbmRpbmdBZGRPcCA6IHBlbmRpbmdBZGRPcHMpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdBZGRPcC51bnNldFN1\nY2Nlc3NBbmRTZW5kV3JpdGVSZXF1ZXN0KGJvb2tpZUluZGV4KTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgfQogICAgICAgIH07Cgog\nICAgICAgIHdyaXRlTGVkZ2VyQ29uZmlnKG5ldyBDaGFuZ2VFbnNlbWJsZUNi\nKCksIG51bGwpOwoKICAgIH0KCiAgICB2b2lkIHJlcmVhZE1ldGFkYXRhKGZp\nbmFsIEdlbmVyaWNDYWxsYmFjazxMZWRnZXJNZXRhZGF0YT4gY2IpIHsKICAg\nICAgICBiay5nZXRaa0hhbmRsZSgpLmdldERhdGEoYmsuZ2V0TGVkZ2VyTWFu\nYWdlcigpLmdldExlZGdlclBhdGgobGVkZ2VySWQpLCBmYWxzZSwKICAgICAg\nICAgICAgbmV3IERhdGFDYWxsYmFjaygpIHsKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2Jq\nZWN0IGN0eCwgYnl0ZVtdIGRhdGEsIFN0YXQgc3RhdCkgewogICAgICAgICAg\nICAgICAgICAgIGlmIChyYyAhPSBLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5p\nbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJv\ncigiRXJyb3IgcmVhZGluZyBtZXRhZGF0YSBmcm9tIGxlZGdlciwgY29kZSA9\nIiArIHJjKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2Iub3BlcmF0aW9u\nQ29tcGxldGUoQktFeGNlcHRpb24uQ29kZS5aS0V4Y2VwdGlvbiwgbnVsbCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIExlZGdlck1ldGFkYXRhIG5ld01ldGEgPSBMZWRn\nZXJNZXRhZGF0YS5wYXJzZUNvbmZpZyhkYXRhLCBzdGF0LmdldFZlcnNpb24o\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBs\nZXRlKEJLRXhjZXB0aW9uLkNvZGUuT0ssIG5ld01ldGEpOwogICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgTE9HLmVycm9yKCJFcnJvciBwYXJzaW5nIGxlZGdl\nciBtZXRhZGF0YSBmb3IgbGVkZ2VyIiwgZSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUu\nWktFeGNlcHRpb24sIG51bGwpOwogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfQogICAgICAgIH0sIG51bGwpOwogICAgfQoKICAgIHN5bmNocm9uaXplZCB2\nb2lkIHJlY292ZXIoZmluYWwgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+IGNiKSB7\nCiAgICAgICAgaWYgKG1ldGFkYXRhLmlzQ2xvc2VkKCkpIHsKICAgICAgICAg\nICAgbGFzdEFkZENvbmZpcm1lZCA9IGxhc3RBZGRQdXNoZWQgPSBtZXRhZGF0\nYS5jbG9zZTsKICAgICAgICAgICAgbGVuZ3RoID0gbWV0YWRhdGEubGVuZ3Ro\nOwoKICAgICAgICAgICAgLy8gV2UgYXJlIGFscmVhZHkgY2xvc2VkLCBub3Ro\naW5nIHRvIGRvCiAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJL\nRXhjZXB0aW9uLkNvZGUuT0ssIG51bGwpOwogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgfQoKICAgICAgICAvLyBpZiBtZXRhZGF0YSBpcyBhbHJlYWR5\nIGluIHJlY292ZXIsIGRvbnQgdHJ5IHRvIHdyaXRlIGFnYWluLAogICAgICAg\nIC8vIGp1c3QgZG8gdGhlIHJlY292ZXJ5IGZyb20gdGhlIHN0YXJ0aW5nIHBv\naW50CiAgICAgICAgaWYgKG1ldGFkYXRhLmlzSW5SZWNvdmVyeSgpKSB7CiAg\nICAgICAgICAgIG5ldyBMZWRnZXJSZWNvdmVyeU9wKExlZGdlckhhbmRsZS50\naGlzLCBjYikuaW5pdGlhdGUoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KCiAgICAgICAgbWV0YWRhdGEubWFya0xlZGdlckluUmVjb3Zlcnko\nKTsKCiAgICAgICAgd3JpdGVMZWRnZXJDb25maWcobmV3IFN0YXRDYWxsYmFj\naygpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHByb2Nlc3NSZXN1bHQoZmluYWwgaW50IHJjLCBTdHJpbmcgcGF0\naCwgT2JqZWN0IGN0eCwgU3RhdCBzdGF0KSB7CiAgICAgICAgICAgICAgICBp\nZiAocmMgPT0gS2VlcGVyRXhjZXB0aW9uLkNvZGUuQmFkVmVyc2lvbikgewog\nICAgICAgICAgICAgICAgICAgIHJlcmVhZE1ldGFkYXRhKG5ldyBHZW5lcmlj\nQ2FsbGJhY2s8TGVkZ2VyTWV0YWRhdGE+KCkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb25Db21wbGV0ZShpbnQgcmMsIExl\nZGdlck1ldGFkYXRhIG5ld01ldGEpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAocmMgIT0gQktFeGNlcHRpb24uQ29kZS5PSykgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYi5vcGVyYXRp\nb25Db21wbGV0ZShyYywgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgbWV0YWRhdGEgPSBuZXdNZXRhOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICByZWNvdmVyKGNiKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAg\nICAgICAgfSBlbHNlIGlmIChyYyA9PSBLZWVwZXJFeGNlcHRpb24uQ29kZS5P\nSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEu\nem5vZGVWZXJzaW9uID0gc3RhdC5nZXRWZXJzaW9uKCk7CiAgICAgICAgICAg\nICAgICAgICAgbmV3IExlZGdlclJlY292ZXJ5T3AoTGVkZ2VySGFuZGxlLnRo\naXMsIGNiKS5pbml0aWF0ZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHdyaXRpbmcg\nbGVkZ2VyIGNvbmZpZyAiICsgIHJjIAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICArICIgcGF0aCA9ICIgKyBwYXRoKTsKICAgICAgICAgICAgICAg\nICAgICBjYi5vcGVyYXRpb25Db21wbGV0ZShCS0V4Y2VwdGlvbi5Db2RlLlpL\nRXhjZXB0aW9uLCBudWxsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0sIG51bGwpOwogICAgfQoKICAgIHN0YXRpYyBjbGFz\ncyBOb29wQ2xvc2VDYWxsYmFjayBpbXBsZW1lbnRzIENsb3NlQ2FsbGJhY2sg\newogICAgICAgIHN0YXRpYyBOb29wQ2xvc2VDYWxsYmFjayBpbnN0YW5jZSA9\nIG5ldyBOb29wQ2xvc2VDYWxsYmFjaygpOwoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZUNvbXBsZXRlKGludCByYywgTGVk\nZ2VySGFuZGxlIGxoLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAgIGlmIChy\nYyAhPSBLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAg\nICAgICAgICAgICAgICBMT0cud2FybigiQ2xvc2UgZmFpbGVkOiAiICsgQktF\neGNlcHRpb24uZ2V0TWVzc2FnZShyYykpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIC8vIG5vb3AKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZh\ndGUgc3RhdGljIGNsYXNzIFN5bmNSZWFkQ2FsbGJhY2sgaW1wbGVtZW50cyBS\nZWFkQ2FsbGJhY2sgewogICAgICAgIC8qKgogICAgICAgICAqIEltcGxlbWVu\ndGF0aW9uIG9mIGNhbGxiYWNrIGludGVyZmFjZSBmb3Igc3luY2hyb25vdXMg\ncmVhZCBtZXRob2QuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gcmMK\nICAgICAgICAgKiAgICAgICAgICByZXR1cm4gY29kZQogICAgICAgICAqIEBw\nYXJhbSBsZWRlcgogICAgICAgICAqICAgICAgICAgIGxlZGdlciBpZGVudGlm\naWVyCiAgICAgICAgICogQHBhcmFtIHNlcQogICAgICAgICAqICAgICAgICAg\nIHNlcXVlbmNlIG9mIGVudHJpZXMKICAgICAgICAgKiBAcGFyYW0gY3R4CiAg\nICAgICAgICogICAgICAgICAgY29udHJvbCBvYmplY3QKICAgICAgICAgKi8K\nICAgICAgICBwdWJsaWMgdm9pZCByZWFkQ29tcGxldGUoaW50IHJjLCBMZWRn\nZXJIYW5kbGUgbGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIEVudW1lcmF0aW9uPExlZGdlckVudHJ5PiBzZXEsIE9iamVjdCBjdHgpIHsK\nICAgICAgICAgICAgCiAgICAgICAgICAgIFN5bmNDb3VudGVyIGNvdW50ZXIg\nPSAoU3luY0NvdW50ZXIpIGN0eDsKICAgICAgICAgICAgc3luY2hyb25pemVk\nIChjb3VudGVyKSB7CiAgICAgICAgICAgICAgICBjb3VudGVyLnNldFNlcXVl\nbmNlKHNlcSk7CiAgICAgICAgICAgICAgICBjb3VudGVyLnNldHJjKHJjKTsK\nICAgICAgICAgICAgICAgIGNvdW50ZXIuZGVjKCk7CiAgICAgICAgICAgICAg\nICBjb3VudGVyLm5vdGlmeSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFN5bmNBZGRDYWxsYmFj\nayBpbXBsZW1lbnRzIEFkZENhbGxiYWNrIHsKICAgICAgICAvKioKICAgICAg\nICAgKiBJbXBsZW1lbnRhdGlvbiBvZiBjYWxsYmFjayBpbnRlcmZhY2UgZm9y\nIHN5bmNocm9ub3VzIHJlYWQgbWV0aG9kLgogICAgICAgICAqCiAgICAgICAg\nICogQHBhcmFtIHJjCiAgICAgICAgICogICAgICAgICAgcmV0dXJuIGNvZGUK\nICAgICAgICAgKiBAcGFyYW0gbGVkZXIKICAgICAgICAgKiAgICAgICAgICBs\nZWRnZXIgaWRlbnRpZmllcgogICAgICAgICAqIEBwYXJhbSBlbnRyeQogICAg\nICAgICAqICAgICAgICAgIGVudHJ5IGlkZW50aWZpZXIKICAgICAgICAgKiBA\ncGFyYW0gY3R4CiAgICAgICAgICogICAgICAgICAgY29udHJvbCBvYmplY3QK\nICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBhZGRDb21wbGV0ZShp\nbnQgcmMsIExlZGdlckhhbmRsZSBsaCwgbG9uZyBlbnRyeSwgT2JqZWN0IGN0\neCkgewogICAgICAgICAgICBTeW5jQ291bnRlciBjb3VudGVyID0gKFN5bmND\nb3VudGVyKSBjdHg7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb3VudGVy\nLnNldHJjKHJjKTsKICAgICAgICAgICAgY291bnRlci5kZWMoKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU3luY1JlYWRM\nYXN0Q29uZmlybWVkQ2FsbGJhY2sgaW1wbGVtZW50cyBSZWFkTGFzdENvbmZp\ncm1lZENhbGxiYWNrIHsKICAgICAgICAvKioKICAgICAgICAgKiBJbXBsZW1l\nbnRhdGlvbiBvZiAgY2FsbGJhY2sgaW50ZXJmYWNlIGZvciBzeW5jaHJvbm91\ncyByZWFkIGxhc3QgY29uZmlybWVkIG1ldGhvZC4KICAgICAgICAgKi8KICAg\nICAgICBwdWJsaWMgdm9pZCByZWFkTGFzdENvbmZpcm1lZENvbXBsZXRlKGlu\ndCByYywgbG9uZyBsYXN0Q29uZmlybWVkLCBPYmplY3QgY3R4KSB7CiAgICAg\nICAgICAgIExhc3RDb25maXJtZWRDdHggbGNDdHggPSAoTGFzdENvbmZpcm1l\nZEN0eCkgY3R4OwogICAgICAgICAgICAKICAgICAgICAgICAgc3luY2hyb25p\nemVkKGxjQ3R4KSB7CiAgICAgICAgICAgICAgICBsY0N0eC5zZXRSQyhyYyk7\nCiAgICAgICAgICAgICAgICBsY0N0eC5zZXRMYXN0Q29uZmlybWVkKGxhc3RD\nb25maXJtZWQpOwogICAgICAgICAgICAgICAgbGNDdHgubm90aWZ5KCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0\naWMgY2xhc3MgU3luY0Nsb3NlQ2FsbGJhY2sgaW1wbGVtZW50cyBDbG9zZUNh\nbGxiYWNrIHsKICAgICAgICAvKioKICAgICAgICAgKiBDbG9zZSBjYWxsYmFj\nayBtZXRob2QKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSByYwogICAg\nICAgICAqIEBwYXJhbSBsaAogICAgICAgICAqIEBwYXJhbSBjdHgKICAgICAg\nICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZUNvbXBsZXRlKGludCBy\nYywgTGVkZ2VySGFuZGxlIGxoLCBPYmplY3QgY3R4KSB7CiAgICAgICAgICAg\nIFN5bmNDb3VudGVyIGNvdW50ZXIgPSAoU3luY0NvdW50ZXIpIGN0eDsKICAg\nICAgICAgICAgY291bnRlci5zZXRyYyhyYyk7CiAgICAgICAgICAgIHN5bmNo\ncm9uaXplZCAoY291bnRlcikgewogICAgICAgICAgICAgICAgY291bnRlci5k\nZWMoKTsKICAgICAgICAgICAgICAgIGNvdW50ZXIubm90aWZ5KCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

