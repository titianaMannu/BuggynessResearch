{"sha":"c699eaeed8cc4b10aba86a7e2cea2dca3fe466a0","node_id":"MDQ6QmxvYjE1NzU5NTY6YzY5OWVhZWVkOGNjNGIxMGFiYTg2YTdlMmNlYTJkY2EzZmU0NjZhMA==","size":10239,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/c699eaeed8cc4b10aba86a7e2cea2dca3fe466a0","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNv\nZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq\nIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmltcG9ydCBq\nYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuSW5ldFNvY2tl\ndEFkZHJlc3M7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQg\namF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5Tb3J0ZWRNYXA7CmltcG9ydCBqYXZhLnV0aWwuVHJl\nZU1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbC5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLmRhdGEuU3Rh\ndDsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGou\nTG9nZ2VyRmFjdG9yeTsKCi8qKgogKiBUaGlzIGNsYXNzIGVuY2Fwc3VsYXRl\ncyBhbGwgdGhlIGxlZGdlciBtZXRhZGF0YSB0aGF0IGlzIHBlcnNpc3RlbnRs\neSBzdG9yZWQKICogaW4gem9va2VlcGVyLiBJdCBwcm92aWRlcyBwYXJzaW5n\nIGFuZCBzZXJpYWxpemF0aW9uIG1ldGhvZHMgb2Ygc3VjaCBtZXRhZGF0YS4K\nICoKICovCnB1YmxpYyBjbGFzcyBMZWRnZXJNZXRhZGF0YSB7CiAgICBzdGF0\naWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2Vy\nKExlZGdlck1ldGFkYXRhLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBTdHJpbmcgY2xvc2VkID0gIkNMT1NFRCI7CiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgbFNwbGl0dGVyID0gIlxuIjsKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIFN0cmluZyB0U3BsaXR0ZXIgPSAiXHQiOwoKICAg\nIC8vIGNhbid0IHVzZSAtMSBmb3IgTk9UQ0xPU0VEIGJlY2F1c2UgdGhhdCBp\ncyByZXNlcnZlZCBmb3IgYSBjbG9zZWQsIGVtcHR5CiAgICAvLyBsZWRnZXIK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE5PVENMT1NFRCA9IC0xMDE7\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBJTl9SRUNPVkVSWSA9IC0x\nMDI7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTE9XRVNUX0NPTVBB\nVF9NRVRBREFUQV9GT1JNQVRfVkVSU0lPTiA9IDA7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGludCBDVVJSRU5UX01FVEFEQVRBX0ZPUk1BVF9WRVJTSU9O\nID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFZFUlNJT05f\nS0VZID0gIkJvb2tpZU1ldGFkYXRhRm9ybWF0VmVyc2lvbiI7CgogICAgaW50\nIG1ldGFkYXRhRm9ybWF0VmVyc2lvbiA9IDA7CgogICAgaW50IGVuc2VtYmxl\nU2l6ZTsKICAgIGludCBxdW9ydW1TaXplOwogICAgbG9uZyBsZW5ndGg7CiAg\nICBsb25nIGNsb3NlOwogICAgcHJpdmF0ZSBTb3J0ZWRNYXA8TG9uZywgQXJy\nYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPj4gZW5zZW1ibGVzID0gbmV3IFRy\nZWVNYXA8TG9uZywgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPj4oKTsK\nICAgIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVzcz4gY3VycmVudEVuc2Vt\nYmxlOwogICAgdm9sYXRpbGUgaW50IHpub2RlVmVyc2lvbiA9IC0xOwogICAg\nCiAgICBwdWJsaWMgTGVkZ2VyTWV0YWRhdGEoaW50IGVuc2VtYmxlU2l6ZSwg\naW50IHF1b3J1bVNpemUpIHsKICAgICAgICB0aGlzLmVuc2VtYmxlU2l6ZSA9\nIGVuc2VtYmxlU2l6ZTsKICAgICAgICB0aGlzLnF1b3J1bVNpemUgPSBxdW9y\ndW1TaXplOwoKICAgICAgICAvKgogICAgICAgICAqIEl0IGlzIHNldCBpbiBQ\nZW5kaW5nUmVhZE9wLnJlYWRFbnRyeUNvbXBsZXRlLCBhbmQKICAgICAgICAg\nKiB3ZSByZWFkIGl0IGluIExlZGdlclJlY292ZXJ5T3AucmVhZENvbXBsZXRl\nLgogICAgICAgICAqLwogICAgICAgIHRoaXMubGVuZ3RoID0gMDsKICAgICAg\nICB0aGlzLmNsb3NlID0gTk9UQ0xPU0VEOwogICAgICAgIHRoaXMubWV0YWRh\ndGFGb3JtYXRWZXJzaW9uID0gQ1VSUkVOVF9NRVRBREFUQV9GT1JNQVRfVkVS\nU0lPTjsKICAgIH07CgogICAgcHJpdmF0ZSBMZWRnZXJNZXRhZGF0YSgpIHsK\nICAgICAgICB0aGlzKDAsIDApOwogICAgfQoKICAgIC8qKgogICAgICogR2V0\nIHRoZSBNYXAgb2YgYm9va2llIGVuc2VtYmxlcyBmb3IgdGhlIHZhcmlvdXMg\nbGVkZ2VyIGZyYWdtZW50cwogICAgICogdGhhdCBtYWtlIHVwIHRoZSBsZWRn\nZXIuCiAgICAgKgogICAgICogQHJldHVybiBTb3J0ZWRNYXAgb2YgTGVkZ2Vy\nIEZyYWdtZW50cyBhbmQgdGhlIGNvcnJlc3BvbmRpbmcKICAgICAqIGJvb2tp\nZSBlbnNlbWJsZXMgdGhhdCBzdG9yZSB0aGUgZW50cmllcy4KICAgICAqLwog\nICAgcHVibGljIFNvcnRlZE1hcDxMb25nLCBBcnJheUxpc3Q8SW5ldFNvY2tl\ndEFkZHJlc3M+PiBnZXRFbnNlbWJsZXMoKSB7CiAgICAgICAgcmV0dXJuIGVu\nc2VtYmxlczsKICAgIH0KCiAgICBib29sZWFuIGlzQ2xvc2VkKCkgewogICAg\nICAgIHJldHVybiBjbG9zZSAhPSBOT1RDTE9TRUQgCiAgICAgICAgICAgICYm\nIGNsb3NlICE9IElOX1JFQ09WRVJZOwogICAgfQoKICAgIGJvb2xlYW4gaXNJ\nblJlY292ZXJ5KCkgewogICAgICAgIHJldHVybiBJTl9SRUNPVkVSWSA9PSBj\nbG9zZTsKICAgIH0KICAgIAogICAgdm9pZCBtYXJrTGVkZ2VySW5SZWNvdmVy\neSgpIHsKICAgICAgICBjbG9zZSA9IElOX1JFQ09WRVJZOwogICAgfQoKICAg\nIHZvaWQgY2xvc2UobG9uZyBlbnRyeUlkKSB7CiAgICAgICAgY2xvc2UgPSBl\nbnRyeUlkOwogICAgfQoKICAgIHZvaWQgYWRkRW5zZW1ibGUobG9uZyBzdGFy\ndEVudHJ5SWQsIEFycmF5TGlzdDxJbmV0U29ja2V0QWRkcmVzcz4gZW5zZW1i\nbGUpIHsKICAgICAgICBhc3NlcnQgZW5zZW1ibGVzLmlzRW1wdHkoKSB8fCBz\ndGFydEVudHJ5SWQgPj0gZW5zZW1ibGVzLmxhc3RLZXkoKTsKCiAgICAgICAg\nZW5zZW1ibGVzLnB1dChzdGFydEVudHJ5SWQsIGVuc2VtYmxlKTsKICAgICAg\nICBjdXJyZW50RW5zZW1ibGUgPSBlbnNlbWJsZTsKICAgIH0KCiAgICBBcnJh\neUxpc3Q8SW5ldFNvY2tldEFkZHJlc3M+IGdldEVuc2VtYmxlKGxvbmcgZW50\ncnlJZCkgewogICAgICAgIC8vIHRoZSBoZWFkIG1hcCBjYW5ub3QgYmUgZW1w\ndHksIHNpbmNlIHdlIGluc2VydCBhbiBlbnNlbWJsZSBmb3IKICAgICAgICAv\nLyBlbnRyeS1pZCAwLCByaWdodCB3aGVuIHdlIHN0YXJ0CiAgICAgICAgcmV0\ndXJuIGVuc2VtYmxlcy5nZXQoZW5zZW1ibGVzLmhlYWRNYXAoZW50cnlJZCAr\nIDEpLmxhc3RLZXkoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiB0aGUgZW50\ncnkgaWQgPiB0aGUgZ2l2ZW4gZW50cnktaWQgYXQgd2hpY2ggdGhlIG5leHQg\nZW5zZW1ibGUgY2hhbmdlIHRha2VzCiAgICAgKiBwbGFjZSAoIC0xIGlmIG5v\nIGZ1cnRoZXIgZW5zZW1ibGUgY2hhbmdlcykKICAgICAqCiAgICAgKiBAcGFy\nYW0gZW50cnlJZAogICAgICogQHJldHVybgogICAgICovCiAgICBsb25nIGdl\ndE5leHRFbnNlbWJsZUNoYW5nZShsb25nIGVudHJ5SWQpIHsKICAgICAgICBT\nb3J0ZWRNYXA8TG9uZywgQXJyYXlMaXN0PEluZXRTb2NrZXRBZGRyZXNzPj4g\ndGFpbE1hcCA9IGVuc2VtYmxlcy50YWlsTWFwKGVudHJ5SWQgKyAxKTsKCiAg\nICAgICAgaWYgKHRhaWxNYXAuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIHJl\ndHVybiAtMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4g\ndGFpbE1hcC5maXJzdEtleSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIEdlbmVyYXRlcyBhIGJ5dGUgYXJyYXkgb2YgdGhpcyBvYmplY3QK\nICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBtZXRhZGF0YSBzZXJpYWxpemVk\nIGludG8gYSBieXRlIGFycmF5CiAgICAgKi8KICAgIHB1YmxpYyBieXRlW10g\nc2VyaWFsaXplKCkgewogICAgICAgIFN0cmluZ0J1aWxkZXIgcyA9IG5ldyBT\ndHJpbmdCdWlsZGVyKCk7CiAgICAgICAgcy5hcHBlbmQoVkVSU0lPTl9LRVkp\nLmFwcGVuZCh0U3BsaXR0ZXIpLmFwcGVuZChtZXRhZGF0YUZvcm1hdFZlcnNp\nb24pLmFwcGVuZChsU3BsaXR0ZXIpOwogICAgICAgIHMuYXBwZW5kKHF1b3J1\nbVNpemUpLmFwcGVuZChsU3BsaXR0ZXIpLmFwcGVuZChlbnNlbWJsZVNpemUp\nLmFwcGVuZChsU3BsaXR0ZXIpLmFwcGVuZChsZW5ndGgpOwoKICAgICAgICBm\nb3IgKE1hcC5FbnRyeTxMb25nLCBBcnJheUxpc3Q8SW5ldFNvY2tldEFkZHJl\nc3M+PiBlbnRyeSA6IGVuc2VtYmxlcy5lbnRyeVNldCgpKSB7CiAgICAgICAg\nICAgIHMuYXBwZW5kKGxTcGxpdHRlcikuYXBwZW5kKGVudHJ5LmdldEtleSgp\nKTsKICAgICAgICAgICAgZm9yIChJbmV0U29ja2V0QWRkcmVzcyBhZGRyIDog\nZW50cnkuZ2V0VmFsdWUoKSkgewogICAgICAgICAgICAgICAgcy5hcHBlbmQo\ndFNwbGl0dGVyKTsKICAgICAgICAgICAgICAgIFN0cmluZ1V0aWxzLmFkZHJU\nb1N0cmluZyhzLCBhZGRyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgaWYgKGNsb3NlICE9IE5PVENMT1NFRCkgewogICAgICAgICAgICBz\nLmFwcGVuZChsU3BsaXR0ZXIpLmFwcGVuZChjbG9zZSkuYXBwZW5kKHRTcGxp\ndHRlcikuYXBwZW5kKGNsb3NlZCk7CiAgICAgICAgfQoKICAgICAgICBpZiAo\nTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgTE9HLmRlYnVn\nKCJTZXJpYWxpemVkIGNvbmZpZzogIiArIHMudG9TdHJpbmcoKSk7CiAgICAg\nICAgfQoKICAgICAgICByZXR1cm4gcy50b1N0cmluZygpLmdldEJ5dGVzKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZXMgYSBnaXZlbiBieXRlIGFy\ncmF5IGFuZCB0cmFuc2Zvcm1zIGludG8gYSBMZWRnZXJDb25maWcgb2JqZWN0\nCiAgICAgKgogICAgICogQHBhcmFtIGFycmF5CiAgICAgKiAgICAgICAgICAg\nIGJ5dGUgYXJyYXkgdG8gcGFyc2UKICAgICAqIEByZXR1cm4gTGVkZ2VyQ29u\nZmlnCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAgICAgKiAgICAgICAg\nICAgICBpZiB0aGUgZ2l2ZW4gYnl0ZVtdIGNhbm5vdCBiZSBwYXJzZWQKICAg\nICAqLwoKICAgIHN0YXRpYyBMZWRnZXJNZXRhZGF0YSBwYXJzZUNvbmZpZyhi\neXRlW10gYnl0ZXMsIGludCB2ZXJzaW9uKSB0aHJvd3MgSU9FeGNlcHRpb24g\newoKICAgICAgICBMZWRnZXJNZXRhZGF0YSBsYyA9IG5ldyBMZWRnZXJNZXRh\nZGF0YSgpOwogICAgICAgIFN0cmluZyBjb25maWcgPSBuZXcgU3RyaW5nKGJ5\ndGVzKTsKCiAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgIExPRy5kZWJ1ZygiUGFyc2luZyBDb25maWc6ICIgKyBjb25m\naWcpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBTdHJpbmcgbGluZXNb\nXSA9IGNvbmZpZy5zcGxpdChsU3BsaXR0ZXIpOwogICAgICAgIAogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGludCBpID0gMDsKICAgICAgICAgICAgaWYg\nKGxpbmVzWzBdLnN0YXJ0c1dpdGgoVkVSU0lPTl9LRVkpKSB7CiAgICAgICAg\nICAgICAgICBTdHJpbmcgcGFydHNbXSA9IGxpbmVzWzBdLnNwbGl0KHRTcGxp\ndHRlcik7CiAgICAgICAgICAgICAgICBsYy5tZXRhZGF0YUZvcm1hdFZlcnNp\nb24gPSBuZXcgSW50ZWdlcihwYXJ0c1sxXSk7CiAgICAgICAgICAgICAgICBp\nKys7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsYy5t\nZXRhZGF0YUZvcm1hdFZlcnNpb24gPSAwOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIAogICAgICAgICAgICBpZiAobGMubWV0YWRhdGFGb3JtYXRWZXJz\naW9uIDwgTE9XRVNUX0NPTVBBVF9NRVRBREFUQV9GT1JNQVRfVkVSU0lPTgog\nICAgICAgICAgICAgICAgfHwgbGMubWV0YWRhdGFGb3JtYXRWZXJzaW9uID4g\nQ1VSUkVOVF9NRVRBREFUQV9GT1JNQVRfVkVSU0lPTikgewogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJNZXRhZGF0YSB2ZXJzaW9u\nIG5vdCBjb21wYXRpYmxlLiBFeHBlY3RlZCBiZXR3ZWVuICIKICAgICAgICAg\nICAgICAgICAgICAgICAgKyBMT1dFU1RfQ09NUEFUX01FVEFEQVRBX0ZPUk1B\nVF9WRVJTSU9OICsgIiBhbmQgIiArIENVUlJFTlRfTUVUQURBVEFfRk9STUFU\nX1ZFUlNJT04KICAgICAgICAgICAgICAgICAgICAgICAgKyAiLCBidXQgZ290\nICIgKyBsYy5tZXRhZGF0YUZvcm1hdFZlcnNpb24pOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGlmICgobGluZXMubGVuZ3RoK2kpIDwgMikgewogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJRdW9ydW0gc2l6\nZSBvciBlbnNlbWJsZSBzaXplIGFic2VudCBmcm9tIGNvbmZpZzogIiArIGNv\nbmZpZyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxjLnpub2RlVmVy\nc2lvbiA9IHZlcnNpb247CiAgICAgICAgICAgIGxjLnF1b3J1bVNpemUgPSBu\nZXcgSW50ZWdlcihsaW5lc1tpKytdKTsKICAgICAgICAgICAgbGMuZW5zZW1i\nbGVTaXplID0gbmV3IEludGVnZXIobGluZXNbaSsrXSk7CiAgICAgICAgICAg\nIGxjLmxlbmd0aCA9IG5ldyBMb25nKGxpbmVzW2krK10pOwoKICAgICAgICAg\nICAgZm9yICg7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgU3RyaW5nIHBhcnRzW10gPSBsaW5lc1tpXS5zcGxpdCh0U3BsaXR0\nZXIpOwoKICAgICAgICAgICAgICAgIGlmIChwYXJ0c1sxXS5lcXVhbHMoY2xv\nc2VkKSkgewogICAgICAgICAgICAgICAgICAgIGxjLmNsb3NlID0gbmV3IExv\nbmcocGFydHNbMF0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEFycmF5TGlzdDxJbmV0\nU29ja2V0QWRkcmVzcz4gYWRkcnMgPSBuZXcgQXJyYXlMaXN0PEluZXRTb2Nr\nZXRBZGRyZXNzPigpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IDE7\nIGogPCBwYXJ0cy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAg\nIGFkZHJzLmFkZChTdHJpbmdVdGlscy5wYXJzZUFkZHIocGFydHNbal0pKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxjLmFkZEVuc2Vt\nYmxlKG5ldyBMb25nKHBhcnRzWzBdKSwgYWRkcnMpOwogICAgICAgICAgICB9\nCiAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKGUpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gbGM7CiAgICB9CiAgICAKCiAgICAvKioKICAg\nICAqIFVwZGF0ZXMgdGhlIHN0YXR1cyBvZiB0aGlzIG1ldGFkYXRhIGluIFpv\nb0tlZXBlci4KICAgICAqIAogICAgICogQHBhcmFtIHN0YXQKICAgICAqLwog\nICAgcHVibGljIHZvaWQgdXBkYXRlWm5vZGVTdGF0dXMoU3RhdCBzdGF0KSB7\nCiAgICAgICAgdGhpcy56bm9kZVZlcnNpb24gPSBzdGF0LmdldFZlcnNpb24o\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgem5vZGUgdmVy\nc2lvbiBvZiB0aGlzIG1ldGFkYXRhCiAgICAgKgogICAgICogQHBhcmFtIHpu\nb2RlVmVyc2lvbgogICAgICogICAgICAgIFpub2RlIHZlcnNpb24gb2YgdGhp\ncyBtZXRhZGF0YQogICAgICovCiAgICBwdWJsaWMgdm9pZCB1cGRhdGVabm9k\nZVN0YXR1cyhpbnQgem5vZGVWZXJzaW9uKSB7CiAgICAgICAgdGhpcy56bm9k\nZVZlcnNpb24gPSB6bm9kZVZlcnNpb247CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm5zIHRoZSBsYXN0IHpub2RlIHZlcnNpb24uCiAgICAgKiAKICAg\nICAqIEByZXR1cm4gaW50IHpub2RlIHZlcnNpb24KICAgICAqLwogICAgcHVi\nbGljIGludCBnZXRabm9kZVZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIHRo\naXMuem5vZGVWZXJzaW9uOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2\nZSBjb25mbGljdCB3aXRoIG5ldyB1cGRhdGVkIG1ldGFkYXRhLgogICAgICoK\nICAgICAqIEBwYXJhbSBuZXdNZXRhCiAgICAgKiAgICAgICAgICBSZS1yZWFk\nIG1ldGFkYXRhCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGNvbmZsaWN0\nIGhhcyBiZWVuIHJlc29sdmVkLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8K\nICAgIGJvb2xlYW4gcmVzb2x2ZUNvbmZsaWN0KExlZGdlck1ldGFkYXRhIG5l\nd01ldGEpIHsKICAgICAgICAvKgogICAgICAgICAqICBpZiBsZW5ndGggJiBj\nbG9zZSBoYXZlIGNoYW5nZWQsIHRoZW4gYW5vdGhlciBjbGllbnQgaGFzCiAg\nICAgICAgICogIG9wZW5lZCB0aGUgbGVkZ2VyLCBjYW4ndCByZXNvbHZlIHRo\naXMgY29uZmxpY3QuCiAgICAgICAgICovCgogICAgICAgIGlmIChtZXRhZGF0\nYUZvcm1hdFZlcnNpb24gIT0gbmV3TWV0YS5tZXRhZGF0YUZvcm1hdFZlcnNp\nb24gfHwKICAgICAgICAgICAgZW5zZW1ibGVTaXplICE9IG5ld01ldGEuZW5z\nZW1ibGVTaXplIHx8CiAgICAgICAgICAgIHF1b3J1bVNpemUgIT0gbmV3TWV0\nYS5xdW9ydW1TaXplIHx8CiAgICAgICAgICAgIGxlbmd0aCAhPSBuZXdNZXRh\nLmxlbmd0aCB8fAogICAgICAgICAgICBjbG9zZSAhPSBuZXdNZXRhLmNsb3Nl\nKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAg\nICAgLy8gbmV3IG1ldGEgem5vZGUgdmVyc2lvbiBzaG91bGQgYmUgbGFyZ2Vy\nIHRoYW4gb2xkIG9uZQogICAgICAgIGlmICh6bm9kZVZlcnNpb24gPiBuZXdN\nZXRhLnpub2RlVmVyc2lvbikgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgfQogICAgICAgIC8vIGVuc2VtYmxlIHNpemUgc2hvdWxkIGJl\nIHNhbWUKICAgICAgICBpZiAoZW5zZW1ibGVzLnNpemUoKSAhPSBuZXdNZXRh\nLmVuc2VtYmxlcy5zaXplKCkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIH0KICAgICAgICAvLyBlbnNlbWJsZSBkaXN0cmlidXRpb24g\nc2hvdWxkIGJlIHNhbWUKICAgICAgICAvLyB3ZSBkb24ndCBjaGVjayB0aGUg\nZGV0YWlsIGVuc2VtYmxlLCBzaW5jZSBuZXcgYm9va2llIHdpbGwgYmUgc2V0\nCiAgICAgICAgLy8gdXNpbmcgcmVjb3ZlcnkgdG9vbC4KICAgICAgICBJdGVy\nYXRvcjxMb25nPiBrZXlJdGVyID0gZW5zZW1ibGVzLmtleVNldCgpLml0ZXJh\ndG9yKCk7CiAgICAgICAgSXRlcmF0b3I8TG9uZz4gbmV3TWV0YUtleUl0ZXIg\nPSBuZXdNZXRhLmVuc2VtYmxlcy5rZXlTZXQoKS5pdGVyYXRvcigpOwogICAg\nICAgIGZvciAoaW50IGk9MDsgaTxlbnNlbWJsZXMuc2l6ZSgpOyBpKyspIHsK\nICAgICAgICAgICAgTG9uZyBjdXJLZXkgPSBrZXlJdGVyLm5leHQoKTsKICAg\nICAgICAgICAgTG9uZyBuZXdNZXRhS2V5ID0gbmV3TWV0YUtleUl0ZXIubmV4\ndCgpOwogICAgICAgICAgICBpZiAoIWN1cktleS5lcXVhbHMobmV3TWV0YUtl\neSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICAvKgogICAgICAgICAqICBpZiB0aGUg\nY29uZmxpY3QgaGFzIGJlZW4gcmVzb2x2ZWQsIHRoZW4gdXBkYXRlCiAgICAg\nICAgICogIGVuc2VtYmxlIGFuZCB6bm9kZSB2ZXJzaW9uCiAgICAgICAgICov\nCiAgICAgICAgZW5zZW1ibGVzID0gbmV3TWV0YS5lbnNlbWJsZXM7CiAgICAg\nICAgem5vZGVWZXJzaW9uID0gbmV3TWV0YS56bm9kZVZlcnNpb247CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9Cn0K\n","encoding":"base64"}

