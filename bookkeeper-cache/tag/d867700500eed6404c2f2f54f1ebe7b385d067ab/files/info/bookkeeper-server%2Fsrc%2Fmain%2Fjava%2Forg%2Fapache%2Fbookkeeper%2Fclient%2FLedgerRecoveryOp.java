{"sha":"35a867600d30126238b3decb326e70af5ac969fb","node_id":"MDQ6QmxvYjE1NzU5NTY6MzVhODY3NjAwZDMwMTI2MjM4YjNkZWNiMzI2ZTcwYWY1YWM5NjlmYg==","size":6276,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/35a867600d30126238b3decb326e70af5ac969fb","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNv\nZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAq\nIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCmltcG9ydCBq\nYXZhLnV0aWwuRW51bWVyYXRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLkFkZENhbGxiYWNrOwppbXBv\ncnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNr\nLkNsb3NlQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkFzeW5jQ2FsbGJhY2suUmVhZENhbGxiYWNrOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Bc3luY0NhbGxiYWNrLlJlYWRM\nYXN0Q29uZmlybWVkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uLkJLRGlnZXN0TWF0Y2hFeGNlcHRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdl\nckhhbmRsZS5Ob29wQ2xvc2VDYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jbGllbnQuRGlnZXN0TWFuYWdlci5SZWNvdmVyeURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9va2llUHJv\ndG9jb2w7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2tlZXBlckludGVybmFsQ2FsbGJhY2tzLkdlbmVyaWNDYWxsYmFjazsKCmlt\ncG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5LZWVwZXJFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\nckZhY3Rvcnk7CmltcG9ydCBvcmcuamJvc3MubmV0dHkuYnVmZmVyLkNoYW5u\nZWxCdWZmZXI7CgovKioKICogVGhpcyBjbGFzcyBlbmNhcHN1bGF0ZWQgdGhl\nIGxlZGdlciByZWNvdmVyeSBvcGVyYXRpb24uIEl0IGZpcnN0IGRvZXMgYSBy\nZWFkCiAqIHdpdGggZW50cnktaWQgb2YgLTEgKEJvb2tpZVByb3RvY29sLkxB\nU1RfQUREX0NPTkZJUk1FRCkgdG8gYWxsIGJvb2tpZXMuIFRoZW4KICogc3Rh\ncnRpbmcgZnJvbSB0aGUgbGFzdCBjb25maXJtZWQgZW50cnkgKGZyb20gaGlu\ndHMgaW4gdGhlIGxlZGdlciBlbnRyaWVzKSwKICogaXQgcmVhZHMgZm9yd2Fy\nZCB1bnRpbCBpdCBpcyBub3QgYWJsZSB0byBmaW5kIGEgcGFydGljdWxhciBl\nbnRyeS4gSXQgY2xvc2VzCiAqIHRoZSBsZWRnZXIgYXQgdGhhdCBlbnRyeS4K\nICoKICovCmNsYXNzIExlZGdlclJlY292ZXJ5T3AgaW1wbGVtZW50cyBSZWFk\nQ2FsbGJhY2ssIEFkZENhbGxiYWNrIHsKICAgIHN0YXRpYyBmaW5hbCBMb2dn\nZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoTGVkZ2VyUmVjb3Zl\ncnlPcC5jbGFzcyk7CiAgICBMZWRnZXJIYW5kbGUgbGg7CiAgICBpbnQgbnVt\nUmVzcG9uc2VzUGVuZGluZzsKICAgIGJvb2xlYW4gcHJvY2VlZGluZ1dpdGhS\nZWNvdmVyeSA9IGZhbHNlOwogICAgbG9uZyBtYXhBZGRQdXNoZWQgPSBMZWRn\nZXJIYW5kbGUuSU5WQUxJRF9FTlRSWV9JRDsKICAgIGxvbmcgbWF4QWRkQ29u\nZmlybWVkID0gTGVkZ2VySGFuZGxlLklOVkFMSURfRU5UUllfSUQ7CiAgICBs\nb25nIG1heExlbmd0aCA9IDA7CgogICAgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+\nIGNiOwoKICAgIHB1YmxpYyBMZWRnZXJSZWNvdmVyeU9wKExlZGdlckhhbmRs\nZSBsaCwgR2VuZXJpY0NhbGxiYWNrPFZvaWQ+IGNiKSB7CiAgICAgICAgdGhp\ncy5jYiA9IGNiOwogICAgICAgIHRoaXMubGggPSBsaDsKICAgICAgICBudW1S\nZXNwb25zZXNQZW5kaW5nID0gbGgubWV0YWRhdGEuZW5zZW1ibGVTaXplOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIGluaXRpYXRlKCkgewogICAgICAgIFJl\nYWRMYXN0Q29uZmlybWVkT3Agcmxjb3AgPSBuZXcgUmVhZExhc3RDb25maXJt\nZWRPcChsaCwKICAgICAgICAgICAgICAgIG5ldyBSZWFkTGFzdENvbmZpcm1l\nZE9wLkxhc3RDb25maXJtZWREYXRhQ2FsbGJhY2soKSB7CiAgICAgICAgICAg\nICAgICBwdWJsaWMgdm9pZCByZWFkTGFzdENvbmZpcm1lZERhdGFDb21wbGV0\nZShpbnQgcmMsIFJlY292ZXJ5RGF0YSBkYXRhKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKHJjID09IEJLRXhjZXB0aW9uLkNvZGUuT0spIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgbGgubGFzdEFkZFB1c2hlZCA9IGxoLmxhc3RB\nZGRDb25maXJtZWQgPSBkYXRhLmxhc3RBZGRDb25maXJtZWQ7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGxoLmxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAg\nICAgICAgICAgICAgICAgICAgICBkb1JlY292ZXJ5UmVhZCgpOwogICAgICAg\nICAgICAgICAgICAgIH0gZWxzZSBpZiAocmMgPT0gQktFeGNlcHRpb24uQ29k\nZS5VbmF1dGhvcml6ZWRBY2Nlc3NFeGNlcHRpb24pIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUocmMsIG51bGwpOwog\nICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUu\nUmVhZEV4Y2VwdGlvbiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAg\nIC8qKgogICAgICAgICAqIEVuYWJsZSBmZW5jaW5nIG9uIHRoaXMgb3AuIFdo\nZW4gdGhlIHJlYWQgcmVxdWVzdCByZWFjaGVzIHRoZSBib29raWVzCiAgICAg\nICAgICogc2VydmVyIGl0IHdpbGwgZmVuY2Ugb2ZmIHRoZSBsZWRnZXIsIHN0\nb3BwaW5nIGFueSBzdWJzZXF1ZW50IG9wZXJhdGlvbgogICAgICAgICAqIGZy\nb20gd3JpdGluZyB0byBpdC4KICAgICAgICAgKi8KICAgICAgICBybGNvcC5p\nbml0aWF0ZVdpdGhGZW5jaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\ncnkgdG8gcmVhZCBwYXN0IHRoZSBsYXN0IGNvbmZpcm1lZC4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGRvUmVjb3ZlcnlSZWFkKCkgewogICAgICAgIGxo\nLmxhc3RBZGRDb25maXJtZWQrKzsKICAgICAgICBsaC5hc3luY1JlYWRFbnRy\naWVzKGxoLmxhc3RBZGRDb25maXJtZWQsIGxoLmxhc3RBZGRDb25maXJtZWQs\nIHRoaXMsIG51bGwpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIHZvaWQgcmVhZENvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBF\nbnVtZXJhdGlvbjxMZWRnZXJFbnRyeT4gc2VxLCBPYmplY3QgY3R4KSB7CiAg\nICAgICAgLy8gZ2V0IGJhY2sgdG8gcHJldiB2YWx1ZQogICAgICAgIGxoLmxh\nc3RBZGRDb25maXJtZWQtLTsKICAgICAgICBpZiAocmMgPT0gQktFeGNlcHRp\nb24uQ29kZS5PSykgewogICAgICAgICAgICBMZWRnZXJFbnRyeSBlbnRyeSA9\nIHNlcS5uZXh0RWxlbWVudCgpOwogICAgICAgICAgICBieXRlW10gZGF0YSA9\nIGVudHJ5LmdldEVudHJ5KCk7CgogICAgICAgICAgICAvKgogICAgICAgICAg\nICAgKiBXZSB3aWxsIGFkZCB0aGlzIGVudHJ5IGFnYWluIHRvIG1ha2Ugc3Vy\nZSBpdCBpcyB3cml0dGVuIHRvIGVub3VnaAogICAgICAgICAgICAgKiByZXBs\naWNhcy4gV2Ugc3VidHJhY3QgdGhlIGxlbmd0aCBvZiB0aGUgZGF0YSBpdHNl\nbGYsIHNpbmNlIGl0IHdpbGwKICAgICAgICAgICAgICogYmUgYWRkZWQgYWdh\naW4gd2hlbiBwcm9jZXNzaW5nIHRoZSBjYWxsIHRvIGFkZCBpdC4KICAgICAg\nICAgICAgICovCiAgICAgICAgICAgIHN5bmNocm9uaXplZCAobGgpIHsKICAg\nICAgICAgICAgICAgIGxoLmxlbmd0aCA9IGVudHJ5LmdldExlbmd0aCgpIC0g\nKGxvbmcpIGRhdGEubGVuZ3RoOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGxoLmFzeW5jUmVjb3ZlcnlBZGRFbnRyeShkYXRhLCAwLCBkYXRhLmxlbmd0\naCwgdGhpcywgbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCgogICAgICAgIGlmIChyYyA9PSBCS0V4Y2VwdGlvbi5Db2RlLk5vU3VjaEVu\ndHJ5RXhjZXB0aW9uIHx8IHJjID09IEJLRXhjZXB0aW9uLkNvZGUuTm9TdWNo\nTGVkZ2VyRXhpc3RzRXhjZXB0aW9uKSB7CiAgICAgICAgICAgIGxoLmFzeW5j\nQ2xvc2VJbnRlcm5hbChuZXcgQ2xvc2VDYWxsYmFjaygpIHsKICAgICAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\nY2xvc2VDb21wbGV0ZShpbnQgcmMsIExlZGdlckhhbmRsZSBsaCwgT2JqZWN0\nIGN0eCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyYyAhPSBLZWVwZXJF\neGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIExPRy53YXJuKCJDbG9zZSBmYWlsZWQ6ICIgKyBCS0V4Y2Vw\ndGlvbi5nZXRNZXNzYWdlKHJjKSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJLRXhjZXB0aW9uLkNvZGUuWktFeGNl\ncHRpb24sIG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGNiLm9wZXJhdGlvbkNvbXBsZXRlKEJL\nRXhjZXB0aW9uLkNvZGUuT0ssIG51bGwpOwogICAgICAgICAgICAgICAgICAg\nICAgICBMT0cuZGVidWcoIkFmdGVyIGNsb3NpbmcgbGVuZ3RoIGlzOiAiICsg\nbGguZ2V0TGVuZ3RoKCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIG51bGwsIEJLRXhjZXB0\naW9uLkNvZGUuTGVkZ2VyQ2xvc2VkRXhjZXB0aW9uKTsKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gb3RoZXJ3aXNlLCBzb21l\nIG90aGVyIGVycm9yLCB3ZSBjYW4ndCBoYW5kbGUKICAgICAgICBMT0cuZXJy\nb3IoIkZhaWx1cmUgIiArIEJLRXhjZXB0aW9uLmdldE1lc3NhZ2UocmMpICsg\nIiB3aGlsZSByZWFkaW5nIGVudHJ5OiAiICsgKGxoLmxhc3RBZGRDb25maXJt\nZWQgKyAxKQogICAgICAgICAgICAgICAgICArICIgbGVkZ2VyOiAiICsgbGgu\nbGVkZ2VySWQgKyAiIHdoaWxlIHJlY292ZXJpbmcgbGVkZ2VyIik7CiAgICAg\nICAgY2Iub3BlcmF0aW9uQ29tcGxldGUocmMsIG51bGwpOwogICAgICAgIHJl\ndHVybjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGFk\nZENvbXBsZXRlKGludCByYywgTGVkZ2VySGFuZGxlIGxoLCBsb25nIGVudHJ5\nSWQsIE9iamVjdCBjdHgpIHsKICAgICAgICBpZiAocmMgIT0gQktFeGNlcHRp\nb24uQ29kZS5PSykgewogICAgICAgICAgICAvLyBHaXZlIHVwLCB3ZSBjYW4n\ndCByZWNvdmVyIGZyb20gdGhpcyBlcnJvcgoKICAgICAgICAgICAgTE9HLmVy\ncm9yKCJGYWlsdXJlICIgKyBCS0V4Y2VwdGlvbi5nZXRNZXNzYWdlKHJjKSAr\nICIgd2hpbGUgd3JpdGluZyBlbnRyeTogIiArIChsaC5sYXN0QWRkQ29uZmly\nbWVkICsgMSkKICAgICAgICAgICAgICAgICAgICAgICsgIiBsZWRnZXI6ICIg\nKyBsaC5sZWRnZXJJZCArICIgd2hpbGUgcmVjb3ZlcmluZyBsZWRnZXIiKTsK\nICAgICAgICAgICAgY2Iub3BlcmF0aW9uQ29tcGxldGUocmMsIG51bGwpOwog\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBkb1JlY292\nZXJ5UmVhZCgpOwoKICAgIH0KCn0K\n","encoding":"base64"}

