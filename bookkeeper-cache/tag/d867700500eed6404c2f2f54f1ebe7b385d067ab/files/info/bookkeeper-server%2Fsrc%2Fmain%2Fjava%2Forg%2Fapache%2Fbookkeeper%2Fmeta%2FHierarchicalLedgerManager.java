{"sha":"b573181beb49c16b1879bfea469f3430869c908b","node_id":"MDQ6QmxvYjE1NzU5NTY6YjU3MzE4MWJlYjQ5YzE2YjE4NzliZmVhNDY5ZjM0MzA4NjljOTA4Yg==","size":21481,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/b573181beb49c16b1879bfea469f3430869c908b","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCi8qKgogKiBM\naWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFT\nRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBh\nZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgog\nKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGlj\nZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91IG1h\neSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQogKiB3\naXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo\nZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0\nd2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3Bl\nY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBs\naW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50\nLkV4ZWN1dG9yczsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlNjaGVk\ndWxlZEV4ZWN1dG9yU2VydmljZTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJy\nZW50LmF0b21pYy5BdG9taWNJbnRlZ2VyOwppbXBvcnQgamF2YS51dGlsLlNl\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTmF2\naWdhYmxlTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkxlZGdlck1ldGFkYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5ib29r\na2VlcGVyLmNvbmYuQWJzdHJhY3RDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLnByb3RvLkJvb2trZWVwZXJJbnRlcm5hbENh\nbGxiYWNrcy5HZW5lcmljQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIucHJvdG8uQm9va2tlZXBlckludGVybmFsQ2FsbGJhY2tzLlBy\nb2Nlc3NvcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci51dGlsLlN0\ncmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnV0aWwu\nWmtVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLkFzeW5jQ2Fs\nbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5Bc3luY0NhbGxi\nYWNrLlN0cmluZ0NhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVw\nZXIuQ3JlYXRlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLktl\nZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLktl\nZXBlckV4Y2VwdGlvbi5Db2RlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVw\nZXIuWm9vRGVmcy5JZHM7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5a\nb29LZWVwZXI7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKLyoqCiAqIEhpZXJhcmNoaWNhbCBM\nZWRnZXIgTWFuYWdlciB3aGljaCBtYW5hZ2VzIGxlZGdlciBtZXRhIGluIHpv\nb2tlZXBlciB1c2luZyAyLWxldmVsIGhpZXJhcmNoaWNhbCB6bm9kZXMuCiAq\nCiAqIDxwPgogKiBIaWVyYXJjaGljYWwgTGVkZ2VyIE1hbmFnZXIgZmlyc3Qg\nb2J0YWluIGEgZ2xvYmFsIHVuaXF1ZSBpZCBmcm9tIHpvb2tlZXBlciB1c2lu\nZyBhIEVQSEVNRVJBTF9TRVFVRU5USUFMCiAqIHpub2RlIDxpPihsZWRnZXJz\nUm9vdFBhdGgpL2xlZGdlcnMvaWRnZW4vSUQtPC9pPi4KICogU2luY2Ugem9v\na2VlcGVyIHNlcXVlbnRpYWwgY291bnRlciBoYXMgYSBmb3JtYXQgb2YgJTEw\nZCAtLSB0aGF0IGlzIDEwIGRpZ2l0cyB3aXRoIDAgKHplcm8pIHBhZGRpbmcs\nIGkuZS4KICogIiZsdDtwYXRoJmd0OzAwMDAwMDAwMDEiLCBIaWVyYXJjaGlj\nYWxMZWRnZXJNYW5hZ2VyIHNwbGl0cyB0aGUgZ2VuZXJhdGVkIGlkIGludG8g\nMyBwYXJ0cyAoMi00LTQpOgogKiA8cHJlPiZsdDtsZXZlbDEgKDIgZGlnaXRz\nKSZndDsmbHQ7bGV2ZWwyICg0IGRpZ2l0cykmZ3Q7Jmx0O2xldmVsMyAoNCBk\naWdpdHMpJmd0OzwvcHJlPgogKiBUaGVzZSAzIHBhcnRzIGFyZSB1c2VkIHRv\nIGZvcm0gdGhlIGFjdHVhbCBsZWRnZXIgbm9kZSBwYXRoIHVzZWQgdG8gc3Rv\ncmUgbGVkZ2VyIG1ldGFkYXRhOgogKiA8cHJlPihsZWRnZXJzUm9vdFBhdGgp\nL2xldmVsMS9sZXZlbDIvTChsZXZlbDMpPC9wcmU+CiAqIEUuZyBMZWRnZXIg\nMDAwMDAwMDAwMSBpcyBzcGxpdCBpbnRvIDMgcGFydHMgPGk+MDA8L2k+LCA8\naT4wMDAwPC9pPiwgPGk+MDAwMTwvaT4sIHdoaWNoIGlzIHN0b3JlZCBpbgog\nKiA8aT4obGVkZ2Vyc1Jvb3RQYXRoKS8wMC8wMDAwL0wwMDAxPC9pPi4gU28g\nZWFjaCB6bm9kZSBjb3VsZCBoYXZlIGF0IG1vc3QgMTAwMDAgbGVkZ2Vycywg\nd2hpY2ggYXZvaWRzCiAqIGZhaWxlZCB0byBnZXQgY2hpbGRyZW4gbGlzdCBv\nZiBhIHRvbyBiaWcgem5vZGUgZHVyaW5nIGdhcmJhZ2UgY29sbGVjdGlvbi4K\nICogPHA+CiAqIEFsbCBhY3RpdmVkIGxlZGdlcnMgZm91bmQgaW4gYm9va2ll\nIHNlcnZlciBpcyBtYW5hZ2VkIGluIGEgc29ydGVkIG1hcCwgd2hpY2ggZWFz\nZSB1cyB0byBwaWNrCiAqIHVwIGFsbCBhY3RpdmVkIGxlZGdlcnMgYmVsb25n\ncyB0byAobGV2ZWwxLCBsZXZlbDIpLgogKiA8L3A+CiAqIDxwPgogKiBHYXJi\nYWdlIGNvbGxlY3Rpb24gaW4gSGllcmFyY2hpY2FsTGVkZ2VyTWFuYWdlciBp\ncyBwcm9jZXNzZWQgbm9kZSBieSBub2RlIGFzIGJlbG93OgogKiA8dWw+CiAq\nIGZldGNoaW5nIGFsbCBsZXZlbDEgbm9kZXMsIGJ5IGNhbGxpbmcgemsjZ2V0\nQ2hpbGRyZW4obGVkZ2VyUm9vdFBhdGgpLgogKiA8dWw+CiAqIGZvciBlYWNo\nIGxldmVsMSBub2RlLCBmZXRjaGluZyB0aGVpciBsZXZlbDIgbm9kZXMsIGJ5\nIGNhbGxpbmcgemsjZ2V0Q2hpbGRyZW4obGVkZ2VyUm9vdFBhdGggKyAiLyIg\nKyBsZXZlbDEpCiAqIDxsaT4gZmV0Y2ggYWxsIGV4aXN0ZWQgbGVkZ2VycyBm\ncm9tIHpvb2tlZXBlciBpbiBsZXZlbDEvbGV2ZWwyIG5vZGUsIHNhaWQgPGI+\nemtBY3RpdmVMZWRnZXJzPC9iPgogKiA8bGk+IGZldGNoIGFsbCBhY3RpdmUg\nbGVkZ2VycyBmcm9tIGJvb2tpZSBzZXJ2ZXIgaW4gbGV2ZWwxL2xldmVsMiwg\nc2FpZCA8Yj5ia0FjdGl2ZUxlZGdlcnM8L2I+CiAqIDxsaT4gbG9vcCBvdmVy\nIDxiPmJrQWN0aXZlTGVkZ2VyczwvYj4gdG8gZmluZCB0aG9zZSBsZWRnZXJz\nIGFyZW4ndCBleGlzdGVkIGluIDxiPnprQWN0aXZlTGVkZ2VyczwvYj4sIGRv\nIGdhcmJhZ2UgY29sbGVjdGlvbiBvbiB0aGVtLgogKiA8L3VsPgogKiA8L3Vs\nPgogKiBTaW5jZSBnYXJiYWdlIGNvbGxlY3Rpb24gaXMgcnVubmluZyBpbiBi\nYWNrZ3JvdW5kLCBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyIGRpZCBnYyBv\nbiBzaW5nbGUgaGFzaAogKiBub2RlIGF0IGEgdGltZSB0byBhdm9pZCBjb25z\ndW1pbmcgdG9vIG11Y2ggcmVzb3VyY2VzLgogKiA8L3A+CiAqLwpjbGFzcyBI\naWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyIGV4dGVuZHMgQWJzdHJhY3Raa0xl\nZGdlck1hbmFnZXIgewoKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0g\nTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSGllcmFyY2hpY2FsTGVkZ2VyTWFu\nYWdlci5jbGFzcyk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBO\nQU1FID0gImhpZXJhcmNoaWNhbCI7CgogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgQ1VSX1ZFUlNJT04gPSAxOwoKICAgIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgSURHRU5fWk5PREUgPSAiaWRnZW4iOwogICAgc3RhdGljIGZpbmFsIFN0\ncmluZyBJREdFTkVSQVRJT05fUFJFRklYID0gIi8iICsgSURHRU5fWk5PREUg\nKyAiL0lELSI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgTUFY\nX0lEX1NVRkZJWCA9ICI5OTk5IjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIFN0cmluZyBNSU5fSURfU1VGRklYID0gIjAwMDAiOwoKICAgIC8vIFBhdGgg\ndG8gZ2VuZXJhdGUgZ2xvYmFsIGlkCiAgICBwcml2YXRlIGZpbmFsIFN0cmlu\nZyBpZEdlblBhdGg7CiAgICAvLyBBIHNvcnRlZCBtYXAgdG8gc3RvcmVkIGFs\nbCBhY3RpdmUgbGVkZ2VyIGlkcwogICAgcHJpdmF0ZSBTbmFwc2hvdE1hcDxM\nb25nLCBCb29sZWFuPiBhY3RpdmVMZWRnZXJzOwoKICAgIC8vIHdlIHVzZSB0\naGlzIHRvIHByZXZlbnQgbG9uZyBzdGFjayBjaGFpbnMgZnJvbSBidWlsZGlu\nZyB1cCBpbiBjYWxsYmFja3MKICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2Vydmlj\nZSBzY2hlZHVsZXI7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RvcgogICAg\nICoKICAgICAqIEBwYXJhbSBjb25mCiAgICAgKiAgICAgICAgICBDb25maWd1\ncmF0aW9uIG9iamVjdAogICAgICogQHBhcmFtIHprCiAgICAgKiAgICAgICAg\nICBab29LZWVwZXIgQ2xpZW50IEhhbmRsZQogICAgICogQHBhcmFtIGxlZGdl\nclJvb3RQYXRoCiAgICAgKiAgICAgICAgICBab29LZWVwZXIgUGF0aCB0byBz\ndG9yZSBsZWRnZXIgbWV0YWRhdGEKICAgICAqIEB0aHJvd3MgSU9FeGNlcHRp\nb24gd2hlbiB2ZXJzaW9uIGlzIG5vdCBjb21wYXRpYmxlCiAgICAgKi8KICAg\nIHB1YmxpYyBIaWVyYXJjaGljYWxMZWRnZXJNYW5hZ2VyKEFic3RyYWN0Q29u\nZmlndXJhdGlvbiBjb25mLCBab29LZWVwZXIgemssCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbGVkZ2VyUm9vdFBhdGgs\nIGludCBsYXlvdXRWZXJzaW9uKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgc3VwZXIoY29uZiwgemssIGxlZGdlclJvb3RQYXRoKTsK\nCiAgICAgICAgaWYgKGxheW91dFZlcnNpb24gIT0gQ1VSX1ZFUlNJT04pIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJJbmNvbXBhdGli\nbGUgbGF5b3V0IHZlcnNpb24gZm91bmQgOiAiIAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyBsYXlvdXRWZXJzaW9uKTsKICAgICAgICB9\nCgogICAgICAgIHRoaXMuaWRHZW5QYXRoID0gbGVkZ2VyUm9vdFBhdGggKyBJ\nREdFTkVSQVRJT05fUFJFRklYOwogICAgICAgIGFjdGl2ZUxlZGdlcnMgPSBu\nZXcgU25hcHNob3RNYXA8TG9uZywgQm9vbGVhbj4oKTsKCiAgICAgICAgdGhp\ncy5zY2hlZHVsZXIgPSBFeGVjdXRvcnMubmV3U2luZ2xlVGhyZWFkU2NoZWR1\nbGVkRXhlY3V0b3IoKTsKICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVk\nKCkpIHsKICAgICAgICAgICAgTE9HLmRlYnVnKCJVc2luZyBIaWVyYXJjaGlj\nYWxMZWRnZXJNYW5hZ2VyIHdpdGggcm9vdCBwYXRoIDogIiArIGxlZGdlclJv\nb3RQYXRoKTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBzY2hlZHVsZXIuc2h1dGRvd24oKTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBMT0cud2FybigiRXJyb3Igd2hlbiBj\nbG9zaW5nIEhpZXJhcmNoaWNhbExlZGdlck1hbmFnZXIgOiAiLCBlKTsKICAg\nICAgICB9CiAgICAgICAgc3VwZXIuY2xvc2UoKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyB2b2lkIG5ld0xlZGdlclBhdGgoZmluYWwgR2Vu\nZXJpY0NhbGxiYWNrPFN0cmluZz4gbGVkZ2VyQ2IsIGZpbmFsIExlZGdlck1l\ndGFkYXRhIG1ldGFkYXRhKSB7CiAgICAgICAgWmtVdGlscy5jcmVhdGVGdWxs\nUGF0aE9wdGltaXN0aWMoemssIGlkR2VuUGF0aCwgbmV3IGJ5dGVbMF0sIElk\ncy5PUEVOX0FDTF9VTlNBRkUsCiAgICAgICAgICAgIENyZWF0ZU1vZGUuRVBI\nRU1FUkFMX1NFUVVFTlRJQUwsIG5ldyBTdHJpbmdDYWxsYmFjaygpIHsKICAg\nICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHBy\nb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCwg\nZmluYWwgU3RyaW5nIGlkUGF0aE5hbWUpIHsKICAgICAgICAgICAgICAgIGlm\nIChyYyAhPSBLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7\nCiAgICAgICAgICAgICAgICAgICAgTE9HLmVycm9yKCJDb3VsZCBub3QgZ2Vu\nZXJhdGUgbmV3IGxlZGdlciBpZCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIEtlZXBlckV4Y2VwdGlvbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9u\nLkNvZGUuZ2V0KHJjKSwgcGF0aCkpOwogICAgICAgICAgICAgICAgICAgIGxl\nZGdlckNiLm9wZXJhdGlvbkNvbXBsZXRlKHJjLCBudWxsKTsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAvKgogICAgICAgICAgICAgICAgICogRXh0cmFjdCBsZWRnZXIg\naWQgZnJvbSBnZW4gcGF0aAogICAgICAgICAgICAgICAgICovCiAgICAgICAg\nICAgICAgICBsb25nIGxlZGdlcklkOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICBsZWRnZXJJZCA9IGdldExlZGdlcklkRnJv\nbUdlblBhdGgoaWRQYXRoTmFtZSk7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgTE9HLmVy\ncm9yKCJDb3VsZCBub3QgZXh0cmFjdCBsZWRnZXItaWQgZnJvbSBpZCBnZW4g\ncGF0aDoiICsgcGF0aCwgZSk7CiAgICAgICAgICAgICAgICAgICAgbGVkZ2Vy\nQ2Iub3BlcmF0aW9uQ29tcGxldGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuU1lT\nVEVNRVJST1IuaW50VmFsdWUoKSwgbnVsbCk7CiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nU3RyaW5nQ2FsbGJhY2sgc2NiID0gbmV3IFN0cmluZ0NhbGxiYWNrKCkgewog\nICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcg\ncGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdCBjdHgs\nIFN0cmluZyBuYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChy\nYyAhPSBLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBsZWRnZXJDYi5vcGVyYXRpb25D\nb21wbGV0ZShyYywgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUg\nem5vZGUgc3RhdHVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRh\nZGF0YS51cGRhdGVabm9kZVN0YXR1cygwKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGxlZGdlckNiLm9wZXJhdGlvbkNvbXBsZXRlKHJjLCBuYW1l\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBTdHJp\nbmcgbGVkZ2VyUGF0aCA9IGdldExlZGdlclBhdGgobGVkZ2VySWQpOwogICAg\nICAgICAgICAgICAgWmtVdGlscy5jcmVhdGVGdWxsUGF0aE9wdGltaXN0aWMo\nemssIGxlZGdlclBhdGgsIG1ldGFkYXRhLnNlcmlhbGl6ZSgpLAogICAgICAg\nICAgICAgICAgICAgIElkcy5PUEVOX0FDTF9VTlNBRkUsIENyZWF0ZU1vZGUu\nUEVSU0lTVEVOVCwgc2NiLCBudWxsKTsKICAgICAgICAgICAgICAgIC8vIGRl\nbGV0ZSB0aGUgem5vZGUgZm9yIGlkIGdlbmVyYXRpb24KICAgICAgICAgICAg\nICAgIHNjaGVkdWxlci5zdWJtaXQobmV3IFJ1bm5hYmxlKCkgewogICAgICAg\nICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgemsu\nZGVsZXRlKGlkUGF0aE5hbWUsIC0xLCBuZXcgQXN5bmNDYWxsYmFjay5Wb2lk\nQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0\neCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYyAh\nPSBLZWVwZXJFeGNlcHRpb24uQ29kZS5PSy5pbnRWYWx1ZSgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJFeGNl\ncHRpb24gZHVyaW5nIGRlbGV0aW5nIHpub2RlIGZvciBpZCBnZW5lcmF0aW9u\nIDogIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgS2VlcGVyRXhjZXB0aW9uLmNyZWF0ZShLZWVwZXJFeGNlcHRpb24u\nQ29kZS5nZXQocmMpLCBwYXRoKSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKExPRy5pc0RlYnVnRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoIkRl\nbGV0aW5nIHpub2RlIGZvciBpZCBnZW5lcmF0aW9uIDogIiArIGlkUGF0aE5h\nbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBu\ndWxsKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIG51bGwpOwogICAgfQoKICAg\nIC8vIGdldCBsZWRnZXIgaWQgZnJvbSBnZW5lcmF0aW9uIHBhdGgKICAgIHBy\naXZhdGUgbG9uZyBnZXRMZWRnZXJJZEZyb21HZW5QYXRoKFN0cmluZyBub2Rl\nTmFtZSkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBsb25nIGxlZGdl\ncklkOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN0cmluZyBwYXJ0c1td\nID0gbm9kZU5hbWUuc3BsaXQoSURHRU5FUkFUSU9OX1BSRUZJWCk7CiAgICAg\nICAgICAgIGxlZGdlcklkID0gTG9uZy5wYXJzZUxvbmcocGFydHNbcGFydHMu\nbGVuZ3RoIC0gMV0pOwogICAgICAgIH0gY2F0Y2ggKE51bWJlckZvcm1hdEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlv\nbihlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGxlZGdlcklkOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXRMZWRnZXJQ\nYXRoKGxvbmcgbGVkZ2VySWQpIHsKICAgICAgICBTdHJpbmcgbGVkZ2VySWRT\ndHIgPSBTdHJpbmdVdGlscy5nZXRaS1N0cmluZ0lkKGxlZGdlcklkKTsKICAg\nICAgICAvLyBkbyAyLTQtNCBzcGxpdAogICAgICAgIFN0cmluZ0J1aWxkZXIg\nc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIHNiLmFwcGVuZChs\nZWRnZXJSb290UGF0aCkuYXBwZW5kKCIvIikKICAgICAgICAgIC5hcHBlbmQo\nbGVkZ2VySWRTdHIuc3Vic3RyaW5nKDAsIDIpKS5hcHBlbmQoIi8iKQogICAg\nICAgICAgLmFwcGVuZChsZWRnZXJJZFN0ci5zdWJzdHJpbmcoMiwgNikpLmFw\ncGVuZCgiLyIpCiAgICAgICAgICAuYXBwZW5kKExFREdFUl9OT0RFX1BSRUZJ\nWCkuYXBwZW5kKGxlZGdlcklkU3RyLnN1YnN0cmluZyg2LCAxMCkpOwogICAg\nICAgIHJldHVybiBzYi50b1N0cmluZygpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIGxvbmcgZ2V0TGVkZ2VySWQoU3RyaW5nIHBhdGhOYW1l\nKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmICghcGF0aE5hbWUu\nc3RhcnRzV2l0aChsZWRnZXJSb290UGF0aCkpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IElPRXhjZXB0aW9uKCJpdCBpcyBub3QgYSB2YWxpZCBoYXNoZWQg\ncGF0aCBuYW1lIDogIiArIHBhdGhOYW1lKTsKICAgICAgICB9CiAgICAgICAg\nU3RyaW5nIGhpZXJhcmNoaWNhbFBhdGggPSBwYXRoTmFtZS5zdWJzdHJpbmco\nbGVkZ2VyUm9vdFBhdGgubGVuZ3RoKCkgKyAxKTsKICAgICAgICBTdHJpbmdb\nXSBoaWVyYXJjaGljYWxQYXJ0cyA9IGhpZXJhcmNoaWNhbFBhdGguc3BsaXQo\nIi8iKTsKICAgICAgICBpZiAoaGllcmFyY2hpY2FsUGFydHMubGVuZ3RoICE9\nIDMpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJpdCBp\ncyBub3QgYSB2YWxpZCBoaWVyYXJjaGljYWwgcGF0aCBuYW1lIDogIiArIHBh\ndGhOYW1lKTsKICAgICAgICB9CiAgICAgICAgaGllcmFyY2hpY2FsUGFydHNb\nMl0gPQogICAgICAgICAgICBoaWVyYXJjaGljYWxQYXJ0c1syXS5zdWJzdHJp\nbmcoTEVER0VSX05PREVfUFJFRklYLmxlbmd0aCgpKTsKICAgICAgICByZXR1\ncm4gZ2V0TGVkZ2VySWQoaGllcmFyY2hpY2FsUGFydHMpOwogICAgfQoKICAg\nIC8vIGdldCBsZWRnZXIgZnJvbSBhbGwgbGV2ZWwgbm9kZXMKICAgIHByaXZh\ndGUgbG9uZyBnZXRMZWRnZXJJZChTdHJpbmcuLi5sZXZlbE5vZGVzKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN0\ncmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nICAgICBmb3IgKFN0cmluZyBub2RlIDogbGV2ZWxOb2RlcykgewogICAgICAg\nICAgICAgICAgc2IuYXBwZW5kKG5vZGUpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHJldHVybiBMb25nLnBhcnNlTG9uZyhzYi50b1N0cmluZygpKTsK\nICAgICAgICB9IGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oZSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8vCiAgICAvLyBBY3RpdmUgTGVkZ2VyIE1hbmFnZXIK\nICAgIC8vCgogICAgLyoqCiAgICAgKiBHZXQgdGhlIHNtYWxsZXN0IGNhY2hl\nIGlkIGluIGEgc3BlY2lmaWVkIG5vZGUgL2xldmVsMS9sZXZlbDIKICAgICAq\nCiAgICAgKiBAcGFyYW0gbGV2ZWwxCiAgICAgKiAgICAgICAgICAxc3QgbGV2\nZWwgbm9kZSBuYW1lCiAgICAgKiBAcGFyYW0gbGV2ZWwyCiAgICAgKiAgICAg\nICAgICAybmQgbGV2ZWwgbm9kZSBuYW1lCiAgICAgKiBAcmV0dXJuIHRoZSBz\nbWFsbGVzdCBsZWRnZXIgaWQKICAgICAqLwogICAgcHJpdmF0ZSBsb25nIGdl\ndFN0YXJ0TGVkZ2VySWRCeUxldmVsKFN0cmluZyBsZXZlbDEsIFN0cmluZyBs\nZXZlbDIpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGdl\ndExlZGdlcklkKGxldmVsMSwgbGV2ZWwyLCBNSU5fSURfU1VGRklYKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEdldCB0aGUgbGFyZ2VzdCBjYWNoZSBpZCBp\nbiBhIHNwZWNpZmllZCBub2RlIC9sZXZlbDEvbGV2ZWwyCiAgICAgKgogICAg\nICogQHBhcmFtIGxldmVsMQogICAgICogICAgICAgICAgMXN0IGxldmVsIG5v\nZGUgbmFtZQogICAgICogQHBhcmFtIGxldmVsMgogICAgICogICAgICAgICAg\nMm5kIGxldmVsIG5vZGUgbmFtZQogICAgICogQHJldHVybiB0aGUgbGFyZ2Vz\ndCBsZWRnZXIgaWQKICAgICAqLwogICAgcHJpdmF0ZSBsb25nIGdldEVuZExl\nZGdlcklkQnlMZXZlbChTdHJpbmcgbGV2ZWwxLCBTdHJpbmcgbGV2ZWwyKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIHJldHVybiBnZXRMZWRnZXJJ\nZChsZXZlbDEsIGxldmVsMiwgTUFYX0lEX1NVRkZJWCk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBhc3luY1Byb2Nlc3NMZWRnZXJz\nKGZpbmFsIFByb2Nlc3NvcjxMb25nPiBwcm9jZXNzb3IsCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2su\nVm9pZENhbGxiYWNrIGZpbmFsQ2IsIGZpbmFsIE9iamVjdCBjb250ZXh0LAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbCBpbnQg\nc3VjY2Vzc1JjLCBmaW5hbCBpbnQgZmFpbHVyZVJjKSB7CiAgICAgICAgLy8g\ncHJvY2VzcyAxc3QgbGV2ZWwgbm9kZXMKICAgICAgICBhc3luY1Byb2Nlc3NM\nZXZlbE5vZGVzKGxlZGdlclJvb3RQYXRoLCBuZXcgUHJvY2Vzc29yPFN0cmlu\nZz4oKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJs\naWMgdm9pZCBwcm9jZXNzKGZpbmFsIFN0cmluZyBsMU5vZGUsIGZpbmFsIEFz\neW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGNiMSkgewogICAgICAgICAgICAg\nICAgaWYgKGlzU3BlY2lhbFpub2RlKGwxTm9kZSkpIHsKICAgICAgICAgICAg\nICAgICAgICBjYjEucHJvY2Vzc1Jlc3VsdChzdWNjZXNzUmMsIG51bGwsIGNv\nbnRleHQpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIGZpbmFsIFN0cmluZyBsMU5vZGVQ\nYXRoID0gbGVkZ2VyUm9vdFBhdGggKyAiLyIgKyBsMU5vZGU7CiAgICAgICAg\nICAgICAgICAvLyBwcm9jZXNzIGxldmVsMSBwYXRoLCBhZnRlciBhbGwgY2hp\nbGRyZW4gb2YgbGV2ZWwxIHByb2Nlc3MKICAgICAgICAgICAgICAgIC8vIGl0\nIGNhbGxiYWNrIHRvIGNvbnRpbnVlIHByb2Nlc3NpbmcgbmV4dCBsZXZlbDEg\nbm9kZQogICAgICAgICAgICAgICAgYXN5bmNQcm9jZXNzTGV2ZWxOb2Rlcyhs\nMU5vZGVQYXRoLCBuZXcgUHJvY2Vzc29yPFN0cmluZz4oKSB7CiAgICAgICAg\nICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIHZvaWQgcHJvY2VzcyhTdHJpbmcgbDJOb2RlLCBBc3luY0NhbGxiYWNr\nLlZvaWRDYWxsYmFjayBjYjIpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gcHJvY2VzcyBsZXZlbDEvbGV2ZWwyIHBhdGgKICAgICAgICAgICAgICAg\nICAgICAgICAgU3RyaW5nIGwyTm9kZVBhdGggPSBsZWRnZXJSb290UGF0aCAr\nICIvIiArIGwxTm9kZSArICIvIiArIGwyTm9kZTsKICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gcHJvY2VzcyBlYWNoIGxlZGdlcgogICAgICAgICAgICAg\nICAgICAgICAgICAvLyBhZnRlciBhbGwgbGVkZ2VyIGFyZSBwcm9jZXNzZWQs\nIGNiMiB3aWxsIGJlIGNhbGwgdG8gY29udGludWUgcHJvY2Vzc2luZyBuZXh0\nIGxldmVsMiBub2RlCiAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jUHJv\nY2Vzc0xlZGdlcnNJblNpbmdsZU5vZGUobDJOb2RlUGF0aCwgcHJvY2Vzc29y\nLCBjYjIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJl\nUmMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0s\nIGNiMSwgY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAgICAg\nICAgICB9CiAgICAgICAgfSwgZmluYWxDYiwgY29udGV4dCwgc3VjY2Vzc1Jj\nLCBmYWlsdXJlUmMpOwogICAgfQoKICAgIC8qKgogICAgICogUHJvY2VzcyBo\nYXNoIG5vZGVzIGluIGEgZ2l2ZW4gcGF0aAogICAgICovCiAgICBwcml2YXRl\nIHZvaWQgYXN5bmNQcm9jZXNzTGV2ZWxOb2RlcygKICAgICAgICBmaW5hbCBT\ndHJpbmcgcGF0aCwgZmluYWwgUHJvY2Vzc29yPFN0cmluZz4gcHJvY2Vzc29y\nLAogICAgICAgIGZpbmFsIEFzeW5jQ2FsbGJhY2suVm9pZENhbGxiYWNrIGZp\nbmFsQ2IsIGZpbmFsIE9iamVjdCBjb250ZXh0LAogICAgICAgIGZpbmFsIGlu\ndCBzdWNjZXNzUmMsIGZpbmFsIGludCBmYWlsdXJlUmMpIHsKICAgICAgICB6\nay5zeW5jKHBhdGgsIG5ldyBBc3luY0NhbGxiYWNrLlZvaWRDYWxsYmFjaygp\nIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2\nb2lkIHByb2Nlc3NSZXN1bHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0\nIGN0eCkgewogICAgICAgICAgICAgICAgaWYgKHJjICE9IENvZGUuT0suaW50\nVmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXJy\nb3Igc3luY2luZyBwYXRoICIgKyBwYXRoICsgIiB3aGVuIGdldHRpbmcgaXRz\nIGNoaWRyZW46ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEtl\nZXBlckV4Y2VwdGlvbi5jcmVhdGUoS2VlcGVyRXhjZXB0aW9uLkNvZGUuZ2V0\nKHJjKSwgcGF0aCkpOwogICAgICAgICAgICAgICAgICAgIGZpbmFsQ2IucHJv\nY2Vzc1Jlc3VsdChmYWlsdXJlUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgICAgICB6ay5nZXRDaGlsZHJlbihwYXRoLCBmYWxzZSwgbmV3IEFz\neW5jQ2FsbGJhY2suQ2hpbGRyZW5DYWxsYmFjaygpIHsKICAgICAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\ndm9pZCBwcm9jZXNzUmVzdWx0KGludCByYywgU3RyaW5nIHBhdGgsIE9iamVj\ndCBjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBMaXN0PFN0cmluZz4gbGV2ZWxOb2RlcykgewogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAocmMgIT0gQ29kZS5PSy5pbnRWYWx1ZSgpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9y\nIHBvbGxpbmcgaGFzaCBub2RlcyBvZiAiICsgcGF0aCwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBLZWVwZXJFeGNlcHRpb24uY3Jl\nYXRlKEtlZXBlckV4Y2VwdGlvbi5Db2RlLmdldChyYyksIHBhdGgpKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jlc3Vs\ndChmYWlsdXJlUmMsIG51bGwsIGNvbnRleHQpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgICAgIEFzeW5jTGlzdFByb2Nlc3NvcjxT\ndHJpbmc+IGxpc3RQcm9jZXNzb3IgPQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG5ldyBBc3luY0xpc3RQcm9jZXNzb3I8U3RyaW5nPihzY2hl\nZHVsZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9jZXNzIGl0\ncyBjaGlsZHJlbgogICAgICAgICAgICAgICAgICAgICAgICBsaXN0UHJvY2Vz\nc29yLnByb2Nlc3MobGV2ZWxOb2RlcywgcHJvY2Vzc29yLCBmaW5hbENiLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nY29udGV4dCwgc3VjY2Vzc1JjLCBmYWlsdXJlUmMpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIG51bGwpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSwgbnVsbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgdm9pZCBhZGRBY3RpdmVMZWRnZXIobG9uZyBsZWRnZXJJZCwg\nYm9vbGVhbiBhY3RpdmUpIHsKICAgICAgICBhY3RpdmVMZWRnZXJzLnB1dChs\nZWRnZXJJZCwgYWN0aXZlKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyB2b2lkIHJlbW92ZUFjdGl2ZUxlZGdlcihsb25nIGxlZGdlcklkKSB7\nCiAgICAgICAgYWN0aXZlTGVkZ2Vycy5yZW1vdmUobGVkZ2VySWQpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNB\nY3RpdmVMZWRnZXIobG9uZyBsZWRnZXJJZCkgewogICAgICAgIHJldHVybiBh\nY3RpdmVMZWRnZXJzLmNvbnRhaW5zS2V5KGxlZGdlcklkKTsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGdhcmJhZ2VDb2xsZWN0TGVk\nZ2VycyhHYXJiYWdlQ29sbGVjdG9yIGdjKSB7CiAgICAgICAgLy8gY3JlYXRl\nIGEgc25hcHNob3QgYmVmb3JlIGdhcmJhZ2UgY29sbGVjdGlvbgogICAgICAg\nIE5hdmlnYWJsZU1hcDxMb25nLCBCb29sZWFuPiBzbmFwc2hvdCA9IGFjdGl2\nZUxlZGdlcnMuc25hcHNob3QoKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBMaXN0PFN0cmluZz4gbDFOb2RlcyA9IHprLmdldENoaWxkcmVuKGxlZGdl\nclJvb3RQYXRoLCBudWxsKTsKICAgICAgICAgICAgZm9yIChTdHJpbmcgbDFO\nb2RlIDogbDFOb2RlcykgewogICAgICAgICAgICAgICAgaWYgKGlzU3BlY2lh\nbFpub2RlKGwxTm9kZSkpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGwyTm9kZXMgPSB6ay5n\nZXRDaGlsZHJlbihsZWRnZXJSb290UGF0aCArICIvIiArIGwxTm9kZSwgbnVs\nbCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChTdHJpbmcgbDJOb2RlIDog\nbDJOb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICBkb0djQnlMZXZl\nbChnYywgbDFOb2RlLCBsMk5vZGUsIHNuYXBzaG90KTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgICAgIExPRy53YXJuKCJFeGNlcHRpb24g\nZHVyaW5nIGdhcmJhZ2UgY29sbGVjdGluZyBsZWRnZXJzIGZvciAiICsgbDFO\nb2RlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIG9mICIgKyBs\nZWRnZXJSb290UGF0aCwgZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICBMT0cud2FybigiRXhjZXB0aW9uIGR1cmluZyBnYXJiYWdlIGNvbGxl\nY3RpbmcgaW5hY3RpdmUvZGVsZXRlZCBsZWRnZXJzIiwgZSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogR2FyYmFnZSBjb2xsZWN0aW9uIGEg\nc2luZ2xlIG5vZGUgbGV2ZWwxL2xldmVsMgogICAgICoKICAgICAqIEBwYXJh\nbSBnYwogICAgICogICAgICAgICAgR2FyYmFnZSBjb2xsZWN0b3IKICAgICAq\nIEBwYXJhbSBsZXZlbDEKICAgICAqICAgICAgICAgIDFzdCBsZXZlbCBub2Rl\nIG5hbWUKICAgICAqIEBwYXJhbSBsZXZlbDIKICAgICAqICAgICAgICAgIDJu\nZCBsZXZlbCBub2RlIG5hbWUKICAgICAqIEBwYXJhbSBzbmFwc2hvdAogICAg\nICogICAgICAgICAgU25hcHNob3Qgb2YgdGhlIGFjdGl2ZSBsZWRnZXJzIG1h\ncC4KICAgICAqIEB0aHJvd3MgSU9FeGNlcHRpb24KICAgICAqIEB0aHJvd3Mg\nSW50ZXJydXB0ZWRFeGNlcHRpb24KICAgICAqLwogICAgdm9pZCBkb0djQnlM\nZXZlbChHYXJiYWdlQ29sbGVjdG9yIGdjLCBmaW5hbCBTdHJpbmcgbGV2ZWwx\nLCBmaW5hbCBTdHJpbmcgbGV2ZWwyLAogICAgICAgICAgICAgICAgICAgICBO\nYXZpZ2FibGVNYXAgc25hcHNob3QpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0\naW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CgogICAgICAgIFN0cmluZ0J1\naWxkZXIgbm9kZUJ1aWxkZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAg\nICAgIG5vZGVCdWlsZGVyLmFwcGVuZChsZWRnZXJSb290UGF0aCkuYXBwZW5k\nKCIvIikKICAgICAgICAgICAgICAgICAgIC5hcHBlbmQobGV2ZWwxKS5hcHBl\nbmQoIi8iKS5hcHBlbmQobGV2ZWwyKTsKICAgICAgICBTdHJpbmcgbm9kZVBh\ndGggPSBub2RlQnVpbGRlci50b1N0cmluZygpOwoKICAgICAgICBTZXQ8TG9u\nZz4gemtBY3RpdmVMZWRnZXJzID0gZ2V0TGVkZ2Vyc0luU2luZ2xlTm9kZShu\nb2RlUGF0aCk7CiAgICAgICAgLy8gZ2V0IGhvc3RlZCBsZWRnZXJzIGluIC9s\nZXZlbDEvbGV2ZWwyCiAgICAgICAgbG9uZyBzdGFydExlZGdlcklkID0gZ2V0\nU3RhcnRMZWRnZXJJZEJ5TGV2ZWwobGV2ZWwxLCBsZXZlbDIpOwogICAgICAg\nIGxvbmcgZW5kTGVkZ2VySWQgPSBnZXRFbmRMZWRnZXJJZEJ5TGV2ZWwobGV2\nZWwxLCBsZXZlbDIpOwogICAgICAgIE1hcDxMb25nLCBCb29sZWFuPiBia0Fj\ndGl2ZUxlZGdlcnMgPSBzbmFwc2hvdC5zdWJNYXAoc3RhcnRMZWRnZXJJZCwg\ndHJ1ZSwgZW5kTGVkZ2VySWQsIHRydWUpOwogICAgICAgIGlmIChMT0cuaXNE\nZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICBMT0cuZGVidWcoIkFsbCBh\nY3RpdmUgbGVkZ2VycyBmcm9tIFpLIGZvciBoYXNoIG5vZGUgIgogICAgICAg\nICAgICAgICAgICAgICAgKyBsZXZlbDEgKyAiLyIgKyBsZXZlbDIgKyAiIDog\nIiArIHprQWN0aXZlTGVkZ2Vycyk7CiAgICAgICAgICAgIExPRy5kZWJ1Zygi\nQ3VycmVudCBhY3RpdmUgbGVkZ2VycyBmcm9tIEJvb2tpZSBmb3IgaGFzaCBu\nb2RlICIKICAgICAgICAgICAgICAgICAgICAgICsgbGV2ZWwxICsgIi8iICsg\nbGV2ZWwyICsgIiA6ICIgKyBia0FjdGl2ZUxlZGdlcnMpOwogICAgICAgIH0K\nCiAgICAgICAgZG9HYyhnYywgYmtBY3RpdmVMZWRnZXJzLCB6a0FjdGl2ZUxl\nZGdlcnMpOwogICAgfQoKICAgIC8qKgogICAgICogUHJvY2VzcyBsaXN0IG9u\nZSBieSBvbmUgaW4gYXN5bmNocm9uaXplIHdheS4gUHJvY2VzcyB3aWxsIGJl\nIHN0b3BwZWQgaW1tZWRpYXRlbHkKICAgICAqIHdoZW4gZXJyb3Igb2NjdXJy\nZWQuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIEFzeW5jTGlz\ndFByb2Nlc3NvcjxUPiB7CiAgICAgICAgLy8gdXNlIHRoaXMgdG8gcHJldmVu\ndCBsb25nIHN0YWNrIGNoYWlucyBmcm9tIGJ1aWxkaW5nIHVwIGluIGNhbGxi\nYWNrcwogICAgICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hlZHVs\nZXI7CgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdG9yCiAgICAg\nICAgICoKICAgICAgICAgKiBAcGFyYW0gc2NoZWR1bGVyCiAgICAgICAgICog\nICAgICAgICAgRXhlY3V0b3IgdXNlZCB0byBwcmV2ZW50IGxvbmcgc3RhY2sg\nY2hhaW5zCiAgICAgICAgICovCiAgICAgICAgcHVibGljIEFzeW5jTGlzdFBy\nb2Nlc3NvcihTY2hlZHVsZWRFeGVjdXRvclNlcnZpY2Ugc2NoZWR1bGVyKSB7\nCiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUHJvY2VzcyBsaXN0IG9m\nIGl0ZW1zCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gZGF0YQogICAg\nICAgICAqICAgICAgICAgIExpc3Qgb2YgZGF0YSB0byBwcm9jZXNzCiAgICAg\nICAgICogQHBhcmFtIHByb2Nlc3NvcgogICAgICAgICAqICAgICAgICAgIENh\nbGxiYWNrIHRvIHByb2Nlc3MgZWxlbWVudCBvZiBsaXN0IHdoZW4gc3VjY2Vz\ncwogICAgICAgICAqIEBwYXJhbSBmaW5hbENiCiAgICAgICAgICogICAgICAg\nICAgRmluYWwgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIGFmdGVyIGFsbCBlbGVt\nZW50cyBpbiB0aGUgbGlzdCBhcmUgcHJvY2Vzc2VkCiAgICAgICAgICogQHBh\ncmFtIGNvbnR4dAogICAgICAgICAqICAgICAgICAgIENvbnRleHQgb2YgZmlu\nYWwgY2FsbGJhY2sKICAgICAgICAgKiBAcGFyYW0gc3VjY2Vzc1JjCiAgICAg\nICAgICogICAgICAgICAgUkMgcGFzc2VkIHRvIGZpbmFsIGNhbGxiYWNrIG9u\nIHN1Y2Nlc3MKICAgICAgICAgKiBAcGFyYW0gZmFpbHVyZVJjCiAgICAgICAg\nICogICAgICAgICAgUkMgcGFzc2VkIHRvIGZpbmFsIGNhbGxiYWNrIG9uIGZh\naWx1cmUKICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBwcm9jZXNz\nKGZpbmFsIExpc3Q8VD4gZGF0YSwgZmluYWwgUHJvY2Vzc29yPFQ+IHByb2Nl\nc3NvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIEFzeW5j\nQ2FsbGJhY2suVm9pZENhbGxiYWNrIGZpbmFsQ2IsIGZpbmFsIE9iamVjdCBj\nb250ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWwgaW50\nIHN1Y2Nlc3NSYywgZmluYWwgaW50IGZhaWx1cmVSYykgewogICAgICAgICAg\nICBpZiAoZGF0YSA9PSBudWxsIHx8IGRhdGEuc2l6ZSgpID09IDApIHsKICAg\nICAgICAgICAgICAgIGZpbmFsQ2IucHJvY2Vzc1Jlc3VsdChzdWNjZXNzUmMs\nIG51bGwsIGNvbnRleHQpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGZpbmFsIGludCBzaXplID0gZGF0YS5z\naXplKCk7CiAgICAgICAgICAgIGZpbmFsIEF0b21pY0ludGVnZXIgY3VycmVu\ndCA9IG5ldyBBdG9taWNJbnRlZ2VyKDApOwogICAgICAgICAgICBBc3luY0Nh\nbGxiYWNrLlZvaWRDYWxsYmFjayBzdHViQ2FsbGJhY2sgPSBuZXcgQXN5bmND\nYWxsYmFjay5Wb2lkQ2FsbGJhY2soKSB7CiAgICAgICAgICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHByb2Nlc3NSZXN1\nbHQoaW50IHJjLCBTdHJpbmcgcGF0aCwgT2JqZWN0IGN0eCkgewogICAgICAg\nICAgICAgICAgICAgIGlmIChyYyAhPSBzdWNjZXNzUmMpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gdGVybWluYWwgaW1tZWRpYXRlbHkKICAgICAg\nICAgICAgICAgICAgICAgICAgZmluYWxDYi5wcm9jZXNzUmVzdWx0KGZhaWx1\ncmVSYywgbnVsbCwgY29udGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgLy8gcHJvY2VzcyBuZXh0IGVsZW1lbnQKICAgICAgICAgICAgICAg\nICAgICBpbnQgbmV4dCA9IGN1cnJlbnQuaW5jcmVtZW50QW5kR2V0KCk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKG5leHQgPj0gc2l6ZSkgeyAvLyByZWFj\naCB0aGUgZW5kIG9mIGxpc3QKICAgICAgICAgICAgICAgICAgICAgICAgZmlu\nYWxDYi5wcm9jZXNzUmVzdWx0KHN1Y2Nlc3NSYywgbnVsbCwgY29udGV4dCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZmluYWwgVCBkYXRhVG9Q\ncm9jZXNzID0gZGF0YS5nZXQobmV4dCk7CiAgICAgICAgICAgICAgICAgICAg\nZmluYWwgQXN5bmNDYWxsYmFjay5Wb2lkQ2FsbGJhY2sgc3R1YiA9IHRoaXM7\nCiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLnN1Ym1pdChuZXcgUnVu\nbmFibGUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWMgZmluYWwgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzb3IucHJv\nY2VzcyhkYXRhVG9Qcm9jZXNzLCBzdHViKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBUIGZpcnN0RWxlbWVu\ndCA9IGRhdGEuZ2V0KDApOwogICAgICAgICAgICBwcm9jZXNzb3IucHJvY2Vz\ncyhmaXJzdEVsZW1lbnQsIHN0dWJDYWxsYmFjayk7CiAgICAgICAgfQogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNTcGVj\naWFsWm5vZGUoU3RyaW5nIHpub2RlKSB7CiAgICAgICAgcmV0dXJuIElER0VO\nX1pOT0RFLmVxdWFscyh6bm9kZSkgfHwgc3VwZXIuaXNTcGVjaWFsWm5vZGUo\nem5vZGUpOwogICAgfQp9Cg==\n","encoding":"base64"}

