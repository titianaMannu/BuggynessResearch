{"sha":"cab02feaa8656adc9c0c47a28170a715a2849643","node_id":"MDQ6QmxvYjE1NzU5NTY6Y2FiMDJmZWFhODY1NmFkYzljMGM0N2EyODE3MGE3MTVhMjg0OTY0Mw==","size":6838,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/cab02feaa8656adc9c0c47a28170a715a2849643","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIubWV0YTsKCi8qKgogKiBM\naWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFT\nRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBh\nZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgog\nKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGlj\nZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91IG1h\neSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQogKiB3\naXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo\nZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0\nd2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3Bl\nY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBs\naW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5DcmVhdGVNb2RlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2Vl\ncGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9v\nRGVmcy5JZHM7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5kYXRhLlN0\nYXQ7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7Cgpp\nbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXJGYWN0b3J5OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jb25maWd1\ncmF0aW9uLkNvbmZpZ3VyYXRpb25FeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNvbmYuQWJzdHJhY3RDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuRmxhdExlZGdlck1h\nbmFnZXI7CgovKioKICogVGhpcyBjbGFzcyBlbmNhcHN1bGF0ZXMgbGVkZ2Vy\nIGxheW91dCBpbmZvcm1hdGlvbiB0aGF0IGlzIHBlcnNpc3RlbnRseSBzdG9y\nZWQKICogaW4gem9va2VlcGVyLiBJdCBwcm92aWRlcyBwYXJzaW5nIGFuZCBz\nZXJpYWxpemF0aW9uIG1ldGhvZHMgb2Ygc3VjaCBpbmZvcm1hdGlvbi4KICoK\nICovCmNsYXNzIExlZGdlckxheW91dCB7CiAgICBzdGF0aWMgZmluYWwgTG9n\nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKExlZGdlckxheW91\ndC5jbGFzcyk7CgogICAgLy8gWm5vZGUgbmFtZSB0byBzdG9yZSBsYXlvdXQg\naW5mb3JtYXRpb24KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIExB\nWU9VVF9aTk9ERSA9ICJMQVlPVVQiOwogICAgLy8gdmVyc2lvbiBvZiBsZWRn\nZXIgbGF5b3V0IG1ldGFkYXRhCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGlu\ndCBMQVlPVVRfRk9STUFUX1ZFUlNJT04gPSAxOwoKICAgIC8qKgogICAgICog\nUmVhZCBsZWRnZXIgbGF5b3V0IGZyb20gem9va2VlcGVyCiAgICAgKgogICAg\nICogQHBhcmFtIHprICAgICAgICAgICAgWm9vS2VlcGVyIENsaWVudAogICAg\nICogQHBhcmFtIGxlZGdlcnNSb290ICAgUm9vdCBvZiB0aGUgbGVkZ2VyIG5h\nbWVzcGFjZSB0byBjaGVjawogICAgICogQHJldHVybiBsZWRnZXIgbGF5b3V0\nLCBvciBudWxsIGlmIG5vbmUgc2V0IGluIHpvb2tlZXBlcgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIExlZGdlckxheW91dCByZWFkTGF5b3V0KGZpbmFs\nIFpvb0tlZXBlciB6aywgZmluYWwgU3RyaW5nIGxlZGdlcnNSb290KQogICAg\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiB7\nCiAgICAgICAgU3RyaW5nIGxlZGdlcnNMYXlvdXQgPSBsZWRnZXJzUm9vdCAr\nICIvIiArIExBWU9VVF9aTk9ERTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgTGVkZ2VyTGF5b3V0IGxheW91dDsKCiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBieXRlW10gbGF5b3V0RGF0YSA9IHprLmdldERhdGEo\nbGVkZ2Vyc0xheW91dCwgZmFsc2UsIG51bGwpOwogICAgICAgICAgICAgICAg\nbGF5b3V0ID0gcGFyc2VMYXlvdXQobGF5b3V0RGF0YSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbi5Ob05vZGVFeGNlcHRpb24gbm5l\nKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAg\nfQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGxheW91dDsKICAg\nICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBpZSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oaWUpOwogICAgICAgIH0K\nICAgIH0KCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIHNwbGl0dGVyID0gIjoi\nOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBsU3BsaXR0ZXIgPSAiXG4iOwoK\nICAgIC8vIGxlZGdlciBtYW5hZ2VyIGNsYXNzCiAgICBwcml2YXRlIFN0cmlu\nZyBtYW5hZ2VyVHlwZTsKICAgIC8vIGxlZGdlciBtYW5hZ2VyIHZlcnNpb24K\nICAgIHByaXZhdGUgaW50IG1hbmFnZXJWZXJzaW9uOwoKICAgIC8vIGxheW91\ndCB2ZXJzaW9uIG9mIGhvdyB0byBzdG9yZSBsYXlvdXQgaW5mb3JtYXRpb24K\nICAgIHByaXZhdGUgaW50IGxheW91dEZvcm1hdFZlcnNpb24gPSBMQVlPVVRf\nRk9STUFUX1ZFUlNJT047CgogICAgLyoqCiAgICAgKiBMZWRnZXIgTGF5b3V0\nIENvbnN0cnVjdG9yCiAgICAgKgogICAgICogQHBhcmFtIHR5cGUKICAgICAq\nICAgICAgICAgIExlZGdlciBNYW5hZ2VyIFR5cGUKICAgICAqIEBwYXJhbSBt\nYW5hZ2VyVmVyc2lvbgogICAgICogICAgICAgICAgTGVkZ2VyIE1hbmFnZXIg\nVmVyc2lvbgogICAgICogQHBhcmFtIGxheW91dEZvcm1hdFZlcnNpb24KICAg\nICAqICAgICAgICAgIExlZGdlciBMYXlvdXQgRm9ybWF0IFZlcnNpb24KICAg\nICAqLwogICAgcHVibGljIExlZGdlckxheW91dChTdHJpbmcgbWFuYWdlclR5\ncGUsIGludCBtYW5hZ2VyVmVyc2lvbikgewogICAgICAgIHRoaXMubWFuYWdl\nclR5cGUgPSBtYW5hZ2VyVHlwZTsKICAgICAgICB0aGlzLm1hbmFnZXJWZXJz\naW9uID0gbWFuYWdlclZlcnNpb247CiAgICB9CgogICAgcHVibGljIFN0cmlu\nZyBnZXRNYW5hZ2VyVHlwZSgpIHsKICAgICAgICByZXR1cm4gdGhpcy5tYW5h\nZ2VyVHlwZTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldE1hbmFnZXJWZXJz\naW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm1hbmFnZXJWZXJzaW9uOwog\nICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgdGhlIGxlZGdlciBsYXlvdXQg\naW50byB6b29rZWVwZXIKICAgICAqLwogICAgcHVibGljIHZvaWQgc3RvcmUo\nZmluYWwgWm9vS2VlcGVyIHprLCBTdHJpbmcgbGVkZ2Vyc1Jvb3QpIAogICAg\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiwg\nSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBsZWRnZXJz\nTGF5b3V0ID0gbGVkZ2Vyc1Jvb3QgKyAiLyIgKyBMQVlPVVRfWk5PREU7CiAg\nICAgICAgemsuY3JlYXRlKGxlZGdlcnNMYXlvdXQsIHNlcmlhbGl6ZSgpLCAK\nICAgICAgICAgICAgICAgICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRl\nTW9kZS5QRVJTSVNURU5UKTsKICAgIH0KCiAgICAvKioKICAgICAqIEdlbmVy\nYXRlcyBhIGJ5dGUgYXJyYXkgYmFzZWQgb24gdGhlIExlZGdlckxheW91dCBv\nYmplY3QuCiAgICAgKgogICAgICogQHJldHVybiBieXRlW10KICAgICAqLwog\nICAgcHJpdmF0ZSBieXRlW10gc2VyaWFsaXplKCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmluZ0J1\naWxkZXIoKTsKICAgICAgICBzYi5hcHBlbmQobGF5b3V0Rm9ybWF0VmVyc2lv\nbikuYXBwZW5kKGxTcGxpdHRlcikKICAgICAgICAgICAgLmFwcGVuZChtYW5h\nZ2VyVHlwZSkuYXBwZW5kKHNwbGl0dGVyKS5hcHBlbmQobWFuYWdlclZlcnNp\nb24pOwoKICAgICAgICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAg\nICAgICAgICAgTE9HLmRlYnVnKCJTZXJpYWxpemVkIGxheW91dCBpbmZvOiAi\nICsgc2IudG9TdHJpbmcoKSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4g\nc2IudG9TdHJpbmcoKS5nZXRCeXRlcygiVVRGLTgiKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlcyBhIGdpdmVuIGJ5dGUgYXJyYXkgYW5kIHRyYW5z\nZm9ybXMgaW50byBhIExlZGdlckxheW91dCBvYmplY3QKICAgICAqCiAgICAg\nKiBAcGFyYW0gYnl0ZXMKICAgICAqICAgICAgICAgIGJ5dGUgYXJyYXkgdG8g\ncGFyc2UKICAgICAqIEBwYXJhbSB6bm9kZVZlcnNpb24KICAgICAqICAgICAg\nICAgIHZlcnNpb24gb2Ygem5vZGUKICAgICAqIEByZXR1cm4gTGVkZ2VyTGF5\nb3V0CiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAgICAgKiAgICAgICAg\nICAgICBpZiB0aGUgZ2l2ZW4gYnl0ZVtdIGNhbm5vdCBiZSBwYXJzZWQKICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgTGVkZ2VyTGF5b3V0IHBhcnNlTGF5\nb3V0KGJ5dGVbXSBieXRlcykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAg\nICBTdHJpbmcgbGF5b3V0ID0gbmV3IFN0cmluZyhieXRlcywgIlVURi04Iik7\nCgogICAgICAgIGlmIChMT0cuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAg\nICAgICBMT0cuZGVidWcoIlBhcnNpbmcgTGF5b3V0OiAiICsgbGF5b3V0KTsK\nICAgICAgICB9CgogICAgICAgIFN0cmluZyBsaW5lc1tdID0gbGF5b3V0LnNw\nbGl0KGxTcGxpdHRlcik7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlu\ndCBsYXlvdXRGb3JtYXRWZXJzaW9uID0gbmV3IEludGVnZXIobGluZXNbMF0p\nOwogICAgICAgICAgICBpZiAoTEFZT1VUX0ZPUk1BVF9WRVJTSU9OICE9IGxh\neW91dEZvcm1hdFZlcnNpb24pIHsKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBJT0V4Y2VwdGlvbigiTWV0YWRhdGEgdmVyc2lvbiBub3QgY29tcGF0aWJs\nZS4gRXhwZWN0ZWQgIiAKICAgICAgICAgICAgICAgICAgICAgICAgKyBMQVlP\nVVRfRk9STUFUX1ZFUlNJT04gKyAiLCBidXQgZ290ICIgKyBsYXlvdXRGb3Jt\nYXRWZXJzaW9uKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGxp\nbmVzLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbigiTGVkZ2VyIG1hbmFnZXIgYW5kIGl0cyB2ZXJzaW9uIGFi\nc2VudCBmcm9tIGxheW91dDogIiArIGxheW91dCk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIFN0cmluZ1tdIHBhcnRzID0gbGluZXNbMV0uc3BsaXQo\nc3BsaXR0ZXIpOwogICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoICE9IDIp\nIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiSW52\nYWxpZCBMZWRnZXIgTWFuYWdlciBkZWZpbmVkIGluIGxheW91dCA6ICIgKyBs\nYXlvdXQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGxlZGdlciBt\nYW5hZ2VyIGNsYXNzCiAgICAgICAgICAgIFN0cmluZyBtYW5hZ2VyVHlwZSA9\nIHBhcnRzWzBdOwogICAgICAgICAgICAvLyBsZWRnZXIgbWFuYWdlciB2ZXJz\naW9uCiAgICAgICAgICAgIGludCBtYW5hZ2VyVmVyc2lvbiA9IG5ldyBJbnRl\nZ2VyKHBhcnRzWzFdKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBMZWRnZXJM\nYXlvdXQobWFuYWdlclR5cGUsIG1hbmFnZXJWZXJzaW9uKTsKICAgICAgICB9\nIGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gZXF1YWxzKE9iamVj\ndCBvYmopIHsKICAgICAgICBpZiAobnVsbCA9PSBvYmopIHsKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIShvYmog\naW5zdGFuY2VvZiBMZWRnZXJMYXlvdXQpKSB7CiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgTGVkZ2VyTGF5b3V0IG90aGVy\nID0gKExlZGdlckxheW91dClvYmo7CiAgICAgICAgcmV0dXJuIG1hbmFnZXJU\neXBlLmVxdWFscyhvdGhlci5tYW5hZ2VyVHlwZSkgJiYKICAgICAgICAgICAg\nbWFuYWdlclZlcnNpb24gPT0gb3RoZXIubWFuYWdlclZlcnNpb247CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewog\nICAgICAgIHJldHVybiAobWFuYWdlclR5cGUgKyBtYW5hZ2VyVmVyc2lvbiku\naGFzaENvZGUoKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBT\ndHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9\nIG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgc2IuYXBwZW5kKCJMViIp\nLmFwcGVuZChsYXlvdXRGb3JtYXRWZXJzaW9uKS5hcHBlbmQoIjoiKQogICAg\nICAgICAgICAuYXBwZW5kKCIsVHlwZToiKS5hcHBlbmQobWFuYWdlclR5cGUp\nLmFwcGVuZCgiOiIpCiAgICAgICAgICAgIC5hcHBlbmQobWFuYWdlclZlcnNp\nb24pOwogICAgICAgIHJldHVybiBzYi50b1N0cmluZygpOwogICAgfQp9Cg==\n","encoding":"base64"}

