{"sha":"8943775db9c827805b5b4f0f1d7bd4e1fce94fca","node_id":"MDQ6QmxvYjE1NzU5NTY6ODk0Mzc3NWRiOWM4Mjc4MDViNWI0ZjBmMWQ3YmQ0ZTFmY2U5NGZjYQ==","size":7229,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8943775db9c827805b5b4f0f1d7bd4e1fce94fca","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5wcm90bzsKCmlt\ncG9ydCBqYXZhLmJlYW5zLkNvbnN0cnVjdG9yUHJvcGVydGllczsKCi8qKgog\nKiBCb29raWUgU2VydmVyIFN0YXRzCiAqLwpwdWJsaWMgY2xhc3MgQktTdGF0\ncyB7CiAgICBwcml2YXRlIHN0YXRpYyBCS1N0YXRzIGluc3RhbmNlID0gbmV3\nIEJLU3RhdHMoKTsKCiAgICBwdWJsaWMgc3RhdGljIEJLU3RhdHMgZ2V0SW5z\ndGFuY2UoKSB7CiAgICAgICAgcmV0dXJuIGluc3RhbmNlOwogICAgfQoKICAg\nIC8qKgogICAgICogQSByZWFkIHZpZXcgb2Ygc3RhdHMsIGFsc28gdXNlZCBp\nbiBDb21wb3NpdGVWaWV3RGF0YSB0byBleHBvc2UgdG8gSk1YCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgT3BTdGF0RGF0YSB7CiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBsb25nIG1heExhdGVuY3ksIG1pbkxhdGVuY3k7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBkb3VibGUgYXZnTGF0ZW5jeTsKICAgICAg\nICBwcml2YXRlIGZpbmFsIGxvbmcgbnVtU3VjY2Vzc09wcywgbnVtRmFpbGVk\nT3BzOwogICAgICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIGxhdGVuY3lIaXN0\nOwoKICAgICAgICBAQ29uc3RydWN0b3JQcm9wZXJ0aWVzKHsibWF4TGF0ZW5j\neSIsICJtaW5MYXRlbmN5IiwgImF2Z0xhdGVuY3kiLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICJudW1TdWNjZXNzT3BzIiwgIm51bUZhaWxl\nZE9wcyIsICJsYXRlbmN5SGlzdCJ9KQogICAgICAgIHB1YmxpYyBPcFN0YXRE\nYXRhKGxvbmcgbWF4TGF0ZW5jeSwgbG9uZyBtaW5MYXRlbmN5LCBkb3VibGUg\nYXZnTGF0ZW5jeSwKICAgICAgICAgICAgICAgICAgICAgICAgICBsb25nIG51\nbVN1Y2Nlc3NPcHMsIGxvbmcgbnVtRmFpbGVkT3BzLCBTdHJpbmcgbGF0ZW5j\neUhpc3QpIHsKICAgICAgICAgICAgdGhpcy5tYXhMYXRlbmN5ID0gbWF4TGF0\nZW5jeTsKICAgICAgICAgICAgdGhpcy5taW5MYXRlbmN5ID0gbWluTGF0ZW5j\neSA9PSBMb25nLk1BWF9WQUxVRSA/IDAgOiBtaW5MYXRlbmN5OwogICAgICAg\nICAgICB0aGlzLmF2Z0xhdGVuY3kgPSBhdmdMYXRlbmN5OwogICAgICAgICAg\nICB0aGlzLm51bVN1Y2Nlc3NPcHMgPSBudW1TdWNjZXNzT3BzOwogICAgICAg\nICAgICB0aGlzLm51bUZhaWxlZE9wcyA9IG51bUZhaWxlZE9wczsKICAgICAg\nICAgICAgdGhpcy5sYXRlbmN5SGlzdCA9IGxhdGVuY3lIaXN0OwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0TWF4TGF0ZW5jeSgpIHsKICAg\nICAgICAgICAgcmV0dXJuIG1heExhdGVuY3k7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgbG9uZyBnZXRNaW5MYXRlbmN5KCkgewogICAgICAgICAgICBy\nZXR1cm4gbWluTGF0ZW5jeTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBk\nb3VibGUgZ2V0QXZnTGF0ZW5jeSgpIHsKICAgICAgICAgICAgcmV0dXJuIGF2\nZ0xhdGVuY3k7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRO\ndW1TdWNjZXNzT3BzKCkgewogICAgICAgICAgICByZXR1cm4gbnVtU3VjY2Vz\nc09wczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBsb25nIGdldE51bUZh\naWxlZE9wcygpIHsKICAgICAgICAgICAgcmV0dXJuIG51bUZhaWxlZE9wczsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgZ2V0TGF0ZW5jeUhp\nc3QoKSB7CiAgICAgICAgICAgIHJldHVybiBsYXRlbmN5SGlzdDsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBPcGVyYXRpb24gU3RhdGlzdGlj\ncwogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIE9wU3RhdHMgewog\nICAgICAgIHN0YXRpYyBmaW5hbCBpbnQgTlVNX0JVQ0tFVFMgPSAzKjkgKyAy\nOwoKICAgICAgICBsb25nIG1heExhdGVuY3kgPSAwOwogICAgICAgIGxvbmcg\nbWluTGF0ZW5jeSA9IExvbmcuTUFYX1ZBTFVFOwogICAgICAgIGRvdWJsZSB0\nb3RhbExhdGVuY3kgPSAwLjBmOwogICAgICAgIGxvbmcgbnVtU3VjY2Vzc09w\ncyA9IDA7CiAgICAgICAgbG9uZyBudW1GYWlsZWRPcHMgPSAwOwogICAgICAg\nIGxvbmdbXSBsYXRlbmN5QnVja2V0cyA9IG5ldyBsb25nW05VTV9CVUNLRVRT\nXTsKCiAgICAgICAgT3BTdGF0cygpIHt9CgogICAgICAgIC8qKgogICAgICAg\nICAqIEluY3JlbWVudCBudW1iZXIgb2YgZmFpbGVkIG9wZXJhdGlvbnMKICAg\nICAgICAgKi8KICAgICAgICBzeW5jaHJvbml6ZWQgcHVibGljIHZvaWQgaW5j\ncmVtZW50RmFpbGVkT3BzKCkgewogICAgICAgICAgICArK251bUZhaWxlZE9w\nczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFVwZGF0ZSBM\nYXRlbmN5CiAgICAgICAgICovCiAgICAgICAgc3luY2hyb25pemVkIHB1Ymxp\nYyB2b2lkIHVwZGF0ZUxhdGVuY3kobG9uZyBsYXRlbmN5KSB7CiAgICAgICAg\nICAgIHRvdGFsTGF0ZW5jeSArPSBsYXRlbmN5OwogICAgICAgICAgICArK251\nbVN1Y2Nlc3NPcHM7CiAgICAgICAgICAgIGlmIChsYXRlbmN5IDwgbWluTGF0\nZW5jeSkgewogICAgICAgICAgICAgICAgbWluTGF0ZW5jeSA9IGxhdGVuY3k7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxhdGVuY3kgPiBtYXhM\nYXRlbmN5KSB7CiAgICAgICAgICAgICAgICBtYXhMYXRlbmN5ID0gbGF0ZW5j\neTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpbnQgYnVja2V0OwogICAg\nICAgICAgICBpZiAobGF0ZW5jeSA8PSAxMDApIHsgLy8gbGVzcyB0aGFuIDEw\nMG1zCiAgICAgICAgICAgICAgICBidWNrZXQgPSAoaW50KShsYXRlbmN5IC8g\nMTApOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxhdGVuY3kgPD0gMTAwMCkg\neyAvLyAxMDBtcyB+IDEwMDBtcwogICAgICAgICAgICAgICAgYnVja2V0ID0g\nMSAqIDkgKyAoaW50KShsYXRlbmN5IC8gMTAwKTsKICAgICAgICAgICAgfSBl\nbHNlIGlmIChsYXRlbmN5IDw9IDEwMDAwKSB7IC8vIDFzIH4gMTBzCiAgICAg\nICAgICAgICAgICBidWNrZXQgPSAyICogOSArIChpbnQpKGxhdGVuY3kgLyAx\nMDAwKTsKICAgICAgICAgICAgfSBlbHNlIHsgLy8gbW9yZSB0aGFuIDEwcwog\nICAgICAgICAgICAgICAgYnVja2V0ID0gMyAqIDkgKyAxOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgICsrbGF0ZW5jeUJ1Y2tldHNbYnVja2V0XTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBPcFN0YXREYXRhIHRvT3BTdGF0RGF0\nYSgpIHsKICAgICAgICAgICAgZG91YmxlIGF2Z0xhdGVuY3kgPSBudW1TdWNj\nZXNzT3BzID4gMCA/IHRvdGFsTGF0ZW5jeSAvIG51bVN1Y2Nlc3NPcHMgOiAw\nLjBmOwogICAgICAgICAgICBTdHJpbmdCdWlsZGVyIHNiID0gbmV3IFN0cmlu\nZ0J1aWxkZXIoKTsKICAgICAgICAgICAgZm9yIChpbnQgaT0wOyBpPE5VTV9C\nVUNLRVRTOyBpKyspIHsKICAgICAgICAgICAgICAgIHNiLmFwcGVuZChsYXRl\nbmN5QnVja2V0c1tpXSk7CiAgICAgICAgICAgICAgICBpZiAoaSAhPSBOVU1f\nQlVDS0VUUyAtIDEpIHsKICAgICAgICAgICAgICAgICAgICBzYi5hcHBlbmQo\nJywnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcmV0dXJuIG5ldyBPcFN0YXREYXRhKG1heExhdGVuY3ksIG1pbkxh\ndGVuY3ksIGF2Z0xhdGVuY3ksIG51bVN1Y2Nlc3NPcHMsIG51bUZhaWxlZE9w\ncywgc2IudG9TdHJpbmcoKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAg\nICAgICAgKiBEaWZmIHdpdGggYmFzZSBvcHN0YXRzCiAgICAgICAgICoKICAg\nICAgICAgKiBAcGFyYW0gYmFzZQogICAgICAgICAqICAgICAgICBiYXNlIG9w\nc3RhdHMKICAgICAgICAgKiBAcmV0dXJuIGRpZmYgb3BzdGF0cwogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyBPcFN0YXRzIGRpZmYoT3BTdGF0cyBiYXNl\nKSB7CiAgICAgICAgICAgIE9wU3RhdHMgZGlmZiA9IG5ldyBPcFN0YXRzKCk7\nCiAgICAgICAgICAgIGRpZmYubWF4TGF0ZW5jeSA9IHRoaXMubWF4TGF0ZW5j\neSA+IGJhc2UubWF4TGF0ZW5jeSA/IHRoaXMubWF4TGF0ZW5jeSA6IGJhc2Uu\nbWF4TGF0ZW5jeTsKICAgICAgICAgICAgZGlmZi5taW5MYXRlbmN5ID0gdGhp\ncy5taW5MYXRlbmN5ID4gYmFzZS5taW5MYXRlbmN5ID8gYmFzZS5taW5MYXRl\nbmN5IDogdGhpcy5taW5MYXRlbmN5OwogICAgICAgICAgICBkaWZmLnRvdGFs\nTGF0ZW5jeSA9IHRoaXMudG90YWxMYXRlbmN5IC0gYmFzZS50b3RhbExhdGVu\nY3k7CiAgICAgICAgICAgIGRpZmYubnVtU3VjY2Vzc09wcyA9IHRoaXMubnVt\nU3VjY2Vzc09wcyAtIGJhc2UubnVtU3VjY2Vzc09wczsKICAgICAgICAgICAg\nZGlmZi5udW1GYWlsZWRPcHMgPSB0aGlzLm51bUZhaWxlZE9wcyAtIGJhc2Uu\nbnVtRmFpbGVkT3BzOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIE5VTV9CVUNLRVRTOyBpKyspIHsKICAgICAgICAgICAgICAgIGRpZmYubGF0\nZW5jeUJ1Y2tldHNbaV0gPSB0aGlzLmxhdGVuY3lCdWNrZXRzW2ldIC0gYmFz\nZS5sYXRlbmN5QnVja2V0c1tpXTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gZGlmZjsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAg\nICAqIENvcHkgc3RhdHMgZnJvbSBvdGhlciBPcFN0YXRzCiAgICAgICAgICoK\nICAgICAgICAgKiBAcGFyYW0gb3RoZXIgb3RoZXIgb3Agc3RhdHMKICAgICAg\nICAgKiBAcmV0dXJuIHZvaWQKICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\nc3luY2hyb25pemVkIHZvaWQgY29weU9mKE9wU3RhdHMgb3RoZXIpIHsKICAg\nICAgICAgICAgdGhpcy5tYXhMYXRlbmN5ID0gb3RoZXIubWF4TGF0ZW5jeTsK\nICAgICAgICAgICAgdGhpcy5taW5MYXRlbmN5ID0gb3RoZXIubWluTGF0ZW5j\neTsKICAgICAgICAgICAgdGhpcy50b3RhbExhdGVuY3kgPSBvdGhlci50b3Rh\nbExhdGVuY3k7CiAgICAgICAgICAgIHRoaXMubnVtU3VjY2Vzc09wcyA9IG90\naGVyLm51bVN1Y2Nlc3NPcHM7CiAgICAgICAgICAgIHRoaXMubnVtRmFpbGVk\nT3BzID0gb3RoZXIubnVtRmFpbGVkT3BzOwogICAgICAgICAgICBTeXN0ZW0u\nYXJyYXljb3B5KG90aGVyLmxhdGVuY3lCdWNrZXRzLCAwLCB0aGlzLmxhdGVu\nY3lCdWNrZXRzLCAwLCB0aGlzLmxhdGVuY3lCdWNrZXRzLmxlbmd0aCk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFNU\nQVRTX0FERCA9IDA7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBTVEFU\nU19SRUFEID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFNUQVRT\nX1VOS05PV04gPSAyOwogICAgLy8gTk9URTogaWYgYWRkIG90aGVyIHN0YXRz\nLCBpbmNyZW1lbnQgTlVNX1NUQVRTCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBOVU1fU1RBVFMgPSAzOwoKICAgIE9wU3RhdHNbXSBzdGF0cyA9IG5l\ndyBPcFN0YXRzW05VTV9TVEFUU107CgogICAgcHJpdmF0ZSBCS1N0YXRzKCkg\newogICAgICAgIGZvciAoaW50IGk9MDsgaTxOVU1fU1RBVFM7IGkrKykgewog\nICAgICAgICAgICBzdGF0c1tpXSA9IG5ldyBPcFN0YXRzKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogU3RhdHMgb2Ygb3BlcmF0aW9ucwog\nICAgICoKICAgICAqIEByZXR1cm4gb3Agc3RhdHMKICAgICAqLwogICAgcHVi\nbGljIE9wU3RhdHMgZ2V0T3BTdGF0cyhpbnQgdHlwZSkgewogICAgICAgIHJl\ndHVybiBzdGF0c1t0eXBlXTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBz\ndGF0cyBvZiBhIHNwZWNpZmllZCBvcGVyYXRpb24KICAgICAqCiAgICAgKiBA\ncGFyYW0gdHlwZSBvcGVyYXRpb24gdHlwZQogICAgICogQHBhcmFtIHN0YXQg\nb3BlcmF0aW9uIHN0YXRzCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE9w\nU3RhdHMoaW50IHR5cGUsIE9wU3RhdHMgc3RhdCkgewogICAgICAgIHN0YXRz\nW3R5cGVdID0gc3RhdDsKICAgIH0KCiAgICAvKioKICAgICAqIERpZmYgd2l0\naCBiYXNlIHN0YXRzCiAgICAgKgogICAgICogQHBhcmFtIGJhc2UgYmFzZSBz\ndGF0cwogICAgICogQHJldHVybiBkaWZmIHN0YXRzCiAgICAgKi8KICAgIHB1\nYmxpYyBCS1N0YXRzIGRpZmYoQktTdGF0cyBiYXNlKSB7CiAgICAgICAgQktT\ndGF0cyBkaWZmID0gbmV3IEJLU3RhdHMoKTsKICAgICAgICBmb3IgKGludCBp\nPTA7IGk8TlVNX1NUQVRTOyBpKyspIHsKICAgICAgICAgICAgZGlmZi5zZXRP\ncFN0YXRzKGksIHN0YXRzW2ldLmRpZmYoYmFzZS5nZXRPcFN0YXRzKGkpKSk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBkaWZmOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29weSBzdGF0cyBmcm9tIG90aGVyIHN0YXRzCiAgICAgKgog\nICAgICogQHBhcmFtIG90aGVyIG90aGVyIHN0YXRzCiAgICAgKiBAcmV0dXJu\nIHZvaWQKICAgICAqLwogICAgcHVibGljIHZvaWQgY29weU9mKEJLU3RhdHMg\nb3RoZXIpIHsKICAgICAgICBmb3IgKGludCBpPTA7IGk8TlVNX1NUQVRTOyBp\nKyspIHsKICAgICAgICAgICAgc3RhdHNbaV0uY29weU9mKG90aGVyLmdldE9w\nU3RhdHMoaSkpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

