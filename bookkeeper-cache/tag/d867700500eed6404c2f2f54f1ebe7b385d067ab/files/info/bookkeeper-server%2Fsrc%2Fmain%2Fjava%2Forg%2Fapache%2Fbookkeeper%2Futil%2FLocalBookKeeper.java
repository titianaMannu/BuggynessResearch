{"sha":"f6dc07bad939a3e33d9f1b02f5d7dd1e253160bb","node_id":"MDQ6QmxvYjE1NzU5NTY6ZjZkYzA3YmFkOTM5YTNlMzNkOWYxYjAyZjVkN2RkMWUyNTMxNjBiYg==","size":9554,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/f6dc07bad939a3e33d9f1b02f5d7dd1e253160bb","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudXRpbDsKCi8qKgogKiBM\naWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFT\nRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBh\nZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgog\nKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGlj\nZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91IG1h\neSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQogKiB3\naXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRo\nZSBMaWNlbnNlIGF0CiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0\nd2FyZQogKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3Bl\nY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBs\naW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCgppbXBvcnQgamF2\nYS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1w\nb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLklucHV0\nU3RyZWFtUmVhZGVyOwppbXBvcnQgamF2YS5pby5PdXRwdXRTdHJlYW07Cmlt\ncG9ydCBqYXZhLm5ldC5JbmV0QWRkcmVzczsKaW1wb3J0IGphdmEubmV0Lklu\nZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS5uZXQuU29ja2V0OwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291bnREb3duTGF0Y2g7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tpZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIucHJvdG8uQm9v\na2llU2VydmVyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS56b29r\nZWVwZXIuQ3JlYXRlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLktlZXBlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVy\nLldhdGNoZWRFdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLldh\ndGNoZXI7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5ab29LZWVwZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5XYXRjaGVyLkV2ZW50Lktl\nZXBlclN0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vRGVm\ncy5JZHM7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBlci5zZXJ2ZXIuTklP\nU2VydmVyQ254bkZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tlZXBl\nci5zZXJ2ZXIuWm9vS2VlcGVyU2VydmVyOwoKcHVibGljIGNsYXNzIExvY2Fs\nQm9va0tlZXBlciB7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIExvZ2dl\nciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMb2NhbEJvb2tLZWVw\nZXIuY2xhc3MpOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQ09OTkVD\nVElPTl9USU1FT1VUID0gMzAwMDA7CgogICAgaW50IG51bWJlck9mQm9va2ll\nczsKCiAgICBwdWJsaWMgTG9jYWxCb29rS2VlcGVyKCkgewogICAgICAgIG51\nbWJlck9mQm9va2llcyA9IDM7CiAgICB9CgogICAgcHVibGljIExvY2FsQm9v\na0tlZXBlcihpbnQgbnVtYmVyT2ZCb29raWVzKSB7CiAgICAgICAgdGhpcygp\nOwogICAgICAgIHRoaXMubnVtYmVyT2ZCb29raWVzID0gbnVtYmVyT2ZCb29r\naWVzOwogICAgICAgIExPRy5pbmZvKCJSdW5uaW5nICIgKyB0aGlzLm51bWJl\nck9mQm9va2llcyArICIgYm9va2llKHMpLiIpOwogICAgfQoKICAgIHByaXZh\ndGUgZmluYWwgU3RyaW5nIEhPU1RQT1JUID0gIjEyNy4wLjAuMToyMTgxIjsK\nICAgIE5JT1NlcnZlckNueG5GYWN0b3J5IHNlcnZlckZhY3Rvcnk7CiAgICBa\nb29LZWVwZXJTZXJ2ZXIgemtzOwogICAgWm9vS2VlcGVyIHprYzsKICAgIGlu\ndCBab29LZWVwZXJEZWZhdWx0UG9ydCA9IDIxODE7CiAgICBzdGF0aWMgaW50\nIHprU2Vzc2lvblRpbWVPdXQgPSA1MDAwOwogICAgRmlsZSBaa1RtcERpcjsK\nCiAgICAvL0Jvb2tLZWVwZXIgdmFyaWFibGVzCiAgICBGaWxlIHRtcERpcnNb\nXTsKICAgIEJvb2tpZVNlcnZlciBic1tdOwogICAgU2VydmVyQ29uZmlndXJh\ndGlvbiBic0NvbmZzW107CiAgICBJbnRlZ2VyIGluaXRpYWxQb3J0ID0gNTAw\nMDsKCiAgICAvKioKICAgICAqIEBwYXJhbSBhcmdzCiAgICAgKi8KCiAgICBw\ncml2YXRlIHZvaWQgcnVuWm9va2VlcGVyKGludCBtYXhDQykgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBjcmVhdGUgYSBab29LZWVwZXIgc2Vy\ndmVyKGRhdGFEaXIsIGRhdGFMb2dEaXIsIHBvcnQpCiAgICAgICAgTE9HLmlu\nZm8oIlN0YXJ0aW5nIFpLIHNlcnZlciIpOwogICAgICAgIC8vU2VydmVyU3Rh\ndHMucmVnaXN0ZXJBc0NvbmNyZXRlKCk7CiAgICAgICAgLy9DbGllbnRCYXNl\nLnNldHVwVGVzdEVudigpOwogICAgICAgIFprVG1wRGlyID0gRmlsZS5jcmVh\ndGVUZW1wRmlsZSgiem9va2VlcGVyIiwgInRlc3QiKTsKICAgICAgICBpZiAo\nIVprVG1wRGlyLmRlbGV0ZSgpIHx8ICFaa1RtcERpci5ta2RpcigpKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbigiQ291bGRuJ3QgY3Jl\nYXRlIHprIGRpcmVjdG9yeSAiICsgWmtUbXBEaXIpOwogICAgICAgIH0KCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgemtzID0gbmV3IFpvb0tlZXBlclNl\ncnZlcihaa1RtcERpciwgWmtUbXBEaXIsIFpvb0tlZXBlckRlZmF1bHRQb3J0\nKTsKICAgICAgICAgICAgc2VydmVyRmFjdG9yeSA9ICBuZXcgTklPU2VydmVy\nQ254bkZhY3RvcnkoKTsKICAgICAgICAgICAgc2VydmVyRmFjdG9yeS5jb25m\naWd1cmUobmV3IEluZXRTb2NrZXRBZGRyZXNzKFpvb0tlZXBlckRlZmF1bHRQ\nb3J0KSwgbWF4Q0MpOwogICAgICAgICAgICBzZXJ2ZXJGYWN0b3J5LnN0YXJ0\ndXAoemtzKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAvLyBUT0RPIEF1dG8tZ2VuZXJhdGVkIGNhdGNoIGJsb2NrCiAg\nICAgICAgICAgIExPRy5lcnJvcigiRXhjZXB0aW9uIHdoaWxlIGluc3RhbnRp\nYXRpbmcgWm9vS2VlcGVyIiwgZSk7CiAgICAgICAgfQoKICAgICAgICBib29s\nZWFuIGIgPSB3YWl0Rm9yU2VydmVyVXAoSE9TVFBPUlQsIENPTk5FQ1RJT05f\nVElNRU9VVCk7CiAgICAgICAgTE9HLmRlYnVnKCJab29LZWVwZXIgc2VydmVy\nIHVwOiAiICsgYik7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGluaXRpYWxp\nemVab29rZXBlcigpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgTE9H\nLmluZm8oIkluc3RhbnRpYXRlIFpLIENsaWVudCIpOwogICAgICAgIC8vaW5p\ndGlhbGl6ZSB0aGUgemsgY2xpZW50IHdpdGggdmFsdWVzCiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgWktDb25uZWN0aW9uV2F0Y2hlciB6a0Nvbm5lY3Rp\nb25XYXRjaGVyID0gbmV3IFpLQ29ubmVjdGlvbldhdGNoZXIoKTsKICAgICAg\nICAgICAgemtjID0gbmV3IFpvb0tlZXBlcihIT1NUUE9SVCwgemtTZXNzaW9u\nVGltZU91dCwKICAgICAgICAgICAgICAgICAgICB6a0Nvbm5lY3Rpb25XYXRj\naGVyKTsKICAgICAgICAgICAgemtDb25uZWN0aW9uV2F0Y2hlci53YWl0Rm9y\nQ29ubmVjdGlvbigpOwogICAgICAgICAgICB6a2MuY3JlYXRlKCIvbGVkZ2Vy\ncyIsIG5ldyBieXRlWzBdLCBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVN\nb2RlLlBFUlNJU1RFTlQpOwogICAgICAgICAgICB6a2MuY3JlYXRlKCIvbGVk\nZ2Vycy9hdmFpbGFibGUiLCBuZXcgYnl0ZVswXSwgSWRzLk9QRU5fQUNMX1VO\nU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5UKTsKICAgICAgICAgICAgLy8g\nTm8gbmVlZCB0byBjcmVhdGUgYW4gZW50cnkgZm9yIGVhY2ggcmVxdWVzdGVk\nIGJvb2tpZSBhbnltb3JlIGFzIHRoZQogICAgICAgICAgICAvLyBCb29raWVT\nZXJ2ZXJzIHdpbGwgcmVnaXN0ZXIgdGhlbXNlbHZlcyB3aXRoIFpvb0tlZXBl\nciBvbiBzdGFydHVwLgogICAgICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIC8vIFRPRE8gQXV0by1nZW5lcmF0ZWQgY2F0\nY2ggYmxvY2sKICAgICAgICAgICAgTE9HLmVycm9yKCJFeGNlcHRpb24gd2hp\nbGUgY3JlYXRpbmcgem5vZGVzIiwgZSk7CiAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBUT0RPIEF1\ndG8tZ2VuZXJhdGVkIGNhdGNoIGJsb2NrCiAgICAgICAgICAgIExPRy5lcnJv\ncigiSW50ZXJydXB0ZWQgd2hpbGUgY3JlYXRpbmcgem5vZGVzIiwgZSk7CiAg\nICAgICAgfQogICAgfQogICAgcHJpdmF0ZSB2b2lkIHJ1bkJvb2tpZXMoU2Vy\ndmVyQ29uZmlndXJhdGlvbiBiYXNlQ29uZikgCiAgICAgICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiwgS2VlcGVyRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwgQm9va2llRXhjZXB0aW9uIHsKICAgICAgICBMT0cuaW5mbygi\nU3RhcnRpbmcgQm9va2llKHMpIik7CiAgICAgICAgLy8gQ3JlYXRlIEJvb2tp\nZSBTZXJ2ZXJzIChCMSwgQjIsIEIzKQoKICAgICAgICB0bXBEaXJzID0gbmV3\nIEZpbGVbbnVtYmVyT2ZCb29raWVzXTsKICAgICAgICBicyA9IG5ldyBCb29r\naWVTZXJ2ZXJbbnVtYmVyT2ZCb29raWVzXTsKICAgICAgICBic0NvbmZzID0g\nbmV3IFNlcnZlckNvbmZpZ3VyYXRpb25bbnVtYmVyT2ZCb29raWVzXTsKCiAg\nICAgICAgZm9yKGludCBpID0gMDsgaSA8IG51bWJlck9mQm9va2llczsgaSsr\nKSB7CiAgICAgICAgICAgIHRtcERpcnNbaV0gPSBGaWxlLmNyZWF0ZVRlbXBG\naWxlKCJib29raWUiICsgSW50ZWdlci50b1N0cmluZyhpKSwgInRlc3QiKTsK\nICAgICAgICAgICAgaWYgKCF0bXBEaXJzW2ldLmRlbGV0ZSgpIHx8ICF0bXBE\naXJzW2ldLm1rZGlyKCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJ\nT0V4Y2VwdGlvbigiQ291bGRuJ3QgY3JlYXRlIGJvb2tpZSBkaXIgIiArIHRt\ncERpcnNbaV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBic0NvbmZz\nW2ldID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oYmFzZUNvbmYpOwogICAg\nICAgICAgICAvLyBvdmVycmlkZSBzZXR0aW5ncwogICAgICAgICAgICBic0Nv\nbmZzW2ldLnNldEJvb2tpZVBvcnQoaW5pdGlhbFBvcnQgKyBpKTsKICAgICAg\nICAgICAgYnNDb25mc1tpXS5zZXRaa1NlcnZlcnMoSW5ldEFkZHJlc3MuZ2V0\nTG9jYWxIb3N0KCkuZ2V0SG9zdEFkZHJlc3MoKSArICI6IgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyBab29LZWVwZXJEZWZhdWx0UG9y\ndCk7CiAgICAgICAgICAgIGJzQ29uZnNbaV0uc2V0Sm91cm5hbERpck5hbWUo\ndG1wRGlyc1tpXS5nZXRQYXRoKCkpOwogICAgICAgICAgICBic0NvbmZzW2ld\nLnNldExlZGdlckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7IHRtcERpcnNbaV0u\nZ2V0UGF0aCgpIH0pOwoKICAgICAgICAgICAgYnNbaV0gPSBuZXcgQm9va2ll\nU2VydmVyKGJzQ29uZnNbaV0pOwogICAgICAgICAgICBic1tpXS5zdGFydCgp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFp\nbihTdHJpbmdbXSBhcmdzKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24sIEtlZXBlckV4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24sIEJv\nb2tpZUV4Y2VwdGlvbiB7CiAgICAgICAgaWYoYXJncy5sZW5ndGggPCAxKSB7\nCiAgICAgICAgICAgIHVzYWdlKCk7CiAgICAgICAgICAgIFN5c3RlbS5leGl0\nKC0xKTsKICAgICAgICB9CiAgICAgICAgTG9jYWxCb29rS2VlcGVyIGxiID0g\nbmV3IExvY2FsQm9va0tlZXBlcihJbnRlZ2VyLnBhcnNlSW50KGFyZ3NbMF0p\nKTsKCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IFNl\ncnZlckNvbmZpZ3VyYXRpb24oKTsKICAgICAgICBpZiAoYXJncy5sZW5ndGgg\nPj0gMikgewogICAgICAgICAgICBTdHJpbmcgY29uZkZpbGUgPSBhcmdzWzFd\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uZi5sb2Fk\nQ29uZihuZXcgRmlsZShjb25mRmlsZSkudG9VUkkoKS50b1VSTCgpKTsKICAg\nICAgICAgICAgICAgIExPRy5pbmZvKCJVc2luZyBjb25maWd1cmF0aW9uIGZp\nbGUgIiArIGNvbmZGaWxlKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIC8vIGxvYWQgY29uZiBmYWlsZWQK\nICAgICAgICAgICAgICAgIExPRy53YXJuKCJFcnJvciBsb2FkaW5nIGNvbmZp\nZ3VyYXRpb24gZmlsZSAiICsgY29uZkZpbGUsIGUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBsYi5ydW5ab29rZWVwZXIoMTAwMCk7CiAg\nICAgICAgbGIuaW5pdGlhbGl6ZVpvb2tlcGVyKCk7CiAgICAgICAgbGIucnVu\nQm9va2llcyhjb25mKTsKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAg\nICAgICBUaHJlYWQuc2xlZXAoNTAwMCk7CiAgICAgICAgfQogICAgfQoKICAg\nIHByaXZhdGUgc3RhdGljIHZvaWQgdXNhZ2UoKSB7CiAgICAgICAgU3lzdGVt\nLmVyci5wcmludGxuKCJVc2FnZTogTG9jYWxCb29rS2VlcGVyIG51bWJlci1v\nZi1ib29raWVzIik7CiAgICB9CgogICAgLyogV2F0Y2hpbmcgU3luY0Nvbm5l\nY3RlZCBldmVudCBmcm9tIFpvb0tlZXBlciAqLwogICAgc3RhdGljIGNsYXNz\nIFpLQ29ubmVjdGlvbldhdGNoZXIgaW1wbGVtZW50cyBXYXRjaGVyIHsKICAg\nICAgICBwcml2YXRlIENvdW50RG93bkxhdGNoIGNsaWVudENvbm5lY3RMYXRj\naCA9IG5ldyBDb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVkRXZlbnQgZXZl\nbnQpIHsKICAgICAgICAgICAgaWYgKGV2ZW50LmdldFN0YXRlKCkgPT0gS2Vl\ncGVyU3RhdGUuU3luY0Nvbm5lY3RlZCkgewogICAgICAgICAgICAgICAgY2xp\nZW50Q29ubmVjdExhdGNoLmNvdW50RG93bigpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICAvLyBXYWl0aW5nIGZvciB0aGUgU3luY0Nvbm5l\nY3RlZCBldmVudCBmcm9tIHRoZSBab29LZWVwZXIgc2VydmVyCiAgICAgICAg\ncHVibGljIHZvaWQgd2FpdEZvckNvbm5lY3Rpb24oKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYg\nKCFjbGllbnRDb25uZWN0TGF0Y2guYXdhaXQoemtTZXNzaW9uVGltZU91dCwK\nICAgICAgICAgICAgICAgICAgICAgICAgVGltZVVuaXQuTUlMTElTRUNPTkRT\nKSkgewogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlv\nbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDb3VsZG4ndCBjb25u\nZWN0IHRvIHpvb2tlZXBlciBzZXJ2ZXIiKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKAogICAg\nICAgICAgICAgICAgICAgICAgICAiSW50ZXJydXB0ZWQgd2hlbiBjb25uZWN0\naW5nIHRvIHpvb2tlZXBlciBzZXJ2ZXIiLCBlKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gd2Fp\ndEZvclNlcnZlclVwKFN0cmluZyBocCwgbG9uZyB0aW1lb3V0KSB7CiAgICAg\nICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgIFN0cmluZyBzcGxpdFtdID0gaHAuc3BsaXQoIjoiKTsKICAgICAg\nICBTdHJpbmcgaG9zdCA9IHNwbGl0WzBdOwogICAgICAgIGludCBwb3J0ID0g\nSW50ZWdlci5wYXJzZUludChzcGxpdFsxXSk7CiAgICAgICAgd2hpbGUgKHRy\ndWUpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFNvY2tl\ndCBzb2NrID0gbmV3IFNvY2tldChob3N0LCBwb3J0KTsKICAgICAgICAgICAg\nICAgIEJ1ZmZlcmVkUmVhZGVyIHJlYWRlciA9IG51bGw7CiAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIE91dHB1dFN0cmVhbSBv\ndXRzdHJlYW0gPSBzb2NrLmdldE91dHB1dFN0cmVhbSgpOwogICAgICAgICAg\nICAgICAgICAgIG91dHN0cmVhbS53cml0ZSgic3RhdCIuZ2V0Qnl0ZXMoKSk7\nCiAgICAgICAgICAgICAgICAgICAgb3V0c3RyZWFtLmZsdXNoKCk7CgogICAg\nICAgICAgICAgICAgICAgIHJlYWRlciA9CiAgICAgICAgICAgICAgICAgICAg\nICAgIG5ldyBCdWZmZXJlZFJlYWRlcigKICAgICAgICAgICAgICAgICAgICAg\nICAgbmV3IElucHV0U3RyZWFtUmVhZGVyKHNvY2suZ2V0SW5wdXRTdHJlYW0o\nKSkpOwogICAgICAgICAgICAgICAgICAgIFN0cmluZyBsaW5lID0gcmVhZGVy\nLnJlYWRMaW5lKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUgIT0g\nbnVsbCAmJiBsaW5lLnN0YXJ0c1dpdGgoIlpvb2tlZXBlciB2ZXJzaW9uOiIp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5pbmZvKCJTZXJ2ZXIg\nVVAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgICAgICAgICBzb2NrLmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKHJlYWRlciAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJlYWRlci5jbG9zZSgpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAo\nSU9FeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gaWdub3JlIGFz\nIHRoaXMgaXMgZXhwZWN0ZWQKICAgICAgICAgICAgICAgIExPRy5pbmZvKCJz\nZXJ2ZXIgIiArIGhwICsgIiBub3QgdXAgIiArIGUpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBpZiAoU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkg\nPiBzdGFydCArIHRpbWVvdXQpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBUaHJlYWQuc2xlZXAoMjUwKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gaWdu\nb3JlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgfQoKfQo=\n","encoding":"base64"}

