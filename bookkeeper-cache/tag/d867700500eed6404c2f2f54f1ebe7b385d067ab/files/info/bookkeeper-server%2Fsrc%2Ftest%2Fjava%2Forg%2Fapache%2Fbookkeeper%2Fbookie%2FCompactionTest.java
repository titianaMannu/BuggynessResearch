{"sha":"8ba99639f8298cb369af4486a75fd7a8267dc12c","node_id":"MDQ6QmxvYjE1NzU5NTY6OGJhOTk2MzlmODI5OGNiMzY5YWY0NDg2YTc1ZmQ3YTgyNjdkYzEyYw==","size":11580,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8ba99639f8298cb369af4486a75fd7a8267dc12c","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llOwoKLyoKICoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9y\nZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQg\nYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAq\nIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FS\nUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIg\nZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUK\nICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFu\nZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoKICovCmlt\ncG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwpp\nbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9uOwoKaW1wb3J0IG9yZy5hcGFj\naGUuYm9va2tlZXBlci5jbGllbnQuTGVkZ2VyRW50cnk7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkxlZGdlckhhbmRsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdl\nc3RUeXBlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9v\na0tlZXBlckNsdXN0ZXJUZXN0Q2FzZTsKCmltcG9ydCBvcmcuc2xmNGouTG9n\nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rvcnk7CgppbXBvcnQg\nb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKLyoq\nCiAqIFRoaXMgY2xhc3MgdGVzdHMgdGhlIGVudHJ5IGxvZyBjb21wYWN0aW9u\nIGZ1bmN0aW9uYWxpdHkuCiAqLwpwdWJsaWMgY2xhc3MgQ29tcGFjdGlvblRl\nc3QgZXh0ZW5kcyBCb29rS2VlcGVyQ2x1c3RlclRlc3RDYXNlIHsKICAgIHN0\nYXRpYyBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoQ29t\ncGFjdGlvblRlc3QuY2xhc3MpOwogICAgRGlnZXN0VHlwZSBkaWdlc3RUeXBl\nOwoKICAgIHN0YXRpYyBpbnQgRU5UUllfU0laRSA9IDEwMjQ7CiAgICBzdGF0\naWMgaW50IE5VTV9CT09LSUVTID0gMTsKCiAgICBpbnQgbnVtRW50cmllczsK\nICAgIGludCBnY1dhaXRUaW1lOwogICAgZG91YmxlIG1pbm9yQ29tcGFjdGlv\nblRocmVzaG9sZDsKICAgIGRvdWJsZSBtYWpvckNvbXBhY3Rpb25UaHJlc2hv\nbGQ7CiAgICBsb25nIG1pbm9yQ29tcGFjdGlvbkludGVydmFsOwogICAgbG9u\nZyBtYWpvckNvbXBhY3Rpb25JbnRlcnZhbDsKCiAgICBTdHJpbmcgbXNnOwoK\nICAgIHB1YmxpYyBDb21wYWN0aW9uVGVzdCgpIHsKICAgICAgICBzdXBlcihO\nVU1fQk9PS0lFUyk7CgogICAgICAgIHRoaXMuZGlnZXN0VHlwZSA9IERpZ2Vz\ndFR5cGUuQ1JDMzI7CgogICAgICAgIG51bUVudHJpZXMgPSAxMDA7CiAgICAg\nICAgZ2NXYWl0VGltZSA9IDEwMDA7CiAgICAgICAgbWlub3JDb21wYWN0aW9u\nVGhyZXNob2xkID0gMC4xZjsKICAgICAgICBtYWpvckNvbXBhY3Rpb25UaHJl\nc2hvbGQgPSAwLjVmOwogICAgICAgIG1pbm9yQ29tcGFjdGlvbkludGVydmFs\nID0gMiAqIGdjV2FpdFRpbWUgLyAxMDAwOwogICAgICAgIG1ham9yQ29tcGFj\ndGlvbkludGVydmFsID0gNCAqIGdjV2FpdFRpbWUgLyAxMDAwOwoKICAgICAg\nICAvLyBhIGR1bW15IG1lc3NhZ2UKICAgICAgICBTdHJpbmdCdWlsZGVyIG1z\nZ1NCID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IEVOVFJZX1NJWkU7IGkrKykgewogICAgICAgICAgICBtc2dT\nQi5hcHBlbmQoImEiKTsKICAgICAgICB9CiAgICAgICAgbXNnID0gbXNnU0Iu\ndG9TdHJpbmcoKTsKICAgIH0KCiAgICBAQmVmb3JlCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgLy8gU2V0IHVwIHRoZSBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMg\nbmVlZGVkLgogICAgICAgIGJhc2VDb25mLnNldEVudHJ5TG9nU2l6ZUxpbWl0\nKG51bUVudHJpZXMgKiBFTlRSWV9TSVpFKTsKICAgICAgICBiYXNlQ29uZi5z\nZXRHY1dhaXRUaW1lKGdjV2FpdFRpbWUpOwogICAgICAgIGJhc2VDb25mLnNl\ndE1pbm9yQ29tcGFjdGlvblRocmVzaG9sZChtaW5vckNvbXBhY3Rpb25UaHJl\nc2hvbGQpOwogICAgICAgIGJhc2VDb25mLnNldE1ham9yQ29tcGFjdGlvblRo\ncmVzaG9sZChtYWpvckNvbXBhY3Rpb25UaHJlc2hvbGQpOwogICAgICAgIGJh\nc2VDb25mLnNldE1pbm9yQ29tcGFjdGlvbkludGVydmFsKG1pbm9yQ29tcGFj\ndGlvbkludGVydmFsKTsKICAgICAgICBiYXNlQ29uZi5zZXRNYWpvckNvbXBh\nY3Rpb25JbnRlcnZhbChtYWpvckNvbXBhY3Rpb25JbnRlcnZhbCk7CgogICAg\nICAgIHN1cGVyLnNldFVwKCk7CiAgICB9CgogICAgTGVkZ2VySGFuZGxlW10g\ncHJlcGFyZURhdGEoaW50IG51bUVudHJ5TG9ncywgYm9vbGVhbiBjaGFuZ2VO\ndW0pCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc2lu\nY2UgYW4gZW50cnkgbG9nIGZpbGUgY2FuIGhvbGQgYXQgbW9zdCAxMDAgZW50\ncmllcwogICAgICAgIC8vIGZpcnN0IGxlZGdlciB3cml0ZSAyIGVudHJpZXMs\nIHdoaWNoIGlzIGxlc3MgdGhhbiBsb3cgd2F0ZXIgbWFyawogICAgICAgIGlu\ndCBudW0xID0gMjsKICAgICAgICAvLyB0aGlyZCBsZWRnZXIgd3JpdGUgbW9y\nZSB0aGFuIGhpZ2ggd2F0ZXIgbWFyayBlbnRyaWVzCiAgICAgICAgaW50IG51\nbTMgPSAoaW50KShudW1FbnRyaWVzICogMC43Zik7CiAgICAgICAgLy8gc2Vj\nb25kIGxlZGdlciB3cml0ZSByZW1haW5pbmcgZW50cmllcywgd2hpY2ggaXMg\naGlnaGVyIHRoYW4gbG93IHdhdGVyIG1hcmsKICAgICAgICAvLyBhbmQgbGVz\ncyB0aGFuIGhpZ2ggd2F0ZXIgbWFyawogICAgICAgIGludCBudW0yID0gbnVt\nRW50cmllcyAtIG51bTMgLSBudW0xOwoKICAgICAgICBMZWRnZXJIYW5kbGVb\nXSBsaHMgPSBuZXcgTGVkZ2VySGFuZGxlWzNdOwogICAgICAgIGZvciAoaW50\nIGk9MDsgaTwzOyArK2kpIHsKICAgICAgICAgICAgbGhzW2ldID0gYmtjLmNy\nZWF0ZUxlZGdlcihOVU1fQk9PS0lFUywgTlVNX0JPT0tJRVMsIGRpZ2VzdFR5\ncGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChp\nbnQgbiA9IDA7IG4gPCBudW1FbnRyeUxvZ3M7IG4rKykgewogICAgICAgICAg\nICBmb3IgKGludCBrID0gMDsgayA8IG51bTE7IGsrKykgewogICAgICAgICAg\nICAgICAgbGhzWzBdLmFkZEVudHJ5KG1zZy5nZXRCeXRlcygpKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IG51bTI7\nIGsrKykgewogICAgICAgICAgICAgICAgbGhzWzFdLmFkZEVudHJ5KG1zZy5n\nZXRCeXRlcygpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKGlu\ndCBrID0gMDsgayA8IG51bTM7IGsrKykgewogICAgICAgICAgICAgICAgbGhz\nWzJdLmFkZEVudHJ5KG1zZy5nZXRCeXRlcygpKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBpZiAoY2hhbmdlTnVtKSB7CiAgICAgICAgICAgICAgICAt\nLW51bTI7CiAgICAgICAgICAgICAgICArK251bTM7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHJldHVybiBsaHM7CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIHZlcmlmeUxlZGdlcihsb25nIGxpZCwgbG9uZyBzdGFydEVu\ndHJ5SWQsIGxvbmcgZW5kRW50cnlJZCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgTGVkZ2VySGFuZGxlIGxoID0gYmtjLm9wZW5MZWRnZXIobGlkLCBk\naWdlc3RUeXBlLCAiIi5nZXRCeXRlcygpKTsKICAgICAgICBFbnVtZXJhdGlv\nbjxMZWRnZXJFbnRyeT4gZW50cmllcyA9IGxoLnJlYWRFbnRyaWVzKHN0YXJ0\nRW50cnlJZCwgZW5kRW50cnlJZCk7CiAgICAgICAgd2hpbGUgKGVudHJpZXMu\naGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgTGVkZ2VyRW50cnkg\nZW50cnkgPSBlbnRyaWVzLm5leHRFbGVtZW50KCk7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscyhtc2csIG5ldyBTdHJpbmcoZW50cnkuZ2V0RW50cnkoKSkp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW5bXSBjaGVj\na0xvZ0ZpbGVzKEZpbGUgbGVkZ2VyRGlyZWN0b3J5LCBpbnQgbnVtRmlsZXMp\nIHsKICAgICAgICBib29sZWFuW10gaGFzTG9nRmlsZXMgPSBuZXcgYm9vbGVh\nbltudW1GaWxlc107CiAgICAgICAgQXJyYXlzLmZpbGwoaGFzTG9nRmlsZXMs\nIGZhbHNlKTsKICAgICAgICBmb3IgKEZpbGUgZiA6IEJvb2tpZS5nZXRDdXJy\nZW50RGlyZWN0b3J5KGxlZGdlckRpcmVjdG9yeSkubGlzdEZpbGVzKCkpIHsK\nICAgICAgICAgICAgTE9HLmluZm8oIkNoZWNraW5nIGZpbGUgOiAiICsgZik7\nCiAgICAgICAgICAgIGlmIChmLmlzRmlsZSgpKSB7CiAgICAgICAgICAgICAg\nICBTdHJpbmcgbmFtZSA9IGYuZ2V0TmFtZSgpOwogICAgICAgICAgICAgICAg\naWYgKCFuYW1lLmVuZHNXaXRoKCIubG9nIikpIHsKICAgICAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIFN0cmluZyBpZFN0cmluZyA9IG5hbWUuc3BsaXQoIlxcLiIpWzBdOwog\nICAgICAgICAgICAgICAgaW50IGlkID0gSW50ZWdlci5wYXJzZUludChpZFN0\ncmluZywgMTYpOwogICAgICAgICAgICAgICAgaWYgKGlkID49IG51bUZpbGVz\nKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICBoYXNMb2dGaWxlc1tpZF0gPSB0cnVl\nOyAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gaGFz\nTG9nRmlsZXM7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRl\nc3REaXNhYmxlQ29tcGFjdGlvbigpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIC8vIHByZXBhcmUgZGF0YQogICAgICAgIExlZGdlckhhbmRsZVtdIGxo\ncyA9IHByZXBhcmVEYXRhKDMsIGZhbHNlKTsKCiAgICAgICAgLy8gZGlzYWJs\nZSBjb21wYWN0aW9uCiAgICAgICAgYmFzZUNvbmYuc2V0TWlub3JDb21wYWN0\naW9uVGhyZXNob2xkKDAuMGYpOwogICAgICAgIGJhc2VDb25mLnNldE1ham9y\nQ29tcGFjdGlvblRocmVzaG9sZCgwLjBmKTsKCiAgICAgICAgLy8gcmVzdGFy\ndCBib29raWVzCiAgICAgICAgcmVzdGFydEJvb2tpZXMoYmFzZUNvbmYpOwoK\nICAgICAgICAvLyByZW1vdmUgbGVkZ2VyMiBhbmQgbGVkZ2VyMwogICAgICAg\nIC8vIHNvIGVudHJ5IGxvZyAxIGFuZCAyIHdvdWxkIGhhdmUgbGVkZ2VyMSBl\nbnRyaWVzIGxlZnQKICAgICAgICBia2MuZGVsZXRlTGVkZ2VyKGxoc1sxXS5n\nZXRJZCgpKTsKICAgICAgICBia2MuZGVsZXRlTGVkZ2VyKGxoc1syXS5nZXRJ\nZCgpKTsKICAgICAgICBMT0cuaW5mbygiRmluaXNoZWQgZGVsZXRpbmcgdGhl\nIGxlZGdlcnMgY29udGFpbnMgbW9zdCBlbnRyaWVzLiIpOwogICAgICAgIFRo\ncmVhZC5zbGVlcChiYXNlQ29uZi5nZXRNYWpvckNvbXBhY3Rpb25JbnRlcnZh\nbCgpICogMTAwMAogICAgICAgICAgICAgICAgICAgKyBiYXNlQ29uZi5nZXRH\nY1dhaXRUaW1lKCkpOwoKICAgICAgICAvLyBlbnRyeSBsb2dzIChbMCwxXS5s\nb2cpIHNob3VsZCBub3QgYmUgY29tcGFjdGVkLgogICAgICAgIGZvciAoRmls\nZSBsZWRnZXJEaXJlY3RvcnkgOiB0bXBEaXJzKSB7CiAgICAgICAgICAgIGJv\nb2xlYW5bXSBoYXNMb2dGaWxlcyA9IGNoZWNrTG9nRmlsZXMobGVkZ2VyRGly\nZWN0b3J5LCAyKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiTm90IEZvdW5k\nIGVudHJ5IGxvZyBmaWxlIChbMCwxXS5sb2cgdGhhdCBzaG91bGQgaGF2ZSBi\nZWVuIGNvbXBhY3RlZCBpbiBsZWRnZXJEaXJlY3Rvcnk6ICIgKyBsZWRnZXJE\naXJlY3RvcnksIGhhc0xvZ0ZpbGVzWzBdICYgaGFzTG9nRmlsZXNbMV0pOwog\nICAgICAgIH0KICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVz\ndE1pbm9yQ29tcGFjdGlvbigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIC8vIHByZXBhcmUgZGF0YQogICAgICAgIExlZGdlckhhbmRsZVtdIGxocyA9\nIHByZXBhcmVEYXRhKDMsIGZhbHNlKTsKCiAgICAgICAgZm9yIChMZWRnZXJI\nYW5kbGUgbGggOiBsaHMpIHsKICAgICAgICAgICAgbGguY2xvc2UoKTsKICAg\nICAgICB9CgogICAgICAgIC8vIGRpc2FibGUgbWFqb3IgY29tcGFjdGlvbgog\nICAgICAgIGJhc2VDb25mLnNldE1ham9yQ29tcGFjdGlvblRocmVzaG9sZCgw\nLjBmKTsKCiAgICAgICAgLy8gcmVzdGFydCBib29raWVzCiAgICAgICAgcmVz\ndGFydEJvb2tpZXMoYmFzZUNvbmYpOwoKICAgICAgICAvLyByZW1vdmUgbGVk\nZ2VyMiBhbmQgbGVkZ2VyMwogICAgICAgIGJrYy5kZWxldGVMZWRnZXIobGhz\nWzFdLmdldElkKCkpOwogICAgICAgIGJrYy5kZWxldGVMZWRnZXIobGhzWzJd\nLmdldElkKCkpOwoKICAgICAgICBMT0cuaW5mbygiRmluaXNoZWQgZGVsZXRp\nbmcgdGhlIGxlZGdlcnMgY29udGFpbnMgbW9zdCBlbnRyaWVzLiIpOwogICAg\nICAgIFRocmVhZC5zbGVlcChiYXNlQ29uZi5nZXRNaW5vckNvbXBhY3Rpb25J\nbnRlcnZhbCgpICogMTAwMAogICAgICAgICAgICAgICAgICAgKyBiYXNlQ29u\nZi5nZXRHY1dhaXRUaW1lKCkpOwoKICAgICAgICAvLyBlbnRyeSBsb2dzIChb\nMCwxLDJdLmxvZykgc2hvdWxkIGJlIGNvbXBhY3RlZC4KICAgICAgICBmb3Ig\nKEZpbGUgbGVkZ2VyRGlyZWN0b3J5IDogdG1wRGlycykgewogICAgICAgICAg\nICBib29sZWFuW10gaGFzTG9nID0gY2hlY2tMb2dGaWxlcyhsZWRnZXJEaXJl\nY3RvcnksIDMpOyAKICAgICAgICAgICAgYXNzZXJ0RmFsc2UoIkZvdW5kIGVu\ndHJ5IGxvZyBmaWxlIChbMCwxLDJdLmxvZyB0aGF0IHNob3VsZCBoYXZlIG5v\ndCBiZWVuIGNvbXBhY3RlZCBpbiBsZWRnZXJEaXJlY3Rvcnk6ICIgKyBsZWRn\nZXJEaXJlY3RvcnksIGhhc0xvZ1swXSB8IGhhc0xvZ1sxXSB8IGhhc0xvZ1sy\nXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBldmVuIGVudHJ5IGxvZyBmaWxl\ncyBhcmUgcmVtb3ZlZCwgd2Ugc3RpbGwgY2FuIGFjY2VzcyBlbnRyaWVzIGZv\nciBsZWRnZXIxCiAgICAgICAgLy8gc2luY2UgdGhvc2UgZW50cmllcyBoYXMg\nYmVlbiBjb21wYWN0ZWQgdG8gbmV3IGVudHJ5IGxvZwogICAgICAgIHZlcmlm\neUxlZGdlcihsaHNbMF0uZ2V0SWQoKSwgMCwgbGhzWzBdLmdldExhc3RBZGRD\nb25maXJtZWQoKSk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lk\nIHRlc3RNYWpvckNvbXBhY3Rpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKCiAg\nICAgICAgLy8gcHJlcGFyZSBkYXRhCiAgICAgICAgTGVkZ2VySGFuZGxlW10g\nbGhzID0gcHJlcGFyZURhdGEoMywgdHJ1ZSk7CgogICAgICAgIGZvciAoTGVk\nZ2VySGFuZGxlIGxoIDogbGhzKSB7CiAgICAgICAgICAgIGxoLmNsb3NlKCk7\nCiAgICAgICAgfQoKICAgICAgICAvLyBkaXNhYmxlIG1pbm9yIGNvbXBhY3Rp\nb24KICAgICAgICBiYXNlQ29uZi5zZXRNaW5vckNvbXBhY3Rpb25UaHJlc2hv\nbGQoMC4wZik7CgogICAgICAgIC8vIHJlc3RhcnQgYm9va2llcwogICAgICAg\nIHJlc3RhcnRCb29raWVzKGJhc2VDb25mKTsKCiAgICAgICAgLy8gcmVtb3Zl\nIGxlZGdlcjEgYW5kIGxlZGdlcjMKICAgICAgICBia2MuZGVsZXRlTGVkZ2Vy\nKGxoc1swXS5nZXRJZCgpKTsKICAgICAgICBia2MuZGVsZXRlTGVkZ2VyKGxo\nc1syXS5nZXRJZCgpKTsKICAgICAgICBMT0cuaW5mbygiRmluaXNoZWQgZGVs\nZXRpbmcgdGhlIGxlZGdlcnMgY29udGFpbnMgbW9zdCBlbnRyaWVzLiIpOwoK\nICAgICAgICBUaHJlYWQuc2xlZXAoYmFzZUNvbmYuZ2V0TWFqb3JDb21wYWN0\naW9uSW50ZXJ2YWwoKSAqIDEwMDAKICAgICAgICAgICAgICAgICAgICsgYmFz\nZUNvbmYuZ2V0R2NXYWl0VGltZSgpKTsKCiAgICAgICAgLy8gZW50cnkgbG9n\ncyAoWzAsMSwyXS5sb2cpIHNob3VsZCBiZSBjb21wYWN0ZWQKICAgICAgICBm\nb3IgKEZpbGUgbGVkZ2VyRGlyZWN0b3J5IDogdG1wRGlycykgewogICAgICAg\nICAgICBib29sZWFuW10gaGFzTG9nRmlsZXMgPSBjaGVja0xvZ0ZpbGVzKGxl\nZGdlckRpcmVjdG9yeSwgMyk7IAogICAgICAgICAgICBhc3NlcnRGYWxzZSgi\nRm91bmQgZW50cnkgbG9nIGZpbGUgKFswLDEsMl0ubG9nIHRoYXQgc2hvdWxk\nIGhhdmUgbm90IGJlZW4gY29tcGFjdGVkIGluIGxlZGdlckRpcmVjdG9yeTog\nIgogICAgICAgICAgICAgICAgICAgICAgKyBsZWRnZXJEaXJlY3RvcnksIGhh\nc0xvZ0ZpbGVzWzBdIHwgaGFzTG9nRmlsZXNbMV0gfCBoYXNMb2dGaWxlc1sy\nXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBldmVuIGVudHJ5IGxvZyBmaWxl\ncyBhcmUgcmVtb3ZlZCwgd2Ugc3RpbGwgY2FuIGFjY2VzcyBlbnRyaWVzIGZv\nciBsZWRnZXIyCiAgICAgICAgLy8gc2luY2UgdGhvc2UgZW50cmllcyBoYXMg\nYmVlbiBjb21wYWN0ZWQgdG8gbmV3IGVudHJ5IGxvZwogICAgICAgIHZlcmlm\neUxlZGdlcihsaHNbMV0uZ2V0SWQoKSwgMCwgbGhzWzFdLmdldExhc3RBZGRD\nb25maXJtZWQoKSk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lk\nIHRlc3RNYWpvckNvbXBhY3Rpb25BYm92ZVRocmVzaG9sZCgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIC8vIHByZXBhcmUgZGF0YQogICAgICAgIExl\nZGdlckhhbmRsZVtdIGxocyA9IHByZXBhcmVEYXRhKDMsIGZhbHNlKTsKCiAg\nICAgICAgZm9yIChMZWRnZXJIYW5kbGUgbGggOiBsaHMpIHsKICAgICAgICAg\nICAgbGguY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIC8vIHJlbW92ZSBs\nZWRnZXIxIGFuZCBsZWRnZXIyCiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihs\naHNbMF0uZ2V0SWQoKSk7CiAgICAgICAgYmtjLmRlbGV0ZUxlZGdlcihsaHNb\nMV0uZ2V0SWQoKSk7CiAgICAgICAgTE9HLmluZm8oIkZpbmlzaGVkIGRlbGV0\naW5nIHRoZSBsZWRnZXJzIGNvbnRhaW5zIGxlc3MgZW50cmllcy4iKTsKICAg\nICAgICBUaHJlYWQuc2xlZXAoYmFzZUNvbmYuZ2V0TWFqb3JDb21wYWN0aW9u\nSW50ZXJ2YWwoKSAqIDEwMDAKICAgICAgICAgICAgICAgICAgICsgYmFzZUNv\nbmYuZ2V0R2NXYWl0VGltZSgpKTsKCiAgICAgICAgLy8gZW50cnkgbG9ncyAo\nWzAsMSwyXS5sb2cpIHNob3VsZCBub3QgYmUgY29tcGFjdGVkCiAgICAgICAg\nZm9yIChGaWxlIGxlZGdlckRpcmVjdG9yeSA6IHRtcERpcnMpIHsKICAgICAg\nICAgICAgYm9vbGVhbltdIGhhc0xvZ0ZpbGVzID0gY2hlY2tMb2dGaWxlcyhs\nZWRnZXJEaXJlY3RvcnksIDMpOyAKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgi\nTm90IEZvdW5kIGVudHJ5IGxvZyBmaWxlIChbMSwyXS5sb2cgdGhhdCBzaG91\nbGQgaGF2ZSBiZWVuIGNvbXBhY3RlZCBpbiBsZWRnZXJEaXJlY3Rvcnk6ICIK\nICAgICAgICAgICAgICAgICAgICAgKyBsZWRnZXJEaXJlY3RvcnksIGhhc0xv\nZ0ZpbGVzWzBdICYgaGFzTG9nRmlsZXNbMV0gJiBoYXNMb2dGaWxlc1syXSk7\nCiAgICAgICAgfQogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0\nZXN0Q29tcGFjdGlvblNtYWxsRW50cnlMb2dzKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CgogICAgICAgIC8vIGNyZWF0ZSBhIGxlZGdlciB0byB3cml0ZSBhIGZl\ndyBlbnRyaWVzCiAgICAgICAgTGVkZ2VySGFuZGxlIGFsaCA9IGJrYy5jcmVh\ndGVMZWRnZXIoTlVNX0JPT0tJRVMsIE5VTV9CT09LSUVTLCBkaWdlc3RUeXBl\nLCAiIi5nZXRCeXRlcygpKTsKICAgICAgICBmb3IgKGludCBpPTA7IGk8Mzsg\naSsrKSB7CiAgICAgICAgICAgYWxoLmFkZEVudHJ5KG1zZy5nZXRCeXRlcygp\nKTsKICAgICAgICB9CiAgICAgICAgYWxoLmNsb3NlKCk7CgogICAgICAgIC8v\nIHJlc3RhcnQgYm9va2llIHRvIHJvbGwgZW50cnkgbG9nIGZpbGVzCiAgICAg\nICAgcmVzdGFydEJvb2tpZXMoKTsKCiAgICAgICAgLy8gcHJlcGFyZSBkYXRh\nCiAgICAgICAgTGVkZ2VySGFuZGxlW10gbGhzID0gcHJlcGFyZURhdGEoMywg\nZmFsc2UpOwoKICAgICAgICBmb3IgKExlZGdlckhhbmRsZSBsaCA6IGxocykg\newogICAgICAgICAgICBsaC5jbG9zZSgpOwogICAgICAgIH0KCiAgICAgICAg\nLy8gcmVtb3ZlIGxlZGdlcjIgYW5kIGxlZGdlcjMKICAgICAgICBia2MuZGVs\nZXRlTGVkZ2VyKGxoc1sxXS5nZXRJZCgpKTsKICAgICAgICBia2MuZGVsZXRl\nTGVkZ2VyKGxoc1syXS5nZXRJZCgpKTsKICAgICAgICBMT0cuaW5mbygiRmlu\naXNoZWQgZGVsZXRpbmcgdGhlIGxlZGdlcnMgY29udGFpbnMgbW9zdCBlbnRy\naWVzLiIpOwogICAgICAgIFRocmVhZC5zbGVlcChiYXNlQ29uZi5nZXRNYWpv\nckNvbXBhY3Rpb25JbnRlcnZhbCgpICogMTAwMAogICAgICAgICAgICAgICAg\nICAgKyBiYXNlQ29uZi5nZXRHY1dhaXRUaW1lKCkpOwoKICAgICAgICAvLyBl\nbnRyeSBsb2dzICgwLmxvZykgc2hvdWxkIG5vdCBiZSBjb21wYWN0ZWQKICAg\nICAgICAvLyBlbnRyeSBsb2dzIChbMSwyLDNdLmxvZykgc2hvdWxkIGJlIGNv\nbXBhY3RlZC4KICAgICAgICBmb3IgKEZpbGUgbGVkZ2VyRGlyZWN0b3J5IDog\ndG1wRGlycykgewogICAgICAgICAgICBib29sZWFuW10gaGFzTG9nID0gY2hl\nY2tMb2dGaWxlcyhsZWRnZXJEaXJlY3RvcnksIDQpOwogICAgICAgICAgICAK\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiTm90IEZvdW5kIGVudHJ5IGxvZyBm\naWxlIChbMF0ubG9nIHRoYXQgc2hvdWxkIGhhdmUgYmVlbiBjb21wYWN0ZWQg\naW4gbGVkZ2VyRGlyZWN0b3J5OiAiCiAgICAgICAgICAgICAgICAgICAgICsg\nbGVkZ2VyRGlyZWN0b3J5LCBoYXNMb2dbMF0pOwogICAgICAgICAgICBhc3Nl\ncnRGYWxzZSgiRm91bmQgZW50cnkgbG9nIGZpbGUgKFsxLDIsM10ubG9nIHRo\nYXQgc2hvdWxkIGhhdmUgbm90IGJlZW4gY29tcGFjdGVkIGluIGxlZGdlckRp\ncmVjdG9yeTogIgogICAgICAgICAgICAgICAgICAgICAgKyBsZWRnZXJEaXJl\nY3RvcnksIGhhc0xvZ1sxXSB8IGhhc0xvZ1syXSB8IGhhc0xvZ1szXSk7CiAg\nICAgICAgfQoKICAgICAgICAvLyBldmVuIGVudHJ5IGxvZyBmaWxlcyBhcmUg\ncmVtb3ZlZCwgd2Ugc3RpbGwgY2FuIGFjY2VzcyBlbnRyaWVzIGZvciBsZWRn\nZXIxCiAgICAgICAgLy8gc2luY2UgdGhvc2UgZW50cmllcyBoYXMgYmVlbiBj\nb21wYWN0ZWQgdG8gbmV3IGVudHJ5IGxvZwogICAgICAgIHZlcmlmeUxlZGdl\ncihsaHNbMF0uZ2V0SWQoKSwgMCwgbGhzWzBdLmdldExhc3RBZGRDb25maXJt\nZWQoKSk7CiAgICB9Cn0K\n","encoding":"base64"}

