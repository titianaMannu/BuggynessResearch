{"sha":"615d48e0fe0b6fb657297d260725d172108e3cc7","node_id":"MDQ6QmxvYjE1NzU5NTY6NjE1ZDQ4ZTBmZTBiNmZiNjU3Mjk3ZDI2MDcyNWQxNzIxMDhlM2NjNw==","size":10939,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/615d48e0fe0b6fb657297d260725d172108e3cc7","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmlvLkZpbGVVdGlsczsKaW1wb3J0\nIG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdC5ab29LZWVw\nZXJVdGlsOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuWm9vS2VlcGVy\nOwoKaW1wb3J0IGphdmEuaW8uRmlsZU91dHB1dFN0cmVhbTsKaW1wb3J0IGph\ndmEuaW8uQnVmZmVyZWRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0\ncmVhbVdyaXRlcjsKCmltcG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZh\nLmlvLklPRXhjZXB0aW9uOwoKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBv\ncnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsK\naW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7CgppbXBvcnQgc3Rh\ndGljIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWUuVXBncmFkZVRlc3Qu\nKjsKCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRq\nLkxvZ2dlckZhY3Rvcnk7CgpwdWJsaWMgY2xhc3MgQ29va2llVGVzdCB7CiAg\nICBab29LZWVwZXJVdGlsIHprdXRpbDsKICAgIFpvb0tlZXBlciB6a2MgPSBu\ndWxsOwoKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldHVwWm9vS2Vl\ncGVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgemt1dGlsID0gbmV3\nIFpvb0tlZXBlclV0aWwoKTsKICAgICAgICB6a3V0aWwuc3RhcnRTZXJ2ZXIo\nKTsKICAgICAgICB6a2MgPSB6a3V0aWwuZ2V0Wm9vS2VlcGVyQ2xpZW50KCk7\nCiAgICB9CgogICAgQEFmdGVyCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93blpv\nb0tlZXBlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHprdXRpbC5r\naWxsU2VydmVyKCk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5n\nIG5ld0RpcmVjdG9yeSgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIG5ld0RpcmVjdG9yeSh0cnVlKTsKICAgIH0KCiAgICBwcml2YXRl\nIHN0YXRpYyBTdHJpbmcgbmV3RGlyZWN0b3J5KGJvb2xlYW4gY3JlYXRlQ3Vy\nRGlyKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIEZpbGUgZCA9IEZp\nbGUuY3JlYXRlVGVtcEZpbGUoImJvb2tpZSIsICJ0bXBkaXIiKTsKICAgICAg\nICBkLmRlbGV0ZSgpOwogICAgICAgIGQubWtkaXJzKCk7CiAgICAgICAgaWYg\nKGNyZWF0ZUN1ckRpcikgewogICAgICAgICAgICBuZXcgRmlsZShkLCAiY3Vy\ncmVudCIpLm1rZGlycygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZC5n\nZXRQYXRoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHN0YXJ0aW5n\nIGJvb2tpZSB3aXRoIGNsZWFuIHN0YXRlLgogICAgICovCiAgICBAVGVzdAog\nICAgcHVibGljIHZvaWQgdGVzdENsZWFuU3RhcnQoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcg\nU2VydmVyQ29uZmlndXJhdGlvbigpCiAgICAgICAgICAgIC5zZXRaa1NlcnZl\ncnMoemt1dGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSkKICAgICAg\nICAgICAgLnNldEpvdXJuYWxEaXJOYW1lKG5ld0RpcmVjdG9yeShmYWxzZSkp\nCiAgICAgICAgICAgIC5zZXRMZWRnZXJEaXJOYW1lcyhuZXcgU3RyaW5nW10g\neyBuZXdEaXJlY3RvcnkoZmFsc2UpIH0pCiAgICAgICAgICAgIC5zZXRCb29r\naWVQb3J0KDMxODEpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEJvb2tp\nZSBiID0gbmV3IEJvb2tpZShjb25mKTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBmYWlsKCJTaG91bGQgbm90IHJlYWNo\nIGhlcmUuIik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGVz\ndCB0aGF0IGlmIGEgem9va2VlcGVyIGNvb2tpZQogICAgICogaXMgZGlmZmVy\nZW50IHRvIGEgbG9jYWwgY29va2llLCB0aGUgYm9va2llCiAgICAgKiB3aWxs\nIGZhaWwgdG8gc3RhcnQKICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2\nb2lkIHRlc3RCYWRKb3VybmFsQ29va2llKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgU2VydmVyQ29uZmlndXJhdGlvbiBjb25mMSA9IG5ldyBTZXJ2\nZXJDb25maWd1cmF0aW9uKCkKICAgICAgICAgICAgLnNldEpvdXJuYWxEaXJO\nYW1lKG5ld0RpcmVjdG9yeSgpKQogICAgICAgICAgICAuc2V0TGVkZ2VyRGly\nTmFtZXMobmV3IFN0cmluZ1tdIHsgbmV3RGlyZWN0b3J5KCkgfSkKICAgICAg\nICAgICAgLnNldEJvb2tpZVBvcnQoMzE4MSk7CiAgICAgICAgQ29va2llIGMg\nPSBDb29raWUuZ2VuZXJhdGVDb29raWUoY29uZjEpOwogICAgICAgIGMud3Jp\ndGVUb1pvb0tlZXBlcih6a2MsIGNvbmYxKTsKCiAgICAgICAgU3RyaW5nIGpv\ndXJuYWxEaXIgPSBuZXdEaXJlY3RvcnkoKTsKICAgICAgICBTdHJpbmcgbGVk\nZ2VyRGlyID0gbmV3RGlyZWN0b3J5KCk7CiAgICAgICAgU2VydmVyQ29uZmln\ndXJhdGlvbiBjb25mMiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9uKCkKICAg\nICAgICAgICAgLnNldFprU2VydmVycyh6a3V0aWwuZ2V0Wm9vS2VlcGVyQ29u\nbmVjdFN0cmluZygpKQogICAgICAgICAgICAuc2V0Sm91cm5hbERpck5hbWUo\nam91cm5hbERpcikKICAgICAgICAgICAgLnNldExlZGdlckRpck5hbWVzKG5l\ndyBTdHJpbmdbXSB7IGxlZGdlckRpciB9KQogICAgICAgICAgICAuc2V0Qm9v\na2llUG9ydCgzMTgxKTsKICAgICAgICBDb29raWUgYzIgPSBDb29raWUuZ2Vu\nZXJhdGVDb29raWUoY29uZjIpOwogICAgICAgIGMyLndyaXRlVG9EaXJlY3Rv\ncnkobmV3IEZpbGUoam91cm5hbERpciwgImN1cnJlbnQiKSk7CiAgICAgICAg\nYzIud3JpdGVUb0RpcmVjdG9yeShuZXcgRmlsZShsZWRnZXJEaXIsICJjdXJy\nZW50IikpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBCb29raWUgYiA9\nIG5ldyBCb29raWUoY29uZjIpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRu\nJ3QgaGF2ZSBiZWVuIGFibGUgdG8gc3RhcnQiKTsKICAgICAgICB9IGNhdGNo\nIChCb29raWVFeGNlcHRpb24uSW52YWxpZENvb2tpZUV4Y2VwdGlvbiBpY2Up\nIHsKICAgICAgICAgICAgLy8gY29ycmVjdCBiZWhhdmlvdXIKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgaWYgYSBkaXJlY3Rv\ncnkgaXMgcmVtb3ZlZCBmcm9tCiAgICAgKiB0aGUgY29uZmlndXJhdGlvbiwg\ndGhlIGJvb2tpZSB3aWxsIGZhaWwgdG8KICAgICAqIHN0YXJ0CiAgICAgKi8K\nICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0RGlyZWN0b3J5TWlzc2lu\nZygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZ1tdIGxlZGdl\nckRpcnMgPSBuZXcgU3RyaW5nW10gewogICAgICAgICAgICBuZXdEaXJlY3Rv\ncnkoKSwgbmV3RGlyZWN0b3J5KCksIG5ld0RpcmVjdG9yeSgpIH07CiAgICAg\nICAgU3RyaW5nIGpvdXJuYWxEaXIgPSBuZXdEaXJlY3RvcnkoKTsKICAgICAg\nICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgU2VydmVyQ29uZmln\ndXJhdGlvbigpCiAgICAgICAgICAgIC5zZXRaa1NlcnZlcnMoemt1dGlsLmdl\ndFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSkKICAgICAgICAgICAgLnNldEpv\ndXJuYWxEaXJOYW1lKGpvdXJuYWxEaXIpCiAgICAgICAgICAgIC5zZXRMZWRn\nZXJEaXJOYW1lcyhsZWRnZXJEaXJzKQogICAgICAgICAgICAuc2V0Qm9va2ll\nUG9ydCgzMTgxKTsKCiAgICAgICAgQm9va2llIGIgPSBuZXcgQm9va2llKGNv\nbmYpOyAvLyBzaG91bGQgd29yayBmaW5lCiAgICAgICAgYi5zdGFydCgpOwog\nICAgICAgIGIuc2h1dGRvd24oKTsKCiAgICAgICAgY29uZi5zZXRMZWRnZXJE\naXJOYW1lcyhuZXcgU3RyaW5nW10geyBsZWRnZXJEaXJzWzBdLCBsZWRnZXJE\naXJzWzFdIH0pOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEJvb2tpZSBi\nMiA9IG5ldyBCb29raWUoY29uZik7CiAgICAgICAgICAgIGZhaWwoIlNob3Vs\nZG4ndCBoYXZlIGJlZW4gYWJsZSB0byBzdGFydCIpOwogICAgICAgIH0gY2F0\nY2ggKEJvb2tpZUV4Y2VwdGlvbi5JbnZhbGlkQ29va2llRXhjZXB0aW9uIGlj\nZSkgewogICAgICAgICAgICAvLyBjb3JyZWN0IGJlaGF2aW91cgogICAgICAg\nIH0KCiAgICAgICAgY29uZi5zZXRKb3VybmFsRGlyTmFtZShuZXdEaXJlY3Rv\ncnkoKSkuc2V0TGVkZ2VyRGlyTmFtZXMobGVkZ2VyRGlycyk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgQm9va2llIGIyID0gbmV3IEJvb2tpZShjb25m\nKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0IGhhdmUgYmVlbiBhYmxl\nIHRvIHN0YXJ0Iik7CiAgICAgICAgfSBjYXRjaCAoQm9va2llRXhjZXB0aW9u\nLkludmFsaWRDb29raWVFeGNlcHRpb24gaWNlKSB7CiAgICAgICAgICAgIC8v\nIGNvcnJlY3QgYmVoYXZpb3VyCiAgICAgICAgfQoKICAgICAgICBjb25mLnNl\ndEpvdXJuYWxEaXJOYW1lKGpvdXJuYWxEaXIpOwogICAgICAgIGIgPSBuZXcg\nQm9va2llKGNvbmYpOwogICAgICAgIGIuc3RhcnQoKTsKICAgICAgICBiLnNo\ndXRkb3duKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgaWYg\nYSBkaXJlY3RvcnkgaXMgYWRkZWQgdG8gYQogICAgICogcHJlZXhpc3Rpbmcg\nYm9va2llLCB0aGUgYm9va2llIHdpbGwgZmFpbAogICAgICogdG8gc3RhcnQK\nICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3REaXJlY3Rv\ncnlBZGRlZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBs\nZWRnZXJEaXIwID0gbmV3RGlyZWN0b3J5KCk7CiAgICAgICAgU3RyaW5nIGpv\ndXJuYWxEaXIgPSBuZXdEaXJlY3RvcnkoKTsKICAgICAgICBTZXJ2ZXJDb25m\naWd1cmF0aW9uIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbigpCiAg\nICAgICAgICAgIC5zZXRaa1NlcnZlcnMoemt1dGlsLmdldFpvb0tlZXBlckNv\nbm5lY3RTdHJpbmcoKSkKICAgICAgICAgICAgLnNldEpvdXJuYWxEaXJOYW1l\nKGpvdXJuYWxEaXIpCiAgICAgICAgICAgIC5zZXRMZWRnZXJEaXJOYW1lcyhu\nZXcgU3RyaW5nW10geyBsZWRnZXJEaXIwIH0pCiAgICAgICAgICAgIC5zZXRC\nb29raWVQb3J0KDMxODEpOwoKICAgICAgICBCb29raWUgYiA9IG5ldyBCb29r\naWUoY29uZik7IC8vIHNob3VsZCB3b3JrIGZpbmUKICAgICAgICBiLnN0YXJ0\nKCk7CiAgICAgICAgYi5zaHV0ZG93bigpOwoKICAgICAgICBjb25mLnNldExl\nZGdlckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7IGxlZGdlckRpcjAsIG5ld0Rp\ncmVjdG9yeSgpIH0pOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEJvb2tp\nZSBiMiA9IG5ldyBCb29raWUoY29uZik7CiAgICAgICAgICAgIGZhaWwoIlNo\nb3VsZG4ndCBoYXZlIGJlZW4gYWJsZSB0byBzdGFydCIpOwogICAgICAgIH0g\nY2F0Y2ggKEJvb2tpZUV4Y2VwdGlvbi5JbnZhbGlkQ29va2llRXhjZXB0aW9u\nIGljZSkgewogICAgICAgICAgICAvLyBjb3JyZWN0IGJlaGF2aW91cgogICAg\nICAgIH0KCiAgICAgICAgY29uZi5zZXRMZWRnZXJEaXJOYW1lcyhuZXcgU3Ry\naW5nW10geyBsZWRnZXJEaXIwIH0pOwogICAgICAgIGIgPSBuZXcgQm9va2ll\nKGNvbmYpOwogICAgICAgIGIuc3RhcnQoKTsKICAgICAgICBiLnNodXRkb3du\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgaWYgYSBkaXJl\nY3RvcnkncyBjb250ZW50cwogICAgICogYXJlIGVtcHRpZWQsIHRoZSBib29r\naWUgd2lsbCBmYWlsIHRvIHN0YXJ0CiAgICAgKi8KICAgIEBUZXN0CiAgICBw\ndWJsaWMgdm9pZCB0ZXN0RGlyZWN0b3J5Q2xlYXJlZCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIFN0cmluZyBsZWRnZXJEaXIwID0gbmV3RGlyZWN0\nb3J5KCk7CiAgICAgICAgU3RyaW5nIGpvdXJuYWxEaXIgPSBuZXdEaXJlY3Rv\ncnkoKTsKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcg\nU2VydmVyQ29uZmlndXJhdGlvbigpCiAgICAgICAgICAgIC5zZXRaa1NlcnZl\ncnMoemt1dGlsLmdldFpvb0tlZXBlckNvbm5lY3RTdHJpbmcoKSkKICAgICAg\nICAgICAgLnNldEpvdXJuYWxEaXJOYW1lKGpvdXJuYWxEaXIpCiAgICAgICAg\nICAgIC5zZXRMZWRnZXJEaXJOYW1lcyhuZXcgU3RyaW5nW10geyBsZWRnZXJE\naXIwICwgbmV3RGlyZWN0b3J5KCkgfSkKICAgICAgICAgICAgLnNldEJvb2tp\nZVBvcnQoMzE4MSk7CgogICAgICAgIEJvb2tpZSBiID0gbmV3IEJvb2tpZShj\nb25mKTsgLy8gc2hvdWxkIHdvcmsgZmluZQogICAgICAgIGIuc3RhcnQoKTsK\nICAgICAgICBiLnNodXRkb3duKCk7CgogICAgICAgIEZpbGVVdGlscy5kZWxl\ndGVEaXJlY3RvcnkobmV3IEZpbGUobGVkZ2VyRGlyMCkpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIEJvb2tpZSBiMiA9IG5ldyBCb29raWUoY29uZik7\nCiAgICAgICAgICAgIGZhaWwoIlNob3VsZG4ndCBoYXZlIGJlZW4gYWJsZSB0\nbyBzdGFydCIpOwogICAgICAgIH0gY2F0Y2ggKEJvb2tpZUV4Y2VwdGlvbi5J\nbnZhbGlkQ29va2llRXhjZXB0aW9uIGljZSkgewogICAgICAgICAgICAvLyBj\nb3JyZWN0IGJlaGF2aW91cgogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFRlc3QgdGhhdCBpZiBhIGJvb2tpZSdzIHBvcnQgaXMgY2hhbmdlZAog\nICAgICogdGhlIGJvb2tpZSB3aWxsIGZhaWwgdG8gc3RhcnQKICAgICAqLwog\nICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RCb29raWVQb3J0Q2hhbmdl\nZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9uKCkKICAgICAg\nICAgICAgLnNldFprU2VydmVycyh6a3V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVj\ndFN0cmluZygpKQogICAgICAgICAgICAuc2V0Sm91cm5hbERpck5hbWUobmV3\nRGlyZWN0b3J5KCkpCiAgICAgICAgICAgIC5zZXRMZWRnZXJEaXJOYW1lcyhu\nZXcgU3RyaW5nW10geyBuZXdEaXJlY3RvcnkoKSAsIG5ld0RpcmVjdG9yeSgp\nIH0pCiAgICAgICAgICAgIC5zZXRCb29raWVQb3J0KDMxODEpOwogICAgICAg\nIEJvb2tpZSBiID0gbmV3IEJvb2tpZShjb25mKTsgLy8gc2hvdWxkIHdvcmsg\nZmluZQogICAgICAgIGIuc3RhcnQoKTsKICAgICAgICBiLnNodXRkb3duKCk7\nCgogICAgICAgIGNvbmYuc2V0Qm9va2llUG9ydCgzMTgyKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBiID0gbmV3IEJvb2tpZShjb25mKTsKICAgICAg\nICAgICAgZmFpbCgiU2hvdWxkbid0IGhhdmUgYmVlbiBhYmxlIHRvIHN0YXJ0\nIik7CiAgICAgICAgfSBjYXRjaCAoQm9va2llRXhjZXB0aW9uLkludmFsaWRD\nb29raWVFeGNlcHRpb24gaWNlKSB7CiAgICAgICAgICAgIC8vIGNvcnJlY3Qg\nYmVoYXZpb3VyCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGVz\ndCB0aGF0IGlmIGEgYm9va2llIHRyaWVzIHRvIHN0YXJ0CiAgICAgKiB3aXRo\nIHRoZSBhZGRyZXNzIG9mIGEgYm9va2llIHdoaWNoIGhhcyBhbHJlYWR5CiAg\nICAgKiBleGlzdGVkIGluIHRoZSBzeXN0ZW0sIHRoZW4gdGhlIGJvb2tpZSB3\naWxsIGZhaWwKICAgICAqIHRvIHN0YXJ0CiAgICAgKi8KICAgIEBUZXN0CiAg\nICBwdWJsaWMgdm9pZCB0ZXN0TmV3Qm9va2llU3RhcnRpbmdXaXRoQW5vdGhl\nckJvb2tpZXNQb3J0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgU2Vy\ndmVyQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRp\nb24oKQogICAgICAgICAgICAuc2V0WmtTZXJ2ZXJzKHprdXRpbC5nZXRab29L\nZWVwZXJDb25uZWN0U3RyaW5nKCkpCiAgICAgICAgICAgIC5zZXRKb3VybmFs\nRGlyTmFtZShuZXdEaXJlY3RvcnkoKSkKICAgICAgICAgICAgLnNldExlZGdl\nckRpck5hbWVzKG5ldyBTdHJpbmdbXSB7IG5ld0RpcmVjdG9yeSgpICwgbmV3\nRGlyZWN0b3J5KCkgfSkKICAgICAgICAgICAgLnNldEJvb2tpZVBvcnQoMzE4\nMSk7CiAgICAgICAgQm9va2llIGIgPSBuZXcgQm9va2llKGNvbmYpOyAvLyBz\naG91bGQgd29yayBmaW5lCiAgICAgICAgYi5zdGFydCgpOwogICAgICAgIGIu\nc2h1dGRvd24oKTsKCiAgICAgICAgY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1\ncmF0aW9uKCkKICAgICAgICAgICAgLnNldFprU2VydmVycyh6a3V0aWwuZ2V0\nWm9vS2VlcGVyQ29ubmVjdFN0cmluZygpKQogICAgICAgICAgICAuc2V0Sm91\ncm5hbERpck5hbWUobmV3RGlyZWN0b3J5KCkpCiAgICAgICAgICAgIC5zZXRM\nZWRnZXJEaXJOYW1lcyhuZXcgU3RyaW5nW10geyBuZXdEaXJlY3RvcnkoKSAs\nIG5ld0RpcmVjdG9yeSgpIH0pCiAgICAgICAgICAgIC5zZXRCb29raWVQb3J0\nKDMxODEpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGIgPSBuZXcgQm9v\na2llKGNvbmYpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgaGF2ZSBi\nZWVuIGFibGUgdG8gc3RhcnQiKTsKICAgICAgICB9IGNhdGNoIChCb29raWVF\neGNlcHRpb24uSW52YWxpZENvb2tpZUV4Y2VwdGlvbiBpY2UpIHsKICAgICAg\nICAgICAgLy8gY29ycmVjdCBiZWhhdmlvdXIKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgaWYgYSBib29raWUgaXMgc3RhcnRl\nZCB3aXRoIGRpcmVjdG9yaWVzIHdpdGgKICAgICAqIHZlcnNpb24gMiBkYXRh\nLCB0aGF0IGl0IHdpbGwgZmFpbCB0byBzdGFydCAoaXQgbmVlZHMgdXBncmFk\nZSkKICAgICAqLwogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RWMmRh\ndGEoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTZXJ2ZXJDb25maWd1\ncmF0aW9uIGNvbmYgPSBuZXcgU2VydmVyQ29uZmlndXJhdGlvbigpCiAgICAg\nICAgICAgIC5zZXRaa1NlcnZlcnMoemt1dGlsLmdldFpvb0tlZXBlckNvbm5l\nY3RTdHJpbmcoKSkKICAgICAgICAgICAgLnNldEpvdXJuYWxEaXJOYW1lKG5l\nd1YySm91cm5hbERpcmVjdG9yeSgpKQogICAgICAgICAgICAuc2V0TGVkZ2Vy\nRGlyTmFtZXMobmV3IFN0cmluZ1tdIHsgbmV3VjJMZWRnZXJEaXJlY3Rvcnko\nKSB9KQogICAgICAgICAgICAuc2V0Qm9va2llUG9ydCgzMTgxKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBCb29raWUgYiA9IG5ldyBCb29raWUoY29u\nZik7CiAgICAgICAgICAgIGZhaWwoIlNob3VsZG4ndCBoYXZlIGJlZW4gYWJs\nZSB0byBzdGFydCIpOwogICAgICAgIH0gY2F0Y2ggKEJvb2tpZUV4Y2VwdGlv\nbi5JbnZhbGlkQ29va2llRXhjZXB0aW9uIGljZSkgewogICAgICAgICAgICAv\nLyBjb3JyZWN0IGJlaGF2aW91cgogICAgICAgICAgICBhc3NlcnRUcnVlKCJ3\ncm9uZyBleGNlcHRpb24iLCBpY2UuZ2V0Q2F1c2UoKS5nZXRNZXNzYWdlKCku\nY29udGFpbnMoInVwZ3JhZGUgbmVlZGVkIikpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFRlc3QgdGhhdCBpZiBhIGJvb2tpZSBpcyBzdGFy\ndGVkIHdpdGggZGlyZWN0b3JpZXMgd2l0aAogICAgICogdmVyc2lvbiAxIGRh\ndGEsIHRoYXQgaXQgd2lsbCBmYWlsIHRvIHN0YXJ0IChpdCBuZWVkcyB1cGdy\nYWRlKQogICAgICovCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdFYx\nZGF0YSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIFNlcnZlckNvbmZp\nZ3VyYXRpb24gY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9uKCkKICAg\nICAgICAgICAgLnNldFprU2VydmVycyh6a3V0aWwuZ2V0Wm9vS2VlcGVyQ29u\nbmVjdFN0cmluZygpKQogICAgICAgICAgICAuc2V0Sm91cm5hbERpck5hbWUo\nbmV3VjFKb3VybmFsRGlyZWN0b3J5KCkpCiAgICAgICAgICAgIC5zZXRMZWRn\nZXJEaXJOYW1lcyhuZXcgU3RyaW5nW10geyBuZXdWMUxlZGdlckRpcmVjdG9y\neSgpIH0pCiAgICAgICAgICAgIC5zZXRCb29raWVQb3J0KDMxODEpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIEJvb2tpZSBiID0gbmV3IEJvb2tpZShj\nb25mKTsKICAgICAgICAgICAgZmFpbCgiU2hvdWxkbid0IGhhdmUgYmVlbiBh\nYmxlIHRvIHN0YXJ0Iik7CiAgICAgICAgfSBjYXRjaCAoQm9va2llRXhjZXB0\naW9uLkludmFsaWRDb29raWVFeGNlcHRpb24gaWNlKSB7CiAgICAgICAgICAg\nIC8vIGNvcnJlY3QgYmVoYXZpb3VyCiAgICAgICAgICAgIGFzc2VydFRydWUo\nIndyb25nIGV4Y2VwdGlvbiIsIGljZS5nZXRDYXVzZSgpLmdldE1lc3NhZ2Uo\nKS5jb250YWlucygidXBncmFkZSBuZWVkZWQiKSk7CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

