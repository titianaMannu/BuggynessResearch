{"sha":"3d598573189d6d384d9d733231085a77d05dd60d","node_id":"MDQ6QmxvYjE1NzU5NTY6M2Q1OTg1NzMxODlkNmQzODRkOWQ3MzMyMzEwODVhNzdkMDVkZDYwZA==","size":6563,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/3d598573189d6d384d9d733231085a77d05dd60d","content":"LyoqCiAqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRv\nciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAq\nIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGlu\nZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRo\nZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5z\nZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21w\nbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBh\nIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAq\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5GaWxlTm90Rm91\nbmRFeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBv\ncnQgamF2YS5pby5SYW5kb21BY2Nlc3NGaWxlOwppbXBvcnQgamF2YS5uaW8u\nQnl0ZUJ1ZmZlcjsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7\nCgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmJvb2tpZS5HYXJiYWdl\nQ29sbGVjdG9yVGhyZWFkLkVudHJ5TG9nTWV0YWRhdGE7CmltcG9ydCBvcmcu\nYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkdhcmJhZ2VDb2xsZWN0b3JUaHJl\nYWQuRXh0cmFjdGlvblNjYW5uZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY29uZi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmp1\nbml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9y\nZy5qdW5pdC5UZXN0OwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9y\ndCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCnB1YmxpYyBjbGFzcyBFbnRy\neUxvZ1Rlc3QgZXh0ZW5kcyBUZXN0Q2FzZSB7CiAgICBzdGF0aWMgTG9nZ2Vy\nIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKEVudHJ5TG9nVGVzdC5j\nbGFzcyk7CgogICAgQEJlZm9yZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGlj\nIHZvaWQgdGVzdENvcnJ1cHRFbnRyeUxvZygpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIEZpbGUgdG1wRGlyID0gRmlsZS5jcmVhdGVUZW1wRmlsZSgi\nYmtUZXN0IiwgIi5kaXIiKTsKICAgICAgICB0bXBEaXIuZGVsZXRlKCk7CiAg\nICAgICAgdG1wRGlyLm1rZGlyKCk7CiAgICAgICAgRmlsZSBjdXJEaXIgPSBC\nb29raWUuZ2V0Q3VycmVudERpcmVjdG9yeSh0bXBEaXIpOwogICAgICAgIEJv\nb2tpZS5jaGVja0RpcmVjdG9yeVN0cnVjdHVyZShjdXJEaXIpOwoKICAgICAg\nICBpbnQgZ2NXYWl0VGltZSA9IDEwMDA7CiAgICAgICAgU2VydmVyQ29uZmln\ndXJhdGlvbiBjb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oKTsKICAg\nICAgICBjb25mLnNldEdjV2FpdFRpbWUoZ2NXYWl0VGltZSk7CiAgICAgICAg\nY29uZi5zZXRMZWRnZXJEaXJOYW1lcyhuZXcgU3RyaW5nW10ge3RtcERpci50\nb1N0cmluZygpfSk7CiAgICAgICAgLy8gY3JlYXRlIHNvbWUgZW50cmllcwog\nICAgICAgIEVudHJ5TG9nZ2VyIGxvZ2dlciA9IG5ldyBFbnRyeUxvZ2dlcihj\nb25mKTsKICAgICAgICBsb2dnZXIuYWRkRW50cnkoMSwgZ2VuZXJhdGVFbnRy\neSgxLCAxKSk7CiAgICAgICAgbG9nZ2VyLmFkZEVudHJ5KDMsIGdlbmVyYXRl\nRW50cnkoMywgMSkpOwogICAgICAgIGxvZ2dlci5hZGRFbnRyeSgyLCBnZW5l\ncmF0ZUVudHJ5KDIsIDEpKTsKICAgICAgICBsb2dnZXIuZmx1c2goKTsKICAg\nICAgICAvLyBub3cgbGV0cyB0cnVuY2F0ZSB0aGUgZmlsZSB0byBjb3JydXB0\nIHRoZSBsYXN0IGVudHJ5LCB3aGljaCBzaW11bGF0ZXMgYSBwYXJ0aWFsIHdy\naXRlCiAgICAgICAgRmlsZSBmID0gbmV3IEZpbGUoY3VyRGlyLCAiMC5sb2ci\nKTsKICAgICAgICBSYW5kb21BY2Nlc3NGaWxlIHJhZiA9IG5ldyBSYW5kb21B\nY2Nlc3NGaWxlKGYsICJydyIpOwogICAgICAgIHJhZi5zZXRMZW5ndGgocmFm\nLmxlbmd0aCgpLTEwKTsKICAgICAgICByYWYuY2xvc2UoKTsKICAgICAgICAv\nLyBub3cgc2VlIHdoaWNoIGxlZGdlcnMgYXJlIGluIHRoZSBsb2cKICAgICAg\nICBsb2dnZXIgPSBuZXcgRW50cnlMb2dnZXIoY29uZik7CgogICAgICAgIEVu\ndHJ5TG9nTWV0YWRhdGEgbWV0YSA9IG5ldyBFbnRyeUxvZ01ldGFkYXRhKDBM\nKTsKICAgICAgICBFeHRyYWN0aW9uU2Nhbm5lciBzY2FubmVyID0gbmV3IEV4\ndHJhY3Rpb25TY2FubmVyKG1ldGEpOwoKICAgICAgICB0cnkgewogICAgICAg\nICAgICBsb2dnZXIuc2NhbkVudHJ5TG9nKDBMLCBzY2FubmVyKTsKICAgICAg\nICAgICAgZmFpbCgiU2hvdWxkIG5vdCByZWFjaCBoZXJlISIpOwogICAgICAg\nIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGllKSB7CiAgICAgICAgfQoKICAgICAg\nICBMT0cuaW5mbygiRXh0cmFjdGVkIE1ldGEgRnJvbSBFbnRyeSBMb2cge30i\nLCBtZXRhKTsKICAgICAgICBhc3NlcnROb3ROdWxsKG1ldGEubGVkZ2Vyc01h\ncC5nZXQoMUwpKTsKICAgICAgICBhc3NlcnROdWxsKG1ldGEubGVkZ2Vyc01h\ncC5nZXQoMkwpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKG1ldGEubGVkZ2Vy\nc01hcC5nZXQoM0wpKTsKICAgIH0KCiAgICBwcml2YXRlIEJ5dGVCdWZmZXIg\nZ2VuZXJhdGVFbnRyeShsb25nIGxlZGdlciwgbG9uZyBlbnRyeSkgewogICAg\nICAgIEJ5dGVCdWZmZXIgYmIgPSBCeXRlQnVmZmVyLndyYXAobmV3IGJ5dGVb\nNjRdKTsKICAgICAgICBiYi5wdXRMb25nKGxlZGdlcik7CiAgICAgICAgYmIu\ncHV0TG9uZyhlbnRyeSk7CiAgICAgICAgYmIucHV0KCgibGVkZ2VyLSIgKyBs\nZWRnZXIgKyAiLSIgKyBlbnRyeSkuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgYmIu\nZmxpcCgpOwogICAgICAgIHJldHVybiBiYjsKICAgIH0KCiAgICBAVGVzdAog\nICAgcHVibGljIHZvaWQgdGVzdE1pc3NpbmdMb2dJZCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIEZpbGUgdG1wRGlyID0gRmlsZS5jcmVhdGVUZW1w\nRmlsZSgiZW50cnlMb2dUZXN0IiwgIi5kaXIiKTsKICAgICAgICB0bXBEaXIu\nZGVsZXRlKCk7CiAgICAgICAgdG1wRGlyLm1rZGlyKCk7CiAgICAgICAgRmls\nZSBjdXJEaXIgPSBCb29raWUuZ2V0Q3VycmVudERpcmVjdG9yeSh0bXBEaXIp\nOwogICAgICAgIEJvb2tpZS5jaGVja0RpcmVjdG9yeVN0cnVjdHVyZShjdXJE\naXIpOwoKICAgICAgICBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcg\nU2VydmVyQ29uZmlndXJhdGlvbigpOwogICAgICAgIGNvbmYuc2V0TGVkZ2Vy\nRGlyTmFtZXMobmV3IFN0cmluZ1tdIHt0bXBEaXIudG9TdHJpbmcoKX0pOwog\nICAgICAgIC8vIGNyZWF0ZSBzb21lIGVudHJpZXMKICAgICAgICBpbnQgbnVt\nTG9ncyA9IDM7CiAgICAgICAgaW50IG51bUVudHJpZXMgPSAxMDsKICAgICAg\nICBsb25nW11bXSBwb3NpdGlvbnMgPSBuZXcgbG9uZ1syKm51bUxvZ3NdW107\nCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bUxvZ3M7IGkrKykgewogICAg\nICAgICAgICBwb3NpdGlvbnNbaV0gPSBuZXcgbG9uZ1tudW1FbnRyaWVzXTsK\nCiAgICAgICAgICAgIEVudHJ5TG9nZ2VyIGxvZ2dlciA9IG5ldyBFbnRyeUxv\nZ2dlcihjb25mKTsKICAgICAgICAgICAgZm9yIChpbnQgaj0wOyBqPG51bUVu\ndHJpZXM7IGorKykgewogICAgICAgICAgICAgICAgcG9zaXRpb25zW2ldW2pd\nID0gbG9nZ2VyLmFkZEVudHJ5KGksIGdlbmVyYXRlRW50cnkoaSwgaikpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGxvZ2dlci5mbHVzaCgpOwogICAg\nICAgIH0KICAgICAgICAvLyBkZWxldGUgbGFzdCBsb2cgaWQKICAgICAgICBG\naWxlIGxhc3RMb2dJZCA9IG5ldyBGaWxlKGN1ckRpciwgImxhc3RJZCIpOwog\nICAgICAgIGxhc3RMb2dJZC5kZWxldGUoKTsKCiAgICAgICAgLy8gd3JpdGUg\nYW5vdGhlciBlbnRyaWVzCiAgICAgICAgZm9yIChpbnQgaT1udW1Mb2dzOyBp\nPDIqbnVtTG9nczsgaSsrKSB7CiAgICAgICAgICAgIHBvc2l0aW9uc1tpXSA9\nIG5ldyBsb25nW251bUVudHJpZXNdOwoKICAgICAgICAgICAgRW50cnlMb2dn\nZXIgbG9nZ2VyID0gbmV3IEVudHJ5TG9nZ2VyKGNvbmYpOwogICAgICAgICAg\nICBmb3IgKGludCBqPTA7IGo8bnVtRW50cmllczsgaisrKSB7CiAgICAgICAg\nICAgICAgICBwb3NpdGlvbnNbaV1bal0gPSBsb2dnZXIuYWRkRW50cnkoaSwg\nZ2VuZXJhdGVFbnRyeShpLCBqKSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgbG9nZ2VyLmZsdXNoKCk7CiAgICAgICAgfQoKICAgICAgICBFbnRyeUxv\nZ2dlciBuZXdMb2dnZXIgPSBuZXcgRW50cnlMb2dnZXIoY29uZik7CiAgICAg\nICAgZm9yIChpbnQgaT0wOyBpPCgyKm51bUxvZ3MrMSk7IGkrKykgewogICAg\nICAgICAgICBGaWxlIGxvZ0ZpbGUgPSBuZXcgRmlsZShjdXJEaXIsIExvbmcu\ndG9IZXhTdHJpbmcoaSkgKyAiLmxvZyIpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKGxvZ0ZpbGUuZXhpc3RzKCkpOwogICAgICAgIH0KICAgICAgICBmb3Ig\nKGludCBpPTA7IGk8MipudW1Mb2dzOyBpKyspIHsKICAgICAgICAgICAgZm9y\nIChpbnQgaj0wOyBqPG51bUVudHJpZXM7IGorKykgewogICAgICAgICAgICAg\nICAgU3RyaW5nIGV4cGVjdGVkVmFsdWUgPSAibGVkZ2VyLSIgKyBpICsgIi0i\nICsgajsKICAgICAgICAgICAgICAgIGJ5dGVbXSB2YWx1ZSA9IG5ld0xvZ2dl\nci5yZWFkRW50cnkoaSwgaiwgcG9zaXRpb25zW2ldW2pdKTsKICAgICAgICAg\nICAgICAgIEJ5dGVCdWZmZXIgYnVmID0gQnl0ZUJ1ZmZlci53cmFwKHZhbHVl\nKTsKICAgICAgICAgICAgICAgIGxvbmcgbGVkZ2VySWQgPSBidWYuZ2V0TG9u\nZygpOwogICAgICAgICAgICAgICAgbG9uZyBlbnRyeUlkID0gYnVmLmdldExv\nbmcoKTsKICAgICAgICAgICAgICAgIGJ5dGVbXSBkYXRhID0gbmV3IGJ5dGVb\nYnVmLnJlbWFpbmluZygpXTsKICAgICAgICAgICAgICAgIGJ1Zi5nZXQoZGF0\nYSk7CiAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMoaSwgbGVkZ2VySWQp\nOwogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGosIGVudHJ5SWQpOwog\nICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGV4cGVjdGVkVmFsdWUsIG5l\ndyBTdHJpbmcoZGF0YSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIEBUZXN0CiAgICAvKiogVGVzdCB0aGF0IEVudHJ5TG9nZ2VyIFNo\nb3VsZCBmYWlsIHdpdGggRk5GRSwgaWYgZW50cnkgbG9nZ2VyIGRpcmVjdG9y\naWVzIGRvZXMgbm90IGV4aXN0Ki8KICAgIHB1YmxpYyB2b2lkIHRlc3RFbnRy\neUxvZ2dlclNob3VsZFRocm93Rk5GRUlmRGlyZWN0b3JpZXNEb2VzTm90RXhp\nc3QoKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBG\naWxlIHRtcERpciA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoImJrVGVzdCIsICIu\nZGlyIik7CiAgICAgICAgdG1wRGlyLmRlbGV0ZSgpOwogICAgICAgIFNlcnZl\nckNvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9u\nKCk7CiAgICAgICAgY29uZi5zZXRMZWRnZXJEaXJOYW1lcyhuZXcgU3RyaW5n\nW10geyB0bXBEaXIudG9TdHJpbmcoKSB9KTsKICAgICAgICBFbnRyeUxvZ2dl\nciBlbnRyeUxvZ2dlciA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgZW50cnlMb2dnZXIgPSBuZXcgRW50cnlMb2dnZXIoY29uZik7CiAgICAg\nICAgICAgIGZhaWwoIkV4cGVjdGluZyBGaWxlTm90Rm91bmRFeGNlcHRpb24i\nKTsKICAgICAgICB9IGNhdGNoIChGaWxlTm90Rm91bmRFeGNlcHRpb24gZSkg\newogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkVudHJ5IGxvZyBkaXJlY3Rv\ncnkgZG9lcyBub3QgZXhpc3QiLCBlCiAgICAgICAgICAgICAgICAgICAgLmdl\ndExvY2FsaXplZE1lc3NhZ2UoKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgaWYgKGVudHJ5TG9nZ2VyICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgIGVudHJ5TG9nZ2VyLnNodXRkb3duKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgQEFmdGVyCiAgICBwdWJsaWMgdm9pZCB0\nZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAgfQoKfQo=\n","encoding":"base64"}

