{"sha":"3720bb886dbff1baf433ab8ff0320dde7c182dc1","node_id":"MDQ6QmxvYjE1NzU5NTY6MzcyMGJiODg2ZGJmZjFiYWY0MzNhYjhmZjAzMjBkZGU3YzE4MmRjMQ==","size":6878,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/3720bb886dbff1baf433ab8ff0320dde7c182dc1","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5ib29raWU7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuYm9va2llLkJvb2tp\nZS5Ob0xlZGdlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jb25mLlNlcnZlckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLmJvb2trZWVwZXIubWV0YS5MZWRnZXJNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLm1ldGEuTGVkZ2VyTWFuYWdlckZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuaW8uRmlsZVV0aWxzOwppbXBv\ncnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsK\naW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBq\ndW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgovKioKICogTGVkZ2VyQ2FjaGUg\ncmVsYXRlZCB0ZXN0IGNhc2VzCiAqLwpwdWJsaWMgY2xhc3MgTGVkZ2VyQ2Fj\naGVUZXN0IGV4dGVuZHMgVGVzdENhc2UgewogICAgc3RhdGljIExvZ2dlciBM\nT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMZWRnZXJDYWNoZVRlc3Qu\nY2xhc3MpOwoKICAgIExlZGdlck1hbmFnZXIgbGVkZ2VyTWFuYWdlcjsKICAg\nIExlZGdlckNhY2hlIGxlZGdlckNhY2hlOwogICAgU2VydmVyQ29uZmlndXJh\ndGlvbiBjb25mOwogICAgRmlsZSB0eG5EaXIsIGxlZGdlckRpcjsKCiAgICBA\nT3ZlcnJpZGUKICAgIEBCZWZvcmUKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHhuRGlyID0gRmlsZS5jcmVh\ndGVUZW1wRmlsZSgibGVkZ2VyY2FjaGUiLCAidHhuIik7CiAgICAgICAgdHhu\nRGlyLmRlbGV0ZSgpOwogICAgICAgIHR4bkRpci5ta2RpcigpOwogICAgICAg\nIGxlZGdlckRpciA9IEZpbGUuY3JlYXRlVGVtcEZpbGUoImxlZGdlcmNhY2hl\nIiwgImxlZGdlciIpOwogICAgICAgIGxlZGdlckRpci5kZWxldGUoKTsKICAg\nICAgICBsZWRnZXJEaXIubWtkaXIoKTsKICAgICAgICAvLyBjcmVhdGUgY3Vy\ncmVudCBkaXIKICAgICAgICBuZXcgRmlsZShsZWRnZXJEaXIsIEJvb2tpZS5D\nVVJSRU5UX0RJUikubWtkaXIoKTsKCiAgICAgICAgY29uZiA9IG5ldyBTZXJ2\nZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAgY29uZi5zZXRaa1NlcnZlcnMo\nbnVsbCk7CiAgICAgICAgY29uZi5zZXRKb3VybmFsRGlyTmFtZSh0eG5EaXIu\nZ2V0UGF0aCgpKTsKICAgICAgICBjb25mLnNldExlZGdlckRpck5hbWVzKG5l\ndyBTdHJpbmdbXSB7IGxlZGdlckRpci5nZXRQYXRoKCkgfSk7CgogICAgICAg\nIGxlZGdlck1hbmFnZXIgPSBMZWRnZXJNYW5hZ2VyRmFjdG9yeS5uZXdMZWRn\nZXJNYW5hZ2VyKGNvbmYsIG51bGwpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgQEFmdGVyCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bigpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGxlZGdlck1hbmFnZXIuY2xvc2UoKTsKICAg\nICAgICBGaWxlVXRpbHMuZGVsZXRlRGlyZWN0b3J5KHR4bkRpcik7CiAgICAg\nICAgRmlsZVV0aWxzLmRlbGV0ZURpcmVjdG9yeShsZWRnZXJEaXIpOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBuZXdMZWRnZXJDYWNoZSgpIHsKICAgICAg\nICBsZWRnZXJDYWNoZSA9IG5ldyBMZWRnZXJDYWNoZUltcGwoY29uZiwgbGVk\nZ2VyTWFuYWdlcik7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lk\nIHRlc3RBZGRFbnRyeUV4Y2VwdGlvbigpIHsKICAgICAgICAvLyBzZXQgcGFn\nZSBsaW1pdGF0aW9uCiAgICAgICAgY29uZi5zZXRQYWdlTGltaXQoMTApOwog\nICAgICAgIC8vIGNyZWF0ZSBhIGxlZGdlciBjYWNoZQogICAgICAgIG5ld0xl\nZGdlckNhY2hlKCk7CiAgICAgICAgLyoKICAgICAgICAgKiBQb3B1bGF0ZSBs\nZWRnZXIgY2FjaGUuCiAgICAgICAgICovCiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgYnl0ZVtdIG1hc3RlcktleSA9ICJibGFoIi5nZXRCeXRlcygpOwog\nICAgICAgICAgICBmb3IoIGludCBpID0gMDsgaSA8IDEwMDsgaSsrKSB7CiAg\nICAgICAgICAgICAgICBsZWRnZXJDYWNoZS5zZXRNYXN0ZXJLZXkoKGxvbmcp\naSwgbWFzdGVyS2V5KTsKICAgICAgICAgICAgICAgIGxlZGdlckNhY2hlLnB1\ndEVudHJ5T2Zmc2V0KGksIDAsIGkqOCk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5l\ncnJvcigiR290IElPRXhjZXB0aW9uLiIsIGUpOwogICAgICAgICAgICBmYWls\nKCJGYWlsZWQgdG8gYWRkIGVudHJ5LiIpOwogICAgICAgIH0KICAgIH0KCiAg\nICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdExlZGdlckV2aWN0aW9uKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IG51bUVudHJpZXMgPSAx\nMDsKICAgICAgICAvLyBsaW1pdCBvcGVuIGZpbGVzICYgcGFnZXMKICAgICAg\nICBjb25mLnNldE9wZW5GaWxlTGltaXQoMSkuc2V0UGFnZUxpbWl0KDIpCiAg\nICAgICAgICAgIC5zZXRQYWdlU2l6ZSg4ICogbnVtRW50cmllcyk7CiAgICAg\nICAgLy8gY3JlYXRlIGxlZGdlciBjYWNoZQogICAgICAgIG5ld0xlZGdlckNh\nY2hlKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaW50IG51bUxlZGdl\ncnMgPSAzOwogICAgICAgICAgICBieXRlW10gbWFzdGVyS2V5ID0gImJsYWgi\nLmdldEJ5dGVzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGk9MTsgaTw9bnVt\nTGVkZ2VyczsgaSsrKSB7CiAgICAgICAgICAgICAgICBsZWRnZXJDYWNoZS5z\nZXRNYXN0ZXJLZXkoKGxvbmcpaSwgbWFzdGVyS2V5KTsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGo9MDsgajxudW1FbnRyaWVzOyBqKyspIHsKICAgICAg\nICAgICAgICAgICAgICBsZWRnZXJDYWNoZS5wdXRFbnRyeU9mZnNldChpLCBq\nLCBpICogbnVtRW50cmllcyArIGopOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgTE9HLmVycm9yKCJHb3QgRXhjZXB0aW9uLiIsIGUpOwogICAg\nICAgICAgICBmYWlsKCJGYWlsZWQgdG8gYWRkIGVudHJ5LiIpOwogICAgICAg\nIH0KICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdERlbGV0\nZUxlZGdlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBudW1F\nbnRyaWVzID0gMTA7CiAgICAgICAgLy8gbGltaXQgb3BlbiBmaWxlcyAmIHBh\nZ2VzCiAgICAgICAgY29uZi5zZXRPcGVuRmlsZUxpbWl0KDk5OSkuc2V0UGFn\nZUxpbWl0KDIpCiAgICAgICAgICAgIC5zZXRQYWdlU2l6ZSg4ICogbnVtRW50\ncmllcyk7CiAgICAgICAgLy8gY3JlYXRlIGxlZGdlciBjYWNoZQogICAgICAg\nIG5ld0xlZGdlckNhY2hlKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naW50IG51bUxlZGdlcnMgPSAyOwogICAgICAgICAgICBieXRlW10gbWFzdGVy\nS2V5ID0gImJsYWgiLmdldEJ5dGVzKCk7CiAgICAgICAgICAgIGZvciAoaW50\nIGk9MTsgaTw9bnVtTGVkZ2VyczsgaSsrKSB7CiAgICAgICAgICAgICAgICBs\nZWRnZXJDYWNoZS5zZXRNYXN0ZXJLZXkoKGxvbmcpaSwgbWFzdGVyS2V5KTsK\nICAgICAgICAgICAgICAgIGZvciAoaW50IGo9MDsgajxudW1FbnRyaWVzOyBq\nKyspIHsKICAgICAgICAgICAgICAgICAgICBsZWRnZXJDYWNoZS5wdXRFbnRy\neU9mZnNldChpLCBqLCBpKm51bUVudHJpZXMgKyBqKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBsZWRnZXIgY2Fj\naGUgaXMgZXhoYXVzdGVkCiAgICAgICAgICAgIC8vIGRlbGV0ZSBsZWRnZXJz\nCiAgICAgICAgICAgIGZvciAoaW50IGk9MTsgaTw9bnVtTGVkZ2VyczsgaSsr\nKSB7CiAgICAgICAgICAgICAgICBsZWRnZXJDYWNoZS5kZWxldGVMZWRnZXIo\nKGxvbmcpaSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gY3JlYXRl\nIG51bSBsZWRnZXJzIHRvIGFkZCBlbnRyaWVzCiAgICAgICAgICAgIGZvciAo\naW50IGk9bnVtTGVkZ2VycysxOyBpPD0yKm51bUxlZGdlcnM7IGkrKykgewog\nICAgICAgICAgICAgICAgbGVkZ2VyQ2FjaGUuc2V0TWFzdGVyS2V5KChsb25n\nKWksIG1hc3RlcktleSk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBqPTA7\nIGo8bnVtRW50cmllczsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgbGVk\nZ2VyQ2FjaGUucHV0RW50cnlPZmZzZXQoaSwgaiwgaSpudW1FbnRyaWVzICsg\naik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuZXJyb3Io\nIkdvdCBFeGNlcHRpb24uIiwgZSk7CiAgICAgICAgICAgIGZhaWwoIkZhaWxl\nZCB0byBhZGQgZW50cnkuIik7CiAgICAgICAgfQogICAgfQoKICAgIEBUZXN0\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0UGFnZUV2aWN0aW9uKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgaW50IG51bUxlZGdlcnMgPSAxMDsKICAgICAg\nICBieXRlW10gbWFzdGVyS2V5ID0gImJsYWgiLmdldEJ5dGVzKCk7CiAgICAg\nICAgLy8gbGltaXQgcGFnZSBjb3VudAogICAgICAgIGNvbmYuc2V0T3BlbkZp\nbGVMaW1pdCg5OTk5OTkpLnNldFBhZ2VMaW1pdCgzKTsKICAgICAgICAvLyBj\ncmVhdGUgbGVkZ2VyIGNhY2hlCiAgICAgICAgbmV3TGVkZ2VyQ2FjaGUoKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBjcmVhdGUgc2VydmVyYWwg\nbGVkZ2VycwogICAgICAgICAgICBmb3IgKGludCBpPTE7IGk8PW51bUxlZGdl\ncnM7IGkrKykgewogICAgICAgICAgICAgICAgbGVkZ2VyQ2FjaGUuc2V0TWFz\ndGVyS2V5KChsb25nKWksIG1hc3RlcktleSk7CiAgICAgICAgICAgICAgICBs\nZWRnZXJDYWNoZS5wdXRFbnRyeU9mZnNldChpLCAwLCBpKjgpOwogICAgICAg\nICAgICAgICAgbGVkZ2VyQ2FjaGUucHV0RW50cnlPZmZzZXQoaSwgMSwgaSo4\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gZmx1c2ggYWxsIGZp\ncnN0IHRvIGNsZWFuIHByZXZpb3VzIGRpcnR5IGxlZGdlcnMKICAgICAgICAg\nICAgbGVkZ2VyQ2FjaGUuZmx1c2hMZWRnZXIodHJ1ZSk7CiAgICAgICAgICAg\nIC8vIGZsdXNoIGFsbCAKICAgICAgICAgICAgbGVkZ2VyQ2FjaGUuZmx1c2hM\nZWRnZXIodHJ1ZSk7CgogICAgICAgICAgICAvLyBkZWxldGUgc2VydmVyYWwg\nbGVkZ2VycwogICAgICAgICAgICBmb3IgKGludCBpPTE7IGk8PW51bUxlZGdl\ncnMvMjsgaSsrKSB7CiAgICAgICAgICAgICAgICBsZWRnZXJDYWNoZS5kZWxl\ndGVMZWRnZXIoaSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGJv\nb2tpZSByZXN0YXJ0cwogICAgICAgICAgICBuZXdMZWRnZXJDYWNoZSgpOwoK\nICAgICAgICAgICAgLy8gc2ltdWxhdGUgcmVwbGF5aW5nIGpvdXJuYWxzIHRv\nIGFkZCBlbnRyaWVzIGFnYWluCiAgICAgICAgICAgIGZvciAoaW50IGk9MTsg\naTw9bnVtTGVkZ2VyczsgaSsrKSB7CiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIGxlZGdlckNhY2hlLnB1dEVudHJ5T2Zmc2V0\nKGksIDEsIGkqOCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChOb0xlZGdl\nckV4Y2VwdGlvbiBuc2xlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGk8\nPW51bUxlZGdlcnMvMikgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBp\ndCBpcyBvawogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIExPRy5lcnJvcigiRXJyb3IgcHV0IGVudHJ5IG9m\nZnNldCA6ICIsIG5zbGUpOwogICAgICAgICAgICAgICAgICAgICAgICBmYWls\nKCJTaG91bGQgbm90IHJlYWNoIGhlcmUuIik7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgTE9HLmVycm9y\nKCJHb3QgRXhjZXB0aW9uLiIsIGUpOwogICAgICAgICAgICBmYWlsKCJGYWls\nZWQgdG8gYWRkIGVudHJ5LiIpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

