{"sha":"3d03cd38dea1e919cc6732de55418d9727ad60db","node_id":"MDQ6QmxvYjE1NzU5NTY6M2QwM2NkMzhkZWExZTkxOWNjNjczMmRlNTU0MThkOTcyN2FkNjBkYg==","size":4803,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/3d03cd38dea1e919cc6732de55418d9727ad60db","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50OwoKLyoKKgoq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2Ug\nYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKKiBkaXN0cmlidXRl\nZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbgoq\nIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNl\nbnNlcyB0aGlzIGZpbGUKKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNl\nbnNlLCBWZXJzaW9uIDIuMCAodGhlCiogIkxpY2Vuc2UiKTsgeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQoqIHdpdGgg\ndGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJs\nZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiogc29mdHdhcmUgZGlz\ndHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24g\nYW4KKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09O\nRElUSU9OUyBPRiBBTlkKKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBs\naWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKKiBzcGVjaWZpYyBsYW5n\ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zCiog\ndW5kZXIgdGhlIExpY2Vuc2UuCioKKi8KCmltcG9ydCBqYXZhLnV0aWwuRW51\nbWVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3VudERv\nd25MYXRjaDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LlRpbWVVbml0\nOwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jbGllbnQuQXN5bmND\nYWxsYmFjay5SZWFkQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0LkJvb2tLZWVwZXJDbHVzdGVyVGVz\ndENhc2U7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdC5Cb29r\naWVGYWlsdXJlVGVzdDsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBvcnQg\nb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0\nb3J5OwoKcHVibGljIGNsYXNzIEJvb2tpZVRocm90dGxlVGVzdCBleHRlbmRz\nIEJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2V7CgogICAgcHJpdmF0ZSBzdGF0\naWMgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKEJvb2tp\nZUZhaWx1cmVUZXN0LmNsYXNzKTsKICAgIHByaXZhdGUgRGlnZXN0VHlwZSBk\naWdlc3RUeXBlOwogICAgcHJpdmF0ZSBMZWRnZXJIYW5kbGUgbGg7CiAgICBw\ncml2YXRlIHN0YXRpYyBDb3VudERvd25MYXRjaCBjb3VudERvd25MYXRjaDsK\nICAgIHByaXZhdGUgaW50IHRocm90dGxlID0gNTsKICAgIHByaXZhdGUgaW50\nIFRJTUVfT1VUID0gMzA7CgogICAgLy8gQ29uc3RydWN0b3IKICAgIHB1Ymxp\nYyBCb29raWVUaHJvdHRsZVRlc3QoKSB7CiAgICAgICAgc3VwZXIoNCk7CiAg\nICAgICAgdGhpcy5kaWdlc3RUeXBlID0gRGlnZXN0VHlwZS5DUkMzMjsKICAg\nIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdFZlcmlmeVBlcm1p\ndFJlbGFzZUluUmVhZEZhaWx1cmUoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBiYXNlQ2xpZW50Q29uZi5zZXRUaHJvdHRsZVZhbHVlKG51bUJvb2tp\nZXMpOwogICAgICAgIGludCBudW1FbnRyaWVzID0gdGhyb3R0bGUgKiAyOwog\nICAgICAgIFN5c3RlbS5zZXRQcm9wZXJ0eSgidGhyb3R0bGUiLCBTdHJpbmcu\ndmFsdWVPZih0aHJvdHRsZSkpOwoKICAgICAgICBsaCA9IGJrYy5jcmVhdGVM\nZWRnZXIobnVtQm9va2llcywgMSwgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMo\nKSk7CiAgICAgICAgLy8gQWRkIGxlZGdlciBlbnRyaWVzLgogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbnVtRW50cmllczsgaSsrKSB7CiAgICAgICAg\nICAgIGxoLmFkZEVudHJ5KCgiTGVkZ2VySWQ6ICIgKyBsaC5nZXRJZCgpICsg\nIiwgRW50cnlJZDogIiArIChpKSkKICAgICAgICAgICAgICAgICAgICAuZ2V0\nQnl0ZXMoKSk7CiAgICAgICAgfQogICAgICAgIExPRy5pbmZvKCJGaW5pc2hl\nZCB3cml0aW5nIGFsbCBsZWRnZXIgZW50cmllcyBzbyBzaHV0ZG93biBhbGwg\ndGhlIGJvb2tpZXMgIiArCiAgICAgICAgICAgICAgICAidG8gdmVyaWZ5IHRo\nZSByZWFkIHBlcm1pdHMuIik7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbnVtQm9va2llczsgaSsrKSB7CiAgICAgICAgICAgIGJzLmdldChpKS5z\naHV0ZG93bigpOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgbGgucmVhZEVudHJpZXMoMCwgdGhyb3R0bGUtMSk7CiAgICAgICAgfSBj\nYXRjaCAoQktFeGNlcHRpb24gZSkgewogICAgICAgICAgICBMT0cuaW5mbygg\nIkV4Y2VwdGlvbiB3aGVuIHJlYWRpbmcgdGhlIGVudHJpZXMsIHNpbmNlIGFs\nbCBib29raWVzIGFyZSBzdG9wcGVkIiwgZSk7CiAgICAgICAgfQogICAgICAg\nIExPRy5kZWJ1ZygiKioqIFJFQUQgQ09NUExFVEUgKioqIik7CiAgICAgICAg\nLy8gZ3JhY2UgcGVyaW9kLCBqdXN0IHRvIGF2b2lkIHJhbmRvbW5lc3MKICAg\nICAgICBUaHJlYWQuc2xlZXAoMjAwMCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJQZXJtaXRzIGlzIG5vdCByZWxlYXNlZCB3aGVuIHJlYWQgaGFzIGZhaWxl\nZCBmcm9tIGFsbCByZXBsaWNhcyIsCiAgICAgICAgICAgICAgICB0aHJvdHRs\nZSwgbGguZ2V0QXZhaWxhYmxlUGVybWl0cygpLmF2YWlsYWJsZVBlcm1pdHMo\nKSk7CiAgICAgICAgbGguY2xvc2UoKTsKICAgIH0KCiAgICBAVGVzdAogICAg\ncHVibGljIHZvaWQgdGVzdFZlcmlmeVBlcm1pdFJlbGFzZUluQXN5bmNSZWFk\nRmFpbHVyZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGJhc2VDbGll\nbnRDb25mLnNldFRocm90dGxlVmFsdWUobnVtQm9va2llcyk7CiAgICAgICAg\nU3lzdGVtLnNldFByb3BlcnR5KCJ0aHJvdHRsZSIsIFN0cmluZy52YWx1ZU9m\nKHRocm90dGxlKSk7CgogICAgICAgIGxoID0gYmtjLmNyZWF0ZUxlZGdlcihu\ndW1Cb29raWVzLCAxLCBkaWdlc3RUeXBlLCAiIgogICAgICAgICAgICAgICAg\nLmdldEJ5dGVzKCkpOwogICAgICAgIC8vIEFkZCBsZWRnZXIgZW50cmllcy4K\nICAgICAgICBpbnQgbnVtRW50cmllcyA9IHRocm90dGxlICogMjsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVudHJpZXM7IGkrKykgewogICAg\nICAgICAgICBsaC5hZGRFbnRyeSgoIkxlZGdlcklkOiAiICsgbGguZ2V0SWQo\nKSArICIsIEVudHJ5SWQ6ICIgKyAoaSkpCiAgICAgICAgICAgICAgICAgICAg\nLmdldEJ5dGVzKCkpOwogICAgICAgIH0KICAgICAgICBMT0cuaW5mbygiRmlu\naXNoZWQgd3JpdGluZyBhbGwgbGVkZ2VyIGVudHJpZXMgc28gc2h1dGRvd24g\nYWxsIHRoZSBib29raWVzICIrCiAgICAgICAgICAgICAgICAidG8gdmVyaWZ5\nIHRoZSByZWFkIHBlcm1pdHMuIik7CgogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbnVtQm9va2llczsgaSsrKSB7CiAgICAgICAgICAgIGJzLmdldChp\nKS5zaHV0ZG93bigpOwogICAgICAgIH0KICAgICAgICBCb29raWVSZWFkQ2Fs\nbGJhY2sgYm9va2llUmVhZENhbGxiYWNrID0gbmV3IEJvb2tpZVJlYWRDYWxs\nYmFjaygpOwogICAgICAgIGNvdW50RG93bkxhdGNoID0gbmV3IENvdW50RG93\nbkxhdGNoKHRocm90dGxlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBs\naC5hc3luY1JlYWRFbnRyaWVzKDAsIHRocm90dGxlLTEsIGJvb2tpZVJlYWRD\nYWxsYmFjaywgbnVsbCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgTE9HLmluZm8oICJFeGNlcHRpb24gd2hlbiByZWFk\naW5nIHRoZSBlbnRyaWVzLCBzaW5jZSBhbGwgYm9va2llcyBhcmUgc3RvcHBl\nZCIsIGUpOwogICAgICAgIH0KICAgICAgICBjb3VudERvd25MYXRjaC5hd2Fp\ndChUSU1FX09VVCwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAgICAgTE9HLmRl\nYnVnKCIqKiogUkVBRCBDT01QTEVURSAqKioiKTsKICAgICAgICAvLyBncmFj\nZSBwZXJpb2QsIGp1c3QgdG8gYXZvaWQgcmFuZG9tbmVzcwogICAgICAgIFRo\ncmVhZC5zbGVlcCgyMDAwKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlBlcm1p\ndHMgaXMgbm90IHJlbGVhc2VkIHdoZW4gcmVhZCBoYXMgZmFpbGVkIGZyb20g\nYWxsIHJlcGxpY2FzIiwKICAgICAgICAgICAgICAgIHRocm90dGxlLCBsaC5n\nZXRBdmFpbGFibGVQZXJtaXRzKCkuYXZhaWxhYmxlUGVybWl0cygpKTsKICAg\nICAgICBsaC5jbG9zZSgpOwogICAgfQoKICAgIHN0YXRpYyBjbGFzcyBCb29r\naWVSZWFkQ2FsbGJhY2sgaW1wbGVtZW50cyBSZWFkQ2FsbGJhY2sKICAgIHsK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCByZWFkQ29t\ncGxldGUoaW50IHJjLCBMZWRnZXJIYW5kbGUgbGgsCiAgICAgICAgICAgICAg\nICBFbnVtZXJhdGlvbjxMZWRnZXJFbnRyeT4gc2VxLCBPYmplY3QgY3R4KSB7\nCiAgICAgICAgICAgIGFzc2VydFRydWUoIkV4cGVjdGVkIE5vdCBPSywgc2lu\nY2UgYWxsIGJvb2tpZXMgYXJlIHN0b3BwZWQiLCByYyAhPSBCS0V4Y2VwdGlv\nbi5Db2RlLk9LKTsKICAgICAgICAgICAgY291bnREb3duTGF0Y2guY291bnRE\nb3duKCk7CiAgICAgICAgfSAgICAgICAgCiAgICB9Cn0K\n","encoding":"base64"}

