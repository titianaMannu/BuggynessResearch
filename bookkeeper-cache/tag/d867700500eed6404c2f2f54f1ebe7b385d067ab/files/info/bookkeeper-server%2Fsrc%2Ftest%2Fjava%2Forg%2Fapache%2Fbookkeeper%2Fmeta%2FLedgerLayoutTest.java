{"sha":"4784854e8765a5fb81d58bc70c5e5156846e57be","node_id":"MDQ6QmxvYjE1NzU5NTY6NDc4NDg1NGU4NzY1YTVmYjgxZDU4YmM3MGM1ZTUxNTY4NDZlNTdiZQ==","size":5238,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/4784854e8765a5fb81d58bc70c5e5156846e57be","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci5tZXRhOwoKaW1w\nb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuUmFu\nZG9tOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CgppbXBvcnQg\nb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2Vz\ndFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGll\nbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIu\nWm9vS2VlcGVyOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuQ3JlYXRl\nTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0RlZnMuSWRz\nOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnRlc3QuQm9va0tlZXBl\nckNsdXN0ZXJUZXN0Q2FzZTsKaW1wb3J0IG9yZy5qdW5pdC5BZnRlcjsKaW1w\nb3J0IG9yZy5qdW5pdC5CZWZvcmU7CmltcG9ydCBvcmcuanVuaXQuVGVzdDsK\naW1wb3J0IG9yZy5qdW5pdC5Bc3NlcnQuKjsKCnB1YmxpYyBjbGFzcyBMZWRn\nZXJMYXlvdXRUZXN0IGV4dGVuZHMgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2Fz\nZSB7CgogICAgcHVibGljIExlZGdlckxheW91dFRlc3QoKSB7CiAgICAgICAg\nc3VwZXIoMCk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRl\nc3RMZWRnZXJMYXlvdXQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBD\nbGllbnRDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgQ2xpZW50Q29uZmlndXJh\ndGlvbigpOwogICAgICAgIGNvbmYuc2V0TGVkZ2VyTWFuYWdlclR5cGUoSGll\ncmFyY2hpY2FsTGVkZ2VyTWFuYWdlci5OQU1FKTsKICAgICAgICBTdHJpbmcg\nbGVkZ2VyUm9vdFBhdGggPSAiL3Rlc3RMZWRnZXJMYXlvdXQiOwoKICAgICAg\nICB6a2MuY3JlYXRlKGxlZGdlclJvb3RQYXRoLCBuZXcgYnl0ZVswXSwgCiAg\nICAgICAgICAgICAgICAgICBJZHMuT1BFTl9BQ0xfVU5TQUZFLCBDcmVhdGVN\nb2RlLlBFUlNJU1RFTlQpOwoKICAgICAgICBMZWRnZXJMYXlvdXQgbGF5b3V0\nID0gTGVkZ2VyTGF5b3V0LnJlYWRMYXlvdXQoemtjLCBsZWRnZXJSb290UGF0\naCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiTGF5b3V0IHNob3VsZCBiZSBudWxs\nIiwgbGF5b3V0ID09IG51bGwpOwoKICAgICAgICBTdHJpbmcgdGVzdE5hbWUg\nPSAiZm9vYmFyIjsKICAgICAgICBpbnQgdGVzdFZlcnNpb24gPSAweGRlYWRi\nZWVmOwogICAgICAgIC8vIHVzZSBsYXlvdXQgZGVmaW5lZCBpbiBjb25maWd1\ncmF0aW9uIGFsc28gY3JlYXRlIGl0IGluIHpvb2tlZXBlcgogICAgICAgIExl\nZGdlckxheW91dCBsYXlvdXQyID0gbmV3IExlZGdlckxheW91dCh0ZXN0TmFt\nZSwgdGVzdFZlcnNpb24pOwogICAgICAgIGxheW91dDIuc3RvcmUoemtjLCBs\nZWRnZXJSb290UGF0aCk7CgogICAgICAgIGxheW91dCA9IExlZGdlckxheW91\ndC5yZWFkTGF5b3V0KHprYywgbGVkZ2VyUm9vdFBhdGgpOwogICAgICAgIGFz\nc2VydEVxdWFscyh0ZXN0TmFtZSwgbGF5b3V0LmdldE1hbmFnZXJUeXBlKCkp\nOwogICAgICAgIGFzc2VydEVxdWFscyh0ZXN0VmVyc2lvbiwgbGF5b3V0Lmdl\ndE1hbmFnZXJWZXJzaW9uKCkpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB3\ncml0ZUxlZGdlckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIFN0cmluZyBsZWRnZXJzUm9vdFBhdGgsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbWFuYWdlclR5cGUsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgbWFuYWdlclZlcnNp\nb24sIGludCBsYXlvdXRWZXJzaW9uKQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIExlZGdlckxheW91dCBsYXlvdXQgPSBuZXcgTGVkZ2Vy\nTGF5b3V0KG1hbmFnZXJUeXBlLCBtYW5hZ2VyVmVyc2lvbik7CgogICAgICAg\nIEZpZWxkIGYgPSBMZWRnZXJMYXlvdXQuY2xhc3MuZ2V0RGVjbGFyZWRGaWVs\nZCgibGF5b3V0Rm9ybWF0VmVyc2lvbiIpOwogICAgICAgIGYuc2V0QWNjZXNz\naWJsZSh0cnVlKTsKICAgICAgICBmLnNldChsYXlvdXQsIGxheW91dFZlcnNp\nb24pOwoKICAgICAgICBsYXlvdXQuc3RvcmUoemtjLCBsZWRnZXJzUm9vdFBh\ndGgpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0QmFk\nVmVyc2lvbkxlZGdlckxheW91dCgpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBDbGllbnRDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgLy8gd3JpdGUgYmFkIHZlcnNpb24gbGVk\nZ2VyIGxheW91dAogICAgICAgIHdyaXRlTGVkZ2VyTGF5b3V0KGNvbmYuZ2V0\nWmtMZWRnZXJzUm9vdFBhdGgoKSwgRmxhdExlZGdlck1hbmFnZXIuTkFNRSwK\nICAgICAgICAgICAgICAgIEZsYXRMZWRnZXJNYW5hZ2VyLkNVUl9WRVJTSU9O\nLCBMZWRnZXJMYXlvdXQuTEFZT1VUX0ZPUk1BVF9WRVJTSU9OICsgMSk7CiAg\nICAgICAgCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGVkZ2VyTGF5b3V0\nLnJlYWRMYXlvdXQoemtjLCBjb25mLmdldFprTGVkZ2Vyc1Jvb3RQYXRoKCkp\nOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSEiKTsK\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpZSkgewogICAgICAgICAg\nICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlvbiIsIGllLmdldE1lc3Nh\nZ2UoKS5jb250YWlucygidmVyc2lvbiBub3QgY29tcGF0aWJsZSIpKTsKICAg\nICAgICB9CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RB\nYnNlbnRMZWRnZXJNYW5hZ2VyTGF5b3V0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgQ2xpZW50Q29uZmlndXJhdGlvbiBjb25mID0gbmV3IENsaWVu\ndENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBTdHJpbmcgbGVkZ2Vyc0xheW91\ndCA9IGNvbmYuZ2V0WmtMZWRnZXJzUm9vdFBhdGgoKSArICIvIiArIExlZGdl\nckxheW91dC5MQVlPVVRfWk5PREU7CiAgICAgICAgLy8gd3JpdGUgYmFkIGZv\ncm1hdCBsZWRnZXIgbGF5b3V0CiAgICAgICAgU3RyaW5nQnVpbGRlciBzYiA9\nIG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgc2IuYXBwZW5kKExlZGdl\nckxheW91dC5MQVlPVVRfRk9STUFUX1ZFUlNJT04pLmFwcGVuZCgiXG4iKTsK\nICAgICAgICB6a2MuY3JlYXRlKGxlZGdlcnNMYXlvdXQsIHNiLnRvU3RyaW5n\nKCkuZ2V0Qnl0ZXMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgSWRzLk9QRU5fQUNMX1VOU0FGRSwgQ3JlYXRlTW9kZS5QRVJTSVNURU5U\nKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGVkZ2VyTGF5b3V0LnJl\nYWRMYXlvdXQoemtjLCBjb25mLmdldFprTGVkZ2Vyc1Jvb3RQYXRoKCkpOwog\nICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSEiKTsKICAg\nICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICBh\nc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlvbiIsIGllLmdldE1lc3NhZ2Uo\nKS5jb250YWlucygidmVyc2lvbiBhYnNlbnQgZnJvbSIpKTsKICAgICAgICB9\nCiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RCYXNlTGVk\nZ2VyTWFuYWdlckxheW91dCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIENsaWVudENvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBDbGllbnRDb25maWd1\ncmF0aW9uKCk7CiAgICAgICAgU3RyaW5nIHJvb3RQYXRoID0gY29uZi5nZXRa\na0xlZGdlcnNSb290UGF0aCgpOwogICAgICAgIFN0cmluZyBsZWRnZXJzTGF5\nb3V0ID0gcm9vdFBhdGggKyAiLyIgKyBMZWRnZXJMYXlvdXQuTEFZT1VUX1pO\nT0RFOwogICAgICAgIC8vIHdyaXRlIGJhZCBmb3JtYXQgbGVkZ2VyIGxheW91\ndAogICAgICAgIFN0cmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRl\ncigpOwogICAgICAgIHNiLmFwcGVuZChMZWRnZXJMYXlvdXQuTEFZT1VUX0ZP\nUk1BVF9WRVJTSU9OKS5hcHBlbmQoIlxuIikKICAgICAgICAgIC5hcHBlbmQo\nRmxhdExlZGdlck1hbmFnZXIuTkFNRSk7CiAgICAgICAgemtjLmNyZWF0ZShs\nZWRnZXJzTGF5b3V0LCBzYi50b1N0cmluZygpLmdldEJ5dGVzKCksCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIElkcy5PUEVOX0FDTF9VTlNB\nRkUsIENyZWF0ZU1vZGUuUEVSU0lTVEVOVCk7CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIExlZGdlckxheW91dC5yZWFkTGF5b3V0KHprYywgcm9vdFBh\ndGgpOwogICAgICAgICAgICBmYWlsKCJTaG91bGRuJ3QgcmVhY2ggaGVyZSEi\nKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpZSkgewogICAgICAg\nICAgICBhc3NlcnRUcnVlKCJJbnZhbGlkIGV4Y2VwdGlvbiIsIGllLmdldE1l\nc3NhZ2UoKS5jb250YWlucygiSW52YWxpZCBMZWRnZXIgTWFuYWdlciIpKTsK\nICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

