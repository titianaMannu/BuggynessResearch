{"sha":"a81067de7047fce9a51f459121b3c23a51e4dd7a","node_id":"MDQ6QmxvYjE1NzU5NTY6YTgxMDY3ZGU3MDQ3ZmNlOWE1MWY0NTkxMjFiM2MyM2E1MWU0ZGQ3YQ==","size":10286,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a81067de7047fce9a51f459121b3c23a51e4dd7a","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLkZpbGU7\nCmltcG9ydCBqYXZhLm5ldC5JbmV0QWRkcmVzczsKaW1wb3J0IGphdmEubmV0\nLkluZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZExp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nYm9va2tlZXBlci5jbGllbnQuQm9va0tlZXBlclRlc3RDbGllbnQ7CmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRDb25maWd1cmF0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVy\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5w\ncm90by5Cb29raWVTZXJ2ZXI7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVw\nZXIuYm9va2llLkJvb2tpZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5pby5GaWxlVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5LZWVwZXJFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLnpvb2tl\nZXBlci5ab29LZWVwZXI7CmltcG9ydCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9y\ndCBvcmcuanVuaXQuQmVmb3JlOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7\nCmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBqdW5p\ndC5mcmFtZXdvcmsuVGVzdENhc2U7CgovKioKICogQSBjbGFzcyBydW5zIHNl\ndmVyYWwgYm9va2llIHNlcnZlcnMgZm9yIHRlc3RpbmcuCiAqLwpwdWJsaWMg\nYWJzdHJhY3QgY2xhc3MgQm9va0tlZXBlckNsdXN0ZXJUZXN0Q2FzZSBleHRl\nbmRzIFRlc3RDYXNlIHsKCiAgICBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9\nIExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKEJvb2tLZWVwZXJDbHVzdGVyVGVz\ndENhc2UuY2xhc3MpOwoKICAgIC8vIFpvb0tlZXBlciByZWxhdGVkIHZhcmlh\nYmxlcwogICAgcHJvdGVjdGVkIFpvb0tlZXBlclV0aWwgemtVdGlsID0gbmV3\nIFpvb0tlZXBlclV0aWwoKTsKICAgIHByb3RlY3RlZCBab29LZWVwZXIgemtj\nOwoKICAgIC8vIEJvb2tLZWVwZXIgcmVsYXRlZCB2YXJpYWJsZXMKICAgIHBy\nb3RlY3RlZCBMaXN0PEZpbGU+IHRtcERpcnMgPSBuZXcgTGlua2VkTGlzdDxG\naWxlPigpOwogICAgcHJvdGVjdGVkIExpc3Q8Qm9va2llU2VydmVyPiBicyA9\nIG5ldyBMaW5rZWRMaXN0PEJvb2tpZVNlcnZlcj4oKTsKICAgIHByb3RlY3Rl\nZCBMaXN0PFNlcnZlckNvbmZpZ3VyYXRpb24+IGJzQ29uZnMgPSBuZXcgTGlu\na2VkTGlzdDxTZXJ2ZXJDb25maWd1cmF0aW9uPigpOwogICAgcHJvdGVjdGVk\nIEludGVnZXIgaW5pdGlhbFBvcnQgPSA1MDAwOwogICAgcHJpdmF0ZSBJbnRl\nZ2VyIG5leHRQb3J0ID0gaW5pdGlhbFBvcnQ7CiAgICBwcm90ZWN0ZWQgaW50\nIG51bUJvb2tpZXM7CiAgICBwcm90ZWN0ZWQgQm9va0tlZXBlclRlc3RDbGll\nbnQgYmtjOwoKICAgIHByb3RlY3RlZCBTZXJ2ZXJDb25maWd1cmF0aW9uIGJh\nc2VDb25mID0gbmV3IFNlcnZlckNvbmZpZ3VyYXRpb24oKTsKICAgIHByb3Rl\nY3RlZCBDbGllbnRDb25maWd1cmF0aW9uIGJhc2VDbGllbnRDb25mID0gbmV3\nIENsaWVudENvbmZpZ3VyYXRpb24oKTsKCiAgICBwdWJsaWMgQm9va0tlZXBl\nckNsdXN0ZXJUZXN0Q2FzZShpbnQgbnVtQm9va2llcykgewogICAgICAgIHRo\naXMubnVtQm9va2llcyA9IG51bUJvb2tpZXM7CiAgICB9CgogICAgQEJlZm9y\nZQogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIHN0\nYXJ0IHpvb2tlZXBlciBzZXJ2aWNlCiAgICAgICAgICAgIHN0YXJ0WktDbHVz\ndGVyKCk7CiAgICAgICAgICAgIC8vIHN0YXJ0IGJvb2trZWVwZXIgc2Vydmlj\nZQogICAgICAgICAgICBzdGFydEJLQ2x1c3RlcigpOwogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIExPRy5lcnJvcigiRXJy\nb3Igc2V0dGluZyB1cCIsIGUpOwogICAgICAgICAgICB0aHJvdyBlOwogICAg\nICAgIH0KICAgIH0KCiAgICBAQWZ0ZXIKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBMT0cuaW5mbygiVGVhckRvd24iKTsKICAgICAgICAvLyBzdG9wIGJvb2tr\nZWVwZXIgc2VydmljZQogICAgICAgIHN0b3BCS0NsdXN0ZXIoKTsKICAgICAg\nICAvLyBzdG9wIHpvb2tlZXBlciBzZXJ2aWNlCiAgICAgICAgc3RvcFpLQ2x1\nc3RlcigpOwogICAgfQoKICAgIC8qKgogICAgICogU3RhcnQgem9va2VlcGVy\nIGNsdXN0ZXIKICAgICAqCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAg\nICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydFpLQ2x1c3RlcigpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIHprVXRpbC5zdGFydFNlcnZlcigpOwog\nICAgICAgIHprYyA9IHprVXRpbC5nZXRab29LZWVwZXJDbGllbnQoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFN0b3Agem9va2VlcGVyIGNsdXN0ZXIKICAg\nICAqCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBwcm90\nZWN0ZWQgdm9pZCBzdG9wWktDbHVzdGVyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgemtVdGlsLmtpbGxTZXJ2ZXIoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFN0YXJ0IGNsdXN0ZXIKICAgICAqCiAgICAgKiBAdGhyb3dzIEV4\nY2VwdGlvbgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydEJLQ2x1\nc3RlcigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGJhc2VDbGllbnRD\nb25mLnNldFprU2VydmVycyh6a1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0\ncmluZygpKTsKICAgICAgICBpZiAobnVtQm9va2llcyA+IDApIHsKICAgICAg\nICAgICAgYmtjID0gbmV3IEJvb2tLZWVwZXJUZXN0Q2xpZW50KGJhc2VDbGll\nbnRDb25mKTsKICAgICAgICB9CgogICAgICAgIC8vIENyZWF0ZSBCb29raWUg\nU2VydmVycyAoQjEsIEIyLCBCMykKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IG51bUJvb2tpZXM7IGkrKykgewogICAgICAgICAgICBzdGFydE5ld0Jv\nb2tpZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN0b3Ag\nY2x1c3RlcgogICAgICoKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0b3BCS0NsdXN0ZXIoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYmtjICE9IG51bGwpIHsKICAgICAg\nICAgICAgYmtjLmNsb3NlKCk7OwogICAgICAgIH0KCiAgICAgICAgZm9yIChC\nb29raWVTZXJ2ZXIgc2VydmVyIDogYnMpIHsKICAgICAgICAgICAgc2VydmVy\nLnNodXRkb3duKCk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKEZpbGUgZiA6\nIHRtcERpcnMpIHsKICAgICAgICAgICAgRmlsZVV0aWxzLmRlbGV0ZURpcmVj\ndG9yeShmKTsKICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIFNlcnZl\nckNvbmZpZ3VyYXRpb24gbmV3U2VydmVyQ29uZmlndXJhdGlvbihpbnQgcG9y\ndCwgU3RyaW5nIHprU2VydmVycywgRmlsZSBqb3VybmFsRGlyLCBGaWxlW10g\nbGVkZ2VyRGlycykgewogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY29u\nZiA9IG5ldyBTZXJ2ZXJDb25maWd1cmF0aW9uKGJhc2VDb25mKTsKICAgICAg\nICBjb25mLnNldEJvb2tpZVBvcnQocG9ydCk7CiAgICAgICAgY29uZi5zZXRa\na1NlcnZlcnMoemtTZXJ2ZXJzKTsKICAgICAgICBjb25mLnNldEpvdXJuYWxE\naXJOYW1lKGpvdXJuYWxEaXIuZ2V0UGF0aCgpKTsKICAgICAgICBTdHJpbmdb\nXSBsZWRnZXJEaXJOYW1lcyA9IG5ldyBTdHJpbmdbbGVkZ2VyRGlycy5sZW5n\ndGhdOwogICAgICAgIGZvciAoaW50IGk9MDsgaTxsZWRnZXJEaXJzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGxlZGdlckRpck5hbWVzW2ldID0gbGVk\nZ2VyRGlyc1tpXS5nZXRQYXRoKCk7CiAgICAgICAgfQogICAgICAgIGNvbmYu\nc2V0TGVkZ2VyRGlyTmFtZXMobGVkZ2VyRGlyTmFtZXMpOwogICAgICAgIHJl\ndHVybiBjb25mOwogICAgfQoKICAgIC8qKgogICAgICogS2lsbCBhIGJvb2tp\nZSBieSBpdHMgc29ja2V0IGFkZHJlc3MKICAgICAqCiAgICAgKiBAcGFyYW0g\nYWRkcgogICAgICogICAgICAgICAgU29ja2V0IEFkZHJlc3MKICAgICAqIEBy\nZXR1cm4gdGhlIGNvbmZpZ3VyYXRpb24gb2Yga2lsbGVkIGJvb2tpZQogICAg\nICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICovCiAgICBw\ndWJsaWMgU2VydmVyQ29uZmlndXJhdGlvbiBraWxsQm9va2llKEluZXRTb2Nr\nZXRBZGRyZXNzIGFkZHIpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCiAgICAgICAgQm9va2llU2VydmVyIHRvUmVtb3ZlID0gbnVsbDsKICAgICAg\nICBpbnQgdG9SZW1vdmVJbmRleCA9IDA7CiAgICAgICAgZm9yIChCb29raWVT\nZXJ2ZXIgc2VydmVyIDogYnMpIHsKICAgICAgICAgICAgaWYgKHNlcnZlci5n\nZXRMb2NhbEFkZHJlc3MoKS5lcXVhbHMoYWRkcikpIHsKICAgICAgICAgICAg\nICAgIHNlcnZlci5zaHV0ZG93bigpOwogICAgICAgICAgICAgICAgdG9SZW1v\ndmUgPSBzZXJ2ZXI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgICAgICArK3RvUmVtb3ZlSW5kZXg7CiAgICAgICAgfQog\nICAgICAgIGlmICh0b1JlbW92ZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGJz\nLnJlbW92ZSh0b1JlbW92ZSk7CiAgICAgICAgICAgIHJldHVybiBic0NvbmZz\nLnJlbW92ZSh0b1JlbW92ZUluZGV4KTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBLaWxsIGEgYm9va2ll\nIGJ5IGluZGV4CiAgICAgKgogICAgICogQHBhcmFtIGluZGV4CiAgICAgKiAg\nICAgICAgICBCb29raWUgSW5kZXgKICAgICAqIEByZXR1cm4gdGhlIGNvbmZp\nZ3VyYXRpb24gb2Yga2lsbGVkIGJvb2tpZQogICAgICogQHRocm93cyBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRocm93cyBJT0V4Y2VwdGlvbgog\nICAgICovCiAgICBwdWJsaWMgU2VydmVyQ29uZmlndXJhdGlvbiBraWxsQm9v\na2llKGludCBpbmRleCkgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uLCBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGluZGV4ID49IGJzLnNpemUoKSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgSU9FeGNlcHRpb24oIkJvb2tpZSBk\nb2VzIG5vdCBleGlzdCIpOwogICAgICAgIH0KICAgICAgICBCb29raWVTZXJ2\nZXIgc2VydmVyID0gYnMuZ2V0KGluZGV4KTsKICAgICAgICBzZXJ2ZXIuc2h1\ndGRvd24oKTsKICAgICAgICBicy5yZW1vdmUoc2VydmVyKTsKICAgICAgICBy\nZXR1cm4gYnNDb25mcy5yZW1vdmUoaW5kZXgpOwogICAgfQoKICAgIC8qKgog\nICAgICogU2xlZXAgYSBib29raWUKICAgICAqCiAgICAgKiBAcGFyYW0gYWRk\ncgogICAgICogICAgICAgICAgU29ja2V0IEFkZHJlc3MKICAgICAqIEBwYXJh\nbSBzZWNvbmRzCiAgICAgKiAgICAgICAgICBTbGVlcCBzZWNvbmRzCiAgICAg\nKiBAcGFyYW0gbAogICAgICogICAgICAgICAgQ291bnQgRG93biBMYXRjaAog\nICAgICogQHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbgogICAgICogQHRo\ncm93cyBJT0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzbGVl\ncEJvb2tpZShJbmV0U29ja2V0QWRkcmVzcyBhZGRyLCBmaW5hbCBpbnQgc2Vj\nb25kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsIENvdW50\nRG93bkxhdGNoIGwpCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4\nY2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAgICAgIGZpbmFsIFN0cmluZyBu\nYW1lID0gIkJvb2tpZUpvdXJuYWwtIiArIGFkZHIuZ2V0UG9ydCgpOwogICAg\nICAgIFRocmVhZFtdIGFsbHRocmVhZHMgPSBuZXcgVGhyZWFkW1RocmVhZC5h\nY3RpdmVDb3VudCgpXTsKICAgICAgICBUaHJlYWQuZW51bWVyYXRlKGFsbHRo\ncmVhZHMpOwogICAgICAgIGZvciAoZmluYWwgVGhyZWFkIHQgOiBhbGx0aHJl\nYWRzKSB7CiAgICAgICAgICAgIGlmICh0LmdldE5hbWUoKS5lcXVhbHMobmFt\nZSkpIHsKICAgICAgICAgICAgICAgIFRocmVhZCBzbGVlcGVyID0gbmV3IFRo\ncmVhZCgpIHsKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB0LnN1c3BlbmQoKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGwuY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBUaHJlYWQuc2xlZXAoc2Vjb25kcyoxMDAwKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHQucmVzdW1lKCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkVycm9yIHN1c3BlbmRp\nbmcgdGhyZWFkIiwgZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAg\nICAgICAgICAgc2xlZXBlci5zdGFydCgpOwogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRocm93IG5l\ndyBJT0V4Y2VwdGlvbigiQm9va2llIHRocmVhZCBub3QgZm91bmQiKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlc3RhcnQgYm9va2llIHNlcnZlcnMKICAg\nICAqCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAg\nKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIEtlZXBlckV4\nY2VwdGlvbgogICAgICogQHRocm93cyBCb29raWVFeGNlcHRpb24KICAgICAq\nLwogICAgcHVibGljIHZvaWQgcmVzdGFydEJvb2tpZXMoKQogICAgICAgICAg\nICB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24sIElPRXhjZXB0aW9uLCBL\nZWVwZXJFeGNlcHRpb24sIEJvb2tpZUV4Y2VwdGlvbiB7CiAgICAgICAgcmVz\ndGFydEJvb2tpZXMobnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXN0\nYXJ0IGJvb2tpZSBzZXJ2ZXJzIHVzaW5nIG5ldyBjb25maWd1cmF0aW9uIHNl\ndHRpbmdzCiAgICAgKgogICAgICogQHBhcmFtIG5ld0NvbmYKICAgICAqICAg\nICAgICAgIE5ldyBDb25maWd1cmF0aW9uIFNldHRpbmdzCiAgICAgKiBAdGhy\nb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIElPRXhj\nZXB0aW9uCiAgICAgKiBAdGhyb3dzIEtlZXBlckV4Y2VwdGlvbgogICAgICog\nQHRocm93cyBCb29raWVFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIHZv\naWQgcmVzdGFydEJvb2tpZXMoU2VydmVyQ29uZmlndXJhdGlvbiBuZXdDb25m\nKQogICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiwgSU9FeGNl\ncHRpb24sIEtlZXBlckV4Y2VwdGlvbiwgQm9va2llRXhjZXB0aW9uIHsKICAg\nICAgICAvLyBzaHV0IGRvd24gYm9va2llIHNlcnZlcgogICAgICAgIGZvciAo\nQm9va2llU2VydmVyIHNlcnZlciA6IGJzKSB7CiAgICAgICAgICAgIHNlcnZl\nci5zaHV0ZG93bigpOwogICAgICAgIH0KICAgICAgICBicy5jbGVhcigpOwog\nICAgICAgIFRocmVhZC5zbGVlcCgxMDAwKTsKICAgICAgICAvLyByZXN0YXJ0\nIHRoZW0gdG8gZW5zdXJlIHdlIGNhbid0CiAgICAgICAgaW50IGogPSAwOwog\nICAgICAgIGZvciAoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mIDogYnNDb25m\ncykgewogICAgICAgICAgICBpZiAobnVsbCAhPSBuZXdDb25mKSB7CiAgICAg\nICAgICAgICAgICBjb25mLmxvYWRDb25mKG5ld0NvbmYpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGJzLmFkZChzdGFydEJvb2tpZShjb25mKSk7CiAg\nICAgICAgICAgIGorKzsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBIZWxwZXIgbWV0aG9kIHRvIHN0YXJ0dXAgYSBuZXcgYm9va2llIHNlcnZl\nciB3aXRoIHRoZSBpbmRpY2F0ZWQgcG9ydAogICAgICogbnVtYmVyCiAgICAg\nKgogICAgICogQHBhcmFtIHBvcnQKICAgICAqICAgICAgICAgICAgUG9ydCB0\nbyBzdGFydCB0aGUgbmV3IGJvb2tpZSBzZXJ2ZXIgb24KICAgICAqIEB0aHJv\nd3MgSU9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGludCBzdGFydE5l\nd0Jvb2tpZSgpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50\nZXJydXB0ZWRFeGNlcHRpb24sIEtlZXBlckV4Y2VwdGlvbiwgQm9va2llRXhj\nZXB0aW9uIHsKICAgICAgICBGaWxlIGYgPSBGaWxlLmNyZWF0ZVRlbXBGaWxl\nKCJib29raWUiLCAidGVzdCIpOwogICAgICAgIHRtcERpcnMuYWRkKGYpOwog\nICAgICAgIGYuZGVsZXRlKCk7CiAgICAgICAgZi5ta2RpcigpOwoKICAgICAg\nICBpbnQgcG9ydCA9IG5leHRQb3J0Kys7CiAgICAgICAgU2VydmVyQ29uZmln\ndXJhdGlvbiBjb25mID0gbmV3U2VydmVyQ29uZmlndXJhdGlvbihwb3J0LCB6\na1V0aWwuZ2V0Wm9vS2VlcGVyQ29ubmVjdFN0cmluZygpLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZiwgbmV3IEZpbGVbXSB7IGYgfSk7CiAgICAgICAgYnNDb25mcy5hZGQo\nY29uZik7CiAgICAgICAgYnMuYWRkKHN0YXJ0Qm9va2llKGNvbmYpKTsKCiAg\nICAgICAgcmV0dXJuIHBvcnQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBIZWxw\nZXIgbWV0aG9kIHRvIHN0YXJ0dXAgYSBib29raWUgc2VydmVyIHVzaW5nIGEg\nY29uZmlndXJhdGlvbiBvYmplY3QKICAgICAqCiAgICAgKiBAcGFyYW0gY29u\nZgogICAgICogICAgICAgICAgICBTZXJ2ZXIgQ29uZmlndXJhdGlvbiBPYmpl\nY3QKICAgICAqCiAgICAgKi8KICAgIHByb3RlY3RlZCBCb29raWVTZXJ2ZXIg\nc3RhcnRCb29raWUoU2VydmVyQ29uZmlndXJhdGlvbiBjb25mKQogICAgICAg\nICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9u\nLCBLZWVwZXJFeGNlcHRpb24sIEJvb2tpZUV4Y2VwdGlvbiB7CiAgICAgICAg\nQm9va2llU2VydmVyIHNlcnZlciA9IG5ldyBCb29raWVTZXJ2ZXIoY29uZik7\nCiAgICAgICAgc2VydmVyLnN0YXJ0KCk7CgogICAgICAgIGludCBwb3J0ID0g\nY29uZi5nZXRCb29raWVQb3J0KCk7CiAgICAgICAgd2hpbGUoYmtjLmdldFpr\nSGFuZGxlKCkuZXhpc3RzKCIvbGVkZ2Vycy9hdmFpbGFibGUvIiArIEluZXRB\nZGRyZXNzLmdldExvY2FsSG9zdCgpLmdldEhvc3RBZGRyZXNzKCkgKyAiOiIg\nKyBwb3J0LCBmYWxzZSkgPT0gbnVsbCkgewogICAgICAgICAgICBUaHJlYWQu\nc2xlZXAoNTAwKTsKICAgICAgICB9CgogICAgICAgIGJrYy5yZWFkQm9va2ll\nc0Jsb2NraW5nKCk7CiAgICAgICAgTE9HLmluZm8oIk5ldyBib29raWUgb24g\ncG9ydCAiICsgcG9ydCArICIgaGFzIGJlZW4gY3JlYXRlZC4iKTsKCiAgICAg\nICAgcmV0dXJuIHNlcnZlcjsKICAgIH0KfQo=\n","encoding":"base64"}

