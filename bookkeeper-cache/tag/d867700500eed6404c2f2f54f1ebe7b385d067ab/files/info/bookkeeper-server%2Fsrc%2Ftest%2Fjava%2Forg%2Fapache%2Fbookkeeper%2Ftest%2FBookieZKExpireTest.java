{"sha":"de1db36d757bc9910639cbcf92c8eb8a5ec8ae53","node_id":"MDQ6QmxvYjE1NzU5NTY6ZGUxZGIzNmQ3NTdiYzk5MTA2MzljYmNmOTJjOGViOGE1ZWM4YWU1Mw==","size":3396,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/de1db36d757bc9910639cbcf92c8eb8a5ec8ae53","content":"LyoKICoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4KICoK\nICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuYm9va2tlZXBlci50ZXN0OwoKaW1w\nb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwppbXBv\ncnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5BZnRlcjsK\naW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0Lio7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuU2VydmVyQ29uZmlndXJhdGlvbjsK\naW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQganVuaXQuZnJhbWV3\nb3JrLlRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLnBy\nb3RvLkJvb2tpZVNlcnZlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5ib29raWUuQm9va2llOwoKcHVibGljIGNsYXNzIEJvb2tpZVpLRXhwaXJl\nVGVzdCBleHRlbmRzIEJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2UgewoKICAg\nIHB1YmxpYyBCb29raWVaS0V4cGlyZVRlc3QoKSB7CiAgICAgICAgc3VwZXIo\nMCk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RCb29r\naWVTZXJ2ZXJaS0V4cGlyZUJlaGF2aW91cigpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIEJvb2tpZVNlcnZlciBzZXJ2ZXIgPSBudWxsOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIEZpbGUgZiA9IEZpbGUuY3JlYXRlVGVtcEZp\nbGUoImJvb2tpZXNlcnZlciIsICJ0ZXN0Iik7CiAgICAgICAgICAgIGYuZGVs\nZXRlKCk7CiAgICAgICAgICAgIGYubWtkaXIoKTsKCiAgICAgICAgICAgIEhh\nc2hTZXQ8VGhyZWFkPiB0aHJlYWRzZXQgPSBuZXcgSGFzaFNldDxUaHJlYWQ+\nKCk7CiAgICAgICAgICAgIGludCB0aHJlYWRDb3VudCA9IFRocmVhZC5hY3Rp\ndmVDb3VudCgpOwogICAgICAgICAgICBUaHJlYWQgdGhyZWFkc1tdID0gbmV3\nIFRocmVhZFt0aHJlYWRDb3VudCoyXTsKICAgICAgICAgICAgdGhyZWFkQ291\nbnQgPSBUaHJlYWQuZW51bWVyYXRlKHRocmVhZHMpOwogICAgICAgICAgICBm\nb3IoaW50IGkgPSAwOyBpIDwgdGhyZWFkQ291bnQ7IGkrKykgewogICAgICAg\nICAgICAgICAgaWYgKHRocmVhZHNbaV0uZ2V0TmFtZSgpLmluZGV4T2YoIlNl\nbmRUaHJlYWQiKSAhPSAtMSkgewogICAgICAgICAgICAgICAgICAgIHRocmVh\nZHNldC5hZGQodGhyZWFkc1tpXSk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY29u\nZiA9IG5ld1NlcnZlckNvbmZpZ3VyYXRpb24oaW5pdGlhbFBvcnQgKyAxLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHprVXRpbC5nZXRab29LZWVwZXJDb25uZWN0U3Ry\naW5nKCksIGYsIG5ldyBGaWxlW10geyBmIH0pOwogICAgICAgICAgICBzZXJ2\nZXIgPSBuZXcgQm9va2llU2VydmVyKGNvbmYpOwogICAgICAgICAgICBzZXJ2\nZXIuc3RhcnQoKTsKCiAgICAgICAgICAgIFRocmVhZC5zbGVlcCgxMCk7CiAg\nICAgICAgICAgIFRocmVhZCBzZW5kdGhyZWFkID0gbnVsbDsKICAgICAgICAg\nICAgdGhyZWFkQ291bnQgPSBUaHJlYWQuYWN0aXZlQ291bnQoKTsKICAgICAg\nICAgICAgdGhyZWFkcyA9IG5ldyBUaHJlYWRbdGhyZWFkQ291bnQqMl07CiAg\nICAgICAgICAgIHRocmVhZENvdW50ID0gVGhyZWFkLmVudW1lcmF0ZSh0aHJl\nYWRzKTsKICAgICAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IHRocmVhZENv\ndW50OyBpKyspIHsKICAgICAgICAgICAgICAgIGlmICh0aHJlYWRzW2ldLmdl\ndE5hbWUoKS5pbmRleE9mKCJTZW5kVGhyZWFkIikgIT0gLTEKICAgICAgICAg\nICAgICAgICAgICAgICAgJiYgIXRocmVhZHNldC5jb250YWlucyh0aHJlYWRz\nW2ldKSkgewogICAgICAgICAgICAgICAgICAgIHNlbmR0aHJlYWQgPSB0aHJl\nYWRzW2ldOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFzc2VydE5vdE51\nbGwoIlNlbmQgdGhyZWFkIG5vdCBmb3VuZCIsIHNlbmR0aHJlYWQpOwoKICAg\nICAgICAgICAgc2VuZHRocmVhZC5zdXNwZW5kKCk7CiAgICAgICAgICAgIFRo\ncmVhZC5zbGVlcCgyKjEwMDAwKTsKICAgICAgICAgICAgc2VuZHRocmVhZC5y\nZXN1bWUoKTsKCiAgICAgICAgICAgIC8vIGFsbG93IHdhdGNoZXIgdGhyZWFk\nIHRvIHJ1bgogICAgICAgICAgICBUaHJlYWQuc2xlZXAoMzAwMCk7CiAgICAg\nICAgICAgIGFzc2VydEZhbHNlKCJCb29raWUgc2hvdWxkIGhhdmUgc2h1dGRv\nd24gb24gbG9zaW5nIHprIHNlc3Npb24iLCBzZXJ2ZXIuaXNCb29raWVSdW5u\naW5nKCkpOwogICAgICAgICAgICBhc3NlcnRGYWxzZSgiTmlvIFNlcnZlciBz\naG91bGQgaGF2ZSBzaHV0ZG93biBvbiBsb3Npbmcgemsgc2Vzc2lvbiIsIHNl\ncnZlci5pc05pb1NlcnZlclJ1bm5pbmcoKSk7CiAgICAgICAgICAgIGFzc2Vy\ndEZhbHNlKCJCb29raWUgU2VydmVyIHNob3VsZCBoYXZlIHNodXRkb3duIG9u\nIGxvc2luZyB6ayBzZXNzaW9uIiwgc2VydmVyLmlzUnVubmluZygpKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBzZXJ2ZXIuc2h1dGRvd24o\nKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

