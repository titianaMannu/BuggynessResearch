{"sha":"6bbc8e3a3445f822332c5528e7675c7d4c053de2","node_id":"MDQ6QmxvYjE1NzU5NTY6NmJiYzhlM2EzNDQ1ZjgyMjMzMmM1NTI4ZTc2NzVjN2Q0YzA1M2RlMg==","size":5196,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/6bbc8e3a3445f822332c5528e7675c7d4c053de2","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdDsKCi8qCiAqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAqLwoKaW1w\nb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBlci5jb25mLlNlcnZl\nckNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIu\nY2xpZW50LkxlZGdlckVudHJ5OwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2Vl\ncGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJv\nb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXIuRGlnZXN0VHlwZTsKCmltcG9y\ndCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZh\nY3Rvcnk7CgppbXBvcnQgb3JnLmp1bml0LkFzc2VydDsKaW1wb3J0IG9yZy5q\ndW5pdC5UZXN0OwoKLyoqCiAqIFRoaXMgY2xhc3MgdGVzdHMgdGhhdCBpbmRl\neCBjb3JydXB0aW9uIGNhc2VzCiAqLwpwdWJsaWMgY2xhc3MgSW5kZXhDb3Jy\ndXB0aW9uVGVzdCBleHRlbmRzIEJvb2tLZWVwZXJDbHVzdGVyVGVzdENhc2Ug\newogICAgc3RhdGljIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExv\nZ2dlcihJbmRleENvcnJ1cHRpb25UZXN0LmNsYXNzKTsKCiAgICBEaWdlc3RU\neXBlIGRpZ2VzdFR5cGU7CgogICAgaW50IHBhZ2VTaXplID0gMTAyNDsKCiAg\nICBwdWJsaWMgSW5kZXhDb3JydXB0aW9uVGVzdCgpIHsKICAgICAgICBzdXBl\ncigxKTsKICAgICAgICB0aGlzLmRpZ2VzdFR5cGUgPSBEaWdlc3RUeXBlLkNS\nQzMyOwogICAgICAgIGJhc2VDb25mLnNldFBhZ2VTaXplKHBhZ2VTaXplKTsK\nICAgIH0KCiAgICBwcml2YXRlIFRocmVhZCBmaW5kU3luY1RocmVhZCgpIHsK\nICAgICAgICBpbnQgdGhyZWFkQ291bnQgPSBUaHJlYWQuYWN0aXZlQ291bnQo\nKTsKICAgICAgICBUaHJlYWRbXSBhbGx0aHJlYWRzID0gbmV3IFRocmVhZFtU\naHJlYWQuYWN0aXZlQ291bnQoKV07CiAgICAgICAgVGhyZWFkLmVudW1lcmF0\nZShhbGx0aHJlYWRzKTsKICAgICAgICBmb3IgKFRocmVhZCB0IDogYWxsdGhy\nZWFkcykgewogICAgICAgICAgICBpZiAodC5nZXROYW1lKCkuZXF1YWxzKCJT\neW5jVGhyZWFkIikpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0OwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAg\nfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0Tm9TdWNoTGVkZ2Vy\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTE9HLmRlYnVnKCJUZXN0\naW5nIE5vU3VjaExlZGdlciIpOwoKICAgICAgICBUaHJlYWQgc3luY1RocmVh\nZCA9IGZpbmRTeW5jVGhyZWFkKCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgi\nTm90IGZvdW5kIFN5bmNUaHJlYWQuIiwgc3luY1RocmVhZCk7CgogICAgICAg\nIHN5bmNUaHJlYWQuc3VzcGVuZCgpOwogICAgICAgIC8vIENyZWF0ZSBhIGxl\nZGdlcgogICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5jcmVhdGVMZWRn\nZXIoMSwgMSwgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7CgogICAgICAg\nIC8vIENsb3NlIHRoZSBsZWRnZXIgd2hpY2ggY2F1c2UgYSByZWFkRW50cnko\nMCkgY2FsbAogICAgICAgIExlZGdlckhhbmRsZSBuZXdMaCA9IGJrYy5vcGVu\nTGVkZ2VyKGxoLmdldElkKCksIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkp\nOwoKICAgICAgICAvLyBDcmVhdGUgYSBuZXcgbGVkZ2VyIHRvIHdyaXRlIGVu\ndHJpZXMKICAgICAgICBTdHJpbmcgZHVtbXlNc2cgPSAiTm9TdWNoTGVkZ2Vy\nIjsKICAgICAgICBpbnQgbnVtTXNncyA9IDM7CiAgICAgICAgTGVkZ2VySGFu\nZGxlIHdsaCA9IGJrYy5jcmVhdGVMZWRnZXIoMSwgMSwgZGlnZXN0VHlwZSwg\nIiIuZ2V0Qnl0ZXMoKSk7CiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bU1z\nZ3M7IGkrKykgewogICAgICAgICAgICB3bGguYWRkRW50cnkoZHVtbXlNc2cu\nZ2V0Qnl0ZXMoKSk7CiAgICAgICAgfQoKICAgICAgICBzeW5jVGhyZWFkLnJl\nc3VtZSgpOwoKICAgICAgICAvLyB0cmlnZ2VyIHN5bmMgCiAgICAgICAgVGhy\nZWFkLnNsZWVwKDIgKiBiYXNlQ29uZi5nZXRGbHVzaEludGVydmFsKCkpOwoK\nICAgICAgICAvLyByZXN0YXJ0IGJvb2tpZXMKICAgICAgICByZXN0YXJ0Qm9v\na2llcygpOwoKICAgICAgICBFbnVtZXJhdGlvbjxMZWRnZXJFbnRyeT4gc2Vx\nID0gd2xoLnJlYWRFbnRyaWVzKDAsIG51bU1zZ3MgLSAxKTsgCiAgICAgICAg\nYXNzZXJ0VHJ1ZSgiRW51bWVyYXRpb24gb2YgbGVkZ2VyIGVudHJpZXMgaGFz\nIG5vIGVsZW1lbnQiLCBzZXEuaGFzTW9yZUVsZW1lbnRzKCkgPT0gdHJ1ZSk7\nCiAgICAgICAgaW50IGVudHJ5SWQgPSAwOwogICAgICAgIHdoaWxlIChzZXEu\naGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAgTGVkZ2VyRW50cnkg\nZSA9IHNlcS5uZXh0RWxlbWVudCgpOwogICAgICAgICAgICBhc3NlcnRFcXVh\nbHMoZW50cnlJZCwgZS5nZXRFbnRyeUlkKCkpOwoKICAgICAgICAgICAgQXNz\nZXJ0LmFzc2VydEFycmF5RXF1YWxzKGR1bW15TXNnLmdldEJ5dGVzKCksIGUu\nZ2V0RW50cnkoKSk7CiAgICAgICAgICAgICsrZW50cnlJZDsKICAgICAgICB9\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKGVudHJ5SWQsIG51bU1zZ3MpOwogICAg\nfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0RW1wdHlJbmRleFBh\nZ2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBMT0cuZGVidWcoIlRl\nc3RpbmcgRW1wdHlJbmRleFBhZ2UiKTsKCiAgICAgICAgVGhyZWFkIHN5bmNU\naHJlYWQgPSBmaW5kU3luY1RocmVhZCgpOwogICAgICAgIGFzc2VydE5vdE51\nbGwoIk5vdCBmb3VuZCBTeW5jVGhyZWFkLiIsIHN5bmNUaHJlYWQpOwoKICAg\nICAgICBzeW5jVGhyZWFkLnN1c3BlbmQoKTsKCiAgICAgICAgLy8gQ3JlYXRl\nIGEgbGVkZ2VyCiAgICAgICAgTGVkZ2VySGFuZGxlIGxoMSA9IGJrYy5jcmVh\ndGVMZWRnZXIoMSwgMSwgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMoKSk7Cgog\nICAgICAgIFN0cmluZyBkdW1teU1zZyA9ICJOb1N1Y2hMZWRnZXIiOwoKICAg\nICAgICAvLyB3cml0ZSB0d28gcGFnZSBlbnRyaWVzIHRvIGxlZGdlciAyCiAg\nICAgICAgaW50IG51bU1zZ3MgPSAyICogcGFnZVNpemUgLyA4OwogICAgICAg\nIExlZGdlckhhbmRsZSBsaDIgPSBia2MuY3JlYXRlTGVkZ2VyKDEsIDEsIGRp\nZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwogICAgICAgIGZvciAoaW50IGk9\nMDsgaTxudW1Nc2dzOyBpKyspIHsKICAgICAgICAgICAgbGgyLmFkZEVudHJ5\nKGR1bW15TXNnLmdldEJ5dGVzKCkpOwogICAgICAgIH0KCiAgICAgICAgc3lu\nY1RocmVhZC5yZXN1bWUoKTsKCiAgICAgICAgLy8gdHJpZ2dlciBzeW5jCiAg\nICAgICAgVGhyZWFkLnNsZWVwKDIgKiBiYXNlQ29uZi5nZXRGbHVzaEludGVy\ndmFsKCkpOwoKICAgICAgICBzeW5jVGhyZWFkLnN1c3BlbmQoKTsKCiAgICAg\nICAgLy8gQ2xvc2UgbGVkZ2VyIDEgd2hpY2ggY2F1c2UgYSByZWFkRW50cnko\nMCkgY2FsbAogICAgICAgIExlZGdlckhhbmRsZSBuZXdMaDEgPSBia2Mub3Bl\nbkxlZGdlcihsaDEuZ2V0SWQoKSwgZGlnZXN0VHlwZSwgIiIuZ2V0Qnl0ZXMo\nKSk7CgogICAgICAgIC8vIHdyaXRlIGFub3RoZXIgMyBlbnRyaWVzIHRvIGxl\nZGdlciAyCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPDM7IGkrKykgewogICAg\nICAgICAgICBsaDIuYWRkRW50cnkoZHVtbXlNc2cuZ2V0Qnl0ZXMoKSk7CiAg\nICAgICAgfQoKICAgICAgICBzeW5jVGhyZWFkLnJlc3VtZSgpOwoKICAgICAg\nICAvLyB3YWl0IGZvciBzeW5jIGFnYWluCiAgICAgICAgVGhyZWFkLnNsZWVw\nKDIgKiBiYXNlQ29uZi5nZXRGbHVzaEludGVydmFsKCkpOwogICAgCiAgICAg\nICAgLy8gcmVzdGFydCBib29raWVzCiAgICAgICAgcmVzdGFydEJvb2tpZXMo\nKTsKCiAgICAgICAgbnVtTXNncyArPSAzOwogICAgICAgIEVudW1lcmF0aW9u\nPExlZGdlckVudHJ5PiBzZXEgPSBsaDIucmVhZEVudHJpZXMoMCwgbnVtTXNn\ncyAtIDEpOyAKICAgICAgICBhc3NlcnRUcnVlKCJFbnVtZXJhdGlvbiBvZiBs\nZWRnZXIgZW50cmllcyBoYXMgbm8gZWxlbWVudCIsIHNlcS5oYXNNb3JlRWxl\nbWVudHMoKSA9PSB0cnVlKTsKICAgICAgICBpbnQgZW50cnlJZCA9IDA7CiAg\nICAgICAgd2hpbGUgKHNlcS5oYXNNb3JlRWxlbWVudHMoKSkgewogICAgICAg\nICAgICBMZWRnZXJFbnRyeSBlID0gc2VxLm5leHRFbGVtZW50KCk7CiAgICAg\nICAgICAgIGFzc2VydEVxdWFscyhlbnRyeUlkLCBlLmdldEVudHJ5SWQoKSk7\nCgogICAgICAgICAgICBBc3NlcnQuYXNzZXJ0QXJyYXlFcXVhbHMoZHVtbXlN\nc2cuZ2V0Qnl0ZXMoKSwgZS5nZXRFbnRyeSgpKTsKICAgICAgICAgICAgKytl\nbnRyeUlkOwogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVhbHMoZW50cnlJ\nZCwgbnVtTXNncyk7CiAgICB9Cn0K\n","encoding":"base64"}

