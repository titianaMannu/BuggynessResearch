{"sha":"22e494e40acb6e8c628cdfcb4773e62bcfbff3b7","node_id":"MDQ6QmxvYjE1NzU5NTY6MjJlNDk0ZTQwYWNiNmU4YzYyOGNkZmNiNDc3M2U2MmJjZmJmZjNiNw==","size":4582,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/22e494e40acb6e8c628cdfcb4773e62bcfbff3b7","content":"cGFja2FnZSBvcmcuYXBhY2hlLmJvb2trZWVwZXIudGVzdDsKCi8qCiAqCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqCiAqLwoKaW1w\nb3J0IG9yZy5qdW5pdC4qOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVy\nLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9ydCBvcmcuYXBhY2hlLmJvb2tr\nZWVwZXIuY2xpZW50LkJLRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5i\nb29ra2VlcGVyLmNsaWVudC5Cb29rS2VlcGVyLkRpZ2VzdFR5cGU7CmltcG9y\ndCBvcmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZh\nY3Rvcnk7CgovKioKICogVGhpcyB1bml0IHRlc3QgdGVzdHMgbGVkZ2VyIHJl\nY292ZXJ5LgogKgogKi8KCnB1YmxpYyBjbGFzcyBMZWRnZXJSZWNvdmVyeVRl\nc3QgZXh0ZW5kcyBCYXNlVGVzdENhc2UgewogICAgc3RhdGljIExvZ2dlciBM\nT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMZWRnZXJSZWNvdmVyeVRl\nc3QuY2xhc3MpOwoKICAgIERpZ2VzdFR5cGUgZGlnZXN0VHlwZTsKCiAgICBw\ndWJsaWMgTGVkZ2VyUmVjb3ZlcnlUZXN0KERpZ2VzdFR5cGUgZGlnZXN0VHlw\nZSkgewogICAgICAgIHN1cGVyKDMpOwogICAgICAgIHRoaXMuZGlnZXN0VHlw\nZSA9IGRpZ2VzdFR5cGU7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHRlc3RJ\nbnRlcm5hbChpbnQgbnVtRW50cmllcykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgLyoKICAgICAgICAgKiBDcmVhdGUgbGVkZ2VyLgogICAgICAgICAq\nLwogICAgICAgIExlZGdlckhhbmRsZSBiZWZvcmVsaCA9IG51bGw7CiAgICAg\nICAgYmVmb3JlbGggPSBia2MuY3JlYXRlTGVkZ2VyKGRpZ2VzdFR5cGUsICIi\nLmdldEJ5dGVzKCkpOwoKICAgICAgICBTdHJpbmcgdG1wID0gIkJvb2tLZWVw\nZXIgaXMgY29vbCEiOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVt\nRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGJlZm9yZWxoLmFkZEVudHJ5\nKHRtcC5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAgICAgIGxvbmcgbGVu\nZ3RoID0gKGxvbmcpIChudW1FbnRyaWVzICogdG1wLmxlbmd0aCgpKTsKCiAg\nICAgICAgLyoKICAgICAgICAgKiBUcnkgdG8gb3BlbiBsZWRnZXIuCiAgICAg\nICAgICovCiAgICAgICAgTGVkZ2VySGFuZGxlIGFmdGVybGggPSBia2Mub3Bl\nbkxlZGdlcihiZWZvcmVsaC5nZXRJZCgpLCBkaWdlc3RUeXBlLCAiIi5nZXRC\neXRlcygpKTsKCiAgICAgICAgLyoKICAgICAgICAgKiBDaGVjayBpZiBoYXMg\ncmVjb3ZlcmVkIHByb3Blcmx5LgogICAgICAgICAqLwogICAgICAgIGFzc2Vy\ndFRydWUoIkhhcyBub3QgcmVjb3ZlcmVkIGNvcnJlY3RseTogIiArIGFmdGVy\nbGguZ2V0TGFzdEFkZENvbmZpcm1lZCgpLAogICAgICAgICAgICAgICAgICAg\nYWZ0ZXJsaC5nZXRMYXN0QWRkQ29uZmlybWVkKCkgPT0gbnVtRW50cmllcyAt\nIDEpOwogICAgICAgIGFzc2VydFRydWUoIkhhcyBub3Qgc2V0IHRoZSBsZW5n\ndGggY29ycmVjdGx5OiAiICsgYWZ0ZXJsaC5nZXRMZW5ndGgoKSArICIsICIg\nKyBsZW5ndGgsCiAgICAgICAgICAgICAgICAgICBhZnRlcmxoLmdldExlbmd0\naCgpID09IGxlbmd0aCk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2\nb2lkIHRlc3RMZWRnZXJSZWNvdmVyeSgpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHRlc3RJbnRlcm5hbCgxMDApOwoKICAgIH0KCiAgICBAVGVzdAog\nICAgcHVibGljIHZvaWQgdGVzdEVtcHR5TGVkZ2VyUmVjb3ZlcnlPbmUoKSB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0ZXN0SW50ZXJuYWwoMSk7CiAg\nICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RFbXB0eUxlZGdl\nclJlY292ZXJ5KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdGVzdElu\ndGVybmFsKDApOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0\nZXN0TGVkZ2VyUmVjb3ZlcnlXaXRoV3JvbmdQYXNzd29yZCgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIC8vIENyZWF0ZSBhIGxlZGdlcgogICAgICAg\nIGJ5dGVbXSBsZWRnZXJQYXNzd29yZCA9ICJhYWFhIi5nZXRCeXRlcygpOwog\nICAgICAgIExlZGdlckhhbmRsZSBsaCA9IGJrYy5jcmVhdGVMZWRnZXIoZGln\nZXN0VHlwZSwgbGVkZ2VyUGFzc3dvcmQpOwogICAgICAgIC8vIGJrYy5pbml0\nTWVzc2FnZURpZ2VzdCgiU0hBMSIpOwogICAgICAgIGxvbmcgbGVkZ2VySWQg\nPSBsaC5nZXRJZCgpOwogICAgICAgIExPRy5pbmZvKCJMZWRnZXIgSUQ6ICIg\nKyBsaC5nZXRJZCgpKTsKICAgICAgICBTdHJpbmcgdG1wID0gIkJvb2tLZWVw\nZXIgaXMgY29vbCEiOwogICAgICAgIGludCBudW1FbnRyaWVzID0gMzA7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbnRyaWVzOyBpKyspIHsK\nICAgICAgICAgICAgbGguYWRkRW50cnkodG1wLmdldEJ5dGVzKCkpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gVXNpbmcgd3JvbmcgcGFzc3dvcmQKICAgICAg\nICBsZWRnZXJQYXNzd29yZCA9ICJiYmJiIi5nZXRCeXRlcygpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGxoID0gYmtjLm9wZW5MZWRnZXIobGVkZ2Vy\nSWQsIGRpZ2VzdFR5cGUsIGxlZGdlclBhc3N3b3JkKTsKICAgICAgICAgICAg\nZmFpbCgiT3BlbmluZyBsZWRnZXIgd2l0aCB3cm9uZyBwYXNzd29yZCBzaG91\nbGQgZmFpbCIpOwogICAgICAgIH0gY2F0Y2ggKEJLRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgLy8gc2hvdWxkIGZhaWxlZAogICAgICAgIH0KICAgIH0K\nCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdExlZGdlclJlY292ZXJ5\nV2l0aE5vdEVub3VnaEJvb2tpZXMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBpbnQgbnVtRW50cmllcyA9IDM7CgogICAgICAgIC8vIENyZWF0ZSBh\nIGxlZGdlcgogICAgICAgIExlZGdlckhhbmRsZSBiZWZvcmVsaCA9IG51bGw7\nCiAgICAgICAgYmVmb3JlbGggPSBia2MuY3JlYXRlTGVkZ2VyKDMsIDMsIGRp\nZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwoKICAgICAgICBTdHJpbmcgdG1w\nID0gIkJvb2tLZWVwZXIgaXMgY29vbCEiOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgbnVtRW50cmllczsgaSsrKSB7CiAgICAgICAgICAgIGJlZm9y\nZWxoLmFkZEVudHJ5KHRtcC5nZXRCeXRlcygpKTsKICAgICAgICB9CgogICAg\nICAgIC8vIHNodXRkb3duIGZpcnN0IGJvb2tpZSBzZXJ2ZXIKICAgICAgICBi\ncy5nZXQoMCkuc2h1dGRvd24oKTsKICAgICAgICBicy5yZW1vdmUoMCk7Cgog\nICAgICAgIC8qCiAgICAgICAgICogVHJ5IHRvIG9wZW4gbGVkZ2VyLgogICAg\nICAgICAqLwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGJrYy5vcGVuTGVk\nZ2VyKGJlZm9yZWxoLmdldElkKCksIGRpZ2VzdFR5cGUsICIiLmdldEJ5dGVz\nKCkpOwogICAgICAgICAgICBmYWlsKCJzaG91bGQgbm90IHJlYWNoIGhlcmUh\nIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgLy8gc2hvdWxkIHRocm93biByZWNvdmVyeSBleGNlcHRpb24KICAgICAg\nICB9CgogICAgICAgIC8vIHN0YXJ0IGEgbmV3IGJvb2tpZSBzZXJ2ZXIKICAg\nICAgICBzdGFydE5ld0Jvb2tpZSgpOwoKICAgICAgICBMZWRnZXJIYW5kbGUg\nYWZ0ZXJsaCA9IGJrYy5vcGVuTGVkZ2VyKGJlZm9yZWxoLmdldElkKCksIGRp\nZ2VzdFR5cGUsICIiLmdldEJ5dGVzKCkpOwoKICAgICAgICAvKgogICAgICAg\nICAqIENoZWNrIGlmIGhhcyByZWNvdmVyZWQgcHJvcGVybHkuCiAgICAgICAg\nICovCiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bUVudHJpZXMgLSAxLCBhZnRl\ncmxoLmdldExhc3RBZGRDb25maXJtZWQoKSk7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

