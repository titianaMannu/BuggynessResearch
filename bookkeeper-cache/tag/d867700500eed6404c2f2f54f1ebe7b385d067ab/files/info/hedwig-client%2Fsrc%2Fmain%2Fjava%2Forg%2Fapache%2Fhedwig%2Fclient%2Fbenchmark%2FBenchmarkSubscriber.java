{"sha":"73b6478775eb4f0e4512401af53efaa33c504ebe","node_id":"MDQ6QmxvYjE1NzU5NTY6NzNiNjQ3ODc3NWViNGYwZTQ1MTI0MDFhZjUzZWZhYTMzYzUwNGViZQ==","size":5988,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/73b6478775eb4f0e4512401af53efaa33c504ebe","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrOwoKaW1w\nb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNhbGxhYmxlOwoKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFj\ndG9yeTsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuYXBpLk1lc3NhZ2VI\nYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmFwaS5T\ndWJzY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmJl\nbmNobWFyay5CZW5jaG1hcmtVdGlscy5CZW5jaG1hcmtDYWxsYmFjazsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5iZW5jaG1hcmsuQmVuY2ht\nYXJrVXRpbHMuVGhyb3VnaHB1dEFnZ3JlZ2F0b3I7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5jbGllbnQuYmVuY2htYXJrLkJlbmNobWFya1V0aWxzLlRo\ncm91Z2hwdXRMYXRlbmN5QWdncmVnYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5S\nZWdpb25TcGVjaWZpY1NlcUlkOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVh\ndGVPckF0dGFjaDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ2Fs\nbGJhY2s7CgpwdWJsaWMgY2xhc3MgQmVuY2htYXJrU3Vic2NyaWJlciBleHRl\nbmRzIEJlbmNobWFya1dvcmtlciBpbXBsZW1lbnRzIENhbGxhYmxlPFZvaWQ+\nIHsKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2VyID0gTG9nZ2VyRmFj\ndG9yeS5nZXRMb2dnZXIoQmVuY2htYXJrU3Vic2NyaWJlci5jbGFzcyk7CiAg\nICBTdWJzY3JpYmVyIHN1YnNjcmliZXI7CiAgICBCeXRlU3RyaW5nIHN1Yklk\nOwoKCiAgICBwdWJsaWMgQmVuY2htYXJrU3Vic2NyaWJlcihpbnQgbnVtVG9w\naWNzLCBpbnQgbnVtTWVzc2FnZXMsIGludCBudW1SZWdpb25zLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgaW50IHN0YXJ0VG9waWNMYWJlbCwg\naW50IHBhcnRpdGlvbkluZGV4LCBpbnQgbnVtUGFydGl0aW9ucywgU3Vic2Ny\naWJlciBzdWJzY3JpYmVyLCBCeXRlU3RyaW5nIHN1YklkKSB7CiAgICAgICAg\nc3VwZXIobnVtVG9waWNzLCBudW1NZXNzYWdlcywgbnVtUmVnaW9ucywgc3Rh\ncnRUb3BpY0xhYmVsLCBwYXJ0aXRpb25JbmRleCwgbnVtUGFydGl0aW9ucyk7\nCiAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjsKICAgICAg\nICB0aGlzLnN1YklkID0gc3ViSWQ7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nd2FybXVwKGludCBudW1XYXJtdXApIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLyoKICAgICAgICAgKiBtdWx0aXBseWluZyB0aGUg\nbnVtYmVyIG9mIG9wcyBieSBudW1QYXJpdGlvbnMgYmVjYXVzZSB3ZSBlbmQg\ndXAKICAgICAgICAgKiBza2lwcGluZyBtYW55IGJlY2F1c2Ugb2YgdGhlIHBh\ncnRpdGlvbmluZyBsb2dpYwogICAgICAgICAqLwogICAgICAgIG11bHRpU3Vi\nKCJ3YXJtdXAiLCAid2FybXVwIiwgMCwgbnVtV2FybXVwLCBudW1XYXJtdXAg\nKiBudW1QYXJ0aXRpb25zKTsKICAgIH0KCiAgICBwdWJsaWMgVm9pZCBjYWxs\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CgogICAgICAgIGZpbmFsIFRocm91Z2hw\ndXRBZ2dyZWdhdG9yIGFnZyA9IG5ldyBUaHJvdWdocHV0QWdncmVnYXRvcigi\ncmVjdnMiLCBudW1NZXNzYWdlcyk7CiAgICAgICAgYWdnLnN0YXJ0UHJvZ3Jl\nc3MoKTsKCiAgICAgICAgZmluYWwgTWFwPFN0cmluZywgTG9uZz4gbGFzdFNl\ncUlkU2Vlbk1hcCA9IG5ldyBIYXNoTWFwPFN0cmluZywgTG9uZz4oKTsKCiAg\nICAgICAgZm9yIChpbnQgaSA9IHN0YXJ0VG9waWNMYWJlbDsgaSA8IHN0YXJ0\nVG9waWNMYWJlbCArIG51bVRvcGljczsgaSsrKSB7CgogICAgICAgICAgICBp\nZiAoIUhlZHdpZ0JlbmNobWFyay5hbUlSZXNwb25zaWJsZUZvclRvcGljKGks\nIHBhcnRpdGlvbkluZGV4LCBudW1QYXJ0aXRpb25zKSkgewogICAgICAgICAg\nICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZp\nbmFsIFN0cmluZyB0b3BpYyA9IEhlZHdpZ0JlbmNobWFyay5UT1BJQ19QUkVG\nSVggKyBpOwoKICAgICAgICAgICAgc3Vic2NyaWJlci5zdWJzY3JpYmUoQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgodG9waWMpLCBzdWJJZCwgQ3JlYXRlT3JB\ndHRhY2guQ1JFQVRFX09SX0FUVEFDSCk7CiAgICAgICAgICAgIHN1YnNjcmli\nZXIuc3RhcnREZWxpdmVyeShCeXRlU3RyaW5nLmNvcHlGcm9tVXRmOCh0b3Bp\nYyksIHN1YklkLCBuZXcgTWVzc2FnZUhhbmRsZXIoKSB7CgogICAgICAgICAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBk\nZWxpdmVyKEJ5dGVTdHJpbmcgdGhpc1RvcGljLCBCeXRlU3RyaW5nIHN1YnNj\ncmliZXJJZCwgTWVzc2FnZSBtc2csCiAgICAgICAgICAgICAgICBDYWxsYmFj\nazxWb2lkPiBjYWxsYmFjaywgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiR290IG1lc3NhZ2Ug\nZnJvbSBzcmMtcmVnaW9uOiAiICsgbXNnLmdldFNyY1JlZ2lvbigpICsgIiB3\naXRoIHNlcS1pZDogIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyBtc2cuZ2V0TXNnSWQoKSk7CgogICAgICAgICAgICAgICAgICAg\nIFN0cmluZyBtYXBLZXkgPSB0b3BpYyArIG1zZy5nZXRTcmNSZWdpb24oKS50\nb1N0cmluZ1V0ZjgoKTsKICAgICAgICAgICAgICAgICAgICBMb25nIGxhc3RT\nZXFJZFNlZW4gPSBsYXN0U2VxSWRTZWVuTWFwLmdldChtYXBLZXkpOwogICAg\nICAgICAgICAgICAgICAgIGlmIChsYXN0U2VxSWRTZWVuID09IG51bGwpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFNlcUlkU2VlbiA9IChsb25n\nKSAwOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAg\nICAgaWYgKGdldFNyY1NlcUlkKG1zZykgPD0gbGFzdFNlcUlkU2Vlbikgewog\nICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiUmVkZWxpdmVy\neSBvZiBtZXNzYWdlLCBzcmMtcmVnaW9uOiAiICsgbXNnLmdldFNyY1JlZ2lv\nbigpICsgInNlcS1pZDogIgogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICArIG1zZy5nZXRNc2dJZCgpKTsKICAgICAgICAgICAgICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhZ2cuZGluZyhm\nYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAg\nICAgICBjYWxsYmFjay5vcGVyYXRpb25GaW5pc2hlZChjb250ZXh0LCBudWxs\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAg\nfQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiRmluaXNoZWQgc3Vic2Ny\naWJpbmcgdG8gdG9waWNzIGFuZCBub3cgd2FpdGluZyBmb3IgbWVzc2FnZXMg\ndG8gY29tZSBpbi4uLiIpOwogICAgICAgIC8vIFdhaXQgdGlsbCB0aGUgYmVu\nY2htYXJrIHRlc3QgaGFzIGNvbXBsZXRlZAogICAgICAgIGFnZy5xdWV1ZS50\nYWtlKCk7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKGFnZy5zdW1tYXJp\nemUoYWdnLmVhcmxpZXN0LmdldCgpKSk7CiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICB9CgogICAgbG9uZyBnZXRTcmNTZXFJZChNZXNzYWdlIG1zZykgewog\nICAgICAgIGlmIChtc2cuZ2V0TXNnSWQoKS5nZXRSZW1vdGVDb21wb25lbnRz\nQ291bnQoKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBtc2cuZ2V0TXNn\nSWQoKS5nZXRMb2NhbENvbXBvbmVudCgpOwogICAgICAgIH0KCiAgICAgICAg\nZm9yIChSZWdpb25TcGVjaWZpY1NlcUlkIHJzZXFJZCA6IG1zZy5nZXRNc2dJ\nZCgpLmdldFJlbW90ZUNvbXBvbmVudHNMaXN0KCkpIHsKICAgICAgICAgICAg\naWYgKHJzZXFJZC5nZXRSZWdpb24oKS5lcXVhbHMobXNnLmdldFNyY1JlZ2lv\nbigpKSkKICAgICAgICAgICAgICAgIHJldHVybiByc2VxSWQuZ2V0U2VxSWQo\nKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBtc2cuZ2V0TXNnSWQoKS5n\nZXRMb2NhbENvbXBvbmVudCgpOwogICAgfQoKICAgIHZvaWQgbXVsdGlTdWIo\nU3RyaW5nIGxhYmVsLCBTdHJpbmcgdG9waWNQcmVmaXgsIGludCBzdGFydCwg\nZmluYWwgaW50IG5wYXIsIGZpbmFsIGludCBjb3VudCkKICAgICAgICAgICAg\ndGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICBsb25nIHN0\nYXJ0VGltZSA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAg\nIFRocm91Z2hwdXRMYXRlbmN5QWdncmVnYXRvciBhZ2cgPSBuZXcgVGhyb3Vn\naHB1dExhdGVuY3lBZ2dyZWdhdG9yKGxhYmVsLCBjb3VudCAvIG51bVBhcnRp\ndGlvbnMsIG5wYXIpOwogICAgICAgIGFnZy5zdGFydFByb2dyZXNzKCk7Cgog\nICAgICAgIGludCBlbmQgPSBzdGFydCArIGNvdW50OwogICAgICAgIGZvciAo\naW50IGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CiAgICAgICAgICAgIGlm\nICghSGVkd2lnQmVuY2htYXJrLmFtSVJlc3BvbnNpYmxlRm9yVG9waWMoaSwg\ncGFydGl0aW9uSW5kZXgsIG51bVBhcnRpdGlvbnMpKSB7CiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzdWJz\nY3JpYmVyLmFzeW5jU3Vic2NyaWJlKEJ5dGVTdHJpbmcuY29weUZyb21VdGY4\nKHRvcGljUHJlZml4ICsgaSksIHN1YklkLCBDcmVhdGVPckF0dGFjaC5DUkVB\nVEVfT1JfQVRUQUNILAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIG5ldyBCZW5jaG1hcmtDYWxsYmFjayhhZ2cpLCBudWxsKTsKICAg\nICAgICB9CiAgICAgICAgLy8gV2FpdCB0aWxsIHRoZSBiZW5jaG1hcmsgdGVz\ndCBoYXMgY29tcGxldGVkCiAgICAgICAgYWdnLnRwQWdnLnF1ZXVlLnRha2Uo\nKTsKICAgICAgICBpZiAoY291bnQgPiAxKQogICAgICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oYWdnLnN1bW1hcml6ZShzdGFydFRpbWUpKTsKICAgIH0K\nCn0K\n","encoding":"base64"}

