{"sha":"8460de00012ed26fadae2210912cea0e9ea2986f","node_id":"MDQ6QmxvYjE1NzU5NTY6ODQ2MGRlMDAwMTJlZDI2ZmFkYWUyMjEwOTEyY2VhMGU5ZWEyOTg2Zg==","size":6855,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/8460de00012ed26fadae2210912cea0e9ea2986f","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuZGF0YTsKCmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5\ndGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5Q\ndWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29s\nLlN1YnNjcmlwdGlvbk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy51dGlsLkNhbGxiYWNrOwoKLyoqCiAqIFdyYXBwZXIgY2xhc3MgdG8gc3Rv\ncmUgYWxsIG9mIHRoZSBkYXRhIHBvaW50cyBuZWVkZWQgdG8gZW5jYXBzdWxh\ndGUgYWxsCiAqIFB1YlN1YiB0eXBlIG9mIHJlcXVlc3Qgb3BlcmF0aW9ucyB0\naGUgY2xpZW50IHdpbGwgZG8uIFRoaXMgaW5jbHVkZXMga25vd2luZwogKiBh\nbGwgb2YgdGhlIGluZm9ybWF0aW9uIG5lZWRlZCBpZiB3ZSBuZWVkIHRvIHJl\nZG8gdGhlIHB1Ymxpc2gvc3Vic2NyaWJlCiAqIHJlcXVlc3QgaW4gY2FzZSBv\nZiBhIHNlcnZlciByZWRpcmVjdC4gVGhpcyB3aWxsIGJlIHVzZWQgZm9yIGFs\nbCBzeW5jL2FzeW5jCiAqIGNhbGxzLCBhbmQgZm9yIGFsbCB0aGUga25vd24g\ndHlwZXMgb2YgcmVxdWVzdCBtZXNzYWdlcyB0byBzZW5kIHRvIHRoZSBzZXJ2\nZXIKICogaHViczogUHVibGlzaCwgU3Vic2NyaWJlLCBVbnN1YnNjcmliZSwg\nYW5kIENvbnN1bWUuCiAqCiAqLwpwdWJsaWMgY2xhc3MgUHViU3ViRGF0YSB7\nCiAgICAvLyBTdGF0aWMgc3RyaW5nIGNvbnN0YW50cwogICAgcHJvdGVjdGVk\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09NTUEgPSAiLCAiOwoKICAgIC8vIE1l\nbWJlciB2YXJpYWJsZXMgbmVlZGVkIGR1cmluZyBvYmplY3QgY29uc3RydWN0\naW9uIHRpbWUuCiAgICBwdWJsaWMgZmluYWwgQnl0ZVN0cmluZyB0b3BpYzsK\nICAgIHB1YmxpYyBmaW5hbCBNZXNzYWdlIG1zZzsKICAgIHB1YmxpYyBmaW5h\nbCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZDsKICAgIC8vIEVudW0gdG8gaW5k\naWNhdGUgd2hhdCB0eXBlIG9mIG9wZXJhdGlvbiB0aGlzIFB1YlN1YiByZXF1\nZXN0IGRhdGEgb2JqZWN0CiAgICAvLyBpcyBmb3IuCiAgICBwdWJsaWMgZmlu\nYWwgT3BlcmF0aW9uVHlwZSBvcGVyYXRpb25UeXBlOwogICAgLy8gT3B0aW9u\ncyBmb3IgdGhlIHN1YnNjcmlwdGlvbgogICAgcHVibGljIGZpbmFsIFN1YnNj\ncmlwdGlvbk9wdGlvbnMgb3B0aW9uczsKICAgIC8vIFRoZXNlIHR3byB2YXJp\nYWJsZXMgYXJlIG5vdCBmaW5hbCBzaW5jZSB3ZSBtaWdodCBvdmVycmlkZSB0\naGVtCiAgICAvLyBpbiB0aGUgY2FzZSBvZiBhIFN1YnNjcmliZSByZWNvbm5l\nY3QuCiAgICBwdWJsaWMgQ2FsbGJhY2s8Vm9pZD4gY2FsbGJhY2s7CiAgICBw\ndWJsaWMgT2JqZWN0IGNvbnRleHQ7CgogICAgLy8gTWVtYmVyIHZhcmlhYmxl\ncyB1c2VkIGFmdGVyIG9iamVjdCBoYXMgYmVlbiBjb25zdHJ1Y3RlZC4KICAg\nIC8vIExpc3Qgb2YgYWxsIHNlcnZlcnMgd2UndmUgc2VudCB0aGUgUHViU3Vi\nUmVxdWVzdCB0byBzdWNjZXNzZnVsbHkuCiAgICAvLyBUaGlzIGlzIHRvIGtl\nZXAgdHJhY2sgb2YgcmVkaXJlY3RlZCBzZXJ2ZXJzIHRoYXQgcmVzcG9uZGVk\nIGJhY2sgdG8gdXMuCiAgICBwdWJsaWMgTGlzdDxCeXRlU3RyaW5nPiB0cmll\nZFNlcnZlcnM7CiAgICAvLyBMaXN0IG9mIGFsbCBzZXJ2ZXJzIHRoYXQgd2Un\ndmUgdHJpZWQgdG8gY29ubmVjdCBvciB3cml0ZSB0byBidXQKICAgIC8vIHdh\ncyB1bnN1Y2Nlc3NmdWwuIFdlJ2xsIHJldHJ5IHNlbmRpbmcgdGhlIFB1YlN1\nYlJlcXVlc3QgYnV0IHdpbGwKICAgIC8vIHF1aXQgaWYgd2UncmUgdHJ5aW5n\nIHRvIGNvbm5lY3Qgb3Igd3JpdGUgdG8gYSBzZXJ2ZXIgdGhhdCB3ZSd2ZQog\nICAgLy8gYXR0ZW1wdGVkIHRvIHByZXZpb3VzbHkuCiAgICBwdWJsaWMgTGlz\ndDxCeXRlU3RyaW5nPiBjb25uZWN0RmFpbGVkU2VydmVyczsKICAgIHB1Ymxp\nYyBMaXN0PEJ5dGVTdHJpbmc+IHdyaXRlRmFpbGVkU2VydmVyczsKICAgIC8v\nIEJvb2xlYW4gdG8gdGhlIGh1YiBzZXJ2ZXIgaW5kaWNhdGluZyBpZiBpdCBz\naG91bGQgY2xhaW0gb3duZXJzaGlwCiAgICAvLyBvZiB0aGUgdG9waWMgdGhl\nIFB1YlN1YlJlcXVlc3QgaXMgZm9yLiBUaGlzIGlzIG1haW5seSB1c2VkIGFm\ndGVyCiAgICAvLyBhIHNlcnZlciByZWRpcmVjdC4gRGVmYXVsdHMgdG8gZmFs\nc2UuCiAgICBwdWJsaWMgYm9vbGVhbiBzaG91bGRDbGFpbSA9IGZhbHNlOwog\nICAgLy8gVHhuSUQgZm9yIHRoZSBQdWJTdWJEYXRhIGlmIGl0IHdhcyBzZW50\nIGFzIGEgUHViU3ViUmVxdWVzdCB0byB0aGUgaHViCiAgICAvLyBzZXJ2ZXIu\nIFRoaXMgaXMgdXNlZCBpbiB0aGUgV3JpdGVDYWxsYmFjayBpbiBjYXNlIG9m\nIGZhaWx1cmUuIFdlIHdhbnQKICAgIC8vIHRvIHJlbW92ZSBpdCBmcm9tIHRo\nZSBSZXNwb25zZUhhbmRsZXIudHhuMlB1YlN1YkRhdGEgbWFwIHNpbmNlIHRo\nZQogICAgLy8gZmFpbGVkIFB1YlN1YlJlcXVlc3Qgd2lsbCBub3QgZ2V0IGFu\nIGFjayByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXIuCiAgICAvLyBUaGlzIGlz\nIHNldCBsYXRlciBpbiB0aGUgUHViU3ViIGZsb3dzIG9ubHkgd2hlbiB3ZSB3\ncml0ZSB0aGUgYWN0dWFsCiAgICAvLyByZXF1ZXN0LiBUaGVyZWZvcmUgaXQg\naXMgbm90IGFuIGFyZ3VtZW50IGluIHRoZSBjb25zdHJ1Y3Rvci4KICAgIHB1\nYmxpYyBsb25nIHR4bklkOwogICAgLy8gVGltZSBpbiBtaWxsaXNlY29uZHMg\ndXNpbmcgdGhlIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpIGNhbGwgd2hl\nbiB0aGUKICAgIC8vIFB1YlN1YlJlcXVlc3Qgd2FzIHdyaXR0ZW4gb24gdGhl\nIG5ldHR5IENoYW5uZWwgdG8gdGhlIHNlcnZlci4KICAgIHB1YmxpYyBsb25n\nIHJlcXVlc3RXcml0ZVRpbWU7CiAgICAvLyBGb3Igc3luY2hyb25vdXMgY2Fs\nbHMsIHRoaXMgdmFyaWFibGUgaXMgdXNlZCB0byBrbm93IHdoZW4gdGhlIGJh\nY2tncm91bmQKICAgIC8vIGFzeW5jIHByb2Nlc3MgZm9yIGl0IGhhcyBjb21w\nbGV0ZWQsIHNldCBpbiB0aGUgVm9pZENhbGxiYWNrLgogICAgcHVibGljIGJv\nb2xlYW4gaXNEb25lID0gZmFsc2U7CgogICAgLy8gQ29uc3RydWN0b3IgZm9y\nIGFsbCB0eXBlcyBvZiBQdWJTdWIgcmVxdWVzdCBkYXRhIHRvIHNlbmQgdG8g\ndGhlIHNlcnZlcgogICAgcHVibGljIFB1YlN1YkRhdGEoZmluYWwgQnl0ZVN0\ncmluZyB0b3BpYywgZmluYWwgTWVzc2FnZSBtc2csIGZpbmFsIEJ5dGVTdHJp\nbmcgc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgICAgICAgZmluYWwg\nT3BlcmF0aW9uVHlwZSBvcGVyYXRpb25UeXBlLCBmaW5hbCBTdWJzY3JpcHRp\nb25PcHRpb25zIG9wdGlvbnMsCiAgICAgICAgICAgICAgICAgICAgICBmaW5h\nbCBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywgZmluYWwgT2JqZWN0IGNvbnRl\neHQpIHsKICAgICAgICB0aGlzLnRvcGljID0gdG9waWM7CiAgICAgICAgdGhp\ncy5tc2cgPSBtc2c7CiAgICAgICAgdGhpcy5zdWJzY3JpYmVySWQgPSBzdWJz\nY3JpYmVySWQ7CiAgICAgICAgdGhpcy5vcGVyYXRpb25UeXBlID0gb3BlcmF0\naW9uVHlwZTsKICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwogICAg\nICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgICB0aGlzLmNv\nbnRleHQgPSBjb250ZXh0OwogICAgfQoKICAgIC8vIENsZWFyIGFsbCBvZiB0\naGUgc3RvcmVkIHNlcnZlcnMgd2UndmUgY29udGFjdGVkIG9yIGF0dGVtcHRl\nZCB0byBpbiB0aGlzCiAgICAvLyByZXF1ZXN0LgogICAgcHVibGljIHZvaWQg\nY2xlYXJTZXJ2ZXJzTGlzdCgpIHsKICAgICAgICBpZiAodHJpZWRTZXJ2ZXJz\nICE9IG51bGwpCiAgICAgICAgICAgIHRyaWVkU2VydmVycy5jbGVhcigpOwog\nICAgICAgIGlmIChjb25uZWN0RmFpbGVkU2VydmVycyAhPSBudWxsKQogICAg\nICAgICAgICBjb25uZWN0RmFpbGVkU2VydmVycy5jbGVhcigpOwogICAgICAg\nIGlmICh3cml0ZUZhaWxlZFNlcnZlcnMgIT0gbnVsbCkKICAgICAgICAgICAg\nd3JpdGVGYWlsZWRTZXJ2ZXJzLmNsZWFyKCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewogICAgICAgIFN0\ncmluZ0J1aWxkZXIgc2IgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nIGlmICh0b3BpYyAhPSBudWxsKQogICAgICAgICAgICBzYi5hcHBlbmQoIlRv\ncGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkpOwogICAgICAgIGlmICht\nc2cgIT0gbnVsbCkKICAgICAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBl\nbmQoIk1lc3NhZ2U6ICIgKyBtc2cpOwogICAgICAgIGlmIChzdWJzY3JpYmVy\nSWQgIT0gbnVsbCkKICAgICAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBl\nbmQoIlN1YnNjcmliZXJJZDogIiArIHN1YnNjcmliZXJJZC50b1N0cmluZ1V0\nZjgoKSk7CiAgICAgICAgaWYgKG9wZXJhdGlvblR5cGUgIT0gbnVsbCkKICAg\nICAgICAgICAgc2IuYXBwZW5kKENPTU1BKS5hcHBlbmQoIk9wZXJhdGlvbiBU\neXBlOiAiICsgb3BlcmF0aW9uVHlwZS50b1N0cmluZygpKTsKICAgICAgICBp\nZiAob3B0aW9ucyAhPSBudWxsKQogICAgICAgICAgICBzYi5hcHBlbmQoQ09N\nTUEpLmFwcGVuZCgiQ3JlYXRlIE9yIEF0dGFjaDogIiArIG9wdGlvbnMuZ2V0\nQ3JlYXRlT3JBdHRhY2goKS50b1N0cmluZygpKQogICAgICAgICAgICAgICAg\nLmFwcGVuZChDT01NQSkuYXBwZW5kKCJNZXNzYWdlIEJvdW5kOiAiICsgb3B0\naW9ucy5nZXRNZXNzYWdlQm91bmQoKSk7CiAgICAgICAgaWYgKHRyaWVkU2Vy\ndmVycyAhPSBudWxsICYmIHRyaWVkU2VydmVycy5zaXplKCkgPiAwKSB7CiAg\nICAgICAgICAgIHNiLmFwcGVuZChDT01NQSkuYXBwZW5kKCJUcmllZCBTZXJ2\nZXJzOiAiKTsKICAgICAgICAgICAgZm9yIChCeXRlU3RyaW5nIHRyaWVkU2Vy\ndmVyIDogdHJpZWRTZXJ2ZXJzKSB7CiAgICAgICAgICAgICAgICBzYi5hcHBl\nbmQodHJpZWRTZXJ2ZXIudG9TdHJpbmdVdGY4KCkpLmFwcGVuZChDT01NQSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNvbm5lY3RG\nYWlsZWRTZXJ2ZXJzICE9IG51bGwgJiYgY29ubmVjdEZhaWxlZFNlcnZlcnMu\nc2l6ZSgpID4gMCkgewogICAgICAgICAgICBzYi5hcHBlbmQoQ09NTUEpLmFw\ncGVuZCgiQ29ubmVjdCBGYWlsZWQgU2VydmVyczogIik7CiAgICAgICAgICAg\nIGZvciAoQnl0ZVN0cmluZyBjb25uZWN0RmFpbGVkU2VydmVyIDogY29ubmVj\ndEZhaWxlZFNlcnZlcnMpIHsKICAgICAgICAgICAgICAgIHNiLmFwcGVuZChj\nb25uZWN0RmFpbGVkU2VydmVyLnRvU3RyaW5nVXRmOCgpKS5hcHBlbmQoQ09N\nTUEpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICh3cml0\nZUZhaWxlZFNlcnZlcnMgIT0gbnVsbCAmJiB3cml0ZUZhaWxlZFNlcnZlcnMu\nc2l6ZSgpID4gMCkgewogICAgICAgICAgICBzYi5hcHBlbmQoQ09NTUEpLmFw\ncGVuZCgiV3JpdGUgRmFpbGVkIFNlcnZlcnM6ICIpOwogICAgICAgICAgICBm\nb3IgKEJ5dGVTdHJpbmcgd3JpdGVGYWlsZWRTZXJ2ZXIgOiB3cml0ZUZhaWxl\nZFNlcnZlcnMpIHsKICAgICAgICAgICAgICAgIHNiLmFwcGVuZCh3cml0ZUZh\naWxlZFNlcnZlci50b1N0cmluZ1V0ZjgoKSkuYXBwZW5kKENPTU1BKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzYi5hcHBlbmQoQ09NTUEp\nLmFwcGVuZCgiU2hvdWxkIENsYWltOiAiICsgc2hvdWxkQ2xhaW0pOwogICAg\nICAgIGlmICh0eG5JZCAhPSAwKQogICAgICAgICAgICBzYi5hcHBlbmQoQ09N\nTUEpLmFwcGVuZCgiVHhuSUQ6ICIgKyB0eG5JZCk7CiAgICAgICAgaWYgKHJl\ncXVlc3RXcml0ZVRpbWUgIT0gMCkKICAgICAgICAgICAgc2IuYXBwZW5kKENP\nTU1BKS5hcHBlbmQoIlJlcXVlc3QgV3JpdGUgVGltZTogIiArIHJlcXVlc3RX\ncml0ZVRpbWUpOwogICAgICAgIHNiLmFwcGVuZChDT01NQSkuYXBwZW5kKCJJ\ncyBEb25lOiAiICsgaXNEb25lKTsKICAgICAgICByZXR1cm4gc2IudG9TdHJp\nbmcoKTsKICAgIH0KCn0K\n","encoding":"base64"}

