{"sha":"ba3ee65b57b1b811efef7dc7e22fbd1e3aa48a00","node_id":"MDQ6QmxvYjE1NzU5NTY6YmEzZWU2NWI1N2IxYjgxMWVmZWY3ZGM3ZTIyZmJkMWUzYWE0OGEwMA==","size":18534,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/ba3ee65b57b1b811efef7dc7e22fbd1e3aa48a00","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuaGFuZGxlcnM7CgppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuQ29uY3VycmVudEhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5RdWV1ZTsKaW1wb3J0IGph\ndmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0\nIG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmpib3NzLm5l\ndHR5LmNoYW5uZWwuQ2hhbm5lbDsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5jbGllbnQuYXBpLk1lc3NhZ2VIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcuY2xpZW50LmRhdGEuTWVzc2FnZUNvbnN1bWVEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEuUHViU3ViRGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5kYXRhLlRvcGljU3Vi\nc2NyaWJlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5uZXR0\neS5IZWR3aWdDbGllbnRJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\nY2xpZW50Lm5ldHR5LlJlc3BvbnNlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uLkNsaWVudEFs\ncmVhZHlTdWJzY3JpYmVkRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuZXhjZXB0aW9ucy5QdWJTdWJFeGNlcHRpb24uU2VydmljZURvd25F\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5Q\ndWJTdWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwppbXBv\ncnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wu\nUHViU3ViUmVzcG9uc2U7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90\nb2NvbC5QdWJTdWJQcm90b2NvbC5TdGF0dXNDb2RlOwoKcHVibGljIGNsYXNz\nIFN1YnNjcmliZVJlc3BvbnNlSGFuZGxlciB7CgogICAgcHJpdmF0ZSBzdGF0\naWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKFN1\nYnNjcmliZVJlc3BvbnNlSGFuZGxlci5jbGFzcyk7CgogICAgcHJpdmF0ZSBm\naW5hbCBSZXNwb25zZUhhbmRsZXIgcmVzcG9uc2VIYW5kbGVyOwoKICAgIC8v\nIE1lbWJlciB2YXJpYWJsZXMgdXNlZCB3aGVuIHRoaXMgUmVzcG9uc2VIYW5k\nbGVyIGlzIGZvciBhIFN1YnNjcmliZQogICAgLy8gY2hhbm5lbC4gV2UgbmVl\nZCB0byBiZSBhYmxlIHRvIGNvbnN1bWUgbWVzc2FnZXMgc2VudCBiYWNrIHRv\nIHVzIGZyb20KICAgIC8vIHRoZSBzZXJ2ZXIsIGFuZCB0byBhbHNvIHJlY3Jl\nYXRlIHRoZSBDaGFubmVsIGNvbm5lY3Rpb24gaWYgaXQgZXZlciBnb2VzCiAg\nICAvLyBkb3duLiBGb3IgdGhhdCwgd2UgbmVlZCB0byBzdG9yZSB0aGUgb3Jp\nZ2luYWwgUHViU3ViRGF0YSBmb3IgdGhlCiAgICAvLyBzdWJzY3JpYmUgcmVx\ndWVzdCwgYW5kIGFsc28gdGhlIE1lc3NhZ2VIYW5kbGVyIHRoYXQgd2FzIHJl\nZ2lzdGVyZWQgd2hlbgogICAgLy8gZGVsaXZlcnkgb2YgbWVzc2FnZXMgc3Rh\ncnRlZCBmb3IgdGhlIHN1YnNjcmlwdGlvbi4KICAgIHByaXZhdGUgUHViU3Vi\nRGF0YSBvcmlnU3ViRGF0YTsKICAgIHByaXZhdGUgQ2hhbm5lbCBzdWJzY3Jp\nYmVDaGFubmVsOwogICAgcHJpdmF0ZSBNZXNzYWdlSGFuZGxlciBtZXNzYWdl\nSGFuZGxlcjsKICAgIC8vIENvdW50ZXIgZm9yIHRoZSBudW1iZXIgb2YgY29u\nc3VtZWQgbWVzc2FnZXMgc28gZmFyIHRvIGJ1ZmZlciB1cCBiZWZvcmUgd2UK\nICAgIC8vIHNlbmQgdGhlIENvbnN1bWUgbWVzc2FnZSBiYWNrIHRvIHRoZSBz\nZXJ2ZXIgYWxvbmcgd2l0aCB0aGUgbGFzdC9sYXJnZXN0CiAgICAvLyBtZXNz\nYWdlIHNlcSBJRCBzZWVuIHNvIGZhciBpbiB0aGF0IGJhdGNoLgogICAgcHJp\ndmF0ZSBpbnQgbnVtQ29uc3VtZWRNZXNzYWdlc0luQnVmZmVyID0gMDsKICAg\nIHByaXZhdGUgTWVzc2FnZVNlcUlkIGxhc3RNZXNzYWdlU2VxSWQ7CiAgICAv\nLyBRdWV1ZSB1c2VkIGZvciBzdWJzY3JpYmVzIHdoZW4gdGhlIE1lc3NhZ2VI\nYW5kbGVyIGhhc24ndCBiZWVuIHJlZ2lzdGVyZWQKICAgIC8vIHlldCBidXQg\nd2UndmUgYWxyZWFkeSByZWNlaXZlZCBzdWJzY3JpcHRpb24gbWVzc2FnZXMg\nZnJvbSB0aGUgc2VydmVyLgogICAgLy8gVGhpcyB3aWxsIGJlIGxhemlseSBj\ncmVhdGVkIGFzIG5lZWRlZC4KICAgIHByaXZhdGUgUXVldWU8TWVzc2FnZT4g\nc3Vic2NyaWJlTXNnUXVldWU7CiAgICAvLyBTZXQgdG8gc3RvcmUgYWxsIG9m\nIHRoZSBvdXRzdGFuZGluZyBzdWJzY3JpYmVkIG1lc3NhZ2VzIHRoYXQgYXJl\nIHBlbmRpbmcKICAgIC8vIHRvIGJlIGNvbnN1bWVkIGJ5IHRoZSBjbGllbnQg\nYXBwJ3MgTWVzc2FnZUhhbmRsZXIuIElmIHRoaXMgZXZlciBncm93cyB0b28K\nICAgIC8vIGJpZyAoZS5nLiBwcm9ibGVtIGF0IHRoZSBjbGllbnQgZW5kIGZv\nciBtZXNzYWdlIGNvbnN1bXB0aW9uKSwgd2UgY2FuCiAgICAvLyB0aHJvdHRs\nZSB0aGluZ3MgYnkgdGVtcG9yYXJpbHkgc2V0dGluZyB0aGUgU3Vic2NyaWJl\nIE5ldHR5IENoYW5uZWwKICAgIC8vIHRvIG5vdCBiZSByZWFkYWJsZS4gV2hl\nbiB0aGUgU2V0IGhhcyBzaHJ1bmsgc3VmZmljaWVudGx5LCB3ZSBjYW4gdHVy\nbiB0aGUKICAgIC8vIGNoYW5uZWwgYmFjayBvbiB0byByZWFkIG5ldyBtZXNz\nYWdlcy4KICAgIHByaXZhdGUgU2V0PE1lc3NhZ2U+IG91dHN0YW5kaW5nTXNn\nU2V0OwoKICAgIHB1YmxpYyBTdWJzY3JpYmVSZXNwb25zZUhhbmRsZXIoUmVz\ncG9uc2VIYW5kbGVyIHJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIHRoaXMu\ncmVzcG9uc2VIYW5kbGVyID0gcmVzcG9uc2VIYW5kbGVyOwogICAgfQoKICAg\nIC8vIFB1YmxpYyBnZXR0ZXIgdG8gcmV0cmlldmUgdGhlIG9yaWdpbmFsIFB1\nYlN1YkRhdGEgdXNlZCBmb3IgdGhlIFN1YnNjcmliZQogICAgLy8gcmVxdWVz\ndC4KICAgIHN5bmNocm9uaXplZCBwdWJsaWMgUHViU3ViRGF0YSBnZXRPcmln\nU3ViRGF0YSgpIHsKICAgICAgICByZXR1cm4gb3JpZ1N1YkRhdGE7CiAgICB9\nCgogICAgLy8gTWFpbiBtZXRob2QgdG8gaGFuZGxlIFN1YnNjcmliZSByZXNw\nb25zZXMgZnJvbSB0aGUgc2VydmVyIHRoYXQgd2Ugc2VudAogICAgLy8gYSBT\ndWJzY3JpYmUgUmVxdWVzdCB0by4KICAgIHB1YmxpYyB2b2lkIGhhbmRsZVN1\nYnNjcmliZVJlc3BvbnNlKFB1YlN1YlJlc3BvbnNlIHJlc3BvbnNlLCBQdWJT\ndWJEYXRhIHB1YlN1YkRhdGEsIENoYW5uZWwgY2hhbm5lbCkKICAgICAgICAg\nICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gSWYgdGhpcyB3YXMg\nbm90IGEgc3VjY2Vzc2Z1bCByZXNwb25zZSB0byB0aGUgU3Vic2NyaWJlIHJl\ncXVlc3QsIHdlCiAgICAgICAgLy8gd29uJ3QgYmUgdXNpbmcgdGhlIE5ldHR5\nIENoYW5uZWwgY3JlYXRlZCBzbyBqdXN0IGNsb3NlIGl0LgogICAgICAgIGlm\nICghcmVzcG9uc2UuZ2V0U3RhdHVzQ29kZSgpLmVxdWFscyhTdGF0dXNDb2Rl\nLlNVQ0NFU1MpKSB7CiAgICAgICAgICAgIEhlZHdpZ0NsaWVudEltcGwuZ2V0\nUmVzcG9uc2VIYW5kbGVyRnJvbUNoYW5uZWwoY2hhbm5lbCkuY2hhbm5lbENs\nb3NlZEV4cGxpY2l0bHkgPSB0cnVlOwogICAgICAgICAgICBjaGFubmVsLmNs\nb3NlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobG9nZ2VyLmlzRGVidWdF\nbmFibGVkKCkpCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiSGFuZGxpbmcg\nYSBTdWJzY3JpYmUgcmVzcG9uc2U6ICIgKyByZXNwb25zZSArICIsIHB1YlN1\nYkRhdGE6ICIgKyBwdWJTdWJEYXRhICsgIiwgaG9zdDogIgogICAgICAgICAg\nICAgICAgICAgICAgICAgKyBIZWR3aWdDbGllbnRJbXBsLmdldEhvc3RGcm9t\nQ2hhbm5lbChjaGFubmVsKSk7CiAgICAgICAgc3dpdGNoIChyZXNwb25zZS5n\nZXRTdGF0dXNDb2RlKCkpIHsKICAgICAgICBjYXNlIFNVQ0NFU1M6CiAgICAg\nICAgICAgIHN5bmNocm9uaXplZCh0aGlzKSB7CiAgICAgICAgICAgICAgICAv\nLyBGb3Igc3VjY2Vzc2Z1bCBTdWJzY3JpYmUgcmVxdWVzdHMsIHN0b3JlIHRo\naXMgQ2hhbm5lbCBsb2NhbGx5CiAgICAgICAgICAgICAgICAvLyBhbmQgc2V0\nIGl0IHRvIG5vdCBiZSByZWFkYWJsZSBpbml0aWFsbHkuCiAgICAgICAgICAg\nICAgICAvLyBUaGlzIHdheSB3ZSB3b24ndCBiZSBkZWxpdmVyaW5nIG1lc3Nh\nZ2VzIGZvciB0aGlzIHRvcGljCiAgICAgICAgICAgICAgICAvLyBzdWJzY3Jp\ncHRpb24gdW50aWwgdGhlIGNsaWVudCBleHBsaWNpdGx5IHNheXMgc28uCiAg\nICAgICAgICAgICAgICBzdWJzY3JpYmVDaGFubmVsID0gY2hhbm5lbDsKICAg\nICAgICAgICAgICAgIHN1YnNjcmliZUNoYW5uZWwuc2V0UmVhZGFibGUoZmFs\nc2UpOwogICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIG9yaWdpbmFsIFB1\nYlN1YkRhdGEgdXNlZCB0byBjcmVhdGUgdGhpcyBzdWNjZXNzZnVsCiAgICAg\nICAgICAgICAgICAvLyBTdWJzY3JpYmUgcmVxdWVzdC4KICAgICAgICAgICAg\nICAgIG9yaWdTdWJEYXRhID0gcHViU3ViRGF0YTsKCiAgICAgICAgICAgICAg\nICAvLyBTdG9yZSB0aGUgbWFwcGluZyBmb3IgdGhlIFRvcGljU3Vic2NyaWJl\nciB0byB0aGUgQ2hhbm5lbC4KICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMg\nc28gd2UgY2FuIGNvbnRyb2wgdGhlIHN0YXJ0aW5nIGFuZCBzdG9wcGluZyBv\nZgogICAgICAgICAgICAgICAgLy8gbWVzc2FnZSBkZWxpdmVyaWVzIGZyb20g\ndGhlIHNlcnZlciBvbiB0aGF0IENoYW5uZWwuIFN0b3JlCiAgICAgICAgICAg\nICAgICAvLyB0aGlzIG9ubHkgb24gYSBzdWNjZXNzZnVsIGFjayByZXNwb25z\nZSBmcm9tIHRoZSBzZXJ2ZXIuCiAgICAgICAgICAgICAgICBUb3BpY1N1YnNj\ncmliZXIgdG9waWNTdWJzY3JpYmVyID0gbmV3IFRvcGljU3Vic2NyaWJlcihw\ndWJTdWJEYXRhLnRvcGljLCBwdWJTdWJEYXRhLnN1YnNjcmliZXJJZCk7CiAg\nICAgICAgICAgICAgICByZXNwb25zZUhhbmRsZXIuZ2V0U3Vic2NyaWJlcigp\nLnNldENoYW5uZWxGb3JUb3BpYyh0b3BpY1N1YnNjcmliZXIsIGNoYW5uZWwp\nOwogICAgICAgICAgICAgICAgLy8gTGF6aWx5IGNyZWF0ZSB0aGUgU2V0IChm\ncm9tIGEgY29uY3VycmVudCBoYXNobWFwKSB0byBrZWVwIHRyYWNrCiAgICAg\nICAgICAgICAgICAvLyBvZiBvdXRzdGFuZGluZyBNZXNzYWdlcyB0byBiZSBj\nb25zdW1lZCBieSB0aGUgY2xpZW50IGFwcC4gQXQgdGhpcwogICAgICAgICAg\nICAgICAgLy8gc3RhZ2UsIGRlbGl2ZXJ5IGZvciB0aGF0IHRvcGljIGhhc24n\ndCBzdGFydGVkIHlldCBzbyBjcmVhdGlvbiBvZgogICAgICAgICAgICAgICAg\nLy8gdGhpcyBTZXQgc2hvdWxkIGJlIHRocmVhZCBzYWZlLiBXZSdsbCBjcmVh\ndGUgdGhlIFNldCB3aXRoIGFuIGluaXRpYWwKICAgICAgICAgICAgICAgIC8v\nIGNhcGFjaXR5IGVxdWFsIHRvIHRoZSBjb25maWd1cmVkIHBhcmFtZXRlciBm\nb3IgdGhlIG1heGltdW0gbnVtYmVyIG9mCiAgICAgICAgICAgICAgICAvLyBv\ndXRzdGFuZGluZyBtZXNzYWdlcyB0byBhbGxvdy4gVGhlIGxvYWQgZmFjdG9y\nIHdpbGwgYmUgc2V0IHRvCiAgICAgICAgICAgICAgICAvLyAxLjBmIHdoaWNo\nIG1lYW5zIHdlJ2xsIG9ubHkgcmVoYXNoIGFuZCBhbGxvY2F0ZSBtb3JlIHNw\nYWNlIGlmCiAgICAgICAgICAgICAgICAvLyB3ZSBldmVyIGV4Y2VlZCB0aGUg\naW5pdGlhbCBjYXBhY2l0eS4gVGhhdCBzaG91bGQgYmUgb2theQogICAgICAg\nICAgICAgICAgLy8gYmVjYXVzZSB3aGVuIHRoYXQgaGFwcGVucywgdGhpbmdz\nIGFyZSBzbG93IGFscmVhZHkgYW5kIHBpbGluZwogICAgICAgICAgICAgICAg\nLy8gdXAgb24gdGhlIGNsaWVudCBhcHAgc2lkZSB0byBjb25zdW1lIG1lc3Nh\nZ2VzLgogICAgICAgICAgICAgICAgb3V0c3RhbmRpbmdNc2dTZXQgPSBDb2xs\nZWN0aW9ucy5uZXdTZXRGcm9tTWFwKAogICAgICAgICAgICAgICAgICAgICAg\nICBuZXcgQ29uY3VycmVudEhhc2hNYXA8TWVzc2FnZSxCb29sZWFuPigKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZUhhbmRsZXIu\nZ2V0Q29uZmlndXJhdGlvbigpLmdldE1heGltdW1PdXRzdGFuZGluZ01lc3Nh\nZ2VzKCksIDEuMGYpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBS\nZXNwb25zZSB3YXMgc3VjY2VzcyBzbyBpbnZva2UgdGhlIGNhbGxiYWNrJ3Mg\nb3BlcmF0aW9uRmluaXNoZWQKICAgICAgICAgICAgLy8gbWV0aG9kLgogICAg\nICAgICAgICBwdWJTdWJEYXRhLmNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVk\nKHB1YlN1YkRhdGEuY29udGV4dCwgbnVsbCk7CiAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgIGNhc2UgQ0xJRU5UX0FMUkVBRFlfU1VCU0NSSUJFRDoKICAg\nICAgICAgICAgLy8gRm9yIFN1YnNjcmliZSByZXF1ZXN0cywgdGhlIHNlcnZl\nciBzYXlzIHRoYXQgdGhlIGNsaWVudCBpcwogICAgICAgICAgICAvLyBhbHJl\nYWR5IHN1YnNjcmliZWQgdG8gaXQuCiAgICAgICAgICAgIHB1YlN1YkRhdGEu\nY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKHB1YlN1YkRhdGEuY29udGV4dCwg\nbmV3IENsaWVudEFscmVhZHlTdWJzY3JpYmVkRXhjZXB0aW9uKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIkNsaWVudCBpcyBhbHJlYWR5IHN1YnNjcmliZWQgZm9yIHRvcGljOiAiICsg\ncHViU3ViRGF0YS50b3BpYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmli\nZXJJZDogIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgKyBwdWJTdWJEYXRhLnN1YnNjcmliZXJJZC50b1N0\ncmluZ1V0ZjgoKSkpOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNl\nIFNFUlZJQ0VfRE9XTjoKICAgICAgICAgICAgLy8gUmVzcG9uc2Ugd2FzIHNl\ncnZpY2UgZG93biBmYWlsdXJlIHNvIGp1c3QgaW52b2tlIHRoZSBjYWxsYmFj\naydzCiAgICAgICAgICAgIC8vIG9wZXJhdGlvbkZhaWxlZCBtZXRob2QuCiAg\nICAgICAgICAgIHB1YlN1YkRhdGEuY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVk\nKHB1YlN1YkRhdGEuY29udGV4dCwgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9u\nKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIlNlcnZlciByZXNwb25kZWQgd2l0aCBhIFNFUlZJQ0VfRE9X\nTiBzdGF0dXMiKSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2Ug\nTk9UX1JFU1BPTlNJQkxFX0ZPUl9UT1BJQzoKICAgICAgICAgICAgLy8gUmVk\naXJlY3QgcmVzcG9uc2Ugc28gd2UnbGwgbmVlZCB0byByZXBvc3QgdGhlIG9y\naWdpbmFsIFN1YnNjcmliZQogICAgICAgICAgICAvLyBSZXF1ZXN0CiAgICAg\nICAgICAgIHJlc3BvbnNlSGFuZGxlci5oYW5kbGVSZWRpcmVjdFJlc3BvbnNl\nKHJlc3BvbnNlLCBwdWJTdWJEYXRhLCBjaGFubmVsKTsKICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgLy8gQ29uc2lk\nZXIgYWxsIG90aGVyIHN0YXR1cyBjb2RlcyBhcyBlcnJvcnMsIG9wZXJhdGlv\nbiBmYWlsZWQKICAgICAgICAgICAgLy8gY2FzZXMuCiAgICAgICAgICAgIGxv\nZ2dlci5lcnJvcigiVW5leHBlY3RlZCBlcnJvciByZXNwb25zZSBmcm9tIHNl\ncnZlciBmb3IgUHViU3ViUmVzcG9uc2U6ICIgKyByZXNwb25zZSk7CiAgICAg\nICAgICAgIHB1YlN1YkRhdGEuY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKHB1\nYlN1YkRhdGEuY29udGV4dCwgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIlNlcnZlciByZXNwb25kZWQgd2l0aCBhIHN0YXR1cyBjb2RlIG9m\nOiAiICsgcmVzcG9uc2UuZ2V0U3RhdHVzQ29kZSgpKSk7CiAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBNYWluIG1ldGhvZCB0\nbyBoYW5kbGUgY29uc3VtaW5nIGEgbWVzc2FnZSBmb3IgYSB0b3BpYyB0aGF0\nIHRoZSBjbGllbnQgaXMKICAgIC8vIHN1YnNjcmliZWQgdG8uCiAgICBwdWJs\naWMgdm9pZCBoYW5kbGVTdWJzY3JpYmVNZXNzYWdlKFB1YlN1YlJlc3BvbnNl\nIHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiSGFuZGxpbmcgYSBT\ndWJzY3JpYmUgbWVzc2FnZSBpbiByZXNwb25zZToge30sIHRvcGljOiB7fSwg\nc3Vic2NyaWJlcklkOiB7fSIsCiAgICAgICAgICAgICAgICAgICAgbmV3IE9i\namVjdFtdIHsgcmVzcG9uc2UsIGdldE9yaWdTdWJEYXRhKCkudG9waWMudG9T\ndHJpbmdVdGY4KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZ2V0T3JpZ1N1YkRhdGEoKS5zdWJzY3JpYmVySWQudG9TdHJpbmdVdGY4\nKCkgfSk7CiAgICAgICAgfQogICAgICAgIE1lc3NhZ2UgbWVzc2FnZSA9IHJl\nc3BvbnNlLmdldE1lc3NhZ2UoKTsKCiAgICAgICAgc3luY2hyb25pemVkICh0\naGlzKSB7CiAgICAgICAgICAgIC8vIENvbnN1bWUgdGhlIG1lc3NhZ2UgYXN5\nbmNocm9ub3VzbHkgdGhhdCB0aGUgY2xpZW50IGlzIHN1YnNjcmliZWQKICAg\nICAgICAgICAgLy8gdG8uIERvIHRoaXMgb25seSBpZiBkZWxpdmVyeSBmb3Ig\ndGhlIHN1YnNjcmlwdGlvbiBoYXMgc3RhcnRlZCBhbmQKICAgICAgICAgICAg\nLy8gYSBNZXNzYWdlSGFuZGxlciBoYXMgYmVlbiByZWdpc3RlcmVkIGZvciB0\naGUgVG9waWNTdWJzY3JpYmVyLgogICAgICAgICAgICBpZiAobWVzc2FnZUhh\nbmRsZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgYXN5bmNNZXNzYWdl\nQ29uc3VtZShtZXNzYWdlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgIC8vIE1lc3NhZ2VIYW5kbGVyIGhhcyBub3QgeWV0IGJlZW4g\ncmVnaXN0ZXJlZCBzbyBxdWV1ZSB1cCB0aGVzZQogICAgICAgICAgICAgICAg\nLy8gbWVzc2FnZXMgZm9yIHRoZSBUb3BpYyBTdWJzY3JpcHRpb24uIE1ha2Ug\ndGhlIGluaXRpYWwgbGF6eQogICAgICAgICAgICAgICAgLy8gY3JlYXRpb24g\nb2YgdGhlIG1lc3NhZ2UgcXVldWUgdGhyZWFkIHNhZmUganVzdCBzbyB3ZSBk\nb24ndAogICAgICAgICAgICAgICAgLy8gcnVuIGludG8gYSByYWNlIGNvbmRp\ndGlvbiB3aGVyZSB0d28gc2ltdWx0YW5lb3VzIHRocmVhZHMgcHJvY2Vzcwog\nICAgICAgICAgICAgICAgLy8gYSByZWNlaXZlZCBtZXNzYWdlIGFuZCBib3Ro\nIHRyeSB0byBjcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YKICAgICAgICAgICAg\nICAgIC8vIHRoZSBtZXNzYWdlIHF1ZXVlLiBQZXJmb3JtYW5jZSBvdmVyaGVh\nZCBzaG91bGQgYmUgb2theQogICAgICAgICAgICAgICAgLy8gYmVjYXVzZSB0\naGUgZGVsaXZlcnkgb2YgdGhlIHRvcGljIGhhcyBub3QgZXZlbiBzdGFydGVk\nIHlldAogICAgICAgICAgICAgICAgLy8gc28gdGhlc2UgbWVzc2FnZXMgYXJl\nIG5vdCBjb25zdW1lZCBhbmQganVzdCBidWZmZXJlZCB1cCBoZXJlLgogICAg\nICAgICAgICAgICAgaWYgKHN1YnNjcmliZU1zZ1F1ZXVlID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlTXNnUXVldWUgPSBuZXcgTGlu\na2VkTGlzdDxNZXNzYWdlPigpOwogICAgICAgICAgICAgICAgaWYgKGxvZ2dl\nci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGxvZ2dl\ncgogICAgICAgICAgICAgICAgICAgIC5kZWJ1ZygiTWVzc2FnZSBoYXMgYXJy\naXZlZCBidXQgU3Vic2NyaWJlIGNoYW5uZWwgZG9lcyBub3QgaGF2ZSBhIHJl\nZ2lzdGVyZWQgTWVzc2FnZUhhbmRsZXIgeWV0IHNvIHF1ZXVlaW5nIHVwIHRo\nZSBtZXNzYWdlOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICsgbWVz\nc2FnZSk7CiAgICAgICAgICAgICAgICBzdWJzY3JpYmVNc2dRdWV1ZS5hZGQo\nbWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBNZXRob2QgY2FsbGVkIHdoZW4gYSBtZXNzYWdlIGFycml2\nZXMgZm9yIGEgc3Vic2NyaWJlIENoYW5uZWwgYW5kIHdlIHdhbnQKICAgICAq\nIHRvIGNvbnN1bWUgaXQgYXN5bmNocm9ub3VzbHkgdmlhIHRoZSByZWdpc3Rl\ncmVkIE1lc3NhZ2VIYW5kbGVyIChzaG91bGQKICAgICAqIG5vdCBiZSBudWxs\nIHdoZW4gY2FsbGVkIGhlcmUpLgogICAgICoKICAgICAqIEBwYXJhbSBtZXNz\nYWdlCiAgICAgKiAgICAgICAgICAgIE1lc3NhZ2UgZnJvbSBTdWJzY3JpYmUg\nQ2hhbm5lbCB3ZSB3YW50IHRvIGNvbnN1bWUuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGFzeW5jTWVzc2FnZUNvbnN1bWUoTWVzc2FnZSBtZXNzYWdl\nKSB7CiAgICAgICAgaWYgKGxvZ2dlci5pc0RlYnVnRW5hYmxlZCgpKQogICAg\nICAgICAgICBsb2dnZXIuZGVidWcoIkNhbGwgdGhlIGNsaWVudCBhcHAncyBN\nZXNzYWdlSGFuZGxlciBhc3luY2hyb25vdXNseSB0byBjb25zdW1lIHRoZSBt\nZXNzYWdlOiAiICsgbWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgICAg\nKyAiLCB0b3BpYzogIiArIG9yaWdTdWJEYXRhLnRvcGljLnRvU3RyaW5nVXRm\nOCgpICsgIiwgc3Vic2NyaWJlcklkOiAiCiAgICAgICAgICAgICAgICAgICAg\nICAgICArIG9yaWdTdWJEYXRhLnN1YnNjcmliZXJJZC50b1N0cmluZ1V0Zjgo\nKSk7CiAgICAgICAgLy8gQWRkIHRoaXMgInBlbmRpbmcgdG8gYmUgY29uc3Vt\nZWQiIG1lc3NhZ2UgdG8gdGhlIG91dHN0YW5kaW5nTXNnU2V0LgogICAgICAg\nIG91dHN0YW5kaW5nTXNnU2V0LmFkZChtZXNzYWdlKTsKICAgICAgICAvLyBD\naGVjayBpZiB3ZSd2ZSBleGNlZWRlZCB0aGUgbWF4IHNpemUgZm9yIHRoZSBv\ndXRzdGFuZGluZyBtZXNzYWdlIHNldC4KICAgICAgICBpZiAob3V0c3RhbmRp\nbmdNc2dTZXQuc2l6ZSgpID49IHJlc3BvbnNlSGFuZGxlci5nZXRDb25maWd1\ncmF0aW9uKCkuZ2V0TWF4aW11bU91dHN0YW5kaW5nTWVzc2FnZXMoKQogICAg\nICAgICAgICAgICAgJiYgc3Vic2NyaWJlQ2hhbm5lbC5pc1JlYWRhYmxlKCkp\nIHsKICAgICAgICAgICAgLy8gVG9vIG1hbnkgb3V0c3RhbmRpbmcgbWVzc2Fn\nZXMgc28gdGhyb3R0bGUgaXQgYnkgc2V0dGluZyB0aGUgTmV0dHkKICAgICAg\nICAgICAgLy8gQ2hhbm5lbCB0byBub3QgYmUgcmVhZGFibGUuCiAgICAgICAg\nICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1ZygiVG9vIG1hbnkgb3V0c3RhbmRpbmcgbWVzc2Fn\nZXMgKCIgKyBvdXRzdGFuZGluZ01zZ1NldC5zaXplKCkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICArICIpIHNvIHRocm90dGxpbmcgdGhlIHN1YnNj\ncmliZSBuZXR0eSBDaGFubmVsIik7CiAgICAgICAgICAgIHN1YnNjcmliZUNo\nYW5uZWwuc2V0UmVhZGFibGUoZmFsc2UpOwogICAgICAgIH0KICAgICAgICBN\nZXNzYWdlQ29uc3VtZURhdGEgbWVzc2FnZUNvbnN1bWVEYXRhID0gbmV3IE1l\nc3NhZ2VDb25zdW1lRGF0YShvcmlnU3ViRGF0YS50b3BpYywgb3JpZ1N1YkRh\ndGEuc3Vic2NyaWJlcklkLAogICAgICAgICAgICAgICAgbWVzc2FnZSk7CiAg\nICAgICAgbWVzc2FnZUhhbmRsZXIuZGVsaXZlcihvcmlnU3ViRGF0YS50b3Bp\nYywgb3JpZ1N1YkRhdGEuc3Vic2NyaWJlcklkLCBtZXNzYWdlLCByZXNwb25z\nZUhhbmRsZXIuZ2V0Q2xpZW50KCkKICAgICAgICAgICAgICAgIC5nZXRDb25z\ndW1lQ2FsbGJhY2soKSwgbWVzc2FnZUNvbnN1bWVEYXRhKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIE1ldGhvZCBjYWxsZWQgd2hlbiB0aGUgY2xpZW50IGFw\ncCdzIE1lc3NhZ2VIYW5kbGVyIGhhcyBhc3luY2hyb25vdXNseQogICAgICog\nY29tcGxldGVkIGNvbnN1bWluZyBhIHN1YnNjcmliZWQgbWVzc2FnZSBzZW50\nIGZyb20gdGhlIHNlcnZlci4gVGhlCiAgICAgKiBjb250cmFjdCB3aXRoIHRo\nZSBjbGllbnQgYXBwIGlzIHRoYXQgbWVzc2FnZXMgc2VudCB0byB0aGUgaGFu\nZGxlciB0byBiZQogICAgICogY29uc3VtZWQgd2lsbCBoYXZlIHRoZSBjYWxs\nYmFjayByZXNwb25zZSBkb25lIGluIHRoZSBzYW1lIG9yZGVyLiBTbyBpZiB3\nZQogICAgICogYXN5bmNocm9ub3VzbHkgY2FsbCB0aGUgTWVzc2FnZUhhbmRs\nZXIgdG8gY29uc3VtZSBtZXNzYWdlcyAjMS01LCB0aGF0CiAgICAgKiBzaG91\nbGQgY2FsbCB0aGUgbWVzc2FnZUNvbnN1bWVkIG1ldGhvZCBoZXJlIHZpYSB0\naGUgVm9pZENhbGxiYWNrIGluIHRoZQogICAgICogc2FtZSBvcmRlci4gVG8g\nbWFrZSB0aGlzIHRocmVhZCBzYWZlLCBzaW5jZSBtdWx0aXBsZSBvdXRzdGFu\nZGluZyBtZXNzYWdlcwogICAgICogY291bGQgYmUgY29uc3VtZWQgYnkgdGhl\nIGNsaWVudCBhcHAgYW5kIHRoZW4gY2FsbGVkIGJhY2sgdG8gaGVyZSwgbWFr\nZQogICAgICogdGhpcyBtZXRob2Qgc3luY2hyb25pemVkLgogICAgICoKICAg\nICAqIEBwYXJhbSBtZXNzYWdlCiAgICAgKiAgICAgICAgICAgIE1lc3NhZ2Ug\nc2VudCBmcm9tIHNlcnZlciBmb3IgdG9waWMgc3Vic2NyaXB0aW9uIHRoYXQg\naGFzIGJlZW4KICAgICAqICAgICAgICAgICAgY29uc3VtZWQgYnkgdGhlIGNs\naWVudC4KICAgICAqLwogICAgcHJvdGVjdGVkIHN5bmNocm9uaXplZCB2b2lk\nIG1lc3NhZ2VDb25zdW1lZChNZXNzYWdlIG1lc3NhZ2UpIHsKICAgICAgICBp\nZiAobG9nZ2VyLmlzRGVidWdFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZ2dl\nci5kZWJ1ZygiTWVzc2FnZSBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgY29uc3Vt\nZWQgYnkgdGhlIGNsaWVudCBhcHAgZm9yIG1lc3NhZ2U6ICIgKyBtZXNzYWdl\nCiAgICAgICAgICAgICAgICAgICAgICAgICArICIsIHRvcGljOiAiICsgb3Jp\nZ1N1YkRhdGEudG9waWMudG9TdHJpbmdVdGY4KCkgKyAiLCBzdWJzY3JpYmVy\nSWQ6ICIKICAgICAgICAgICAgICAgICAgICAgICAgICsgb3JpZ1N1YkRhdGEu\nc3Vic2NyaWJlcklkLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICAvLyBVcGRh\ndGUgdGhlIGNvbnN1bWVkIG1lc3NhZ2VzIGJ1ZmZlciB2YXJpYWJsZXMKICAg\nICAgICBpZiAocmVzcG9uc2VIYW5kbGVyLmdldENvbmZpZ3VyYXRpb24oKS5p\nc0F1dG9TZW5kQ29uc3VtZU1lc3NhZ2VFbmFibGVkKCkpIHsKICAgICAgICAg\nICAgLy8gVXBkYXRlIHRoZXNlIHZhcmlhYmxlcyBvbmx5IGlmIHdlIGFyZSBh\ndXRvLXNlbmRpbmcgY29uc3VtZQogICAgICAgICAgICAvLyBtZXNzYWdlcyB0\nbyB0aGUgc2VydmVyLiBPdGhlcndpc2UgdGhlIG9udXMgaXMgb24gdGhlIGNs\naWVudCBhcHAKICAgICAgICAgICAgLy8gdG8gY2FsbCB0aGUgU3Vic2NyaWJl\nciBjb25zdW1lIEFQSSB0byBsZXQgdGhlIHNlcnZlciBrbm93IHdoaWNoCiAg\nICAgICAgICAgIC8vIG1lc3NhZ2VzIGl0IGhhcyBzdWNjZXNzZnVsbHkgY29u\nc3VtZWQuCiAgICAgICAgICAgIG51bUNvbnN1bWVkTWVzc2FnZXNJbkJ1ZmZl\ncisrOwogICAgICAgICAgICBsYXN0TWVzc2FnZVNlcUlkID0gbWVzc2FnZS5n\nZXRNc2dJZCgpOwogICAgICAgIH0KICAgICAgICAvLyBSZW1vdmUgdGhpcyBj\nb25zdW1lZCBtZXNzYWdlIGZyb20gdGhlIG91dHN0YW5kaW5nIE1lc3NhZ2Ug\nU2V0LgogICAgICAgIG91dHN0YW5kaW5nTXNnU2V0LnJlbW92ZShtZXNzYWdl\nKTsKCiAgICAgICAgLy8gRm9yIGNvbnN1bWUgcmVzcG9uc2UgdG8gc2VydmVy\nLCB0aGVyZSBpcyBhIGNvbmZpZyBwYXJhbSBvbiBob3cgbWFueQogICAgICAg\nIC8vIG1lc3NhZ2VzIHRvIGNvbnN1bWUgYW5kIGJ1ZmZlciB1cCBiZWZvcmUg\nc2VuZGluZyB0aGUgY29uc3VtZSByZXF1ZXN0LgogICAgICAgIC8vIFdlIGp1\nc3QgbmVlZCB0byBrZWVwIGEgY291bnQgb2YgdGhlIG51bWJlciBvZiBtZXNz\nYWdlcyBjb25zdW1lZAogICAgICAgIC8vIGFuZCB0aGUgbGFyZ2VzdC9sYXRl\nc3QgbXNnIElEIHNlZW4gc28gZmFyIGluIHRoaXMgYmF0Y2guIE1lc3NhZ2Vz\nCiAgICAgICAgLy8gc2hvdWxkIGJlIGRlbGl2ZXJlZCBpbiBvcmRlciBhbmQg\nd2l0aG91dCBnYXBzLiBEbyB0aGlzIG9ubHkgaWYKICAgICAgICAvLyBhdXRv\nLXNlbmRpbmcgb2YgY29uc3VtZSBtZXNzYWdlcyBpcyBlbmFibGVkLgogICAg\nICAgIGlmIChyZXNwb25zZUhhbmRsZXIuZ2V0Q29uZmlndXJhdGlvbigpLmlz\nQXV0b1NlbmRDb25zdW1lTWVzc2FnZUVuYWJsZWQoKQogICAgICAgICAgICAg\nICAgJiYgbnVtQ29uc3VtZWRNZXNzYWdlc0luQnVmZmVyID49IHJlc3BvbnNl\nSGFuZGxlci5nZXRDb25maWd1cmF0aW9uKCkuZ2V0Q29uc3VtZWRNZXNzYWdl\nc0J1ZmZlclNpemUoKSkgewogICAgICAgICAgICAvLyBTZW5kIHRoZSBjb25z\ndW1lIHJlcXVlc3QgYW5kIHJlc2V0IHRoZSBjb25zdW1lZCBtZXNzYWdlcyBi\ndWZmZXIKICAgICAgICAgICAgLy8gdmFyaWFibGVzLiBXZSB3aWxsIHVzZSB0\naGUgc2FtZSBDaGFubmVsIGNyZWF0ZWQgZnJvbSB0aGUKICAgICAgICAgICAg\nLy8gc3Vic2NyaWJlIHJlcXVlc3QgZm9yIHRoZSBUb3BpY1N1YnNjcmliZXIu\nCiAgICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAg\nICAgICAgICAgICAgIGxvZ2dlcgogICAgICAgICAgICAgICAgLmRlYnVnKCJD\nb25zdW1lZCBtZXNzYWdlIGJ1ZmZlciBsaW1pdCByZWFjaGVkIHNvIHNlbmQg\ndGhlIENvbnN1bWUgUmVxdWVzdCB0byB0aGUgc2VydmVyIHdpdGggbGFzdE1l\nc3NhZ2VTZXFJZDogIgogICAgICAgICAgICAgICAgICAgICAgICsgbGFzdE1l\nc3NhZ2VTZXFJZCk7CiAgICAgICAgICAgIHJlc3BvbnNlSGFuZGxlci5nZXRT\ndWJzY3JpYmVyKCkuZG9Db25zdW1lKG9yaWdTdWJEYXRhLCBzdWJzY3JpYmVD\naGFubmVsLCBsYXN0TWVzc2FnZVNlcUlkKTsKICAgICAgICAgICAgbnVtQ29u\nc3VtZWRNZXNzYWdlc0luQnVmZmVyID0gMDsKICAgICAgICAgICAgbGFzdE1l\nc3NhZ2VTZXFJZCA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICAvLyBDaGVj\nayBpZiB3ZSB0aHJvdHRsZWQgbWVzc2FnZSBjb25zdW1wdGlvbiBwcmV2aW91\nc2x5IHdoZW4gdGhlCiAgICAgICAgLy8gb3V0c3RhbmRpbmcgbWVzc2FnZSBs\naW1pdCB3YXMgcmVhY2hlZC4gRm9yIG5vdywgb25seSB0dXJuIHRoZQogICAg\nICAgIC8vIGRlbGl2ZXJ5IGJhY2sgb24gaWYgdGhlcmUgYXJlIG5vIG1vcmUg\nb3V0c3RhbmRpbmcgbWVzc2FnZXMgdG8KICAgICAgICAvLyBjb25zdW1lLiBX\nZSBjb3VsZCBtYWtlIHRoaXMgYSBjb25maWd1cmFibGUgcGFyYW1ldGVyIGlm\nIG5lZWRlZC4KICAgICAgICBpZiAoIXN1YnNjcmliZUNoYW5uZWwuaXNSZWFk\nYWJsZSgpICYmIG91dHN0YW5kaW5nTXNnU2V0LnNpemUoKSA9PSAwKSB7CiAg\nICAgICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgIGxvZ2dlcgogICAgICAgICAgICAgICAgLmRlYnVnKCJNZXNz\nYWdlIGNvbnN1bXB0aW9uIGhhcyBjYXVnaHQgdXAgc28gb2theSB0byB0dXJu\nIG9mZiB0aHJvdHRsaW5nIG9mIG1lc3NhZ2VzIG9uIHRoZSBzdWJzY3JpYmUg\nY2hhbm5lbCBmb3IgdG9waWM6ICIKICAgICAgICAgICAgICAgICAgICAgICAr\nIG9yaWdTdWJEYXRhLnRvcGljLnRvU3RyaW5nVXRmOCgpCiAgICAgICAgICAg\nICAgICAgICAgICAgKyAiLCBzdWJzY3JpYmVySWQ6ICIKICAgICAgICAgICAg\nICAgICAgICAgICArIG9yaWdTdWJEYXRhLnN1YnNjcmliZXJJZC50b1N0cmlu\nZ1V0ZjgoKSk7CiAgICAgICAgICAgIHN1YnNjcmliZUNoYW5uZWwuc2V0UmVh\nZGFibGUodHJ1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nU2V0dGVyIHVzZWQgZm9yIFN1YnNjcmliZSBmbG93cyB3aGVuIGRlbGl2ZXJ5\nIGZvciB0aGUgc3Vic2NyaXB0aW9uIGlzCiAgICAgKiBzdGFydGVkLiBUaGlz\nIGlzIHVzZWQgdG8gcmVnaXN0ZXIgdGhlIE1lc3NhZ2VIYW5kbGVyIG5lZWRl\nZCB0byBjb25zdW1lcgogICAgICogdGhlIHN1YnNjcmliZWQgbWVzc2FnZXMg\nZm9yIHRoZSB0b3BpYy4KICAgICAqCiAgICAgKiBAcGFyYW0gbWVzc2FnZUhh\nbmRsZXIKICAgICAqICAgICAgICAgICAgTWVzc2FnZUhhbmRsZXIgdG8gcmVn\naXN0ZXIgZm9yIHRoaXMgUmVzcG9uc2VIYW5kbGVyIGluc3RhbmNlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRNZXNzYWdlSGFuZGxlcihNZXNzYWdl\nSGFuZGxlciBtZXNzYWdlSGFuZGxlcikgewogICAgICAgIGlmIChsb2dnZXIu\naXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAgICAgICBsb2dnZXIuZGVidWco\nIlNldHRpbmcgdGhlIG1lc3NhZ2VIYW5kbGVyIGZvciB0b3BpYzoge30sIHN1\nYnNjcmliZXJJZDoge30iLAogICAgICAgICAgICAgICAgICAgICAgICAgZ2V0\nT3JpZ1N1YkRhdGEoKS50b3BpYy50b1N0cmluZ1V0ZjgoKSwKICAgICAgICAg\nICAgICAgICAgICAgICAgIGdldE9yaWdTdWJEYXRhKCkuc3Vic2NyaWJlcklk\nLnRvU3RyaW5nVXRmOCgpKTsKICAgICAgICB9CiAgICAgICAgc3luY2hyb25p\nemVkICh0aGlzKSB7CiAgICAgICAgICAgIHRoaXMubWVzc2FnZUhhbmRsZXIg\nPSBtZXNzYWdlSGFuZGxlcjsKICAgICAgICAgICAgLy8gT25jZSB0aGUgTWVz\nc2FnZUhhbmRsZXIgaXMgcmVnaXN0ZXJlZCwgc2VlIGlmIHdlIGhhdmUgYW55\nIHF1ZXVlZCB1cAogICAgICAgICAgICAvLyBzdWJzY3JpcHRpb24gbWVzc2Fn\nZXMgc2VudCB0byB1cyBhbHJlYWR5IGZyb20gdGhlIHNlcnZlci4gSWYgc28s\nCiAgICAgICAgICAgIC8vIGNvbnN1bWUgdGhvc2UgZmlyc3QuIERvIHRoaXMg\nb25seSBpZiB0aGUgTWVzc2FnZUhhbmRsZXIgcmVnaXN0ZXJlZCBpcwogICAg\nICAgICAgICAvLyBub3QgbnVsbCAoc2luY2UgdGhhdCB3b3VsZCBiZSB0aGUg\nSGVkd2lnU3Vic2NyaWJlci5zdG9wRGVsaXZlcnkKICAgICAgICAgICAgLy8g\nY2FsbCkuCiAgICAgICAgICAgIGlmIChtZXNzYWdlSGFuZGxlciAhPSBudWxs\nICYmIHN1YnNjcmliZU1zZ1F1ZXVlICE9IG51bGwgJiYgc3Vic2NyaWJlTXNn\nUXVldWUuc2l6ZSgpID4gMCkgewogICAgICAgICAgICAgICAgaWYgKGxvZ2dl\nci5pc0RlYnVnRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGxvZ2dl\nci5kZWJ1ZygiQ29uc3VtaW5nICIgKyBzdWJzY3JpYmVNc2dRdWV1ZS5zaXpl\nKCkgKyAiIHF1ZXVlZCB1cCBtZXNzYWdlcyBmb3IgdG9waWM6ICIKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBvcmlnU3ViRGF0YS50b3Bp\nYy50b1N0cmluZ1V0ZjgoKSArICIsIHN1YnNjcmliZXJJZDogIgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICArIG9yaWdTdWJEYXRhLnN1YnNj\ncmliZXJJZC50b1N0cmluZ1V0ZjgoKSk7CiAgICAgICAgICAgICAgICBmb3Ig\nKE1lc3NhZ2UgbWVzc2FnZSA6IHN1YnNjcmliZU1zZ1F1ZXVlKSB7CiAgICAg\nICAgICAgICAgICAgICAgYXN5bmNNZXNzYWdlQ29uc3VtZShtZXNzYWdlKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIE5vdyB3ZSBj\nYW4gcmVtb3ZlIHRoZSBxdWV1ZWQgdXAgbWVzc2FnZXMgc2luY2UgdGhleSBh\ncmUgYWxsCiAgICAgICAgICAgICAgICAvLyBjb25zdW1lZC4KICAgICAgICAg\nICAgICAgIHN1YnNjcmliZU1zZ1F1ZXVlLmNsZWFyKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXR0ZXIgZm9y\nIHRoZSBNZXNzYWdlSGFuZGxlciB0aGF0IGlzIHNldCBmb3IgdGhpcyBzdWJz\nY3JpYmUgY2hhbm5lbC4KICAgICAqCiAgICAgKiBAcmV0dXJuIFRoZSBNZXNz\nYWdlSGFuZGxlciBmb3IgY29uc3VtaW5nIG1lc3NhZ2VzCiAgICAgKi8KICAg\nIHB1YmxpYyBNZXNzYWdlSGFuZGxlciBnZXRNZXNzYWdlSGFuZGxlcigpIHsK\nICAgICAgICByZXR1cm4gbWVzc2FnZUhhbmRsZXI7CiAgICB9Cn0K\n","encoding":"base64"}

