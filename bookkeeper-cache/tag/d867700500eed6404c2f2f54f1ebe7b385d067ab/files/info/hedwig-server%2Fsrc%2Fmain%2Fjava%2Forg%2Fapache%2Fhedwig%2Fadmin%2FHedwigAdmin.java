{"sha":"c0db83ad45c6d6eebbe5221346a34db32adfc9dd","node_id":"MDQ6QmxvYjE1NzU5NTY6YzBkYjgzYWQ0NWM2ZDZlZWJiZTUyMjEzNDZhMzRkYjMyYWRmYzlkZA==","size":13150,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/c0db83ad45c6d6eebbe5221346a34db32adfc9dd","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KCnBh\nY2thZ2Ugb3JnLmFwYWNoZS5oZWR3aWcuYWRtaW47CgppbXBvcnQgamF2YS51\ndGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRv\ncjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKCmltcG9ydCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY29uZi5DbGllbnRD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNs\naWVudC5CS0V4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tlZXBl\nci5jbGllbnQuQm9va0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jbGllbnQuQm9va0tlZXBlci5EaWdlc3RUeXBlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5ib29ra2VlcGVyLmNsaWVudC5MZWRnZXJIYW5kbGU7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5M\nZWRnZXJSYW5nZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29s\nLlB1YlN1YlByb3RvY29sLkxlZGdlclJhbmdlczsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2U7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJTdWJQcm90b2Nv\nbC5NZXNzYWdlU2VxSWQ7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90\nb2NvbC5QdWJTdWJQcm90b2NvbC5TdWJzY3JpcHRpb25TdGF0ZTsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvZXh0ZW5zaW9ucy5TdWJzY3JpcHRp\nb25TdGF0ZVV0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVy\nLmNvbW1vbi5TZXJ2ZXJDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcudXRpbC5IZWR3aWdTb2NrZXRBZGRyZXNzOwppbXBvcnQgb3Jn\nLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2VlcGVyRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlZEV2ZW50Owpp\nbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuem9va2VlcGVyLmRhdGEuU3RhdDsKCmltcG9ydCBjb20uZ29vZ2xlLnBy\nb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVm\nLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbjsKCi8qKgogKiBIZWR3\naWcgQWRtaW4KICovCnB1YmxpYyBjbGFzcyBIZWR3aWdBZG1pbiB7CiAgICBz\ndGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9n\nZ2VyKEhlZHdpZ0FkbWluLmNsYXNzKTsKCiAgICAvLyBOT1RFOiBub3cgaXQg\naXMgZml4ZWQgcGFzc3dkIHVzZWQgaW4gaGVkd2lnCiAgICBzdGF0aWMgYnl0\nZVtdIHBhc3N3ZCA9ICJzaWxseXNlY3JldCIuZ2V0Qnl0ZXMoKTsKCiAgICBw\ncm90ZWN0ZWQgWm9vS2VlcGVyIHprOwogICAgcHJvdGVjdGVkIEJvb2tLZWVw\nZXIgYms7CiAgICAvLyBodWIgY29uZmlndXJhdGlvbnMKICAgIHByb3RlY3Rl\nZCBTZXJ2ZXJDb25maWd1cmF0aW9uIHNlcnZlckNvbmY7CiAgICAvLyBib29r\na2VlcGVyIGNvbmZpZ3VyYXRpb25zCiAgICBwcm90ZWN0ZWQgQ2xpZW50Q29u\nZmlndXJhdGlvbiBia0NsaWVudENvbmY7CgogICAgLy8gRW1wdHkgd2F0Y2hl\ncgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgTXlXYXRjaGVyIGltcGxlbWVu\ndHMgV2F0Y2hlciB7CiAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRj\naGVkRXZlbnQgZXZlbnQpIHsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBIZWR3aWcgQWRtaW4gQ29uc3RydWN0b3IKICAgICAqCiAgICAgKiBA\ncGFyYW0gYmtDb25mCiAgICAgKiAgICAgICAgICBCb29rS2VlcGVyIENsaWVu\ndCBDb25maWd1cmF0aW9uLgogICAgICogQHBhcmFtIGh1YkNvbmYKICAgICAq\nICAgICAgICAgIEh1YiBTZXJ2ZXIgQ29uZmlndXJhdGlvbi4KICAgICAqIEB0\naHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBIZWR3aWdBZG1p\nbihDbGllbnRDb25maWd1cmF0aW9uIGJrQ29uZiwgU2VydmVyQ29uZmlndXJh\ndGlvbiBodWJDb25mKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0aGlz\nLnNlcnZlckNvbmYgPSBodWJDb25mOwogICAgICAgIHRoaXMuYmtDbGllbnRD\nb25mID0gYmtDb25mOwoKICAgICAgICAvLyBjb25uZWN0IHRvIHpvb2tlZXBl\ncgogICAgICAgIHprID0gbmV3IFpvb0tlZXBlcihodWJDb25mLmdldFprSG9z\ndCgpLCBodWJDb25mLmdldFprVGltZW91dCgpLCBuZXcgTXlXYXRjaGVyKCkp\nOwogICAgICAgIGlmIChMT0cuaXNEZWJ1Z0VuYWJsZWQoKSkgewogICAgICAg\nICAgICBMT0cuZGVidWcoIkNvbm5lY3RpbmcgdG8gem9va2VlcGVyICIgKyBo\ndWJDb25mLmdldFprSG9zdCgpICsgIiwgdGltZW91dCA9ICIKICAgICAgICAg\nICAgICAgICAgICArIGh1YkNvbmYuZ2V0WmtUaW1lb3V0KCkpOwogICAgICAg\nIH0KCiAgICAgICAgLy8gY29ubmVjdCB0byBib29ra2VlcGVyCiAgICAgICAg\nYmsgPSBuZXcgQm9va0tlZXBlcihia0NsaWVudENvbmYsIHprKTsKICAgICAg\nICBpZiAoTE9HLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgTE9H\nLmRlYnVnKCJDb25uZWN0aW5nIHRvIGJvb2trZWVwZXIiKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDbG9zZSB0aGUgaGVkd2lnIGFkbWlu\nLgogICAgICoKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgYmsuY2xvc2UoKTsKICAgICAgICB6ay5jbG9zZSgpOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHpvb2tlZXBlciBoYW5kbGUgdXNlZCBpbiBo\nZWR3aWcgYWRtaW4uCiAgICAgKgogICAgICogQHJldHVybiB6b29rZWVwZXIg\naGFuZGxlCiAgICAgKi8KICAgIHB1YmxpYyBab29LZWVwZXIgZ2V0WmtIYW5k\nbGUoKSB7CiAgICAgICAgcmV0dXJuIHprOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIGJvb2trZWVwZXIgaGFuZGxlIHVzZWQgaW4gaGVkd2lnIGFk\nbWluLgogICAgICoKICAgICAqIEByZXR1cm4gYm9va2tlZXBlciBoYW5kbGUK\nICAgICAqLwogICAgcHVibGljIEJvb2tLZWVwZXIgZ2V0QmtIYW5kbGUoKSB7\nCiAgICAgICAgcmV0dXJuIGJrOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGh1YiBzZXJ2ZXIgY29uZmlndXJhdGlvbiB1c2VkIGluIGhlZHdpZyBh\nZG1pbgogICAgICoKICAgICAqIEByZXR1cm4gaHViIHNlcnZlciBjb25maWd1\ncmF0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBTZXJ2ZXJDb25maWd1cmF0aW9u\nIGdldEh1YlNlcnZlckNvbmYoKSB7CiAgICAgICAgcmV0dXJuIHNlcnZlckNv\nbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYm9va2VlcGVyIHBh\nc3N3ZCB1c2VkIGluIGhlZHdpZyBhZG1pbgogICAgICoKICAgICAqIEByZXR1\ncm4gYm9va2VlcGVyIHBhc3N3ZAogICAgICovCiAgICBwdWJsaWMgYnl0ZVtd\nIGdldEJrUGFzc3dkKCkgewogICAgICAgIHJldHVybiBBcnJheXMuY29weU9m\nKHBhc3N3ZCwgcGFzc3dkLmxlbmd0aCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gZGlnZXN0IHR5cGUgdXNlZCBpbiBoZWR3aWcgYWRtaW4KICAg\nICAqCiAgICAgKiBAcmV0dXJuIGJvb2tlZXBlciBkaWdlc3QgdHlwZQogICAg\nICovCiAgICBwdWJsaWMgRGlnZXN0VHlwZSBnZXRCa0RpZ2VzdFR5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIERpZ2VzdFR5cGUuQ1JDMzI7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBEb3NlIHRvcGljIGV4aXN0PwogICAgICoKICAgICAqIEBw\nYXJhbSB0b3BpYwogICAgICogICAgICAgICAgICBUb3BpYyBuYW1lCiAgICAg\nKiBAcmV0dXJuIHdoZXRoZXIgdG9waWMgZXhpc3RzIG9yIG5vdD8KICAgICAq\nIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGhhc1RvcGljKEJ5dGVTdHJpbmcgdG9waWMpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIFN0cmluZyB0b3BpY1BhdGggPSBzZXJ2ZXJDb25mLmdldFpr\nVG9waWNQYXRoKG5ldyBTdHJpbmdCdWlsZGVyKCksIHRvcGljKS50b1N0cmlu\nZygpOwogICAgICAgIFN0YXQgc3RhdCA9IHprLmV4aXN0cyh0b3BpY1BhdGgs\nIGZhbHNlKTsKICAgICAgICByZXR1cm4gbnVsbCAhPSBzdGF0OwogICAgfQoK\nICAgIC8qKgogICAgICogR2V0IGF2YWlsYWJsZSBodWJzLgogICAgICoKICAg\nICAqIEByZXR1cm4gYXZhaWxhYmxlIGh1YnMgYW5kIHRoZWlyIGxvYWRzCiAg\nICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgTWFw\nPEhlZHdpZ1NvY2tldEFkZHJlc3MsIEludGVnZXI+IGdldEF2YWlsYWJsZUh1\nYnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgemtIdWJz\nUGF0aCA9IHNlcnZlckNvbmYuZ2V0WmtIb3N0c1ByZWZpeChuZXcgU3RyaW5n\nQnVpbGRlcigpKS50b1N0cmluZygpOwogICAgICAgIE1hcDxIZWR3aWdTb2Nr\nZXRBZGRyZXNzLCBJbnRlZ2VyPiBodWJzID0KICAgICAgICAgICAgbmV3IEhh\nc2hNYXA8SGVkd2lnU29ja2V0QWRkcmVzcywgSW50ZWdlcj4oKTsKICAgICAg\nICBMaXN0PFN0cmluZz4gaG9zdHMgPSB6ay5nZXRDaGlsZHJlbih6a0h1YnNQ\nYXRoLCBmYWxzZSk7CiAgICAgICAgZm9yIChTdHJpbmcgaG9zdCA6IGhvc3Rz\nKSB7CiAgICAgICAgICAgIFN0cmluZyB6a0h1YlBhdGggPSBzZXJ2ZXJDb25m\nLmdldFprSG9zdHNQcmVmaXgobmV3IFN0cmluZ0J1aWxkZXIoKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCIv\nIikuYXBwZW5kKGhvc3QpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIGludCBs\nb2FkID0gMDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFN0\nYXQgc3RhdCA9IG5ldyBTdGF0KCk7CiAgICAgICAgICAgICAgICBieXRlW10g\nZGF0YSA9IHprLmdldERhdGEoemtIdWJQYXRoLCBmYWxzZSwgc3RhdCk7CiAg\nICAgICAgICAgICAgICBpZiAoZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgbG9hZCA9IEludGVnZXIucGFyc2VJbnQobmV3IFN0cmluZyhk\nYXRhKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEtlZXBlckV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICAgICAgTE9HLndh\ncm4oIkNvdWxkbid0IHJlYWQgaHViIGRhdGEgZnJvbSBab29LZWVwZXIiLCBr\nZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9u\nIGllKSB7CiAgICAgICAgICAgICAgICBMT0cud2FybigiSW50ZXJydXB0ZWQg\nZHVyaW5nIHJlYWQiLCBpZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\naHVicy5wdXQobmV3IEhlZHdpZ1NvY2tldEFkZHJlc3MoaG9zdCksIGxvYWQp\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gaHViczsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdldCBsaXN0IG9mIHRvcGljcwogICAgICoKICAgICAqIEBy\nZXR1cm4gbGlzdCBvZiB0b3BpY3MKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9u\nCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0PFN0cmluZz4gZ2V0VG9waWNzKCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHprLmdldENoaWxk\ncmVuKHNlcnZlckNvbmYuZ2V0WmtUb3BpY3NQcmVmaXgobmV3IFN0cmluZ0J1\naWxkZXIoKSkudG9TdHJpbmcoKSwgZmFsc2UpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSB6bm9kZSBwYXRoIG9mIG93bmVyIG9mIGEgdG9w\naWMKICAgICAqCiAgICAgKiBAcGFyYW0gdG9waWMKICAgICAqICAgICAgICAg\nICAgVG9waWMgbmFtZQogICAgICogQHJldHVybiB6bm9kZSBwYXRoIG9mIG93\nbmVyIG9mIGEgdG9waWMKICAgICAqLwogICAgU3RyaW5nIGh1YlBhdGgoQnl0\nZVN0cmluZyB0b3BpYykgewogICAgICAgIHJldHVybiBzZXJ2ZXJDb25mLmdl\ndFprVG9waWNQYXRoKG5ldyBTdHJpbmdCdWlsZGVyKCksIHRvcGljKS5hcHBl\nbmQoIi9odWIiKS50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSB0b3BpYyBvd25lciBvZiBhIHRvcGljCiAgICAgKgogICAg\nICogQHBhcmFtIHRvcGljCiAgICAgKiAgICAgICAgICAgIFRvcGljIG5hbWUK\nICAgICAqIEByZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIG93bmVyIG9mIGEg\ndG9waWMKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1\nYmxpYyBIZWR3aWdTb2NrZXRBZGRyZXNzIGdldFRvcGljT3duZXIoQnl0ZVN0\ncmluZyB0b3BpYykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgU3RhdCBz\ndGF0ID0gbmV3IFN0YXQoKTsKICAgICAgICBieXRlW10gb3duZXIgPSBudWxs\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG93bmVyID0gemsuZ2V0RGF0\nYShodWJQYXRoKHRvcGljKSwgZmFsc2UsIHN0YXQpOwogICAgICAgIH0gY2F0\nY2ggKEtlZXBlckV4Y2VwdGlvbi5Ob05vZGVFeGNlcHRpb24gbm5lKSB7CiAg\nICAgICAgfQogICAgICAgIGlmIChudWxsID09IG93bmVyKSB7CiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3\nIEhlZHdpZ1NvY2tldEFkZHJlc3MobmV3IFN0cmluZyhvd25lcikpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB6bm9kZSBwYXRoIHRvIHN0\nb3JlIGxlZGdlcnMgaW5mbyBvZiBhIHRvcGljCiAgICAgKgogICAgICogQHBh\ncmFtIHRvcGljCiAgICAgKiAgICAgICAgICBUb3BpYyBuYW1lCiAgICAgKiBA\ncmV0dXJuIHpub2RlIHBhdGggdG8gc3RvcmUgbGVkZ2VycyBpbmZvIG9mIGEg\ndG9waWMKICAgICAqLwogICAgU3RyaW5nIGxlZGdlcnNQYXRoKEJ5dGVTdHJp\nbmcgdG9waWMpIHsKICAgICAgICByZXR1cm4gc2VydmVyQ29uZi5nZXRaa1Rv\ncGljUGF0aChuZXcgU3RyaW5nQnVpbGRlcigpLCB0b3BpYykuYXBwZW5kKCIv\nbGVkZ2VycyIpLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGxlZGdlciByYW5nZSBmb3JtaW5nIHRoZSB0b3BpYwogICAg\nICoKICAgICAqIEBwYXJhbSB0b3BpYwogICAgICogICAgICAgICAgVG9waWMg\nbmFtZQogICAgICogQHJldHVybiBsZWRnZXIgcmFuZ2VzIGZvcm1pbmcgdGhl\nIHRvcGljCiAgICAgKiBAdGhyb3dzIEV4Y2VwdGlvbgogICAgICovCiAgICBw\ndWJsaWMgTGlzdDxMZWRnZXJSYW5nZT4gZ2V0VG9waWNMZWRnZXJzKEJ5dGVT\ndHJpbmcgdG9waWMpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIExlZGdl\nclJhbmdlcyByYW5nZXMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIFN0YXQgc3RhdCA9IG5ldyBTdGF0KCk7CiAgICAgICAgICAgIGJ5dGVb\nXSBsZWRnZXJzRGF0YSA9IHprLmdldERhdGEobGVkZ2Vyc1BhdGgodG9waWMp\nLCBmYWxzZSwgc3RhdCk7CiAgICAgICAgICAgIGlmIChudWxsICE9IGxlZGdl\ncnNEYXRhKSB7CiAgICAgICAgICAgICAgICByYW5nZXMgPSBMZWRnZXJSYW5n\nZXMucGFyc2VGcm9tKGxlZGdlcnNEYXRhKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0gY2F0Y2ggKEtlZXBlckV4Y2VwdGlvbi5Ob05vZGVFeGNlcHRpb24g\nbm5lKSB7CiAgICAgICAgfQogICAgICAgIGlmIChudWxsID09IHJhbmdlcykg\newogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAg\nTGlzdDxMZWRnZXJSYW5nZT4gbHJzID0gcmFuZ2VzLmdldFJhbmdlc0xpc3Qo\nKTsKICAgICAgICBpZiAobHJzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBy\nZXR1cm4gbHJzOwogICAgICAgIH0KICAgICAgICAvLyB0cnkgdG8gY2hlY2sg\nbGFzdCBsZWRnZXIgKGl0IG1heSBzdGlsbCBvcGVuKQogICAgICAgIExlZGdl\nclJhbmdlIGxhc3RSYW5nZSA9IGxycy5nZXQobHJzLnNpemUoKSAtIDEpOwog\nICAgICAgIGlmIChsYXN0UmFuZ2UuaGFzRW5kU2VxSWRJbmNsdWRlZCgpKSB7\nCiAgICAgICAgICAgIHJldHVybiBscnM7CiAgICAgICAgfQogICAgICAgIC8v\nIHJlYWQgbGFzdCBjb25maXJtZWQgb2YgdGhlIG9wZW5lZCBsZWRnZXIKICAg\nICAgICB0cnkgewogICAgICAgICAgICBMaXN0PExlZGdlclJhbmdlPiBuZXdM\ncnMgPSBuZXcgQXJyYXlMaXN0PExlZGdlclJhbmdlPigpOwogICAgICAgICAg\nICBuZXdMcnMuYWRkQWxsKGxycyk7CiAgICAgICAgICAgIGxycyA9IG5ld0xy\nczsKICAgICAgICAgICAgTWVzc2FnZVNlcUlkIGxhc3RTZXFJZDsKICAgICAg\nICAgICAgaWYgKGxycy5zaXplKCkgPT0gMSkgewogICAgICAgICAgICAgICAg\nbGFzdFNlcUlkID0gTWVzc2FnZVNlcUlkLm5ld0J1aWxkZXIoKS5zZXRMb2Nh\nbENvbXBvbmVudCgxKS5idWlsZCgpOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgbGFzdFNlcUlkID0gbHJzLmdldChscnMuc2l6ZSgp\nIC0gMikuZ2V0RW5kU2VxSWRJbmNsdWRlZCgpOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIExlZGdlclJhbmdlIG5ld0xhc3RSYW5nZSA9IHJlZnJlc2hM\nYXN0TGVkZ2VyUmFuZ2UobGFzdFNlcUlkLCBsYXN0UmFuZ2UpOwogICAgICAg\nICAgICBscnMuc2V0KGxycy5zaXplKCkgLSAxLCBuZXdMYXN0UmFuZ2UpOwog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGUu\ncHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBs\ncnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWZyZXNoIGxhc3QgbGVkZ2Vy\nIHJhbmdlIHRvIGdldCBsYXN0Q29uZmlybWVkIGVudHJ5LCB3aGljaCBtYWtl\nIGl0IGF2YWlsYWJsZSB0byByZWFkCiAgICAgKgogICAgICogQHBhcmFtIGxh\nc3RTZXFJZAogICAgICogICAgICAgICAgICBMYXN0IHNlcXVlbmNlIGlkIG9m\nIHByZXZpb3VzIGxlZGdlcgogICAgICogQHBhcmFtIG9sZFJhbmdlCiAgICAg\nKiAgICAgICAgICAgIExlZGdlciByYW5nZSB0byBzZXQgbGFzdENvbmZpcm1l\nZCBlbnRyeQogICAgICovCiAgICBMZWRnZXJSYW5nZSByZWZyZXNoTGFzdExl\nZGdlclJhbmdlKE1lc3NhZ2VTZXFJZCBsYXN0U2VxSWQsIExlZGdlclJhbmdl\nIG9sZFJhbmdlKQogICAgICAgIHRocm93cyBCS0V4Y2VwdGlvbiwgS2VlcGVy\nRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgTGVk\nZ2VySGFuZGxlIGxoID0gYmsub3BlbkxlZGdlck5vUmVjb3Zlcnkob2xkUmFu\nZ2UuZ2V0TGVkZ2VySWQoKSwgRGlnZXN0VHlwZS5DUkMzMiwgcGFzc3dkKTsK\nICAgICAgICBsb25nIGxhc3RDb25maXJtZWQgPSBsaC5yZWFkTGFzdENvbmZp\ncm1lZCgpOwogICAgICAgIE1lc3NhZ2VTZXFJZCBuZXdTZXFJZCA9IE1lc3Nh\nZ2VTZXFJZC5uZXdCdWlsZGVyKCkubWVyZ2VGcm9tKGxhc3RTZXFJZCkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0TG9jYWxDb21wb25l\nbnQobGFzdFNlcUlkLmdldExvY2FsQ29tcG9uZW50KCkgKyBsYXN0Q29uZmly\nbWVkKS5idWlsZCgpOwogICAgICAgIHJldHVybiBMZWRnZXJSYW5nZS5uZXdC\ndWlsZGVyKCkubWVyZ2VGcm9tKG9sZFJhbmdlKS5zZXRFbmRTZXFJZEluY2x1\nZGVkKG5ld1NlcUlkKS5idWlsZCgpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSB6bm9kZSBwYXRoIHN0b3JlIGFsbCB0aGUgc3Vic2NyaWJl\ncnMgb2YgYSB0b3BpYy4KICAgICAqCiAgICAgKiBAcGFyYW0gc2IKICAgICAq\nICAgICAgICAgIFN0cmluZyBidWlsZGVyIHRvIGhvbGQgdGhlIHpub2RlIHBh\ndGgKICAgICAqIEBwYXJhbSB0b3BpYwogICAgICogICAgICAgICAgVG9waWMg\nbmFtZQogICAgICovCiAgICBwcml2YXRlIFN0cmluZ0J1aWxkZXIgdG9waWNT\ndWJzY3JpYmVyc1BhdGgoU3RyaW5nQnVpbGRlciBzYiwgQnl0ZVN0cmluZyB0\nb3BpYykgewogICAgICAgIHJldHVybiBzZXJ2ZXJDb25mLmdldFprVG9waWNQ\nYXRoKHNiLCB0b3BpYykuYXBwZW5kKCIvc3Vic2NyaWJlcnMiKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgem5vZGUgcGF0aCBvZiBhIHN1\nYnNjcmliZXIgb2YgYSB0b3BpYy4KICAgICAqCiAgICAgKiBAcGFyYW0gdG9w\naWMKICAgICAqICAgICAgICAgIFRvcGljIG5hbWUKICAgICAqIEBwYXJhbSBz\ndWJzY3JpYmVyCiAgICAgKiAgICAgICAgICBTdWJzY3JpYmVyIG5hbWUKICAg\nICAqLwoKICAgIHByaXZhdGUgU3RyaW5nIHRvcGljU3Vic2NyaWJlclBhdGgo\nQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3JpYmVyKSB7CiAg\nICAgICAgcmV0dXJuIHRvcGljU3Vic2NyaWJlcnNQYXRoKG5ldyBTdHJpbmdC\ndWlsZGVyKCksIHRvcGljKS5hcHBlbmQoIi8iKQogICAgICAgICAgICAgICAu\nYXBwZW5kKHN1YnNjcmliZXIudG9TdHJpbmdVdGY4KCkpLnRvU3RyaW5nKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gc3Vic2NyaXB0aW9ucyBv\nZiBhIHRvcGljCiAgICAgKgogICAgICogQHBhcmFtIHRvcGljCiAgICAgKiAg\nICAgICAgICBUb3BpYyBuYW1lCiAgICAgKiBAcmV0dXJuIHN1YnNjcmlwdGlv\nbnMgb2YgYSB0b3BpYwogICAgICogQHRocm93cyBFeGNlcHRpb24KICAgICAq\nLwogICAgcHVibGljIE1hcDxCeXRlU3RyaW5nLCBTdWJzY3JpcHRpb25TdGF0\nZT4gZ2V0VG9waWNTdWJzY3JpcHRpb25zKEJ5dGVTdHJpbmcgdG9waWMpCiAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgTWFwPEJ5dGVTdHJp\nbmcsIFN1YnNjcmlwdGlvblN0YXRlPiBzdGF0ZXMgPQogICAgICAgICAgICBu\nZXcgSGFzaE1hcDxCeXRlU3RyaW5nLCBTdWJzY3JpcHRpb25TdGF0ZT4oKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmcgc3Vic1BhdGggPSB0\nb3BpY1N1YnNjcmliZXJzUGF0aChuZXcgU3RyaW5nQnVpbGRlcigpLCB0b3Bp\nYykudG9TdHJpbmcoKTsKICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGNoaWxk\ncmVuID0gemsuZ2V0Q2hpbGRyZW4oc3Vic1BhdGgsIGZhbHNlKTsKICAgICAg\nICAgICAgZm9yIChTdHJpbmcgY2hpbGQgOiBjaGlsZHJlbikgewogICAgICAg\nICAgICAgICAgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQgPSBCeXRlU3RyaW5n\nLmNvcHlGcm9tVXRmOChjaGlsZCk7CiAgICAgICAgICAgICAgICBTdHJpbmcg\nc3ViUGF0aCA9IHRvcGljU3Vic2NyaWJlclBhdGgodG9waWMsIHN1YnNjcmli\nZXJJZCk7CiAgICAgICAgICAgICAgICBTdGF0IHN0YXQgPSBuZXcgU3RhdCgp\nOwogICAgICAgICAgICAgICAgYnl0ZVtdIHN1YkRhdGEgPSB6ay5nZXREYXRh\nKHN1YlBhdGgsIGZhbHNlLCBzdGF0KTsKICAgICAgICAgICAgICAgIGlmIChu\ndWxsID09IHN1YkRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFN1YnNjcmlw\ndGlvblN0YXRlIHN0YXRlID0gU3Vic2NyaXB0aW9uU3RhdGUucGFyc2VGcm9t\nKHN1YkRhdGEpOwogICAgICAgICAgICAgICAgc3RhdGVzLnB1dChzdWJzY3Jp\nYmVySWQsIHN0YXRlKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2gg\nKEtlZXBlckV4Y2VwdGlvbi5Ob05vZGVFeGNlcHRpb24gbm5lKSB7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBzdGF0ZXM7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gc3Vic2NyaXB0aW9uIHN0YXRlIG9mIGEgc3Vic2NyaWJl\nciBvZiB0b3BpYwogICAgICoKICAgICAqIEBwYXJhbSB0b3BpYwogICAgICog\nICAgICAgICAgVG9waWMgbmFtZQogICAgICogQHBhcmFtIHN1YnNjcmliZXIK\nICAgICAqICAgICAgICAgIFN1YnNjcmliZXIgbmFtZQogICAgICogQHJldHVy\nbiBzdWJzY3JpcHRpb24gc3RhdGUKICAgICAqIEB0aHJvd3MgRXhjZXB0aW9u\nCiAgICAgKi8KICAgIHB1YmxpYyBTdWJzY3JpcHRpb25TdGF0ZSBnZXRTdWJz\nY3JpcHRpb24oQnl0ZVN0cmluZyB0b3BpYywgQnl0ZVN0cmluZyBzdWJzY3Jp\nYmVyKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgc3ViUGF0\naCA9IHRvcGljU3Vic2NyaWJlclBhdGgodG9waWMsIHN1YnNjcmliZXIpOwog\nICAgICAgIFN0YXQgc3RhdCA9IG5ldyBTdGF0KCk7CiAgICAgICAgYnl0ZVtd\nIHN1YkRhdGEgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN1\nYkRhdGEgPSB6ay5nZXREYXRhKHN1YlBhdGgsIGZhbHNlLCBzdGF0KTsKICAg\nICAgICB9IGNhdGNoIChLZWVwZXJFeGNlcHRpb24uTm9Ob2RlRXhjZXB0aW9u\nIG5uZSkgewogICAgICAgIH0KICAgICAgICBpZiAobnVsbCA9PSBzdWJEYXRh\nKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gU3Vic2NyaXB0aW9uU3RhdGUucGFyc2VGcm9tKHN1YkRhdGEp\nOwogICAgfQp9Cg==\n","encoding":"base64"}

