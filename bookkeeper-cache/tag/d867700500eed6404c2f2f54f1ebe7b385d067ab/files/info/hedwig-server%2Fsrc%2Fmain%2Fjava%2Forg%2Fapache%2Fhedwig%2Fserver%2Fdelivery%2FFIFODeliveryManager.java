{"sha":"0a47ad5e7744bc5457a141659d541b4a6962fe7d","node_id":"MDQ6QmxvYjE1NzU5NTY6MGE0N2FkNWU3NzQ0YmM1NDU3YTE0MTY1OWQ1NDFiNGE2OTYyZmU3ZA==","size":20904,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/0a47ad5e7744bc5457a141659d541b4a6962fe7d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuZGVsaXZlcnk7CgppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUXVl\ndWU7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLlNv\ncnRlZE1hcDsKaW1wb3J0IGphdmEudXRpbC5UcmVlTWFwOwppbXBvcnQgamF2\nYS51dGlsLmNvbmN1cnJlbnQuQmxvY2tpbmdRdWV1ZTsKaW1wb3J0IGphdmEu\ndXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRMaW5rZWRRdWV1ZTsKaW1wb3J0\nIGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2NraW5nUXVldWU7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdDsKCmltcG9ydCBv\ncmcuc2xmNGouTG9nZ2VyOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlckZhY3Rv\ncnk7CgppbXBvcnQgY29tLmdvb2dsZS5wcm90b2J1Zi5CeXRlU3RyaW5nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmRhdGEuVG9waWNTdWJz\nY3JpYmVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnByb3RvY29sLlB1YlN1YlByb3RvY29sLk1lc3NhZ2VTZXFJZDsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3RvY29sLlBy\nb3RvY29sVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3Rv\nY29sLlB1YlN1YlByb3RvY29sLlB1YlN1YlJlc3BvbnNlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3RhdHVz\nQ29kZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24u\nU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnNlcnZlci5jb21tb24uVW5leHBlY3RlZEVycm9yOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLm5ldHR5LlNlcnZlclN0YXRzOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLkZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2Uu\nTWFwTWV0aG9kczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5w\nZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuU2NhbkNhbGxiYWNrOwpp\nbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3RlbmNlLlNj\nYW5SZXF1ZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnN1\nYnNjcmlwdGlvbnMuTWVzc2FnZUZpbHRlcjsKCnB1YmxpYyBjbGFzcyBGSUZP\nRGVsaXZlcnlNYW5hZ2VyIGltcGxlbWVudHMgUnVubmFibGUsIERlbGl2ZXJ5\nTWFuYWdlciB7CgogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBMb2dnZXIg\nbG9nZ2VyID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoRklGT0RlbGl2ZXJ5\nTWFuYWdlci5jbGFzcyk7CgogICAgcHJvdGVjdGVkIGludGVyZmFjZSBEZWxp\ndmVyeU1hbmFnZXJSZXF1ZXN0IHsKICAgICAgICBwdWJsaWMgdm9pZCBwZXJm\nb3JtUmVxdWVzdCgpOwogICAgfQoKICAgIC8qKgogICAgICogdGhlIG1haW4g\ncXVldWUgdGhhdCB0aGUgc2luZ2xlLXRocmVhZGVkIGRlbGl2ZXJ5IG1hbmFn\nZXIgd29ya3Mgb2ZmIG9mCiAgICAgKi8KICAgIEJsb2NraW5nUXVldWU8RGVs\naXZlcnlNYW5hZ2VyUmVxdWVzdD4gcmVxdWVzdFF1ZXVlID0gbmV3IExpbmtl\nZEJsb2NraW5nUXVldWU8RGVsaXZlcnlNYW5hZ2VyUmVxdWVzdD4oKTsKCiAg\nICAvKioKICAgICAqIFRoZSBxdWV1ZSBvZiBhbGwgc3Vic2NyaXB0aW9ucyB0\naGF0IGFyZSBmYWNpbmcgYSB0cmFuc2llbnQgZXJyb3IgZWl0aGVyCiAgICAg\nKiBpbiBzY2FubmluZyBmcm9tIHRoZSBwZXJzaXN0ZW5jZSBtYW5hZ2VyLCBv\nciBpbiBzZW5kaW5nIHRvIHRoZSBjb25zdW1lcgogICAgICovCiAgICBRdWV1\nZTxBY3RpdmVTdWJzY3JpYmVyU3RhdGU+IHJldHJ5UXVldWUgPSBuZXcgQ29u\nY3VycmVudExpbmtlZFF1ZXVlPEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4oKTsK\nCiAgICAvKioKICAgICAqIFN0b3JlcyBhIG1hcHBpbmcgZnJvbSB0b3BpYyB0\nbyB0aGUgZGVsaXZlcnkgcG9pbnRlcnMgb24gdGhlIHRvcGljLiBUaGUKICAg\nICAqIGRlbGl2ZXJ5IHBvaW50ZXJzIGFyZSBzdG9yZWQgaW4gYSBzb3J0ZWQg\nbWFwIGZyb20gc2VxLWlkIHRvIHRoZSBzZXQgb2YKICAgICAqIHN1YnNjcmli\nZXJzIGF0IHRoYXQgc2VxLWlkCiAgICAgKi8KICAgIE1hcDxCeXRlU3RyaW5n\nLCBTb3J0ZWRNYXA8TG9uZywgU2V0PEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4+\nPiBwZXJUb3BpY0RlbGl2ZXJ5UHRyczsKCiAgICAvKioKICAgICAqIE1hcHBp\nbmcgZnJvbSBkZWxpdmVyeSBlbmQgcG9pbnQgdG8gdGhlIHN1YnNjcmliZXIg\nc3RhdGUgdGhhdCB3ZSBhcmUKICAgICAqIHNlcnZpbmcgYXQgdGhhdCBlbmQg\ncG9pbnQuIFRoaXMgcHJldmVudHMgdXMgZS5nLiwgZnJvbSBzZXJ2aW5nIHR3\nbwogICAgICogc3Vic2NyaXB0aW9ucyB0byB0aGUgc2FtZSBlbmRwb2ludAog\nICAgICovCiAgICBNYXA8VG9waWNTdWJzY3JpYmVyLCBBY3RpdmVTdWJzY3Jp\nYmVyU3RhdGU+IHN1YnNjcmliZXJTdGF0ZXM7CgogICAgcHJpdmF0ZSBQZXJz\naXN0ZW5jZU1hbmFnZXIgcGVyc2lzdGVuY2VNZ3I7CgogICAgcHJpdmF0ZSBT\nZXJ2ZXJDb25maWd1cmF0aW9uIGNmZzsKCiAgICAvLyBCb29sZWFuIGluZGlj\nYXRpbmcgaWYgdGhpcyB0aHJlYWQgc2hvdWxkIGNvbnRpbnVlIHJ1bm5pbmcu\nIFRoaXMgaXMgdXNlZAogICAgLy8gd2hlbiB3ZSB3YW50IHRvIHN0b3AgdGhl\nIHRocmVhZCBkdXJpbmcgYSBQdWJTdWJTZXJ2ZXIgc2h1dGRvd24uCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBrZWVwUnVubmluZyA9IHRydWU7CiAgICBwcml2\nYXRlIGZpbmFsIFRocmVhZCB3b3JrZXJUaHJlYWQ7CgogICAgcHVibGljIEZJ\nRk9EZWxpdmVyeU1hbmFnZXIoUGVyc2lzdGVuY2VNYW5hZ2VyIHBlcnNpc3Rl\nbmNlTWdyLCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNmZykgewogICAgICAgIHRo\naXMucGVyc2lzdGVuY2VNZ3IgPSBwZXJzaXN0ZW5jZU1ncjsKICAgICAgICBw\nZXJUb3BpY0RlbGl2ZXJ5UHRycyA9IG5ldyBIYXNoTWFwPEJ5dGVTdHJpbmcs\nIFNvcnRlZE1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4+\nKCk7CiAgICAgICAgc3Vic2NyaWJlclN0YXRlcyA9IG5ldyBIYXNoTWFwPFRv\ncGljU3Vic2NyaWJlciwgQWN0aXZlU3Vic2NyaWJlclN0YXRlPigpOwogICAg\nICAgIHdvcmtlclRocmVhZCA9IG5ldyBUaHJlYWQodGhpcywgIkRlbGl2ZXJ5\nTWFuYWdlclRocmVhZCIpOwogICAgICAgIHRoaXMuY2ZnID0gY2ZnOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0KCkgewogICAgICAgIHdvcmtlclRo\ncmVhZC5zdGFydCgpOwogICAgfQoKICAgIC8qKgogICAgICogPT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09IE91cgogICAgICogdXN1YWwgZW5xdWV1ZSBmdW5j\ndGlvbiwgc3RvcCBpZiBlcnJvciBiZWNhdXNlIG9mIHVuYm91bmRlZCBxdWV1\nZSwgc2hvdWxkCiAgICAgKiBuZXZlciBoYXBwZW4KICAgICAqCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIGVucXVldWVXaXRob3V0RmFpbHVyZShEZWxp\ndmVyeU1hbmFnZXJSZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAgICBpZiAoIXJl\ncXVlc3RRdWV1ZS5vZmZlcihyZXF1ZXN0KSkgewogICAgICAgICAgICB0aHJv\ndyBuZXcgVW5leHBlY3RlZEVycm9yKCJDb3VsZCBub3QgZW5xdWV1ZSBvYmpl\nY3Q6ICIgKyByZXF1ZXN0ICsgIiB0byBkZWxpdmVyeSBtYW5hZ2VyIHJlcXVl\nc3QgcXVldWUuIik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT0KICAgICAqIFB1YmxpYyBpbnRlcmZh\nY2Ugb2YgdGhlIGRlbGl2ZXJ5IG1hbmFnZXIKICAgICAqLwoKICAgIC8qKgog\nICAgICogVGVsbHMgdGhlIGRlbGl2ZXJ5IG1hbmFnZXIgdG8gc3RhcnQgc2Vu\nZGluZyBvdXQgbWVzc2FnZXMgZm9yIGEgcGFydGljdWxhcgogICAgICogc3Vi\nc2NyaXB0aW9uCiAgICAgKgogICAgICogQHBhcmFtIHRvcGljCiAgICAgKiBA\ncGFyYW0gc3Vic2NyaWJlcklkCiAgICAgKiBAcGFyYW0gc2VxSWRUb1N0YXJ0\nRnJvbQogICAgICogICAgICAgICAgICBNZXNzYWdlIHNlcXVlbmNlLWlkIGZy\nb20gd2hlcmUgZGVsaXZlcnkgc2hvdWxkIGJlIHN0YXJ0ZWQKICAgICAqIEBw\nYXJhbSBlbmRQb2ludAogICAgICogICAgICAgICAgICBUaGUgZGVsaXZlcnkg\nZW5kIHBvaW50IHRvIHdoaWNoIHNlbmQgbWVzc2FnZXMgdG8KICAgICAqIEBw\nYXJhbSBmaWx0ZXIKICAgICAqICAgICAgICAgICAgT25seSBtZXNzYWdlcyBw\nYXNzaW5nIHRoaXMgZmlsdGVyIHNob3VsZCBiZSBzZW50IHRvIHRoaXMKICAg\nICAqICAgICAgICAgICAgc3Vic2NyaWJlcgogICAgICogQHBhcmFtIGlzSHVi\nU3Vic2NyaWJlcgogICAgICogICAgICAgICAgICBUaGVyZSBhcmUgc29tZSBz\nZXEtaWQgaW50cmljYWNpZXMuIFRvIGEgaHViIHN1YnNjcmliZXIsIHdlCiAg\nICAgKiAgICAgICAgICAgIHNob3VsZCBzZW5kIG9ubHkgYSBzdWJzZXQgb2Yg\ndGhlIHNlcS1pZCB2ZWN0b3IKICAgICAqLwogICAgcHVibGljIHZvaWQgc3Rh\ncnRTZXJ2aW5nU3Vic2NyaXB0aW9uKEJ5dGVTdHJpbmcgdG9waWMsIEJ5dGVT\ndHJpbmcgc3Vic2NyaWJlcklkLCBNZXNzYWdlU2VxSWQgc2VxSWRUb1N0YXJ0\nRnJvbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBEZWxpdmVyeUVuZFBvaW50IGVuZFBvaW50LCBNZXNzYWdlRmlsdGVyIGZp\nbHRlciwgYm9vbGVhbiBpc0h1YlN1YnNjcmliZXIpIHsKCiAgICAgICAgQWN0\naXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXIgPSBuZXcgQWN0aXZlU3Vi\nc2NyaWJlclN0YXRlKHRvcGljLCBzdWJzY3JpYmVySWQsIHNlcUlkVG9TdGFy\ndEZyb20KICAgICAgICAgICAgICAgIC5nZXRMb2NhbENvbXBvbmVudCgpIC0g\nMSwgZW5kUG9pbnQsIGZpbHRlciwgaXNIdWJTdWJzY3JpYmVyKTsKCiAgICAg\nICAgZW5xdWV1ZVdpdGhvdXRGYWlsdXJlKHN1YnNjcmliZXIpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHN0b3BTZXJ2aW5nU3Vic2NyaWJlcihCeXRlU3Ry\naW5nIHRvcGljLCBCeXRlU3RyaW5nIHN1YnNjcmliZXJJZCkgewogICAgICAg\nIEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBzdWJTdGF0ZSA9IHN1YnNjcmliZXJT\ndGF0ZXMuZ2V0KG5ldyBUb3BpY1N1YnNjcmliZXIodG9waWMsIHN1YnNjcmli\nZXJJZCkpOwoKICAgICAgICBpZiAoc3ViU3RhdGUgIT0gbnVsbCkgewogICAg\nICAgICAgICBzdG9wU2VydmluZ1N1YnNjcmliZXIoc3ViU3RhdGUpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIER1ZSB0byBzb21lIGVycm9y\nIG9yIGRpc2Nvbm5lY3Rpb24gb3IgdW5zdXNiY3JpYmUsIHNvbWVvbmUgYXNr\ncyB1cyB0bwogICAgICogc3RvcCBzZXJ2aW5nIGEgcGFydGljdWxhciBlbmRw\nb2ludAogICAgICoKICAgICAqIEBwYXJhbSBlbmRQb2ludAogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBzdG9wU2VydmluZ1N1YnNjcmliZXIoQWN0aXZl\nU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXIpIHsKICAgICAgICBlbnF1ZXVl\nV2l0aG91dEZhaWx1cmUobmV3IFN0b3BTZXJ2aW5nU3Vic2NyaWJlcihzdWJz\nY3JpYmVyKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnN0cnVjdHMgdGhl\nIGRlbGl2ZXJ5IG1hbmFnZXIgdG8gYmFja29mZiBvbiB0aGUgZ2l2ZW4gc3Vi\nc2NyaWJlciBhbmQKICAgICAqIHJldHJ5IHNlbmRpbmcgYWZ0ZXIgc29tZSB0\naW1lCiAgICAgKgogICAgICogQHBhcmFtIHN1YnNjcmliZXIKICAgICAqLwoK\nICAgIHB1YmxpYyB2b2lkIHJldHJ5RXJyb3JlZFN1YnNjcmliZXJBZnRlckRl\nbGF5KEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBzdWJzY3JpYmVyKSB7CgogICAg\nICAgIHN1YnNjcmliZXIuc2V0TGFzdFNjYW5FcnJvclRpbWUoU3lzdGVtLmN1\ncnJlbnRUaW1lTWlsbGlzKCkpOwoKICAgICAgICBpZiAoIXJldHJ5UXVldWUu\nb2ZmZXIoc3Vic2NyaWJlcikpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFVu\nZXhwZWN0ZWRFcnJvcigiQ291bGQgbm90IGVucXVldWUgdG8gZGVsaXZlcnkg\nbWFuYWdlciByZXRyeSBxdWV1ZSIpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIEluc3RydWN0cyB0aGUgZGVsaXZlcnkgbWFuYWdlciB0byBt\nb3ZlIHRoZSBkZWxpdmVyeSBwb2ludGVyIGZvciBhIGdpdmVuCiAgICAgKiBz\ndWJzY3JpYmVyCiAgICAgKgogICAgICogQHBhcmFtIHN1YnNjcmliZXIKICAg\nICAqIEBwYXJhbSBwcmV2U2VxSWQKICAgICAqIEBwYXJhbSBuZXdTZXFJZAog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBtb3ZlRGVsaXZlcnlQdHJGb3J3YXJk\nKEFjdGl2ZVN1YnNjcmliZXJTdGF0ZSBzdWJzY3JpYmVyLCBsb25nIHByZXZT\nZXFJZCwgbG9uZyBuZXdTZXFJZCkgewogICAgICAgIGVucXVldWVXaXRob3V0\nRmFpbHVyZShuZXcgRGVsaXZlcnlQdHJNb3ZlKHN1YnNjcmliZXIsIHByZXZT\nZXFJZCwgbmV3U2VxSWQpKTsKICAgIH0KCiAgICAvKgogICAgICogPT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT0KICAgICAqID09IEVuZCBvZiBwdWJs\naWMgaW50ZXJmYWNlLCBpbnRlcm5hbCBtYWNoaW5lcnkgYmVnaW5zLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgd2hpbGUgKGtl\nZXBSdW5uaW5nKSB7CiAgICAgICAgICAgIERlbGl2ZXJ5TWFuYWdlclJlcXVl\nc3QgcmVxdWVzdCA9IG51bGw7CgogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgLy8gV2UgdXNlIGEgdGltZW91dCBvZiAxIHNlY29uZCwgc28g\ndGhhdCB3ZSBjYW4gd2FrZSB1cCBvbmNlIGluCiAgICAgICAgICAgICAgICAv\nLyBhIHdoaWxlIHRvIGNoZWNrIGlmIHRoZXJlIGlzIHNvbWV0aGluZyBpbiB0\naGUgcmV0cnkgcXVldWUuCiAgICAgICAgICAgICAgICByZXF1ZXN0ID0gcmVx\ndWVzdFF1ZXVlLnBvbGwoMSwgVGltZVVuaXQuU0VDT05EUyk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEZpcnN0IHJldHJ5IGFu\neSBzdWJzY3JpcHRpb25zIHRoYXQgaGFkIGZhaWxlZCBhbmQgbmVlZCBhIHJl\ndHJ5CiAgICAgICAgICAgIHJldHJ5RXJyb3JlZFN1YnNjcmliZXJzKCk7Cgog\nICAgICAgICAgICBpZiAocmVxdWVzdCA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVx\ndWVzdC5wZXJmb3JtUmVxdWVzdCgpOwoKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTdG9wIG1ldGhvZCB3aGljaCB3aWxsIGVucXVldWUgYSBT\naHV0ZG93bkRlbGl2ZXJ5TWFuYWdlclJlcXVlc3QuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHN0b3AoKSB7CiAgICAgICAgZW5xdWV1ZVdpdGhvdXRGYWls\ndXJlKG5ldyBTaHV0ZG93bkRlbGl2ZXJ5TWFuYWdlclJlcXVlc3QoKSk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgcmV0cnlFcnJvcmVkU3Vic2NyaWJl\ncnMoKSB7CiAgICAgICAgbG9uZyBsYXN0SW50ZXJlc3RpbmdGYWlsdXJlVGlt\nZSA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpIC0gY2ZnLmdldFNjYW5C\nYWNrb2ZmUGVyaW9kTXMoKTsKICAgICAgICBBY3RpdmVTdWJzY3JpYmVyU3Rh\ndGUgc3Vic2NyaWJlcjsKCiAgICAgICAgd2hpbGUgKChzdWJzY3JpYmVyID0g\ncmV0cnlRdWV1ZS5wZWVrKCkpICE9IG51bGwpIHsKICAgICAgICAgICAgaWYg\nKHN1YnNjcmliZXIuZ2V0TGFzdFNjYW5FcnJvclRpbWUoKSA+IGxhc3RJbnRl\ncmVzdGluZ0ZhaWx1cmVUaW1lKSB7CiAgICAgICAgICAgICAgICAvLyBOb3Qg\nZW5vdWdoIHRpbWUgaGFzIGVsYXBzZWQgeWV0LCB3aWxsIHJldHJ5IGxhdGVy\nCiAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGUgcXVldWUgaXMgZmlmbywg\nbm8gbmVlZCB0byBjaGVjayBsYXRlciBpdGVtcwogICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyByZXRyeSBu\nb3cKICAgICAgICAgICAgc3Vic2NyaWJlci5kZWxpdmVyTmV4dE1lc3NhZ2Uo\nKTsKICAgICAgICAgICAgcmV0cnlRdWV1ZS5wb2xsKCk7CiAgICAgICAgfQog\nICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHJlbW92ZURlbGl2ZXJ5UHRyKEFj\ndGl2ZVN1YnNjcmliZXJTdGF0ZSBzdWJzY3JpYmVyLCBMb25nIHNlcUlkLCBi\nb29sZWFuIGlzQWJzZW5jZU9rLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgYm9vbGVhbiBwcnVuZVRvcGljKSB7CgogICAgICAgIGFz\nc2VydCBzZXFJZCAhPSBudWxsOwoKICAgICAgICAvLyByZW1vdmUgdGhpcyBz\ndWJzY3JpYmVyIGZyb20gdGhlIGRlbGl2ZXJ5IHBvaW50ZXJzIGRhdGEgc3Ry\ndWN0dXJlCiAgICAgICAgQnl0ZVN0cmluZyB0b3BpYyA9IHN1YnNjcmliZXIu\nZ2V0VG9waWMoKTsKICAgICAgICBTb3J0ZWRNYXA8TG9uZywgU2V0PEFjdGl2\nZVN1YnNjcmliZXJTdGF0ZT4+IGRlbGl2ZXJ5UHRycyA9IHBlclRvcGljRGVs\naXZlcnlQdHJzLmdldCh0b3BpYyk7CgogICAgICAgIGlmIChkZWxpdmVyeVB0\ncnMgPT0gbnVsbCAmJiAhaXNBYnNlbmNlT2spIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IFVuZXhwZWN0ZWRFcnJvcigiTm8gZGVsaXZlcnkgcG9pbnRlcnMg\nZm91bmQgd2hpbGUgZGlzY29ubmVjdGluZyAiICsgImNoYW5uZWwgZm9yIHRv\ncGljOiIgKyB0b3BpYyk7CiAgICAgICAgfQoKICAgICAgICBpZihudWxsID09\nIGRlbGl2ZXJ5UHRycykgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nfQoKICAgICAgICBpZiAoIU1hcE1ldGhvZHMucmVtb3ZlRnJvbU11bHRpTWFw\nKGRlbGl2ZXJ5UHRycywgc2VxSWQsIHN1YnNjcmliZXIpICYmICFpc0Fic2Vu\nY2VPaykgewoKICAgICAgICAgICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRFcnJv\ncigiQ291bGQgbm90IGZpbmQgc3Vic2NyaWJlcjoiICsgc3Vic2NyaWJlciAr\nICIgYXQgdGhlIGV4cGVjdGVkIGRlbGl2ZXJ5IHBvaW50ZXIiKTsKICAgICAg\nICB9CgogICAgICAgIGlmIChwcnVuZVRvcGljICYmIGRlbGl2ZXJ5UHRycy5p\nc0VtcHR5KCkpIHsKICAgICAgICAgICAgcGVyVG9waWNEZWxpdmVyeVB0cnMu\ncmVtb3ZlKHRvcGljKTsKICAgICAgICB9CgogICAgfQoKICAgIHByb3RlY3Rl\nZCBsb25nIGdldE1pbmltdW1TZXFJZChCeXRlU3RyaW5nIHRvcGljKSB7CiAg\nICAgICAgU29ydGVkTWFwPExvbmcsIFNldDxBY3RpdmVTdWJzY3JpYmVyU3Rh\ndGU+PiBkZWxpdmVyeVB0cnMgPSBwZXJUb3BpY0RlbGl2ZXJ5UHRycy5nZXQo\ndG9waWMpOwoKICAgICAgICBpZiAoZGVsaXZlcnlQdHJzID09IG51bGwgfHwg\nZGVsaXZlcnlQdHJzLmlzRW1wdHkoKSkgewogICAgICAgICAgICByZXR1cm4g\nTG9uZy5NQVhfVkFMVUUgLSAxOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nZGVsaXZlcnlQdHJzLmZpcnN0S2V5KCk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIHZvaWQgYWRkRGVsaXZlcnlQdHIoQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1\nYnNjcmliZXIsIExvbmcgc2VxSWQpIHsKCiAgICAgICAgLy8gSWYgdGhpcyB0\nb3BpYyBkb2Vzbid0IGV4aXN0IGluIHRoZSBwZXItdG9waWMgZGVsaXZlcnkg\ncG9pbnRlcnMgdGFibGUsCiAgICAgICAgLy8gY3JlYXRlIGFuIGVudHJ5IGZv\nciBpdAogICAgICAgIFNvcnRlZE1hcDxMb25nLCBTZXQ8QWN0aXZlU3Vic2Ny\naWJlclN0YXRlPj4gZGVsaXZlcnlQdHJzID0gTWFwTWV0aG9kcy5nZXRBZnRl\nckluc2VydGluZ0lmQWJzZW50KAogICAgICAgICAgICAgICAgICAgIHBlclRv\ncGljRGVsaXZlcnlQdHJzLCBzdWJzY3JpYmVyLmdldFRvcGljKCksIFRyZWVN\nYXBMb25nVG9TZXRTdWJzY3JpYmVyRmFjdG9yeS5pbnN0YW5jZSk7CgogICAg\nICAgIE1hcE1ldGhvZHMuYWRkVG9NdWx0aU1hcChkZWxpdmVyeVB0cnMsIHNl\ncUlkLCBzdWJzY3JpYmVyLCBIYXNoTWFwU3Vic2NyaWJlckZhY3RvcnkuaW5z\ndGFuY2UpOwogICAgfQoKICAgIHB1YmxpYyBjbGFzcyBBY3RpdmVTdWJzY3Jp\nYmVyU3RhdGUgaW1wbGVtZW50cyBTY2FuQ2FsbGJhY2ssIERlbGl2ZXJ5Q2Fs\nbGJhY2ssIERlbGl2ZXJ5TWFuYWdlclJlcXVlc3QgewogICAgICAgIEJ5dGVT\ndHJpbmcgdG9waWM7CiAgICAgICAgQnl0ZVN0cmluZyBzdWJzY3JpYmVySWQ7\nCiAgICAgICAgbG9uZyBsYXN0TG9jYWxTZXFJZERlbGl2ZXJlZDsKICAgICAg\nICBib29sZWFuIGNvbm5lY3RlZCA9IHRydWU7CiAgICAgICAgRGVsaXZlcnlF\nbmRQb2ludCBkZWxpdmVyeUVuZFBvaW50OwogICAgICAgIGxvbmcgbGFzdFNj\nYW5FcnJvclRpbWUgPSAtMTsKICAgICAgICBsb25nIGxvY2FsU2VxSWREZWxp\ndmVyaW5nTm93OwogICAgICAgIGxvbmcgbGFzdFNlcUlkQ29tbXVuaWNhdGVk\nRXh0ZXJuYWxseTsKICAgICAgICAvLyBUT0RPIG1ha2UgdXNlIG9mIHRoZXNl\nIHZhcmlhYmxlcwoKICAgICAgICBib29sZWFuIGlzSHViU3Vic2NyaWJlcjsK\nICAgICAgICBmaW5hbCBzdGF0aWMgaW50IFNFUV9JRF9TTEFDSyA9IDEwOwoK\nICAgICAgICBwdWJsaWMgQWN0aXZlU3Vic2NyaWJlclN0YXRlKEJ5dGVTdHJp\nbmcgdG9waWMsIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkLCBsb25nIGxhc3RM\nb2NhbFNlcUlkRGVsaXZlcmVkLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgRGVsaXZlcnlFbmRQb2ludCBkZWxpdmVyeUVuZFBvaW50\nLCBNZXNzYWdlRmlsdGVyIGZpbHRlciwgYm9vbGVhbiBpc0h1YlN1YnNjcmli\nZXIpIHsKICAgICAgICAgICAgdGhpcy50b3BpYyA9IHRvcGljOwogICAgICAg\nICAgICB0aGlzLnN1YnNjcmliZXJJZCA9IHN1YnNjcmliZXJJZDsKICAgICAg\nICAgICAgdGhpcy5sYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCA9IGxhc3RMb2Nh\nbFNlcUlkRGVsaXZlcmVkOwogICAgICAgICAgICB0aGlzLmRlbGl2ZXJ5RW5k\nUG9pbnQgPSBkZWxpdmVyeUVuZFBvaW50OwoKICAgICAgICAgICAgdGhpcy5p\nc0h1YlN1YnNjcmliZXIgPSBpc0h1YlN1YnNjcmliZXI7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBzZXROb3RDb25uZWN0ZWQoKSB7CiAgICAg\nICAgICAgIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7CiAgICAgICAgICAgIGRl\nbGl2ZXJ5RW5kUG9pbnQuY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBCeXRlU3RyaW5nIGdldFRvcGljKCkgewogICAgICAgICAgICByZXR1\ncm4gdG9waWM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRM\nYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCgpIHsKICAgICAgICAgICAgcmV0dXJu\nIGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGxvbmcgZ2V0TGFzdFNjYW5FcnJvclRpbWUoKSB7CiAgICAgICAg\nICAgIHJldHVybiBsYXN0U2NhbkVycm9yVGltZTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyB2b2lkIHNldExhc3RTY2FuRXJyb3JUaW1lKGxvbmcgbGFz\ndFNjYW5FcnJvclRpbWUpIHsKICAgICAgICAgICAgdGhpcy5sYXN0U2NhbkVy\ncm9yVGltZSA9IGxhc3RTY2FuRXJyb3JUaW1lOwogICAgICAgIH0KCiAgICAg\nICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNDb25uZWN0ZWQoKSB7CiAgICAgICAg\nICAgIHJldHVybiBjb25uZWN0ZWQ7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCBkZWxpdmVyTmV4dE1lc3NhZ2UoKSB7CgogICAgICAgICAgICBp\nZiAoIWlzQ29ubmVjdGVkKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgbG9jYWxTZXFJZERlbGl2ZXJp\nbmdOb3cgPSBwZXJzaXN0ZW5jZU1nci5nZXRTZXFJZEFmdGVyU2tpcHBpbmco\ndG9waWMsIGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkLCAxKTsKCiAgICAgICAg\nICAgIFNjYW5SZXF1ZXN0IHNjYW5SZXF1ZXN0ID0gbmV3IFNjYW5SZXF1ZXN0\nKHRvcGljLCBsb2NhbFNlcUlkRGVsaXZlcmluZ05vdywKICAgICAgICAgICAg\nICAgICAgICAvKiBjYWxsYmFjaz0gKi90aGlzLCAvKiBjdHg9ICovbnVsbCk7\nCgogICAgICAgICAgICBwZXJzaXN0ZW5jZU1nci5zY2FuU2luZ2xlTWVzc2Fn\nZShzY2FuUmVxdWVzdCk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAg\nICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAgKiB7QGxpbmsgU2Nh\nbkNhbGxiYWNrfSBtZXRob2RzCiAgICAgICAgICovCgogICAgICAgIHB1Ymxp\nYyB2b2lkIG1lc3NhZ2VTY2FubmVkKE9iamVjdCBjdHgsIE1lc3NhZ2UgbWVz\nc2FnZSkgewogICAgICAgICAgICBpZiAoIWNvbm5lY3RlZCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAv\nLyBXZSdyZSB1c2luZyBhIHNpbXBsZSBhbGwtdG8tYWxsIG5ldHdvcmsgdG9w\nb2xvZ3ksIHNvIG5vIHJlZ2lvbgogICAgICAgICAgICAvLyBzaG91bGQgZXZl\nciBuZWVkIHRvIGZvcndhcmQgbWVzc2FnZXMgdG8gYW55IG90aGVyIHJlZ2lv\nbi4KICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB3aXRoIHRoZSBjdXJyZW50\nIGxvZ2ljLCBtZXNzYWdlcyB3aWxsIGVuZCB1cAogICAgICAgICAgICAvLyBw\naW5nLXBvbmctaW5nIGJhY2sgYW5kIGZvcnRoIGJldHdlZW4gcmVnaW9ucyB3\naXRoIHN1YnNjcmlwdGlvbnMKICAgICAgICAgICAgLy8gdG8gZWFjaCBvdGhl\nciB3aXRob3V0IHRlcm1pbmF0aW9uIChvciBpbiBhbnkgb3RoZXIgY3ljbGlj\nCiAgICAgICAgICAgIC8vIGNvbmZpZ3VyYXRpb24pLgogICAgICAgICAgICBp\nZiAoaXNIdWJTdWJzY3JpYmVyICYmICFtZXNzYWdlLmdldFNyY1JlZ2lvbigp\nLmVxdWFscyhjZmcuZ2V0TXlSZWdpb25CeXRlU3RyaW5nKCkpKSB7CiAgICAg\nICAgICAgICAgICBzZW5kaW5nRmluaXNoZWQoKTsKICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLyoqCiAgICAg\nICAgICAgICAqIFRoZSBtZXRob2QgYmVsb3cgd2lsbCBpbnZva2Ugb3VyIHNl\nbmRpbmdGaW5pc2hlZCgpIG1ldGhvZCB3aGVuCiAgICAgICAgICAgICAqIGRv\nbmUKICAgICAgICAgICAgICovCiAgICAgICAgICAgIFB1YlN1YlJlc3BvbnNl\nIHJlc3BvbnNlID0gUHViU3ViUmVzcG9uc2UubmV3QnVpbGRlcigpLnNldFBy\nb3RvY29sVmVyc2lvbihQcm90b2NvbFZlcnNpb24uVkVSU0lPTl9PTkUpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldFN0YXR1\nc0NvZGUoU3RhdHVzQ29kZS5TVUNDRVNTKS5zZXRUeG5JZCgwKS5zZXRNZXNz\nYWdlKG1lc3NhZ2UpLmJ1aWxkKCk7CgogICAgICAgICAgICBkZWxpdmVyeUVu\nZFBvaW50LnNlbmQocmVzcG9uc2UsIC8vCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAvLyBjYWxsYmFjayA9CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB0aGlzKTsKCiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzY2FuRmFpbGVkKE9iamVjdCBjdHgsIEV4Y2VwdGlvbiBl\neGNlcHRpb24pIHsKICAgICAgICAgICAgaWYgKCFjb25uZWN0ZWQpIHsKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gd2FpdCBmb3Igc29tZSB0aW1lIGFuZCB0aGVuIHJldHJ5CiAgICAg\nICAgICAgIHJldHJ5RXJyb3JlZFN1YnNjcmliZXJBZnRlckRlbGF5KHRoaXMp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2NhbkZpbmlzaGVk\nKE9iamVjdCBjdHgsIFJlYXNvbkZvckZpbmlzaCByZWFzb24pIHsKICAgICAg\nICAgICAgLy8gbm8tb3AKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAg\nICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PQogICAgICAgICAqIHtAbGluayBEZWxp\ndmVyeUNhbGxiYWNrfSBtZXRob2RzCiAgICAgICAgICovCiAgICAgICAgcHVi\nbGljIHZvaWQgc2VuZGluZ0ZpbmlzaGVkKCkgewogICAgICAgICAgICBpZiAo\nIWNvbm5lY3RlZCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBsYXN0TG9jYWxTZXFJZERlbGl2ZXJlZCA9\nIGxvY2FsU2VxSWREZWxpdmVyaW5nTm93OwoKICAgICAgICAgICAgaWYgKGxh\nc3RMb2NhbFNlcUlkRGVsaXZlcmVkID4gbGFzdFNlcUlkQ29tbXVuaWNhdGVk\nRXh0ZXJuYWxseSArIFNFUV9JRF9TTEFDSykgewogICAgICAgICAgICAgICAg\nLy8gTm90ZTogVGhlIG9yZGVyIG9mIHRoZSBuZXh0IDIgc3RhdGVtZW50cyBp\ncyBpbXBvcnRhbnQuIFdlIHNob3VsZAogICAgICAgICAgICAgICAgLy8gc3Vi\nbWl0IGEgcmVxdWVzdCB0byBjaGFuZ2Ugb3VyIGRlbGl2ZXJ5IHBvaW50ZXIg\nb25seSAqYWZ0ZXIqIHdlCiAgICAgICAgICAgICAgICAvLyBoYXZlIGFjdHVh\nbGx5IGNoYW5nZWQgaXQuIE90aGVyd2lzZSwgdGhlcmUgaXMgYSByYWNlIGNv\nbmRpdGlvbgogICAgICAgICAgICAgICAgLy8gd2l0aCByZW1vdmFsIG9mIHRo\naXMgY2hhbm5lbCwgdy5yLnQsIG1haW50YWluaW5nIHRoZSBkZWxpdmVyeVB0\ncnMKICAgICAgICAgICAgICAgIC8vIHRyZWUgbWFwLgogICAgICAgICAgICAg\nICAgbG9uZyBwcmV2SWQgPSBsYXN0U2VxSWRDb21tdW5pY2F0ZWRFeHRlcm5h\nbGx5OwogICAgICAgICAgICAgICAgbGFzdFNlcUlkQ29tbXVuaWNhdGVkRXh0\nZXJuYWxseSA9IGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkOwogICAgICAgICAg\nICAgICAgbW92ZURlbGl2ZXJ5UHRyRm9yd2FyZCh0aGlzLCBwcmV2SWQsIGxh\nc3RMb2NhbFNlcUlkRGVsaXZlcmVkKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICAvLyBpbmNyZW1lbnQgZGVsaXZlcmllZCBtZXNzYWdlCiAgICAgICAg\nICAgIFNlcnZlclN0YXRzLmdldEluc3RhbmNlKCkuaW5jcmVtZW50TWVzc2Fn\nZXNEZWxpdmVyZWQoKTsKICAgICAgICAgICAgZGVsaXZlck5leHRNZXNzYWdl\nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRMYXN0U2Vx\nSWRDb21tdW5pY2F0ZWRFeHRlcm5hbGx5KCkgewogICAgICAgICAgICByZXR1\ncm4gbGFzdFNlcUlkQ29tbXVuaWNhdGVkRXh0ZXJuYWxseTsKICAgICAgICB9\nCgoKICAgICAgICBwdWJsaWMgdm9pZCBwZXJtYW5lbnRFcnJvck9uU2VuZCgp\nIHsKICAgICAgICAgICAgc3RvcFNlcnZpbmdTdWJzY3JpYmVyKHRoaXMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgdHJhbnNpZW50RXJyb3JP\nblNlbmQoKSB7CiAgICAgICAgICAgIHJldHJ5RXJyb3JlZFN1YnNjcmliZXJB\nZnRlckRlbGF5KHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAg\nICAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgICoge0BsaW5rIERl\nbGl2ZXJ5TWFuYWdlclJlcXVlc3R9IG1ldGhvZHMKICAgICAgICAgKi8KICAg\nICAgICBwdWJsaWMgdm9pZCBwZXJmb3JtUmVxdWVzdCgpIHsKCiAgICAgICAg\nICAgIC8vIFB1dCB0aGlzIHN1YnNjcmliZXIgaW4gdGhlIGNoYW5uZWwgdG8g\nc3Vic2NyaWJlciBtYXBwaW5nCiAgICAgICAgICAgIEFjdGl2ZVN1YnNjcmli\nZXJTdGF0ZSBwcmV2U3Vic2NyaWJlciA9IHN1YnNjcmliZXJTdGF0ZXMucHV0\nKG5ldyBUb3BpY1N1YnNjcmliZXIodG9waWMsIHN1YnNjcmliZXJJZCksIHRo\naXMpOwoKICAgICAgICAgICAgaWYgKHByZXZTdWJzY3JpYmVyICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgIHN0b3BTZXJ2aW5nU3Vic2NyaWJlcihwcmV2\nU3Vic2NyaWJlcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxhc3RT\nZXFJZENvbW11bmljYXRlZEV4dGVybmFsbHkgPSBsYXN0TG9jYWxTZXFJZERl\nbGl2ZXJlZDsKICAgICAgICAgICAgYWRkRGVsaXZlcnlQdHIodGhpcywgbGFz\ndExvY2FsU2VxSWREZWxpdmVyZWQpOwoKICAgICAgICAgICAgZGVsaXZlck5l\neHRNZXNzYWdlKCk7CiAgICAgICAgfTsKCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICAgICAg\nU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAg\nICAgICAgIHNiLmFwcGVuZCgiVG9waWM6ICIpOwogICAgICAgICAgICBzYi5h\ncHBlbmQodG9waWMudG9TdHJpbmdVdGY4KCkpOwogICAgICAgICAgICBzYi5h\ncHBlbmQoIkRlbGl2ZXJ5UHRyOiAiKTsKICAgICAgICAgICAgc2IuYXBwZW5k\nKGxhc3RMb2NhbFNlcUlkRGVsaXZlcmVkKTsKICAgICAgICAgICAgcmV0dXJu\nIHNiLnRvU3RyaW5nKCk7CgogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0\nZWQgY2xhc3MgU3RvcFNlcnZpbmdTdWJzY3JpYmVyIGltcGxlbWVudHMgRGVs\naXZlcnlNYW5hZ2VyUmVxdWVzdCB7CiAgICAgICAgQWN0aXZlU3Vic2NyaWJl\nclN0YXRlIHN1YnNjcmliZXI7CgogICAgICAgIHB1YmxpYyBTdG9wU2Vydmlu\nZ1N1YnNjcmliZXIoQWN0aXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXIp\nIHsKICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjsK\nICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2\nb2lkIHBlcmZvcm1SZXF1ZXN0KCkgewoKICAgICAgICAgICAgLy8gVGhpcyB3\naWxsIGF1dG9tYXRpY2FsbHkgc3RvcCBkZWxpdmVyeSwgYW5kIGRpc2Nvbm5l\nY3QgdGhlIGNoYW5uZWwKICAgICAgICAgICAgc3Vic2NyaWJlci5zZXROb3RD\nb25uZWN0ZWQoKTsKCiAgICAgICAgICAgIC8vIGlmIHRoZSBzdWJzY3JpYmVy\nIGhhcyBtb3ZlZCBvbiwgYSBtb3ZlIHJlcXVlc3QgZm9yIGl0cyBkZWxpdmVy\neQogICAgICAgICAgICAvLyBwb2ludGVyIG11c3QgYmUgcGVuZGluZyBpbiB0\naGUgcmVxdWVzdCBxdWV1ZS4gTm90ZSB0aGF0IHRoZQogICAgICAgICAgICAv\nLyBzdWJzY3JpYmVyIGZpcnN0IGNoYW5nZXMgaXRzIGRlbGl2ZXJ5IHBvaW50\nZXIgYW5kIHRoZW4gc3VibWl0cyBhCiAgICAgICAgICAgIC8vIHJlcXVlc3Qg\ndG8gbW92ZSBzbyB0aGlzIHdvcmtzLgogICAgICAgICAgICByZW1vdmVEZWxp\ndmVyeVB0cihzdWJzY3JpYmVyLCBzdWJzY3JpYmVyLmdldExhc3RTZXFJZENv\nbW11bmljYXRlZEV4dGVybmFsbHkoKSwgLy8KICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgLy8gaXNBYnNlbmNlT2s9CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIHBydW5lVG9waWM9CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHRydWUpOwogICAgICAgIH0KCiAgICB9CgogICAgcHJvdGVjdGVkIGNs\nYXNzIERlbGl2ZXJ5UHRyTW92ZSBpbXBsZW1lbnRzIERlbGl2ZXJ5TWFuYWdl\nclJlcXVlc3QgewoKICAgICAgICBBY3RpdmVTdWJzY3JpYmVyU3RhdGUgc3Vi\nc2NyaWJlcjsKICAgICAgICBMb25nIG9sZFNlcUlkOwogICAgICAgIExvbmcg\nbmV3U2VxSWQ7CgogICAgICAgIHB1YmxpYyBEZWxpdmVyeVB0ck1vdmUoQWN0\naXZlU3Vic2NyaWJlclN0YXRlIHN1YnNjcmliZXIsIExvbmcgb2xkU2VxSWQs\nIExvbmcgbmV3U2VxSWQpIHsKICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVy\nID0gc3Vic2NyaWJlcjsKICAgICAgICAgICAgdGhpcy5vbGRTZXFJZCA9IG9s\nZFNlcUlkOwogICAgICAgICAgICB0aGlzLm5ld1NlcUlkID0gbmV3U2VxSWQ7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\ndm9pZCBwZXJmb3JtUmVxdWVzdCgpIHsKICAgICAgICAgICAgQnl0ZVN0cmlu\nZyB0b3BpYyA9IHN1YnNjcmliZXIuZ2V0VG9waWMoKTsKICAgICAgICAgICAg\nbG9uZyBwcmV2TWluU2VxSWQgPSBnZXRNaW5pbXVtU2VxSWQodG9waWMpOwoK\nICAgICAgICAgICAgaWYgKHN1YnNjcmliZXIuaXNDb25uZWN0ZWQoKSkgewog\nICAgICAgICAgICAgICAgcmVtb3ZlRGVsaXZlcnlQdHIoc3Vic2NyaWJlciwg\nb2xkU2VxSWQsIC8vCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAvLyBpc0Fic2VuY2VPaz0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gcHJ1bmVUb3BpYz0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZhbHNlKTsKCiAgICAgICAgICAgICAgICBhZGREZWxpdmVyeVB0\ncihzdWJzY3JpYmVyLCBuZXdTZXFJZCk7CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICByZW1vdmVEZWxpdmVyeVB0cihzdWJzY3JpYmVy\nLCBvbGRTZXFJZCwgLy8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIGlzQWJzZW5jZU9rPQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIHBydW5lVG9waWM9CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbG9u\nZyBub3dNaW5TZXFJZCA9IGdldE1pbmltdW1TZXFJZCh0b3BpYyk7CgogICAg\nICAgICAgICBpZiAobm93TWluU2VxSWQgPiBwcmV2TWluU2VxSWQpIHsKICAg\nICAgICAgICAgICAgIHBlcnNpc3RlbmNlTWdyLmRlbGl2ZXJlZFVudGlsKHRv\ncGljLCBub3dNaW5TZXFJZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICB9CgogICAgcHJvdGVjdGVkIGNsYXNzIFNodXRkb3duRGVsaXZlcnlNYW5h\nZ2VyUmVxdWVzdCBpbXBsZW1lbnRzIERlbGl2ZXJ5TWFuYWdlclJlcXVlc3Qg\newogICAgICAgIC8vIFRoaXMgaXMgYSBzaW1wbGUgdHlwZSBvZiBSZXF1ZXN0\nIHdlIHdpbGwgZW5xdWV1ZSB3aGVuIHRoZQogICAgICAgIC8vIFB1YlN1YlNl\ncnZlciBpcyBzaHV0IGRvd24gYW5kIHdlIHdhbnQgdG8gc3RvcCB0aGUgRGVs\naXZlcnlNYW5hZ2VyCiAgICAgICAgLy8gdGhyZWFkLgogICAgICAgIHB1Ymxp\nYyB2b2lkIHBlcmZvcm1SZXF1ZXN0KCkgewogICAgICAgICAgICBrZWVwUnVu\nbmluZyA9IGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgKgogICAgICogRHVtYiBm\nYWN0b3JpZXMgZm9yIG91ciBtYXAgbWV0aG9kcwogICAgICovCiAgICBwcm90\nZWN0ZWQgc3RhdGljIGNsYXNzIFRyZWVNYXBMb25nVG9TZXRTdWJzY3JpYmVy\nRmFjdG9yeSBpbXBsZW1lbnRzCiAgICAgICAgRmFjdG9yeTxTb3J0ZWRNYXA8\nTG9uZywgU2V0PEFjdGl2ZVN1YnNjcmliZXJTdGF0ZT4+PiB7CiAgICAgICAg\nc3RhdGljIFRyZWVNYXBMb25nVG9TZXRTdWJzY3JpYmVyRmFjdG9yeSBpbnN0\nYW5jZSA9IG5ldyBUcmVlTWFwTG9uZ1RvU2V0U3Vic2NyaWJlckZhY3Rvcnko\nKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFNvcnRlZE1h\ncDxMb25nLCBTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4gbmV3SW5zdGFu\nY2UoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgVHJlZU1hcDxMb25nLCBT\nZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRlPj4oKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBIYXNoTWFwU3Vic2NyaWJl\nckZhY3RvcnkgaW1wbGVtZW50cyBGYWN0b3J5PFNldDxBY3RpdmVTdWJzY3Jp\nYmVyU3RhdGU+PiB7CiAgICAgICAgc3RhdGljIEhhc2hNYXBTdWJzY3JpYmVy\nRmFjdG9yeSBpbnN0YW5jZSA9IG5ldyBIYXNoTWFwU3Vic2NyaWJlckZhY3Rv\ncnkoKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFNldDxB\nY3RpdmVTdWJzY3JpYmVyU3RhdGU+IG5ld0luc3RhbmNlKCkgewogICAgICAg\nICAgICByZXR1cm4gbmV3IEhhc2hTZXQ8QWN0aXZlU3Vic2NyaWJlclN0YXRl\nPigpOwogICAgICAgIH0KICAgIH0KCn0K\n","encoding":"base64"}

