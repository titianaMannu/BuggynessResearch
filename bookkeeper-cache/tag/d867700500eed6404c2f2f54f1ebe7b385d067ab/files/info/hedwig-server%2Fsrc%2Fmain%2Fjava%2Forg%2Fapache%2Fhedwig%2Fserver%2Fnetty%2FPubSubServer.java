{"sha":"cb11955f778a5123f522712d5b06a5c118be2be5","node_id":"MDQ6QmxvYjE1NzU5NTY6Y2IxMTk1NWY3NzhhNTEyM2Y1MjI3MTJkNWIwNmE1YzExOGJlMmJlNQ==","size":17645,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/cb11955f778a5123f522712d5b06a5c118be2be5","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIubmV0dHk7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEubmV0LkluZXRTb2NrZXRBZGRyZXNzOwppbXBvcnQgamF2YS5u\nZXQuTWFsZm9ybWVkVVJMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNv\nbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ291\nbnREb3duTGF0Y2g7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5FeGVj\ndXRvcnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5TY2hlZHVsZWRF\neGVjdXRvclNlcnZpY2U7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5T\neW5jaHJvbm91c1F1ZXVlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQu\nVGltZVVuaXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYu\nQ2xpZW50Q29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9va2tl\nZXBlci5jbGllbnQuQm9va0tlZXBlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYm9v\na2tlZXBlci5jbGllbnQuQktFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMuY29uZmlndXJhdGlvbi5Db25maWd1cmF0aW9uRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5M\nb2dnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuS2Vl\ncGVyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0\nY2hlZEV2ZW50OwppbXBvcnQgb3JnLmFwYWNoZS56b29rZWVwZXIuV2F0Y2hl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUuem9va2VlcGVyLlpvb0tlZXBlcjsKaW1w\nb3J0IG9yZy5qYm9zcy5uZXR0eS5ib290c3RyYXAuU2VydmVyQm9vdHN0cmFw\nOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuZ3JvdXAuQ2hhbm5l\nbEdyb3VwOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwuZ3JvdXAu\nRGVmYXVsdENoYW5uZWxHcm91cDsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5j\naGFubmVsLnNvY2tldC5DbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeTsKaW1w\nb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFubmVsLnNvY2tldC5TZXJ2ZXJTb2Nr\nZXRDaGFubmVsRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5jaGFu\nbmVsLnNvY2tldC5uaW8uTmlvQ2xpZW50U29ja2V0Q2hhbm5lbEZhY3Rvcnk7\nCmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5zb2NrZXQubmlvLk5p\nb1NlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5OwppbXBvcnQgb3JnLmpib3Nz\nLm5ldHR5LmxvZ2dpbmcuSW50ZXJuYWxMb2dnZXJGYWN0b3J5OwppbXBvcnQg\nb3JnLmpib3NzLm5ldHR5LmxvZ2dpbmcuTG9nNEpMb2dnZXJGYWN0b3J5OwoK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHVi\nU3ViUHJvdG9jb2wuT3BlcmF0aW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLnNlcnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21tb24uVGVybWluYXRl\nSlZNRXhjZXB0aW9uSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2ln\nLnNlcnZlci5kZWxpdmVyeS5EZWxpdmVyeU1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuZGVsaXZlcnkuRklGT0RlbGl2ZXJ5TWFu\nYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVy\ncy5Db25zdW1lSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5oYW5kbGVycy5IYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3\naWcuc2VydmVyLmhhbmRsZXJzLk5ldHR5SGFuZGxlckJlYW47CmltcG9ydCBv\ncmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaGFuZGxlcnMuUHVibGlzaEhhbmRs\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuaGFuZGxlcnMu\nU3Vic2NyaWJlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5oYW5kbGVycy5VbnN1YnNjcmliZUhhbmRsZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5zZXJ2ZXIuam14LkhlZHdpZ01CZWFuUmVnaXN0cnk7\nCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2Uu\nQm9va2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5Mb2NhbERCUGVyc2lzdGVu\nY2VNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBl\ncnNpc3RlbmNlLlBlcnNpc3RlbmNlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZU1hbmFn\nZXJXaXRoUmFuZ2VTY2FuOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLnBlcnNpc3RlbmNlLlJlYWRBaGVhZENhY2hlOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLnJlZ2lvbnMuSGVkd2lnSHViQ2xpZW50RmFj\ndG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5yZWdpb25z\nLlJlZ2lvbk1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2\nZXIuc3NsLlNzbFNlcnZlckNvbnRleHRGYWN0b3J5OwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcuc2VydmVyLnN1YnNjcmlwdGlvbnMuSW5NZW1vcnlTdWJz\nY3JpcHRpb25NYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2Vy\ndmVyLnN1YnNjcmlwdGlvbnMuU3Vic2NyaXB0aW9uTWFuYWdlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5zdWJzY3JpcHRpb25zLlprU3Vi\nc2NyaXB0aW9uTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci50b3BpY3MuVG9waWNNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5o\nZWR3aWcuc2VydmVyLnRvcGljcy5Ucml2aWFsT3duQWxsVG9waWNNYW5hZ2Vy\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljcy5aa1Rv\ncGljTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwuQ29u\nY3VycmVuY3lVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnV0aWwu\nRWl0aGVyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuem9va2VlcGVyLlNh\nZmVBc3luY0NhbGxiYWNrOwoKcHVibGljIGNsYXNzIFB1YlN1YlNlcnZlciB7\nCgogICAgc3RhdGljIExvZ2dlciBsb2dnZXIgPSBMb2dnZXJGYWN0b3J5Lmdl\ndExvZ2dlcihQdWJTdWJTZXJ2ZXIuY2xhc3MpOwoKICAgIC8vIE5ldHR5IHJl\nbGF0ZWQgdmFyaWFibGVzCiAgICBTZXJ2ZXJTb2NrZXRDaGFubmVsRmFjdG9y\neSBzZXJ2ZXJDaGFubmVsRmFjdG9yeTsKICAgIENsaWVudFNvY2tldENoYW5u\nZWxGYWN0b3J5IGNsaWVudENoYW5uZWxGYWN0b3J5OwogICAgU2VydmVyQ29u\nZmlndXJhdGlvbiBjb25mOwogICAgQ2hhbm5lbEdyb3VwIGFsbENoYW5uZWxz\nOwoKICAgIC8vIE1hbmFnZXIgY29tcG9uZW50cyB0aGF0IG1ha2UgdXAgdGhl\nIFB1YlN1YlNlcnZlcgogICAgUGVyc2lzdGVuY2VNYW5hZ2VyIHBtOwogICAg\nRGVsaXZlcnlNYW5hZ2VyIGRtOwogICAgVG9waWNNYW5hZ2VyIHRtOwogICAg\nU3Vic2NyaXB0aW9uTWFuYWdlciBzbTsKICAgIFJlZ2lvbk1hbmFnZXIgcm07\nCgogICAgWm9vS2VlcGVyIHprOyAvLyBudWxsIGlmIHdlIGFyZSBpbiBzdGFu\nZGFsb25lIG1vZGUKICAgIEJvb2tLZWVwZXIgYms7IC8vIG51bGwgaWYgd2Ug\nYXJlIGluIHN0YW5kYWxvbmUgbW9kZQoKICAgIC8vIHdlIHVzZSB0aGlzIHRv\nIHByZXZlbnQgbG9uZyBzdGFjayBjaGFpbnMgZnJvbSBidWlsZGluZyB1cCBp\nbiBjYWxsYmFja3MKICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hl\nZHVsZXI7CgogICAgLy8gSk1YIEJlYW5zCiAgICBOZXR0eUhhbmRsZXJCZWFu\nIGpteE5ldHR5QmVhbjsKICAgIFB1YlN1YlNlcnZlckJlYW4gam14U2VydmVy\nQmVhbjsKICAgIGZpbmFsIFRocmVhZEdyb3VwIHRnOwoKICAgIHByb3RlY3Rl\nZCBQZXJzaXN0ZW5jZU1hbmFnZXIgaW5zdGFudGlhdGVQZXJzaXN0ZW5jZU1h\nbmFnZXIoVG9waWNNYW5hZ2VyIHRvcGljTWdyKSB0aHJvd3MgSU9FeGNlcHRp\nb24sCiAgICAgICAgSW50ZXJydXB0ZWRFeGNlcHRpb24gewoKICAgICAgICBQ\nZXJzaXN0ZW5jZU1hbmFnZXJXaXRoUmFuZ2VTY2FuIHVuZGVybHlpbmdQTTsK\nCiAgICAgICAgaWYgKGNvbmYuaXNTdGFuZGFsb25lKCkpIHsKCiAgICAgICAg\nICAgIHVuZGVybHlpbmdQTSA9IExvY2FsREJQZXJzaXN0ZW5jZU1hbmFnZXIu\naW5zdGFuY2UoKTsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIENsaWVudENvbmZpZ3VyYXRpb24gYmtDb25m\nID0gbmV3IENsaWVudENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgICAg\nIGJrQ29uZi5hZGRDb25maWd1cmF0aW9uKGNvbmYuZ2V0Q29uZigpKTsKICAg\nICAgICAgICAgICAgIGJrID0gbmV3IEJvb2tLZWVwZXIoYmtDb25mLCB6aywg\nY2xpZW50Q2hhbm5lbEZhY3RvcnkpOwogICAgICAgICAgICB9IGNhdGNoIChL\nZWVwZXJFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJDb3VsZCBub3QgaW5zdGFudGlhdGUgYm9va2tlZXBlciBjbGllbnQi\nLCBlKTsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbihl\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1bmRlcmx5aW5nUE0gPSBu\nZXcgQm9va2tlZXBlclBlcnNpc3RlbmNlTWFuYWdlcihiaywgemssIHRvcGlj\nTWdyLCBjb25mLCBzY2hlZHVsZXIpOwoKICAgICAgICB9CgogICAgICAgIFBl\ncnNpc3RlbmNlTWFuYWdlciBwbSA9IHVuZGVybHlpbmdQTTsKCiAgICAgICAg\naWYgKGNvbmYuZ2V0UmVhZEFoZWFkRW5hYmxlZCgpKSB7CiAgICAgICAgICAg\nIHBtID0gbmV3IFJlYWRBaGVhZENhY2hlKHVuZGVybHlpbmdQTSwgY29uZiku\nc3RhcnQoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBwbTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgU3Vic2NyaXB0aW9uTWFuYWdlciBpbnN0YW50aWF0\nZVN1YnNjcmlwdGlvbk1hbmFnZXIoVG9waWNNYW5hZ2VyIHRtLCBQZXJzaXN0\nZW5jZU1hbmFnZXIgcG0pIHsKICAgICAgICBpZiAoY29uZi5pc1N0YW5kYWxv\nbmUoKSkgewogICAgICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5U3Vic2Ny\naXB0aW9uTWFuYWdlcih0bSwgcG0sIGNvbmYsIHNjaGVkdWxlcik7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBaa1N1YnNjcmlw\ndGlvbk1hbmFnZXIoemssIHRtLCBwbSwgY29uZiwgc2NoZWR1bGVyKTsKICAg\nICAgICB9CgogICAgfQoKICAgIHByb3RlY3RlZCBSZWdpb25NYW5hZ2VyIGlu\nc3RhbnRpYXRlUmVnaW9uTWFuYWdlcihQZXJzaXN0ZW5jZU1hbmFnZXIgcG0s\nIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hlZHVsZXIpIHsKICAgICAg\nICByZXR1cm4gbmV3IFJlZ2lvbk1hbmFnZXIocG0sIGNvbmYsIHprLCBzY2hl\nZHVsZXIsIG5ldyBIZWR3aWdIdWJDbGllbnRGYWN0b3J5KGNvbmYsIGNsaWVu\ndENoYW5uZWxGYWN0b3J5KSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\naW5zdGFudGlhdGVab29rZWVwZXJDbGllbnQoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIWNvbmYuaXNTdGFuZGFsb25lKCkpIHsKICAgICAg\nICAgICAgZmluYWwgQ291bnREb3duTGF0Y2ggc2lnbmFsWmtSZWFkeSA9IG5l\ndyBDb3VudERvd25MYXRjaCgxKTsKCiAgICAgICAgICAgIHprID0gbmV3IFpv\nb0tlZXBlcihjb25mLmdldFprSG9zdCgpLCBjb25mLmdldFprVGltZW91dCgp\nLCBuZXcgV2F0Y2hlcigpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcHJvY2VzcyhXYXRjaGVkRXZl\nbnQgZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICBpZihFdmVudC5LZWVw\nZXJTdGF0ZS5TeW5jQ29ubmVjdGVkLmVxdWFscyhldmVudC5nZXRTdGF0ZSgp\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBzaWduYWxaa1JlYWR5LmNv\ndW50RG93bigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIHdhaXQgdW50\naWwgY29ubmVjdGlvbiBpcyBlZmZlY3RpdmUKICAgICAgICAgICAgaWYgKCFz\naWduYWxaa1JlYWR5LmF3YWl0KGNvbmYuZ2V0WmtUaW1lb3V0KCkqMiwgVGlt\nZVVuaXQuTUlMTElTRUNPTkRTKSkgewogICAgICAgICAgICAgICAgbG9nZ2Vy\nLmVycm9yKCJDb3VsZCBub3QgZXN0YWJsaXNoIGNvbm5lY3Rpb24gd2l0aCBa\nb29LZWVwZXIgYWZ0ZXIgemtfdGltZW91dCoyID0gIiArCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY29uZi5nZXRaa1RpbWVvdXQoKSoyICsgIiBt\ncy4gKERlZmF1bHQgdmFsdWUgZm9yIHprX3RpbWVvdXQgaXMgMjAwMCkuIik7\nCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCJDb3VsZCBu\nb3QgZXN0YWJsaXNoIGNvbm5lY3Rpb24gd2l0aCBab29LZWVwZXIgYWZ0ZXIg\nemtfdGltZW91dCoyID0gIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGNvbmYuZ2V0WmtUaW1lb3V0KCkqMiArICIgbXMuIChEZWZh\ndWx0IHZhbHVlIGZvciB6a190aW1lb3V0IGlzIDIwMDApLiIpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBUb3BpY01h\nbmFnZXIgaW5zdGFudGlhdGVUb3BpY01hbmFnZXIoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIFRvcGljTWFuYWdlciB0bTsKCiAgICAgICAgaWYg\nKGNvbmYuaXNTdGFuZGFsb25lKCkpIHsKICAgICAgICAgICAgdG0gPSBuZXcg\nVHJpdmlhbE93bkFsbFRvcGljTWFuYWdlcihjb25mLCBzY2hlZHVsZXIpOwog\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICB0bSA9IG5ldyBaa1RvcGljTWFuYWdlcih6aywgY29uZiwgc2NoZWR1\nbGVyKTsKICAgICAgICAgICAgfSBjYXRjaCAoUHViU3ViRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiQ291bGQgbm90IGlu\nc3RhbnRpYXRlIHprLXRvcGljIG1hbmFnZXIiLCBlKTsKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBJT0V4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gdG07CiAgICB9CgogICAgcHJvdGVj\ndGVkIE1hcDxPcGVyYXRpb25UeXBlLCBIYW5kbGVyPiBpbml0aWFsaXplTmV0\ndHlIYW5kbGVycyhUb3BpY01hbmFnZXIgdG0sIERlbGl2ZXJ5TWFuYWdlciBk\nbSwKICAgICAgICAgICAgUGVyc2lzdGVuY2VNYW5hZ2VyIHBtLCBTdWJzY3Jp\ncHRpb25NYW5hZ2VyIHNtKSB7CiAgICAgICAgTWFwPE9wZXJhdGlvblR5cGUs\nIEhhbmRsZXI+IGhhbmRsZXJzID0gbmV3IEhhc2hNYXA8T3BlcmF0aW9uVHlw\nZSwgSGFuZGxlcj4oKTsKICAgICAgICBoYW5kbGVycy5wdXQoT3BlcmF0aW9u\nVHlwZS5QVUJMSVNILCBuZXcgUHVibGlzaEhhbmRsZXIodG0sIHBtLCBjb25m\nKSk7CiAgICAgICAgaGFuZGxlcnMucHV0KE9wZXJhdGlvblR5cGUuU1VCU0NS\nSUJFLCBuZXcgU3Vic2NyaWJlSGFuZGxlcih0bSwgZG0sIHBtLCBzbSwgY29u\nZikpOwogICAgICAgIGhhbmRsZXJzLnB1dChPcGVyYXRpb25UeXBlLlVOU1VC\nU0NSSUJFLCBuZXcgVW5zdWJzY3JpYmVIYW5kbGVyKHRtLCBjb25mLCBzbSwg\nZG0pKTsKICAgICAgICBoYW5kbGVycy5wdXQoT3BlcmF0aW9uVHlwZS5DT05T\nVU1FLCBuZXcgQ29uc3VtZUhhbmRsZXIodG0sIHNtLCBjb25mKSk7CiAgICAg\nICAgaGFuZGxlcnMgPSBDb2xsZWN0aW9ucy51bm1vZGlmaWFibGVNYXAoaGFu\nZGxlcnMpOwogICAgICAgIHJldHVybiBoYW5kbGVyczsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgdm9pZCBpbml0aWFsaXplTmV0dHkoU3NsU2VydmVyQ29udGV4\ndEZhY3Rvcnkgc3NsRmFjdG9yeSwgTWFwPE9wZXJhdGlvblR5cGUsIEhhbmRs\nZXI+IGhhbmRsZXJzKSB7CiAgICAgICAgYm9vbGVhbiBpc1NTTEVuYWJsZWQg\nPSAoc3NsRmFjdG9yeSAhPSBudWxsKSA/IHRydWUgOiBmYWxzZTsKICAgICAg\nICBJbnRlcm5hbExvZ2dlckZhY3Rvcnkuc2V0RGVmYXVsdEZhY3RvcnkobmV3\nIExvZzRKTG9nZ2VyRmFjdG9yeSgpKTsKICAgICAgICBTZXJ2ZXJCb290c3Ry\nYXAgYm9vdHN0cmFwID0gbmV3IFNlcnZlckJvb3RzdHJhcChzZXJ2ZXJDaGFu\nbmVsRmFjdG9yeSk7CiAgICAgICAgVW1icmVsbGFIYW5kbGVyIHVtYnJlbGxh\nSGFuZGxlciA9IG5ldyBVbWJyZWxsYUhhbmRsZXIoYWxsQ2hhbm5lbHMsIGhh\nbmRsZXJzLCBpc1NTTEVuYWJsZWQpOwogICAgICAgIFB1YlN1YlNlcnZlclBp\ncGVsaW5lRmFjdG9yeSBwaXBlbGluZSA9IG5ldyBQdWJTdWJTZXJ2ZXJQaXBl\nbGluZUZhY3RvcnkodW1icmVsbGFIYW5kbGVyLCBzc2xGYWN0b3J5LCBjb25m\nCiAgICAgICAgICAgICAgICAuZ2V0TWF4aW11bU1lc3NhZ2VTaXplKCkpOwoK\nICAgICAgICBib290c3RyYXAuc2V0UGlwZWxpbmVGYWN0b3J5KHBpcGVsaW5l\nKTsKICAgICAgICBib290c3RyYXAuc2V0T3B0aW9uKCJjaGlsZC50Y3BOb0Rl\nbGF5IiwgdHJ1ZSk7CiAgICAgICAgYm9vdHN0cmFwLnNldE9wdGlvbigiY2hp\nbGQua2VlcEFsaXZlIiwgdHJ1ZSk7CiAgICAgICAgYm9vdHN0cmFwLnNldE9w\ndGlvbigicmV1c2VBZGRyZXNzIiwgdHJ1ZSk7CgogICAgICAgIC8vIEJpbmQg\nYW5kIHN0YXJ0IHRvIGFjY2VwdCBpbmNvbWluZyBjb25uZWN0aW9ucy4KICAg\nICAgICBhbGxDaGFubmVscy5hZGQoYm9vdHN0cmFwLmJpbmQoaXNTU0xFbmFi\nbGVkID8gbmV3IEluZXRTb2NrZXRBZGRyZXNzKGNvbmYuZ2V0U1NMU2VydmVy\nUG9ydCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICA6IG5ldyBJbmV0U29ja2V0QWRkcmVzcyhjb25mLmdldFNlcnZlclBvcnQo\nKSkpKTsKICAgICAgICBsb2dnZXIuaW5mbygiR29pbmcgaW50byByZWNlaXZl\nIGxvb3AiKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzaHV0ZG93bigpIHsK\nICAgICAgICAvLyBUT0RPOiB0ZWxsIGJrIHRvIGNsb3NlIGxvZ3MKCiAgICAg\nICAgLy8gU3RvcCB0b3BpYyBtYW5hZ2VyIGZpcnN0IHNpbmNlIGl0IGlzIGNv\ncmUgb2YgSHViIHNlcnZlcgogICAgICAgIHRtLnN0b3AoKTsKCiAgICAgICAg\nLy8gU3RvcCB0aGUgUmVnaW9uTWFuYWdlci4KICAgICAgICBybS5zdG9wKCk7\nCgogICAgICAgIC8vIFN0b3AgdGhlIERlbGl2ZXJ5TWFuYWdlciBhbmQgUmVh\nZEFoZWFkQ2FjaGUgdGhyZWFkcyAoaWYKICAgICAgICAvLyBhcHBsaWNhYmxl\nKS4KICAgICAgICBkbS5zdG9wKCk7CgogICAgICAgIC8vIFN0b3AgdGhlIFN1\nYnNjcmlwdGlvbk1hbmFnZXIgaWYgbmVlZGVkLgogICAgICAgIHNtLnN0b3Ao\nKTsKCiAgICAgICAgLy8gU2h1dGRvd24gdGhlIFpvb0tlZXBlciBhbmQgQm9v\na0tlZXBlciBjbGllbnRzIG9ubHkgaWYgd2UgYXJlCiAgICAgICAgLy8gbm90\nIGluIHN0YW5kLWFsb25lIG1vZGUuCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgaWYgKGJrICE9IG51bGwpCiAgICAgICAgICAgICAgICBiay5jbG9zZSgp\nOwogICAgICAgICAgICBpZiAoemsgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHprLmNsb3NlKCk7CiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkVycm9yIHdo\naWxlIGNsb3NpbmcgWm9vS2VlcGVyIGNsaWVudCEiKTsKICAgICAgICB9IGNh\ndGNoIChCS0V4Y2VwdGlvbiBia2UpIHsKICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJFcnJvciB3aGlsZSBjbG9zaW5nIEJvb2tLZWVwZXIgY2xpZW50Iik7\nCiAgICAgICAgfQoKICAgICAgICAvLyBDbG9zZSBhbmQgcmVsZWFzZSB0aGUg\nTmV0dHkgY2hhbm5lbHMgYW5kIHJlc291cmNlcwogICAgICAgIGFsbENoYW5u\nZWxzLmNsb3NlKCkuYXdhaXRVbmludGVycnVwdGlibHkoKTsKICAgICAgICBz\nZXJ2ZXJDaGFubmVsRmFjdG9yeS5yZWxlYXNlRXh0ZXJuYWxSZXNvdXJjZXMo\nKTsKICAgICAgICBjbGllbnRDaGFubmVsRmFjdG9yeS5yZWxlYXNlRXh0ZXJu\nYWxSZXNvdXJjZXMoKTsKICAgICAgICBzY2hlZHVsZXIuc2h1dGRvd24oKTsK\nCiAgICAgICAgLy8gdW5yZWdpc3RlciBqbXgKICAgICAgICB1bnJlZ2lzdGVy\nSk1YKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgcmVnaXN0ZXJKTVgo\nTWFwPE9wZXJhdGlvblR5cGUsIEhhbmRsZXI+IGhhbmRsZXJzKSB7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgam14U2VydmVyQmVhbiA9IG5ldyBQdWJT\ndWJTZXJ2ZXJCZWFuKCk7CiAgICAgICAgICAgIEhlZHdpZ01CZWFuUmVnaXN0\ncnkuZ2V0SW5zdGFuY2UoKS5yZWdpc3RlcihqbXhTZXJ2ZXJCZWFuLCBudWxs\nKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGpteE5ldHR5\nQmVhbiA9IG5ldyBOZXR0eUhhbmRsZXJCZWFuKGhhbmRsZXJzKTsKICAgICAg\nICAgICAgICAgIEhlZHdpZ01CZWFuUmVnaXN0cnkuZ2V0SW5zdGFuY2UoKS5y\nZWdpc3RlcihqbXhOZXR0eUJlYW4sIGpteFNlcnZlckJlYW4pOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nbG9nZ2VyLndhcm4oIkZhaWxlZCB0byByZWdpc3RlciB3aXRoIEpNWCIsIGUp\nOwogICAgICAgICAgICAgICAgam14TmV0dHlCZWFuID0gbnVsbDsKICAgICAg\nICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIGxvZ2dlci53YXJuKCJGYWlsZWQgdG8gcmVnaXN0ZXIgd2l0aCBK\nTVgiLCBlKTsKICAgICAgICAgICAgam14U2VydmVyQmVhbiA9IG51bGw7CiAg\nICAgICAgfQogICAgICAgIGlmIChwbSBpbnN0YW5jZW9mIFJlYWRBaGVhZENh\nY2hlKSB7CiAgICAgICAgICAgICgoUmVhZEFoZWFkQ2FjaGUpcG0pLnJlZ2lz\ndGVySk1YKGpteFNlcnZlckJlYW4pOwogICAgICAgIH0KICAgIH0KCiAgICBw\ncm90ZWN0ZWQgdm9pZCB1bnJlZ2lzdGVySk1YKCkgewogICAgICAgIGlmIChw\nbSAhPSBudWxsICYmIHBtIGluc3RhbmNlb2YgUmVhZEFoZWFkQ2FjaGUpIHsK\nICAgICAgICAgICAgKChSZWFkQWhlYWRDYWNoZSlwbSkudW5yZWdpc3RlckpN\nWCgpOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAo\nam14TmV0dHlCZWFuICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIEhlZHdp\nZ01CZWFuUmVnaXN0cnkuZ2V0SW5zdGFuY2UoKS51bnJlZ2lzdGVyKGpteE5l\ndHR5QmVhbik7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBsb2dnZXIud2FybigiRmFpbGVkIHRv\nIHVucmVnaXN0ZXIgd2l0aCBKTVgiLCBlKTsKICAgICAgICB9CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgaWYgKGpteFNlcnZlckJlYW4gIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgSGVkd2lnTUJlYW5SZWdpc3RyeS5nZXRJbnN0\nYW5jZSgpLnVucmVnaXN0ZXIoam14U2VydmVyQmVhbik7CiAgICAgICAgICAg\nIH0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICBsb2dnZXIud2FybigiRmFpbGVkIHRvIHVucmVnaXN0ZXIgd2l0aCBKTVgi\nLCBlKTsKICAgICAgICB9CiAgICAgICAgam14TmV0dHlCZWFuID0gbnVsbDsK\nICAgICAgICBqbXhTZXJ2ZXJCZWFuID0gbnVsbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFN0YXJ0cyB0aGUgaGVkd2lnIHNlcnZlciBvbiB0aGUgZ2l2ZW4g\ncG9ydAogICAgICoKICAgICAqIEBwYXJhbSBwb3J0CiAgICAgKiBAdGhyb3dz\nIENvbmZpZ3VyYXRpb25FeGNlcHRpb24KICAgICAqICAgICAgICAgICAgIGlm\nIHRoZXJlIGlzIHNvbWV0aGluZyB3cm9uZyB3aXRoIHRoZSBnaXZlbiBjb25m\naWd1cmF0aW9uCiAgICAgKiBAdGhyb3dzIElPRXhjZXB0aW9uCiAgICAgKiBA\ndGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uCiAgICAgKiBAdGhyb3dzIENv\nbmZpZ3VyYXRpb25FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIFB1YlN1\nYlNlcnZlcihmaW5hbCBTZXJ2ZXJDb25maWd1cmF0aW9uIGNvbmYsCiAgICAg\nICAgICAgICAgICAgICAgICAgIGZpbmFsIFRocmVhZC5VbmNhdWdodEV4Y2Vw\ndGlvbkhhbmRsZXIgZXhjZXB0aW9uSGFuZGxlcikKICAgICAgICAgICAgdGhy\nb3dzIENvbmZpZ3VyYXRpb25FeGNlcHRpb24gewoKICAgICAgICAvLyBGaXJz\ndCB2YWxpZGF0ZSB0aGUgY29uZgogICAgICAgIHRoaXMuY29uZiA9IGNvbmY7\nCiAgICAgICAgY29uZi52YWxpZGF0ZSgpOwoKICAgICAgICAvLyBXZSBuZWVk\nIGEgY3VzdG9tIHRocmVhZCBncm91cCwgc28gdGhhdCB3ZSBjYW4gb3ZlcnJp\nZGUgdGhlIHVuY2F1Z2h0CiAgICAgICAgLy8gZXhjZXB0aW9uIG1ldGhvZAog\nICAgICAgIHRnID0gbmV3IFRocmVhZEdyb3VwKCJoZWR3aWciKSB7CiAgICAg\nICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCB1bmNh\ndWdodEV4Y2VwdGlvbihUaHJlYWQgdCwgVGhyb3dhYmxlIGUpIHsKICAgICAg\nICAgICAgICAgIGV4Y2VwdGlvbkhhbmRsZXIudW5jYXVnaHRFeGNlcHRpb24o\ndCwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIC8vIFpv\nb0tlZXBlciB0aHJlYWRzIHJlZ2lzdGVyIHRoZWlyIG93biBoYW5kbGVyLiBC\ndXQgaWYgc29tZSB3b3JrIHRoYXQKICAgICAgICAvLyB3ZSBkbyBpbiBaSyB0\naHJlYWRzIHRocm93cyBhbiBleGNlcHRpb24sIHdlIHdhbnQgb3VyIGhhbmRs\nZXIgdG8gYmUKICAgICAgICAvLyBjYWxsZWQsIG5vdCB0aGVpcnMuCiAgICAg\nICAgU2FmZUFzeW5jQ2FsbGJhY2suc2V0VW5jYXVnaHRFeGNlcHRpb25IYW5k\nbGVyKGV4Y2VwdGlvbkhhbmRsZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHN0YXJ0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgZmluYWwgU3lu\nY2hyb25vdXNRdWV1ZTxFaXRoZXI8T2JqZWN0LCBFeGNlcHRpb24+PiBxdWV1\nZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEVpdGhlcjxPYmplY3QsIEV4Y2Vw\ndGlvbj4+KCk7CgogICAgICAgIG5ldyBUaHJlYWQodGcsIG5ldyBSdW5uYWJs\nZSgpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgLy8gU2luY2UgemsgaXMgbmVlZGVkIGJ5IGFsbW9zdCBl\ndmVyeW9uZSx0cnkgdG8gc2VlIGlmIHdlCiAgICAgICAgICAgICAgICAgICAg\nLy8gbmVlZCB0aGF0IGZpcnN0CiAgICAgICAgICAgICAgICAgICAgc2NoZWR1\nbGVyID0gRXhlY3V0b3JzLm5ld1NpbmdsZVRocmVhZFNjaGVkdWxlZEV4ZWN1\ndG9yKCk7CiAgICAgICAgICAgICAgICAgICAgc2VydmVyQ2hhbm5lbEZhY3Rv\ncnkgPSBuZXcgTmlvU2VydmVyU29ja2V0Q2hhbm5lbEZhY3RvcnkoRXhlY3V0\nb3JzLm5ld0NhY2hlZFRocmVhZFBvb2woKSwgRXhlY3V0b3JzCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAubmV3Q2FjaGVkVGhyZWFkUG9vbCgpKTsK\nICAgICAgICAgICAgICAgICAgICBjbGllbnRDaGFubmVsRmFjdG9yeSA9IG5l\ndyBOaW9DbGllbnRTb2NrZXRDaGFubmVsRmFjdG9yeShFeGVjdXRvcnMubmV3\nQ2FjaGVkVGhyZWFkUG9vbCgpLCBFeGVjdXRvcnMKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIC5uZXdDYWNoZWRUaHJlYWRQb29sKCkpOwoKICAgICAg\nICAgICAgICAgICAgICBpbnN0YW50aWF0ZVpvb2tlZXBlckNsaWVudCgpOwog\nICAgICAgICAgICAgICAgICAgIHRtID0gaW5zdGFudGlhdGVUb3BpY01hbmFn\nZXIoKTsKICAgICAgICAgICAgICAgICAgICBwbSA9IGluc3RhbnRpYXRlUGVy\nc2lzdGVuY2VNYW5hZ2VyKHRtKTsKICAgICAgICAgICAgICAgICAgICBkbSA9\nIG5ldyBGSUZPRGVsaXZlcnlNYW5hZ2VyKHBtLCBjb25mKTsKICAgICAgICAg\nICAgICAgICAgICBkbS5zdGFydCgpOwoKICAgICAgICAgICAgICAgICAgICBz\nbSA9IGluc3RhbnRpYXRlU3Vic2NyaXB0aW9uTWFuYWdlcih0bSwgcG0pOwog\nICAgICAgICAgICAgICAgICAgIHJtID0gaW5zdGFudGlhdGVSZWdpb25NYW5h\nZ2VyKHBtLCBzY2hlZHVsZXIpOwogICAgICAgICAgICAgICAgICAgIHNtLmFk\nZExpc3RlbmVyKHJtKTsKCiAgICAgICAgICAgICAgICAgICAgYWxsQ2hhbm5l\nbHMgPSBuZXcgRGVmYXVsdENoYW5uZWxHcm91cCgiaGVkd2lnIik7CiAgICAg\nICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgTmV0dHkgSGFuZGxl\ncnMgKHVzZWQgYnkgdGhlCiAgICAgICAgICAgICAgICAgICAgLy8gVW1icmVs\nbGFIYW5kbGVyKSBvbmNlIHNvIHRoZXkgY2FuIGJlIHNoYXJlZCBieQogICAg\nICAgICAgICAgICAgICAgIC8vIGJvdGggdGhlIFNTTCBhbmQgbm9uLVNTTCBj\naGFubmVscy4KICAgICAgICAgICAgICAgICAgICBNYXA8T3BlcmF0aW9uVHlw\nZSwgSGFuZGxlcj4gaGFuZGxlcnMgPSBpbml0aWFsaXplTmV0dHlIYW5kbGVy\ncyh0bSwgZG0sIHBtLCBzbSk7CiAgICAgICAgICAgICAgICAgICAgLy8gSW5p\ndGlhbGl6ZSBOZXR0eSBmb3IgdGhlIHJlZ3VsYXIgbm9uLVNTTCBjaGFubmVs\ncwogICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVOZXR0eShudWxsLCBo\nYW5kbGVycyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmYuaXNTU0xF\nbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbGl6\nZU5ldHR5KG5ldyBTc2xTZXJ2ZXJDb250ZXh0RmFjdG9yeShjb25mKSwgaGFu\nZGxlcnMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICAvLyByZWdpc3RlciBqbXgKICAgICAgICAgICAgICAgICAgICByZWdp\nc3RlckpNWChoYW5kbGVycyk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIENvbmN1cnJlbmN5\nVXRpbHMucHV0KHF1ZXVlLCBFaXRoZXIucmlnaHQoZSkpOwogICAgICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgICAgICBDb25jdXJyZW5jeVV0aWxzLnB1dChxdWV1ZSwgRWl0aGVyLm9m\nKG5ldyBPYmplY3QoKSwgKEV4Y2VwdGlvbikgbnVsbCkpOwogICAgICAgICAg\nICB9CgogICAgICAgIH0pLnN0YXJ0KCk7CgogICAgICAgIEVpdGhlcjxPYmpl\nY3QsIEV4Y2VwdGlvbj4gZWl0aGVyID0gQ29uY3VycmVuY3lVdGlscy50YWtl\nKHF1ZXVlKTsKICAgICAgICBpZiAoZWl0aGVyLmxlZnQoKSA9PSBudWxsKSB7\nCiAgICAgICAgICAgIHRocm93IGVpdGhlci5yaWdodCgpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgUHViU3ViU2VydmVyKFNlcnZlckNvbmZpZ3Vy\nYXRpb24gY29uZikgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdGhpcyhj\nb25mLCBuZXcgVGVybWluYXRlSlZNRXhjZXB0aW9uSGFuZGxlcigpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqCiAgICAgKiBAcGFyYW0gbXNnCiAgICAgKiBA\ncGFyYW0gcmMKICAgICAqICAgICAgICAgICAgOiBjb2RlIHRvIGV4aXQgd2l0\naAogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgZXJyb3JNc2dBbmRF\neGl0KFN0cmluZyBtc2csIFRocm93YWJsZSB0LCBpbnQgcmMpIHsKICAgICAg\nICBsb2dnZXIuZXJyb3IobXNnLCB0KTsKICAgICAgICBTeXN0ZW0uZXJyLnBy\naW50bG4obXNnKTsKICAgICAgICBTeXN0ZW0uZXhpdChyYyk7CiAgICB9Cgog\nICAgcHVibGljIGZpbmFsIHN0YXRpYyBpbnQgUkNfSU5WQUxJRF9DT05GX0ZJ\nTEUgPSAxOwogICAgcHVibGljIGZpbmFsIHN0YXRpYyBpbnQgUkNfTUlTQ09O\nRklHVVJFRCA9IDI7CiAgICBwdWJsaWMgZmluYWwgc3RhdGljIGludCBSQ19P\nVEhFUiA9IDM7CgogICAgLyoqCiAgICAgKiBAcGFyYW0gYXJncwogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7\nCgogICAgICAgIGxvZ2dlci5pbmZvKCJBdHRlbXB0aW5nIHRvIHN0YXJ0IEhl\nZHdpZyIpOwogICAgICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY29uZiA9IG5l\ndyBTZXJ2ZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKGFyZ3MubGVu\nZ3RoID4gMCkgewogICAgICAgICAgICBTdHJpbmcgY29uZkZpbGUgPSBhcmdz\nWzBdOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uZi5s\nb2FkQ29uZihuZXcgRmlsZShjb25mRmlsZSkudG9VUkkoKS50b1VSTCgpKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoTWFsZm9ybWVkVVJMRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIFN0cmluZyBtc2cgPSAiQ291bGQgbm90IG9w\nZW4gY29uZmlndXJhdGlvbiBmaWxlOiAiICsgY29uZkZpbGU7CiAgICAgICAg\nICAgICAgICBlcnJvck1zZ0FuZEV4aXQobXNnLCBlLCBSQ19JTlZBTElEX0NP\nTkZfRklMRSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKENvbmZpZ3VyYXRpb25F\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgU3RyaW5nIG1zZyA9ICJN\nYWxmb3JtZWQgY29uZmlndXJhdGlvbiBmaWxlOiAiICsgY29uZkZpbGU7CiAg\nICAgICAgICAgICAgICBlcnJvck1zZ0FuZEV4aXQobXNnLCBlLCBSQ19NSVND\nT05GSUdVUkVEKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsb2dnZXIu\naW5mbygiVXNpbmcgY29uZmlndXJhdGlvbiBmaWxlICIgKyBjb25mRmlsZSk7\nCiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG5ldyBQdWJT\ndWJTZXJ2ZXIoY29uZikuc3RhcnQoKTsKICAgICAgICB9IGNhdGNoIChUaHJv\nd2FibGUgdCkgewogICAgICAgICAgICBlcnJvck1zZ0FuZEV4aXQoIkVycm9y\nIGR1cmluZyBzdGFydHVwIiwgdCwgUkNfT1RIRVIpOwogICAgICAgIH0KICAg\nIH0KfQo=\n","encoding":"base64"}

