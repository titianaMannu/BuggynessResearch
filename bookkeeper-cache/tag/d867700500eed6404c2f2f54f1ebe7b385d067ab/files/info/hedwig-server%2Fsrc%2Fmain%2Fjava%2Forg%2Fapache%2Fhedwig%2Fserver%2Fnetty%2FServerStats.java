{"sha":"641e187198fcaf65396b2a27ed97a3135656d251","node_id":"MDQ6QmxvYjE1NzU5NTY6NjQxZTE4NzE5OGZjYWY2NTM5NmIyYTI3ZWQ5N2EzMTM1NjU2ZDI1MQ==","size":5619,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/641e187198fcaf65396b2a27ed97a3135656d251","content":"LyoKICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJz\naW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90IHVzZSB0\naGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5z\nZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0\nCiAqCiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElD\nRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUg\nbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiBkaXN0\ncmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBh\nbiAiQVMgSVMiIEJBU0lTLAogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09O\nRElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGll\nZC4KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3Vh\nZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiBsaW1pdGF0aW9ucyB1\nbmRlciB0aGUgTGljZW5zZS4KICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuaGVk\nd2lnLnNlcnZlci5uZXR0eTsKCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsK\naW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgamF2YS5iZWFucy5Db25z\ndHJ1Y3RvclByb3BlcnRpZXM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVu\ndC5hdG9taWMuQXRvbWljTG9uZzsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5wcm90b2NvbC5QdWJTdWJQcm90b2NvbC5PcGVyYXRpb25UeXBlOwoKLyoq\nCiAqIFNlcnZlciBTdGF0cwogKi8KcHVibGljIGNsYXNzIFNlcnZlclN0YXRz\nIHsKICAgIHN0YXRpYyBTZXJ2ZXJTdGF0cyBpbnN0YW5jZSA9IG5ldyBTZXJ2\nZXJTdGF0cygpOwoKICAgIC8qKgogICAgICogQSByZWFkIHZpZXcgb2Ygc3Rh\ndHMsIGFsc28gdXNlZCBpbiBDb21wb3NpdGVWaWV3RGF0YSB0byBleHBvc2Ug\ndG8gSk1YCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgT3BTdGF0\nRGF0YSB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBsb25nIG1heExhdGVuY3ks\nIG1pbkxhdGVuY3k7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBkb3VibGUgYXZn\nTGF0ZW5jeTsKICAgICAgICBwcml2YXRlIGZpbmFsIGxvbmcgbnVtU3VjY2Vz\nc09wcywgbnVtRmFpbGVkT3BzOwogICAgICAgIHByaXZhdGUgZmluYWwgU3Ry\naW5nIGxhdGVuY3lIaXN0OwoKICAgICAgICBAQ29uc3RydWN0b3JQcm9wZXJ0\naWVzKHsibWF4TGF0ZW5jeSIsICJtaW5MYXRlbmN5IiwgImF2Z0xhdGVuY3ki\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJudW1TdWNjZXNz\nT3BzIiwgIm51bUZhaWxlZE9wcyIsICJsYXRlbmN5SGlzdCJ9KQogICAgICAg\nIHB1YmxpYyBPcFN0YXREYXRhKGxvbmcgbWF4TGF0ZW5jeSwgbG9uZyBtaW5M\nYXRlbmN5LCBkb3VibGUgYXZnTGF0ZW5jeSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICBsb25nIG51bVN1Y2Nlc3NPcHMsIGxvbmcgbnVtRmFpbGVkT3Bz\nLCBTdHJpbmcgbGF0ZW5jeUhpc3QpIHsKICAgICAgICAgICAgdGhpcy5tYXhM\nYXRlbmN5ID0gbWF4TGF0ZW5jeTsKICAgICAgICAgICAgdGhpcy5taW5MYXRl\nbmN5ID0gbWluTGF0ZW5jeSA9PSBMb25nLk1BWF9WQUxVRSA/IDAgOiBtaW5M\nYXRlbmN5OwogICAgICAgICAgICB0aGlzLmF2Z0xhdGVuY3kgPSBhdmdMYXRl\nbmN5OwogICAgICAgICAgICB0aGlzLm51bVN1Y2Nlc3NPcHMgPSBudW1TdWNj\nZXNzT3BzOwogICAgICAgICAgICB0aGlzLm51bUZhaWxlZE9wcyA9IG51bUZh\naWxlZE9wczsKICAgICAgICAgICAgdGhpcy5sYXRlbmN5SGlzdCA9IGxhdGVu\nY3lIaXN0OwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0TWF4\nTGF0ZW5jeSgpIHsKICAgICAgICAgICAgcmV0dXJuIG1heExhdGVuY3k7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRNaW5MYXRlbmN5KCkg\newogICAgICAgICAgICByZXR1cm4gbWluTGF0ZW5jeTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBkb3VibGUgZ2V0QXZnTGF0ZW5jeSgpIHsKICAgICAg\nICAgICAgcmV0dXJuIGF2Z0xhdGVuY3k7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgbG9uZyBnZXROdW1TdWNjZXNzT3BzKCkgewogICAgICAgICAgICBy\nZXR1cm4gbnVtU3VjY2Vzc09wczsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBsb25nIGdldE51bUZhaWxlZE9wcygpIHsKICAgICAgICAgICAgcmV0dXJu\nIG51bUZhaWxlZE9wczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJp\nbmcgZ2V0TGF0ZW5jeUhpc3QoKSB7CiAgICAgICAgICAgIHJldHVybiBsYXRl\nbmN5SGlzdDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBPcGVy\nYXRpb24gU3RhdGlzdGljcwogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIE9wU3RhdHMgewogICAgICAgIHN0YXRpYyBmaW5hbCBpbnQgTlVNX0JV\nQ0tFVFMgPSAzKjkgKyAyOwoKICAgICAgICBsb25nIG1heExhdGVuY3kgPSAw\nOwogICAgICAgIGxvbmcgbWluTGF0ZW5jeSA9IExvbmcuTUFYX1ZBTFVFOwog\nICAgICAgIGRvdWJsZSB0b3RhbExhdGVuY3kgPSAwLjBmOwogICAgICAgIGxv\nbmcgbnVtU3VjY2Vzc09wcyA9IDA7CiAgICAgICAgbG9uZyBudW1GYWlsZWRP\ncHMgPSAwOwogICAgICAgIGxvbmdbXSBsYXRlbmN5QnVja2V0cyA9IG5ldyBs\nb25nW05VTV9CVUNLRVRTXTsKCiAgICAgICAgT3BTdGF0cygpIHt9CgogICAg\nICAgIC8qKgogICAgICAgICAqIEluY3JlbWVudCBudW1iZXIgb2YgZmFpbGVk\nIG9wZXJhdGlvbnMKICAgICAgICAgKi8KICAgICAgICBzeW5jaHJvbml6ZWQg\ncHVibGljIHZvaWQgaW5jcmVtZW50RmFpbGVkT3BzKCkgewogICAgICAgICAg\nICArK251bUZhaWxlZE9wczsKICAgICAgICB9CgogICAgICAgIC8qKgogICAg\nICAgICAqIFVwZGF0ZSBMYXRlbmN5CiAgICAgICAgICovCiAgICAgICAgc3lu\nY2hyb25pemVkIHB1YmxpYyB2b2lkIHVwZGF0ZUxhdGVuY3kobG9uZyBsYXRl\nbmN5KSB7CiAgICAgICAgICAgIHRvdGFsTGF0ZW5jeSArPSBsYXRlbmN5Owog\nICAgICAgICAgICArK251bVN1Y2Nlc3NPcHM7CiAgICAgICAgICAgIGlmIChs\nYXRlbmN5IDwgbWluTGF0ZW5jeSkgewogICAgICAgICAgICAgICAgbWluTGF0\nZW5jeSA9IGxhdGVuY3k7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKGxhdGVuY3kgPiBtYXhMYXRlbmN5KSB7CiAgICAgICAgICAgICAgICBtYXhM\nYXRlbmN5ID0gbGF0ZW5jeTsKICAgICAgICAgICAgfQogICAgICAgICAgICBp\nbnQgYnVja2V0OwogICAgICAgICAgICBpZiAobGF0ZW5jeSA8PSAxMDApIHsg\nLy8gbGVzcyB0aGFuIDEwMG1zCiAgICAgICAgICAgICAgICBidWNrZXQgPSAo\naW50KShsYXRlbmN5IC8gMTApOwogICAgICAgICAgICB9IGVsc2UgaWYgKGxh\ndGVuY3kgPD0gMTAwMCkgeyAvLyAxMDBtcyB+IDEwMDBtcwogICAgICAgICAg\nICAgICAgYnVja2V0ID0gMSAqIDkgKyAoaW50KShsYXRlbmN5IC8gMTAwKTsK\nICAgICAgICAgICAgfSBlbHNlIGlmIChsYXRlbmN5IDw9IDEwMDAwKSB7IC8v\nIDFzIH4gMTBzCiAgICAgICAgICAgICAgICBidWNrZXQgPSAyICogOSArIChp\nbnQpKGxhdGVuY3kgLyAxMDAwKTsKICAgICAgICAgICAgfSBlbHNlIHsgLy8g\nbW9yZSB0aGFuIDEwcwogICAgICAgICAgICAgICAgYnVja2V0ID0gMyAqIDkg\nKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgICsrbGF0ZW5jeUJ1Y2tl\ndHNbYnVja2V0XTsKICAgICAgICB9CgogICAgICAgIHN5bmNocm9uaXplZCBw\ndWJsaWMgT3BTdGF0RGF0YSB0b09wU3RhdERhdGEoKSB7CiAgICAgICAgICAg\nIGRvdWJsZSBhdmdMYXRlbmN5ID0gbnVtU3VjY2Vzc09wcyA+IDAgPyB0b3Rh\nbExhdGVuY3kgLyBudW1TdWNjZXNzT3BzIDogMC4wZjsKICAgICAgICAgICAg\nU3RyaW5nQnVpbGRlciBzYiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGk9MDsgaTxOVU1fQlVDS0VUUzsgaSsrKSB7CiAg\nICAgICAgICAgICAgICBzYi5hcHBlbmQobGF0ZW5jeUJ1Y2tldHNbaV0pOwog\nICAgICAgICAgICAgICAgaWYgKGkgIT0gTlVNX0JVQ0tFVFMgLSAxKSB7CiAg\nICAgICAgICAgICAgICAgICAgc2IuYXBwZW5kKCcsJyk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBuZXcg\nT3BTdGF0RGF0YShtYXhMYXRlbmN5LCBtaW5MYXRlbmN5LCBhdmdMYXRlbmN5\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtU3VjY2Vz\nc09wcywgbnVtRmFpbGVkT3BzLCBzYi50b1N0cmluZygpKTsKICAgICAgICB9\nCgogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgU2VydmVyU3RhdHMgZ2V0SW5z\ndGFuY2UoKSB7CiAgICAgICAgcmV0dXJuIGluc3RhbmNlOwogICAgfQoKICAg\nIHByb3RlY3RlZCBTZXJ2ZXJTdGF0cygpIHsKICAgICAgICBzdGF0cyA9IG5l\ndyBIYXNoTWFwPE9wZXJhdGlvblR5cGUsIE9wU3RhdHM+KCk7CiAgICAgICAg\nZm9yIChPcGVyYXRpb25UeXBlIHR5cGUgOiBPcGVyYXRpb25UeXBlLnZhbHVl\ncygpKSB7CiAgICAgICAgICAgIHN0YXRzLnB1dCh0eXBlLCBuZXcgT3BTdGF0\ncygpKTsKICAgICAgICB9CiAgICB9CiAgICBNYXA8T3BlcmF0aW9uVHlwZSwg\nT3BTdGF0cz4gc3RhdHM7CgoKICAgIEF0b21pY0xvbmcgbnVtUmVxdWVzdHNS\nZWNlaXZlZCA9IG5ldyBBdG9taWNMb25nKDApOwogICAgQXRvbWljTG9uZyBu\ndW1SZXF1ZXN0c1JlZGlyZWN0ID0gbmV3IEF0b21pY0xvbmcoMCk7CiAgICBB\ndG9taWNMb25nIG51bU1lc3NhZ2VzRGVsaXZlcmVkID0gbmV3IEF0b21pY0xv\nbmcoMCk7CgogICAgLyoqCiAgICAgKiBTdGF0cyBvZiBvcGVyYXRpb25zCiAg\nICAgKgogICAgICogQHBhcmFtIHR5cGUKICAgICAqICAgICAgICAgIE9wZXJh\ndGlvbiBUeXBlCiAgICAgKiBAcmV0dXJuIG9wIHN0YXRzCiAgICAgKi8KICAg\nIHB1YmxpYyBPcFN0YXRzIGdldE9wU3RhdHMoT3BlcmF0aW9uVHlwZSB0eXBl\nKSB7CiAgICAgICAgcmV0dXJuIHN0YXRzLmdldCh0eXBlKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBpbmNyZW1lbnRSZXF1ZXN0c1JlY2VpdmVkKCkgewog\nICAgICAgIG51bVJlcXVlc3RzUmVjZWl2ZWQuaW5jcmVtZW50QW5kR2V0KCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgaW5jcmVtZW50UmVxdWVzdHNSZWRp\ncmVjdCgpIHsKICAgICAgICBudW1SZXF1ZXN0c1JlZGlyZWN0LmluY3JlbWVu\ndEFuZEdldCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluY3JlbWVudE1l\nc3NhZ2VzRGVsaXZlcmVkKCkgewogICAgICAgIG51bU1lc3NhZ2VzRGVsaXZl\ncmVkLmluY3JlbWVudEFuZEdldCgpOwogICAgfQoKICAgIHB1YmxpYyBsb25n\nIGdldE51bVJlcXVlc3RzUmVjZWl2ZWQoKSB7CiAgICAgICAgcmV0dXJuIG51\nbVJlcXVlc3RzUmVjZWl2ZWQuZ2V0KCk7CiAgICB9CgogICAgcHVibGljIGxv\nbmcgZ2V0TnVtUmVxdWVzdHNSZWRpcmVjdCgpIHsKICAgICAgICByZXR1cm4g\nbnVtUmVxdWVzdHNSZWRpcmVjdC5nZXQoKTsKICAgIH0KCiAgICBwdWJsaWMg\nbG9uZyBnZXROdW1NZXNzYWdlc0RlbGl2ZXJlZCgpIHsKICAgICAgICByZXR1\ncm4gbnVtTWVzc2FnZXNEZWxpdmVyZWQuZ2V0KCk7CiAgICB9Cn0K\n","encoding":"base64"}

