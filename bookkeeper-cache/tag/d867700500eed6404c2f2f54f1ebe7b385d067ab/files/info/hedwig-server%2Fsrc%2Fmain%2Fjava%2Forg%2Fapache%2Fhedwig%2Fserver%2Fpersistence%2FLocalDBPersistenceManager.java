{"sha":"a8b9f743922c33f654b8ef3bd76f53a89d2cfbdc","node_id":"MDQ6QmxvYjE1NzU5NTY6YThiOWY3NDM5MjJjMzNmNjU0YjhlZjNiZDc2ZjUzYTg5ZDJjZmJkYw==","size":17769,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/a8b9f743922c33f654b8ef3bd76f53a89d2cfbdc","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZhLnNx\nbC5Ecml2ZXJNYW5hZ2VyOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0\nZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZh\nLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5TdGF0ZW1lbnQ7\nCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1h\ncDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRNYXA7\nCgppbXBvcnQgamF2YS5tYXRoLkJpZ0ludGVnZXI7CmltcG9ydCBqYXZhLnNl\nY3VyaXR5Lk1lc3NhZ2VEaWdlc3Q7CmltcG9ydCBqYXZhLnNlY3VyaXR5Lk5v\nU3VjaEFsZ29yaXRobUV4Y2VwdGlvbjsKCmltcG9ydCBqYXZheC5zcWwucm93\nc2V0LnNlcmlhbC5TZXJpYWxCbG9iOwoKaW1wb3J0IG9yZy5zbGY0ai5Mb2dn\nZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBj\nb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLmhlZHdpZy5leGNlcHRpb25zLlB1YlN1YkV4Y2VwdGlvbi5TZXJ2aWNl\nRG93bkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2Vw\ndGlvbnMuUHViU3ViRXhjZXB0aW9uLlVuZXhwZWN0ZWRDb25kaXRpb25FeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZVNlcUlkOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9leHRlbnNpb25zLk1lc3NhZ2VJZFV0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnBlcnNpc3Rl\nbmNlLlNjYW5DYWxsYmFjay5SZWFzb25Gb3JGaW5pc2g7CmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy51dGlsLkNhbGxiYWNrOwppbXBvcnQgb3JnLmFwYWNo\nZS5oZWR3aWcudXRpbC5GaWxlVXRpbHM7CgpwdWJsaWMgY2xhc3MgTG9jYWxE\nQlBlcnNpc3RlbmNlTWFuYWdlciBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlTWFu\nYWdlcldpdGhSYW5nZVNjYW4gewogICAgc3RhdGljIExvZ2dlciBsb2dnZXIg\nPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMb2NhbERCUGVyc2lzdGVuY2VN\nYW5hZ2VyLmNsYXNzKTsKCiAgICBzdGF0aWMgU3RyaW5nIGNvbm5lY3Rpb25V\nUkw7CgogICAgc3RhdGljIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBG\naWxlIHRlbXBEaXIgPSBGaWxlVXRpbHMuY3JlYXRlVGVtcERpcmVjdG9yeSgi\nZGVyYnkiLCBudWxsKTsKCiAgICAgICAgICAgIC8vIFNpbmNlIGRlcmJ5IG5l\nZWRzIHRvIGNyZWF0ZSBpdCwgSSB3aWxsIGhhdmUgdG8gZGVsZXRlIGl0IGZp\ncnN0CiAgICAgICAgICAgIGlmICghdGVtcERpci5kZWxldGUoKSkgewogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IElPRXhjZXB0aW9uKCJDb3VsZCBub3Qg\nZGVsZXRlIGRpcjogIiArIHRlbXBEaXIuZ2V0QWJzb2x1dGVQYXRoKCkpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbm5lY3Rpb25VUkwgPSAiamRi\nYzpkZXJieToiICsgdGVtcERpci5nZXRBYnNvbHV0ZVBhdGgoKSArICI7Y3Jl\nYXRlPXRydWUiOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZSk7CiAg\nICAgICAgfQoKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBUaHJl\nYWRMb2NhbDxDb25uZWN0aW9uPiB0aHJlYWRMb2NhbENvbm5lY3Rpb24gPSBu\nZXcgVGhyZWFkTG9jYWw8Q29ubmVjdGlvbj4oKSB7CiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHJvdGVjdGVkIENvbm5lY3Rpb24gaW5pdGlhbFZhbHVl\nKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJu\nIERyaXZlck1hbmFnZXIuZ2V0Q29ubmVjdGlvbihjb25uZWN0aW9uVVJMKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIGxvZ2dlci5lcnJvcigiQ291bGQgbm90IGNvbm5lY3QgdG8g\nZGVyYnkiLCBlKTsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBUaHJlYWRMb2NhbDxNZXNzYWdlRGlnZXN0PiB0aHJlYWRMb2Nh\nbERpZ2VzdCA9IG5ldyBUaHJlYWRMb2NhbDxNZXNzYWdlRGlnZXN0PigpIHsK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgTWVzc2FnZURp\nZ2VzdCBpbml0aWFsVmFsdWUoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gTWVzc2FnZURpZ2VzdC5nZXRJbnN0YW5jZSgi\nTUQ1Iik7CiAgICAgICAgICAgIH0gY2F0Y2ggKE5vU3VjaEFsZ29yaXRobUV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkNv\ndWxkIG5vdCBmaW5kIE1ENSBoYXNoIiwgZSk7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAg\nICBzdGF0aWMgZmluYWwgU3RyaW5nIElEX0ZJRUxEX05BTUUgPSAiaWQiOwog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBNU0dfRklFTERfTkFNRSA9ICJtc2ci\nOwogICAgc3RhdGljIGZpbmFsIFN0cmluZyBkcml2ZXIgPSAib3JnLmFwYWNo\nZS5kZXJieS5qZGJjLkVtYmVkZGVkRHJpdmVyIjsKCiAgICBzdGF0aWMgZmlu\nYWwgaW50IFNDQU5fQ0hVTksgPSAxMDAwOwoKICAgIC8qKgogICAgICogSGF2\naW5nIHRyb3VibGUgcmVzdGFydGluZyB0aGUgZGF0YWJhc2UgbXVsdGlwbGUg\ndGltZXMgZnJvbSB3aXRoaW4gdGhlCiAgICAgKiBzYW1lIGp2bS4gSGVuY2Ug\ndG8gZmFjaWxpdGF0ZSB1bml0cyB0ZXN0cywgd2UgYXJlIGp1c3QgZ29pbmcg\ndG8gaGF2ZSBhCiAgICAgKiB2ZXJzaW9uIG51bWJlciB0aGF0IHdlIHdpbGwg\nYXBwZW5kIHRvIGV2ZXJ5IHRhYmxlIG5hbWUuIFRoaXMgdmVyc2lvbgogICAg\nICogbnVtYmVyIHdpbGwgYmUgaW5jcmVtZW50ZWQgaW4gbGlldSBvZiBzaHV0\ndGluZyBkb3duIHRoZSBkYXRhYmFzZSBhbmQKICAgICAqIHJlc3RhcnRpbmcg\naXQsIHNvIHRoYXQgd2UgZ2V0IGRpZmZlcmVudCB0YWJsZSBuYW1lcywgYW5k\nIGl0IGJlaGF2ZXMgbGlrZQogICAgICogYSBicmFuZCBuZXcgZGF0YWJhc2UK\nICAgICAqLwogICAgcHJpdmF0ZSBpbnQgdmVyc2lvbiA9IDA7CgogICAgQ29u\nY3VycmVudE1hcDxCeXRlU3RyaW5nLCBNZXNzYWdlU2VxSWQ+IGN1cnJUb3Bp\nY1NlcUlkcyA9IG5ldyBDb25jdXJyZW50SGFzaE1hcDxCeXRlU3RyaW5nLCBN\nZXNzYWdlU2VxSWQ+KCk7CgogICAgc3RhdGljIExvY2FsREJQZXJzaXN0ZW5j\nZU1hbmFnZXIgaW5zdGFuY2UgPSBuZXcgTG9jYWxEQlBlcnNpc3RlbmNlTWFu\nYWdlcigpOwoKICAgIHB1YmxpYyBzdGF0aWMgTG9jYWxEQlBlcnNpc3RlbmNl\nTWFuYWdlciBpbnN0YW5jZSgpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2U7\nCiAgICB9CgogICAgcHJpdmF0ZSBMb2NhbERCUGVyc2lzdGVuY2VNYW5hZ2Vy\nKCkgewoKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFzcy5mb3JOYW1l\nKGRyaXZlcikubmV3SW5zdGFuY2UoKTsKICAgICAgICAgICAgbG9nZ2VyLmlu\nZm8oIkRlcmJ5IERyaXZlciBsb2FkZWQiKTsKICAgICAgICB9IGNhdGNoIChq\nYXZhLmxhbmcuQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIGxvZ2dlci5lcnJvcigiRGVyYnkgZHJpdmVyIG5vdCBmb3VuZCIsIGUp\nOwogICAgICAgIH0gY2F0Y2ggKEluc3RhbnRpYXRpb25FeGNlcHRpb24gZSkg\newogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkNvdWxkIG5vdCBpbnN0YW50\naWF0ZSBkZXJieSBkcml2ZXIiLCBlKTsKICAgICAgICB9IGNhdGNoIChJbGxl\nZ2FsQWNjZXNzRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLmVy\ncm9yKCJDb3VsZCBub3QgaW5zdGFudGlhdGUgZGVyYnkgZHJpdmVyIiwgZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRW5zdXJlcyB0aGF0\nIGF0IGxlYXN0IHRoZSBkZWZhdWx0IHNlcS1pZCBleGlzdHMgaW4gdGhlIG1h\ncCBmb3IgdGhlIGdpdmVuCiAgICAgKiB0b3BpYy4gQ2hlY2tzIGZvciByYWNl\nIGNvbmRpdGlvbnMgKC5lLmcsIGFub3RoZXIgdGhyZWFkIGluc2VydHMgdGhl\nCiAgICAgKiBkZWZhdWx0IGlkIGJlZm9yZSB1cyksIGFuZCByZXR1cm5zIHRo\nZSBsYXRlc3Qgc2VxLWlkIHZhbHVlIGluIHRoZSBtYXAKICAgICAqCiAgICAg\nKiBAcGFyYW0gdG9waWMKICAgICAqIEByZXR1cm4KICAgICAqLwogICAgcHJp\ndmF0ZSBNZXNzYWdlU2VxSWQgZW5zdXJlU2VxSWRFeGlzdHNGb3JUb3BpYyhC\neXRlU3RyaW5nIHRvcGljKSB7CiAgICAgICAgTWVzc2FnZVNlcUlkIHByZXNl\nbnRTZXFJZEluTWFwID0gY3VyclRvcGljU2VxSWRzLmdldCh0b3BpYyk7Cgog\nICAgICAgIGlmIChwcmVzZW50U2VxSWRJbk1hcCAhPSBudWxsKSB7CiAgICAg\nICAgICAgIHJldHVybiBwcmVzZW50U2VxSWRJbk1hcDsKICAgICAgICB9Cgog\nICAgICAgIHByZXNlbnRTZXFJZEluTWFwID0gTWVzc2FnZVNlcUlkLm5ld0J1\naWxkZXIoKS5zZXRMb2NhbENvbXBvbmVudCgwKS5idWlsZCgpOwogICAgICAg\nIE1lc3NhZ2VTZXFJZCBvbGRTZXFJZEluTWFwID0gY3VyclRvcGljU2VxSWRz\nLnB1dElmQWJzZW50KHRvcGljLCBwcmVzZW50U2VxSWRJbk1hcCk7CgogICAg\nICAgIGlmIChvbGRTZXFJZEluTWFwICE9IG51bGwpIHsKICAgICAgICAgICAg\ncmV0dXJuIG9sZFNlcUlkSW5NYXA7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBwcmVzZW50U2VxSWRJbk1hcDsKCiAgICB9CgogICAgLyoqCiAgICAgKiBB\nZGp1c3QgdGhlIGN1cnJlbnQgc2VxIGlkIG9mIHRoZSB0b3BpYyBiYXNlZCBv\nbiB0aGUgbWVzc2FnZSB3ZSBhcmUgYWJvdXQKICAgICAqIHRvIHB1Ymxpc2gu\nIFRoZSBsb2NhbCBjb21wb25lbnQgb2YgdGhlIGN1cnJlbnQgc2VxLWlkIGlz\nIGFsd2F5cwogICAgICogaW5jcmVtZW50ZWQgYnkgMS4gRm9yIHRoZSBvdGhl\nciBjb21wb25lbnRzLCB0aGVyZSBhcmUgdHdvIGNhc2VzOgogICAgICoKICAg\nICAqIDEuIElmIHRoZSBtZXNzYWdlIHRvIGJlIHB1Ymxpc2hlZCBkb2Vzbid0\nIGhhdmUgYSBzZXEtaWQgKGxvY2FsbHkKICAgICAqIHB1Ymxpc2hlZCBtZXNz\nYWdlcyksIHRoZSBvdGhlciBjb21wb25lbnRzIGFyZSBsZWZ0IGFzIGlzLgog\nICAgICoKICAgICAqIDIuIElmIHRoZSBtZXNzYWdlIHRvIGJlIHB1Ymxpc2hl\nZCBoYXMgYSBzZXEtaWQsIHdlIHRha2UgdGhlIG1heCBvZiB0aGUKICAgICAq\nIGN1cnJlbnQgb25lIHdlIGhhdmUsIGFuZCB0aGF0IGluIHRoZSBtZXNzYWdl\nIHRvIGJlIHB1Ymxpc2hlZC4KICAgICAqCiAgICAgKiBAcGFyYW0gdG9waWMK\nICAgICAqIEBwYXJhbSBtZXNzYWdlVG9QdWJsaXNoCiAgICAgKiBAcmV0dXJu\nIFRoZSB2YWx1ZSBvZiB0aGUgbG9jYWwgc2VxLWlkIG9idGFpbmVkIGFmdGVy\nIGluY3JlbWVudGluZyB0aGUKICAgICAqICAgICAgICAgbG9jYWwgY29tcG9u\nZW50LiBUaGlzIHZhbHVlIHNob3VsZCBiZSB1c2VkIGFzIGFuIGlkIHdoaWxl\nCiAgICAgKiAgICAgICAgIHBlcnNpc3RpbmcgdG8gRGVyYnkKICAgICAqIEB0\naHJvd3MgVW5leHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbgogICAgICovCiAg\nICBwcml2YXRlIGxvbmcgYWRqdXN0VG9waWNTZXFJZEZvclB1Ymxpc2goQnl0\nZVN0cmluZyB0b3BpYywgTWVzc2FnZSBtZXNzYWdlVG9QdWJsaXNoKQogICAg\nICAgICAgICB0aHJvd3MgVW5leHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbiB7\nCiAgICAgICAgbG9uZyByZXRWYWx1ZSA9IDA7CiAgICAgICAgTWVzc2FnZVNl\ncUlkIG9sZElkOwogICAgICAgIE1lc3NhZ2VTZXFJZC5CdWlsZGVyIG5ld0lk\nQnVpbGRlciA9IE1lc3NhZ2VTZXFJZC5uZXdCdWlsZGVyKCk7CgogICAgICAg\nIGRvIHsKICAgICAgICAgICAgb2xkSWQgPSBlbnN1cmVTZXFJZEV4aXN0c0Zv\nclRvcGljKHRvcGljKTsKCiAgICAgICAgICAgIC8vIEluY3JlbWVudCBvdXIg\nb3duIGNvbXBvbmVudCBieSAxCiAgICAgICAgICAgIHJldFZhbHVlID0gb2xk\nSWQuZ2V0TG9jYWxDb21wb25lbnQoKSArIDE7CiAgICAgICAgICAgIG5ld0lk\nQnVpbGRlci5zZXRMb2NhbENvbXBvbmVudChyZXRWYWx1ZSk7CgogICAgICAg\nICAgICBpZiAobWVzc2FnZVRvUHVibGlzaC5oYXNNc2dJZCgpKSB7CiAgICAg\nICAgICAgICAgICAvLyB0YWtlIGEgcmVnaW9uLXdpc2UgbWF4CiAgICAgICAg\nICAgICAgICBNZXNzYWdlSWRVdGlscy50YWtlUmVnaW9uTWF4aW11bShuZXdJ\nZEJ1aWxkZXIsIG1lc3NhZ2VUb1B1Ymxpc2guZ2V0TXNnSWQoKSwgb2xkSWQp\nOwoKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5ld0lk\nQnVpbGRlci5hZGRBbGxSZW1vdGVDb21wb25lbnRzKG9sZElkLmdldFJlbW90\nZUNvbXBvbmVudHNMaXN0KCkpOwogICAgICAgICAgICB9CiAgICAgICAgfSB3\naGlsZSAoIWN1cnJUb3BpY1NlcUlkcy5yZXBsYWNlKHRvcGljLCBvbGRJZCwg\nbmV3SWRCdWlsZGVyLmJ1aWxkKCkpKTsKCiAgICAgICAgcmV0dXJuIHJldFZh\nbHVlOwoKICAgIH0KCiAgICBwdWJsaWMgbG9uZyBnZXRTZXFJZEFmdGVyU2tp\ncHBpbmcoQnl0ZVN0cmluZyB0b3BpYywgbG9uZyBzZXFJZCwgaW50IHNraXBB\nbW91bnQpIHsKICAgICAgICByZXR1cm4gc2VxSWQgKyBza2lwQW1vdW50Owog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHBlcnNpc3RNZXNzYWdlKFBlcnNpc3RS\nZXF1ZXN0IHJlcXVlc3QpIHsKCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0g\ndGhyZWFkTG9jYWxDb25uZWN0aW9uLmdldCgpOwoKICAgICAgICBDYWxsYmFj\nazxMb25nPiBjYWxsYmFjayA9IHJlcXVlc3QuZ2V0Q2FsbGJhY2soKTsKICAg\nICAgICBPYmplY3QgY3R4ID0gcmVxdWVzdC5nZXRDdHgoKTsKICAgICAgICBC\neXRlU3RyaW5nIHRvcGljID0gcmVxdWVzdC5nZXRUb3BpYygpOwogICAgICAg\nIE1lc3NhZ2UgbWVzc2FnZSA9IHJlcXVlc3QuZ2V0TWVzc2FnZSgpOwoKICAg\nICAgICBpZiAoY29ubiA9PSBudWxsKSB7CiAgICAgICAgICAgIGNhbGxiYWNr\nLm9wZXJhdGlvbkZhaWxlZChjdHgsIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlv\nbigiTm90IGNvbm5lY3RlZCB0byBkZXJieSIpKTsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KCiAgICAgICAgbG9uZyBzZXFJZDsKCiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgc2VxSWQgPSBhZGp1c3RUb3BpY1NlcUlkRm9y\nUHVibGlzaCh0b3BpYywgbWVzc2FnZSk7CiAgICAgICAgfSBjYXRjaCAoVW5l\neHBlY3RlZENvbmRpdGlvbkV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGNh\nbGxiYWNrLm9wZXJhdGlvbkZhaWxlZChjdHgsIGUpOwogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0\nbXQ7CgogICAgICAgIGJvb2xlYW4gdHJpZWRDcmVhdGluZ1RhYmxlID0gZmFs\nc2U7CiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIG1lc3NhZ2UuZ2V0Qm9keSgpOwogICAgICAgICAg\nICAgICAgc3RtdCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudCgiSU5TRVJUIElO\nVE8gIiArIGdldFRhYmxlTmFtZUZvclRvcGljKHRvcGljKSArICIgVkFMVUVT\nKD8sPykiKTsKICAgICAgICAgICAgICAgIHN0bXQuc2V0TG9uZygxLCBzZXFJ\nZCk7CiAgICAgICAgICAgICAgICBzdG10LnNldEJsb2IoMiwgbmV3IFNlcmlh\nbEJsb2IobWVzc2FnZS50b0J5dGVBcnJheSgpKSk7CgogICAgICAgICAgICAg\nICAgaW50IHJvd0NvdW50ID0gc3RtdC5leGVjdXRlVXBkYXRlKCk7CiAgICAg\nICAgICAgICAgICBzdG10LmNsb3NlKCk7CiAgICAgICAgICAgICAgICBpZiAo\ncm93Q291bnQgIT0gMSkgewogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5l\ncnJvcigiVW5leHBlY3RlZCBudW1iZXIgb2YgYWZmZWN0ZWQgcm93cyBmcm9t\nIGRlcmJ5Iik7CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sub3BlcmF0\naW9uRmFpbGVkKGN0eCwgbmV3IFNlcnZpY2VEb3duRXhjZXB0aW9uKCJVbmV4\ncGVjdGVkIHJlc3BvbnNlIGZyb20gZGVyYnkiKSk7CiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\ncWxlKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgdGhlRXJyb3IgPSAoc3Fs\nZSkuZ2V0U1FMU3RhdGUoKTsKICAgICAgICAgICAgICAgIGlmICh0aGVFcnJv\nci5lcXVhbHMoIjQyWDA1IikgJiYgIXRyaWVkQ3JlYXRpbmdUYWJsZSkgewog\nICAgICAgICAgICAgICAgICAgIGNyZWF0ZVRhYmxlKGNvbm4sIHRvcGljKTsK\nICAgICAgICAgICAgICAgICAgICB0cmllZENyZWF0aW5nVGFibGUgPSB0cnVl\nOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3Igd2hp\nbGUgZXhlY3V0aW5nIGRlcmJ5IGluc2VydCIsIHNxbGUpOwogICAgICAgICAg\nICAgICAgY2FsbGJhY2sub3BlcmF0aW9uRmFpbGVkKGN0eCwgbmV3IFNlcnZp\nY2VEb3duRXhjZXB0aW9uKHNxbGUpKTsKICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYWxsYmFjay5v\ncGVyYXRpb25GaW5pc2hlZChjdHgsIHNlcUlkKTsKICAgIH0KCiAgICAvKgog\nICAgICogVGhpcyBtZXRob2QgZG9lcyBub3QgdGhyb3cgYW4gZXhjZXB0aW9u\nIGJlY2F1c2UgYW5vdGhlciB0aHJlYWQgbWlnaHQKICAgICAqIHNuZWFrIGlu\nIGFuZCBjcmVhdGUgdGhlIHRhYmxlIGJlZm9yZSB1cwogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgY3JlYXRlVGFibGUoQ29ubmVjdGlvbiBjb25uLCBCeXRl\nU3RyaW5nIHRvcGljKSB7CiAgICAgICAgU3RhdGVtZW50IHN0bXQgPSBudWxs\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0bXQgPSBjb25uLmNyZWF0\nZVN0YXRlbWVudCgpOwogICAgICAgICAgICBTdHJpbmcgdGFibGVOYW1lID0g\nZ2V0VGFibGVOYW1lRm9yVG9waWModG9waWMpOwogICAgICAgICAgICBzdG10\nLmV4ZWN1dGUoIkNSRUFURSBUQUJMRSAiICsgdGFibGVOYW1lICsgIiAoIiAr\nIElEX0ZJRUxEX05BTUUgKyAiIEJJR0lOVCBOT1QgTlVMTCBDT05TVFJBSU5U\nIElEX1BLXyIKICAgICAgICAgICAgICAgICAgICArIHRhYmxlTmFtZSArICIg\nUFJJTUFSWSBLRVksIiArIE1TR19GSUVMRF9OQU1FICsgIiBCTE9CKDJNKSBO\nT1QgTlVMTCkiKTsKICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkg\newogICAgICAgICAgICBsb2dnZXIuZGVidWcoIkNvdWxkIG5vdCBjcmVhdGUg\ndGFibGUiLCBlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgaWYgKHN0bXQgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgIHN0bXQuY2xvc2UoKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3IgY2xvc2luZyBzdGF0\nZW1lbnQiLCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgTWVzc2FnZVNlcUlkIGdldEN1cnJlbnRTZXFJZEZvclRvcGlj\nKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAgICAgICByZXR1cm4gZW5zdXJlU2Vx\nSWRFeGlzdHNGb3JUb3BpYyh0b3BpYyk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2NhblNpbmdsZU1lc3NhZ2UoU2NhblJlcXVlc3QgcmVxdWVzdCkgewog\nICAgICAgIHNjYW5NZXNzYWdlc0ludGVybmFsKHJlcXVlc3QuZ2V0VG9waWMo\nKSwgcmVxdWVzdC5nZXRTdGFydFNlcUlkKCksIDEsIExvbmcuTUFYX1ZBTFVF\nLCByZXF1ZXN0LmdldENhbGxiYWNrKCksCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgcmVxdWVzdC5nZXRDdHgoKSwgMSk7CiAgICAgICAgcmV0dXJu\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNjYW5NZXNzYWdlcyhSYW5nZVNj\nYW5SZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAgICBzY2FuTWVzc2FnZXNJbnRl\ncm5hbChyZXF1ZXN0LmdldFRvcGljKCksIHJlcXVlc3QuZ2V0U3RhcnRTZXFJ\nZCgpLCByZXF1ZXN0LmdldE1lc3NhZ2VMaW1pdCgpLCByZXF1ZXN0CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLmdldFNpemVMaW1pdCgpLCByZXF1\nZXN0LmdldENhbGxiYWNrKCksIHJlcXVlc3QuZ2V0Q3R4KCksIFNDQU5fQ0hV\nTkspOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBwcml2YXRlIFN0cmlu\nZyBnZXRUYWJsZU5hbWVGb3JUb3BpYyhCeXRlU3RyaW5nIHRvcGljKSB7CiAg\nICAgICAgU3RyaW5nIHNyYyA9ICh0b3BpYy50b1N0cmluZ1V0ZjgoKSArICJf\nIiArIHZlcnNpb24pOwogICAgICAgIHRocmVhZExvY2FsRGlnZXN0LmdldCgp\nLnJlc2V0KCk7CiAgICAgICAgYnl0ZVtdIGRpZ2VzdCA9IHRocmVhZExvY2Fs\nRGlnZXN0LmdldCgpLmRpZ2VzdChzcmMuZ2V0Qnl0ZXMoKSk7CiAgICAgICAg\nQmlnSW50ZWdlciBiaWdJbnQgPSBuZXcgQmlnSW50ZWdlcigxLGRpZ2VzdCk7\nCiAgICAgICAgcmV0dXJuIFN0cmluZy5mb3JtYXQoIlRBQkxFXyUwMzJYIiwg\nYmlnSW50KTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgc2Nhbk1lc3NhZ2Vz\nSW50ZXJuYWwoQnl0ZVN0cmluZyB0b3BpYywgbG9uZyBzdGFydFNlcUlkLCBp\nbnQgbWVzc2FnZUxpbWl0LCBsb25nIHNpemVMaW1pdCwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBTY2FuQ2FsbGJhY2sgY2FsbGJh\nY2ssIE9iamVjdCBjdHgsIGludCBzY2FuQ2h1bmspIHsKCiAgICAgICAgQ29u\nbmVjdGlvbiBjb25uID0gdGhyZWFkTG9jYWxDb25uZWN0aW9uLmdldCgpOwoK\nICAgICAgICBpZiAoY29ubiA9PSBudWxsKSB7CiAgICAgICAgICAgIGNhbGxi\nYWNrLnNjYW5GYWlsZWQoY3R4LCBuZXcgU2VydmljZURvd25FeGNlcHRpb24o\nIk5vdCBjb25uZWN0ZWQgdG8gZGVyYnkiKSk7CiAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICB9CgogICAgICAgIGxvbmcgY3VycmVudFNlcUlkOwogICAg\nICAgIGN1cnJlbnRTZXFJZCA9IHN0YXJ0U2VxSWQ7CgogICAgICAgIFByZXBh\ncmVkU3RhdGVtZW50IHN0bXQgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdG10ID0gY29ubi5wcmVw\nYXJlU3RhdGVtZW50KCJTRUxFQ1QgKiBGUk9NICIgKyBnZXRUYWJsZU5hbWVG\nb3JUb3BpYyh0b3BpYykgKyAiIFdIRVJFICIgKyBJRF9GSUVMRF9OQU1FCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nIiA+PSA/ICBBTkQgIiArIElEX0ZJRUxEX05BTUUgKyAiIDw9ID8iKTsKCiAg\nICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAg\nICAgICAgICAgICBTdHJpbmcgdGhlRXJyb3IgPSAoc3FsZSkuZ2V0U1FMU3Rh\ndGUoKTsKICAgICAgICAgICAgICAgIGlmICh0aGVFcnJvci5lcXVhbHMoIjQy\nWDA1IikpIHsKICAgICAgICAgICAgICAgICAgICAvLyBObyB0YWJsZSwgc2Nh\nbiBpcyBvdmVyCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suc2NhbkZp\nbmlzaGVkKGN0eCwgUmVhc29uRm9yRmluaXNoLk5PX01PUkVfTUVTU0FHRVMp\nOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgc3FsZTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaW50\nIG51bU1lc3NhZ2VzID0gMDsKICAgICAgICAgICAgbG9uZyB0b3RhbFNpemUg\nPSAwOwoKICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKCiAgICAgICAgICAg\nICAgICBzdG10LnNldExvbmcoMSwgY3VycmVudFNlcUlkKTsKICAgICAgICAg\nICAgICAgIHN0bXQuc2V0TG9uZygyLCBjdXJyZW50U2VxSWQgKyBzY2FuQ2h1\nbmspOwoKICAgICAgICAgICAgICAgIGlmICghc3RtdC5leGVjdXRlKCkpIHsK\nICAgICAgICAgICAgICAgICAgICBTdHJpbmcgZXJyb3JNc2cgPSAiU2VsZWN0\nIHF1ZXJ5IGRpZCBub3QgcmV0dXJuIGEgcmVzdWx0IHNldCI7CiAgICAgICAg\nICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yTXNnKTsKICAgICAgICAg\nICAgICAgICAgICBzdG10LmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAg\nY2FsbGJhY2suc2NhbkZhaWxlZChjdHgsIG5ldyBTZXJ2aWNlRG93bkV4Y2Vw\ndGlvbihlcnJvck1zZykpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBSZXN1bHRTZXQg\ncmVzdWx0U2V0ID0gc3RtdC5nZXRSZXN1bHRTZXQoKTsKCiAgICAgICAgICAg\nICAgICBpZiAoIXJlc3VsdFNldC5uZXh0KCkpIHsKICAgICAgICAgICAgICAg\nICAgICBzdG10LmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgY2FsbGJh\nY2suc2NhbkZpbmlzaGVkKGN0eCwgUmVhc29uRm9yRmluaXNoLk5PX01PUkVf\nTUVTU0FHRVMpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBkbyB7CgogICAgICAgICAg\nICAgICAgICAgIGxvbmcgbG9jYWxTZXFJZCA9IHJlc3VsdFNldC5nZXRMb25n\nKDEpOwoKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlLkJ1aWxkZXIgbWVz\nc2FnZUJ1aWxkZXIgPSBNZXNzYWdlLm5ld0J1aWxkZXIoKS5tZXJnZUZyb20o\ncmVzdWx0U2V0LmdldEJpbmFyeVN0cmVhbSgyKSk7CgogICAgICAgICAgICAg\nICAgICAgIC8vIE1lcmdlIGluIHRoZSBsb2NhbCBzZXEtaWQgc2luY2UgdGhh\ndCBpcyBub3Qgc3RvcmVkIHdpdGgKICAgICAgICAgICAgICAgICAgICAvLyB0\naGUgbWVzc2FnZQogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgbWVzc2Fn\nZSA9IE1lc3NhZ2VJZFV0aWxzLm1lcmdlTG9jYWxTZXFJZChtZXNzYWdlQnVp\nbGRlciwgbG9jYWxTZXFJZCk7CgogICAgICAgICAgICAgICAgICAgIGNhbGxi\nYWNrLm1lc3NhZ2VTY2FubmVkKGN0eCwgbWVzc2FnZSk7CiAgICAgICAgICAg\nICAgICAgICAgbnVtTWVzc2FnZXMrKzsKICAgICAgICAgICAgICAgICAgICB0\nb3RhbFNpemUgKz0gbWVzc2FnZS5nZXRCb2R5KCkuc2l6ZSgpOwoKICAgICAg\nICAgICAgICAgICAgICBpZiAobnVtTWVzc2FnZXMgPiBtZXNzYWdlTGltaXQp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RtdC5jbG9zZSgpOwogICAg\nICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5zY2FuRmluaXNoZWQoY3R4\nLCBSZWFzb25Gb3JGaW5pc2guTlVNX01FU1NBR0VTX0xJTUlUX0VYQ0VFREVE\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAg\nICAgICAgICAgIH0gZWxzZSBpZiAodG90YWxTaXplID4gc2l6ZUxpbWl0KSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHN0bXQuY2xvc2UoKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgY2FsbGJhY2suc2NhbkZpbmlzaGVkKGN0eCwg\nUmVhc29uRm9yRmluaXNoLlNJWkVfTElNSVRfRVhDRUVERUQpOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIH0gd2hpbGUgKHJlc3VsdFNldC5uZXh0KCkp\nOwoKICAgICAgICAgICAgICAgIGN1cnJlbnRTZXFJZCArPSBTQ0FOX0NIVU5L\nOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJTUUwgRXhjZXB0aW9u\nIiwgZSk7CiAgICAgICAgICAgIGNhbGxiYWNrLnNjYW5GYWlsZWQoY3R4LCBu\nZXcgU2VydmljZURvd25FeGNlcHRpb24oZSkpOwogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAg\nICAgICBsb2dnZXIuZXJyb3IoIk1lc3NhZ2Ugc3RvcmVkIGluIGRlcmJ5IGlz\nIG5vdCBwYXJzZWFibGUiLCBlKTsKICAgICAgICAgICAgY2FsbGJhY2suc2Nh\nbkZhaWxlZChjdHgsIG5ldyBTZXJ2aWNlRG93bkV4Y2VwdGlvbihlKSk7CiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKHN0bXQgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgICAgIHN0bXQuY2xvc2UoKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3IgY2xvc2lu\nZyBzdGF0ZW1lbnQiLCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBkZWxpdmVyZWRVbnRpbChCeXRlU3RyaW5n\nIHRvcGljLCBMb25nIHNlcUlkKSB7CiAgICAgICAgLy8gbm9vcAogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNvbnN1bWVkVW50aWwoQnl0ZVN0cmluZyB0b3Bp\nYywgTG9uZyBzZXFJZCkgewogICAgICAgIENvbm5lY3Rpb24gY29ubiA9IHRo\ncmVhZExvY2FsQ29ubmVjdGlvbi5nZXQoKTsKICAgICAgICBpZiAoY29ubiA9\nPSBudWxsKSB7CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiTm90IGNvbm5l\nY3RlZCB0byBkZXJieSIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nfQogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bXQgPSBudWxsOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHN0bXQgPSBjb25uLnByZXBhcmVTdGF0\nZW1lbnQoIkRFTEVURSBGUk9NICIgKyBnZXRUYWJsZU5hbWVGb3JUb3BpYyh0\nb3BpYykgKyAiIFdIRVJFICIgKyBJRF9GSUVMRF9OQU1FCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIDw9ID8iKTsKICAg\nICAgICAgICAgc3RtdC5zZXRMb25nKDEsIHNlcUlkKTsKICAgICAgICAgICAg\naW50IHJvd0NvdW50ID0gc3RtdC5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAg\nICAgIGxvZ2dlci5kZWJ1ZygiRGVsZXRlZCAiICsgcm93Q291bnQgKyAiIHJl\nY29yZHMgZm9yIHRvcGljOiAiICsgdG9waWMudG9TdHJpbmdVdGY4KCkgKyAi\nLCBzZXFJZDogIiArIHNlcUlkKTsKICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc3FsZSkgewogICAgICAgICAgICBTdHJpbmcgdGhlRXJyb3IgPSAo\nc3FsZSkuZ2V0U1FMU3RhdGUoKTsKICAgICAgICAgICAgaWYgKHRoZUVycm9y\nLmVxdWFscygiNDJYMDUiKSkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndh\ncm4oIlRhYmxlIGZvciB0b3BpYyAoIiArIHRvcGljICsgIikgZG9lcyBub3Qg\nZXhpc3Qgc28gbm8gY29uc3VtZWQgbWVzc2FnZXMgdG8gZGVsZXRlISIpOwog\nICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJv\ncigiRXJyb3Igd2hpbGUgZXhlY3V0aW5nIGRlcmJ5IGRlbGV0ZSBmb3IgY29u\nc3VtZWQgbWVzc2FnZXMiLCBzcWxlKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKHN0bXQgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHN0bXQuY2xvc2UoKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3Ig\nY2xvc2luZyBzdGF0ZW1lbnQiLCBlKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRNZXNzYWdlQm91bmQoQnl0\nZVN0cmluZyB0b3BpYywgSW50ZWdlciBib3VuZCkgewogICAgICAgIC8vIG5v\nb3A7IE1heWJlIGltcGxlbWVudCBsYXRlcgogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGNsZWFyTWVzc2FnZUJvdW5kKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAg\nICAgICAvLyBub29wOyBNYXliZSBpbXBsZW1lbnQgbGF0ZXIKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBjb25zdW1lVG9Cb3VuZChCeXRlU3RyaW5nIHRvcGlj\nKSB7CiAgICAgICAgLy8gbm9vcDsgTWF5YmUgaW1wbGVtZW50IGxhdGVyCiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBmaW5hbGl6\nZSgpIHRocm93cyBUaHJvd2FibGUgewogICAgICAgIGlmIChkcml2ZXIuZXF1\nYWxzKCJvcmcuYXBhY2hlLmRlcmJ5LmpkYmMuRW1iZWRkZWREcml2ZXIiKSkg\newogICAgICAgICAgICBib29sZWFuIGdvdFNRTEV4YyA9IGZhbHNlOwogICAg\nICAgICAgICAvLyBUaGlzIGlzIHdlaXJkOiBvbiBub3JtYWwgc2h1dGRvd24s\nIGl0IHRocm93cyBhbiBleGNlcHRpb24KICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIERyaXZlck1hbmFnZXIuZ2V0Q29ubmVjdGlvbigiamRi\nYzpkZXJieTo7c2h1dGRvd249dHJ1ZSIpLmNsb3NlKCk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAg\naWYgKHNlLmdldFNRTFN0YXRlKCkuZXF1YWxzKCJYSjAxNSIpKSB7CiAgICAg\nICAgICAgICAgICAgICAgZ290U1FMRXhjID0gdHJ1ZTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWdvdFNRTEV4\nYykgewogICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJEYXRhYmFzZSBk\naWQgbm90IHNodXQgZG93biBub3JtYWxseSIpOwogICAgICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIkRhdGFiYXNlIHNo\ndXQgZG93biBub3JtYWxseSIpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHN1cGVyLmZpbmFsaXplKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmVzZXQoKSB7CiAgICAgICAgLy8ganVzdCBtb3ZlIHRoZSBuYW1lc3Bh\nY2Ugb3ZlciB0byB0aGUgbmV4dCBvbmUKICAgICAgICB2ZXJzaW9uKys7CiAg\nICAgICAgY3VyclRvcGljU2VxSWRzLmNsZWFyKCk7CiAgICB9Cn0K\n","encoding":"base64"}

