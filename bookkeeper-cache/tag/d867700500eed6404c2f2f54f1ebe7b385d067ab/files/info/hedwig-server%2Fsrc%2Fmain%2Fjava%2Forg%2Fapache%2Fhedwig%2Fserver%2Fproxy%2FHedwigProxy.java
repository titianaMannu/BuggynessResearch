{"sha":"5c200c13ecf0a3241aa2f2770a88968e82a4999d","node_id":"MDQ6QmxvYjE1NzU5NTY6NWMyMDBjMTNlY2YwYTMyNDFhYTJmMjc3MGE4ODk2OGU4MmE0OTk5ZA==","size":6939,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5c200c13ecf0a3241aa2f2770a88968e82a4999d","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucHJveHk7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5sYW5nLlRocmVhZC5VbmNhdWdo\ndEV4Y2VwdGlvbkhhbmRsZXI7CmltcG9ydCBqYXZhLm5ldC5JbmV0U29ja2V0\nQWRkcmVzczsKaW1wb3J0IGphdmEubmV0Lk1hbGZvcm1lZFVSTEV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkV4ZWN1dG9yczsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkxpbmtlZEJsb2NraW5nUXVl\ndWU7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29uZmlndXJhdGlvbi5D\nb25maWd1cmF0aW9uRXhjZXB0aW9uOwppbXBvcnQgb3JnLnNsZjRqLkxvZ2dl\ncjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwppbXBvcnQgb3Jn\nLmpib3NzLm5ldHR5LmJvb3RzdHJhcC5TZXJ2ZXJCb290c3RyYXA7CmltcG9y\ndCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5ncm91cC5DaGFubmVsR3JvdXA7\nCmltcG9ydCBvcmcuamJvc3MubmV0dHkuY2hhbm5lbC5ncm91cC5EZWZhdWx0\nQ2hhbm5lbEdyb3VwOwppbXBvcnQgb3JnLmpib3NzLm5ldHR5LmNoYW5uZWwu\nc29ja2V0LlNlcnZlclNvY2tldENoYW5uZWxGYWN0b3J5OwppbXBvcnQgb3Jn\nLmpib3NzLm5ldHR5LmNoYW5uZWwuc29ja2V0Lm5pby5OaW9TZXJ2ZXJTb2Nr\nZXRDaGFubmVsRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5uZXR0eS5sb2dn\naW5nLkludGVybmFsTG9nZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5qYm9zcy5u\nZXR0eS5sb2dnaW5nLkxvZzRKTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBvcmcu\nYXBhY2hlLmhlZHdpZy5jbGllbnQuSGVkd2lnQ2xpZW50OwppbXBvcnQgb3Jn\nLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuT3BlcmF0\naW9uVHlwZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5jb21t\nb24uVGVybWluYXRlSlZNRXhjZXB0aW9uSGFuZGxlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5oYW5kbGVycy5IYW5kbGVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLm5ldHR5LlB1YlN1YlNlcnZlcjsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5uZXR0eS5QdWJTdWJT\nZXJ2ZXJQaXBlbGluZUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdp\nZy5zZXJ2ZXIubmV0dHkuVW1icmVsbGFIYW5kbGVyOwoKcHVibGljIGNsYXNz\nIEhlZHdpZ1Byb3h5IHsKICAgIHN0YXRpYyBmaW5hbCBMb2dnZXIgbG9nZ2Vy\nID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoSGVkd2lnUHJveHkuY2xhc3Mp\nOwoKICAgIEhlZHdpZ0NsaWVudCBjbGllbnQ7CiAgICBTZXJ2ZXJTb2NrZXRD\naGFubmVsRmFjdG9yeSBzZXJ2ZXJTb2NrZXRDaGFubmVsRmFjdG9yeTsKICAg\nIENoYW5uZWxHcm91cCBhbGxDaGFubmVsczsKICAgIE1hcDxPcGVyYXRpb25U\neXBlLCBIYW5kbGVyPiBoYW5kbGVyczsKICAgIFByb3h5Q29uZmlndXJhdGlv\nbiBjZmc7CiAgICBDaGFubmVsVHJhY2tlciB0cmFja2VyOwogICAgVGhyZWFk\nR3JvdXAgdGc7CgogICAgcHVibGljIEhlZHdpZ1Byb3h5KGZpbmFsIFByb3h5\nQ29uZmlndXJhdGlvbiBjZmcsIGZpbmFsIFVuY2F1Z2h0RXhjZXB0aW9uSGFu\nZGxlciBleGNlcHRpb25IYW5kbGVyKSB7CiAgICAgICAgdGhpcy5jZmcgPSBj\nZmc7CgogICAgICAgIHRnID0gbmV3IFRocmVhZEdyb3VwKCJoZWR3aWdwcm94\neSIpIHsKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIHVuY2F1Z2h0RXhjZXB0aW9uKFRocmVhZCB0LCBUaHJvd2FibGUg\nZSkgewogICAgICAgICAgICAgICAgZXhjZXB0aW9uSGFuZGxlci51bmNhdWdo\ndEV4Y2VwdGlvbih0LCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAg\nICB9CgogICAgcHVibGljIEhlZHdpZ1Byb3h5KFByb3h5Q29uZmlndXJhdGlv\nbiBjb25mKSB0aHJvd3MgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAg\nIHRoaXMoY29uZiwgbmV3IFRlcm1pbmF0ZUpWTUV4Y2VwdGlvbkhhbmRsZXIo\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc3RhcnQoKSB0aHJvd3MgSW50\nZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIGZpbmFsIExpbmtlZEJsb2Nr\naW5nUXVldWU8Qm9vbGVhbj4gcXVldWUgPSBuZXcgTGlua2VkQmxvY2tpbmdR\ndWV1ZTxCb29sZWFuPigpOwoKICAgICAgICBuZXcgVGhyZWFkKHRnLCBuZXcg\nUnVubmFibGUoKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICBjbGllbnQg\nPSBuZXcgSGVkd2lnQ2xpZW50KGNmZyk7CgogICAgICAgICAgICAgICAgc2Vy\ndmVyU29ja2V0Q2hhbm5lbEZhY3RvcnkgPSBuZXcgTmlvU2VydmVyU29ja2V0\nQ2hhbm5lbEZhY3RvcnkoRXhlY3V0b3JzLm5ld0NhY2hlZFRocmVhZFBvb2wo\nKSwKICAgICAgICAgICAgICAgICAgICAgICAgRXhlY3V0b3JzLm5ld0NhY2hl\nZFRocmVhZFBvb2woKSk7CiAgICAgICAgICAgICAgICBpbml0aWFsaXplSGFu\nZGxlcnMoKTsKICAgICAgICAgICAgICAgIGluaXRpYWxpemVOZXR0eSgpOwoK\nICAgICAgICAgICAgICAgIHF1ZXVlLm9mZmVyKHRydWUpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSkuc3RhcnQoKTsKCiAgICAgICAgcXVldWUudGFrZSgp\nOwogICAgfQoKICAgIC8vIHVzZWQgZm9yIHRlc3RpbmcKICAgIHB1YmxpYyBD\naGFubmVsVHJhY2tlciBnZXRDaGFubmVsVHJhY2tlcigpIHsKICAgICAgICBy\nZXR1cm4gdHJhY2tlcjsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBpbml0\naWFsaXplSGFuZGxlcnMoKSB7CiAgICAgICAgaGFuZGxlcnMgPSBuZXcgSGFz\naE1hcDxPcGVyYXRpb25UeXBlLCBIYW5kbGVyPigpOwogICAgICAgIHRyYWNr\nZXIgPSBuZXcgQ2hhbm5lbFRyYWNrZXIoY2xpZW50LmdldFN1YnNjcmliZXIo\nKSk7CgogICAgICAgIGhhbmRsZXJzLnB1dChPcGVyYXRpb25UeXBlLlBVQkxJ\nU0gsIG5ldyBQcm94eVB1Ymxpc2hIYW5kZXIoY2xpZW50LmdldFB1Ymxpc2hl\ncigpKSk7CiAgICAgICAgaGFuZGxlcnMucHV0KE9wZXJhdGlvblR5cGUuU1VC\nU0NSSUJFLCBuZXcgUHJveHlTdWJzY3JpYmVIYW5kbGVyKGNsaWVudC5nZXRT\ndWJzY3JpYmVyKCksIHRyYWNrZXIpKTsKICAgICAgICBoYW5kbGVycy5wdXQo\nT3BlcmF0aW9uVHlwZS5VTlNVQlNDUklCRSwgbmV3IFByb3h5VW5zdWJzY3Jp\nYmVIYW5kbGVyKGNsaWVudC5nZXRTdWJzY3JpYmVyKCksIHRyYWNrZXIpKTsK\nICAgICAgICBoYW5kbGVycy5wdXQoT3BlcmF0aW9uVHlwZS5DT05TVU1FLCBu\nZXcgUHJveHlDb25zdW1lSGFuZGxlcihjbGllbnQuZ2V0U3Vic2NyaWJlcigp\nKSk7CiAgICAgICAgaGFuZGxlcnMucHV0KE9wZXJhdGlvblR5cGUuU1RPUF9E\nRUxJVkVSWSwgbmV3IFByb3h5U3RvcERlbGl2ZXJ5SGFuZGxlcihjbGllbnQu\nZ2V0U3Vic2NyaWJlcigpLCB0cmFja2VyKSk7CiAgICAgICAgaGFuZGxlcnMu\ncHV0KE9wZXJhdGlvblR5cGUuU1RBUlRfREVMSVZFUlksIG5ldyBQcm94eVN0\nYXJ0RGVsaXZlcnlIYW5kbGVyKGNsaWVudC5nZXRTdWJzY3JpYmVyKCksIHRy\nYWNrZXIpKTsKCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgaW5pdGlhbGl6\nZU5ldHR5KCkgewogICAgICAgIEludGVybmFsTG9nZ2VyRmFjdG9yeS5zZXRE\nZWZhdWx0RmFjdG9yeShuZXcgTG9nNEpMb2dnZXJGYWN0b3J5KCkpOwogICAg\nICAgIGFsbENoYW5uZWxzID0gbmV3IERlZmF1bHRDaGFubmVsR3JvdXAoImhl\nZHdpZ3Byb3h5Iik7CiAgICAgICAgU2VydmVyQm9vdHN0cmFwIGJvb3RzdHJh\ncCA9IG5ldyBTZXJ2ZXJCb290c3RyYXAoc2VydmVyU29ja2V0Q2hhbm5lbEZh\nY3RvcnkpOwogICAgICAgIFVtYnJlbGxhSGFuZGxlciB1bWJyZWxsYUhhbmRs\nZXIgPSBuZXcgVW1icmVsbGFIYW5kbGVyKGFsbENoYW5uZWxzLCBoYW5kbGVy\ncywgZmFsc2UpOwogICAgICAgIFB1YlN1YlNlcnZlclBpcGVsaW5lRmFjdG9y\neSBwaXBlbGluZSA9IG5ldyBQdWJTdWJTZXJ2ZXJQaXBlbGluZUZhY3Rvcnko\ndW1icmVsbGFIYW5kbGVyLCBudWxsLCBjZmcKICAgICAgICAgICAgICAgIC5n\nZXRNYXhpbXVtTWVzc2FnZVNpemUoKSk7CgogICAgICAgIGJvb3RzdHJhcC5z\nZXRQaXBlbGluZUZhY3RvcnkocGlwZWxpbmUpOwogICAgICAgIGJvb3RzdHJh\ncC5zZXRPcHRpb24oImNoaWxkLnRjcE5vRGVsYXkiLCB0cnVlKTsKICAgICAg\nICBib290c3RyYXAuc2V0T3B0aW9uKCJjaGlsZC5rZWVwQWxpdmUiLCB0cnVl\nKTsKICAgICAgICBib290c3RyYXAuc2V0T3B0aW9uKCJyZXVzZUFkZHJlc3Mi\nLCB0cnVlKTsKCiAgICAgICAgLy8gQmluZCBhbmQgc3RhcnQgdG8gYWNjZXB0\nIGluY29taW5nIGNvbm5lY3Rpb25zLgogICAgICAgIGFsbENoYW5uZWxzLmFk\nZChib290c3RyYXAuYmluZChuZXcgSW5ldFNvY2tldEFkZHJlc3MoY2ZnLmdl\ndFByb3h5UG9ydCgpKSkpOwogICAgICAgIGxvZ2dlci5pbmZvKCJHb2luZyBp\nbnRvIHJlY2VpdmUgbG9vcCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNo\ndXRkb3duKCkgewogICAgICAgIGFsbENoYW5uZWxzLmNsb3NlKCkuYXdhaXRV\nbmludGVycnVwdGlibHkoKTsKICAgICAgICBjbGllbnQuY2xvc2UoKTsKICAg\nICAgICBzZXJ2ZXJTb2NrZXRDaGFubmVsRmFjdG9yeS5yZWxlYXNlRXh0ZXJu\nYWxSZXNvdXJjZXMoKTsKICAgIH0KCiAgICAvLyB0aGUgZm9sbG93aW5nIG1l\ndGhvZCBvbmx5IGV4aXN0cyBmb3IgdW5pdC10ZXN0aW5nIHB1cnBvc2VzLCBz\naG91bGQgZ28KICAgIC8vIGF3YXkgb25jZSB3ZSBtYWtlIHN0YXJ0IGRlbGl2\nZXJ5IHRvdGFsbHkgc2VydmVyLXNpZGUKICAgIHB1YmxpYyBIYW5kbGVyIGdl\ndFN0YXJ0RGVsaXZlcnlIYW5kbGVyKCkgewogICAgICAgIHJldHVybiBoYW5k\nbGVycy5nZXQoT3BlcmF0aW9uVHlwZS5TVEFSVF9ERUxJVkVSWSk7CiAgICB9\nCgogICAgcHVibGljIEhhbmRsZXIgZ2V0U3RvcERlbGl2ZXJ5SGFuZGxlcigp\nIHsKICAgICAgICByZXR1cm4gaGFuZGxlcnMuZ2V0KE9wZXJhdGlvblR5cGUu\nU1RPUF9ERUxJVkVSWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcGFyYW0g\nYXJncwogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJp\nbmdbXSBhcmdzKSB7CgogICAgICAgIGxvZ2dlci5pbmZvKCJBdHRlbXB0aW5n\nIHRvIHN0YXJ0IEhlZHdpZyBQcm94eSIpOwogICAgICAgIFByb3h5Q29uZmln\ndXJhdGlvbiBjb25mID0gbmV3IFByb3h5Q29uZmlndXJhdGlvbigpOwogICAg\nICAgIGlmIChhcmdzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgU3RyaW5n\nIGNvbmZGaWxlID0gYXJnc1swXTsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIGNvbmYubG9hZENvbmYobmV3IEZpbGUoY29uZkZpbGUpLnRv\nVVJJKCkudG9VUkwoKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE1hbGZvcm1l\nZFVSTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgbXNn\nID0gIkNvdWxkIG5vdCBvcGVuIGNvbmZpZ3VyYXRpb24gZmlsZTogIiArIGNv\nbmZGaWxlOwogICAgICAgICAgICAgICAgUHViU3ViU2VydmVyLmVycm9yTXNn\nQW5kRXhpdChtc2csIGUsIFB1YlN1YlNlcnZlci5SQ19JTlZBTElEX0NPTkZf\nRklMRSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKENvbmZpZ3VyYXRpb25FeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgU3RyaW5nIG1zZyA9ICJNYWxm\nb3JtZWQgY29uZmlndXJhdGlvbiBmaWxlOiAiICsgY29uZkZpbGU7CiAgICAg\nICAgICAgICAgICBQdWJTdWJTZXJ2ZXIuZXJyb3JNc2dBbmRFeGl0KG1zZywg\nZSwgUHViU3ViU2VydmVyLlJDX01JU0NPTkZJR1VSRUQpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJVc2luZyBjb25maWd1cmF0\naW9uIGZpbGUgIiArIGNvbmZGaWxlKTsKICAgICAgICB9CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgbmV3IEhlZHdpZ1Byb3h5KGNvbmYpLnN0YXJ0KCk7\nCiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAg\nUHViU3ViU2VydmVyLmVycm9yTXNnQW5kRXhpdCgiRXJyb3IgZHVyaW5nIHN0\nYXJ0dXAiLCB0LCBQdWJTdWJTZXJ2ZXIuUkNfT1RIRVIpOwogICAgICAgIH0K\nICAgIH0KCn0K\n","encoding":"base64"}

