{"sha":"5c44a855dc69d87037341479febc04e16f50c8d9","node_id":"MDQ6QmxvYjE1NzU5NTY6NWM0NGE4NTVkYzY5ZDg3MDM3MzQxNDc5ZmViYzA0ZTE2ZjUwYzhkOQ==","size":10033,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/5c44a855dc69d87037341479febc04e16f50c8d9","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXI7CgppbXBvcnQgamF2YS51\ndGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmlt\ncG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLnNs\nZjRqLkxvZ2dlcjsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXJGYWN0b3J5Owpp\nbXBvcnQgb3JnLmp1bml0LkFmdGVyOwppbXBvcnQgb3JnLmp1bml0LkJlZm9y\nZTsKCmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5jbGllbnQuY29uZi5DbGll\nbnRDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuY2xp\nZW50LkhlZHdpZ0NsaWVudDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnNlcnZlci5uZXR0eS5QdWJTdWJTZXJ2ZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2UuQm9va0tl\nZXBlclRlc3RCYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5I\nZWR3aWdTb2NrZXRBZGRyZXNzOwoKLyoqCiAqIFRoaXMgaXMgYSBiYXNlIGNs\nYXNzIGZvciBhbnkgdGVzdHMgdGhhdCBuZWVkIGEgSGVkd2lnIFJlZ2lvbihz\nKSBzZXR1cCB3aXRoIGEKICogbnVtYmVyIG9mIEhlZHdpZyBodWJzIHBlciBy\nZWdpb24sIGFuIGFzc29jaWF0ZWQgSGVkd2lnQ2xpZW50IHBlciByZWdpb24g\nYW5kCiAqIHRoZSByZXF1aXJlZCBCb29rS2VlcGVyIGFuZCBab29LZWVwZXIg\naW5zdGFuY2VzLgogKgogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEhlZHdp\nZ1JlZ2lvblRlc3RCYXNlIGV4dGVuZHMgVGVzdENhc2UgewoKICAgIHByb3Rl\nY3RlZCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3RvcnkuZ2V0\nTG9nZ2VyKEhlZHdpZ1JlZ2lvblRlc3RCYXNlLmNsYXNzKTsKCiAgICAvLyBC\nb29rS2VlcGVyIHZhcmlhYmxlcwogICAgLy8gRGVmYXVsdCBudW1iZXIgb2Yg\nYm9va2llIHNlcnZlcnMgdG8gc2V0dXAuIEV4dGVuZGluZyBjbGFzc2VzCiAg\nICAvLyBjYW4gb3ZlcnJpZGUgdGhpcy4gV2Ugc2hvdWxkIGJlIGFibGUgdG8g\ncmV1c2UgdGhlIHNhbWUgQm9va0tlZXBlcgogICAgLy8gZW5zZW1ibGUgYW1v\nbmcgYWxsIG9mIHRoZSByZWdpb25zLCBhdCBsZWFzdCBmb3IgdW5pdCB0ZXN0\naW5nIHB1cnBvc2VzLgogICAgcHJvdGVjdGVkIGludCBudW1Cb29raWVzID0g\nMzsKICAgIHByb3RlY3RlZCBCb29rS2VlcGVyVGVzdEJhc2UgYmt0YjsKCiAg\nICAvLyBIZWR3aWcgUmVnaW9uIHZhcmlhYmxlcwogICAgLy8gRGVmYXVsdCBu\ndW1iZXIgb2YgSGVkd2lnIFJlZ2lvbnMgdG8gc2V0dXAuIEV4dGVuZGluZyBj\nbGFzc2VzIGNhbgogICAgLy8gb3ZlcnJpZGUgdGhpcy4KICAgIHByb3RlY3Rl\nZCBpbnQgbnVtUmVnaW9ucyA9IDI7CiAgICBwcm90ZWN0ZWQgaW50IG51bVNl\ncnZlcnNQZXJSZWdpb24gPSAxOwogICAgcHJvdGVjdGVkIGludCBpbml0aWFs\nU2VydmVyUG9ydCA9IDQwODA7CiAgICBwcm90ZWN0ZWQgaW50IGluaXRpYWxT\nU0xTZXJ2ZXJQb3J0ID0gOTg3NjsKICAgIC8vIE1hcCB3aXRoIGtleXMgYmVp\nbmcgUmVnaW9uIG5hbWVzIGFuZCB2YWx1ZXMgYmVpbmcgdGhlIGxpc3Qgb2Yg\nSGVkd2lnCiAgICAvLyBIdWJzIChQdWJTdWJTZXJ2ZXJzKSBmb3IgdGhhdCBw\nYXJ0aWN1bGFyIHJlZ2lvbi4KICAgIHByb3RlY3RlZCBNYXA8U3RyaW5nLCBM\naXN0PFB1YlN1YlNlcnZlcj4+IHJlZ2lvblNlcnZlcnNNYXA7CiAgICAvLyBN\nYXAgd2l0aCBrZXlzIGJlaW5nIFJlZ2lvbiBuYW1lcyBhbmQgdmFsdWVzIGJl\naW5nIHRoZSBIZWR3aWcgQ2xpZW50CiAgICAvLyBpbnN0YW5jZS4KICAgIHBy\nb3RlY3RlZCBNYXA8U3RyaW5nLCBIZWR3aWdDbGllbnQ+IHJlZ2lvbkNsaWVu\ndHNNYXA7CgogICAgLy8gU3RyaW5nIGNvbnN0YW50IHVzZWQgYXMgdGhlIHBy\nZWZpeCBmb3IgdGhlIHJlZ2lvbiBuYW1lcy4KICAgIHByb3RlY3RlZCBzdGF0\naWMgZmluYWwgU3RyaW5nIFJFR0lPTl9QUkVGSVggPSAicmVnaW9uIjsKCiAg\nICAvLyBEZWZhdWx0IGNoaWxkIGNsYXNzIG9mIHRoZSBTZXJ2ZXJDb25maWd1\ncmF0aW9uIHRvIGJlIHVzZWQgaGVyZS4KICAgIC8vIEV4dGVuZGluZyBjbGFz\nc2VzIGNhbiBkZWZpbmUgdGhlaXIgb3duIChwb3NzaWJseSBleHRlbmRpbmcg\nZnJvbSB0aGlzKSBhbmQKICAgIC8vIG92ZXJyaWRlIHRoZSBnZXRTZXJ2ZXJD\nb25maWd1cmF0aW9uIG1ldGhvZCBiZWxvdyB0byByZXR1cm4gdGhlaXIgb3du\nCiAgICAvLyBjb25maWd1cmF0aW9uLgogICAgcHJvdGVjdGVkIGNsYXNzIFJl\nZ2lvblNlcnZlckNvbmZpZ3VyYXRpb24gZXh0ZW5kcyBTZXJ2ZXJDb25maWd1\ncmF0aW9uIHsKICAgICAgICBwcml2YXRlIGZpbmFsIGludCBzZXJ2ZXJQb3J0\nLCBzc2xTZXJ2ZXJQb3J0OwogICAgICAgIHByaXZhdGUgZmluYWwgU3RyaW5n\nIHJlZ2lvbk5hbWU7CgogICAgICAgIHB1YmxpYyBSZWdpb25TZXJ2ZXJDb25m\naWd1cmF0aW9uKGludCBzZXJ2ZXJQb3J0LCBpbnQgc3NsU2VydmVyUG9ydCwg\nU3RyaW5nIHJlZ2lvbk5hbWUpIHsKICAgICAgICAgICAgdGhpcy5zZXJ2ZXJQ\nb3J0ID0gc2VydmVyUG9ydDsKICAgICAgICAgICAgdGhpcy5zc2xTZXJ2ZXJQ\nb3J0ID0gc3NsU2VydmVyUG9ydDsKICAgICAgICAgICAgdGhpcy5yZWdpb25O\nYW1lID0gcmVnaW9uTmFtZTsKICAgICAgICAgICAgc2V0UmVnaW9uTGlzdCgp\nOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgc2V0UmVnaW9u\nTGlzdCgpIHsKICAgICAgICAgICAgTGlzdDxTdHJpbmc+IG15UmVnaW9uTGlz\ndCA9IG5ldyBMaW5rZWRMaXN0PFN0cmluZz4oKTsKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBudW1SZWdpb25zOyBpKyspIHsKICAgICAgICAg\nICAgICAgIGludCBjdXJEZWZhdWx0U2VydmVyUG9ydCA9IGluaXRpYWxTZXJ2\nZXJQb3J0ICsgKGkgKiBudW1TZXJ2ZXJzUGVyUmVnaW9uKTsKICAgICAgICAg\nICAgICAgIGludCBjdXJEZWZhdWx0U1NMU2VydmVyUG9ydCA9IGluaXRpYWxT\nU0xTZXJ2ZXJQb3J0ICsgKGkgKiBudW1TZXJ2ZXJzUGVyUmVnaW9uKTsKICAg\nICAgICAgICAgICAgIC8vIEFkZCB0aGlzIHJlZ2lvbiBkZWZhdWx0IHNlcnZl\nciBwb3J0IGlmIGl0IGlzIGZvciBhIHJlZ2lvbgogICAgICAgICAgICAgICAg\nLy8gb3RoZXIgdGhhbiBpdHMgb3duLgogICAgICAgICAgICAgICAgaWYgKGN1\nckRlZmF1bHRTZXJ2ZXJQb3J0ID4gc2VydmVyUG9ydAogICAgICAgICAgICAg\nICAgICAgICAgICB8fCBNYXRoLmFicyhzZXJ2ZXJQb3J0IC0gY3VyRGVmYXVs\ndFNlcnZlclBvcnQpID49IG51bVNlcnZlcnNQZXJSZWdpb24pCiAgICAgICAg\nICAgICAgICAgICAgbXlSZWdpb25MaXN0LmFkZCgibG9jYWxob3N0OiIgKyBj\ndXJEZWZhdWx0U2VydmVyUG9ydCArICI6IiArIGN1ckRlZmF1bHRTU0xTZXJ2\nZXJQb3J0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWdpb25MaXN0\nID0gbXlSZWdpb25MaXN0OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIGludCBnZXRTZXJ2ZXJQb3J0KCkgewogICAgICAg\nICAgICByZXR1cm4gc2VydmVyUG9ydDsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgZ2V0U1NMU2VydmVyUG9ydCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNzbFNlcnZlclBvcnQ7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nIGdl\ndFprSG9zdCgpIHsKICAgICAgICAgICAgcmV0dXJuIGJrdGIuZ2V0WmtIb3N0\nUG9ydCgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIFN0cmluZyBnZXRNeVJlZ2lvbigpIHsKICAgICAgICAgICAgcmV0\ndXJuIHJlZ2lvbk5hbWU7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc1NTTEVuYWJsZWQoKSB7CiAgICAg\nICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIGJvb2xlYW4gaXNJbnRlclJlZ2lvblNTTEVu\nYWJsZWQoKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRD\nZXJ0TmFtZSgpIHsKICAgICAgICAgICAgcmV0dXJuICIvc2VydmVyLnAxMiI7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nU3RyaW5nIGdldFBhc3N3b3JkKCkgewogICAgICAgICAgICByZXR1cm4gImVV\neVN2cDJwaE0yV2siOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBNZXRob2Qg\ndG8gZ2V0IGEgU2VydmVyQ29uZmlndXJhdGlvbiBmb3IgdGhlIFB1YlN1YlNl\ncnZlcnMgY3JlYXRlZCB1c2luZwogICAgLy8gdGhlIHNwZWNpZmllZCBwb3J0\ncyBhbmQgcmVnaW9uIG5hbWUuIEV4dGVuZGluZyBjaGlsZCBjbGFzc2VzIGNh\nbiBvdmVycmlkZQogICAgLy8gdGhpcy4gVGhpcyBkZWZhdWx0IGltcGxlbWVu\ndGF0aW9uIHdpbGwgcmV0dXJuIHRoZQogICAgLy8gUmVnaW9uU2VydmVyQ29u\nZmlndXJhdGlvbiBvYmplY3QgZGVmaW5lZCBhYm92ZS4KICAgIHByb3RlY3Rl\nZCBTZXJ2ZXJDb25maWd1cmF0aW9uIGdldFNlcnZlckNvbmZpZ3VyYXRpb24o\naW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0LCBTdHJpbmcgcmVn\naW9uTmFtZSkgewogICAgICAgIHJldHVybiBuZXcgUmVnaW9uU2VydmVyQ29u\nZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0LCByZWdpb25O\nYW1lKTsKICAgIH0KCiAgICAvLyBEZWZhdWx0IENsaWVudENvbmZpZ3VyYXRp\nb24gdG8gdXNlLiBUaGlzIGp1c3QgcG9pbnRzIHRvIHRoZSBmaXJzdAogICAg\nLy8gSGVkd2lnIGh1YiBzZXJ2ZXIgaW4gZWFjaCByZWdpb24gYXMgdGhlICJk\nZWZhdWx0IHNlcnZlciBob3N0IiB0byBjb25uZWN0CiAgICAvLyB0by4KICAg\nIHByb3RlY3RlZCBjbGFzcyBSZWdpb25DbGllbnRDb25maWd1cmF0aW9uIGV4\ndGVuZHMgQ2xpZW50Q29uZmlndXJhdGlvbiB7CiAgICAgICAgcHVibGljIFJl\nZ2lvbkNsaWVudENvbmZpZ3VyYXRpb24oaW50IHNlcnZlclBvcnQsIGludCBz\nc2xTZXJ2ZXJQb3J0KSB7CiAgICAgICAgICAgIG15RGVmYXVsdFNlcnZlckFk\nZHJlc3MgPSBuZXcgSGVkd2lnU29ja2V0QWRkcmVzcygibG9jYWxob3N0OiIg\nKyBzZXJ2ZXJQb3J0ICsgIjoiICsgc3NsU2VydmVyUG9ydCk7CiAgICAgICAg\nfQogICAgICAgIC8vIEJlbG93IHlvdSBjYW4gb3ZlcnJpZGUgYW55IG9mIHRo\nZSBkZWZhdWx0IENsaWVudENvbmZpZ3VyYXRpb24KICAgICAgICAvLyBwYXJh\nbWV0ZXJzIGlmIG5lZWRlZC4KICAgIH0KCiAgICAvLyBNZXRob2QgdG8gZ2V0\nIGEgQ2xpZW50Q29uZmlndXJhdGlvbiBmb3IgdGhlIEhlZHdpZ0NsaWVudHMg\nY3JlYXRlZC4KICAgIC8vIElucHV0cyBhcmUgdGhlIGRlZmF1bHQgSGVkd2ln\nIGh1YiBzZXJ2ZXIncyBwb3J0cyB0byBwb2ludCB0by4KICAgIHByb3RlY3Rl\nZCBDbGllbnRDb25maWd1cmF0aW9uIGdldENsaWVudENvbmZpZ3VyYXRpb24o\naW50IHNlcnZlclBvcnQsIGludCBzc2xTZXJ2ZXJQb3J0KSB7CiAgICAgICAg\ncmV0dXJuIG5ldyBSZWdpb25DbGllbnRDb25maWd1cmF0aW9uKHNlcnZlclBv\ncnQsIHNzbFNlcnZlclBvcnQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\nQEJlZm9yZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBsb2dnZXIuaW5mbygiU1RBUlRJTkcgIiArIGdldE5h\nbWUoKSk7CiAgICAgICAgYmt0YiA9IG5ldyBCb29rS2VlcGVyVGVzdEJhc2Uo\nbnVtQm9va2llcyk7CiAgICAgICAgYmt0Yi5zZXRVcCgpOwoKICAgICAgICAv\nLyBDcmVhdGUgdGhlIEhlZHdpZyBQdWJTdWJTZXJ2ZXIgSHVicyBmb3IgYWxs\nIG9mIHRoZSByZWdpb25zCiAgICAgICAgcmVnaW9uU2VydmVyc01hcCA9IG5l\ndyBIYXNoTWFwPFN0cmluZywgTGlzdDxQdWJTdWJTZXJ2ZXI+PihudW1SZWdp\nb25zLCAxLjBmKTsKICAgICAgICByZWdpb25DbGllbnRzTWFwID0gbmV3IEhh\nc2hNYXA8U3RyaW5nLCBIZWR3aWdDbGllbnQ+KG51bVJlZ2lvbnMsIDEuMGYp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtUmVnaW9uczsgaSsr\nKSB7CiAgICAgICAgICAgIHN0YXJ0UmVnaW9uKGkpOwogICAgICAgIH0KICAg\nICAgICBsb2dnZXIuaW5mbygiSGVkd2lnUmVnaW9uIHRlc3Qgc2V0dXAgZmlu\naXNoZWQiKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIEBBZnRlcgogICAg\ncHVibGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBsb2dnZXIuaW5mbygidGVhckRvd24gc3RhcnRpbmciKTsKICAgICAg\nICAvLyBTdG9wIGFsbCBvZiB0aGUgSGVkd2lnQ2xpZW50cyBmb3IgYWxsIHJl\nZ2lvbnMKICAgICAgICBmb3IgKEhlZHdpZ0NsaWVudCBjbGllbnQgOiByZWdp\nb25DbGllbnRzTWFwLnZhbHVlcygpKSB7CiAgICAgICAgICAgIGNsaWVudC5j\nbG9zZSgpOwogICAgICAgIH0KICAgICAgICByZWdpb25DbGllbnRzTWFwLmNs\nZWFyKCk7CiAgICAgICAgLy8gU2h1dGRvd24gYWxsIG9mIHRoZSBQdWJTdWJT\nZXJ2ZXJzIGluIGFsbCByZWdpb25zCiAgICAgICAgZm9yIChMaXN0PFB1YlN1\nYlNlcnZlcj4gc2VydmVyc0xpc3QgOiByZWdpb25TZXJ2ZXJzTWFwLnZhbHVl\ncygpKSB7CiAgICAgICAgICAgIGZvciAoUHViU3ViU2VydmVyIHNlcnZlciA6\nIHNlcnZlcnNMaXN0KSB7CiAgICAgICAgICAgICAgICBzZXJ2ZXIuc2h1dGRv\nd24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBsb2dnZXIu\naW5mbygiRmluaXNoZWQgc2h1dHRpbmcgZG93biBhbGwgb2YgdGhlIGh1YiBz\nZXJ2ZXJzISIpOwogICAgICAgIHJlZ2lvblNlcnZlcnNNYXAuY2xlYXIoKTsK\nICAgICAgICAvLyBTaHV0ZG93biB0aGUgQm9va0tlZXBlciBhbmQgWm9vS2Vl\ncGVyIHN0dWZmCiAgICAgICAgYmt0Yi50ZWFyRG93bigpOwogICAgICAgIGxv\nZ2dlci5pbmZvKCJGSU5JU0hFRCAiICsgZ2V0TmFtZSgpKTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBzdG9wUmVnaW9uKGludCByZWdpb25JZHgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZyByZWdpb25OYW1lID0g\nUkVHSU9OX1BSRUZJWCArIHJlZ2lvbklkeDsKICAgICAgICBpZiAobG9nZ2Vy\nLmlzRGVidWdFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nZ2VyLmRlYnVn\nKCJTdG9wIHJlZ2lvbiA6ICIgKyByZWdpb25OYW1lKTsKICAgICAgICB9CiAg\nICAgICAgSGVkd2lnQ2xpZW50IHJlZ2lvbkNsaWVudCA9IHJlZ2lvbkNsaWVu\ndHNNYXAucmVtb3ZlKHJlZ2lvbk5hbWUpOwogICAgICAgIGlmIChudWxsICE9\nIHJlZ2lvbkNsaWVudCkgewogICAgICAgICAgICByZWdpb25DbGllbnQuY2xv\nc2UoKTsKICAgICAgICB9CiAgICAgICAgTGlzdDxQdWJTdWJTZXJ2ZXI+IHNl\ncnZlcnNMaXN0ID0gcmVnaW9uU2VydmVyc01hcC5yZW1vdmUocmVnaW9uTmFt\nZSk7CiAgICAgICAgaWYgKG51bGwgPT0gc2VydmVyc0xpc3QpIHsKICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBmb3IgKFB1YlN1YlNl\ncnZlciBzZXJ2ZXIgOiBzZXJ2ZXJzTGlzdCkgewogICAgICAgICAgICBzZXJ2\nZXIuc2h1dGRvd24oKTsKICAgICAgICB9CiAgICAgICAgbG9nZ2VyLmluZm8o\nIkZpbmlzaGVkIHNodXR0aW5nIGRvd24gYWxsIG9mIHRoZSBodWIgc2VydmVy\ncyBpbiByZWdpb24gIiArIHJlZ2lvbk5hbWUpOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIHN0YXJ0UmVnaW9uKGludCBpKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBTdHJpbmcgcmVnaW9uTmFtZSA9IFJFR0lPTl9QUkVGSVgg\nKyBpOwogICAgICAgIGlmIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkgewog\nICAgICAgICAgICBsb2dnZXIuZGVidWcoIlN0YXJ0IHJlZ2lvbiA6ICIgKyBy\nZWdpb25OYW1lKTsKICAgICAgICB9CiAgICAgICAgTGlzdDxQdWJTdWJTZXJ2\nZXI+IHNlcnZlcnNMaXN0ID0gbmV3IExpbmtlZExpc3Q8UHViU3ViU2VydmVy\nPigpOwogICAgICAgIC8vIEZvciB0aGUgY3VycmVudCByZWdpb24sIGNyZWF0\nZSB0aGUgbmVjZXNzYXJ5IGFtb3VudCBvZiBodWIKICAgICAgICAvLyBzZXJ2\nZXJzLiBXZSB3aWxsIGJhc2ljYWxseSBpbmNyZW1lbnQgdGhyb3VnaCB0aGUg\ncG9ydCBudW1iZXJzCiAgICAgICAgLy8gc3RhcnRpbmcgZnJvbSB0aGUgaW5p\ndGlhbCBvbmVzIGRlZmluZWQuCiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGog\nPCBudW1TZXJ2ZXJzUGVyUmVnaW9uOyBqKyspIHsKICAgICAgICAgICAgUHVi\nU3ViU2VydmVyIHMgPSBuZXcgUHViU3ViU2VydmVyKAogICAgICAgICAgICAg\nICAgICAgIGdldFNlcnZlckNvbmZpZ3VyYXRpb24oaW5pdGlhbFNlcnZlclBv\ncnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgKGogKyBpICogbnVtU2VydmVyc1BlclJlZ2lvbiksCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsU1NMU2Vy\ndmVyUG9ydCArIChqICsgaSAqIG51bVNlcnZlcnNQZXJSZWdpb24pLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9u\nTmFtZSkpOwogICAgICAgICAgICBzZXJ2ZXJzTGlzdC5hZGQocyk7CiAgICAg\nICAgICAgIHMuc3RhcnQoKTsKICAgICAgICB9CiAgICAgICAgLy8gU3RvcmUg\ndGhpcyBsaXN0IG9mIHNlcnZlcnMgY3JlYXRlZCBmb3IgdGhlIGN1cnJlbnQg\ncmVnaW9uCiAgICAgICAgcmVnaW9uU2VydmVyc01hcC5wdXQocmVnaW9uTmFt\nZSwgc2VydmVyc0xpc3QpOwogICAgICAgIC8vIENyZWF0ZSBhIEhlZHdpZyBD\nbGllbnQgdGhhdCBwb2ludHMgdG8gdGhlIGZpcnN0IEh1YiBzZXJ2ZXIKICAg\nICAgICAvLyBjcmVhdGVkIGluIHRoZSBsb29wIGFib3ZlIGZvciB0aGUgY3Vy\ncmVudCByZWdpb24uCiAgICAgICAgSGVkd2lnQ2xpZW50IHJlZ2lvbkNsaWVu\ndCA9IG5ldyBIZWR3aWdDbGllbnQoZ2V0Q2xpZW50Q29uZmlndXJhdGlvbihp\nbml0aWFsU2VydmVyUG9ydAogICAgICAgICAgICAgICAgKyAoaSAqIG51bVNl\ncnZlcnNQZXJSZWdpb24pLCBpbml0aWFsU1NMU2VydmVyUG9ydCArIChpICog\nbnVtU2VydmVyc1BlclJlZ2lvbikpKTsKICAgICAgICByZWdpb25DbGllbnRz\nTWFwLnB1dChyZWdpb25OYW1lLCByZWdpb25DbGllbnQpOwogICAgfQp9Cg==\n","encoding":"base64"}

