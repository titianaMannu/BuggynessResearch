{"sha":"fecf86184a7472c2211590f4ef3f81e9761bb14e","node_id":"MDQ6QmxvYjE1NzU5NTY6ZmVjZjg2MTg0YTc0NzJjMjIxMTU5MGY0ZWYzZjgxZTk3NjFiYjE0ZQ==","size":4796,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/fecf86184a7472c2211590f4ef3f81e9761bb14e","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5I\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwoKaW1wb3J0IGNvbS5nb29nbGUucHJvdG9idWYuQnl0ZVN0cmlu\nZzsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3Vi\nRXhjZXB0aW9uLlNlcnZpY2VEb3duRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuTWVzc2FnZTsK\naW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnByb3RvY29sLlB1YlN1YlByb3Rv\nY29sLk1lc3NhZ2VTZXFJZDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnBy\nb3RvZXh0ZW5zaW9ucy5NZXNzYWdlSWRVdGlsczsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci5wZXJzaXN0ZW5jZS5TY2FuQ2FsbGJhY2suUmVh\nc29uRm9yRmluaXNoOwoKcHVibGljIGNsYXNzIFN0dWJQZXJzaXN0ZW5jZU1h\nbmFnZXIgaW1wbGVtZW50cyBQZXJzaXN0ZW5jZU1hbmFnZXJXaXRoUmFuZ2VT\nY2FuIHsKICAgIE1hcDxCeXRlU3RyaW5nLCBMaXN0PE1lc3NhZ2U+PiBtZXNz\nYWdlcyA9IG5ldyBIYXNoTWFwPEJ5dGVTdHJpbmcsIExpc3Q8TWVzc2FnZT4+\nKCk7CiAgICBib29sZWFuIGZhaWx1cmUgPSBmYWxzZTsKICAgIFNlcnZpY2VE\nb3duRXhjZXB0aW9uIGV4Y2VwdGlvbiA9IG5ldyBTZXJ2aWNlRG93bkV4Y2Vw\ndGlvbigiQXNrZWQgdG8gZmFpbCIpOwoKICAgIHB1YmxpYyB2b2lkIGRlbGl2\nZXJlZFVudGlsKEJ5dGVTdHJpbmcgdG9waWMsIExvbmcgc2VxSWQpIHsKICAg\nICAgICAvLyBub29wCiAgICB9CgogICAgcHVibGljIHZvaWQgY29uc3VtZWRV\nbnRpbChCeXRlU3RyaW5nIHRvcGljLCBMb25nIHNlcUlkKSB7CiAgICAgICAg\nLy8gbm9vcAogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldE1lc3NhZ2VCb3Vu\nZChCeXRlU3RyaW5nIHRvcGljLCBJbnRlZ2VyIGJvdW5kKSB7CiAgICAgICAg\nLy8gbm9vcAogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsZWFyTWVzc2FnZUJv\ndW5kKEJ5dGVTdHJpbmcgdG9waWMpIHsKICAgICAgICAvLyBub29wCiAgICB9\nCgogICAgcHVibGljIHZvaWQgY29uc3VtZVRvQm91bmQoQnl0ZVN0cmluZyB0\nb3BpYykgewogICAgICAgIC8vIG5vb3AKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nc3RhdGljIGNsYXNzIEFycmF5TGlzdE1lc3NhZ2VGYWN0b3J5IGltcGxlbWVu\ndHMgRmFjdG9yeTxMaXN0PE1lc3NhZ2U+PiB7CiAgICAgICAgc3RhdGljIEFy\ncmF5TGlzdE1lc3NhZ2VGYWN0b3J5IGluc3RhbmNlID0gbmV3IEFycmF5TGlz\ndE1lc3NhZ2VGYWN0b3J5KCk7CgogICAgICAgIHB1YmxpYyBMaXN0PE1lc3Nh\nZ2U+IG5ld0luc3RhbmNlKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEFy\ncmF5TGlzdDxNZXNzYWdlPigpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgTWVzc2FnZVNlcUlkIGdldEN1cnJlbnRTZXFJZEZvclRvcGljKEJ5dGVT\ndHJpbmcgdG9waWMpIHsKICAgICAgICBsb25nIHNlcUlkID0gTWFwTWV0aG9k\ncy5nZXRBZnRlckluc2VydGluZ0lmQWJzZW50KG1lc3NhZ2VzLCB0b3BpYywg\nQXJyYXlMaXN0TWVzc2FnZUZhY3RvcnkuaW5zdGFuY2UpLnNpemUoKTsKICAg\nICAgICByZXR1cm4gTWVzc2FnZVNlcUlkLm5ld0J1aWxkZXIoKS5zZXRMb2Nh\nbENvbXBvbmVudChzZXFJZCkuYnVpbGQoKTsKICAgIH0KCiAgICBwdWJsaWMg\nbG9uZyBnZXRTZXFJZEFmdGVyU2tpcHBpbmcoQnl0ZVN0cmluZyB0b3BpYywg\nbG9uZyBzZXFJZCwgaW50IHNraXBBbW91bnQpIHsKICAgICAgICByZXR1cm4g\nc2VxSWQgKyBza2lwQW1vdW50OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBl\ncnNpc3RNZXNzYWdlKFBlcnNpc3RSZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAg\nICBpZiAoZmFpbHVyZSkgewogICAgICAgICAgICByZXF1ZXN0LmNhbGxiYWNr\nLm9wZXJhdGlvbkZhaWxlZChyZXF1ZXN0LmdldEN0eCgpLCBleGNlcHRpb24p\nOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBNYXBN\nZXRob2RzLmFkZFRvTXVsdGlNYXAobWVzc2FnZXMsIHJlcXVlc3QuZ2V0VG9w\naWMoKSwgcmVxdWVzdC5nZXRNZXNzYWdlKCksIEFycmF5TGlzdE1lc3NhZ2VG\nYWN0b3J5Lmluc3RhbmNlKTsKICAgICAgICByZXF1ZXN0LmNhbGxiYWNrLm9w\nZXJhdGlvbkZpbmlzaGVkKHJlcXVlc3QuZ2V0Q3R4KCksIChsb25nKSBtZXNz\nYWdlcy5nZXQocmVxdWVzdC5nZXRUb3BpYygpKS5zaXplKCkpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNjYW5TaW5nbGVNZXNzYWdlKFNjYW5SZXF1ZXN0\nIHJlcXVlc3QpIHsKICAgICAgICBpZiAoZmFpbHVyZSkgewogICAgICAgICAg\nICByZXF1ZXN0LmdldENhbGxiYWNrKCkuc2NhbkZhaWxlZChyZXF1ZXN0Lmdl\ndEN0eCgpLCBleGNlcHRpb24pOwogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgfQoKICAgICAgICByZXF1ZXN0LmdldENhbGxiYWNrKCkubWVzc2FnZVNj\nYW5uZWQocmVxdWVzdC5nZXRDdHgoKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZXMuZ2V0KHJlcXVlc3Qu\nZ2V0VG9waWMoKSkuZ2V0KChpbnQpIHJlcXVlc3QuZ2V0U3RhcnRTZXFJZCgp\nKSk7CgogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNjYW5NZXNzYWdlcyhSYW5n\nZVNjYW5SZXF1ZXN0IHJlcXVlc3QpIHsKICAgICAgICBpZiAoZmFpbHVyZSkg\newogICAgICAgICAgICByZXF1ZXN0LmdldENhbGxiYWNrKCkuc2NhbkZhaWxl\nZChyZXF1ZXN0LmdldEN0eCgpLCBleGNlcHRpb24pOwogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQoKICAgICAgICBsb25nIHRvdGFsU2l6ZSA9IDA7\nCiAgICAgICAgbG9uZyBzdGFydFNlcUlkID0gcmVxdWVzdC5nZXRTdGFydFNl\ncUlkKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZXF1ZXN0Lmdl\ndE1lc3NhZ2VMaW1pdCgpOyBpKyspIHsKICAgICAgICAgICAgTGlzdDxNZXNz\nYWdlPiBtZXNzYWdlTGlzdCA9IE1hcE1ldGhvZHMuZ2V0QWZ0ZXJJbnNlcnRp\nbmdJZkFic2VudChtZXNzYWdlcywgcmVxdWVzdC5nZXRUb3BpYygpLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXlMaXN0\nTWVzc2FnZUZhY3RvcnkuaW5zdGFuY2UpOwogICAgICAgICAgICBpZiAoc3Rh\ncnRTZXFJZCArIGkgPiBtZXNzYWdlTGlzdC5zaXplKCkpIHsKICAgICAgICAg\nICAgICAgIHJlcXVlc3QuZ2V0Q2FsbGJhY2soKS5zY2FuRmluaXNoZWQocmVx\ndWVzdC5nZXRDdHgoKSwgUmVhc29uRm9yRmluaXNoLk5PX01PUkVfTUVTU0FH\nRVMpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIE1lc3NhZ2UgbXNnID0gbWVzc2FnZUxpc3QuZ2V0KChpbnQp\nIHN0YXJ0U2VxSWQgKyBpIC0gMSk7CiAgICAgICAgICAgIE1lc3NhZ2UgdG9E\nZWxpdmVyID0gTWVzc2FnZUlkVXRpbHMubWVyZ2VMb2NhbFNlcUlkKG1zZywg\nc3RhcnRTZXFJZCArIGkpOwogICAgICAgICAgICByZXF1ZXN0LmdldENhbGxi\nYWNrKCkubWVzc2FnZVNjYW5uZWQocmVxdWVzdC5nZXRDdHgoKSwgdG9EZWxp\ndmVyKTsKCiAgICAgICAgICAgIHRvdGFsU2l6ZSArPSB0b0RlbGl2ZXIuZ2V0\nQm9keSgpLnNpemUoKTsKCiAgICAgICAgICAgIGlmICh0b3RhbFNpemUgPiBy\nZXF1ZXN0LmdldFNpemVMaW1pdCgpKSB7CiAgICAgICAgICAgICAgICByZXF1\nZXN0LmdldENhbGxiYWNrKCkuc2NhbkZpbmlzaGVkKHJlcXVlc3QuZ2V0Q3R4\nKCksIFJlYXNvbkZvckZpbmlzaC5TSVpFX0xJTUlUX0VYQ0VFREVEKTsKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICByZXF1ZXN0LmdldENhbGxiYWNrKCkuc2NhbkZpbmlzaGVkKHJl\ncXVlc3QuZ2V0Q3R4KCksIFJlYXNvbkZvckZpbmlzaC5OVU1fTUVTU0FHRVNf\nTElNSVRfRVhDRUVERUQpOwoKICAgIH0KfQo=\n","encoding":"base64"}

