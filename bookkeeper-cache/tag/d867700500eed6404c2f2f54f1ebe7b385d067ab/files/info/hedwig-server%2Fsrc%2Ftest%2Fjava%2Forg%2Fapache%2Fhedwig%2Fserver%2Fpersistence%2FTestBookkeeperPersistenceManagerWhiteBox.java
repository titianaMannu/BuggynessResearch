{"sha":"216cd8aa70349da6adc004880e286975b8967f06","node_id":"MDQ6QmxvYjE1NzU5NTY6MjE2Y2Q4YWE3MDM0OWRhNmFkYzAwNDg4MGUyODY5NzViODk2N2YwNg==","size":5449,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/216cd8aa70349da6adc004880e286975b8967f06","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuUmFuZG9t\nOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JzOwppbXBv\ncnQgamF2YS51dGlsLmNvbmN1cnJlbnQuU2NoZWR1bGVkRXhlY3V0b3JTZXJ2\naWNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0Q2FzZTsKCmltcG9y\ndCBvcmcuYXBhY2hlLmJvb2trZWVwZXIuY2xpZW50LkJvb2tLZWVwZXI7Cmlt\ncG9ydCBvcmcuanVuaXQuQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVmb3Jl\nOwppbXBvcnQgb3JnLmp1bml0LlRlc3Q7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy51dGlsLkVpdGhlcjsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVm\nLkJ5dGVTdHJpbmc7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5IZWxwZXJN\nZXRob2RzOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcuU3R1YkNhbGxiYWNr\nOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcucHJvdG9jb2wuUHViU3ViUHJv\ndG9jb2wuTWVzc2FnZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZl\nci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLnNlcnZlci50b3BpY3MuVG9waWNNYW5hZ2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuc2VydmVyLnRvcGljcy5Ucml2aWFsT3duQWxs\nVG9waWNNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcudXRpbC5D\nb25jdXJyZW5jeVV0aWxzOwoKcHVibGljIGNsYXNzIFRlc3RCb29ra2VlcGVy\nUGVyc2lzdGVuY2VNYW5hZ2VyV2hpdGVCb3ggZXh0ZW5kcyBUZXN0Q2FzZSB7\nCgogICAgQm9va0tlZXBlclRlc3RCYXNlIGJrdGI7CiAgICBwcml2YXRlIGZp\nbmFsIGludCBudW1Cb29raWVzID0gMzsKICAgIEJvb2trZWVwZXJQZXJzaXN0\nZW5jZU1hbmFnZXIgYmtwbTsKICAgIFNlcnZlckNvbmZpZ3VyYXRpb24gY29u\nZjsKICAgIFNjaGVkdWxlZEV4ZWN1dG9yU2VydmljZSBzY2hlZHVsZXI7CiAg\nICBUb3BpY01hbmFnZXIgdG07CiAgICBCeXRlU3RyaW5nIHRvcGljID0gQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgoInRvcGljMCIpOwoKICAgIEBPdmVycmlk\nZQogICAgQEJlZm9yZQogICAgcHJvdGVjdGVkIHZvaWQgc2V0VXAoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5zZXRVcCgpOwogICAgICAg\nIGJrdGIgPSBuZXcgQm9va0tlZXBlclRlc3RCYXNlKG51bUJvb2tpZXMpOwog\nICAgICAgIGJrdGIuc2V0VXAoKTsKCiAgICAgICAgY29uZiA9IG5ldyBTZXJ2\nZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAgc2NoZWR1bGVyID0gRXhlY3V0\nb3JzLm5ld1NjaGVkdWxlZFRocmVhZFBvb2woMSk7CiAgICAgICAgdG0gPSBu\nZXcgVHJpdmlhbE93bkFsbFRvcGljTWFuYWdlcihjb25mLCBzY2hlZHVsZXIp\nOwoKICAgICAgICBia3BtID0gbmV3IEJvb2trZWVwZXJQZXJzaXN0ZW5jZU1h\nbmFnZXIoYmt0Yi5iaywgYmt0Yi5nZXRab29LZWVwZXJDbGllbnQoKSwgdG0s\nIGNvbmYsIHNjaGVkdWxlcik7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBA\nQWZ0ZXIKICAgIHByb3RlY3RlZCB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgYmt0Yi50ZWFyRG93bigpOwogICAgICAgIHN1\ncGVyLnRlYXJEb3duKCk7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2\nb2lkIHRlc3RFbXB0eURpcnR5TGVkZ2VyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCgogICAgICAgIFN0dWJDYWxsYmFjazxWb2lkPiBzdHViQ2FsbGJhY2sgPSBu\nZXcgU3R1YkNhbGxiYWNrPFZvaWQ+KCk7CiAgICAgICAgYmtwbS5hY3F1aXJl\nZFRvcGljKHRvcGljLCBzdHViQ2FsbGJhY2ssIG51bGwpOwogICAgICAgIGFz\nc2VydE51bGwoQ29uY3VycmVuY3lVdGlscy50YWtlKHN0dWJDYWxsYmFjay5x\ndWV1ZSkucmlnaHQoKSk7CiAgICAgICAgLy8gbm93IGFiYW5kb24sIGFuZCB0\ncnkgYW5vdGhlciB0aW1lLCB0aGUgcHJldiBsZWRnZXIgc2hvdWxkIGJlIGRp\ncnR5CgogICAgICAgIGJrcG0gPSBuZXcgQm9va2tlZXBlclBlcnNpc3RlbmNl\nTWFuYWdlcihuZXcgQm9va0tlZXBlcihia3RiLmdldFprSG9zdFBvcnQoKSks\nIGJrdGIuZ2V0Wm9vS2VlcGVyQ2xpZW50KCksIHRtLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25mLCBzY2hl\nZHVsZXIpOwogICAgICAgIGJrcG0uYWNxdWlyZWRUb3BpYyh0b3BpYywgc3R1\nYkNhbGxiYWNrLCBudWxsKTsKICAgICAgICBhc3NlcnROdWxsKENvbmN1cnJl\nbmN5VXRpbHMudGFrZShzdHViQ2FsbGJhY2sucXVldWUpLnJpZ2h0KCkpOwog\nICAgICAgIGFzc2VydEVxdWFscygwLCBia3BtLnRvcGljSW5mb3MuZ2V0KHRv\ncGljKS5sZWRnZXJSYW5nZXMuc2l6ZSgpKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0Tm9uRW1wdHlEaXJ0eUxlZGdlcigpIHRocm93cyBFeGNlcHRp\nb24gewoKICAgICAgICBSYW5kb20gciA9IG5ldyBSYW5kb20oKTsKICAgICAg\nICBpbnQgTlVNX01FU1NBR0VTX1RPX1RFU1QgPSAxMDA7CiAgICAgICAgaW50\nIFNJWkVfT0ZfTUVTU0FHRVNfVE9fVEVTVCA9IDEwMDsKICAgICAgICBpbnQg\naW5kZXggPSAwOwogICAgICAgIGludCBudW1QcmV2TGVkZ2VycyA9IDA7CiAg\nICAgICAgTGlzdDxNZXNzYWdlPiBtZXNzYWdlcyA9IEhlbHBlck1ldGhvZHMu\nZ2V0UmFuZG9tUHVibGlzaGVkTWVzc2FnZXMoTlVNX01FU1NBR0VTX1RPX1RF\nU1QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNJWkVfT0Zf\nTUVTU0FHRVNfVE9fVEVTVCk7CgogICAgICAgIHdoaWxlIChpbmRleCA8IG1l\nc3NhZ2VzLnNpemUoKSkgewoKICAgICAgICAgICAgU3R1YkNhbGxiYWNrPFZv\naWQ+IHN0dWJDYWxsYmFjayA9IG5ldyBTdHViQ2FsbGJhY2s8Vm9pZD4oKTsK\nICAgICAgICAgICAgYmtwbS5hY3F1aXJlZFRvcGljKHRvcGljLCBzdHViQ2Fs\nbGJhY2ssIG51bGwpOwogICAgICAgICAgICBhc3NlcnROdWxsKENvbmN1cnJl\nbmN5VXRpbHMudGFrZShzdHViQ2FsbGJhY2sucXVldWUpLnJpZ2h0KCkpOwog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMobnVtUHJldkxlZGdlcnMsIGJrcG0u\ndG9waWNJbmZvcy5nZXQodG9waWMpLmxlZGdlclJhbmdlcy5zaXplKCkpOwoK\nICAgICAgICAgICAgU3R1YkNhbGxiYWNrPExvbmc+IHBlcnNpc3RDYWxsYmFj\nayA9IG5ldyBTdHViQ2FsbGJhY2s8TG9uZz4oKTsKICAgICAgICAgICAgYmtw\nbS5wZXJzaXN0TWVzc2FnZShuZXcgUGVyc2lzdFJlcXVlc3QodG9waWMsIG1l\nc3NhZ2VzLmdldChpbmRleCksIHBlcnNpc3RDYWxsYmFjaywgbnVsbCkpOwog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMobmV3IExvbmcoaW5kZXggKyAxKSwg\nQ29uY3VycmVuY3lVdGlscy50YWtlKHBlcnNpc3RDYWxsYmFjay5xdWV1ZSku\nbGVmdCgpKTsKCiAgICAgICAgICAgIC8vIG9uY2UgaW4gZXZlcnkgMTAgdGlt\nZXMsIGdpdmUgdXAgbGVkZ2VyCiAgICAgICAgICAgIGlmIChyLm5leHRJbnQo\nMTApID09IDkpIHsKICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIGJrcG0g\nbG9zZSBpdHMgbWVtb3J5CiAgICAgICAgICAgICAgICBia3BtLnRvcGljSW5m\nb3MuY2xlYXIoKTsKICAgICAgICAgICAgICAgIG51bVByZXZMZWRnZXJzKys7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW5kZXgrKzsKICAgICAgICB9\nCgogICAgICAgIC8vIGVuc3VyZSB0aGUgYmtwbSBoYXMgdGhlIHRvcGljIGJl\nZm9yZSBzY2FubmluZwogICAgICAgIFN0dWJDYWxsYmFjazxWb2lkPiBzdHVi\nQ2FsbGJhY2sgPSBuZXcgU3R1YkNhbGxiYWNrPFZvaWQ+KCk7CiAgICAgICAg\nYmtwbS5hY3F1aXJlZFRvcGljKHRvcGljLCBzdHViQ2FsbGJhY2ssIG51bGwp\nOwoKICAgICAgICAvLyBMZXRzIHNjYW4gbm93CiAgICAgICAgU3R1YlNjYW5D\nYWxsYmFjayBzY2FuQ2FsbGJhY2sgPSBuZXcgU3R1YlNjYW5DYWxsYmFjaygp\nOwogICAgICAgIGJrcG0uc2Nhbk1lc3NhZ2VzKG5ldyBSYW5nZVNjYW5SZXF1\nZXN0KHRvcGljLCAxLCBOVU1fTUVTU0FHRVNfVE9fVEVTVCwgTG9uZy5NQVhf\nVkFMVUUsIHNjYW5DYWxsYmFjaywgbnVsbCkpOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbWVzc2FnZXMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAg\nICAgRWl0aGVyPE1lc3NhZ2UsRXhjZXB0aW9uPiBlID0gQ29uY3VycmVuY3lV\ndGlscy50YWtlKHNjYW5DYWxsYmFjay5xdWV1ZSk7CiAgICAgICAgICAgIE1l\nc3NhZ2Ugc2Nhbm5lZE1lc3NhZ2UgPSBlLmxlZnQoKTsKICAgICAgICAgICAg\naWYgKHNjYW5uZWRNZXNzYWdlID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIHRocm93IGUucmlnaHQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZShtZXNzYWdlcy5nZXQoaSkuZ2V0Qm9keSgpLmVxdWFscyhz\nY2FubmVkTWVzc2FnZS5nZXRCb2R5KCkpKTsKICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKGkgKyAxLCBzY2FubmVkTWVzc2FnZS5nZXRNc2dJZCgpLmdldExv\nY2FsQ29tcG9uZW50KCkpOwogICAgICAgIH0KICAgICAgICBhc3NlcnRUcnVl\nKFN0dWJTY2FuQ2FsbGJhY2suRU5EX01FU1NBR0UgPT0gQ29uY3VycmVuY3lV\ndGlscy50YWtlKHNjYW5DYWxsYmFjay5xdWV1ZSkubGVmdCgpKTsKCiAgICB9\nCgp9Cg==\n","encoding":"base64"}

