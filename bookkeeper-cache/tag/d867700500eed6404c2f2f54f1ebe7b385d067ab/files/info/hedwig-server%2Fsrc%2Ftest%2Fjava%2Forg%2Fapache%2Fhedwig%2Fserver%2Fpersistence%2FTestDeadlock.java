{"sha":"114e0c5970d7eb93bd4546c6076db60f89a01cf2","node_id":"MDQ6QmxvYjE1NzU5NTY6MTE0ZTBjNTk3MGQ3ZWI5M2JkNDU0NmM2MDc2ZGI2MGY4OWEwMWNmMg==","size":10126,"url":"https://api.github.com/repos/apache/bookkeeper/git/blobs/114e0c5970d7eb93bd4546c6076db60f89a01cf2","content":"LyoqCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9y\nIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLmhlZHdpZy5zZXJ2ZXIucGVyc2lzdGVuY2U7Cgpp\nbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvdW50RG93bkxhdGNoOwppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQuU3luY2hyb25vdXNRdWV1ZTsKCmltcG9ydCBvcmcuanVuaXQu\nQWZ0ZXI7CmltcG9ydCBvcmcuanVuaXQuQmVmb3JlOwppbXBvcnQgb3JnLmp1\nbml0LlRlc3Q7CgppbXBvcnQgb3JnLnNsZjRqLkxvZ2dlcjsKaW1wb3J0IG9y\nZy5zbGY0ai5Mb2dnZXJGYWN0b3J5OwoKaW1wb3J0IGNvbS5nb29nbGUucHJv\ndG9idWYuQnl0ZVN0cmluZzsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNs\naWVudC5hcGkuTWVzc2FnZUhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hlLmhl\nZHdpZy5jbGllbnQuYXBpLlB1Ymxpc2hlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\naGVkd2lnLmNsaWVudC5hcGkuU3Vic2NyaWJlcjsKaW1wb3J0IG9yZy5hcGFj\naGUuaGVkd2lnLmV4Y2VwdGlvbnMuUHViU3ViRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5oZWR3aWcuY2xpZW50LmNvbmYuQ2xpZW50Q29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLmNsaWVudC5IZWR3aWdD\nbGllbnQ7CmltcG9ydCBvcmcuYXBhY2hlLmhlZHdpZy5wcm90b2NvbC5QdWJT\ndWJQcm90b2NvbC5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5oZWR3aWcu\ncHJvdG9jb2wuUHViU3ViUHJvdG9jb2wuU3Vic2NyaWJlUmVxdWVzdC5DcmVh\ndGVPckF0dGFjaDsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNlcnZlci5I\nZWR3aWdIdWJUZXN0QmFzZTsKaW1wb3J0IG9yZy5hcGFjaGUuaGVkd2lnLnNl\ncnZlci5jb21tb24uU2VydmVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUuaGVkd2lnLnV0aWwuQ2FsbGJhY2s7CmltcG9ydCBvcmcuYXBhY2hl\nLmhlZHdpZy51dGlsLkNvbmN1cnJlbmN5VXRpbHM7CgpwdWJsaWMgY2xhc3Mg\nVGVzdERlYWRsb2NrIGV4dGVuZHMgSGVkd2lnSHViVGVzdEJhc2UgewoKICAg\nIHByb3RlY3RlZCBzdGF0aWMgTG9nZ2VyIGxvZ2dlciA9IExvZ2dlckZhY3Rv\ncnkuZ2V0TG9nZ2VyKFRlc3REZWFkbG9jay5jbGFzcyk7CgogICAgLy8gQ2xp\nZW50IHNpZGUgdmFyaWFibGVzCiAgICBwcm90ZWN0ZWQgSGVkd2lnQ2xpZW50\nIGNsaWVudDsKICAgIHByb3RlY3RlZCBQdWJsaXNoZXIgcHVibGlzaGVyOwog\nICAgcHJvdGVjdGVkIFN1YnNjcmliZXIgc3Vic2NyaWJlcjsKCiAgICBCeXRl\nU3RyaW5nIHRvcGljID0gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkRlYWRM\nb2NrVG9waWMiKTsKICAgIEJ5dGVTdHJpbmcgc3Vic2NyaWJlcklkID0gQnl0\nZVN0cmluZy5jb3B5RnJvbVV0ZjgoImRsIik7CgogICAgQE92ZXJyaWRlCiAg\nICBAQmVmb3JlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIG51bVNlcnZlcnMgPSAxOwogICAgICAgIG51bUJv\nb2tpZXMgPSAxOwogICAgICAgIHJlYWREZWxheSA9IDEwMDBMOyAvLyAxcwog\nICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgY2xpZW50ID0gbmV3IEhl\nZHdpZ0NsaWVudChuZXcgQ2xpZW50Q29uZmlndXJhdGlvbigpKTsKICAgICAg\nICBwdWJsaXNoZXIgPSBjbGllbnQuZ2V0UHVibGlzaGVyKCk7CiAgICAgICAg\nc3Vic2NyaWJlciA9IGNsaWVudC5nZXRTdWJzY3JpYmVyKCk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBAQWZ0ZXIKICAgIHB1YmxpYyB2b2lkIHRlYXJE\nb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgY2xpZW50LmNsb3Nl\nKCk7CiAgICAgICAgc3VwZXIudGVhckRvd24oKTsKICAgIH0KCiAgICAvLyBU\nZXN0IGltcGxlbWVudGF0aW9uIG9mIENhbGxiYWNrIGZvciBhc3luYyBjbGll\nbnQgYWN0aW9ucy4KICAgIHN0YXRpYyBjbGFzcyBUZXN0Q2FsbGJhY2sgaW1w\nbGVtZW50cyBDYWxsYmFjazxWb2lkPiB7CiAgICAgICAgcHJpdmF0ZSBmaW5h\nbCBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IHF1ZXVlOwoKICAgICAgICBw\ndWJsaWMgVGVzdENhbGxiYWNrKFN5bmNocm9ub3VzUXVldWU8Qm9vbGVhbj4g\ncXVldWUpIHsKICAgICAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQg\nb3BlcmF0aW9uRmluaXNoZWQoT2JqZWN0IGN0eCwgVm9pZCByZXN1bHRPZk9w\nZXJhdGlvbikgewogICAgICAgICAgICBuZXcgVGhyZWFkKG5ldyBSdW5uYWJs\nZSgpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICAg\nICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgIGlm\nIChsb2dnZXIuaXNEZWJ1Z0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgbG9nZ2VyLmRlYnVnKCJPcGVyYXRpb24gZmluaXNoZWQhIik7CiAg\nICAgICAgICAgICAgICAgICAgQ29uY3VycmVuY3lVdGlscy5wdXQocXVldWUs\nIHRydWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5zdGFy\ndCgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIHZvaWQgb3BlcmF0aW9uRmFpbGVkKE9iamVjdCBjdHgsIGZpbmFsIFB1\nYlN1YkV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgbmV3IFRo\ncmVhZChuZXcgUnVubmFibGUoKSB7CiAgICAgICAgICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAg\nICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoIk9wZXJhdGlvbiBmYWlsZWQh\nIiwgZXhjZXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICBDb25jdXJyZW5j\neVV0aWxzLnB1dChxdWV1ZSwgZmFsc2UpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9KS5zdGFydCgpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nLyBUZXN0IGltcGxlbWVudGF0aW9uIG9mIHN1YnNjcmliZXIncyBtZXNzYWdl\nIGhhbmRsZXIuCiAgICBjbGFzcyBUZXN0TWVzc2FnZUhhbmRsZXIgaW1wbGVt\nZW50cyBNZXNzYWdlSGFuZGxlciB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBT\neW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+IGNvbnN1bWVRdWV1ZTsKICAgICAg\nICBib29sZWFuIGRvQWRkID0gZmFsc2U7CgogICAgICAgIHB1YmxpYyBUZXN0\nTWVzc2FnZUhhbmRsZXIoU3luY2hyb25vdXNRdWV1ZTxCb29sZWFuPiBjb25z\ndW1lUXVldWUpIHsKICAgICAgICAgICAgdGhpcy5jb25zdW1lUXVldWUgPSBj\nb25zdW1lUXVldWU7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBk\nZWxpdmVyKEJ5dGVTdHJpbmcgdCwgQnl0ZVN0cmluZyBzdWIsIGZpbmFsIE1l\nc3NhZ2UgbXNnLCBDYWxsYmFjazxWb2lkPiBjYWxsYmFjaywKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIE9iamVjdCBjb250ZXh0KSB7CiAgICAgICAg\nICAgIGlmICghZG9BZGQpIHsKICAgICAgICAgICAgICAgIC8vIGFmdGVyIHJl\nY2VpdmluZyBmaXJzdCBtZXNzYWdlLCB3ZSBzZW5kIGEgcHVibGlzaAogICAg\nICAgICAgICAgICAgLy8gdG8gb2J0YWluIHBlcm1pdCBvZiBzZWNvbmQgbGVk\nZ2VyCiAgICAgICAgICAgICAgICBkb0FkZCA9IHRydWU7CiAgICAgICAgICAg\nICAgICBuZXcgVGhyZWFkKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\ndm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHB1Ymxp\nc2ggbWVzc2FnZXMgYWdhaW4gdG8gb2J0YWluIHBlcm1pdHMKICAgICAgICAg\nICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlN0YXJ0IHB1Ymxpc2hpbmcg\nbWVzc2FnZSB0byBvYnRhaW4gcGVybWl0Iik7CiAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIGl0IG9idGFpbnMgdGhlIHBlcm1pdCBhbmQgd2FpdCBmb3Ig\nYSByZXNwb25zZSwKICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnV0IHRo\nZSByZXNwb25zZSBpcyBkZWxheWVkIGFuZCByZWFkRW50cmllcyBpcyBjYWxs\nZWQKICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gdGhlIHJlYWRDb21w\nbGV0ZSBjYWxsYmFjayB0byByZWFkIGVudHJpZXMgb2YgdGhlCiAgICAgICAg\nICAgICAgICAgICAgICAgIC8vIHNhbWUgbGVkZ2VyLiBzaW5jZSB0aGVyZSBp\ncyBubyBwZXJtaXQsIGl0IGJsb2NrcwogICAgICAgICAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnREb3du\nTGF0Y2ggbGF0Y2ggPSBuZXcgQ291bnREb3duTGF0Y2goMSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBzbGVlcEJvb2tpZSg4LCBsYXRjaCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRjaC5hd2FpdCgpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgU3luY2hyb25vdXNRdWV1ZTxCb29s\nZWFuPiBxdWV1ZSA9IG5ldyBTeW5jaHJvbm91c1F1ZXVlPEJvb2xlYW4+KCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8\nMzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVi\nbGlzaGVyLmFzeW5jUHVibGlzaCh0b3BpYywgZ2V0TXNnKDk5OTkpLCBuZXcg\nVGVzdENhbGxiYWNrKHF1ZXVlKSwgbnVsbCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Ig\nKGludCBpPTA7IGk8MzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShxdWV1ZS50YWtlKCkpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgbG9nZ2VyLmVycm9yKCJGYWlsZWQgdG8gcHVibGlzaCBtZXNzYWdl\nIHRvIG9idGFpbiBwZXJtaXQuIik7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5z\ndGFydCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXcgVGhyZWFk\nKG5ldyBSdW5uYWJsZSgpIHsKICAgICAgICAgICAgICAgIEBPdmVycmlkZQog\nICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAg\nICAgICAgICAgIENvbmN1cnJlbmN5VXRpbHMucHV0KGNvbnN1bWVRdWV1ZSwg\ndHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnN0YXJ0\nKCk7CiAgICAgICAgICAgIGNhbGxiYWNrLm9wZXJhdGlvbkZpbmlzaGVkKGNv\nbnRleHQsIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBIZWxwZXIg\nZnVuY3Rpb24gdG8gZ2VuZXJhdGUgTWVzc2FnZXMKICAgIHByb3RlY3RlZCBN\nZXNzYWdlIGdldE1zZyhpbnQgbXNnTnVtKSB7CiAgICAgICAgcmV0dXJuIE1l\nc3NhZ2UubmV3QnVpbGRlcigpLnNldEJvZHkoQnl0ZVN0cmluZy5jb3B5RnJv\nbVV0ZjgoIk1lc3NhZ2UiICsgbXNnTnVtKSkuYnVpbGQoKTsKICAgIH0KCiAg\nICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgVG9waWNzCiAgICBw\ncm90ZWN0ZWQgQnl0ZVN0cmluZyBnZXRUb3BpYyhpbnQgdG9waWNOdW0pIHsK\nICAgICAgICByZXR1cm4gQnl0ZVN0cmluZy5jb3B5RnJvbVV0ZjgoIkRlYWRM\nb2NrVG9waWMiICsgdG9waWNOdW0pOwogICAgfQoKICAgIGNsYXNzIFRlc3RT\nZXJ2ZXJDb25maWd1cmF0aW9uIGV4dGVuZHMgSHViU2VydmVyQ29uZmlndXJh\ndGlvbiB7CiAgICAgICAgcHVibGljIFRlc3RTZXJ2ZXJDb25maWd1cmF0aW9u\nKGludCBzZXJ2ZXJQb3J0LCBpbnQgc3NsU2VydmVyUG9ydCkgewogICAgICAg\nICAgICBzdXBlcihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0KTsKICAgICAg\nICB9CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBnZXRC\na0Vuc2VtYmxlU2l6ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAg\nICAgfQogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBpbnQgZ2V0\nQmtRdW9ydW1TaXplKCkgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAg\nICB9CiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIGludCBnZXRS\nZWFkQWhlYWRDb3VudCgpIHsKICAgICAgICAgICAgcmV0dXJuIDQ7CiAgICAg\nICAgfQogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBsb25nIGdl\ndE1heGltdW1DYWNoZVNpemUoKSB7CiAgICAgICAgICAgIHJldHVybiAzMjsK\nICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nU2VydmVyQ29uZmlndXJhdGlvbiBnZXRTZXJ2ZXJDb25maWd1cmF0aW9uKGlu\ndCBzZXJ2ZXJQb3J0LCBpbnQgc3NsU2VydmVyUG9ydCkgewogICAgICAgIFNl\ncnZlckNvbmZpZ3VyYXRpb24gc2VydmVyQ29uZiA9IG5ldyBUZXN0U2VydmVy\nQ29uZmlndXJhdGlvbihzZXJ2ZXJQb3J0LCBzc2xTZXJ2ZXJQb3J0KTsKCiAg\nICAgICAgb3JnLmFwYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmln\ndXJhdGlvbiBia0NsaWVudENvbmYgPQogICAgICAgICAgICBuZXcgb3JnLmFw\nYWNoZS5ib29ra2VlcGVyLmNvbmYuQ2xpZW50Q29uZmlndXJhdGlvbigpOwog\nICAgICAgIGJrQ2xpZW50Q29uZi5zZXROdW1Xb3JrZXJUaHJlYWRzKDEpLnNl\ndFJlYWRUaW1lb3V0KDk5OTkpCiAgICAgICAgICAgICAgICAgICAgLnNldFRo\ncm90dGxlVmFsdWUoMyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2Vy\ndmVyQ29uZi5hZGRDb25mKGJrQ2xpZW50Q29uZik7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNl\ncnZlckNvbmY7CiAgICB9CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRl\nc3REZWFkbG9jaygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBu\ndW1NZXNzYWdlcyA9IDU7CgogICAgICAgIFN5bmNocm9ub3VzUXVldWU8Qm9v\nbGVhbj4gY29uc3VtZVF1ZXVlID0gbmV3IFN5bmNocm9ub3VzUXVldWU8Qm9v\nbGVhbj4oKTsKCiAgICAgICAgLy8gc3Vic2NyaWJlIHRvIHRvcGljCiAgICAg\nICAgbG9nZ2VyLmluZm8oIlNldHVwIHN1YnNjcmlwdGlvbnMiKTsKICAgICAg\nICBzdWJzY3JpYmVyLnN1YnNjcmliZSh0b3BpYywgc3Vic2NyaWJlcklkLCBD\ncmVhdGVPckF0dGFjaC5DUkVBVEVfT1JfQVRUQUNIKTsKICAgICAgICBzdWJz\nY3JpYmVyLmNsb3NlU3Vic2NyaXB0aW9uKHRvcGljLCBzdWJzY3JpYmVySWQp\nOwoKICAgICAgICAvLyBwdWJsaXNoIDUgbWVzc2FnZXMgdG8gZm9ybSBmaXJz\ndCBsZWRnZXIKICAgICAgICBmb3IgKGludCBpPTA7IGk8bnVtTWVzc2FnZXM7\nIGkrKykgewogICAgICAgICAgICBsb2dnZXIuaW5mbygiU3RhcnQgcHVibGlz\naGluZyBtZXNzYWdlIHt9IiwgaSk7CiAgICAgICAgICAgIHB1Ymxpc2hlci5w\ndWJsaXNoKHRvcGljLCBnZXRNc2coaSkpOwogICAgICAgIH0KCiAgICAgICAg\nc3RvcEh1YlNlcnZlcnMoKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMTAwMCk7\nCiAgICAgICAgc3RhcnRIdWJTZXJ2ZXJzKCk7CgogICAgICAgIGxvZ2dlci5p\nbmZvKCJTdGFydCBwdWJsaXNoaW5nIG1lc3NhZ2VzIik7CiAgICAgICAgLy8g\ncHVibGlzaCBlbm91Z2ggbWVzc2FnZXMgdG8gc2Vjb25kIGxlZGdlcgogICAg\nICAgIC8vIHNvIGEgc2NhbiByZXF1ZXN0IG5lZWQgdG8gc2NhbiBvdmVyIHR3\nbyBsZWRnZXJzLCB3aGljaAogICAgICAgIC8vIGNhdXNlIHJlYWRFbnRyaWVz\nIGV4ZWN1dGVkIGluIHRoZSBwcmV2aW91cyByZWFkRW50cmllcwogICAgICAg\nIGZvciAoaW50IGk9MDsgaTxudW1NZXNzYWdlczsgaSsrKSB7CiAgICAgICAg\nICAgIGxvZ2dlci5pbmZvKCJTdGFydCBwdWJsaXNoaW5nIG1lc3NhZ2Uge30i\nLCBpKzUpOwogICAgICAgICAgICBwdWJsaXNoZXIucHVibGlzaCh0b3BpYywg\nZ2V0TXNnKGkpKTsKICAgICAgICB9CgogICAgICAgIGxvZ2dlci5pbmZvKCJT\ndGFydCBzdWJzY3JpYmUgdG9waWNzIGFnYWluIGFuZCByZWNlaXZlIG1lc3Nh\nZ2VzIik7CiAgICAgICAgLy8gc3Vic2NyaWJlIHRvIHRvcGljCiAgICAgICAg\nc3Vic2NyaWJlci5zdWJzY3JpYmUodG9waWMsIHN1YnNjcmliZXJJZCwgQ3Jl\nYXRlT3JBdHRhY2guQ1JFQVRFX09SX0FUVEFDSCk7CiAgICAgICAgc3Vic2Ny\naWJlci5zdGFydERlbGl2ZXJ5KHRvcGljLCBzdWJzY3JpYmVySWQsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBUZXN0TWVzc2FnZUhh\nbmRsZXIoY29uc3VtZVF1ZXVlKSk7CiAgICAgICAgZm9yIChpbnQgaT0wOyBp\nPCgyKm51bU1lc3NhZ2VzKzMpOyBpKyspIHsKICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZShjb25zdW1lUXVldWUudGFrZSgpKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHJvdGVjdGVkIHZvaWQgc2xlZXBCb29raWUoZmluYWwgaW50IHNlY29u\nZHMsIGZpbmFsIENvdW50RG93bkxhdGNoIGwpCiAgICB0aHJvd3MgSW50ZXJy\ndXB0ZWRFeGNlcHRpb24sIElPRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBT\ndHJpbmcgcHJlZml4ID0gIkJvb2tpZS0iOwogICAgICAgIFRocmVhZFtdIGFs\nbFRocmVhZHMgPSBuZXcgVGhyZWFkW1RocmVhZC5hY3RpdmVDb3VudCgpXTsK\nICAgICAgICBUaHJlYWQuZW51bWVyYXRlKGFsbFRocmVhZHMpOwogICAgICAg\nIGZvciAoZmluYWwgVGhyZWFkIHQgOiBhbGxUaHJlYWRzKSB7CiAgICAgICAg\nICAgIGlmICh0LmdldE5hbWUoKS5zdGFydHNXaXRoKHByZWZpeCkpIHsKICAg\nICAgICAgICAgICAgIFRocmVhZCBzbGVlcGVyID0gbmV3IFRocmVhZCgpIHsK\nICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB0LnN1c3BlbmQoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGwuY291bnREb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBUaHJlYWQuc2xlZXAoc2Vjb25kcyAqIDEwMDApOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgdC5yZXN1bWUoKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiRXJyb3Igc3VzcGVuZGluZyB0\naHJlYWQiLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAg\nICAgICBzbGVlcGVyLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IElP\nRXhjZXB0aW9uKCJCb29raWUgdGhyZWFkIG5vdCBmb3VuZCIpOwogICAgfQp9\nCg==\n","encoding":"base64"}

