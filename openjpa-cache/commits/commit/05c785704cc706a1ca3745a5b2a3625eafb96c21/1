{"sha":"05c785704cc706a1ca3745a5b2a3625eafb96c21","node_id":"MDY6Q29tbWl0MjA2MzY0OjA1Yzc4NTcwNGNjNzA2YTFjYTM3NDVhNWIyYTM2MjVlYWZiOTZjMjE=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2009-11-16T16:29:18Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2009-11-16T16:29:18Z"},"message":"OPENJPA-1387: Remove non-nullable constraint from Unique column.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@880834 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"88021512c3f1d54894e368e66e76c3349baf0eb4","url":"https://api.github.com/repos/apache/openjpa/git/trees/88021512c3f1d54894e368e66e76c3349baf0eb4"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/05c785704cc706a1ca3745a5b2a3625eafb96c21","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/05c785704cc706a1ca3745a5b2a3625eafb96c21","html_url":"https://github.com/apache/openjpa/commit/05c785704cc706a1ca3745a5b2a3625eafb96c21","comments_url":"https://api.github.com/repos/apache/openjpa/commits/05c785704cc706a1ca3745a5b2a3625eafb96c21/comments","author":null,"committer":null,"parents":[{"sha":"93ae72d15f2b767c41ffc4458d95d4c64e3cc74d","url":"https://api.github.com/repos/apache/openjpa/commits/93ae72d15f2b767c41ffc4458d95d4c64e3cc74d","html_url":"https://github.com/apache/openjpa/commit/93ae72d15f2b767c41ffc4458d95d4c64e3cc74d"}],"stats":{"total":16,"additions":15,"deletions":1},"files":[{"sha":"3d9b72232f0b770db89dd0a7874ab747a0477604","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java","status":"modified","additions":12,"deletions":1,"changes":13,"blob_url":"https://github.com/apache/openjpa/blob/05c785704cc706a1ca3745a5b2a3625eafb96c21/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java","raw_url":"https://github.com/apache/openjpa/raw/05c785704cc706a1ca3745a5b2a3625eafb96c21/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java?ref=05c785704cc706a1ca3745a5b2a3625eafb96c21","patch":"@@ -46,6 +46,7 @@\n import org.apache.openjpa.jdbc.schema.SchemaSerializer;\n import org.apache.openjpa.jdbc.schema.SchemaTool;\n import org.apache.openjpa.jdbc.schema.Table;\n+import org.apache.openjpa.jdbc.schema.Unique;\n import org.apache.openjpa.jdbc.schema.XMLSchemaSerializer;\n import org.apache.openjpa.jdbc.sql.DBDictionary;\n import org.apache.openjpa.kernel.Seq;\n@@ -753,6 +754,7 @@ private void buildSchema(Class cls) {\n         Schema[] schemas = _schema.getSchemas();\n         Table[] tables;\n         Column[] cols;\n+        Unique[] unqs;\n         for (int i = 0; i < schemas.length; i++) {\n             tables = schemas[i].getTables();\n             for (int j = 0; j < tables.length; j++) {\n@@ -761,8 +763,17 @@ private void buildSchema(Class cls) {\n \n                 tables[j].getPrimaryKey().setLogical(false);\n                 cols = tables[j].getPrimaryKey().getColumns();\n-                for (int k = 0; k < cols.length; k++)\n+                for (int k = 0; k < cols.length; k++) {\n                     cols[k].setNotNull(true);\n+                }\n+                unqs = tables[j].getUniques();\n+                if (!_dict.supportsNullUniqueConlumn) {\n+                    for (Unique u : unqs) {\n+                        for (Column c : u.getColumns()) {\n+                            c.setNotNull(true);\n+                        }\n+                    }\n+                }\n             }\n         }\n     }"},{"sha":"bc43e4a2bdb02fcf0f4b1a474c6a9b2b63ff7bc8","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/AbstractDB2Dictionary.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/05c785704cc706a1ca3745a5b2a3625eafb96c21/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/AbstractDB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/05c785704cc706a1ca3745a5b2a3625eafb96c21/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/AbstractDB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/AbstractDB2Dictionary.java?ref=05c785704cc706a1ca3745a5b2a3625eafb96c21","patch":"@@ -69,6 +69,8 @@ public AbstractDB2Dictionary() {\n         // the equivalent \"X JOIN Y ON 1 = 1\"\n         crossJoinClause = \"JOIN\";\n         requiresConditionForCrossJoin = true;\n+        \n+        supportsNullUniqueConlumn = false;\n     }\n \n     public void indexOf(SQLBuffer buf, FilterValue str, FilterValue find,"},{"sha":"2e1aa1deb369fac70dcae5d08e8e9bdf762d0fc3","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/05c785704cc706a1ca3745a5b2a3625eafb96c21/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/05c785704cc706a1ca3745a5b2a3625eafb96c21/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java?ref=05c785704cc706a1ca3745a5b2a3625eafb96c21","patch":"@@ -187,6 +187,7 @@\n     public boolean supportsRestrictDeleteAction = true;\n     public boolean supportsCascadeDeleteAction = true;\n     public boolean supportsNullDeleteAction = true;\n+    public boolean supportsNullUniqueConlumn = true;\n     public boolean supportsDefaultDeleteAction = true;\n     public boolean supportsRestrictUpdateAction = true;\n     public boolean supportsCascadeUpdateAction = true;"}]}

