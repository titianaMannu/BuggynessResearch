{"sha":"0b80f23e703e09f6d219ca2e1ce5e1051073f9ed","node_id":"MDY6Q29tbWl0MjA2MzY0OjBiODBmMjNlNzAzZTA5ZjZkMjE5Y2EyZTFjZTVlMTA1MTA3M2Y5ZWQ=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-07-14T23:09:41Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-07-14T23:09:41Z"},"message":"OPENJPA-1726: fix test case failures (TestInputStreamLob) for PostgreSQL\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@964257 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c3a417d83a48849fb257e551b5076924647e9ed6","url":"https://api.github.com/repos/apache/openjpa/git/trees/c3a417d83a48849fb257e551b5076924647e9ed6"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/0b80f23e703e09f6d219ca2e1ce5e1051073f9ed","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/0b80f23e703e09f6d219ca2e1ce5e1051073f9ed","html_url":"https://github.com/apache/openjpa/commit/0b80f23e703e09f6d219ca2e1ce5e1051073f9ed","comments_url":"https://api.github.com/repos/apache/openjpa/commits/0b80f23e703e09f6d219ca2e1ce5e1051073f9ed/comments","author":null,"committer":null,"parents":[{"sha":"d899ba81075c96cd6a46b724e49e3bcc72697b25","url":"https://api.github.com/repos/apache/openjpa/commits/d899ba81075c96cd6a46b724e49e3bcc72697b25","html_url":"https://github.com/apache/openjpa/commit/d899ba81075c96cd6a46b724e49e3bcc72697b25"}],"stats":{"total":14,"additions":14,"deletions":0},"files":[{"sha":"ece1f727b1a32ef78bb7be48edfb70a646c9f104","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/PostgresDictionary.java","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/apache/openjpa/blob/0b80f23e703e09f6d219ca2e1ce5e1051073f9ed/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/PostgresDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/0b80f23e703e09f6d219ca2e1ce5e1051073f9ed/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/PostgresDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/PostgresDictionary.java?ref=0b80f23e703e09f6d219ca2e1ce5e1051073f9ed","patch":"@@ -22,6 +22,7 @@\n import java.io.InputStream;\n import java.io.OutputStream;\n import java.lang.reflect.Constructor;\n+import java.lang.reflect.Field;\n import java.lang.reflect.InvocationTargetException;\n import java.lang.reflect.Method;\n import java.security.AccessController;\n@@ -906,6 +907,19 @@ protected Connection getDbcpDelegate(Connection conn) {\n                 Class<?> dbcpConnectionClass =\n                     Class.forName(\"org.apache.commons.dbcp.DelegatingConnection\", true, AccessController\n                         .doPrivileged(J2DoPrivHelper.getContextClassLoaderAction()));\n+                Class<?> poolingDataSource = Class.forName(\n+                        \"org.apache.commons.dbcp.PoolingDataSource\", true,\n+                        AccessController.doPrivileged(J2DoPrivHelper\n+                                .getContextClassLoaderAction()));\n+                Method setAccessToUnderlyingConnectionAllowed = poolingDataSource\n+                        .getMethod(\"setAccessToUnderlyingConnectionAllowed\",\n+                                boolean.class);\n+                \n+                Field this$0 = conn.getClass().getDeclaredField(\"this$0\");\n+                this$0.setAccessible(true);\n+                Object poolingDataSourceObj = this$0.get(conn);\n+                setAccessToUnderlyingConnectionAllowed.invoke(poolingDataSourceObj,\n+                        true);\n                 \n                 dbcpGetDelegate = dbcpConnectionClass.getMethod(\"getInnermostDelegate\");\n             }"}]}

