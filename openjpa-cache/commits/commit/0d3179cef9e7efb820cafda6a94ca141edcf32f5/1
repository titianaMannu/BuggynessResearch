{"sha":"0d3179cef9e7efb820cafda6a94ca141edcf32f5","node_id":"MDY6Q29tbWl0MjA2MzY0OjBkMzE3OWNlZjllN2VmYjgyMGNhZmRhNmE5NGNhMTQxZWRjZjMyZjU=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2009-09-10T17:16:31Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2009-09-10T17:16:31Z"},"message":"updated getLog() methods and switched testcase to use setUnsupportedDatabases()\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@813519 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"690c459bed8ec66ca178d86e987d0f4b5d2a39db","url":"https://api.github.com/repos/apache/openjpa/git/trees/690c459bed8ec66ca178d86e987d0f4b5d2a39db"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/0d3179cef9e7efb820cafda6a94ca141edcf32f5","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/0d3179cef9e7efb820cafda6a94ca141edcf32f5","html_url":"https://github.com/apache/openjpa/commit/0d3179cef9e7efb820cafda6a94ca141edcf32f5","comments_url":"https://api.github.com/repos/apache/openjpa/commits/0d3179cef9e7efb820cafda6a94ca141edcf32f5/comments","author":null,"committer":null,"parents":[{"sha":"8e9696522573e9892b4b8aa56d6c311f639847ee","url":"https://api.github.com/repos/apache/openjpa/commits/8e9696522573e9892b4b8aa56d6c311f639847ee","html_url":"https://github.com/apache/openjpa/commit/8e9696522573e9892b4b8aa56d6c311f639847ee"}],"stats":{"total":37,"additions":19,"deletions":18},"files":[{"sha":"4225fbe44446a63951f6ad52e7b4ab3d623db24f","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java","status":"modified","additions":5,"deletions":17,"changes":22,"blob_url":"https://github.com/apache/openjpa/blob/0d3179cef9e7efb820cafda6a94ca141edcf32f5/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java","raw_url":"https://github.com/apache/openjpa/raw/0d3179cef9e7efb820cafda6a94ca141edcf32f5/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java?ref=0d3179cef9e7efb820cafda6a94ca141edcf32f5","patch":"@@ -43,24 +43,12 @@\n     public void setUp() {\n         // Need to skip tests on MySQL, Oracle and MS SQL Server\n         // See createSchemas() comment at the bottom\n-        if (dict == null) {\n-            OpenJPAEntityManagerFactorySPI emf = createEMF();\n-            OpenJPAEntityManagerSPI em = emf.createEntityManager();\n-            JDBCConfiguration conf = (JDBCConfiguration) em.getConfiguration();\n-            dict = conf.getDBDictionaryInstance();\n-            \n-            if ((dict instanceof MySQLDictionary) ||\n-                    (dict instanceof OracleDictionary) ||\n-                    (dict instanceof SQLServerDictionary)) {\n-                setTestsDisabled(true);\n-                // do some logging\n-                emf.getConfiguration().getLog(\"Tests\").trace(\n-                    \"TestMultipleSchemaNames() - Skipping all tests - Not supported on this DB\");\n-            }\n-            closeEMF(emf);\n-        }\n-        \n+        setUnsupportedDatabases(\n+                org.apache.openjpa.jdbc.sql.MySQLDictionary.class,\n+                org.apache.openjpa.jdbc.sql.OracleDictionary.class,\n+                org.apache.openjpa.jdbc.sql.SQLServerDictionary.class);\n         if (isTestsDisabled()) {\n+            getLog().trace(\"TestMultipleSchemaNames() - Skipping all tests - Not supported on this DB\");\n             return;\n         }\n "},{"sha":"f7eb658f3bde4b59b74fcf17c840ee12224921ee","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/test/SingleEMFTestCase.java","status":"modified","additions":14,"deletions":1,"changes":15,"blob_url":"https://github.com/apache/openjpa/blob/0d3179cef9e7efb820cafda6a94ca141edcf32f5/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/test/SingleEMFTestCase.java","raw_url":"https://github.com/apache/openjpa/raw/0d3179cef9e7efb820cafda6a94ca141edcf32f5/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/test/SingleEMFTestCase.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/test/SingleEMFTestCase.java?ref=0d3179cef9e7efb820cafda6a94ca141edcf32f5","patch":"@@ -206,6 +206,19 @@ protected void setSupportedDatabases(Class<?> ... dbs) {\n     }\n     \n     protected Log getLog() {\n-        return emf.getConfiguration().getLog(\"Tests\");\n+        return getLog(\"Tests\");\n+    }\n+\n+    protected Log getLog(String s) {\n+        OpenJPAEntityManagerFactorySPI tempEMF = emf;\n+        if (tempEMF == null) {\n+            tempEMF = createEMF();\n+        }\n+        Log log = emf.getConfiguration().getLog(s);\n+        if (emf == null) {\n+            closeEMF(tempEMF);\n+        }\n+        return log;\n     }\n }\n+"}]}

