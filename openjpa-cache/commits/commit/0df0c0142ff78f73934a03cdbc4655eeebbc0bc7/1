{"sha":"0df0c0142ff78f73934a03cdbc4655eeebbc0bc7","node_id":"MDY6Q29tbWl0MjA2MzY0OjBkZjBjMDE0MmZmNzhmNzM5MzRhMDNjZGJjNDY1NWVlZWJiYzBiYzc=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-03-31T14:33:02Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-03-31T14:33:02Z"},"message":"OPENJPA-1597 merge in code comment updates from 2.0.x branch\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@929550 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"8038107a3866cdeca1f2b28067bf89f862fb3122","url":"https://api.github.com/repos/apache/openjpa/git/trees/8038107a3866cdeca1f2b28067bf89f862fb3122"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/0df0c0142ff78f73934a03cdbc4655eeebbc0bc7","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/0df0c0142ff78f73934a03cdbc4655eeebbc0bc7","html_url":"https://github.com/apache/openjpa/commit/0df0c0142ff78f73934a03cdbc4655eeebbc0bc7","comments_url":"https://api.github.com/repos/apache/openjpa/commits/0df0c0142ff78f73934a03cdbc4655eeebbc0bc7/comments","author":null,"committer":null,"parents":[{"sha":"8579593f885360d74cf4d7d9cdbf7f5af3ebbbc3","url":"https://api.github.com/repos/apache/openjpa/commits/8579593f885360d74cf4d7d9cdbf7f5af3ebbbc3","html_url":"https://github.com/apache/openjpa/commit/8579593f885360d74cf4d7d9cdbf7f5af3ebbbc3"}],"stats":{"total":17,"additions":8,"deletions":9},"files":[{"sha":"ae273779f834746ddaa2ac192d67cc981a4f32ca","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/util/Proxies.java","status":"modified","additions":8,"deletions":9,"changes":17,"blob_url":"https://github.com/apache/openjpa/blob/0df0c0142ff78f73934a03cdbc4655eeebbc0bc7/openjpa-kernel/src/main/java/org/apache/openjpa/util/Proxies.java","raw_url":"https://github.com/apache/openjpa/raw/0df0c0142ff78f73934a03cdbc4655eeebbc0bc7/openjpa-kernel/src/main/java/org/apache/openjpa/util/Proxies.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/util/Proxies.java?ref=0df0c0142ff78f73934a03cdbc4655eeebbc0bc7","patch":"@@ -87,15 +87,6 @@ public static Object writeReplace(Proxy proxy, boolean detachable) {\n          *   1) No Proxy, then return as-is\n          *   2) Runtime created proxy (!detachable), then unproxy\n          *   3) No StateManager (DetachedStateField==false), then return as-is\n-         *   4) If detached, then unproxy\n-         *   5) If ClassMetaData exists and DetachedStateField != TRUE\n-         *      (default of DetachedStateField==transient), then unproxy\n-         *   6) Else, return as-is\n-         * \n-         * Original code -\n-         *   1) Runtime created proxy (!detachable), then unproxy\n-         *   2) No Proxy, then return as-is\n-         *   3) No StateManager (DetachedStateField==false), then return as-is\n          *   Get the new IgnoreDetachedStateFieldForProxySerialization\n          *      Compatibility flag from either the metadata/configuration if\n          *      this is a normal StateManager, otherwise use the new flag\n@@ -109,6 +100,14 @@ public static Object writeReplace(Proxy proxy, boolean detachable) {\n          *      5a) If detached, then do not unproxy and return as-is\n          *      5b) Else, unproxy\n          * \n+         * Original code -\n+         *   1) Runtime created proxy (!detachable), then unproxy\n+         *   2) No Proxy, then return as-is\n+         *   3) No StateManager (DetachedStateField==false), then return as-is\n+         *   4) If detached, then return as-is <--- ERROR as EM.clear() marks\n+         *      entity as detached but doesn't remove any $proxy usage\n+         *   5) Else, unproxy\n+         * \n          *  if (detachable && (proxy == null || proxy.getOwner() == null \n          *      || proxy.getOwner().isDetached()))\n          *      return proxy;"}]}

