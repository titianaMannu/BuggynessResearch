{"sha":"0f79c0583766fbe00cce5a97ac1133174b3689ab","node_id":"MDY6Q29tbWl0MjA2MzY0OjBmNzljMDU4Mzc2NmZiZTAwY2NlNWE5N2FjMTEzMzE3NGIzNjg5YWI=","commit":{"author":{"name":"Michael Dick","email":"mikedd@apache.org","date":"2008-09-16T19:34:41Z"},"committer":{"name":"Michael Dick","email":"mikedd@apache.org","date":"2008-09-16T19:34:41Z"},"message":"OPENJPA-695 adding nightly upload profile to branches\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/1.2.x@696020 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"f231f2b5e5791dedcba02072c43fe6aafdfdbb1e","url":"https://api.github.com/repos/apache/openjpa/git/trees/f231f2b5e5791dedcba02072c43fe6aafdfdbb1e"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/0f79c0583766fbe00cce5a97ac1133174b3689ab","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/0f79c0583766fbe00cce5a97ac1133174b3689ab","html_url":"https://github.com/apache/openjpa/commit/0f79c0583766fbe00cce5a97ac1133174b3689ab","comments_url":"https://api.github.com/repos/apache/openjpa/commits/0f79c0583766fbe00cce5a97ac1133174b3689ab/comments","author":{"login":"mikedd","id":669432,"node_id":"MDQ6VXNlcjY2OTQzMg==","avatar_url":"https://avatars.githubusercontent.com/u/669432?v=4","gravatar_id":"","url":"https://api.github.com/users/mikedd","html_url":"https://github.com/mikedd","followers_url":"https://api.github.com/users/mikedd/followers","following_url":"https://api.github.com/users/mikedd/following{/other_user}","gists_url":"https://api.github.com/users/mikedd/gists{/gist_id}","starred_url":"https://api.github.com/users/mikedd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikedd/subscriptions","organizations_url":"https://api.github.com/users/mikedd/orgs","repos_url":"https://api.github.com/users/mikedd/repos","events_url":"https://api.github.com/users/mikedd/events{/privacy}","received_events_url":"https://api.github.com/users/mikedd/received_events","type":"User","site_admin":false},"committer":{"login":"mikedd","id":669432,"node_id":"MDQ6VXNlcjY2OTQzMg==","avatar_url":"https://avatars.githubusercontent.com/u/669432?v=4","gravatar_id":"","url":"https://api.github.com/users/mikedd","html_url":"https://github.com/mikedd","followers_url":"https://api.github.com/users/mikedd/followers","following_url":"https://api.github.com/users/mikedd/following{/other_user}","gists_url":"https://api.github.com/users/mikedd/gists{/gist_id}","starred_url":"https://api.github.com/users/mikedd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikedd/subscriptions","organizations_url":"https://api.github.com/users/mikedd/orgs","repos_url":"https://api.github.com/users/mikedd/repos","events_url":"https://api.github.com/users/mikedd/events{/privacy}","received_events_url":"https://api.github.com/users/mikedd/received_events","type":"User","site_admin":false},"parents":[{"sha":"4e37730ac6335097f1af40c2095f7dba6a639efd","url":"https://api.github.com/repos/apache/openjpa/commits/4e37730ac6335097f1af40c2095f7dba6a639efd","html_url":"https://github.com/apache/openjpa/commit/4e37730ac6335097f1af40c2095f7dba6a639efd"}],"stats":{"total":74,"additions":74,"deletions":0},"files":[{"sha":"a04e6f1097df655f0294edd2acbba0c4b0c4c5a5","filename":"openjpa-project/pom.xml","status":"modified","additions":74,"deletions":0,"changes":74,"blob_url":"https://github.com/apache/openjpa/blob/0f79c0583766fbe00cce5a97ac1133174b3689ab/openjpa-project/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/0f79c0583766fbe00cce5a97ac1133174b3689ab/openjpa-project/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/pom.xml?ref=0f79c0583766fbe00cce5a97ac1133174b3689ab","patch":"@@ -79,6 +79,10 @@\n         <docbook.target>${project.basedir}/target/manual</docbook.target>\n         <docbook.version>1.67.2</docbook.version>\n         <local.repository>${settings.localRepository}</local.repository>\n+        \n+        <!-- authentication for nightly uploads -->\n+        <nightly.user.name>${user.name}</nightly.user.name>\n+        <nightly.password>passw0rd</nightly.password>\n         </properties>\n \n         <build>\n@@ -303,6 +307,76 @@\n                 </pluginRepository>\n             </pluginRepositories>\n         </profile>\n+        <!-- \n+          Upload distribution files, javadoc and manual to openjpa.apache.org/builds/latest. \n+          This profile is designed to be run nightly by a continuous build server, but can\n+          also be run manually.\n+\n+          The nightly.user.name and nightly.password properties need to be set prior to using\n+          this profile, ie : \n+          $ mvn -Dnightly.user.name=mikedd -Dnightly.password=mikesPassword -Pnightly-upload package\n+          or (using a profile defined in $user.home/.m2/settings.xml )\n+          $ mvn -Pnightly-upload,mikes-nightly-credentials package\n+          -->\n+        <profile>\n+            <id>nightly-upload</id>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <artifactId>maven-antrun-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <phase>package</phase>\n+                                <configuration>\n+                                    <tasks>\n+                                        <mkdir dir=\"target/site/tempDocs\"/>\n+                                        <unzip dest=\"target/site/tempDocs\">\n+                                            <fileset dir=\"target/site/downloads\">\n+                                                <include name=\"*binary*.zip\"/>\n+                                            </fileset>\n+                                            <patternset>\n+                                                <include name=\"**/javadoc/**\"/>\n+                                                <include name=\"**/manual/**\"/>\n+                                            </patternset>\n+                                        </unzip>\n+                                        <move todir=\"target/site/tempDocs/docs\">\n+                                            <fileset dir=\"target/site/tempDocs/apache-openjpa-${pom.version}/docs\"/> \n+                                        </move>\n+                                        <scp todir=\"${nightly.user.name}:${nightly.password}@people.apache.org:/www/openjpa.apache.org/builds/latest-1.2.x/downloads\" \n+                                             trust=\"true\">\n+                                            <fileset dir=\"target/site/downloads\"/>\n+                                        </scp>\n+                                        \n+                                        <scp todir=\"${nightly.user.name}:${nightly.password}@people.apache.org:/www/openjpa.apache.org/builds/latest-1.2.x/docs\" \n+                                             trust=\"true\">\n+                                            <fileset dir=\"target/site/tempDocs/docs\"/> \n+                                        </scp>\n+                                        <sshexec host=\"people.apache.org\" \n+                                                 username=\"${nightly.user.name}\" \n+                                                 password=\"${nightly.password}\"\n+                                                 command=\"chmod -R g+w /www/openjpa.apache.org/builds/latest-1.2.x\"\n+                                                 trust=\"true\"/>\n+                                        <delete>\n+                                            <fileset dir=\"target/site/tempDocs\"/>\n+                                        </delete>\n+                                    </tasks>\n+                                </configuration>\n+                                <goals>\n+                                    <goal>run</goal>\n+                                </goals>\n+                            </execution>\n+                        </executions>\n+                        <dependencies>\n+                            <dependency>\n+                                <groupId>org.apache.ant</groupId>\n+                                <artifactId>ant-jsch</artifactId>\n+                                <version>1.7.0</version>\n+                            </dependency>\n+                        </dependencies>\n+                    </plugin>\n+                </plugins>\n+            </build>\n+        </profile>\n     </profiles>\n \n     <!-- need to explicitly list dependencies for assembly to work -->"}]}

