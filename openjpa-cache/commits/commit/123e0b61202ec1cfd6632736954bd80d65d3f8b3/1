{"sha":"123e0b61202ec1cfd6632736954bd80d65d3f8b3","node_id":"MDY6Q29tbWl0MjA2MzY0OjEyM2UwYjYxMjAyZWMxY2ZkNjYzMjczNjk1NGJkODBkNjVkM2Y4YjM=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-12-03T06:36:36Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-12-03T06:36:36Z"},"message":"OPENJPA-459: fix bulkUpdate for DB2\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@886685 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"13c954fa9c64b2091c62f925f4f44461ea371329","url":"https://api.github.com/repos/apache/openjpa/git/trees/13c954fa9c64b2091c62f925f4f44461ea371329"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/123e0b61202ec1cfd6632736954bd80d65d3f8b3","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/123e0b61202ec1cfd6632736954bd80d65d3f8b3","html_url":"https://github.com/apache/openjpa/commit/123e0b61202ec1cfd6632736954bd80d65d3f8b3","comments_url":"https://api.github.com/repos/apache/openjpa/commits/123e0b61202ec1cfd6632736954bd80d65d3f8b3/comments","author":null,"committer":null,"parents":[{"sha":"d488b471f5a6f750a9365388cd29aa2130fdbc40","url":"https://api.github.com/repos/apache/openjpa/commits/d488b471f5a6f750a9365388cd29aa2130fdbc40","html_url":"https://github.com/apache/openjpa/commit/d488b471f5a6f750a9365388cd29aa2130fdbc40"}],"stats":{"total":27,"additions":18,"deletions":9},"files":[{"sha":"bd3356deb67f7e65e376b3cebd0c68525153f8f9","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","status":"modified","additions":3,"deletions":9,"changes":12,"blob_url":"https://github.com/apache/openjpa/blob/123e0b61202ec1cfd6632736954bd80d65d3f8b3/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/123e0b61202ec1cfd6632736954bd80d65d3f8b3/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java?ref=123e0b61202ec1cfd6632736954bd80d65d3f8b3","patch":"@@ -1986,7 +1986,7 @@ protected SQLBuffer toBulkOperation(ClassMapping mapping, Select sel,\n         // (SELECT 1 FROM TABLE t0 WHERE t0.ID = TABLE.ID); also, some\n         // databases do not allow aliases in delete statements, which\n         // also causes us to use a subselect\n-        Set<String> selectedTables = getSelectTableAliases(sel);\n+        Collection<String> selectedTables = getSelectTableAliases(sel);\n         if (selectedTables.size() == 1 && supportsSubselect\n             && allowsAliasInBulkClause) {\n             SQLBuffer from;\n@@ -2070,14 +2070,8 @@ protected SQLBuffer toBulkOperation(ClassMapping mapping, Select sel,\n         return sql;\n     }\n     \n-    Set<String> getSelectTableAliases(Select sel) {\n-        Set<String> result = new HashSet<String>();\n-        List<String> selects = sel.getIdentifierAliases();\n-        for (String s : selects) {\n-            String tableAlias = s.substring(0, s.indexOf('.'));\n-            result.add(tableAlias);\n-        }\n-        return result;\n+    protected Collection<String> getSelectTableAliases(Select sel) {\n+        return sel.getTableAliases();\n     }\n \n     protected SQLBuffer getDeleteTargets(Select sel) {"},{"sha":"093bd0228e7dc1814dab4e26c9de18539e7577fb","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java","status":"modified","additions":15,"deletions":0,"changes":15,"blob_url":"https://github.com/apache/openjpa/blob/123e0b61202ec1cfd6632736954bd80d65d3f8b3/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/123e0b61202ec1cfd6632736954bd80d65d3f8b3/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java?ref=123e0b61202ec1cfd6632736954bd80d65d3f8b3","patch":"@@ -24,6 +24,10 @@\n import java.sql.SQLException;\n import java.sql.Types;\n import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n \n import org.apache.commons.lang.StringUtils;\n import org.apache.openjpa.jdbc.kernel.JDBCFetchConfiguration;\n@@ -383,4 +387,15 @@ public String getSelectOperation(JDBCFetchConfiguration fetch) {\n             select += \" \" + hint;\n         return select;\n     }\n+    \n+    @Override\n+    protected Collection<String> getSelectTableAliases(Select sel) {\n+        Set<String> result = new HashSet<String>();\n+        List<String> selects = sel.getIdentifierAliases();\n+        for (String s : selects) {\n+            String tableAlias = s.substring(0, s.indexOf('.'));\n+            result.add(tableAlias);\n+        }\n+        return result;\n+    }\n }"}]}

