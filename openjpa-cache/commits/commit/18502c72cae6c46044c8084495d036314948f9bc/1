{"sha":"18502c72cae6c46044c8084495d036314948f9bc","node_id":"MDY6Q29tbWl0MjA2MzY0OjE4NTAyYzcyY2FlNmM0NjA0NGM4MDg0NDk1ZDAzNjMxNDk0OGY5YmM=","commit":{"author":{"name":"Michael Dick","email":"mikedd@apache.org","date":"2007-10-24T21:18:28Z"},"committer":{"name":"Michael Dick","email":"mikedd@apache.org","date":"2007-10-24T21:18:28Z"},"message":"Port 570487 to 1.0.x\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/1.0.x@588032 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"f152a9d014fa2068088fdc48517bd93e38e0f959","url":"https://api.github.com/repos/apache/openjpa/git/trees/f152a9d014fa2068088fdc48517bd93e38e0f959"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/18502c72cae6c46044c8084495d036314948f9bc","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/18502c72cae6c46044c8084495d036314948f9bc","html_url":"https://github.com/apache/openjpa/commit/18502c72cae6c46044c8084495d036314948f9bc","comments_url":"https://api.github.com/repos/apache/openjpa/commits/18502c72cae6c46044c8084495d036314948f9bc/comments","author":{"login":"mikedd","id":669432,"node_id":"MDQ6VXNlcjY2OTQzMg==","avatar_url":"https://avatars.githubusercontent.com/u/669432?v=4","gravatar_id":"","url":"https://api.github.com/users/mikedd","html_url":"https://github.com/mikedd","followers_url":"https://api.github.com/users/mikedd/followers","following_url":"https://api.github.com/users/mikedd/following{/other_user}","gists_url":"https://api.github.com/users/mikedd/gists{/gist_id}","starred_url":"https://api.github.com/users/mikedd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikedd/subscriptions","organizations_url":"https://api.github.com/users/mikedd/orgs","repos_url":"https://api.github.com/users/mikedd/repos","events_url":"https://api.github.com/users/mikedd/events{/privacy}","received_events_url":"https://api.github.com/users/mikedd/received_events","type":"User","site_admin":false},"committer":{"login":"mikedd","id":669432,"node_id":"MDQ6VXNlcjY2OTQzMg==","avatar_url":"https://avatars.githubusercontent.com/u/669432?v=4","gravatar_id":"","url":"https://api.github.com/users/mikedd","html_url":"https://github.com/mikedd","followers_url":"https://api.github.com/users/mikedd/followers","following_url":"https://api.github.com/users/mikedd/following{/other_user}","gists_url":"https://api.github.com/users/mikedd/gists{/gist_id}","starred_url":"https://api.github.com/users/mikedd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikedd/subscriptions","organizations_url":"https://api.github.com/users/mikedd/orgs","repos_url":"https://api.github.com/users/mikedd/repos","events_url":"https://api.github.com/users/mikedd/events{/privacy}","received_events_url":"https://api.github.com/users/mikedd/received_events","type":"User","site_admin":false},"parents":[{"sha":"d4c2a2f77c9a636200297254e2f7c4ac63e45617","url":"https://api.github.com/repos/apache/openjpa/commits/d4c2a2f77c9a636200297254e2f7c4ac63e45617","html_url":"https://github.com/apache/openjpa/commit/d4c2a2f77c9a636200297254e2f7c4ac63e45617"}],"stats":{"total":37,"additions":19,"deletions":18},"files":[{"sha":"4d89d3eadbbefa7144d57b337ef71aebe7e3447c","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAVersion.java","status":"modified","additions":16,"deletions":17,"changes":33,"blob_url":"https://github.com/apache/openjpa/blob/18502c72cae6c46044c8084495d036314948f9bc/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAVersion.java","raw_url":"https://github.com/apache/openjpa/raw/18502c72cae6c46044c8084495d036314948f9bc/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAVersion.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAVersion.java?ref=18502c72cae6c46044c8084495d036314948f9bc","patch":"@@ -45,8 +45,21 @@\n     public static final String REVISION_NUMBER;\n \n     static {\n-        Package pack = OpenJPAVersion.class.getPackage();\n-        String vers = pack == null ? null : pack.getImplementationVersion();\n+        Properties revisionProps = new Properties();\n+        try {\n+            InputStream in = OpenJPAVersion.class.getResourceAsStream\n+                (\"/META-INF/org.apache.openjpa.revision.properties\");\n+            if (in != null) {\n+                try {\n+                    revisionProps.load(in);\n+                } finally {\n+                    in.close();\n+                }\n+            }\n+        } catch (Exception e) {\n+        }\n+\n+        String vers = revisionProps.getProperty(\"openjpa.version\");\n         if (vers == null || \"\".equals(vers.trim()))\n             vers = \"0.0.0\";\n         VERSION_NUMBER = vers;\n@@ -71,21 +84,7 @@\n             patch = 0;\n         }\n \n-        String revision = \"\";\n-        try {\n-            InputStream in = OpenJPAVersion.class.getResourceAsStream\n-                (\"/META-INF/org.apache.openjpa.revision.properties\");\n-            if (in != null) {\n-                try {\n-                    Properties props = new Properties();\n-                    props.load(in);\n-                    revision = props.getProperty(\"revision.number\");\n-                } finally {\n-                    in.close();\n-                }\n-            }\n-        } catch (Exception e) {\n-        }\n+        String revision = revisionProps.getProperty(\"revision.number\");\n \n         MAJOR_RELEASE = major;\n         MINOR_RELEASE = minor;"},{"sha":"99145b696e6c55b9873ef9ad40d3059b66b00e74","filename":"openjpa-lib/pom.xml","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/18502c72cae6c46044c8084495d036314948f9bc/openjpa-lib/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/18502c72cae6c46044c8084495d036314948f9bc/openjpa-lib/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-lib/pom.xml?ref=18502c72cae6c46044c8084495d036314948f9bc","patch":"@@ -157,9 +157,11 @@\n                                 <property name=\"subversion.revision\"\n                                     value=\"unknown\"/>\n                                 <echo>Revision: ${subversion.revision}</echo>\n+                                <echo>OpenJPA version: ${project.version}</echo>\n                                     \n                                 <mkdir dir=\"${outdir}/META-INF\"/>\n-                                <echo file=\"${outdir}/META-INF/org.apache.openjpa.revision.properties\">revision.number=${subversion.revision}</echo>\n+                                <echo file=\"${outdir}/META-INF/org.apache.openjpa.revision.properties\">revision.number=${subversion.revision}\n+openjpa.version=${project.version}</echo>\n                                 <delete dir=\"${tmpdir}\"/>\n                             </tasks>\n                         </configuration>"}]}

