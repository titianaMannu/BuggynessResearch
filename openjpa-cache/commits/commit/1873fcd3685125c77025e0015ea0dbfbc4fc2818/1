{"sha":"1873fcd3685125c77025e0015ea0dbfbc4fc2818","node_id":"MDY6Q29tbWl0MjA2MzY0OjE4NzNmY2QzNjg1MTI1Yzc3MDI1ZTAwMTVlYTBkYmZiYzRmYzI4MTg=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-03-08T19:35:47Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-03-08T19:35:47Z"},"message":"OPENJPA-740 In MySQLDictionary use LONGBLOB, MEDIUMBLOB, TINYBLOB based on the column size, instead of always using BLOB which can only hold 64KB.  Patch contributed by Simone Gianni.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@920476 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"01227ab67c049792e06eccba916db69ca53e73f7","url":"https://api.github.com/repos/apache/openjpa/git/trees/01227ab67c049792e06eccba916db69ca53e73f7"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/1873fcd3685125c77025e0015ea0dbfbc4fc2818","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/1873fcd3685125c77025e0015ea0dbfbc4fc2818","html_url":"https://github.com/apache/openjpa/commit/1873fcd3685125c77025e0015ea0dbfbc4fc2818","comments_url":"https://api.github.com/repos/apache/openjpa/commits/1873fcd3685125c77025e0015ea0dbfbc4fc2818/comments","author":null,"committer":null,"parents":[{"sha":"14996dfd406d3f59d6d106ca9f89faf753b18eea","url":"https://api.github.com/repos/apache/openjpa/commits/14996dfd406d3f59d6d106ca9f89faf753b18eea","html_url":"https://github.com/apache/openjpa/commit/14996dfd406d3f59d6d106ca9f89faf753b18eea"}],"stats":{"total":27,"additions":27,"deletions":0},"files":[{"sha":"e92273d4c87e6f92552fb07fc60402fe052f2d89","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java","status":"modified","additions":27,"deletions":0,"changes":27,"blob_url":"https://github.com/apache/openjpa/blob/1873fcd3685125c77025e0015ea0dbfbc4fc2818/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/1873fcd3685125c77025e0015ea0dbfbc4fc2818/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MySQLDictionary.java?ref=1873fcd3685125c77025e0015ea0dbfbc4fc2818","patch":"@@ -75,6 +75,10 @@\n      */\n     public boolean optimizeMultiTableDeletes = false;\n \n+    public static final String tinyBlobTypeName = \"TINYBLOB\";\n+    public static final String mediumBlobTypeName = \"MEDIUMBLOB\";\n+    public static final String longBlobTypeName = \"LONGBLOB\";\n+\n     public MySQLDictionary() {\n         platform = \"MySQL\";\n         validationSQL = \"SELECT NOW()\";\n@@ -416,4 +420,27 @@ public String getSelectOperation(JDBCFetchConfiguration fetch) {\n         }\n         return result;\n     }\n+\n+    /**\n+     * OPENJPA-740 Special case for MySql special column types,\n+     * like LONGTEXT, LONGBLOG etc..\n+     * @see org.apache.openjpa.jdbc.sql.DBDictionary#getTypeName(org.apache.openjpa.jdbc.schema.Column)\n+     */\n+    @Override\n+    public String getTypeName(Column col) {\n+        if (col.getType() == Types.BLOB) {\n+            if (col.getSize() <= 255)\n+                return tinyBlobTypeName;\n+            else if (col.getSize() <= 65535)\n+                return blobTypeName;  // old default of 64KB\n+            else if (col.getSize() <= 16777215)\n+                return mediumBlobTypeName;\n+            else\n+                return longBlobTypeName;\n+        } else {\n+            return super.getTypeName(col);\n+        }\n+    }\n+\n }\n+"}]}

