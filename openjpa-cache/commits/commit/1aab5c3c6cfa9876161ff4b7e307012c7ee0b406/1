{"sha":"1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","node_id":"MDY6Q29tbWl0MjA2MzY0OjFhYWI1YzNjNmNmYTk4NzYxNjFmZjRiN2UzMDcwMTJjN2VlMGI0MDY=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-09-11T23:15:06Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-09-11T23:15:06Z"},"message":"OPENJPA-1295: fix the problem of escape character for MySQL \n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@814074 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"239efb94d8c402ac460d8ce283ebfe4806964d7c","url":"https://api.github.com/repos/apache/openjpa/git/trees/239efb94d8c402ac460d8ce283ebfe4806964d7c"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","html_url":"https://github.com/apache/openjpa/commit/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","comments_url":"https://api.github.com/repos/apache/openjpa/commits/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406/comments","author":null,"committer":null,"parents":[{"sha":"6b96b82d31027452ceb1bfdc1e6a6fa42f7ca7f9","url":"https://api.github.com/repos/apache/openjpa/commits/6b96b82d31027452ceb1bfdc1e6a6fa42f7ca7f9","html_url":"https://github.com/apache/openjpa/commit/6b96b82d31027452ceb1bfdc1e6a6fa42f7ca7f9"}],"stats":{"total":7,"additions":6,"deletions":1},"files":[{"sha":"f0248687c9c32fa53ae357763cee1daca4950d1c","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/exps/MatchesExpression.java","status":"modified","additions":6,"deletions":1,"changes":7,"blob_url":"https://github.com/apache/openjpa/blob/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/exps/MatchesExpression.java","raw_url":"https://github.com/apache/openjpa/raw/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/exps/MatchesExpression.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/exps/MatchesExpression.java?ref=1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","patch":"@@ -21,6 +21,7 @@\n import java.util.Map;\n \n import org.apache.openjpa.jdbc.schema.Column;\n+import org.apache.openjpa.jdbc.sql.DBDictionary;\n import org.apache.openjpa.jdbc.sql.SQLBuffer;\n import org.apache.openjpa.jdbc.sql.Select;\n import org.apache.openjpa.kernel.exps.ExpressionVisitor;\n@@ -103,8 +104,12 @@ public void appendTo(Select sel, ExpContext ctx, ExpState state,\n             buf.append(\" LIKE \").appendValue(str, col);\n \n             // escape out characters by using the database's escape sequence\n-            if (_escape != null)\n+            DBDictionary dict = ctx.store.getDBDictionary();\n+            if (_escape != null && _escape.equals(\"\\\\\")) {\n+                buf.append(\" ESCAPE '\").append(dict.searchStringEscape).append(\"'\");\n+            } else\n                 buf.append(\" ESCAPE '\").append(_escape).append(\"'\");\n+            \n         }\n         sel.append(buf, state.joins);\n     }"}]}

