{"sha":"1dc803b9d7167f5983e463cf14aaea8b6f2e329f","node_id":"MDY6Q29tbWl0MjA2MzY0OjFkYzgwM2I5ZDcxNjdmNTk4M2U0NjNjZjE0YWFlYThiNmYyZTMyOWY=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-04-10T02:31:05Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-04-10T02:31:05Z"},"message":"OPENJPA-1620 Fix TestJDBCEscapeDate test for HSQLDB.  Merged in from trunk r932191.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/2.0.x@932662 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"3e743a495159d2cba1552bceec7ea25595a78f6a","url":"https://api.github.com/repos/apache/openjpa/git/trees/3e743a495159d2cba1552bceec7ea25595a78f6a"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/1dc803b9d7167f5983e463cf14aaea8b6f2e329f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/1dc803b9d7167f5983e463cf14aaea8b6f2e329f","html_url":"https://github.com/apache/openjpa/commit/1dc803b9d7167f5983e463cf14aaea8b6f2e329f","comments_url":"https://api.github.com/repos/apache/openjpa/commits/1dc803b9d7167f5983e463cf14aaea8b6f2e329f/comments","author":null,"committer":null,"parents":[{"sha":"255b9e3837bf14fc4982b46b3a4752c93128fe1c","url":"https://api.github.com/repos/apache/openjpa/commits/255b9e3837bf14fc4982b46b3a4752c93128fe1c","html_url":"https://github.com/apache/openjpa/commit/255b9e3837bf14fc4982b46b3a4752c93128fe1c"}],"stats":{"total":11,"additions":7,"deletions":4},"files":[{"sha":"d3f905b575fe09e658d52e07974ab174f6fac101","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/query/TestJDBCEscapeDate.java","status":"modified","additions":7,"deletions":4,"changes":11,"blob_url":"https://github.com/apache/openjpa/blob/1dc803b9d7167f5983e463cf14aaea8b6f2e329f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/query/TestJDBCEscapeDate.java","raw_url":"https://github.com/apache/openjpa/raw/1dc803b9d7167f5983e463cf14aaea8b6f2e329f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/query/TestJDBCEscapeDate.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/query/TestJDBCEscapeDate.java?ref=1dc803b9d7167f5983e463cf14aaea8b6f2e329f","patch":"@@ -28,6 +28,8 @@\n import junit.framework.Assert;\n \n import org.apache.openjpa.jdbc.conf.JDBCConfiguration;\n+import org.apache.openjpa.jdbc.sql.DBDictionary;\n+import org.apache.openjpa.jdbc.sql.HSQLDictionary;\n import org.apache.openjpa.jdbc.sql.SQLServerDictionary;\n import org.apache.openjpa.persistence.test.SingleEMFTestCase;\n \n@@ -56,9 +58,10 @@ public void testJDBCEscape() {\n         em.clear();\n \n         String[] jpql;\n-        if (((JDBCConfiguration)emf.getConfiguration()).getDBDictionaryInstance() instanceof SQLServerDictionary){\n+        DBDictionary dict = ((JDBCConfiguration)emf.getConfiguration()).getDBDictionaryInstance();\n+        if ((dict instanceof SQLServerDictionary) || (dict instanceof HSQLDictionary)) {\n             jpql = new String[] {\n-                // some changes to the jpql strings had to be made for MSSQL\n+                // some changes to the jpql strings had to be made for MSSQL and HSQLDB\n                 \"select a from Employee a where a.hireDate >= {d '2009-08-25'}\",\n                 \"select a from Employee a where a.hireDate >= {d '2009-08-05'}\",    // requires yyyy-mm-dd\n                 // \"select a from Employee a where a.hireTime >= {t '00:00:00'}\",   // fails ?\n@@ -110,8 +113,8 @@ public void testJDBCEscape() {\n         }\n         em.getTransaction().begin();\n         String update;\n-        if (((JDBCConfiguration)emf.getConfiguration()).getDBDictionaryInstance() instanceof SQLServerDictionary) {\n-            // more than 3 digits after 00:00:00. fails on MSSQL\n+        if ((dict instanceof SQLServerDictionary) || (dict instanceof HSQLDictionary)) {\n+            // more than 3 digits after 00:00:00. fails on MSSQL and HSQLDB\n             update = \"update Employee a set a.hireTimestamp = {ts '2009-08-25 00:00:00.123'} where a.empId = 1\";\n         } else {\n             update = \"update Employee a set a.hireTimestamp = {ts '2009-08-25 00:00:00.123456'} where a.empId = 1\";"}]}

