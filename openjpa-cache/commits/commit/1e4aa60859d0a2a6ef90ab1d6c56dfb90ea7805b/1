{"sha":"1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","node_id":"MDY6Q29tbWl0MjA2MzY0OjFlNGFhNjA4NTlkMGEyYTZlZjkwYWIxZDZjNTZkZmI5MGVhNzgwNWI=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2008-10-21T02:03:26Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2008-10-21T02:03:26Z"},"message":"OPENJPA-745 raise string right truncation error for Sybase\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@706493 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"4e1e7f16956d771ae99ff3e2c94555cc6dc5d85b","url":"https://api.github.com/repos/apache/openjpa/git/trees/4e1e7f16956d771ae99ff3e2c94555cc6dc5d85b"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","html_url":"https://github.com/apache/openjpa/commit/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","comments_url":"https://api.github.com/repos/apache/openjpa/commits/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/comments","author":null,"committer":null,"parents":[{"sha":"e2388e9b3cb5f983623c968459d36a4d8c81c59c","url":"https://api.github.com/repos/apache/openjpa/commits/e2388e9b3cb5f983623c968459d36a4d8c81c59c","html_url":"https://github.com/apache/openjpa/commit/e2388e9b3cb5f983623c968459d36a4d8c81c59c"}],"stats":{"total":20,"additions":20,"deletions":0},"files":[{"sha":"7fda2073b0d584e4d6246c65f63e463ad11b591e","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java","raw_url":"https://github.com/apache/openjpa/raw/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java?ref=1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","patch":"@@ -920,6 +920,7 @@ private void connect(boolean ref) {\n                 _conn = connectInternal();\n             if (ref)\n                 _conn.ref();\n+            _dict.initializeSettings(_conn);\n         } catch (SQLException se) {\n             throw SQLExceptions.getStore(se, _dict);\n         } finally {"},{"sha":"e51b0d9ef24ece181730ab5a2ecad827def36fd9","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/apache/openjpa/blob/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java?ref=1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","patch":"@@ -200,6 +200,7 @@\n     public String selectWords = null;\n     public String fixedSizeTypeNames = null;\n     public String schemaCase = SCHEMA_CASE_UPPER;\n+    public boolean setStringRightTruncationOn = true;\n \n     // sql\n     public String validationSQL = null;\n@@ -4561,4 +4562,8 @@ final String checkNameLength(String name, int length, String msgKey) {\n     \t\t\t\tlength));\n     \treturn name;\n     }\n+    \n+    public void initializeSettings(Connection conn) \n+        throws SQLException {\n+    }\n }"},{"sha":"cb293b7b8ada26238cf4b7506b747463b88628c9","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SybaseDictionary.java","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/apache/openjpa/blob/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SybaseDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SybaseDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SybaseDictionary.java?ref=1e4aa60859d0a2a6ef90ab1d6c56dfb90ea7805b","patch":"@@ -268,6 +268,20 @@ public Connection decorate(Connection conn)\n         throws SQLException {\n         return new SybaseConnection(super.decorate(conn));\n     }\n+    \n+    public void initializeSettings(Connection conn)\n+        throws SQLException {\n+        // In order for Sybase to raise the truncation exception when the \n+        // string length is greater than the column length for Char, VarChar, \n+        // Binary, VarBinary, the \"set string_rtruncation on\" must be executed. \n+        // This setting is effective for the duration of current connection.\n+        if (setStringRightTruncationOn) {\n+            String str = \"set string_rtruncation on\";\n+            PreparedStatement stmnt = prepareStatement(conn, str);        \n+            stmnt.execute();\n+            stmnt.close();\n+        }\n+    }\n \n     /**\n      * Connection wrapper to cache the {@link Connection#getCatalog} result,"}]}

