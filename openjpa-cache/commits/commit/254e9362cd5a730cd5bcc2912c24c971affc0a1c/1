{"sha":"254e9362cd5a730cd5bcc2912c24c971affc0a1c","node_id":"MDY6Q29tbWl0MjA2MzY0OjI1NGU5MzYyY2Q1YTczMGNkNWJjYzI5MTJjMjRjOTcxYWZmYzBhMWM=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-01-05T13:26:00Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-01-05T13:26:00Z"},"message":"OPENJPA-1453 Old 1.0b TCK does not create a reports dir\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@896033 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c6c1c4e3d983d1e89103ab1eea0f24850e24245a","url":"https://api.github.com/repos/apache/openjpa/git/trees/c6c1c4e3d983d1e89103ab1eea0f24850e24245a"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/254e9362cd5a730cd5bcc2912c24c971affc0a1c","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/254e9362cd5a730cd5bcc2912c24c971affc0a1c","html_url":"https://github.com/apache/openjpa/commit/254e9362cd5a730cd5bcc2912c24c971affc0a1c","comments_url":"https://api.github.com/repos/apache/openjpa/commits/254e9362cd5a730cd5bcc2912c24c971affc0a1c/comments","author":null,"committer":null,"parents":[{"sha":"8cf03bdab7873f6b93cba83e2ad84ce9deb2e5e8","url":"https://api.github.com/repos/apache/openjpa/commits/8cf03bdab7873f6b93cba83e2ad84ce9deb2e5e8","html_url":"https://github.com/apache/openjpa/commit/8cf03bdab7873f6b93cba83e2ad84ce9deb2e5e8"}],"stats":{"total":35,"additions":5,"deletions":30},"files":[{"sha":"4b00a862979303b2ee6d2874c1001161aa5d6083","filename":"openjpa-integration/tck/pom.xml","status":"modified","additions":5,"deletions":30,"changes":35,"blob_url":"https://github.com/apache/openjpa/blob/254e9362cd5a730cd5bcc2912c24c971affc0a1c/openjpa-integration/tck/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/254e9362cd5a730cd5bcc2912c24c971affc0a1c/openjpa-integration/tck/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/pom.xml?ref=254e9362cd5a730cd5bcc2912c24c971affc0a1c","patch":"@@ -504,7 +504,7 @@ databaseName=${db.name}\n                             <attribute name=\"buildfile\" />\n                             <attribute name=\"target\" />\n                             <sequential>\n-                                <java classname=\"org.apache.tools.ant.launch.Launcher\" fork=\"true\" failonerror=\"true\" dir=\"${tck.dir}/src\" append=\"true\" output=\"${tck.log}\" timeout=\"7200000\">\n+                                <java classname=\"org.apache.tools.ant.launch.Launcher\" fork=\"true\" failonerror=\"true\" dir=\"${tck.dir}/src\" append=\"true\" output=\"${tck.log}\" timeout=\"7200000\" resultproperty=\"tsant.result\">\n                                     <arg value=\"-emacs\" />\n                                     <arg value=\"-buildfile\" />\n                                     <arg value=\"@{buildfile}\" />\n@@ -540,10 +540,12 @@ databaseName=${db.name}\n                         <!-- first initialize the database -->\n                         <echo>Calling TCK initdb.xml</echo>\n                         <tsant buildfile=\"${tck.dir}/bin/initdb.xml\" target=\"init.database\" />\n+                        <echo>TCK initdb.xml returned result=${tsant.result}</echo>\n \n                         <!-- now run the TCK -->\n                         <echo>Calling TCK build.xml</echo>\n                         <tsant buildfile=\"${tck.dir}/bin/build.xml\" target=\"runclient\" />\n+                        <echo>TCK build.xml returned result=${tsant.result}</echo>\n \n                         <!-- archive the results -->\n                         <property name=\"tck.results.archive\" value=\"${tck.base}/openjpa-tck-results.zip\" />\n@@ -553,33 +555,6 @@ databaseName=${db.name}\n                         </zip>\n                         <echo>Results archive at: ${tck.results.archive}</echo>\n \n-                        <!-- Figure out the Passed/Failed counts -->\n-                        <resourcecount property=\"count.passed\">\n-                          <tokens>\n-                            <concat>\n-                              <filterchain>\n-                                <tokenfilter>\n-                                  <containsstring contains=\"Passed.\"/>\n-                                </tokenfilter>\n-                              </filterchain>\n-                              <fileset dir=\"${jpatck.reports.dir}\" includes=\"summary.txt\" />\n-                            </concat>\n-                          </tokens>\n-                        </resourcecount>\n-                        <resourcecount property=\"count.failed\">\n-                          <tokens>\n-                            <concat>\n-                              <filterchain>\n-                                <tokenfilter>\n-                                  <containsstring contains=\"Failed.\"/>\n-                                </tokenfilter>\n-                              </filterchain>\n-                              <fileset dir=\"${jpatck.reports.dir}\" includes=\"summary.txt\" />\n-                            </concat>\n-                          </tokens>\n-                        </resourcecount>\n-                        <echo>TCK Results - Passed: ${count.passed}, Failed: ${count.failed}</echo>\n-\n                         <!--\n                             The TCK's Java process doesn't actually fail when\n                             tests fail, so we need to parse the results file\n@@ -589,9 +564,9 @@ databaseName=${db.name}\n                         <condition property=\"jpatck.failed\">\n                             <contains string=\"${jpatck.results}\" substring=\"Completed test run: not ok\" />\n                         </condition>\n-                        <fail if=\"jpatck.failed\">${count.failed} tests failed</fail>\n+                        <fail if=\"jpatck.failed\">Some tests failed</fail>\n                         <!-- else -->\n-                        <echo>Pased JPA 1.0b TCK!</echo>\n+                        <echo>JPA TCK Passed 100%!</echo>\n \n                     </tasks>\n                   </configuration>"}]}

