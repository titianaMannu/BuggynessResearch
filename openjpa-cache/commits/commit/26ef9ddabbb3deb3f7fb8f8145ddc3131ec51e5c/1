{"sha":"26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c","node_id":"MDY6Q29tbWl0MjA2MzY0OjI2ZWY5ZGRhYmJiM2RlYjNmN2ZiOGY4MTQ1ZGRjMzEzMWVjNTFlNWM=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-01-08T00:57:05Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-01-08T00:57:05Z"},"message":"Obtain the DBDictionary up-front in the mapping tool constructor to ensure that the dictionary is fully configured with connection-specific information.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@609824 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"46627b43b3262c477170767ec9707795341fcf37","url":"https://api.github.com/repos/apache/openjpa/git/trees/46627b43b3262c477170767ec9707795341fcf37"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c","html_url":"https://github.com/apache/openjpa/commit/26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c","comments_url":"https://api.github.com/repos/apache/openjpa/commits/26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c/comments","author":null,"committer":null,"parents":[{"sha":"5a0b5b39e7c6fe354e722ab467bdf355ddd3ff85","url":"https://api.github.com/repos/apache/openjpa/commits/5a0b5b39e7c6fe354e722ab467bdf355ddd3ff85","html_url":"https://github.com/apache/openjpa/commit/5a0b5b39e7c6fe354e722ab467bdf355ddd3ff85"}],"stats":{"total":9,"additions":6,"deletions":3},"files":[{"sha":"fb6b7d51856f80ea7ba37afac7e49bc741c5e4da","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java","status":"modified","additions":6,"deletions":3,"changes":9,"blob_url":"https://github.com/apache/openjpa/blob/26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java","raw_url":"https://github.com/apache/openjpa/raw/26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/MappingTool.java?ref=26ef9ddabbb3deb3f7fb8f8145ddc3131ec51e5c","patch":"@@ -97,13 +97,15 @@\n         ACTION_IMPORT,\n     };\n \n-    private static Localizer _loc = Localizer.forPackage(MappingTool.class);\n+    private static final Localizer _loc =\n+        Localizer.forPackage(MappingTool.class);\n \n     private final JDBCConfiguration _conf;\n     private final Log _log;\n     private final String _action;\n     private final boolean _meta;\n     private final int _mode;\n+    private final DBDictionary _dict;\n \n     private MappingRepository _repos = null;\n     private SchemaGroup _schema = null;\n@@ -147,6 +149,8 @@ else if (meta && ACTION_DROP.equals(_action))\n             _mode = MODE_META | MODE_MAPPING | MODE_QUERY;\n         else\n             _mode = MODE_MAPPING;\n+\n+        _dict = _conf.getDBDictionaryInstance();\n     }\n \n     /**\n@@ -572,11 +576,10 @@ private void dropUnusedSchemaComponents(ClassMapping[] mappings) {\n         SchemaGroup group = getSchemaGroup();\n         Schema[] schemas = group.getSchemas();\n         Table[] tables;\n-        DBDictionary dict = _conf.getDBDictionaryInstance();\n         for (int i = 0; i < schemas.length; i++) {\n             tables = schemas[i].getTables();\n             for (int j = 0; j < tables.length; j++)\n-                dict.refSchemaComponents(tables[j]);\n+                _dict.refSchemaComponents(tables[j]);\n         }\n \n         group.removeUnusedComponents();"}]}

