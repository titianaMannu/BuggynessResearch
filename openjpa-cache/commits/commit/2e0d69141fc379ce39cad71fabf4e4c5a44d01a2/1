{"sha":"2e0d69141fc379ce39cad71fabf4e4c5a44d01a2","node_id":"MDY6Q29tbWl0MjA2MzY0OjJlMGQ2OTE0MWZjMzc5Y2UzOWNhZDcxZmFiZjRlNGM1YTQ0ZDAxYTI=","commit":{"author":{"name":"Milosz Tylenda","email":"mtylenda@apache.org","date":"2011-03-07T12:33:59Z"},"committer":{"name":"Milosz Tylenda","email":"mtylenda@apache.org","date":"2011-03-07T12:33:59Z"},"message":"OPENJPA-1376: Documentation update - add migration section on allocationSize property of @SequenceGenerator.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1078761 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"62fe5b78358f7cd25e9f02728b95a0b7e6903842","url":"https://api.github.com/repos/apache/openjpa/git/trees/62fe5b78358f7cd25e9f02728b95a0b7e6903842"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/2e0d69141fc379ce39cad71fabf4e4c5a44d01a2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/2e0d69141fc379ce39cad71fabf4e4c5a44d01a2","html_url":"https://github.com/apache/openjpa/commit/2e0d69141fc379ce39cad71fabf4e4c5a44d01a2","comments_url":"https://api.github.com/repos/apache/openjpa/commits/2e0d69141fc379ce39cad71fabf4e4c5a44d01a2/comments","author":null,"committer":null,"parents":[{"sha":"1cfbf9d171802e90b469287574b3165461472736","url":"https://api.github.com/repos/apache/openjpa/commits/1cfbf9d171802e90b469287574b3165461472736","html_url":"https://github.com/apache/openjpa/commit/1cfbf9d171802e90b469287574b3165461472736"}],"stats":{"total":72,"additions":62,"deletions":10},"files":[{"sha":"0fe130e828b5f1826f51a958cad23bd937e88b02","filename":"openjpa-project/src/doc/manual/migration_considerations.xml","status":"modified","additions":62,"deletions":10,"changes":72,"blob_url":"https://github.com/apache/openjpa/blob/2e0d69141fc379ce39cad71fabf4e4c5a44d01a2/openjpa-project/src/doc/manual/migration_considerations.xml","raw_url":"https://github.com/apache/openjpa/raw/2e0d69141fc379ce39cad71fabf4e4c5a44d01a2/openjpa-project/src/doc/manual/migration_considerations.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/src/doc/manual/migration_considerations.xml?ref=2e0d69141fc379ce39cad71fabf4e4c5a44d01a2","patch":"@@ -23,7 +23,7 @@\n     </title>\n     <section id=\"jpa_2.0\">\n         <title>\n-            JPA 2.0\n+            OpenJPA 2.0.0\n         </title>\n         <section id=\"jpa_2.0_incompatibilities\">\n             <title>\n@@ -344,16 +344,68 @@\n             </section>\n         </section>\n     </section>\n-\t<section id=\"jpa_2.1\">\n+    <section id=\"jpa_2.2\">\n         <title>\n-            OpenJPA 2.1.0\n+            OpenJPA 2.2.0\n         </title>\n-        <section id=\"jpa_2.1_changes_in_behavior\">\n-        \t<title>Internal Behavioral Differences</title>\n-        \t<para>\n-\tThe following sections indicate behavior that has changed from the OpenJPA 2.0.x\n-\trelease to the OpenJPA 2.1.0 release.\n-        \t</para>\n+        <section id=\"jpa_2.2_incompatibilities\">\n+            <title>Incompatibilities</title>\n+       \t    <para>\n+                The following sections indicate changes that are incompatible\n+                between OpenJPA 2.1.x releases and the 2.2.0 release.\n+            </para>\n+            <section id=\"jpa_2.2_allocationSize\">\n+                <title>\n+                    allocationSize Property of Sequence Generator\n+                </title>\n+                <!-- See OPENJPA-1376 for details. -->\n+                <para>\n+                    In previous releases, specifying the <literal>allocationSize</literal> property of\n+                    <link linkend=\"jpa_overview_mapping_sequence_seqgen\">sequence generator</link>\n+                    affected only sequence definition in the database. During\n+                    schema creation, the <literal>INCREMENT BY</literal> clause of\n+                    <literal>CREATE SEQUENCE</literal> statement always\n+                    had a value of 1 and on DB2, Oracle and PostgreSQL databases a <literal>CACHE</literal> clause\n+                    was added with the value of <literal>allocationSize</literal> property. Such a statement caused\n+                    sequence values being cached in the database. Starting with OpenJPA 2.2.0,\n+                    sequence values are cached in the jvm memory and the <literal>allocationSize</literal>\n+                    property determines size of that cache. The <literal>CACHE</literal> clause is no longer used,\n+                    instead the <literal>INCREMENT BY</literal> clause gets its value equal to the\n+                    <literal>allocationSize</literal> property. Such a strategy reduces the number of database roundtrips\n+                    required for retrieving sequence values considerably.\n+                </para>\n+                <para>\n+                    In order for the existing applications to work with OpenJPA\n+                    2.2.0, you have to manually recreate or redefine sequences, specifying\n+                    the correct <literal>INCREMENT BY</literal> value and, possibly, correct initial sequence value.\n+                    Note that the default value of the <literal>allocationSize</literal> property is 50 and that\n+                    value is used if the property is not specified.\n+                </para>\n+                <para>\n+                    The requirement for sequence modification applies to all databases that support sequences, regardless of\n+                    the <literal>CACHE</literal> clause being supported. The only excpetion is Firebird database -\n+                    since with this database the increment step is determined during sequence\n+                    value fetch, no migration activity is needed.\n+                </para>\n+                <para>\n+                    To maintain the old behavior of sequence generator in OpenJPA 2.2.0, you can:\n+                    <itemizedlist>\n+                        <listitem>\n+                            <para>\n+                                Set the <literal>allocationSize</literal> property value to 1.\n+                            </para>\n+                        </listitem>\n+                        <listitem>\n+                            <para>\n+                                Additionally, if the <literal>CACHE</literal> clause has to be emitted in sequence definition,\n+                                this can be accomplished by overriding the\n+                                <ulink url=\"../javadoc/org/apache/openjpa/jdbc/sql/DBDictionary.html#getCreateSequenceSQL(org.apache.openjpa.jdbc.schema.Sequence)\">\n+                                <methodname>DBDictionary.getCreateSequenceSQL</methodname></ulink> method.\n+                            </para>\n+                        </listitem>\n+                    </itemizedlist>\n+                </para>\n+            </section>\n         </section>\n-\t</section>    \n+    </section>\n </appendix>"}]}

