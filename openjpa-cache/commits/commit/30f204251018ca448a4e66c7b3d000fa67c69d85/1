{"sha":"30f204251018ca448a4e66c7b3d000fa67c69d85","node_id":"MDY6Q29tbWl0MjA2MzY0OjMwZjIwNDI1MTAxOGNhNDQ4YTRlNjZjN2IzZDAwMGZhNjdjNjlkODU=","commit":{"author":{"name":"David J. Wisneski","email":"wisneskid@apache.org","date":"2007-04-18T21:58:16Z"},"committer":{"name":"David J. Wisneski","email":"wisneskid@apache.org","date":"2007-04-18T21:58:16Z"},"message":"further clean up for OPENJPA-222\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@530174 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"b1335ba97a2fdbe4d66b9b687dc47704e55b2f22","url":"https://api.github.com/repos/apache/openjpa/git/trees/b1335ba97a2fdbe4d66b9b687dc47704e55b2f22"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/30f204251018ca448a4e66c7b3d000fa67c69d85","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/30f204251018ca448a4e66c7b3d000fa67c69d85","html_url":"https://github.com/apache/openjpa/commit/30f204251018ca448a4e66c7b3d000fa67c69d85","comments_url":"https://api.github.com/repos/apache/openjpa/commits/30f204251018ca448a4e66c7b3d000fa67c69d85/comments","author":null,"committer":null,"parents":[{"sha":"0df6a69703ffbbdbc2cdc715d09c6969d69bf7a7","url":"https://api.github.com/repos/apache/openjpa/commits/0df6a69703ffbbdbc2cdc715d09c6969d69bf7a7","html_url":"https://github.com/apache/openjpa/commit/0df6a69703ffbbdbc2cdc715d09c6969d69bf7a7"}],"stats":{"total":13,"additions":6,"deletions":7},"files":[{"sha":"ad9e2ab90ff25bcd539157259c5e98e1a5dbac8c","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","status":"modified","additions":6,"deletions":7,"changes":13,"blob_url":"https://github.com/apache/openjpa/blob/30f204251018ca448a4e66c7b3d000fa67c69d85/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/30f204251018ca448a4e66c7b3d000fa67c69d85/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java?ref=30f204251018ca448a4e66c7b3d000fa67c69d85","patch":"@@ -39,7 +39,7 @@\n     private int db2ServerType = 0;\r\n     private static final int db2ISeriesV5R3AndEarlier = 1;\r\n     private static final int db2UDBV81OrEarlier = 2;\r\n-    private static final int db2ZOSV8x = 3;\r\n+    private static final int db2ZOSV8xOrLater = 3;\r\n     private static final int db2UDBV82AndLater = 4;\r\n     private static final int db2ISeriesV5R4AndLater = 5;\r\n \tprivate static final String forUpdateOfClause = \"FOR UPDATE OF\";\r\n@@ -195,8 +195,8 @@ public void connectedConfiguration(Connection conn) throws SQLException {\n \t    \t    db2ServerType = db2ISeriesV5R3AndEarlier;\r\n \t    \telse if (isDB2UDBV81OrEarlier(metaData,maj,min))\r\n \t    \t    db2ServerType = db2UDBV81OrEarlier;\r\n-\t    \telse if (isDB2ZOSV8x(metaData,maj))\r\n-\t    \t    db2ServerType = db2ZOSV8x;\r\n+\t    \telse if (isDB2ZOSV8xOrLater(metaData,maj))\r\n+\t    \t    db2ServerType = db2ZOSV8xOrLater;\r\n \t    \telse if (isDB2UDBV82AndLater(metaData,maj,min))\r\n \t    \t    db2ServerType = db2UDBV82AndLater;\r\n \t    \telse if (isDB2ISeriesV5R4AndLater(metaData))\r\n@@ -246,7 +246,6 @@ protected String getForUpdateClause(JDBCFetchConfiguration fetch,\n                 isolationLevel = conf.getTransactionIsolationConstant();\r\n \r\n             if (forUpdate) {\r\n-\r\n                 switch(db2ServerType) {\r\n                 case db2ISeriesV5R3AndEarlier:\r\n                 case db2UDBV81OrEarlier:\r\n@@ -259,7 +258,7 @@ protected String getForUpdateClause(JDBCFetchConfiguration fetch,\n                            .append(\" \");\r\n                     }\r\n                     break;\r\n-                case db2ZOSV8x:\r\n+                case db2ZOSV8xOrLater:\r\n                 case db2UDBV82AndLater:\r\n                     if (isolationLevel == Connection.TRANSACTION_SERIALIZABLE) {\r\n                         forUpdateString.append(\" \").append(forReadOnlyClause)\r\n@@ -305,11 +304,11 @@ public boolean isDB2UDBV82AndLater(DatabaseMetaData metadata, int maj,\n         return match;\r\n     }\r\n \r\n-    public boolean isDB2ZOSV8x(DatabaseMetaData metadata, int maj)\r\n+    public boolean isDB2ZOSV8xOrLater(DatabaseMetaData metadata, int maj)\r\n        throws SQLException {\r\n        boolean match = false;\r\n        if (metadata.getDatabaseProductVersion().indexOf(\"DSN\") != -1\r\n-           && maj == 8)\r\n+           && maj >= 8)\r\n            match = true;\r\n         return match;\r\n     }\r"}]}

