{"sha":"35421424b5c30f2ffffcbd15e58db44017facaf4","node_id":"MDY6Q29tbWl0MjA2MzY0OjM1NDIxNDI0YjVjMzBmMmZmZmZjYmQxNWU1OGRiNDQwMTdmYWNhZjQ=","commit":{"author":{"name":"Albert Lee","email":"allee8285@apache.org","date":"2013-02-06T22:30:09Z"},"committer":{"name":"Albert Lee","email":"allee8285@apache.org","date":"2013-02-06T22:30:09Z"},"message":"OPENJPA-2326 - Enable running TCK 2 against databases other then Derby. Fixed a few configuration problems.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1443246 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"691b8b8a67c38066dacbbfc218d8ca89138bc979","url":"https://api.github.com/repos/apache/openjpa/git/trees/691b8b8a67c38066dacbbfc218d8ca89138bc979"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/35421424b5c30f2ffffcbd15e58db44017facaf4","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/35421424b5c30f2ffffcbd15e58db44017facaf4","html_url":"https://github.com/apache/openjpa/commit/35421424b5c30f2ffffcbd15e58db44017facaf4","comments_url":"https://api.github.com/repos/apache/openjpa/commits/35421424b5c30f2ffffcbd15e58db44017facaf4/comments","author":null,"committer":null,"parents":[{"sha":"150755864c02f5aead12c86f14bba717756b0ffd","url":"https://api.github.com/repos/apache/openjpa/commits/150755864c02f5aead12c86f14bba717756b0ffd","html_url":"https://github.com/apache/openjpa/commit/150755864c02f5aead12c86f14bba717756b0ffd"}],"stats":{"total":317,"additions":302,"deletions":15},"files":[{"sha":"b5f10c892068859038256897db70cf4fe5c26275","filename":"openjpa-integration/tck/pom.xml","status":"modified","additions":93,"deletions":0,"changes":93,"blob_url":"https://github.com/apache/openjpa/blob/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/pom.xml?ref=35421424b5c30f2ffffcbd15e58db44017facaf4","patch":"@@ -185,12 +185,22 @@\n                         <path id=\"cp\">\n                             <path refid=\"maven.compile.classpath\" />\n                         </path>\n+                        <path id=\"cp.test\">\n+                            <pathelement location=\"${basedir}/../../target/classes\"/>\n+                            <path refid=\"maven.test.classpath\" />\n+                        </path>\n+                        <pathconvert property=\"cp.test.classpath\" refid=\"cp.test\" />\n                         \n                         <!-- create missing directory for maven compile classpath -->\n                         <mkdir dir=\"${basedir}/target/classes\" />\n                         \n                         <ant antfile=\"${basedir}/tck2-${tck2.level}.xml\" inheritRefs=\"true\">\n                             <target name=\"run-tck\" />\n+                            <property name=\"tck.db.name\" value=\"${tck.db.name}\" />\n+                            <property name=\"connection.driver.name\" value=\"${connection.driver.name}\" />\n+                            <property name=\"connection.url\" value=\"${connection.url}\" />\n+                            <property name=\"connection.username\" value=\"${connection.username}\" />\n+                            <property name=\"connection.password\" value=\"${connection.password}\" />\n                         </ant>\n                     </tasks>\n                   </configuration>\n@@ -440,6 +450,89 @@ databaseName=${db.name}\n           </dependency>\n         </dependencies>\n       </profile>\n+\n+        <profile>\n+            <!--\n+                Example db2 profile. You can use this profile if you:\n+                1) have the DB2 artifacts installed in a local repo and supply the URL:\n+                    -Ddb2.maven.repo=http://my.local.repo\n+                2) have a copy of the DB2 JCC driver and run the following commands :\n+                    mvn install:install-file -Dfile=${path to db2jcc.jar} \\\n+                                             -DgroupId=com.ibm.db2 \\\n+                                             -DartifactId=jcc-driver \\\n+                                             -Dversion=9.5 \\\n+                                             -Dpackaging=jar\n+\n+                    mvn install:install-file -Dfile=${path to db2jcc_license.jar} \\\n+                                             -DgroupId=com.ibm.db2 \\\n+                                             -DartifactId=jcc-license \\\n+                                             -Dversion=9.5 \\\n+                                             -Dpackaging=jar\n+\n+                You must also set the following properties:\n+                    -Dopenjpa.db2.url=jdbc:db2://<HOST>:<PORT>/<DBNAME>\n+                    -Dopenjpa.db2.username=<db2_uid>\n+                    -Dopenjpa.db2.password=<db2_pwd>\n+\n+                Optionally, you can override the default DB2 groupId,\n+                artifactIds and version by also supplying the following\n+                properties:\n+                    -Ddb2.groupid=com.ibm.db2\n+                    -Dids.driver.artifactid=jcc-driver\n+                    -Dids.license.artifactid=jcc-license\n+                    -Ddb2.version=9.5\n+            -->\n+            <id>test-db2-jcc</id>\n+            <activation>\n+                <property>\n+                    <name>test-db2-jcc</name>\n+                </property>\n+            </activation>\n+            <dependencies>\n+                <dependency>\n+                    <groupId>${db2.groupid}</groupId>\n+                    <artifactId>${db2.driver.artifactid}</artifactId>\n+                    <version>${db2.version}</version>\n+                    <scope>test</scope>\n+                </dependency>\n+                <dependency>\n+                    <groupId>${db2.groupid}</groupId>\n+                    <artifactId>${db2.license.artifactid}</artifactId>\n+                    <version>${db2.version}</version>\n+                    <scope>test</scope>\n+                </dependency>\n+            </dependencies>\n+            <properties>\n+                <db2.maven.repo>http://not.a.real.repository</db2.maven.repo>\n+                <db2.groupid>com.ibm.db2</db2.groupid>\n+                <db2.driver.artifactid>jcc-driver</db2.driver.artifactid>\n+                <db2.license.artifactid>jcc-license</db2.license.artifactid>\n+                <db2.version>9.5</db2.version>\n+                <connection.driver.name>com.ibm.db2.jcc.DB2Driver</connection.driver.name>\n+                <connection.url>jdbc:db2://localhost:50000/tck</connection.url>\n+                <connection.url>${openjpa.db2.url}</connection.url>\n+                <connection.username>${openjpa.db2.username}</connection.username>\n+                <connection.password>${openjpa.db2.password}</connection.password>\n+                <jdbc.DBDictionary />\n+                <tck.db.name>db2</tck.db.name>\n+            </properties>\n+            <repositories>\n+                <repository>\n+                    <id>db2.repository</id>\n+                    <name>DB2 Repository</name>\n+                    <url>${db2.maven.repo}</url>\n+                    <layout>default</layout>\n+                    <snapshots>\n+                        <enabled>false</enabled>\n+                    </snapshots>\n+                    <releases>\n+                        <enabled>true</enabled>\n+                        <checksumPolicy>ignore</checksumPolicy>\n+                    </releases>\n+                </repository>\n+            </repositories>\n+        </profile>\n+\n     </profiles>\n \n     <dependencies>"},{"sha":"f5968eb8821243c5857a2fd54ab40054ff78f3fa","filename":"openjpa-integration/tck/sql/create.openjpa.sql.xml","status":"added","additions":102,"deletions":0,"changes":102,"blob_url":"https://github.com/apache/openjpa/blob/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/sql/create.openjpa.sql.xml","raw_url":"https://github.com/apache/openjpa/raw/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/sql/create.openjpa.sql.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/sql/create.openjpa.sql.xml?ref=35421424b5c30f2ffffcbd15e58db44017facaf4","patch":"@@ -0,0 +1,102 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+ Licensed to the Apache Software Foundation (ASF) under one\n+ or more contributor license agreements.  See the NOTICE file\n+ distributed with this work for additional information\n+ regarding copyright ownership.  The ASF licenses this file\n+ to you under the Apache License, Version 2.0 (the\n+ \"License\"); you may not use this file except in compliance\n+ with the License.  You may obtain a copy of the License at\n+\n+ http://www.apache.org/licenses/LICENSE-2.0\n+\n+ Unless required by applicable law or agreed to in writing,\n+ software distributed under the License is distributed on an\n+ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ KIND, either express or implied.  See the License for the\n+ specific language governing permissions and limitations\n+ under the License.\n+-->\n+<project name=\"ExecSQL\" default=\"create-sql\" basedir=\".\">\n+\n+    <target name=\"create-sql\">\n+    \n+        <echo>Creating OpenJPA specific sql for JPA 2.0 TCK tests</echo>\n+        <!-- Use tsant force to change the working directory to @{dir}. -->\n+        <tsant dir=\"${tck.dir}/bin\" buildfile=\"${basedir}/sql/create.openjpa.sql.xml\" target=\"exec-sql\"/>\n+        <echo>Create TCK specific database tables returned result=${tsant.result}</echo>\n+        \n+    </target>\n+\n+    <target name=\"exec-sql\">\n+    \n+        <echo>databaseName=${databaseName}</echo>\n+        <antcall target=\"init.${databaseName}\"/>\n+        \n+    </target>\n+\n+    <target name=\"init.common\">\n+    \n+        <sql driver=\"${database.driver}\"\n+             url=\"${database.url}\"\n+             userid=\"${database.user}\"\n+             password=\"${database.passwd}\"\n+             classpath=\"${jdbc.lib.classpath}\"\n+             delimiter=\"${db.delimiter}\"\n+             autocommit=\"true\"\n+             onerror=\"continue\" >\n+             <transaction src=\"../../../../sql/${databaseName}.sql\"/>\n+        </sql>\n+        \n+    </target>\n+\n+    <target name=\"init.derby\">\n+        <antcall target=\"init.common\">\n+            <param name=\"db.delimiter\" value=\";\"/>\n+        </antcall>\n+    </target>\n+\n+    <target name=\"init.db2\">\n+        <antcall target=\"init.common\">\n+            <param name=\"db.delimiter\" value=\"!\"/>\n+        </antcall>\n+    </target>\n+\n+    <macrodef name=\"tsant\">\n+        <attribute name=\"dir\" default=\"${tck.dir}/src\" />\n+        <attribute name=\"buildfile\" />\n+        <attribute name=\"target\" />\n+        <attribute name=\"tmo\" default=\"7200000\" />\n+        <sequential>\n+            <java classname=\"org.apache.tools.ant.launch.Launcher\" fork=\"true\" failonerror=\"false\" dir=\"@{dir}\" append=\"true\" output=\"${tck.log}\" timeout=\"@{tmo}\" resultproperty=\"tsant.result\">\n+                <arg value=\"-e\" />\n+                <arg value=\"-v\" />\n+                <arg value=\"-emacs\" />\n+                <arg value=\"-buildfile\" />\n+                <arg value=\"@{buildfile}\" />\n+                <arg value=\"-listener\" />\n+                <arg value=\"com.sun.ant.TSBuildListener\" />\n+                <arg value=\"-logger\" />\n+                <arg value=\"com.sun.ant.TSLogger\" />\n+                <arg value=\"@{target}\" />\n+\n+                <env key=\"TS_HOME\" value=\"${tck.dir}\" />\n+                <sysproperty key=\"ts.home\" value=\"${tck.dir}\" />\n+\n+                <env key=\"ANT_HOME\" value=\"${tck.dir}/tools/ant\" />\n+                <sysproperty key=\"ant.home\" value=\"${tck.dir}/tools/ant\" />\n+\n+                <classpath>\n+                    <path refid=\"cp\" />\n+                    <fileset dir=\"${tck.dir}/tools/ant/lib\">\n+                        <include name=\"**/*.jar\" />\n+                    </fileset>\n+                    <fileset dir=\"${tck.dir}/lib\">\n+                        <include name=\"**/*.jar\" />\n+                    </fileset>\n+                </classpath>\n+            </java>\n+        </sequential>\n+    </macrodef>\n+\n+</project>"},{"sha":"2f5efed8c471bc531040c8cae724242ec6a686ea","filename":"openjpa-integration/tck/sql/db2.sql","status":"added","additions":37,"deletions":0,"changes":37,"blob_url":"https://github.com/apache/openjpa/blob/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/sql/db2.sql","raw_url":"https://github.com/apache/openjpa/raw/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/sql/db2.sql","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/sql/db2.sql?ref=35421424b5c30f2ffffcbd15e58db44017facaf4","patch":"@@ -0,0 +1,37 @@\n+-- =======================================================================\n+-- com.sun.ts.tests.ejb30.persistence.entitytest.cascadeall.oneXone\n+DROP TABLE AEJB_1X1_BI_BTOB !\n+CREATE TABLE AEJB_1X1_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, PRIMARY KEY (id)) !\n+DROP TABLE BEJB_1X1_BI_BTOB !\n+CREATE TABLE BEJB_1X1_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, FK_FOR_AEJB_1X1_BI_BTOB VARCHAR(255), PRIMARY KEY (id)) !\n+CREATE INDEX I_BJ1X1B_BTB_A1 ON BEJB_1X1_BI_BTOB (FK_FOR_AEJB_1X1_BI_BTOB) !\n+-- ALTER TABLE BEJB_1X1_BI_BTOB ADD CONSTRAINT FK_FOR_AEJB_1X1_BI FOREIGN KEY (FK_FOR_AEJB_1X1_BI_BTOB) REFERENCES AEJB_1X1_BI_BTOB (ID) !\n+\n+-- =======================================================================\n+-- com.sun.ts.tests.ejb30.persistence.entitytest.cascadeall.oneXmany\n+DROP TABLE AEJB_1XM_BI_BTOB !\n+CREATE TABLE AEJB_1XM_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, PRIMARY KEY (id)) !\n+DROP TABLE BEJB_1XM_BI_BTOB !\n+CREATE TABLE BEJB_1XM_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, FK_FOR_AEJB_1XM_BI_BTOB VARCHAR(255), PRIMARY KEY (id)) !\n+CREATE INDEX I_BJ1XMTB_A1 ON BEJB_1XM_BI_BTOB (FK_FOR_AEJB_1XM_BI_BTOB) !\n+-- ALTER TABLE BEJB_1XM_BI_BTOB ADD CONSTRAINT FK_FOR_AEJB_1XM_BI FOREIGN KEY (FK_FOR_AEJB_1XM_BI_BTOB) REFERENCES AEJB_1XM_BI_BTOB (ID) !\n+\n+-- =======================================================================\n+-- com.sun.ts.tests.ejb30.persistence.entitytest.cascadeall.manyXone\n+DROP TABLE AEJB_MX1_UNI_BTOB !\n+CREATE TABLE AEJB_MX1_UNI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, PRIMARY KEY (id)) !\n+DROP TABLE BEJB_MX1_UNI_BTOB !\n+CREATE TABLE BEJB_MX1_UNI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, FK_FOR_AEJB_MX1_UNI_BTOB VARCHAR(255), PRIMARY KEY (id)) !\n+CREATE INDEX I_BJMX1TB_A1 ON BEJB_MX1_UNI_BTOB (FK_FOR_AEJB_MX1_UNI_BTOB) !\n+-- ALTER TABLE BEJB_MX1_UNI_BTOB ADD CONSTRAINT FK_FOR_AEJB_MX1_UN FOREIGN KEY (FK_FOR_AEJB_MX1_UNI_BTOB) REFERENCES AEJB_MX1_UNI_BTOB (ID) !\n+\n+-- =======================================================================\n+--\n+DROP TABLE PROJECT!\n+CREATE TABLE PROJECT (PROJID INT NOT NULL, NAME VARCHAR(25), BUDGET DECIMAL(18,0), CONSTRAINT PK_PROJECT PRIMARY KEY (PROJID))!\n+\n+-- =======================================================================\n+-- DROP TABLE A_BIGINTEGER!\n+-- CREATE TABLE A_BIGINTEGER ( ID VARCHAR(255), NAME VARCHAR(255) , VALUE INT, BASICINTEGER INT, BASICSHORT SMALLINT, BASICBIGSHORT SMALLINT, BASICFLOAT FLOAT, BASICBIGFLOAT FLOAT, BASICLONG BIGINT, BASICBIGLONG BIGINT, BASICDOUBLE DOUBLE, BASICBIGDOUBLE DOUBLE, BASICCHAR CHAR, BASICCHARARRAY VARCHAR(448), BASICBIGCHARARRAY VARCHAR(448), BASICBYTEARRAY  LONG VARCHAR FOR BIT DATA, BASICBIGBYTEARRAY LONG VARCHAR FOR BIT DATA, BASICBIGINTEGER DECIMAL(18,0) PRIMARY KEY NOT NULL, BASICBIGDECIMAL DECIMAL(18,0), BASICDATE DATE, BASICTIME TIME, BASICCALENDAR DATE, BASICTIMESTAMP TIMESTAMP )!\n+-- DROP TABLE A_BIGDECIMAL!\n+-- CREATE TABLE A_BIGDECIMAL ( ID VARCHAR(255), NAME VARCHAR(255) , VALUE INT, BASICINTEGER INT, BASICSHORT SMALLINT, BASICBIGSHORT SMALLINT, BASICFLOAT FLOAT, BASICBIGFLOAT FLOAT, BASICLONG BIGINT, BASICBIGLONG BIGINT, BASICDOUBLE DOUBLE, BASICBIGDOUBLE DOUBLE, BASICCHAR CHAR, BASICCHARARRAY VARCHAR(448), BASICBIGCHARARRAY VARCHAR(448), BASICBYTEARRAY  LONG VARCHAR FOR BIT DATA, BASICBIGBYTEARRAY LONG VARCHAR FOR BIT DATA, BASICBIGINTEGER DECIMAL(18,0), BASICBIGDECIMAL DECIMAL(18,0) PRIMARY KEY NOT NULL, BASICDATE DATE, BASICTIME TIME, BASICCALENDAR DATE, BASICTIMESTAMP TIMESTAMP )!"},{"sha":"4b48dfb2d58bf2dcafec124f8138f16224eb519f","filename":"openjpa-integration/tck/sql/derby.sql","status":"added","additions":37,"deletions":0,"changes":37,"blob_url":"https://github.com/apache/openjpa/blob/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/sql/derby.sql","raw_url":"https://github.com/apache/openjpa/raw/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/sql/derby.sql","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/sql/derby.sql?ref=35421424b5c30f2ffffcbd15e58db44017facaf4","patch":"@@ -0,0 +1,37 @@\n+-- =======================================================================\n+-- com.sun.ts.tests.ejb30.persistence.entitytest.cascadeall.oneXone\n+DROP TABLE AEJB_1X1_BI_BTOB ;\n+CREATE TABLE AEJB_1X1_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, PRIMARY KEY (id)) ;\n+DROP TABLE BEJB_1X1_BI_BTOB ;\n+CREATE TABLE BEJB_1X1_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, FK_FOR_AEJB_1X1_BI_BTOB VARCHAR(255), PRIMARY KEY (id)) ;\n+CREATE INDEX I_BJ1X1B_BTB_A1 ON BEJB_1X1_BI_BTOB (FK_FOR_AEJB_1X1_BI_BTOB) ;\n+-- ALTER TABLE BEJB_1X1_BI_BTOB ADD CONSTRAINT FK_FOR_AEJB_1X1_BI FOREIGN KEY (FK_FOR_AEJB_1X1_BI_BTOB) REFERENCES AEJB_1X1_BI_BTOB (ID) ;\n+\n+-- =======================================================================\n+-- com.sun.ts.tests.ejb30.persistence.entitytest.cascadeall.oneXmany\n+DROP TABLE AEJB_1XM_BI_BTOB ;\n+CREATE TABLE AEJB_1XM_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, PRIMARY KEY (id)) ;\n+DROP TABLE BEJB_1XM_BI_BTOB ;\n+CREATE TABLE BEJB_1XM_BI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, FK_FOR_AEJB_1XM_BI_BTOB VARCHAR(255), PRIMARY KEY (id)) ;\n+CREATE INDEX I_BJ1XMTB_A1 ON BEJB_1XM_BI_BTOB (FK_FOR_AEJB_1XM_BI_BTOB) ;\n+-- ALTER TABLE BEJB_1XM_BI_BTOB ADD CONSTRAINT FK_FOR_AEJB_1XM_BI FOREIGN KEY (FK_FOR_AEJB_1XM_BI_BTOB) REFERENCES AEJB_1XM_BI_BTOB (ID) ;\n+\n+-- =======================================================================\n+-- com.sun.ts.tests.ejb30.persistence.entitytest.cascadeall.manyXone\n+DROP TABLE AEJB_MX1_UNI_BTOB ;\n+CREATE TABLE AEJB_MX1_UNI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, PRIMARY KEY (id)) ;\n+DROP TABLE BEJB_MX1_UNI_BTOB ;\n+CREATE TABLE BEJB_MX1_UNI_BTOB (id VARCHAR(255) NOT NULL, name VARCHAR(255), value INTEGER, FK_FOR_AEJB_MX1_UNI_BTOB VARCHAR(255), PRIMARY KEY (id)) ;\n+CREATE INDEX I_BJMX1TB_A1 ON BEJB_MX1_UNI_BTOB (FK_FOR_AEJB_MX1_UNI_BTOB) ;\n+-- ALTER TABLE BEJB_MX1_UNI_BTOB ADD CONSTRAINT FK_FOR_AEJB_MX1_UN FOREIGN KEY (FK_FOR_AEJB_MX1_UNI_BTOB) REFERENCES AEJB_MX1_UNI_BTOB (ID) ;\n+\n+-- =======================================================================\n+-- \n+DROP TABLE PROJECT;\n+CREATE TABLE PROJECT (PROJID INT NOT NULL, NAME VARCHAR(25), BUDGET DECIMAL(18,0), CONSTRAINT PK_PROJECT PRIMARY KEY (PROJID));\n+\n+-- =======================================================================\n+-- DROP TABLE A_BIGINTEGER;\n+-- CREATE TABLE A_BIGINTEGER ( ID VARCHAR(255), NAME VARCHAR(255) , VALUE INT, BASICINTEGER INT, BASICSHORT SMALLINT, BASICBIGSHORT SMALLINT, BASICFLOAT FLOAT, BASICBIGFLOAT FLOAT, BASICLONG BIGINT, BASICBIGLONG BIGINT, BASICDOUBLE DOUBLE, BASICBIGDOUBLE DOUBLE, BASICCHAR CHAR, BASICCHARARRAY VARCHAR(448), BASICBIGCHARARRAY VARCHAR(448), BASICBYTEARRAY  LONG VARCHAR FOR BIT DATA, BASICBIGBYTEARRAY LONG VARCHAR FOR BIT DATA, BASICBIGINTEGER DECIMAL(18,0) PRIMARY KEY NOT NULL, BASICBIGDECIMAL DECIMAL(18,0), BASICDATE DATE, BASICTIME TIME, BASICCALENDAR DATE, BASICTIMESTAMP TIMESTAMP );\n+-- DROP TABLE A_BIGDECIMAL;\n+-- CREATE TABLE A_BIGDECIMAL ( ID VARCHAR(255), NAME VARCHAR(255) , VALUE INT, BASICINTEGER INT, BASICSHORT SMALLINT, BASICBIGSHORT SMALLINT, BASICFLOAT FLOAT, BASICBIGFLOAT FLOAT, BASICLONG BIGINT, BASICBIGLONG BIGINT, BASICDOUBLE DOUBLE, BASICBIGDOUBLE DOUBLE, BASICCHAR CHAR, BASICCHARARRAY VARCHAR(448), BASICBIGCHARARRAY VARCHAR(448), BASICBYTEARRAY  LONG VARCHAR FOR BIT DATA, BASICBIGBYTEARRAY LONG VARCHAR FOR BIT DATA, BASICBIGINTEGER DECIMAL(18,0), BASICBIGDECIMAL DECIMAL(18,0) PRIMARY KEY NOT NULL, BASICDATE DATE, BASICTIME TIME, BASICCALENDAR DATE, BASICTIMESTAMP TIMESTAMP );"},{"sha":"decc833d954469e7af65f00682f756cbe811f33c","filename":"openjpa-integration/tck/tck2-20110815.xml","status":"modified","additions":31,"deletions":15,"changes":46,"blob_url":"https://github.com/apache/openjpa/blob/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/tck2-20110815.xml","raw_url":"https://github.com/apache/openjpa/raw/35421424b5c30f2ffffcbd15e58db44017facaf4/openjpa-integration/tck/tck2-20110815.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/tck2-20110815.xml?ref=35421424b5c30f2ffffcbd15e58db44017facaf4","patch":"@@ -23,7 +23,7 @@\n     the TCK, config  and patches zip files located at:\n \n         ${user.home}/.m2/privaterepos/jpatck-2.0_15-Aug-2011.zip\n-        ${user.home}/.m2/privaterepos/jpatck-2.0_15-Aug-2011_config.zip\n+        ${user.home}/.m2/privaterepos/jpatck-2.0_15-Aug-2011_config.zip (may not exist)\n \n     If you have that file in a different location, it can be specified with\n     the \"tck.zip\" and \"tck_patches.zip\" system property.\n@@ -90,11 +90,11 @@\n         Description:  This updates the TCK configuration for OpenJPA.\n      -->\n     <target name=\"setup\">\n-        <property name=\"db.name\" value=\"derby\" />\n-        <property name=\"db.driver\" value=\"org.apache.derby.jdbc.EmbeddedDriver\" />\n-        <property name=\"db.url\" value=\"jdbc:derby:derby-database;create=true\" />\n-        <property name=\"db.username\" value=\"nousername\" />\n-        <property name=\"db.password\" value=\"nopassword\" />\n+        <property name=\"db.name\" value=\"${tck.db.name}\" />\n+        <property name=\"db.driver\" value=\"${connection.driver.name}\" />\n+        <property name=\"db.url\" value=\"${connection.url}\" />\n+        <property name=\"db.username\" value=\"${connection.username}\" />\n+        <property name=\"db.password\" value=\"${connection.password}\" />\n \n         <property name=\"openjpa.Log\" value=\"DefaultLevel=TRACE\" />\n \n@@ -116,12 +116,14 @@ openjpa.FetchBatchSize: -1\n openjpa.Compatibility: StrictIdentityValues=true\n openjpa.Sequence: time\n openjpa.Log: ${openjpa.Log}\n-openjpa.jdbc.DBDictionary: StoreCharsAsNumbers=true\n+openjpa.jdbc.DBDictionary: NumericTypeName=DECIMAL\n+# openjpa.jdbc.DBDictionary: StoreCharsAsNumbers=true\n # openjpa.jdbc.DBDictionary: (StoreCharsAsNumbers=true,NumericTypeName=DECIMAL)\n openjpa.jdbc.SchemaFactory: native(ForeignKeys=true)\n openjpa.jdbc.SynchronizeMappings: buildSchema(ForeignKeys=true)\n+openjpa.ConnectionFactoryProperties: PrintParameters=True\n         </echo>\n-        \n+\n         <path id=\"javart\">\n             <fileset dir=\"${java.home}/lib\">\n               <include name=\"**/*.jar\" />\n@@ -158,6 +160,9 @@ database.passwd=${db.password}\n database.url=${db.url}\n database.driver=${db.driver}\n databaseName=${db.name}\n+jdbc.lib.classpath=${cp.test.classpath}\n+# disable initdb.xml table creation\n+create.cmp.tables=false\n \n         </echo>\n \n@@ -178,6 +183,7 @@ databaseName=${db.name}\n             <fileset dir=\"../../openjpa/target\">\n                 <include name=\"*.jar\" />\n                 <exclude name=\"*-sources.jar\" />\n+                <exclude name=\"*-shaded.jar\" />\n                 <exclude name=\"original-*.jar\" />\n                 <exclude name=\"*-tests.jar\" />\n                 <exclude name=\"*-javadoc.jar\" />\n@@ -187,14 +193,18 @@ databaseName=${db.name}\n         <property name=\"agent.properties\" value=\"\" />\n         <echo>AGENT: ${agent}${agent.properties}</echo>\n \n+        <!-- Use the following values to start Eclipse remote debug\n+    \t<property name=\"DEBUG\" value=\"-Djava.compiler=NONE -Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=7777\" />\n+        -->    \t\n+    \t<property name=\"DEBUG\" value=\"\" />\n         <!--\n             Add in a javaagent argument (optional in JPA2 TCK.)\n             Also, we need to specify the default MetaDataFactory\n             inorder to allow tests that don't have any\n             persistent classes to work (like the SignatureTest)\n         -->\n         <replace file=\"${jpatck.config}\">\n-            <replacefilter token=\"-Ddeliverable.class=${deliverable.class}\" value=\"-Ddeliverable.class=${deliverable.class} -javaagent:${agent}${agent.properties} -Dopenjpa.MetaDataFactory=jpa(DefaultAccessType=PROPERTY)\"/>\n+            <replacefilter token=\"-Ddeliverable.class=${deliverable.class}\" value=\"-Ddeliverable.class=${deliverable.class} -javaagent:${agent}${agent.properties} ${DEBUG} -Dopenjpa.MetaDataFactory=jpa(DefaultAccessType=PROPERTY)\"/>\n         </replace>\n \n         <!-- Fix path for java.security.policy -->\n@@ -295,7 +305,7 @@ databaseName=${db.name}\n         Input: jpatck.pkg.dir System property defines a commna-spearated list of test cases to be run.\n                If not set or set to empty string, all tck tests will be exercised.\n         Note: Beaware if jpatck.pkg.dir includes pluggability test in the dir hierarchy, the pluggability\n-              test will fail (5 failures) due to [enable|disable].ts.persistence.provider targets are \n+              test will fail (5 failures) due to [enable|disable].ts.persistence.provider targets are\n               not invoked, which is required for the pluggability tests.\n      -->\n     <target name=\"run-tck\">\n@@ -324,30 +334,36 @@ databaseName=${db.name}\n         <tsant dir=\"${tck.dir}/bin\" buildfile=\"${tck.dir}/bin/initdb.xml\" target=\"init.database\" />\n         <echo>TCK initdb.xml returned result=${tsant.result}</echo>\n \n+        <!-- Database table set up -->\n+        <!-- OpenJPA relies on SynchronizeMappings to create the database tables...\n+             ... except in a couple of cases where we will pre-create the tables.   -->\n+        <echo>Calling OpenJPA create.openjpa.sql.xml</echo>\n+        <ant antfile=\"${basedir}/sql/create.openjpa.sql.xml\" inheritRefs=\"true\" />\n+\n         <property name=\"jpatck.run.tmo\" value=\"7200000\" />\n         <!-- now run the TCK -->\n         <if>\n             <and>\n                 <isset property=\"jpatck.pkg.dir\" />\n                 <not>\n-                    <length string=\"${jpatck.pkg.dir}\" trim=\"true\" length=\"0\" /> \n+                    <length string=\"${jpatck.pkg.dir}\" trim=\"true\" length=\"0\" />\n                 </not>\n             </and>\n         <then>\n             <for list=\"${jpatck.pkg.dir}\" param=\"for.test\" trim=\"true\">\n-                <sequential>            \n+                <sequential>\n                     <if>\n                         <contains string=\"@{for.test}\" substring=\"pluggability\"/>\n                     <then>\n                         <echo>Calling enable.ts.persistence.provider for pluggability test.</echo>\n                         <tsant buildfile=\"${tck.dir}/bin/build.xml\" target=\"enable.ts.persistence.provider\" />\n                     </then>\n                     </if>\n-            \n+\n                     <echo>Calling TCK build.xml for pkg.dir=@{for.test}</echo>\n                     <property name=\"dir\" value=\"${tck.dir}/src/@{for.test}\" />\n                     <tsant dir=\"${dir}\" buildfile=\"${dir}/build.xml\" target=\"runclient\" tmo=\"${jpatck.run.tmo}\" />\n-            \n+\n                     <if>\n                         <contains string=\"@{for.test}\" substring=\"pluggability\"/>\n                     <then>\n@@ -356,7 +372,7 @@ databaseName=${db.name}\n                     </then>\n                     </if>\n                 </sequential>\n-            </for>          \n+            </for>\n         </then>\n         <else>\n             <echo>Calling TCK build.xml for ALL tests</echo>"},{"sha":"f814243152f9225b9f08c0d637f0dbd99dea58f6","filename":"pom.xml","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/35421424b5c30f2ffffcbd15e58db44017facaf4/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/35421424b5c30f2ffffcbd15e58db44017facaf4/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/pom.xml?ref=35421424b5c30f2ffffcbd15e58db44017facaf4","patch":"@@ -375,6 +375,8 @@\n                 <connection.password />\n                 <!-- Tests are much faster without shutting derby down at the end of each test. -->\n                 <jdbc.DBDictionary>ShutdownOnClose=false</jdbc.DBDictionary>\n+                <!-- TCK specific properties -->\n+                <tck.db.name>derby</tck.db.name>\n             </properties>\n         </profile>\n "}]}

