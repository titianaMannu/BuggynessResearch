{"sha":"37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","node_id":"MDY6Q29tbWl0MjA2MzY0OjM3Y2I0YWYzNWRlMjdjNzVhYzZmNWFjZmZhZWQwZjFiYTgyY2MxMmY=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2008-06-19T01:41:32Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2008-06-19T01:41:32Z"},"message":"OPENJPA-581: Print WARN level message on JNDI lookup failure\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@669356 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"1fd00e277a863ff499ab8da40477fe29fd4e8101","url":"https://api.github.com/repos/apache/openjpa/git/trees/1fd00e277a863ff499ab8da40477fe29fd4e8101"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","html_url":"https://github.com/apache/openjpa/commit/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","comments_url":"https://api.github.com/repos/apache/openjpa/commits/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/comments","author":null,"committer":null,"parents":[{"sha":"d1a165bc613d54bd9ff9baa2ca0fbca8305b70f0","url":"https://api.github.com/repos/apache/openjpa/commits/d1a165bc613d54bd9ff9baa2ca0fbca8305b70f0","html_url":"https://github.com/apache/openjpa/commit/d1a165bc613d54bd9ff9baa2ca0fbca8305b70f0"}],"stats":{"total":19,"additions":13,"deletions":6},"files":[{"sha":"917d6c48e6391cdc3f93eb466a05a753f6624302","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","status":"modified","additions":7,"deletions":4,"changes":11,"blob_url":"https://github.com/apache/openjpa/blob/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","raw_url":"https://github.com/apache/openjpa/raw/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java?ref=37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","patch":"@@ -944,19 +944,21 @@ public void setConnectionFactory(Object factory) {\n     public Object getConnectionFactory() {\n         if (connectionFactory.get() == null)\n             connectionFactory.set(\n-                lookupConnectionFactory(getConnectionFactoryName()), true);\n+                lookupConnectionFactory(getConnectionFactoryName(),\n+                \t\tconnectionFactory.getProperty()), true);\n         return connectionFactory.get();\n     }\n \n     /**\n      * Lookup the connection factory at the given name.\n      */\n-    private Object lookupConnectionFactory(String name) {\n+    private Object lookupConnectionFactory(String name, String userKey) {\n         name = StringUtils.trimToNull(name);\n         if (name == null)\n             return null;\n         try {\n-        \treturn Configurations.lookup(name);\n+        \treturn Configurations.lookup(name, userKey,\n+        \t\t\tgetLog(OpenJPAConfiguration.LOG_RUNTIME));\n         } catch (Exception ex) {\n         \treturn null;\n         }\n@@ -1027,7 +1029,8 @@ public void setConnectionFactory2(Object factory) {\n     public Object getConnectionFactory2() {\n         if (connectionFactory2.get() == null)\n             connectionFactory2.set(\n-                lookupConnectionFactory(getConnectionFactory2Name()), false);\n+                lookupConnectionFactory(getConnectionFactory2Name(), \n+                \t\tconnectionFactory2.getProperty()), false);\n         return connectionFactory2.get();\n     }\n "},{"sha":"d4e4202c3c1c945fd0eb7a76d0b67efaefefe745","filename":"openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java","status":"modified","additions":5,"deletions":2,"changes":7,"blob_url":"https://github.com/apache/openjpa/blob/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java","raw_url":"https://github.com/apache/openjpa/raw/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java?ref=37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","patch":"@@ -609,14 +609,17 @@ else if (val.startsWith(\"\\\"\") || val.startsWith(\"'\")) {\n     /**\r\n      * Looks up the given name in JNDI. If the name is null, null is returned.\r\n      */\r\n-    public static Object lookup(String name) {\r\n+    public static Object lookup(String name, String userKey, Log log) {\r\n         if (StringUtils.isEmpty(name))\r\n             return null;\r\n \r\n         Context ctx = null;\r\n         try {\r\n             ctx = new InitialContext();\r\n-            return ctx.lookup(name);\r\n+            Object result = ctx.lookup(name);\r\n+            if (result == null && log != null && log.isWarnEnabled())\r\n+            \tlog.warn(_loc.get(\"jndi-lookup-failed\", userKey, name));\r\n+            return result;\r\n         } catch (NamingException ne) {\r\n             throw new NestableRuntimeException(\r\n                 _loc.get(\"naming-err\", name).getMessage(), ne);\r"},{"sha":"e9a98f316fad7a69909d3890ee2e3709db48bb4c","filename":"openjpa-lib/src/main/resources/org/apache/openjpa/lib/conf/localizer.properties","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/openjpa-lib/src/main/resources/org/apache/openjpa/lib/conf/localizer.properties","raw_url":"https://github.com/apache/openjpa/raw/37cb4af35de27c75ac6f5acffaed0f1ba82cc12f/openjpa-lib/src/main/resources/org/apache/openjpa/lib/conf/localizer.properties","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-lib/src/main/resources/org/apache/openjpa/lib/conf/localizer.properties?ref=37cb4af35de27c75ac6f5acffaed0f1ba82cc12f","patch":"@@ -114,3 +114,4 @@ Id-expert: true\n \n veto-change: Can not modify \"{0}\" because the property is not dynamic and the \\\n \tcurrent configuration is read-only.\n+jndi-lookup-failed: JNDI lookup for \"{0}\" with key \"{1}\" returned null.\n\\ No newline at end of file"}]}

