{"sha":"38f41d870ee28de236a4bde5fa5331c04771eebf","node_id":"MDY6Q29tbWl0MjA2MzY0OjM4ZjQxZDg3MGVlMjhkZTIzNmE0YmRlNWZhNTMzMWMwNDc3MWVlYmY=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2007-12-10T20:11:22Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2007-12-10T20:11:22Z"},"message":"OPENJPA-462: Adding SQLState in DerbyDictionary to demonstrate specialization\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@603028 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"10183ce617a804c8efd3e544efb5d581b741c09c","url":"https://api.github.com/repos/apache/openjpa/git/trees/10183ce617a804c8efd3e544efb5d581b741c09c"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/38f41d870ee28de236a4bde5fa5331c04771eebf","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/38f41d870ee28de236a4bde5fa5331c04771eebf","html_url":"https://github.com/apache/openjpa/commit/38f41d870ee28de236a4bde5fa5331c04771eebf","comments_url":"https://api.github.com/repos/apache/openjpa/commits/38f41d870ee28de236a4bde5fa5331c04771eebf/comments","author":null,"committer":null,"parents":[{"sha":"a54f84262450b1cafe497ed0b058f1e9bd5f31bc","url":"https://api.github.com/repos/apache/openjpa/commits/a54f84262450b1cafe497ed0b058f1e9bd5f31bc","html_url":"https://github.com/apache/openjpa/commit/a54f84262450b1cafe497ed0b058f1e9bd5f31bc"}],"stats":{"total":33,"additions":32,"deletions":1},"files":[{"sha":"585ffd4e13e2f6c9ba0010cfcefc856e6d38dd21","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/apache/openjpa/blob/38f41d870ee28de236a4bde5fa5331c04771eebf/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/38f41d870ee28de236a4bde5fa5331c04771eebf/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java?ref=38f41d870ee28de236a4bde5fa5331c04771eebf","patch":"@@ -4033,7 +4033,11 @@ public OpenJPAException newStoreException(String msg, SQLException[] causes,\n      * {@link StoreException}.<br>\n      * JDBC Drivers are not uniform in return values of SQLState for the same\n      * error and hence each database specific Dictionary can specialize.<br>\n-     * Default behavior is to return an empty list. \n+     * \n+     * \n+     * @return an <em>unmodifiable</em> list of Strings representing supposedly \n+     * uniform SQL States for a given type of StoreException. \n+     * Default behavior is to return an empty list.\n      */\n     public List/*<String>*/ getSQLStates(int exceptionType) {\n     \tif (exceptionType>=0 && exceptionType<SQL_STATE_CODES.length)"},{"sha":"fc97ea35fd2b03919ade00ece0d60904c5f8f46b","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DerbyDictionary.java","status":"modified","additions":27,"deletions":0,"changes":27,"blob_url":"https://github.com/apache/openjpa/blob/38f41d870ee28de236a4bde5fa5331c04771eebf/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DerbyDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/38f41d870ee28de236a4bde5fa5331c04771eebf/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DerbyDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DerbyDictionary.java?ref=38f41d870ee28de236a4bde5fa5331c04771eebf","patch":"@@ -20,9 +20,14 @@\n \n import java.sql.DriverManager;\n import java.sql.SQLException;\n+import java.util.ArrayList;\n import java.util.Arrays;\n+import java.util.List;\n+\n import javax.sql.DataSource;\n \n+import org.apache.openjpa.util.StoreException;\n+\n /**\n  * Dictionary for Apache Derby (formerly Cloudscape).\n  */\n@@ -93,4 +98,26 @@ public void closeDataSource(DataSource dataSource) {\n             }\n         }\n     }\n+    \n+    /**\n+     * Adds extra SQLState code that Derby JDBC Driver uses. In JDBC 4.0,\n+     * SQLState will follow either XOPEN or SQL 2003 convention. A compliant\n+     * driver can be queries via DatabaseMetaData.getSQLStateType() to detect\n+     * the convention type.<br>\n+     * This method is overwritten to highlight that a) the SQL State is ideally\n+     * uniform across JDBC Drivers but not practically and b) the overwritten\n+     * method must crate a new list to return as the super classes list is\n+     * unmodifable.\n+     */\n+    public List getSQLStates(int exceptionType) {\n+    \tList original = super.getSQLStates(exceptionType);\n+    \tif (exceptionType == StoreException.LOCK) {\n+    \t\t// Can not add new codes to unmodifable list of the super class\n+    \t\tList newStates = new ArrayList(original);\n+    \t\tnewStates.add(\"40XL1\");\n+    \t\treturn newStates;\n+    \t}\n+    \treturn original;\n+    }\n+    \n }"}]}

