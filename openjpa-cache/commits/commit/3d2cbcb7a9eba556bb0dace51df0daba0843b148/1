{"sha":"3d2cbcb7a9eba556bb0dace51df0daba0843b148","node_id":"MDY6Q29tbWl0MjA2MzY0OjNkMmNiY2I3YTllYmE1NTZiYjBkYWNlNTFkZjBkYWJhMDg0M2IxNDg=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2008-02-15T04:44:48Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2008-02-15T04:44:48Z"},"message":"OPENJPA-515 Maintain thread-transaction affinity for bulk delete/update operation\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@627943 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"57df2bcf6625c17525e0b2b8472e6d0e5f0c7dd5","url":"https://api.github.com/repos/apache/openjpa/git/trees/57df2bcf6625c17525e0b2b8472e6d0e5f0c7dd5"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/3d2cbcb7a9eba556bb0dace51df0daba0843b148","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/3d2cbcb7a9eba556bb0dace51df0daba0843b148","html_url":"https://github.com/apache/openjpa/commit/3d2cbcb7a9eba556bb0dace51df0daba0843b148","comments_url":"https://api.github.com/repos/apache/openjpa/commits/3d2cbcb7a9eba556bb0dace51df0daba0843b148/comments","author":null,"committer":null,"parents":[{"sha":"11fba5a6123d00c60474673ecf55481f25b25ad5","url":"https://api.github.com/repos/apache/openjpa/commits/11fba5a6123d00c60474673ecf55481f25b25ad5","html_url":"https://github.com/apache/openjpa/commit/11fba5a6123d00c60474673ecf55481f25b25ad5"}],"stats":{"total":9,"additions":5,"deletions":4},"files":[{"sha":"9551256b479f24ea648b229d601d821a99636d3d","filename":"openjpa-slice/pom.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/3d2cbcb7a9eba556bb0dace51df0daba0843b148/openjpa-slice/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/3d2cbcb7a9eba556bb0dace51df0daba0843b148/openjpa-slice/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-slice/pom.xml?ref=3d2cbcb7a9eba556bb0dace51df0daba0843b148","patch":"@@ -155,14 +155,14 @@\n                 <!-- ======================================================= -->\r\n                 <!-- All tests are excluded currently                        -->\r\n                 <!-- ======================================================= -->\r\n-                <configuration>\r\n+                <!--  configuration>\r\n                      <includes>\r\n                         <include>**/DummyTest.java</include>\r\n                      </includes>\r\n                      <excludes>\r\n                         <exclude>**/Test*.java</exclude>\r\n                      </excludes>\r\n-                </configuration>\r\n+                </configuration -->\r\n            </plugin>\r\n             \r\n         </plugins>\r"},{"sha":"f3b33aa2aefebdcf68f5c785ced76fa4df1cdcc4","filename":"openjpa-slice/src/main/java/org/apache/openjpa/slice/jdbc/DistributedStoreQuery.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/apache/openjpa/blob/3d2cbcb7a9eba556bb0dace51df0daba0843b148/openjpa-slice/src/main/java/org/apache/openjpa/slice/jdbc/DistributedStoreQuery.java","raw_url":"https://github.com/apache/openjpa/raw/3d2cbcb7a9eba556bb0dace51df0daba0843b148/openjpa-slice/src/main/java/org/apache/openjpa/slice/jdbc/DistributedStoreQuery.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-slice/src/main/java/org/apache/openjpa/slice/jdbc/DistributedStoreQuery.java?ref=3d2cbcb7a9eba556bb0dace51df0daba0843b148","patch":"@@ -38,7 +38,6 @@\n import org.apache.openjpa.lib.rop.RangeResultObjectProvider;\r\n import org.apache.openjpa.lib.rop.ResultObjectProvider;\r\n import org.apache.openjpa.meta.ClassMetaData;\r\n-import org.apache.openjpa.slice.ProductDerivation;\r\n import org.apache.openjpa.util.StoreException;\r\n \r\n /**\r\n@@ -88,7 +87,7 @@ public ExecutorService getExecutorServiceInstance() {\n             ((DistributedJDBCConfiguration)getStore().getConfiguration());\r\n         return conf.getExecutorServiceInstance();\r\n     }\r\n-\r\n+    \r\n \t/**\r\n \t * Executes queries on multiple databases.\r\n \t * \r\n@@ -165,6 +164,7 @@ public ResultObjectProvider executeQuery(StoreQuery q,\n         \r\n         public Number executeDelete(StoreQuery q, Object[] params) {\r\n         \tIterator<StoreQuery> qs = owner._queries.iterator();\r\n+            owner.getStore().getContext().beginStore();\r\n         \tfinal List<Future<Number>> futures = new ArrayList<Future<Number>>();\r\n         \tfor (Executor ex:executors) {\r\n         \t\tDeleteExecutor call = new DeleteExecutor();\r\n@@ -190,6 +190,7 @@ public Number executeDelete(StoreQuery q, Object[] params) {\n         \r\n         public Number executeUpdate(StoreQuery q, Object[] params) {\r\n         \tIterator<StoreQuery> qs = owner._queries.iterator();\r\n+            owner.getStore().getContext().beginStore();\r\n         \tfinal List<Future<Number>> futures = new ArrayList<Future<Number>>();\r\n         \tfor (Executor ex:executors) {\r\n         \t\tUpdateExecutor call = new UpdateExecutor();\r"}]}

