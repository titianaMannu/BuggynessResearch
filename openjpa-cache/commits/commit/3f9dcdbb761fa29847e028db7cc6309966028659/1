{"sha":"3f9dcdbb761fa29847e028db7cc6309966028659","node_id":"MDY6Q29tbWl0MjA2MzY0OjNmOWRjZGJiNzYxZmEyOTg0N2UwMjhkYjdjYzYzMDk5NjYwMjg2NTk=","commit":{"author":{"name":"Catalina Wei","email":"fancy@apache.org","date":"2008-05-08T21:24:47Z"},"committer":{"name":"Catalina Wei","email":"fancy@apache.org","date":"2008-05-08T21:24:47Z"},"message":"OPENJPA-595 A common path() action in JPQL.jjt being used for Enum literal causes a simple aliase resolution to fail\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@654626 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"75bc08bc088c0f5f5b91446865f6798e5dc419e7","url":"https://api.github.com/repos/apache/openjpa/git/trees/75bc08bc088c0f5f5b91446865f6798e5dc419e7"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/3f9dcdbb761fa29847e028db7cc6309966028659","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/3f9dcdbb761fa29847e028db7cc6309966028659","html_url":"https://github.com/apache/openjpa/commit/3f9dcdbb761fa29847e028db7cc6309966028659","comments_url":"https://api.github.com/repos/apache/openjpa/commits/3f9dcdbb761fa29847e028db7cc6309966028659/comments","author":null,"committer":null,"parents":[{"sha":"b796e1710f4572bee7e20f8e7c2851205ddbb8b2","url":"https://api.github.com/repos/apache/openjpa/commits/b796e1710f4572bee7e20f8e7c2851205ddbb8b2","html_url":"https://github.com/apache/openjpa/commit/b796e1710f4572bee7e20f8e7c2851205ddbb8b2"}],"stats":{"total":10,"additions":8,"deletions":2},"files":[{"sha":"5678aed24c84ea2c88dbfaa03bcd3dc940414ce9","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java","status":"modified","additions":5,"deletions":2,"changes":7,"blob_url":"https://github.com/apache/openjpa/blob/3f9dcdbb761fa29847e028db7cc6309966028659/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java","raw_url":"https://github.com/apache/openjpa/raw/3f9dcdbb761fa29847e028db7cc6309966028659/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java?ref=3f9dcdbb761fa29847e028db7cc6309966028659","patch":"@@ -1322,8 +1322,11 @@ private Value getPathOrConstant(JPQLNode node) {\n                 Object value = field.get(null);\n                 return factory.newLiteral(value, Literal.TYPE_UNKNOWN);\n             } catch (NoSuchFieldException nsfe) {\n-                throw parseException(EX_USER, \"no-field\",\n-                    new Object[]{ c.getName(), fieldName }, nsfe);\n+                if (node.parser.inEnumPath)\n+                    throw parseException(EX_USER, \"no-field\",\n+                        new Object[]{ c.getName(), fieldName }, nsfe);\n+                else\n+                    return getPath(node, false, true);\n             } catch (Exception e) {\n                 throw parseException(EX_USER, \"unaccessible-field\",\n                     new Object[]{ className, fieldName }, e);"},{"sha":"a77d7ba16282693e659e4048b5ae927a37aa5617","filename":"openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/apache/openjpa/blob/3f9dcdbb761fa29847e028db7cc6309966028659/openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt","raw_url":"https://github.com/apache/openjpa/raw/3f9dcdbb761fa29847e028db7cc6309966028659/openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt?ref=3f9dcdbb761fa29847e028db7cc6309966028659","patch":"@@ -64,6 +64,7 @@ import java.io.*;\n public class JPQL\n {\n \tString jpql;\n+\tboolean inEnumPath;\n \n \n \tpublic JPQL (String jpql)\n@@ -968,7 +969,9 @@ void enum_primary() : { }\n \n void enum_literal() : { }\n {\n+\t{ inEnumPath = true; }\n \tpath()\n+\t{ inEnumPath = false; }\n }\n \n "}]}

