{"sha":"414a5d474ded76552c2da2e70be0702a7efc426c","node_id":"MDY6Q29tbWl0MjA2MzY0OjQxNGE1ZDQ3NGRlZDc2NTUyYzJkYTJlNzBiZTA3MDJhN2VmYzQyNmM=","commit":{"author":{"name":"Srinivasa Segu","email":"ssegu@apache.org","date":"2006-12-22T20:38:01Z"},"committer":{"name":"Srinivasa Segu","email":"ssegu@apache.org","date":"2006-12-22T20:38:01Z"},"message":"Reset the SM to the old value, instead of nulling out.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@489750 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"d90ce74be44dea9f0ced415fcd050684e919ab7d","url":"https://api.github.com/repos/apache/openjpa/git/trees/d90ce74be44dea9f0ced415fcd050684e919ab7d"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/414a5d474ded76552c2da2e70be0702a7efc426c","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/414a5d474ded76552c2da2e70be0702a7efc426c","html_url":"https://github.com/apache/openjpa/commit/414a5d474ded76552c2da2e70be0702a7efc426c","comments_url":"https://api.github.com/repos/apache/openjpa/commits/414a5d474ded76552c2da2e70be0702a7efc426c/comments","author":null,"committer":null,"parents":[{"sha":"8b6406724b5a9cd55a911eb5df394dd7b21bb18d","url":"https://api.github.com/repos/apache/openjpa/commits/8b6406724b5a9cd55a911eb5df394dd7b21bb18d","html_url":"https://github.com/apache/openjpa/commit/8b6406724b5a9cd55a911eb5df394dd7b21bb18d"}],"stats":{"total":3,"additions":2,"deletions":1},"files":[{"sha":"f9cf0416c2c1242de57095d46bfe60e67f12ccae","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/kernel/VersionAttachStrategy.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/apache/openjpa/blob/414a5d474ded76552c2da2e70be0702a7efc426c/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/VersionAttachStrategy.java","raw_url":"https://github.com/apache/openjpa/raw/414a5d474ded76552c2da2e70be0702a7efc426c/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/VersionAttachStrategy.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/VersionAttachStrategy.java?ref=414a5d474ded76552c2da2e70be0702a7efc426c","patch":"@@ -119,6 +119,7 @@ public Object attach(AttachManager manager, Object toAttach,\n \n         // assign the detached pc the same state manager as the object we're\n         // copying into during the attach process\n+        StateManager smBefore = pc.pcGetStateManager();\n         pc.pcReplaceStateManager(sm);\n         int detach = (isNew) ? DETACH_ALL : broker.getDetachState();\n         FetchConfiguration fetch = broker.getFetchConfiguration();\n@@ -139,7 +140,7 @@ public Object attach(AttachManager manager, Object toAttach,\n                 }\n             }\n         } finally {\n-            pc.pcReplaceStateManager(null);\n+            pc.pcReplaceStateManager(smBefore);\n         }\n         if (!embedded && !isNew)\n             compareVersion(sm, pc);"}]}

