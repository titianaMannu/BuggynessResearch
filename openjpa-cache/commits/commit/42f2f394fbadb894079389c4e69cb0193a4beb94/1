{"sha":"42f2f394fbadb894079389c4e69cb0193a4beb94","node_id":"MDY6Q29tbWl0MjA2MzY0OjQyZjJmMzk0ZmJhZGI4OTQwNzkzODljNGU2OWNiMDE5M2E0YmViOTQ=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2008-08-25T23:28:31Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2008-08-25T23:28:31Z"},"message":"OPENJPA-705: Secondary table for Embdded field is to be looked up in the owner's secondary table.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@688919 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"55eebac12b9c272e0d09ffbf9f57d75fe39237a7","url":"https://api.github.com/repos/apache/openjpa/git/trees/55eebac12b9c272e0d09ffbf9f57d75fe39237a7"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/42f2f394fbadb894079389c4e69cb0193a4beb94","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/42f2f394fbadb894079389c4e69cb0193a4beb94","html_url":"https://github.com/apache/openjpa/commit/42f2f394fbadb894079389c4e69cb0193a4beb94","comments_url":"https://api.github.com/repos/apache/openjpa/commits/42f2f394fbadb894079389c4e69cb0193a4beb94/comments","author":null,"committer":null,"parents":[{"sha":"36abd7cb6233fdcc9aba8154e72d81c32f6207e5","url":"https://api.github.com/repos/apache/openjpa/commits/36abd7cb6233fdcc9aba8154e72d81c32f6207e5","html_url":"https://github.com/apache/openjpa/commit/36abd7cb6233fdcc9aba8154e72d81c32f6207e5"}],"stats":{"total":15,"additions":12,"deletions":3},"files":[{"sha":"93ffd53ad2136a0331f097a5fbf2e95960252343","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/FieldMappingInfo.java","status":"modified","additions":12,"deletions":3,"changes":15,"blob_url":"https://github.com/apache/openjpa/blob/42f2f394fbadb894079389c4e69cb0193a4beb94/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/FieldMappingInfo.java","raw_url":"https://github.com/apache/openjpa/raw/42f2f394fbadb894079389c4e69cb0193a4beb94/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/FieldMappingInfo.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/FieldMappingInfo.java?ref=42f2f394fbadb894079389c4e69cb0193a4beb94","patch":"@@ -153,11 +153,20 @@ public String get(Schema schema) {\n     public ForeignKey getJoin(final FieldMapping field, Table table,\n         boolean adapt) {\n         // if we have no join columns defined, check class-level join\n+    \t// if the given field is embedded then consider primary table of owner\n         List cols = getColumns();\n-        if (cols.isEmpty())\n-            cols = field.getDefiningMapping().getMappingInfo().\n+        if (cols.isEmpty()) {\n+        \tClassMapping mapping;\n+        \tif (field.isEmbedded() && \n+        \t\tfield.getDeclaringMapping().getEmbeddingMapping() != null) {\n+        \t\tmapping = field.getDeclaringMapping().getEmbeddingMapping()\n+        \t\t\t.getFieldMapping().getDeclaringMapping();\n+        \t} else {\n+        \t\tmapping = field.getDefiningMapping();\n+        \t}\n+            cols = mapping.getMappingInfo().\n                 getSecondaryTableJoinColumns(_tableName);\n-\n+        }\n         ForeignKeyDefaults def = new ForeignKeyDefaults() {\n             public ForeignKey get(Table local, Table foreign, boolean inverse) {\n                 return field.getMappingRepository().getMappingDefaults()."}]}

