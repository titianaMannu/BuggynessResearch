{"sha":"4555af14af5256c0c30d39646d69be7b67ec0ca7","node_id":"MDY6Q29tbWl0MjA2MzY0OjQ1NTVhZjE0YWY1MjU2YzBjMzBkMzk2NDZkNjliZTdiNjdlYzBjYTc=","commit":{"author":{"name":"Albert Lee","email":"allee8285@apache.org","date":"2010-04-07T18:21:13Z"},"committer":{"name":"Albert Lee","email":"allee8285@apache.org","date":"2010-04-07T18:21:13Z"},"message":"OPENJPA-1609 - Commit contribution by Jody Grassel.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@931635 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"367b9768e6409956c37a13151746ae4d517841e6","url":"https://api.github.com/repos/apache/openjpa/git/trees/367b9768e6409956c37a13151746ae4d517841e6"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/4555af14af5256c0c30d39646d69be7b67ec0ca7","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/4555af14af5256c0c30d39646d69be7b67ec0ca7","html_url":"https://github.com/apache/openjpa/commit/4555af14af5256c0c30d39646d69be7b67ec0ca7","comments_url":"https://api.github.com/repos/apache/openjpa/commits/4555af14af5256c0c30d39646d69be7b67ec0ca7/comments","author":null,"committer":null,"parents":[{"sha":"afa1e44f81246425dfe9caee7fe7f4027f171b6f","url":"https://api.github.com/repos/apache/openjpa/commits/afa1e44f81246425dfe9caee7fe7f4027f171b6f","html_url":"https://github.com/apache/openjpa/commit/afa1e44f81246425dfe9caee7fe7f4027f171b6f"}],"stats":{"total":12,"additions":11,"deletions":1},"files":[{"sha":"0423444343ec97a59004512c5d76b19676d5be75","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","status":"modified","additions":11,"deletions":1,"changes":12,"blob_url":"https://github.com/apache/openjpa/blob/4555af14af5256c0c30d39646d69be7b67ec0ca7/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/4555af14af5256c0c30d39646d69be7b67ec0ca7/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java?ref=4555af14af5256c0c30d39646d69be7b67ec0ca7","patch":"@@ -929,8 +929,18 @@ public boolean isFatalException(int subtype, SQLException ex) {\n         int errorCode = ex.getErrorCode();\n         if (errorCode == -952 && \"57014\".equals(errorState))\n             return false;\n+        /*\n+         * Check if this Exception was generated by a lock timeout expiration.\n+         * The following criteria are used to determine this:\n+         * \n+         * DB2 LUW Infocenter: SQLSTATE=57033 with reason code \"80\" indicates\n+         * the statement failed due to timeout. DB2 for z/OS Stored Procedures:\n+         * Through the CALL and Beyond, page 188: An ErrorCode of -913 with\n+         * SQLERR 00C9008E means a timeout has occurred.\n+         */\n         if (subtype == StoreException.LOCK && \"57033\".equals(errorState)\n-            && ex.getMessage().indexOf(\"80\") != -1) {\n+            && ((ex.getMessage().indexOf(\"80\") != -1) \n+                || (errorCode == -913 && ex.getMessage().contains(\"00C9008E\")))) {\n             return false;\n         } \n         if ((subtype == StoreException.QUERY && \"57014\".equals(errorState) &&"}]}

