{"sha":"4a546f759cee4220495e4206abc3c0503af204fa","node_id":"MDY6Q29tbWl0MjA2MzY0OjRhNTQ2Zjc1OWNlZTQyMjA0OTVlNDIwNmFiYzNjMDUwM2FmMjA0ZmE=","commit":{"author":{"name":"Romain Manni-Bucau","email":"rmannibucau@gmail.com","date":"2020-09-30T11:43:55Z"},"committer":{"name":"Romain Manni-Bucau","email":"rmannibucau@gmail.com","date":"2020-09-30T11:43:55Z"},"message":"[OPENJPA-2834] ensure setProperty invalid properties cache in em","tree":{"sha":"edcfd50c67cee8f2201befaf6ce54ee528b50acd","url":"https://api.github.com/repos/apache/openjpa/git/trees/edcfd50c67cee8f2201befaf6ce54ee528b50acd"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/4a546f759cee4220495e4206abc3c0503af204fa","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/4a546f759cee4220495e4206abc3c0503af204fa","html_url":"https://github.com/apache/openjpa/commit/4a546f759cee4220495e4206abc3c0503af204fa","comments_url":"https://api.github.com/repos/apache/openjpa/commits/4a546f759cee4220495e4206abc3c0503af204fa/comments","author":{"login":"rmannibucau","id":1249546,"node_id":"MDQ6VXNlcjEyNDk1NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1249546?v=4","gravatar_id":"","url":"https://api.github.com/users/rmannibucau","html_url":"https://github.com/rmannibucau","followers_url":"https://api.github.com/users/rmannibucau/followers","following_url":"https://api.github.com/users/rmannibucau/following{/other_user}","gists_url":"https://api.github.com/users/rmannibucau/gists{/gist_id}","starred_url":"https://api.github.com/users/rmannibucau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmannibucau/subscriptions","organizations_url":"https://api.github.com/users/rmannibucau/orgs","repos_url":"https://api.github.com/users/rmannibucau/repos","events_url":"https://api.github.com/users/rmannibucau/events{/privacy}","received_events_url":"https://api.github.com/users/rmannibucau/received_events","type":"User","site_admin":false},"committer":{"login":"rmannibucau","id":1249546,"node_id":"MDQ6VXNlcjEyNDk1NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1249546?v=4","gravatar_id":"","url":"https://api.github.com/users/rmannibucau","html_url":"https://github.com/rmannibucau","followers_url":"https://api.github.com/users/rmannibucau/followers","following_url":"https://api.github.com/users/rmannibucau/following{/other_user}","gists_url":"https://api.github.com/users/rmannibucau/gists{/gist_id}","starred_url":"https://api.github.com/users/rmannibucau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmannibucau/subscriptions","organizations_url":"https://api.github.com/users/rmannibucau/orgs","repos_url":"https://api.github.com/users/rmannibucau/repos","events_url":"https://api.github.com/users/rmannibucau/events{/privacy}","received_events_url":"https://api.github.com/users/rmannibucau/received_events","type":"User","site_admin":false},"parents":[{"sha":"758b8667061494392ad3ca30d0737191e31f64fe","url":"https://api.github.com/repos/apache/openjpa/commits/758b8667061494392ad3ca30d0737191e31f64fe","html_url":"https://github.com/apache/openjpa/commit/758b8667061494392ad3ca30d0737191e31f64fe"}],"stats":{"total":9,"additions":6,"deletions":3},"files":[{"sha":"ff06de69195a1408e624ab9480b6f43c468abc05","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerFactoryImpl.java","status":"modified","additions":5,"deletions":3,"changes":8,"blob_url":"https://github.com/apache/openjpa/blob/4a546f759cee4220495e4206abc3c0503af204fa/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerFactoryImpl.java","raw_url":"https://github.com/apache/openjpa/raw/4a546f759cee4220495e4206abc3c0503af204fa/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerFactoryImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerFactoryImpl.java?ref=4a546f759cee4220495e4206abc3c0503af204fa","patch":"@@ -281,9 +281,11 @@ else if (!props.isEmpty()) {\n         OpenJPAEntityManagerSPI em = newEntityManagerImpl(broker);\n \n         // allow setting of other bean properties of EM\n-        Set<Map.Entry> entrySet = props.entrySet();\n-        for (Map.Entry entry : entrySet) {\n-            em.setProperty(entry.getKey().toString(), entry.getValue());\n+        if (!props.isEmpty()) {\n+            Set<Map.Entry> entrySet = props.entrySet();\n+            for (Map.Entry entry : entrySet) {\n+                em.setProperty(entry.getKey().toString(), entry.getValue());\n+            }\n         }\n         if (canCacheGetProperties) {\n             if (emEmptyPropsProperties == null) {"},{"sha":"1a171ddc5847de0e43db62e7a4e2089a01157f54","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/4a546f759cee4220495e4206abc3c0503af204fa/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java","raw_url":"https://github.com/apache/openjpa/raw/4a546f759cee4220495e4206abc3c0503af204fa/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java?ref=4a546f759cee4220495e4206abc3c0503af204fa","patch":"@@ -2121,6 +2121,7 @@ public Metamodel getMetamodel() {\n      */\n     @Override\n     public void setProperty(String prop, Object value) {\n+        properties = null;\n         if (!setKernelProperty(this, prop, value)) {\n             if (!setKernelProperty(this.getFetchPlan(), prop, value)) {\n                 Log log = getConfiguration().getLog(OpenJPAConfiguration.LOG_RUNTIME);"}]}

