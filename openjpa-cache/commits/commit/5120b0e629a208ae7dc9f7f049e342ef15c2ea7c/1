{"sha":"5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","node_id":"MDY6Q29tbWl0MjA2MzY0OjUxMjBiMGU2MjlhMjA4YWU3ZGM5ZjdmMDQ5ZTM0MmVmMTVjMmVhN2M=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2009-09-11T22:12:18Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2009-09-11T22:12:18Z"},"message":"OPENJPA-1294: Allow a new connection to obtain query for size of the result set when the original connection is still being open.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@814053 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"e5e16d29d4b5e5f771d74b04cc2f7e8d6071d8a1","url":"https://api.github.com/repos/apache/openjpa/git/trees/e5e16d29d4b5e5f771d74b04cc2f7e8d6071d8a1"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","html_url":"https://github.com/apache/openjpa/commit/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","comments_url":"https://api.github.com/repos/apache/openjpa/commits/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/comments","author":null,"committer":null,"parents":[{"sha":"1e77f6a3e1492e289ce99b071376cdd3e90372cd","url":"https://api.github.com/repos/apache/openjpa/commits/1e77f6a3e1492e289ce99b071376cdd3e90372cd","html_url":"https://github.com/apache/openjpa/commit/1e77f6a3e1492e289ce99b071376cdd3e90372cd"}],"stats":{"total":14,"additions":13,"deletions":1},"files":[{"sha":"f924cbfb361a95eabdea16e17e4080af8d6c4673","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java","status":"modified","additions":8,"deletions":0,"changes":8,"blob_url":"https://github.com/apache/openjpa/blob/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java","raw_url":"https://github.com/apache/openjpa/raw/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/JDBCStoreManager.java?ref=5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","patch":"@@ -902,6 +902,14 @@ private void connect(boolean ref) {\n     protected RefCountConnection connectInternal() throws SQLException {\n         return ConcreteClassGenerator.newInstance(refCountConnectionImpl, JDBCStoreManager.this, _ds.getConnection());\n     }\n+    \n+    public Connection getNewConnection() {\n+        try {\n+            return connectInternal();\n+        } catch (SQLException e) {\n+            throw SQLExceptions.getStore(e, _dict);\n+        }\n+    }\n \n     /**\n      * Find the object with the given oid."},{"sha":"bf250b3f9155737edfca2e8570beb6ea57596391","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java","raw_url":"https://github.com/apache/openjpa/raw/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java?ref=5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","patch":"@@ -329,7 +329,7 @@ public int getCount(JDBCStore store)\n         ResultSet rs = null;\n         try {\n             SQLBuffer sql = toSelectCount();\n-            conn = store.getConnection();\n+            conn = store.getNewConnection();\n             stmnt = prepareStatement(conn, sql, null, \n                 ResultSet.TYPE_FORWARD_ONLY, \n                 ResultSet.CONCUR_READ_ONLY, false);"},{"sha":"ab01c25871a2d05076c88c52242c0ba0439313cd","filename":"openjpa-jdbc/src/test/java/org/apache/openjpa/jdbc/kernel/TestUpdateManagerFlushException.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/openjpa-jdbc/src/test/java/org/apache/openjpa/jdbc/kernel/TestUpdateManagerFlushException.java","raw_url":"https://github.com/apache/openjpa/raw/5120b0e629a208ae7dc9f7f049e342ef15c2ea7c/openjpa-jdbc/src/test/java/org/apache/openjpa/jdbc/kernel/TestUpdateManagerFlushException.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/test/java/org/apache/openjpa/jdbc/kernel/TestUpdateManagerFlushException.java?ref=5120b0e629a208ae7dc9f7f049e342ef15c2ea7c","patch":"@@ -861,6 +861,10 @@ public Connection getConnection() {\n             throw new RuntimeException(\"TestConnection is abstract for JDK6\");\n //            return new TestConnection();\n         }\n+        \n+        public Connection getNewConnection() {\n+            return getConnection();\n+        }\n \n         public StoreContext getContext() {\n             return null;"}]}

