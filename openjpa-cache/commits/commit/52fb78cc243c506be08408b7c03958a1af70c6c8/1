{"sha":"52fb78cc243c506be08408b7c03958a1af70c6c8","node_id":"MDY6Q29tbWl0MjA2MzY0OjUyZmI3OGNjMjQzYzUwNmJlMDg0MDhiN2MwMzk1OGExYWY3MGM2Yzg=","commit":{"author":{"name":"Kevin W. Sutter","email":"kwsutter@apache.org","date":"2013-01-22T23:36:10Z"},"committer":{"name":"Kevin W. Sutter","email":"kwsutter@apache.org","date":"2013-01-22T23:36:10Z"},"message":"OPENJPA-2326. A couple of updates to pom.xml and tck2-20110815.xml to make execution of the TCK more straight forward.  I'm still experiencing some hiccups, but we're getting closer...\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1437236 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"efdebcf4f4f37f2f8bc6c47e0855c7e92440ad58","url":"https://api.github.com/repos/apache/openjpa/git/trees/efdebcf4f4f37f2f8bc6c47e0855c7e92440ad58"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/52fb78cc243c506be08408b7c03958a1af70c6c8","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/52fb78cc243c506be08408b7c03958a1af70c6c8","html_url":"https://github.com/apache/openjpa/commit/52fb78cc243c506be08408b7c03958a1af70c6c8","comments_url":"https://api.github.com/repos/apache/openjpa/commits/52fb78cc243c506be08408b7c03958a1af70c6c8/comments","author":null,"committer":null,"parents":[{"sha":"e12dcddc388e417102a4d0f6db39060a25c232e6","url":"https://api.github.com/repos/apache/openjpa/commits/e12dcddc388e417102a4d0f6db39060a25c232e6","html_url":"https://github.com/apache/openjpa/commit/e12dcddc388e417102a4d0f6db39060a25c232e6"}],"stats":{"total":47,"additions":28,"deletions":19},"files":[{"sha":"599219c1394624a45a5b3d3c831654b78f18150c","filename":"openjpa-integration/tck/pom.xml","status":"modified","additions":7,"deletions":5,"changes":12,"blob_url":"https://github.com/apache/openjpa/blob/52fb78cc243c506be08408b7c03958a1af70c6c8/openjpa-integration/tck/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/52fb78cc243c506be08408b7c03958a1af70c6c8/openjpa-integration/tck/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/pom.xml?ref=52fb78cc243c506be08408b7c03958a1af70c6c8","patch":"@@ -48,7 +48,7 @@\n     property to specify the parent directory of the tests you want to run.\n     E.g.:\n \n-        mvn integration-test -Ptck-profile -Djpatck.pkg.dir=com/sun/ts/tests/ejb30/persistence/inheritance/mappedsc/descriptors\n+        mvn integration-test -Ptck2-profile -Djpatck.pkg.dir=com/sun/ts/tests/ejb30/persistence/inheritance/mappedsc/descriptors\n \n     You can also run using another database (e.g., oracle) using command\n     line properties. For example:\n@@ -57,7 +57,7 @@\n \n     The TCK running process will do the following:\n \n-    1. Fine the TCK zip file and extract it\n+    1. Find the TCK zip file and extract it\n     2. Create an openjpa-provier.properties file with the OpenJPA config\n     3. Modify the TCK's main configuration file (ts.jte) to use OpenJPA\n     4. Run the database initialization script\n@@ -85,8 +85,7 @@\n     <description>OpenJPA Integration Tests - JPA TCK</description>\n \n     <properties>\n-        <openjpa.Log>DefaultLevel=WARN</openjpa.Log>\n-        <tck2.level>20101205</tck2.level>\n+        <tck2.level>20110815</tck2.level>\n     </properties>\n \n     <build>\n@@ -186,7 +185,10 @@\n                         <path id=\"cp\">\n                             <path refid=\"maven.compile.classpath\" />\n                         </path>\n-\n+                        \n+                        <!-- create missing directory for maven compile classpath -->\n+                        <mkdir dir=\"${basedir}/target/classes\" />\n+                        \n                         <ant antfile=\"${basedir}/tck2-${tck2.level}.xml\" inheritRefs=\"true\">\n                             <target name=\"run-tck\" />\n                         </ant>"},{"sha":"06bf92386dd8664e50e2d3eb716e49e9bb916221","filename":"openjpa-integration/tck/tck2-20110815.xml","status":"modified","additions":21,"deletions":14,"changes":35,"blob_url":"https://github.com/apache/openjpa/blob/52fb78cc243c506be08408b7c03958a1af70c6c8/openjpa-integration/tck/tck2-20110815.xml","raw_url":"https://github.com/apache/openjpa/raw/52fb78cc243c506be08408b7c03958a1af70c6c8/openjpa-integration/tck/tck2-20110815.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/tck/tck2-20110815.xml?ref=52fb78cc243c506be08408b7c03958a1af70c6c8","patch":"@@ -58,21 +58,20 @@\n         <property name=\"tck.zip\" value=\"${LOCAL_M2_REPO}/../privaterepos/${tck.level}.zip\" />\n         <available property=\"tck.available\" file=\"${tck.zip}\" />\n         <fail unless=\"tck.available\">The TCK file specified in the \"tck.zip\" system property (${tck.zip}) does not exist. This file must be downloaded separately in order to be able to run the JPA 2.0 TCK</fail>\n-\n+<!--\n         <property name=\"tck_config.zip\" value=\"${LOCAL_M2_REPO}/../privaterepos/${tck.level}_config.zip\" />\n         <available property=\"tck_config.available\" file=\"${tck_config.zip}\" />\n         <fail unless=\"tck_config.available\">The TCK config file specified in the \"tck_config.zip\" system property (${tck_config.zip}) does not exist. This file must be downloaded separately in order to be able to run the JPA 2.0 TCK</fail>\n \n-<!--\n         <property name=\"tck_patches.zip\" value=\"${LOCAL_M2_REPO}/../privaterepos/${tck.level}_patches.zip\" />\n         <available property=\"tck_patches.available\" file=\"${tck_patches.zip}\" />\n         <fail unless=\"tck_patches.available\">The TCK patches file specified in the \"tck_patches.zip\" system property (${tck_patches.zip}) does not exist. This file must be downloaded separately in order to be able to run the JPA 2.0 TCK</fail>\n -->\n \n         <delete dir=\"${tck.dir}\" />\n         <unzip overwrite=\"false\" src=\"${tck.zip}\" dest=\"${tck.base}\" />\n-        <unzip overwrite=\"true\" src=\"${tck_config.zip}\" dest=\"${tck.base}\" />\n <!--\n+        <unzip overwrite=\"true\" src=\"${tck_config.zip}\" dest=\"${tck.base}\" />\n         <unzip overwrite=\"true\" src=\"${tck_patches.zip}\" dest=\"${tck.base}\" />\n -->\n         <copy overwrite=\"true\"\n@@ -118,9 +117,17 @@ openjpa.Compatibility: StrictIdentityValues=true\n openjpa.Sequence: time\n openjpa.Log: ${openjpa.Log}\n openjpa.jdbc.DBDictionary: StoreCharsAsNumbers=true\n+# openjpa.jdbc.DBDictionary: (StoreCharsAsNumbers=true,NumericTypeName=DECIMAL)\n openjpa.jdbc.SchemaFactory: native(ForeignKeys=true)\n openjpa.jdbc.SynchronizeMappings: buildSchema(ForeignKeys=true)\n         </echo>\n+        \n+        <path id=\"javart\">\n+            <fileset dir=\"${java.home}/lib\">\n+              <include name=\"**/*.jar\" />\n+            </fileset>\n+        </path>\n+        <pathconvert property=\"javart.property\" refid=\"javart\" />\n \n         <!-- Append OpenJPA-specific configuration -->\n         <property name=\"jpatck.config\" value=\"${tck.dir}/bin/ts.jte\" />\n@@ -144,7 +151,7 @@ toplink.properties=${toplink.properties}\n # Need to specify java.* classes, both in Windows/UNIX locations as well as Mac.\n # This includes a few different possible locations; only one of them needs to\n # actually work for a given environment.\n-sigTestClasspath=${JAVA_HOME}/lib/rt.jar${path.separator}${JAVA_HOME}/jre/lib/rt.jar${path.separator}${JAVA_HOME}/../Classes/classes.jar${path.separator}$${jpa.classes}\n+sigTestClasspath=${javart.property}${path.separator}${cp.property}\n persistence.unit.properties.file.full.path=${provider.properties}\n database.user=${db.username}\n database.passwd=${db.password}\n@@ -320,36 +327,36 @@ databaseName=${db.name}\n         <property name=\"jpatck.run.tmo\" value=\"7200000\" />\n         <!-- now run the TCK -->\n         <if>\n-        \t<and>\n+            <and>\n                 <isset property=\"jpatck.pkg.dir\" />\n-        \t\t<not>\n-        \t\t\t<length string=\"${jpatck.pkg.dir}\" trim=\"true\" length=\"0\" /> \n-        \t\t</not>\n+                <not>\n+                    <length string=\"${jpatck.pkg.dir}\" trim=\"true\" length=\"0\" /> \n+                </not>\n             </and>\n         <then>\n             <for list=\"${jpatck.pkg.dir}\" param=\"for.test\" trim=\"true\">\n-                <sequential>        \t\n-        \t        <if>\n+                <sequential>            \n+                    <if>\n                         <contains string=\"@{for.test}\" substring=\"pluggability\"/>\n                     <then>\n                         <echo>Calling enable.ts.persistence.provider for pluggability test.</echo>\n                         <tsant buildfile=\"${tck.dir}/bin/build.xml\" target=\"enable.ts.persistence.provider\" />\n                     </then>\n                     </if>\n-        \t\n+            \n                     <echo>Calling TCK build.xml for pkg.dir=@{for.test}</echo>\n                     <property name=\"dir\" value=\"${tck.dir}/src/@{for.test}\" />\n                     <tsant dir=\"${dir}\" buildfile=\"${dir}/build.xml\" target=\"runclient\" tmo=\"${jpatck.run.tmo}\" />\n-        \t\n-        \t        <if>\n+            \n+                    <if>\n                         <contains string=\"@{for.test}\" substring=\"pluggability\"/>\n                     <then>\n                         <echo>Calling disable.ts.persistence.provider for pluggability test.</echo>\n                         <tsant buildfile=\"${tck.dir}/bin/build.xml\" target=\"disable.ts.persistence.provider\" />\n                     </then>\n                     </if>\n                 </sequential>\n-            </for>        \t\n+            </for>          \n         </then>\n         <else>\n             <echo>Calling TCK build.xml for ALL tests</echo>"}]}

