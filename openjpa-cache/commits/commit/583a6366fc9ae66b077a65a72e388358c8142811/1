{"sha":"583a6366fc9ae66b077a65a72e388358c8142811","node_id":"MDY6Q29tbWl0MjA2MzY0OjU4M2E2MzY2ZmM5YWU2NmIwNzdhNjVhNzJlMzg4MzU4YzgxNDI4MTE=","commit":{"author":{"name":"Milosz Tylenda","email":"mtylenda@apache.org","date":"2009-12-01T22:06:49Z"},"committer":{"name":"Milosz Tylenda","email":"mtylenda@apache.org","date":"2009-12-01T22:06:49Z"},"message":"Fix TestMultipleSchemaNames so that schemas are created on PostgreSQL\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@885965 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"aaa69c2d1a617724e836b7a75fa2750e7c710cfa","url":"https://api.github.com/repos/apache/openjpa/git/trees/aaa69c2d1a617724e836b7a75fa2750e7c710cfa"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/583a6366fc9ae66b077a65a72e388358c8142811","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/583a6366fc9ae66b077a65a72e388358c8142811","html_url":"https://github.com/apache/openjpa/commit/583a6366fc9ae66b077a65a72e388358c8142811","comments_url":"https://api.github.com/repos/apache/openjpa/commits/583a6366fc9ae66b077a65a72e388358c8142811/comments","author":null,"committer":null,"parents":[{"sha":"bc7da9765803de2193c5dbb26184981952faf5d5","url":"https://api.github.com/repos/apache/openjpa/commits/bc7da9765803de2193c5dbb26184981952faf5d5","html_url":"https://github.com/apache/openjpa/commit/bc7da9765803de2193c5dbb26184981952faf5d5"}],"stats":{"total":16,"additions":8,"deletions":8},"files":[{"sha":"e38591f9fb4e831e0a5efd786563ffae0d776af6","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java","status":"modified","additions":8,"deletions":8,"changes":16,"blob_url":"https://github.com/apache/openjpa/blob/583a6366fc9ae66b077a65a72e388358c8142811/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java","raw_url":"https://github.com/apache/openjpa/raw/583a6366fc9ae66b077a65a72e388358c8142811/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/generationtype/TestMultipleSchemaNames.java?ref=583a6366fc9ae66b077a65a72e388358c8142811","patch":"@@ -38,15 +38,13 @@\n \n public class TestMultipleSchemaNames extends SingleEMFTestCase {\n \n-    static private DBDictionary dict = null;\n-    \n     public void setUp() {\n         // Need to skip tests on MySQL, Oracle and MS SQL Server\n         // See createSchemas() comment at the bottom\n         setUnsupportedDatabases(\n-                org.apache.openjpa.jdbc.sql.MySQLDictionary.class,\n-                org.apache.openjpa.jdbc.sql.OracleDictionary.class,\n-                org.apache.openjpa.jdbc.sql.SQLServerDictionary.class);\n+                MySQLDictionary.class,\n+                OracleDictionary.class,\n+                SQLServerDictionary.class);\n         if (isTestsDisabled()) {\n             // getLog().trace(\"TestMultipleSchemaNames() - Skipping all tests - Not supported on this DB\");\n             return;\n@@ -419,13 +417,15 @@ public void testGeneratedIDENTITY() {\n      * we give up as they treat schemas in special ways.\n      */\n     private void createSchemas() {\n+        OpenJPAEntityManagerFactorySPI tempEmf = createEMF();\n+        DBDictionary dict = ((JDBCConfiguration) tempEmf.getConfiguration()).getDBDictionaryInstance();\n         \n         if (!(dict instanceof PostgresDictionary)) {\n+            closeEMF(tempEmf);\n             return;\n         }\n         \n-        OpenJPAEntityManagerFactorySPI emf = createEMF();\n-        OpenJPAEntityManagerSPI em = emf.createEntityManager();\n+        OpenJPAEntityManagerSPI em = tempEmf.createEntityManager();\n         String[] schemas =\n             { \"SCHEMA1\", \"SCHEMA2\", \"SCHEMA3\", \"SCHEMA3G\", \"SCHEMA4G\" };\n         for (String schema : schemas) {\n@@ -438,7 +438,7 @@ private void createSchemas() {\n                 em.getTransaction().rollback();\n             }\n         }\n-        closeEMF(emf);\n+        closeEMF(tempEmf);\n     }\n \n } // end of TestMultipleSchemaNames"}]}

