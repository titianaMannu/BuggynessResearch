{"sha":"5c05a69ce6f371616dfb049fc1c996260b10a394","node_id":"MDY6Q29tbWl0MjA2MzY0OjVjMDVhNjljZTZmMzcxNjE2ZGZiMDQ5ZmMxYzk5NjI2MGIxMGEzOTQ=","commit":{"author":{"name":"Jody Grassel","email":"jgrassel@apache.org","date":"2012-07-30T15:40:35Z"},"committer":{"name":"Jody Grassel","email":"jgrassel@apache.org","date":"2012-07-30T15:40:35Z"},"message":"OPENJPA-2227: OpenJPA doesn't find custom SequenceGenerators\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1367126 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"9ac75db74e14bbc74a8ec846429eba0be8e4cfa7","url":"https://api.github.com/repos/apache/openjpa/git/trees/9ac75db74e14bbc74a8ec846429eba0be8e4cfa7"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/5c05a69ce6f371616dfb049fc1c996260b10a394","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/5c05a69ce6f371616dfb049fc1c996260b10a394","html_url":"https://github.com/apache/openjpa/commit/5c05a69ce6f371616dfb049fc1c996260b10a394","comments_url":"https://api.github.com/repos/apache/openjpa/commits/5c05a69ce6f371616dfb049fc1c996260b10a394/comments","author":null,"committer":null,"parents":[{"sha":"423d1d18e4066f4be13dc8d60bcf41759b5cfac8","url":"https://api.github.com/repos/apache/openjpa/commits/423d1d18e4066f4be13dc8d60bcf41759b5cfac8","html_url":"https://github.com/apache/openjpa/commit/423d1d18e4066f4be13dc8d60bcf41759b5cfac8"}],"stats":{"total":15,"additions":12,"deletions":3},"files":[{"sha":"5834da4c481b9f8b8afe63d1aa0bf22297f8054d","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/meta/SequenceMetaData.java","status":"modified","additions":12,"deletions":3,"changes":15,"blob_url":"https://github.com/apache/openjpa/blob/5c05a69ce6f371616dfb049fc1c996260b10a394/openjpa-kernel/src/main/java/org/apache/openjpa/meta/SequenceMetaData.java","raw_url":"https://github.com/apache/openjpa/raw/5c05a69ce6f371616dfb049fc1c996260b10a394/openjpa-kernel/src/main/java/org/apache/openjpa/meta/SequenceMetaData.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/meta/SequenceMetaData.java?ref=5c05a69ce6f371616dfb049fc1c996260b10a394","patch":"@@ -276,9 +276,18 @@ protected Seq instantiate(ClassLoader envLoader) {\n             plugin.setString(_plugin);\n             String clsName = plugin.getClassName();\n \n-            Class cls = Class.forName(clsName, true,\n-                AccessController.doPrivileged(\n-                    J2DoPrivHelper.getClassLoaderAction(Seq.class)));\n+            Class cls = null;\n+            try {\n+                cls = Class.forName(clsName, true,\n+                    AccessController.doPrivileged(J2DoPrivHelper.getClassLoaderAction(Seq.class)));\n+            } catch (ClassNotFoundException cnfe) {\n+                // Target sequence type is loaded by the ClassLoader responsible for OpenJPA classes.\n+                // This can happen if the custom sequence implementation is a class that belongs to\n+                // a child ClassLoader - a situation that can easily happen in a JEE environment.\n+                // Fall back to the envLoader to try load the class.\n+                cls = Class.forName(clsName, true, envLoader);\n+            }\n+            \n             StringBuilder props = new StringBuilder();\n             if (plugin.getProperties() != null)\n                 props.append(plugin.getProperties());"}]}

