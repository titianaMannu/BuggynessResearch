{"sha":"5d3fd3a726aa8f8fb32998c83ed649da068d4ed3","node_id":"MDY6Q29tbWl0MjA2MzY0OjVkM2ZkM2E3MjZhYThmOGZiMzI5OThjODNlZDY0OWRhMDY4ZDRlZDM=","commit":{"author":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2009-09-24T01:06:50Z"},"committer":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2009-09-24T01:06:50Z"},"message":"Update TestEJBQLFunction test to assert empty strings as null for the Oracle DB.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@818337 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"1f671c6281dc88f33c6330339d955e4e0df4ef72","url":"https://api.github.com/repos/apache/openjpa/git/trees/1f671c6281dc88f33c6330339d955e4e0df4ef72"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/5d3fd3a726aa8f8fb32998c83ed649da068d4ed3","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/5d3fd3a726aa8f8fb32998c83ed649da068d4ed3","html_url":"https://github.com/apache/openjpa/commit/5d3fd3a726aa8f8fb32998c83ed649da068d4ed3","comments_url":"https://api.github.com/repos/apache/openjpa/commits/5d3fd3a726aa8f8fb32998c83ed649da068d4ed3/comments","author":null,"committer":null,"parents":[{"sha":"c5954aa4a5bf0bd0279fbbe689f7808d913e9055","url":"https://api.github.com/repos/apache/openjpa/commits/c5954aa4a5bf0bd0279fbbe689f7808d913e9055","html_url":"https://github.com/apache/openjpa/commit/c5954aa4a5bf0bd0279fbbe689f7808d913e9055"}],"stats":{"total":20,"additions":19,"deletions":1},"files":[{"sha":"c4c82721a494869b2a90dd85a21f14948aec48b4","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/jpql/functions/TestEJBQLFunction.java","status":"modified","additions":19,"deletions":1,"changes":20,"blob_url":"https://github.com/apache/openjpa/blob/5d3fd3a726aa8f8fb32998c83ed649da068d4ed3/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/jpql/functions/TestEJBQLFunction.java","raw_url":"https://github.com/apache/openjpa/raw/5d3fd3a726aa8f8fb32998c83ed649da068d4ed3/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/jpql/functions/TestEJBQLFunction.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/jpql/functions/TestEJBQLFunction.java?ref=5d3fd3a726aa8f8fb32998c83ed649da068d4ed3","patch":"@@ -21,6 +21,9 @@\n import java.util.List;\n import javax.persistence.EntityManager;\n \n+import org.apache.openjpa.jdbc.conf.JDBCConfiguration;\n+import org.apache.openjpa.jdbc.sql.DBDictionary;\n+import org.apache.openjpa.jdbc.sql.OracleDictionary;\n import org.apache.openjpa.persistence.common.apps.Address;\n import org.apache.openjpa.persistence.common.apps.CompUser;\n import org.apache.openjpa.persistence.common.apps.FemaleUser;\n@@ -129,7 +132,21 @@ public void testConcatFunc2() {\n         user = em.find(CompUser.class, userid1);\n         em.refresh(user);\n         assertNotNull(user);\n-        assertEquals(\"\", user.getName());\n+        // Empty strings are stored as null on Oracle so the assertion below\n+        // must be handled differently on that DB.  The docs indicate that\n+        // this may not be the case in future releases so either result is\n+        // allowed.\n+        // The note in this section of Oracle doc explains the behavior:\n+        // http://download.oracle.com/docs/cd/B14117_01/server.101/ +\n+        // b10759/sql_elements005.htm#sthref511\n+        DBDictionary dict = ((JDBCConfiguration) getEmf().getConfiguration())\n+            .getDBDictionaryInstance();\n+        if (dict instanceof OracleDictionary) {\n+            assertTrue(user.getName() == null ||\n+                \"\".equals(user.getName()));\n+        } else {\n+            assertEquals(\"\", user.getName());            \n+        }\n \n         endTx(em);\n         endEm(em);\n@@ -407,4 +424,5 @@ public CompUser createUser(String name, String cName, Address add, int age,\n         }\n         return user;\n     }\n+    \n }"}]}

