{"sha":"60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f","node_id":"MDY6Q29tbWl0MjA2MzY0OjYwZTU1NTc0YzhhZTJlZTRmOTE1YjAxOTdhM2U1YTRjYWI3MmRkMWY=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-09-11T23:41:34Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-09-11T23:41:34Z"},"message":"fix BigDecimal problem in the test case for MySQL\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@814085 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"5477ca5d6d48dc0f98ee84dc21fbbccf8e088e2e","url":"https://api.github.com/repos/apache/openjpa/git/trees/5477ca5d6d48dc0f98ee84dc21fbbccf8e088e2e"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f","html_url":"https://github.com/apache/openjpa/commit/60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f","comments_url":"https://api.github.com/repos/apache/openjpa/commits/60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f/comments","author":null,"committer":null,"parents":[{"sha":"1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","url":"https://api.github.com/repos/apache/openjpa/commits/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406","html_url":"https://github.com/apache/openjpa/commit/1aab5c3c6cfa9876161ff4b7e307012c7ee0b406"}],"stats":{"total":20,"additions":19,"deletions":1},"files":[{"sha":"aee97d76c4330f3d8f9496ab0becd2f11241cc50","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestSQLBigDecimalId.java","status":"modified","additions":19,"deletions":1,"changes":20,"blob_url":"https://github.com/apache/openjpa/blob/60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestSQLBigDecimalId.java","raw_url":"https://github.com/apache/openjpa/raw/60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestSQLBigDecimalId.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestSQLBigDecimalId.java?ref=60e55574c8ae2ee4f915b0197a3e5a4cab72dd1f","patch":"@@ -22,6 +22,13 @@\n import javax.persistence.EntityManager;\n \n import junit.textui.TestRunner;\n+\n+import org.apache.openjpa.jdbc.conf.JDBCConfiguration;\n+import org.apache.openjpa.jdbc.sql.DBDictionary;\n+import org.apache.openjpa.jdbc.sql.MySQLDictionary;\n+import org.apache.openjpa.persistence.OpenJPAEntityManagerFactorySPI;\n+import org.apache.openjpa.persistence.OpenJPAEntityManagerSPI;\n+import org.apache.openjpa.persistence.test.SQLListenerTestCase;\n import org.apache.openjpa.persistence.test.SingleEMFTestCase;\n \n /**\n@@ -31,7 +38,7 @@\n     extends SingleEMFTestCase {\n \n     public void setUp() {\n-        setUp(SQLBigDecimalIdEntity.class, CLEAR_TABLES);\n+        setUp(SQLBigDecimalIdEntity.class, DROP_TABLES);\n     }\n \n     public void testPersist() {\n@@ -42,6 +49,17 @@ public void testPersist() {\n         e.setId(decimal);\n         e.setData(1);\n \n+        // trigger schema definition\n+        JDBCConfiguration jdbccfg = (JDBCConfiguration)emf.getConfiguration();\n+        DBDictionary dict = jdbccfg.getDBDictionaryInstance();\n+        //currently BigDecimal is mapped to NUMERIC column type. This causes\n+        //truncation error from MySQL. Without knowing the implication of changing the \n+        //mapping of BigDecimal universally to DOUBLE, I will just change the mapping\n+        //for this test case. \n+        if (dict instanceof MySQLDictionary) {\n+            dict.numericTypeName = \"DOUBLE\";\n+        }\n+        \n         EntityManager em = emf.createEntityManager();\n         em.getTransaction().begin();\n         em.persist(e);"}]}

