{"sha":"68ec48446ced9626cc8a0a76f7bfb5e972460aa2","node_id":"MDY6Q29tbWl0MjA2MzY0OjY4ZWM0ODQ0NmNlZDk2MjZjYzhhMGE3NmY3YmZiNWU5NzI0NjBhYTI=","commit":{"author":{"name":"Michael Dick","email":"mikedd@apache.org","date":"2009-12-17T01:29:28Z"},"committer":{"name":"Michael Dick","email":"mikedd@apache.org","date":"2009-12-17T01:29:28Z"},"message":"OPENJPA-1397:\nAllow some columns of compound keys to be null.\nMerged from trunk commit by Pinaki Poddar.\nTestcase Submitted By: Michael Vorburger.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/1.2.x@891510 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"a0f01007938ab6327e7caa4942bd06f5b3caa2f8","url":"https://api.github.com/repos/apache/openjpa/git/trees/a0f01007938ab6327e7caa4942bd06f5b3caa2f8"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/68ec48446ced9626cc8a0a76f7bfb5e972460aa2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/68ec48446ced9626cc8a0a76f7bfb5e972460aa2","html_url":"https://github.com/apache/openjpa/commit/68ec48446ced9626cc8a0a76f7bfb5e972460aa2","comments_url":"https://api.github.com/repos/apache/openjpa/commits/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/comments","author":{"login":"mikedd","id":669432,"node_id":"MDQ6VXNlcjY2OTQzMg==","avatar_url":"https://avatars.githubusercontent.com/u/669432?v=4","gravatar_id":"","url":"https://api.github.com/users/mikedd","html_url":"https://github.com/mikedd","followers_url":"https://api.github.com/users/mikedd/followers","following_url":"https://api.github.com/users/mikedd/following{/other_user}","gists_url":"https://api.github.com/users/mikedd/gists{/gist_id}","starred_url":"https://api.github.com/users/mikedd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikedd/subscriptions","organizations_url":"https://api.github.com/users/mikedd/orgs","repos_url":"https://api.github.com/users/mikedd/repos","events_url":"https://api.github.com/users/mikedd/events{/privacy}","received_events_url":"https://api.github.com/users/mikedd/received_events","type":"User","site_admin":false},"committer":{"login":"mikedd","id":669432,"node_id":"MDQ6VXNlcjY2OTQzMg==","avatar_url":"https://avatars.githubusercontent.com/u/669432?v=4","gravatar_id":"","url":"https://api.github.com/users/mikedd","html_url":"https://github.com/mikedd","followers_url":"https://api.github.com/users/mikedd/followers","following_url":"https://api.github.com/users/mikedd/following{/other_user}","gists_url":"https://api.github.com/users/mikedd/gists{/gist_id}","starred_url":"https://api.github.com/users/mikedd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikedd/subscriptions","organizations_url":"https://api.github.com/users/mikedd/orgs","repos_url":"https://api.github.com/users/mikedd/repos","events_url":"https://api.github.com/users/mikedd/events{/privacy}","received_events_url":"https://api.github.com/users/mikedd/received_events","type":"User","site_admin":false},"parents":[{"sha":"ff6ac29d8c6ad81a49d82975d8a75281a37a2615","url":"https://api.github.com/repos/apache/openjpa/commits/ff6ac29d8c6ad81a49d82975d8a75281a37a2615","html_url":"https://github.com/apache/openjpa/commit/ff6ac29d8c6ad81a49d82975d8a75281a37a2615"}],"stats":{"total":376,"additions":374,"deletions":2},"files":[{"sha":"84e8a6ead042513062e03274f7a05a93506d6a2a","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/ClassMapping.java","status":"modified","additions":5,"deletions":2,"changes":7,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/ClassMapping.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/ClassMapping.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/ClassMapping.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -172,6 +172,7 @@ private Object getObjectId(ClassMapping cls, JDBCStore store, Result res,\n         FieldMapping fm;\n         Joinable join;\n         int pkIdx;\n+        boolean isNullPK = true;\n         for (int i = 0; i < pks.length; i++) {\n             // we know that all pk column join mappings use primary key fields,\n             // cause this mapping uses the oid as its primary key (we recursed\n@@ -186,10 +187,12 @@ private Object getObjectId(ClassMapping cls, JDBCStore store, Result res,\n                 vals[pkIdx] = join.getPrimaryKeyValue(res, join.getColumns(),\n                     fk, store, joins);\n                 res.endDataRequest();\n-                if (vals[pkIdx] == null)\n-                    return null;\n+                isNullPK = isNullPK && vals[pkIdx] == null;\n             }\n         }\n+        if (isNullPK) {\n+            return null;\n+        }\n \n         // the oid data is loaded by the base type, but if discriminator data\n         // is present, make sure to use it to construct the actual oid instance"},{"sha":"e9b8bab277170c047b22f2ba12a0ccd92fdf5efc","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntity.java","status":"added","additions":56,"deletions":0,"changes":56,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntity.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntity.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntity.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package org.apache.openjpa.persistence.identity;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.FetchType;\n+import javax.persistence.Id;\n+import javax.persistence.IdClass;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+/**\n+ * JPA Entity with a compound Id of two fields, one simple and one an Entity.\n+ */\n+@Entity\n+@Table(name = \"test_complex\")\n+@IdClass(ComplexCompoundIdTestEntityId.class)\n+public class ComplexCompoundIdTestEntity {\n+\n+\t@Id\n+\t@Column(nullable = false)\n+\tprivate Long id;\n+\n+    @Id\n+    @ManyToOne(cascade = { CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH }, \n+            fetch = FetchType.LAZY, optional = true)\n+    @JoinColumn(nullable = true, name = \"type_id\")\n+\tprivate TypeEntity type;\n+\n+\tpublic Long getId() {\n+\t\treturn id;\n+\t}\n+\n+\tpublic TypeEntity getType() {\n+\t\treturn type;\n+\t}\n+}"},{"sha":"2754897433c1ad7d62ca0985d15ce40b798f3d9b","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntityId.java","status":"added","additions":61,"deletions":0,"changes":61,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntityId.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntityId.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/ComplexCompoundIdTestEntityId.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -0,0 +1,61 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package org.apache.openjpa.persistence.identity;\n+\n+\n+/**\n+ * JPA Id for ComplexCompoundIdTestEntity.\n+ */\n+public class ComplexCompoundIdTestEntityId {\n+\n+\tprivate Long id;\n+\n+\tprivate Long type;\n+\n+\t@Override\n+\tpublic int hashCode() {\n+\t\tfinal int prime = 31;\n+\t\tint result = 1;\n+\t\tresult = prime * result + ((id == null) ? 0 : id.hashCode());\n+\t\tresult = prime * result + ((type == null) ? 0 : type.hashCode());\n+\t\treturn result;\n+\t}\n+\n+\t@Override\n+\tpublic boolean equals(Object obj) {\n+\t\tif (this == obj)\n+\t\t\treturn true;\n+\t\tif (obj == null)\n+\t\t\treturn false;\n+\t\tif (getClass() != obj.getClass())\n+\t\t\treturn false;\n+\t\tComplexCompoundIdTestEntityId other = (ComplexCompoundIdTestEntityId) obj;\n+\t\tif (id == null) {\n+\t\t\tif (other.id != null)\n+\t\t\t\treturn false;\n+\t\t} else if (!id.equals(other.id))\n+\t\t\treturn false;\n+\t\tif (type == null) {\n+\t\t\tif (other.type != null)\n+\t\t\t\treturn false;\n+\t\t} else if (!type.equals(other.type))\n+\t\t\treturn false;\n+\t\treturn true;\n+\t}\n+}"},{"sha":"5bf6b24dd3f5a1556b9dcfbf3ad8d6557592f0e9","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntity.java","status":"added","additions":54,"deletions":0,"changes":54,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntity.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntity.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntity.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -0,0 +1,54 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package org.apache.openjpa.persistence.identity;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.Id;\n+import javax.persistence.IdClass;\n+import javax.persistence.Table;\n+\n+/**\n+ * JPA Entity with a compound Id of two fields, both simple.\n+ */\n+@Entity\n+@Table(name = \"test_simple\")\n+@IdClass(SimpleCompoundIdTestEntityId.class)\n+public class SimpleCompoundIdTestEntity {\n+\n+\t@Id\n+\t@Column(nullable = false)\n+\tprivate Long firstId;\n+\n+\t@Id\n+\t@Column(nullable = true)\n+\tprivate Long secondId;\n+\n+\t// ...\n+\t\n+\tpublic Long getFirstId() {\n+\t\treturn firstId;\n+\t}\n+\n+\tpublic Long getSecondId() {\n+\t\treturn secondId;\n+\t}\n+\t\n+\t// ...\n+}"},{"sha":"779b8bc9d41c39b28604df87bf95e65739ddd262","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntityId.java","status":"added","additions":62,"deletions":0,"changes":62,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntityId.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntityId.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/SimpleCompoundIdTestEntityId.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -0,0 +1,62 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package org.apache.openjpa.persistence.identity;\n+\n+\n+/**\n+ * JPA Id for SimpleCompoundIdTestEntity.\n+ */\n+public class SimpleCompoundIdTestEntityId {\n+\n+\tpublic Long firstId;\n+\n+\tpublic Long secondId;\n+\n+\t\n+\t@Override\n+\tpublic int hashCode() {\n+\t\tfinal int prime = 31;\n+\t\tint result = 1;\n+\t\tresult = prime * result + ((firstId == null) ? 0 : firstId.hashCode());\n+\t\tresult = prime * result + ((secondId == null) ? 0 : secondId.hashCode());\n+\t\treturn result;\n+\t}\n+\n+\t@Override\n+\tpublic boolean equals(Object obj) {\n+\t\tif (this == obj)\n+\t\t\treturn true;\n+\t\tif (obj == null)\n+\t\t\treturn false;\n+\t\tif (getClass() != obj.getClass())\n+\t\t\treturn false;\n+\t\tSimpleCompoundIdTestEntityId other = (SimpleCompoundIdTestEntityId) obj;\n+\t\tif (firstId == null) {\n+\t\t\tif (other.firstId != null)\n+\t\t\t\treturn false;\n+\t\t} else if (!firstId.equals(other.firstId))\n+\t\t\treturn false;\n+\t\tif (secondId == null) {\n+\t\t\tif (other.secondId != null)\n+\t\t\t\treturn false;\n+\t\t} else if (!secondId.equals(other.secondId))\n+\t\t\treturn false;\n+\t\treturn true;\n+\t}\n+}"},{"sha":"7dc78615229e2970d21256859ca41ffb4af8c479","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestCompundIdWithNull.java","status":"added","additions":116,"deletions":0,"changes":116,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestCompundIdWithNull.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestCompundIdWithNull.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TestCompundIdWithNull.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -0,0 +1,116 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package org.apache.openjpa.persistence.identity;\n+\n+import java.sql.Connection;\n+import java.util.List;\n+\n+import javax.persistence.EntityManager;\n+\n+import org.apache.openjpa.persistence.OpenJPAEntityManager;\n+import org.apache.openjpa.persistence.OpenJPAPersistence;\n+import org.apache.openjpa.persistence.test.SingleEMFTestCase;\n+\n+/**\n+ * Test that compound identity can consists of null component column value.\n+ * \n+ * This test uses pre-defined database tables created by DDL explicitly.\n+ * The tables have <em>logical</em> compound primary keys in the sense non-null\n+ * constraint is <em>not</em> set on the primary columns. The tables are populated \n+ * with SQL to contain null values in these columns. \n+ * The test verifies that results are returned as par expectation.\n+ * For more details, refer\n+ * <A href=\"https://issues.apache.org/jira/browse/OPENJPA-1397\">JIRA-1397</A>\n+ */\n+public class TestCompundIdWithNull extends SingleEMFTestCase {\n+    private static boolean tablesCreated = false;\n+\tpublic void setUp() throws Exception {\n+\t    // do not use CLEAR_TABLES or DROP_TABLES\n+\t    super.setUp(SimpleCompoundIdTestEntity.class, ComplexCompoundIdTestEntity.class, TypeEntity.class);\n+\t    if (!tablesCreated) {\n+\t        createTables(emf.createEntityManager());\n+\t    }\n+\t    \n+\t}\n+\t\n+\tpublic void testSimpleCompoundIdTestEntity() throws Exception  {\n+\t\t\tEntityManager em = emf.createEntityManager();\n+\t\t\tString jpql = \"SELECT o FROM SimpleCompoundIdTestEntity o ORDER BY o.secondId\";\n+\t\t\tList list = em.createQuery(jpql).getResultList();\n+\t\t\tassertEquals(2, list.size());\n+\t\t\tassertEquals(Long.valueOf(123), ((SimpleCompoundIdTestEntity) list.get(0)).getSecondId());\n+\t\t\t\n+\t\t\tSimpleCompoundIdTestEntity secondResult = (SimpleCompoundIdTestEntity) list.get(1);\n+\t\t\tassertNotNull(\"BUG (JIRA-1397)! Result list contains null in second element\", secondResult);\n+\t\t\tassertNull(secondResult.getSecondId());\n+\t\t\tem.close();\n+\t}\n+\n+\t\n+\tpublic void testComplexCompoundIdTestEntity() throws Exception  {\n+\t\t\tEntityManager em = emf.createEntityManager();\n+\t\t\tString jpql = \"SELECT o FROM ComplexCompoundIdTestEntity o ORDER BY o.type\";\n+\t\t\tList list = em.createQuery(jpql).getResultList();\n+\t\t\tassertEquals(2, list.size());\n+\t\t\tComplexCompoundIdTestEntity secondResult = (ComplexCompoundIdTestEntity) list.get(1);\n+\t\t\tassertNotNull(\"Result list contains null in second element\", secondResult);\n+\t\t\tassertNull(\"Result list's second record secondId field was not null\", secondResult.getType());\n+\t\t\tem.close();\n+\t}\n+\t\n+\t/**\n+\t * Create tables with logical compound keys without non-null constraint.\n+\t * Populate them with null values in some of the columns.\n+\t */\n+    private void createTables(EntityManager em) throws Exception {\n+        em.getTransaction().begin();\n+        OpenJPAEntityManager kem = OpenJPAPersistence.cast(em);\n+\n+        Connection conn = (Connection) kem.getConnection();\n+        // NOTE that 'logically' test_simple has a \", CONSTRAINT test_simple_pk PRIMARY KEY (firstId, secondId)\",\n+        // but at least Derby doesn't permit NULL then.. in our real-world underlying schema that leads\n+        // to this there are *NO* PRIMARY KEY on any tables, but there is a logical featureSelection expressed\n+        // elsewhere stating that those two columns uniquely identify a row.\n+        try {\n+            conn.createStatement().execute(\"DROP TABLE test_type\");\n+            conn.createStatement().execute(\"DROP TABLE test_simple\");\n+            conn.createStatement().execute(\"DROP TABLE test_complex\");\n+        } catch (Exception e) {\n+        }\n+        \n+        conn.createStatement().execute(\"CREATE TABLE test_simple(firstId NUMERIC, secondId NUMERIC)\");\n+        conn.createStatement().execute(\"INSERT INTO test_simple(firstId, secondId) VALUES (1, 123)\");\n+        conn.createStatement().execute(\"INSERT INTO test_simple(firstId, secondId) VALUES (1, NULL)\");\n+\n+        conn.createStatement().execute(\"CREATE TABLE test_type(id NUMERIC CONSTRAINT test_type_pk PRIMARY KEY, \" +\n+                \"code VARCHAR(16))\");\n+        conn.createStatement().execute(\"INSERT INTO test_type(id, code) VALUES (987, 'ABC')\");\n+\n+        conn.createStatement().execute(\"CREATE TABLE test_complex(id NUMERIC, type_id NUMERIC)\");\n+        conn.createStatement().execute(\"INSERT INTO test_complex(id, type_id) VALUES (1, 987)\");\n+        conn.createStatement().execute(\"INSERT INTO test_complex(id, type_id) VALUES (1, NULL)\");\n+\n+        conn.close();\n+        \n+        em.flush();\n+        em.getTransaction().commit();\n+        em.close();\n+    }\n+\t    \n+}"},{"sha":"51c59196b958a7b3f5bd998d6c348d19dcba138c","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TypeEntity.java","status":"added","additions":20,"deletions":0,"changes":20,"blob_url":"https://github.com/apache/openjpa/blob/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TypeEntity.java","raw_url":"https://github.com/apache/openjpa/raw/68ec48446ced9626cc8a0a76f7bfb5e972460aa2/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TypeEntity.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/identity/TypeEntity.java?ref=68ec48446ced9626cc8a0a76f7bfb5e972460aa2","patch":"@@ -0,0 +1,20 @@\n+package org.apache.openjpa.persistence.identity;\n+\n+import javax.persistence.Entity;\n+import javax.persistence.Id;\n+import javax.persistence.Table;\n+\n+/**\n+ * JPA Entity\n+ */\n+@Entity\n+@Table(name = \"test_type\")\n+public class TypeEntity {\n+\n+\t@Id\n+\tprivate Long id;\n+\t\n+\tprivate String code;\n+\t\n+\t// ...\n+}"}]}

