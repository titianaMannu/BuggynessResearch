{"sha":"6bc2b5671d00143dd7039f7c6472f6a449174951","node_id":"MDY6Q29tbWl0MjA2MzY0OjZiYzJiNTY3MWQwMDE0M2RkNzAzOWY3YzY0NzJmNmE0NDkxNzQ5NTE=","commit":{"author":{"name":"Mark Struberg","email":"struberg@apache.org","date":"2011-12-27T12:00:12Z"},"committer":{"name":"Mark Struberg","email":"struberg@apache.org","date":"2011-12-27T12:00:12Z"},"message":"OPENJPA-2100 oops, fixed broken test\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1224900 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"3a9dad4e9427dbc0ccb34a67622d842b9b90ad34","url":"https://api.github.com/repos/apache/openjpa/git/trees/3a9dad4e9427dbc0ccb34a67622d842b9b90ad34"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/6bc2b5671d00143dd7039f7c6472f6a449174951","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/6bc2b5671d00143dd7039f7c6472f6a449174951","html_url":"https://github.com/apache/openjpa/commit/6bc2b5671d00143dd7039f7c6472f6a449174951","comments_url":"https://api.github.com/repos/apache/openjpa/commits/6bc2b5671d00143dd7039f7c6472f6a449174951/comments","author":{"login":"struberg","id":79310,"node_id":"MDQ6VXNlcjc5MzEw","avatar_url":"https://avatars.githubusercontent.com/u/79310?v=4","gravatar_id":"","url":"https://api.github.com/users/struberg","html_url":"https://github.com/struberg","followers_url":"https://api.github.com/users/struberg/followers","following_url":"https://api.github.com/users/struberg/following{/other_user}","gists_url":"https://api.github.com/users/struberg/gists{/gist_id}","starred_url":"https://api.github.com/users/struberg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/struberg/subscriptions","organizations_url":"https://api.github.com/users/struberg/orgs","repos_url":"https://api.github.com/users/struberg/repos","events_url":"https://api.github.com/users/struberg/events{/privacy}","received_events_url":"https://api.github.com/users/struberg/received_events","type":"User","site_admin":false},"committer":{"login":"struberg","id":79310,"node_id":"MDQ6VXNlcjc5MzEw","avatar_url":"https://avatars.githubusercontent.com/u/79310?v=4","gravatar_id":"","url":"https://api.github.com/users/struberg","html_url":"https://github.com/struberg","followers_url":"https://api.github.com/users/struberg/followers","following_url":"https://api.github.com/users/struberg/following{/other_user}","gists_url":"https://api.github.com/users/struberg/gists{/gist_id}","starred_url":"https://api.github.com/users/struberg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/struberg/subscriptions","organizations_url":"https://api.github.com/users/struberg/orgs","repos_url":"https://api.github.com/users/struberg/repos","events_url":"https://api.github.com/users/struberg/events{/privacy}","received_events_url":"https://api.github.com/users/struberg/received_events","type":"User","site_admin":false},"parents":[{"sha":"62462f47524e5408956d8ddc1b4d9d0ef6d9d0d6","url":"https://api.github.com/repos/apache/openjpa/commits/62462f47524e5408956d8ddc1b4d9d0ef6d9d0d6","html_url":"https://github.com/apache/openjpa/commit/62462f47524e5408956d8ddc1b4d9d0ef6d9d0d6"}],"stats":{"total":15,"additions":8,"deletions":7},"files":[{"sha":"b6d6d2b968ab17ab9f1a1999225ef25e14fbe85f","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/enhance/TestEmbeddedEnumSqlGeneration.java","status":"modified","additions":8,"deletions":7,"changes":15,"blob_url":"https://github.com/apache/openjpa/blob/6bc2b5671d00143dd7039f7c6472f6a449174951/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/enhance/TestEmbeddedEnumSqlGeneration.java","raw_url":"https://github.com/apache/openjpa/raw/6bc2b5671d00143dd7039f7c6472f6a449174951/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/enhance/TestEmbeddedEnumSqlGeneration.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/enhance/TestEmbeddedEnumSqlGeneration.java?ref=6bc2b5671d00143dd7039f7c6472f6a449174951","patch":"@@ -20,7 +20,6 @@\n \n import org.apache.openjpa.enhance.PCEnhancer;\n import org.apache.openjpa.jdbc.conf.JDBCConfiguration;\n-import org.apache.openjpa.jdbc.conf.JDBCConfigurationImpl;\n import org.apache.openjpa.jdbc.meta.MappingTool;\n import org.apache.openjpa.persistence.OpenJPAEntityManager;\n import org.apache.openjpa.persistence.OpenJPAEntityManagerSPI;\n@@ -44,11 +43,13 @@ public void setUp() {\n \n     public void testEnumEnhancement()\n     throws IOException {\n-        JDBCConfiguration conf = new JDBCConfigurationImpl();\n-        try {\n-            return MappingTool.run(conf, args, opts);\n-        } finally {\n-            conf.close();\n-        }\n+        EntityManager em= currentEntityManager();\n+        OpenJPAEntityManager kem = OpenJPAPersistence.cast(em);\n+\n+        MappingTool tool = new MappingTool((JDBCConfiguration)\n+                ((OpenJPAEntityManagerSPI) kem).getConfiguration(),\n+                MappingTool.ACTION_REFRESH, false);\n+        tool.run(EntityWithEnum.class);\n+        tool.record();\n     }\n }"}]}

