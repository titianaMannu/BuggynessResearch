{"sha":"7178dd3f002380aee3205d83150c0d9a2d135ae4","node_id":"MDY6Q29tbWl0MjA2MzY0OjcxNzhkZDNmMDAyMzgwYWVlMzIwNWQ4MzE1MGMwZDlhMmQxMzVhZTQ=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-11-22T18:23:34Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-11-22T18:23:34Z"},"message":"OPENJPA-1894: reduce the number of Strings created by SelectImpl.getTableIndex\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1037819 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"0e788f177b8ee417ea44e537a9e5b32474662c87","url":"https://api.github.com/repos/apache/openjpa/git/trees/0e788f177b8ee417ea44e537a9e5b32474662c87"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/7178dd3f002380aee3205d83150c0d9a2d135ae4","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/7178dd3f002380aee3205d83150c0d9a2d135ae4","html_url":"https://github.com/apache/openjpa/commit/7178dd3f002380aee3205d83150c0d9a2d135ae4","comments_url":"https://api.github.com/repos/apache/openjpa/commits/7178dd3f002380aee3205d83150c0d9a2d135ae4/comments","author":null,"committer":null,"parents":[{"sha":"2009b5c016d09ab8d95da0f9b68ad6eaca99f5bf","url":"https://api.github.com/repos/apache/openjpa/commits/2009b5c016d09ab8d95da0f9b68ad6eaca99f5bf","html_url":"https://github.com/apache/openjpa/commit/2009b5c016d09ab8d95da0f9b68ad6eaca99f5bf"}],"stats":{"total":21,"additions":20,"deletions":1},"files":[{"sha":"6e03b8cf53356caeaab962c9b02a3b5b26d3b586","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java","status":"modified","additions":20,"deletions":1,"changes":21,"blob_url":"https://github.com/apache/openjpa/blob/7178dd3f002380aee3205d83150c0d9a2d135ae4/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java","raw_url":"https://github.com/apache/openjpa/raw/7178dd3f002380aee3205d83150c0d9a2d135ae4/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SelectImpl.java?ref=7178dd3f002380aee3205d83150c0d9a2d135ae4","patch":"@@ -2032,7 +2032,7 @@ private int getTableIndex(Table table, PathJoins pj, boolean create) {\n         Integer i = null;\n         Object key = table.getFullIdentifier().getName();\n         if (pj != null && pj.path() != null)\n-            key = new Key(pj.path().toString(), key);\n+            key = new Key(pj.getPathStr(), key);\n \n         if (_ctx != null && (_parent != null || _subsels != null || _hasSub)) {\n             i = findAliasForQuery(table, pj, key, create);\n@@ -2194,6 +2194,10 @@ public boolean isDirty() {\n     public StringBuilder path() {\n         return null;\n     }\n+    \n+    public String getPathStr() {\n+        return null;\n+    }\n \n     public JoinSet joins() {\n         return null;\n@@ -2551,6 +2555,10 @@ public boolean isDirty() {\n         public StringBuilder path() {\n             return null;\n         }\n+        \n+        public String getPathStr() {\n+            return null;\n+        }\n \n         public JoinSet joins() {\n             return null;\n@@ -2630,6 +2638,7 @@ public void moveJoinsToParent() {\n         protected String correlatedVar = null;\n         protected Context context = null;\n         protected Context lastContext = null;\n+        protected String pathStr = null;\n \n         public Select getSelect() {\n             return null;\n@@ -2734,8 +2743,16 @@ protected void append(String str) {\n                     path = new StringBuilder(str);\n                 else\n                     path.append('.').append(str);\n+                pathStr = null;\n             }\n         }\n+        \n+        public String getPathStr() {\n+            if (pathStr == null) {\n+                pathStr = path.toString();\n+            }\n+            return pathStr;\n+        }\n \n         public String toString() {\n             return \"PathJoinsImpl<\" + hashCode() + \">: \"\n@@ -3297,5 +3314,7 @@ public void moveJoinsToParent() {\n      * @return\n      */\n     public Select getSelect();\n+    \n+    public String getPathStr();\n }\n "}]}

