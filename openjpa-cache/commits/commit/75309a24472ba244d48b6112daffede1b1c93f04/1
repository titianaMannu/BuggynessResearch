{"sha":"75309a24472ba244d48b6112daffede1b1c93f04","node_id":"MDY6Q29tbWl0MjA2MzY0Ojc1MzA5YTI0NDcyYmEyNDRkNDhiNjExMmRhZmZlZGUxYjFjOTNmMDQ=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-05-12T21:42:57Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-05-12T21:42:57Z"},"message":"OPENJPA-595. Porting to 1.1.x branch.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/1.1.x@655657 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"129057ab615901a9099f7fc0f503c67827b833f3","url":"https://api.github.com/repos/apache/openjpa/git/trees/129057ab615901a9099f7fc0f503c67827b833f3"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/75309a24472ba244d48b6112daffede1b1c93f04","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/75309a24472ba244d48b6112daffede1b1c93f04","html_url":"https://github.com/apache/openjpa/commit/75309a24472ba244d48b6112daffede1b1c93f04","comments_url":"https://api.github.com/repos/apache/openjpa/commits/75309a24472ba244d48b6112daffede1b1c93f04/comments","author":null,"committer":null,"parents":[{"sha":"b56f30427fb6faabb63e943cff8c7aa17997d8d6","url":"https://api.github.com/repos/apache/openjpa/commits/b56f30427fb6faabb63e943cff8c7aa17997d8d6","html_url":"https://github.com/apache/openjpa/commit/b56f30427fb6faabb63e943cff8c7aa17997d8d6"}],"stats":{"total":12,"additions":10,"deletions":2},"files":[{"sha":"1c954f91399626a6c250b60c63bd449aa7712b8b","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java","status":"modified","additions":7,"deletions":2,"changes":9,"blob_url":"https://github.com/apache/openjpa/blob/75309a24472ba244d48b6112daffede1b1c93f04/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java","raw_url":"https://github.com/apache/openjpa/raw/75309a24472ba244d48b6112daffede1b1c93f04/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/jpql/JPQLExpressionBuilder.java?ref=75309a24472ba244d48b6112daffede1b1c93f04","patch":"@@ -1322,8 +1322,11 @@ private Value getPathOrConstant(JPQLNode node) {\n                 Object value = field.get(null);\n                 return factory.newLiteral(value, Literal.TYPE_UNKNOWN);\n             } catch (NoSuchFieldException nsfe) {\n-                throw parseException(EX_USER, \"no-field\",\n-                    new Object[]{ c.getName(), fieldName }, nsfe);\n+                if (node.inEnumPath)\n+                    throw parseException(EX_USER, \"no-field\",\n+                        new Object[]{ c.getName(), fieldName }, nsfe);\n+                else\n+                    return getPath(node, false, true);\n             } catch (Exception e) {\n                 throw parseException(EX_USER, \"unaccessible-field\",\n                     new Object[]{ className, fieldName }, e);\n@@ -1556,10 +1559,12 @@ private static JPQLNode lastChild(JPQLNode node, int fromLast) {\n         JPQLNode[] children;\n         String text;\n         boolean not = false;\n+        boolean inEnumPath = false;\n \n         public JPQLNode(JPQL parser, int id) {\n             this.id = id;\n             this.parser = parser;\n+            this.inEnumPath = parser.inEnumPath;\n         }\n \n         public void jjtOpen() {"},{"sha":"a77d7ba16282693e659e4048b5ae927a37aa5617","filename":"openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/apache/openjpa/blob/75309a24472ba244d48b6112daffede1b1c93f04/openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt","raw_url":"https://github.com/apache/openjpa/raw/75309a24472ba244d48b6112daffede1b1c93f04/openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/jjtree/org/apache/openjpa/kernel/jpql/JPQL.jjt?ref=75309a24472ba244d48b6112daffede1b1c93f04","patch":"@@ -64,6 +64,7 @@ import java.io.*;\n public class JPQL\n {\n \tString jpql;\n+\tboolean inEnumPath;\n \n \n \tpublic JPQL (String jpql)\n@@ -968,7 +969,9 @@ void enum_primary() : { }\n \n void enum_literal() : { }\n {\n+\t{ inEnumPath = true; }\n \tpath()\n+\t{ inEnumPath = false; }\n }\n \n "}]}

