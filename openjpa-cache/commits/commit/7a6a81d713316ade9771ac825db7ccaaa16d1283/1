{"sha":"7a6a81d713316ade9771ac825db7ccaaa16d1283","node_id":"MDY6Q29tbWl0MjA2MzY0OjdhNmE4MWQ3MTMzMTZhZGU5NzcxYWM4MjVkYjdjY2FhYTE2ZDEyODM=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2007-07-25T17:56:20Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2007-07-25T17:56:20Z"},"message":"Attempt to resolve high-load UUIDGenerator problem. I was not able to reproduce the issue, but code inspection seems to indicate that this fix should work.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@559540 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"dd6d6237460f7824ad126cc05f75a2f861c23344","url":"https://api.github.com/repos/apache/openjpa/git/trees/dd6d6237460f7824ad126cc05f75a2f861c23344"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/7a6a81d713316ade9771ac825db7ccaaa16d1283","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/7a6a81d713316ade9771ac825db7ccaaa16d1283","html_url":"https://github.com/apache/openjpa/commit/7a6a81d713316ade9771ac825db7ccaaa16d1283","comments_url":"https://api.github.com/repos/apache/openjpa/commits/7a6a81d713316ade9771ac825db7ccaaa16d1283/comments","author":null,"committer":null,"parents":[{"sha":"3ddd88b576b4531b96a96e963d6c5f6fb69fa51c","url":"https://api.github.com/repos/apache/openjpa/commits/3ddd88b576b4531b96a96e963d6c5f6fb69fa51c","html_url":"https://github.com/apache/openjpa/commit/3ddd88b576b4531b96a96e963d6c5f6fb69fa51c"}],"stats":{"total":13,"additions":12,"deletions":1},"files":[{"sha":"91647556c606996250cefd5b8ec3ecb8e27f2c7e","filename":"openjpa-lib/src/main/java/org/apache/openjpa/lib/util/UUIDGenerator.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/7a6a81d713316ade9771ac825db7ccaaa16d1283/openjpa-lib/src/main/java/org/apache/openjpa/lib/util/UUIDGenerator.java","raw_url":"https://github.com/apache/openjpa/raw/7a6a81d713316ade9771ac825db7ccaaa16d1283/openjpa-lib/src/main/java/org/apache/openjpa/lib/util/UUIDGenerator.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-lib/src/main/java/org/apache/openjpa/lib/util/UUIDGenerator.java?ref=7a6a81d713316ade9771ac825db7ccaaa16d1283","patch":"@@ -172,10 +172,12 @@ public static String nextHex() {\n      *\n      * @return long timestamp\n      */\n-    private static long getTime() {\n+    // package-visibility for testing\n+    static long getTime() {\n         long newTime = getUUIDTime();\n         if (newTime <= _lastMillis) {\n             incrementSequence();\n+            newTime = getUUIDTime();\n         }\n         _lastMillis = newTime;\n         return newTime;"},{"sha":"7ae6a33c752a1ad3445d880e07e3cc1c5deb5f1a","filename":"openjpa-lib/src/test/java/org/apache/openjpa/lib/util/TestUUIDGenerator.java","status":"modified","additions":9,"deletions":0,"changes":9,"blob_url":"https://github.com/apache/openjpa/blob/7a6a81d713316ade9771ac825db7ccaaa16d1283/openjpa-lib/src/test/java/org/apache/openjpa/lib/util/TestUUIDGenerator.java","raw_url":"https://github.com/apache/openjpa/raw/7a6a81d713316ade9771ac825db7ccaaa16d1283/openjpa-lib/src/test/java/org/apache/openjpa/lib/util/TestUUIDGenerator.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-lib/src/test/java/org/apache/openjpa/lib/util/TestUUIDGenerator.java?ref=7a6a81d713316ade9771ac825db7ccaaa16d1283","patch":"@@ -41,4 +41,13 @@ public void testUniqueHex() {\n         for (int i = 0; i < 10000; i++)\n             assertTrue(seen.add(UUIDGenerator.nextHex()));\n     }\n+\n+    public void testGetTime() {\n+        long time = 0;\n+        for (int i = 0; i < 10000; i++) {\n+            long newTime = UUIDGenerator.getTime();\n+            assertTrue(newTime != time);\n+            time = newTime;\n+        }\n+    }\n }"}]}

