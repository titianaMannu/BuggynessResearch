{"sha":"7bd43ff2e045047c103546f546ba024de3b70593","node_id":"MDY6Q29tbWl0MjA2MzY0OjdiZDQzZmYyZTA0NTA0N2MxMDM1NDZmNTQ2YmEwMjRkZTNiNzA1OTM=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2007-04-04T19:17:11Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2007-04-04T19:17:11Z"},"message":"OPENJPA-184: handle the case where dict is null in SQLExceptions by moving the logic into DB2Dictionary.newStoreException().\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@525583 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"35acfabc9951875124babdf8ca617a252a294354","url":"https://api.github.com/repos/apache/openjpa/git/trees/35acfabc9951875124babdf8ca617a252a294354"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/7bd43ff2e045047c103546f546ba024de3b70593","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/7bd43ff2e045047c103546f546ba024de3b70593","html_url":"https://github.com/apache/openjpa/commit/7bd43ff2e045047c103546f546ba024de3b70593","comments_url":"https://api.github.com/repos/apache/openjpa/commits/7bd43ff2e045047c103546f546ba024de3b70593/comments","author":null,"committer":null,"parents":[{"sha":"fa68b7dcad4816271de67ec62de6d53c615f0cb6","url":"https://api.github.com/repos/apache/openjpa/commits/fa68b7dcad4816271de67ec62de6d53c615f0cb6","html_url":"https://github.com/apache/openjpa/commit/fa68b7dcad4816271de67ec62de6d53c615f0cb6"}],"stats":{"total":21,"additions":11,"deletions":10},"files":[{"sha":"1f49d8923da44cb7a8f0a19f2e158aea75953f6d","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","status":"modified","additions":11,"deletions":2,"changes":13,"blob_url":"https://github.com/apache/openjpa/blob/7bd43ff2e045047c103546f546ba024de3b70593/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/7bd43ff2e045047c103546f546ba024de3b70593/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java?ref=7bd43ff2e045047c103546f546ba024de3b70593","patch":"@@ -24,6 +24,7 @@\n import org.apache.openjpa.jdbc.kernel.JDBCFetchConfiguration;\r\n import org.apache.openjpa.jdbc.schema.Sequence;\r\n import org.apache.openjpa.lib.log.Log;\r\n+import org.apache.openjpa.util.OpenJPAException;\r\n \r\n /**\r\n  * Dictionary for IBM DB2 database.\r\n@@ -443,10 +444,18 @@ public SQLBuffer toSelect(Select sel, boolean forUpdate,\n         return buf;\r\n     }\r\n \r\n-    /** Append exception information from SQLCA to the exsisting \r\n+    public OpenJPAException newStoreException(String msg, SQLException[] causes,\r\n+        Object failed) {\r\n+        if (causes != null && causes.length > 0)\r\n+            msg = appendExtendedExceptionMsg(msg, causes[0]);\r\n+        return super.newStoreException(msg, causes, failed);\r\n+    }\r\n+\r\n+    /**\r\n+     *  Append exception information from SQLCA to the exsisting\r\n      *  exception meassage\r\n      */\r\n-    public String appendExtendedExceptionMsg(String msg, SQLException sqle){\r\n+    private String appendExtendedExceptionMsg(String msg, SQLException sqle){\r\n        final String GETSQLCA =\"getSqlca\";\r\n        String exceptionMsg = new String();\r\n        try {\r"},{"sha":"c2e915a9ca450aacd5480a8ea37541bb425eab42","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","status":"modified","additions":0,"deletions":7,"changes":7,"blob_url":"https://github.com/apache/openjpa/blob/7bd43ff2e045047c103546f546ba024de3b70593/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/7bd43ff2e045047c103546f546ba024de3b70593/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DBDictionary.java?ref=7bd43ff2e045047c103546f546ba024de3b70593","patch":"@@ -2471,13 +2471,6 @@ public void appendCast(SQLBuffer buf, FilterValue val, int type) {\n         buf.append(post);\n     }\n     \n-    /** Append any database specific exception message to \n-     *  the exsisting exception message\n-     */\n-     public String appendExtendedExceptionMsg(String msg, SQLException sqle) {\n-         return msg; \n-     }\n-    \n     ///////////\n     // DDL SQL\n     ///////////"},{"sha":"3decfede9738c76520dedcc4601892faa186c3e3","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SQLExceptions.java","status":"modified","additions":0,"deletions":1,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/7bd43ff2e045047c103546f546ba024de3b70593/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SQLExceptions.java","raw_url":"https://github.com/apache/openjpa/raw/7bd43ff2e045047c103546f546ba024de3b70593/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SQLExceptions.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/SQLExceptions.java?ref=7bd43ff2e045047c103546f546ba024de3b70593","patch":"@@ -87,7 +87,6 @@ public static OpenJPAException getStore(String msg, SQLException se,\n         Object failed, DBDictionary dict) {\n         if (msg == null)\n             msg = se.getClass().getName();\n-        msg = dict.appendExtendedExceptionMsg(msg,se);\n         SQLException[] ses = getSQLExceptions(se);\n         if (dict == null)\n             return new StoreException(msg).setFailedObject(failed)."}]}

