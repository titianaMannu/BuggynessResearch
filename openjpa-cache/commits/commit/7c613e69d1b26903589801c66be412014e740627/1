{"sha":"7c613e69d1b26903589801c66be412014e740627","node_id":"MDY6Q29tbWl0MjA2MzY0OjdjNjEzZTY5ZDFiMjY5MDM1ODk4MDFjNjZiZTQxMjAxNGU3NDA2Mjc=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-03-22T15:20:38Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-03-22T15:20:38Z"},"message":"OPENJPA-1406 Split up DetachedStateField into two sections\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@926124 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"8bbf68a4e94fbd424e3e604c49b9dc560adfaa66","url":"https://api.github.com/repos/apache/openjpa/git/trees/8bbf68a4e94fbd424e3e604c49b9dc560adfaa66"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/7c613e69d1b26903589801c66be412014e740627","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/7c613e69d1b26903589801c66be412014e740627","html_url":"https://github.com/apache/openjpa/commit/7c613e69d1b26903589801c66be412014e740627","comments_url":"https://api.github.com/repos/apache/openjpa/commits/7c613e69d1b26903589801c66be412014e740627/comments","author":null,"committer":null,"parents":[{"sha":"773eefc3135294aa18d1122483e8a1d1b82f0c53","url":"https://api.github.com/repos/apache/openjpa/commits/773eefc3135294aa18d1122483e8a1d1b82f0c53","html_url":"https://github.com/apache/openjpa/commit/773eefc3135294aa18d1122483e8a1d1b82f0c53"}],"stats":{"total":167,"additions":91,"deletions":76},"files":[{"sha":"09d35eb548b71726254a9a4c71914c99153dd4cd","filename":"openjpa-project/src/doc/manual/ref_guide_remote.xml","status":"modified","additions":91,"deletions":76,"changes":167,"blob_url":"https://github.com/apache/openjpa/blob/7c613e69d1b26903589801c66be412014e740627/openjpa-project/src/doc/manual/ref_guide_remote.xml","raw_url":"https://github.com/apache/openjpa/raw/7c613e69d1b26903589801c66be412014e740627/openjpa-project/src/doc/manual/ref_guide_remote.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/src/doc/manual/ref_guide_remote.xml?ref=7c613e69d1b26903589801c66be412014e740627","patch":"@@ -224,89 +224,103 @@ When detached objects lose their association with the OpenJPA runtime, they also\n lose the ability to load additional state from the datastore. It is important,\n therefore, to populate objects with all the persistent state you will need\n before detaching them. While you are free to do this manually, OpenJPA includes\n-facilities for automatically populating objects when they detach. The\n-<link linkend=\"openjpa.DetachState\"><literal>openjpa.DetachState</literal>\n+facilities for automatically populating objects when they detach.\n+            </para>\n+            <section id=\"ref_guide_detach_state\">\n+                <title>\n+                    Detached State\n+                </title>\n+                <indexterm zone=\"ref_guide_detach_state\">\n+                    <primary>\n+                        detachment\n+                    </primary>\n+                    <secondary>\n+                        detached state\n+                    </secondary>\n+                </indexterm>\n+                <para>\n+The <link linkend=\"openjpa.DetachState\"><literal>openjpa.DetachState</literal>\n </link> configuration property determines which fields and relations are\n detached by default. All settings are recursive. They are:\n-            </para>\n-            <orderedlist>\n-                <listitem>\n-                    <para>\n+                </para>\n+                <orderedlist>\n+                    <listitem>\n+                        <para>\n <literal>loaded</literal>: Detach all fields and relations that are already\n loaded, but don't include unloaded fields in the detached graph. This is the\n default.\n-                    </para>\n-                </listitem>\n-                <listitem>\n-                    <para>\n+                        </para>\n+                    </listitem>\n+                    <listitem>\n+                        <para>\n <literal>fetch-groups</literal>: Detach all fields and relations in the current\n <link linkend=\"ref_guide_runtime\">fetch configuration</link>. For more\n information on custom fetch groups, see <xref linkend=\"ref_guide_fetch\"/>.\n-                    </para>\n-                </listitem>\n-                <listitem>\n-                    <para>\n+                        </para>\n+                    </listitem>\n+                    <listitem>\n+                        <para>\n <literal>all</literal>: Detach all fields and relations. Be very careful when\n using this mode; if you have a highly-connected domain featureSelection, you could end up\n bringing every object in the database into memory!\n-                    </para>\n-                </listitem>\n-            </orderedlist>\n-            <para>\n+                        </para>\n+                    </listitem>\n+                </orderedlist>\n+                <para>\n Any field that is not included in the set determined by the detach mode is set\n to its Java default value in the detached instance.\n-            </para>\n-            <para>\n+                </para>\n+                <para>\n The <literal>openjpa.DetachState</literal> option is actually a plugin string\n (see <xref linkend=\"ref_guide_conf_plugins\"/>) that allows you to also\n configure the following options related to detached state:\n-            </para>\n-            <itemizedlist>\n-                <listitem>\n-                    <para>\n+                </para>\n+                <itemizedlist>\n+                    <listitem>\n+                        <para>\n <literal>DetachedStateField</literal>: As described in\n <xref linkend=\"ref_guide_attach_behavior\"/> above, OpenJPA can take\n advantage of a <emphasis>detached state field</emphasis> to make the attach\n process more efficient. This field is added by the enhancer and is not visible\n to your application. Set this property to one of the following values:\n-                    </para>\n-                    <itemizedlist>\n-                        <listitem>\n-                            <para>\n+                        </para>\n+                        <itemizedlist>\n+                            <listitem>\n+                                <para>\n <literal>transient</literal>: Use a transient detached state field. This gives\n the benefits of a detached state field to local objects that are never\n serialized, but retains serialization compatibility for client tiers without\n access to the enhanced versions of your classes. This is the default.\n-                            </para>\n-                        </listitem>\n-                        <listitem>\n-                            <para>\n+                                </para>\n+                            </listitem>\n+                            <listitem>\n+                                <para>\n <literal>true</literal>: Use a non-transient detached state field so that\n objects crossing serialization barriers can still be attached efficiently. This\n requires, however, that your client tier have the enhanced versions of your\n classes and the OpenJPA libraries.\n-                            </para>\n-                        </listitem>\n-                        <listitem>\n-                            <para>\n+                                </para>\n+                            </listitem>\n+                            <listitem>\n+                                <para>\n <literal>false</literal>: Do not use a detached state field.\n-                            </para>\n-                        </listitem>\n-                    </itemizedlist>\n-                    <para>\n+                                </para>\n+                            </listitem>\n+                        </itemizedlist>\n+                        <para>\n You can override the setting of this property or declare your own detached state\n field on individual classes using OpenJPA's metadata extensions. See\n <xref linkend=\"ref_guide_detach_field\"/> below.\n-                    </para>\n-                </listitem>\n-                <listitem>\n-                    <para>\n+                        </para>\n+                    </listitem>\n+                    <listitem>\n+                        <para>\n <literal>DetachedStateManager</literal>: Whether to use a detached state\n manager. A detached state manager makes attachment much more efficient. Like a\n detached state field, however, it breaks serialization compatibility with the\n unenhanced class if it isn't transient.\n-                    </para>\n-                    <para>\n+                        </para>\n+                        <para>\n This setting piggybacks on the <literal>DetachedStateField</literal> setting\n above. If your detached state field is transient, the detached state manager\n will also be transient. If the detached state field is disabled, the detached\n@@ -317,18 +331,18 @@ setting this property to false, however, you can use a detached state field\n may be useful for debugging or for legacy OpenJPA users who find differences\n between OpenJPA's behavior with a detached state manager and OpenJPA's older\n behavior without one.\n-                    </para>\n-                </listitem>\n-                <listitem>\n-                    <para>\n+                        </para>\n+                    </listitem>\n+                    <listitem>\n+                        <para>\n <literal>AccessUnloaded</literal>: Whether to allow access to unloaded fields\n of detached objects. Defaults to true. Set to false to throw an exception\n whenever an unloaded field is accessed. This option is only available when you\n use detached state managers, as determined by the settings above.\n-                    </para>\n-                </listitem>\n-                <listitem>                    \n-                    <para>\n+                        </para>\n+                    </listitem>\n+                    <listitem>                    \n+                        <para>\n <literal>LiteAutoDetach</literal>: <emphasis role=\"bold\">This option is ONLY valid for the <literal>loaded</literal> \n DetachState setting.</emphasis> Detach all fields and relations as described by the loaded \n property when an explicit detach is requested or when a \n@@ -338,50 +352,51 @@ the minimal amount of work will be completed to disassociate all Entities from\n the persistence context. <emphasis role=\"bold\">It is highly recommended that all Entities have a \n @Version field when using this property</emphasis>. In addition, care needs to be taken \n when this value is set to true as the following caveats apply: \n-            <itemizedlist>\n-                <listitem>\n-                    <para>\n+                <itemizedlist>\n+                    <listitem>\n+                        <para>\n A relationship from a managed Entity to an unmanaged Entity which was detached by the lite detach setting will not be persisted.                                       \n-                    </para>       \n-                </listitem>\n-                <listitem>\n-                    <para>\n+                        </para>       \n+                    </listitem>\n+                    <listitem>\n+                        <para>\n When merging a detached Entity back into the persistence context any lazily loaded fields that were marked to null when detached will not be persisted.                                       \n-                    </para>       \n-                </listitem>                \n-            </itemizedlist>\n-                    </para>\n-                </listitem>\n-            </itemizedlist>\n-            <example id=\"ref_guide_detach_graph_confex\">\n-                <title>\n-                    Configuring Detached State\n-                </title>\n+                        </para>       \n+                    </listitem>                \n+                </itemizedlist>\n+                        </para>\n+                    </listitem>\n+                </itemizedlist>\n+                <example id=\"ref_guide_detach_graph_confex\">\n+                    <title>\n+                        Configuring Detached State\n+                    </title>\n <programlisting>\n &lt;property name=\"openjpa.DetachState\" value=\"fetch-groups(DetachedStateField=true)\"/&gt;\n </programlisting>\n-            </example>\n-            <para>\n+                </example>\n+                <para>\n You can also alter the set of fields that will be included in the detached graph\n at runtime.\n <ulink url=\"../javadoc/org/apache/openjpa/persistence/OpenJPAEntityManager.html\">\n <classname>OpenJPAEntityManager</classname></ulink>s expose the following APIs\n for controlling detached state:\n-            </para>\n+                </para>\n <programlisting>\n public DetachStateType getDetachState();\n public void setDetachState(DetachStateType type);\n </programlisting>\n-            <para>\n+                <para>\n The <classname>DetachStateType</classname> enum contains the following values:\n-            </para>\n+                </para>\n <programlisting>\n enum DetachStateType {\n     FETCH_GROUPS,\n     LOADED,\n     ALL\n }\n </programlisting>\n+            </section>\n             <section id=\"ref_guide_detach_field\">\n                 <title>\n                     Detached State Field"}]}

