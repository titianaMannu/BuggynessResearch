{"sha":"812e184e89c3bf7166a95f2e77ac88fbedc70854","node_id":"MDY6Q29tbWl0MjA2MzY0OjgxMmUxODRlODljM2JmNzE2NmE5NWYyZTc3YWM4OGZiZWRjNzA4NTQ=","commit":{"author":{"name":"Marc Prud'hommeaux","email":"mprudhom@apache.org","date":"2006-09-08T01:24:18Z"},"committer":{"name":"Marc Prud'hommeaux","email":"mprudhom@apache.org","date":"2006-09-08T01:24:18Z"},"message":"Added openjpa-all module which will manually create an openjpa-all-VERSION.jar file that aggregates all the other openja-*.jar files; fixed Configurations.java to provide more information when a missing services resource is caused by a deeper exception\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@441318 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"324e30f7fe71b934f088d6d7e8f33fff3c663d58","url":"https://api.github.com/repos/apache/openjpa/git/trees/324e30f7fe71b934f088d6d7e8f33fff3c663d58"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/812e184e89c3bf7166a95f2e77ac88fbedc70854","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/812e184e89c3bf7166a95f2e77ac88fbedc70854","html_url":"https://github.com/apache/openjpa/commit/812e184e89c3bf7166a95f2e77ac88fbedc70854","comments_url":"https://api.github.com/repos/apache/openjpa/commits/812e184e89c3bf7166a95f2e77ac88fbedc70854/comments","author":null,"committer":null,"parents":[{"sha":"1e5d09ce2f95e2c77fe85ba91b48990607f673ab","url":"https://api.github.com/repos/apache/openjpa/commits/1e5d09ce2f95e2c77fe85ba91b48990607f673ab","html_url":"https://github.com/apache/openjpa/commit/1e5d09ce2f95e2c77fe85ba91b48990607f673ab"}],"stats":{"total":181,"additions":152,"deletions":29},"files":[{"sha":"9a7a61ce6ec67ed439710c8613403ce0d8a77890","filename":"openjpa-all/pom.xml","status":"added","additions":91,"deletions":0,"changes":91,"blob_url":"https://github.com/apache/openjpa/blob/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-all/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-all/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-all/pom.xml?ref=812e184e89c3bf7166a95f2e77ac88fbedc70854","patch":"@@ -0,0 +1,91 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0\n+        http://maven.apache.org/maven-v4_0_0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <artifactId>openjpa-all</artifactId>\n+    <packaging>jar</packaging>\n+    <name>OpenJPA Aggregate Jar</name>\n+    <parent>\n+        <groupId>org.apache.openjpa</groupId>\n+        <artifactId>openjpa</artifactId>\n+        <version>0.9.0-incubating-SNAPSHOT</version>\n+    </parent>\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <!--\n+                    Manually build an aggregate jar of all the other\n+                    openjpa-* jars using ant. We cannot use the assembly\n+                    plugin, since it doesn't provide support for appending\n+                    multiple same-named files to each other (which is\n+                    required for correctly aggregating services files).\n+                -->\n+                <artifactId>maven-antrun-plugin</artifactId>\n+                <executions>\n+                    <execution>\n+                        <id>build-single-jar</id>\n+                        <phase>package</phase>\n+                        <configuration>\n+                            <tasks>\n+                                <unjar overwrite=\"false\"\n+                                    dest=\"${basedir}/target/classes\">\n+                                    <fileset dir=\"${basedir}/..\">\n+                                        <include name=\"*/target/openjpa-*.jar\"/>\n+                                    </fileset>\n+                                </unjar>\n+\n+                                <!--\n+                                    need to manually concatinate the services \n+                                    resources so they are aggregated\n+                                -->\n+                                <macrodef name=\"aggregate-file\">\n+                                   <attribute name=\"servicename\"/>\n+                                    <sequential>\n+                                        <echo>Building service: @{servicename}</echo>\n+                                        <concat destfile=\"${basedir}/target/classes/META-INF/services/@{servicename}\">\n+                                            <fileset dir=\"${basedir}/..\" includes=\"*/src/main/resources/META-INF/services/@{servicename}\"/>\n+                                        </concat>\n+                                    </sequential>\n+                                </macrodef>\n+\n+                                <aggregate-file servicename=\"org.apache.openjpa.conf.ProductDerivation\"/>\n+                                <aggregate-file servicename=\"javax.persistence.spi.PersistenceProvider\"/>\n+                                <aggregate-file servicename=\"org.apache.openjpa.kernel.exps.ExpressionParser\"/>\n+                                <aggregate-file servicename=\"org.apache.openjpa.lib.conf.ConfigurationProvider\"/>\n+                            </tasks>\n+                        </configuration>\n+                        <goals>\n+                            <goal>run</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+\n+            <!--\n+                create enhancer pre-main attribute\n+                copied from openjpa-kernel-5/pom.xml\n+            -->\n+            <plugin>\n+                <groupId>org.apache.maven.plugins</groupId>\n+                <artifactId>maven-jar-plugin</artifactId>\n+                <configuration>\n+                    <archive>\n+                        <manifestEntries>\n+                            <Premain-Class>\n+                                org.apache.openjpa.enhance.PCEnhancerAgent</Premain-Class>\n+                        </manifestEntries>\n+                    </archive>\n+                </configuration>\n+            </plugin>\n+        </plugins>\n+    </build>\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.openjpa</groupId>\n+            <artifactId>openjpa-persistence-jdbc</artifactId>\n+            <version>${pom.version}</version>\n+        </dependency>\n+    </dependencies>\n+</project>"},{"sha":"c1cb8f155cbae4eb03969228e6761178a2b0e9f0","filename":"openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java","status":"modified","additions":22,"deletions":15,"changes":37,"blob_url":"https://github.com/apache/openjpa/blob/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java","raw_url":"https://github.com/apache/openjpa/raw/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-lib/src/main/java/org/apache/openjpa/lib/conf/Configurations.java?ref=812e184e89c3bf7166a95f2e77ac88fbedc70854","patch":"@@ -18,8 +18,10 @@\n import java.io.File;\n import java.io.IOException;\n import java.util.Arrays;\n+import java.util.ArrayList;\n import java.util.Collection;\n import java.util.Iterator;\n+import java.util.List;\n import java.util.Map;\n import java.util.MissingResourceException;\n import java.util.Properties;\n@@ -30,6 +32,7 @@\n \n import org.apache.commons.lang.exception.NestableRuntimeException;\n import org.apache.openjpa.lib.log.Log;\n+import org.apache.openjpa.lib.util.JavaVersions;\n import org.apache.openjpa.lib.util.Localizer;\n import org.apache.openjpa.lib.util.Options;\n import org.apache.openjpa.lib.util.ParseException;\n@@ -466,36 +469,40 @@ private static ConfigurationProvider load(ClassLoader loader,\n             (ConfigurationProvider.class, loader);\n         ConfigurationProvider provider = null;\n         int providerCount = 0;\n-        StringBuffer errs = null;\n+        List errs = null;\n         for (int i = 0; i < impls.length; i++) {\n-            provider = newProvider(impls[i]);\n-            if (provider == null)\n-                continue;\n-\n-            providerCount++;\n             try {\n+                provider = (ConfigurationProvider) impls[i].newInstance();\n+                if (provider == null)\n+                    continue;\n+\n+                providerCount++;\n+\n                 if ((globals && provider.loadGlobals(loader))\n                     || (!globals && provider.loadDefaults(loader)))\n                     return provider;\n             } catch (MissingResourceException mre) {\n                 throw mre;\n-            } catch (Exception e) {\n-                if (errs == null)\n-                    errs = new StringBuffer();\n-                else\n-                    errs.append(\", \");\n-                errs.append(e.toString());\n+            } catch (Throwable t) {\n+                (errs == null ? errs = new ArrayList() : errs).add(t);\n             }\n         }\n \n         String type = (globals) ? \"globals\" : \"defaults\";\n+        MissingResourceException ex = null;\n+\n         if (errs != null)\n-            throw new MissingResourceException(errs.toString(),\n+            ex = new MissingResourceException(errs.toString(),\n                 Configurations.class.getName(), type);\n-        if (providerCount == 0)\n-            throw new MissingResourceException(_loc.get (\"no-providers\", \n+        else if (providerCount == 0)\n+            ex = new MissingResourceException(_loc.get (\"no-providers\", \n                 ConfigurationProvider.class.getName()).getMessage(),\n                 Configurations.class.getName(), type);\n+\n+        if (ex != null)\n+            throw (MissingResourceException) JavaVersions.initCause(ex,\n+                errs.size() == 0 ? null : (Throwable) errs.get(0));\n+\n         return null;\n     }\n "},{"sha":"d80eb4ea6a635c98d94c081ad5b621b4af0e9a13","filename":"openjpa-project/README.txt","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/apache/openjpa/blob/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-project/README.txt","raw_url":"https://github.com/apache/openjpa/raw/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-project/README.txt","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/README.txt?ref=812e184e89c3bf7166a95f2e77ac88fbedc70854","patch":"@@ -1,2 +1,6 @@\n \n-Thanks!\n+Thank you for downloading this incubator release of OpenJPA. For\n+documentation and project information, please see:\n+\n+  http://incubator.apache.org/openjpa/\n+"},{"sha":"fc08a875e9a74518e470e6f90d3b951a9f8fac86","filename":"openjpa-project/assembly.xml","status":"modified","additions":25,"deletions":10,"changes":35,"blob_url":"https://github.com/apache/openjpa/blob/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-project/assembly.xml","raw_url":"https://github.com/apache/openjpa/raw/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-project/assembly.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/assembly.xml?ref=812e184e89c3bf7166a95f2e77ac88fbedc70854","patch":"@@ -12,6 +12,7 @@\n                 <include>NOTICE*</include>\n             </includes>\n         </fileSet>\n+        <!--\n         <fileSet>\n             <directory>licenses</directory>\n             <outputDirectory>/lib</outputDirectory>\n@@ -31,6 +32,7 @@\n             <directory>target/examples</directory>\n             <outputDirectory>/examples</outputDirectory>\n         </fileSet>\n+        -->\n     </fileSets>\n     <dependencySets>\n         <dependencySet>\n@@ -65,30 +67,43 @@\n \n                 <!-- optional -->\n                 <exclude>junit:junit</exclude>\n+\n+                <!-- these are placed in the modules/ directory -->\n+                <exclude>org.apache.openjpa:openjpa-all</exclude>\n+                <exclude>org.apache.openjpa:openjpa-lib</exclude>\n+                <exclude>org.apache.openjpa:openjpa-kernel</exclude>\n+                <exclude>org.apache.openjpa:openjpa-kernel-4</exclude>\n+                <exclude>org.apache.openjpa:openjpa-kernel-5</exclude>\n+                <exclude>org.apache.openjpa:openjpa-jdbc</exclude>\n+                <exclude>org.apache.openjpa:openjpa-jdbc-5</exclude>\n+                <exclude>org.apache.openjpa:openjpa-persistence</exclude>\n+                <exclude>org.apache.openjpa:openjpa-persistence-jdbc</exclude>\n+                <exclude>org.apache.openjpa:openjpa-xmlstore</exclude>\n             </excludes>\n         </dependencySet>\n \n-\n-        <!--\n         <dependencySet>\n-            <outputDirectory>/optional</outputDirectory>\n+            <outputDirectory>/modules</outputDirectory>\n             <unpack>false</unpack>\n-            <scope>runtime</scope>\n             <includes>\n-                <include>org.apache.derby:derby</include>\n+                <include>org.apache.openjpa:openjpa-lib</include>\n+                <include>org.apache.openjpa:openjpa-kernel</include>\n+                <include>org.apache.openjpa:openjpa-kernel-4</include>\n+                <include>org.apache.openjpa:openjpa-kernel-5</include>\n+                <include>org.apache.openjpa:openjpa-jdbc</include>\n+                <include>org.apache.openjpa:openjpa-jdbc-5</include>\n+                <include>org.apache.openjpa:openjpa-persistence</include>\n+                <include>org.apache.openjpa:openjpa-persistence-jdbc</include>\n+                <include>org.apache.openjpa:openjpa-xmlstore</include>\n             </includes>\n         </dependencySet>\n-        -->\n \n-        <!--\n-         <dependencySet>\n+        <dependencySet>\n             <outputDirectory>/</outputDirectory>\n             <unpack>false</unpack>\n-            <scope>runtime</scope>\n             <includes>\n                 <include>org.apache.openjpa:openjpa-all</include>\n             </includes>\n         </dependencySet>\n-        -->\n     </dependencySets>\n </assembly>"},{"sha":"b9064e39963e04b6c6fd066f549bc239e7032e4a","filename":"openjpa-project/pom.xml","status":"modified","additions":8,"deletions":3,"changes":11,"blob_url":"https://github.com/apache/openjpa/blob/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-project/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/812e184e89c3bf7166a95f2e77ac88fbedc70854/openjpa-project/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/pom.xml?ref=812e184e89c3bf7166a95f2e77ac88fbedc70854","patch":"@@ -12,7 +12,7 @@\n     <modelVersion>4.0.0</modelVersion>\n     <artifactId>openjpa-project</artifactId>\n     <packaging>pom</packaging>\n-    <name>OpenJPA Project</name>\n+    <name>OpenJPA Distribution</name>\n     <parent>\n         <groupId>org.apache.openjpa</groupId>\n         <artifactId>openjpa</artifactId>\n@@ -78,7 +78,7 @@\n                         <id>bin</id>\n                         <phase>package</phase>\n                         <goals>\n-                            <goal>assembly</goal>\n+                            <goal>attached</goal>\n                         </goals>\n                         <configuration>\n                             <descriptor>assembly.xml</descriptor>\n@@ -91,7 +91,7 @@\n                         <id>sources</id>\n                         <phase>package</phase>\n                         <goals>\n-                            <goal>assembly</goal>\n+                            <goal>attached</goal>\n                         </goals>\n                         <configuration>\n                             <descriptor>source-assembly.xml</descriptor>\n@@ -134,6 +134,11 @@\n \n     <!-- need to explicitly list dependencies for assembly to work -->\n     <dependencies>\n+        <dependency>\n+            <groupId>org.apache.openjpa</groupId>\n+            <artifactId>openjpa-all</artifactId>\n+            <version>${pom.version}</version>\n+        </dependency>\n         <dependency>\n             <groupId>org.apache.openjpa</groupId>\n             <artifactId>openjpa-lib</artifactId>"},{"sha":"e66a1b2ef6b3c32ae520691ba89b6fd3955d7cdb","filename":"pom.xml","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/812e184e89c3bf7166a95f2e77ac88fbedc70854/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/812e184e89c3bf7166a95f2e77ac88fbedc70854/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/pom.xml?ref=812e184e89c3bf7166a95f2e77ac88fbedc70854","patch":"@@ -86,6 +86,7 @@\n         <module>openjpa-kernel</module>\n         <module>openjpa-jdbc</module>\n         <module>openjpa-xmlstore</module>\n+        <module>openjpa-all</module>\n         <module>openjpa-project</module>\n     </modules>\n     <profiles>"}]}

