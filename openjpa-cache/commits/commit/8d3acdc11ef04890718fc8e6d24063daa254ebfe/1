{"sha":"8d3acdc11ef04890718fc8e6d24063daa254ebfe","node_id":"MDY6Q29tbWl0MjA2MzY0OjhkM2FjZGMxMWVmMDQ4OTA3MThmYzhlNmQyNDA2M2RhYTI1NGViZmU=","commit":{"author":{"name":"Mark Struberg","email":"struberg@apache.org","date":"2021-04-03T14:08:13Z"},"committer":{"name":"Mark Struberg","email":"struberg@apache.org","date":"2021-04-03T14:08:13Z"},"message":"OPENJPA-2857 handle sqlState 70100 as QueryTimeoutException","tree":{"sha":"4ce98f140194fdca8ed9c9b40b5d2c74626c7eda","url":"https://api.github.com/repos/apache/openjpa/git/trees/4ce98f140194fdca8ed9c9b40b5d2c74626c7eda"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/8d3acdc11ef04890718fc8e6d24063daa254ebfe","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/8d3acdc11ef04890718fc8e6d24063daa254ebfe","html_url":"https://github.com/apache/openjpa/commit/8d3acdc11ef04890718fc8e6d24063daa254ebfe","comments_url":"https://api.github.com/repos/apache/openjpa/commits/8d3acdc11ef04890718fc8e6d24063daa254ebfe/comments","author":{"login":"struberg","id":79310,"node_id":"MDQ6VXNlcjc5MzEw","avatar_url":"https://avatars.githubusercontent.com/u/79310?v=4","gravatar_id":"","url":"https://api.github.com/users/struberg","html_url":"https://github.com/struberg","followers_url":"https://api.github.com/users/struberg/followers","following_url":"https://api.github.com/users/struberg/following{/other_user}","gists_url":"https://api.github.com/users/struberg/gists{/gist_id}","starred_url":"https://api.github.com/users/struberg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/struberg/subscriptions","organizations_url":"https://api.github.com/users/struberg/orgs","repos_url":"https://api.github.com/users/struberg/repos","events_url":"https://api.github.com/users/struberg/events{/privacy}","received_events_url":"https://api.github.com/users/struberg/received_events","type":"User","site_admin":false},"committer":{"login":"struberg","id":79310,"node_id":"MDQ6VXNlcjc5MzEw","avatar_url":"https://avatars.githubusercontent.com/u/79310?v=4","gravatar_id":"","url":"https://api.github.com/users/struberg","html_url":"https://github.com/struberg","followers_url":"https://api.github.com/users/struberg/followers","following_url":"https://api.github.com/users/struberg/following{/other_user}","gists_url":"https://api.github.com/users/struberg/gists{/gist_id}","starred_url":"https://api.github.com/users/struberg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/struberg/subscriptions","organizations_url":"https://api.github.com/users/struberg/orgs","repos_url":"https://api.github.com/users/struberg/repos","events_url":"https://api.github.com/users/struberg/events{/privacy}","received_events_url":"https://api.github.com/users/struberg/received_events","type":"User","site_admin":false},"parents":[{"sha":"ab8090f5566c68fd3d46600158527de14ce622f2","url":"https://api.github.com/repos/apache/openjpa/commits/ab8090f5566c68fd3d46600158527de14ce622f2","html_url":"https://github.com/apache/openjpa/commit/ab8090f5566c68fd3d46600158527de14ce622f2"}],"stats":{"total":5,"additions":3,"deletions":2},"files":[{"sha":"78d608f85897f07e87d9d8a31d6c4dfec0b81c34","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MariaDBDictionary.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/apache/openjpa/blob/8d3acdc11ef04890718fc8e6d24063daa254ebfe/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MariaDBDictionary.java","raw_url":"https://github.com/apache/openjpa/raw/8d3acdc11ef04890718fc8e6d24063daa254ebfe/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MariaDBDictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/MariaDBDictionary.java?ref=8d3acdc11ef04890718fc8e6d24063daa254ebfe","patch":"@@ -469,7 +469,8 @@ protected int matchErrorState(Map<Integer,Set<String>> errorStates, SQLException\n \n     @Override\n     public boolean isFatalException(int subtype, SQLException ex) {\n-        if ((subtype == StoreException.LOCK  && ex.getErrorCode() == 1205)\n+        if ((subtype == StoreException.LOCK  && ex.getErrorCode() == 1205) // ER_LOCK_WAIT_TIMEOUT\n+          ||(subtype == StoreException.LOCK  && ex.getErrorCode() == 1969) // general ER_STATEMENT_TIMEOUT\n           ||(subtype == StoreException.LOCK  && \"JZ0002\".equalsIgnoreCase(ex.getSQLState()))\n           ||(subtype == StoreException.QUERY && ex.getErrorCode() == 1317)) {\n             return false;"},{"sha":"afcff44b3cbf033c2284e4d8656eb451381706d3","filename":"openjpa-jdbc/src/main/resources/org/apache/openjpa/jdbc/sql/sql-error-state-codes.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/8d3acdc11ef04890718fc8e6d24063daa254ebfe/openjpa-jdbc/src/main/resources/org/apache/openjpa/jdbc/sql/sql-error-state-codes.xml","raw_url":"https://github.com/apache/openjpa/raw/8d3acdc11ef04890718fc8e6d24063daa254ebfe/openjpa-jdbc/src/main/resources/org/apache/openjpa/jdbc/sql/sql-error-state-codes.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/resources/org/apache/openjpa/jdbc/sql/sql-error-state-codes.xml?ref=8d3acdc11ef04890718fc8e6d24063daa254ebfe","patch":"@@ -164,7 +164,7 @@\n \t</dictionary>\n \n     <dictionary class=\"org.apache.openjpa.jdbc.sql.MariaDBDictionary\">\n-        <lock>41000</lock>\n+        <lock>41000,70100</lock>\n         <referential-integrity>630,839,840,893,1062,1169,1215,1216,1217,1451,1452,1557</referential-integrity>\n         <object-exists>23000</object-exists>\n         <object-not-found></object-not-found>"}]}

