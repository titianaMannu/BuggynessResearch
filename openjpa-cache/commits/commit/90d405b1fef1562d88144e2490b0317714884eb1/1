{"sha":"90d405b1fef1562d88144e2490b0317714884eb1","node_id":"MDY6Q29tbWl0MjA2MzY0OjkwZDQwNWIxZmVmMTU2MmQ4ODE0NGUyNDkwYjAzMTc3MTQ4ODRlYjE=","commit":{"author":{"name":"Albert Lee","email":"allee8285@apache.org","date":"2010-04-07T18:21:10Z"},"committer":{"name":"Albert Lee","email":"allee8285@apache.org","date":"2010-04-07T18:21:10Z"},"message":"OPENJPA-1609 - Commit contribution by Jody Grassel.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/2.0.x@931634 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"6774e104c5b5324b296b1ae66f7d4e68400a2fa0","url":"https://api.github.com/repos/apache/openjpa/git/trees/6774e104c5b5324b296b1ae66f7d4e68400a2fa0"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/90d405b1fef1562d88144e2490b0317714884eb1","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/90d405b1fef1562d88144e2490b0317714884eb1","html_url":"https://github.com/apache/openjpa/commit/90d405b1fef1562d88144e2490b0317714884eb1","comments_url":"https://api.github.com/repos/apache/openjpa/commits/90d405b1fef1562d88144e2490b0317714884eb1/comments","author":null,"committer":null,"parents":[{"sha":"127d2b7d630a76fa3c09ddabd4eb5a4889ff694c","url":"https://api.github.com/repos/apache/openjpa/commits/127d2b7d630a76fa3c09ddabd4eb5a4889ff694c","html_url":"https://github.com/apache/openjpa/commit/127d2b7d630a76fa3c09ddabd4eb5a4889ff694c"}],"stats":{"total":12,"additions":11,"deletions":1},"files":[{"sha":"0423444343ec97a59004512c5d76b19676d5be75","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","status":"modified","additions":11,"deletions":1,"changes":12,"blob_url":"https://github.com/apache/openjpa/blob/90d405b1fef1562d88144e2490b0317714884eb1/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/90d405b1fef1562d88144e2490b0317714884eb1/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java?ref=90d405b1fef1562d88144e2490b0317714884eb1","patch":"@@ -929,8 +929,18 @@ public boolean isFatalException(int subtype, SQLException ex) {\n         int errorCode = ex.getErrorCode();\n         if (errorCode == -952 && \"57014\".equals(errorState))\n             return false;\n+        /*\n+         * Check if this Exception was generated by a lock timeout expiration.\n+         * The following criteria are used to determine this:\n+         * \n+         * DB2 LUW Infocenter: SQLSTATE=57033 with reason code \"80\" indicates\n+         * the statement failed due to timeout. DB2 for z/OS Stored Procedures:\n+         * Through the CALL and Beyond, page 188: An ErrorCode of -913 with\n+         * SQLERR 00C9008E means a timeout has occurred.\n+         */\n         if (subtype == StoreException.LOCK && \"57033\".equals(errorState)\n-            && ex.getMessage().indexOf(\"80\") != -1) {\n+            && ((ex.getMessage().indexOf(\"80\") != -1) \n+                || (errorCode == -913 && ex.getMessage().contains(\"00C9008E\")))) {\n             return false;\n         } \n         if ((subtype == StoreException.QUERY && \"57014\".equals(errorState) &&"}]}

