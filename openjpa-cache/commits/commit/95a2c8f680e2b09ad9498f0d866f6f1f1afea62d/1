{"sha":"95a2c8f680e2b09ad9498f0d866f6f1f1afea62d","node_id":"MDY6Q29tbWl0MjA2MzY0Ojk1YTJjOGY2ODBlMmIwOWFkOTQ5OGYwZDg2NmY2ZjFmMWFmZWE2MmQ=","commit":{"author":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2009-09-17T21:46:56Z"},"committer":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2009-09-17T21:46:56Z"},"message":"Fix SQL comparison failures in Criteria query by example tests on Oracle by using standard sql92 join syntax.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@816392 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"0988380a30082789d5a98e798924fee029ad3670","url":"https://api.github.com/repos/apache/openjpa/git/trees/0988380a30082789d5a98e798924fee029ad3670"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/95a2c8f680e2b09ad9498f0d866f6f1f1afea62d","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/95a2c8f680e2b09ad9498f0d866f6f1f1afea62d","html_url":"https://github.com/apache/openjpa/commit/95a2c8f680e2b09ad9498f0d866f6f1f1afea62d","comments_url":"https://api.github.com/repos/apache/openjpa/commits/95a2c8f680e2b09ad9498f0d866f6f1f1afea62d/comments","author":null,"committer":null,"parents":[{"sha":"e5f7d97695681a8efb23f0cb67975fe25c5fd1c1","url":"https://api.github.com/repos/apache/openjpa/commits/e5f7d97695681a8efb23f0cb67975fe25c5fd1c1","html_url":"https://github.com/apache/openjpa/commit/e5f7d97695681a8efb23f0cb67975fe25c5fd1c1"}],"stats":{"total":20,"additions":20,"deletions":0},"files":[{"sha":"2289ce948f20d3aa51666d9bd545aa349c1b087c","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/criteria/TestQueryByExample.java","status":"modified","additions":20,"deletions":0,"changes":20,"blob_url":"https://github.com/apache/openjpa/blob/95a2c8f680e2b09ad9498f0d866f6f1f1afea62d/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/criteria/TestQueryByExample.java","raw_url":"https://github.com/apache/openjpa/raw/95a2c8f680e2b09ad9498f0d866f6f1f1afea62d/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/criteria/TestQueryByExample.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/criteria/TestQueryByExample.java?ref=95a2c8f680e2b09ad9498f0d866f6f1f1afea62d","patch":"@@ -21,6 +21,12 @@\n import javax.persistence.criteria.CriteriaQuery;\n import javax.persistence.metamodel.Attribute;\n \n+import org.apache.openjpa.jdbc.conf.JDBCConfiguration;\n+import org.apache.openjpa.jdbc.sql.DBDictionary;\n+import org.apache.openjpa.jdbc.sql.OracleDictionary;\n+import org.apache.openjpa.persistence.OpenJPAEntityManagerSPI;\n+import org.apache.openjpa.persistence.criteria.AbstractCriteriaTestCase.SQLAuditor;\n+\n /**\n  * Tests different styles for query by example.\n  * \n@@ -29,6 +35,20 @@\n  */\n public class TestQueryByExample extends CriteriaTest {\n     \n+    public void setUp() {\n+        super.setUp();\n+        \n+        // If using an Oracle DB, use sql92 syntax in order to get a correct\n+        // comparison of SQL.  This may not work on Oracle JDBC drivers\n+        // prior to 10.x\n+        OpenJPAEntityManagerSPI ojem = (OpenJPAEntityManagerSPI)em;\n+        DBDictionary dict = ((JDBCConfiguration) ojem.getConfiguration())\n+            .getDBDictionaryInstance();\n+        if (dict instanceof OracleDictionary) {\n+            dict.setJoinSyntax(\"sql92\");\n+        }\n+    }\n+    \n     public void testBasicFieldsWithNonDefaultValue() {\n         String jpql = \"SELECT e FROM Employee e WHERE e.rating=1 AND e.salary=1100\";\n         "}]}

