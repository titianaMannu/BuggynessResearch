{"sha":"98802147f761d93873462aa6aa0038a8926ec421","node_id":"MDY6Q29tbWl0MjA2MzY0Ojk4ODAyMTQ3Zjc2MWQ5Mzg3MzQ2MmFhNmFhMDAzOGE4OTI2ZWM0MjE=","commit":{"author":{"name":"Catalina Wei","email":"fancy@apache.org","date":"2008-07-24T01:36:44Z"},"committer":{"name":"Catalina Wei","email":"fancy@apache.org","date":"2008-07-24T01:36:44Z"},"message":"OPENJPA-241 Extra SQL on lazy CMR load\ncommit openjpa_241_1.patch on behalf of Fay Wang\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@679261 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c16c438871375d770ac6f66dcd3f5031f18aa337","url":"https://api.github.com/repos/apache/openjpa/git/trees/c16c438871375d770ac6f66dcd3f5031f18aa337"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/98802147f761d93873462aa6aa0038a8926ec421","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/98802147f761d93873462aa6aa0038a8926ec421","html_url":"https://github.com/apache/openjpa/commit/98802147f761d93873462aa6aa0038a8926ec421","comments_url":"https://api.github.com/repos/apache/openjpa/commits/98802147f761d93873462aa6aa0038a8926ec421/comments","author":null,"committer":null,"parents":[{"sha":"37d610ca2ccf499479ea0cfb36ca91fcc5e0946e","url":"https://api.github.com/repos/apache/openjpa/commits/37d610ca2ccf499479ea0cfb36ca91fcc5e0946e","html_url":"https://github.com/apache/openjpa/commit/37d610ca2ccf499479ea0cfb36ca91fcc5e0946e"}],"stats":{"total":15,"additions":6,"deletions":9},"files":[{"sha":"065e0996adfdc128ea7d5e5c49a1c1652fd32d8d","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/StoreCollectionFieldStrategy.java","status":"modified","additions":6,"deletions":9,"changes":15,"blob_url":"https://github.com/apache/openjpa/blob/98802147f761d93873462aa6aa0038a8926ec421/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/StoreCollectionFieldStrategy.java","raw_url":"https://github.com/apache/openjpa/raw/98802147f761d93873462aa6aa0038a8926ec421/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/StoreCollectionFieldStrategy.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/StoreCollectionFieldStrategy.java?ref=98802147f761d93873462aa6aa0038a8926ec421","patch":"@@ -347,15 +347,12 @@ private void setMappedBy(Object oid, OpenJPAStateManager sm, Object coll,\n                     ((Collection) coll).iterator().next();\n                 OpenJPAStateManager sm1 = (OpenJPAStateManager) pc.\n                     pcGetStateManager();\n-                FieldMapping[] fms = ((ClassMapping) sm1.getMetaData()).\n-                    getDeclaredFieldMappings();\n-                for (int i = 0; i < fms.length; i++) {\n-                    if (fms[i] == mappedByFieldMapping) {\n-                        res.setMappedByValue(sm1.fetchObject(fms[i].\n-                            getIndex()));\n-                        break;\n-                    }\n-                } \n+                \n+                ClassMapping clm = ((ClassMapping) sm1.getMetaData());\n+                FieldMapping fm = (FieldMapping) clm.getField(\n+                    mappedByFieldMapping.getName());\n+                if (fm == mappedByFieldMapping)\n+                    res.setMappedByValue(sm1.fetchObject(fm.getIndex()));\n             } else {\n                 res.setMappedByValue(null);\n             }"}]}

