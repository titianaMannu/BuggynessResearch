{"sha":"9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","node_id":"MDY6Q29tbWl0MjA2MzY0OjlhNDQwNjAzOGUyMmUxNGNkOWE1YjZhYzk2YmI0Y2QyMjQ0ZGNiNmY=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-08-25T13:04:12Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2009-08-25T13:04:12Z"},"message":"OPENJPA-1174: default fetch type for ManyToOne and OneToOne is eager.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@807602 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"e38229d54735f3b878b0fb2759d283f94610fbf6","url":"https://api.github.com/repos/apache/openjpa/git/trees/e38229d54735f3b878b0fb2759d283f94610fbf6"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","html_url":"https://github.com/apache/openjpa/commit/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","comments_url":"https://api.github.com/repos/apache/openjpa/commits/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/comments","author":null,"committer":null,"parents":[{"sha":"049c91707b870ef184f40e25c8295e374ddf36ed","url":"https://api.github.com/repos/apache/openjpa/commits/049c91707b870ef184f40e25c8295e374ddf36ed","html_url":"https://github.com/apache/openjpa/commit/049c91707b870ef184f40e25c8295e374ddf36ed"}],"stats":{"total":66,"additions":64,"deletions":2},"files":[{"sha":"23a337286d35a343e484ee523d50461a3f7e6e68","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/apache/openjpa/blob/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security.java","raw_url":"https://github.com/apache/openjpa/raw/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security.java?ref=9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","patch":"@@ -34,6 +34,9 @@\n     @JoinColumn(name=\"COUNTRY_ID\")\n     private Country country;\n \n+    @ManyToOne\n+    private Country countryEager;\n+\n     public Security() {\n         super();\n     }\n@@ -56,6 +59,14 @@ public void setCountry(Country c) {\n         this.country = c;\n     }\n \n+    public Country getCountryEager() {\n+        return countryEager;\n+    }\n+\n+    public void setCountryEager(Country c) {\n+        this.countryEager = c;\n+    }\n+\n     public Embed getSymbol() {\n         return symbol;\n     }"},{"sha":"d7766889398f4954c72c82c8eea34e7be59c7214","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security1.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/apache/openjpa/blob/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security1.java","raw_url":"https://github.com/apache/openjpa/raw/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security1.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/Security1.java?ref=9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","patch":"@@ -26,6 +26,8 @@\n     \n     private Country1 country;\n \n+    private Country1 countryEager;\n+\n     public Security1() {\n         super();\n     }\n@@ -48,6 +50,14 @@ public void setCountry1(Country1 c) {\n         this.country = c;\n     }\n \n+    public Country1 getCountryEager() {\n+        return countryEager;\n+    }\n+\n+    public void setCountryEager(Country1 c) {\n+        this.countryEager = c;\n+    }\n+\n     public Embed getSymbol() {\n         return symbol;\n     }"},{"sha":"97ccfcc1c5dbbcb7f3ab20729ffc8d344fb81405","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/TestXMLPersistenceMetaDataParser.java","status":"modified","additions":39,"deletions":0,"changes":39,"blob_url":"https://github.com/apache/openjpa/blob/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/TestXMLPersistenceMetaDataParser.java","raw_url":"https://github.com/apache/openjpa/raw/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/TestXMLPersistenceMetaDataParser.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/TestXMLPersistenceMetaDataParser.java?ref=9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","patch":"@@ -126,6 +126,45 @@ public void testManyToOneLazyFetch() {\n         em.close();\n \n     }\n+    \n+    public void testManyToOneEagerFetch() {\n+        // initialize objects\n+        EntityManager em = emf.createEntityManager();\n+\n+        long aI_sid = 148007245;\n+        long aUS_sid = 2;\n+\n+        Security1 aI_security = new Security1(aI_sid, new Embed(\"XYZ\"));\n+        Country1 aUS_country = new Country1(aUS_sid, \"USA\");\n+        aI_security.setCountry1(aUS_country);\n+        aI_security.setCountryEager(aUS_country);\n+        \n+        Security aI_securityAnn = new Security(aI_sid, new Embed(\"XYZ\"));\n+        Country aUS_countryAnn = new Country(aUS_sid, \"USA\");\n+        aI_securityAnn.setCountry(aUS_countryAnn);\n+        aI_securityAnn.setCountryEager(aUS_countryAnn);\n+\n+        em.getTransaction().begin();\n+        em.persist(aI_security);\n+        em.persist(aUS_country);\n+        em.getTransaction().commit();\n+        em.clear();\n+\n+        aI_security = em.find(Security1.class, aI_sid);\n+        em.clear();\n+        Country1 countryEager = aI_security.getCountryEager(); \n+        assertNotNull(countryEager);\n+        \n+        aI_securityAnn = em.find(Security.class, aI_sid);\n+        em.clear();\n+        Country countryEagerAnn = aI_securityAnn.getCountryEager(); \n+        assertNotNull(countryEagerAnn);\n+        \n+        // Close\n+        em.close();\n+        \n+    }\n+    \n \n     private void printArrayList(ArrayList aList) {\n         Iterator itr = aList.iterator();"},{"sha":"bf6e0eddc9f5de1f135ede60839357a076743aaf","filename":"openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/orm.xml","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/orm.xml","raw_url":"https://github.com/apache/openjpa/raw/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/orm.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/orm.xml?ref=9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","patch":"@@ -31,6 +31,8 @@\n             <many-to-one name=\"country\" optional=\"false\" fetch=\"LAZY\">\n                 <join-column name=\"COUNTRY_ID\" />\n             </many-to-one>\n+            <many-to-one name=\"countryEager\">\n+            </many-to-one>\n             <embedded name=\"symbol\" />\n         </attributes>\n     </entity>"},{"sha":"c83784925233dd2137eb26edb5771480178e3493","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/XMLPersistenceMetaDataParser.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/XMLPersistenceMetaDataParser.java","raw_url":"https://github.com/apache/openjpa/raw/9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/XMLPersistenceMetaDataParser.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/XMLPersistenceMetaDataParser.java?ref=9a4406038e22e14cd9a5b6ac96bb4cd2244dcb6f","patch":"@@ -1425,7 +1425,7 @@ private void assertPC(FieldMetaData fmd, String attr)\n     protected void parseOneToOne(FieldMetaData fmd, Attributes attrs)\n         throws SAXException {\n         String val = attrs.getValue(\"fetch\");\n-        if (val != null && \"EAGER\".equals(val)) {\n+        if (val == null || \"EAGER\".equals(val)) {\n             fmd.setInDefaultFetchGroup(true);\n         }\n         val = attrs.getValue(\"target-entity\");\n@@ -1444,7 +1444,7 @@ protected void parseOneToOne(FieldMetaData fmd, Attributes attrs)\n     protected void parseManyToOne(FieldMetaData fmd, Attributes attrs)\n         throws SAXException {\n         String val = attrs.getValue(\"fetch\");\n-        if (val != null && \"EAGER\".equals(val)) {\n+        if (val == null || \"EAGER\".equals(val)) {\n             fmd.setInDefaultFetchGroup(true);\n         }\n         val = attrs.getValue(\"target-entity\");"}]}

