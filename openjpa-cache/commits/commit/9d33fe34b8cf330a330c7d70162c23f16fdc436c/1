{"sha":"9d33fe34b8cf330a330c7d70162c23f16fdc436c","node_id":"MDY6Q29tbWl0MjA2MzY0OjlkMzNmZTM0YjhjZjMzMGEzMzBjN2Q3MDE2MmMyM2YxNmZkYzQzNmM=","commit":{"author":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2010-06-08T16:41:27Z"},"committer":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2010-06-08T16:41:27Z"},"message":"OPENJPA-1685 Updated ValidatorImpl to remove potential whitespace within a comma separated list of validation groups.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@952730 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"274794bc1abb5f22f60acb34e0465e83e81a7c7a","url":"https://api.github.com/repos/apache/openjpa/git/trees/274794bc1abb5f22f60acb34e0465e83e81a7c7a"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/9d33fe34b8cf330a330c7d70162c23f16fdc436c","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/9d33fe34b8cf330a330c7d70162c23f16fdc436c","html_url":"https://github.com/apache/openjpa/commit/9d33fe34b8cf330a330c7d70162c23f16fdc436c","comments_url":"https://api.github.com/repos/apache/openjpa/commits/9d33fe34b8cf330a330c7d70162c23f16fdc436c/comments","author":null,"committer":null,"parents":[{"sha":"c68f1de7802d0d8458a8f439a373c93db75751f0","url":"https://api.github.com/repos/apache/openjpa/commits/c68f1de7802d0d8458a8f439a373c93db75751f0","html_url":"https://github.com/apache/openjpa/commit/c68f1de7802d0d8458a8f439a373c93db75751f0"}],"stats":{"total":43,"additions":39,"deletions":4},"files":[{"sha":"a584313c861e7348fdc58dc7deac714e495ed593","filename":"openjpa-integration/validation/src/test/java/org/apache/openjpa/integration/validation/TestValidationGroups.java","status":"modified","additions":19,"deletions":2,"changes":21,"blob_url":"https://github.com/apache/openjpa/blob/9d33fe34b8cf330a330c7d70162c23f16fdc436c/openjpa-integration/validation/src/test/java/org/apache/openjpa/integration/validation/TestValidationGroups.java","raw_url":"https://github.com/apache/openjpa/raw/9d33fe34b8cf330a330c7d70162c23f16fdc436c/openjpa-integration/validation/src/test/java/org/apache/openjpa/integration/validation/TestValidationGroups.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/validation/src/test/java/org/apache/openjpa/integration/validation/TestValidationGroups.java?ref=9d33fe34b8cf330a330c7d70162c23f16fdc436c","patch":"@@ -122,7 +122,20 @@ public void testNonDefaultValidationGroupFlush() {\n     }\n     \n     /**\n-     * 2b) verify multiple/mixed validation groups\n+     * 2b1) verify multiple/mixed validation groups via persistence.xml\n+     * @param flush\n+     */\n+    public void testPesistenceXMLMultipleValidationGroups() {\n+\n+        OpenJPAEntityManagerFactorySPI emf = (OpenJPAEntityManagerFactorySPI) \n+        OpenJPAPersistence.createEntityManagerFactory(\n+                \"multi-validation-group-xml\",\n+                \"org/apache/openjpa/integration/validation/persistence.xml\");\n+        assertNotNull(emf);\n+        verifyMultipleValidationGroups(emf);\n+    }\n+    /**\n+     * 2b2) verify multiple/mixed validation groups via properties\n      * @param flush\n      */\n     public void testMultipleValidationGroups() {\n@@ -145,10 +158,14 @@ public void testMultipleValidationGroups() {\n                 \"org/apache/openjpa/integration/validation/persistence.xml\",\n                 propMap);\n         assertNotNull(emf);\n+        verifyMultipleValidationGroups(emf);\n+    }\n+        \n+    private void verifyMultipleValidationGroups(OpenJPAEntityManagerFactorySPI emf) {\n         // create EM\n         OpenJPAEntityManager em = emf.createEntityManager();\n         assertNotNull(em);\n-\n+        \n         try {\n             MixedGrpEntity mge = new MixedGrpEntity();\n             "},{"sha":"4aa5c79404f016754ba345c5dc286d028fac0082","filename":"openjpa-integration/validation/src/test/resources/org/apache/openjpa/integration/validation/persistence.xml","status":"modified","additions":17,"deletions":0,"changes":17,"blob_url":"https://github.com/apache/openjpa/blob/9d33fe34b8cf330a330c7d70162c23f16fdc436c/openjpa-integration/validation/src/test/resources/org/apache/openjpa/integration/validation/persistence.xml","raw_url":"https://github.com/apache/openjpa/raw/9d33fe34b8cf330a330c7d70162c23f16fdc436c/openjpa-integration/validation/src/test/resources/org/apache/openjpa/integration/validation/persistence.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-integration/validation/src/test/resources/org/apache/openjpa/integration/validation/persistence.xml?ref=9d33fe34b8cf330a330c7d70162c23f16fdc436c","patch":"@@ -125,6 +125,23 @@\n         </properties>\n     </persistence-unit>\n \n+    <persistence-unit name=\"multi-validation-group-xml\">\n+        <class>org.apache.openjpa.integration.validation.MixedGrpEntity</class>\n+        <validation-mode>CALLBACK</validation-mode>\n+        <properties>\n+            <property name=\"openjpa.jdbc.SynchronizeMappings\" \n+                value=\"buildSchema\"/>\n+            <!--  OPENJPA-1685 Filter whitespace from group list -->\n+            <property name=\"javax.persistence.validation.group.pre-persist\"\n+                value=\"org.apache.openjpa.integration.validation.ValGroup1,\n+                       org.apache.openjpa.integration.validation.ValGroup2\"/>\n+            <property name=\"javax.persistence.validation.group.pre-update\"\n+                value=\"\"/>\n+            <property name=\"javax.persistence.validation.group.pre-remove\"\n+                value=\"org.apache.openjpa.integration.validation.ValGroup2  \"/>\n+        </properties>\n+    </persistence-unit>\n+\n     <persistence-unit name=\"ConstraintPU\">\n         <class>org.apache.openjpa.integration.validation.ConstraintNull</class>\n         <class>org.apache.openjpa.integration.validation.ConstraintBoolean</class>"},{"sha":"624de97ea6f2e1eeea81bfab49e2a57ff580d146","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/validation/ValidatorImpl.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/apache/openjpa/blob/9d33fe34b8cf330a330c7d70162c23f16fdc436c/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/validation/ValidatorImpl.java","raw_url":"https://github.com/apache/openjpa/raw/9d33fe34b8cf330a330c7d70162c23f16fdc436c/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/validation/ValidatorImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/validation/ValidatorImpl.java?ref=9d33fe34b8cf330a330c7d70162c23f16fdc436c","patch":"@@ -30,6 +30,7 @@\n import javax.validation.Validator;\n import javax.validation.ValidatorFactory;\n \n+import org.apache.commons.lang.StringUtils;\n import org.apache.openjpa.conf.OpenJPAConfiguration;\n import org.apache.openjpa.event.LifecycleEvent;\n import org.apache.openjpa.lib.conf.Configuration;\n@@ -219,10 +220,10 @@ public void addValidationGroup(String validationGroupName, String group) {\n             vgGrp = new Class<?>[strClasses.length];\n             for (int i = 0; i < strClasses.length; i++) {\n                 try {\n-                    vgGrp[i] =  Class.forName(strClasses[i]);\n+                    vgGrp[i] =  Class.forName(StringUtils.trim(strClasses[i]));\n                 } catch (Throwable t) {\n                     throw new IllegalArgumentException(\n-                        _loc.get(\"invalid-validation-group\", strClasses[i], \n+                        _loc.get(\"invalid-validation-group\", StringUtils.trim(strClasses[i]),\n                             vgName).getMessage(), t);\n                 }\n             }            "}]}

