{"sha":"a6ffd14d02e54ac95af7038586aa0f403958fdc2","node_id":"MDY6Q29tbWl0MjA2MzY0OmE2ZmZkMTRkMDJlNTRhYzk1YWY3MDM4NTg2YWEwZjQwMzk1OGZkYzI=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-04-22T20:09:28Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-04-22T20:09:28Z"},"message":"OPENJPA-576. Reverting Sandeep's change pending an updated change from him.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/1.1.x@650633 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"fb3767b3c5957ca249efbf9eae89f5a9646dd5df","url":"https://api.github.com/repos/apache/openjpa/git/trees/fb3767b3c5957ca249efbf9eae89f5a9646dd5df"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/a6ffd14d02e54ac95af7038586aa0f403958fdc2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/a6ffd14d02e54ac95af7038586aa0f403958fdc2","html_url":"https://github.com/apache/openjpa/commit/a6ffd14d02e54ac95af7038586aa0f403958fdc2","comments_url":"https://api.github.com/repos/apache/openjpa/commits/a6ffd14d02e54ac95af7038586aa0f403958fdc2/comments","author":null,"committer":null,"parents":[{"sha":"bf6da0b5fe2a1e0dc22a0d748fb7c26207eb659c","url":"https://api.github.com/repos/apache/openjpa/commits/bf6da0b5fe2a1e0dc22a0d748fb7c26207eb659c","html_url":"https://github.com/apache/openjpa/commit/bf6da0b5fe2a1e0dc22a0d748fb7c26207eb659c"}],"stats":{"total":27,"additions":7,"deletions":20},"files":[{"sha":"016d53d974a79ab9f8a474ea4ddf9896563ab152","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/EmbedFieldStrategy.java","status":"modified","additions":7,"deletions":20,"changes":27,"blob_url":"https://github.com/apache/openjpa/blob/a6ffd14d02e54ac95af7038586aa0f403958fdc2/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/EmbedFieldStrategy.java","raw_url":"https://github.com/apache/openjpa/raw/a6ffd14d02e54ac95af7038586aa0f403958fdc2/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/EmbedFieldStrategy.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/meta/strats/EmbedFieldStrategy.java?ref=a6ffd14d02e54ac95af7038586aa0f403958fdc2","patch":"@@ -405,13 +405,6 @@ public void load(OpenJPAStateManager sm, JDBCStore store,\n             return;\n         }\n \n-        if (fetch.requiresFetch(field.getFieldMetaData()) \n-            != JDBCFetchConfiguration.FETCH_LOAD) {\n-          return;\n-        } else {\n-          fetch = fetch.traverseJDBC(field.getFieldMetaData());\n-        }\n-        \n         //### note: without a null indicator column, the above indicatesNull()\n         //### call will always return false, meaning we always have to assume\n         //### we selected the embedded object fields and load the object\n@@ -424,7 +417,7 @@ public void load(OpenJPAStateManager sm, JDBCStore store,\n \n         FieldMapping[] fields = field.getEmbeddedMapping().getFieldMappings();\n         Object eres, processed;\n-        boolean loaded = true;\n+        boolean loaded = false;\n         for (int i = 0; i < fields.length; i++) {\n             eres = res.getEager(fields[i]);\n             res.startDataRequest(fields[i]);\n@@ -436,24 +429,18 @@ else if (eres != null) {\n                         fields[i].loadEagerParallel(em, store, fetch, eres);\n                     if (processed != eres)\n                         res.putEager(fields[i], processed);\n-                } else {\n+                } else\n                     fields[i].load(em, store, fetch, res);\n-                }\n-                FieldMetaData fm = fields[i].getFieldMetaData();\n-                loaded &= em.getLoaded().get(i) || \n-                    (fm != null && fetch.requiresFetch(fm)\n-                        != FetchConfiguration.FETCH_LOAD);\n+                loaded |= em.getLoaded().get(i);\n             } finally {\n                 res.endDataRequest();\n             }\n         }\n \n-        // After loading everything from result, load the rest of the\n-        // configured fields if anything is missing.\n-        if (!loaded) {\n-          em.load(fetch);\n-        }\n-        \n+        // after loading everything from result, load the rest of the\n+        // configured fields\n+        if (loaded)\n+            em.load(fetch);\n     }\n \n     /**"}]}

