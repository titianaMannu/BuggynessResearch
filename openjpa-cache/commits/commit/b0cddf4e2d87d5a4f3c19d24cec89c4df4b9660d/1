{"sha":"b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d","node_id":"MDY6Q29tbWl0MjA2MzY0OmIwY2RkZjRlMmQ4N2Q1YTRmM2MxOWQyNGNlYzg5YzRkZjRiOTY2MGQ=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2007-08-21T15:21:50Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2007-08-21T15:21:50Z"},"message":"OPENJPA-256. Applied patch supplied by Bernd.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@568164 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"e500c6c7a616c684c14bf1cd4b608696bf2aba78","url":"https://api.github.com/repos/apache/openjpa/git/trees/e500c6c7a616c684c14bf1cd4b608696bf2aba78"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d","html_url":"https://github.com/apache/openjpa/commit/b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d","comments_url":"https://api.github.com/repos/apache/openjpa/commits/b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d/comments","author":null,"committer":null,"parents":[{"sha":"56f6b437909815b1974c391d6496a1c4c5f87382","url":"https://api.github.com/repos/apache/openjpa/commits/56f6b437909815b1974c391d6496a1c4c5f87382","html_url":"https://github.com/apache/openjpa/commit/56f6b437909815b1974c391d6496a1c4c5f87382"}],"stats":{"total":13,"additions":13,"deletions":0},"files":[{"sha":"093a81065af959036cb5b963128a993181e6acff","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/QueryCompilationCacheValue.java","status":"modified","additions":13,"deletions":0,"changes":13,"blob_url":"https://github.com/apache/openjpa/blob/b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d/openjpa-kernel/src/main/java/org/apache/openjpa/conf/QueryCompilationCacheValue.java","raw_url":"https://github.com/apache/openjpa/raw/b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d/openjpa-kernel/src/main/java/org/apache/openjpa/conf/QueryCompilationCacheValue.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/QueryCompilationCacheValue.java?ref=b0cddf4e2d87d5a4f3c19d24cec89c4df4b9660d","patch":"@@ -26,6 +26,7 @@\n import org.apache.openjpa.lib.conf.PluginValue;\r\n import org.apache.openjpa.lib.util.concurrent.ConcurrentMap;\r\n import org.apache.openjpa.lib.util.concurrent.ConcurrentHashMap;\r\n+import org.apache.openjpa.lib.util.ParseException;\r\n import org.apache.openjpa.util.CacheMap;\r\n \r\n /**\r\n@@ -58,6 +59,18 @@ public Object newInstance(String clsName, Class type,\n         \r\n         try {\r\n             map = (Map) super.newInstance(clsName, type, conf, fatal);\r\n+        } catch (ParseException pe) {\r\n+            // OPENJPA256: this class differs from most plugins in that\r\n+            // the plugin type is the standard java interface Map.class (rather\r\n+            // than an openjpa-specific interface), which means that the\r\n+            // ClassLoader used to load the implementation will be the system\r\n+            // class loader; this presents a problem if OpenJPA is not in the\r\n+            // system classpath, so work around the problem by catching\r\n+            // the ParseException (which is what we wrap the\r\n+            // ClassNotFoundException in) and try again, this time using\r\n+            // this class' ClassLoader.\r\n+            map = (Map) super.newInstance(clsName,\r\n+                QueryCompilationCacheValue.class, conf, fatal);\r\n         } catch (IllegalArgumentException iae) {\r\n             // OPENJPA256: this class differs from most plugins in that\r\n             // the plugin type is the standard java interface Map.class (rather\r"}]}

