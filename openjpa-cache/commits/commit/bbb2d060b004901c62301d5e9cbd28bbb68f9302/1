{"sha":"bbb2d060b004901c62301d5e9cbd28bbb68f9302","node_id":"MDY6Q29tbWl0MjA2MzY0OmJiYjJkMDYwYjAwNDkwMWM2MjMwMWQ1ZTljYmQyOGJiYjY4ZjkzMDI=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2006-07-25T19:49:48Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2006-07-25T19:49:48Z"},"message":"changed AutoDetachValue to extend StringListValue, more closely modeling its behavior in the Kodo configuration system; changed visibility of XML name conversion method\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@425499 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"d8ce5dd9eb07079d4ff7e3437279b8955038588c","url":"https://api.github.com/repos/apache/openjpa/git/trees/d8ce5dd9eb07079d4ff7e3437279b8955038588c"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/bbb2d060b004901c62301d5e9cbd28bbb68f9302","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/bbb2d060b004901c62301d5e9cbd28bbb68f9302","html_url":"https://github.com/apache/openjpa/commit/bbb2d060b004901c62301d5e9cbd28bbb68f9302","comments_url":"https://api.github.com/repos/apache/openjpa/commits/bbb2d060b004901c62301d5e9cbd28bbb68f9302/comments","author":null,"committer":null,"parents":[{"sha":"e9aa22eddc521128fa8dd0a97215eb0dfee5388c","url":"https://api.github.com/repos/apache/openjpa/commits/e9aa22eddc521128fa8dd0a97215eb0dfee5388c","html_url":"https://github.com/apache/openjpa/commit/e9aa22eddc521128fa8dd0a97215eb0dfee5388c"}],"stats":{"total":50,"additions":15,"deletions":35},"files":[{"sha":"b2c4a066fa11183c336a4b7c95e65248d48fdad5","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/AutoDetachValue.java","status":"modified","additions":13,"deletions":33,"changes":46,"blob_url":"https://github.com/apache/openjpa/blob/bbb2d060b004901c62301d5e9cbd28bbb68f9302/openjpa-kernel/src/main/java/org/apache/openjpa/conf/AutoDetachValue.java","raw_url":"https://github.com/apache/openjpa/raw/bbb2d060b004901c62301d5e9cbd28bbb68f9302/openjpa-kernel/src/main/java/org/apache/openjpa/conf/AutoDetachValue.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/AutoDetachValue.java?ref=bbb2d060b004901c62301d5e9cbd28bbb68f9302","patch":"@@ -16,8 +16,7 @@\n package org.apache.openjpa.conf;\n \n import org.apache.openjpa.kernel.AutoDetach;\n-import org.apache.openjpa.lib.conf.Value;\n-import serp.util.Strings;\n+import org.apache.openjpa.lib.conf.StringListValue;\n \n /**\n  * Value type used to represent auto detach flags. Separate to\n@@ -27,7 +26,7 @@\n  * @nojavadoc\n  */\n class AutoDetachValue\n-    extends Value {\n+    extends StringListValue {\n \n     public static final String DETACH_CLOSE = \"close\";\n     public static final String DETACH_COMMIT = \"commit\";\n@@ -43,49 +42,30 @@\n     };\n \n     private int _flags;\n+    private boolean _flagsSet;\n \n     public AutoDetachValue() {\n         super(\"AutoDetach\");\n         setAliases(ALIASES);\n+        setAliasListComprehensive(true);\n     }\n \n     public Class getValueType() {\n         return String[].class;\n     }\n \n-    public void set(int flags) {\n+    public void setConstant(int flags) {\n         _flags = flags;\n     }\n \n-    public int get() {\n-        return _flags;\n-    }\n-\n-    protected String getInternalString() {\n-        StringBuffer buf = new StringBuffer();\n-        String[] aliases = getAliases();\n-        boolean start = false;\n-        for (int i = 0; i < aliases.length; i += 2) {\n-            if ((_flags & Integer.parseInt(aliases[i + 1])) != 0) {\n-                buf.append(aliases[i]);\n-                if (start)\n-                    buf.append(\", \");\n-                else\n-                    start = true;\n-            }\n+    public int getConstant() {\n+        if (!_flagsSet) {\n+            String[] vals = get();\n+            for (int i = 0; i < vals.length; i++)\n+                _flags |= Integer.parseInt(unalias(vals[i]));\n+            _flagsSet = true;\n         }\n-        return buf.toString();\n-    }\n-\n-    public void setInternalString(String val) {\n-        String[] vals = Strings.split(val, \",\", 0);\n-        for (int i = 0; i < vals.length; i++)\n-            _flags |= Integer.parseInt(unalias(vals[i]));\n-    }\n-\n-    public void setInternalObject(Object val) {\n-        String[] vals = (String[]) val;\n-        for (int i = 0; i < vals.length; i++)\n-            _flags |= Integer.parseInt(unalias(vals[i]));\n+            \n+        return _flags;\n     }\n }"},{"sha":"3df6dd1b11684d4540dd2431a63b20751e833ba4","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/bbb2d060b004901c62301d5e9cbd28bbb68f9302/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","raw_url":"https://github.com/apache/openjpa/raw/bbb2d060b004901c62301d5e9cbd28bbb68f9302/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java?ref=bbb2d060b004901c62301d5e9cbd28bbb68f9302","patch":"@@ -1105,11 +1105,11 @@ public String getAutoDetach() {\n     }\n \n     public void setAutoDetach(int autoDetachFlags) {\n-        autoDetach.set(autoDetachFlags);\n+        autoDetach.setConstant(autoDetachFlags);\n     }\n \n     public int getAutoDetachConstant() {\n-        return autoDetach.get();\n+        return autoDetach.getConstant();\n     }\n \n     public void setDetachState(String detachState) {"}]}

