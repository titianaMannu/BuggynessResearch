{"sha":"bdaf1412986c76bf490cd508ec815a7c61f38791","node_id":"MDY6Q29tbWl0MjA2MzY0OmJkYWYxNDEyOTg2Yzc2YmY0OTBjZDUwOGVjODE1YTdjNjFmMzg3OTE=","commit":{"author":{"name":"Heath Thomann","email":"hthomann@apache.org","date":"2015-04-16T23:34:58Z"},"committer":{"name":"Heath Thomann","email":"hthomann@apache.org","date":"2015-04-16T23:34:58Z"},"message":"OPENJPA-1988: Made an update to the test case for this JIRA, i.e. merged r1642555 from 2.2.x to trunk\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1674167 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"3f90d93c11b55947b8460e697215daa666a8bfad","url":"https://api.github.com/repos/apache/openjpa/git/trees/3f90d93c11b55947b8460e697215daa666a8bfad"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/bdaf1412986c76bf490cd508ec815a7c61f38791","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/bdaf1412986c76bf490cd508ec815a7c61f38791","html_url":"https://github.com/apache/openjpa/commit/bdaf1412986c76bf490cd508ec815a7c61f38791","comments_url":"https://api.github.com/repos/apache/openjpa/commits/bdaf1412986c76bf490cd508ec815a7c61f38791/comments","author":null,"committer":null,"parents":[{"sha":"fbbfc9d3245089284129dcd719c289a877867169","url":"https://api.github.com/repos/apache/openjpa/commits/fbbfc9d3245089284129dcd719c289a877867169","html_url":"https://github.com/apache/openjpa/commit/fbbfc9d3245089284129dcd719c289a877867169"}],"stats":{"total":96,"additions":25,"deletions":71},"files":[{"sha":"434a21a763639b1bf8193a3cbc3c4a0d434ab5a6","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/cascade/pudefault/TestPUDefaultCascadePersist.java","status":"modified","additions":9,"deletions":32,"changes":41,"blob_url":"https://github.com/apache/openjpa/blob/bdaf1412986c76bf490cd508ec815a7c61f38791/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/cascade/pudefault/TestPUDefaultCascadePersist.java","raw_url":"https://github.com/apache/openjpa/raw/bdaf1412986c76bf490cd508ec815a7c61f38791/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/cascade/pudefault/TestPUDefaultCascadePersist.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/cascade/pudefault/TestPUDefaultCascadePersist.java?ref=bdaf1412986c76bf490cd508ec815a7c61f38791","patch":"@@ -19,46 +19,22 @@\n package org.apache.openjpa.persistence.cascade.pudefault;\n \n import javax.persistence.EntityManager;\n-import javax.persistence.EntityManagerFactory;\n \n-import org.apache.openjpa.persistence.OpenJPAPersistence;\n import org.apache.openjpa.persistence.test.SingleEMFTestCase;\n \n public class TestPUDefaultCascadePersist extends SingleEMFTestCase {\n-    private EntityManagerFactory emf = null;\n     public void setUp() throws Exception {\n-        super.setUp();\n-        emf = OpenJPAPersistence.\n-                createEntityManagerFactory(\"TestPUDefaultCascadePersist\", \n-                    \"org/apache/openjpa/persistence/cascade/pudefault/META-INF/persistence.xml\");\n-        \n-        EntityManager em = emf.createEntityManager();\n-        try {\n-            em.getTransaction().begin();\n-            em.createQuery(\"DELETE FROM PUDEntityA01\").executeUpdate();\n-            em.createQuery(\"DELETE FROM PUDEntityA02\").executeUpdate();\n-            em.createQuery(\"DELETE FROM PUDEntityAE01\").executeUpdate();\n-            em.createQuery(\"DELETE FROM PUDEntityB\").executeUpdate();\n-            em.createQuery(\"DELETE FROM PUDEntityA01_PUDEntityB\").executeUpdate();\n-            em.createQuery(\"DELETE FROM PUDEntityA02_PUDEntityB\").executeUpdate();\n-            em.createQuery(\"DELETE FROM PUDEntityAE01_PUDEntityB\").executeUpdate();\n-            em.getTransaction().commit();\n-        } catch (Throwable t) {\n-            // Swallow\n-        } finally {\n-            if (em.getTransaction().isActive()) {\n-                em.getTransaction().rollback();\n-            }\n-            em.close();\n-        }\n-//        super.setUp(PUDEntityA01.class, PUDEntityB.class,\n-//            \"org/apache/openjpa/persistence/cascade/pudefault/META-INF/cascadepersistorm.xml\",\n-//            CLEAR_TABLES);\n+        super.setUp(PUDEntityA01.class, PUDEntityA02.class, PUDEntityAE01.class, PUDEntityB.class,\n+            CLEAR_TABLES);\n+    }\n+    \n+    protected String getPersistenceUnitName() {\n+        return \"TestPUDefaultCascadePersist\";\n     }\n     \n+    \n     public void tearDown() throws Exception {\n         super.tearDown();\n-        emf.close();\n     }\n     \n     public void testPUDefaultCascadePersistOverM2M() {\n@@ -83,9 +59,10 @@ public void testPUDefaultCascadePersistOverM2M() {\n             if (em.getTransaction().isActive()) {\n                 em.getTransaction().rollback();\n             }\n+            em.close();\n         }\n                \n-        em.close();\n+        \n         em = emf.createEntityManager();\n         \n         try {"},{"sha":"b93780b49bc579a60f6f402bd1550fb4f6cf14ab","filename":"openjpa-persistence-jdbc/src/test/resources/META-INF/cascade-persist.xml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/apache/openjpa/blob/bdaf1412986c76bf490cd508ec815a7c61f38791/openjpa-persistence-jdbc/src/test/resources/META-INF/cascade-persist.xml","raw_url":"https://github.com/apache/openjpa/raw/bdaf1412986c76bf490cd508ec815a7c61f38791/openjpa-persistence-jdbc/src/test/resources/META-INF/cascade-persist.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/resources/META-INF/cascade-persist.xml?ref=bdaf1412986c76bf490cd508ec815a7c61f38791","previous_filename":"openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/cascade/pudefault/META-INF/cascadepersistorm.xml"},{"sha":"85328bf6902977d0fa2f07ff1adfcd9a1739c276","filename":"openjpa-persistence-jdbc/src/test/resources/META-INF/persistence.xml","status":"modified","additions":16,"deletions":1,"changes":17,"blob_url":"https://github.com/apache/openjpa/blob/bdaf1412986c76bf490cd508ec815a7c61f38791/openjpa-persistence-jdbc/src/test/resources/META-INF/persistence.xml","raw_url":"https://github.com/apache/openjpa/raw/bdaf1412986c76bf490cd508ec815a7c61f38791/openjpa-persistence-jdbc/src/test/resources/META-INF/persistence.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/resources/META-INF/persistence.xml?ref=bdaf1412986c76bf490cd508ec815a7c61f38791","patch":"@@ -506,4 +506,19 @@\n \t\t</properties>\n \t</persistence-unit>      \n \n-</persistence>\n\\ No newline at end of file\n+    <persistence-unit name=\"TestPUDefaultCascadePersist\" transaction-type=\"RESOURCE_LOCAL\">\n+        <!--  <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider> -->\n+        <mapping-file>META-INF/cascade-persist.xml</mapping-file>\n+        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityA01</class>\n+        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityAE01</class>\n+        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityA02</class>\n+        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityB</class>\n+        <class>org.apache.openjpa.persistence.cascade.pudefault.AnEmbeddable</class>\n+        <class>org.apache.openjpa.persistence.cascade.pudefault.EmbeddableWithRelationships</class>\n+        <properties>\n+            <property name=\"openjpa.ConnectionFactoryProperties\" value=\"MaxActive=110, MaxIdle=10, ValidationTimeout=50000, \n+                                                                     MaxCachedStatements=10, ValidationSQL='', MaxWait=10000, TestOnBorrow=true\" />\n+            <property name=\"openjpa.jdbc.SynchronizeMappings\" value=\"buildSchema(ForeignKeys=true)\" />\n+        </properties>\n+    </persistence-unit>\n+</persistence>"},{"sha":"ae1b9fc249b96a88fbab527477a71ce3362bc5bb","filename":"openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/cascade/pudefault/META-INF/persistence.xml","status":"removed","additions":0,"deletions":38,"changes":38,"blob_url":"https://github.com/apache/openjpa/blob/fbbfc9d3245089284129dcd719c289a877867169/openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/cascade/pudefault/META-INF/persistence.xml","raw_url":"https://github.com/apache/openjpa/raw/fbbfc9d3245089284129dcd719c289a877867169/openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/cascade/pudefault/META-INF/persistence.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/resources/org/apache/openjpa/persistence/cascade/pudefault/META-INF/persistence.xml?ref=fbbfc9d3245089284129dcd719c289a877867169","patch":"@@ -1,38 +0,0 @@\n-<!--\n- Licensed to the Apache Software Foundation (ASF) under one\n- or more contributor license agreements.  See the NOTICE file\n- distributed with this work for additional information\n- regarding copyright ownership.  The ASF licenses this file\n- to you under the Apache License, Version 2.0 (the\n- \"License\"); you may not use this file except in compliance\n- with the License.  You may obtain a copy of the License at\n- \n- http://www.apache.org/licenses/LICENSE-2.0\n- \n- Unless required by applicable law or agreed to in writing,\n- software distributed under the License is distributed on an\n- \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- KIND, either express or implied.  See the License for the\n- specific language governing permissions and limitations\n- under the License.   \n--->\n-<persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" \n-    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n-    xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\" \n-    version=\"1.0\">\n-    <persistence-unit name=\"TestPUDefaultCascadePersist\" transaction-type=\"RESOURCE_LOCAL\">\n-        <!--  <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider> -->\n-        <mapping-file>org/apache/openjpa/persistence/cascade/pudefault/META-INF/cascadepersistorm.xml</mapping-file>\n-        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityA01</class>\n-        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityAE01</class>\n-        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityA02</class>\n-        <class>org.apache.openjpa.persistence.cascade.pudefault.PUDEntityB</class>\n-        <class>org.apache.openjpa.persistence.cascade.pudefault.AnEmbeddable</class>\n-        <class>org.apache.openjpa.persistence.cascade.pudefault.EmbeddableWithRelationships</class>\n-        <properties>\n-            <property name=\"openjpa.ConnectionFactoryProperties\" value=\"MaxActive=110, MaxIdle=10, ValidationTimeout=50000, \n-                                                                     MaxCachedStatements=10, ValidationSQL='', MaxWait=10000, TestOnBorrow=true\" />\n-            <property name=\"openjpa.jdbc.SynchronizeMappings\" value=\"buildSchema(ForeignKeys=true)\" />\n-        </properties>\n-    </persistence-unit>\n-</persistence>"}]}

