{"sha":"bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9","node_id":"MDY6Q29tbWl0MjA2MzY0OmJkYjA5MDc0YTdkZDhhYjMxN2QyOGU1ZjdlMTFlYmUzZjY2OGVmYjk=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-07-28T15:35:13Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-07-28T15:35:13Z"},"message":"OPENJPA-1726: exclude the test case from running on Postgres as Postgres does not support setQueryTimeout.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@980101 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"fd05d2c691677962360df1925aac1dd282e45df3","url":"https://api.github.com/repos/apache/openjpa/git/trees/fd05d2c691677962360df1925aac1dd282e45df3"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9","html_url":"https://github.com/apache/openjpa/commit/bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9","comments_url":"https://api.github.com/repos/apache/openjpa/commits/bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9/comments","author":null,"committer":null,"parents":[{"sha":"e97e42b3eb5a3297f60e4c9a816d8dff8a8f9359","url":"https://api.github.com/repos/apache/openjpa/commits/e97e42b3eb5a3297f60e4c9a816d8dff8a8f9359","html_url":"https://github.com/apache/openjpa/commit/e97e42b3eb5a3297f60e4c9a816d8dff8a8f9359"}],"stats":{"total":18,"additions":18,"deletions":0},"files":[{"sha":"1b7c879dd6b1b3562358f8d8414561d1786d6fef","filename":"openjpa-persistence-locking/src/test/java/org/apache/openjpa/persistence/lockmgr/TestPessimisticLocks.java","status":"modified","additions":18,"deletions":0,"changes":18,"blob_url":"https://github.com/apache/openjpa/blob/bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9/openjpa-persistence-locking/src/test/java/org/apache/openjpa/persistence/lockmgr/TestPessimisticLocks.java","raw_url":"https://github.com/apache/openjpa/raw/bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9/openjpa-persistence-locking/src/test/java/org/apache/openjpa/persistence/lockmgr/TestPessimisticLocks.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-locking/src/test/java/org/apache/openjpa/persistence/lockmgr/TestPessimisticLocks.java?ref=bdb09074a7dd8ab317d28e5f7e11ebe3f668efb9","patch":"@@ -34,6 +34,7 @@\n import org.apache.openjpa.jdbc.conf.JDBCConfiguration;\n import org.apache.openjpa.jdbc.sql.DBDictionary;\n import org.apache.openjpa.persistence.LockTimeoutException;\n+import org.apache.openjpa.persistence.OpenJPAEntityManagerFactorySPI;\n import org.apache.openjpa.persistence.test.SQLListenerTestCase;\n import org.apache.openjpa.util.OpenJPAException;\n \n@@ -46,6 +47,23 @@\n     private DBDictionary dict = null;\n \n     public void setUp() {\n+        // Disable tests for any DB that has supportsQueryTimeout==false, like Postgres\n+        OpenJPAEntityManagerFactorySPI tempEMF = emf;\n+        if (tempEMF == null) {\n+            tempEMF = createEMF();\n+        }\n+        assertNotNull(tempEMF);\n+        DBDictionary dict = ((JDBCConfiguration)tempEMF.getConfiguration()).getDBDictionaryInstance();\n+        assertNotNull(dict);\n+        if (!dict.supportsQueryTimeout)\n+            setTestsDisabled(true);\n+        if (emf == null) {\n+            closeEMF(tempEMF);\n+        }\n+\n+        if (isTestsDisabled())\n+            return;\n+        \n         setUp(CLEAR_TABLES, Employee.class, Department.class, \"openjpa.LockManager\", \"mixed\");\n \n         EntityManager em = null;"}]}

