{"sha":"c880fdeb7f49d70236357c662480bb71349fa7ff","node_id":"MDY6Q29tbWl0MjA2MzY0OmM4ODBmZGViN2Y0OWQ3MDIzNjM1N2M2NjI0ODBiYjcxMzQ5ZmE3ZmY=","commit":{"author":{"name":"Catalina Wei","email":"fancy@apache.org","date":"2009-09-03T22:34:08Z"},"committer":{"name":"Catalina Wei","email":"fancy@apache.org","date":"2009-09-03T22:34:08Z"},"message":"OPENJPA-1287 Criteria query to generate 'optimize for 1 row' for DB2 if selection is an aggregate function\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@811159 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"8e6ebe9b269c38a5c6defbb2e9e23efb2fac1f88","url":"https://api.github.com/repos/apache/openjpa/git/trees/8e6ebe9b269c38a5c6defbb2e9e23efb2fac1f88"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/c880fdeb7f49d70236357c662480bb71349fa7ff","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/c880fdeb7f49d70236357c662480bb71349fa7ff","html_url":"https://github.com/apache/openjpa/commit/c880fdeb7f49d70236357c662480bb71349fa7ff","comments_url":"https://api.github.com/repos/apache/openjpa/commits/c880fdeb7f49d70236357c662480bb71349fa7ff/comments","author":null,"committer":null,"parents":[{"sha":"301fc200d184da687730336c6da1eb6608bf0d44","url":"https://api.github.com/repos/apache/openjpa/commits/301fc200d184da687730336c6da1eb6608bf0d44","html_url":"https://github.com/apache/openjpa/commit/301fc200d184da687730336c6da1eb6608bf0d44"}],"stats":{"total":3,"additions":2,"deletions":1},"files":[{"sha":"4b75c997fa867243f606589b657268af40089997","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/kernel/QueryImpl.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/c880fdeb7f49d70236357c662480bb71349fa7ff/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/QueryImpl.java","raw_url":"https://github.com/apache/openjpa/raw/c880fdeb7f49d70236357c662480bb71349fa7ff/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/QueryImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/QueryImpl.java?ref=c880fdeb7f49d70236357c662480bb71349fa7ff","patch":"@@ -446,7 +446,7 @@ public boolean isUnique() {\n             assertOpen();\n             if (_unique != null)\n                 return _unique.booleanValue();\n-            if (_query == null || _compiling || _broker == null)\n+            if ((_query == null && _language.endsWith(\"JPQL\")) || _compiling || _broker == null)\n                 return false;\n \n             // check again after compilation; maybe encoded in string"},{"sha":"8f4ccf0964d9fc2bc396b948db29c2dd0ef6135b","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/criteria/CriteriaExpressionBuilder.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/apache/openjpa/blob/c880fdeb7f49d70236357c662480bb71349fa7ff/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/criteria/CriteriaExpressionBuilder.java","raw_url":"https://github.com/apache/openjpa/raw/c880fdeb7f49d70236357c662480bb71349fa7ff/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/criteria/CriteriaExpressionBuilder.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/criteria/CriteriaExpressionBuilder.java?ref=c880fdeb7f49d70236357c662480bb71349fa7ff","patch":"@@ -84,6 +84,7 @@ public QueryExpressions getQueryExpressions(ExpressionFactory factory, CriteriaQ\n         exps.resultClass = q.getResultType();\n         exps.shape = evalResultShape(q);\n         exps.parameterTypes = q.getParameterTypes();\n+        exps.isAggregate();\n         return exps;\n     }\n "}]}

