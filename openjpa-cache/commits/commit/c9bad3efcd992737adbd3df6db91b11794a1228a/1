{"sha":"c9bad3efcd992737adbd3df6db91b11794a1228a","node_id":"MDY6Q29tbWl0MjA2MzY0OmM5YmFkM2VmY2Q5OTI3MzdhZGJkM2RmNmRiOTFiMTE3OTRhMTIyOGE=","commit":{"author":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2010-10-25T20:03:01Z"},"committer":{"name":"Jeremy Bauer","email":"jrbauer@apache.org","date":"2010-10-25T20:03:01Z"},"message":"OPENJPA-1853 Modified DB2Dictionary to disable auto retrieval of generated keys on iSeries V5R4 and earlier.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@1027250 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"9b81ea835f1c370a985bbfe623de636dd0a431da","url":"https://api.github.com/repos/apache/openjpa/git/trees/9b81ea835f1c370a985bbfe623de636dd0a431da"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/c9bad3efcd992737adbd3df6db91b11794a1228a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/c9bad3efcd992737adbd3df6db91b11794a1228a","html_url":"https://github.com/apache/openjpa/commit/c9bad3efcd992737adbd3df6db91b11794a1228a","comments_url":"https://api.github.com/repos/apache/openjpa/commits/c9bad3efcd992737adbd3df6db91b11794a1228a/comments","author":null,"committer":null,"parents":[{"sha":"48f47fc775393cb60f04cf887fcd0fbb00bca428","url":"https://api.github.com/repos/apache/openjpa/commits/48f47fc775393cb60f04cf887fcd0fbb00bca428","html_url":"https://github.com/apache/openjpa/commit/48f47fc775393cb60f04cf887fcd0fbb00bca428"}],"stats":{"total":9,"additions":9,"deletions":0},"files":[{"sha":"160ffc794bf554b42835ff52aef1d5ac1f2cc046","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","status":"modified","additions":9,"deletions":0,"changes":9,"blob_url":"https://github.com/apache/openjpa/blob/c9bad3efcd992737adbd3df6db91b11794a1228a/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/c9bad3efcd992737adbd3df6db91b11794a1228a/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java?ref=c9bad3efcd992737adbd3df6db91b11794a1228a","patch":"@@ -393,6 +393,10 @@ else if (isDB2UDBV82OrLater())\n             }\n             sequenceSchemaSQL = \"SEQUENCE_SCHEMA = ?\";\n             sequenceNameSQL = \"SEQUENCE_NAME = ?\";\n+            // V5R4 and earlier systems do not support retrieval of generated keys\n+            if (isDB2ISeriesV5R4OrEarlier()) {\n+            \tsupportsGetGeneratedKeys = false;\n+            }\n             break;\n         }\n     }\n@@ -483,6 +487,11 @@ public boolean isDB2ISeriesV5R4OrLater() {\n            && (maj >=6 || (maj == 5 && min >=4));\n     }\n \n+    public boolean isDB2ISeriesV5R4OrEarlier() {\n+        return (databaseProductName.indexOf(\"AS\") != -1\n+            && ((maj == 5 && min <=4) || maj < 5));\n+     }\n+\n     public boolean isDB2UDBV81OrEarlier() {\n         return (databaseProductVersion.indexOf(\"SQL\") != -1 \n             || databaseProductName.indexOf(\"DB2/\") != -1) "}]}

