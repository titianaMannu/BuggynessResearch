{"sha":"d090d717f457135a1ba4b86f00b24b04e743d56f","node_id":"MDY6Q29tbWl0MjA2MzY0OmQwOTBkNzE3ZjQ1NzEzNWExYmE0Yjg2ZjAwYjI0YjA0ZTc0M2Q1NmY=","commit":{"author":{"name":"A. Abram White","email":"awhite@apache.org","date":"2006-09-21T22:01:57Z"},"committer":{"name":"A. Abram White","email":"awhite@apache.org","date":"2006-09-21T22:01:57Z"},"message":"Fix sequence bug I introduced with last sequence synchronization refactoring.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@448708 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c9b9b60b758ccab2ccebdda1776c4a7980367c0e","url":"https://api.github.com/repos/apache/openjpa/git/trees/c9b9b60b758ccab2ccebdda1776c4a7980367c0e"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/d090d717f457135a1ba4b86f00b24b04e743d56f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/d090d717f457135a1ba4b86f00b24b04e743d56f","html_url":"https://github.com/apache/openjpa/commit/d090d717f457135a1ba4b86f00b24b04e743d56f","comments_url":"https://api.github.com/repos/apache/openjpa/commits/d090d717f457135a1ba4b86f00b24b04e743d56f/comments","author":null,"committer":null,"parents":[{"sha":"68572a9197e1a668442ef463d193686c37c12c09","url":"https://api.github.com/repos/apache/openjpa/commits/68572a9197e1a668442ef463d193686c37c12c09","html_url":"https://github.com/apache/openjpa/commit/68572a9197e1a668442ef463d193686c37c12c09"}],"stats":{"total":9,"additions":3,"deletions":6},"files":[{"sha":"e2e207fb1c56647d4d042e6652548f20d5616c20","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/AbstractJDBCSeq.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/d090d717f457135a1ba4b86f00b24b04e743d56f/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/AbstractJDBCSeq.java","raw_url":"https://github.com/apache/openjpa/raw/d090d717f457135a1ba4b86f00b24b04e743d56f/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/AbstractJDBCSeq.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/AbstractJDBCSeq.java?ref=d090d717f457135a1ba4b86f00b24b04e743d56f","patch":"@@ -157,7 +157,7 @@ protected void closeConnection(Connection conn) {\n             return;\n \n         try {\n-            if (type == TYPE_TRANSACTIONAL || type == TYPE_CONTIGUOUS)\n+            if (type != TYPE_TRANSACTIONAL && type != TYPE_CONTIGUOUS)\n                 conn.commit();\n         } catch (SQLException se) {\n             throw SQLExceptions.getStore(se);"},{"sha":"6af4a9f488d69e0b61e12fecae54e91268137cdd","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/TableJDBCSeq.java","status":"modified","additions":2,"deletions":5,"changes":7,"blob_url":"https://github.com/apache/openjpa/blob/d090d717f457135a1ba4b86f00b24b04e743d56f/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/TableJDBCSeq.java","raw_url":"https://github.com/apache/openjpa/raw/d090d717f457135a1ba4b86f00b24b04e743d56f/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/TableJDBCSeq.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/kernel/TableJDBCSeq.java?ref=d090d717f457135a1ba4b86f00b24b04e743d56f","patch":"@@ -230,7 +230,7 @@ protected Object currentInternal(JDBCStore store, ClassMapping mapping)\n         if (current == null) {\n             Connection conn = getConnection(store);\n             try {\n-                long cur = getSequence(mapping, getConnection(store));\n+                long cur = getSequence(mapping, conn);\n                 if (cur != -1)\n                     current = Numbers.valueOf(cur);\n             } finally {\n@@ -614,10 +614,7 @@ else if (ACTION_GET.equals(action) || ACTION_SET.equals(action)) {\n             catch (NumberFormatException nfe) {\n                 return false;\n             } finally {\n-                try {\n-                    conn.close();\n-                } catch (SQLException se) {\n-                }\n+                try { conn.close(); } catch (SQLException se) {}\n             }\n         } else\n             return false;"}]}

