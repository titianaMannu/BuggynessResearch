{"sha":"d78bcae002c96b508c04b912c8635389848d0b5e","node_id":"MDY6Q29tbWl0MjA2MzY0OmQ3OGJjYWUwMDJjOTZiNTA4YzA0YjkxMmM4NjM1Mzg5ODQ4ZDBiNWU=","commit":{"author":{"name":"Marc Prud'hommeaux","email":"mprudhom@apache.org","date":"2006-09-13T00:44:14Z"},"committer":{"name":"Marc Prud'hommeaux","email":"mprudhom@apache.org","date":"2006-09-13T00:44:14Z"},"message":"Only make an instance nontransactional if it is not in the TCleanState, which should not transitional to nontransactional upon detach. Only make an instance nontransactional if it is not in the TCleanState, which should not transitional to nontransactional upon detach.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@442774 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"a82a8b09173dab1891c37a8ec28d7b970412dac3","url":"https://api.github.com/repos/apache/openjpa/git/trees/a82a8b09173dab1891c37a8ec28d7b970412dac3"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/d78bcae002c96b508c04b912c8635389848d0b5e","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/d78bcae002c96b508c04b912c8635389848d0b5e","html_url":"https://github.com/apache/openjpa/commit/d78bcae002c96b508c04b912c8635389848d0b5e","comments_url":"https://api.github.com/repos/apache/openjpa/commits/d78bcae002c96b508c04b912c8635389848d0b5e/comments","author":null,"committer":null,"parents":[{"sha":"832d913520d909b587cd52ae16e63773965a17ad","url":"https://api.github.com/repos/apache/openjpa/commits/832d913520d909b587cd52ae16e63773965a17ad","html_url":"https://github.com/apache/openjpa/commit/832d913520d909b587cd52ae16e63773965a17ad"}],"stats":{"total":3,"additions":2,"deletions":1},"files":[{"sha":"1a94d389851395edcc346098a591a92ea1717882","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/kernel/BrokerImpl.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/apache/openjpa/blob/d78bcae002c96b508c04b912c8635389848d0b5e/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/BrokerImpl.java","raw_url":"https://github.com/apache/openjpa/raw/d78bcae002c96b508c04b912c8635389848d0b5e/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/BrokerImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/BrokerImpl.java?ref=d78bcae002c96b508c04b912c8635389848d0b5e","patch":"@@ -3017,7 +3017,8 @@ private void detachAllInternal(OpCallbacks call) {\n         for (Iterator itr = states.iterator(); itr.hasNext();) {\n             sm = (StateManagerImpl) itr.next();\n             if (!sm.isPersistent()) {\n-                sm.nontransactional();\n+                if (sm.getPCState() != PCState.TCLEAN)\n+                    sm.nontransactional();\n                 itr.remove();\n             } else if (!sm.getMetaData().isDetachable()) {\n                 sm.release(true);"}]}

