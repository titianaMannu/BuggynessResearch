{"sha":"d899ba81075c96cd6a46b724e49e3bcc72697b25","node_id":"MDY6Q29tbWl0MjA2MzY0OmQ4OTliYTgxMDc1Yzk2Y2Q2YTQ2YjcyNGU0OWUzYmNjNzI2OTdiMjU=","commit":{"author":{"name":"Richard G. Curtis","email":"curtisr7@apache.org","date":"2010-07-14T20:15:41Z"},"committer":{"name":"Richard G. Curtis","email":"curtisr7@apache.org","date":"2010-07-14T20:15:41Z"},"message":"OPENJPA-1626: Add Name property to AbstractQueryCache, contributed by Amy Yang.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@964170 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"d454d5fb709c11d2cef6a58855ae2c87ebfe1ad5","url":"https://api.github.com/repos/apache/openjpa/git/trees/d454d5fb709c11d2cef6a58855ae2c87ebfe1ad5"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/d899ba81075c96cd6a46b724e49e3bcc72697b25","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/d899ba81075c96cd6a46b724e49e3bcc72697b25","html_url":"https://github.com/apache/openjpa/commit/d899ba81075c96cd6a46b724e49e3bcc72697b25","comments_url":"https://api.github.com/repos/apache/openjpa/commits/d899ba81075c96cd6a46b724e49e3bcc72697b25/comments","author":null,"committer":null,"parents":[{"sha":"124d3ca7b5716edec7b4f77cf853d008e16ad3cc","url":"https://api.github.com/repos/apache/openjpa/commits/124d3ca7b5716edec7b4f77cf853d008e16ad3cc","html_url":"https://github.com/apache/openjpa/commit/124d3ca7b5716edec7b4f77cf853d008e16ad3cc"}],"stats":{"total":24,"additions":22,"deletions":2},"files":[{"sha":"d1591f2144497621410bf8ba6edf4ac73a60b2f8","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/datacache/AbstractQueryCache.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/apache/openjpa/blob/d899ba81075c96cd6a46b724e49e3bcc72697b25/openjpa-kernel/src/main/java/org/apache/openjpa/datacache/AbstractQueryCache.java","raw_url":"https://github.com/apache/openjpa/raw/d899ba81075c96cd6a46b724e49e3bcc72697b25/openjpa-kernel/src/main/java/org/apache/openjpa/datacache/AbstractQueryCache.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/datacache/AbstractQueryCache.java?ref=d899ba81075c96cd6a46b724e49e3bcc72697b25","patch":"@@ -72,6 +72,9 @@\n \n     protected ConcurrentHashMap<String,Long> entityTimestampMap = null;\n     private boolean _closed = false;\n+    \n+    private String _name = null;\n+    \n     // default evict policy\n     public EvictPolicy evictPolicy = EvictPolicy.DEFAULT;\n \n@@ -407,4 +410,12 @@ protected void updateEntityTimestamp(Map<String,Long> timestampMap) {\n         }\n         return tmval;\n     }\n+    \n+    public void setName(String n) {\n+        _name = n;\n+    }\n+\n+    public String getName() {\n+        return _name;\n+    }\n }"},{"sha":"3f0bb277287e7b5f29f3cabc35368d4aab7d2736","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/querycache/TestQueryCache.java","status":"modified","additions":11,"deletions":2,"changes":13,"blob_url":"https://github.com/apache/openjpa/blob/d899ba81075c96cd6a46b724e49e3bcc72697b25/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/querycache/TestQueryCache.java","raw_url":"https://github.com/apache/openjpa/raw/d899ba81075c96cd6a46b724e49e3bcc72697b25/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/querycache/TestQueryCache.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/querycache/TestQueryCache.java?ref=d899ba81075c96cd6a46b724e49e3bcc72697b25","patch":"@@ -23,6 +23,8 @@\n import javax.persistence.EntityManager;\n import javax.persistence.NamedQuery;\n \n+import org.apache.openjpa.datacache.ConcurrentQueryCache;\n+import org.apache.openjpa.datacache.QueryCache;\n import org.apache.openjpa.persistence.querycache.common.apps.Entity1;\n import org.apache.openjpa.persistence.querycache.common.apps.Entity2;\n import org.apache.openjpa.persistence.test.SQLListenerTestCase;\n@@ -32,11 +34,11 @@\n public class TestQueryCache extends SQLListenerTestCase {\n \n     EntityManager em;\n-\n+    private static final String CACHE_NAME = \"QueryCacheName\";\n     public void setUp() {\n         super.setUp(\n             DROP_TABLES,\n-            \"openjpa.QueryCache\", \"true\", \n+            \"openjpa.QueryCache\", \"true(name=\"+CACHE_NAME+\")\", \n             \"openjpa.RemoteCommitProvider\",\"sjvm\",\n             Entity1.class,Entity2.class\n         // ,\"openjpa.Log\",\"SQL=trace\"\n@@ -148,6 +150,13 @@ public void testSetFirstResults() {\n \n     }\n \n+    public void testName() {\n+        ConcurrentQueryCache qCache =\n+            (ConcurrentQueryCache) emf.getConfiguration().getDataCacheManagerInstance().getSystemQueryCache();\n+        assertNotNull(qCache);\n+        assertEquals(CACHE_NAME, qCache.getName());\n+    }\n+\n     protected void startTx(EntityManager em) {\n         em.getTransaction().begin();\n     }"}]}

