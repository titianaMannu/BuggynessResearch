{"sha":"daae61a6f50a98dddaf649d919d2a46e55567802","node_id":"MDY6Q29tbWl0MjA2MzY0OmRhYWU2MWE2ZjUwYTk4ZGRkYWY2NDlkOTE5ZDJhNDZlNTU1Njc4MDI=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-02-25T16:28:54Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-02-25T16:28:54Z"},"message":"OPENJPA-1535 Inconsistency in exceptions thrown from MetaDataRepository.resolve().  Patch contributed by Hiroki Tateno.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@916338 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"cb5096eef64b27569733f2793c2a18fcf941a494","url":"https://api.github.com/repos/apache/openjpa/git/trees/cb5096eef64b27569733f2793c2a18fcf941a494"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/daae61a6f50a98dddaf649d919d2a46e55567802","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/daae61a6f50a98dddaf649d919d2a46e55567802","html_url":"https://github.com/apache/openjpa/commit/daae61a6f50a98dddaf649d919d2a46e55567802","comments_url":"https://api.github.com/repos/apache/openjpa/commits/daae61a6f50a98dddaf649d919d2a46e55567802/comments","author":null,"committer":null,"parents":[{"sha":"ea49b4cc6abcbf3cb38468a01df4187151fa5498","url":"https://api.github.com/repos/apache/openjpa/commits/ea49b4cc6abcbf3cb38468a01df4187151fa5498","html_url":"https://github.com/apache/openjpa/commit/ea49b4cc6abcbf3cb38468a01df4187151fa5498"}],"stats":{"total":14,"additions":9,"deletions":5},"files":[{"sha":"9260d6ae7d5d933031e8a31132319413aee7510b","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/meta/MetaDataRepository.java","status":"modified","additions":9,"deletions":5,"changes":14,"blob_url":"https://github.com/apache/openjpa/blob/daae61a6f50a98dddaf649d919d2a46e55567802/openjpa-kernel/src/main/java/org/apache/openjpa/meta/MetaDataRepository.java","raw_url":"https://github.com/apache/openjpa/raw/daae61a6f50a98dddaf649d919d2a46e55567802/openjpa-kernel/src/main/java/org/apache/openjpa/meta/MetaDataRepository.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/meta/MetaDataRepository.java?ref=daae61a6f50a98dddaf649d919d2a46e55567802","patch":"@@ -631,14 +631,18 @@ private void resolve(ClassMetaData meta) {\n                 err &= resolveMapping(resolved.get(i));\n \n         // throw errors encountered\n+        // OPENJPA-1535 Always throw a MetaDataException because callers\n+        // of loadRegisteredClassMetaData expect only MetaDataException\n+        // to be thrown.\n         if (err && !_errs.isEmpty()) {\n             RuntimeException re;\n-            if (_errs.size() == 1)\n+            if ((_errs.size() == 1) && (_errs.get(0) instanceof MetaDataException)) {\n                 re = _errs.get(0);\n-            else\n-                re =\n-                    new MetaDataException(_loc.get(\"resolve-errs\")).setNestedThrowables((Throwable[]) _errs\n-                        .toArray(new Exception[_errs.size()]));\n+            } else {\n+                re = new MetaDataException(_loc.get(\"resolve-errs\"))\n+                    .setNestedThrowables((Throwable[]) _errs\n+                    .toArray(new Exception[_errs.size()]));\n+            }\n             _errs.clear();\n             throw re;\n         }"}]}

