{"sha":"e53378bd2697a023a2be5d4c9191fa80c3411800","node_id":"MDY6Q29tbWl0MjA2MzY0OmU1MzM3OGJkMjY5N2EwMjNhMmJlNWQ0YzkxOTFmYTgwYzM0MTE4MDA=","commit":{"author":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-01-11T23:43:38Z"},"committer":{"name":"Fay Wang","email":"faywang@apache.org","date":"2010-01-11T23:43:38Z"},"message":"OPENJPA-1455: fix the way to get current schema per Milosz's suggestion.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@898118 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"18d7745efcb6a0806916fd8e6dd27c8d2dac5f20","url":"https://api.github.com/repos/apache/openjpa/git/trees/18d7745efcb6a0806916fd8e6dd27c8d2dac5f20"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/e53378bd2697a023a2be5d4c9191fa80c3411800","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/e53378bd2697a023a2be5d4c9191fa80c3411800","html_url":"https://github.com/apache/openjpa/commit/e53378bd2697a023a2be5d4c9191fa80c3411800","comments_url":"https://api.github.com/repos/apache/openjpa/commits/e53378bd2697a023a2be5d4c9191fa80c3411800/comments","author":null,"committer":null,"parents":[{"sha":"0efea474f226749a971077a592090cd7a4b86648","url":"https://api.github.com/repos/apache/openjpa/commits/0efea474f226749a971077a592090cd7a4b86648","html_url":"https://github.com/apache/openjpa/commit/0efea474f226749a971077a592090cd7a4b86648"}],"stats":{"total":13,"additions":12,"deletions":1},"files":[{"sha":"e2af98907313b3ed8bb0588563f5a137898d1caa","filename":"openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","status":"modified","additions":12,"deletions":1,"changes":13,"blob_url":"https://github.com/apache/openjpa/blob/e53378bd2697a023a2be5d4c9191fa80c3411800/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","raw_url":"https://github.com/apache/openjpa/raw/e53378bd2697a023a2be5d4c9191fa80c3411800/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-jdbc/src/main/java/org/apache/openjpa/jdbc/sql/DB2Dictionary.java?ref=e53378bd2697a023a2be5d4c9191fa80c3411800","patch":"@@ -26,6 +26,7 @@\n import java.sql.PreparedStatement;\n import java.sql.ResultSet;\n import java.sql.SQLException;\n+import java.sql.Statement;\n import java.sql.Types;\n import java.util.Arrays;\n import java.util.EnumSet;\n@@ -266,7 +267,17 @@ public void connectedConfiguration(Connection conn) throws SQLException {\n         super.connectedConfiguration(conn);\n \n         DatabaseMetaData metaData = conn.getMetaData();\n-        setDefaultSchemaName(metaData.getUserName());\n+        String str = \"VALUES CURRENT SCHEMA\";\n+        Statement stmnt = conn.createStatement();\n+        ResultSet rs = stmnt.executeQuery(str);\n+        if (rs.next()) {\n+            String currSchema = rs.getString(1);\n+            if (currSchema != null)\n+                setDefaultSchemaName(currSchema.trim());\n+        }\n+        rs.close();\n+        stmnt.close();\n+\n         String driverName = metaData.getDriverName();\n         if (driverName != null && driverName.startsWith(\"IBM DB2\"))\n             driverVendor = VENDOR_IBM;"}]}

