{"sha":"e71cd295fcb912db12fa9d51e3a451fc2ffa2859","node_id":"MDY6Q29tbWl0MjA2MzY0OmU3MWNkMjk1ZmNiOTEyZGIxMmZhOWQ1MWUzYTQ1MWZjMmZmYTI4NTk=","commit":{"author":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2010-03-03T22:50:55Z"},"committer":{"name":"Pinaki Poddar","email":"ppoddar@apache.org","date":"2010-03-03T22:50:55Z"},"message":"OPENJPA-1503: Throw persistence exception not illegalargument exception as per spec when fails to unwrap()\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@918748 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"ae1ef697911a8260ccbe886329433841d6a4c8e2","url":"https://api.github.com/repos/apache/openjpa/git/trees/ae1ef697911a8260ccbe886329433841d6a4c8e2"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/e71cd295fcb912db12fa9d51e3a451fc2ffa2859","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/e71cd295fcb912db12fa9d51e3a451fc2ffa2859","html_url":"https://github.com/apache/openjpa/commit/e71cd295fcb912db12fa9d51e3a451fc2ffa2859","comments_url":"https://api.github.com/repos/apache/openjpa/commits/e71cd295fcb912db12fa9d51e3a451fc2ffa2859/comments","author":null,"committer":null,"parents":[{"sha":"76d184c106b6e4e191549412f0d7513b82b950da","url":"https://api.github.com/repos/apache/openjpa/commits/76d184c106b6e4e191549412f0d7513b82b950da","html_url":"https://github.com/apache/openjpa/commit/76d184c106b6e4e191549412f0d7513b82b950da"}],"stats":{"total":6,"additions":4,"deletions":2},"files":[{"sha":"3fc142f12f3384d7de73de31de17833fe34fa2cd","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java","status":"modified","additions":4,"deletions":2,"changes":6,"blob_url":"https://github.com/apache/openjpa/blob/e71cd295fcb912db12fa9d51e3a451fc2ffa2859/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java","raw_url":"https://github.com/apache/openjpa/raw/e71cd295fcb912db12fa9d51e3a451fc2ffa2859/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/EntityManagerImpl.java?ref=e71cd295fcb912db12fa9d51e3a451fc2ffa2859","patch":"@@ -1634,8 +1634,10 @@ public OpenJPACriteriaBuilder getCriteriaBuilder() {\n         }\n         // Set this transaction to rollback only (as per spec) here because the raised exception \n         // does not go through normal exception translation pathways\n-        RuntimeException ex = new IllegalArgumentException(_loc.get(\"unwrap-em-invalid\", cls).toString());\n-        setRollbackOnly(ex);\n+        RuntimeException ex = new PersistenceException(_loc.get(\"unwrap-em-invalid\", cls).toString(), null, \n+                this, false);\n+        if (isActive())\n+            setRollbackOnly(ex);\n         throw ex;\n     }\n "}]}

