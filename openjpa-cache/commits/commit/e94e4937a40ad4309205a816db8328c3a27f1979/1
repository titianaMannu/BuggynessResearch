{"sha":"e94e4937a40ad4309205a816db8328c3a27f1979","node_id":"MDY6Q29tbWl0MjA2MzY0OmU5NGU0OTM3YTQwYWQ0MzA5MjA1YTgxNmRiODMyOGMzYTI3ZjE5Nzk=","commit":{"author":{"name":"Marc Prud'hommeaux","email":"mprudhom@apache.org","date":"2006-11-08T04:16:46Z"},"committer":{"name":"Marc Prud'hommeaux","email":"mprudhom@apache.org","date":"2006-11-08T04:16:46Z"},"message":"Added call to attach the GPG signature files to the binary uploads so the signing can be automated when 'mvn deploy' is called.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@472383 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"28ec08eca834f5f9a8acf766d3fd7c0d48cab318","url":"https://api.github.com/repos/apache/openjpa/git/trees/28ec08eca834f5f9a8acf766d3fd7c0d48cab318"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/e94e4937a40ad4309205a816db8328c3a27f1979","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/e94e4937a40ad4309205a816db8328c3a27f1979","html_url":"https://github.com/apache/openjpa/commit/e94e4937a40ad4309205a816db8328c3a27f1979","comments_url":"https://api.github.com/repos/apache/openjpa/commits/e94e4937a40ad4309205a816db8328c3a27f1979/comments","author":null,"committer":null,"parents":[{"sha":"b40ba51347b7761d8462988b730879530e39c954","url":"https://api.github.com/repos/apache/openjpa/commits/b40ba51347b7761d8462988b730879530e39c954","html_url":"https://github.com/apache/openjpa/commit/b40ba51347b7761d8462988b730879530e39c954"}],"stats":{"total":164,"additions":55,"deletions":109},"files":[{"sha":"ccf79264d96c56465c21900bd9ed225b539c277b","filename":"openjpa-project/assembly.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/apache/openjpa/blob/e94e4937a40ad4309205a816db8328c3a27f1979/openjpa-project/assembly.xml","raw_url":"https://github.com/apache/openjpa/raw/e94e4937a40ad4309205a816db8328c3a27f1979/openjpa-project/assembly.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/assembly.xml?ref=e94e4937a40ad4309205a816db8328c3a27f1979","patch":"@@ -1,5 +1,5 @@\n <assembly>\r\n-    <id></id>\r\n+    <id>binary</id>\r\n     <formats>\r\n         <format>zip</format>\r\n     </formats>\r"},{"sha":"8c882816c2e8cd45d12347224b5890264d062e29","filename":"openjpa-project/pom.xml","status":"modified","additions":40,"deletions":94,"changes":134,"blob_url":"https://github.com/apache/openjpa/blob/e94e4937a40ad4309205a816db8328c3a27f1979/openjpa-project/pom.xml","raw_url":"https://github.com/apache/openjpa/raw/e94e4937a40ad4309205a816db8328c3a27f1979/openjpa-project/pom.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/pom.xml?ref=e94e4937a40ad4309205a816db8328c3a27f1979","patch":"@@ -29,6 +29,14 @@\n         <openjpa.release.keyAlias>${user.name}@apache.org</openjpa.release.keyAlias>\r\n         <openjpa.assembly.finalName>openjpa-${version}</openjpa.assembly.finalName>\r\n         <openjpa.assembly.outputDirectory>${project.basedir}/target/assembly</openjpa.assembly.outputDirectory>\r\n+\r\n+        <openjpa.assembly.binarySuffix>binary</openjpa.assembly.binarySuffix>\r\n+        <openjpa.assembly.binaryBase>${openjpa.assembly.outputDirectory}/${openjpa.assembly.finalName}-${openjpa.assembly.binarySuffix}</openjpa.assembly.binaryBase>\r\n+        <openjpa.assembly.binaryFile>${openjpa.assembly.binaryBase}.zip</openjpa.assembly.binaryFile>\r\n+\r\n+        <openjpa.assembly.sourceSuffix>source</openjpa.assembly.sourceSuffix>\r\n+        <openjpa.assembly.sourceBase>${openjpa.assembly.outputDirectory}/${openjpa.assembly.finalName}-${openjpa.assembly.sourceSuffix}</openjpa.assembly.sourceBase>\r\n+        <openjpa.assembly.sourceFile>${openjpa.assembly.sourceBase}.zip</openjpa.assembly.sourceFile>\r\n     </properties>\r\n \r\n     <build>\r\n@@ -46,96 +54,6 @@\n         </resources>\r\n \r\n         <plugins>\r\n-            <plugin>\r\n-\r\n-                <!--\r\n-                    Manually build an aggregate jar of all the other\r\n-                    openjpa-* jars using ant. We cannot use the assembly\r\n-                    plugin, since it doesn't provide support for appending\r\n-                    multiple same-named files to each other (which is\r\n-                    required for correctly aggregating services files).\r\n-                -->\r\n-                <artifactId>maven-antrun-plugin</artifactId>\r\n-                <executions>\r\n-                    <execution>\r\n-                        <id>build-single-jar</id>\r\n-                        <phase>process-classes</phase>\r\n-                        <configuration>\r\n-                            <tasks>\r\n-                                <unjar overwrite=\"false\"\r\n-                                    dest=\"${basedir}/target/classes\">\r\n-                                    <fileset dir=\"${basedir}/..\">\r\n-                                        <include name=\"*/target/openjpa-*.jar\" />\r\n-                                    </fileset>\r\n-                                </unjar>\r\n-\r\n-                                <!--\r\n-                                    need to manually concatenate the services\r\n-                                    resources so they are aggregated\r\n-                                -->\r\n-                                <macrodef name=\"aggregate-file\">\r\n-                                    <attribute name=\"servicename\" />\r\n-                                    <sequential>\r\n-                                        <echo>\r\n-                                            Building service: @{servicename}\r\n-                                        </echo>\r\n-                                        <concat\r\n-                                            destfile=\"${basedir}/target/classes/META-INF/services/@{servicename}\">\r\n-                                            <fileset dir=\"${basedir}/..\"\r\n-                                                includes=\"*/src/main/resources/META-INF/services/@{servicename}\" />\r\n-                                        </concat>\r\n-                                    </sequential>\r\n-                                </macrodef>\r\n-\r\n-                                <aggregate-file\r\n-                                    servicename=\"org.apache.openjpa.lib.conf.ProductDerivation\" />\r\n-                                <aggregate-file\r\n-                                    servicename=\"javax.persistence.spi.PersistenceProvider\" />\r\n-                                <aggregate-file\r\n-                                    servicename=\"org.apache.openjpa.kernel.exps.ExpressionParser\" />\r\n-\r\n-                                <mkdir dir=\"${basedir}/target/aggregate\" />\r\n-\r\n-                                <jar\r\n-                                    destfile=\"${basedir}/target/aggregate/openjpa-${version}.jar\"\r\n-                                    basedir=\"${basedir}/target/classes\">\r\n-\r\n-                                    <manifest>\r\n-                                        <!--  Add roughly the same manifest info that the maven-jar-plugin uses -->\r\n-                                        <attribute name=\"Built-By\"\r\n-                                            value=\"${user.name}\" />\r\n-                                        <attribute name=\"Build-Jdk\"\r\n-                                            value=\"${java.version}\" />\r\n-                                        <attribute name=\"Specification-Title\"\r\n-                                            value=\"${project.name}\" />\r\n-                                        <attribute name=\"Specification-Version\"\r\n-                                            value=\"${project.version}\" />\r\n-                                        <attribute name=\"Specification-Vendor\"\r\n-                                            value=\"${project.organization.name}\" />\r\n-                                        <attribute name=\"Implementation-Title\"\r\n-                                            value=\"${project.name}\" />\r\n-                                        <attribute name=\"Implementation-Version\"\r\n-                                            value=\"${project.version}\" />\r\n-                                        <attribute\r\n-                                            name=\"Implementation-Vendor-Id\" value=\"${project.groupId}\" />\r\n-                                        <attribute name=\"Implementation-Vendor\"\r\n-                                            value=\"${project.organization.name}\" />\r\n-\r\n-                                        <!-- set premain class -->\r\n-                                        <attribute name=\"Premain-Class\"\r\n-                                            value=\"org.apache.openjpa.enhance.PCEnhancerAgent\" />\r\n-                                    </manifest>\r\n-\r\n-                                </jar>\r\n-                            </tasks>\r\n-                        </configuration>\r\n-                        <goals>\r\n-                            <goal>run</goal>\r\n-                        </goals>\r\n-                    </execution>\r\n-                </executions>\r\n-            </plugin>\r\n-\r\n             <plugin>\r\n                 <artifactId>maven-assembly-plugin</artifactId>\r\n                 <executions>\r\n@@ -223,7 +141,7 @@\n \r\n                                     <mkdir dir=\"${stylesheet.dir}\"/>\r\n                                     <get src=\"http://docbook.sourceforge.net/release/xsl/${stylesheet}\" usetimestamp=\"true\" dest=\"${stylesheet.dir}/${stylesheet}\"/>\r\n-                                    <untar src=\"${stylesheet.dir}/${stylesheet}\" dest=\"${stylesheet.dir}\" compression=\"bzip2\" overwrite=\"false\"/>\r\n+                                    <untar src=\"${stylesheet.dir}/${stylesheet}\" dest=\"${stylesheet.dir}/\" compression=\"bzip2\" overwrite=\"false\"/>\r\n \r\n \r\n                                     <style includes=\"**/manual.xml\"\r\n@@ -276,7 +194,7 @@\n                         <artifactId>maven-antrun-plugin</artifactId>\r\n                         <executions>\r\n                             <execution>\r\n-                                <phase>deploy</phase>\r\n+                                <phase>verify</phase>\r\n                                 <configuration>\r\n                                     <tasks>\r\n                                     <echo>Signing release files...</echo>\r\n@@ -297,8 +215,8 @@\n                                         </exec>\r\n                                         </sequential>\r\n                                     </macrodef>\r\n-                                    <sign-file file=\"${openjpa.assembly.outputDirectory}/${openjpa.assembly.finalName}.zip\"/>\r\n-                                    <sign-file file=\"${openjpa.assembly.outputDirectory}/${openjpa.assembly.finalName}-sources.zip\"/>\r\n+                                    <sign-file file=\"${openjpa.assembly.binaryFile}\"/>\r\n+                                    <sign-file file=\"${openjpa.assembly.sourceFile}\"/>\r\n                                     </tasks>\r\n                                 </configuration>\r\n                                 <goals>\r\n@@ -307,6 +225,34 @@\n                             </execution>\r\n                         </executions>\r\n                     </plugin>\r\n+\r\n+                    <plugin>\r\n+                        <groupId>org.codehaus.mojo</groupId>\r\n+                        <artifactId>build-helper-maven-plugin</artifactId>\r\n+                        <executions>\r\n+                            <execution>\r\n+                                <id>attach-signature-artifacts</id>\r\n+                                <phase>verify</phase>\r\n+                                <goals>\r\n+                                    <goal>attach-artifact</goal>\r\n+                                </goals>\r\n+                                <configuration>\r\n+                                    <artifacts>\r\n+                                        <artifact>\r\n+                                            <file>${openjpa.assembly.binaryFile}.asc</file>\r\n+                                            <classifier>${openjpa.assembly.binarySuffix}.zip</classifier>\r\n+                                            <type>asc</type>\r\n+                                        </artifact>\r\n+                                        <artifact>\r\n+                                            <file>${openjpa.assembly.sourceFile}.asc</file>\r\n+                                            <classifier>${openjpa.assembly.sourceSuffix}.zip</classifier>\r\n+                                            <type>asc</type>\r\n+                                        </artifact>\r\n+                                    </artifacts>\r\n+                                </configuration>\r\n+                            </execution>\r\n+                        </executions>\r\n+                    </plugin>\r\n                 </plugins>\r\n             </build>\r\n             <activation>\r"},{"sha":"420d002f0633e68707e617e5156df263cdc198ec","filename":"openjpa-project/source-assembly.xml","status":"modified","additions":14,"deletions":14,"changes":28,"blob_url":"https://github.com/apache/openjpa/blob/e94e4937a40ad4309205a816db8328c3a27f1979/openjpa-project/source-assembly.xml","raw_url":"https://github.com/apache/openjpa/raw/e94e4937a40ad4309205a816db8328c3a27f1979/openjpa-project/source-assembly.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/source-assembly.xml?ref=e94e4937a40ad4309205a816db8328c3a27f1979","patch":"@@ -1,16 +1,16 @@\n <assembly>\n-  <id>sources</id>\n-  <formats>\n-    <format>zip</format>\n-  </formats>\n-  <includeBaseDirectory>true</includeBaseDirectory>\n-  <fileSets>\n-    <fileSet>\n-      <directory>..</directory>\n-      <outputDirectory></outputDirectory>\n-      <excludes>\n-        <exclude>**/target/**</exclude>\n-      </excludes>\n-    </fileSet>\n-  </fileSets>\n+    <id>source</id>\n+    <formats>\n+        <format>zip</format>\n+    </formats>\n+    <includeBaseDirectory>true</includeBaseDirectory>\n+    <fileSets>\n+        <fileSet>\n+            <directory>..</directory>\n+            <outputDirectory></outputDirectory>\n+            <excludes>\n+                <exclude>**/target/**</exclude>\n+            </excludes>\n+        </fileSet>\n+    </fileSets>\n </assembly>"}]}

