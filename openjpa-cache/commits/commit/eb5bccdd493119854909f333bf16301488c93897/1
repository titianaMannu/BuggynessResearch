{"sha":"eb5bccdd493119854909f333bf16301488c93897","node_id":"MDY6Q29tbWl0MjA2MzY0OmViNWJjY2RkNDkzMTE5ODU0OTA5ZjMzM2JmMTYzMDE0ODhjOTM4OTc=","commit":{"author":{"name":"Richard G. Curtis","email":"curtisr7@apache.org","date":"2009-09-15T21:40:59Z"},"committer":{"name":"Richard G. Curtis","email":"curtisr7@apache.org","date":"2009-09-15T21:40:59Z"},"message":"OPENJPA-1149: Add embeddables sample to the examples module. Patch contributed by Rick Curtis.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/trunk@815501 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"7dfd92c39c3bdb22e5362431540a6bd20861073d","url":"https://api.github.com/repos/apache/openjpa/git/trees/7dfd92c39c3bdb22e5362431540a6bd20861073d"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/eb5bccdd493119854909f333bf16301488c93897","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/eb5bccdd493119854909f333bf16301488c93897","html_url":"https://github.com/apache/openjpa/commit/eb5bccdd493119854909f333bf16301488c93897","comments_url":"https://api.github.com/repos/apache/openjpa/commits/eb5bccdd493119854909f333bf16301488c93897/comments","author":null,"committer":null,"parents":[{"sha":"8fc1404dadaff7478ac724b540c783ccf2dd5ac8","url":"https://api.github.com/repos/apache/openjpa/commits/8fc1404dadaff7478ac724b540c783ccf2dd5ac8","html_url":"https://github.com/apache/openjpa/commit/8fc1404dadaff7478ac724b540c783ccf2dd5ac8"}],"stats":{"total":395,"additions":395,"deletions":0},"files":[{"sha":"880c8667787f2538e46aa38944118094c2729f54","filename":"openjpa-examples/src/main/java/META-INF/persistence.xml","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/META-INF/persistence.xml","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/META-INF/persistence.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/META-INF/persistence.xml?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -81,4 +81,14 @@\n     <persistence-unit name=\"reversemapping\" transaction-type=\"RESOURCE_LOCAL\">\n         <mapping-file>reversemapping/orm.xml</mapping-file>\n     </persistence-unit>\n+    \n+    <persistence-unit name=\"embeddables\" transaction-type=\"RESOURCE_LOCAL\">\n+        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>\n+        <class>embeddables.Address</class>\n+        <class>embeddables.ContactInfo</class>\n+        <class>embeddables.Coordinates</class>\n+        <class>embeddables.Phone</class>\n+        <class>embeddables.User</class>\n+    </persistence-unit>\n+    \n </persistence>"},{"sha":"6e998410add2a61b10f3ba4faae0a3a6788c956f","filename":"openjpa-examples/src/main/java/embeddables/Address.java","status":"added","additions":56,"deletions":0,"changes":56,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Address.java","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Address.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/Address.java?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package embeddables;\n+\n+import javax.persistence.Basic;\n+import javax.persistence.CascadeType;\n+import javax.persistence.Embeddable;\n+import javax.persistence.ManyToOne;\n+\n+@Embeddable\n+public class Address {\n+    @Basic\n+    private String street;\n+    @Basic\n+    private String city;\n+    @Basic\n+    private String state;\n+    @Basic\n+    private Integer zip;\n+\n+    // Relationship from an Embeddable to an Entity\n+    @ManyToOne(cascade = CascadeType.ALL)\n+    Coordinates coordinates;\n+\n+    public Address() {\n+\n+    }\n+\n+    public Address(String street, String city, String state, Integer zip, Coordinates c) {\n+        this.street = street;\n+        this.city = city;\n+        this.state = state;\n+        this.zip = zip;\n+        coordinates = c;\n+    }\n+\n+    public String toString() {\n+        return street + \" \" + city + \", \" + state + \" \" + zip;\n+    }\n+}"},{"sha":"b5338bcae1413826372be7300e0f5d7d52739b23","filename":"openjpa-examples/src/main/java/embeddables/ContactInfo.java","status":"added","additions":45,"deletions":0,"changes":45,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/ContactInfo.java","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/ContactInfo.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/ContactInfo.java?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,45 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package embeddables;\n+\n+import javax.persistence.Embeddable;\n+import javax.persistence.Embedded;\n+\n+@Embeddable\n+public class ContactInfo {\n+    public ContactInfo() {\n+    }\n+\n+    public ContactInfo(Address a, Phone p) {\n+        homeAddress = a;\n+        homePhone = p;\n+    }\n+\n+    // Nested embeddable\n+    @Embedded\n+    Address homeAddress;\n+\n+    // Nested embeddable\n+    @Embedded\n+    Phone homePhone;\n+\n+    public String toString() {\n+        return homeAddress.toString() + \" \" + homePhone.toString();\n+    }\n+}"},{"sha":"889b5de01f1198996511ea8b2a98fa14528e4c83","filename":"openjpa-examples/src/main/java/embeddables/Coordinates.java","status":"added","additions":45,"deletions":0,"changes":45,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Coordinates.java","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Coordinates.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/Coordinates.java?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,45 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package embeddables;\n+\n+import javax.persistence.Basic;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+\n+@Entity\n+public class Coordinates {\n+    @Id\n+    @GeneratedValue(strategy = GenerationType.AUTO)\n+    int id;\n+\n+    @Basic\n+    String longitude;\n+    @Basic\n+    String latitude;\n+\n+    public Coordinates() {\n+    }\n+\n+    public Coordinates(String lon, String lat) {\n+        longitude = lon;\n+        latitude = lat;\n+    }\n+}"},{"sha":"c82e4987439b0cafc451cd3025e1a867f0033c0f","filename":"openjpa-examples/src/main/java/embeddables/Main.java","status":"added","additions":97,"deletions":0,"changes":97,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Main.java","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Main.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/Main.java?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package embeddables;\n+\n+import java.util.List;\n+\n+import javax.persistence.EntityManager;\n+import javax.persistence.EntityManagerFactory;\n+import javax.persistence.Persistence;\n+import javax.persistence.Query;\n+\n+public class Main {\n+\n+    public static void main(String[] args) throws Exception {\n+        EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"embeddables\", System.getProperties());\n+        EntityManager em = emf.createEntityManager();\n+        init(em);\n+        runQueries(em);\n+    }\n+\n+    public static void runQueries(EntityManager em) {\n+        // Find all users that have a secondary address that is in MI\n+        Query q = em.createQuery(\"SELECT u FROM User u , in (u.addresses) a \" + \"WHERE a.state='xx'\");\n+\n+        List<User> res = q.getResultList();\n+        for (User b : res) {\n+            System.out.println(b);\n+        }\n+\n+        Query q1 = em.createQuery(\"SELECT u FROM User u , in (u.addresses) a \" + \"WHERE a.coordinates.longitude='38'\");\n+        List<User> res1 = q1.getResultList();\n+        for (User b : res1) {\n+            System.out.println(b);\n+        }\n+\n+        // Find users who's conatctInfo cell phone is 507-555-5555\n+        // Entity -> embedded -> embedded\n+        q =\n+            em.createQuery(\"SELECT DISTINCT u FROM User u \" + \"WHERE u.contactInfo.homePhone.number='507-555-5555'\"\n+                + \"AND u.contactInfo.homePhone.type='cell'\");\n+        res = q.getResultList();\n+        for (User b : res) {\n+            System.out.println(b);\n+        }\n+\n+        // Find users who's conatctInfo cell phone is 507-555-5555\n+        // Entity -> embedded -> embedded\n+        q =\n+            em.createQuery(\"SELECT u FROM User u \" + \"WHERE u.contactInfo.homePhone.number='507-555-5555'\"\n+                + \"AND u.contactInfo.homePhone.type='cell'\");\n+        res = q.getResultList();\n+        for (User b : res) {\n+            System.out.println(b);\n+        }\n+\n+    }\n+\n+    public static void init(EntityManager em) {\n+        Coordinates c = new Coordinates(\"37.0\", \"23.516\");\n+        Coordinates c1 = new Coordinates(\"38\", \"23.516\");\n+        Coordinates c2 = new Coordinates(\"39\", \"23.516\");\n+\n+        Phone p = new Phone(\"507-555-5555\", \"cell\");\n+        Address a = new Address(\"Cariou Ln\", \"Minneapolis\", \"MN\", 90210, c);\n+        ContactInfo ci = new ContactInfo(a, p);\n+\n+        User u = new User(ci, \"user_name\" + System.currentTimeMillis(), \"user_asdf\");\n+        u.addAddress(new Address(\"100 Rodeo Dr\", \"Arroyo Grande\", \"CA\", 93420, c1));\n+        u.addAddress(new Address(\"1700 W 3rd Ave\", \"Flint\", \"MI\", 48504, c2));\n+        u.addAddress(new Address(\"4301 Farm Ln.\", \"East Lansing\", \"MI\", 48824, c2));\n+\n+        em.getTransaction().begin();\n+        em.persist(c);\n+        em.persist(c1);\n+        em.persist(c2);\n+        em.persist(u);\n+        em.getTransaction().commit();\n+\n+    }\n+\n+}"},{"sha":"0583f09fcf9850afb916a9a18f8fc57e309e2410","filename":"openjpa-examples/src/main/java/embeddables/Phone.java","status":"added","additions":43,"deletions":0,"changes":43,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Phone.java","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/Phone.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/Phone.java?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package embeddables;\n+\n+import javax.persistence.Basic;\n+import javax.persistence.Embeddable;\n+\n+@Embeddable\n+public class Phone {\n+    public Phone() {\n+\n+    }\n+\n+    public Phone(String n, String t) {\n+        number = n;\n+        type = t;\n+    }\n+\n+    @Basic\n+    private String number;\n+    @Basic\n+    private String type;\n+\n+    public String toString() {\n+        return \"type: \" + type + \" number:\" + number;\n+    }\n+}"},{"sha":"f6700ca39932a7307df040281c5d8a613db175f7","filename":"openjpa-examples/src/main/java/embeddables/User.java","status":"added","additions":76,"deletions":0,"changes":76,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/User.java","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/User.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/User.java?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,76 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.    \n+ */\n+package embeddables;\n+\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+import javax.persistence.Basic;\n+import javax.persistence.CollectionTable;\n+import javax.persistence.ElementCollection;\n+import javax.persistence.Embedded;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.Table;\n+\n+@Entity\n+// User is a reserved keyword for derby, so use a different table name.\n+@Table(name = \"User0\")\n+public class User {\n+    @Id\n+    @GeneratedValue(strategy = GenerationType.AUTO)\n+    private int id;\n+    @Embedded\n+    ContactInfo contactInfo;\n+\n+    // Collection of embeddables\n+    @ElementCollection\n+    @CollectionTable(name = \"user_addresses\")\n+    private Set<Address> addresses = new HashSet<Address>();\n+    @Basic\n+    private String user_name;\n+\n+    @Basic\n+    private String user;\n+\n+    public User() {\n+    }\n+\n+    public User(ContactInfo c, String u_n, String u) {\n+        contactInfo = c;\n+        user = u;\n+        user_name = u_n;\n+\n+    }\n+\n+    public void addAddress(Address a) {\n+        addresses.add(a);\n+    }\n+\n+    public String toString() {\n+        String res = user_name + \" \" + user + \" \" + contactInfo;\n+\n+        for (Address a : addresses) {\n+            res += \"\\n\" + a.toString();\n+        }\n+        return res;\n+    }\n+}"},{"sha":"78d40508274223e2fd0c1578394196535da25c28","filename":"openjpa-examples/src/main/java/embeddables/build.xml","status":"added","additions":23,"deletions":0,"changes":23,"blob_url":"https://github.com/apache/openjpa/blob/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/build.xml","raw_url":"https://github.com/apache/openjpa/raw/eb5bccdd493119854909f333bf16301488c93897/openjpa-examples/src/main/java/embeddables/build.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-examples/src/main/java/embeddables/build.xml?ref=eb5bccdd493119854909f333bf16301488c93897","patch":"@@ -0,0 +1,23 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+ Licensed to the Apache Software Foundation (ASF) under one\n+ or more contributor license agreements.  See the NOTICE file\n+ distributed with this work for additional information\n+ regarding copyright ownership.  The ASF licenses this file\n+ to you under the Apache License, Version 2.0 (the\n+ \"License\"); you may not use this file except in compliance\n+ with the License.  You may obtain a copy of the License at\n+ \n+ http://www.apache.org/licenses/LICENSE-2.0\n+ \n+ Unless required by applicable law or agreed to in writing,\n+ software distributed under the License is distributed on an\n+ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ KIND, either express or implied.  See the License for the\n+ specific language governing permissions and limitations\n+ under the License.   \n+-->\n+<project name=\"embeddables\" default=\"run\">\n+    <property name=\"example\" value=\"embeddables\"/>\n+    <import file=\"../build.xml\"/>\n+</project>"}]}

