{"sha":"f22c0c799f59920e765204064f59e2e40c0ea298","node_id":"MDY6Q29tbWl0MjA2MzY0OmYyMmMwYzc5OWY1OTkyMGU3NjUyMDQwNjRmNTllMmU0MGMwZWEyOTg=","commit":{"author":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-03-05T01:29:56Z"},"committer":{"name":"Patrick Linskey","email":"pcl@apache.org","date":"2008-03-05T01:29:56Z"},"message":"Merge from ../../trunk. svn merge -c 633739 ../../trunk\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/1.0.x@633744 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"3cd52a765b9f58fd559a362a411d2f2983b47133","url":"https://api.github.com/repos/apache/openjpa/git/trees/3cd52a765b9f58fd559a362a411d2f2983b47133"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/f22c0c799f59920e765204064f59e2e40c0ea298","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/f22c0c799f59920e765204064f59e2e40c0ea298","html_url":"https://github.com/apache/openjpa/commit/f22c0c799f59920e765204064f59e2e40c0ea298","comments_url":"https://api.github.com/repos/apache/openjpa/commits/f22c0c799f59920e765204064f59e2e40c0ea298/comments","author":null,"committer":null,"parents":[{"sha":"3351b0c4a42ffc8e602b5c77650f760b78935b94","url":"https://api.github.com/repos/apache/openjpa/commits/3351b0c4a42ffc8e602b5c77650f760b78935b94","html_url":"https://github.com/apache/openjpa/commit/3351b0c4a42ffc8e602b5c77650f760b78935b94"}],"stats":{"total":11,"additions":8,"deletions":3},"files":[{"sha":"da65baa92cfdd6288c061eefdfdf33f746c3a05d","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/datacache/QueryCacheStoreQuery.java","status":"modified","additions":8,"deletions":3,"changes":11,"blob_url":"https://github.com/apache/openjpa/blob/f22c0c799f59920e765204064f59e2e40c0ea298/openjpa-kernel/src/main/java/org/apache/openjpa/datacache/QueryCacheStoreQuery.java","raw_url":"https://github.com/apache/openjpa/raw/f22c0c799f59920e765204064f59e2e40c0ea298/openjpa-kernel/src/main/java/org/apache/openjpa/datacache/QueryCacheStoreQuery.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/datacache/QueryCacheStoreQuery.java?ref=f22c0c799f59920e765204064f59e2e40c0ea298","patch":"@@ -128,6 +128,9 @@ private List checkCache(QueryKey qk) {\n             // using it because of the individual by-oid lookups\n             ClassMetaData meta = _repos.getMetaData(getContext().\n                 getCandidateType(), _sctx.getClassLoader(), true);\n+            if (meta.getDataCache() == null)\n+                return null;\n+\n             BitSet idxs = meta.getDataCache().containsAll(res);\n \n             // eventually we should optimize this to figure out how many objects\n@@ -333,9 +336,11 @@ private void clearAccessPath(StoreQuery q) {\n                 (q.getContext(), classes));\n \n             // evict from the data cache\n-            for (int i = 0; i < cmd.length; i++)\n-                cmd[i].getDataCache().removeAll(\n-                    cmd[i].getDescribedType(), true);\n+            for (int i = 0; i < cmd.length; i++) {\n+                if (cmd[i].getDataCache() != null)\n+                    cmd[i].getDataCache().removeAll(\n+                        cmd[i].getDescribedType(), true);\n+            }\n         }\n \n         public Number executeDelete(StoreQuery q, Object[] params) {"}]}

