{"sha":"f279a6790b13829dda3c0c741bd6f97a93159dc4","node_id":"MDY6Q29tbWl0MjA2MzY0OmYyNzlhNjc5MGIxMzgyOWRkYTNjMGM3NDFiZDZmOTdhOTMxNTlkYzQ=","commit":{"author":{"name":"A. Abram White","email":"awhite@apache.org","date":"2006-07-31T18:24:44Z"},"committer":{"name":"A. Abram White","email":"awhite@apache.org","date":"2006-07-31T18:24:44Z"},"message":"Added openjpa.MaxFetchDepth configuration property to globally control default\nmax fetch depth.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/openjpa/trunk@427191 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"20f83da131ea4bb9ac0f42f66676196295ba2cd8","url":"https://api.github.com/repos/apache/openjpa/git/trees/20f83da131ea4bb9ac0f42f66676196295ba2cd8"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/f279a6790b13829dda3c0c741bd6f97a93159dc4","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/f279a6790b13829dda3c0c741bd6f97a93159dc4","html_url":"https://github.com/apache/openjpa/commit/f279a6790b13829dda3c0c741bd6f97a93159dc4","comments_url":"https://api.github.com/repos/apache/openjpa/commits/f279a6790b13829dda3c0c741bd6f97a93159dc4/comments","author":null,"committer":null,"parents":[{"sha":"979d2340e93eaaa9f273a100dbe78e42ea9ed400","url":"https://api.github.com/repos/apache/openjpa/commits/979d2340e93eaaa9f273a100dbe78e42ea9ed400","html_url":"https://github.com/apache/openjpa/commit/979d2340e93eaaa9f273a100dbe78e42ea9ed400"}],"stats":{"total":88,"additions":85,"deletions":3},"files":[{"sha":"33e6324f46b4ade79e4df02b0fe9baeb8518f94b","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfiguration.java","status":"modified","additions":17,"deletions":0,"changes":17,"blob_url":"https://github.com/apache/openjpa/blob/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfiguration.java","raw_url":"https://github.com/apache/openjpa/raw/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfiguration.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfiguration.java?ref=f279a6790b13829dda3c0c741bd6f97a93159dc4","patch":"@@ -1023,6 +1023,23 @@\n      */\n     public void setFetchBatchSize(Integer size);\n \n+    /**\n+     * The maximum relation depth to traverse when eager fetching.  Use\n+     * -1 for no limit.\n+     */\n+    public int getMaxFetchDepth();\n+\n+    /**\n+     * The maximum relation depth to traverse when eager fetching.  Use\n+     * -1 for no limit.\n+     */\n+    public void setMaxFetchDepth(int depth);\n+\n+    /**\n+     * Wrapper for JCA usage of {@link #setMaxFetchDepth(int)}.\n+     */\n+    public void setMaxFetchDepth(Integer size);\n+\n     /**\n      * Comma-separated list of fetch group names that will be pre-set for\n      * all new {@link FetchConfiguration}s."},{"sha":"f04e3ade0bdb24fea51dd7df4f4614959ebdd7a5","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","status":"modified","additions":19,"deletions":0,"changes":19,"blob_url":"https://github.com/apache/openjpa/blob/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","raw_url":"https://github.com/apache/openjpa/raw/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/conf/OpenJPAConfigurationImpl.java?ref=f279a6790b13829dda3c0c741bd6f97a93159dc4","patch":"@@ -91,6 +91,7 @@\n     public BooleanValue transactionMode;\n     public IntValue connectionRetainMode;\n     public IntValue fetchBatchSize;\n+    public IntValue maxFetchDepth;\n     public StringListValue fetchGroups;\n     public IntValue flushBeforeQueries;\n     public IntValue lockTimeout;\n@@ -410,6 +411,10 @@ public OpenJPAConfigurationImpl(boolean derivations, boolean loadDefaults) {\n         fetchBatchSize.setDefault(\"-1\");\n         fetchBatchSize.set(-1);\n \n+        maxFetchDepth = addInt(\"MaxFetchDepth\");\n+        maxFetchDepth.setDefault(\"1\");\n+        maxFetchDepth.set(1);\n+\n         fetchGroups = addStringList(\"FetchGroups\");\n         fetchGroups.setDefault(\"default\");\n         fetchGroups.set(new String[]{ \"default\" });\n@@ -1207,6 +1212,20 @@ public int getFetchBatchSize() {\n         return fetchBatchSize.get();\n     }\n \n+    public void setMaxFetchDepth(int maxFetchDepth) {\n+        assertNotReadOnly();\n+        this.maxFetchDepth.set(maxFetchDepth);\n+    }\n+\n+    public void setMaxFetchDepth(Integer maxFetchDepth) {\n+        if (maxFetchDepth != null)\n+            setMaxFetchDepth(maxFetchDepth.intValue());\n+    }\n+\n+    public int getMaxFetchDepth() {\n+        return maxFetchDepth.get();\n+    }\n+\n     public void setFetchGroups(String fetchGroups) {\n         assertNotReadOnly();\n         this.fetchGroups.setString(fetchGroups);"},{"sha":"7de1dbbe4c7a21cc9d24df8a27e7b66dd73ac400","filename":"openjpa-kernel/src/main/java/org/apache/openjpa/kernel/FetchConfigurationImpl.java","status":"modified","additions":9,"deletions":3,"changes":12,"blob_url":"https://github.com/apache/openjpa/blob/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/FetchConfigurationImpl.java","raw_url":"https://github.com/apache/openjpa/raw/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/FetchConfigurationImpl.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/java/org/apache/openjpa/kernel/FetchConfigurationImpl.java?ref=f279a6790b13829dda3c0c741bd6f97a93159dc4","patch":"@@ -113,6 +113,7 @@ public void setContext(StoreContext ctx) {\n         setFlushBeforeQueries(conf.getFlushBeforeQueriesConstant());\n         clearFetchGroups();\n         addFetchGroups(Arrays.asList(conf.getFetchGroupsList()));\n+        setMaxFetchDepth(conf.getMaxFetchDepth());\n     }\n \n     /**\n@@ -170,9 +171,14 @@ public int getMaxFetchDepth() {\n     }\n \n     public FetchConfiguration setMaxFetchDepth(int depth) {\n-        _state.maxFetchDepth = depth;\n-        if (_parent == null)\n-            _availableDepth = depth;\n+        if (depth == DEFAULT && _state.ctx != null)\n+            depth = _state.ctx.getConfiguration().getMaxFetchDepth();\n+        if (depth != DEFAULT)\n+        {\n+            _state.maxFetchDepth = depth;\n+            if (_parent == null)\n+                _availableDepth = depth;\n+        }\n         return this;\n     }\n "},{"sha":"32d26d24ee40f04f89a839366570a2c2ad46093f","filename":"openjpa-kernel/src/main/resources/org/apache/openjpa/conf/localizer.properties","status":"modified","additions":8,"deletions":0,"changes":8,"blob_url":"https://github.com/apache/openjpa/blob/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/resources/org/apache/openjpa/conf/localizer.properties","raw_url":"https://github.com/apache/openjpa/raw/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-kernel/src/main/resources/org/apache/openjpa/conf/localizer.properties","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-kernel/src/main/resources/org/apache/openjpa/conf/localizer.properties?ref=f279a6790b13829dda3c0c741bd6f97a93159dc4","patch":"@@ -103,6 +103,14 @@ FetchBatchSize-cat: Fetching\n FetchBatchSize-displayorder: 50\n FetchBatchSize-expert: true\n \n+MaxFetchDepth-name: Maximum fetch depth.\n+MaxFetchDepth-desc: The maximum relation depth to traverse when eager \\\n+    fetching, or -1 for no limit.\n+MaxFetchDepth-type: Optimization\n+MaxFetchDepth-cat: Fetching\n+MaxFetchDepth-displayorder: 50\n+MaxFetchDepth-expert: true\n+\n FetchGroups-name: Fetch groups to add to default fetch group\n FetchGroups-desc: A comma-separated list of fetch group names that wll be \\\n \tloaded by default when fetching data from the data store."},{"sha":"e1a8a9a3c5943b94514009954d490196c3fcc144","filename":"openjpa-project/src/doc/manual/manual.xml","status":"modified","additions":32,"deletions":0,"changes":32,"blob_url":"https://github.com/apache/openjpa/blob/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-project/src/doc/manual/manual.xml","raw_url":"https://github.com/apache/openjpa/raw/f279a6790b13829dda3c0c741bd6f97a93159dc4/openjpa-project/src/doc/manual/manual.xml","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-project/src/doc/manual/manual.xml?ref=f279a6790b13829dda3c0c741bd6f97a93159dc4","patch":"@@ -17407,6 +17407,38 @@ true(CacheSize=1000)\n       </para>\n           <para><emphasis role=\"bold\">Description:</emphasis> The symbolic name\n       of the object-to-datastore mapping to use.\n+      </para>\n+        </section>\n+        <section id=\"openjpa.MaxFetchDepth\">\n+          <title>openjpa.MaxFetchDepth</title>\n+          <indexterm zone=\"openjpa.MaxFetchDepth\">\n+            <primary>MaxFetchDepth</primary>\n+          </indexterm>\n+          <indexterm zone=\"openjpa.MaxFetchDepth\">\n+            <primary>eager fetching</primary>\n+            <secondary>MaxFetchDepth</secondary>\n+          </indexterm>\n+          <para>\n+            <emphasis role=\"bold\">Property name:</emphasis>\n+            <literal>openjpa.MaxFetchDepth</literal>\n+          </para>\n+          <para>\n+            <emphasis role=\"bold\">Configuration API:</emphasis>\n+            <ulink url=\"../apidocs/org/apache/openjpa/conf/OpenJPAConfiguration.html#getMaxFetchDepth\">\n+              <methodname>org.apache.openjpa.conf.OpenJPAConfiguration.getMaxFetchDepth</methodname>\n+            </ulink>\n+          </para>\n+          <para>\n+            <emphasis role=\"bold\">Resource adaptor config-property:</emphasis>\n+            <literal>MaxFetchDepth</literal>\n+          </para>\n+          <para>\n+            <emphasis role=\"bold\">Default:</emphasis>\n+            <literal>1</literal>\n+          </para>\n+          <para><emphasis role=\"bold\">Description:</emphasis>  The maximum\n+      depth of relations to traverse when eager fetching.  Use -1 for no limit.\n+      Defaults to 1.\n       </para>\n         </section>\n         <section id=\"openjpa.MetaDataFactory\">"}]}

