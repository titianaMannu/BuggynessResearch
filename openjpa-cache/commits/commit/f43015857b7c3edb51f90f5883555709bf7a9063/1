{"sha":"f43015857b7c3edb51f90f5883555709bf7a9063","node_id":"MDY6Q29tbWl0MjA2MzY0OmY0MzAxNTg1N2I3YzNlZGI1MWY5MGY1ODgzNTU1NzA5YmY3YTkwNjM=","commit":{"author":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-04-10T02:32:07Z"},"committer":{"name":"Donald Woods","email":"dwoods@apache.org","date":"2010-04-10T02:32:07Z"},"message":"OPENJPA-1611: fix EMBEDDED attr type.  Merged in from trunk r930721 commit by Fay.\n\ngit-svn-id: https://svn.apache.org/repos/asf/openjpa/branches/2.0.x@932663 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"4073d504b24d10569fbdacd3c2985c9ae98d53c7","url":"https://api.github.com/repos/apache/openjpa/git/trees/4073d504b24d10569fbdacd3c2985c9ae98d53c7"},"url":"https://api.github.com/repos/apache/openjpa/git/commits/f43015857b7c3edb51f90f5883555709bf7a9063","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/apache/openjpa/commits/f43015857b7c3edb51f90f5883555709bf7a9063","html_url":"https://github.com/apache/openjpa/commit/f43015857b7c3edb51f90f5883555709bf7a9063","comments_url":"https://api.github.com/repos/apache/openjpa/commits/f43015857b7c3edb51f90f5883555709bf7a9063/comments","author":null,"committer":null,"parents":[{"sha":"1dc803b9d7167f5983e463cf14aaea8b6f2e329f","url":"https://api.github.com/repos/apache/openjpa/commits/1dc803b9d7167f5983e463cf14aaea8b6f2e329f","html_url":"https://github.com/apache/openjpa/commit/1dc803b9d7167f5983e463cf14aaea8b6f2e329f"}],"stats":{"total":16,"additions":15,"deletions":1},"files":[{"sha":"667c8f22d83c2a388ec0a58a8b5440a18926b020","filename":"openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/meta/TestMetamodel.java","status":"modified","additions":11,"deletions":1,"changes":12,"blob_url":"https://github.com/apache/openjpa/blob/f43015857b7c3edb51f90f5883555709bf7a9063/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/meta/TestMetamodel.java","raw_url":"https://github.com/apache/openjpa/raw/f43015857b7c3edb51f90f5883555709bf7a9063/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/meta/TestMetamodel.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence-jdbc/src/test/java/org/apache/openjpa/persistence/meta/TestMetamodel.java?ref=f43015857b7c3edb51f90f5883555709bf7a9063","patch":"@@ -38,6 +38,8 @@\n import javax.persistence.metamodel.Type.PersistenceType;\n \n import org.apache.openjpa.meta.ClassMetaData;\n+import org.apache.openjpa.persistence.embed.Address;\n+import org.apache.openjpa.persistence.embed.Geocode;\n import org.apache.openjpa.persistence.enhance.identity.Book;\n import org.apache.openjpa.persistence.enhance.identity.BookId;\n import org.apache.openjpa.persistence.enhance.identity.Library;\n@@ -71,7 +73,9 @@ public void setUp() {\n     \t        OneOneChild.class,\n     \t        Book.class,\n     \t        Library.class,\n-    \t        Page.class);\n+    \t        Page.class,\n+    \t        Address.class,\n+    \t        Geocode.class);\n     \temf.createEntityManager();\n         featureSelection = (MetamodelImpl)emf.getMetamodel();\n         }\n@@ -313,6 +317,12 @@ public void testBasicAttributeType() {\n         assertEquals(PersistentAttributeType.BASIC, pInt.getPersistentAttributeType());\n     }\n     \n+    public void testEmbeddedAttributeType() {\n+        ManagedType<Address> type = featureSelection.entity(Address.class);\n+        Attribute.PersistentAttributeType attr = type.getAttribute(\"geocode\").getPersistentAttributeType();\n+        assertEquals(PersistentAttributeType.EMBEDDED, attr);\n+    }\n+    \n     public void testNotFoundErrorMessage() {\n         IdentifiableType<ImplicitFieldAccessBase> e0 = featureSelection.entity(ImplicitFieldAccessBase.class);\n         String name = \"unknown\";"},{"sha":"5f7431e514946e6db4b1f353a4e4a693ddb5c11c","filename":"openjpa-persistence/src/main/java/org/apache/openjpa/persistence/meta/Members.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/apache/openjpa/blob/f43015857b7c3edb51f90f5883555709bf7a9063/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/meta/Members.java","raw_url":"https://github.com/apache/openjpa/raw/f43015857b7c3edb51f90f5883555709bf7a9063/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/meta/Members.java","contents_url":"https://api.github.com/repos/apache/openjpa/contents/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/meta/Members.java?ref=f43015857b7c3edb51f90f5883555709bf7a9063","patch":"@@ -200,6 +200,10 @@ public final BindableType getBindableType() {\n         public final PersistentAttributeType getPersistentAttributeType() {\n             if (!fmd.isDeclaredTypePC())\n                 return super.getPersistentAttributeType();\n+            if (fmd.getValue().isEmbedded() && fmd.getAssociationType() == 0) {\n+                return PersistentAttributeType.EMBEDDED;\n+            }\n+            \n             return fmd.getMappedByMetaData() == null || !fmd.getType().isAssignableFrom(Collection.class)\n                  ? PersistentAttributeType.ONE_TO_ONE\n                  : PersistentAttributeType.ONE_TO_MANY;"}]}

