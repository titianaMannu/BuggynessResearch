{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12438938","self":"https://issues.apache.org/jira/rest/api/2/issue/12438938","key":"OPENJPA-1360","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313326","id":"12313326","description":"","name":"1.3.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314857","id":"12314857","description":"2.0.0 Beta 3","name":"2.0.0-beta3","archived":false,"released":true,"releaseDate":"2010-03-29"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"161629","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313681","id":"12313681","description":"","name":"1.2.2","archived":false,"released":true,"releaseDate":"2010-01-18"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[{"id":"12329868","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12329868","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12454972","key":"OPENJPA-1492","self":"https://issues.apache.org/jira/rest/api/2/issue/12454972","fields":{"summary":"Change access on ReverseMappingTool#getAnnotationsForMeta(Object) from private to public","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312859","id":"12312859","name":"tooling","description":"OpenJPA Tooling - like ANT, Maven or Eclipse Plugins"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"203351","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1360/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@209be323[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@315725e4[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4e4e6c89[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@46be18a1[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@afb5b9c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@23fac90f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1eedc3dd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@28a0abb1[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@78573282[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@d102e36[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7d93f762[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@50432642[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2010-03-08T21:48:27.595+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1360/watchers","watchCount":0,"isWatching":false},"created":"2009-10-23T15:53:05.771+0000","updated":"2010-03-29T23:17:47.153+0000","timeoriginalestimate":null,"description":"In my ReverseCustomizer, I call classMapping.setEmbedded(true).  This is because for a variety of reasons I need the code that is generated by the ReverseMappingTool to be @MappedSuperclasses, not @Entities.\n\nIndeed when I do this, the resulting class is a @MappedSuperclass (great!) BUT all of the length and nullable and other @Column attributes are missing.  In other words, all simple fields receive only a @Basic annotation, with no attributes, and nothing else.  In addition, the class declaration receives a @Table annotation with no attributes.  (I'm using the command line flag that instructs the ReverseMappingTool to generate annotations.)\n\nIdeally I'd like the generated source code to look identical to the source code that would be generated for a ClassMapping where setEmbedded(true) was never called, except of course that I want the @Entity annotation to be replaced with @MappedSuperclass.\n\nObviously if there is a better way from within a ReverseCustomizer for me to accomplish my (very odd) goals (mandated by a strange development process and a 30-year-old database), I am all ears.","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12438211","id":"12438211","filename":"OPENJPA-1360-trunk.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"created":"2010-03-08T18:08:26.591+0000","size":1090,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12438211/OPENJPA-1360-trunk.patch"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"ReverseMappingTool omits nullable, length, etc. when ClassMapping.setEmbedded(true) is called","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12438938/comment/12770234","id":"12770234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"body":"It looks like, at least for the annotations path, AnnotationPersistenceMetaDataSerializer is the culprit.  At line 202 or thereabouts, in the isMappingMode(ClassMetaData meta) method, it includes a check to see if the supplied meta isEmbeddedOnly().  If it is, then there is nothing else you can do from the standpoint of your ReverseCustomizer: that metdata is deemed to NOT be in mapping mode.  That of course means that when the Java code is written out, all fields are output with only a @Basic annotation and nothing else.\n\nThe (rather cumbersome) workaround is to subclass both this serializer and PersistenceMappingFactory and supply a PersistenceMappingFactory implementation that returns new instances of an AnnotationPersistenceMetaDataSerializer that is capable of omitting this isEmbeddedOnly() check from its own implementation of the isMappingMode(ClassMetaData meta) method.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-10-26T22:10:37.252+0000","updated":"2009-10-26T22:10:37.252+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12438938/comment/12770617","id":"12770617","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"body":"Talking to myself it seems....  :-)\n\nI've successfully implemented the workaround as described in my prior comment.\n\nThe isMappingMode(ClassMetaData) method of my serializer now looks like this:\n\n@Override\npublic boolean isMappingMode(final ClassMetaData meta) {\n  return \n    this.isMappingMode() && \n    (meta.getSourceMode() & MetaDataModes.MODE_MAPPING) != 0 &&\n    (meta.getEmbeddingMetaData() == null || this.isMappingMode(meta.getEmbeddingMetaData()));\n}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-10-27T19:29:53.686+0000","updated":"2009-10-27T19:30:51.239+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12438938/comment/12806487","id":"12806487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"body":"This bug is still present in openjpa 1.2.2, even with the new ClassMapping.isAbstract() method.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ljnelson","name":"ljnelson","key":"ljnelson","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=ljnelson&avatarId=31544","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ljnelson&avatarId=31544","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ljnelson&avatarId=31544","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ljnelson&avatarId=31544"},"displayName":"Laird Nelson","active":true,"timeZone":"America/Los_Angeles"},"created":"2010-01-29T20:28:31.781+0000","updated":"2010-01-29T20:28:31.781+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12438938/comment/12842755","id":"12842755","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"body":"Proposed patch based on 1.3.x changes.  Need to run a full set of junits and TCK before committing to trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"created":"2010-03-08T18:08:26.632+0000","updated":"2010-03-08T18:08:26.632+0000"}],"maxResults":4,"total":4,"startAt":0},"customfield_12311820":"0|i0z6h3:","customfield_12314139":null}}

