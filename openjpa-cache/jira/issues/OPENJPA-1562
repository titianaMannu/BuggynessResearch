{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12458836","self":"https://issues.apache.org/jira/rest/api/2/issue/12458836","key":"OPENJPA-1562","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314857","id":"12314857","description":"2.0.0 Beta 3","name":"2.0.0-beta3","archived":false,"released":true,"releaseDate":"2010-03-29"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"161825","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314802","id":"12314802","description":"2.0.0 Beta 2","name":"2.0.0-beta2","archived":false,"released":true,"releaseDate":"2010-02-27"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"288852","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1562/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@24091fb2[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@14ac1c06[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@601a2e7e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@14224257[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@13b3dc42[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@d89262b[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3c51803a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3a674d1d[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@373bd7df[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@7347176d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@43a7096f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@43a8aba3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2010-03-24T17:34:06.844+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1562/watchers","watchCount":1,"isWatching":false},"created":"2010-03-11T17:52:56.184+0000","updated":"2010-03-25T03:44:21.678+0000","timeoriginalestimate":null,"description":"My application unit tests turned up some unexpected behavior from basic OpenJPA entity manager functions.  It appears, for instance, that a detached entity can still be refreshed.  I decided to write a few basic tests (attached) which report five potential errors.  This does not go into the testing of cascading behavior which would require additional work.","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12438534","id":"12438534","filename":"openjpa1562.tar.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-11T20:08:37.576+0000","size":7212,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12438534/openjpa1562.tar.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12438840","id":"12438840","filename":"patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-15T16:44:45.438+0000","size":6087,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12438840/patch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12438524","id":"12438524","filename":"simple_entity_tests.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-11T17:53:36.912+0000","size":9365,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12438524/simple_entity_tests.txt"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"EntityManager:Refresh on Removed entity does not trigger IllegalArgumentException","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"Mac OS X, OpenJPA 2.0.0-beta2, Spring 3.0","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844151","id":"12844151","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Here are the test cases and their output.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-11T17:53:36.960+0000","updated":"2010-03-11T17:53:36.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844197","id":"12844197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Basic unit test showing the failure.  Note that there is a parallel email thread in which Fay Wang could not reproduce the issue. <http://n2.nabble.com/Refreshing-detached-entities-tp4717312p4718095.html>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-11T19:45:11.418+0000","updated":"2010-03-11T19:45:11.418+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844198","id":"12844198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"body":"Which Spec level did you specify in your persistence.xml and what properties did you set?\nA JPA 1.0 level persistence.xml will automatically use compatibility settings to behave like OpenJPA 1.x -\nhttp://openjpa.apache.org/builds/latest/docs/manual/ref_guide_remote.html#ref_guide_detach","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"created":"2010-03-11T19:46:54.921+0000","updated":"2010-03-11T19:46:54.921+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844200","id":"12844200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"body":"Add post 2.0.0-beta2, the fix for OPENJPA-1097 has been integrated, which fixes a bug where EM.clear() was not removing some $proxy class wrappers from the entities....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"created":"2010-03-11T19:48:06.865+0000","updated":"2010-03-11T19:48:06.865+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844216","id":"12844216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Donald: interesting suggestions.  My persistence.xml file is pulling in the 2.0 namespace and specifies version 2.0.  I am now running against the OpenJPA-2.0.0.SNAPSHOT.jar and the behavior is unchanged.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-11T20:08:37.660+0000","updated":"2010-03-11T20:08:37.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844302","id":"12844302","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Donald: I think you are on the right track.  At DEBUG level, I see 'PersistenceVersion=1.0' during OpenJPA initialization.  Now to figure out why.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-12T00:48:28.704+0000","updated":"2010-03-12T00:48:44.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844339","id":"12844339","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Spring 3.0 is reporting the wrong version (1.0) for the PersistenceVersion.  <http://jira.springframework.org/browse/SPR-6975>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-12T02:34:07.627+0000","updated":"2010-03-12T02:34:07.627+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844350","id":"12844350","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Considerable progress.  Now only one of the twenty tests fails.\n\nTestEntity refreshRemoved = new TestEntity(\"refresh removed\");\nem.persist(refreshRemoved);\nem.flush();\nem.remove(refreshRemoved);\nem.flush();\nem.refresh(refreshRemoved);\n\nThis should throw an IllegalArgumentException, but does not.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-12T04:05:32.793+0000","updated":"2010-03-12T04:05:32.793+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844566","id":"12844566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"body":"I have reproduced this latest problem with remove/refresh and am looking into it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-12T16:57:29.740+0000","updated":"2010-03-12T16:57:29.740+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12844786","id":"12844786","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"Revised the bug description to reflect the narrowed scope and changed the state to minor as there are clear workarounds.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-13T01:01:41.523+0000","updated":"2010-03-13T01:01:41.523+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12845401","id":"12845401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"body":"Attached patch for this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-15T16:44:46.238+0000","updated":"2010-03-15T16:44:46.238+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12845538","id":"12845538","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Thanks for the patch Dianne, but I have a couple of questions. \n\n1. The javadoc for lock() and refresh() is very similar regarding detached entities : \n\nFor lock() :\n     @throws IllegalArgumentException if the instance is not an\n\n             entity or is a detached entity\n\nFor refresh() : \n     @throws IllegalArgumentException if the instance is not\n\n             an entity or the entity is not managed\n\nSeems like we'd want to the same thing for refresh and lock (basically the if check for REFRESH can be removed).\n\n2. This is more of a general question - your patch didn't introduce it but the assertValidAttchedEntity() method is very similar to contains(). There is a subtle difference in that contains checks whether the type is managed by this persistence context, and assertValidAttachedEntity checks whether the StateManager is persistent. There's also a slight difference in the exceptions thrown. Still it seems like we'd want to reuse the logic, and rather than duplicating the code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2010-03-15T21:31:55.353+0000","updated":"2010-03-15T21:31:55.353+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12845673","id":"12845673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for reviewing this patch Mike.\n\nFor question #1:\n\nWhen I first made the change and ran all of the tests, one set of lock tests failed because of remove followed by lock.\n\nSo, I searched through the spec related to this. Section 3.2.5 says, for a refresh operation, \"If X is a new, detched, or removed entity, the IllegalArgumentException is thrown.\" In other parts of the spec  (including the javadoc that you quoted), it says an IllegalArgumentException is thrown for a Lock request on a \"detached\" entity. But, I couldn't find any such statement fot a \"removed\" entity.\n\nFor question #2\n\nAt this point, I don't have an answer. I'll do a little digging.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dianner","name":"dianner","key":"dianner","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dianne E. Richards","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-16T03:01:14.839+0000","updated":"2010-03-16T03:01:14.839+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12845911","id":"12845911","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Hi Dianne, you're right per the spec a managed entity is one that has a persistent identity and is associated with the persistence context. A removed entity fits that description. \n\nI still think we can be a bit smarted about code reuse, but that's secondary to this issue - consider both my questions answered :-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2010-03-16T14:15:25.662+0000","updated":"2010-03-16T14:15:25.662+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12846021","id":"12846021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"body":"Committed patch.txt dated 2010-03-15 04:44 PM for Dianne under revision 923849.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2010-03-16T17:41:25.173+0000","updated":"2010-03-16T17:41:25.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12849297","id":"12849297","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"body":"The patch works for me.  I tested with beta3 build from the staging area.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=no1uno","name":"no1uno","key":"no1uno","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jerry Carter","active":true,"timeZone":"Etc/UTC"},"created":"2010-03-24T17:28:23.749+0000","updated":"2010-03-24T17:28:23.749+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12458836/comment/12849584","id":"12849584","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Closing on Jerry's behalf. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2010-03-25T03:44:21.677+0000","updated":"2010-03-25T03:44:21.677+0000"}],"maxResults":17,"total":17,"startAt":0},"customfield_12311820":"0|i1dtcn:","customfield_12314139":null}}

