{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12466672","self":"https://issues.apache.org/jira/rest/api/2/issue/12466672","key":"OPENJPA-1691","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314517","id":"12314517","description":"OpenJPA 1.2.3 Release","name":"1.2.3","archived":false,"released":true,"releaseDate":"2013-04-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313326","id":"12313326","description":"","name":"1.3.0","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315257","id":"12315257","description":"OpenJPA 2.0.x Maintenance Release","name":"2.0.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314542","id":"12314542","description":"","name":"2.1.0","archived":false,"released":true,"releaseDate":"2011-02-21"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"2512","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":["openjpa","oracle","xmltype"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313681","id":"12313681","description":"","name":"1.2.2","archived":false,"released":true,"releaseDate":"2010-01-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314019","id":"12314019","description":"JPA2 release","name":"2.0.0","archived":false,"released":true,"releaseDate":"2010-04-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314532","id":"12314532","description":"2.0.1 Release","name":"2.0.1","archived":false,"released":true,"releaseDate":"2010-08-30"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[{"id":"12334463","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12334463","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12477551","key":"OPENJPA-1839","self":"https://issues.apache.org/jira/rest/api/2/issue/12477551","fields":{"summary":"TestXMLCustomerOrder failed against Oracle with \"ORA-01461: can bind a LONG value only for insert into a LONG column\"","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311310","id":"12311310","name":"sql","description":"Issues to do with SQL, including generation of SQL. Issues that have to do with JDBC (i.e., execution of SQL statements and result set processing) should be filed in the jdbc component."}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"204223","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kailaw","name":"kailaw","key":"kailaw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kelvin Law","active":true,"timeZone":"Etc/UTC"},"subtasks":[{"id":"12467489","key":"OPENJPA-1703","self":"https://issues.apache.org/jira/rest/api/2/issue/12467489","fields":{"summary":"Add JDBC 4 methods to JDBC delegates","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}},{"id":"12475658","key":"OPENJPA-1821","self":"https://issues.apache.org/jira/rest/api/2/issue/12475658","fields":{"summary":"Upgrade to Commons DBCP 1.4","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype","name":"Sub-task","subtask":true,"avatarId":21146}}}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kailaw","name":"kailaw","key":"kailaw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kelvin Law","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1691/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1101b27f[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@330efda2[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5717c9c3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@13b0cd6e[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7109f48e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@72d7971a[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1b670152[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@e2964ed[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@30ba5c22[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@7e9b6268[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5dd58178[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@181e9823[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2011-07-27T18:39:32.433+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1691/watchers","watchCount":2,"isWatching":false},"created":"2010-06-10T17:31:33.518+0000","updated":"2018-12-07T16:24:43.761+0000","timeoriginalestimate":null,"description":"Oracle throws the following exception when XML content is greater than 4000 characters:\nORA-01461: can bind a LONG value only for insert into a LONG column","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12485482","id":"12485482","filename":"OPENJPA-1691_2.0.x.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2011-07-06T20:39:00.336+0000","size":12064,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12485482/OPENJPA-1691_2.0.x.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12485487","id":"12485487","filename":"OPENJPA-1691.1.2.x.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2011-07-06T21:12:09.493+0000","size":11586,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12485487/OPENJPA-1691.1.2.x.patch"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"Oracle XMLType column failed to insert/update when xml contains more than 4000 characters","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"Oracle 10g, JDBC driver (ojdbc14.jar) 10.2.0.4.0, OpenJPA 1.2.2","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/12878366","id":"12878366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"body":"Some work notes:\n\nNeither PreparedStatement.setCharacterStream(int, Reader, int) nor OraclePreparedStatement.setStringForClob(int, String) helps here.\nSo far I have found two methods that seem to work with data over 4000 chars:\n\na)\n1. Prepare a statement using XMLType constructor \"insert into TORDERXML values(?, ?, ?, XMLType(?), ?, ?, ?)\" \n2. Set the value by using PreparedStatement.setClob(int, Reader). This requires JDBC 4 (JDK 6). Tried with 11.2.0.1 driver.\n\nb)\n1. Prepare a statement using XMLType constructor \"insert into TORDERXML values(?, ?, ?, XMLType(?), ?, ?, ?)\" \n2. Create a temporary CLOB, fill it with XML data (similarly to [1]) and use PreparedStatement.setClob(int, Clob) or PreparedStatement.setObject(int, Object). This requires using Oracle-specific API and the temporary CLOB should be freed after statement execution. This works with 10.2.0.4 driver but 11.2.0.1 throws a bunch of ORAs:\nORA-31011: XML parsing failed\nORA-19202: Error occurred in XML processing\nLPX-00229: input source is empty\nError at line 0\nORA-06512: at \"SYS.XMLTYPE\", line 254\nORA-06512: at line 1\n\nNeither method is a workaround for users to be applied solely in DBDictionary but requires a patch.\n\nKelvin, which JDK are you using?\n\n[1] http://www.oracle.com/technology/sample_code/tech/java/codesnippet/xmldb/Example_Code.html#createclob\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"created":"2010-06-13T08:56:22.922+0000","updated":"2010-06-13T08:56:22.922+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/12878570","id":"12878570","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kailaw","name":"kailaw","key":"kailaw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kelvin Law","active":true,"timeZone":"Etc/UTC"},"body":"Hi Milosz,\n\nI am using Sun JDK 1.5.0_22","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kailaw","name":"kailaw","key":"kailaw","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kelvin Law","active":true,"timeZone":"Etc/UTC"},"created":"2010-06-14T13:23:54.483+0000","updated":"2010-06-14T13:23:54.483+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/12917398","id":"12917398","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"body":"The fix requires a JDBC 4 driver. There are still issues when querying over long individual XML nodes coming from obscure limits in Oracle's extractValue() function.\n\nNote that reading XML values longer than 4000 bytes was also broken - replaced getStringVal() calls with getClobVal().\n\nAs a side effect users gained a bit of control on INSERT/UPDATE statements in DBDictionary.getMarkerForInsertUpdate method. One can do things like INSERT INTO tab(id, uppercased_name) VALUES (?, UPPER(?)).\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"created":"2010-10-03T21:00:52.804+0000","updated":"2010-10-03T21:04:02.110+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/12981341","id":"12981341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Closing issue which has been resolved for some time. If you believe the issue is not resolved please reopen or open a new issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2011-01-13T16:45:28.784+0000","updated":"2011-01-13T16:45:28.784+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13021678","id":"13021678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mjarends","name":"mjarends","key":"mjarends","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mitchell Arends","active":true,"timeZone":"Etc/UTC"},"body":"This issue also affects the 2.0.2 builds as well. Is there a known workaround for this issue for the 2.0.2 release?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mjarends","name":"mjarends","key":"mjarends","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mitchell Arends","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-19T17:38:35.942+0000","updated":"2011-04-19T17:38:35.942+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13022076","id":"13022076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"body":"Mitchell, you can fix reading of XML values by extending the OracleDictionary and setting the getStringVal property to \".getClobVal()\".\n\nFor insert/update, I am afraid there might be no workaround or one is not easy. First, in your extended OracleDictionary you overrride setClobString method to use the JDBC 4 variant of setClob mentioned above. Second, you provide your own UpdateManager via openjpa.jdbc.UpdateManager property and somehow make it use your own implementation of Row interface to emit \"XMLType(?)\" in INSERT and UPDATEs.\n\nSee also a thread on users list [1] and let us know if you succeed.\n\n[1] http://openjpa.208410.n2.nabble.com/Oracle-XMLType-fetch-problems-td6208344.html#a6252836","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=milosz","name":"milosz","key":"milosz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Milosz Tylenda","active":true,"timeZone":"Etc/UTC"},"created":"2011-04-20T11:05:05.039+0000","updated":"2011-04-20T11:05:05.039+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13038037","id":"13038037","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"body":"Re-opening to post a patch for pre-2.1.x releases.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2011-05-23T16:47:35.598+0000","updated":"2011-05-23T16:47:35.598+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13038045","id":"13038045","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"body":"The fix for this issue in 2.1.0 involved full JDBC 4.0-level support within OpenJPA.  This is not possible on releases prior to 2.1.0 since they support Java 1.5. Thus, the same fix for this issue is not possible on pre-2.1.x releases.  Using reflection, I was able to produce a patch that works with prior releases and still compiles and works with Java 1.5.  The code reflectively calls JDBC 4.0 methods to set the XML value as a clob input reader.  JRE 1.6 and an Oracle 1.6 (ojdbc6.jar) are required.  In addition, the OracleDictionary supportsSetClob value must be set to true in order to enable the support.  If DBCP is used, at least DBCP 1.4 is required since it supports call-thru of JDBC 4.0 connection and prepared statement methods.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2011-05-23T16:58:55.386+0000","updated":"2011-05-23T16:58:55.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13038049","id":"13038049","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"body":"Attached patch for 1.2.x stream","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2011-05-23T17:06:44.265+0000","updated":"2011-05-23T17:06:44.265+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13060819","id":"13060819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"body":"Attached patch for 2.0.x.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=techhusky","name":"techhusky","key":"techhusky","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Bauer","active":true,"timeZone":"America/Chicago"},"created":"2011-07-06T20:39:00.388+0000","updated":"2011-07-06T20:39:00.388+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/13086429","id":"13086429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"body":"I'd like to add a few more details about the code changes made to 1.2.x and 2.0.x.  These details are in addition to the previous (and vitally important) details added by Jeremy.  In addition to his requirements, it should be noted that the code changes made in this JIRA are gated (enabled/disabled) via a system property.  The system property is named 'supportsSetClob' and is defined on the Oracle dictionary class.  As an example, the property can be defined as follows:\n\n<property name=\"openjpa.jdbc.DBDictionary\" value=\"oracle(supportsSetClob=true)\"/>           \n\n\nNext, it should be noted that we expect the XML field(s) to be annotated with:                 \n                                                                        \n@Strategy(\"org.apache.openjpa.jdbc.meta.strats.XMLValueHandler\")        \n                                                                        \nThis allows a user to indicate that OpenJPA should use JAXB classmetadata to perform the to/from database value retrieval and storage.  In addition, using this strategy indicates there is an XMLType used to store the value in the database.  Instead, we've seen customers attempt to managing their own XML string, mapped to a string field, and expect the code changes of this JIRA to apply.  While a user has an XMLType specified in the column definition, OpenJPA cannot count on this data to detect whether the column is really an XML column in the database (the table could have been created manually with separate DDL instead of using OpenJPA's mapping tool).  \nIn this case, where the user is doing their own String mapping rather than using the XMLValueHandler, there are some additional settings a user may need to set/enable in order to resolve the issue addressed in this JIRA.  The necessary settings/actions are as follows:\n\nFirst, it may be necessary to annotate an XML field with @Lob, as follows:                                                        \n                                                                        \n@Lob                                                                    \n@Column(name=\"CONTENTS_XML\", columnDefinition =\"XMLCOLUMN XMLType\") \nprivate String contentsXml;                                            \n                                                                        \nSecond, in addition to annotating the XML field with @Lob, a user may also need to set this dictionary property:                                                               \n                                                                        \nmaxEmbeddedClobSize=-1                                                  \n                                                                        \nTherefore, the final DBDictionary property would be:\n                                                                        \n<property name=\"openjpa.jdbc.DBDictionary\" value=\"oracle(supportsSetClob=true,maxEmbeddedClobSize=-1)\"/>           \n                                                                       \n                                                                         \nFinally, a user may need to use the native schema factory to pick up the XMLType from the database, that property is as follows:                \n                                                                        \n<property name=\"openjpa.jdbc.SchemaFactory\" value=\"native\"/>            \n\nBy enabling OpenJPA's native schema factory, the database column type can be detected as XMLType.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"created":"2011-08-17T16:27:56.547+0000","updated":"2011-08-17T16:27:56.547+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12466672/comment/16713055","id":"16713055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nezih","name":"nezih","key":"nezih","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nezih&avatarId=36148","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nezih&avatarId=36148","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nezih&avatarId=36148","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nezih&avatarId=36148"},"displayName":"Nezih BEN FREDJ","active":true,"timeZone":"Etc/UTC"},"body":"Hi,\r\n\r\nI tried to apply instructions recommended by Heath Thomann but with no success. something is missing to tell OpenJpa that the column is xml.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nezih","name":"nezih","key":"nezih","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nezih&avatarId=36148","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nezih&avatarId=36148","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nezih&avatarId=36148","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nezih&avatarId=36148"},"displayName":"Nezih BEN FREDJ","active":true,"timeZone":"Etc/UTC"},"created":"2018-12-07T16:24:43.761+0000","updated":"2018-12-07T16:24:43.761+0000"}],"maxResults":12,"total":12,"startAt":0},"customfield_12311820":"0|i0zbuv:","customfield_12314139":null}}

