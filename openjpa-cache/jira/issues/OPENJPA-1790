{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12473961","self":"https://issues.apache.org/jira/rest/api/2/issue/12473961","key":"OPENJPA-1790","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315257","id":"12315257","description":"OpenJPA 2.0.x Maintenance Release","name":"2.0.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314542","id":"12314542","description":"","name":"2.1.0","archived":false,"released":true,"releaseDate":"2011-02-21"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"162032","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":86400,"timeestimate":86400,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314532","id":"12314532","description":"2.0.1 Release","name":"2.0.1","archived":false,"released":true,"releaseDate":"2010-08-30"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311302","id":"12311302","name":"kernel","description":"Kernel"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":86400,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"201187","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":86400,"percent":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":86400,"percent":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1790/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2b1b2a57[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3b349e13[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@30307bd8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@2f6bbfcb[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5cfb50e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1a99a4a3[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@29c4e293[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5ba39587[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@233c2c38[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@74d72840[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a098c33[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3dc12158[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2010-09-23T02:21:05.919+0000","workratio":0,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1790/watchers","watchCount":0,"isWatching":false},"created":"2010-09-13T08:30:21.370+0000","updated":"2010-11-19T02:17:42.877+0000","timeoriginalestimate":86400,"description":"Hi,\n\nNow I am working on OpenJPA support for Apache Shindig 2.0. There is a test case to insert some entity into backend derby database, but every time when running to commint(), there  is such error thrown, unfortunately I am not to work it out, and ask here if this is a known issue? Thanks.\n\nI searched an issue past of: https://issues.apache.org/jira/browse/OPENJPA-91, and tried to put all openjpa related jars into jdk/jre/lib/ext, but it does not work for.\n\nIn DOS cmd line or in eclipse IDE, I run the junit test case with jdk 1.6, both  returning same error:\n\n-------------------------------------------------------------------------------\nTest set: org.apache.shindig.social.opensocial.jpa.spi.PersonServiceDbTest\n-------------------------------------------------------------------------------\nTests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.391 sec <<< FAILURE!\norg.apache.shindig.social.opensocial.jpa.spi.PersonServiceDbTest  Time elapsed: 0.438 sec  <<< ERROR!\njava.lang.VerifyError: (class: org/apache/openjpa/util/java$util$concurrent$ConcurrentHashMap$11$proxy, method: remove signature: (Ljava/lang/Object;Ljava/lang/Object;)Z) Expecting to find integer on stack\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:247)\n\tat org.apache.openjpa.util.GeneratedClasses.loadBCClass(GeneratedClasses.java:67)\n\tat org.apache.openjpa.util.ProxyManagerImpl.getFactoryProxyMap(ProxyManagerImpl.java:382)\n\tat org.apache.openjpa.util.ProxyManagerImpl.newMapProxy(ProxyManagerImpl.java:207)\n\tat org.apache.openjpa.kernel.StateManagerImpl.newFieldProxy(StateManagerImpl.java:1829)\n\tat org.apache.openjpa.kernel.SingleFieldManager.proxy(SingleFieldManager.java:117)\n\tat org.apache.openjpa.kernel.StateManagerImpl.proxyFields(StateManagerImpl.java:2896)\n\tat org.apache.openjpa.kernel.PNonTransState.initialize(PNonTransState.java:45)\n\tat org.apache.openjpa.kernel.StateManagerImpl.setPCState(StateManagerImpl.java:287)\n\tat org.apache.openjpa.kernel.StateManagerImpl.commit(StateManagerImpl.java:1128)\n\tat org.apache.openjpa.kernel.BrokerImpl.endTransaction(BrokerImpl.java:2383)\n\tat org.apache.openjpa.kernel.BrokerImpl.afterCompletion(BrokerImpl.java:1975)\n\tat org.apache.openjpa.kernel.LocalManagedRuntime.commit(LocalManagedRuntime.java:94)\n\tat org.apache.openjpa.kernel.BrokerImpl.commit(BrokerImpl.java:1479)\n\tat org.apache.openjpa.kernel.DelegatingBroker.commit(DelegatingBroker.java:925)\n\tat org.apache.openjpa.persistence.EntityManagerImpl.commit(EntityManagerImpl.java:560)\n\tat org.apache.shindig.social.opensocial.jpa.spi.SpiDatabaseBootstrap.bootstrapDatabase(SpiDatabaseBootstrap.java:186)\n\tat org.apache.shindig.social.opensocial.jpa.spi.SpiDatabaseBootstrap.init(SpiDatabaseBootstrap.java:85)\n\tat org.apache.shindig.social.opensocial.jpa.spi.PersonServiceDbTest.setup(PersonServiceDbTest.java:71)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.junit.runners.featureSelection.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n\tat org.junit.internal.runners.featureSelection.ReflectiveCallable.run(ReflectiveCallable.java:15)\n\tat org.junit.runners.featureSelection.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n\tat org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:62)\n\tat org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:140)\n\tat org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:127)\n\tat org.apache.maven.surefire.Surefire.run(Surefire.java:177)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:345)\n\tat org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1009)\n\n","customfield_10010":null,"timetracking":{"originalEstimate":"24h","remainingEstimate":"24h","originalEstimateSeconds":86400,"remainingEstimateSeconds":86400},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12455178","id":"12455178","filename":"concurrent_junit.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"created":"2010-09-21T19:01:44.947+0000","size":6618,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12455178/concurrent_junit.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12455307","id":"12455307","filename":"openjpa-1790.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"created":"2010-09-22T20:47:31.531+0000","size":9792,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12455307/openjpa-1790.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12459364","id":"12459364","filename":"OPENJPA-1790-2.0.x.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"created":"2010-11-11T16:17:55.185+0000","size":10317,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12459364/OPENJPA-1790-2.0.x.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12454524","id":"12454524","filename":"persistence.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-14T06:20:34.016+0000","size":6046,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12454524/persistence.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12454522","id":"12454522","filename":"PersonServiceDbTest.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-14T06:20:33.907+0000","size":5591,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12454522/PersonServiceDbTest.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12454437","id":"12454437","filename":"pom.xml","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-13T08:34:39.444+0000","size":7318,"mimeType":"text/xml","content":"https://issues.apache.org/jira/secure/attachment/12454437/pom.xml"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12454523","id":"12454523","filename":"SpiDatabaseBootstrap.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-14T06:20:33.965+0000","size":28119,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12454523/SpiDatabaseBootstrap.java"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"java.lang.VerifyError thrown when trying to commit entity.","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"JDK1.6 u20, maven 2.2.1, Apache Shindig 2.0, OpenJPA 2.0.1","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12908669","id":"12908669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"body":"I pasted the pom.xml here, would you pls check if I used the maven plugin of openjpa and dependency correctly?\n\nWhat I am running on is simple environment, just from cmd line of IDE, to run a junit test.\n\nAnd just let me know if I missed anything. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-13T08:34:39.521+0000","updated":"2010-09-13T08:34:39.521+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12908774","id":"12908774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"body":"Try removing these 2 depends -\n  <dependency>\n    <groupId>org.eclipse.persistence</groupId>\n    <artifactId>eclipselink</artifactId>\n    <version>1.0</version>\n  </dependency>\n  <dependency>\n    <groupId>commons-dbcp</groupId>\n    <artifactId>commons-dbcp</artifactId>\n    <version>1.2.2</version>\n  </dependency>\nAnd replacing this OpenJPA depend -\n  <dependency>\n    <groupId>org.apache.openjpa</groupId>\n    <artifactId>openjpa-persistence-jdbc</artifactId>\n    <version>2.0.1</version>\n  </dependency>\nwith the following -\n  <dependency>\n    <groupId>org.apache.openjpa</groupId>\n    <artifactId>openjpa-all</artifactId>\n    <version>2.0.1</version>\n  </dependency>\n\nAlso, can you attach your persistence.xml and/or point me to a svn location of the SPI code that you are testing, so we can look at the entities?\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"created":"2010-09-13T13:12:10.381+0000","updated":"2010-09-13T13:12:10.381+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12909124","id":"12909124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"body":"Hi Donald,\n\nThanks for so quick response. I attached files. I modified the pom.xml and changed according to your comment, but I still can see the error.\n\nThe files are from http://svn.apache.org/repos/asf/shindig/trunk/java/samples/src/test/java/org/apache/shindig/social/opensocial/jpa/spi/, but I made some changes locally to make sure openjpa work.\n\nWhat I am testing is PersonServiceDBTest.java, but in its setup() method before running own test methods, it will call init() method on SpiDatabaseBootstrap. In this init() method, VerifyError was thrown when commit() called, in the last line of init() method.\n\nIf I comment out lines from \"entityManager.persist(buildCanonicalActivity(\"canonical\", \"1\"));\" to \"entityManager.persist(applicationDataMap5);\" in method bootstrapDatabase() in SpiDatabaseBootstrap, there will be no such VerifyError then.\n\nThanks a lot for helping to look at this, and please let me know if I need provide more details.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-14T06:20:34.072+0000","updated":"2010-09-14T06:20:34.072+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12912384","id":"12912384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"body":"Could anybody please check this problem, such as ideas of under what situation this type of error would be thrown?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-20T08:08:38.701+0000","updated":"2010-09-20T08:08:38.701+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12913179","id":"12913179","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"body":"Junit that reproduces the reported failure, commentary to follow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"created":"2010-09-21T19:01:45.025+0000","updated":"2010-09-21T19:01:45.025+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12913187","id":"12913187","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"body":"It turns out that the problem is with the way OpenJPA extends a Map type to implement Proxy and ProxyMap during runtime with the ProxyManagerImpl when the type of the map is a ConcurrentMap type, in Kai's case it is ConcurrentHashMap.  ConcurrentMap defines a method \"boolean replace(Object, Object)\" -- the very method that is in the reported Exception:\n\njava.lang.VerifyError: (class: org/apache/openjpa/util/java$util$concurrent$ConcurrentHashMap$11$proxy, method: remove signature: (Ljava/lang/Object;Ljava/lang/Object;)Z) Expecting to find integer on stack \n\nAfter researching more on the VerifyError, it looks like the version of remove (remove methods are considered to be setter methods by  ProxyManagerImpl.isSetter()) is wrappered by ProxyManagerImpl.proxySetter().  And while it looks like proxySetter() is taking care to ensure the return type is preserved, the VerifyError suggests the bytecode is trying to return an object of type integer instead.\n\nI've reproduced this problem with a junit test, all that needed to be done was to initialize a relationship field of type Map with a ConcurrentHashMap, and the Exception surfaced during transaction commit:\n\n  <testcase time=\"0.158\" classname=\"org.apache.openjpa.persistence.relations.TestConcurrentMap\" name=\"testConcurrentMap001\">\n    <error message=\"(class: org/apache/openjpa/util/java$util$concurrent$ConcurrentHashMap$1$proxy, method: remove signature: (Ljava/lang/Object;Ljava/lang/Object;)Z) Expecting to find integer on stack\" type=\"java.lang.VerifyError\">java.lang.VerifyError: (class: org/apache/openjpa/util/java$util$concurrent$ConcurrentHashMap$1$proxy, method: remove signature: (Ljava/lang/Object;Ljava/lang/Object;)Z) Expecting to find integer on stack\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:247)\n\tat org.apache.openjpa.util.GeneratedClasses.loadBCClass(GeneratedClasses.java:71)\n\tat org.apache.openjpa.util.ProxyManagerImpl.getFactoryProxyMap(ProxyManagerImpl.java:382)\n\tat org.apache.openjpa.util.ProxyManagerImpl.newMapProxy(ProxyManagerImpl.java:207)\n\tat org.apache.openjpa.kernel.StateManagerImpl.newFieldProxy(StateManagerImpl.java:1829)\n\tat org.apache.openjpa.kernel.SingleFieldManager.proxy(SingleFieldManager.java:117)\n\tat org.apache.openjpa.kernel.StateManagerImpl.proxyFields(StateManagerImpl.java:2896)\n\tat org.apache.openjpa.kernel.PNonTransState.initialize(PNonTransState.java:45)\n\tat org.apache.openjpa.kernel.StateManagerImpl.setPCState(StateManagerImpl.java:287)\n\tat org.apache.openjpa.kernel.StateManagerImpl.commit(StateManagerImpl.java:1128)\n\tat org.apache.openjpa.kernel.BrokerImpl.endTransaction(BrokerImpl.java:2383)\n\tat org.apache.openjpa.kernel.BrokerImpl.afterCompletion(BrokerImpl.java:1975)\n\tat org.apache.openjpa.kernel.LocalManagedRuntime.commit(LocalManagedRuntime.java:94)\n\tat org.apache.openjpa.kernel.BrokerImpl.commit(BrokerImpl.java:1479)\n\tat org.apache.openjpa.kernel.DelegatingBroker.commit(DelegatingBroker.java:925)\n\tat org.apache.openjpa.persistence.EntityManagerImpl.commit(EntityManagerImpl.java:560)\n\tat org.apache.openjpa.persistence.relations.TestConcurrentMap.testConcurrentMap001(TestConcurrentMap.java:46)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat junit.framework.TestCase.runTest(TestCase.java:154)\n\tat org.apache.openjpa.persistence.test.AbstractPersistenceTestCase.runTest(AbstractPersistenceTestCase.java:516)\n\nThis junit should provide a baseline with developing a fix for this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"created":"2010-09-21T19:11:42.217+0000","updated":"2010-09-21T19:11:42.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12913778","id":"12913778","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"body":"Proposed patch for OJ-1790.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fyrewyld","name":"fyrewyld","key":"fyrewyld","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=fyrewyld&avatarId=28040","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fyrewyld&avatarId=28040","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fyrewyld&avatarId=28040","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fyrewyld&avatarId=28040"},"displayName":"Jody Grassel","active":true,"timeZone":"America/Chicago"},"created":"2010-09-22T20:47:31.605+0000","updated":"2010-09-22T20:47:31.605+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12913790","id":"12913790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"body":"+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drwoods","name":"drwoods","key":"drwoods","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drwoods&avatarId=20433","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drwoods&avatarId=20433","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drwoods&avatarId=20433","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drwoods&avatarId=20433"},"displayName":"Donald Woods","active":true,"timeZone":"America/New_York"},"created":"2010-09-22T21:03:50.753+0000","updated":"2010-09-22T21:03:50.753+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12913883","id":"12913883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Nice patch Joe, I've committed it to trunk (revision 1000292)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2010-09-23T02:20:33.332+0000","updated":"2010-09-23T02:20:33.332+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12914900","id":"12914900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"body":"I tried the new jar with patch of Joe, it works for me, the VerifyError is gone.\n\nThank you Joe and everyone.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=zhangkf","name":"zhangkf","key":"zhangkf","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kai Feng Zhang","active":true,"timeZone":"Etc/UTC"},"created":"2010-09-26T01:31:17.054+0000","updated":"2010-09-26T01:31:17.054+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12473961/comment/12931068","id":"12931068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"body":"I'm providing a patch for 2.0.x which is basically a back port of the changes from trunk.\n\nThanks,\n\nHeath","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"created":"2010-11-11T16:17:55.266+0000","updated":"2010-11-11T16:17:55.266+0000"}],"maxResults":11,"total":11,"startAt":0},"customfield_12311820":"0|i0yt47:","customfield_12314139":null}}

