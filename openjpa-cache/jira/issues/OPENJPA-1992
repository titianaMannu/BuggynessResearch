{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12506151","self":"https://issues.apache.org/jira/rest/api/2/issue/12506151","key":"OPENJPA-1992","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315910","id":"12315910","description":"OpenJPA 2.2.0 Release","name":"2.2.0","archived":false,"released":true,"releaseDate":"2012-02-20"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"2335","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314542","id":"12314542","description":"","name":"2.1.0","archived":false,"released":true,"releaseDate":"2011-02-21"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[{"id":"12338971","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12338971","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12506673","key":"OPENJPA-1995","self":"https://issues.apache.org/jira/rest/api/2/issue/12506673","fields":{"summary":"JPQL Queries do not support mixing positional and named parameters","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}},{"id":"12339067","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12339067","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12507153","key":"OPENJPA-1999","self":"https://issues.apache.org/jira/rest/api/2/issue/12507153","fields":{"summary":"Optional support for non-sequential positional parameters","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype","name":"Improvement","subtask":false,"avatarId":21140}}}}],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311302","id":"12311302","name":"kernel","description":"Kernel"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"202392","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1992/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1e4cad36[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5ef89051[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@28976628[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@32f70173[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32543541[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2b27cdf5[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3812589f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@32643a77[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2189ef47[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3454d6e6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1e28a653[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@d0c8063[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2011-05-09T13:46:27.975+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-1992/watchers","watchCount":0,"isWatching":false},"created":"2011-05-04T09:40:59.998+0000","updated":"2011-07-13T16:11:20.268+0000","timeoriginalestimate":null,"description":"Query q = em.createQuery(\"SELECT x FROM Magazine x WHERE x.title = ?2 and x.price > ?3\");\nq.setParameter(2, \"JDJ\").setParameter(3, 25.0);\n\nWhen the query is executed, java.lang.ArrayIndexOutOfBoundsException will be thrown. Since \"JDJ\" and \"25.0\" will be stored in arr[0] and arr[1] (when arr.size =2) but the query execution code tries to get them via arr[2] and arr[3].","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12478374","id":"12478374","filename":"Main.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-05-06T06:23:30.378+0000","size":3016,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12478374/Main.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12478144","id":"12478144","filename":"OPENJPA-1992.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-05-04T09:42:05.610+0000","size":2222,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12478144/OPENJPA-1992.patch"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"java.lang.ArrayIndexOutOfBoundsException if positional parameter are not started from 1","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13028688","id":"13028688","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"body":"Patch is attached, please help to review. Thanks in advance!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-05-04T09:42:05.660+0000","updated":"2011-05-04T09:42:05.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13028690","id":"13028690","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"body":"Just for information. the problem doesn't exist in openjpa 1.2.2.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-05-04T09:46:18.892+0000","updated":"2011-05-04T09:46:18.892+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13029320","id":"13029320","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Thanks for the patch. Could you also provide a testcase the reproduces the error? \n\nThe JPA spec does indicate that input parameters will start with 1 (section 4.6.4.1), but we should at least fail in a more informative way. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2011-05-05T13:30:34.190+0000","updated":"2011-05-05T13:30:34.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13029773","id":"13029773","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"body":"Hi Michael,\n\nThis exception can be reproduced with the hellojpa sample by following Getting Started with the Eclipse steps on http://openjpa.apache.org/getting-started.html. After step 10, replace the Main.java with the attached copy of Main.java, and then rerun step 9.\n\nI noticed that spec indicates that input parameters will start with 1 in both JPA spec(section 4.6.4.1) and EJB spec(section 9.2.6.4), but this exception blocks our TCK, which expects \"SELECT x FROM Magazine x WHERE x.title = ?2 and x.price > ?3\" can be successfully processed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-05-06T06:22:07.132+0000","updated":"2011-05-06T06:22:07.132+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13029774","id":"13029774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"body":"Attached modified Main.java for problem re-creation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hanhongfang","name":"hanhongfang","key":"hanhongfang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hong Fang Han","active":true,"timeZone":"Asia/Shanghai"},"created":"2011-05-06T06:23:30.419+0000","updated":"2011-05-06T06:23:30.419+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13030159","id":"13030159","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Hi Han,\n\nWhich TCK are you talking about? OpenJPA 2.1.0 passed the JPA 1.0 and 2.0 TCKs prior to release. I'm assuming you're talking about a different test suite? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2011-05-06T21:55:41.960+0000","updated":"2011-05-06T21:55:41.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13030170","id":"13030170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"body":"The binding parameter indexing, ordering and naming are somewhat sensitive to many implicit assumptions throughout our codebase. It is made more sensitive after we introduced Prepared Query Caches that rebinds parameters (that originally could have been named) to SQL (that only accepts integral parameter). The index of parameters affects the kernel and also note that kernel internals can insert its own parameters that are invisible to the user application. \n\nPlease be careful with a change unless it is broken for regular, spec-compliant use case. If for example we allow numeric parameters *not* to begin with 1 and be monotonic and continuous, nothing stops a user to specific \"SELECT a FROM A a where a.name=?100234 and A.something=?34562\" -- it will get real hairy to support such an innovative user :) \n\nAn informative error message when integral parameters violate *any* of the following\n  a) start with 1\n  b) monotonic\n  c) continuous\nis all that is required to keep life simple, code uncomplicated and majority of user satisfied.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-05-06T22:23:58.248+0000","updated":"2011-05-06T22:23:58.248+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13030396","id":"13030396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"I agree. This is about detection and producing an informative error message. At this time I don't think we can or should support numeric parameters that start at any point. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2011-05-07T19:35:12.897+0000","updated":"2011-05-07T19:35:12.897+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13030733","id":"13030733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"While in theory we could support positional parameters that do not start with 1, or contain gaps I don't think there's a compelling reason to add such support. \n\nWe should not throw an ArrayIndexOutOfBoundsException during query execution though. I've checked in changes that will detect the condition when the query is created and throw a UserException that explains why the query string is bad.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2011-05-09T13:46:28.000+0000","updated":"2011-05-09T13:46:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13032724","id":"13032724","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dblevins","name":"dblevins","key":"dblevins","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Blevins","active":true,"timeZone":"America/Los_Angeles"},"body":"From what I recall from EJB 3.0 when that group still had JPA, is that the intent of \"input parameters are numbered starting from 1\" is to simply say 1 as opposed to 0.  The line that reads \"the same parameter can be used more than once in the query string\", should simply read \"the same parameter can be used zero or more times in the query string\".  That was the intent as far as I recall.\n\nNot even printf requires you to use all your input parameters.  It's ok to skip some, even the first one.  The 'start at 1' is for the input side, not the output side (in this case the query itself)\n\nFor example:\n\n{code}\npublic class PositionalParametersTest extends TestCase {\n\n    public void testPattern() throws Exception {\n\n        final String query = \"SELECT $2 FROM $3 AS $2\";\n\n        final String result = \"one two three four\".replaceFirst(\"(one) (two) (three) (four)\", query);\n\n        assertEquals(\"SELECT two FROM three AS two\", result);\n    }\n\n    public void testFormatter() throws Exception {\n\n        final String query = \"SELECT %2$s FROM %3$s AS %2$s\";\n\n        final String result = String.format(query, \"one\", \"two\", \"three\", \"four\");\n\n        assertEquals(\"SELECT two FROM three AS two\", result);\n    }\n}\n{code}\n\nIt is very very useful to be able to edit any part of a query string while trying to get things right or debugging.  One of those things you don't do because you want to, but because you're trying to get to where you want to go.\n\nBeing able to tweak query strings without recompiling code is a pretty useful thing all on its own.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dblevins","name":"dblevins","key":"dblevins","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Blevins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-05-12T22:36:23.471+0000","updated":"2011-05-12T22:36:23.471+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13032801","id":"13032801","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dblevins","name":"dblevins","key":"dblevins","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Blevins","active":true,"timeZone":"America/Los_Angeles"},"body":"So here's what I got.  Perspective of Linda is that \"attempting to bind a parameter that did not correspond to a parameter in the query is intended to cause an exception.\"  She didn't comment on how strict we should be with the 1 thing.  Certainly the spec says 1 in no uncertain terms.\n\nI ran a test with Hibernate and EclipseLink and both of them will allow this:\n\n    Query query = entityManager.createQuery(\"SELECT m from Movie as m WHERE m.title = ?2 AND m.year = ?4\");\n    query.setParameter(2, \"Foo\");\n    query.setParameter(4, 2011);\n    return query.getResultList();\n\nBoth of them will throw an exception from the setParameter method if the index doesn't exist, but neither cares what numbers you do or don't use beyond that.\n\nSo at this point I would just have to say you're in the clear from a letter of the spec perspective, but in terms of practicality (editing huge queries can take hours and relabeling index continuously just slows you down) and in compatibility with current EclipseLink and Hibernate implementations and past OpenJPA versions, it would be great to at least get a vendor specific flag to turn on/off the strict behavior.\n\nIf we had something that could be set at the unit level, that would be a very big help to us and potentially other users migrating or upgrading.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dblevins","name":"dblevins","key":"dblevins","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Blevins","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-05-13T02:24:08.905+0000","updated":"2011-05-13T02:24:08.905+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506151/comment/13033063","id":"13033063","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"I'd be fine with opening a new improvement to allow this, and if there is sufficient interest we'd look into it. Pinaki's point about the prepared SQL cache is particularly concerning (for me at least). I suspect any changes we make in this area will affect the cache as well. In the current implementation (and probably in previous releases) this sort of query will not work as expected (beyond the ArrayIndex exception). \n\nIt's just my personal opinion, but I think it's unlikely that there will be many queries that use positional parameters and do not already start at one. I suspect most of those are copy / paste jobs from JDBC prepared statements which do start at 1. Those that aren't copied or pasted from existing statements would probably prefer the named parameter support (which is more friendly anyway). I could be all wet here though - and I can see where it would be a real pain if you had to go back and update the positional args. \n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2011-05-13T14:46:32.860+0000","updated":"2011-05-13T14:46:32.860+0000"}],"maxResults":12,"total":12,"startAt":0},"customfield_12311820":"0|i0z0jz:","customfield_12314139":null}}

