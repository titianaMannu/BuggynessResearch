{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12560527","self":"https://issues.apache.org/jira/rest/api/2/issue/12560527","key":"OPENJPA-2212","fields":{"fixVersions":[],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"240154","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.svg","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312969","id":"12312969","description":"","name":"1.0.3","archived":false,"released":true,"releaseDate":"2008-07-23"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[],"customfield_12313825":null,"assignee":null,"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311304","id":"12311304","name":"jpa","description":"Java Persistence API interface"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"3387","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rnj786","name":"rnj786","key":"rnj786","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"RAHEEM JIWANI","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rnj786","name":"rnj786","key":"rnj786","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"RAHEEM JIWANI","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2212/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1017d12c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@18a97aec[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@68df65e3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3b720c0e[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1661018e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2a27b32b[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@39442bf1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@127d42ab[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@c8e5c1b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1ba7184a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3a4a36c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7b34d1a9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2012-06-14T15:54:02.932+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2212/watchers","watchCount":2,"isWatching":false},"created":"2012-06-13T16:24:13.360+0000","updated":"2012-06-14T15:54:03.041+0000","timeoriginalestimate":null,"description":"Looks like this issue is an OpenJPA issue. Very strange thing is the code exception catch block doesn't catch this exception at all and this happens only in stage environment and not in any lower environment. Though QA and Stage have exact same code base and they both get data from same source.\n\nFROM the exception it looks like a duplicate primary key and its trying to insert the same record twice, is it something with flush operation in openjpa ? multithreading ? or something else ? \n\nits definately not data issue, coz it doesn't happen in QA with same data \n\n\n\n00000287 RegisteredSyn E   WTRN0074E: Exception caught from before_completion synchronization operation: <openjpa-1.0.3-SNAPSHOT-r420667:646455 nonfatal general error> org.apache.openjpa.persistence.PersistenceException: ORA-00001: unique constraint (FIS.SYS_C008294) violated\n\nFailedObject: prepstmnt 454695706 INSERT INTO TABLENAME COLUMNS (X,Y,Z ? , ? , ?) [org.apache.openjpa.jdbc.kernel.JDBCStoreManager$CancelPreparedStatement]\n\n[org.apache.openjpa.jdbc.kernel.JDBCStoreManager$CancelPreparedStatement]\n\tat org.apache.openjpa.jdbc.sql.DBDictionary.newStoreException(DBDictionary.java:3949)\n\tat org.apache.openjpa.jdbc.sql.SQLExceptions.getStore(SQLExceptions.java:97)\n\tat org.apache.openjpa.jdbc.sql.SQLExceptions.getStore(SQLExceptions.java:67)\n\tat com.ibm.ws.persistence.jdbc.kernel.PreparedStatementManagerImpl.flush(PreparedStatementManagerImpl.java:170)\n\tat org.apache.openjpa.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:105)\n\tat com.ibm.ws.persistence.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:93)\n\tat com.ibm.ws.persistence.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:75)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush(JDBCStoreManager.java:514)\n\tat org.apache.openjpa.kernel.DelegatingStoreManager.flush(DelegatingStoreManager.java:130)\n\tat org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:1955)\n\tat org.apache.openjpa.kernel.BrokerImpl.flushSafe(BrokerImpl.java:1853)\n\tat org.apache.openjpa.kernel.BrokerImpl.beforeCompletion(BrokerImpl.java:1771)\n\tat com.ibm.ws.uow.ComponentContextSynchronizationWrapper.beforeCompletion(ComponentContextSynchronizationWrapper.java:66)\n\tat com.ibm.ws.Transaction.JTA.RegisteredSyncs.distributeBefore(RegisteredSyncs.java:242)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.prePrepare(TransactionImpl.java:2404)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.stage1CommitProcessing(TransactionImpl.java:1637)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.processCommit(TransactionImpl.java:1608)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.commit(TransactionImpl.java:1543)\n\tat com.ibm.ws.Transaction.JTA.TranManagerImpl.commit(TranManagerImpl.java:240)\n\tat com.ibm.ws.Transaction.JTA.TranManagerSet.commit(TranManagerSet.java:164)\n\tat com.ibm.ejs.csi.TranStrategy.commit(TranStrategy.java:782)\n\tat com.ibm.ejs.csi.TranStrategy.postInvoke(TranStrategy.java:206)\n\tat com.ibm.ejs.csi.TransactionControlImpl.postInvoke(TransactionControlImpl.java:581)\n\tat com.ibm.ejs.container.EJSContainer.postInvoke(EJSContainer.java:4311)\n\tat com.ibm.ejs.container.MessageEndpointHandler.afterDelivery(MessageEndpointHandler.java:1440)\n\tat com.ibm.ejs.container.MessageEndpointHandler.invokeMessageEndpointMethod(MessageEndpointHandler.java:801)\n\tat com.ibm.ejs.container.MessageEndpointHandler.invoke(MessageEndpointHandler.java:762)\n\tat $Proxy54.afterDelivery(Unknown Source)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaTransactionalDispatcher.afterDelivery(SibRaTransactionalDispatcher.java:469)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaDispatcher.dispatch(SibRaDispatcher.java:780)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaSingleProcessListener$SibRaWork.run(SibRaSingleProcessListener.java:584)\n\tat com.ibm.ejs.j2c.work.WorkProxy.run(WorkProxy.java:419)\n\tat com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1473)\nCaused by: com.ibm.websphere.ce.cm.DuplicateKeyException: ORA-00001: unique constraint (FIS.SYS_C008294) violated\n\n\tat sun.reflect.GeneratedConstructorAccessor39.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:522)\n\tat com.ibm.websphere.rsadapter.GenericDataStoreHelper.mapExceptionHelper(GenericDataStoreHelper.java:523)\n\tat com.ibm.websphere.rsadapter.GenericDataStoreHelper.mapException(GenericDataStoreHelper.java:578)\n\tat com.ibm.ws.rsadapter.jdbc.WSJdbcUtil.mapException(WSJdbcUtil.java:909)\n\tat com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.executeUpdate(WSJdbcPreparedStatement.java:626)\n\tat org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:269)\n\tat org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator$LoggingConnection$LoggingPreparedStatement.executeUpdate(LoggingConnectionDecorator.java:856)\n\tat org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:269)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager$CancelPreparedStatement.executeUpdate(JDBCStoreManager.java:1363)\n\tat com.ibm.ws.persistence.jdbc.kernel.PreparedStatementManagerImpl.flush(PreparedStatementManagerImpl.java:112)\n\t... 29 more\nNestedThrowables:\njava.sql.SQLException: ORA-00001: unique constraint (FIS.SYS_C008294) violated\n\n\tat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)\n\tat oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)\n\tat oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)\n\tat oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:743)\n\tat oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:216)\n\tat oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:955)\n\tat oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1168)\n\tat oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3316)\n\tat oracle.jdbc.driver.OraclePreparedStatement.executeUpdate(OraclePreparedStatement.java:3400)\n\tat com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.pmiExecuteUpdate(WSJdbcPreparedStatement.java:948)\n\tat com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.executeUpdate(WSJdbcPreparedStatement.java:615)\n\tat org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:269)\n\tat org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator$LoggingConnection$LoggingPreparedStatement.executeUpdate(LoggingConnectionDecorator.java:856)\n\tat org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:269)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager$CancelPreparedStatement.executeUpdate(JDBCStoreManager.java:1363)\n\tat com.ibm.ws.persistence.jdbc.kernel.PreparedStatementManagerImpl.flush(PreparedStatementManagerImpl.java:112)\n\tat org.apache.openjpa.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:105)\n\tat com.ibm.ws.persistence.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:93)\n\tat com.ibm.ws.persistence.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:75)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush(JDBCStoreManager.java:514)\n\tat org.apache.openjpa.kernel.DelegatingStoreManager.flush(DelegatingStoreManager.java:130)\n\tat org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:1955)\n\tat org.apache.openjpa.kernel.BrokerImpl.flushSafe(BrokerImpl.java:1853)\n\tat org.apache.openjpa.kernel.BrokerImpl.beforeCompletion(BrokerImpl.java:1771)\n\tat com.ibm.ws.uow.ComponentContextSynchronizationWrapper.beforeCompletion(ComponentContextSynchronizationWrapper.java:66)\n\tat com.ibm.ws.Transaction.JTA.RegisteredSyncs.distributeBefore(RegisteredSyncs.java:242)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.prePrepare(TransactionImpl.java:2404)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.stage1CommitProcessing(TransactionImpl.java:1637)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.processCommit(TransactionImpl.java:1608)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.commit(TransactionImpl.java:1543)\n\tat com.ibm.ws.Transaction.JTA.TranManagerImpl.commit(TranManagerImpl.java:240)\n\tat com.ibm.ws.Transaction.JTA.TranManagerSet.commit(TranManagerSet.java:164)\n\tat com.ibm.ejs.csi.TranStrategy.commit(TranStrategy.java:782)\n\tat com.ibm.ejs.csi.TranStrategy.postInvoke(TranStrategy.java:206)\n\tat com.ibm.ejs.csi.TransactionControlImpl.postInvoke(TransactionControlImpl.java:581)\n\tat com.ibm.ejs.container.EJSContainer.postInvoke(EJSContainer.java:4311)\n\tat com.ibm.ejs.container.MessageEndpointHandler.afterDelivery(MessageEndpointHandler.java:1440)\n\tat com.ibm.ejs.container.MessageEndpointHandler.invokeMessageEndpointMethod(MessageEndpointHandler.java:801)\n\tat com.ibm.ejs.container.MessageEndpointHandler.invoke(MessageEndpointHandler.java:762)\n\tat $Proxy54.afterDelivery(Unknown Source)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaTransactionalDispatcher.afterDelivery(SibRaTransactionalDispatcher.java:469)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaDispatcher.dispatch(SibRaDispatcher.java:780)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaSingleProcessListener$SibRaWork.run(SibRaSingleProcessListener.java:584)\n\tat com.ibm.ejs.j2c.work.WorkProxy.run(WorkProxy.java:419)\n\tat com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1473)\n---- Begin backtrace for Nested Throwables\njava.sql.SQLException: ORA-00001: unique constraint (FIS.SYS_C008294) violated\n\n\tat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)\n\tat oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)\n\tat oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)\n\tat oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:743)\n\tat oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:216)\n\tat oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:955)\n\tat oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1168)\n\tat oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3316)\n\tat oracle.jdbc.driver.OraclePreparedStatement.executeUpdate(OraclePreparedStatement.java:3400)\n\tat com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.pmiExecuteUpdate(WSJdbcPreparedStatement.java:948)\n\tat com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.executeUpdate(WSJdbcPreparedStatement.java:615)\n\tat org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:269)\n\tat org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator$LoggingConnection$LoggingPreparedStatement.executeUpdate(LoggingConnectionDecorator.java:856)\n\tat org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:269)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager$CancelPreparedStatement.executeUpdate(JDBCStoreManager.java:1363)\n\tat com.ibm.ws.persistence.jdbc.kernel.PreparedStatementManagerImpl.flush(PreparedStatementManagerImpl.java:112)\n\tat org.apache.openjpa.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:105)\n\tat com.ibm.ws.persistence.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:93)\n\tat com.ibm.ws.persistence.jdbc.kernel.OperationOrderUpdateManager.flush(OperationOrderUpdateManager.java:75)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush(JDBCStoreManager.java:514)\n\tat org.apache.openjpa.kernel.DelegatingStoreManager.flush(DelegatingStoreManager.java:130)\n\tat org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:1955)\n\tat org.apache.openjpa.kernel.BrokerImpl.flushSafe(BrokerImpl.java:1853)\n\tat org.apache.openjpa.kernel.BrokerImpl.beforeCompletion(BrokerImpl.java:1771)\n\tat com.ibm.ws.uow.ComponentContextSynchronizationWrapper.beforeCompletion(ComponentContextSynchronizationWrapper.java:66)\n\tat com.ibm.ws.Transaction.JTA.RegisteredSyncs.distributeBefore(RegisteredSyncs.java:242)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.prePrepare(TransactionImpl.java:2404)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.stage1CommitProcessing(TransactionImpl.java:1637)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.processCommit(TransactionImpl.java:1608)\n\tat com.ibm.ws.Transaction.JTA.TransactionImpl.commit(TransactionImpl.java:1543)\n\tat com.ibm.ws.Transaction.JTA.TranManagerImpl.commit(TranManagerImpl.java:240)\n\tat com.ibm.ws.Transaction.JTA.TranManagerSet.commit(TranManagerSet.java:164)\n\tat com.ibm.ejs.csi.TranStrategy.commit(TranStrategy.java:782)\n\tat com.ibm.ejs.csi.TranStrategy.postInvoke(TranStrategy.java:206)\n\tat com.ibm.ejs.csi.TransactionControlImpl.postInvoke(TransactionControlImpl.java:581)\n\tat com.ibm.ejs.container.EJSContainer.postInvoke(EJSContainer.java:4311)\n\tat com.ibm.ejs.container.MessageEndpointHandler.afterDelivery(MessageEndpointHandler.java:1440)\n\tat com.ibm.ejs.container.MessageEndpointHandler.invokeMessageEndpointMethod(MessageEndpointHandler.java:801)\n\tat com.ibm.ejs.container.MessageEndpointHandler.invoke(MessageEndpointHandler.java:762)\n\tat $Proxy54.afterDelivery(Unknown Source)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaTransactionalDispatcher.afterDelivery(SibRaTransactionalDispatcher.java:469)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaDispatcher.dispatch(SibRaDispatcher.java:780)\n\tat com.ibm.ws.sib.ra.inbound.impl.SibRaSingleProcessListener$SibRaWork.run(SibRaSingleProcessListener.java:584)\n\tat com.ibm.ejs.j2c.work.WorkProxy.run(WorkProxy.java:419)\n\tat com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1473)\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"Exception caught from before_completion synchronization operation","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"Stage and Prod","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560527/comment/13294566","id":"13294566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"body":">>> Very strange thing is the code exception catch block doesn't catch this exception at all and this happens only in stage environment and not in any lower environment. \n\nI assume the exception you mentioned is \"java.sql.SQLException: ORA-00001: unique constraint (FIS.SYS_C008294) violated\"\n\nWhat catch block are you referring?  Some openjpa code try/catch ? Or application try/catch?\n\nWhat do you mean by \"lower environment\"? Unit test environment?\n\nFrom the stack, it indicates you are running WebSphere, using EJB calling out to JPA function.  The JPA appl uses \"operation order\" update manager access data in Oracle DB. Based on this info, the operation order update manager will honor the exact order of JPA requests from the business logics. If there is any constraint violation imposed by the database, the applications needs to be aware of the configuration. \n\nTo diagnose the problem, you may want to enable SQL=TRACE to see the SQL statements being submitted to the database and examinate what is the cause of the constraint violation.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2012-06-13T17:13:08.424+0000","updated":"2012-06-13T17:13:08.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560527/comment/13295122","id":"13295122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rnj786","name":"rnj786","key":"rnj786","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"RAHEEM JIWANI","active":true,"timeZone":"Etc/UTC"},"body":"Thanks Albert !!\n\n                    In the lower Environments (QA and Dev) SQL = TRACE wasn't set and so the logs were not showing the exceptions... turned it on and was able to reproduce the issue and fixed ! Thanks for the suggestion. It was a Duplicate Key Exception caused by duplicate data insertion instead of update.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rnj786","name":"rnj786","key":"rnj786","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"RAHEEM JIWANI","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-14T15:53:19.013+0000","updated":"2012-06-14T15:53:19.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560527/comment/13295124","id":"13295124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rnj786","name":"rnj786","key":"rnj786","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"RAHEEM JIWANI","active":true,"timeZone":"Etc/UTC"},"body":"Reproduced and Fixed ... Was a duplicate data insertion issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rnj786","name":"rnj786","key":"rnj786","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"RAHEEM JIWANI","active":true,"timeZone":"Etc/UTC"},"created":"2012-06-14T15:54:02.992+0000","updated":"2012-06-14T15:54:02.992+0000"}],"maxResults":3,"total":3,"startAt":0},"customfield_12311820":"0|i00xo7:","customfield_12314139":null}}

