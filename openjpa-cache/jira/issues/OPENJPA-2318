{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12626144","self":"https://issues.apache.org/jira/rest/api/2/issue/12626144","key":"OPENJPA-2318","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323484","id":"12323484","description":"OpenJPA 2.2.1.x Maintenance Release","name":"2.2.1.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324305","id":"12324305","description":"OpenJPA 2.2.x Maintenance Release","name":"2.2.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12319463","id":"12319463","description":"OpenJPA 2.3.0","name":"2.3.0","archived":false,"released":true,"releaseDate":"2013-11-24"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"302727","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316191","id":"12316191","description":"OpenJPA 2.1.x maintenance release","name":"2.1.1","archived":false,"released":true,"releaseDate":"2011-07-25"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[{"id":"12369027","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12369027","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12626127","key":"OPENJPA-2317","self":"https://issues.apache.org/jira/rest/api/2/issue/12626127","fields":{"summary":"Criteria API doesn' generate LEFT OUTER JOIN in subquery as expected","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12316305","id":"12316305","name":"criteria","description":"Issues relating to the JPA Criteria API and usage, as well as the associted MetaModel API and AnnotationProcessor."}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"249777","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=levtse","name":"levtse","key":"levtse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lev","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=levtse","name":"levtse","key":"levtse","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lev","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2318/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@238a1829[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@136669ae[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@15381be6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@35b33bf6[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@724f0fec[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@14cb979e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@417959ca[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6db9b698[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6783f4ac[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2fbcf8a5[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@24805391[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4ad2cef[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2013-08-16T18:26:15.515+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2318/watchers","watchCount":4,"isWatching":false},"created":"2013-01-05T00:50:14.540+0000","updated":"2015-06-06T21:19:27.250+0000","timeoriginalestimate":null,"description":"Entities\n@Entity\n@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)\npublic class DiscoveryObjectImpl {\n\t@Id\n\tprivate String id;\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n\t@ManyToOne(cascade = CascadeType.ALL)\n\tprivate DiscoveryObjectImpl parent;\n\t\n\n\tpublic DiscoveryObjectImpl getParent() {\t\t\n\t\treturn parent;\n\t}\n\n\tpublic void setParent(DiscoveryObjectImpl parent) {\n\t\tthis.parent = parent;  \n\n\t}\n}\n\n@Entity\npublic class ColumnFormatImpl extends DiscoveryObjectImpl {\n\t@Basic\n\tString formatName; \n}\n\n@Entity\npublic class ColumnImpl extends DiscoveryObjectImpl {\n@OneToMany(mappedBy=\"parent\")\nprivate List<ColumnFormatImpl> formats = new ArrayList<ColumnFormatImpl>();\n\n}\n\n@Entity\npublic class VirtualTableImpl extends DiscoveryObjectImpl {\n@OneToMany(mappedBy=\"parent\")\n\tprivate List<ColumnImpl> columns = new ArrayList<ColumnImpl>();\n}\n\npersistence.xml\n<persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\"\n    version=\"1.0\">\n <persistence-unit name=\"Test\" transaction-type=\"RESOURCE_LOCAL\">\n \t<provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>\n \t<class>com.ibm.infosphere.test.featureSelection.interfaces.impl.DiscoveryObjectImpl</class>\n \t<class>com.ibm.infosphere.test.featureSelection.interfaces.impl.VirtualTableImpl</class>\n \t<class>com.ibm.infosphere.test.featureSelection.interfaces.impl.ColumnImpl</class>\n \t<class>com.ibm.infosphere.test.featureSelection.interfaces.impl.ColumnFormatImpl</class> \t\n \t<exclude-unlisted-classes>true</exclude-unlisted-classes> \t\t\t\n\t<properties>\n\t\t\t<property name=\"openjpa.Log\" value=\"DefaultLevel=ERROR, Runtime=ERROR, Tool=ERROR, SQL=TRACE, MetaData=ERROR\"/>\n\t\t\t<property name=\"openjpa.DynamicEnhancementAgent\"  value=\"false\"/>\n            <property name=\"openjpa.RuntimeUnenhancedClasses\" value=\"supported\"/>\n            <property name=\"openjpa.jdbc.SynchronizeMappings\" value=\"buildSchema(ForeignKeys=true)\"/>\n            <property name=\"openjpa.InitializeEagerly\" value=\"true\"/>\n            <property name=\"openjpa.jdbc.DBDictionary\" value=\"oracle\"/>\n            <property name=\"openjpa.jdbc.DBDictionary\" value=\"MaxTableNameLength=61\"/>\n            <property name=\"openjpa.jdbc.DBDictionary\" value=\"useWildCardForCount=true\"/>\n            <property name=\"openjpa.jdbc.DBDictionary\" value=\"JoinSyntax=sql92\"/>\n \t\t\t<property name=\"openjpa.ConnectionURL\" value=\"jdbc:oracle:thin:@localhost:1521:orcl\"/>\n\t\t\t \n    \t\t<property name=\"openjpa.ConnectionDriverName\" value=\"oracle.jdbc.driver.OracleDriver\"/> \n      \t\t<property name=\"openjpa.ConnectionUserName\" value=\"lev\"/>\n      \t\t<property name=\"openjpa.ConnectionPassword\" value=\"lev\"/>\n\n            <property name=\"openjpa.ConnectionFactoryProperties\"    value=\"PrettyPrint=true, PrettyPrintLineLength=80, PrintParameters=true\"/>\n            <property name=\"openjpa.DataCache\"                value=\"true\"/>        \n            <property name=\"openjpa.RemoteCommitProvider\"     value=\"sjvm\"/>            \n            <property name=\"openjpa.jdbc.QuerySQLCache\"       value=\"true(EnableStatistics=true)\"/>            \n\t\t</properties>\n</persistence-unit>\n</persistence>\n\nTest code:\npublic void test() {\n        CriteriaQuery<ColumnImpl> cri = cb.createQuery(ColumnImpl.class);\n        Root<VirtualTableImpl> tbl = cri.from(VirtualTableImpl.class);\n        Join<VirtualTableImpl, ColumnImpl> col = tbl.join(\"columns\");\n        Join<ColumnImpl, ColumnFormatImpl> format = col.join(\"formats\", JoinType.LEFT);\n        cri.where(cb.equal(format.get(\"formatName\"), \"ABC\"));\n        cri.select(col);\n        em.createQuery(cri).getResultList();\n}\n\nGenerated SQL:\nSELECT t1.id, t1.PARENT_ID \n    FROM VirtualTableImpl t0 INNER JOIN ColumnImpl t1 ON t0.id = t1.PARENT_ID INNER \n        JOIN ColumnFormatImpl t2 ON t1.id = t2.PARENT_ID \n    WHERE (t2.formatName = ? AND 1 = 1) \n\nAs you can see the secong JOIN is INNER instead of LEFT OUTER\n\n        ","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12598474","id":"12598474","filename":"OPENJPA-2318.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wizman","name":"wizman","key":"wizman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben","active":true,"timeZone":"Europe/Paris"},"created":"2013-08-16T14:36:43.751+0000","size":3520,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12598474/OPENJPA-2318.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12598475","id":"12598475","filename":"OPENJPA-2318-TEST.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wizman","name":"wizman","key":"wizman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben","active":true,"timeZone":"Europe/Paris"},"created":"2013-08-16T14:36:43.754+0000","size":4875,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12598475/OPENJPA-2318-TEST.patch"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"Left outer join is not generated when specifien using Criteria API","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"Windows/Oracle","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13658240","id":"13658240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"I'm having exacly the same issue. When printing the internally generated \"JPQL\" using (OpenJPACriteriaQuery) q).toCQL() it does show a LEFT JOIN, but the actual generated SQL has an inner join.\nThe manually written equivalent JPQL does generate SQL with \"LEFT OUTER JOIN\".\n\nThe problem does not happen when the query has only one join.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-15T10:56:29.322+0000","updated":"2013-05-15T10:56:29.322+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13658248","id":"13658248","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"Not 100% sure but this may have to do with inheritance.\n\nMy structure is like Order 1..* OrderLine 1..1 Product *..1 Category. Category is optional so when I select from Order I (should) get inner joins followed by a left join.\nMy Order class extends from another abstract entity class using TABLE_PER_CLASS.\nWhen I leave out Order and select from OrderLine I do get an inner join followed by a left outer join.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-15T11:09:47.826+0000","updated":"2013-05-15T11:09:47.826+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13658255","id":"13658255","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"Same issue when leaving out Category and making OrderLine 1 .. 1 Product optional (= 3 tables, 2 joins just like the example of this issue).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-15T11:30:05.251+0000","updated":"2013-05-15T11:30:05.251+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13658265","id":"13658265","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"I reproduced the problem for another query with 3 entities that have no superclasses (except for @MappedSuperclass). I select from an inner join followed by a left join and get the exact same issue. (A 1..* B *..1 C)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-15T11:48:36.622+0000","updated":"2013-05-15T11:48:36.622+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13658292","id":"13658292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"I created an (almost) official OpenJPA test case that reproduces the issue.\nI took the CriteriaTest TestJPQLSubquery.testSubqueries6 as a starting point to create the test. It reuses the existing structure\n\nCustomer 1..* accounts 1..1 owner\n\n    public void testLeftJoinAfterInnerJoin() {\n        String jpql = \"SELECT c FROM Customer c INNER JOIN c.accounts a LEFT JOIN a.owner o\";\n        String expectedSQL = \"SELECT t0.id, t0.accountNum, t4.id, t4.city, t4.country, t4.county, t4.state, \" +\n        \t\t\"t4.street, t5.userid, t5.DTYPE, t5.age, t5.compName, t5.creditRating, t5.name, t4.zipCode, \" +\n        \t\t\"t0.balanceOwed, t0.creditRating, t0.filledOrderCount, t0.firstName, t0.lastName, t0.name, t0.status \" +\n        \t\t\"FROM CR_CUST t0 \" +\n        \t\t\"INNER JOIN CR_CUST_CR_ACCT t1 ON t0.id = t1.CUSTOMER_ID \" +\n        \t\t\"LEFT OUTER JOIN CR_ADDR t4 ON t0.ADDRESS_ID = t4.id \" +\n        \t\t\"INNER JOIN CR_ACCT t2 ON t1.ACCOUNTS_ID = t2.id \" +\n        \t\t\"LEFT OUTER JOIN CompUser t5 ON t4.id = t5.ADD_ID \" +\n        \t\t\"LEFT OUTER JOIN CR_PSN t3 ON t2.OWNER_ID = t3.id\";\n\n        executeAndCompareSQL(jpql, expectedSQL);\n        \n        CriteriaQuery<Customer> q = cb.createQuery(Customer.class);\n        Root<Customer> c = q.from(Customer.class);\n        Join<Customer,Account> a = c.join(Customer_.accounts);\n        Join<Account, Person> o = a.join(Account_.owner, JoinType.LEFT);\n        q.select(c);\n        \n        assertEquivalence(q, jpql);\n    }\n\nSimply copy/paste into TestJPQLSubquery and run.\nYou will get a nice assertion error that compares the SQL for the JPQL query with the SQL for the Criteria query and you can see that only the last part of the query differs. JPQL has \"LEFT OUTER JOIN\" while Criteria has \"INNER JOIN\".\n\nCan an OpenJPA committer look into this? I think I have now done the necessary work I can do to pinpoint the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-15T12:18:45.678+0000","updated":"2013-05-15T12:18:45.678+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13658316","id":"13658316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"body":"I found the cause of the problem!\n\nBy simply following the call chain of join I found that this test can be made to pass by changing line 210 of org.apache.openjpa.persistence.criteria.Joins from\n\npath.get(_member.fmd, false);\n\nto\n\npath.get(_member.fmd, allowNull);\n\nThis is the code that translates the join into an openJPA kernal expression and somehow fills in false for allowNull while it should be true according to\nallowNull = joinType != JoinType.INNER\n\nThere is also another call to path.get using the literal value of false.\n\nI believe an OpenJPA committer should be able to quickly fix this issue now. (Note that I have no clue of the consequences of this change, perhaps the literal value of false was deliberate and perhaps it breaks other tests.)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slowstrider","name":"slowstrider","key":"slowstrider","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vermeulen","active":true,"timeZone":"Europe/Berlin"},"created":"2013-05-15T12:43:20.699+0000","updated":"2013-05-15T12:43:20.699+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13742268","id":"13742268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wizman","name":"wizman","key":"wizman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben","active":true,"timeZone":"Europe/Paris"},"body":"Fix for OPENJPA-2318","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=wizman","name":"wizman","key":"wizman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben","active":true,"timeZone":"Europe/Paris"},"created":"2013-08-16T14:36:43.757+0000","updated":"2013-08-16T14:36:43.757+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13742495","id":"13742495","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1514833 from [~ppoddar@apache.org] in branch 'openjpa/trunk'\n[ https://svn.apache.org/r1514833 ]\n\nOPENJPA-2318: Left outer join is not generated because allowNull was not passed correctly","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2013-08-16T18:25:24.292+0000","updated":"2013-08-16T18:25:24.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13840334","id":"13840334","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1548222 from [~fyrewyld] in branch 'openjpa/branches/2.2.1.x'\n[ https://svn.apache.org/r1548222 ]\n\nOPENJPA-2318: Left outer join is not generated when specified using Criteria API","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-05T17:52:01.824+0000","updated":"2013-12-05T17:52:01.824+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12626144/comment/13840400","id":"13840400","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1548238 from [~fyrewyld] in branch 'openjpa/branches/2.2.x'\n[ https://svn.apache.org/r1548238 ]\n\nOPENJPA-2318: Left outer join is not generated when specified using Criteria API","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2013-12-05T18:49:16.464+0000","updated":"2013-12-05T18:49:16.464+0000"}],"maxResults":10,"total":10,"startAt":0},"customfield_12311820":"0|i174zr:","customfield_12314139":null}}

