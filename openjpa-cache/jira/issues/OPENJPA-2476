{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12693951","self":"https://issues.apache.org/jira/rest/api/2/issue/12693951","key":"OPENJPA-2476","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317142","id":"12317142","description":"","name":"2.1.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323484","id":"12323484","description":"OpenJPA 2.2.1.x Maintenance Release","name":"2.2.1.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324305","id":"12324305","description":"OpenJPA 2.2.x Maintenance Release","name":"2.2.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325298","id":"12325298","description":"OpenJPA 2.4.0","name":"2.4.0","archived":false,"released":true,"releaseDate":"2015-04-22"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"372460","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314542","id":"12314542","description":"","name":"2.1.0","archived":false,"released":true,"releaseDate":"2011-02-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315910","id":"12315910","description":"OpenJPA 2.2.0 Release","name":"2.2.0","archived":false,"released":true,"releaseDate":"2012-02-20"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323484","id":"12323484","description":"OpenJPA 2.2.1.x Maintenance Release","name":"2.2.1.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12319463","id":"12319463","description":"OpenJPA 2.3.0","name":"2.3.0","archived":false,"released":true,"releaseDate":"2013-11-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325298","id":"12325298","description":"OpenJPA 2.4.0","name":"2.4.0","archived":false,"released":true,"releaseDate":"2015-04-22"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[{"id":"12404677","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12404677","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12765122","key":"OPENJPA-2555","self":"https://issues.apache.org/jira/rest/api/2/issue/12765122","fields":{"summary":"Timestamp precision from manual schema not respected","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311300","id":"12311300","name":"jdbc","description":"jdbc interface"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"372764","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2476/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@23bc603c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3c454a55[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2a5f8c31[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3c5e7ccd[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7c63948c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@358abad[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@55b091f3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1ac7279c[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a6017bc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3ca3de9e[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6dcdfff0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4e15de12[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2014-05-05T17:56:40.275+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2476/watchers","watchCount":3,"isWatching":false},"created":"2014-02-07T17:58:42.524+0000","updated":"2019-03-07T06:39:40.969+0000","timeoriginalestimate":null,"description":"HI!  I'm hitting a rather interesting issue and unfortunately to describe it is going to be a bit lengthy......so settle in.  :)  Here is the exception:\n\n<openjpa-2.1.2-SNAPSHOT-r422266:1548248 fatal store error> org.apache.openjpa.persistence.RollbackException: Optimistic locking errors were detected when flushing to the data store.  The following objects may have been concurrently modified in another transaction: [hat.entities.VersionTSEntity-1390400526251]\n\tat org.apache.openjpa.persistence.EntityManagerImpl.commit(EntityManagerImpl.java:593)\n\tat hat.tests.PMR57956Test.testupdate(PMR57956Test.java:94)\n........\nCaused by: <openjpa-2.1.2-SNAPSHOT-r422266:1548248 nonfatal store error> org.apache.openjpa.persistence.OptimisticLockException: Optimistic locking errors were detected when flushing to the data store.  The following objects may have been concurrently modified in another transaction: [hat.entities.VersionTSEntity-1390400526251]\n\tat org.apache.openjpa.kernel.BrokerImpl.newFlushException(BrokerImpl.java:2310)\n\tat org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:2158)\n\tat org.apache.openjpa.kernel.BrokerImpl.flushSafe(BrokerImpl.java:2056)\n\tat org.apache.openjpa.kernel.BrokerImpl.beforeCompletion(BrokerImpl.java:1974)\n\tat org.apache.openjpa.kernel.LocalManagedRuntime.commit(LocalManagedRuntime.java:81)\n\tat org.apache.openjpa.kernel.BrokerImpl.commit(BrokerImpl.java:1498)\n\tat org.apache.openjpa.kernel.DelegatingBroker.commit(DelegatingBroker.java:933)\n\tat org.apache.openjpa.persistence.EntityManagerImpl.commit(EntityManagerImpl.java:569)\n\t... 21 more\nCaused by: <openjpa-2.1.2-SNAPSHOT-r422266:1548248 nonfatal store error> org.apache.openjpa.persistence.OptimisticLockException: An optimistic lock violation was detected when flushing object instance \"hat.entities.VersionTSEntity-1390400526251\" to the data store.  This indicates that the object was concurrently modified in another transaction.\nFailedObject: hat.entities.VersionTSEntity-1390400526251\n\tat org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.populateRowManager(AbstractUpdateManager.java:183)\n\tat org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.flush(AbstractUpdateManager.java:97)\n\tat org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.flush(AbstractUpdateManager.java:78)\n\tat org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush(JDBCStoreManager.java:742)\n\tat org.apache.openjpa.kernel.DelegatingStoreManager.flush(DelegatingStoreManager.java:131)\n\t... 28 more\n\n\nTo see how this occurs, lets look at the test.  Here is the entity:\n\n@Entity\npublic class VersionTSEntity implements Serializable {\n    @Id\n    private Long id;\n    \n    @Version\n    private Timestamp updateTimestamp;\n\n    private Integer someInt;\n\n\nAnd here is my test, with pertinent in-line comments:\n\n//This loop is necessary since we need a timestamp which has been //rounded up by either OJ, or the database....usually 1 or 2 loops will cause //the exception.\n        for (int i = 0; i < 1000; i++) {\n\n            // Find an existing VersionTSEntity:\n            VersionTSEntity t = em.find(VersionTSEntity.class, id);\n\n            tx.begin();\n            // Update/dirty VersionTSEntity:   \n            t.setSomeInt(t.getSomeInt() + 1);\n            t = em.merge(t);\n\n            tx.commit();\n            //If this clear is removed the test works fine.\n            em.clear();\n\n// Lets say at this point the 'in-memory' timestamp is: \n// 2014-01-22 07:22:11.548778567.  What we actually sent to the DB (via \n// the previous merge) is by default rounded (see \n// DBDictionary.setTimestamp) to the nearest millisecond on Oracle (see \n// DBDictionary.datePrecision) and nearest microsecond on DB2 (see \n// DB2Dictionary.datePrecision) when sending the value to the db.\n// Therefore, what we actually send to the db is: \n// 2014-01-22 07:22:11.548779 (for DB2) or 2014-01-22 07:22:11.549 (for \n// Oracle).  \n// Notice in either case we rounded up...keep this in mind as it will be \n// important for the remainder of the test......\n\n            // now, do a merge with the unchanged entity\n            tx = em.getTransaction();\n            tx.begin();\n\n            t = em.merge(t); \n            \n            //This 'fixes' the issue:\n            //em.refresh(t);\n            \n// Here is where things get interesting.....an error will happen here when \n// the timestamp has been rounded up, as I'll explain:\n// As part of this merge/commit, we select the timestamp from the db to get \n// its value (see method checkVersion below), i.e: \n// 'SELECT t0.updateTimestamp FROM VersionTSEntity t0 WHERE \n//     t0.id = ?'.  \n// We then compare the 'in-memory' timestamp to that which we got back \n// from the DB, i.e. on DB2 we compare:\n// in-mem:  2014-01-22 07:22:11.548778567\n// from db: 2014-01-22 07:22:11.548779\n// Because these do not 'compare' properly (the db version is greater), we \n// throw the OptimisticLockEx!!\n// For completeness, lets look at an example where the timestamp is as \n// follows after the above update: 2014-01-22 07:22:11.548771234.  We \n// would send to DB2 the following value: 2014-01-22 07:22:11.548771.  \n// Then, as part of the very last merge/commit, we'd compare:\n// in-mem:  2014-01-22 07:22:11.548771234\n// from db: 2014-01-22 07:22:11.548771\n// These two would 'compare' properly (the db version is lesser), as such \n// we would not throw an OptLockEx and the test works fine.\n   \n         tx.commit();\n\n\nTo see where/why the OptLockEx is thrown, we need to look here in VersionColumnStrategy (see //HAT:):\n\npublic boolean checkVersion(OpenJPAStateManager sm, JDBCStore store,\n        boolean updateVersion)  throws SQLException {\n        Column[] cols = vers.getColumns();\n        Select sel = store.getSQLFactory().newSelect();\n        sel.select(cols);\n        sel.wherePrimaryKey(sm.getObjectId(), vers.getClassMapping(), \n                                            store);\n\n        // No need to lock version field (i.e. optimistic), except when version update is required (e.g. refresh) \n        JDBCFetchConfiguration fetch = store.getFetchConfiguration();\n        if (!updateVersion && fetch.getReadLockLevel() >= MixedLockLevels.LOCK_PESSIMISTIC_READ) {\n            fetch = (JDBCFetchConfiguration) fetch.clone();\n            fetch.setReadLockLevel(MixedLockLevels.LOCK_NONE);\n        }\n        Result res = sel.execute(store, fetch);\n        try {\n            if (!res.next())\n                return false;\n\n            //HAT: here is where we get the timestamp from the db, and 'compare' them:\n            Object memVersion = sm.getVersion();\n            Object dbVersion  = populateFromResult(res, null);\n            \n            boolean refresh   = compare(memVersion, dbVersion) < 0;\n\n            if (updateVersion)\n                sm.setVersion(dbVersion);\n            return !refresh;\n        } finally {\n            res.close();\n        }\n    }\n\n\n\nKeep in mind here that it seems like the scenario is a bit unique....in other words, if I remove the 'em.clear', we do not deem it necessary to call the 'checkVersion' method (thus we don't go back to the DB to get the timestamp).  So it seems that there are two unique things causing us to hit the issue: 1) merge/clear/merge which causes a 'checkVersion', 2) rounding of timestamps.  I added the 'clear' in my test because it is at this point the customer returns the entity to the caller of an EJB....the caller then sends the entity back to the EJB to merge it.....\n\nNow, there are two existing fixes to this issue on DB2, and one fix for this on Oracle.  As you can see in my test above, if we 'em.refresh' the entity before commit, the in-memory value will match that of the db value.  This fix works regardless of whether or not DB2 or Oracle is used (the customer doesn't really like this idea though).  The next fix, which only works on DB2, is to set DBDictionary.datePrecision=1 (nanosecond precision).  This still doesn't resolve the issue on Oracle.  To see why this is the case, we have to look at the way DB2 and Oracle appear to handle timestamp precision.  Both seem to use microsecond precision by default (for both I think you have the option to go up to nanosecond).  Where they differ is that for precision greater than microsecond, DB2 truncates (no rounding) to a microsec.  However, Oracle rounds to the microsec.  So, lets take the value 2014-01-22 07:22:11.548778567.  If datePrecision=1 we'd send to the DB 2014-01-22 07:22:11.548778567.  On DB2, it would truncate the value to 2014-01-22 07:22:11.548778, but on Oracle, it would round to: 2014-01-22 07:22:11.548779.  So, for DB2, the compare would be:\nin-mem:  2014-01-22 07:22:11.548778567\nfrom db: 2014-01-22 07:22:11.548778\n\nThis compare passes, so all is well.  For Oracle, we'd compare:\nin-mem:  2014-01-22 07:22:11.548778567\nfrom db: 2014-01-22 07:22:11.548779\n\nThis compare fails, thus the OptLockEx.  I think setting datePrecision=1 is a fair recommendation/fix for DB2 (others?)......but for Oracle (others?) a fix is needed.  My plan is to provide a fix which rounds the in-memory version of the timestamp to the value set in DBDictionary.datePrecision.  So the exception can still occur if a user has not set datePrecision to match the precision of the Timestamp defined in the database.\n\nThanks,\n\nHeath Thomann","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"OptimisticLockEx due to rounding of a Timestamp (either by OJ, or the DB)","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/13986302","id":"13986302","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1591536 from [~jpaheath] in branch 'openjpa/branches/2.1.x'\n[ https://svn.apache.org/r1591536 ]\n\nOPENJPA-2476: Fixed OptimisticLockEx due to rounding of a Timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-01T02:34:17.096+0000","updated":"2014-05-01T02:34:17.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/13986311","id":"13986311","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1591538 from [~jpaheath] in branch 'openjpa/branches/2.2.1.x'\n[ https://svn.apache.org/r1591538 ]\n\nOPENJPA-2476: Fixed OptimisticLockEx due to rounding of a Timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-01T02:55:27.855+0000","updated":"2014-05-01T02:55:27.855+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/13986314","id":"13986314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1591539 from [~jpaheath] in branch 'openjpa/branches/2.2.x'\n[ https://svn.apache.org/r1591539 ]\n\nOPENJPA-2476: Fixed OptimisticLockEx due to rounding of a Timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-01T03:06:08.132+0000","updated":"2014-05-01T03:06:08.132+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/13986318","id":"13986318","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1591540 from [~jpaheath] in branch 'openjpa/branches/2.3.x'\n[ https://svn.apache.org/r1591540 ]\n\nOPENJPA-2476: Fixed OptimisticLockEx due to rounding of a Timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-01T03:10:57.711+0000","updated":"2014-05-01T03:10:57.711+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/13986322","id":"13986322","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1591541 from [~jpaheath] in branch 'openjpa/trunk'\n[ https://svn.apache.org/r1591541 ]\n\nOPENJPA-2476: Fixed OptimisticLockEx due to rounding of a Timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-01T03:24:12.521+0000","updated":"2014-05-01T03:24:12.521+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/14000164","id":"14000164","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1595313 from [~fyrewyld] in branch 'openjpa/branches/2.2.x'\n[ https://svn.apache.org/r1595313 ]\n\nOPENJPA-2476: Fixed OptimisticLockEx due to rounding of a Timestamp","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-16T19:12:46.608+0000","updated":"2014-05-16T19:12:46.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12693951/comment/16786450","id":"16786450","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dcam","name":"dcam","key":"dcam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Campbell","active":true,"timeZone":"Etc/UTC"},"body":"Is this problem also able to occur if you have a Timestamp in the DB and a java.util.Date to represent it instead of java.sql.Timestamp?Â  java.sql.Timestamp is a thin layer over java.util.Date.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dcam","name":"dcam","key":"dcam","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Campbell","active":true,"timeZone":"Etc/UTC"},"created":"2019-03-07T06:39:40.969+0000","updated":"2019-03-07T06:39:40.969+0000"}],"maxResults":7,"total":7,"startAt":0},"customfield_12311820":"0|i1s6t3:","customfield_12314139":null}}

