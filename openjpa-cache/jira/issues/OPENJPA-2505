{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12714792","self":"https://issues.apache.org/jira/rest/api/2/issue/12714792","key":"OPENJPA-2505","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324305","id":"12324305","description":"OpenJPA 2.2.x Maintenance Release","name":"2.2.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325298","id":"12325298","description":"OpenJPA 2.4.0","name":"2.4.0","archived":false,"released":true,"releaseDate":"2015-04-22"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"393105","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314542","id":"12314542","description":"","name":"2.1.0","archived":false,"released":true,"releaseDate":"2011-02-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323356","id":"12323356","description":"OpenJPA 2.2.2 Release","name":"2.2.2","archived":false,"released":true,"releaseDate":"2013-04-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12319463","id":"12319463","description":"OpenJPA 2.3.0","name":"2.3.0","archived":false,"released":true,"releaseDate":"2013-11-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325298","id":"12325298","description":"OpenJPA 2.4.0","name":"2.4.0","archived":false,"released":true,"releaseDate":"2015-04-22"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311304","id":"12311304","name":"jpa","description":"Java Persistence API interface"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"393272","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mw_logentis","name":"mw_logentis","key":"mw_logentis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Martin Wygas","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mw_logentis","name":"mw_logentis","key":"mw_logentis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Martin Wygas","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2505/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6a3d7926[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@25173189[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@746dff65[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@68ea1318[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6dd28e6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@31974100[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2a1a0680[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1250a208[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7da522bc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@76b1f349[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@c65c519[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1bb2667f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2014-09-23T15:57:09.407+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-2505/watchers","watchCount":7,"isWatching":false},"created":"2014-05-16T15:55:17.748+0000","updated":"2014-09-23T15:57:09.438+0000","timeoriginalestimate":null,"description":"When I try to get an object from my database via entity manager that includes a further object that is annotated with @OneToMany and the parameter \"fetch = FetchType.EAGER\", I got the following exception (below are more Information about my entities and testcases):\n\n[ERROR 15:50:40] projectNameRestController.catchEmAll(75) | general error occurred\n<openjpa-2.2.2-r422266:1468616 nonfatal general error> org.apache.openjpa.persistence.PersistenceException: org.apache.openjpa.util.LongId cannot be cast to de.projectName.domain.test.Parent\nFailedObject: select p from Parent p [java.lang.String]\n    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:1027)\n    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:926)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1033)\n    at org.apache.openjpa.jdbc.sql.AbstractResult.load(AbstractResult.java:280)\n    at org.apache.openjpa.jdbc.sql.SelectImpl$SelectResult.load(SelectImpl.java:2381)\n    at org.apache.openjpa.jdbc.meta.strats.RelationToManyInverseKeyFieldStrategy.loadElement(RelationToManyInverseKeyFieldStrategy.java:90)\n    at org.apache.openjpa.jdbc.meta.strats.RelationCollectionInverseKeyFieldStrategy.loadElement(RelationCollectionInverseKeyFieldStrategy.java:76)\n    at org.apache.openjpa.jdbc.meta.strats.StoreCollectionFieldStrategy.processEagerParallelResult(StoreCollectionFieldStrategy.java:313)\n    at org.apache.openjpa.jdbc.meta.strats.StoreCollectionFieldStrategy.loadEagerParallel(StoreCollectionFieldStrategy.java:247)\n    at org.apache.openjpa.jdbc.meta.FieldMapping.loadEagerParallel(FieldMapping.java:916)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1106)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1059)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:636)\n    at org.apache.openjpa.kernel.DelegatingStoreManager.load(DelegatingStoreManager.java:117)\n    at org.apache.openjpa.kernel.ROPStoreManager.load(ROPStoreManager.java:78)\n    at org.apache.openjpa.kernel.StateManagerImpl.loadFields(StateManagerImpl.java:3108)\n    at org.apache.openjpa.kernel.StateManagerImpl.load(StateManagerImpl.java:446)\n    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:963)\n    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:926)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1033)\n    at org.apache.openjpa.jdbc.sql.AbstractResult.load(AbstractResult.java:280)\n    at org.apache.openjpa.jdbc.sql.SelectImpl$SelectResult.load(SelectImpl.java:2381)\n    at org.apache.openjpa.jdbc.sql.AbstractResult.load(AbstractResult.java:274)\n    at org.apache.openjpa.jdbc.kernel.InstanceResultObjectProvider.getResultObject(InstanceResultObjectProvider.java:60)\n    at org.apache.openjpa.lib.rop.EagerResultList.<init>(EagerResultList.java:36)\n    at org.apache.openjpa.kernel.QueryImpl.toResult(QueryImpl.java:1251)\n    at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:1007)\n    at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:863)\n    at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:794)\n    at org.apache.openjpa.kernel.DelegatingQuery.execute(DelegatingQuery.java:542)\n    at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:286)\n    at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:302)\n    at de.projectName.dao.impl.AccountingDaoImpl.getDistributionsByProvider(AccountingDaoImpl.java:217)\n    at de.projectName.dao.impl.AccountingDaoImpl.getDistributionsByProvider(AccountingDaoImpl.java:171)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n    at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\n    at com.sun.proxy.$Proxy27.getDistributionsByProvider(Unknown Source)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n    at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)\n    at com.sun.proxy.$Proxy28.getDistributionsByProvider(Unknown Source)\n    at de.projectName.controller.rest.AccountingprojectNameRestController.getAllUnaccountedDistributions(AccountingprojectNameRestController.java:96)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:483)\n    at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:215)\n    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)\n    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)\n    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:749)\n    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:689)\n    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:83)\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:938)\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:870)\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:961)\n    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:852)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:618)\n    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:837)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:725)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:301)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:118)\n    at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:52)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:88)\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:108)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)\n    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:108)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)\n    at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)\n    at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)\n    at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)\n    at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)\n    at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)\n    at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)\n    at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)\n    at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)\n    at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)\n    at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)\n    at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)\n    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:344)\n    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:261)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:503)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:136)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:74)\n    at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:610)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:526)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1017)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:652)\n    at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:222)\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1575)\n    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1533)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:744)\nCaused by: java.lang.ClassCastException: org.apache.openjpa.util.LongId cannot be cast to de.projectName.domain.test.Parent\n    at de.projectName.domain.test.Child.pcReplaceField(Child.java)\n    at org.apache.openjpa.kernel.StateManagerImpl.replaceField(StateManagerImpl.java:3213)\n    at org.apache.openjpa.kernel.StateManagerImpl.storeObjectField(StateManagerImpl.java:2643)\n    at org.apache.openjpa.kernel.StateManagerImpl.storeObject(StateManagerImpl.java:2633)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.setMappedBy(JDBCStoreManager.java:478)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initializeState(JDBCStoreManager.java:404)\n    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initialize(JDBCStoreManager.java:306)\n    at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:112)\n    at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:57)\n    at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:1046)\n    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:1004)\n    ... 126 more \n________________________________________________\n\nI created 2 new entities for my tests, they look like this:\n\n@Entity\n@Table(name = \"parent\")\npublic class Parent {\n\n@Id\n@GeneratedValue(strategy = GenerationType.TABLE, generator = \"parentGen\")\n@TableGenerator(name = \"parentGen\", table = \"jpa_sequence\", pkColumnName = \"ID\",\n        pkColumnValue = \"parent\", valueColumnName = \"SEQUENCE_VALUE\", allocationSize = 1)\npublic long oid;\n\n@OneToMany(mappedBy = \"parent\", fetch = FetchType.EAGER)\nprivate List<Child> children;\n\n\npublic long getOid() {\n    return oid;\n}\n\npublic void setOid(long oid) {\n    this.oid = oid;\n}\n\npublic List<Child> getChildren() {\n    return children;\n}\n\npublic void setChildren(List<Child> children) {\n    this.children = children;\n}\n_______________________________________\n\n@Entity\n@Table(name = \"child\")\npublic class Child {\n\n@Id\n@GeneratedValue(strategy = GenerationType.TABLE, generator = \"childGen\")\n@TableGenerator(name = \"childGen\", table = \"jpa_sequence\", pkColumnName = \"ID\",\n        pkColumnValue = \"child\", valueColumnName = \"SEQUENCE_VALUE\")\npublic long oid;\n\n@ManyToOne\nprivate Parent parent;\n\n\npublic long getOid() {\n    return oid;\n}\n\npublic void setOid(long oid) {\n    this.oid = oid;\n}\n\npublic Parent getParent() {\n    return parent;\n}\n\npublic void setParent(Parent parent) {\n    this.parent = parent;\n}\n____________________________________\n\nFurther information:\n\n    My jpql: select p from Parent p\n    If I change the FetchType to \"LAZY\" (or leave it just out) I got my result normaly and the children object (the list) is null of course, but if I call the getter of the list now (in the transaction), the object will be filled normaly without this exception.\n    Furthermore this exception does not occur when I have just 1 parent with child objects. I can have several parents and children in my tables, but when more than 1 parent have children referenced in the database, this exception will be thrown.\n    Also if I change the type of \"oid\" from \"long\" to \"int\" the exception will change, too: \"...LongId cannot be cast... -> ...IntId cannot be cast...\"\n    I used: Java 8 with jpa 2.1.0 and 2.2.2, Java 6 with jpa 2.2.2\n    MySQL Database\n    Apache Tomcat\n","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12652186","id":"12652186","filename":"bugreport.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgogstad","name":"jgogstad","key":"jgogstad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jostein Gogstad","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-24T12:40:03.626+0000","size":12041,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12652186/bugreport.zip"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12663123","id":"12663123","filename":"LongId Scenarios.xlsx","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"created":"2014-08-20T13:06:17.739+0000","size":9577,"mimeType":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","content":"https://issues.apache.org/jira/secure/attachment/12663123/LongId+Scenarios.xlsx"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12669543","id":"12669543","filename":"openjpa-2505.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-09-17T22:21:43.941+0000","size":1241,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12669543/openjpa-2505.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12645313","id":"12645313","filename":"openjpa-2505.ut.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-05-16T19:50:12.375+0000","size":6450,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12645313/openjpa-2505.ut.patch"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"OpenJPA PersistenceException: LongId cannot be cast to MyEntityClass… @OneToMany in combination with FetchType.EAGER","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"Java 8 and 6","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14000054","id":"14000054","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"body":"Will you also post the contents of your persistence.xml file?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-05-16T17:53:36.167+0000","updated":"2014-05-16T17:53:36.167+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14000214","id":"14000214","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"body":"Attaching a unit test that I created, but was unable to recreate the bug. I changed the annotations on the ID fields, but I don't believe that was relevant to the problem. I suspect that I as missing some 'special' persistence.xml properties.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-05-16T19:50:12.379+0000","updated":"2014-05-16T19:50:12.379+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14001439","id":"14001439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mw_logentis","name":"mw_logentis","key":"mw_logentis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Martin Wygas","active":true,"timeZone":"Etc/UTC"},"body":"<persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n             xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n             xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\"\n             version=\"1.0\">\n    <persistence-unit name=\"punit\">\n        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>\n        <properties>\n            <property name=\"openjpa.Log\" value=\"log4j\"/>\n            <property name=\"openjpa.jdbc.DBDictionary\" value=\"db2\"/>\n        </properties>\n    </persistence-unit>\n</persistence>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mw_logentis","name":"mw_logentis","key":"mw_logentis","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Martin Wygas","active":true,"timeZone":"Etc/UTC"},"created":"2014-05-19T07:14:22.835+0000","updated":"2014-05-19T07:14:22.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14001940","id":"14001940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"body":"I haven't been able to create your problem. I tried on trunk and 2.2.x . Would it be possible for you to try to put something together that easily recreates the problem? Also, please take a look at my unit test to see if I'm doing something wrong with setting the data up.\n\nThanks,\nRick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-05-19T16:06:25.668+0000","updated":"2014-05-19T16:06:25.668+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14011232","id":"14011232","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"body":"Hi Martin!  Have you given any thought to Rick's previous request?  We'd really like to be able to recreate this issue and provide a fix to you asap.\n\nThanks,\n\nHeath","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpaheath","name":"jpaheath","key":"jpaheath","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Heath Thomann","active":true,"timeZone":"America/Denver"},"created":"2014-05-28T15:54:12.410+0000","updated":"2014-05-28T15:54:12.410+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14042054","id":"14042054","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgogstad","name":"jgogstad","key":"jgogstad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jostein Gogstad","active":true,"timeZone":"Europe/Berlin"},"body":"[~jpaheath], [~curtisr7]: I managed to reproduce the for a OneToMany the the inverse side has a composite primary key. I boiled down the error and attached a bugreport packaged in a maven project. run {{mvn test}} and you'll get the error\n{code:none}\nCaused by: java.lang.ClassCastException: org.apache.openjpa.util.LongId cannot be cast to org.apache.openjpa.entities.MyUserEntity\n        at org.apache.openjpa.entities.AddressEntity.pcReplaceField(AddressEntity.java)\n        at org.apache.openjpa.kernel.StateManagerImpl.replaceField(StateManagerImpl.java:3216)\n        at org.apache.openjpa.kernel.StateManagerImpl.storeObjectField(StateManagerImpl.java:2643)\n        at org.apache.openjpa.kernel.StateManagerImpl.storeObject(StateManagerImpl.java:2633)\n        at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.setMappedBy(JDBCStoreManager.java:478)\n        at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initializeState(JDBCStoreManager.java:404)\n        at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initialize(JDBCStoreManager.java:306)\n        at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:112)\n        at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:57)\n        at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:1050)\n        at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:1008)\n{code}\n\nOpenJPA behaves really wierd. Here's some observations:\n* You need to select a completely unrelated class from the db in a \\@PostConstruct \n** If the class (FooEntity) is selected anywhere else, everything works\n** If the FooEntity is not selected at all, everything works\n* The error seem only to occur if the inverse side of a OneToMany has a composite key","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgogstad","name":"jgogstad","key":"jgogstad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jostein Gogstad","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-24T12:45:48.323+0000","updated":"2014-06-24T12:45:48.323+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14042061","id":"14042061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgogstad","name":"jgogstad","key":"jgogstad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jostein Gogstad","active":true,"timeZone":"Europe/Berlin"},"body":"Verified on 2.2.2 and 2.3.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jgogstad","name":"jgogstad","key":"jgogstad","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jostein Gogstad","active":true,"timeZone":"Europe/Berlin"},"created":"2014-06-24T12:49:49.631+0000","updated":"2014-06-24T12:49:49.631+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14071948","id":"14071948","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=logemann","name":"logemann","key":"logemann","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Logemann","active":true,"timeZone":"Etc/UTC"},"body":"any news on that?  i am a colleague of Martin and most likely i am on the same spot as Martin. I also tried various things w/o success to solve / circumvent it. Currently i am on 2.2.0. \n\nAny ideas how to workaround this?\n\nUpdate: The only sensible workaround is to avoid \"eager\" and use \"join fetch\" instead.\n\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=logemann","name":"logemann","key":"logemann","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Marc Logemann","active":true,"timeZone":"Etc/UTC"},"created":"2014-07-23T16:52:35.805+0000","updated":"2014-07-23T17:18:09.332+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14103847","id":"14103847","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"body":"I have been working on this same issue with IBM for the past eight months or so.  Jostein, I appreciate the test case you provided as it helped me to narrow down the issue much further.  Here are some facts I've gathered that have already been forwarded to IBM.\n\n1.) @PostConstruct does not cause the error.  I was able to use the test case to reproduce the error with and without @PostConstruct.\n2.) The statement that a non-related entity must exist is false.  I removed the FooEntity entirely from persistence.xml (along with its entity annotations), and I was still able to reproduce the error.\n3.) At least two parents and at least one child record for each parent must exist for the error to occur.  Once you delete one of the remaining two children the error no longer occurs.\n4.) An embedded key is not necessary for the error to occur (my entities don’t use them).\n\nI'm going to attach a spreadsheet of actions I performed using the sql data provided in Jostein's test case.\n\nOne last thing: I have a theory that the order in which objects are retrieved from the database (asc or desc) is a factor also, but as I'm sure you have all seen it's difficult to pinpoint.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"created":"2014-08-20T13:05:36.776+0000","updated":"2014-08-20T13:08:54.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14103848","id":"14103848","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"body":"Here is the promised spreadsheet of steps I performed (LongId Scenarios.xlsx).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"created":"2014-08-20T13:06:17.756+0000","updated":"2014-08-20T13:07:18.766+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14104925","id":"14104925","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"body":"Lucas --\n\nI sort of tried out your test project this evening and it worked for me.... with a few modifications. \n * Your test uses Oracle DB and I don't have that on my system so I changed test-ctx.xml to use MySQL.\n * I had to change your p.xml to use openjpa.jdbc.SynchronizeMappings as I don't have any of the tables for your Entities.\n * I had to modify MyUserEntity to use an AUTO generated ID as MySQL doesn't support native sequences.\n\nHave you tried your test on a DB other than oracle? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-08-21T01:38:33.527+0000","updated":"2014-08-21T01:38:33.527+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14106771","id":"14106771","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"body":"Rick -\n\nI wouldn't think the changes you made would have any affect on the error.  I believe the root cause is that OpenJPA isn't handling the mapping of child entities to parent entities correctly in certain scenarios that are purely data-related.  That's just a theory, but the results seem to support that.\n\nOracle is the only database I have access to at the moment so I haven't tested on other platforms.  It sounds like the error still occurred for you on MySQL so unless anyone has the need to try it on another database I believe we've narrowed it down to pure data.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"created":"2014-08-22T12:32:17.348+0000","updated":"2014-08-22T12:32:17.348+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14130225","id":"14130225","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"body":"I've got some more information that I've found in my testing.  It seems that the issue is related to the entity manager itself in conjunction with JPA.  In my testing I found that when the data already exists in the database, and the retrieval is performed, the error always occurs.  However, if the data is inserted using the entity manager, and then retrieved using the entity manager in the same session the error does not occur.\n\nIt almost feels like there is an association that is built by the entity manager when records are inserted using it, but if it wasn't used to insert the records there's some unknown variable in the equation that causes this issue.\n\nI tried the following three scenarios to validate my hypotheses:\n\n1.)\tInsert entities using Spring’s entity manager and OpenJPA associations and load entities using OpenJPA (no error)\na.\tDelete records from database\nb.\tRestart JVM\n\n2.)\tInsert using Native JDBC and load entities using OpenJPA (error occurs)\na.\tDelete records from database\nb.\tRestart JVM\n\n3.)\tInsert manually in database and load entites using OpenJPA (error occurs)\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=Lucas_Wright","name":"Lucas_Wright","key":"lucas_wright","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lucas Wright","active":true,"timeZone":"America/New_York"},"created":"2014-09-11T16:15:23.463+0000","updated":"2014-09-11T16:15:23.463+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14138115","id":"14138115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"body":"I was able to fix the reported problem, but I am still having issues trying to recreate it in a simple JUnit. Please give the attached patch a try to ensure that it works in all of your scenarios.\n\nThanks,\nRick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-09-17T22:21:43.960+0000","updated":"2014-09-17T22:21:43.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14140984","id":"14140984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1626287 from [~curtisr7] in branch 'openjpa/trunk'\n[ https://svn.apache.org/r1626287 ]\n\nOPENJPA-2505 : Properly init MetaDataRepository when obtaining a reference in EntityManagerFactory.getMetaModel.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-19T17:59:01.189+0000","updated":"2014-09-19T17:59:01.189+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14140989","id":"14140989","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"body":"Committed revision 1626287 to trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=curtisr7","name":"curtisr7","key":"curtisr7","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Richard G. Curtis","active":true,"timeZone":"America/Chicago"},"created":"2014-09-19T18:00:19.924+0000","updated":"2014-09-19T18:00:19.924+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12714792/comment/14144915","id":"14144915","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"body":"Commit 1627059 from [~jpaheath] in branch 'openjpa/branches/2.2.x'\n[ https://svn.apache.org/r1627059 ]\n\nOPENJPA-2505: Properly init MetaDataRepository when obtaining a reference in EntityManagerFactory.getMetaModel.  Back-ported to 2.2.x Rick Curtis' trunk changes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","key":"jira-bot","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true,"timeZone":"Etc/UTC"},"created":"2014-09-23T15:35:55.877+0000","updated":"2014-09-23T15:35:55.877+0000"}],"maxResults":17,"total":17,"startAt":0},"customfield_12311820":"0|i1voyn:","customfield_12314139":null}}

