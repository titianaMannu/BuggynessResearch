{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12348645","self":"https://issues.apache.org/jira/rest/api/2/issue/12348645","key":"OPENJPA-34","fields":{"fixVersions":[],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"160371","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[],"customfield_12313825":null,"assignee":null,"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"288123","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-34/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1b458368[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@259de0ab[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@235a8c94[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6908a8ec[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3c82d973[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@30a0ab81[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4769af2d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6b8a20e4[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41e935a7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@74a072b8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7ebaabc6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@448d29f5[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2006-10-04T16:12:12.000+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-34/watchers","watchCount":0,"isWatching":false},"created":"2006-08-25T15:57:25.000+0000","updated":"2007-04-17T18:38:46.057+0000","timeoriginalestimate":null,"description":"I have a small hierarchy of entities specified in an xml descriptor (orm.xml), Employee, PartTimeEmployee and FullTimeEmployee. PartTimeEmployee and FullTimeEmployee extend Employee which is a MappedSuperclass. \n\nIf I don't explicitly set the access type for either PartTimeEmployee or FullTimeEmployee in orm.xml and I use the static enhancer (org.apache.openjpa.enhance.PCEnhancer) everything works fine.  If I use runtime enhancement I get a warning like this : \n\n184  INFO   [main] openjpa.MetaData - Found 3 classes with metadata in 7 milliseconds.\n88  INFO   [main] openjpa.Runtime - Starting OpenJPA 0.0.0\n180  INFO   [main] openjpa.jdbc.JDBC - Using dictionary class \"org.apache.openjpa.jdbc.sql.DerbyDictionary\".\n277  INFO   [main] openjpa.MetaData - Found 4 classes with metadata in 1 milliseconds.\n985  INFO   [main] openjpa.MetaData - Parsing resource \"file:/home/mikedd/workspaces/openjpa/mdd/target/classes/META-INF/orm.xml\".\n1307  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.Employee\".\n1356  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.Employee\".\n1356  INFO   [main] openjpa.MetaData - Parsing package \"mdd.entities.descriptor.Employee\".\n1385  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.PartTimeEmployee\".\n1385  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.PartTimeEmployee\".\n1389  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.FullTimeEmployee\".\n1390  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.FullTimeEmployee\".\n1394  INFO   [main] openjpa.MetaData - Parsing class \"mdd.entities.descriptor.AbstractPersonnel\".\n1422  WARN   [main] openjpa.Enhance - An exception was thrown while attempting to perform class file transformation on \"mdd/entities/descriptor/FullTimeEmployee\":\n<4|false|0.0.0> org.apache.openjpa.util.UserException: Detected the following possible violations of the restrictions placed on property access persistent types:\nThe member for for persistent property \"mdd.entities.descriptor.FullTimeEmployee.salary\" was not a method: \"private float mdd.entities.descriptor.FullTimeEmployee.salary\".\n\tat org.apache.openjpa.enhance.PCEnhancer.processViolations(PCEnhancer.java:520)\n\tat org.apache.openjpa.enhance.PCEnhancer.run(PCEnhancer.java:287)\n\tat org.apache.openjpa.enhance.PCClassFileTransformer.transform(PCClassFileTransformer.java:122)\n\tat sun.instrument.TransformerManager.transform(TransformerManager.java:141)\n\tat sun.instrument.InstrumentationImpl.transform(InstrumentationImpl.java:174)\n\tat java.lang.ClassLoader.defineClassImpl(Native Method)\n\n\nFrom what I can tell after running the debugger the error occurs because the runtime enhancer isn't able to find the parent's metadata (and from that the access type). \n\nI don't think the spec is very clear in this regard. Access isn't a required attribute for entities, but the spec doesn't indicate what should happen if it isn't present (or if it does I didn't find it). \n\nI don't know whether this is a limitation of runtime enhancement (again I didn't see it documented anywhere, but maybe I didn't look hard enough). There are also plenty of solutions, specifying a default access type in orm.xml, or just adding access=\"PROPERTY\" to the entity will work. \n\nIf it's not an architectural limitation though, I think we should try to get runtime enhancement to work in the same manner as static enhancement. \n\nIn case it helps here's my javaagent setting : \n-javaagent:/home/mikedd/.m2/repository/org/apache/openjpa/openjpa-kernel-5/0.9.0-SNAPSHOT/openjpa-kernel-5-0.9.0-SNAPSHOT.jar=scanDevPath=true,MetaDataFactory=jpa\n\nI've attached the source that I've used to produce the problem, include the eclipse .project and .classpath files (you'll probably have to update these). There's also a pom.xml which can be used to compile or at least set up the classpath in eclipse. I don't know how to toggle between runtime and static enhancement with maven so I haven't used it to run the tests. ","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12339578","id":"12339578","filename":"ASF.LICENSE.NOT.GRANTED--employee-project.zip","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2006-08-25T15:57:25.000+0000","size":4735,"mimeType":"application/zip","content":"https://issues.apache.org/jira/secure/attachment/12339578/ASF.LICENSE.NOT.GRANTED--employee-project.zip"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"Problem detecting parent's access type with runtime enhancement.","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348645/comment/12439882","id":"12439882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Appears to be resolved (not sure which change fixed it though). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2006-10-04T16:12:12.000+0000","updated":"2006-10-04T16:12:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348645/comment/12439916","id":"12439916","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mprudhom","name":"mprudhom","key":"mprudhom","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mprudhom&avatarId=45285","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mprudhom&avatarId=45285","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mprudhom&avatarId=45285","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mprudhom&avatarId=45285"},"displayName":"Marc Prud'hommeaux","active":true,"timeZone":"America/New_York"},"body":"I suspect the fixes for OPENJPA-41 and OPENJPA-42 also addressed this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mprudhom","name":"mprudhom","key":"mprudhom","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mprudhom&avatarId=45285","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mprudhom&avatarId=45285","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mprudhom&avatarId=45285","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mprudhom&avatarId=45285"},"displayName":"Marc Prud'hommeaux","active":true,"timeZone":"America/New_York"},"created":"2006-10-04T17:48:47.000+0000","updated":"2006-10-04T17:48:47.000+0000"}],"maxResults":2,"total":2,"startAt":0},"customfield_12311820":"0|i1doun:","customfield_12314139":null}}

