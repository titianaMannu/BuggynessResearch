{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12378065","self":"https://issues.apache.org/jira/rest/api/2/issue/12378065","key":"OPENJPA-367","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312687","id":"12312687","description":"","name":"1.0.1","archived":false,"released":true,"releaseDate":"2007-11-09"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312846","id":"12312846","description":"","name":"1.0.2","archived":false,"released":true,"releaseDate":"2008-02-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312344","id":"12312344","description":"","name":"1.1.0","archived":false,"released":true,"releaseDate":"2008-05-22"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"160690","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312341","id":"12312341","description":"","name":"1.0.0","archived":false,"released":true,"releaseDate":"2007-08-28"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[{"id":"12317581","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12317581","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12378307","key":"OPENJPA-372","self":"https://issues.apache.org/jira/rest/api/2/issue/12378307","fields":{"summary":"PCEnhancer throws away its classloader","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.svg","name":"Blocker","id":"1"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311302","id":"12311302","name":"kernel","description":"Kernel"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"203441","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-367/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6391e40a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1568f35d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1615fc5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5341a6af[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@44bca503[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4bb198ff[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40a5693b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1e8fcb5e[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3fbae131[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@788be059[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@130ca2c2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@73b95ec6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2007-10-30T16:04:19.919+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-367/watchers","watchCount":0,"isWatching":false},"created":"2007-09-12T16:30:38.100+0000","updated":"2008-04-15T18:10:43.794+0000","timeoriginalestimate":null,"description":"When an entity is defined using pure XML (i.e. no annotation in the entity class), the enhancer does not recognized the meta data and no enhancing will take place: E.g.\n\n-----------------------------------------\nC:\\temp\\test>runPcEnhancer.bat\n\nC:\\temp\\test>java -cp C:\\temp\\test\\;C:\\temp\\test\\openjpa-1.1.0-SNAPSHOT.jar;C:\\temp\\test\\utils.jar;C:\\temp\\test\\geronimo-jpa_3.0_spec-1.0.jar;C:\\temp\\test\\geronimo-jta_1.1_spec-1.1.jar org.apache.openjpa.enhance.PCEnhancer\n15  EntityUnit_JSE  TRACE  [main] openjpa.Runtime - Setting the following properties from \"file:/C:/temp/test/META-INF/persistence.xml\" into configuration: {openjpa.Id=EntityUnit_JSE, openjpa.Log=DefaultLevel=TRACE, openjpa.MetaDataFactory=jpa(Resources=META-INF/jpamappings.xml, Types=test.XMLDatatypeSupportTestEntity)}\n31  EntityUnit_JSE  TRACE  [main] openjpa.Runtime - No cache marshaller found for id org.apache.openjpa.conf.MetaDataCacheMaintenance.\n47  EntityUnit_JSE  INFO   [main] openjpa.Tool - No targets were given.  Running on all classes in your persistent classes list, or all metadata files in classpath directories if you have not listed your persistent classes.  Use -help to display tool usage information.\n62  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Scanning resource \"META-INF/jpamappings.xml\" for persistent types.\n62  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Scan of \"META-INF/jpamappings.xml\" found persistent types [Ljava.lang.String;@3a183a18.\n62  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Mapping resource location \"file:/C:/temp/test/META-INF/jpamappings.xml\" to persistent types \"[test.XMLDatatypeSupportTestEntity]\".\n62  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Scanning resource \"META-INF/orm.xml\" for persistent types.\n62  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - parsePersistentTypeNames() found [test.XMLDatatypeSupportTestEntity].\n62  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Found 1 classes with metadata in 15 milliseconds.\n62  EntityUnit_JSE  TRACE  [main] openjpa.Tool - Enhancer running on type \"test.XMLDatatypeSupportTestEntity\".\n93  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Loading metadata for \"class test.XMLDatatypeSupportTestEntity\" under mode \"[META]\".\n125  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing resource \"file:/C:/temp/test/META-INF/jpamappings.xml\".\n156  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing class \"test.XMLDatatypeSupportTestEntity\".\n172  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Generating default metadata for type \"test.XMLDatatypeSupportTestEntity\".\n172  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Using reflection for metadata generation.\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing class \"test.XMLDatatypeSupportTestEntity\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing package \"test.XMLDatatypeSupportTestEntity\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Finished parsing metadata resource \"file:/C:/temp/test/META-INF/jpamappings.xml\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing class \"test.XMLDatatypeSupportTestEntity\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.Enhance - Enhancing type \"class test.XMLDatatypeSupportTestEntity\".\n203  EntityUnit_JSE  WARN   [main] openjpa.Enhance - Type \"class test.XMLDatatypeSupportTestEntity\" has no metadata; enhancing as persistence aware. If you intended for \"class test.XMLDatatypeSupportTestEntity\" to be persistence-capable, then this means that OpenJPA could not find any metadata for \"class test.XMLDatatypeSupportTestEntity\". This can happen if the directory containing your metadata is not in your CLASSPATH, or if your metadata files are not named properly. See the documentation on metadata placement for more information.\n203  EntityUnit_JSE  TRACE  [main] openjpa.Tool - The class does not have metadata - enhanced as persistence-aware.\n-----------------------------------------\n\nHowever if the target is specified, the enhancement will occur, E.g.\n\n-----------------------------------------\nC:\\temp\\test>runPcEnhancer.bat test.XMLDatatypeSupportTestEntity\n\nC:\\temp\\test>java -cp C:\\temp\\test\\;C:\\temp\\test\\openjpa-1.1.0-SNAPSHOT.jar;C:\\temp\\test\\utils.jar;C:\\temp\\test\\geronimo-jpa_3.0_spec-1.0.jar;C:\\temp\\test\\geronimo-jta_1.1_spec-1.1.jar org.apache.openjpa.enhance.PCEnhancer test.XMLDatatypeSupportTestEntity\n15  EntityUnit_JSE  TRACE  [main] openjpa.Runtime - Setting the following properties from \"file:/C:/temp/test/META-INF/persistence.xml\" into configuration: {openjpa.Id=EntityUnit_JSE, openjpa.Log=DefaultLevel=TRACE, openjpa.MetaDataFactory=jpa(Resources=META-INF/jpamappings.xml, Types=test.XMLDatatypeSupportTestEntity)}\n47  EntityUnit_JSE  TRACE  [main] openjpa.Runtime - No cache marshaller found for id org.apache.openjpa.conf.MetaDataCacheMaintenance.\n78  EntityUnit_JSE  TRACE  [main] openjpa.Runtime - No cache marshaller found for id org.apache.openjpa.conf.MetaDataCacheMaintenance.\n94  EntityUnit_JSE  TRACE  [main] openjpa.Tool - Enhancer running on type \"class test.XMLDatatypeSupportTestEntity\".\n125  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Loading metadata for \"class test.XMLDatatypeSupportTestEntity\" under mode \"[META]\".\n125  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Scanning resource \"META-INF/jpamappings.xml\" for persistent types.\n125  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Scan of \"META-INF/jpamappings.xml\" found persistent types [Ljava.lang.String;@20962096.\n140  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Mapping resource location \"file:/C:/temp/test/META-INF/jpamappings.xml\" to persistent types \"[test.XMLDatatypeSupportTestEntity]\".\n140  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Scanning resource \"META-INF/orm.xml\" for persistent types.\n140  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - parsePersistentTypeNames() found [test.XMLDatatypeSupportTestEntity].\n140  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Found 1 classes with metadata in 15 milliseconds.\n156  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing resource \"file:/C:/temp/test/META-INF/jpamappings.xml\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing class \"test.XMLDatatypeSupportTestEntity\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Generating default metadata for type \"test.XMLDatatypeSupportTestEntity\".\n187  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Using reflection for metadata generation.\n203  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Parsing class \"test.XMLDatatypeSupportTestEntity\".\n219  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Finished parsing metadata resource \"file:/C:/temp/test/META-INF/jpamappings.xml\".\n219  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Set persistence-capable superclass of \"test.XMLDatatypeSupportTestEntity\" to \"null\".\n219  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Resolving metadata for \"test.XMLDatatypeSupportTestEntity@1259490066\".\n219  EntityUnit_JSE  TRACE  [main] openjpa.MetaData -   Resolving field \"test.XMLDatatypeSupportTestEntity@1259490066.byteAttrDefault\".\n219  EntityUnit_JSE  TRACE  [main] openjpa.MetaData -   Resolving field \"test.XMLDatatypeSupportTestEntity@1259490066.id\".\n250  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Preparing mapping for \"test.XMLDatatypeSupportTestEntity\".\n250  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Resolving mapping for \"test.XMLDatatypeSupportTestEntity@1259490066\".\n250  EntityUnit_JSE  TRACE  [main] openjpa.Enhance - Enhancing type \"class test.XMLDatatypeSupportTestEntity\".\n312  EntityUnit_JSE  TRACE  [main] openjpa.MetaData - Clearing metadata repository \"org.apache.openjpa.meta.MetaDataRepository@518c518c\".\n-----------------------------------------\n","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12365748","id":"12365748","filename":"OPENJPA-367.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-09-13T16:54:53.779+0000","size":708,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12365748/OPENJPA-367.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12365647","id":"12365647","filename":"OPENJPA-367.test.jar","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-09-12T16:33:55.092+0000","size":3708108,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12365647/OPENJPA-367.test.jar"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"PCEnhancer does not find meta data for entities using pure XML annotation","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":"All platforms","customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12526844","id":"12526844","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"body":"Attached jar contains all the artifacts to reproduce the problem.\n- unzip the jar to c:\\temp\n- run tests with\n    runPcEnhancer.bat\n       or\n    runPcEnhancer.bat test.XMLDatatypeSupportTestEntity","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-09-12T16:33:55.173+0000","updated":"2007-09-12T16:33:55.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12526849","id":"12526849","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"body":"From initial investigation, here is the call stack that shows the call path to CFMetaDataParser.classForName()\n\n  CFMetaDataParser.classForName(String, String, boolean, ClassLoader) line: 307\n  XMLPersistenceMetaDataParser(CFMetaDataParser).classForName(String, boolean) line: 285\t\n  XMLPersistenceMetaDataParser.classForName(String) line: 1679\t\n  XMLPersistenceMetaDataParser.startClass(String, Attributes) line: 727\t\n  XMLPersistenceMetaDataParser(CFMetaDataParser).startElement(String, Attributes) line: 108\t\n  XMLPersistenceMetaDataParser(XMLMetaDataParser).startElement(String, String, String, Attributes) line: 432\t\n  SAXParserImpl$JAXPSAXParser(AbstractSAXParser).startElement(QName, XMLAttributes, Augmentations) line: not available\t\n  XMLSchemaValidator.startElement(QName, XMLAttributes, Augmentations) line: not available\t\n  XMLNSDocumentScannerImpl.scanStartElement() line: not available\t\n  XMLNSDocumentScannerImpl$NSContentDispatcher(XMLDocumentFragmentScannerImpl$FragmentContentDispatcher).dispatch(boolean) line: not available\t\n  XMLNSDocumentScannerImpl(XMLDocumentFragmentScannerImpl).scanDocument(boolean) line: not available\t\n  XIncludeAwareParserConfiguration(XML11Configuration).parse(boolean) line: not available\t\n  XIncludeAwareParserConfiguration(XML11Configuration).parse(XMLInputSource) line: not available\t\n  SAXParserImpl$JAXPSAXParser(XMLParser).parse(XMLInputSource) line: not available\t\n  SAXParserImpl$JAXPSAXParser(AbstractSAXParser).parse(InputSource) line: not available\t\n  SAXParserImpl.parse(InputSource, DefaultHandler) line: not available\t\n  XMLPersistenceMetaDataParser(XMLMetaDataParser).parseNewResource(Reader, String) line: 376\t\n  XMLPersistenceMetaDataParser(XMLMetaDataParser).parse(MetaDataIterator, boolean) line: 318\t\n  XMLPersistenceMetaDataParser(XMLMetaDataParser).parse(MetaDataIterator) line: 295\t\n  XMLPersistenceMetaDataParser(XMLMetaDataParser).parse(URL) line: 268\t\n  PersistenceMetaDataFactory.parseXML(URL, Class, int, ClassLoader) line: 247\t\n  PersistenceMetaDataFactory.load(Class, int, ClassLoader) line: 198\t\n  MetaDataRepository.getMetaDataInternal(Class, ClassLoader) line: 470\t\n  MetaDataRepository.getMetaData(Class, ClassLoader, boolean) line: 290\t\n  PCEnhancer.<init>(OpenJPAConfiguration, BCClass, MetaDataRepository, ClassLoader) line: 242\t\n  PCEnhancer.run(OpenJPAConfiguration, String[], PCEnhancer$Flags, MetaDataRepository, BytecodeWriter, ClassLoader) line: 4349\t\n  PCEnhancer.run(OpenJPAConfiguration, String[], Options) line: 4296\t\n  PCEnhancer.main(String[]) line: 4268\t\n\nIn the failing case, serp.Strings.toClass() method returns a different Class object from the Class object used by the MetaDataRepository, as a result, the look up of the meta data from the MetaDataRepository._meta map will not find the meta data, even there is one in the _meta map with a different Class object key.\n\nIf a target is passed to the enhencer, serp.Strings.toClass() returns the same Class object, hence the look up in the MetaDataRepository succeeded. \n\nThis implies serp returns a entity Class object using a different classloader.  From what I notice, both calls (pass & fail cases) to the serp.Strings.toClass() method uses the same TemporaryClassLoader.\n\nSince I have no access to the Serp code, I don't know what Serp does and what is the difference that cause the failure.\n\nI am looking for someone who can shred some light into this problem.\n\nThanks.\nAlbert Lee.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-09-12T16:48:41.310+0000","updated":"2007-09-12T16:48:41.310+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12526858","id":"12526858","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pcl","name":"pcl","key":"pcl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Linskey","active":true,"timeZone":"America/Los_Angeles"},"body":"FTR, the serp source code is available at http://serp.sourceforge.net","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pcl","name":"pcl","key":"pcl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Linskey","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-09-12T17:17:16.676+0000","updated":"2007-09-12T17:17:16.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12526887","id":"12526887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"body":"Patrick, thanks for the pointer to the serp code. It helps a lot.  This problem has nothing to do with Serp.\n\nThe scope of the problem is:\n\n1) When pcEnhancer is invoked with a target (i.e. test.XMLDatatypeSupportTestEntity), the ClassArgParser.parseTypes() is called to process the arguments and indirectly the entity is loaded using the TemporaryClassLoader. Subsequently, when the orm.xml is parsed, the same TemporaryClassLoader is used as the key to the meta data repository map.\n\n    TemporaryClassLoader.loadClass(String, boolean) line: 78\t\n    TemporaryClassLoader.loadClass(String) line: 44\t\n    ClassLoader.defineClassImpl(String, byte[], int, int, Object) line: not available [native method]\t\n    TemporaryClassLoader(ClassLoader).defineClass(String, byte[], int, int, ProtectionDomain) line: 224\t\n    TemporaryClassLoader(ClassLoader).defineClass(String, byte[], int, int) line: 163\t\n    TemporaryClassLoader.loadClass(String, boolean) line: 78\t\n    TemporaryClassLoader.loadClass(String) line: 44\t\n    Class<T>.forNameImpl(String, boolean, ClassLoader) line: not available [native method]\t\n    Class<T>.forName(String, boolean, ClassLoader) line: 164\t\n    Strings.toClass(String, boolean, ClassLoader) line: 162\t\n    Strings.toClass(String, ClassLoader) line: 108\t\n    ClassArgParser.parseTypes(String) line: 164\t\n    PCEnhancer.run(OpenJPAConfiguration, String[], PCEnhancer$Flags, MetaDataRepository, BytecodeWriter, ClassLoader) line: 4333\t\n    PCEnhancer.run(OpenJPAConfiguration, String[], Options) line: 4296\t\n    PCEnhancer.main(String[]) line: 4268\t\n\n2) When no target is specified, the argument process is skipped and proceed to meta-data processing. The first step to do is to load entity class using serp.Project.  Currently, the project's loadClass() method is called without a classloader, therefore Project uses a default, which is the application context classloader (Thread.currentThread().getContextClassLoader();)\nHowever, the remaining meta-data processing follow the exactly the same path as the successfully scenario and use the TemporaryClassLoader to load the entity class. This later entity Class object is used as the key to the meta-data repository map.  When all the processing is finished, MetaDataRepository.getMetaDataInternal( entityClass_from_applCtxtClassLoader) is called to lookup the meta data and was not found.\n\n--------------------------------\n  PCEnhancer.java\n        for (Iterator itr = classes.iterator(); itr.hasNext();) {\n            Object o = itr.next();\n            if (log.isTraceEnabled())\n                log.trace(_loc.get(\"enhance-running\", o));\n\n            if (o instanceof String)\n                bc = project.loadClass((String) o, loader); //<<<<  loader is added to resolve the observed problem\n            else\n                bc = project.loadClass((Class) o);\n            enhancer = new PCEnhancer(conf, bc, repos, loader);\n--------------------------------\n  serp.Project.java\n      public BCClass loadClass(String name) {\n        return loadClass(name, null);\n    }\n--------------------------------\n    public BCClass loadClass(String name, ClassLoader loader) {\n        // convert to proper Class.forName() form\n        name = _names.getExternalForm(name, false);\n\n        BCClass cached = checkCache(name);\n        if (cached != null)\n            return cached;\n\n        // check for existing type\n        if (loader == null)\n            loader = Thread.currentThread().getContextClassLoader();\n        try {\n            return loadClass(Strings.toClass(name, loader));\n        } catch (Exception e) {\n        }\n--------------------------------\n\nI modified PCEnhancer.run method and add the classloader parameter to the project.loadClass()  call to request Project to load the entity class using the TemporaryClassLoader. This seems to fix the problem.\n\n            if (o instanceof String)\n                bc = project.loadClass((String) o, loader); //<<<<  loader is added to resolve the observed problem\n\nIs this the correct fix strategy for this problem?\n\nThanks,\nAlbert Lee","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-09-12T19:46:33.068+0000","updated":"2007-09-12T19:46:33.068+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12527171","id":"12527171","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"body":"Attached patch to add \"loader\" in PCEnhancer.run().\n\n            if (o instanceof String)\n                bc = project.loadClass((String) o, loader);\n            else\n                bc = project.loadClass((Class) o);","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-09-13T16:54:53.845+0000","updated":"2007-09-13T16:54:53.845+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12527971","id":"12527971","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pcl","name":"pcl","key":"pcl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Linskey","active":true,"timeZone":"America/Los_Angeles"},"body":"That sounds like a valid fix to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pcl","name":"pcl","key":"pcl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Linskey","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-09-17T07:39:50.598+0000","updated":"2007-09-17T07:39:50.598+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12528125","id":"12528125","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kwsutter","name":"kwsutter","key":"kwsutter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin W. Sutter","active":true,"timeZone":"America/Chicago"},"body":"Resolved for 1.1.0 (r576552) and 1.0.1 (r576564).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kwsutter","name":"kwsutter","key":"kwsutter","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevin W. Sutter","active":true,"timeZone":"America/Chicago"},"created":"2007-09-17T19:28:15.461+0000","updated":"2007-09-17T19:28:15.461+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12538816","id":"12538816","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pcl","name":"pcl","key":"pcl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Linskey","active":true,"timeZone":"America/Los_Angeles"},"body":"The test case for this issue was not checked in.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pcl","name":"pcl","key":"pcl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Patrick Linskey","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-30T15:44:32.794+0000","updated":"2007-10-30T15:44:32.794+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12538823","id":"12538823","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"body":"Problem fixed. Need to check in test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=allee8285","name":"allee8285","key":"allee8285","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Albert Lee","active":true,"timeZone":"America/Chicago"},"created":"2007-10-30T16:04:19.901+0000","updated":"2007-10-30T16:04:19.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378065/comment/12552265","id":"12552265","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebasouza","name":"sebasouza","key":"sebasouza","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebastian Souza","active":true,"timeZone":"Etc/UTC"},"body":"I have the same problem, and i am using openjpa 1.1. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebasouza","name":"sebasouza","key":"sebasouza","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebastian Souza","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-16T18:27:36.947+0000","updated":"2007-12-16T18:27:36.947+0000"}],"maxResults":10,"total":10,"startAt":0},"customfield_12311820":"0|i0z713:","customfield_12314139":null}}

