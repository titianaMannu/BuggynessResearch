{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12384438","self":"https://issues.apache.org/jira/rest/api/2/issue/12384438","key":"OPENJPA-464","fields":{"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312344","id":"12312344","description":"","name":"1.1.0","archived":false,"released":true,"releaseDate":"2008-05-22"}],"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12312323":null,"customfield_12312320":null,"customfield_12310420":"42089","customfield_12312321":null,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12312331":null,"customfield_12312332":null,"aggregatetimeoriginalestimate":null,"timeestimate":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312344","id":"12312344","description":"","name":"1.1.0","archived":false,"released":true,"releaseDate":"2008-05-22"}],"customfield_12311120":null,"customfield_12313826":null,"customfield_12312339":null,"issuelinks":[],"customfield_12313825":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"customfield_12312337":null,"customfield_12313823":null,"customfield_12312338":null,"customfield_12311920":null,"customfield_12313822":null,"customfield_12312335":null,"customfield_12313821":null,"customfield_12312336":null,"customfield_12313820":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12311302","id":"12311302","name":"kernel","description":"Kernel"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"202640","customfield_12312823":null,"creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"aggregateprogress":{"progress":0,"total":0},"customfield_12313520":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"customfield_12313924":null,"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-464/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12313920":null,"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"customfield_12314020":"{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@85e2b1b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7c77dc90[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@424f5309[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@1e848c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7ee7c707[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@40e56d55[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@788ab95b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@c446822[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4cdb5952[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@27bf0a59[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@ad22f94[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@25785394[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}","customfield_12314141":null,"customfield_12314140":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310351","id":"12310351","key":"OPENJPA","name":"OpenJPA","projectTypeKey":"software","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310351&avatarId=10043","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310351&avatarId=10043","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310351&avatarId=10043","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310351&avatarId=10043"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10252","id":"10252","description":"","name":"OpenJPA"}},"aggregatetimespent":null,"customfield_12312520":null,"customfield_12314422":null,"customfield_12314421":null,"customfield_12314146":null,"customfield_12314420":null,"customfield_12314145":null,"customfield_12314144":null,"customfield_12314143":null,"resolutiondate":"2008-02-07T22:53:46.004+0000","workratio":-1,"customfield_12312923":null,"customfield_12312920":null,"customfield_12312921":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/OPENJPA-464/watchers","watchCount":1,"isWatching":false},"created":"2007-12-11T22:03:56.567+0000","updated":"2010-03-09T18:32:42.606+0000","timeoriginalestimate":null,"description":"The current OpenJPA implementation did not provide the SQL statement batching. All SQL statements will be executed one statement at a time to the database. Consequently, the runtime performance was decreased due to lots of database flows. JDBC Specification provides the batch capability for insert, update and delete statements through the addBatch() and executeBatch() APIs. We should be able to take advantage of this capability to support SQL statement batching in OpenJPA.\n\nAccording to the old version of the OpenJPA manual (i.e., Kodo), statement batching was part of the initial functions. Conscious decision by BEA that this function was not contributed back to OpenJPA. We can still use this info as the implementation base with some modifications. \n\nI have completed the work for this statement batching support and the patch has been tested by CTS against Derby and DB2, OPENJPA regression test as well as our internal FVT test bucket.  The following section describes the design and implementation info. I also attached the whole design documentation and the patch in this jira. Once the design and implementation are accepted, then I will update the OPENJPA manual to include this function. Thanks,\n\nDesign and implementation:\n•\tConfiguration:\no\tBatch Limit value: \n\t0 - Disable batch support.\n\t-1 - Unlimited number of statements for a batch.\n\tAny positive number - Maximum number of statements for a batch.\no\tBy default, the batch support is based on each Dictionary to define the default batch limit. Currently only DB2 and Oracle dictionaries are set the default batch limit to 100. The default batch limit for rest of the dictionaries is set to zero (disabled).\no\tTo enable the batch support, user can specify the following property in the persistence.xml file:\n<property name=\"openjpa.jdbc.DBDictionary\" value=\"BatchLimit=25\"/>\nor\n<property name=\"openjpa.jdbc.DBDictionary\"\nvalue=\"db2(batchLimit=25)\"/>\n\n\n•\tBasic design is to cache all the insert/update/delete statements during the execution of the PreparedStatementManagerImpl.flushInternal() method. There is a cache structure which uses the LinkHashMap to maintain the order of the SQL statements for execution:\no\t_cacheSql - a LinkHashMap to store the rows that associate with one PrepareStatement. Key: SQL statement string; Value: array list of rows.\n\nDuring the PreparedStatementManagerImpl.flush() process, it will go through the cache to prepare the SQL statement; add the statement to the batch; and execute the batch when the batch limit is reached or all the rows are processed for that statement. Validate the update count after the executeBatch() method.\n\n•\tIf the batch limit =0 (disabled), execute the statement as the normal process; no need to use the batching process.  Same rule applies to the statement that only has one row, execute it as the normal process. \n•\tThe batch process will be disabled if the primary key generation is used the Identity strategy. When the GeneratedType=IDENTITY, we need to get the ID value right away for the in-memory entity to use. Therefore, we can't batch this kind of statement.\n•\tBatch exception process: a checkUpdateCount() is used to validate the batch process after the executeBatch(). According to the javadoc, there are three cases to consider:\no\tCase of EXECUTE_FAILED: (-3): \n\tThis is a failure case. If the action is UPDATE or there is FailedObject, treats it as OptimisticException. Otherwise, throws the SQLException.\n\tThis is the same process as current implementation.\no\tCase of  SUCCESS_NO_INFO: (-2): \n\tWe treat this as successful case and log the info in the log.\no\tCase of 0: \n\tIf there is a FailedObject or the action is INSERT, then throws the SQLException. Otherwise, treats it as successful case. \n\n","customfield_10010":null,"timetracking":{},"customfield_12314523":null,"customfield_12314127":null,"customfield_12314522":null,"customfield_12314126":null,"customfield_12314521":null,"customfield_12314125":null,"customfield_12314520":null,"customfield_12314124":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12371627","id":"12371627","filename":"OPENJPA-464.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-13T22:13:57.258+0000","size":26341,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12371627/OPENJPA-464.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12373561","id":"12373561","filename":"OPENJPA-464.patch2","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-18T21:08:59.251+0000","size":31557,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12373561/OPENJPA-464.patch2"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12374276","id":"12374276","filename":"OPENJPA-464.patch3","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-29T17:59:46.867+0000","size":5465,"mimeType":"application/octet-stream","content":"https://issues.apache.org/jira/secure/attachment/12374276/OPENJPA-464.patch3"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12371461","id":"12371461","filename":"statement batch design_1211.doc","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-11T22:08:34.275+0000","size":43008,"mimeType":"application/msword","content":"https://issues.apache.org/jira/secure/attachment/12371461/statement+batch+design_1211.doc"}],"customfield_12312340":null,"customfield_12314123":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12314122":null,"customfield_12314121":null,"customfield_12310041":null,"customfield_12314120":null,"customfield_12314129":null,"customfield_12314524":null,"customfield_12314128":null,"summary":"Performance improvement with Statement Batching support","customfield_12314130":null,"customfield_12310291":null,"customfield_12310290":null,"customfield_12314138":null,"customfield_12314137":null,"environment":null,"customfield_12314136":null,"customfield_12314135":null,"customfield_12311020":null,"customfield_12314134":null,"duedate":null,"customfield_12314132":null,"customfield_12314131":null,"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12550729","id":"12550729","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"body":"Attach the design document and the patch. Basically changes are in :PreparedStatmentManagerImpl, DBDictionary, DB2Dictionary and OracleDictionary. \nCurrenlty only DB2 and Oracle will take advantage of this support. If other databases which want to have this support, you can update the Dictionary to set batchLimit to some number. Follow the changes in the DB2 and Oracle Dictionaries.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-11T22:08:34.292+0000","updated":"2007-12-11T22:08:34.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12551624","id":"12551624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"body":"Attach the patch including the OPENJPA documentation changes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2007-12-13T22:13:57.474+0000","updated":"2007-12-13T22:13:57.474+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12552860","id":"12552860","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"body":"Hi Teresa,\n\nA couple quick comments on the patch: \n\n1. The implementations of   getDefaultBatchLimit() for DB2Dictionary and OracleDictionary are slightly different. Further it looks like the DB2 dictionary doesn't allow the batchLimit to be set to UNLIMITED. Is that a known issue with DB2? If so we should add that to the documentation and possibly add a message indicating that we're overriding a user setting. \n\nOn the other hand if this is not intended behavior then the dictionaries should be able to share a common method in DBDictionary. Ideally the subclass dictionaries would only need to set the default batch limit to some value, rather than re-implementing a method. \n\n2. Minor whitespace issue : \n+    }\n\n+    \n\n+\n\n+    private void processSql(String sql, RowImpl row) throws SQLException {\n\n+        ArrayList temprow;\n\n3. Please add a comment to the empty catch block in the execute method : \n+            } catch (SQLException se) {\n\n+            }\n\nThat's it for now. The only critical issue is the first one. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikedd","name":"mikedd","key":"mikedd","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Dick","active":true,"timeZone":"America/Chicago"},"created":"2007-12-18T19:05:12.433+0000","updated":"2007-12-18T19:05:12.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12557312","id":"12557312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"body":"I redo the fix based on Pinaki's suggestion to use the UpdateManager plugin. Instead of extending from the AbstractUpdateManager, the BatchConstraintUpdateManager extends from the ConstraintUpdateManager:\n\npublic class BatchingConstraintUpdateManager\n   extends ConstraintUpdateManager {\n\nI also made this update manager as the default batch update manager. User can still plugin their own Batch mechanism through the property of  UpdateManager:\n\n<property name=\"openjpa.jdbc.UpdateManager\" \n     value=\"org.apache.openjpa.jdbc.kernel.YourOperationOrderUpdateManager\" />  \n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-09T16:43:35.847+0000","updated":"2008-01-09T16:43:35.847+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12559696","id":"12559696","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"body":"Hello Teresa,\n  Thank you for considering to separate batching logic in a separate UpdateManager.\n\n  Comments on the patch\n 1. Two separate methods on DBDictionary\n    validateBatchProcess(...);\n    validateDBSpecificBatchProcess(...)\n    is not necessary.\n    A single method validateBatchProcess(...) is sufficient.\n    If specific database wants to augment or change the validation logic they should overwrite this method calling super.validateBatchProcess(...) if necessary. \n    \n  2. A single 'batchLimit' should be able to account for different sitauations. Instead I see two separate varaibles and some logic that does not appear necessary. But I have not comb through it. May be you should elaborate what is the intention of BATCH_LIMIT_NOT_SET and defaultBatchLimit.\n\n  3. As you are changing default UpdateManager, it may be worthwhile to mention in the document that alias 'constraint' will activate ConstraintUpdateManager","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-01-16T22:40:08.046+0000","updated":"2008-01-16T22:40:08.046+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12559710","id":"12559710","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"body":"I read your original posting again to see your usage of batch limit. \nWhy not have a single batch limit bean-style property defined in DBDictionary?\nAlso in \nDBDictionary.validateBatchProcess() {\n  if (getBatchLimit()<-1) return false;\n  // other auto-assign logic\n}\n\n1. You will not require to define batch limit for individual database dictionaries\n2. the concept of batch_limit_unset is not required. Just interpret any number less that -1 as an indication of switching off batching. Interpret -1 as maximum.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ppoddar%40apache.org","name":"ppoddar@apache.org","key":"ppoddar@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pinaki Poddar","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-01-16T22:47:00.098+0000","updated":"2008-01-16T22:47:00.098+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12560545","id":"12560545","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"body":"Append the patch2 based on Pinaki's suggestion:\n1) restructure the BatchingConstraintUpdateManager to extend ConstraintUpdateManager.\n2) Default will be 0,but can be overriden by each DB Dictionary''s constructor. Currently only DB2Dictionary and OracleDictionary constructors have set the default limit to 100. The rest of the Dictionaries will be zero.\n\nThanks,\nTeresa","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-18T21:08:59.385+0000","updated":"2008-01-18T21:08:59.385+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12563596","id":"12563596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"body":"Provided the batching capability for the OperationOrderUpdateManager. Attach the patch for this support.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tckan1","name":"tckan1","key":"tckan1","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Teresa Kan","active":true,"timeZone":"Etc/UTC"},"created":"2008-01-29T17:59:47.085+0000","updated":"2008-01-29T17:59:47.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12384438/comment/12586997","id":"12586997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yves.galante","name":"yves.galante","key":"yves.galante","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yves Galante","active":true,"timeZone":"Etc/UTC"},"body":"On your document you write : \n\"Batch exception process: a checkUpdateCount() is used to validate the batch process after the executeBatch().\"\nAnd after :\n\"Case of  SUCCESS_NO_INFO: (-2): We treat this as successful case and log the info in the log\"\n\nOracle drivers return -2 :-((\n\nWe have 3 choices :\n1)\nUse bach update with Oracle only for Insert SQL command (if return -2 we can't having more than one insert all is rigth).\nWe need an others configuration parameter, one for update/delete and one for active insert batch mode.\n2)\nUse \"Oralce batching mode\", with special oracle class on the drivers ojdbc5.jar, this batching class return the correct number of rows updated. But we need oracle5.jar to building your projet :-((\n3)\nExecute an select for count the number of rows updated or deleted, with :\nFor update :\n  select count(*) where id = XX and version = XX .\nFor delete\n  select count(*) where id = XX\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yves.galante","name":"yves.galante","key":"yves.galante","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yves Galante","active":true,"timeZone":"Etc/UTC"},"created":"2008-04-08T22:59:10.345+0000","updated":"2008-04-08T22:59:10.345+0000"}],"maxResults":9,"total":9,"startAt":0},"customfield_12311820":"0|i0z233:","customfield_12314139":null}}

