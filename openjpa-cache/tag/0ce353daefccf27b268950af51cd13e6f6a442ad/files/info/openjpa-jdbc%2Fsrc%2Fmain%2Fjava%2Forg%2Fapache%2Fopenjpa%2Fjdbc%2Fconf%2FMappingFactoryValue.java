{"sha":"1055fcfd07b4635fcdf9dd880efc6ef25697dcf5","node_id":"MDQ6QmxvYjIwNjM2NDoxMDU1ZmNmZDA3YjQ2MzVmY2RmOWRkODgwZWZjNmVmMjU2OTdkY2Y1","size":5968,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1055fcfd07b4635fcdf9dd880efc6ef25697dcf5","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmNvbmY7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLk1ldGFEYXRhUGx1c01hcHBpbmdGYWN0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuUGx1Z2lu\nVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFGYWN0\nb3J5OwoKLyoqCiAqIEhhbmRsZXMgdGhlIGNvbXBsZXggbG9naWMgb2YgY3Jl\nYXRpbmcgYSB7QGxpbmsgTWV0YURhdGFGYWN0b3J5fSBmb3IKICogY29tYmlu\nZWQgbWV0YWRhdGEgYW5kIG1hcHBpbmcuCiAqCiAqIEBhdXRob3IgQWJlIFdo\naXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBNYXBwaW5nRmFj\ndG9yeVZhbHVlCiAgICBleHRlbmRzIFBsdWdpblZhbHVlIHsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5m\nb3JQYWNrYWdlCiAgICAgICAgKE1hcHBpbmdGYWN0b3J5VmFsdWUuY2xhc3Mp\nOwoKICAgIHByaXZhdGUgU3RyaW5nW10gX21ldGFGYWN0b3J5RGVmYXVsdHMg\nPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmdbXSBfbWFwcGVkTWV0YUZhY3Rv\ncnlEZWZhdWx0cyA9IG51bGw7CgogICAgcHVibGljIE1hcHBpbmdGYWN0b3J5\nVmFsdWUoU3RyaW5nIHByb3ApIHsKICAgICAgICBzdXBlcihwcm9wLCBmYWxz\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IHNldHRpbmcgZm9y\nIGEgZ2l2ZW4gPGNvZGU+TWV0YURhdGFGYWN0b3J5PC9jb2RlPiBhbGlhcyBz\nZXR0aW5nLgogICAgICogSWYgYSA8Y29kZT5NYXBwaW5nRmFjdG9yeTwvY29k\nZT4gdmFsdWUgaXMgbm90IHN1cHBsaWVkLCB3ZSBjaGVjayB0aGVzZQogICAg\nICogZGVmYXVsdHMgYWdhaW5zdCB0aGUgPGNvZGU+TWV0YURhdGFGYWN0b3J5\nPC9jb2RlPiBzZXR0aW5nLiBJZiB0aGUKICAgICAqIDxjb2RlPk1ldGFEYXRh\nRmFjdG9yeTwvY29kZT4gZG9lcyBub3QgaGF2ZSBhIGRlZmF1bHQsIHdlIGFz\nc3VtZSBpdAogICAgICogaGFuZGxlcyBib3RoIG1ldGFkYXRhIGFuZCBtYXBw\naW5nIGZhY3RvcnkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1ldGFE\nYXRhRmFjdG9yeURlZmF1bHQoU3RyaW5nIG1ldGFBbGlhcywKICAgICAgICBT\ndHJpbmcgbWFwcGluZ0FsaWFzKSB7CiAgICAgICAgX21ldGFGYWN0b3J5RGVm\nYXVsdHMgPSBzZXRBbGlhcyhtZXRhQWxpYXMsIG1hcHBpbmdBbGlhcywKICAg\nICAgICAgICAgX21ldGFGYWN0b3J5RGVmYXVsdHMpOwogICAgfQoKICAgIC8q\nKgogICAgICogSWYgdGhlIDxjb2RlPk1hcHBpbmc8L2NvZGU+IHByb3BlcnR5\nIGlzIHNldCwgd2UgY2hlY2sgdGhlc2UgZGVmYXVsdHMKICAgICAqIGJlZm9y\nZSBjaGVja2luZyBtZXRhZGF0YSBmYWN0b3J5IGRlZmF1bHRzLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRNYXBwZWRNZXRhRGF0YUZhY3RvcnlEZWZh\ndWx0KFN0cmluZyBtZXRhQWxpYXMsCiAgICAgICAgU3RyaW5nIG1hcHBpbmdB\nbGlhcykgewogICAgICAgIF9tYXBwZWRNZXRhRmFjdG9yeURlZmF1bHRzID0g\nc2V0QWxpYXMobWV0YUFsaWFzLCBtYXBwaW5nQWxpYXMsCiAgICAgICAgICAg\nIF9tYXBwZWRNZXRhRmFjdG9yeURlZmF1bHRzKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEludGFudGlhdGUgYSB7QGxpbmsgTWV0YURhdGFGYWN0b3J5fSBy\nZXNwb25zaWJsZSBmb3IgYm90aCBtZXRhZGF0YSBhbmQKICAgICAqIG1hcHBp\nbmcuCiAgICAgKi8KICAgIHB1YmxpYyBNZXRhRGF0YUZhY3RvcnkgaW5zdGFu\ndGlhdGVNZXRhRGF0YUZhY3RvcnkoQ29uZmlndXJhdGlvbiBjb25mLAogICAg\nICAgIFBsdWdpblZhbHVlIG1ldGFQbHVnaW4sIFN0cmluZyBtYXBwaW5nKSB7\nCiAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlTWV0YURhdGFGYWN0b3J5KGNv\nbmYsIG1ldGFQbHVnaW4sIG1hcHBpbmcsIHRydWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogSW50YW50aWF0ZSBhIHtAbGluayBNZXRhRGF0YUZhY3Rvcnl9\nIHJlc3BvbnNpYmxlIGZvciBib3RoIG1ldGFkYXRhIGFuZAogICAgICogbWFw\ncGluZy4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRhRmFjdG9yeSBpbnN0\nYW50aWF0ZU1ldGFEYXRhRmFjdG9yeShDb25maWd1cmF0aW9uIGNvbmYsCiAg\nICAgICAgUGx1Z2luVmFsdWUgbWV0YVBsdWdpbiwgU3RyaW5nIG1hcHBpbmcs\nIGJvb2xlYW4gZmF0YWwpIHsKICAgICAgICBTdHJpbmcgY2xzTmFtZSA9IGdl\ndENsYXNzTmFtZSgpOwogICAgICAgIFN0cmluZyBwcm9wcyA9IGdldFByb3Bl\ncnRpZXMoKTsKICAgICAgICBTdHJpbmcgbWV0YUNsc05hbWUgPSBtZXRhUGx1\nZ2luLmdldENsYXNzTmFtZSgpOwogICAgICAgIFN0cmluZyBtZXRhUHJvcHMg\nPSBtZXRhUGx1Z2luLmdldFByb3BlcnRpZXMoKTsKCiAgICAgICAgLy8gaWYg\nbm8gbWFwcGluZyBmYWN0b3J5IHNldCwgY2hlY2sgZm9yIGRlZmF1bHQgZm9y\nIHRoaXMgZmFjdG9yeQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5\nKGNsc05hbWUpKSB7CiAgICAgICAgICAgIFN0cmluZyBkZWY7CiAgICAgICAg\nICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShtYXBwaW5nKSkgewogICAg\nICAgICAgICAgICAgZGVmID0gdW5hbGlhcyhtZXRhUGx1Z2luLmFsaWFzKG1l\ndGFDbHNOYW1lKSwKICAgICAgICAgICAgICAgICAgICBfbWFwcGVkTWV0YUZh\nY3RvcnlEZWZhdWx0cywgdHJ1ZSk7CiAgICAgICAgICAgICAgICBpZiAoZGVm\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY2xzTmFtZSA9IHVuYWxp\nYXMoZGVmKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eShjbHNOYW1lKSkgewogICAgICAgICAgICAgICAgZGVm\nID0gdW5hbGlhcyhtZXRhUGx1Z2luLmFsaWFzKG1ldGFDbHNOYW1lKSwKICAg\nICAgICAgICAgICAgICAgICBfbWV0YUZhY3RvcnlEZWZhdWx0cywgdHJ1ZSk7\nCiAgICAgICAgICAgICAgICBpZiAoZGVmICE9IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgY2xzTmFtZSA9IHVuYWxpYXMoZGVmKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgLy8gaWYgbWFwcGluZyBmYWN0b3J5IGFu\nZCBtZXRhZGF0YSBmYWN0b3J5IHRoZSBzYW1lLCBjb21iaW5lCiAgICAgICAg\nLy8gaW50byBtZXRhZGF0YSBmYWN0b3J5CiAgICAgICAgaWYgKGNsc05hbWUg\nIT0gbnVsbCAmJiBjbHNOYW1lLmVxdWFscyhtZXRhQ2xzTmFtZSkpIHsKICAg\nICAgICAgICAgaWYgKHByb3BzICE9IG51bGwgJiYgbWV0YVByb3BzID09IG51\nbGwpCiAgICAgICAgICAgICAgICBtZXRhUHJvcHMgPSBwcm9wczsKICAgICAg\nICAgICAgZWxzZSBpZiAocHJvcHMgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIG1ldGFQcm9wcyArPSAiLCIgKyBwcm9wczsKICAgICAgICAgICAgY2xzTmFt\nZSA9IG51bGw7CiAgICAgICAgICAgIHByb3BzID0gbnVsbDsKICAgICAgICB9\nCgogICAgICAgIC8vIGluc3RhbnRpYXRlIGZhY3RvcmllcwogICAgICAgIE1l\ndGFEYXRhRmFjdG9yeSBtYXAgPSAoTWV0YURhdGFGYWN0b3J5KSBuZXdJbnN0\nYW5jZShjbHNOYW1lLAogICAgICAgICAgICBNZXRhRGF0YUZhY3RvcnkuY2xh\nc3MsIGNvbmYsIGZhdGFsKTsKICAgICAgICBNZXRhRGF0YUZhY3RvcnkgbWV0\nYTsKICAgICAgICBpZiAobWFwICE9IG51bGwKICAgICAgICAgICAgJiYgbWFw\nLmdldENsYXNzKCkuZ2V0TmFtZSgpLmluZGV4T2YoIkRlcHJlY2F0ZWQiKSAh\nPSAtMSkgewogICAgICAgICAgICAvLyBkZXByZWNhdGVkIG1hcHBpbmcgZmFj\ndG9yaWVzIHRha2Ugb3ZlciBtZXRhZGF0YSB0b28sIHNvIHdlIGhhdmUKICAg\nICAgICAgICAgLy8gdG8gc3BlY2lhbC1jYXNlIHRoZW0gdG8gdHJlYXQgdGhl\nbSBsaWtlIG1ldGFkYXRhIGZhY3Rvcnkgb25seQogICAgICAgICAgICBtZXRh\nID0gbWFwOwogICAgICAgICAgICBtYXAgPSBudWxsOwogICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgIG1ldGEgPSAoTWV0YURhdGFGYWN0b3J5KSBtZXRh\nUGx1Z2luLm5ld0luc3RhbmNlCiAgICAgICAgICAgICAgICAobWV0YUNsc05h\nbWUsIE1ldGFEYXRhRmFjdG9yeS5jbGFzcywgY29uZiwgZmF0YWwpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gY29uZmlndXJlIGZhY3Rvcmllcy4gIGlmIG9u\nbHkgbWV0YSBmYWN0b3J5LCBhbGxvdyB1c2VyIHRvIHNwZWNpZnkKICAgICAg\nICAvLyBpdHMgbWFwcGluZyBwcm9wZXJ0aWVzIGluIHRoZSBtYXBwaW5nIGZh\nY3Rvcnkgc2V0dGluZwogICAgICAgIGlmIChtYXAgPT0gbnVsbCAmJiBwcm9w\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChtZXRhUHJvcHMgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIG1ldGFQcm9wcyA9IHByb3BzOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBtZXRhUHJvcHMgKz0gIiwgIiAr\nIHByb3BzOwogICAgICAgIH0KICAgICAgICBDb25maWd1cmF0aW9ucy5jb25m\naWd1cmVJbnN0YW5jZShtYXAsIGNvbmYsIHByb3BzLAogICAgICAgICAgICAo\nZmF0YWwpID8gZ2V0UHJvcGVydHkoKSA6IG51bGwpOwogICAgICAgIENvbmZp\nZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKG1ldGEsIGNvbmYsIG1ldGFQ\ncm9wcywKICAgICAgICAgICAgKGZhdGFsKSA/IG1ldGFQbHVnaW4uZ2V0UHJv\ncGVydHkoKSA6IG51bGwpOwoKICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRM\nb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKTsKICAgICAgICBp\nZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgbG9nLnRy\nYWNlKF9sb2MuZ2V0KCJtZXRhLWZhY3RvcnkiLCBtZXRhKSk7CiAgICAgICAg\nICAgIGlmIChtYXAgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShfbG9jLmdldCgibWFwLWZhY3RvcnkiLCBtYXApKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIGlmIG5vIG1hcHBpbmcgc2V0dGluZywgcmV0dXJuIG1ldGEg\nZmFjdG9yeSBhbG9uZSwgYXNzdW1pbmcgaXQgaGFuZGxlcwogICAgICAgIC8v\nIGJvdGggbWV0YWRhdGEgYW5kIG1hcHBpbmcKICAgICAgICBNZXRhRGF0YUZh\nY3RvcnkgcmV0ID0gKG1hcCA9PSBudWxsKSA/IG1ldGEKICAgICAgICAgICAg\nOiBuZXcgTWV0YURhdGFQbHVzTWFwcGluZ0ZhY3RvcnkobWV0YSwgbWFwKTsK\nICAgICAgICByZXR1cm4gcmV0OwogICAgfQp9Cg==\n","encoding":"base64"}

