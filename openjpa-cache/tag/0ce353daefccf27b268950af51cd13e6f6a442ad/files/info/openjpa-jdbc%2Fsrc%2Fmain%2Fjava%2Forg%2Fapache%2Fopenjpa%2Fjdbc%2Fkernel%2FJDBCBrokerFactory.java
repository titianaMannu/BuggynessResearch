{"sha":"0abb8a9c06a7f83c7fe62ee16e0e0a04616b406a","node_id":"MDQ6QmxvYjIwNjM2NDowYWJiOGE5YzA2YTdmODNjN2ZlNjJlZTE2ZTBlMGEwNDYxNmI0MDZh","size":5621,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0abb8a9c06a7f83c7fe62ee16e0e0a04616b406a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbDsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlz\nOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpE\nQkNDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuTWFwcGluZ1Rvb2w7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLkFic3RyYWN0QnJva2VyRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQm9vdHN0cmFwOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXJJbXBsOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5TdG9yZU1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvblByb3Zp\nZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZp\nZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVz\nZXJFeGNlcHRpb247CgovKioKICogQnJva2VyRmFjdG9yeSB0eXBlIGZvciB1\nc2Ugd2l0aCB0aGUgSkRCQyBydW50aW1lLgogKgogKiBAYXV0aG9yIEFiZSBX\naGl0ZQogKiBAYXV0aG9yIE1hcmMgUHJ1ZCdob21tZWF1eAogKi8KcHVibGlj\nIGNsYXNzIEpEQkNCcm9rZXJGYWN0b3J5CiAgICBleHRlbmRzIEFic3RyYWN0\nQnJva2VyRmFjdG9yeSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChK\nREJDQnJva2VyRmFjdG9yeS5jbGFzcyk7CgogICAgcHJpdmF0ZSBib29sZWFu\nIF9zeW5jaHJvbml6ZWRNYXBwaW5ncyA9IGZhbHNlOwoKICAgIC8qKgogICAg\nICogRmFjdG9yeSBtZXRob2QgZm9yIGNvbnN0cnVjdGluZyBhIGZhY3Rvcnkg\nZnJvbSBwcm9wZXJ0aWVzLiBJbnZva2VkIGZyb20KICAgICAqIHtAbGluayBC\nb290c3RyYXAjbmV3QnJva2VyRmFjdG9yeX0uCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgSkRCQ0Jyb2tlckZhY3RvcnkgbmV3SW5zdGFuY2UoQ29uZmln\ndXJhdGlvblByb3ZpZGVyIGNwKSB7CiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRp\nb25JbXBsIGNvbmYgPSBuZXcgSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAg\nICAgICAgY3Auc2V0SW50byhjb25mKTsKICAgICAgICByZXR1cm4gbmV3IEpE\nQkNCcm9rZXJGYWN0b3J5KGNvbmYpOwogICAgfQoKICAgIC8qKgogICAgICog\nRmFjdG9yeSBtZXRob2QgZm9yIG9idGFpbmluZyBhIHBvc3NpYmx5LXBvb2xl\nZCBmYWN0b3J5IGZyb20gcHJvcGVydGllcy4KICAgICAqIEludm9rZWQgZnJv\nbSB7QGxpbmsgQm9vdHN0cmFwI2dldEJyb2tlckZhY3Rvcnl9LgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIEpEQkNCcm9rZXJGYWN0b3J5IGdldEluc3Rh\nbmNlKENvbmZpZ3VyYXRpb25Qcm92aWRlciBjcCkgewogICAgICAgIEpEQkNC\ncm9rZXJGYWN0b3J5IGZhY3RvcnkgPSAoSkRCQ0Jyb2tlckZhY3RvcnkpIGdl\ndFBvb2xlZEZhY3RvcnkKICAgICAgICAgICAgKGNwLmdldFByb3BlcnRpZXMo\nKSk7CiAgICAgICAgaWYgKGZhY3RvcnkgIT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIGZhY3Rvcnk7CgogICAgICAgIGZhY3RvcnkgPSBuZXdJbnN0YW5j\nZShjcCk7CiAgICAgICAgZmFjdG9yeS5wb29sKCk7CiAgICAgICAgcmV0dXJu\nIGZhY3Rvcnk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGYWN0b3J5IG1ldGhv\nZCBmb3IgY29uc3RydWN0aW5nIGEgZmFjdG9yeSBmcm9tIGEgY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBzeW5jaHJvbml6ZWQg\nSkRCQ0Jyb2tlckZhY3RvcnkgZ2V0SW5zdGFuY2UKICAgICAgICAoSkRCQ0Nv\nbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIEpEQkNCcm9rZXJGYWN0b3J5\nIGZhY3RvcnkgPSAoSkRCQ0Jyb2tlckZhY3RvcnkpIGdldFBvb2xlZEZhY3Rv\ncnkKICAgICAgICAgICAgKGNvbmYudG9Qcm9wZXJ0aWVzKGZhbHNlKSk7CiAg\nICAgICAgaWYgKGZhY3RvcnkgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIGZhY3Rvcnk7CgogICAgICAgIGZhY3RvcnkgPSBuZXcgSkRCQ0Jyb2tlckZh\nY3RvcnkoY29uZik7CiAgICAgICAgZmFjdG9yeS5wb29sKCk7CiAgICAgICAg\ncmV0dXJuIGZhY3Rvcnk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1\nY3QgdGhlIGZhY3Rvcnkgd2l0aCB0aGUgZ2l2ZW4gb3B0aW9uIHNldHRpbmdz\nOyBob3dldmVyLCB0aGUKICAgICAqIGZhY3RvcnkgY29uc3RydWN0aW9uIG1l\ndGhvZHMgYXJlIHJlY29tbWVuZGVkLgogICAgICovCiAgICBwdWJsaWMgSkRC\nQ0Jyb2tlckZhY3RvcnkoSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAg\nICAgIHN1cGVyKGNvbmYpOwogICAgfQoKICAgIHB1YmxpYyBQcm9wZXJ0aWVz\nIGdldFByb3BlcnRpZXMoKSB7CiAgICAgICAgLy8gYWRkIHBsYXRmb3JtIHBy\nb3BlcnR5CiAgICAgICAgUHJvcGVydGllcyBwcm9wcyA9IHN1cGVyLmdldFBy\nb3BlcnRpZXMoKTsKICAgICAgICBTdHJpbmcgZGIgPSAiVW5rbm93biI7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiA9IChKREJDQ29uZmlndXJhdGlvbikgZ2V0Q29uZmlndXJhdGlvbigpOwog\nICAgICAgICAgICBkYiA9IGNvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKS5wbGF0Zm9ybTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9u\nIHJlKSB7CiAgICAgICAgfQogICAgICAgIHByb3BzLnNldFByb3BlcnR5KCJQ\nbGF0Zm9ybSIsCiAgICAgICAgICAgICJPcGVuSlBBIEpEQkMgRWRpdGlvbjog\nIiArIGRiICsgIiBEYXRhYmFzZSIpOwoKICAgICAgICByZXR1cm4gcHJvcHM7\nCiAgICB9CgogICAgcHJvdGVjdGVkIFN0b3JlTWFuYWdlciBuZXdTdG9yZU1h\nbmFnZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBKREJDU3RvcmVNYW5hZ2Vy\nKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIEJyb2tlckltcGwgbmV3QnJva2Vy\nSW1wbChTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MpIHsKICAgICAgICBCcm9r\nZXJJbXBsIGJyb2tlciA9IHN1cGVyLm5ld0Jyb2tlckltcGwodXNlciwgcGFz\ncyk7CgogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICAvLyBzeW5jaHJvbml6ZSBtYXBwaW5nczsgd2Ugd2FpdCB1bnRpbCBub3cg\ndG8gZG8gdGhpcyBzbyB0aGF0CiAgICAgICAgICAgIC8vIHdlIGNhbiB1c2Ug\ndGhlIGZpcnN0IGJyb2tlciB1c2VyL3Bhc3MgZm9yIGNvbm5lY3Rpb24gaWYg\nbm8KICAgICAgICAgICAgLy8gZ2xvYmFsIGxvZ2luIGlzIGdpdmVuCiAgICAg\nICAgICAgIGlmICghX3N5bmNocm9uaXplZE1hcHBpbmdzKSB7CiAgICAgICAg\nICAgICAgICBfc3luY2hyb25pemVkTWFwcGluZ3MgPSB0cnVlOwogICAgICAg\nICAgICAgICAgc3luY2hyb25pemVNYXBwaW5ncyhicm9rZXIuZ2V0Q2xhc3NM\nb2FkZXIoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBi\ncm9rZXI7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2Nr\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25p\nemUgdGhlIG1hcHBpbmdzIG9mIHRoZSBjbGFzc2VzIGxpc3RlZCBpbiB0aGUg\nY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHN5bmNo\ncm9uaXplTWFwcGluZ3MoQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAg\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikg\nZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIFN0cmluZyBhY3Rpb24gPSBj\nb25mLmdldFN5bmNocm9uaXplTWFwcGluZ3MoKTsKICAgICAgICBpZiAoU3Ry\naW5nVXRpbHMuaXNFbXB0eShhY3Rpb24pKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIENvbGxlY3Rpb24gY2xhc3NlcyA9IGNvbmYuZ2V0TWV0YURh\ndGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4KICAgICAgICAgICAgbG9hZFBlcnNp\nc3RlbnRUeXBlcyhmYWxzZSwgbG9hZGVyKTsKICAgICAgICBpZiAoY2xhc3Nl\ncy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgU3Ry\naW5nIHByb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhhY3Rp\nb24pOwogICAgICAgIGFjdGlvbiA9IENvbmZpZ3VyYXRpb25zLmdldENsYXNz\nTmFtZShhY3Rpb24pOwogICAgICAgIE1hcHBpbmdUb29sIHRvb2wgPSBuZXcg\nTWFwcGluZ1Rvb2woY29uZiwgYWN0aW9uLCBmYWxzZSk7CiAgICAgICAgQ29u\nZmlndXJhdGlvbnMuY29uZmlndXJlSW5zdGFuY2UodG9vbCwgY29uZiwgcHJv\ncHMsCiAgICAgICAgICAgICJTeW5jaHJvbml6ZU1hcHBpbmdzIik7CgogICAg\nICAgIC8vIGluaXRpYWxpemUgdGhlIHNjaGVtYQogICAgICAgIENsYXNzIGNs\nczsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNsYXNzZXMuaXRlcmF0\nb3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgY2xzID0gKENs\nYXNzKSBpdHIubmV4dCgpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgdG9vbC5ydW4oY2xzKTsKICAgICAgICAgICAgfSBjYXRjaCAoSWxs\nZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlhZSkgewogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1zeW5jaC1t\nYXBwaW5ncyIsCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLCBBcnJheXMu\nYXNMaXN0KE1hcHBpbmdUb29sLkFDVElPTlMpKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgdG9vbC5yZWNvcmQoKTsKICAgIH0KfQo=\n","encoding":"base64"}

