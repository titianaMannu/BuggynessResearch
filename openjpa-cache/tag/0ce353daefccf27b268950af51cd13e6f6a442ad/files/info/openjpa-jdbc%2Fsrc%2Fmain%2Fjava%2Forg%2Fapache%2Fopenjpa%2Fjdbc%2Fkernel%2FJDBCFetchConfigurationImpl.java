{"sha":"3ef8f704355418ca2c2c2ef382aebb3067dcf1e9","node_id":"MDQ6QmxvYjIwNjM2NDozZWY4ZjcwNDM1NTQxOGNhMmMyYzJlZjM4MmFlYmIzMDY3ZGNmMWU5","size":10453,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3ef8f704355418ca2c2c2ef382aebb3067dcf1e9","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbDsKCmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6\nYWJsZTsKaW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25z\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFz\nc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZl\ndGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5yb3AuRWFnZXJSZXN1bHRMaXN0OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuTGlzdFJlc3VsdE9iamVjdFBy\nb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuUmVz\ndWx0TGlzdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJl\nc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5yb3AuU2ltcGxlUmVzdWx0TGlzdDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIucm9wLlNvZnRSYW5kb21BY2Nlc3NSZXN1bHRMaXN0Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuV2luZG93UmVzdWx0\nTGlzdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2Nh\nbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1l\ndGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4\nY2VwdGlvbjsKCi8qKgogKiBKREJDIGV4dGVuc2lvbnMgdG8gT3BlbkpQQSdz\nIHtAbGluayBGZXRjaENvbmZpZ3VyYXRpb259LgogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgSkRCQ0Zl\ndGNoQ29uZmlndXJhdGlvbkltcGwKICAgIGV4dGVuZHMgRmV0Y2hDb25maWd1\ncmF0aW9uSW1wbAogICAgaW1wbGVtZW50cyBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xv\nYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb25JbXBsLmNsYXNzKTsKCiAgICAvKioKICAgICAqIENvbmZp\nZ3VyYWJsZSBKREJDIHN0YXRlIHNoYXJlZCB0aHJvdWdob3V0IGEgdHJhdmVy\nc2FsIGNoYWluLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBK\nREJDQ29uZmlndXJhdGlvblN0YXRlIGltcGxlbWVudHMgU2VyaWFsaXphYmxl\nIHsKICAgICAgICBwdWJsaWMgaW50IGVhZ2VyTW9kZSA9IDA7CiAgICAgICAg\ncHVibGljIGludCBzdWJjbGFzc01vZGUgPSAwOwogICAgICAgIHB1YmxpYyBp\nbnQgdHlwZSA9IDA7CiAgICAgICAgcHVibGljIGludCBkaXJlY3Rpb24gPSAw\nOwogICAgICAgIHB1YmxpYyBpbnQgc2l6ZSA9IDA7CiAgICAgICAgcHVibGlj\nIGludCBzeW50YXggPSAwOwogICAgICAgIHB1YmxpYyBTZXQgam9pbnMgPSBu\ndWxsOwogICAgfQoKICAgIHByaXZhdGUgZmluYWwgSkRCQ0NvbmZpZ3VyYXRp\nb25TdGF0ZSBfc3RhdGU7CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb25JbXBsKCkgewogICAgICAgIHRoaXMobnVsbCwgbnVsbCk7CiAgICB9\nCgogICAgcHJpdmF0ZSBKREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbChDb25m\naWd1cmF0aW9uU3RhdGUgc3RhdGUsIAogICAgICAgIEpEQkNDb25maWd1cmF0\naW9uU3RhdGUganN0YXRlKSB7CiAgICAgICAgc3VwZXIoc3RhdGUpOwogICAg\nICAgIF9zdGF0ZSA9IChqc3RhdGUgPT0gbnVsbCkgPyBuZXcgSkRCQ0NvbmZp\nZ3VyYXRpb25TdGF0ZSgpIDoganN0YXRlOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBGZXRjaENvbmZpZ3VyYXRpb25JbXBsIG5ld0luc3RhbmNlKENvbmZpZ3Vy\nYXRpb25TdGF0ZSBzdGF0ZSkgewogICAgICAgIEpEQkNDb25maWd1cmF0aW9u\nU3RhdGUganN0YXRlID0gKHN0YXRlID09IG51bGwpID8gbnVsbCA6IF9zdGF0\nZTsKICAgICAgICByZXR1cm4gbmV3IEpEQkNGZXRjaENvbmZpZ3VyYXRpb25J\nbXBsKHN0YXRlLCBqc3RhdGUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndENvbnRleHQoU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAgIHN1cGVyLnNl\ndENvbnRleHQoY3R4KTsKICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25m\nID0gZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKTsKICAgICAgICBpZiAoY29uZiA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIHNldEVhZ2Vy\nRmV0Y2hNb2RlKGNvbmYuZ2V0RWFnZXJGZXRjaE1vZGVDb25zdGFudCgpKTsK\nICAgICAgICBzZXRTdWJjbGFzc0ZldGNoTW9kZShjb25mLmdldFN1YmNsYXNz\nRmV0Y2hNb2RlQ29uc3RhbnQoKSk7CiAgICAgICAgc2V0UmVzdWx0U2V0VHlw\nZShjb25mLmdldFJlc3VsdFNldFR5cGVDb25zdGFudCgpKTsKICAgICAgICBz\nZXRGZXRjaERpcmVjdGlvbihjb25mLmdldEZldGNoRGlyZWN0aW9uQ29uc3Rh\nbnQoKSk7CiAgICAgICAgc2V0TFJTU2l6ZShjb25mLmdldExSU1NpemVDb25z\ndGFudCgpKTsKICAgICAgICBzZXRKb2luU3ludGF4KGNvbmYuZ2V0REJEaWN0\naW9uYXJ5SW5zdGFuY2UoKS5qb2luU3ludGF4KTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBjb3B5KEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAg\nICAgIHN1cGVyLmNvcHkoZmV0Y2gpOwogICAgICAgIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gamYgPSAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikgZmV0Y2g7\nCiAgICAgICAgc2V0RWFnZXJGZXRjaE1vZGUoamYuZ2V0RWFnZXJGZXRjaE1v\nZGUoKSk7CiAgICAgICAgc2V0U3ViY2xhc3NGZXRjaE1vZGUoamYuZ2V0U3Vi\nY2xhc3NGZXRjaE1vZGUoKSk7CiAgICAgICAgc2V0UmVzdWx0U2V0VHlwZShq\nZi5nZXRSZXN1bHRTZXRUeXBlKCkpOwogICAgICAgIHNldEZldGNoRGlyZWN0\naW9uKGpmLmdldEZldGNoRGlyZWN0aW9uKCkpOwogICAgICAgIHNldExSU1Np\nemUoamYuZ2V0TFJTU2l6ZSgpKTsKICAgICAgICBzZXRKb2luU3ludGF4KGpm\nLmdldEpvaW5TeW50YXgoKSk7CiAgICAgICAgYWRkSm9pbnMoamYuZ2V0Sm9p\nbnMoKSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRFYWdlckZldGNoTW9k\nZSgpIHsKICAgICAgICByZXR1cm4gX3N0YXRlLmVhZ2VyTW9kZTsKICAgIH0K\nCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRFYWdlckZl\ndGNoTW9kZShpbnQgbW9kZSkgewogICAgICAgIGlmIChtb2RlID09IERFRkFV\nTFQpIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdl\ndEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGlmIChjb25mICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBtb2RlID0gY29uZi5nZXRFYWdlckZl\ndGNoTW9kZUNvbnN0YW50KCk7CiAgICAgICAgfQogICAgICAgIGlmIChtb2Rl\nICE9IERFRkFVTFQpCiAgICAgICAgICAgIF9zdGF0ZS5lYWdlck1vZGUgPSBt\nb2RlOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgZ2V0U3ViY2xhc3NGZXRjaE1vZGUoKSB7CiAgICAgICAgcmV0dXJuIF9z\ndGF0ZS5zdWJjbGFzc01vZGU7CiAgICB9CgogICAgcHVibGljIGludCBnZXRT\ndWJjbGFzc0ZldGNoTW9kZShDbGFzc01hcHBpbmcgY2xzKSB7CiAgICAgICAg\naWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gX3N0YXRlLnN1\nYmNsYXNzTW9kZTsKICAgICAgICBpbnQgbW9kZSA9IGNscy5nZXRTdWJjbGFz\nc0ZldGNoTW9kZSgpOwogICAgICAgIGlmIChtb2RlID09IERFRkFVTFQpCiAg\nICAgICAgICAgIHJldHVybiBfc3RhdGUuc3ViY2xhc3NNb2RlOwogICAgICAg\nIHJldHVybiBNYXRoLm1pbihtb2RlLCBfc3RhdGUuc3ViY2xhc3NNb2RlKTsK\nICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRT\ndWJjbGFzc0ZldGNoTW9kZShpbnQgbW9kZSkgewogICAgICAgIGlmIChtb2Rl\nID09IERFRkFVTFQpIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24g\nY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGlm\nIChjb25mICE9IG51bGwpCiAgICAgICAgICAgICAgICBtb2RlID0gY29uZi5n\nZXRTdWJjbGFzc0ZldGNoTW9kZUNvbnN0YW50KCk7CiAgICAgICAgfQogICAg\nICAgIGlmIChtb2RlICE9IERFRkFVTFQpCiAgICAgICAgICAgIF9zdGF0ZS5z\ndWJjbGFzc01vZGUgPSBtb2RlOwogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIHB1YmxpYyBpbnQgZ2V0UmVzdWx0U2V0VHlwZSgpIHsKICAgICAg\nICByZXR1cm4gX3N0YXRlLnR5cGU7CiAgICB9CgogICAgcHVibGljIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gc2V0UmVzdWx0U2V0VHlwZShpbnQgdHlwZSkg\newogICAgICAgIGlmICh0eXBlID09IERFRkFVTFQpIHsKICAgICAgICAgICAg\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9u\nKCk7CiAgICAgICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAgICAgICAg\nICAgICBfc3RhdGUudHlwZSA9IGNvbmYuZ2V0UmVzdWx0U2V0VHlwZUNvbnN0\nYW50KCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS50eXBl\nID0gdHlwZTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJs\naWMgaW50IGdldEZldGNoRGlyZWN0aW9uKCkgewogICAgICAgIHJldHVybiBf\nc3RhdGUuZGlyZWN0aW9uOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uIHNldEZldGNoRGlyZWN0aW9uKGludCBkaXJlY3Rpb24p\nIHsKICAgICAgICBpZiAoZGlyZWN0aW9uID09IERFRkFVTFQpIHsKICAgICAg\nICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1\ncmF0aW9uKCk7CiAgICAgICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBfc3RhdGUuZGlyZWN0aW9uID0gY29uZi5nZXRGZXRjaERp\ncmVjdGlvbkNvbnN0YW50KCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAg\nIF9zdGF0ZS5kaXJlY3Rpb24gPSBkaXJlY3Rpb247CiAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICB9CgogICAgcHVibGljIGludCBnZXRMUlNTaXplKCkgewog\nICAgICAgIHJldHVybiBfc3RhdGUuc2l6ZTsKICAgIH0KCiAgICBwdWJsaWMg\nSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRMUlNTaXplKGludCBzaXplKSB7\nCiAgICAgICAgaWYgKHNpemUgPT0gREVGQVVMVCkgewogICAgICAgICAgICBK\nREJDQ29uZmlndXJhdGlvbiBjb25mID0gZ2V0SkRCQ0NvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICAgICAgaWYgKGNvbmYgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIF9zdGF0ZS5zaXplID0gY29uZi5nZXRMUlNTaXplQ29uc3RhbnQoKTsK\nICAgICAgICB9IGVsc2UKICAgICAgICAgICAgX3N0YXRlLnNpemUgPSBzaXpl\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nZ2V0Sm9pblN5bnRheCgpIHsKICAgICAgICByZXR1cm4gX3N0YXRlLnN5bnRh\neDsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBz\nZXRKb2luU3ludGF4KGludCBzeW50YXgpIHsKICAgICAgICBpZiAoc3ludGF4\nID09IERFRkFVTFQpIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24g\nY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGlm\nIChjb25mICE9IG51bGwpCiAgICAgICAgICAgICAgICBfc3RhdGUuc3ludGF4\nID0gY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpLmpvaW5TeW50YXg7\nCiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS5zeW50YXggPSBz\neW50YXg7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGlj\nIFJlc3VsdExpc3QgbmV3UmVzdWx0TGlzdChSZXN1bHRPYmplY3RQcm92aWRl\nciByb3ApIHsKICAgICAgICAvLyBpZiBidWlsdCBhcm91bmQgYSBsaXN0LCBq\ndXN0IHVzZSBhIHNpbXBsZSB3cmFwcGVyCiAgICAgICAgaWYgKHJvcCBpbnN0\nYW5jZW9mIExpc3RSZXN1bHRPYmplY3RQcm92aWRlcikKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBTaW1wbGVSZXN1bHRMaXN0KHJvcCk7CgogICAgICAgIC8v\nIGlmIGJ1aWx0IGFyb3VuZCBhIHBhZ2luZyBsaXN0LCB1c2UgYSB3aW5kb3cg\ncHJvdmlkZXIgd2l0aCB0aGUKICAgICAgICAvLyBzYW1lIHdpbmRvdyBzaXpl\nCiAgICAgICAgaWYgKHJvcCBpbnN0YW5jZW9mIFBhZ2luZ1Jlc3VsdE9iamVj\ndFByb3ZpZGVyKQogICAgICAgICAgICByZXR1cm4gbmV3IFdpbmRvd1Jlc3Vs\ndExpc3Qocm9wLCAoKFBhZ2luZ1Jlc3VsdE9iamVjdFByb3ZpZGVyKQogICAg\nICAgICAgICAgICAgcm9wKS5nZXRQYWdlU2l6ZSgpKTsKCiAgICAgICAgLy8g\naWYgZmV0Y2ggc2l6ZSA8IDAganVzdCByZWFkIGluIGFsbCByZXN1bHRzIGlt\nbWVkaWF0ZWx5CiAgICAgICAgaWYgKGdldEZldGNoQmF0Y2hTaXplKCkgPCAw\nKQogICAgICAgICAgICByZXR1cm4gbmV3IEVhZ2VyUmVzdWx0TGlzdChyb3Ap\nOwoKICAgICAgICAvLyBpZiBmb3dhcmQgb25seSBvciBmb3J3YXJkIGRpcmVj\ndGlvbiB1c2UgYSBmb3J3YXJkIHdpbmRvdwogICAgICAgIGlmIChfc3RhdGUu\ndHlwZSA9PSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFkKICAgICAgICAg\nICAgfHwgX3N0YXRlLmRpcmVjdGlvbiA9PSBSZXN1bHRTZXQuRkVUQ0hfRk9S\nV0FSRAogICAgICAgICAgICB8fCAhcm9wLnN1cHBvcnRzUmFuZG9tQWNjZXNz\nKCkpIHsKICAgICAgICAgICAgaWYgKGdldEZldGNoQmF0Y2hTaXplKCkgPiAw\nICYmIGdldEZldGNoQmF0Y2hTaXplKCkgPD0gNTApCiAgICAgICAgICAgICAg\nICByZXR1cm4gbmV3IFdpbmRvd1Jlc3VsdExpc3Qocm9wLCBnZXRGZXRjaEJh\ndGNoU2l6ZSgpKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBXaW5kb3dSZXN1\nbHRMaXN0KHJvcCwgNTApOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgc2tp\ncHBpbmcgYXJvdW5kIHVzZSBhIGNhY2hpbmcgcmFuZG9tIGFjY2VzcyBsaXN0\nCiAgICAgICAgaWYgKF9zdGF0ZS5kaXJlY3Rpb24gPT0gUmVzdWx0U2V0LkZF\nVENIX1VOS05PV04pCiAgICAgICAgICAgIHJldHVybiBuZXcgU29mdFJhbmRv\nbUFjY2Vzc1Jlc3VsdExpc3Qocm9wKTsKCiAgICAgICAgLy8gc2Nyb2xsaW5n\nIHJldmVyc2UuLi4ganVzdCB1c2Ugbm9uLWNhY2hpbmcgc2ltcGxlIHJlc3Vs\ndCBsaXN0CiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVSZXN1bHRMaXN0KHJv\ncCk7CiAgICB9CgogICAgcHVibGljIFNldCBnZXRKb2lucygpIHsKICAgICAg\nICByZXR1cm4gKF9zdGF0ZS5qb2lucyA9PSBudWxsKSA/IENvbGxlY3Rpb25z\nLkVNUFRZX1NFVCA6IF9zdGF0ZS5qb2luczsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNKb2luKFN0cmluZyBmaWVsZCkgewogICAgICAgIHJldHVy\nbiBfc3RhdGUuam9pbnMgIT0gbnVsbCAmJiBfc3RhdGUuam9pbnMuY29udGFp\nbnMoZmllbGQpOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGFkZEpvaW4oU3RyaW5nIGpvaW4pIHsKICAgICAgICBpZiAoU3Ry\naW5nVXRpbHMuaXNFbXB0eShqb2luKSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm51bGwtam9pbiIpKTsKICAgICAg\nICAKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naWYgKF9zdGF0ZS5qb2lucyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3N0\nYXRlLmpvaW5zID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICAgICAgX3N0YXRl\nLmpvaW5zLmFkZChqb2luKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gYWRk\nSm9pbnMoQ29sbGVjdGlvbiBqb2lucykgewogICAgICAgIGlmIChqb2lucyA9\nPSBudWxsIHx8IGpvaW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBqb2lucy5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgYWRkSm9pbigo\nU3RyaW5nKSBpdHIubmV4dCgpKTsKICAgICAgICByZXR1cm4gdGhpczsKICAg\nIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiByZW1vdmVK\nb2luKFN0cmluZyBmaWVsZCkgewogICAgICAgIGxvY2soKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpZiAoX3N0YXRlLmpvaW5zICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBfc3RhdGUuam9pbnMucmVtb3ZlKGZpZWxkKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24gcmVtb3ZlSm9pbnMoQ29sbGVjdGlvbiBq\nb2lucykgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBpZiAoX3N0YXRlLmpvaW5zICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBfc3RhdGUuam9pbnMucmVtb3ZlQWxsKGpvaW5zKTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gY2xlYXJKb2lucygpIHsKICAgICAgICBsb2NrKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9zdGF0ZS5qb2lucyAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgX3N0YXRlLmpvaW5zLmNsZWFyKCk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uIHRyYXZlcnNlSkRCQyhGaWVsZE1ldGFE\nYXRhIGZtKSB7CiAgICAgICAgcmV0dXJuIChKREJDRmV0Y2hDb25maWd1cmF0\naW9uKSB0cmF2ZXJzZShmbSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBY2Nl\nc3MgSkRCQyBjb25maWd1cmF0aW9uIGluZm9ybWF0aW9uLiBNYXkgcmV0dXJu\nIG51bGwgaWYgbm90IGEKICAgICAqIEpEQkMgYmFjay1lbmQgKHBvc3NpYmxl\nIHRvIGdldCBhIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gb24gbm9uLUpEQkMK\nICAgICAqIGJhY2sgZW5kIGluIHJlbW90ZSBjbGllbnQpLgogICAgICovCiAg\nICBwcml2YXRlIEpEQkNDb25maWd1cmF0aW9uIGdldEpEQkNDb25maWd1cmF0\naW9uKCkgewogICAgICAgIFN0b3JlQ29udGV4dCBjdHggPSBnZXRDb250ZXh0\nKCk7CiAgICAgICAgaWYgKGN0eCA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mID0g\nY3R4LmdldENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBpZiAoIShjb25mIGlu\nc3RhbmNlb2YgSkRCQ0NvbmZpZ3VyYXRpb24pKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICByZXR1cm4gKEpEQkNDb25maWd1cmF0aW9uKSBj\nb25mOwogICAgfQp9Cg==\n","encoding":"base64"}

