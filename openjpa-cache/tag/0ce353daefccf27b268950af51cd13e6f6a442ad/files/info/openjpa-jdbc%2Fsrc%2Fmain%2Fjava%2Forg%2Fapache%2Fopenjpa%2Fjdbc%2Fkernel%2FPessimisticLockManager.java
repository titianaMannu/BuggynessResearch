{"sha":"44e664bcfdfa8108eaa9284612ad58603c5645d4","node_id":"MDQ6QmxvYjIwNjM2NDo0NGU2NjRiY2ZkZmE4MTA4ZWFhOTI4NDYxMmFkNTg2MDNjNTY0NWQ0","size":6382,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/44e664bcfdfa8108eaa9284612ad58603c5645d4","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbDsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0\naW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9y\ndCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNl\ncHRpb247CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5D\nbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\ncWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNxbC5TUUxFeGNlcHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLlNlbGVjdDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5WZXJzaW9uTG9ja01hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTG9ja0V4Y2VwdGlvbjsKCi8q\nKgogKiBMb2NrIG1hbmFnZXIgdGhhdCB1c2VzIGV4Y2x1c2l2ZSBkYXRhYmFz\nZSBsb2Nrcy4KICoKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICov\nCnB1YmxpYyBjbGFzcyBQZXNzaW1pc3RpY0xvY2tNYW5hZ2VyCiAgICBleHRl\nbmRzIFZlcnNpb25Mb2NrTWFuYWdlcgogICAgaW1wbGVtZW50cyBKREJDTG9j\na01hbmFnZXIgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IExPQ0tf\nREFUQVNUT1JFX09OTFkgPSAxOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAg\nICAoUGVzc2ltaXN0aWNMb2NrTWFuYWdlci5jbGFzcyk7CgogICAgcHJpdmF0\nZSBKREJDU3RvcmUgX3N0b3JlOwoKICAgIHB1YmxpYyBQZXNzaW1pc3RpY0xv\nY2tNYW5hZ2VyKCkgewogICAgICAgIHNldFZlcnNpb25DaGVja09uUmVhZExv\nY2soZmFsc2UpOwogICAgICAgIHNldFZlcnNpb25VcGRhdGVPbldyaXRlTG9j\nayhmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29udGV4dChT\ndG9yZUNvbnRleHQgY3R4KSB7CiAgICAgICAgc3VwZXIuc2V0Q29udGV4dChj\ndHgpOwogICAgICAgIF9zdG9yZSA9IChKREJDU3RvcmUpIGN0eC5nZXRTdG9y\nZU1hbmFnZXIoKS5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIHNlbGVjdEZvclVwZGF0ZShTZWxlY3Qgc2VsLCBp\nbnQgbG9ja0xldmVsKSB7CiAgICAgICAgaWYgKGxvY2tMZXZlbCA9PSBMT0NL\nX05PTkUpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgREJE\naWN0aW9uYXJ5IGRpY3QgPSBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAg\nICAgICAgaWYgKGRpY3Quc2ltdWxhdGVMb2NraW5nKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgZGljdC5hc3NlcnRTdXBwb3J0KGRpY3Qu\nc3VwcG9ydHNTZWxlY3RGb3JVcGRhdGUsCiAgICAgICAgICAgICJTdXBwb3J0\nc1NlbGVjdEZvclVwZGF0ZSIpOwoKICAgICAgICBpZiAoIXNlbC5zdXBwb3J0\nc0xvY2tpbmcoKSkgewogICAgICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJs\nZWQoKSkKICAgICAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJjYW50\nLWxvY2stb24tbG9hZCIsCiAgICAgICAgICAgICAgICAgICAgc2VsLnRvU2Vs\nZWN0KGZhbHNlLCBudWxsKS5nZXRTUUwoKSkpOwogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBlbnN1cmVTdG9yZU1hbmFn\nZXJUcmFuc2FjdGlvbigpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGxvYWRlZEZvclVwZGF0ZShPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtKSB7CiAgICAgICAgLy8gd2Ugc2V0IGEgbG93IGxvY2sgbGV2\nZWwgdG8gaW5kaWNhdGUgdGhhdCB3ZSBkb24ndCBuZWVkIGRhdGFzdG9yZQog\nICAgICAgIC8vIGxvY2tpbmcsIGJ1dCB3ZSBkb24ndCBuZWNlc3NhcmlseSBo\nYXZlIGEgcmVhZCBvciB3cml0ZSBsb2NrCiAgICAgICAgLy8gYWNjb3JkaW5n\nIHRvIG91ciBzdXBlcmNsYXNzCiAgICAgICAgaWYgKGdldExvY2tMZXZlbChz\nbSkgPT0gTE9DS19OT05FKQogICAgICAgICAgICBzZXRMb2NrTGV2ZWwoc20s\nIExPQ0tfREFUQVNUT1JFX09OTFkpOwogICAgfQoKICAgIHByb3RlY3RlZCB2\nb2lkIGxvY2tJbnRlcm5hbChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBpbnQg\nbGV2ZWwsIGludCB0aW1lb3V0LAogICAgICAgIE9iamVjdCBzZGF0YSkgewog\nICAgICAgIC8vIHdlIGNhbiBza2lwIGFueSBhbHJlYWR5LWxvY2tlZCBpbnN0\nYW5jZSByZWdhcmRsZXNzIG9mIGxldmVsIGJlY2F1c2UKICAgICAgICAvLyB3\nZSB0cmVhdCBhbGwgbG9ja3MgdGhlIHNhbWUgKHRob3VnaCBzdXBlciBkb2Vz\nbid0KQogICAgICAgIGlmIChnZXRMb2NrTGV2ZWwoc20pID09IExPQ0tfTk9O\nRSkgewogICAgICAgICAgICAvLyBvbmx5IG5lZWQgdG8gbG9jayBpZiBub3Qg\nbG9hZGVkIGZyb20gbG9ja2luZyByZXN1bHQKICAgICAgICAgICAgQ29ubmVj\ndGlvbkluZm8gaW5mbyA9IChDb25uZWN0aW9uSW5mbykgc2RhdGE7CiAgICAg\nICAgICAgIGlmIChpbmZvID09IG51bGwgfHwgaW5mby5yZXN1bHQgPT0gbnVs\nbCB8fCAhaW5mby5yZXN1bHQuaXNMb2NraW5nKCkpCiAgICAgICAgICAgICAg\nICBsb2NrUm93KHNtLCB0aW1lb3V0KTsKICAgICAgICB9CiAgICAgICAgc3Vw\nZXIubG9ja0ludGVybmFsKHNtLCBsZXZlbCwgdGltZW91dCwgc2RhdGEpOwog\nICAgfQoKICAgIC8qKgogICAgICogTG9jayB0aGUgc3BlY2lmaWVkIGluc3Rh\nbmNlIHJvdyBieSBpc3N1aW5nIGEgIlNFTEVDVCAuLi4gRk9SIFVQREFURSIK\nICAgICAqIHN0YXRlbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGxv\nY2tSb3coT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgaW50IHRpbWVvdXQpIHsK\nICAgICAgICAvLyBhc3NlcnQgdGhhdCB0aGUgZGljdGlvbmFyeSBzdXBwb3J0\ncyB0aGUgIlNFTEVDVCAuLi4gRk9SIFVQREFURSIKICAgICAgICAvLyBjb25z\ndHJ1Y3Q7IGlmIG5vdCwgYW5kIHdlIHRoZSBhc3NlcnRpb24gZG9lcyBub3Qg\ndGhyb3cgYW4KICAgICAgICAvLyBleGNlcHRpb24sIHRoZW4ganVzdCByZXR1\ncm4gd2l0aG91dCBsb2NraW5nCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3Qg\nPSBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAgICAgaWYgKGRpY3Qu\nc2ltdWxhdGVMb2NraW5nKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nZGljdC5hc3NlcnRTdXBwb3J0KGRpY3Quc3VwcG9ydHNTZWxlY3RGb3JVcGRh\ndGUsCiAgICAgICAgICAgICJTdXBwb3J0c1NlbGVjdEZvclVwZGF0ZSIpOwoK\nICAgICAgICBPYmplY3QgaWQgPSBzbS5nZXRPYmplY3RJZCgpOwogICAgICAg\nIENsYXNzTWFwcGluZyBtYXBwaW5nID0gKENsYXNzTWFwcGluZykgc20uZ2V0\nTWV0YURhdGEoKTsKICAgICAgICB3aGlsZSAobWFwcGluZy5nZXRKb2luYWJs\nZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBudWxsKQogICAgICAgICAgICBt\nYXBwaW5nID0gbWFwcGluZy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBp\nbmcoKTsKCiAgICAgICAgLy8gc2VsZWN0IG9ubHkgdGhlIFBLIGNvbHVtbnMs\nIHNpbmNlIHdlIGp1c3Qgd2FudCB0byBsb2NrCiAgICAgICAgU2VsZWN0IHNl\nbGVjdCA9IF9zdG9yZS5nZXRTUUxGYWN0b3J5KCkubmV3U2VsZWN0KCk7CiAg\nICAgICAgc2VsZWN0LnNlbGVjdChtYXBwaW5nLmdldFByaW1hcnlLZXlDb2x1\nbW5zKCkpOwogICAgICAgIHNlbGVjdC53aGVyZVByaW1hcnlLZXkoaWQsIG1h\ncHBpbmcsIF9zdG9yZSk7CiAgICAgICAgU1FMQnVmZmVyIHNxbCA9IHNlbGVj\ndC50b1NlbGVjdCh0cnVlLCBfc3RvcmUuZ2V0RmV0Y2hDb25maWd1cmF0aW9u\nKCkpOwoKICAgICAgICBlbnN1cmVTdG9yZU1hbmFnZXJUcmFuc2FjdGlvbigp\nOwogICAgICAgIENvbm5lY3Rpb24gY29ubiA9IF9zdG9yZS5nZXRDb25uZWN0\naW9uKCk7CiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBudWxs\nOwogICAgICAgIFJlc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgc3RtbnQgPSBzcWwucHJlcGFyZVN0YXRlbWVudChjb25u\nKTsKICAgICAgICAgICAgaWYgKHRpbWVvdXQgPj0gMCAmJiBkaWN0LnN1cHBv\ncnRzUXVlcnlUaW1lb3V0KSB7CiAgICAgICAgICAgICAgICBpZiAodGltZW91\ndCA8IDEwMDApIHsKICAgICAgICAgICAgICAgICAgICB0aW1lb3V0ID0gMTAw\nMDsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQo\nIm1pbGxpcy1xdWVyeS10aW1lb3V0IikpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgc3RtbnQuc2V0UXVlcnlUaW1lb3V0KHRpbWVvdXQg\nLyAxMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBycyA9IHN0bW50\nLmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAgICBpZiAoIXJzLm5leHQoKSkK\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBMb2NrRXhjZXB0aW9uKHNtLmdl\ndE1hbmFnZWRJbnN0YW5jZSgpKTsKICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5n\nZXRTdG9yZShzZSwgZGljdCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgaWYgKHJzICE9IG51bGwpCiAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJzLmNsb3NlKCk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FM\nRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBFbmZvcmNlIHRoYXQgd2UgaGF2ZSBhbiBhY3R1\nYWwgdHJhbnNhY3Rpb24gaW4gcHJvZ3Jlc3Mgc28gdGhhdCB3ZSBjYW4KICAg\nICAqIHN0YXJ0IGxvY2tpbmcuIFRoZSB0cmFuc2FjdGlvbiBzaG91bGQgYWxy\nZWFkeSBiZSBiZWd1biB3aGVuIHVzaW5nIGEKICAgICAqIGRhdGFzdG9yZSB0\ncmFuc2FjdGlvbjsgdGhpcyB3aWxsIGp1c3QgYmUgdXNlZCBpZiB3ZSBhcmUg\nbG9ja2luZyBpbgogICAgICogb3B0aW1pc3RpYyBtb2RlLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgZW5zdXJlU3RvcmVNYW5hZ2VyVHJhbnNhY3Rpb24o\nKSB7CiAgICAgICAgaWYgKCFfc3RvcmUuZ2V0Q29udGV4dCgpLmlzU3RvcmVB\nY3RpdmUoKSkgewogICAgICAgICAgICBfc3RvcmUuZ2V0Q29udGV4dCgpLmJl\nZ2luU3RvcmUoKTsKICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgic3RhcnQt\ndHJhbnMtZm9yLWxvY2siKSk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

