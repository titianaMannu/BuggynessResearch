{"sha":"3155e7c96a51d48d7425632de2a9696cac23cf2c","node_id":"MDQ6QmxvYjIwNjM2NDozMTU1ZTdjOTZhNTFkNDhkNzQyNTYzMmRlMmE5Njk2Y2FjMjNjZjJj","size":7203,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3155e7c96a51d48d7425632de2a9696cac23cf2c","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbDsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0\naW9uOwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2\nYS5zcWwuVHlwZXM7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb25JbXBsOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdSZXBv\nc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5E\nQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNv\nbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5KYXZhVHlwZXM7CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gTk9URTogRG8g\nbm90IGNoYW5nZSBwcm9wZXJ0eSBuYW1lczsgc2VlIFNlcXVlbmNlTWV0YURh\ndGEKLy8gYW5kIFNlcXVlbmNlTWFwcGluZyBmb3Igc3RhbmRhcmQgcHJvcGVy\ndHkgbmFtZXMuCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKLyoqCiAqIFNwZWNpYWxpemF0\naW9uIG9mIHRoZSB7QGxpbmsgVGFibGVKREJDU2VxfSB0aGF0IG1haW50YWlu\ncyBtdWx0aXBsZQogKiBzZXF1ZW5jZSBjb3VudHMuIEVhY2ggaW5zdGFuY2Ug\nb2YgdGhpcyBjbGFzcyByZXByZXNlbnRzIG9uZSByb3cgd2l0aAogKiBhIGtu\nb3duIHN0cmluZyBwcmltYXJ5IGtleSB2YWx1ZSwgbW9yZSBvciBsZXNzLiBU\naGUgdGFibGUgbmFtZSBkZWZhdWx0cwogKiB0byA8Y29kZT5PUEVOSlBBX1NF\nUVVFTkNFU19UQUJMRTwvY29kZT4uCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRl\nCiAqLwpwdWJsaWMgY2xhc3MgVmFsdWVUYWJsZUpEQkNTZXEKICAgIGV4dGVu\nZHMgVGFibGVKREJDU2VxIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0\ncmluZyBQS19WQUxVRSA9ICJQcmltYXJ5S2V5VmFsdWUiOwoKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UKICAgICAgICAoVmFsdWVUYWJsZUpEQkNTZXEuY2xhc3MpOwoK\nICAgIHByaXZhdGUgU3RyaW5nIF92YWx1ZSA9ICJERUZBVUxUIjsKCiAgICBw\ndWJsaWMgVmFsdWVUYWJsZUpEQkNTZXEoKSB7CiAgICAgICAgc2V0VGFibGUo\nIk9QRU5KUEFfU0VRVUVOQ0VTX1RBQkxFIik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgcHJpbWFyeSBrZXkgdmFsdWUgZm9yIHRoaXMgcm93LiBEZWZh\ndWx0cyB0byA8Y29kZT5ERUZBVUxUPC9jb2RlPi4KICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyBnZXRQcmltYXJ5S2V5VmFsdWUoKSB7CiAgICAgICAgcmV0\ndXJuIF92YWx1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBwcmltYXJ5\nIGtleSB2YWx1ZSBmb3IgdGhpcyByb3cuIERlZmF1bHRzIHRvIDxjb2RlPkRF\nRkFVTFQ8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcmlt\nYXJ5S2V5VmFsdWUoU3RyaW5nIHZhbHVlKSB7CiAgICAgICAgX3ZhbHVlID0g\ndmFsdWU7CiAgICB9CgogICAgcHJvdGVjdGVkIENvbHVtbiBhZGRQcmltYXJ5\nS2V5Q29sdW1uKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgREJEaWN0aW9uYXJ5\nIGRpY3QgPSBnZXRDb25maWd1cmF0aW9uKCkuZ2V0REJEaWN0aW9uYXJ5SW5z\ndGFuY2UoKTsKICAgICAgICBDb2x1bW4gcGtDb2x1bW4gPSB0YWJsZS5hZGRD\nb2x1bW4oZGljdC5nZXRWYWxpZENvbHVtbk5hbWUKICAgICAgICAgICAgKGdl\ndFByaW1hcnlLZXlDb2x1bW4oKSwgdGFibGUpKTsKICAgICAgICBwa0NvbHVt\nbi5zZXRUeXBlKGRpY3QuZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5WQVJDSEFS\nKSk7CiAgICAgICAgcGtDb2x1bW4uc2V0SmF2YVR5cGUoSmF2YVR5cGVzLlNU\nUklORyk7CiAgICAgICAgcGtDb2x1bW4uc2V0U2l6ZShkaWN0LmNoYXJhY3Rl\nckNvbHVtblNpemUpOwogICAgICAgIHJldHVybiBwa0NvbHVtbjsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGdldFByaW1hcnlLZXkoQ2xhc3NNYXBw\naW5nIG1hcHBpbmcpIHsKICAgICAgICByZXR1cm4gX3ZhbHVlOwogICAgfQoK\nICAgIC8vLy8vLy8vLwogICAgLy8gTWFpbgogICAgLy8vLy8vLy8vCgogICAg\nLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5rZXJuZWwuVmFsdWVUYWJsZUpEQkNTZXEgW29wdGlvbl0qCiAgICAgKiAt\nYWN0aW9uLy1hICZsdDthZGQgfCBkcm9wIHwgZ2V0IHwgc2V0Jmd0OyBbcHJp\nbWFyeSBrZXkgdmFsdWVdIFt2YWx1ZV0KICAgICAqICBXaGVyZSB0aGUgZm9s\nbG93aW5nIG9wdGlvbnMgYXJlIHJlY29nbml6ZWQuCiAgICAgKiA8dWw+CiAg\nICAgKiA8bGk+PGk+LXByb3BlcnRpZXMvLXAgJmx0O3Byb3BlcnRpZXMgZmls\nZSBvciByZXNvdXJjZSZndDs8L2k+OiBUaGUKICAgICAqIHBhdGggb3IgcmVz\nb3VyY2UgbmFtZSBvZiBhIE9wZW5KUEEgcHJvcGVydGllcyBmaWxlIGNvbnRh\naW5pbmcKICAgICAqIGluZm9ybWF0aW9uIHN1Y2ggYXMgdGhlIGxpY2Vuc2Ug\na2V5CWFuZCBjb25uZWN0aW9uIGRhdGEgYXMKICAgICAqIG91dGxpbmVkIGlu\nIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0uIE9wdGlvbmFsLjwvbGk+CiAg\nICAgKiA8bGk+PGk+LSZsdDtwcm9wZXJ0eSBuYW1lJmd0OyAmbHQ7cHJvcGVy\ndHkgdmFsdWUmZ3Q7PC9pPjogQWxsIGJlYW4KICAgICAqIHByb3BlcnRpZXMg\nb2YgdGhlIE9wZW5KUEEge0BsaW5rIEpEQkNDb25maWd1cmF0aW9ufSBjYW4g\nYmUgc2V0IGJ5CiAgICAgKiB1c2luZyB0aGVpcgluYW1lcyBhbmQgc3VwcGx5\naW5nIGEgdmFsdWUuIEZvciBleGFtcGxlOgogICAgICogPGNvZGU+LWxpY2Vu\nc2VLZXkgYWRzbGZqYTgzcjNsa2FkZjwvY29kZT48L2xpPgogICAgICogPC91\nbD4KICAgICAqICBUaGUgdmFyaW91cyBhY3Rpb25zIGFyZSBhcyBmb2xsb3dz\nLgogICAgICogPHVsPgogICAgICogPGxpPjxpPmFkZDwvaT46IENyZWF0ZSB0\naGUgc2VxdWVuY2UgdGFibGUuPC9saT4KICAgICAqIDxsaT48aT5kcm9wPC9p\nPjogRHJvcCB0aGUgc2VxdWVuY2UgdGFibGUuPC9saT4KICAgICAqIDxsaT48\naT5nZXQ8L2k+OiBQcmludCB0aGUgY3VycmVudCBzZXF1ZW5jZSB2YWx1ZSBm\nb3IgdGhlIGdpdmVuCiAgICAgKiBwcmltYXJ5IGtleSB2YWx1ZS48L2xpPgog\nICAgICogPGxpPjxpPnNldDwvaT46IFNldCB0aGUgc2VxdWVuY2UgdmFsdWUg\nZm9yIHRoZSBnaXZlbiBwcmltYXJ5IGtleQogICAgICogdmFsdWUuPC9saT4K\nICAgICAqIDwvdWw+CiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBt\nYWluKFN0cmluZ1tdIGFyZ3MpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgT3B0aW9ucyBvcHRzID0gbmV3IE9wdGlvbnMoKTsKICAgICAg\nICBhcmdzID0gb3B0cy5zZXRGcm9tQ21kTGluZShhcmdzKTsKICAgICAgICBK\nREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IEpEQkNDb25maWd1cmF0aW9u\nSW1wbCgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICghcnVuKGNv\nbmYsIGFyZ3MsIG9wdHMpKQogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKF9sb2MuZ2V0KCJjbHN0YWJsZS1zZXEtdXNhZ2UiKSk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY29uZi5jbG9zZSgpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0\ndXJucyBmYWxzZSBpZiBpbnZhbGlkIG9wdGlvbnMgd2VyZSBnaXZlbi4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihKREJDQ29uZmln\ndXJhdGlvbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIE9wdGlvbnMg\nb3B0cykKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nb3B0cy5jb250YWluc0tleSgiaGVscCIpIHx8IG9wdHMuY29udGFpbnNLZXko\nIi1oZWxwIikpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\nU3RyaW5nIGFjdGlvbiA9IG9wdHMucmVtb3ZlUHJvcGVydHkoImFjdGlvbiIs\nICJhIiwgbnVsbCk7CiAgICAgICAgQ29uZmlndXJhdGlvbnMucG9wdWxhdGVD\nb25maWd1cmF0aW9uKGNvbmYsIG9wdHMpOwogICAgICAgIHJldHVybiBydW4o\nY29uZiwgYXJncywgYWN0aW9uLCBudWxsLCBudWxsKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJuIGZhbHNlIGlmIGFuIGlu\ndmFsaWQgb3B0aW9uIHdhcyBnaXZlbi4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBib29sZWFuIHJ1bihKREJDQ29uZmlndXJhdGlvbiBjb25mLCBTdHJp\nbmdbXSBhcmdzLAogICAgICAgIFN0cmluZyBhY3Rpb24sIE1hcHBpbmdSZXBv\nc2l0b3J5IHJlcG9zLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgVmFsdWVUYWJsZUpEQkNTZXEgc2Vx\nID0gbmV3IFZhbHVlVGFibGVKREJDU2VxKCk7CiAgICAgICAgU3RyaW5nIHBy\nb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhjb25mLmdldFNl\ncXVlbmNlKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUlu\nc3RhbmNlKHNlcSwgY29uZiwgcHJvcHMpOwoKICAgICAgICBpZiAoQUNUSU9O\nX0RST1AuZXF1YWxzKGFjdGlvbikpIHsKICAgICAgICAgICAgaWYgKGFyZ3Mu\nbGVuZ3RoICE9IDApCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgICAgIHNlcS5kcm9wVGFibGUoKTsKICAgICAgICB9IGVsc2UgaWYg\nKEFDVElPTl9BREQuZXF1YWxzKGFjdGlvbikpIHsKICAgICAgICAgICAgaWYg\nKGFyZ3MubGVuZ3RoICE9IDApCiAgICAgICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgICAgIHNlcS5yZWZyZXNoVGFibGUoKTsKICAgICAgICB9\nIGVsc2UgaWYgKEFDVElPTl9HRVQuZXF1YWxzKGFjdGlvbikgfHwgQUNUSU9O\nX1NFVC5lcXVhbHMoYWN0aW9uKSkgewogICAgICAgICAgICBpZiAoYXJncy5s\nZW5ndGggPiAwKQogICAgICAgICAgICAgICAgc2VxLnNldFByaW1hcnlLZXlW\nYWx1ZShhcmdzWzBdKTsKCiAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubiA9\nIGNvbmYuZ2V0RGF0YVNvdXJjZTIobnVsbCkuZ2V0Q29ubmVjdGlvbigpOwog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbG9uZyBjdXIgPSBz\nZXEuZ2V0U2VxdWVuY2UobnVsbCwgY29ubik7CiAgICAgICAgICAgICAgICBp\nZiAoQUNUSU9OX0dFVC5lcXVhbHMoYWN0aW9uKSkKICAgICAgICAgICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oc2VxLmdldFByaW1hcnlLZXlWYWx1\nZSgpICsgIjogIiArIGN1cik7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAg\nICAgICAgICAgICAgICAgICBsb25nIHNldDsKICAgICAgICAgICAgICAgICAg\nICBpZiAoYXJncy5sZW5ndGggPiAxKQogICAgICAgICAgICAgICAgICAgICAg\nICBzZXQgPSBMb25nLnBhcnNlTG9uZyhhcmdzWzFdKTsKICAgICAgICAgICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHNldCA9IGN1\nciArIHNlcS5nZXRBbGxvY2F0ZSgpOwogICAgICAgICAgICAgICAgICAgIGlm\nIChzZXQgPCBjdXIpCiAgICAgICAgICAgICAgICAgICAgICAgIHNldCA9IGN1\ncjsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgU3RhdHVzIHN0YXQgPSBzZXEuZ2V0U3RhdHVzKG51bGwpOwog\nICAgICAgICAgICAgICAgICAgICAgICBzZXEuc2V0U2VxdWVuY2UobnVsbCwg\nc3RhdCwgKGludCkgKHNldCAtIGN1ciksIHRydWUsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBjb25uKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nc2V0ID0gc3RhdC5zZXE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihzZXEuZ2V0UHJpbWFy\neUtleVZhbHVlKCkgKyAiOiAiICsgc2V0KTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCAoTnVtYmVyRm9ybWF0\nRXhjZXB0aW9uIG5mZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICBjb25uLmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCn0K\n","encoding":"base64"}

