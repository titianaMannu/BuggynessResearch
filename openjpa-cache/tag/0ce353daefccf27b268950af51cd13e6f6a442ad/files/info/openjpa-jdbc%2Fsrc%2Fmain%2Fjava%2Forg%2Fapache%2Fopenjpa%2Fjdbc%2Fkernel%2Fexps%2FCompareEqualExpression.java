{"sha":"d85fe8a8d3dfb45229e1826ff8c2f5655c0ca9a6","node_id":"MDQ6QmxvYjIwNjM2NDpkODVmZThhOGQzZGZiNDUyMjllMTgyNmZmOGMyZjU2NTVjMGNhOWE2","size":4344,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d85fe8a8d3dfb45229e1826ff8c2f5655c0ca9a6","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzOwoKaW1wb3J0IGphdmEudXRpbC5N\nYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1\nZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxl\nY3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVz\nc2lvblZpc2l0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBDb21wYXJlcyB0d28gdmFsdWVzIGZv\nciBlcXVhbGl0eS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCmFic3Ry\nYWN0IGNsYXNzIENvbXBhcmVFcXVhbEV4cHJlc3Npb24KICAgIGltcGxlbWVu\ndHMgRXhwIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKENvbXBhcmVF\ncXVhbEV4cHJlc3Npb24uY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgVmFs\nIF92YWwxOwogICAgcHJpdmF0ZSBmaW5hbCBWYWwgX3ZhbDI7CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IHZhbHVlcyB0byBjb21wYXJl\nLgogICAgICovCiAgICBwdWJsaWMgQ29tcGFyZUVxdWFsRXhwcmVzc2lvbihW\nYWwgdmFsMSwgVmFsIHZhbDIpIHsKICAgICAgICBfdmFsMSA9IHZhbDE7CiAg\nICAgICAgX3ZhbDIgPSB2YWwyOwogICAgfQoKICAgIHB1YmxpYyBWYWwgZ2V0\nVmFsdWUxKCkgewogICAgICAgIHJldHVybiBfdmFsMTsKICAgIH0KCiAgICBw\ndWJsaWMgVmFsIGdldFZhbHVlMigpIHsKICAgICAgICByZXR1cm4gX3ZhbDI7\nCiAgICB9CgogICAgcHVibGljIEV4cFN0YXRlIGluaXRpYWxpemUoU2VsZWN0\nIHNlbCwgRXhwQ29udGV4dCBjdHgsIE1hcCBjb250YWlucykgewogICAgICAg\nIGJvb2xlYW4gZGlyZWN0ID0gaXNEaXJlY3RDb21wYXJpc29uKCk7CiAgICAg\nICAgaW50IGZsYWdzMSA9IDA7CiAgICAgICAgaW50IGZsYWdzMiA9IDA7CiAg\nICAgICAgRXhwU3RhdGUgczEgPSBudWxsOwogICAgICAgIEV4cFN0YXRlIHMy\nID0gbnVsbDsKICAgICAgICBpZiAoX3ZhbDEgaW5zdGFuY2VvZiBDb25zdCkg\newogICAgICAgICAgICBzMSA9IF92YWwxLmluaXRpYWxpemUoc2VsLCBjdHgs\nIDApOwogICAgICAgICAgICBpZiAoZGlyZWN0ICYmICgoQ29uc3QpIF92YWwx\nKS5nZXRWYWx1ZShjdHgsIHMxKSA9PSBudWxsKQogICAgICAgICAgICAgICAg\nZmxhZ3MyID0gVmFsLk5VTExfQ01QOwogICAgICAgIH0KICAgICAgICBpZiAo\nX3ZhbDIgaW5zdGFuY2VvZiBDb25zdCkgewogICAgICAgICAgICBzMiA9IF92\nYWwyLmluaXRpYWxpemUoc2VsLCBjdHgsIDApOwogICAgICAgICAgICBpZiAo\nZGlyZWN0ICYmICgoQ29uc3QpIF92YWwyKS5nZXRWYWx1ZShjdHgsIHMyKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgZmxhZ3MxID0gVmFsLk5VTExfQ01Q\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoczEgPT0gbnVsbCkK\nICAgICAgICAgICAgczEgPSBfdmFsMS5pbml0aWFsaXplKHNlbCwgY3R4LCBm\nbGFnczEpOwogICAgICAgIGlmIChzMiA9PSBudWxsKQogICAgICAgICAgICBz\nMiA9IF92YWwyLmluaXRpYWxpemUoc2VsLCBjdHgsIGZsYWdzMik7CiAgICAg\nICAgcmV0dXJuIG5ldyBCaW5hcnlPcEV4cFN0YXRlKHNlbC5hbmQoczEuam9p\nbnMsIHMyLmpvaW5zKSwgczEsIHMyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBhcHBlbmRUbyhTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3Rh\ndGUgc3RhdGUsIAogICAgICAgIFNRTEJ1ZmZlciBidWYpIHsKICAgICAgICBC\naW5hcnlPcEV4cFN0YXRlIGJzdGF0ZSA9IChCaW5hcnlPcEV4cFN0YXRlKSBz\ndGF0ZTsKICAgICAgICBfdmFsMS5jYWxjdWxhdGVWYWx1ZShzZWwsIGN0eCwg\nYnN0YXRlLnN0YXRlMSwgX3ZhbDIsIGJzdGF0ZS5zdGF0ZTIpOwogICAgICAg\nIF92YWwyLmNhbGN1bGF0ZVZhbHVlKHNlbCwgY3R4LCBic3RhdGUuc3RhdGUy\nLCBfdmFsMSwgYnN0YXRlLnN0YXRlMSk7CiAgICAgICAgaWYgKCFGaWx0ZXJz\nLmNhbkNvbnZlcnQoX3ZhbDEuZ2V0VHlwZSgpLCBfdmFsMi5nZXRUeXBlKCks\nIGZhbHNlKQogICAgICAgICAgICAmJiAhRmlsdGVycy5jYW5Db252ZXJ0KF92\nYWwyLmdldFR5cGUoKSwgX3ZhbDEuZ2V0VHlwZSgpLCBmYWxzZSkpCiAgICAg\nICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJjYW50\nLWNvbnZlcnQiLCBfdmFsMS5nZXRUeXBlKCksCiAgICAgICAgICAgICAgICBf\ndmFsMi5nZXRUeXBlKCkpKTsKCiAgICAgICAgYm9vbGVhbiB2YWwxTnVsbCA9\nIF92YWwxIGluc3RhbmNlb2YgQ29uc3QKICAgICAgICAgICAgJiYgKChDb25z\ndCkgX3ZhbDEpLmlzU1FMVmFsdWVOdWxsKHNlbCwgY3R4LCBic3RhdGUuc3Rh\ndGUxKTsKICAgICAgICBib29sZWFuIHZhbDJOdWxsID0gX3ZhbDIgaW5zdGFu\nY2VvZiBDb25zdAogICAgICAgICAgICAmJiAoKENvbnN0KSBfdmFsMikuaXNT\nUUxWYWx1ZU51bGwoc2VsLCBjdHgsIGJzdGF0ZS5zdGF0ZTIpOwogICAgICAg\nIGFwcGVuZFRvKHNlbCwgY3R4LCBic3RhdGUsIGJ1ZiwgdmFsMU51bGwsIHZh\nbDJOdWxsKTsKICAgICAgICBzZWwuYXBwZW5kKGJ1Ziwgc3RhdGUuam9pbnMp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNlbGVjdENvbHVtbnMoU2VsZWN0\nIHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAg\nICBib29sZWFuIHBrcykgewogICAgICAgIEJpbmFyeU9wRXhwU3RhdGUgYnN0\nYXRlID0gKEJpbmFyeU9wRXhwU3RhdGUpIHN0YXRlOwogICAgICAgIF92YWwx\nLnNlbGVjdENvbHVtbnMoc2VsLCBjdHgsIGJzdGF0ZS5zdGF0ZTEsIHRydWUp\nOwogICAgICAgIF92YWwyLnNlbGVjdENvbHVtbnMoc2VsLCBjdHgsIGJzdGF0\nZS5zdGF0ZTIsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5k\nIHRoZSBTUUwgZm9yIHRoZSBjb21wYXJpc29uLgogICAgICovCiAgICBwcm90\nZWN0ZWQgYWJzdHJhY3Qgdm9pZCBhcHBlbmRUbyhTZWxlY3Qgc2VsLCBFeHBD\nb250ZXh0IGN0eCwgCiAgICAgICAgQmluYXJ5T3BFeHBTdGF0ZSBzdGF0ZSwg\nU1FMQnVmZmVyIGJ1ZiwgYm9vbGVhbiB2YWwxTnVsbCwgCiAgICAgICAgYm9v\nbGVhbiB2YWwyTnVsbCk7CgogICAgLyoqCiAgICAgKiBTdWJjbGFzc2VzIGNh\nbiBvdmVycmlkZSB0aGlzIG1ldGhvZCBpZiwgd2hlbiB0aGV5IGNvbXBhcmUg\ndG8gYW5vdGhlciwKICAgICAqIHZhbHVlLCB0aGUgY29tcGFyaXNvbiBpcyBp\nbmRpcmVjdC4gRm9yIGV4YW1wbGUsIGZpZWxkLmNvbnRhaW5zICh4KQogICAg\nICogc2hvdWxkIGNvbXBhcmUgZWxlbWVudCB2YWx1ZXMgdG8gbnVsbCwgbm90\nIHRoZSBmaWVsZCBpdHNlbGYuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29s\nZWFuIGlzRGlyZWN0Q29tcGFyaXNvbigpIHsKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChFeHByZXNz\naW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAgdmlzaXRvci5lbnRlcih0\naGlzKTsKICAgICAgICBfdmFsMS5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAg\nICAgICBfdmFsMi5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICB2aXNp\ndG9yLmV4aXQodGhpcyk7CiAgICB9Cn0K\n","encoding":"base64"}

