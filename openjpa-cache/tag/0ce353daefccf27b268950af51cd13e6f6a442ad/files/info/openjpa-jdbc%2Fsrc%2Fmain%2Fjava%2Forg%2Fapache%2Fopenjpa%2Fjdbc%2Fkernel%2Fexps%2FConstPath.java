{"sha":"fa3c723f0757b0945ade06115a5289c8cad13862","node_id":"MDQ6QmxvYjIwNjM2NDpmYTNjNzIzZjA3NTdiMDk0NWFkZTA2MTE1YTUyODljOGNhZDEzODYy","size":6671,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fa3c723f0757b0945ade06115a5289c8cad13862","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzOwoKaW1wb3J0IGphdmEudXRpbC5J\ndGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQg\namF2YS51dGlsLkxpc3RJdGVyYXRvcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMQnVmZmVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5GaWx0ZXJzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb25WaXNpdG9y\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4\nY2VwdGlvbjsKCi8qKgogKiBBIGZpZWxkIHRyYXZlcnNhbCBzdGFydGluZyB3\naXRoIGEgY29uc3RhbnQgZmlsdGVyIHBhcmFtZXRlci4KICoKICogQGF1dGhv\nciBBYmUgV2hpdGUKICovCmNsYXNzIENvbnN0UGF0aAogICAgZXh0ZW5kcyBD\nb25zdAogICAgaW1wbGVtZW50cyBKREJDUGF0aCB7CgogICAgcHJpdmF0ZSBm\naW5hbCBDb25zdCBfY29uc3RhbnQ7CiAgICBwcml2YXRlIGZpbmFsIExpbmtl\nZExpc3QgX2FjdGlvbnMgPSBuZXcgTGlua2VkTGlzdCgpOwoKICAgIC8qKgog\nICAgICogQ29uc3RydWN0b3IuIFN1cHBseSBjb25zdGFudCB0byB0cmF2ZXJz\nZS4KICAgICAqLwogICAgcHVibGljIENvbnN0UGF0aChDb25zdCBjb25zdGFu\ndCkgewogICAgICAgIF9jb25zdGFudCA9IGNvbnN0YW50OwogICAgfQoKICAg\nIHB1YmxpYyBDbGFzcyBnZXRUeXBlKCkgewogICAgICAgIGlmIChfYWN0aW9u\ncy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRh\nID0gZ2V0TWV0YURhdGEoKTsKICAgICAgICAgICAgaWYgKG1ldGEgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuY2xhc3M7CiAgICAg\nICAgICAgIHJldHVybiBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAg\nICB9CgogICAgICAgIE9iamVjdCBsYXN0ID0gX2FjdGlvbnMuZ2V0TGFzdCgp\nOwogICAgICAgIGlmIChsYXN0IGluc3RhbmNlb2YgQ2xhc3MpCiAgICAgICAg\nICAgIHJldHVybiAoQ2xhc3MpIGxhc3Q7CiAgICAgICAgRmllbGRNZXRhRGF0\nYSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgbGFzdDsKICAgICAgICByZXR1cm4g\nZm1kLmdldERlY2xhcmVkVHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldEltcGxpY2l0VHlwZShDbGFzcyB0eXBlKSB7CiAgICAgICAgX2FjdGlv\nbnMuYWRkKHR5cGUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGdldChGaWVs\nZE1ldGFEYXRhIGZpZWxkLCBib29sZWFuIG51bGxUcmF2ZXJzYWwpIHsKICAg\nICAgICBfYWN0aW9ucy5hZGQoZmllbGQpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGdldEtleSgpIHsKICAgIH0KCiAgICBwdWJsaWMgRmllbGRNZXRhRGF0\nYSBsYXN0KCkgewogICAgICAgIExpc3RJdGVyYXRvciBpdHIgPSBfYWN0aW9u\ncy5saXN0SXRlcmF0b3IoX2FjdGlvbnMuc2l6ZSgpKTsKICAgICAgICBPYmpl\nY3QgcHJldjsKICAgICAgICB3aGlsZSAoaXRyLmhhc1ByZXZpb3VzKCkpIHsK\nICAgICAgICAgICAgcHJldiA9IGl0ci5wcmV2aW91cygpOwogICAgICAgICAg\nICBpZiAocHJldiBpbnN0YW5jZW9mIEZpZWxkTWV0YURhdGEpCiAgICAgICAg\nICAgICAgICByZXR1cm4gKEZpZWxkTWV0YURhdGEpIHByZXY7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBPYmpl\nY3QgZ2V0VmFsdWUoT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgdGhyb3cg\nbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICB9CgogICAgcHVibGljIE9i\namVjdCBnZXRWYWx1ZShFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUp\nIHsKICAgICAgICByZXR1cm4gKChDb25zdFBhdGhFeHBTdGF0ZSkgc3RhdGUp\nLnZhbHVlOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0U1FMVmFsdWUo\nU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlKSB7\nCiAgICAgICAgcmV0dXJuICgoQ29uc3RQYXRoRXhwU3RhdGUpIHN0YXRlKS5z\ncWxWYWx1ZTsKICAgIH0KCiAgICBwdWJsaWMgRXhwU3RhdGUgaW5pdGlhbGl6\nZShTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgaW50IGZsYWdzKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBDb25zdFBhdGhFeHBTdGF0ZShfY29uc3RhbnQu\naW5pdGlhbGl6ZShzZWwsIGN0eCwgMCkpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGNhbGN1bGF0ZVZhbHVlKFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4\nLCBFeHBTdGF0ZSBzdGF0ZSwgCiAgICAgICAgVmFsIG90aGVyLCBFeHBTdGF0\nZSBvdGhlclN0YXRlKSB7CiAgICAgICAgc3VwZXIuY2FsY3VsYXRlVmFsdWUo\nc2VsLCBjdHgsIHN0YXRlLCBvdGhlciwgb3RoZXJTdGF0ZSk7CiAgICAgICAg\nQ29uc3RQYXRoRXhwU3RhdGUgY3N0YXRlID0gKENvbnN0UGF0aEV4cFN0YXRl\nKSBzdGF0ZTsKICAgICAgICBfY29uc3RhbnQuY2FsY3VsYXRlVmFsdWUoc2Vs\nLCBjdHgsIGNzdGF0ZS5jb25zdGFudFN0YXRlLCBudWxsLCBudWxsKTsKICAg\nICAgICBjc3RhdGUudmFsdWUgPSBfY29uc3RhbnQuZ2V0VmFsdWUoY3R4LCBj\nc3RhdGUuY29uc3RhbnRTdGF0ZSk7CiAgICAgICAgYm9vbGVhbiBmYWlsZWQg\nPSBmYWxzZTsKCiAgICAgICAgLy8gY29waWVkIGZyb20gb3JnLmFwYWNoZS5v\ncGVuanBhLnF1ZXJ5LkluTWVtb3J5UGF0aAogICAgICAgIE9iamVjdCBhY3Rp\nb247CiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbTsKICAgICAgICBC\ncm9rZXIgdG1wQnJva2VyID0gbnVsbDsKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IF9hY3Rpb25zLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7\nCiAgICAgICAgICAgIC8vIGZhaWwgb24gbnVsbCB2YWx1ZQogICAgICAgICAg\nICBpZiAoY3N0YXRlLnZhbHVlID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIGZhaWxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgYWN0aW9uID0gaXRyLm5leHQoKTsKICAg\nICAgICAgICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIENsYXNzKSB7CiAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGNzdGF0ZS52\nYWx1ZSA9IEZpbHRlcnMuY29udmVydChjc3RhdGUudmFsdWUsIChDbGFzcylh\nY3Rpb24pOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoQ2xhc3NDYXN0RXhjZXB0aW9uIGNjZSkgewog\nICAgICAgICAgICAgICAgICAgIGZhaWxlZCA9IHRydWU7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB3ZSBjYW4gYWNjZXNzIHRo\nZSBpbnN0YW5jZTsgZXZlbiBub24tcGMgdmFscyBtaWdodAogICAgICAgICAg\nICAvLyBiZSBwcm94eWFibGUKICAgICAgICAgICAgc20gPSBudWxsOwogICAg\nICAgICAgICB0bXBCcm9rZXIgPSBudWxsOwogICAgICAgICAgICBpZiAoY3N0\nYXRlLnZhbHVlIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VDYXBhYmxlKQogICAg\nICAgICAgICAgICAgc20gPSAoT3BlbkpQQVN0YXRlTWFuYWdlcikgKChQZXJz\naXN0ZW5jZUNhcGFibGUpIGNzdGF0ZS52YWx1ZSkuCiAgICAgICAgICAgICAg\nICAgICAgcGNHZXRTdGF0ZU1hbmFnZXIoKTsKICAgICAgICAgICAgaWYgKHNt\nID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHRtcEJyb2tlciA9IGN0eC5z\ndG9yZS5nZXRDb250ZXh0KCkuZ2V0QnJva2VyKCk7CiAgICAgICAgICAgICAg\nICB0bXBCcm9rZXIudHJhbnNhY3Rpb25hbChjc3RhdGUudmFsdWUsIGZhbHNl\nLCBudWxsKTsKICAgICAgICAgICAgICAgIHNtID0gdG1wQnJva2VyLmdldFN0\nYXRlTWFuYWdlcihjc3RhdGUudmFsdWUpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBzcGVj\naWZpZWQgZmllbGQgdmFsdWUgYW5kIHN3aXRjaCBjYW5kaWRhdGUKICAgICAg\nICAgICAgICAgIGNzdGF0ZS52YWx1ZSA9IHNtLmZldGNoRmllbGQoKChGaWVs\nZE1ldGFEYXRhKSBhY3Rpb24pLgogICAgICAgICAgICAgICAgICAgIGdldElu\nZGV4KCksIHRydWUpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgLy8gc2V0VHJhbnNhY3Rpb25hbCBkb2VzIG5vdCBjbGVhciB0\naGUgc3RhdGUsIHdoaWNoIGlzCiAgICAgICAgICAgICAgICAvLyBpbXBvcnRh\nbnQgc2luY2UgdG1wVmFsIG1pZ2h0IGJlIGFsc28gbWFuYWdlZCBieQogICAg\nICAgICAgICAgICAgLy8gYW5vdGhlciBicm9rZXIgaWYgaXQncyBhIHByb3hp\nZWQgbm9uLXBjIGluc3RhbmNlCiAgICAgICAgICAgICAgICBpZiAodG1wQnJv\na2VyICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdG1wQnJva2VyLm5v\nbnRyYW5zYWN0aW9uYWwoc20uZ2V0TWFuYWdlZEluc3RhbmNlKCksIG51bGwp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZmFpbGVk\nKQogICAgICAgICAgICBjc3RhdGUudmFsdWUgPSBudWxsOwoKICAgICAgICBp\nZiAob3RoZXIgIT0gbnVsbCkgewogICAgICAgICAgICBjc3RhdGUuc3FsVmFs\ndWUgPSBvdGhlci50b0RhdGFTdG9yZVZhbHVlKHNlbCwgY3R4LCBvdGhlclN0\nYXRlLCAKICAgICAgICAgICAgICAgIGNzdGF0ZS52YWx1ZSk7CiAgICAgICAg\nICAgIGNzdGF0ZS5vdGhlckxlbmd0aCA9IG90aGVyLmxlbmd0aChzZWwsIGN0\neCwgb3RoZXJTdGF0ZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIGNz\ndGF0ZS5zcWxWYWx1ZSA9IGNzdGF0ZS52YWx1ZTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBhcHBlbmRUbyhTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwg\nRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIFNRTEJ1ZmZlciBzcWwsIGludCBp\nbmRleCkgewogICAgICAgIENvbnN0UGF0aEV4cFN0YXRlIGNzdGF0ZSA9IChD\nb25zdFBhdGhFeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgaWYgKGNzdGF0ZS5v\ndGhlckxlbmd0aCA+IDEpCiAgICAgICAgICAgIHNxbC5hcHBlbmRWYWx1ZSgo\nKE9iamVjdFtdKSBjc3RhdGUuc3FsVmFsdWUpW2luZGV4XSwgCiAgICAgICAg\nICAgICAgICBjc3RhdGUuZ2V0Q29sdW1uKGluZGV4KSk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBzcWwuYXBwZW5kVmFsdWUoY3N0YXRlLnNxbFZhbHVl\nLCBjc3RhdGUuZ2V0Q29sdW1uKGluZGV4KSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgYWNjZXB0VmlzaXQoRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikg\newogICAgICAgIHZpc2l0b3IuZW50ZXIodGhpcyk7CiAgICAgICAgX2NvbnN0\nYW50LmFjY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgIHZpc2l0b3IuZXhp\ndCh0aGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4cHJlc3Npb24gc3Rh\ndGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIENvbnN0UGF0\naEV4cFN0YXRlIAogICAgICAgIGV4dGVuZHMgQ29uc3RFeHBTdGF0ZSB7Cgog\nICAgICAgIHB1YmxpYyBmaW5hbCBFeHBTdGF0ZSBjb25zdGFudFN0YXRlOwog\nICAgICAgIHB1YmxpYyBPYmplY3QgdmFsdWUgPSBudWxsOwogICAgICAgIHB1\nYmxpYyBPYmplY3Qgc3FsVmFsdWUgPSBudWxsOwogICAgICAgIHB1YmxpYyBp\nbnQgb3RoZXJMZW5ndGggPSAwOwoKICAgICAgICBwdWJsaWMgQ29uc3RQYXRo\nRXhwU3RhdGUoRXhwU3RhdGUgY29uc3RhbnRTdGF0ZSkgewogICAgICAgICAg\nICB0aGlzLmNvbnN0YW50U3RhdGUgPSBjb25zdGFudFN0YXRlOwogICAgICAg\nIH0KICAgIH0KfQo=\n","encoding":"base64"}

