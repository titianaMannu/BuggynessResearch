{"sha":"90cc0241f93b1a47e08024989ab4d80942b85fd6","node_id":"MDQ6QmxvYjIwNjM2NDo5MGNjMDI0MWY5M2IxYTQ3ZTA4MDI0OTg5YWI0ZDgwOTQyYjg1ZmQ2","size":5380,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/90cc0241f93b1a47e08024989ab4d80942b85fd6","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzOwoKaW1wb3J0IGphdmEudXRpbC5N\nYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNv\nbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxC\ndWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU2Vs\nZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4\ncHJlc3Npb25WaXNpdG9yOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7Cgov\nKioKICogVGVzdCBpZiBhIHN0cmluZyBtYXRjaGVzIGEgcmVnZXhwLgogKgog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KY2xhc3MgTWF0Y2hlc0V4cHJlc3Np\nb24KICAgIGltcGxlbWVudHMgRXhwIHsKCiAgICBwcml2YXRlIGZpbmFsIFZh\nbCBfdmFsOwogICAgcHJpdmF0ZSBmaW5hbCBDb25zdCBfY29uc3Q7CiAgICBw\ncml2YXRlIGZpbmFsIFN0cmluZyBfc2luZ2xlOwogICAgcHJpdmF0ZSBmaW5h\nbCBTdHJpbmcgX211bHRpOwogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX2Vz\nY2FwZTsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLiBTdXBwbHkgdmFs\ndWVzLgogICAgICovCiAgICBwdWJsaWMgTWF0Y2hlc0V4cHJlc3Npb24oVmFs\nIHZhbCwgQ29uc3QgY29uLAogICAgICAgIFN0cmluZyBzaW5nbGUsIFN0cmlu\nZyBtdWx0aSwgU3RyaW5nIGVzY2FwZSkgewogICAgICAgIF92YWwgPSB2YWw7\nCiAgICAgICAgX2NvbnN0ID0gY29uOwogICAgICAgIF9zaW5nbGUgPSBzaW5n\nbGU7CiAgICAgICAgX211bHRpID0gbXVsdGk7CiAgICAgICAgX2VzY2FwZSA9\nIGVzY2FwZTsKICAgIH0KCiAgICBwdWJsaWMgRXhwU3RhdGUgaW5pdGlhbGl6\nZShTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgTWFwIGNvbnRhaW5zKSB7\nCiAgICAgICAgRXhwU3RhdGUgczEgPSBfdmFsLmluaXRpYWxpemUoc2VsLCBj\ndHgsIDApOwogICAgICAgIEV4cFN0YXRlIHMyID0gX2NvbnN0LmluaXRpYWxp\nemUoc2VsLCBjdHgsIDApOwogICAgICAgIHJldHVybiBuZXcgQmluYXJ5T3BF\neHBTdGF0ZShzZWwuYW5kKHMxLmpvaW5zLCBzMi5qb2lucyksIHMxLCBzMik7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5kVG8oU2VsZWN0IHNlbCwg\nRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAgICBTUUxC\ndWZmZXIgYnVmKSB7CiAgICAgICAgQmluYXJ5T3BFeHBTdGF0ZSBic3RhdGUg\nPSAoQmluYXJ5T3BFeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgX3ZhbC5jYWxj\ndWxhdGVWYWx1ZShzZWwsIGN0eCwgYnN0YXRlLnN0YXRlMSwgX2NvbnN0LCBi\nc3RhdGUuc3RhdGUyKTsKICAgICAgICBfY29uc3QuY2FsY3VsYXRlVmFsdWUo\nc2VsLCBjdHgsIGJzdGF0ZS5zdGF0ZTIsIF92YWwsIGJzdGF0ZS5zdGF0ZTEp\nOwoKICAgICAgICBDb2x1bW4gY29sID0gbnVsbDsKICAgICAgICBpZiAoX3Zh\nbCBpbnN0YW5jZW9mIFBDUGF0aCkgewogICAgICAgICAgICBDb2x1bW5bXSBj\nb2xzID0gKChQQ1BhdGgpIF92YWwpLmdldENvbHVtbnMoYnN0YXRlLnN0YXRl\nMSk7CiAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAg\nICAgICAgICAgY29sID0gY29sc1swXTsKICAgICAgICB9CgogICAgICAgIE9i\namVjdCBvID0gX2NvbnN0LmdldFZhbHVlKGN0eCwgYnN0YXRlLnN0YXRlMik7\nCiAgICAgICAgaWYgKG8gPT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiMSA8PiAxIik7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIGxv\nb2sgZm9yIGlnbm9yZSBjYXNlIGZsYWcgYW5kIHN0cmlwIGl0IG91dCBpZiBw\ncmVzZW50CiAgICAgICAgICAgIGJvb2xlYW4gaWdub3JlQ2FzZSA9IGZhbHNl\nOwogICAgICAgICAgICBTdHJpbmcgc3RyID0gby50b1N0cmluZygpOwogICAg\nICAgICAgICBpbnQgaWR4ID0gc3RyLmluZGV4T2YoIig/aSkiKTsKICAgICAg\nICAgICAgaWYgKGlkeCAhPSAtMSkgewogICAgICAgICAgICAgICAgaWdub3Jl\nQ2FzZSA9IHRydWU7CiAgICAgICAgICAgICAgICBpZiAoaWR4ICsgNCA8IHN0\nci5sZW5ndGgoKSkKICAgICAgICAgICAgICAgICAgICBzdHIgPSBzdHIuc3Vi\nc3RyaW5nKDAsIGlkeCkgKyBzdHIuc3Vic3RyaW5nKGlkeCArIDQpOwogICAg\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHN0ciA9IHN0\nci5zdWJzdHJpbmcoMCwgaWR4KTsKICAgICAgICAgICAgICAgIHN0ciA9IHN0\nci50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAv\nLyBhcHBlbmQgdGFyZ2V0CiAgICAgICAgICAgIGlmIChpZ25vcmVDYXNlKQog\nICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiTE9XRVIoIik7CiAgICAgICAg\nICAgIF92YWwuYXBwZW5kVG8oc2VsLCBjdHgsIGJzdGF0ZS5zdGF0ZTEsIGJ1\nZiwgMCk7CiAgICAgICAgICAgIGlmIChpZ25vcmVDYXNlKQogICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiKSIpOwoKICAgICAgICAgICAgLy8gY3JlYXRl\nIGEgREIgd2lsZGNhcmQgc3RyaW5nIGJ5IHJlcGxhY2luZyB0aGUKICAgICAg\nICAgICAgLy8gbXVsdGkgdG9rZW4gKGUuZy4sICcuKicpIGFuZCB0aGUgc2lu\nZ2xlIHRva2VuIChlLmcuLCAiLiIpCiAgICAgICAgICAgIC8vIHdpdGggJyUn\nIGFuZCAnLicgd2l0aCAnXycKICAgICAgICAgICAgc3RyID0gcmVwbGFjZUVz\nY2FwZShzdHIsIF9tdWx0aSwgIiUiLCBfZXNjYXBlKTsKICAgICAgICAgICAg\nc3RyID0gcmVwbGFjZUVzY2FwZShzdHIsIF9zaW5nbGUsICJfIiwgX2VzY2Fw\nZSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBMSUtFICIpLmFwcGVuZFZh\nbHVlKHN0ciwgY29sKTsKCiAgICAgICAgICAgIC8vIGVzY2FwZSBvdXQgY2hh\ncmFjdGVycyBieSB1c2luZyB0aGUgZGF0YWJhc2UncyBlc2NhcGUgc2VxdWVu\nY2UKICAgICAgICAgICAgaWYgKF9lc2NhcGUgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBFU0NBUEUgJyIpLmFwcGVuZChfZXNjYXBl\nKS5hcHBlbmQoIiciKTsKICAgICAgICB9CiAgICAgICAgc2VsLmFwcGVuZChi\ndWYsIHN0YXRlLmpvaW5zKTsKICAgIH0KCiAgICAvKiogCiAgICAgKiBQZXJm\nb3JtIGEgc3RyaW5nIHJlcGxhY2VtZW50IHdpdGggc2ltcGxpc3RpYyBlc2Nh\ncGUgaGFuZGluZy4gCiAgICAgKiAgCiAgICAgKiBAcGFyYW0gIHN0ciAgICAg\nIHRoZSBzb3VyY2Ugc3RyaW5nCiAgICAgKiBAcGFyYW0gIGZyb20gICAgIHRo\nZSBzdHJpbmcgdG8gZmluZAogICAgICogQHBhcmFtICB0byAgICAgICB0aGUg\nc3RyaW5nIHRvIHJlcGxhY2UKICAgICAqIEBwYXJhbSAgZXNjYXBlICAgdGhl\nIHN0cmluZyB0byB1c2UgdG8gZXNjYXBlIHJlcGxhY2VtZW50CiAgICAgKiBA\ncmV0dXJuICAgICAgICAgIHRoZSByZXBsYWNlZCBzdHJpbmcKICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIHJlcGxhY2VFc2NhcGUoU3RyaW5n\nIHN0ciwgU3RyaW5nIGZyb20sIFN0cmluZyB0bywKICAgICAgICBTdHJpbmcg\nZXNjYXBlKSB7CiAgICAgICAgU3RyaW5nW10gcGFydHMgPSBTdHJpbmdzLnNw\nbGl0KHN0ciwgZnJvbSwgSW50ZWdlci5NQVhfVkFMVUUpOwogICAgICAgIFN0\ncmluZ0J1ZmZlciByZXBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoaSA+IDApIHsKICAgICAgICAgICAgICAgIC8vIGlm\nIHRoZSBwcmV2aW91cyBwYXJ0IGVuZGVkIHdpdGggYW4gZXNjYXBlIGNoYXJh\nY3RlciwgdGhlbgogICAgICAgICAgICAgICAgLy8gZXNjYXBlIHRoZSBjaGFy\nYWN0ZXIgYW5kIHJlbW92ZSB0aGUgcHJldmlvdXMgZXNjYXBlOwogICAgICAg\nICAgICAgICAgLy8gdGhpcyBkb2Vzbid0IHN1cHBvcnQgYW55IGRvdWJsZS1l\nc2NhcGluZyBvciBvdGhlciBtb3JlCiAgICAgICAgICAgICAgICAvLyBzb3Bo\naXN0aWNhdGVkIGZlYXR1cmVzCiAgICAgICAgICAgICAgICBpZiAoIWZyb20u\nZXF1YWxzKHRvKSAmJiBwYXJ0c1tpIC0gMV0uZW5kc1dpdGgoZXNjYXBlKSkg\newogICAgICAgICAgICAgICAgICAgIHJlcGJ1Zi5zZXRMZW5ndGgocmVwYnVm\nLmxlbmd0aCgpIC0gMSk7CiAgICAgICAgICAgICAgICAgICAgcmVwYnVmLmFw\ncGVuZChmcm9tKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAg\nICAgICAgICAgIHJlcGJ1Zi5hcHBlbmQodG8pOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHJlcGJ1Zi5hcHBlbmQocGFydHNbaV0pOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gcmVwYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2VsZWN0Q29sdW1ucyhTZWxlY3Qgc2VsLCBFeHBDb250\nZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIGJvb2xlYW4gcGtz\nKSB7CiAgICAgICAgQmluYXJ5T3BFeHBTdGF0ZSBic3RhdGUgPSAoQmluYXJ5\nT3BFeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgX3ZhbC5zZWxlY3RDb2x1bW5z\nKHNlbCwgY3R4LCBic3RhdGUuc3RhdGUxLCB0cnVlKTsKICAgICAgICBfY29u\nc3Quc2VsZWN0Q29sdW1ucyhzZWwsIGN0eCwgYnN0YXRlLnN0YXRlMiwgdHJ1\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoRXhwcmVz\nc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgIHZpc2l0b3IuZW50ZXIo\ndGhpcyk7CiAgICAgICAgX3ZhbC5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAg\nICAgICBfY29uc3QuYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAgdmlz\naXRvci5leGl0KHRoaXMpOwogICAgfQp9Cg==\n","encoding":"base64"}

