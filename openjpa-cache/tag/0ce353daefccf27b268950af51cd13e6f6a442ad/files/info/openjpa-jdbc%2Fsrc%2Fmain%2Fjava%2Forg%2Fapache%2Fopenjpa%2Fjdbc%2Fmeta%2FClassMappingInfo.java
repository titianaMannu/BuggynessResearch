{"sha":"a17aa6289efa32aba69ebc29c4736e2e2a66d15f","node_id":"MDQ6QmxvYjIwNjM2NDphMTdhYTYyODllZmEzMmFiYTY5ZWJjMjljNDczNmUyZTJhNjZkMTVm","size":11098,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a17aa6289efa32aba69ebc29c4736e2e2a66d15f","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRnVsbENsYXNzU3Ry\nYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEu\nQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLkZvcmVpZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuU2NoZW1hOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLlNjaGVtYUdyb3VwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5tZXRhLlNvdXJjZVRyYWNrZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnhtbC5Db21tZW50YWJsZTsKCi8qKgogKiBJbmZvcm1hdGlv\nbiBhYm91dCB0aGUgbWFwcGluZyBmcm9tIGEgY2xhc3MgdG8gdGhlIHNjaGVt\nYSwgaW4gcmF3IGZvcm0uCiAqIFRoZSBjb2x1bW5zIGFuZCB0YWJsZXMgdXNl\nZCBpbiBtYXBwaW5nIGluZm8gd2lsbCBub3QgYmUgcGFydCBvZiB0aGUKICog\ne0BsaW5rIFNjaGVtYUdyb3VwfSB1c2VkIGF0IHJ1bnRpbWUuIFJhdGhlciwg\ndGhleSB3aWxsIGJlIHN0cnVjdHMKICogd2l0aCB0aGUgcmVsZXZhbnQgcGll\nY2VzIG9mIGluZm9ybWF0aW9uIGZpbGxlZCBpbi4KICoKICogQGF1dGhvciBB\nYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBDbGFzc01hcHBpbmdJbmZvCiAg\nICBleHRlbmRzIE1hcHBpbmdJbmZvCiAgICBpbXBsZW1lbnRzIFNvdXJjZVRy\nYWNrZXIsIENvbW1lbnRhYmxlIHsKCiAgICBwcml2YXRlIFN0cmluZyBfY2xh\nc3NOYW1lID0gT2JqZWN0LmNsYXNzLmdldE5hbWUoKTsKICAgIHByaXZhdGUg\nU3RyaW5nIF90YWJsZU5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFu\nIF9qb2luZWQgPSBmYWxzZTsKICAgIHByaXZhdGUgTWFwIF9zZWNvbmRzID0g\nbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9zdWJTdHJhdCA9IG51bGw7CiAg\nICBwcml2YXRlIEZpbGUgX2ZpbGUgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQg\nX3NyY1R5cGUgPSBTUkNfT1RIRVI7CiAgICBwcml2YXRlIFN0cmluZ1tdIF9j\nb21tZW50cyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBUaGUgZGVzY3JpYmVk\nIGNsYXNzIG5hbWUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q2xh\nc3NOYW1lKCkgewogICAgICAgIHJldHVybiBfY2xhc3NOYW1lOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIGRlc2NyaWJlZCBjbGFzcyBuYW1lLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRDbGFzc05hbWUoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBfY2xhc3NOYW1lID0gbmFtZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBkZWZhdWx0IHN0cmF0ZWd5IGZvciBzdWJjbGFzc2VzIGlu\nIHRoaXMgaGllcmFyY2h5LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndEhpZXJhcmNoeVN0cmF0ZWd5KCkgewogICAgICAgIHJldHVybiBfc3ViU3Ry\nYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBzdHJhdGVn\neSBmb3Igc3ViY2xhc3NlcyBpbiB0aGlzIGhpZXJhcmNoeS4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0SGllcmFyY2h5U3RyYXRlZ3koU3RyaW5nIHN0\ncmF0ZWd5KSB7CiAgICAgICAgX3N1YlN0cmF0ID0gc3RyYXRlZ3k7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgZ2l2ZW4gdGFibGUgbmFtZS4KICAgICAq\nLwogICAgcHVibGljIFN0cmluZyBnZXRUYWJsZU5hbWUoKSB7CiAgICAgICAg\ncmV0dXJuIF90YWJsZU5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUg\nZ2l2ZW4gdGFibGUgbmFtZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nVGFibGVOYW1lKFN0cmluZyB0YWJsZSkgewogICAgICAgIF90YWJsZU5hbWUg\nPSB0YWJsZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlcmUg\naXMgYSBqb2luIHRvIHRoZSBzdXBlcmNsYXNzIHRhYmxlLgogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc0pvaW5lZFN1YmNsYXNzKCkgewogICAgICAg\nIHJldHVybiBfam9pbmVkOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0aGVyZSBpcyBhIGpvaW4gdG8gdGhlIHN1cGVyY2xhc3MgdGFibGUuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEpvaW5lZFN1YmNsYXNzKGJvb2xl\nYW4gam9pbmVkKSB7CiAgICAgICAgX2pvaW5lZCA9IGpvaW5lZDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY2xhc3MtbGV2ZWwgam9pbmVk\nIHRhYmxlcy4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1tdIGdldFNlY29u\nZGFyeVRhYmxlTmFtZXMoKSB7CiAgICAgICAgaWYgKF9zZWNvbmRzID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAg\nIHJldHVybiAoU3RyaW5nW10pIF9zZWNvbmRzLmtleVNldCgpLnRvQXJyYXko\nbmV3IFN0cmluZ1tdeyB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFdlIGFs\nbG93IGZpZWxkcyB0byByZWZlcmVuY2UgY2xhc3MtbGV2ZWwgam9pbnMgdXNp\nbmcganVzdCB0aGUgdGFibGUKICAgICAqIG5hbWUsIHdoZXJlYXMgdGhlIGNs\nYXNzIGpvaW4gbWlnaHQgaGF2ZSBzY2hlbWEsIGV0YyBpbmZvcm1hdGlvbi4K\nICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGdp\ndmVuIHRhYmxlIGFzIGxpc3RlZCBpbiBhCiAgICAgKiBjbGFzcy1sZXZlbCBq\nb2luLCBvciB0aGUgZ2l2ZW4gbmFtZSBpZiBubyBqb2luIGV4aXN0cy4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTZWNvbmRhcnlUYWJsZU5hbWUo\nU3RyaW5nIHRhYmxlTmFtZSkgewogICAgICAgIC8vIGlmIG5vIHNlY29uZGFy\neSB0YWJsZSBqb2lucywgYmFkIHRhYmxlIG5hbWUsIGV4YWN0IG1hdGNoLAog\nICAgICAgIC8vIG9yIGFuIGFscmVhZHktcXVhbGlmaWVkIHRhYmxlIG5hbWUs\nIG5vdGhpbmcgdG8gZG8KICAgICAgICBpZiAoX3NlY29uZHMgPT0gbnVsbCB8\nfCB0YWJsZU5hbWUgPT0gbnVsbAogICAgICAgICAgICB8fCBfc2Vjb25kcy5j\nb250YWluc0tleSh0YWJsZU5hbWUpCiAgICAgICAgICAgIHx8IHRhYmxlTmFt\nZS5pbmRleE9mKCcuJykgIT0gLTEpCiAgICAgICAgICAgIHJldHVybiB0YWJs\nZU5hbWU7CgogICAgICAgIC8vIGRlY2lkZSB3aGljaCBjbGFzcy1sZXZlbCBq\nb2luIHRhYmxlIGlzIGJlc3QgbWF0Y2gKICAgICAgICBTdHJpbmcgYmVzdCA9\nIHRhYmxlTmFtZTsKICAgICAgICBpbnQgcHRzID0gMDsKICAgICAgICBTdHJp\nbmcgZnVsbEpvaW47CiAgICAgICAgU3RyaW5nIGpvaW47CiAgICAgICAgaW50\nIGlkeDsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF9zZWNvbmRzLmtl\neVNldCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAg\nICAgIC8vIGF3YXJkIGEgY2FzZWxlc3MgbWF0Y2ggd2l0aG91dCBzY2hlbWEg\nMiBwb2ludHMKICAgICAgICAgICAgZnVsbEpvaW4gPSAoU3RyaW5nKSBpdHIu\nbmV4dCgpOwogICAgICAgICAgICBpZHggPSBmdWxsSm9pbi5sYXN0SW5kZXhP\nZignLicpOwogICAgICAgICAgICBpZiAoaWR4ID09IC0xICYmIHB0cyA8IDIg\nJiYgZnVsbEpvaW4uZXF1YWxzSWdub3JlQ2FzZSh0YWJsZU5hbWUpKSB7CiAg\nICAgICAgICAgICAgICBiZXN0ID0gZnVsbEpvaW47CiAgICAgICAgICAgICAg\nICBwdHMgPSAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKGlkeCA9PSAtMSkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgLy8gaW1t\nZWRpYXRlbHkgcmV0dXJuIGFuIGV4YWN0IG1hdGNoIHdpdGggc2NoZW1hCiAg\nICAgICAgICAgIGpvaW4gPSBmdWxsSm9pbi5zdWJzdHJpbmcoaWR4ICsgMSk7\nCiAgICAgICAgICAgIGlmIChqb2luLmVxdWFscyh0YWJsZU5hbWUpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIGpvaW47CgogICAgICAgICAgICAvLyBjYXNl\nbGVzcyBtYXRjaCB3aXRoIHNjaGVtYSB3b3J0aCAxIHBvaW50CiAgICAgICAg\nICAgIGlmIChwdHMgPCAxICYmIGpvaW4uZXF1YWxzSWdub3JlQ2FzZSh0YWJs\nZU5hbWUpKSB7CiAgICAgICAgICAgICAgICBiZXN0ID0gZnVsbEpvaW47CiAg\nICAgICAgICAgICAgICBwdHMgPSAxOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBiZXN0OwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIGFueSBjb2x1bW5zIGRlZmluZWQgZm9yIHRoZSBnaXZlbiBjbGFz\ncyBsZXZlbCBqb2luLCBvciBlbXB0eQogICAgICogbGlzdCBpZiBub25lLgog\nICAgICovCiAgICBwdWJsaWMgTGlzdCBnZXRTZWNvbmRhcnlUYWJsZUpvaW5D\nb2x1bW5zKFN0cmluZyB0YWJsZU5hbWUpIHsKICAgICAgICBpZiAoX3NlY29u\nZHMgPT0gbnVsbCB8fCB0YWJsZU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7CgogICAgICAgIC8vIGdl\ndCB0aGUgY29sdW1ucyBmb3IgdGhlIGpvaW4gd2l0aCB0aGUgYmVzdCBtYXRj\naCBmb3IgdGFibGUgbmFtZQogICAgICAgIExpc3QgY29scyA9IChMaXN0KSBf\nc2Vjb25kcy5nZXQoZ2V0U2Vjb25kYXJ5VGFibGVOYW1lKHRhYmxlTmFtZSkp\nOwogICAgICAgIGlmIChjb2xzID09IG51bGwpIHsKICAgICAgICAgICAgLy8g\ncG9zc2libGUgdGhhdCBnaXZlbiB0YWJsZSBoYXMgZXh0cmEgaW5mbyB0aGUg\nam9pbiB0YWJsZQogICAgICAgICAgICAvLyBkb2Vzbid0IGhhdmU7IHN0cmlw\nIGl0CiAgICAgICAgICAgIGludCBpZHggPSB0YWJsZU5hbWUubGFzdEluZGV4\nT2YoJy4nKTsKICAgICAgICAgICAgaWYgKGlkeCAhPSAtMSkgewogICAgICAg\nICAgICAgICAgdGFibGVOYW1lID0gdGFibGVOYW1lLnN1YnN0cmluZyhpZHgg\nKyAxKTsKICAgICAgICAgICAgICAgIGNvbHMgPSAoTGlzdCkgX3NlY29uZHMu\nZ2V0KGdldFNlY29uZGFyeVRhYmxlTmFtZSh0YWJsZU5hbWUpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gKGNvbHMgPT0gbnVs\nbCkgPyBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUIDogY29sczsKICAgIH0KCiAg\nICAvKioKICAgICAqIERlY2xhcmUgdGhlIGdpdmVuIGNsYXNzLWxldmVsIGpv\naW4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNlY29uZGFyeVRhYmxl\nSm9pbkNvbHVtbnMoU3RyaW5nIHRhYmxlTmFtZSwgTGlzdCBjb2xzKSB7CiAg\nICAgICAgaWYgKGNvbHMgPT0gbnVsbCkKICAgICAgICAgICAgY29scyA9IENv\nbGxlY3Rpb25zLkVNUFRZX0xJU1Q7CiAgICAgICAgaWYgKF9zZWNvbmRzID09\nIG51bGwpCiAgICAgICAgICAgIF9zZWNvbmRzID0gbmV3IEhhc2hNYXAoKTsK\nICAgICAgICBfc2Vjb25kcy5wdXQodGFibGVOYW1lLCBjb2xzKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdGFibGUgZm9yIHRoZSBnaXZl\nbiBjbGFzcy4KICAgICAqLwogICAgcHVibGljIFRhYmxlIGdldFRhYmxlKGZp\nbmFsIENsYXNzTWFwcGluZyBjbHMsIGJvb2xlYW4gYWRhcHQpIHsKICAgICAg\nICByZXR1cm4gY3JlYXRlVGFibGUoY2xzLCBuZXcgVGFibGVEZWZhdWx0cygp\nIHsKICAgICAgICAgICAgcHVibGljIFN0cmluZyBnZXQoU2NoZW1hIHNjaGVt\nYSkgewogICAgICAgICAgICAgICAgLy8gZGVsYXkgdGhpcyBzbyB0aGF0IHdl\nIGRvbid0IGRvIHNjaGVtYSByZWZsZWN0aW9uIGZvciB1bmlxdWUKICAgICAg\nICAgICAgICAgIC8vIHRhYmxlIG5hbWUgdW5sZXNzIG5lY2Vzc2FyeQogICAg\nICAgICAgICAgICAgcmV0dXJuIGNscy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgp\nLmdldE1hcHBpbmdEZWZhdWx0cygpLgogICAgICAgICAgICAgICAgICAgIGdl\ndFRhYmxlTmFtZShjbHMsIHNjaGVtYSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9LCBudWxsLCBfdGFibGVOYW1lLCBhZGFwdCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIGRhdGFzdG9yZSBpZGVudGl0eSBjb2x1bW5z\nIGZvciB0aGUgZ2l2ZW4gY2xhc3MsIGJhc2VkIG9uIHRoZQogICAgICogZ2l2\nZW4gdGVtcGxhdGVzLgogICAgICovCiAgICBwdWJsaWMgQ29sdW1uW10gZ2V0\nRGF0YVN0b3JlSWRDb2x1bW5zKENsYXNzTWFwcGluZyBjbHMsIENvbHVtbltd\nIHRtcGxhdGVzLAogICAgICAgIFRhYmxlIHRhYmxlLCBib29sZWFuIGFkYXB0\nKSB7CiAgICAgICAgY2xzLmdldE1hcHBpbmdSZXBvc2l0b3J5KCkuZ2V0TWFw\ncGluZ0RlZmF1bHRzKCkuCiAgICAgICAgICAgIHBvcHVsYXRlRGF0YVN0b3Jl\nSWRDb2x1bW5zKGNscywgdGFibGUsIHRtcGxhdGVzKTsKICAgICAgICByZXR1\ncm4gY3JlYXRlQ29sdW1ucyhjbHMsICJkYXRhc3RvcmVpZCIsIHRtcGxhdGVz\nLCB0YWJsZSwgYWRhcHQpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBqb2luIGZyb20gdGhpcyBjbGFzcyB0byBpdHMgc3VwZXJjbGFzcy4g\nVGhlIHRhYmxlIGZvcgogICAgICogdGhpcyBjbGFzcyBtdXN0IGJlIHNldC4K\nICAgICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0U3VwZXJjbGFzc0pv\naW4oZmluYWwgQ2xhc3NNYXBwaW5nIGNscywgVGFibGUgdGFibGUsCiAgICAg\nICAgYm9vbGVhbiBhZGFwdCkgewogICAgICAgIENsYXNzTWFwcGluZyBzdXAg\nPSBjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAgICAg\nICAgaWYgKHN1cCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nCiAgICAgICAgRm9yZWlnbktleURlZmF1bHRzIGRlZiA9IG5ldyBGb3JlaWdu\nS2V5RGVmYXVsdHMoKSB7CiAgICAgICAgICAgIHB1YmxpYyBGb3JlaWduS2V5\nIGdldChUYWJsZSBsb2NhbCwgVGFibGUgZm9yZWlnbiwgYm9vbGVhbiBpbnZl\ncnNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY2xzLmdldE1hcHBpbmdS\nZXBvc2l0b3J5KCkuZ2V0TWFwcGluZ0RlZmF1bHRzKCkuCiAgICAgICAgICAg\nICAgICAgICAgZ2V0Sm9pbkZvcmVpZ25LZXkoY2xzLCBsb2NhbCwgZm9yZWln\nbik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHBv\ncHVsYXRlKFRhYmxlIGxvY2FsLCBUYWJsZSBmb3JlaWduLCBDb2x1bW4gY29s\nLAogICAgICAgICAgICAgICAgT2JqZWN0IHRhcmdldCwgYm9vbGVhbiBpbnZl\ncnNlLCBpbnQgcG9zLCBpbnQgY29scykgewogICAgICAgICAgICAgICAgY2xz\nLmdldE1hcHBpbmdSZXBvc2l0b3J5KCkuZ2V0TWFwcGluZ0RlZmF1bHRzKCku\nCiAgICAgICAgICAgICAgICAgICAgcG9wdWxhdGVKb2luQ29sdW1uKGNscywg\nbG9jYWwsIGZvcmVpZ24sIGNvbCwgdGFyZ2V0LAogICAgICAgICAgICAgICAg\nICAgICAgICBwb3MsIGNvbHMpOwogICAgICAgICAgICB9CiAgICAgICAgfTsK\nICAgICAgICByZXR1cm4gY3JlYXRlRm9yZWlnbktleShjbHMsICJzdXBlcmNs\nYXNzIiwgZ2V0Q29sdW1ucygpLCBkZWYsIHRhYmxlLAogICAgICAgICAgICBj\nbHMsIHN1cCwgZmFsc2UsIGFkYXB0KTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFN5bmNocm9uaXplIGludGVybmFsIGluZm9ybWF0aW9uIHdpdGggdGhlIG1h\ncHBpbmcgZGF0YSBmb3IgdGhlIGdpdmVuCiAgICAgKiBjbGFzcy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc3luY1dpdGgoQ2xhc3NNYXBwaW5nIGNscykg\newogICAgICAgIGNsZWFyKGZhbHNlKTsKCiAgICAgICAgQ2xhc3NNYXBwaW5n\nIHN1cCA9IGNscy5nZXRNYXBwZWRQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAg\nICAgICAgaWYgKGNscy5nZXRUYWJsZSgpICE9IG51bGwgJiYgKHN1cCA9PSBu\ndWxsCiAgICAgICAgICAgIHx8IHN1cC5nZXRUYWJsZSgpICE9IGNscy5nZXRU\nYWJsZSgpKSkKICAgICAgICAgICAgX3RhYmxlTmFtZSA9IGNscy5nZXRNYXBw\naW5nUmVwb3NpdG9yeSgpLmdldERCRGljdGlvbmFyeSgpLgogICAgICAgICAg\nICAgICAgZ2V0RnVsbE5hbWUoY2xzLmdldFRhYmxlKCksIHRydWUpOwoKICAg\nICAgICAvLyBzZXQgaW8gYmVmb3JlIHN5bmNpbmcgY29scwogICAgICAgIHNl\ndENvbHVtbklPKGNscy5nZXRDb2x1bW5JTygpKTsKICAgICAgICBpZiAoY2xz\nLmdldEpvaW5Gb3JlaWduS2V5KCkgIT0gbnVsbCAmJiBzdXAgIT0gbnVsbAog\nICAgICAgICAgICAmJiBzdXAuZ2V0VGFibGUoKSAhPSBudWxsKQogICAgICAg\nICAgICBzeW5jRm9yZWlnbktleShjbHMsIGNscy5nZXRKb2luRm9yZWlnbktl\neSgpLCBjbHMuZ2V0VGFibGUoKSwKICAgICAgICAgICAgICAgIHN1cC5nZXRU\nYWJsZSgpKTsKICAgICAgICBlbHNlIGlmIChjbHMuZ2V0SWRlbnRpdHlUeXBl\nKCkgPT0gQ2xhc3NNYXBwaW5nLklEX0RBVEFTVE9SRSkKICAgICAgICAgICAg\nc3luY0NvbHVtbnMoY2xzLCBjbHMuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKSwg\nZmFsc2UpOwoKICAgICAgICAvLyByZWNvcmQgaW5oZXJpdGFuY2Ugc3RyYXRl\nZ3kgaWYgY2xhc3MgZG9lcyBub3QgdXNlIGRlZmF1bHQgc3RyYXRlZ3kKICAg\nICAgICAvLyBmb3IgYmFzZSBjbGFzc2VzLCBhbmQgZm9yIGFsbCBzdWJjbGFz\nc2VzIHNvIHdlIGNhbiBiZSBzdXJlIHN1YnNlcXVlbnQKICAgICAgICAvLyBt\nYXBwaW5nIHJ1bnMgZG9uJ3QgdGhpbmsgc3ViY2xhc3MgaXMgdW5tYXBwZWQK\nICAgICAgICBTdHJpbmcgc3RyYXQgPSAoY2xzLmdldFN0cmF0ZWd5KCkgPT0g\nbnVsbCkgPyBudWxsCiAgICAgICAgICAgIDogY2xzLmdldFN0cmF0ZWd5KCku\nZ2V0QWxpYXMoKTsKICAgICAgICBpZiAoc3RyYXQgIT0gbnVsbCAmJiAoY2xz\nLmdldFBDU3VwZXJjbGFzcygpICE9IG51bGwKICAgICAgICAgICAgfHwgIUZ1\nbGxDbGFzc1N0cmF0ZWd5LkFMSUFTLmVxdWFscyhzdHJhdCkpKQogICAgICAg\nICAgICBzZXRTdHJhdGVneShzdHJhdCk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaGFzU2NoZW1hQ29tcG9uZW50cygpIHsKICAgICAgICByZXR1cm4g\nc3VwZXIuaGFzU2NoZW1hQ29tcG9uZW50cygpIHx8IF90YWJsZU5hbWUgIT0g\nbnVsbDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhcihib29sZWFu\nIGNhbkZsYWdzKSB7CiAgICAgICAgc3VwZXIuY2xlYXIoY2FuRmxhZ3MpOwog\nICAgICAgIF90YWJsZU5hbWUgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGNvcHkoTWFwcGluZ0luZm8gaW5mbykgewogICAgICAgIHN1cGVyLmNv\ncHkoaW5mbyk7CiAgICAgICAgaWYgKCEoaW5mbyBpbnN0YW5jZW9mIENsYXNz\nTWFwcGluZ0luZm8pKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIENs\nYXNzTWFwcGluZ0luZm8gY2luZm8gPSAoQ2xhc3NNYXBwaW5nSW5mbykgaW5m\nbzsKICAgICAgICBpZiAoX3RhYmxlTmFtZSA9PSBudWxsKQogICAgICAgICAg\nICBfdGFibGVOYW1lID0gY2luZm8uZ2V0VGFibGVOYW1lKCk7CiAgICAgICAg\naWYgKF9zdWJTdHJhdCA9PSBudWxsKQogICAgICAgICAgICBfc3ViU3RyYXQg\nPSBjaW5mby5nZXRIaWVyYXJjaHlTdHJhdGVneSgpOwogICAgICAgIGlmIChj\naW5mby5fc2Vjb25kcyAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfc2Vj\nb25kcyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3NlY29uZHMgPSBuZXcg\nSGFzaE1hcCgpOwogICAgICAgICAgICBPYmplY3Qga2V5OwogICAgICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNpbmZvLl9zZWNvbmRzLmtleVNldCgp\nLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICBpdHIuaGFzTmV4dCgpOykg\newogICAgICAgICAgICAgICAga2V5ID0gaXRyLm5leHQoKTsKICAgICAgICAg\nICAgICAgIGlmICghX3NlY29uZHMuY29udGFpbnNLZXkoa2V5KSkKICAgICAg\nICAgICAgICAgICAgICBfc2Vjb25kcy5wdXQoa2V5LCBjaW5mby5fc2Vjb25k\ncy5nZXQoa2V5KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIEZpbGUgZ2V0U291cmNlRmlsZSgpIHsKICAgICAgICByZXR1\ncm4gX2ZpbGU7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRTb3VyY2VT\nY29wZSgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJs\naWMgaW50IGdldFNvdXJjZVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9zcmNU\neXBlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNvdXJjZShGaWxlIGZp\nbGUsIGludCBzcmNUeXBlKSB7CiAgICAgICAgX2ZpbGUgPSBmaWxlOwogICAg\nICAgIF9zcmNUeXBlID0gc3JjVHlwZTsKICAgIH0KCiAgICBwdWJsaWMgU3Ry\naW5nIGdldFJlc291cmNlTmFtZSgpIHsKICAgICAgICByZXR1cm4gX2NsYXNz\nTmFtZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q29tbWVudHMo\nKSB7CiAgICAgICAgcmV0dXJuIChfY29tbWVudHMgPT0gbnVsbCkgPyBFTVBU\nWV9DT01NRU5UUyA6IF9jb21tZW50czsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRDb21tZW50cyhTdHJpbmdbXSBjb21tZW50cykgewogICAgICAgIF9j\nb21tZW50cyA9IGNvbW1lbnRzOwogICAgfQp9Cg==\n","encoding":"base64"}

