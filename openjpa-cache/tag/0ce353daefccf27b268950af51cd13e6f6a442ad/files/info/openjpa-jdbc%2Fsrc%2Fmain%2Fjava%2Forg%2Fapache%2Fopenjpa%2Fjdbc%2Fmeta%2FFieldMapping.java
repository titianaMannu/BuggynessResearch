{"sha":"475ba9d13eba52762380f6f3a577fa2644202803","node_id":"MDQ6QmxvYjIwNjM2NDo0NzViYTlkMTNlYmE1Mjc2MjM4MGY2ZjNhNTc3ZmEyNjQ0MjAyODAz","size":31648,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/475ba9d13eba52762380f6f3a577fa2644202803","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5K\nREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVGaWVsZFN0cmF0ZWd5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW5J\nTzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3Jl\naWduS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLkluZGV4OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlVuaXF1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5K\nb2luczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5SZXN1\nbHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJvd01hbmFnZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMQnVmZmVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3RFeGVj\ndXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmV0Y2hD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAqIFNwZWNpYWxpemF0\naW9uIG9mIG1ldGFkYXRhIGZvciByZWxhdGlvbmFsIGRhdGFiYXNlcy4KICoK\nICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBGaWVsZE1h\ncHBpbmcKICAgIGV4dGVuZHMgRmllbGRNZXRhRGF0YQogICAgaW1wbGVtZW50\ncyBWYWx1ZU1hcHBpbmcsIEZpZWxkU3RyYXRlZ3kgewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBh\nY2thZ2UKICAgICAgICAoRmllbGRNYXBwaW5nLmNsYXNzKTsKCiAgICBwcml2\nYXRlIGZpbmFsIFZhbHVlTWFwcGluZyBfdmFsOwogICAgcHJpdmF0ZSBmaW5h\nbCBWYWx1ZU1hcHBpbmcgX2tleTsKICAgIHByaXZhdGUgZmluYWwgVmFsdWVN\nYXBwaW5nIF9lbGVtOwogICAgcHJpdmF0ZSBmaW5hbCBGaWVsZE1hcHBpbmdJ\nbmZvIF9pbmZvOwogICAgcHJpdmF0ZSBmaW5hbCBKREJDQ29sdW1uT3JkZXIg\nX29yZGVyQ29sID0gbmV3IEpEQkNDb2x1bW5PcmRlcigpOwogICAgcHJpdmF0\nZSBGaWVsZFN0cmF0ZWd5IF9zdHJhdGVneSA9IG51bGw7CgogICAgcHJpdmF0\nZSBGb3JlaWduS2V5IF9mayA9IG51bGw7CiAgICBwcml2YXRlIENvbHVtbklP\nIF9pbyA9IG51bGw7CiAgICBwcml2YXRlIFVuaXF1ZSBfdW5xID0gbnVsbDsK\nICAgIHByaXZhdGUgSW5kZXggX2lkeCA9IG51bGw7CiAgICBwcml2YXRlIGJv\nb2xlYW4gX291dGVyID0gZmFsc2U7CiAgICBwcml2YXRlIGludCBfZmV0Y2hN\nb2RlID0gSW50ZWdlci5NQVhfVkFMVUU7CgogICAgLyoqCiAgICAgKiBDb25z\ndHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWFwcGluZyhTdHJp\nbmcgbmFtZSwgQ2xhc3MgdHlwZSwgQ2xhc3NNYXBwaW5nIG93bmVyKSB7CiAg\nICAgICAgc3VwZXIobmFtZSwgdHlwZSwgb3duZXIpOwogICAgICAgIF9pbmZv\nID0gb3duZXIuZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5uZXdNYXBwaW5nSW5m\nbyh0aGlzKTsKICAgICAgICBfdmFsID0gKFZhbHVlTWFwcGluZykgZ2V0VmFs\ndWUoKTsKICAgICAgICBfa2V5ID0gKFZhbHVlTWFwcGluZykgZ2V0S2V5KCk7\nCiAgICAgICAgX2VsZW0gPSAoVmFsdWVNYXBwaW5nKSBnZXRFbGVtZW50KCk7\nCgogICAgICAgIHNldFVzZXNJbnRlcm1lZGlhdGUoZmFsc2UpOwogICAgICAg\nIHNldFVzZXNJbXBsRGF0YShCb29sZWFuLkZBTFNFKTsKICAgIH0KCiAgICAv\nLy8vLy8vCiAgICAvLyBPUk0KICAgIC8vLy8vLy8KCiAgICAvKioKICAgICAq\nIFJhdyBtYXBwaW5nIGRhdGEgYWJvdXQgZmllbGQncyBqb2luIHRvIHBhcmVu\ndCB0YWJsZSwgYXMgd2VsbCBhcwogICAgICogbWlzY2VsbGFuZW91cyBzcGVj\naWFsaXplZCBjb2x1bW5zIGxpa2Ugb3JkZXIgY29sdW1uLgogICAgICovCiAg\nICBwdWJsaWMgRmllbGRNYXBwaW5nSW5mbyBnZXRNYXBwaW5nSW5mbygpIHsK\nICAgICAgICByZXR1cm4gX2luZm87CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgc3RyYXRlZ3kgdXNlZCB0byBtYXAgdGhpcyBtYXBwaW5nLgogICAgICov\nCiAgICBwdWJsaWMgRmllbGRTdHJhdGVneSBnZXRTdHJhdGVneSgpIHsKICAg\nICAgICByZXR1cm4gX3N0cmF0ZWd5OwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIHN0cmF0ZWd5IHVzZWQgdG8gbWFwIHRoaXMgbWFwcGluZy4gVGhlIDxj\nb2RlPmFkYXB0PC9jb2RlPgogICAgICogcGFyYW1ldGVyIGRldGVybWluZXMg\nd2hldGhlciB0byBhZGFwdCB3aGVuIG1hcHBpbmcgdGhlIHN0cmF0ZWd5Owog\nICAgICogdXNlIG51bGwgaWYgdGhlIHN0cmF0ZWd5IHNob3VsZCBub3QgYmUg\nbWFwcGVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTdHJhdGVneShG\naWVsZFN0cmF0ZWd5IHN0cmF0ZWd5LCBCb29sZWFuIGFkYXB0KSB7CiAgICAg\nICAgLy8gc2V0IHN0cmF0ZWd5IGZpcnN0IHNvIHdlIGNhbiBhY2Nlc3MgaXQg\nZHVyaW5nIG1hcHBpbmcKICAgICAgICBGaWVsZFN0cmF0ZWd5IG9yaWcgPSBf\nc3RyYXRlZ3k7CiAgICAgICAgX3N0cmF0ZWd5ID0gc3RyYXRlZ3k7CiAgICAg\nICAgaWYgKHN0cmF0ZWd5ICE9IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIHN0cmF0ZWd5LnNldEZpZWxkTWFwcGluZyh0aGlz\nKTsKICAgICAgICAgICAgICAgIGlmIChhZGFwdCAhPSBudWxsKQogICAgICAg\nICAgICAgICAgICAgIHN0cmF0ZWd5Lm1hcChhZGFwdC5ib29sZWFuVmFsdWUo\nKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUp\nIHsKICAgICAgICAgICAgICAgIC8vIHJlc2V0IHN0cmF0ZWd5CiAgICAgICAg\nICAgICAgICBfc3RyYXRlZ3kgPSBvcmlnOwogICAgICAgICAgICAgICAgdGhy\nb3cgcmU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGlmIHNldCB0\nbyB1bm1hcHBlZCwgY2xlYXIgZGVmaW5lZCBmaWVsZCBjYWNoZSBpbiBwYXJl\nbnQKICAgICAgICAgICAgaWYgKCFpc01hcHBlZCgpKQogICAgICAgICAgICAg\nICAgZ2V0RGVmaW5pbmdNYXBwaW5nKCkuY2xlYXJEZWZpbmVkRmllbGRDYWNo\nZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBtYXBw\naW5nJ3MgcHJpbWFyeSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIFRhYmxl\nIGdldFRhYmxlKCkgewogICAgICAgIGlmIChfZmsgIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIF9may5nZXRUYWJsZSgpOwogICAgICAgIGlmIChfdmFs\nLmdldEZvcmVpZ25LZXkoKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nX3ZhbC5nZXRGb3JlaWduS2V5KCkuZ2V0VGFibGUoKTsKICAgICAgICByZXR1\ncm4gZ2V0RGVmaW5pbmdNYXBwaW5nKCkuZ2V0VGFibGUoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEkvTyBpbmZvcm1hdGlvbiBvbiB0aGUgam9pbiBjb2x1\nbW5zLgogICAgICovCiAgICBwdWJsaWMgQ29sdW1uSU8gZ2V0Sm9pbkNvbHVt\nbklPKCkgewogICAgICAgIHJldHVybiAoX2lvID09IG51bGwpID8gQ29sdW1u\nSU8uVU5SRVNUUklDVEVEIDogX2lvOwogICAgfQoKICAgIC8qKgogICAgICog\nSS9PIGluZm9ybWF0aW9uIG9uIHRoZSBqb2luIGNvbHVtbnMuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldEpvaW5Db2x1bW5JTyhDb2x1bW5JTyBpbykg\newogICAgICAgIF9pbyA9IGlvOwogICAgfQoKICAgIC8qKgogICAgICogRm9y\nZWlnbiBrZXkgbGlua2luZyB0aGUgZmllbGQgdGFibGUgdG8gdGhlIGNsYXNz\nJyBwcmltYXJ5IHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktl\neSBnZXRKb2luRm9yZWlnbktleSgpIHsKICAgICAgICByZXR1cm4gX2ZrOwog\nICAgfQoKICAgIC8qKgogICAgICogRm9yZWlnbiBrZXkgbGlua2luZyB0aGUg\nZmllbGQgdGFibGUgdG8gdGhlIGNsYXNzJyBwcmltYXJ5IHRhYmxlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRKb2luRm9yZWlnbktleShGb3JlaWdu\nS2V5IGZrKSB7CiAgICAgICAgX2ZrID0gZms7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBVbmlxdWUgY29uc3RyYWludCBvbiBqb2luIGZvcmVpZ24ga2V5IGNv\nbHVtbnMuCiAgICAgKi8KICAgIHB1YmxpYyBVbmlxdWUgZ2V0Sm9pblVuaXF1\nZSgpIHsKICAgICAgICByZXR1cm4gX3VucTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFVuaXF1ZSBjb25zdHJhaW50IG9uIGpvaW4gZm9yZWlnbiBrZXkgY29s\ndW1ucy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Sm9pblVuaXF1ZShV\nbmlxdWUgdW5xKSB7CiAgICAgICAgX3VucSA9IHVucTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEluZGV4IG9uIGpvaW4gZm9yZWlnbiBrZXkgY29sdW1ucy4K\nICAgICAqLwogICAgcHVibGljIEluZGV4IGdldEpvaW5JbmRleCgpIHsKICAg\nICAgICByZXR1cm4gX2lkeDsKICAgIH0KCiAgICAvKioKICAgICAqIEluZGV4\nIG9uIGpvaW4gZm9yZWlnbiBrZXkgY29sdW1ucy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0Sm9pbkluZGV4KEluZGV4IGlkeCkgewogICAgICAgIF9p\nZHggPSBpZHg7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIHVz\nZSBhbiBvdXRlciBqb2luIGZyb20gdGhlIGNsYXNzJyBwcmltYXJ5IHRhYmxl\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0pvaW5PdXRlcigpIHsK\nICAgICAgICByZXR1cm4gX291dGVyOwogICAgfQoKICAgIC8qKgogICAgICog\nV2hldGhlciB0byB1c2UgYW4gb3V0ZXIgam9pbiBmcm9tIHRoZSBjbGFzcycg\ncHJpbWFyeSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Sm9p\nbk91dGVyKGJvb2xlYW4gb3V0ZXIpIHsKICAgICAgICBfb3V0ZXIgPSBvdXRl\ncjsKICAgIH0KCiAgICAvKioKICAgICAqIEZpZWxkIG9yZGVyIGNvbHVtbiwg\naWYgYW55LgogICAgICovCiAgICBwdWJsaWMgQ29sdW1uIGdldE9yZGVyQ29s\ndW1uKCkgewogICAgICAgIHJldHVybiBfb3JkZXJDb2wuZ2V0Q29sdW1uKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBGaWVsZCBvcmRlciBjb2x1bW4sIGlm\nIGFueS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0T3JkZXJDb2x1bW4o\nQ29sdW1uIG9yZGVyKSB7CiAgICAgICAgX29yZGVyQ29sLnNldENvbHVtbihv\ncmRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBJL08gaW5mb3JtYXRpb24g\nZm9yIG9yZGVyIGNvbHVtbi4KICAgICAqLwogICAgcHVibGljIENvbHVtbklP\nIGdldE9yZGVyQ29sdW1uSU8oKSB7CiAgICAgICAgcmV0dXJuIF9vcmRlckNv\nbC5nZXRDb2x1bW5JTygpOwogICAgfQoKICAgIC8qKgogICAgICogSS9PIGlu\nZm9ybWF0aW9uIGZvciBvcmRlciBjb2x1bW4uCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldE9yZGVyQ29sdW1uSU8oQ29sdW1uSU8gaW8pIHsKICAgICAg\nICBfb3JkZXJDb2wuc2V0Q29sdW1uSU8oaW8pOwogICAgfQoKICAgIC8qKgog\nICAgICogSW5jcmVtZW50IHRoZSByZWZlcmVuY2UgY291bnQgb2YgdXNlZCBz\nY2hlbWEgY29tcG9uZW50cy4KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVm\nU2NoZW1hQ29tcG9uZW50cygpIHsKICAgICAgICBpZiAoX2ZrICE9IG51bGwp\nIHsKICAgICAgICAgICAgX2ZrLnJlZigpOwogICAgICAgICAgICBfZmsucmVm\nQ29sdW1ucygpOwogICAgICAgIH0KICAgICAgICBpZiAoX29yZGVyQ29sLmdl\ndENvbHVtbigpICE9IG51bGwpCiAgICAgICAgICAgIF9vcmRlckNvbC5nZXRD\nb2x1bW4oKS5yZWYoKTsKICAgICAgICBfdmFsLnJlZlNjaGVtYUNvbXBvbmVu\ndHMoKTsKICAgICAgICBfa2V5LnJlZlNjaGVtYUNvbXBvbmVudHMoKTsKICAg\nICAgICBfZWxlbS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDbGVhciBtYXBwaW5nIGluZm9ybWF0aW9uLCBpbmNsdWRp\nbmcgc3RyYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNsZWFyTWFw\ncGluZygpIHsKICAgICAgICBfc3RyYXRlZ3kgPSBudWxsOwogICAgICAgIF9m\nayA9IG51bGw7CiAgICAgICAgX3VucSA9IG51bGw7CiAgICAgICAgX2lkeCA9\nIG51bGw7CiAgICAgICAgX291dGVyID0gZmFsc2U7CiAgICAgICAgX29yZGVy\nQ29sLnNldENvbHVtbihudWxsKTsKICAgICAgICBfdmFsLmNsZWFyTWFwcGlu\nZygpOwogICAgICAgIF9rZXkuY2xlYXJNYXBwaW5nKCk7CiAgICAgICAgX2Vs\nZW0uY2xlYXJNYXBwaW5nKCk7CiAgICAgICAgX2luZm8uY2xlYXIoKTsKICAg\nICAgICBzZXRSZXNvbHZlKE1PREVfTUFQUElORywgZmFsc2UpOwogICAgfQoK\nICAgIC8qKgogICAgICogVXBkYXRlIHtAbGluayBNYXBwaW5nSW5mb30gd2l0\naCBvdXIgY3VycmVudCBtYXBwaW5nIGluZm9ybWF0aW9uLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzeW5jTWFwcGluZ0luZm8oKSB7CiAgICAgICAgaWYg\nKGlzVmVyc2lvbigpKSB7CiAgICAgICAgICAgIC8vIHdlIHJlbHkgb24gdGhl\nIGZhY3QgdGhhdCB0aGUgdmVyc2lvbiB3aWxsIHNldHVwIG91ciBtYXBwaW5n\nCiAgICAgICAgICAgIC8vIGluZm8gY29ycmVjdGx5IHdoZW4gaXQgaXMgc3lu\nY2VkCiAgICAgICAgfSBlbHNlIGlmIChnZXRNYXBwZWRCeU1hcHBpbmcoKSAh\nPSBudWxsKSB7CiAgICAgICAgICAgIF9pbmZvLmNsZWFyKCk7CiAgICAgICAg\nICAgIF92YWwuZ2V0VmFsdWVJbmZvKCkuY2xlYXIoKTsKICAgICAgICAgICAg\nX2tleS5nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwogICAgICAgICAgICBfZWxl\nbS5nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwoKICAgICAgICAgICAgRmllbGRN\nYXBwaW5nIG1hcHBlZCA9IGdldE1hcHBlZEJ5TWFwcGluZygpOwogICAgICAg\nICAgICBfaW5mby5zeW5jU3RyYXRlZ3kodGhpcyk7CiAgICAgICAgICAgIGlm\nIChfb3JkZXJDb2wuZ2V0Q29sdW1uKCkgIT0gbnVsbAogICAgICAgICAgICAg\nICAgJiYgbWFwcGVkLmdldE9yZGVyQ29sdW1uKCkgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9pbmZvLnN5bmNPcmRlckNvbHVtbih0aGlzKTsKICAgICAg\nICAgICAgX3ZhbC5nZXRWYWx1ZUluZm8oKS5zZXRVc2VDbGFzc0NyaXRlcmlh\nCiAgICAgICAgICAgICAgICAoX3ZhbC5nZXRVc2VDbGFzc0NyaXRlcmlhKCkp\nOwogICAgICAgICAgICBfa2V5LmdldFZhbHVlSW5mbygpLnNldFVzZUNsYXNz\nQ3JpdGVyaWEKICAgICAgICAgICAgICAgIChfa2V5LmdldFVzZUNsYXNzQ3Jp\ndGVyaWEoKSk7CiAgICAgICAgICAgIF9lbGVtLmdldFZhbHVlSW5mbygpLnNl\ndFVzZUNsYXNzQ3JpdGVyaWEKICAgICAgICAgICAgICAgIChfZWxlbS5nZXRV\nc2VDbGFzc0NyaXRlcmlhKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIF9pbmZvLnN5bmNXaXRoKHRoaXMpOwogICAgICAgICAgICBfdmFsLnN5\nbmNNYXBwaW5nSW5mbygpOwogICAgICAgICAgICBfa2V5LnN5bmNNYXBwaW5n\nSW5mbygpOwogICAgICAgICAgICBfZWxlbS5zeW5jTWFwcGluZ0luZm8oKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUg\naWYgZmllbGQgY2xhc3MgZG9lcyBub3QgdXNlIHRoZSAibm9uZSIgc3RyYXRl\nZ3kgKGluY2x1ZGluZwogICAgICogaWYgaXQgaGFzIGEgbnVsbCBzdHJhdGVn\neSwgYW5kIHRoZXJlZm9yZSBpcyBwcm9iYWJseSBpbiB0aGUgcHJvY2VzcyBv\nZgogICAgICogYmVpbmcgbWFwcGVkKS4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gaXNNYXBwZWQoKSB7CiAgICAgICAgcmV0dXJuIF9zdHJhdGVneSAh\nPSBOb25lRmllbGRTdHJhdGVneS5nZXRJbnN0YW5jZSgpOwogICAgfQoKICAg\nIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE1ldGFEYXRhIGludGVy\nZmFjZQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAg\nICogVGhlIGVhZ2VyIGZldGNoIG1vZGUsIGFzIG9uZSBvZiB0aGUgZWFnZXIg\nY29uc3RhbnRzIGluCiAgICAgKiB7QGxpbmsgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbn0uCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0RWFnZXJGZXRjaE1v\nZGUoKSB7CiAgICAgICAgaWYgKF9mZXRjaE1vZGUgPT0gSW50ZWdlci5NQVhf\nVkFMVUUpCiAgICAgICAgICAgIF9mZXRjaE1vZGUgPSBGZXRjaENvbmZpZ3Vy\nYXRpb24uREVGQVVMVDsKICAgICAgICByZXR1cm4gX2ZldGNoTW9kZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBlYWdlciBmZXRjaCBtb2RlLCBhcyBv\nbmUgb2YgdGhlIGVhZ2VyIGNvbnN0YW50cyBpbgogICAgICoge0BsaW5rIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb259LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRFYWdlckZldGNoTW9kZShpbnQgbW9kZSkgewogICAgICAgIF9mZXRj\naE1vZGUgPSBtb2RlOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVu\nY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsg\nRmllbGRNZXRhRGF0YSNnZXRSZXBvc2l0b3J5fQogICAgICovCiAgICBwdWJs\naWMgTWFwcGluZ1JlcG9zaXRvcnkgZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKSB7\nCiAgICAgICAgcmV0dXJuIChNYXBwaW5nUmVwb3NpdG9yeSkgZ2V0UmVwb3Np\ndG9yeSgpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0\naG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsgRmllbGRN\nZXRhRGF0YSNnZXREZWZpbmluZ01ldGFEYXRhfQogICAgICovCiAgICBwdWJs\naWMgQ2xhc3NNYXBwaW5nIGdldERlZmluaW5nTWFwcGluZygpIHsKICAgICAg\nICByZXR1cm4gKENsYXNzTWFwcGluZykgZ2V0RGVmaW5pbmdNZXRhRGF0YSgp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRv\nIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsgRmllbGRNZXRhRGF0\nYSNnZXREZWNsYXJpbmdNZXRhRGF0YX0KICAgICAqLwogICAgcHVibGljIENs\nYXNzTWFwcGluZyBnZXREZWNsYXJpbmdNYXBwaW5nKCkgewogICAgICAgIHJl\ndHVybiAoQ2xhc3NNYXBwaW5nKSBnZXREZWNsYXJpbmdNZXRhRGF0YSgpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBl\ncmZvcm0gY2FzdCBmcm9tIHtAbGluayBGaWVsZE1ldGFEYXRhI2dldEtleX0K\nICAgICAqLwogICAgcHVibGljIFZhbHVlTWFwcGluZyBnZXRLZXlNYXBwaW5n\nKCkgewogICAgICAgIHJldHVybiBfa2V5OwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tIHtA\nbGluayBGaWVsZE1ldGFEYXRhI2dldEVsZW1lbnR9CiAgICAgKi8KICAgIHB1\nYmxpYyBWYWx1ZU1hcHBpbmcgZ2V0RWxlbWVudE1hcHBpbmcoKSB7CiAgICAg\nICAgcmV0dXJuIF9lbGVtOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVu\naWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tIHtAbGluayBGaWVs\nZE1ldGFEYXRhI2dldFZhbHVlfQogICAgICovCiAgICBwdWJsaWMgVmFsdWVN\nYXBwaW5nIGdldFZhbHVlTWFwcGluZygpIHsKICAgICAgICByZXR1cm4gKFZh\nbHVlTWFwcGluZykgZ2V0VmFsdWUoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbQogICAg\nICoge0BsaW5rIEZpZWxkTWV0YURhdGEjZ2V0TWFwcGVkQnlNZXRhRGF0YX0K\nICAgICAqLwogICAgcHVibGljIEZpZWxkTWFwcGluZyBnZXRNYXBwZWRCeU1h\ncHBpbmcoKSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1hcHBpbmcpIGdldE1h\ncHBlZEJ5TWV0YURhdGEoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZl\nbmllbmNlIG1ldGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbQogICAgICoge0Bs\naW5rIEZpZWxkTWV0YURhdGEjZ2V0SW52ZXJzZU1ldGFEYXRhc30KICAgICAq\nLwogICAgcHVibGljIEZpZWxkTWFwcGluZ1tdIGdldEludmVyc2VNYXBwaW5n\ncygpIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGluZ1tdKSBnZXRJbnZl\ncnNlTWV0YURhdGFzKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVz\nb2x2ZShpbnQgbW9kZSkgewogICAgICAgIGludCBjdXIgPSBnZXRSZXNvbHZl\nKCk7CiAgICAgICAgaWYgKHN1cGVyLnJlc29sdmUobW9kZSkpCiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmICgobW9kZSAmIE1PREVfTUFQ\nUElORykgIT0gMCAmJiAoY3VyICYgTU9ERV9NQVBQSU5HKSA9PSAwKQogICAg\nICAgICAgICByZXNvbHZlTWFwcGluZygpOwogICAgICAgIGlmICgobW9kZSAm\nIE1PREVfTUFQUElOR19JTklUKSAhPSAwICYmIChjdXIgJiBNT0RFX01BUFBJ\nTkdfSU5JVCkgPT0gMCkKICAgICAgICAgICAgaW5pdGlhbGl6ZU1hcHBpbmco\nKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXNvbHZlIHRoZSBtYXBwaW5nIGluZm9ybWF0aW9uIGZvciB0aGlzIGZp\nZWxkLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcmVzb2x2ZU1hcHBpbmco\nKSB7CiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRNYXBw\naW5nUmVwb3NpdG9yeSgpOwogICAgICAgIGlmIChyZXBvcy5nZXRNYXBwaW5n\nRGVmYXVsdHMoKS5kZWZhdWx0TWlzc2luZ0luZm8oKSkgewogICAgICAgICAg\nICAvLyBjb3B5IGVtYmVkZGVkIHRlbXBsYXRlIG1hcHBpbmcgaW5mbwogICAg\nICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gZ2V0RGVmaW5pbmdNYXBwaW5n\nKCk7CiAgICAgICAgICAgIGlmIChjbHMuZ2V0RW1iZWRkaW5nTWFwcGluZygp\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIENsYXNzTWFwcGluZyBvcmln\nID0gcmVwb3MuZ2V0TWFwcGluZyhjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpLAog\nICAgICAgICAgICAgICAgICAgIGNscy5nZXRFbnZDbGFzc0xvYWRlcigpLCB0\ncnVlKTsKICAgICAgICAgICAgICAgIEZpZWxkTWFwcGluZyB0bXBsYXRlID0g\nb3JpZy5nZXRGaWVsZE1hcHBpbmcoZ2V0TmFtZSgpKTsKICAgICAgICAgICAg\nICAgIGlmICh0bXBsYXRlICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\nY29weU1hcHBpbmdJbmZvKHRtcGxhdGUpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIC8vIGNvcHkgc3VwZXJjbGFzcyBmaWVsZCBpbmZvCiAgICAgICAg\nICAgIGVsc2UgaWYgKGNscy5pc01hcHBlZCgpICYmIGNscy5nZXRQQ1N1cGVy\nY2xhc3MoKSAhPSBudWxsCiAgICAgICAgICAgICAgICAmJiBjbHMuZ2V0RGVz\nY3JpYmVkVHlwZSgpICE9IGdldERlY2xhcmluZ1R5cGUoKSkgewogICAgICAg\nICAgICAgICAgRmllbGRNYXBwaW5nIHN1cCA9IGNscy5nZXRQQ1N1cGVyY2xh\nc3NNYXBwaW5nKCkuCiAgICAgICAgICAgICAgICAgICAgZ2V0RmllbGRNYXBw\naW5nKGdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICBpZiAoc3VwICE9IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgY29weU1hcHBpbmdJbmZvKHN1cCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChfc3RyYXRl\nZ3kgPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoaXNWZXJzaW9uKCkpCiAg\nICAgICAgICAgICAgICBfc3RyYXRlZ3kgPSBOb25lRmllbGRTdHJhdGVneS5n\nZXRJbnN0YW5jZSgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICByZXBvcy5nZXRTdHJhdGVneUluc3RhbGxlcigpLmluc3RhbGxTdHJhdGVn\neSh0aGlzKTsKICAgICAgICB9CiAgICAgICAgTG9nIGxvZyA9IGdldFJlcG9z\naXRvcnkoKS5nZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgiZmllbGQt\nc3RyYXRlZ3kiLCBnZXROYW1lKCksCiAgICAgICAgICAgICAgICBfc3RyYXRl\nZ3kuZ2V0QWxpYXMoKSkpOwoKICAgICAgICAvLyBtYXJrIG1hcHBlZCBjb2x1\nbW5zCiAgICAgICAgaWYgKF9vcmRlckNvbC5nZXRDb2x1bW4oKSAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGlmIChnZXRPcmRlckNvbHVtbklPKCkuaXNJbnNl\ncnRhYmxlKDAsIGZhbHNlKSkKICAgICAgICAgICAgICAgIF9vcmRlckNvbC5n\nZXRDb2x1bW4oKS5zZXRGbGFnKENvbHVtbi5GTEFHX0RJUkVDVF9JTlNFUlQs\nIHRydWUpOwogICAgICAgICAgICBpZiAoZ2V0T3JkZXJDb2x1bW5JTygpLmlz\nVXBkYXRhYmxlKDAsIGZhbHNlKSkKICAgICAgICAgICAgICAgIF9vcmRlckNv\nbC5nZXRDb2x1bW4oKS5zZXRGbGFnKENvbHVtbi5GTEFHX0RJUkVDVF9VUERB\nVEUsIHRydWUpOwogICAgICAgIH0KICAgICAgICBpZiAoX2ZrICE9IG51bGwp\nIHsKICAgICAgICAgICAgQ29sdW1uW10gY29scyA9IF9may5nZXRDb2x1bW5z\nKCk7CiAgICAgICAgICAgIENvbHVtbklPIGlvID0gZ2V0Sm9pbkNvbHVtbklP\nKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGlvLmlzSW5zZXJ0YWJs\nZShpLCBmYWxzZSkpCiAgICAgICAgICAgICAgICAgICAgY29sc1tpXS5zZXRG\nbGFnKENvbHVtbi5GTEFHX0ZLX0lOU0VSVCwgdHJ1ZSk7CiAgICAgICAgICAg\nICAgICBpZiAoaW8uaXNVcGRhdGFibGUoaSwgZmFsc2UpKQogICAgICAgICAg\nICAgICAgICAgIGNvbHNbaV0uc2V0RmxhZyhDb2x1bW4uRkxBR19GS19VUERB\nVEUsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBf\ndmFsLnJlc29sdmUoTU9ERV9NQVBQSU5HKTsKICAgICAgICBfa2V5LnJlc29s\ndmUoTU9ERV9NQVBQSU5HKTsKICAgICAgICBfZWxlbS5yZXNvbHZlKE1PREVf\nTUFQUElORyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb3B5IG1hcHBpbmcg\naW5mbyBmcm9tIHRoZSBnaXZlbiBpbnN0YW5jZSB0byB0aGlzIG9uZS4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgY29weU1hcHBpbmdJbmZvKEZpZWxkTWFw\ncGluZyBmbSkgewogICAgICAgIHNldE1hcHBlZEJ5KGZtLmdldE1hcHBlZEJ5\nKCkpOwogICAgICAgIF9pbmZvLmNvcHkoZm0uZ2V0TWFwcGluZ0luZm8oKSk7\nCiAgICAgICAgX3ZhbC5jb3B5TWFwcGluZ0luZm8oZm0uZ2V0VmFsdWVNYXBw\naW5nKCkpOwogICAgICAgIF9rZXkuY29weU1hcHBpbmdJbmZvKGZtLmdldEtl\neU1hcHBpbmcoKSk7CiAgICAgICAgX2VsZW0uY29weU1hcHBpbmdJbmZvKGZt\nLmdldEVsZW1lbnRNYXBwaW5nKCkpOwogICAgfQoKICAgIC8qKgogICAgICog\nUHJlcGFyZSBtYXBwaW5nIGZvciBydW50aW1lIHVzZS4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGluaXRpYWxpemVNYXBwaW5nKCkgewogICAgICAgIF92\nYWwucmVzb2x2ZShNT0RFX01BUFBJTkdfSU5JVCk7CiAgICAgICAgX2tleS5y\nZXNvbHZlKE1PREVfTUFQUElOR19JTklUKTsKICAgICAgICBfdmFsLnJlc29s\ndmUoTU9ERV9NQVBQSU5HX0lOSVQpOwogICAgICAgIF9zdHJhdGVneS5pbml0\naWFsaXplKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY29weShGaWVsZE1l\ndGFEYXRhIGZtZCkgewogICAgICAgIHN1cGVyLmNvcHkoZm1kKTsKICAgICAg\nICBpZiAoX2ZldGNoTW9kZSA9PSBJbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAg\nICAgICAgX2ZldGNoTW9kZSA9ICgoRmllbGRNYXBwaW5nKSBmbWQpLmdldEVh\nZ2VyRmV0Y2hNb2RlKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xlYW4g\ndmFsaWRhdGVEYXRhU3RvcmVFeHRlbnNpb25QcmVmaXgoU3RyaW5nIHByZWZp\neCkgewogICAgICAgIHJldHVybiAiamRiYy0iLmVxdWFscyhwcmVmaXgpOwog\nICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAg\nICAvLyBGaWVsZFN0cmF0ZWd5IGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0QWxpYXMoKSB7CiAgICAgICAgcmV0dXJuIGFzc2VydFN0cmF0ZWd5KCku\nZ2V0QWxpYXMoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVh\nbiBhZGFwdCkgewogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkubWFwKGFkYXB0\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1hcCB0aGlzIGZpZWxkIHRvIGl0\ncyB0YWJsZSwgb3B0aW9uYWxseSByZXF1aXJpbmcgdGhhdCBpdCBiZQogICAg\nICogaW4gYW5vdGhlciB0YWJsZS4gVXRpbGl0eSBtZXRob2QgZm9yIHVzZSBi\neSBtYXBwaW5nIHN0cmF0ZWdpZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIG1hcEpvaW4oYm9vbGVhbiBhZGFwdCwgYm9vbGVhbiBqb2luUmVxdWlyZWQp\nIHsKICAgICAgICBUYWJsZSB0YWJsZSA9IF9pbmZvLmdldFRhYmxlKHRoaXMs\nIGpvaW5SZXF1aXJlZCwgYWRhcHQpOwogICAgICAgIEZvcmVpZ25LZXkgam9p\nbiA9IG51bGw7CiAgICAgICAgaWYgKHRhYmxlICE9IG51bGwpCiAgICAgICAg\nICAgIGpvaW4gPSBfaW5mby5nZXRKb2luKHRoaXMsIHRhYmxlLCBhZGFwdCk7\nCiAgICAgICAgaWYgKGpvaW4gPT0gbnVsbCAmJiBqb2luUmVxdWlyZWQpCiAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgiam9pbi1yZXF1aXJlZCIsIHRoaXMpKTsKCiAgICAgICAgaWYgKGpvaW4g\nPT0gbnVsbCkgewogICAgICAgICAgICBfaW5mby5hc3NlcnROb0pvaW4odGhp\ncywgdHJ1ZSk7CiAgICAgICAgICAgIF9pbmZvLmFzc2VydE5vRm9yZWlnbktl\neSh0aGlzLCAhYWRhcHQpOwogICAgICAgICAgICBfaW5mby5hc3NlcnROb1Vu\naXF1ZSh0aGlzLCAhYWRhcHQpOwogICAgICAgICAgICBfaW5mby5hc3NlcnRO\nb0luZGV4KHRoaXMsICFhZGFwdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgX2ZrID0gam9pbjsKICAgICAgICAgICAgX2lvID0gX2luZm8uZ2V0\nQ29sdW1uSU8oKTsKICAgICAgICAgICAgX291dGVyID0gX2luZm8uaXNKb2lu\nT3V0ZXIoKTsKICAgICAgICAgICAgX3VucSA9IF9pbmZvLmdldEpvaW5Vbmlx\ndWUodGhpcywgZmFsc2UsIGFkYXB0KTsKICAgICAgICAgICAgX2lkeCA9IF9p\nbmZvLmdldEpvaW5JbmRleCh0aGlzLCBhZGFwdCk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogTWFwcyB0aGUgcHJpbWFyeSBrZXkgb24gdGhl\nIHNlY29uZGFyeSB0YWJsZSBmb3IgdGhpcyBmaWVsZCwgaWYgdGhlCiAgICAg\nKiB1c2VyJ3MgZGVmYXVsdHMgY3JlYXRlIG9uZS4gVGhpcyBtdXN0IGJlIGNh\nbGxlZCBhZnRlcgogICAgICogdGhpcyBmaWVsZCBpcyBtYXBwZWQgc28gdGhh\ndCBpdCdzIHRhYmxlIGhhcyBpdHMgY29sdW1ucyBzZXQuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIG1hcFByaW1hcnlLZXkoYm9vbGVhbiBhZGFwdCkgewog\nICAgICAgIGlmIChhZGFwdCAmJiBfZmsgIT0gbnVsbCAmJiBfZmsuZ2V0VGFi\nbGUoKS5nZXRQcmltYXJ5S2V5KCkgPT0gbnVsbCkKICAgICAgICAgICAgZ2V0\nTWFwcGluZ1JlcG9zaXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMoKS4KICAg\nICAgICAgICAgICAgIGluc3RhbGxQcmltYXJ5S2V5KHRoaXMsIF9may5nZXRU\nYWJsZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbml0aWFsaXplKCkg\newogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkuaW5pdGlhbGl6ZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGluc2VydChPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0pCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3ko\nKS5pbnNlcnQoc20sIHN0b3JlLCBybSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgdXBkYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBz\ndG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBhc3NlcnRTdHJhdGVneSgpLnVwZGF0ZShzbSwgc3Rv\ncmUsIHJtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkZWxldGUoT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2Vy\nIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGFz\nc2VydFN0cmF0ZWd5KCkuZGVsZXRlKHNtLCBzdG9yZSwgcm0pOwogICAgfQoK\nICAgIC8qKgogICAgICogRGVsZXRlIHRoZSByb3cgZm9yIHRoaXMgb2JqZWN0\nIGlmIHRoZSByZWZlcmVuY2UgZm9yZWlnbiBrZXkgZXhpc3RzLgogICAgICog\nVXRpbGl0eSBtZXRob2QgZm9yIHVzZSBieSBtYXBwaW5nIHN0cmF0ZWdpZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGRlbGV0ZVJvdyhPcGVuSlBBU3Rh\ndGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgUm93TWFu\nYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAoX2ZrICE9IG51bGwpIHsKICAgICAgICAgICAgUm93IHJvdyA9IHJt\nLmdldFJvdyhnZXRUYWJsZSgpLCBSb3cuQUNUSU9OX0RFTEVURSwgc20sIHRy\ndWUpOwogICAgICAgICAgICByb3cud2hlcmVGb3JlaWduS2V5KF9maywgc20p\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\ncm93IHRvIHVzZSBmb3IgdGhpcyBmaWVsZC4gVGhpcyBtZXRob2QgaXMgbWVh\nbnQgb25seSBmb3IKICAgICAqIHNpbmdsZS12YWx1ZSBmaWVsZHMgdGhhdCBt\naWdodCByZXNpZGUgaW4gYSB0YWJsZSB0aGF0IGlzIGpvaW5lZCB0bwogICAg\nICogdGhlIHByaW1hcnkgdGFibGUgdGhyb3VnaCB0aGUgam9pbiBmb3JlaWdu\nIGtleS4gSXQgaXMgbm90CiAgICAgKiBtZWFudCBmb3IgbXVsdGktdmFsdWVk\nIGZpZWxkcyBsaWtlIGNvbGxlY3Rpb25zIGFuZCBtYXBzLiBUaGUgbWV0aG9k\nCiAgICAgKiBjaGVja3Mgd2hldGhlciB3ZSdyZSB1c2luZyBhbiBvdXRlciBq\nb2luIGFuZCBpZiBzbyBpdCBkZWxldGVzIHRoZQogICAgICogZmllbGQncyBw\ncmV2aW91cyB2YWx1ZSwgdGhlbiBpZiB0aGUgZmllbGQgaXMgbm9uLW51bGwg\ncmV0dXJucyBhbiBpbnNlcnQKICAgICAqIHJvdyBmb3IgdGhlIG5ldyB2YWx1\nZS4gVGhlIGpvaW4gZm9yZWlnbiBrZXkgd2lsbCBhbHJlYWR5IGJlIHNldCBv\nbgogICAgICogdGhlIHJldHVybmVkIHJvdzsgbWFwcGluZyBzdHJhdGVnaWVz\nIGp1c3QgbmVlZCB0byBzZXQgdGhlaXIgb3duIHZhbHVlcy4KICAgICAqIFV0\naWxpdHkgbWV0aG9kIGZvciB1c2UgYnkgbWFwcGluZyBzdHJhdGVnaWVzLgog\nICAgICovCiAgICBwdWJsaWMgUm93IGdldFJvdyhPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0sCiAgICAg\nICAgaW50IGFjdGlvbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBSb3cgcm93ID0gbnVsbDsKICAgICAgICBib29sZWFuIG5ld091\ndGVyUm93ID0gZmFsc2U7CiAgICAgICAgaWYgKF9mayAhPSBudWxsICYmIF9v\ndXRlciAmJiBhY3Rpb24gIT0gUm93LkFDVElPTl9ERUxFVEUpIHsKICAgICAg\nICAgICAgLy8gaWYgdXBkYXRpbmcgd2l0aCBvdXRlciBqb2luLCBkZWxldGUg\nb2xkIHZhbHVlIGZpcnN0LCB0aGVuIGluc2VydDsKICAgICAgICAgICAgLy8g\nd2UgY2FuJ3QganVzdCB1cGRhdGUgYi9jIHRoZSByb3cgbWlnaHQgbm90IGV4\naXN0CiAgICAgICAgICAgIGlmIChhY3Rpb24gPT0gUm93LkFDVElPTl9VUERB\nVEUpIHsKICAgICAgICAgICAgICAgIC8vIG1heWJlIHNvbWUgb3RoZXIgZmll\nbGQgYWxyZWFkeSBpcyB1cGRhdGluZz8KICAgICAgICAgICAgICAgIHJvdyA9\nIHJtLmdldFJvdyhnZXRUYWJsZSgpLCBSb3cuQUNUSU9OX1VQREFURSwgc20s\nIGZhbHNlKTsKICAgICAgICAgICAgICAgIGlmIChyb3cgPT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIFJvdyBkZWwgPSBybS5nZXRSb3coZ2V0VGFi\nbGUoKSwgUm93LkFDVElPTl9ERUxFVEUsIHNtLAogICAgICAgICAgICAgICAg\nICAgICAgICB0cnVlKTsKICAgICAgICAgICAgICAgICAgICBkZWwud2hlcmVG\nb3JlaWduS2V5KF9maywgc20pOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIHJvdyA9IHJtLmdldFJvdyhn\nZXRUYWJsZSgpLCBSb3cuQUNUSU9OX0lOU0VSVCwgc20sIGZhbHNlKTsKCiAg\nICAgICAgICAgIC8vIG9ubHkgdXBkYXRlL2luc2VydCBpZiB0aGUgcm93IGV4\naXN0cyBhbHJlYWR5IG9yIHRoZSB2YWx1ZSBpcwogICAgICAgICAgICAvLyBu\nb3QgbnVsbC9kZWZhdWx0CiAgICAgICAgICAgIGlmIChyb3cgPT0gbnVsbCAm\nJiAhaXNOdWxsVmFsdWUoc20pKSB7CiAgICAgICAgICAgICAgICByb3cgPSBy\nbS5nZXRSb3coZ2V0VGFibGUoKSwgUm93LkFDVElPTl9JTlNFUlQsIHNtLCB0\ncnVlKTsKICAgICAgICAgICAgICAgIG5ld091dGVyUm93ID0gdHJ1ZTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gZWxzZQogICAgICAgICAgICByb3cgPSBy\nbS5nZXRSb3coZ2V0VGFibGUoKSwgYWN0aW9uLCBzbSwgdHJ1ZSk7CgogICAg\nICAgIC8vIHNldHVwIGZrCiAgICAgICAgaWYgKHJvdyAhPSBudWxsICYmIF9m\nayAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChyb3cuZ2V0QWN0aW9uKCkg\nPT0gUm93LkFDVElPTl9JTlNFUlQpCiAgICAgICAgICAgICAgICByb3cuc2V0\nRm9yZWlnbktleShfZmssIF9pbywgc20pOwogICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICByb3cud2hlcmVGb3JlaWduS2V5KF9maywgc20pOwoK\nICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIG5ldyBvdXRlciBqb2luZWQg\ncm93LCBtYXJrIGl0IGludmFsaWQgdW50aWwKICAgICAgICAgICAgLy8gc29t\nZSBtYXBwaW5nIGFjdHVhbGx5IHNldHMgaW5mb3JtYXRpb24gb24gaXQKICAg\nICAgICAgICAgaWYgKG5ld091dGVyUm93KQogICAgICAgICAgICAgICAgcm93\nLnNldFZhbGlkKGZhbHNlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJv\ndzsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoaXMg\nZmllbGQgaXMgbnVsbC9kZWZhdWx0IGluIHRoZSBnaXZlbiBpbnN0YW5jZS4K\nICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGlzTnVsbFZhbHVlKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBzd2l0Y2ggKGdldFR5cGVD\nb2RlKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTjoK\nICAgICAgICAgICAgICAgIHJldHVybiAhc20uZmV0Y2hCb29sZWFuKGdldElu\nZGV4KCkpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAg\nICAgICAgICAgICAgcmV0dXJuIHNtLmZldGNoQnl0ZShnZXRJbmRleCgpKSA9\nPSAwOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSOgogICAgICAg\nICAgICAgICAgcmV0dXJuIHNtLmZldGNoQ2hhcihnZXRJbmRleCgpKSA9PSAw\nOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAgICAgICAg\nICAgICAgICByZXR1cm4gc20uZmV0Y2hEb3VibGUoZ2V0SW5kZXgoKSkgPT0g\nMDsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAg\nICAgICAgICByZXR1cm4gc20uZmV0Y2hGbG9hdChnZXRJbmRleCgpKSA9PSAw\nOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAg\nICAgICByZXR1cm4gc20uZmV0Y2hJbnQoZ2V0SW5kZXgoKSkgPT0gMDsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoKICAgICAgICAgICAgICAg\nIHJldHVybiBzbS5mZXRjaExvbmcoZ2V0SW5kZXgoKSkgPT0gMDsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gc20uZmV0Y2hTaG9ydChnZXRJbmRleCgpKSA9PSAwOwogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5TVFJJTkc6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gc20uZmV0Y2hTdHJpbmcoZ2V0SW5kZXgoKSkgPT0gbnVsbDsKICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBzbS5m\nZXRjaE9iamVjdChnZXRJbmRleCgpKSA9PSBudWxsOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgQm9vbGVhbiBpc0N1c3RvbUluc2VydChPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBy\nZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5pc0N1c3RvbUluc2VydChzbSwgc3Rv\ncmUpOwogICAgfQoKICAgIHB1YmxpYyBCb29sZWFuIGlzQ3VzdG9tVXBkYXRl\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSkgewog\nICAgICAgIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLmlzQ3VzdG9tVXBkYXRl\nKHNtLCBzdG9yZSk7CiAgICB9CgogICAgcHVibGljIEJvb2xlYW4gaXNDdXN0\nb21EZWxldGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0\nb3JlKSB7CiAgICAgICAgcmV0dXJuIGFzc2VydFN0cmF0ZWd5KCkuaXNDdXN0\nb21EZWxldGUoc20sIHN0b3JlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBj\ndXN0b21JbnNlcnQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3Jl\nIHN0b3JlKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIGFzc2VydFN0cmF0ZWd5KCkuY3VzdG9tSW5zZXJ0KHNtLCBzdG9yZSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgY3VzdG9tVXBkYXRlKE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBhc3NlcnRTdHJhdGVneSgpLmN1c3Rv\nbVVwZGF0ZShzbSwgc3RvcmUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGN1\nc3RvbURlbGV0ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUg\nc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nYXNzZXJ0U3RyYXRlZ3koKS5jdXN0b21EZWxldGUoc20sIHN0b3JlKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRGaWVsZE1hcHBpbmcoRmllbGRNYXBw\naW5nIG93bmVyKSB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5zZXRGaWVs\nZE1hcHBpbmcob3duZXIpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgc3VwcG9y\ndHNTZWxlY3QoU2VsZWN0IHNlbCwgaW50IHR5cGUsIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20sCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgcmV0dXJuIGFzc2VydFN0\ncmF0ZWd5KCkuc3VwcG9ydHNTZWxlY3Qoc2VsLCB0eXBlLCBzbSwgc3RvcmUs\nIGZldGNoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3RFYWdlclBh\ncmFsbGVsKFNlbGVjdEV4ZWN1dG9yIHNlbCwgT3BlbkpQQVN0YXRlTWFuYWdl\nciBzbSwKICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlck1vZGUpIHsKICAgICAgICBhc3Nl\ncnRTdHJhdGVneSgpLnNlbGVjdEVhZ2VyUGFyYWxsZWwoc2VsLCBzbSwgc3Rv\ncmUsIGZldGNoLCBlYWdlck1vZGUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNlbGVjdEVhZ2VySm9pbihTZWxlY3Qgc2VsLCBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCwgaW50IGVhZ2VyTW9kZSkgewogICAgICAgIGFz\nc2VydFN0cmF0ZWd5KCkuc2VsZWN0RWFnZXJKb2luKHNlbCwgc20sIHN0b3Jl\nLCBmZXRjaCwgZWFnZXJNb2RlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc0VhZ2VyU2VsZWN0VG9NYW55KCkgewogICAgICAgIHJldHVybiBhc3Nl\ncnRTdHJhdGVneSgpLmlzRWFnZXJTZWxlY3RUb01hbnkoKTsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IHNlbGVjdChTZWxlY3Qgc2VsLCBPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCwgaW50IGVhZ2VyTW9kZSkgewogICAgICAg\nIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLnNlbGVjdChzZWwsIHNtLCBzdG9y\nZSwgZmV0Y2gsIGVhZ2VyTW9kZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYW55IGpvaW5zIG5lZWRlZCB0byBnZXQgZnJvbSB0aGUgcHJpbWFy\neSB0YWJsZSB0byB0aGlzIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgSm9p\nbnMgam9pbihTZWxlY3Qgc2VsKSB7CiAgICAgICAgaWYgKF9mayA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgSm9pbnMgam9p\nbnMgPSBzZWwubmV3Sm9pbnMoKTsKICAgICAgICBpZiAoX291dGVyKQogICAg\nICAgICAgICByZXR1cm4gam9pbnMub3V0ZXJKb2luKF9maywgdHJ1ZSwgZmFs\nc2UpOwogICAgICAgIHJldHVybiBqb2lucy5qb2luKF9maywgdHJ1ZSwgZmFs\nc2UpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgPGNvZGU+d2hlcmVQ\ncmltYXJ5S2V5PC9jb2RlPiBvciA8Y29kZT53aGVyZUZvcmVpZ25LZXk8L2Nv\nZGU+CiAgICAgKiBjb25kaXRpb24gdG8gdGhlIGdpdmVuIHNlbGVjdCwgZGVw\nZW5kaW5nIG9uIHdoZXRoZXIgd2UgaGF2ZSBhIGpvaW4KICAgICAqIGZvcmVp\nZ24ga2V5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCB3aGVyZVByaW1hcnlL\nZXkoU2VsZWN0IHNlbCwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAg\nICBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBpZiAoX2ZrICE9IG51bGwp\nCiAgICAgICAgICAgIHNlbC53aGVyZUZvcmVpZ25LZXkoX2ZrLCBzbS5nZXRP\nYmplY3RJZCgpLCBnZXREZWZpbmluZ01hcHBpbmcoKSwKICAgICAgICAgICAg\nICAgIHN0b3JlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNlbC53aGVy\nZVByaW1hcnlLZXkoc20uZ2V0T2JqZWN0SWQoKSwgZ2V0RGVmaW5pbmdNYXBw\naW5nKCksCiAgICAgICAgICAgICAgICBzdG9yZSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBZGQgb3JkZXJpbmcgdG8gdGhlIGdpdmVuIHNlbGVjdCBmb3Ig\nYWxsIG5vbi1yZWxhdGlvbiBvcmRlciB2YWx1ZXMsCiAgICAgKiBpbmNsdWRp\nbmcgdGhlIHN5bnRoZXRpYyBvcmRlciBjb2x1bW4sIGlmIGFueS4KICAgICAq\nCiAgICAgKiBAcGFyYW0gZWxlbSB0aGUgcmVsYXRlZCB0eXBlIHdlJ3JlIGZl\ndGNoaW5nLCBvciBudWxsCiAgICAgKiBAcGFyYW0gam9pbnMgdGhlIGpvaW5z\nIHRvIHRoaXMgZmllbGQncyB0YWJsZQogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBvcmRlckxvY2FsKFNlbGVjdCBzZWwsIENsYXNzTWFwcGluZyBlbGVtLCBK\nb2lucyBqb2lucykgewogICAgICAgIF9vcmRlckNvbC5vcmRlcihzZWwsIGVs\nZW0sIGpvaW5zKTsKICAgICAgICBKREJDT3JkZXJbXSBvcmRlcnMgPSAoSkRC\nQ09yZGVyW10pIGdldE9yZGVycygpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgb3JkZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoIW9y\nZGVyc1tpXS5pc0luUmVsYXRpb24oKSkKICAgICAgICAgICAgICAgIG9yZGVy\nc1tpXS5vcmRlcihzZWwsIGVsZW0sIGpvaW5zKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFkZCBvcmRlcmluZyB0byB0aGUgZ2l2ZW4gc2VsZWN0IGZvciBh\nbGwgcmVsYXRpb24tYmFzZWQgdmFsdWVzLgogICAgICoKICAgICAqIEBwYXJh\nbSBlbGVtIHRoZSByZWxhdGVkIHR5cGUgd2UncmUgZmV0Y2hpbmcKICAgICAq\nIEBwYXJhbSBqb2lucyB0aGUgam9pbnMgYWNyb3NzIHRoZSByZWxhdGlvbgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBvcmRlclJlbGF0aW9uKFNlbGVjdCBz\nZWwsIENsYXNzTWFwcGluZyBlbGVtLCBKb2lucyBqb2lucykgewogICAgICAg\nIEpEQkNPcmRlcltdIG9yZGVycyA9IChKREJDT3JkZXJbXSkgZ2V0T3JkZXJz\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBvcmRlcnMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIGlmIChvcmRlcnNbaV0uaXNJblJlbGF0aW9u\nKCkpCiAgICAgICAgICAgICAgICBvcmRlcnNbaV0ub3JkZXIoc2VsLCBlbGVt\nLCBqb2lucyk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBsb2FkRWFnZXJQ\nYXJhbGxlbChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3Rv\ncmUsCiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgT2Jq\nZWN0IHJlcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICByZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5sb2FkRWFnZXJQYXJhbGxlbChz\nbSwgc3RvcmUsIGZldGNoLCByZXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGxvYWRFYWdlckpvaW4oT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0\nb3JlIHN0b3JlLAogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0\nY2gsIFJlc3VsdCByZXMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5sb2FkRWFnZXJKb2luKHNtLCBz\ndG9yZSwgZmV0Y2gsIHJlcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9h\nZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsCiAg\nICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgUmVzdWx0IHJl\ncykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBhc3Nl\ncnRTdHJhdGVneSgpLmxvYWQoc20sIHN0b3JlLCBmZXRjaCwgcmVzKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBsb2FkKE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nc20sIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGZldGNoKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGFzc2VydFN0cmF0ZWd5KCkubG9hZChzbSwgc3RvcmUsIGZldGNo\nKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHRvRGF0YVN0b3JlVmFsdWUo\nT2JqZWN0IHZhbCwgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgcmV0dXJu\nIGFzc2VydFN0cmF0ZWd5KCkudG9EYXRhU3RvcmVWYWx1ZSh2YWwsIHN0b3Jl\nKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHRvS2V5RGF0YVN0b3JlVmFs\ndWUoT2JqZWN0IHZhbCwgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgcmV0\ndXJuIGFzc2VydFN0cmF0ZWd5KCkudG9LZXlEYXRhU3RvcmVWYWx1ZSh2YWws\nIHN0b3JlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRJc0VtcHR5\nKFNRTEJ1ZmZlciBzcWwsIFNlbGVjdCBzZWwsIEpvaW5zIGpvaW5zKSB7CiAg\nICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5hcHBlbmRJc0VtcHR5KHNxbCwgc2Vs\nLCBqb2lucyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5kSXNOb3RF\nbXB0eShTUUxCdWZmZXIgc3FsLCBTZWxlY3Qgc2VsLCBKb2lucyBqb2lucykg\newogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkuYXBwZW5kSXNOb3RFbXB0eShz\ncWwsIHNlbCwgam9pbnMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFwcGVu\nZElzTnVsbChTUUxCdWZmZXIgc3FsLCBTZWxlY3Qgc2VsLCBKb2lucyBqb2lu\ncykgewogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkuYXBwZW5kSXNOdWxsKHNx\nbCwgc2VsLCBqb2lucyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5k\nSXNOb3ROdWxsKFNRTEJ1ZmZlciBzcWwsIFNlbGVjdCBzZWwsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5hcHBlbmRJc05vdE51\nbGwoc3FsLCBzZWwsIGpvaW5zKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBh\ncHBlbmRTaXplKFNRTEJ1ZmZlciBzcWwsIFNlbGVjdCBzZWwsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5hcHBlbmRTaXplKHNx\nbCwgc2VsLCBqb2lucyk7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGpvaW4o\nSm9pbnMgam9pbnMsIGJvb2xlYW4gZm9yY2VPdXRlcikgewogICAgICAgIHJl\ndHVybiBhc3NlcnRTdHJhdGVneSgpLmpvaW4oam9pbnMsIGZvcmNlT3V0ZXIp\nOwogICAgfQoKICAgIHB1YmxpYyBKb2lucyBqb2luS2V5KEpvaW5zIGpvaW5z\nLCBib29sZWFuIGZvcmNlT3V0ZXIpIHsKICAgICAgICByZXR1cm4gYXNzZXJ0\nU3RyYXRlZ3koKS5qb2luS2V5KGpvaW5zLCBmb3JjZU91dGVyKTsKICAgIH0K\nCiAgICBwdWJsaWMgSm9pbnMgam9pblJlbGF0aW9uKEpvaW5zIGpvaW5zLCBi\nb29sZWFuIGZvcmNlT3V0ZXIsCiAgICAgICAgYm9vbGVhbiB0cmF2ZXJzZSkg\newogICAgICAgIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLmpvaW5SZWxhdGlv\nbihqb2lucywgZm9yY2VPdXRlciwgdHJhdmVyc2UpOwogICAgfQoKICAgIHB1\nYmxpYyBKb2lucyBqb2luS2V5UmVsYXRpb24oSm9pbnMgam9pbnMsIGJvb2xl\nYW4gZm9yY2VPdXRlciwKICAgICAgICBib29sZWFuIHRyYXZlcnNlKSB7CiAg\nICAgICAgcmV0dXJuIGFzc2VydFN0cmF0ZWd5KCkuam9pbktleVJlbGF0aW9u\nKGpvaW5zLCBmb3JjZU91dGVyLCB0cmF2ZXJzZSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBKb2lucyBmcm9tIHRoZSBvd25pbmcgY2xhc3MnIHRhYmxlIHRv\nIHRoZSB0YWJsZSB3aGVyZSB0aGlzIGZpZWxkIGxpZXMKICAgICAqIHVzaW5n\nIHRoZSBqb2luIGZvcmVpZ24ga2V5LiBVdGlsaXR5IG1ldGhvZCBmb3IgdXNl\nIGJ5IG1hcHBpbmcgc3RyYXRlZ2llcy4KICAgICAqLwogICAgcHVibGljIEpv\naW5zIGpvaW4oSm9pbnMgam9pbnMsIGJvb2xlYW4gZm9yY2VPdXRlciwgYm9v\nbGVhbiB0b01hbnkpIHsKICAgICAgICBpZiAoX2ZrID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBqb2luczsKICAgICAgICBpZiAoX291dGVyIHx8IGZv\ncmNlT3V0ZXIpCiAgICAgICAgICAgIHJldHVybiBqb2lucy5vdXRlckpvaW4o\nX2ZrLCB0cnVlLCB0b01hbnkpOwogICAgICAgIHJldHVybiBqb2lucy5qb2lu\nKF9maywgdHJ1ZSwgdG9NYW55KTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0\nIGxvYWRQcm9qZWN0aW9uKEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCwKICAgICAgICBSZXN1bHQgcmVzLCBKb2lucyBq\nb2lucykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5sb2FkUHJvamVjdGlvbihzdG9yZSwg\nZmV0Y2gsIHJlcywgam9pbnMpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\nbG9hZEtleVByb2plY3Rpb24oSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIFJlc3VsdCByZXMsIEpvaW5z\nIGpvaW5zKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHJldHVybiBhc3NlcnRTdHJhdGVneSgpCiAgICAgICAgICAgIC5sb2FkS2V5\nUHJvamVjdGlvbihzdG9yZSwgZmV0Y2gsIHJlcywgam9pbnMpOwogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGlzVmVyc2lvbmFibGUoKSB7CiAgICAgICAg\ncmV0dXJuIGFzc2VydFN0cmF0ZWd5KCkuaXNWZXJzaW9uYWJsZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlKE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSwKICAgICAgICBP\nYmplY3QgcHJldlZhbHVlKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkud2hlcmUoc20sIHN0b3JlLCBy\nbSwgcHJldlZhbHVlKTsKICAgIH0KCiAgICBwcml2YXRlIEZpZWxkU3RyYXRl\nZ3kgYXNzZXJ0U3RyYXRlZ3koKSB7CiAgICAgICAgaWYgKF9zdHJhdGVneSA9\nPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRp\nb24oKTsKICAgICAgICByZXR1cm4gX3N0cmF0ZWd5OwogICAgfQoKICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFZhbHVlTWFw\ncGluZyBpbXBsZW1lbnRhdGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBWYWx1ZU1hcHBpbmdJbmZvIGdldFZh\nbHVlSW5mbygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRWYWx1ZUluZm8o\nKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWVIYW5kbGVyIGdldEhhbmRsZXIo\nKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0SGFuZGxlcigpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldEhhbmRsZXIoVmFsdWVIYW5kbGVyIGhhbmRs\nZXIpIHsKICAgICAgICBfdmFsLnNldEhhbmRsZXIoaGFuZGxlcik7CiAgICB9\nCgogICAgcHVibGljIEZpZWxkTWFwcGluZyBnZXRGaWVsZE1hcHBpbmcoKSB7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIENsYXNz\nTWFwcGluZyBnZXRUeXBlTWFwcGluZygpIHsKICAgICAgICByZXR1cm4gX3Zh\nbC5nZXRUeXBlTWFwcGluZygpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01h\ncHBpbmcgZ2V0RGVjbGFyZWRUeXBlTWFwcGluZygpIHsKICAgICAgICByZXR1\ncm4gX3ZhbC5nZXREZWNsYXJlZFR5cGVNYXBwaW5nKCk7CiAgICB9CgogICAg\ncHVibGljIENsYXNzTWFwcGluZyBnZXRFbWJlZGRlZE1hcHBpbmcoKSB7CiAg\nICAgICAgcmV0dXJuIF92YWwuZ2V0RW1iZWRkZWRNYXBwaW5nKCk7CiAgICB9\nCgogICAgcHVibGljIEZpZWxkTWFwcGluZyBnZXRWYWx1ZU1hcHBlZEJ5TWFw\ncGluZygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRWYWx1ZU1hcHBlZEJ5\nTWFwcGluZygpOwogICAgfQoKICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1\nbW5zKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldENvbHVtbnMoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb2x1bW5zKENvbHVtbltdIGNvbHMp\nIHsKICAgICAgICBfdmFsLnNldENvbHVtbnMoY29scyk7CiAgICB9CgogICAg\ncHVibGljIENvbHVtbklPIGdldENvbHVtbklPKCkgewogICAgICAgIHJldHVy\nbiBfdmFsLmdldENvbHVtbklPKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0Q29sdW1uSU8oQ29sdW1uSU8gaW8pIHsKICAgICAgICBfdmFsLnNldENv\nbHVtbklPKGlvKTsKICAgIH0KCiAgICBwdWJsaWMgRm9yZWlnbktleSBnZXRG\nb3JlaWduS2V5KCkgewogICAgICAgIHJldHVybiBfdmFsLmdldEZvcmVpZ25L\nZXkoKTsKICAgIH0KCiAgICBwdWJsaWMgRm9yZWlnbktleSBnZXRGb3JlaWdu\nS2V5KENsYXNzTWFwcGluZyB0YXJnZXQpIHsKICAgICAgICByZXR1cm4gX3Zh\nbC5nZXRGb3JlaWduS2V5KHRhcmdldCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0Rm9yZWlnbktleShGb3JlaWduS2V5IGZrKSB7CiAgICAgICAgX3Zh\nbC5zZXRGb3JlaWduS2V5KGZrKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdl\ndEpvaW5EaXJlY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Sm9p\nbkRpcmVjdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEpvaW5E\naXJlY3Rpb24oaW50IGRpcmVjdGlvbikgewogICAgICAgIF92YWwuc2V0Sm9p\nbkRpcmVjdGlvbihkaXJlY3Rpb24pOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldEZvcmVpZ25LZXkoUm93IHJvdywgT3BlbkpQQVN0YXRlTWFuYWdlciBz\nbSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBfdmFs\nLnNldEZvcmVpZ25LZXkocm93LCBzbSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgd2hlcmVGb3JlaWduS2V5KFJvdyByb3csIE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nX3ZhbC53aGVyZUZvcmVpZ25LZXkocm93LCBzbSk7CiAgICB9CgogICAgcHVi\nbGljIENsYXNzTWFwcGluZ1tdIGdldEluZGVwZW5kZW50VHlwZU1hcHBpbmdz\nKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldEluZGVwZW5kZW50VHlwZU1h\ncHBpbmdzKCk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRTZWxlY3RTdWJj\nbGFzc2VzKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldFNlbGVjdFN1YmNs\nYXNzZXMoKTsKICAgIH0KCiAgICBwdWJsaWMgVW5pcXVlIGdldFZhbHVlVW5p\ncXVlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldFZhbHVlVW5pcXVlKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VmFsdWVVbmlxdWUoVW5pcXVl\nIHVucSkgewogICAgICAgIF92YWwuc2V0VmFsdWVVbmlxdWUodW5xKTsKICAg\nIH0KCiAgICBwdWJsaWMgSW5kZXggZ2V0VmFsdWVJbmRleCgpIHsKICAgICAg\nICByZXR1cm4gX3ZhbC5nZXRWYWx1ZUluZGV4KCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0VmFsdWVJbmRleChJbmRleCBpZHgpIHsKICAgICAgICBf\ndmFsLnNldFZhbHVlSW5kZXgoaWR4KTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBnZXRVc2VDbGFzc0NyaXRlcmlhKCkgewogICAgICAgIHJldHVybiBf\ndmFsLmdldFVzZUNsYXNzQ3JpdGVyaWEoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRVc2VDbGFzc0NyaXRlcmlhKGJvb2xlYW4gY3JpdGVyaWEpIHsK\nICAgICAgICBfdmFsLnNldFVzZUNsYXNzQ3JpdGVyaWEoY3JpdGVyaWEpOwog\nICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0UG9seW1vcnBoaWMoKSB7CiAgICAg\nICAgcmV0dXJuIF92YWwuZ2V0UG9seW1vcnBoaWMoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRQb2x5bW9ycGhpYyhpbnQgcG9seSkgewogICAgICAg\nIF92YWwuc2V0UG9seW1vcnBoaWMocG9seSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgbWFwQ29uc3RyYWludHMoU3RyaW5nIG5hbWUsIGJvb2xlYW4gYWRh\ncHQpIHsKICAgICAgICBfdmFsLm1hcENvbnN0cmFpbnRzKG5hbWUsIGFkYXB0\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb3B5TWFwcGluZ0luZm8oVmFs\ndWVNYXBwaW5nIHZtKSB7CiAgICAgICAgX3ZhbC5jb3B5TWFwcGluZ0luZm8o\ndm0pOwogICAgfQp9Cg==\n","encoding":"base64"}

