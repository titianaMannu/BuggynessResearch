{"sha":"296af4e89264c13c56c5facc585f620351c6cde7","node_id":"MDQ6QmxvYjIwNjM2NDoyOTZhZjRlODkyNjRjMTNjNTZjNWZhY2M1ODVmNjIwMzUxYzZjZGU3","size":44047,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/296af4e89264c13c56c5facc585f620351c6cde7","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nTW9kaWZpZXI7CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nc3RyYXRzLkJsb2JWYWx1ZUhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5CeXRlQXJyYXlWYWx1ZUhhbmRsZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5D\naGFyQXJyYXlTdHJlYW1WYWx1ZUhhbmRsZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5DaGFyQXJyYXlWYWx1ZUhhbmRs\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5DbGFzc05hbWVEaXNjcmltaW5hdG9yU3RyYXRlZ3k7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5DbG9iVmFsdWVIYW5k\nbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJh\ndHMuRW1iZWRGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuRW1iZWRkZWRDbGFzc1N0cmF0ZWd5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRmxh\ndENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5GdWxsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLkhhbmRsZXJGaWVsZFN0\ncmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuSW1tdXRhYmxlVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTWF4RW1iZWRkZWRCbG9iRmll\nbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuc3RyYXRzLk1heEVtYmVkZGVkQnl0ZUFycmF5RmllbGRTdHJhdGVneTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk1h\neEVtYmVkZGVkQ2hhckFycmF5RmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk1heEVtYmVkZGVkQ2xv\nYkZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5Ob25lQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVEaXNjcmltaW5h\ndG9yU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5Ob25lRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVWZXJzaW9uU3RyYXRl\nZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5OdW1iZXJWZXJzaW9uU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5PYmplY3RJZENsYXNzU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5P\nYmplY3RJZFZhbHVlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuc3RyYXRzLlByaW1pdGl2ZUZpZWxkU3RyYXRlZ3k7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5SZWxh\ndGlvbkNvbGxlY3Rpb25JbnZlcnNlS2V5RmllbGRTdHJhdGVneTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlJlbGF0aW9u\nQ29sbGVjdGlvblRhYmxlRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlJlbGF0aW9uRmllbGRTdHJh\ndGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3Ry\nYXRzLlJlbGF0aW9uTWFwSW52ZXJzZUtleUZpZWxkU3RyYXRlZ3k7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5SZWxhdGlv\nbk1hcFRhYmxlRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlN0YXRlQ29tcGFyaXNvblZlcnNpb25T\ndHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nc3RyYXRzLlN0cmluZ0ZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5TdWJjbGFzc0pvaW5EaXNjcmlt\naW5hdG9yU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5TdXBlcmNsYXNzRGlzY3JpbWluYXRvclN0cmF0ZWd5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMu\nU3VwZXJjbGFzc1ZlcnNpb25TdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlRpbWVzdGFtcFZlcnNpb25TdHJh\ndGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3Ry\nYXRzLlVudHlwZWRQQ1ZhbHVlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlZhbHVlTWFwRGlzY3JpbWluYXRv\nclN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuVmVydGljYWxDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFHcm91cDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuSm9pblN5bnRheGVz\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3Vy\nYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVs\nZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2\nYVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURh\ndGFSZXBvc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nT3JkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5TZXF1ZW5j\nZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFs\ndWVNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1l\ndGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAqIFJlcG9zaXRvcnkgb2Ygb2JqZWN0\nL3JlbGF0aW9uYWwgbWFwcGluZyBpbmZvcm1hdGlvbi4KICoKICogQGF1dGhv\nciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBNYXBwaW5nUmVwb3NpdG9y\neQogICAgZXh0ZW5kcyBNZXRhRGF0YVJlcG9zaXRvcnkgewoKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UKICAgICAgICAoTWFwcGluZ1JlcG9zaXRvcnkuY2xhc3MpOwog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwIF9oYW5kbGVycyA9IG5ldyBI\nYXNoTWFwKCk7CgogICAgc3RhdGljIHsKICAgICAgICAvLyByZWdpc3RlciBk\nZWZhdWx0IHZhbHVlIGhhbmRsZXJzCiAgICAgICAgX2hhbmRsZXJzLnB1dCgi\namF2YS5sYW5nLkVudW0iLAogICAgICAgICAgICAib3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuRW51bVZhbHVlSGFuZGxlciIpOwogICAg\nfQoKICAgIHByaXZhdGUgREJEaWN0aW9uYXJ5IF9kaWN0ID0gbnVsbDsKICAg\nIHByaXZhdGUgTWFwcGluZ0RlZmF1bHRzIF9kZWZhdWx0cyA9IG51bGw7CiAg\nICBwcml2YXRlIE1hcCBfcmVzdWx0cyA9IG5ldyBIYXNoTWFwKCk7IC8vIG9i\namVjdC0+cXVlcnlyZXN1bHRtYXBwaW5nCiAgICBwcml2YXRlIFNjaGVtYUdy\nb3VwIF9zY2hlbWEgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJhdGVneUluc3Rh\nbGxlciBfaW5zdGFsbGVyID0gbnVsbDsKCiAgICAvKioKICAgICAqIERlZmF1\nbHQgY29uc3RydWN0b3IuICBDb25maWd1cmUgdmlhIAogICAgICoge0BsaW5r\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmFibGV9Lgog\nICAgICovCiAgICBwdWJsaWMgTWFwcGluZ1JlcG9zaXRvcnkoKSB7CiAgICAg\nICAgc2V0VmFsaWRhdGUoVkFMSURBVEVfTUFQUElORywgdHJ1ZSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDb252ZW5pZW50IGFjY2VzcyB0byBkaWN0aW9u\nYXJ5IGZvciBtYXBwaW5ncy4KICAgICAqLwogICAgcHVibGljIERCRGljdGlv\nbmFyeSBnZXREQkRpY3Rpb25hcnkoKSB7CiAgICAgICAgcmV0dXJuIF9kaWN0\nOwogICAgfQoKICAgIC8qKgogICAgICogTWFwcGluZyBkZWZhdWx0cy4KICAg\nICAqLwogICAgcHVibGljIE1hcHBpbmdEZWZhdWx0cyBnZXRNYXBwaW5nRGVm\nYXVsdHMoKSB7CiAgICAgICAgcmV0dXJuIF9kZWZhdWx0czsKICAgIH0KCiAg\nICAvKioKICAgICAqIE1hcHBpbmcgZGVmYXVsdC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0TWFwcGluZ0RlZmF1bHRzKE1hcHBpbmdEZWZhdWx0cyBk\nZWZhdWx0cykgewogICAgICAgIF9kZWZhdWx0cyA9IGRlZmF1bHRzOwogICAg\nfQoKICAgIC8qKgogICAgICogUmVwcmVzZW50YXRpb24gb2YgdGhlIGRhdGFi\nYXNlIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIHN5bmNocm9uaXplZCBT\nY2hlbWFHcm91cCBnZXRTY2hlbWFHcm91cCgpIHsKICAgICAgICBpZiAoX3Nj\naGVtYSA9PSBudWxsKQogICAgICAgICAgICBfc2NoZW1hID0gKChKREJDQ29u\nZmlndXJhdGlvbikgZ2V0Q29uZmlndXJhdGlvbigpKS4KICAgICAgICAgICAg\nICAgIGdldFNjaGVtYUZhY3RvcnlJbnN0YW5jZSgpLnJlYWRTY2hlbWEoKTsK\nICAgICAgICByZXR1cm4gX3NjaGVtYTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJlcHJlc2VudGF0aW9uIG9mIHRoZSBkYXRhYmFzZSBzY2hlbWEuCiAgICAg\nKi8KICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBzZXRTY2hlbWFHcm91\ncChTY2hlbWFHcm91cCBzY2hlbWEpIHsKICAgICAgICBfc2NoZW1hID0gc2No\nZW1hOwogICAgfQoKICAgIC8qKgogICAgICogSW5zdGFsbHMgbWFwcGluZyBz\ndHJhdGVnaWVzIG9uIGNvbXBvbmVudHMuCiAgICAgKi8KICAgIHB1YmxpYyBz\neW5jaHJvbml6ZWQgU3RyYXRlZ3lJbnN0YWxsZXIgZ2V0U3RyYXRlZ3lJbnN0\nYWxsZXIoKSB7CiAgICAgICAgaWYgKF9pbnN0YWxsZXIgPT0gbnVsbCkKICAg\nICAgICAgICAgX2luc3RhbGxlciA9IG5ldyBSdW50aW1lU3RyYXRlZ3lJbnN0\nYWxsZXIodGhpcyk7CiAgICAgICAgcmV0dXJuIF9pbnN0YWxsZXI7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbnN0YWxscyBtYXBwaW5nIHN0cmF0ZWdpZXMg\nb24gY29tcG9uZW50cy4KICAgICAqLwogICAgcHVibGljIHN5bmNocm9uaXpl\nZCB2b2lkIHNldFN0cmF0ZWd5SW5zdGFsbGVyKFN0cmF0ZWd5SW5zdGFsbGVy\nIGluc3RhbGxlcikgewogICAgICAgIF9pbnN0YWxsZXIgPSBpbnN0YWxsZXI7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHF1ZXJ5IHJlc3Vs\ndCBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4gbmFtZS4KICAgICAqLwogICAgcHVi\nbGljIHN5bmNocm9uaXplZCBRdWVyeVJlc3VsdE1hcHBpbmcgZ2V0UXVlcnlS\nZXN1bHRNYXBwaW5nKENsYXNzIGNscywKICAgICAgICBTdHJpbmcgbmFtZSwg\nQ2xhc3NMb2FkZXIgZW52TG9hZGVyLCBib29sZWFuIG11c3RFeGlzdCkgewog\nICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZyByZXMgPSBnZXRRdWVyeVJlc3Vs\ndE1hcHBpbmdJbnRlcm5hbChjbHMsIG5hbWUsCiAgICAgICAgICAgIGVudkxv\nYWRlcik7CiAgICAgICAgaWYgKHJlcyA9PSBudWxsICYmIG11c3RFeGlzdCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby1xdWVyeS1yZXMiLCBjbHMsIG5hbWUpKTsKICAgICAgICByZXR1\ncm4gcmVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuZWQgdGhlIHF1\nZXJ5IHJlc3VsdCBtYXBwaW5nIHdpdGggdGhlIGdpdmVuIG5hbWUuCiAgICAg\nKi8KICAgIHByaXZhdGUgUXVlcnlSZXN1bHRNYXBwaW5nIGdldFF1ZXJ5UmVz\ndWx0TWFwcGluZ0ludGVybmFsKENsYXNzIGNscywKICAgICAgICBTdHJpbmcg\nbmFtZSwgQ2xhc3NMb2FkZXIgZW52TG9hZGVyKSB7CiAgICAgICAgaWYgKG5h\nbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIC8vIGNoZWNrIGNhY2hlCiAgICAgICAgT2JqZWN0IGtleSA9IGdldFF1ZXJ5\nUmVzdWx0S2V5KGNscywgbmFtZSk7CiAgICAgICAgUXVlcnlSZXN1bHRNYXBw\naW5nIHJlcyA9IChRdWVyeVJlc3VsdE1hcHBpbmcpIF9yZXN1bHRzLmdldChr\nZXkpOwogICAgICAgIGlmIChyZXMgIT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIHJlczsKCiAgICAgICAgLy8gZ2V0IG1ldGFkYXRhIGZvciBjbGFzcywg\nd2hpY2ggd2lsbCBmaW5kIHJlc3VsdHMgaW4gbWV0YWRhdGEgZmlsZQogICAg\nICAgIGlmIChjbHMgIT0gbnVsbCAmJiBnZXRNZXRhRGF0YShjbHMsIGVudkxv\nYWRlciwgZmFsc2UpICE9IG51bGwpIHsKICAgICAgICAgICAgcmVzID0gKFF1\nZXJ5UmVzdWx0TWFwcGluZykgX3Jlc3VsdHMuZ2V0KGtleSk7CiAgICAgICAg\nICAgIGlmIChyZXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBy\nZXM7CiAgICAgICAgfQogICAgICAgIGlmICgoZ2V0U291cmNlTW9kZSgpICYg\nTU9ERV9RVUVSWSkgPT0gMCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIC8vIG5vdCBpbiBjYWNoZTsgbG9hZAogICAgICAgIGdldE1ldGFE\nYXRhRmFjdG9yeSgpLmxvYWQoY2xzLCBNT0RFX1FVRVJZLCBlbnZMb2FkZXIp\nOwogICAgICAgIHJldHVybiAoUXVlcnlSZXN1bHRNYXBwaW5nKSBfcmVzdWx0\ncy5nZXQoa2V5KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhbGwg\nY2FjaGVkIHF1ZXJ5IHJlc3VsdCBtYXBwaW5ncy4KICAgICAqLwogICAgcHVi\nbGljIHN5bmNocm9uaXplZCBRdWVyeVJlc3VsdE1hcHBpbmdbXSBnZXRRdWVy\neVJlc3VsdE1hcHBpbmdzKCkgewogICAgICAgIENvbGxlY3Rpb24gdmFsdWVz\nID0gX3Jlc3VsdHMudmFsdWVzKCk7CiAgICAgICAgcmV0dXJuIChRdWVyeVJl\nc3VsdE1hcHBpbmdbXSkgdmFsdWVzLnRvQXJyYXkKICAgICAgICAgICAgKG5l\ndyBRdWVyeVJlc3VsdE1hcHBpbmdbdmFsdWVzLnNpemUoKV0pOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjYWNoZWQgcXVlcnkgcmVzdWx0\nIG1hcHBpbmcgd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVsbCBpZgogICAg\nICogbm9uZS4KICAgICAqLwogICAgcHVibGljIHN5bmNocm9uaXplZCBRdWVy\neVJlc3VsdE1hcHBpbmcgZ2V0Q2FjaGVkUXVlcnlSZXN1bHRNYXBwaW5nCiAg\nICAgICAgKENsYXNzIGNscywgU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1\ncm4gKFF1ZXJ5UmVzdWx0TWFwcGluZykgX3Jlc3VsdHMuZ2V0KGdldFF1ZXJ5\nUmVzdWx0S2V5KGNscywgbmFtZSkpOwogICAgfQoKICAgIC8qKgogICAgICog\nQWRkIGEgcXVlcnkgcmVzdWx0IG1hcHBpbmcuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzeW5jaHJvbml6ZWQgUXVlcnlSZXN1bHRNYXBwaW5nIGFkZFF1ZXJ5UmVz\ndWx0TWFwcGluZyhDbGFzcyBjbHMsCiAgICAgICAgU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcgcmVzID0gbmV3IFF1ZXJ5UmVz\ndWx0TWFwcGluZyhuYW1lLCB0aGlzKTsKICAgICAgICByZXMuc2V0RGVmaW5p\nbmdUeXBlKGNscyk7CiAgICAgICAgX3Jlc3VsdHMucHV0KGdldFF1ZXJ5UmVz\ndWx0S2V5KHJlcyksIHJlcyk7CiAgICAgICAgcmV0dXJuIHJlczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJlbW92ZSBhIHF1ZXJ5IHJlc3VsdCBtYXBwaW5n\nLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIGJvb2xlYW4gcmVt\nb3ZlUXVlcnlSZXN1bHRNYXBwaW5nCiAgICAgICAgKFF1ZXJ5UmVzdWx0TWFw\ncGluZyByZXMpIHsKICAgICAgICByZXR1cm4gX3Jlc3VsdHMucmVtb3ZlKGdl\ndFF1ZXJ5UmVzdWx0S2V5KHJlcykpICE9IG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZW1vdmUgYSBxdWVyeSByZXN1bHQgbWFwcGluZy4KICAgICAq\nLwogICAgcHVibGljIHN5bmNocm9uaXplZCBib29sZWFuIHJlbW92ZVF1ZXJ5\nUmVzdWx0TWFwcGluZyhDbGFzcyBjbHMsCiAgICAgICAgU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIF9yZXN1bHRzLnJlbW92ZShnZXRR\ndWVyeVJlc3VsdEtleShjbHMsIG5hbWUpKSAhPSBudWxsOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIGEgdW5pcXVlIGtleSBmb3IgdGhlIGdpdmVu\nIG1hcHBpbmcuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBn\nZXRRdWVyeVJlc3VsdEtleShRdWVyeVJlc3VsdE1hcHBpbmcgcmVzKSB7CiAg\nICAgICAgaWYgKHJlcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICByZXR1cm4gZ2V0UXVlcnlSZXN1bHRLZXkocmVzLmdldERl\nZmluaW5nVHlwZSgpLCByZXMuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIHVuaXF1ZSBrZXkgZm9yIHRoZSBnaXZlbiBjbGFz\ncyAvIG5hbWUuIFRoZSBjbGFzcyBhcmd1bWVudAogICAgICogY2FuIGJlIG51\nbGwuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBnZXRRdWVy\neVJlc3VsdEtleShDbGFzcyBjbHMsIFN0cmluZyBuYW1lKSB7CiAgICAgICAg\ncmV0dXJuIGdldFF1ZXJ5S2V5KGNscywgbmFtZSk7CiAgICB9CgogICAgcHVi\nbGljIENsYXNzTWFwcGluZyBnZXRNYXBwaW5nKENsYXNzIGNscywgQ2xhc3NM\nb2FkZXIgZW52TG9hZGVyLAogICAgICAgIGJvb2xlYW4gbXVzdEV4aXN0KSB7\nCiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcpIHN1cGVyLmdldE1ldGFE\nYXRhKGNscywgZW52TG9hZGVyLCBtdXN0RXhpc3QpOwogICAgfQoKICAgIHB1\nYmxpYyBDbGFzc01hcHBpbmdbXSBnZXRNYXBwaW5ncygpIHsKICAgICAgICBy\nZXR1cm4gKENsYXNzTWFwcGluZ1tdKSBzdXBlci5nZXRNZXRhRGF0YXMoKTsK\nICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNYXBwaW5nIGdldE1hcHBpbmcoT2Jq\nZWN0IG9pZCwgQ2xhc3NMb2FkZXIgZW52TG9hZGVyLAogICAgICAgIGJvb2xl\nYW4gbXVzdEV4aXN0KSB7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcp\nIHN1cGVyLmdldE1ldGFEYXRhKG9pZCwgZW52TG9hZGVyLCBtdXN0RXhpc3Qp\nOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01hcHBpbmdbXSBnZXRJbXBsZW1l\nbnRvck1hcHBpbmdzKENsYXNzIGNscywKICAgICAgICBDbGFzc0xvYWRlciBl\nbnZMb2FkZXIsIGJvb2xlYW4gbXVzdEV4aXN0KSB7CiAgICAgICAgcmV0dXJu\nIChDbGFzc01hcHBpbmdbXSkgc3VwZXIuZ2V0SW1wbGVtZW50b3JNZXRhRGF0\nYXMoY2xzLCBlbnZMb2FkZXIsCiAgICAgICAgICAgIG11c3RFeGlzdCk7CiAg\nICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIGNsZWFyKCkgewog\nICAgICAgIHN1cGVyLmNsZWFyKCk7CiAgICAgICAgX3NjaGVtYSA9IG51bGw7\nCiAgICAgICAgX3Jlc3VsdHMuY2xlYXIoKTsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgdm9pZCBwcmVwYXJlTWFwcGluZyhDbGFzc01ldGFEYXRhIG1ldGEpIHsK\nICAgICAgICAvLyBtYWtlIHN1cmUgc3VwZXJjbGFzcyByZXNvbHZlZCBmaXJz\ndDsgcmVzb2x2aW5nIHN1cGVyY2xhc3MgbWF5IGhhdmUKICAgICAgICAvLyBy\nZXNvbHZlZCB0aGlzIG1hcHBpbmcKICAgICAgICBDbGFzc01hcHBpbmcgbWFw\ncGluZyA9IChDbGFzc01hcHBpbmcpIG1ldGE7CiAgICAgICAgQ2xhc3NNYXBw\naW5nIHN1cCA9IG1hcHBpbmcuZ2V0UENTdXBlcmNsYXNzTWFwcGluZygpOwog\nICAgICAgIGlmIChzdXAgIT0gbnVsbCAmJiAobWFwcGluZy5nZXRSZXNvbHZl\nKCkgJiBNT0RFX01BUFBJTkcpICE9IDApCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgLy8gZGVmaW5lIHN1cGVyY2xhc3MgZmllbGRzIGFmdGVyIG1h\ncHBpbmcgY2xhc3MsIHNvIHdlIGNhbiB0ZWxsIHdoZXRoZXIKICAgICAgICAv\nLyB0aGUgY2xhc3MgaXMgbWFwcGVkIGFuZCBuZWVkcyB0byByZWRlZmluZSBh\nYnN0cmFjdCBzdXBlcmNsYXNzIGZpZWxkcwogICAgICAgIGdldFN0cmF0ZWd5\nSW5zdGFsbGVyKCkuaW5zdGFsbFN0cmF0ZWd5KG1hcHBpbmcpOwogICAgICAg\nIG1hcHBpbmcuZGVmaW5lU3VwZXJjbGFzc0ZpZWxkcyhtYXBwaW5nLmdldEpv\naW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpCiAgICAgICAgICAgID09IG51\nbGwpOwoKICAgICAgICAvLyByZXNvbHZlIGV2ZXJ5dGhpbmcgdGhhdCBkb2Vz\nbid0IGludm9sdmUgcmVsYXRpb25zIHRvIGFsbG93IHJlbGF0aW9uCiAgICAg\nICAgLy8gbWFwcGluZ3MgdG8gdXNlIHRoZSBvdGhlcnMgYXMgam9pbmFibGVz\nCiAgICAgICAgbWFwcGluZy5yZXNvbHZlTm9uUmVsYXRpb25NYXBwaW5ncygp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBDbGFzc01ldGFEYXRhIG5ld0NsYXNz\nTWV0YURhdGEoQ2xhc3MgdHlwZSkgewogICAgICAgIHJldHVybiBuZXcgQ2xh\nc3NNYXBwaW5nKHR5cGUsIHRoaXMpOwogICAgfQoKICAgIHByb3RlY3RlZCBD\nbGFzc01ldGFEYXRhW10gbmV3Q2xhc3NNZXRhRGF0YUFycmF5KGludCBsZW5n\ndGgpIHsKICAgICAgICByZXR1cm4gbmV3IENsYXNzTWFwcGluZ1tsZW5ndGhd\nOwogICAgfQoKICAgIHByb3RlY3RlZCBGaWVsZE1ldGFEYXRhIG5ld0ZpZWxk\nTWV0YURhdGEoU3RyaW5nIG5hbWUsIENsYXNzIHR5cGUsCiAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBvd25lcikgewogICAgICAgIHJldHVybiBuZXcgRmllbGRN\nYXBwaW5nKG5hbWUsIHR5cGUsIChDbGFzc01hcHBpbmcpIG93bmVyKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgRmllbGRNZXRhRGF0YVtdIG5ld0ZpZWxkTWV0\nYURhdGFBcnJheShpbnQgbGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBG\naWVsZE1hcHBpbmdbbGVuZ3RoXTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xh\nc3NNZXRhRGF0YSBuZXdFbWJlZGRlZENsYXNzTWV0YURhdGEoVmFsdWVNZXRh\nRGF0YSBvd25lcikgewogICAgICAgIHJldHVybiBuZXcgQ2xhc3NNYXBwaW5n\nKG93bmVyKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgVmFsdWVNZXRhRGF0YSBu\nZXdWYWx1ZU1ldGFEYXRhKEZpZWxkTWV0YURhdGEgb3duZXIpIHsKICAgICAg\nICByZXR1cm4gbmV3IFZhbHVlTWFwcGluZ0ltcGwoKEZpZWxkTWFwcGluZykg\nb3duZXIpOwogICAgfQoKICAgIHByb3RlY3RlZCBTZXF1ZW5jZU1ldGFEYXRh\nIG5ld1NlcXVlbmNlTWV0YURhdGEoU3RyaW5nIG5hbWUpIHsKICAgICAgICBy\nZXR1cm4gbmV3IFNlcXVlbmNlTWFwcGluZyhuYW1lLCB0aGlzKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgT3JkZXIgbmV3VmFsdWVPcmRlcihGaWVsZE1ldGFE\nYXRhIG93bmVyLCBib29sZWFuIGFzYykgewogICAgICAgIHJldHVybiBuZXcg\nSkRCQ1ZhbHVlT3JkZXIoKEZpZWxkTWFwcGluZykgb3duZXIsIGFzYyk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIE9yZGVyIG5ld1JlbGF0ZWRGaWVsZE9yZGVy\nKEZpZWxkTWV0YURhdGEgb3duZXIsCiAgICAgICAgRmllbGRNZXRhRGF0YSBy\nZWwsIGJvb2xlYW4gYXNjKSB7CiAgICAgICAgcmV0dXJuIG5ldyBKREJDUmVs\nYXRlZEZpZWxkT3JkZXIoKEZpZWxkTWFwcGluZykgb3duZXIsCiAgICAgICAg\nICAgIChGaWVsZE1hcHBpbmcpIHJlbCwgYXNjKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgT3JkZXJbXSBuZXdPcmRlckFycmF5KGludCBzaXplKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBKREJDT3JkZXJbc2l6ZV07CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgdmVyc2lvbiBtZXRhZGF0YSBmb3IgdGhlIGdpdmVu\nIGNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgVmVyc2lvbiBuZXdWZXJz\naW9uKENsYXNzTWFwcGluZyBjbHMpIHsKICAgICAgICByZXR1cm4gbmV3IFZl\ncnNpb24oY2xzKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBkaXNj\ncmltaW5hdG9yIG1ldGFkYXRhIGZvciB0aGUgZ2l2ZW4gY2xhc3MuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBEaXNjcmltaW5hdG9yIG5ld0Rpc2NyaW1pbmF0\nb3IoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIHJldHVybiBuZXcgRGlz\nY3JpbWluYXRvcihjbHMpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRl\nIHJhdyBtYXBwaW5nIGluZm8gZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIENsYXNzTWFwcGluZ0luZm8gbmV3TWFwcGlu\nZ0luZm8oQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIENsYXNzTWFwcGlu\nZ0luZm8gaW5mbyA9IG5ldyBDbGFzc01hcHBpbmdJbmZvKCk7CiAgICAgICAg\naW5mby5zZXRDbGFzc05hbWUoY2xzLmdldERlc2NyaWJlZFR5cGUoKS5nZXRO\nYW1lKCkpOwogICAgICAgIHJldHVybiBpbmZvOwogICAgfQoKICAgIC8qKgog\nICAgICogQ3JlYXRlIHJhdyBtYXBwaW5nIGluZm8gZm9yIHRoZSBnaXZlbiBp\nbnN0YW5jZS4KICAgICAqLwogICAgcHJvdGVjdGVkIEZpZWxkTWFwcGluZ0lu\nZm8gbmV3TWFwcGluZ0luZm8oRmllbGRNYXBwaW5nIGZtKSB7CiAgICAgICAg\ncmV0dXJuIG5ldyBGaWVsZE1hcHBpbmdJbmZvKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgcmF3IG1hcHBpbmcgaW5mbyBmb3IgdGhlIGdpdmVu\nIGluc3RhbmNlLgogICAgICovCiAgICBwcm90ZWN0ZWQgVmFsdWVNYXBwaW5n\nSW5mbyBuZXdNYXBwaW5nSW5mbyhWYWx1ZU1hcHBpbmcgdm0pIHsKICAgICAg\nICByZXR1cm4gbmV3IFZhbHVlTWFwcGluZ0luZm8oKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSByYXcgbWFwcGluZyBpbmZvIGZvciB0aGUgZ2l2\nZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByb3RlY3RlZCBWZXJzaW9uTWFw\ncGluZ0luZm8gbmV3TWFwcGluZ0luZm8oVmVyc2lvbiB2ZXJzaW9uKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBWZXJzaW9uTWFwcGluZ0luZm8oKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENyZWF0ZSByYXcgbWFwcGluZyBpbmZvIGZvciB0\naGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByb3RlY3RlZCBEaXNj\ncmltaW5hdG9yTWFwcGluZ0luZm8gbmV3TWFwcGluZ0luZm8oRGlzY3JpbWlu\nYXRvciBkaXNjKSB7CiAgICAgICAgcmV0dXJuIG5ldyBEaXNjcmltaW5hdG9y\nTWFwcGluZ0luZm8oKTsKICAgIH0KCiAgICAvKioKICAgICAqIEluc3RhbnRp\nYXRlIHRoZSBnaXZlbiBjbGFzcycgbmFtZWQgc3RyYXRlZ3ksIG9yIHJldHVy\nbiBudWxsIGlmIG5vCiAgICAgKiBuYW1lZCBzdHJhdGVneS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIENsYXNzU3RyYXRlZ3kgbmFtZWRTdHJhdGVneShDbGFz\nc01hcHBpbmcgY2xzKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBjbHMuZ2V0\nTWFwcGluZ0luZm8oKS5nZXRTdHJhdGVneSgpOwogICAgICAgIGlmIChuYW1l\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJl\ndHVybiBpbnN0YW50aWF0ZUNsYXNzU3RyYXRlZ3kobmFtZSwgY2xzKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc3RyYXRlZ3kgZm9yIHRo\nZSBnaXZlbiBuYW1lLgogICAgICovCiAgICBwcm90ZWN0ZWQgQ2xhc3NTdHJh\ndGVneSBpbnN0YW50aWF0ZUNsYXNzU3RyYXRlZ3koU3RyaW5nIG5hbWUsCiAg\nICAgICAgQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIGlmIChOb25lQ2xh\nc3NTdHJhdGVneS5BTElBUy5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgIHJl\ndHVybiBOb25lQ2xhc3NTdHJhdGVneS5nZXRJbnN0YW5jZSgpOwoKICAgICAg\nICBTdHJpbmcgcHJvcHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVz\nKG5hbWUpOwogICAgICAgIG5hbWUgPSBDb25maWd1cmF0aW9ucy5nZXRDbGFz\nc05hbWUobmFtZSk7CiAgICAgICAgQ2xhc3Mgc3RyYXQgPSBudWxsOwoKICAg\nICAgICAvLyBiYXNlIGFuZCB2ZXJ0aWNhbCBzdHJhdGVnaWVzIHVzZSBzYW1l\nIGFsaWFzOyBkaWZmZXJlbnRpYXRlIG9uIGpvaW4KICAgICAgICBpZiAoRnVs\nbENsYXNzU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5hbWUpKQogICAgICAgICAg\nICBzdHJhdCA9IEZ1bGxDbGFzc1N0cmF0ZWd5LmNsYXNzOwogICAgICAgIGVs\nc2UgaWYgKEZsYXRDbGFzc1N0cmF0ZWd5LkFMSUFTLmVxdWFscyhuYW1lKSkK\nICAgICAgICAgICAgc3RyYXQgPSBGbGF0Q2xhc3NTdHJhdGVneS5jbGFzczsK\nICAgICAgICBlbHNlIGlmIChWZXJ0aWNhbENsYXNzU3RyYXRlZ3kuQUxJQVMu\nZXF1YWxzKG5hbWUpKQogICAgICAgICAgICBzdHJhdCA9IFZlcnRpY2FsQ2xh\nc3NTdHJhdGVneS5jbGFzczsKICAgICAgICB0cnkgewogICAgICAgICAgICBp\nZiAoc3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHN0cmF0ID0gSmF2\nYVR5cGVzLmNsYXNzRm9yTmFtZShuYW1lLCBjbHMsCiAgICAgICAgICAgICAg\nICAgICAgQ2xhc3NTdHJhdGVneS5jbGFzcy5nZXRDbGFzc0xvYWRlcigpKTsK\nICAgICAgICAgICAgQ2xhc3NTdHJhdGVneSBzdHJhdGVneSA9IChDbGFzc1N0\ncmF0ZWd5KSBzdHJhdC5uZXdJbnN0YW5jZSgpOwogICAgICAgICAgICBDb25m\naWd1cmF0aW9ucy5jb25maWd1cmVJbnN0YW5jZShzdHJhdGVneSwgZ2V0Q29u\nZmlndXJhdGlvbigpLAogICAgICAgICAgICAgICAgcHJvcHMpOwogICAgICAg\nICAgICByZXR1cm4gc3RyYXRlZ3k7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJiYWQtY2xzLXN0cmF0ZWd5IiwKICAgICAgICAgICAg\nICAgIGNscywgbmFtZSksIGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIEluc3RhbnRpYXRlIHRoZSBnaXZlbiBmaWVsZCdzIG5hbWVkIHN0\ncmF0ZWd5LCBvciByZXR1cm4gbnVsbCBpZiBubwogICAgICogbmFtZWQgc3Ry\nYXRlZ3kuCiAgICAgKi8KICAgIHByb3RlY3RlZCBGaWVsZFN0cmF0ZWd5IG5h\nbWVkU3RyYXRlZ3koRmllbGRNYXBwaW5nIGZpZWxkLAogICAgICAgIGJvb2xl\nYW4gaW5zdGFsbEhhbmRsZXJzKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBm\naWVsZC5nZXRNYXBwaW5nSW5mbygpLmdldFN0cmF0ZWd5KCk7CiAgICAgICAg\naWYgKG5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIGlmIChOb25lRmllbGRTdHJhdGVneS5BTElBUy5lcXVhbHMobmFt\nZSkpCiAgICAgICAgICAgIHJldHVybiBOb25lRmllbGRTdHJhdGVneS5nZXRJ\nbnN0YW5jZSgpOwoKICAgICAgICBTdHJpbmcgcHJvcHMgPSBDb25maWd1cmF0\naW9ucy5nZXRQcm9wZXJ0aWVzKG5hbWUpOwogICAgICAgIG5hbWUgPSBDb25m\naWd1cmF0aW9ucy5nZXRDbGFzc05hbWUobmFtZSk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgQ2xhc3MgYyA9IEphdmFUeXBlcy5jbGFzc0Zvck5hbWUo\nbmFtZSwgZmllbGQsCiAgICAgICAgICAgICAgICBGaWVsZFN0cmF0ZWd5LmNs\nYXNzLmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgICAgICBpZiAoRmllbGRT\ndHJhdGVneS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGMpKSB7CiAgICAgICAg\nICAgICAgICBGaWVsZFN0cmF0ZWd5IHN0cmF0ID0gKEZpZWxkU3RyYXRlZ3kp\nIGMubmV3SW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIENvbmZpZ3VyYXRp\nb25zLmNvbmZpZ3VyZUluc3RhbmNlKHN0cmF0LCBnZXRDb25maWd1cmF0aW9u\nKCksCiAgICAgICAgICAgICAgICAgICAgcHJvcHMpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHN0cmF0OwogICAgICAgICAgICB9CgogICAgICAgICAgICAv\nLyBtdXN0IGJlIG5hbWVkIGhhbmRsZXIKICAgICAgICAgICAgaWYgKGluc3Rh\nbGxIYW5kbGVycykgewogICAgICAgICAgICAgICAgVmFsdWVIYW5kbGVyIHZo\nID0gKFZhbHVlSGFuZGxlcikgYy5uZXdJbnN0YW5jZSgpOwogICAgICAgICAg\nICAgICAgQ29uZmlndXJhdGlvbnMuY29uZmlndXJlSW5zdGFuY2UodmgsIGdl\ndENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgICAgICAgICBwcm9wcyk7\nCiAgICAgICAgICAgICAgICBmaWVsZC5zZXRIYW5kbGVyKHZoKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXJGaWVsZFN0\ncmF0ZWd5KCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJiYWQtZmllbGQtc3RyYXRlZ3kiLAogICAgICAgICAgICAgICAgZmllbGQs\nIG5hbWUpLCBlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbnN0YW50aWF0ZSB0aGUgZ2l2ZW4gZGlzY3JpbWluYXRvcidzIG5hbWVkIHN0\ncmF0ZWd5LCBvciByZXR1cm4gbnVsbAogICAgICogaWYgbm8gbmFtZWQgc3Ry\nYXRlZ3kuCiAgICAgKi8KICAgIHByb3RlY3RlZCBEaXNjcmltaW5hdG9yU3Ry\nYXRlZ3kgbmFtZWRTdHJhdGVneShEaXNjcmltaW5hdG9yIGRpc2NyaW0pIHsK\nICAgICAgICBTdHJpbmcgbmFtZSA9IGRpc2NyaW0uZ2V0TWFwcGluZ0luZm8o\nKS5nZXRTdHJhdGVneSgpOwogICAgICAgIGlmIChuYW1lID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAvLyBpZiB0aGVyZSBp\ncyBhIG5hbWVkIHN0cmF0ZWd5IHByZXNlbnQsIGRpc2NhcmQgaXQgaWYgaXQg\nbWF0Y2hlcwogICAgICAgIC8vIHRoZSBiYXNlIHN0cmF0ZWd5LCBzbyB0aGF0\nIHdlIHdvbid0IGNyZWF0ZSBhbiBpbmRlcGVuZGVudCBpbnN0YW5jZQogICAg\nICAgIENsYXNzTWFwcGluZyBjbHMgPSBkaXNjcmltLmdldENsYXNzTWFwcGlu\nZygpOwogICAgICAgIHdoaWxlIChjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xh\nc3NNYXBwaW5nKCkgIT0gbnVsbCkKICAgICAgICAgICAgY2xzID0gY2xzLmdl\ndEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgIERpc2Ny\naW1pbmF0b3IgYmFzZSA9IGNscy5nZXREaXNjcmltaW5hdG9yKCk7CiAgICAg\nICAgaWYgKGJhc2UgIT0gZGlzY3JpbSAmJiBiYXNlLmdldFN0cmF0ZWd5KCkg\nIT0gbnVsbAogICAgICAgICAgICAmJiBuYW1lLmVxdWFscyhiYXNlLmdldFN0\ncmF0ZWd5KCkuZ2V0QWxpYXMoKSkpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICByZXR1cm4gaW5zdGFudGlhdGVEaXNjcmltaW5hdG9yU3Ry\nYXRlZ3kobmFtZSwgZGlzY3JpbSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbnN0YW50aWF0ZSB0aGUgZ2l2ZW4gZGlzY3JpbWluYXRvciBzdHJhdGVneS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIERpc2NyaW1pbmF0b3JTdHJhdGVneSBp\nbnN0YW50aWF0ZURpc2NyaW1pbmF0b3JTdHJhdGVneQogICAgICAgIChTdHJp\nbmcgbmFtZSwgRGlzY3JpbWluYXRvciBkaXNjcmltKSB7CiAgICAgICAgaWYg\nKE5vbmVEaXNjcmltaW5hdG9yU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5hbWUp\nKQogICAgICAgICAgICByZXR1cm4gTm9uZURpc2NyaW1pbmF0b3JTdHJhdGVn\neS5nZXRJbnN0YW5jZSgpOwoKICAgICAgICBTdHJpbmcgcHJvcHMgPSBDb25m\naWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKG5hbWUpOwogICAgICAgIG5hbWUg\nPSBDb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUobmFtZSk7CiAgICAgICAg\nQ2xhc3Mgc3RyYXQgPSBudWxsOwoKICAgICAgICBpZiAoQ2xhc3NOYW1lRGlz\nY3JpbWluYXRvclN0cmF0ZWd5LkFMSUFTLmVxdWFscyhuYW1lKSkKICAgICAg\nICAgICAgc3RyYXQgPSBDbGFzc05hbWVEaXNjcmltaW5hdG9yU3RyYXRlZ3ku\nY2xhc3M7CiAgICAgICAgZWxzZSBpZiAoVmFsdWVNYXBEaXNjcmltaW5hdG9y\nU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICBzdHJh\ndCA9IFZhbHVlTWFwRGlzY3JpbWluYXRvclN0cmF0ZWd5LmNsYXNzOwogICAg\nICAgIGVsc2UgaWYgKFN1YmNsYXNzSm9pbkRpc2NyaW1pbmF0b3JTdHJhdGVn\neS5BTElBUy5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgIHN0cmF0ID0gU3Vi\nY2xhc3NKb2luRGlzY3JpbWluYXRvclN0cmF0ZWd5LmNsYXNzOwoKICAgICAg\nICB0cnkgewogICAgICAgICAgICBpZiAoc3RyYXQgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHN0cmF0ID0gSmF2YVR5cGVzLmNsYXNzRm9yTmFtZShuYW1l\nLAogICAgICAgICAgICAgICAgICAgIGRpc2NyaW0uZ2V0Q2xhc3NNYXBwaW5n\nKCksCiAgICAgICAgICAgICAgICAgICAgRGlzY3JpbWluYXRvclN0cmF0ZWd5\nLmNsYXNzLmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgICAgICBEaXNjcmlt\naW5hdG9yU3RyYXRlZ3kgc3RyYXRlZ3kgPSAoRGlzY3JpbWluYXRvclN0cmF0\nZWd5KQogICAgICAgICAgICAgICAgc3RyYXQubmV3SW5zdGFuY2UoKTsKICAg\nICAgICAgICAgQ29uZmlndXJhdGlvbnMuY29uZmlndXJlSW5zdGFuY2Uoc3Ry\nYXRlZ3ksIGdldENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgICAgIHBy\nb3BzKTsKICAgICAgICAgICAgcmV0dXJuIHN0cmF0ZWd5OwogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBN\nZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWRpc2NyaW0tc3RyYXRl\nZ3kiLAogICAgICAgICAgICAgICAgZGlzY3JpbS5nZXRDbGFzc01hcHBpbmco\nKSwgbmFtZSksIGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIEluc3RhbnRpYXRlIHRoZSBnaXZlbiB2ZXJzaW9uJ3MgbmFtZWQgc3RyYXRl\nZ3ksIG9yIHJldHVybiBudWxsCiAgICAgKiBpZiBubyBuYW1lZCBzdHJhdGVn\neS4KICAgICAqLwogICAgcHJvdGVjdGVkIFZlcnNpb25TdHJhdGVneSBuYW1l\nZFN0cmF0ZWd5KFZlcnNpb24gdmVyc2lvbikgewogICAgICAgIFN0cmluZyBu\nYW1lID0gdmVyc2lvbi5nZXRNYXBwaW5nSW5mbygpLmdldFN0cmF0ZWd5KCk7\nCiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgbmFtZWQgc3RyYXRl\nZ3kgcHJlc2VudCwgZGlzY2FyZCBpdCBpZiBpdCBtYXRjaGVzCiAgICAgICAg\nLy8gdGhlIGJhc2Ugc3RyYXRlZ3ksIHNvIHRoYXQgd2Ugd29uJ3QgY3JlYXRl\nIGFuIGluZGVwZW5kZW50IGluc3RhbmNlCiAgICAgICAgQ2xhc3NNYXBwaW5n\nIGNscyA9IHZlcnNpb24uZ2V0Q2xhc3NNYXBwaW5nKCk7CiAgICAgICAgd2hp\nbGUgKGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBu\ndWxsKQogICAgICAgICAgICBjbHMgPSBjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVy\nY2xhc3NNYXBwaW5nKCk7CiAgICAgICAgVmVyc2lvbiBiYXNlID0gY2xzLmdl\ndFZlcnNpb24oKTsKICAgICAgICBpZiAoYmFzZSAhPSB2ZXJzaW9uICYmIGJh\nc2UuZ2V0U3RyYXRlZ3koKSAhPSBudWxsCiAgICAgICAgICAgICYmIG5hbWUu\nZXF1YWxzKGJhc2UuZ2V0U3RyYXRlZ3koKS5nZXRBbGlhcygpKSkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIHJldHVybiBpbnN0YW50aWF0\nZVZlcnNpb25TdHJhdGVneShuYW1lLCB2ZXJzaW9uKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEluc3RhbnRpYXRlIHRoZSBnaXZlbiB2ZXJzaW9uIHN0cmF0\nZWd5LgogICAgICovCiAgICBwcm90ZWN0ZWQgVmVyc2lvblN0cmF0ZWd5IGlu\nc3RhbnRpYXRlVmVyc2lvblN0cmF0ZWd5KFN0cmluZyBuYW1lLAogICAgICAg\nIFZlcnNpb24gdmVyc2lvbikgewogICAgICAgIGlmIChOb25lVmVyc2lvblN0\ncmF0ZWd5LkFMSUFTLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgcmV0dXJu\nIE5vbmVWZXJzaW9uU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsKCiAgICAgICAg\nU3RyaW5nIHByb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhu\nYW1lKTsKICAgICAgICBuYW1lID0gQ29uZmlndXJhdGlvbnMuZ2V0Q2xhc3NO\nYW1lKG5hbWUpOwogICAgICAgIENsYXNzIHN0cmF0ID0gbnVsbDsKCiAgICAg\nICAgaWYgKE51bWJlclZlcnNpb25TdHJhdGVneS5BTElBUy5lcXVhbHMobmFt\nZSkpCiAgICAgICAgICAgIHN0cmF0ID0gTnVtYmVyVmVyc2lvblN0cmF0ZWd5\nLmNsYXNzOwogICAgICAgIGVsc2UgaWYgKFRpbWVzdGFtcFZlcnNpb25TdHJh\ndGVneS5BTElBUy5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgIHN0cmF0ID0g\nVGltZXN0YW1wVmVyc2lvblN0cmF0ZWd5LmNsYXNzOwogICAgICAgIGVsc2Ug\naWYgKFN0YXRlQ29tcGFyaXNvblZlcnNpb25TdHJhdGVneS5BTElBUy5lcXVh\nbHMobmFtZSkpCiAgICAgICAgICAgIHN0cmF0ID0gU3RhdGVDb21wYXJpc29u\nVmVyc2lvblN0cmF0ZWd5LmNsYXNzOwoKICAgICAgICB0cnkgewogICAgICAg\nICAgICBpZiAoc3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHN0cmF0\nID0gSmF2YVR5cGVzLmNsYXNzRm9yTmFtZShuYW1lLAogICAgICAgICAgICAg\nICAgICAgIHZlcnNpb24uZ2V0Q2xhc3NNYXBwaW5nKCksCiAgICAgICAgICAg\nICAgICAgICAgVmVyc2lvblN0cmF0ZWd5LmNsYXNzLmdldENsYXNzTG9hZGVy\nKCkpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFk\nLXZlcnNpb24tc3RyYXRlZ3kiLAogICAgICAgICAgICAgICAgdmVyc2lvbi5n\nZXRDbGFzc01hcHBpbmcoKSwgbmFtZSksIGUpOwogICAgICAgIH0KCiAgICAg\nICAgcmV0dXJuIGluc3RhbnRpYXRlVmVyc2lvblN0cmF0ZWd5KHN0cmF0LCB2\nZXJzaW9uLCBwcm9wcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnN0YW50\naWF0ZSB0aGUgZ2l2ZW4gdmVyc2lvbiBzdHJhdGVneS4KICAgICAqLwogICAg\ncHJvdGVjdGVkIFZlcnNpb25TdHJhdGVneSBpbnN0YW50aWF0ZVZlcnNpb25T\ndHJhdGVneShDbGFzcyBzdHJhdCwKICAgICAgICBWZXJzaW9uIHZlcnNpb24s\nIFN0cmluZyBwcm9wcykgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFZl\ncnNpb25TdHJhdGVneSBzdHJhdGVneSA9IChWZXJzaW9uU3RyYXRlZ3kpIHN0\ncmF0Lm5ld0luc3RhbmNlKCk7CiAgICAgICAgICAgIENvbmZpZ3VyYXRpb25z\nLmNvbmZpZ3VyZUluc3RhbmNlKHN0cmF0ZWd5LCBnZXRDb25maWd1cmF0aW9u\nKCksCiAgICAgICAgICAgICAgICBwcm9wcyk7CiAgICAgICAgICAgIHJldHVy\nbiBzdHJhdGVneTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5n\nZXQoImJhZC12ZXJzaW9uLXN0cmF0ZWd5IiwKICAgICAgICAgICAgICAgIHZl\ncnNpb24uZ2V0Q2xhc3NNYXBwaW5nKCksIHN0cmF0ICsgIiIpLCBlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgdGhlIGRl\nZmF1bHQgc3RyYXRlZ3kgdG8gdXNlIGZvciB0aGUgZ2l2ZW4gY2xhc3MuIERv\nZXMKICAgICAqIG5vdCB0YWtlIGludG8gYWNjb3VudCB0aGUgY3VycmVudCBz\ndHJhdGVneSwgaWYgYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgQ2xhc3NT\ndHJhdGVneSBkZWZhdWx0U3RyYXRlZ3koQ2xhc3NNYXBwaW5nIGNscykgewog\nICAgICAgIHJldHVybiBkZWZhdWx0U3RyYXRlZ3koY2xzLCBnZXRTdHJhdGVn\neUluc3RhbGxlcigpLmlzQWRhcHRpbmcoKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBEZXRlcm1pbmUgdGhlIGRlZmF1bHQgc3RyYXRlZ3kgdG8gdXNlIGZv\nciB0aGUgZ2l2ZW4gY2xhc3MuIERvZXMKICAgICAqIG5vdCB0YWtlIGludG8g\nYWNjb3VudCB0aGUgY3VycmVudCBzdHJhdGVneSwgaWYgYW55LgogICAgICov\nCiAgICBwcm90ZWN0ZWQgQ2xhc3NTdHJhdGVneSBkZWZhdWx0U3RyYXRlZ3ko\nQ2xhc3NNYXBwaW5nIGNscywKICAgICAgICBib29sZWFuIGFkYXB0aW5nKSB7\nCiAgICAgICAgVmFsdWVNYXBwaW5nIGVtYmVkID0gY2xzLmdldEVtYmVkZGlu\nZ01hcHBpbmcoKTsKICAgICAgICBpZiAoZW1iZWQgIT0gbnVsbCkgewogICAg\nICAgICAgICAvLyBzdXBlcmNsYXNzIG9mIGVtYmVkZGVkIGNsYXNzIGlzbid0\nIG1hcHBlZAogICAgICAgICAgICBpZiAoZW1iZWQuZ2V0VHlwZSgpICE9IGNs\ncy5nZXREZXNjcmliZWRUeXBlKCkKICAgICAgICAgICAgICAgIHx8IGVtYmVk\nLmdldEZpZWxkTWFwcGluZygpLmdldFN0cmF0ZWd5KCkKICAgICAgICAgICAg\nICAgID09IE5vbmVGaWVsZFN0cmF0ZWd5LmdldEluc3RhbmNlKCkpCiAgICAg\nICAgICAgICAgICByZXR1cm4gTm9uZUNsYXNzU3RyYXRlZ3kuZ2V0SW5zdGFu\nY2UoKTsKICAgICAgICAgICAgaWYgKGVtYmVkLmdldFR5cGVDb2RlKCkgPT0g\nSmF2YVR5cGVzLk9JRCkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2Jq\nZWN0SWRDbGFzc1N0cmF0ZWd5KCk7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nRW1iZWRkZWRDbGFzc1N0cmF0ZWd5KCk7CiAgICAgICAgfQogICAgICAgIGlm\nIChjbHMuaXNFbWJlZGRlZE9ubHkoKSkKICAgICAgICAgICAgcmV0dXJuIE5v\nbmVDbGFzc1N0cmF0ZWd5LmdldEluc3RhbmNlKCk7CgogICAgICAgIE9iamVj\ndCBzdHJhdCA9IF9kZWZhdWx0cy5nZXRTdHJhdGVneShjbHMsIGFkYXB0aW5n\nKTsKICAgICAgICBpZiAoc3RyYXQgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAg\nICAgICAgIHJldHVybiBpbnN0YW50aWF0ZUNsYXNzU3RyYXRlZ3koKFN0cmlu\nZykgc3RyYXQsIGNscyk7CiAgICAgICAgaWYgKHN0cmF0ICE9IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiAoQ2xhc3NTdHJhdGVneSkgc3RyYXQ7CgogICAg\nICAgIENsYXNzTWFwcGluZyBzdXAgPSBjbHMuZ2V0TWFwcGVkUENTdXBlcmNs\nYXNzTWFwcGluZygpOwogICAgICAgIGlmIChzdXAgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG5ldyBGdWxsQ2xhc3NTdHJhdGVneSgpOwoKICAgICAg\nICB3aGlsZSAoc3VwLmdldE1hcHBlZFBDU3VwZXJjbGFzc01hcHBpbmcoKSAh\nPSBudWxsKQogICAgICAgICAgICBzdXAgPSBzdXAuZ2V0TWFwcGVkUENTdXBl\ncmNsYXNzTWFwcGluZygpOwogICAgICAgIFN0cmluZyBzdWJTdHJhdCA9IHN1\ncC5nZXRNYXBwaW5nSW5mbygpLmdldEhpZXJhcmNoeVN0cmF0ZWd5KCk7CiAg\nICAgICAgaWYgKHN1YlN0cmF0ICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBpbnN0YW50aWF0ZUNsYXNzU3RyYXRlZ3koc3ViU3RyYXQsIGNscyk7Cgog\nICAgICAgIHJldHVybiBuZXcgRmxhdENsYXNzU3RyYXRlZ3koKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIERldGVybWluZSB0aGUgZGVmYXVsdCBzdHJhdGVn\neSB0byB1c2UgZm9yIHRoZSBnaXZlbiBmaWVsZC4gRG9lcwogICAgICogbm90\nIHRha2UgaW50byBhY2NvdW50IHRoZSBuYW1lZCBvciBjdXJyZW50IHN0cmF0\nZWd5LCBpZiBhbnkuIElmIGEKICAgICAqIG5vbi1udWxsIHN0cmF0ZWd5IGlz\nIHJldHVybmVkLCB0aGlzIG1ldGhvZCBtYXkgYXMgYSBzaWRlIGVmZmVjdCBp\nbnN0YWxsCiAgICAgKiB2YWx1ZSBoYW5kbGVycyBvbiB0aGUgZmllbGQncyB2\nYWx1ZSBtYXBwaW5ncy4KICAgICAqLwogICAgcHJvdGVjdGVkIEZpZWxkU3Ry\nYXRlZ3kgZGVmYXVsdFN0cmF0ZWd5KEZpZWxkTWFwcGluZyBmaWVsZCwKICAg\nICAgICBib29sZWFuIGluc3RhbGxIYW5kbGVycykgewogICAgICAgIHJldHVy\nbiBkZWZhdWx0U3RyYXRlZ3koZmllbGQsIGluc3RhbGxIYW5kbGVycywKICAg\nICAgICAgICAgZ2V0U3RyYXRlZ3lJbnN0YWxsZXIoKS5pc0FkYXB0aW5nKCkp\nOwogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRoZSBkZWZhdWx0\nIHN0cmF0ZWd5IHRvIHVzZSBmb3IgdGhlIGdpdmVuIGZpZWxkLiBEb2VzCiAg\nICAgKiBub3QgdGFrZSBpbnRvIGFjY291bnQgdGhlIG5hbWVkIG9yIGN1cnJl\nbnQgc3RyYXRlZ3ksIGlmIGFueS4gSWYgYQogICAgICogbm9uLW51bGwgc3Ry\nYXRlZ3kgaXMgcmV0dXJuZWQsIHRoaXMgbWV0aG9kIG1heSBhcyBhIHNpZGUg\nZWZmZWN0IGluc3RhbGwKICAgICAqIHZhbHVlIGhhbmRsZXJzIG9uIHRoZSBm\naWVsZCdzIHZhbHVlIG1hcHBpbmdzLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nRmllbGRTdHJhdGVneSBkZWZhdWx0U3RyYXRlZ3koRmllbGRNYXBwaW5nIGZp\nZWxkLAogICAgICAgIGJvb2xlYW4gaW5zdGFsbEhhbmRsZXJzLCBib29sZWFu\nIGFkYXB0aW5nKSB7CiAgICAgICAgLy8gbm90IHBlcnNpc3RlbnQ/CiAgICAg\nICAgaWYgKGZpZWxkLmdldE1hbmFnZW1lbnQoKSAhPSBmaWVsZC5NQU5BR0Vf\nUEVSU0lTVEVOVAogICAgICAgICAgICB8fCBmaWVsZC5pc1ZlcnNpb24oKSkK\nICAgICAgICAgICAgcmV0dXJuIE5vbmVGaWVsZFN0cmF0ZWd5LmdldEluc3Rh\nbmNlKCk7CiAgICAgICAgaWYgKGZpZWxkLmdldERlZmluaW5nTWFwcGluZygp\nLmdldFN0cmF0ZWd5KCkgPT0KICAgICAgICAgICAgTm9uZUNsYXNzU3RyYXRl\nZ3kuZ2V0SW5zdGFuY2UoKSkKICAgICAgICAgICAgcmV0dXJuIE5vbmVGaWVs\nZFN0cmF0ZWd5LmdldEluc3RhbmNlKCk7CgogICAgICAgIC8vIGNoZWNrIGZv\nciBuYW1lZCBoYW5kbGVyIGZpcnN0CiAgICAgICAgVmFsdWVIYW5kbGVyIGhh\nbmRsZXIgPSBuYW1lZEhhbmRsZXIoZmllbGQpOwogICAgICAgIGlmIChoYW5k\nbGVyICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKGluc3RhbGxIYW5kbGVy\ncykKICAgICAgICAgICAgICAgIGZpZWxkLnNldEhhbmRsZXIoaGFuZGxlcik7\nCiAgICAgICAgICAgIHJldHVybiBuZXcgSGFuZGxlckZpZWxkU3RyYXRlZ3ko\nKTsKICAgICAgICB9CgogICAgICAgIGlmIChmaWVsZC5pc1NlcmlhbGl6ZWQo\nKSkgewogICAgICAgICAgICBpZiAoX2RpY3QubWF4RW1iZWRkZWRCbG9iU2l6\nZSAhPSAtMSkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWF4RW1iZWRk\nZWRCbG9iRmllbGRTdHJhdGVneSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIC8vIGNoZWNrIGZvciBtYXBwZWQgc3RyYXRlZ3kKICAgICAgICAg\nICAgT2JqZWN0IHN0cmF0ID0gbWFwcGVkU3RyYXRlZ3koZmllbGQsIGZpZWxk\nLmdldFR5cGUoKSwgYWRhcHRpbmcpOwogICAgICAgICAgICBpZiAoc3RyYXQg\naW5zdGFuY2VvZiBGaWVsZFN0cmF0ZWd5KQogICAgICAgICAgICAgICAgcmV0\ndXJuIChGaWVsZFN0cmF0ZWd5KSBzdHJhdDsKICAgICAgICAgICAgaWYgKHN0\ncmF0ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChpbnN0YWxsSGFu\nZGxlcnMpCiAgICAgICAgICAgICAgICAgICAgZmllbGQuc2V0SGFuZGxlcigo\nVmFsdWVIYW5kbGVyKSBzdHJhdCk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nbmV3IEhhbmRsZXJGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIC8vIGNoZWNrIGZvciBrbm93biBmaWVsZCBzdHJh\ndGVnaWVzCiAgICAgICAgaWYgKCFmaWVsZC5pc1NlcmlhbGl6ZWQoKSAmJiAo\nZmllbGQuZ2V0VHlwZSgpID09IGJ5dGVbXS5jbGFzcwogICAgICAgICAgICB8\nfCBmaWVsZC5nZXRUeXBlKCkgPT0gQnl0ZVtdLmNsYXNzKSkgewogICAgICAg\nICAgICBpZiAoX2RpY3QubWF4RW1iZWRkZWRCbG9iU2l6ZSAhPSAtMSkKICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgTWF4RW1iZWRkZWRCeXRlQXJyYXlG\naWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgfSBlbHNlIGlmICghZmllbGQuaXNT\nZXJpYWxpemVkKCkKICAgICAgICAgICAgJiYgKGZpZWxkLmdldFR5cGUoKSA9\nPSBjaGFyW10uY2xhc3MKICAgICAgICAgICAgfHwgZmllbGQuZ2V0VHlwZSgp\nID09IENoYXJhY3RlcltdLmNsYXNzKSkgewogICAgICAgICAgICBpZiAoX2Rp\nY3QubWF4RW1iZWRkZWRDbG9iU2l6ZSAhPSAtMSAmJiBpc0Nsb2IoZmllbGQs\nIGZhbHNlKSkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWF4RW1iZWRk\nZWRDaGFyQXJyYXlGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgfSBlbHNlIGlm\nICghZmllbGQuaXNTZXJpYWxpemVkKCkpIHsKICAgICAgICAgICAgRmllbGRT\ndHJhdGVneSBzdHJhdCA9IGRlZmF1bHRUeXBlU3RyYXRlZ3koZmllbGQsIGlu\nc3RhbGxIYW5kbGVycywKICAgICAgICAgICAgICAgIGFkYXB0aW5nKTsKICAg\nICAgICAgICAgaWYgKHN0cmF0ICE9IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gc3RyYXQ7CiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayBmb3Ig\nZGVmYXVsdCBoYW5kbGVyCiAgICAgICAgaGFuZGxlciA9IGRlZmF1bHRIYW5k\nbGVyKGZpZWxkLCBhZGFwdGluZyk7CiAgICAgICAgaWYgKGhhbmRsZXIgIT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoaW5zdGFsbEhhbmRsZXJzKQogICAg\nICAgICAgICAgICAgZmllbGQuc2V0SGFuZGxlcihoYW5kbGVyKTsKICAgICAg\nICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyRmllbGRTdHJhdGVneSgpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gZGVmYXVsdCB0byBibG9iCiAgICAgICAgaWYg\nKGluc3RhbGxIYW5kbGVycykgewogICAgICAgICAgICBpZiAoZ2V0TG9nKCku\naXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgZ2V0TG9nKCkud2Fy\nbihfbG9jLmdldCgibm8tZmllbGQtc3RyYXRlZ3kiLCBmaWVsZCkpOwogICAg\nICAgICAgICBmaWVsZC5zZXRTZXJpYWxpemVkKHRydWUpOwogICAgICAgIH0K\nICAgICAgICBpZiAoX2RpY3QubWF4RW1iZWRkZWRCbG9iU2l6ZSA9PSAtMSkg\newogICAgICAgICAgICBpZiAoaW5zdGFsbEhhbmRsZXJzKQogICAgICAgICAg\nICAgICAgZmllbGQuc2V0SGFuZGxlcihCbG9iVmFsdWVIYW5kbGVyLmdldElu\nc3RhbmNlKCkpOwogICAgICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXJGaWVs\nZFN0cmF0ZWd5KCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgTWF4\nRW1iZWRkZWRCbG9iRmllbGRTdHJhdGVneSgpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBidWlsdC1pbiBzdHJhdGVneSBmb3IgdGhlIGZp\nZWxkJ3MgdHlwZSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwcm90\nZWN0ZWQgRmllbGRTdHJhdGVneSBkZWZhdWx0VHlwZVN0cmF0ZWd5KEZpZWxk\nTWFwcGluZyBmaWVsZCwKICAgICAgICBib29sZWFuIGluc3RhbGxIYW5kbGVy\ncywgYm9vbGVhbiBhZGFwdGluZykgewogICAgICAgIHN3aXRjaCAoZmllbGQu\nZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5C\nT09MRUFOOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5ET1VCTEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkZMT0FUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlQ6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLlNIT1JUOgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQ\ncmltaXRpdmVGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLlNUUklORzoKICAgICAgICAgICAgICAgIGlmICghaXNDbG9iKGZp\nZWxkLCBmYWxzZSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBT\ndHJpbmdGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgICAgICAgICBpZiAoX2Rp\nY3QubWF4RW1iZWRkZWRDbG9iU2l6ZSAhPSAtMSkKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gbmV3IE1heEVtYmVkZGVkQ2xvYkZpZWxkU3RyYXRlZ3ko\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5QQzoKICAgICAgICAgICAgICAgIGlmIChmaWVsZC5pc0VtYmVk\nZGVkUEMoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEVtYmVk\nRmllbGRTdHJhdGVneSgpOwogICAgICAgICAgICAgICAgaWYgKGZpZWxkLmdl\ndFR5cGVNYXBwaW5nKCkuaXNNYXBwZWQoKQogICAgICAgICAgICAgICAgICAg\nIHx8ICF1c2VVbnR5cGVkUENIYW5kbGVyKGZpZWxkKSkKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IFJlbGF0aW9uRmllbGRTdHJhdGVneSgpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkFSUkFZOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNU\nSU9OOgogICAgICAgICAgICAgICAgVmFsdWVNYXBwaW5nIGVsZW0gPSBmaWVs\nZC5nZXRFbGVtZW50TWFwcGluZygpOwogICAgICAgICAgICAgICAgVmFsdWVI\nYW5kbGVyIGVoYW5kbGVyID0gbmFtZWRIYW5kbGVyKGVsZW0pOwogICAgICAg\nICAgICAgICAgaWYgKGVoYW5kbGVyID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgZWhhbmRsZXIgPSBkZWZhdWx0SGFuZGxlcihlbGVtKTsKICAgICAg\nICAgICAgICAgIGlmIChlaGFuZGxlciAhPSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBoYW5kbGVyQ29sbGVjdGlvblN0cmF0ZWd5KGZpZWxk\nLCBlaGFuZGxlciwgCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxI\nYW5kbGVycyk7CiAgICAgICAgICAgICAgICBpZiAoZWxlbS5nZXRUeXBlQ29k\nZSgpID09IEphdmFUeXBlcy5QQwogICAgICAgICAgICAgICAgICAgICYmICFl\nbGVtLmlzU2VyaWFsaXplZCgpICYmICFlbGVtLmlzRW1iZWRkZWRQQygpKSB7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZUludmVyc2VLZXlNYXBwaW5n\nKGZpZWxkKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBS\nZWxhdGlvbkNvbGxlY3Rpb25JbnZlcnNlS2V5RmllbGRTdHJhdGVneSgpOwog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpb25Db2xsZWN0\naW9uVGFibGVGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuTUFQOgogICAgICAgICAgICAgICAgVmFsdWVNYXBwaW5nIGtleSA9IGZp\nZWxkLmdldEtleU1hcHBpbmcoKTsKICAgICAgICAgICAgICAgIFZhbHVlSGFu\nZGxlciBraGFuZGxlciA9IG5hbWVkSGFuZGxlcihrZXkpOwogICAgICAgICAg\nICAgICAgaWYgKGtoYW5kbGVyID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAga2hhbmRsZXIgPSBkZWZhdWx0SGFuZGxlcihrZXkpOwogICAgICAgICAg\nICAgICAgVmFsdWVNYXBwaW5nIHZhbCA9IGZpZWxkLmdldEVsZW1lbnRNYXBw\naW5nKCk7CiAgICAgICAgICAgICAgICBWYWx1ZUhhbmRsZXIgdmhhbmRsZXIg\nPSBuYW1lZEhhbmRsZXIodmFsKTsKICAgICAgICAgICAgICAgIGlmICh2aGFu\nZGxlciA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHZoYW5kbGVyID0g\nZGVmYXVsdEhhbmRsZXIodmFsKTsKICAgICAgICAgICAgICAgIGJvb2xlYW4g\na3JlbCA9IGtoYW5kbGVyID09IG51bGwgCiAgICAgICAgICAgICAgICAgICAg\nJiYga2V5LmdldFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLlBDCiAgICAgICAg\nICAgICAgICAgICAgJiYgIWtleS5pc1NlcmlhbGl6ZWQoKSAmJiAha2V5Lmlz\nRW1iZWRkZWRQQygpOwogICAgICAgICAgICAgICAgYm9vbGVhbiB2cmVsID0g\ndmhhbmRsZXIgPT0gbnVsbCAKICAgICAgICAgICAgICAgICAgICAmJiB2YWwu\nZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuUEMKICAgICAgICAgICAgICAg\nICAgICAmJiAhdmFsLmlzU2VyaWFsaXplZCgpICYmICF2YWwuaXNFbWJlZGRl\nZFBDKCk7CiAgICAgICAgICAgICAgICBpZiAoIWtyZWwgJiYgdnJlbCAmJiBr\nZXkuZ2V0VmFsdWVNYXBwZWRCeSgpICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAodXNlSW52ZXJzZUtleU1hcHBpbmcoZmllbGQpKQogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aW9uTWFwSW52\nZXJzZUtleUZpZWxkU3RyYXRlZ3koKTsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IFJlbGF0aW9uTWFwVGFibGVGaWVsZFN0cmF0ZWd5KCk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIWtyZWwgJiYg\na2hhbmRsZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGlmICghdnJlbCAmJiB2aGFuZGxlciA9PSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\ncmV0dXJuIGhhbmRsZXJNYXBTdHJhdGVneShmaWVsZCwga2hhbmRsZXIsIHZo\nYW5kbGVyLCBrcmVsLAogICAgICAgICAgICAgICAgICAgIHZyZWwsIGluc3Rh\nbGxIYW5kbGVycyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb2xsZWN0aW9uIHN0\ncmF0ZWd5IGZvciB0aGUgZ2l2ZW4gZWxlbWVudCBoYW5kbGVyLCBvciBudWxs\nCiAgICAgKiBpZiBub25lLgogICAgICovCiAgICBwcm90ZWN0ZWQgRmllbGRT\ndHJhdGVneSBoYW5kbGVyQ29sbGVjdGlvblN0cmF0ZWd5KEZpZWxkTWFwcGlu\nZyBmaWVsZCwgCiAgICAgICAgVmFsdWVIYW5kbGVyIGVoYW5kbGVyLCBib29s\nZWFuIGluc3RhbGxIYW5kbGVycykgewogICAgICAgIHJldHVybiBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBtYXAgc3RyYXRlZ3kg\nZm9yIHRoZSBnaXZlbiBrZXkgYW5kIHZhbHVlIGhhbmRsZXJzIC8gcmVsYXRp\nb25zLAogICAgICogb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwcm90\nZWN0ZWQgRmllbGRTdHJhdGVneSBoYW5kbGVyTWFwU3RyYXRlZ3koRmllbGRN\nYXBwaW5nIGZpZWxkLCAKICAgICAgICBWYWx1ZUhhbmRsZXIga2hhbmRsZXIs\nIFZhbHVlSGFuZGxlciB2aGFuZGxlciwgYm9vbGVhbiBrcmVsLCAKICAgICAg\nICBib29sZWFuIHZyZWwsICBib29sZWFuIGluc3RhbGxIYW5kbGVycykgewog\nICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogVXNl\nIGhpbnRzIGluIG1hcHBpbmcgZGF0YSB0byBmaWd1cmUgb3V0IHdoZXRoZXIg\ndGhlIGdpdmVuIHJlbGF0aW9uCiAgICAgKiBmaWVsZCBzaG91bGQgdXNlIGFu\nIGludmVyc2UgZm9yZWlnbiBrZXkgb3IgYW4gYXNzb2NpYXRpb24gdGFibGUg\nbWFwcGluZy4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHVzZUludmVy\nc2VLZXlNYXBwaW5nKEZpZWxkTWFwcGluZyBmaWVsZCkgewogICAgICAgIEZp\nZWxkTWFwcGluZyBtYXBwZWQgPSBmaWVsZC5nZXRNYXBwZWRCeU1hcHBpbmco\nKTsKICAgICAgICBpZiAobWFwcGVkICE9IG51bGwpIHsKICAgICAgICAgICAg\naWYgKG1hcHBlZC5nZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5QQykKICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICBpZiAobWFw\ncGVkLmdldEVsZW1lbnQoKS5nZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5Q\nQykKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAg\ndGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbWFw\ncGVkLWJ5IiwgZmllbGQsCiAgICAgICAgICAgICAgICBtYXBwZWQpKTsKICAg\nICAgICB9CgogICAgICAgIC8vIHdpdGhvdXQgYSBtYXBwZWQtYnksIHdlIGhh\ndmUgdG8gbG9vayBmb3IgY2x1ZXMgYXMgdG8gdGhlIG1hcHBpbmcuCiAgICAg\nICAgLy8gd2UgYXNzdW1lIHRoYXQgYW55dGhpbmcgd2l0aCBlbGVtZW50IGZv\ncmVpZ24ga2V5IGNvbHVtbnMgYnV0IG5vIGpvaW4KICAgICAgICAvLyBjb2x1\nbW5zIG9yIHRhYmxlIHVzZXMgYW4gaW52ZXJzZSBmb3JlaWduIGtleSwgYW5k\nIGFueXRoaW5nIGVsc2UgdXNlcwogICAgICAgIC8vIGFuIGFzc29jaWF0aW9u\nIHRhYmxlCiAgICAgICAgRmllbGRNYXBwaW5nSW5mbyBpbmZvID0gZmllbGQu\nZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBWYWx1ZU1hcHBpbmcgZWxlbSA9\nIGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAgICAgICAgcmV0dXJuIGlu\nZm8uZ2V0VGFibGVOYW1lKCkgPT0gbnVsbCAmJiBpbmZvLmdldENvbHVtbnMo\nKS5pc0VtcHR5KCkKICAgICAgICAgICAgJiYgIWVsZW0uZ2V0VmFsdWVJbmZv\nKCkuZ2V0Q29sdW1ucygpLmlzRW1wdHkoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENoZWNrIHRoZSBnaXZlbiB2YWx1ZSBhZ2FpbnN0IG1hcHBlZCBzdHJh\ndGVnaWVzLgogICAgICovCiAgICBwcml2YXRlIE9iamVjdCBtYXBwZWRTdHJh\ndGVneShWYWx1ZU1hcHBpbmcgdmFsLCBDbGFzcyB0eXBlLAogICAgICAgIGJv\nb2xlYW4gYWRhcHRpbmcpIHsKICAgICAgICBpZiAodHlwZSA9PSBudWxsIHx8\nIHR5cGUgPT0gT2JqZWN0LmNsYXNzKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKCiAgICAgICAgT2JqZWN0IHN0cmF0ID0gX2RlZmF1bHRzLmdldFN0cmF0\nZWd5KHZhbCwgdHlwZSwgYWRhcHRpbmcpOwogICAgICAgIGlmIChzdHJhdCA9\nPSBudWxsKQogICAgICAgICAgICBzdHJhdCA9IF9oYW5kbGVycy5nZXQodHlw\nZS5nZXROYW1lKCkpOwoKICAgICAgICAvLyByZWN1cnNlIG9uIHN1cGVyY2xh\nc3Mgc28gdGhhdCwgZm9yIGV4YW1wbGUsIGEgcmVnaXN0ZXJlZCBoYW5kbGVy\nCiAgICAgICAgLy8gZm9yIGphdmEubGFuZy5FbnVtIHdpbGwgd29yayBvbiBh\nbGwgZW51bXMKICAgICAgICBpZiAoc3RyYXQgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIG1hcHBlZFN0cmF0ZWd5KHZhbCwgdHlwZS5nZXRTdXBlcmNs\nYXNzKCksIGFkYXB0aW5nKTsKICAgICAgICBpZiAoIShzdHJhdCBpbnN0YW5j\nZW9mIFN0cmluZykpCiAgICAgICAgICAgIHJldHVybiBzdHJhdDsKCiAgICAg\nICAgU3RyaW5nIG5hbWUgPSAoU3RyaW5nKSBzdHJhdDsKICAgICAgICBpZiAo\nTm9uZUZpZWxkU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5hbWUpKQogICAgICAg\nICAgICByZXR1cm4gTm9uZUZpZWxkU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsK\nCiAgICAgICAgU3RyaW5nIHByb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJv\ncGVydGllcyhuYW1lKTsKICAgICAgICBuYW1lID0gQ29uZmlndXJhdGlvbnMu\nZ2V0Q2xhc3NOYW1lKG5hbWUpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIE9iamVjdCBvID0gSmF2YVR5cGVzLmNsYXNzRm9yTmFtZShuYW1lLCB2YWws\nCiAgICAgICAgICAgICAgICBGaWVsZFN0cmF0ZWd5LmNsYXNzLmdldENsYXNz\nTG9hZGVyKCkpLm5ld0luc3RhbmNlKCk7CiAgICAgICAgICAgIENvbmZpZ3Vy\nYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKG8sIGdldENvbmZpZ3VyYXRpb24o\nKSwgcHJvcHMpOwogICAgICAgICAgICByZXR1cm4gbzsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1tYXBwZWQtc3RyYXRlZ3ki\nLAogICAgICAgICAgICAgICAgdmFsLCBuYW1lKSwgZSk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogSW5zdGFudGlhdGUgdGhlIGdpdmVuIHZh\nbHVlJ3MgbmFtZWQgaGFuZGxlciwgb3IgcmV0dXJuIG51bGwgaWYgbm8KICAg\nICAqIG5hbWVkIGhhbmRsZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCBWYWx1\nZUhhbmRsZXIgbmFtZWRIYW5kbGVyKFZhbHVlTWFwcGluZyB2YWwpIHsKICAg\nICAgICBTdHJpbmcgbmFtZSA9IHZhbC5nZXRWYWx1ZUluZm8oKS5nZXRTdHJh\ndGVneSgpOwogICAgICAgIGlmIChuYW1lID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmcgcHJvcHMgPSBDb25maWd1\ncmF0aW9ucy5nZXRQcm9wZXJ0aWVzKG5hbWUpOwogICAgICAgIG5hbWUgPSBD\nb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUobmFtZSk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgQ2xhc3MgYyA9IEphdmFUeXBlcy5jbGFzc0Zvck5h\nbWUobmFtZSwgdmFsLAogICAgICAgICAgICAgICAgVmFsdWVIYW5kbGVyLmNs\nYXNzLmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgICAgICBpZiAoVmFsdWVI\nYW5kbGVyLmNsYXNzLmlzQXNzaWduYWJsZUZyb20oYykpIHsKICAgICAgICAg\nICAgICAgIFZhbHVlSGFuZGxlciB2aCA9IChWYWx1ZUhhbmRsZXIpIGMubmV3\nSW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIENvbmZpZ3VyYXRpb25zLmNv\nbmZpZ3VyZUluc3RhbmNlKHZoLCBnZXRDb25maWd1cmF0aW9uKCksCiAgICAg\nICAgICAgICAgICAgICAgcHJvcHMpOwogICAgICAgICAgICAgICAgcmV0dXJu\nIHZoOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBudWxsOyAv\nLyBuYW1lZCBmaWVsZCBzdHJhdGVneQogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2Vw\ndGlvbihfbG9jLmdldCgiYmFkLXZhbHVlLWhhbmRsZXIiLAogICAgICAgICAg\nICAgICAgdmFsLCBuYW1lKSwgZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogRGV0ZXJtaW5lIHRoZSBkZWZhdWx0IGhhbmRsZXIgdG8gdXNl\nIGZvciB0aGUgZ2l2ZW4gdmFsdWUuIERvZXMKICAgICAqIG5vdCB0YWtlIGlu\ndG8gYWNjb3VudCB0aGUgbmFtZWQgaGFuZGxlciwgaWYgYW55LgogICAgICov\nCiAgICBwcm90ZWN0ZWQgVmFsdWVIYW5kbGVyIGRlZmF1bHRIYW5kbGVyKFZh\nbHVlTWFwcGluZyB2YWwpIHsKICAgICAgICByZXR1cm4gZGVmYXVsdEhhbmRs\nZXIodmFsLCBnZXRTdHJhdGVneUluc3RhbGxlcigpLmlzQWRhcHRpbmcoKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgdGhlIGRlZmF1bHQg\naGFuZGxlciB0byB1c2UgZm9yIHRoZSBnaXZlbiB2YWx1ZS4gRG9lcwogICAg\nICogbm90IHRha2UgaW50byBhY2NvdW50IHRoZSBuYW1lZCBoYW5kbGVyLCBp\nZiBhbnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBWYWx1ZUhhbmRsZXIgZGVm\nYXVsdEhhbmRsZXIoVmFsdWVNYXBwaW5nIHZhbCwgYm9vbGVhbiBhZGFwdGlu\nZykgewogICAgICAgIGlmICh2YWwuaXNTZXJpYWxpemVkKCkpIHsKICAgICAg\nICAgICAgaWYgKF9kaWN0Lm1heEVtYmVkZGVkQmxvYlNpemUgIT0gLTEpCiAg\nICAgICAgICAgICAgICB3YXJuTWF4RW1iZWRkZWQodmFsLCBfZGljdC5tYXhF\nbWJlZGRlZEJsb2JTaXplKTsKICAgICAgICAgICAgcmV0dXJuIEJsb2JWYWx1\nZUhhbmRsZXIuZ2V0SW5zdGFuY2UoKTsKICAgICAgICB9CgogICAgICAgIE9i\namVjdCBoYW5kbGVyID0gbWFwcGVkU3RyYXRlZ3kodmFsLCB2YWwuZ2V0VHlw\nZSgpLCBhZGFwdGluZyk7CiAgICAgICAgaWYgKGhhbmRsZXIgaW5zdGFuY2Vv\nZiBWYWx1ZUhhbmRsZXIpCiAgICAgICAgICAgIHJldHVybiAoVmFsdWVIYW5k\nbGVyKSBoYW5kbGVyOwoKICAgICAgICBpZiAodmFsLmdldFR5cGUoKSA9PSBi\neXRlW10uY2xhc3MpIHsKICAgICAgICAgICAgaWYgKF9kaWN0Lm1heEVtYmVk\nZGVkQmxvYlNpemUgIT0gLTEpCiAgICAgICAgICAgICAgICB3YXJuTWF4RW1i\nZWRkZWQodmFsLCBfZGljdC5tYXhFbWJlZGRlZEJsb2JTaXplKTsKICAgICAg\nICAgICAgcmV0dXJuIEJ5dGVBcnJheVZhbHVlSGFuZGxlci5nZXRJbnN0YW5j\nZSgpOwogICAgICAgIH0KICAgICAgICBpZiAodmFsLmdldFR5cGUoKSA9PSBj\naGFyW10uY2xhc3MKICAgICAgICAgICAgfHwgdmFsLmdldFR5cGUoKSA9PSBD\naGFyYWN0ZXJbXS5jbGFzcykgewogICAgICAgICAgICBpZiAoaXNDbG9iKHZh\nbCwgdHJ1ZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gQ2hhckFycmF5U3Ry\nZWFtVmFsdWVIYW5kbGVyLmdldEluc3RhbmNlKCk7CiAgICAgICAgICAgIHJl\ndHVybiBDaGFyQXJyYXlWYWx1ZUhhbmRsZXIuZ2V0SW5zdGFuY2UoKTsKICAg\nICAgICB9CgogICAgICAgIHN3aXRjaCAodmFsLmdldFR5cGVDb2RlKCkpIHsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTjoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuQllURToKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuQ0hBUjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxF\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5GTE9BVDoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuSU5UOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5MT05HOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVDoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTl9PQko6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuRE9VQkxFX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nRkxPQVRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JK\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5CSUdJTlRFR0VSOgogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5CSUdERUNJTUFMOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5OVU1CRVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRBVEU6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNBTEVOREFSOgogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5MT0NBTEU6CiAgICAgICAgICAgICAgICByZXR1\ncm4gSW1tdXRhYmxlVmFsdWVIYW5kbGVyLmdldEluc3RhbmNlKCk7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoKICAgICAgICAgICAgICAg\nIGlmIChpc0Nsb2IodmFsLCB0cnVlKSkKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gQ2xvYlZhbHVlSGFuZGxlci5nZXRJbnN0YW5jZSgpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIEltbXV0YWJsZVZhbHVlSGFuZGxlci5nZXRJbnN0\nYW5jZSgpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAgICAg\nICAgICAgICAgIGlmICghdmFsLmdldFR5cGVNYXBwaW5nKCkuaXNNYXBwZWQo\nKQogICAgICAgICAgICAgICAgICAgICYmIHVzZVVudHlwZWRQQ0hhbmRsZXIo\ndmFsKSkgCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFVudHlwZWRQQ1Zh\nbHVlSGFuZGxlci5nZXRJbnN0YW5jZSgpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDX1VOVFlQRUQ6CiAg\nICAgICAgICAgICAgICByZXR1cm4gVW50eXBlZFBDVmFsdWVIYW5kbGVyLmdl\ndEluc3RhbmNlKCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9JRDoK\nICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2JqZWN0SWRWYWx1ZUhhbmRs\nZXIoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRo\nZSBnZW5lcmljIHVudHlwZWQgUEMgaGFuZGxlciBmb3IgdGhlCiAgICAgKiBn\naXZlbiB1bm1hcHBlZCByZWxhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBi\nb29sZWFuIHVzZVVudHlwZWRQQ0hhbmRsZXIoVmFsdWVNYXBwaW5nIHZhbCkg\newogICAgICAgIENsYXNzTWFwcGluZyByZWwgPSB2YWwuZ2V0VHlwZU1hcHBp\nbmcoKTsKICAgICAgICByZXR1cm4gcmVsLmdldElkZW50aXR5VHlwZSgpID09\nIENsYXNzTWFwcGluZy5JRF9VTktOT1dOCiAgICAgICAgICAgIHx8IChyZWwu\nZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNYXBwaW5nLklEX0FQUExJQ0FU\nSU9OCiAgICAgICAgICAgICYmIChyZWwuZ2V0UHJpbWFyeUtleUZpZWxkcygp\nLmxlbmd0aCA9PSAwCiAgICAgICAgICAgIHx8ICghcmVsLmlzT3BlbkpQQUlk\nZW50aXR5KCkgJiYgTW9kaWZpZXIuaXNBYnN0cmFjdAogICAgICAgICAgICAo\ncmVsLmdldE9iamVjdElkVHlwZSgpLmdldE1vZGlmaWVycygpKSkpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENoZWNrcyBmb3IgaGludHMgYXMgdG8gd2hl\ndGhlciB0aGUgZ2l2ZW4gY29sdW1uIGlzIGEgQ0xPQi4KICAgICAqLwogICAg\ncHJpdmF0ZSBib29sZWFuIGlzQ2xvYihWYWx1ZU1hcHBpbmcgdmFsLCBib29s\nZWFuIHdhcm4pIHsKICAgICAgICBMaXN0IGNvbHMgPSB2YWwuZ2V0VmFsdWVJ\nbmZvKCkuZ2V0Q29sdW1ucygpOwogICAgICAgIGlmIChjb2xzLnNpemUoKSAh\nPSAxKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIENvbHVt\nbiBjb2wgPSAoQ29sdW1uKSBjb2xzLmdldCgwKTsKICAgICAgICBpZiAoY29s\nLmdldFNpemUoKSAhPSAtMSAmJiBjb2wuZ2V0VHlwZSgpICE9IFR5cGVzLkNM\nT0IpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgaWYgKF9k\naWN0LmdldFByZWZlcnJlZFR5cGUoVHlwZXMuQ0xPQikgIT0gVHlwZXMuQ0xP\nQikKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAod2Fy\nbiAmJiBfZGljdC5tYXhFbWJlZGRlZENsb2JTaXplICE9IC0xKQogICAgICAg\nICAgICB3YXJuTWF4RW1iZWRkZWQodmFsLCBfZGljdC5tYXhFbWJlZGRlZENs\nb2JTaXplKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdhcm4gdGhhdCB0aGUgZ2l2ZW4gdmFsdWUgaXMgYmVpbmcgbWFw\ncGVkIHRvIGEgaGFuZGxlciB0aGF0IHdpbGwgbm90CiAgICAgKiBiZSBhYmxl\nIHRvIHN0b3JlIGxhcmdlIGxvYnMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCB3YXJuTWF4RW1iZWRkZWQoVmFsdWVNYXBwaW5nIHZhbCwgaW50IHNpemUp\nIHsKICAgICAgICBpZiAoZ2V0TG9nKCkuaXNXYXJuRW5hYmxlZCgpKQogICAg\nICAgICAgICBnZXRMb2coKS53YXJuKF9sb2MuZ2V0KCJtYXgtZW1iZWQtbG9i\nIiwgdmFsLAogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2Yoc2l6ZSkp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIERldGVybWluZSB0aGUgZGVmYXVs\ndCBzdHJhdGVneSB0byB1c2UgZm9yIHRoZSBnaXZlbiBkaXNjcmltaW5hdG9y\nLgogICAgICogRG9lcyBub3QgdGFrZSBpbnRvIGFjY291bnQgdGhlIGN1cnJl\nbnQgc3RyYXRlZ3ksIGlmIGFueS4KICAgICAqLwogICAgcHJvdGVjdGVkIERp\nc2NyaW1pbmF0b3JTdHJhdGVneSBkZWZhdWx0U3RyYXRlZ3koRGlzY3JpbWlu\nYXRvciBkaXNjcmltKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHJhdGVn\neShkaXNjcmltLCBnZXRTdHJhdGVneUluc3RhbGxlcigpLmlzQWRhcHRpbmco\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgdGhlIGRlZmF1\nbHQgc3RyYXRlZ3kgdG8gdXNlIGZvciB0aGUgZ2l2ZW4gZGlzY3JpbWluYXRv\nci4KICAgICAqIERvZXMgbm90IHRha2UgaW50byBhY2NvdW50IHRoZSBjdXJy\nZW50IHN0cmF0ZWd5LCBpZiBhbnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBE\naXNjcmltaW5hdG9yU3RyYXRlZ3kgZGVmYXVsdFN0cmF0ZWd5KERpc2NyaW1p\nbmF0b3IgZGlzY3JpbSwKICAgICAgICBib29sZWFuIGFkYXB0aW5nKSB7CiAg\nICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IGRpc2NyaW0uZ2V0Q2xhc3NNYXBw\naW5nKCk7CiAgICAgICAgaWYgKGNscy5nZXRFbWJlZGRpbmdNZXRhRGF0YSgp\nICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBOb25lRGlzY3JpbWluYXRv\nclN0cmF0ZWd5LmdldEluc3RhbmNlKCk7CiAgICAgICAgaWYgKGNscy5nZXRK\nb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSA9PSBudWxsCiAgICAgICAg\nICAgICYmIChjbHMuZ2V0U3RyYXRlZ3koKSA9PSBOb25lQ2xhc3NTdHJhdGVn\neS5nZXRJbnN0YW5jZSgpCiAgICAgICAgICAgIHx8IE1vZGlmaWVyLmlzRmlu\nYWwoZGlzY3JpbS5nZXRDbGFzc01hcHBpbmcoKS5nZXREZXNjcmliZWRUeXBl\nKCkuCiAgICAgICAgICAgIGdldE1vZGlmaWVycygpKSkpCiAgICAgICAgICAg\nIHJldHVybiBOb25lRGlzY3JpbWluYXRvclN0cmF0ZWd5LmdldEluc3RhbmNl\nKCk7CgogICAgICAgIE9iamVjdCBzdHJhdCA9IF9kZWZhdWx0cy5nZXRTdHJh\ndGVneShkaXNjcmltLCBhZGFwdGluZyk7CiAgICAgICAgaWYgKHN0cmF0IGlu\nc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICByZXR1cm4gaW5zdGFudGlh\ndGVEaXNjcmltaW5hdG9yU3RyYXRlZ3koKFN0cmluZykgc3RyYXQsIGRpc2Ny\naW0pOwogICAgICAgIGlmIChzdHJhdCAhPSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gKERpc2NyaW1pbmF0b3JTdHJhdGVneSkgc3RyYXQ7CgogICAgICAg\nIGlmIChjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdXBlcmNsYXNzRGlzY3Jp\nbWluYXRvclN0cmF0ZWd5KCk7CiAgICAgICAgaWYgKGRpc2NyaW0uZ2V0TWFw\ncGluZ0luZm8oKS5nZXRWYWx1ZSgpICE9IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgVmFsdWVNYXBEaXNjcmltaW5hdG9yU3RyYXRlZ3koKTsKICAg\nICAgICBpZiAoY2xzLmdldE1hcHBlZFBDU3VwZXJjbGFzc01hcHBpbmcoKSAh\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gTm9uZURpc2NyaW1pbmF0b3JT\ndHJhdGVneS5nZXRJbnN0YW5jZSgpOwogICAgICAgIGlmIChhZGFwdGluZyB8\nfCBfZGVmYXVsdHMuZGVmYXVsdE1pc3NpbmdJbmZvKCkpCiAgICAgICAgICAg\nIHJldHVybiBuZXcgQ2xhc3NOYW1lRGlzY3JpbWluYXRvclN0cmF0ZWd5KCk7\nCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSAoKEpEQkNDb25maWd1cmF0\naW9uKSBnZXRDb25maWd1cmF0aW9uKCkpLgogICAgICAgICAgICBnZXREQkRp\nY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIGlmIChkaWN0LmpvaW5TeW50\nYXggPT0gSm9pblN5bnRheGVzLlNZTlRBWF9UUkFESVRJT05BTCkKICAgICAg\nICAgICAgcmV0dXJuIE5vbmVEaXNjcmltaW5hdG9yU3RyYXRlZ3kuZ2V0SW5z\ndGFuY2UoKTsKICAgICAgICByZXR1cm4gbmV3IFN1YmNsYXNzSm9pbkRpc2Ny\naW1pbmF0b3JTdHJhdGVneSgpOwogICAgfQoKICAgIC8qKgogICAgICogRGV0\nZXJtaW5lIHRoZSBkZWZhdWx0IHN0cmF0ZWd5IHRvIHVzZSBmb3IgdGhlIGdp\ndmVuIHZlcnNpb24uCiAgICAgKiBEb2VzIG5vdCB0YWtlIGludG8gYWNjb3Vu\ndCB0aGUgY3VycmVudCBzdHJhdGVneSwgaWYgYW55LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgVmVyc2lvblN0cmF0ZWd5IGRlZmF1bHRTdHJhdGVneShWZXJz\naW9uIHZlcnNpb24pIHsKICAgICAgICByZXR1cm4gZGVmYXVsdFN0cmF0ZWd5\nKHZlcnNpb24sIGdldFN0cmF0ZWd5SW5zdGFsbGVyKCkuaXNBZGFwdGluZygp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIERldGVybWluZSB0aGUgZGVmYXVs\ndCBzdHJhdGVneSB0byB1c2UgZm9yIHRoZSBnaXZlbiB2ZXJzaW9uLgogICAg\nICogRG9lcyBub3QgdGFrZSBpbnRvIGFjY291bnQgdGhlIGN1cnJlbnQgc3Ry\nYXRlZ3ksIGlmIGFueS4KICAgICAqLwogICAgcHJvdGVjdGVkIFZlcnNpb25T\ndHJhdGVneSBkZWZhdWx0U3RyYXRlZ3koVmVyc2lvbiB2ZXJzaW9uLAogICAg\nICAgIGJvb2xlYW4gYWRhcHRpbmcpIHsKICAgICAgICBDbGFzc01hcHBpbmcg\nY2xzID0gdmVyc2lvbi5nZXRDbGFzc01hcHBpbmcoKTsKICAgICAgICBpZiAo\nY2xzLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgIT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIE5vbmVWZXJzaW9uU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsK\nICAgICAgICBpZiAoY2xzLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGlu\nZygpID09IG51bGwKICAgICAgICAgICAgJiYgY2xzLmdldFN0cmF0ZWd5KCkg\nPT0gTm9uZUNsYXNzU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKSkKICAgICAgICAg\nICAgcmV0dXJuIE5vbmVWZXJzaW9uU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsK\nCiAgICAgICAgT2JqZWN0IHN0cmF0ID0gX2RlZmF1bHRzLmdldFN0cmF0ZWd5\nKHZlcnNpb24sIGFkYXB0aW5nKTsKICAgICAgICBpZiAoc3RyYXQgaW5zdGFu\nY2VvZiBTdHJpbmcpCiAgICAgICAgICAgIHJldHVybiBpbnN0YW50aWF0ZVZl\ncnNpb25TdHJhdGVneSgoU3RyaW5nKSBzdHJhdCwgdmVyc2lvbik7CiAgICAg\nICAgaWYgKHN0cmF0ICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiAoVmVy\nc2lvblN0cmF0ZWd5KSBzdHJhdDsKCiAgICAgICAgaWYgKGNscy5nZXRKb2lu\nYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gbmV3IFN1cGVyY2xhc3NWZXJzaW9uU3RyYXRlZ3koKTsKCiAg\nICAgICAgRmllbGRNYXBwaW5nIHZmaWVsZCA9IHZlcnNpb24uZ2V0Q2xhc3NN\nYXBwaW5nKCkuCiAgICAgICAgICAgIGdldFZlcnNpb25GaWVsZE1hcHBpbmco\nKTsKICAgICAgICBpZiAodmZpZWxkICE9IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBkZWZhdWx0U3RyYXRlZ3kodmVyc2lvbiwgdmZpZWxkKTsKICAgICAg\nICBpZiAoYWRhcHRpbmcgfHwgX2RlZmF1bHRzLmRlZmF1bHRNaXNzaW5nSW5m\nbygpKQogICAgICAgICAgICByZXR1cm4gbmV3IE51bWJlclZlcnNpb25TdHJh\ndGVneSgpOwogICAgICAgIHJldHVybiBOb25lVmVyc2lvblN0cmF0ZWd5Lmdl\ndEluc3RhbmNlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGRlZmF1bHQgdmVyc2lvbiBzdHJhdGVneSwgZ2l2ZW4gYSB2ZXJzaW9uIGZp\nZWxkLgogICAgICovCiAgICBwcm90ZWN0ZWQgVmVyc2lvblN0cmF0ZWd5IGRl\nZmF1bHRTdHJhdGVneShWZXJzaW9uIHZlcnMsCiAgICAgICAgRmllbGRNYXBw\naW5nIHZmaWVsZCkgewogICAgICAgIHN3aXRjaCAodmZpZWxkLmdldFR5cGVD\nb2RlKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuREFURToKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0FMRU5EQVI6CiAgICAgICAgICAg\nICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcFZlcnNpb25TdHJhdGVneSgpOwog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkxPTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFX09CSjoKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuSU5UX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuTE9OR19PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNI\nT1JUX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTlVNQkVSOgog\nICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBOdW1iZXJWZXJzaW9uU3RyYXRl\nZ3koKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJl\ndHVybiBOb25lVmVyc2lvblN0cmF0ZWd5LmdldEluc3RhbmNlKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24o\nKQogICAgewogICAgICAgIHN1cGVyLmVuZENvbmZpZ3VyYXRpb24oKTsKCiAg\nICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IChKREJDQ29uZmlndXJh\ndGlvbikgZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIF9kaWN0ID0gY29u\nZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIGlmIChfZGVm\nYXVsdHMgPT0gbnVsbCkKICAgICAgICAgICAgX2RlZmF1bHRzID0gY29uZi5n\nZXRNYXBwaW5nRGVmYXVsdHNJbnN0YW5jZSgpOwogICAgfQp9Cg==\n","encoding":"base64"}

