{"sha":"28aa8905eb5fe00d4231278f196e737619c84b91","node_id":"MDQ6QmxvYjIwNjM2NDoyOGFhODkwNWViNWZlMDBkNDIzMTI3OGYxOTZlNzM3NjE5Yzg0Yjkx","size":41645,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/28aa8905eb5fe00d4231278f196e737619c84b91","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uUHJpbnRX\ncml0ZXI7CmltcG9ydCBqYXZhLmlvLldyaXRlcjsKaW1wb3J0IGphdmEuc3Fs\nLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNo\nTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2\nYS51dGlsLlNldDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5P\ncGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uSW1wbDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5KREJDU2Vx\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVt\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5EeW5h\nbWljU2NoZW1hRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5MYXp5U2NoZW1hRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWE7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hR2VuZXJhdG9yOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdyb3Vw\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVt\nYVNlcmlhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuU2NoZW1hVG9vbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5YTUxTY2hlbWFTZXJpYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU2VxOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5tZXRhLkNsYXNzQXJnUGFyc2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkZpbGVzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIudXRpbC5PcHRpb25zOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLlNlcnZpY2VzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YUZhY3Rvcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YU1vZGVzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5WYWx1ZVN0cmF0ZWdpZXM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5HZW5lcmFsRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0\nYUV4Y2VwdGlvbjsKCi8qKgogKiBUb29sIGZvciBtYW5pcHVsYXRpbmcgY2xh\nc3MgbWFwcGluZ3MgYW5kIGFzc29jaWF0ZWQgc2NoZW1hLgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIE1hcHBpbmdUb29sCiAg\nICBpbXBsZW1lbnRzIE1ldGFEYXRhTW9kZXMgewoKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFNDSEVNQV9BQ1RJT05fTk9ORSA9ICJub25lIjsK\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fQUREID0g\nImFkZCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05f\nUkVGUkVTSCA9ICJyZWZyZXNoIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEFDVElPTl9CVUlMRF9TQ0hFTUEgPSAiYnVpbGRTY2hlbWEiOwog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0RST1AgPSAi\nZHJvcCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05f\nVkFMSURBVEUgPSAidmFsaWRhdGUiOwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgQUNUSU9OX0VYUE9SVCA9ICJleHBvcnQiOwogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0lNUE9SVCA9ICJpbXBvcnQi\nOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nW10gQUNUSU9OUyA9\nIG5ldyBTdHJpbmdbXXsKICAgICAgICBBQ1RJT05fQURELAogICAgICAgIEFD\nVElPTl9SRUZSRVNILAogICAgICAgIEFDVElPTl9CVUlMRF9TQ0hFTUEsCiAg\nICAgICAgQUNUSU9OX0RST1AsCiAgICAgICAgQUNUSU9OX1ZBTElEQVRFLAog\nICAgICAgIEFDVElPTl9FWFBPUlQsCiAgICAgICAgQUNUSU9OX0lNUE9SVCwK\nICAgIH07CgogICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZShNYXBwaW5nVG9vbC5jbGFzcyk7CgogICAg\ncHJpdmF0ZSBmaW5hbCBKREJDQ29uZmlndXJhdGlvbiBfY29uZjsKICAgIHBy\naXZhdGUgZmluYWwgTG9nIF9sb2c7CiAgICBwcml2YXRlIGZpbmFsIFN0cmlu\nZyBfYWN0aW9uOwogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9tZXRhOwog\nICAgcHJpdmF0ZSBmaW5hbCBpbnQgX21vZGU7CgogICAgcHJpdmF0ZSBNYXBw\naW5nUmVwb3NpdG9yeSBfcmVwb3MgPSBudWxsOwogICAgcHJpdmF0ZSBTY2hl\nbWFHcm91cCBfc2NoZW1hID0gbnVsbDsKICAgIHByaXZhdGUgU2NoZW1hVG9v\nbCBfc2NoZW1hVG9vbCA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfc2No\nZW1hQWN0aW9uID0gU2NoZW1hVG9vbC5BQ1RJT05fQUREOwogICAgcHJpdmF0\nZSBib29sZWFuIF9yZWFkU2NoZW1hID0gZmFsc2U7CiAgICBwcml2YXRlIGJv\nb2xlYW4gX3BrcyA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9ma3Mg\nPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfaW5kZXhlcyA9IGZhbHNl\nOwogICAgcHJpdmF0ZSBib29sZWFuIF9zZXFzID0gdHJ1ZTsKICAgIHByaXZh\ndGUgYm9vbGVhbiBfZHJvcFVudXNlZCA9IHRydWU7CiAgICBwcml2YXRlIGJv\nb2xlYW4gX2lnbm9yZUVycm9ycyA9IGZhbHNlOwogICAgcHJpdmF0ZSBGaWxl\nIF9maWxlID0gbnVsbDsKICAgIHByaXZhdGUgV3JpdGVyIF9tYXBwaW5nV3Jp\ndGVyID0gbnVsbDsKICAgIHByaXZhdGUgV3JpdGVyIF9zY2hlbWFXcml0ZXIg\nPSBudWxsOwoKICAgIC8vIGJ1ZmZlciBtZXRhZGF0YXMgdG8gYmUgZHJvcHBl\nZAogICAgcHJpdmF0ZSBTZXQgX2Ryb3BDbHMgPSBudWxsOwogICAgcHJpdmF0\nZSBTZXQgX2Ryb3BNYXAgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9m\nbHVzaCA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9mbHVzaFNjaGVt\nYSA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuIFN1cHBs\neSBjb25maWd1cmF0aW9uIGFuZCBhY3Rpb24uCiAgICAgKi8KICAgIHB1Ymxp\nYyBNYXBwaW5nVG9vbChKREJDQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmcg\nYWN0aW9uLCBib29sZWFuIG1ldGEpIHsKICAgICAgICBfY29uZiA9IGNvbmY7\nCiAgICAgICAgX2xvZyA9IGNvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9u\nLkxPR19NRVRBREFUQSk7CiAgICAgICAgX21ldGEgPSBtZXRhOwoKICAgICAg\nICBpZiAoYWN0aW9uID09IG51bGwpCiAgICAgICAgICAgIF9hY3Rpb24gPSBB\nQ1RJT05fUkVGUkVTSDsKICAgICAgICBlbHNlIGlmICghQXJyYXlzLmFzTGlz\ndChBQ1RJT05TKS5jb250YWlucyhhY3Rpb24pKQogICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJhY3Rpb24gPT0gIiAr\nIGFjdGlvbik7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfYWN0aW9uID0g\nYWN0aW9uOwoKICAgICAgICBpZiAobWV0YSAmJiBBQ1RJT05fQURELmVxdWFs\ncyhfYWN0aW9uKSkKICAgICAgICAgICAgX21vZGUgPSBNT0RFX01FVEE7CiAg\nICAgICAgZWxzZSBpZiAobWV0YSAmJiBBQ1RJT05fRFJPUC5lcXVhbHMoX2Fj\ndGlvbikpCiAgICAgICAgICAgIF9tb2RlID0gTU9ERV9NRVRBIHwgTU9ERV9N\nQVBQSU5HIHwgTU9ERV9RVUVSWTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIF9tb2RlID0gTU9ERV9NQVBQSU5HOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGFjdGlvbiBzdXBwbGllZCBvbiBjb25zdHJ1Y3Rpb24uCiAgICAgKi8K\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0QWN0aW9uKCkgewogICAgICAgIHJldHVy\nbiBfYWN0aW9uOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGUg\nYWN0aW9uIHdvcmtzIG9uIG1ldGFkYXRhIGFzIHdlbGwgYXMgbWFwcGluZ3Mu\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzTWV0YURhdGFBY3Rpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF9tZXRhOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIHNjaGVtYSBtb2RpZmljYXRpb24gcG9saWN5LCBvciA8Y29kZT5u\nb25lPC9jb2RlPi4gU2VlIHRoZQogICAgICogQUNUSU9OIGNvbnN0YW50cyBp\nbiB7QGxpbmsgU2NoZW1hVG9vbH0uIERlZmF1bHRzIHRvCiAgICAgKiB7QGxp\nbmsgU2NoZW1hVG9vbCNBQ1RJT05fQUREfS4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRTY2hlbWFBY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9z\nY2hlbWFBY3Rpb247CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2NoZW1h\nIG1vZGlmaWNhdGlvbiBwb2xpY3ksIG9yIDxjb2RlPm5vbmU8L2NvZGU+LiBT\nZWUgdGhlCiAgICAgKiBBQ1RJT04gY29uc3RhbnRzIGluIHtAbGluayBTY2hl\nbWFUb29sfS4gRGVmYXVsdHMgdG8KICAgICAqIHtAbGluayBTY2hlbWFUb29s\nI0FDVElPTl9BRER9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hl\nbWFBY3Rpb24oU3RyaW5nIHNjaGVtYUFjdGlvbikgewogICAgICAgIF9zY2hl\nbWFBY3Rpb24gPSBzY2hlbWFBY3Rpb247CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdG8gdHJ1ZSB0byByZWFkIHRoZSBlbnRpcmUgc2NoZW1hIGJlZm9y\nZSBtYXBwaW5nLgogICAgICogTGVhdmluZyB0aGlzIG9wdGlvbiBmYWxzZSBz\nYXZlcyB0aW1lLCBidXQgaXMgZGFuZ2Vyb3VzIHdoZW4gYWRkaW5nCiAgICAg\nKiBuZXcgbWFwcGluZ3MsIGJlY2F1c2Ugd2l0aG91dCBmdWxsIGtub3dsZWRn\nZSBvZiB0aGUgZXhpc3Rpbmcgc2NoZW1hIHRoZQogICAgICogbWFwcGluZyB0\nb29sIG1pZ2h0IGNyZWF0ZSB0YWJsZXMgb3IgaW5kZXhlcyB0aGF0IGNvbmZs\naWN0IHdpdGgKICAgICAqIGV4aXN0aW5nIGNvbXBvbmVudHMuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGdldFJlYWRTY2hlbWEoKSB7CiAgICAgICAg\ncmV0dXJuIF9yZWFkU2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogU2V0\nIHRvIHRydWUgdG8gcmVhZCB0aGUgZW50aXJlIHNjaGVtYSBiZWZvcmUgbWFw\ncGluZy4KICAgICAqIExlYXZpbmcgdGhpcyBvcHRpb24gZmFsc2Ugc2F2ZXMg\ndGltZSwgYnV0IGlzIGRhbmdlcm91cyB3aGVuIGFkZGluZwogICAgICogbmV3\nIG1hcHBpbmdzLCBiZWNhdXNlIHdpdGhvdXQgZnVsbCBrbm93bGVkZ2Ugb2Yg\ndGhlIGV4aXN0aW5nIHNjaGVtYSB0aGUKICAgICAqIG1hcHBpbmcgdG9vbCBt\naWdodCBjcmVhdGUgdGFibGVzIG9yIGluZGV4ZXMgdGhhdCBjb25mbGljdCB3\naXRoCiAgICAgKiBleGlzdGluZyBjb21wb25lbnRzLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRSZWFkU2NoZW1hKGJvb2xlYW4gcmVhZFNjaGVtYSkg\newogICAgICAgIF9yZWFkU2NoZW1hID0gcmVhZFNjaGVtYTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgdG8gbWFuaXB1bGF0ZSBzZXF1ZW5jZXMu\nIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGdldFNlcXVlbmNlcygpIHsKICAgICAgICByZXR1cm4gX3NlcXM7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIG1hbmlwdWxhdGUgc2VxdWVu\nY2VzLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRTZXF1ZW5jZXMoYm9vbGVhbiBzZXFzKSB7CiAgICAgICAgX3NlcXMg\nPSBzZXFzOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBpbmRleGVz\nIG9uIGV4aXN0aW5nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAg\nICAgKiBEZWZhdWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gZ2V0SW5kZXhlcygpIHsKICAgICAgICByZXR1cm4gX2luZGV4ZXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGluZGV4ZXMgb24gZXhp\nc3RpbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERl\nZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJ\nbmRleGVzKGJvb2xlYW4gaW5kZXhlcykgewogICAgICAgIF9pbmRleGVzID0g\naW5kZXhlczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgZm9yZWln\nbiBrZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0\nZWQuCiAgICAgKiBEZWZhdWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0Rm9yZWlnbktleXMoKSB7CiAgICAgICAgcmV0dXJu\nIF9ma3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGZvcmVpZ24g\na2V5cyBvbiBleGlzdGluZyB0YWJsZXMgc2hvdWxkIGJlIG1hbmlwdWxhdGVk\nLgogICAgICogRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldEZvcmVpZ25LZXlzKGJvb2xlYW4gZmtzKSB7CiAgICAgICAg\nX2ZrcyA9IGZrczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgcHJp\nbWFyeSBrZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1\nbGF0ZWQuCiAgICAgKiBEZWZhdWx0cyB0byBmYWxzZS4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gZ2V0UHJpbWFyeUtleXMoKSB7CiAgICAgICAgcmV0\ndXJuIF9wa3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHByaW1h\ncnkga2V5cyBvbiBleGlzdGluZyB0YWJsZXMgc2hvdWxkIGJlIG1hbmlwdWxh\ndGVkLgogICAgICogRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFByaW1hcnlLZXlzKGJvb2xlYW4gcGtzKSB7CiAgICAg\nICAgX3BrcyA9IHBrczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIg\nc2NoZW1hIGNvbXBvbmVudHMgdGhhdCBhcmUgdW51c2VkIGJ5IGFueSBtYXBw\naW5nIHdpbGwgYmUKICAgICAqIGRyb3BwZWQgZnJvbSB0aGlzIHRvb2wncyB7\nQGxpbmsgU2NoZW1hR3JvdXB9LCBhbmQsIGRlcGVuZGluZyBvbgogICAgICog\ndGhlIHNjaGVtYSBhY3Rpb24sIGZyb20gdGhlIGRhdGFiYXNlLiBEZWZhdWx0\ncyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXREcm9w\nVW51c2VkQ29tcG9uZW50cygpIHsKICAgICAgICByZXR1cm4gX2Ryb3BVbnVz\nZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHNjaGVtYSBjb21w\nb25lbnRzIHRoYXQgYXJlIHVudXNlZCBieSBhbnkgbWFwcGluZyB3aWxsIGJl\nCiAgICAgKiBkcm9wcGVkIGZyb20gdGhpcyB0b29sJ3Mge0BsaW5rIFNjaGVt\nYUdyb3VwfSwgYW5kLCBkZXBlbmRpbmcgb24KICAgICAqIHRoZSBzY2hlbWEg\nYWN0aW9uLCBmcm9tIHRoZSBkYXRhYmFzZS4gRGVmYXVsdHMgdG8gdHJ1ZS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RHJvcFVudXNlZENvbXBvbmVu\ndHMoYm9vbGVhbiBkcm9wVW51c2VkKSB7CiAgICAgICAgX2Ryb3BVbnVzZWQg\nPSBkcm9wVW51c2VkOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBh\nbmQgU1FMIGVycm9ycyBzaG91bGQgY2F1c2UgYSBmYWlsdXJlIG9yIGp1c3Qg\naXNzdWUgYSB3YXJuaW5nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJ\nZ25vcmVFcnJvcnMoYm9vbGVhbiBpZ25vcmVFcnJvcnMpIHsKICAgICAgICBf\naWdub3JlRXJyb3JzID0gaWdub3JlRXJyb3JzOwogICAgfQoKICAgIC8qKgog\nICAgICogV2hldGhlciBhbmQgU1FMIGVycm9ycyBzaG91bGQgY2F1c2UgYSBm\nYWlsdXJlIG9yIGp1c3QgaXNzdWUgYSB3YXJuaW5nLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRJZ25vcmVFcnJvcnMoKSB7CiAgICAgICAgcmV0\ndXJuIF9pZ25vcmVFcnJvcnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIHNjaGVtYSB0b29sIHRvIHVzZSBmb3Igc2NoZW1hIG1vZGlmaWNh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIFNjaGVtYVRvb2wgZ2V0U2NoZW1h\nVG9vbCgpIHsKICAgICAgICBpZiAoX3NjaGVtYVRvb2wgPT0gbnVsbCkKICAg\nICAgICAgICAgX3NjaGVtYVRvb2wgPSBuZXdTY2hlbWFUb29sKF9zY2hlbWFB\nY3Rpb24pOwogICAgICAgIHJldHVybiBfc2NoZW1hVG9vbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgc2NoZW1hIHRvb2wgdG8gdXNlIGZv\nciBzY2hlbWEgbW9kaWZpY2F0aW9uLgogICAgICovCiAgICBwcml2YXRlIFNj\naGVtYVRvb2wgbmV3U2NoZW1hVG9vbChTdHJpbmcgYWN0aW9uKSB7CiAgICAg\nICAgaWYgKFNDSEVNQV9BQ1RJT05fTk9ORS5lcXVhbHMoYWN0aW9uKSkKICAg\nICAgICAgICAgYWN0aW9uID0gbnVsbDsKICAgICAgICBTY2hlbWFUb29sIHRv\nb2wgPSBuZXcgU2NoZW1hVG9vbChfY29uZiwgYWN0aW9uKTsKICAgICAgICB0\nb29sLnNldElnbm9yZUVycm9ycyhnZXRJZ25vcmVFcnJvcnMoKSk7CiAgICAg\nICAgdG9vbC5zZXRQcmltYXJ5S2V5cyhnZXRQcmltYXJ5S2V5cygpKTsKICAg\nICAgICB0b29sLnNldEZvcmVpZ25LZXlzKGdldEZvcmVpZ25LZXlzKCkpOwog\nICAgICAgIHRvb2wuc2V0SW5kZXhlcyhnZXRJbmRleGVzKCkpOwogICAgICAg\nIHRvb2wuc2V0U2VxdWVuY2VzKGdldFNlcXVlbmNlcygpKTsKICAgICAgICBy\nZXR1cm4gdG9vbDsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgc2No\nZW1hIHRvb2wgdG8gdXNlIGZvciBzY2hlbWEgbW9kaWZpY2F0aW9uLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hlbWFUb29sKFNjaGVtYVRvb2wg\ndG9vbCkgewogICAgICAgIF9zY2hlbWFUb29sID0gdG9vbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBzdHJlYW0gdG8gZXhwb3J0IHRoZSBwbGFubmVk\nIHNjaGVtYSB0byBhcyBhbiBYTUwgZG9jdW1lbnQuCiAgICAgKiBJZiBub24t\nbnVsbCwgdGhlbiB0aGUgZGF0YWJhc2Ugc2NoZW1hIHdpbGwgbm90IGJlIGFs\ndGVyZWQuCiAgICAgKi8KICAgIHB1YmxpYyBXcml0ZXIgZ2V0U2NoZW1hV3Jp\ndGVyKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hV3JpdGVyOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5u\nZWQgc2NoZW1hIHRvIGFzIGFuIFhNTCBkb2N1bWVudC4KICAgICAqIElmIG5v\nbi1udWxsLCB0aGVuIHRoZSBkYXRhYmFzZSBzY2hlbWEgd2lsbCBub3QgYmUg\nYWx0ZXJlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U2NoZW1hV3Jp\ndGVyKFdyaXRlciBzY2hlbWFXcml0ZXIpIHsKICAgICAgICBfc2NoZW1hV3Jp\ndGVyID0gc2NoZW1hV3JpdGVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5uZWQgbWFwcGluZ3MgdG8gYXMg\nYW4gWE1MIGRvY3VtZW50LgogICAgICogSWYgbm9uLW51bGwsIHRoZW4gdGhl\nIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxsIG5vdCBiZSBhbHRlcmVkLgogICAg\nICovCiAgICBwdWJsaWMgV3JpdGVyIGdldE1hcHBpbmdXcml0ZXIoKSB7CiAg\nICAgICAgcmV0dXJuIF9tYXBwaW5nV3JpdGVyOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5uZWQgbWFwcGlu\nZ3MgdG8gYXMgYW4gWE1MIGRvY3VtZW50LgogICAgICogSWYgbm9uLW51bGws\nIHRoZW4gdGhlIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxsIG5vdCBiZSBhbHRl\ncmVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNYXBwaW5nV3JpdGVy\nKFdyaXRlciBtYXBwaW5nV3JpdGVyKSB7CiAgICAgICAgX21hcHBpbmdXcml0\nZXIgPSBtYXBwaW5nV3JpdGVyOwogICAgfQoKICAgIC8qKgogICAgICogSWYg\nYWRkaW5nIG1ldGFkYXRhLCB0aGUgbWV0YWRhdGEgZmlsZSB0byBhZGQgdG8u\nCiAgICAgKi8KICAgIHB1YmxpYyBGaWxlIGdldE1ldGFEYXRhRmlsZSgpIHsK\nICAgICAgICByZXR1cm4gX2ZpbGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nZiBhZGRpbmcgbWV0YWRhdGEsIHRoZSBtZXRhZGF0YSBmaWxlIHRvIGFkZCB0\nby4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWV0YURhdGFGaWxlKEZp\nbGUgZmlsZSkgewogICAgICAgIF9maWxlID0gZmlsZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcmVwb3NpdG9yeSB0byB1c2UgdG8gYWNj\nZXNzIG1hcHBpbmcgaW5mb3JtYXRpb24uCiAgICAgKiBEZWZhdWx0cyB0byBh\nIG5ldyB7QGxpbmsgTWFwcGluZ1JlcG9zaXRvcnl9LgogICAgICovCiAgICBw\ndWJsaWMgTWFwcGluZ1JlcG9zaXRvcnkgZ2V0UmVwb3NpdG9yeSgpIHsKICAg\nICAgICBpZiAoX3JlcG9zID09IG51bGwpIHsKICAgICAgICAgICAgX3JlcG9z\nID0gX2NvbmYubmV3TWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5jZSgpOwogICAg\nICAgICAgICBfcmVwb3Muc2V0U2NoZW1hR3JvdXAoZ2V0U2NoZW1hR3JvdXAo\nKSk7CiAgICAgICAgICAgIF9yZXBvcy5zZXRWYWxpZGF0ZShfcmVwb3MuVkFM\nSURBVEVfVU5FTkhBTkNFRCwgZmFsc2UpOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gX3JlcG9zOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBy\nZXBvc2l0b3J5IHRvIHVzZSB0byBhY2Nlc3MgbWFwcGluZyBpbmZvcm1hdGlv\nbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVwb3NpdG9yeShNYXBw\naW5nUmVwb3NpdG9yeSByZXBvcykgewogICAgICAgIF9yZXBvcyA9IHJlcG9z\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzY2hlbWEgZ3Jv\ndXAgdG8gdXNlIGluIG1hcHBpbmcuIElmIG5vbmUgaGFzIGJlZW4gc2V0LCB0\naGUKICAgICAqIHNjaGVtYSB3aWxsIGJlIGdlbmVyYXRlZCBmcm9tIHRoZSBk\nYXRhYmFzZS4KICAgICAqLwogICAgcHVibGljIFNjaGVtYUdyb3VwIGdldFNj\naGVtYUdyb3VwKCkgewogICAgICAgIGlmIChfc2NoZW1hID09IG51bGwpIHsK\nICAgICAgICAgICAgaWYgKEFDVElPTl9CVUlMRF9TQ0hFTUEuZXF1YWxzKF9h\nY3Rpb24pKSB7CiAgICAgICAgICAgICAgICBEeW5hbWljU2NoZW1hRmFjdG9y\neSBmYWN0b3J5ID0gbmV3IER5bmFtaWNTY2hlbWFGYWN0b3J5KCk7CiAgICAg\nICAgICAgICAgICBmYWN0b3J5LnNldENvbmZpZ3VyYXRpb24oX2NvbmYpOwog\nICAgICAgICAgICAgICAgX3NjaGVtYSA9IGZhY3Rvcnk7CiAgICAgICAgICAg\nIH0gZWxzZSBpZiAoX3JlYWRTY2hlbWEKICAgICAgICAgICAgICAgIHx8IFNj\naGVtYVRvb2wuQUNUSU9OX1JFVEFJTi5lcXVhbHMoX3NjaGVtYUFjdGlvbikK\nICAgICAgICAgICAgICAgIHx8IFNjaGVtYVRvb2wuQUNUSU9OX1JFRlJFU0gu\nZXF1YWxzKF9zY2hlbWFBY3Rpb24pKSB7CiAgICAgICAgICAgICAgICBfc2No\nZW1hID0gKFNjaGVtYUdyb3VwKSBnZXRTY2hlbWFUb29sKCkuZ2V0REJTY2hl\nbWFHcm91cCgpLgogICAgICAgICAgICAgICAgICAgIGNsb25lKCk7CiAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyB3aXRoIHRoaXMg\nd2UnbGwganVzdCByZWFkIHRhYmxlcyBhcyBkaWZmZXJlbnQgbWFwcGluZ3MK\nICAgICAgICAgICAgICAgIC8vIGxvb2sgZm9yIHRoZW0KICAgICAgICAgICAg\nICAgIExhenlTY2hlbWFGYWN0b3J5IGZhY3RvcnkgPSBuZXcgTGF6eVNjaGVt\nYUZhY3RvcnkoKTsKICAgICAgICAgICAgICAgIGZhY3Rvcnkuc2V0Q29uZmln\ndXJhdGlvbihfY29uZik7CiAgICAgICAgICAgICAgICBmYWN0b3J5LnNldFBy\naW1hcnlLZXlzKGdldFByaW1hcnlLZXlzKCkpOwogICAgICAgICAgICAgICAg\nZmFjdG9yeS5zZXRGb3JlaWduS2V5cyhnZXRGb3JlaWduS2V5cygpKTsKICAg\nICAgICAgICAgICAgIGZhY3Rvcnkuc2V0SW5kZXhlcyhnZXRJbmRleGVzKCkp\nOwogICAgICAgICAgICAgICAgX3NjaGVtYSA9IGZhY3Rvcnk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIGlmIChfc2NoZW1hLmdldFNjaGVtYXMoKS5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgIF9zY2hlbWEuYWRkU2NoZW1h\nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfc2NoZW1hOwogICAgfQoK\nICAgIC8qKgogICAgICogU2V0IHRoZSBzY2hlbWEgdG8gdXNlIGluIG1hcHBp\nbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNjaGVtYUdyb3VwKFNj\naGVtYUdyb3VwIHNjaGVtYSkgewogICAgICAgIF9zY2hlbWEgPSBzY2hlbWE7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNldCB0aGUgaW50ZXJuYWwgcmVw\nb3NpdG9yeS4gVGhpcyBpcyBjYWxsZWQgYXV0b21hdGljYWxseSBhZnRlcgog\nICAgICogZXZlcnkge0BsaW5rICNyZWNvcmR9LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBfcmVwb3MgPSBudWxsOwogICAg\nICAgIF9zY2hlbWEgPSBudWxsOwogICAgICAgIF9zY2hlbWFUb29sID0gbnVs\nbDsKICAgICAgICBfZmx1c2ggPSBmYWxzZTsKICAgICAgICBfZmx1c2hTY2hl\nbWEgPSBmYWxzZTsKICAgICAgICBpZiAoX2Ryb3BDbHMgIT0gbnVsbCkKICAg\nICAgICAgICAgX2Ryb3BDbHMuY2xlYXIoKTsKICAgICAgICBpZiAoX2Ryb3BN\nYXAgIT0gbnVsbCkKICAgICAgICAgICAgX2Ryb3BNYXAuY2xlYXIoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlY29yZHMgdGhlIGNoYW5nZXMgdGhhdCBo\nYXZlIGJlZW4gbWFkZSB0byBib3RoIHRoZSBtYXBwaW5ncyBhbmQgdGhlCiAg\nICAgKiBhc3NvY2lhdGVkIHNjaGVtYSwgYW5kIGNsZWFycyB0aGUgdG9vbCBm\nb3IgZnVydGhlciB1c2UuIFRoaXMgYWxzbwogICAgICogaW52b2x2ZXMgY2xl\nYXJpbmcgdGhlIGludGVybmFsIG1hcHBpbmcgcmVwb3NpdG9yeS4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgcmVjb3JkKCkgewogICAgICAgIE1hcHBpbmdS\nZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIE1l\ndGFEYXRhRmFjdG9yeSBpbyA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgp\nOwogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzOwogICAgICAgIGlm\nICghQUNUSU9OX0RST1AuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICBt\nYXBwaW5ncyA9IHJlcG9zLmdldE1hcHBpbmdzKCk7CiAgICAgICAgZWxzZSBp\nZiAoX2Ryb3BNYXAgIT0gbnVsbCkKICAgICAgICAgICAgbWFwcGluZ3MgPSAo\nQ2xhc3NNYXBwaW5nW10pIF9kcm9wTWFwLnRvQXJyYXkKICAgICAgICAgICAg\nICAgIChuZXcgQ2xhc3NNYXBwaW5nW19kcm9wTWFwLnNpemUoKV0pOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgbWFwcGluZ3MgPSBuZXcgQ2xhc3NNYXBw\naW5nWzBdOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoX2Ryb3BD\nbHMgIT0gbnVsbCAmJiAhX2Ryb3BDbHMuaXNFbXB0eSgpKSB7CiAgICAgICAg\nICAgICAgICBDbGFzc1tdIGNscyA9IChDbGFzc1tdKSBfZHJvcENscy50b0Fy\ncmF5CiAgICAgICAgICAgICAgICAgICAgKG5ldyBDbGFzc1tfZHJvcENscy5z\naXplKCldKTsKICAgICAgICAgICAgICAgIGlmICghaW8uZHJvcChjbHMsIF9t\nb2RlLCBudWxsKSkKICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xv\nYy5nZXQoImJhZC1kcm9wIiwgX2Ryb3BDbHMpKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgaWYgKF9mbHVzaFNjaGVtYSkgewogICAgICAgICAgICAg\nICAgLy8gZHJvcCBwb3J0aW9ucyBvZiB0aGUga25vd24gc2NoZW1hIHRoYXQg\nbm8gbWFwcGluZyB1c2VzLCBhbmQKICAgICAgICAgICAgICAgIC8vIGFkZCBz\nZXF1ZW5jZXMgdXNlZCBmb3IgdmFsdWUgZ2VuZXJhdGlvbgogICAgICAgICAg\nICAgICAgaWYgKF9kcm9wVW51c2VkKQogICAgICAgICAgICAgICAgICAgIGRy\nb3BVbnVzZWRTY2hlbWFDb21wb25lbnRzKG1hcHBpbmdzKTsKICAgICAgICAg\nICAgICAgIGFkZFNlcXVlbmNlQ29tcG9uZW50cyhtYXBwaW5ncyk7CgogICAg\nICAgICAgICAgICAgLy8gbm93IHJ1biB0aGUgc2NoZW1hdG9vbCBhcyBsb25n\nIGFzIHdlJ3JlIGRvaW5nIHNvbWUgc2NoZW1hCiAgICAgICAgICAgICAgICAv\nLyBhY3Rpb24gYW5kIHRoZSB1c2VyIGRvZXNuJ3QganVzdCB3YW50IGFuIHht\nbCBvdXRwdXQKICAgICAgICAgICAgICAgIGlmICghU0NIRU1BX0FDVElPTl9O\nT05FLmVxdWFscyhfc2NoZW1hQWN0aW9uKQogICAgICAgICAgICAgICAgICAg\nICYmIChfc2NoZW1hV3JpdGVyID09IG51bGwgfHwgKF9zY2hlbWFUb29sICE9\nIG51bGwKICAgICAgICAgICAgICAgICAgICAmJiBfc2NoZW1hVG9vbC5nZXRX\ncml0ZXIoKSAhPSBudWxsKSkpIHsKICAgICAgICAgICAgICAgICAgICBTY2hl\nbWFUb29sIHRvb2wgPSBnZXRTY2hlbWFUb29sKCk7CiAgICAgICAgICAgICAg\nICAgICAgdG9vbC5zZXRTY2hlbWFHcm91cChnZXRTY2hlbWFHcm91cCgpKTsK\nICAgICAgICAgICAgICAgICAgICB0b29sLnJ1bigpOwogICAgICAgICAgICAg\nICAgICAgIHRvb2wucmVjb3JkKCk7CiAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgLy8geG1sIG91dHB1dCBvZiBzY2hlbWE/CiAgICAgICAg\nICAgICAgICBpZiAoX3NjaGVtYVdyaXRlciAhPSBudWxsKSB7CiAgICAgICAg\nICAgICAgICAgICAgLy8gc2VyaWFsaXplIHRoZSBwbGFubmVkIHNjaGVtYSB0\nbyB0aGUgc3RyZWFtCiAgICAgICAgICAgICAgICAgICAgU2NoZW1hU2VyaWFs\naXplciBzZXIgPSBuZXcgWE1MU2NoZW1hU2VyaWFsaXplcihfY29uZik7CiAg\nICAgICAgICAgICAgICAgICAgc2VyLmFkZEFsbChnZXRTY2hlbWFHcm91cCgp\nKTsKICAgICAgICAgICAgICAgICAgICBzZXIuc2VyaWFsaXplKF9zY2hlbWFX\ncml0ZXIsIHNlci5QUkVUVFkpOwogICAgICAgICAgICAgICAgICAgIF9zY2hl\nbWFXcml0ZXIuZmx1c2goKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgICAgICBpZiAoIV9mbHVzaCkKICAgICAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgICAgIFF1ZXJ5TWV0YURhdGFbXSBxdWVyaWVz\nID0gcmVwb3MuZ2V0UXVlcnlNZXRhRGF0YXMoKTsKICAgICAgICAgICAgU2Vx\ndWVuY2VNZXRhRGF0YVtdIHNlcXMgPSByZXBvcy5nZXRTZXF1ZW5jZU1ldGFE\nYXRhcygpOwogICAgICAgICAgICBNYXAgb3V0cHV0ID0gbnVsbDsKCiAgICAg\nICAgICAgIC8vIGlmIHdlJ3JlIG91dHB1dHRpbmcgdG8gc3RyZWFtLCBzZXQg\nYWxsIG1ldGFzIHRvIHNhbWUgZmlsZSBzbwogICAgICAgICAgICAvLyB0aGV5\nIGdldCBwbGFjZWQgaW4gc2luZ2xlIHN0cmluZwogICAgICAgICAgICBpZiAo\nX21hcHBpbmdXcml0ZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgb3V0\ncHV0ID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAgICAgIEZpbGUgdG1w\nID0gbmV3IEZpbGUoIm9wZW5qcGF0bXAiKTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICAgICAgbWFwcGluZ3NbaV0uc2V0U291cmNlKHRtcCwgbWFw\ncGluZ3NbaV0uU1JDX09USEVSKTsKICAgICAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgcXVlcmllcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgICAgICBxdWVyaWVzW2ldLnNldFNvdXJjZSh0bXAsIHF1ZXJpZXNbaV0u\nZ2V0U291cmNlU2NvcGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgcXVl\ncmllc1tpXS5TUkNfT1RIRVIpOwogICAgICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAg\nICAgIHNlcXNbaV0uc2V0U291cmNlKHRtcCwgc2Vxc1tpXS5nZXRTb3VyY2VT\nY29wZSgpLAogICAgICAgICAgICAgICAgICAgICAgICBzZXFzW2ldLlNSQ19P\nVEhFUik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHN0b3JlCiAg\nICAgICAgICAgIGlmICghaW8uc3RvcmUobWFwcGluZ3MsIHF1ZXJpZXMsIHNl\ncXMsIF9tb2RlLCBvdXRwdXQpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc3RvcmUiKSk7Cgog\nICAgICAgICAgICAvLyB3cml0ZSB0byBzdHJlYW0KICAgICAgICAgICAgaWYg\nKF9tYXBwaW5nV3JpdGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIFBy\naW50V3JpdGVyIG91dCA9IG5ldyBQcmludFdyaXRlcihfbWFwcGluZ1dyaXRl\ncik7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG91dHB1\ndC52YWx1ZXMoKS5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGl0\nci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgICAgIG91dC5wcmludGxu\nKChTdHJpbmcpIGl0ci5uZXh0KCkpOwogICAgICAgICAgICAgICAgb3V0LmZs\ndXNoKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2gg\nKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cgcmU7\nCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oZSk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgY2xlYXIoKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBEcm9wcyBzY2hlbWEgY29tcG9uZW50cyB0aGF0IGFw\ncGVhciB0byBiZSB1bnVzZWQgZnJvbSB0aGUgbG9jYWwKICAgICAqIGNvcHkg\nb2YgdGhlIHNjaGVtYSBncm91cC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGRyb3BVbnVzZWRTY2hlbWFDb21wb25lbnRzKENsYXNzTWFwcGluZ1tdIG1h\ncHBpbmdzKSB7CiAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgbWFwcGluZ3NbaV0ucmVmU2NoZW1hQ29tcG9uZW50\ncygpOwogICAgICAgICAgICBtYXBwaW5nc1tpXS5nZXREaXNjcmltaW5hdG9y\nKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAgICAgICAgICBtYXBwaW5n\nc1tpXS5nZXRWZXJzaW9uKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAg\nICAgICAgICBmaWVsZHMgPSBtYXBwaW5nc1tpXS5nZXREZWZpbmVkRmllbGRN\nYXBwaW5ncygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGZp\nZWxkcy5sZW5ndGg7IGorKykKICAgICAgICAgICAgICAgIGZpZWxkc1tqXS5y\nZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBh\nbHNvIGFsbG93IHRoZSBkYmRpY3Rpb25hcnkgdG8gcmVmIGFueSBzY2hlbWEg\nY29tcG9uZW50cyB0aGF0CiAgICAgICAgLy8gaXQgYWRkcyBhcGFydCBmcm9t\nIG1hcHBpbmdzCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRTY2hl\nbWFHcm91cCgpOwogICAgICAgIFNjaGVtYVtdIHNjaGVtYXMgPSBncm91cC5n\nZXRTY2hlbWFzKCk7CiAgICAgICAgVGFibGVbXSB0YWJsZXM7CiAgICAgICAg\nREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0\nYW5jZSgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFzW2ld\nLmdldFRhYmxlcygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8\nIHRhYmxlcy5sZW5ndGg7IGorKykKICAgICAgICAgICAgICAgIGRpY3QucmVm\nU2NoZW1hQ29tcG9uZW50cyh0YWJsZXNbal0pOwogICAgICAgIH0KCiAgICAg\nICAgZ3JvdXAucmVtb3ZlVW51c2VkQ29tcG9uZW50cygpOwogICAgfQoKICAg\nIC8qKgogICAgICogQWRkIHRhYmxlcyB1c2VkIGJ5IHNlcXVlbmNlcyB0byB0\naGUgZ2l2ZW4gc2NoZW1hLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRk\nU2VxdWVuY2VDb21wb25lbnRzKENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzKSB7\nCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRTY2hlbWFHcm91cCgp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIGFkZFNlcXVlbmNlQ29tcG9uZW50cyhtYXBw\naW5nc1tpXSwgZ3JvdXApOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRh\nYmxlcyB1c2VkIGJ5IHNlcXVlbmNlcyB0byB0aGUgZ2l2ZW4gc2NoZW1hLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkU2VxdWVuY2VDb21wb25lbnRz\nKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAgIFNjaGVtYUdyb3VwIGdy\nb3VwKSB7CiAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBzbWQgPSBtYXBwaW5n\nLmdldElkZW50aXR5U2VxdWVuY2VNZXRhRGF0YSgpOwogICAgICAgIFNlcSBz\nZXEgPSBudWxsOwogICAgICAgIGlmIChzbWQgIT0gbnVsbCkKICAgICAgICAg\nICAgc2VxID0gc21kLmdldEluc3RhbmNlKG51bGwpOwogICAgICAgIGVsc2Ug\naWYgKG1hcHBpbmcuZ2V0SWRlbnRpdHlTdHJhdGVneSgpID09IFZhbHVlU3Ry\nYXRlZ2llcy5OQVRJVkUKICAgICAgICAgICAgfHwgKG1hcHBpbmcuZ2V0SWRl\nbnRpdHlTdHJhdGVneSgpID09IFZhbHVlU3RyYXRlZ2llcy5OT05FCiAgICAg\nICAgICAgICYmIG1hcHBpbmcuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NN\nYXBwaW5nLklEX0RBVEFTVE9SRSkpCiAgICAgICAgICAgIHNlcSA9IF9jb25m\nLmdldFNlcXVlbmNlSW5zdGFuY2UoKTsKCiAgICAgICAgaWYgKHNlcSBpbnN0\nYW5jZW9mIEpEQkNTZXEpCiAgICAgICAgICAgICgoSkRCQ1NlcSkgc2VxKS5h\nZGRTY2hlbWEobWFwcGluZywgZ3JvdXApOwoKICAgICAgICBGaWVsZE1hcHBp\nbmdbXSBmbWRzOwogICAgICAgIGlmIChtYXBwaW5nLmdldEVtYmVkZGluZ01l\ndGFEYXRhKCkgPT0gbnVsbCkKICAgICAgICAgICAgZm1kcyA9IG1hcHBpbmcu\nZ2V0RGVmaW5lZEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIGZtZHMgPSBtYXBwaW5nLmdldEZpZWxkTWFwcGluZ3MoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgc21kID0gZm1kc1tpXS5nZXRWYWx1ZVNlcXVlbmNlTWV0\nYURhdGEoKTsKICAgICAgICAgICAgaWYgKHNtZCAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBzZXEgPSBzbWQuZ2V0SW5zdGFuY2UobnVsbCk7CiAgICAg\nICAgICAgICAgICBpZiAoc2VxIGluc3RhbmNlb2YgSkRCQ1NlcSkKICAgICAg\nICAgICAgICAgICAgICAoKEpEQkNTZXEpIHNlcSkuYWRkU2NoZW1hKG1hcHBp\nbmcsIGdyb3VwKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChmbWRzW2ldLmdl\ndEVtYmVkZGVkTWFwcGluZygpICE9IG51bGwpCiAgICAgICAgICAgICAgICBh\nZGRTZXF1ZW5jZUNvbXBvbmVudHMoZm1kc1tpXS5nZXRFbWJlZGRlZE1hcHBp\nbmcoKSwgZ3JvdXApOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8v\nLwogICAgLy8gQWN0aW9ucwogICAgLy8vLy8vLy8vLy8KCiAgICAvKioKICAg\nICAqIFJ1biB0aGUgY29uZmlndXJlZCBhY3Rpb24gb24gdGhlIGdpdmVuIGlu\nc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBydW4oQ2xhc3MgY2xz\nKSB7CiAgICAgICAgaWYgKEFDVElPTl9BREQuZXF1YWxzKF9hY3Rpb24pKSB7\nCiAgICAgICAgICAgIGlmIChfbWV0YSkKICAgICAgICAgICAgICAgIGFkZE1l\ndGEoY2xzKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYWRk\nKGNscyk7CiAgICAgICAgfSBlbHNlIGlmIChBQ1RJT05fUkVGUkVTSC5lcXVh\nbHMoX2FjdGlvbikpCiAgICAgICAgICAgIHJlZnJlc2goY2xzKTsKICAgICAg\nICBlbHNlIGlmIChBQ1RJT05fQlVJTERfU0NIRU1BLmVxdWFscyhfYWN0aW9u\nKSkKICAgICAgICAgICAgYnVpbGRTY2hlbWEoY2xzKTsKICAgICAgICBlbHNl\nIGlmIChBQ1RJT05fRFJPUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAgICAg\nIGRyb3AoY2xzKTsKICAgICAgICBlbHNlIGlmIChBQ1RJT05fVkFMSURBVEUu\nZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICB2YWxpZGF0ZShjbHMpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBtYXBwaW5nIGZvciB0aGUg\nZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhZGQo\nQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0ZWd5\nSW5zdGFsbGVyKG5ldyBNYXBwaW5nU3RyYXRlZ3lJbnN0YWxsZXIocmVwb3Mp\nKTsKICAgICAgICBpZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVlKSAh\nPSBudWxsKSB7CiAgICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAgICAg\nICAgIF9mbHVzaFNjaGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4g\ndHlwZSwgb3IgbnVsbCBpZiB0aGUgdHlwZSBpcwogICAgICogcGVyc2lzdGVu\nY2UtYXdhcmUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENsYXNzTWFw\ncGluZyBnZXRNYXBwaW5nKE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zLCBDbGFz\ncyBjbHMsCiAgICAgICAgYm9vbGVhbiB2YWxpZGF0ZSkgewogICAgICAgIC8v\nIHRoaXMgd2lsbCBwYXJzZSBhbGwgcG9zc2libGUgbWV0YWRhdGEgcnNyY3Mg\nbG9va2luZyBmb3IgY2xzLCBzbwogICAgICAgIC8vIHdpbGwgZGV0ZWN0IGlm\nIHAtYXdhcmUKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IHJlcG9z\nLmdldE1hcHBpbmcoY2xzLCBudWxsLCBmYWxzZSk7CiAgICAgICAgaWYgKG1h\ncHBpbmcgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG1hcHBpbmc7CiAg\nICAgICAgaWYgKCF2YWxpZGF0ZSB8fCBjbHMuaXNJbnRlcmZhY2UoKSAKICAg\nICAgICAgICAgfHwgcmVwb3MuZ2V0UGVyc2lzdGVuY2VBd2FyZShjbHMpICE9\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWV0YSIsIGNs\ncykpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbWV0YWRhdGEg\nZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGFkZE1ldGEoQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIF9mbHVzaCA9IHRy\ndWU7CiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRSZXBv\nc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0UmVzb2x2ZShNT0RFX01BUFBJ\nTkcsIGZhbHNlKTsKICAgICAgICBNZXRhRGF0YUZhY3RvcnkgZmFjdG9yeSA9\nIHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAgIGZhY3Rvcnku\nZ2V0RGVmYXVsdHMoKS5zZXRJZ25vcmVOb25QZXJzaXN0ZW50KGZhbHNlKTsK\nICAgICAgICBmYWN0b3J5LnNldFN0b3JlTW9kZShNZXRhRGF0YUZhY3Rvcnku\nU1RPUkVfVkVSQk9TRSk7CgogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIHJlcG9zLmFkZE1ldGFEYXRhKGNscyk7CiAgICAgICAgRmllbGRNZXRhRGF0\nYVtdIGZtZHMgPSBtZXRhLmdldERlY2xhcmVkRmllbGRzKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGlmIChmbWRzW2ldLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9PSBK\nYXZhVHlwZXMuT0JKRUNUCiAgICAgICAgICAgICAgICAmJiBmbWRzW2ldLmdl\ndERlY2xhcmVkVHlwZSgpICE9IE9iamVjdC5jbGFzcykKICAgICAgICAgICAg\nICAgIGZtZHNbaV0uc2V0RGVjbGFyZWRUeXBlQ29kZShKYXZhVHlwZXMuUEMp\nOwogICAgICAgIH0KICAgICAgICBtZXRhLnNldFNvdXJjZShfZmlsZSwgbWV0\nYS5nZXRTb3VyY2VUeXBlKCkpOwogICAgICAgIG1ldGEuc2V0UmVzb2x2ZShN\nT0RFX01FVEEsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmVmcmVz\naCBvciBhZGQgdGhlIG1hcHBpbmcgZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlZnJlc2goQ2xhc3MgY2xzKSB7\nCiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3Np\ndG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0ZWd5SW5zdGFsbGVyKG5l\ndyBSZWZyZXNoU3RyYXRlZ3lJbnN0YWxsZXIocmVwb3MpKTsKICAgICAgICBp\nZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVlKSAhPSBudWxsKSB7CiAg\nICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAgICAgICAgIF9mbHVzaFNj\naGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nVmFsaWRhdGUgdGhlIG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3MgYW5k\nIGl0cyBmaWVsZHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0\nZShDbGFzcyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVw\nb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0U3RyYXRl\nZ3lJbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcihyZXBv\ncykpOwogICAgICAgIGlmIChnZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRydWUp\nICE9IG51bGwpCiAgICAgICAgICAgIF9mbHVzaFNjaGVtYSA9ICFTQ0hFTUFf\nQUNUSU9OX05PTkUuZXF1YWxzKF9zY2hlbWFBY3Rpb24pCiAgICAgICAgICAg\nICAgICAmJiAhU2NoZW1hVG9vbC5BQ1RJT05fQURELmVxdWFscyhfc2NoZW1h\nQWN0aW9uKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSB0aGUgc2No\nZW1hIHVzaW5nIHRoZSBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4gaW5zdGFuY2Uu\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWlsZFNjaGVtYShDbGFzcyBj\nbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRS\nZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0U3RyYXRlZ3lJbnN0YWxs\nZXIobmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcihyZXBvcykpOwogICAg\nICAgIGlmIChnZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRydWUpID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gc2V0IGFueSBsb2dp\nY2FsIHBrcyB0byBub24tbG9naWNhbCBzbyB0aGV5IGdldCBmbHVzaGVkCiAg\nICAgICAgX2ZsdXNoU2NoZW1hID0gdHJ1ZTsKICAgICAgICBTY2hlbWFbXSBz\nY2hlbWFzID0gX3NjaGVtYS5nZXRTY2hlbWFzKCk7CiAgICAgICAgVGFibGVb\nXSB0YWJsZXM7CiAgICAgICAgQ29sdW1uW10gY29sczsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgdGFibGVzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKysp\nIHsKICAgICAgICAgICAgICAgIGlmICh0YWJsZXNbal0uZ2V0UHJpbWFyeUtl\neSgpID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cgog\nICAgICAgICAgICAgICAgdGFibGVzW2pdLmdldFByaW1hcnlLZXkoKS5zZXRM\nb2dpY2FsKGZhbHNlKTsKICAgICAgICAgICAgICAgIGNvbHMgPSB0YWJsZXNb\nal0uZ2V0UHJpbWFyeUtleSgpLmdldENvbHVtbnMoKTsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGsgPSAwOyBrIDwgY29scy5sZW5ndGg7IGsrKykKICAg\nICAgICAgICAgICAgICAgICBjb2xzW2tdLnNldE5vdE51bGwodHJ1ZSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBE\ncm9wIG1hcHBpbmcgZm9yIGdpdmVuIGNsYXNzLgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgZHJvcChDbGFzcyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgaWYgKF9kcm9w\nQ2xzID09IG51bGwpCiAgICAgICAgICAgIF9kcm9wQ2xzID0gbmV3IEhhc2hT\nZXQoKTsKICAgICAgICBfZHJvcENscy5hZGQoY2xzKTsKICAgICAgICBpZiAo\nIVNjaGVtYVRvb2wuQUNUSU9OX0RST1AuZXF1YWxzKF9zY2hlbWFBY3Rpb24p\nKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0\nb3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIHJlcG9zLnNl\ndFN0cmF0ZWd5SW5zdGFsbGVyKG5ldyBSdW50aW1lU3RyYXRlZ3lJbnN0YWxs\nZXIocmVwb3MpKTsKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IG51\nbGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbWFwcGluZyA9IHJlcG9z\nLmdldE1hcHBpbmcoY2xzLCBudWxsLCBmYWxzZSk7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CgogICAgICAgIGlmIChtYXBw\naW5nICE9IG51bGwpIHsKICAgICAgICAgICAgX2ZsdXNoU2NoZW1hID0gdHJ1\nZTsKICAgICAgICAgICAgaWYgKF9kcm9wTWFwID09IG51bGwpCiAgICAgICAg\nICAgICAgICBfZHJvcE1hcCA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAg\nIF9kcm9wTWFwLmFkZChtYXBwaW5nKTsKICAgICAgICB9IGVsc2UKICAgICAg\nICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJuby1kcm9wLW1ldGEiLCBjbHMp\nKTsKICAgIH0KCiAgICAvLy8vLy8vLwogICAgLy8gTWFpbgogICAgLy8vLy8v\nLy8KCiAgICAvKioKICAgICAqIFVzYWdlOiBqYXZhIG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1Rvb2wgW29wdGlvbl0qIAogICAgICog\nWy1hY3Rpb24vLWEgJmx0O3JlZnJlc2ggfCBhZGQgfCBidWlsZFNjaGVtYSB8\nIGRyb3AgfCB2YWxpZGF0ZSB8IGltcG9ydCAKICAgICAqIHwgZXhwb3J0Jmd0\nO10gJmx0O2NsYXNzIG5hbWUgfCAuamF2YSBmaWxlIHwgLmNsYXNzIGZpbGUg\nfCAuamRvIGZpbGUmZ3Q7KgogICAgICogV2hlcmUgdGhlIGZvbGxvd2luZyBv\ncHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVsPgogICAgICogPGxp\nPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVzIGZpbGUgb3IgcmVz\nb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9yIHJlc291cmNlIG5h\nbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBjb250YWluaW5nCiAg\nICAgKiBpbmZvcm1hdGlvbiBhcyBvdXRsaW5lZCBpbiB7QGxpbmsgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgogICAgICogPGxpPjxp\nPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3BlcnR5IHZhbHVlJmd0\nOzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVzIG9mIHRoZSBPcGVu\nSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2FuIGJlIHNldCBieQog\nICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBseWluZyBhIHZhbHVl\nLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNlbnNlS2V5IGFkc2xm\namE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDxsaT48aT4tZmlsZS8t\nZiAmbHQ7c3Rkb3V0IHwgb3V0cHV0IGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9p\nPjogVXNlCiAgICAgKiB0aGlzIG9wdGlvbiB0byB3cml0ZSB0aGUgcGxhbm5l\nZCBtYXBwaW5ncyB0byBhbiBYTUwgZG9jdW1lbnQgcmF0aGVyCiAgICAgKiB0\naGFuIHN0b3JlIHRoZW0gaW4gdGhlIHJlcG9zaXRvcnkuIFRoaXMgb3B0aW9u\nIGFsc28gc3BlY2lmaWVzIHRoZQogICAgICogbWV0YWRhdGEgZmlsZSB0byB3\ncml0ZSB0byBpZiB1c2luZyB0aGUgPGNvZGU+YWRkPC9jb2RlPiBhY3Rpb24g\nd2l0aAogICAgICogdGhlIDxjb2RlPi1tZXRhIHRydWU8L2NvZGU+IGZsYWcs\nIG9yIHRoZSBmaWxlIHRvIGR1bXAgdG8gaWYgdXNpbmcKICAgICAqIHRoZSA8\nY29kZT5leHBvcnQ8L2NvZGU+IGFjdGlvbi48L2xpPgogICAgICogPGxpPjxp\nPi1zY2hlbWFBY3Rpb24vLXNhICZsdDtzY2hlbWEgYWN0aW9uIHwgbm9uZSZn\ndDs8L2k+OiBUaGUKICAgICAqIHtAbGluayBTY2hlbWFUb29sfSBkZWZpbmVz\nIHRoZSBhY3Rpb25zIHBvc3NpYmxlLiBUaGUgYWN0aW9ucyB3aWxsCiAgICAg\nKiBhcHBseSB0byBhbGwgc2NoZW1hIGNvbXBvbmVudHMgdXNlZCBieSB0aGUg\nbWFwcGluZ3MgaW52b2x2ZWQuCiAgICAgKiBVbmxlc3MgeW91IGFyZSBydW5u\naW5nIHRoZSBtYXBwaW5nIHRvb2wgb24gYWxsIG9mIHlvdXIgcGVyc2lzdGVu\ndAogICAgICogdHlwZXMgYXQgb25jZSwgYmUgY2FyZWZ1bCBydW5uaW5nIHNj\naGVtYSBhY3Rpb25zIHRoYXQgY2FuIGRyb3AgZGF0YS4KICAgICAqIEl0IGlz\nIHBvc3NpYmxlIHRvIGFjY2lkZW50YWxseSBkcm9wIHNjaGVtYSBjb21wb25l\nbnRzIHRoYXQgYXJlCiAgICAgKiB1c2VkIGJ5IGNsYXNzZXMgeW91IGFyZW4n\ndCBjdXJyZW50bHkgcnVubmluZyB0aGUgdG9vbCBvdmVyLiBUaGUKICAgICAq\nIGFjdGlvbiBkZWZhdWx0cyB0byA8Y29kZT5hZGQ8L2NvZGU+LjwvbGk+CiAg\nICAgKiA8bGk+PGk+LXNjaGVtYUZpbGUvLXNmICZsdDtzdGRvdXQgfCBvdXRw\ndXQgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+OiBVc2UKICAgICAqIHRoaXMg\nb3B0aW9uIHRvIHdyaXRlIHRoZSBwbGFubmVkIHNjaGVtYSB0byBhbiBYTUwg\nZG9jdW1lbnQgcmF0aGVyCiAgICAgKiB0aGFuIG1vZGlmeSB0aGUgZGF0YSBz\ndG9yZS48L2xpPgogICAgICogPGxpPjxpPi1zcWxGaWxlLy1zcWwgJmx0O3N0\nZG91dCB8IG91dHB1dCBmaWxlIG9yIHJlc291cmNlJmd0OzwvaT46IFVzZQog\nICAgICogdGhpcyBvcHRpb24gcmF0aGVyIHRvIHdyaXRlIHRoZSBwbGFubmVk\nIHNjaGVtYSBjaGFuZ2VzIGFzIGEgU1FMCiAgICAgKiBzY3JpcHQgcmF0aGVy\nIHRoYW4gbW9kaWZ5aW5nIHRoZSBkYXRhIHN0b3JlLjwvbGk+CiAgICAgKiA8\nbGk+PGk+LWRyb3BUYWJsZXMvLWR0ICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0\nOzwvaT46IENvcnJlc3BvbmRzIHRvIHRoZQogICAgICogc2FtZS1uYW1lZCBv\ncHRpb24gaW4gdGhlIHtAbGluayBTY2hlbWFUb29sfS48L2xpPgogICAgICog\nPGxpPjxpPi1kcm9wU2VxdWVuY2VzLy1kc3EgJmx0O3RydWUvdCB8IGZhbHNl\nL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMKICAgICAqIHRvIHRoZSBzYW1lLW5h\nbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9LjwvbGk+CiAg\nICAgKiA8bGk+PGk+LW9wZW5qcGFUYWJsZXMvLWt0ICZsdDt0cnVlL3QgfCBm\nYWxzZS9mJmd0OzwvaT46IENvcnJlc3BvbmRzIHRvCiAgICAgKiB0aGUgc2Ft\nZS1uYW1lZCBvcHRpb24gaW4gdGhlIHtAbGluayBTY2hlbWFUb29sfS48L2xp\nPgogICAgICogPGxpPjxpPi1pZ25vcmVFcnJvcnMvLWkgJmx0O3RydWUvdCB8\nIGZhbHNlL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8gdGhlCiAgICAgKiBz\nYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9Ljwv\nbGk+CiAgICAgKiA8bGk+PGk+LXJlYWRTY2hlbWEvLXJzICZsdDt0cnVlL3Qg\nfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0aGlzIHRvIHRydWUKICAgICAqIHRv\nIHJlYWQgdGhlIGVudGlyZSBleGlzdGluZyBzY2hlbWEgKGV2ZW4gd2hlbiBm\nYWxzZSB0aGUgcGFydHMgb2YKICAgICAqIHRoZSBzY2hlbWEgdXNlZCBieSBj\nbGFzc2VzIHRoZSB0b29sIGlzIHJ1biBvbiB3aWxsIHN0aWxsIGJlIHJlYWQp\nLgogICAgICogVHVybmluZyBvbiBzY2hlbWEgcmVhZGluZyBjYW4gZW5zdXJl\nIHRoYXQgbm8gbmFtaW5nIGNvbmZsaWN0cyB3aWxsCiAgICAgKiBvY2N1ciwg\nYnV0IGl0IGNhbiB0YWtlIGEgbG9uZyB0aW1lLjwvbGk+CiAgICAgKiA8bGk+\nPGk+LXByaW1hcnlLZXlzLy1wayAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8\nL2k+OiBXaGV0aGVyIHByaW1hcnkKICAgICAqIGtleXMgb24gZXhpc3Rpbmcg\ndGFibGVzIGFyZSBtYW5pcHVsYXRlZC4gRGVmYXVsdHMgdG8gZmFsc2UuPC9s\naT4KICAgICAqIDxsaT48aT4tZm9yZWlnbktleXMvLWZrICZsdDt0cnVlL3Qg\nfCBmYWxzZS9mJmd0OzwvaT46IFdoZXRoZXIgZm9yZWlnbgogICAgICoga2V5\ncyBvbiBleGlzdGluZyB0YWJsZXMgYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0\ncyB0byBmYWxzZS48L2xpPgogICAgICogPGxpPjxpPi1pbmRleGVzLy1peCAm\nbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBXaGV0aGVyIGluZGV4ZXMg\nb24KICAgICAqIGV4aXN0aW5nIHRhYmxlcyBhcmUgbWFuaXB1bGF0ZWQuIERl\nZmF1bHRzIHRvIGZhbHNlLjwvbGk+CiAgICAgKiA8bGk+PGk+LXNlcXVlbmNl\ncy8tc3EgJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogV2hldGhlciBz\nZXF1ZW5jZXMKICAgICAqIGFyZSBtYW5pcHVsYXRlZC4gRGVmYXVsdHMgdG8g\ndHJ1ZS48L2xpPgogICAgICogPGxpPjxpPi1zY2hlbWFzLy1zICZsdDtzY2hl\nbWEgYW5kIHRhYmxlIG5hbWVzJmd0OzwvaT46IEEgbGlzdCBvZiBzY2hlbWFz\nCiAgICAgKiBhbmQvb3IgdGFibGVzIHRvIHJlYWQuIENvcnJlc3BvbmRzIHRv\nIHRoZQogICAgICogc2FtZS1uYW1lZCBvcHRpb24gaW4gdGhlIHtAbGluayBT\nY2hlbWFHZW5lcmF0b3J9LiBUaGlzIG9wdGlvbgogICAgICogaXMgaWdub3Jl\nZCBpZiA8Y29kZT5yZWFkU2NoZW1hPC9jb2RlPiBpcyBmYWxzZS48L2xpPgog\nICAgICogPGxpPjxpPi1tZXRhLy1tICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0\nOzwvaT46IFdoZXRoZXIgdGhlIGdpdmVuIGFjdGlvbgogICAgICogYXBwbGll\ncyB0byBtZXRhZGF0YSBhcyB3ZWxsIGFzIG1hcHBpbmdzLjwvbGk+CiAgICAg\nKiA8L3VsPgogICAgICogIFRoZSB2YXJpb3VzIGFjdGlvbnMgYXJlIGFzIGZv\nbGxvd3MuCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+cmVmcmVzaDwvaT46\nIEJyaW5nIHRoZSBtYXBwaW5nIGluZm9ybWF0aW9uIHVwLXRvLWRhdGUKICAg\nICAqIHdpdGggdGhlIGNsYXNzIGRlZmluaXRpb25zLiBPcGVuSlBBIHdpbGwg\nYXR0ZW1wdCB0byB1c2UgYW55IHByb3ZpZGVkCiAgICAgKiBtYXBwaW5nIGlu\nZm9ybWF0aW9uLCBhbmQgZmlsbCBpbiBtaXNzaW5nIGluZm9ybWF0aW9uLiBJ\nZiB0aGUKICAgICAqIHByb3ZpZGVkIGluZm9ybWF0aW9uIGNvbmZsaWN0cyB3\naXRoIHRoZSBjbGFzcyBkZWZpbml0aW9uLCB0aGUKICAgICAqIGNvbmZsaWN0\naW5nIGluZm9ybWF0aW9uIHdpbGwgYmUgZGlzY2FyZGVkIGFuZCB0aGUgY2xh\nc3MvZmllbGQgd2lsbAogICAgICogYmUgcmUtbWFwcGVkIHRvIG5ldyBjb2x1\nbW5zL3RhYmxlcy4gVGhpcyBpcyB0aGUgZGVmYXVsdCBhY3Rpb24uPC9saT4K\nICAgICAqIDxsaT48aT5hZGQ8L2k+OiBJZiB1c2VkIHdpdGggdGhlIDxjb2Rl\nPi1tZXRhPC9jb2RlPiBvcHRpb24sIGFkZHMgbmV3CiAgICAgKiBkZWZhdWx0\nIG1ldGFkYXRhIGZvciB0aGUgZ2l2ZW4gY2xhc3MoZXMpLiBPdGhlcndpc2Us\nIGJyaW5ncyB0aGUKICAgICAqIG1hcHBpbmcgaW5mb3JtYXRpb24gdXAtdG8t\nZGF0ZSB3aXRoIHRoZSBjbGFzcwogICAgICogZGVmaW5pdGlvbnMuIE9wZW5K\nUEEgd2lsbCBhdHRlbXB0IHRvIHVzZSBhbnkgcHJvdmlkZWQgbWFwcGluZwog\nICAgICogaW5mb3JtYXRpb24sIGFuZCBmaWxsIGluIG1pc3NpbmcgaW5mb3Jt\nYXRpb24uIE9wZW5KUEEgd2lsbCBmYWlsIGlmCiAgICAgKiB0aGUgcHJvdmlk\nZWQgaW5mb3JtYXRpb24gY29uZmxpY3RzIHdpdGggdGhlIGNsYXNzIGRlZmlu\naXRpb24uPC9saT4KICAgICAqIDxsaT48aT5idWlsZFNjaGVtYTwvaT46IENy\nZWF0ZSB0aGUgc2NoZW1hIG1hdGNoaW5nIHRoZSBleGlzdGluZwogICAgICog\nbWFwcGluZ3MgZm9yIHRoZSBnaXZlbiBjbGFzcyhlcykuIEFueSBpbnZhbGlk\nIG1hcHBpbmcgaW5mb3JtYXRpb24KICAgICAqIHdpbGwgY2F1c2UgYW4gZXhj\nZXB0aW9uLjwvbGk+CiAgICAgKiA8bGk+PGk+ZHJvcDwvaT46IERlbGV0ZSBt\nYXBwaW5ncyBmb3IgdGhlIGdpdmVuIGNsYXNzZXMuIElmIHVzZWQgd2l0aAog\nICAgICogdGhlIDxjb2RlPi1tZXRhPC9jb2RlPiBvcHRpb24sIGFsc28gZGVs\nZXRlcyBtZXRhZGF0YS48L2xpPgogICAgICogPGxpPjxpPnZhbGlkYXRlPC9p\nPjogVmFsaWRhdGUgdGhlIGdpdmVuIG1hcHBpbmdzLiBUaGUgbWFwcGluZwog\nICAgICogcmVwb3NpdG9yeSBhbmQgc2NoZW1hIHdpbGwgbm90IGJlIGFmZmVj\ndGVkLjwvbGk+CiAgICAgKiA8bGk+PGk+aW1wb3J0PC9pPjogSW1wb3J0IG1h\ncHBpbmdzIGZyb20gYW4gWE1MIGRvY3VtZW50IGFuZCBzdG9yZQogICAgICog\ndGhlbSBhcyB0aGUgY3VycmVudCBzeXN0ZW0gbWFwcGluZ3MuPC9saT4KICAg\nICAqIDxsaT48aT5leHBvcnQ8L2k+OiBEdW1wIHRoZSBjdXJyZW50IG1hcHBp\nbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3NlcyB0bwogICAgICogYW4gWE1MIGRv\nY3VtZW50IHNwZWNpZmllZCBieSB0aGUgPGNvZGU+ZmlsZTwvY29kZT4gb3B0\naW9uLjwvbGk+CiAgICAgKiBJZiB1c2VkIHdpdGggdGhlIDxjb2RlPi1tZXRh\nPC9jb2RlPiBvcHRpb24sIHRoZSBtZXRhZGF0YSB3aWxsIGJlCiAgICAgKiBp\nbmNsdWRlZCBpbiB0aGUgZXhwb3J0LgogICAgICogPC91bD4KICAgICAqICBF\nYWNoIGNsYXNzIHN1cHBsaWVkIGFzIGFuIGFyZ3VtZW50IG11c3QgaGF2ZSB2\nYWxpZCBtZXRhZGF0YS4gSWYKICAgICAqIG5vIGNsYXNzIGFyZ3VtZW50cyBh\ncmUgZ2l2ZW4sIHRoZSB0b29sIHJ1bnMgb24gYWxsIG1ldGFkYXRhIGZpbGVz\nIGluCiAgICAgKiB0aGUgQ0xBU1NQQVRILgogICAgICogIEV4YW1wbGVzOgog\nICAgICogPHVsPgogICAgICogPGxpPlJlZnJlc2ggdGhlIG1hcHBpbmdzIGZv\nciBnaXZlbiBwYWNrYWdlLCB3aXRob3V0IGRyb3BwaW5nIGFueQogICAgICog\nc2NoZW1hIGNvbXBvbmVudHM6PGJyIC8+CiAgICAgKiA8Y29kZT5qYXZhIG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1Rvb2wgbXlwYWNr\nYWdlLmpkbzwvY29kZT48L2xpPgogICAgICogPGxpPlJlZnJlc2ggdGhlIG1h\ncHBpbmdzIGZvciBhbGwgcGVyc2lzdGVudCBjbGFzc2VzIGluIHRoZSBjbGFz\nc3BhdGgsCiAgICAgKiBkcm9wcGluZyBhbnkgdW51c2VkIGNvbHVtbnMgYW5k\nIGV2ZW4gdGFibGVzOjxiciAvPgogICAgICogPGNvZGU+amF2YSBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdUb29sIC1zYSByZWZyZXNo\nCiAgICAgKiAtZHQgdHJ1ZTwvY29kZT48L2xpPgogICAgICogPGxpPk1ha2Ug\nc3VyZSB0aGUgbWFwcGluZ3MgeW91J3ZlIGNyZWF0ZWQgYnkgaGFuZCBtYXRj\naCB0aGUgb2JqZWN0CiAgICAgKiBtb2RlbCBhbmQgc2NoZW1hOjxiciAvPgog\nICAgICogPGNvZGU+amF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuamJkYy5tZXRh\nLk1hcHBpbmdUb29sCiAgICAgKiAtYSB2YWxpZGF0ZSBQZXJzb24uamF2YTwv\nY29kZT48L2xpPgogICAgICogPGxpPlJlbW92ZSB0aGUgcmVjb3JkZWQgbWFw\ncGluZyBmb3IgYSBnaXZlbiBjbGFzczo8YnIgLz4KICAgICAqIDxjb2RlPmph\ndmEgb3JnLmFwYWNoZS5vcGVuanBhLmpiZGMubWV0YS5NYXBwaW5nVG9vbAog\nICAgICogLWEgZHJvcCBQZXJzb24uamF2YTwvY29kZT48L2xpPgogICAgICog\nPGxpPlJlY29yZCB0aGUgY3VycmVudCBtYXBwaW5ncyBpbiBhbiBYTUwgZmls\nZTo8YnIgLz4KICAgICAqIDxjb2RlPmphdmEgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5NYXBwaW5nVG9vbAogICAgICogLWYgbXlwYWNrYWdlLm9y\nbSAtYSBleHBvcnQgbXlwYWNrYWdlLmpkbzwvY29kZT48L2xpPgogICAgICog\nPC91bD4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3Ry\naW5nW10gYXJncykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgT3B0aW9ucyBvcHRzID0gbmV3IE9wdGlvbnMo\nKTsKICAgICAgICBhcmdzID0gb3B0cy5zZXRGcm9tQ21kTGluZShhcmdzKTsK\nICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IEpEQkNDb25m\naWd1cmF0aW9uSW1wbCgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlm\nICghcnVuKGNvbmYsIGFyZ3MsIG9wdHMpKQogICAgICAgICAgICAgICAgU3lz\ndGVtLmVyci5wcmludGxuKF9sb2MuZ2V0KCJ0b29sLXVzYWdlIikpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSdW4gdGhlIHRvb2wuIFJl\ndHVybnMgZmFsc2UgaWYgaW52YWxpZCBvcHRpb25zIGFyZSBnaXZlbi4KICAg\nICAqCiAgICAgKiBAc2VlICNtYWluCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5n\nW10gYXJncywKICAgICAgICBPcHRpb25zIG9wdHMpCiAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChvcHRz\nLmNvbnRhaW5zS2V5KCJoZWxwIikgfHwgb3B0cy5jb250YWluc0tleSgiLWhl\nbHAiKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyBm\nbGFncwogICAgICAgIEZsYWdzIGZsYWdzID0gbmV3IEZsYWdzKCk7CiAgICAg\nICAgZmxhZ3MuYWN0aW9uID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgiYWN0aW9u\nIiwgImEiLCBmbGFncy5hY3Rpb24pOwogICAgICAgIGZsYWdzLnNjaGVtYUFj\ndGlvbiA9IG9wdHMucmVtb3ZlUHJvcGVydHkoInNjaGVtYUFjdGlvbiIsICJz\nYSIsCiAgICAgICAgICAgIGZsYWdzLnNjaGVtYUFjdGlvbik7CiAgICAgICAg\nZmxhZ3MuZHJvcFRhYmxlcyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5\nCiAgICAgICAgICAgICgiZHJvcFRhYmxlcyIsICJkdCIsIGZsYWdzLmRyb3BU\nYWJsZXMpOwogICAgICAgIGZsYWdzLm9wZW5qcGFUYWJsZXMgPSBvcHRzLnJl\nbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoIm9wZW5qcGFUYWJs\nZXMiLCAib3QiLCBmbGFncy5vcGVuanBhVGFibGVzKTsKICAgICAgICBmbGFn\ncy5kcm9wU2VxdWVuY2VzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkK\nICAgICAgICAgICAgKCJkcm9wU2VxdWVuY2VzIiwgImRzcSIsIGZsYWdzLmRy\nb3BTZXF1ZW5jZXMpOwogICAgICAgIGZsYWdzLnJlYWRTY2hlbWEgPSBvcHRz\nLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoInJlYWRTY2hl\nbWEiLCAicnMiLCBmbGFncy5yZWFkU2NoZW1hKTsKICAgICAgICBmbGFncy5w\ncmltYXJ5S2V5cyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAg\nICAgICAgICgicHJpbWFyeUtleXMiLCAicGsiLCBmbGFncy5wcmltYXJ5S2V5\ncyk7CiAgICAgICAgZmxhZ3MuaW5kZXhlcyA9IG9wdHMucmVtb3ZlQm9vbGVh\nblByb3BlcnR5KCJpbmRleGVzIiwgIml4IiwKICAgICAgICAgICAgZmxhZ3Mu\naW5kZXhlcyk7CiAgICAgICAgZmxhZ3MuZm9yZWlnbktleXMgPSBvcHRzLnJl\nbW92ZUJvb2xlYW5Qcm9wZXJ0eSgiZm9yZWlnbktleXMiLCAiZmsiLAogICAg\nICAgICAgICBmbGFncy5mb3JlaWduS2V5cyk7CiAgICAgICAgZmxhZ3Muc2Vx\ndWVuY2VzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkoInNlcXVlbmNl\ncyIsICJzcSIsCiAgICAgICAgICAgIGZsYWdzLnNlcXVlbmNlcyk7CiAgICAg\nICAgZmxhZ3MuaWdub3JlRXJyb3JzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJv\ncGVydHkKICAgICAgICAgICAgKCJpZ25vcmVFcnJvcnMiLCAiaSIsIGZsYWdz\nLmlnbm9yZUVycm9ycyk7CiAgICAgICAgZmxhZ3MubWV0YSA9IG9wdHMucmVt\nb3ZlQm9vbGVhblByb3BlcnR5KCJtZXRhIiwgIm0iLCBmbGFncy5tZXRhKTsK\nICAgICAgICBTdHJpbmcgZmlsZU5hbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5\nKCJmaWxlIiwgImYiLCBudWxsKTsKICAgICAgICBTdHJpbmcgc2NoZW1hRmls\nZU5hbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJzY2hlbWFGaWxlIiwgInNm\nIiwgbnVsbCk7CiAgICAgICAgU3RyaW5nIHNxbEZpbGVOYW1lID0gb3B0cy5y\nZW1vdmVQcm9wZXJ0eSgic3FsRmlsZSIsICJzcWwiLCBudWxsKTsKICAgICAg\nICBTdHJpbmcgc2NoZW1hcyA9IG9wdHMucmVtb3ZlUHJvcGVydHkoInMiKTsK\nICAgICAgICBpZiAoc2NoZW1hcyAhPSBudWxsKQogICAgICAgICAgICBvcHRz\nLnNldFByb3BlcnR5KCJzY2hlbWFzIiwgc2NoZW1hcyk7CgogICAgICAgIENv\nbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihjb25mLCBvcHRz\nKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBjb25mLmdldENsYXNz\nUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRDbGFzc0xvYWRl\ncihNYXBwaW5nVG9vbC5jbGFzcywgbnVsbCk7CiAgICAgICAgaWYgKGZsYWdz\nLm1ldGEgJiYgQUNUSU9OX0FERC5lcXVhbHMoZmxhZ3MuYWN0aW9uKSkKICAg\nICAgICAgICAgZmxhZ3MubWV0YURhdGFGaWxlID0gRmlsZXMuZ2V0RmlsZShm\naWxlTmFtZSwgbG9hZGVyKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZs\nYWdzLm1hcHBpbmdXcml0ZXIgPSBGaWxlcy5nZXRXcml0ZXIoZmlsZU5hbWUs\nIGxvYWRlcik7CiAgICAgICAgZmxhZ3Muc2NoZW1hV3JpdGVyID0gRmlsZXMu\nZ2V0V3JpdGVyKHNjaGVtYUZpbGVOYW1lLCBsb2FkZXIpOwogICAgICAgIGZs\nYWdzLnNxbFdyaXRlciA9IEZpbGVzLmdldFdyaXRlcihzcWxGaWxlTmFtZSwg\nbG9hZGVyKTsKCiAgICAgICAgcmV0dXJuIHJ1bihjb25mLCBhcmdzLCBmbGFn\ncywgbG9hZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9v\nbC4gUmV0dXJuIGZhbHNlIGlmIGFuIGludmFsaWQgb3B0aW9uIHdhcyBnaXZl\nbi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihKREJD\nQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIEZs\nYWdzIGZsYWdzLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIGRlZmF1\nbHQgYWN0aW9uIGJhc2VkIG9uIHdoZXRoZXIgdGhlIG1hcHBpbmcgZGVmYXVs\ndHMgZmlsbHMgaW4KICAgICAgICAvLyBtaXNzaW5nIGluZm8KICAgICAgICBp\nZiAoZmxhZ3MuYWN0aW9uID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKGNv\nbmYuZ2V0TWFwcGluZ0RlZmF1bHRzSW5zdGFuY2UoKS5kZWZhdWx0TWlzc2lu\nZ0luZm8oKSkKICAgICAgICAgICAgICAgIGZsYWdzLmFjdGlvbiA9IEFDVElP\nTl9CVUlMRF9TQ0hFTUE7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgIGZsYWdzLmFjdGlvbiA9IEFDVElPTl9SRUZSRVNIOwogICAgICAgIH0K\nCiAgICAgICAgLy8gY29sbGVjdCB0aGUgY2xhc3NlcyB0byBhY3Qgb24KICAg\nICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRp\nb24uTE9HX1RPT0wpOwogICAgICAgIENvbGxlY3Rpb24gY2xhc3NlcyA9IG51\nbGw7CiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHsKICAgICAgICAg\nICAgaWYgKEFDVElPTl9JTVBPUlQuZXF1YWxzKGZsYWdzLmFjdGlvbikpCiAg\nICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIGxvZy5p\nbmZvKF9sb2MuZ2V0KCJydW5uaW5nLWFsbC1jbGFzc2VzIikpOwogICAgICAg\nICAgICBjbGFzc2VzID0gY29uZi5nZXRNYXBwaW5nUmVwb3NpdG9yeUluc3Rh\nbmNlKCkuCiAgICAgICAgICAgICAgICBsb2FkUGVyc2lzdGVudFR5cGVzKHRy\ndWUsIGxvYWRlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2xh\nc3NlcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgIENsYXNzQXJnUGFy\nc2VyIGNsYXNzUGFyc2VyID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJ\nbnN0YW5jZSgpLgogICAgICAgICAgICAgICAgZ2V0TWV0YURhdGFGYWN0b3J5\nKCkubmV3Q2xhc3NBcmdQYXJzZXIoKTsKICAgICAgICAgICAgY2xhc3NQYXJz\nZXIuc2V0Q2xhc3NMb2FkZXIobG9hZGVyKTsKICAgICAgICAgICAgQ2xhc3Nb\nXSBwYXJzZWQ7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBhcmdzICE9\nIG51bGwgJiYgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgIHBhcnNlZCA9IGNsYXNzUGFyc2VyLnBhcnNlVHlwZXMoYXJnc1tpXSk7\nCiAgICAgICAgICAgICAgICBjbGFzc2VzLmFkZEFsbChBcnJheXMuYXNMaXN0\nKHBhcnNlZCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBD\nbGFzc1tdIGFjdCA9IChDbGFzc1tdKSBjbGFzc2VzLnRvQXJyYXkobmV3IENs\nYXNzW2NsYXNzZXMuc2l6ZSgpXSk7CiAgICAgICAgaWYgKEFDVElPTl9FWFBP\nUlQuZXF1YWxzKGZsYWdzLmFjdGlvbikpIHsKICAgICAgICAgICAgLy8gcnVu\nIGV4cG9ydHMgdW50aWwgdGhlIGZpcnN0IGV4cG9ydCBzdWNjZWVkcwogICAg\nICAgICAgICBJbXBvcnRFeHBvcnRbXSBpbnN0YW5jZXMgPSBuZXdJbXBvcnRF\neHBvcnRzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaW5z\ndGFuY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoaW5z\ndGFuY2VzW2ldLmV4cG9ydE1hcHBpbmdzKGNvbmYsIGFjdCwgZmxhZ3MubWV0\nYSwgbG9nLAogICAgICAgICAgICAgICAgICAgIGZsYWdzLm1hcHBpbmdXcml0\nZXIpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAg\nICAgICAgaWYgKEFDVElPTl9JTVBPUlQuZXF1YWxzKGZsYWdzLmFjdGlvbikp\nIHsKICAgICAgICAgICAgLy8gcnVuIGV4cG9ydHMgdW50aWwgdGhlIGZpcnN0\nIGV4cG9ydCBzdWNjZWVkcwogICAgICAgICAgICBJbXBvcnRFeHBvcnRbXSBp\nbnN0YW5jZXMgPSBuZXdJbXBvcnRFeHBvcnRzKCk7CiAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgaW5zdGFuY2VzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgICAgICBpZiAoaW5zdGFuY2VzW2ldLmltcG9ydE1hcHBpbmdz\nKGNvbmYsIGFjdCwgYXJncywgZmxhZ3MubWV0YSwKICAgICAgICAgICAgICAg\nICAgICBsb2csIGxvYWRlcikpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIH0KCiAgICAgICAgTWFwcGluZ1Rvb2wgdG9vbDsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB0b29sID0gbmV3IE1hcHBpbmdUb29sKGNv\nbmYsIGZsYWdzLmFjdGlvbiwgZmxhZ3MubWV0YSk7CiAgICAgICAgfSBjYXRj\naCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlhZSkgewogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvLyBzZXR1cCB0\naGUgdG9vbAogICAgICAgIHRvb2wuc2V0SWdub3JlRXJyb3JzKGZsYWdzLmln\nbm9yZUVycm9ycyk7CiAgICAgICAgdG9vbC5zZXRNZXRhRGF0YUZpbGUoZmxh\nZ3MubWV0YURhdGFGaWxlKTsKICAgICAgICB0b29sLnNldE1hcHBpbmdXcml0\nZXIoZmxhZ3MubWFwcGluZ1dyaXRlcik7CiAgICAgICAgdG9vbC5zZXRTY2hl\nbWFBY3Rpb24oZmxhZ3Muc2NoZW1hQWN0aW9uKTsKICAgICAgICB0b29sLnNl\ndFNjaGVtYVdyaXRlcihmbGFncy5zY2hlbWFXcml0ZXIpOwogICAgICAgIHRv\nb2wuc2V0UmVhZFNjaGVtYShmbGFncy5yZWFkU2NoZW1hCiAgICAgICAgICAg\nICYmICFBQ1RJT05fVkFMSURBVEUuZXF1YWxzKGZsYWdzLmFjdGlvbikpOwog\nICAgICAgIHRvb2wuc2V0UHJpbWFyeUtleXMoZmxhZ3MucHJpbWFyeUtleXMp\nOwogICAgICAgIHRvb2wuc2V0Rm9yZWlnbktleXMoZmxhZ3MuZm9yZWlnbktl\neXMpOwogICAgICAgIHRvb2wuc2V0SW5kZXhlcyhmbGFncy5pbmRleGVzKTsK\nICAgICAgICB0b29sLnNldFNlcXVlbmNlcyhmbGFncy5zZXF1ZW5jZXMgfHwg\nZmxhZ3MuZHJvcFNlcXVlbmNlcyk7CgogICAgICAgIC8vIG1ha2Ugc3VyZSB0\nbyBkbyB0aGlzIGFmdGVyIG90aGVyIHNldHRpbmdzIHNvIHRoYXQgb3RoZXIg\nc2V0dGluZ3MKICAgICAgICAvLyBhcmUgcGFzc2VkIG9uIHRvIHNjaGVtYSB0\nb29sCiAgICAgICAgdG9vbC5nZXRTY2hlbWFUb29sKCkuc2V0RHJvcFRhYmxl\ncyhmbGFncy5kcm9wVGFibGVzKTsKICAgICAgICB0b29sLmdldFNjaGVtYVRv\nb2woKS5zZXREcm9wU2VxdWVuY2VzKGZsYWdzLmRyb3BTZXF1ZW5jZXMpOwog\nICAgICAgIHRvb2wuZ2V0U2NoZW1hVG9vbCgpLnNldFdyaXRlcihmbGFncy5z\ncWxXcml0ZXIpOwogICAgICAgIHRvb2wuZ2V0U2NoZW1hVG9vbCgpLnNldE9w\nZW5KUEFUYWJsZXMoZmxhZ3Mub3BlbmpwYVRhYmxlcyk7CgogICAgICAgIC8v\nIGFuZCBydW4gdGhlIGFjdGlvbgogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgYWN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGxvZy5pbmZvKF9s\nb2MuZ2V0KCJ0b29sLXJ1bm5pbmciLCBhY3RbaV0sIGZsYWdzLmFjdGlvbikp\nOwogICAgICAgICAgICBpZiAoaSA9PSAwICYmIGZsYWdzLnJlYWRTY2hlbWEp\nCiAgICAgICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgidG9vbC10aW1l\nIikpOwogICAgICAgICAgICB0b29sLnJ1bihhY3RbaV0pOwogICAgICAgIH0K\nICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgidG9vbC1yZWNvcmQiKSk7CiAg\nICAgICAgdG9vbC5yZWNvcmQoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbiB7QGxpbmsgSW1wb3J0RXhw\nb3J0fSBpbnN0YW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgSW1w\nb3J0RXhwb3J0W10gbmV3SW1wb3J0RXhwb3J0cygpIHsKICAgICAgICB0cnkg\newogICAgICAgICAgICBDbGFzc1tdIHR5cGVzID0gU2VydmljZXMuZ2V0SW1w\nbGVtZW50b3JDbGFzc2VzKEltcG9ydEV4cG9ydC5jbGFzcyk7CiAgICAgICAg\nICAgIEltcG9ydEV4cG9ydFtdIGluc3RhbmNlcyA9IG5ldyBJbXBvcnRFeHBv\ncnRbdHlwZXMubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCB0eXBlcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGluc3Rh\nbmNlc1tpXSA9IChJbXBvcnRFeHBvcnQpIHR5cGVzW2ldLm5ld0luc3RhbmNl\nKCk7CiAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZXM7CiAgICAgICAgfSBj\nYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElu\ndGVybmFsRXhjZXB0aW9uKF9sb2MuZ2V0KCJpbXBvcnRleHBvcnQtaW5zdGFu\ndGlhdGUiKSx0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBS\ndW4gZmxhZ3MuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRmxh\nZ3MgewoKICAgICAgICBwdWJsaWMgU3RyaW5nIGFjdGlvbiA9IG51bGw7CiAg\nICAgICAgcHVibGljIGJvb2xlYW4gbWV0YSA9IGZhbHNlOwogICAgICAgIHB1\nYmxpYyBTdHJpbmcgc2NoZW1hQWN0aW9uID0gU2NoZW1hVG9vbC5BQ1RJT05f\nQUREOwogICAgICAgIHB1YmxpYyBGaWxlIG1ldGFEYXRhRmlsZSA9IG51bGw7\nCiAgICAgICAgcHVibGljIFdyaXRlciBtYXBwaW5nV3JpdGVyID0gbnVsbDsK\nICAgICAgICBwdWJsaWMgV3JpdGVyIHNjaGVtYVdyaXRlciA9IG51bGw7CiAg\nICAgICAgcHVibGljIFdyaXRlciBzcWxXcml0ZXIgPSBudWxsOwogICAgICAg\nIHB1YmxpYyBib29sZWFuIGlnbm9yZUVycm9ycyA9IGZhbHNlOwogICAgICAg\nIHB1YmxpYyBib29sZWFuIHJlYWRTY2hlbWEgPSBmYWxzZTsKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBkcm9wVGFibGVzID0gZmFsc2U7CiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gb3BlbmpwYVRhYmxlcyA9IGZhbHNlOwogICAgICAgIHB1\nYmxpYyBib29sZWFuIGRyb3BTZXF1ZW5jZXMgPSBmYWxzZTsKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBzZXF1ZW5jZXMgPSB0cnVlOwogICAgICAgIHB1Ymxp\nYyBib29sZWFuIHByaW1hcnlLZXlzID0gZmFsc2U7CiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gZm9yZWlnbktleXMgPSBmYWxzZTsKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBpbmRleGVzID0gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBIZWxwZXIgdXNlZCB0byBpbXBvcnQgYW5kIGV4cG9ydCBtYXBwaW5nIGRh\ndGEuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIEltcG9y\ndEV4cG9ydCB7CgogICAgICAgIC8qKgogICAgICAgICAqIEltcG9ydCBtYXBw\naW5ncyBmb3IgdGhlIGdpdmVuIGNsYXNzZXMgYmFzZWQgb24gdGhlIGdpdmVu\nIGFyZ3VtZW50cy4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBpbXBvcnRNYXBwaW5ncyhKREJDQ29uZmlndXJhdGlvbiBjb25mLCBDbGFz\nc1tdIGFjdCwKICAgICAgICAgICAgU3RyaW5nW10gYXJncywgYm9vbGVhbiBt\nZXRhLCBMb2cgbG9nLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgICAg\nIHRocm93cyBJT0V4Y2VwdGlvbjsKCiAgICAgICAgLyoqCiAgICAgICAgICog\nRXhwb3J0IG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3NlcyBiYXNlZCBv\nbiB0aGUgZ2l2ZW4gYXJndW1lbnRzLgogICAgICAgICAqLwogICAgICAgIHB1\nYmxpYyBib29sZWFuIGV4cG9ydE1hcHBpbmdzKEpEQkNDb25maWd1cmF0aW9u\nIGNvbmYsIENsYXNzW10gYWN0LAogICAgICAgICAgICBib29sZWFuIG1ldGEs\nIExvZyBsb2csIFdyaXRlciB3cml0ZXIpCiAgICAgICAgICAgIHRocm93cyBJ\nT0V4Y2VwdGlvbjsKICAgIH0KfQo=\n","encoding":"base64"}

