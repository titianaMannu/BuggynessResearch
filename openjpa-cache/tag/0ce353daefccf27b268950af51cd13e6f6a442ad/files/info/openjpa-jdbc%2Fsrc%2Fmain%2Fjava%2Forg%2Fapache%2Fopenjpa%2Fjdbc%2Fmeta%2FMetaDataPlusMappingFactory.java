{"sha":"3d1e589e61d01913d035f598499deee4578a8ed6","node_id":"MDQ6QmxvYjIwNjM2NDozZDFlNTg5ZTYxZDAxOTEzZDAzNWY1OTg0OTlkZWVlNDU3OGE4ZWQ2","size":4293,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3d1e589e61d01913d035f598499deee4578a8ed6","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuTWFw\nOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhRmFjdG9yeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3NpdG9y\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlF1ZXJ5TWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5TZXF1ZW5jZU1l\ndGFEYXRhOwoKLyoqCiAqIENvbWJpbmVzIHR3byBpbnRlcm5hbCB7QGxpbmsg\nTWV0YURhdGFGYWN0b3J5fSBpbnN0YW5jZXMgLS0gb25lIGZvcgogKiBtZXRh\nZGF0YSwgb25lIGZvciBtYXBwaW5ncyAtLSBpbnRvIGEgc2luZ2xlIHtAbGlu\nayBNZXRhRGF0YUZhY3Rvcnl9IGZhY2FkZS4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIE1ldGFEYXRh\nUGx1c01hcHBpbmdGYWN0b3J5CiAgICBleHRlbmRzIERlbGVnYXRpbmdNZXRh\nRGF0YUZhY3RvcnkgewoKICAgIHByaXZhdGUgZmluYWwgTWV0YURhdGFGYWN0\nb3J5IF9tYXA7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5\nIGRlbGVnYXRlcy4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRhUGx1c01h\ncHBpbmdGYWN0b3J5KE1ldGFEYXRhRmFjdG9yeSBtZXRhLAogICAgICAgIE1l\ndGFEYXRhRmFjdG9yeSBtYXApIHsKICAgICAgICBzdXBlcihtZXRhKTsKICAg\nICAgICBfbWFwID0gbWFwOwoKICAgICAgICBtZXRhLnNldFN0cmljdCh0cnVl\nKTsKICAgICAgICBtYXAuc2V0U3RyaWN0KHRydWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogTWFwcGluZyBmYWN0b3J5IGRlbGVnYXRlLgogICAgICovCiAg\nICBwdWJsaWMgTWV0YURhdGFGYWN0b3J5IGdldE1hcHBpbmdEZWxlZ2F0ZSgp\nIHsKICAgICAgICByZXR1cm4gX21hcDsKICAgIH0KCiAgICAvKioKICAgICAq\nIElubmVybW9zdCBtYXBwaW5nIGRlbGVnYXRlLgogICAgICovCiAgICBwdWJs\naWMgTWV0YURhdGFGYWN0b3J5IGdldElubmVybW9zdE1hcHBpbmdEZWxlZ2F0\nZSgpIHsKICAgICAgICBpZiAoX21hcCBpbnN0YW5jZW9mIERlbGVnYXRpbmdN\nZXRhRGF0YUZhY3RvcnkpCiAgICAgICAgICAgIHJldHVybiAoKERlbGVnYXRp\nbmdNZXRhRGF0YUZhY3RvcnkpIF9tYXApLmdldElubmVybW9zdERlbGVnYXRl\nKCk7CiAgICAgICAgcmV0dXJuIF9tYXA7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0UmVwb3NpdG9yeShNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MpIHsK\nICAgICAgICBzdXBlci5zZXRSZXBvc2l0b3J5KHJlcG9zKTsKICAgICAgICBf\nbWFwLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldFN0b3JlRGlyZWN0b3J5KEZpbGUgZGlyKSB7CiAgICAgICAgc3Vw\nZXIuc2V0U3RvcmVEaXJlY3RvcnkoZGlyKTsKICAgICAgICBfbWFwLnNldFN0\nb3JlRGlyZWN0b3J5KGRpcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nU3RvcmVNb2RlKGludCBzdG9yZSkgewogICAgICAgIHN1cGVyLnNldFN0b3Jl\nTW9kZShzdG9yZSk7CiAgICAgICAgX21hcC5zZXRTdG9yZU1vZGUoc3RvcmUp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFN0cmljdChib29sZWFuIHN0\ncmljdCkgewogICAgICAgIC8vIGFsd2F5cyBpbiBzdHJpY3QgbW9kZQogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGxvYWQoQ2xhc3MgY2xzLCBpbnQgbW9kZSwg\nQ2xhc3NMb2FkZXIgZW52TG9hZGVyKSB7CiAgICAgICAgaWYgKChtb2RlICYg\nfk1PREVfTUFQUElORykgIT0gTU9ERV9OT05FKQogICAgICAgICAgICBzdXBl\nci5sb2FkKGNscywgbW9kZSAmIH5NT0RFX01BUFBJTkcsIGVudkxvYWRlcik7\nCiAgICAgICAgaWYgKGNscyAhPSBudWxsICYmIChtb2RlICYgTU9ERV9NQVBQ\nSU5HKSAhPSAwKQogICAgICAgICAgICBfbWFwLmxvYWQoY2xzLCBtb2RlICYg\nfk1PREVfTUVUQSwgZW52TG9hZGVyKTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBzdG9yZShDbGFzc01ldGFEYXRhW10gbWV0YXMsIFF1ZXJ5TWV0YURh\ndGFbXSBxdWVyaWVzLAogICAgICAgIFNlcXVlbmNlTWV0YURhdGFbXSBzZXFz\nLCBpbnQgbW9kZSwgTWFwIG91dHB1dCkgewogICAgICAgIGJvb2xlYW4gc3Rv\ncmUgPSB0cnVlOwogICAgICAgIGlmICgobW9kZSAmIH5NT0RFX01BUFBJTkcp\nICE9IE1PREVfTk9ORSkKICAgICAgICAgICAgc3RvcmUgJj0gc3VwZXIuc3Rv\ncmUobWV0YXMsIHF1ZXJpZXMsIHNlcXMsIG1vZGUgJiB+TU9ERV9NQVBQSU5H\nLAogICAgICAgICAgICAgICAgb3V0cHV0KTsKICAgICAgICBpZiAoKG1vZGUg\nJiBNT0RFX01BUFBJTkcpICE9IDApCiAgICAgICAgICAgIHN0b3JlICY9IF9t\nYXAuc3RvcmUobWV0YXMsIHF1ZXJpZXMsIHNlcXMsIG1vZGUgJiB+TU9ERV9N\nRVRBLAogICAgICAgICAgICAgICAgb3V0cHV0KTsKICAgICAgICByZXR1cm4g\nc3RvcmU7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZHJvcChDbGFzc1td\nIGNscywgaW50IG1vZGUsIENsYXNzTG9hZGVyIGVudkxvYWRlcikgewogICAg\nICAgIGJvb2xlYW4gZHJvcCA9IHRydWU7CiAgICAgICAgaWYgKChtb2RlICYg\nfk1PREVfTUFQUElORykgIT0gTU9ERV9OT05FKQogICAgICAgICAgICBkcm9w\nICY9IHN1cGVyLmRyb3AoY2xzLCBtb2RlICYgfk1PREVfTUFQUElORywgZW52\nTG9hZGVyKTsKICAgICAgICBpZiAoKG1vZGUgJiBNT0RFX01BUFBJTkcpICE9\nIDApCiAgICAgICAgICAgIGRyb3AgJj0gX21hcC5kcm9wKGNscywgbW9kZSAm\nIH5NT0RFX01FVEEsIGVudkxvYWRlcik7CiAgICAgICAgcmV0dXJuIGRyb3A7\nCiAgICB9CgogICAgcHVibGljIFNldCBnZXRQZXJzaXN0ZW50VHlwZU5hbWVz\nKGJvb2xlYW4gY2xhc3NwYXRoLAogICAgICAgIENsYXNzTG9hZGVyIGVudkxv\nYWRlcikgewogICAgICAgIFNldCBuYW1lcyA9IHN1cGVyLmdldFBlcnNpc3Rl\nbnRUeXBlTmFtZXMoY2xhc3NwYXRoLCBlbnZMb2FkZXIpOwogICAgICAgIGlm\nIChuYW1lcyAhPSBudWxsICYmICFuYW1lcy5pc0VtcHR5KCkpCiAgICAgICAg\nICAgIHJldHVybiBuYW1lczsKICAgICAgICByZXR1cm4gX21hcC5nZXRQZXJz\naXN0ZW50VHlwZU5hbWVzKGNsYXNzcGF0aCwgZW52TG9hZGVyKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBzdXBlci5jbGVh\ncigpOwogICAgICAgIF9tYXAuY2xlYXIoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBhZGRDbGFzc0V4dGVuc2lvbktleXMoQ29sbGVjdGlvbiBleHRzKSB7\nCiAgICAgICAgc3VwZXIuYWRkQ2xhc3NFeHRlbnNpb25LZXlzKGV4dHMpOwog\nICAgICAgIF9tYXAuYWRkQ2xhc3NFeHRlbnNpb25LZXlzKGV4dHMpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGFkZEZpZWxkRXh0ZW5zaW9uS2V5cyhDb2xs\nZWN0aW9uIGV4dHMpIHsKICAgICAgICBzdXBlci5hZGRGaWVsZEV4dGVuc2lv\nbktleXMoZXh0cyk7CiAgICAgICAgX21hcC5hZGRGaWVsZEV4dGVuc2lvbktl\neXMoZXh0cyk7CiAgICB9Cn0K\n","encoding":"base64"}

