{"sha":"bd0c4b1a4b34bbb97ef53ea2f844e5b74946f045","node_id":"MDQ6QmxvYjIwNjM2NDpiZDBjNGIxYTRiMzRiYmI5N2VmNTNlYTJmODQ0ZTViNzQ5NDZmMDQ1","size":18858,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bd0c4b1a4b34bbb97ef53ea2f844e5b74946f045","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neXM7CmltcG9ydCBqYXZhLnV0aWwuQml0U2V0OwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0\nIGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0Owpp\nbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuSm9pbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLm1ldGEuU291cmNlVHJhY2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnhtbC5Db21tZW50YWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLk1ldGFEYXRhTW9kZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAudXRp\nbC5TdHJpbmdzOwoKLyoqCiAqIE1hcHBpbmcgb2YgYSBxdWVyeSByZXN1bHQg\nc2V0IHRvIHNjYWxhciBhbmQvb3IgcGVyc2lzdGVuY2UtY2FwYWJsZQogKiBv\nYmplY3QtbGV2ZWwgdmFsdWVzLgogKgogKiBAYXV0aG9yIFBpbmFraSBQb2Rk\nYXIKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBRdWVy\neVJlc3VsdE1hcHBpbmcKICAgIGltcGxlbWVudHMgTWV0YURhdGFNb2Rlcywg\nU291cmNlVHJhY2tlciwgQ29tbWVudGFibGUgewoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2th\nZ2UKICAgICAgICAoUXVlcnlSZXN1bHRNYXBwaW5nLmNsYXNzKTsKCiAgICBw\ncml2YXRlIGZpbmFsIFN0cmluZyBfbmFtZTsKICAgIHByaXZhdGUgZmluYWwg\nTWFwcGluZ1JlcG9zaXRvcnkgX3JlcG9zOwogICAgcHJpdmF0ZSBGaWxlIF9m\naWxlID0gbnVsbDsKICAgIHByaXZhdGUgT2JqZWN0IF9zY29wZSA9IG51bGw7\nCiAgICBwcml2YXRlIGludCBfc3JjVHlwZSA9IFNSQ19PVEhFUjsKICAgIHBy\naXZhdGUgaW50IF9tb2RlID0gTU9ERV9RVUVSWTsKICAgIHByaXZhdGUgQ2xh\nc3MgX2NsYXNzID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9pZHggPSAwOwog\nICAgcHJpdmF0ZSBTdHJpbmdbXSBfY29tbWVudHMgPSBudWxsOwogICAgcHJp\ndmF0ZSBMaXN0IF9jb2xMaXN0ID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdCBf\ncGNMaXN0ID0gbnVsbDsKCiAgICBwcml2YXRlIFBDUmVzdWx0W10gX3BjcyA9\nIG51bGw7CiAgICBwcml2YXRlIE9iamVjdFtdIF9jb2xzID0gbnVsbDsKCiAg\nICAvKioKICAgICAqIENvbnN0cnVjdCB3aXRoIHRoZSBnaXZlbiBuYW1lLgog\nICAgICovCiAgICBRdWVyeVJlc3VsdE1hcHBpbmcoU3RyaW5nIG5hbWUsIE1h\ncHBpbmdSZXBvc2l0b3J5IHJlcG9zKSB7CiAgICAgICAgX25hbWUgPSBuYW1l\nOwogICAgICAgIF9yZXBvcyA9IHJlcG9zOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBuYW1lIGZvciB0aGlzIHF1ZXJ5IHJlc3VsdC4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgIHJl\ndHVybiBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBjbGFzcyB0\naGF0IGRlZmluZXMgdGhpcyBxdWVyeSByZXN1bHQsIG9yIG51bGwgaWYgbm9u\nZS4KICAgICAqLwogICAgcHVibGljIENsYXNzIGdldERlZmluaW5nVHlwZSgp\nIHsKICAgICAgICByZXR1cm4gX2NsYXNzOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIGNsYXNzIHRoYXQgZGVmaW5lcyB0aGlzIHF1ZXJ5IHJlc3VsdCwg\nb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRE\nZWZpbmluZ1R5cGUoQ2xhc3MgY2xzKSB7CiAgICAgICAgX2NsYXNzID0gY2xz\nOwogICAgfQoKICAgIC8qKgogICAgICogSWRzIG9mIG1hcHBlZCBzY2FsYXIg\nY29sdW1ucyBpbiB0aGUgcmVzdWx0LiBUaGVzZSB3aWxsIHR5cGljYWxseSBi\nZQogICAgICogY29sdW1uIG5hbWVzLgogICAgICoKICAgICAqIEBzZWUgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJlc3VsdAogICAgICovCiAgICBw\ndWJsaWMgT2JqZWN0W10gZ2V0Q29sdW1uUmVzdWx0cygpIHsKICAgICAgICBp\nZiAoX2NvbHMgPT0gbnVsbCkgewogICAgICAgICAgICBPYmplY3RbXSBjb2xz\nOwogICAgICAgICAgICBpZiAoX2NvbExpc3QgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGNvbHMgPSBuZXcgT2JqZWN0WzBdOwogICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICBjb2xzID0gX2NvbExpc3QudG9BcnJheSgpOwog\nICAgICAgICAgICBfY29scyA9IGNvbHM7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBfY29sczsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgaWQg\nb2YgYSBtYXBwZWQgY29sdW1uIGluIHRoZSBxdWVyeSByZXN1bHQuIFRoaXMg\nd2lsbCB0eXBpY2FsbHkKICAgICAqIGJlIGEgY29sdW1uIG5hbWUuCiAgICAg\nKgogICAgICogQHNlZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUmVz\ndWx0CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZENvbHVtblJlc3VsdChP\nYmplY3QgaWQpIHsKICAgICAgICBfY29scyA9IG51bGw7CiAgICAgICAgaWYg\nKF9jb2xMaXN0ID09IG51bGwpCiAgICAgICAgICAgIF9jb2xMaXN0ID0gbmV3\nIEFycmF5TGlzdCgpOwogICAgICAgIF9jb2xMaXN0LmFkZChpZCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1hcHBlZCBwZXJzaXN0ZW5j\nZS1jYXBhYmxlIHR5cGVzIGluIHRoZSBxdWVyeSByZXN1bHQuCiAgICAgKi8K\nICAgIHB1YmxpYyBQQ1Jlc3VsdFtdIGdldFBDUmVzdWx0cygpIHsKICAgICAg\nICBpZiAoX3BjcyA9PSBudWxsKSB7CiAgICAgICAgICAgIFBDUmVzdWx0W10g\ncGNzOwogICAgICAgICAgICBpZiAoX3BjTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICAgICAgcGNzID0gbmV3IFBDUmVzdWx0WzBdOwogICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICBwY3MgPSAoUENSZXN1bHRbXSkgX3BjTGlz\ndC50b0FycmF5CiAgICAgICAgICAgICAgICAgICAgKG5ldyBQQ1Jlc3VsdFtf\ncGNMaXN0LnNpemUoKV0pOwogICAgICAgICAgICBfcGNzID0gcGNzOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX3BjczsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFkZCBhIG1hcHBlZCBwZXJzaXN0ZW5jZS1jYXBhYmxlIHJlc3VsdCB3\naXRoIHRoZSBnaXZlbiBjYW5kaWRhdGUgdHlwZS4KICAgICAqLwogICAgcHVi\nbGljIFBDUmVzdWx0IGFkZFBDUmVzdWx0KENsYXNzIGNhbmRpZGF0ZSkgewog\nICAgICAgIF9wY3MgPSBudWxsOwogICAgICAgIFBDUmVzdWx0IHBjID0gbmV3\nIFBDUmVzdWx0KGNhbmRpZGF0ZSk7CiAgICAgICAgaWYgKF9wY0xpc3QgPT0g\nbnVsbCkKICAgICAgICAgICAgX3BjTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsK\nICAgICAgICBfcGNMaXN0LmFkZChwYyk7CiAgICAgICAgcmV0dXJuIHBjOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIHNvdXJjZSBtb2RlIG9mIHRoaXMg\ncXVlcnkgcmVzdWx0LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFNvdXJj\nZU1vZGUoKSB7CiAgICAgICAgcmV0dXJuIF9tb2RlOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIHNvdXJjZSBtb2RlIG9mIHRoaXMgcXVlcnkgcmVzdWx0\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTb3VyY2VNb2RlKGludCBt\nb2RlKSB7CiAgICAgICAgX21vZGUgPSBtb2RlOwogICAgfQoKICAgIC8qKgog\nICAgICogUmVsYXRpdmUgb3JkZXIgb2YgcmVzdWx0IG1hcHBpbmcgaW4gbWV0\nYWRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0TGlzdGluZ0luZGV4\nKCkgewogICAgICAgIHJldHVybiBfaWR4OwogICAgfQoKICAgIC8qKgogICAg\nICogUmVsYXRpdmUgb3JkZXIgb2YgcmVzdWx0IG1hcHBpbmcgaW4gbWV0YWRh\ndGEuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldExpc3RpbmdJbmRleChp\nbnQgaWR4KSB7CiAgICAgICAgX2lkeCA9IGlkeDsKICAgIH0KCiAgICBwdWJs\naWMgU3RyaW5nIHRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiBfbmFtZTsK\nICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8KICAgIC8vIENvbW1lbnRhYmxl\nCiAgICAvLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0\nQ29tbWVudHMoKSB7CiAgICAgICAgcmV0dXJuIChfY29tbWVudHMgPT0gbnVs\nbCkgPyBFTVBUWV9DT01NRU5UUyA6IF9jb21tZW50czsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRDb21tZW50cyhTdHJpbmdbXSBjb21tZW50cykgewog\nICAgICAgIF9jb21tZW50cyA9IGNvbW1lbnRzOwogICAgfQoKICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBTb3VyY2VUcmFj\na2VyIGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBGaWxlIGdldFNvdXJjZUZpbGUoKSB7\nCiAgICAgICAgcmV0dXJuIF9maWxlOwogICAgfQoKICAgIHB1YmxpYyBPYmpl\nY3QgZ2V0U291cmNlU2NvcGUoKSB7CiAgICAgICAgcmV0dXJuIF9zY29wZTsK\nICAgIH0KCiAgICBwdWJsaWMgaW50IGdldFNvdXJjZVR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9zcmNUeXBlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndFNvdXJjZShGaWxlIGZpbGUsIE9iamVjdCBzY29wZSwgaW50IHNyY1R5cGUp\nIHsKICAgICAgICBfZmlsZSA9IGZpbGU7CiAgICAgICAgX3Njb3BlID0gc2Nv\ncGU7CiAgICAgICAgX3NyY1R5cGUgPSBzcmNUeXBlOwogICAgfQoKICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0UmVzb3VyY2VOYW1lKCkgewogICAgICAgIHJldHVy\nbiAoX2NsYXNzID09IG51bGwpID8gX25hbWUgOiBfY2xhc3MuZ2V0TmFtZSgp\nICsgIjoiICsgX25hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBBIHBlcnNp\nc3RlbmNlLWNhcGFibGUgcmVzdWx0LgogICAgICovCiAgICBwdWJsaWMgY2xh\nc3MgUENSZXN1bHQgewoKICAgICAgICAvKioKICAgICAgICAgKiBQYXRoIHRv\na2VuIHRvIHJlcHJlc2VudCBhIGRpc2NyaW1pbmF0b3IuCiAgICAgICAgICov\nCiAgICAgICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgRElTQ1JJTUlO\nQVRPUiA9ICI8ZGlzY3JpbWluYXRvcj4iOwoKICAgICAgICBwcml2YXRlIGZp\nbmFsIENsYXNzIF9jYW5kaWRhdGU7CiAgICAgICAgcHJpdmF0ZSBDbGFzc01h\ncHBpbmcgX2NhbmRpZGF0ZU1hcCA9IG51bGw7CiAgICAgICAgcHJpdmF0ZSBN\nYXAgX3Jhd01hcHBpbmdzID0gbnVsbDsgLy8gc3RyaW5nLT5vYmplY3QKICAg\nICAgICBwcml2YXRlIE1hcCBfbWFwcGluZ3MgPSBudWxsOyAvLyBsaXN0LT5j\nb2x1bW5tYXAKICAgICAgICBwcml2YXRlIE1hcCBfZWFnZXIgPSBudWxsOyAv\nLyBsaXN0LT5mZXRjaGluZm8KICAgICAgICBwcml2YXRlIEZldGNoSW5mbyBf\nZmV0Y2hJbmZvID0gbnVsbDsgLy8gZm9yIHRvcC1sZXZlbAoKICAgICAgICAv\nKioKICAgICAgICAgKiBTdXBwbHkgY2FuZGlkYXRlIHR5cGUgb24gY29uc3Ry\ndWN0aW9uLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgUENSZXN1bHQo\nQ2xhc3MgY2FuZGlkYXRlKSB7CiAgICAgICAgICAgIF9jYW5kaWRhdGUgPSBj\nYW5kaWRhdGU7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBU\naGUgcmVzdWx0IGNhbmRpZGF0ZSBjbGFzcy4KICAgICAgICAgKi8KICAgICAg\nICBwdWJsaWMgQ2xhc3MgZ2V0Q2FuZGlkYXRlVHlwZSgpIHsKICAgICAgICAg\nICAgcmV0dXJuIF9jYW5kaWRhdGU7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBDYW5kaWRhdGUgbWFwcGluZy4KICAgICAgICAgKi8KICAg\nICAgICBwdWJsaWMgQ2xhc3NNYXBwaW5nIGdldENhbmRpZGF0ZVR5cGVNYXBw\naW5nKCkgewogICAgICAgICAgICBpZiAoX2NhbmRpZGF0ZU1hcCA9PSBudWxs\nKQogICAgICAgICAgICAgICAgX2NhbmRpZGF0ZU1hcCA9IF9yZXBvcy5nZXRN\nYXBwaW5nKF9jYW5kaWRhdGUsIG51bGwsIHRydWUpOwogICAgICAgICAgICBy\nZXR1cm4gX2NhbmRpZGF0ZU1hcDsKICAgICAgICB9CgogICAgICAgIC8qKgog\nICAgICAgICAqIFJldHVybiB0aGUgcmF3IG1hcHBpbmcgcGF0aHMgc3VwcGxp\nZWQgd2l0aCB7QGxpbmsgI2FkZE1hcHBpbmd9LCBvcgogICAgICAgICAqIGVt\ncHR5IGFycmF5IGlmIG5vbmUuCiAgICAgICAgICovCiAgICAgICAgcHVibGlj\nIFN0cmluZ1tdIGdldE1hcHBpbmdQYXRocygpIHsKICAgICAgICAgICAgaWYg\nKF9yYXdNYXBwaW5ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJu\nIG5ldyBTdHJpbmdbMF07CiAgICAgICAgICAgIENvbGxlY3Rpb24ga2V5cyA9\nIF9yYXdNYXBwaW5ncy5rZXlTZXQoKTsKICAgICAgICAgICAgcmV0dXJuIChT\ndHJpbmdbXSkga2V5cy50b0FycmF5KG5ldyBTdHJpbmdba2V5cy5zaXplKCld\nKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybiB0\naGUgbWFwcGluZyBpZCBmb3IgdGhlIGdpdmVuIHBhdGggc3VwcGxpZWQgd2l0\naAogICAgICAgICAqIHtAbGluayAjYWRkTWFwcGluZ30sIG9yIG51bGwgaWYg\nbm9uZS4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgT2JqZWN0IGdldE1h\ncHBpbmcoU3RyaW5nIHBhdGgpIHsKICAgICAgICAgICAgcmV0dXJuIChfcmF3\nTWFwcGluZ3MgPT0gbnVsbCkgPyBudWxsIDogX3Jhd01hcHBpbmdzLmdldChw\nYXRoKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIE1hcCB0\naGUgZ2l2ZW4gcGF0aCB0byB0aGUgZ2l2ZW4gcmVzdWx0IGlkLgogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGFkZE1hcHBpbmcoU3RyaW5nIHBh\ndGgsIE9iamVjdCBpZCkgewogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMu\naXNFbXB0eShwYXRoKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRh\nRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibnVsbC1wYXRoIiwKICAgICAgICAg\nICAgICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcudGhpcywgX2NhbmRpZGF0\nZSkpOwoKICAgICAgICAgICAgX21hcHBpbmdzID0gbnVsbDsKICAgICAgICAg\nICAgX2VhZ2VyID0gbnVsbDsKICAgICAgICAgICAgX2ZldGNoSW5mbyA9IG51\nbGw7CiAgICAgICAgICAgIGlmIChfcmF3TWFwcGluZ3MgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIF9yYXdNYXBwaW5ncyA9IG5ldyBIYXNoTWFwKCk7CiAg\nICAgICAgICAgIF9yYXdNYXBwaW5ncy5wdXQocGF0aCwgaWQpOwogICAgICAg\nIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogTWFwIHRoZSBnaXZlbiByZXF1\nZXN0IG9udG8gYSByZXN1bHQgaWQuCiAgICAgICAgICoKICAgICAgICAgKiBA\ncGFyYW0gcGF0aCBzdGFjayBvZiBkYXRhIHJlcXVlc3RzIChzZWUKICAgICAg\nICAgKiB7QGxpbmsgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJlc3Vs\ndCNzdGFydERhdGFSZXF1ZXN0fSkKICAgICAgICAgKiBAcGFyYW0gaWQgcmVx\ndWVzdGVkIGlkIG9yIGNvbHVtbiAoc2VlCiAgICAgICAgICoge0BsaW5rIG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5SZXN1bHR9IEFQSXMpCiAgICAg\nICAgICogQHBhcmFtIGpvaW5zIHJlcXVlc3RlZCBqb2lucywgb3IgbnVsbAog\nICAgICAgICAqIEByZXR1cm4gdGhlIGlkIG9yIGNvbHVtbiB0byBmZXRjaCBm\ncm9tIHRoZSByZXN1bHQKICAgICAgICAgKiAodHlwaWNhbGx5IGEgY29sdW1u\nIG5hbWUpCiAgICAgICAgICovCiAgICAgICAgcHVibGljIE9iamVjdCBtYXAo\nTGlzdCBwYXRoLCBPYmplY3QgaWQsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAg\nICAgIGlmIChfcmF3TWFwcGluZ3MgPT0gbnVsbCB8fCAhKGlkIGluc3RhbmNl\nb2YgQ29sdW1uKSkKICAgICAgICAgICAgICAgIHJldHVybiBpZDsKCiAgICAg\nICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgQ29sdW1uTWFwIGNtID0g\nKENvbHVtbk1hcCkgX21hcHBpbmdzLmdldChwYXRoKTsKICAgICAgICAgICAg\ncmV0dXJuIChjbSA9PSBudWxsKSA/IGlkIDogY20ubWFwKChDb2x1bW4pIGlk\nKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybiB0\ncnVlIGlmIHRoZSBtYXBwZWQgcmVzdWx0IGNvbnRhaW5zIGVhZ2VyIGRhdGEg\nZm9yIHRoZSBnaXZlbgogICAgICAgICAqIGZpZWxkIGF0IHRoZSBnaXZlbiBw\nYXRoLgogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHBhdGggc3RhY2sg\nb2YgZGF0YSByZXF1ZXN0cyAoc2VlCiAgICAgICAgICoge0BsaW5rIG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNxbC5SZXN1bHQjc3RhcnREYXRhUmVxdWVz\ndH0pCiAgICAgICAgICovCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzRWFn\nZXIoTGlzdCBwYXRoLCBGaWVsZE1hcHBpbmcgZmllbGQpIHsKICAgICAgICAg\nICAgaWYgKF9yYXdNYXBwaW5ncyA9PSBudWxsKQogICAgICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAg\nICAgICBpZiAocGF0aC5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gX2ZldGNoSW5mby5lYWdlci5nZXQoZmllbGQuZ2V0SW5kZXgoKSk7CiAg\nICAgICAgICAgIGlmIChfZWFnZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgRmV0Y2hJbmZvIGluZm8gPSAo\nRmV0Y2hJbmZvKSBfZWFnZXIuZ2V0KHBhdGgpOwogICAgICAgICAgICByZXR1\ncm4gaW5mbyAhPSBudWxsICYmIGluZm8uZWFnZXIuZ2V0KGZpZWxkLmdldElu\nZGV4KCkpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmV0\ndXJuIHRoZSBmaWVsZCBpbmRleGVzIHRvIGV4Y2x1ZGUgd2hlbiBsb2FkaW5n\nIGRhdGEgZm9yIHRoZQogICAgICAgICAqIGdpdmVuIHBhdGguCiAgICAgICAg\nICovCiAgICAgICAgcHVibGljIEJpdFNldCBnZXRFeGNsdWRlcyhMaXN0IHBh\ndGgpIHsKICAgICAgICAgICAgaWYgKF9yYXdNYXBwaW5ncyA9PSBudWxsKQog\nICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgICAgICByZXNv\nbHZlKCk7CiAgICAgICAgICAgIGlmIChwYXRoLmlzRW1wdHkoKSkKICAgICAg\nICAgICAgICAgIHJldHVybiBfZmV0Y2hJbmZvLmV4Y2x1ZGVzOwogICAgICAg\nICAgICBpZiAoX2VhZ2VyID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICAgICAgRmV0Y2hJbmZvIGluZm8gPSAoRmV0Y2hJ\nbmZvKSBfZWFnZXIuZ2V0KHBhdGgpOwogICAgICAgICAgICByZXR1cm4gKGlu\nZm8gPT0gbnVsbCkgPyBudWxsIDogaW5mby5leGNsdWRlczsKICAgICAgICB9\nCgogICAgICAgIC8qKgogICAgICAgICAqIFJlc29sdmUgaW50ZXJuYWwgZGF0\nYXN0cnVjdHVyZXMgZnJvbSByYXcgbWFwcGluZ3MuCiAgICAgICAgICovCiAg\nICAgICAgcHJpdmF0ZSBzeW5jaHJvbml6ZWQgdm9pZCByZXNvbHZlKCkgewog\nICAgICAgICAgICBpZiAoX3Jhd01hcHBpbmdzID09IG51bGwgfHwgX21hcHBp\nbmdzICE9IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm47CgogICAgICAg\nICAgICBfbWFwcGluZ3MgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgICAgICBf\nZmV0Y2hJbmZvID0gbmV3IEZldGNoSW5mbyhnZXRDYW5kaWRhdGVUeXBlTWFw\ncGluZygpKTsKCiAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfcmF3TWFwcGluZ3MuZW50cnlT\nZXQoKS5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgaXRyLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgICAgIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgIHJlc29sdmVNYXBwaW5nKChTdHJp\nbmcpIGVudHJ5LmdldEtleSgpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmVz\nb2x2ZSB0aGUgZ2l2ZW4gbWFwcGluZyBwYXRoLgogICAgICAgICAqLwogICAg\nICAgIHByaXZhdGUgdm9pZCByZXNvbHZlTWFwcGluZyhTdHJpbmcgcGF0aCwg\nT2JqZWN0IGlkKSB7CiAgICAgICAgICAgIC8vIGJ1aWxkIHVwIHBhdGggdG8g\nc2Vjb25kLXRvLWxhc3QgdG9rZW4KICAgICAgICAgICAgU3RyaW5nW10gdG9r\nZW5zID0gU3RyaW5ncy5zcGxpdChwYXRoLCAiLiIsIDApOwogICAgICAgICAg\nICBMaXN0IHJwYXRoID0gbmV3IEFycmF5TGlzdCh0b2tlbnMubGVuZ3RoKTsK\nICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGNhbmRpZGF0ZSA9IGdldENhbmRp\nZGF0ZVR5cGVNYXBwaW5nKCk7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZyBm\nbSA9IG51bGw7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdG9r\nZW5zLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgICAgICAgZm0gPSBj\nYW5kaWRhdGUuZ2V0RmllbGRNYXBwaW5nKHRva2Vuc1tpXSk7CiAgICAgICAg\nICAgICAgICBpZiAoZm0gPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1wYXRo\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5n\nLnRoaXMsIF9jYW5kaWRhdGUsIHBhdGgpKTsKCiAgICAgICAgICAgICAgICBp\nZiAoZm0uZ2V0RW1iZWRkZWRNYXBwaW5nKCkgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgICAgIHJlY29yZEluY2x1ZGVkKGNhbmRpZGF0ZSwgcnBhdGgs\nIGZtKTsKICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUgPSBmbS5nZXRF\nbWJlZGRlZE1hcHBpbmcoKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAg\nICAgICAgICAgICAgICAgIGNhbmRpZGF0ZSA9IGZtLmdldFR5cGVNYXBwaW5n\nKCk7CiAgICAgICAgICAgICAgICBpZiAoY2FuZGlkYXRlID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJ1bnRyYXZlcnNhYmxlLXBhdGgiLAogICAgICAgICAgICAg\nICAgICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcudGhpcywgX2NhbmRpZGF0\nZSwgcGF0aCkpOwogICAgICAgICAgICAgICAgcnBhdGguYWRkKGZtKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgU3RyaW5nIGxhc3RUb2tlbiA9IHRv\na2Vuc1t0b2tlbnMubGVuZ3RoIC0gMV07CiAgICAgICAgICAgIGlmIChESVND\nUklNSU5BVE9SLmVxdWFscyhsYXN0VG9rZW4pKSB7CiAgICAgICAgICAgICAg\nICBEaXNjcmltaW5hdG9yIGRpc2NyaW0gPSBjYW5kaWRhdGUuZ2V0RGlzY3Jp\nbWluYXRvcigpOwogICAgICAgICAgICAgICAgcnBhdGguYWRkKGRpc2NyaW0p\nOwogICAgICAgICAgICAgICAgYXNzZXJ0U2luZ2xlQ29sdW1uKGRpc2NyaW0u\nZ2V0Q29sdW1ucygpLCBwYXRoKTsKICAgICAgICAgICAgICAgIF9tYXBwaW5n\ncy5wdXQocnBhdGgsIG5ldyBTaW5nbGVDb2x1bW5NYXAoaWQpKTsKICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIEZpZWxkTWFwcGluZyBs\nYXN0ID0gY2FuZGlkYXRlLmdldEZpZWxkTWFwcGluZyhsYXN0VG9rZW4pOwog\nICAgICAgICAgICAgICAgaWYgKGxhc3QgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQo\nInVudHJhdmVyc2FibGUtcGF0aCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nIFF1ZXJ5UmVzdWx0TWFwcGluZy50aGlzLCBfY2FuZGlkYXRlLCBwYXRoKSk7\nCiAgICAgICAgICAgICAgICBhc3NlcnRTaW5nbGVDb2x1bW4obGFzdC5nZXRD\nb2x1bW5zKCksIHBhdGgpOwogICAgICAgICAgICAgICAgQ29sdW1uIGNvbCA9\nIGxhc3QuZ2V0Q29sdW1ucygpWzBdOwoKICAgICAgICAgICAgICAgIC8vIHNw\nZWNpYWwtY2FzZSBvaWQgZmllbGRzLCBzaW5jZSBwYXRoIGxpc3RzIHN1cHBs\naWVkIGZvcgogICAgICAgICAgICAgICAgLy8gdGhlbSBhdCBydW50aW1lIGRv\nbid0IGluY2x1ZGUgdGhlIGVtYmVkZGVkIGZpZWxkcwogICAgICAgICAgICAg\nICAgaWYgKGZtICE9IG51bGwgJiYgZm0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgp\nID09IEphdmFUeXBlcy5PSUQpIHsKICAgICAgICAgICAgICAgICAgICBhZGRD\nb21wbGV4Q29sdW1uTWFwcGluZyhmbSwgcnBhdGgsIGNvbCwgaWQpOwogICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICBpZiAoZm0gIT0gbnVsbCAmJiBmbS5nZXRGb3JlaWdu\nS2V5KCkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIC8vIGlmIHRo\nZSBsYXN0IGZpZWxkIGlzIG9uZSBvZiB0aGUgam9pbmFibGVzIHVzZWQgaW4g\ndGhlCiAgICAgICAgICAgICAgICAgICAgLy8gcmVsYXRpb24ncyBmb3JlaWdu\nIGtleSwgbWFwIHRvIHJlbGF0aW9uIGZpZWxkIHBhdGguCiAgICAgICAgICAg\nICAgICAgICAgLy8gb3RoZXJ3aXNlLCByZWNvcmQgdGhhdCB3ZSBoYXZlIGFu\nIGVhZ2VyIHJlc3VsdAogICAgICAgICAgICAgICAgICAgIENvbHVtbiBma0Nv\nbCA9IGZtLmdldEZvcmVpZ25LZXkoKS5nZXRDb2x1bW4oY29sKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAoZmtDb2wgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICAgICAgYWRkQ29tcGxleENvbHVtbk1hcHBpbmcoZm0sIG5ldyBB\ncnJheUxpc3QocnBhdGgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZmtDb2wsIGlkKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgcmVjb3JkRWFnZXIoY2FuZGlkYXRlLCBycGF0\naCwgZm0pOwogICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRJbmNsdWRl\nZChjYW5kaWRhdGUsIHJwYXRoLCBsYXN0KTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAg\nICByZWNvcmRJbmNsdWRlZChjYW5kaWRhdGUsIHJwYXRoLCBsYXN0KTsKCiAg\nICAgICAgICAgICAgICAvLyBtYXAgdG8gcmVsYXRlZCBmaWVsZCBwYXRoLiBi\nZWNhdXNlIHRoZSBTaW5nbGVDb2x1bW5NYXAKICAgICAgICAgICAgICAgIC8v\nIGRvZXNuJ3QgdGVzdCB0aGUgcmVxdWVzdGVkIGNvbHVtbiwgaXQgd2lsbCBh\nY2NlcHQKICAgICAgICAgICAgICAgIC8vIHJlcXVlc3RzIGZvciBib3RoIHRo\nZSBmayBjb2wgb3IgdGhlIHJlbGF0ZWQgZmllbGQgY29sCiAgICAgICAgICAg\nICAgICBycGF0aC5hZGQobGFzdCk7CiAgICAgICAgICAgICAgICBfbWFwcGlu\nZ3MucHV0KHJwYXRoLCBuZXcgU2luZ2xlQ29sdW1uTWFwKGlkKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIENy\nZWF0ZSBhbiBhcHByb3ByaWF0ZSBjb2x1bW4gbWFwcGluZyBmb3IgdGhlIGdp\ndmVuIGZpZWxkLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBh\nZGRDb21wbGV4Q29sdW1uTWFwcGluZyhGaWVsZE1hcHBpbmcgZm0sIExpc3Qg\ncnBhdGgsCiAgICAgICAgICAgIENvbHVtbiBjb2wsIE9iamVjdCBpZCkgewog\nICAgICAgICAgICBpZiAoZm0uZ2V0Q29sdW1ucygpLmxlbmd0aCA9PSAxKQog\nICAgICAgICAgICAgICAgX21hcHBpbmdzLnB1dChycGF0aCwgbmV3IFNpbmds\nZUNvbHVtbk1hcChpZCkpOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAg\nICAgICAgIE11bHRpQ29sdW1uTWFwIG1jbSA9IChNdWx0aUNvbHVtbk1hcCkg\nX21hcHBpbmdzLmdldChycGF0aCk7CiAgICAgICAgICAgICAgICBpZiAobWNt\nID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBtY20gPSBuZXcgTXVs\ndGlDb2x1bW5NYXAoZm0uZ2V0Q29sdW1ucygpKTsKICAgICAgICAgICAgICAg\nICAgICBfbWFwcGluZ3MucHV0KHJwYXRoLCBtY20pOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgbWNtLnNldChjb2wsIGlkKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogRm9y\nIG5vdywgd2Ugb25seSBhbGxvdyBtYXBwaW5ncyB3aXRoIGEgc2luZ2xlIGNv\nbHVtbi4gSW4gdGhlCiAgICAgICAgICogZnV0dXJlIHdlIG1pZ2h0IGludHJv\nZHVjZSBhIHN5bnRheCB0byBtYXAgbXVsdGlwbGUgY29sdW1ucy4KICAgICAg\nICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgYXNzZXJ0U2luZ2xlQ29sdW1u\nKENvbHVtbltdIGNvbHMsIFN0cmluZyBwYXRoKSB7CiAgICAgICAgICAgIGlm\nIChjb2xzLmxlbmd0aCAhPSAxKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJudW0tY29scy1wYXRoIiwK\nICAgICAgICAgICAgICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcudGhpcywg\nX2NhbmRpZGF0ZSwgcGF0aCkpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAg\nICAgICAgICogUmVjb3JkIHRoYXQgdGhlcmUgbWF5IGJlIGVhZ2VyIGRhdGEg\nZm9yIHRoZSBnaXZlbiBmaWVsZCBhdCB0aGUgZ2l2ZW4KICAgICAgICAgKiBw\nYXRoLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCByZWNvcmRF\nYWdlcihDbGFzc01hcHBpbmcgY2FuZGlkYXRlLCBMaXN0IHBhdGgsCiAgICAg\nICAgICAgIEZpZWxkTWFwcGluZyBmbSkgewogICAgICAgICAgICBpZiAocGF0\naC5zaXplKCkgPT0gMSkgewogICAgICAgICAgICAgICAgX2ZldGNoSW5mby5l\nYWdlci5zZXQoZm0uZ2V0SW5kZXgoKSk7CiAgICAgICAgICAgICAgICBfZmV0\nY2hJbmZvLmV4Y2x1ZGVzLmNsZWFyKGZtLmdldEluZGV4KCkpOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gcmVjb3JkIGF0IHBy\nZXZpb3VzIHBhdGgKICAgICAgICAgICAgICAgIExpc3QgY29weSA9IG5ldyBB\ncnJheUxpc3QocGF0aC5zaXplKCkgLSAxKTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgY29weS5zaXplKCk7IGkrKykKICAgICAgICAg\nICAgICAgICAgICBjb3B5LmFkZChwYXRoLmdldChpKSk7CgogICAgICAgICAg\nICAgICAgaWYgKF9lYWdlciA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIF9lYWdlciA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgICAgICBGZXRj\naEluZm8gaW5mbyA9IChGZXRjaEluZm8pIF9lYWdlci5nZXQoY29weSk7CiAg\nICAgICAgICAgICAgICBpZiAoaW5mbyA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgaW5mbyA9IG5ldyBGZXRjaEluZm8oY2FuZGlkYXRlKTsKICAg\nICAgICAgICAgICAgICAgICBfZWFnZXIucHV0KGNvcHksIGluZm8pOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW5mby5lYWdlci5zZXQo\nZm0uZ2V0SW5kZXgoKSk7CiAgICAgICAgICAgICAgICBpbmZvLmV4Y2x1ZGVz\nLmNsZWFyKGZtLmdldEluZGV4KCkpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZWNvcmQgdGhhdCB0aGUgZmll\nbGQgYXQgdGhlIGdpdmVuIHBhdGggaXMgaW5jbHVkZWQgaW4gdGhlIHJlc3Vs\ndHMuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIHJlY29yZElu\nY2x1ZGVkKENsYXNzTWFwcGluZyBjYW5kaWRhdGUsIExpc3QgcGF0aCwKICAg\nICAgICAgICAgRmllbGRNYXBwaW5nIGZtKSB7CiAgICAgICAgICAgIGlmIChw\nYXRoLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIF9mZXRjaEluZm8uZXhj\nbHVkZXMuY2xlYXIoZm0uZ2V0SW5kZXgoKSk7CiAgICAgICAgICAgIGVsc2Ug\newogICAgICAgICAgICAgICAgaWYgKF9lYWdlciA9PSBudWxsKQogICAgICAg\nICAgICAgICAgICAgIF9lYWdlciA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAg\nICAgICAgICBGZXRjaEluZm8gaW5mbyA9IChGZXRjaEluZm8pIF9lYWdlci5n\nZXQocGF0aCk7CiAgICAgICAgICAgICAgICBpZiAoaW5mbyA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IG5ldyBGZXRjaEluZm8oY2Fu\nZGlkYXRlKTsKICAgICAgICAgICAgICAgICAgICBfZWFnZXIucHV0KG5ldyBB\ncnJheUxpc3QocGF0aCksIGluZm8pOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgaW5mby5leGNsdWRlcy5jbGVhcihmbS5nZXRJbmRleCgp\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIEZldGNoIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0\nYXRpYyBjbGFzcyBGZXRjaEluZm8gewoKICAgICAgICAvKioKICAgICAgICAg\nKiBJbmRleGVzIG9mIGZpZWxkcyB0byBleGNsdWRlIGZyb20gbG9hZGluZy4K\nICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgZmluYWwgQml0U2V0IGV4Y2x1\nZGVzOwoKICAgICAgICAvKioKICAgICAgICAgKiBJbmRleGVzIG9mIGVhZ2Vy\nIGZpZWxkcy4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgZmluYWwgQml0\nU2V0IGVhZ2VyOwoKICAgICAgICBwdWJsaWMgRmV0Y2hJbmZvKENsYXNzTWFw\ncGluZyB0eXBlKSB7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZ1tdIGZtcyA9\nIHR5cGUuZ2V0RmllbGRNYXBwaW5ncygpOwogICAgICAgICAgICBlYWdlciA9\nIG5ldyBCaXRTZXQoZm1zLmxlbmd0aCk7CiAgICAgICAgICAgIGV4Y2x1ZGVz\nID0gbmV3IEJpdFNldChmbXMubGVuZ3RoKTsKICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBmbXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICBpZiAoIWZtc1tpXS5pc1ByaW1hcnlLZXkoKSkKICAgICAgICAgICAgICAg\nICAgICBleGNsdWRlcy5zZXQoaSk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogTWFwcGluZyBvZiBjb2x1bW5zIHRvIHJlc3VsdCBpZHMuCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGludGVyZmFjZSBDb2x1bW5NYXAg\newoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBp\nZCBmb3IgdGhlIGdpdmVuIGNvbHVtbiwgb3IgdGhlIGdpdmVuIGNvbHVtCiAg\nICAgICAgICogaWYgbm9uZS4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\nT2JqZWN0IG1hcChDb2x1bW4gY29sKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIHtAbGluayBDb2x1bW5NYXB9IHNwZWNpYWxpemVkIGZvciBhIHNpbmdsZSBj\nb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFNpbmds\nZUNvbHVtbk1hcAogICAgICAgIGltcGxlbWVudHMgQ29sdW1uTWFwIHsKCiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBPYmplY3QgX2lkOwoKICAgICAgICBwdWJs\naWMgU2luZ2xlQ29sdW1uTWFwKE9iamVjdCBpZCkgewogICAgICAgICAgICBf\naWQgPSBpZDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3QgbWFw\nKENvbHVtbiBjb2wpIHsKICAgICAgICAgICAgcmV0dXJuIF9pZDsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAg\nICAgICAgIHJldHVybiBfaWQudG9TdHJpbmcoKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiB7QGxpbmsgQ29sdW1uTWFwfSBzcGVjaWFsaXpl\nZCBmb3IgYSBtdWx0aXBsZSBjb2x1bW5zLgogICAgICogTWFwcyBjb2x1bW5z\nIGluIGxpbmVhciB0aW1lLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBj\nbGFzcyBNdWx0aUNvbHVtbk1hcAogICAgICAgIGltcGxlbWVudHMgQ29sdW1u\nTWFwIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBMaXN0IF9jb2xzOwogICAg\nICAgIHByaXZhdGUgZmluYWwgT2JqZWN0W10gX2lkczsKCiAgICAgICAgcHVi\nbGljIE11bHRpQ29sdW1uTWFwKENvbHVtbltdIGNvbHMpIHsKICAgICAgICAg\nICAgX2NvbHMgPSBBcnJheXMuYXNMaXN0KGNvbHMpOwogICAgICAgICAgICBf\naWRzID0gbmV3IE9iamVjdFtjb2xzLmxlbmd0aF07CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgT2JqZWN0IG1hcChDb2x1bW4gY29sKSB7CiAgICAgICAg\nICAgIGludCBpZHggPSBfY29scy5pbmRleE9mKGNvbCk7CiAgICAgICAgICAg\nIHJldHVybiAoaWR4ID09IC0xKSA/IGNvbCA6IF9pZHNbaWR4XTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldChDb2x1bW4gY29sLCBPYmpl\nY3QgaWQpIHsKICAgICAgICAgICAgaW50IGlkeCA9IF9jb2xzLmluZGV4T2Yo\nY29sKTsKICAgICAgICAgICAgaWYgKGlkeCAhPSAtMSkKICAgICAgICAgICAg\nICAgIF9pZHNbaWR4XSA9IGlkOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICAgICAgcmV0dXJuIF9jb2xz\nICsgIj0iICsgQXJyYXlzLmFzTGlzdChfaWRzKTsKICAgICAgICB9CiAgICB9\nCn0K\n","encoding":"base64"}

