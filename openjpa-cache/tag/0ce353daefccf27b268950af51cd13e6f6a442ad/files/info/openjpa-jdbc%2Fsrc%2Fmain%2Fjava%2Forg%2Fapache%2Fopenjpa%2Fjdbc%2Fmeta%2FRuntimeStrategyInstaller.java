{"sha":"c4d9c352c281282acd95362bd7a795ee15d448fe","node_id":"MDQ6QmxvYjIwNjM2NDpjNGQ5YzM1MmMyODEyODJhY2Q5NTM2MmJkN2E3OTVlZTE1ZDQ0OGZl","size":3373,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c4d9c352c281282acd95362bd7a795ee15d448fe","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nTW9kaWZpZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuTm9uZUZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogSW5z\ndGFsbGVyIHRoYXQgYXR0ZW1wdHMgdG8gdXNlIHRoZSBnaXZlbiBtYXBwaW5n\nIGluZm9ybWF0aW9uLCBhbmQKICogZmFpbHMgaWYgaXQgZG9lcyBub3Qgd29y\nay4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKiBA\nc2luY2UgMC40LjAKICovCnB1YmxpYyBjbGFzcyBSdW50aW1lU3RyYXRlZ3lJ\nbnN0YWxsZXIKICAgIGV4dGVuZHMgU3RyYXRlZ3lJbnN0YWxsZXIgewoKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxp\nemVyLmZvclBhY2thZ2UKICAgICAgICAoUnVudGltZVN0cmF0ZWd5SW5zdGFs\nbGVyLmNsYXNzKTsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBw\nbHkgY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIFJ1bnRpbWVT\ndHJhdGVneUluc3RhbGxlcihNYXBwaW5nUmVwb3NpdG9yeSByZXBvcykgewog\nICAgICAgIHN1cGVyKHJlcG9zKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBp\nbnN0YWxsU3RyYXRlZ3koQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIGlm\nICgoY2xzLmdldFNvdXJjZU1vZGUoKSAmIGNscy5NT0RFX01BUFBJTkcpID09\nIDApCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihf\nbG9jLmdldCgibm8tbWFwcGluZyIsIGNscykpOwoKICAgICAgICBDbGFzc1N0\ncmF0ZWd5IHN0cmF0ID0gcmVwb3MubmFtZWRTdHJhdGVneShjbHMpOwogICAg\nICAgIGlmIChzdHJhdCA9PSBudWxsKQogICAgICAgICAgICBzdHJhdCA9IHJl\ncG9zLmRlZmF1bHRTdHJhdGVneShjbHMsIGZhbHNlKTsKICAgICAgICBjbHMu\nc2V0U3RyYXRlZ3koc3RyYXQsIEJvb2xlYW4uRkFMU0UpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShGaWVsZE1hcHBpbmcgZmll\nbGQpIHsKICAgICAgICBGaWVsZFN0cmF0ZWd5IHN0cmF0ZWd5ID0gcmVwb3Mu\nbmFtZWRTdHJhdGVneShmaWVsZCwgdHJ1ZSk7CiAgICAgICAgaWYgKHN0cmF0\nZWd5ID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIHN0cmF0ZWd5ID0gcmVwb3MuZGVmYXVsdFN0cmF0ZWd5KGZpZWxkLCB0\ncnVlLCBmYWxzZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE1ldGFEYXRhRXhj\nZXB0aW9uIG1kZSkgewogICAgICAgICAgICAgICAgLy8gaWYgdGhlIHBhcmVu\ndCBjbGFzcyBpcyBhYnN0cmFjdCBhbmQgZmllbGQgaXMgdW5tYXBwZWQsCiAg\nICAgICAgICAgICAgICAvLyBhbGxvdyBpdCB0byBwYXNzIChhc3N1bWUgc3Vi\nY2xhc3NlcyBtYXAgdGhlIGZpZWxkKQogICAgICAgICAgICAgICAgQ2xhc3Mg\nY2xzID0gZmllbGQuZ2V0RGVmaW5pbmdNZXRhRGF0YSgpLmdldERlc2NyaWJl\nZFR5cGUoKTsKICAgICAgICAgICAgICAgIGlmICghTW9kaWZpZXIuaXNBYnN0\ncmFjdChjbHMuZ2V0TW9kaWZpZXJzKCkpCiAgICAgICAgICAgICAgICAgICAg\nfHwgZmllbGQuZ2V0TWFwcGVkQnkoKSAhPSBudWxsCiAgICAgICAgICAgICAg\nICAgICAgfHwgZmllbGQuZ2V0TWFwcGluZ0luZm8oKS5oYXNTY2hlbWFDb21w\nb25lbnRzKCkKICAgICAgICAgICAgICAgICAgICB8fCBmaWVsZC5nZXRWYWx1\nZUluZm8oKS5oYXNTY2hlbWFDb21wb25lbnRzKCkKICAgICAgICAgICAgICAg\nICAgICB8fCBmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVlSW5m\nbygpLgogICAgICAgICAgICAgICAgICAgIGhhc1NjaGVtYUNvbXBvbmVudHMo\nKQogICAgICAgICAgICAgICAgICAgIHx8IGZpZWxkLmdldEtleU1hcHBpbmco\nKS5nZXRWYWx1ZUluZm8oKS4KICAgICAgICAgICAgICAgICAgICBoYXNTY2hl\nbWFDb21wb25lbnRzKCkpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbWRl\nOwoKICAgICAgICAgICAgICAgIHN0cmF0ZWd5ID0gTm9uZUZpZWxkU3RyYXRl\nZ3kuZ2V0SW5zdGFuY2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBmaWVsZC5zZXRTdHJhdGVneShzdHJhdGVneSwgQm9vbGVhbi5GQUxT\nRSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5zdGFsbFN0cmF0ZWd5KFZl\ncnNpb24gdmVyc2lvbikgewogICAgICAgIFZlcnNpb25TdHJhdGVneSBzdHJh\ndCA9IHJlcG9zLm5hbWVkU3RyYXRlZ3kodmVyc2lvbik7CiAgICAgICAgaWYg\nKHN0cmF0ID09IG51bGwpCiAgICAgICAgICAgIHN0cmF0ID0gcmVwb3MuZGVm\nYXVsdFN0cmF0ZWd5KHZlcnNpb24sIGZhbHNlKTsKICAgICAgICB2ZXJzaW9u\nLnNldFN0cmF0ZWd5KHN0cmF0LCBCb29sZWFuLkZBTFNFKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBpbnN0YWxsU3RyYXRlZ3koRGlzY3JpbWluYXRvciBk\naXNjcmltKSB7CiAgICAgICAgRGlzY3JpbWluYXRvclN0cmF0ZWd5IHN0cmF0\nID0gcmVwb3MubmFtZWRTdHJhdGVneShkaXNjcmltKTsKICAgICAgICBpZiAo\nc3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAgc3RyYXQgPSByZXBvcy5kZWZh\ndWx0U3RyYXRlZ3koZGlzY3JpbSwgZmFsc2UpOwogICAgICAgIGRpc2NyaW0u\nc2V0U3RyYXRlZ3koc3RyYXQsIEJvb2xlYW4uRkFMU0UpOwogICAgfQp9Cg==\n","encoding":"base64"}

