{"sha":"10c7db51e3cbd9f19464d378c02bd27e3581ef9e","node_id":"MDQ6QmxvYjIwNjM2NDoxMGM3ZGI1MWUzY2JkOWYxOTQ2NGQzNzhjMDJiZDI3ZTM1ODFlZjll","size":17246,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/10c7db51e3cbd9f19464d378c02bd27e3581ef9e","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGE7CgppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuQ29sdW1uSU87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5TY2hlbWFzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlVuaXF1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLlZhbHVlTWV0YURhdGFJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlvbjsKCi8qKgogKiBT\ndGFuZGFsb25lIHtAbGluayBWYWx1ZU1hcHBpbmd9IGltcGxlbWVudGF0aW9u\nLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAc2luY2UgMC40LjAKICov\nCnB1YmxpYyBjbGFzcyBWYWx1ZU1hcHBpbmdJbXBsCiAgICBleHRlbmRzIFZh\nbHVlTWV0YURhdGFJbXBsCiAgICBpbXBsZW1lbnRzIFZhbHVlTWFwcGluZyB7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChWYWx1ZU1hcHBpbmdJbXBs\nLmNsYXNzKTsKCiAgICBwcml2YXRlIGZpbmFsIFZhbHVlTWFwcGluZ0luZm8g\nX2luZm87CiAgICBwcml2YXRlIFZhbHVlSGFuZGxlciBfaGFuZGxlciA9IG51\nbGw7CiAgICBwcml2YXRlIENsYXNzTWFwcGluZ1tdIF90eXBlQXJyID0gbnVs\nbDsKCiAgICBwcml2YXRlIENvbHVtbltdIF9jb2xzID0gU2NoZW1hcy5FTVBU\nWV9DT0xVTU5TOwogICAgcHJpdmF0ZSBDb2x1bW5JTyBfaW8gPSBudWxsOwog\nICAgcHJpdmF0ZSBGb3JlaWduS2V5IF9mayA9IG51bGw7CiAgICBwcml2YXRl\nIE1hcCBfdGFyZ2V0RktzID0gbnVsbDsKICAgIHByaXZhdGUgSW5kZXggX2lk\neCA9IG51bGw7CiAgICBwcml2YXRlIFVuaXF1ZSBfdW5xID0gbnVsbDsKICAg\nIHByaXZhdGUgaW50IF9qb2luID0gSk9JTl9GT1JXQVJEOwogICAgcHJpdmF0\nZSBib29sZWFuIF9jcml0ZXJpYSA9IGZhbHNlOwogICAgcHJpdmF0ZSBpbnQg\nX3BvbHkgPSBQT0xZX1RSVUU7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rv\nci4gU3VwcGx5IG93bmluZyBtYXBwaW5nLgogICAgICovCiAgICBwdWJsaWMg\nVmFsdWVNYXBwaW5nSW1wbChGaWVsZE1hcHBpbmcgb3duZXIpIHsKICAgICAg\nICBzdXBlcihvd25lcik7CiAgICAgICAgX2luZm8gPSBvd25lci5nZXRNYXBw\naW5nUmVwb3NpdG9yeSgpLm5ld01hcHBpbmdJbmZvKHRoaXMpOwogICAgICAg\nIF9pbmZvLnNldFVzZUNsYXNzQ3JpdGVyaWEob3duZXIuZ2V0TWFwcGluZ1Jl\ncG9zaXRvcnkoKS4KICAgICAgICAgICAgZ2V0TWFwcGluZ0RlZmF1bHRzKCku\ndXNlQ2xhc3NDcml0ZXJpYSgpKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWVN\nYXBwaW5nSW5mbyBnZXRWYWx1ZUluZm8oKSB7CiAgICAgICAgcmV0dXJuIF9p\nbmZvOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZUhhbmRsZXIgZ2V0SGFuZGxl\ncigpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZXI7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0SGFuZGxlcihWYWx1ZUhhbmRsZXIgaGFuZGxlcikgewog\nICAgICAgIF9oYW5kbGVyID0gaGFuZGxlcjsKICAgIH0KCiAgICBwdWJsaWMg\nTWFwcGluZ1JlcG9zaXRvcnkgZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKSB7CiAg\nICAgICAgcmV0dXJuIChNYXBwaW5nUmVwb3NpdG9yeSkgZ2V0UmVwb3NpdG9y\neSgpOwogICAgfQoKICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgZ2V0RmllbGRN\nYXBwaW5nKCkgewogICAgICAgIHJldHVybiAoRmllbGRNYXBwaW5nKSBnZXRG\naWVsZE1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzTWFwcGlu\nZyBnZXRUeXBlTWFwcGluZygpIHsKICAgICAgICByZXR1cm4gKENsYXNzTWFw\ncGluZykgZ2V0VHlwZU1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIENs\nYXNzTWFwcGluZyBnZXREZWNsYXJlZFR5cGVNYXBwaW5nKCkgewogICAgICAg\nIHJldHVybiAoQ2xhc3NNYXBwaW5nKSBnZXREZWNsYXJlZFR5cGVNZXRhRGF0\nYSgpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01hcHBpbmcgZ2V0RW1iZWRk\nZWRNYXBwaW5nKCkgewogICAgICAgIHJldHVybiAoQ2xhc3NNYXBwaW5nKSBn\nZXRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIEZpZWxk\nTWFwcGluZyBnZXRWYWx1ZU1hcHBlZEJ5TWFwcGluZygpIHsKICAgICAgICBy\nZXR1cm4gKEZpZWxkTWFwcGluZykgZ2V0VmFsdWVNYXBwZWRCeU1ldGFEYXRh\nKCk7CiAgICB9CgogICAgcHVibGljIENvbHVtbltdIGdldENvbHVtbnMoKSB7\nCiAgICAgICAgaWYgKF9jb2xzLmxlbmd0aCAhPSAwKQogICAgICAgICAgICBy\nZXR1cm4gX2NvbHM7CiAgICAgICAgaWYgKF9mayAhPSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gX2ZrLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoZ2V0\nVmFsdWVNYXBwZWRCeSgpICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBn\nZXRWYWx1ZU1hcHBlZEJ5TWFwcGluZygpLmdldENvbHVtbnMoKTsKICAgICAg\nICByZXR1cm4gX2NvbHM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29s\ndW1ucyhDb2x1bW5bXSBjb2xzKSB7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVs\nbCkKICAgICAgICAgICAgY29scyA9IFNjaGVtYXMuRU1QVFlfQ09MVU1OUzsK\nICAgICAgICBfY29scyA9IGNvbHM7CiAgICB9CgogICAgcHVibGljIENvbHVt\nbklPIGdldENvbHVtbklPKCkgewogICAgICAgIGlmIChfY29scy5sZW5ndGgg\nPT0gMCAmJiBfZmsgPT0gbnVsbCAmJiBnZXRWYWx1ZU1hcHBlZEJ5KCkgIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGdldFZhbHVlTWFwcGVkQnlNYXBw\naW5nKCkuZ2V0Q29sdW1uSU8oKTsKICAgICAgICByZXR1cm4gKF9pbyA9PSBu\ndWxsKSA/IENvbHVtbklPLlVOUkVTVFJJQ1RFRCA6IF9pbzsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRDb2x1bW5JTyhDb2x1bW5JTyBpbykgewogICAg\nICAgIF9pbyA9IGlvOwogICAgfQoKICAgIHB1YmxpYyBGb3JlaWduS2V5IGdl\ndEZvcmVpZ25LZXkoKSB7CiAgICAgICAgaWYgKF9mayA9PSBudWxsICYmIGdl\ndFZhbHVlTWFwcGVkQnkoKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZ2V0VmFsdWVNYXBwZWRCeU1hcHBpbmcoKS5nZXRGb3JlaWduS2V5KCk7CiAg\nICAgICAgcmV0dXJuIF9mazsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRG\nb3JlaWduS2V5KEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBfZmsgPSBmazsK\nICAgICAgICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgX2pvaW4gPSBK\nT0lOX0ZPUldBUkQ7CiAgICB9CgogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0\nRm9yZWlnbktleShDbGFzc01hcHBpbmcgdGFyZ2V0KSB7CiAgICAgICAgaWYg\nKF9mayA9PSBudWxsICYmIGdldFZhbHVlTWFwcGVkQnkoKSAhPSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWVNYXBwZWRCeU1hcHBpbmcoKS5n\nZXRGb3JlaWduS2V5KHRhcmdldCk7CiAgICAgICAgaWYgKHRhcmdldCA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gX2ZrOwogICAgICAgIGlmIChfZmsg\nPT0gbnVsbCAmJiBfY29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIC8vIGFsd2F5cyB1c2UgbGVhc3QtZGVyaXZl\nZCBqb2luYWJsZSB0eXBlCiAgICAgICAgZm9yIChDbGFzc01hcHBpbmcgc3Vw\nID0gdGFyZ2V0OyBzdXAgIT0gbnVsbDsKICAgICAgICAgICAgc3VwID0gc3Vw\nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpKSB7CiAgICAgICAg\nICAgIGlmIChzdXAgPT0gZ2V0VHlwZU1ldGFEYXRhKCkpCiAgICAgICAgICAg\nICAgICByZXR1cm4gX2ZrOwogICAgICAgICAgICB0YXJnZXQgPSBzdXA7CiAg\nICAgICAgfQoKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAg\nICAgICAgaWYgKF90YXJnZXRGS3MgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgT2JqZWN0IGNhY2hlZEZLID0gX3RhcmdldEZLcy5nZXQodGFyZ2V0KTsK\nICAgICAgICAgICAgICAgIGlmIChjYWNoZWRGSyAhPSBudWxsKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiAoRm9yZWlnbktleSkgY2FjaGVkRks7CiAg\nICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgX3RhcmdldEZLcyA9\nIG5ldyBIYXNoTWFwKCk7CgogICAgICAgICAgICBGb3JlaWduS2V5IG5ld2Zr\nID0gKF9qb2luID09IEpPSU5fRk9SV0FSRCkKICAgICAgICAgICAgICAgID8g\nbmV3Rm9yd2FyZEZvcmVpZ25LZXkodGFyZ2V0KSA6IG5ld0ludmVyc2VGb3Jl\naWduS2V5KHRhcmdldCk7CiAgICAgICAgICAgIF90YXJnZXRGS3MucHV0KHRh\ncmdldCwgbmV3ZmspOwogICAgICAgICAgICByZXR1cm4gbmV3Zms7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgZm9yd2FyZCBm\nb3JlaWduIGtleSB0byB0aGUgZ2l2ZW4gdGFyZ2V0LgogICAgICovCiAgICBw\ncml2YXRlIEZvcmVpZ25LZXkgbmV3Rm9yd2FyZEZvcmVpZ25LZXkoQ2xhc3NN\nYXBwaW5nIHRhcmdldCkgewogICAgICAgIFRhYmxlIHRhYmxlOwogICAgICAg\nIENvbHVtbltdIGNvbHM7CiAgICAgICAgaWYgKF9mayA9PSBudWxsKSB7CiAg\nICAgICAgICAgIHRhYmxlID0gX2NvbHNbMF0uZ2V0VGFibGUoKTsKICAgICAg\nICAgICAgY29scyA9IF9jb2xzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIHRhYmxlID0gX2ZrLmdldFRhYmxlKCk7CiAgICAgICAgICAgIGNvbHMg\nPSBfZmsuZ2V0Q29sdW1ucygpOwogICAgICAgIH0KCiAgICAgICAgLy8gZ2F0\naGVyIHRhcmdldCBjb2xzIGJlZm9yZSBhZGRpbmcgZm9yZWlnbiBrZXkgdG8g\ndGFibGUgaW4gY2FzZQogICAgICAgIC8vIHRoZXJlIGlzIGFuIGVycm9yIHdo\naWxlIGxvb2tpbmcgZm9yIGEgdGFyZ2V0IGNvbAogICAgICAgIENvbHVtbltd\nIHRjb2xzID0gbmV3IENvbHVtbltjb2xzLmxlbmd0aF07CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIGlmIChjb2xzW2ldLmdldFRhcmdldEZpZWxkKCkgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHRjb2xzW2ldID0gZ2V0RXF1aXZhbGVudENvbHVtbihj\nb2xzW2ldLCB0YXJnZXQsCiAgICAgICAgICAgICAgICAgICAgY29sc1tpXS5n\nZXRUYXJnZXRGaWVsZCgpKTsKICAgICAgICAgICAgZWxzZSBpZiAoX2ZrICE9\nIG51bGwpCiAgICAgICAgICAgICAgICB0Y29sc1tpXSA9IGdldEVxdWl2YWxl\nbnRDb2x1bW4oX2ZrLmdldFByaW1hcnlLZXlDb2x1bW4KICAgICAgICAgICAg\nICAgICAgICAoY29sc1tpXSkuZ2V0TmFtZSgpLCB0YXJnZXQsIHRydWUpOwog\nICAgICAgICAgICBlbHNlIGlmIChjb2xzW2ldLmdldFRhcmdldCgpICE9IG51\nbGwpCiAgICAgICAgICAgICAgICB0Y29sc1tpXSA9IGdldEVxdWl2YWxlbnRD\nb2x1bW4oY29sc1tpXS5nZXRUYXJnZXQoKSwgdGFyZ2V0LAogICAgICAgICAg\nICAgICAgICAgIHRydWUpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAg\nICAgICB0Y29sc1tpXSA9IGdldEVxdWl2YWxlbnRDb2x1bW4oY29sc1tpXS5n\nZXROYW1lKCksIHRhcmdldCwKICAgICAgICAgICAgICAgICAgICBmYWxzZSk7\nCiAgICAgICAgfQoKICAgICAgICBGb3JlaWduS2V5IG5ld2ZrID0gdGFibGUu\nYWRkRm9yZWlnbktleSgpOwogICAgICAgIG5ld2ZrLnNldEpvaW5zKGNvbHMs\nIHRjb2xzKTsKICAgICAgICBpZiAoX2ZrICE9IG51bGwpIHsKICAgICAgICAg\nICAgY29scyA9IF9may5nZXRDb25zdGFudENvbHVtbnMoKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAg\nICAgICAgICAgICAgbmV3Zmsuam9pbkNvbnN0YW50KGNvbHNbaV0sIF9may5n\nZXRDb25zdGFudChjb2xzW2ldKSk7CgogICAgICAgICAgICBjb2xzID0gX2Zr\nLmdldENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgbmV3Zmsuam9pbkNvbnN0YW50KF9may5nZXRQcmltYXJ5S2V5\nQ29uc3RhbnQoY29sc1tpXSksCiAgICAgICAgICAgICAgICAgICAgZ2V0RXF1\naXZhbGVudENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSwgdGFyZ2V0LCB0cnVl\nKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXdmazsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgZ2l2ZW4gbWFwcGluZydzIGVxdWl2\nYWxlbnQgdG8gdGhlIGdpdmVuIGNvbHVtbiwgdXNpbmcgdGhlCiAgICAgKiB0\nYXJnZXQgZmllbGQuCiAgICAgKi8KICAgIHByaXZhdGUgQ29sdW1uIGdldEVx\ndWl2YWxlbnRDb2x1bW4oQ29sdW1uIGNvbCwgQ2xhc3NNYXBwaW5nIHRhcmdl\ndCwKICAgICAgICBTdHJpbmcgZmllbGROYW1lKSB7CiAgICAgICAgZmllbGRO\nYW1lID0gZmllbGROYW1lLnN1YnN0cmluZyhmaWVsZE5hbWUuaW5kZXhPZign\nLicpICsgMSk7CiAgICAgICAgRmllbGRNYXBwaW5nIGZpZWxkID0gdGFyZ2V0\nLmdldEZpZWxkTWFwcGluZyhmaWVsZE5hbWUpOwogICAgICAgIGlmIChmaWVs\nZCA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vLWVxdWl2LWZpZWxkIiwKICAgICAgICAgICAg\nICAgIG5ldyBPYmplY3RbXXsgdGhpcywgdGFyZ2V0LCBmaWVsZE5hbWUsIGNv\nbCB9KSk7CgogICAgICAgIENvbHVtbltdIGNvbHMgPSBmaWVsZC5nZXRDb2x1\nbW5zKCk7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoICE9IDEpCiAgICAgICAg\nICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFk\nLWVxdWl2LWZpZWxkIiwKICAgICAgICAgICAgICAgIG5ldyBPYmplY3RbXXsg\ndGhpcywgdGFyZ2V0LCBmaWVsZE5hbWUsIGNvbCB9KSk7CgogICAgICAgIHJl\ndHVybiBjb2xzWzBdOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBnaXZlbiBtYXBwaW5nJ3MgZXF1aXZhbGVudCBvZiB0aGUgZ2l2ZW4gY29s\ndW1uLgogICAgICovCiAgICBwcml2YXRlIENvbHVtbiBnZXRFcXVpdmFsZW50\nQ29sdW1uKFN0cmluZyBjb2xOYW1lLCBDbGFzc01hcHBpbmcgdGFyZ2V0LAog\nICAgICAgIGJvb2xlYW4gZXhwbGljaXQpIHsKICAgICAgICAvLyBpZiB0aGVy\nZSB3YXMgbm8gZXhwbGljaXQgdGFyZ2V0LCB1c2Ugc2luZ2xlIHBrIGNvbHVt\nbgogICAgICAgIGlmICghZXhwbGljaXQpIHsKICAgICAgICAgICAgZm9yIChD\nbGFzc01hcHBpbmcgY2xzID0gdGFyZ2V0OyBjbHMgIT0gbnVsbDsKICAgICAg\nICAgICAgICAgIGNscyA9IGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01h\ncHBpbmcoKSkgewogICAgICAgICAgICAgICAgaWYgKGNscy5nZXRUYWJsZSgp\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2xzLmdldFBy\naW1hcnlLZXlDb2x1bW5zKCkubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybiBjbHMuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKVsw\nXTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQ29sdW1uIHJl\ndDsKICAgICAgICBmb3IgKENsYXNzTWFwcGluZyBjbHMgPSB0YXJnZXQ7IGNs\ncyAhPSBudWxsOwogICAgICAgICAgICBjbHMgPSBjbHMuZ2V0Sm9pbmFibGVQ\nQ1N1cGVyY2xhc3NNYXBwaW5nKCkpIHsKICAgICAgICAgICAgaWYgKGNscy5n\nZXRUYWJsZSgpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldCA9IGNs\ncy5nZXRUYWJsZSgpLmdldENvbHVtbihjb2xOYW1lKTsKICAgICAgICAgICAg\nICAgIGlmIChyZXQgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gcmV0OwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLWVxdWl2LWNv\nbCIsIHRoaXMsIHRhcmdldCwKICAgICAgICAgICAgY29sTmFtZSkpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFuIGludmVyc2UgZm9yZWlnbiBr\nZXkgZnJvbSB0aGUgZ2l2ZW4gcmVsYXRlZCB0eXBlIHRvIG91ciB0YWJsZS4K\nICAgICAqLwogICAgcHJpdmF0ZSBGb3JlaWduS2V5IG5ld0ludmVyc2VGb3Jl\naWduS2V5KENsYXNzTWFwcGluZyB0YXJnZXQpIHsKICAgICAgICBGaWVsZE1h\ncHBpbmcgZmllbGQgPSBnZXRGaWVsZE1hcHBpbmcoKTsKICAgICAgICBGaWVs\nZE1hcHBpbmcgbWFwcGVkID0gZmllbGQuZ2V0TWFwcGVkQnlNYXBwaW5nKCk7\nCiAgICAgICAgaWYgKG1hcHBlZCA9PSBudWxsKQogICAgICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImNhbnQtaW52ZXJz\nZSIsIHRoaXMpKTsKCiAgICAgICAgbWFwcGVkID0gdGFyZ2V0LmdldEZpZWxk\nTWFwcGluZyhtYXBwZWQuZ2V0SW5kZXgoKSk7CiAgICAgICAgaWYgKG1hcHBl\nZCA9PSBudWxsIHx8IG1hcHBlZC5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBl\ncy5QQykKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJuby1lcXVpdi1tYXBwZWQtYnkiLAogICAgICAgICAgICAg\nICAgdGhpcywgdGFyZ2V0LCBmaWVsZC5nZXRNYXBwZWRCeSgpKSk7CiAgICAg\nICAgcmV0dXJuIG1hcHBlZC5nZXRGb3JlaWduS2V5KCk7CiAgICB9CgogICAg\ncHVibGljIGludCBnZXRKb2luRGlyZWN0aW9uKCkgewogICAgICAgIGlmIChf\nZmsgPT0gbnVsbCAmJiBnZXRWYWx1ZU1hcHBlZEJ5KCkgIT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGdldFZhbHVlTWFwcGVkQnlNYXBwaW5nKCkuZ2V0\nSm9pbkRpcmVjdGlvbigpOwogICAgICAgIHJldHVybiBfam9pbjsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRKb2luRGlyZWN0aW9uKGludCBkaXJlY3Rp\nb24pIHsKICAgICAgICBfam9pbiA9IGRpcmVjdGlvbjsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRGb3JlaWduS2V5KFJvdyByb3csIE9wZW5KUEFTdGF0\nZU1hbmFnZXIgcmVsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGlmIChyZWwgIT0gbnVsbCkKICAgICAgICAgICAgcm93LnNldEZv\ncmVpZ25LZXkoZ2V0Rm9yZWlnbktleSgoQ2xhc3NNYXBwaW5nKSByZWwuZ2V0\nTWV0YURhdGEoKSksCiAgICAgICAgICAgICAgICBfaW8sIHJlbCk7CiAgICAg\nICAgZWxzZSBpZiAoX2ZrICE9IG51bGwpCiAgICAgICAgICAgIHJvdy5zZXRG\nb3JlaWduS2V5KF9maywgX2lvLCBudWxsKTsKICAgICAgICBlbHNlIHsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICAgICAgaWYgKF9pbyA9PSBudWxsIHx8IChyb3cu\nZ2V0QWN0aW9uKCkgPT0gUm93LkFDVElPTl9JTlNFUlQKICAgICAgICAgICAg\nICAgICAgICAmJiBfaW8uaXNJbnNlcnRhYmxlKGksIHRydWUpKQogICAgICAg\nICAgICAgICAgICAgIHx8IChyb3cuZ2V0QWN0aW9uKCkgIT0gUm93LkFDVElP\nTl9JTlNFUlQKICAgICAgICAgICAgICAgICAgICAmJiBfaW8uaXNVcGRhdGFi\nbGUoaSwgdHJ1ZSkpKQogICAgICAgICAgICAgICAgICAgIHJvdy5zZXROdWxs\nKF9jb2xzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB3aGVyZUZvcmVpZ25LZXkoUm93IHJvdywgT3BlbkpQ\nQVN0YXRlTWFuYWdlciByZWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHJlbCAhPSBudWxsKQogICAgICAgICAgICByb3cu\nd2hlcmVGb3JlaWduS2V5KGdldEZvcmVpZ25LZXkoKENsYXNzTWFwcGluZykK\nICAgICAgICAgICAgICAgIHJlbC5nZXRNZXRhRGF0YSgpKSwgcmVsKTsKICAg\nICAgICBlbHNlIGlmIChfZmsgIT0gbnVsbCkKICAgICAgICAgICAgcm93Lndo\nZXJlRm9yZWlnbktleShfZmssIG51bGwpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgICAgIHJvdy53aGVyZU51bGwoX2NvbHNbaV0pOwogICAg\nfQoKICAgIHB1YmxpYyBDbGFzc01hcHBpbmdbXSBnZXRJbmRlcGVuZGVudFR5\ncGVNYXBwaW5ncygpIHsKICAgICAgICBDbGFzc01hcHBpbmcgcmVsID0gZ2V0\nVHlwZU1hcHBpbmcoKTsKICAgICAgICBpZiAocmVsID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBDbGFzc01hcHBpbmcuRU1QVFlfTUFQUElOR1M7CiAg\nICAgICAgaWYgKF9wb2x5ICE9IFBPTFlfVFJVRSkgewogICAgICAgICAgICBp\nZiAoIXJlbC5pc01hcHBlZCgpKQogICAgICAgICAgICAgICAgcmV0dXJuIENs\nYXNzTWFwcGluZy5FTVBUWV9NQVBQSU5HUzsKICAgICAgICAgICAgaWYgKF90\neXBlQXJyID09IG51bGwpCiAgICAgICAgICAgICAgICBfdHlwZUFyciA9IG5l\ndyBDbGFzc01hcHBpbmdbXXsgcmVsIH07CiAgICAgICAgICAgIHJldHVybiBf\ndHlwZUFycjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlbC5nZXRJbmRl\ncGVuZGVudEFzc2lnbmFibGVNYXBwaW5ncygpOwogICAgfQoKICAgIHB1Ymxp\nYyBpbnQgZ2V0U2VsZWN0U3ViY2xhc3NlcygpIHsKICAgICAgICBDbGFzc01h\ncHBpbmcgcmVsID0gZ2V0VHlwZU1hcHBpbmcoKTsKICAgICAgICBpZiAocmVs\nID09IG51bGwgfHwgIXJlbC5pc01hcHBlZCgpKQogICAgICAgICAgICByZXR1\ncm4gLTE7CgogICAgICAgIHN3aXRjaCAoX3BvbHkpIHsKICAgICAgICAgICAg\nY2FzZSBQT0xZX0ZBTFNFOgogICAgICAgICAgICAgICAgcmV0dXJuIChfY3Jp\ndGVyaWEpID8gU2VsZWN0LlNVQlNfTk9ORSA6IFNlbGVjdC5TVUJTX0VYQUNU\nOwogICAgICAgICAgICBjYXNlIFBPTFlfVFJVRToKICAgICAgICAgICAgICAg\nIENsYXNzTWFwcGluZ1tdIGFzc2lnbiA9IHJlbC5nZXRJbmRlcGVuZGVudEFz\nc2lnbmFibGVNYXBwaW5ncygpOwogICAgICAgICAgICAgICAgaWYgKGFzc2ln\nbi5sZW5ndGggIT0gMSB8fCBhc3NpZ25bMF0gIT0gcmVsKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgIC8vIG5vIGJy\nZWFrCiAgICAgICAgICAgIGNhc2UgUE9MWV9KT0lOQUJMRToKICAgICAgICAg\nICAgICAgIHJldHVybiAoX2NyaXRlcmlhKSA/IFNlbGVjdC5TVUJTX0pPSU5B\nQkxFCiAgICAgICAgICAgICAgICAgICAgOiBTZWxlY3QuU1VCU19BTllfSk9J\nTkFCTEU7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIFVuaXF1ZSBnZXRWYWx1ZVVuaXF1ZSgpIHsKICAgICAg\nICByZXR1cm4gX3VucTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1\nZVVuaXF1ZShVbmlxdWUgdW5xKSB7CiAgICAgICAgX3VucSA9IHVucTsKICAg\nIH0KCiAgICBwdWJsaWMgSW5kZXggZ2V0VmFsdWVJbmRleCgpIHsKICAgICAg\nICByZXR1cm4gX2lkeDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1\nZUluZGV4KEluZGV4IGlkeCkgewogICAgICAgIF9pZHggPSBpZHg7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gZ2V0VXNlQ2xhc3NDcml0ZXJpYSgpIHsK\nICAgICAgICBpZiAoX2ZrID09IG51bGwgJiYgZ2V0VmFsdWVNYXBwZWRCeSgp\nICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZU1hcHBlZEJ5\nTWFwcGluZygpLmdldFVzZUNsYXNzQ3JpdGVyaWEoKTsKICAgICAgICByZXR1\ncm4gX2NyaXRlcmlhOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVzZUNs\nYXNzQ3JpdGVyaWEoYm9vbGVhbiBjcml0ZXJpYSkgewogICAgICAgIF9jcml0\nZXJpYSA9IGNyaXRlcmlhOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0UG9s\neW1vcnBoaWMoKSB7CiAgICAgICAgcmV0dXJuIF9wb2x5OwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldFBvbHltb3JwaGljKGludCBwb2x5KSB7CiAgICAg\nICAgX3BvbHkgPSBwb2x5OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZlNj\naGVtYUNvbXBvbmVudHMoKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgX2NvbHNbaV0ucmVm\nKCk7CiAgICAgICAgaWYgKF9mayAhPSBudWxsKSB7CiAgICAgICAgICAgIF9m\nay5yZWYoKTsKICAgICAgICAgICAgX2ZrLnJlZkNvbHVtbnMoKTsKICAgICAg\nICB9CgogICAgICAgIENsYXNzTWFwcGluZyBlbWJlZCA9IGdldEVtYmVkZGVk\nTWFwcGluZygpOwogICAgICAgIGlmIChlbWJlZCAhPSBudWxsKQogICAgICAg\nICAgICBlbWJlZC5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgbWFwQ29uc3RyYWludHMoU3RyaW5nIG5hbWUsIGJvb2xl\nYW4gYWRhcHQpIHsKICAgICAgICBfdW5xID0gX2luZm8uZ2V0VW5pcXVlKHRo\naXMsIG5hbWUsIGFkYXB0KTsKICAgICAgICBfaWR4ID0gX2luZm8uZ2V0SW5k\nZXgodGhpcywgbmFtZSwgYWRhcHQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGNsZWFyTWFwcGluZygpIHsKICAgICAgICBfaGFuZGxlciA9IG51bGw7CiAg\nICAgICAgX2NvbHMgPSBTY2hlbWFzLkVNUFRZX0NPTFVNTlM7CiAgICAgICAg\nX3VucSA9IG51bGw7CiAgICAgICAgX2lkeCA9IG51bGw7CiAgICAgICAgX2Zr\nID0gbnVsbDsKICAgICAgICBfam9pbiA9IEpPSU5fRk9SV0FSRDsKICAgICAg\nICBfaW5mby5jbGVhcigpOwogICAgICAgIHNldFJlc29sdmUoTU9ERV9NQVBQ\nSU5HIHwgTU9ERV9NQVBQSU5HX0lOSVQsIGZhbHNlKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzeW5jTWFwcGluZ0luZm8oKSB7CiAgICAgICAgaWYgKGdl\ndFZhbHVlTWFwcGVkQnkoKSAhPSBudWxsKQogICAgICAgICAgICBfaW5mby5j\nbGVhcigpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBfaW5mby5zeW5j\nV2l0aCh0aGlzKTsKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGVtYmVkID0g\nZ2V0RW1iZWRkZWRNYXBwaW5nKCk7CiAgICAgICAgICAgIGlmIChlbWJlZCAh\nPSBudWxsKQogICAgICAgICAgICAgICAgZW1iZWQuc3luY01hcHBpbmdJbmZv\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvcHlNYXBw\naW5nSW5mbyhWYWx1ZU1hcHBpbmcgdm0pIHsKICAgICAgICBzZXRWYWx1ZU1h\ncHBlZEJ5KHZtLmdldFZhbHVlTWFwcGVkQnkoKSk7CiAgICAgICAgc2V0UG9s\neW1vcnBoaWModm0uZ2V0UG9seW1vcnBoaWMoKSk7CiAgICAgICAgX2luZm8u\nY29weSh2bS5nZXRWYWx1ZUluZm8oKSk7CgogICAgICAgIENsYXNzTWFwcGlu\nZyBlbWJlZCA9IHZtLmdldEVtYmVkZGVkTWFwcGluZygpOwogICAgICAgIGlm\nIChlbWJlZCAhPSBudWxsICYmIGdldEVtYmVkZGVkTWFwcGluZygpICE9IG51\nbGwpIHsKICAgICAgICAgICAgRmllbGRNYXBwaW5nW10gdG1wbGF0ZXMgPSBl\nbWJlZC5nZXRGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgICAgIEZpZWxkTWFw\ncGluZ1tdIGZtcyA9IGdldEVtYmVkZGVkTWFwcGluZygpLmdldEZpZWxkTWFw\ncGluZ3MoKTsKICAgICAgICAgICAgaWYgKHRtcGxhdGVzLmxlbmd0aCA9PSBm\nbXMubGVuZ3RoKQogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBmbXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgZm1zW2ld\nLmNvcHlNYXBwaW5nSW5mbyh0bXBsYXRlc1tpXSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIHJlc29sdmUoaW50IG1vZGUpIHsKICAg\nICAgICBpbnQgY3VyID0gZ2V0UmVzb2x2ZSgpOwogICAgICAgIGlmIChzdXBl\nci5yZXNvbHZlKG1vZGUpKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nICAgICBDbGFzc01hcHBpbmcgZW1iZWQgPSBnZXRFbWJlZGRlZE1hcHBpbmco\nKTsKICAgICAgICBpZiAoZW1iZWQgIT0gbnVsbCkKICAgICAgICAgICAgZW1i\nZWQucmVzb2x2ZShtb2RlKTsKICAgICAgICBpZiAoKG1vZGUgJiBNT0RFX01B\nUFBJTkcpICE9IDAgJiYgKGN1ciAmIE1PREVfTUFQUElORykgPT0gMCkKICAg\nICAgICAgICAgcmVzb2x2ZU1hcHBpbmcoKTsKICAgICAgICBpZiAoKG1vZGUg\nJiBNT0RFX01BUFBJTkdfSU5JVCkgIT0gMCAmJiAoY3VyICYgTU9ERV9NQVBQ\nSU5HX0lOSVQpID09IDApCiAgICAgICAgICAgIGluaXRpYWxpemVNYXBwaW5n\nKCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0dXAgbWFwcGluZy4gT3VyIGhhbmRsZXIgd2lsbCBhbHJlYWR5IGhh\ndmUgYmVlbiBzZXQgYnkgb3VyIG93bmluZwogICAgICogZmllbGQuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCByZXNvbHZlTWFwcGluZygpIHsKICAgICAg\nICAvLyBtYXJrIG1hcHBlZCBjb2x1bW5zCiAgICAgICAgQ29sdW1uW10gY29s\nczsKICAgICAgICBpbnQgaW5zZXJ0RmxhZzsKICAgICAgICBpZiAoX2ZrICE9\nIG51bGwpIHsKICAgICAgICAgICAgY29scyA9IF9may5nZXRDb2x1bW5zKCk7\nCiAgICAgICAgICAgIGluc2VydEZsYWcgPSBDb2x1bW4uRkxBR19GS19JTlNF\nUlQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29scyA9IGdldENv\nbHVtbnMoKTsKICAgICAgICAgICAgaW5zZXJ0RmxhZyA9IENvbHVtbi5GTEFH\nX0RJUkVDVF9JTlNFUlQ7CiAgICAgICAgfQogICAgICAgIENvbHVtbklPIGlv\nID0gZ2V0Q29sdW1uSU8oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGNvbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGlvLmlzSW5z\nZXJ0YWJsZShpLCBmYWxzZSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNl\ndEZsYWcoaW5zZXJ0RmxhZywgdHJ1ZSk7CiAgICAgICAgICAgIGlmIChpby5p\nc1VwZGF0YWJsZShpLCBmYWxzZSkpCiAgICAgICAgICAgICAgICBjb2xzW2ld\nLnNldEZsYWcoaW5zZXJ0RmxhZywgdHJ1ZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUHJlcGFyZSBtYXBwaW5nIGZvciBydW50aW1lIHVz\nZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGluaXRpYWxpemVNYXBwaW5n\nKCkgewogICAgICAgIGlmIChfZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuOwoKICAgICAgICAvLyBpZiBvdXIgZmsgY29scyBhcmUgZGlyZWN0IG1h\ncHBlZCBieSBvdGhlciB2YWx1ZXMsIG1ha2UgdGhlbQogICAgICAgIC8vIG5v\nbi1udWxsYWJsZQogICAgICAgIENvbHVtbltdIGNvbHMgPSBfZmsuZ2V0Q29s\ndW1ucygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoY29sc1tpXS5nZXRGbGFnKENv\nbHVtbi5GTEFHX0RJUkVDVF9JTlNFUlQpKQogICAgICAgICAgICAgICAgbmV3\nSU8oKS5zZXROdWxsSW5zZXJ0YWJsZShpLCBmYWxzZSk7CiAgICAgICAgICAg\nIGlmIChjb2xzW2ldLmdldEZsYWcoQ29sdW1uLkZMQUdfRElSRUNUX1VQREFU\nRSkpCiAgICAgICAgICAgICAgICBuZXdJTygpLnNldE51bGxVcGRhdGFibGUo\naSwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgYW55dGhpbmcg\nbWFwcyBvdXIgY29uc3RhbnQgZmsgY29scywgbWFrZSB0aGVtIHJlYWQgb25s\neQogICAgICAgIGludCBsZW4gPSBjb2xzLmxlbmd0aDsKICAgICAgICBjb2xz\nID0gX2ZrLmdldENvbnN0YW50Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBp\nZiAoY29sc1tpXS5nZXRGbGFnKENvbHVtbi5GTEFHX0RJUkVDVF9JTlNFUlQp\nCiAgICAgICAgICAgICAgICB8fCBjb2xzW2ldLmdldEZsYWcoQ29sdW1uLkZM\nQUdfRktfSU5TRVJUKSkKICAgICAgICAgICAgICAgIG5ld0lPKCkuc2V0SW5z\nZXJ0YWJsZShsZW4gKyBpLCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChjb2xz\nW2ldLmdldEZsYWcoQ29sdW1uLkZMQUdfRElSRUNUX1VQREFURSkKICAgICAg\nICAgICAgICAgIHx8IGNvbHNbaV0uZ2V0RmxhZyhDb2x1bW4uRkxBR19GS19V\nUERBVEUpKQogICAgICAgICAgICAgICAgbmV3SU8oKS5zZXRVcGRhdGFibGUo\nbGVuICsgaSwgZmFsc2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgY29sdW1uIEkvTyBpbmZvcm1hdGlvbiwgY3JlYXRp\nbmcgaXQgaWYgbmVjZXNzYXJ5LgogICAgICovCiAgICBwcml2YXRlIENvbHVt\nbklPIG5ld0lPKCkgewogICAgICAgIGlmIChfaW8gPT0gbnVsbCkKICAgICAg\nICAgICAgX2lvID0gbmV3IENvbHVtbklPKCk7CiAgICAgICAgcmV0dXJuIF9p\nbzsKICAgIH0KfQo=\n","encoding":"base64"}

