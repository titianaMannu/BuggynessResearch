{"sha":"d3cb0022ca7c864c9ff9682321ae32d887116c89","node_id":"MDQ6QmxvYjIwNjM2NDpkM2NiMDAyMmNhN2M4NjRjOWZmOTY4MjMyMWFlMzJkODg3MTE2Yzg5","size":9046,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d3cb0022ca7c864c9ff9682321ae32d887116c89","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1wb3J0IGphdmEubWF0aC5C\naWdEZWNpbWFsOwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbXBhcmF0b3I7CgppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5WZXJzaW9uTWFwcGluZ0luZm87\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVt\nbklPOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLklu\nZGV4OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJlc3Vs\ndDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Sb3c7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93TWFuYWdlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3Q7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1h\nbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3Jl\nTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5M\nb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZh\nVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0\nYUV4Y2VwdGlvbjsKCi8qKgogKiBVc2VzIGEgc2luZ2xlIGNvbHVtbiBhbmQg\nY29ycmVzcG9uZGluZyB2ZXJzaW9uIG9iamVjdC4KICoKICogQGF1dGhvciBN\nYXJjIFBydWQnaG9tbWVhdXgKICovCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBD\nb2x1bW5WZXJzaW9uU3RyYXRlZ3kKICAgIGV4dGVuZHMgQWJzdHJhY3RWZXJz\naW9uU3RyYXRlZ3kgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoQ29s\ndW1uVmVyc2lvblN0cmF0ZWd5LmNsYXNzKTsKCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgY29kZSBmcm9tIHtAbGluayBKYXZhVHlwZXN9IGZvciB0aGUg\ndmVyc2lvbiB2YWx1ZXMgdGhpcwogICAgICogc3RyYXRlZ3kgdXNlcy4gVGhp\ncyBtZXRob2QgaXMgb25seSB1c2VkIGR1cmluZyBtYXBwaW5nIGluc3RhbGxh\ndGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IGludCBnZXRK\nYXZhVHlwZSgpOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBuZXh0IHZl\ncnNpb24gZ2l2ZW4gdGhlIGN1cnJlbnQgb25lLCB3aGljaCBtYXkgYmUgbnVs\nbC4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IE9iamVjdCBuZXh0\nVmVyc2lvbihPYmplY3QgdmVyc2lvbik7CgogICAgLyoqCiAgICAgKiBDb21w\nYXJlIHRoZSB0d28gdmVyc2lvbnMuIERlZmF1bHRzIHRvIGFzc3VtaW5nIHRo\nZSB2ZXJzaW9uIG9iamVjdHMKICAgICAqIGltcGxlbWVudCB7QGxpbmsgQ29t\ncGFyYWJsZX0uCiAgICAgKgogICAgICogQHNlZSBDb21wYXJhdG9yI2NvbXBh\ncmUKICAgICAqLwogICAgcHJvdGVjdGVkIGludCBjb21wYXJlKE9iamVjdCB2\nMSwgT2JqZWN0IHYyKSB7CiAgICAgICAgaWYgKHYxID09IHYyKQogICAgICAg\nICAgICByZXR1cm4gMDsKICAgICAgICBpZiAodjEgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIC0xOwogICAgICAgIGlmICh2MiA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gMTsKCiAgICAgICAgaWYgKHYxLmdldENsYXNzKCkg\nIT0gdjIuZ2V0Q2xhc3MoKSkgewogICAgICAgICAgICBpZiAodjEgaW5zdGFu\nY2VvZiBOdW1iZXIgJiYgISh2MSBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwpKQog\nICAgICAgICAgICAgICAgdjEgPSBuZXcgQmlnRGVjaW1hbCgoKE51bWJlcikg\ndjEpLmRvdWJsZVZhbHVlKCkpOwoKICAgICAgICAgICAgaWYgKHYyIGluc3Rh\nbmNlb2YgTnVtYmVyICYmICEodjIgaW5zdGFuY2VvZiBCaWdEZWNpbWFsKSkK\nICAgICAgICAgICAgICAgIHYyID0gbmV3IEJpZ0RlY2ltYWwoKChOdW1iZXIp\nIHYyKS5kb3VibGVWYWx1ZSgpKTsKICAgICAgICB9CgogICAgICAgIHJldHVy\nbiAoKENvbXBhcmFibGUpIHYxKS5jb21wYXJlVG8odjIpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIG1hcChib29sZWFuIGFkYXB0KSB7CiAgICAgICAgQ2xh\nc3NNYXBwaW5nIGNscyA9IHZlcnMuZ2V0Q2xhc3NNYXBwaW5nKCk7CiAgICAg\nICAgaWYgKGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAh\nPSBudWxsCiAgICAgICAgICAgIHx8IGNscy5nZXRFbWJlZGRpbmdNZXRhRGF0\nYSgpICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4\nY2VwdGlvbihfbG9jLmdldCgibm90LWJhc2UtdmVycyIsIGNscykpOwoKICAg\nICAgICBWZXJzaW9uTWFwcGluZ0luZm8gaW5mbyA9IHZlcnMuZ2V0TWFwcGlu\nZ0luZm8oKTsKICAgICAgICBpbmZvLmFzc2VydE5vSm9pbih2ZXJzLCB0cnVl\nKTsKICAgICAgICBpbmZvLmFzc2VydE5vRm9yZWlnbktleSh2ZXJzLCAhYWRh\ncHQpOwogICAgICAgIGluZm8uYXNzZXJ0Tm9VbmlxdWUodmVycywgZmFsc2Up\nOwoKICAgICAgICBDb2x1bW4gdG1wbGF0ZSA9IG5ldyBDb2x1bW4oKTsKICAg\nICAgICB0bXBsYXRlLnNldEphdmFUeXBlKGdldEphdmFUeXBlKCkpOwogICAg\nICAgIHRtcGxhdGUuc2V0TmFtZSgidmVyc24iKTsKCiAgICAgICAgQ29sdW1u\nW10gY29scyA9IGluZm8uZ2V0Q29sdW1ucyh2ZXJzLCBuZXcgQ29sdW1uW117\nIHRtcGxhdGUgfSwgYWRhcHQpOwogICAgICAgIHZlcnMuc2V0Q29sdW1ucyhj\nb2xzKTsKICAgICAgICB2ZXJzLnNldENvbHVtbklPKGluZm8uZ2V0Q29sdW1u\nSU8oKSk7CgogICAgICAgIEluZGV4IGlkeCA9IGluZm8uZ2V0SW5kZXgodmVy\ncywgY29scywgYWRhcHQpOwogICAgICAgIHZlcnMuc2V0SW5kZXgoaWR4KTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbnNlcnQoT3BlbkpQQVN0YXRlTWFu\nYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIENvbHVtbltdIGNv\nbHMgPSB2ZXJzLmdldENvbHVtbnMoKTsKICAgICAgICBDb2x1bW5JTyBpbyA9\nIHZlcnMuZ2V0Q29sdW1uSU8oKTsKICAgICAgICBPYmplY3QgaW5pdGlhbCA9\nIG5leHRWZXJzaW9uKG51bGwpOwogICAgICAgIFJvdyByb3cgPSBybS5nZXRS\nb3codmVycy5nZXRDbGFzc01hcHBpbmcoKS5nZXRUYWJsZSgpLAogICAgICAg\nICAgICBSb3cuQUNUSU9OX0lOU0VSVCwgc20sIHRydWUpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgaWYgKGlvLmlzSW5zZXJ0YWJsZShpLCBpbml0aWFsID09IG51bGwpKQog\nICAgICAgICAgICAgICAgcm93LnNldE9iamVjdChjb2xzW2ldLCBpbml0aWFs\nKTsKCiAgICAgICAgLy8gc2V0IGluaXRpYWwgdmVyc2lvbiBpbnRvIHN0YXRl\nIG1hbmFnZXIKICAgICAgICBPYmplY3QgbmV4dFZlcnNpb247CiAgICAgICAg\nbmV4dFZlcnNpb24gPSBpbml0aWFsOwogICAgICAgIHNtLnNldE5leHRWZXJz\naW9uKG5leHRWZXJzaW9uKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1cGRh\ndGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBS\nb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIENvbHVtbltdIGNvbHMgPSB2ZXJzLmdldENvbHVtbnMoKTsKICAg\nICAgICBpZiAoY29scyA9PSBudWxsIHx8IGNvbHMubGVuZ3RoID09IDAgfHwK\nICAgICAgICAgICAgIXNtLmlzRGlydHkoKSAmJiAhc20uaXNWZXJzaW9uVXBk\nYXRlUmVxdWlyZWQoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBP\nYmplY3QgY3VyVmVyc2lvbiA9IHNtLmdldFZlcnNpb24oKTsKICAgICAgICBP\nYmplY3QgbmV4dFZlcnNpb24gPSBuZXh0VmVyc2lvbihjdXJWZXJzaW9uKTsK\nCiAgICAgICAgUm93IHJvdyA9IHJtLmdldFJvdyh2ZXJzLmdldENsYXNzTWFw\ncGluZygpLmdldFRhYmxlKCksCiAgICAgICAgICAgIFJvdy5BQ1RJT05fVVBE\nQVRFLCBzbSwgdHJ1ZSk7CiAgICAgICAgcm93LnNldEZhaWxlZE9iamVjdChz\nbS5nZXRNYW5hZ2VkSW5zdGFuY2UoKSk7CgogICAgICAgIC8vIHNldCB3aGVy\nZSBhbmQgdXBkYXRlIGNvbmRpdGlvbnMgb24gcm93CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nIGlmIChjdXJWZXJzaW9uICE9IG51bGwgJiYgc20uaXNWZXJzaW9uQ2hlY2tS\nZXF1aXJlZCgpKQogICAgICAgICAgICAgICAgcm93LndoZXJlT2JqZWN0KGNv\nbHNbaV0sIGN1clZlcnNpb24pOwogICAgICAgICAgICBpZiAodmVycy5nZXRD\nb2x1bW5JTygpLmlzVXBkYXRhYmxlKGksIG5leHRWZXJzaW9uID09IG51bGwp\nKQogICAgICAgICAgICAgICAgcm93LnNldE9iamVjdChjb2xzW2ldLCBuZXh0\nVmVyc2lvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAobmV4dFZlcnNpb24g\nIT0gbnVsbCkKICAgICAgICAgICAgc20uc2V0TmV4dFZlcnNpb24obmV4dFZl\ncnNpb24pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRlbGV0ZShPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIg\ncm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgUm93\nIHJvdyA9IHJtLmdldFJvdyh2ZXJzLmdldENsYXNzTWFwcGluZygpLmdldFRh\nYmxlKCksCiAgICAgICAgICAgIFJvdy5BQ1RJT05fREVMRVRFLCBzbSwgdHJ1\nZSk7CiAgICAgICAgcm93LnNldEZhaWxlZE9iamVjdChzbS5nZXRNYW5hZ2Vk\nSW5zdGFuY2UoKSk7CiAgICAgICAgQ29sdW1uW10gY29scyA9IHZlcnMuZ2V0\nQ29sdW1ucygpOwoKICAgICAgICBPYmplY3QgY3VyVmVyc2lvbiA9IHNtLmdl\ndFZlcnNpb24oKTsKICAgICAgICBPYmplY3QgY3VyOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAoY29scy5sZW5ndGggPT0gMSB8fCBjdXJWZXJzaW9uID09IG51bGwp\nCiAgICAgICAgICAgICAgICBjdXIgPSBjdXJWZXJzaW9uOwogICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICBjdXIgPSAoKE9iamVjdFtdKSBjdXJW\nZXJzaW9uKVtpXTsKCiAgICAgICAgICAgIC8vIHNldCB3aGVyZSBhbmQgdXBk\nYXRlIGNvbmRpdGlvbnMgb24gcm93CiAgICAgICAgICAgIGlmIChjdXIgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHJvdy53aGVyZU9iamVjdChjb2xzW2ld\nLCBjdXIpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBz\nZWxlY3QoU2VsZWN0IHNlbCwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcpIHsKICAg\nICAgICBzZWwuc2VsZWN0KHZlcnMuZ2V0Q29sdW1ucygpKTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2FkKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUmVzdWx0IHJl\ncykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyB0\neXBpY2FsbHkgaWYgb25lIHZlcnNpb24gY29sdW1uIGlzIGluIHRoZSByZXN1\nbHQsIHRoZXkgYWxsIGFyZSwgc28KICAgICAgICAvLyBvcHRpbWl6ZSBieSBj\naGVja2luZyBmb3IgdGhlIGZpcnN0IG9uZSBiZWZvcmUgZG9pbmcgYW55IHJl\nYWwgd29yawogICAgICAgIENvbHVtbltdIGNvbHMgPSB2ZXJzLmdldENvbHVt\nbnMoKTsKICAgICAgICBpZiAoIXJlcy5jb250YWlucyhjb2xzWzBdKSkKICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICBPYmplY3QgdmVyc2lvbiA9IG51\nbGw7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4gMCkKICAgICAgICAgICAg\ndmVyc2lvbiA9IG5ldyBPYmplY3RbY29scy5sZW5ndGhdOwogICAgICAgIE9i\namVjdCBjdXI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChpID4gMCAmJiAhcmVzLmNv\nbnRhaW5zKGNvbHNbaV0pKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICBjdXIgPSByZXMuZ2V0T2JqZWN0KGNvbHNbaV0sIC0xLCBudWxs\nKTsKICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEpCiAgICAgICAg\nICAgICAgICB2ZXJzaW9uID0gY3VyOwogICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICAoKE9iamVjdFtdKSB2ZXJzaW9uKVtpXSA9IGN1cjsKICAg\nICAgICB9CiAgICAgICAgc20uc2V0VmVyc2lvbih2ZXJzaW9uKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBjaGVja1ZlcnNpb24oT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIGJvb2xlYW4g\ndXBkYXRlVmVyc2lvbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBDb2x1bW5bXSBjb2xzID0gdmVycy5nZXRDb2x1bW5zKCk7CiAg\nICAgICAgU2VsZWN0IHNlbCA9IHN0b3JlLmdldFNRTEZhY3RvcnkoKS5uZXdT\nZWxlY3QoKTsKICAgICAgICBzZWwuc2VsZWN0KGNvbHMpOwogICAgICAgIHNl\nbC53aGVyZVByaW1hcnlLZXkoc20uZ2V0T2JqZWN0SWQoKSwgdmVycy5nZXRD\nbGFzc01hcHBpbmcoKSwgc3RvcmUpOwoKICAgICAgICBSZXN1bHQgcmVzID0g\nc2VsLmV4ZWN1dGUoc3RvcmUsIG51bGwpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGlmICghcmVzLm5leHQoKSkKICAgICAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKCiAgICAgICAgICAgIE9iamVjdCBtZW1WZXJzaW9uID0gc20u\nZ2V0VmVyc2lvbigpOwogICAgICAgICAgICBPYmplY3QgZGJWZXJzaW9uID0g\nbnVsbDsKICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4gMSkKICAgICAg\nICAgICAgICAgIGRiVmVyc2lvbiA9IG5ldyBPYmplY3RbY29scy5sZW5ndGhd\nOwoKICAgICAgICAgICAgYm9vbGVhbiByZWZyZXNoID0gZmFsc2U7CiAgICAg\nICAgICAgIE9iamVjdCBtZW0sIGRiOwogICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAg\nIGRiID0gcmVzLmdldE9iamVjdChjb2xzW2ldLCAtMSwgbnVsbCk7CiAgICAg\nICAgICAgICAgICBpZiAoY29scy5sZW5ndGggPT0gMSkKICAgICAgICAgICAg\nICAgICAgICBkYlZlcnNpb24gPSBkYjsKICAgICAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgICAgICAoKE9iamVjdFtdKSBkYlZlcnNpb24pW2ld\nID0gZGI7CgogICAgICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZW4ndCBhbHJl\nYWR5IGRldGVybWluZWQgdGhhdCB3ZSBuZWVkIGEgcmVmcmVzaCwKICAgICAg\nICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBtZW0gdmVyc2lvbiBpcyBlYXJs\naWVyIHRoYW4gdGhlIGRiIG9uZQogICAgICAgICAgICAgICAgaWYgKCFyZWZy\nZXNoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09\nIDEgfHwgbWVtVmVyc2lvbiA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nICAgICBtZW0gPSBtZW1WZXJzaW9uOwogICAgICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICAgICAgbWVtID0gKChPYmplY3RbXSkg\nbWVtVmVyc2lvbilbaV07CgogICAgICAgICAgICAgICAgICAgIGlmIChtZW0g\nPT0gbnVsbCB8fCAoZGIgIT0gbnVsbCAmJiBjb21wYXJlKG1lbSwgZGIpIDwg\nMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2ggPSB0cnVlOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBp\nZiAodXBkYXRlVmVyc2lvbikKICAgICAgICAgICAgICAgIHNtLnNldFZlcnNp\nb24oZGJWZXJzaW9uKTsKICAgICAgICAgICAgcmV0dXJuICFyZWZyZXNoOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHJlcy5jbG9zZSgpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IGNvbXBhcmVWZXJzaW9u\nKE9iamVjdCB2MSwgT2JqZWN0IHYyKSB7CiAgICAgICAgaWYgKHYxID09IHYy\nKQogICAgICAgICAgICByZXR1cm4gU3RvcmVNYW5hZ2VyLlZFUlNJT05fU0FN\nRTsKICAgICAgICBpZiAodjEgPT0gbnVsbCB8fCB2MiA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gU3RvcmVNYW5hZ2VyLlZFUlNJT05fRElGRkVSRU5U\nOwoKICAgICAgICBpbnQgY21wID0gY29tcGFyZSh2MSwgdjIpOwogICAgICAg\nIGlmIChjbXAgPCAwKQogICAgICAgICAgICByZXR1cm4gU3RvcmVNYW5hZ2Vy\nLlZFUlNJT05fRUFSTElFUjsKICAgICAgICBpZiAoY21wID4gMCkKICAgICAg\nICAgICAgcmV0dXJuIFN0b3JlTWFuYWdlci5WRVJTSU9OX0xBVEVSOwogICAg\nICAgIHJldHVybiBTdG9yZU1hbmFnZXIuVkVSU0lPTl9TQU1FOwogICAgfQp9\nCg==\n","encoding":"base64"}

