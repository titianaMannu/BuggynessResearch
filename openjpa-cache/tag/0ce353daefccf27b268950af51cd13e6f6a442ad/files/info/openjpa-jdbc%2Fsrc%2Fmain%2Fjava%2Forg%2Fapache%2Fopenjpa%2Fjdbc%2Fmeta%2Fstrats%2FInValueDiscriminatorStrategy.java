{"sha":"01b6add43b8ea8859b0b55a3090d5669eababd53","node_id":"MDQ6QmxvYjIwNjM2NDowMWI2YWRkNDNiOGVhODg1OWIwYjU1YTMwOTBkNTY2OWVhYmFiZDUz","size":5788,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/01b6add43b8ea8859b0b55a3090d5669eababd53","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1wb3J0IGphdmEuc3FsLlNR\nTEV4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5r\nZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5tZXRhLkRpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuSW5kZXg7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuSm9pbnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUmVzdWx0OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJvdzsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNxbC5Sb3dNYW5hZ2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247Cgov\nKioKICogQmFzZSBkaXNjcmltaW5hdG9yIHN0cmF0ZWd5IHRoYXQgZGV0ZXJt\naW5lcyB0aGUgY2xhc3Mgb2YgZGF0YWJhc2UKICogcmVjb3JkcyB1c2luZyBh\nIGNvbHVtbiBob2xkaW5nIGEgdmFsdWUgbWFwcGVkIHRvIGEgY2xhc3MsIGFu\nZCBsaW1pdHMKICogU0VMRUNUcyB1c2luZyBhbiBJTiAoLi4uKSBzdGF0ZW1l\nbnQuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgYWJzdHJh\nY3QgY2xhc3MgSW5WYWx1ZURpc2NyaW1pbmF0b3JTdHJhdGVneQogICAgZXh0\nZW5kcyBBYnN0cmFjdERpc2NyaW1pbmF0b3JTdHJhdGVneSB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZQogICAgICAgIChJblZhbHVlRGlzY3JpbWluYXRvclN0cmF0\nZWd5LmNsYXNzKTsKCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgSmF2YSB0\neXBlIGNvZGUgZnJvbSB7QGxpbmsgSmF2YVR5cGVzfSBmb3IgdGhlIGRpc2Ny\naW1pbmF0b3IKICAgICAqIHZhbHVlcy4gVGhpcyBtZXRob2QgaXMgb25seSB1\nc2VkIGR1cmluZyBtYXBwaW5nIGluc3RhbGxhdGlvbi4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGFic3RyYWN0IGludCBnZXRKYXZhVHlwZSgpOwoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBkaXNjcmltaW5hdG9yIHZhbHVlIGZvciB0\naGUgZ2l2ZW4gdHlwZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIE9iamVjdCBnZXREaXNjcmltaW5hdG9yVmFsdWUoQ2xhc3NNYXBwaW5nIGNs\ncyk7CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBnaXZlbiBkaXNjcmlt\naW5hdG9yIHZhbHVlIHRvIHRoZSBjb3JyZXNwb25kaW5nIGNsYXNzLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgQ2xhc3MgZ2V0Q2xhc3MoT2Jq\nZWN0IHZhbCwgSkRCQ1N0b3JlIHN0b3JlKQogICAgICAgIHRocm93cyBDbGFz\nc05vdEZvdW5kRXhjZXB0aW9uOwoKICAgIHB1YmxpYyB2b2lkIG1hcChib29s\nZWFuIGFkYXB0KSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IGRpc2Mu\nZ2V0Q2xhc3NNYXBwaW5nKCk7CiAgICAgICAgaWYgKGNscy5nZXRKb2luYWJs\nZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBudWxsCiAgICAgICAgICAgIHx8\nIGNscy5nZXRFbWJlZGRpbmdNZXRhRGF0YSgpICE9IG51bGwpCiAgICAgICAg\nICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm90\nLWJhc2UtZGlzYyIsIGNscykpOwoKICAgICAgICBEaXNjcmltaW5hdG9yTWFw\ncGluZ0luZm8gaW5mbyA9IGRpc2MuZ2V0TWFwcGluZ0luZm8oKTsKICAgICAg\nICBpbmZvLmFzc2VydE5vSm9pbihkaXNjLCB0cnVlKTsKICAgICAgICBpbmZv\nLmFzc2VydE5vRm9yZWlnbktleShkaXNjLCAhYWRhcHQpOwogICAgICAgIGlu\nZm8uYXNzZXJ0Tm9VbmlxdWUoZGlzYywgZmFsc2UpOwoKICAgICAgICBDb2x1\nbW4gdG1wbGF0ZSA9IG5ldyBDb2x1bW4oKTsKICAgICAgICB0bXBsYXRlLnNl\ndEphdmFUeXBlKGdldEphdmFUeXBlKCkpOwogICAgICAgIHRtcGxhdGUuc2V0\nTmFtZSgidHlwIik7CgogICAgICAgIENvbHVtbltdIGNvbHMgPSBpbmZvLmdl\ndENvbHVtbnMoZGlzYywgbmV3IENvbHVtbltdeyB0bXBsYXRlIH0sIGFkYXB0\nKTsKICAgICAgICBkaXNjLnNldENvbHVtbnMoY29scyk7CiAgICAgICAgZGlz\nYy5zZXRDb2x1bW5JTyhpbmZvLmdldENvbHVtbklPKCkpOwoKICAgICAgICBJ\nbmRleCBpZHggPSBpbmZvLmdldEluZGV4KGRpc2MsIGNvbHMsIGFkYXB0KTsK\nICAgICAgICBkaXNjLnNldEluZGV4KGlkeCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgaW5zZXJ0KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9y\nZSBzdG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBSb3cgcm93ID0gcm0uZ2V0Um93KGRpc2MuZ2V0\nQ2xhc3NNYXBwaW5nKCkuZ2V0VGFibGUoKSwKICAgICAgICAgICAgUm93LkFD\nVElPTl9JTlNFUlQsIHNtLCB0cnVlKTsKICAgICAgICBPYmplY3QgY2xzID0g\nZ2V0RGlzY3JpbWluYXRvclZhbHVlKChDbGFzc01hcHBpbmcpIHNtLmdldE1l\ndGFEYXRhKCkpOwogICAgICAgIGlmIChkaXNjLmdldENvbHVtbklPKCkuaXNJ\nbnNlcnRhYmxlKDAsIGNscyA9PSBudWxsKSkKICAgICAgICAgICAgcm93LnNl\ndE9iamVjdChkaXNjLmdldENvbHVtbnMoKVswXSwgY2xzKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBzZWxlY3QoU2VsZWN0IHNlbCwgQ2xhc3NNYXBw\naW5nIG1hcHBpbmcpIHsKICAgICAgICBpZiAoaXNGaW5hbCkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHNlbC5zZWxlY3QoZGlzYy5nZXRD\nb2x1bW5zKCkpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1\nYmxpYyBDbGFzcyBnZXRDbGFzcyhKREJDU3RvcmUgc3RvcmUsIENsYXNzTWFw\ncGluZyBiYXNlLCBSZXN1bHQgcmVzKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIGlmIChp\nc0ZpbmFsIHx8ICFyZXMuY29udGFpbnMoZGlzYy5nZXRDb2x1bW5zKClbMF0p\nCiAgICAgICAgICAgIHx8IChiYXNlLmdldFBDU3VwZXJjbGFzcygpID09IG51\nbGwKICAgICAgICAgICAgJiYgYmFzZS5nZXRKb2luYWJsZVBDU3ViY2xhc3NN\nYXBwaW5ncygpLmxlbmd0aCA9PSAwKSkKICAgICAgICAgICAgcmV0dXJuIGJh\nc2UuZ2V0RGVzY3JpYmVkVHlwZSgpOwoKICAgICAgICBPYmplY3QgY2xzID0g\ncmVzLmdldE9iamVjdChkaXNjLmdldENvbHVtbnMoKVswXSwgLTEsIG51bGwp\nOwogICAgICAgIHJldHVybiBnZXRDbGFzcyhjbHMsIHN0b3JlKTsKICAgIH0K\nCiAgICBwdWJsaWMgU1FMQnVmZmVyIGdldENsYXNzQ29uZGl0aW9ucyhTZWxl\nY3Qgc2VsLCBKb2lucyBqb2lucywgCiAgICAgICAgQ2xhc3NNYXBwaW5nIGJh\nc2UsIGJvb2xlYW4gc3ViY2xhc3NlcykgewogICAgICAgIC8vIGlmIHNlbGVj\ndGluZyB0aGUgZmlyc3QgbWFwcGVkIGNsYXNzIGFuZCBhbGwgc3ViY2xhc3Nl\ncywgbm8gbmVlZAogICAgICAgIC8vIHRvIGxpbWl0IHRoZSBxdWVyeQogICAg\nICAgIGlmIChpc0ZpbmFsIHx8IChiYXNlLmdldEpvaW5hYmxlUENTdXBlcmNs\nYXNzTWFwcGluZygpID09IG51bGwKICAgICAgICAgICAgJiYgc3ViY2xhc3Nl\ncykpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAvLyBpZiBu\nbyBzdWJjbGFzc2VzIG9yIHN1cGVyY2xhc3MsIG5vIG5lZWQgZm9yIGNvbmRp\ndGlvbnMKICAgICAgICBDbGFzc01hcHBpbmdbXSBzdWJzID0gYmFzZS5nZXRK\nb2luYWJsZVBDU3ViY2xhc3NNYXBwaW5ncygpOwogICAgICAgIGlmIChzdWJz\nLmxlbmd0aCA9PSAwICYmIGJhc2UuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NN\nYXBwaW5nKCkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIENvbHVtbiBjb2wgPSBkaXNjLmdldENvbHVtbnMoKVswXTsKICAg\nICAgICBTUUxCdWZmZXIgc3FsID0gbmV3IFNRTEJ1ZmZlcihzZWwuZ2V0Q29u\nZmlndXJhdGlvbigpLgogICAgICAgICAgICBnZXREQkRpY3Rpb25hcnlJbnN0\nYW5jZSgpKTsKICAgICAgICBib29sZWFuIG91dGVyID0gam9pbnMgIT0gbnVs\nbCAmJiBqb2lucy5pc091dGVyKCk7CiAgICAgICAgaWYgKG91dGVyKQogICAg\nICAgICAgICBzcWwuYXBwZW5kKCIoIik7CiAgICAgICAgU3RyaW5nIGFsaWFz\nID0gc2VsLmdldENvbHVtbkFsaWFzKGNvbCwgam9pbnMpOwogICAgICAgIHNx\nbC5hcHBlbmQoYWxpYXMpOwoKICAgICAgICAvLyBpZiBub3Qgc2VsZWN0aW5n\nIHN1YmNsYXNzZXMsIGxpbWl0IHRvIGp1c3QgdGhlIGdpdmVuIGNsYXNzCiAg\nICAgICAgaWYgKCFvdXRlciAmJiAoIXN1YmNsYXNzZXMgfHwgc3Vicy5sZW5n\ndGggPT0gMCkpCiAgICAgICAgICAgIHJldHVybiBzcWwuYXBwZW5kKCIgPSAi\nKS5hcHBlbmRWYWx1ZShnZXREaXNjcmltaW5hdG9yVmFsdWUoYmFzZSksCiAg\nICAgICAgICAgICAgICBjb2wpOwoKICAgICAgICBpZiAob3V0ZXIpCiAgICAg\nICAgICAgIHNxbC5hcHBlbmQoIiBJUyAiKS5hcHBlbmRWYWx1ZShudWxsKS5h\ncHBlbmQoIiBPUiAiKS5hcHBlbmQoYWxpYXMpOwogICAgICAgIHNxbC5hcHBl\nbmQoIiBJTiAoIik7CiAgICAgICAgc3FsLmFwcGVuZFZhbHVlKGdldERpc2Ny\naW1pbmF0b3JWYWx1ZShiYXNlKSwgY29sKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHN1YnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHNxbC5h\ncHBlbmQoIiwgIikuYXBwZW5kVmFsdWUoZ2V0RGlzY3JpbWluYXRvclZhbHVl\nKHN1YnNbaV0pLCBjb2wpOwogICAgICAgIHNxbC5hcHBlbmQoIikiKTsKICAg\nICAgICBpZiAob3V0ZXIpCiAgICAgICAgICAgIHNxbC5hcHBlbmQoIikiKTsK\nICAgICAgICByZXR1cm4gc3FsOwogICAgfQp9Cg==\n","encoding":"base64"}

