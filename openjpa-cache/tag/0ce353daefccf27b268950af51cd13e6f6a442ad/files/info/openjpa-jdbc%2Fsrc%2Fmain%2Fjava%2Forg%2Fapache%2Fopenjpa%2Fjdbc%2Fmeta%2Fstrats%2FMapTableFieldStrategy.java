{"sha":"1c070f5d271c7595117f4b6d4b8d7a4d63b45d50","node_id":"MDQ6QmxvYjIwNjM2NDoxYzA3MGY1ZDI3MWM3NTk1MTE3ZjRiNmQ0YjhkN2E0ZDYzYjQ1ZDUw","size":6039,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1c070f5d271c7595117f4b6d4b8d7a4d63b45d50","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1wb3J0IGphdmEuc3FsLlNR\nTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwu\nSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5zOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc3FsLlJlc3VsdDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogQmFz\nZSBjbGFzcyBmb3IgbWFwIG1hcHBpbmdzLiBIYW5kbGVzIG1hbmFnaW5nIHRo\nZSBzZWNvbmRhcnkgdGFibGUKICogdXNlZCB0byBob2xkIG1hcCBrZXlzIGFu\nZCB2YWx1ZXMgYW5kIGxvYWRpbmcuIFN1YmNsYXNzZXMgbXVzdCBpbXBsZW1l\nbnQKICogYWJzdHJhY3QgbWV0aG9kcyBhbmQgaW5zZXJ0L3VwZGF0ZSBiZWhh\ndmlvciBhcyB3ZWxsIGFzIG92ZXJyaWRpbmcKICoge0BsaW5rIEZpZWxkU3Ry\nYXRlZ3kjdG9EYXRhU3RvcmVWYWx1ZX0sCiAqIHtAbGluayBGaWVsZFN0cmF0\nZWd5I3RvS2V5RGF0YVN0b3JlVmFsdWV9LAogKiB7QGxpbmsgRmllbGRTdHJh\ndGVneSNqb2luUmVsYXRpb259LCBhbmQKICoge0BsaW5rIEZpZWxkU3RyYXRl\nZ3kjam9pbktleVJlbGF0aW9ufSBpZiBuZWNlc3NhcnkuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgTWFwVGFi\nbGVGaWVsZFN0cmF0ZWd5CiAgICBleHRlbmRzIENvbnRhaW5lckZpZWxkU3Ry\nYXRlZ3kKICAgIGltcGxlbWVudHMgTFJTTWFwRmllbGRTdHJhdGVneSB7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChNYXBUYWJsZUZpZWxkU3RyYXRl\nZ3kuY2xhc3MpOwoKICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgZ2V0RmllbGRN\nYXBwaW5nKCkgewogICAgICAgIHJldHVybiBmaWVsZDsKICAgIH0KCiAgICBw\ndWJsaWMgQ2xhc3NNYXBwaW5nW10gZ2V0SW5kZXBlbmRlbnRLZXlNYXBwaW5n\ncyhib29sZWFuIHRyYXZlcnNlKSB7CiAgICAgICAgcmV0dXJuICh0cmF2ZXJz\nZSkgPyBmaWVsZC5nZXRLZXlNYXBwaW5nKCkuZ2V0SW5kZXBlbmRlbnRUeXBl\nTWFwcGluZ3MoKQogICAgICAgICAgICA6IENsYXNzTWFwcGluZy5FTVBUWV9N\nQVBQSU5HUzsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNYXBwaW5nW10gZ2V0\nSW5kZXBlbmRlbnRWYWx1ZU1hcHBpbmdzKGJvb2xlYW4gdHJhdmVyc2UpIHsK\nICAgICAgICByZXR1cm4gKHRyYXZlcnNlKSA/IGZpZWxkLmdldEVsZW1lbnRN\nYXBwaW5nKCkuCiAgICAgICAgICAgIGdldEluZGVwZW5kZW50VHlwZU1hcHBp\nbmdzKCkgOiBDbGFzc01hcHBpbmcuRU1QVFlfTUFQUElOR1M7CiAgICB9Cgog\nICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0Sm9pbkZvcmVpZ25LZXkoQ2xhc3NN\nYXBwaW5nIGNscykgewogICAgICAgIHJldHVybiBmaWVsZC5nZXRKb2luRm9y\nZWlnbktleSgpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZGVyaXZlS2V5\nKEpEQkNTdG9yZSBzdG9yZSwgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBkZXJpdmVWYWx1\nZShKREJDU3RvcmUgc3RvcmUsIE9iamVjdCBrZXkpIHsKICAgICAgICByZXR1\ncm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZXMge0BsaW5r\nIEZpZWxkU3RyYXRlZ3kjam9pbktleVJlbGF0aW9ufSBieSBkZWZhdWx0Lgog\nICAgICovCiAgICBwdWJsaWMgSm9pbnMgam9pbktleVJlbGF0aW9uKEpvaW5z\nIGpvaW5zLCBDbGFzc01hcHBpbmcga2V5KSB7CiAgICAgICAgcmV0dXJuIGpv\naW5LZXlSZWxhdGlvbihqb2lucywgZmFsc2UsIGZhbHNlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEludm9rZXMge0BsaW5rIEZpZWxkU3RyYXRlZ3kjam9p\nblJlbGF0aW9ufSBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgSm9p\nbnMgam9pblZhbHVlUmVsYXRpb24oSm9pbnMgam9pbnMsIENsYXNzTWFwcGlu\nZyB2YWwpIHsKICAgICAgICByZXR1cm4gam9pblJlbGF0aW9uKGpvaW5zLCBm\nYWxzZSwgZmFsc2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG1hcChib29s\nZWFuIGFkYXB0KSB7CiAgICAgICAgaWYgKGZpZWxkLmdldFR5cGVDb2RlKCkg\nIT0gSmF2YVR5cGVzLk1BUCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFE\nYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtbWFwIiwgZmllbGQpKTsKICAg\nICAgICBpZiAoZmllbGQuZ2V0S2V5KCkuZ2V0VmFsdWVNYXBwZWRCeSgpICE9\nIG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlv\nbihfbG9jLmdldCgibWFwcGVkLWJ5LWtleSIsIGZpZWxkKSk7CiAgICAgICAg\nZmllbGQuZ2V0VmFsdWVJbmZvKCkuYXNzZXJ0Tm9TY2hlbWFDb21wb25lbnRz\nKGZpZWxkLCAhYWRhcHQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRlbGV0\nZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJv\nd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgUm93IHJvdyA9IHJtLmdldEFsbFJvd3MoZmllbGQuZ2V0VGFibGUo\nKSwgUm93LkFDVElPTl9ERUxFVEUpOwogICAgICAgIHJvdy53aGVyZUZvcmVp\nZ25LZXkoZmllbGQuZ2V0Sm9pbkZvcmVpZ25LZXkoKSwgc20pOwogICAgICAg\nIHJtLmZsdXNoQWxsUm93cyhyb3cpOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nc3VwcG9ydHNTZWxlY3QoU2VsZWN0IHNlbCwgaW50IHR5cGUsIE9wZW5KUEFT\ndGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgcmV0dXJuIDA7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbG9hZChPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoZmllbGQuaXNMUlMoKSkgewogICAgICAgICAgICBz\nbS5zdG9yZU9iamVjdEZpZWxkKGZpZWxkLmdldEluZGV4KCksIG5ldyBMUlNQ\ncm94eU1hcCh0aGlzLAogICAgICAgICAgICAgICAgc3RvcmUuZ2V0Q29uZmln\ndXJhdGlvbigpKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9Cgog\nICAgICAgIC8vIHNlbGVjdCBhbGwgYW5kIGxvYWQgaW50byBhIG5vcm1hbCBw\ncm94eQogICAgICAgIEpvaW5zW10gam9pbnMgPSBuZXcgSm9pbnNbMl07CiAg\nICAgICAgUmVzdWx0W10gcmVzID0gZ2V0UmVzdWx0cyhzbSwgc3RvcmUsIGZl\ndGNoLAogICAgICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uLkVBR0VS\nX1BBUkFMTEVMLCBqb2lucywgZmFsc2UpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIE1hcCBtYXAgPSAoTWFwKSBzbS5uZXdQcm94eShmaWVsZC5nZXRJ\nbmRleCgpKTsKICAgICAgICAgICAgT2JqZWN0IGtleSwgdmFsOwogICAgICAg\nICAgICB3aGlsZSAocmVzWzBdLm5leHQoKSkgewogICAgICAgICAgICAgICAg\naWYgKHJlc1sxXSAhPSByZXNbMF0gJiYgIXJlc1sxXS5uZXh0KCkpCiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAga2V5ID0g\nbG9hZEtleShzbSwgc3RvcmUsIGZldGNoLCByZXNbMF0sIGpvaW5zWzBdKTsK\nICAgICAgICAgICAgICAgIHZhbCA9IGxvYWRWYWx1ZShzbSwgc3RvcmUsIGZl\ndGNoLCByZXNbMV0sIGpvaW5zWzFdKTsKICAgICAgICAgICAgICAgIG1hcC5w\ndXQoa2V5LCB2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNtLnN0\nb3JlT2JqZWN0KGZpZWxkLmdldEluZGV4KCksIG1hcCk7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgcmVzWzBdLmNsb3NlKCk7CiAgICAgICAg\nICAgIGlmIChyZXNbMV0gIT0gcmVzWzBdKQogICAgICAgICAgICAgICAgcmVz\nWzFdLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmpl\nY3QgbG9hZEtleVByb2plY3Rpb24oSkRCQ1N0b3JlIHN0b3JlLAogICAgICAg\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIFJlc3VsdCByZXMsIEpv\naW5zIGpvaW5zKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHJldHVybiBsb2FkS2V5KG51bGwsIHN0b3JlLCBmZXRjaCwgcmVzLCBq\nb2lucyk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBsb2FkUHJvamVjdGlv\nbihKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0\nY2gsCiAgICAgICAgUmVzdWx0IHJlcywgSm9pbnMgam9pbnMpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGxvYWRWYWx1\nZShudWxsLCBzdG9yZSwgZmV0Y2gsIHJlcywgam9pbnMpOwogICAgfQoKICAg\nIHB1YmxpYyBKb2lucyBqb2luKEpvaW5zIGpvaW5zLCBib29sZWFuIGZvcmNl\nT3V0ZXIpIHsKICAgICAgICByZXR1cm4gZmllbGQuam9pbihqb2lucywgZm9y\nY2VPdXRlciwgdHJ1ZSk7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGpvaW5L\nZXkoSm9pbnMgam9pbnMsIGJvb2xlYW4gZm9yY2VPdXRlcikgewogICAgICAg\nIHJldHVybiBmaWVsZC5qb2luKGpvaW5zLCBmb3JjZU91dGVyLCB0cnVlKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgRm9yZWlnbktleSBnZXRKb2luRm9yZWln\nbktleSgpIHsKICAgICAgICByZXR1cm4gZmllbGQuZ2V0Sm9pbkZvcmVpZ25L\nZXkoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xhc3NNYXBwaW5nW10gZ2V0\nSW5kZXBlbmRlbnRFbGVtZW50TWFwcGluZ3MoYm9vbGVhbiB0cmF2ZXJzZSkg\newogICAgICAgIHJldHVybiBDbGFzc01hcHBpbmcuRU1QVFlfTUFQUElOR1M7\nCiAgICB9Cn0K\n","encoding":"base64"}

