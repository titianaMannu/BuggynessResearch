{"sha":"0e2b4a5986fc29b2bd5fba61a9fc2751d7830303","node_id":"MDQ6QmxvYjIwNjM2NDowZTJiNGE1OTg2ZmMyOWIyYmQ1ZmJhNjFhOWZjMjc1MWQ3ODMwMzAz","size":11599,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0e2b4a5986fc29b2bd5fba61a9fc2751d7830303","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1wb3J0IGphdmEuc3FsLlNR\nTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5CaXRTZXQ7CmltcG9ydCBq\nYXZhLnV0aWwuQ29sbGVjdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJvd0ltcGw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVNYW5hZ2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkFycmF5U3RhdGVJbWFn\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURh\ndGFFeGNlcHRpb247CgovKioKICogVXNlcyBhIHN0YXRlIGltYWdlIHRvIGRl\ndGVybWluZSB3aGV0aGVyIGNvbmN1cnJlbmN5IHZpb2xhdGlvbnMgdGFrZSBw\nbGFjZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFz\ncyBTdGF0ZUNvbXBhcmlzb25WZXJzaW9uU3RyYXRlZ3kKICAgIGV4dGVuZHMg\nQWJzdHJhY3RWZXJzaW9uU3RyYXRlZ3kgewoKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIEFMSUFTID0gInN0YXRlLWNvbXBhcmlzb24iOwoKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxp\nemVyLmZvclBhY2thZ2UKICAgICAgICAoU3RhdGVDb21wYXJpc29uVmVyc2lv\nblN0cmF0ZWd5LmNsYXNzKTsKCiAgICBwdWJsaWMgU3RyaW5nIGdldEFsaWFz\nKCkgewogICAgICAgIHJldHVybiBBTElBUzsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkgewogICAgICAgIENsYXNzTWFwcGlu\nZyBjbHMgPSB2ZXJzLmdldENsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChj\nbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbAog\nICAgICAgICAgICB8fCBjbHMuZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSAhPSBu\ndWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24o\nX2xvYy5nZXQoIm5vdC1iYXNlLXZlcnMiLCBjbHMpKTsKCiAgICAgICAgdmVy\ncy5nZXRNYXBwaW5nSW5mbygpLmFzc2VydE5vU2NoZW1hQ29tcG9uZW50cyh2\nZXJzLCB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbnNlcnQoT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5h\nZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIEZpZWxkTWFwcGluZ1tdIGZpZWxkcyA9IChGaWVsZE1hcHBpbmdbXSkgc20u\nZ2V0TWV0YURhdGEoKS5nZXRGaWVsZHMoKTsKICAgICAgICBPYmplY3RbXSBz\ndGF0ZSA9IEFycmF5U3RhdGVJbWFnZS5uZXdJbWFnZShmaWVsZHMubGVuZ3Ro\nKTsKICAgICAgICBCaXRTZXQgbG9hZGVkID0gQXJyYXlTdGF0ZUltYWdlLmdl\ndExvYWRlZChzdGF0ZSk7CgogICAgICAgIC8vIHRha2UgYSBzbmFwc2hvdCBv\nZiBhbGwgdmVyc2lvbmFibGUgZmllbGQgdmFsdWVzCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgaWYgKCFmaWVsZHNbaV0uaXNQcmltYXJ5S2V5KCkgJiYgZmllbGRzW2ld\nLmlzVmVyc2lvbmFibGUoKSkgewogICAgICAgICAgICAgICAgbG9hZGVkLnNl\ndChpKTsKICAgICAgICAgICAgICAgIHN0YXRlW2ldID0gc20uZmV0Y2goZmll\nbGRzW2ldLmdldEluZGV4KCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHNtLnNldE5leHRWZXJzaW9uKHN0YXRlKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoaXMgbWV0aG9kIGlzIGZvciBjbGFzcyBtYXBwaW5ncyB0\naGF0IHRha2Ugb3ZlciB0aGUgaW5zZXJ0CiAgICAgKiBwcm9jZXNzLCBidXQg\nc3RpbGwgd2FudCB0byB1c2UgdGhpcyBpbmRpY2F0b3IgZm9yIG9wdGltaXN0\naWMgbG9ja2luZy4KICAgICAqLwogICAgcHVibGljIHZvaWQgY3VzdG9tSW5z\nZXJ0KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpbnNlcnQo\nc20sIHN0b3JlLCBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1cGRh\ndGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBS\nb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIHJlY29yZGVkIHN0YXRlIChmb3Ig\nZXhhbXBsZSwgbW9kaWZpY2F0aW9uIG1hZGUgdG8KICAgICAgICAvLyBob2xs\nb3cgaW5zdGFuY2UgYW5kIG5vIGZpZWxkcyBldmVyeSBsb2FkZWQpLCBjYW4n\ndCBkbyBhbnl0aGluZwogICAgICAgIE9iamVjdFtdIHN0YXRlID0gKE9iamVj\ndFtdKSBzbS5nZXRWZXJzaW9uKCk7CiAgICAgICAgaWYgKHN0YXRlID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgQml0U2V0IGxvYWRl\nZCA9IEFycmF5U3RhdGVJbWFnZS5nZXRMb2FkZWQoc3RhdGUpOwogICAgICAg\nIE9iamVjdFtdIG5leHRTdGF0ZSA9IEFycmF5U3RhdGVJbWFnZS5jbG9uZShz\ndGF0ZSk7CgogICAgICAgIC8vIGxvb3AgdGhyb3VnaCBmaWVsZHMgYW5kIHVw\nZGF0ZSBjaGFuZ2luZyB2YWx1ZXMgZm9yIHRoZSBuZXh0IHN0YXRlCiAgICAg\nICAgLy8gaW1hZ2UsIHBsdXMgYWRkIFdIRVJFIGNvbmRpdGlvbnMgb24gdXBk\nYXRlcyB0byBtYWtlIHN1cmUgdGhhdAogICAgICAgIC8vIGRiIHZhbHVlcyBt\nYXRjaCBvdXIgcHJldmlvdXMgaW1hZ2UKICAgICAgICBGaWVsZE1hcHBpbmdb\nXSBmaWVsZHMgPSAoRmllbGRNYXBwaW5nW10pIHNtLmdldE1ldGFEYXRhKCku\nZ2V0RmllbGRzKCk7CiAgICAgICAgUm93IHJvdzsKICAgICAgICBpZiAoc20u\naXNWZXJzaW9uQ2hlY2tSZXF1aXJlZCgpKSB7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwLCBtYXggPSBsb2FkZWQubGVuZ3RoKCk7IGkgPCBtYXg7IGkr\nKykgewogICAgICAgICAgICAgICAgaWYgKCFsb2FkZWQuZ2V0KGkpKQogICAg\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIC8v\nIHVwZGF0ZSBvdXIgbmV4dCBzdGF0ZSBpbWFnZSB3aXRoIHRoZSBuZXcgZmll\nbGQgdmFsdWUKICAgICAgICAgICAgICAgIGlmIChzbS5nZXREaXJ0eSgpLmdl\ndChpKSAmJiAhc20uZ2V0Rmx1c2hlZCgpLmdldChpKSkKICAgICAgICAgICAg\nICAgICAgICBuZXh0U3RhdGVbaV0gPSBzbS5mZXRjaChmaWVsZHNbaV0uZ2V0\nSW5kZXgoKSk7CgogICAgICAgICAgICAgICAgLy8gZmV0Y2ggdGhlIHJvdyBm\nb3IgdGhpcyBmaWVsZDsgaWYgbm8gcm93IGV4aXN0cywgdGhlbiB3ZSBjYW4n\ndAogICAgICAgICAgICAgICAgLy8gYWRkIG9uZSBiZWNhdXNlIHdlIGhhdmUg\nbm8gdXBkYXRlcyB0byBwZXJmb3JtOyB0aGF0IG1lYW5zIHdlCiAgICAgICAg\nICAgICAgICAvLyB3b24ndCBkZXRlY3QgT0wgZXhjZXB0aW9ucyB3aGVuIGFu\nb3RoZXIgdHJhbnNhY3Rpb24gY2hhbmdlcwogICAgICAgICAgICAgICAgLy8g\nZmllbGRzIHRoYXQgYXJlbid0IGluIGFueSBvZiB0aGUgc2FtZSB0YWJsZXMg\nYXMgZmllbGRzIHRoYXQKICAgICAgICAgICAgICAgIC8vIHRoaXMgdHJhbnNh\nY3Rpb24gY2hhbmdlZAogICAgICAgICAgICAgICAgcm93ID0gcm0uZ2V0Um93\nKGZpZWxkc1tpXS5nZXRUYWJsZSgpLCBSb3cuQUNUSU9OX1VQREFURSwKICAg\nICAgICAgICAgICAgICAgICBzbSwgZmFsc2UpOwogICAgICAgICAgICAgICAg\naWYgKHJvdyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwoKICAgICAgICAgICAgICAgIC8vIHNldCBXSEVSRSBjcml0ZXJpYSBtYXRj\naGluZyB0aGUgcHJldmlvdXMgc3RhdGUgaW1hZ2Ugc28gdGhlCiAgICAgICAg\nICAgICAgICAvLyB1cGRhdGUgd2lsbCBmYWlsIGZvciBhbnkgY2hhbmdlcyBt\nYWRlIGJ5IGFub3RoZXIgdHJhbnNhY3Rpb24KICAgICAgICAgICAgICAgIGZp\nZWxkc1tpXS53aGVyZShzbSwgc3RvcmUsIHJtLCBzdGF0ZVtpXSk7CiAgICAg\nICAgICAgICAgICByb3cuc2V0RmFpbGVkT2JqZWN0KHNtLmdldE1hbmFnZWRJ\nbnN0YW5jZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBz\nbS5zZXROZXh0VmVyc2lvbihuZXh0U3RhdGUpOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhpcyBtZXRob2QgaXMgZm9yIGNsYXNzIG1hcHBpbmdzIHRoYXQg\ndGFrZSBvdmVyIHRoZSB1cGRhdGUKICAgICAqIHByb2Nlc3MsIGJ1dCBzdGls\nbCB3YW50IHRvIHVzZSB0aGlzIGluZGljYXRvciBmb3Igb3B0aW1pc3RpYyBs\nb2NraW5nLgogICAgICoKICAgICAqIEBwYXJhbSBzbSB0aGUgaW5zdGFuY2Ug\ndG8gdGVzdAogICAgICogQHBhcmFtIHN0b3JlIHN0b3JlIG1hbmFnZXIgY29u\ndGV4dAogICAgICogQHBhcmFtIHRhYmxlIG9ubHkgc3RhdGUgaW1hZ2UgdmFs\ndWVzIGluIHRoaXMgdGFibGUgd2lsbCBiZSB0ZXN0ZWQ7CiAgICAgKiBpZiB0\naGUgY3VzdG9tIG1hcHBpbmcgdXNlcyBkaWZmZXJlbnQgdXBkYXRlcyBmb3IK\nICAgICAqIGRpZmZlcmVudCB0YWJsZXMsIHRoaXMgbWV0aG9kIGNhbiBiZSBj\nYWxsZWQgbXVsdGlwbGUKICAgICAqIHRpbWVzIGZvciB0aGUgbXVsdGlwbGUg\ndGFibGVzCiAgICAgKiBAcGFyYW0gcmVjb3JkIHNldCB0aGlzIHBhcmFtZXRl\nciB0byB0cnVlIHRoZSBsYXN0IHRpbWUgeW91IGNhbGwKICAgICAqIHRoaXMg\nbWV0aG9kLCBzbyB0aGUgaW5kaWNhdG9yIGNhbiBzZXR1cCB0aGUgbmV4dAog\nICAgICogdmVyc2lvbiBvZiB0aGUgZ2l2ZW4gc3RhdGUgbWFuYWdlcgogICAg\nICogQHJldHVybiBhIHtAbGluayBDdXN0b21VcGRhdGV9IHdob3NlIGdldFNR\nTCBtZXRob2QgeWllbGRzIGEKICAgICAqIGJvb2xlYW4gU1FMIGV4cHJlc3Np\nb24gdGhhdCB0ZXN0cyB3aGV0aGVyIHRoZSBjdXJyZW50CiAgICAgKiByZWNv\ncmQgaXMgZXF1YWwgdG8gb3VyIHJlY29yZGVkIHN0YXRlIGltYWdlLCBhbmQg\nd2hvc2UKICAgICAqIHNldFBhcmFtZXRlcnMgbWV0aG9kIHBhcmFtZXRlcml6\nZXMgdGhlIGdpdmVuIHByZXBhcmVkCiAgICAgKiBzdGF0ZW1lbnQgd2l0aCB0\naGUgdmFsdWVzIHVzZWQgaW4gdGhlIGFib3ZlIGJvb2xlYW4gZXhwcmVzc2lv\nbgogICAgICovCiAgICBwdWJsaWMgQ3VzdG9tVXBkYXRlIGN1c3RvbVVwZGF0\nZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsCiAg\nICAgICAgVGFibGUgdGFibGUsIGJvb2xlYW4gcmVjb3JkKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIEN1c3RvbVVwZGF0ZSBjdXN0\nb20gPSBuZXcgQ3VzdG9tVXBkYXRlKHRhYmxlKTsKICAgICAgICBPYmplY3Rb\nXSBzdGF0ZSA9IChPYmplY3RbXSkgc20uZ2V0VmVyc2lvbigpOwogICAgICAg\nIGlmIChzdGF0ZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY3VzdG9t\nOwoKICAgICAgICBCaXRTZXQgbG9hZGVkID0gQXJyYXlTdGF0ZUltYWdlLmdl\ndExvYWRlZChzdGF0ZSk7CiAgICAgICAgT2JqZWN0W10gbmV4dFN0YXRlID0g\nbnVsbDsKICAgICAgICBpZiAocmVjb3JkKQogICAgICAgICAgICBuZXh0U3Rh\ndGUgPSBBcnJheVN0YXRlSW1hZ2UuY2xvbmUoc3RhdGUpOwoKICAgICAgICBG\naWVsZE1hcHBpbmdbXSBmaWVsZHMgPSAoRmllbGRNYXBwaW5nW10pIHNtLmdl\ndE1ldGFEYXRhKCkuZ2V0RmllbGRzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDAsIG1heCA9IGxvYWRlZC5sZW5ndGgoKTsgaSA8IG1heDsgaSsrKSB7CiAg\nICAgICAgICAgIGlmICghbG9hZGVkLmdldChpKSkKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwoKICAgICAgICAgICAgaWYgKHJlY29yZCAmJiBzbS5nZXRE\naXJ0eSgpLmdldChpKSAmJiAhc20uZ2V0Rmx1c2hlZCgpLmdldChpKSkKICAg\nICAgICAgICAgICAgIG5leHRTdGF0ZVtpXSA9IHNtLmZldGNoKGZpZWxkc1tp\nXS5nZXRJbmRleCgpKTsKICAgICAgICAgICAgaWYgKGZpZWxkc1tpXS5nZXRU\nYWJsZSgpID09IHRhYmxlKQogICAgICAgICAgICAgICAgZmllbGRzW2ldLndo\nZXJlKHNtLCBzdG9yZSwgY3VzdG9tLCBzdGF0ZVtpXSk7CiAgICAgICAgfQog\nICAgICAgIGlmIChyZWNvcmQpCiAgICAgICAgICAgIHNtLnNldE5leHRWZXJz\naW9uKG5leHRTdGF0ZSk7CgogICAgICAgIHJldHVybiBjdXN0b207CiAgICB9\nCgogICAgcHVibGljIHZvaWQgYWZ0ZXJMb2FkKE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20sIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgIEZpZWxkTWFwcGlu\nZ1tdIGZpZWxkcyA9IChGaWVsZE1hcHBpbmdbXSkgc20uZ2V0TWV0YURhdGEo\nKS5nZXRGaWVsZHMoKTsKCiAgICAgICAgT2JqZWN0W10gc3RhdGUgPSAoT2Jq\nZWN0W10pIHNtLmdldFZlcnNpb24oKTsKICAgICAgICBpZiAoc3RhdGUgPT0g\nbnVsbCkKICAgICAgICAgICAgc3RhdGUgPSBBcnJheVN0YXRlSW1hZ2UubmV3\nSW1hZ2UoZmllbGRzLmxlbmd0aCk7CiAgICAgICAgQml0U2V0IGxvYWRlZCA9\nIEFycmF5U3RhdGVJbWFnZS5nZXRMb2FkZWQoc3RhdGUpOwoKICAgICAgICAv\nLyB0YWtlIGEgc25hcHNob3Qgb2YgYWxsIHZlcnNpb25hYmxlIGZpZWxkIHZh\nbHVlcyB0aGF0IHdlcmUgbG9hZGVkCiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCFm\naWVsZHNbaV0uaXNQcmltYXJ5S2V5KCkKICAgICAgICAgICAgICAgICYmIGZp\nZWxkc1tpXS5pc1ZlcnNpb25hYmxlKCkKICAgICAgICAgICAgICAgICYmIHNt\nLmdldExvYWRlZCgpLmdldChmaWVsZHNbaV0uZ2V0SW5kZXgoKSkKICAgICAg\nICAgICAgICAgICYmICFsb2FkZWQuZ2V0KGkpCiAgICAgICAgICAgICAgICAm\nJiAhc20uZ2V0RGlydHkoKS5nZXQoZmllbGRzW2ldLmdldEluZGV4KCkpKSB7\nCiAgICAgICAgICAgICAgICBsb2FkZWQuc2V0KGkpOwogICAgICAgICAgICAg\nICAgc3RhdGVbaV0gPSBzbS5mZXRjaChmaWVsZHNbaV0uZ2V0SW5kZXgoKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc20uc2V0VmVyc2lv\nbihzdGF0ZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gY2hlY2tWZXJz\naW9uKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwK\nICAgICAgICBib29sZWFuIHVwZGF0ZVZlcnNpb24pCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHVwZGF0ZVZlcnNpb24pCiAg\nICAgICAgICAgIHNtLnNldFZlcnNpb24obnVsbCk7CiAgICAgICAgcmV0dXJu\nICF1cGRhdGVWZXJzaW9uOwogICAgfQoKICAgIHB1YmxpYyBpbnQgY29tcGFy\nZVZlcnNpb24oT2JqZWN0IHYxLCBPYmplY3QgdjIpIHsKICAgICAgICByZXR1\ncm4gKEFycmF5U3RhdGVJbWFnZS5zYW1lVmVyc2lvbigoT2JqZWN0W10pIHYx\nLCAoT2JqZWN0W10pIHYyKSkKICAgICAgICAgICAgPyBTdG9yZU1hbmFnZXIu\nVkVSU0lPTl9TQU1FIDogU3RvcmVNYW5hZ2VyLlZFUlNJT05fRElGRkVSRU5U\nOwogICAgfQoKICAgIC8qKgogICAgICogUm93IGltcGxlbWVudGF0aW9uIHdl\nIHVzZSB0byBwYXNzIHRvIHZlcnNpb25hYmxlIG1hcHBpbmdzIHNvIHRoZXkK\nICAgICAqIGNhbiBzZXQgdXAgdGhlIHdoZXJlIGNvbmRpdGlvbnMgd2UgbmVl\nZCB0byBhZGQgdG8gdXBkYXRlIHN0YXRlbWVudHMuCiAgICAgKgogICAgICog\nQGF1dGhvciBBYmUgV2hpdGUKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBj\nbGFzcyBDdXN0b21VcGRhdGUKICAgICAgICBleHRlbmRzIFJvd0ltcGwKICAg\nICAgICBpbXBsZW1lbnRzIFJvd01hbmFnZXIgewoKICAgICAgICBwcml2YXRl\nIEN1c3RvbVVwZGF0ZShUYWJsZSB0YWJsZSkgewogICAgICAgICAgICBzdXBl\ncih0YWJsZSwgUm93LkFDVElPTl9VUERBVEUpOwogICAgICAgIH0KCiAgICAg\nICAgLyoqCiAgICAgICAgICogUmV0dXJuIGEgYm9vbGVhbiBTUUwgZXhwcmVz\nc2lvbiB0aGF0IHNob3VsZCBiZSBhZGRlZCB0byB0aGUKICAgICAgICAgKiBX\nSEVSRSBjbGF1c2Ugb2YgYW4gVVBEQVRFIHRvIHRlc3Qgd2hldGhlciB0aGUg\nY3VycmVudCBkYXRhYmFzZQogICAgICAgICAqIHJlY29yZCBtYXRjaGVzIG91\nciBzdG9yZWQgdmVyc2lvbi4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\nU3RyaW5nIGdldFNRTCgpIHsKICAgICAgICAgICAgQ29sdW1uW10gY29scyA9\nIGdldFRhYmxlKCkuZ2V0Q29sdW1ucygpOwogICAgICAgICAgICBTdHJpbmdC\ndWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAgICBi\nb29sZWFuIGhhc1doZXJlID0gZmFsc2U7CiAgICAgICAgICAgIE9iamVjdCB2\nYWw7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdmFsID0gZ2V0V2hlcmUoY29s\nc1tpXSk7CiAgICAgICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgaWYg\nKGhhc1doZXJlKQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBB\nTkQgIik7CiAgICAgICAgICAgICAgICBpZiAodmFsID09IE5VTEwpCiAgICAg\nICAgICAgICAgICAgICAgYnVmLmFwcGVuZChjb2xzW2ldKS5hcHBlbmQoIiBJ\nUyBOVUxMIik7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZChjb2xzW2ldKS5hcHBlbmQoIiA9ID8iKTsKICAg\nICAgICAgICAgICAgIGhhc1doZXJlID0gdHJ1ZTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICAgICAgfQoK\nICAgICAgICBwcm90ZWN0ZWQgUm93SW1wbCBuZXdJbnN0YW5jZShUYWJsZSB0\nYWJsZSwgaW50IGFjdGlvbikgewogICAgICAgICAgICByZXR1cm4gbmV3IEN1\nc3RvbVVwZGF0ZSh0YWJsZSk7CiAgICAgICAgfQoKICAgICAgICAvLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgICAgIC8vIFJvd01hbmFnZXIg\naW1wbGVtZW50YXRpb24KICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLwoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNBdXRvQXNzaWdu\nQ29uc3RyYWludHMoKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldEluc2VydHMo\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIENvbGxlY3Rpb24gZ2V0VXBk\nYXRlcygpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0\naW9uKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ29sbGVjdGlvbiBn\nZXREZWxldGVzKCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxF\neGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDb2xsZWN0\naW9uIGdldFNlY29uZGFyeVVwZGF0ZXMoKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIENvbGxlY3Rpb24gZ2V0U2Vjb25kYXJ5RGVsZXRlcygpIHsKICAg\nICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRBbGxSb3dVcGRh\ndGVzKCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRp\nb24oKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdl\ndEFsbFJvd0RlbGV0ZXMoKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRl\ncm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJv\ndyBnZXRSb3coVGFibGUgdGFibGUsIGludCBhY3Rpb24sIE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20sCiAgICAgICAgICAgIGJvb2xlYW4gY3JlYXRlKSB7CiAg\nICAgICAgICAgIC8vIHZlcmlvbmFibGUgbWFwcGluZ3Mgd2lsbCBuZXZlciB3\nYW50IHRvIGNyZWF0ZSByb3dzLCBzbyB3ZQogICAgICAgICAgICAvLyBjYW4g\nYWx3YXlzIHNhZmVseSByZXR1cm4gbnVsbAogICAgICAgICAgICBpZiAodGFi\nbGUgIT0gZ2V0VGFibGUoKSkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBSb3cgZ2V0U2Vjb25kYXJ5Um93KFRhYmxlIHRhYmxlLCBpbnQg\nYWN0aW9uKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZmx1c2hT\nZWNvbmRhcnlSb3coUm93IHJvdykgewogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIFJvdyBnZXRBbGxSb3dzKFRhYmxlIHRhYmxlLCBpbnQgYWN0aW9uKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZmx1c2hBbGxSb3dzKFJv\ndyByb3cpIHsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldE9i\namVjdChDb2x1bW4gY29sLCBPYmplY3QgdmFsKQogICAgICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVy\nbmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

