{"sha":"edec2ced558aee24f3d3a1f4cd57022e406d0a4f","node_id":"MDQ6QmxvYjIwNjM2NDplZGVjMmNlZDU1OGFlZTI0ZjNkM2ExZjRjZDU3MDIyZTQwNmQwYTRm","size":6192,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/edec2ced558aee24f3d3a1f4cd57022e406d0a4f","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1wb3J0IGphdmEuc3FsLlNR\nTEV4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5r\nZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5tZXRhLkRpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5TeW50YXhl\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Kb2luczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5SZXN1bHQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMQnVmZmVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlv\nbjsKCi8qKgogKiBEaXNjcmltaW5hdG9yIHN0cmF0ZWd5IHRoYXQgb3V0ZXIg\nam9pbnMgdG8gYWxsIHBvc3NpYmxlIHN1YmNsYXNzIHRhYmxlcwogKiB0byBk\nZXRlcm1pbmUgdGhlIGNsYXNzIG9mIGFuIGluc3RhbmNlLiBUaGlzIGluZGlj\nYXRvciB0eXBlIHNob3VsZCBvbmx5CiAqIGJlIHVzZWQgd2l0aCB2ZXJ0aWNh\nbCBpbmhlcml0YW5jZSBoaWVyYXJjaGllcy4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICovCnB1YmxpYyBjbGFzcyBTdWJjbGFzc0pvaW5EaXNjcmltaW5h\ndG9yU3RyYXRlZ3kKICAgIGV4dGVuZHMgQWJzdHJhY3REaXNjcmltaW5hdG9y\nU3RyYXRlZ3kgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFM\nSUFTID0gInN1YmNsYXNzLWpvaW4iOwoKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAg\nICAgICAoU3ViY2xhc3NKb2luRGlzY3JpbWluYXRvclN0cmF0ZWd5LmNsYXNz\nKTsKCiAgICBwdWJsaWMgU3RyaW5nIGdldEFsaWFzKCkgewogICAgICAgIHJl\ndHVybiBBTElBUzsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVh\nbiBhZGFwdCkgewogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSBkaXNjLmdl\ndENsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChjbHMuZ2V0Sm9pbmFibGVQ\nQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbAogICAgICAgICAgICB8fCBj\nbHMuZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSAhPSBudWxsKQogICAgICAgICAg\nICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1i\nYXNlLWRpc2MiLCBjbHMpKTsKCiAgICAgICAgRGlzY3JpbWluYXRvck1hcHBp\nbmdJbmZvIGluZm8gPSBkaXNjLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAg\naW5mby5hc3NlcnROb1NjaGVtYUNvbXBvbmVudHMoZGlzYywgdHJ1ZSk7Cgog\nICAgICAgIC8vIG1ha2Ugc3VyZSBvdXRlciBqb2lucyBhcmUgc3VwcG9ydGVk\nCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBjbHMuZ2V0TWFwcGluZ1Jl\ncG9zaXRvcnkoKS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICBpZiAoZGlj\ndC5qb2luU3ludGF4ID09IEpvaW5TeW50YXhlcy5TWU5UQVhfVFJBRElUSU9O\nQUwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihf\nbG9jLmdldCgib3V0ZXItam9pbi1zdXBwb3J0IiwgY2xzKSk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gc2VsZWN0KFNlbGVjdCBzZWwsIENsYXNzTWFw\ncGluZyBtYXBwaW5nKSB7CiAgICAgICAgaWYgKGlzRmluYWwpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gbWFrZSBzdXJlIHRvIHNl\nbGVjdCBvdXIgZmlyc3QgcGsgY29sIHNvIHRoYXQgd2UgZGV0ZWN0IGl0IGFz\nCiAgICAgICAgLy8gbm9uLW51bGwgaW4gZ2V0Q2xhc3M7IGlmIHdlIGhhdmUg\nbm8gc3VwZXJjbGFzcyB3ZSBkb24ndCBuZWVkIHRvCiAgICAgICAgLy8gZG8g\ndGhpcyBiZWNhdXNlIHRoZSBiYXNlIGNsYXNzIGFsd2F5cyBzZWxlY3RzIGl0\ncyBwa3MgYW55d2F5CiAgICAgICAgYm9vbGVhbiBzZWxkID0gZmFsc2U7CiAg\nICAgICAgaWYgKG1hcHBpbmcuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKS5sZW5n\ndGggPiAwCiAgICAgICAgICAgICYmIG1hcHBpbmcuZ2V0Sm9pbmFibGVQQ1N1\ncGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbCkgewogICAgICAgICAgICBzZWwu\nc2VsZWN0KG1hcHBpbmcuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKVswXSk7CiAg\nICAgICAgICAgIHNlbGQgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgQ2xh\nc3NNYXBwaW5nW10gc3VicyA9IG1hcHBpbmcuZ2V0Sm9pbmFibGVQQ1N1YmNs\nYXNzTWFwcGluZ3MoKTsKICAgICAgICBpZiAoc3Vicy5sZW5ndGggPT0gMCkK\nICAgICAgICAgICAgcmV0dXJuIHNlbGQ7CgogICAgICAgIC8vIG91dGVyIGpv\naW4gdG8gZWFjaCBzdWJjbGFzcyBhbmQgc2VsZWN0IGl0cyBmaXJzdCBwayBj\nb2w7CiAgICAgICAgLy8gdGhlIHN1YmNsYXNzIGFycmF5IGlzIGFscmVhZHkg\nb3JkZXJlZCBpbiBsZXZlbHMgb2YgaW5oZXJpdGFuY2UsIHNvCiAgICAgICAg\nLy8gZWFjaCBzdWJjbGFzcyBvbmx5IGhhcyB0byBqb2luIGZyb20gaXRzIGRp\ncmVjdCBzdXBlcmNsYXNzCiAgICAgICAgQ29sdW1uW10gcGtzOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICBpZiAoc3Vic1tpXS5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01h\ncHBpbmcoKSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29udGludWU7Cgog\nICAgICAgICAgICBwa3MgPSBzdWJzW2ldLmdldFByaW1hcnlLZXlDb2x1bW5z\nKCk7CiAgICAgICAgICAgIGlmIChwa3MubGVuZ3RoID4gMCkgewogICAgICAg\nICAgICAgICAgc2VsLnNlbGVjdChwa3NbMF0sIHN1YnNbaV0uam9pblN1cGVy\nY2xhc3MKICAgICAgICAgICAgICAgICAgICAoc2VsLm5ld0pvaW5zKCksIHRy\ndWUpKTsKICAgICAgICAgICAgICAgIHNlbGQgPSB0cnVlOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWxkOwogICAgfQoKICAg\nIHB1YmxpYyBDbGFzcyBnZXRDbGFzcyhKREJDU3RvcmUgc3RvcmUsIENsYXNz\nTWFwcGluZyBiYXNlLCBSZXN1bHQgcmVzKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIGlm\nIChpc0ZpbmFsKQogICAgICAgICAgICByZXR1cm4gYmFzZS5nZXREZXNjcmli\nZWRUeXBlKCk7CgogICAgICAgIC8vIGZpbmQgdGhlIG1vc3QgZGVyaXZlZCBj\nbGFzcyB3aXRoIGEgbm9uLW51bGwgcGsgY29sIGluIHRoZSByZXN1bHQuCiAg\nICAgICAgLy8gbm90ZSB0aGF0IHdlIGRvbid0IHBlcmZvcm0gYW55IGpvaW5z\nIGhlcmUsIHRha2luZyBhZHZhbnRhZ2Ugb2YgdGhlCiAgICAgICAgLy8gZmFj\ndCB0aGF0IHJlc3VsdCBqb2lucyBhcmUgdW5uZWNlc3Nhcnkgd2hlbiB0aGVy\nZSBpcyBubyByZWxhdGlvbgogICAgICAgIC8vIGludm9sdmVkOyB3ZSdyZSBj\naGVhdGluZyBhIGxpdHRsZQogICAgICAgIENsYXNzTWFwcGluZ1tdIHN1YnMg\nPSBiYXNlLmdldEpvaW5hYmxlUENTdWJjbGFzc01hcHBpbmdzKCk7CiAgICAg\nICAgQ2xhc3MgZGVyaXZlZCA9IGJhc2UuZ2V0RGVzY3JpYmVkVHlwZSgpOwog\nICAgICAgIENvbHVtbltdIHBrczsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHN1YnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcGtzID0gc3Vi\nc1tpXS5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgICAgICBpZiAo\ncGtzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgY29udGludWU7Cgog\nICAgICAgICAgICAvLyBwb3NzaWJsZSB0aGF0IGEgc2libGluZyBjbGFzcyBj\nb2xzIHdlcmUgYWxyZWFkeSBkaXNjb3ZlcmVkLCBpbgogICAgICAgICAgICAv\nLyB3aGljaCBjYXNlIHdlIGNhbiBza2lwIHRoaXMgc3ViCiAgICAgICAgICAg\nIGlmICghZGVyaXZlZC5pc0Fzc2lnbmFibGVGcm9tKHN1YnNbaV0uZ2V0RGVz\nY3JpYmVkVHlwZSgpKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAg\nICAgICAgICAgLy8gc2VlIGlmIGFsbCBwayBjb2xzIGFyZSBub24tbnVsbAog\nICAgICAgICAgICBpZiAocmVzLmNvbnRhaW5zKHBrc1swXSkKICAgICAgICAg\nICAgICAgICYmIHJlcy5nZXRPYmplY3QocGtzWzBdLCAtMSwgbnVsbCkgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIGRlcml2ZWQgPSBzdWJzW2ldLmdldERl\nc2NyaWJlZFR5cGUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGRlcml2\nZWQ7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciBnZXRDbGFzc0NvbmRp\ndGlvbnMoU2VsZWN0IHNlbCwgSm9pbnMgam9pbnMsIAogICAgICAgIENsYXNz\nTWFwcGluZyBiYXNlLCBib29sZWFuIHN1YmNsYXNzZXMpIHsKICAgICAgICBp\nZiAoaXNGaW5hbCB8fCBzdWJjbGFzc2VzKQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICBDbGFzc01hcHBpbmdbXSBzdWJzID0gYmFzZS5nZXRK\nb2luYWJsZVBDU3ViY2xhc3NNYXBwaW5ncygpOwogICAgICAgIGlmIChzdWJz\nLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAg\nICAgLy8gYWRkIGNvbmRpdGlvbnMgbWFraW5nIHN1cmUgbm8gc3ViY2xhc3Mg\ndGFibGVzIGhhdmUgcmVjb3JkcyBmb3IKICAgICAgICAvLyB0aGlzIGluc3Rh\nbmNlCiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IG51bGw7CiAgICAgICAgQ29s\ndW1uW10gcGtzOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICBwa3MgPSBzdWJzW2ldLmdldFBy\naW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgICAgIGlmIChwa3MubGVuZ3Ro\nID09IDApCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nIGlmIChidWYgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8gbWFrZSBz\ndXJlIHRoZSBiYXNlIGNsYXNzIGlzIGFsaWFzZWQgZmlyc3Qgc28gdGhhdCB3\nZSBkb24ndAogICAgICAgICAgICAgICAgLy8gZW5kIHVwIHdpdGggb3VyIG91\ndGVyIGpvaW5zIGJlZm9yZSB0aGUgaW5uZXIgb25lcwogICAgICAgICAgICAg\nICAgYnVmID0gbmV3IFNRTEJ1ZmZlcihzZWwuZ2V0Q29uZmlndXJhdGlvbigp\nLgogICAgICAgICAgICAgICAgICAgIGdldERCRGljdGlvbmFyeUluc3RhbmNl\nKCkpOwogICAgICAgICAgICAgICAgc2VsLmdldENvbHVtbkFsaWFzKGJhc2Uu\nZ2V0UHJpbWFyeUtleUNvbHVtbnMoKVswXSwgam9pbnMpOwogICAgICAgICAg\nICB9IGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgIik7\nCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoc2VsLmdldENvbHVtbkFsaWFzKHBr\nc1swXSwgam9pbnMpKS5hcHBlbmQoIiBJUyBOVUxMIik7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBidWY7CiAgICB9Cn0K\n","encoding":"base64"}

