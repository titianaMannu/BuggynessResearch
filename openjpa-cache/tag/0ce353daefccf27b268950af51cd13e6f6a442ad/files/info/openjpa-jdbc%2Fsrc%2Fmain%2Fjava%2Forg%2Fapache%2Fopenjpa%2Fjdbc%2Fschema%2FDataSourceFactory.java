{"sha":"731399b26fa8c8a54aa7bcbdd984df79a5cac4cc","node_id":"MDQ6QmxvYjIwNjM2NDo3MzEzOTliMjZmYThjOGE1NGFhN2JjYmRkOTg0ZGY3OWE1Y2FjNGNj","size":10441,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/731399b26fa8c8a54aa7bcbdd984df79a5cac4cc","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0\naW9uOwppbXBvcnQgamF2YS5zcWwuRHJpdmVyOwppbXBvcnQgamF2YS5zcWwu\nU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0\nb3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmF4LnNxbC5E\nYXRhU291cmNlOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0\ncmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29u\nZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmpkYmMuQ29uZmlndXJpbmdDb25uZWN0aW9uRGVj\nb3JhdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkNv\nbm5lY3Rpb25EZWNvcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmpkYmMuRGVjb3JhdGluZ0RhdGFTb3VyY2U7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ0RhdGFTb3VyY2U7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuSkRCQ0V2ZW50Q29u\nbmVjdGlvbkRlY29yYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuamRiYy5KREJDTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmpkYmMuTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3I7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLlN0b3JlRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgog\nKiBGYWN0b3J5IGZvciB7QGxpbmsgRGF0YVNvdXJjZX0gb2JqZWN0cy4gVGhl\nIGZhY3RvcnkgdXNlcyB0aGUgc3VwcGxpZWQKICogY29uZmlndXJhdGlvbiB0\nbyBvYnRhaW4gYSAzcmQtcGFydHkgZGF0YXNvdXJjZSBvciB0byBjcmVhdGUg\nb25lLCBhbmQKICogdG8gc2V0dXAgcHJlcGFyZWQgc3RhdGVtZW50IGNhY2hp\nbmcuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICov\nCnB1YmxpYyBjbGFzcyBEYXRhU291cmNlRmFjdG9yeSB7CgogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZQogICAgICAgIChEYXRhU291cmNlRmFjdG9yeS5jbGFzcyk7Cgog\nICAgLyoqCiAgICAgKiBDcmVhdGUgYSBkYXRhc291cmNlIHVzaW5nIHRoZSBn\naXZlbiBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIERhdGFTb3VyY2UgbmV3RGF0YVNvdXJjZShKREJDQ29uZmlndXJhdGlvbiBj\nb25mLAogICAgICAgIGJvb2xlYW4gZmFjdG9yeTIpIHsKICAgICAgICBTdHJp\nbmcgZHJpdmVyID0gKGZhY3RvcnkyKSA/IGNvbmYuZ2V0Q29ubmVjdGlvbjJE\ncml2ZXJOYW1lKCkKICAgICAgICAgICAgOiBjb25mLmdldENvbm5lY3Rpb25E\ncml2ZXJOYW1lKCk7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHko\nZHJpdmVyKSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24o\nX2xvYy5nZXQoIm5vLWRyaXZlciIsIGRyaXZlcikpLgogICAgICAgICAgICAg\nICAgc2V0RmF0YWwodHJ1ZSk7CgogICAgICAgIENsYXNzTG9hZGVyIGxvYWRl\nciA9IGNvbmYuZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAg\nICAgIGdldENsYXNzTG9hZGVyKERhdGFTb3VyY2VGYWN0b3J5LmNsYXNzLCBu\ndWxsKTsKICAgICAgICBTdHJpbmcgcHJvcHMgPSAoZmFjdG9yeTIpID8gY29u\nZi5nZXRDb25uZWN0aW9uMlByb3BlcnRpZXMoKQogICAgICAgICAgICA6IGNv\nbmYuZ2V0Q29ubmVjdGlvblByb3BlcnRpZXMoKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBDbGFzcyBkcml2ZXJDbGFzczsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGRyaXZlckNsYXNzID0gQ2xhc3MuZm9yTmFt\nZShkcml2ZXIsIHRydWUsIGxvYWRlcik7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKENsYXNzTm90Rm91bmRFeGNlcHRpb24gY25mZSkgewogICAgICAgICAgICAg\nICAgLy8gdHJ5IHdpdGggdGhlIGNvcmUgY2xhc3MgbG9hZGVyCiAgICAgICAg\nICAgICAgICBkcml2ZXJDbGFzcyA9IENsYXNzLmZvck5hbWUoZHJpdmVyKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKERyaXZlci5jbGFzcy5p\nc0Fzc2lnbmFibGVGcm9tKGRyaXZlckNsYXNzKSkgewogICAgICAgICAgICAg\nICAgRHJpdmVyRGF0YVNvdXJjZSBkcyA9IGNvbmYubmV3RHJpdmVyRGF0YVNv\ndXJjZUluc3RhbmNlKCk7CiAgICAgICAgICAgICAgICBkcy5zZXRDbGFzc0xv\nYWRlcihsb2FkZXIpOwogICAgICAgICAgICAgICAgZHMuc2V0Q29ubmVjdGlv\nbkRyaXZlck5hbWUoZHJpdmVyKTsKICAgICAgICAgICAgICAgIGRzLnNldENv\nbm5lY3Rpb25Qcm9wZXJ0aWVzKENvbmZpZ3VyYXRpb25zLgogICAgICAgICAg\nICAgICAgICAgIHBhcnNlUHJvcGVydGllcyhwcm9wcykpOwoKICAgICAgICAg\nICAgICAgIGlmICghZmFjdG9yeTIpIHsKICAgICAgICAgICAgICAgICAgICBk\ncy5zZXRDb25uZWN0aW9uRmFjdG9yeVByb3BlcnRpZXMoQ29uZmlndXJhdGlv\nbnMuCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlUHJvcGVydGllcyhj\nb25mLmdldENvbm5lY3Rpb25GYWN0b3J5UHJvcGVydGllcygpKSk7CiAgICAg\nICAgICAgICAgICAgICAgZHMuc2V0Q29ubmVjdGlvblVSTChjb25mLmdldENv\nbm5lY3Rpb25VUkwoKSk7CiAgICAgICAgICAgICAgICAgICAgZHMuc2V0Q29u\nbmVjdGlvblVzZXJOYW1lKGNvbmYuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCkp\nOwogICAgICAgICAgICAgICAgICAgIGRzLnNldENvbm5lY3Rpb25QYXNzd29y\nZChjb25mLmdldENvbm5lY3Rpb25QYXNzd29yZCgpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZHMuc2V0Q29ubmVj\ndGlvbkZhY3RvcnlQcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgICAg\nIChDb25maWd1cmF0aW9ucy5wYXJzZVByb3BlcnRpZXMoY29uZi4KICAgICAg\nICAgICAgICAgICAgICAgICAgZ2V0Q29ubmVjdGlvbkZhY3RvcnkyUHJvcGVy\ndGllcygpKSk7CiAgICAgICAgICAgICAgICAgICAgZHMuc2V0Q29ubmVjdGlv\nblVSTChjb25mLmdldENvbm5lY3Rpb24yVVJMKCkpOwogICAgICAgICAgICAg\nICAgICAgIGRzLnNldENvbm5lY3Rpb25Vc2VyTmFtZShjb25mLmdldENvbm5l\nY3Rpb24yVXNlck5hbWUoKSk7CiAgICAgICAgICAgICAgICAgICAgZHMuc2V0\nQ29ubmVjdGlvblBhc3N3b3JkKGNvbmYuZ2V0Q29ubmVjdGlvbjJQYXNzd29y\nZCgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVy\nbiBkczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gc2VlIGlmIHRo\nZWlyIGRyaXZlciBuYW1lIGlzIGFjdHVhbGx5IGEgZGF0YSBzb3VyY2UKICAg\nICAgICAgICAgaWYgKERhdGFTb3VyY2UuY2xhc3MuaXNBc3NpZ25hYmxlRnJv\nbShkcml2ZXJDbGFzcykpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoRGF0\nYVNvdXJjZSkgQ29uZmlndXJhdGlvbnMubmV3SW5zdGFuY2UoZHJpdmVyLAog\nICAgICAgICAgICAgICAgICAgIGNvbmYsIHByb3BzLCBEYXRhU291cmNlLmNs\nYXNzLmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgICAgIGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAg\nICAgICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKS5z\nZXRGYXRhbCh0cnVlKTsKICAgICAgICB9CgogICAgICAgIC8vIG5vdCBhIGRy\naXZlciBvciBhIGRhdGEgc291cmNlOyBkaWUKICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWRyaXZlciIsIGRyaXZlcikp\nLnNldEZhdGFsKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogSW5zdGFs\nbCBsaXN0ZW5lcnMgYW5kIGJhc2UgZGVjb3JhdG9ycy4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBEZWNvcmF0aW5nRGF0YVNvdXJjZSBkZWNvcmF0ZURh\ndGFTb3VyY2UoRGF0YVNvdXJjZSBkcywKICAgICAgICBKREJDQ29uZmlndXJh\ndGlvbiBjb25mLCBib29sZWFuIGZhY3RvcnkyKSB7CiAgICAgICAgT3B0aW9u\ncyBvcHRzID0gQ29uZmlndXJhdGlvbnMucGFyc2VQcm9wZXJ0aWVzKChmYWN0\nb3J5MikKICAgICAgICAgICAgPyBjb25mLmdldENvbm5lY3Rpb25GYWN0b3J5\nMlByb3BlcnRpZXMoKQogICAgICAgICAgICA6IGNvbmYuZ2V0Q29ubmVjdGlv\nbkZhY3RvcnlQcm9wZXJ0aWVzKCkpOwogICAgICAgIExvZyBqZGJjTG9nID0g\nY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX0pEQkMpOwogICAg\nICAgIExvZyBzcWxMb2cgPSBjb25mLmdldExvZyhKREJDQ29uZmlndXJhdGlv\nbi5MT0dfU1FMKTsKCiAgICAgICAgRGVjb3JhdGluZ0RhdGFTb3VyY2UgZGRz\nID0gbmV3IERlY29yYXRpbmdEYXRhU291cmNlKGRzKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICAvLyBhZGQgdXNlci1kZWZpbmVkIGRlY29yYXRvcnMK\nICAgICAgICAgICAgTGlzdCBkZWNvcmF0b3JzID0gbmV3IEFycmF5TGlzdCgp\nOwogICAgICAgICAgICBkZWNvcmF0b3JzLmFkZEFsbChBcnJheXMuYXNMaXN0\nKGNvbmYuCiAgICAgICAgICAgICAgICBnZXRDb25uZWN0aW9uRGVjb3JhdG9y\nSW5zdGFuY2VzKCkpKTsKCiAgICAgICAgICAgIC8vIGFkZCBqZGJjIGV2ZW50\ncyBkZWNvcmF0b3IKICAgICAgICAgICAgSkRCQ0V2ZW50Q29ubmVjdGlvbkRl\nY29yYXRvciBlY2QgPQogICAgICAgICAgICAgICAgbmV3IEpEQkNFdmVudENv\nbm5lY3Rpb25EZWNvcmF0b3IoKTsKICAgICAgICAgICAgQ29uZmlndXJhdGlv\nbnMuY29uZmlndXJlSW5zdGFuY2UoZWNkLCBjb25mLCBvcHRzKTsKICAgICAg\nICAgICAgSkRCQ0xpc3RlbmVyW10gbGlzdGVuZXJzID0gY29uZi5nZXRKREJD\nTGlzdGVuZXJJbnN0YW5jZXMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICBlY2QuYWRkTGlzdGVuZXIobGlzdGVuZXJzW2ldKTsKICAgICAgICAgICAg\nZGVjb3JhdG9ycy5hZGQoZWNkKTsKCiAgICAgICAgICAgIC8vIGFzayB0aGUg\nRHJpdmVyRGF0YVNvdXJjZSB0byBwcm92aWRlIGFueSBhZGRpdGlvbmFsIGRl\nY29yYXRvcnMKICAgICAgICAgICAgaWYgKGRzIGluc3RhbmNlb2YgRHJpdmVy\nRGF0YVNvdXJjZSkgewogICAgICAgICAgICAgICAgTGlzdCBkZWNzID0gKChE\ncml2ZXJEYXRhU291cmNlKWRzKS5jcmVhdGVDb25uZWN0aW9uRGVjb3JhdG9y\ncygpOwogICAgICAgICAgICAgICAgaWYgKGRlY3MgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICBkZWNvcmF0b3JzLmFkZEFsbChkZWNzKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgLy8gbG9nZ2luZyBkZWNvcmF0b3IKICAg\nICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IgbGNkID0gbmV3\nIExvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yKCk7CiAgICAgICAgICAgIENv\nbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKGxjZCwgY29uZiwgb3B0\ncyk7CiAgICAgICAgICAgIGxjZC5nZXRMb2dzKCkuc2V0SkRCQ0xvZyhqZGJj\nTG9nKTsKICAgICAgICAgICAgbGNkLmdldExvZ3MoKS5zZXRTUUxMb2coc3Fs\nTG9nKTsKICAgICAgICAgICAgZGVjb3JhdG9ycy5hZGQobGNkKTsKCiAgICAg\nICAgICAgIGRkcy5hZGREZWNvcmF0b3JzKGRlY29yYXRvcnMpOwogICAgICAg\nICAgICByZXR1cm4gZGRzOwogICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNl\ncHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFN0\nb3JlRXhjZXB0aW9uKGUpLnNldEZhdGFsKHRydWUpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIEluc3RhbGwgdGhpbmdzIGRlZmVycmVkIHVu\ndGlsIHRoZSBEQkRpY3Rpb25hcnkgaW5zdGFuY2UgaXMgYXZhaWxhYmxlLgog\nICAgICoKICAgICAqIEBhdXRob3IgU3RldmUgS2ltCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgRGVjb3JhdGluZ0RhdGFTb3VyY2UgaW5zdGFsbERCRGlj\ndGlvbmFyeShEQkRpY3Rpb25hcnkgZGljdCwKICAgICAgICBEZWNvcmF0aW5n\nRGF0YVNvdXJjZSBkcywgZmluYWwgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwK\nICAgICAgICBib29sZWFuIGZhY3RvcnkyKSB7CiAgICAgICAgRGF0YVNvdXJj\nZSBpbm5lciA9IGRzLmdldElubmVybW9zdERlbGVnYXRlKCk7CiAgICAgICAg\naWYgKGlubmVyIGluc3RhbmNlb2YgRHJpdmVyRGF0YVNvdXJjZSkKICAgICAg\nICAgICAgKChEcml2ZXJEYXRhU291cmNlKSBpbm5lcikuaW5pdERCRGljdGlv\nbmFyeShkaWN0KTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gYWRk\nIHRoZSBkaWN0aW9uYXJ5IGFzIGEgd2FybmluZyBoYW5kbGVyIG9uIHRoZSBs\nb2dnaW5nCiAgICAgICAgICAgIC8vIGRlY29yYXRvcgogICAgICAgICAgICBD\nb25uZWN0aW9uRGVjb3JhdG9yIGNkOwogICAgICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ciA9IGRzLmdldERlY29yYXRvcnMoKS5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgY2QgPSAoQ29ubmVjdGlv\nbkRlY29yYXRvcikgaXRyLm5leHQoKTsKICAgICAgICAgICAgICAgIGlmIChj\nZCBpbnN0YW5jZW9mIExvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yKQogICAg\nICAgICAgICAgICAgICAgICgoTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3Ip\nIGNkKS5zZXRXYXJuaW5nSGFuZGxlcihkaWN0KTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgLy8gbWlzYyBjb25maWd1cmF0aW9uIGNvbm5lY3Rpb24g\nZGVjb3JhdG9yIChzdGF0ZW1lbnQgdGltZW91dHMsCiAgICAgICAgICAgIC8v\nIHRyYW5zYWN0aW9uIGlzb2xhdGlvbiwgZXRjKQogICAgICAgICAgICBDb25m\naWd1cmluZ0Nvbm5lY3Rpb25EZWNvcmF0b3IgY2NkID0KICAgICAgICAgICAg\nICAgIG5ldyBDb25maWd1cmluZ0Nvbm5lY3Rpb25EZWNvcmF0b3IoKTsKICAg\nICAgICAgICAgY2NkLnNldFRyYW5zYWN0aW9uSXNvbGF0aW9uKGNvbmYuZ2V0\nVHJhbnNhY3Rpb25Jc29sYXRpb25Db25zdGFudCgpKTsKICAgICAgICAgICAg\naWYgKGZhY3RvcnkyIHx8ICFjb25mLmlzQ29ubmVjdGlvbkZhY3RvcnlNb2Rl\nTWFuYWdlZCgpKSB7CiAgICAgICAgICAgICAgICBpZiAoIWRpY3Quc3VwcG9y\ndHNNdWx0aXBsZU5vbnRyYW5zYWN0aW9uYWxSZXN1bHRTZXRzKQogICAgICAg\nICAgICAgICAgICAgIGNjZC5zZXRBdXRvQ29tbWl0KEJvb2xlYW4uRkFMU0Up\nOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGNj\nZC5zZXRBdXRvQ29tbWl0KEJvb2xlYW4uVFJVRSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgT3B0aW9ucyBvcHRzID0gQ29uZmlndXJhdGlvbnMucGFy\nc2VQcm9wZXJ0aWVzKChmYWN0b3J5MikKICAgICAgICAgICAgICAgID8gY29u\nZi5nZXRDb25uZWN0aW9uRmFjdG9yeTJQcm9wZXJ0aWVzKCkKICAgICAgICAg\nICAgICAgIDogY29uZi5nZXRDb25uZWN0aW9uRmFjdG9yeVByb3BlcnRpZXMo\nKSk7CiAgICAgICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3Rh\nbmNlKGNjZCwgY29uZiwgb3B0cyk7CiAgICAgICAgICAgIGRzLmFkZERlY29y\nYXRvcihjY2QpOwoKICAgICAgICAgICAgLy8gYWxsb3cgdGhlIGRiZGljdGlv\nbmFyeSB0byBkZWNvcmF0ZSB0aGUgY29ubmVjdGlvbiBmdXJ0aGVyCiAgICAg\nICAgICAgIGRzLmFkZERlY29yYXRvcihkaWN0KTsKICAgICAgICAgICAgcmV0\ndXJuIGRzOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKS5zZXRGYXRhbCh0\ncnVlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\nYSBkYXRhIHNvdXJjZSB3aXRoIHRoZSBnaXZlbiB1c2VyIG5hbWUgYW5kIHBh\nc3N3b3JkCiAgICAgKiBwcmUtY29uZmlndXJlZCBhcyB0aGUgZGVmYXVsdHMg\nd2hlbiB7QGxpbmsgRGF0YVNvdXJjZSNnZXRDb25uZWN0aW9ufQogICAgICog\naXMgY2FsbGVkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIERhdGFTb3Vy\nY2UgZGVmYXVsdHNEYXRhU291cmNlKERhdGFTb3VyY2UgZHMsCiAgICAgICAg\nU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzKSB7CiAgICAgICAgaWYgKHVzZXIg\nPT0gbnVsbCAmJiBwYXNzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBk\nczsKICAgICAgICAvLyBhbHNvIGNoZWNrIGlmIHRoZXkgYXJlIGJvdGggYmxh\nbmsgc3RyaW5ncwogICAgICAgIGlmICgiIi5lcXVhbHModXNlcikgJiYgIiIu\nZXF1YWxzKHBhc3MpKQogICAgICAgICAgICByZXR1cm4gZHM7CiAgICAgICAg\ncmV0dXJuIG5ldyBEZWZhdWx0c0RhdGFTb3VyY2UoZHMsIHVzZXIsIHBhc3Mp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ2xvc2UgdGhlIGdpdmVuIGRhdGEg\nc291cmNlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgY2xvc2VE\nYXRhU291cmNlKERhdGFTb3VyY2UgZHMpIHsKICAgICAgICBpZiAoZHMgaW5z\ndGFuY2VvZiBEZWxlZ2F0aW5nRGF0YVNvdXJjZSkKICAgICAgICAgICAgZHMg\nPSAoKERlbGVnYXRpbmdEYXRhU291cmNlKSBkcykuZ2V0SW5uZXJtb3N0RGVs\nZWdhdGUoKTsKICAgICAgICBJbXBsSGVscGVyLmNsb3NlKGRzKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEEgZGF0YSBzb3VyY2Ugd2l0aCBwcmUtY29uZmln\ndXJlZCBkZWZhdWx0IHVzZXIgbmFtZSBhbmQgcGFzc3dvcmQuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIERlZmF1bHRzRGF0YVNvdXJjZQog\nICAgICAgIGV4dGVuZHMgRGVsZWdhdGluZ0RhdGFTb3VyY2UgewoKICAgICAg\nICBwcml2YXRlIGZpbmFsIFN0cmluZyBfdXNlcjsKICAgICAgICBwcml2YXRl\nIGZpbmFsIFN0cmluZyBfcGFzczsKCiAgICAgICAgcHVibGljIERlZmF1bHRz\nRGF0YVNvdXJjZShEYXRhU291cmNlIGRzLCBTdHJpbmcgdXNlciwgU3RyaW5n\nIHBhc3MpIHsKICAgICAgICAgICAgc3VwZXIoZHMpOwogICAgICAgICAgICBf\ndXNlciA9IHVzZXI7CiAgICAgICAgICAgIF9wYXNzID0gcGFzczsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBDb25uZWN0aW9uIGdldENvbm5lY3Rpb24o\nKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgcmV0dXJuIHN1cGVyLmdldENvbm5lY3Rpb24oX3VzZXIsIF9wYXNzKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDb25uZWN0aW9uIGdldENvbm5l\nY3Rpb24oU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzKQogICAgICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVy\nLmdldENvbm5lY3Rpb24odXNlciwgcGFzcyk7CiAgICAgICAgfQogICAgfQp9\nCg==\n","encoding":"base64"}

