{"sha":"02787f22e2709fcc80d3939874c78491c4fa5127","node_id":"MDQ6QmxvYjIwNjM2NDowMjc4N2YyMmUyNzA5ZmNjODBkMzkzOTg3NGM3ODQ5MWM0ZmE1MTI3","size":22275,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/02787f22e2709fcc80d3939874c78491c4fa5127","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLnNxbC5EYXRhYmFz\nZU1ldGFEYXRhOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxpbmtl\nZE1hcDsKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLk9iamVjdFV0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2Fs\naXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5TdHJp\nbmdEaXN0YW5jZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLklu\ndmFsaWRTdGF0ZUV4Y2VwdGlvbjsKCi8qKgogKiBSZXByZXNlbnRzIGEgZGF0\nYWJhc2UgZm9yZWlnbiBrZXk7IG1heSBiZSBhIGxvZ2ljYWwga2V5IHdpdGgg\nbm8KICogZGF0YWJhc2UgcmVwcmVzZW50YXRpb24uIFRoaXMgY2xhc3MgY2Fu\nIGFsc28gcmVwcmVzZW50IGEgcGFydGlhbCBrZXksCiAqIGFsaWduaW5nIHdp\ndGgge0BsaW5rIERhdGFiYXNlTWV0YURhdGF9LgogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEZvcmVpZ25LZXkKICAgIGV4dGVu\nZHMgQ29uc3RyYWludCB7CgogICAgLyoqCiAgICAgKiBMb2dpY2FsIGZvcmVp\nZ24ga2V5OyBsaW5rcyBjb2x1bW5zLCBidXQgZG9lcyBub3QgcGVyZm9ybSBh\nbnkgYWN0aW9uCiAgICAgKiB3aGVuIHRoZSBqb2luZWQgcHJpbWFyeSBrZXkg\nY29sdW1ucyBhcmUgbW9kaWZpZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IEFDVElPTl9OT05FID0gMTsKCiAgICAvKioKICAgICAq\nIFRocm93IGFuIGV4Y2VwdGlvbiBpZiBqb2luZWQgcHJpbWFyeSBrZXkgY29s\ndW1ucyBhcmUgbW9kaWZpZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEFDVElPTl9SRVNUUklDVCA9IDI7CgogICAgLyoqCiAgICAg\nKiBDYXNjYWRlIGFueSBtb2RpZmljYXRpb24gb2YgdGhlIGpvaW5lZCBwcmlt\nYXJ5IGtleSBjb2x1bW5zIHRvCiAgICAgKiB0aGlzIHRhYmxlLiBJZiB0aGUg\nam9pbmVkIHByaW1hcnkga2V5IHJvdyBpcyBkZWxldGVkLCB0aGUgcm93IGlu\nIHRoaXMKICAgICAqIHRhYmxlIHdpbGwgYWxzbyBiZSBkZWxldGVkLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBBQ1RJT05fQ0FTQ0FE\nRSA9IDM7CgogICAgLyoqCiAgICAgKiBOdWxsIHRoZSBsb2NhbCBjb2x1bW5z\nIGlmIHRoZSBqb2luZWQgcHJpbWFyeSBrZXkgY29sdW1ucyBhcmUgbW9kaWZp\nZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEFDVElP\nTl9OVUxMID0gNDsKCiAgICAvKioKICAgICAqIFNldCB0aGUgbG9jYWwgY29s\ndW1ucyB0byB0aGVpciBkZWZhdWx0IHZhbHVlcyBpZiB0aGUgcHJpbWFyeSBr\nZXkKICAgICAqIGNvbHVtbnMgYXJlIG1vZGlmaWVkLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIGludCBBQ1RJT05fREVGQVVMVCA9IDU7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZShGb3JlaWduS2V5LmNsYXNzKTsKCiAgICBwcml2YXRlIFN0\ncmluZyBfcGtUYWJsZU5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcg\nX3BrU2NoZW1hTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfcGtD\nb2x1bW5OYW1lID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9zZXEgPSAwOwoK\nICAgIHByaXZhdGUgTGlua2VkTWFwIF9qb2lucyA9IG51bGw7CiAgICBwcml2\nYXRlIExpbmtlZE1hcCBfam9pbnNQSyA9IG51bGw7CiAgICBwcml2YXRlIExp\nbmtlZE1hcCBfY29uc3RzID0gbnVsbDsKICAgIHB1YmxpYyBMaW5rZWRNYXAg\nX2NvbnN0c1BLID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9kZWxBY3Rpb24g\nPSBBQ1RJT05fTk9ORTsKICAgIHByaXZhdGUgaW50IF91cEFjdGlvbiA9IEFD\nVElPTl9OT05FOwogICAgcHJpdmF0ZSBpbnQgX2luZGV4ID0gMDsKCiAgICAv\nLyBjYWNoZWQgaXRlbXMKICAgIHByaXZhdGUgQ29sdW1uW10gX2xvY2FscyA9\nIG51bGw7CiAgICBwcml2YXRlIENvbHVtbltdIF9wa3MgPSBudWxsOwogICAg\ncHJpdmF0ZSBPYmplY3RbXSBfY29uc3RWYWxzID0gbnVsbDsKICAgIHByaXZh\ndGUgQ29sdW1uW10gX2NvbnN0Q29scyA9IG51bGw7CiAgICBwcml2YXRlIE9i\namVjdFtdIF9jb25zdFZhbHNQSyA9IG51bGw7CiAgICBwcml2YXRlIENvbHVt\nbltdIF9jb25zdENvbHNQSyA9IG51bGw7CiAgICBwcml2YXRlIFRhYmxlIF9w\na1RhYmxlID0gbnVsbDsKICAgIHByaXZhdGUgQm9vbGVhbiBfYXV0b0Fzc2ln\nbiA9IG51bGw7CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGZvcmVpZ24g\na2V5IGFjdGlvbiBjb25zdGFudCBmb3IgdGhlIGdpdmVuIGFjdGlvbiBuYW1l\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGludCBnZXRBY3Rpb24oU3Ry\naW5nIG5hbWUpIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8ICJub25l\nIi5lcXVhbHNJZ25vcmVDYXNlKG5hbWUpKQogICAgICAgICAgICByZXR1cm4g\nQUNUSU9OX05PTkU7CiAgICAgICAgaWYgKCJjYXNjYWRlIi5lcXVhbHNJZ25v\ncmVDYXNlKG5hbWUpKQogICAgICAgICAgICByZXR1cm4gQUNUSU9OX0NBU0NB\nREU7CiAgICAgICAgaWYgKCJkZWZhdWx0Ii5lcXVhbHNJZ25vcmVDYXNlKG5h\nbWUpKQogICAgICAgICAgICByZXR1cm4gQUNUSU9OX0RFRkFVTFQ7CiAgICAg\nICAgaWYgKCJyZXN0cmljdCIuZXF1YWxzSWdub3JlQ2FzZShuYW1lKQogICAg\nICAgICAgICB8fCAiZXhjZXB0aW9uIi5lcXVhbHNJZ25vcmVDYXNlKG5hbWUp\nKQogICAgICAgICAgICByZXR1cm4gQUNUSU9OX1JFU1RSSUNUOwogICAgICAg\nIGlmICgibnVsbCIuZXF1YWxzSWdub3JlQ2FzZShuYW1lKSkKICAgICAgICAg\nICAgcmV0dXJuIEFDVElPTl9OVUxMOwoKICAgICAgICAvLyBub3QgYSByZWNv\nZ25pemVkIGFjdGlvbjsgY2hlY2sgZm9yIHR5cG8KICAgICAgICBMaXN0IHJl\nY29nbml6ZWQgPSBBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsgIm5vbmUi\nLCAiZXhjZXB0aW9uIiwKICAgICAgICAgICAgInJlc3RyaWN0IiwgImNhc2Nh\nZGUiLCAibnVsbCIsICJkZWZhdWx0IiwgfSk7CiAgICAgICAgU3RyaW5nIGNs\nb3Nlc3QgPSBTdHJpbmdEaXN0YW5jZS5nZXRDbG9zZXN0TGV2ZW5zaHRlaW5E\naXN0YW5jZShuYW1lLAogICAgICAgICAgICByZWNvZ25pemVkLCAuNUYpOwoK\nICAgICAgICBTdHJpbmcgbXNnOwogICAgICAgIGlmIChjbG9zZXN0ICE9IG51\nbGwpCiAgICAgICAgICAgIG1zZyA9IF9sb2MuZ2V0KCJiYWQtZmstYWN0aW9u\nLWhpbnQiLCBuYW1lLCBjbG9zZXN0LCByZWNvZ25pemVkKQogICAgICAgICAg\nICAgICAgLmdldE1lc3NhZ2UoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIG1zZyA9IF9sb2MuZ2V0KCJiYWQtZmstYWN0aW9uIiwgbmFtZSwgcmVjb2du\naXplZCkuZ2V0TWVzc2FnZSgpOwogICAgICAgIHRocm93IG5ldyBJbGxlZ2Fs\nQXJndW1lbnRFeGNlcHRpb24obXNnKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgZm9yZWlnbiBrZXkgYWN0aW9uIG5hbWUgZm9yIHRoZSBn\naXZlbiBhY3Rpb24gY29uc3RhbnQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgU3RyaW5nIGdldEFjdGlvbk5hbWUoaW50IGFjdGlvbikgewogICAgICAg\nIHN3aXRjaCAoYWN0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgQUNUSU9OX05P\nTkU6CiAgICAgICAgICAgICAgICByZXR1cm4gIm5vbmUiOwogICAgICAgICAg\nICBjYXNlIEFDVElPTl9SRVNUUklDVDoKICAgICAgICAgICAgICAgIHJldHVy\nbiAicmVzdHJpY3QiOwogICAgICAgICAgICBjYXNlIEFDVElPTl9DQVNDQURF\nOgogICAgICAgICAgICAgICAgcmV0dXJuICJjYXNjYWRlIjsKICAgICAgICAg\nICAgY2FzZSBBQ1RJT05fREVGQVVMVDoKICAgICAgICAgICAgICAgIHJldHVy\nbiAiZGVmYXVsdCI7CiAgICAgICAgICAgIGNhc2UgQUNUSU9OX05VTEw6CiAg\nICAgICAgICAgICAgICByZXR1cm4gIm51bGwiOwogICAgICAgICAgICBkZWZh\ndWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVu\ndEV4Y2VwdGlvbihTdHJpbmcudmFsdWVPZihhY3Rpb24pKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yLgog\nICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleSgpIHsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBu\nYW1lIHRoZSBmb3JlaWduIGtleSBuYW1lLCBpZiBhbnkKICAgICAqIEBwYXJh\nbSB0YWJsZSB0aGUgbG9jYWwgdGFibGUgb2YgdGhlIGZvcmVpZ24ga2V5CiAg\nICAgKi8KICAgIHB1YmxpYyBGb3JlaWduS2V5KFN0cmluZyBuYW1lLCBUYWJs\nZSB0YWJsZSkgewogICAgICAgIHN1cGVyKG5hbWUsIHRhYmxlKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc0xvZ2ljYWwoKSB7CiAgICAgICAgcmV0\ndXJuIF9kZWxBY3Rpb24gPT0gQUNUSU9OX05PTkU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRoZSBwcmltYXJ5IGtleSBjb2x1bW5zIG9mIHRo\naXMga2V5IGFyZSBhdXRvLWluY3JlbWVudGluZywgb3IKICAgICAqIHdoZXRo\nZXIgdGhleSB0aGVtc2VsdmVzIGFyZSBtZW1iZXJzIG9mIGEgZm9yZWlnbiBr\nZXkgd2hvJ3MgcHJpbWFyeSBrZXkKICAgICAqIGlzIGF1dG8taW5jcmVtZW50\naW5nIChyZWN1cnNpbmcgdG8gYXJiaXRyYXJ5IGRlcHRoKS4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5QXV0b0Fzc2lnbmVkKCkg\newogICAgICAgIGlmIChfYXV0b0Fzc2lnbiAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gX2F1dG9Bc3NpZ24uYm9vbGVhblZhbHVlKCk7CiAgICAgICAg\ncmV0dXJuIGlzUHJpbWFyeUtleUF1dG9Bc3NpZ25lZChuZXcgQXJyYXlMaXN0\nKDMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBlciB0byBjYWxjdWxh\ndGUgd2hldGhlciB0aGlzIGZvcmVpZ24ga2V5IGRlcGVuZHMgb24gYXV0by1h\nc3NpZ25lZCAKICAgICAqIGNvbHVtbnMuICBSZWN1cnNlcyBhcHByb3ByaWF0\nZWx5IGlmIHRoZSBwcmltYXJ5IGtleSBjb2x1bW5zIHRoaXMga2V5CiAgICAg\nKiBqb2lucyB0byBhcmUgdGhlbXNlbHZlcyBtZW1iZXJzIG9mIGEgZm9yZWln\nbiBrZXkgdGhhdCBpcyBkZXBlbmRlbnQgb24KICAgICAqIGF1dG8tYXNzaWdu\nZWQgY29sdW1ucy4gIENhY2hlcyBjYWxjdWxhdGVkIGF1dG8tYXNzaWduIHZh\nbHVlIGFzIGEgc2lkZSAKICAgICAqIGVmZmVjdC4KICAgICAqCiAgICAgKiBA\ncGFyYW0gc2VlbiB0cmFjayBzZWVuIGZvcmVpZ24ga2V5cyB0byBwcmV2ZW50\nIGluZmluaXRlIHJlY3Vyc2lvbiBpbgogICAgICogdGhlIGNhc2Ugb2YgZm9y\nZWlnbiBrZXkgY3ljbGVzCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBp\nc1ByaW1hcnlLZXlBdXRvQXNzaWduZWQoTGlzdCBzZWVuKSB7CiAgICAgICAg\naWYgKF9hdXRvQXNzaWduICE9IG51bGwpIAogICAgICAgICAgICByZXR1cm4g\nX2F1dG9Bc3NpZ24uYm9vbGVhblZhbHVlKCk7CgogICAgICAgIENvbHVtbltd\nIGNvbHMgPSBnZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIGlmIChj\nb2xzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIF9hdXRvQXNzaWduID0g\nQm9vbGVhbi5GQUxTRTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb2xzW2ldLmlzQXV0b0Fzc2ln\nbmVkKCkpIHsKICAgICAgICAgICAgICAgIF9hdXRvQXNzaWduID0gQm9vbGVh\nbi5UUlVFOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIEZvcmVpZ25LZXlbXSBma3MgPSBf\ncGtUYWJsZS5nZXRGb3JlaWduS2V5cygpOwogICAgICAgIHNlZW4uYWRkKHRo\naXMpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGZrcy5s\nZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYgKCFma3Nbal0uY29u\ndGFpbnNDb2x1bW4oY29sc1tpXSkpCiAgICAgICAgICAgICAgICAgICAgY29u\ndGludWU7CiAgICAgICAgICAgICAgICBpZiAoIXNlZW4uY29udGFpbnMoZmtz\nW2pdKQogICAgICAgICAgICAgICAgICAgICYmIGZrc1tqXS5pc1ByaW1hcnlL\nZXlBdXRvQXNzaWduZWQoc2VlbikpIHsKICAgICAgICAgICAgICAgICAgICBf\nYXV0b0Fzc2lnbiA9IEJvb2xlYW4uVFJVRTsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgX2F1dG9Bc3NpZ24gPSBCb29sZWFuLkZB\nTFNFOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBuYW1lIG9mIHRoZSBwcmltYXJ5IGtleSB0YWJsZS4KICAgICAq\nLwogICAgcHVibGljIFN0cmluZyBnZXRQcmltYXJ5S2V5VGFibGVOYW1lKCkg\newogICAgICAgIFRhYmxlIHRhYmxlID0gZ2V0UHJpbWFyeUtleVRhYmxlKCk7\nCiAgICAgICAgaWYgKHRhYmxlICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiB0YWJsZS5nZXROYW1lKCk7CiAgICAgICAgcmV0dXJuIF9wa1RhYmxlTmFt\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBuYW1lIG9mIHRoZSBwcmlt\nYXJ5IGtleSB0YWJsZS4gWW91IGNhbiBvbmx5IHNldCB0aGUgcHJpbWFyeQog\nICAgICoga2V5IHRhYmxlIG5hbWUgb24gZm9yZWlnbiBrZXlzIHRoYXQgaGF2\nZSBub3QgYWxyZWFkeSBiZWVuIGpvaW5lZC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0UHJpbWFyeUtleVRhYmxlTmFtZShTdHJpbmcgcGtUYWJsZU5h\nbWUpIHsKICAgICAgICBpZiAoZ2V0UHJpbWFyeUtleVRhYmxlKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlv\nbigpOwogICAgICAgIF9wa1RhYmxlTmFtZSA9IHBrVGFibGVOYW1lOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhlIHByaW1hcnkga2V5\nIHRhYmxlJ3Mgc2NoZW1hLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFByaW1hcnlLZXlTY2hlbWFOYW1lKCkgewogICAgICAgIFRhYmxlIHRhYmxl\nID0gZ2V0UHJpbWFyeUtleVRhYmxlKCk7CiAgICAgICAgaWYgKHRhYmxlICE9\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiB0YWJsZS5nZXRTY2hlbWFOYW1l\nKCk7CiAgICAgICAgcmV0dXJuIF9wa1NjaGVtYU5hbWU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcHJpbWFyeSBrZXkgdGFibGUn\ncyBzY2hlbWEuIFlvdSBjYW4gb25seSBzZXQgdGhlCiAgICAgKiBwcmltYXJ5\nIGtleSBzY2hlbWEgbmFtZSBvbiBmb3JlaWduIGtleXMgdGhhdCBoYXZlIG5v\ndCBhbHJlYWR5IGJlZW4KICAgICAqIGpvaW5lZC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0UHJpbWFyeUtleVNjaGVtYU5hbWUoU3RyaW5nIHBrU2No\nZW1hTmFtZSkgewogICAgICAgIGlmIChnZXRQcmltYXJ5S2V5VGFibGUoKSAh\nPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uKCk7CiAgICAgICAgX3BrU2NoZW1hTmFtZSA9IHBrU2NoZW1hTmFt\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBuYW1lIG9mIHRoZSBwcmlt\nYXJ5IGtleSBjb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0\nUHJpbWFyeUtleUNvbHVtbk5hbWUoKSB7CiAgICAgICAgcmV0dXJuIF9wa0Nv\nbHVtbk5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0\naGUgcHJpbWFyeSBrZXkgY29sdW1uLiBZb3UgY2FuIG9ubHkgc2V0IHRoZQog\nICAgICogcHJpbWFyeSBrZXkgY29sdW1uIG5hbWUgb24gZm9yZWlnbiBrZXlz\nIHRoYXQgaGF2ZSBub3QgYWxyZWFkeSBiZWVuCiAgICAgKiBqb2luZWQuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXlDb2x1bW5OYW1l\nKFN0cmluZyBwa0NvbHVtbk5hbWUpIHsKICAgICAgICBpZiAoZ2V0UHJpbWFy\neUtleVRhYmxlKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAgIF9wa0NvbHVtbk5hbWUg\nPSBwa0NvbHVtbk5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2Vx\ndWVuY2Ugb2YgdGhpcyBqb2luIGluIHRoZSBmb3JlaWduIGtleS4KICAgICAq\nLwogICAgcHVibGljIGludCBnZXRLZXlTZXF1ZW5jZSgpIHsKICAgICAgICBy\nZXR1cm4gX3NlcTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzZXF1ZW5j\nZSBvZiB0aGlzIGpvaW4gaW4gdGhlIGZvcmVpZ24ga2V5LgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRLZXlTZXF1ZW5jZShpbnQgc2VxKSB7CiAgICAg\nICAgX3NlcSA9IHNlcTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgZGVsZXRlIGFjdGlvbiBmb3IgdGhlIGtleS4gV2lsbCBiZSBvbmUgb2Y6\nCiAgICAgKiB7QGxpbmsgI0FDVElPTl9OT05FfSwge0BsaW5rICNBQ1RJT05f\nUkVTVFJJQ1R9LAogICAgICoge0BsaW5rICNBQ1RJT05fQ0FTQ0FERX0sIHtA\nbGluayAjQUNUSU9OX05VTEx9LCB7QGxpbmsgI0FDVElPTl9ERUZBVUxUfS4K\nICAgICAqLwogICAgcHVibGljIGludCBnZXREZWxldGVBY3Rpb24oKSB7CiAg\nICAgICAgcmV0dXJuIF9kZWxBY3Rpb247CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIGRlbGV0ZSBhY3Rpb24gZm9yIHRoZSBrZXkuIE11c3QgYmUg\nb25lIG9mOgogICAgICoge0BsaW5rICNBQ1RJT05fTk9ORX0sIHtAbGluayAj\nQUNUSU9OX1JFU1RSSUNUfSwKICAgICAqIHtAbGluayAjQUNUSU9OX0NBU0NB\nREV9LCB7QGxpbmsgI0FDVElPTl9OVUxMfSwge0BsaW5rICNBQ1RJT05fREVG\nQVVMVH0uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERlbGV0ZUFjdGlv\nbihpbnQgYWN0aW9uKSB7CiAgICAgICAgX2RlbEFjdGlvbiA9IGFjdGlvbjsK\nICAgICAgICBpZiAoYWN0aW9uID09IEFDVElPTl9OT05FKQogICAgICAgICAg\nICBfdXBBY3Rpb24gPSBBQ1RJT05fTk9ORTsKICAgICAgICBlbHNlIGlmIChf\ndXBBY3Rpb24gPT0gQUNUSU9OX05PTkUpCiAgICAgICAgICAgIF91cEFjdGlv\nbiA9IEFDVElPTl9SRVNUUklDVDsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgdXBkYXRlIGFjdGlvbiBmb3IgdGhlIGtleS4gV2lsbCBiZSBv\nbmUgb2Y6CiAgICAgKiB7QGxpbmsgI0FDVElPTl9OT05FfSwge0BsaW5rICNB\nQ1RJT05fUkVTVFJJQ1R9LAogICAgICoge0BsaW5rICNBQ1RJT05fQ0FTQ0FE\nRX0sIHtAbGluayAjQUNUSU9OX05VTEx9LCB7QGxpbmsgI0FDVElPTl9ERUZB\nVUxUfS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRVcGRhdGVBY3Rpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF91cEFjdGlvbjsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgdXBkYXRlIGFjdGlvbiBmb3IgdGhlIGtleS4gTXVz\ndCBiZSBvbmUgb2Y6CiAgICAgKiB7QGxpbmsgI0FDVElPTl9OT05FfSwge0Bs\naW5rICNBQ1RJT05fUkVTVFJJQ1R9LAogICAgICoge0BsaW5rICNBQ1RJT05f\nQ0FTQ0FERX0sIHtAbGluayAjQUNUSU9OX05VTEx9LCB7QGxpbmsgI0FDVElP\nTl9ERUZBVUxUfS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VXBkYXRl\nQWN0aW9uKGludCBhY3Rpb24pIHsKICAgICAgICBfdXBBY3Rpb24gPSBhY3Rp\nb247CiAgICAgICAgaWYgKGFjdGlvbiA9PSBBQ1RJT05fTk9ORSkKICAgICAg\nICAgICAgX2RlbEFjdGlvbiA9IEFDVElPTl9OT05FOwogICAgICAgIGVsc2Ug\naWYgKF9kZWxBY3Rpb24gPT0gQUNUSU9OX05PTkUpCiAgICAgICAgICAgIF9k\nZWxBY3Rpb24gPSBBQ1RJT05fUkVTVFJJQ1Q7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIGZvcmVpZ24ga2V5J3MgMC1iYXNlZCBpbmRleCBp\nbiB0aGUgb3duaW5nIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgaW50IGdl\ndEluZGV4KCkgewogICAgICAgIFRhYmxlIHRhYmxlID0gZ2V0VGFibGUoKTsK\nICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgdGFibGUu\naW5kZXhGb3JlaWduS2V5cygpOwogICAgICAgIHJldHVybiBfaW5kZXg7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGZvcmVpZ24ga2V5J3MgMC1i\nYXNlZCBpbmRleCBpbiB0aGUgb3duaW5nIHRhYmxlLgogICAgICovCiAgICB2\nb2lkIHNldEluZGV4KGludCBpbmRleCkgewogICAgICAgIF9pbmRleCA9IGlu\nZGV4OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwcmltYXJ5\nIGtleSBjb2x1bW4gam9pbmVkIHRvIHRoZSBnaXZlbiBsb2NhbCBjb2x1bW4u\nCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW4gZ2V0UHJpbWFyeUtleUNvbHVt\nbihDb2x1bW4gbG9jYWwpIHsKICAgICAgICByZXR1cm4gKF9qb2lucyA9PSBu\ndWxsKSA/IG51bGwgOiAoQ29sdW1uKSBfam9pbnMuZ2V0KGxvY2FsKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbG9jYWwgY29sdW1uIGpv\naW5lZCB0byB0aGUgZ2l2ZW4gcHJpbWFyeSBrZXkgY29sdW1uLgogICAgICov\nCiAgICBwdWJsaWMgQ29sdW1uIGdldENvbHVtbihDb2x1bW4gcGspIHsKICAg\nICAgICByZXR1cm4gKF9qb2luc1BLID09IG51bGwpID8gbnVsbCA6IChDb2x1\nbW4pIF9qb2luc1BLLmdldChwayk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGNvbnN0YW50IHZhbHVlIGFzc2lnbmVkIHRvIHRoZSBnaXZl\nbiBsb2NhbCBjb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0\nQ29uc3RhbnQoQ29sdW1uIGxvY2FsKSB7CiAgICAgICAgcmV0dXJuIChfY29u\nc3RzID09IG51bGwpID8gbnVsbCA6IF9jb25zdHMuZ2V0KGxvY2FsKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29uc3RhbnQgdmFsdWUg\nYXNzaWduZWQgdG8gdGhlIGdpdmVuIHByaW1hcnkga2V5IGNvbHVtbi4KICAg\nICAqLwogICAgcHVibGljIE9iamVjdCBnZXRQcmltYXJ5S2V5Q29uc3RhbnQo\nQ29sdW1uIHBrKSB7CiAgICAgICAgcmV0dXJuIChfY29uc3RzUEsgPT0gbnVs\nbCkgPyBudWxsIDogX2NvbnN0c1BLLmdldChwayk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIGxvY2FsIGNvbHVtbnMgaW4gdGhlIGZvcmVp\nZ24ga2V5IGxvY2FsIHRhYmxlIG9yZGVyLgogICAgICovCiAgICBwdWJsaWMg\nQ29sdW1uW10gZ2V0Q29sdW1ucygpIHsKICAgICAgICBpZiAoX2xvY2FscyA9\nPSBudWxsKQogICAgICAgICAgICBfbG9jYWxzID0gKF9qb2lucyA9PSBudWxs\nKSA/IFNjaGVtYXMuRU1QVFlfQ09MVU1OUyA6IChDb2x1bW5bXSkKICAgICAg\nICAgICAgICAgIF9qb2lucy5rZXlTZXQoKS50b0FycmF5KG5ldyBDb2x1bW5b\nX2pvaW5zLnNpemUoKV0pOwogICAgICAgIHJldHVybiBfbG9jYWxzOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb25zdGFudCB2YWx1ZXMg\nYXNzaWduZWQgdG8gdGhlIGxvY2FsIGNvbHVtbnMKICAgICAqIHJldHVybmVk\nIGJ5IHtAbGluayAjZ2V0Q29uc3RhbnRDb2x1bW5zfS4KICAgICAqLwogICAg\ncHVibGljIE9iamVjdFtdIGdldENvbnN0YW50cygpIHsKICAgICAgICBpZiAo\nX2NvbnN0VmFscyA9PSBudWxsKQogICAgICAgICAgICBfY29uc3RWYWxzID0g\nKF9jb25zdHMgPT0gbnVsbCkgPyBTY2hlbWFzLkVNUFRZX1ZBTFVFUwogICAg\nICAgICAgICAgICAgOiBfY29uc3RzLnZhbHVlcygpLnRvQXJyYXkoKTsKICAg\nICAgICByZXR1cm4gX2NvbnN0VmFsczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgY29uc3RhbnQgdmFsdWVzIGFzc2lnbmVkIHRvIHRoZSBw\ncmltYXJ5IGtleSBjb2x1bW5zCiAgICAgKiByZXR1cm5lZCBieSB7QGxpbmsg\nI2dldENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnN9LgogICAgICovCiAgICBw\ndWJsaWMgT2JqZWN0W10gZ2V0UHJpbWFyeUtleUNvbnN0YW50cygpIHsKICAg\nICAgICBpZiAoX2NvbnN0VmFsc1BLID09IG51bGwpCiAgICAgICAgICAgIF9j\nb25zdFZhbHNQSyA9IChfY29uc3RzUEsgPT0gbnVsbCkgPyBTY2hlbWFzLkVN\nUFRZX1ZBTFVFUwogICAgICAgICAgICAgICAgOiBfY29uc3RzUEsudmFsdWVz\nKCkudG9BcnJheSgpOwogICAgICAgIHJldHVybiBfY29uc3RWYWxzUEs7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZmsgaW5j\nbHVkZXMgdGhlIGdpdmVuIGxvY2FsIGNvbHVtbi4KICAgICAqLwogICAgcHVi\nbGljIGJvb2xlYW4gY29udGFpbnNDb2x1bW4oQ29sdW1uIGNvbCkgewogICAg\nICAgIHJldHVybiBfam9pbnMgIT0gbnVsbCAmJiBfam9pbnMuY29udGFpbnNL\nZXkoY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlm\nIHRoZSBmayBpbmNsdWRlcyB0aGUgZ2l2ZW4gcHJpbWFyeSBrZXkgY29sdW1u\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc1ByaW1hcnlL\nZXlDb2x1bW4oQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBfam9pbnNQ\nSyAhPSBudWxsICYmIF9qb2luc1BLLmNvbnRhaW5zS2V5KGNvbCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZmsgaW5jbHVk\nZXMgdGhlIGdpdmVuIGxvY2FsIGNvbHVtbi4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gY29udGFpbnNDb25zdGFudENvbHVtbihDb2x1bW4gY29sKSB7\nCiAgICAgICAgcmV0dXJuIF9jb25zdHMgIT0gbnVsbCAmJiBfY29uc3RzLmNv\nbnRhaW5zS2V5KGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndHJ1ZSBpZiB0aGUgZmsgaW5jbHVkZXMgdGhlIGdpdmVuIHByaW1hcnkga2V5\nIGNvbHVtbi4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnND\nb25zdGFudFByaW1hcnlLZXlDb2x1bW4oQ29sdW1uIGNvbCkgewogICAgICAg\nIHJldHVybiBfY29uc3RzUEsgIT0gbnVsbCAmJiBfY29uc3RzUEsuY29udGFp\nbnNLZXkoY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\nZm9yZWlnbiBjb2x1bW5zIGluIHRoZSBmb3JlaWduIGtleSwgaW4gam9pbi1v\ncmRlciB3aXRoCiAgICAgKiB0aGUgcmVzdWx0IG9mIHtAbGluayAjZ2V0Q29s\ndW1uc30uCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRQcmltYXJ5\nS2V5Q29sdW1ucygpIHsKICAgICAgICBpZiAoX3BrcyA9PSBudWxsKQogICAg\nICAgICAgICBfcGtzID0gKF9qb2lucyA9PSBudWxsKSA/IFNjaGVtYXMuRU1Q\nVFlfQ09MVU1OUyA6IChDb2x1bW5bXSkKICAgICAgICAgICAgICAgIF9qb2lu\ncy52YWx1ZXMoKS50b0FycmF5KG5ldyBDb2x1bW5bX2pvaW5zLnNpemUoKV0p\nOwogICAgICAgIHJldHVybiBfcGtzOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBsb2NhbCBjb2x1bW5zIHRoYXQgd2UgbGluayB0byB1c2lu\nZyBjb25zdGFudCB2YWx1ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5b\nXSBnZXRDb25zdGFudENvbHVtbnMoKSB7CiAgICAgICAgaWYgKF9jb25zdENv\nbHMgPT0gbnVsbCkKICAgICAgICAgICAgX2NvbnN0Q29scyA9IChfY29uc3Rz\nID09IG51bGwpID8gU2NoZW1hcy5FTVBUWV9DT0xVTU5TIDogKENvbHVtbltd\nKQogICAgICAgICAgICAgICAgX2NvbnN0cy5rZXlTZXQoKS50b0FycmF5KG5l\ndyBDb2x1bW5bX2NvbnN0cy5zaXplKCldKTsKICAgICAgICByZXR1cm4gX2Nv\nbnN0Q29sczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcHJp\nbWFyeSBrZXkgY29sdW1ucyB0aGF0IHdlIGxpbmsgdG8gdXNpbmcgY29uc3Rh\nbnQgdmFsdWVzLgogICAgICovCiAgICBwdWJsaWMgQ29sdW1uW10gZ2V0Q29u\nc3RhbnRQcmltYXJ5S2V5Q29sdW1ucygpIHsKICAgICAgICBpZiAoX2NvbnN0\nQ29sc1BLID09IG51bGwpCiAgICAgICAgICAgIF9jb25zdENvbHNQSyA9IChf\nY29uc3RzUEsgPT0gbnVsbCkgPyBTY2hlbWFzLkVNUFRZX0NPTFVNTlMgOgog\nICAgICAgICAgICAgICAgKENvbHVtbltdKSBfY29uc3RzUEsua2V5U2V0KCku\ndG9BcnJheQogICAgICAgICAgICAgICAgICAgIChuZXcgQ29sdW1uW19jb25z\ndHNQSy5zaXplKCldKTsKICAgICAgICByZXR1cm4gX2NvbnN0Q29sc1BLOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBmb3JlaWduIGtleSdzIGpv\naW5zLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRKb2lucyhDb2x1bW5b\nXSBjb2xzLCBDb2x1bW5bXSBwa0NvbHMpIHsKICAgICAgICBDb2x1bW5bXSBj\ndXIgPSBnZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjdXIubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZUpvaW4oY3Vy\nW2ldKTsKCiAgICAgICAgaWYgKGNvbHMgIT0gbnVsbCkKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgam9pbihjb2xzW2ldLCBwa0NvbHNbaV0pOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBmb3JlaWduIGtleSdzIGNvbnN0YW50IGpv\naW5zLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRDb25zdGFudEpvaW5z\nKE9iamVjdFtdIGNvbnN0cywgQ29sdW1uW10gcGtDb2xzKSB7CiAgICAgICAg\nQ29sdW1uW10gY3VyID0gZ2V0Q29uc3RhbnRQcmltYXJ5S2V5Q29sdW1ucygp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY3VyLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICByZW1vdmVKb2luKGN1cltpXSk7CgogICAgICAgIGlm\nIChjb25zdHMgIT0gbnVsbCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjb25zdHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBqb2lu\nQ29uc3RhbnQoY29uc3RzW2ldLCBwa0NvbHNbaV0pOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBmb3JlaWduIGtleSdzIGNvbnN0YW50IGpvaW5z\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRDb25zdGFudEpvaW5zKENv\nbHVtbltdIGNvbHMsIE9iamVjdFtdIGNvbnN0cykgewogICAgICAgIENvbHVt\nbltdIGN1ciA9IGdldENvbnN0YW50Q29sdW1ucygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY3VyLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBy\nZW1vdmVKb2luKGN1cltpXSk7CgogICAgICAgIGlmIChjb25zdHMgIT0gbnVs\nbCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb25zdHMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBqb2luQ29uc3RhbnQoY29sc1tp\nXSwgY29uc3RzW2ldKTsKICAgIH0KCiAgICAvKioKICAgICAqIEpvaW4gYSBs\nb2NhbCBjb2x1bW4gdG8gYSBwcmltYXJ5IGtleSBjb2x1bW4gb2YgYW5vdGhl\nciB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgam9pbihDb2x1bW4g\nbG9jYWwsIENvbHVtbiB0b1BLKSB7CiAgICAgICAgaWYgKCFPYmplY3RVdGls\ncy5lcXVhbHMobG9jYWwuZ2V0VGFibGUoKSwgZ2V0VGFibGUoKSkpCiAgICAg\nICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5n\nZXQoInRhYmxlLW1pc21hdGNoIiwKICAgICAgICAgICAgICAgIGxvY2FsLmdl\ndFRhYmxlKCksIGdldFRhYmxlKCkpKTsKCiAgICAgICAgVGFibGUgcGtUYWJs\nZSA9IHRvUEsuZ2V0VGFibGUoKTsKICAgICAgICBpZiAoX3BrVGFibGUgIT0g\nbnVsbCAmJiAhX3BrVGFibGUuZXF1YWxzKHBrVGFibGUpKQogICAgICAgICAg\nICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJm\nay1taXNtYXRjaCIsCiAgICAgICAgICAgICAgICBwa1RhYmxlLCBfcGtUYWJs\nZSkpOwoKICAgICAgICBfcGtUYWJsZSA9IHBrVGFibGU7CiAgICAgICAgaWYg\nKF9qb2lucyA9PSBudWxsKQogICAgICAgICAgICBfam9pbnMgPSBuZXcgTGlu\na2VkTWFwKCk7CiAgICAgICAgX2pvaW5zLnB1dChsb2NhbCwgdG9QSyk7CiAg\nICAgICAgaWYgKF9qb2luc1BLID09IG51bGwpCiAgICAgICAgICAgIF9qb2lu\nc1BLID0gbmV3IExpbmtlZE1hcCgpOwogICAgICAgIF9qb2luc1BLLnB1dCh0\nb1BLLCBsb2NhbCk7CgogICAgICAgIC8vIGZvcmNlIHJlLWNhY2hlCiAgICAg\nICAgX2xvY2FscyA9IG51bGw7CiAgICAgICAgX3BrcyA9IG51bGw7CiAgICAg\nICAgaWYgKF9hdXRvQXNzaWduID09IEJvb2xlYW4uRkFMU0UpCiAgICAgICAg\nICAgIF9hdXRvQXNzaWduID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIEpvaW4gYSBjb25zdGFudCB2YWx1ZSB0byBhIHByaW1hcnkga2V5IGNvbHVt\nbiBvZiBhbm90aGVyIHRhYmxlLiBUaGUKICAgICAqIGNvbnN0YW50IG11c3Qg\nYmUgZWl0aGVyIGEgc3RyaW5nIG9yIGEgbnVtYmVyLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBqb2luQ29uc3RhbnQoT2JqZWN0IHZhbCwgQ29sdW1uIHRv\nUEspIHsKICAgICAgICBUYWJsZSBwa1RhYmxlID0gdG9QSy5nZXRUYWJsZSgp\nOwogICAgICAgIGlmIChfcGtUYWJsZSAhPSBudWxsICYmICFfcGtUYWJsZS5l\ncXVhbHMocGtUYWJsZSkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlk\nU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImZrLW1pc21hdGNoIiwKICAgICAg\nICAgICAgICAgIHBrVGFibGUsIF9wa1RhYmxlKSk7CgogICAgICAgIF9wa1Rh\nYmxlID0gcGtUYWJsZTsKICAgICAgICBpZiAoX2NvbnN0c1BLID09IG51bGwp\nCiAgICAgICAgICAgIF9jb25zdHNQSyA9IG5ldyBMaW5rZWRNYXAoKTsKICAg\nICAgICBfY29uc3RzUEsucHV0KHRvUEssIHZhbCk7CgogICAgICAgIC8vIGZv\ncmNlIHJlLWNhY2hlCiAgICAgICAgX2NvbnN0VmFsc1BLID0gbnVsbDsKICAg\nICAgICBfY29uc3RDb2xzUEsgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogSm9pbiBhIGNvbnN0YW50IHZhbHVlIHRvIGEgbG9jYWwgY29sdW1uIG9m\nIHRoaXMgdGFibGUuIFRoZQogICAgICogY29uc3RhbnQgbXVzdCBiZSBlaXRo\nZXIgYSBzdHJpbmcgb3IgYSBudW1iZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGpvaW5Db25zdGFudChDb2x1bW4gY29sLCBPYmplY3QgdmFsKSB7CiAg\nICAgICAgaWYgKF9jb25zdHMgPT0gbnVsbCkKICAgICAgICAgICAgX2NvbnN0\ncyA9IG5ldyBMaW5rZWRNYXAoKTsKICAgICAgICBfY29uc3RzLnB1dChjb2ws\nIHZhbCk7CgogICAgICAgIC8vIGZvcmNlIHJlLWNhY2hlCiAgICAgICAgX2Nv\nbnN0VmFscyA9IG51bGw7CiAgICAgICAgX2NvbnN0Q29scyA9IG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgYW55IGpvaW5zIGlub2x2aW5n\nIHRoZSBnaXZlbiBjb2x1bW4uCiAgICAgKgogICAgICogQHJldHVybiB0cnVl\nIGlmIHRoZSBqb2luIHdhcyByZW1vdmVkLCBmYWxzZSBpZiBub3QgcGFydCBv\nZiB0aGUga2V5CiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUpv\naW4oQ29sdW1uIGNvbCkgewogICAgICAgIGJvb2xlYW4gcmVtZCA9IGZhbHNl\nOwogICAgICAgIE9iamVjdCByZW07CgogICAgICAgIGlmIChfam9pbnMgIT0g\nbnVsbCkgewogICAgICAgICAgICByZW0gPSBfam9pbnMucmVtb3ZlKGNvbCk7\nCiAgICAgICAgICAgIGlmIChyZW0gIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgX2xvY2FscyA9IG51bGw7CiAgICAgICAgICAgICAgICBfcGtzID0gbnVs\nbDsKICAgICAgICAgICAgICAgIF9qb2luc1BLLnJlbW92ZShyZW0pOwogICAg\nICAgICAgICAgICAgcmVtZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIGlmIChfam9pbnNQSyAhPSBudWxsKSB7CiAgICAgICAg\nICAgIHJlbSA9IF9qb2luc1BLLnJlbW92ZShjb2wpOwogICAgICAgICAgICBp\nZiAocmVtICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIF9sb2NhbHMgPSBu\ndWxsOwogICAgICAgICAgICAgICAgX3BrcyA9IG51bGw7CiAgICAgICAgICAg\nICAgICBfam9pbnMucmVtb3ZlKHJlbSk7CiAgICAgICAgICAgICAgICByZW1k\nID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYg\nKF9jb25zdHMgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAoX2NvbnN0cy5y\nZW1vdmUoY29sKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfY29uc3RW\nYWxzID0gbnVsbDsKICAgICAgICAgICAgICAgIF9jb25zdENvbHMgPSBudWxs\nOwogICAgICAgICAgICAgICAgcmVtZCA9IHRydWU7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIGlmIChfY29uc3RzUEsgIT0gbnVsbCkgewog\nICAgICAgICAgICBpZiAoX2NvbnN0c1BLLmNvbnRhaW5zS2V5KGNvbCkpIHsK\nICAgICAgICAgICAgICAgIF9jb25zdHNQSy5yZW1vdmUoY29sKTsKICAgICAg\nICAgICAgICAgIF9jb25zdFZhbHNQSyA9IG51bGw7CiAgICAgICAgICAgICAg\nICBfY29uc3RDb2xzUEsgPSBudWxsOwogICAgICAgICAgICAgICAgcmVtZCA9\nIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgo\nX2pvaW5zID09IG51bGwgfHwgX2pvaW5zLmlzRW1wdHkoKSkKICAgICAgICAg\nICAgJiYgKF9jb25zdHNQSyA9PSBudWxsIHx8IF9jb25zdHNQSy5pc0VtcHR5\nKCkpKQogICAgICAgICAgICBfcGtUYWJsZSA9IG51bGw7CiAgICAgICAgaWYg\nKHJlbWQgJiYgX2F1dG9Bc3NpZ24gPT0gQm9vbGVhbi5UUlVFKQogICAgICAg\nICAgICBfYXV0b0Fzc2lnbiA9IG51bGw7CiAgICAgICAgcmV0dXJuIHJlbWQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB0YWJsZSB0aGlz\nIGZvcmVpZ24ga2V5IGlzIGxpbmtpbmcgdG8sIGlmIGl0IGlzIGtub3duIHll\ndC4KICAgICAqLwogICAgcHVibGljIFRhYmxlIGdldFByaW1hcnlLZXlUYWJs\nZSgpIHsKICAgICAgICByZXR1cm4gX3BrVGFibGU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZWYgYWxsIGNvbHVtbnMgaW4gdGhpcyBrZXkuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHJlZkNvbHVtbnMoKSB7CiAgICAgICAgQ29sdW1u\nW10gY29scyA9IGdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvbHNbaV0u\ncmVmKCk7CiAgICAgICAgY29scyA9IGdldENvbnN0YW50Q29sdW1ucygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgY29sc1tpXS5yZWYoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIERlcmVmIGFsbCBjb2x1bW5zIGluIHRoaXMga2V5LgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBkZXJlZkNvbHVtbnMoKSB7CiAgICAgICAgQ29sdW1u\nW10gY29scyA9IGdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvbHNbaV0u\nZGVyZWYoKTsKICAgICAgICBjb2xzID0gZ2V0Q29uc3RhbnRDb2x1bW5zKCk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICBjb2xzW2ldLmRlcmVmKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBGb3JlaWduIGtleXMgYXJlIGVxdWFsIGlmIHRoZSBzYXRpc2Z5\nIHRoZSBlcXVhbGl0eSBjb25zdHJhaW50cyBvZgogICAgICoge0BsaW5rIENv\nbnN0cmFpbnR9IGFuZCB0aGV5IGhhdmUgdGhlIHNhbWUgbG9jYWwgYW5kIHBy\naW1hcnkga2V5CiAgICAgKiBjb2x1bW5zIGFuZCBhY3Rpb24uCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGVxdWFsc0ZvcmVpZ25LZXkoRm9yZWlnbktl\neSBmaykgewogICAgICAgIGlmIChmayA9PSB0aGlzKQogICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAoZ2V0RGVsZXRlQWN0aW9u\nKCkgIT0gZmsuZ2V0RGVsZXRlQWN0aW9uKCkpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICBpZiAoaXNEZWZlcnJlZCgpICE9IGZrLmlzRGVm\nZXJyZWQoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBp\nZiAoIWNvbHVtbnNNYXRjaChmay5nZXRDb2x1bW5zKCksIGZrLmdldFByaW1h\ncnlLZXlDb2x1bW5zKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgaWYgKCFtYXRjaChnZXRDb25zdGFudENvbHVtbnMoKSwgZmsuZ2V0\nQ29uc3RhbnRDb2x1bW5zKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgaWYgKCFtYXRjaChnZXRDb25zdGFudHMoKSwgZmsuZ2V0Q29u\nc3RhbnRzKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\naWYgKCFtYXRjaChnZXRDb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCksCiAg\nICAgICAgICAgIGZrLmdldENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnMoKSkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoIW1hdGNo\nKGdldFByaW1hcnlLZXlDb25zdGFudHMoKSwgZmsuZ2V0UHJpbWFyeUtleUNv\nbnN0YW50cygpKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRy\ndWUgaWYgdGhlIGdpdmVuIGxvY2FsIGFuZCBmb3JlaWduIGNvbHVtbnMgbWF0\nY2ggdGhvc2UKICAgICAqIG9uIHRoaXMga2V5LiBUaGlzIGNhbiBiZSB1c2Vk\nIHRvIGZpbmQgZm9yZWlnbiBrZXlzIGdpdmVuIG9ubHkKICAgICAqIGNvbHVt\nbiBsaW5raW5nIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJsaWMgYm9v\nbGVhbiBjb2x1bW5zTWF0Y2goQ29sdW1uW10gZmtDb2xzLCBDb2x1bW5bXSBm\na1BLQ29scykgewogICAgICAgIHJldHVybiBtYXRjaChnZXRDb2x1bW5zKCks\nIGZrQ29scykKICAgICAgICAgICAgJiYgbWF0Y2goZ2V0UHJpbWFyeUtleUNv\nbHVtbnMoKSwgZmtQS0NvbHMpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGlj\nIGJvb2xlYW4gbWF0Y2goQ29sdW1uW10gY29scywgQ29sdW1uW10gZmtDb2xz\nKSB7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoICE9IGZrQ29scy5sZW5ndGgp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGZrQ29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYg\nKCFoYXNDb2x1bW4oY29scywgZmtDb2xzW2ldKSkKICAgICAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGhhc0NvbHVtbihDb2x1bW5bXSBj\nb2xzLCBDb2x1bW4gY29sKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29sc1tpXS5n\nZXRGdWxsTmFtZSgpLmVxdWFsc0lnbm9yZUNhc2UoY29sLmdldEZ1bGxOYW1l\nKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\nbWF0Y2goT2JqZWN0W10gdmFscywgT2JqZWN0W10gZmtWYWxzKSB7CiAgICAg\nICAgaWYgKHZhbHMubGVuZ3RoICE9IGZrVmFscy5sZW5ndGgpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHZhbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmICghT2JqZWN0VXRp\nbHMuZXF1YWxzKHZhbHNbaV0sIGZrVmFsc1tpXSkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0K\n","encoding":"base64"}

