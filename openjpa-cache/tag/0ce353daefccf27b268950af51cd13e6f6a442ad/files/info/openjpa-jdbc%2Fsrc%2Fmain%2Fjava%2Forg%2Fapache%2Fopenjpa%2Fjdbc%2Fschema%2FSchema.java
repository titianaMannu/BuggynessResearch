{"sha":"ec519af1bedc9cc44f934fb93abfa632cc09cee4","node_id":"MDQ6QmxvYjIwNjM2NDplYzUxOWFmMWJlZGM5Y2M0NGY5MzRmYjkzYWJmYTYzMmNjMDljZWU0","size":7088,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ec519af1bedc9cc44f934fb93abfa632cc09cee4","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLlRyZWVNYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CgovKioKICogUmVwcmVzZW50cyBh\nIGRhdGFiYXNlIHNjaGVtYS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICov\nCnB1YmxpYyBjbGFzcyBTY2hlbWEKICAgIGltcGxlbWVudHMgQ29tcGFyYWJs\nZSB7CgogICAgcHJpdmF0ZSBTdHJpbmcgX25hbWUgPSBudWxsOwogICAgcHJp\ndmF0ZSBTY2hlbWFHcm91cCBfZ3JvdXAgPSBudWxsOwogICAgcHJpdmF0ZSBN\nYXAgX3RhYmxlTWFwID0gbnVsbDsKICAgIHByaXZhdGUgTWFwIF9zZXFNYXAg\nPSBudWxsOwoKICAgIC8vIGNhY2hlCiAgICBwcml2YXRlIFRhYmxlW10gX3Rh\nYmxlcyA9IG51bGw7CiAgICBwcml2YXRlIFNlcXVlbmNlW10gX3NlcXMgPSBu\ndWxsOwoKICAgIC8qKgogICAgICogRGVmYXVsdCBjb25zdHJ1Y3Rvci4KICAg\nICAqLwogICAgcHVibGljIFNjaGVtYSgpIHsKICAgIH0KCiAgICAvKioKICAg\nICAqIENvbnN0cnVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBuYW1lIHRo\nZSBzY2hlbWEgbmFtZSwgaWYgYW55CiAgICAgKiBAcGFyYW0gZ3JvdXAgdGhl\nIHNjaGVtYSdzIG93bmluZyBncm91cAogICAgICovCiAgICBwdWJsaWMgU2No\nZW1hKFN0cmluZyBuYW1lLCBTY2hlbWFHcm91cCBncm91cCkgewogICAgICAg\nIHNldE5hbWUobmFtZSk7CiAgICAgICAgX2dyb3VwID0gZ3JvdXA7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgc2NoZW1hIGlzIHJl\nbW92ZWQgZnJvbSBpdHMgZ3JvdXAuIEludmFsaWRhdGVzIHRoZQogICAgICog\nc2NoZW1hIGFuZCByZW1vdmVzIGFsbCBpdHMgbWVtYmVyIHRhYmxlcy4KICAg\nICAqLwogICAgdm9pZCByZW1vdmUoKSB7CiAgICAgICAgVGFibGVbXSB0YWJz\nID0gZ2V0VGFibGVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0\nYWJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICByZW1vdmVUYWJsZSh0YWJz\nW2ldKTsKICAgICAgICBTZXF1ZW5jZVtdIHNlcXMgPSBnZXRTZXF1ZW5jZXMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlcXMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIHJlbW92ZVNlcXVlbmNlKHNlcXNbaV0pOwogICAg\nICAgIF9ncm91cCA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIHNjaGVtYSdzIGdyb3VwLgogICAgICovCiAgICBwdWJsaWMgU2No\nZW1hR3JvdXAgZ2V0U2NoZW1hR3JvdXAoKSB7CiAgICAgICAgcmV0dXJuIF9n\ncm91cDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbmFtZSBv\nZiB0aGUgc2NoZW1hLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsKICAgICAgICByZXR1cm4gX25hbWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG5hbWUgb2YgdGhlIHNj\naGVtYS4gVGhpcyBtZXRob2QgY2FuIG9ubHkgYmUgdXNlZCBmb3Igc2NoZW1h\ncwogICAgICogbm90IGF0dGFjaGVkIHRvIGEgZ3JvdXAuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldE5hbWUoU3RyaW5nIG5hbWUpIHsKICAgICAgICBp\nZiAoZ2V0U2NoZW1hR3JvdXAoKSAhPSBudWxsKQogICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgX25hbWUg\nPSBTdHJpbmdVdGlscy50cmltVG9OdWxsKG5hbWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBzY2hlbWEncyB0YWJsZXMuCiAgICAgKi8K\nICAgIHB1YmxpYyBUYWJsZVtdIGdldFRhYmxlcygpIHsKICAgICAgICBpZiAo\nX3RhYmxlcyA9PSBudWxsKQogICAgICAgICAgICBfdGFibGVzID0gKF90YWJs\nZU1hcCA9PSBudWxsKSA/IG5ldyBUYWJsZVswXSA6IChUYWJsZVtdKQogICAg\nICAgICAgICAgICAgX3RhYmxlTWFwLnZhbHVlcygpLnRvQXJyYXkobmV3IFRh\nYmxlW190YWJsZU1hcC5zaXplKCldKTsKICAgICAgICByZXR1cm4gX3RhYmxl\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdGFibGUgd2l0\naCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAg\nICBwdWJsaWMgVGFibGUgZ2V0VGFibGUoU3RyaW5nIG5hbWUpIHsKICAgICAg\nICBpZiAobmFtZSA9PSBudWxsIHx8IF90YWJsZU1hcCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gKFRhYmxlKSBf\ndGFibGVNYXAuZ2V0KG5hbWUudG9VcHBlckNhc2UoKSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBZGQgYSB0YWJsZSB0byB0aGUgc2NoZW1hLgogICAgICov\nCiAgICBwdWJsaWMgVGFibGUgYWRkVGFibGUoU3RyaW5nIG5hbWUpIHsKICAg\nICAgICBTY2hlbWFHcm91cCBncm91cCA9IGdldFNjaGVtYUdyb3VwKCk7CiAg\nICAgICAgVGFibGUgdGFiOwogICAgICAgIGlmIChncm91cCAhPSBudWxsKSB7\nCiAgICAgICAgICAgIGdyb3VwLmFkZE5hbWUobmFtZSwgdHJ1ZSk7CiAgICAg\nICAgICAgIHRhYiA9IGdyb3VwLm5ld1RhYmxlKG5hbWUsIHRoaXMpOwogICAg\nICAgIH0gZWxzZQogICAgICAgICAgICB0YWIgPSBuZXcgVGFibGUobmFtZSwg\ndGhpcyk7CiAgICAgICAgaWYgKF90YWJsZU1hcCA9PSBudWxsKQogICAgICAg\nICAgICBfdGFibGVNYXAgPSBuZXcgVHJlZU1hcCgpOwogICAgICAgIF90YWJs\nZU1hcC5wdXQobmFtZS50b1VwcGVyQ2FzZSgpLCB0YWIpOwogICAgICAgIF90\nYWJsZXMgPSBudWxsOwogICAgICAgIHJldHVybiB0YWI7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIHRhYmxlIGZyb20gdGhlIHNj\naGVtYS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHRhYmxl\nIHdhcyByZW1vdmVkLCBmYWxzZSBpZiBub3QgaW4gdGhlIHNjaGVtYQogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVUYWJsZShUYWJsZSB0YWIp\nIHsKICAgICAgICBpZiAodGFiID09IG51bGwgfHwgX3RhYmxlTWFwID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgVGFibGUg\nY3VyID0gKFRhYmxlKSBfdGFibGVNYXAuZ2V0KHRhYi5nZXROYW1lKCkudG9V\ncHBlckNhc2UoKSk7CiAgICAgICAgaWYgKCFjdXIuZXF1YWxzKHRhYikpCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgX3RhYmxlTWFwLnJl\nbW92ZSh0YWIuZ2V0TmFtZSgpLnRvVXBwZXJDYXNlKCkpOwogICAgICAgIF90\nYWJsZXMgPSBudWxsOwogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0gZ2V0\nU2NoZW1hR3JvdXAoKTsKICAgICAgICBpZiAoZ3JvdXAgIT0gbnVsbCkKICAg\nICAgICAgICAgZ3JvdXAucmVtb3ZlTmFtZSh0YWIuZ2V0TmFtZSgpKTsKICAg\nICAgICB0YWIucmVtb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSB0YWJsZSBmcm9tIGFub3RoZXIg\nc2NoZW1hLgkgTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGRvZXMKICAgICAqIDxz\ndHJvbmc+bm90PC9zdHJvbmc+IGltcG9ydCBmb3JlaWduIGtleXMsIGluZGV4\nZXMsIG9yIHVuaXF1ZSBjb25zdHJhaW50cy4KICAgICAqLwogICAgcHVibGlj\nIFRhYmxlIGltcG9ydFRhYmxlKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgaWYg\nKHRhYmxlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAg\nICAgICBUYWJsZSBjb3B5ID0gYWRkVGFibGUodGFibGUuZ2V0TmFtZSgpKTsK\nICAgICAgICBDb2x1bW5bXSBjb2xzID0gdGFibGUuZ2V0Q29sdW1ucygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgY29weS5pbXBvcnRDb2x1bW4oY29sc1tpXSk7CgogICAg\nICAgIGNvcHkuaW1wb3J0UHJpbWFyeUtleSh0YWJsZS5nZXRQcmltYXJ5S2V5\nKCkpOwogICAgICAgIHJldHVybiBjb3B5OwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBzY2hlbWEncyBzZXF1ZW5jZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBTZXF1ZW5jZVtdIGdldFNlcXVlbmNlcygpIHsKICAgICAgICBp\nZiAoX3NlcXMgPT0gbnVsbCkKICAgICAgICAgICAgX3NlcXMgPSAoX3NlcU1h\ncCA9PSBudWxsKSA/IG5ldyBTZXF1ZW5jZVswXSA6IChTZXF1ZW5jZVtdKQog\nICAgICAgICAgICAgICAgX3NlcU1hcC52YWx1ZXMoKS50b0FycmF5KG5ldyBT\nZXF1ZW5jZVtfc2VxTWFwLnNpemUoKV0pOwogICAgICAgIHJldHVybiBfc2Vx\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2VxdWVuY2Ug\nd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVsbCBpZiBub25lLgogICAgICov\nCiAgICBwdWJsaWMgU2VxdWVuY2UgZ2V0U2VxdWVuY2UoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8IF9zZXFNYXAgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIChT\nZXF1ZW5jZSkgX3NlcU1hcC5nZXQobmFtZS50b1VwcGVyQ2FzZSgpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFkZCBhIHNlcXVlbmNlIHRvIHRoZSBzY2hl\nbWEuCiAgICAgKi8KICAgIHB1YmxpYyBTZXF1ZW5jZSBhZGRTZXF1ZW5jZShT\ndHJpbmcgbmFtZSkgewogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0gZ2V0\nU2NoZW1hR3JvdXAoKTsKICAgICAgICBTZXF1ZW5jZSBzZXE7CiAgICAgICAg\naWYgKGdyb3VwICE9IG51bGwpIHsKICAgICAgICAgICAgZ3JvdXAuYWRkTmFt\nZShuYW1lLCB0cnVlKTsKICAgICAgICAgICAgc2VxID0gZ3JvdXAubmV3U2Vx\ndWVuY2UobmFtZSwgdGhpcyk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAg\nIHNlcSA9IG5ldyBTZXF1ZW5jZShuYW1lLCB0aGlzKTsKICAgICAgICBpZiAo\nX3NlcU1hcCA9PSBudWxsKQogICAgICAgICAgICBfc2VxTWFwID0gbmV3IFRy\nZWVNYXAoKTsKICAgICAgICBfc2VxTWFwLnB1dChuYW1lLnRvVXBwZXJDYXNl\nKCksIHNlcSk7CiAgICAgICAgX3NlcXMgPSBudWxsOwogICAgICAgIHJldHVy\nbiBzZXE7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIGdpdmVu\nIHNlcXVlbmNlIGZyb20gdGhlIHNjaGVtYS4KICAgICAqCiAgICAgKiBAcmV0\ndXJuIHRydWUgaWYgdGhlIHNlcXVlbmNlIHdhcyByZW1vdmVkLCBmYWxzZSBp\nZiBub3QgaW4gdGhlIHNjaGVtYQogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiByZW1vdmVTZXF1ZW5jZShTZXF1ZW5jZSBzZXEpIHsKICAgICAgICBpZiAo\nc2VxID09IG51bGwgfHwgX3NlcU1hcCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIFNlcXVlbmNlIGN1ciA9IChTZXF1ZW5j\nZSkgX3NlcU1hcC5nZXQoc2VxLmdldE5hbWUoKS50b1VwcGVyQ2FzZSgpKTsK\nICAgICAgICBpZiAoIWN1ci5lcXVhbHMoc2VxKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwoKICAgICAgICBfc2VxTWFwLnJlbW92ZShzZXEuZ2V0TmFt\nZSgpLnRvVXBwZXJDYXNlKCkpOwogICAgICAgIF9zZXFzID0gbnVsbDsKICAg\nICAgICBTY2hlbWFHcm91cCBncm91cCA9IGdldFNjaGVtYUdyb3VwKCk7CiAg\nICAgICAgaWYgKGdyb3VwICE9IG51bGwpCiAgICAgICAgICAgIGdyb3VwLnJl\nbW92ZU5hbWUoc2VxLmdldE5hbWUoKSk7CiAgICAgICAgc2VxLnJlbW92ZSgp\nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICog\nSW1wb3J0IGEgc2VxdWVuY2UgZnJvbSBhbm90aGVyIHNjaGVtYS4KICAgICAq\nLwogICAgcHVibGljIFNlcXVlbmNlIGltcG9ydFNlcXVlbmNlKFNlcXVlbmNl\nIHNlcSkgewogICAgICAgIGlmIChzZXEgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIFNlcXVlbmNlIGNvcHkgPSBhZGRTZXF1\nZW5jZShzZXEuZ2V0TmFtZSgpKTsKICAgICAgICBjb3B5LnNldEluaXRpYWxW\nYWx1ZShzZXEuZ2V0SW5pdGlhbFZhbHVlKCkpOwogICAgICAgIGNvcHkuc2V0\nSW5jcmVtZW50KHNlcS5nZXRJbmNyZW1lbnQoKSk7CiAgICAgICAgY29weS5z\nZXRBbGxvY2F0ZShzZXEuZ2V0QWxsb2NhdGUoKSk7CiAgICAgICAgcmV0dXJu\nIGNvcHk7CiAgICB9CgogICAgcHVibGljIGludCBjb21wYXJlVG8oT2JqZWN0\nIG90aGVyKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBnZXROYW1lKCk7CiAg\nICAgICAgU3RyaW5nIG90aGVyTmFtZSA9ICgoU2NoZW1hKSBvdGhlcikuZ2V0\nTmFtZSgpOwogICAgICAgIGlmIChuYW1lID09IG51bGwgJiYgb3RoZXJOYW1l\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIGlmIChu\nYW1lID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIGlm\nIChvdGhlck5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIC0xOwog\nICAgICAgIHJldHVybiBuYW1lLmNvbXBhcmVUbyhvdGhlck5hbWUpOwogICAg\nfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0\ndXJuIGdldE5hbWUoKTsKICAgIH0KfQo=\n","encoding":"base64"}

