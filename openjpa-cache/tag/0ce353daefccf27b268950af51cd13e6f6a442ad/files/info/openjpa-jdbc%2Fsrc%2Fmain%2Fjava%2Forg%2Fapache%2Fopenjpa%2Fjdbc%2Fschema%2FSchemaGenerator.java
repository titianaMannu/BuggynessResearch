{"sha":"45731e335b860aee6379b8415e1f5ceb3658375f","node_id":"MDQ6QmxvYjIwNjM2NDo0NTczMWUzMzViODYwYWVlNjM3OWI4NDE1ZTFmNWNlYjM2NTgzNzVm","size":32947,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/45731e335b860aee6379b8415e1f5ceb3658375f","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0\naW9uOwppbXBvcnQgamF2YS5zcWwuRGF0YWJhc2VNZXRhRGF0YTsKaW1wb3J0\nIGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5FdmVudE9iamVj\ndDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0Owpp\nbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7Cmlt\ncG9ydCBqYXZheC5zcWwuRGF0YVNvdXJjZTsKCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKCi8qKgogKiBU\naGUgU2NoZW1hR2VuZXJhdG9yIGNyZWF0ZXMge0BsaW5rIFNjaGVtYX1zIG1h\ndGNoaW5nIHRoZSBjdXJyZW50CiAqIGRhdGFiYXNlLiBBbGwgc2NoZW1hcyBh\ncmUgYWRkZWQgdG8gdGhlIGN1cnJlbnQge0BsaW5rIFNjaGVtYUdyb3VwfS4K\nICogIE5vdGUgdGhhdCB0YWJsZXMgd2hvc2UgbmFtZSBzdGFydHMgd2l0aCAi\nT1BFTkpQQV8iIHdpbGwgYmUgbm90IGJlIGFkZGVkCiAqIHRvIHRoZSBkYXRh\nYmFzZSBzY2hlbWEuIFRoaXMgZW5hYmxlcyB0aGUgY3JlYXRpb24gb2Ygc3Bl\nY2lhbCB0YWJsZXMKICogdGhhdCB3aWxsIG5ldmVyIGJlIGRyb3BwZWQgYnkg\ndGhlIHtAbGluayBTY2hlbWFUb29sfS4KICoKICogQGF1dGhvciBBYmUgV2hp\ndGUKICovCnB1YmxpYyBjbGFzcyBTY2hlbWFHZW5lcmF0b3IgewoKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVy\nLmZvclBhY2thZ2UKICAgICAgICAoU2NoZW1hR2VuZXJhdG9yLmNsYXNzKTsK\nCiAgICBwcml2YXRlIGZpbmFsIERhdGFTb3VyY2UgX2RzOwogICAgcHJpdmF0\nZSBmaW5hbCBEQkRpY3Rpb25hcnkgX2RpY3Q7CiAgICBwcml2YXRlIGZpbmFs\nIExvZyBfbG9nOwogICAgcHJpdmF0ZSBmaW5hbCBPYmplY3RbXVtdIF9hbGxv\nd2VkOwogICAgcHJpdmF0ZSBib29sZWFuIF9pbmRleGVzID0gdHJ1ZTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfZmtzID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9v\nbGVhbiBfcGtzID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfc2VxcyA9\nIHRydWU7CiAgICBwcml2YXRlIGJvb2xlYW4gX29wZW5qcGFUYWJsZXMgPSB0\ncnVlOwogICAgcHJpdmF0ZSBTY2hlbWFHcm91cCBfZ3JvdXAgPSBudWxsOwoK\nICAgIHByaXZhdGUgTGlzdCBfbGlzdGVuZXJzID0gbnVsbDsKICAgIHByaXZh\ndGUgaW50IF9zY2hlbWFPYmplY3RzID0gMDsKCiAgICAvKioKICAgICAqIENv\nbnN0cnVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBjb25mIGNvbmZpZ3Vy\nYXRpb24gZm9yIGNvbm5lY3RpbmcgdG8gdGhlIGRhdGEgc3RvcmUKICAgICAq\nLwogICAgcHVibGljIFNjaGVtYUdlbmVyYXRvcihKREJDQ29uZmlndXJhdGlv\nbiBjb25mKSB7CiAgICAgICAgLy8gbm90ZTogd2UgY2Fubm90IGFzc2VydCBk\nZXZlbG9wZXIgY2FwYWJpbGl0aWVzIGluIHRoaXMgdG9vbCBsaWtlCiAgICAg\nICAgLy8gd2Ugbm9ybWFsbHkgZG8gYmVjYXVzZSB0aGlzIGNsYXNzIGlzIGFs\nc28gdXNlZCBhdCBydW50aW1lCgogICAgICAgIF9kcyA9IGNvbmYuZ2V0RGF0\nYVNvdXJjZTIobnVsbCk7CiAgICAgICAgX2xvZyA9IGNvbmYuZ2V0TG9nKEpE\nQkNDb25maWd1cmF0aW9uLkxPR19TQ0hFTUEpOwoKICAgICAgICAvLyBjYWNo\nZSB0aGlzIG5vdyBzbyB0aGF0IGlmIHRoZSBjb25uIHBvb2wgb25seSBoYXMg\nMSBjb25uZWN0aW9uIHdlCiAgICAgICAgLy8gZG9uJ3QgY29uZmxpY3QgbGF0\nZXIgd2l0aCB0aGUgb3BlbiBkYXRhYmFzZW1ldGFkYXRhIGNvbm5lY3Rpb24K\nICAgICAgICBfZGljdCA9IGNvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKTsKCiAgICAgICAgLy8gY3JlYXRlIGEgdGFibGUgb2YgYWxsb3dlZCBzY2hl\nbWEgYW5kIHRhYmxlcyB0byByZWZsZWN0IG9uCiAgICAgICAgX2FsbG93ZWQg\nPSBwYXJzZVNjaGVtYXNMaXN0KGNvbmYuZ2V0U2NoZW1hc0xpc3QoKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBHaXZlbiBhIGxpc3Qgb2Ygc2NoZW1hIG5h\nbWVzIGFuZCB0YWJsZSBuYW1lcyAod2hlcmUgdGFibGUgbmFtZXMKICAgICAq\nIGFyZSBhbHdheXMgb2YgdGhlIGZvcm0gc2NoZW1hLnRhYmxlLCBvciBqdXN0\nIC50YWJsZSBpZiB0aGUgc2NoZW1hIGlzCiAgICAgKiB1bmtub3duKSwgY3Jl\nYXRlcyBhIHRhYmxlIG1hcHBpbmcgc2NoZW1hIG5hbWUgdG8gdGFibGUgbGlz\ndC4gUmV0dXJucwogICAgICogbnVsbCBpZiBubyBhcmdzIGFyZSBnaXZlbi4g\nSWYgbm8gdGFibGVzIGFyZSBnaXZlbiBmb3IgYSBwYXJ0aWN1bGFyCiAgICAg\nKiBzY2hlbWEsIG1hcHMgdGhlIHNjaGVtYSBuYW1lIHRvIG51bGwuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdFtdW10gcGFyc2VTY2hlbWFz\nTGlzdChTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgaWYgKGFyZ3MgPT0gbnVs\nbCB8fCBhcmdzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKCiAgICAgICAgTWFwIHNjaGVtYXMgPSBuZXcgSGFzaE1hcCgpOwogICAg\nICAgIFN0cmluZyBzY2hlbWEsIHRhYmxlOwogICAgICAgIGludCBkb3RJZHg7\nCiAgICAgICAgQ29sbGVjdGlvbiB0YWJsZXM7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGRv\ndElkeCA9IGFyZ3NbaV0uaW5kZXhPZignLicpOwogICAgICAgICAgICBpZiAo\nZG90SWR4ID09IC0xKSB7CiAgICAgICAgICAgICAgICBzY2hlbWEgPSBhcmdz\nW2ldOwogICAgICAgICAgICAgICAgdGFibGUgPSBudWxsOwogICAgICAgICAg\nICB9IGVsc2UgaWYgKGRvdElkeCA9PSAwKSB7CiAgICAgICAgICAgICAgICBz\nY2hlbWEgPSBudWxsOwogICAgICAgICAgICAgICAgdGFibGUgPSBhcmdzW2ld\nLnN1YnN0cmluZygxKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgIHNjaGVtYSA9IGFyZ3NbaV0uc3Vic3RyaW5nKDAsIGRvdElkeCk7\nCiAgICAgICAgICAgICAgICB0YWJsZSA9IGFyZ3NbaV0uc3Vic3RyaW5nKGRv\ndElkeCArIDEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBpZiBq\ndXN0IGEgc2NoZW1hIG5hbWUsIG1hcCBzY2hlbWEgdG8gbnVsbAogICAgICAg\nICAgICBpZiAodGFibGUgPT0gbnVsbCAmJiAhc2NoZW1hcy5jb250YWluc0tl\neShzY2hlbWEpKQogICAgICAgICAgICAgICAgc2NoZW1hcy5wdXQoc2NoZW1h\nLCBudWxsKTsKICAgICAgICAgICAgZWxzZSBpZiAodGFibGUgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgdGFibGVzID0gKENvbGxlY3Rpb24pIHNjaGVt\nYXMuZ2V0KHNjaGVtYSk7CiAgICAgICAgICAgICAgICBpZiAodGFibGVzID09\nIG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB0YWJsZXMgPSBuZXcgTGlu\na2VkTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHNjaGVtYXMucHV0KHNj\naGVtYSwgdGFibGVzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIHRhYmxlcy5hZGQodGFibGUpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBPYmplY3RbXVtdIHBhcnNlZCA9IG5ldyBPYmplY3Rbc2No\nZW1hcy5zaXplKCldWzJdOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAg\nICAgICBpbnQgaWR4ID0gMDsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9\nIHNjaGVtYXMuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIHRhYmxlcyA9IChDb2xsZWN0aW9uKSBlbnRyeS5n\nZXRWYWx1ZSgpOwoKICAgICAgICAgICAgcGFyc2VkW2lkeF1bMF0gPSBlbnRy\neS5nZXRLZXkoKTsKICAgICAgICAgICAgaWYgKHRhYmxlcyAhPSBudWxsKQog\nICAgICAgICAgICAgICAgcGFyc2VkW2lkeF1bMV0gPSB0YWJsZXMudG9BcnJh\neShuZXcgU3RyaW5nW3RhYmxlcy5zaXplKCldKTsKICAgICAgICAgICAgaWR4\nKys7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYXJzZWQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciBpbmRleGVzIHNob3VsZCBi\nZSBnZW5lcmF0ZWQuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGdldEluZGV4ZXMoKSB7CiAgICAgICAgcmV0dXJuIF9p\nbmRleGVzOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHdoZXRoZXIgaW5k\nZXhlcyBzaG91bGQgYmUgZ2VuZXJhdGVkLiBEZWZhdWx0cyB0byB0cnVlLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbmRleGVzKGJvb2xlYW4gaW5k\nZXhlcykgewogICAgICAgIF9pbmRleGVzID0gaW5kZXhlczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIGZvcmVpZ24ga2V5cyBzaG91\nbGQgYmUgZ2VuZXJhdGVkLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiBnZXRGb3JlaWduS2V5cygpIHsKICAgICAgICBy\nZXR1cm4gX2ZrczsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB3aGV0aGVy\nIGZvcmVpZ24ga2V5cyBzaG91bGQgYmUgZ2VuZXJhdGVkLiBEZWZhdWx0cyB0\nbyB0cnVlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRGb3JlaWduS2V5\ncyhib29sZWFuIGZrcykgewogICAgICAgIF9ma3MgPSBma3M7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciBwcmltYXJ5IGtleXMgc2hv\ndWxkIGJlIGdlbmVyYXRlZC4gRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gZ2V0UHJpbWFyeUtleXMoKSB7CiAgICAgICAg\ncmV0dXJuIF9wa3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hldGhl\nciBwcmltYXJ5IGtleXMgc2hvdWxkIGJlIGdlbmVyYXRlZC4gRGVmYXVsdHMg\ndG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJpbWFyeUtl\neXMoYm9vbGVhbiBwa3MpIHsKICAgICAgICBfcGtzID0gcGtzOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgc2VxdWVuY2VzIHNob3Vs\nZCBiZSBnZW5lcmF0ZWQuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAg\nIHB1YmxpYyBib29sZWFuIGdldFNlcXVlbmNlcygpIHsKICAgICAgICByZXR1\ncm4gX3NlcXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hldGhlciBz\nZXF1ZW5jZXMgc2hvdWxkIGJlIGdlbmVyYXRlZC4gRGVmYXVsdHMgdG8gdHJ1\nZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U2VxdWVuY2VzKGJvb2xl\nYW4gc2VxcykgewogICAgICAgIF9zZXFzID0gc2VxczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgdG8gZ2VuZXJhdGUgaW5mbyBvbiBzcGVjaWFs\nIHRhYmxlcyB1c2VkIGJ5IE9wZW5KUEEgY29tcG9uZW50cwogICAgICogZm9y\nIGJvb2trZWVwaW5nLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRPcGVuSlBBVGFibGVzKCkgewogICAgICAgIHJl\ndHVybiBfb3BlbmpwYVRhYmxlczsKICAgIH0KCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgdG8gZ2VuZXJhdGUgaW5mbyBvbiBzcGVjaWFsIHRhYmxlcyB1c2Vk\nIGJ5IE9wZW5KUEEgY29tcG9uZW50cwogICAgICogZm9yIGJvb2trZWVwaW5n\nLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRPcGVuSlBBVGFibGVzKGJvb2xlYW4gb3BlbmpwYVRhYmxlcykgewogICAg\nICAgIF9vcGVuanBhVGFibGVzID0gb3BlbmpwYVRhYmxlczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCBzY2hlbWEgZ3JvdXAu\nCiAgICAgKi8KICAgIHB1YmxpYyBTY2hlbWFHcm91cCBnZXRTY2hlbWFHcm91\ncCgpIHsKICAgICAgICBpZiAoX2dyb3VwID09IG51bGwpCiAgICAgICAgICAg\nIF9ncm91cCA9IG5ldyBTY2hlbWFHcm91cCgpOwogICAgICAgIHJldHVybiBf\nZ3JvdXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIHNjaGVtYSBn\ncm91cCB0byBhZGQgZ2VuZXJhdGVkIHNjaGVtYXMgdG8uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIGdyb3Vw\nKSB7CiAgICAgICAgX2dyb3VwID0gZ3JvdXA7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBHZW5lcmF0ZSBhbGwgc2NoZW1hcyBzZXQgaW4gdGhlIGNvbmZpZ3Vy\nYXRpb24uIFRoaXMgbWV0aG9kIGFsc28KICAgICAqIGNhbGxzIHtAbGluayAj\nZ2VuZXJhdGVJbmRleGVzfSwge0BsaW5rICNnZW5lcmF0ZVByaW1hcnlLZXlz\nfSwgYW5kCiAgICAgKiB7QGxpbmsgI2dlbmVyYXRlRm9yZWlnbktleXN9IGF1\ndG9tYXRpY2FsbHkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGdlbmVyYXRl\nU2NoZW1hcygpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgZmlyZUdlbmVyYXRpb25FdmVudChfbG9jLmdldCgiZ2VuZXJhdGluZy1z\nY2hlbWFzIikpOwogICAgICAgIGdlbmVyYXRlU2NoZW1hcyhudWxsKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEdlbmVyYXRlIHRoZSBzY2hlbWFzIGFuZC9v\nciB0YWJsZXMgbmFtZWQgaW4gdGhlIGdpdmVuIHN0cmluZ3MuCiAgICAgKiBU\naGlzIG1ldGhvZCBjYWxscyB7QGxpbmsgI2dlbmVyYXRlSW5kZXhlc30sCiAg\nICAgKiB7QGxpbmsgI2dlbmVyYXRlUHJpbWFyeUtleXN9LCBhbmQge0BsaW5r\nICNnZW5lcmF0ZUZvcmVpZ25LZXlzfQogICAgICogYXV0b21hdGljYWxseS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgZ2VuZXJhdGVTY2hlbWFzKFN0cmlu\nZ1tdIHNjaGVtYXNBbmRUYWJsZXMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgZmlyZUdlbmVyYXRpb25FdmVudChfbG9jLmdldCgi\nZ2VuZXJhdGluZy1zY2hlbWFzIikpOwoKICAgICAgICBPYmplY3RbXVtdIHNj\naGVtYU1hcDsKICAgICAgICBpZiAoc2NoZW1hc0FuZFRhYmxlcyA9PSBudWxs\nIHx8IHNjaGVtYXNBbmRUYWJsZXMubGVuZ3RoID09IDApCiAgICAgICAgICAg\nIHNjaGVtYU1hcCA9IF9hbGxvd2VkOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgc2NoZW1hTWFwID0gcGFyc2VTY2hlbWFzTGlzdChzY2hlbWFzQW5kVGFi\nbGVzKTsKCiAgICAgICAgaWYgKHNjaGVtYU1hcCA9PSBudWxsKSB7CiAgICAg\nICAgICAgIGdlbmVyYXRlU2NoZW1hKG51bGwsIG51bGwpOwoKICAgICAgICAg\nICAgLy8gZXN0aW1hdGUgdGhlIG51bWJlciBvZiBzY2hlbWEgb2JqZWN0cyB3\nZSB3aWxsIG5lZWQgdG8gdmlzaXQKICAgICAgICAgICAgLy8gaW4gb3JkZXIg\ndG8gZXN0aW1hdGUgcHJvZ3Jlc3NzIHRvdGFsIGZvciBhbnkgbGlzdGVuZXJz\nCiAgICAgICAgICAgIGludCBudW1UYWJsZXMgPSBnZXRUYWJsZXMobnVsbCku\nc2l6ZSgpOwogICAgICAgICAgICBfc2NoZW1hT2JqZWN0cyArPSBudW1UYWJs\nZXMKICAgICAgICAgICAgICAgICsgKF9wa3MgPyBudW1UYWJsZXMgOiAwKQog\nICAgICAgICAgICAgICAgKyAoX2luZGV4ZXMgPyBudW1UYWJsZXMgOiAwKQog\nICAgICAgICAgICAgICAgKyAoX2ZrcyA/IG51bVRhYmxlcyA6IDApOwoKICAg\nICAgICAgICAgaWYgKF9wa3MpCiAgICAgICAgICAgICAgICBnZW5lcmF0ZVBy\naW1hcnlLZXlzKG51bGwsIG51bGwpOwogICAgICAgICAgICBpZiAoX2luZGV4\nZXMpCiAgICAgICAgICAgICAgICBnZW5lcmF0ZUluZGV4ZXMobnVsbCwgbnVs\nbCk7CiAgICAgICAgICAgIGlmIChfZmtzKQogICAgICAgICAgICAgICAgZ2Vu\nZXJhdGVGb3JlaWduS2V5cyhudWxsLCBudWxsKTsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gZ2VuZXJhdGUgYWxsIHNjaGVt\nYXMgYW5kIHRhYmxlcwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2No\nZW1hTWFwLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBnZW5lcmF0ZVNjaGVt\nYSgoU3RyaW5nKSBzY2hlbWFNYXBbaV1bMF0sCiAgICAgICAgICAgICAgICAo\nU3RyaW5nW10pIHNjaGVtYU1hcFtpXVsxXSk7CgogICAgICAgIC8vIGdlbmVy\nYXRlIHBrcywgaW5kZXhlcywgZmtzCiAgICAgICAgU3RyaW5nIHNjaGVtYU5h\nbWU7CiAgICAgICAgU3RyaW5nW10gdGFibGVOYW1lczsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYU1hcC5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICBzY2hlbWFOYW1lID0gKFN0cmluZykgc2NoZW1hTWFwW2ldWzBd\nOwogICAgICAgICAgICB0YWJsZU5hbWVzID0gKFN0cmluZ1tdKSBzY2hlbWFN\nYXBbaV1bMV07CgogICAgICAgICAgICAvLyBlc3RpbWF0ZSB0aGUgbnVtYmVy\nIG9mIHNjaGVtYSBvYmplY3RzIHdlIHdpbGwgbmVlZCB0byB2aXNpdAogICAg\nICAgICAgICAvLyBpbiBvcmRlciB0byBlc3RpbWF0ZSBwcm9ncmVzc3MgdG90\nYWwgZm9yIGFueSBsaXN0ZW5lcnMKICAgICAgICAgICAgaW50IG51bVRhYmxl\ncyA9ICh0YWJsZU5hbWVzICE9IG51bGwpID8gdGFibGVOYW1lcy5sZW5ndGgK\nICAgICAgICAgICAgICAgIDogZ2V0VGFibGVzKHNjaGVtYU5hbWUpLnNpemUo\nKTsKICAgICAgICAgICAgX3NjaGVtYU9iamVjdHMgKz0gbnVtVGFibGVzCiAg\nICAgICAgICAgICAgICArIChfcGtzID8gbnVtVGFibGVzIDogMCkKICAgICAg\nICAgICAgICAgICsgKF9pbmRleGVzID8gbnVtVGFibGVzIDogMCkKICAgICAg\nICAgICAgICAgICsgKF9ma3MgPyBudW1UYWJsZXMgOiAwKTsKCiAgICAgICAg\nICAgIGlmIChfcGtzKQogICAgICAgICAgICAgICAgZ2VuZXJhdGVQcmltYXJ5\nS2V5cyhzY2hlbWFOYW1lLCB0YWJsZU5hbWVzKTsKICAgICAgICAgICAgaWYg\nKF9pbmRleGVzKQogICAgICAgICAgICAgICAgZ2VuZXJhdGVJbmRleGVzKHNj\naGVtYU5hbWUsIHRhYmxlTmFtZXMpOwogICAgICAgICAgICBpZiAoX2ZrcykK\nICAgICAgICAgICAgICAgIGdlbmVyYXRlRm9yZWlnbktleXMoc2NoZW1hTmFt\nZSwgdGFibGVOYW1lcyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQWRkIGEgZnVsbHktY29uc3RydWN0ZWQge0BsaW5rIFNjaGVtYX0gbWF0\nY2hpbmcgdGhlIGdpdmVuIGRhdGFiYXNlCiAgICAgKiBzY2hlbWEgdG8gdGhl\nIGN1cnJlbnQgZ3JvdXAuIE5vIGZvcmVpZ24ga2V5cyBhcmUgZ2VuZXJhdGVk\nIGJlY2F1c2UKICAgICAqIHNvbWUga2V5cyBtaWdodCBzcGFuIHNjaGVtYXMu\nIFlvdSBtdXN0IGNhbGwKICAgICAqIHtAbGluayAjZ2VuZXJhdGVQcmltYXJ5\nS2V5c30sIHtAbGluayAjZ2VuZXJhdGVJbmRleGVzfSwgYW5kCiAgICAgKiB7\nQGxpbmsgI2dlbmVyYXRlRm9yZWlnbktleXN9IHNlcGFyYXRlbHkuCiAgICAg\nKgogICAgICogQHBhcmFtIG5hbWUgdGhlIGRhdGFiYXNlIG5hbWUgb2YgdGhl\nIHNjaGVtYSwgb3IgbnVsbCBmb3IgYWxsIHNjaGVtYXMKICAgICAqIEBwYXJh\nbSB0YWJsZU5hbWVzIGEgbGlzdCBvZiB0YWJsZXMgdG8gZ2VuZXJhdGUgaW4g\ndGhlIHNjaGVtYSwgb3IgbnVsbAogICAgICogdG8gZ2VuZXJhdGUgYWxsIHRh\nYmxlcwogICAgICovCiAgICBwdWJsaWMgdm9pZCBnZW5lcmF0ZVNjaGVtYShT\ndHJpbmcgbmFtZSwgU3RyaW5nW10gdGFibGVOYW1lcykKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBmaXJlR2VuZXJhdGlvbkV2ZW50\nKF9sb2MuZ2V0KCJnZW5lcmF0aW5nLXNjaGVtYSIsIG5hbWUpKTsKCiAgICAg\nICAgLy8gZ2VuZXJhdGUgdGFibGVzLCBpbmNsdWRpbmcgY29sdW1ucyBhbmQg\ncHJpbWFyeSBrZXlzCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gX2RzLmdl\ndENvbm5lY3Rpb24oKTsKICAgICAgICBEYXRhYmFzZU1ldGFEYXRhIG1ldGEg\nPSBjb25uLmdldE1ldGFEYXRhKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgaWYgKHRhYmxlTmFtZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGdl\nbmVyYXRlVGFibGVzKG5hbWUsIG51bGwsIGNvbm4sIG1ldGEpOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHRhYmxlTmFtZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAg\nZ2VuZXJhdGVUYWJsZXMobmFtZSwgdGFibGVOYW1lc1tpXSwgY29ubiwgbWV0\nYSk7CgogICAgICAgICAgICBpZiAoX3NlcXMpCiAgICAgICAgICAgICAgICBn\nZW5lcmF0ZVNlcXVlbmNlcyhuYW1lLCBudWxsLCBjb25uLCBtZXRhKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAvLyBzb21lIGRhdGFiYXNl\ncyByZXF1aXJlIGEgY29tbWl0IGFmdGVyIG1ldGFkYXRhIHRvIHJlbGVhc2Ug\nbG9ja3MKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4u\nY29tbWl0KCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBjb25uLmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogR2VuZXJhdGUgcHJpbWFyeSBrZXkgaW5mb3Jt\nYXRpb24gZm9yIHRoZSBnaXZlbiBzY2hlbWEuIFRoaXMgbWV0aG9kCiAgICAg\nKiBtdXN0IGJlIGNhbGxlZCBpbiBhZGRpdGlvbiB0byB7QGxpbmsgI2dlbmVy\nYXRlU2NoZW1hfS4gSXQgc2hvdWxkCiAgICAgKiBvbmx5IGJlIGNhbGxlZCBh\nZnRlciBhbGwgc2NoZW1hcyBhcmUgZ2VuZXJhdGVkLiBUaGUgc2NoZW1hIG5h\nbWUgYW5kCiAgICAgKiB0YWJsZXMgYXJyYXkgY2FuIGJlIG51bGwgdG8gaW5k\naWNhdGUgdGhhdCBpbmRleGVzIHNob3VsZCBiZSBnZW5lcmF0ZWQKICAgICAq\nIGZvciBhbGwgc2NoZW1hcyBhbmQvb3IgdGFibGVzLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBnZW5lcmF0ZVByaW1hcnlLZXlzKFN0cmluZyBzY2hlbWFO\nYW1lLCBTdHJpbmdbXSB0YWJsZU5hbWVzKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGZpcmVHZW5lcmF0aW9uRXZlbnQoX2xvYy5n\nZXQoImdlbmVyYXRpbmctYWxsLXByaW1hcmllcyIsIHNjaGVtYU5hbWUpKTsK\nCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gX2RzLmdldENvbm5lY3Rpb24o\nKTsKICAgICAgICBEYXRhYmFzZU1ldGFEYXRhIG1ldGEgPSBjb25uLmdldE1l\ndGFEYXRhKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHRhYmxl\nTmFtZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGdlbmVyYXRlUHJpbWFy\neUtleXMoc2NoZW1hTmFtZSwgbnVsbCwgY29ubiwgbWV0YSk7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\ndGFibGVOYW1lcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBn\nZW5lcmF0ZVByaW1hcnlLZXlzKHNjaGVtYU5hbWUsIHRhYmxlTmFtZXNbaV0s\nIGNvbm4sIG1ldGEpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIC8vIHNvbWUgZGF0YWJhc2VzIHJlcXVpcmUgYSBjb21taXQgYWZ0ZXIgbWV0\nYWRhdGEgdG8gcmVsZWFzZSBsb2NrcwogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgY29ubi5jb21taXQoKTsKICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAg\nICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBp\nbmRleCBpbmZvcm1hdGlvbiBmb3IgdGhlIGdpdmVuIHNjaGVtYS4gVGhpcyBt\nZXRob2QKICAgICAqIG11c3QgYmUgY2FsbGVkIGluIGFkZGl0aW9uIHRvIHtA\nbGluayAjZ2VuZXJhdGVTY2hlbWF9LiBJdCBzaG91bGQKICAgICAqIG9ubHkg\nYmUgY2FsbGVkIGFmdGVyIGFsbCBzY2hlbWFzIGFyZSBnZW5lcmF0ZWQuIFRo\nZSBzY2hlbWEgbmFtZSBhbmQKICAgICAqIHRhYmxlcyBhcnJheSBjYW4gYmUg\nbnVsbCB0byBpbmRpY2F0ZSB0aGF0IGluZGV4ZXMgc2hvdWxkIGJlIGdlbmVy\nYXRlZAogICAgICogZm9yIGFsbCBzY2hlbWFzIGFuZC9vciB0YWJsZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGdlbmVyYXRlSW5kZXhlcyhTdHJpbmcg\nc2NoZW1hTmFtZSwgU3RyaW5nW10gdGFibGVOYW1lcykKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBmaXJlR2VuZXJhdGlvbkV2ZW50\nKF9sb2MuZ2V0KCJnZW5lcmF0aW5nLWFsbC1pbmRleGVzIiwgc2NoZW1hTmFt\nZSkpOwoKICAgICAgICBDb25uZWN0aW9uIGNvbm4gPSBfZHMuZ2V0Q29ubmVj\ndGlvbigpOwogICAgICAgIERhdGFiYXNlTWV0YURhdGEgbWV0YSA9IGNvbm4u\nZ2V0TWV0YURhdGEoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAo\ndGFibGVOYW1lcyA9PSBudWxsKQogICAgICAgICAgICAgICAgZ2VuZXJhdGVJ\nbmRleGVzKHNjaGVtYU5hbWUsIG51bGwsIGNvbm4sIG1ldGEpOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHRhYmxlTmFtZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAg\nZ2VuZXJhdGVJbmRleGVzKHNjaGVtYU5hbWUsIHRhYmxlTmFtZXNbaV0sIGNv\nbm4sIG1ldGEpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIC8v\nIHNvbWUgZGF0YWJhc2VzIHJlcXVpcmUgYSBjb21taXQgYWZ0ZXIgbWV0YWRh\ndGEgdG8gcmVsZWFzZSBsb2NrcwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgY29ubi5jb21taXQoKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBmb3Jl\naWduIGtleSBpbmZvcm1hdGlvbiBmb3IgdGhlIGdpdmVuIHNjaGVtYS4gVGhp\ncyBtZXRob2QKICAgICAqIG11c3QgYmUgY2FsbGVkIGluIGFkZGl0aW9uIHRv\nIHtAbGluayAjZ2VuZXJhdGVTY2hlbWF9LiBJdCBzaG91bGQKICAgICAqIG9u\nbHkgYmUgY2FsbGVkIGFmdGVyIGFsbCBzY2hlbWFzIGFyZSBnZW5lcmF0ZWQu\nIFRoZSBzY2hlbWEgbmFtZSBhbmQKICAgICAqIHRhYmxlcyBhcnJheSBjYW4g\nYmUgbnVsbCB0byBpbmRpY2F0ZSB0aGF0IGluZGV4ZXMgc2hvdWxkIGJlIGdl\nbmVyYXRlZAogICAgICogZm9yIGFsbCBzY2hlbWFzIGFuZC9vciB0YWJsZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGdlbmVyYXRlRm9yZWlnbktleXMo\nU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZ1tdIHRhYmxlTmFtZXMpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgZmlyZUdlbmVyYXRp\nb25FdmVudChfbG9jLmdldCgiZ2VuZXJhdGluZy1hbGwtZm9yZWlnbnMiLCBz\nY2hlbWFOYW1lKSk7CgogICAgICAgIENvbm5lY3Rpb24gY29ubiA9IF9kcy5n\nZXRDb25uZWN0aW9uKCk7CiAgICAgICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRh\nID0gY29ubi5nZXRNZXRhRGF0YSgpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGlmICh0YWJsZU5hbWVzID09IG51bGwpCiAgICAgICAgICAgICAgICBn\nZW5lcmF0ZUZvcmVpZ25LZXlzKHNjaGVtYU5hbWUsIG51bGwsIGNvbm4sIG1l\ndGEpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHRhYmxlTmFtZXMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgICAgICAgICAgZ2VuZXJhdGVGb3JlaWduS2V5cyhzY2hlbWFOYW1lLCB0\nYWJsZU5hbWVzW2ldLCBjb25uLCBtZXRhKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAvLyBzb21lIGRhdGFiYXNlcyByZXF1aXJlIGEgY29t\nbWl0IGFmdGVyIG1ldGFkYXRhIHRvIHJlbGVhc2UgbG9ja3MKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4uY29tbWl0KCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25uLmNs\nb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\newogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQWRkcyBhbGwgdGFibGVzIG1hdGNoaW5nIHRoZSBnaXZlbiBuYW1lIHBh\ndHRlcm4gdG8gdGhlIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nZ2VuZXJhdGVUYWJsZXMoU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0YWJs\nZU5hbWUsCiAgICAgICAgQ29ubmVjdGlvbiBjb25uLCBEYXRhYmFzZU1ldGFE\nYXRhIG1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgZmlyZUdlbmVyYXRpb25FdmVudChfbG9jLmdldCgiZ2VuZXJhdGluZy1j\nb2x1bW5zIiwgc2NoZW1hTmFtZSwKICAgICAgICAgICAgdGFibGVOYW1lKSk7\nCiAgICAgICAgaWYgKF9sb2cuaXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAg\nICBfbG9nLmluZm8oX2xvYy5nZXQoImdlbi10YWJsZXMiLCBzY2hlbWFOYW1l\nLCB0YWJsZU5hbWUpKTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9IF9kaWN0\nLmdldENvbHVtbnMobWV0YSwgY29ubi5nZXRDYXRhbG9nKCksIHNjaGVtYU5h\nbWUsCiAgICAgICAgICAgIHRhYmxlTmFtZSwgbnVsbCwgY29ubik7CgogICAg\nICAgIC8vIHdoZW4gd2Ugd2FudCB0byBnZXQgYWxsIHRoZSBjb2x1bW5zIGZv\nciBhbGwgdGFibGVzLCB3ZSBuZWVkIHRvIGJ1aWxkCiAgICAgICAgLy8gYSBs\naXN0IG9mIHRhYmxlcyB0byB2ZXJpZnkgYmVjYXVzZSBzb21lIGRhdGFiYXNl\ncyAoZS5nLiwgUG9zdGdyZXMpCiAgICAgICAgLy8gd2lsbCBpbmNsdWRlIGlu\nZGV4ZXMgaW4gdGhlIGxpc3Qgb2YgY29sdW1ucywgYW5kIHRoZXJlIGlzIG5v\nIHdheSB0bwogICAgICAgIC8vIGRpc3Rpbmd1aXNoIHRoZSBpbmRleGVzIGZy\nb20gcHJvcGVyIGNvbHVtbnMKICAgICAgICBTZXQgdGFibGVOYW1lcyA9IG51\nbGw7CiAgICAgICAgaWYgKHRhYmxlTmFtZSA9PSBudWxsIHx8ICIlIi5lcXVh\nbHModGFibGVOYW1lKSkgewogICAgICAgICAgICBUYWJsZVtdIHRhYmxlcyA9\nIF9kaWN0LmdldFRhYmxlcyhtZXRhLCBjb25uLmdldENhdGFsb2coKSwKICAg\nICAgICAgICAgICAgIHNjaGVtYU5hbWUsIHRhYmxlTmFtZSwgY29ubik7CiAg\nICAgICAgICAgIHRhYmxlTmFtZXMgPSBuZXcgSGFzaFNldCgpOwogICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgdGFibGVzICE9IG51bGwgJiYgaSA8IHRh\nYmxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGNvbHMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0YWJsZU5hbWVzLmFkZCh0\nYWJsZXNbaV0uZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgICAgICB0YWJsZU5hbWVzLmFkZCh0YWJsZXNbaV0uZ2V0\nTmFtZSgpLnRvVXBwZXJDYXNlKCkpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICAvLyBpZiBkYXRhYmFzZSBjYW4ndCBoYW5kbGUgbnVsbCB0\nYWJsZSBuYW1lLCByZWN1cnNlIG9uIGVhY2gga25vd24gbmFtZQogICAgICAg\nIGlmIChjb2xzID09IG51bGwgJiYgdGFibGVOYW1lID09IG51bGwpIHsKICAg\nICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSB0YWJsZU5hbWVzLml0ZXJh\ndG9yKCk7IGl0ci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgZ2VuZXJh\ndGVUYWJsZXMoc2NoZW1hTmFtZSwgKFN0cmluZykgaXRyLm5leHQoKSwgY29u\nbiwgbWV0YSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAg\nICAgIFNjaGVtYUdyb3VwIGdyb3VwID0gZ2V0U2NoZW1hR3JvdXAoKTsKICAg\nICAgICBTY2hlbWEgc2NoZW1hOwogICAgICAgIFRhYmxlIHRhYmxlOwogICAg\nICAgIFN0cmluZyB0YWJsZVNjaGVtYTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgY29scyAhPSBudWxsICYmIGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIHRhYmxlTmFtZSA9IGNvbHNbaV0uZ2V0VGFibGVOYW1lKCk7\nCiAgICAgICAgICAgIHRhYmxlU2NoZW1hID0gU3RyaW5nVXRpbHMudHJpbVRv\nTnVsbChjb2xzW2ldLmdldFNjaGVtYU5hbWUoKSk7CgogICAgICAgICAgICAv\nLyBpZ25vcmUgc3BlY2lhbCB0YWJsZXMKICAgICAgICAgICAgaWYgKCFfb3Bl\nbmpwYVRhYmxlcyAmJgogICAgICAgICAgICAgICAgKHRhYmxlTmFtZS50b1Vw\ncGVyQ2FzZSgpLnN0YXJ0c1dpdGgoIk9QRU5KUEFfIikKICAgICAgICAgICAg\nICAgICAgICB8fCB0YWJsZU5hbWUudG9VcHBlckNhc2UoKS5zdGFydHNXaXRo\nKCJKRE9fIikpKSAvLyBsZWdhY3kKICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICBpZiAoX2RpY3QuaXNTeXN0ZW1UYWJsZSh0YWJsZU5h\nbWUsIHRhYmxlU2NoZW1hLCBzY2hlbWFOYW1lICE9IG51bGwpKQogICAgICAg\nICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAvLyBpZ25vcmUgdGFi\nbGVzIG5vdCBpbiBsaXN0LCBvciBub3QgYWxsb3dlZCBieSBzY2hlbWFzIHBy\nb3BlcnR5CiAgICAgICAgICAgIGlmICh0YWJsZU5hbWVzICE9IG51bGwKICAg\nICAgICAgICAgICAgICYmICF0YWJsZU5hbWVzLmNvbnRhaW5zKHRhYmxlTmFt\nZS50b1VwcGVyQ2FzZSgpKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwog\nICAgICAgICAgICBpZiAoIWlzQWxsb3dlZFRhYmxlKHRhYmxlU2NoZW1hLCB0\nYWJsZU5hbWUpKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAg\nICAgICBzY2hlbWEgPSBncm91cC5nZXRTY2hlbWEodGFibGVTY2hlbWEpOwog\nICAgICAgICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAgICAg\nICBzY2hlbWEgPSBncm91cC5hZGRTY2hlbWEodGFibGVTY2hlbWEpOwoKICAg\nICAgICAgICAgdGFibGUgPSBzY2hlbWEuZ2V0VGFibGUodGFibGVOYW1lKTsK\nICAgICAgICAgICAgaWYgKHRhYmxlID09IG51bGwpIHsKICAgICAgICAgICAg\nICAgIHRhYmxlID0gc2NoZW1hLmFkZFRhYmxlKHRhYmxlTmFtZSk7CiAgICAg\nICAgICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgIF9sb2cudHJhY2UoX2xvYy5nZXQoImNvbC10YWJsZSIs\nIHRhYmxlKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChfbG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBfbG9nLnRyYWNl\nKF9sb2MuZ2V0KCJnZW4tY29sdW1uIiwgY29sc1tpXS5nZXROYW1lKCksIHRh\nYmxlKSk7CgogICAgICAgICAgICBpZiAodGFibGUuZ2V0Q29sdW1uKGNvbHNb\naV0uZ2V0TmFtZSgpKSA9PSBudWxsKQogICAgICAgICAgICAgICAgdGFibGUu\naW1wb3J0Q29sdW1uKGNvbHNbaV0pOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiB0YWJsZSBpcyBh\nbGxvd2VkIGJ5IHRoZSB1c2VyJ3Mgc2NoZW1hIGxpc3QuCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBpc0FsbG93ZWRUYWJsZShTdHJpbmcgc2NoZW1h\nLCBTdHJpbmcgdGFibGUpIHsKICAgICAgICBpZiAoX2FsbG93ZWQgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIC8vIGRvIGNh\nc2UtaW5zZW5zaXRpdmUgY29tcGFyaXNvbiBvbiBhbGxvd2VkIHRhYmxlIGFu\nZCBzY2hlbWEgbmFtZXMKICAgICAgICBTdHJpbmdbXSB0YWJsZXM7CiAgICAg\nICAgU3RyaW5nW10gYW55U2NoZW1hVGFibGVzID0gbnVsbDsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IF9hbGxvd2VkLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIGlmIChfYWxsb3dlZFtpXVswXSA9PSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBhbnlTY2hlbWFUYWJsZXMgPSAoU3RyaW5nW10pIF9hbGxv\nd2VkW2ldWzFdOwogICAgICAgICAgICAgICAgaWYgKHNjaGVtYSA9PSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFTdHJp\nbmdVdGlscy5lcXVhbHNJZ25vcmVDYXNlKHNjaGVtYSwgKFN0cmluZykgX2Fs\nbG93ZWRbaV1bMF0pKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAg\nICAgICAgICBpZiAodGFibGUgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgICAgICB0YWJsZXMgPSAoU3RyaW5nW10pIF9h\nbGxvd2VkW2ldWzFdOwogICAgICAgICAgICBpZiAodGFibGVzID09IG51bGwp\nCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgZm9y\nIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKyspCiAgICAgICAg\nICAgICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxzSWdub3JlQ2FzZSh0YWJs\nZSwgdGFibGVzW2pdKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICB9CgogICAgICAgIGlmIChhbnlTY2hlbWFUYWJsZXMgIT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAodGFibGUgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGFueVNjaGVtYVRhYmxlcy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgICAgIGlmIChTdHJpbmdVdGlscy5lcXVhbHNJZ25vcmVDYXNlKHRh\nYmxlLCBhbnlTY2hlbWFUYWJsZXNbaV0pKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBHZW5lcmF0ZXMgdGFibGUgcHJpbWFy\neSBrZXlzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBnZW5lcmF0ZVByaW1h\ncnlLZXlzKFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVOYW1lLAog\nICAgICAgIENvbm5lY3Rpb24gY29ubiwgRGF0YWJhc2VNZXRhRGF0YSBtZXRh\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGZpcmVH\nZW5lcmF0aW9uRXZlbnQoX2xvYy5nZXQoImdlbmVyYXRpbmctcHJpbWFyeSIs\nCiAgICAgICAgICAgIHNjaGVtYU5hbWUsIHRhYmxlTmFtZSkpOwogICAgICAg\nIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cu\ndHJhY2UoX2xvYy5nZXQoImdlbi1wa3MiLCBzY2hlbWFOYW1lLCB0YWJsZU5h\nbWUpKTsKCiAgICAgICAgLy8gaWYgbG9va2luZyBmb3IgYSBub24tZXhpc3Rh\nbnQgdGFibGUsIGp1c3QgcmV0dXJuCiAgICAgICAgU2NoZW1hR3JvdXAgZ3Jv\ndXAgPSBnZXRTY2hlbWFHcm91cCgpOwogICAgICAgIGlmICh0YWJsZU5hbWUg\nIT0gbnVsbCAmJiBncm91cC5maW5kVGFibGUodGFibGVOYW1lKSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIGlmIHRoZSBkYXRh\nYmFzZSBjYW4ndCB1c2UgYSB0YWJsZSBuYW1lIHdpbGRjYXJkLCByZWN1cnNl\nIG9uIGVhY2gKICAgICAgICAvLyBjb25jcmV0ZSB0YWJsZSBpbiB0aGUgcmVx\ndWVzdGVkIHNjaGVtYShzKQogICAgICAgIFByaW1hcnlLZXlbXSBwa3MgPSBf\nZGljdC5nZXRQcmltYXJ5S2V5cyhtZXRhLCBjb25uLmdldENhdGFsb2coKSwK\nICAgICAgICAgICAgc2NoZW1hTmFtZSwgdGFibGVOYW1lLCBjb25uKTsKICAg\nICAgICBUYWJsZSB0YWJsZTsKICAgICAgICBpZiAocGtzID09IG51bGwgJiYg\ndGFibGVOYW1lID09IG51bGwpIHsKICAgICAgICAgICAgQ29sbGVjdGlvbiB0\nYWJsZXMgPSBnZXRUYWJsZXMoc2NoZW1hTmFtZSk7CiAgICAgICAgICAgIGZv\nciAoSXRlcmF0b3IgaXRyID0gdGFibGVzLml0ZXJhdG9yKCk7IGl0ci5oYXNO\nZXh0KCk7KSB7CiAgICAgICAgICAgICAgICB0YWJsZSA9IChUYWJsZSkgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgIGdlbmVyYXRlUHJpbWFyeUtleXMo\ndGFibGUuZ2V0U2NoZW1hTmFtZSgpLAogICAgICAgICAgICAgICAgICAgIHRh\nYmxlLmdldE5hbWUoKSwgY29ubiwgbWV0YSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgU2NoZW1hIHNj\naGVtYTsKICAgICAgICBQcmltYXJ5S2V5IHBrOwogICAgICAgIFN0cmluZyBu\nYW1lOwogICAgICAgIFN0cmluZyBjb2xOYW1lOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBwa3MgIT0gbnVsbCAmJiBpIDwgcGtzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBTdHJpbmdVdGlscy50cmltVG9O\ndWxsKHBrc1tpXS5nZXRTY2hlbWFOYW1lKCkpOwogICAgICAgICAgICBzY2hl\nbWEgPSBncm91cC5nZXRTY2hlbWEoc2NoZW1hTmFtZSk7CiAgICAgICAgICAg\nIGlmIChzY2hlbWEgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICB0YWJsZSA9IHNjaGVtYS5nZXRUYWJsZShwa3NbaV0u\nZ2V0VGFibGVOYW1lKCkpOwogICAgICAgICAgICBpZiAodGFibGUgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgY29s\nTmFtZSA9IHBrc1tpXS5nZXRDb2x1bW5OYW1lKCk7CiAgICAgICAgICAgIG5h\nbWUgPSBwa3NbaV0uZ2V0TmFtZSgpOwogICAgICAgICAgICBpZiAoX2xvZy5p\nc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xvZy50cmFjZShf\nbG9jLmdldCgiZ2VuLXBrIiwgbmFtZSwgdGFibGUsIGNvbE5hbWUpKTsKCiAg\nICAgICAgICAgIHBrID0gdGFibGUuZ2V0UHJpbWFyeUtleSgpOwogICAgICAg\nICAgICBpZiAocGsgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHBrID0gdGFi\nbGUuYWRkUHJpbWFyeUtleShuYW1lKTsKICAgICAgICAgICAgcGsuYWRkQ29s\ndW1uKHRhYmxlLmdldENvbHVtbihjb2xOYW1lKSk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogR2VuZXJhdGVzIHRhYmxlIGluZGV4ZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGdlbmVyYXRlSW5kZXhlcyhTdHJpbmcg\nc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwKICAgICAgICBDb25uZWN0\naW9uIGNvbm4sIERhdGFiYXNlTWV0YURhdGEgbWV0YSkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBmaXJlR2VuZXJhdGlvbkV2ZW50\nKF9sb2MuZ2V0KCJnZW5lcmF0aW5nLWluZGV4ZXMiLAogICAgICAgICAgICBz\nY2hlbWFOYW1lLCB0YWJsZU5hbWUpKTsKICAgICAgICBpZiAoX2xvZy5pc1Ry\nYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9nLnRyYWNlKF9sb2MuZ2V0\nKCJnZW4taW5kZXhlcyIsIHNjaGVtYU5hbWUsIHRhYmxlTmFtZSkpOwoKICAg\nICAgICAvLyBpZiBsb29raW5nIGZvciBhIG5vbi1leGlzdGFudCB0YWJsZSwg\nanVzdCByZXR1cm4KICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9IGdldFNj\naGVtYUdyb3VwKCk7CiAgICAgICAgaWYgKHRhYmxlTmFtZSAhPSBudWxsICYm\nIGdyb3VwLmZpbmRUYWJsZSh0YWJsZU5hbWUpID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgLy8gaWYgdGhlIGRhdGFiYXNlIGNhbid0\nIHVzZSBhIHRhYmxlIG5hbWUgd2lsZGNhcmQsIHJlY3Vyc2Ugb24gZWFjaAog\nICAgICAgIC8vIGNvbmNyZXRlIHRhYmxlIGluIHRoZSByZXF1ZXN0ZWQgc2No\nZW1hKHMpCiAgICAgICAgSW5kZXhbXSBpZHhzID0gX2RpY3QuZ2V0SW5kZXhJ\nbmZvKG1ldGEsIGNvbm4uZ2V0Q2F0YWxvZygpLAogICAgICAgICAgICBzY2hl\nbWFOYW1lLCB0YWJsZU5hbWUsIGZhbHNlLCB0cnVlLCBjb25uKTsKICAgICAg\nICBUYWJsZSB0YWJsZTsKICAgICAgICBpZiAoaWR4cyA9PSBudWxsICYmIHRh\nYmxlTmFtZSA9PSBudWxsKSB7CiAgICAgICAgICAgIENvbGxlY3Rpb24gdGFi\nbGVzID0gZ2V0VGFibGVzKHNjaGVtYU5hbWUpOwogICAgICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ciA9IHRhYmxlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAgICAgdGFibGUgPSAoVGFibGUpIGl0ci5u\nZXh0KCk7CiAgICAgICAgICAgICAgICBnZW5lcmF0ZUluZGV4ZXModGFibGUu\nZ2V0U2NoZW1hTmFtZSgpLAogICAgICAgICAgICAgICAgICAgIHRhYmxlLmdl\ndE5hbWUoKSwgY29ubiwgbWV0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgU2NoZW1hIHNjaGVtYTsK\nICAgICAgICBJbmRleCBpZHg7CiAgICAgICAgU3RyaW5nIG5hbWU7CiAgICAg\nICAgU3RyaW5nIGNvbE5hbWU7CiAgICAgICAgU3RyaW5nIHBrTmFtZTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaWR4cyAhPSBudWxsICYmIGkgPCBpZHhz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBTdHJp\nbmdVdGlscy50cmltVG9OdWxsKGlkeHNbaV0uZ2V0U2NoZW1hTmFtZSgpKTsK\nICAgICAgICAgICAgc2NoZW1hID0gZ3JvdXAuZ2V0U2NoZW1hKHNjaGVtYU5h\nbWUpOwogICAgICAgICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAg\nICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgdGFibGUgPSBzY2hlbWEu\nZ2V0VGFibGUoaWR4c1tpXS5nZXRUYWJsZU5hbWUoKSk7CiAgICAgICAgICAg\nIGlmICh0YWJsZSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29udGludWU7\nCgogICAgICAgICAgICBpZiAodGFibGUuZ2V0UHJpbWFyeUtleSgpICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBwa05hbWUgPSB0YWJsZS5nZXRQcmltYXJ5\nS2V5KCkuZ2V0TmFtZSgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAg\nICAgICBwa05hbWUgPSBudWxsOwoKICAgICAgICAgICAgLy8gc3RhdGlzdGlj\ncyBkb24ndCBoYXZlIG5hbWVzOyBza2lwIHRoZW0KICAgICAgICAgICAgbmFt\nZSA9IGlkeHNbaV0uZ2V0TmFtZSgpOwogICAgICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eShuYW1lKQogICAgICAgICAgICAgICAgfHwgKHBrTmFt\nZSAhPSBudWxsICYmIG5hbWUuZXF1YWxzSWdub3JlQ2FzZShwa05hbWUpKQog\nICAgICAgICAgICAgICAgfHwgX2RpY3QuaXNTeXN0ZW1JbmRleChuYW1lLCB0\nYWJsZSkpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nIGNvbE5hbWUgPSBpZHhzW2ldLmdldENvbHVtbk5hbWUoKTsKICAgICAgICAg\nICAgaWYgKHRhYmxlLmdldENvbHVtbihjb2xOYW1lKSA9PSBudWxsKQogICAg\nICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBpZiAoX2xvZy5p\nc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xvZy50cmFjZShf\nbG9jLmdldCgiZ2VuLWluZGV4IiwgbmFtZSwgdGFibGUsIGNvbE5hbWUpKTsK\nCiAgICAgICAgICAgIC8vIHNhbWUgaW5kZXggbWF5IGhhdmUgbXVsdGlwbGUg\ncm93cyBmb3IgbXVsdGlwbGUgY29scwogICAgICAgICAgICBpZHggPSB0YWJs\nZS5nZXRJbmRleChuYW1lKTsKICAgICAgICAgICAgaWYgKGlkeCA9PSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBpZHggPSB0YWJsZS5hZGRJbmRleChuYW1l\nKTsKICAgICAgICAgICAgICAgIGlkeC5zZXRVbmlxdWUoaWR4c1tpXS5pc1Vu\naXF1ZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZHguYWRkQ29s\ndW1uKHRhYmxlLmdldENvbHVtbihjb2xOYW1lKSk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogR2VuZXJhdGVzIHRhYmxlIGZvcmVpZ24ga2V5\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgZ2VuZXJhdGVGb3JlaWduS2V5\ncyhTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwKICAgICAg\nICBDb25uZWN0aW9uIGNvbm4sIERhdGFiYXNlTWV0YURhdGEgbWV0YSkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBmaXJlR2VuZXJh\ndGlvbkV2ZW50KF9sb2MuZ2V0KCJnZW5lcmF0aW5nLWZvcmVpZ24iLAogICAg\nICAgICAgICBzY2hlbWFOYW1lLCB0YWJsZU5hbWUpKTsKICAgICAgICBpZiAo\nX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9nLnRyYWNl\nKF9sb2MuZ2V0KCJnZW4tZmtzIiwgc2NoZW1hTmFtZSwgdGFibGVOYW1lKSk7\nCgogICAgICAgIC8vIGlmIGxvb2tpbmcgZm9yIGEgbm9uLWV4aXN0YW50IHRh\nYmxlLCBqdXN0IHJldHVybgogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0g\nZ2V0U2NoZW1hR3JvdXAoKTsKICAgICAgICBpZiAodGFibGVOYW1lICE9IG51\nbGwgJiYgZ3JvdXAuZmluZFRhYmxlKHRhYmxlTmFtZSkgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBpZiB0aGUgZGF0YWJhc2Ug\nY2FuJ3QgdXNlIGEgdGFibGUgbmFtZSB3aWxkY2FyZCwgcmVjdXJzZSBvbiBl\nYWNoCiAgICAgICAgLy8gY29uY3JldGUgdGFibGUgaW4gdGhlIHJlcXVlc3Rl\nZCBzY2hlbWEocykKICAgICAgICBGb3JlaWduS2V5W10gZmtzID0gX2RpY3Qu\nZ2V0SW1wb3J0ZWRLZXlzKG1ldGEsIGNvbm4uZ2V0Q2F0YWxvZygpLAogICAg\nICAgICAgICBzY2hlbWFOYW1lLCB0YWJsZU5hbWUsIGNvbm4pOwogICAgICAg\nIFRhYmxlIHRhYmxlOwogICAgICAgIGlmIChma3MgPT0gbnVsbCAmJiB0YWJs\nZU5hbWUgPT0gbnVsbCkgewogICAgICAgICAgICBDb2xsZWN0aW9uIHRhYmxl\ncyA9IGdldFRhYmxlcyhzY2hlbWFOYW1lKTsKICAgICAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSB0YWJsZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgICAgIHRhYmxlID0gKFRhYmxlKSBpdHIubmV4\ndCgpOwogICAgICAgICAgICAgICAgZ2VuZXJhdGVGb3JlaWduS2V5cyh0YWJs\nZS5nZXRTY2hlbWFOYW1lKCksCiAgICAgICAgICAgICAgICAgICAgdGFibGUu\nZ2V0TmFtZSgpLCBjb25uLCBtZXRhKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBTY2hlbWEgc2NoZW1h\nOwogICAgICAgIFRhYmxlIHBrVGFibGU7CiAgICAgICAgRm9yZWlnbktleSBm\nazsKICAgICAgICBTdHJpbmcgbmFtZTsKICAgICAgICBTdHJpbmcgcGtTY2hl\nbWFOYW1lOwogICAgICAgIFN0cmluZyBwa1RhYmxlTmFtZTsKICAgICAgICBT\ndHJpbmcgcGtDb2xOYW1lOwogICAgICAgIFN0cmluZyBma0NvbE5hbWU7CiAg\nICAgICAgaW50IHNlcTsKICAgICAgICBib29sZWFuIHNlcVdhczAgPSBmYWxz\nZTsgLy8gc29tZSBkcml2ZXJzIGluY29ycmVjdGx5IHN0YXJ0IGF0IDAKICAg\nICAgICBDb2xsZWN0aW9uIGludmFsaWRzID0gbnVsbDsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgZmtzICE9IG51bGwgJiYgaSA8IGZrcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBzY2hlbWFOYW1lID0gU3RyaW5nVXRpbHMudHJp\nbVRvTnVsbChma3NbaV0uZ2V0U2NoZW1hTmFtZSgpKTsKICAgICAgICAgICAg\nc2NoZW1hID0gZ3JvdXAuZ2V0U2NoZW1hKHNjaGVtYU5hbWUpOwogICAgICAg\nICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAgICAgICBjb250\naW51ZTsKICAgICAgICAgICAgdGFibGUgPSBzY2hlbWEuZ2V0VGFibGUoZmtz\nW2ldLmdldFRhYmxlTmFtZSgpKTsKICAgICAgICAgICAgaWYgKHRhYmxlID09\nIG51bGwpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nIG5hbWUgPSBma3NbaV0uZ2V0TmFtZSgpOwogICAgICAgICAgICBma0NvbE5h\nbWUgPSBma3NbaV0uZ2V0Q29sdW1uTmFtZSgpOwogICAgICAgICAgICBwa0Nv\nbE5hbWUgPSBma3NbaV0uZ2V0UHJpbWFyeUtleUNvbHVtbk5hbWUoKTsKICAg\nICAgICAgICAgc2VxID0gZmtzW2ldLmdldEtleVNlcXVlbmNlKCk7CiAgICAg\nICAgICAgIGlmIChzZXEgPT0gMCkKICAgICAgICAgICAgICAgIHNlcVdhczAg\nPSB0cnVlOwogICAgICAgICAgICBpZiAoc2VxV2FzMCkKICAgICAgICAgICAg\nICAgIHNlcSsrOwoKICAgICAgICAgICAgLy8gZmluZCBwayB0YWJsZQogICAg\nICAgICAgICBwa1NjaGVtYU5hbWUgPSBma3NbaV0uZ2V0UHJpbWFyeUtleVNj\naGVtYU5hbWUoKTsKICAgICAgICAgICAgcGtUYWJsZU5hbWUgPSBma3NbaV0u\nZ2V0UHJpbWFyeUtleVRhYmxlTmFtZSgpOwogICAgICAgICAgICBpZiAoX2xv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xvZy50cmFj\nZShfbG9jLmdldCgiZ2VuLWZrIiwgbmV3IE9iamVjdFtdeyBuYW1lLCB0YWJs\nZSwKICAgICAgICAgICAgICAgICAgICBma0NvbE5hbWUsIHBrVGFibGVOYW1l\nLCBwa0NvbE5hbWUsIHNlcSArICIiIH0pKTsKCiAgICAgICAgICAgIGlmICgh\nU3RyaW5nVXRpbHMuaXNFbXB0eShwa1NjaGVtYU5hbWUpKQogICAgICAgICAg\nICAgICAgcGtUYWJsZU5hbWUgPSBwa1NjaGVtYU5hbWUgKyAiLiIgKyBwa1Rh\nYmxlTmFtZTsKICAgICAgICAgICAgcGtUYWJsZSA9IGdyb3VwLmZpbmRUYWJs\nZShwa1RhYmxlTmFtZSk7CiAgICAgICAgICAgIGlmIChwa1RhYmxlID09IG51\nbGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU1FMRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJnZW4tbm9ma3RhYmxlIiwKICAgICAgICAgICAgICAgICAgICB0\nYWJsZSwgcGtUYWJsZU5hbWUpLmdldE1lc3NhZ2UoKSk7CgogICAgICAgICAg\nICAvLyB0aGlzIHN1Y2tzLCBiZWNhdXNlIGl0IGlzICpub3QqIGd1YXJhbnRl\nZWQgdG8gd29yazsKICAgICAgICAgICAgLy8gdGhlIGZrIHJlc3VsdHNldCBp\ncyBvcmRlcmVkIGJ5IHByaW1hcnkga2V5IHRhYmxlLCB0aGVuCiAgICAgICAg\nICAgIC8vIHNlcXVlbmNlIG51bWJlciB3aXRoaW4gdGhlIGZvcmVpZ24ga2V5\nIChzb21lIGRyaXZlcnMgZG9uJ3QKICAgICAgICAgICAgLy8gdXNlIHNlcXVl\nbmNlIG51bWJlcnMgY29ycmVjdGx5IGVpdGhlcik7IHNpbmNlIGZrIG5hbWVz\nCiAgICAgICAgICAgIC8vIGFyZSBhbGxvd2VkIHRvIGJlIG51bGwsIGFsbCB0\naGlzIGFkZHMgdXAgdG8gdGhlIGZhY3QKICAgICAgICAgICAgLy8gdGhhdCB0\naGVyZSBpcyBhYnNvbHV0ZWx5IG5vIHdheSB0byBkaXN0aW5ndWlzaCBiZXR3\nZWVuCiAgICAgICAgICAgIC8vIG11bHRpcGxlIG11bHRpLWNvbHVtbiBma3Mg\ndG8gdGhlIHNhbWUgdGFibGU7IHdlJ3JlIGdvaW5nCiAgICAgICAgICAgIC8v\nIHRvIHJlbHkgb24gZmsgbmFtZSBoZXJlIGFuZCBob3BlIGl0IHdvcmtzCiAg\nICAgICAgICAgIGZrID0gdGFibGUuZ2V0Rm9yZWlnbktleShuYW1lKTsKCiAg\nICAgICAgICAgIC8vIHN0YXJ0IGEgbmV3IGZrPwogICAgICAgICAgICBpZiAo\nc2VxID09IDEgfHwgZmsgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgZmsg\nPSB0YWJsZS5hZGRGb3JlaWduS2V5KG5hbWUpOwogICAgICAgICAgICAgICAg\nZmsuc2V0RGVmZXJyZWQoZmtzW2ldLmlzRGVmZXJyZWQoKSk7CiAgICAgICAg\nICAgICAgICBmay5zZXREZWxldGVBY3Rpb24oZmtzW2ldLmdldERlbGV0ZUFj\ndGlvbigpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGludmFs\naWRzID09IG51bGwgfHwgIWludmFsaWRzLmNvbnRhaW5zKGZrKSkgewogICAg\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBmay5qb2lu\nKHRhYmxlLmdldENvbHVtbihma0NvbE5hbWUpLAogICAgICAgICAgICAgICAg\nICAgICAgICBwa1RhYmxlLmdldENvbHVtbihwa0NvbE5hbWUpKTsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBp\nYWUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9j\nLmdldCgiYmFkLWpvaW4iLCBpYWUudG9TdHJpbmcoKSkpOwogICAgICAgICAg\nICAgICAgICAgIGlmIChpbnZhbGlkcyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgICAgICBpbnZhbGlkcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAg\nICAgICAgICAgICAgaW52YWxpZHMuYWRkKGZrKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gcmVtb3Zl\nIGludmFsaWQgZmtzCiAgICAgICAgaWYgKGludmFsaWRzICE9IG51bGwpIHsK\nICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBpbnZhbGlkcy5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgZmsg\nPSAoRm9yZWlnbktleSkgaXRyLm5leHQoKTsKICAgICAgICAgICAgICAgIGZr\nLmdldFRhYmxlKCkucmVtb3ZlRm9yZWlnbktleShmayk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGRzIGFsbCBz\nZXF1ZW5jZXMgbWF0Y2hpbmcgdGhlIGdpdmVuIG5hbWUgcGF0dGVybiB0byB0\naGUgc2NoZW1hLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBnZW5lcmF0ZVNl\ncXVlbmNlcyhTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHNlcXVlbmNlTmFt\nZSwKICAgICAgICBDb25uZWN0aW9uIGNvbm4sIERhdGFiYXNlTWV0YURhdGEg\nbWV0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBm\naXJlR2VuZXJhdGlvbkV2ZW50KF9sb2MuZ2V0KCJnZW5lcmF0aW5nLXNlcXVl\nbmNlcyIsIHNjaGVtYU5hbWUpKTsKICAgICAgICBpZiAoX2xvZy5pc0luZm9F\nbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9jLmdldCgiZ2Vu\nLXNlcXMiLCBzY2hlbWFOYW1lLCBzZXF1ZW5jZU5hbWUpKTsKCiAgICAgICAg\nU2VxdWVuY2VbXSBzZXFzID0gX2RpY3QuZ2V0U2VxdWVuY2VzKG1ldGEsIGNv\nbm4uZ2V0Q2F0YWxvZygpLAogICAgICAgICAgICBzY2hlbWFOYW1lLCBzZXF1\nZW5jZU5hbWUsIGNvbm4pOwoKICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9\nIGdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgU2NoZW1hIHNjaGVtYTsKICAg\nICAgICBTdHJpbmcgc2VxdWVuY2VTY2hlbWE7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IHNlcXMgIT0gbnVsbCAmJiBpIDwgc2Vxcy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBzZXF1ZW5jZU5hbWUgPSBzZXFzW2ldLmdldE5hbWUo\nKTsKICAgICAgICAgICAgc2VxdWVuY2VTY2hlbWEgPSBTdHJpbmdVdGlscy50\ncmltVG9OdWxsKHNlcXNbaV0uZ2V0U2NoZW1hTmFtZSgpKTsKCiAgICAgICAg\nICAgIC8vIGlnbm9yZSBzcGVjaWFsIHRhYmxlcwogICAgICAgICAgICBpZiAo\nIV9vcGVuanBhVGFibGVzICYmCiAgICAgICAgICAgICAgICAoc2VxdWVuY2VO\nYW1lLnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgiT1BFTkpQQV8iKQogICAg\nICAgICAgICAgICAgICAgIHx8IHNlcXVlbmNlTmFtZS50b1VwcGVyQ2FzZSgp\nLnN0YXJ0c1dpdGgoIkpET18iKSkpIC8vIGxlZ2FjeQogICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgIGlmIChfZGljdC5pc1N5c3RlbVNl\ncXVlbmNlKHNlcXVlbmNlTmFtZSwgc2VxdWVuY2VTY2hlbWEsCiAgICAgICAg\nICAgICAgICBzY2hlbWFOYW1lICE9IG51bGwpKQogICAgICAgICAgICAgICAg\nY29udGludWU7CiAgICAgICAgICAgIGlmICghaXNBbGxvd2VkVGFibGUoc2Vx\ndWVuY2VTY2hlbWEsIG51bGwpKQogICAgICAgICAgICAgICAgY29udGludWU7\nCgogICAgICAgICAgICBzY2hlbWEgPSBncm91cC5nZXRTY2hlbWEoc2VxdWVu\nY2VTY2hlbWEpOwogICAgICAgICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAg\nICAgICAgICAgICAgICBzY2hlbWEgPSBncm91cC5hZGRTY2hlbWEoc2VxdWVu\nY2VTY2hlbWEpOwogICAgICAgICAgICBpZiAoc2NoZW1hLmdldFNlcXVlbmNl\nKHNlcXVlbmNlTmFtZSkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHNjaGVt\nYS5hZGRTZXF1ZW5jZShzZXF1ZW5jZU5hbWUpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIE5vdGlmeSBhbnkgbGlzdGVuZXJzIHRoYXQgYSBz\nY2hlbWEgb2JqZWN0IHdhcyBnZW5lcmF0ZWQuIFJldHVybnMKICAgICAqIHRy\ndWUgaWYgZ2VuZXJhdGlvbiBzaG91bGQgY29udGludWUuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBmaXJlR2VuZXJhdGlvbkV2ZW50KE9iamVjdCBzY2hl\nbWFPYmplY3QpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKHNjaGVtYU9iamVjdCA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgaWYgKF9saXN0ZW5lcnMgPT0gbnVsbCB8fCBfbGlzdGVu\nZXJzLnNpemUoKSA9PSAwKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIEV2ZW50IGUgPSBuZXcgRXZlbnQoc2NoZW1hT2JqZWN0LCBfc2NoZW1hT2Jq\nZWN0cyk7CiAgICAgICAgZm9yIChJdGVyYXRvciBpID0gX2xpc3RlbmVycy5p\ndGVyYXRvcigpOyBpLmhhc05leHQoKTspIHsKICAgICAgICAgICAgTGlzdGVu\nZXIgbCA9IChMaXN0ZW5lcikgaS5uZXh0KCk7CiAgICAgICAgICAgIGlmICgh\nbC5zY2hlbWFPYmplY3RHZW5lcmF0ZWQoZSkpCiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgU1FMRXhjZXB0aW9uKF9sb2MuZ2V0KCJyZWZyZXNoLWNhbmNl\nbGxlZCIpCiAgICAgICAgICAgICAgICAgICAgLmdldE1lc3NhZ2UoKSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkcyBhIGxpc3RlbmVy\nIGZvciBzY2hlbWEgZ2VuZXJhdGlvbiBldmVudHMuCiAgICAgKgogICAgICog\nQHBhcmFtIGwgdGhlIGxpc3RlbmVyIHRvIGFkZAogICAgICovCiAgICBwdWJs\naWMgdm9pZCBhZGRMaXN0ZW5lcihMaXN0ZW5lciBsKSB7CiAgICAgICAgaWYg\nKF9saXN0ZW5lcnMgPT0gbnVsbCkKICAgICAgICAgICAgX2xpc3RlbmVycyA9\nIG5ldyBMaW5rZWRMaXN0KCk7CiAgICAgICAgX2xpc3RlbmVycy5hZGQobCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmVzIGEgc2NoZW1hIGdlbmVy\nYXRpb24gbGlzdGVuZXIgZm9yIHNjaGVtYSBldmVudHMuCiAgICAgKgogICAg\nICogQHBhcmFtIGwgdGhlIGxpc3RlbmVyIHRvIHJlbW92ZQogICAgICogQHJl\ndHVybiB0cnVlIGlmIGl0IHdhcyBzdWNjZXNzZnVsbHkgcmVtb3ZlZAogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVMaXN0ZW5lcihMaXN0ZW5l\nciBsKSB7CiAgICAgICAgcmV0dXJuIF9saXN0ZW5lcnMgIT0gbnVsbCAmJiBf\nbGlzdGVuZXJzLnJlbW92ZShsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhbGwgdGFibGVzIGZvciB0aGUgZ2l2ZW4gc2NoZW1hIG5hbWUsIG9y\nIGFsbCB0YWJsZXMgaW4KICAgICAqIHRoZSBzY2hlbWEgZ3JvdXAgaWYgbnVs\nbCBpcyBnaXZlbi4KICAgICAqLwogICAgcHJpdmF0ZSBDb2xsZWN0aW9uIGdl\ndFRhYmxlcyhTdHJpbmcgc2NoZW1hTmFtZSkgewogICAgICAgIFNjaGVtYUdy\nb3VwIGdyb3VwID0gZ2V0U2NoZW1hR3JvdXAoKTsKICAgICAgICBpZiAoc2No\nZW1hTmFtZSAhPSBudWxsKSB7CiAgICAgICAgICAgIFNjaGVtYSBzY2hlbWEg\nPSBncm91cC5nZXRTY2hlbWEoc2NoZW1hTmFtZSk7CiAgICAgICAgICAgIGlm\nIChzY2hlbWEgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBDb2xs\nZWN0aW9ucy5FTVBUWV9MSVNUOwogICAgICAgICAgICByZXR1cm4gQXJyYXlz\nLmFzTGlzdChzY2hlbWEuZ2V0VGFibGVzKCkpOwogICAgICAgIH0KCiAgICAg\nICAgU2NoZW1hW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVtYXMoKTsKICAg\nICAgICBDb2xsZWN0aW9uIHRhYmxlcyA9IG5ldyBMaW5rZWRMaXN0KCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICB0YWJsZXMuYWRkQWxsKEFycmF5cy5hc0xpc3Qoc2No\nZW1hc1tpXS5nZXRUYWJsZXMoKSkpOwogICAgICAgIHJldHVybiB0YWJsZXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBIGxpc3RlbmVyIGZvciBhIHBvdGVu\ndGlhbGx5IGxlbmd0aHkgc2NoZW1hIGdlbmVyYXRpb24gcHJvY2Vzcy4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgTGlzdGVuZXIgewoK\nICAgICAgICBib29sZWFuIHNjaGVtYU9iamVjdEdlbmVyYXRlZChFdmVudCBl\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFuIGV2ZW50IGNvcnJlc3BvbmRp\nbmcgdG8gdGhlIGdlbmVyYXRpb24gb2YgYSBzY2hlbWEgb2JqZWN0LgogICAg\nICovCiAgICBwdWJsaWMgY2xhc3MgRXZlbnQKICAgICAgICBleHRlbmRzIEV2\nZW50T2JqZWN0IHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBpbnQgX3RvdGFs\nOwoKICAgICAgICBwdWJsaWMgRXZlbnQoT2JqZWN0IG9iLCBpbnQgdG90YWwp\nIHsKICAgICAgICAgICAgc3VwZXIob2IpOwogICAgICAgICAgICBfdG90YWwg\nPSB0b3RhbDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgZ2V0VG90\nYWwoKSB7CiAgICAgICAgICAgIHJldHVybiBfdG90YWw7CiAgICAgICAgfQog\nICAgfQp9Cg==\n","encoding":"base64"}

