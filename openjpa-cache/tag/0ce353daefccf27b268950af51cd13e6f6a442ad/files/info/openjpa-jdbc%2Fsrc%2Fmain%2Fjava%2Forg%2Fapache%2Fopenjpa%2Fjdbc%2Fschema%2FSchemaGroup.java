{"sha":"ea4949bab336e95d711d3abfab74c78f792dba9a","node_id":"MDQ6QmxvYjIwNjM2NDplYTQ5NDliYWIzMzZlOTVkNzExZDNhYmZhYjc0Yzc4Zjc5MmRiYTlh","size":12433,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ea4949bab336e95d711d3abfab74c78f792dba9a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVj\ndGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51\ndGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKLyoqCiAq\nIFJlcHJlc2VudHMgYSBncm91cGluZyBvZiBzY2hlbWFzIHVzZWQgaW4gYSBk\nYXRhYmFzZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBj\nbGFzcyBTY2hlbWFHcm91cAogICAgZXh0ZW5kcyBOYW1lU2V0CiAgICBpbXBs\nZW1lbnRzIENsb25lYWJsZSB7CgogICAgcHJpdmF0ZSBNYXAgX3NjaGVtYU1h\ncCA9IG51bGw7CgogICAgLy8gY2FjaGUKICAgIHByaXZhdGUgU2NoZW1hW10g\nX3NjaGVtYXMgPSBudWxsOwoKICAgIC8qKgogICAgICogUmV0dXJuIGFsbCBz\nY2hlbWFzLgogICAgICovCiAgICBwdWJsaWMgU2NoZW1hW10gZ2V0U2NoZW1h\ncygpIHsKICAgICAgICBpZiAoX3NjaGVtYXMgPT0gbnVsbCkKICAgICAgICAg\nICAgX3NjaGVtYXMgPSAoX3NjaGVtYU1hcCA9PSBudWxsKSA/IG5ldyBTY2hl\nbWFbMF0gOiAoU2NoZW1hW10pCiAgICAgICAgICAgICAgICBfc2NoZW1hTWFw\nLnZhbHVlcygpLnRvQXJyYXkobmV3IFNjaGVtYVtfc2NoZW1hTWFwLnNpemUo\nKV0pOwogICAgICAgIHJldHVybiBfc2NoZW1hczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgc2NoZW1hIHdpdGggdGhlIGdpdmVuIG5hbWUs\nIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIFNjaGVtYSBn\nZXRTY2hlbWEoU3RyaW5nIG5hbWUpIHsKICAgICAgICBpZiAoX3NjaGVtYU1h\ncCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBp\nZiAobmFtZSAhPSBudWxsKQogICAgICAgICAgICBuYW1lID0gbmFtZS50b1Vw\ncGVyQ2FzZSgpOwogICAgICAgIHJldHVybiAoU2NoZW1hKSBfc2NoZW1hTWFw\nLmdldChuYW1lKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBhIHNjaGVt\nYSB0byB0aGUgZ3JvdXAuCiAgICAgKi8KICAgIHB1YmxpYyBTY2hlbWEgYWRk\nU2NoZW1hKCkgewogICAgICAgIHJldHVybiBhZGRTY2hlbWEobnVsbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBzY2hlbWEgdG8gdGhlIGdyb3Vw\nLgogICAgICovCiAgICBwdWJsaWMgU2NoZW1hIGFkZFNjaGVtYShTdHJpbmcg\nbmFtZSkgewogICAgICAgIGFkZE5hbWUobmFtZSwgZmFsc2UpOwogICAgICAg\nIFNjaGVtYSBzY2hlbWEgPSBuZXdTY2hlbWEobmFtZSk7CiAgICAgICAgaWYg\nKG5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgbmFtZSA9IG5hbWUudG9VcHBl\nckNhc2UoKTsKICAgICAgICBpZiAoX3NjaGVtYU1hcCA9PSBudWxsKQogICAg\nICAgICAgICBfc2NoZW1hTWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBf\nc2NoZW1hTWFwLnB1dChuYW1lLCBzY2hlbWEpOwogICAgICAgIF9zY2hlbWFz\nID0gbnVsbDsKICAgICAgICByZXR1cm4gc2NoZW1hOwogICAgfQoKICAgIC8q\nKgogICAgICogUmVtb3ZlIHRoZSBnaXZlbiBzY2hlbWEgZnJvbSB0aGUgZ3Jv\ndXAuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBzY2hlbWEg\nd2FzIHJlbW92ZWQsIGZhbHNlIGlmIG5vdCBpbiB0aGUgZ3JvdXAKICAgICAq\nLwogICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlU2NoZW1hKFNjaGVtYSBzY2hl\nbWEpIHsKICAgICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgU3RyaW5nIG5hbWUgPSBzY2hlbWEu\nZ2V0TmFtZSgpOwogICAgICAgIGlmIChuYW1lICE9IG51bGwpCiAgICAgICAg\nICAgIG5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgU2NoZW1h\nIHJlbSA9IChTY2hlbWEpIF9zY2hlbWFNYXAuZ2V0KG5hbWUpOwogICAgICAg\nIGlmIChzY2hlbWEuZXF1YWxzKHJlbSkpIHsKICAgICAgICAgICAgX3NjaGVt\nYU1hcC5yZW1vdmUobmFtZSk7CiAgICAgICAgICAgIHJlbW92ZU5hbWUoc2No\nZW1hLmdldE5hbWUoKSk7CiAgICAgICAgICAgIF9zY2hlbWFzID0gbnVsbDsK\nICAgICAgICAgICAgc2NoZW1hLnJlbW92ZSgpOwogICAgICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIC8qKgogICAgICogSW1wb3J0IGEgc2NoZW1hIGZyb20gYW5vdGhl\nciBncm91cC4gRm9yZWlnbiBrZXlzIGFyZSBub3QgaW1wb3J0ZWQuCiAgICAg\nKi8KICAgIHB1YmxpYyBTY2hlbWEgaW1wb3J0U2NoZW1hKFNjaGVtYSBzY2hl\nbWEpIHsKICAgICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBTY2hlbWEgY29weSA9IGFkZFNjaGVt\nYShzY2hlbWEuZ2V0TmFtZSgpKTsKICAgICAgICBTZXF1ZW5jZVtdIHNlcXMg\nPSBzY2hlbWEuZ2V0U2VxdWVuY2VzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBjb3B5Lmlt\ncG9ydFNlcXVlbmNlKHNlcXNbaV0pOwoKICAgICAgICBUYWJsZVtdIHRhYmxl\ncyA9IHNjaGVtYS5nZXRUYWJsZXMoKTsKICAgICAgICBJbmRleFtdIGlkeHM7\nCiAgICAgICAgVW5pcXVlW10gdW5xczsKICAgICAgICBUYWJsZSB0YWI7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0YWJsZXMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgdGFiID0gY29weS5pbXBvcnRUYWJsZSh0YWJsZXNb\naV0pOwogICAgICAgICAgICBpZHhzID0gdGFibGVzW2ldLmdldEluZGV4ZXMo\nKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBpZHhzLmxlbmd0\naDsgaisrKQogICAgICAgICAgICAgICAgdGFiLmltcG9ydEluZGV4KGlkeHNb\nal0pOwogICAgICAgICAgICB1bnFzID0gdGFibGVzW2ldLmdldFVuaXF1ZXMo\nKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB1bnFzLmxlbmd0\naDsgaisrKQogICAgICAgICAgICAgICAgdGFiLmltcG9ydFVuaXF1ZSh1bnFz\nW2pdKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvcHk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gdGFibGUg\naXMga25vd24gdG8gZXhpc3QuIFdoaWxlCiAgICAgKiB7QGxpbmsgI2ZpbmRU\nYWJsZX0gbWF5IGV4aGliaXQgZHluYW1pYyBiZWhhdmlvciBpbiBzb21lIHNj\naGVtYSBncm91cAogICAgICogaW1wbGVtZW50YXRpb25zLCB0aGlzIG1ldGhv\nZCBvbmx5IHJldHVybnMgdHJ1ZSBpZiB0aGUgdGFibGUgaGFzIGJlZW4KICAg\nICAqIGFkZGVkIHRvIHRoaXMgZ3JvdXAgb3IgaXMga25vd24gdG8gZXhpc3Qg\naW4gdGhlIGRhdGFiYXNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc0tub3duVGFibGUoVGFibGUgdGFibGUpIHsKICAgICAgICByZXR1cm4gZmlu\nZFRhYmxlKHRhYmxlKSAhPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIHRhYmxlIGlzIGtub3duIHRvIGV4\naXN0LiBXaGlsZQogICAgICoge0BsaW5rICNmaW5kVGFibGV9IG1heSBleGhp\nYml0IGR5bmFtaWMgYmVoYXZpb3IgaW4gc29tZSBzY2hlbWEgZ3JvdXAKICAg\nICAqIGltcGxlbWVudGF0aW9ucywgdGhpcyBtZXRob2Qgb25seSByZXR1cm5z\nIHRydWUgaWYgdGhlIHRhYmxlIGhhcyBiZWVuCiAgICAgKiBhZGRlZCB0byB0\naGlzIGdyb3VwIG9yIGlzIGtub3duIHRvIGV4aXN0IGluIHRoZSBkYXRhYmFz\nZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNLbm93blRhYmxlKFN0\ncmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIGZpbmRUYWJsZShuYW1lKSAh\nPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogRmluZCB0aGUgZXF1aXZh\nbGVudCBvZiB0aGUgZ2l2ZW4gdGFibGUgaW4gdGhpcyBzY2hlbWEgZ3JvdXAu\nIFRoZQogICAgICogZ2l2ZW4gdGFibGUgdGhhdCBtYXkgaGF2ZSBjb21lIGZy\nb20gYW5vdGhlciBzY2hlbWEgZ3JvdXAuCiAgICAgKi8KICAgIHB1YmxpYyBU\nYWJsZSBmaW5kVGFibGUoVGFibGUgdGFibGUpIHsKICAgICAgICByZXR1cm4g\nZmluZFRhYmxlKHRhYmxlLmdldEZ1bGxOYW1lKCkpOwogICAgfQoKICAgIC8q\nKgogICAgICogRmluZCB0aGUgdGFibGUgd2l0aCB0aGUgZ2l2ZW4gbmFtZSBp\nbiB0aGUgZ3JvdXAsIHVzaW5nICcuJyBhcyB0aGUKICAgICAqIGNhdGFsb2cg\nc2VwYXJhdG9yLiBSZXR1cm5zIG51bGwgaWYgbm8gdGFibGUgZm91bmQuCiAg\nICAgKi8KICAgIHB1YmxpYyBUYWJsZSBmaW5kVGFibGUoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgaW50IGRvdElkeCA9IG5hbWUuaW5kZXhPZign\nLicpOwogICAgICAgIGlmIChkb3RJZHggIT0gLTEpIHsKICAgICAgICAgICAg\nU3RyaW5nIHNjaGVtYU5hbWUgPSBuYW1lLnN1YnN0cmluZygwLCBkb3RJZHgp\nOwogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoZG90SWR4ICsg\nMSk7CiAgICAgICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoc2No\nZW1hTmFtZSk7CiAgICAgICAgICAgIGlmIChzY2hlbWEgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHJldHVybiBzY2hlbWEuZ2V0VGFibGUobmFtZSk7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9\nIGdldFNjaGVtYXMoKTsKICAgICAgICAgICAgVGFibGUgdGFiOwogICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgICAgIHRhYiA9IHNjaGVtYXNbaV0uZ2V0VGFibGUo\nbmFtZSk7CiAgICAgICAgICAgICAgICBpZiAodGFiICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHRhYjsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBzZXF1ZW5jZSBpcyBrbm93\nbiB0byBleGlzdC4gV2hpbGUKICAgICAqIHtAbGluayAjZmluZFNlcXVlbmNl\nfSBtYXkgZXhoaWJpdCBkeW5hbWljIGJlaGF2aW9yIGluIHNvbWUgc2NoZW1h\nIGdyb3VwCiAgICAgKiBpbXBsZW1lbnRhdGlvbnMsIHRoaXMgbWV0aG9kIG9u\nbHkgcmV0dXJucyB0cnVlIGlmIHRoZSBzZXF1ZW5jZSBoYXMgYmVlbgogICAg\nICogYWRkZWQgdG8gdGhpcyBncm91cCBvciBpcyBrbm93biB0byBleGlzdCBp\nbiB0aGUgZGF0YWJhc2UuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlz\nS25vd25TZXF1ZW5jZShTZXF1ZW5jZSBzZXEpIHsKICAgICAgICByZXR1cm4g\nZmluZFNlcXVlbmNlKHNlcSkgIT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBzZXF1ZW5jZSBpcyBrbm93\nbiB0byBleGlzdC4gV2hpbGUKICAgICAqIHtAbGluayAjZmluZFNlcXVlbmNl\nfSBtYXkgZXhoaWJpdCBkeW5hbWljIGJlaGF2aW9yIGluIHNvbWUgc2NoZW1h\nIGdyb3VwCiAgICAgKiBpbXBsZW1lbnRhdGlvbnMsIHRoaXMgbWV0aG9kIG9u\nbHkgcmV0dXJucyB0cnVlIGlmIHRoZSBzZXF1ZW5jZSBoYXMgYmVlbgogICAg\nICogYWRkZWQgdG8gdGhpcyBncm91cCBvciBpcyBrbm93biB0byBleGlzdCBp\nbiB0aGUgZGF0YWJhc2UuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlz\nS25vd25TZXF1ZW5jZShTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiBm\naW5kU2VxdWVuY2UobmFtZSkgIT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIEZpbmQgdGhlIGVxdWl2YWxlbnQgb2YgdGhlIGdpdmVuIHNlcXVlbmNl\nIGluIHRoaXMgc2NoZW1hIGdyb3VwLiBUaGUKICAgICAqIGdpdmVuIHNlcXVl\nbmNlIHRoYXQgbWF5IGhhdmUgY29tZSBmcm9tIGFub3RoZXIgc2NoZW1hIGdy\nb3VwLgogICAgICovCiAgICBwdWJsaWMgU2VxdWVuY2UgZmluZFNlcXVlbmNl\nKFNlcXVlbmNlIHNlcSkgewogICAgICAgIHJldHVybiBmaW5kU2VxdWVuY2Uo\nc2VxLmdldEZ1bGxOYW1lKCkpOwogICAgfQoKICAgIC8qKgogICAgICogRmlu\nZCB0aGUgc2VxdWVuY2Ugd2l0aCB0aGUgZ2l2ZW4gbmFtZSBpbiB0aGUgZ3Jv\ndXAsIHVzaW5nICcuJyBhcyB0aGUKICAgICAqIGNhdGFsb2cgc2VwYXJhdG9y\nLiBSZXR1cm5zIG51bGwgaWYgbm8gc2VxdWVuY2UgZm91bmQuCiAgICAgKi8K\nICAgIHB1YmxpYyBTZXF1ZW5jZSBmaW5kU2VxdWVuY2UoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgaW50IGRvdElkeCA9IG5hbWUuaW5kZXhPZign\nLicpOwogICAgICAgIGlmIChkb3RJZHggIT0gLTEpIHsKICAgICAgICAgICAg\nU3RyaW5nIHNjaGVtYU5hbWUgPSBuYW1lLnN1YnN0cmluZygwLCBkb3RJZHgp\nOwogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoZG90SWR4ICsg\nMSk7CiAgICAgICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoc2No\nZW1hTmFtZSk7CiAgICAgICAgICAgIGlmIChzY2hlbWEgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHJldHVybiBzY2hlbWEuZ2V0U2VxdWVuY2UobmFtZSk7\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU2NoZW1hW10gc2NoZW1h\ncyA9IGdldFNjaGVtYXMoKTsKICAgICAgICAgICAgU2VxdWVuY2Ugc2VxOwog\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgIHNlcSA9IHNjaGVtYXNbaV0uZ2V0\nU2VxdWVuY2UobmFtZSk7CiAgICAgICAgICAgICAgICBpZiAoc2VxICE9IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIEZpbmQgYWxsIGZvcmVpZ24ga2V5cyBleHBvcnRlZCBi\neSBhIGdpdmVuIHByaW1hcnkga2V5IChhbGwgZm9yZWlnbgogICAgICoga2V5\ncyB0aGF0IGxpbmsgdG8gdGhlIHByaW1hcnkga2V5KS4KICAgICAqLwogICAg\ncHVibGljIEZvcmVpZ25LZXlbXSBmaW5kRXhwb3J0ZWRGb3JlaWduS2V5cyhQ\ncmltYXJ5S2V5IHBrKSB7CiAgICAgICAgaWYgKHBrID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBuZXcgRm9yZWlnbktleVswXTsKCiAgICAgICAgU2No\nZW1hW10gc2NoZW1hcyA9IGdldFNjaGVtYXMoKTsKICAgICAgICBUYWJsZVtd\nIHRhYnM7CiAgICAgICAgRm9yZWlnbktleVtdIGZrczsKICAgICAgICBDb2xs\nZWN0aW9uIGV4cG9ydHMgPSBuZXcgTGlua2VkTGlzdCgpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICB0YWJzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJzLmxlbmd0aDsgaisrKSB7\nCiAgICAgICAgICAgICAgICBma3MgPSB0YWJzW2pdLmdldEZvcmVpZ25LZXlz\nKCk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IGZrcy5s\nZW5ndGg7IGsrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChma3Nba10u\nZ2V0UHJpbWFyeUtleVRhYmxlKCkgIT0gbnVsbAogICAgICAgICAgICAgICAg\nICAgICAgICAmJiBway5lcXVhbHMoZmtzW2tdLmdldFByaW1hcnlLZXlUYWJs\nZSgpLgogICAgICAgICAgICAgICAgICAgICAgICBnZXRQcmltYXJ5S2V5KCkp\nKQogICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzLmFkZChma3Nba10p\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiAoRm9yZWlnbktleVtdKSBleHBvcnRzLnRvQXJyYXko\nbmV3IEZvcmVpZ25LZXlbZXhwb3J0cy5zaXplKCldKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJlbW92ZSB1bnJlZmVyZW5jZWQgb3IgZW10cHkgY29tcG9u\nZW50cyBmcm9tIHRoZSBzY2hlbWEuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHJlbW92ZVVudXNlZENvbXBvbmVudHMoKSB7CiAgICAgICAgU2NoZW1hW10g\nc2NoZW1hcyA9IGdldFNjaGVtYXMoKTsKICAgICAgICBUYWJsZVtdIHRhYnM7\nCiAgICAgICAgQ29sdW1uW10gY29sczsKICAgICAgICBTZXF1ZW5jZVtdIHNl\ncXM7CiAgICAgICAgUHJpbWFyeUtleSBwazsKICAgICAgICBGb3JlaWduS2V5\nW10gZmtzOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICBzZXFzID0gc2NoZW1hc1tpXS5n\nZXRTZXF1ZW5jZXMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGog\nPCBzZXFzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgaWYgKHNlcXNb\nal0uZ2V0UmVmQ291bnQoKSA9PSAwKQogICAgICAgICAgICAgICAgICAgIHNj\naGVtYXNbaV0ucmVtb3ZlU2VxdWVuY2Uoc2Vxc1tqXSk7CgogICAgICAgICAg\nICB0YWJzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaiA9IDA7IGogPCB0YWJzLmxlbmd0aDsgaisrKSB7CiAgICAg\nICAgICAgICAgICBwayA9IHRhYnNbal0uZ2V0UHJpbWFyeUtleSgpOwogICAg\nICAgICAgICAgICAgZmtzID0gdGFic1tqXS5nZXRGb3JlaWduS2V5cygpOwog\nICAgICAgICAgICAgICAgY29scyA9IHRhYnNbal0uZ2V0Q29sdW1ucygpOwoK\nICAgICAgICAgICAgICAgIGlmIChwayAhPSBudWxsICYmIHBrLmdldFJlZkNv\ndW50KCkgPT0gMCkKICAgICAgICAgICAgICAgICAgICB0YWJzW2pdLnJlbW92\nZVByaW1hcnlLZXkoKTsKCiAgICAgICAgICAgICAgICBmb3IgKGludCBrID0g\nMDsgayA8IGZrcy5sZW5ndGg7IGsrKykKICAgICAgICAgICAgICAgICAgICBp\nZiAoZmtzW2tdLmdldFJlZkNvdW50KCkgPT0gMCkKICAgICAgICAgICAgICAg\nICAgICAgICAgdGFic1tqXS5yZW1vdmVGb3JlaWduS2V5KGZrc1trXSk7Cgog\nICAgICAgICAgICAgICAgZm9yIChpbnQgayA9IDA7IGsgPCBjb2xzLmxlbmd0\naDsgaysrKQogICAgICAgICAgICAgICAgICAgIGlmIChjb2xzW2tdLmdldFJl\nZkNvdW50KCkgPT0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFic1tq\nXS5yZW1vdmVDb2x1bW4oY29sc1trXSk7CgogICAgICAgICAgICAgICAgaWYg\nKHRhYnNbal0uZ2V0Q29sdW1ucygpLmxlbmd0aCA9PSAwKQogICAgICAgICAg\nICAgICAgICAgIHNjaGVtYXNbaV0ucmVtb3ZlVGFibGUodGFic1tqXSk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzY2hlbWFzW2ldLmdldFRh\nYmxlcygpLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgcmVtb3ZlU2No\nZW1hKHNjaGVtYXNbaV0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\nT2JqZWN0IGNsb25lKCkgewogICAgICAgIFNjaGVtYUdyb3VwIGNsb25lID0g\nbmV3SW5zdGFuY2UoKTsKICAgICAgICBjbG9uZS5jb3B5KHRoaXMpOwogICAg\nICAgIHJldHVybiBjbG9uZTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0\nZSBhIG5ldyBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgU2NoZW1hR3JvdXAgbmV3SW5zdGFuY2UoKSB7CiAgICAgICAg\ncmV0dXJuIG5ldyBTY2hlbWFHcm91cCgpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29weSBjbG9uZWFibGUgc3RhdGUgZnJvbSB0aGUgZ2l2ZW4gaW5zdGFu\nY2UuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNvcHkoU2NoZW1hR3Jv\ndXAgZ3JvdXApIHsKICAgICAgICBTY2hlbWFbXSBzY2hlbWFzID0gZ3JvdXAu\nZ2V0U2NoZW1hcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2No\nZW1hcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaW1wb3J0U2NoZW1hKHNj\naGVtYXNbaV0pOwoKICAgICAgICAvLyBoYXZlIHRvIGRvIGZrcyBhZnRlciBh\nbGwgc2NoZW1hcyBhcmUgaW1wb3J0ZWQKICAgICAgICBUYWJsZVtdIHRhYnM7\nCiAgICAgICAgRm9yZWlnbktleVtdIGZrczsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\ndGFicyA9IHNjaGVtYXNbaV0uZ2V0VGFibGVzKCk7CiAgICAgICAgICAgIGZv\nciAoaW50IGogPSAwOyBqIDwgdGFicy5sZW5ndGg7IGorKykgewogICAgICAg\nICAgICAgICAgZmtzID0gdGFic1tqXS5nZXRGb3JlaWduS2V5cygpOwogICAg\nICAgICAgICAgICAgZm9yIChpbnQgayA9IDA7IGsgPCBma3MubGVuZ3RoOyBr\nKyspCiAgICAgICAgICAgICAgICAgICAgZ2V0U2NoZW1hKHNjaGVtYXNbaV0u\nZ2V0TmFtZSgpKS5nZXRUYWJsZQogICAgICAgICAgICAgICAgICAgICAgICAo\ndGFic1tqXS5nZXROYW1lKCkpLmltcG9ydEZvcmVpZ25LZXkoZmtzW2tdKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiBhIG5ldyBzY2hlbWEgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIFNjaGVtYSBuZXdTY2hlbWEoU3RyaW5nIG5h\nbWUpIHsKICAgICAgICByZXR1cm4gbmV3IFNjaGVtYShuYW1lLCB0aGlzKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIG5ldyBzZXF1ZW5jZSB3\naXRoIHRoZSBnaXZlbiBuYW1lIGFuZCBvd25lciBzY2hlbWEuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBTZXF1ZW5jZSBuZXdTZXF1ZW5jZShTdHJpbmcgbmFt\nZSwgU2NoZW1hIHNjaGVtYSkgewogICAgICAgIHJldHVybiBuZXcgU2VxdWVu\nY2UobmFtZSwgc2NoZW1hKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiBhIG5ldyB0YWJsZSB3aXRoIHRoZSBnaXZlbiBuYW1lIGFuZCBvd25lciBz\nY2hlbWEuCiAgICAgKi8KICAgIHByb3RlY3RlZCBUYWJsZSBuZXdUYWJsZShT\ndHJpbmcgbmFtZSwgU2NoZW1hIHNjaGVtYSkgewogICAgICAgIHJldHVybiBu\nZXcgVGFibGUobmFtZSwgc2NoZW1hKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiBhIG5ldyBjb2x1bW4gd2l0aCB0aGUgZ2l2ZW4gbmFtZSBhbmQg\nb3duZXIgdGFibGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBDb2x1bW4gbmV3\nQ29sdW1uKFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAgIHJl\ndHVybiBuZXcgQ29sdW1uKG5hbWUsIHRhYmxlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIG5ldyBwcmltYXJ5IGtleSB3aXRoIHRoZSBnaXZl\nbiBuYW1lIGFuZCBvd25lciB0YWJsZS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFByaW1hcnlLZXkgbmV3UHJpbWFyeUtleShTdHJpbmcgbmFtZSwgVGFibGUg\ndGFibGUpIHsKICAgICAgICByZXR1cm4gbmV3IFByaW1hcnlLZXkobmFtZSwg\ndGFibGUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbmV3IGlu\nZGV4IHdpdGggdGhlIGdpdmVuIG5hbWUgYW5kIG93bmVyIHRhYmxlLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgSW5kZXggbmV3SW5kZXgoU3RyaW5nIG5hbWUs\nIFRhYmxlIHRhYmxlKSB7CiAgICAgICAgcmV0dXJuIG5ldyBJbmRleChuYW1l\nLCB0YWJsZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBuZXcg\ndW5pcXVlIGNvbnN0cmFpbnQgd2l0aCB0aGUgZ2l2ZW4gbmFtZSBhbmQgb3du\nZXIgdGFibGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBVbmlxdWUgbmV3VW5p\ncXVlKFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAgIHJldHVy\nbiBuZXcgVW5pcXVlKG5hbWUsIHRhYmxlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBhIG5ldyBmb3JlaWduIGtleSB3aXRoIHRoZSBnaXZlbiBu\nYW1lIGFuZCBvd25lciB0YWJsZS4KICAgICAqLwogICAgcHJvdGVjdGVkIEZv\ncmVpZ25LZXkgbmV3Rm9yZWlnbktleShTdHJpbmcgbmFtZSwgVGFibGUgdGFi\nbGUpIHsKICAgICAgICByZXR1cm4gbmV3IEZvcmVpZ25LZXkobmFtZSwgdGFi\nbGUpOwogICAgfQp9Cg==\n","encoding":"base64"}

