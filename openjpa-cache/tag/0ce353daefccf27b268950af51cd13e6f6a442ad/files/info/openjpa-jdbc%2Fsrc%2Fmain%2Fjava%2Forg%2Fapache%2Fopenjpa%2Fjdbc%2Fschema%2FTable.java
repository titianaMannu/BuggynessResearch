{"sha":"fe1ba285209354cb71cfdbe78afa0b48251d8d72","node_id":"MDQ6QmxvYjIwNjM2NDpmZTFiYTI4NTIwOTM1NGNiNzFjZmRiZTc4YWZhMGI0ODI1MWQ4ZDcy","size":19929,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fe1ba285209354cb71cfdbe78afa0b48251d8d72","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLmlvLkZpbGU7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNv\nbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlRyZWVNYXA7CgppbXBv\ncnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLm1hcC5MaW5rZWRN\nYXA7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGls\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5Tb3VyY2VU\ncmFja2VyOwoKLyoqCiAqIFJlcHJlc2VudHMgYSBkYXRhYmFzZSB0YWJsZS4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQGF1dGhvciBTdGVwaGVuIEtp\nbQogKi8KcHVibGljIGNsYXNzIFRhYmxlCiAgICBleHRlbmRzIE5hbWVTZXQK\nICAgIGltcGxlbWVudHMgQ29tcGFyYWJsZSwgU291cmNlVHJhY2tlciB7Cgog\nICAgcHJpdmF0ZSBTdHJpbmcgX25hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBT\ndHJpbmcgX3NjaGVtYU5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBNYXAgX2Nv\nbE1hcCA9IG51bGw7CiAgICBwcml2YXRlIE1hcCBfaWR4TWFwID0gbnVsbDsK\nICAgIHByaXZhdGUgQ29sbGVjdGlvbiBfZmtMaXN0ID0gbnVsbDsKICAgIHBy\naXZhdGUgQ29sbGVjdGlvbiBfdW5xTGlzdCA9IG51bGw7CiAgICBwcml2YXRl\nIFNjaGVtYSBfc2NoZW1hID0gbnVsbDsKICAgIHByaXZhdGUgUHJpbWFyeUtl\neSBfcGsgPSBudWxsOwoKICAgIC8vIGtlZXAgdHJhY2sgb2Ygc291cmNlCiAg\nICBwcml2YXRlIEZpbGUgX3NvdXJjZSA9IG51bGw7CiAgICBwcml2YXRlIGlu\ndCBfc3JjVHlwZSA9IFNSQ19PVEhFUjsKCiAgICAvLyBjYWNoZQogICAgcHJp\ndmF0ZSBTdHJpbmcgX2Z1bGxOYW1lID0gbnVsbDsKICAgIHByaXZhdGUgQ29s\ndW1uW10gX2NvbHMgPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW5bXSBfYXV0\nb0Fzc2lnbiA9IG51bGw7CiAgICBwcml2YXRlIENvbHVtbltdIF9yZWxzID0g\nbnVsbDsKICAgIHByaXZhdGUgRm9yZWlnbktleVtdIF9ma3MgPSBudWxsOwog\nICAgcHJpdmF0ZSBJbmRleFtdIF9pZHhzID0gbnVsbDsKICAgIHByaXZhdGUg\nVW5pcXVlW10gX3VucXMgPSBudWxsOwoKICAgIC8qKgogICAgICogRGVmYXVs\ndCBjb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIFRhYmxlKCkgewog\nICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAg\nICogQHBhcmFtIG5hbWUgdGhlIHRhYmxlIG5hbWUKICAgICAqIEBwYXJhbSBz\nY2hlbWEgdGhlIHRhYmxlIHNjaGVtYQogICAgICovCiAgICBwdWJsaWMgVGFi\nbGUoU3RyaW5nIG5hbWUsIFNjaGVtYSBzY2hlbWEpIHsKICAgICAgICBzZXRO\nYW1lKG5hbWUpOwogICAgICAgIGFkZE5hbWUobmFtZSwgdHJ1ZSk7CiAgICAg\nICAgaWYgKHNjaGVtYSAhPSBudWxsKQogICAgICAgICAgICBzZXRTY2hlbWFO\nYW1lKHNjaGVtYS5nZXROYW1lKCkpOwogICAgICAgIF9zY2hlbWEgPSBzY2hl\nbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxsZWQgd2hlbiB0aGUgdGFi\nbGUgaXMgcmVtb3ZlZCBmcm9tIGl0cyBzY2hlbWEuIFJlbW92ZXMgYWxsIHRh\nYmxlCiAgICAgKiBtZW1iZXJzLCBhbmQgaW52YWxpZGF0ZXMgdGhlIHRhYmxl\nLgogICAgICovCiAgICB2b2lkIHJlbW92ZSgpIHsKICAgICAgICBGb3JlaWdu\nS2V5W10gZmtzID0gZ2V0Rm9yZWlnbktleXMoKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGZrcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVt\nb3ZlRm9yZWlnbktleShma3NbaV0pOwogICAgICAgIEluZGV4W10gaWR4cyA9\nIGdldEluZGV4ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlk\neHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZUluZGV4KGlkeHNb\naV0pOwogICAgICAgIFVuaXF1ZVtdIHVucXMgPSBnZXRVbmlxdWVzKCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICByZW1vdmVVbmlxdWUodW5xc1tpXSk7CiAgICAgICAgcmVt\nb3ZlUHJpbWFyeUtleSgpOwogICAgICAgIENvbHVtbltdIGNvbHMgPSBnZXRD\nb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICByZW1vdmVDb2x1bW4oY29sc1tpXSk7\nCiAgICAgICAgX3NjaGVtYSA9IG51bGw7CiAgICAgICAgX3NjaGVtYU5hbWUg\nPSBudWxsOwogICAgICAgIF9mdWxsTmFtZSA9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNjaGVtYSBmb3IgdGhlIHRhYmxlLgog\nICAgICovCiAgICBwdWJsaWMgU2NoZW1hIGdldFNjaGVtYSgpIHsKICAgICAg\nICByZXR1cm4gX3NjaGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB0\nYWJsZSdzIHNjaGVtYSBuYW1lLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGdldFNjaGVtYU5hbWUoKSB7CiAgICAgICAgcmV0dXJuIF9zY2hlbWFOYW1l\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHRhYmxlJ3Mgc2NoZW1hIG5h\nbWUuIFlvdSBjYW4gb25seSBjYWxsIHRoaXMgbWV0aG9kIG9uIHRhYmxlcwog\nICAgICogd2hvc2Ugc2NoZW1hIG9iamVjdCBpcyBub3Qgc2V0LgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hlbWFOYW1lKFN0cmluZyBuYW1lKSB7\nCiAgICAgICAgaWYgKGdldFNjaGVtYSgpICE9IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKTsKICAgICAgICBf\nc2NoZW1hTmFtZSA9IG5hbWU7CiAgICAgICAgX2Z1bGxOYW1lID0gbnVsbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbmFtZSBvZiB0aGUg\ndGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsK\nICAgICAgICByZXR1cm4gX25hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nZXQgdGhlIG5hbWUgb2YgdGhlIHRhYmxlLiBUaGlzIG1ldGhvZCBjYW4gb25s\neSBiZSBjYWxsZWQgb24gdGFibGVzCiAgICAgKiB0aGF0IGFyZSBub3QgcGFy\ndCBvZiBhIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TmFt\nZShTdHJpbmcgbmFtZSkgewogICAgICAgIGlmIChnZXRTY2hlbWEoKSAhPSBu\ndWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0\naW9uKCk7CiAgICAgICAgX25hbWUgPSBuYW1lOwogICAgICAgIF9mdWxsTmFt\nZSA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHRh\nYmxlIG5hbWUsIGluY2x1ZGluZyBzY2hlbWEsIHVzaW5nICcuJyBhcyB0aGUK\nICAgICAqIGNhdGFsb2cgc2VwYXJhdG9yLgogICAgICovCiAgICBwdWJsaWMg\nU3RyaW5nIGdldEZ1bGxOYW1lKCkgewogICAgICAgIGlmIChfZnVsbE5hbWUg\nPT0gbnVsbCkgewogICAgICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ2V0U2No\nZW1hKCk7CiAgICAgICAgICAgIGlmIChzY2hlbWEgPT0gbnVsbCB8fCBzY2hl\nbWEuZ2V0TmFtZSgpID09IG51bGwpCiAgICAgICAgICAgICAgICBfZnVsbE5h\nbWUgPSBnZXROYW1lKCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgIF9mdWxsTmFtZSA9IHNjaGVtYS5nZXROYW1lKCkgKyAiLiIgKyBnZXRO\nYW1lKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfZnVsbE5hbWU7CiAg\nICB9CgogICAgcHVibGljIEZpbGUgZ2V0U291cmNlRmlsZSgpIHsKICAgICAg\nICByZXR1cm4gX3NvdXJjZTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdl\ndFNvdXJjZVNjb3BlKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoK\nICAgIHB1YmxpYyBpbnQgZ2V0U291cmNlVHlwZSgpIHsKICAgICAgICByZXR1\ncm4gX3NyY1R5cGU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0U291cmNl\nKEZpbGUgc291cmNlLCBpbnQgc3JjVHlwZSkgewogICAgICAgIF9zb3VyY2Ug\nPSBzb3VyY2U7CiAgICAgICAgX3NyY1R5cGUgPSBzcmNUeXBlOwogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0UmVzb3VyY2VOYW1lKCkgewogICAgICAg\nIHJldHVybiBnZXRGdWxsTmFtZSgpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSB0YWJsZSdzIGNvbHVtbnMsIGluIGFscGhhYmV0aWNhbCBv\ncmRlci4KICAgICAqLwogICAgcHVibGljIENvbHVtbltdIGdldENvbHVtbnMo\nKSB7CiAgICAgICAgaWYgKF9jb2xzID09IG51bGwpIHsKICAgICAgICAgICAg\naWYgKF9jb2xNYXAgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jb2xzID0g\nU2NoZW1hcy5FTVBUWV9DT0xVTU5TOwogICAgICAgICAgICBlbHNlIHsKICAg\nICAgICAgICAgICAgIENvbHVtbltdIGNvbHMgPSBuZXcgQ29sdW1uW19jb2xN\nYXAuc2l6ZSgpXTsKICAgICAgICAgICAgICAgIEl0ZXJhdG9yIGl0ciA9IF9j\nb2xNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpdHIuaGFzTmV4dCgpOyBpKyspIHsKICAgICAgICAg\nICAgICAgICAgICBjb2xzW2ldID0gKENvbHVtbikgaXRyLm5leHQoKTsKICAg\nICAgICAgICAgICAgICAgICBjb2xzW2ldLnNldEluZGV4KGkpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgX2NvbHMgPSBjb2xzOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfY29sczsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGlzIHRhYmxlJ3MgYXV0by1h\nc3NpZ25lZCBjb2x1bW5zLgogICAgICovCiAgICBwdWJsaWMgQ29sdW1uW10g\nZ2V0QXV0b0Fzc2lnbmVkQ29sdW1ucygpIHsKICAgICAgICBpZiAoX2F1dG9B\nc3NpZ24gPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoX2NvbE1hcCA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgX2F1dG9Bc3NpZ24gPSBTY2hlbWFzLkVN\nUFRZX0NPTFVNTlM7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAg\nICAgQ29sbGVjdGlvbiBhdXRvcyA9IG51bGw7CiAgICAgICAgICAgICAgICBD\nb2x1bW5bXSBjb2xzID0gZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGNvbHNbaV0uaXNBdXRvQXNzaWduZWQoKSkg\newogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0b3MgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9zID0gbmV3IEFycmF5\nTGlzdCgzKTsKICAgICAgICAgICAgICAgICAgICAgICAgYXV0b3MuYWRkKGNv\nbHNbaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIF9hdXRvQXNzaWduID0gKGF1dG9zID09IG51\nbGwpID8gU2NoZW1hcy5FTVBUWV9DT0xVTU5TCiAgICAgICAgICAgICAgICAg\nICAgOiAoQ29sdW1uW10pIGF1dG9zLnRvQXJyYXkobmV3IENvbHVtblthdXRv\ncy5zaXplKCldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gX2F1dG9Bc3NpZ247CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhpcyB0YWJsZSdzIHJlbGF0aW9uIGlkIGNvbHVtbnMuCiAgICAgKi8K\nICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRSZWxhdGlvbklkQ29sdW1ucygpIHsK\nICAgICAgICBpZiAoX3JlbHMgPT0gbnVsbCkgewogICAgICAgICAgICBpZiAo\nX2NvbE1hcCA9PSBudWxsKQogICAgICAgICAgICAgICAgX3JlbHMgPSBTY2hl\nbWFzLkVNUFRZX0NPTFVNTlM7CiAgICAgICAgICAgIGVsc2UgewogICAgICAg\nICAgICAgICAgQ29sbGVjdGlvbiByZWxzID0gbnVsbDsKICAgICAgICAgICAg\nICAgIENvbHVtbltdIGNvbHMgPSBnZXRDb2x1bW5zKCk7CiAgICAgICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAoY29sc1tpXS5pc1JlbGF0aW9uSWQo\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVscyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVscyA9IG5ldyBBcnJh\neUxpc3QoMyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlbHMuYWRkKGNv\nbHNbaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIF9yZWxzID0gKHJlbHMgPT0gbnVsbCkgPyBT\nY2hlbWFzLkVNUFRZX0NPTFVNTlMKICAgICAgICAgICAgICAgICAgICA6IChD\nb2x1bW5bXSkgcmVscy50b0FycmF5KG5ldyBDb2x1bW5bcmVscy5zaXplKCld\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gX3Jl\nbHM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbHVtbiB3\naXRoIHRoZSBnaXZlbiBuYW1lLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8K\nICAgIHB1YmxpYyBDb2x1bW4gZ2V0Q29sdW1uKFN0cmluZyBuYW1lKSB7CiAg\nICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8fCBfY29sTWFwID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiAoQ29sdW1u\nKSBfY29sTWFwLmdldChuYW1lLnRvVXBwZXJDYXNlKCkpOwogICAgfQoKICAg\nIC8qKgogICAgICogQWRkIGEgY29sdW1uIHRvIHRoZSB0YWJsZS4KICAgICAq\nLwogICAgcHVibGljIENvbHVtbiBhZGRDb2x1bW4oU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBhZGROYW1lKG5hbWUsIHRydWUpOwogICAgICAgIFNjaGVtYSBz\nY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICBDb2x1bW4gY29sOwogICAg\nICAgIGlmIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3Jv\ndXAoKSAhPSBudWxsKQogICAgICAgICAgICBjb2wgPSBzY2hlbWEuZ2V0U2No\nZW1hR3JvdXAoKS5uZXdDb2x1bW4obmFtZSwgdGhpcyk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBjb2wgPSBuZXcgQ29sdW1uKG5hbWUsIHRoaXMpOwog\nICAgICAgIGlmIChfY29sTWFwID09IG51bGwpCiAgICAgICAgICAgIF9jb2xN\nYXAgPSBuZXcgTGlua2VkTWFwKCk7CiAgICAgICAgX2NvbE1hcC5wdXQobmFt\nZS50b1VwcGVyQ2FzZSgpLCBjb2wpOwogICAgICAgIF9jb2xzID0gbnVsbDsK\nICAgICAgICByZXR1cm4gY29sOwogICAgfQoKICAgIC8qKgogICAgICogUmVt\nb3ZlIHRoZSBnaXZlbiBjb2x1bW4gZnJvbSB0aGUgdGFibGUuCiAgICAgKgog\nICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBjb2x1bW4gd2FzIHJlbW92ZWQs\nIGZhbHNlIGlmIG5vdCBpbiB0aGUgdGFibGUKICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gcmVtb3ZlQ29sdW1uKENvbHVtbiBjb2wpIHsKICAgICAgICBp\nZiAoY29sID09IG51bGwgfHwgX2NvbE1hcCA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIENvbHVtbiBjdXIgPSAoQ29sdW1u\nKSBfY29sTWFwLmdldChjb2wuZ2V0TmFtZSgpLnRvVXBwZXJDYXNlKCkpOwog\nICAgICAgIGlmICghY29sLmVxdWFscyhjdXIpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIHJlbW92ZU5hbWUoY29sLmdldE5hbWUoKSk7\nCiAgICAgICAgX2NvbE1hcC5yZW1vdmUoY29sLmdldE5hbWUoKS50b1VwcGVy\nQ2FzZSgpKTsKICAgICAgICBfY29scyA9IG51bGw7CiAgICAgICAgaWYgKGNv\nbC5pc0F1dG9Bc3NpZ25lZCgpKQogICAgICAgICAgICBfYXV0b0Fzc2lnbiA9\nIG51bGw7CiAgICAgICAgaWYgKGNvbC5pc1JlbGF0aW9uSWQoKSkKICAgICAg\nICAgICAgX3JlbHMgPSBudWxsOwogICAgICAgIGNvbC5yZW1vdmUoKTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcG9y\ndCBhIGNvbHVtbiBmcm9tIGFub3RoZXIgdGFibGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBDb2x1bW4gaW1wb3J0Q29sdW1uKENvbHVtbiBjb2wpIHsKICAgICAg\nICBpZiAoY29sID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoK\nICAgICAgICBDb2x1bW4gY29weSA9IGFkZENvbHVtbihjb2wuZ2V0TmFtZSgp\nKTsKICAgICAgICBjb3B5LnNldFR5cGUoY29sLmdldFR5cGUoKSk7CiAgICAg\nICAgY29weS5zZXRUeXBlTmFtZShjb2wuZ2V0VHlwZU5hbWUoKSk7CiAgICAg\nICAgY29weS5zZXRKYXZhVHlwZShjb2wuZ2V0SmF2YVR5cGUoKSk7CiAgICAg\nICAgY29weS5zZXROb3ROdWxsKGNvbC5pc05vdE51bGwoKSk7CiAgICAgICAg\nY29weS5zZXREZWZhdWx0U3RyaW5nKGNvbC5nZXREZWZhdWx0U3RyaW5nKCkp\nOwogICAgICAgIGNvcHkuc2V0U2l6ZShjb2wuZ2V0U2l6ZSgpKTsKICAgICAg\nICBjb3B5LnNldERlY2ltYWxEaWdpdHMoY29sLmdldERlY2ltYWxEaWdpdHMo\nKSk7CiAgICAgICAgY29weS5zZXRBdXRvQXNzaWduZWQoY29sLmlzQXV0b0Fz\nc2lnbmVkKCkpOwogICAgICAgIHJldHVybiBjb3B5OwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBwcmltYXJ5IGtleSBmb3IgdGhlIHRhYmxl\nLCBpZiBhbnkuCiAgICAgKi8KICAgIHB1YmxpYyBQcmltYXJ5S2V5IGdldFBy\naW1hcnlLZXkoKSB7CiAgICAgICAgcmV0dXJuIF9wazsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgcHJpbWFyeSBrZXkgZm9yIHRoZSB0YWJsZS4K\nICAgICAqLwogICAgcHVibGljIFByaW1hcnlLZXkgYWRkUHJpbWFyeUtleSgp\nIHsKICAgICAgICByZXR1cm4gYWRkUHJpbWFyeUtleShudWxsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgcHJpbWFyeSBrZXkgZm9yIHRoZSB0\nYWJsZS4KICAgICAqLwogICAgcHVibGljIFByaW1hcnlLZXkgYWRkUHJpbWFy\neUtleShTdHJpbmcgbmFtZSkgewogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBn\nZXRTY2hlbWEoKTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2No\nZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkgewogICAgICAgICAgICBz\nY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5hZGROYW1lKG5hbWUsIGZhbHNlKTsK\nICAgICAgICAgICAgX3BrID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkubmV3\nUHJpbWFyeUtleShuYW1lLCB0aGlzKTsKICAgICAgICB9IGVsc2UKICAgICAg\nICAgICAgX3BrID0gbmV3IFByaW1hcnlLZXkobmFtZSwgdGhpcyk7CiAgICAg\nICAgcmV0dXJuIF9wazsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0\naGUgcHJpbWFyeSBrZXkgZnJvbSB0aGlzIHRhYmxlLgogICAgICoKICAgICAq\nIEByZXR1cm4gdHJ1ZSBpZiB0aGVyZSB3YXMgYSBwayB0byByZW1vdmUsIGZh\nbHNlIG90aGVyd2lzZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiByZW1v\ndmVQcmltYXJ5S2V5KCkgewogICAgICAgIGJvb2xlYW4gcmVtID0gX3BrICE9\nIG51bGw7CiAgICAgICAgaWYgKHJlbSkgewogICAgICAgICAgICBTY2hlbWEg\nc2NoZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAgICAgICAgIGlmIChzY2hlbWEg\nIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAhPSBudWxsKQog\nICAgICAgICAgICAgICAgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkucmVtb3Zl\nTmFtZShfcGsuZ2V0TmFtZSgpKTsKICAgICAgICAgICAgX3BrLnJlbW92ZSgp\nOwogICAgICAgIH0KICAgICAgICBfcGsgPSBudWxsOwogICAgICAgIHJldHVy\nbiByZW07CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSBwcmltYXJ5\nIGtleTsgY29sdW1uIG5hbWVzIG11c3QgbWF0Y2ggY29sdW1ucyBvZiB0aGlz\nIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgUHJpbWFyeUtleSBpbXBvcnRQ\ncmltYXJ5S2V5KFByaW1hcnlLZXkgcGspIHsKICAgICAgICBpZiAocGsgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIFByaW1h\ncnlLZXkgY29weSA9IGFkZFByaW1hcnlLZXkocGsuZ2V0TmFtZSgpKTsKICAg\nICAgICBjb3B5LnNldExvZ2ljYWwocGsuaXNMb2dpY2FsKCkpOwogICAgICAg\nIENvbHVtbltdIGNvbHMgPSBway5nZXRDb2x1bW5zKCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICBjb3B5LmFkZENvbHVtbihnZXRDb2x1bW4oY29sc1tpXS5nZXROYW1lKCkp\nKTsKICAgICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgZm9yZWlnbiBrZXkgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4g\nSWYgbXVsdGlwbGUgZm9yZWlnbiBrZXlzCiAgICAgKiBoYXZlIHRoZSBuYW1l\nLCB0aGUgZmlyc3QgbWF0Y2ggaXMgcmV0dXJuZWQuCiAgICAgKi8KICAgIHB1\nYmxpYyBGb3JlaWduS2V5IGdldEZvcmVpZ25LZXkoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBGb3JlaWduS2V5W10gZmtzID0gZ2V0Rm9yZWlnbktleXMoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZrcy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmVxdWFsc0lnbm9yZUNhc2Uo\nbmFtZSwgZmtzW2ldLmdldE5hbWUoKSkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gZmtzW2ldOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIGFsbCBmb3JlaWduIGtleXMgZm9yIHRoZSB0YWJs\nZS4KICAgICAqLwogICAgcHVibGljIEZvcmVpZ25LZXlbXSBnZXRGb3JlaWdu\nS2V5cygpIHsKICAgICAgICBpZiAoX2ZrcyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIGlmIChfZmtMaXN0ID09IG51bGwpCiAgICAgICAgICAgICAgICBfZmtz\nID0gU2NoZW1hcy5FTVBUWV9GT1JFSUdOX0tFWVM7CiAgICAgICAgICAgIGVs\nc2UgewogICAgICAgICAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IG5ldyBG\nb3JlaWduS2V5W19ma0xpc3Quc2l6ZSgpXTsKICAgICAgICAgICAgICAgIEl0\nZXJhdG9yIGl0ciA9IF9ma0xpc3QuaXRlcmF0b3IoKTsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpdHIuaGFzTmV4dCgpOyBpKyspIHsKICAg\nICAgICAgICAgICAgICAgICBma3NbaV0gPSAoRm9yZWlnbktleSkgaXRyLm5l\neHQoKTsKICAgICAgICAgICAgICAgICAgICBma3NbaV0uc2V0SW5kZXgoaSk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfZmtzID0gZmtz\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfZmtz\nOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgZm9yZWlnbiBrZXkgdG8g\ndGhlIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleSBhZGRG\nb3JlaWduS2V5KCkgewogICAgICAgIHJldHVybiBhZGRGb3JlaWduS2V5KG51\nbGwpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgZm9yZWlnbiBrZXkg\ndG8gdGhlIHRhYmxlLiBEdXBsaWNhdGUga2V5IG5hbWVzIGFyZSBub3QgYWxs\nb3dlZC4KICAgICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkgYWRkRm9yZWln\nbktleShTdHJpbmcgbmFtZSkgewogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBn\nZXRTY2hlbWEoKTsKICAgICAgICBGb3JlaWduS2V5IGZrOwogICAgICAgIGlm\nIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAh\nPSBudWxsKSB7CiAgICAgICAgICAgIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgp\nLmFkZE5hbWUobmFtZSwgZmFsc2UpOwogICAgICAgICAgICBmayA9IHNjaGVt\nYS5nZXRTY2hlbWFHcm91cCgpLm5ld0ZvcmVpZ25LZXkobmFtZSwgdGhpcyk7\nCiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIGZrID0gbmV3IEZvcmVpZ25L\nZXkobmFtZSwgdGhpcyk7CiAgICAgICAgaWYgKF9ma0xpc3QgPT0gbnVsbCkK\nICAgICAgICAgICAgX2ZrTGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CiAgICAg\nICAgX2ZrTGlzdC5hZGQoZmspOwogICAgICAgIF9ma3MgPSBudWxsOwogICAg\nICAgIHJldHVybiBmazsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0\naGUgZ2l2ZW4gZm9yZWlnbiBrZXkgZnJvbSB0aGUgdGFibGUuCiAgICAgKgog\nICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBrZXkgd2FzIHJlbW92ZWQsIGZh\nbHNlIGlmIG5vdCBpbiB0aGUgdGFibGUKICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gcmVtb3ZlRm9yZWlnbktleShGb3JlaWduS2V5IGZrKSB7CiAgICAg\nICAgaWYgKGZrID09IG51bGwgfHwgX2ZrTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGlmICghX2ZrTGlzdC5yZW1v\ndmUoZmspKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIFNj\naGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICBpZiAoc2NoZW1h\nICE9IG51bGwgJiYgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkK\nICAgICAgICAgICAgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkucmVtb3ZlTmFt\nZShmay5nZXROYW1lKCkpOwogICAgICAgIF9ma3MgPSBudWxsOwogICAgICAg\nIGZrLnJlbW92ZSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAg\nIC8qKgogICAgICogSW1wb3J0IGEgZm9yZWlnbiBrZXk7IGNvbHVtbiBuYW1l\ncyBtdXN0IG1hdGNoIGNvbHVtbnMgb2YgdGhpcyB0YWJsZS4KICAgICAqLwog\nICAgcHVibGljIEZvcmVpZ25LZXkgaW1wb3J0Rm9yZWlnbktleShGb3JlaWdu\nS2V5IGZrKSB7CiAgICAgICAgaWYgKGZrID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBGb3JlaWduS2V5IGNvcHkgPSBhZGRG\nb3JlaWduS2V5KGZrLmdldE5hbWUoKSk7CiAgICAgICAgY29weS5zZXREZWxl\ndGVBY3Rpb24oZmsuZ2V0RGVsZXRlQWN0aW9uKCkpOwoKICAgICAgICBTY2hl\nbWEgc2NoZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAgICAgaWYgKHNjaGVtYSAh\nPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpICE9IG51bGwpIHsK\nICAgICAgICAgICAgQ29sdW1uW10gcGtzID0gZmsuZ2V0UHJpbWFyeUtleUNv\nbHVtbnMoKTsKICAgICAgICAgICAgVGFibGUgam9pbmVkID0gbnVsbDsKICAg\nICAgICAgICAgaWYgKHBrcy5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAg\nam9pbmVkID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkuZmluZFRhYmxlKHBr\nc1swXS5nZXRUYWJsZSgpKTsKCiAgICAgICAgICAgIENvbHVtbltdIGNvbHMg\nPSBmay5nZXRDb2x1bW5zKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGNvcHku\nam9pbihnZXRDb2x1bW4oY29sc1tpXS5nZXROYW1lKCkpLAogICAgICAgICAg\nICAgICAgICAgIGpvaW5lZC5nZXRDb2x1bW4ocGtzW2ldLmdldE5hbWUoKSkp\nOwoKICAgICAgICAgICAgY29scyA9IGZrLmdldENvbnN0YW50Q29sdW1ucygp\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgICAgICBjb3B5LmpvaW5Db25zdGFudChnZXRD\nb2x1bW4oY29sc1tpXS5nZXROYW1lKCkpLAogICAgICAgICAgICAgICAgICAg\nIGZrLmdldFByaW1hcnlLZXlDb25zdGFudChjb2xzW2ldKSk7CgogICAgICAg\nICAgICBwa3MgPSBmay5nZXRDb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCk7\nCiAgICAgICAgICAgIGlmIChqb2luZWQgPT0gbnVsbCAmJiBwa3MubGVuZ3Ro\nID4gMCkKICAgICAgICAgICAgICAgIGpvaW5lZCA9IHNjaGVtYS5nZXRTY2hl\nbWFHcm91cCgpLmZpbmRUYWJsZShwa3NbMF0uZ2V0VGFibGUoKSk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGtzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICAgICAgY29weS5qb2luQ29uc3RhbnQoZmsuZ2V0Q29uc3Rh\nbnQocGtzW2ldKSwKICAgICAgICAgICAgICAgICAgICBqb2luZWQuZ2V0Q29s\ndW1uKHBrc1tpXS5nZXROYW1lKCkpKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIGNvcHk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHRh\nYmxlJ3MgaW5kZXhlcy4KICAgICAqLwogICAgcHVibGljIEluZGV4W10gZ2V0\nSW5kZXhlcygpIHsKICAgICAgICBpZiAoX2lkeHMgPT0gbnVsbCkKICAgICAg\nICAgICAgX2lkeHMgPSAoX2lkeE1hcCA9PSBudWxsKSA/IFNjaGVtYXMuRU1Q\nVFlfSU5ERVhFUyA6IChJbmRleFtdKQogICAgICAgICAgICAgICAgX2lkeE1h\ncC52YWx1ZXMoKS50b0FycmF5KG5ldyBJbmRleFtfaWR4TWFwLnNpemUoKV0p\nOwogICAgICAgIHJldHVybiBfaWR4czsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgaW5kZXggd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVs\nbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgSW5kZXggZ2V0SW5kZXgo\nU3RyaW5nIG5hbWUpIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8IF9p\nZHhNYXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgcmV0dXJuIChJbmRleCkgX2lkeE1hcC5nZXQobmFtZS50b1VwcGVyQ2Fz\nZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBhbiBpbmRleCB0byB0\naGUgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBJbmRleCBhZGRJbmRleChT\ndHJpbmcgbmFtZSkgewogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hl\nbWEoKTsKICAgICAgICBJbmRleCBpZHg7CiAgICAgICAgaWYgKHNjaGVtYSAh\nPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpICE9IG51bGwpIHsK\nICAgICAgICAgICAgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkuYWRkTmFtZShu\nYW1lLCB0cnVlKTsKICAgICAgICAgICAgaWR4ID0gc2NoZW1hLmdldFNjaGVt\nYUdyb3VwKCkubmV3SW5kZXgobmFtZSwgdGhpcyk7CiAgICAgICAgfSBlbHNl\nCiAgICAgICAgICAgIGlkeCA9IG5ldyBJbmRleChuYW1lLCB0aGlzKTsKICAg\nICAgICBpZiAoX2lkeE1hcCA9PSBudWxsKQogICAgICAgICAgICBfaWR4TWFw\nID0gbmV3IFRyZWVNYXAoKTsKICAgICAgICBfaWR4TWFwLnB1dChuYW1lLnRv\nVXBwZXJDYXNlKCksIGlkeCk7CiAgICAgICAgX2lkeHMgPSBudWxsOwogICAg\nICAgIHJldHVybiBpZHg7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUg\ndGhlIGdpdmVuIGluZGV4IGZyb20gdGhlIHRhYmxlLgogICAgICoKICAgICAq\nIEByZXR1cm4gdHJ1ZSBpZiB0aGUgaW5kZXggd2FzIHJlbW92ZWQsIGZhbHNl\nIGlmIG5vdCBpbiB0aGUgdGFibGUKICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gcmVtb3ZlSW5kZXgoSW5kZXggaWR4KSB7CiAgICAgICAgaWYgKGlkeCA9\nPSBudWxsIHx8IF9pZHhNYXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwoKICAgICAgICBJbmRleCBjdXIgPSAoSW5kZXgpIF9pZHhNYXAu\nZ2V0KGlkeC5nZXROYW1lKCkudG9VcHBlckNhc2UoKSk7CiAgICAgICAgaWYg\nKCFpZHguZXF1YWxzKGN1cikpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgX2lkeE1hcC5yZW1vdmUoaWR4LmdldE5hbWUoKS50b1VwcGVy\nQ2FzZSgpKTsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ2V0U2NoZW1hKCk7\nCiAgICAgICAgaWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hl\nbWFHcm91cCgpICE9IG51bGwpCiAgICAgICAgICAgIHNjaGVtYS5nZXRTY2hl\nbWFHcm91cCgpLnJlbW92ZU5hbWUoaWR4LmdldE5hbWUoKSk7CiAgICAgICAg\naWR4LnJlbW92ZSgpOwogICAgICAgIF9pZHhzID0gbnVsbDsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcG9ydCBhbiBp\nbmRleDsgY29sdW1uIG5hbWVzIG11c3QgbWF0Y2ggY29sdW1ucyBvZiB0aGlz\nIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgSW5kZXggaW1wb3J0SW5kZXgo\nSW5kZXggaWR4KSB7CiAgICAgICAgaWYgKGlkeCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgSW5kZXggY29weSA9IGFkZElu\nZGV4KGlkeC5nZXROYW1lKCkpOwogICAgICAgIGNvcHkuc2V0VW5pcXVlKGlk\neC5pc1VuaXF1ZSgpKTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9IGlkeC5n\nZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBjb3B5LmFkZENvbHVtbihnZXRD\nb2x1bW4oY29sc1tpXS5nZXROYW1lKCkpKTsKICAgICAgICByZXR1cm4gY29w\neTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdGFibGUncyB1\nbmlxdWUgY29uc3RyYWludHMuCiAgICAgKi8KICAgIHB1YmxpYyBVbmlxdWVb\nXSBnZXRVbmlxdWVzKCkgewogICAgICAgIGlmIChfdW5xcyA9PSBudWxsKQog\nICAgICAgICAgICBfdW5xcyA9IChfdW5xTGlzdCA9PSBudWxsKSA/IFNjaGVt\nYXMuRU1QVFlfVU5JUVVFUyA6IChVbmlxdWVbXSkKICAgICAgICAgICAgICAg\nIF91bnFMaXN0LnRvQXJyYXkobmV3IFVuaXF1ZVtfdW5xTGlzdC5zaXplKCld\nKTsKICAgICAgICByZXR1cm4gX3VucXM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIHVuaXF1ZSBjb25zdHJhaW50IHdpdGggdGhlIGdpdmVu\nIG5hbWUsIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIFVu\naXF1ZSBnZXRVbmlxdWUoU3RyaW5nIG5hbWUpIHsKICAgICAgICBVbmlxdWVb\nXSB1bnFzID0gZ2V0VW5pcXVlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKFN0cmlu\nZ1V0aWxzLmVxdWFsc0lnbm9yZUNhc2UobmFtZSwgdW5xc1tpXS5nZXROYW1l\nKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHVucXNbaV07CiAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSB1bmlx\ndWUgY29uc3RyYWludCB0byB0aGUgdGFibGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBVbmlxdWUgYWRkVW5pcXVlKFN0cmluZyBuYW1lKSB7CiAgICAgICAgU2No\nZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIFVuaXF1ZSB1bnE7\nCiAgICAgICAgaWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hl\nbWFHcm91cCgpICE9IG51bGwpIHsKICAgICAgICAgICAgc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkuYWRkTmFtZShuYW1lLCBmYWxzZSk7CiAgICAgICAgICAg\nIHVucSA9IHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpLm5ld1VuaXF1ZShuYW1l\nLCB0aGlzKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgdW5xID0gbmV3\nIFVuaXF1ZShuYW1lLCB0aGlzKTsKICAgICAgICBpZiAoX3VucUxpc3QgPT0g\nbnVsbCkKICAgICAgICAgICAgX3VucUxpc3QgPSBuZXcgQXJyYXlMaXN0KDMp\nOwogICAgICAgIF91bnFMaXN0LmFkZCh1bnEpOwogICAgICAgIF91bnFzID0g\nbnVsbDsKICAgICAgICByZXR1cm4gdW5xOwogICAgfQoKICAgIC8qKgogICAg\nICogUmVtb3ZlIHRoZSBnaXZlbiB1bmlxdWUgY29uc3RyYWludCBmcm9tIHRo\nZSB0YWJsZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGNv\nbnN0cmFpbnQgd2FzIHJlbW92ZWQsIGZhbHNlIGlmIG5vdCBpbiB0aGUgdGFi\nbGUKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlVW5pcXVlKFVu\naXF1ZSB1bnEpIHsKICAgICAgICBpZiAodW5xID09IG51bGwgfHwgX3VucUxp\nc3QgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAg\nICBpZiAoIV91bnFMaXN0LnJlbW92ZSh1bnEpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEo\nKTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkgIT0gbnVsbCkKICAgICAgICAgICAgc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkucmVtb3ZlTmFtZSh1bnEuZ2V0TmFtZSgpKTsKICAgICAg\nICBfdW5xcyA9IG51bGw7CiAgICAgICAgdW5xLnJlbW92ZSgpOwogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogSW1wb3J0IGEg\nY29uc3RyYWludDsgY29sdW1uIG5hbWVzIG11c3QgbWF0Y2ggY29sdW1ucyBv\nZiB0aGlzIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgVW5pcXVlIGltcG9y\ndFVuaXF1ZShVbmlxdWUgdW5xKSB7CiAgICAgICAgaWYgKHVucSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgVW5pcXVlIGNv\ncHkgPSBhZGRVbmlxdWUodW5xLmdldE5hbWUoKSk7CiAgICAgICAgY29weS5z\nZXREZWZlcnJlZCh1bnEuaXNEZWZlcnJlZCgpKTsKCiAgICAgICAgQ29sdW1u\nW10gY29scyA9IHVucS5nZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBjb3B5\nLmFkZENvbHVtbihnZXRDb2x1bW4oY29sc1tpXS5nZXROYW1lKCkpKTsKICAg\nICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGxl\nZCBieSBjb2x1bW5zIHRvIGVuc3VyZSB0aGF0IGFsbCBjb2x1bW5zIGFyZSBw\ncm9wZXJseSBpbmRleGVkCiAgICAgKiBiZWZvcmUgcmV0dXJuaW5nIHRoYXQg\naW5mb3JtYXRpb24gdG8gdGhlIHVzZXIuCiAgICAgKi8KICAgIHZvaWQgaW5k\nZXhDb2x1bW5zKCkgewogICAgICAgIGdldENvbHVtbnMoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENhbGxlZCBieSBmb3JlaWduIGtleXMgdG8gZW5zdXJl\nIHRoYXQgYWxsIGZrcyBhcmUgcHJvcGVybHkgaW5kZXhlZAogICAgICogYmVm\nb3JlIHJldHVybmluZyB0aGF0IGluZm9ybWF0aW9uIHRvIHRoZSB1c2VyLgog\nICAgICovCiAgICB2b2lkIGluZGV4Rm9yZWlnbktleXMoKSB7CiAgICAgICAg\nZ2V0Rm9yZWlnbktleXMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGxl\nZCBieSBjb2x1bW5zIHdoZW4gdGhlaXIgYXV0byBpbmNyZW1lbnQgc3RhdHVz\nIGNoYW5nZXMuCiAgICAgKi8KICAgIHZvaWQgY2hhbmdlQXV0b0Fzc2lnbmVk\nKENvbHVtbiBjb2wpIHsKICAgICAgICBfYXV0b0Fzc2lnbiA9IG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDYWxsZWQgYnkgY29sdW1ucyB3aGVuIHRo\nZWlyIHJlbGF0aW9uIGlkIHN0YXR1cyBjaGFuZ2VzLgogICAgICovCiAgICB2\nb2lkIGNoYW5nZVJlbGF0aW9uSWQoQ29sdW1uIGNvbCkgewogICAgICAgIF9y\nZWxzID0gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgaW50IGNvbXBhcmVUbyhP\nYmplY3Qgb3RoZXIpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGdldEZ1bGxO\nYW1lKCk7CiAgICAgICAgU3RyaW5nIG90aGVyTmFtZSA9ICgoVGFibGUpIG90\naGVyKS5nZXRGdWxsTmFtZSgpOwogICAgICAgIGlmIChuYW1lID09IG51bGwg\nJiYgb3RoZXJOYW1lID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAwOwog\nICAgICAgIGlmIChuYW1lID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAx\nOwogICAgICAgIGlmIChvdGhlck5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIC0xOwogICAgICAgIHJldHVybiBuYW1lLmNvbXBhcmVUbyhvdGhl\nck5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7\nCiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKCk7CiAgICB9Cn0K\n","encoding":"base64"}

