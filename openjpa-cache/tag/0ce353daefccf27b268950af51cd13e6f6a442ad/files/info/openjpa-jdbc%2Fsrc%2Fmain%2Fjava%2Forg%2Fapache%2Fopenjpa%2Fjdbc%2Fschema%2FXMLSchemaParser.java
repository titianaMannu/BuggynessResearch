{"sha":"87582b41e49497b40acd4cb85c6d1841b0c0a284","node_id":"MDQ6QmxvYjIwNjM2NDo4NzU4MmI0MWU0OTQ5N2I0MGFjZDRjYjg1YzZkMTg0MWIwYzBhMjg0","size":20664,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/87582b41e49497b40acd4cb85c6d1841b0c0a284","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0\naW9uOwppbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbVJlYWRlcjsKaW1wb3J0\nIGphdmEuaW8uUmVhZGVyOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247\nCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwu\nTGlua2VkTGlzdDsKCmltcG9ydCBvcmcueG1sLnNheC5BdHRyaWJ1dGVzOwpp\nbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuWE1MTWV0YURh\ndGFQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplci5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBDdXN0b20gU0FYIHBhcnNl\nciB1c2VkIHRvIHBhcnNlIHtAbGluayBTY2hlbWF9IG9iamVjdHMuIFRoZSBw\nYXJzZXIKICogd2lsbCBwbGFjZSBhbGwgcGFyc2VkIHNjaGVtYXMgaW50byB0\naGUgY3VycmVudCB7QGxpbmsgU2NoZW1hR3JvdXB9LCBzZXQKICogdmlhIHRo\nZSB7QGxpbmsgI3NldFNjaGVtYUdyb3VwfSBtZXRob2QuIFRoaXMgYWxsb3dz\nIHBhcnNpbmcgb2YKICogbXVsdGlwbGUgZmlsZXMgaW50byBhIHNpbmdsZSBz\nY2hlbWEgZ3JvdXAuCiAqICBUaGUgcGFyc2VyIGRlc2VyaWFsaXplcyBmcm9t\nIHRoZSBmb2xsb3dpbmcgWE1MIGZvcm1hdDo8YnIgLz4KICogPGNvZGU+ICZs\ndDshRUxFTUVOVCBzY2hlbWFzIChzY2hlbWEpKyZndDs8YnIgLz4KICogJmx0\nOyFFTEVNRU5UIHNjaGVtYSAodGFibGV8c2VxdWVuY2UpKyZndDs8YnIgLz4K\nICogJmx0OyFBVFRMSVNUIHNjaGVtYSBuYW1lIENEQVRBICNJTVBMSUVEJmd0\nOzxiciAvPgogKiAmbHQ7IUVMRU1FTlQgdGFibGUgKGNvbHVtbnxpbmRleHxw\na3xma3x1bmlxdWUpKyZndDs8YnIgLz4KICogJmx0OyFBVFRMSVNUIHRhYmxl\nIG5hbWUgQ0RBVEEgI1JFUVVJUkVEJmd0OzxiciAvPgogKiAmbHQ7IUVMRU1F\nTlQgY29sdW1uIEVNUFRZJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1QgY29s\ndW1uIG5hbWUgQ0RBVEEgI1JFUVVJUkVEJmd0OzxiciAvPgogKiAmbHQ7IUFU\nVExJU1QgY29sdW1uIHR5cGUgKGFycmF5fGJpZ2ludHxiaW5hcnl8Yml0fGJs\nb2J8Y2hhcnxjbG9iCiAqIHxkYXRlfGRlY2ltYWx8ZGlzdGluY3R8ZG91Ymxl\nfGZsb2F0fGludGVnZXJ8amF2YV9vYmplY3QKICogfGxvbmd2YXJiaW5hcnl8\nbG9uZ3ZhcmNoYXJ8bnVsbHxudW1lcmljfG90aGVyfHJlYWx8cmVmfHNtYWxs\naW50fHN0cnVjdAogKiB8dGltZXx0aW1zdGFtcHx0aW55aW50fHZhcmJpbmFy\neXx2YXJjaGFyKSAjUkVRVUlSRUQmZ3Q7PGJyIC8+CiAqICZsdDshQVRUTElT\nVCBjb2x1bW4gdHlwZS1uYW1lIENEQVRBICNJTVBMSUVEJmd0OzxiciAvPgog\nKiAmbHQ7IUFUVExJU1QgY29sdW1uIHNpemUgQ0RBVEEgI0lNUExJRUQmZ3Q7\nPGJyIC8+CiAqICZsdDshQVRUTElTVCBjb2x1bW4gZGVjaW1hbC1kaWdpdHMg\nQ0RBVEEgI0lNUExJRUQmZ3Q7PGJyIC8+CiAqICZsdDshQVRUTElTVCBjb2x1\nbW4gbm90LW51bGwgKHRydWV8ZmFsc2UpICJmYWxzZSImZ3Q7PGJyIC8+CiAq\nICZsdDshQVRUTElTVCBjb2x1bW4gZGVmYXVsdCBDREFUQSAjSU1QTElFRCZn\ndDs8YnIgLz4KICogJmx0OyFBVFRMSVNUIGNvbHVtbiBhdXRvLWFzc2lnbiAo\ndHJ1ZXxmYWxzZSkgImZhbHNlIiZndDs8YnIgLz4KICogJmx0OyFFTEVNRU5U\nIGluZGV4IChvbikqJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1QgaW5kZXgg\nbmFtZSBDREFUQSAjUkVRVUlSRUQmZ3Q7PGJyIC8+CiAqICZsdDshQVRUTElT\nVCBpbmRleCBjb2x1bW4gQ0RBVEEgI0lNUExJRUQmZ3Q7PGJyIC8+CiAqICZs\ndDshQVRUTElTVCBpbmRleCB1bmlxdWUgKHRydWV8ZmFsc2UpICJmYWxzZSIm\nZ3Q7PGJyIC8+CiAqICZsdDshRUxFTUVOVCBvbiBFTVBUWSZndDs8YnIgLz4K\nICogJmx0OyFBVFRMSVNUIG9uIGNvbHVtbiBDREFUQSAjUkVRVUlSRUQmZ3Q7\nPGJyIC8+CiAqICZsdDshRUxFTUVOVCBwayAob24pKiZndDs8YnIgLz4gJmx0\nOyFBVFRMSVNUIHBrIG5hbWUgQ0RBVEEgI0lNUExJRUQmZ3Q7PGJyIC8+CiAq\nICZsdDshQVRUTElTVCBwayBjb2x1bW4gQ0RBVEEgI0lNUExJRUQmZ3Q7PGJy\nIC8+CiAqICZsdDshRUxFTUVOVCBmayAoam9pbikqJmd0OzxiciAvPgogKiAm\nbHQ7IUFUVExJU1QgZmsgbmFtZSBDREFUQSAjSU1QTElFRCZndDs8YnIgLz4K\nICogJmx0OyFBVFRMSVNUIGZrIGRlZmVycmVkICh0cnVlfGZhbHNlKSAiZmFs\nc2UiJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1QgZmsgY29sdW1uIENEQVRB\nICNJTVBMSUVEJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1QgZmsgdG8tdGFi\nbGUgQ0RBVEEgI1JFUVVJUkVEJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1Qg\nZmsgZGVsZXRlLWFjdGlvbiAoY2FzY2FkZXxkZWZhdWx0fHJlc3RyaWN0fG5v\nbmV8bnVsbCkKICogIm5vbmUiJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1Qg\nZmsgdXBkYXRlLWFjdGlvbiAoY2FzY2FkZXxkZWZhdWx0fHJlc3RyaWN0fG5v\nbmV8bnVsbCkKICogIm5vbmUiJmd0OzxiciAvPiAmbHQ7IUVMRU1FTlQgdW5p\ncXVlIChvbikqJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1QgdW5pcXVlIG5h\nbWUgQ0RBVEEgI0lNUExJRUQmZ3Q7PGJyIC8+CiAqICZsdDshQVRUTElTVCB1\nbmlxdWUgY29sdW1uIENEQVRBICNJTVBMSUVEJmd0OzxiciAvPgogKiAmbHQ7\nIUFUVExJU1QgdW5pcXVlIGRlZmVycmVkICh0cnVlfGZhbHNlKSAiZmFsc2Ui\nJmd0OzxiciAvPgogKiAmbHQ7IUVMRU1FTlQgam9pbiBFTVBUWSZndDs8YnIg\nLz4KICogJmx0OyFBVFRMSVNUIGpvaW4gY29sdW1uIENEQVRBICNJTVBMSUVE\nJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1Qgam9pbiB2YWx1ZSBDREFUQSAj\nSU1QTElFRCZndDs8YnIgLz4KICogJmx0OyFBVFRMSVNUIGpvaW4gdG8tY29s\ndW1uIENEQVRBICNSRVFVSVJFRCZndDs8YnIgLz4KICogJmx0OyFFTEVNRU5U\nIHNlcXVlbmNlIEVNUFRZJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1Qgc2Vx\ndWVuY2UgbmFtZSBDREFUQSAjUkVRVUlSRUQmZ3Q7PGJyIC8+CiAqICZsdDsh\nQVRUTElTVCBzZXF1ZW5jZSBpbml0aWFsLXZhbHVlIENEQVRBICNJTVBMSUVE\nJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1Qgc2VxdWVuY2UgaW5jcmVtZW50\nIENEQVRBICNJTVBMSUVEJmd0OzxiciAvPgogKiAmbHQ7IUFUVExJU1Qgc2Vx\ndWVuY2UgYWxsb2NhdGUgQ0RBVEEgI0lNUExJRUQmZ3Q7PGJyIC8+CiAqIDwv\nY29kZT4KICogIFNjaGVtYSBwYXJzZXJzIGFyZSBub3QgdGhyZWFkc2FmZS4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVi\nbGljIGNsYXNzIFhNTFNjaGVtYVBhcnNlcgogICAgZXh0ZW5kcyBYTUxNZXRh\nRGF0YVBhcnNlcgogICAgaW1wbGVtZW50cyBTY2hlbWFQYXJzZXIgewoKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxp\nemVyLmZvclBhY2thZ2UKICAgICAgICAoWE1MU2NoZW1hUGFyc2VyLmNsYXNz\nKTsKCiAgICBwcml2YXRlIGZpbmFsIERCRGljdGlvbmFyeSBfZGljdDsKCiAg\nICAvLyBzdGF0ZSBmb3IgY3VycmVudCBwYXJzZQogICAgcHJpdmF0ZSBTY2hl\nbWFHcm91cCBfZ3JvdXAgPSBudWxsOwogICAgcHJpdmF0ZSBTY2hlbWEgX3Nj\naGVtYSA9IG51bGw7CiAgICBwcml2YXRlIFRhYmxlIF90YWJsZSA9IG51bGw7\nCiAgICBwcml2YXRlIFByaW1hcnlLZXlJbmZvIF9wayA9IG51bGw7CiAgICBw\ncml2YXRlIEluZGV4SW5mbyBfaW5kZXggPSBudWxsOwogICAgcHJpdmF0ZSBV\nbmlxdWVJbmZvIF91bnEgPSBudWxsOwogICAgcHJpdmF0ZSBGb3JlaWduS2V5\nSW5mbyBfZmsgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9kZWxheSA9\nIGZhbHNlOwoKICAgIC8vIHVzZWQgdG8gY29sbGVjdCBpbmZvIG9uIHNjaGVt\nYSBlbGVtZW50cyBiZWZvcmUgdGhleSdyZSByZXNvbHZlZAogICAgcHJpdmF0\nZSBmaW5hbCBDb2xsZWN0aW9uIF9wa0luZm9zID0gbmV3IExpbmtlZExpc3Qo\nKTsKICAgIHByaXZhdGUgZmluYWwgQ29sbGVjdGlvbiBfaW5kZXhJbmZvcyA9\nIG5ldyBMaW5rZWRMaXN0KCk7CiAgICBwcml2YXRlIGZpbmFsIENvbGxlY3Rp\nb24gX3VucUluZm9zID0gbmV3IExpbmtlZExpc3QoKTsKICAgIHByaXZhdGUg\nZmluYWwgQ29sbGVjdGlvbiBfZmtJbmZvcyA9IG5ldyBMaW5rZWRMaXN0KCk7\nCgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZpZ3Vy\nYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBYTUxTY2hlbWFQYXJzZXIoSkRC\nQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9kaWN0ID0gY29uZi5n\nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIHNldExvZyhjb25m\nLmdldExvZyhKREJDQ29uZmlndXJhdGlvbi5MT0dfU0NIRU1BKSk7CiAgICAg\nICAgc2V0UGFyc2VUZXh0KGZhbHNlKTsKICAgICAgICBzZXRTdWZmaXgoIi5z\nY2hlbWEiKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXREZWxheUNv\nbnN0cmFpbnRSZXNvbHZlKCkgewogICAgICAgIHJldHVybiBfZGVsYXk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0RGVsYXlDb25zdHJhaW50UmVzb2x2\nZShib29sZWFuIGRlbGF5KSB7CiAgICAgICAgX2RlbGF5ID0gZGVsYXk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcmVzb2x2ZUNvbnN0cmFpbnRzKCkgewog\nICAgICAgIHJlc29sdmVQcmltYXJ5S2V5cygpOwogICAgICAgIHJlc29sdmVJ\nbmRleGVzKCk7CiAgICAgICAgcmVzb2x2ZUZvcmVpZ25LZXlzKCk7CiAgICAg\nICAgcmVzb2x2ZVVuaXF1ZXMoKTsKICAgICAgICBjbGVhckNvbnN0cmFpbnRJ\nbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciBjb25zdHJhaW50\nIGluZm9zLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXJDb25zdHJh\naW50SW5mbygpIHsKICAgICAgICBfcGtJbmZvcy5jbGVhcigpOwogICAgICAg\nIF9pbmRleEluZm9zLmNsZWFyKCk7CiAgICAgICAgX2ZrSW5mb3MuY2xlYXIo\nKTsKICAgICAgICBfdW5xSW5mb3MuY2xlYXIoKTsKICAgIH0KCiAgICBwdWJs\naWMgU2NoZW1hR3JvdXAgZ2V0U2NoZW1hR3JvdXAoKSB7CiAgICAgICAgaWYg\nKF9ncm91cCA9PSBudWxsKQogICAgICAgICAgICBfZ3JvdXAgPSBuZXcgU2No\nZW1hR3JvdXAoKTsKICAgICAgICByZXR1cm4gX2dyb3VwOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIGdyb3Vw\nKSB7CiAgICAgICAgX2dyb3VwID0gZ3JvdXA7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSB0aGUgc2NoZW1hIHJlbGF0aW5nIHRvIHRoZSBnaXZlbiBj\nbGFzcy4gVGhlIHNjaGVtYXMgd2lsbAogICAgICogYmUgYWRkZWQgdG8gdGhl\nIGN1cnJlbnQgc2NoZW1hIGdyb3VwLgogICAgICovCiAgICBwcm90ZWN0ZWQg\ndm9pZCBmaW5pc2goKSB7CiAgICAgICAgLy8gbm93IHJlc29sdmUgcGssIGlk\neCwgZmsgaW5mbwogICAgICAgIHN1cGVyLmZpbmlzaCgpOwogICAgICAgIGlm\nICghX2RlbGF5KQogICAgICAgICAgICByZXNvbHZlQ29uc3RyYWludHMoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZm9ybXMgdGhlIGNvbGxlY3Rl\nZCBwcmltYXJ5IGtleSBpbmZvcm1hdGlvbiBpbnRvIGFjdHVhbAogICAgICog\ncHJpbWFyeSBrZXlzIG9uIHRoZSBzY2hlbWEgdGFibGVzLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgcmVzb2x2ZVByaW1hcnlLZXlzKCkgewogICAgICAg\nIFByaW1hcnlLZXlJbmZvIHBrSW5mbzsKICAgICAgICBTdHJpbmcgY29sTmFt\nZTsKICAgICAgICBDb2x1bW4gY29sOwogICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gX3BrSW5mb3MuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgcGtJbmZvID0gKFByaW1hcnlLZXlJbmZvKSBpdHIubmV4\ndCgpOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGNvbHMgPSBwa0luZm8u\nY29scy5pdGVyYXRvcigpOyBjb2xzLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgICAgIGNvbE5hbWUgPSAoU3RyaW5nKSBjb2xzLm5leHQoKTsKICAgICAg\nICAgICAgICAgIGNvbCA9IHBrSW5mby5way5nZXRUYWJsZSgpLmdldENvbHVt\nbihjb2xOYW1lKTsKICAgICAgICAgICAgICAgIGlmIChjb2wgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICB0aHJvd1VzZXJFeGNlcHRpb24oX2xvYy5n\nZXQoInBrLXJlc29sdmUiLCBuZXcgT2JqZWN0W10KICAgICAgICAgICAgICAg\nICAgICAgICAgeyBjb2xOYW1lLCBwa0luZm8ucGsuZ2V0VGFibGUoKSB9KSk7\nCiAgICAgICAgICAgICAgICBwa0luZm8ucGsuYWRkQ29sdW1uKGNvbCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBU\ncmFuc2Zvcm1zIHRoZSBjb2xsZWN0ZWQgaW5kZXggaW5mb3JtYXRpb24gaW50\nbyBhY3R1YWwKICAgICAqIGluZGV4ZXMgb24gdGhlIHNjaGVtYSB0YWJsZXMu\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCByZXNvbHZlSW5kZXhlcygpIHsK\nICAgICAgICBJbmRleEluZm8gaW5kZXhJbmZvOwogICAgICAgIFN0cmluZyBj\nb2xOYW1lOwogICAgICAgIENvbHVtbiBjb2w7CiAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSBfaW5kZXhJbmZvcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICBpbmRleEluZm8gPSAoSW5kZXhJbmZvKSBp\ndHIubmV4dCgpOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGNvbHMgPSBp\nbmRleEluZm8uY29scy5pdGVyYXRvcigpOyBjb2xzLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgICAgIGNvbE5hbWUgPSAoU3RyaW5nKSBjb2xzLm5leHQo\nKTsKICAgICAgICAgICAgICAgIGNvbCA9IGluZGV4SW5mby5pbmRleC5nZXRU\nYWJsZSgpLmdldENvbHVtbihjb2xOYW1lKTsKICAgICAgICAgICAgICAgIGlm\nIChjb2wgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0aHJvd1VzZXJF\neGNlcHRpb24oX2xvYy5nZXQoImluZGV4LXJlc29sdmUiLCBuZXcgT2JqZWN0\nW10KICAgICAgICAgICAgICAgICAgICAgICAgeyBpbmRleEluZm8uaW5kZXgs\nIGNvbE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleElu\nZm8uaW5kZXguZ2V0VGFibGUoKSB9KSk7CiAgICAgICAgICAgICAgICBpbmRl\neEluZm8uaW5kZXguYWRkQ29sdW1uKGNvbCk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2Zvcm1zIHRoZSBj\nb2xsZWN0ZWQgZm9yZWlnbiBrZXkgaW5mb3JtYXRpb24gaW50byBhY3R1YWwK\nICAgICAqIGZvcmVpZ24ga2V5cyBvbiB0aGUgc2NoZW1hIHRhYmxlcy4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlc29sdmVGb3JlaWduS2V5cygpIHsK\nICAgICAgICBGb3JlaWduS2V5SW5mbyBma0luZm87CiAgICAgICAgVGFibGUg\ndG9UYWJsZTsKICAgICAgICBDb2x1bW4gY29sOwogICAgICAgIFN0cmluZyBj\nb2xOYW1lOwogICAgICAgIENvbHVtbiBwa0NvbDsKICAgICAgICBTdHJpbmcg\ncGtDb2xOYW1lOwogICAgICAgIFByaW1hcnlLZXkgcGs7CiAgICAgICAgSXRl\ncmF0b3IgcGtzOwogICAgICAgIEl0ZXJhdG9yIGNvbHM7CiAgICAgICAgZm9y\nIChJdGVyYXRvciBpdHIgPSBfZmtJbmZvcy5pdGVyYXRvcigpOyBpdHIuaGFz\nTmV4dCgpOykgewogICAgICAgICAgICBma0luZm8gPSAoRm9yZWlnbktleUlu\nZm8pIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIHRvVGFibGUgPSBfZ3JvdXAu\nZmluZFRhYmxlKGZrSW5mby50b1RhYmxlKTsKICAgICAgICAgICAgaWYgKHRv\nVGFibGUgPT0gbnVsbCB8fCB0b1RhYmxlLmdldFByaW1hcnlLZXkoKSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgdGhyb3dVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJmay10b3RhYmxlIiwgbmV3IE9iamVjdFtdCiAgICAgICAgICAgICAg\nICAgICAgeyBma0luZm8uZmssIGZrSW5mby50b1RhYmxlLCBma0luZm8uZmsu\nZ2V0VGFibGUoKSB9KSk7CgogICAgICAgICAgICAvLyBjaGVjayBpZiBvbmx5\nIG9uZSBmayBjb2x1bW4gbGlzdGVkIHVzaW5nIHNob3J0Y3V0CiAgICAgICAg\nICAgIHBrID0gdG9UYWJsZS5nZXRQcmltYXJ5S2V5KCk7CiAgICAgICAgICAg\nIGlmIChma0luZm8uY29scy5zaXplKCkgPT0gMSAmJiBma0luZm8ucGtzLnNp\nemUoKSA9PSAwKQogICAgICAgICAgICAgICAgZmtJbmZvLnBrcy5hZGQocGsu\nZ2V0Q29sdW1ucygpWzBdLmdldE5hbWUoKSk7CgogICAgICAgICAgICAvLyBt\nYWtlIGpvaW5zCiAgICAgICAgICAgIHBrcyA9IGZrSW5mby5wa3MuaXRlcmF0\nb3IoKTsKICAgICAgICAgICAgZm9yIChjb2xzID0gZmtJbmZvLmNvbHMuaXRl\ncmF0b3IoKTsgY29scy5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBj\nb2xOYW1lID0gKFN0cmluZykgY29scy5uZXh0KCk7CiAgICAgICAgICAgICAg\nICBjb2wgPSBma0luZm8uZmsuZ2V0VGFibGUoKS5nZXRDb2x1bW4oY29sTmFt\nZSk7CiAgICAgICAgICAgICAgICBpZiAoY29sID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgdGhyb3dVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJmay1u\nb2NvbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGZrSW5mby5maywgY29s\nTmFtZSwgZmtJbmZvLmZrLmdldFRhYmxlKCkpKTsKCiAgICAgICAgICAgICAg\nICBwa0NvbE5hbWUgPSAoU3RyaW5nKSBwa3MubmV4dCgpOwogICAgICAgICAg\nICAgICAgcGtDb2wgPSB0b1RhYmxlLmdldENvbHVtbihwa0NvbE5hbWUpOwog\nICAgICAgICAgICAgICAgaWYgKHBrQ29sID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgdGhyb3dVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJmay1ub3Br\nY29sIiwgbmV3IE9iamVjdFtdCiAgICAgICAgICAgICAgICAgICAgICAgIHsg\nZmtJbmZvLmZrLCBwa0NvbE5hbWUsIHRvVGFibGUsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBma0luZm8uZmsuZ2V0VGFibGUoKSB9KSk7CgogICAg\nICAgICAgICAgICAgZmtJbmZvLmZrLmpvaW4oY29sLCBwa0NvbCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIC8vIG1ha2UgY29uc3RhbnQgam9pbnMK\nICAgICAgICAgICAgY29scyA9IGZrSW5mby5jb25zdENvbHMuaXRlcmF0b3Io\nKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciB2YWxzID0gZmtJbmZvLmNv\nbnN0cy5pdGVyYXRvcigpOyB2YWxzLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgICAgIGNvbE5hbWUgPSAoU3RyaW5nKSBjb2xzLm5leHQoKTsKICAgICAg\nICAgICAgICAgIGNvbCA9IGZrSW5mby5may5nZXRUYWJsZSgpLmdldENvbHVt\nbihjb2xOYW1lKTsKICAgICAgICAgICAgICAgIGlmIChjb2wgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICB0aHJvd1VzZXJFeGNlcHRpb24oX2xvYy5n\nZXQoImZrLW5vY29sIiwKICAgICAgICAgICAgICAgICAgICAgICAgZmtJbmZv\nLmZrLCBjb2xOYW1lLCBma0luZm8uZmsuZ2V0VGFibGUoKSkpOwoKICAgICAg\nICAgICAgICAgIGZrSW5mby5may5qb2luQ29uc3RhbnQoY29sLCB2YWxzLm5l\neHQoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBrcyA9IGZrSW5m\nby5jb25zdENvbHNQSy5pdGVyYXRvcigpOwogICAgICAgICAgICBmb3IgKEl0\nZXJhdG9yIHZhbHMgPSBma0luZm8uY29uc3RzUEsuaXRlcmF0b3IoKTsgdmFs\ncy5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBwa0NvbE5hbWUgPSAo\nU3RyaW5nKSBwa3MubmV4dCgpOwogICAgICAgICAgICAgICAgcGtDb2wgPSB0\nb1RhYmxlLmdldENvbHVtbihwa0NvbE5hbWUpOwogICAgICAgICAgICAgICAg\naWYgKHBrQ29sID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3dV\nc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJmay1ub3BrY29sIiwgbmV3IE9iamVj\ndFtdCiAgICAgICAgICAgICAgICAgICAgICAgIHsgZmtJbmZvLmZrLCBwa0Nv\nbE5hbWUsIHRvVGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBm\na0luZm8uZmsuZ2V0VGFibGUoKSB9KSk7CgogICAgICAgICAgICAgICAgZmtJ\nbmZvLmZrLmpvaW5Db25zdGFudCh2YWxzLm5leHQoKSwgcGtDb2wpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJh\nbnNmb3JtcyB0aGUgY29sbGVjdGVkIHVuaXF1ZSBjb25zdHJhaW50IGluZm9y\nbWF0aW9uIGludG8gYWN0dWFsCiAgICAgKiBjb25zdHJhaW50cyBvbiB0aGUg\nc2NoZW1hIHRhYmxlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlc29s\ndmVVbmlxdWVzKCkgewogICAgICAgIFVuaXF1ZUluZm8gdW5xSW5mbzsKICAg\nICAgICBTdHJpbmcgY29sTmFtZTsKICAgICAgICBDb2x1bW4gY29sOwogICAg\nICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX3VucUluZm9zLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIHVucUluZm8gPSAoVW5p\ncXVlSW5mbykgaXRyLm5leHQoKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBjb2xzID0gdW5xSW5mby5jb2xzLml0ZXJhdG9yKCk7IGNvbHMuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAgICAgY29sTmFtZSA9IChTdHJpbmcpIGNv\nbHMubmV4dCgpOwogICAgICAgICAgICAgICAgY29sID0gdW5xSW5mby51bnEu\nZ2V0VGFibGUoKS5nZXRDb2x1bW4oY29sTmFtZSk7CiAgICAgICAgICAgICAg\nICBpZiAoY29sID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3dV\nc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bnEtcmVzb2x2ZSIsIG5ldyBPYmpl\nY3RbXQogICAgICAgICAgICAgICAgICAgICAgICB7IHVucUluZm8udW5xLCBj\nb2xOYW1lLCB1bnFJbmZvLnVucS5nZXRUYWJsZSgpIH0pKTsKICAgICAgICAg\nICAgICAgIHVucUluZm8udW5xLmFkZENvbHVtbihjb2wpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHJlc2V0\nKCkgewogICAgICAgIF9zY2hlbWEgPSBudWxsOwogICAgICAgIF90YWJsZSA9\nIG51bGw7CiAgICAgICAgX3BrID0gbnVsbDsKICAgICAgICBfaW5kZXggPSBu\ndWxsOwogICAgICAgIF9mayA9IG51bGw7CiAgICAgICAgX3VucSA9IG51bGw7\nCiAgICAgICAgaWYgKCFfZGVsYXkpCiAgICAgICAgICAgIGNsZWFyQ29uc3Ry\nYWludEluZm8oKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgUmVhZGVyIGdldERv\nY1R5cGUoKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIG5ldyBJbnB1dFN0cmVhbVJlYWRlcihYTUxTY2hlbWFQYXJzZXIu\nY2xhc3MKICAgICAgICAgICAgLmdldFJlc291cmNlQXNTdHJlYW0oInNjaGVt\nYXMtZG9jdHlwZS5yc3JjIikpOwogICAgfQoKICAgIHByb3RlY3RlZCBib29s\nZWFuIHN0YXJ0RWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBzd2l0\nY2ggKG5hbWUuY2hhckF0KDApKSB7CiAgICAgICAgICAgIGNhc2Uncyc6CiAg\nICAgICAgICAgICAgICBpZiAoInNjaGVtYSIuZXF1YWxzKG5hbWUpKQogICAg\nICAgICAgICAgICAgICAgIHN0YXJ0U2NoZW1hKGF0dHJzKTsKICAgICAgICAg\nICAgICAgIGVsc2UgaWYgKCJzZXF1ZW5jZSIuZXF1YWxzKG5hbWUpKQogICAg\nICAgICAgICAgICAgICAgIHN0YXJ0U2VxdWVuY2UoYXR0cnMpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGNhc2UndCc6CiAg\nICAgICAgICAgICAgICBzdGFydFRhYmxlKGF0dHJzKTsKICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICBjYXNlJ2MnOgogICAgICAg\nICAgICAgICAgc3RhcnRDb2x1bW4oYXR0cnMpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgICAgIGNhc2UncCc6CiAgICAgICAgICAg\nICAgICBzdGFydFByaW1hcnlLZXkoYXR0cnMpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgICAgIGNhc2UnaSc6CiAgICAgICAgICAg\nICAgICBzdGFydEluZGV4KGF0dHJzKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiB0cnVlOwogICAgICAgICAgICBjYXNlJ3UnOgogICAgICAgICAgICAgICAg\nc3RhcnRVbmlxdWUoYXR0cnMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgICAgIGNhc2UnZic6CiAgICAgICAgICAgICAgICBzdGFy\ndEZvcmVpZ25LZXkoYXR0cnMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgICAgIGNhc2Unbyc6CiAgICAgICAgICAgICAgICBzdGFy\ndE9uKGF0dHJzKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgICAgICBjYXNlJ2onOgogICAgICAgICAgICAgICAgc3RhcnRKb2luKGF0\ndHJzKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRFbGVtZW50KFN0\ncmluZyBuYW1lKSB7CiAgICAgICAgc3dpdGNoIChuYW1lLmNoYXJBdCgwKSkg\newogICAgICAgICAgICBjYXNlJ3MnOgogICAgICAgICAgICAgICAgaWYgKCJz\nY2hlbWEiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgICAgICAgICBlbmRT\nY2hlbWEoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlJ3QnOgogICAgICAgICAgICAgICAgZW5kVGFibGUoKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlJ3AnOgogICAgICAgICAg\nICAgICAgZW5kUHJpbWFyeUtleSgpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UnaSc6CiAgICAgICAgICAgICAgICBlbmRJbmRl\neCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Un\ndSc6CiAgICAgICAgICAgICAgICBlbmRVbmlxdWUoKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlJ2YnOgogICAgICAgICAgICAg\nICAgZW5kRm9yZWlnbktleSgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzdGFydFNjaGVtYShB\ndHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgLy8gY3JlYXRlcyBncm91cCBp\nZiBub3Qgc2V0CiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRTY2hl\nbWFHcm91cCgpOwoKICAgICAgICBTdHJpbmcgbmFtZSA9IGF0dHJzLmdldFZh\nbHVlKCJuYW1lIik7CiAgICAgICAgX3NjaGVtYSA9IGdyb3VwLmdldFNjaGVt\nYShuYW1lKTsKICAgICAgICBpZiAoX3NjaGVtYSA9PSBudWxsKQogICAgICAg\nICAgICBfc2NoZW1hID0gZ3JvdXAuYWRkU2NoZW1hKG5hbWUpOwogICAgfQoK\nICAgIHByaXZhdGUgdm9pZCBlbmRTY2hlbWEoKSB7CiAgICAgICAgX3NjaGVt\nYSA9IG51bGw7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHN0YXJ0U2VxdWVu\nY2UoQXR0cmlidXRlcyBhdHRycykgewogICAgICAgIFNlcXVlbmNlIHNlcSA9\nIF9zY2hlbWEuYWRkU2VxdWVuY2UoYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKSk7\nCiAgICAgICAgc2VxLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCksIHNlcS5T\nUkNfWE1MKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmcgdmFs\nID0gYXR0cnMuZ2V0VmFsdWUoImluaXRpYWwtdmFsdWUiKTsKICAgICAgICAg\nICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICAgICAgc2VxLnNldElu\naXRpYWxWYWx1ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgICAg\nICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiaW5jcmVtZW50Iik7CiAgICAgICAg\nICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNlcS5zZXRJ\nbmNyZW1lbnQoSW50ZWdlci5wYXJzZUludCh2YWwpKTsKICAgICAgICAgICAg\ndmFsID0gYXR0cnMuZ2V0VmFsdWUoImFsbG9jYXRlIik7CiAgICAgICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNlcS5zZXRBbGxv\nY2F0ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIH0gY2F0Y2gg\nKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgdGhy\nb3dVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc2VxLW51bSIsIHNlcS5n\nZXRGdWxsTmFtZSgpKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBzdGFydFRhYmxlKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBf\ndGFibGUgPSBfc2NoZW1hLmFkZFRhYmxlKGF0dHJzLmdldFZhbHVlKCJuYW1l\nIikpOwogICAgICAgIF90YWJsZS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgp\nLCBfdGFibGUuU1JDX1hNTCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGVu\nZFRhYmxlKCkgewogICAgICAgIF90YWJsZSA9IG51bGw7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIHN0YXJ0Q29sdW1uKEF0dHJpYnV0ZXMgYXR0cnMpIHsK\nICAgICAgICBDb2x1bW4gY29sID0gX3RhYmxlLmFkZENvbHVtbihhdHRycy5n\nZXRWYWx1ZSgibmFtZSIpKTsKICAgICAgICBjb2wuc2V0VHlwZShfZGljdC5n\nZXRQcmVmZXJyZWRUeXBlKFNjaGVtYXMuZ2V0SkRCQ1R5cGUKICAgICAgICAg\nICAgKGF0dHJzLmdldFZhbHVlKCJ0eXBlIikpKSk7CiAgICAgICAgY29sLnNl\ndFR5cGVOYW1lKGF0dHJzLmdldFZhbHVlKCJ0eXBlLW5hbWUiKSk7CiAgICAg\nICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJzaXplIik7CiAgICAg\nICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0U2l6ZShJ\nbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdl\ndFZhbHVlKCJkZWNpbWFsLWRpZ2l0cyIpOwogICAgICAgIGlmICh2YWwgIT0g\nbnVsbCkKICAgICAgICAgICAgY29sLnNldERlY2ltYWxEaWdpdHMoSW50ZWdl\nci5wYXJzZUludCh2YWwpKTsKICAgICAgICBjb2wuc2V0Tm90TnVsbCgidHJ1\nZSIuZXF1YWxzKGF0dHJzLmdldFZhbHVlKCJub3QtbnVsbCIpKSk7CiAgICAg\nICAgY29sLnNldEF1dG9Bc3NpZ25lZCgidHJ1ZSIuZXF1YWxzKGF0dHJzLmdl\ndFZhbHVlKCJhdXRvLWFzc2lnbiIpKQogICAgICAgICAgICB8fCAidHJ1ZSIu\nZXF1YWxzKGF0dHJzLmdldFZhbHVlKCJhdXRvLWluY3JlbWVudCIpKSk7IC8v\nIG9sZCBhdHRyCiAgICAgICAgY29sLnNldERlZmF1bHRTdHJpbmcoYXR0cnMu\nZ2V0VmFsdWUoImRlZmF1bHQiKSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIHN0YXJ0UHJpbWFyeUtleShBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAg\nX3BrID0gbmV3IFByaW1hcnlLZXlJbmZvKCk7CiAgICAgICAgX3BrLnBrID0g\nX3RhYmxlLmFkZFByaW1hcnlLZXkoYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKSk7\nCiAgICAgICAgX3BrLnBrLnNldExvZ2ljYWwoInRydWUiLmVxdWFscyhhdHRy\ncy5nZXRWYWx1ZSgibG9naWNhbCIpKSk7CgogICAgICAgIFN0cmluZyB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgiY29sdW1uIik7CiAgICAgICAgaWYgKHZhbCAh\nPSBudWxsKQogICAgICAgICAgICBfcGsuY29scy5hZGQodmFsKTsKICAgIH0K\nCiAgICBwcml2YXRlIHZvaWQgZW5kUHJpbWFyeUtleSgpIHsKICAgICAgICBf\ncGtJbmZvcy5hZGQoX3BrKTsKICAgICAgICBfcGsgPSBudWxsOwogICAgfQoK\nICAgIHByaXZhdGUgdm9pZCBzdGFydEluZGV4KEF0dHJpYnV0ZXMgYXR0cnMp\nIHsKICAgICAgICBfaW5kZXggPSBuZXcgSW5kZXhJbmZvKCk7CiAgICAgICAg\nX2luZGV4LmluZGV4ID0gX3RhYmxlLmFkZEluZGV4KGF0dHJzLmdldFZhbHVl\nKCJuYW1lIikpOwogICAgICAgIF9pbmRleC5pbmRleC5zZXRVbmlxdWUoInRy\ndWUiLmVxdWFscyhhdHRycy5nZXRWYWx1ZSgidW5pcXVlIikpKTsKCiAgICAg\nICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4iKTsKICAg\nICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIF9pbmRleC5jb2xz\nLmFkZCh2YWwpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBlbmRJbmRleCgp\nIHsKICAgICAgICBfaW5kZXhJbmZvcy5hZGQoX2luZGV4KTsKICAgICAgICBf\naW5kZXggPSBudWxsOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzdGFydFVu\naXF1ZShBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgX3VucSA9IG5ldyBV\nbmlxdWVJbmZvKCk7CiAgICAgICAgX3VucS51bnEgPSBfdGFibGUuYWRkVW5p\ncXVlKGF0dHJzLmdldFZhbHVlKCJuYW1lIikpOwogICAgICAgIF91bnEudW5x\nLnNldERlZmVycmVkKCJ0cnVlIi5lcXVhbHMoYXR0cnMuZ2V0VmFsdWUoImRl\nZmVycmVkIikpKTsKCiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZh\nbHVlKCJjb2x1bW4iKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAg\nICAgICAgIF91bnEuY29scy5hZGQodmFsKTsKICAgIH0KCiAgICBwcml2YXRl\nIHZvaWQgZW5kVW5pcXVlKCkgewogICAgICAgIF91bnFJbmZvcy5hZGQoX3Vu\ncSk7CiAgICAgICAgX3VucSA9IG51bGw7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIHN0YXJ0Rm9yZWlnbktleShBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAg\nICAgX2ZrID0gbmV3IEZvcmVpZ25LZXlJbmZvKCk7CiAgICAgICAgX2ZrLmZr\nID0gX3RhYmxlLmFkZEZvcmVpZ25LZXkoYXR0cnMuZ2V0VmFsdWUoIm5hbWUi\nKSk7CgogICAgICAgIGlmICgidHJ1ZSIuZXF1YWxzKGF0dHJzLmdldFZhbHVl\nKCJkZWZlcnJlZCIpKSkKICAgICAgICAgICAgX2ZrLmZrLnNldERlZmVycmVk\nKHRydWUpOwoKICAgICAgICAvLyBzZXQgdXBkYXRlIGFjdGlvbiBiZWZvcmUg\nZGVsZXRlIGFjdGlvbiBpbiBjYXNlIHVzZXIgaW5jb3JyZWN0bHkKICAgICAg\nICAvLyBzZXRzIHVwZGF0ZS1hY3Rpb24gdG8gIm5vbmUiIHdoZW4gdGhlcmUg\naXMgYSBkZWxldGUtYWN0aW9uOyBvdGhlcndpc2UKICAgICAgICAvLyBzZXR0\naW5nIHRoZSB1cGRhdGUtYWN0aW9uIHRvICJub25lIiB3aWxsIGFsc28gYXV0\nb21hdGljYWxseSBzZXQgdGhlCiAgICAgICAgLy8gZGVsZXRlLWFjdGlvbiB0\nbyAibm9uZSIsIHNpbmNlIEZLcyBjYW5ub3QgaGF2ZSBvbmUgYWN0aW8gYmUg\nbm9uZSBhbmQKICAgICAgICAvLyB0aGUgb3RoZXIgYmUgbm9uLW5vbmUKICAg\nICAgICBTdHJpbmcgYWN0aW9uID0gYXR0cnMuZ2V0VmFsdWUoInVwZGF0ZS1h\nY3Rpb24iKTsKICAgICAgICBpZiAoYWN0aW9uICE9IG51bGwpCiAgICAgICAg\nICAgIF9may5may5zZXRVcGRhdGVBY3Rpb24oRm9yZWlnbktleS5nZXRBY3Rp\nb24oYWN0aW9uKSk7CiAgICAgICAgYWN0aW9uID0gYXR0cnMuZ2V0VmFsdWUo\nImRlbGV0ZS1hY3Rpb24iKTsKICAgICAgICBpZiAoYWN0aW9uICE9IG51bGwp\nCiAgICAgICAgICAgIF9may5may5zZXREZWxldGVBY3Rpb24oRm9yZWlnbktl\neS5nZXRBY3Rpb24oYWN0aW9uKSk7CgogICAgICAgIF9may50b1RhYmxlID0g\nYXR0cnMuZ2V0VmFsdWUoInRvLXRhYmxlIik7CiAgICAgICAgU3RyaW5nIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4iKTsKICAgICAgICBpZiAodmFs\nICE9IG51bGwpCiAgICAgICAgICAgIF9may5jb2xzLmFkZCh2YWwpOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBlbmRGb3JlaWduS2V5KCkgewogICAgICAg\nIF9ma0luZm9zLmFkZChfZmspOwogICAgICAgIF9mayA9IG51bGw7CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIHN0YXJ0T24oQXR0cmlidXRlcyBhdHRycykg\newogICAgICAgIFN0cmluZyBjb2wgPSBhdHRycy5nZXRWYWx1ZSgiY29sdW1u\nIik7CiAgICAgICAgaWYgKF9wayAhPSBudWxsKQogICAgICAgICAgICBfcGsu\nY29scy5hZGQoY29sKTsKICAgICAgICBlbHNlIGlmIChfaW5kZXggIT0gbnVs\nbCkKICAgICAgICAgICAgX2luZGV4LmNvbHMuYWRkKGNvbCk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBfdW5xLmNvbHMuYWRkKGNvbCk7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIHN0YXJ0Sm9pbihBdHRyaWJ1dGVzIGF0dHJzKSB7\nCiAgICAgICAgU3RyaW5nIGNvbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4i\nKTsKICAgICAgICBTdHJpbmcgdG9Db2wgPSBhdHRycy5nZXRWYWx1ZSgidG8t\nY29sdW1uIik7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJ2YWx1ZSIpOwogICAgICAgIGlmICh2YWwgPT0gbnVsbCkgewogICAgICAg\nICAgICBfZmsuY29scy5hZGQoY29sKTsKICAgICAgICAgICAgX2ZrLnBrcy5h\nZGQodG9Db2wpOwogICAgICAgIH0gZWxzZSBpZiAoY29sID09IG51bGwpIHsK\nICAgICAgICAgICAgX2ZrLmNvbnN0c1BLLmFkZChjb252ZXJ0Q29uc3RhbnQo\ndmFsKSk7CiAgICAgICAgICAgIF9may5jb25zdENvbHNQSy5hZGQodG9Db2wp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9may5jb25zdHMuYWRk\nKGNvbnZlcnRDb25zdGFudCh2YWwpKTsKICAgICAgICAgICAgX2ZrLmNvbnN0\nQ29scy5hZGQoY29sKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBz\ndGF0aWMgT2JqZWN0IGNvbnZlcnRDb25zdGFudChTdHJpbmcgdmFsKSB7CiAg\nICAgICAgaWYgKCJudWxsIi5lcXVhbHModmFsKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgaWYgKHZhbC5zdGFydHNXaXRoKCInIikpCiAg\nICAgICAgICAgIHJldHVybiB2YWwuc3Vic3RyaW5nKDEsIHZhbC5sZW5ndGgo\nKSAtIDEpOwogICAgICAgIGlmICh2YWwuaW5kZXhPZignLicpID09IC0xKQog\nICAgICAgICAgICByZXR1cm4gbmV3IExvbmcodmFsKTsKICAgICAgICByZXR1\ncm4gbmV3IERvdWJsZSh2YWwpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB0\naHJvd1VzZXJFeGNlcHRpb24oTWVzc2FnZSBtc2cpIHsKICAgICAgICB0aHJv\ndyBuZXcgVXNlckV4Y2VwdGlvbihnZXRTb3VyY2VOYW1lKCkgKyAiOiAiICsg\nbXNnLmdldE1lc3NhZ2UoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2Vk\nIHRvIGhvbGQgcHJpbWFyeSBrZXkgaW5mbyBiZWZvcmUgaXQgaXMgcmVzb2x2\nZWQuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFByaW1hcnlL\nZXlJbmZvIHsKCiAgICAgICAgcHVibGljIFByaW1hcnlLZXkgcGsgPSBudWxs\nOwogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGNvbHMgPSBuZXcgTGlua2Vk\nTGlzdCgpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlZCB0byBob2xkIGlu\nZGV4IGluZm8gYmVmb3JlIGl0IGlzIHJlc29sdmVkLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBjbGFzcyBJbmRleEluZm8gewoKICAgICAgICBwdWJs\naWMgSW5kZXggaW5kZXggPSBudWxsOwogICAgICAgIHB1YmxpYyBDb2xsZWN0\naW9uIGNvbHMgPSBuZXcgTGlua2VkTGlzdCgpOwogICAgfQoKICAgIC8qKgog\nICAgICogVXNlZCB0byBob2xkIHVuaXF1ZSBjb25zdHJhaW50IGluZm8gYmVm\nb3JlIGl0IGlzIHJlc29sdmVkLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBjbGFzcyBVbmlxdWVJbmZvIHsKCiAgICAgICAgcHVibGljIFVuaXF1ZSB1\nbnEgPSBudWxsOwogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGNvbHMgPSBu\nZXcgTGlua2VkTGlzdCgpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlZCB0\nbyBob2xkIGZvcmVpZ24ga2V5IGluZm8gYmVmb3JlIGl0IGlzIHJlc29sdmVk\nLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBGb3JlaWduS2V5\nSW5mbyB7CgogICAgICAgIHB1YmxpYyBGb3JlaWduS2V5IGZrID0gbnVsbDsK\nICAgICAgICBwdWJsaWMgU3RyaW5nIHRvVGFibGUgPSBudWxsOwogICAgICAg\nIHB1YmxpYyBDb2xsZWN0aW9uIGNvbHMgPSBuZXcgTGlua2VkTGlzdCgpOwog\nICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIHBrcyA9IG5ldyBMaW5rZWRMaXN0\nKCk7CiAgICAgICAgcHVibGljIENvbGxlY3Rpb24gY29uc3RzID0gbmV3IExp\nbmtlZExpc3QoKTsKICAgICAgICBwdWJsaWMgQ29sbGVjdGlvbiBjb25zdENv\nbHMgPSBuZXcgTGlua2VkTGlzdCgpOwogICAgICAgIHB1YmxpYyBDb2xsZWN0\naW9uIGNvbnN0c1BLID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAgICBwdWJs\naWMgQ29sbGVjdGlvbiBjb25zdENvbHNQSyA9IG5ldyBMaW5rZWRMaXN0KCk7\nCiAgICB9Cn0K\n","encoding":"base64"}

