{"sha":"f8a761bdbe1baec0e1462fd4607a9dbb32adba1d","node_id":"MDQ6QmxvYjIwNjM2NDpmOGE3NjFiZGJlMWJhZWMwZTE0NjJmZDQ2MDdhOWRiYjMyYWRiYTFk","size":13633,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f8a761bdbe1baec0e1462fd4607a9dbb32adba1d","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYTsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlM\naXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZh\nLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1w\nb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlRy\nZWVTZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5n\nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpE\nQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5tZXRhLlhNTE1ldGFEYXRhU2VyaWFsaXplcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcueG1s\nLnNheC5TQVhFeGNlcHRpb247CgovKioKICogU2VyaWFsaXplcyB7QGxpbmsg\nU2NoZW1hfXMgdG8gWE1MIG1hdGNoaW5nIHRoZSBkb2N1bWVudAogKiB0eXBl\nIGRlZmluaXRpb24gZGVmaW5lZCBieSB0aGUge0BsaW5rIFhNTFNjaGVtYVBh\ncnNlcn0uIFRoZSBzZXJpYWxpemVyCiAqIGFjdHVhbGx5IHdvcmtzIGF0IHRo\nZSBmaW5lLWdyYWluZWQgdGFibGUgbGV2ZWwgdG8gYWxsb3cgeW91IHRvIHNw\nbGl0CiAqIHNjaGVtYXMgYW1vbmcgbXVsdGlwbGUgZmlsZXMuCiAqICBTZXJp\nYWxpemVycyBhcmUgbm90IHRocmVhZCBzYWZlLgogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgWE1MU2No\nZW1hU2VyaWFsaXplcgogICAgZXh0ZW5kcyBYTUxNZXRhRGF0YVNlcmlhbGl6\nZXIKICAgIGltcGxlbWVudHMgU2NoZW1hU2VyaWFsaXplciB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZQogICAgICAgIChYTUxTY2hlbWFTZXJpYWxpemVyLmNsYXNz\nKTsKCiAgICBwcml2YXRlIGZpbmFsIENvbGxlY3Rpb24gX3RhYmxlcyA9IG5l\ndyBUcmVlU2V0KCk7CiAgICBwcml2YXRlIGZpbmFsIENvbGxlY3Rpb24gX3Nl\ncXMgPSBuZXcgVHJlZVNldCgpOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0\nb3IuIFN1cHBseSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMg\nWE1MU2NoZW1hU2VyaWFsaXplcihKREJDQ29uZmlndXJhdGlvbiBjb25mKSB7\nCiAgICAgICAgc2V0TG9nKGNvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9u\nLkxPR19TQ0hFTUEpKTsKICAgIH0KCiAgICBwdWJsaWMgVGFibGVbXSBnZXRU\nYWJsZXMoKSB7CiAgICAgICAgcmV0dXJuIChUYWJsZVtdKSBfdGFibGVzLnRv\nQXJyYXkobmV3IFRhYmxlW190YWJsZXMuc2l6ZSgpXSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgYWRkVGFibGUoVGFibGUgdGFibGUpIHsKICAgICAgICBp\nZiAodGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgX3RhYmxlcy5hZGQodGFi\nbGUpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZVRhYmxlKFRh\nYmxlIHRhYmxlKSB7CiAgICAgICAgcmV0dXJuIF90YWJsZXMucmVtb3ZlKHRh\nYmxlKTsKICAgIH0KCiAgICBwdWJsaWMgU2VxdWVuY2VbXSBnZXRTZXF1ZW5j\nZXMoKSB7CiAgICAgICAgcmV0dXJuIChTZXF1ZW5jZVtdKSBfc2Vxcy50b0Fy\ncmF5KG5ldyBTZXF1ZW5jZVtfc2Vxcy5zaXplKCldKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBhZGRTZXF1ZW5jZShTZXF1ZW5jZSBzZXEpIHsKICAgICAg\nICBpZiAoc2VxICE9IG51bGwpCiAgICAgICAgICAgIF9zZXFzLmFkZChzZXEp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZVNlcXVlbmNlKFNl\ncXVlbmNlIHNlcSkgewogICAgICAgIHJldHVybiBfc2Vxcy5yZW1vdmUoc2Vx\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRBbGwoU2NoZW1hIHNjaGVt\nYSkgewogICAgICAgIGlmIChzY2hlbWEgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIFRhYmxlW10gdGFibGVzID0gc2NoZW1hLmdldFRh\nYmxlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdGFibGVzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICBhZGRUYWJsZSh0YWJsZXNbaV0pOwog\nICAgICAgIFNlcXVlbmNlW10gc2VxcyA9IHNjaGVtYS5nZXRTZXF1ZW5jZXMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlcXMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIGFkZFNlcXVlbmNlKHNlcXNbaV0pOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGFkZEFsbChTY2hlbWFHcm91cCBncm91cCkgewog\nICAgICAgIGlmIChncm91cCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVtYXMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIGFkZEFsbChzY2hlbWFzW2ldKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVBbGwoU2NoZW1hIHNjaGVtYSkg\newogICAgICAgIGlmIChzY2hlbWEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwoKICAgICAgICBib29sZWFuIHJlbW92ZWQgPSBmYWxzZTsK\nICAgICAgICBUYWJsZVtdIHRhYmxlcyA9IHNjaGVtYS5nZXRUYWJsZXMoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHRhYmxlcy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgcmVtb3ZlZCB8PSByZW1vdmVUYWJsZSh0YWJsZXNb\naV0pOwogICAgICAgIFNlcXVlbmNlW10gc2VxcyA9IHNjaGVtYS5nZXRTZXF1\nZW5jZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlcXMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZWQgfD0gcmVtb3ZlU2VxdWVu\nY2Uoc2Vxc1tpXSk7CiAgICAgICAgcmV0dXJuIHJlbW92ZWQ7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlQWxsKFNjaGVtYUdyb3VwIGdyb3Vw\nKSB7CiAgICAgICAgaWYgKGdyb3VwID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKCiAgICAgICAgYm9vbGVhbiByZW1vdmVkID0gZmFsc2U7\nCiAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVtYXMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIHJlbW92ZWQgfD0gcmVtb3ZlQWxsKHNjaGVt\nYXNbaV0pOwogICAgICAgIHJldHVybiByZW1vdmVkOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGNsZWFyKCkgewogICAgICAgIF90YWJsZXMuY2xlYXIoKTsK\nICAgICAgICBfc2Vxcy5jbGVhcigpOwogICAgfQoKICAgIHByb3RlY3RlZCBD\nb2xsZWN0aW9uIGdldE9iamVjdHMoKSB7CiAgICAgICAgaWYgKF9zZXFzLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIF90YWJsZXM7CiAgICAgICAg\naWYgKF90YWJsZXMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gX3Nl\ncXM7CiAgICAgICAgTGlzdCBhbGwgPSBuZXcgQXJyYXlMaXN0KF9zZXFzLnNp\nemUoKSArIF90YWJsZXMuc2l6ZSgpKTsKICAgICAgICBhbGwuYWRkQWxsKF9z\nZXFzKTsKICAgICAgICBhbGwuYWRkQWxsKF90YWJsZXMpOwogICAgICAgIHJl\ndHVybiBhbGw7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgc2VyaWFsaXpl\nKENvbGxlY3Rpb24gb2JqcykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICAvLyBncm91cCB0aGUgb2JqZWN0cyBieSBzY2hlbWEKICAg\nICAgICBNYXAgc2NoZW1hcyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgU3Ry\naW5nIHNjaGVtYU5hbWU7CiAgICAgICAgQ29sbGVjdGlvbiBzY2hlbWFPYmpz\nOwogICAgICAgIE9iamVjdCBvYmo7CiAgICAgICAgZm9yIChJdGVyYXRvciBp\ndHIgPSBvYmpzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgIG9iaiA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChvYmog\naW5zdGFuY2VvZiBUYWJsZSkKICAgICAgICAgICAgICAgIHNjaGVtYU5hbWUg\nPSAoKFRhYmxlKSBvYmopLmdldFNjaGVtYU5hbWUoKTsKICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgc2NoZW1hTmFtZSA9ICgoU2VxdWVuY2Up\nIG9iaikuZ2V0U2NoZW1hTmFtZSgpOwogICAgICAgICAgICBzY2hlbWFPYmpz\nID0gKENvbGxlY3Rpb24pIHNjaGVtYXMuZ2V0KHNjaGVtYU5hbWUpOwogICAg\nICAgICAgICBpZiAoc2NoZW1hT2JqcyA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBzY2hlbWFPYmpzID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAgICAg\nICAgICAgIHNjaGVtYXMucHV0KHNjaGVtYU5hbWUsIHNjaGVtYU9ianMpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHNjaGVtYU9ianMuYWRkKG9iaik7\nCiAgICAgICAgfQoKICAgICAgICBzdGFydEVsZW1lbnQoInNjaGVtYXMiKTsK\nICAgICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSBzY2hlbWFzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFwLkVudHJ5KSBp\ndHIubmV4dCgpOwogICAgICAgICAgICBzZXJpYWxpemVTY2hlbWEoKFN0cmlu\nZykgZW50cnkuZ2V0S2V5KCksIChDb2xsZWN0aW9uKQogICAgICAgICAgICAg\nICAgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgfQogICAgICAgIGVuZEVs\nZW1lbnQoInNjaGVtYXMiKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlh\nbGl6ZXMgdGhlIGdpdmVuIG9iamVjdHMgdG9nZXRoZXIgaW50byB0aGUgY3Vy\ncmVudCBzY2hlbWEuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXJpYWxp\nemVTY2hlbWEoU3RyaW5nIG5hbWUsIENvbGxlY3Rpb24gb2JqcykKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAob2Jqcy5pc0Vt\ncHR5KCkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgaWYgKGdldExv\nZygpLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGdldExvZygpLnRy\nYWNlKF9sb2MuZ2V0KCJzZXItc2NoZW1hIiwgbmFtZSkpOwoKICAgICAgICBp\nZiAobmFtZSAhPSBudWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoIm5h\nbWUiLCBuYW1lKTsKICAgICAgICBzdGFydEVsZW1lbnQoInNjaGVtYSIpOwoK\nICAgICAgICAvLyB0YWJsZXMgYW5kIHNlcXMKICAgICAgICBPYmplY3Qgb2Jq\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gb2Jqcy5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBvYmogPSBpdHIubmV4\ndCgpOwogICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgVGFibGUpCiAg\nICAgICAgICAgICAgICBzZXJpYWxpemVUYWJsZSgoVGFibGUpIG9iaik7CiAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHNlcmlhbGl6ZVNlcXVl\nbmNlKChTZXF1ZW5jZSkgb2JqKTsKICAgICAgICB9CgogICAgICAgIGVuZEVs\nZW1lbnQoInNjaGVtYSIpOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFs\naXplIHRoZSBnaXZlbiBzZXF1ZW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIHNlcmlhbGl6ZVNlcXVlbmNlKFNlcXVlbmNlIHNlcSkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBhZGRBdHRyaWJ1dGUoIm5h\nbWUiLCBzZXEuZ2V0TmFtZSgpKTsKICAgICAgICBpZiAoc2VxLmdldEluaXRp\nYWxWYWx1ZSgpICE9IDEpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiaW5p\ndGlhbC12YWx1ZSIsCiAgICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihz\nZXEuZ2V0SW5pdGlhbFZhbHVlKCkpKTsKICAgICAgICBpZiAoc2VxLmdldElu\nY3JlbWVudCgpID4gMSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJpbmNy\nZW1lbnQiLCBTdHJpbmcudmFsdWVPZihzZXEuZ2V0SW5jcmVtZW50KCkpKTsK\nICAgICAgICBpZiAoc2VxLmdldEFsbG9jYXRlKCkgPiAxKQogICAgICAgICAg\nICBhZGRBdHRyaWJ1dGUoImFsbG9jYXRlIiwgU3RyaW5nLnZhbHVlT2Yoc2Vx\nLmdldEFsbG9jYXRlKCkpKTsKICAgICAgICBzdGFydEVsZW1lbnQoInNlcXVl\nbmNlIik7CiAgICAgICAgZW5kRWxlbWVudCgic2VxdWVuY2UiKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIHRhYmxlLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplVGFibGUoVGFibGUg\ndGFibGUpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nYWRkQXR0cmlidXRlKCJuYW1lIiwgdGFibGUuZ2V0TmFtZSgpKTsKICAgICAg\nICBzdGFydEVsZW1lbnQoInRhYmxlIik7CgogICAgICAgIC8vIHByaW1hcnkg\na2V5CiAgICAgICAgUHJpbWFyeUtleSBwayA9IHRhYmxlLmdldFByaW1hcnlL\nZXkoKTsKICAgICAgICBpZiAocGsgIT0gbnVsbCkKICAgICAgICAgICAgc2Vy\naWFsaXplUHJpbWFyeUtleShwayk7CgogICAgICAgIC8vIGNvbHVtbnMKICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gdGFibGUuZ2V0Q29sdW1ucygpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgc2VyaWFsaXplQ29sdW1uKGNvbHNbaV0pOwoKICAgICAgICAv\nLyBmb3JlaWduIGtleXMKICAgICAgICBGb3JlaWduS2V5W10gZmtzID0gdGFi\nbGUuZ2V0Rm9yZWlnbktleXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGZrcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgc2VyaWFsaXplRm9y\nZWlnbktleShma3NbaV0pOwoKICAgICAgICAvLyBpbmRleGVzCiAgICAgICAg\nSW5kZXhbXSBpZHhzID0gdGFibGUuZ2V0SW5kZXhlcygpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgaWR4cy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgc2VyaWFsaXplSW5kZXgoaWR4c1tpXSk7CgogICAgICAgIC8vIHVuaXF1\nZSBjb25zdHJhaW50cwogICAgICAgIFVuaXF1ZVtdIHVucXMgPSB0YWJsZS5n\nZXRVbmlxdWVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZXJpYWxpemVVbmlxdWUodW5x\nc1tpXSk7CgogICAgICAgIGVuZEVsZW1lbnQoInRhYmxlIik7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBjb2x1bW4uCiAg\nICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXJpYWxpemVDb2x1bW4oQ29sdW1u\nIGNvbCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBh\nZGRBdHRyaWJ1dGUoIm5hbWUiLCBjb2wuZ2V0TmFtZSgpKTsKICAgICAgICBh\nZGRBdHRyaWJ1dGUoInR5cGUiLCBTY2hlbWFzLmdldEpEQkNOYW1lKGNvbC5n\nZXRUeXBlKCkpKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHko\nY29sLmdldFR5cGVOYW1lKCkpCiAgICAgICAgICAgICYmICFjb2wuZ2V0VHlw\nZU5hbWUoKS5lcXVhbHNJZ25vcmVDYXNlCiAgICAgICAgICAgIChTY2hlbWFz\nLmdldEpEQkNOYW1lKGNvbC5nZXRUeXBlKCkpKSkKICAgICAgICAgICAgYWRk\nQXR0cmlidXRlKCJ0eXBlLW5hbWUiLCBjb2wuZ2V0VHlwZU5hbWUoKSk7CiAg\nICAgICAgaWYgKGNvbC5pc05vdE51bGwoKSkKICAgICAgICAgICAgYWRkQXR0\ncmlidXRlKCJub3QtbnVsbCIsICJ0cnVlIik7CiAgICAgICAgaWYgKGNvbC5p\nc0F1dG9Bc3NpZ25lZCgpKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImF1\ndG8tYXNzaWduIiwgInRydWUiKTsKICAgICAgICBpZiAoY29sLmdldERlZmF1\nbHRTdHJpbmcoKSAhPSBudWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUo\nImRlZmF1bHQiLCBjb2wuZ2V0RGVmYXVsdFN0cmluZygpKTsKICAgICAgICBp\nZiAoY29sLmdldFNpemUoKSAhPSAwKQogICAgICAgICAgICBhZGRBdHRyaWJ1\ndGUoInNpemUiLCBTdHJpbmcudmFsdWVPZihjb2wuZ2V0U2l6ZSgpKSk7CiAg\nICAgICAgaWYgKGNvbC5nZXREZWNpbWFsRGlnaXRzKCkgIT0gMCkKICAgICAg\nICAgICAgYWRkQXR0cmlidXRlKCJkZWNpbWFsLWRpZ2l0cyIsIFN0cmluZy52\nYWx1ZU9mCiAgICAgICAgICAgICAgICAoY29sLmdldERlY2ltYWxEaWdpdHMo\nKSkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgiY29sdW1uIik7CiAgICAgICAg\nZW5kRWxlbWVudCgiY29sdW1uIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nZXJpYWxpemVzIHRoZSBnaXZlbiBwcmltYXJ5IGtleS4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZVByaW1hcnlLZXkoUHJpbWFyeUtleSBw\naykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ncGsuZ2V0TmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0\nZSgibmFtZSIsIHBrLmdldE5hbWUoKSk7CiAgICAgICAgaWYgKHBrLmlzTG9n\naWNhbCgpKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImxvZ2ljYWwiLCAi\ndHJ1ZSIpOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0gcGsuZ2V0Q29sdW1u\ncygpOwogICAgICAgIGlmIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAg\nICBhZGRBdHRyaWJ1dGUoImNvbHVtbiIsIGNvbHNbMF0uZ2V0TmFtZSgpKTsK\nICAgICAgICBzdGFydEVsZW1lbnQoInBrIik7CgogICAgICAgIC8vIGNvbHVt\nbnMKICAgICAgICBpZiAoY29scy5sZW5ndGggPiAxKQogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgICAgICBzZXJpYWxpemVPbihjb2xzW2ldKTsKCiAgICAgICAgZW5kRWxl\nbWVudCgicGsiKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZXMg\ndGhlIGdpdmVuIGluZGV4LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2Vy\naWFsaXplSW5kZXgoSW5kZXggaWR4KQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIGFkZEF0dHJpYnV0ZSgibmFtZSIsIGlkeC5nZXRO\nYW1lKCkpOwogICAgICAgIGlmIChpZHguaXNVbmlxdWUoKSkKICAgICAgICAg\nICAgYWRkQXR0cmlidXRlKCJ1bmlxdWUiLCAidHJ1ZSIpOwogICAgICAgIENv\nbHVtbltdIGNvbHMgPSBpZHguZ2V0Q29sdW1ucygpOwogICAgICAgIGlmIChj\nb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImNv\nbHVtbiIsIGNvbHNbMF0uZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVsZW1l\nbnQoImluZGV4Iik7CgogICAgICAgIC8vIGNvbHVtbnMKICAgICAgICBpZiAo\nY29scy5sZW5ndGggPiAxKQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBzZXJpYWxp\nemVPbihjb2xzW2ldKTsKCiAgICAgICAgZW5kRWxlbWVudCgiaW5kZXgiKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIGNv\nbnN0cmFpbnQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXJpYWxpemVV\nbmlxdWUoVW5pcXVlIHVucSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAodW5xLmdldE5hbWUoKSAhPSBudWxsKQogICAgICAg\nICAgICBhZGRBdHRyaWJ1dGUoIm5hbWUiLCB1bnEuZ2V0TmFtZSgpKTsKICAg\nICAgICBpZiAodW5xLmlzRGVmZXJyZWQoKSkKICAgICAgICAgICAgYWRkQXR0\ncmlidXRlKCJkZWZlcnJlZCIsICJ0cnVlIik7CiAgICAgICAgQ29sdW1uW10g\nY29scyA9IHVucS5nZXRDb2x1bW5zKCk7CiAgICAgICAgaWYgKGNvbHMubGVu\nZ3RoID09IDEpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiY29sdW1uIiwg\nY29sc1swXS5nZXROYW1lKCkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgidW5p\ncXVlIik7CgogICAgICAgIC8vIGNvbHVtbnMKICAgICAgICBpZiAoY29scy5s\nZW5ndGggPiAxKQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNv\nbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBzZXJpYWxpemVPbihj\nb2xzW2ldKTsKCiAgICAgICAgZW5kRWxlbWVudCgidW5pcXVlIik7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBmb3JlaWdu\nIGtleS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZUZvcmVp\nZ25LZXkoRm9yZWlnbktleSBmaykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoZmsuZ2V0TmFtZSgpICE9IG51bGwpCiAgICAg\nICAgICAgIGFkZEF0dHJpYnV0ZSgibmFtZSIsIGZrLmdldE5hbWUoKSk7Cgog\nICAgICAgIGlmIChmay5pc0RlZmVycmVkKCkpCiAgICAgICAgICAgIGFkZEF0\ndHJpYnV0ZSgiZGVmZXJyZWQiLCAidHJ1ZSIpOwoKICAgICAgICBpZiAoZmsu\nZ2V0RGVsZXRlQWN0aW9uKCkgIT0gRm9yZWlnbktleS5BQ1RJT05fTk9ORSkK\nICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJkZWxldGUtYWN0aW9uIiwgRm9y\nZWlnbktleS5nZXRBY3Rpb25OYW1lCiAgICAgICAgICAgICAgICAoZmsuZ2V0\nRGVsZXRlQWN0aW9uKCkpKTsKICAgICAgICBpZiAoZmsuZ2V0VXBkYXRlQWN0\naW9uKCkgIT0gRm9yZWlnbktleS5BQ1RJT05fTk9ORQogICAgICAgICAgICAm\nJiBmay5nZXRVcGRhdGVBY3Rpb24oKSAhPSBGb3JlaWduS2V5LkFDVElPTl9S\nRVNUUklDVCkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJ1cGRhdGUtYWN0\naW9uIiwgRm9yZWlnbktleS5nZXRBY3Rpb25OYW1lCiAgICAgICAgICAgICAg\nICAoZmsuZ2V0VXBkYXRlQWN0aW9uKCkpKTsKCiAgICAgICAgQ29sdW1uW10g\nY29scyA9IGZrLmdldENvbHVtbnMoKTsKICAgICAgICBDb2x1bW5bXSBwa3Mg\nPSBmay5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIENvbHVtbltd\nIGNvbnN0cyA9IGZrLmdldENvbnN0YW50Q29sdW1ucygpOwogICAgICAgIENv\nbHVtbltdIGNvbnN0c1BLID0gZmsuZ2V0Q29uc3RhbnRQcmltYXJ5S2V5Q29s\ndW1ucygpOwogICAgICAgIGFkZEF0dHJpYnV0ZSgidG8tdGFibGUiLCBmay5n\nZXRQcmltYXJ5S2V5VGFibGUoKS5nZXRGdWxsTmFtZSgpKTsKICAgICAgICBp\nZiAoY29scy5sZW5ndGggPT0gMSAmJiBjb25zdHMubGVuZ3RoID09IDAgJiYg\nY29uc3RzUEsubGVuZ3RoID09IDApCiAgICAgICAgICAgIGFkZEF0dHJpYnV0\nZSgiY29sdW1uIiwgY29sc1swXS5nZXROYW1lKCkpOwogICAgICAgIHN0YXJ0\nRWxlbWVudCgiZmsiKTsKCiAgICAgICAgLy8gY29sdW1ucwogICAgICAgIGlm\nIChjb2xzLmxlbmd0aCA+IDEgfHwgY29uc3RzLmxlbmd0aCA+IDAgfHwgY29u\nc3RzUEsubGVuZ3RoID4gMCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgc2VyaWFs\naXplSm9pbihjb2xzW2ldLCBwa3NbaV0pOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29uc3RzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZXJp\nYWxpemVKb2luKGNvbnN0c1tpXSwgZmsuZ2V0Q29uc3RhbnQoY29uc3RzW2ld\nKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb25zdHNQSy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgc2VyaWFsaXplSm9pbihmay5nZXRQcmlt\nYXJ5S2V5Q29uc3RhbnQoY29uc3RzUEtbaV0pLCBjb25zdHNQS1tpXSk7Cgog\nICAgICAgIGVuZEVsZW1lbnQoImZrIik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBjb2x1bW4gdG8gYW4gJ29uJyBlbGVt\nZW50LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplT24oQ29s\ndW1uIGNvbCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBhZGRBdHRyaWJ1dGUoImNvbHVtbiIsIGNvbC5nZXROYW1lKCkpOwogICAg\nICAgIHN0YXJ0RWxlbWVudCgib24iKTsKICAgICAgICBlbmRFbGVtZW50KCJv\nbiIpOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplcyB0aGUgZ2l2\nZW4gY29sdW1ucyB0byBhICdqb2luJyBlbGVtZW50LgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgc2VyaWFsaXplSm9pbihDb2x1bW4gY29sLCBDb2x1bW4g\ncGspCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYWRk\nQXR0cmlidXRlKCJjb2x1bW4iLCBjb2wuZ2V0TmFtZSgpKTsKICAgICAgICBh\nZGRBdHRyaWJ1dGUoInRvLWNvbHVtbiIsIHBrLmdldE5hbWUoKSk7CiAgICAg\nICAgc3RhcnRFbGVtZW50KCJqb2luIik7CiAgICAgICAgZW5kRWxlbWVudCgi\nam9pbiIpOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplcyB0aGUg\nZ2l2ZW4gdmFsdWVzIHRvIGEgJ2pvaW4nIGVsZW1lbnQuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBzZXJpYWxpemVKb2luKE9iamVjdCB2YWwsIENvbHVt\nbiBwaykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBh\nZGRBdHRyaWJ1dGUoInZhbHVlIiwgc3RyaW5naWZ5Q29uc3RhbnQodmFsKSk7\nCiAgICAgICAgYWRkQXR0cmlidXRlKCJ0by1jb2x1bW4iLCBway5nZXROYW1l\nKCkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgiam9pbiIpOwogICAgICAgIGVu\nZEVsZW1lbnQoImpvaW4iKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlh\nbGl6ZXMgdGhlIGdpdmVuIHZhbHVlcyB0byBhICdqb2luJyBlbGVtZW50Lgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplSm9pbihDb2x1bW4g\nY29sLCBPYmplY3QgdmFsKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIGFkZEF0dHJpYnV0ZSgiY29sdW1uIiwgY29sLmdldE5hbWUo\nKSk7CiAgICAgICAgYWRkQXR0cmlidXRlKCJ2YWx1ZSIsIHN0cmluZ2lmeUNv\nbnN0YW50KHZhbCkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgiam9pbiIpOwog\nICAgICAgIGVuZEVsZW1lbnQoImpvaW4iKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFN0cmluZ2lmeSB0aGUgZ2l2ZW4gY29uc3RhbnQgdmFsdWUuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBzdHJpbmdpZnlDb25zdGFu\ndChPYmplY3QgdmFsKSB7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gIm51bGwiOwogICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBTdHJpbmcpCiAgICAgICAgICAgIHJldHVybiAiJyIgKyB2YWwgKyAi\nJyI7CiAgICAgICAgcmV0dXJuIHZhbC50b1N0cmluZygpOwogICAgfQp9Cg==\n","encoding":"base64"}

