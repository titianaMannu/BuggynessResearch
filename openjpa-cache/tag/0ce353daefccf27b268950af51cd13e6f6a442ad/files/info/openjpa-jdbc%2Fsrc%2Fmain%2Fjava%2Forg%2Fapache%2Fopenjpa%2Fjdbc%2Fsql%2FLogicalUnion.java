{"sha":"12d6fdb0044b0c81fd1a4da476916a270f302483","node_id":"MDQ6QmxvYjIwNjM2NDoxMmQ2ZmRiMDA0NGIwYzgxZmQxYTRkYTQ3NjkxNmEyNzBmMzAyNDgz","size":26888,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/12d6fdb0044b0c81fd1a4da476916a270f302483","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuQml0U2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSXRl\ncmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENv\nbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5r\nZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5tZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVuc3VwcG9ydGVkRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlv\nbjsKCi8qKgogKiBBIGxvZ2ljYWwgdW5pb24gbWFkZSB1cCBvZiBtdWx0aXBs\nZSBkaXN0aW5jdCBzZWxlY3RzIHdob3NlIHJlc3VsdHMgYXJlCiAqIGNvbWJp\nbmVkIGluIG1lbW9yeS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1\nYmxpYyBjbGFzcyBMb2dpY2FsVW5pb24KICAgIGltcGxlbWVudHMgVW5pb24g\newoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0g\nTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoTG9naWNhbFVuaW9uLmNs\nYXNzKTsKCiAgICBwcm90ZWN0ZWQgZmluYWwgVW5pb25TZWxlY3RbXSBzZWxz\nOwogICAgcHJvdGVjdGVkIGZpbmFsIERCRGljdGlvbmFyeSBkaWN0OwogICAg\ncHJvdGVjdGVkIGZpbmFsIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzOwogICAg\ncHJvdGVjdGVkIGZpbmFsIEJpdFNldCBkZXNjID0gbmV3IEJpdFNldCgpOwog\nICAgcHJpdmF0ZSBib29sZWFuIF9kaXN0aW5jdCA9IHRydWU7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX3NpbmdsZSA9IGZhbHNlOwoKICAgIC8qKgogICAgICog\nQ29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIGNvbmYgc3lzdGVt\nIGNvbmZpZ3VyYXRpb24KICAgICAqIEBwYXJhbSBzZWxzIHRoZSBudW1iZXIg\nb2YgU1FMIHNlbGVjdHMgdG8gdW5pb24gdG9nZXRoZXIKICAgICAqLwogICAg\ncHVibGljIExvZ2ljYWxVbmlvbihKREJDQ29uZmlndXJhdGlvbiBjb25mLCBp\nbnQgc2VscykgewogICAgICAgIHRoaXMoY29uZiwgc2VscywgbnVsbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RvciB1c2VkIHRvIHNlZWQg\ndGhlIGludGVybmFsIHNlbGVjdHMuCiAgICAgKi8KICAgIHB1YmxpYyBMb2dp\nY2FsVW5pb24oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgU2VsZWN0W10gc2Vl\nZHMpIHsKICAgICAgICB0aGlzKGNvbmYsIHNlZWRzLmxlbmd0aCwgc2VlZHMp\nOwogICAgfQoKICAgIC8qKgogICAgICogRGVsZWdhdGUgY29uc3RydWN0b3Iu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBMb2dpY2FsVW5pb24oSkRCQ0NvbmZp\nZ3VyYXRpb24gY29uZiwgaW50IHNlbHMsIFNlbGVjdFtdIHNlZWRzKSB7CiAg\nICAgICAgaWYgKHNlbHMgPT0gMCkKICAgICAgICAgICAgdGhyb3cgbmV3IElu\ndGVybmFsRXhjZXB0aW9uKCJzZWxzID09IDAiKTsKCiAgICAgICAgZGljdCA9\nIGNvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBtYXBw\naW5ncyA9IG5ldyBDbGFzc01hcHBpbmdbc2Vsc107CiAgICAgICAgdGhpcy5z\nZWxzID0gbmV3IFVuaW9uU2VsZWN0W3NlbHNdOwoKICAgICAgICBTZWxlY3RJ\nbXBsIHNlZWQ7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxzOyBp\nKyspIHsKICAgICAgICAgICAgc2VlZCA9IChzZWVkcyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgPyAoU2VsZWN0SW1wbCkgY29uZi5nZXRTUUxGYWN0b3J5\nSW5zdGFuY2UoKS5uZXdTZWxlY3QoKQogICAgICAgICAgICAgICAgOiAoU2Vs\nZWN0SW1wbCkgc2VlZHNbaV07CiAgICAgICAgICAgIHRoaXMuc2Vsc1tpXSA9\nIG5ld1VuaW9uU2VsZWN0KHNlZWQsIGkpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyB1bmlvbiBzZWxlY3Qgd2l0aCB0\naGUgZ2l2ZW4gZGVsZWdhdGUgYW5kIHVuaW9uIHBvc2l0aW9uLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgVW5pb25TZWxlY3QgbmV3VW5pb25TZWxlY3QoU2Vs\nZWN0SW1wbCBzZWVkLCBpbnQgcG9zKSB7CiAgICAgICAgcmV0dXJuIG5ldyBV\nbmlvblNlbGVjdChzZWVkLCBwb3MpOwogICAgfQoKICAgIHB1YmxpYyBTZWxl\nY3RbXSBnZXRTZWxlY3RzKCkgewogICAgICAgIHJldHVybiBzZWxzOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU2luZ2xlUmVzdWx0KCkgewogICAg\nICAgIHJldHVybiBfc2luZ2xlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndFNpbmdsZVJlc3VsdChib29sZWFuIHNpbmdsZSkgewogICAgICAgIF9zaW5n\nbGUgPSBzaW5nbGU7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNVbmlv\nbigpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgYWJvcnRVbmlvbigpIHsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5n\nIGdldE9yZGVyaW5nKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoK\nICAgIHB1YmxpYyBKREJDQ29uZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9u\nKCkgewogICAgICAgIHJldHVybiBzZWxzWzBdLmdldENvbmZpZ3VyYXRpb24o\nKTsKICAgIH0KCiAgICBwdWJsaWMgREJEaWN0aW9uYXJ5IGdldERCRGljdGlv\nbmFyeSgpIHsKICAgICAgICByZXR1cm4gZGljdDsKICAgIH0KCiAgICBwdWJs\naWMgU1FMQnVmZmVyIHRvU2VsZWN0KGJvb2xlYW4gZm9yVXBkYXRlLCBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgcmV0dXJuIGRp\nY3QudG9TZWxlY3Qoc2Vsc1swXSwgZm9yVXBkYXRlLCBmZXRjaCk7CiAgICB9\nCgogICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdENvdW50KCkgewogICAg\nICAgIHJldHVybiBkaWN0LnRvU2VsZWN0Q291bnQoc2Vsc1swXSk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gZ2V0QXV0b0Rpc3RpbmN0KCkgewogICAg\nICAgIHJldHVybiBzZWxzWzBdLmdldEF1dG9EaXN0aW5jdCgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EaXN0aW5jdChib29sZWFuIGRpc3Rp\nbmN0KSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBzZWxzW2ldLnNldEF1dG9EaXN0aW5jdChk\naXN0aW5jdCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEaXN0aW5j\ndCgpIHsKICAgICAgICByZXR1cm4gX2Rpc3RpbmN0OwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldERpc3RpbmN0KGJvb2xlYW4gZGlzdGluY3QpIHsKICAg\nICAgICBfZGlzdGluY3QgPSBkaXN0aW5jdDsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0xSUygpIHsKICAgICAgICByZXR1cm4gc2Vsc1swXS5pc0xS\nUygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExSUyhib29sZWFuIGxy\ncykgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgc2Vsc1tpXS5zZXRMUlMobHJzKTsKICAgIH0K\nCiAgICBwdWJsaWMgaW50IGdldEpvaW5TeW50YXgoKSB7CiAgICAgICAgcmV0\ndXJuIHNlbHNbMF0uZ2V0Sm9pblN5bnRheCgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEpvaW5TeW50YXgoaW50IHN5bnRheCkgewogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgc2Vsc1tpXS5zZXRKb2luU3ludGF4KHN5bnRheCk7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3MoYm9vbGVhbiBm\nb3JVcGRhdGUpIHsKICAgICAgICBpZiAoc2Vscy5sZW5ndGggPT0gMSkKICAg\nICAgICAgICAgcmV0dXJuIHNlbHNbMF0uc3VwcG9ydHNSYW5kb21BY2Nlc3Mo\nZm9yVXBkYXRlKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2NraW5nKCkgewogICAgICAgIGlm\nIChzZWxzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICByZXR1cm4gc2Vsc1sw\nXS5zdXBwb3J0c0xvY2tpbmcoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHNlbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmICghc2Vsc1tp\nXS5zdXBwb3J0c0xvY2tpbmcoKSkKICAgICAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGdldENvdW50KEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpbnQgY291bnQgPSAwOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgY291bnQgKz0gc2Vsc1tpXS5nZXRDb3VudChzdG9yZSk7CiAgICAg\nICAgcmV0dXJuIGNvdW50OwogICAgfQoKICAgIHB1YmxpYyBSZXN1bHQgZXhl\nY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24g\nZmV0Y2gpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKGZldGNoID09IG51bGwpCiAgICAgICAgICAgIGZldGNoID0gc3RvcmUu\nZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgcmV0dXJuIGV4ZWN1\ndGUoc3RvcmUsIGZldGNoLCBmZXRjaC5nZXRSZWFkTG9ja0xldmVsKCkpOwog\nICAgfQoKICAgIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUgc3Rv\ncmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAgICAgICAgaW50\nIGxvY2tMZXZlbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoZmV0Y2ggPT0gbnVsbCkKICAgICAgICAgICAgZmV0Y2ggPSBz\ndG9yZS5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKCiAgICAgICAgaWYgKHNl\nbHMubGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgUmVzdWx0IHJlcyA9IHNl\nbHNbMF0uZXhlY3V0ZShzdG9yZSwgZmV0Y2gsIGxvY2tMZXZlbCk7CiAgICAg\nICAgICAgICgoQWJzdHJhY3RSZXN1bHQpIHJlcykuc2V0QmFzZU1hcHBpbmco\nbWFwcGluZ3NbMF0pOwogICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAg\nIH0KCiAgICAgICAgaWYgKF9zaW5nbGUpIHsKICAgICAgICAgICAgQWJzdHJh\nY3RSZXN1bHQgcmVzOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHNlbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHJlcyA9IChB\nYnN0cmFjdFJlc3VsdCkgc2Vsc1tpXS5leGVjdXRlKHN0b3JlLCBmZXRjaCwK\nICAgICAgICAgICAgICAgICAgICBsb2NrTGV2ZWwpOwogICAgICAgICAgICAg\nICAgcmVzLnNldEJhc2VNYXBwaW5nKG1hcHBpbmdzW2ldKTsKICAgICAgICAg\nICAgICAgIHJlcy5zZXRJbmRleE9mKGkpOwoKICAgICAgICAgICAgICAgIC8v\nIGlmIHdlIGdldCB0byB0aGUgbGFzdCBzZWxlY3QsIGp1c3QgcmV0dXJuIGl0\ncyByZXN1bHQKICAgICAgICAgICAgICAgIGlmIChpID09IHNlbHMubGVuZ3Ro\nIC0gMSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwoKICAgICAg\nICAgICAgICAgIC8vIHJldHVybiB0aGUgZmlyc3QgcmVzdWx0IHRoYXQgaGFz\nIGEgcm93CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIGlmICghcmVzLm5leHQoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\ncmVzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoQmFjaygpOwogICAgICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICByZXMuY2xv\nc2UoKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g\nY3JlYXRlIGEgc2luZ2xlIHJlc3VsdCBmcm9tIGVhY2ggc2VsZWN0IGluIG91\nciBmYWtlIHVuaW9uLCBtZXJnaW5nCiAgICAgICAgLy8gdGhlbSBhcyBuZWVk\nZWQKICAgICAgICBBYnN0cmFjdFJlc3VsdFtdIHJlcyA9IG5ldyBBYnN0cmFj\ndFJlc3VsdFtzZWxzLmxlbmd0aF07CiAgICAgICAgTGlzdFtdIG9yZGVySWR4\ncyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGlzdCBsOwog\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICAgICAgcmVzW2ldID0gKEFic3RyYWN0UmVzdWx0\nKSBzZWxzW2ldLmV4ZWN1dGUoc3RvcmUsIGZldGNoLAogICAgICAgICAgICAg\nICAgICAgIGxvY2tMZXZlbCk7CiAgICAgICAgICAgICAgICByZXNbaV0uc2V0\nQmFzZU1hcHBpbmcobWFwcGluZ3NbaV0pOwogICAgICAgICAgICAgICAgcmVz\nW2ldLnNldEluZGV4T2YoaSk7CgogICAgICAgICAgICAgICAgbCA9IHNlbHNb\naV0uZ2V0U2VsZWN0ZWRPcmRlckluZGV4ZXMoKTsKICAgICAgICAgICAgICAg\nIGlmIChsICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAob3Jk\nZXJJZHhzID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVy\nSWR4cyA9IG5ldyBMaXN0W3NlbHMubGVuZ3RoXTsKICAgICAgICAgICAgICAg\nICAgICBvcmRlcklkeHNbaV0gPSBsOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyByZXNbaV0gIT0gbnVsbDsg\naSsrKQogICAgICAgICAgICAgICAgcmVzW2ldLmNsb3NlKCk7CiAgICAgICAg\nICAgIHRocm93IHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgbXVsdGlw\nbGUgc2VsZWN0cyBoYXZlIG9yZGVyaW5nLCB1c2UgYSBjb21wYXJhdG9yIHRv\nIGNvbGxhdGUKICAgICAgICBSZXN1bHRDb21wYXJhdG9yIGNvbXAgPSBudWxs\nOwogICAgICAgIGlmIChvcmRlcklkeHMgIT0gbnVsbCkKICAgICAgICAgICAg\nY29tcCA9IG5ldyBSZXN1bHRDb21wYXJhdG9yKG9yZGVySWR4cywgZGVzYywg\nZGljdCk7CiAgICAgICAgcmV0dXJuIG5ldyBNZXJnZWRSZXN1bHQocmVzLCBj\nb21wKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3QoVW5pb24uU2Vs\nZWN0b3Igc2VsZWN0b3IpIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHNlbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHNlbGVjdG9yLnNlbGVj\ndChzZWxzW2ldLCBpKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHRvU3Ry\naW5nKCkgewogICAgICAgIHJldHVybiB0b1NlbGVjdChmYWxzZSwgbnVsbCku\nZ2V0U1FMKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBIGNhbGxiYWNrIHVz\nZWQgdG8gY3JlYXRlIHRoZSBzZWxlY3RzIGluIGEgU1FMIHVuaW9uLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIGludGVyZmFjZSBTZWxlY3RvciB7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIFBvcHVsYXRlIHRoZSA8Y29kZT5pPC9j\nb2RlPnRoIHNlbGVjdCBpbiB0aGUgdW5pb24uCiAgICAgICAgICovCiAgICAg\nICAgcHVibGljIHZvaWQgc2VsZWN0KFNlbGVjdCBzZWwsIGludCBpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEEgc2VsZWN0IHRoYXQgaXMgcGFydCBvZiBh\nIGxvZ2ljYWwgdW5pb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBjbGFzcyBV\nbmlvblNlbGVjdAogICAgICAgIGltcGxlbWVudHMgU2VsZWN0IHsKCiAgICAg\nICAgcHJvdGVjdGVkIGZpbmFsIFNlbGVjdEltcGwgc2VsOwogICAgICAgIHBy\nb3RlY3RlZCBmaW5hbCBpbnQgcG9zOwogICAgICAgIHByb3RlY3RlZCBpbnQg\nb3JkZXJzID0gMDsKICAgICAgICBwcm90ZWN0ZWQgTGlzdCBvcmRlcklkeHMg\nPSBudWxsOwoKICAgICAgICBwdWJsaWMgVW5pb25TZWxlY3QoU2VsZWN0SW1w\nbCBzZWwsIGludCBwb3MpIHsKICAgICAgICAgICAgdGhpcy5zZWwgPSBzZWw7\nCiAgICAgICAgICAgIHRoaXMucG9zID0gcG9zOwogICAgICAgICAgICBzZWwu\nc2V0UmVjb3JkT3JkZXJlZEluZGV4ZXModHJ1ZSk7CiAgICAgICAgfQoKICAg\nICAgICAvKioKICAgICAgICAgKiBEZWxlZ2F0ZSBzZWxlY3QuCiAgICAgICAg\nICovCiAgICAgICAgcHVibGljIFNlbGVjdEltcGwgZ2V0RGVsZWdhdGUoKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWw7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBSZXR1cm4gdGhlIGluZGV4ZXMgb2YgdGhlIGRhdGEg\naW4gdGhlIHNlbGVjdCBjbGF1c2UgdGhpcyBxdWVyeSBpcwogICAgICAgICAq\nIG9yZGVyZWQgYnkuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIExpc3Qg\nZ2V0U2VsZWN0ZWRPcmRlckluZGV4ZXMoKSB7CiAgICAgICAgICAgIGlmIChv\ncmRlcklkeHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIG9yZGVySWR4cyA9\nIHNlbC5nZXRPcmRlcmVkSW5kZXhlcygpOwogICAgICAgICAgICByZXR1cm4g\nb3JkZXJJZHhzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpEQkNDb25m\naWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgICAgIHJl\ndHVybiBzZWwuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGludCBpbmRleE9mKCkgewogICAgICAgICAgICByZXR1cm4g\ncG9zOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciB0b1Nl\nbGVjdChib29sZWFuIGZvclVwZGF0ZSwKICAgICAgICAgICAgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgICAgICByZXR1cm4gc2Vs\nLnRvU2VsZWN0KGZvclVwZGF0ZSwgZmV0Y2gpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdENvdW50KCkgewogICAgICAg\nICAgICByZXR1cm4gc2VsLnRvU2VsZWN0Q291bnQoKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBib29sZWFuIGdldEF1dG9EaXN0aW5jdCgpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5nZXRBdXRvRGlzdGluY3QoKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EaXN0aW5jdChib29s\nZWFuIGRpc3RpbmN0KSB7CiAgICAgICAgICAgIHNlbC5zZXRBdXRvRGlzdGlu\nY3QoZGlzdGluY3QpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gaXNEaXN0aW5jdCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5pc0Rp\nc3RpbmN0KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRE\naXN0aW5jdChib29sZWFuIGRpc3RpbmN0KSB7CiAgICAgICAgICAgIHNlbC5z\nZXREaXN0aW5jdChkaXN0aW5jdCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBpc0xSUygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5p\nc0xSUygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0TFJT\nKGJvb2xlYW4gbHJzKSB7CiAgICAgICAgICAgIHNlbC5zZXRMUlMobHJzKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgZ2V0Sm9pblN5bnRheCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRKb2luU3ludGF4KCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRKb2luU3ludGF4KGlu\ndCBqb2luU3ludGF4KSB7CiAgICAgICAgICAgIHNlbC5zZXRKb2luU3ludGF4\nKGpvaW5TeW50YXgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3MoYm9vbGVhbiBmb3JVcGRhdGUpIHsK\nICAgICAgICAgICAgcmV0dXJuIHNlbC5zdXBwb3J0c1JhbmRvbUFjY2Vzcyhm\nb3JVcGRhdGUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4g\nc3VwcG9ydHNMb2NraW5nKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLnN1\ncHBvcnRzTG9ja2luZygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGlu\ndCBnZXRDb3VudChKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gc2VsLmdldENv\ndW50KHN0b3JlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHQg\nZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb24gZmV0Y2gpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICByZXR1cm4gc2VsLmV4ZWN1dGUoc3RvcmUsIGZldGNoKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJD\nU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAg\nICAgICAgICAgIGludCBsb2NrTGV2ZWwpCiAgICAgICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gc2VsLmV4ZWN1dGUo\nc3RvcmUsIGZldGNoLCBsb2NrTGV2ZWwpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIExpc3QgZ2V0U3Vic2VsZWN0cygpIHsKICAgICAgICAgICAgcmV0\ndXJuIENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgU2VsZWN0IGdldFBhcmVudCgpIHsKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdl\ndFN1YnNlbGVjdFBhdGgoKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0UGFyZW50KFNlbGVj\ndCBwYXJlbnQsIFN0cmluZyBwYXRoKSB7CiAgICAgICAgICAgIHRocm93IG5l\ndyBVbnN1cHBvcnRlZEV4Y2VwdGlvbihfbG9jLmdldCgidW5pb24tZWxlbWVu\ndCIpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTZWxlY3QgZ2V0RnJv\nbVNlbGVjdCgpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRGcm9tU2VsZWN0KFNlbGVjdCBz\nZWwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0\naW9uKF9sb2MuZ2V0KCJ1bmlvbi1lbGVtZW50IikpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGJvb2xlYW4gaGFzRWFnZXJKb2luKGJvb2xlYW4gdG9N\nYW55KSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuaGFzRWFnZXJKb2luKHRv\nTWFueSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNK\nb2luKGJvb2xlYW4gdG9NYW55KSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\naGFzSm9pbih0b01hbnkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gaXNTZWxlY3RlZChUYWJsZSB0YWJsZSkgewogICAgICAgICAgICBy\nZXR1cm4gc2VsLmlzU2VsZWN0ZWQodGFibGUpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIENvbGxlY3Rpb24gZ2V0VGFibGVBbGlhc2VzKCkgewogICAg\nICAgICAgICByZXR1cm4gc2VsLmdldFRhYmxlQWxpYXNlcygpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIExpc3QgZ2V0U2VsZWN0QWxpYXNlcygpIHsK\nICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRTZWxlY3RBbGlhc2VzKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgTGlzdCBnZXRJZGVudGlmaWVyQWxp\nYXNlcygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRJZGVudGlmaWVy\nQWxpYXNlcygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZl\nciBnZXRPcmRlcmluZygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRP\ncmRlcmluZygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZl\nciBnZXRHcm91cGluZygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRH\ncm91cGluZygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZl\nciBnZXRXaGVyZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRXaGVy\nZSgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciBnZXRI\nYXZpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0SGF2aW5nKCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBhZGRKb2luQ2xhc3ND\nb25kaXRpb25zKCkgewogICAgICAgICAgICBzZWwuYWRkSm9pbkNsYXNzQ29u\nZGl0aW9ucygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5zIGdl\ndEpvaW5zKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5zKCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSXRlcmF0b3IgZ2V0Sm9pbkl0\nZXJhdG9yKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5JdGVy\nYXRvcigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0U3Rh\ncnRJbmRleCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRTdGFydElu\nZGV4KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRFbmRJ\nbmRleCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRFbmRJbmRleCgp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0UmFuZ2UobG9u\nZyBzdGFydCwgbG9uZyBlbmQpIHsKICAgICAgICAgICAgc2VsLnNldFJhbmdl\nKHN0YXJ0LCBlbmQpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmlu\nZyBnZXRDb2x1bW5BbGlhcyhDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIHJl\ndHVybiBzZWwuZ2V0Q29sdW1uQWxpYXMoY29sKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q29sdW1uQWxpYXMoQ29sdW1uIGNvbCwg\nSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRDb2x1\nbW5BbGlhcyhjb2wsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0Q29sdW1uQWxpYXMoU3RyaW5nIGNvbCwgVGFibGUgdGFi\nbGUpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRDb2x1bW5BbGlhcyhj\nb2wsIHRhYmxlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0Q29sdW1uQWxpYXMoU3RyaW5nIGNvbCwgVGFibGUgdGFibGUsIEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0Q29sdW1uQWxp\nYXMoY29sLCB0YWJsZSwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gaXNBZ2dyZWdhdGUoKSB7CiAgICAgICAgICAgIHJldHVy\nbiBzZWwuaXNBZ2dyZWdhdGUoKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyB2b2lkIHNldEFnZ3JlZ2F0ZShib29sZWFuIGFnZykgewogICAgICAgICAg\nICBzZWwuc2V0QWdncmVnYXRlKGFnZyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBpc0xvYigpIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5pc0xvYigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0\nTG9iKGJvb2xlYW4gbG9iKSB7CiAgICAgICAgICAgIHNlbC5zZXRMb2IobG9i\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNlbGVjdFBsYWNl\naG9sZGVyKFN0cmluZyBzcWwpIHsKICAgICAgICAgICAgc2VsLnNlbGVjdFBs\nYWNlaG9sZGVyKHNxbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9p\nZCBjbGVhclNlbGVjdHMoKSB7CiAgICAgICAgICAgIHNlbC5jbGVhclNlbGVj\ndHMoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIHNlbGVj\ndChTUUxCdWZmZXIgc3FsLCBPYmplY3QgaWQpIHsKICAgICAgICAgICAgcmV0\ndXJuIHNlbC5zZWxlY3Qoc3FsLCBpZCk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBzZWxlY3QoU1FMQnVmZmVyIHNxbCwgT2JqZWN0IGlk\nLCBKb2lucyBqb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVj\ndChzcWwsIGlkLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBzZWxlY3QoU3RyaW5nIHNxbCwgT2JqZWN0IGlkKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwuc2VsZWN0KHNxbCwgaWQpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gc2VsZWN0KFN0cmluZyBzcWwsIE9i\namVjdCBpZCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5zZWxlY3Qoc3FsLCBpZCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gc2VsZWN0KENvbHVtbiBjb2wpIHsKICAgICAgICAg\nICAgcmV0dXJuIHNlbC5zZWxlY3QoY29sKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBib29sZWFuIHNlbGVjdChDb2x1bW4gY29sLCBKb2lucyBqb2lu\ncykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVjdChjb2wsIGpvaW5z\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2VsZWN0KENvbHVt\nbltdIGNvbHMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3QoY29s\ncyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IHNlbGVjdChDb2x1\nbW5bXSBjb2xzLCBKb2lucyBqb2lucykgewogICAgICAgICAgICByZXR1cm4g\nc2VsLnNlbGVjdChjb2xzLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzZWxlY3QoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBz\ndWJjbGFzc2VzLAogICAgICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlcikgewogICAgICAg\nICAgICBzZWxlY3QobWFwcGluZywgc3ViY2xhc3Nlcywgc3RvcmUsIGZldGNo\nLCBlYWdlciwgbnVsbCwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgc2VsZWN0KENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3Vi\nY2xhc3NlcywKICAgICAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgZWFnZXIsCiAgICAgICAgICAg\nIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbGVjdChtYXBwaW5nLCBz\ndWJjbGFzc2VzLCBzdG9yZSwgZmV0Y2gsIGVhZ2VyLCBqb2lucywgZmFsc2Up\nOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIHNlbGVjdChDbGFz\nc01hcHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNzZXMsCiAgICAgICAgICAg\nIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRj\naCwgaW50IGVhZ2VyLAogICAgICAgICAgICBKb2lucyBqb2lucywgYm9vbGVh\nbiBpZGVudGlmaWVyKSB7CiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdGhl\nIGZpcnN0IChwcmltYXJ5KSBtYXBwaW5nIHNlbGVjdGVkIGZvciB0aGlzCiAg\nICAgICAgICAgIC8vIFNFTEVDVCwgcmVjb3JkIGl0IHNvIHdlIGNhbiBmaWd1\ncmUgb3V0IHdoYXQgdGhlIHJlc3VsdCB0eXBlIGlzCiAgICAgICAgICAgIC8v\nIHNpbmNlIHRoZSBkaXNjcmltaW5hdG9yIG1pZ2h0IG5vdCBiZSBzZWxlY3Rl\nZAogICAgICAgICAgICBpZiAobWFwcGluZ3NbcG9zXSA9PSBudWxsKQogICAg\nICAgICAgICAgICAgbWFwcGluZ3NbcG9zXSA9IG1hcHBpbmc7CgogICAgICAg\nICAgICBzZWwuc2VsZWN0KHRoaXMsIG1hcHBpbmcsIHN1YmNsYXNzZXMsIHN0\nb3JlLCBmZXRjaCwgZWFnZXIsCiAgICAgICAgICAgICAgICBqb2lucywgaWRl\nbnRpZmllcik7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBz\nZWxlY3RJZGVudGlmaWVyKENvbHVtbiBjb2wpIHsKICAgICAgICAgICAgcmV0\ndXJuIHNlbC5zZWxlY3RJZGVudGlmaWVyKGNvbCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3RJZGVudGlmaWVyKENvbHVtbiBj\nb2wsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2Vs\nZWN0SWRlbnRpZmllcihjb2wsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBpbnQgc2VsZWN0SWRlbnRpZmllcihDb2x1bW5bXSBjb2xzKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuc2VsZWN0SWRlbnRpZmllcihjb2xz\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2VsZWN0SWRlbnRp\nZmllcihDb2x1bW5bXSBjb2xzLCBKb2lucyBqb2lucykgewogICAgICAgICAg\nICByZXR1cm4gc2VsLnNlbGVjdElkZW50aWZpZXIoY29scywgam9pbnMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2VsZWN0SWRlbnRpZmll\ncihDbGFzc01hcHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNzZXMsCiAgICAg\nICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlv\nbiBmZXRjaCwgaW50IGVhZ2VyKSB7CiAgICAgICAgICAgIHNlbGVjdChtYXBw\naW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0Y2gsIGVhZ2VyLCBudWxsLCB0\ncnVlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNlbGVjdElk\nZW50aWZpZXIoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2Vz\nLAogICAgICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlciwKICAgICAgICAgICAgSm9pbnMg\nam9pbnMpIHsKICAgICAgICAgICAgc2VsZWN0KG1hcHBpbmcsIHN1YmNsYXNz\nZXMsIHN0b3JlLCBmZXRjaCwgZWFnZXIsIGpvaW5zLCB0cnVlKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2VsZWN0UHJpbWFyeUtleShDbGFz\nc01hcHBpbmcgbWFwcGluZykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNl\nbGVjdFByaW1hcnlLZXkobWFwcGluZyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgaW50IHNlbGVjdFByaW1hcnlLZXkoQ2xhc3NNYXBwaW5nIG1hcHBp\nbmcsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2Vs\nZWN0UHJpbWFyeUtleShtYXBwaW5nLCBqb2lucyk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgaW50IG9yZGVyQnlQcmltYXJ5S2V5KENsYXNzTWFwcGlu\nZyBtYXBwaW5nLCBib29sZWFuIGFzYywKICAgICAgICAgICAgYm9vbGVhbiBz\nZWxlY3QpIHsKICAgICAgICAgICAgcmV0dXJuIG9yZGVyQnlQcmltYXJ5S2V5\nKG1hcHBpbmcsIGFzYywgbnVsbCwgc2VsZWN0KTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBpbnQgb3JkZXJCeVByaW1hcnlLZXkoQ2xhc3NNYXBwaW5n\nIG1hcHBpbmcsIGJvb2xlYW4gYXNjLAogICAgICAgICAgICBKb2lucyBqb2lu\ncywgYm9vbGVhbiBzZWxlY3QpIHsKICAgICAgICAgICAgQ2xhc3NNYXBwaW5n\nIHBrcyA9IG1hcHBpbmc7CiAgICAgICAgICAgIHdoaWxlICghcGtzLmlzUHJp\nbWFyeUtleU9iamVjdElkKHRydWUpKQogICAgICAgICAgICAgICAgcGtzID0g\ncGtzLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gcGtzLmdldFByaW1hcnlLZXlDb2x1bW5z\nKCk7CiAgICAgICAgICAgIHJlY29yZE9yZGVyQ29sdW1ucyhjb2xzLCBhc2Mp\nOwogICAgICAgICAgICByZXR1cm4gc2VsLm9yZGVyQnlQcmltYXJ5S2V5KG1h\ncHBpbmcsIGFzYywgam9pbnMsIHNlbGVjdCwKICAgICAgICAgICAgICAgIGlz\nVW5pb24oKSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBS\nZWNvcmQgdGhhdCB3ZSdyZSBvcmRlcmluZyBieSBhIFNRTCBleHByZXNzaW9u\nLgogICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCB2b2lkIHJlY29yZE9y\nZGVyKE9iamVjdCBvcmQsIGJvb2xlYW4gYXNjKSB7CiAgICAgICAgICAgIGlm\nIChvcmQgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgb3JkZXJJZHhzID0gbnVsbDsKCiAgICAgICAgICAgIGludCBpZHgg\nPSBvcmRlcnMrKzsKICAgICAgICAgICAgaWYgKGRlc2MuZ2V0KGlkeCkgJiYg\nYXNjKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24o\nX2xvYy5nZXQoImluY29tcGF0LW9yZGVyaW5nIikpOwogICAgICAgICAgICBp\nZiAoIWFzYykKICAgICAgICAgICAgICAgIGRlc2Muc2V0KGlkeCk7CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZWNvcmQgdGhhdCB3ZSdy\nZSBvcmRlcmluZyBieSB0aGUgZ2l2ZW4gY29sdW1ucy4KICAgICAgICAgKi8K\nICAgICAgICBwcm90ZWN0ZWQgdm9pZCByZWNvcmRPcmRlckNvbHVtbnMoQ29s\ndW1uW10gY29scywgYm9vbGVhbiBhc2MpIHsKICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAg\nICAgcmVjb3JkT3JkZXIoY29sc1tpXSwgYXNjKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBib29sZWFuIG9yZGVyQnkoQ29sdW1uIGNvbCwgYm9vbGVh\nbiBhc2MsIGJvb2xlYW4gc2VsZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBv\ncmRlckJ5KGNvbCwgYXNjLCBudWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGJvb2xlYW4gb3JkZXJCeShDb2x1bW4gY29sLCBib29s\nZWFuIGFzYywgSm9pbnMgam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2Vs\nZWN0KSB7CiAgICAgICAgICAgIHJlY29yZE9yZGVyKGNvbCwgYXNjKTsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5vcmRlckJ5KGNvbCwgYXNjLCBqb2lucywg\nc2VsZWN0LCBpc1VuaW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGludCBvcmRlckJ5KENvbHVtbltdIGNvbHMsIGJvb2xlYW4gYXNjLCBib29s\nZWFuIHNlbGVjdCkgewogICAgICAgICAgICByZXR1cm4gb3JkZXJCeShjb2xz\nLCBhc2MsIG51bGwsIHNlbGVjdCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgaW50IG9yZGVyQnkoQ29sdW1uW10gY29scywgYm9vbGVhbiBhc2MsIEpv\naW5zIGpvaW5zLAogICAgICAgICAgICBib29sZWFuIHNlbGVjdCkgewogICAg\nICAgICAgICByZWNvcmRPcmRlckNvbHVtbnMoY29scywgYXNjKTsKICAgICAg\nICAgICAgcmV0dXJuIHNlbC5vcmRlckJ5KGNvbHMsIGFzYywgam9pbnMsIHNl\nbGVjdCwgaXNVbmlvbigpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBi\nb29sZWFuIG9yZGVyQnkoU1FMQnVmZmVyIHNxbCwgYm9vbGVhbiBhc2MsIGJv\nb2xlYW4gc2VsZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBvcmRlckJ5KHNx\nbCwgYXNjLCBudWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gb3JkZXJCeShTUUxCdWZmZXIgc3FsLCBib29sZWFuIGFz\nYywgSm9pbnMgam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2VsZWN0KSB7\nCiAgICAgICAgICAgIHJlY29yZE9yZGVyKHNxbC5nZXRTUUwoZmFsc2UpLCBh\nc2MpOwogICAgICAgICAgICByZXR1cm4gc2VsLm9yZGVyQnkoc3FsLCBhc2Ms\nIGpvaW5zLCBzZWxlY3QsIGlzVW5pb24oKSk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBvcmRlckJ5KFN0cmluZyBzcWwsIGJvb2xlYW4g\nYXNjLCBib29sZWFuIHNlbGVjdCkgewogICAgICAgICAgICByZXR1cm4gb3Jk\nZXJCeShzcWwsIGFzYywgbnVsbCwgc2VsZWN0KTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBib29sZWFuIG9yZGVyQnkoU3RyaW5nIHNxbCwgYm9vbGVh\nbiBhc2MsIEpvaW5zIGpvaW5zLAogICAgICAgICAgICBib29sZWFuIHNlbGVj\ndCkgewogICAgICAgICAgICByZWNvcmRPcmRlcihzcWwsIGFzYyk7CiAgICAg\nICAgICAgIHJldHVybiBzZWwub3JkZXJCeShzcWwsIGFzYywgam9pbnMsIHNl\nbGVjdCwgaXNVbmlvbigpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIGNsZWFyT3JkZXJpbmcoKSB7CiAgICAgICAgICAgIHNlbC5jbGVhck9y\nZGVyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVy\nZVByaW1hcnlLZXkoT2JqZWN0IG9pZCwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcs\nCiAgICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgICAgICBz\nZWwud2hlcmVQcmltYXJ5S2V5KG9pZCwgbWFwcGluZywgc3RvcmUpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgd2hlcmVGb3JlaWduS2V5KEZv\ncmVpZ25LZXkgZmssIE9iamVjdCBvaWQsCiAgICAgICAgICAgIENsYXNzTWFw\ncGluZyBtYXBwaW5nLCBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICAgICAg\nc2VsLndoZXJlRm9yZWlnbktleShmaywgb2lkLCBtYXBwaW5nLCBzdG9yZSk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZShKb2lucyBq\nb2lucykgewogICAgICAgICAgICBzZWwud2hlcmUoam9pbnMpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgd2hlcmUoU1FMQnVmZmVyIHNxbCkg\newogICAgICAgICAgICBzZWwud2hlcmUoc3FsKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyB2b2lkIHdoZXJlKFNRTEJ1ZmZlciBzcWwsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgICAgIHNlbC53aGVyZShzcWwsIGpvaW5zKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdoZXJlKFN0cmluZyBzcWwp\nIHsKICAgICAgICAgICAgc2VsLndoZXJlKHNxbCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCB3aGVyZShTdHJpbmcgc3FsLCBKb2lucyBqb2lu\ncykgewogICAgICAgICAgICBzZWwud2hlcmUoc3FsLCBqb2lucyk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBoYXZpbmcoU1FMQnVmZmVyIHNx\nbCkgewogICAgICAgICAgICBzZWwuaGF2aW5nKHNxbCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBoYXZpbmcoU1FMQnVmZmVyIHNxbCwgSm9p\nbnMgam9pbnMpIHsKICAgICAgICAgICAgc2VsLmhhdmluZyhzcWwsIGpvaW5z\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTdHJp\nbmcgc3FsKSB7CiAgICAgICAgICAgIHNlbC5oYXZpbmcoc3FsKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTdHJpbmcgc3FsLCBK\nb2lucyBqb2lucykgewogICAgICAgICAgICBzZWwuaGF2aW5nKHNxbCwgam9p\nbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ3JvdXBCeShT\nUUxCdWZmZXIgc3FsKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KHNxbCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBncm91cEJ5KFNRTEJ1\nZmZlciBzcWwsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5ncm91\ncEJ5KHNxbCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgZ3JvdXBCeShTdHJpbmcgc3FsKSB7CiAgICAgICAgICAgIHNlbC5ncm91\ncEJ5KHNxbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBncm91\ncEJ5KFN0cmluZyBzcWwsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNl\nbC5ncm91cEJ5KHNxbCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgZ3JvdXBCeShDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIHNl\nbC5ncm91cEJ5KGNvbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9p\nZCBncm91cEJ5KENvbHVtbiBjb2wsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAg\nICAgIHNlbC5ncm91cEJ5KGNvbCwgam9pbnMpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIHZvaWQgZ3JvdXBCeShDb2x1bW5bXSBjb2xzKSB7CiAgICAg\nICAgICAgIHNlbC5ncm91cEJ5KGNvbHMpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgZ3JvdXBCeShDb2x1bW5bXSBjb2xzLCBKb2lucyBqb2lu\ncykgewogICAgICAgICAgICBzZWwuZ3JvdXBCeShjb2xzLCBqb2lucyk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBncm91cEJ5KENsYXNzTWFw\ncGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywgCiAgICAgICAgICAgIEpE\nQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkg\newogICAgICAgICAgICBzZWwuZ3JvdXBCeShtYXBwaW5nLCBzdWJjbGFzc2Vz\nLCBzdG9yZSwgZmV0Y2gpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgZ3JvdXBCeShDbGFzc01hcHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNz\nZXMsIAogICAgICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gZmV0Y2gsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAg\nIHNlbC5ncm91cEJ5KG1hcHBpbmcsIHN1YmNsYXNzZXMsIHN0b3JlLCBmZXRj\naCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNlbGVjdEV4\nZWN1dG9yIHdoZXJlQ2xvbmUoaW50IHNlbHMpIHsKICAgICAgICAgICAgcmV0\ndXJuIHNlbC53aGVyZUNsb25lKHNlbHMpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIFNlbGVjdEV4ZWN1dG9yIGZ1bGxDbG9uZShpbnQgc2Vscykgewog\nICAgICAgICAgICByZXR1cm4gc2VsLmZ1bGxDbG9uZShzZWxzKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBTZWxlY3RFeGVjdXRvciBlYWdlckNsb25l\nKEZpZWxkTWFwcGluZyBrZXksIGludCBlYWdlclR5cGUsCiAgICAgICAgICAg\nIGJvb2xlYW4gdG9NYW55LCBpbnQgc2VscykgewogICAgICAgICAgICBTZWxl\nY3RFeGVjdXRvciBleCA9IHNlbC5lYWdlckNsb25lKGtleSwgZWFnZXJUeXBl\nLCB0b01hbnksIHNlbHMpOwogICAgICAgICAgICByZXR1cm4gKGV4ID09IHNl\nbCkgPyB0aGlzIDogZXg7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU2Vs\nZWN0RXhlY3V0b3IgZ2V0RWFnZXIoRmllbGRNYXBwaW5nIGtleSkgewogICAg\nICAgICAgICBTZWxlY3RFeGVjdXRvciBleCA9IHNlbC5nZXRFYWdlcihrZXkp\nOwogICAgICAgICAgICByZXR1cm4gKGV4ID09IHNlbCkgPyB0aGlzIDogZXg7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMgbmV3Sm9pbnMoKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwubmV3Sm9pbnMoKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBKb2lucyBuZXdPdXRlckpvaW5zKCkgewogICAg\nICAgICAgICByZXR1cm4gc2VsLm5ld091dGVySm9pbnMoKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIGFwcGVuZChTUUxCdWZmZXIgYnVmLCBK\nb2lucyBqb2lucykgewogICAgICAgICAgICBzZWwuYXBwZW5kKGJ1Ziwgam9p\nbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5zIGFuZChKb2lu\ncyBqb2luczEsIEpvaW5zIGpvaW5zMikgewogICAgICAgICAgICByZXR1cm4g\nc2VsLmFuZChqb2luczEsIGpvaW5zMik7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgSm9pbnMgb3IoSm9pbnMgam9pbnMxLCBKb2lucyBqb2luczIpIHsK\nICAgICAgICAgICAgcmV0dXJuIHNlbC5vcihqb2luczEsIGpvaW5zMik7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMgb3V0ZXIoSm9pbnMgam9p\nbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5vdXRlcihqb2lucyk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewog\nICAgICAgICAgICByZXR1cm4gc2VsLnRvU3RyaW5nKCk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogQ29tcGFyYXRvciBmb3IgY29sbGF0aW5n\nIG9yZGVyZWQgcmVzdWx0cyB3aGVuIGZha2luZyBhIHVuaW9uLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBSZXN1bHRDb21wYXJhdG9yCiAg\nICAgICAgaW1wbGVtZW50cyBNZXJnZWRSZXN1bHQuUmVzdWx0Q29tcGFyYXRv\nciB7CgogICAgICAgIHByaXZhdGUgZmluYWwgTGlzdFtdIF9vcmRlcnM7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBCaXRTZXQgX2Rlc2M7CiAgICAgICAgcHJp\ndmF0ZSBmaW5hbCBEQkRpY3Rpb25hcnkgX2RpY3Q7CgogICAgICAgIHB1Ymxp\nYyBSZXN1bHRDb21wYXJhdG9yKExpc3RbXSBvcmRlcnMsIEJpdFNldCBkZXNj\nLCBEQkRpY3Rpb25hcnkgZGljdCkgewogICAgICAgICAgICBfb3JkZXJzID0g\nb3JkZXJzOwogICAgICAgICAgICBfZGVzYyA9IGRlc2M7CiAgICAgICAgICAg\nIF9kaWN0ID0gZGljdDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmpl\nY3QgZ2V0T3JkZXJpbmdWYWx1ZShSZXN1bHQgcmVzLCBpbnQgaWR4KSB7CiAg\nICAgICAgICAgIC8vIGlmIG9uZSB2YWx1ZSBqdXN0IHJldHVybiBpdAogICAg\nICAgICAgICBSZXN1bHRTZXQgcnMgPSAoKFJlc3VsdFNldFJlc3VsdCkgcmVz\nKS5nZXRSZXN1bHRTZXQoKTsKICAgICAgICAgICAgaWYgKF9vcmRlcnNbaWR4\nXS5zaXplKCkgPT0gMSkKICAgICAgICAgICAgICAgIHJldHVybiBnZXRPcmRl\ncmluZ1ZhbHVlKHJzLCBfb3JkZXJzW2lkeF0uZ2V0KDApKTsKCiAgICAgICAg\nICAgIC8vIHJldHVybiBhcnJheSBvZiB2YWx1ZXMKICAgICAgICAgICAgT2Jq\nZWN0W10gdmFscyA9IG5ldyBPYmplY3RbX29yZGVyc1tpZHhdLnNpemUoKV07\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdmFscy5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgICAgIHZhbHNbaV0gPSBnZXRPcmRlcmluZ1Zh\nbHVlKHJzLCBfb3JkZXJzW2lkeF0uZ2V0KGkpKTsKICAgICAgICAgICAgcmV0\ndXJuIHZhbHM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBF\neHRyYWN0IHZhbHVlIGF0IGdpdmVuIGluZGV4IGZyb20gcmVzdWx0IHNldC4K\nICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIE9iamVjdCBnZXRPcmRlcmlu\nZ1ZhbHVlKFJlc3VsdFNldCBycywgT2JqZWN0IGkpIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBfZGljdC5nZXRPYmplY3Qo\ncnMsICgoSW50ZWdlcikgaSkuaW50VmFsdWUoKSArIDEsIG51bGwpOwogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsIF9kaWN0\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIGlu\ndCBjb21wYXJlKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7CiAgICAgICAgICAg\nIGlmIChvMSA9PSBvMikKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAg\nICAgICAgICBpZiAobzEgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVy\nbiAoX2Rlc2MuZ2V0KDApKSA/IC0xIDogMTsKICAgICAgICAgICAgaWYgKG8y\nID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNjLmdldCgw\nKSkgPyAxIDogLTE7CgogICAgICAgICAgICBpbnQgY21wOwogICAgICAgICAg\nICBpZiAoIShvMSBpbnN0YW5jZW9mIE9iamVjdFtdKSkgewogICAgICAgICAg\nICAgICAgaWYgKCEobzIgaW5zdGFuY2VvZiBPYmplY3RbXSkpIHsKICAgICAg\nICAgICAgICAgICAgICBjbXAgPSAoKENvbXBhcmFibGUpIG8xKS5jb21wYXJl\nVG8obzIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAoX2Rlc2MuZ2V0\nKDApKSA/IC1jbXAgOiBjbXA7CiAgICAgICAgICAgICAgICB9CgogICAgICAg\nICAgICAgICAgY21wID0gKChDb21wYXJhYmxlKSBvMSkuY29tcGFyZVRvKCgo\nT2JqZWN0W10pIG8yKVswXSk7CiAgICAgICAgICAgICAgICBpZiAoY21wICE9\nIDApCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChfZGVzYy5nZXQoMCkp\nID8gLWNtcCA6IGNtcDsKICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEobzIgaW5zdGFuY2VvZiBP\nYmplY3RbXSkpIHsKICAgICAgICAgICAgICAgIGNtcCA9ICgoQ29tcGFyYWJs\nZSkgKChPYmplY3RbXSkgbzEpWzBdKS5jb21wYXJlVG8obzIpOwogICAgICAg\nICAgICAgICAgaWYgKGNtcCAhPSAwKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiAoX2Rlc2MuZ2V0KDApKSA/IC1jbXAgOiBjbXA7CiAgICAgICAgICAg\nICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgT2Jq\nZWN0W10gYTEgPSAoT2JqZWN0W10pIG8xOwogICAgICAgICAgICBPYmplY3Rb\nXSBhMiA9IChPYmplY3RbXSkgbzI7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgYTEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGNt\ncCA9ICgoQ29tcGFyYWJsZSkgYTFbaV0pLmNvbXBhcmVUbyhhMltpXSk7CiAg\nICAgICAgICAgICAgICBpZiAoY21wICE9IDApCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIChfZGVzYy5nZXQoaSkpID8gLWNtcCA6IGNtcDsKICAgICAg\nICAgICAgfQogICAgICAgICAgICByZXR1cm4gYTEubGVuZ3RoIC0gYTIubGVu\nZ3RoOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

