{"sha":"82d79940117eb62bb692fef5898e07f09c8d96cb","node_id":"MDQ6QmxvYjIwNjM2NDo4MmQ3OTk0MDExN2ViNjJiYjY5MmZlZjU4OThlMDdmMDljOGQ5NmNi","size":5941,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/82d79940117eb62bb692fef5898e07f09c8d96cb","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNx\nbC5UeXBlczsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkluZGV4Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlL\nZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFi\nbGU7CgovKioKICogRGljdGlvbmFyeSBmb3IgTXlTUUwuCiAqLwpwdWJsaWMg\nY2xhc3MgTXlTUUxEaWN0aW9uYXJ5CiAgICBleHRlbmRzIERCRGljdGlvbmFy\neSB7CgogICAgLyoqCiAgICAgKiBUaGUgTXlTUUwgdGFibGUgdHlwZSB0byB1\nc2Ugd2hlbiBjcmVhdGluZyB0YWJsZXM7IGRlZmF1bHRzIHRvIGlubm9kYi4K\nICAgICAqLwogICAgcHVibGljIFN0cmluZyB0YWJsZVR5cGUgPSAiaW5ub2Ri\nIjsKCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNlIGNsb2JzLiBTb21l\nIG9sZGVyIHZlcnNpb25zIG9mIE15U1FMIGRvIG5vdCBoYW5kbGUKICAgICAq\nIGNsb2JzIHByb3Blcmx5IHNvIHdlIGRlZmF1bHQgdG8gZmFsc2UgaGVyZS4K\nICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gdXNlQ2xvYnMgPSB0cnVlOwoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGUgZHJpdmVyIGF1dG9tYXRpY2Fs\nbHkgZGVzZXJpYWxpemVzIGJsb2JzLgogICAgICovCiAgICBwdWJsaWMgYm9v\nbGVhbiBkcml2ZXJEZXNlcmlhbGl6ZXNCbG9icyA9IHRydWU7CgogICAgcHVi\nbGljIE15U1FMRGljdGlvbmFyeSgpIHsKICAgICAgICBwbGF0Zm9ybSA9ICJN\neVNRTCI7CiAgICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxFQ1QgTk9XKCki\nOwogICAgICAgIGRpc3RpbmN0Q291bnRDb2x1bW5TZXBhcmF0b3IgPSAiLCI7\nCgogICAgICAgIHN1cHBvcnRzRGVmZXJyZWRDb25zdHJhaW50cyA9IGZhbHNl\nOwogICAgICAgIGNvbnN0cmFpbnROYW1lTW9kZSA9IENPTlNfTkFNRV9NSUQ7\nCiAgICAgICAgc3VwcG9ydHNNdWx0aXBsZU5vbnRyYW5zYWN0aW9uYWxSZXN1\nbHRTZXRzID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNTdWJzZWxlY3QgPSBm\nYWxzZTsgLy8gb2xkIHZlcnNpb25zCiAgICAgICAgcmVxdWlyZXNBbGlhc0Zv\nclN1YnNlbGVjdCA9IHRydWU7IC8vIG5ldyB2ZXJzaW9ucwogICAgICAgIHN1\ncHBvcnRzU2VsZWN0U3RhcnRJbmRleCA9IHRydWU7CiAgICAgICAgc3VwcG9y\ndHNTZWxlY3RFbmRJbmRleCA9IHRydWU7CiAgICAgICAgYWxsb3dzQWxpYXNJ\nbkJ1bGtDbGF1c2UgPSBmYWxzZTsKCiAgICAgICAgY29uY2F0ZW5hdGVGdW5j\ndGlvbiA9ICJDT05DQVQoezB9LHsxfSkiOwoKICAgICAgICBtYXhUYWJsZU5h\nbWVMZW5ndGggPSA2NDsKICAgICAgICBtYXhDb2x1bW5OYW1lTGVuZ3RoID0g\nNjQ7CiAgICAgICAgbWF4SW5kZXhOYW1lTGVuZ3RoID0gNjQ7CiAgICAgICAg\nbWF4Q29uc3RyYWludE5hbWVMZW5ndGggPSA2NDsKICAgICAgICBtYXhJbmRl\neGVzUGVyVGFibGUgPSAzMjsKICAgICAgICBzY2hlbWFDYXNlID0gU0NIRU1B\nX0NBU0VfUFJFU0VSVkU7CgogICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9\nIHRydWU7CiAgICAgICAgbGFzdEdlbmVyYXRlZEtleVF1ZXJ5ID0gIlNFTEVD\nVCBMQVNUX0lOU0VSVF9JRCgpIjsKICAgICAgICBhdXRvQXNzaWduQ2xhdXNl\nID0gIkFVVE9fSU5DUkVNRU5UIjsKCiAgICAgICAgY2xvYlR5cGVOYW1lID0g\nIlRFWFQiOwogICAgICAgIGxvbmdWYXJjaGFyVHlwZU5hbWUgPSAiVEVYVCI7\nCiAgICAgICAgbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0gIkxPTkcgVkFSQklO\nQVJZIjsKICAgICAgICB0aW1lc3RhbXBUeXBlTmFtZSA9ICJEQVRFVElNRSI7\nCiAgICAgICAgZml4ZWRTaXplVHlwZU5hbWVTZXQuYWRkQWxsKEFycmF5cy5h\nc0xpc3QobmV3IFN0cmluZ1tdewogICAgICAgICAgICAiQk9PTCIsICJMT05H\nIFZBUkJJTkFSWSIsICJNRURJVU1CTE9CIiwgIkxPTkdCTE9CIiwKICAgICAg\nICAgICAgIlRJTllCTE9CIiwgIkxPTkcgVkFSQ0hBUiIsICJNRURJVU1URVhU\nIiwgIkxPTkdURVhUIiwgIlRFWFQiLAogICAgICAgICAgICAiVElOWVRFWFQi\nLCAiRE9VQkxFIFBSRUNJU0lPTiIsICJFTlVNIiwgIlNFVCIsICJEQVRFVElN\nRSIsCiAgICAgICAgfSkpOwogICAgICAgIHJlc2VydmVkV29yZFNldC5hZGRB\nbGwoQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJJ\nTlQxIiwgIklOVDIiLCAiSU5UNCIsICJGTE9BVDEiLCAiRkxPQVQyIiwgIkZM\nT0FUNCIsCiAgICAgICAgICAgICJBVVRPX0lOQ1JFTUVOVCIsICJCSU5BUlki\nLCAiQkxPQiIsICJDSEFOR0UiLCAiRU5VTSIsICJJTkZJTEUiLAogICAgICAg\nICAgICAiTE9BRCIsICJNRURJVU1JTlQiLCAiT1BUSU9OIiwgIk9VVEZJTEUi\nLCAiUkVQTEFDRSIsCiAgICAgICAgICAgICJTRVQiLCAiU1RBUlRJTkciLCAi\nVEVYVCIsICJVTlNJR05FRCIsICJaRVJPRklMTCIsCiAgICAgICAgfSkpOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVUYWJsZVNRTChU\nYWJsZSB0YWJsZSkgewogICAgICAgIFN0cmluZ1tdIHNxbCA9IHN1cGVyLmdl\ndENyZWF0ZVRhYmxlU1FMKHRhYmxlKTsKICAgICAgICBpZiAoIVN0cmluZ1V0\naWxzLmlzRW1wdHkodGFibGVUeXBlKSkKICAgICAgICAgICAgc3FsWzBdID0g\nc3FsWzBdICsgIiBUWVBFID0gIiArIHRhYmxlVHlwZTsKICAgICAgICByZXR1\ncm4gc3FsOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wSW5k\nZXhTUUwoSW5kZXggaW5kZXgpIHsKICAgICAgICByZXR1cm4gbmV3IFN0cmlu\nZ1tdeyAiRFJPUCBJTkRFWCAiICsgZ2V0RnVsbE5hbWUoaW5kZXgpICsgIiBP\nTiAiCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUoaW5kZXguZ2V0VGFibGUo\nKSwgZmFsc2UpIH07CiAgICB9CgogICAgcHVibGljIFN0cmluZ1tdIGdldEFk\nZFByaW1hcnlLZXlTUUwoUHJpbWFyeUtleSBwaykgewogICAgICAgIFN0cmlu\nZ1tdIHNxbCA9IHN1cGVyLmdldEFkZFByaW1hcnlLZXlTUUwocGspOwoKICAg\nICAgICAvLyBteXNxbCByZXF1aXJlcyB0aGF0IGEgY29sdW1uIGJlIGRlY2xh\ncmVkIE5PVCBOVUxMIGJlZm9yZQogICAgICAgIC8vIGl0IGNhbiBiZSBtYWRl\nIGEgcHJpbWFyeSBrZXkuCiAgICAgICAgQ29sdW1uW10gY29scyA9IHBrLmdl\ndENvbHVtbnMoKTsKICAgICAgICBTdHJpbmdbXSByZXQgPSBuZXcgU3RyaW5n\nW2NvbHMubGVuZ3RoICsgc3FsLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJl\ndFtpXSA9ICJBTFRFUiBUQUJMRSAiICsgZ2V0RnVsbE5hbWUoY29sc1tpXS5n\nZXRUYWJsZSgpLCBmYWxzZSkKICAgICAgICAgICAgICAgICsgIiBDSEFOR0Ug\nIiArIGNvbHNbaV0uZ2V0TmFtZSgpCiAgICAgICAgICAgICAgICArICIgIiAr\nIGNvbHNbaV0uZ2V0TmFtZSgpIC8vIG5hbWUgdHdpY2UKICAgICAgICAgICAg\nICAgICsgIiAiICsgZ2V0VHlwZU5hbWUoY29sc1tpXSkgKyAiIE5PVCBOVUxM\nIjsKICAgICAgICB9CgogICAgICAgIFN5c3RlbS5hcnJheWNvcHkoc3FsLCAw\nLCByZXQsIGNvbHMubGVuZ3RoLCBzcWwubGVuZ3RoKTsKICAgICAgICByZXR1\ncm4gcmV0OwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Rm9yZWln\nbktleUNvbnN0cmFpbnRTUUwoRm9yZWlnbktleSBmaykgewogICAgICAgIC8v\nIG15c3FsIGRvZXMgbm90IHN1cHBvcnQgY29tcG9zaXRlIGZvcmVpZ24ga2V5\ncwogICAgICAgIGlmIChmay5nZXRDb2x1bW5zKCkubGVuZ3RoID4gMSkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIHN1cGVyLmdl\ndEZvcmVpZ25LZXlDb25zdHJhaW50U1FMKGZrKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBhcHBlbmRTZWxlY3RSYW5nZShTUUxCdWZmZXIgYnVmLCBs\nb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAgIGJ1Zi5hcHBlbmQoIiBM\nSU1JVCAiKS5hcHBlbmRWYWx1ZShzdGFydCkuYXBwZW5kKCIsICIpOwogICAg\nICAgIGlmIChlbmQgPT0gTG9uZy5NQVhfVkFMVUUpCiAgICAgICAgICAgIGJ1\nZi5hcHBlbmRWYWx1ZShMb25nLk1BWF9WQUxVRSk7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBidWYuYXBwZW5kVmFsdWUoZW5kIC0gc3RhcnQpOwogICAg\nfQoKICAgIHByb3RlY3RlZCBDb2x1bW4gbmV3Q29sdW1uKFJlc3VsdFNldCBj\nb2xNZXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIENvbHVtbiBjb2wgPSBzdXBlci5uZXdDb2x1bW4oY29sTWV0YSk7CiAgICAg\nICAgaWYgKGNvbC5pc05vdE51bGwoKSAmJiAiMCIuZXF1YWxzKGNvbC5nZXRE\nZWZhdWx0U3RyaW5nKCkpKQogICAgICAgICAgICBjb2wuc2V0RGVmYXVsdFN0\ncmluZyhudWxsKTsKICAgICAgICByZXR1cm4gY29sOwogICAgfQoKICAgIHB1\nYmxpYyBPYmplY3QgZ2V0QmxvYk9iamVjdChSZXN1bHRTZXQgcnMsIGludCBj\nb2x1bW4sIEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAvLyBpZiB0aGUgdXNlciBoYXMgc2V0IGEgZ2V0\nLWJsb2Igc3RyYXRlZ3kgZXhwbGljaXRseSBvciB0aGUgZHJpdmVyCiAgICAg\nICAgLy8gZG9lcyBub3QgYXV0b21hdGljYWxseSBkZXNlcmlhbGl6ZSwgZGVs\nZWdhdGUgdG8gc3VwZXIKICAgICAgICBpZiAodXNlR2V0Qnl0ZXNGb3JCbG9i\ncyB8fCB1c2VHZXRPYmplY3RGb3JCbG9icwogICAgICAgICAgICB8fCAhZHJp\ndmVyRGVzZXJpYWxpemVzQmxvYnMpCiAgICAgICAgICAgIHJldHVybiBzdXBl\nci5nZXRCbG9iT2JqZWN0KHJzLCBjb2x1bW4sIHN0b3JlKTsKCiAgICAgICAg\nLy8gbW9zdCBteXNxbCBkcml2ZXJzIGRlc2VyaWFsaXplIG9uIGdldE9iamVj\ndAogICAgICAgIHJldHVybiBycy5nZXRPYmplY3QoY29sdW1uKTsKICAgIH0K\nCiAgICBwdWJsaWMgaW50IGdldFByZWZlcnJlZFR5cGUoaW50IHR5cGUpIHsK\nICAgICAgICBpZiAodHlwZSA9PSBUeXBlcy5DTE9CICYmICF1c2VDbG9icykK\nICAgICAgICAgICAgcmV0dXJuIFR5cGVzLkxPTkdWQVJDSEFSOwogICAgICAg\nIHJldHVybiBzdXBlci5nZXRQcmVmZXJyZWRUeXBlKHR5cGUpOwogICAgfQp9\nCg==\n","encoding":"base64"}

