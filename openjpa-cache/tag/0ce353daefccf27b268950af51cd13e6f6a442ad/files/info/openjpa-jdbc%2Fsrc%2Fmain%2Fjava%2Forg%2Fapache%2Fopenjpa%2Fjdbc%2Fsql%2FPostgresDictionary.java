{"sha":"86c9a78d0af1294eb3786e17513b80bbbcf77e56","node_id":"MDQ6QmxvYjIwNjM2NDo4NmM5YTc4ZDBhZjEyOTRlYjM3ODZlMTc1MTNiODBiYmJjZjc3ZTU2","size":14114,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/86c9a78d0af1294eb3786e17513b80bbbcf77e56","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0aW9u\nOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBq\nYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRp\nb247CmltcG9ydCBqYXZhLnNxbC5TdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnRl\neHQuUGFyc2VFeGNlcHRpb247CmltcG9ydCBqYXZhLnRleHQuU2ltcGxlRGF0\nZUZvcm1hdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZh\nLnV0aWwuRGF0ZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5r\nZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuU2VxdWVuY2U7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ0Nvbm5lY3Rpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ1ByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkxvY2FsaXplcjsKCi8qKgogKiBEaWN0aW9uYXJ5IGZvciBQb3N0Z3Jl\ncy4KICovCnB1YmxpYyBjbGFzcyBQb3N0Z3Jlc0RpY3Rpb25hcnkKICAgIGV4\ndGVuZHMgREJEaWN0aW9uYXJ5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAg\nICAgKFBvc3RncmVzRGljdGlvbmFyeS5jbGFzcyk7CgogICAgLyoqCiAgICAg\nKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgYWxsIHNlcXVlbmNlIHNjaGVtYSxu\nYW1lIHBhaXJzIGZyb20gYWxsIHNjaGVtYXMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTdHJpbmcgYWxsU2VxdWVuY2VzU1FMID0gIlNFTEVDVCBOVUxMIEFTIFNF\nUVVFTkNFX1NDSEVNQSwgcmVsbmFtZSAiICsKICAgICAgICAiQVMgU0VRVUVO\nQ0VfTkFNRSBGUk9NIHBnX2NsYXNzIFdIRVJFIHJlbGtpbmQ9J1MnIjsKCiAg\nICAvKioKICAgICAqIFNRTCBzdGF0ZW1lbnQgdG8gbG9hZCBzY2hlbWEsbmFt\nZSBwYWlycyBmb3IgYWxsIHNlcXVlbmNlcyB3aXRoIGEKICAgICAqIGNlcnRh\naW4gbmFtZSBmcm9tIGFsbCBzY2hlbWFzLgogICAgICovCiAgICBwdWJsaWMg\nU3RyaW5nIG5hbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNTUUwgPSAiU0VM\nRUNUIE5VTEwgQVMgIiArCiAgICAgICAgIlNFUVVFTkNFX1NDSEVNQSwgcmVs\nbmFtZSBBUyBTRVFVRU5DRV9OQU1FIEZST00gcGdfY2xhc3MgIiArCiAgICAg\nICAgIldIRVJFIHJlbGtpbmQ9J1MnIEFORCByZWxuYW1lID0gPyI7CgogICAg\nLyoqCiAgICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgc2NoZW1hLG5hbWUg\ncGFpcnMgZnJvbSBhIG5hbWVkIHNjaGVtYS4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBhbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FMID0gIlNFTEVD\nVCBOVUxMIEFTICIgKwogICAgICAgICJTRVFVRU5DRV9TQ0hFTUEsIHJlbG5h\nbWUgQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNzLCAiICsKICAgICAg\nICAicGdfbmFtZXNwYWNlIFdIRVJFIHJlbGtpbmQ9J1MnIEFORCBwZ19jbGFz\ncy5yZWxuYW1lc3BhY2UgPSAiICsKICAgICAgICAicGdfbmFtZXNwYWNlLm9p\nZCBBTkQgbnNwbmFtZSA9ID8iOwoKICAgIC8qKgogICAgICogU1FMIHN0YXRl\nbWVudCB0byBsb2FkIGEgc2VxdWVuY2UncyBzY2hlbWEsbmFtZSBwYWlyIGZy\nb20gb25lIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBuYW1l\nZFNlcXVlbmNlRnJvbU9uZVNjaGVtYVNRTCA9ICJTRUxFQ1QgTlVMTCBBUyAi\nICsKICAgICAgICAiU0VRVUVOQ0VfU0NIRU1BLCByZWxuYW1lIEFTIFNFUVVF\nTkNFX05BTUUgRlJPTSBwZ19jbGFzcywgIiArCiAgICAgICAgInBnX25hbWVz\ncGFjZSBXSEVSRSByZWxraW5kPSdTJyBBTkQgcGdfY2xhc3MucmVsbmFtZXNw\nYWNlID0gIiArCiAgICAgICAgInBnX25hbWVzcGFjZS5vaWQgQU5EIHJlbG5h\nbWUgPSA/IEFORCBuc3BuYW1lID0gPyI7CgogICAgLyoqCiAgICAgKiBTb21l\nIFBvc3RncmVzIGRyaXZlcnMgZG8gbm90IHN1cHBvcnQgdGhlIHtAbGluayBT\ndGF0ZW1lbnQjc2V0RmV0Y2hTaXplfQogICAgICogbWV0aG9kLgogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1NldEZldGNoU2l6ZSA9IHRy\ndWU7CgogICAgcHVibGljIFBvc3RncmVzRGljdGlvbmFyeSgpIHsKICAgICAg\nICBwbGF0Zm9ybSA9ICJQb3N0Z3JlU1FMIjsKICAgICAgICB2YWxpZGF0aW9u\nU1FMID0gIlNFTEVDVCBOT1coKSI7CiAgICAgICAgZGF0ZVByZWNpc2lvbiA9\nIENFTlRJOwogICAgICAgIHN1cHBvcnRzQWx0ZXJUYWJsZVdpdGhEcm9wQ29s\ndW1uID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNEZWZlcnJlZENvbnN0cmFp\nbnRzID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVjdFN0YXJ0SW5kZXgg\nPSB0cnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5kSW5kZXggPSB0cnVl\nOwoKICAgICAgICAvLyBQb3N0Z3JlU1FMIHJlcXVpcmVzIGRvdWJsZS1lc2Nh\ncGUgZm9yIHN0cmluZ3MKICAgICAgICBzZWFyY2hTdHJpbmdFc2NhcGUgPSAi\nXFxcXCI7CgogICAgICAgIG1heFRhYmxlTmFtZUxlbmd0aCA9IDMxOwogICAg\nICAgIG1heENvbHVtbk5hbWVMZW5ndGggPSAzMTsKICAgICAgICBtYXhJbmRl\neE5hbWVMZW5ndGggPSAzMTsKICAgICAgICBtYXhDb25zdHJhaW50TmFtZUxl\nbmd0aCA9IDMxOwogICAgICAgIHNjaGVtYUNhc2UgPSBTQ0hFTUFfQ0FTRV9M\nT1dFUjsKICAgICAgICByYW5nZVBvc2l0aW9uID0gUkFOR0VfUE9TVF9MT0NL\nOwogICAgICAgIHJlcXVpcmVzQWxpYXNGb3JTdWJzZWxlY3QgPSB0cnVlOwog\nICAgICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xhdXNlID0gZmFsc2U7CgogICAg\nICAgIC8vIHsyfSBpcyB0aGUgcmVzdWx0IG9mIGdldEdlbmVyYXRlZEtleVNl\ncXVlbmNlTmFtZTsgdGhlCiAgICAgICAgLy8gc2luZ2xlLXF1b3RlIGVzY2Fw\nZSB3aWxsIHJlc3VsdCBpbiBTRUxFQ1QgQ1VSVkFMKCdteXNlcXVlbmNlJykK\nICAgICAgICBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSAiU0VMRUNUIENVUlJW\nQUwoJyd7Mn0nJykiOwogICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9IHRy\ndWU7CiAgICAgICAgYXV0b0Fzc2lnblR5cGVOYW1lID0gIkJJR1NFUklBTCI7\nCiAgICAgICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwo\nJyd7MH0nJykiOwoKICAgICAgICB1c2VHZXRCeXRlc0ZvckJsb2JzID0gdHJ1\nZTsKICAgICAgICB1c2VTZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsKICAgICAg\nICB1c2VHZXRTdHJpbmdGb3JDbG9icyA9IHRydWU7CiAgICAgICAgdXNlU2V0\nU3RyaW5nRm9yQ2xvYnMgPSB0cnVlOwogICAgICAgIGJpdFR5cGVOYW1lID0g\nIkJPT0wiOwogICAgICAgIHNtYWxsaW50VHlwZU5hbWUgPSAiU01BTExJTlQi\nOwogICAgICAgIHJlYWxUeXBlTmFtZSA9ICJGTE9BVDgiOwogICAgICAgIHRp\nbnlpbnRUeXBlTmFtZSA9ICJTTUFMTElOVCI7CiAgICAgICAgYmluYXJ5VHlw\nZU5hbWUgPSAiQllURUEiOwogICAgICAgIGJsb2JUeXBlTmFtZSA9ICJCWVRF\nQSI7CiAgICAgICAgbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0gIkJZVEVBIjsK\nICAgICAgICB2YXJiaW5hcnlUeXBlTmFtZSA9ICJCWVRFQSI7CiAgICAgICAg\nY2xvYlR5cGVOYW1lID0gIlRFWFQiOwogICAgICAgIGxvbmdWYXJjaGFyVHlw\nZU5hbWUgPSAiVEVYVCI7CiAgICAgICAgZG91YmxlVHlwZU5hbWUgPSAiRE9V\nQkxFIFBSRUNJU0lPTiI7CiAgICAgICAgdmFyY2hhclR5cGVOYW1lID0gIlZB\nUkNIQVJ7MH0iOwogICAgICAgIHRpbWVzdGFtcFR5cGVOYW1lID0gIkFCU1RJ\nTUUiOwogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFsbChBcnJh\neXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkJPT0wiLCAi\nQllURUEiLCAiTkFNRSIsICJJTlQ4IiwgIklOVDIiLCAiSU5UMlZFQ1RPUiIs\nICJJTlQ0IiwKICAgICAgICAgICAgIlJFR1BST0MiLCAiVEVYVCIsICJPSUQi\nLCAiVElEIiwgIlhJRCIsICJDSUQiLCAiT0lEVkVDVE9SIiwKICAgICAgICAg\nICAgIlNFVCIsICJGTE9BVDQiLCAiRkxPQVQ4IiwgIkFCU1RJTUUiLCAiUkVM\nVElNRSIsICJUSU5URVJWQUwiLAogICAgICAgICAgICAiTU9ORVkiLAogICAg\nICAgIH0pKTsKCiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aERpc3RpbmN0\nQ2xhdXNlID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aE91\ndGVySm9pbiA9IGZhbHNlOwogICAgICAgIHN1cHBvcnRzTnVsbFRhYmxlRm9y\nR2V0SW1wb3J0ZWRLZXlzID0gdHJ1ZTsKCiAgICAgICAgcmVzZXJ2ZWRXb3Jk\nU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAg\nICAgICAgIkFCT1JUIiwgIkFDTCIsICJBR0dSRUdBVEUiLCAiQVBQRU5EIiwg\nIkFSQ0hJVkUiLCAiQVJDSF9TVE9SRSIsCiAgICAgICAgICAgICJCQUNLV0FS\nRCIsICJCSU5BUlkiLCAiQ0hBTkdFIiwgIkNMVVNURVIiLCAiQ09QWSIsICJE\nQVRBQkFTRSIsCiAgICAgICAgICAgICJERUxJTUlURVIiLCAiREVMSU1JVEVS\nUyIsICJETyIsICJFWFBMQUlOIiwgIkVYVEVORCIsCiAgICAgICAgICAgICJG\nT1JXQVJEIiwgIkhFQVZZIiwgIklOREVYIiwgIklOSEVSSVRTIiwgIklTTlVM\nTCIsICJMSUdIVCIsCiAgICAgICAgICAgICJMSVNURU4iLCAiTE9BRCIsICJN\nRVJHRSIsICJOT1RISU5HIiwgIk5PVElGWSIsICJOT1ROVUxMIiwKICAgICAg\nICAgICAgIk9JRCIsICJPSURTIiwgIlBVUkdFIiwgIlJFQ0lQRSIsICJSRU5B\nTUUiLCAiUkVQTEFDRSIsCiAgICAgICAgICAgICJSRVRSSUVWRSIsICJSRVRV\nUk5TIiwgIlJVTEUiLCAiU0VUT0YiLCAiU1RESU4iLCAiU1RET1VUIiwKICAg\nICAgICAgICAgIlNUT1JFIiwgIlZBQ1VVTSIsICJWRVJCT1NFIiwgIlZFUlNJ\nT04iLAogICAgICAgIH0pKTsKICAgIH0KCiAgICBwdWJsaWMgRGF0ZSBnZXRE\nYXRlKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1\ncm4gc3VwZXIuZ2V0RGF0ZShycywgY29sdW1uKTsKICAgICAgICB9IGNhdGNo\nIChTdHJpbmdJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIHNpb29iZSkgewog\nICAgICAgICAgICAvLyB0aGVyZSBpcyBhIGJ1ZyBpbiBzb21lIHZlcnNpb25z\nIG9mIHRoZSBwb3N0Z3JlcyBKREJDCiAgICAgICAgICAgIC8vIGRyaXZlciBz\ndWNoIHRoYXQgYSBkYXRlIHdpdGggbm90IGVub3VnaCBudW1iZXJzIGluIGl0\nCiAgICAgICAgICAgIC8vIHdpbGwgdGhyb3cgYSBwYXJzaW5nIGV4Y2VwdGlv\nbjogdGhpcyB0cmllcyB0byB3b3JrCiAgICAgICAgICAgIC8vIGFyb3VuZCBp\ndC4gVGhlIGJ1ZyBvbmx5IG9jY3VycyB3aGVuIHRoZXJlIGlzIGEgdHJhaWxp\nbmcKICAgICAgICAgICAgLy8gbWlsbGlzZWNvbmQgbWlzc2luZyBmcm9tIHRo\nZSBlbmQuIEUuZy4sIHdoZW4gdGhlIGRhdGUgaXMKICAgICAgICAgICAgLy8g\nbGlrZToKICAgICAgICAgICAgLy8gMjA2Ni0xMC0xOSAyMjowODozMi44Mwog\nICAgICAgICAgICAvLyByYXRoZXIgdGhhbiB3aGF0IHRoZSBkcml2ZXIgZXhw\nZWN0czoKICAgICAgICAgICAgLy8gMjA2Ni0xMC0xOSAyMjowODozMi44MzAK\nICAgICAgICAgICAgU3RyaW5nIGRhdGVTdHIgPSBycy5nZXRTdHJpbmcoY29s\ndW1uKTsKICAgICAgICAgICAgU2ltcGxlRGF0ZUZvcm1hdCBmbXQgPSBuZXcg\nU2ltcGxlRGF0ZUZvcm1hdCgKICAgICAgICAgICAgICAgICJ5eXl5LU1NLWRk\nIGhoOm1tOnNzLlNTIik7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICByZXR1cm4gZm10LnBhcnNlKGRhdGVTdHIpOwogICAgICAgICAgICB9\nIGNhdGNoIChQYXJzZUV4Y2VwdGlvbiBwZSkgewogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihwZS50b1N0cmluZygpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYnl0ZSBnZXRC\neXRlKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBwb3N0Z3JlcyBkb2VzIG5vdCBw\nZXJmb3JtIGF1dG9tYXRpYyBjb252ZXJzaW9ucywgc28gYXR0ZW1wdGluZyB0\nbwogICAgICAgIC8vIGdldCBhIHdob2xlIG51bWJlciBvdXQgb2YgYSBkZWNp\nbWFsIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLgogICAgICAgIC8vIGZhbGwg\nYmFjayB0byBwZXJmb3JtaW5nIG1hbnVhbCBjb252ZXJzaW9uIGlmIHRoZSBp\nbml0aWFsIGdldCBmYWlscwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJl\ndHVybiBzdXBlci5nZXRCeXRlKHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0\nY2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBz\ndXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLmJ5dGVWYWx1ZSgpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc2hvcnQgZ2V0U2hvcnQoUmVz\ndWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIC8vIHBvc3RncmVzIGRvZXMgbm90IHBlcmZvcm0g\nYXV0b21hdGljIGNvbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5nIHRvCiAgICAg\nICAgLy8gZ2V0IGEgd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRlY2ltYWwgd2ls\nbCB0aHJvdyBhbiBleGNlcHRpb24uCiAgICAgICAgLy8gZmFsbCBiYWNrIHRv\nIHBlcmZvcm1pbmcgbWFudWFsIGNvbnZlcnNpb24gaWYgdGhlIGluaXRpYWwg\nZ2V0IGZhaWxzCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldFNob3J0KHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5n\nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLnNob3J0VmFsdWUoKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIGludCBnZXRJbnQoUmVzdWx0U2V0IHJz\nLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIC8vIHBvc3RncmVzIGRvZXMgbm90IHBlcmZvcm0gYXV0b21hdGlj\nIGNvbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5nIHRvCiAgICAgICAgLy8gZ2V0\nIGEgd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRlY2ltYWwgd2lsbCB0aHJvdyBh\nbiBleGNlcHRpb24uCiAgICAgICAgLy8gZmFsbCBiYWNrIHRvIHBlcmZvcm1p\nbmcgbWFudWFsIGNvbnZlcnNpb24gaWYgdGhlIGluaXRpYWwgZ2V0IGZhaWxz\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldElu\ndChycywgY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24g\nc3FsZSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0QmlnRGVjaW1h\nbChycywgY29sdW1uKS5pbnRWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgbG9uZyBnZXRMb25nKFJlc3VsdFNldCBycywgaW50IGNvbHVt\nbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBw\nb3N0Z3JlcyBkb2VzIG5vdCBwZXJmb3JtIGF1dG9tYXRpYyBjb252ZXJzaW9u\ncywgc28gYXR0ZW1wdGluZyB0bwogICAgICAgIC8vIGdldCBhIHdob2xlIG51\nbWJlciBvdXQgb2YgYSBkZWNpbWFsIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9u\nLgogICAgICAgIC8vIGZhbGwgYmFjayB0byBwZXJmb3JtaW5nIG1hbnVhbCBj\nb252ZXJzaW9uIGlmIHRoZSBpbml0aWFsIGdldCBmYWlscwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRMb25nKHJzLCBjb2x1\nbW4pOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAg\nICAgICAgICAgIHJldHVybiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1\nbW4pLmxvbmdWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRCb29sZWFuKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQg\naWR4LCBib29sZWFuIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3RncmVzIGFj\ndHVhbGx5IHJlcXVpcmVzIHRoYXQgYSBib29sZWFuIGJlIHNldDogaXQgY2Fu\nbm90CiAgICAgICAgLy8gaGFuZGxlIGEgbnVtZXJpYyBhcmd1bWVudC4KICAg\nICAgICBzdG1udC5zZXRCb29sZWFuKGlkeCwgdmFsKTsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgdm9pZCBhcHBlbmRTZWxlY3RSYW5nZShTUUxCdWZmZXIgYnVm\nLCBsb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAgIGlmIChlbmQgIT0g\nTG9uZy5NQVhfVkFMVUUpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBMSU1J\nVCAiKS5hcHBlbmRWYWx1ZShlbmQgLSBzdGFydCk7CiAgICAgICAgaWYgKHN0\nYXJ0ICE9IDApCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBPRkZTRVQgIiku\nYXBwZW5kVmFsdWUoc3RhcnQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGlu\nZGV4T2YoU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0ZXJW\nYWx1ZSBmaW5kLAogICAgICAgIEZpbHRlclZhbHVlIHN0YXJ0KSB7CiAgICAg\nICAgYnVmLmFwcGVuZCgiKFBPU0lUSU9OKCIpOwogICAgICAgIGZpbmQuYXBw\nZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCIgSU4gIik7CiAgICAg\nICAgaWYgKHN0YXJ0ICE9IG51bGwpCiAgICAgICAgICAgIHN1YnN0cmluZyhi\ndWYsIHN0ciwgc3RhcnQsIG51bGwpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgc3RyLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgiKSAt\nIDEiKTsKICAgICAgICBpZiAoc3RhcnQgIT0gbnVsbCkgewogICAgICAgICAg\nICBidWYuYXBwZW5kKCIgKyAiKTsKICAgICAgICAgICAgc3RhcnQuYXBwZW5k\nVG8oYnVmKTsKICAgICAgICB9CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVTZXF1ZW5jZVNR\nTChTZXF1ZW5jZSBzZXEpIHsKICAgICAgICBTdHJpbmdbXSBzcWwgPSBzdXBl\nci5nZXRDcmVhdGVTZXF1ZW5jZVNRTChzZXEpOwogICAgICAgIGlmIChzZXEu\nZ2V0QWxsb2NhdGUoKSA+IDEpCiAgICAgICAgICAgIHNxbFswXSArPSAiIENB\nQ0hFICIgKyBzZXEuZ2V0QWxsb2NhdGUoKTsKICAgICAgICByZXR1cm4gc3Fs\nOwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0U2VxdWVuY2VzU1FM\nKFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgc2VxdWVuY2VOYW1lKSB7CiAg\nICAgICAgaWYgKHNjaGVtYU5hbWUgPT0gbnVsbCAmJiBzZXF1ZW5jZU5hbWUg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGFsbFNlcXVlbmNlc1NRTDsK\nICAgICAgICBlbHNlIGlmIChzY2hlbWFOYW1lID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBuYW1lZFNlcXVlbmNlc0Zyb21BbGxTY2hlbWFzU1FMOwog\nICAgICAgIGVsc2UgaWYgKHNlcXVlbmNlTmFtZSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gYWxsU2VxdWVuY2VzRnJvbU9uZVNjaGVtYVNRTDsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBuYW1lZFNlcXVlbmNlRnJv\nbU9uZVNjaGVtYVNRTDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N5\nc3RlbVNlcXVlbmNlKFN0cmluZyBuYW1lLCBTdHJpbmcgc2NoZW1hLAogICAg\nICAgIGJvb2xlYW4gdGFyZ2V0U2NoZW1hKSB7CiAgICAgICAgaWYgKHN1cGVy\nLmlzU3lzdGVtU2VxdWVuY2UobmFtZSwgc2NoZW1hLCB0YXJnZXRTY2hlbWEp\nKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgLy8gZmlsdGVy\nIG91dCBnZW5lcmF0ZWQgc2VxdWVuY2VzIHVzZWQgZm9yIGJpZ3NlcmlhbCBj\nb2xzLCB3aGljaCBhcmUKICAgICAgICAvLyBvZiB0aGUgZm9ybSA8dGFibGU+\nXzxjb2w+X3NlcQogICAgICAgIGludCBpZHggPSBuYW1lLmluZGV4T2YoJ18n\nKTsKICAgICAgICByZXR1cm4gaWR4ICE9IC0xICYmIGlkeCAhPSBuYW1lLmxl\nbmd0aCgpIC0gNAogICAgICAgICAgICAmJiBuYW1lLnRvVXBwZXJDYXNlKCku\nZW5kc1dpdGgoIl9TRVEiKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc1N5c3RlbVRhYmxlKFN0cmluZyBuYW1lLCBTdHJpbmcgc2NoZW1hLAogICAg\nICAgIGJvb2xlYW4gdGFyZ2V0U2NoZW1hKSB7CiAgICAgICAgLy8gbmFtZXMg\nc3RhcnRpbmcgd2l0aCAicGdfIiBhcmUgcmVzZXJ2ZWQgZm9yIFBvc3RncmVz\ncWwgaW50ZXJuYWwgdXNlCiAgICAgICAgcmV0dXJuIHN1cGVyLmlzU3lzdGVt\nVGFibGUobmFtZSwgc2NoZW1hLCB0YXJnZXRTY2hlbWEpCiAgICAgICAgICAg\nIHx8IChuYW1lICE9IG51bGwgJiYgbmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0\nc1dpdGgoInBnXyIpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N5\nc3RlbUluZGV4KFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAg\nIC8vIG5hbWVzIHN0YXJ0aW5nIHdpdGggInBnXyIgYXJlIHJlc2VydmVkIGZv\nciBQb3N0Z3Jlc3FsIGludGVybmFsIHVzZQogICAgICAgIHJldHVybiBzdXBl\nci5pc1N5c3RlbUluZGV4KG5hbWUsIHRhYmxlKQogICAgICAgICAgICB8fCAo\nbmFtZSAhPSBudWxsICYmIG5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRo\nKCJwZ18iKSk7CiAgICB9CgogICAgcHVibGljIENvbm5lY3Rpb24gZGVjb3Jh\ndGUoQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHJldHVybiBuZXcgUG9zdGdyZXNDb25uZWN0aW9uKHN1\ncGVyLmRlY29yYXRlKGNvbm4pLCB0aGlzKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENvbm5lY3Rpb24gd3JhcHBlciB0byB3b3JrIGFyb3VuZCB0aGUgcG9z\ndGdyZXMgZW1wdHkgcmVzdWx0IHNldCBidWcuCiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIGNsYXNzIFBvc3RncmVzQ29ubmVjdGlvbgogICAgICAgIGV4\ndGVuZHMgRGVsZWdhdGluZ0Nvbm5lY3Rpb24gewoKICAgICAgICBwcml2YXRl\nIGZpbmFsIFBvc3RncmVzRGljdGlvbmFyeSBfZGljdDsKCiAgICAgICAgcHVi\nbGljIFBvc3RncmVzQ29ubmVjdGlvbihDb25uZWN0aW9uIGNvbm4sIFBvc3Rn\ncmVzRGljdGlvbmFyeSBkaWN0KSB7CiAgICAgICAgICAgIHN1cGVyKGNvbm4p\nOwogICAgICAgICAgICBfZGljdCA9IGRpY3Q7CiAgICAgICAgfQoKICAgICAg\nICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVu\ndChTdHJpbmcgc3FsLCBib29sZWFuIHdyYXApCiAgICAgICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gbmV3IFBvc3Rn\ncmVzUHJlcGFyZWRTdGF0ZW1lbnQoc3VwZXIucHJlcGFyZVN0YXRlbWVudAog\nICAgICAgICAgICAgICAgKHNxbCwgZmFsc2UpLCB0aGlzLCBfZGljdCk7CiAg\nICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQg\ncHJlcGFyZVN0YXRlbWVudChTdHJpbmcgc3FsLCBpbnQgcnNUeXBlLAogICAg\nICAgICAgICBpbnQgcnNDb25jdXIsIGJvb2xlYW4gd3JhcCkKICAgICAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBu\nZXcgUG9zdGdyZXNQcmVwYXJlZFN0YXRlbWVudChzdXBlci5wcmVwYXJlU3Rh\ndGVtZW50CiAgICAgICAgICAgICAgICAoc3FsLCByc1R5cGUsIHJzQ29uY3Vy\nLCBmYWxzZSksIHRoaXMsIF9kaWN0KTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTdGF0ZW1lbnQgd3JhcHBlciB0byB3b3JrIGFyb3VuZCB0\naGUgcG9zdGdyZXMgZW1wdHkgcmVzdWx0IHNldCBidWcuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGNsYXNzIFBvc3RncmVzUHJlcGFyZWRTdGF0ZW1l\nbnQKICAgICAgICBleHRlbmRzIERlbGVnYXRpbmdQcmVwYXJlZFN0YXRlbWVu\ndCB7CgogICAgICAgIHByaXZhdGUgZmluYWwgUG9zdGdyZXNEaWN0aW9uYXJ5\nIF9kaWN0OwoKICAgICAgICBwdWJsaWMgUG9zdGdyZXNQcmVwYXJlZFN0YXRl\nbWVudChQcmVwYXJlZFN0YXRlbWVudCBwcywKICAgICAgICAgICAgQ29ubmVj\ndGlvbiBjb25uLCBQb3N0Z3Jlc0RpY3Rpb25hcnkgZGljdCkgewogICAgICAg\nICAgICBzdXBlcihwcywgY29ubik7CiAgICAgICAgICAgIF9kaWN0ID0gZGlj\ndDsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhl\nY3V0ZVF1ZXJ5KGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICByZXR1cm4gc3VwZXIuZXhlY3V0ZVF1ZXJ5KHdyYXApOwogICAgICAgICAg\nICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAg\nIC8vIHdlIG5lZWQgdG8gbWFrZSBvdXIgYmVzdCBndWVzcyB3aGV0aGVyIHRo\naXMgaXMgdGhlIGVtcHR5CiAgICAgICAgICAgICAgICAvLyBSZXN1bHRTZXQg\nYnVnLCBzaW5jZSB0aGlzIGV4Y2VwdGlvbiBjb3VsZCBvY2N1cgogICAgICAg\nICAgICAgICAgLy8gZm9yIG90aGVyIHJlYXNvbnMgKGxpa2UgYW4gaW52YWxp\nZCBxdWVyeSBzdHJpbmcpLiBOb3RlCiAgICAgICAgICAgICAgICAvLyB0aGF0\nIFBvc3RncmVzIGVycm9yIG1lc3NhZ2VzIGFyZSBsb2NhbGl6ZWQsIHNvIHdl\nCiAgICAgICAgICAgICAgICAvLyBjYW5ub3QganVzdCBwYXJzZSB0aGUgZXhj\nZXB0aW9uIFN0cmluZy4KICAgICAgICAgICAgICAgIFJlc3VsdFNldCBycyA9\nIGdldFJlc3VsdFNldCh3cmFwKTsKCiAgICAgICAgICAgICAgICAvLyBSZXN1\nbHRTZXQgc2hvdWxkIGJlIGVtcHR5OiBpZiBub3QsIHRoZW4gbWF5YmUgYW4K\nICAgICAgICAgICAgICAgIC8vIGFjdHVhbCBlcnJvciBvY2N1cmVkCiAgICAg\nICAgICAgICAgICBpZiAocnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBzZTsKCiAgICAgICAgICAgICAgICByZXR1cm4gcnM7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEZl\ndGNoU2l6ZShpbnQgaSkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIC8vIHNvbWUgcG9zdGdyZXMgZHJpdmVycyBkbyBu\nb3Qgc3VwcG9ydCB0aGUgc2V0RmV0Y2hTaXplIG1ldGhvZAogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgaWYgKF9kaWN0LnN1cHBvcnRzU2V0\nRmV0Y2hTaXplKQogICAgICAgICAgICAgICAgICAgIHN1cGVyLnNldEZldGNo\nU2l6ZShpKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIF9kaWN0LnN1cHBvcnRzU2V0RmV0Y2hTaXpl\nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAoX2RpY3QubG9nLmlzV2Fy\nbkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfZGljdC5sb2cud2Fy\nbihfbG9jLmdldCgicHNxbC1uby1zZXQtZmV0Y2gtc2l6ZSIpLCBlKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

