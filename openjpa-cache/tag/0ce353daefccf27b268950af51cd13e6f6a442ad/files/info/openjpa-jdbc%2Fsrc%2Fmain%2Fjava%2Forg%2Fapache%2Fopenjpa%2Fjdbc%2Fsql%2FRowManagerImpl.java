{"sha":"22746bfad4567f8f1d758f69c9e59a60bbad7bab","node_id":"MDQ6QmxvYjIwNjM2NDoyMjc0NmJmYWQ0NTY3ZjhmMWQ3NThmNjljOWU1OWE2MGJiYWQ3YmFi","size":7465,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/22746bfad4567f8f1d758f69c9e59a60bbad7bab","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRp\nb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsKCi8q\nKgogKiBNYW5hZ2VzIFNRTCByb3dzIGR1cmluZyBhbiBpbnNlcnQvdXBkYXRl\nL2RlbGV0ZSBwcm9jZXNzLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBA\nbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgUm93TWFuYWdlckltcGwKICAg\nIGltcGxlbWVudHMgUm93TWFuYWdlciB7CgogICAgcHJpdmF0ZSBNYXAgX2lu\nc2VydHMgPSBudWxsOwogICAgcHJpdmF0ZSBNYXAgX3VwZGF0ZXMgPSBudWxs\nOwogICAgcHJpdmF0ZSBNYXAgX2RlbGV0ZXMgPSBudWxsOwogICAgcHJpdmF0\nZSBDb2xsZWN0aW9uIF9zZWNvbmRhcnlVcGRhdGVzID0gbnVsbDsKICAgIHBy\naXZhdGUgQ29sbGVjdGlvbiBfc2Vjb25kYXJ5RGVsZXRlcyA9IG51bGw7CiAg\nICBwcml2YXRlIENvbGxlY3Rpb24gX2FsbFJvd1VwZGF0ZXMgPSBudWxsOwog\nICAgcHJpdmF0ZSBDb2xsZWN0aW9uIF9hbGxSb3dEZWxldGVzID0gbnVsbDsK\nCiAgICAvLyB3ZSBtYWludGFpbiBhIGxpc3Qgb2YgdGhlIG9yZGVyIG9mIGFs\nbCBwcmltYXJ5IHJvd3MgaWYgdGhlIHVzZXIKICAgIC8vIHdhbnRzIHRvIGJl\nIGFibGUgdG8gZmV0Y2ggdGhlbSBpbiBvcmRlcgogICAgcHJpdmF0ZSBmaW5h\nbCBMaXN0IF9wcmltYXJ5T3JkZXI7CgogICAgLy8gdHJhY2sgd2hldGhlciB3\nZSdyZSBkZWFsaW5nIHdpdGggYW55IGF1dG8taW5jIGNvbHVtbnMKICAgIHBy\naXZhdGUgYm9vbGVhbiBfYXV0byA9IGZhbHNlOwoKICAgIC8vIGNhY2hlIHRo\nZSBsYXN0IGtleSBhbmQgcHJpbWFyeSByb3c7IHdoZW4gbG9vcGluZyBvdmVy\nCiAgICAvLyBhbGwgdGhlIGZpZWxkIG1hcHBpbmdzIG9mIGEgY2xhc3MgZWFj\naCBvbmUgd2lsbCBwcm9iYWJseSBhc2sgZm9yIHRoZQogICAgLy8gc2FtZSBr\nZXksIHNvIGF2b2lkIHRoZSBrZXkgY3JlYXRpb24gYW5kIHJvdyBsb29rdXAg\nd2hlbiBwb3NzaWJsZQogICAgcHJpdmF0ZSBLZXkgX2tleSA9IG51bGw7CiAg\nICBwcml2YXRlIFByaW1hcnlSb3cgX3JvdyA9IG51bGw7CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3Rvci4KICAgICAqCiAgICAgKiBAcGFyYW0gb3JkZXIg\nd2hldGhlciB0byBrZWVwIHRyYWNrIG9mIHRoZSBvcmRlciBpbiB3aGljaCBy\nb3dzIGFyZSBhZGRlZAogICAgICovCiAgICBwdWJsaWMgUm93TWFuYWdlcklt\ncGwoYm9vbGVhbiBvcmRlcikgewogICAgICAgIF9wcmltYXJ5T3JkZXIgPSAo\nb3JkZXIpID8gbmV3IEFycmF5TGlzdCgpIDogbnVsbDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgYW55IHByaW1hcnkgcm93cyBoYXZlIGF1dG8t\nYXNzaWduIGNvbnN0cmFpbnRzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBoYXNBdXRvQXNzaWduQ29uc3RyYWludHMoKSB7CiAgICAgICAgcmV0dXJu\nIF9hdXRvOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBvcmRl\ncmVkIHByaW1hcnkgcm93cy4gT25seSBhdmFpbGFibGUgaWYgb3JkZXJpbmcg\ncmVxdWVzdGVkCiAgICAgKiBvbiBjb25zdHJ1Y3Rpb24uCiAgICAgKi8KICAg\nIHB1YmxpYyBMaXN0IGdldE9yZGVyZWQoKSB7CiAgICAgICAgcmV0dXJuIChf\ncHJpbWFyeU9yZGVyID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElT\nVCA6IF9wcmltYXJ5T3JkZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gYWxsIGluc2VydGVkIHByaW1hcnkgcm93cy4KICAgICAqLwogICAgcHVi\nbGljIENvbGxlY3Rpb24gZ2V0SW5zZXJ0cygpIHsKICAgICAgICByZXR1cm4g\nKF9pbnNlcnRzID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVCA6\nIF9pbnNlcnRzLnZhbHVlcygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGFsbCB1cGRhdGVkIHByaW1hcnkgcm93cy4KICAgICAqLwogICAgcHVi\nbGljIENvbGxlY3Rpb24gZ2V0VXBkYXRlcygpIHsKICAgICAgICByZXR1cm4g\nKF91cGRhdGVzID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVCA6\nIF91cGRhdGVzLnZhbHVlcygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGFsbCBkZWxldGVkIHByaW1hcnkgcm93cy4KICAgICAqLwogICAgcHVi\nbGljIENvbGxlY3Rpb24gZ2V0RGVsZXRlcygpIHsKICAgICAgICByZXR1cm4g\nKF9kZWxldGVzID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVCA6\nIF9kZWxldGVzLnZhbHVlcygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGFsbCBpbnNlcnRlZCBhbmQgdXBkYXRlZCBzZWNvbmRhcnkgcm93cy4K\nICAgICAqLwogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0U2Vjb25kYXJ5VXBk\nYXRlcygpIHsKICAgICAgICByZXR1cm4gKF9zZWNvbmRhcnlVcGRhdGVzID09\nIG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVAogICAgICAgICAgICA6\nIF9zZWNvbmRhcnlVcGRhdGVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGFsbCBkZWxldGVkIHNlY29uZGFyeSByb3dzLgogICAgICovCiAgICBw\ndWJsaWMgQ29sbGVjdGlvbiBnZXRTZWNvbmRhcnlEZWxldGVzKCkgewogICAg\nICAgIHJldHVybiAoX3NlY29uZGFyeURlbGV0ZXMgPT0gbnVsbCkgPyBDb2xs\nZWN0aW9ucy5FTVBUWV9MSVNUCiAgICAgICAgICAgIDogX3NlY29uZGFyeURl\nbGV0ZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW55ICdhbGwg\ncm93JyB1cGRhdGVzLgogICAgICovCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBn\nZXRBbGxSb3dVcGRhdGVzKCkgewogICAgICAgIHJldHVybiAoX2FsbFJvd1Vw\nZGF0ZXMgPT0gbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUCiAgICAg\nICAgICAgIDogX2FsbFJvd1VwZGF0ZXM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYW55ICdhbGwgcm93JyBkZWxldGVzLgogICAgICovCiAgICBw\ndWJsaWMgQ29sbGVjdGlvbiBnZXRBbGxSb3dEZWxldGVzKCkgewogICAgICAg\nIHJldHVybiAoX2FsbFJvd0RlbGV0ZXMgPT0gbnVsbCkgPyBDb2xsZWN0aW9u\ncy5FTVBUWV9MSVNUCiAgICAgICAgICAgIDogX2FsbFJvd0RlbGV0ZXM7CiAg\nICB9CgogICAgcHVibGljIFJvdyBnZXRTZWNvbmRhcnlSb3coVGFibGUgdGFi\nbGUsIGludCBhY3Rpb24pIHsKICAgICAgICByZXR1cm4gbmV3IFNlY29uZGFy\neVJvdyh0YWJsZSwgYWN0aW9uKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBm\nbHVzaFNlY29uZGFyeVJvdyhSb3cgcm93KQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmICghcm93LmlzVmFsaWQoKSkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICBTZWNvbmRhcnlSb3cgc3JvdyA9IChT\nZWNvbmRhcnlSb3cpIHJvdzsKICAgICAgICBpZiAoc3Jvdy5nZXRBY3Rpb24o\nKSA9PSBSb3cuQUNUSU9OX0RFTEVURSkgewogICAgICAgICAgICBpZiAoX3Nl\nY29uZGFyeURlbGV0ZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zZWNv\nbmRhcnlEZWxldGVzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICBf\nc2Vjb25kYXJ5RGVsZXRlcy5hZGQoc3Jvdy5jbG9uZSgpKTsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICBpZiAoX3NlY29uZGFyeVVwZGF0ZXMgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF9zZWNvbmRhcnlVcGRhdGVzID0gbmV3\nIEFycmF5TGlzdCgpOwogICAgICAgICAgICBfc2Vjb25kYXJ5VXBkYXRlcy5h\nZGQoc3Jvdy5jbG9uZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIFJvdyBnZXRBbGxSb3dzKFRhYmxlIHRhYmxlLCBpbnQgYWN0aW9uKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBSb3dJbXBsKHRhYmxlLCBhY3Rpb24pOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGZsdXNoQWxsUm93cyhSb3cgcm93KSB7CiAg\nICAgICAgaWYgKCFyb3cuaXNWYWxpZCgpKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIHN3aXRjaCAocm93LmdldEFjdGlvbigpKSB7CiAgICAgICAg\nICAgIGNhc2UgUm93LkFDVElPTl9VUERBVEU6CiAgICAgICAgICAgICAgICBp\nZiAoX2FsbFJvd1VwZGF0ZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICBfYWxsUm93VXBkYXRlcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAg\nICAgICAgIF9hbGxSb3dVcGRhdGVzLmFkZChyb3cpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgUm93LkFDVElPTl9ERUxFVEU6\nCiAgICAgICAgICAgICAgICBpZiAoX2FsbFJvd0RlbGV0ZXMgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBfYWxsUm93RGVsZXRlcyA9IG5ldyBBcnJh\neUxpc3QoKTsKICAgICAgICAgICAgICAgIF9hbGxSb3dEZWxldGVzLmFkZChy\nb3cpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1\nbHQ6CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRp\nb24oImFjdGlvbiA9ICIgKyByb3cuZ2V0QWN0aW9uKCkpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgUm93IGdldFJvdyhUYWJsZSB0YWJsZSwgaW50\nIGFjdGlvbiwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAgICBib29s\nZWFuIGNyZWF0ZSkgewogICAgICAgIGlmIChzbSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8gY2hlY2sgaWYgcmVxdWVz\ndCBtYXRjaGVzIGNhY2hlZCB2ZXJzaW9uCiAgICAgICAgaWYgKF9rZXkgIT0g\nbnVsbCAmJiBfa2V5LnRhYmxlID09IHRhYmxlICYmIF9rZXkuc20gPT0gc20K\nICAgICAgICAgICAgJiYgX3JvdyAhPSBudWxsICYmIF9yb3cuZ2V0QWN0aW9u\nKCkgPT0gYWN0aW9uKQogICAgICAgICAgICByZXR1cm4gX3JvdzsKCiAgICAg\nICAgTWFwIG1hcDsKICAgICAgICBpZiAoYWN0aW9uID09IFJvdy5BQ1RJT05f\nREVMRVRFKSB7CiAgICAgICAgICAgIGlmIChfZGVsZXRlcyA9PSBudWxsICYm\nIGNyZWF0ZSkKICAgICAgICAgICAgICAgIF9kZWxldGVzID0gbmV3IEhhc2hN\nYXAoKTsKICAgICAgICAgICAgbWFwID0gX2RlbGV0ZXM7CiAgICAgICAgfSBl\nbHNlIGlmIChhY3Rpb24gPT0gUm93LkFDVElPTl9JTlNFUlQpIHsKICAgICAg\nICAgICAgaWYgKF9pbnNlcnRzID09IG51bGwgJiYgY3JlYXRlKQogICAgICAg\nICAgICAgICAgX2luc2VydHMgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgICAg\nICBtYXAgPSBfaW5zZXJ0czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICBpZiAoX3VwZGF0ZXMgPT0gbnVsbCAmJiBjcmVhdGUpCiAgICAgICAgICAg\nICAgICBfdXBkYXRlcyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgIG1h\ncCA9IF91cGRhdGVzOwogICAgICAgIH0KICAgICAgICBpZiAobWFwID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBfa2V5ID0g\nbmV3IEtleSh0YWJsZSwgc20pOwogICAgICAgIF9yb3cgPSAoUHJpbWFyeVJv\ndykgbWFwLmdldChfa2V5KTsKCiAgICAgICAgaWYgKF9yb3cgPT0gbnVsbCAm\nJiBjcmVhdGUpIHsKICAgICAgICAgICAgX3JvdyA9IG5ldyBQcmltYXJ5Um93\nKHRhYmxlLCBhY3Rpb24sIHNtKTsKICAgICAgICAgICAgbWFwLnB1dChfa2V5\nLCBfcm93KTsKICAgICAgICAgICAgaWYgKF9wcmltYXJ5T3JkZXIgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgX3Jvdy5zZXRJbmRleChfcHJpbWFyeU9y\nZGVyLnNpemUoKSk7CiAgICAgICAgICAgICAgICBfcHJpbWFyeU9yZGVyLmFk\nZChfcm93KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFfYXV0\nbyAmJiBhY3Rpb24gPT0gUm93LkFDVElPTl9JTlNFUlQpCiAgICAgICAgICAg\nICAgICBfYXV0byA9IHRhYmxlLmdldEF1dG9Bc3NpZ25lZENvbHVtbnMoKS5s\nZW5ndGggPiAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKF9yb3cgIT0gbnVs\nbCkKICAgICAgICAgICAgX3Jvdy5zZXRGYWlsZWRPYmplY3Qoc20uZ2V0TWFu\nYWdlZEluc3RhbmNlKCkpOwogICAgICAgIHJldHVybiBfcm93OwogICAgfQoK\nICAgIC8qKgogICAgICogS2V5IGZvciBoYXNoaW5nIHZpcnR1YWwgcm93cy4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgS2V5IHsKCiAgICAg\nICAgcHVibGljIGZpbmFsIFRhYmxlIHRhYmxlOwogICAgICAgIHB1YmxpYyBm\naW5hbCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtOwoKICAgICAgICBwdWJsaWMg\nS2V5KFRhYmxlIHRhYmxlLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7CiAg\nICAgICAgICAgIHRoaXMudGFibGUgPSB0YWJsZTsKICAgICAgICAgICAgdGhp\ncy5zbSA9IHNtOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBoYXNo\nQ29kZSgpIHsKICAgICAgICAgICAgcmV0dXJuICh0YWJsZS5oYXNoQ29kZSgp\nICsgc20uaGFzaENvZGUoKSkgJSBJbnRlZ2VyLk1BWF9WQUxVRTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3Ro\nZXIpIHsKICAgICAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIEtleSBrZXkgPSAo\nS2V5KSBvdGhlcjsKICAgICAgICAgICAgcmV0dXJuIHRhYmxlID09IGtleS50\nYWJsZSAmJiBzbSA9PSBrZXkuc207CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

