{"sha":"e690b16f94ccafb08dda4896d14fc6fbbd30f653","node_id":"MDQ6QmxvYjIwNjM2NDplNjkwYjE2Zjk0Y2NhZmIwOGRkYTQ4OTZkMTRmYzZmYmJkMzBmNjUz","size":17881,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e690b16f94ccafb08dda4896d14fc6fbbd30f653","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJs\nZTsKaW1wb3J0IGphdmEuc3FsLkNhbGxhYmxlU3RhdGVtZW50OwppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVk\nU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQg\namF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGph\ndmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLk9iamVjdFV0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENv\nbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLlNlcXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7Cgov\nKioKICogQnVmZmVyIGZvciBTUUwgc3RhdGVtZW50cyB0aGF0IGNhbiBiZSB1\nc2VkIHRvIGNyZWF0ZQogKiBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudHMu\nCiAqCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBhdXRob3Ig\nQWJlIFdoaXRlCiAqIEBzaW5jZSAwLjIuNAogKi8KcHVibGljIGZpbmFsIGNs\nYXNzIFNRTEJ1ZmZlcgogICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUsIENs\nb25lYWJsZSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFBB\nUkFNRVRFUl9UT0tFTiA9ICI/IjsKCiAgICBwcml2YXRlIGZpbmFsIERCRGlj\ndGlvbmFyeSBfZGljdDsKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nQnVmZmVy\nIF9zcWwgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICBwcml2YXRlIExpc3Qg\nX3N1YnNlbHMgPSBudWxsOwogICAgcHJpdmF0ZSBMaXN0IF9wYXJhbXMgPSBu\ndWxsOwogICAgcHJpdmF0ZSBMaXN0IF9jb2xzID0gbnVsbDsKCiAgICAvKioK\nICAgICAqIERlZmF1bHQgY29uc3RydWN0b3IuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTUUxCdWZmZXIoREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICBfZGlj\ndCA9IGRpY3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb3B5IGNvbnN0cnVj\ndG9yLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyKFNRTEJ1ZmZlciBi\ndWYpIHsKICAgICAgICBfZGljdCA9IGJ1Zi5fZGljdDsKICAgICAgICBhcHBl\nbmQoYnVmKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBlcmZvcm0gYSBzaGFs\nbG93IGNsb25lIG9mIHRoaXMgU1FMIEJ1ZmZlci4KICAgICAqLwogICAgcHVi\nbGljIE9iamVjdCBjbG9uZSgpIHsKICAgICAgICByZXR1cm4gbmV3IFNRTEJ1\nZmZlcih0aGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVl\nIGlmIHRoZSBidWZmZXIgaXMgZW10cHkuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGlzRW1wdHkoKSB7CiAgICAgICAgcmV0dXJuIF9zcWwubGVuZ3Ro\nKCkgPT0gMDsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhbGwgU1FM\nIGFuZCBwYXJhbWV0ZXJzIG9mIHRoZSBnaXZlbiBidWZmZXIuCiAgICAgKi8K\nICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKFNRTEJ1ZmZlciBidWYpIHsK\nICAgICAgICBhcHBlbmQoYnVmLCBfc3FsLmxlbmd0aCgpLCAoX3BhcmFtcyA9\nPSBudWxsKSA/IDAgOiBfcGFyYW1zLnNpemUoKSwKICAgICAgICAgICAgdHJ1\nZSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBcHBlbmQgYWxsIFNRTCBhbmQgcGFyYW1ldGVycyBvZiB0aGUgZ2l2ZW4g\nYnVmZmVyIGF0IHRoZSBnaXZlbiBwb3NpdGlvbnMuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBhcHBlbmQoU1FMQnVmZmVyIGJ1ZiwgaW50IHNxbEluZGV4\nLCBpbnQgcGFyYW1JbmRleCwKICAgICAgICBib29sZWFuIHN1YnNlbHMpIHsK\nICAgICAgICBpZiAoc3Vic2VscykgewogICAgICAgICAgICAvLyBvbmx5IGFs\nbG93IGFwcGVuZGluZyBvZiBidWZmZXJzIHdpdGggc3Vic2VsZWN0cywgbm90\nIGluc2VydGlvbgogICAgICAgICAgICBpZiAoX3N1YnNlbHMgIT0gbnVsbCAm\nJiAhX3N1YnNlbHMuaXNFbXB0eSgpCiAgICAgICAgICAgICAgICAmJiBzcWxJ\nbmRleCAhPSBfc3FsLmxlbmd0aCgpKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAgICAgICBpZiAo\nYnVmLl9zdWJzZWxzICE9IG51bGwgJiYgIWJ1Zi5fc3Vic2Vscy5pc0VtcHR5\nKCkpIHsKICAgICAgICAgICAgICAgIGlmIChzcWxJbmRleCAhPSBfc3FsLmxl\nbmd0aCgpKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2Fs\nU3RhdGVFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAgIGlmIChfc3Vic2Vs\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9zdWJzZWxzID0gbmV3\nIEFycmF5TGlzdChidWYuX3N1YnNlbHMuc2l6ZSgpKTsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYnVmLl9zdWJzZWxzLnNpemUoKTsg\naSsrKQogICAgICAgICAgICAgICAgICAgIF9zdWJzZWxzLmFkZCgoKFN1YnNl\nbGVjdCkgYnVmLl9zdWJzZWxzLmdldChpKSkuCiAgICAgICAgICAgICAgICAg\nICAgICAgIGNsb25lKHNxbEluZGV4LCBwYXJhbUluZGV4KSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChzcWxJbmRleCA9PSBfc3Fs\nLmxlbmd0aCgpKQogICAgICAgICAgICBfc3FsLmFwcGVuZChidWYuX3NxbC50\nb1N0cmluZygpKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9zcWwuaW5z\nZXJ0KHNxbEluZGV4LCBidWYuX3NxbC50b1N0cmluZygpKTsKCiAgICAgICAg\naWYgKGJ1Zi5fcGFyYW1zICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9w\nYXJhbXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9wYXJhbXMgPSBuZXcg\nQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIGlmIChfY29scyA9PSBudWxsICYm\nIGJ1Zi5fY29scyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfY29scyA9\nIG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgICAgIHdoaWxlIChfY29s\ncy5zaXplKCkgPCBfcGFyYW1zLnNpemUoKSkKICAgICAgICAgICAgICAgICAg\nICBfY29scy5hZGQobnVsbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGlmIChwYXJhbUluZGV4ID09IF9wYXJhbXMuc2l6ZSgpKSB7CiAgICAgICAg\nICAgICAgICBfcGFyYW1zLmFkZEFsbChidWYuX3BhcmFtcyk7CiAgICAgICAg\nICAgICAgICBpZiAoYnVmLl9jb2xzICE9IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgX2NvbHMuYWRkQWxsKGJ1Zi5fY29scyk7CiAgICAgICAgICAgICAg\nICBlbHNlIGlmIChfY29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIHdoaWxlIChfY29scy5zaXplKCkgPCBfcGFyYW1zLnNpemUoKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgX2NvbHMuYWRkKG51bGwpOwogICAgICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAgICAgX3BhcmFtcy5hZGRBbGwocGFy\nYW1JbmRleCwgYnVmLl9wYXJhbXMpOwogICAgICAgICAgICAgICAgaWYgKGJ1\nZi5fY29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9jb2xzLmFk\nZEFsbChwYXJhbUluZGV4LCBidWYuX2NvbHMpOwogICAgICAgICAgICAgICAg\nZWxzZSBpZiAoX2NvbHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB3\naGlsZSAoX2NvbHMuc2l6ZSgpIDwgX3BhcmFtcy5zaXplKCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIF9jb2xzLmFkZChwYXJhbUluZGV4LCBudWxsKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIGFwcGVuZChUYWJsZSB0YWJsZSkgewogICAgICAgIF9zcWwuYXBw\nZW5kKF9kaWN0LmdldEZ1bGxOYW1lKHRhYmxlLCBmYWxzZSkpOwogICAgICAg\nIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBw\nZW5kKFNlcXVlbmNlIHNlcSkgewogICAgICAgIF9zcWwuYXBwZW5kKF9kaWN0\nLmdldEZ1bGxOYW1lKHNlcSkpOwogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKENvbHVtbiBjb2wpIHsK\nICAgICAgICBfc3FsLmFwcGVuZChjb2wuZ2V0TmFtZSgpKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVu\nZChTdHJpbmcgcykgewogICAgICAgIF9zcWwuYXBwZW5kKHMpOwogICAgICAg\nIHJldHVybiB0aGlzOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEg\nc3Vic2VsZWN0LiBUaGlzIGRlbGF5cyByZXNvbHV0aW9uIG9mIHRoZSBzZWxl\nY3QgU1FMLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZChT\nZWxlY3Qgc2VsLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAg\nICAgICAgcmV0dXJuIGFwcGVuZChzZWwsIGZldGNoLCBmYWxzZSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBzdWJzZWxlY3QgY291bnQuIFRo\naXMgZGVsYXlzIHJlc29sdXRpb24gb2YgdGhlIHNlbGVjdCBTUUwuCiAgICAg\nKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kQ291bnQoU2VsZWN0IHNl\nbCwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIHJl\ndHVybiBhcHBlbmQoc2VsLCBmZXRjaCwgdHJ1ZSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBcHBlbmQgYSBzdWJzZWxlY3QuIFRoaXMgZGVsYXlzIHJlc29s\ndXRpb24gb2YgdGhlIHNlbGVjdCBTUUwuCiAgICAgKi8KICAgIHByaXZhdGUg\nU1FMQnVmZmVyIGFwcGVuZChTZWxlY3Qgc2VsLCBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGZldGNoLAogICAgICAgIGJvb2xlYW4gY291bnQpIHsKICAgICAg\nICBfc3FsLmFwcGVuZCgiKCIpOwogICAgICAgIFN1YnNlbGVjdCBzdWIgPSBu\nZXcgU3Vic2VsZWN0KCk7CiAgICAgICAgc3ViLnNlbGVjdCA9IHNlbDsKICAg\nICAgICBzdWIuZmV0Y2ggPSBmZXRjaDsKICAgICAgICBzdWIuY291bnQgPSBj\nb3VudDsKICAgICAgICBzdWIuc3FsSW5kZXggPSBfc3FsLmxlbmd0aCgpOwog\nICAgICAgIHN1Yi5wYXJhbUluZGV4ID0gKF9wYXJhbXMgPT0gbnVsbCkgPyAw\nIDogX3BhcmFtcy5zaXplKCk7CiAgICAgICAgX3NxbC5hcHBlbmQoIikiKTsK\nCiAgICAgICAgaWYgKF9zdWJzZWxzID09IG51bGwpCiAgICAgICAgICAgIF9z\ndWJzZWxzID0gbmV3IEFycmF5TGlzdCgyKTsKICAgICAgICBfc3Vic2Vscy5h\nZGQoc3ViKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJlcGxhY2UgYSBzdWJzZWxlY3QuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIHJlcGxhY2UoU2VsZWN0IG9sZCwgU2VsZWN0IHNlbCkgewog\nICAgICAgIGlmIChfc3Vic2VscyA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgU3Vic2VsZWN0IHN1YjsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IF9zdWJzZWxzLnNpemUoKTsgaSsrKSB7CiAgICAg\nICAgICAgIHN1YiA9IChTdWJzZWxlY3QpIF9zdWJzZWxzLmdldChpKTsKICAg\nICAgICAgICAgaWYgKHN1Yi5zZWxlY3QgPT0gb2xkKSB7CiAgICAgICAgICAg\nICAgICBzdWIuc2VsZWN0ID0gc2VsOwogICAgICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1l\ndGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVu\nZFZhbHVlKE9iamVjdCBvKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVl\nKG8sIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFy\nYW1ldGVyIHZhbHVlIGZvciBhIHNwZWNpZmljIGNvbHVtbi4KICAgICAqLwog\nICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShPYmplY3QgbywgQ29s\ndW1uIGNvbCkgewogICAgICAgIGlmIChvID09IG51bGwpCiAgICAgICAgICAg\nIF9zcWwuYXBwZW5kKCJOVUxMIik7CiAgICAgICAgZWxzZSBpZiAobyBpbnN0\nYW5jZW9mIFJhdykKICAgICAgICAgICAgX3NxbC5hcHBlbmQoby50b1N0cmlu\nZygpKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgX3NxbC5hcHBlbmQo\nUEFSQU1FVEVSX1RPS0VOKTsKCiAgICAgICAgICAgIC8vIGluaXRpYWxpemUg\ncGFyYW0gYW5kIGNvbCBsaXN0czsgd2UgaG9sZCBvZmYgb24gY29sIGxpc3Qg\ndW50aWwKICAgICAgICAgICAgLy8gd2UgZ2V0IHRoZSBmaXJzdCBub24tbnVs\nbCBjb2wKICAgICAgICAgICAgaWYgKF9wYXJhbXMgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9wYXJhbXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAg\nICAgIGlmIChjb2wgIT0gbnVsbCAmJiBfY29scyA9PSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBfY29scyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAg\nICAgICAgIHdoaWxlIChfY29scy5zaXplKCkgPCBfcGFyYW1zLnNpemUoKSkK\nICAgICAgICAgICAgICAgICAgICBfY29scy5hZGQobnVsbCk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIF9wYXJhbXMuYWRkKG8pOwogICAgICAgICAg\nICBpZiAoX2NvbHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jb2xzLmFk\nZChjb2wpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpczsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShib29sZWFu\nIGIpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUoYiwgbnVsbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoYm9v\nbGVhbiBiLCBDb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZh\nbHVlKChiKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0UsIGNvbCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFs\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUo\nYnl0ZSBiKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKGIsIG51bGwp\nOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVl\nKGJ5dGUgYiwgQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRW\nYWx1ZShuZXcgQnl0ZShiKSwgY29sKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGlj\nIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShjaGFyIGMpIHsKICAgICAgICByZXR1\ncm4gYXBwZW5kVmFsdWUoYywgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoY2hhciBjLCBDb2x1bW4gY29sKSB7\nCiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBDaGFyYWN0ZXIoYyks\nIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0\nZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5k\nVmFsdWUoZG91YmxlIGQpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUo\nZCwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJh\nbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBw\nZW5kVmFsdWUoZG91YmxlIGQsIENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1\ncm4gYXBwZW5kVmFsdWUobmV3IERvdWJsZShkKSwgY29sKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAq\nLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShmbG9hdCBmKSB7\nCiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKGYsIG51bGwpOwogICAgfQoK\nICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAg\nICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGZsb2F0IGYs\nIENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUobmV3\nIEZsb2F0KGYpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5k\nIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVm\nZmVyIGFwcGVuZFZhbHVlKGludCBpKSB7CiAgICAgICAgcmV0dXJuIGFwcGVu\nZFZhbHVlKGksIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5k\nIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVm\nZmVyIGFwcGVuZFZhbHVlKGludCBpLCBDb2x1bW4gY29sKSB7CiAgICAgICAg\ncmV0dXJuIGFwcGVuZFZhbHVlKE51bWJlcnMudmFsdWVPZihpKSwgY29sKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1\nZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShs\nb25nIGwpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUobCwgbnVsbCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFs\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUo\nbG9uZyBsLCBDb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZh\nbHVlKE51bWJlcnMudmFsdWVPZihsKSwgY29sKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAg\ncHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShzaG9ydCBzKSB7CiAgICAg\nICAgcmV0dXJuIGFwcGVuZFZhbHVlKHMsIG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAg\nICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKHNob3J0IHMsIENvbHVt\nbiBjb2wpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUobmV3IFNob3J0\nKHMpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBs\naXN0IG9mIHBhcmFtZXRlciB2YWx1ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBM\naXN0IGdldFBhcmFtZXRlcnMoKSB7CiAgICAgICAgcmV0dXJuIChfcGFyYW1z\nID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVCA6IF9wYXJhbXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIFNRTCBmb3IgdGhp\ncyBidWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U1FMKCkg\newogICAgICAgIHJldHVybiBnZXRTUUwoZmFsc2UpOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIFJldHVybnMgdGhlIFNRTCBmb3IgdGhpcyBidWZmZXIu\nCiAgICAgKgogICAgICogQHBhcmFtIHJlcGxhY2VQYXJhbXMgaWYgdHJ1ZSwg\ndGhlbiByZXBsYWNlIHBhcmFtZXRlcnMgd2l0aCB0aGUKICAgICAqIGFjdHVh\nbCBwYXJhbWV0ZXIgdmFsdWVzCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0U1FMKGJvb2xlYW4gcmVwbGFjZVBhcmFtcykgewogICAgICAgIHJlc29s\ndmVTdWJzZWxlY3RzKCk7CiAgICAgICAgU3RyaW5nIHNxbCA9IF9zcWwudG9T\ndHJpbmcoKTsKICAgICAgICBpZiAoIXJlcGxhY2VQYXJhbXMgfHwgX3BhcmFt\ncyA9PSBudWxsIHx8IF9wYXJhbXMuaXNFbXB0eSgpKQogICAgICAgICAgICBy\nZXR1cm4gc3FsOwoKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0\ncmluZ0J1ZmZlcigpOwogICAgICAgIEl0ZXJhdG9yIHBpID0gX3BhcmFtcy5p\ndGVyYXRvcigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3FsLmxl\nbmd0aCgpOyBpKyspIHsKICAgICAgICAgICAgaWYgKHNxbC5jaGFyQXQoaSkg\nIT0gJz8nKSB7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHNxbC5jaGFy\nQXQoaSkpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIE9iamVjdCBwYXJhbSA9IHBpLmhhc05leHQoKSA/\nIHBpLm5leHQoKSA6IG51bGw7CiAgICAgICAgICAgIGlmIChwYXJhbSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiTlVMTCIpOwogICAg\nICAgICAgICBlbHNlIGlmIChwYXJhbSBpbnN0YW5jZW9mIE51bWJlciB8fCBw\nYXJhbSBpbnN0YW5jZW9mIEJvb2xlYW4pCiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKHBhcmFtKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW0gaW5z\ndGFuY2VvZiBTdHJpbmcgfHwgcGFyYW0gaW5zdGFuY2VvZiBDaGFyYWN0ZXIp\nCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCInIikuYXBwZW5kKHBhcmFt\nKS5hcHBlbmQoIiciKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiPyIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNvbHZl\nIG91ciBkZWxheWVkIHN1YnNlbGVjdHMuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCByZXNvbHZlU3Vic2VsZWN0cygpIHsKICAgICAgICBpZiAoX3N1YnNl\nbHMgPT0gbnVsbCB8fCBfc3Vic2Vscy5pc0VtcHR5KCkpCiAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgLy8gYWRkIHN1YnNlbHMgYmFja3dhcmRzIHNv\nIHRoYXQgdGhlIHN0b3JlZCBpbnNlcnRpb24gcG9pbnRzIG9mCiAgICAgICAg\nLy8gbGF0ZXIgc3Vic2VscyByZW1haW4gdmFsaWQKICAgICAgICBTdWJzZWxl\nY3Qgc3ViOwogICAgICAgIFNRTEJ1ZmZlciBidWY7CiAgICAgICAgZm9yIChp\nbnQgaSA9IF9zdWJzZWxzLnNpemUoKSAtIDE7IGkgPj0gMDsgaS0tKSB7CiAg\nICAgICAgICAgIHN1YiA9IChTdWJzZWxlY3QpIF9zdWJzZWxzLmdldChpKTsK\nICAgICAgICAgICAgaWYgKHN1Yi5jb3VudCkKICAgICAgICAgICAgICAgIGJ1\nZiA9IHN1Yi5zZWxlY3QudG9TZWxlY3RDb3VudCgpOwogICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICBidWYgPSBzdWIuc2VsZWN0LnRvU2VsZWN0\nKGZhbHNlLCBzdWIuZmV0Y2gpOwogICAgICAgICAgICBidWYucmVzb2x2ZVN1\nYnNlbGVjdHMoKTsKICAgICAgICAgICAgYXBwZW5kKGJ1Ziwgc3ViLnNxbElu\nZGV4LCBzdWIucGFyYW1JbmRleCwgZmFsc2UpOwogICAgICAgIH0KICAgICAg\nICBfc3Vic2Vscy5jbGVhcigpOwogICAgfQoKICAgIC8qKgogICAgICogQ3Jl\nYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXBhcmVk\nIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZl\nci4KICAgICAqLwogICAgcHVibGljIFByZXBhcmVkU3RhdGVtZW50IHByZXBh\ncmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBwcmVwYXJlU3RhdGVtZW50\nKGNvbm4sIFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWSwKICAgICAgICAg\nICAgUmVzdWx0U2V0LkNPTkNVUl9SRUFEX09OTFkpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBv\nZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNRTCBp\nbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIFByZXBhcmVkU3Rh\ndGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uLCBpbnQg\ncnNUeXBlLAogICAgICAgIGludCByc0NvbmN1cikKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcHJlcGFyZVN0YXRlbWVu\ndChjb25uLCBudWxsLCByc1R5cGUsIHJzQ29uY3VyKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMg\nb2YgYSBwcmVwcmVkIHN0YXRlbWVudCB1c2luZyB0aGUKICAgICAqIFNRTCBp\nbiB0aGlzIGJ1ZmZlciBhbmQgdGhlIGdpdmVuIGZldGNoIGNvbmZpZ3VyYXRp\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBQcmVwYXJlZFN0YXRlbWVudCBwcmVw\nYXJlU3RhdGVtZW50KENvbm5lY3Rpb24gY29ubiwKICAgICAgICBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQgcnNDb25j\ndXIpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKHJzVHlwZSA9PSAtMSAmJiBmZXRjaCA9PSBudWxsKQogICAgICAgICAgICBy\nc1R5cGUgPSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAgICAgICAg\nZWxzZSBpZiAocnNUeXBlID09IC0xKQogICAgICAgICAgICByc1R5cGUgPSBm\nZXRjaC5nZXRSZXN1bHRTZXRUeXBlKCk7CiAgICAgICAgaWYgKHJzQ29uY3Vy\nID09IC0xKQogICAgICAgICAgICByc0NvbmN1ciA9IFJlc3VsdFNldC5DT05D\nVVJfUkVBRF9PTkxZOwoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndDsKICAgICAgICBpZiAocnNUeXBlID09IFJlc3VsdFNldC5UWVBFX0ZPUldB\nUkRfT05MWQogICAgICAgICAgICAmJiByc0NvbmN1ciA9PSBSZXN1bHRTZXQu\nQ09OQ1VSX1JFQURfT05MWSkKICAgICAgICAgICAgc3RtbnQgPSBjb25uLnBy\nZXBhcmVTdGF0ZW1lbnQoZ2V0U1FMKCkpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoZ2V0U1FMKCks\nIHJzVHlwZSwgcnNDb25jdXIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHNldFBhcmFtZXRlcnMoc3RtbnQpOwogICAgICAgICAgICBpZiAoZmV0Y2gg\nIT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWYgKGZldGNoLmdldEZldGNo\nQmF0Y2hTaXplKCkgPiAwKQogICAgICAgICAgICAgICAgICAgIHN0bW50LnNl\ndEZldGNoU2l6ZShmZXRjaC5nZXRGZXRjaEJhdGNoU2l6ZSgpKTsKICAgICAg\nICAgICAgICAgIGlmIChyc1R5cGUgIT0gUmVzdWx0U2V0LlRZUEVfRk9SV0FS\nRF9PTkxZCiAgICAgICAgICAgICAgICAgICAgJiYgZmV0Y2guZ2V0RmV0Y2hE\naXJlY3Rpb24oKSAhPSBSZXN1bHRTZXQuRkVUQ0hfRk9SV0FSRCkKICAgICAg\nICAgICAgICAgICAgICBzdG1udC5zZXRGZXRjaERpcmVjdGlvbihmZXRjaC5n\nZXRGZXRjaERpcmVjdGlvbigpKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gc3RtbnQ7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdG1u\ndC5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24g\nc2UyKSB7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhyb3cgc2U7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1\nbGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1\nc2luZwogICAgICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwog\nICAgcHVibGljIENhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxsKENvbm5l\nY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICByZXR1cm4gcHJlcGFyZUNhbGwoY29ubiwgUmVzdWx0U2V0LlRZUEVf\nRk9SV0FSRF9PTkxZLAogICAgICAgICAgICBSZXN1bHRTZXQuQ09OQ1VSX1JF\nQURfT05MWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW5kIHBv\ncHVsYXRlIHRoZSBwYXJhbWV0ZXJzIG9mIGEgcHJlcGFyZWQgc3RhdGVtZW50\nIHVzaW5nCiAgICAgKiB0aGUgU1FMIGluIHRoaXMgYnVmZmVyLgogICAgICov\nCiAgICBwdWJsaWMgQ2FsbGFibGVTdGF0ZW1lbnQgcHJlcGFyZUNhbGwoQ29u\nbmVjdGlvbiBjb25uLCBpbnQgcnNUeXBlLAogICAgICAgIGludCByc0NvbmN1\ncikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1\ncm4gcHJlcGFyZUNhbGwoY29ubiwgbnVsbCwgcnNUeXBlLCByc0NvbmN1cik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW5kIHBvcHVsYXRlIHRo\nZSBwYXJhbWV0ZXJzIG9mIGEgcHJlcHJlZCBzdGF0ZW1lbnQgdXNpbmcgdGhl\nCiAgICAgKiBTUUwgaW4gdGhpcyBidWZmZXIgYW5kIHRoZSBnaXZlbiBmZXRj\naCBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgQ2FsbGFibGVT\ndGF0ZW1lbnQgcHJlcGFyZUNhbGwoQ29ubmVjdGlvbiBjb25uLAogICAgICAg\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGludCByc1R5cGUsIGlu\ndCByc0NvbmN1cikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAocnNUeXBlID09IC0xICYmIGZldGNoID09IG51bGwpCiAgICAg\nICAgICAgIHJzVHlwZSA9IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWTsK\nICAgICAgICBlbHNlIGlmIChyc1R5cGUgPT0gLTEpCiAgICAgICAgICAgIHJz\nVHlwZSA9IGZldGNoLmdldFJlc3VsdFNldFR5cGUoKTsKICAgICAgICBpZiAo\ncnNDb25jdXIgPT0gLTEpCiAgICAgICAgICAgIHJzQ29uY3VyID0gUmVzdWx0\nU2V0LkNPTkNVUl9SRUFEX09OTFk7CgogICAgICAgIENhbGxhYmxlU3RhdGVt\nZW50IHN0bW50OwogICAgICAgIGlmIChyc1R5cGUgPT0gUmVzdWx0U2V0LlRZ\nUEVfRk9SV0FSRF9PTkxZCiAgICAgICAgICAgICYmIHJzQ29uY3VyID09IFJl\nc3VsdFNldC5DT05DVVJfUkVBRF9PTkxZKQogICAgICAgICAgICBzdG1udCA9\nIGNvbm4ucHJlcGFyZUNhbGwoZ2V0U1FMKCkpOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVDYWxsKGdldFNRTCgpLCBy\nc1R5cGUsIHJzQ29uY3VyKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBz\nZXRQYXJhbWV0ZXJzKHN0bW50KTsKICAgICAgICAgICAgaWYgKGZldGNoICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChmZXRjaC5nZXRGZXRjaEJh\ndGNoU2l6ZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBzdG1udC5zZXRG\nZXRjaFNpemUoZmV0Y2guZ2V0RmV0Y2hCYXRjaFNpemUoKSk7CiAgICAgICAg\nICAgICAgICBpZiAocnNUeXBlICE9IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRf\nT05MWQogICAgICAgICAgICAgICAgICAgICYmIGZldGNoLmdldEZldGNoRGly\nZWN0aW9uKCkgIT0gUmVzdWx0U2V0LkZFVENIX0ZPUldBUkQpCiAgICAgICAg\nICAgICAgICAgICAgc3RtbnQuc2V0RmV0Y2hEaXJlY3Rpb24oZmV0Y2guZ2V0\nRmV0Y2hEaXJlY3Rpb24oKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ncmV0dXJuIHN0bW50OwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc3RtbnQu\nY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nMikgewogICAgICAgICAgICB9CiAgICAgICAgICAgIHRocm93IHNlOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBvcHVsYXRlIHRoZSBwYXJh\nbWV0ZXJzIG9mIGFuIGV4aXN0aW5nIFByZXBhcmVkU3RhdGVtZW50CiAgICAg\nKiB3aXRoIHZhbHVlcyBmcm9tIHRoaXMgYnVmZmVyLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRQYXJhbWV0ZXJzKFByZXBhcmVkU3RhdGVtZW50IHBz\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChf\ncGFyYW1zID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nQ29sdW1uIGNvbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9wYXJh\nbXMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgY29sID0gKF9jb2xzID09\nIG51bGwpID8gbnVsbCA6IChDb2x1bW4pIF9jb2xzLmdldChpKTsKICAgICAg\nICAgICAgX2RpY3Quc2V0VW5rbm93bihwcywgaSArIDEsIF9wYXJhbXMuZ2V0\nKGkpLCBjb2wpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IGhh\nc2hDb2RlKCkgewogICAgICAgIGludCBoYXNoID0gX3NxbC5oYXNoQ29kZSgp\nOwogICAgICAgIHJldHVybiAoX3BhcmFtcyA9PSBudWxsKSA/IGhhc2ggOiBo\nYXNoIF4gX3BhcmFtcy5oYXNoQ29kZSgpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29tcGFyZSBpbnRlcm5hbCBTUUwgd2l0aG91dCByZXNvbHZpbmcgc3Vi\nc2VsZWN0cyBvciBzdHJpbmdpZnlpbmcKICAgICAqIHBhcmFtZXRlcnMuCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHNxbEVxdWFscyhTdHJpbmcgc3Fs\nKSB7CiAgICAgICAgcmV0dXJuIF9zcWwudG9TdHJpbmcoKS5lcXVhbHMoc3Fs\nKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90\naGVyKSB7CiAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAgICAg\nIHJldHVybiB0cnVlOwogICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2Yg\nU1FMQnVmZmVyKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAg\nICBTUUxCdWZmZXIgYnVmID0gKFNRTEJ1ZmZlcikgb3RoZXI7CiAgICAgICAg\ncmV0dXJuIF9zcWwuZXF1YWxzKGJ1Zi5fc3FsKQogICAgICAgICAgICAmJiBP\nYmplY3RVdGlscy5lcXVhbHMoX3BhcmFtcywgYnVmLl9wYXJhbXMpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmVwcmVzZW50cyBhIHN1YnNlbGVjdC4KICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU3Vic2VsZWN0IHsKCiAg\nICAgICAgcHVibGljIFNlbGVjdCBzZWxlY3Q7CiAgICAgICAgcHVibGljIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2g7CiAgICAgICAgcHVibGljIGJv\nb2xlYW4gY291bnQ7CiAgICAgICAgcHVibGljIGludCBzcWxJbmRleDsKICAg\nICAgICBwdWJsaWMgaW50IHBhcmFtSW5kZXg7CgogICAgICAgIHB1YmxpYyBT\ndWJzZWxlY3QgY2xvbmUoaW50IHNxbEluZGV4LCBpbnQgcGFyYW1JbmRleCkg\newogICAgICAgICAgICBpZiAoc3FsSW5kZXggPT0gMCAmJiBwYXJhbUluZGV4\nID09IDApCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKCiAgICAgICAg\nICAgIFN1YnNlbGVjdCBzdWIgPSBuZXcgU3Vic2VsZWN0KCk7CiAgICAgICAg\nICAgIHN1Yi5zZWxlY3QgPSBzZWxlY3Q7CiAgICAgICAgICAgIHN1Yi5mZXRj\naCA9IGZldGNoOwogICAgICAgICAgICBzdWIuY291bnQgPSBjb3VudDsKICAg\nICAgICAgICAgc3ViLnNxbEluZGV4ID0gdGhpcy5zcWxJbmRleCArIHNxbElu\nZGV4OwogICAgICAgICAgICBzdWIucGFyYW1JbmRleCA9IHRoaXMucGFyYW1J\nbmRleCArIHBhcmFtSW5kZXg7CiAgICAgICAgICAgIHJldHVybiBzdWI7CiAg\nICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

