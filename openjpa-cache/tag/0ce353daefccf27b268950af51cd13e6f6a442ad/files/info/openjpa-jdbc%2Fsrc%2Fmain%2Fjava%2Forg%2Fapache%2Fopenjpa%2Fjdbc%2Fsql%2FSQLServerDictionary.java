{"sha":"7bafbbdf68cb680d205bdde0495ec780aad4d72a","node_id":"MDQ6QmxvYjIwNjM2NDo3YmFmYmJkZjY4Y2I2ODBkMjA1YmRkZTA0OTVlYzc4MGFhZDRkNzJh","size":4588,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7bafbbdf68cb680d205bdde0495ec780aad4d72a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0aW9u\nOwppbXBvcnQgamF2YS5zcWwuRGF0YWJhc2VNZXRhRGF0YTsKaW1wb3J0IGph\ndmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEuc3FsLlR5cGVzOwoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwoKLyoqCiAqIERpY3Rpb25hcnkgZm9yIE1TIFNRTFNlcnZlci4KICovCnB1\nYmxpYyBjbGFzcyBTUUxTZXJ2ZXJEaWN0aW9uYXJ5CiAgICBleHRlbmRzIEFi\nc3RyYWN0U1FMU2VydmVyRGljdGlvbmFyeSB7CgogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgVkVORE9SX01JQ1JPU09GVCA9ICJtaWNyb3NvZnQi\nOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgVkVORE9SX05FVERJ\nUkVDVCA9ICJuZXRkaXJlY3QiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgVkVORE9SX0pURFMgPSAianRkcyI7CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZQogICAgICAgIChTUUxTZXJ2ZXJEaWN0aW9uYXJ5LmNsYXNzKTsKCiAgICAv\nKioKICAgICAqIEZsYWcgd2hldGhlciB0byB0cmVhdCBVTklRVUVJREVOVElG\nSUVSIGFzIFZBUkJJTkFSWSBvciBWQVJDSEFSCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIHVuaXF1ZUlkZW50aWZpZXJBc1ZhcmJpbmFyeSA9IHRydWU7\nCgogICAgcHVibGljIFNRTFNlcnZlckRpY3Rpb25hcnkoKSB7CiAgICAgICAg\ncGxhdGZvcm0gPSAiTWljcm9zb2Z0IFNRTCBTZXJ2ZXIiOwoKICAgICAgICAv\nLyBTUUxTZXJ2ZXIgbG9ja3Mgb24gYSB0YWJsZS1ieS10YWJsZSBiYXNpcwog\nICAgICAgIGZvclVwZGF0ZUNsYXVzZSA9IG51bGw7CiAgICAgICAgdGFibGVG\nb3JVcGRhdGVDbGF1c2UgPSAiV0lUSCAoVVBETE9DSykiOwoKICAgICAgICBz\ndXBwb3J0c051bGxUYWJsZUZvckdldENvbHVtbnMgPSBmYWxzZTsKICAgICAg\nICByZXF1aXJlc0FsaWFzRm9yU3Vic2VsZWN0ID0gdHJ1ZTsKCiAgICAgICAg\nc3RyaW5nTGVuZ3RoRnVuY3Rpb24gPSAiTEVOKHswfSkiOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGNvbm5lY3RlZENvbmZpZ3VyYXRpb24oQ29ubmVjdGlv\nbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHN1cGVyLmNvbm5lY3RlZENvbmZpZ3VyYXRpb24oY29ubik7CgogICAgICAg\nIERhdGFiYXNlTWV0YURhdGEgbWV0YSA9IGNvbm4uZ2V0TWV0YURhdGEoKTsK\nICAgICAgICBTdHJpbmcgZHJpdmVyTmFtZSA9IG1ldGEuZ2V0RHJpdmVyTmFt\nZSgpOwogICAgICAgIFN0cmluZyB1cmwgPSBtZXRhLmdldFVSTCgpOwogICAg\nICAgIGlmIChkcml2ZXJWZW5kb3IgPT0gbnVsbCkgewogICAgICAgICAgICBp\nZiAoIk5ldERpcmVjdCBKU1FMQ29ubmVjdCIuZXF1YWxzKGRyaXZlck5hbWUp\nKQogICAgICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX05FVERJ\nUkVDVDsKICAgICAgICAgICAgZWxzZSBpZiAoZHJpdmVyTmFtZSAhPSBudWxs\nICYmIGRyaXZlck5hbWUuc3RhcnRzV2l0aCgialREUyIpKQogICAgICAgICAg\nICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX0pURFM7CiAgICAgICAgICAg\nIGVsc2UgaWYgKCJTUUxTZXJ2ZXIiLmVxdWFscyhkcml2ZXJOYW1lKSkgewog\nICAgICAgICAgICAgICAgaWYgKHVybCAhPSBudWxsICYmIHVybC5zdGFydHNX\naXRoKCJqZGJjOm1pY3Jvc29mdDpzcWxzZXJ2ZXI6IikpCiAgICAgICAgICAg\nICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX01JQ1JPU09GVDsKICAg\nICAgICAgICAgICAgIGVsc2UgaWYgKHVybCAhPSBudWxsCiAgICAgICAgICAg\nICAgICAgICAgJiYgdXJsLnN0YXJ0c1dpdGgoImpkYmM6ZGF0YWRpcmVjdDpz\ncWxzZXJ2ZXI6IikpCiAgICAgICAgICAgICAgICAgICAgZHJpdmVyVmVuZG9y\nID0gVkVORE9SX0RBVEFESVJFQ1Q7CiAgICAgICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX09USEVS\nOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIGRyaXZlclZl\nbmRvciA9IFZFTkRPUl9PVEhFUjsKICAgICAgICB9CgogICAgICAgIC8vIHdh\ncm4gYWJvdXQgdXNpbmcgY3Vyc29ycwogICAgICAgIGlmICgoVkVORE9SX01J\nQ1JPU09GVC5lcXVhbHNJZ25vcmVDYXNlKGRyaXZlclZlbmRvcikKICAgICAg\nICAgICAgfHwgVkVORE9SX0RBVEFESVJFQ1QuZXF1YWxzSWdub3JlQ2FzZShk\ncml2ZXJWZW5kb3IpKQogICAgICAgICAgICAmJiB1cmwudG9Mb3dlckNhc2Uo\nKS5pbmRleE9mKCJzZWxlY3RtZXRob2Q9Y3Vyc29yIikgPT0gLTEpCiAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJzcWxzZXJ2ZXItY3Vyc29yIiwg\ndXJsKSk7CgogICAgICAgIC8vIHdhcm4gYWJvdXQgcHJlcGFyZWQgc3RhdGVt\nZW50IGNhY2hpbmcgaWYgdXNpbmcgbXMgZHJpdmVyCiAgICAgICAgU3RyaW5n\nIHByb3BzID0gY29uZi5nZXRDb25uZWN0aW9uRmFjdG9yeVByb3BlcnRpZXMo\nKTsKICAgICAgICBpZiAocHJvcHMgPT0gbnVsbCkKICAgICAgICAgICAgcHJv\ncHMgPSAiIjsKICAgICAgICBpZiAoVkVORE9SX01JQ1JPU09GVC5lcXVhbHNJ\nZ25vcmVDYXNlKGRyaXZlclZlbmRvcikKICAgICAgICAgICAgJiYgcHJvcHMu\ndG9Mb3dlckNhc2UoKS5pbmRleE9mKCJtYXhjYWNoZWRzdGF0ZW1lbnRzPTAi\nKSA9PSAtMSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoInNxbHNl\ncnZlci1jYWNoZWRzdG1udHMiKSk7CiAgICB9CgogICAgcHVibGljIENvbHVt\nbltdIGdldENvbHVtbnMoRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcg\nY2F0YWxvZywKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRh\nYmxlTmFtZSwgU3RyaW5nIGNvbHVtbk5hbWUsIENvbm5lY3Rpb24gY29ubikK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW5b\nXSBjb2xzID0gc3VwZXIuZ2V0Q29sdW1ucyhtZXRhLCBjYXRhbG9nLCBzY2hl\nbWFOYW1lLCB0YWJsZU5hbWUsCiAgICAgICAgICAgIGNvbHVtbk5hbWUsIGNv\nbm4pOwoKICAgICAgICAvLyBmb3Igb3B0YSBkcml2ZXIsIHdoaWNoIHJlcG9y\ndHMgbnZhcmNoYXIgYXMgdW5rbm93biB0eXBlCiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGNvbHMgIT0gbnVsbCAmJiBpIDwgY29scy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBTdHJpbmcgdHlwZU5hbWUgPSBjb2xzW2ldLmdldFR5\ncGVOYW1lKCk7CiAgICAgICAgICAgIGlmICh0eXBlTmFtZSA9PSBudWxsKQog\nICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICB0eXBlTmFt\nZSA9IHR5cGVOYW1lLnRvVXBwZXJDYXNlKCk7CgogICAgICAgICAgICBpZiAo\nIk5WQVJDSEFSIi5lcXVhbHModHlwZU5hbWUpKQogICAgICAgICAgICAgICAg\nY29sc1tpXS5zZXRUeXBlKFR5cGVzLlZBUkNIQVIpOwogICAgICAgICAgICBl\nbHNlIGlmICgiVU5JUVVFSURFTlRJRklFUiIuZXF1YWxzKHR5cGVOYW1lKSkg\newogICAgICAgICAgICAgICAgaWYgKHVuaXF1ZUlkZW50aWZpZXJBc1ZhcmJp\nbmFyeSkKICAgICAgICAgICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlw\nZXMuVkFSQklOQVJZKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMuVkFSQ0hBUik7CiAg\nICAgICAgICAgIH0gZWxzZSBpZiAoIk5DSEFSIi5lcXVhbHModHlwZU5hbWUp\nKQogICAgICAgICAgICAgICAgY29sc1tpXS5zZXRUeXBlKFR5cGVzLkNIQVIp\nOwogICAgICAgICAgICBlbHNlIGlmICgiTlRFWFQiLmVxdWFscyh0eXBlTmFt\nZSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMuQ0xP\nQik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb2xzOwogICAgfQp9Cg==\n","encoding":"base64"}

