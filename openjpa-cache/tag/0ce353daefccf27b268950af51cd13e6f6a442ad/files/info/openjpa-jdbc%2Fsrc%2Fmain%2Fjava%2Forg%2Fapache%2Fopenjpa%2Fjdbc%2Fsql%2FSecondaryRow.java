{"sha":"5ed5062f2deb16a8668875ced37a70be0d7e6ca6","node_id":"MDQ6QmxvYjIwNjM2NDo1ZWQ1MDYyZjJkZWIxNmE4NjY4ODc1Y2VkMzdhNzBiZTBkN2U2Y2E2","size":6299,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5ed5062f2deb16a8668875ced37a70be0d7e6ca6","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRp\nb247CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFz\nc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRh\nLlJlbGF0aW9uSWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLkNvbHVtbklPOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CgovKioKICogU2Vjb25k\nYXJ5IHRhYmxlIHJvdyB0aGF0IHRyYWNrcyBmb3JlaWduIGtleXMgdG8gYXV0\nby1pbmMgY29sdW1ucy4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5v\namF2YWRvYwogKi8KcHVibGljIGNsYXNzIFNlY29uZGFyeVJvdwogICAgZXh0\nZW5kcyBSb3dJbXBsIHsKCiAgICBwcml2YXRlIE9wZW5KUEFTdGF0ZU1hbmFn\nZXJbXSBfZmtzID0gbnVsbDsKICAgIHByaXZhdGUgQ29sdW1uSU9bXSBfZmtJ\nTyA9IG51bGw7CiAgICBwcml2YXRlIE9wZW5KUEFTdGF0ZU1hbmFnZXJbXSBf\ncmVscyA9IG51bGw7CiAgICBwcml2YXRlIFJlbGF0aW9uSWRbXSBfY2FsbGJh\nY2tzID0gbnVsbDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBw\nbHkgdGFibGUgYW5kIGFjdGlvbi4KICAgICAqLwogICAgcHVibGljIFNlY29u\nZGFyeVJvdyhUYWJsZSB0YWJsZSwgaW50IGFjdGlvbikgewogICAgICAgIHN1\ncGVyKHRhYmxlLCBhY3Rpb24pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndEZvcmVpZ25LZXkoRm9yZWlnbktleSBmaywgT3BlbkpQQVN0YXRlTWFuYWdl\nciBzbSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBz\nZXRGb3JlaWduS2V5KGZrLCBudWxsLCBzbSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0Rm9yZWlnbktleShGb3JlaWduS2V5IGZrLCBDb2x1bW5JTyBp\nbywKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICghZGVsYXlGb3JlaWdu\nS2V5KGZrLCBzbSkpIHsKICAgICAgICAgICAgc3VwZXIuc2V0Rm9yZWlnbktl\neShmaywgaW8sIHNtKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0K\nCiAgICAgICAgLy8gZm9yY2UgdmFsaWQKICAgICAgICBpZiAoY2FuU2V0QW55\nKGlvLCBmay5nZXRDb2x1bW5zKCkubGVuZ3RoCiAgICAgICAgICAgICsgZmsu\nZ2V0Q29uc3RhbnRDb2x1bW5zKCkubGVuZ3RoLCBmYWxzZSkpCiAgICAgICAg\nICAgIHNldFZhbGlkKHRydWUpOwoKICAgICAgICAvLyByZWNvcmQgZm9yZWln\nIGtleSBmb3IgZGVsYXllZCBmbHVzaAogICAgICAgIGlmIChfZmtzID09IG51\nbGwpCiAgICAgICAgICAgIF9ma3MgPSBuZXcgT3BlbkpQQVN0YXRlTWFuYWdl\ncltnZXRUYWJsZSgpLmdldEZvcmVpZ25LZXlzKCkubGVuZ3RoXTsKICAgICAg\nICBfZmtzW2ZrLmdldEluZGV4KCldID0gc207CgogICAgICAgIGlmIChfZmtJ\nTyAhPSBudWxsKQogICAgICAgICAgICBfZmtJT1tmay5nZXRJbmRleCgpXSA9\nIGlvOwogICAgICAgIGVsc2UgaWYgKGlvICE9IG51bGwKICAgICAgICAgICAg\nJiYgKChnZXRBY3Rpb24oKSA9PSBBQ1RJT05fSU5TRVJUCiAgICAgICAgICAg\nICYmICFpby5pc0FsbEluc2VydGFibGUoZmssIGZhbHNlKSkKICAgICAgICAg\nICAgfHwgKGdldEFjdGlvbigpICE9IEFDVElPTl9JTlNFUlQKICAgICAgICAg\nICAgJiYgIWlvLmlzQWxsVXBkYXRhYmxlKGZrLCBmYWxzZSkpKSkgewogICAg\nICAgICAgICBfZmtJTyA9IG5ldyBDb2x1bW5JT1tfZmtzLmxlbmd0aF07CiAg\nICAgICAgICAgIF9ma0lPW2ZrLmdldEluZGV4KCldID0gaW87CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmVjb3JkIGZvcmVpZ24ga2V5cyB0\nbyBuZXcgYXV0by1pbmMgaW5zdGFuY2VzOyBmbHVzaCB0aGVtIG9ubHkgd2hl\nbgogICAgICogd2UgaGF2ZSB0byBnZW5lcmF0ZSBvdXIgU1FMIHRvIGdpdmUg\ndGhlIGluc3RhbmNlIGEgY2hhbmNlIHRvIGZpbmFsaXplCiAgICAgKiBpdHMg\ndmFsdWVzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gZGVsYXlGb3Jl\naWduS2V5KEZvcmVpZ25LZXkgZmssIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20p\nIHsKICAgICAgICByZXR1cm4gZmsuaXNQcmltYXJ5S2V5QXV0b0Fzc2lnbmVk\nKCkgJiYgZ2V0QWN0aW9uKCkgIT0gQUNUSU9OX0RFTEVURQogICAgICAgICAg\nICAmJiBzbSAhPSBudWxsICYmIHNtLmlzTmV3KCkgJiYgIXNtLmlzRmx1c2hl\nZCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFJlbGF0aW9uSWQoQ29s\ndW1uIGNvbCwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAgICBSZWxh\ndGlvbklkIHJlbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoc20gPT0gbnVsbCB8fCBzbS5nZXRPYmplY3RJZCgpICE9IG51\nbGwgfHwgIXNtLmlzTmV3KCkKICAgICAgICAgICAgfHwgc20uaXNGbHVzaGVk\nKCkgfHwgIWlzUHJpbWFyeUtleUF1dG9Bc3NpZ25lZChzbSkpCiAgICAgICAg\nICAgIHN1cGVyLnNldFJlbGF0aW9uSWQoY29sLCBzbSwgcmVsKTsKICAgICAg\nICBlbHNlIHsKICAgICAgICAgICAgaWYgKF9yZWxzID09IG51bGwpIHsKICAg\nICAgICAgICAgICAgIENvbHVtbltdIGNvbHMgPSBnZXRUYWJsZSgpLmdldFJl\nbGF0aW9uSWRDb2x1bW5zKCk7CiAgICAgICAgICAgICAgICBfcmVscyA9IG5l\ndyBPcGVuSlBBU3RhdGVNYW5hZ2VyW2NvbHMubGVuZ3RoXTsKICAgICAgICAg\nICAgICAgIF9jYWxsYmFja3MgPSBuZXcgUmVsYXRpb25JZFtjb2xzLmxlbmd0\naF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW50IGlkeCA9IGdldFJl\nbGF0aW9uSWRJbmRleChjb2wpOwogICAgICAgICAgICBfcmVsc1tpZHhdID0g\nc207CiAgICAgICAgICAgIF9jYWxsYmFja3NbaWR4XSA9IHJlbDsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IGlu\ndG8gb3VyIHJlbGF0aW9uIGlkIGFycmF5IG9mIHRoZSB2YWx1ZSBmb3IgdGhl\nCiAgICAgKiBnaXZlbiBjb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgaW50\nIGdldFJlbGF0aW9uSWRJbmRleChDb2x1bW4gY29sKSB7CiAgICAgICAgQ29s\ndW1uW10gY29scyA9IGdldFRhYmxlKCkuZ2V0UmVsYXRpb25JZENvbHVtbnMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIGlmIChjb2xzW2ldID09IGNvbCkKICAgICAgICAg\nICAgICAgIHJldHVybiBpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIGFueSBwcmltYXJ5IGtleSBj\nb2x1bW5zIG9mIHRoZSBnaXZlbiBpbnN0YW5jZSBhcmUKICAgICAqIGF1dG8t\nYXNzaWduZWQuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\naXNQcmltYXJ5S2V5QXV0b0Fzc2lnbmVkKE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nc20pIHsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gKENsYXNzTWFwcGlu\nZykgc20uZ2V0TWV0YURhdGEoKTsKICAgICAgICB3aGlsZSAoY2xzLmdldEpv\naW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwpCiAgICAgICAg\nICAgIGNscyA9IGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmco\nKTsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gY2xzLmdldFByaW1hcnlLZXlD\nb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoY29sc1tpXS5pc0F1dG9Bc3Np\nZ25lZCgpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2Vu\nZXJhdGVTUUwoREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBpZiAoX2ZrcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBGb3JlaWduS2V5W10gZmtzID0gZ2V0VGFibGUoKS5nZXRGb3JlaWduS2V5\ncygpOwogICAgICAgICAgICAgICAgQ29sdW1uSU8gaW87CiAgICAgICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9ma3MubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAoX2Zrc1tpXSAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlvID0gKF9ma0lPID09IG51bGwpID8g\nbnVsbCA6IF9ma0lPW2ldOwogICAgICAgICAgICAgICAgICAgICAgICBzdXBl\nci5zZXRGb3JlaWduS2V5KGZrc1tpXSwgaW8sIF9ma3NbaV0pOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgICAgICBpZiAoX3JlbHMgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgQ29sdW1uW10gY29scyA9IGdldFRhYmxlKCkuZ2V0UmVsYXRpb25J\nZENvbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgX3JlbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgaWYg\nKF9yZWxzW2ldICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIHN1\ncGVyLnNldFJlbGF0aW9uSWQoY29sc1tpXSwgX3JlbHNbaV0sIF9jYWxsYmFj\na3NbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhj\nZXB0aW9ucy5nZXRTdG9yZShzZSwgZGljdCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBzdXBlci5nZW5lcmF0ZVNRTChkaWN0KTsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgUm93SW1wbCBuZXdJbnN0YW5jZShUYWJsZSB0YWJsZSwgaW50\nIGFjdGlvbikgewogICAgICAgIHJldHVybiBuZXcgU2Vjb25kYXJ5Um93KHRh\nYmxlLCBhY3Rpb24pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvcHlJbnRv\nKFJvd0ltcGwgcm93LCBib29sZWFuIHdoZXJlT25seSkgewogICAgICAgIHN1\ncGVyLmNvcHlJbnRvKHJvdywgd2hlcmVPbmx5KTsKICAgICAgICBpZiAoX2Zr\ncyA9PSBudWxsIHx8IHdoZXJlT25seSB8fCByb3cuZ2V0QWN0aW9uKCkgPT0g\nQUNUSU9OX0RFTEVURQogICAgICAgICAgICB8fCAhKHJvdyBpbnN0YW5jZW9m\nIFNlY29uZGFyeVJvdykpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nU2Vjb25kYXJ5Um93IHNyb3cgPSAoU2Vjb25kYXJ5Um93KSByb3c7CiAgICAg\nICAgaWYgKHNyb3cuX2ZrcyA9PSBudWxsKQogICAgICAgICAgICBzcm93Ll9m\na3MgPSBuZXcgT3BlbkpQQVN0YXRlTWFuYWdlcltfZmtzLmxlbmd0aF07CiAg\nICAgICAgU3lzdGVtLmFycmF5Y29weShfZmtzLCAwLCBzcm93Ll9ma3MsIDAs\nIF9ma3MubGVuZ3RoKTsKICAgICAgICBpZiAoX2ZrSU8gIT0gbnVsbCkgewog\nICAgICAgICAgICBpZiAoc3Jvdy5fZmtJTyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgc3Jvdy5fZmtJTyA9IG5ldyBDb2x1bW5JT1tfZmtJTy5sZW5ndGhd\nOwogICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KF9ma0lPLCAwLCBzcm93\nLl9ma0lPLCAwLCBfZmtJTy5sZW5ndGgpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

