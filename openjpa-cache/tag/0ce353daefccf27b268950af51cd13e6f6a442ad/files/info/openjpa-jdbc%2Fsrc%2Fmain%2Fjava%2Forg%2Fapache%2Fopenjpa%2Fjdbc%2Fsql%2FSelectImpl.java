{"sha":"55aa62cbfecdc690d364bca17a8f0c98cebed98a","node_id":"MDQ6QmxvYjIwNjM2NDo1NWFhNjJjYmZlY2RjNjkwZDM2NGJjYTE3YThmMGM5OGNlYmVkOThh","size":90268,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/55aa62cbfecdc690d364bca17a8f0c98cebed98a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLnNxbC5Db25uZWN0aW9u\nOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBq\nYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRp\nb247CmltcG9ydCBqYXZhLnNxbC5TdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNx\nbC5UeXBlczsKaW1wb3J0IGphdmEudXRpbC5BYnN0cmFjdExpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBq\nYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0Owpp\nbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNl\ndDsKaW1wb3J0IGphdmEudXRpbC5Tb3J0ZWRNYXA7CmltcG9ydCBqYXZhLnV0\naWwuU3RhY2s7CmltcG9ydCBqYXZhLnV0aWwuVHJlZU1hcDsKCmltcG9ydCBv\ncmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuaXRlcmF0b3JzLkVtcHR5\nSXRlcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYu\nSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5rZXJuZWwuRWFnZXJGZXRjaE1vZGVzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ0xv\nY2tNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2Vy\nbmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDU3RvcmVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuSm9pbmFibGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVlTWFwcGluZzsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktl\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJs\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVDb250\nZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkFwcGxpY2F0aW9uSWRz\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSWQ7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1w\nb3J0IHNlcnAudXRpbC5OdW1iZXJzOwoKLyoqCiAqIFN0YW5kYXJkIHtAbGlu\nayBTZWxlY3R9IGltcGxlbWVudGF0aW9uLiBVc2FnZSBub3RlOiB0aG91Z2gg\ndGhpcyBjbGFzcwogKiBpbXBsZW1lbnRzIHtAbGluayBKb2luc30sIGl0IHNo\nb3VsZCBub3QgYmUgdXNlZCBmb3Igam9pbmluZyBkaXJlY3RseS4KICogSW5z\ndGVhZCwgdXNlIHRoZSByZXR1cm4gdmFsdWUgb2Yge0BsaW5rICNuZXdKb2lu\nc30uCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICov\nCnB1YmxpYyBjbGFzcyBTZWxlY3RJbXBsCiAgICBpbXBsZW1lbnRzIFNlbGVj\ndCwgUGF0aEpvaW5zIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQg\nTk9OQVVUT19ESVNUSU5DVCA9IDIgPDwgMDsKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIGludCBESVNUSU5DVCA9IDIgPDwgMTsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIGludCBOT1RfRElTVElOQ1QgPSAyIDw8IDI7CiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBpbnQgSU1QTElDSVRfRElTVElOQ1QgPSAyIDw8\nIDM7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgVE9fTUFOWSA9IDIg\nPDwgNDsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBBR0dSRUdBVEUg\nPSAyIDw8IDU7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgTE9CID0g\nMiA8PCA2OwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IE9VVEVSID0g\nMiA8PCA3OwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IExSUyA9IDIg\nPDwgODsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBFQUdFUl9UT19P\nTkUgPSAyIDw8IDk7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgRUFH\nRVJfVE9fTUFOWSA9IDIgPDwgMTA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgUkVDT1JEX09SREVSRUQgPSAyIDw8IDExOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IEdST1VQSU5HID0gMiA8PCAxMjsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBUQUJMRV9BTElBU0VTID0gbmV3\nIFN0cmluZ1sxNl07CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmdb\nXSBPUkRFUl9BTElBU0VTID0gbmV3IFN0cmluZ1sxNl07CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBPYmplY3RbXSBOVUxMX0lEUyA9IG5ldyBPYmplY3Rb\nMTZdOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgT2JqZWN0W10gUExBQ0VI\nT0xERVJTID0gbmV3IE9iamVjdFs1MF07CgogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShT\nZWxlY3QuY2xhc3MpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBUQUJMRV9BTElBU0VTLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICBUQUJMRV9BTElBU0VTW2ldID0gInQiICsgaTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IE9SREVSX0FMSUFTRVMubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgIE9SREVSX0FMSUFTRVNbaV0gPSAibyIgKyBpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgTlVMTF9JRFMubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgIE5VTExfSURTW2ldID0gbmV3IE51bGxJZCgpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgUExBQ0VIT0xERVJTLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICBQTEFDRUhPTERFUlNbaV0gPSBuZXcgUGxhY2Vob2xk\nZXIoKTsKICAgIH0KCiAgICBwcml2YXRlIGZpbmFsIEpEQkNDb25maWd1cmF0\naW9uIF9jb25mOwogICAgcHJpdmF0ZSBmaW5hbCBEQkRpY3Rpb25hcnkgX2Rp\nY3Q7CgogICAgLy8gbWFwIG9mIHZhcmlhYmxlICsgcmVsYXRpb24gcGF0aCAr\nIHRhYmxlIGtleXMgdG8gdGhlIGNvcnJlY3QgYWxpYXMgaW5kZXg6CiAgICAv\nLyBlYWNoIHJlbGF0aW9uIHBhdGgvdGFibGUgY29tYmluYXRpb24gc2hvdWxk\nIGhhdmUgYSB1bmlxdWUgYWxpYXMgYmVjYXVzZQogICAgLy8gaXQgcmVwcmVz\nZW50cyBhIHNlcGFyYXRlIG9iamVjdDsgZm9yIGV4YW1wbGUsIGlmIGEgUGVy\nc29uIGNsYXNzIGhhcyBhCiAgICAvLyAncGFyZW50JyBmaWVsZCByZXByZXNl\nbnRpbmcgYW5vdGhlciBQZXJzb24gYW5kIGFsc28gaGFzIGFuICdhZGRyZXNz\nJwogICAgLy8gZmllbGQgb2YgdHlwZSBBZGRyZXNzOgogICAgLy8gJ2FkZHJl\nc3Muc3RyZWV0JyBzaG91bGQgbWFwIHRvIGEgZGlmZmVyZW50IHRhYmxlIGFs\naWFzIHRoYW4KICAgIC8vICdwYXJlbnQuYWRkcmVzcy5zdHJlZXQnIGZvciB0\naGUgcHVycG9zZXMgb2YgY29tcGFyaXNvbnMKICAgIHByaXZhdGUgTWFwIF9h\nbGlhc2VzID0gbnVsbDsKCiAgICAvLyBtYXAgb2YgaW5kZXhlcyB0byB0YWJs\nZSBhbGlhc2VzIGxpa2UgJ1RBQkxFTkFNRSB0MCcKICAgIHByaXZhdGUgU29y\ndGVkTWFwIF90YWJsZXMgPSBudWxsOwoKICAgIC8vIGNvbWJpbmVkIGxpc3Qg\nb2Ygc2VsZWN0ZWQgaWRzIGFuZCBtYXAgb2YgZWFjaCBpZCB0byBpdHMgYWxp\nYXMKICAgIHByaXZhdGUgZmluYWwgU2VsZWN0cyBfc2VsZWN0cyA9IG5ldyBT\nZWxlY3RzKCk7CiAgICBwcml2YXRlIExpc3QgX29yZGVyZWQgPSBudWxsOwoK\nICAgIC8vIGZsYWdzCiAgICBwcml2YXRlIGludCBfZmxhZ3MgPSAwOwogICAg\ncHJpdmF0ZSBpbnQgX2pvaW5TeW50YXggPSAwOwogICAgcHJpdmF0ZSBsb25n\nIF9zdGFydElkeCA9IDA7CiAgICBwcml2YXRlIGxvbmcgX2VuZElkeCA9IExv\nbmcuTUFYX1ZBTFVFOwogICAgcHJpdmF0ZSBpbnQgX251bGxJZHMgPSAwOwog\nICAgcHJpdmF0ZSBpbnQgX29yZGVycyA9IDA7CiAgICBwcml2YXRlIGludCBf\ncGxhY2Vob2xkZXJzID0gMDsKCiAgICAvLyBxdWVyeSBjbGF1c2VzCiAgICBw\ncml2YXRlIFNRTEJ1ZmZlciBfb3JkZXJpbmcgPSBudWxsOwogICAgcHJpdmF0\nZSBTUUxCdWZmZXIgX3doZXJlID0gbnVsbDsKICAgIHByaXZhdGUgU1FMQnVm\nZmVyIF9ncm91cGluZyA9IG51bGw7CiAgICBwcml2YXRlIFNRTEJ1ZmZlciBf\naGF2aW5nID0gbnVsbDsKCiAgICAvLyBqb2lucyB0byBhZGQgdG8gdGhlIGVu\nZCBvZiBvdXIgd2hlcmUgY2xhdXNlLCBhbmQgam9pbnMgdG8gcHJlcGVuZCB0\nbwogICAgLy8gYWxsIHNlbGVjdHMgKHNlZSBzZWxlY3QoY2xhc3NtYXBwaW5n\nKSBtZXRob2QpCiAgICBwcml2YXRlIFNlbGVjdEpvaW5zIF9qb2lucyA9IG51\nbGw7CiAgICBwcml2YXRlIFN0YWNrIF9wcmVKb2lucyA9IG51bGw7CgogICAg\nLy8gbWFwIG9mIGpvaW5zK2tleXMgdG8gZWFnZXIgc2VsZWN0cyBhbmQgZ2xv\nYmFsIHNldCBvZiBlYWdlciBrZXlzOyB0aGUKICAgIC8vIHNhbWUga2V5IGNh\nbid0IGJlIHVzZWQgbW9yZSB0aGFuIG9uY2UKICAgIHByaXZhdGUgTWFwIF9l\nYWdlciA9IG51bGw7CiAgICBwcml2YXRlIFNldCBfZWFnZXJLZXlzID0gbnVs\nbDsKCiAgICAvLyBzdWJzZWxlY3Qgc3VwcG9ydAogICAgcHJpdmF0ZSBMaXN0\nIF9zdWJzZWxzID0gbnVsbDsKICAgIHByaXZhdGUgU2VsZWN0SW1wbCBfcGFy\nZW50ID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9zdWJQYXRoID0gbnVs\nbDsKCiAgICAvLyBmcm9tIHNlbGVjdCBpZiB0aGlzIHNlbGVjdCBzZWxlY3Rz\nIGZyb20gYSB0bXAgdGFibGUgY3JlYXRlZCBieSBhbm90aGVyCiAgICBwcml2\nYXRlIFNlbGVjdEltcGwgX2Zyb20gPSBudWxsOwogICAgcHJpdmF0ZSBTZWxl\nY3RJbXBsIF9vdXRlciA9IG51bGw7CgogICAgLyoqCiAgICAgKiBIZWxwZXIg\nbWV0aG9kIHRvIHJldHVybiB0aGUgcHJvcGVyIHRhYmxlIGFsaWFzIGZvciB0\naGUgZ2l2ZW4gYWxpYXMgaW5kZXguCiAgICAgKi8KICAgIHN0YXRpYyBTdHJp\nbmcgdG9BbGlhcyhpbnQgaW5kZXgpIHsKICAgICAgICBpZiAoaW5kZXggPT0g\nLTEpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChpbmRl\neCA8IFRBQkxFX0FMSUFTRVMubGVuZ3RoKQogICAgICAgICAgICByZXR1cm4g\nVEFCTEVfQUxJQVNFU1tpbmRleF07CiAgICAgICAgcmV0dXJuICJ0IiArIGlu\nZGV4OwogICAgfQoKICAgIC8qKgogICAgICogSGVscGVyIG1ldGhvZCB0byBy\nZXR1cm4gdGhlIHByb3BlciBvcmRlciBhbGlhcyBmb3IgdGhlIGdpdmVuIG9y\nZGVyCiAgICAgKiBjb2x1bW4gaW5kZXguCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgU3RyaW5nIHRvT3JkZXJBbGlhcyhpbnQgaW5kZXgpIHsKICAgICAg\nICBpZiAoaW5kZXggPT0gLTEpCiAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIGlmIChpbmRleCA8IE9SREVSX0FMSUFTRVMubGVuZ3RoKQogICAg\nICAgICAgICByZXR1cm4gT1JERVJfQUxJQVNFU1tpbmRleF07CiAgICAgICAg\ncmV0dXJuICJvIiArIGluZGV4OwogICAgfQoKICAgIC8qKgogICAgICogQ29u\nc3RydWN0b3IuIFN1cHBseSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgU2VsZWN0SW1wbChKREJDQ29uZmlndXJhdGlvbiBjb25mKSB7CiAg\nICAgICAgX2NvbmYgPSBjb25mOwogICAgICAgIF9kaWN0ID0gX2NvbmYuZ2V0\nREJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBfam9pblN5bnRheCA9\nIF9kaWN0LmpvaW5TeW50YXg7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBTZWxlY3RFeGVjdXRvciBpbXBs\nZW1lbnRhdGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vCgogICAgcHVibGljIEpEQkNDb25maWd1cmF0aW9uIGdldENvbmZpZ3Vy\nYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9jb25mOwogICAgfQoKICAgIHB1\nYmxpYyBTUUxCdWZmZXIgdG9TZWxlY3QoYm9vbGVhbiBmb3JVcGRhdGUsIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4g\nX2RpY3QudG9TZWxlY3QodGhpcywgZm9yVXBkYXRlLCBmZXRjaCk7CiAgICB9\nCgogICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdENvdW50KCkgewogICAg\nICAgIHJldHVybiBfZGljdC50b1NlbGVjdENvdW50KHRoaXMpOwogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGdldEF1dG9EaXN0aW5jdCgpIHsKICAgICAg\nICByZXR1cm4gKF9mbGFncyAmIE5PTkFVVE9fRElTVElOQ1QpID09IDA7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0Rpc3RpbmN0KGJvb2xlYW4g\ndmFsKSB7CiAgICAgICAgaWYgKHZhbCkKICAgICAgICAgICAgX2ZsYWdzICY9\nIH5OT05BVVRPX0RJU1RJTkNUOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nX2ZsYWdzIHw9IE5PTkFVVE9fRElTVElOQ1Q7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNEaXN0aW5jdCgpIHsKICAgICAgICByZXR1cm4gKF9mbGFn\ncyAmIE5PVF9ESVNUSU5DVCkgPT0gMCAmJiAoKF9mbGFncyAmIERJU1RJTkNU\nKSAhPSAwCiAgICAgICAgICAgIHx8ICgoX2ZsYWdzICYgTk9OQVVUT19ESVNU\nSU5DVCkgPT0gMAogICAgICAgICAgICAmJiAoX2ZsYWdzICYgSU1QTElDSVRf\nRElTVElOQ1QpICE9IDApKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRE\naXN0aW5jdChib29sZWFuIGRpc3RpbmN0KSB7CiAgICAgICAgLy8gbmVlZCB0\nd28gZmxhZ3MgaW4gY2FzZSBzZXQgbm90X2Rpc3RpbmN0LCB0aGVuIGEgdG8t\nbWFueSBqb2luIGhhcHBlbnMKICAgICAgICAvLyBhbmQgZGlzdGluY3QgZmxh\nZyBnZXRzIHNldCBhdXRvbWF0aWNhbGx5CiAgICAgICAgaWYgKGRpc3RpbmN0\nKSB7CiAgICAgICAgICAgIF9mbGFncyB8PSBESVNUSU5DVDsKICAgICAgICAg\nICAgX2ZsYWdzICY9IH5OT1RfRElTVElOQ1Q7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgX2ZsYWdzIHw9IE5PVF9ESVNUSU5DVDsKICAgICAgICAg\nICAgX2ZsYWdzICY9IH5ESVNUSU5DVDsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gaXNMUlMoKSB7CiAgICAgICAgcmV0dXJuIChfZmxh\nZ3MgJiBMUlMpICE9IDA7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TFJT\nKGJvb2xlYW4gbHJzKSB7CiAgICAgICAgaWYgKGxycykKICAgICAgICAgICAg\nX2ZsYWdzIHw9IExSUzsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9mbGFn\ncyAmPSB+TFJTOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0Sm9pblN5bnRh\neCgpIHsKICAgICAgICByZXR1cm4gX2pvaW5TeW50YXg7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0Sm9pblN5bnRheChpbnQgam9pblN5bnRheCkgewog\nICAgICAgIF9qb2luU3ludGF4ID0gam9pblN5bnRheDsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c1JhbmRvbUFjY2Vzcyhib29sZWFuIGZv\nclVwZGF0ZSkgewogICAgICAgIHJldHVybiBfZGljdC5zdXBwb3J0c1JhbmRv\nbUFjY2Vzc1Jlc3VsdFNldCh0aGlzLCBmb3JVcGRhdGUpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9ja2luZygpIHsKICAgICAgICBy\nZXR1cm4gX2RpY3Quc3VwcG9ydHNMb2NraW5nKHRoaXMpOwogICAgfQoKICAg\nIHB1YmxpYyBpbnQgZ2V0Q291bnQoSkRCQ1N0b3JlIHN0b3JlKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIENvbm5lY3Rpb24gY29u\nbiA9IG51bGw7CiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBu\ndWxsOwogICAgICAgIFJlc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgU1FMQnVmZmVyIHNxbCA9IHRvU2VsZWN0Q291bnQo\nKTsKICAgICAgICAgICAgY29ubiA9IHN0b3JlLmdldENvbm5lY3Rpb24oKTsK\nICAgICAgICAgICAgc3RtbnQgPSBzcWwucHJlcGFyZVN0YXRlbWVudChjb25u\nKTsKICAgICAgICAgICAgcnMgPSBzdG1udC5leGVjdXRlUXVlcnkoKTsKICAg\nICAgICAgICAgcnMubmV4dCgpOwogICAgICAgICAgICByZXR1cm4gcnMuZ2V0\nSW50KDEpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChy\ncyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgcnMuY2xvc2UoKTsg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgICAgICBpZiAo\nc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7IHN0bW50LmNs\nb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAg\nICAgaWYgKGNvbm4gIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7IGNv\nbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgUmVzdWx0IGV4ZWN1dGUoSkRCQ1N0\nb3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChmZXRjaCA9\nPSBudWxsKQogICAgICAgICAgICBmZXRjaCA9IHN0b3JlLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpOwogICAgICAgIHJldHVybiBleGVjdXRlKHN0b3JlLmdl\ndENvbnRleHQoKSwgc3RvcmUsIGZldGNoLAogICAgICAgICAgICBmZXRjaC5n\nZXRSZWFkTG9ja0xldmVsKCkpOwogICAgfQoKICAgIHB1YmxpYyBSZXN1bHQg\nZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb24gZmV0Y2gsCiAgICAgICAgaW50IGxvY2tMZXZlbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoZmV0Y2ggPT0gbnVsbCkK\nICAgICAgICAgICAgZmV0Y2ggPSBzdG9yZS5nZXRGZXRjaENvbmZpZ3VyYXRp\nb24oKTsKICAgICAgICByZXR1cm4gZXhlY3V0ZShzdG9yZS5nZXRDb250ZXh0\nKCksIHN0b3JlLCBmZXRjaCwgbG9ja0xldmVsKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEV4ZWN1dGUgdGhpcyBzZWxlY3QgaW4gdGhlIGNvbnRleHQgb2Yg\ndGhlIGdpdmVuIHN0b3JlIG1hbmFnZXIuIFRoZQogICAgICogY29udGV4dCBp\ncyBwYXNzZWQgaW4gc2VwYXJhdGVseSBmb3IgcHJvZmlsaW5nIHB1cnBvc2Vz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgUmVzdWx0IGV4ZWN1dGUoU3RvcmVD\nb250ZXh0IGN0eCwgSkRCQ1N0b3JlIHN0b3JlLCAKICAgICAgICBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgbG9ja0xldmVsKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGJvb2xlYW4gZm9yVXBk\nYXRlID0gZmFsc2U7CiAgICAgICAgaWYgKCFpc0FnZ3JlZ2F0ZSgpICYmIF9n\ncm91cGluZyA9PSBudWxsKSB7CiAgICAgICAgICAgIEpEQkNMb2NrTWFuYWdl\nciBsbSA9IHN0b3JlLmdldExvY2tNYW5hZ2VyKCk7CiAgICAgICAgICAgIGlm\nIChsbSAhPSBudWxsKQogICAgICAgICAgICAgICAgZm9yVXBkYXRlID0gbG0u\nc2VsZWN0Rm9yVXBkYXRlKHRoaXMsIGxvY2tMZXZlbCk7CiAgICAgICAgfQoK\nICAgICAgICBTUUxCdWZmZXIgc3FsID0gdG9TZWxlY3QoZm9yVXBkYXRlLCBm\nZXRjaCk7CiAgICAgICAgaW50IHJzVHlwZSA9IChpc0xSUygpICYmIHN1cHBv\ncnRzUmFuZG9tQWNjZXNzKGZvclVwZGF0ZSkpCiAgICAgICAgICAgID8gLTEg\nOiBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAgICAgICAgQ29ubmVj\ndGlvbiBjb25uID0gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICBSZXN1bHRT\nZXQgcnMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChp\nc0xSUygpKQogICAgICAgICAgICAgICAgc3RtbnQgPSBzcWwucHJlcGFyZVN0\nYXRlbWVudChjb25uLCBmZXRjaCwgcnNUeXBlLCAtMSk7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIHN0bW50ID0gc3FsLnByZXBhcmVTdGF0\nZW1lbnQoY29ubiwgcnNUeXBlLCAtMSk7CiAgICAgICAgICAgIHJzID0gc3Rt\nbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgIC8vIGNsZWFuIHVwIHN0YXRlbWVudAog\nICAgICAgICAgICBpZiAoc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHRyeSB7IHN0bW50LmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZTIpIHt9CiAgICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlMikge30KICAgICAgICAgICAgdGhyb3cgc2U7\nCiAgICAgICAgfQoKICAgICAgICBTZWxlY3RSZXN1bHQgcmVzID0gbmV3IFNl\nbGVjdFJlc3VsdChjb25uLCBzdG1udCwgcnMsIF9kaWN0KTsKICAgICAgICBy\nZXMuc2V0U2VsZWN0KHRoaXMpOwogICAgICAgIHJlcy5zZXRTdG9yZShzdG9y\nZSk7CiAgICAgICAgcmVzLnNldExvY2tpbmcoZm9yVXBkYXRlKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBhZGRFYWdlclJlc3VsdHMocmVzLCB0aGlz\nLCBzdG9yZSwgZmV0Y2gpOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlv\nbiBzZSkgewogICAgICAgICAgICByZXMuY2xvc2UoKTsKICAgICAgICAgICAg\ndGhyb3cgc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXM7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBFeGVjdXRlIG91ciBlYWdlciBzZWxlY3RzLCBh\nZGRpbmcgdGhlIHJlc3VsdHMgdW5kZXIgdGhlIHNhbWUga2V5cwogICAgICog\ndG8gdGhlIGdpdmVuIHJlc3VsdC4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgdm9pZCBhZGRFYWdlclJlc3VsdHMoU2VsZWN0UmVzdWx0IHJlcywgU2Vs\nZWN0SW1wbCBzZWwsCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmIChzZWwuX2VhZ2VyID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gZXhlY3V0ZSBlYWdlciBzZWxl\nY3RzCiAgICAgICAgTWFwLkVudHJ5IGVudHJ5OwogICAgICAgIFJlc3VsdCBl\ncmVzOwogICAgICAgIE1hcCBlYWdlcjsKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IHNlbC5fZWFnZXIuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkp\nIGl0ci5uZXh0KCk7CgogICAgICAgICAgICAvLyBzaW11bGF0ZWQgYmF0Y2hl\nZCBzZWxlY3RzIGZvciBpbm5lci9vdXRlciBqb2luczsgZm9yIHNlcGFyYXRl\nCiAgICAgICAgICAgIC8vIHNlbGVjdHMsIGRvbid0IHBhc3Mgb24gbG9jayBs\nZXZlbCwgYmVjYXVzZSB0aGV5J3JlIHByb2JhYmx5CiAgICAgICAgICAgIC8v\nIGZvciByZWxhdGlvbnMgYW5kIHRoZXJlZm9yZSBzaG91bGQgdXNlIGRlZmF1\nbHQgbGV2ZWwKICAgICAgICAgICAgaWYgKGVudHJ5LmdldFZhbHVlKCkgPT0g\nc2VsKQogICAgICAgICAgICAgICAgZXJlcyA9IHJlczsKICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgZXJlcyA9ICgoU2VsZWN0RXhlY3V0b3Ip\nIGVudHJ5LmdldFZhbHVlKCkpLmV4ZWN1dGUoc3RvcmUsCiAgICAgICAgICAg\nICAgICAgICAgZmV0Y2gpOwoKICAgICAgICAgICAgZWFnZXIgPSByZXMuZ2V0\nRWFnZXJNYXAoZmFsc2UpOwogICAgICAgICAgICBpZiAoZWFnZXIgPT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgZWFnZXIgPSBuZXcgSGFzaE1hcCgpOwog\nICAgICAgICAgICAgICAgcmVzLnNldEVhZ2VyTWFwKGVhZ2VyKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBlYWdlci5wdXQoZW50cnkuZ2V0S2V5KCks\nIGVyZXMpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vCiAgICAvLyBTZWxlY3QgaW1wbGVtZW50YXRpb24KICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgaW50IGluZGV4\nT2YoKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgcHVibGljIExp\nc3QgZ2V0U3Vic2VsZWN0cygpIHsKICAgICAgICByZXR1cm4gKF9zdWJzZWxz\nID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVCA6IF9zdWJzZWxz\nOwogICAgfQoKICAgIHB1YmxpYyBTZWxlY3QgZ2V0UGFyZW50KCkgewogICAg\nICAgIHJldHVybiBfcGFyZW50OwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0U3Vic2VsZWN0UGF0aCgpIHsKICAgICAgICByZXR1cm4gX3N1YlBhdGg7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0UGFyZW50KFNlbGVjdCBwYXJl\nbnQsIFN0cmluZyBwYXRoKSB7CiAgICAgICAgaWYgKHBhdGggIT0gbnVsbCkK\nICAgICAgICAgICAgX3N1YlBhdGggPSBwYXRoICsgJzonOwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgX3N1YlBhdGggPSBudWxsOwoKICAgICAgICBpZiAo\ncGFyZW50ID09IF9wYXJlbnQpCiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICBpZiAoX3BhcmVudCAhPSBudWxsKQogICAgICAgICAgICBfcGFyZW50Ll9z\ndWJzZWxzLnJlbW92ZSh0aGlzKTsKCiAgICAgICAgLy8jIyMgcmlnaHQgbm93\nIHdlIGNhbid0IHVzZSBzcWw5MiBqb2lucyB3aXRoIHN1YnNlbGVjdHMsIGNh\ndXNlCiAgICAgICAgLy8jIyMgSSBjYW4ndCBmaWd1cmUgb3V0IHdoYXQgdG8g\nZG8gd2hlbiB0aGUgc3Vic2VsZWN0IGhhcyBhIGpvaW4KICAgICAgICAvLyMj\nIyB3aXRoIGFuIGFsaWFzIGFsc28gcHJlc2VudCBpbiB0aGUgb3V0ZXIgc2Vs\nZWN0Li4uIHlvdSBkb24ndCB3YW50CiAgICAgICAgLy8jIyMgdGhlIGpvaW4g\ndG8gYXBwZWFyIGluIHRoZSBGUk9NIGNsYXVzZSBvZiB0aGUgc3Vic2VsZWN0\nIGNhdXNlCiAgICAgICAgLy8jIyMgdGhlbiBpdCByZS1hbGlhc2VzIGJvdGgg\ndGFibGVzIGluIHRoZSBzY29wZSBvZiB0aGUgc3Vic2VsZWN0CiAgICAgICAg\nLy8jIyMgYW5kIHRoZSBjb3JyZWxhdGlvbiB3aXRoIHRoZSBvdXRlciBzZWxl\nY3QgaXMgbG9zdAogICAgICAgIF9wYXJlbnQgPSAoU2VsZWN0SW1wbCkgcGFy\nZW50OwogICAgICAgIGlmIChfcGFyZW50ICE9IG51bGwpIHsKICAgICAgICAg\nICAgaWYgKF9wYXJlbnQuX3N1YnNlbHMgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgIF9wYXJlbnQuX3N1YnNlbHMgPSBuZXcgQXJyYXlMaXN0KDIpOwogICAg\nICAgICAgICBfcGFyZW50Ll9zdWJzZWxzLmFkZCh0aGlzKTsKICAgICAgICAg\nICAgaWYgKF9wYXJlbnQuX2pvaW5TeW50YXggPT0gSm9pblN5bnRheGVzLlNZ\nTlRBWF9TUUw5MikKICAgICAgICAgICAgICAgIF9qb2luU3ludGF4ID0gSm9p\nblN5bnRheGVzLlNZTlRBWF9UUkFESVRJT05BTDsKICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgX2pvaW5TeW50YXggPSBfcGFyZW50Ll9qb2lu\nU3ludGF4OwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgU2VsZWN0IGdl\ndEZyb21TZWxlY3QoKSB7CiAgICAgICAgcmV0dXJuIF9mcm9tOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldEZyb21TZWxlY3QoU2VsZWN0IHNlbCkgewog\nICAgICAgIF9mcm9tID0gKFNlbGVjdEltcGwpIHNlbDsKICAgICAgICBpZiAo\nX2Zyb20gIT0gbnVsbCkKICAgICAgICAgICAgX2Zyb20uX291dGVyID0gdGhp\nczsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNFYWdlckpvaW4oYm9v\nbGVhbiB0b01hbnkpIHsKICAgICAgICBpZiAodG9NYW55KQogICAgICAgICAg\nICByZXR1cm4gKF9mbGFncyAmIEVBR0VSX1RPX01BTlkpICE9IDA7CiAgICAg\nICAgcmV0dXJuIChfZmxhZ3MgJiBFQUdFUl9UT19PTkUpICE9IDA7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gaGFzSm9pbihib29sZWFuIHRvTWFueSkg\newogICAgICAgIGlmICh0b01hbnkpCiAgICAgICAgICAgIHJldHVybiAoX2Zs\nYWdzICYgVE9fTUFOWSkgIT0gMDsKICAgICAgICByZXR1cm4gX3RhYmxlcyAh\nPSBudWxsICYmIF90YWJsZXMuc2l6ZSgpID4gMTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1NlbGVjdGVkKFRhYmxlIHRhYmxlKSB7CiAgICAgICAg\nUGF0aEpvaW5zIHBqID0gZ2V0Sm9pbnMobnVsbCwgZmFsc2UpOwogICAgICAg\nIGlmIChfZnJvbSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gX2Zyb20u\nZ2V0VGFibGVJbmRleCh0YWJsZSwgcGosIGZhbHNlKSAhPSAtMTsKICAgICAg\nICByZXR1cm4gZ2V0VGFibGVJbmRleCh0YWJsZSwgcGosIGZhbHNlKSAhPSAt\nMTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRUYWJsZUFsaWFz\nZXMoKSB7CiAgICAgICAgcmV0dXJuIChfdGFibGVzID09IG51bGwpID8gQ29s\nbGVjdGlvbnMuRU1QVFlfU0VUIDogX3RhYmxlcy52YWx1ZXMoKTsKICAgIH0K\nCiAgICBwdWJsaWMgTGlzdCBnZXRTZWxlY3RBbGlhc2VzKCkgewogICAgICAg\nIHJldHVybiBfc2VsZWN0cy5nZXRBbGlhc2VzKGZhbHNlLCBfb3V0ZXIgIT0g\nbnVsbCk7CiAgICB9CgogICAgcHVibGljIExpc3QgZ2V0SWRlbnRpZmllckFs\naWFzZXMoKSB7CiAgICAgICAgcmV0dXJuIF9zZWxlY3RzLmdldEFsaWFzZXMo\ndHJ1ZSwgX291dGVyICE9IG51bGwpOwogICAgfQoKICAgIHB1YmxpYyBTUUxC\ndWZmZXIgZ2V0T3JkZXJpbmcoKSB7CiAgICAgICAgcmV0dXJuIF9vcmRlcmlu\nZzsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIGdldEdyb3VwaW5nKCkg\newogICAgICAgIHJldHVybiBfZ3JvdXBpbmc7CiAgICB9CgogICAgcHVibGlj\nIFNRTEJ1ZmZlciBnZXRXaGVyZSgpIHsKICAgICAgICByZXR1cm4gX3doZXJl\nOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgZ2V0SGF2aW5nKCkgewog\nICAgICAgIHJldHVybiBfaGF2aW5nOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZEpvaW5DbGFzc0NvbmRpdGlvbnMoKSB7CiAgICAgICAgaWYgKF9qb2lu\ncyA9PSBudWxsIHx8IF9qb2lucy5qb2lucygpID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgLy8gam9pbiBzZXQgaXRlcmF0b3IgYWxs\nb3dzIGNvbmN1cnJlbnQgbW9kaWZpY2F0aW9uCiAgICAgICAgSm9pbiBqOwog\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2pvaW5zLmpvaW5zKCkuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgaiA9IChK\nb2luKSBpdHIubmV4dCgpOwogICAgICAgICAgICBpZiAoai5nZXRSZWxhdGlv\nblRhcmdldCgpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGouZ2V0UmVs\nYXRpb25UYXJnZXQoKS5nZXREaXNjcmltaW5hdG9yKCkuYWRkQ2xhc3NDb25k\naXRpb25zCiAgICAgICAgICAgICAgICAgICAgKHRoaXMsIGouZ2V0U3ViY2xh\nc3NlcygpID09IFNVQlNfSk9JTkFCTEUsIAogICAgICAgICAgICAgICAgICAg\nIGouZ2V0UmVsYXRpb25Kb2lucygpKTsKICAgICAgICAgICAgICAgIGouc2V0\nUmVsYXRpb24obnVsbCwgMCwgbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIEpvaW5zIGdldEpvaW5zKCkgewogICAg\nICAgIHJldHVybiBfam9pbnM7CiAgICB9CgogICAgcHVibGljIEl0ZXJhdG9y\nIGdldEpvaW5JdGVyYXRvcigpIHsKICAgICAgICBpZiAoX2pvaW5zID09IG51\nbGwgfHwgX2pvaW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIEVt\ncHR5SXRlcmF0b3IuSU5TVEFOQ0U7CiAgICAgICAgcmV0dXJuIF9qb2lucy5q\nb2lucygpLmpvaW5JdGVyYXRvcigpOwogICAgfQoKICAgIHB1YmxpYyBsb25n\nIGdldFN0YXJ0SW5kZXgoKSB7CiAgICAgICAgcmV0dXJuIF9zdGFydElkeDsK\nICAgIH0KCiAgICBwdWJsaWMgbG9uZyBnZXRFbmRJbmRleCgpIHsKICAgICAg\nICByZXR1cm4gX2VuZElkeDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRS\nYW5nZShsb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAgIF9zdGFydElk\neCA9IHN0YXJ0OwogICAgICAgIF9lbmRJZHggPSBlbmQ7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZyBnZXRDb2x1bW5BbGlhcyhDb2x1bW4gY29sKSB7CiAg\nICAgICAgcmV0dXJuIGdldENvbHVtbkFsaWFzKGNvbCwgKEpvaW5zKSBudWxs\nKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldENvbHVtbkFsaWFzKENv\nbHVtbiBjb2wsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgcmV0dXJuIGdldENv\nbHVtbkFsaWFzKGNvbCwgZ2V0Sm9pbnMoam9pbnMsIGZhbHNlKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGFsaWFzIGZvciB0aGUgZ2l2\nZW4gY29sdW1uLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRDb2x1\nbW5BbGlhcyhDb2x1bW4gY29sLCBQYXRoSm9pbnMgcGopIHsKICAgICAgICBy\nZXR1cm4gZ2V0Q29sdW1uQWxpYXMoY29sLmdldE5hbWUoKSwgY29sLmdldFRh\nYmxlKCksIHBqKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldENvbHVt\nbkFsaWFzKFN0cmluZyBjb2wsIFRhYmxlIHRhYmxlKSB7CiAgICAgICAgcmV0\ndXJuIGdldENvbHVtbkFsaWFzKGNvbCwgdGFibGUsIChKb2lucykgbnVsbCk7\nCiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRDb2x1bW5BbGlhcyhTdHJp\nbmcgY29sLCBUYWJsZSB0YWJsZSwgSm9pbnMgam9pbnMpIHsKICAgICAgICBy\nZXR1cm4gZ2V0Q29sdW1uQWxpYXMoY29sLCB0YWJsZSwgZ2V0Sm9pbnMoam9p\nbnMsIGZhbHNlKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGFsaWFzIGZvciB0aGUgZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBwcml2\nYXRlIFN0cmluZyBnZXRDb2x1bW5BbGlhcyhTdHJpbmcgY29sLCBUYWJsZSB0\nYWJsZSwgUGF0aEpvaW5zIHBqKSB7CiAgICAgICAgaWYgKF9mcm9tICE9IG51\nbGwpIHsKICAgICAgICAgICAgU3RyaW5nIGFsaWFzID0gdG9BbGlhcyhfZnJv\nbS5nZXRUYWJsZUluZGV4KHRhYmxlLCBwaiwgdHJ1ZSkpOwogICAgICAgICAg\nICBpZiAoX2RpY3QucmVxdWlyZXNBbGlhc0ZvclN1YnNlbGVjdCkKICAgICAg\nICAgICAgICAgIHJldHVybiBGUk9NX1NFTEVDVF9BTElBUyArICIuIiArIGFs\naWFzICsgIl8iICsgY29sOwogICAgICAgICAgICByZXR1cm4gYWxpYXMgKyAi\nXyIgKyBjb2w7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0b0FsaWFzKGdl\ndFRhYmxlSW5kZXgodGFibGUsIHBqLCB0cnVlKSkgKyAiLiIgKyBjb2w7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNBZ2dyZWdhdGUoKSB7CiAgICAg\nICAgcmV0dXJuIChfZmxhZ3MgJiBBR0dSRUdBVEUpICE9IDA7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0QWdncmVnYXRlKGJvb2xlYW4gYWdnKSB7CiAg\nICAgICAgaWYgKGFnZykKICAgICAgICAgICAgX2ZsYWdzIHw9IEFHR1JFR0FU\nRTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9mbGFncyAmPSB+QUdHUkVH\nQVRFOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzTG9iKCkgewogICAg\nICAgIHJldHVybiAoX2ZsYWdzICYgTE9CKSAhPSAwOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldExvYihib29sZWFuIGxvYikgewogICAgICAgIGlmIChs\nb2IpCiAgICAgICAgICAgIF9mbGFncyB8PSBMT0I7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBfZmxhZ3MgJj0gfkxPQjsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjbGVhclNlbGVjdHMoKSB7CiAgICAgICAgX3NlbGVjdHMuY2xlYXIo\nKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3QoU1FMQnVmZmVy\nIHNxbCwgT2JqZWN0IGlkKSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdChzcWws\nIGlkLCBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3Qo\nU1FMQnVmZmVyIHNxbCwgT2JqZWN0IGlkLCBKb2lucyBqb2lucykgewogICAg\nICAgIGlmICghaXNHcm91cGluZygpKQogICAgICAgICAgICByZXR1cm4gc2Vs\nZWN0KChPYmplY3QpIHNxbCwgaWQsIGpvaW5zKTsKICAgICAgICBncm91cEJ5\nKHNxbCwgam9pbnMpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJlY29yZCB0aGUgc2VsZWN0IG9mIHRoZSBnaXZlbiBT\nUUwgYnVmZmVyIG9yIHN0cmluZy4KICAgICAqLwogICAgcHJpdmF0ZSBib29s\nZWFuIHNlbGVjdChPYmplY3Qgc3FsLCBPYmplY3QgaWQsIEpvaW5zIGpvaW5z\nKSB7CiAgICAgICAgZ2V0Sm9pbnMoam9pbnMsIHRydWUpOwogICAgICAgIGJv\nb2xlYW4gY29udGFpbnM7CiAgICAgICAgaWYgKGlkID09IG51bGwpIHsKICAg\nICAgICAgICAgaW50IGlkeCA9IF9zZWxlY3RzLmluZGV4T2ZBbGlhcyhzcWwp\nOwogICAgICAgICAgICBjb250YWlucyA9IGlkeCAhPSAtMTsKICAgICAgICAg\nICAgaWYgKGNvbnRhaW5zKQogICAgICAgICAgICAgICAgaWQgPSBfc2VsZWN0\ncy5nZXQoaWR4KTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\naWQgPSBudWxsSWQoKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgY29u\ndGFpbnMgPSBfc2VsZWN0cy5jb250YWlucyhpZCk7CgogICAgICAgIGlmIChj\nb250YWlucykKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIF9z\nZWxlY3RzLnNldEFsaWFzKGlkLCBzcWwsIGZhbHNlKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYSB1bmlx\ndWUgaWQgZm9yIGEgU1FMIHN0cmluZyB3aG9zZSBnaXZlbiBpZCBpcyBudWxs\nLgogICAgICovCiAgICBwcml2YXRlIE9iamVjdCBudWxsSWQoKSB7CiAgICAg\nICAgaWYgKF9udWxsSWRzID49IE5VTExfSURTLmxlbmd0aCkKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBOdWxsSWQoKTsKICAgICAgICByZXR1cm4gTlVMTF9J\nRFNbX251bGxJZHMrK107CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc2Vs\nZWN0KFN0cmluZyBzcWwsIE9iamVjdCBpZCkgewogICAgICAgIHJldHVybiBz\nZWxlY3Qoc3FsLCBpZCwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gc2VsZWN0KFN0cmluZyBzcWwsIE9iamVjdCBpZCwgSm9pbnMgam9pbnMp\nIHsKICAgICAgICBpZiAoIWlzR3JvdXBpbmcoKSkKICAgICAgICAgICAgcmV0\ndXJuIHNlbGVjdCgoT2JqZWN0KSBzcWwsIGlkLCBqb2lucyk7CiAgICAgICAg\nZ3JvdXBCeShzcWwsIGpvaW5zKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3RQbGFjZWhvbGRlcihTdHJpbmcg\nc3FsKSB7CiAgICAgICAgT2JqZWN0IGhvbGRlciA9IChfcGxhY2Vob2xkZXJz\nID49IFBMQUNFSE9MREVSUy5sZW5ndGgpCiAgICAgICAgICAgID8gbmV3IFBs\nYWNlaG9sZGVyKCkgOiBQTEFDRUhPTERFUlNbX3BsYWNlaG9sZGVycysrXTsK\nICAgICAgICBzZWxlY3Qoc3FsLCBob2xkZXIpOwogICAgfQoKICAgIC8qKgog\nICAgICogSW5zZXJ0IGEgcGxhY2Vob2xkZXIgYXQgdGhlIGdpdmVuIGluZGV4\nOyB1c2UgYSBuZWdhdGl2ZSBpbmRleAogICAgICogdG8gY291bnQgZnJvbSB0\naGUgYmFjayBvZiB0aGUgc2VsZWN0IGxpc3QuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIGluc2VydFBsYWNlaG9sZGVyKFN0cmluZyBzcWwsIGludCBwb3Mp\nIHsKICAgICAgICBPYmplY3QgaG9sZGVyID0gKF9wbGFjZWhvbGRlcnMgPj0g\nUExBQ0VIT0xERVJTLmxlbmd0aCkKICAgICAgICAgICAgPyBuZXcgUGxhY2Vo\nb2xkZXIoKSA6IFBMQUNFSE9MREVSU1tfcGxhY2Vob2xkZXJzKytdOwogICAg\nICAgIF9zZWxlY3RzLmluc2VydEFsaWFzKHBvcywgaG9sZGVyLCBzcWwpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ2xlYXIgc2VsZWN0ZWQgcGxhY2Vob2xk\nZXJzLCBhbmQgcmV0dXJuIHJlbW92ZWQgc2VsZWN0IGluZGV4ZXMuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIGNsZWFyUGxhY2Vob2xkZXJTZWxlY3RzKCkg\newogICAgICAgIF9zZWxlY3RzLmNsZWFyUGxhY2Vob2xkZXJzKCk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gc2VsZWN0KENvbHVtbiBjb2wpIHsKICAg\nICAgICByZXR1cm4gc2VsZWN0KGNvbCwgKEpvaW5zKSBudWxsKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3QoQ29sdW1uIGNvbCwgSm9pbnMg\nam9pbnMpIHsKICAgICAgICBpZiAoIWlzR3JvdXBpbmcoKSkKICAgICAgICAg\nICAgcmV0dXJuIHNlbGVjdChjb2wsIGdldEpvaW5zKGpvaW5zLCB0cnVlKSwg\nZmFsc2UpOwogICAgICAgIGdyb3VwQnkoY29sLCBqb2lucyk7CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHB1YmxpYyBpbnQgc2VsZWN0KENv\nbHVtbltdIGNvbHMpIHsKICAgICAgICByZXR1cm4gc2VsZWN0KGNvbHMsIG51\nbGwpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgc2VsZWN0KENvbHVtbltdIGNv\nbHMsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVsbCB8\nfCBjb2xzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gMDsKICAg\nICAgICBpZiAoaXNHcm91cGluZygpKSB7CiAgICAgICAgICAgIGdyb3VwQnko\nY29scywgam9pbnMpOwogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9\nCiAgICAgICAgUGF0aEpvaW5zIHBqID0gZ2V0Sm9pbnMoam9pbnMsIHRydWUp\nOwogICAgICAgIGludCBzZWxkID0gMDsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChzZWxl\nY3QoY29sc1tpXSwgcGosIGZhbHNlKSkKICAgICAgICAgICAgICAgIHNlbGQg\nfD0gMiA8PCBpOwogICAgICAgIHJldHVybiBzZWxkOwogICAgfQoKICAgIC8q\nKgogICAgICogU2VsZWN0IHRoZSBnaXZlbiBjb2x1bW4gYWZ0ZXIgbWFraW5n\nIHRoZSBnaXZlbiBqb2lucy4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIHNlbGVjdChDb2x1bW4gY29sLCBQYXRoSm9pbnMgcGosIGJvb2xlYW4gaWRl\nbnQpIHsKICAgICAgICAvLyB3ZSBjYWNoZSBvbiBjb2x1bW4gb2JqZWN0IGlm\nIHRoZXJlIGFyZSBubyBqb2lucyBzbyB0aGF0IHdoZW4KICAgICAgICAvLyBs\nb29raW5nIHVwIGNvbHVtbnMgaW4gdGhlIHJlc3VsdCB3ZSBkb24ndCBoYXZl\nIHRvIGNyZWF0ZSBhIHN0cmluZwogICAgICAgIC8vIGJ1ZmZlciBmb3IgdGhl\nIHRhYmxlICsgY29sdW1uIGFsaWFzOyBpZiB0aGVyZSBhcmUgam9pbnMsIHRo\nZW4KICAgICAgICAvLyB3ZSBrZXkgb24gdGhlIGFsaWFzCiAgICAgICAgU3Ry\naW5nIGFsaWFzID0gZ2V0Q29sdW1uQWxpYXMoY29sLCBwaik7CiAgICAgICAg\nT2JqZWN0IGlkOwogICAgICAgIGlmIChwaiA9PSBudWxsIHx8IHBqLnBhdGgo\nKSA9PSBudWxsKQogICAgICAgICAgICBpZCA9IGNvbDsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIGlkID0gYWxpYXM7CiAgICAgICAgaWYgKF9zZWxlY3Rz\nLmNvbnRhaW5zKGlkKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAg\nICAgICBpZiAoY29sLmdldFR5cGUoKSA9PSBUeXBlcy5CTE9CIHx8IGNvbC5n\nZXRUeXBlKCkgPT0gVHlwZXMuQ0xPQikKICAgICAgICAgICAgc2V0TG9iKHRy\ndWUpOwogICAgICAgIF9zZWxlY3RzLnNldEFsaWFzKGlkLCBhbGlhcywgaWRl\nbnQpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNlbGVjdChDbGFzc01hcHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNz\nZXMsCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGZldGNoLCBpbnQgZWFnZXIpIHsKICAgICAgICBzZWxlY3QobWFw\ncGluZywgc3ViY2xhc3Nlcywgc3RvcmUsIGZldGNoLCBlYWdlciwgbnVsbCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2VsZWN0KENsYXNzTWFwcGluZyBt\nYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywKICAgICAgICBKREJDU3RvcmUgc3Rv\ncmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlciwK\nICAgICAgICBKb2lucyBqb2lucykgewogICAgICAgIHNlbGVjdCh0aGlzLCBt\nYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0Y2gsIGVhZ2VyLCBqb2lu\ncywgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogU2VsZWN0IHRoZSBn\naXZlbiBtYXBwaW5nLgogICAgICovCiAgICB2b2lkIHNlbGVjdChTZWxlY3Qg\nd3JhcHBlciwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2Vz\nLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCwgaW50IGVhZ2VyLAogICAgICAgIEpvaW5zIGpvaW5zLCBi\nb29sZWFuIGlkZW50KSB7CiAgICAgICAgLy8gbm90ZSB0aGF0IHRoaXMgaXMg\nb25lIGNhc2Ugd2hlcmUgd2UgZG9uJ3Qgd2FudCB0byB1c2UgdGhlIHJlc3Vs\ndAogICAgICAgIC8vIG9mIGdldEpvaW5zKCk7IGp1c3QgdXNlIHRoZSBnaXZl\nbiBqb2lucywgd2hpY2ggd2lsbCBlaXRoZXIgYmUgY2xlYW4KICAgICAgICAv\nLyBvciB0aGUgcmVzdWx0IG9mIHByZXZpb3VzIHByZS1qb2lucy4gdGhpcyB3\nYXkgd2UgZG9uJ3QgcHVzaCBleHRyYQogICAgICAgIC8vIHN0YWNrIHN0dWZm\nIHdoZW4gbm8gYWN0dWFsIG5ldyBqb2lucyBoYXZlIGJlZW4gbWFkZSwgYW5k\nIHdlIGRvbid0CiAgICAgICAgLy8gdGhpbmsgdGhlIHVzZXIgd2FudHMgb3V0\nZXIgam9pbnMgd2hlbiBhY3R1YWxseSBvbmx5IHRoZSBwcmV2aW91cwogICAg\nICAgIC8vIGpvaW5zIHdlcmUgb3V0ZXIuICB3ZSBkbyBpbnZva2UgZ2V0Sm9p\nbnMoKSwgdGhvdWdoLCB0byBhZGQgdGhlc2UKICAgICAgICAvLyBqb2lucyAo\naWYgYW55KSB0byBvdXIgdG9wLWxldmVsIGpvaW5zOyBvdGhlcndpc2UgaXQn\nZCBiZSBwb3NzaWJsZQogICAgICAgIC8vIGZvciB0aGUgdXNlciB0byBpbW1l\nZGlhdGVseSBkbyBhbm90aGVyIGpvaW4gYW5kIHNlbGVjdCBzb21ldGhpbmcs\nCiAgICAgICAgLy8gYW5kIGlmIHdlJ3JlIGluIG91dGVyIG1vZGUgYWxsIHRo\nZXNlIGpvaW5zIHdpbGwgZ2V0IHN3aXRjaGVkIHRvIG91dGVyCiAgICAgICAg\nLy8gam9pbnMuICBjYWNoaW5nIHRoZW0gYXMgdGhlaXIgb3JpZ2luYWwgam9p\nbiB0eXBlIHByZXZlbnRzIHRoYXQKICAgICAgICBnZXRKb2lucyhqb2lucywg\ndHJ1ZSk7CgogICAgICAgIFBhdGhKb2lucyBwaiA9IChQYXRoSm9pbnMpIGpv\naW5zOwogICAgICAgIGJvb2xlYW4gaGFzSm9pbnMgPSBwaiAhPSBudWxsICYm\nIHBqLmlzRGlydHkoKTsKICAgICAgICBpZiAoaGFzSm9pbnMpIHsKICAgICAg\nICAgICAgaWYgKF9wcmVKb2lucyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nX3ByZUpvaW5zID0gbmV3IFN0YWNrKCk7CiAgICAgICAgICAgIF9wcmVKb2lu\ncy5wdXNoKHBqKTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHRoZXkgYXJl\nIHNlbGVjdGluZyB0aGlzIG1hcHBpbmcgd2l0aCBvdXRlciBqb2lucywgdGhl\nbiBhbGwgam9pbnMKICAgICAgICAvLyBmcm9tIHRoaXMgbWFwcGluZyBzaG91\nbGQgYWxzbyBiZSBvdXRlcgogICAgICAgIGJvb2xlYW4gd2FzT3V0ZXIgPSAo\nX2ZsYWdzICYgT1VURVIpICE9IDA7CiAgICAgICAgaWYgKGhhc0pvaW5zICYm\nICF3YXNPdXRlciAmJiBwai5pc091dGVyKCkpCiAgICAgICAgICAgIF9mbGFn\ncyB8PSBPVVRFUjsKCiAgICAgICAgLy8gZGVsZWdhdGUgdG8gc3RvcmUgbWFu\nYWdlciB0byBzZWxlY3QgaW4gc2FtZSBvcmRlciBpdCBsb2FkcyByZXN1bHQK\nICAgICAgICAoKEpEQkNTdG9yZU1hbmFnZXIpIHN0b3JlKS5zZWxlY3Qod3Jh\ncHBlciwgbWFwcGluZywgc3ViY2xhc3NlcywgbnVsbCwKICAgICAgICAgICAg\nbnVsbCwgZmV0Y2gsIGVhZ2VyLCBpZGVudCwgKF9mbGFncyAmIE9VVEVSKSAh\nPSAwKTsKCiAgICAgICAgLy8gcmVzZXQKICAgICAgICBpZiAoaGFzSm9pbnMp\nCiAgICAgICAgICAgIF9wcmVKb2lucy5wb3AoKTsKICAgICAgICBpZiAoIXdh\nc091dGVyICYmIChfZmxhZ3MgJiBPVVRFUikgIT0gMCkKICAgICAgICAgICAg\nX2ZsYWdzICY9IH5PVVRFUjsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBz\nZWxlY3RJZGVudGlmaWVyKENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4g\nc2VsZWN0SWRlbnRpZmllcihjb2wsIChKb2lucykgbnVsbCk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gc2VsZWN0SWRlbnRpZmllcihDb2x1bW4gY29s\nLCBKb2lucyBqb2lucykgewogICAgICAgIGlmICghaXNHcm91cGluZygpKQog\nICAgICAgICAgICByZXR1cm4gc2VsZWN0KGNvbCwgZ2V0Sm9pbnMoam9pbnMs\nIHRydWUpLCB0cnVlKTsKICAgICAgICBncm91cEJ5KGNvbCwgam9pbnMpOwog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMgaW50IHNl\nbGVjdElkZW50aWZpZXIoQ29sdW1uW10gY29scykgewogICAgICAgIHJldHVy\nbiBzZWxlY3RJZGVudGlmaWVyKGNvbHMsIG51bGwpOwogICAgfQoKICAgIHB1\nYmxpYyBpbnQgc2VsZWN0SWRlbnRpZmllcihDb2x1bW5bXSBjb2xzLCBKb2lu\ncyBqb2lucykgewogICAgICAgIGlmIChjb2xzID09IG51bGwgfHwgY29scy5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgaWYg\nKGlzR3JvdXBpbmcoKSkgewogICAgICAgICAgICBncm91cEJ5KGNvbHMsIGpv\naW5zKTsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAg\nIFBhdGhKb2lucyBwaiA9IGdldEpvaW5zKGpvaW5zLCB0cnVlKTsKICAgICAg\nICBpbnQgc2VsZCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBj\nb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoc2VsZWN0KGNvbHNb\naV0sIHBqLCB0cnVlKSkKICAgICAgICAgICAgICAgIHNlbGQgfD0gMiA8PCBp\nOwogICAgICAgIHJldHVybiBzZWxkOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNlbGVjdElkZW50aWZpZXIoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBz\ndWJjbGFzc2VzLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCwgaW50IGVhZ2VyKSB7CiAgICAgICAgc2Vs\nZWN0SWRlbnRpZmllcihtYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0\nY2gsIGVhZ2VyLCBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxl\nY3RJZGVudGlmaWVyKENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xh\nc3NlcywKICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlciwKICAgICAgICBKb2lucyBqb2lu\ncykgewogICAgICAgIHNlbGVjdCh0aGlzLCBtYXBwaW5nLCBzdWJjbGFzc2Vz\nLCBzdG9yZSwgZmV0Y2gsIGVhZ2VyLCBqb2lucywgdHJ1ZSk7CiAgICB9Cgog\nICAgcHVibGljIGludCBzZWxlY3RQcmltYXJ5S2V5KENsYXNzTWFwcGluZyBt\nYXBwaW5nKSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdFByaW1hcnlLZXkobWFw\ncGluZywgbnVsbCk7CiAgICB9CgogICAgcHVibGljIGludCBzZWxlY3RQcmlt\nYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5nLCBKb2lucyBqb2lucykgewog\nICAgICAgIHJldHVybiBwcmltYXJ5S2V5T3BlcmF0aW9uKG1hcHBpbmcsIHRy\ndWUsIG51bGwsIGpvaW5zLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBPcGVyYXRlIG9uIHByaW1hcnkga2V5IGRhdGEuIFJldHVybiBhIGJpdCBt\nYXNrIG9mIHNlbGVjdGVkIGNvbHVtbnMuCiAgICAgKi8KICAgIHByaXZhdGUg\naW50IHByaW1hcnlLZXlPcGVyYXRpb24oQ2xhc3NNYXBwaW5nIG1hcHBpbmcs\nIGJvb2xlYW4gc2VsLAogICAgICAgIEJvb2xlYW4gYXNjLCBKb2lucyBqb2lu\ncywgYm9vbGVhbiBhbGlhc09yZGVyKSB7CiAgICAgICAgaWYgKCFzZWwgJiYg\nYXNjID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAwOwoKICAgICAgICAv\nLyBpZiB0aGlzIG1hcHBpbmcgY2FuJ3Qgc2VsZWN0IHRoZSBmdWxsIHBrIHZh\nbHVlcywgdGhlbiBqb2luIHRvCiAgICAgICAgLy8gc3VwZXIgYW5kIHJlY3Vy\nc2UKICAgICAgICBDbGFzc01hcHBpbmcgc3VwOwogICAgICAgIGlmICghbWFw\ncGluZy5pc1ByaW1hcnlLZXlPYmplY3RJZCh0cnVlKSkgewogICAgICAgICAg\nICBzdXAgPSBtYXBwaW5nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGlu\nZygpOwogICAgICAgICAgICBpZiAoam9pbnMgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGpvaW5zID0gbmV3Sm9pbnMoKTsKICAgICAgICAgICAgam9pbnMg\nPSBtYXBwaW5nLmpvaW5TdXBlcmNsYXNzKGpvaW5zLCBmYWxzZSk7CiAgICAg\nICAgICAgIHJldHVybiBwcmltYXJ5S2V5T3BlcmF0aW9uKHN1cCwgc2VsLCBh\nc2MsIGpvaW5zLCBhbGlhc09yZGVyKTsKICAgICAgICB9CgogICAgICAgIENv\nbHVtbltdIGNvbHMgPSBtYXBwaW5nLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7\nCiAgICAgICAgaWYgKGlzR3JvdXBpbmcoKSkgewogICAgICAgICAgICBncm91\ncEJ5KGNvbHMsIGpvaW5zKTsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAg\nICAgfQoKICAgICAgICBQYXRoSm9pbnMgcGogPSBnZXRKb2lucyhqb2lucywg\nZmFsc2UpOwogICAgICAgIGludCBzZWxkID0gMDsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlm\nIChjb2x1bW5PcGVyYXRpb24oY29sc1tpXSwgc2VsLCBhc2MsIHBqLCBhbGlh\nc09yZGVyKSkKICAgICAgICAgICAgICAgIHNlbGQgfD0gMiA8PCBpOwoKICAg\nICAgICAvLyBpZiB0aGlzIG1hcHBpbmcgaGFzIG5vdCBiZWVuIHVzZWQgaW4g\ndGhlIHNlbGVjdCB5ZXQgKGFuZCB0aGVyZWZvcmUKICAgICAgICAvLyBpcyBu\nb3Qgam9pbmVkIHRvIGFueXRoaW5nKSwgYnV0IGhhcyBhbiBvdGhlci10YWJs\nZSBzdXBlcmNsYXNzIHRoYXQKICAgICAgICAvLyBoYXMgYmVlbiB1c2VkLCBt\nYWtlIHN1cmUgdG8gam9pbiB0byBpdAogICAgICAgIGJvb2xlYW4gam9pbmVk\nID0gZmFsc2U7CiAgICAgICAgZm9yIChzdXAgPSBtYXBwaW5nLmdldEpvaW5h\nYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOyBzdXAgIT0gbnVsbDsKICAgICAg\nICAgICAgbWFwcGluZyA9IHN1cCwgc3VwID0gbWFwcGluZy5nZXRKb2luYWJs\nZVBDU3VwZXJjbGFzc01hcHBpbmcoKSkgewogICAgICAgICAgICBpZiAoc3Vw\nLmdldFRhYmxlKCkgPT0gbWFwcGluZy5nZXRUYWJsZSgpKQogICAgICAgICAg\nICAgICAgY29udGludWU7CgogICAgICAgICAgICBpZiAobWFwcGluZy5nZXRU\nYWJsZSgpICE9IHN1cC5nZXRUYWJsZSgpCiAgICAgICAgICAgICAgICAmJiBn\nZXRUYWJsZUluZGV4KG1hcHBpbmcuZ2V0VGFibGUoKSwgcGosIGZhbHNlKSA9\nPSAtMQogICAgICAgICAgICAgICAgJiYgZ2V0VGFibGVJbmRleChzdXAuZ2V0\nVGFibGUoKSwgcGosIGZhbHNlKSAhPSAtMSkgewogICAgICAgICAgICAgICAg\naWYgKHBqID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcGogPSAoUGF0\naEpvaW5zKSBuZXdKb2lucygpOwogICAgICAgICAgICAgICAgcGogPSAoUGF0\naEpvaW5zKSBtYXBwaW5nLmpvaW5TdXBlcmNsYXNzKHBqLCBmYWxzZSk7CiAg\nICAgICAgICAgICAgICBqb2luZWQgPSB0cnVlOwogICAgICAgICAgICB9IGVs\nc2UKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBp\nZiAoam9pbmVkKQogICAgICAgICAgICB3aGVyZShwaik7CgogICAgICAgIHJl\ndHVybiBzZWxkOwogICAgfQoKICAgIC8qKgogICAgICogUGVyZm9ybSBhbiBv\ncGVyYXRpb24gb24gYSBjb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBjb2x1bW5PcGVyYXRpb24oQ29sdW1uIGNvbCwgYm9vbGVhbiBzZWws\nIEJvb2xlYW4gYXNjLAogICAgICAgIFBhdGhKb2lucyBwaiwgYm9vbGVhbiBh\nbGlhc09yZGVyKSB7CiAgICAgICAgU3RyaW5nIGFzID0gbnVsbDsKICAgICAg\nICBpZiAoYXNjICE9IG51bGwgJiYgKGFsaWFzT3JkZXIgfHwgKF9mbGFncyAm\nIFJFQ09SRF9PUkRFUkVEKSAhPSAwKSkgewogICAgICAgICAgICBPYmplY3Qg\naWQ7CiAgICAgICAgICAgIGlmIChwaiA9PSBudWxsIHx8IHBqLnBhdGgoKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgaWQgPSBjb2w7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIGlkID0gZ2V0Q29sdW1uQWxpYXMoY29s\nLCBwaik7CiAgICAgICAgICAgIGlmICgoX2ZsYWdzICYgUkVDT1JEX09SREVS\nRUQpICE9IDApIHsKICAgICAgICAgICAgICAgIGlmIChfb3JkZXJlZCA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgIF9vcmRlcmVkID0gbmV3IEFycmF5\nTGlzdCg1KTsKICAgICAgICAgICAgICAgIF9vcmRlcmVkLmFkZChpZCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFsaWFzT3JkZXIpIHsKICAg\nICAgICAgICAgICAgIGFzID0gdG9PcmRlckFsaWFzKF9vcmRlcnMrKyk7CiAg\nICAgICAgICAgICAgICBfc2VsZWN0cy5zZXRTZWxlY3RBcyhpZCwgYXMpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBib29sZWFuIHNlbGQg\nPSBzZWwgJiYgc2VsZWN0KGNvbCwgcGosIGZhbHNlKTsKICAgICAgICBpZiAo\nYXNjICE9IG51bGwpIHsKICAgICAgICAgICAgU3RyaW5nIGFsaWFzID0gKGFz\nICE9IG51bGwpID8gYXMgOiBnZXRDb2x1bW5BbGlhcyhjb2wsIHBqKTsKICAg\nICAgICAgICAgYXBwZW5kT3JkZXJpbmcoYWxpYXMsIGFzYy5ib29sZWFuVmFs\ndWUoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWxkOwogICAgfQoK\nICAgIC8qKgogICAgICogQXBwZW5kIG9yZGVyaW5nIGluZm9ybWF0aW9uIHRv\nIG91ciBpbnRlcm5hbCBidWZmZXIuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBhcHBlbmRPcmRlcmluZyhPYmplY3Qgb3JkZXJCeSwgYm9vbGVhbiBhc2Mp\nIHsKICAgICAgICBpZiAoX29yZGVyaW5nID09IG51bGwpCiAgICAgICAgICAg\nIF9vcmRlcmluZyA9IG5ldyBTUUxCdWZmZXIoX2RpY3QpOwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgX29yZGVyaW5nLmFwcGVuZCgiLCAiKTsKCiAgICAg\nICAgaWYgKG9yZGVyQnkgaW5zdGFuY2VvZiBTUUxCdWZmZXIpCiAgICAgICAg\nICAgIF9vcmRlcmluZy5hcHBlbmQoKFNRTEJ1ZmZlcikgb3JkZXJCeSk7CiAg\nICAgICAgZWxzZQogICAgICAgICAgICBfb3JkZXJpbmcuYXBwZW5kKChTdHJp\nbmcpIG9yZGVyQnkpOwogICAgICAgIGlmIChhc2MpCiAgICAgICAgICAgIF9v\ncmRlcmluZy5hcHBlbmQoIiBBU0MiKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIF9vcmRlcmluZy5hcHBlbmQoIiBERVNDIik7CiAgICB9CgogICAgcHVi\nbGljIGludCBvcmRlckJ5UHJpbWFyeUtleShDbGFzc01hcHBpbmcgbWFwcGlu\nZywgYm9vbGVhbiBhc2MsCiAgICAgICAgYm9vbGVhbiBzZWwpIHsKICAgICAg\nICByZXR1cm4gb3JkZXJCeVByaW1hcnlLZXkobWFwcGluZywgYXNjLCBudWxs\nLCBzZWwpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgb3JkZXJCeVByaW1hcnlL\nZXkoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGJvb2xlYW4gYXNjLAogICAgICAg\nIEpvaW5zIGpvaW5zLCBib29sZWFuIHNlbCkgewogICAgICAgIHJldHVybiBv\ncmRlckJ5UHJpbWFyeUtleShtYXBwaW5nLCBhc2MsIGpvaW5zLCBzZWwsIGZh\nbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbG93IHVuaW9ucyB0byBz\nZXQgYWxpYXNlcyBvbiBvcmRlciBjb2x1bW5zLgogICAgICovCiAgICBwdWJs\naWMgaW50IG9yZGVyQnlQcmltYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5n\nLCBib29sZWFuIGFzYywKICAgICAgICBKb2lucyBqb2lucywgYm9vbGVhbiBz\nZWwsIGJvb2xlYW4gYWxpYXNPcmRlcikgewogICAgICAgIHJldHVybiBwcmlt\nYXJ5S2V5T3BlcmF0aW9uKG1hcHBpbmcsIHNlbCwKICAgICAgICAgICAgKGFz\nYykgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZBTFNFLCBqb2lucywgYWxp\nYXNPcmRlcik7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gb3JkZXJCeShD\nb2x1bW4gY29sLCBib29sZWFuIGFzYywgYm9vbGVhbiBzZWwpIHsKICAgICAg\nICByZXR1cm4gb3JkZXJCeShjb2wsIGFzYywgbnVsbCwgc2VsKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBvcmRlckJ5KENvbHVtbiBjb2wsIGJvb2xl\nYW4gYXNjLCBKb2lucyBqb2lucywgYm9vbGVhbiBzZWwpIHsKICAgICAgICBy\nZXR1cm4gb3JkZXJCeShjb2wsIGFzYywgam9pbnMsIHNlbCwgZmFsc2UpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWxsb3cgdW5pb25zIHRvIHNldCBhbGlh\nc2VzIG9uIG9yZGVyIGNvbHVtbnMuCiAgICAgKi8KICAgIGJvb2xlYW4gb3Jk\nZXJCeShDb2x1bW4gY29sLCBib29sZWFuIGFzYywgSm9pbnMgam9pbnMsIGJv\nb2xlYW4gc2VsLAogICAgICAgIGJvb2xlYW4gYWxpYXNPcmRlcikgewogICAg\nICAgIHJldHVybiBjb2x1bW5PcGVyYXRpb24oY29sLCBzZWwsIChhc2MpID8g\nQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRSwKICAgICAgICAgICAgZ2V0\nSm9pbnMoam9pbnMsIHRydWUpLCBhbGlhc09yZGVyKTsKICAgIH0KCiAgICBw\ndWJsaWMgaW50IG9yZGVyQnkoQ29sdW1uW10gY29scywgYm9vbGVhbiBhc2Ms\nIGJvb2xlYW4gc2VsKSB7CiAgICAgICAgcmV0dXJuIG9yZGVyQnkoY29scywg\nYXNjLCBudWxsLCBzZWwpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgb3JkZXJC\neShDb2x1bW5bXSBjb2xzLCBib29sZWFuIGFzYywgSm9pbnMgam9pbnMsIGJv\nb2xlYW4gc2VsKSB7CiAgICAgICAgcmV0dXJuIG9yZGVyQnkoY29scywgYXNj\nLCBqb2lucywgc2VsLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\nbGxvdyB1bmlvbnMgdG8gc2V0IGFsaWFzZXMgb24gb3JkZXIgY29sdW1ucy4K\nICAgICAqLwogICAgaW50IG9yZGVyQnkoQ29sdW1uW10gY29scywgYm9vbGVh\nbiBhc2MsIEpvaW5zIGpvaW5zLCBib29sZWFuIHNlbCwKICAgICAgICBib29s\nZWFuIGFsaWFzT3JkZXIpIHsKICAgICAgICBQYXRoSm9pbnMgcGogPSBnZXRK\nb2lucyhqb2lucywgdHJ1ZSk7CiAgICAgICAgaW50IHNlbGQgPSAwOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgaWYgKGNvbHVtbk9wZXJhdGlvbihjb2xzW2ldLCBzZWwsCiAg\nICAgICAgICAgICAgICAoYXNjKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4u\nRkFMU0UsIHBqLCBhbGlhc09yZGVyKSkKICAgICAgICAgICAgICAgIHNlbGQg\nfD0gMiA8PCBpOwogICAgICAgIHJldHVybiBzZWxkOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIG9yZGVyQnkoU1FMQnVmZmVyIHNxbCwgYm9vbGVhbiBh\nc2MsIGJvb2xlYW4gc2VsKSB7CiAgICAgICAgcmV0dXJuIG9yZGVyQnkoc3Fs\nLCBhc2MsIChKb2lucykgbnVsbCwgc2VsKTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBvcmRlckJ5KFNRTEJ1ZmZlciBzcWwsIGJvb2xlYW4gYXNjLCBK\nb2lucyBqb2lucywKICAgICAgICBib29sZWFuIHNlbCkgewogICAgICAgIHJl\ndHVybiBvcmRlckJ5KHNxbCwgYXNjLCBqb2lucywgc2VsLCBmYWxzZSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBbGxvdyB1bmlvbnMgdG8gc2V0IGFsaWFz\nZXMgb24gb3JkZXIgY29sdW1ucy4KICAgICAqLwogICAgYm9vbGVhbiBvcmRl\nckJ5KFNRTEJ1ZmZlciBzcWwsIGJvb2xlYW4gYXNjLCBKb2lucyBqb2lucywg\nYm9vbGVhbiBzZWwsCiAgICAgICAgYm9vbGVhbiBhbGlhc09yZGVyKSB7CiAg\nICAgICAgcmV0dXJuIG9yZGVyQnkoKE9iamVjdCkgc3FsLCBhc2MsIGpvaW5z\nLCBzZWwsIGFsaWFzT3JkZXIpOwogICAgfQoKICAgIC8qKgogICAgICogT3Jk\nZXIgb24gYSBTUUwgYnVmZmVyIG9yIHN0cmluZy4KICAgICAqLwogICAgcHJp\ndmF0ZSBib29sZWFuIG9yZGVyQnkoT2JqZWN0IHNxbCwgYm9vbGVhbiBhc2Ms\nIEpvaW5zIGpvaW5zLCBib29sZWFuIHNlbCwKICAgICAgICBib29sZWFuIGFs\naWFzT3JkZXIpIHsKICAgICAgICBPYmplY3Qgb3JkZXIgPSBzcWw7CiAgICAg\nICAgaWYgKGFsaWFzT3JkZXIpIHsKICAgICAgICAgICAgb3JkZXIgPSB0b09y\nZGVyQWxpYXMoX29yZGVycysrKTsKICAgICAgICAgICAgX3NlbGVjdHMuc2V0\nU2VsZWN0QXMoc3FsLCAoU3RyaW5nKSBvcmRlcik7CiAgICAgICAgfQogICAg\nICAgIGlmICgoX2ZsYWdzICYgUkVDT1JEX09SREVSRUQpICE9IDApIHsKICAg\nICAgICAgICAgaWYgKF9vcmRlcmVkID09IG51bGwpCiAgICAgICAgICAgICAg\nICBfb3JkZXJlZCA9IG5ldyBBcnJheUxpc3QoNSk7CiAgICAgICAgICAgIF9v\ncmRlcmVkLmFkZChzcWwpOwogICAgICAgIH0KCiAgICAgICAgZ2V0Sm9pbnMo\nam9pbnMsIHRydWUpOwogICAgICAgIGFwcGVuZE9yZGVyaW5nKG9yZGVyLCBh\nc2MpOwogICAgICAgIGlmIChzZWwpIHsKICAgICAgICAgICAgaW50IGlkeCA9\nIF9zZWxlY3RzLmluZGV4T2ZBbGlhcyhzcWwpOwogICAgICAgICAgICBpZiAo\naWR4ID09IC0xKSB7CiAgICAgICAgICAgICAgICBfc2VsZWN0cy5zZXRBbGlh\ncyhudWxsSWQoKSwgc3FsLCBmYWxzZSk7CiAgICAgICAgICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gb3JkZXJCeShT\ndHJpbmcgc3FsLCBib29sZWFuIGFzYywgYm9vbGVhbiBzZWwpIHsKICAgICAg\nICByZXR1cm4gb3JkZXJCeShzcWwsIGFzYywgbnVsbCwgc2VsKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBvcmRlckJ5KFN0cmluZyBzcWwsIGJvb2xl\nYW4gYXNjLCBKb2lucyBqb2lucywgYm9vbGVhbiBzZWwpIHsKICAgICAgICBy\nZXR1cm4gb3JkZXJCeShzcWwsIGFzYywgam9pbnMsIHNlbCwgZmFsc2UpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWxsb3cgdW5pb25zIHRvIHNldCBhbGlh\nc2VzIG9uIG9yZGVyIGNvbHVtbnMuCiAgICAgKi8KICAgIGJvb2xlYW4gb3Jk\nZXJCeShTdHJpbmcgc3FsLCBib29sZWFuIGFzYywgSm9pbnMgam9pbnMsIGJv\nb2xlYW4gc2VsLAogICAgICAgIGJvb2xlYW4gYWxpYXNPcmRlcikgewogICAg\nICAgIHJldHVybiBvcmRlckJ5KChPYmplY3QpIHNxbCwgYXNjLCBqb2lucywg\nc2VsLCBhbGlhc09yZGVyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbGVh\nck9yZGVyaW5nKCkgewogICAgICAgIF9vcmRlcmluZyA9IG51bGw7CiAgICAg\nICAgX29yZGVycyA9IDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGxvdyB1\nbmlvbnMgdG8gcmVjb3JkIHRoZSBzZWxlY3QgbGlzdCBpbmRleGVzIG9mIGl0\nZW1zIHdlIG9yZGVyIGJ5LgogICAgICovCiAgICB2b2lkIHNldFJlY29yZE9y\nZGVyZWRJbmRleGVzKGJvb2xlYW4gcmVjb3JkKSB7CiAgICAgICAgaWYgKHJl\nY29yZCkKICAgICAgICAgICAgX2ZsYWdzIHw9IFJFQ09SRF9PUkRFUkVEOwog\nICAgICAgIGVsc2UgewogICAgICAgICAgICBfb3JkZXJlZCA9IG51bGw7CiAg\nICAgICAgICAgIF9mbGFncyAmPSB+UkVDT1JEX09SREVSRUQ7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBpbmRleGVzIGlu\nIHRoZSBzZWxlY3QgbGlzdCBvZiBhbGwgaXRlbXMgd2UncmUgb3JkZXJpbmcK\nICAgICAqIGJ5LCBvciBudWxsIGlmIG5vbmUuIEZvciB1c2Ugd2l0aCB1bmlv\nbnMuCiAgICAgKi8KICAgIExpc3QgZ2V0T3JkZXJlZEluZGV4ZXMoKSB7CiAg\nICAgICAgaWYgKF9vcmRlcmVkID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIExpc3QgaWR4cyA9IG5ldyBBcnJheUxpc3QoX29y\nZGVyZWQuc2l6ZSgpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9v\ncmRlcmVkLnNpemUoKTsgaSsrKQogICAgICAgICAgICBpZHhzLmFkZChOdW1i\nZXJzLnZhbHVlT2YoX3NlbGVjdHMuaW5kZXhPZihfb3JkZXJlZC5nZXQoaSkp\nKSk7CiAgICAgICAgcmV0dXJuIGlkeHM7CiAgICB9CgogICAgcHVibGljIHZv\naWQgd2hlcmVQcmltYXJ5S2V5KE9iamVjdCBvaWQsIENsYXNzTWFwcGluZyBt\nYXBwaW5nLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgIHdo\nZXJlUHJpbWFyeUtleShvaWQsIG1hcHBpbmcsIG51bGwsIHN0b3JlKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFkZCB3aGVyZSBjb25kaXRpb25zIHNldHRp\nbmcgdGhlIG1hcHBpbmcncyBwcmltYXJ5IGtleSB0byB0aGUgZ2l2ZW4KICAg\nICAqIG9pZCB2YWx1ZXMuIElmIHRoZSBnaXZlbiBtYXBwaW5nIGRvZXMgbm90\nIHVzZSBvaWQgdmFsdWVzIGZvciBpdHMKICAgICAqIHByaW1hcnkga2V5LCB3\nZSB3aWxsIHJlY3Vyc2l2ZWx5IGpvaW4gdG8gaXRzIHN1cGVyY2xhc3MgdW50\naWwgd2UgZmluZAogICAgICogYW4gYW5jZXN0b3IgdGhhdCBkb2VzLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgd2hlcmVQcmltYXJ5S2V5KE9iamVjdCBv\naWQsIENsYXNzTWFwcGluZyBtYXBwaW5nLCBKb2lucyBqb2lucywKICAgICAg\nICBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICAvLyBpZiB0aGlzIG1hcHBp\nbmcncyBpZGVudGlmaWVycyBpbmNsdWRlIHNvbWV0aGluZyBvdGhlciB0aGFu\nCiAgICAgICAgLy8gdGhlIHBrIHZhbHVlcywgam9pbiB0byBzdXBlciBhbmQg\ncmVjdXJzZQogICAgICAgIGlmICghbWFwcGluZy5pc1ByaW1hcnlLZXlPYmpl\nY3RJZChmYWxzZSkpIHsKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIHN1cCA9\nIG1hcHBpbmcuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAg\nICAgICAgICAgIGlmIChqb2lucyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nam9pbnMgPSBuZXdKb2lucygpOwogICAgICAgICAgICBqb2lucyA9IG1hcHBp\nbmcuam9pblN1cGVyY2xhc3Moam9pbnMsIGZhbHNlKTsKICAgICAgICAgICAg\nd2hlcmVQcmltYXJ5S2V5KG9pZCwgc3VwLCBqb2lucywgc3RvcmUpOwogICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBDb2x1bW5bXSBj\nb2xzID0gbWFwcGluZy5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAg\nIHdoZXJlKG9pZCwgbWFwcGluZywgY29scywgY29scywgbnVsbCwgbnVsbCwg\nZ2V0Sm9pbnMoam9pbnMsIHRydWUpLAogICAgICAgICAgICBzdG9yZSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgd2hlcmVGb3JlaWduS2V5KEZvcmVpZ25L\nZXkgZmssIE9iamVjdCBvaWQsCiAgICAgICAgQ2xhc3NNYXBwaW5nIG1hcHBp\nbmcsIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgIHdoZXJlRm9yZWlnbktl\neShmaywgb2lkLCBtYXBwaW5nLCBudWxsLCBzdG9yZSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBZGQgd2hlcmUgY29uZGl0aW9ucyBzZXR0aW5nIHRoZSBn\naXZlbiBmb3JlaWduIGtleSB0byB0aGUgZ2l2ZW4KICAgICAqIG9pZCB2YWx1\nZXMuCiAgICAgKgogICAgICogQHNlZSAjd2hlcmVQcmltYXJ5S2V5CiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCB3aGVyZUZvcmVpZ25LZXkoRm9yZWlnbktl\neSBmaywgT2JqZWN0IG9pZCwKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGlu\nZywgSm9pbnMgam9pbnMsIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgIC8v\nIGlmIHRoaXMgbWFwcGluZydzIGlkZW50aWZpZXJzIGluY2x1ZGUgc29tZXRo\naW5nIG90aGVyIHRoYW4KICAgICAgICAvLyB0aGUgcGsgdmFsdWVzLCBvciBp\nZiB0aGlzIGZvcmVpZ24ga2V5IGRvZXNuJ3QgbGluayB0byBvbmx5CiAgICAg\nICAgLy8gaWRlbnRpZmllcnMsIGpvaW4gdG8gdGFibGUgYW5kIGRvIGEgZ2V0\nUHJpbWFyeUtleQogICAgICAgIGlmICghbWFwcGluZy5pc1ByaW1hcnlLZXlP\nYmplY3RJZChmYWxzZSkgfHwgIWNvbnRhaW5zQWxsCiAgICAgICAgICAgICht\nYXBwaW5nLmdldFByaW1hcnlLZXlDb2x1bW5zKCksIGZrLmdldFByaW1hcnlL\nZXlDb2x1bW5zKCkpKSB7CiAgICAgICAgICAgIGlmIChqb2lucyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgam9pbnMgPSBuZXdKb2lucygpOwogICAgICAg\nICAgICAvLyB0cmF2ZXJzZSB0byBmb3JlaWduIGtleSB0YXJnZXQgbWFwcGlu\nZwogICAgICAgICAgICB3aGlsZSAobWFwcGluZy5nZXRUYWJsZSgpICE9IGZr\nLmdldFByaW1hcnlLZXlUYWJsZSgpKSB7CiAgICAgICAgICAgICAgICBpZiAo\nam9pbnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBqb2lucyA9IG5l\nd0pvaW5zKCk7CiAgICAgICAgICAgICAgICBqb2lucyA9IG1hcHBpbmcuam9p\nblN1cGVyY2xhc3Moam9pbnMsIGZhbHNlKTsKICAgICAgICAgICAgICAgIG1h\ncHBpbmcgPSBtYXBwaW5nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGlu\nZygpOwogICAgICAgICAgICAgICAgaWYgKG1hcHBpbmcgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqb2lucyA9IGpvaW5zLmpv\naW4oZmssIGZhbHNlLCBmYWxzZSk7CiAgICAgICAgICAgIHdoZXJlUHJpbWFy\neUtleShvaWQsIG1hcHBpbmcsIGpvaW5zLCBzdG9yZSk7CiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICB9CgogICAgICAgIENvbHVtbltdIGZyb21Db2xz\nID0gZmsuZ2V0Q29sdW1ucygpOwogICAgICAgIENvbHVtbltdIHRvQ29scyA9\nIGZrLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgQ29sdW1uW10g\nY29uc3RDb2xzID0gZmsuZ2V0Q29uc3RhbnRDb2x1bW5zKCk7CiAgICAgICAg\nT2JqZWN0W10gY29uc3RzID0gZmsuZ2V0Q29uc3RhbnRzKCk7CiAgICAgICAg\nd2hlcmUob2lkLCBtYXBwaW5nLCB0b0NvbHMsIGZyb21Db2xzLCBjb25zdHMs\nIGNvbnN0Q29scywKICAgICAgICAgICAgZ2V0Sm9pbnMoam9pbnMsIHRydWUp\nLCBzdG9yZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBtZXRo\nb2QgdG8gZmx1c2ggdGhlIG9pZCB2YWx1ZXMgYXMgd2hlcmUgY29uZGl0aW9u\ncyB0byB0aGUKICAgICAqIGdpdmVuIGNvbHVtbnMuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCB3aGVyZShPYmplY3Qgb2lkLCBDbGFzc01hcHBpbmcgbWFw\ncGluZywgQ29sdW1uW10gdG9Db2xzLAogICAgICAgIENvbHVtbltdIGZyb21D\nb2xzLCBPYmplY3RbXSB2YWxzLCBDb2x1bW5bXSBjb25zdENvbHMsIFBhdGhK\nb2lucyBwaiwKICAgICAgICBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBW\nYWx1ZU1hcHBpbmcgZW1iZWQgPSBtYXBwaW5nLmdldEVtYmVkZGluZ01hcHBp\nbmcoKTsKICAgICAgICBpZiAoZW1iZWQgIT0gbnVsbCkgewogICAgICAgICAg\nICB3aGVyZShvaWQsIGVtYmVkLmdldEZpZWxkTWFwcGluZygpLmdldERlZmlu\naW5nTWFwcGluZygpLAogICAgICAgICAgICAgICAgdG9Db2xzLCBmcm9tQ29s\ncywgdmFscywgY29uc3RDb2xzLCBwaiwgc3RvcmUpOwogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBvbmx5IGJvdGhlciB0byBw\nYWNrIHBrIHZhbHVlcyBpbnRvIGFycmF5IGlmIGFwcCBpZAogICAgICAgIE9i\namVjdFtdIHBrcyA9IG51bGw7CiAgICAgICAgaWYgKG1hcHBpbmcuZ2V0SWRl\nbnRpdHlUeXBlKCkgPT0gQ2xhc3NNYXBwaW5nLklEX0FQUExJQ0FUSU9OKQog\nICAgICAgICAgICBwa3MgPSBBcHBsaWNhdGlvbklkcy50b1BLVmFsdWVzKG9p\nZCwgbWFwcGluZyk7CgogICAgICAgIFNRTEJ1ZmZlciBidWYgPSBuZXcgU1FM\nQnVmZmVyKF9kaWN0KTsKICAgICAgICBKb2luYWJsZSBqb2luOwogICAgICAg\nIE9iamVjdCB2YWw7CiAgICAgICAgaW50IGNvdW50ID0gMDsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IHRvQ29scy5sZW5ndGg7IGkrKywgY291bnQr\nKykgewogICAgICAgICAgICBpZiAocGtzID09IG51bGwpCiAgICAgICAgICAg\nICAgICB2YWwgPSAob2lkID09IG51bGwpID8gbnVsbCA6IE51bWJlcnMudmFs\ndWVPZigoKElkKW9pZCkuZ2V0SWQoKSk7CiAgICAgICAgICAgIGVsc2Ugewog\nICAgICAgICAgICAgICAgLy8gbXVzdCBiZSBhcHAgaWRlbnRpdHk7IHVzZSBw\nayBpbmRleCB0byBnZXQgY29ycmVjdCBwayB2YWx1ZQogICAgICAgICAgICAg\nICAgam9pbiA9IG1hcHBpbmcuYXNzZXJ0Sm9pbmFibGUodG9Db2xzW2ldKTsK\nICAgICAgICAgICAgICAgIHZhbCA9IHBrc1ttYXBwaW5nLmdldEZpZWxkKGpv\naW4uZ2V0RmllbGRJbmRleCgpKS4KICAgICAgICAgICAgICAgICAgICBnZXRQ\ncmltYXJ5S2V5SW5kZXgoKV07CiAgICAgICAgICAgICAgICB2YWwgPSBqb2lu\nLmdldEpvaW5WYWx1ZSh2YWwsIHRvQ29sc1tpXSwgc3RvcmUpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAgYnVmLmFw\ncGVuZChnZXRDb2x1bW5BbGlhcyhmcm9tQ29sc1tpXSwgcGopKTsKICAgICAg\nICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiIElTICIpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICBidWYuYXBwZW5kKCIgPSAiKTsKICAgICAgICAgICAgYnVmLmFwcGVuZFZh\nbHVlKHZhbCwgZnJvbUNvbHNbaV0pOwogICAgICAgIH0KCiAgICAgICAgaWYg\nKGNvbnN0Q29scyAhPSBudWxsICYmIGNvbnN0Q29scy5sZW5ndGggPiAwKSB7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29uc3RDb2xzLmxl\nbmd0aDsgaSsrLCBjb3VudCsrKSB7CiAgICAgICAgICAgICAgICBpZiAoY291\nbnQgPiAwKQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQg\nIik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGdldENvbHVtbkFsaWFz\nKGNvbnN0Q29sc1tpXSwgcGopKTsKCiAgICAgICAgICAgICAgICBpZiAodmFs\nc1tpXSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIiBJUyAiKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKCIgPSAiKTsKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmRWYWx1ZSh2YWxzW2ldLCBjb25zdENvbHNbaV0pOwogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICB3aGVyZShidWYsIHBqKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRlc3QgdG8gc2VlIGlmIHRoZSBnaXZlbiBzZXQg\nb2YgY29sdW1ucyBjb250YWlucyBhbGwgdGhlCiAgICAgKiBjb2x1bW5zIGlu\nIHRoZSBnaXZlbiBwb3RlbnRpYWwgc3Vic2V0LgogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBib29sZWFuIGNvbnRhaW5zQWxsKENvbHVtbltdIHNldCwg\nQ29sdW1uW10gc3ViKSB7CiAgICAgICAgaWYgKHN1Yi5sZW5ndGggPiBzZXQu\nbGVuZ3RoKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIC8v\nIHRoaXMgaXMgb2J2aW91c2x5IG5eMiwgYnV0IHRoZSBudW1iZXIgb2YgY29s\ndW1ucyBzaG91bGQgYmUgaW4KICAgICAgICAvLyB0aGUgMS0yIHJhbmdlLCBz\nbyBubyBiaWdnaWUKICAgICAgICBib29sZWFuIGZvdW5kID0gdHJ1ZTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN1Yi5sZW5ndGggJiYgZm91bmQ7\nIGkrKykgewogICAgICAgICAgICBmb3VuZCA9IGZhbHNlOwogICAgICAgICAg\nICBmb3IgKGludCBqID0gMDsgaiA8IHNldC5sZW5ndGggJiYgIWZvdW5kOyBq\nKyspCiAgICAgICAgICAgICAgICBmb3VuZCA9IHN1YltpXSA9PSBzZXRbal07\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmb3VuZDsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCB3aGVyZShKb2lucyBqb2lucykgewogICAgICAgIGlmIChq\nb2lucyAhPSBudWxsKQogICAgICAgICAgICB3aGVyZSgoU3RyaW5nKSBudWxs\nLCBqb2lucyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgd2hlcmUoU1FMQnVm\nZmVyIHNxbCkgewogICAgICAgIHdoZXJlKHNxbCwgKEpvaW5zKSBudWxsKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZShTUUxCdWZmZXIgc3FsLCBK\nb2lucyBqb2lucykgewogICAgICAgIHdoZXJlKHNxbCwgZ2V0Sm9pbnMoam9p\nbnMsIHRydWUpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2\nZW4gY29uZGl0aW9uIHRvIHRoZSBXSEVSRSBjbGF1c2UuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCB3aGVyZShTUUxCdWZmZXIgc3FsLCBQYXRoSm9pbnMg\ncGopIHsKICAgICAgICAvLyBubyBuZWVkIHRvIHVzZSBqb2lucy4uLgogICAg\nICAgIGlmIChzcWwgPT0gbnVsbCB8fCBzcWwuaXNFbXB0eSgpKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIGlmIChfd2hlcmUgPT0gbnVsbCkKICAg\nICAgICAgICAgX3doZXJlID0gbmV3IFNRTEJ1ZmZlcihfZGljdCk7CiAgICAg\nICAgZWxzZSBpZiAoIV93aGVyZS5pc0VtcHR5KCkpCiAgICAgICAgICAgIF93\naGVyZS5hcHBlbmQoIiBBTkQgIik7CiAgICAgICAgX3doZXJlLmFwcGVuZChz\ncWwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlKFN0cmluZyBzcWwp\nIHsKICAgICAgICB3aGVyZShzcWwsIChKb2lucykgbnVsbCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgd2hlcmUoU3RyaW5nIHNxbCwgSm9pbnMgam9pbnMp\nIHsKICAgICAgICB3aGVyZShzcWwsIGdldEpvaW5zKGpvaW5zLCB0cnVlKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVuIGNvbmRpdGlv\nbiB0byB0aGUgV0hFUkUgY2xhdXNlLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgd2hlcmUoU3RyaW5nIHNxbCwgUGF0aEpvaW5zIHBqKSB7CiAgICAgICAg\nLy8gbm8gbmVlZCB0byB1c2Ugam9pbnMuLi4KICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eShzcWwpKQogICAgICAgICAgICByZXR1cm47CgogICAg\nICAgIGlmIChfd2hlcmUgPT0gbnVsbCkKICAgICAgICAgICAgX3doZXJlID0g\nbmV3IFNRTEJ1ZmZlcihfZGljdCk7CiAgICAgICAgZWxzZSBpZiAoIV93aGVy\nZS5pc0VtcHR5KCkpCiAgICAgICAgICAgIF93aGVyZS5hcHBlbmQoIiBBTkQg\nIik7CiAgICAgICAgX3doZXJlLmFwcGVuZChzcWwpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGhhdmluZyhTUUxCdWZmZXIgc3FsKSB7CiAgICAgICAgaGF2\naW5nKHNxbCwgKEpvaW5zKSBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBoYXZpbmcoU1FMQnVmZmVyIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAg\nICBoYXZpbmcoc3FsLCBnZXRKb2lucyhqb2lucywgdHJ1ZSkpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkIHRoZSBnaXZlbiBjb25kaXRpb24gdG8gdGhl\nIEhBVklORyBjbGF1c2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBoYXZp\nbmcoU1FMQnVmZmVyIHNxbCwgUGF0aEpvaW5zIHBqKSB7CiAgICAgICAgLy8g\nbm8gbmVlZCB0byB1c2Ugam9pbnMuLi4KICAgICAgICBpZiAoc3FsID09IG51\nbGwgfHwgc3FsLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICBpZiAoX2hhdmluZyA9PSBudWxsKQogICAgICAgICAgICBfaGF2aW5n\nID0gbmV3IFNRTEJ1ZmZlcihfZGljdCk7CiAgICAgICAgZWxzZSBpZiAoIV9o\nYXZpbmcuaXNFbXB0eSgpKQogICAgICAgICAgICBfaGF2aW5nLmFwcGVuZCgi\nIEFORCAiKTsKICAgICAgICBfaGF2aW5nLmFwcGVuZChzcWwpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTdHJpbmcgc3FsKSB7CiAgICAgICAg\naGF2aW5nKHNxbCwgKEpvaW5zKSBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBoYXZpbmcoU3RyaW5nIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAg\nICBoYXZpbmcoc3FsLCBnZXRKb2lucyhqb2lucywgdHJ1ZSkpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkIHRoZSBnaXZlbiBjb25kaXRpb24gdG8gdGhl\nIEhBVklORyBjbGF1c2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBoYXZp\nbmcoU3RyaW5nIHNxbCwgUGF0aEpvaW5zIHBqKSB7CiAgICAgICAgLy8gbm8g\nbmVlZCB0byB1c2Ugam9pbnMuLi4KICAgICAgICBpZiAoU3RyaW5nVXRpbHMu\naXNFbXB0eShzcWwpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIGlm\nIChfaGF2aW5nID09IG51bGwpCiAgICAgICAgICAgIF9oYXZpbmcgPSBuZXcg\nU1FMQnVmZmVyKF9kaWN0KTsKICAgICAgICBlbHNlIGlmICghX2hhdmluZy5p\nc0VtcHR5KCkpCiAgICAgICAgICAgIF9oYXZpbmcuYXBwZW5kKCIgQU5EICIp\nOwogICAgICAgIF9oYXZpbmcuYXBwZW5kKHNxbCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgZ3JvdXBCeShTUUxCdWZmZXIgc3FsKSB7CiAgICAgICAgZ3Jv\ndXBCeShzcWwsIChKb2lucykgbnVsbCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgZ3JvdXBCeShTUUxCdWZmZXIgc3FsLCBKb2lucyBqb2lucykgewogICAg\nICAgIGdldEpvaW5zKGpvaW5zLCB0cnVlKTsKICAgICAgICBpZiAoX2dyb3Vw\naW5nID09IG51bGwpCiAgICAgICAgICAgIF9ncm91cGluZyA9IG5ldyBTUUxC\ndWZmZXIoX2RpY3QpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX2dyb3Vw\naW5nLmFwcGVuZCgiLCAiKTsKICAgICAgICBfZ3JvdXBpbmcuYXBwZW5kKHNx\nbCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZ3JvdXBCeShTdHJpbmcgc3Fs\nKSB7CiAgICAgICAgZ3JvdXBCeShzcWwsIChKb2lucykgbnVsbCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgZ3JvdXBCeShTdHJpbmcgc3FsLCBKb2lucyBq\nb2lucykgewogICAgICAgIGdldEpvaW5zKGpvaW5zLCB0cnVlKTsKICAgICAg\nICBpZiAoX2dyb3VwaW5nID09IG51bGwpCiAgICAgICAgICAgIF9ncm91cGlu\nZyA9IG5ldyBTUUxCdWZmZXIoX2RpY3QpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgX2dyb3VwaW5nLmFwcGVuZCgiLCAiKTsKICAgICAgICBfZ3JvdXBp\nbmcuYXBwZW5kKHNxbCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZ3JvdXBC\neShDb2x1bW4gY29sKSB7CiAgICAgICAgZ3JvdXBCeShjb2wsIG51bGwpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoQ29sdW1uIGNvbCwgSm9p\nbnMgam9pbnMpIHsKICAgICAgICBpZiAoX2dyb3VwaW5nID09IG51bGwpCiAg\nICAgICAgICAgIF9ncm91cGluZyA9IG5ldyBTUUxCdWZmZXIoX2RpY3QpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgX2dyb3VwaW5nLmFwcGVuZCgiLCAi\nKTsKCiAgICAgICAgUGF0aEpvaW5zIHBqID0gZ2V0Sm9pbnMoam9pbnMsIHRy\ndWUpOwogICAgICAgIF9ncm91cGluZy5hcHBlbmQoZ2V0Q29sdW1uQWxpYXMo\nY29sLCBwaikpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoQ29s\ndW1uW10gY29scykgewogICAgICAgIGdyb3VwQnkoY29scywgbnVsbCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgZ3JvdXBCeShDb2x1bW5bXSBjb2xzLCBK\nb2lucyBqb2lucykgewogICAgICAgIGlmIChfZ3JvdXBpbmcgPT0gbnVsbCkK\nICAgICAgICAgICAgX2dyb3VwaW5nID0gbmV3IFNRTEJ1ZmZlcihfZGljdCk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBfZ3JvdXBpbmcuYXBwZW5kKCIs\nICIpOwoKICAgICAgICBQYXRoSm9pbnMgcGogPSBnZXRKb2lucyhqb2lucywg\ndHJ1ZSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChpID4gMCkKICAgICAgICAgICAg\nICAgIF9ncm91cGluZy5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgIF9ncm91\ncGluZy5hcHBlbmQoZ2V0Q29sdW1uQWxpYXMoY29sc1tpXSwgcGopKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgZ3JvdXBCeShDbGFzc01h\ncHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNzZXMsIEpEQkNTdG9yZSBzdG9y\nZSwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAg\nICAgICAgZ3JvdXBCeShtYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0\nY2gsIG51bGwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoQ2xh\nc3NNYXBwaW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2VzLCBKREJDU3RvcmUg\nc3RvcmUsCiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwg\nSm9pbnMgam9pbnMpIHsKICAgICAgICAvLyB3ZSBpbXBsZW1lbnQgdGhpcyBi\neSBwdXR0aW5nIG91cnNlbHZlcyBpbnRvIGdyb3VwaW5nIG1vZGUsIHdoZXJl\nCiAgICAgICAgLy8gYWxsIHNlbGVjdCBpbnZvY2F0aW9ucyBhcmUgcmUtcm91\ndGVkIHRvIGdyb3VwLWJ5IGludm9jYXRpb25zIGluc3RlYWQuCiAgICAgICAg\nLy8gdGhpcyBhbGxvd3MgdXMgdG8gdXRpbGl6ZSB0aGUgc2FtZSBzZWxlY3Qg\nQVBJcyBvZiB0aGUgc3RvcmUgbWFuYWdlcgogICAgICAgIC8vIGFuZCBhbGwg\ndGhlIG1hcHBpbmcgc3RyYXRlZ2llcywgcmF0aGVyIHRoYW4gaGF2aW5nIHRv\nIGNyZWF0ZSAKICAgICAgICAvLyBlcXVpdmFsZW50IEFQSXMgYW5kIGR1cGxp\nY2F0ZSBsb2dpYyBmb3IgZ3JvdXBpbmcKICAgICAgICBib29sZWFuIHdhc0dy\nb3VwaW5nID0gaXNHcm91cGluZygpOwogICAgICAgIF9mbGFncyB8PSBHUk9V\nUElORzsKICAgICAgICB0cnkgewogICAgICAgICAgICBzZWxlY3QobWFwcGlu\nZywgc3ViY2xhc3Nlcywgc3RvcmUsIGZldGNoLCAKICAgICAgICAgICAgICAg\nIEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9OT05FLCBqb2lucyk7CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKCF3YXNHcm91cGluZykKICAg\nICAgICAgICAgICAgIF9mbGFncyAmPSB+R1JPVVBJTkc7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB3ZSdyZSBpbiBncm91cCBt\nb2RlLCB3aGVyZSBhbnkgc2VsZWN0IGlzIGNoYW5nZWQgdG8gYSBncm91cC1i\neQogICAgICogY2FsbC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGlz\nR3JvdXBpbmcoKSB7CiAgICAgICAgcmV0dXJuIChfZmxhZ3MgJiBHUk9VUElO\nRykgIT0gMDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgam9p\nbnMgdG8gdXNlIGZvciBjb2x1bW4gYWxpYXNlcywgZXRjLgogICAgICoKICAg\nICAqIEBwYXJhbSBqb2lucyBqb2lucyBnaXZlbiBieSB0aGUgdXNlcgogICAg\nICogQHJldHVybiB0aGUgam9pbnMgdG8gdXNlIGZvciBhbGlhc2VzLCBldGMK\nICAgICAqLwogICAgcHJpdmF0ZSBQYXRoSm9pbnMgZ2V0Sm9pbnMoSm9pbnMg\nam9pbnMsIGJvb2xlYW4gcmVjb3JkKSB7CiAgICAgICAgUGF0aEpvaW5zIHBq\nID0gKFBhdGhKb2lucykgam9pbnM7CiAgICAgICAgYm9vbGVhbiBwcmUgPSAo\ncGogPT0gbnVsbCB8fCAhcGouaXNEaXJ0eSgpKQogICAgICAgICAgICAmJiBf\ncHJlSm9pbnMgIT0gbnVsbCAmJiAhX3ByZUpvaW5zLmlzRW1wdHkoKTsKICAg\nICAgICBpZiAocHJlKQogICAgICAgICAgICBwaiA9IChQYXRoSm9pbnMpIF9w\ncmVKb2lucy5wZWVrKCk7CgogICAgICAgIGlmIChwaiA9PSBudWxsIHx8ICFw\nai5pc0RpcnR5KCkpCiAgICAgICAgICAgIHBqID0gX2pvaW5zOwogICAgICAg\nIGVsc2UgaWYgKCFwcmUpIHsKICAgICAgICAgICAgaWYgKChfZmxhZ3MgJiBP\nVVRFUikgIT0gMCkKICAgICAgICAgICAgICAgIHBqID0gKFBhdGhKb2lucykg\nb3V0ZXIocGopOwogICAgICAgICAgICBpZiAocmVjb3JkKSB7CiAgICAgICAg\nICAgICAgICBpZiAoIXBqLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgICAg\nICByZW1vdmVQYXJlbnRKb2lucyhwaik7CiAgICAgICAgICAgICAgICBpZiAo\nIXBqLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgIHJlbW92ZUpv\naW5zRnJvbVN1YnNlbGVjdHMocGopOwogICAgICAgICAgICAgICAgICAgIGlm\nIChfam9pbnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgX2pv\naW5zID0gbmV3IFNlbGVjdEpvaW5zKHRoaXMpOwogICAgICAgICAgICAgICAg\nICAgIGlmIChfam9pbnMuam9pbnMoKSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgICAgICBfam9pbnMuc2V0Sm9pbnMobmV3IEpvaW5TZXQocGouam9p\nbnMoKSkpOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgICAgICAgICAgX2pvaW5zLmpvaW5zKCkuYWRkQWxsKHBqLmpvaW5zKCkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBwajsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92\nZSBhbnkgam9pbnMgYWxyZWFkeSBpbiBvdXIgcGFyZW50IHNlbGVjdCBmcm9t\nIHRoZSBnaXZlbiBub24tZW1wdHkKICAgICAqIGpvaW4gc2V0LgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgcmVtb3ZlUGFyZW50Sm9pbnMoUGF0aEpvaW5z\nIHBqKSB7CiAgICAgICAgaWYgKF9wYXJlbnQgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgIGlmIChfcGFyZW50Ll9qb2lucyAhPSBudWxs\nICYmICFfcGFyZW50Ll9qb2lucy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHBq\nLmpvaW5zKCkucmVtb3ZlQWxsKF9wYXJlbnQuX2pvaW5zLmpvaW5zKCkpOwog\nICAgICAgIGlmICghcGouaXNFbXB0eSgpKQogICAgICAgICAgICBfcGFyZW50\nLnJlbW92ZVBhcmVudEpvaW5zKHBqKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJlbW92ZSB0aGUgZ2l2ZW4gbm9uLWVtcHR5IGpvaW5zIGZyb20gdGhlIGpv\naW5zIG9mIG91ciBzdWJzZWxlY3RzLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgcmVtb3ZlSm9pbnNGcm9tU3Vic2VsZWN0cyhQYXRoSm9pbnMgcGopIHsK\nICAgICAgICBpZiAoX3N1YnNlbHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIFNlbGVjdEltcGwgc3ViOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX3N1YnNlbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAg\nICAgc3ViID0gKFNlbGVjdEltcGwpIF9zdWJzZWxzLmdldChpKTsKICAgICAg\nICAgICAgaWYgKHN1Yi5fam9pbnMgIT0gbnVsbCAmJiAhc3ViLl9qb2lucy5p\nc0VtcHR5KCkpCiAgICAgICAgICAgICAgICBzdWIuX2pvaW5zLmpvaW5zKCku\ncmVtb3ZlQWxsKHBqLmpvaW5zKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgU2VsZWN0RXhlY3V0b3Igd2hlcmVDbG9uZShpbnQgc2Vscykgewog\nICAgICAgIGlmIChzZWxzIDwgMSkKICAgICAgICAgICAgc2VscyA9IDE7Cgog\nICAgICAgIFNlbGVjdFtdIGNsb25lcyA9IG51bGw7CiAgICAgICAgU2VsZWN0\nSW1wbCBzZWw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxzOyBp\nKyspIHsKICAgICAgICAgICAgc2VsID0gKFNlbGVjdEltcGwpIF9jb25mLmdl\ndFNRTEZhY3RvcnlJbnN0YW5jZSgpLm5ld1NlbGVjdCgpOwogICAgICAgICAg\nICBzZWwuX2ZsYWdzID0gX2ZsYWdzOwogICAgICAgICAgICBzZWwuX2ZsYWdz\nICY9IH5BR0dSRUdBVEU7CiAgICAgICAgICAgIHNlbC5fZmxhZ3MgJj0gfk9V\nVEVSOwogICAgICAgICAgICBzZWwuX2ZsYWdzICY9IH5MUlM7CiAgICAgICAg\nICAgIHNlbC5fZmxhZ3MgJj0gfkVBR0VSX1RPX09ORTsKICAgICAgICAgICAg\nc2VsLl9mbGFncyAmPSB+RUFHRVJfVE9fTUFOWTsKICAgICAgICAgICAgc2Vs\nLl9qb2luU3ludGF4ID0gX2pvaW5TeW50YXg7CiAgICAgICAgICAgIGlmIChf\nYWxpYXNlcyAhPSBudWxsKQogICAgICAgICAgICAgICAgc2VsLl9hbGlhc2Vz\nID0gbmV3IEhhc2hNYXAoX2FsaWFzZXMpOwogICAgICAgICAgICBpZiAoX3Rh\nYmxlcyAhPSBudWxsKQogICAgICAgICAgICAgICAgc2VsLl90YWJsZXMgPSBu\nZXcgVHJlZU1hcChfdGFibGVzKTsKICAgICAgICAgICAgaWYgKF9qb2lucyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgc2VsLl9qb2lucyA9IF9qb2lucy5j\nbG9uZShzZWwpOwogICAgICAgICAgICBpZiAoX3doZXJlICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBzZWwuX3doZXJlID0gbmV3IFNRTEJ1ZmZlcihfd2hl\ncmUpOwogICAgICAgICAgICBpZiAoX2Zyb20gIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgc2VsLl9mcm9tID0gKFNlbGVjdEltcGwpIF9mcm9tLndoZXJl\nQ2xvbmUoMSk7CiAgICAgICAgICAgICAgICBzZWwuX2Zyb20uX291dGVyID0g\nc2VsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChfc3Vic2VscyAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzZWwuX3N1YnNlbHMgPSBuZXcg\nQXJyYXlMaXN0KF9zdWJzZWxzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBT\nZWxlY3RJbXBsIHN1Yiwgc2VsU3ViOwogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaiA9IDA7IGogPCBfc3Vic2Vscy5zaXplKCk7IGorKykgewogICAgICAg\nICAgICAgICAgICAgIHN1YiA9IChTZWxlY3RJbXBsKSBfc3Vic2Vscy5nZXQo\naik7CiAgICAgICAgICAgICAgICAgICAgc2VsU3ViID0gKFNlbGVjdEltcGwp\nIHN1Yi5mdWxsQ2xvbmUoMSk7CiAgICAgICAgICAgICAgICAgICAgc2VsU3Vi\nLl9wYXJlbnQgPSBzZWw7CiAgICAgICAgICAgICAgICAgICAgc2VsU3ViLl9z\ndWJQYXRoID0gc3ViLl9zdWJQYXRoOwogICAgICAgICAgICAgICAgICAgIHNl\nbC5fc3Vic2Vscy5hZGQoc2VsU3ViKTsKICAgICAgICAgICAgICAgICAgICBp\nZiAoc2VsLl93aGVyZSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAg\nICBzZWwuX3doZXJlLnJlcGxhY2Uoc3ViLCBzZWxTdWIpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2VscyA9\nPSAxKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbDsKICAgICAgICAgICAg\naWYgKGNsb25lcyA9PSBudWxsKQogICAgICAgICAgICAgICAgY2xvbmVzID0g\nbmV3IFNlbGVjdFtzZWxzXTsKICAgICAgICAgICAgY2xvbmVzW2ldID0gc2Vs\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2NvbmYuZ2V0U1FMRmFjdG9y\neUluc3RhbmNlKCkubmV3VW5pb24oY2xvbmVzKTsKICAgIH0KCiAgICBwdWJs\naWMgU2VsZWN0RXhlY3V0b3IgZnVsbENsb25lKGludCBzZWxzKSB7CiAgICAg\nICAgaWYgKHNlbHMgPCAxKQogICAgICAgICAgICBzZWxzID0gMTsKCiAgICAg\nICAgU2VsZWN0W10gY2xvbmVzID0gbnVsbDsKICAgICAgICBTZWxlY3RJbXBs\nIHNlbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlbHM7IGkrKykg\newogICAgICAgICAgICBzZWwgPSAoU2VsZWN0SW1wbCkgd2hlcmVDbG9uZSgx\nKTsKICAgICAgICAgICAgc2VsLl9mbGFncyA9IF9mbGFnczsKICAgICAgICAg\nICAgc2VsLl9zZWxlY3RzLmFkZEFsbChfc2VsZWN0cyk7CiAgICAgICAgICAg\nIGlmIChfb3JkZXJpbmcgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNlbC5f\nb3JkZXJpbmcgPSBuZXcgU1FMQnVmZmVyKF9vcmRlcmluZyk7CiAgICAgICAg\nICAgIHNlbC5fb3JkZXJzID0gX29yZGVyczsKICAgICAgICAgICAgaWYgKF9n\ncm91cGluZyAhPSBudWxsKQogICAgICAgICAgICAgICAgc2VsLl9ncm91cGlu\nZyA9IG5ldyBTUUxCdWZmZXIoX2dyb3VwaW5nKTsKICAgICAgICAgICAgaWYg\nKF9oYXZpbmcgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNlbC5faGF2aW5n\nID0gbmV3IFNRTEJ1ZmZlcihfaGF2aW5nKTsKICAgICAgICAgICAgaWYgKF9m\ncm9tICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHNlbC5fZnJvbSA9IChT\nZWxlY3RJbXBsKSBfZnJvbS5mdWxsQ2xvbmUoMSk7CiAgICAgICAgICAgICAg\nICBzZWwuX2Zyb20uX291dGVyID0gc2VsOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBpZiAoc2VscyA9PSAxKQogICAgICAgICAgICAgICAgcmV0dXJu\nIHNlbDsKICAgICAgICAgICAgaWYgKGNsb25lcyA9PSBudWxsKQogICAgICAg\nICAgICAgICAgY2xvbmVzID0gbmV3IFNlbGVjdFtzZWxzXTsKICAgICAgICAg\nICAgY2xvbmVzW2ldID0gc2VsOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nX2NvbmYuZ2V0U1FMRmFjdG9yeUluc3RhbmNlKCkubmV3VW5pb24oY2xvbmVz\nKTsKICAgIH0KCiAgICBwdWJsaWMgU2VsZWN0RXhlY3V0b3IgZWFnZXJDbG9u\nZShGaWVsZE1hcHBpbmcga2V5LCBpbnQgZWFnZXJUeXBlLAogICAgICAgIGJv\nb2xlYW4gdG9NYW55LCBpbnQgc2VscykgewogICAgICAgIGlmIChlYWdlclR5\ncGUgPT0gRUFHRVJfT1VURVIKICAgICAgICAgICAgJiYgX2pvaW5TeW50YXgg\nPT0gSm9pblN5bnRheGVzLlNZTlRBWF9UUkFESVRJT05BTCkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYgKF9lYWdlcktleXMgIT0gbnVs\nbCAmJiBfZWFnZXJLZXlzLmNvbnRhaW5zKGtleSkpCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwoKICAgICAgICAvLyBnbG9iYWwgc2V0IG9mIGVhZ2VyIGtl\neXMKICAgICAgICBpZiAoX2VhZ2VyS2V5cyA9PSBudWxsKQogICAgICAgICAg\nICBfZWFnZXJLZXlzID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICBfZWFnZXJL\nZXlzLmFkZChrZXkpOwoKICAgICAgICBTZWxlY3RFeGVjdXRvciBzZWw7CiAg\nICAgICAgaWYgKGVhZ2VyVHlwZSAhPSBFQUdFUl9QQVJBTExFTCkgewogICAg\nICAgICAgICBpZiAodG9NYW55KQogICAgICAgICAgICAgICAgX2ZsYWdzIHw9\nIEVBR0VSX1RPX01BTlk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgIF9mbGFncyB8PSBFQUdFUl9UT19PTkU7CiAgICAgICAgICAgIHNlbCA9\nIHRoaXM7CiAgICAgICAgfSBlbHNlIGlmIChzZWxzIDwgMikKICAgICAgICAg\nICAgc2VsID0gcGFyYWxsZWxDbG9uZSgpOwogICAgICAgIGVsc2UgewogICAg\nICAgICAgICBTZWxlY3RbXSBjbG9uZXMgPSBuZXcgU2VsZWN0W3NlbHNdOwog\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNsb25lcy5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgICAgIGNsb25lc1tpXSA9IHBhcmFsbGVsQ2xv\nbmUoKTsKICAgICAgICAgICAgc2VsID0gX2NvbmYuZ2V0U1FMRmFjdG9yeUlu\nc3RhbmNlKCkubmV3VW5pb24oY2xvbmVzKTsKICAgICAgICB9CgogICAgICAg\nIGlmIChfZWFnZXIgPT0gbnVsbCkKICAgICAgICAgICAgX2VhZ2VyID0gbmV3\nIEhhc2hNYXAoKTsKICAgICAgICBfZWFnZXIucHV0KHRvRWFnZXJLZXkoa2V5\nLCBnZXRKb2lucyhudWxsLCBmYWxzZSkpLCBzZWwpOwogICAgICAgIHJldHVy\nbiBzZWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBjbG9uZSBv\nZiB0aGlzIHNlbGVjdCBmb3IgdXNlIGluIGVhZ2VyIHBhcmFsbGVsIHNlbGVj\ndHMuCiAgICAgKi8KICAgIHByaXZhdGUgU2VsZWN0SW1wbCBwYXJhbGxlbENs\nb25lKCkgewogICAgICAgIFNlbGVjdEltcGwgc2VsID0gKFNlbGVjdEltcGwp\nIHdoZXJlQ2xvbmUoMSk7CiAgICAgICAgc2VsLl9mbGFncyAmPSB+Tk9OQVVU\nT19ESVNUSU5DVDsKICAgICAgICBzZWwuX2VhZ2VyS2V5cyA9IF9lYWdlcktl\neXM7CiAgICAgICAgaWYgKF9wcmVKb2lucyAhPSBudWxsICYmICFfcHJlSm9p\nbnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIHNlbC5fcHJlSm9pbnMgPSBu\nZXcgU3RhY2soKTsKICAgICAgICAgICAgc2VsLl9wcmVKb2lucy5wdXNoKCgo\nU2VsZWN0Sm9pbnMpIF9wcmVKb2lucy5wZWVrKCkpLgogICAgICAgICAgICAg\nICAgY2xvbmUoc2VsKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWw7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdmlldyBvZiBlYWdlciBz\nZWxlY3RzLiBNYXkgYmUgbnVsbC4KICAgICAqLwogICAgcHVibGljIE1hcCBn\nZXRFYWdlck1hcCgpIHsKICAgICAgICByZXR1cm4gX2VhZ2VyOwogICAgfQoK\nICAgIHB1YmxpYyBTZWxlY3RFeGVjdXRvciBnZXRFYWdlcihGaWVsZE1hcHBp\nbmcga2V5KSB7CiAgICAgICAgaWYgKF9lYWdlciA9PSBudWxsIHx8ICFfZWFn\nZXJLZXlzLmNvbnRhaW5zKGtleSkpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIHJldHVybiAoU2VsZWN0RXhlY3V0b3IpIF9lYWdlci5nZXQo\ndG9FYWdlcktleShrZXksIGdldEpvaW5zKG51bGwsCiAgICAgICAgICAgIGZh\nbHNlKSkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBlYWdl\nciBrZXkgdG8gdXNlIGZvciB0aGUgdXNlci1naXZlbiBrZXkuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCB0b0VhZ2VyS2V5KEZpZWxkTWFw\ncGluZyBrZXksIFBhdGhKb2lucyBwaikgewogICAgICAgIGlmIChwaiA9PSBu\ndWxsIHx8IHBqLnBhdGgoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\na2V5OwogICAgICAgIHJldHVybiBuZXcgS2V5KHBqLnBhdGgoKS50b1N0cmlu\nZygpLCBrZXkpOwogICAgfQoKICAgIHB1YmxpYyBKb2lucyBuZXdKb2lucygp\nIHsKICAgICAgICBpZiAoX3ByZUpvaW5zICE9IG51bGwgJiYgIV9wcmVKb2lu\ncy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgU2VsZWN0Sm9pbnMgc2ogPSAo\nU2VsZWN0Sm9pbnMpIF9wcmVKb2lucy5wZWVrKCk7CiAgICAgICAgICAgIHJl\ndHVybiBzai5jbG9uZSh0aGlzKTsKICAgICAgICB9CiAgICAgICAgLy8gcmV0\ndXJuIHRoaXMgZm9yIGVmZmljaWVuY3kgaW4gY2FzZSBubyBqb2lucyBlbmQg\ndXAgYmVpbmcgbWFkZQogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAg\nIHB1YmxpYyBKb2lucyBuZXdPdXRlckpvaW5zKCkgewogICAgICAgIHJldHVy\nbiAoKFBhdGhKb2lucykgbmV3Sm9pbnMoKSkuc2V0T3V0ZXIodHJ1ZSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5kKFNRTEJ1ZmZlciBidWYsIEpv\naW5zIGpvaW5zKSB7CiAgICAgICAgaWYgKGpvaW5zID09IG51bGwgfHwgam9p\nbnMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIGlm\nICghYnVmLmlzRW1wdHkoKSkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFO\nRCAiKTsKICAgICAgICBKb2luIGpvaW4gPSBudWxsOwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gKChQYXRoSm9pbnMpIGpvaW5zKS5qb2lucygpLmpv\naW5JdGVyYXRvcigpOwogICAgICAgICAgICBpdHIuaGFzTmV4dCgpOykgewog\nICAgICAgICAgICBqb2luID0gKEpvaW4pIGl0ci5uZXh0KCk7CiAgICAgICAg\nICAgIHN3aXRjaCAoX2pvaW5TeW50YXgpIHsKICAgICAgICAgICAgICAgIGNh\nc2UgSm9pblN5bnRheGVzLlNZTlRBWF9UUkFESVRJT05BTDoKICAgICAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKF9kaWN0LnRvVHJhZGl0aW9uYWxKb2lu\nKGpvaW4pKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgSm9pblN5bnRheGVzLlNZTlRBWF9EQVRBQkFTRToKICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKF9kaWN0LnRvTmF0aXZlSm9p\nbihqb2luKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoIiBBTkQgIik7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBK\nb2lucyBhbmQoSm9pbnMgam9pbnMxLCBKb2lucyBqb2luczIpIHsKICAgICAg\nICByZXR1cm4gYW5kKChQYXRoSm9pbnMpIGpvaW5zMSwgKFBhdGhKb2lucykg\nam9pbnMyLCB0cnVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbWJpbmUg\ndGhlIGdpdmVuIGpvaW5zLgogICAgICovCiAgICBwcml2YXRlIFNlbGVjdEpv\naW5zIGFuZChQYXRoSm9pbnMgajEsIFBhdGhKb2lucyBqMiwgYm9vbGVhbiBu\ndWxsSm9pbnMpIHsKICAgICAgICBpZiAoKGoxID09IG51bGwgfHwgajEuaXNF\nbXB0eSgpKQogICAgICAgICAgICAmJiAoajIgPT0gbnVsbCB8fCBqMi5pc0Vt\ncHR5KCkpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU2Vs\nZWN0Sm9pbnMgc2ogPSBuZXcgU2VsZWN0Sm9pbnModGhpcyk7CiAgICAgICAg\naWYgKGoxID09IG51bGwgfHwgajEuaXNFbXB0eSgpKSB7CiAgICAgICAgICAg\nIGlmIChudWxsSm9pbnMpCiAgICAgICAgICAgICAgICBzai5zZXRKb2lucyhq\nMi5qb2lucygpKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nc2ouc2V0Sm9pbnMobmV3IEpvaW5TZXQoajIuam9pbnMoKSkpOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgIEpvaW5TZXQgc2V0OwogICAgICAgICAg\nICBpZiAobnVsbEpvaW5zKQogICAgICAgICAgICAgICAgc2V0ID0gajEuam9p\nbnMoKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgc2V0ID0g\nbmV3IEpvaW5TZXQoajEuam9pbnMoKSk7CgogICAgICAgICAgICBpZiAoajIg\nIT0gbnVsbCAmJiAhajIuaXNFbXB0eSgpKQogICAgICAgICAgICAgICAgc2V0\nLmFkZEFsbChqMi5qb2lucygpKTsKICAgICAgICAgICAgc2ouc2V0Sm9pbnMo\nc2V0KTsKICAgICAgICB9CgogICAgICAgIC8vIG51bGwgcHJldmlvdXMgam9p\nbnM7IGFsbCBhcmUgY29tYmluZWQgaW50byB0aGlzIG9uZQogICAgICAgIGlm\nIChudWxsSm9pbnMgJiYgajEgIT0gbnVsbCkKICAgICAgICAgICAgajEubnVs\nbEpvaW5zKCk7CiAgICAgICAgaWYgKG51bGxKb2lucyAmJiBqMiAhPSBudWxs\nKQogICAgICAgICAgICBqMi5udWxsSm9pbnMoKTsKCiAgICAgICAgcmV0dXJu\nIHNqOwogICAgfQoKICAgIHB1YmxpYyBKb2lucyBvcihKb2lucyBqb2luczEs\nIEpvaW5zIGpvaW5zMikgewogICAgICAgIFBhdGhKb2lucyBqMSA9IChQYXRo\nSm9pbnMpIGpvaW5zMTsKICAgICAgICBQYXRoSm9pbnMgajIgPSAoUGF0aEpv\naW5zKSBqb2luczI7CgogICAgICAgIC8vIGlmIG5vIGNvbW1vbiBqb2lucywg\ncmV0dXJuIG51bGw7IGlmIG9uZSBzaWRlIG9mIHRoZSBvciBjbGF1c2UgaGFz\nCiAgICAgICAgLy8gZGlmZmVyZW50IGpvaW5zIHRoYW4gdGhlIG90aGVyLCB0\naGVuIHdlIG5lZWQgdG8gdXNlIGRpc3RpbmN0CiAgICAgICAgYm9vbGVhbiBq\nMUVtcHR5ID0gajEgPT0gbnVsbCB8fCBqMS5pc0VtcHR5KCk7CiAgICAgICAg\nYm9vbGVhbiBqMkVtcHR5ID0gajIgPT0gbnVsbCB8fCBqMi5pc0VtcHR5KCk7\nCiAgICAgICAgaWYgKGoxRW1wdHkgfHwgajJFbXB0eSkgewogICAgICAgICAg\nICBpZiAoajFFbXB0eSAmJiAhajJFbXB0eSkgewogICAgICAgICAgICAgICAg\nY29sbGVjdE91dGVySm9pbnMoajIpOwogICAgICAgICAgICAgICAgaWYgKCFq\nMi5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICAgICAgX2ZsYWdzIHw9IElN\nUExJQ0lUX0RJU1RJTkNUOwogICAgICAgICAgICB9IGVsc2UgaWYgKGoyRW1w\ndHkgJiYgIWoxRW1wdHkpIHsKICAgICAgICAgICAgICAgIGNvbGxlY3RPdXRl\nckpvaW5zKGoxKTsKICAgICAgICAgICAgICAgIGlmICghajEuaXNFbXB0eSgp\nKQogICAgICAgICAgICAgICAgICAgIF9mbGFncyB8PSBJTVBMSUNJVF9ESVNU\nSU5DVDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICB9CgogICAgICAgIC8vIGlmIGFsbCBjb21tb24gam9pbnMsIG1v\ndmUgYWxsIGpvaW5zIHRvIHJldHVybmVkIGluc3RhbmNlCiAgICAgICAgU2Vs\nZWN0Sm9pbnMgc2ogPSBuZXcgU2VsZWN0Sm9pbnModGhpcyk7CiAgICAgICAg\naWYgKGoxLmpvaW5zKCkuZXF1YWxzKGoyLmpvaW5zKCkpKSB7CiAgICAgICAg\nICAgIHNqLnNldEpvaW5zKGoxLmpvaW5zKCkpOwogICAgICAgICAgICBqMS5u\ndWxsSm9pbnMoKTsKICAgICAgICAgICAgajIubnVsbEpvaW5zKCk7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgSm9pblNldCBjb21tb25Kb2lucyA9\nIG5ldyBKb2luU2V0KGoxLmpvaW5zKCkpOwogICAgICAgICAgICBjb21tb25K\nb2lucy5yZXRhaW5BbGwoajIuam9pbnMoKSk7CiAgICAgICAgICAgIGlmICgh\nY29tbW9uSm9pbnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICAvLyBw\ndXQgY29tbW9uIGpvaW5zIGluIHJldHVybmVkIGluc3RhbmNlOyByZW1vdmUg\ndGhlbSBmcm9tCiAgICAgICAgICAgICAgICAvLyBlYWNoIGdpdmVuIGluc3Rh\nbmNlCiAgICAgICAgICAgICAgICBzai5zZXRKb2lucyhjb21tb25Kb2lucyk7\nCiAgICAgICAgICAgICAgICBqMS5qb2lucygpLnJlbW92ZUFsbChjb21tb25K\nb2lucyk7CiAgICAgICAgICAgICAgICBqMi5qb2lucygpLnJlbW92ZUFsbChj\nb21tb25Kb2lucyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29sbGVj\ndE91dGVySm9pbnMoajEpOwogICAgICAgICAgICBjb2xsZWN0T3V0ZXJKb2lu\ncyhqMik7CgogICAgICAgICAgICAvLyBpZiBvbmUgc2lkZSBvZiB0aGUgb3Ig\nY2xhdXNlIGhhcyBkaWZmZXJlbnQgam9pbnMgdGhhbiB0aGUgb3RoZXIsCiAg\nICAgICAgICAgIC8vIHRoZW4gd2UgbmVlZCB0byB1c2UgZGlzdGluY3QKICAg\nICAgICAgICAgaWYgKCFqMS5pc0VtcHR5KCkgfHwgIWoyLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgICAgIF9mbGFncyB8PSBJTVBMSUNJVF9ESVNUSU5DVDsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNqOwogICAgfQoKICAgIHB1Ymxp\nYyBKb2lucyBvdXRlcihKb2lucyBqb2lucykgewogICAgICAgIGlmIChfam9p\nblN5bnRheCA9PSBKb2luU3ludGF4ZXMuU1lOVEFYX1RSQURJVElPTkFMIHx8\nIGpvaW5zID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBqb2luczsKCiAg\nICAgICAgLy8gcmVjb3JkIHRoYXQgdGhpcyBpcyBhbiBvdXRlciBqb2luIHNl\ndCwgZXZlbiBpZiBpdCdzIGVtcHR5CiAgICAgICAgUGF0aEpvaW5zIHBqID0g\nKChQYXRoSm9pbnMpIGpvaW5zKS5zZXRPdXRlcih0cnVlKTsKICAgICAgICBp\nZiAocGouaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gcGo7CgogICAg\nICAgIEpvaW4gam9pbjsKICAgICAgICBKb2luIHJlYzsKICAgICAgICBib29s\nZWFuIGhhc0pvaW5zID0gX2pvaW5zICE9IG51bGwgJiYgX2pvaW5zLmpvaW5z\nKCkgIT0gbnVsbDsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHBqLmpv\naW5zKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgam9pbiA9IChKb2luKSBpdHIubmV4dCgpOwogICAgICAgICAgICBpZiAo\nam9pbi5nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX0lOTkVSKSB7CiAgICAgICAg\nICAgICAgICBpZiAoIWhhc0pvaW5zKQogICAgICAgICAgICAgICAgICAgIGpv\naW4uc2V0VHlwZShKb2luLlRZUEVfT1VURVIpOwogICAgICAgICAgICAgICAg\nZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmVjID0gX2pvaW5zLmpvaW5z\nKCkuZ2V0UmVjb3JkZWRKb2luKGpvaW4pOwogICAgICAgICAgICAgICAgICAg\nIGlmIChyZWMgPT0gbnVsbCB8fCByZWMuZ2V0VHlwZSgpID09IEpvaW4uVFlQ\nRV9PVVRFUikKICAgICAgICAgICAgICAgICAgICAgICAgam9pbi5zZXRUeXBl\nKEpvaW4uVFlQRV9PVVRFUik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGpvaW5zOwogICAgfQoK\nICAgIC8qKgogICAgICogTW92ZXMgdGhlIGpvaW5zIGZyb20gdGhlIGdpdmVu\nIGluc3RhbmNlIGludG8gb3VyIG91dGVyIGpvaW5zIHNldC4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGNvbGxlY3RPdXRlckpvaW5zKFBhdGhKb2lucyBw\naikgewogICAgICAgIGlmIChfam9pblN5bnRheCA9PSBKb2luU3ludGF4ZXMu\nU1lOVEFYX1RSQURJVElPTkFMIHx8IHBqID09IG51bGwKICAgICAgICAgICAg\nfHwgcGouaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIGlmIChfam9pbnMgPT0gbnVsbCkKICAgICAgICAgICAgX2pvaW5zID0gbmV3\nIFNlbGVjdEpvaW5zKHRoaXMpOwoKICAgICAgICBib29sZWFuIGFkZCA9IHRy\ndWU7CiAgICAgICAgaWYgKF9qb2lucy5qb2lucygpID09IG51bGwpIHsKICAg\nICAgICAgICAgX2pvaW5zLnNldEpvaW5zKHBqLmpvaW5zKCkpOwogICAgICAg\nICAgICBhZGQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIEpvaW4gam9p\nbjsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHBqLmpvaW5zKCkuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgam9pbiA9\nIChKb2luKSBpdHIubmV4dCgpOwogICAgICAgICAgICBpZiAoam9pbi5nZXRU\neXBlKCkgPT0gSm9pbi5UWVBFX0lOTkVSKSB7CiAgICAgICAgICAgICAgICBp\nZiAoam9pbi5nZXRGb3JlaWduS2V5KCkgIT0gbnVsbAogICAgICAgICAgICAg\nICAgICAgICYmICFfZGljdC5jYW5PdXRlckpvaW4oX2pvaW5TeW50YXgsIGpv\naW4uZ2V0Rm9yZWlnbktleSgpKSkgewogICAgICAgICAgICAgICAgICAgIExv\nZyBsb2cgPSBfY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX0pE\nQkMpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgiY2FudC1vdXRlci1mayIsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBqb2luLmdldEZvcmVpZ25LZXkoKSkpOwogICAgICAgICAgICAgICAgfSBl\nbHNlCiAgICAgICAgICAgICAgICAgICAgam9pbi5zZXRUeXBlKEpvaW4uVFlQ\nRV9PVVRFUik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFkZCkK\nICAgICAgICAgICAgICAgIF9qb2lucy5qb2lucygpLmFkZChqb2luKTsKICAg\nICAgICB9CiAgICAgICAgcGoubnVsbEpvaW5zKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIGFsaWFzIGZvciB0aGUgZ2l2ZW4gdGFibGUg\ndW5kZXIgdGhlIGdpdmVuIGpvaW5zLgogICAgICogTk9URTogV0UgUkVMWSBP\nTiBUSEVTRSBJTkRFWEVTIEJFSU5HIE1PTk9UT05JQ0FMTFkgSU5DUkVBU0lO\nRyBGUk9NIDAKICAgICAqLwogICAgcHJpdmF0ZSBpbnQgZ2V0VGFibGVJbmRl\neChUYWJsZSB0YWJsZSwgUGF0aEpvaW5zIHBqLCBib29sZWFuIGNyZWF0ZSkg\newogICAgICAgIC8vIGlmIHdlIGhhdmUgYSBmcm9tIHNlbGVjdCwgdGhlbiB0\naGVyZSBhcmUgbm8gdGFibGUgYWxpYXNlcwogICAgICAgIGlmIChfZnJvbSAh\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gLTE7CgogICAgICAgIE9iamVj\ndCBrZXkgPSB0YWJsZS5nZXRGdWxsTmFtZSgpOwogICAgICAgIGlmIChwaiAh\nPSBudWxsICYmIHBqLnBhdGgoKSAhPSBudWxsKQogICAgICAgICAgICBrZXkg\nPSBuZXcgS2V5KHBqLnBhdGgoKS50b1N0cmluZygpLCBrZXkpOwoKICAgICAg\nICAvLyBjaGVjayBvdXQgZXhpc3RpbmcgYWxpYXNlcwogICAgICAgIEludGVn\nZXIgaSA9IGZpbmRBbGlhcyh0YWJsZSwga2V5LCBmYWxzZSwgbnVsbCk7CiAg\nICAgICAgaWYgKGkgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGkuaW50\nVmFsdWUoKTsKICAgICAgICBpZiAoIWNyZWF0ZSkKICAgICAgICAgICAgcmV0\ndXJuIC0xOwoKICAgICAgICAvLyBub3QgZm91bmQ7IGNyZWF0ZSBhbGlhcwog\nICAgICAgIGkgPSBOdW1iZXJzLnZhbHVlT2YoYWxpYXNTaXplKCkpOwogICAg\nICAgIHJlY29yZFRhYmxlQWxpYXModGFibGUsIGtleSwgaSk7CiAgICAgICAg\ncmV0dXJuIGkuaW50VmFsdWUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEF0\ndGVtcHQgdG8gZmluZCB0aGUgYWxpYXMgZm9yIHRoZSBnaXZlbiBrZXkuCiAg\nICAgKgogICAgICogQHBhcmFtIGZyb21QYXJlbnQgd2hldGhlciBhIHBhcmVu\ndCBpcyBjaGVja2luZyBpdHMgc3Vic2VsZWN0cwogICAgICogQHBhcmFtIGZy\nb21TdWIgdGhlIHN1YnNlbGVjdCBjaGVja2luZyBpdHMgcGFyZW50CiAgICAg\nKi8KICAgIHByaXZhdGUgSW50ZWdlciBmaW5kQWxpYXMoVGFibGUgdGFibGUs\nIE9iamVjdCBrZXksIGJvb2xlYW4gZnJvbVBhcmVudCwKICAgICAgICBTZWxl\nY3RJbXBsIGZyb21TdWIpIHsKICAgICAgICBJbnRlZ2VyIGFsaWFzID0gbnVs\nbDsKICAgICAgICBpZiAoX2FsaWFzZXMgIT0gbnVsbCkgewogICAgICAgICAg\nICBhbGlhcyA9IChJbnRlZ2VyKSAoKGZyb21QYXJlbnQpID8gX2FsaWFzZXMu\ncmVtb3ZlKGtleSkKICAgICAgICAgICAgICAgIDogX2FsaWFzZXMuZ2V0KGtl\neSkpOwogICAgICAgICAgICBpZiAoYWxpYXMgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgaWYgKGZyb21QYXJlbnQpCiAgICAgICAgICAgICAgICAgICAg\nX3RhYmxlcy5yZW1vdmUoYWxpYXMpOwogICAgICAgICAgICAgICAgcmV0dXJu\nIGFsaWFzOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICgh\nZnJvbVBhcmVudCAmJiBfcGFyZW50ICE9IG51bGwpIHsKICAgICAgICAgICAg\nYWxpYXMgPSBfcGFyZW50LmZpbmRBbGlhcyh0YWJsZSwga2V5LCBmYWxzZSwg\ndGhpcyk7CiAgICAgICAgICAgIGlmIChhbGlhcyAhPSBudWxsKQogICAgICAg\nICAgICAgICAgcmV0dXJuIGFsaWFzOwogICAgICAgIH0KICAgICAgICBpZiAo\nX3N1YnNlbHMgIT0gbnVsbCkgewogICAgICAgICAgICBTZWxlY3RJbXBsIHN1\nYjsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfc3Vic2Vscy5z\naXplKCk7IGkrKykgewogICAgICAgICAgICAgICAgc3ViID0gKFNlbGVjdElt\ncGwpIF9zdWJzZWxzLmdldChpKTsKICAgICAgICAgICAgICAgIGlmIChzdWIg\nPT0gZnJvbVN1YikKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAg\nICAgICAgICAgICAgIGlmIChhbGlhcyAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHN1Yi5fYWxpYXNlcyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgICAgICAgICBzdWIuX2FsaWFzZXMucmVtb3ZlKGtleSk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKHN1Yi5fdGFibGVzICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgICAgIHN1Yi5fdGFibGVzLnJlbW92ZShhbGlhcyk7\nCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIGFsaWFzID0gc3ViLmZpbmRBbGlhcyh0YWJsZSwga2V5LCB0cnVlLCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWZyb21QYXJlbnQgJiYgYWxp\nYXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkVGFi\nbGVBbGlhcyh0YWJsZSwga2V5LCBhbGlhcyk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFsaWFz\nOwogICAgfQoKICAgIC8qKgogICAgICogUmVjb3JkIHRoZSBtYXBwaW5nIG9m\nIHRoZSBnaXZlbiBrZXkgdG8gdGhlIGdpdmVuIGFsaWFzLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgcmVjb3JkVGFibGVBbGlhcyhUYWJsZSB0YWJsZSwg\nT2JqZWN0IGtleSwgSW50ZWdlciBhbGlhcykgewogICAgICAgIGlmIChfYWxp\nYXNlcyA9PSBudWxsKQogICAgICAgICAgICBfYWxpYXNlcyA9IG5ldyBIYXNo\nTWFwKCk7CiAgICAgICAgX2FsaWFzZXMucHV0KGtleSwgYWxpYXMpOwoKICAg\nICAgICBTdHJpbmcgdGFibGVTdHJpbmcgPSBfZGljdC5nZXRGdWxsTmFtZSh0\nYWJsZSwgZmFsc2UpICsgIiAiCiAgICAgICAgICAgICsgdG9BbGlhcyhhbGlh\ncy5pbnRWYWx1ZSgpKTsKICAgICAgICBpZiAoX3RhYmxlcyA9PSBudWxsKQog\nICAgICAgICAgICBfdGFibGVzID0gbmV3IFRyZWVNYXAoKTsKICAgICAgICBf\ndGFibGVzLnB1dChhbGlhcywgdGFibGVTdHJpbmcpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2FsY3VsYXRlIHRvdGFsIG51bWJlciBvZiBhbGlhc2VzLgog\nICAgICovCiAgICBwcml2YXRlIGludCBhbGlhc1NpemUoKSB7CiAgICAgICAg\ncmV0dXJuIGFsaWFzU2l6ZShmYWxzZSwgbnVsbCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDYWxjdWxhdGUgdG90YWwgbnVtYmVyIG9mIGFsaWFzZXMuCiAg\nICAgKgogICAgICogQHBhcmFtIGZyb21QYXJlbnQgd2hldGhlciBhIHBhcmVu\ndCBpcyBjaGVja2luZyBpdHMgc3Vic2VsZWN0cwogICAgICogQHBhcmFtIGZy\nb21TdWIgdGhlIHN1YnNlbGVjdCBjaGVja2luZyBpdHMgcGFyZW50CiAgICAg\nKi8KICAgIHByaXZhdGUgaW50IGFsaWFzU2l6ZShib29sZWFuIGZyb21QYXJl\nbnQsIFNlbGVjdEltcGwgZnJvbVN1YikgewogICAgICAgIGludCBhbGlhc2Vz\nID0gKGZyb21QYXJlbnQgfHwgX3BhcmVudCA9PSBudWxsKSA/IDAKICAgICAg\nICAgICAgOiBfcGFyZW50LmFsaWFzU2l6ZShmYWxzZSwgdGhpcyk7CiAgICAg\nICAgYWxpYXNlcyArPSAoX2FsaWFzZXMgPT0gbnVsbCkgPyAwIDogX2FsaWFz\nZXMuc2l6ZSgpOwogICAgICAgIGlmIChfc3Vic2VscyAhPSBudWxsKSB7CiAg\nICAgICAgICAgIFNlbGVjdEltcGwgc3ViOwogICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9zdWJzZWxzLnNpemUoKTsgaSsrKSB7CiAgICAgICAg\nICAgICAgICBzdWIgPSAoU2VsZWN0SW1wbCkgX3N1YnNlbHMuZ2V0KGkpOwog\nICAgICAgICAgICAgICAgaWYgKHN1YiAhPSBmcm9tU3ViKQogICAgICAgICAg\nICAgICAgICAgIGFsaWFzZXMgKz0gc3ViLmFsaWFzU2l6ZSh0cnVlLCBudWxs\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gYWxp\nYXNlczsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewog\nICAgICAgIHJldHVybiB0b1NlbGVjdChmYWxzZSwgbnVsbCkuZ2V0U1FMKCk7\nCiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAg\nLy8gUGF0aEpvaW5zIGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIGJvb2xlYW4gaXNPdXRlcigp\nIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVibGljIFBh\ndGhKb2lucyBzZXRPdXRlcihib29sZWFuIG91dGVyKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBTZWxlY3RKb2lucyh0aGlzKS5zZXRPdXRlcih0cnVlKTsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RpcnR5KCkgewogICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nQnVmZmVyIHBh\ndGgoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcHVibGlj\nIEpvaW5TZXQgam9pbnMoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9\nCgogICAgcHVibGljIGludCBqb2luQ291bnQoKSB7CiAgICAgICAgcmV0dXJu\nIDA7CiAgICB9CgogICAgcHVibGljIHZvaWQgbnVsbEpvaW5zKCkgewogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGlzRW1wdHkoKSB7CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGNyb3NzSm9pbihU\nYWJsZSBsb2NhbFRhYmxlLCBUYWJsZSBmb3JlaWduVGFibGUpIHsKICAgICAg\nICByZXR1cm4gbmV3IFNlbGVjdEpvaW5zKHRoaXMpLmNyb3NzSm9pbihsb2Nh\nbFRhYmxlLCBmb3JlaWduVGFibGUpOwogICAgfQoKICAgIHB1YmxpYyBKb2lu\ncyBqb2luKEZvcmVpZ25LZXkgZmssIGJvb2xlYW4gaW52ZXJzZSwgYm9vbGVh\nbiB0b01hbnkpIHsKICAgICAgICByZXR1cm4gbmV3IFNlbGVjdEpvaW5zKHRo\naXMpLmpvaW4oZmssIGludmVyc2UsIHRvTWFueSk7CiAgICB9CgogICAgcHVi\nbGljIEpvaW5zIG91dGVySm9pbihGb3JlaWduS2V5IGZrLCBib29sZWFuIGlu\ndmVyc2UsIGJvb2xlYW4gdG9NYW55KSB7CiAgICAgICAgcmV0dXJuIG5ldyBT\nZWxlY3RKb2lucyh0aGlzKS5vdXRlckpvaW4oZmssIGludmVyc2UsIHRvTWFu\neSk7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGpvaW5SZWxhdGlvbihTdHJp\nbmcgbmFtZSwgRm9yZWlnbktleSBmaywgQ2xhc3NNYXBwaW5nIHRhcmdldCwK\nICAgICAgICBpbnQgc3VicywgYm9vbGVhbiBpbnZlcnNlLCBib29sZWFuIHRv\nTWFueSkgewogICAgICAgIHJldHVybiBuZXcgU2VsZWN0Sm9pbnModGhpcyku\nam9pblJlbGF0aW9uKG5hbWUsIGZrLCB0YXJnZXQsIHN1YnMsIAogICAgICAg\nICAgICBpbnZlcnNlLCB0b01hbnkpOwogICAgfQoKICAgIHB1YmxpYyBKb2lu\ncyBvdXRlckpvaW5SZWxhdGlvbihTdHJpbmcgbmFtZSwgRm9yZWlnbktleSBm\naywgCiAgICAgICAgQ2xhc3NNYXBwaW5nIHRhcmdldCwgaW50IHN1YnMsIGJv\nb2xlYW4gaW52ZXJzZSwgYm9vbGVhbiB0b01hbnkpIHsKICAgICAgICByZXR1\ncm4gbmV3IFNlbGVjdEpvaW5zKHRoaXMpLm91dGVySm9pblJlbGF0aW9uKG5h\nbWUsIGZrLCB0YXJnZXQsIHN1YnMsIAogICAgICAgICAgICBpbnZlcnNlLCB0\nb01hbnkpOwogICAgfQoKICAgIHB1YmxpYyBKb2lucyBzZXRWYXJpYWJsZShT\ndHJpbmcgdmFyKSB7CiAgICAgICAgaWYgKHZhciA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gdGhpczsKICAgICAgICByZXR1cm4gbmV3IFNlbGVjdEpv\naW5zKHRoaXMpLnNldFZhcmlhYmxlKHZhcik7CiAgICB9CgogICAgcHVibGlj\nIEpvaW5zIHNldFN1YnNlbGVjdChTdHJpbmcgYWxpYXMpIHsKICAgICAgICBp\nZiAoYWxpYXMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICAgICAgcmV0dXJuIG5ldyBTZWxlY3RKb2lucyh0aGlzKS5zZXRTdWJzZWxl\nY3QoYWxpYXMpOwogICAgfQoKICAgIC8qKgogICAgICogUmVwcmVzZW50cyBh\nIFNRTCBzdHJpbmcgc2VsZWN0ZWQgd2l0aCBudWxsIGlkLgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBjbGFzcyBOdWxsSWQgewogICAgfQoKICAgIC8q\nKgogICAgICogUmVwcmVzZW50cyBhIHBsYWNlaG9sZGVyIFNRTCBzdHJpbmcu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFBsYWNlaG9sZGVy\nIHsKICAgIH0KCiAgICAvKioKICAgICAqIEtleSB0eXBlIHVzZWQgZm9yIGFs\naWFzZXMuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIEtleSB7\nCgogICAgICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIF9wYXRoOwogICAgICAg\nIHByaXZhdGUgZmluYWwgT2JqZWN0IF9rZXk7CgogICAgICAgIHB1YmxpYyBL\nZXkoU3RyaW5nIHBhdGgsIE9iamVjdCBrZXkpIHsKICAgICAgICAgICAgX3Bh\ndGggPSBwYXRoOwogICAgICAgICAgICBfa2V5ID0ga2V5OwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICAgICAg\ncmV0dXJuIF9wYXRoLmhhc2hDb2RlKCkgXiBfa2V5Lmhhc2hDb2RlKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0\nIG90aGVyKSB7CiAgICAgICAgICAgIGlmIChvdGhlciA9PSB0aGlzKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmIChvdGhl\nci5nZXRDbGFzcygpICE9IGdldENsYXNzKCkpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIEtleSBrID0gKEtleSkgb3RoZXI7\nCiAgICAgICAgICAgIHJldHVybiBrLl9wYXRoLmVxdWFscyhfcGF0aCkgJiYg\nay5fa2V5LmVxdWFscyhfa2V5KTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBfcGF0\naCArICJ8IiArIF9rZXk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQSB7QGxpbmsgUmVzdWx0fSBpbXBsZW1lbnRhdGlvbiB3cmFwcGVkIGFy\nb3VuZCB0aGlzIHNlbGVjdC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBj\nbGFzcyBTZWxlY3RSZXN1bHQKICAgICAgICBleHRlbmRzIFJlc3VsdFNldFJl\nc3VsdAogICAgICAgIGltcGxlbWVudHMgUGF0aEpvaW5zIHsKCiAgICAgICAg\ncHJpdmF0ZSBTZWxlY3RJbXBsIF9zZWwgPSBudWxsOwoKICAgICAgICAvLyBw\nb3NpdGlvbiBpbiBzZWxlY3RlZCBjb2x1bW5zIGxpc3Qgd2hlcmUgd2UgZXhw\nZWN0IHRoZSBuZXh0IGxvYWQKICAgICAgICBwcml2YXRlIGludCBfcG9zID0g\nMDsKICAgICAgICBwcml2YXRlIFN0YWNrIF9wcmVKb2lucyA9IG51bGw7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVjdG9yLgogICAgICAgICAq\nLwogICAgICAgIHB1YmxpYyBTZWxlY3RSZXN1bHQoQ29ubmVjdGlvbiBjb25u\nLCBTdGF0ZW1lbnQgc3RtbnQsIFJlc3VsdFNldCBycywKICAgICAgICAgICAg\nREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICAgICAgc3VwZXIoY29ubiwg\nc3RtbnQsIHJzLCBkaWN0KTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAg\nICAgICAqIFNlbGVjdCBmb3IgdGhpcyByZXN1bHQuCiAgICAgICAgICovCiAg\nICAgICAgcHVibGljIFNlbGVjdEltcGwgZ2V0U2VsZWN0KCkgewogICAgICAg\nICAgICByZXR1cm4gX3NlbDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAg\nICAgICAqIFNlbGVjdCBmb3IgdGhpcyByZXN1bHQuCiAgICAgICAgICovCiAg\nICAgICAgcHVibGljIHZvaWQgc2V0U2VsZWN0KFNlbGVjdEltcGwgc2VsKSB7\nCiAgICAgICAgICAgIF9zZWwgPSBzZWw7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgT2JqZWN0IGdldEVhZ2VyKEZpZWxkTWFwcGluZyBrZXkpIHsKICAg\nICAgICAgICAgLy8gZG9uJ3QgYm90aGVyIGNyZWF0aW5nIGtleSBpZiB3ZSBr\nbm93IHdlIGRvbid0IGhhdmUgYW55CiAgICAgICAgICAgIC8vIGVhZ2VyIHJl\nc3VsdHMKICAgICAgICAgICAgaWYgKF9zZWwuX2VhZ2VyID09IG51bGwgfHwg\nIV9zZWwuX2VhZ2VyS2V5cy5jb250YWlucyhrZXkpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIE1hcCBtYXAgPSBTZWxlY3RS\nZXN1bHQudGhpcy5nZXRFYWdlck1hcCh0cnVlKTsKICAgICAgICAgICAgaWYg\nKG1hcCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgICAgIHJldHVybiBtYXAuZ2V0KF9zZWwudG9FYWdlcktleShrZXks\nIGdldEpvaW5zKG51bGwpKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBwdXRFYWdlcihGaWVsZE1hcHBpbmcga2V5LCBPYmplY3QgcmVzKSB7\nCiAgICAgICAgICAgIE1hcCBtYXAgPSBTZWxlY3RSZXN1bHQudGhpcy5nZXRF\nYWdlck1hcCh0cnVlKTsKICAgICAgICAgICAgaWYgKG1hcCA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBtYXAgPSBuZXcgSGFzaE1hcCgpOwogICAgICAg\nICAgICAgICAgc2V0RWFnZXJNYXAobWFwKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBtYXAucHV0KF9zZWwudG9FYWdlcktleShrZXksIGdldEpvaW5z\nKG51bGwpKSwgcmVzKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmpl\nY3QgbG9hZChDbGFzc01hcHBpbmcgbWFwcGluZywgSkRCQ1N0b3JlIHN0b3Jl\nLAogICAgICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBK\nb2lucyBqb2lucykKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIGJvb2xlYW4gaGFzSm9pbnMgPSBqb2lucyAhPSBudWxs\nCiAgICAgICAgICAgICAgICAmJiAoKFBhdGhKb2lucykgam9pbnMpLnBhdGgo\nKSAhPSBudWxsOwogICAgICAgICAgICBpZiAoaGFzSm9pbnMpIHsKICAgICAg\nICAgICAgICAgIGlmIChfcHJlSm9pbnMgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICBfcHJlSm9pbnMgPSBuZXcgU3RhY2soKTsKICAgICAgICAgICAg\nICAgIF9wcmVKb2lucy5wdXNoKGpvaW5zKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgT2JqZWN0IG9iaiA9IHN1cGVyLmxvYWQobWFwcGluZywgc3Rv\ncmUsIGZldGNoLCBqb2lucyk7CgogICAgICAgICAgICAvLyByZXNldAogICAg\nICAgICAgICBpZiAoaGFzSm9pbnMpCiAgICAgICAgICAgICAgICBfcHJlSm9p\nbnMucG9wKCk7CiAgICAgICAgICAgIHJldHVybiBvYmo7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgSm9pbnMgbmV3Sm9pbnMoKSB7CiAgICAgICAgICAg\nIFBhdGhKb2lucyBwcmUgPSBnZXRQcmVKb2lucygpOwogICAgICAgICAgICBp\nZiAocHJlID09IG51bGwgfHwgcHJlLnBhdGgoKSA9PSBudWxsKQogICAgICAg\nICAgICAgICAgcmV0dXJuIHRoaXM7CgogICAgICAgICAgICBQYXRoSm9pbnNJ\nbXBsIHBqID0gbmV3IFBhdGhKb2luc0ltcGwoKTsKICAgICAgICAgICAgcGou\ncGF0aCA9IG5ldyBTdHJpbmdCdWZmZXIocHJlLnBhdGgoKS50b1N0cmluZygp\nKTsKICAgICAgICAgICAgcmV0dXJuIHBqOwogICAgICAgIH0KCiAgICAgICAg\ncHJvdGVjdGVkIGJvb2xlYW4gY29udGFpbnNJbnRlcm5hbChPYmplY3Qgb2Jq\nLCBKb2lucyBqb2lucykgewogICAgICAgICAgICAvLyB3ZSBrZXkgZGlyZWN0\nbHkgb24gb2JqcyBhbmQgam9pbi1sZXNzIGNvbHMsIG9yIG9uIHRoZSBhbGlh\ncwogICAgICAgICAgICAvLyBmb3IgY29scyB3aXRoIGpvaW5zCiAgICAgICAg\nICAgIFBhdGhKb2lucyBwaiA9IGdldEpvaW5zKGpvaW5zKTsKICAgICAgICAg\nICAgaWYgKHBqICE9IG51bGwgJiYgcGoucGF0aCgpICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBvYmogPSBnZXRDb2x1bW5BbGlhcygoQ29sdW1uKSBvYmos\nIHBqKTsKICAgICAgICAgICAgcmV0dXJuIG9iaiAhPSBudWxsICYmIF9zZWwu\nX3NlbGVjdHMuY29udGFpbnMob2JqKTsKICAgICAgICB9CgogICAgICAgIHBy\nb3RlY3RlZCBib29sZWFuIGNvbnRhaW5zQWxsSW50ZXJuYWwoT2JqZWN0W10g\nb2JqcywgSm9pbnMgam9pbnMpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICBQYXRoSm9pbnMgcGogPSBnZXRKb2lucyhq\nb2lucyk7CiAgICAgICAgICAgIE9iamVjdCBvYmo7CiAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgb2Jqcy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICAgICAgaWYgKHBqICE9IG51bGwgJiYgcGoucGF0aCgpICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgb2JqID0gZ2V0Q29sdW1uQWxpYXMoKENv\nbHVtbikgb2Jqc1tpXSwgcGopOwogICAgICAgICAgICAgICAgZWxzZQogICAg\nICAgICAgICAgICAgICAgIG9iaiA9IG9ianNbaV07CiAgICAgICAgICAgICAg\nICBpZiAob2JqID09IG51bGwgfHwgIV9zZWwuX3NlbGVjdHMuY29udGFpbnMo\nb2JqKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBwdXNoQmFjaygpCiAgICAgICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBfcG9zID0gMDsKICAg\nICAgICAgICAgc3VwZXIucHVzaEJhY2soKTsKICAgICAgICB9CgogICAgICAg\nIHByb3RlY3RlZCBib29sZWFuIGFic29sdXRlSW50ZXJuYWwoaW50IHJvdykK\nICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIF9wb3MgPSAwOwogICAgICAgICAgICByZXR1cm4gc3VwZXIuYWJzb2x1dGVJ\nbnRlcm5hbChyb3cpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIGJv\nb2xlYW4gbmV4dEludGVybmFsKCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIF9wb3MgPSAwOwogICAgICAgICAgICBy\nZXR1cm4gc3VwZXIubmV4dEludGVybmFsKCk7CiAgICAgICAgfQoKICAgICAg\nICBwcm90ZWN0ZWQgaW50IGZpbmRPYmplY3QoT2JqZWN0IG9iaiwgSm9pbnMg\nam9pbnMpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICBpZiAoX3BvcyA9PSBfc2VsLl9zZWxlY3RzLnNpemUoKSkKICAg\nICAgICAgICAgICAgIF9wb3MgPSAwOwoKICAgICAgICAgICAgLy8gd2Uga2V5\nIGRpcmVjdGx5IG9uIG9ianMgYW5kIGpvaW4tbGVzcyBjb2xzLCBvciBvbiB0\naGUgYWxpYXMKICAgICAgICAgICAgLy8gZm9yIGNvbHMgd2l0aCBqb2lucwog\nICAgICAgICAgICBQYXRoSm9pbnMgcGogPSBnZXRKb2lucyhqb2lucyk7CiAg\nICAgICAgICAgIEJvb2xlYW4gcGsgPSBudWxsOwogICAgICAgICAgICBpZiAo\ncGogIT0gbnVsbCAmJiBwai5wYXRoKCkgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgQ29sdW1uIGNvbCA9IChDb2x1bW4pIG9iajsKICAgICAgICAgICAg\nICAgIHBrID0gKGNvbC5pc1ByaW1hcnlLZXkoKSkgPyBCb29sZWFuLlRSVUUg\nOiBCb29sZWFuLkZBTFNFOwogICAgICAgICAgICAgICAgb2JqID0gZ2V0Q29s\ndW1uQWxpYXMoY29sLCBwaik7CiAgICAgICAgICAgICAgICBpZiAob2JqID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2Vw\ndGlvbihjb2wuZ2V0VGFibGUoKSArICI6ICIKICAgICAgICAgICAgICAgICAg\nICAgICAgKyBwai5wYXRoKCkgKyAiICgiICsgX3NlbC5fYWxpYXNlcyArICIp\nIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHdlIGxvYWQgaW4g\ndGhlIHNhbWUgb3JkZXIgd2Ugc2VsZWN0LCBtb3JlIG9yIGxlc3MuLi4KICAg\nICAgICAgICAgaWYgKF9zZWwuX3NlbGVjdHMuZ2V0KF9wb3MpLmVxdWFscyhv\nYmopKQogICAgICAgICAgICAgICAgcmV0dXJuICsrX3BvczsKCiAgICAgICAg\nICAgIC8vIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIGEgcHJpbWFyeSBrZXksIHRy\neSBiYWNrIGEgY291cGxlIHBsYWNlcywKICAgICAgICAgICAgLy8gc2luY2Ug\ncGtzIG1pZ2h0IGJlIHNlbGVjdGVkIGluIGEgc2xpZ2h0bHkgZGlmZmVyZW50\nIG9yZGVyIHRoYW4KICAgICAgICAgICAgLy8gdGhleSBhcmUgbG9hZGVkIGJh\nY2s7IGRvbid0IGNoYW5nZSB0aGUgbWFya2VyIHBvc2l0aW9uCiAgICAgICAg\nICAgIGlmIChwayA9PSBudWxsKQogICAgICAgICAgICAgICAgcGsgPSAob2Jq\nIGluc3RhbmNlb2YgQ29sdW1uICYmICgoQ29sdW1uKSBvYmopLmlzUHJpbWFy\neUtleSgpKQogICAgICAgICAgICAgICAgICAgID8gQm9vbGVhbi5UUlVFIDog\nQm9vbGVhbi5GQUxTRTsKICAgICAgICAgICAgaWYgKHBrLmJvb2xlYW5WYWx1\nZSgpKSB7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gX3BvcyAtIDE7\nIGkgPj0gMCAmJiBpID49IF9wb3MgLSAzOyBpLS0pCiAgICAgICAgICAgICAg\nICAgICAgaWYgKF9zZWwuX3NlbGVjdHMuZ2V0KGkpLmVxdWFscyhvYmopKQog\nICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSArIDE7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIC8vIHNlYXJjaCBmb3J3YXJkIG9uIHRoZSBh\nc3N1bXB0aW9uIHRoYXQgd2UgbWlnaHQgYmUgc2tpcHBpbmcKICAgICAgICAg\nICAgLy8gc2VsZWN0cyBmb3Igc2libGluZyBjbGFzc2VzOyBhZHZhbmNlIHRo\nZSBwb3NpdGlvbiBpZiB3ZSBmaW5kCiAgICAgICAgICAgIC8vIHNvbWV0aGlu\nZyBmb3J3YXJkCiAgICAgICAgICAgIGZvciAoaW50IGkgPSBfcG9zICsgMTsg\naSA8IF9zZWwuX3NlbGVjdHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAg\nICAgIGlmIChfc2VsLl9zZWxlY3RzLmdldChpKS5lcXVhbHMob2JqKSkgewog\nICAgICAgICAgICAgICAgICAgIF9wb3MgPSBpOwogICAgICAgICAgICAgICAg\nICAgIHJldHVybiArK19wb3M7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIC8vIG1heWJlIHRoZSBjb2x1bW4gd2FzIHNl\nbGVjdGVkIGJ5IDIgZGlmZmVyZW50IG1hcHBpbmdzLCBzbyBpdCdzCiAgICAg\nICAgICAgIC8vIHNvbWV3aGVyZSBwcmlvciB0byB0aGUgY3VycmVudCBwb3Np\ndGlvbjsgaW4gdGhpcyBjYXNlIGxlYXZlIHRoZQogICAgICAgICAgICAvLyBw\nb3NpdGlvbiBtYXJrZXIgYXQgaXRzIGN1cnJlbnQgcGxhY2UgY2F1c2Ugc3Vi\nc2VxdWVudCBsb2FkcyB3aWxsCiAgICAgICAgICAgIC8vIHN0aWxsIHByb2Jh\nYmx5IHN0YXJ0IGZyb20gdGhlcmUKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfcG9zOyBpKyspCiAgICAgICAgICAgICAgICBpZiAoX3NlbC5f\nc2VsZWN0cy5nZXQoaSkuZXF1YWxzKG9iaikpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIGkgKyAxOwoKICAgICAgICAgICAgLy8gc29tZXRoaW5ncydz\nIHdyb25nLi4uCiAgICAgICAgICAgIHRocm93IG5ldyBTUUxFeGNlcHRpb24o\nb2JqLnRvU3RyaW5nKCkpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAg\nICAgICogUmV0dXJuIHRoZSBqb2lucyB0byB1c2UgdG8gZmluZCBjb2x1bW4g\nZGF0YS4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIFBhdGhKb2lucyBn\nZXRKb2lucyhKb2lucyBqb2lucykgewogICAgICAgICAgICBQYXRoSm9pbnMg\ncGogPSAoUGF0aEpvaW5zKSBqb2luczsKICAgICAgICAgICAgaWYgKHBqICE9\nIG51bGwgJiYgcGoucGF0aCgpICE9IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gcGo7CiAgICAgICAgICAgIHJldHVybiBnZXRQcmVKb2lucygpOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmV0dXJuIHRoZSBw\ncmUgam9pbnMgZm9yIHRoZSByZXN1bHQsIG9yIG51bGwgaWYgbm9uZS4gTm90\nZSB0aGF0CiAgICAgICAgICogd2UgaGF2ZSB0byB0YWtlIHRoZSBTZWxlY3Qn\ncyBwcmUgam9pbnMgaW50byBhY2NvdW50IHRvbywgc2luY2UKICAgICAgICAg\nKiBiYXRjaGVkIHNlbGVjdHMgY2FuIGhhdmUgYWRkaXRpb25hbCBwcmUgam9p\nbnMgb24gdGhlIHN0YWNrIGV2ZW4KICAgICAgICAgKiBvbiBleGVjdXRpb24u\nCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBQYXRoSm9pbnMgZ2V0UHJl\nSm9pbnMoKSB7CiAgICAgICAgICAgIGlmIChfcHJlSm9pbnMgIT0gbnVsbCAm\nJiAhX3ByZUpvaW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIHJldHVy\nbiAoUGF0aEpvaW5zKSBfcHJlSm9pbnMucGVlaygpOwogICAgICAgICAgICBp\nZiAoX3NlbC5fcHJlSm9pbnMgIT0gbnVsbCAmJiAhX3NlbC5fcHJlSm9pbnMu\naXNFbXB0eSgpKQogICAgICAgICAgICAgICAgcmV0dXJuIChQYXRoSm9pbnMp\nIF9zZWwuX3ByZUpvaW5zLnBlZWsoKTsKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4g\ndGhlIGFsaWFzIHVzZWQgdG8ga2V5IG9uIHRoZSBjb2x1bW4gZGF0YSwgY29u\nc2lkZXJpbmcgdGhlCiAgICAgICAgICogZ2l2ZW4gam9pbnMuCiAgICAgICAg\nICovCiAgICAgICAgcHJpdmF0ZSBTdHJpbmcgZ2V0Q29sdW1uQWxpYXMoQ29s\ndW1uIGNvbCwgUGF0aEpvaW5zIHBqKSB7CiAgICAgICAgICAgIFN0cmluZyBh\nbGlhczsKICAgICAgICAgICAgaWYgKF9zZWwuX2Zyb20gIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgYWxpYXMgPSBfc2VsLnRvQWxpYXMoX3NlbC5fZnJv\nbS5nZXRUYWJsZUluZGV4CiAgICAgICAgICAgICAgICAgICAgKGNvbC5nZXRU\nYWJsZSgpLCBwaiwgZmFsc2UpKTsKICAgICAgICAgICAgICAgIGlmIChhbGlh\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgICAgICAgICAgaWYgKF9zZWwuX2RpY3QucmVxdWlyZXNBbGlhc0Zv\nclN1YnNlbGVjdCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRlJPTV9T\nRUxFQ1RfQUxJQVMgKyAiLiIgKyBhbGlhcyArICJfIiArIGNvbDsKICAgICAg\nICAgICAgICAgIHJldHVybiBhbGlhcyArICJfIiArIGNvbDsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBhbGlhcyA9IF9zZWwudG9BbGlhcyhfc2VsLmdl\ndFRhYmxlSW5kZXgoY29sLmdldFRhYmxlKCksIHBqLCBmYWxzZSkpOwogICAg\nICAgICAgICByZXR1cm4gKGFsaWFzID09IG51bGwpID8gbnVsbCA6IGFsaWFz\nICsgIi4iICsgY29sOwogICAgICAgIH0KCiAgICAgICAgLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLwogICAgICAgIC8vIFBhdGhKb2lucyBpbXBsZW1l\nbnRhdGlvbgogICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8K\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gaXNPdXRlcigpIHsKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFBh\ndGhKb2lucyBzZXRPdXRlcihib29sZWFuIG91dGVyKSB7CiAgICAgICAgICAg\nIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gaXNEaXJ0eSgpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZ0J1ZmZlciBwYXRoKCkgewog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBKb2luU2V0IGpvaW5zKCkgewogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgam9pbkNvdW50KCkg\newogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIG51bGxKb2lucygpIHsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBib29sZWFuIGlzRW1wdHkoKSB7CiAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5zIGNyb3NzSm9p\nbihUYWJsZSBsb2NhbFRhYmxlLCBUYWJsZSBmb3JlaWduVGFibGUpIHsKICAg\nICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgSm9pbnMgam9pbihGb3JlaWduS2V5IGZrLCBib29sZWFuIGludmVyc2Us\nIGJvb2xlYW4gdG9NYW55KSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5zIG91dGVySm9pbihGb3Jl\naWduS2V5IGZrLCBib29sZWFuIGludmVyc2UsIGJvb2xlYW4gdG9NYW55KSB7\nCiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIEpvaW5zIGpvaW5SZWxhdGlvbihTdHJpbmcgbmFtZSwgRm9yZWln\nbktleSBmaywgCiAgICAgICAgICAgIENsYXNzTWFwcGluZyB0YXJnZXQsIGlu\ndCBzdWJzLCBib29sZWFuIGludmVyc2UsIGJvb2xlYW4gdG9NYW55KSB7CiAg\nICAgICAgICAgIHJldHVybiBuZXcgUGF0aEpvaW5zSW1wbCgpLmpvaW5SZWxh\ndGlvbihuYW1lLCBmaywgdGFyZ2V0LCBzdWJzLCAKICAgICAgICAgICAgICAg\nIGludmVyc2UsIHRvTWFueSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nSm9pbnMgb3V0ZXJKb2luUmVsYXRpb24oU3RyaW5nIG5hbWUsIEZvcmVpZ25L\nZXkgZmssCiAgICAgICAgICAgIENsYXNzTWFwcGluZyB0YXJnZXQsIGludCBz\ndWJzLCBib29sZWFuIGludmVyc2UsIGJvb2xlYW4gdG9NYW55KSB7CiAgICAg\nICAgICAgIHJldHVybiBuZXcgUGF0aEpvaW5zSW1wbCgpLm91dGVySm9pblJl\nbGF0aW9uKG5hbWUsIGZrLCB0YXJnZXQsIHN1YnMsCiAgICAgICAgICAgICAg\nICBpbnZlcnNlLCB0b01hbnkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIEpvaW5zIHNldFZhcmlhYmxlKFN0cmluZyB2YXIpIHsKICAgICAgICAgICAg\naWYgKHZhciA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICAgICAgICAgIHJldHVybiBuZXcgUGF0aEpvaW5zSW1wbCgpLnNldFZh\ncmlhYmxlKHZhcik7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMg\nc2V0U3Vic2VsZWN0KFN0cmluZyBhbGlhcykgewogICAgICAgICAgICBpZiAo\nYWxpYXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwog\nICAgICAgICAgICByZXR1cm4gbmV3IFBhdGhKb2luc0ltcGwoKS5zZXRTdWJz\nZWxlY3QoYWxpYXMpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIEJhc2Ugam9pbnMgaW1wbGVtZW50YXRpb24uCiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIGNsYXNzIFBhdGhKb2luc0ltcGwKICAgICAgICBpbXBsZW1l\nbnRzIFBhdGhKb2lucyB7CgogICAgICAgIHByb3RlY3RlZCBTdHJpbmdCdWZm\nZXIgcGF0aCA9IG51bGw7CiAgICAgICAgcHJvdGVjdGVkIFN0cmluZyB2YXIg\nPSBudWxsOwoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc091dGVyKCkgewog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgUGF0aEpvaW5zIHNldE91dGVyKGJvb2xlYW4gb3V0ZXIpIHsKICAg\nICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBpc0RpcnR5KCkgewogICAgICAgICAgICByZXR1cm4gdmFy\nICE9IG51bGwgfHwgcGF0aCAhPSBudWxsOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIFN0cmluZ0J1ZmZlciBwYXRoKCkgewogICAgICAgICAgICByZXR1\ncm4gcGF0aDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2luU2V0IGpv\naW5zKCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBpbnQgam9pbkNvdW50KCkgewogICAgICAgICAgICBy\nZXR1cm4gMDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIG51bGxK\nb2lucygpIHsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBzZXRW\nYXJpYWJsZShTdHJpbmcgdmFyKSB7CiAgICAgICAgICAgIHRoaXMudmFyID0g\ndmFyOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBKb2lucyBzZXRTdWJzZWxlY3QoU3RyaW5nIGFsaWFzKSB7\nCiAgICAgICAgICAgIGlmICghYWxpYXMuZW5kc1dpdGgoIjoiKSkKICAgICAg\nICAgICAgICAgIGFsaWFzICs9ICc6JzsKICAgICAgICAgICAgYXBwZW5kKGFs\naWFzKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgYm9vbGVhbiBpc0VtcHR5KCkgewogICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBj\ncm9zc0pvaW4oVGFibGUgbG9jYWxUYWJsZSwgVGFibGUgZm9yZWlnblRhYmxl\nKSB7CiAgICAgICAgICAgIGFwcGVuZCh2YXIpOwogICAgICAgICAgICB2YXIg\nPSBudWxsOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBKb2lucyBqb2luKEZvcmVpZ25LZXkgZmssIGJvb2xl\nYW4gaW52ZXJzZSwgYm9vbGVhbiB0b01hbnkpIHsKICAgICAgICAgICAgYXBw\nZW5kKHZhcik7CiAgICAgICAgICAgIHZhciA9IG51bGw7CiAgICAgICAgICAg\nIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5z\nIG91dGVySm9pbihGb3JlaWduS2V5IGZrLCBib29sZWFuIGludmVyc2UsIGJv\nb2xlYW4gdG9NYW55KSB7CiAgICAgICAgICAgIGFwcGVuZCh2YXIpOwogICAg\nICAgICAgICB2YXIgPSBudWxsOwogICAgICAgICAgICByZXR1cm4gdGhpczsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBqb2luUmVsYXRpb24o\nU3RyaW5nIG5hbWUsIEZvcmVpZ25LZXkgZmssIAogICAgICAgICAgICBDbGFz\nc01hcHBpbmcgdGFyZ2V0LCBpbnQgc3VicywgYm9vbGVhbiBpbnZlcnNlLCBi\nb29sZWFuIHRvTWFueSkgewogICAgICAgICAgICBhcHBlbmQobmFtZSk7CiAg\nICAgICAgICAgIGFwcGVuZCh2YXIpOwogICAgICAgICAgICB2YXIgPSBudWxs\nOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBKb2lucyBvdXRlckpvaW5SZWxhdGlvbihTdHJpbmcgbmFtZSwg\nRm9yZWlnbktleSBmaywKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIHRhcmdl\ndCwgaW50IHN1YnMsIGJvb2xlYW4gaW52ZXJzZSwgYm9vbGVhbiB0b01hbnkp\nIHsKICAgICAgICAgICAgYXBwZW5kKG5hbWUpOwogICAgICAgICAgICBhcHBl\nbmQodmFyKTsKICAgICAgICAgICAgdmFyID0gbnVsbDsKICAgICAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgdm9p\nZCBhcHBlbmQoU3RyaW5nIHN0cikgewogICAgICAgICAgICBpZiAoc3RyICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChwYXRoID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgcGF0aCA9IG5ldyBTdHJpbmdCdWZmZXIoc3Ry\nKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBw\nYXRoLmFwcGVuZCgnLicpLmFwcGVuZChzdHIpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewog\nICAgICAgICAgICByZXR1cm4gIlBhdGhKb2luc0ltcGw8IiArIGhhc2hDb2Rl\nKCkgKyAiPjogIgogICAgICAgICAgICAgICAgKyBTdHJpbmcudmFsdWVPZihw\nYXRoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBKb2lucyBp\nbXBsZW1lbnRhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xh\nc3MgU2VsZWN0Sm9pbnMKICAgICAgICBleHRlbmRzIFBhdGhKb2luc0ltcGwg\nCiAgICAgICAgaW1wbGVtZW50cyBDbG9uZWFibGUgewoKICAgICAgICBwcml2\nYXRlIGZpbmFsIFNlbGVjdEltcGwgX3NlbDsKICAgICAgICBwcml2YXRlIEpv\naW5TZXQgX2pvaW5zID0gbnVsbDsKICAgICAgICBwcml2YXRlIGJvb2xlYW4g\nX291dGVyID0gZmFsc2U7CiAgICAgICAgcHJpdmF0ZSBpbnQgX2NvdW50ID0g\nMDsKCiAgICAgICAgcHVibGljIFNlbGVjdEpvaW5zKFNlbGVjdEltcGwgc2Vs\nKSB7CiAgICAgICAgICAgIF9zZWwgPSBzZWw7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBpc091dGVyKCkgewogICAgICAgICAgICByZXR1\ncm4gX291dGVyOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFBhdGhKb2lu\ncyBzZXRPdXRlcihib29sZWFuIG91dGVyKSB7CiAgICAgICAgICAgIF9vdXRl\nciA9IG91dGVyOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBib29sZWFuIGlzRGlydHkoKSB7CiAgICAgICAg\nICAgIHJldHVybiBzdXBlci5pc0RpcnR5KCkgfHwgIWlzRW1wdHkoKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBKb2luU2V0IGpvaW5zKCkgewogICAg\nICAgICAgICByZXR1cm4gX2pvaW5zOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgc2V0Sm9pbnMoSm9pblNldCBqb2lucykgewogICAgICAgICAg\nICBfam9pbnMgPSBqb2luczsKICAgICAgICAgICAgX291dGVyID0gam9pbnMg\nIT0gbnVsbCAmJiBqb2lucy5sYXN0KCkgIT0gbnVsbAogICAgICAgICAgICAg\nICAgJiYgam9pbnMubGFzdCgpLmdldFR5cGUoKSA9PSBKb2luLlRZUEVfT1VU\nRVI7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGpvaW5Db3VudCgp\nIHsKICAgICAgICAgICAgaWYgKF9qb2lucyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgcmV0dXJuIF9jb3VudDsKICAgICAgICAgICAgcmV0dXJuIE1hdGgu\nbWF4KF9jb3VudCwgX2pvaW5zLnNpemUoKSk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBudWxsSm9pbnMoKSB7CiAgICAgICAgICAgIGlmIChf\nam9pbnMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jb3VudCA9IE1hdGgu\nbWF4KF9jb3VudCwgX2pvaW5zLnNpemUoKSk7CiAgICAgICAgICAgIF9qb2lu\ncyA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBp\nc0VtcHR5KCkgewogICAgICAgICAgICByZXR1cm4gX2pvaW5zID09IG51bGwg\nfHwgX2pvaW5zLmlzRW1wdHkoKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBKb2lucyBjcm9zc0pvaW4oVGFibGUgbG9jYWxUYWJsZSwgVGFibGUgZm9y\nZWlnblRhYmxlKSB7CiAgICAgICAgICAgIC8vIGNyb3NzIGpvaW5zIGFyZSBm\nb3IgdW5ib3VuZCB2YXJpYWJsZXM7IHVuZm9ydHVuYXRlbHkgd2UgaGF2ZQog\nICAgICAgICAgICAvLyB0byBhbHdheXMgZ28gRElTVElOQ1QgZm9yIHVuYm91\nbmQgdmFycyBiZWNhdXNlIHRoZXJlIGFyZSBjZXJ0YWluCiAgICAgICAgICAg\nIC8vIGNhc2VzIHRoYXQgcmVxdWlyZSBpdCwgYW5kIHdlIGNhbid0IGRpZmZl\ncmVudGlhdGUgdGhlbSBmcm9tIHRoZQogICAgICAgICAgICAvLyBjYXNlcyB0\naGF0IGRvbid0CiAgICAgICAgICAgIF9zZWwuX2ZsYWdzIHw9IElNUExJQ0lU\nX0RJU1RJTkNUOwoKICAgICAgICAgICAgaWYgKF9zZWwuZ2V0Sm9pblN5bnRh\neCgpICE9IEpvaW5TeW50YXhlcy5TWU5UQVhfU1FMOTIKICAgICAgICAgICAg\nICAgIHx8IF9zZWwuX2Zyb20gIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nLy8gZG9uJ3QgbWFrZSBhbnkgam9pbnMsIGJ1dCB1cGRhdGUgdGhlIHBhdGgg\naWYgYSB2YXJpYWJsZQogICAgICAgICAgICAgICAgLy8gaGFzIGJlZW4gc2V0\nCiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZCh0aGlzLnZhcik7CiAgICAg\nICAgICAgICAgICB0aGlzLnZhciA9IG51bGw7CiAgICAgICAgICAgICAgICBf\nb3V0ZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBkb24ndCBsZXQgdGhlIGdl\ndCBhbGlhcyBtZXRob2RzIHNlZSB0aGF0IGEgdmFyIGhhcyBiZWVuIHNldAog\nICAgICAgICAgICAvLyB1bnRpbCB3ZSBnZXQgcGFzdCB0aGUgbG9jYWwgdGFi\nbGUKICAgICAgICAgICAgU3RyaW5nIHZhciA9IHRoaXMudmFyOwogICAgICAg\nICAgICB0aGlzLnZhciA9IG51bGw7CgogICAgICAgICAgICBpbnQgYWxpYXMx\nID0gX3NlbC5nZXRUYWJsZUluZGV4KGxvY2FsVGFibGUsIHRoaXMsIHRydWUp\nOwogICAgICAgICAgICB0aGlzLmFwcGVuZCh2YXIpOwogICAgICAgICAgICBp\nbnQgYWxpYXMyID0gX3NlbC5nZXRUYWJsZUluZGV4KGZvcmVpZ25UYWJsZSwg\ndGhpcywgdHJ1ZSk7CiAgICAgICAgICAgIEpvaW4gaiA9IG5ldyBKb2luKGxv\nY2FsVGFibGUsIGFsaWFzMSwgZm9yZWlnblRhYmxlLCBhbGlhczIsCiAgICAg\nICAgICAgICAgICBudWxsLCBmYWxzZSk7CiAgICAgICAgICAgIGouc2V0VHlw\nZShKb2luLlRZUEVfQ1JPU1MpOwoKICAgICAgICAgICAgaWYgKF9qb2lucyA9\nPSBudWxsKQogICAgICAgICAgICAgICAgX2pvaW5zID0gbmV3IEpvaW5TZXQo\nKTsKICAgICAgICAgICAgX2pvaW5zLmFkZChqKTsKICAgICAgICAgICAgX291\ndGVyID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIEpvaW5zIGpvaW4oRm9yZWlnbktleSBmaywg\nYm9vbGVhbiBpbnZlcnNlLCBib29sZWFuIHRvTWFueSkgewogICAgICAgICAg\nICByZXR1cm4gam9pbihudWxsLCBmaywgbnVsbCwgLTEsIGludmVyc2UsIHRv\nTWFueSwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5z\nIG91dGVySm9pbihGb3JlaWduS2V5IGZrLCBib29sZWFuIGludmVyc2UsIGJv\nb2xlYW4gdG9NYW55KSB7CiAgICAgICAgICAgIHJldHVybiBqb2luKG51bGws\nIGZrLCBudWxsLCAtMSwgaW52ZXJzZSwgdG9NYW55LCB0cnVlKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBqb2luUmVsYXRpb24oU3RyaW5n\nIG5hbWUsIEZvcmVpZ25LZXkgZmssIAogICAgICAgICAgICBDbGFzc01hcHBp\nbmcgdGFyZ2V0LCBpbnQgc3VicywgYm9vbGVhbiBpbnZlcnNlLCBib29sZWFu\nIHRvTWFueSkgewogICAgICAgICAgICByZXR1cm4gam9pbihuYW1lLCBmaywg\ndGFyZ2V0LCBzdWJzLCBpbnZlcnNlLCB0b01hbnksIGZhbHNlKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBvdXRlckpvaW5SZWxhdGlvbihT\ndHJpbmcgbmFtZSwgRm9yZWlnbktleSBmaywKICAgICAgICAgICAgQ2xhc3NN\nYXBwaW5nIHRhcmdldCwgaW50IHN1YnMsIGJvb2xlYW4gaW52ZXJzZSwgYm9v\nbGVhbiB0b01hbnkpIHsKICAgICAgICAgICAgcmV0dXJuIGpvaW4obmFtZSwg\nZmssIHRhcmdldCwgc3VicywgaW52ZXJzZSwgdG9NYW55LCB0cnVlKTsKICAg\nICAgICB9CgogICAgICAgIHByaXZhdGUgSm9pbnMgam9pbihTdHJpbmcgbmFt\nZSwgRm9yZWlnbktleSBmaywgQ2xhc3NNYXBwaW5nIHRhcmdldCwKICAgICAg\nICAgICAgaW50IHN1YnMsIGJvb2xlYW4gaW52ZXJzZSwgYm9vbGVhbiB0b01h\nbnksIGJvb2xlYW4gb3V0ZXIpIHsKICAgICAgICAgICAgLy8gZG9uJ3QgbGV0\nIHRoZSBnZXQgYWxpYXMgbWV0aG9kcyBzZWUgdGhhdCBhIHZhciBoYXMgYmVl\nbiBzZXQKICAgICAgICAgICAgLy8gdW50aWwgd2UgZ2V0IHBhc3QgdGhlIGxv\nY2FsIHRhYmxlCiAgICAgICAgICAgIFN0cmluZyB2YXIgPSB0aGlzLnZhcjsK\nICAgICAgICAgICAgdGhpcy52YXIgPSBudWxsOwoKICAgICAgICAgICAgLy8g\nZ2V0IGZpcnN0IHRhYmxlIGFsaWFzIGJlZm9yZSB1cGRhdGluZyBwYXRoOyBp\nZiB0aGVyZSBpcyBhIGZyb20KICAgICAgICAgICAgLy8gc2VsZWN0IHRoZW4g\nd2Ugc2hvdWxkbid0IGFjdHVhbGx5IGNyZWF0ZSBhIGpvaW4gb2JqZWN0LCBz\naW5jZQogICAgICAgICAgICAvLyB0aGUgam9pbnMgd2lsbCBhbGwgYmUgZG9u\nZSBpbiB0aGUgZnJvbSBzZWxlY3QKICAgICAgICAgICAgYm9vbGVhbiBjcmVh\ndGVKb2luID0gX3NlbC5fZnJvbSA9PSBudWxsOwogICAgICAgICAgICBUYWJs\nZSB0YWJsZTEgPSBudWxsOwogICAgICAgICAgICBpbnQgYWxpYXMxID0gLTE7\nCiAgICAgICAgICAgIGlmIChjcmVhdGVKb2luKSB7CiAgICAgICAgICAgICAg\nICB0YWJsZTEgPSAoaW52ZXJzZSkgPyBmay5nZXRQcmltYXJ5S2V5VGFibGUo\nKSA6IGZrLmdldFRhYmxlKCk7CiAgICAgICAgICAgICAgICBhbGlhczEgPSBf\nc2VsLmdldFRhYmxlSW5kZXgodGFibGUxLCB0aGlzLCB0cnVlKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIHRoZSBwYXRoIHdpdGgg\ndGhlIHJlbGF0aW9uIG5hbWUgYmVmb3JlIGdldHRpbmcgcGsgYWxpYXMKICAg\nICAgICAgICAgdGhpcy5hcHBlbmQobmFtZSk7CiAgICAgICAgICAgIHRoaXMu\nYXBwZW5kKHZhcik7CiAgICAgICAgICAgIGlmICh0b01hbnkpIHsKICAgICAg\nICAgICAgICAgIF9zZWwuX2ZsYWdzIHw9IElNUExJQ0lUX0RJU1RJTkNUOwog\nICAgICAgICAgICAgICAgX3NlbC5fZmxhZ3MgfD0gVE9fTUFOWTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBfb3V0ZXIgPSBvdXRlcjsKCiAgICAgICAg\nICAgIGlmIChjcmVhdGVKb2luKSB7CiAgICAgICAgICAgICAgICBUYWJsZSB0\nYWJsZTIgPSAoaW52ZXJzZSkgPyBmay5nZXRUYWJsZSgpIAogICAgICAgICAg\nICAgICAgICAgIDogZmsuZ2V0UHJpbWFyeUtleVRhYmxlKCk7CiAgICAgICAg\nICAgICAgICBpbnQgYWxpYXMyID0gX3NlbC5nZXRUYWJsZUluZGV4KHRhYmxl\nMiwgdGhpcywgdHJ1ZSk7CiAgICAgICAgICAgICAgICBKb2luIGogPSBuZXcg\nSm9pbih0YWJsZTEsIGFsaWFzMSwgdGFibGUyLCBhbGlhczIsIGZrLCBpbnZl\ncnNlKTsKICAgICAgICAgICAgICAgIGouc2V0VHlwZSgob3V0ZXIpID8gSm9p\nbi5UWVBFX09VVEVSIDogSm9pbi5UWVBFX0lOTkVSKTsKCiAgICAgICAgICAg\nICAgICBpZiAoX2pvaW5zID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\nX2pvaW5zID0gbmV3IEpvaW5TZXQoKTsKICAgICAgICAgICAgICAgIGlmIChf\nam9pbnMuYWRkKGopICYmIChzdWJzID09IFNlbGVjdC5TVUJTX0pPSU5BQkxF\nIAogICAgICAgICAgICAgICAgICAgIHx8IHN1YnMgPT0gU2VsZWN0LlNVQlNf\nTk9ORSkpCiAgICAgICAgICAgICAgICAgICAgai5zZXRSZWxhdGlvbih0YXJn\nZXQsIHN1YnMsIGNsb25lKF9zZWwpKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBT\nZWxlY3RKb2lucyBjbG9uZShTZWxlY3RJbXBsIHNlbCkgewogICAgICAgICAg\nICBTZWxlY3RKb2lucyBzaiA9IG5ldyBTZWxlY3RKb2lucyhzZWwpOwogICAg\nICAgICAgICBzai52YXIgPSB2YXI7CiAgICAgICAgICAgIGlmIChwYXRoICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBzai5wYXRoID0gbmV3IFN0cmluZ0J1\nZmZlcihwYXRoLnRvU3RyaW5nKCkpOwogICAgICAgICAgICBpZiAoX2pvaW5z\nICE9IG51bGwgJiYgIV9qb2lucy5pc0VtcHR5KCkpCiAgICAgICAgICAgICAg\nICBzai5fam9pbnMgPSBuZXcgSm9pblNldChfam9pbnMpOwogICAgICAgICAg\nICBzai5fb3V0ZXIgPSBfb3V0ZXI7CiAgICAgICAgICAgIHJldHVybiBzajsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7\nCiAgICAgICAgICAgIHJldHVybiBzdXBlci50b1N0cmluZygpICsgIiAoIiAr\nIF9vdXRlciArICIpOiAiICsgX2pvaW5zOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIEhlbHBlciBjbGFzcyB0byB0cmFjayBzZWxlY3RlZCBj\nb2x1bW5zLCB3aXRoIGZhc3QgY29udGFpbnMgbWV0aG9kLgogICAgICogQWN0\ncyBhcyBhIGxpc3Qgb2Ygc2VsZWN0IGlkcywgd2l0aCBhZGRpdGlvbmFsIG1l\ndGhvZHMgdG8gbWFuaXB1bGF0ZQogICAgICogdGhlIGFsaWFzIG9mIGVhY2gg\nc2VsZWN0ZWQgaWQuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNz\nIFNlbGVjdHMKICAgICAgICBleHRlbmRzIEFic3RyYWN0TGlzdCB7CgogICAg\nICAgIHByaXZhdGUgTGlzdCBfaWRzID0gbnVsbDsKICAgICAgICBwcml2YXRl\nIExpc3QgX2lkZW50cyA9IG51bGw7CiAgICAgICAgcHJpdmF0ZSBNYXAgX2Fs\naWFzZXMgPSBudWxsOwogICAgICAgIHByaXZhdGUgTWFwIF9zZWxlY3RBcyA9\nIG51bGw7CgogICAgICAgIC8qKgogICAgICAgICAqIEFkZCBhbGwgYWxpYXNl\ncyBmcm9tIGFub3RoZXIgaW5zdGFuY2UuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIHZvaWQgYWRkQWxsKFNlbGVjdHMgc2VscykgewogICAgICAgICAg\nICBpZiAoX2lkcyA9PSBudWxsICYmIHNlbHMuX2lkcyAhPSBudWxsKQogICAg\nICAgICAgICAgICAgX2lkcyA9IG5ldyBBcnJheUxpc3Qoc2Vscy5faWRzKTsK\nICAgICAgICAgICAgZWxzZSBpZiAoc2Vscy5faWRzICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBfaWRzLmFkZEFsbChzZWxzLl9pZHMpOwoKICAgICAgICAg\nICAgaWYgKF9pZGVudHMgPT0gbnVsbCAmJiBzZWxzLl9pZGVudHMgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIF9pZGVudHMgPSBuZXcgQXJyYXlMaXN0KHNl\nbHMuX2lkZW50cyk7CiAgICAgICAgICAgIGVsc2UgaWYgKHNlbHMuX2lkZW50\ncyAhPSBudWxsKQogICAgICAgICAgICAgICAgX2lkZW50cy5hZGRBbGwoc2Vs\ncy5faWRlbnRzKTsKCiAgICAgICAgICAgIGlmIChfYWxpYXNlcyA9PSBudWxs\nICYmIHNlbHMuX2FsaWFzZXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9h\nbGlhc2VzID0gbmV3IEhhc2hNYXAoc2Vscy5fYWxpYXNlcyk7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHNlbHMuX2FsaWFzZXMgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIF9hbGlhc2VzLnB1dEFsbChzZWxzLl9hbGlhc2VzKTsKCiAgICAg\nICAgICAgIGlmIChfc2VsZWN0QXMgPT0gbnVsbCAmJiBzZWxzLl9zZWxlY3RB\ncyAhPSBudWxsKQogICAgICAgICAgICAgICAgX3NlbGVjdEFzID0gbmV3IEhh\nc2hNYXAoc2Vscy5fc2VsZWN0QXMpOwogICAgICAgICAgICBlbHNlIGlmIChz\nZWxzLl9zZWxlY3RBcyAhPSBudWxsKQogICAgICAgICAgICAgICAgX3NlbGVj\ndEFzLnB1dEFsbChzZWxzLl9zZWxlY3RBcyk7CiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBSZXR1cm5zIHRoZSBhbGlhcyBvZiBhIGdpdmVu\nIGlkLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBPYmplY3QgZ2V0QWxp\nYXMoT2JqZWN0IGlkKSB7CiAgICAgICAgICAgIHJldHVybiAoX2FsaWFzZXMg\nPT0gbnVsbCkgPyBudWxsIDogX2FsaWFzZXMuZ2V0KGlkKTsKICAgICAgICB9\nCgogICAgICAgIC8qKgogICAgICAgICAqIFNldCBhbiBhbGlhcyBmb3IgYSBn\naXZlbiBpZC4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgaW50IHNldEFs\naWFzKE9iamVjdCBpZCwgT2JqZWN0IGFsaWFzLCBib29sZWFuIGlkZW50KSB7\nCiAgICAgICAgICAgIGlmIChfaWRzID09IG51bGwpIHsKICAgICAgICAgICAg\nICAgIF9pZHMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgICAgICBf\nYWxpYXNlcyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIGludCBpZHg7CiAgICAgICAgICAgIGlmIChfYWxpYXNlcy5wdXQo\naWQsIGFsaWFzKSAhPSBudWxsKQogICAgICAgICAgICAgICAgaWR4ID0gX2lk\ncy5pbmRleE9mKGlkKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAg\nICAgICBfaWRzLmFkZChpZCk7CiAgICAgICAgICAgICAgICBpZHggPSBfaWRz\nLnNpemUoKSAtIDE7CgogICAgICAgICAgICAgICAgaWYgKGlkZW50KSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKF9pZGVudHMgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICAgICAgX2lkZW50cyA9IG5ldyBBcnJheUxpc3QoMyk7\nCiAgICAgICAgICAgICAgICAgICAgX2lkZW50cy5hZGQoaWQpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBp\nZHg7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBTZXQgYW4g\nYWxpYXMgZm9yIGEgZ2l2ZW4gaW5kZXguCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIHZvaWQgc2V0QWxpYXMoaW50IGlkeCwgT2JqZWN0IGFsaWFzKSB7\nCiAgICAgICAgICAgIE9iamVjdCBpZCA9IF9pZHMuZ2V0KGlkeCk7CiAgICAg\nICAgICAgIF9hbGlhc2VzLnB1dChpZCwgYWxpYXMpOwogICAgICAgIH0KCiAg\nICAgICAgLyoqCiAgICAgICAgICogSW5zZXJ0IGFuIGFsaWFzIGJlZm9yZSB0\naGUgZ2l2ZW4gaW5kZXgsIHVzaW5nIG5lZ2F0aXZlIGluZGV4ZXMKICAgICAg\nICAgKiB0byBjb3VudCBiYWNrd2FyZHMuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIHZvaWQgaW5zZXJ0QWxpYXMoaW50IGlkeCwgT2JqZWN0IGlkLCBP\nYmplY3QgYWxpYXMpIHsKICAgICAgICAgICAgX2FsaWFzZXMucHV0KGlkLCBh\nbGlhcyk7CiAgICAgICAgICAgIGlmIChpZHggPj0gMCkKICAgICAgICAgICAg\nICAgIF9pZHMuYWRkKGlkeCwgaWQpOwogICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICBfaWRzLmFkZChfaWRzLnNpemUoKSArIGlkeCwgaWQpOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmV0dXJuIHRoZSBp\nbmRleCBvZiB0aGUgZ2l2ZW4gYWxpYXMuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIGludCBpbmRleE9mQWxpYXMoT2JqZWN0IGFsaWFzKSB7CiAgICAg\nICAgICAgIGlmIChfYWxpYXNlcyA9PSBudWxsKQogICAgICAgICAgICAgICAg\ncmV0dXJuIC0xOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9p\nZHMuc2l6ZSgpOyBpKyspCiAgICAgICAgICAgICAgICBpZiAoYWxpYXMuZXF1\nYWxzKF9hbGlhc2VzLmdldChfaWRzLmdldChpKSkpKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBpOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBBIGxpc3QgcmVwcmVzZW50\nYXRpb24gb2YgdGhlIGFsaWFzZXMsIGluIHNlbGVjdCBvcmRlciwgd2l0aAog\nICAgICAgICAqIEFTIGFsaWFzZXMgcHJlc2VudC4KICAgICAgICAgKi8KICAg\nICAgICBwdWJsaWMgTGlzdCBnZXRBbGlhc2VzKGZpbmFsIGJvb2xlYW4gaWRl\nbnQsIGZpbmFsIGJvb2xlYW4gaW5uZXIpIHsKICAgICAgICAgICAgaWYgKF9p\nZHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBDb2xsZWN0aW9u\ncy5FTVBUWV9MSVNUOwoKICAgICAgICAgICAgcmV0dXJuIG5ldyBBYnN0cmFj\ndExpc3QoKSB7CiAgICAgICAgICAgICAgICBwdWJsaWMgaW50IHNpemUoKSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpZGVudCAmJiBfaWRlbnRz\nICE9IG51bGwpID8gX2lkZW50cy5zaXplKCkKICAgICAgICAgICAgICAgICAg\nICAgICAgOiBfaWRzLnNpemUoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgICAgICBwdWJsaWMgT2JqZWN0IGdldChpbnQgaSkgewogICAgICAg\nICAgICAgICAgICAgIE9iamVjdCBpZCA9IChpZGVudCAmJiBfaWRlbnRzICE9\nIG51bGwpID8gX2lkZW50cy5nZXQoaSkKICAgICAgICAgICAgICAgICAgICAg\nICAgOiBfaWRzLmdldChpKTsKICAgICAgICAgICAgICAgICAgICBPYmplY3Qg\nYWxpYXMgPSBfYWxpYXNlcy5nZXQoaWQpOwogICAgICAgICAgICAgICAgICAg\nIFN0cmluZyBhcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYgKGlu\nbmVyKQogICAgICAgICAgICAgICAgICAgICAgICBhcyA9ICgoU3RyaW5nKSBh\nbGlhcykucmVwbGFjZSgnLicsICdfJyk7CiAgICAgICAgICAgICAgICAgICAg\nZWxzZSBpZiAoX3NlbGVjdEFzICE9IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgICAgIGFzID0gKFN0cmluZykgX3NlbGVjdEFzLmdldChpZCk7CgogICAg\nICAgICAgICAgICAgICAgIGlmIChhcyAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGlmIChpZGVudCAmJiBfaWRlbnRzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXM7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChhbGlhcyBpbnN0YW5jZW9mIFNRTEJ1ZmZl\ncikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzID0gbmV3IFNR\nTEJ1ZmZlcigoU1FMQnVmZmVyKSBhbGlhcykuCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgYXBwZW5kKCIgQVMgIikuYXBwZW5kKGFzKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgYWxpYXMgPSBhbGlhcyArICIgQVMgIiArIGFzOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWxp\nYXM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBTZXQgdGhhdCBhIGdpdmVuIGlk\nJ3MgYWxpYXMgaGFzIGFuIEFTIHZhbHVlLgogICAgICAgICAqLwogICAgICAg\nIHB1YmxpYyB2b2lkIHNldFNlbGVjdEFzKE9iamVjdCBpZCwgU3RyaW5nIGFz\nKSB7CiAgICAgICAgICAgIGlmIChfc2VsZWN0QXMgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9zZWxlY3RBcyA9IG5ldyBIYXNoTWFwKChpbnQpICg1ICog\nMS4zMyArIDEpKTsKICAgICAgICAgICAgX3NlbGVjdEFzLnB1dChpZCwgYXMp\nOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogQ2xlYXIgYWxs\nIHBsYWNlaG9sZGVycyBhbmQgc2VsZWN0IEFTIGNsYXVzZXMuCiAgICAgICAg\nICovCiAgICAgICAgcHVibGljIHZvaWQgY2xlYXJQbGFjZWhvbGRlcnMoKSB7\nCiAgICAgICAgICAgIGlmIChfaWRzID09IG51bGwpCiAgICAgICAgICAgICAg\nICByZXR1cm47CgogICAgICAgICAgICBPYmplY3QgaWQ7CiAgICAgICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRyID0gX2lkcy5pdGVyYXRvcigpOyBpdHIuaGFz\nTmV4dCgpOykgewogICAgICAgICAgICAgICAgaWQgPSBpdHIubmV4dCgpOwog\nICAgICAgICAgICAgICAgaWYgKGlkIGluc3RhbmNlb2YgUGxhY2Vob2xkZXIp\nIHsKICAgICAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAg\nICAgICAgICAgICAgX2FsaWFzZXMucmVtb3ZlKGlkKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gY29udGFpbnMoT2JqZWN0IGlkKSB7CiAgICAgICAgICAgIHJl\ndHVybiBfYWxpYXNlcyAhPSBudWxsICYmIF9hbGlhc2VzLmNvbnRhaW5zS2V5\nKGlkKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3QgZ2V0KGlu\ndCBpKSB7CiAgICAgICAgICAgIGlmIChfaWRzID09IG51bGwpCiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0\naW9uKCk7CiAgICAgICAgICAgIHJldHVybiBfaWRzLmdldChpKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsKICAgICAgICAgICAg\ncmV0dXJuIChfaWRzID09IG51bGwpID8gMCA6IF9pZHMuc2l6ZSgpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAgICAg\nICAgIF9pZHMgPSBudWxsOwogICAgICAgICAgICBfYWxpYXNlcyA9IG51bGw7\nCiAgICAgICAgICAgIF9zZWxlY3RBcyA9IG51bGw7CiAgICAgICAgICAgIF9p\nZGVudHMgPSBudWxsOwogICAgICAgIH0KICAgIH0KfQoKLyoqCiAqIENvbW1v\nbiBqb2lucyBpbnRlcmZhY2UgdXNlZCBpbnRlcm5hbGx5LiBDYW5ub3QgYmUg\nbWFkZSBhbiBpbm5lciBjbGFzcwogKiBiZWNhdXNlIHRoZSBvdXRlciBjbGFz\ncyAoU2VsZWN0KSBoYXMgdG8gaW1wbGVtZW50IGl0LgogKi8KaW50ZXJmYWNl\nIFBhdGhKb2lucwogICAgZXh0ZW5kcyBKb2lucyB7CgogICAgLyoqCiAgICAg\nKiBNYXJrIHRoaXMgYXMgYW4gb3V0ZXIgam9pbnMgc2V0LgogICAgICovCiAg\nICBwdWJsaWMgUGF0aEpvaW5zIHNldE91dGVyKGJvb2xlYW4gb3V0ZXIpOwoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBpbnN0YW5jZSBo\nYXMgYSBwYXRoLCBhbnkgam9pbnMsIG9yIGEgdmFyaWFibGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGlzRGlydHkoKTsKCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgcmVsYXRpb24gcGF0aCB0cmF2ZXJzZWQgYnkgdGhlc2Ug\nam9pbnMsIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZ0J1ZmZlciBwYXRoKCk7CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIHNldCBvZiB7QGxpbmsgSm9pbn0gZWxlbWVudHMsIG9yIG51bGwgaWYgbm9u\nZS4KICAgICAqLwogICAgcHVibGljIEpvaW5TZXQgam9pbnMoKTsKCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgbWF4aW11bSBudW1iZXIgb2Ygam9pbnMg\nY29udGFpbmVkIGluIHRoaXMgaW5zdGFuY2UgYXQgYW55CiAgICAgKiB0aW1l\nLgogICAgICovCiAgICBwdWJsaWMgaW50IGpvaW5Db3VudCgpOwoKICAgIC8q\nKgogICAgICogTnVsbCB0aGUgc2V0IG9mIHtAbGluayBKb2lufSBlbGVtZW50\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgbnVsbEpvaW5zKCk7Cn0KCg==\n","encoding":"base64"}

