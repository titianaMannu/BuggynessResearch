{"sha":"09ae9fcfa9abf4e324e8b87b56b46ccf95d8b9e6","node_id":"MDQ6QmxvYjIwNjM2NDowOWFlOWZjZmE5YWJmNGUzMjRlOGI4N2I1NmI0NmNjZjk1ZDhiOWU2","size":11822,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/09ae9fcfa9abf4e324e8b87b56b46ccf95d8b9e6","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbDsKCmltcG9ydCBqYXZhLm1hdGguQmlnRGVjaW1h\nbDsKaW1wb3J0IGphdmEubWF0aC5CaWdJbnRlZ2VyOwppbXBvcnQgamF2YS5z\ncWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVt\nZW50OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2\nYS5zcWwuVHlwZXM7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwoKaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlL\nZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFi\nbGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVW5p\ncXVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkRlbGVn\nYXRpbmdDb25uZWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkphdmFUeXBlczsKCi8qKgogKiBEaWN0aW9uYXJ5IGZvciBTeWJhc2Uu\nCiAqICBUaGUgbWFpbiBwb2ludCBvZiBpbnRlcmVzdCBpcyB0aGF0IGJ5IGRl\nZmF1bHQsIGV2ZXJ5IHRhYmxlCiAqIHRoYXQgaXMgY3JlYXRlZCB3aWxsIGhh\ndmUgYSB1bmlxdWUgY29sdW1uIG5hbWVkICJVTlFfSU5ERVgiIG9mCiAqIHRo\nZSAiSURFTlRJVFkiIHR5cGUuIE9wZW5KUEEgd2lsbCBub3QgZXZlciB1dGls\naXplIHRoaXMgY29sdW1uLiBIb3dldmVyLAogKiBkdWUgdG8gaW50ZXJuYWwg\nU3liYXNlIHJlc3RyaWN0aW9ucywgdGhpcyBjb2x1bW4gaXMgcmVxdWlyZWQK\nICogaW4gb3JkZXIgdG8gc3VwcG9ydCBwZXNzaW1pc3RpYyAoZGF0YXN0b3Jl\nKSBsb2NraW5nLCBzaW5jZSBTeWJhc2UKICogcmVxdWlyZXMgdGhhdCBhbnkg\ndGFibGVzIGluIGEgIlNFTEVDVCAuLi4gRk9SIFVQREFURSIgY2xhdXNlIGhh\ndmUKICogYSB1bmlxdWUgaW5kZXggdGhhdCBpcyA8c3Ryb25nPm5vdDwvc3Ry\nb25nPiBpbmNsdWRlZCBpbiB0aGUgbGlzdAogKiBvZiBjb2x1bW5zLCBhcyBk\nZXNjcmliZWQgaW4gdGhlCiAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuc3liYXNl\nLmNvbS9kZXRhaWwvMSw2OTA0LDEwMjMwNzUsMDAuaHRtbCIKICogPlN5YmFz\nZSBkb2N1bWVudGF0aW9uPC9hPi4gVGhpcyBiZWhhdmlvciBjYW4gYmUgc3Vy\ncHJlc3NlZCBieSBzZXR0aW5nIHRoZQogKiBkaWN0aW9uYXJ5IHByb3BlcnR5\nIDxjb2RlPkNyZWF0ZUlkZW50aXR5Q29sdW1uPWZhbHNlPC9jb2RlPi4gVGhl\nCiAqIG5hbWUgb2YgdGhlIHVuaXF1ZSBjb2x1bW4gY2FuIGJlIGNoYW5nZWQg\nYnkgc2V0dGluZyB0aGUgcHJvcGVydHkKICogPGNvZGU+SWRlbnRpdHlDb2x1\nbW5OYW1lPUNPTFVNTl9OQU1FPC9jb2RlPi4KICogIEEgZ29vZCBTeWJhc2Ug\ndHlwZSByZWZlcmVuY2UgaXMgY2FuIGJlIGZvdW5kIDxhCiAqIGhyZWY9Imh0\ndHA6Ly93d3cuaXNwaXJlci5jb20vZG9jL3NxbHdheXMzNi9zeWJhc2Uvc3li\nX2R0eXBlcy5odG1sIj5oZXJlPC9hPi4KICovCnB1YmxpYyBjbGFzcyBTeWJh\nc2VEaWN0aW9uYXJ5CiAgICBleHRlbmRzIEFic3RyYWN0U1FMU2VydmVyRGlj\ndGlvbmFyeSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChTeWJhc2VEaWN0aW9u\nYXJ5LmNsYXNzKTsKCiAgICAvKioKICAgICAqIElmIHRydWUsIHRoZW4gd2hl\nbmV2ZXIgdGhlIDxjb2RlPnNjaGVtYXRvb2w8L2NvZGU+IGNyZWF0ZXMgYQog\nICAgICogdGFibGUsIGl0IHdpbGwgYXBwZW5kIGFuIGFkZGl0aW9uYWwgSURF\nTlRJVFkgY29sdW1uIHRvIHRoZQogICAgICogdGFibGUncyBjcmVhdGlvbiBT\nUUwuIFRoaXMgaXMgc28gU3liYXNlIHdpbGwgYmUgYWJsZSB0bwogICAgICog\ncGVyZm9ybSA8Y29kZT5TRUxFQ1QuLi5GT1IgVVBEQVRFPC9jb2RlPiBzdGF0\nZW1lbnRzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjcmVhdGVJZGVu\ndGl0eUNvbHVtbiA9IHRydWU7CgogICAgLyoqCiAgICAgKiBJZiB7QGxpbmsg\nI2NyZWF0ZUlkZW50aXR5Q29sdW1ufSBpcyB0cnVlLCB0aGVuIHRoZQogICAg\nICogPGNvZGU+aWRlbnRpdHlDb2x1bW5OYW1lPC9jb2RlPiB3aWxsIGJlIHRo\nZSBuYW1lIG9mIHRoZQogICAgICogYWRkaXRpb25hbCB1bmlxdWUgY29sdW1u\nIHRoYXQgd2lsbCBiZSBjcmVhdGVkLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGlkZW50aXR5Q29sdW1uTmFtZSA9ICJVTlFfSU5ERVgiOwoKICAgIHB1\nYmxpYyBTeWJhc2VEaWN0aW9uYXJ5KCkgewogICAgICAgIHBsYXRmb3JtID0g\nIlN5YmFzZSI7CiAgICAgICAgc2NoZW1hQ2FzZSA9IFNDSEVNQV9DQVNFX1BS\nRVNFUlZFOwogICAgICAgIGZvclVwZGF0ZUNsYXVzZSA9ICJGT1IgVVBEQVRF\nIEFUIElTT0xBVElPTiBTRVJJQUxJWkFCTEUiOwoKICAgICAgICBzdXBwb3J0\nc0xvY2tpbmdXaXRoRGlzdGluY3RDbGF1c2UgPSBmYWxzZTsKICAgICAgICBz\ndXBwb3J0c051bGxUYWJsZUZvckdldENvbHVtbnMgPSBmYWxzZTsKICAgICAg\nICByZXF1aXJlc0F1dG9Db21taXRGb3JNZXRhRGF0YSA9IHRydWU7CgogICAg\nICAgIG1heFRhYmxlTmFtZUxlbmd0aCA9IDMwOwogICAgICAgIG1heENvbHVt\nbk5hbWVMZW5ndGggPSAzMDsKICAgICAgICBtYXhJbmRleE5hbWVMZW5ndGgg\nPSAzMDsKICAgICAgICBtYXhDb25zdHJhaW50TmFtZUxlbmd0aCA9IDMwOwoK\nICAgICAgICBiaWdpbnRUeXBlTmFtZSA9ICJOVU1FUklDKDM4KSI7CiAgICAg\nICAgYml0VHlwZU5hbWUgPSAiVElOWUlOVCI7CgogICAgICAgIC8vIFN5YmFz\nZSBkb2Vzbid0IHVuZGVyc3RhbmQgIlggQ1JPU1MgSk9JTiBZIiwgYnV0IGl0\nIGRvZXMgdW5kZXJzdGFuZAogICAgICAgIC8vIHRoZSBlcXVpdmFsZW50ICJY\nIEpPSU4gWSBPTiAxID0gMSIKICAgICAgICBjcm9zc0pvaW5DbGF1c2UgPSAi\nSk9JTiI7CiAgICAgICAgcmVxdWlyZXNDb25kaXRpb25Gb3JDcm9zc0pvaW4g\nPSB0cnVlOwoKICAgICAgICAvLyB0aGVzZSB0YWJsZXMgc2hvdWxkIG5vdCBi\nZSByZWZsZWN0ZWQgb24KICAgICAgICBzeXN0ZW1UYWJsZVNldC5hZGRBbGwo\nQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJJSkRC\nQ19GVU5DVElPTl9FU0NBUEVTIiwgIkpEQkNfRlVOQ1RJT05fRVNDQVBFUyIs\nCiAgICAgICAgICAgICJTUFRfSUpEQkNfQ09OVkVSU0lPTiIsICJTUFRfSUpE\nQkNfTURBIiwgIlNQVF9JSkRCQ19UQUJMRV9UWVBFUyIsCiAgICAgICAgICAg\nICJTUFRfSkRCQ19DT05WRVJTSU9OIiwgIlNQVF9KREJDX1RBQkxFX1RZUEVT\nIiwgIlNQVF9KVEVYVCIsCiAgICAgICAgICAgICJTUFRfTElNSVRfVFlQRVMi\nLCAiU1BUX01EQSIsICJTUFRfTU9OSVRPUiIsICJTUFRfVkFMVUVTIiwKICAg\nICAgICAgICAgIlNZQkxJQ0VOU0VTTE9HIiwKICAgICAgICB9KSk7CgogICAg\nICAgIC8vIHJlc2VydmVkIHdvcmRzIHNwZWNpZmllZCBhdDoKICAgICAgICAv\nLyBodHRwOi8vbWFudWFscy5zeWJhc2UuY29tL29ubGluZWJvb2tzL2dyb3Vw\nLWFzL2FzZzEyNTBlLwogICAgICAgIC8vIHJlZm1hbi9AR2VuZXJpY19fQm9v\na1RleHRWaWV3LzI2NjAzCiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0LmFkZEFs\nbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkFS\nSVRIX09WRVJGTE9XIiwgIkJSRUFLIiwgIkJST1dTRSIsICJCVUxLIiwgIkNI\nQVJfQ09OVkVSVCIsCiAgICAgICAgICAgICJDSEVDS1BPSU5UIiwgIkNMVVNU\nRVJFRCIsICJDT01QVVRFIiwgIkNPTkZJUk0iLCAiQ09OVFJPTFJPVyIsCiAg\nICAgICAgICAgICJEQVRBQkFTRSIsICJEQkNDIiwgIkRFVEVSTUlOSVNUSUMi\nLCAiRElTSyBESVNUSU5DVCIsICJEVU1NWSIsCiAgICAgICAgICAgICJEVU1Q\nIiwgIkVORFRSQU4iLCAiRVJSTFZMIiwgIkVSUk9SREFUQSIsICJFUlJPUkVY\nSVQiLCAiRVhDTFVTSVZFIiwKICAgICAgICAgICAgIkVYSVQiLCAiRVhQX1JP\nV19TSVpFIiwgIkZJTExGQUNUT1IiLCAiRlVOQyIsICJGVU5DVElPTiIsCiAg\nICAgICAgICAgICJIT0xETE9DSyIsICJJREVOVElUWV9HQVAiLCAiSURFTlRJ\nVFlfSU5TRVJUIiwgIklERU5USVRZX1NUQVJUIiwKICAgICAgICAgICAgIklG\nIiwgIklOREVYIiwgIklOT1VUIiwgIklOU1RBTEwiLCAiSU5URVJTRUNUIiwg\nIkpBUiIsICJLSUxMIiwKICAgICAgICAgICAgIkxJTkVOTyIsICJMT0FEIiwg\nIkxPQ0siLCAiTUFYX1JPV1NfUEVSX1BBR0UiLCAiTUlSUk9SIiwKICAgICAg\nICAgICAgIk1JUlJPUkVYSVQiLCAiTU9ESUZZIiwgIk5FVyIsICJOT0hPTERM\nT0NLIiwgIk5PTkNMVVNURVJFRCIsCiAgICAgICAgICAgICJOVU1FUklDX1RS\nVU5DQVRJT04iLCAiT0ZGIiwgIk9GRlNFVFMiLCAiT05DRSIsICJPTkxJTkUi\nLCAiT1VUIiwKICAgICAgICAgICAgIk9WRVIiLCAiUEFSVElUSU9OIiwgIlBF\nUk0iLCAiUEVSTUFORU5UIiwgIlBMQU4iLCAiUFJJTlQiLCAiUFJPQyIsCiAg\nICAgICAgICAgICJQUk9DRVNTRVhJVCIsICJQUk9YWV9UQUJMRSIsICJRVUlF\nU0NFIiwgIlJBSVNFUlJPUiIsICJSRUFEIiwKICAgICAgICAgICAgIlJFQURQ\nQVNUIiwgIlJFQURURVhUIiwgIlJFQ09ORklHVVJFIiwgIlJFRkVSRU5DRVMg\nUkVNT1ZFIiwgIlJFT1JHIiwKICAgICAgICAgICAgIlJFUExBQ0UiLCAiUkVQ\nTElDQVRJT04iLCAiUkVTRVJWRVBBR0VHQVAiLCAiUkVUVVJOIiwgIlJFVFVS\nTlMiLAogICAgICAgICAgICAiUk9MRSIsICJST1dDT1VOVCIsICJSVUxFIiwg\nIlNBVkUiLCAiU0VUVVNFUiIsICJTSEFSRUQiLAogICAgICAgICAgICAiU0hV\nVERPV04iLCAiU09NRSIsICJTVEFUSVNUSUNTIiwgIlNUUklOR1NJWkUiLCAi\nU1RSSVBFIiwKICAgICAgICAgICAgIlNZQl9JREVOVElUWSIsICJTWUJfUkVT\nVFJFRSIsICJTWUJfVEVSTUlOQVRFIiwgIlRFTVAiLCAiVEVYVFNJWkUiLAog\nICAgICAgICAgICAiVFJBTiIsICJUUklHR0VSIiwgIlRSVU5DQVRFIiwgIlRT\nRVFVQUwiLCAiVU5QQVJUSVRJT04iLCAiVVNFIiwKICAgICAgICAgICAgIlVT\nRVJfT1BUSU9OIiwgIldBSVRGT1IiLCAiV0hJTEUiLCAiV1JJVEVURVhUIiwK\nICAgICAgICB9KSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRKREJDVHlw\nZShpbnQgbWV0YVR5cGVDb2RlLCBib29sZWFuIGxvYikgewogICAgICAgIHN3\naXRjaCAobWV0YVR5cGVDb2RlKSB7CiAgICAgICAgICAgIC8vIHRoZSBkZWZh\ndWx0IG1hcHBpbmcgZm9yIEJZVEUgaXMgYSBUSU5ZSU5ULCBidXQgU3liYXNl\nJ3MgVElOWUlOVAogICAgICAgICAgICAvLyB0eXBlIGNhbid0IGhhbmRsZSB0\naGUgY29tcGxldGUgcmFuZ2UgZm9yIGEgSmF2YSBieXRlCiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkJZVEVfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZl\ncnJlZFR5cGUoVHlwZXMuU01BTExJTlQpOwogICAgICAgICAgICBkZWZhdWx0\nOgogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldEpEQkNUeXBlKG1l\ndGFUeXBlQ29kZSwgbG9iKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0QmlnSW50ZWdlcihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwg\naW50IGlkeCwgQmlnSW50ZWdlciB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBzZXRC\naWdEZWNpbWFsIGRvZXNuJ3Qgd29yayBoZXJlOiBpbiBvbmUgY2FzZSwgYSBz\ndG9yZWQgdmFsdWUKICAgICAgICAvLyBvZiA3Nzk5NDM4NTE0OTI0MzQ5NDQw\nIHR1cm5zIGludG8gNzc5OTQzODUxNDkyNDM0OTQwMAogICAgICAgIC8vIHNl\ndE9iamVjdCBnZXRzIGFyb3VuZCB0aGlzIGluIHRoZSBTeWJhc2UgSkRCQyBk\ncml2ZXJzCiAgICAgICAgc2V0T2JqZWN0KHN0bW50LCBpZHgsIG5ldyBCaWdE\nZWNpbWFsKHZhbCksIFR5cGVzLkJJR0lOVCwgY29sKTsKICAgIH0KCiAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0QWRkRm9yZWlnbktleVNRTChGb3JlaWduS2V5\nIGZrKSB7CiAgICAgICAgLy8gU3liYXNlIGhhcyBwcm9ibGVtcyB3aXRoIGFk\nZGluZyBmb3JpZWduIGtleXMgdmlhIEFMVEVSIFRBQkxFIGNvbW1hbmQKICAg\nICAgICByZXR1cm4gbmV3IFN0cmluZ1swXTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nW10gZ2V0Q3JlYXRlVGFibGVTUUwoVGFibGUgdGFibGUpIHsKICAg\nICAgICBpZiAoIWNyZWF0ZUlkZW50aXR5Q29sdW1uKQogICAgICAgICAgICBy\nZXR1cm4gc3VwZXIuZ2V0Q3JlYXRlVGFibGVTUUwodGFibGUpOwoKICAgICAg\nICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAg\nICAgIGJ1Zi5hcHBlbmQoIkNSRUFURSBUQUJMRSAiKS5hcHBlbmQoZ2V0RnVs\nbE5hbWUodGFibGUsIGZhbHNlKSkuCiAgICAgICAgICAgIGFwcGVuZCgiICgi\nKTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9IHRhYmxlLmdldENvbHVtbnMo\nKTsKICAgICAgICBib29sZWFuIGhhc0lkZW50aXR5ID0gZmFsc2U7CgogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoY29sc1tpXS5pc0F1dG9Bc3NpZ25lZCgpKQogICAg\nICAgICAgICAgICAgaGFzSWRlbnRpdHkgPSB0cnVlOwoKICAgICAgICAgICAg\nYnVmLmFwcGVuZChpID09IDAgPyAiIiA6ICIsICIpOwogICAgICAgICAgICBi\ndWYuYXBwZW5kKGdldERlY2xhcmVDb2x1bW5TUUwoY29sc1tpXSwgZmFsc2Up\nKTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBhbiBpZGVudGl0eSBjb2x1\nbW4gaWYgd2UgZG8gbm90IGFscmVhZHkgaGF2ZSBvbmUKICAgICAgICBpZiAo\nIWhhc0lkZW50aXR5KQogICAgICAgICAgICBidWYuYXBwZW5kKCIsICIpLmFw\ncGVuZChpZGVudGl0eUNvbHVtbk5hbWUpLgogICAgICAgICAgICAgICAgYXBw\nZW5kKCIgTlVNRVJJQyBJREVOVElUWSBVTklRVUUiKTsKCiAgICAgICAgUHJp\nbWFyeUtleSBwayA9IHRhYmxlLmdldFByaW1hcnlLZXkoKTsKICAgICAgICBp\nZiAocGsgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKS5h\ncHBlbmQoZ2V0UHJpbWFyeUtleUNvbnN0cmFpbnRTUUwocGspKTsKCiAgICAg\nICAgVW5pcXVlW10gdW5xcyA9IHRhYmxlLmdldFVuaXF1ZXMoKTsKICAgICAg\nICBTdHJpbmcgdW5xU3RyOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\ndW5xcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB1bnFTdHIgPSBnZXRV\nbmlxdWVDb25zdHJhaW50U1FMKHVucXNbaV0pOwogICAgICAgICAgICBpZiAo\ndW5xU3RyICE9IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIs\nICIpLmFwcGVuZCh1bnFTdHIpOwogICAgICAgIH0KCiAgICAgICAgYnVmLmFw\ncGVuZCgiKSIpOwogICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117IGJ1Zi50\nb1N0cmluZygpIH07CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRE\nZWNsYXJlQ29sdW1uU1FMKENvbHVtbiBjb2wsIGJvb2xlYW4gYWx0ZXIpIHsK\nICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigp\nOwogICAgICAgIGJ1Zi5hcHBlbmQoY29sKS5hcHBlbmQoIiAiKTsKICAgICAg\nICBidWYuYXBwZW5kKGdldFR5cGVOYW1lKGNvbCkpOwoKICAgICAgICAvLyBj\nYW4ndCBhZGQgY29uc3RyYWludHMgdG8gYSBjb2x1bW4gd2UncmUgYWRkaW5n\nIGFmdGVyIHRhYmxlCiAgICAgICAgLy8gY3JlYXRpb24sIGNhdXNlIHNvbWUg\nZGF0YSBtaWdodCBhbHJlYWR5IGJlIGluc2VydGVkCiAgICAgICAgaWYgKCFh\nbHRlcikgewogICAgICAgICAgICBpZiAoY29sLmdldERlZmF1bHRTdHJpbmco\nKSAhPSBudWxsICYmICFjb2wuaXNBdXRvQXNzaWduZWQoKSkKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBERUZBVUxUICIpLmFwcGVuZChjb2wuZ2V0\nRGVmYXVsdFN0cmluZygpKTsKICAgICAgICAgICAgaWYgKGNvbC5pc0F1dG9B\nc3NpZ25lZCgpKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiIElERU5U\nSVRZIik7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29sLmlzTm90TnVsbCgp\nKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgTk9UIE5VTEwiKTsKICAgICAg\nICBlbHNlIGlmICghY29sLmlzUHJpbWFyeUtleSgpKSB7CiAgICAgICAgICAg\nIC8vIHN5YmFzZSBmb3JjZXMgeW91IHRvIGV4cGxpY2l0bHkgc3BlY2lmeSB0\naGF0CiAgICAgICAgICAgIC8vIHlvdSB3aWxsIGFsbG93IE5VTEwgdmFsdWVz\nCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBOVUxMIik7CiAgICAgICAgfQoK\nICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVi\nbGljIFN0cmluZ1tdIGdldERyb3BDb2x1bW5TUUwoQ29sdW1uIGNvbHVtbikg\newogICAgICAgIC8vIFN5YmFzZSB1c2VzICJBTFRFUiBUQUJMRSBEUk9QIDxD\nT0xVTU5fTkFNRT4iIHJhdGhlciB0aGFuIHRoZQogICAgICAgIC8vIHVzdWFs\nICJBTFRFUiBUQUJMRSBEUk9QIENPTFVNTiA8Q09MVU1OX05BTUU+IgogICAg\nICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAg\nICAgICAgICsgZ2V0RnVsbE5hbWUoY29sdW1uLmdldFRhYmxlKCksIGZhbHNl\nKSArICIgRFJPUCAiICsgY29sdW1uIH07CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmVmU2NoZW1hQ29tcG9uZW50cyhUYWJsZSB0YWJsZSkgewogICAgICAg\nIC8vIG5vdGUgdGhhdCB3ZSB1c2UgZ2V0Q29sdW1ucygpIHJhdGhlciB0aGFu\nIGdldHRpbmcgdGhlIGNvbHVtbiBieSBuYW1lCiAgICAgICAgLy8gYmVjYXVz\nZSB1bmRlciBzb21lIGNpcmN1bXN0YW5jZXMgdGhpcyBtZXRob2QgaXMgY2Fs\nbGVkIHVuZGVyIHRoZQogICAgICAgIC8vIGR5bmFtaWMgc2NoZW1hIGZhY3Rv\ncnksIHdoZXJlIGdldHRpbmcgYSBjb2x1bW4gYnkgbmFtZSBjcmVhdGVzCiAg\nICAgICAgLy8gdGhhdCBjb2x1bW4KICAgICAgICBDb2x1bW5bXSBjb2xzID0g\ndGFibGUuZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGlkZW50aXR5\nQ29sdW1uTmFtZS5lcXVhbHNJZ25vcmVDYXNlKGNvbHNbaV0uZ2V0TmFtZSgp\nKSkKICAgICAgICAgICAgICAgIGNvbHNbaV0ucmVmKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsKICAgICAgICBzdXBl\nci5lbmRDb25maWd1cmF0aW9uKCk7CgogICAgICAgIC8vIHdhcm4gYWJvdXQg\namRiYyBjb21wbGlhbnQgZmxhZwogICAgICAgIFN0cmluZyB1cmwgPSBjb25m\nLmdldENvbm5lY3Rpb25VUkwoKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxz\nLmlzRW1wdHkodXJsKQogICAgICAgICAgICAmJiB1cmwudG9Mb3dlckNhc2Uo\nKS5pbmRleE9mKCJqZGJjOnN5YmFzZTp0ZHMiKSAhPSAtMQogICAgICAgICAg\nICAmJiB1cmwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJiZV9hc19qZGJjX2Nv\nbXBsaWFudF9hc19wb3NzaWJsZT0iKQogICAgICAgICAgICA9PSAtMSkgewog\nICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgic3liYXNlLWNvbXBsaWFu\nY2UiLCB1cmwpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIENvbm5l\nY3Rpb24gZGVjb3JhdGUoQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBuZXcgU3liYXNlQ29u\nbmVjdGlvbihzdXBlci5kZWNvcmF0ZShjb25uKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb25uZWN0aW9uIHdyYXBwZXIgdG8gY2FjaGUgdGhlIHtAbGlu\nayBDb25uZWN0aW9uI2dldENhdGFsb2d9IHJlc3VsdCwKICAgICAqIHdoaWNo\nIHRha2VzIGEgdmVyeSBsb25nIHRpbWUgd2l0aCB0aGUgU3liYXNlIENvbm5l\nY3Rpb24gKGFuZAogICAgICogd2hpY2ggd2UgZnJlcXVlbnRseSBpbnZva2Up\nLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBTeWJhc2VDb25u\nZWN0aW9uCiAgICAgICAgZXh0ZW5kcyBEZWxlZ2F0aW5nQ29ubmVjdGlvbiB7\nCgogICAgICAgIHByaXZhdGUgU3RyaW5nIF9jYXRhbG9nID0gbnVsbDsKCiAg\nICAgICAgcHVibGljIFN5YmFzZUNvbm5lY3Rpb24oQ29ubmVjdGlvbiBjb25u\nKSB7CiAgICAgICAgICAgIHN1cGVyKGNvbm4pOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIFN0cmluZyBnZXRDYXRhbG9nKCkKICAgICAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChfY2F0YWxvZyA9\nPSBudWxsKQogICAgICAgICAgICAgICAgX2NhdGFsb2cgPSBzdXBlci5nZXRD\nYXRhbG9nKCk7CiAgICAgICAgICAgIHJldHVybiBfY2F0YWxvZzsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEF1dG9Db21taXQoYm9vbGVh\nbiBhdXRvY29tbWl0KQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgLy8gdGhlIHN5YmFzZSBqZGJjIGRyaXZlciBkZW1h\nbmRzIHRoYXQgdGhlIENvbm5lY3Rpb24gYWx3YXlzCiAgICAgICAgICAgIC8v\nIGJlIHJvbGxlZCBiYWNrIGJlZm9yZSBhdXRvY29tbWl0IHN0YXR1cyBjaGFu\nZ2VzLiBGYWlsdXJlIHRvCiAgICAgICAgICAgIC8vIGRvIHNvIHdpbGwgeWll\nbGQgIlNFVCBDSEFJTkVEIGNvbW1hbmQgbm90IGFsbG93ZWQgd2l0aGluCiAg\nICAgICAgICAgIC8vIG11bHRpLXN0YXRlbWVudCB0cmFuc2FjdGlvbi4iIGV4\nY2VwdGlvbnMKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN1\ncGVyLnNldEF1dG9Db21taXQoYXV0b2NvbW1pdCk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBm\nYWlsZWQgZm9yIHNvbWUgcmVhc29uOiB0cnkgcm9sbGluZyBiYWNrIGFuZCB0\naGVuCiAgICAgICAgICAgICAgICAvLyBzZXR0aW5nIGF1dG9jb21taXQgYWdh\naW4uCiAgICAgICAgICAgICAgICBpZiAoYXV0b2NvbW1pdCkKICAgICAgICAg\nICAgICAgICAgICBzdXBlci5jb21taXQoKTsKICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICBzdXBlci5yb2xsYmFjaygpOwogICAg\nICAgICAgICAgICAgc3VwZXIuc2V0QXV0b0NvbW1pdChhdXRvY29tbWl0KTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

