{"sha":"8abeb04e256d51515c17adf08fb6f1c7774e1212","node_id":"MDQ6QmxvYjIwNjM2NDo4YWJlYjA0ZTI1NmQ1MTUxNWMxN2FkZjA4ZmI2ZjFjNzc3NGUxMjEy","size":41316,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8abeb04e256d51515c17adf08fb6f1c7774e1212","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5lbmhhbmNlOwoKaW1wb3J0IGphdmEudXRpbC5CaXRTZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5J\ndGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQg\namF2YS51dGlsLk1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFu\nZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5BYnN0cmFjdFBDRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QQ0RhdGE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlQ29udGV4dDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVudC5Db25jdXJy\nZW50SGFzaE1hcDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNs\nYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50\nZXJuYWxFeGNlcHRpb247CmltcG9ydCBzZXJwLmJ5dGVjb2RlLkJDQ2xhc3M7\nCmltcG9ydCBzZXJwLmJ5dGVjb2RlLkJDRmllbGQ7CmltcG9ydCBzZXJwLmJ5\ndGVjb2RlLkJDTWV0aG9kOwppbXBvcnQgc2VycC5ieXRlY29kZS5Db2RlOwpp\nbXBvcnQgc2VycC5ieXRlY29kZS5Db25zdGFudHM7CmltcG9ydCBzZXJwLmJ5\ndGVjb2RlLkV4Y2VwdGlvbkhhbmRsZXI7CmltcG9ydCBzZXJwLmJ5dGVjb2Rl\nLkluc3RydWN0aW9uOwppbXBvcnQgc2VycC5ieXRlY29kZS5KdW1wSW5zdHJ1\nY3Rpb247CmltcG9ydCBzZXJwLmJ5dGVjb2RlLkxvb2t1cFN3aXRjaEluc3Ry\ndWN0aW9uOwoKLyoqCiAqIEdlbmVyYXRlcyB7QGxpbmsgUENEYXRhfSBpbnN0\nYW5jZXMgd2hpY2ggYXZvaWQgcHJpbWl0dmUgd3JhcHBlcnMKICogdG8gb3B0\naW1pemUgbWVtb3J5IHVzZSBhbmQgcGVyZm9ybWFuY2UgYXQgdGhlIGNvc3Qg\nb2Ygc2xpZ2h0bHkgaGlnaGVyCiAqIHN0YXJ0dXAgdGltZS4KICoKICogQGF1\ndGhvciBTdGV2ZSBLaW0KICogQG5vamF2YWRvYwogKiBAc2luY2UgMC4zLjIK\nICovCnB1YmxpYyBjbGFzcyBQQ0RhdGFHZW5lcmF0b3IKICAgIGV4dGVuZHMg\nRHluYW1pY1N0b3JhZ2VHZW5lcmF0b3IgewoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoUENEYXRhR2VuZXJhdG9yLmNsYXNzKTsKCiAgICBwcm90ZWN0\nZWQgc3RhdGljIGZpbmFsIFN0cmluZyBQT1NURklYID0gIiRvcGVuanBhcGNk\nYXRhIjsKCiAgICBwcml2YXRlIGZpbmFsIE1hcCBfZ2VuZXJhdGVkID0gbmV3\nIENvbmN1cnJlbnRIYXNoTWFwKCk7CiAgICBwcml2YXRlIGZpbmFsIE9wZW5K\nUEFDb25maWd1cmF0aW9uIF9jb25mOwogICAgcHJpdmF0ZSBmaW5hbCBMb2cg\nX2xvZzsKCiAgICBwdWJsaWMgUENEYXRhR2VuZXJhdG9yKE9wZW5KUEFDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICAg\nICAgX2xvZyA9IF9jb25mLmdldExvZ0ZhY3RvcnkoKS5nZXRMb2coT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24uTE9HX0VOSEFOQ0UpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigp\nIHsKICAgICAgICByZXR1cm4gX2NvbmY7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYSB7QGxpbmsgUENEYXRhfSBpbnN0YW5jZSBmb3IgdGhlIGdp\ndmVuIG9pZCBhbmQgbWV0YWRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyBQQ0Rh\ndGEgZ2VuZXJhdGVQQ0RhdGEoT2JqZWN0IG9pZCwgQ2xhc3NNZXRhRGF0YSBt\nZXRhKSB7CiAgICAgICAgaWYgKG1ldGEgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgQ2xhc3MgdHlwZSA9IG1ldGEuZ2V0RGVz\nY3JpYmVkVHlwZSgpOwogICAgICAgIER5bmFtaWNTdG9yYWdlIHN0b3JhZ2Ug\nPSAoRHluYW1pY1N0b3JhZ2UpIF9nZW5lcmF0ZWQuZ2V0KHR5cGUpOwogICAg\nICAgIGlmIChzdG9yYWdlID09IG51bGwpIHsKICAgICAgICAgICAgc3RvcmFn\nZSA9IGdlbmVyYXRlU3RvcmFnZShtZXRhKTsKICAgICAgICAgICAgX2dlbmVy\nYXRlZC5wdXQodHlwZSwgc3RvcmFnZSk7CiAgICAgICAgICAgIGlmIChfbG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBfbG9nLnRyYWNl\nKF9sb2MuZ2V0KCJwY2RhdGEtY3JlYXRlZCIsIHR5cGUuZ2V0TmFtZSgpLCBt\nZXRhKSk7CiAgICAgICAgfQogICAgICAgIER5bmFtaWNQQ0RhdGEgZGF0YSA9\nIChEeW5hbWljUENEYXRhKSBzdG9yYWdlLm5ld0luc3RhbmNlKCk7CiAgICAg\nICAgZGF0YS5zZXRJZChvaWQpOwogICAgICAgIGRhdGEuc2V0U3RvcmFnZUdl\nbmVyYXRvcih0aGlzKTsKICAgICAgICBmaW5pc2goZGF0YSwgbWV0YSk7CiAg\nICAgICAgcmV0dXJuIGRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBY3R1\nYWxseSBnZW5lcmF0ZSB0aGUgZmFjdG9yeSBpbnN0YW5jZS4KICAgICAqLwog\nICAgcHJpdmF0ZSBEeW5hbWljU3RvcmFnZSBnZW5lcmF0ZVN0b3JhZ2UoQ2xh\nc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVu\nYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgicGNk\nYXRhLWdlbmVyYXRlIiwgbWV0YSkpOwoKICAgICAgICBGaWVsZE1ldGFEYXRh\nW10gZmllbGRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICBpbnRbXSB0\neXBlcyA9IG5ldyBpbnRbZmllbGRzLmxlbmd0aF07CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCB0eXBlcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\ndHlwZXNbaV0gPSByZXBsYWNlVHlwZShmaWVsZHNbaV0pOwogICAgICAgIHJl\ndHVybiBnZW5lcmF0ZVN0b3JhZ2UodHlwZXMsIG1ldGEpOwogICAgfQoKICAg\nIC8qKgogICAgICogUGVyZm9ybSBhbnkgZmluYWwgYWN0aW9ucyBiZWZvcmUg\ndGhlIHBjZGF0YSBpcyByZXR1cm5lZCB0byBjbGllbnQgY29kZS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgZmluaXNoKER5bmFtaWNQQ0RhdGEgZGF0\nYSwgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICB9CgogICAgcHJvdGVjdGVk\nIGludCBnZXRDcmVhdGVGaWVsZE1ldGhvZHMoaW50IHR5cGVDb2RlKSB7CiAg\nICAgICAgaWYgKHR5cGVDb2RlID49IEphdmFUeXBlcy5PQkpFQ1QpCiAgICAg\nICAgICAgIHJldHVybiBQT0xJQ1lfU0lMRU5UOwogICAgICAgIC8vIGRvbid0\nIGJvdGhlciBjcmVhdGluZyBzZXQvZ2V0PFByaW1pdGl2ZT4gbWV0aG9kcwog\nICAgICAgIHJldHVybiBQT0xJQ1lfRU1QVFk7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgZGVjbGFyZUNsYXNzZXMoQkNDbGFzcyBiYykgewogICAgICAg\nIHN1cGVyLmRlY2xhcmVDbGFzc2VzKGJjKTsKICAgICAgICBiYy5kZWNsYXJl\nSW50ZXJmYWNlKER5bmFtaWNQQ0RhdGEuY2xhc3MpOwogICAgICAgIGJjLnNl\ndFN1cGVyY2xhc3MoQWJzdHJhY3RQQ0RhdGEuY2xhc3MpOwogICAgfQoKICAg\nIHByb3RlY3RlZCBmaW5hbCBTdHJpbmcgZ2V0Q2xhc3NOYW1lKE9iamVjdCBv\nYmopIHsKICAgICAgICByZXR1cm4gZ2V0VW5pcXVlTmFtZSgoKENsYXNzTWV0\nYURhdGEpIG9iaikuZ2V0RGVzY3JpYmVkVHlwZSgpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZXMgYSB1bmlxdWUgbmFtZSBmb3IgdGhlIGdpdmVu\nIHR5cGUncyBwY2RhdGEgaW1wbGVtZW50YXRpb24uCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBTdHJpbmcgZ2V0VW5pcXVlTmFtZShDbGFzcyB0eXBlKSB7CiAg\nICAgICAgcmV0dXJuIHR5cGUuZ2V0TmFtZSgpICsgIiQiICsgU3lzdGVtLmlk\nZW50aXR5SGFzaENvZGUodHlwZSkgKyBQT1NURklYOwogICAgfQoKICAgIHBy\nb3RlY3RlZCBmaW5hbCB2b2lkIGRlY29yYXRlKE9iamVjdCBvYmosIEJDQ2xh\nc3MgYmMsIGludFtdIHR5cGVzKSB7CiAgICAgICAgc3VwZXIuZGVjb3JhdGUo\nb2JqLCBiYywgdHlwZXMpOwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIChDbGFzc01ldGFEYXRhKSBvYmo7CgogICAgICAgIGVuaGFuY2VDb25zdHJ1\nY3RvcihiYyk7CiAgICAgICAgYWRkQmFzZUZpZWxkcyhiYyk7CiAgICAgICAg\nYWRkSW1wbERhdGFNZXRob2RzKGJjLCBtZXRhKTsKICAgICAgICBhZGRGaWVs\nZEltcGxEYXRhTWV0aG9kcyhiYywgbWV0YSk7CiAgICAgICAgYWRkVmVyc2lv\nbk1ldGhvZHMoYmMpOwogICAgICAgIGFkZEdldFR5cGUoYmMsIG1ldGEpOwog\nICAgICAgIGFkZExvYWRNZXRob2QoYmMsIG1ldGEpOwogICAgICAgIGFkZExv\nYWRXaXRoRmllbGRzTWV0aG9kKGJjLCBtZXRhKTsKICAgICAgICBhZGRTdG9y\nZU1ldGhvZHMoYmMsIG1ldGEpOwogICAgICAgIGFkZE5ld0VtYmVkZGVkKGJj\nKTsKICAgICAgICBhZGRHZXREYXRhKGJjKTsKICAgICAgICBkZWNvcmF0ZShi\nYywgbWV0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBseSBhZGRpdGlv\nbmFsIGRlY29yYXRpb24gdG8gZ2VuZXJhdGVkIGNsYXNzLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBkZWNvcmF0ZShCQ0NsYXNzIGJjLCBDbGFzc01l\ndGFEYXRhIG1ldGEpIHsKICAgIH0KCiAgICAvKioKICAgICAqIEVuaGFuY2Ug\nY29uc3RydWN0b3IgdG8gaW5pdGlhbGl6ZSBmaWVsZHMKICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGVuaGFuY2VDb25zdHJ1Y3RvcihCQ0NsYXNzIGJjKSB7\nCiAgICAgICAgQkNNZXRob2QgY29ucyA9IGJjLmdldERlY2xhcmVkTWV0aG9k\nKCI8aW5pdD4iLCAoU3RyaW5nW10pIG51bGwpOwogICAgICAgIENvZGUgY29k\nZSA9IGNvbnMuZ2V0Q29kZShmYWxzZSk7CiAgICAgICAgY29kZS5hZnRlckxh\nc3QoKTsKICAgICAgICBjb2RlLnByZXZpb3VzKCk7CgogICAgICAgIC8vIHBy\naXZhdGUgQml0U2V0IGxvYWRlZCA9IG5ldyBCaXRTZXQoKTsKICAgICAgICBC\nQ0ZpZWxkIGxvYWRlZCA9IGFkZEJlYW5GaWVsZChiYywgImxvYWRlZCIsIEJp\ndFNldC5jbGFzcyk7CiAgICAgICAgbG9hZGVkLnNldEZpbmFsKHRydWUpOwog\nICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgY29kZS5h\nbmV3KCkuc2V0VHlwZShCaXRTZXQuY2xhc3MpOwogICAgICAgIGNvZGUuZHVw\nKCk7CiAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGJjLmdldEZp\nZWxkcygpLmxlbmd0aCk7CiAgICAgICAgY29kZS5pbnZva2VzcGVjaWFsKCku\nc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgIjxpbml0PiIsIHZvaWQuY2xhc3Ms\nCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAg\nICAgY29kZS5wdXRmaWVsZCgpLnNldEZpZWxkKGxvYWRlZCk7CgogICAgICAg\nIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsKICAgICAgICBjb2RlLmNhbGN1\nbGF0ZU1heExvY2FscygpOwogICAgfQoKICAgIC8qKgogICAgICogSGF2ZSB0\nbyBsb2FkIHRoZSB0eXBlIHNpbmNlIGl0IG1heSBub3QgYmUgYXZhaWxhYmxl\nIHRvIHRoZQogICAgICogc2FtZSBjbGFzc2xvYWRlciAoaS5lLiByYXIgdnMu\nIGVhcikuIFRoZSBjb250ZXh0IGNsYXNzbG9hZGVyCiAgICAgKiAoaS5lLiB0\naGUgdXNlciBhcHAgY2xhc3Nsb2FkZXIpIHNob3VsZCBiZSBmaW5lLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgYWRkR2V0VHlwZShCQ0NsYXNzIGJjLCBD\nbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBCQ0ZpZWxkIHR5cGUgPSBi\nYy5kZWNsYXJlRmllbGQoInR5cGUiLCBDbGFzcy5jbGFzcyk7CiAgICAgICAg\ndHlwZS5zZXRTdGF0aWModHJ1ZSk7CiAgICAgICAgdHlwZS5tYWtlUHJpdmF0\nZSgpOwogICAgICAgIC8vIHB1YmxpYyBDbGFzcyBnZXRUeXBlKCkgewogICAg\nICAgIEJDTWV0aG9kIGdldHRlciA9IGJjLmRlY2xhcmVNZXRob2QoImdldFR5\ncGUiLCBDbGFzcy5jbGFzcywgbnVsbCk7CiAgICAgICAgZ2V0dGVyLm1ha2VQ\ndWJsaWMoKTsKICAgICAgICBDb2RlIGNvZGUgPSBnZXR0ZXIuZ2V0Q29kZSh0\ncnVlKTsKICAgICAgICAvLyBpZiAodHlwZSA9PSBudWxsKSB7CiAgICAgICAg\nLy8gCQl0cnkgewogICAgICAgIC8vIAkJCXR5cGUgPSBDbGFzcy5mb3JOYW1l\nCiAgICAgICAgLy8gCQkJCShtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXRO\nYW1lKCksIHRydWUsCiAgICAgICAgLy8gCQkJCVRocmVhZC5jdXJyZW50VGhy\nZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCkpOwogICAgICAgIC8vIAkJ\nfSBjYXRjaCAoQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiBjbmZlKSB7CiAgICAg\nICAgLy8gCQkJdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAg\nICAgLy8gCQl9CiAgICAgICAgLy8gfQogICAgICAgIGNvZGUuZ2V0c3RhdGlj\nKCkuc2V0RmllbGQodHlwZSk7CgogICAgICAgIENvbGxlY3Rpb24ganVtcHMg\nPSBuZXcgTGlua2VkTGlzdCgpOwogICAgICAgIGp1bXBzLmFkZChjb2RlLmlm\nbm9ubnVsbCgpKTsKICAgICAgICBFeGNlcHRpb25IYW5kbGVyIGhhbmRsZXIg\nPSBjb2RlLmFkZEV4Y2VwdGlvbkhhbmRsZXIoKTsKCiAgICAgICAgaGFuZGxl\nci5zZXRUcnlTdGFydChjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUKICAgICAg\nICAgICAgKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKSkpOwog\nICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZSh0cnVlKTsKICAgICAg\nICBjb2RlLmludm9rZXN0YXRpYygpLnNldE1ldGhvZChUaHJlYWQuY2xhc3Ms\nICJjdXJyZW50VGhyZWFkIiwKICAgICAgICAgICAgVGhyZWFkLmNsYXNzLCBu\ndWxsKTsKICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2Qo\nVGhyZWFkLmNsYXNzLCAiZ2V0Q29udGV4dENsYXNzTG9hZGVyIiwKICAgICAg\nICAgICAgQ2xhc3NMb2FkZXIuY2xhc3MsIG51bGwpOwogICAgICAgIGNvZGUu\naW52b2tlc3RhdGljKCkuc2V0TWV0aG9kKENsYXNzLmNsYXNzLCAiZm9yTmFt\nZSIsIENsYXNzLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgU3Ry\naW5nLmNsYXNzLCBib29sZWFuLmNsYXNzLCBDbGFzc0xvYWRlci5jbGFzcyB9\nKTsKICAgICAgICBjb2RlLnB1dHN0YXRpYygpLnNldEZpZWxkKHR5cGUpOwog\nICAgICAgIEluc3RydWN0aW9uIGdvMiA9IGNvZGUuZ28yKCk7CiAgICAgICAg\nanVtcHMuYWRkKGdvMik7CiAgICAgICAgaGFuZGxlci5zZXRUcnlFbmQoZ28y\nKTsKICAgICAgICBoYW5kbGVyLnNldENhdGNoKENsYXNzTm90Rm91bmRFeGNl\ncHRpb24uY2xhc3MpOwogICAgICAgIGhhbmRsZXIuc2V0SGFuZGxlclN0YXJ0\nKHRocm93RXhjZXB0aW9uCiAgICAgICAgICAgIChjb2RlLCBJbnRlcm5hbEV4\nY2VwdGlvbi5jbGFzcykpOwogICAgICAgIHNldFRhcmdldChjb2RlLmdldHN0\nYXRpYygpLnNldEZpZWxkKHR5cGUpLCBqdW1wcyk7CiAgICAgICAgY29kZS5h\ncmV0dXJuKCk7CgogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsK\nICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwogICAgfQoKICAg\nIC8qKgogICAgICogRGVjbGFyZSBzdGFuZGFyZCBkeW5hbWljIHBjZGF0YSBm\naWVsZHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhZGRCYXNlRmllbGRz\nKEJDQ2xhc3MgYmMpIHsKICAgICAgICBhZGRCZWFuRmllbGQoYmMsICJpZCIs\nIE9iamVjdC5jbGFzcyk7CiAgICAgICAgQkNGaWVsZCBmaWVsZCA9IGFkZEJl\nYW5GaWVsZChiYywgInN0b3JhZ2VHZW5lcmF0b3IiLAogICAgICAgICAgICBQ\nQ0RhdGFHZW5lcmF0b3IuY2xhc3MpOwogICAgICAgIGZpZWxkLnNldEFjY2Vz\nc0ZsYWdzKGZpZWxkLmdldEFjY2Vzc0ZsYWdzKCkKICAgICAgICAgICAgfCBD\nb25zdGFudHMuQUNDRVNTX1RSQU5TSUVOVCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBZGQgbWV0aG9kcyBmb3IgbG9hZGluZyBhbmQgc3RvcmluZyBjbGFz\ncy1sZXZlbCBpbXBsIGRhdGEuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBh\nZGRJbXBsRGF0YU1ldGhvZHMoQkNDbGFzcyBiYywgQ2xhc3NNZXRhRGF0YSBt\nZXRhKSB7CiAgICAgICAgLy8gdm9pZCBzdG9yZUltcGxEYXRhKE9wZW5KUEFT\ndGF0ZU1hbmFnZXIpOwogICAgICAgIEJDTWV0aG9kIG1ldGggPSBiYy5kZWNs\nYXJlTWV0aG9kKCJzdG9yZUltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAgICAg\nICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3Mg\nfSk7CiAgICAgICAgQ29kZSBjb2RlID0gbWV0aC5nZXRDb2RlKHRydWUpOwoK\nICAgICAgICBCQ0ZpZWxkIGltcGwgPSBudWxsOwogICAgICAgIGlmICghdXNl\nc0ltcGxEYXRhKG1ldGEpKQogICAgICAgICAgICBjb2RlLnZyZXR1cm4oKTsK\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgLy8gaWYgKHNtLmlzSW1wbERh\ndGFDYWNoZWFibGUoKSkKICAgICAgICAgICAgLy8gCQlzZXRJbXBsRGF0YShz\nbS5nZXRJbXBsRGF0YSgpKTsKICAgICAgICAgICAgaW1wbCA9IGFkZEJlYW5G\naWVsZChiYywgImltcGxEYXRhIiwgT2JqZWN0LmNsYXNzKTsKICAgICAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICBjb2Rl\nLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5h\nZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgImlzSW1wbERhdGFDYWNoZWFi\nbGUiLCBib29sZWFuLmNsYXNzLCBudWxsKTsKICAgICAgICAgICAgSnVtcElu\nc3RydWN0aW9uIGlmaW5zID0gY29kZS5pZmVxKCk7CiAgICAgICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQo\nKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZh\nY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAg\nICAgICAgICAgICAgICJnZXRJbXBsRGF0YSIsIE9iamVjdC5jbGFzcywgbnVs\nbCk7CiAgICAgICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhv\nZCgic2V0SW1wbERhdGEiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICAgICAg\nbmV3IENsYXNzW117IE9iamVjdC5jbGFzcyB9KTsKICAgICAgICAgICAgaWZp\nbnMuc2V0VGFyZ2V0KGNvZGUudnJldHVybigpKTsKICAgICAgICB9CiAgICAg\nICAgY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAgICAgIGNvZGUuY2Fs\nY3VsYXRlTWF4TG9jYWxzKCk7CgogICAgICAgIC8vIHZvaWQgbG9hZEltcGxE\nYXRhKE9wZW5KUEFTdGF0ZU1hbmFnZXIpOwogICAgICAgIG1ldGggPSBiYy5k\nZWNsYXJlTWV0aG9kKCJsb2FkSW1wbERhdGEiLCB2b2lkLmNsYXNzLAogICAg\nICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFz\ncyB9KTsKICAgICAgICBjb2RlID0gbWV0aC5nZXRDb2RlKHRydWUpOwogICAg\nICAgIGlmICghdXNlc0ltcGxEYXRhKG1ldGEpKQogICAgICAgICAgICBjb2Rl\nLnZyZXR1cm4oKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgLy8gaWYg\nKHNtLmdldEltcGxEYXRhKCkgPT0gbnVsbCAmJiBpbXBsRGF0YSAhPSBudWxs\nKQogICAgICAgICAgICAvLyAJCXNtLnNldEltcGxEYXRhKGltcGwsIHRydWUp\nOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAg\nICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAiZ2V0SW1w\nbERhdGEiLCBPYmplY3QuY2xhc3MsIG51bGwpOwogICAgICAgICAgICBKdW1w\nSW5zdHJ1Y3Rpb24gaWZpbnMgPSBjb2RlLmlmbm9ubnVsbCgpOwogICAgICAg\nICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2Rl\nLmdldGZpZWxkKCkuc2V0RmllbGQoaW1wbCk7CiAgICAgICAgICAgIEp1bXBJ\nbnN0cnVjdGlvbiBpZmluczIgPSBjb2RlLmlmbnVsbCgpOwogICAgICAgICAg\nICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAgIGNvZGUu\nYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQo\nKS5zZXRGaWVsZChpbXBsKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgp\nLnNldFZhbHVlKHRydWUpOwogICAgICAgICAgICBjb2RlLmludm9rZWludGVy\nZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAog\nICAgICAgICAgICAgICAgInNldEltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAg\nICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBPYmplY3QuY2xhc3MsIGJvb2xl\nYW4uY2xhc3MgfSk7CiAgICAgICAgICAgIEluc3RydWN0aW9uIGlucyA9IGNv\nZGUudnJldHVybigpOwogICAgICAgICAgICBpZmlucy5zZXRUYXJnZXQoaW5z\nKTsKICAgICAgICAgICAgaWZpbnMyLnNldFRhcmdldChpbnMpOwogICAgICAg\nIH0KICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAgICAg\nY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFkZCBtZXRob2RzIGZvciBsb2FkaW5nIGFuZCBzdG9yaW5nIGNsYXNz\nLWxldmVsIGltcGwgZGF0YS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFk\nZEZpZWxkSW1wbERhdGFNZXRob2RzKEJDQ2xhc3MgYmMsIENsYXNzTWV0YURh\ndGEgbWV0YSkgewogICAgICAgIC8vIHB1YmxpYyB2b2lkIGxvYWRJbXBsRGF0\nYShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBpbnQgaSkKICAgICAgICBCQ01l\ndGhvZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgibG9hZEltcGxEYXRhIiwg\ndm9pZC5jbGFzcywKICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFT\ndGF0ZU1hbmFnZXIuY2xhc3MsIGludC5jbGFzcyB9KTsKICAgICAgICBtZXRo\nLm1ha2VQcml2YXRlKCk7CiAgICAgICAgQ29kZSBjb2RlID0gbWV0aC5nZXRD\nb2RlKHRydWUpOwoKICAgICAgICBpbnQgY291bnQgPSBjb3VudEltcGxEYXRh\nRmllbGRzKG1ldGEpOwogICAgICAgIEJDRmllbGQgaW1wbCA9IG51bGw7CiAg\nICAgICAgaWYgKGNvdW50ID09IDApCiAgICAgICAgICAgIGNvZGUudnJldHVy\nbigpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBPYmplY3RbXSBm\naWVsZEltcGwKICAgICAgICAgICAgaW1wbCA9IGJjLmRlY2xhcmVGaWVsZCgi\nZmllbGRJbXBsIiwgT2JqZWN0W10uY2xhc3MpOwogICAgICAgICAgICBpbXBs\nLm1ha2VQcml2YXRlKCk7CgogICAgICAgICAgICAvLyBpZiAoZmllbGRJbXBs\nICE9IG51bGwpCiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7\nCiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZChpbXBsKTsK\nICAgICAgICAgICAgSnVtcEluc3RydWN0aW9uIGlmaW5zID0gY29kZS5pZm5v\nbm51bGwoKTsKICAgICAgICAgICAgY29kZS52cmV0dXJuKCk7CgogICAgICAg\nICAgICAvLyBPYmplY3Qgb2JqID0gbnVsbDsKICAgICAgICAgICAgaW50IG9i\naiA9IGNvZGUuZ2V0TmV4dExvY2Fsc0luZGV4KCk7CiAgICAgICAgICAgIGlm\naW5zLnNldFRhcmdldChjb2RlLmNvbnN0YW50KCkuc2V0TnVsbCgpKTsKICAg\nICAgICAgICAgY29kZS5hc3RvcmUoKS5zZXRMb2NhbChvYmopOwoKICAgICAg\nICAgICAgLy8gZXN0YWJsaXNoIHN3aXRjaCB0YXJnZXQsIHRoZW4gbW92ZSBi\nZWZvcmUgaXQKICAgICAgICAgICAgSW5zdHJ1Y3Rpb24gdGFyZ2V0ID0gY29k\nZS5hbG9hZCgpLnNldExvY2FsKG9iaik7CiAgICAgICAgICAgIGNvZGUucHJl\ndmlvdXMoKTsKCiAgICAgICAgICAgIC8vIHN3aXRjaChpKQogICAgICAgICAg\nICBjb2RlLmlsb2FkKCkuc2V0UGFyYW0oMSk7CiAgICAgICAgICAgIExvb2t1\ncFN3aXRjaEluc3RydWN0aW9uIGxzd2l0Y2ggPSBjb2RlLmxvb2t1cHN3aXRj\naCgpOwogICAgICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0gbWV0\nYS5nZXRGaWVsZHMoKTsKICAgICAgICAgICAgaW50IGNhY2hlYWJsZSA9IDA7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoIXVzZXNJbXBsRGF0YShm\naWVsZHNbaV0pKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICAgICAgLy8gY2FzZSB4OiBvYmogPSBmaWVsZEltcGxbeV07IGJy\nZWFrOwogICAgICAgICAgICAgICAgbHN3aXRjaC5hZGRDYXNlKGksIGNvZGUu\nYWxvYWQoKS5zZXRUaGlzKCkpOwogICAgICAgICAgICAgICAgY29kZS5nZXRm\naWVsZCgpLnNldEZpZWxkKGltcGwpOwogICAgICAgICAgICAgICAgY29kZS5j\nb25zdGFudCgpLnNldFZhbHVlKGNhY2hlYWJsZSsrKTsKICAgICAgICAgICAg\nICAgIGNvZGUuYWFsb2FkKCk7CiAgICAgICAgICAgICAgICBjb2RlLmFzdG9y\nZSgpLnNldExvY2FsKG9iaik7CiAgICAgICAgICAgICAgICBjb2RlLmdvMigp\nLnNldFRhcmdldCh0YXJnZXQpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGxzd2l0Y2guc2V0RGVmYXVsdFRhcmdldCh0YXJnZXQpOwoKICAgICAgICAg\nICAgLy8gaWYgKG9iaiAhPSBudWxsKQogICAgICAgICAgICBjb2RlLm5leHQo\nKTsgICAgLy8ganVtcCBiYWNrIG92ZXIgdGFyZ2V0CiAgICAgICAgICAgIGlm\naW5zID0gY29kZS5pZm5vbm51bGwoKTsKICAgICAgICAgICAgY29kZS52cmV0\ndXJuKCk7CgogICAgICAgICAgICAvLyBzbS5zZXRJbXBsRGF0YShpbmRleCwg\naW1wbCk7CiAgICAgICAgICAgIGlmaW5zLnNldFRhcmdldChjb2RlLmFsb2Fk\nKCkuc2V0UGFyYW0oMCkpOwogICAgICAgICAgICBjb2RlLmlsb2FkKCkuc2V0\nUGFyYW0oMSk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChv\nYmopOwogICAgICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1l\ndGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAg\nICAgInNldEltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgICAg\nIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MsIE9iamVjdC5jbGFzcyB9KTsKICAg\nICAgICAgICAgY29kZS52cmV0dXJuKCk7CiAgICAgICAgfQogICAgICAgIGNv\nZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAgICAgICAgY29kZS5jYWxjdWxh\ndGVNYXhTdGFjaygpOwoKICAgICAgICAvLyB2b2lkIHN0b3JlSW1wbERhdGEo\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgaW50IGluZGV4LCBib29sZWFuIGxv\nYWRlZCkKICAgICAgICBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmVJ\nbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1td\neyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBpbnQuY2xhc3MsIGJvb2xl\nYW4uY2xhc3MgfSk7CiAgICAgICAgY29kZSA9IG1ldGguZ2V0Q29kZSh0cnVl\nKTsKICAgICAgICBpZiAoY291bnQgPT0gMCkKICAgICAgICAgICAgY29kZS52\ncmV0dXJuKCk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIGludCBh\ncnJJZHggPSAtMTsKICAgICAgICAgICAgLy8gc3dpdGNoKGluZGV4KQogICAg\nICAgICAgICBpbnQgYXJySWR4ID0gY29kZS5nZXROZXh0TG9jYWxzSW5kZXgo\nKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKC0xKTsK\nICAgICAgICAgICAgY29kZS5pc3RvcmUoKS5zZXRMb2NhbChhcnJJZHgpOwog\nICAgICAgICAgICBjb2RlLmlsb2FkKCkuc2V0UGFyYW0oMSk7CiAgICAgICAg\nICAgIExvb2t1cFN3aXRjaEluc3RydWN0aW9uIGxzd2l0Y2ggPSBjb2RlLmxv\nb2t1cHN3aXRjaCgpOwoKICAgICAgICAgICAgLy8gZXN0YWJsaXNoIHN3aXRj\naCB0YXJnZXQsIHRoZW4gbW92ZSBiZWZvcmUgaXQKICAgICAgICAgICAgSW5z\ndHJ1Y3Rpb24gc3dpdGNoVGFyZ2V0ID0gY29kZS5pbG9hZCgpLnNldExvY2Fs\nKGFycklkeCk7CiAgICAgICAgICAgIGNvZGUucHJldmlvdXMoKTsKCiAgICAg\nICAgICAgIEZpZWxkTWV0YURhdGFbXSBmaWVsZHMgPSBtZXRhLmdldEZpZWxk\ncygpOwogICAgICAgICAgICBpbnQgY2FjaGVhYmxlID0gMDsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgICAgIGlmICghdXNlc0ltcGxEYXRhKGZpZWxkc1tpXSkp\nCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAg\nICAvLyBjYXNlIHg6IGFycklkeCA9IHk7IGJyZWFrOwogICAgICAgICAgICAg\nICAgbHN3aXRjaC5hZGRDYXNlKGksIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1\nZShjYWNoZWFibGUrKykpOwogICAgICAgICAgICAgICAgY29kZS5pc3RvcmUo\nKS5zZXRMb2NhbChhcnJJZHgpOwogICAgICAgICAgICAgICAgY29kZS5nbzIo\nKS5zZXRUYXJnZXQoc3dpdGNoVGFyZ2V0KTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBsc3dpdGNoLnNldERlZmF1bHRUYXJnZXQoc3dpdGNoVGFyZ2V0\nKTsKICAgICAgICAgICAgY29kZS5uZXh0KCk7ICAgIC8vIHN0ZXAgb3ZlciBz\nd2l0Y2ggdGFyZ2V0CgogICAgICAgICAgICAvLyBpZiAoYXJySWR4ICE9IC0x\nKQogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoLTEpOwog\nICAgICAgICAgICBKdW1wSW5zdHJ1Y3Rpb24gaWZpbnMgPSBjb2RlLmlmaWNt\ncG5lKCk7CiAgICAgICAgICAgIGNvZGUudnJldHVybigpOwoKICAgICAgICAg\nICAgLy8gY3JlYXRlIG51bGwgdGFyZ2V0LCB0aGVuIG1vdmUgYmVmb3JlIGl0\nCiAgICAgICAgICAgIEluc3RydWN0aW9uIG51bGxUYXJnZXQgPSBjb2RlLmFs\nb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLnByZXZpb3VzKCk7\nCgogICAgICAgICAgICAvLyBpZiAobG9hZGVkKQogICAgICAgICAgICBpZmlu\ncy5zZXRUYXJnZXQoY29kZS5pbG9hZCgpLnNldFBhcmFtKDIpKTsKICAgICAg\nICAgICAgY29kZS5pZmVxKCkuc2V0VGFyZ2V0KG51bGxUYXJnZXQpOwoKICAg\nICAgICAgICAgLy8gT2JqZWN0IG9iaiA9IHNtLmdldEltcGxEYXRhKGluZGV4\nKQogICAgICAgICAgICBpbnQgb2JqID0gY29kZS5nZXROZXh0TG9jYWxzSW5k\nZXgoKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwog\nICAgICAgICAgICBjb2RlLmlsb2FkKCkuc2V0UGFyYW0oMSk7CiAgICAgICAg\nICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFT\ndGF0ZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAiZ2V0SW1wbERh\ndGEiLCBPYmplY3QuY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7\nCiAgICAgICAgICAgIGNvZGUuYXN0b3JlKCkuc2V0TG9jYWwob2JqKTsKCiAg\nICAgICAgICAgIC8vIGlmIChvYmogIT0gbnVsbCkKICAgICAgICAgICAgY29k\nZS5hbG9hZCgpLnNldExvY2FsKG9iaik7CiAgICAgICAgICAgIGNvZGUuaWZu\ndWxsKCkuc2V0VGFyZ2V0KG51bGxUYXJnZXQpOwoKICAgICAgICAgICAgLy8g\naWYgKGZpZWxkSW1wbCA9PSBudWxsKQogICAgICAgICAgICAvLyAJCWZpZWxk\nSW1wbCA9IG5ldyBPYmplY3RbZmllbGRzXTsKICAgICAgICAgICAgY29kZS5h\nbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICAgICAgY29kZS5nZXRmaWVsZCgp\nLnNldEZpZWxkKGltcGwpOwogICAgICAgICAgICBpZmlucyA9IGNvZGUuaWZu\nb25udWxsKCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7\nCiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShjb3VudCk7\nCiAgICAgICAgICAgIGNvZGUuYW5ld2FycmF5KCkuc2V0VHlwZShPYmplY3Qu\nY2xhc3MpOwogICAgICAgICAgICBjb2RlLnB1dGZpZWxkKCkuc2V0RmllbGQo\naW1wbCk7CgogICAgICAgICAgICAvLyBmaWVsZEltcGxbYXJySWR4XSA9IG9i\najsKICAgICAgICAgICAgLy8gcmV0dXJuOwogICAgICAgICAgICBpZmlucy5z\nZXRUYXJnZXQoY29kZS5hbG9hZCgpLnNldFRoaXMoKSk7CiAgICAgICAgICAg\nIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZChpbXBsKTsKICAgICAgICAgICAg\nY29kZS5pbG9hZCgpLnNldExvY2FsKGFycklkeCk7CiAgICAgICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRMb2NhbChvYmopOwogICAgICAgICAgICBjb2RlLmFh\nc3RvcmUoKTsKICAgICAgICAgICAgY29kZS52cmV0dXJuKCk7CgogICAgICAg\nICAgICAvLyBpZiAoZmllbGRJbXBsICE9IG51bGwpCiAgICAgICAgICAgIC8v\nIAkJZmllbGRJbXBsW2luZGV4XSA9IG51bGw7CiAgICAgICAgICAgIGNvZGUu\nbmV4dCgpOyAvLyBzdGVwIG92ZXIgbnVsbFRhcmdldAogICAgICAgICAgICBj\nb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoaW1wbCk7CiAgICAgICAgICAgIGlm\naW5zID0gY29kZS5pZm5vbm51bGwoKTsKICAgICAgICAgICAgY29kZS52cmV0\ndXJuKCk7CiAgICAgICAgICAgIGlmaW5zLnNldFRhcmdldChjb2RlLmFsb2Fk\nKCkuc2V0VGhpcygpKTsKICAgICAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNl\ndEZpZWxkKGltcGwpOwogICAgICAgICAgICBjb2RlLmlsb2FkKCkuc2V0TG9j\nYWwoYXJySWR4KTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldE51\nbGwoKTsKICAgICAgICAgICAgY29kZS5hYXN0b3JlKCk7CiAgICAgICAgICAg\nIGNvZGUudnJldHVybigpOwogICAgICAgIH0KICAgICAgICBjb2RlLmNhbGN1\nbGF0ZU1heFN0YWNrKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2Nh\nbHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBtZXRob2RzIGZvciBs\nb2FkaW5nIGFuZCBzdG9yaW5nIHZlcnNpb24gZGF0YS4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgYWRkVmVyc2lvbk1ldGhvZHMoQkNDbGFzcyBiYykg\newogICAgICAgIC8vIHZvaWQgc3RvcmVWZXJzaW9uKE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20pOwogICAgICAgIGFkZEJlYW5GaWVsZChiYywgInZlcnNpb24i\nLCBPYmplY3QuY2xhc3MpOwogICAgICAgIEJDTWV0aG9kIG1ldGggPSBiYy5k\nZWNsYXJlTWV0aG9kKCJzdG9yZVZlcnNpb24iLCB2b2lkLmNsYXNzLAogICAg\nICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFz\ncyB9KTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1ZSk7\nCgogICAgICAgIC8vIHZlcnNpb24gPSBzbS5nZXRWZXJzaW9uKCk7CiAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2Fk\nKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2Uo\nKQogICAgICAgICAgICAuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIu\nY2xhc3MsICJnZXRWZXJzaW9uIiwKICAgICAgICAgICAgICAgIE9iamVjdC5j\nbGFzcywgbnVsbCk7CiAgICAgICAgY29kZS5wdXRmaWVsZCgpLnNldEZpZWxk\nKCJ2ZXJzaW9uIiwgT2JqZWN0LmNsYXNzKTsKICAgICAgICBjb2RlLnZyZXR1\ncm4oKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAg\nICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKCiAgICAgICAgLy8gdm9p\nZCBsb2FkVmVyc2lvbihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKQogICAgICAg\nIG1ldGggPSBiYy5kZWNsYXJlTWV0aG9kKCJsb2FkVmVyc2lvbiIsIHZvaWQu\nY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVN\nYW5hZ2VyLmNsYXNzIH0pOwogICAgICAgIGNvZGUgPSBtZXRoLmdldENvZGUo\ndHJ1ZSk7CgogICAgICAgIC8vIGlmIChzbS5nZXRWZXJzaW9uKCkgPT0gbnVs\nbCkKICAgICAgICAvLyAJCXNtLnNldFZlcnNpb24odmVyc2lvbik7CiAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgIGNvZGUuaW52\nb2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIu\nY2xhc3MsCiAgICAgICAgICAgICJnZXRWZXJzaW9uIiwgT2JqZWN0LmNsYXNz\nLCBudWxsKTsKICAgICAgICBKdW1wSW5zdHJ1Y3Rpb24gaWZpbnMgPSBjb2Rl\nLmlmbm9ubnVsbCgpOwogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgw\nKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgIGNv\nZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgidmVyc2lvbiIsIE9iamVjdC5jbGFz\ncyk7CiAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKQogICAgICAgICAg\nICAuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3MsICJzZXRW\nZXJzaW9uIiwKICAgICAgICAgICAgICAgIHZvaWQuY2xhc3MsIG5ldyBDbGFz\nc1tdeyBPYmplY3QuY2xhc3MgfSk7CiAgICAgICAgaWZpbnMuc2V0VGFyZ2V0\nKGNvZGUudnJldHVybigpKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0\nYWNrKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgYWRkTG9hZE1ldGhvZChCQ0NsYXNzIGJj\nLCBDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICAvLyBwdWJsaWMgdm9p\nZCBsb2FkKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCwKICAgICAgICAvLyAJCU9iamVjdCBjb250ZXh0KQogICAg\nICAgIENvZGUgY29kZSA9IGFkZExvYWRNZXRob2QoYmMsIGZhbHNlKTsKICAg\nICAgICBGaWVsZE1ldGFEYXRhW10gZm1kcyA9IG1ldGEuZ2V0RmllbGRzKCk7\nCiAgICAgICAgQ29sbGVjdGlvbiBqdW1wcyA9IG5ldyBMaW5rZWRMaXN0KCk7\nCiAgICAgICAgQ29sbGVjdGlvbiBqdW1wczI7CgkJCiAgICAgICAgaW50IGxv\nY2FsID0gY29kZS5nZXROZXh0TG9jYWxzSW5kZXgoKTsKICAgICAgICBjb2Rl\nLmNvbnN0YW50KCkuc2V0TnVsbCgpOwogICAgICAgIGNvZGUuYXN0b3JlKCku\nc2V0TG9jYWwobG9jYWwpOwogICAgICAgIGludCBpbnRlciA9IGNvZGUuZ2V0\nTmV4dExvY2Fsc0luZGV4KCk7CiAgICAgICAgY29kZS5jb25zdGFudCgpLnNl\ndE51bGwoKTsKICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGludGVy\nKTsKCiAgICAgICAgaW50IG9iamVjdENvdW50ID0gMDsKICAgICAgICBib29s\nZWFuIGludGVybWVkaWF0ZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGZtZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAganVtcHMyID0gbmV3\nIExpbmtlZExpc3QoKTsKICAgICAgICAgICAgaW50ZXJtZWRpYXRlID0gdXNl\nc0ludGVybWVkaWF0ZShmbWRzW2ldKTsKICAgICAgICAgICAgc2V0VGFyZ2V0\nKGNvZGUuYWxvYWQoKS5zZXRUaGlzKCksIGp1bXBzKTsKICAgICAgICAgICAg\nLy8gaWYgKGxvYWRlZC5nZXQoaSkpIG9yICghbG9hZGVkLmdldChpKSkgZGVw\nZW5kaW5nIG9uIGludGVyIHJlc3AKICAgICAgICAgICAgY29kZS5nZXRmaWVs\nZCgpLnNldEZpZWxkKCJsb2FkZWQiLCBCaXRTZXQuY2xhc3MpOwogICAgICAg\nICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAgICAg\nIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xhc3Ms\nICJnZXQiLAogICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENs\nYXNzW117IGludC5jbGFzcyB9KTsKICAgICAgICAgICAganVtcHMuYWRkKGNv\nZGUuaWZuZSgpKTsKCiAgICAgICAgICAgIGlmIChpbnRlcm1lZGlhdGUpCiAg\nICAgICAgICAgICAgICBhZGRMb2FkSW50ZXJtZWRpYXRlKGNvZGUsIGksIG9i\namVjdENvdW50LCBqdW1wczIsIGludGVyKTsKICAgICAgICAgICAganVtcHMy\nLmFkZChjb2RlLmdvMigpKTsKCiAgICAgICAgICAgIC8vIGlmIChmZXRjaC5y\nZXF1aXJlc0ZldGNoKGZtZHNbaV0pKQogICAgICAgICAgICBzZXRUYXJnZXQo\nY29kZS5hbG9hZCgpLnNldFBhcmFtKDEpLCBqdW1wcyk7CiAgICAgICAgICAg\nIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5p\nbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdl\nci5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRNZXRhRGF0YSIsIENsYXNz\nTWV0YURhdGEuY2xhc3MsIG51bGwpOwogICAgICAgICAgICBjb2RlLmNvbnN0\nYW50KCkuc2V0VmFsdWUoZm1kc1tpXS5nZXRJbmRleCgpKTsKICAgICAgICAg\nICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKENsYXNzTWV0YURh\ndGEuY2xhc3MsCiAgICAgICAgICAgICAgICAiZ2V0RmllbGQiLCBGaWVsZE1l\ndGFEYXRhLmNsYXNzLCBuZXcgQ2xhc3NbXXtpbnQuY2xhc3N9KTsKICAgICAg\nICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QgKEZldGNo\nQ29uZmlndXJhdGlvbi5jbGFzcywgCiAgICAgICAgICAgICAgICAicmVxdWly\nZXNGZXRjaCIsIGJvb2xlYW4uY2xhc3MsIAogICAgICAgICAgICAgICAgbmV3\nIENsYXNzW117RmllbGRNZXRhRGF0YS5jbGFzc30pOwogICAgICAgICAgICBq\ndW1wczIuYWRkKGNvZGUuaWZlcSgpKTsKICAgICAgICAgICAgYWRkTG9hZChi\nYywgY29kZSwgZm1kc1tpXSwgb2JqZWN0Q291bnQsIGxvY2FsLCBmYWxzZSk7\nCgogICAgICAgICAgICBqdW1wcyA9IGp1bXBzMjsKICAgICAgICAgICAgaWYg\nKHJlcGxhY2VUeXBlKGZtZHNbaV0pID49IEphdmFUeXBlcy5PQkpFQ1QpCiAg\nICAgICAgICAgICAgICBvYmplY3RDb3VudCsrOwogICAgICAgIH0KICAgICAg\nICBzZXRUYXJnZXQoY29kZS52cmV0dXJuKCksIGp1bXBzKTsKICAgICAgICBj\nb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAgICAgY29kZS5jYWxjdWxh\ndGVNYXhMb2NhbHMoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRkTG9h\nZFdpdGhGaWVsZHNNZXRob2QoQkNDbGFzcyBiYywgQ2xhc3NNZXRhRGF0YSBt\nZXRhKSB7CiAgICAgICAgQ29kZSBjb2RlID0gYWRkTG9hZE1ldGhvZChiYywg\ndHJ1ZSk7CiAgICAgICAgLy8gcHVibGljIHZvaWQgbG9hZChPcGVuSlBBU3Rh\ndGVNYW5hZ2VyIHNtLCBCaXRTZXQgZmllbGRzLAogICAgICAgIC8vIAkJRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoLCBPYmplY3QgY29ubikKICAgICAgICBG\naWVsZE1ldGFEYXRhW10gZm1kcyA9IG1ldGEuZ2V0RmllbGRzKCk7CiAgICAg\nICAgQ29sbGVjdGlvbiBqdW1wcyA9IG5ldyBMaW5rZWRMaXN0KCk7CiAgICAg\nICAgQ29sbGVjdGlvbiBqdW1wczI7CiAgICAgICAgaW50IG9iamVjdENvdW50\nID0gMDsKICAgICAgICBib29sZWFuIGludGVybWVkaWF0ZTsKICAgICAgICBp\nbnQgbG9jYWwgPSBjb2RlLmdldE5leHRMb2NhbHNJbmRleCgpOwogICAgICAg\nIGNvZGUuY29uc3RhbnQoKS5zZXROdWxsKCk7CiAgICAgICAgY29kZS5hc3Rv\ncmUoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgaW50IGludGVyID0gY29k\nZS5nZXROZXh0TG9jYWxzSW5kZXgoKTsKICAgICAgICBjb2RlLmNvbnN0YW50\nKCkuc2V0TnVsbCgpOwogICAgICAgIGNvZGUuYXN0b3JlKCkuc2V0TG9jYWwo\naW50ZXIpOwoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAganVtcHMyID0gbmV3IExpbmtlZExp\nc3QoKTsKICAgICAgICAgICAgaW50ZXJtZWRpYXRlID0gdXNlc0ludGVybWVk\naWF0ZShmbWRzW2ldKTsKICAgICAgICAgICAgLy8gaWYgKGZpZWxkcy5nZXQo\naSkpCiAgICAgICAgICAgIC8vIHsKICAgICAgICAgICAgLy8gCQlpZiAobG9h\nZGVkLmdldChpKSkKICAgICAgICAgICAgc2V0VGFyZ2V0KGNvZGUuYWxvYWQo\nKS5zZXRQYXJhbSgxKSwganVtcHMpOwogICAgICAgICAgICBjb2RlLmNvbnN0\nYW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAgICAgIGNvZGUuaW52b2tldmly\ndHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICJnZXQiLAogICAgICAg\nICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNzW117IGludC5jbGFz\ncyB9KTsKICAgICAgICAgICAganVtcHMyLmFkZChjb2RlLmlmZXEoKSk7CiAg\nICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAg\nIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNs\nYXNzKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkp\nOwogICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2Qo\nQml0U2V0LmNsYXNzLCAiZ2V0IiwKICAgICAgICAgICAgICAgIGJvb2xlYW4u\nY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAg\nIGlmIChpbnRlcm1lZGlhdGUpCiAgICAgICAgICAgICAgICBqdW1wcy5hZGQo\nY29kZS5pZmVxKCkpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICBqdW1wczIuYWRkKGNvZGUuaWZlcSgpKTsKCiAgICAgICAgICAgIGFkZExv\nYWQoYmMsIGNvZGUsIGZtZHNbaV0sIG9iamVjdENvdW50LCBsb2NhbCwgdHJ1\nZSk7CiAgICAgICAgICAgIGlmICh1c2VzSW1wbERhdGEoZm1kc1tpXSkpIHsK\nICAgICAgICAgICAgICAgIC8vIGxvYWRJbXBsRGF0YShzbSwgaSk7CiAgICAg\nICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAg\nICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICAg\nICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAgICAgICAgICAg\nICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJsb2FkSW1wbERh\ndGEiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICAgICAgICAgIG5ldyBDbGFz\nc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBpbnQuY2xhc3MgfSk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGZpZWxkcy5jbGVhcihp\nKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDEpOwogICAg\nICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAg\nICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xh\nc3MsICJjbGVhciIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgICAgICBuZXcg\nQ2xhc3NbXSB7IGludC5jbGFzcyB9KTsKCiAgICAgICAgICAgIGp1bXBzMi5h\nZGQoY29kZS5nbzIoKSk7CgogICAgICAgICAgICBpZiAoaW50ZXJtZWRpYXRl\nKQogICAgICAgICAgICAgICAgc2V0VGFyZ2V0KGFkZExvYWRJbnRlcm1lZGlh\ndGUKICAgICAgICAgICAgICAgICAgICAoY29kZSwgaSwgb2JqZWN0Q291bnQs\nIGp1bXBzMiwgaW50ZXIpLCBqdW1wcyk7CgogICAgICAgICAgICBqdW1wcyA9\nIGp1bXBzMjsKICAgICAgICAgICAgaWYgKHJlcGxhY2VUeXBlKGZtZHNbaV0p\nID49IEphdmFUeXBlcy5PQkpFQ1QpCiAgICAgICAgICAgICAgICBvYmplY3RD\nb3VudCsrOwogICAgICAgIH0KICAgICAgICBzZXRUYXJnZXQoY29kZS52cmV0\ndXJuKCksIGp1bXBzKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNr\nKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIERlY2xhcmUgYW5kIHN0YXJ0IHRoZSBiYXNlIGxv\nYWQgbWV0aG9kLgogICAgICovCiAgICBwcml2YXRlIENvZGUgYWRkTG9hZE1l\ndGhvZChCQ0NsYXNzIGJjLCBib29sZWFuIGZpZWxkcykgewogICAgICAgIENs\nYXNzW10gYXJncyA9IG51bGw7CiAgICAgICAgaWYgKGZpZWxkcykKICAgICAg\nICAgICAgYXJncyA9IG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2Vy\nLmNsYXNzLCBCaXRTZXQuY2xhc3MsCiAgICAgICAgICAgICAgICBGZXRjaENv\nbmZpZ3VyYXRpb24uY2xhc3MsIE9iamVjdC5jbGFzcyB9OwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgYXJncyA9IG5ldyBDbGFzc1tdeyBPcGVuSlBBU3Rh\ndGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgRmV0Y2hDb25maWd1\ncmF0aW9uLmNsYXNzLCBPYmplY3QuY2xhc3MgfTsKICAgICAgICBCQ01ldGhv\nZCBsb2FkID0gYmMuZGVjbGFyZU1ldGhvZCgibG9hZCIsIHZvaWQuY2xhc3Ms\nIGFyZ3MpOwogICAgICAgIENvZGUgY29kZSA9IGxvYWQuZ2V0Q29kZSh0cnVl\nKTsKCiAgICAgICAgLy9sb2FkVmVyc2lvbihzbSk7CiAgICAgICAgY29kZS5h\nbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFy\nYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9k\nKCJsb2FkVmVyc2lvbiIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgIG5ldyBD\nbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzIH0pOwoKICAgICAg\nICAvL2xvYWRJbXBsRGF0YShzbSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNl\ndFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAg\nICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJsb2FkSW1w\nbERhdGEiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsg\nT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcyB9KTsKICAgICAgICByZXR1cm4g\nY29kZTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZmllbGQgbG9h\nZC4KICAgICAqLwogICAgcHJpdmF0ZSBJbnN0cnVjdGlvbiBhZGRMb2FkKEJD\nQ2xhc3MgYmMsIENvZGUgY29kZSwgRmllbGRNZXRhRGF0YSBmbWQsCiAgICAg\nICAgaW50IG9iamVjdENvdW50LCBpbnQgbG9jYWwsIGJvb2xlYW4gZmllbGRz\nKSB7CiAgICAgICAgaW50IGluZGV4ID0gZm1kLmdldEluZGV4KCk7CiAgICAg\nICAgaW50IHR5cGVDb2RlID0gcmVwbGFjZVR5cGUoZm1kKTsKICAgICAgICBJ\nbnN0cnVjdGlvbiBmaXJzdDsKICAgICAgICBpZiAodHlwZUNvZGUgPCBKYXZh\nVHlwZXMuT0JKRUNUKSB7CiAgICAgICAgICAgIC8vIHNtLnN0b3JlPHR5cGU+\nKGksIGZpZWxkPGk+KQogICAgICAgICAgICBDbGFzcyB0eXBlID0gZm9yVHlw\nZShmbWQuZ2V0VHlwZUNvZGUoKSk7CiAgICAgICAgICAgIGZpcnN0ID0gY29k\nZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICBjb2RlLmNvbnN0\nYW50KCkuc2V0VmFsdWUoaW5kZXgpOwogICAgICAgICAgICBjb2RlLmFsb2Fk\nKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0\nRmllbGQoZ2V0RmllbGROYW1lKGluZGV4KSwgdHlwZSk7CiAgICAgICAgICAg\nIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0\nZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAic3RvcmUiICsgU3Ry\naW5nVXRpbHMuY2FwaXRhbGl6ZSh0eXBlLmdldE5hbWUoKSksCiAgICAgICAg\nICAgICAgICB2b2lkLmNsYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCB0\neXBlIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGZtZCA9\nIHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoaSk7CiAgICAgICAgICAgIGlu\ndCBvZmZzZXQgPSBmaWVsZHMgPyAxIDogMDsKICAgICAgICAgICAgZmlyc3Qg\nPSBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAgIGNvZGUu\naW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFn\nZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAiZ2V0TWV0YURhdGEiLCBDbGFz\nc01ldGFEYXRhLmNsYXNzLCBudWxsKTsKICAgICAgICAgICAgY29kZS5jb25z\ndGFudCgpLnNldFZhbHVlKGZtZC5nZXRJbmRleCgpKTsKICAgICAgICAgICAg\nY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKENsYXNzTWV0YURhdGEu\nY2xhc3MsICJnZXRGaWVsZCIsCiAgICAgICAgICAgICAgICBGaWVsZE1ldGFE\nYXRhLmNsYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAg\nICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGxvY2FsKTsKICAgICAgICAg\nICAgLy8gc20uc3RvcmVGaWVsZChpLCB0b0ZpZWxkKHNtLCBmbWQsIG9iamVj\ndHNbb2JqZWN0Q291bnRdLAogICAgICAgICAgICAvLyAJCWZldGNoLCBjb250\nZXh0KTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwog\nICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwog\nICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAg\nICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAgIGNvZGUu\nYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNvZGUuYWxv\nYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5z\nZXRGaWVsZCgib2JqZWN0cyIsIE9iamVjdFtdLmNsYXNzKTsKICAgICAgICAg\nICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKG9iamVjdENvdW50KTsKICAg\nICAgICAgICAgY29kZS5hYWxvYWQoKTsKICAgICAgICAgICAgY29kZS5hbG9h\nZCgpLnNldFBhcmFtKDEgKyBvZmZzZXQpOwogICAgICAgICAgICBjb2RlLmFs\nb2FkKCkuc2V0UGFyYW0oMiArIG9mZnNldCk7CiAgICAgICAgICAgIGNvZGUu\naW52b2tldmlydHVhbCgpLnNldE1ldGhvZChiYy5nZXROYW1lKCksICJ0b0Zp\nZWxkIiwKICAgICAgICAgICAgICAgIE9iamVjdC5jbGFzcy5nZXROYW1lKCks\nIHRvU3RyaW5ncyhuZXcgQ2xhc3NbXXsgCiAgICAgICAgICAgICAgICBPcGVu\nSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBGaWVsZE1ldGFEYXRhLmNsYXNzLAog\nICAgICAgICAgICAgICAgT2JqZWN0LmNsYXNzLCBGZXRjaENvbmZpZ3VyYXRp\nb24uY2xhc3MsIE9iamVjdC5jbGFzcyB9KSk7CiAgICAgICAgICAgIGNvZGUu\naW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFn\nZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAic3RvcmVGaWVsZCIsIHZvaWQu\nY2xhc3MsCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNz\nLCBPYmplY3QuY2xhc3MgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBm\naXJzdDsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgaW50ZXJtZWRpYXRl\nIGRhdGEgaWYgcG9zc2libGUuCiAgICAgKi8KICAgIHByaXZhdGUgSW5zdHJ1\nY3Rpb24gYWRkTG9hZEludGVybWVkaWF0ZShDb2RlIGNvZGUsIGludCBpbmRl\neCwKICAgICAgICBpbnQgb2JqZWN0Q291bnQsIENvbGxlY3Rpb24ganVtcHMy\nLCBpbnQgaW50ZXIpIHsKICAgICAgICAvLyB7CiAgICAgICAgLy8gCQlPYmpl\nY3QgaW50ZXIgPSBvYmplY3RzW29iamVjdENvdW50XTsKICAgICAgICBJbnN0\ncnVjdGlvbiBmaXJzdCA9IGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAg\nICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJvYmplY3RzIiwgT2JqZWN0\nW10uY2xhc3MpOwogICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShv\nYmplY3RDb3VudCk7CiAgICAgICAgY29kZS5hYWxvYWQoKTsKICAgICAgICBj\nb2RlLmFzdG9yZSgpLnNldExvY2FsKGludGVyKTsKICAgICAgICAvLyAJCWlm\nIChpbnRlciAhPSBudWxsICYmICFzbS5nZXRMb2FkZWQoKS5nZXQoaW5kZXgp\nKQogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChpbnRlcik7CiAgICAg\nICAganVtcHMyLmFkZChjb2RlLmlmbnVsbCgpKTsKICAgICAgICBjb2RlLmFs\nb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2VpbnRlcmZh\nY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAg\nICAgICAgICAgImdldExvYWRlZCIsIEJpdFNldC5jbGFzcywgbnVsbCk7CiAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4KTsKICAgICAg\nICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0LmNsYXNz\nLCAiZ2V0IiwKICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNz\nW117IGludC5jbGFzcyB9KTsKICAgICAgICBqdW1wczIuYWRkKGNvZGUuaWZu\nZSgpKTsKICAgICAgICAvLwkJCXNtLnNldEludGVybWVkaWF0ZShpbmRleCwg\naW50ZXIpOwogICAgICAgIC8vCX0gIC8vIGVuZCBlbHNlCiAgICAgICAgY29k\nZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgIGNvZGUuY29uc3RhbnQo\nKS5zZXRWYWx1ZShpbmRleCk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldExv\nY2FsKGludGVyKTsKICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNl\ndE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAg\nICAic2V0SW50ZXJtZWRpYXRlIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAg\nbmV3IENsYXNzW117IGludC5jbGFzcywgT2JqZWN0LmNsYXNzIH0pOwogICAg\nICAgIHJldHVybiBmaXJzdDsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRk\nU3RvcmVNZXRob2RzKEJDQ2xhc3MgYmMsIENsYXNzTWV0YURhdGEgbWV0YSkg\newogICAgICAgIC8vIGkuZS4gdm9pZCBzdG9yZShPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBCaXRTZXQgZmllbGRzKTsKICAgICAgICBhZGRTdG9yZU1ldGhv\nZChiYywgbWV0YSwgdHJ1ZSk7CiAgICAgICAgLy8gaS5lLiB2b2lkIHN0b3Jl\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pOwogICAgICAgIGFkZFN0b3JlTWV0\naG9kKGJjLCBtZXRhLCBmYWxzZSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIGFkZFN0b3JlTWV0aG9kKEJDQ2xhc3MgYmMsIENsYXNzTWV0YURhdGEgbWV0\nYSwKICAgICAgICBib29sZWFuIGZpZWxkcykgewogICAgICAgIEJDTWV0aG9k\nIHN0b3JlOwogICAgICAgIGlmIChmaWVsZHMpCiAgICAgICAgICAgIHN0b3Jl\nID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmUiLCB2b2lkLmNsYXNzLAogICAg\nICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIu\nY2xhc3MsIEJpdFNldC5jbGFzcyB9KTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIHN0b3JlID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmUiLCB2b2lkLmNs\nYXNzLAogICAgICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0\nZU1hbmFnZXIuY2xhc3MgfSk7CiAgICAgICAgQ29kZSBjb2RlID0gc3RvcmUu\nZ2V0Q29kZSh0cnVlKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6ZSgpOwogICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgY29kZS5pbnZv\na2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJpbml0aWFsaXplIiwgdm9pZC5jbGFz\ncywgbnVsbCk7CgogICAgICAgIC8vIHN0b3JlVmVyc2lvbihzbSk7CiAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2Fk\nKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCku\nc2V0TWV0aG9kKCJzdG9yZVZlcnNpb24iLCB2b2lkLmNsYXNzLAogICAgICAg\nICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcyB9\nKTsKCiAgICAgICAgLy8gc3RvcmVJbXBsRGF0YShzbSk7CiAgICAgICAgY29k\nZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0\nUGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0\naG9kKCJzdG9yZUltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAg\nbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3MgfSk7Cgog\nICAgICAgIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gbWV0YS5nZXRGaWVsZHMo\nKTsKICAgICAgICBDb2xsZWN0aW9uIGp1bXBzID0gbmV3IExpbmtlZExpc3Qo\nKTsKICAgICAgICBpbnQgb2JqZWN0Q291bnQgPSAwOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgZm1kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAoZmllbGRzKSB7CiAgICAgICAgICAgICAgICAvLyAgaWYgKGZpZWxk\ncyAhPSBudWxsICYmIGZpZWxkcy5nZXQoaW5kZXgpKQogICAgICAgICAgICAg\nICAgc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgxKSwganVtcHMp\nOwogICAgICAgICAgICAgICAganVtcHMuYWRkKGNvZGUuaWZudWxsKCkpOwog\nICAgICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDEpOwogICAg\nICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAg\nICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJp\ndFNldC5jbGFzcywgImdldCIsCiAgICAgICAgICAgICAgICAgICAgYm9vbGVh\nbi5jbGFzcywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsKICAgICAgICAg\nICAgICAgIGp1bXBzLmFkZChjb2RlLmlmZXEoKSk7CiAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBpZiAoc20uZ2V0TG9hZGVkKCku\nZ2V0KGluZGV4KSkpCiAgICAgICAgICAgICAgICBzZXRUYXJnZXQoY29kZS5h\nbG9hZCgpLnNldFBhcmFtKDApLCBqdW1wcyk7CiAgICAgICAgICAgICAgICBj\nb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVN\nYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgICAgICJnZXRMb2FkZWQi\nLCBCaXRTZXQuY2xhc3MsIG51bGwpOwogICAgICAgICAgICAgICAgY29kZS5j\nb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAgICAgICAgICAgICAgY29kZS5p\nbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgImdldCIs\nCiAgICAgICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNz\nW117IGludC5jbGFzcyB9KTsKICAgICAgICAgICAgICAgIGp1bXBzLmFkZChj\nb2RlLmlmZXEoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWRkU3Rv\ncmUoYmMsIGNvZGUsIGZtZHNbaV0sIG9iamVjdENvdW50KTsKICAgICAgICAg\nICAgaWYgKHVzZXNJbnRlcm1lZGlhdGUoZm1kc1tpXSkpIHsKICAgICAgICAg\nICAgICAgIEp1bXBJbnN0cnVjdGlvbiBlbHNlSW5zID0gY29kZS5nbzIoKTsK\nICAgICAgICAgICAgICAgIC8vIGVsc2UgaWYgKCFsb2FkZWQuZ2V0KGluZGV4\nKSkKICAgICAgICAgICAgICAgIHNldFRhcmdldChjb2RlLmFsb2FkKCkuc2V0\nVGhpcygpLCBqdW1wcyk7CiAgICAgICAgICAgICAgICBqdW1wcy5hZGQoZWxz\nZUlucyk7CiAgICAgICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0Rmll\nbGQoImxvYWRlZCIsIEJpdFNldC5jbGFzcyk7CiAgICAgICAgICAgICAgICBj\nb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAgICAgICAgICBj\nb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0LmNsYXNzLCAi\nZ2V0IiwKICAgICAgICAgICAgICAgICAgICBib29sZWFuLmNsYXNzLCBuZXcg\nQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgICAgICAgICAganVtcHMu\nYWRkKGNvZGUuaWZuZSgpKTsKICAgICAgICAgICAgICAgIC8vIE9iamVjdCB2\nYWwgPSBzbS5nZXRJbnRlcm1lZGlhdGUoaW5kZXgpOwogICAgICAgICAgICAg\nICAgLy8gaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICAgICAgLy8gCQlv\nYmplY3RzW29iamVjdENvdW50XSA9IHZhbDsKICAgICAgICAgICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgICAgIGNvZGUu\nY29uc3RhbnQoKS5zZXRWYWx1ZShpKTsKICAgICAgICAgICAgICAgIGNvZGUu\naW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFn\nZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAgICAgImdldEludGVybWVkaWF0\nZSIsIE9iamVjdC5jbGFzcywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsK\nICAgICAgICAgICAgICAgIGludCBsb2NhbCA9IGNvZGUuZ2V0TmV4dExvY2Fs\nc0luZGV4KCk7CiAgICAgICAgICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExv\nY2FsKGxvY2FsKTsKICAgICAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRM\nb2NhbChsb2NhbCk7CiAgICAgICAgICAgICAgICBqdW1wcy5hZGQoY29kZS5p\nZm51bGwoKSk7CiAgICAgICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhp\ncygpOwogICAgICAgICAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxk\nKCJvYmplY3RzIiwgT2JqZWN0W10uY2xhc3MpOwogICAgICAgICAgICAgICAg\nY29kZS5jb25zdGFudCgpLnNldFZhbHVlKG9iamVjdENvdW50KTsKICAgICAg\nICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAg\nICAgICAgICAgICBjb2RlLmFhc3RvcmUoKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAocmVwbGFjZVR5cGUoZm1kc1tpXSkgPj0gSmF2YVR5cGVz\nLk9CSkVDVCkKICAgICAgICAgICAgICAgIG9iamVjdENvdW50Kys7CiAgICAg\nICAgfQogICAgICAgIHNldFRhcmdldChjb2RlLnZyZXR1cm4oKSwganVtcHMp\nOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAgICAgICAg\nY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBhZGRTdG9yZShCQ0NsYXNzIGJjLCBDb2RlIGNvZGUsIEZpZWxkTWV0\nYURhdGEgZm1kLAogICAgICAgIGludCBvYmplY3RDb3VudCkgewogICAgICAg\nIGludCB0eXBlQ29kZSA9IHJlcGxhY2VUeXBlKGZtZCk7CiAgICAgICAgaW50\nIGluZGV4ID0gZm1kLmdldEluZGV4KCk7CiAgICAgICAgaWYgKHR5cGVDb2Rl\nIDwgSmF2YVR5cGVzLk9CSkVDVCkgewogICAgICAgICAgICBDbGFzcyB0eXBl\nID0gZm9yVHlwZSh0eXBlQ29kZSk7CiAgICAgICAgICAgIC8vIGZpZWxkPGk+\nID0gc20uZmV0Y2g8VHlwZT4oaW5kZXgpCiAgICAgICAgICAgIGNvZGUuYWxv\nYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQ\nYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVl\nKGluZGV4KTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5z\nZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAg\nICAgICAgICJmZXRjaCIgKyBTdHJpbmdVdGlscy5jYXBpdGFsaXplKHR5cGUu\nZ2V0TmFtZSgpKSwgdHlwZSwKICAgICAgICAgICAgICAgIG5ldyBDbGFzc1td\neyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIGNvZGUucHV0ZmllbGQoKS5z\nZXRGaWVsZChnZXRGaWVsZE5hbWUoaW5kZXgpLCB0eXBlKTsKICAgICAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICAgICAgY29kZS5n\nZXRmaWVsZCgpLnNldEZpZWxkKCJsb2FkZWQiLCBCaXRTZXQuY2xhc3MpOwog\nICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwog\nICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0\nU2V0LmNsYXNzLCAic2V0Iiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgICAg\nIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgLy8gT2JqZWN0IHZhbCA9IHRvRGF0YShzbS5nZXRNZXRh\nRGF0YSgpLmdldEZpZWxkKGluZGV4KSwKICAgICAgICAgICAgLy8gCQlzbS5m\nZXRjaEZpZWxkKGluZGV4LCBmYWxzZSksIHNtLmdldENvbnRleHQoKSk7CiAg\nICAgICAgICAgIGludCBsb2NhbCA9IGNvZGUuZ2V0TmV4dExvY2Fsc0luZGV4\nKCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAg\nICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAg\nY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRl\nTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRNZXRhRGF0YSIs\nIENsYXNzTWV0YURhdGEuY2xhc3MsIG51bGwpOwogICAgICAgICAgICBjb2Rl\nLmNvbnN0YW50KCkuc2V0VmFsdWUoZm1kLmdldEluZGV4KCkpOwogICAgICAg\nICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQ2xhc3NNZXRh\nRGF0YS5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRGaWVsZCIsIEZpZWxk\nTWV0YURhdGEuY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAg\nICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAg\nICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGZtZC5nZXRJbmRleCgpKTsK\nICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGZhbHNlKTsK\nICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2Qo\nT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJm\nZXRjaEZpZWxkIiwgT2JqZWN0LmNsYXNzLCBuZXcgQ2xhc3NbXQogICAgICAg\nICAgICAgICAgeyBpbnQuY2xhc3MsIGJvb2xlYW4uY2xhc3MgfSk7CiAgICAg\nICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAg\nY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRl\nTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRDb250ZXh0Iiwg\nU3RvcmVDb250ZXh0LmNsYXNzLCBudWxsKTsKICAgICAgICAgICAgY29kZS5p\nbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKGJjLmdldE5hbWUoKSwgInRvRGF0\nYSIsCiAgICAgICAgICAgICAgICBPYmplY3QuY2xhc3MuZ2V0TmFtZSgpLCB0\nb1N0cmluZ3MobmV3IENsYXNzIFtdewogICAgICAgICAgICAgICAgRmllbGRN\nZXRhRGF0YS5jbGFzcywgT2JqZWN0LmNsYXNzLCBTdG9yZUNvbnRleHQuY2xh\nc3MgfSkpOwogICAgICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGxv\nY2FsKTsKCiAgICAgICAgICAgIC8vIGlmICh2YWwgPT0gTlVMTCkgewogICAg\nICAgICAgICAvLyAJCXZhbCA9IG51bGw7CiAgICAgICAgICAgIC8vIAkJbG9h\nZGVkLmNsZWFyKGluZGV4KTsKICAgICAgICAgICAgLy8gCX0gZWxzZQogICAg\nICAgICAgICAvLyAJCWxvYWRlZC5zZXQoaW5kZXgpOwogICAgICAgICAgICAv\nLyAJb2JqZWN0c1tvYmplY3RDb3VudF0gPSB2YWw7CiAgICAgICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNvZGUu\nZ2V0c3RhdGljKCkuc2V0RmllbGQoQWJzdHJhY3RQQ0RhdGEuY2xhc3MsICJO\nVUxMIiwKICAgICAgICAgICAgICAgIE9iamVjdC5jbGFzcyk7CiAgICAgICAg\nICAgIEp1bXBJbnN0cnVjdGlvbiBpZmlucyA9IGNvZGUuaWZhY21wbmUoKTsK\nICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldE51bGwoKTsKICAgICAg\nICAgICAgY29kZS5hc3RvcmUoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUu\nZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNsYXNzKTsK\nICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4KTsK\nICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJp\ndFNldC5jbGFzcywgImNsZWFyIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAg\nICAgIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIEp1\nbXBJbnN0cnVjdGlvbiBnbzIgPSBjb2RlLmdvMigpOwogICAgICAgICAgICBp\nZmlucy5zZXRUYXJnZXQoY29kZS5hbG9hZCgpLnNldFRoaXMoKSk7CiAgICAg\nICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0\nU2V0LmNsYXNzKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZh\nbHVlKGluZGV4KTsKICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCku\nc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgInNldCIsIHZvaWQuY2xhc3MsCiAg\nICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAg\nICAgICAgICBnbzIuc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRUaGlzKCkp\nOwogICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoIm9iamVj\ndHMiLCBPYmplY3RbXS5jbGFzcyk7CiAgICAgICAgICAgIGNvZGUuY29uc3Rh\nbnQoKS5zZXRWYWx1ZShvYmplY3RDb3VudCk7CiAgICAgICAgICAgIGNvZGUu\nYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNvZGUuYWFz\ndG9yZSgpOwogICAgICAgIH0KICAgICAgICBpZiAoIXVzZXNJbXBsRGF0YShm\nbWQpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIHN0b3JlSW1w\nbERhdGEoc20sIGksIGxvYWRlZC5nZXQoaSk7CiAgICAgICAgY29kZS5hbG9h\nZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0o\nMCk7CiAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4KTsK\nICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgIGNvZGUu\nZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNsYXNzKTsK\nICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwogICAg\nICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xh\nc3MsICJnZXQiLCBib29sZWFuLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xh\nc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgIGNvZGUuaW52b2tldmlydHVh\nbCgpLnNldE1ldGhvZCgic3RvcmVJbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAg\nICAgICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNs\nYXNzLCBpbnQuY2xhc3MsIGJvb2xlYW4uY2xhc3MgfSk7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIGFkZE5ld0VtYmVkZGVkKEJDQ2xhc3MgYmMpIHsKICAg\nICAgICAvLyB2b2lkIG5ld0VtYmVkZGVkUENEYXRhKE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgZW1iZWRkZWQpCiAgICAgICAgQkNNZXRob2QgbWV0aCA9IGJjLmRl\nY2xhcmVNZXRob2QoIm5ld0VtYmVkZGVkUENEYXRhIiwgUENEYXRhLmNsYXNz\nLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdl\nci5jbGFzcyB9KTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRoLmdldENvZGUo\ndHJ1ZSk7CiAgICAgICAgLy8gcmV0dXJuIGdldFN0b3JhZ2VHZW5lcmF0b3Io\nKS5nZW5lcmF0ZVBDRGF0YQogICAgICAgIC8vIAkJKHNtLmdldElkKCksIHNt\nLmdldE1ldGFEYXRhKCkpOwogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlz\nKCk7CiAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJzdG9yYWdl\nR2VuZXJhdG9yIiwgUENEYXRhR2VuZXJhdG9yLmNsYXNzKTsKICAgICAgICBj\nb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2Vp\nbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFz\ncywKICAgICAgICAgICAgImdldElkIiwgT2JqZWN0LmNsYXNzLCBudWxsKTsK\nICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29k\nZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFu\nYWdlci5jbGFzcywKICAgICAgICAgICAgImdldE1ldGFEYXRhIiwgQ2xhc3NN\nZXRhRGF0YS5jbGFzcywgbnVsbCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0\ndWFsKCkuc2V0TWV0aG9kKFBDRGF0YUdlbmVyYXRvci5jbGFzcywKICAgICAg\nICAgICAgImdlbmVyYXRlUENEYXRhIiwgUENEYXRhLmNsYXNzLCBuZXcgQ2xh\nc3NbXQogICAgICAgICAgICB7IE9iamVjdC5jbGFzcywgQ2xhc3NNZXRhRGF0\nYS5jbGFzcyB9KTsKICAgICAgICBjb2RlLmFyZXR1cm4oKTsKICAgICAgICBj\nb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwogICAgICAgIGNvZGUuY2FsY3Vs\nYXRlTWF4U3RhY2soKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRkR2V0\nRGF0YShCQ0NsYXNzIGJjKSB7CiAgICAgICAgLy8gcmV0dXJuIGdldE9iamVj\ndEZpZWxkKGkpOwogICAgICAgIEJDTWV0aG9kIG1ldGhvZCA9IGJjLmRlY2xh\ncmVNZXRob2QoImdldERhdGEiLCBPYmplY3QuY2xhc3MsCiAgICAgICAgICAg\nIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgQ29kZSBjb2Rl\nID0gbWV0aG9kLmdldENvZGUodHJ1ZSk7CiAgICAgICAgY29kZS5hbG9hZCgp\nLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmlsb2FkKCkuc2V0UGFyYW0oMCk7\nCiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJnZXRP\nYmplY3QiLCBPYmplY3QuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1td\neyBpbnQuY2xhc3MgfSk7CiAgICAgICAgY29kZS5hcmV0dXJuKCk7CiAgICAg\nICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgICAgICBjb2RlLmNh\nbGN1bGF0ZU1heFN0YWNrKCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLwog\nICAgLy8gVXRpbGl0aWVzCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gYSB2YWxpZCB7QGxpbmsgSmF2YVR5cGVzfSBjb25zdGFu\ndCBmb3IgdGhlIGdpdmVuIGZpZWxkCiAgICAgKi8KICAgIHByb3RlY3RlZCBp\nbnQgcmVwbGFjZVR5cGUoRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBp\nZiAodXNlc0ludGVybWVkaWF0ZShmbWQpKQogICAgICAgICAgICByZXR1cm4g\nSmF2YVR5cGVzLk9CSkVDVDsKICAgICAgICByZXR1cm4gZm1kLmdldFR5cGVD\nb2RlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBnaXZl\nbiBmaWVsZCB1c2VzIGEgY2FjaGVhYmxlIGludGVybWVkaWF0ZSB2YWx1ZS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNlc0ludGVybWVkaWF0\nZShGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAgIHJldHVybiBmbWQudXNl\nc0ludGVybWVkaWF0ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0aGUgZ2l2ZW4gdHlwZSBtaWdodCBoYXZlIGNhY2hlYWJsZSBjbGFzcy1s\nZXZlbCBpbXBsIGRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIHVzZXNJbXBsRGF0YShDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhl\nIGdpdmVuIGZpZWxkIG1pZ2h0IGhhdmUgY2FjaGVhYmxlIGltcGwgZGF0YS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNlc0ltcGxEYXRhKEZp\nZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgcmV0dXJuIGZtZC51c2VzSW1w\nbERhdGEoKSA9PSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51\nbWJlciBvZiBmaWVsZHMgd2l0aCBjYWNoZWFibGUgaW1wbCBkYXRhLgogICAg\nICovCiAgICBwcml2YXRlIGludCBjb3VudEltcGxEYXRhRmllbGRzKENsYXNz\nTWV0YURhdGEgbWV0YSkgewogICAgICAgIEZpZWxkTWV0YURhdGFbXSBmbWRz\nID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICBpbnQgY291bnQgPSAwOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZm1kcy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgaWYgKHVzZXNJbXBsRGF0YShmbWRzW2ldKSkKICAgICAg\nICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgcmV0dXJuIGNvdW50OwogICAg\nfQoKICAgIC8qKgogICAgICogQWRkIG1ldGhvZCB3aGljaCBkZWZlcnMgdG8g\nQWJzdHJhY3RQQ0RhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNh\nbGxBYnN0cmFjdFBDRGF0YShCQ0NsYXNzIGJjLCBTdHJpbmcgbmFtZSwgQ2xh\nc3MgcmV0VHlwZSwKICAgICAgICBDbGFzc1tdIGFyZ3MpIHsKICAgICAgICBC\nQ01ldGhvZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZChuYW1lLCByZXRUeXBl\nLCBhcmdzKTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1\nZSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgIGNvZGUueGxvYWQoKS5zZXRQYXJhbShpKS5zZXRUeXBlKGFyZ3NbaV0p\nOwogICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChBYnN0\ncmFjdFBDRGF0YS5jbGFzcywgbmFtZSwgcmV0VHlwZSwKICAgICAgICAgICAg\nYXJncyk7CiAgICAgICAgaWYgKCF2b2lkLmNsYXNzLmVxdWFscyhyZXRUeXBl\nKSkKICAgICAgICAgICAgY29kZS54cmV0dXJuKCkuc2V0VHlwZShyZXRUeXBl\nKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwogICAgICAg\nIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNldCB0aGUgY29sbGVjdGlvbiBvZiB7QGxpbmsgSnVtcEluc3RydWN0\naW9ufXMgdG8gdGhlIGdpdmVuIGluc3RydWN0aW9uLAogICAgICogY2xlYXJp\nbmcgdGhlIGNvbGxlY3Rpb24gaW4gdGhlIHByb2Nlc3MuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHNldFRhcmdldChJbnN0cnVjdGlvbiBpbnMsIENv\nbGxlY3Rpb24ganVtcHMpIHsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ID0g\nanVtcHMuaXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOykKICAgICAgICAgICAg\nKChKdW1wSW5zdHJ1Y3Rpb24pIGl0Lm5leHQoKSkuc2V0VGFyZ2V0KGlucyk7\nCiAgICAgICAganVtcHMuY2xlYXIoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRyYW5zZm9ybSB0aGUgZ2l2ZW4gYXJyYXkgb2YgY2xhc3NlcyB0byBzdHJp\nbmdzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmdbXSB0b1N0\ncmluZ3MoQ2xhc3NbXSBjbHMpIHsKICAgICAgICBTdHJpbmdbXSBzdHJpbmdz\nID0gbmV3IFN0cmluZ1tjbHMubGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHN0cmluZ3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHN0\ncmluZ3NbaV0gPSBjbHNbaV0uZ2V0TmFtZSgpOwogICAgICAgIHJldHVybiBz\ndHJpbmdzOwogICAgfQoKICAgIC8qKgogICAgICogRHluYW1pYyB7QGxpbmsg\nUENEYXRhfXMgZ2VuZXJhdGVkIHdpbGwgaW1wbGVtZW50IHRoaXMgaW50ZXJm\nYWNlCiAgICAgKiB0byBzaW1wbGlmeSBpbml0aWFsaXphdGlvbi4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgRHluYW1pY1BDRGF0YSBl\neHRlbmRzIFBDRGF0YSB7CgogICAgICAgIHB1YmxpYyB2b2lkIHNldElkKE9i\namVjdCBvaWQpOwoKICAgICAgICBwdWJsaWMgUENEYXRhR2VuZXJhdG9yIGdl\ndFN0b3JhZ2VHZW5lcmF0b3IoKTsKCiAgICAgICAgcHVibGljIHZvaWQgc2V0\nU3RvcmFnZUdlbmVyYXRvciAoUENEYXRhR2VuZXJhdG9yIGdlbmVyYXRvcik7\nCgl9Cn0K\n","encoding":"base64"}

