{"sha":"75cce6867811032c738db36196f026eae7c775fe","node_id":"MDQ6QmxvYjIwNjM2NDo3NWNjZTY4Njc4MTEwMzJjNzM4ZGIzNjE5NmYwMjZlYWU3Yzc3NWZl","size":7216,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/75cce6867811032c738db36196f026eae7c775fe","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5ldmVudDsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0Owpp\nbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5Ccm9rZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuQ2xvc2VhYmxlOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5jb25jdXJyZW50LkFic3RyYWN0Q29uY3Vy\ncmVudEV2ZW50TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLlVzZXJFeGNlcHRpb247CgovKioKICogTWFuYWdlciB0aGF0IGNhbiBi\nZSB1c2VkIHRvIHRyYWNrIGFuZCBub3RpZnkKICoge0BsaW5rIFJlbW90ZUNv\nbW1pdExpc3RlbmVyfXMgb24gcmVtb3RlIGNvbW1pdCBldmVudHMuIElmIHJl\nbW90ZSBldmVudHMKICogYXJlIGVuYWJsZWQsIHRoaXMgbWFuYWdlciBzaG91\nbGQgYmUgaW5zdGFsbGVkIGFzIGEgdHJhbnNhY3Rpb24gbGlzdGVuZXIgb24K\nICogYWxsIGJyb2tlcnMgc28gdGhhdCBpdCBrbm93cyB3aGVuIGNvbW1pdHMg\nYXJlIG1hZGUuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAqIEBh\ndXRob3IgQWJlIFdoaXRlCiAqIEBzaW5jZSAwLjMuMAogKi8KcHVibGljIGNs\nYXNzIFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlcgogICAgZXh0ZW5kcyBBYnN0\ncmFjdENvbmN1cnJlbnRFdmVudE1hbmFnZXIKICAgIGltcGxlbWVudHMgRW5k\nVHJhbnNhY3Rpb25MaXN0ZW5lciwgQ2xvc2VhYmxlIHsKCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQ\nYWNrYWdlCiAgICAgICAgKFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlci5jbGFz\ncyk7CgogICAgcHJpdmF0ZSBmaW5hbCBSZW1vdGVDb21taXRQcm92aWRlciBf\ncHJvdmlkZXI7CiAgICBwcml2YXRlIGJvb2xlYW4gX3RyYW5zbWl0UGVyc0lk\ncyA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuIFN1cHBs\neSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgUmVtb3RlQ29t\nbWl0RXZlbnRNYW5hZ2VyKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsK\nICAgICAgICBfcHJvdmlkZXIgPSBjb25mLm5ld1JlbW90ZUNvbW1pdFByb3Zp\nZGVySW5zdGFuY2UoKTsKICAgICAgICBpZiAoX3Byb3ZpZGVyICE9IG51bGwp\nIHsKICAgICAgICAgICAgX3Byb3ZpZGVyLnNldFJlbW90ZUNvbW1pdEV2ZW50\nTWFuYWdlcih0aGlzKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdHJ1ZSBpZiByZW1vdGUgZXZlbnRzIGFyZSBlbmFibGVkLgog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBhcmVSZW1vdGVFdmVudHNFbmFi\nbGVkKCkgewogICAgICAgIHJldHVybiBfcHJvdmlkZXIgIT0gbnVsbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUge0BsaW5rIFJlbW90ZUNv\nbW1pdFByb3ZpZGVyfSB0aGF0IHRoaXMgbWFuYWdlciB1c2VzLgogICAgICoK\nICAgICAqIEBzaW5jZSAwLjMuMQogICAgICovCiAgICBwdWJsaWMgUmVtb3Rl\nQ29tbWl0UHJvdmlkZXIgZ2V0UmVtb3RlQ29tbWl0UHJvdmlkZXIoKSB7CiAg\nICAgICAgcmV0dXJuIF9wcm92aWRlcjsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdGhlIG9pZHMgb2YgYWRkZWQgaW5zdGFuY2VzIHdpbGwgYmUg\ndHJhbnNtaXR0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldFRy\nYW5zbWl0UGVyc2lzdGVkT2JqZWN0SWRzKCkgewogICAgICAgIHJldHVybiBf\ndHJhbnNtaXRQZXJzSWRzOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0aGUgb2lkcyBvZiBhZGRlZCBpbnN0YW5jZXMgd2lsbCBiZSB0cmFuc21p\ndHRlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VHJhbnNtaXRQZXJz\naXN0ZWRPYmplY3RJZHMoYm9vbGVhbiB0cmFuc21pdCkgewogICAgICAgIF90\ncmFuc21pdFBlcnNJZHMgPSB0cmFuc21pdDsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBhZGRMaXN0ZW5lcihSZW1vdGVDb21taXRMaXN0ZW5lciBsaXN0ZW4p\nIHsKICAgICAgICBpZiAoX3Byb3ZpZGVyID09IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1wcm92aWRl\nciIpKTsKICAgICAgICBzdXBlci5hZGRMaXN0ZW5lcihsaXN0ZW4pOwogICAg\nfQoKICAgIC8qKgogICAgICogQ2xvc2UgdGhpcyBtYW5hZ2VyIGFuZCBhbGwg\ncmVnaXN0ZXJlZCBsaXN0ZW5lcnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGNsb3NlKCkgewogICAgICAgIGlmIChfcHJvdmlkZXIgIT0gbnVsbCkgewog\nICAgICAgICAgICBfcHJvdmlkZXIuY2xvc2UoKTsKICAgICAgICAgICAgQ29s\nbGVjdGlvbiBsaXN0ZW5lcnMgPSBnZXRMaXN0ZW5lcnMoKTsKICAgICAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBsaXN0ZW5lcnMuaXRlcmF0b3IoKTsg\naXRyLmhhc05leHQoKTspCiAgICAgICAgICAgICAgICAoKFJlbW90ZUNvbW1p\ndExpc3RlbmVyKSBpdHIubmV4dCgpKS5jbG9zZSgpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBmaXJlRXZlbnQoT2JqZWN0IGV2ZW50\nLCBPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBSZW1vdGVDb21taXRMaXN0\nZW5lciBsaXN0ZW4gPSAoUmVtb3RlQ29tbWl0TGlzdGVuZXIpIGxpc3RlbmVy\nOwogICAgICAgIFJlbW90ZUNvbW1pdEV2ZW50IGV2ID0gKFJlbW90ZUNvbW1p\ndEV2ZW50KSBldmVudDsKICAgICAgICBsaXN0ZW4uYWZ0ZXJDb21taXQoZXYp\nOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vCiAgICAvLyBUcmFuc2FjdGlvbkxpc3RlbmVyIGltcGxlbWVudGF0\naW9uCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwoKICAgIHB1YmxpYyB2b2lkIGFmdGVyQ29tbWl0KFRyYW5zYWN0aW9uRXZl\nbnQgZXZlbnQpIHsKICAgICAgICBpZiAoX3Byb3ZpZGVyICE9IG51bGwpIHsK\nICAgICAgICAgICAgUmVtb3RlQ29tbWl0RXZlbnQgcmNlID0gY3JlYXRlUmVt\nb3RlQ29tbWl0RXZlbnQoZXZlbnQpOwogICAgICAgICAgICBpZiAocmNlICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBfcHJvdmlkZXIuYnJvYWRjYXN0KHJj\nZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEg\ncmVtb3RlIGNvbW1pdCBldmVudCBmcm9tIHRoZSBnaXZlbiB0cmFuc2FjdGlv\nbiBldmVudC4KICAgICAqLwogICAgcHJpdmF0ZSBSZW1vdGVDb21taXRFdmVu\ndCBjcmVhdGVSZW1vdGVDb21taXRFdmVudChUcmFuc2FjdGlvbkV2ZW50IGV2\nZW50KSB7CiAgICAgICAgQnJva2VyIGJyb2tlciA9IChCcm9rZXIpIGV2ZW50\nLmdldFNvdXJjZSgpOwogICAgICAgIGludCBwYXlsb2FkOwogICAgICAgIENv\nbGxlY3Rpb24gcGVyc0lkcyA9IG51bGw7CiAgICAgICAgQ29sbGVjdGlvbiBh\nZGRDbGFzc05hbWVzID0gbnVsbDsKICAgICAgICBDb2xsZWN0aW9uIHVwZGF0\nZXMgPSBudWxsOwogICAgICAgIENvbGxlY3Rpb24gZGVsZXRlcyA9IG51bGw7\nCgogICAgICAgIGlmIChicm9rZXIuaXNMYXJnZVRyYW5zYWN0aW9uKCkpIHsK\nICAgICAgICAgICAgcGF5bG9hZCA9IFJlbW90ZUNvbW1pdEV2ZW50LlBBWUxP\nQURfRVhURU5UUzsKICAgICAgICAgICAgYWRkQ2xhc3NOYW1lcyA9IHRvQ2xh\nc3NOYW1lcyhldmVudC5nZXRQZXJzaXN0ZWRUeXBlcygpKTsKICAgICAgICAg\nICAgdXBkYXRlcyA9IHRvQ2xhc3NOYW1lcyhldmVudC5nZXRVcGRhdGVkVHlw\nZXMoKSk7CiAgICAgICAgICAgIGRlbGV0ZXMgPSB0b0NsYXNzTmFtZXMoZXZl\nbnQuZ2V0RGVsZXRlZFR5cGVzKCkpOwogICAgICAgICAgICBpZiAoYWRkQ2xh\nc3NOYW1lcyA9PSBudWxsICYmIHVwZGF0ZXMgPT0gbnVsbCAmJiBkZWxldGVz\nID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICBDb2xsZWN0aW9uIHRyYW5zID0gZXZl\nbnQuZ2V0VHJhbnNhY3Rpb25hbE9iamVjdHMoKTsKICAgICAgICAgICAgaWYg\nKHRyYW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICAgICAgcGF5bG9hZCA9IChfdHJhbnNtaXRQZXJzSWRzKQog\nICAgICAgICAgICAgICAgPyBSZW1vdGVDb21taXRFdmVudC5QQVlMT0FEX09J\nRFNfV0lUSF9BRERTCiAgICAgICAgICAgICAgICA6IFJlbW90ZUNvbW1pdEV2\nZW50LlBBWUxPQURfT0lEUzsKICAgICAgICAgICAgT2JqZWN0IG9pZDsKICAg\nICAgICAgICAgT2JqZWN0IG9iajsKICAgICAgICAgICAgT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbTsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSB0\ncmFucy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAg\nICAgICAgb2JqID0gaXRyLm5leHQoKTsKICAgICAgICAgICAgICAgIHNtID0g\nYnJva2VyLmdldFN0YXRlTWFuYWdlcihvYmopOwoKICAgICAgICAgICAgICAg\nIGlmIChzbSA9PSBudWxsIHx8ICFzbS5pc1BlcnNpc3RlbnQoKSB8fCAhc20u\naXNEaXJ0eSgpKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICAgICAgaWYgKHNtLmlzTmV3KCkgJiYgc20uaXNEZWxldGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAg\nICAgb2lkID0gc20uZmV0Y2hPYmplY3RJZCgpOwogICAgICAgICAgICAgICAg\naWYgKHNtLmlzTmV3KCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX3Ry\nYW5zbWl0UGVyc0lkcykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\ncGVyc0lkcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\ncGVyc0lkcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcGVyc0lkcy5hZGQob2lkKTsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgaWYgKGFkZENsYXNzTmFtZXMgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3NOYW1lcyA9IG5l\ndyBIYXNoU2V0KCk7CiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3NOYW1l\ncy5hZGQob2JqLmdldENsYXNzKCkuZ2V0TmFtZSgpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSBpZiAoc20uaXNEZWxldGVkKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoZGVsZXRlcyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nICAgICAgICBkZWxldGVzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAg\nICAgICAgICAgIGRlbGV0ZXMuYWRkKG9pZCk7CiAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVzID09IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZXMgPSBuZXcgQXJy\nYXlMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcy5hZGQob2lk\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAoYWRkQ2xhc3NOYW1lcyA9PSBudWxsICYmIHVwZGF0ZXMgPT0gbnVs\nbCAmJiBkZWxldGVzID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVDb21t\naXRFdmVudChwYXlsb2FkLCBwZXJzSWRzLCBhZGRDbGFzc05hbWVzLCB1cGRh\ndGVzLAogICAgICAgICAgICBkZWxldGVzKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRyYW5zZm9ybSBhIGNvbGxlY3Rpb24gb2YgY2xhc3NlcyB0byBjbGFz\ncyBuYW1lcy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgQ29sbGVjdGlv\nbiB0b0NsYXNzTmFtZXMoQ29sbGVjdGlvbiBjbHNzKSB7CiAgICAgICAgaWYg\nKGNsc3MuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgTGlzdCBuYW1lcyA9IG5ldyBBcnJheUxpc3QoY2xzcyk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuYW1lcy5zaXplKCk7IGkrKykKICAg\nICAgICAgICAgbmFtZXMuc2V0KGksICgoQ2xhc3MpIG5hbWVzLmdldChpKSku\nZ2V0TmFtZSgpKTsKICAgICAgICByZXR1cm4gbmFtZXM7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgYmVmb3JlQ29tbWl0KFRyYW5zYWN0aW9uRXZlbnQgZXZl\nbnQpIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZnRlclJvbGxiYWNrKFRy\nYW5zYWN0aW9uRXZlbnQgZXZlbnQpIHsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBhZnRlckNvbW1pdENvbXBsZXRlKFRyYW5zYWN0aW9uRXZlbnQgZXZlbnQp\nIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZnRlclJvbGxiYWNrQ29tcGxl\ndGUoVHJhbnNhY3Rpb25FdmVudCBldmVudCkgewogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGFmdGVyU3RhdGVUcmFuc2l0aW9ucyhUcmFuc2FjdGlvbkV2ZW50\nIGV2ZW50KQoJewoJfQp9Cg==\n","encoding":"base64"}

