{"sha":"6d7767271af3bb7419e93cb6735749309cae4c75","node_id":"MDQ6QmxvYjIwNjM2NDo2ZDc3NjcyNzFhZjNiYjc0MTllOTNjYjY3MzU3NDkzMDljYWU0Yzc1","size":31951,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6d7767271af3bb7419e93cb6735749309cae4c75","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5ldmVudDsKCmltcG9ydCBqYXZhLmlvLkJ1ZmZlcmVkSW5wdXRT\ndHJlYW07CmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbTsK\naW1wb3J0IGphdmEuaW8uRU9GRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5J\nT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5P\nYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLk9wdGlvbmFsRGF0\nYUV4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uT3V0cHV0U3RyZWFtOwppbXBv\ncnQgamF2YS5uZXQuSW5ldEFkZHJlc3M7CmltcG9ydCBqYXZhLm5ldC5TZXJ2\nZXJTb2NrZXQ7CmltcG9ydCBqYXZhLm5ldC5Tb2NrZXQ7CmltcG9ydCBqYXZh\nLm5ldC5Tb2NrZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5Vbmtub3du\nSG9zdEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkhhc2hN\nYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBv\ncnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBv\ncnQgb3JnLmFwYWNoZS5jb21tb25zLnBvb2wuUG9vbGFibGVPYmplY3RGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLnBvb2wuaW1wbC5HZW5l\ncmljT2JqZWN0UG9vbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nY29uZi5Db25maWd1cmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi51dGlsLmNvbmN1cnJlbnQuUmVlbnRyYW50TG9jazsKCmltcG9y\ndCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBUQ1AtYmFzZWQgaW1wbGVt\nZW50YXRpb24gb2Yge0BsaW5rIFJlbW90ZUNvbW1pdFByb3ZpZGVyfSB0aGF0\nCiAqIGxpc3RlbnMgZm9yIG9iamVjdCBtb2RpZmljYXRpb25zIGFuZCBwcm9w\nYWdhdGVzIHRob3NlIGNoYW5nZXMgdG8KICogb3RoZXIgUmVtb3RlQ29tbWl0\nUHJvdmlkZXJzIG92ZXIgVENQIHNvY2tldHMuCiAqCiAqIEBhdXRob3IgQnJp\nYW4gTGVhaXIKICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkKICogQHNpbmNl\nIDAuMi41LjAKICovCnB1YmxpYyBjbGFzcyBUQ1BSZW1vdGVDb21taXRQcm92\naWRlcgogICAgZXh0ZW5kcyBBYnN0cmFjdFJlbW90ZUNvbW1pdFByb3ZpZGVy\nCiAgICBpbXBsZW1lbnRzIENvbmZpZ3VyYWJsZSB7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IERFRkFVTFRfUE9SVCA9IDU2MzY7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgTG9jYWxpemVyIHNfbG9jID0gTG9jYWxpemVyLmZvclBh\nY2thZ2UKICAgICAgICAoVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIuY2xhc3Mp\nOwogICAgcHJpdmF0ZSBzdGF0aWMgbG9uZyBzX2lkU2VxdWVuY2UgPSBTeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKCiAgICAvLwlBIG1hcCBvZiBsaXN0\nZW4gcG9ydHMgdG8gbGlzdGVuZXJzIGluIHRoaXMgSlZNLiBXZSBtaWdodAog\nICAgLy8Jd2FudCB0byBsb29rIGludG8gYWxsb3dpbmcgc2FtZSBwb3J0LCBk\naWZmZXJlbnQgaW50ZXJmYWNlIC0tCiAgICAvLwl0aGF0IGlzIG5vdCBjdXJy\nZW50bHkgcG9zc2libGUgaW4gYSBzaW5nbGUgSlZNLgogICAgcHJpdmF0ZSBz\ndGF0aWMgTWFwIHNfcG9ydExpc3RlbmVyTWFwID0gbmV3IEhhc2hNYXAoKTsK\nCiAgICBwcml2YXRlIGxvbmcgX2lkOwogICAgcHJpdmF0ZSBieXRlW10gX2xv\nY2FsaG9zdDsKICAgIHByaXZhdGUgaW50IF9wb3J0ID0gREVGQVVMVF9QT1JU\nOwogICAgcHJpdmF0ZSBpbnQgX21heEFjdGl2ZSA9IDI7CiAgICBwcml2YXRl\nIGludCBfbWF4SWRsZSA9IDI7CiAgICBwcml2YXRlIGludCBfcmVjb3ZlcnlU\naW1lTWlsbGlzID0gMTUwMDA7CiAgICBwcml2YXRlIFRDUFBvcnRMaXN0ZW5l\nciBfbGlzdGVuZXI7CiAgICBwcml2YXRlIEJyb2FkY2FzdFF1ZXVlIF9icm9h\nZGNhc3RRdWV1ZSA9IG5ldyBCcm9hZGNhc3RRdWV1ZSgpOwogICAgcHJpdmF0\nZSBMaW5rZWRMaXN0IF9icm9hZGNhc3RUaHJlYWRzID0gbmV3IExpbmtlZExp\nc3QoKTsKCiAgICBwcml2YXRlIEFycmF5TGlzdCBfYWRkcmVzc2VzID0gbmV3\nIEFycmF5TGlzdCgpOwogICAgcHJpdmF0ZSBSZWVudHJhbnRMb2NrIF9hZGRy\nZXNzZXNMb2NrOwoKICAgIHB1YmxpYyBUQ1BSZW1vdGVDb21taXRQcm92aWRl\ncigpCiAgICAgICAgdGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uIHsKICAg\nICAgICAvLyBvYnRhaW4gYSB1bmlxdWUgSUQuCiAgICAgICAgc3luY2hyb25p\nemVkIChUQ1BSZW1vdGVDb21taXRQcm92aWRlci5jbGFzcykgewogICAgICAg\nICAgICBfaWQgPSBzX2lkU2VxdWVuY2UrKzsKICAgICAgICB9CgogICAgICAg\nIC8vIGNhY2hlIHRoZSBsb2NhbCBJUCBhZGRyZXNzLgogICAgICAgIF9sb2Nh\nbGhvc3QgPSBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3QoKS5nZXRBZGRyZXNz\nKCk7CiAgICAgICAgX2FkZHJlc3Nlc0xvY2sgPSBuZXcgUmVlbnRyYW50TG9j\naygpOwogICAgICAgIHNldE51bUJyb2FkY2FzdFRocmVhZHMoMik7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgcG9ydCB0aGF0IHRoaXMgcHJvdmlkZXIg\nc2hvdWxkIGxpc3RlbiBvbi4KICAgICAqLwogICAgcHVibGljIGludCBnZXRQ\nb3J0KCkgewogICAgICAgIHJldHVybiBfcG9ydDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBwb3J0IHRoYXQgdGhpcyBwcm92aWRlciBzaG91bGQgbGlz\ndGVuIG9uLiBTZXQgb25jZSBvbmx5LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRQb3J0KGludCBwb3J0KSB7CiAgICAgICAgX3BvcnQgPSBwb3J0Owog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBtaWxsaXNlY29u\nZHMgdG8gd2FpdCBiZWZvcmUgcmV0cnlpbmcKICAgICAqIHRvIHJlY29ubmVj\ndCB0byBhIHBlZXIgYWZ0ZXIgaXQgYmVjb21lcyB1bnJlYWNoYWJsZS4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVjb3ZlcnlUaW1lTWlsbGlzKGlu\ndCByZWNvdmVyeXRpbWUpIHsKICAgICAgICBfcmVjb3ZlcnlUaW1lTWlsbGlz\nID0gcmVjb3Zlcnl0aW1lOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51\nbWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCBiZWZvcmUgcmV0cnlpbmcK\nICAgICAqIHRvIHJlY29ubmVjdCB0byBhIHBlZXIgYWZ0ZXIgaXQgYmVjb21l\ncyB1bnJlYWNoYWJsZS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRSZWNv\ndmVyeVRpbWVNaWxsaXMoKSB7CiAgICAgICAgcmV0dXJuIF9yZWNvdmVyeVRp\nbWVNaWxsaXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbWF4aW11bSBu\ndW1iZXIgb2Ygc29ja2V0cyB0aGF0IHRoaXMgcHJvdmlkZXIgY2FuCiAgICAg\nKiBzaW1ldGFuZW91c2x5IG9wZW4gdG8gZWFjaCBwZWVyIGluIHRoZSBjbHVz\ndGVyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNYXhBY3RpdmUoaW50\nIG1heEFjdGl2ZSkgewogICAgICAgIF9tYXhBY3RpdmUgPSBtYXhBY3RpdmU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbWF4aW11bSBudW1iZXIgb2Yg\nc29ja2V0cyB0aGF0IHRoaXMgcHJvdmlkZXIgY2FuCiAgICAgKiBzaW1ldGFu\nZW91c2x5IG9wZW4gdG8gZWFjaCBwZWVyIGluIHRoZSBjbHVzdGVyLgogICAg\nICovCiAgICBwdWJsaWMgaW50IGdldE1heEFjdGl2ZSgpIHsKICAgICAgICBy\nZXR1cm4gX21heEFjdGl2ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBu\ndW1iZXIgb2YgaWRsZSBzb2NrZXRzIHRoYXQgdGhpcyBwcm92aWRlciBjYW4g\na2VlcCBvcGVuCiAgICAgKiB0byBlYWNoIHBlZXIgaW4gdGhlIGNsdXN0ZXIu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1heElkbGUoaW50IG1heElk\nbGUpIHsKICAgICAgICBfbWF4SWRsZSA9IG1heElkbGU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9mIGlkbGUgc29ja2V0cyB0aGF0IHRo\naXMgcHJvdmlkZXIgY2FuIGtlZXAgb3BlbgogICAgICogdG8gZWFjaCBwZWVy\nIGluIHRoZSBjbHVzdGVyLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldE1h\neElkbGUoKSB7CiAgICAgICAgcmV0dXJuIF9tYXhJZGxlOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIG51bWJlciBvZiB3b3JrZXIgdGhyZWFkcyB0aGF0\nIGFyZSB1c2VkIGZvcgogICAgICogdHJhbnNtaXR0aW5nIHBhY2tldHMgdG8g\ncGVlcnMgaW4gdGhlIGNsdXN0ZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldE51bUJyb2FkY2FzdFRocmVhZHMoaW50IG51bUJyb2FkY2FzdFRocmVh\nZHMpIHsKICAgICAgICBzeW5jaHJvbml6ZWQgKF9icm9hZGNhc3RUaHJlYWRz\nKSB7CiAgICAgICAgICAgIGludCBjdXIgPSBfYnJvYWRjYXN0VGhyZWFkcy5z\naXplKCk7CiAgICAgICAgICAgIGlmIChjdXIgPiBudW1Ccm9hZGNhc3RUaHJl\nYWRzKSB7CiAgICAgICAgICAgICAgICAvLyBOb3RpZnkgdGhlIGV4dHJhIHdv\ncmtlciB0aHJlYWRzIHNvIHRoZXkgc3RvcCB0aGVtc2VsdmVzCiAgICAgICAg\nICAgICAgICAvLyBUaHJlYWRzIHdpbGwgbm90IGVuZCB1bnRpbCB0aGV5IHNl\nbmQgYW5vdGhlciBway4KICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSBu\ndW1Ccm9hZGNhc3RUaHJlYWRzOyBpIDwgY3VyOyBpKyspIHsKICAgICAgICAg\nICAgICAgICAgICBCcm9hZGNhc3RXb3JrZXJUaHJlYWQgd29ya2VyID0gKEJy\nb2FkY2FzdFdvcmtlclRocmVhZCkKICAgICAgICAgICAgICAgICAgICAgICAg\nX2Jyb2FkY2FzdFRocmVhZHMucmVtb3ZlRmlyc3QoKTsKICAgICAgICAgICAg\nICAgICAgICB3b3JrZXIuc2V0UnVubmluZyhmYWxzZSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VyIDwgbnVtQnJvYWRj\nYXN0VGhyZWFkcykgewogICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGFkZGl0\naW9uYWwgd29ya2VyIHRocmVhZHMKICAgICAgICAgICAgICAgIGZvciAoaW50\nIGkgPSBjdXI7IGkgPCBudW1Ccm9hZGNhc3RUaHJlYWRzOyBpKyspIHsKICAg\nICAgICAgICAgICAgICAgICBCcm9hZGNhc3RXb3JrZXJUaHJlYWQgd3QgPSBu\nZXcgQnJvYWRjYXN0V29ya2VyVGhyZWFkKCk7CiAgICAgICAgICAgICAgICAg\nICAgd3Quc2V0RGFlbW9uKHRydWUpOwogICAgICAgICAgICAgICAgICAgIHd0\nLnN0YXJ0KCk7CiAgICAgICAgICAgICAgICAgICAgX2Jyb2FkY2FzdFRocmVh\nZHMuYWRkTGFzdCh3dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbnVtYmVy\nIG9mIHdvcmtlciB0aHJlYWRzIHRoYXQgYXJlIHVzZWQgZm9yCiAgICAgKiB0\ncmFuc21pdHRpbmcgcGFja2V0cyB0byBwZWVycyBpbiB0aGUgY2x1c3Rlci4K\nICAgICAqLwogICAgcHVibGljIGludCBnZXROdW1Ccm9hZGNhc3RUaHJlYWRz\nKCkgewogICAgICAgIHJldHVybiBfYnJvYWRjYXN0VGhyZWFkcy5zaXplKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBsaXN0IG9mIGFkZHJl\nc3NlcyBvZiBwZWVycyB0byB3aGljaCB0aGlzIHByb3ZpZGVyIHdpbGwKICAg\nICAqIHNlbmQgZXZlbnRzIHRvLiBUaGUgcGVlcnMgYXJlIHNlbWljb2xvbi1z\nZXBhcmF0ZWQgPGNvZGU+bmFtZXM8L2NvZGU+CiAgICAgKiBsaXN0IGluIHRo\nZSBmb3JtIG9mICJteWhvc3QxOnBvcnRBO215aG9zdDI6cG9ydEIiLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRBZGRyZXNzZXMoU3RyaW5nIG5hbWVz\nKQogICAgICAgIHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlvbiB7CiAgICAg\nICAgLy8gTllJLiBDb3VsZCBsb29rIGZvciBlcXVpdmFsZW5jZSBvZiBhZGRy\nZXNzZXMgYW5kIGF2b2lkCiAgICAgICAgLy8gY2hhbmdpbmcgdGhvc2UgdGhh\ndCBkaWRuJ3QgY2hhbmdlLgoKICAgICAgICBfYWRkcmVzc2VzTG9jay5sb2Nr\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBp\ndGVyID0gX2FkZHJlc3Nlcy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgICAgICgoSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgp\nKS5jbG9zZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFN0cmluZ1td\nIHRva3MgPSBTdHJpbmdzLnNwbGl0KG5hbWVzLCAiOyIsIDApOwogICAgICAg\nICAgICBfYWRkcmVzc2VzID0gbmV3IEFycmF5TGlzdCh0b2tzLmxlbmd0aCk7\nCgogICAgICAgICAgICBJbmV0QWRkcmVzcyBsb2NhbGhvc3QgPSBJbmV0QWRk\ncmVzcy5nZXRMb2NhbEhvc3QoKTsKICAgICAgICAgICAgU3RyaW5nIGxvY2Fs\naG9zdE5hbWUgPSBsb2NhbGhvc3QuZ2V0SG9zdE5hbWUoKTsKCiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdG9rcy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICAgICAgU3RyaW5nIGhvc3QgPSB0b2tzW2ldOwogICAgICAg\nICAgICAgICAgU3RyaW5nIGhvc3RuYW1lOwogICAgICAgICAgICAgICAgaW50\nIHRtcFBvcnQ7CiAgICAgICAgICAgICAgICBpbnQgY29sb24gPSBob3N0Lmlu\nZGV4T2YoJzonKTsKICAgICAgICAgICAgICAgIGlmIChjb2xvbiAhPSAtMSkg\newogICAgICAgICAgICAgICAgICAgIGhvc3RuYW1lID0gaG9zdC5zdWJzdHJp\nbmcoMCwgY29sb24pOwogICAgICAgICAgICAgICAgICAgIHRtcFBvcnQgPSBJ\nbnRlZ2VyLnBhcnNlSW50KGhvc3Quc3Vic3RyaW5nKGNvbG9uICsgMSkpOwog\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBo\nb3N0bmFtZSA9IGhvc3Q7CiAgICAgICAgICAgICAgICAgICAgdG1wUG9ydCA9\nIERFRkFVTFRfUE9SVDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIEluZXRBZGRyZXNzIHRtcEFkZHJlc3MgPSBJbmV0QWRkcmVzcy5nZXRC\neU5hbWUoaG9zdG5hbWUpOwoKICAgICAgICAgICAgICAgIC8vIGJsZWFpcjog\nRm9yIGVhY2ggYWRkcmVzcyB3ZSB3b3VsZCByYXRoZXIgbWFrZSB1c2Ugb2YK\nICAgICAgICAgICAgICAgIC8vIHRoZSBqZGsxLjQgaXNMaW5rTG9jYWxBZGRy\nZXNzICgpIHx8IGlzTG9vcGJhY2tBZGRyZXNzICgpLgogICAgICAgICAgICAg\nICAgLy8gKFRob3VnaCBpbiBwcmFjdGljZSBvbiB3aW4zMiB0aGV5IGRvbid0\nIHdvcmsgYW55d2F5cyEpCiAgICAgICAgICAgICAgICAvLyBJbnN0ZWFkIHdl\nIHdpbGwgY2hlY2sgaG9zdG5hbWUuIE5vdCBwZXJmZWN0LCBidXQKICAgICAg\nICAgICAgICAgIC8vIGl0IHdpbGwgbWF0Y2ggb2Z0ZW4gZW5vdWdoIChwZW9w\nbGUgd2lsbCB0eXBpY2FsbHkKICAgICAgICAgICAgICAgIC8vIHVzZSB0aGUg\nRE5TIG1hY2hpbmUgbmFtZXMgYW5kIGJlIGN1dHRpbmcvcGFzdGluZy4pCiAg\nICAgICAgICAgICAgICBpZiAobG9jYWxob3N0TmFtZS5lcXVhbHMoaG9zdG5h\nbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBzdHJpbmcgbWF0\nY2hlcyB0aGUgaG9zdG5hbWUgZm9yIGZvciBvdXJzZWx2ZXMsIHdlCiAgICAg\nICAgICAgICAgICAgICAgLy8gZG9uJ3QgYWN0dWFsbHkgbmVlZCB0byBzZW5k\nIG91cnNlbHZlcyBtZXNzYWdlcy4KICAgICAgICAgICAgICAgICAgICBpZiAo\nbG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgbG9nLnRyYWNlKHNfbG9jLmdldCgidGNwLWFkZHJlc3MtYXNzZWxmIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcEFkZHJlc3MuZ2V0SG9z\ndE5hbWUoKSArICI6IiArIHRtcFBvcnQpKTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nICAgIEhvc3RBZGRyZXNzIG5ld0FkZHJlc3MgPSBuZXcgSG9zdEFkZHJlc3Mo\naG9zdCk7CiAgICAgICAgICAgICAgICAgICAgX2FkZHJlc3Nlcy5hZGQobmV3\nQWRkcmVzcyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShzX2xvYy5nZXQoInRjcC1hZGRyZXNzLXNldCIsCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBuZXdBZGRyZXNzLl9hZGRyZXNzLmdldEhvc3ROYW1l\nKCkgKyAiOiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIG5l\nd0FkZHJlc3MuX3BvcnQpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\nZmluYWxseSB7CiAgICAgICAgICAgIF9hZGRyZXNzZXNMb2NrLnVubG9jaygp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tIENvbmZpZ3Vy\nYWJsZSBpbXBsZW1lbnRhdGlvbiAtLS0tLS0tLS0tCgogICAgLyoqCiAgICAg\nKiBTdWJjbGFzc2VzIHRoYXQgbmVlZCB0byBwZXJmb3JtIGFjdGlvbnMgaW4K\nICAgICAqIHtAbGluayBDb25maWd1cmFibGUjZW5kQ29uZmlndXJhdGlvbn0g\nbXVzdCBpbnZva2UgdGhpcyBtZXRob2QuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgc3VwZXIuZW5kQ29u\nZmlndXJhdGlvbigpOwogICAgICAgIHN5bmNocm9uaXplZCAoc19wb3J0TGlz\ndGVuZXJNYXApIHsKICAgICAgICAgICAgLy8gc2VlIGlmIGEgbGlzdGVuZXIg\nZXhpc3RzIGZvciB0aGlzIHBvcnQuCiAgICAgICAgICAgIF9saXN0ZW5lciA9\nIChUQ1BQb3J0TGlzdGVuZXIpIHNfcG9ydExpc3RlbmVyTWFwLmdldAogICAg\nICAgICAgICAgICAgKFN0cmluZy52YWx1ZU9mKF9wb3J0KSk7CgogICAgICAg\nICAgICBpZiAoX2xpc3RlbmVyID09IG51bGwgfHwKICAgICAgICAgICAgICAg\nICghX2xpc3RlbmVyLmlzUnVubmluZygpICYmIF9saXN0ZW5lci5fcG9ydCA9\nPSBfcG9ydCkpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgX2xpc3RlbmVyID0gbmV3IFRDUFBvcnRMaXN0ZW5lcihfcG9y\ndCwgbG9nKTsKICAgICAgICAgICAgICAgICAgICBfbGlzdGVuZXIubGlzdGVu\nKCk7CiAgICAgICAgICAgICAgICAgICAgc19wb3J0TGlzdGVuZXJNYXAucHV0\nKFN0cmluZy52YWx1ZU9mKF9wb3J0KSwgX2xpc3RlbmVyKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oc19sb2MuZ2V0KCJ0\nY3AtaW5pdC1leGNlcHRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICBT\ndHJpbmcudmFsdWVPZihfcG9ydCkpLCBlKS5zZXRGYXRhbCh0cnVlKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChfbGlzdGVu\nZXIuaXNSdW5uaW5nKCkpIHsKICAgICAgICAgICAgICAgIGlmIChfbGlzdGVu\nZXIuX3BvcnQgIT0gX3BvcnQpIHsKICAgICAgICAgICAgICAgICAgICAvLyB0\naGlzIHJlYWxseSBzaG91bGRuJ3QgYmUgYWJsZSB0byBoYXBwZW4uCiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oc19s\nb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgICgidGNwLW5vdC1lcXVh\nbCIsIFN0cmluZy52YWx1ZU9mKF9wb3J0KSkpLgogICAgICAgICAgICAgICAg\nICAgICAgICBzZXRGYXRhbCh0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50\nZXJuYWxFeGNlcHRpb24oc19sb2MuZ2V0KCJ0Y3AtbGlzdGVuZXItYnJva2Vu\nIikpOwogICAgICAgICAgICBfbGlzdGVuZXIuYWRkUHJvdmlkZXIodGhpcyk7\nCiAgICAgICAgfQoKICAgICAgICBfYWRkcmVzc2VzTG9jay5sb2NrKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgSG9zdEFkZHJlc3MgY3VyQWRkcmVz\nczsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gX2FkZHJlc3Nl\ncy5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgICAgICBjdXJBZGRyZXNzID0gKEhvc3RBZGRyZXNz\nKSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgICAgIGN1ckFkZHJlc3Muc2V0\nTWF4QWN0aXZlKF9tYXhBY3RpdmUpOwogICAgICAgICAgICAgICAgY3VyQWRk\ncmVzcy5zZXRNYXhJZGxlKF9tYXhJZGxlKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgX2FkZHJlc3Nl\nc0xvY2sudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIC0tLS0t\nLS0tLS0gUmVtb3RlQ29tbWl0UHJvdmlkZXIgaW1wbGVtZW50YXRpb24gLS0t\nLS0tLS0tLQoKICAgIC8vIHByZSAzLjMuNAk9IDxubyB2ZXJzaW9uIG51bWJl\nciB0cmFuc21pdHRlZD4KICAgIC8vIDMuMyBQcmV2aWV3IAk9IDB4MTQyOGFj\nZmQ7CiAgICAvLyAzLjQgCQkJPSAweDE0MjhhY2ZmOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgbG9uZyBQUk9UT0NPTF9WRVJTSU9OID0gMHgxNDI4YWNm\nZjsKCiAgICBwdWJsaWMgdm9pZCBicm9hZGNhc3QoUmVtb3RlQ29tbWl0RXZl\nbnQgZXZlbnQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBidWls\nZCBhIHBhY2tldCBub3RpZnlpbmcgb3RoZXIgSlZNcyBvZiBvYmplY3QgY2hh\nbmdlcy4KICAgICAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGJhb3Mg\nPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgICAgICAgICAgIE9i\namVjdE91dHB1dFN0cmVhbSBvb3MgPSBuZXcgT2JqZWN0T3V0cHV0U3RyZWFt\nKGJhb3MpOwoKICAgICAgICAgICAgb29zLndyaXRlTG9uZyhQUk9UT0NPTF9W\nRVJTSU9OKTsKICAgICAgICAgICAgb29zLndyaXRlTG9uZyhfaWQpOwogICAg\nICAgICAgICBvb3Mud3JpdGVJbnQoX3BvcnQpOwogICAgICAgICAgICBvb3Mu\nd3JpdGVPYmplY3QoX2xvY2FsaG9zdCk7CiAgICAgICAgICAgIG9vcy53cml0\nZU9iamVjdChldmVudCk7CiAgICAgICAgICAgIG9vcy5mbHVzaCgpOwoKICAg\nICAgICAgICAgYnl0ZVtdIGJ5dGVzID0gYmFvcy50b0J5dGVBcnJheSgpOwog\nICAgICAgICAgICBiYW9zLmNsb3NlKCk7CiAgICAgICAgICAgIGlmIChfYnJv\nYWRjYXN0VGhyZWFkcy5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICBzZW5k\nVXBkYXRlUGFja2V0KGJ5dGVzKTsKICAgICAgICAgICAgZWxzZQogICAgICAg\nICAgICAgICAgX2Jyb2FkY2FzdFF1ZXVlLmFkZFBhY2tldChieXRlcyk7CiAg\nICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAg\nIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9n\nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtcGF5bG9hZC1jcmVhdGUtZXJyb3IiKSwg\naW9lKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZW5kcyBh\nIGNoYW5nZSBub3RpZmljYXRpb24gcGFja2V0IHRvIG90aGVyIG1hY2hpbmVz\nIGluIHRoaXMKICAgICAqIHByb3ZpZGVyIGNsdXN0ZXIuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBzZW5kVXBkYXRlUGFja2V0KGJ5dGVbXSBieXRlcykg\newogICAgICAgIF9hZGRyZXNzZXNMb2NrLmxvY2soKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBfYWRkcmVzc2Vz\nLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykKICAgICAgICAgICAgICAg\nICgoSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgpKS5zZW5kVXBkYXRlUGFja2V0\nKGJ5dGVzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfYWRk\ncmVzc2VzTG9jay51bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgaWYgKF9saXN0ZW5lciAhPSBu\ndWxsKQogICAgICAgICAgICBfbGlzdGVuZXIucmVtb3ZlUHJvdmlkZXIodGhp\ncyk7CgogICAgICAgIF9hZGRyZXNzZXNMb2NrLmxvY2soKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBfYWRkcmVz\nc2VzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykKICAgICAgICAgICAg\nICAgICgoSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgpKS5jbG9zZSgpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9hZGRyZXNzZXNMb2NrLnVu\nbG9jaygpOwogICAgICAgIH0KCiAgICAgICAgLy8gV2UgYXJlIGRvbmUgdHJh\nbnNtaXR0aW5nLiBJbnRlcnJ1cHQgYW55IHdvcmtlciB0aHJlYWRzLgogICAg\nICAgIHN5bmNocm9uaXplZCAoX2Jyb2FkY2FzdFRocmVhZHMpIHsKICAgICAg\nICAgICAgVGhyZWFkIHdvcmtlcjsKICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdGVyID0gX2Jyb2FkY2FzdFRocmVhZHMuaXRlcmF0b3IoKTsKICAgICAg\nICAgICAgICAgIGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAg\nd29ya2VyID0gKFRocmVhZCkgaXRlci5uZXh0KCk7CiAgICAgICAgICAgICAg\nICB3b3JrZXIuaW50ZXJydXB0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBVdGlsaXR5IGNsYXNzIHRvIGhvbGQg\nbWVzc2FnZXMgdG8gYmUgc2VudC4gVGhpcwogICAgICogYWxsb3dzIGNhbGxz\nIHRvIGJyb2FkY2FzdCAoKSB0byByZXR1cm4gd2l0aG91dAogICAgICogd2Fp\ndGluZyBmb3IgdGhlIHNlbmQgdG8gY29tcGxldGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgc3RhdGljIGNsYXNzIEJyb2FkY2FzdFF1ZXVlIHsKCiAgICAgICAg\nTGlua2VkTGlzdCBfcGFja2V0UXVldWUgPSBuZXcgTGlua2VkTGlzdCgpOwoK\nICAgICAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgYWRkUGFja2V0KGJ5\ndGVbXSBieXRlcykgewogICAgICAgICAgICBfcGFja2V0UXVldWUuYWRkTGFz\ndChieXRlcyk7CiAgICAgICAgICAgIG5vdGlmeSgpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHN5bmNocm9uaXplZCBieXRlW10gcmVtb3ZlUGFja2V0\nKCkKICAgICAgICAgICAgdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgd2hpbGUgKF9wYWNrZXRRdWV1ZS5pc0VtcHR5KCkpCiAg\nICAgICAgICAgICAgICB3YWl0KCk7CiAgICAgICAgICAgIHJldHVybiAoYnl0\nZVtdKSBfcGFja2V0UXVldWUucmVtb3ZlRmlyc3QoKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaHJlYWRzIHRvIGJyb2FkY2FzdCBwYWNr\nZXRzIHBsYWNlZCBpbiB0aGUge0BsaW5rIEJyb2FkY2FzdFF1ZXVlfS4KICAg\nICAqLwogICAgcHJpdmF0ZSBjbGFzcyBCcm9hZGNhc3RXb3JrZXJUaHJlYWQK\nICAgICAgICBleHRlbmRzIFRocmVhZCB7CgogICAgICAgIHByaXZhdGUgYm9v\nbGVhbiBfa2VlcFJ1bm5pbmcgPSB0cnVlOwoKICAgICAgICBwdWJsaWMgdm9p\nZCBydW4oKSB7CiAgICAgICAgICAgIHdoaWxlIChfa2VlcFJ1bm5pbmcpIHsK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgLy8g\nVGhpcyB3aWxsIGJsb2NrIHVudGlsIHRoZXJlIGlzIGEgcGFja2V0IHRvIHNl\nbmQuCiAgICAgICAgICAgICAgICAgICAgYnl0ZVtdIGJ5dGVzID0gX2Jyb2Fk\nY2FzdFF1ZXVlLnJlbW92ZVBhY2tldCgpOwogICAgICAgICAgICAgICAgICAg\nIHNlbmRVcGRhdGVQYWNrZXQoYnl0ZXMpOwogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgICAgIC8vIEVuZCB0aGUgdGhyZWFkLgogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRSdW5uaW5nKGJvb2xlYW4g\na2VlcFJ1bm5pbmcpIHsKICAgICAgICAgICAgX2tlZXBSdW5uaW5nID0ga2Vl\ncFJ1bm5pbmc7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVz\ncG9uc2libGUgZm9yIGxpc3RlbmluZyBmb3IgaW5jb21pbmcgcGFja2V0cyBh\nbmQgcHJvY2Vzc2luZyB0aGVtLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBjbGFzcyBUQ1BQb3J0TGlzdGVuZXIKICAgICAgICBpbXBsZW1lbnRzIFJ1\nbm5hYmxlIHsKCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIHNf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAgICAgKFRDUFBv\ncnRMaXN0ZW5lci5jbGFzcyk7CgogICAgICAgIHByaXZhdGUgZmluYWwgTG9n\nIF9sb2c7CiAgICAgICAgcHJpdmF0ZSBTZXJ2ZXJTb2NrZXQgX3JlY2VpdmVT\nb2NrZXQ7CiAgICAgICAgcHJpdmF0ZSBUaHJlYWQgX2FjY2VwdFRocmVhZDsK\nICAgICAgICBwcml2YXRlIFNldCBfcmVjZWl2ZXJUaHJlYWRzID0gbmV3IEhh\nc2hTZXQoKTsKICAgICAgICBwcml2YXRlIFNldCBfcHJvdmlkZXJzID0gbmV3\nIEhhc2hTZXQoKTsKCiAgICAgICAgLyoqCiAgICAgICAgICogQ2FjaGUgdGhl\nIGxvY2FsIElQIGFkZHJlc3MKICAgICAgICAgKi8KICAgICAgICBwcml2YXRl\nIGJ5dGVbXSBfbG9jYWxob3N0OwoKICAgICAgICAvKioKICAgICAgICAgKiBU\naGUgcG9ydCB0aGF0IHRoaXMgbGlzdGVuZXIgc2hvdWxkIGxpc3RlbiBvbi4g\nQ29uZmlndXJlZAogICAgICAgICAqIGJ5IFRDUFJlbW90ZUNvbW1pdFByb3Zp\nZGVyLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgaW50IF9wb3J0OwoK\nICAgICAgICAvKioKICAgICAgICAgKiBTaG91bGQgYmUgc2V0IHRvIDxjb2Rl\nPnRydWU8L2NvZGU+IG9uY2UgdGhlIGxpc3RlbmVyIGlzIGxpc3RlbmluZy4K\nICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIGJvb2xlYW4gX2lzUnVubmlu\nZyA9IGZhbHNlOwoKICAgICAgICAvKioKICAgICAgICAgKiBDb25zdHJ1Y3Qg\nYSBuZXcgVENQUG9ydExpc3RlbmVyIGNvbmZpZ3VyZWQgdG8gdXNlIHRoZSBz\ncGVjaWZpZWQgcG9ydC4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIFRD\nUFBvcnRMaXN0ZW5lcihpbnQgcG9ydCwgTG9nIGxvZykKICAgICAgICAgICAg\ndGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIF9wb3J0ID0gcG9ydDsKICAgICAgICAgICAgX2xvZyA9IGxv\nZzsKICAgICAgICAgICAgX3JlY2VpdmVTb2NrZXQgPSBuZXcgU2VydmVyU29j\na2V0KF9wb3J0KTsKICAgICAgICAgICAgX2xvY2FsaG9zdCA9IEluZXRBZGRy\nZXNzLmdldExvY2FsSG9zdCgpLmdldEFkZHJlc3MoKTsKCiAgICAgICAgICAg\nIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBf\nbG9nLmluZm8oc19sb2MuZ2V0KCJ0Y3Atc3RhcnQtbGlzdGVuZXIiLAogICAg\nICAgICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKF9wb3J0KSkpOwogICAg\nICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIGxpc3RlbigpIHsKICAgICAg\nICAgICAgX2FjY2VwdFRocmVhZCA9IG5ldyBUaHJlYWQodGhpcyk7CiAgICAg\nICAgICAgIF9hY2NlcHRUaHJlYWQuc2V0RGFlbW9uKHRydWUpOwogICAgICAg\nICAgICBfYWNjZXB0VGhyZWFkLnN0YXJ0KCk7CiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBBbGwgcHJvdmlkZXJzIGFkZGVkIGhlcmUgd2ls\nbCBiZSBub3RpZmllZCBvZiBhbnkgaW5jb21pbmcKICAgICAgICAgKiBwcm92\naWRlciBtZXNzYWdlcy4gVGhlcmUgd2lsbCBiZSBvbmUgb2YgdGhlc2UgcGVy\nCiAgICAgICAgICogQnJva2VyRmFjdG9yeSBpbiBhIGdpdmVuIEpWTS4KICAg\nICAgICAgKiB7QGxpbmsgVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIjZW5kQ29u\nZmlndXJhdGlvbn0gaW52b2tlcwogICAgICAgICAqIDxjb2RlPmFkZFByb3Zp\nZGVyPC9jb2RlPiB3aXRoIDxjb2RlPnRoaXM8L2NvZGU+IHVwb24KICAgICAg\nICAgKiBjb21wbGV0aW9uIG9mIGNvbmZpZ3VyYXRpb24uCiAgICAgICAgICov\nCiAgICAgICAgcHJpdmF0ZSB2b2lkIGFkZFByb3ZpZGVyKFRDUFJlbW90ZUNv\nbW1pdFByb3ZpZGVyIHByb3ZpZGVyKSB7CiAgICAgICAgICAgIHN5bmNocm9u\naXplZCAoX3Byb3ZpZGVycykgewogICAgICAgICAgICAgICAgX3Byb3ZpZGVy\ncy5hZGQocHJvdmlkZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICAvKioKICAgICAgICAgKiBSZW1vdmUgYSBwcm92aWRlciBmcm9tIHRo\nZSBsaXN0IG9mIHByb3ZpZGVycyB0byBub3RpZnkgb2YKICAgICAgICAgKiBj\nb21taXQgZXZlbnRzLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgc3lu\nY2hyb25pemVkIHZvaWQgcmVtb3ZlUHJvdmlkZXIKICAgICAgICAgICAgKFRD\nUFJlbW90ZUNvbW1pdFByb3ZpZGVyIHByb3ZpZGVyKSB7CiAgICAgICAgICAg\nIHN5bmNocm9uaXplZCAoX3Byb3ZpZGVycykgewogICAgICAgICAgICAgICAg\nX3Byb3ZpZGVycy5yZW1vdmUocHJvdmlkZXIpOwoKICAgICAgICAgICAgICAg\nIC8vIGlmIHRoZSBwcm92aWRlciBsaXN0IGlzIGVtcHR5LCBzaHV0IGRvd24g\ndGhlIHRocmVhZC4KICAgICAgICAgICAgICAgIGlmIChfcHJvdmlkZXJzLnNp\nemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgX2lzUnVubmluZyA9\nIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIF9yZWNlaXZlU29ja2V0LmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihzX2xvYy5n\nZXQoInRjcC1jbG9zZS1lcnJvciIpLCBpb2UpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICBfYWNjZXB0VGhyZWFkLmludGVy\ncnVwdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBwcml2YXRlIGJvb2xlYW4gaXNSdW5uaW5nKCkgewog\nICAgICAgICAgICBzeW5jaHJvbml6ZWQgKF9wcm92aWRlcnMpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiBfaXNSdW5uaW5nOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nICAgIHN5bmNocm9uaXplZCAoX3Byb3ZpZGVycykgewogICAgICAgICAgICAg\nICAgX2lzUnVubmluZyA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIFNvY2tldCBzID0gbnVsbDsKICAgICAgICAgICAgd2hpbGUgKF9pc1J1\nbm5pbmcpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICAgICAgcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgLy8gQmxvY2ss\nIHdhaXRpbmcgdG8gYWNjZXB0IG5ldyBjb25uZWN0aW9uIGZyb20gYSBwZWVy\nCiAgICAgICAgICAgICAgICAgICAgcyA9IF9yZWNlaXZlU29ja2V0LmFjY2Vw\ndCgpOwogICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFi\nbGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy50cmFjZShz\nX2xvYy5nZXQoInRjcC1yZWNlaXZlZC1jb25uZWN0aW9uIiwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHMuZ2V0SW5ldEFkZHJlc3MoKS5nZXRIb3N0\nQWRkcmVzcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAi\nOiIgKyBzLmdldFBvcnQoKSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICBSZWNlaXZlU29ja2V0SGFuZGxlciBzaCA9IG5l\ndyBSZWNlaXZlU29ja2V0SGFuZGxlcihzKTsKICAgICAgICAgICAgICAgICAg\nICBUaHJlYWQgcmVjZWl2ZXJUaHJlYWQgPSBuZXcgVGhyZWFkKHNoKTsKICAg\nICAgICAgICAgICAgICAgICByZWNlaXZlclRocmVhZC5zZXREYWVtb24odHJ1\nZSk7CiAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZXJUaHJlYWQuc3RhcnQo\nKTsKICAgICAgICAgICAgICAgICAgICBfcmVjZWl2ZXJUaHJlYWRzLmFkZChy\nZWNlaXZlclRocmVhZCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIGlmICghKGUgaW5zdGFu\nY2VvZiBTb2NrZXRFeGNlcHRpb24pIHx8IF9pc1J1bm5pbmcpCiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJsZWQoKSkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihzX2xvYy5nZXQo\nInRjcC1hY2NlcHQtZXJyb3IiKSwgZSk7CgogICAgICAgICAgICAgICAgICAg\nIC8vIE5vbWluYWwgY2FzZSAoSW50ZXJydXB0ZWRFeGNlcHRpb24pIGJlY2F1\nc2UgY2xvc2UgKCkKICAgICAgICAgICAgICAgICAgICAvLyBjYWxscyBfYWNj\nZXB0VGhyZWFkLmludGVycnVwdCAoKTsKICAgICAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocyAhPSBudWxsKQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcy5jbG9zZSgpOwogICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlZSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFibGVkKCkpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4oc19sb2MuZ2V0\nKCJ0Y3AtY2xvc2UtZXJyb3IiKSwgZSk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAg\nICAvLyBXZSBhcmUgZG9uZSBsaXN0ZW5pbmcuIEludGVycnVwdCBhbnkgd29y\na2VyIHRocmVhZHMuCiAgICAgICAgICAgIFRocmVhZCB3b3JrZXI7CiAgICAg\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IF9yZWNlaXZlclRocmVhZHMu\naXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIGl0ZXIuaGFzTmV4dCgpOykg\newogICAgICAgICAgICAgICAgd29ya2VyID0gKFRocmVhZCkgaXRlci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICAvLyBGWUksIHRoZSB3b3JrZXIgdGhyZWFk\ncyBhcmUgYmxvY2tlZAogICAgICAgICAgICAgICAgLy8gcmVhZGluZyBmcm9t\nIHRoZSBzb2NrZXQncyBJbnB1dFN0cmVhbS4gSW5wdXRTdHJlYW1zCiAgICAg\nICAgICAgICAgICAvLyBhcmVuJ3QgaW50ZXJydXB0YWJsZSwgc28gdGhpcyBp\nbnRlcnJ1cHQgaXNuJ3QKICAgICAgICAgICAgICAgIC8vIHJlYWxseSBnb2lu\nZyB0byBiZSBkZWxpdmVyZWQgdW50aWwgc29tZXRoaW5nIGJyZWFrcwogICAg\nICAgICAgICAgICAgLy8gdGhlIElucHV0U3RyZWFtLgogICAgICAgICAgICAg\nICAgd29ya2VyLmludGVycnVwdCgpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHN5bmNocm9uaXplZCAoX3Byb3ZpZGVycykgewogICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2lzUnVubmluZykK\nICAgICAgICAgICAgICAgICAgICAgICAgX3JlY2VpdmVTb2NrZXQuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4oc19sb2MuZ2V0KCJ0\nY3AtY2xvc2UtZXJyb3IiKSwgZSk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICBfaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAg\nICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nICAgIF9sb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3AtY2xvc2UtbGlzdGVuZXIi\nLAogICAgICAgICAgICAgICAgICAgICAgICBfcG9ydCArICIiKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFV0\naWxpdHkgY2xhc3MgdGhhdCBhY3RzIGFzIGEgd29ya2VyIHRocmVhZCB0byBy\nZWNlaXZlIEV2ZW50cwogICAgICAgICAqIGZyb20gYnJvYWRjYXN0ZXJzLgog\nICAgICAgICAqLwogICAgICAgIHByaXZhdGUgY2xhc3MgUmVjZWl2ZVNvY2tl\ndEhhbmRsZXIKICAgICAgICAgICAgaW1wbGVtZW50cyBSdW5uYWJsZSB7Cgog\nICAgICAgICAgICBwcml2YXRlIElucHV0U3RyZWFtIF9pbjsKICAgICAgICAg\nICAgcHJpdmF0ZSBTb2NrZXQgX3M7CgogICAgICAgICAgICBwcml2YXRlIFJl\nY2VpdmVTb2NrZXRIYW5kbGVyKFNvY2tldCBzKSB7CiAgICAgICAgICAgICAg\nICAvLyBXZSBhcmUgdGhlIHJlY2VpdmluZyBlbmQgYW5kIHdlIGRvbid0IHNl\nbmQgYW55IG1lc3NhZ2VzCiAgICAgICAgICAgICAgICAvLyBiYWNrIHRvIHRo\nZSBicm9hZGNhc3Rlci4gVHVybiBvZmYgTmFnbGUncyBzbyB0aGF0CiAgICAg\nICAgICAgICAgICAvLyB3ZSB3aWxsIHNlbmQgYWNrIHBhY2tldHMgd2l0aG91\ndCB3YWl0aW5nLgogICAgICAgICAgICAgICAgX3MgPSBzOwogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBfcy5zZXRUY3BOb0Rl\nbGF5KHRydWUpOwogICAgICAgICAgICAgICAgICAgIF9pbiA9IG5ldyBCdWZm\nZXJlZElucHV0U3RyZWFtKHMuZ2V0SW5wdXRTdHJlYW0oKSk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIF9sb2cuaW5mbyhzX2xvYy5nZXQoInRjcC1zb2Nr\nZXQtb3B0aW9uLWVycm9yIiksIGlvZSk7CiAgICAgICAgICAgICAgICAgICAg\nX3MgPSBudWxsOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihzX2xv\nYy5nZXQoInRjcC1yZWNlaXZlLWVycm9yIiksIGUpOwogICAgICAgICAgICAg\nICAgICAgIF9zID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAg\nICAgICAgICAgaWYgKF9zID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgd2hpbGUgKF9pc1J1bm5pbmcgJiYg\nX3MgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBibG9jayBvdXIgdGhy\nZWFkLCB3YWl0aW5nIHRvIHJlYWQKICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gdGhlIG5leHQgRXZlbnQtb2JqZWN0LW1lc3NhZ2UuCiAgICAgICAgICAg\nICAgICAgICAgICAgIGhhbmRsZShfaW4pOwogICAgICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKEVPRkV4Y2VwdGlvbiBlb2YpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gRU9GRXhjZXB0aW9uIHJhaXNlZCB3aGVuIHBlZXIgaXMg\ncHJvcGVybHkKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xvc2luZyBp\ndHMgZW5kLgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1Ry\nYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBf\nbG9nLnRyYWNlKHNfbG9jLmdldCgidGNwLWNsb3NlLXNvY2tldCIsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgX3MuZ2V0SW5ldEFkZHJlc3Mo\nKS5nZXRIb3N0QWRkcmVzcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIjoiICsgX3MuZ2V0UG9ydCgpKSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNXYXJuRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53YXJuKHNf\nbG9jLmdldCgidGNwLXJlY2VpdmUtZXJyb3IiKSwgZSk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gV2UgYXJlIGRvbmUg\ncmVjZWl2aW5nIG9uIHRoaXMgc29ja2V0IGFuZCB0aGlzIHdvcmtlcgogICAg\nICAgICAgICAgICAgLy8gdGhyZWFkIGlzIHRlcm1pbmF0aW5nLgogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBfaW4uY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgICAgICBfcy5jbG9zZSgpOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nICAgICBfbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtY2xvc2Utc29ja2V0LWVy\ncm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgX3MuZ2V0SW5ldEFkZHJl\nc3MoKS5nZXRIb3N0QWRkcmVzcygpICsgIjoiCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArIF9zLmdldFBvcnQoKSksIGUpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioKICAgICAgICAg\nICAgICogUHJvY2VzcyBhbiB7QGxpbmsgSW5wdXRTdHJlYW19IGNvbnRhaW5p\nbmcgb2JqZWN0cyB3cml0dGVuCiAgICAgICAgICAgICAqIGJ5IHtAbGluayBU\nQ1BSZW1vdGVDb21taXRQcm92aWRlciNicm9hZGNhc3RDb21taXRJbmZvfS4K\nICAgICAgICAgICAgICovCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBoYW5k\nbGUoSW5wdXRTdHJlYW0gaW4pCiAgICAgICAgICAgICAgICB0aHJvd3MgSU9F\neGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24sCiAgICAgICAgICAg\nICAgICBPcHRpb25hbERhdGFFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nLy8gVGhpcyB3aWxsIGJsb2NrIHdhaXRpbmcgZm9yIHRoZSBuZXh0CiAgICAg\nICAgICAgICAgICBPYmplY3RJbnB1dFN0cmVhbSBvaXMgPSBuZXcgT2JqZWN0\nSW5wdXRTdHJlYW0oaW4pOwoKICAgICAgICAgICAgICAgIGxvbmcgcHJvdG9j\nb2xWZXJzaW9uID0gb2lzLnJlYWRMb25nKCk7CiAgICAgICAgICAgICAgICBp\nZiAocHJvdG9jb2xWZXJzaW9uICE9IFBST1RPQ09MX1ZFUlNJT04pIHsKICAg\nICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFibGVkKCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53YXJuKHNfbG9jLmdldCgi\ndGNwLXdyb25nLXZlcnNpb24tZXJyb3IiLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgX3MuZ2V0SW5ldEFkZHJlc3MoKS5nZXRIb3N0QWRkcmVzcygp\nICsgIjoiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBfcy5n\nZXRQb3J0KCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgICAgICBsb25nIHNlbmRlcklkID0gb2lzLnJlYWRMb25nKCk7CiAg\nICAgICAgICAgICAgICBpbnQgc2VuZGVyUG9ydCA9IG9pcy5yZWFkSW50KCk7\nCiAgICAgICAgICAgICAgICBieXRlW10gc2VuZGVyQWRkcmVzcyA9IChieXRl\nW10pIG9pcy5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgICAgICBSZW1vdGVD\nb21taXRFdmVudCByY2UgPSAoUmVtb3RlQ29tbWl0RXZlbnQpIG9pcy5yZWFk\nT2JqZWN0KCk7CiAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5h\nYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgX2xvZy50cmFjZShzX2xv\nYy5nZXQoInRjcC1yZWNlaXZlZC1ldmVudCIsCiAgICAgICAgICAgICAgICAg\nICAgICAgIF9zLmdldEluZXRBZGRyZXNzKCkuZ2V0SG9zdEFkZHJlc3MoKSAr\nICI6IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBfcy5nZXRQb3J0\nKCkpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBib29s\nZWFuIGZyb21TZWxmID0gc2VuZGVyUG9ydCA9PSBfcG9ydCAmJgogICAgICAg\nICAgICAgICAgICAgIEFycmF5cy5lcXVhbHMoc2VuZGVyQWRkcmVzcywgX2xv\nY2FsaG9zdCk7CiAgICAgICAgICAgICAgICBUQ1BSZW1vdGVDb21taXRQcm92\naWRlciBwcm92aWRlcjsKICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAo\nX3Byb3ZpZGVycykgewogICAgICAgICAgICAgICAgICAgIC8vIGJsZWFpcjog\nV2UncmUgaXRlcmF0aW5nLCBidXQgY3VycmVubHR5IHRoZXJlIGNhbiByZWFs\nbHkKICAgICAgICAgICAgICAgICAgICAvLyBvbmx5IGJlIGEgc2luZ2xlIHBy\nb3ZpZGVyLgogICAgICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRl\nciA9IF9wcm92aWRlcnMuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHByb3ZpZGVyID0gKFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVyKSBpdGVy\nLm5leHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmRlcklk\nICE9IHByb3ZpZGVyLl9pZCB8fCAhZnJvbVNlbGYpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBwcm92aWRlci5ldmVudE1hbmFnZXIuZmlyZUV2ZW50\nKHJjZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogVXRpbGl0eSBjbGFzcyB0byBzdG9yZSBhbiBJbmV0QWRkcmVzcyBhbmQg\nYW4gaW50LiBOb3QgdXNpbmcKICAgICAqIEluZXRTb2NrZXRBZGRyZXNzIGJl\nY2F1c2UgaXQncyBhIEpESzEuNCBBUEkuIFRoaXMgYWxzbwogICAgICogcHJv\ndmlkZXMgYSB3cmFwcGVyIGFyb3VuZCB0aGUgc29ja2V0KHMpIGFzc29jaWF0\nZWQgd2l0aCB0aGlzIGFkZHJlc3MuCiAgICAgKi8KICAgIHByaXZhdGUgY2xh\nc3MgSG9zdEFkZHJlc3MgewoKICAgICAgICBwcml2YXRlIEluZXRBZGRyZXNz\nIF9hZGRyZXNzOwogICAgICAgIHByaXZhdGUgaW50IF9wb3J0OwogICAgICAg\nIHByaXZhdGUgbG9uZyBfdGltZUxhc3RFcnJvcjsgLy8gbWlsbGlzCiAgICAg\nICAgcHJpdmF0ZSBib29sZWFuIF9pc0F2YWlsYWJsZTsgLy8gaXMgcGVlciB0\naG91Z2h0IHRvIGJlIHVwCiAgICAgICAgcHJpdmF0ZSBpbnQgX2luZm9zSXNz\ndWVkID0gMDsgLy8gbGltaXQgbG9nIGVudHJpZXMKCiAgICAgICAgcHJpdmF0\nZSBHZW5lcmljT2JqZWN0UG9vbCBfc29ja2V0UG9vbDsgLy8gcmV1c2FibGUg\nb3BlbiBzb2NrZXRzCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnN0cnVj\ndCBhIG5ldyBob3N0IGFkZHJlc3MgZnJvbSBhIHN0cmluZyBvZiB0aGUgZm9y\nbQogICAgICAgICAqICJob3N0OnBvcnQiIG9yIG9mIHRoZSBmb3JtICJob3N0\nIi4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIEhvc3RBZGRyZXNzKFN0\ncmluZyBob3N0KQogICAgICAgICAgICB0aHJvd3MgVW5rbm93bkhvc3RFeGNl\ncHRpb24gewogICAgICAgICAgICBpbnQgY29sb24gPSBob3N0LmluZGV4T2Yo\nJzonKTsKICAgICAgICAgICAgaWYgKGNvbG9uICE9IC0xKSB7CiAgICAgICAg\nICAgICAgICBfYWRkcmVzcyA9IEluZXRBZGRyZXNzLmdldEJ5TmFtZShob3N0\nLnN1YnN0cmluZygwLCBjb2xvbikpOwogICAgICAgICAgICAgICAgX3BvcnQg\nPSBJbnRlZ2VyLnBhcnNlSW50KGhvc3Quc3Vic3RyaW5nKGNvbG9uICsgMSkp\nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX2FkZHJl\nc3MgPSBJbmV0QWRkcmVzcy5nZXRCeU5hbWUoaG9zdCk7CiAgICAgICAgICAg\nICAgICBfcG9ydCA9IERFRkFVTFRfUE9SVDsKICAgICAgICAgICAgfQogICAg\nICAgICAgICAvLyAtMSBtYXggd2FpdCA9PSBhcyBsb25nIGFzIGl0IHRha2Vz\nCiAgICAgICAgICAgIF9zb2NrZXRQb29sID0gbmV3IEdlbmVyaWNPYmplY3RQ\nb29sCiAgICAgICAgICAgICAgICAobmV3IFNvY2tldFBvb2xhYmxlT2JqZWN0\nRmFjdG9yeSgpLCBfbWF4QWN0aXZlLAogICAgICAgICAgICAgICAgICAgIEdl\nbmVyaWNPYmplY3RQb29sLldIRU5fRVhIQVVTVEVEX0JMT0NLLCAtMSk7CiAg\nICAgICAgICAgIF9pc0F2YWlsYWJsZSA9IHRydWU7CiAgICAgICAgfQoKICAg\nICAgICBwcml2YXRlIHZvaWQgc2V0TWF4QWN0aXZlKGludCBtYXhBY3RpdmUp\nIHsKICAgICAgICAgICAgX3NvY2tldFBvb2wuc2V0TWF4QWN0aXZlKG1heEFj\ndGl2ZSk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgc2V0TWF4\nSWRsZShpbnQgbWF4SWRsZSkgewogICAgICAgICAgICBfc29ja2V0UG9vbC5z\nZXRNYXhJZGxlKG1heElkbGUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgICAgIC8vIENsb3NlIHRoZSBwb29s\nIG9mIHNvY2tldHMgdG8gdGhpcyBwZWVyLiBUaGlzCiAgICAgICAgICAgIC8v\nIHdpbGwgY2xvc2UgYWxsIHNvY2tldHMgaW4gdGhlIHBvb2wuCiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfc29ja2V0UG9vbC5jbG9zZSgp\nOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoInRjcC1jbG9zZS1wb29s\nLWVycm9yIiksIGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgc2VuZFVwZGF0ZVBh\nY2tldChieXRlW10gYnl0ZXMpIHsKICAgICAgICAgICAgaWYgKCFfaXNBdmFp\nbGFibGUpIHsKICAgICAgICAgICAgICAgIGxvbmcgbm93ID0gU3lzdGVtLmN1\ncnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICBpZiAobm93IC0g\nX3RpbWVMYXN0RXJyb3IgPCBfcmVjb3ZlcnlUaW1lTWlsbGlzKQogICAgICAg\nICAgICAgICAgICAgIC8vIE5vdCBlbm91Z2ggdGltZSBoYXMgcGFzc2VkIHNp\nbmNlIHRoZSBsYXN0IGVycm9yCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIFNvY2tldCBzID0gbnVsbDsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHMgPSBnZXRTb2Nr\nZXQoKTsKICAgICAgICAgICAgICAgIE91dHB1dFN0cmVhbSBvcyA9IHMuZ2V0\nT3V0cHV0U3RyZWFtKCk7CiAgICAgICAgICAgICAgICBvcy53cml0ZShieXRl\ncyk7CiAgICAgICAgICAgICAgICBvcy5mbHVzaCgpOwoKICAgICAgICAgICAg\nICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAg\nICAgICAgIGxvZy50cmFjZShzX2xvYy5nZXQoInRjcC1zZW50LXVwZGF0ZSIs\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNzLmdldEhvc3RBZGRy\nZXNzKCkgKyAiOiIgKyBfcG9ydCwKICAgICAgICAgICAgICAgICAgICAgICAg\nU3RyaW5nLnZhbHVlT2Yocy5nZXRMb2NhbFBvcnQoKSkpKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIF9pc0F2YWlsYWJsZSA9IHRydWU7\nCiAgICAgICAgICAgICAgICBfaW5mb3NJc3N1ZWQgPSAwOwogICAgICAgICAg\nICAgICAgLy8gUmV0dXJuIHRoZSBzb2NrZXQgdG8gdGhlIHBvb2w7IHRoZSBz\nb2NrZXQgaXMKICAgICAgICAgICAgICAgIC8vIHN0aWxsIGdvb2QuCiAgICAg\nICAgICAgICAgICByZXR1cm5Tb2NrZXQocyk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBUaGVyZSBo\nYXMgYmVlbiBhIHByb2JsZW0gc2VuZGluZyB0byB0aGUgcGVlci4KICAgICAg\nICAgICAgICAgIC8vIFRoZSBPUyBzb2NrZXQgdGhhdCB3YXMgYmVpbmcgdXNl\nZCBpcyBjYW4gbm8gbG9uZ2VyCiAgICAgICAgICAgICAgICAvLyBiZSB1c2Vk\nLgogICAgICAgICAgICAgICAgaWYgKHMgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICB0aGlzLmNsb3NlU29ja2V0KHMpOwogICAgICAgICAgICAgICAg\ndGhpcy5jbGVhckFsbFNvY2tldHMoKTsKCiAgICAgICAgICAgICAgICBpZiAo\nX2lzQXZhaWxhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGEg\nd2FybmluZywgdGhlIHBlZXIgd2FzIHVwIGFuZCBoYXMgbm93IGdvbmUgZG93\nbgogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKHNfbG9jLmdl\ndCgidGNwLXNlbmQtZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgX2FkZHJlc3MuZ2V0SG9zdEFkZHJlc3MoKSArICI6IiArIF9wb3J0KSwg\nZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIF9pc0F2YWlsYWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIC8v\nIE9uY2UgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZCB3ZSB3aWxsIGxvZyBhbm90\naGVyIHdhcm5pbmcKICAgICAgICAgICAgICAgICAgICBfdGltZUxhc3RFcnJv\nciA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsb25nIG5vdyA9IFN5\nc3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgICAg\nIGlmIChub3cgLSBfdGltZUxhc3RFcnJvciA+IF9yZWNvdmVyeVRpbWVNaWxs\naXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9pbmZvc0lzc3Vl\nZCA8IDUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVub3Vn\naCB0aW1lIGhhcyBwYXNzZWQsIGFuZCBwZWVyIGlzIHN0aWxsIGRvd24KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIF90aW1lTGFzdEVycm9yID0gU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAvLyBXZSB3ZXJlIHRyeWluZyB0byByZWVzdGFibGlzaCB0aGUg\nY29ubmVjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1\ndCB3ZSBmYWlsZWQgYWdhaW4uIExvZyBhIG1lc3NhZ2UsIGJ1dAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgLy8gbG93ZXIgc2V2ZXJpdHkuIFRoaXMg\nbG9nIHdpbGwgb2NjdXIgcGVyaW9kaWNhbGx5CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAvLyBmb3IgNSB0aW1lcyB1bnRpbCB0aGUgcGVlciBjb21l\ncyBiYWNrLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5p\nc0luZm9FbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBsb2cuaW5mbyhzX2xvYy5nZXQoInRjcC1zZW5kLXN0aWxsLWVycm9y\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FkZHJl\nc3MuZ2V0SG9zdEFkZHJlc3MoKSArICI6IgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyBfcG9ydCksIGUpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgX2luZm9zSXNzdWVkKys7CiAgICAgICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZhdGUgU29ja2V0IGdl\ndFNvY2tldCgpCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgICAgICByZXR1cm4gKFNvY2tldCkgX3NvY2tldFBvb2wuYm9ycm93T2Jq\nZWN0KCk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgcmV0dXJu\nU29ja2V0KFNvY2tldCBzKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgX3NvY2tldFBvb2wucmV0dXJuT2JqZWN0KHMpOwog\nICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIGNsZWFyQWxsU29ja2V0\ncygpIHsKICAgICAgICAgICAgX3NvY2tldFBvb2wuY2xlYXIoKTsKICAgICAg\nICB9CgogICAgICAgIHByaXZhdGUgdm9pZCBjbG9zZVNvY2tldChTb2NrZXQg\ncykgewogICAgICAgICAgICAvLyBBbGwgc29ja2V0cyBjb21lIGZyb20gdGhl\nIHBvb2wuCiAgICAgICAgICAgIC8vIFRoaXMgc29ja2V0IGlzIG5vIGxvbmdl\nciB1c2FibGUsIHNvIGRlbGV0ZSBpdCBmcm9tIHRoZQogICAgICAgICAgICAv\nLyBwb29sLgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX3Nv\nY2tldFBvb2wuaW52YWxpZGF0ZU9iamVjdChzKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgLyoqCiAgICAgICAgICogRmFjdG9yeSBmb3IgcG9vbGVkIHNv\nY2tldHMuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBjbGFzcyBTb2Nr\nZXRQb29sYWJsZU9iamVjdEZhY3RvcnkKICAgICAgICAgICAgaW1wbGVtZW50\ncyBQb29sYWJsZU9iamVjdEZhY3RvcnkgewoKICAgICAgICAgICAgcHVibGlj\nIE9iamVjdCBtYWtlT2JqZWN0KCkKICAgICAgICAgICAgICAgIHRocm93cyBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBTb2NrZXQgcyA9IG5ldyBT\nb2NrZXQoX2FkZHJlc3MsIF9wb3J0KTsKICAgICAgICAgICAgICAgIGlmIChs\nb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgIGxv\nZy50cmFjZShzX2xvYy5nZXQoInRjcC1vcGVuLWNvbm5lY3Rpb24iLAogICAg\nICAgICAgICAgICAgICAgICAgICBfYWRkcmVzcyArICI6IiArIF9wb3J0LCAi\nIiArIHMuZ2V0TG9jYWxQb3J0KCkpKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIHJldHVybiBzOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgdm9pZCBkZXN0cm95T2JqZWN0KE9iamVjdCBvYmopIHsK\nICAgICAgICAgICAgICAgIC8vIHNpbGVudENsb3NlICgpLgogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBTb2NrZXQgcyA9IChT\nb2NrZXQpIG9iajsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJh\nY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShzX2xvYy5nZXQoInRjcC1jbG9zZS1zZW5kaW5nLXNvY2tldCIsCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBfYWRkcmVzcyArICI6IiArIF9wb3J0\nLCAiIiArIHMuZ2V0TG9jYWxQb3J0KCkpKTsKICAgICAgICAgICAgICAgICAg\nICBzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKHNfbG9jLmdl\ndCgidGNwLWNsb3NlLXNvY2tldC1lcnJvciIsCiAgICAgICAgICAgICAgICAg\nICAgICAgIF9hZGRyZXNzLmdldEhvc3RBZGRyZXNzKCkgKyAiOiIgKyBfcG9y\ndCksIGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgYm9vbGVhbiB2YWxpZGF0ZU9iamVjdChPYmplY3Qg\nb2JqKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgYWN0aXZhdGVPYmplY3Qg\nKE9iamVjdCB2YWx1ZSkKCQkJewoJCQl9CgoJCQlwdWJsaWMgdm9pZCBwYXNz\naXZhdGVPYmplY3QgKE9iamVjdCB2YWx1ZSkKCQkJewoJCQl9CgkJfQoJfQp9\nCg==\n","encoding":"base64"}

