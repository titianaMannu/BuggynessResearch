{"sha":"1ef002f83881d86b44c8bbdd147b60719c6e2f28","node_id":"MDQ6QmxvYjIwNjM2NDoxZWYwMDJmODM4ODFkODZiNDRjOGJiZGQxNDdiNjA3MTljNmUyZjI4","size":22274,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1ef002f83881d86b44c8bbdd147b60719c6e2f28","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWw7CgppbXBvcnQgamF2YS5pby5PYmplY3RTdHJlYW1F\neGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQg\namF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVj\ndGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEu\ndXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBq\nYXZhLnV0aWwuUHJvcGVydGllczsKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9u\nLlN0YXR1czsKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLlN5bmNocm9uaXph\ndGlvbjsKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLlRyYW5zYWN0aW9uOwpp\nbXBvcnQgamF2YXgudHJhbnNhY3Rpb24uVHJhbnNhY3Rpb25NYW5hZ2VyOwoK\naW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBB\nVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUu\nRGF0YUNhY2hlU3RvcmVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmVuaGFuY2UuUENSZWdpc3RyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5ldmVudC5SZW1vdGVDb21taXRFdmVudE1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLlJlZmVyZW5jZUhhc2hTZXQ7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVudC5SZWVu\ndHJhbnRMb2NrOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0\nYURhdGFSZXBvc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKLyoqCiAqIEFi\nc3RyYWN0IGltcGxlbWVudGF0aW9uIG9mIHRoZSB7QGxpbmsgQnJva2VyRmFj\ndG9yeX0KICogdGhhdCBtdXN0IGJlIHN1YmNsYXNzZWQgZm9yIGEgc3BlY2lm\naWMgcnVudGltZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1Ymxp\nYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdEJyb2tlckZhY3RvcnkKICAgIGlt\ncGxlbWVudHMgQnJva2VyRmFjdG9yeSB7CgogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQog\nICAgICAgIChBYnN0cmFjdEJyb2tlckZhY3RvcnkuY2xhc3MpOwoKICAgIC8v\nIHN0YXRpYyBtYXBwaW5nIG9mIGNvbmZpZ3VyYXRpb25zIHRvIHBvb2xlZCBi\ncm9rZXIgZmFjdG9yaWVzCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBNYXAg\nX3Bvb2wgPSBDb2xsZWN0aW9ucy5zeW5jaHJvbml6ZWRNYXAKICAgICAgICAo\nbmV3IEhhc2hNYXAoKSk7CgogICAgLy8gY29uZmlndXJhdGlvbgogICAgcHJp\ndmF0ZSBmaW5hbCBPcGVuSlBBQ29uZmlndXJhdGlvbiBfY29uZjsKICAgIHBy\naXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX3JlYWRPbmx5ID0gZmFsc2U7CiAg\nICBwcml2YXRlIHRyYW5zaWVudCBSdW50aW1lRXhjZXB0aW9uIF9jbG9zZWQg\nPSBudWxsOwogICAgcHJpdmF0ZSBNYXAgX3VzZXJPYmplY3RzID0gbnVsbDsK\nCiAgICAvLyBpbnRlcm5hbCBsb2NrOiBzcGVjIGZvcmJpZHMgc3luY2hyb25p\nemF0aW9uIG9uIHRoaXMgb2JqZWN0CiAgICBwcml2YXRlIGZpbmFsIFJlZW50\ncmFudExvY2sgX2xvY2sgPSBuZXcgUmVlbnRyYW50TG9jaygpOwoKICAgIC8v\nIG1hcHMgZ2xvYmFsIHRyYW5zYWN0aW9ucyB0byBhc3NvY2lhdGVkIGJyb2tl\ncnMKICAgIHByaXZhdGUgdHJhbnNpZW50IE1hcCBfdHJhbnNhY3Rpb25hbCA9\nIG5ldyBIYXNoTWFwKCk7CgogICAgLy8gd2Vhay1yZWYgdHJhY2tpbmcgb2Yg\nb3BlbiBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5zaWVudCBDb2xsZWN0aW9u\nIF9icm9rZXJzID0gbmV3IFJlZmVyZW5jZUhhc2hTZXQKICAgICAgICAoUmVm\nZXJlbmNlSGFzaFNldC5XRUFLKTsKCiAgICAvLyBjYWNoZSB0aGUgY2xhc3Mg\nbmFtZXMgbG9hZGVkIGZyb20gdGhlIHBlcnNpc3RlbnQgY2xhc3NlcyBwcm9w\nZXJ0eSBzbwogICAgLy8gdGhhdCB3ZSBjYW4gcmUtbG9hZCB0aGVtIGZvciBl\nYWNoIG5ldyBicm9rZXIKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rp\nb24gX3BjQ2xhc3NOYW1lcyA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBDb2xsZWN0aW9uIF9wY0NsYXNzTG9hZGVycyA9IG51bGw7CgogICAgLy8g\nbGlmZWN5Y2xlIGxpc3RlbmVycyB0byBwYXNzIHRvIGVhY2ggYnJva2VyCiAg\nICBwcml2YXRlIHRyYW5zaWVudCBNYXAgX2xpZmVjeWNsZUxpc3RlbmVycyA9\nIG51bGw7CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHBvb2xlZCBmYWN0\nb3J5IG1hdGNoaW5nIHRoZSBnaXZlbiBjb25maWd1cmF0aW9uLCBvciBudWxs\nCiAgICAgKiBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIEFi\nc3RyYWN0QnJva2VyRmFjdG9yeSBnZXRQb29sZWRGYWN0b3J5KAogICAgICAg\nIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICByZXR1cm4g\nKEFic3RyYWN0QnJva2VyRmFjdG9yeSkgX3Bvb2wuZ2V0KHRvUG9vbEtleShj\nb25mKSk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgTWFwIHRvUG9vbEtl\neShPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgcmV0dXJu\nIGNvbmYudG9Qcm9wZXJ0aWVzKGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgcG9vbGVkIGZhY3RvcnkgbWF0Y2hpbmcgdGhlIGdp\ndmVuIGNvbmZpZ3VyYXRpb24gZGF0YSwgb3IgbnVsbAogICAgICogaWYgbm9u\nZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBBYnN0cmFjdEJyb2tl\nckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeShNYXAgbWFwKSB7CiAgICAgICAg\ncmV0dXJuIChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9wb29sLmdldChtYXAp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuIENvbmZpZ3Vy\nYXRpb24gbXVzdCBiZSBwcm92aWRlZCBvbiBjb25zdHJ1Y3Rpb24uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBBYnN0cmFjdEJyb2tlckZhY3RvcnkoT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24gY29uZmlnKSB7CiAgICAgICAgX2NvbmYgPSBjb25m\naWc7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbmZpZ3Vy\nYXRpb24gZm9yIHRoaXMgZmFjdG9yeS4KICAgICAqLwogICAgcHVibGljIE9w\nZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAg\nICAgcmV0dXJuIF9jb25mOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3\nQnJva2VyKCkgewogICAgICAgIHJldHVybiBuZXdCcm9rZXIoX2NvbmYuZ2V0\nQ29ubmVjdGlvblVzZXJOYW1lKCksCiAgICAgICAgICAgIF9jb25mLmdldENv\nbm5lY3Rpb25QYXNzd29yZCgpKTsKICAgIH0KCiAgICBwdWJsaWMgQnJva2Vy\nIG5ld0Jyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MpIHsKICAgICAg\nICByZXR1cm4gbmV3QnJva2VyKHVzZXIsIHBhc3MsIF9jb25mLmlzVHJhbnNh\nY3Rpb25Nb2RlTWFuYWdlZCgpLAogICAgICAgICAgICBfY29uZi5nZXRDb25u\nZWN0aW9uUmV0YWluTW9kZUNvbnN0YW50KCkpOwogICAgfQoKICAgIHB1Ymxp\nYyBCcm9rZXIgbmV3QnJva2VyKGJvb2xlYW4gbWFuYWdlZCwgaW50IGNvbm5S\nZXRhaW5Nb2RlKSB7CiAgICAgICAgcmV0dXJuIG5ld0Jyb2tlcihfY29uZi5n\nZXRDb25uZWN0aW9uVXNlck5hbWUoKSwKICAgICAgICAgICAgX2NvbmYuZ2V0\nQ29ubmVjdGlvblBhc3N3b3JkKCksIG1hbmFnZWQsIGNvbm5SZXRhaW5Nb2Rl\nKTsKICAgIH0KCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jyb2tlcihTdHJpbmcg\ndXNlciwgU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFuYWdlZCwKICAgICAgICBp\nbnQgY29ublJldGFpbk1vZGUpIHsKICAgICAgICByZXR1cm4gbmV3QnJva2Vy\nKHVzZXIsIHBhc3MsIG1hbmFnZWQsIGNvbm5SZXRhaW5Nb2RlLCB0cnVlKTsK\nICAgIH0KCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jyb2tlcihTdHJpbmcgdXNl\nciwgU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFuYWdlZCwKICAgICAgICBpbnQg\nY29ublJldGFpbk1vZGUsIGJvb2xlYW4gZmluZEV4aXN0aW5nKSB7CiAgICAg\nICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2VydE9w\nZW4oKTsKICAgICAgICAgICAgbWFrZVJlYWRPbmx5KCk7CgogICAgICAgICAg\nICBCcm9rZXJJbXBsIGJyb2tlciA9IG51bGw7CiAgICAgICAgICAgIGlmIChm\naW5kRXhpc3RpbmcpCiAgICAgICAgICAgICAgICBicm9rZXIgPSBmaW5kQnJv\na2VyKHVzZXIsIHBhc3MsIG1hbmFnZWQpOwogICAgICAgICAgICBpZiAoYnJv\na2VyID09IG51bGwpIHsKICAgICAgICAgICAgICAgIC8vIGRlY29yYXRlIHRo\nZSBzdG9yZSBtYW5hZ2VyIGZvciBkYXRhIGNhY2hpbmcgYW5kIGN1c3RvbQog\nICAgICAgICAgICAgICAgLy8gcmVzdWx0IG9iamVjdCBwcm92aWRlcnM7IGFs\nd2F5cyBtYWtlIHN1cmUgaXQncyBhIGRlbGVnYXRpbmcKICAgICAgICAgICAg\nICAgIC8vIHN0b3JlIG1hbmFnZXIsIGJlY2F1c2UgaXQncyBlYXNpZXIgZm9y\nIHVzZXJzIHRvIGRlYWwgd2l0aAogICAgICAgICAgICAgICAgLy8gdGhhdCB3\nYXkKICAgICAgICAgICAgICAgIFN0b3JlTWFuYWdlciBzbSA9IG5ld1N0b3Jl\nTWFuYWdlcigpOwogICAgICAgICAgICAgICAgRGVsZWdhdGluZ1N0b3JlTWFu\nYWdlciBkc20gPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKF9jb25mLmdl\ndERhdGFDYWNoZU1hbmFnZXJJbnN0YW5jZSgpLmdldFN5c3RlbURhdGFDYWNo\nZSgpCiAgICAgICAgICAgICAgICAgICAgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICBkc20gPSBuZXcgRGF0YUNhY2hlU3RvcmVNYW5hZ2VyKHNtKTsK\nICAgICAgICAgICAgICAgIGRzbSA9IG5ldyBST1BTdG9yZU1hbmFnZXIoKGRz\nbSA9PSBudWxsKSA/IHNtIDogZHNtKTsKCiAgICAgICAgICAgICAgICBicm9r\nZXIgPSBuZXdCcm9rZXJJbXBsKHVzZXIsIHBhc3MpOwogICAgICAgICAgICAg\nICAgYnJva2VyLmluaXRpYWxpemUodGhpcywgZHNtLCBtYW5hZ2VkLCBjb25u\nUmV0YWluTW9kZSk7CiAgICAgICAgICAgICAgICBhZGRMaWZlY3ljbGVMaXN0\nZW5lcnMoYnJva2VyKTsKCiAgICAgICAgICAgICAgICAvLyBpZiB3ZSdyZSB1\nc2luZyByZW1vdGUgZXZlbnRzLCByZWdpc3RlciB0aGUgZXZlbnQgbWFuYWdl\nciBzbwogICAgICAgICAgICAgICAgLy8gdGhhdCBpdCBjYW4gYnJvYWRjYXN0\nIGNvbW1pdCBub3RpZmljYXRpb25zIGZyb20gdGhlIGJyb2tlcgogICAgICAg\nICAgICAgICAgUmVtb3RlQ29tbWl0RXZlbnRNYW5hZ2VyIHJlbW90ZSA9IF9j\nb25mLgogICAgICAgICAgICAgICAgICAgIGdldFJlbW90ZUNvbW1pdEV2ZW50\nTWFuYWdlcigpOwogICAgICAgICAgICAgICAgaWYgKHJlbW90ZS5hcmVSZW1v\ndGVFdmVudHNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgYnJva2Vy\nLmFkZFRyYW5zYWN0aW9uTGlzdGVuZXIocmVtb3RlKTsKCiAgICAgICAgICAg\nICAgICBsb2FkUGVyc2lzdGVudFR5cGVzKGJyb2tlci5nZXRDbGFzc0xvYWRl\ncigpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfYnJva2Vycy5hZGQo\nYnJva2VyKTsKCiAgICAgICAgICAgIHJldHVybiBicm9rZXI7CiAgICAgICAg\nfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0\naHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKHJl\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgZmFjdG9yeS1y\nZWdpc3RlcmVkIGxpZmVjeWNsZSBsaXN0ZW5lcnMgdG8gdGhlIGJyb2tlci4K\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgYWRkTGlmZWN5Y2xlTGlzdGVu\nZXJzKEJyb2tlckltcGwgYnJva2VyKSB7CiAgICAgICAgaWYgKF9saWZlY3lj\nbGVMaXN0ZW5lcnMgPT0gbnVsbCB8fCBfbGlmZWN5Y2xlTGlzdGVuZXJzLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBNYXAuRW50\ncnkgZW50cnk7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfbGlmZWN5\nY2xlTGlzdGVuZXJzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICAg\nICAgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFw\nLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBicm9rZXIuYWRkTGlm\nZWN5Y2xlTGlzdGVuZXIoZW50cnkuZ2V0S2V5KCksIChDbGFzc1tdKQogICAg\nICAgICAgICAgICAgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogTG9hZCB0aGUgY29uZmlndXJlZCBwZXJzaXN0\nZW50IGNsYXNzZXMgbGlzdC4gUGVyZm9ybWVkIGF1dG9tYXRpY2FsbHkKICAg\nICAqIHdoZW5ldmVyIGEgYnJva2VyIGlzIGNyZWF0ZWQuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBsb2FkUGVyc2lzdGVudFR5cGVzKENsYXNzTG9hZGVy\nIGVudkxvYWRlcikgewogICAgICAgIC8vIG5vIGxpc3RlZCBwZXJzaXN0ZW50\nIHR5cGVzPwogICAgICAgIGlmIChfcGNDbGFzc05hbWVzICE9IG51bGwgJiYg\nX3BjQ2xhc3NOYW1lcy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgLy8gY2FjaGUgcGVyc2lzdGVudCB0eXBlIG5hbWVzIGlmIG5v\ndCBhbHJlYWR5CiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyID0gX2NvbmYu\nZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAgICAgIGdldENs\nYXNzTG9hZGVyKGdldENsYXNzKCksIGVudkxvYWRlcik7CiAgICAgICAgaWYg\nKF9wY0NsYXNzTmFtZXMgPT0gbnVsbCkgewogICAgICAgICAgICBDb2xsZWN0\naW9uIGNsc3MgPSBfY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5j\nZSgpLgogICAgICAgICAgICAgICAgbG9hZFBlcnNpc3RlbnRUeXBlcyhmYWxz\nZSwgbG9hZGVyKTsKICAgICAgICAgICAgaWYgKGNsc3MuaXNFbXB0eSgpKQog\nICAgICAgICAgICAgICAgX3BjQ2xhc3NOYW1lcyA9IENvbGxlY3Rpb25zLkVN\nUFRZX1NFVDsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBf\ncGNDbGFzc05hbWVzID0gbmV3IEFycmF5TGlzdChjbHNzLnNpemUoKSk7CiAg\nICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNsc3MuaXRlcmF0\nb3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgICAgICAgICAgX3Bj\nQ2xhc3NOYW1lcy5hZGQoKChDbGFzcykgaXRyLm5leHQoKSkuZ2V0TmFtZSgp\nKTsKICAgICAgICAgICAgICAgIF9wY0NsYXNzTG9hZGVycyA9IG5ldyBSZWZl\ncmVuY2VIYXNoU2V0KFJlZmVyZW5jZUhhc2hTZXQuV0VBSyk7CiAgICAgICAg\nICAgICAgICBfcGNDbGFzc0xvYWRlcnMuYWRkKGxvYWRlcik7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAg\nLy8gcmVsb2FkIHdpdGggdGhpcyBsb2FkZXIKICAgICAgICBpZiAoX3BjQ2xh\nc3NMb2FkZXJzLmFkZChsb2FkZXIpKSB7CiAgICAgICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRyID0gX3BjQ2xhc3NOYW1lcy5pdGVyYXRvcigpOyBpdHIuaGFz\nTmV4dCgpOykgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICBDbGFzcy5mb3JOYW1lKChTdHJpbmcpIGl0ci5uZXh0KCksIHRy\ndWUsIGxvYWRlcik7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChUaHJvd2Fi\nbGUgdCkgewogICAgICAgICAgICAgICAgICAgIF9jb25mLmdldExvZyhPcGVu\nSlBBQ29uZmlndXJhdGlvbi5MT0dfUlVOVElNRSkKICAgICAgICAgICAgICAg\nICAgICAgICAgLndhcm4obnVsbCwgdCk7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\nYWRkTGlmZWN5Y2xlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyLCBDbGFzc1td\nIGNsYXNzZXMpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBpZiAoX2xpZmVj\neWNsZUxpc3RlbmVycyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2xpZmVj\neWNsZUxpc3RlbmVycyA9IG5ldyBIYXNoTWFwKDcpOwogICAgICAgICAgICBf\nbGlmZWN5Y2xlTGlzdGVuZXJzLnB1dChsaXN0ZW5lciwgY2xhc3Nlcyk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbW92ZUxpZmVjeWNsZUxp\nc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGxvY2soKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAg\nICAgIGlmIChfbGlmZWN5Y2xlTGlzdGVuZXJzICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBfbGlmZWN5Y2xlTGlzdGVuZXJzLnJlbW92ZShsaXN0ZW5lcik7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlm\nIHRoaXMgYnJva2VyIGZhY3RvcnkgaXMgY2xvc2VkLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc0Nsb3NlZCgpIHsKICAgICAgICByZXR1cm4gX2Ns\nb3NlZCAhPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkg\newogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBh\nc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIGFzc2VydE5vQWN0aXZlVHJhbnNh\nY3Rpb24oKTsKCiAgICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIGZhY3Rvcnkg\ncG9vbAogICAgICAgICAgICBNYXAgbWFwID0gdG9Qb29sS2V5KF9jb25mKTsK\nICAgICAgICAgICAgc3luY2hyb25pemVkIChfcG9vbCkgewogICAgICAgICAg\nICAgICAgaWYgKF9wb29sLmdldChtYXApID09IHRoaXMpCiAgICAgICAgICAg\nICAgICAgICAgX3Bvb2wucmVtb3ZlKG1hcCk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIC8vIGNsb3NlIGFsbCBicm9rZXJzCiAgICAgICAgICAgIEJy\nb2tlciBicm9rZXI7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0g\nX2Jyb2tlcnMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgICAgIGJyb2tlciA9IChCcm9rZXIpIGl0ci5uZXh0KCk7CiAgICAg\nICAgICAgICAgICBpZiAoIWJyb2tlci5pc0Nsb3NlZCgpKQogICAgICAgICAg\nICAgICAgICAgIGJyb2tlci5jbG9zZSgpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICAvLyByZW1vdmUgbWV0YWRhdGEgcmVwb3NpdG9yeSBmcm9tIGxp\nc3RlbmVyIGxpc3QKICAgICAgICAgICAgUENSZWdpc3RyeS5yZW1vdmVSZWdp\nc3RlckNsYXNzTGlzdGVuZXIKICAgICAgICAgICAgICAgIChfY29uZi5nZXRN\nZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpKTsKCiAgICAgICAgICAgIF9j\nb25mLmNsb3NlKCk7CiAgICAgICAgICAgIF9jbG9zZWQgPSBuZXcgSWxsZWdh\nbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogU3ViY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8g\nYWRkIGEgPGNvZGU+UGxhdGZvcm08L2NvZGU+CiAgICAgKiBwcm9wZXJ0eSBs\naXN0aW5nIHRoZSBydW50aW1lIHBsYXRmb3JtLCBzdWNoIGFzOgogICAgICog\nPGNvZGU+T3BlbkpQQSBKREJDIEVkaXRpb246IE9yYWNsZSBEYXRhYmFzZTwv\nY29kZT4KICAgICAqLwogICAgcHVibGljIFByb3BlcnRpZXMgZ2V0UHJvcGVy\ndGllcygpIHsKICAgICAgICAvLyByZXF1aXJlZCBwcm9wcyBhcmUgVmVuZG9y\nTmFtZSBhbmQgVmVyc2lvbk51bWJlcgogICAgICAgIFByb3BlcnRpZXMgcHJv\ncHMgPSBuZXcgUHJvcGVydGllcygpOwogICAgICAgIHByb3BzLnNldFByb3Bl\ncnR5KCJWZW5kb3JOYW1lIiwgT3BlbkpQQVZlcnNpb24uVkVORE9SX05BTUUp\nOwogICAgICAgIHByb3BzLnNldFByb3BlcnR5KCJWZXJzaW9uTnVtYmVyIiwg\nT3BlbkpQQVZlcnNpb24uVkVSU0lPTl9OVU1CRVIpOwogICAgICAgIHByb3Bz\nLnNldFByb3BlcnR5KCJWZXJzaW9uSWQiLCBPcGVuSlBBVmVyc2lvbi5WRVJT\nSU9OX0lEKTsKICAgICAgICByZXR1cm4gcHJvcHM7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBnZXRVc2VyT2JqZWN0KE9iamVjdCBrZXkpIHsKICAgICAg\nICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Bl\nbigpOwogICAgICAgICAgICByZXR1cm4gKF91c2VyT2JqZWN0cyA9PSBudWxs\nKSA/IG51bGwgOiBfdXNlck9iamVjdHMuZ2V0KGtleSk7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBPYmplY3QgcHV0VXNlck9iamVjdChPYmplY3Qga2V5\nLCBPYmplY3QgdmFsKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKHZh\nbCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIChfdXNlck9iamVj\ndHMgPT0gbnVsbCkgPyBudWxsIDogX3VzZXJPYmplY3RzLnJlbW92ZShrZXkp\nOwoKICAgICAgICAgICAgaWYgKF91c2VyT2JqZWN0cyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgX3VzZXJPYmplY3RzID0gbmV3IEhhc2hNYXAoKTsKICAg\nICAgICAgICAgcmV0dXJuIF91c2VyT2JqZWN0cy5wdXQoa2V5LCB2YWwpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrKCkgewogICAgICAg\nIF9sb2NrLmxvY2soKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1bmxvY2so\nKSB7CiAgICAgICAgX2xvY2sudW5sb2NrKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXBsYWNlcyB0aGUgZmFjdG9yeSB3aXRoIHRoaXMgSlZNcyBwb29s\nZWQgdmVyc2lvbiBpZiBpdCBleGlzdHMuIEFsc28KICAgICAqIGZyZWV6ZXMg\ndGhlIGZhY3RvcnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgcmVh\nZFJlc29sdmUoKQogICAgICAgIHRocm93cyBPYmplY3RTdHJlYW1FeGNlcHRp\nb24gewogICAgICAgIEFic3RyYWN0QnJva2VyRmFjdG9yeSBmYWN0b3J5ID0g\nZ2V0UG9vbGVkRmFjdG9yeShfY29uZik7CiAgICAgICAgaWYgKGZhY3Rvcnkg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7CgogICAgICAg\nIC8vIHJlc2V0IHRoZXNlIHRyYW5zaWVudCBmaWVsZHMgdG8gZW1wdHkgdmFs\ndWVzCiAgICAgICAgX3RyYW5zYWN0aW9uYWwgPSBuZXcgSGFzaE1hcCgpOwog\nICAgICAgIF9icm9rZXJzID0gbmV3IFJlZmVyZW5jZUhhc2hTZXQoUmVmZXJl\nbmNlSGFzaFNldC5XRUFLKTsKCiAgICAgICAgbWFrZVJlYWRPbmx5KCk7CiAg\nICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vCiAgICAvLyBNZXRob2RzIGZvciBPdmVycmlkZQogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBSZXR1cm4g\nYSBuZXcgU3RvcmVNYW5hZ2VyIGZvciB0aGlzIHJ1bnRpbWUuIE5vdGUgdGhh\ndCB0aGUgaW5zdGFuY2UKICAgICAqIHJldHVybmVkIGhlcmUgbWF5IGJlIHdy\nYXBwZWQgYmVmb3JlIGJlaW5nIHBhc3NlZCB0byB0aGUKICAgICAqIHtAbGlu\nayAjbmV3QnJva2VyfSBtZXRob2QuCiAgICAgKi8KICAgIHByb3RlY3RlZCBh\nYnN0cmFjdCBTdG9yZU1hbmFnZXIgbmV3U3RvcmVNYW5hZ2VyKCk7CgogICAg\nLyoqCiAgICAgKiBGaW5kIGEgcG9vbGVkIGJyb2tlciwgb3IgcmV0dXJuIG51\nbGwgaWYgbm9uZS4gSWYgdXNpbmcKICAgICAqIG1hbmFnZWQgdHJhbnNhY3Rp\nb25zLCBsb29rcyBmb3IgYSB0cmFuc2FjdGlvbmFsIGJyb2tlcjsKICAgICAq\nIG90aGVyd2lzZSByZXR1cm5zIG51bGwgYnkgZGVmYXVsdC4gVGhpcyBtZXRo\nb2Qgd2lsbCBiZSBjYWxsZWQgYmVmb3JlCiAgICAgKiB7QGxpbmsgI25ld1N0\nb3JlTWFuYWdlcn0gc28gdGhhdCBmYWN0b3J5IHN1YmNsYXNzZXMgaW1wbGVt\nZW50aW5nCiAgICAgKiBwb29saW5nIGNhbiByZXR1cm4gYSBtYXRjaGluZyBt\nYW5hZ2VyIGJlZm9yZSBhIG5ldyB7QGxpbmsgU3RvcmVNYW5hZ2VyfQogICAg\nICogaXMgY3JlYXRlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIEJyb2tlcklt\ncGwgZmluZEJyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MsIGJvb2xl\nYW4gbWFuYWdlZCkgewogICAgICAgIGlmIChtYW5hZ2VkKQogICAgICAgICAg\nICByZXR1cm4gZmluZFRyYW5zYWN0aW9uYWxCcm9rZXIodXNlciwgcGFzcyk7\nCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSBicm9rZXIgY29uZmlndXJlZCB3aXRoIHRoZSBwcm9wZXIgc2V0\ndGluZ3MuCiAgICAgKiBCeSBkZWZhdWx0LCB0aGlzIG1ldGhvZCBjb25zdHJ1\nY3RzIGEgbmV3CiAgICAgKiBCcm9rZXJJbXBsIG9mIHRoZSBjbGFzcyBzZXQg\nZm9yIHRoaXMgZmFjdG9yeS4KICAgICAqLwogICAgcHJvdGVjdGVkIEJyb2tl\nckltcGwgbmV3QnJva2VySW1wbChTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3Mp\nIHsKICAgICAgICBCcm9rZXJJbXBsIGJyb2tlciA9IF9jb25mLm5ld0Jyb2tl\nckluc3RhbmNlKHVzZXIsIHBhc3MpOwogICAgICAgIGlmIChicm9rZXIgPT0g\nbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xv\nYy5nZXQoIm5vLWJyb2tlci1jbGFzcyIsCiAgICAgICAgICAgICAgICBfY29u\nZi5nZXRCcm9rZXJJbXBsKCkpKTsKCiAgICAgICAgcmV0dXJuIGJyb2tlcjsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRyYW5zaWVudCBzdGF0ZSB1\nc2VkIGJ5IHRoaXMgZmFjdG9yeSBiYXNlZCBvbiB0aGUKICAgICAqIGN1cnJl\nbnQgY29uZmlndXJhdGlvbiwgd2hpY2ggd2lsbCBzdWJzZXF1ZW50bHkgYmUg\nbG9ja2VkIGRvd24uIFRoaXMKICAgICAqIG1ldGhvZCB3aWxsIGJlIGNhbGxl\nZCBiZWZvcmUgdGhlIGZpcnN0IGJyb2tlciBpcyByZXF1ZXN0ZWQsCiAgICAg\nKiBhbmQgd2lsbCBiZSByZS1jYWxsZWQgZWFjaCB0aW1lIHRoZSBmYWN0b3J5\nIGlzIGRlc2VyaWFsaXplZCBpbnRvIGEgSlZNCiAgICAgKiB0aGF0IGhhcyBu\nbyBjb25maWd1cmF0aW9uIGZvciB0aGlzIGRhdGEgc3RvcmUuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIHNldHVwKCkgewogICAgfQoKICAgIC8vLy8v\nLy8vLy8vLy8KICAgIC8vIFV0aWxpdGllcwogICAgLy8vLy8vLy8vLy8vLwoK\nICAgIC8qKgogICAgICogRmluZCBhIG1hbmFnZWQgcnVudGltZSBicm9rZXIg\nYXNzb2NpYXRlZCB3aXRoIHRoZQogICAgICogY3VycmVudCB0cmFuc2FjdGlv\nbiwgb3IgcmV0dXJucyBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBCcm9rZXJJbXBsIGZpbmRUcmFuc2FjdGlvbmFsQnJva2VyKFN0cmlu\nZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIFRyYW5zYWN0aW9uIHRy\nYW5zID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICB0cmFucyA9\nIF9jb25mLmdldE1hbmFnZWRSdW50aW1lSW5zdGFuY2UoKS5nZXRUcmFuc2Fj\ndGlvbk1hbmFnZXIoKS4KICAgICAgICAgICAgICAgIGdldFRyYW5zYWN0aW9u\nKCk7CgogICAgICAgICAgICBpZiAodHJhbnMgPT0gbnVsbAogICAgICAgICAg\nICAgICAgfHwgdHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRVU19O\nT19UUkFOU0FDVElPTgogICAgICAgICAgICAgICAgfHwgdHJhbnMuZ2V0U3Rh\ndHVzKCkgPT0gU3RhdHVzLlNUQVRVU19VTktOT1dOKQogICAgICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2Vw\ndGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2Vu\nZXJhbEV4Y2VwdGlvbihlKTsKICAgICAgICB9CgogICAgICAgIHN5bmNocm9u\naXplZCAoX3RyYW5zYWN0aW9uYWwpIHsKICAgICAgICAgICAgQ29sbGVjdGlv\nbiBicm9rZXJzID0gKENvbGxlY3Rpb24pIF90cmFuc2FjdGlvbmFsLmdldCh0\ncmFucyk7CiAgICAgICAgICAgIGlmIChicm9rZXJzICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIEJyb2tlckltcGwgYnJva2VyOwogICAgICAgICAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBicm9rZXJzLml0ZXJhdG9yKCk7IGl0\nci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAgYnJva2VyID0g\nKEJyb2tlckltcGwpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICAgICAg\naWYgKFN0cmluZ1V0aWxzLmVxdWFscyhicm9rZXIuZ2V0Q29ubmVjdGlvblVz\nZXJOYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIpICYmIFN0\ncmluZ1V0aWxzLmVxdWFscwogICAgICAgICAgICAgICAgICAgICAgICAoYnJv\na2VyLmdldENvbm5lY3Rpb25QYXNzd29yZCgpLCBwYXNzKSkKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIGJyb2tlcjsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25maWd1cmVzIHRoZSBn\naXZlbiBicm9rZXIgd2l0aCB0aGUgY3VycmVudCBmYWN0b3J5IG9wdGlvbiBz\nZXR0aW5ncy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgY29uZmlndXJl\nQnJva2VyKEJyb2tlckltcGwgYnJva2VyKSB7CiAgICAgICAgYnJva2VyLnNl\ndE9wdGltaXN0aWMoX2NvbmYuZ2V0T3B0aW1pc3RpYygpKTsKICAgICAgICBi\ncm9rZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoX2NvbmYuZ2V0Tm9udHJh\nbnNhY3Rpb25hbFJlYWQoKSk7CiAgICAgICAgYnJva2VyLnNldE5vbnRyYW5z\nYWN0aW9uYWxXcml0ZShfY29uZi5nZXROb250cmFuc2FjdGlvbmFsV3JpdGUo\nKSk7CiAgICAgICAgYnJva2VyLnNldFJldGFpblN0YXRlKF9jb25mLmdldFJl\ndGFpblN0YXRlKCkpOwogICAgICAgIGJyb2tlci5zZXRSZXN0b3JlU3RhdGUo\nX2NvbmYuZ2V0UmVzdG9yZVN0YXRlQ29uc3RhbnQoKSk7CiAgICAgICAgYnJv\na2VyLnNldEF1dG9DbGVhcihfY29uZi5nZXRBdXRvQ2xlYXJDb25zdGFudCgp\nKTsKICAgICAgICBicm9rZXIuc2V0SWdub3JlQ2hhbmdlcyhfY29uZi5nZXRJ\nZ25vcmVDaGFuZ2VzKCkpOwogICAgICAgIGJyb2tlci5zZXRNdWx0aXRocmVh\nZGVkKF9jb25mLmdldE11bHRpdGhyZWFkZWQoKSk7CiAgICAgICAgYnJva2Vy\nLnNldEF1dG9EZXRhY2goX2NvbmYuZ2V0QXV0b0RldGFjaENvbnN0YW50KCkp\nOwogICAgICAgIGJyb2tlci5zZXREZXRhY2hTdGF0ZShfY29uZi5nZXREZXRh\nY2hTdGF0ZUluc3RhbmNlKCkuCiAgICAgICAgICAgIGdldERldGFjaFN0YXRl\nKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBmYWN0b3J5IHRv\nIHRoZSBwb29sLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwb29sKCkg\newogICAgICAgIHN5bmNocm9uaXplZCAoX3Bvb2wpIHsKICAgICAgICAgICAg\nX3Bvb2wucHV0KHRvUG9vbEtleShfY29uZiksIHRoaXMpOwogICAgICAgICAg\nICBtYWtlUmVhZE9ubHkoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBGcmVlemVzIHRoZSBjb25maWd1cmF0aW9uIG9mIHRoaXMgZmFjdG9y\neS4KICAgICAqLwogICAgcHVibGljIHZvaWQgbWFrZVJlYWRPbmx5KCkgewog\nICAgICAgIGlmIChfcmVhZE9ubHkpCiAgICAgICAgICAgIHJldHVybjsKCiAg\nICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGNo\nZWNrIGFnYWluCiAgICAgICAgICAgIGlmIChfcmVhZE9ubHkpCiAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgIF9yZWFkT25seSA9IHRydWU7\nCgogICAgICAgICAgICBMb2cgbG9nID0gX2NvbmYuZ2V0TG9nKE9wZW5KUEFD\nb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAgICAgICAgaWYgKGxv\nZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgICAgICBsb2cuaW5mbyhn\nZXRGYWN0b3J5SW5pdGlhbGl6YXRpb25CYW5uZXIoKSk7CiAgICAgICAgICAg\nIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAg\nTWFwIHByb3BzID0gX2NvbmYudG9Qcm9wZXJ0aWVzKHRydWUpOwogICAgICAg\nICAgICAgICAgU3RyaW5nIGxpbmVTZXAgPSBTeXN0ZW0uZ2V0UHJvcGVydHko\nImxpbmUuc2VwYXJhdG9yIik7CiAgICAgICAgICAgICAgICBTdHJpbmdCdWZm\nZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAgICAgICAg\nTWFwLkVudHJ5IGVudHJ5OwogICAgICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSBwcm9wcy5lbnRyeVNldCgpLml0ZXJhdG9yKCk7CiAgICAgICAg\nICAgICAgICAgICAgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAg\nICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7CiAgICAgICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZChlbnRyeS5nZXRLZXkoKSkuYXBwZW5k\nKCI6ICIpLgogICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQoZW50cnku\nZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ci5oYXNO\nZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQobGlu\nZVNlcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsb2cu\ndHJhY2UoX2xvYy5nZXQoImZhY3RvcnktcHJvcGVydGllcyIsIGJ1Zi50b1N0\ncmluZygpKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHNldHVw\nIHRyYW5zaWVudCBzdGF0ZQogICAgICAgICAgICBzZXR1cCgpOwoKICAgICAg\nICAgICAgLy8gcmVnaXN0ZXIgdGhlIG1ldGRhdGEgcmVwb3NpdG9yeSB0byBh\ndXRvLWxvYWQgcGVyc2lzdGVudCB0eXBlcwogICAgICAgICAgICAvLyBhbmQg\nbWFrZSBzdXJlIHR5cGVzIGFyZSBlbmhhbmNlZAogICAgICAgICAgICBNZXRh\nRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBfY29uZi5nZXRNZXRhRGF0YVJlcG9z\naXRvcnlJbnN0YW5jZSgpOwogICAgICAgICAgICByZXBvcy5zZXRWYWxpZGF0\nZShyZXBvcy5WQUxJREFURV9SVU5USU1FLCB0cnVlKTsKICAgICAgICAgICAg\ncmVwb3Muc2V0UmVzb2x2ZShyZXBvcy5NT0RFX01BUFBJTkdfSU5JVCwgdHJ1\nZSk7CiAgICAgICAgICAgIFBDUmVnaXN0cnkuYWRkUmVnaXN0ZXJDbGFzc0xp\nc3RlbmVyKHJlcG9zKTsKCiAgICAgICAgICAgIC8vIGZyZWV6ZSB1bmRlcmx5\naW5nIGNvbmZpZ3VyYXRpb24gYW5kIGVhZ2VybHkgaW5pdGlhbGl6ZSB0bwog\nICAgICAgICAgICAvLyBhdm9pZCBzeW5jaHJvbml6YXRpb24KICAgICAgICAg\nICAgX2NvbmYuc2V0UmVhZE9ubHkodHJ1ZSk7CiAgICAgICAgICAgIF9jb25m\nLmluc3RhbnRpYXRlQWxsKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIGFuIG9iamVjdCB0byBiZSB3cml0dGVuIHRvIHRoZSBsb2cg\nd2hlbiB0aGlzIGJyb2tlciBmYWN0b3J5CiAgICAgKiBpbml0aWFsaXplcy4g\nVGhpcyBoYXBwZW5zIGFmdGVyIHRoZSBjb25maWd1cmF0aW9uIGlzIGZ1bGx5\nIGxvYWRlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRGYWN0\nb3J5SW5pdGlhbGl6YXRpb25CYW5uZXIoKSB7CiAgICAgICAgcmV0dXJuIF9s\nb2MuZ2V0KCJmYWN0b3J5LWluaXQiLCBPcGVuSlBBVmVyc2lvbi5WRVJTSU9O\nX05VTUJFUik7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBhbiBleGNl\ncHRpb24gaWYgdGhlIGZhY3RvcnkgaXMgY2xvc2VkLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgYXNzZXJ0T3BlbigpIHsKICAgICAgICBpZiAoX2Nsb3Nl\nZCAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRl\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJjbG9zZWQtZmFjdG9yeSIpKS4KICAgICAg\nICAgICAgICAgIHNldENhdXNlKF9jbG9zZWQpOwogICAgfQoKICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBCcm9rZXIgdXRpbGl0aWVzCiAgICAv\nLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogVGhyb3dzIGEg\ne0BsaW5rIFVzZXJFeGNlcHRpb259IGlmIGEgdHJhbnNhY3Rpb24gaXMgYWN0\naXZlLiBUaGUgdGhyb3duCiAgICAgKiBleGNlcHRpb24gd2lsbCBjb250YWlu\nIGFsbCB0aGUgQnJva2VycyB3aXRoIGFjdGl2ZSB0cmFuc2FjdGlvbnMgYXMK\nICAgICAqIGZhaWxlZCBvYmplY3RzIGluIHRoZSBuZXN0ZWQgZXhjZXB0aW9u\ncy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydE5vQWN0aXZlVHJh\nbnNhY3Rpb24oKSB7CiAgICAgICAgQ29sbGVjdGlvbiBleGNzID0gbnVsbDsK\nICAgICAgICBzeW5jaHJvbml6ZWQgKF90cmFuc2FjdGlvbmFsKSB7CiAgICAg\nICAgICAgIGlmIChfdHJhbnNhY3Rpb25hbC5pc0VtcHR5KCkpCiAgICAgICAg\nICAgICAgICByZXR1cm47CgogICAgICAgICAgICBleGNzID0gbmV3IEFycmF5\nTGlzdChfdHJhbnNhY3Rpb25hbC5zaXplKCkpOwogICAgICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIHRyYW5zID0gX3RyYW5zYWN0aW9uYWwudmFsdWVzKCkuaXRl\ncmF0b3IoKTsKICAgICAgICAgICAgICAgIHRyYW5zLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgICAgIENvbGxlY3Rpb24gYnJva2VycyA9IChDb2xsZWN0\naW9uKSB0cmFucy5uZXh0KCk7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ciA9IGJyb2tlcnMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgICAgICAgICBleGNzLmFkZChuZXcgSW52YWxpZFN0\nYXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJhY3RpdmUiKSkuCiAgICAgICAgICAg\nICAgICAgICAgICAgIHNldEZhaWxlZE9iamVjdChpdHIubmV4dCgpKSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIGlmICghZXhjcy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHRocm93IG5l\ndyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoIm5lc3RlZC1leGNl\ncHMiKSkuCiAgICAgICAgICAgICAgICBzZXROZXN0ZWRUaHJvd2FibGVzKChU\naHJvd2FibGVbXSkgZXhjcy50b0FycmF5CiAgICAgICAgICAgICAgICAgICAg\nKG5ldyBUaHJvd2FibGVbZXhjcy5zaXplKCldKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTeW5jaHJvbml6ZSB0aGUgZ2l2ZW4gYnJva2VyIHdpdGggYSBt\nYW5hZ2VkIHRyYW5zYWN0aW9uLAogICAgICogb3B0aW9uYWxseSBzdGFydGlu\nZyBvbmUgaWYgbm9uZSBpcyBpbiBwcm9ncmVzcy4KICAgICAqCiAgICAgKiBA\ncmV0dXJuIHRydWUgaWYgc3luY2hlZCB3aXRoIHRyYW5zYWN0aW9uLCBmYWxz\nZSBvdGhlcndpc2UKICAgICAqLwogICAgYm9vbGVhbiBzeW5jV2l0aE1hbmFn\nZWRUcmFuc2FjdGlvbihCcm9rZXJJbXBsIGJyb2tlciwgYm9vbGVhbiBiZWdp\nbikgewogICAgICAgIFRyYW5zYWN0aW9uIHRyYW5zID0gbnVsbDsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBUcmFuc2FjdGlvbk1hbmFnZXIgdG0gPSBi\ncm9rZXIuZ2V0TWFuYWdlZFJ1bnRpbWUoKS4KICAgICAgICAgICAgICAgIGdl\ndFRyYW5zYWN0aW9uTWFuYWdlcigpOwogICAgICAgICAgICB0cmFucyA9IHRt\nLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAgIGlmICh0cmFucyAhPSBu\ndWxsCiAgICAgICAgICAgICAgICAmJiAodHJhbnMuZ2V0U3RhdHVzKCkgPT0g\nU3RhdHVzLlNUQVRVU19OT19UUkFOU0FDVElPTgogICAgICAgICAgICAgICAg\nfHwgdHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRVU19VTktOT1dO\nKSkKICAgICAgICAgICAgICAgIHRyYW5zID0gbnVsbDsKCiAgICAgICAgICAg\nIGlmICh0cmFucyA9PSBudWxsICYmIGJlZ2luKSB7CiAgICAgICAgICAgICAg\nICB0bS5iZWdpbigpOwogICAgICAgICAgICAgICAgdHJhbnMgPSB0bS5nZXRU\ncmFuc2FjdGlvbigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zID09\nIG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAg\nICAgICAvLyBzeW5jaCBicm9rZXIgYW5kIHRyYW5zCiAgICAgICAgICAgIHRy\nYW5zLnJlZ2lzdGVyU3luY2hyb25pemF0aW9uKGJyb2tlcik7CgogICAgICAg\nICAgICBzeW5jaHJvbml6ZWQgKF90cmFuc2FjdGlvbmFsKSB7CiAgICAgICAg\nICAgICAgICBDb2xsZWN0aW9uIGJyb2tlcnMgPSAoQ29sbGVjdGlvbikgX3Ry\nYW5zYWN0aW9uYWwuZ2V0KHRyYW5zKTsKICAgICAgICAgICAgICAgIGlmIChi\ncm9rZXJzID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBicm9rZXJz\nID0gbmV3IEFycmF5TGlzdCgyKTsKICAgICAgICAgICAgICAgICAgICBfdHJh\nbnNhY3Rpb25hbC5wdXQodHJhbnMsIGJyb2tlcnMpOwoKICAgICAgICAgICAg\nICAgICAgICAvLyByZWdpc3RlciBhIGNhbGxiYWNrIHRvIHJlbW92ZSB0aGUg\ndHJhbnMgZnJvbSB0aGUKICAgICAgICAgICAgICAgICAgICAvLyBjYWNoZSB3\naGVuIGl0IGVuZHMKICAgICAgICAgICAgICAgICAgICB0cmFucy5yZWdpc3Rl\nclN5bmNocm9uaXphdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAobmV3\nIFJlbW92ZVRyYW5zYWN0aW9uU3luYyh0cmFucykpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgYnJva2Vycy5hZGQoYnJva2VyKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0\naHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihlKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTaW1wbGUgc3luY2hyb25pemF0\naW9uIGxpc3RlbmVyIHRvIHJlbW92ZSBjb21wbGV0ZWQgdHJhbnNhY3Rpb25z\nCiAgICAgKiBmcm9tIG91ciBjYWNoZS4KICAgICAqLwogICAgcHJpdmF0ZSBj\nbGFzcyBSZW1vdmVUcmFuc2FjdGlvblN5bmMKICAgICAgICBpbXBsZW1lbnRz\nIFN5bmNocm9uaXphdGlvbiB7CgogICAgICAgIHByaXZhdGUgZmluYWwgVHJh\nbnNhY3Rpb24gX3RyYW5zOwoKICAgICAgICBwdWJsaWMgUmVtb3ZlVHJhbnNh\nY3Rpb25TeW5jKFRyYW5zYWN0aW9uIHRyYW5zKSB7CiAgICAgICAgICAgIF90\ncmFucyA9IHRyYW5zOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nYmVmb3JlQ29tcGxldGlvbigpIHsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyB2b2lkIGFmdGVyQ29tcGxldGlvbihpbnQgc3RhdHVzKSB7CiAgICAgICAg\nICAgIHN5bmNocm9uaXplZCAoX3RyYW5zYWN0aW9uYWwpCgkJCXsKCQkJCV90\ncmFuc2FjdGlvbmFsLnJlbW92ZSAoX3RyYW5zKTsKCQkJfQoJCX0KCX0KfQo=\n","encoding":"base64"}

