{"sha":"bec62db1802c252cfe3a2c61d2a34b661e3fbda7","node_id":"MDQ6QmxvYjIwNjM2NDpiZWM2MmRiMTgwMmMyNTJjZmUzYTJjNjFkMmEzNGI2NjFlM2ZiZGE3","size":11139,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bec62db1802c252cfe3a2c61d2a34b661e3fbda7","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWw7CgppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQXJy\nYXk7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51\ndGlsLkJpdFNldDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkRh\ndGU7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2\nYS51dGlsLkxvY2FsZTsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50Lk9ycGhhbmVkS2V5QWN0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5DaGFuZ2VUcmFja2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuUHJveHk7CgovKioKICog\nQWJzdHJhY3QgYmFzZSBjbGFzcyB3aGljaCBpbXBsZW1lbnRzIGNvcmUgUENE\nYXRhIGJlaGF2aW9yLgogKgogKiBAYXV0aG9yIFBhdHJpY2sgTGluc2tleQog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMg\nYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RQQ0RhdGEKICAgIGltcGxlbWVudHMg\nUENEYXRhIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIE9iamVjdCBOVUxM\nID0gbmV3IE9iamVjdCgpOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBs\nb2FkZWQgZmllbGQgbWFzay4KICAgICAqLwogICAgcHVibGljIGFic3RyYWN0\nIEJpdFNldCBnZXRMb2FkZWQoKTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nIG5ldyBwY2RhdGEgZm9yIGhvbGRpbmcgdGhlIHN0YXRlIG9mIGFuIGVtYmVk\nZGVkIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgYWJzdHJhY3QgQWJz\ndHJhY3RQQ0RhdGEgbmV3RW1iZWRkZWRQQ0RhdGEoT3BlbkpQQVN0YXRlTWFu\nYWdlciBzbSk7CgogICAgcHVibGljIGJvb2xlYW4gaXNMb2FkZWQoaW50IGZp\nZWxkKSB7CiAgICAgICAgcmV0dXJuIGdldExvYWRlZCgpLmdldChmaWVsZCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2Zvcm0gdGhlIGdpdmVuIGRh\ndGEgdmFsdWUgaW50byBpdHMgZmllbGQgdmFsdWUuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBPYmplY3QgdG9GaWVsZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBGaWVsZE1ldGFEYXRhIGZtZCwKICAgICAgICBPYmplY3QgZGF0YSwgRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoLCBPYmplY3QgY29udGV4dCkgewogICAg\nICAgIGlmIChkYXRhID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICBzd2l0Y2ggKGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkp\nIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAg\nICAgICAgICAgICAgIFByb3h5RGF0YUxpc3QgYyA9IChQcm94eURhdGFMaXN0\nKSBkYXRhOwogICAgICAgICAgICAgICAgQ29sbGVjdGlvbiBjMiA9IChDb2xs\nZWN0aW9uKSBzbS5uZXdGaWVsZFByb3h5KGZtZC5nZXRJbmRleCgpKTsKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYy5zaXplKCk7IGkr\nKykKICAgICAgICAgICAgICAgICAgICBjMi5hZGQodG9OZXN0ZWRGaWVsZChz\nbSwgZm1kLmdldEVsZW1lbnQoKSwgYy5nZXQoaSksCiAgICAgICAgICAgICAg\nICAgICAgICAgIGZldGNoLCBjb250ZXh0KSk7CiAgICAgICAgICAgICAgICBp\nZiAoYzIgaW5zdGFuY2VvZiBQcm94eSkgewogICAgICAgICAgICAgICAgICAg\nIENoYW5nZVRyYWNrZXIgY3QgPSAoKFByb3h5KSBjMikuZ2V0Q2hhbmdlVHJh\nY2tlcigpOwogICAgICAgICAgICAgICAgICAgIGlmIChjdCAhPSBudWxsKQog\nICAgICAgICAgICAgICAgICAgICAgICBjdC5zZXROZXh0U2VxdWVuY2UoYy5u\nZXh0U2VxdWVuY2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgcmV0dXJuIGMyOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6\nCiAgICAgICAgICAgICAgICBNYXAgbSA9IChNYXApIGRhdGE7CiAgICAgICAg\nICAgICAgICBNYXAgbTIgPSAoTWFwKSBzbS5uZXdGaWVsZFByb3h5KGZtZC5n\nZXRJbmRleCgpKTsKICAgICAgICAgICAgICAgIE1hcC5FbnRyeSBlOwogICAg\nICAgICAgICAgICAgT2JqZWN0IGtleTsKICAgICAgICAgICAgICAgIE9iamVj\ndCB2YWx1ZTsKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgbWkgPSBt\nLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgbWkuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICAgICAgICAgIGUgPSAoTWFwLkVudHJ5KSBtaS5uZXh0KCk7CiAg\nICAgICAgICAgICAgICAgICAga2V5ID0gdG9OZXN0ZWRGaWVsZChzbSwgZm1k\nLmdldEtleSgpLCBlLmdldEtleSgpLAogICAgICAgICAgICAgICAgICAgICAg\nICBmZXRjaCwgY29udGV4dCk7CiAgICAgICAgICAgICAgICAgICAgdmFsdWUg\nPSB0b05lc3RlZEZpZWxkKHNtLCBmbWQuZ2V0RWxlbWVudCgpLCBlLmdldFZh\nbHVlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIGZldGNoLCBjb250ZXh0\nKTsKICAgICAgICAgICAgICAgICAgICBtMi5wdXQoa2V5LCB2YWx1ZSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbTI7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAg\nICAgTGlzdCBsID0gKExpc3QpIGRhdGE7CiAgICAgICAgICAgICAgICBPYmpl\nY3QgYSA9IEFycmF5Lm5ld0luc3RhbmNlKGZtZC5nZXRFbGVtZW50KCkuZ2V0\nRGVjbGFyZWRUeXBlKCksCiAgICAgICAgICAgICAgICAgICAgbC5zaXplKCkp\nOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBsLnNpemUo\nKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgQXJyYXkuc2V0KGEsIGks\nIHRvTmVzdGVkRmllbGQoc20sIGZtZC5nZXRFbGVtZW50KCksCiAgICAgICAg\nICAgICAgICAgICAgICAgIGwuZ2V0KGkpLCBmZXRjaCwgY29udGV4dCkpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGE7CiAg\nICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gdG9O\nZXN0ZWRGaWVsZChzbSwgZm1kLCBkYXRhLCBmZXRjaCwgY29udGV4dCk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNmb3JtIHRoZSBn\naXZlbiBkYXRhIHZhbHVlIHRvIGl0cyBmaWVsZCB2YWx1ZS4gVGhlIGRhdGEg\ndmFsdWUKICAgICAqIG1heSBiZSBhIGtleSwgdmFsdWUsIG9yIGVsZW1lbnQg\nb2YgYSBtYXAgb3IgY29sbGVjdGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIE9iamVjdCB0b05lc3RlZEZpZWxkKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20s\nIFZhbHVlTWV0YURhdGEgdm1kLAogICAgICAgIE9iamVjdCBkYXRhLCBGZXRj\naENvbmZpZ3VyYXRpb24gZmV0Y2gsIE9iamVjdCBjb250ZXh0KSB7CiAgICAg\nICAgaWYgKGRhdGEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCgogICAgICAgIHN3aXRjaCAodm1kLmdldERlY2xhcmVkVHlwZUNvZGUoKSkg\newogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAgICAg\nICAgICAgcmV0dXJuICgoRGF0ZSkgZGF0YSkuY2xvbmUoKTsKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuTE9DQUxFOgogICAgICAgICAgICAgICAgcmV0\ndXJuIChMb2NhbGUpIGRhdGE7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLlBDOgogICAgICAgICAgICAgICAgaWYgKHZtZC5pc0VtYmVkZGVkKCkpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvRW1iZWRkZWRGaWVsZChzbSwg\ndm1kLCBkYXRhLCBmZXRjaCwgY29udGV4dCk7CiAgICAgICAgICAgICAgICAv\nLyBubyBicmVhawogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5QQ19VTlRZ\nUEVEOgogICAgICAgICAgICAgICAgT2JqZWN0IHJldCA9CiAgICAgICAgICAg\nICAgICAgICAgdG9SZWxhdGlvbkZpZWxkKHNtLCB2bWQsIGRhdGEsIGZldGNo\nLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIGlmIChyZXQgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0OwogICAgICAgICAgICAg\nICAgT3JwaGFuZWRLZXlBY3Rpb24gYWN0aW9uID0gc20uZ2V0Q29udGV4dCgp\nLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgICAgICAgICBnZXRP\ncnBoYW5lZEtleUFjdGlvbkluc3RhbmNlKCk7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gYWN0aW9uLm9ycGhhbihkYXRhLCBzbSwgdm1kKTsKICAgICAgICAg\nICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBkYXRhOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zZm9ybSB0aGUgZ2l2\nZW4gZGF0YSBpbnRvIGEgcmVsYXRpb24gZmllbGQgdmFsdWUuIERlZmF1bHQK\nICAgICAqIGltcGxlbWVudGF0aW9uIGFzc3VtZXMgdGhlIGRhdGEgaXMgYW4g\nb2lkLgogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHRvUmVsYXRpb25G\naWVsZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBWYWx1ZU1ldGFEYXRhIHZt\nZCwKICAgICAgICBPYmplY3QgZGF0YSwgRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoLCBPYmplY3QgY29udGV4dCkgewogICAgICAgIHJldHVybiBzbS5nZXRD\nb250ZXh0KCkuZmluZChkYXRhLCBmZXRjaCwgbnVsbCwgbnVsbCwgMCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2Zvcm0gdGhlIGdpdmVuIGRhdGEg\naW50byBhbiBlbWJlZGRlZCBQQyBmaWVsZCB2YWx1ZS4gRGVmYXVsdAogICAg\nICogaW1wbGVtZW50YXRpb24gYXNzdW1lcyB0aGUgZGF0YSBpcyBhbiB7QGxp\nbmsgQWJzdHJhY3RQQ0RhdGF9LgogICAgICovCiAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IHRvRW1iZWRkZWRGaWVsZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBW\nYWx1ZU1ldGFEYXRhIHZtZCwKICAgICAgICBPYmplY3QgZGF0YSwgRmV0Y2hD\nb25maWd1cmF0aW9uIGZldGNoLCBPYmplY3QgY29udGV4dCkgewogICAgICAg\nIEFic3RyYWN0UENEYXRhIHBjZGF0YSA9IChBYnN0cmFjdFBDRGF0YSkgZGF0\nYTsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIGVtYmVkZGVkID0gc20u\nZ2V0Q29udGV4dCgpLmVtYmVkKG51bGwsCiAgICAgICAgICAgIHBjZGF0YS5n\nZXRJZCgpLCBzbSwgdm1kKTsKICAgICAgICBwY2RhdGEubG9hZChlbWJlZGRl\nZCwgKEJpdFNldCkgcGNkYXRhLmdldExvYWRlZCgpLmNsb25lKCksCiAgICAg\nICAgICAgIGZldGNoLCBjb250ZXh0KTsKICAgICAgICByZXR1cm4gZW1iZWRk\nZWQuZ2V0TWFuYWdlZEluc3RhbmNlKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUcmFuc2Zvcm0gdGhlIGdpdmVuIGZpZWxkIHZhbHVlIHRvIGEgZGF0YSB2\nYWx1ZSBmb3IgY2FjaGluZy4gUmV0dXJuCiAgICAgKiB7QGxpbmsgI05VTEx9\nIGlmIHVuYWJsZSB0byBjYWNoZS4KICAgICAqLwogICAgcHJvdGVjdGVkIE9i\namVjdCB0b0RhdGEoRmllbGRNZXRhRGF0YSBmbWQsIE9iamVjdCB2YWwsIFN0\nb3JlQ29udGV4dCBjdHgpIHsKICAgICAgICBpZiAodmFsID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBzd2l0Y2ggKGZtZC5n\nZXREZWNsYXJlZFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgIENvbGxlY3Rpb24g\nYyA9IChDb2xsZWN0aW9uKSB2YWw7CiAgICAgICAgICAgICAgICBpZiAoYy5p\nc0VtcHR5KCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb3h5RGF0\nYUxpc3QuRU1QVFlfTElTVDsKICAgICAgICAgICAgICAgIFByb3h5RGF0YUxp\nc3QgYzIgPSBudWxsOwogICAgICAgICAgICAgICAgaW50IHNpemU7CiAgICAg\nICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGNpID0gYy5pdGVyYXRvcigpOyBj\naS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFsID0gdG9O\nZXN0ZWREYXRhKGZtZC5nZXRFbGVtZW50KCksIGNpLm5leHQoKSwgY3R4KTsK\nICAgICAgICAgICAgICAgICAgICBpZiAodmFsID09IE5VTEwpCiAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgICAgICAgICAg\nICAgIGlmIChjMiA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHNpemUgPSBjLnNpemUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYzIg\nPSBuZXcgUHJveHlEYXRhTGlzdChzaXplKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKGMgaW5zdGFuY2VvZiBQcm94eSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgQ2hhbmdlVHJhY2tlciBjdCA9ICgoUHJveHkpIGMp\nLmdldENoYW5nZVRyYWNrZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChjdCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGMyLm5leHRTZXF1ZW5jZSA9IGN0LmdldE5leHRTZXF1ZW5jZSgp\nOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGMyLm5leHRTZXF1ZW5jZSA9IHNpemU7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGMyLmFkZCh2\nYWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJu\nIGMyOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAg\nICAgICAgICBNYXAgbSA9IChNYXApIHZhbDsKICAgICAgICAgICAgICAgIGlm\nIChtLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ29s\nbGVjdGlvbnMuRU1QVFlfTUFQOwogICAgICAgICAgICAgICAgTWFwIG0yID0g\nbnVsbDsKICAgICAgICAgICAgICAgIE1hcC5FbnRyeSBlOwogICAgICAgICAg\nICAgICAgT2JqZWN0IHZhbDI7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJh\ndG9yIG1pID0gbS5lbnRyeVNldCgpLml0ZXJhdG9yKCk7IG1pLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgICAgICAgICBlID0gKE1hcC5FbnRyeSkgbWku\nbmV4dCgpOwogICAgICAgICAgICAgICAgICAgIHZhbCA9IHRvTmVzdGVkRGF0\nYShmbWQuZ2V0S2V5KCksIGUuZ2V0S2V5KCksIGN0eCk7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHZhbCA9PSBOVUxMKQogICAgICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gTlVMTDsKICAgICAgICAgICAgICAgICAgICB2YWwyID0g\ndG9OZXN0ZWREYXRhKGZtZC5nZXRFbGVtZW50KCksIGUuZ2V0VmFsdWUoKSwg\nY3R4KTsKICAgICAgICAgICAgICAgICAgICBpZiAodmFsMiA9PSBOVUxMKQog\nICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTlVMTDsKICAgICAgICAg\nICAgICAgICAgICBpZiAobTIgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICAgICAgbTIgPSBuZXcgSGFzaE1hcChtLnNpemUoKSk7CiAgICAgICAgICAg\nICAgICAgICAgbTIucHV0KHZhbCwgdmFsMik7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICByZXR1cm4gbTI7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgT2JqZWN0IGEgPSB2\nYWw7CiAgICAgICAgICAgICAgICBpbnQgbGVuZ3RoID0gQXJyYXkuZ2V0TGVu\nZ3RoKGEpOwogICAgICAgICAgICAgICAgaWYgKGxlbmd0aCA9PSAwKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy5FTVBUWV9MSVNU\nOwogICAgICAgICAgICAgICAgTGlzdCBsID0gbnVsbDsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgICAgICAgICB2YWwgPSB0b05lc3RlZERhdGEoZm1kLmdldEVsZW1l\nbnQoKSwgQXJyYXkuZ2V0KGEsIGkpLCBjdHgpOwogICAgICAgICAgICAgICAg\nICAgIGlmICh2YWwgPT0gTlVMTCkKICAgICAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIE5VTEw7CiAgICAgICAgICAgICAgICAgICAgaWYgKGwgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgbCA9IG5ldyBBcnJheUxpc3Qo\nbGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICBsLmFkZCh2YWwpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGw7CiAgICAg\nICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gdG9OZXN0\nZWREYXRhKGZtZCwgdmFsLCBjdHgpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFRyYW5zZm9ybSB0aGUgZ2l2ZW4gbmVzdGVkIHZhbHVlIHRv\nIGEgY2FjaGFibGUgdmFsdWUuIFJldHVybgogICAgICoge0BsaW5rICNOVUxM\nfSBpZiB0aGUgdmFsdWUgY2Fubm90IGJlIGNhY2hlZC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIE9iamVjdCB0b05lc3RlZERhdGEoVmFsdWVNZXRhRGF0YSB2\nbWQsIE9iamVjdCB2YWwsCiAgICAgICAgU3RvcmVDb250ZXh0IGN0eCkgewog\nICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CgogICAgICAgIHN3aXRjaCAodm1kLmdldERlY2xhcmVkVHlwZUNvZGUo\nKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAgICAgICAg\nICAgICAgIGlmICh2bWQuaXNFbWJlZGRlZCgpKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiB0b0VtYmVkZGVkRGF0YSh2YWwsIGN0eCk7CiAgICAgICAg\nICAgICAgICAvLyBubyBicmVhawogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5QQ19VTlRZUEVEOgogICAgICAgICAgICAgICAgcmV0dXJuIHRvUmVsYXRp\nb25EYXRhKHZhbCwgY3R4KTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nREFURToKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBQcm94\neSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChQcm94eSkgdmFsKS5j\nb3B5KHZhbCk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuICgoRGF0ZSkgdmFsKS5jbG9uZSgpOwogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5MT0NBTEU6CiAgICAgICAgICAgICAgICByZXR1\ncm4gKExvY2FsZSkgdmFsOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5P\nQkpFQ1Q6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgUHJv\neHkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoUHJveHkpIHZhbCku\nY29weSh2YWwpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgdmFsdWUgdG8gY2FjaGUgZm9yIHRoZSBn\naXZlbiBvYmplY3QuIENhY2hlcyBpdHMgb2lkIGJ5CiAgICAgKiBkZWZhdWx0\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHRvUmVsYXRpb25EYXRh\nKE9iamVjdCB2YWwsIFN0b3JlQ29udGV4dCBjdHgpIHsKICAgICAgICByZXR1\ncm4gY3R4LmdldE9iamVjdElkKHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIHZhbHVlIHRvIGNhY2hlIGZvciB0aGUgZ2l2ZW4gZW1i\nZWRkZWQgUEMuIENhY2hlcyBhCiAgICAgKiB7QGxpbmsgUENEYXRhfSBmcm9t\nIHtAbGluayAjbmV3RW1iZWRkZWRQQ0RhdGF9IGJ5IGRlZmF1bHQuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBPYmplY3QgdG9FbWJlZGRlZERhdGEoT2JqZWN0\nIHZhbCwgU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAgIGlmIChjdHggPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIE5VTEw7CgogICAgICAgIE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20gPSBjdHguZ2V0U3RhdGVNYW5hZ2VyKHZhbCk7\nCiAgICAgICAgaWYgKHNtID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBO\nVUxMOwoKICAgICAgICAvLyBoYXZlIHRvIGNhY2hlIGFsbCBkYXRhLCBzbyBt\nYWtlIHN1cmUgaXQncyBhbGwgbG9hZGVkCiAgICAgICAgLy8gIyMjIHByZXZl\nbnQgbG9hZGluZyBvZiB0aGluZ3MgdGhhdCBhcmVuJ3QgY2FjaGVkIChsb2Jz\nLCBscnMsIGV0YykKICAgICAgICBjdHgucmV0cmlldmUodmFsLCBmYWxzZSwg\nbnVsbCk7CgogICAgICAgIFBDRGF0YSBwY2RhdGEgPSBuZXdFbWJlZGRlZFBD\nRGF0YShzbSk7CiAgICAgICAgcGNkYXRhLnN0b3JlKHNtKTsKICAgICAgICBy\nZXR1cm4gcGNkYXRhOwogICAgfQoKICAgIC8qKgogICAgICogVHJhY2tzIHBy\nb3h5IGRhdGEgYWxvbmcgd2l0aCBsaXN0IGVsZW1lbnRzLgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBjbGFzcyBQcm94eURhdGFMaXN0CiAgICAgICAg\nZXh0ZW5kcyBBcnJheUxpc3QgewoKICAgICAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFByb3h5RGF0YUxpc3QgRU1QVFlfTElTVCA9IG5ldyBQcm94eURhdGFM\naXN0KDApOwoKICAgICAgICBwdWJsaWMgaW50IG5leHRTZXF1ZW5jZSA9IDA7\nCgogICAgICAgIHB1YmxpYyBQcm94eURhdGFMaXN0KGludCBzaXplKSB7CgkJ\nCXN1cGVyIChzaXplKTsKCQl9Cgl9Cn0K\n","encoding":"base64"}

