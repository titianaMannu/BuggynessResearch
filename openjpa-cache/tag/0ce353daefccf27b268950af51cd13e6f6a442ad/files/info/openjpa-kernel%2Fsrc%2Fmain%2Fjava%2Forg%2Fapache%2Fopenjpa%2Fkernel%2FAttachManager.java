{"sha":"5b1eeb690a3f4c3554d84a163eb8a6bd809e7fc8","node_id":"MDQ6QmxvYjIwNjM2NDo1YjFlZWI2OTBhM2Y0YzM1NTRkODRhMTYzZWI4YTZiZDgwOWU3ZmM4","size":10676,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5b1eeb690a3f4c3554d84a163eb8a6bd809e7fc8","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWw7CgppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmNvbGxlY3Rpb25zLm1hcC5JZGVudGl0eU1hcDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5lbmhhbmNlLlBlcnNpc3RlbmNlQ2FwYWJsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5ldmVudC5DYWxsYmFja01vZGVzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LkxpZmVjeWNsZUV2ZW50Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5WYWx1ZU1ldGFEYXRh\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuQ2FsbGJhY2tFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5FeGNlcHRp\nb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3BlbkpQQUV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wdGlt\naXN0aWNFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5Qcm94eU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5Vc2VyRXhjZXB0aW9uOwoKLyoqCiAqIEhhbmRsZXMgYXR0YWNoaW5nIGlu\nc3RhbmNlcy4KICoKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICov\nCmNsYXNzIEF0dGFjaE1hbmFnZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAg\nICAgICAoQXR0YWNoTWFuYWdlci5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5h\nbCBCcm9rZXJJbXBsIF9icm9rZXI7CiAgICBwcml2YXRlIGZpbmFsIFByb3h5\nTWFuYWdlciBfcHJveHk7CiAgICBwcml2YXRlIGZpbmFsIE9wQ2FsbGJhY2tz\nIF9jYWxsOwogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9jb3B5TmV3Owog\nICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9mYWlsRmFzdDsKICAgIHByaXZh\ndGUgZmluYWwgSWRlbnRpdHlNYXAgX2F0dGFjaGVkID0gbmV3IElkZW50aXR5\nTWFwKCk7CgogICAgLy8gcmV1c2FibGUgc3RyYXRlZ2llcwogICAgcHJpdmF0\nZSBBdHRhY2hTdHJhdGVneSBfdmVyc2lvbiA9IG51bGw7CiAgICBwcml2YXRl\nIEF0dGFjaFN0cmF0ZWd5IF9kZXRhY2ggPSBudWxsOwoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3IuIFN1cHBseSBicm9rZXIgYXR0YWNoaW5nIHRvLgog\nICAgICovCiAgICBwdWJsaWMgQXR0YWNoTWFuYWdlcihCcm9rZXJJbXBsIGJy\nb2tlciwgYm9vbGVhbiBjb3B5TmV3LCBPcENhbGxiYWNrcyBjYWxsKSB7CiAg\nICAgICAgX2Jyb2tlciA9IGJyb2tlcjsKICAgICAgICBfcHJveHkgPSBicm9r\nZXIuZ2V0Q29uZmlndXJhdGlvbigpLmdldFByb3h5TWFuYWdlckluc3RhbmNl\nKCk7CiAgICAgICAgX2NhbGwgPSBjYWxsOwogICAgICAgIF9jb3B5TmV3ID0g\nY29weU5ldzsKICAgICAgICBfZmFpbEZhc3QgPSAoYnJva2VyLmdldENvbmZp\nZ3VyYXRpb24oKS5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLgog\nICAgICAgICAgICBnZXRNZXRhRGF0YUZhY3RvcnkoKS5nZXREZWZhdWx0cygp\nLmdldENhbGxiYWNrTW9kZSgpCiAgICAgICAgICAgICYgQ2FsbGJhY2tNb2Rl\ncy5DQUxMQkFDS19GQUlMX0ZBU1QpICE9IDA7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIGJlaGF2aW9yIHN1cHBsaWVkIG9uIGNvbnN0cnVj\ndGlvbi4KICAgICAqLwogICAgcHVibGljIE9wQ2FsbGJhY2tzIGdldEJlaGF2\naW9yKCkgewogICAgICAgIHJldHVybiBfY2FsbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB3aGV0aGVyIHRvIGNvcHkgbmV3IGluc3RhbmNlcyBi\nZWluZyBwZXJzaXN0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdl\ndENvcHlOZXcoKSB7CiAgICAgICAgcmV0dXJuIF9jb3B5TmV3OwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIGFuIGF0dGFjaGVkIHZlcnNpb24gb2Yg\ndGhlIGdpdmVuIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0\nIGF0dGFjaChPYmplY3QgcGMpIHsKICAgICAgICBpZiAocGMgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIENhbGxiYWNrRXhj\nZXB0aW9uIGV4Y2VwID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAg\nICByZXR1cm4gYXR0YWNoKHBjLCBudWxsLCBudWxsLCBudWxsLCB0cnVlKTsK\nICAgICAgICB9IGNhdGNoIChDYWxsYmFja0V4Y2VwdGlvbiBjZSkgewogICAg\nICAgICAgICBleGNlcCA9IGNlOwogICAgICAgICAgICByZXR1cm4gbnVsbDsg\nLy8gd29uJ3QgYmUgcmVhY2hlZCBhcyB0aGUgZXhjZXBzIHdpbGwgYmUgcmV0\naHJvd24KICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBMaXN0IGV4\nY2VwcyA9IG51bGw7CiAgICAgICAgICAgIGlmIChleGNlcCA9PSBudWxsIHx8\nICFfZmFpbEZhc3QpCiAgICAgICAgICAgICAgICBleGNlcHMgPSBpbnZva2VB\nZnRlckF0dGFjaChudWxsKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgZXhjZXBzID0gQ29sbGVjdGlvbnMuc2luZ2xldG9uTGlzdChleGNl\ncCk7CiAgICAgICAgICAgIF9hdHRhY2hlZC5jbGVhcigpOwogICAgICAgICAg\nICB0aHJvd0V4Y2VwdGlvbnMoZXhjZXBzLCBudWxsLCBmYWxzZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGF0dGFjaGVkIHZl\ncnNpb25zIG9mIHRoZSBnaXZlbiBpbnN0YW5jZXMuCiAgICAgKi8KICAgIHB1\nYmxpYyBPYmplY3RbXSBhdHRhY2hBbGwoQ29sbGVjdGlvbiBpbnN0YW5jZXMp\nIHsKICAgICAgICBPYmplY3RbXSBhdHRhY2hlZCA9IG5ldyBPYmplY3RbaW5z\ndGFuY2VzLnNpemUoKV07CiAgICAgICAgTGlzdCBleGNlcHMgPSBudWxsOwog\nICAgICAgIExpc3QgZmFpbGVkID0gbnVsbDsKICAgICAgICBib29sZWFuIG9w\ndCA9IHRydWU7CiAgICAgICAgYm9vbGVhbiBmYWlsRmFzdCA9IGZhbHNlOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGludCBpID0gMDsKICAgICAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBpbnN0YW5jZXMuaXRlcmF0b3IoKTsg\naXRyLmhhc05leHQoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIGF0dGFjaGVkW2ldID0gYXR0YWNoKGl0ci5u\nZXh0KCksIG51bGwsIG51bGwsIG51bGwsIHRydWUpOwogICAgICAgICAgICAg\nICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAg\nICAgICAgICAgIC8vIHRyYWNrIGV4Y2VwdGlvbnMgYW5kIG9wdGltaXN0aWMg\nZmFpbGVkIG9iamVjdHMKICAgICAgICAgICAgICAgICAgICBpZiAob3B0ICYm\nICEoa2UgaW5zdGFuY2VvZiBPcHRpbWlzdGljRXhjZXB0aW9uKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgb3B0ID0gZmFsc2U7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKG9wdCAmJiBrZS5nZXRGYWlsZWRPYmplY3QoKSAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWQgPSBhZGQoZmFpbGVk\nLCBrZS5nZXRGYWlsZWRPYmplY3QoKSk7CiAgICAgICAgICAgICAgICAgICAg\nZXhjZXBzID0gYWRkKGV4Y2Vwcywga2UpOwoKICAgICAgICAgICAgICAgICAg\nICBpZiAoa2UgaW5zdGFuY2VvZiBDYWxsYmFja0V4Y2VwdGlvbiAmJiBfZmFp\nbEZhc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmFpbEZhc3QgPSB0\ncnVlOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICAg\nICAgICAgIGV4Y2VwcyA9IGFkZChleGNlcHMsIHJlKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIC8vIGludm9rZSBwb3N0IGNhbGxiYWNrcyB1bmxlc3MgYWxsIGZh\naWxlZAogICAgICAgICAgICBpZiAoIWZhaWxGYXN0ICYmIChleGNlcHMgPT0g\nbnVsbAogICAgICAgICAgICAgICAgfHwgZXhjZXBzLnNpemUoKSA8IGluc3Rh\nbmNlcy5zaXplKCkpKQogICAgICAgICAgICAgICAgZXhjZXBzID0gaW52b2tl\nQWZ0ZXJBdHRhY2goZXhjZXBzKTsKICAgICAgICAgICAgX2F0dGFjaGVkLmNs\nZWFyKCk7CiAgICAgICAgfQogICAgICAgIHRocm93RXhjZXB0aW9ucyhleGNl\ncHMsIGZhaWxlZCwgb3B0KTsKICAgICAgICByZXR1cm4gYXR0YWNoZWQ7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgcG9zdEF0dGFjaCgpIG9uIGFu\neSBhdHRhY2hlZCBpbnN0YW5jZXMgdGhhdCBpbXBsZW1lbnQKICAgICAqIFBv\nc3RBdHRhY2hDYWxsYmFjay4gVGhpcyB3aWxsIGJlIGRvbmUgYWZ0ZXIgdGhl\nIGVudGlyZSBncmFwaCBoYXMKICAgICAqIGJlZW4gYXR0YWNoZWQuCiAgICAg\nKi8KICAgIHByaXZhdGUgTGlzdCBpbnZva2VBZnRlckF0dGFjaChMaXN0IGV4\nY2VwcykgewogICAgICAgIFNldCBlbnRyaWVzID0gX2F0dGFjaGVkLmVudHJ5\nU2V0KCk7CiAgICAgICAgZm9yIChJdGVyYXRvciBpID0gZW50cmllcy5pdGVy\nYXRvcigpOyBpLmhhc05leHQoKTspIHsKICAgICAgICAgICAgTWFwLkVudHJ5\nIGVudHJ5ID0gKE1hcC5FbnRyeSkgaS5uZXh0KCk7CiAgICAgICAgICAgIE9i\namVjdCBhdHRhY2hlZCA9IGVudHJ5LmdldFZhbHVlKCk7CiAgICAgICAgICAg\nIFN0YXRlTWFuYWdlckltcGwgc20gPSBfYnJva2VyLmdldFN0YXRlTWFuYWdl\nckltcGwoYXR0YWNoZWQsIHRydWUpOwogICAgICAgICAgICBpZiAoc20uaXNO\nZXcoKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgX2Jyb2tlci5maXJlTGlmZWN5Y2xlRXZl\nbnQoYXR0YWNoZWQsIGVudHJ5LmdldEtleSgpLAogICAgICAgICAgICAgICAg\nICAgIHNtLmdldE1ldGFEYXRhKCksIExpZmVjeWNsZUV2ZW50LkFGVEVSX0FU\nVEFDSCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24g\ncmUpIHsKICAgICAgICAgICAgICAgIGV4Y2VwcyA9IGFkZChleGNlcHMsIHJl\nKTsKICAgICAgICAgICAgICAgIGlmIChfZmFpbEZhc3QgJiYgcmUgaW5zdGFu\nY2VvZiBDYWxsYmFja0V4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\nZXhjZXBzOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGFuIG9iamVjdCB0\nbyB0aGUgbGlzdC4KICAgICAqLwogICAgcHJpdmF0ZSBMaXN0IGFkZChMaXN0\nIGxpc3QsIE9iamVjdCBvYmopIHsKICAgICAgICBpZiAobGlzdCA9PSBudWxs\nKQogICAgICAgICAgICBsaXN0ID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAg\nICBsaXN0LmFkZChvYmopOwogICAgICAgIHJldHVybiBsaXN0OwogICAgfQoK\nICAgIC8qKgogICAgICogVGhyb3cgZXhjZXB0aW9uIGZvciBmYWlsdXJlcy4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHRocm93RXhjZXB0aW9ucyhMaXN0\nIGV4Y2VwcywgTGlzdCBmYWlsZWQsIGJvb2xlYW4gb3B0KSB7CiAgICAgICAg\naWYgKGV4Y2VwcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgaWYgKGV4Y2Vwcy5zaXplKCkgPT0gMSkKICAgICAgICAgICAgdGhyb3cg\nKFJ1bnRpbWVFeGNlcHRpb24pIGV4Y2Vwcy5nZXQoMCk7CgogICAgICAgIFRo\ncm93YWJsZVtdIHQgPSAoVGhyb3dhYmxlW10pIGV4Y2Vwcy50b0FycmF5CiAg\nICAgICAgICAgIChuZXcgVGhyb3dhYmxlW2V4Y2Vwcy5zaXplKCldKTsKICAg\nICAgICBpZiAob3B0ICYmIGZhaWxlZCAhPSBudWxsKQogICAgICAgICAgICB0\naHJvdyBuZXcgT3B0aW1pc3RpY0V4Y2VwdGlvbihmYWlsZWQsIHQpOwogICAg\nICAgIGlmIChvcHQpCiAgICAgICAgICAgIHRocm93IG5ldyBPcHRpbWlzdGlj\nRXhjZXB0aW9uKHQpOwogICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJuZXN0ZWQtZXhjZXBzIikpLgogICAgICAgICAgICBzZXRO\nZXN0ZWRUaHJvd2FibGVzKHQpOwogICAgfQoKICAgIC8qKgogICAgICogQXR0\nYWNoLgogICAgICoKICAgICAqIEBwYXJhbSB0b0F0dGFjaCB0aGUgZGV0YWNo\nZWQgb2JqZWN0CiAgICAgKiBAcGFyYW0gaW50byB0aGUgaW5zdGFuY2Ugd2Un\ncmUgYXR0YWNoaW5nIGludG8KICAgICAqIEBwYXJhbSBvd25lciBzdGF0ZSBt\nYW5hZ2VyIGZvciA8Y29kZT5pbnRvPC9jb2RlPgogICAgICogQHBhcmFtIG93\nbmVyTWV0YSB0aGUgZmllbGQgd2UgdHJhdmVyc2VkIHRvIGZpbmQgPGNvZGU+\ndG9BdHRhY2g8L2NvZGU+CiAgICAgKiBAcGFyYW0gZXhwbGljaXQgd2hldGhl\nciB0byBtYWtlIG5ldyBpbnN0YW5jZXMgZXhwbGljaXRseSBwZXJzaXN0ZW50\nCiAgICAgKi8KICAgIE9iamVjdCBhdHRhY2goT2JqZWN0IHRvQXR0YWNoLCBQ\nZXJzaXN0ZW5jZUNhcGFibGUgaW50bywKICAgICAgICBPcGVuSlBBU3RhdGVN\nYW5hZ2VyIG93bmVyLCBWYWx1ZU1ldGFEYXRhIG93bmVyTWV0YSwgYm9vbGVh\nbiBleHBsaWNpdCkgewogICAgICAgIGlmICh0b0F0dGFjaCA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8gY2hlY2sgaWYg\nYWxyZWFkeSBhdHRhY2hlZAogICAgICAgIE9iamVjdCBhdHRhY2hlZCA9IF9h\ndHRhY2hlZC5nZXQodG9BdHRhY2gpOwogICAgICAgIGlmIChhdHRhY2hlZCAh\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gYXR0YWNoZWQ7CgogICAgICAg\nIC8vIyMjIG5lZWQgdG8gaGFuZGxlIEFDVF9DQVNDQURFCiAgICAgICAgaW50\nIGFjdGlvbiA9IHByb2Nlc3NBcmd1bWVudCh0b0F0dGFjaCk7CiAgICAgICAg\naWYgKChhY3Rpb24gJiBPcENhbGxiYWNrcy5BQ1RfUlVOKSA9PSAwKQogICAg\nICAgICAgICByZXR1cm4gdG9BdHRhY2g7CgogICAgICAgIC8vIyMjIG5lZWQg\ndG8gaGFuZGxlIEFDVF9SVU4gd2l0aG91dCBhbHNvIEFDVF9DQVNDQURFCiAg\nICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gX2Jyb2tlci5nZXRDb25maWd1\ncmF0aW9uKCkuCiAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkuZ2V0TWV0YURhdGEodG9BdHRhY2guZ2V0Q2xhc3MoKSwKICAg\nICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsKICAg\nICAgICByZXR1cm4gZ2V0U3RyYXRlZ3kodG9BdHRhY2gpLmF0dGFjaCh0aGlz\nLCB0b0F0dGFjaCwgbWV0YSwgaW50bywKICAgICAgICAgICAgb3duZXIsIG93\nbmVyTWV0YSwgZXhwbGljaXQpOwogICAgfQoKICAgIC8qKgogICAgICogRGV0\nZXJtaW5lIHRoZSBhY3Rpb24gdG8gdGFrZSBvbiB0aGUgZ2l2ZW4gYXJndW1l\nbnQuCiAgICAgKi8KICAgIHByaXZhdGUgaW50IHByb2Nlc3NBcmd1bWVudChP\nYmplY3Qgb2JqKSB7CiAgICAgICAgaWYgKF9jYWxsID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBPcENhbGxiYWNrcy5BQ1RfUlVOOwogICAgICAgIHJl\ndHVybiBfY2FsbC5wcm9jZXNzQXJndW1lbnQoT3BDYWxsYmFja3MuT1BfQVRU\nQUNILCBvYmosCiAgICAgICAgICAgIF9icm9rZXIuZ2V0U3RhdGVNYW5hZ2Vy\nKG9iaikpOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHByb3Bl\nciBhdHRhY2ggc3RyYXRlZ3kgZm9yIGluc3RhbmNlLgogICAgICovCiAgICBw\ncml2YXRlIEF0dGFjaFN0cmF0ZWd5IGdldFN0cmF0ZWd5KE9iamVjdCB0b0F0\ndGFjaCkgewogICAgICAgIFBlcnNpc3RlbmNlQ2FwYWJsZSBwYyA9IChQZXJz\naXN0ZW5jZUNhcGFibGUpIHRvQXR0YWNoOwogICAgICAgIGlmIChwYy5wY0dl\ndFN0YXRlTWFuYWdlcigpIGluc3RhbmNlb2YgQXR0YWNoU3RyYXRlZ3kpCiAg\nICAgICAgICAgIHJldHVybiAoQXR0YWNoU3RyYXRlZ3kpIHBjLnBjR2V0U3Rh\ndGVNYW5hZ2VyKCk7CgogICAgICAgIE9iamVjdCBvYmogPSBwYy5wY0dldERl\ndGFjaGVkU3RhdGUoKTsKICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgQXR0\nYWNoU3RyYXRlZ3kpCiAgICAgICAgICAgIHJldHVybiAoQXR0YWNoU3RyYXRl\nZ3kpIG9iajsKICAgICAgICBpZiAob2JqID09IG51bGwgfHwgb2JqID09IFBl\ncnNpc3RlbmNlQ2FwYWJsZS5ERVNFUklBTElaRUQpIHsKICAgICAgICAgICAg\nLy8gbmV3IG9yIGRldGFjaGVkIHdpdGhvdXQgc3RhdGUKICAgICAgICAgICAg\naWYgKF92ZXJzaW9uID09IG51bGwpCiAgICAgICAgICAgICAgICBfdmVyc2lv\nbiA9IG5ldyBWZXJzaW9uQXR0YWNoU3RyYXRlZ3koKTsKICAgICAgICAgICAg\ncmV0dXJuIF92ZXJzaW9uOwogICAgICAgIH0KCiAgICAgICAgLy8gZGV0YWNo\nZWQgc3RhdGUKICAgICAgICBpZiAoX2RldGFjaCA9PSBudWxsKQogICAgICAg\nICAgICBfZGV0YWNoID0gbmV3IERldGFjaGVkU3RhdGVBdHRhY2hTdHJhdGVn\neSgpOwogICAgICAgIHJldHVybiBfZGV0YWNoOwogICAgfQoKICAgIC8qKgog\nICAgICogT3duaW5nIGJyb2tlci4KICAgICAqLwogICAgQnJva2VySW1wbCBn\nZXRCcm9rZXIoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXI7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTeXN0ZW0gcHJveHkgbWFuYWdlci4KICAgICAqLwog\nICAgUHJveHlNYW5hZ2VyIGdldFByb3h5TWFuYWdlcigpIHsKICAgICAgICBy\nZXR1cm4gX3Byb3h5OwogICAgfQoKICAgIC8qKgogICAgICogSWYgdGhlIHBh\nc3NlZCBpbiBhcmd1bWVudCBoYXMgYWxyZWFkeSBiZWVuIGF0dGFjaGVkLCBy\nZXR1cm4KICAgICAqIHRoZSAoY2FjaGVkKSBhdHRhY2hlZCBjb3B5LgogICAg\nICovCiAgICBQZXJzaXN0ZW5jZUNhcGFibGUgZ2V0QXR0YWNoZWRDb3B5KE9i\namVjdCBwYykgewogICAgICAgIHJldHVybiAoUGVyc2lzdGVuY2VDYXBhYmxl\nKSBfYXR0YWNoZWQuZ2V0KHBjKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\nY29yZCB0aGUgYXR0YWNoZWQgY29weSBpbiB0aGUgY2FjaGUuCiAgICAgKi8K\nICAgIHZvaWQgc2V0QXR0YWNoZWRDb3B5KE9iamVjdCBmcm9tLCBQZXJzaXN0\nZW5jZUNhcGFibGUgaW50bykgewogICAgICAgIF9hdHRhY2hlZC5wdXQoZnJv\nbSwgaW50byk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaXJlIGJlZm9yZS1h\ndHRhY2ggZXZlbnQuCiAgICAgKi8KICAgIHZvaWQgZmlyZUJlZm9yZUF0dGFj\naChPYmplY3QgcGMsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIF9i\ncm9rZXIuZmlyZUxpZmVjeWNsZUV2ZW50KHBjLCBudWxsLCBtZXRhLAogICAg\nICAgICAgICBMaWZlY3ljbGVFdmVudC5CRUZPUkVfQVRUQUNIKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGV0YWNoZWQgb2lkIG9mIHRo\nZSBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAgT2JqZWN0IGdldERldGFj\naGVkT2JqZWN0SWQoT2JqZWN0IHBjKSB7CiAgICAgICAgaWYgKHBjID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBn\nZXRTdHJhdGVneShwYykuZ2V0RGV0YWNoZWRPYmplY3RJZCh0aGlzLCBwYyk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBhbiBleGNlcHRpb24gaWYg\ndGhlIGdpdmVuIG9iamVjdCBpcyBub3QgbWFuYWdlZDsgb3RoZXJ3aXNlCiAg\nICAgKiByZXR1cm4gaXRzIHN0YXRlIG1hbmFnZXIuCiAgICAgKi8KICAgIFN0\nYXRlTWFuYWdlckltcGwgYXNzZXJ0TWFuYWdlZChPYmplY3Qgb2JqKSB7CiAg\nICAgICAgU3RhdGVNYW5hZ2VySW1wbCBzbSA9IF9icm9rZXIuZ2V0U3RhdGVN\nYW5hZ2VySW1wbChvYmosIHRydWUpOwogICAgICAgIGlmIChzbSA9PSBudWxs\nKQogICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdl\ndCgibm90LW1hbmFnZWQiLAogICAgICAgICAgICAgICAgRXhjZXB0aW9ucy50\nb1N0cmluZyhvYmopKSkuc2V0RmFpbGVkT2JqZWN0IChvYmopOwoJCXJldHVy\nbiBzbTsKCX0KfQo=\n","encoding":"base64"}

