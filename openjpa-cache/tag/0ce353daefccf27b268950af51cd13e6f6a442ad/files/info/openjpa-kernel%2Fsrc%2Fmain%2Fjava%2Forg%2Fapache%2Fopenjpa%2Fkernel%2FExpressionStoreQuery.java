{"sha":"8031cf989d9e9ae83851a8300b47e6fcc884f788","node_id":"MDQ6QmxvYjIwNjM2NDo4MDMxY2Y5ODlkOWU5YWU4Mzg1MWE4MzAwYjQ3ZTZmY2M4ODRmNzg4","size":27973,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8031cf989d9e9ae83851a8300b47e6fcc884f788","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWw7CgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGls\nLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBq\nYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jb2xs\nZWN0aW9ucy5tYXAuTGlua2VkTWFwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQWJzdHJhY3RFeHByZXNzaW9uVmlz\naXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5B\nZ2dyZWdhdGVMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuZXhwcy5Db25zdGFudDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uUGFyc2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkZpbHRlckxp\nc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBz\nLkluTWVtb3J5RXhwcmVzc2lvbkZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuUGF0aDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5RdWVyeUV4cHJlc3Npb25zOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlJlc29sdmVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlN0cmluZ0NvbnRh\naW5zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZh\nbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5XaWxk\nY2FyZE1hdGNoOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3Au\nTGlzdFJlc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5yb3AuUmFuZ2VSZXN1bHRPYmplY3RQcm92aWRlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVjdFBy\nb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVs\nZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2\nYVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW1wbEhl\nbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRT\ndGF0ZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlVuc3VwcG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBJbXBsZW1lbnRhdGlv\nbiBvZiBhbiBleHByZXNzaW9uLWJhc2VkIHF1ZXJ5LCB3aGljaCBjYW4gaGFu\nZGxlCiAqIFN0cmluZy1iYXNlZCBxdWVyeSBleHByZXNzaW9ucyBzdWNoIGFz\nIEpQUUwgYW5kIEpET1FMLgogKiBUaGlzIGltcGxlbWVudGF0aW9uIGlzIHN1\naXRhYmxlIGZvciBpbi1tZW1vcnkgb3BlcmF0aW9uLgogKiBPdmVycmlkZSB0\naGUgZm9sbG93aW5nIG1ldGhvZHMgdG8gYWxzbyBzdXBwb3J0IGRhdGFzdG9y\nZSBvcGVyYXRpb246CiAqIDx1bD4KICogPGxpPk92ZXJyaWRlIHtAbGluayAj\nc3VwcG9ydHNEYXRhU3RvcmVFeGVjdXRpb259IHRvIHJldHVybgogKiA8Y29k\nZT50cnVlPC9jb2RlPi48L2xpPgogKiA8bGk+T3ZlcnJpZGUge0BsaW5rICNl\neGVjdXRlUXVlcnl9LCB7QGxpbmsgI2V4ZWN1dGVEZWxldGV9LCBhbmQKICog\ne0BsaW5rICNleGVjdXRlVXBkYXRlfSB0byBleGVjdXRlIHRoZSBxdWVyeSBh\nZ2FpbnN0IHRoZSBkYXRhIHN0b3JlLgogKiBLZWVwIGluIG1pbmQgdGhhdCB0\naGUgcGFyYW1ldGVycyBwYXNzZWQgdG8gdGhpcyBtZXRob2QgbWlnaHQgYmUg\naW4gdXNlCiAqIGJ5IHNldmVyYWwgdGhyZWFkcyBpbiBkaWZmZXJlbnQgcXVl\ncnkgaW5zdGFuY2VzLiBUaHVzIGNvbXBvbmVudHMgbGlrZQogKiB0aGUgZXhw\ncmVzc2lvbiBmYWN0b3J5IG11c3QgZWl0aGVyIGJlIHRocmVhZCBzYWZlLCBv\nciB0aGlzIG1ldGhvZCBtdXN0CiAqIHN5bmNocm9uaXplIG9uIHRoZW0uPC9s\naT4KICogPGxpPk92ZXJyaWRlIHtAbGluayAjZ2V0RGF0YVN0b3JlQWN0aW9u\nc30gdG8gcmV0dXJuIGEgcmVwcmVzZW50YXRpb24gb2YKICogdGhlIGFjdGlv\nbnMgdGhhdCB3aWxsIGJlIHRha2VuIG9uIHRoZSBkYXRhIHN0b3JlLiBGb3Ig\ndXNlIGluIHZpc3VhbAogKiB0b29scy48L2xpPgogKiA8bGk+T3ZlcnJpZGUg\ne0BsaW5rICNnZXRFeHByZXNzaW9uRmFjdG9yeX0gdG8gcmV0dXJuIGEgZmFj\ndG9yeSBmb3IgY3JlYXRpbmcKICogZXhwcmVzc2lvbnMgaW4gdGhlIGRhdGFz\ndG9yZSdzIGxhbmd1YWdlLiBUaGUgZmFjdG9yeSBtdXN0IGJlIGNhY2hhYmxl\nLjwvbGk+CiAqIDwvdWw+CiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpw\ndWJsaWMgY2xhc3MgRXhwcmVzc2lvblN0b3JlUXVlcnkKICAgIGV4dGVuZHMg\nQWJzdHJhY3RTdG9yZVF1ZXJ5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAg\nICAgKEV4cHJlc3Npb25TdG9yZVF1ZXJ5LmNsYXNzKTsKCiAgICAvLyBtYWlu\ndGFpbiBzdXBwb3J0IGZvciBhIGNvdXBsZSBvZiBkZXByZWNhdGVkIGV4dGVu\nc2lvbnMKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIEZpbHRlckxpc3RlbmVy\nW10gX2xpc3RlbmVycyA9IG5ldyBGaWx0ZXJMaXN0ZW5lcltdewogICAgICAg\nIG5ldyBTdHJpbmdDb250YWlucygpLCBuZXcgV2lsZGNhcmRNYXRjaCgpLAog\nICAgfTsKCiAgICBwcml2YXRlIGZpbmFsIEV4cHJlc3Npb25QYXJzZXIgX3Bh\ncnNlcjsKICAgIHByaXZhdGUgdHJhbnNpZW50IE9iamVjdCBfcGFyc2VkOwoK\nICAgIC8qKgogICAgICogQ29uc3RydWN0IGEgcXVlcnkgd2l0aCBhIHBhcnNl\nciBmb3IgdGhlIGxhbmd1YWdlLgogICAgICovCiAgICBwdWJsaWMgRXhwcmVz\nc2lvblN0b3JlUXVlcnkoRXhwcmVzc2lvblBhcnNlciBwYXJzZXIpIHsKICAg\nICAgICBfcGFyc2VyID0gcGFyc2VyOwogICAgfQoKICAgIC8qKgogICAgICog\nUmVzb2x2ZXIgdXNlZCBpbiBwYXJzaW5nLgogICAgICovCiAgICBwdWJsaWMg\nUmVzb2x2ZXIgZ2V0UmVzb2x2ZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBS\nZXNvbHZlcigpIHsKICAgICAgICAgICAgcHVibGljIENsYXNzIGNsYXNzRm9y\nTmFtZShTdHJpbmcgbmFtZSwgU3RyaW5nW10gaW1wb3J0cykgewogICAgICAg\nICAgICAgICAgcmV0dXJuIGN0eC5jbGFzc0Zvck5hbWUobmFtZSwgaW1wb3J0\ncyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBGaWx0ZXJM\naXN0ZW5lciBnZXRGaWx0ZXJMaXN0ZW5lcihTdHJpbmcgdGFnKSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gY3R4LmdldEZpbHRlckxpc3RlbmVyKHRhZyk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBBZ2dyZWdhdGVM\naXN0ZW5lciBnZXRBZ2dyZWdhdGVMaXN0ZW5lcihTdHJpbmcgdGFnKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm4gY3R4LmdldEFnZ3JlZ2F0ZUxpc3RlbmVy\nKHRhZyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBPcGVu\nSlBBQ29uZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIGN0eC5nZXRTdG9yZUNvbnRleHQoKS5nZXRDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgfQoK\nICAgIC8qKgogICAgICogQWxsb3cgZGlyZWN0IHNldHRpbmcgb2YgcGFyc2Vk\nIHN0YXRlIGZvciBmYWNhZGVzIHRoYXQgZG8gcGFyc2luZy4KICAgICAqIFRo\nZSBmYWNhZGUgc2hvdWxkIGNhbGwgdGhpcyBtZXRob2QgdHdpY2U6IG9uY2Ug\nd2l0aCB0aGUgcXVlcnkgc3RyaW5nLAogICAgICogYW5kIGFnYWluIHdpdGgg\ndGhlIHBhcnNlZCBzdGF0ZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4g\nc2V0UXVlcnkoT2JqZWN0IHF1ZXJ5KSB7CiAgICAgICAgX3BhcnNlZCA9IHF1\nZXJ5OwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBG\naWx0ZXJMaXN0ZW5lciBnZXRGaWx0ZXJMaXN0ZW5lcihTdHJpbmcgdGFnKSB7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfbGlzdGVuZXJzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBpZiAoX2xpc3RlbmVyc1tpXS5nZXRUYWco\nKS5lcXVhbHModGFnKSkKICAgICAgICAgICAgICAgIHJldHVybiBfbGlzdGVu\nZXJzW2ldOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgbmV3Q29tcGlsYXRpb24oKSB7CiAgICAgICAgaWYgKF9wYXJz\nZWQgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9wYXJzZWQ7CiAgICAg\nICAgcmV0dXJuIF9wYXJzZXIucGFyc2UoY3R4LmdldFF1ZXJ5U3RyaW5nKCks\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBvcHVsYXRlRnJvbUNv\nbXBpbGF0aW9uKE9iamVjdCBjb21wKSB7CiAgICAgICAgX3BhcnNlci5wb3B1\nbGF0ZShjb21wLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbnZh\nbGlkYXRlQ29tcGlsYXRpb24oKSB7CiAgICAgICAgX3BhcnNlZCA9IG51bGw7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNJbk1lbW9yeUV4\nZWN1dGlvbigpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw\ndWJsaWMgRXhlY3V0b3IgbmV3SW5NZW1vcnlFeGVjdXRvcihDbGFzc01ldGFE\nYXRhIG1ldGEsIGJvb2xlYW4gc3VicykgewogICAgICAgIHJldHVybiBuZXcg\nSW5NZW1vcnlFeGVjdXRvcih0aGlzLCBtZXRhLCBzdWJzLCBfcGFyc2VyLAog\nICAgICAgICAgICBjdHguZ2V0Q29tcGlsYXRpb24oKSk7CiAgICB9CgogICAg\ncHVibGljIEV4ZWN1dG9yIG5ld0RhdGFTdG9yZUV4ZWN1dG9yKENsYXNzTWV0\nYURhdGEgbWV0YSwgYm9vbGVhbiBzdWJzKSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBEYXRhU3RvcmVFeGVjdXRvcih0aGlzLCBtZXRhLCBzdWJzLCBfcGFyc2Vy\nLAogICAgICAgICAgICBjdHguZ2V0Q29tcGlsYXRpb24oKSk7CiAgICB9Cgog\nICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNZXRob2RzIGZv\nciBPdmVycmlkZQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\nLyoqCiAgICAgKiBFeGVjdXRlIHRoZSBnaXZlbiBleHByZXNzaW9uIGFnYWlu\nc3QgdGhlIGdpdmVuIGNhbmRpZGF0ZSBleHRlbnQuCiAgICAgKgogICAgICog\nQHBhcmFtIGV4IGN1cnJlbnQgZXhlY3V0b3IKICAgICAqIEBwYXJhbSBiYXNl\nIHRoZSBiYXNlIHR5cGUgdGhlIHF1ZXJ5IHNob3VsZCBtYXRjaAogICAgICog\nQHBhcmFtIHR5cGVzIHRoZSBpbmRlcGVuZGVudCBjYW5kaWRhdGUgdHlwZXMK\nICAgICAqIEBwYXJhbSBzdWJjbGFzc2VzIHRydWUgaWYgc3ViY2xhc3NlcyBz\naG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdHMKICAgICAqIEBwYXJh\nbSBmYWN0cyB0aGUgZXhwcmVzc2lvbiBmYWN0b3J5IHVzZWQgdG8gYnVpbGQg\ndGhlIHF1ZXJ5IGZvcgogICAgICogZWFjaCBiYXNlIHR5cGUKICAgICAqIEBw\nYXJhbSBwYXJzZWQgdGhlIHBhcnNlZCBxdWVyeSB2YWx1ZXMKICAgICAqIEBw\nYXJhbSBwYXJhbXMgcGFyYW1ldGVyIHZhbHVlcywgb3IgZW1wdHkgYXJyYXkK\nICAgICAqIEBwYXJhbSByYW5nZSByZXN1bHQgcmFuZ2UKICAgICAqIEByZXR1\ncm4gYSBwcm92aWRlciBmb3IgbWF0Y2hpbmcgb2JqZWN0cwogICAgICovCiAg\nICBwcm90ZWN0ZWQgUmVzdWx0T2JqZWN0UHJvdmlkZXIgZXhlY3V0ZVF1ZXJ5\nKEV4ZWN1dG9yIGV4LAogICAgICAgIENsYXNzTWV0YURhdGEgYmFzZSwgQ2xh\nc3NNZXRhRGF0YVtdIHR5cGVzLCBib29sZWFuIHN1YmNsYXNzZXMsCiAgICAg\nICAgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywgUXVlcnlFeHByZXNzaW9u\nc1tdIHBhcnNlZCwgT2JqZWN0W10gcGFyYW1zLAogICAgICAgIFJhbmdlIHJh\nbmdlKSB7CiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9u\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBFeGVjdXRlIHRoZSBnaXZlbiBl\neHByZXNzaW9uIGFnYWluc3QgdGhlIGdpdmVuIGNhbmRpZGF0ZSBleHRlbnQK\nICAgICAqIGFuZCBkZWxldGUgdGhlIGluc3RhbmNlcy4KICAgICAqCiAgICAg\nKiBAcGFyYW0gZXggY3VycmVudCBleGVjdXRvcgogICAgICogQHBhcmFtIGJh\nc2UgdGhlIGJhc2UgdHlwZSB0aGUgcXVlcnkgc2hvdWxkIG1hdGNoCiAgICAg\nKiBAcGFyYW0gdHlwZXMgdGhlIGluZGVwZW5kZW50IGNhbmRpZGF0ZSB0eXBl\ncwogICAgICogQHBhcmFtIHN1YmNsYXNzZXMgdHJ1ZSBpZiBzdWJjbGFzc2Vz\nIHNob3VsZCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0cwogICAgICogQHBh\ncmFtIGZhY3RzIHRoZSBleHByZXNzaW9uIGZhY3RvcnkgdXNlZCB0byBidWls\nZCB0aGUgcXVlcnkgZm9yCiAgICAgKiBlYWNoIGJhc2UgdHlwZQogICAgICog\nQHBhcmFtIHBhcnNlZCB0aGUgcGFyc2VkIHF1ZXJ5IHZhbHVlcwogICAgICog\nQHBhcmFtIHBhcmFtcyBwYXJhbWV0ZXIgdmFsdWVzLCBvciBlbXB0eSBhcnJh\neQogICAgICogQHJldHVybiBhIG51bWJlciBpbmRpY2F0aW5nIHRoZSBudW1i\nZXIgb2YgaW5zdGFuY2VzIGRlbGV0ZWQsCiAgICAgKiBvciBudWxsIHRvIGV4\nZWN1dGUgdGhlIGRlbGV0ZSBpbiBtZW1vcnkKICAgICAqLwogICAgcHJvdGVj\ndGVkIE51bWJlciBleGVjdXRlRGVsZXRlKEV4ZWN1dG9yIGV4LCBDbGFzc01l\ndGFEYXRhIGJhc2UsCiAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIHR5cGVzLCBi\nb29sZWFuIHN1YmNsYXNzZXMsIEV4cHJlc3Npb25GYWN0b3J5W10gZmFjdHMs\nCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1tdIHBhcnNlZCwgT2JqZWN0W10g\ncGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBFeGVjdXRlIHRoZSBnaXZlbiBleHByZXNzaW9uIGFnYWluc3Qg\ndGhlIGdpdmVuIGNhbmRpZGF0ZSBleHRlbnQKICAgICAqIGFuZCB1cGRhdGVz\nIHRoZSBpbnN0YW5jZXMuCiAgICAgKgogICAgICogQHBhcmFtIGV4IGN1cnJl\nbnQgZXhlY3V0b3IKICAgICAqIEBwYXJhbSBiYXNlIHRoZSBiYXNlIHR5cGUg\ndGhlIHF1ZXJ5IHNob3VsZCBtYXRjaAogICAgICogQHBhcmFtIHR5cGVzIHRo\nZSBpbmRlcGVuZGVudCBjYW5kaWRhdGUgdHlwZXMKICAgICAqIEBwYXJhbSBz\ndWJjbGFzc2VzIHRydWUgaWYgc3ViY2xhc3NlcyBzaG91bGQgYmUgaW5jbHVk\nZWQgaW4gdGhlIHJlc3VsdHMKICAgICAqIEBwYXJhbSBmYWN0cyB0aGUgZXhw\ncmVzc2lvbiBmYWN0b3J5IHVzZWQgdG8gYnVpbGQgdGhlIHF1ZXJ5IGZvcgog\nICAgICogZWFjaCBiYXNlIHR5cGUKICAgICAqIEBwYXJhbSBwYXJzZWQgdGhl\nIHBhcnNlZCBxdWVyeSB2YWx1ZXMKICAgICAqIEBwYXJhbSBwYXJhbXMgcGFy\nYW1ldGVyIHZhbHVlcywgb3IgZW1wdHkgYXJyYXkKICAgICAqIEByZXR1cm4g\nYSBudW1iZXIgaW5kaWNhdGluZyB0aGUgbnVtYmVyIG9mIGluc3RhbmNlcyB1\ncGRhdGVkLAogICAgICogb3IgbnVsbCB0byBleGVjdXRlIHRoZSB1cGRhdGUg\naW4gbWVtb3J5LgogICAgICovCiAgICBwcm90ZWN0ZWQgTnVtYmVyIGV4ZWN1\ndGVVcGRhdGUoRXhlY3V0b3IgZXgsIENsYXNzTWV0YURhdGEgYmFzZSwKICAg\nICAgICBDbGFzc01ldGFEYXRhW10gdHlwZXMsIGJvb2xlYW4gc3ViY2xhc3Nl\ncywgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4\ncHJlc3Npb25zW10gcGFyc2VkLCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgY29tbWFuZHMgdGhhdCB3aWxsIGJlIHNlbnQgdG8gdGhlIGRhdGFzdG9y\nZSBpbiBvcmRlcgogICAgICogdG8gZXhlY3V0ZSB0aGUgcXVlcnksIHR5cGlj\nYWxseSBpbiB0aGUgZGF0YWJhc2UncyBuYXRpdmUgbGFuZ3VhZ2UuCiAgICAg\nKgogICAgICogQHBhcmFtIGV4IGN1cnJlbnQgZXhlY3V0b3IKICAgICAqIEBw\nYXJhbSBiYXNlIHRoZSBiYXNlIHR5cGUgdGhlIHF1ZXJ5IHNob3VsZCBtYXRj\naAogICAgICogQHBhcmFtIHR5cGVzIHRoZSBpbmRlcGVuZGVudCBjYW5kaWRh\ndGUgdHlwZXMKICAgICAqIEBwYXJhbSBzdWJjbGFzc2VzIHRydWUgaWYgc3Vi\nY2xhc3NlcyBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdHMKICAg\nICAqIEBwYXJhbSBmYWN0cyB0aGUgZXhwcmVzc2lvbiBmYWN0b3J5IHVzZWQg\ndG8gYnVpbGQgdGhlIHF1ZXJ5IGZvcgogICAgICogZWFjaCBiYXNlIHR5cGUK\nICAgICAqIEBwYXJhbSBwYXJzZWQgdGhlIHBhcnNlZCBxdWVyeSB2YWx1ZXMK\nICAgICAqIEBwYXJhbSBwYXJhbXMgcGFyYW1ldGVyIHZhbHVlcywgb3IgZW1w\ndHkgYXJyYXkKICAgICAqIEBwYXJhbSByYW5nZSByZXN1bHQgcmFuZ2UKICAg\nICAqIEByZXR1cm4gYSB0ZXh0dWFsIGRlc2NyaXB0aW9uIG9mIHRoZSBxdWVy\neSB0byBleGVjdXRlCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmdbXSBn\nZXREYXRhU3RvcmVBY3Rpb25zKEV4ZWN1dG9yIGV4LCBDbGFzc01ldGFEYXRh\nIGJhc2UsCiAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIHR5cGVzLCBib29sZWFu\nIHN1YmNsYXNzZXMsIEV4cHJlc3Npb25GYWN0b3J5W10gZmFjdHMsCiAgICAg\nICAgUXVlcnlFeHByZXNzaW9uc1tdIHBhcnNlZCwgT2JqZWN0W10gcGFyYW1z\nLCBSYW5nZSByYW5nZSkgewogICAgICAgIHJldHVybiBTdG9yZVF1ZXJ5LkVN\nUFRZX1NUUklOR1M7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGFzc2lnbmFibGUgdHlwZXMgZm9yIHRoZSBnaXZlbiBtZXRhZGF0YSB3aG9z\nZSBleHByZXNzaW9uCiAgICAgKiB0cmVlcyBtdXN0IGJlIGNvbXBpbGVkIGlu\nZGVwZW5kZW50bHkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBDbGFzc01ldGFE\nYXRhW10gZ2V0SW5kZXBlbmRlbnRFeHByZXNzaW9uQ2FuZGlkYXRlcwogICAg\nICAgIChDbGFzc01ldGFEYXRhIHR5cGUsIGJvb2xlYW4gc3ViY2xhc3Nlcykg\newogICAgICAgIHJldHVybiBuZXcgQ2xhc3NNZXRhRGF0YVtdeyB0eXBlIH07\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4ge0BsaW5rIEV4cHJl\nc3Npb25GYWN0b3J5fSB0byB1c2UgdG8gY3JlYXRlIGFuIGV4cHJlc3Npb24g\ndG8KICAgICAqIGJlIGV4ZWN1dGVkIGFnYWluc3QgYW4gZXh0ZW50LiBFYWNo\nIGZhY3Rvcnkgd2lsbCBiZSB1c2VkIHRvIGNvbXBpbGUKICAgICAqIG9uZSBm\naWx0ZXIgb25seS4gVGhlIGZhY3RvcnkgbXVzdCBiZSBjYWNoYWJsZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIEV4cHJlc3Npb25GYWN0b3J5IGdldEV4cHJl\nc3Npb25GYWN0b3J5KENsYXNzTWV0YURhdGEgdHlwZSkgewogICAgICAgIHRo\ncm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigpOwogICAgfQoKICAgIC8q\nKgogICAgICogUHJvdmlkZXMgc3VwcG9ydCBmb3IgcXVlcmllcyB0aGF0IGhv\nbGQgcXVlcnkgaW5mb3JtYXRpb24KICAgICAqIGluIGEge0BsaW5rIFF1ZXJ5\nRXhwcmVzc2lvbnN9IGluc3RhbmNlLgogICAgICoKICAgICAqIEBhdXRob3Ig\nTWFyYyBQcnVkJ2hvbW1lYXV4CiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIGFic3RyYWN0IGNsYXNzIEFic3RyYWN0RXhwcmVzc2lvbkV4ZWN1dG9yCiAg\nICAgICAgZXh0ZW5kcyBBYnN0cmFjdEV4ZWN1dG9yCiAgICAgICAgaW1wbGVt\nZW50cyBFeGVjdXRvciB7CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVy\nbiB0aGUgcGFyc2VkIHF1ZXJ5IGV4cHJlc3Npb25zIGZvciBvdXIgY2FuZGlk\nYXRlIHR5cGVzLgogICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCBhYnN0\ncmFjdCBRdWVyeUV4cHJlc3Npb25zW10gZ2V0UXVlcnlFeHByZXNzaW9ucygp\nOwoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gdGhlIHF1ZXJ5IGV4\ncHJlc3Npb25zIGZvciBvbmUgY2FuZGlkYXRlIHR5cGUsIG9yIGRpZSBpZiBu\nb25lLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgUXVlcnlFeHByZXNz\naW9ucyBhc3NlcnRRdWVyeUV4cHJlc3Npb24oKSB7CiAgICAgICAgICAgIFF1\nZXJ5RXhwcmVzc2lvbnNbXSBleHAgPSBnZXRRdWVyeUV4cHJlc3Npb25zKCk7\nCiAgICAgICAgICAgIGlmIChleHAgPT0gbnVsbCB8fCBleHAubGVuZ3RoIDwg\nMSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vLWV4cHJlc3Npb25zIikpOwoKICAgICAgICAg\nICAgcmV0dXJuIGV4cFswXTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAg\nICAgICAqIFRocm93IHByb3BlciBleGNlcHRpb24gaWYgZ2l2ZW4gdmFsdWUg\naXMgYSBjb2xsZWN0aW9uL21hcC9hcnJheS4KICAgICAgICAgKi8KICAgICAg\nICBwcm90ZWN0ZWQgdm9pZCBhc3NlcnROb3RDb250YWluZXIoVmFsdWUgdmFs\nLCBTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgLy8gdmFyaWFibGVzIHJl\ncHJlc2VudCBjb250YWluZXIgZWxlbWVudHMsIG5vdCB0aGUgY29udGFpbmVy\nIGl0c2VsZgogICAgICAgICAgICBpZiAodmFsLmlzVmFyaWFibGUoKSkKICAg\nICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIENsYXNzIHR5cGU7\nCiAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBQYXRoKSB7CiAgICAg\nICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9ICgoUGF0aCkgdmFsKS5s\nYXN0KCk7CiAgICAgICAgICAgICAgICB0eXBlID0gKGZtZCA9PSBudWxsKSA/\nIHZhbC5nZXRUeXBlKCkgOiBmbWQuZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICAg\nICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgdHlwZSA9IHZhbC5nZXRU\neXBlKCk7CgogICAgICAgICAgICBzd2l0Y2ggKEphdmFUeXBlcy5nZXRUeXBl\nQ29kZSh0eXBlKSkgewogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQVJSQVk6CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNU\nSU9OOgogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAg\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJjb250YWluZXItcHJvamVjdGlvbiIsCiAgICAgICAgICAgICAgICAg\nICAgICAgIHEuZ2V0Q29udGV4dCgpLmdldFF1ZXJ5U3RyaW5nKCkpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZpbmFsIHZv\naWQgdmFsaWRhdGUoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIFF1ZXJ5\nRXhwcmVzc2lvbnMgZXhwcyA9IGFzc2VydFF1ZXJ5RXhwcmVzc2lvbigpOyAg\nICAKICAgICAgICAgICAgVmFsaWRhdGVHcm91cGluZ0V4cHJlc3Npb25WaXNp\ndG9yLnZhbGlkYXRlKHEuZ2V0Q29udGV4dCgpLCBleHBzKTsgCiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCBnZXRSYW5nZShTdG9yZVF1ZXJ5IHEs\nIE9iamVjdFtdIHBhcmFtcywgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAgICAg\nUXVlcnlFeHByZXNzaW9ucyBleHBzID0gYXNzZXJ0UXVlcnlFeHByZXNzaW9u\nKCk7CiAgICAgICAgICAgIGlmIChleHBzLnJhbmdlLmxlbmd0aCA9PSAwKQog\nICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAgaWYgKGV4cHMu\ncmFuZ2UubGVuZ3RoID09IDIgCiAgICAgICAgICAgICAgICAmJiBleHBzLnJh\nbmdlWzBdIGluc3RhbmNlb2YgQ29uc3RhbnQKICAgICAgICAgICAgICAgICYm\nIGV4cHMucmFuZ2VbMV0gaW5zdGFuY2VvZiBDb25zdGFudCkgewogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByYW5nZS5zdGFy\ndCA9ICgoTnVtYmVyKSAoKENvbnN0YW50KSBleHBzLnJhbmdlWzBdKS4KICAg\nICAgICAgICAgICAgICAgICAgICAgZ2V0VmFsdWUocGFyYW1zKSkubG9uZ1Zh\nbHVlKCk7CiAgICAgICAgICAgICAgICAgICAgcmFuZ2UuZW5kID0gKChOdW1i\nZXIpICgoQ29uc3RhbnQpIGV4cHMucmFuZ2VbMV0pLgogICAgICAgICAgICAg\nICAgICAgICAgICBnZXRWYWx1ZShwYXJhbXMpKS5sb25nVmFsdWUoKTsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChDbGFzc0Nhc3RFeGNlcHRpb24gY2NlKSB7CiAgICAgICAgICAgICAg\nICAgICAgLy8gZmFsbCB0aHJvdWdoIHRvIGV4Y2VwdGlvbiBiZWxvdwogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoTnVsbFBvaW50ZXJFeGNlcHRpb24gbnBl\nKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gZmFsbCB0aHJvdWdoIHRvIGV4\nY2VwdGlvbiBiZWxvdwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJvbmx5LXJhbmdlLWNvbnN0YW50cyIsCiAgICAgICAgICAgICAgICBxLmdl\ndENvbnRleHQoKS5nZXRRdWVyeVN0cmluZygpKSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgZmluYWwgQ2xhc3MgZ2V0UmVzdWx0Q2xhc3MoU3RvcmVR\ndWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NlcnRRdWVyeUV4cHJl\nc3Npb24oKS5yZXN1bHRDbGFzczsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBmaW5hbCBib29sZWFuW10gZ2V0QXNjZW5kaW5nKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICByZXR1cm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCku\nYXNjZW5kaW5nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZpbmFsIFN0\ncmluZyBnZXRBbGlhcyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0\ndXJuIGFzc2VydFF1ZXJ5RXhwcmVzc2lvbigpLmFsaWFzOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIGZpbmFsIFN0cmluZ1tdIGdldFByb2plY3Rpb25B\nbGlhc2VzKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4gYXNz\nZXJ0UXVlcnlFeHByZXNzaW9uKCkucHJvamVjdGlvbkFsaWFzZXM7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgZmluYWwgaW50IGdldE9wZXJhdGlvbihT\ndG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGFzc2VydFF1ZXJ5\nRXhwcmVzc2lvbigpLm9wZXJhdGlvbjsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBmaW5hbCBib29sZWFuIGlzQWdncmVnYXRlKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICByZXR1cm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCku\naXNBZ2dyZWdhdGUoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5h\nbCBib29sZWFuIGhhc0dyb3VwaW5nKFN0b3JlUXVlcnkgcSkgewogICAgICAg\nICAgICByZXR1cm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCkuZ3JvdXBpbmcu\nbGVuZ3RoID4gMDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5hbCBM\naW5rZWRNYXAgZ2V0UGFyYW1ldGVyVHlwZXMoU3RvcmVRdWVyeSBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBhc3NlcnRRdWVyeUV4cHJlc3Npb24oKS5wYXJh\nbWV0ZXJUeXBlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5hbCBN\nYXAgZ2V0VXBkYXRlcyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0\ndXJuIGFzc2VydFF1ZXJ5RXhwcmVzc2lvbigpLnVwZGF0ZXM7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgZmluYWwgQ2xhc3NNZXRhRGF0YVtdIGdldEFj\nY2Vzc1BhdGhNZXRhRGF0YXMoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAg\nIFF1ZXJ5RXhwcmVzc2lvbnNbXSBleHBzID0gZ2V0UXVlcnlFeHByZXNzaW9u\ncygpOwogICAgICAgICAgICBpZiAoZXhwcy5sZW5ndGggPT0gMSkKICAgICAg\nICAgICAgICAgIHJldHVybiBleHBzWzBdLmFjY2Vzc1BhdGg7CgogICAgICAg\nICAgICBMaXN0IG1ldGFzID0gbnVsbDsKICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBleHBzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAg\nbWV0YXMgPSBGaWx0ZXJzLmFkZEFjY2Vzc1BhdGhNZXRhRGF0YXMobWV0YXMs\nCiAgICAgICAgICAgICAgICAgICAgZXhwc1tpXS5hY2Nlc3NQYXRoKTsKICAg\nICAgICAgICAgaWYgKG1ldGFzID09IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gU3RvcmVRdWVyeS5FTVBUWV9NRVRBUzsKICAgICAgICAgICAgcmV0\ndXJuIChDbGFzc01ldGFEYXRhW10pIG1ldGFzLnRvQXJyYXkKICAgICAgICAg\nICAgICAgIChuZXcgQ2xhc3NNZXRhRGF0YVttZXRhcy5zaXplKCldKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGlzUGFja2luZyhTdG9y\nZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogVGhyb3dzIGFuIGV4Y2VwdGlv\nbiBpZiBzZWxlY3Qgb3IgaGF2aW5nIGNsYXVzZXMgY29udGFpbiAKICAgICAg\nICAgKiBub24tYWdncmVnYXRlLCBub24tZ3JvdXBlZCBwYXRocy4KICAgICAg\nICAgKi8KICAgICAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBWYWxpZGF0ZUdy\nb3VwaW5nRXhwcmVzc2lvblZpc2l0b3IgCiAgICAgICAgICAgIGV4dGVuZHMg\nQWJzdHJhY3RFeHByZXNzaW9uVmlzaXRvciB7CgogICAgICAgICAgICBwcml2\nYXRlIGZpbmFsIFF1ZXJ5Q29udGV4dCBfY3R4OwogICAgICAgICAgICBwcml2\nYXRlIGJvb2xlYW4gX2dyb3VwaW5nID0gZmFsc2U7CiAgICAgICAgICAgIHBy\naXZhdGUgU2V0IF9ncm91cGVkID0gbnVsbDsKICAgICAgICAgICAgcHJpdmF0\nZSBWYWx1ZSBfYWdnID0gbnVsbDsKCiAgICAgICAgICAgIC8qKgogICAgICAg\nICAgICAgKiBUaHJvdyBwcm9wZXIgZXhjZXB0aW9uIGlmIHF1ZXJ5IGRvZXMg\nbm90IG1lZXQgdmFsaWRhdGlvbi4KICAgICAgICAgICAgICovCiAgICAgICAg\nICAgIHB1YmxpYyBzdGF0aWMgdm9pZCB2YWxpZGF0ZShRdWVyeUNvbnRleHQg\nY3R4LCAKICAgICAgICAgICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcykg\newogICAgICAgICAgICAgICAgaWYgKGV4cHMuZ3JvdXBpbmcubGVuZ3RoID09\nIDApCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAg\nICAgIFZhbGlkYXRlR3JvdXBpbmdFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9y\nID0gCiAgICAgICAgICAgICAgICAgICAgbmV3IFZhbGlkYXRlR3JvdXBpbmdF\neHByZXNzaW9uVmlzaXRvcihjdHgpOwogICAgICAgICAgICAgICAgdmlzaXRv\nci5fZ3JvdXBpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBleHBzLmdyb3VwaW5nLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgICAgIGV4cHMuZ3JvdXBpbmdbaV0uYWNjZXB0VmlzaXQodmlz\naXRvcik7CiAgICAgICAgICAgICAgICB2aXNpdG9yLl9ncm91cGluZyA9IGZh\nbHNlOwogICAgICAgICAgICAgICAgaWYgKGV4cHMuaGF2aW5nICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgZXhwcy5oYXZpbmcuYWNjZXB0VmlzaXQo\ndmlzaXRvcik7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGV4cHMucHJvamVjdGlvbnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICAgICAgZXhwcy5wcm9qZWN0aW9uc1tpXS5hY2NlcHRWaXNpdCh2aXNpdG9y\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFZhbGlkYXRl\nR3JvdXBpbmdFeHByZXNzaW9uVmlzaXRvcihRdWVyeUNvbnRleHQgY3R4KSB7\nCiAgICAgICAgICAgICAgICBfY3R4ID0gY3R4OwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBlbnRlcihWYWx1ZSB2YWwpIHsKICAg\nICAgICAgICAgICAgIGlmIChfZ3JvdXBpbmcpIHsKICAgICAgICAgICAgICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgUGF0aCkgewogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoX2dyb3VwZWQgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIF9ncm91cGVkID0gbmV3IEhhc2hTZXQoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgX2dyb3VwZWQuYWRkKHZhbCk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChf\nYWdnID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodmFsLmlz\nQWdncmVnYXRlKCkpIAogICAgICAgICAgICAgICAgICAgICAgICBfYWdnID0g\ndmFsOwogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5j\nZW9mIFBhdGggCiAgICAgICAgICAgICAgICAgICAgICAgICYmIChfZ3JvdXBl\nZCA9PSBudWxsIHx8ICFfZ3JvdXBlZC5jb250YWlucyh2YWwpKSkgewogICAg\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihf\nbG9jLmdldCgiYmFkLWdyb3VwaW5nIiwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIF9jdHguZ2V0Q2FuZGlkYXRlVHlwZSgpLCBfY3R4LmdldFF1ZXJ5\nU3RyaW5nKCkpKTsgCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBleGl0KFZhbHVlIHZhbCkgewogICAgICAgICAgICAgICAgaWYgKHZhbCA9\nPSBfYWdnKQogICAgICAgICAgICAgICAgICAgIF9hZ2cgPSBudWxsOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUnVu\ncyB0aGUgZXhwcmVzc2lvbiBxdWVyeSBpbiBtZW1vcnkuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGNsYXNzIEluTWVtb3J5RXhlY3V0b3IKICAgICAg\nICBleHRlbmRzIEFic3RyYWN0RXhwcmVzc2lvbkV4ZWN1dG9yCiAgICAgICAg\naW1wbGVtZW50cyBFeGVjdXRvciB7CgogICAgICAgIHByaXZhdGUgZmluYWwg\nQ2xhc3NNZXRhRGF0YSBfbWV0YTsKICAgICAgICBwcml2YXRlIGZpbmFsIGJv\nb2xlYW4gX3N1YnM7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBJbk1lbW9yeUV4\ncHJlc3Npb25GYWN0b3J5IF9mYWN0b3J5OwogICAgICAgIHByaXZhdGUgZmlu\nYWwgUXVlcnlFeHByZXNzaW9uc1tdIF9leHBzOwogICAgICAgIHByaXZhdGUg\nZmluYWwgQ2xhc3NbXSBfcHJvalR5cGVzOwoKICAgICAgICBwdWJsaWMgSW5N\nZW1vcnlFeGVjdXRvcihFeHByZXNzaW9uU3RvcmVRdWVyeSBxLAogICAgICAg\nICAgICBDbGFzc01ldGFEYXRhIGNhbmRpZGF0ZSwgYm9vbGVhbiBzdWJjbGFz\nc2VzLAogICAgICAgICAgICBFeHByZXNzaW9uUGFyc2VyIHBhcnNlciwgT2Jq\nZWN0IHBhcnNlZCkgewogICAgICAgICAgICBfbWV0YSA9IGNhbmRpZGF0ZTsK\nICAgICAgICAgICAgX3N1YnMgPSBzdWJjbGFzc2VzOwogICAgICAgICAgICBf\nZmFjdG9yeSA9IG5ldyBJbk1lbW9yeUV4cHJlc3Npb25GYWN0b3J5KCk7Cgog\nICAgICAgICAgICBfZXhwcyA9IG5ldyBRdWVyeUV4cHJlc3Npb25zW10gewog\nICAgICAgICAgICAgICAgcGFyc2VyLmV2YWwocGFyc2VkLCBxLCBfZmFjdG9y\neSwgX21ldGEpCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmIChfZXhw\nc1swXS5wcm9qZWN0aW9ucy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAg\nIF9wcm9qVHlwZXMgPSBTdG9yZVF1ZXJ5LkVNUFRZX0NMQVNTRVM7CiAgICAg\nICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgQXNzZXJ0Tm9WYXJpYWJs\nZXNFeHByZXNzaW9uVmlzaXRvciBub3ZhcnMgPSBuZXcKICAgICAgICAgICAg\nICAgICAgICBBc3NlcnROb1ZhcmlhYmxlc0V4cHJlc3Npb25WaXNpdG9yKHEu\nZ2V0Q29udGV4dCgpKTsKICAgICAgICAgICAgICAgIF9wcm9qVHlwZXMgPSBu\nZXcgQ2xhc3NbX2V4cHNbMF0ucHJvamVjdGlvbnMubGVuZ3RoXTsKICAgICAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2V4cHNbMF0ucHJvamVj\ndGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBfcHJv\nalR5cGVzW2ldID0gX2V4cHNbMF0ucHJvamVjdGlvbnNbaV0uZ2V0VHlwZSgp\nOwogICAgICAgICAgICAgICAgICAgIGFzc2VydE5vdENvbnRhaW5lcihfZXhw\nc1swXS5wcm9qZWN0aW9uc1tpXSwgcSk7CiAgICAgICAgICAgICAgICAgICAg\nX2V4cHNbMF0ucHJvamVjdGlvbnNbaV0uYWNjZXB0VmlzaXQobm92YXJzKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgX2V4cHNbMF0uZ3JvdXBpbmcubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICAgICAgX2V4cHNbMF0uZ3JvdXBpbmdbaV0uYWNjZXB0Vmlz\naXQobm92YXJzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\ncHJvdGVjdGVkIFF1ZXJ5RXhwcmVzc2lvbnNbXSBnZXRRdWVyeUV4cHJlc3Np\nb25zKCkgewogICAgICAgICAgICByZXR1cm4gX2V4cHM7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgUmVzdWx0T2JqZWN0UHJvdmlkZXIgZXhlY3V0ZVF1\nZXJ5KFN0b3JlUXVlcnkgcSwKICAgICAgICAgICAgT2JqZWN0W10gcGFyYW1z\nLCBSYW5nZSByYW5nZSkgewogICAgICAgICAgICAvLyBleGVjdXRlIGluIG1l\nbW9yeSBmb3IgY2FuZGlkYXRlIGNvbGxlY3Rpb247CiAgICAgICAgICAgIC8v\nIGFsc28gZXhlY3V0ZSBpbiBtZW1vcnkgZm9yIHRyYW5zYWN0aW9uYWwgZXh0\nZW50cwogICAgICAgICAgICBDb2xsZWN0aW9uIGNvbGwgPSBxLmdldENvbnRl\neHQoKS5nZXRDYW5kaWRhdGVDb2xsZWN0aW9uKCk7CiAgICAgICAgICAgIEl0\nZXJhdG9yIGl0cjsKICAgICAgICAgICAgaWYgKGNvbGwgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGl0ciA9IGNvbGwuaXRlcmF0b3IoKTsKICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgaXRyID0gcS5nZXRDb250ZXh0KCku\nZ2V0U3RvcmVDb250ZXh0KCkuCiAgICAgICAgICAgICAgICAgICAgZXh0ZW50\nSXRlcmF0b3IoX21ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLCBfc3VicywKICAg\nICAgICAgICAgICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0RmV0Y2hD\nb25maWd1cmF0aW9uKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHEuZ2V0\nQ29udGV4dCgpLmdldElnbm9yZUNoYW5nZXMoKSk7CgogICAgICAgICAgICAv\nLyBmaW5kIG1hdGNoaW5nIG9iamVjdHMKICAgICAgICAgICAgTGlzdCByZXN1\nbHRzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICBTdG9yZUNvbnRl\neHQgY3R4ID0gcS5nZXRDb250ZXh0KCkuZ2V0U3RvcmVDb250ZXh0KCk7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBPYmplY3Qgb2JqOwog\nICAgICAgICAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsKICAgICAg\nICAgICAgICAgICAgICBvYmogPSBpdHIubmV4dCgpOwogICAgICAgICAgICAg\nICAgICAgIGlmIChfZmFjdG9yeS5tYXRjaGVzKF9leHBzWzBdLCBfbWV0YSwg\nX3N1YnMsIG9iaiwgY3R4LAogICAgICAgICAgICAgICAgICAgICAgICBwYXJh\nbXMpKQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLmFkZChvYmop\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGZpbmFsbHkgewogICAgICAgICAgICAgICAgSW1wbEhlbHBlci5jbG9zZShp\ndHIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBncm91cCByZXN1\nbHRzCiAgICAgICAgICAgIHJlc3VsdHMgPSBfZmFjdG9yeS5ncm91cChfZXhw\nc1swXSwgcmVzdWx0cywgY3R4LCBwYXJhbXMpOwoKICAgICAgICAgICAgLy8g\nYXBwbHkgaGF2aW5nIHRvIGZpbHRlciBncm91cHMKICAgICAgICAgICAgaWYg\nKF9leHBzWzBdLmhhdmluZyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBM\naXN0IG1hdGNoZXMgPSBuZXcgQXJyYXlMaXN0KHJlc3VsdHMuc2l6ZSgpKTsK\nICAgICAgICAgICAgICAgIENvbGxlY3Rpb24gYzsKICAgICAgICAgICAgICAg\nIGl0ciA9IHJlc3VsdHMuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIHdo\naWxlIChpdHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAgICAgICAgYyA9\nIChDb2xsZWN0aW9uKSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgICAg\nIGlmIChfZmFjdG9yeS5tYXRjaGVzKF9leHBzWzBdLCBjLCBjdHgsIHBhcmFt\ncykpCiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuYWRkKGMpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVzdWx0cyA9IG1h\ndGNoZXM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGFwcGx5IHBy\nb2plY3Rpb25zLCBvcmRlciByZXN1bHRzLCBhbmQgZmlsdGVyIGR1cGxpY2F0\nZXMKICAgICAgICAgICAgcmVzdWx0cyA9IF9mYWN0b3J5LnByb2plY3QoX2V4\ncHNbMF0sIHJlc3VsdHMsIGN0eCwgcGFyYW1zKTsKICAgICAgICAgICAgcmVz\ndWx0cyA9IF9mYWN0b3J5Lm9yZGVyKF9leHBzWzBdLCByZXN1bHRzLCBjdHgs\nIHBhcmFtcyk7CiAgICAgICAgICAgIHJlc3VsdHMgPSBfZmFjdG9yeS5kaXN0\naW5jdChfZXhwc1swXSwgY29sbCA9PSBudWxsLCByZXN1bHRzKTsKCiAgICAg\nICAgICAgIFJlc3VsdE9iamVjdFByb3ZpZGVyIHJvcCA9IG5ldyBMaXN0UmVz\ndWx0T2JqZWN0UHJvdmlkZXIocmVzdWx0cyk7CiAgICAgICAgICAgIGlmIChy\nYW5nZS5zdGFydCAhPSAwIHx8IHJhbmdlLmVuZCAhPSBMb25nLk1BWF9WQUxV\nRSkKICAgICAgICAgICAgICAgIHJvcCA9IG5ldyBSYW5nZVJlc3VsdE9iamVj\ndFByb3ZpZGVyKHJvcCwgcmFuZ2Uuc3RhcnQscmFuZ2UuZW5kKTsKICAgICAg\nICAgICAgcmV0dXJuIHJvcDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBT\ndHJpbmdbXSBnZXREYXRhU3RvcmVBY3Rpb25zKFN0b3JlUXVlcnkgcSwgT2Jq\nZWN0W10gcGFyYW1zLAogICAgICAgICAgICBSYW5nZSByYW5nZSkgewogICAg\nICAgICAgICAvLyBpbiBtZW1vcnkgcXVlcmllcyBoYXZlIG5vIGRhdGFzdG9y\nZSBhY3Rpb25zIHRvIHBlcmZvcm0KICAgICAgICAgICAgcmV0dXJuIFN0b3Jl\nUXVlcnkuRU1QVFlfU1RSSU5HUzsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBPYmplY3QgZ2V0T3JkZXJpbmdWYWx1ZShTdG9yZVF1ZXJ5IHEsIE9iamVj\ndFtdIHBhcmFtcywKICAgICAgICAgICAgT2JqZWN0IHJlc3VsdE9iamVjdCwg\naW50IG9yZGVySW5kZXgpIHsKICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBh\nIHByb2plY3Rpb24sIHRoZW4gd2UgaGF2ZSB0byBvcmRlciBvbiBzb21ldGhp\nbmcKICAgICAgICAgICAgLy8gd2Ugc2VsZWN0ZWQKICAgICAgICAgICAgaWYg\nKF9leHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAg\nICAgICAgIFN0cmluZyBvcmRlcmluZyA9IF9leHBzWzBdLm9yZGVyaW5nQ2xh\ndXNlc1tvcmRlckluZGV4XTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgX2V4cHNbMF0ucHJvamVjdGlvbkNsYXVzZXMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgICAgICAgICAgaWYgKG9yZGVyaW5nLmVxdWFscyhf\nZXhwc1swXS5wcm9qZWN0aW9uQ2xhdXNlc1tpXSkpCiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybiAoKE9iamVjdFtdKSByZXN1bHRPYmplY3QpW2ld\nOwoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNl\ncHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICAgICAoIm1lcmdlZC1v\ncmRlci13aXRoLXJlc3VsdCIsIHEuZ2V0Q29udGV4dCgpLmdldExhbmd1YWdl\nKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHEuZ2V0Q29udGV4dCgpLmdl\ndFF1ZXJ5U3RyaW5nKCksIG9yZGVyaW5nKSk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIC8vIHVzZSB0aGUgcGFyc2VkIG9yZGVyaW5nIGV4cHJlc3Np\nb24gdG8gZXh0cmFjdCB0aGUgb3JkZXJpbmcgdmFsdWUKICAgICAgICAgICAg\nVmFsIHZhbCA9IChWYWwpIF9leHBzWzBdLm9yZGVyaW5nW29yZGVySW5kZXhd\nOwogICAgICAgICAgICByZXR1cm4gdmFsLmV2YWx1YXRlKHJlc3VsdE9iamVj\ndCwgcmVzdWx0T2JqZWN0LCBxLmdldENvbnRleHQoKS4KICAgICAgICAgICAg\nICAgIGdldFN0b3JlQ29udGV4dCgpLCBwYXJhbXMpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIENsYXNzW10gZ2V0UHJvamVjdGlvblR5cGVzKFN0b3Jl\nUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4gX3Byb2pUeXBlczsKICAg\nICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFRocm93cyBhbiBleGNl\ncHRpb24gaWYgYSB2YXJpYWJsZSBpcyBmb3VuZC4KICAgICAgICAgKi8KICAg\nICAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBBc3NlcnROb1ZhcmlhYmxlc0V4\ncHJlc3Npb25WaXNpdG9yIAogICAgICAgICAgICBleHRlbmRzIEFic3RyYWN0\nRXhwcmVzc2lvblZpc2l0b3IgewoKICAgICAgICAgICAgcHJpdmF0ZSBmaW5h\nbCBRdWVyeUNvbnRleHQgX2N0eDsKCiAgICAgICAgICAgIHB1YmxpYyBBc3Nl\ncnROb1ZhcmlhYmxlc0V4cHJlc3Npb25WaXNpdG9yKFF1ZXJ5Q29udGV4dCBj\ndHgpIHsKICAgICAgICAgICAgICAgIF9jdHggPSBjdHg7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGVudGVyKFZhbHVlIHZhbCkg\newogICAgICAgICAgICAgICAgaWYgKCF2YWwuaXNWYXJpYWJsZSgpKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbihfbG9jLmdldCgiaW5tZW0tYWdn\nLXByb2otdmFyIiwgCiAgICAgICAgICAgICAgICAgICAgX2N0eC5nZXRDYW5k\naWRhdGVUeXBlKCksIF9jdHguZ2V0UXVlcnlTdHJpbmcoKSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGhlIERh\ndGFTdG9yZUV4ZWN1dG9yIGV4ZWN1dGVzIHRoZSBxdWVyeSBhZ2FpbnN0IHRo\nZQogICAgICogaW1wbGVtZW50YXRpb24ncyBvdmVycmlkZGVuIHtAbGluayAj\nZXhlY3V0ZVF1ZXJ5fSBtZXRob2QuCiAgICAgKgogICAgICogQGF1dGhvciBN\nYXJjIFBydWQnaG9tbWVhdXgKICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nY2xhc3MgRGF0YVN0b3JlRXhlY3V0b3IKICAgICAgICBleHRlbmRzIEFic3Ry\nYWN0RXhwcmVzc2lvbkV4ZWN1dG9yCiAgICAgICAgaW1wbGVtZW50cyBFeGVj\ndXRvciB7CgogICAgICAgIHByaXZhdGUgZmluYWwgQ2xhc3NNZXRhRGF0YSBf\nbWV0YTsKICAgICAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0YURhdGFbXSBf\nbWV0YXM7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9zdWJzOwog\nICAgICAgIHByaXZhdGUgZmluYWwgRXhwcmVzc2lvblBhcnNlciBfcGFyc2Vy\nOwogICAgICAgIHByaXZhdGUgZmluYWwgRXhwcmVzc2lvbkZhY3RvcnlbXSBf\nZmFjdHM7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBRdWVyeUV4cHJlc3Npb25z\nW10gX2V4cHM7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDbGFzc1tdIF9wcm9q\nVHlwZXM7CiAgICAgICAgcHJpdmF0ZSBWYWx1ZVtdIF9pbk1lbU9yZGVyaW5n\nOwoKICAgICAgICBwdWJsaWMgRGF0YVN0b3JlRXhlY3V0b3IoRXhwcmVzc2lv\nblN0b3JlUXVlcnkgcSwKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRh\nLCBib29sZWFuIHN1YmNsYXNzZXMsCiAgICAgICAgICAgIEV4cHJlc3Npb25Q\nYXJzZXIgcGFyc2VyLCBPYmplY3QgcGFyc2VkKSB7CiAgICAgICAgICAgIF9t\nZXRhID0gbWV0YTsKICAgICAgICAgICAgX21ldGFzID0gcS5nZXRJbmRlcGVu\nZGVudEV4cHJlc3Npb25DYW5kaWRhdGVzKG1ldGEsIHN1YmNsYXNzZXMpOwog\nICAgICAgICAgICBfc3VicyA9IHN1YmNsYXNzZXM7CiAgICAgICAgICAgIF9w\nYXJzZXIgPSBwYXJzZXI7CgogICAgICAgICAgICBfZmFjdHMgPSBuZXcgRXhw\ncmVzc2lvbkZhY3RvcnlbX21ldGFzLmxlbmd0aF07CiAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX2ZhY3RzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgX2ZhY3RzW2ldID0gcS5nZXRFeHByZXNzaW9uRmFjdG9yeShf\nbWV0YXNbaV0pOwoKICAgICAgICAgICAgX2V4cHMgPSBuZXcgUXVlcnlFeHBy\nZXNzaW9uc1tfbWV0YXMubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZXhwcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAg\nIF9leHBzW2ldID0gcGFyc2VyLmV2YWwocGFyc2VkLCBxLCBfZmFjdHNbaV0s\nIF9tZXRhc1tpXSk7CgogICAgICAgICAgICBpZiAoX2V4cHNbMF0ucHJvamVj\ndGlvbnMubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICBfcHJvalR5cGVz\nID0gU3RvcmVRdWVyeS5FTVBUWV9DTEFTU0VTOwogICAgICAgICAgICBlbHNl\nIHsKICAgICAgICAgICAgICAgIF9wcm9qVHlwZXMgPSBuZXcgQ2xhc3NbX2V4\ncHNbMF0ucHJvamVjdGlvbnMubGVuZ3RoXTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX2V4cHNbMF0ucHJvamVjdGlvbnMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBhc3NlcnROb3RDb250YWlu\nZXIoX2V4cHNbMF0ucHJvamVjdGlvbnNbaV0sIHEpOwogICAgICAgICAgICAg\nICAgICAgIF9wcm9qVHlwZXNbaV0gPSBfZXhwc1swXS5wcm9qZWN0aW9uc1tp\nXS5nZXRUeXBlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBRdWVyeUV4cHJlc3Npb25z\nW10gZ2V0UXVlcnlFeHByZXNzaW9ucygpIHsKICAgICAgICAgICAgcmV0dXJu\nIF9leHBzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJlc3VsdE9iamVj\ndFByb3ZpZGVyIGV4ZWN1dGVRdWVyeShTdG9yZVF1ZXJ5IHEsCiAgICAgICAg\nICAgIE9iamVjdFtdIHBhcmFtcywgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAg\nICAgcmFuZ2UubHJzICY9ICFpc0FnZ3JlZ2F0ZShxKSAmJiAhaGFzR3JvdXBp\nbmcocSk7CiAgICAgICAgICAgIHJldHVybiAoKEV4cHJlc3Npb25TdG9yZVF1\nZXJ5KSBxKS5leGVjdXRlUXVlcnkodGhpcywgX21ldGEsIF9tZXRhcywKICAg\nICAgICAgICAgICAgIF9zdWJzLCBfZmFjdHMsIF9leHBzLCBwYXJhbXMsIHJh\nbmdlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBOdW1iZXIgZXhlY3V0\nZURlbGV0ZShTdG9yZVF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcykgewogICAg\nICAgICAgICBOdW1iZXIgbnVtID0gKChFeHByZXNzaW9uU3RvcmVRdWVyeSkg\ncSkuZXhlY3V0ZURlbGV0ZSh0aGlzLCBfbWV0YSwKICAgICAgICAgICAgICAg\nIF9tZXRhcywgX3N1YnMsIF9mYWN0cywgX2V4cHMsIHBhcmFtcyk7CiAgICAg\nICAgICAgIGlmIChudW0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVy\nbiBxLmdldENvbnRleHQoKS5kZWxldGVJbk1lbW9yeSh0aGlzLCBwYXJhbXMp\nOwogICAgICAgICAgICByZXR1cm4gbnVtOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIE51bWJlciBleGVjdXRlVXBkYXRlKFN0b3JlUXVlcnkgcSwgT2Jq\nZWN0W10gcGFyYW1zKSB7CiAgICAgICAgICAgIE51bWJlciBudW0gPSAoKEV4\ncHJlc3Npb25TdG9yZVF1ZXJ5KSBxKS5leGVjdXRlVXBkYXRlKHRoaXMsIF9t\nZXRhLAogICAgICAgICAgICAgICAgX21ldGFzLCBfc3VicywgX2ZhY3RzLCBf\nZXhwcywgcGFyYW1zKTsKICAgICAgICAgICAgaWYgKG51bSA9PSBudWxsKQog\nICAgICAgICAgICAgICAgcmV0dXJuIHEuZ2V0Q29udGV4dCgpLnVwZGF0ZUlu\nTWVtb3J5KHRoaXMsIHBhcmFtcyk7CiAgICAgICAgICAgIHJldHVybiBudW07\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RGF0YVN0\nb3JlQWN0aW9ucyhTdG9yZVF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcywKICAg\nICAgICAgICAgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAgICAgcmV0dXJuICgo\nRXhwcmVzc2lvblN0b3JlUXVlcnkpIHEpLmdldERhdGFTdG9yZUFjdGlvbnMo\ndGhpcywgX21ldGEsCiAgICAgICAgICAgICAgICBfbWV0YXMsIF9zdWJzLCBf\nZmFjdHMsIF9leHBzLCBwYXJhbXMsIHJhbmdlKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBPYmplY3QgZ2V0T3JkZXJpbmdWYWx1ZShTdG9yZVF1ZXJ5\nIHEsIE9iamVjdFtdIHBhcmFtcywKICAgICAgICAgICAgT2JqZWN0IHJlc3Vs\ndE9iamVjdCwgaW50IG9yZGVySW5kZXgpIHsKICAgICAgICAgICAgLy8gaWYg\ndGhpcyBpcyBhIHByb2plY3Rpb24sIHRoZW4gd2UgaGF2ZSB0byBvcmRlciBv\nbiBzb21ldGhpbmcKICAgICAgICAgICAgLy8gd2Ugc2VsZWN0ZWQKICAgICAg\nICAgICAgaWYgKF9leHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aCA+IDApIHsK\nICAgICAgICAgICAgICAgIFN0cmluZyBvcmRlcmluZyA9IF9leHBzWzBdLm9y\nZGVyaW5nQ2xhdXNlc1tvcmRlckluZGV4XTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX2V4cHNbMF0ucHJvamVjdGlvbkNsYXVzZXMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgaWYgKG9yZGVyaW5n\nLmVxdWFscyhfZXhwc1swXS5wcm9qZWN0aW9uQ2xhdXNlc1tpXSkpCiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybiAoKE9iamVjdFtdKSByZXN1bHRP\nYmplY3QpW2ldOwoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlk\nU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICAgICAo\nIm1lcmdlZC1vcmRlci13aXRoLXJlc3VsdCIsIHEuZ2V0Q29udGV4dCgpLmdl\ndExhbmd1YWdlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHEuZ2V0Q29u\ndGV4dCgpLmdldFF1ZXJ5U3RyaW5nKCksIG9yZGVyaW5nKSk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIC8vIG5lZWQgdG8gcGFyc2Ugb3JkZXJpbmdz\nPwogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAg\nICAgICAgIGlmIChfaW5NZW1PcmRlcmluZyA9PSBudWxsKSB7CiAgICAgICAg\nICAgICAgICAgICAgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSA9IG5ldyBJ\nbk1lbW9yeUV4cHJlc3Npb25GYWN0b3J5KCk7CiAgICAgICAgICAgICAgICAg\nICAgX2luTWVtT3JkZXJpbmcgPSBfcGFyc2VyLmV2YWwoX2V4cHNbMF0ub3Jk\nZXJpbmdDbGF1c2VzLAogICAgICAgICAgICAgICAgICAgICAgICAoRXhwcmVz\nc2lvblN0b3JlUXVlcnkpIHEsIGZhY3RvcnksIF9tZXRhKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXNlIHRo\nZSBwYXJzZWQgb3JkZXJpbmcgZXhwcmVzc2lvbiB0byBleHRyYWN0IHRoZSBv\ncmRlcmluZyB2YWx1ZQogICAgICAgICAgICBWYWwgdmFsID0gKFZhbCkgX2lu\nTWVtT3JkZXJpbmdbb3JkZXJJbmRleF07CiAgICAgICAgICAgIHJldHVybiB2\nYWwuZXZhbHVhdGUocmVzdWx0T2JqZWN0LCByZXN1bHRPYmplY3QsCiAgICAg\nICAgICAgICAgICBxLmdldENvbnRleHQoKS5nZXRTdG9yZUNvbnRleHQoKSwg\ncGFyYW1zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDbGFzc1tdIGdl\ndFByb2plY3Rpb25UeXBlcyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIF9wcm9qVHlwZXM7CgkJfQoJfQp9Cg==\n","encoding":"base64"}

