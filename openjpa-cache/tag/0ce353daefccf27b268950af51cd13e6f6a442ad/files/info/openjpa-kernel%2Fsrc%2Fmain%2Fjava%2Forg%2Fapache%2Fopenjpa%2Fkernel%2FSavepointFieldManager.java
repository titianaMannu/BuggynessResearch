{"sha":"b1c8a4a8269408cdca5b73bc5b8ba8348f7be1ce","node_id":"MDQ6QmxvYjIwNjM2NDpiMWM4YTRhODI2OTQwOGNkY2E1YjczYmM1YjhiYTgzNDhmN2JlMWNl","size":6801,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b1c8a4a8269408cdca5b73bc5b8ba8348f7be1ce","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWw7CgppbXBvcnQgamF2YS51dGlsLkJpdFNldDsKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkRh\ndGU7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5lbmhhbmNlLlBlcnNpc3RlbmNlQ2FwYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Qcm94eU1hbmFnZXI7CgovKioK\nICogRmllbGRNYW5hZ2VyIHR5cGUgdXNlZCB0byBzdG9yZSBpbmZvcm1hdGlv\nbiBmb3Igc2F2ZXBvaW50IHJvbGxiYWNrLgogKgogKiBAYXV0aG9yIFN0ZXZl\nIEtpbQogKiBAc2luY2UgMC4zLjQKICovCmNsYXNzIFNhdmVwb2ludEZpZWxk\nTWFuYWdlcgogICAgZXh0ZW5kcyBDbGVhckZpZWxkTWFuYWdlciB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChTYXZlcG9pbnRGaWVsZE1hbmFnZXIu\nY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgU3RhdGVNYW5hZ2VySW1wbCBf\nc207CiAgICBwcml2YXRlIGZpbmFsIEJpdFNldCBfbG9hZGVkOwogICAgcHJp\ndmF0ZSBmaW5hbCBCaXRTZXQgX2RpcnR5OwogICAgcHJpdmF0ZSBmaW5hbCBC\naXRTZXQgX2ZsdXNoOwogICAgcHJpdmF0ZSBmaW5hbCBQQ1N0YXRlIF9zdGF0\nZTsKICAgIHByaXZhdGUgUGVyc2lzdGVuY2VDYXBhYmxlIF9jb3B5OwoKICAg\nIC8vIHVzZWQgdG8gdHJhY2sgZmllbGQgdmFsdWUgZHVyaW5nIHN0b3JlL2Zl\ndGNoIGN5Y2xlCiAgICBwcml2YXRlIE9iamVjdCBfZmllbGQgPSBudWxsOwog\nICAgcHJpdmF0ZSBpbnRbXSBfY29weUZpZWxkID0gbnVsbDsKICAgIHByaXZh\ndGUgQml0U2V0IF9tdXRhYmxlOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0\nb3IuIFByb3ZpZGUgaW5zdGFuY2UgdG8gc2F2ZSBhbmQgaW5kaWNhdGUgd2hl\ndGhlcgogICAgICogdG8gY29weSBwZXJzaXN0ZW50IGZpZWxkcy4gVHJhbnNh\nY3Rpb25hbCBmaWVsZHMgd2lsbCBiZQogICAgICogY29waWVkIHJlZ2FyZGxl\nc3Mgb2YgY29weSBzZXR0aW5nLgogICAgICovCiAgICBwdWJsaWMgU2F2ZXBv\naW50RmllbGRNYW5hZ2VyKFN0YXRlTWFuYWdlckltcGwgc20sIGJvb2xlYW4g\nY29weSkgewogICAgICAgIF9zbSA9IHNtOwogICAgICAgIF9zdGF0ZSA9IF9z\nbS5nZXRQQ1N0YXRlKCk7CgogICAgICAgIF9kaXJ0eSA9IChCaXRTZXQpIF9z\nbS5nZXREaXJ0eSgpLmNsb25lKCk7CiAgICAgICAgX2ZsdXNoID0gKEJpdFNl\ndCkgX3NtLmdldEZsdXNoZWQoKS5jbG9uZSgpOwogICAgICAgIF9sb2FkZWQg\nPSAoQml0U2V0KSBfc20uZ2V0TG9hZGVkKCkuY2xvbmUoKTsKCiAgICAgICAg\nRmllbGRNZXRhRGF0YVtdIGZpZWxkcyA9IF9zbS5nZXRNZXRhRGF0YSgpLmdl\ndEZpZWxkcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2xvYWRl\nZC5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAgICAgIGlmICghX2xvYWRlZC5n\nZXQoaSkpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAg\naWYgKGNvcHkgfHwgZmllbGRzW2ldLmdldE1hbmFnZW1lbnQoKSA9PQogICAg\nICAgICAgICAgICAgRmllbGRNZXRhRGF0YS5NQU5BR0VfVFJBTlNBQ1RJT05B\nTCkgewogICAgICAgICAgICAgICAgaWYgKF9jb3B5ID09IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgX2NvcHkgPSBfc20uZ2V0UGVyc2lzdGVuY2VDYXBh\nYmxlKCkucGNOZXdJbnN0YW5jZQogICAgICAgICAgICAgICAgICAgICAgICAo\nX3NtLCB0cnVlKTsKICAgICAgICAgICAgICAgIHN0b3JlRmllbGQoZmllbGRz\nW2ldKTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBfbG9h\nZGVkLmNsZWFyKGkpOwogICAgICAgIH0KCiAgICAgICAgLy8gd2UgbmVlZCB0\nbyBwcm94eSB0aGUgZmllbGRzIHNvIHRoYXQgd2UgY2FuIHRyYWNrIGZ1dHVy\nZSBjaGFuZ2VzCiAgICAgICAgLy8gZnJvbSB0aGlzIHNhdmVwb2ludCBmb3J3\nYXJkIGZvciBQTmV3IGluc3RhbmNlcycgbXV0YWJsZSBmaWVsZHMKICAgICAg\nICBfc20ucHJveHlGaWVsZHMoZmFsc2UsIGZhbHNlKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgc3RhdGUgbWFuYWdlciB0aGF0IHRoaXMg\nbWFuYWdlciBpcyBhc3NvY2lhdGVkIHdpdGguCiAgICAgKi8KICAgIHB1Ymxp\nYyBTdGF0ZU1hbmFnZXJJbXBsIGdldFN0YXRlTWFuYWdlcigpIHsKICAgICAg\nICByZXR1cm4gX3NtOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBwZXJzaXN0ZW5jZSBjYXBhYmxlIGNvcHkgaG9sZGluZyB0aGUgc2F2ZXBv\naW50IGZpZWxkIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIFBlcnNpc3Rl\nbmNlQ2FwYWJsZSBnZXRDb3B5KCkgewogICAgICAgIHJldHVybiBfY29weTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2F2ZWQge0BsaW5r\nIFBDU3RhdGV9CiAgICAgKi8KICAgIHB1YmxpYyBQQ1N0YXRlIGdldFBDU3Rh\ndGUoKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgZmllbGRzIHN0b3JlZCBpbiB0aGlzIG1hbmFn\nZXIuCiAgICAgKi8KICAgIHB1YmxpYyBCaXRTZXQgZ2V0TG9hZGVkKCkgewog\nICAgICAgIHJldHVybiBfbG9hZGVkOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBkaXJ0eSBmaWVsZHMgZHVyaW5nIHRoZSBzYXZlZCBzdGF0\nZS4KICAgICAqLwogICAgcHVibGljIEJpdFNldCBnZXREaXJ0eSgpIHsKICAg\nICAgICByZXR1cm4gX2RpcnR5OwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBmbHVzaGVkIGZpZWxkcyBkdXJpbmcgdGhlIHNhdmVkIHN0YXRl\nLgogICAgICovCiAgICBwdWJsaWMgQml0U2V0IGdldEZsdXNoZWQoKSB7CiAg\nICAgICAgcmV0dXJuIF9mbHVzaDsKICAgIH0KCiAgICAvKioKICAgICAqIFN0\nb3JlIHRoZSBkYXRhIGZvciB0aGUgZ2l2ZW4gZmllbGQuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHN0b3JlRmllbGQoRmllbGRNZXRhRGF0YSBmaWVsZCkg\newogICAgICAgIHN3aXRjaCAoZmllbGQuZ2V0RGVjbGFyZWRUeXBlQ29kZSgp\nKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRBVEU6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5NQVA6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAg\nICAgICAgICAgICAgIGlmIChfbXV0YWJsZSA9PSBudWxsKQogICAgICAgICAg\nICAgICAgICAgIF9tdXRhYmxlID0gbmV3IEJpdFNldChfc20uZ2V0TWV0YURh\ndGEoKS5nZXRGaWVsZHMoKS5sZW5ndGgpOwogICAgICAgICAgICAgICAgX211\ndGFibGUuc2V0KGZpZWxkLmdldEluZGV4KCkpOwogICAgICAgIH0KICAgICAg\nICBpZiAoX211dGFibGUgPT0gbnVsbCB8fCAhX211dGFibGUuZ2V0KGZpZWxk\nLmdldEluZGV4KCkpKSB7CiAgICAgICAgICAgIC8vIGltbXV0YWJsZSBmaWVs\nZHMgY2FuIGp1c3QgYmUgY29waWVkIG92ZXIKICAgICAgICAgICAgaWYgKF9j\nb3B5RmllbGQgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jb3B5RmllbGQg\nPSBuZXcgaW50WzFdOwogICAgICAgICAgICBfY29weUZpZWxkWzBdID0gZmll\nbGQuZ2V0SW5kZXgoKTsKICAgICAgICAgICAgX2NvcHkucGNDb3B5RmllbGRz\nKF9zbS5nZXRQZXJzaXN0ZW5jZUNhcGFibGUoKSwgX2NvcHlGaWVsZCk7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3NtLnByb3ZpZGVGaWVsZChf\nc20uZ2V0UGVyc2lzdGVuY2VDYXBhYmxlKCksIHRoaXMsCiAgICAgICAgICAg\nICAgICBmaWVsZC5nZXRJbmRleCgpKTsKICAgICAgICAgICAgX3NtLnJlcGxh\nY2VGaWVsZChfY29weSwgdGhpcywgZmllbGQuZ2V0SW5kZXgoKSk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVzdG9yZSB0aGUgZ2l2ZW4g\nZmllbGQuIElmIHRoaXMgbWV0aG9kIHJldHVybnMgdHJ1ZSwgdGhlbiB5b3Ug\nbmVlZAogICAgICogdG8gdXNlIHRoaXMgZmllbGQgbWFuYWdlciB0byByZXBs\nYWNlIHRoZSBnaXZlbiBmaWVsZCBpbiB0aGUgc3RhdGUKICAgICAqIG1hbmFn\nZXIncyBpbnN0YW5jZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gcmVz\ndG9yZUZpZWxkKGludCBmaWVsZCkgewogICAgICAgIGlmICghX2xvYWRlZC5n\nZXQoZmllbGQpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\naWYgKF9tdXRhYmxlICE9IG51bGwgJiYgX211dGFibGUuZ2V0KGZpZWxkKSkK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIC8vIGNvcHkgdGhl\nIHNhdmVkIGZpZWxkIG92ZXIKICAgICAgICBpZiAoX2NvcHlGaWVsZCA9PSBu\ndWxsKQogICAgICAgICAgICBfY29weUZpZWxkID0gbmV3IGludFsxXTsKICAg\nICAgICBfY29weUZpZWxkWzBdID0gZmllbGQ7CiAgICAgICAgX3NtLmdldFBl\ncnNpc3RlbmNlQ2FwYWJsZSgpLnBjQ29weUZpZWxkcyhfY29weSwgX2NvcHlG\naWVsZCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgZmV0Y2hPYmplY3RGaWVsZChpbnQgZmllbGQpIHsKICAgICAg\nICAvLyByZXR1cm4gdGhlIGNvcGllZCBmaWVsZCBkdXJpbmcgc2F2ZSwgb3Ig\nYSBudWxsIHZhbHVlIGR1cmluZyByZXN0b3JlCiAgICAgICAgT2JqZWN0IHZh\nbCA9IF9maWVsZDsKICAgICAgICBfZmllbGQgPSBudWxsOwogICAgICAgIHJl\ndHVybiB2YWw7CiAgICB9CgogICAgcHVibGljIHZvaWQgc3RvcmVPYmplY3RG\naWVsZChpbnQgZmllbGQsIE9iamVjdCBjdXJWYWwpIHsKICAgICAgICAvLyBj\nb3B5IG11dGFibGUgZmllbGRzCiAgICAgICAgUHJveHlNYW5hZ2VyIHByb3h5\nID0gX3NtLmdldENvbnRleHQoKS5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAg\nICAgICAgIGdldFByb3h5TWFuYWdlckluc3RhbmNlKCk7CiAgICAgICAgRmll\nbGRNZXRhRGF0YSBmbWQgPSBfc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVsZChm\naWVsZCk7CiAgICAgICAgc3dpdGNoIChmbWQuZ2V0RGVjbGFyZWRUeXBlQ29k\nZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAg\nICAgICAgICAgICAgX2ZpZWxkID0gcHJveHkuY29weUFycmF5KGN1clZhbCk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgIF9maWVsZCA9IHBy\nb3h5LmNvcHlDb2xsZWN0aW9uKChDb2xsZWN0aW9uKSBjdXJWYWwpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLk1BUDoKICAgICAgICAgICAgICAgIF9maWVsZCA9IHByb3h5LmNvcHlNYXAo\nKE1hcCkgY3VyVmFsKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAgICAgICAgICAgX2Zp\nZWxkID0gcHJveHkuY29weURhdGUoKERhdGUpIGN1clZhbCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0JK\nRUNUOgogICAgICAgICAgICAgICAgX2ZpZWxkID0gcHJveHkuY29weUN1c3Rv\nbShjdXJWYWwpOwogICAgICAgICAgICAgICAgaWYgKF9maWVsZCA9PSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIF9maWVsZCA9IGN1clZhbDsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgX2ZpZWxkID0gY3VyVmFsOwogICAgICAgIH0KCiAgICAgICAg\nLy8gaWYgd2UgY291bGRuJ3QgZ2V0IGEgY29weSBvZiB0aGUgc2NvLCBhY3Qg\nbGlrZSBpdCB3YXNuJ3Qgc2F2ZWQKICAgICAgICAvLyBzaG91bGQgdGhyb3cg\nYW4gZXhjZXB0aW9uCiAgICAgICAgaWYgKGN1clZhbCAhPSBudWxsICYmIF9m\naWVsZCA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxF\neGNlcHRpb24oX2xvYy5nZXQoIm5vLXNhdmVwb2ludC1jb3B5IiwgZm1kKSk7\nCgl9Cn0K\n","encoding":"base64"}

