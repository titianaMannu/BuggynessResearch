{"sha":"147bde60a4c4adcfb54eac50ee16e4354f20ac61","node_id":"MDQ6QmxvYjIwNjM2NDoxNDdiZGU2MGE0YzRhZGNmYjU0ZWFjNTBlZTE2ZTQzNTRmMjBhYzYx","size":5749,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/147bde60a4c4adcfb54eac50ee16e4354f20ac61","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwczsKCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0\nb3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5MaXN0SXRlcmF0b3I7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmxhbmcuT2JqZWN0VXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLkJyb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuRmlsdGVyczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CgovKioKICogQSBw\nYXRoIHJlcHJlc2VudHMgYSB0cmF2ZXJzYWwgaW50byBmaWVsZHMgb2YgYSBj\nYW5kaWRhdGUgb2JqZWN0LgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8K\nY2xhc3MgQ2FuZGlkYXRlUGF0aAogICAgZXh0ZW5kcyBWYWwKICAgIGltcGxl\nbWVudHMgUGF0aCB7CgogICAgcHJpdmF0ZSBMaW5rZWRMaXN0IF9hY3Rpb25z\nID0gbnVsbDsKCiAgICAvKioKICAgICAqIFRyYXZlcnNlIGludG8gdGhlIGdp\ndmVuIGZpZWxkIG9mIHRoZSBjdXJyZW50IG9iamVjdCwgYW5kIHVwZGF0ZQog\nICAgICogdGhlIGN1cnJlbnQgb2JqZWN0IHRvIHRoYXQgZmllbGQgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGdldChGaWVsZE1ldGFEYXRhIGZp\nZWxkLCBib29sZWFuIG51bGxUcmF2ZXJzYWwpIHsKICAgICAgICBpZiAoX2Fj\ndGlvbnMgPT0gbnVsbCkKICAgICAgICAgICAgX2FjdGlvbnMgPSBuZXcgTGlu\na2VkTGlzdCgpOwogICAgICAgIF9hY3Rpb25zLmFkZChuZXcgVHJhdmVyc2Fs\nKGZpZWxkLCBudWxsVHJhdmVyc2FsKSk7CiAgICB9CgogICAgcHVibGljIENs\nYXNzIGdldFR5cGUoKSB7CiAgICAgICAgaWYgKF9hY3Rpb25zID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBnZXRDYW5kaWRhdGVUeXBlKCk7CgogICAg\nICAgIE9iamVjdCBsYXN0ID0gX2FjdGlvbnMuZ2V0TGFzdCgpOwogICAgICAg\nIGlmIChsYXN0IGluc3RhbmNlb2YgQ2xhc3MpCiAgICAgICAgICAgIHJldHVy\nbiAoQ2xhc3MpIGxhc3Q7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAo\nKFRyYXZlcnNhbCkgbGFzdCkuZmllbGQ7CiAgICAgICAgcmV0dXJuIGZtZC5n\nZXREZWNsYXJlZFR5cGUoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xhc3Mg\nZ2V0Q2FuZGlkYXRlVHlwZSgpIHsKICAgICAgICBDbGFzc01ldGFEYXRhIG1l\ndGEgPSBnZXRNZXRhRGF0YSgpOwogICAgICAgIGlmIChtZXRhID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBPYmplY3QuY2xhc3M7CiAgICAgICAgcmV0\ndXJuIG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEltcGxpY2l0VHlwZShDbGFzcyB0eXBlKSB7CiAgICB9Cgog\nICAgcHVibGljIEZpZWxkTWV0YURhdGEgbGFzdCgpIHsKICAgICAgICBpZiAo\nX2FjdGlvbnMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIExpc3RJdGVyYXRvciBpdHIgPSBfYWN0aW9ucy5saXN0SXRlcmF0\nb3IoX2FjdGlvbnMuc2l6ZSgpKTsKICAgICAgICBPYmplY3QgcHJldjsKICAg\nICAgICB3aGlsZSAoaXRyLmhhc1ByZXZpb3VzKCkpIHsKICAgICAgICAgICAg\ncHJldiA9IGl0ci5wcmV2aW91cygpOwogICAgICAgICAgICBpZiAocHJldiBp\nbnN0YW5jZW9mIFRyYXZlcnNhbCkKICAgICAgICAgICAgICAgIHJldHVybiAo\nKFRyYXZlcnNhbCkgcHJldikuZmllbGQ7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogQ2FzdCB0aGlzIHBh\ndGggdG8gdGhlIGdpdmVuIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGNhc3RUbyhDbGFzcyB0eXBlKSB7CiAgICAgICAgaWYgKF9hY3Rpb25zID09\nIG51bGwpCiAgICAgICAgICAgIF9hY3Rpb25zID0gbmV3IExpbmtlZExpc3Qo\nKTsKICAgICAgICBfYWN0aW9ucy5hZGQodHlwZSk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIE9iamVjdCBldmFsKE9iamVjdCBjYW5kaWRhdGUsIE9iamVjdCBv\ncmlnLAogICAgICAgIFN0b3JlQ29udGV4dCBjdHgsIE9iamVjdFtdIHBhcmFt\ncykgewogICAgICAgIGlmIChfYWN0aW9ucyA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gY2FuZGlkYXRlOwoKICAgICAgICBPYmplY3QgYWN0aW9uOwog\nICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc207CiAgICAgICAgQnJva2Vy\nIHRtcEJyb2tlciA9IG51bGw7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSBfYWN0aW9ucy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICBhY3Rpb24gPSBpdHIubmV4dCgpOwoKICAgICAgICAgICAgLy8g\nZmFpbCBvbiBudWxsIHZhbHVlCiAgICAgICAgICAgIGlmIChjYW5kaWRhdGUg\nPT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWYgKGFjdGlvbiBpbnN0YW5j\nZW9mIFRyYXZlcnNhbAogICAgICAgICAgICAgICAgICAgICYmICgoVHJhdmVy\nc2FsKSBhY3Rpb24pLm51bGxUcmF2ZXJzYWwpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTnVs\nbFBvaW50ZXJFeGNlcHRpb24oKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gY2hlY2sgdGhhdCB0aGUgY2FzdCBpcyB2YWxpZAogICAgICAgICAg\nICBpZiAoYWN0aW9uIGluc3RhbmNlb2YgQ2xhc3MpIHsKICAgICAgICAgICAg\nICAgIGNhbmRpZGF0ZSA9IEZpbHRlcnMuY29udmVydChjYW5kaWRhdGUsIChD\nbGFzcykgYWN0aW9uKTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICAvLyBtYWtlIHN1cmUgd2UgY2FuIGFj\nY2VzcyB0aGUgaW5zdGFuY2U7IGV2ZW4gbm9uLXBjIHZhbHMgbWlnaHQKICAg\nICAgICAgICAgLy8gYmUgcHJveHlhYmxlCiAgICAgICAgICAgIHNtID0gbnVs\nbDsKICAgICAgICAgICAgdG1wQnJva2VyID0gbnVsbDsKICAgICAgICAgICAg\naWYgKGNhbmRpZGF0ZSBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlQ2FwYWJsZSkK\nICAgICAgICAgICAgICAgIHNtID0gKE9wZW5KUEFTdGF0ZU1hbmFnZXIpICgo\nUGVyc2lzdGVuY2VDYXBhYmxlKSBjYW5kaWRhdGUpLgogICAgICAgICAgICAg\nICAgICAgIHBjR2V0U3RhdGVNYW5hZ2VyKCk7CiAgICAgICAgICAgIGlmIChz\nbSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICB0bXBCcm9rZXIgPSBjdHgu\nZ2V0QnJva2VyKCk7CiAgICAgICAgICAgICAgICB0bXBCcm9rZXIudHJhbnNh\nY3Rpb25hbChjYW5kaWRhdGUsIGZhbHNlLCBudWxsKTsKICAgICAgICAgICAg\nICAgIHNtID0gdG1wQnJva2VyLmdldFN0YXRlTWFuYWdlcihjYW5kaWRhdGUp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgLy8gZ2V0IHRoZSBzcGVjaWZpZWQgZmllbGQgdmFsdWUgYW5kIHN3\naXRjaCBjYW5kaWRhdGUKICAgICAgICAgICAgICAgIFRyYXZlcnNhbCB0cmF2\nZXJzYWwgPSAoVHJhdmVyc2FsKSBhY3Rpb247CiAgICAgICAgICAgICAgICBj\nYW5kaWRhdGUgPSBzbS5mZXRjaEZpZWxkKHRyYXZlcnNhbC5maWVsZC5nZXRJ\nbmRleCgpLCB0cnVlKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIC8vIHRyYW5zYWN0aW9uYWwgZG9lcyBub3QgY2xlYXIgdGhl\nIHN0YXRlLCB3aGljaCBpcwogICAgICAgICAgICAgICAgLy8gaW1wb3J0YW50\nIHNpbmNlIHRtcENhbmRpZGF0ZSBtaWdodCBiZSBhbHNvIG1hbmFnZWQgYnkK\nICAgICAgICAgICAgICAgIC8vIGFub3RoZXIgYnJva2VyIGlmIGl0J3MgYSBw\ncm94aWVkIG5vbi1wYyBpbnN0YW5jZQogICAgICAgICAgICAgICAgaWYgKHRt\ncEJyb2tlciAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRtcEJyb2tl\nci5ub250cmFuc2FjdGlvbmFsKHNtLmdldE1hbmFnZWRJbnN0YW5jZSgpLCBu\ndWxsKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\nY2FuZGlkYXRlOwogICAgfQoKICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7\nCiAgICAgICAgcmV0dXJuIChfYWN0aW9ucyA9PSBudWxsKSA/IDAgOiBfYWN0\naW9ucy5oYXNoQ29kZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVx\ndWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhp\ncykKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3Ro\nZXIgaW5zdGFuY2VvZiBDYW5kaWRhdGVQYXRoKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIHJldHVybiBPYmplY3RVdGlscy5lcXVhbHMo\nX2FjdGlvbnMsICgoQ2FuZGlkYXRlUGF0aCkgb3RoZXIpLl9hY3Rpb25zKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJlcHJlc2VudHMgYSB0cmF2ZXJzYWwg\ndGhyb3VnaCBhIGZpZWxkLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBj\nbGFzcyBUcmF2ZXJzYWwgewoKICAgICAgICBwdWJsaWMgZmluYWwgRmllbGRN\nZXRhRGF0YSBmaWVsZDsKICAgICAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBu\ndWxsVHJhdmVyc2FsOwoKICAgICAgICBwcml2YXRlIFRyYXZlcnNhbChGaWVs\nZE1ldGFEYXRhIGZpZWxkLCBib29sZWFuIG51bGxUcmF2ZXJzYWwpIHsKICAg\nICAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwogICAgICAgICAgICB0aGlz\nLm51bGxUcmF2ZXJzYWwgPSBudWxsVHJhdmVyc2FsOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuIGZpZWxkLmhhc2hDb2RlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7CiAgICAgICAgICAg\nIGlmIChvdGhlciA9PSB0aGlzKQogICAgICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgICAgIHJldHVybiAoKFRyYXZlcnNhbCkgb3RoZXIpLmZp\nZWxkLmVxdWFscyhmaWVsZCk7CiAgICAgICAgfQoJfQp9Cg==\n","encoding":"base64"}

