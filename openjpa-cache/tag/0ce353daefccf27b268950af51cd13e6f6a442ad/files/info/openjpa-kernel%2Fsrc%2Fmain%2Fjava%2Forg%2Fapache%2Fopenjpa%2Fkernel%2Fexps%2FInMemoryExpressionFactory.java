{"sha":"1042b5c67d0884873a16a5220f73a6c4060ad0b3","node_id":"MDQ6QmxvYjIwNjM2NDoxMDQyYjVjNjdkMDg4NDg3M2ExNmE1MjIwZjczYTZjNDA2MGFkMGIz","size":23372,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1042b5c67d0884873a16a5220f73a6c4060ad0b3","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwczsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlM\naXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwpp\nbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3RJdGVyYXRvcjsK\naW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21t\nb25zLmxhbmcuT2JqZWN0VXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLkV4dGVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBFeHByZXNzaW9uIGZhY3Rv\ncnkgaW1wbGVtZW50YXRpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBleGVjdXRl\nIHF1ZXJpZXMKICogaW4gbWVtb3J5LgogKgogKiBAYXV0aG9yIEFiZSBXaGl0\nZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgSW5NZW1vcnlFeHBy\nZXNzaW9uRmFjdG9yeQogICAgaW1wbGVtZW50cyBFeHByZXNzaW9uRmFjdG9y\neSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgVmFsdWUgTlVMTCA9IG5l\ndyBOdWxsKCk7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBWYWx1ZSBDVVJS\nRU5UX0RBVEUgPSBuZXcgQ3VycmVudERhdGUoKTsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIE9iamVjdCBVTklRVUUgPSBuZXcgT2JqZWN0KCk7CgogICAg\nLy8gbGlzdCBvZiB1bmJvdW5kIHZhcmlhYmxlcyBpbiB0aGlzIHF1ZXJ5CiAg\nICBwcml2YXRlIExpc3QgX3VuYm91bmRzID0gbnVsbDsKCiAgICAvKioKICAg\nICAqIFRlc3RzIHdoZXRoZXIgdGhlIGdpdmVuIGNhbmRpZGF0ZSBtYXRjaGVz\nIHRoZSBnaXZlbiB0eXBlIGFuZCB0aGlzCiAgICAgKiBleHByZXNzaW9uLgog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBtYXRjaGVzKFF1ZXJ5RXhwcmVz\nc2lvbnMgZXhwcywgQ2xhc3NNZXRhRGF0YSB0eXBlLAogICAgICAgIGJvb2xl\nYW4gc3VicywgT2JqZWN0IGNhbmRpZGF0ZSwgU3RvcmVDb250ZXh0IGN0eCwg\nT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgLy8gaWdub3JlIGNhbmRpZGF0\nZXMgb2YgdGhlIHdyb25nIHR5cGUKICAgICAgICBpZiAoY2FuZGlkYXRlID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAo\nIXN1YnMgJiYgY2FuZGlkYXRlLmdldENsYXNzKCkgIT0gdHlwZS5nZXREZXNj\ncmliZWRUeXBlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICBpZiAoc3VicyAmJiAhdHlwZS5nZXREZXNjcmliZWRUeXBlKCkuaXNBc3Np\nZ25hYmxlRnJvbQogICAgICAgICAgICAoY2FuZGlkYXRlLmdldENsYXNzKCkp\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIGV2YWx1\nYXRlIHRoZSBleHByZXNzaW9uIGZvciBhbGwgcG9zc2libGUgY29tYmluYXRp\nb25zIG9mIHZhbHVlcwogICAgICAgIC8vIG9mIHRoZSB1bmJvdW5kIHZhcmlh\nYmxlczsgdGhlIGNhbmRpZGF0ZSBtYXRjaGVzIGlmIGFueSBjb21iaW5hdGlv\nbgogICAgICAgIC8vIG1hdGNoZXMKICAgICAgICByZXR1cm4gbWF0Y2hlcygo\nRXhwKSBleHBzLmZpbHRlciwgY2FuZGlkYXRlLCBjdHgsIHBhcmFtcywgMCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZWN1cnNpdmUgbWV0aG9kIHRvIGV2\nYWx1YXRlIHRoZSBleHByZXNzaW9uIGZvciBhbGwgcG9zc2libGUKICAgICAq\nIGNvbWJpbmF0aW9ucyBvZiB1bmJvdW5kIHZhcmlhYmxlcy4gVGhpcyBtZXRo\nb2Qgc2ltdWxhdGVzIGEgc2VxdWVuY2UKICAgICAqIG9mIGVtYmVkZGVkIHBy\nb2NlZHVyYWwgbG9vcHMgb3ZlciB0aGUgZXh0ZW50cyBvZiBhbGwgdmFyaWFi\nbGVzIGluIHRoZQogICAgICogdW5ib3VuZHMgbGlzdC4KICAgICAqLwogICAg\ncHJpdmF0ZSBib29sZWFuIG1hdGNoZXMoRXhwIGV4cCwgT2JqZWN0IGNhbmRp\nZGF0ZSwgU3RvcmVDb250ZXh0IGN0eCwKICAgICAgICBPYmplY3RbXSBwYXJh\nbXMsIGludCBpKSB7CiAgICAgICAgLy8gYmFzZSBjYXNlOiBhbGwgdmFyaWFi\nbGVzIGhhdmUgYmVlbiBhbGlhc2VkOyBldmFsdWF0ZSBmb3IgY3VycmVudAog\nICAgICAgIC8vIHZhbHVlcwogICAgICAgIGlmIChfdW5ib3VuZHMgPT0gbnVs\nbCB8fCBpID09IF91bmJvdW5kcy5zaXplKCkpCiAgICAgICAgICAgIHJldHVy\nbiBleHAuZXZhbHVhdGUoY2FuZGlkYXRlLCBjYW5kaWRhdGUsIGN0eCwgcGFy\nYW1zKTsKCiAgICAgICAgLy8gZ3JhYiB0aGUgZXh0ZW50IGZvciB0aGlzIHZh\ncmlhYmxlCiAgICAgICAgVW5ib3VuZFZhcmlhYmxlIHZhciA9IChVbmJvdW5k\nVmFyaWFibGUpIF91bmJvdW5kcy5nZXQoaSk7CiAgICAgICAgSXRlcmF0b3Ig\naXRyID0gY3R4LmV4dGVudEl0ZXJhdG9yKHZhci5nZXRUeXBlKCksIHRydWUs\nIG51bGwsIGZhbHNlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBp\nZiB0aGUgZXh0ZW50IHdhcyBlbXB0eSwgdGhlbiBhbGlhcyB0aGUgdmFyaWFi\nbGUgdG8gbnVsbAogICAgICAgICAgICBpZiAoIWl0ci5oYXNOZXh0KCkpIHsK\nICAgICAgICAgICAgICAgIHZhci5zZXRWYWx1ZShudWxsKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBtYXRjaGVzKGV4cCwgY2FuZGlkYXRlLCBjdHgsIHBh\ncmFtcywgaSArIDEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyB0\ncnkgZXZlcnkgdmFsdWUsIHNob3J0LWNpcmN1aXRpbmcgb24gbWF0Y2gKICAg\nICAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAg\nICAgIC8vIHNldCB0aGUgdmFyaWFibGUgdG8gZWFjaCBleHRlbnQgdmFsdWUg\nYW5kIHJlY3Vyc2UKICAgICAgICAgICAgICAgIHZhci5zZXRWYWx1ZShpdHIu\nbmV4dCgpKTsKICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzKGV4cCwgY2Fu\nZGlkYXRlLCBjdHgsIHBhcmFtcywgaSArIDEpKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAv\nLyBubyBtYXRjaAogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgSW1wbEhlbHBlci5jbG9zZShpdHIp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEdyb3VwIHRoZSBs\naXN0IG9mIG1hdGNoZXMgaW50byBhIGxpc3Qgb2YgbGlzdHMuCiAgICAgKi8K\nICAgIHB1YmxpYyBMaXN0IGdyb3VwKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywg\nTGlzdCBtYXRjaGVzLAogICAgICAgIFN0b3JlQ29udGV4dCBjdHgsIE9iamVj\ndFtdIHBhcmFtcykgewogICAgICAgIGlmIChtYXRjaGVzID09IG51bGwgfHwg\nbWF0Y2hlcy5pc0VtcHR5KCkgfHwgZXhwcy5ncm91cGluZy5sZW5ndGggPT0g\nMCkKICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7CgogICAgICAgIC8vIHRv\nIGZvcm0gZ3JvdXBzIHdlIGZpcnN0IG9yZGVyIG9uIHRoZSBncm91cGluZyBj\ncml0ZXJpYQogICAgICAgIG1hdGNoZXMgPSBvcmRlcihleHBzLCBleHBzLmdy\nb3VwaW5nLCBmYWxzZSwgbWF0Y2hlcywgY3R4LCBwYXJhbXMpOwoKICAgICAg\nICAvLyBub3cgd2UgY29tYmluZSBhbGwgcmVzdWx0cyB3aG9zZSB2YWx1ZXMg\nZm9yIGVhY2ggZ3JvdXBpbmcgY2xhdXNlCiAgICAgICAgLy8gYXJlIHRoZSBz\nYW1lLCByZWx5aW5nIG9uIHRoZSBmYWN0IHRoYXQgdGhlc2UgdmFsdWVzIHdp\nbGwgYWxyZWFkeSBiZQogICAgICAgIC8vIHRvZ2V0aGVyIGR1ZSB0byB0aGUg\nc29ydGluZwogICAgICAgIE9iamVjdFtdIHByZXZzID0gbmV3IE9iamVjdFtl\neHBzLmdyb3VwaW5nLmxlbmd0aF07CiAgICAgICAgQXJyYXlzLmZpbGwocHJl\ndnMsIFVOSVFVRSk7CiAgICAgICAgT2JqZWN0W10gY3VycyA9IG5ldyBPYmpl\nY3RbZXhwcy5ncm91cGluZy5sZW5ndGhdOwogICAgICAgIExpc3QgZ3JvdXBl\nZCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBMaXN0IGdyb3VwID0gbnVs\nbDsKICAgICAgICBPYmplY3QgcGM7CiAgICAgICAgYm9vbGVhbiBlcTsKICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG1hdGNoZXMuaXRlcmF0b3IoKTsg\naXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgcGMgPSBpdHIubmV4dCgp\nOwogICAgICAgICAgICBlcSA9IHRydWU7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgZXhwcy5ncm91cGluZy5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICAgICAgY3Vyc1tpXSA9ICgoVmFsKSBleHBzLmdyb3VwaW5nW2ld\nKS5ldmFsdWF0ZShwYywgcGMsIGN0eCwKICAgICAgICAgICAgICAgICAgICBw\nYXJhbXMpOwogICAgICAgICAgICAgICAgZXEgPSBlcSAmJiBPYmplY3RVdGls\ncy5lcXVhbHMocHJldnNbaV0sIGN1cnNbaV0pOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICAvLyBpZiB0aGlzIG9iamVjdCdzIGdyb3VwaW5nIHZhbHVl\ncyBkaWZmZXIgZnJvbSB0aGUgcHJldiwKICAgICAgICAgICAgLy8gc3RhcnQg\nYSBuZXcgZ3JvdXAKICAgICAgICAgICAgaWYgKCFlcSkgewogICAgICAgICAg\nICAgICAgaWYgKGdyb3VwICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\nZ3JvdXBlZC5hZGQoZ3JvdXApOwogICAgICAgICAgICAgICAgZ3JvdXAgPSBu\nZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ3Jv\ndXAuYWRkKHBjKTsKICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShjdXJz\nLCAwLCBwcmV2cywgMCwgY3Vycy5sZW5ndGgpOwogICAgICAgIH0KICAgICAg\nICAvLyBhZGQgdGhlIGxhc3QgZ3JvdXAgZm9ybWVkCiAgICAgICAgaWYgKGdy\nb3VwICE9IG51bGwpCiAgICAgICAgICAgIGdyb3VwZWQuYWRkKGdyb3VwKTsK\nCiAgICAgICAgcmV0dXJuIGdyb3VwZWQ7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gZ3JvdXAgbWF0Y2hlcyB0aGUg\naGF2aW5nIGV4cHJlc3Npb24uCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIG1hdGNoZXMoUXVlcnlFeHByZXNzaW9ucyBleHBzLCBDb2xsZWN0aW9uIGdy\nb3VwLAogICAgICAgIFN0b3JlQ29udGV4dCBjdHgsIE9iamVjdFtdIHBhcmFt\ncykgewogICAgICAgIGlmIChncm91cCA9PSBudWxsIHx8IGdyb3VwLmlzRW1w\ndHkoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChl\neHBzLmhhdmluZyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nCiAgICAgICAgLy8gZXZhbHVhdGUgdGhlIGV4cHJlc3Npb24gZm9yIGFsbCBw\nb3NzaWJsZSBjb21iaW5hdGlvbnMgb2YgdmFsdWVzCiAgICAgICAgLy8gb2Yg\ndGhlIHVuYm91bmQgdmFyaWFibGVzOyB0aGUgZ3JvdXAgbWF0Y2hlcyBpZiBh\nbnkgY29tYmluYXRpb24KICAgICAgICAvLyBtYXRjaGVzCiAgICAgICAgcmV0\ndXJuIG1hdGNoZXMoKEV4cCkgZXhwcy5oYXZpbmcsIGdyb3VwLCBjdHgsIHBh\ncmFtcywgMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWN1cnNpdmUgbWV0\naG9kIHRvIGV2YWx1YXRlIHRoZSBleHByZXNzaW9uIGZvciBhbGwgcG9zc2li\nbGUKICAgICAqIGNvbWJpbmF0aW9ucyBvZiB1bmJvdW5kIHZhcmlhYmxlcy4g\nVGhpcyBtZXRob2Qgc2ltdWxhdGVzIGEgc2VxdWVuY2UKICAgICAqIG9mIGVt\nYmVkZGVkIHByb2NlZHVyYWwgbG9vcHMgb3ZlciB0aGUgZXh0ZW50cyBvZiBh\nbGwgdmFyaWFibGVzIGluIHRoZQogICAgICogdW5ib3VuZHMgbGlzdC4KICAg\nICAqLwogICAgcHJpdmF0ZSBib29sZWFuIG1hdGNoZXMoRXhwIGV4cCwgQ29s\nbGVjdGlvbiBncm91cCwgU3RvcmVDb250ZXh0IGN0eCwKICAgICAgICBPYmpl\nY3RbXSBwYXJhbXMsIGludCBpKSB7CiAgICAgICAgLy8gYmFzZSBjYXNlOiBh\nbGwgdmFyaWFibGVzIGhhdmUgYmVlbiBhbGlhc2VkOyBldmFsdWF0ZSBmb3Ig\nY3VycmVudAogICAgICAgIC8vIHZhbHVlcwogICAgICAgIGlmIChfdW5ib3Vu\nZHMgPT0gbnVsbCB8fCBpID09IF91bmJvdW5kcy5zaXplKCkpCiAgICAgICAg\nICAgIHJldHVybiBleHAuZXZhbHVhdGUoZ3JvdXAsIGN0eCwgcGFyYW1zKTsK\nCiAgICAgICAgLy8gZ3JhYiB0aGUgZXh0ZW50IGZvciB0aGlzIHZhcmlhYmxl\nCiAgICAgICAgVW5ib3VuZFZhcmlhYmxlIHZhciA9IChVbmJvdW5kVmFyaWFi\nbGUpIF91bmJvdW5kcy5nZXQoaSk7CiAgICAgICAgRXh0ZW50IGV4dGVudCA9\nIGN0eC5nZXRCcm9rZXIoKS5uZXdFeHRlbnQodmFyLmdldFR5cGUoKSwgdHJ1\nZSk7CiAgICAgICAgSXRlcmF0b3IgaXRyID0gZXh0ZW50Lml0ZXJhdG9yKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gaWYgdGhlIGV4dGVudCB3\nYXMgZW1wdHksIHRoZW4gYWxpYXMgdGhlIHZhcmlhYmxlIHRvIG51bGwKICAg\nICAgICAgICAgaWYgKCFpdHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAg\nICB2YXIuc2V0VmFsdWUobnVsbCk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nbWF0Y2hlcyhleHAsIGdyb3VwLCBjdHgsIHBhcmFtcywgaSArIDEpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICAvLyB0cnkgZXZlcnkgdmFsdWUsIHNo\nb3J0LWNpcmN1aXRpbmcgb24gbWF0Y2gKICAgICAgICAgICAgd2hpbGUgKGl0\nci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgdmFy\naWFibGUgdG8gZWFjaCBleHRlbnQgdmFsdWUgYW5kIHJlY3Vyc2UKICAgICAg\nICAgICAgICAgIHZhci5zZXRWYWx1ZShpdHIubmV4dCgpKTsKICAgICAgICAg\nICAgICAgIGlmIChtYXRjaGVzKGV4cCwgZ3JvdXAsIGN0eCwgcGFyYW1zLCBp\nICsgMSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIC8vIG5vIG1hdGNoCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBJbXBsSGVscGVyLmNsb3NlKGl0cik7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIHRoZSBwcm9qZWN0aW9ucyBmb3IgdGhlIGdp\ndmVuIHJlc3VsdHMuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0IHByb2plY3Qo\nUXVlcnlFeHByZXNzaW9ucyBleHBzLCBMaXN0IG1hdGNoZXMsCiAgICAgICAg\nU3RvcmVDb250ZXh0IGN0eCwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAg\naWYgKGV4cHMucHJvamVjdGlvbnMubGVuZ3RoID09IDApCiAgICAgICAgICAg\nIHJldHVybiBtYXRjaGVzOwoKICAgICAgICAvLyBpZiBhbiB1bmdyb3VwZWQg\nYWdncmVnYXRlLCBldmFsdWF0ZSB0aGUgd2hvbGUgbWF0Y2hlcyBsaXN0CiAg\nICAgICAgaWYgKGV4cHMuZ3JvdXBpbmcubGVuZ3RoID09IDAgJiYgZXhwcy5p\nc0FnZ3JlZ2F0ZSgpKSB7CiAgICAgICAgICAgIE9iamVjdFtdIHByb2plY3Rp\nb24gPSBwcm9qZWN0KG1hdGNoZXMsIGV4cHMsIHRydWUsIGN0eCwgcGFyYW1z\nKTsKICAgICAgICAgICAgcmV0dXJuIEFycmF5cy5hc0xpc3QobmV3IE9iamVj\ndFtdeyBwcm9qZWN0aW9uIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8gZXZh\nbHVhdGUgZWFjaCBjYW5kaWRhdGUKICAgICAgICBMaXN0IHByb2plY3RlZCA9\nIG5ldyBBcnJheUxpc3QobWF0Y2hlcy5zaXplKCkpOwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gbWF0Y2hlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykKICAgICAgICAgICAgcHJvamVjdGVkLmFkZChwcm9qZWN0KGl0ci5u\nZXh0KCksIGV4cHMsIGV4cHMuZ3JvdXBpbmcubGVuZ3RoID4gMCwKICAgICAg\nICAgICAgICAgIGN0eCwgcGFyYW1zKSk7CiAgICAgICAgcmV0dXJuIHByb2pl\nY3RlZDsKICAgIH0KCiAgICAvKioKICAgICAqIEdlbmVyYXRlIGEgcHJvamVj\ndGlvbiBvbiB0aGUgZ2l2ZW4gY2FuZGlkYXRlLgogICAgICovCiAgICBwcml2\nYXRlIE9iamVjdFtdIHByb2plY3QoT2JqZWN0IGNhbmRpZGF0ZSwgUXVlcnlF\neHByZXNzaW9ucyBleHBzLAogICAgICAgIGJvb2xlYW4gYWdnLCBTdG9yZUNv\nbnRleHQgY3R4LCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICBPYmplY3Rb\nXSBwcm9qZWN0aW9uID0gbmV3IE9iamVjdFtleHBzLnByb2plY3Rpb25zLmxl\nbmd0aAogICAgICAgICAgICArIGV4cHMub3JkZXJpbmcubGVuZ3RoXTsKCiAg\nICAgICAgLy8gY2FsY3VhbHRlIHJlc3VsdCB2YWx1ZXMKICAgICAgICBPYmpl\nY3QgcmVzdWx0ID0gbnVsbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGV4cHMucHJvamVjdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\naWYgKGFnZykKICAgICAgICAgICAgICAgIHJlc3VsdCA9ICgoVmFsKSBleHBz\nLnByb2plY3Rpb25zW2ldKS5ldmFsdWF0ZSgoQ29sbGVjdGlvbikKICAgICAg\nICAgICAgICAgICAgICBjYW5kaWRhdGUsIG51bGwsIGN0eCwgcGFyYW1zKTsK\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmVzdWx0ID0gKChW\nYWwpIGV4cHMucHJvamVjdGlvbnNbaV0pLmV2YWx1YXRlKGNhbmRpZGF0ZSwK\nICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUsIGN0eCwgcGFyYW1zKTsK\nICAgICAgICAgICAgcHJvamVjdGlvbltpXSA9IHJlc3VsdDsKICAgICAgICB9\nCgogICAgICAgIC8vIHRhY2sgb24gb3JkZXJpbmcgdmFsdWVzCiAgICAgICAg\nYm9vbGVhbiByZXBlYXQ7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBl\neHBzLm9yZGVyaW5nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vIGFs\ncmVhZHkgc2VsZWN0ZWQgYXMgYSByZXN1bHQ/CiAgICAgICAgICAgIHJlcGVh\ndCA9IGZhbHNlOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgIXJlcGVh\ndCAmJiBqIDwgZXhwcy5wcm9qZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAg\nICAgICAgICAgICAgaWYgKGV4cHMub3JkZXJpbmdDbGF1c2VzW2ldLmVxdWFs\ncyhleHBzLnByb2plY3Rpb25DbGF1c2VzW2pdKSkgewogICAgICAgICAgICAg\nICAgICAgIHJlc3VsdCA9IHByb2plY3Rpb25bal07CiAgICAgICAgICAgICAg\nICAgICAgcmVwZWF0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgLy8gbm90IHNlbGVjdGVkIGFzIHJlc3Vs\ndDsgY2FsY3VsYXRlIHZhbHVlCiAgICAgICAgICAgIGlmICghcmVwZWF0KSB7\nCiAgICAgICAgICAgICAgICBpZiAoYWdnKQogICAgICAgICAgICAgICAgICAg\nIHJlc3VsdCA9ICgoVmFsKSBleHBzLm9yZGVyaW5nW2ldKS5ldmFsdWF0ZSgo\nQ29sbGVjdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRl\nLCBudWxsLCBjdHgsIHBhcmFtcyk7CiAgICAgICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gKChWYWwpIGV4cHMub3JkZXJp\nbmdbaV0pLmV2YWx1YXRlKGNhbmRpZGF0ZSwKICAgICAgICAgICAgICAgICAg\nICAgICAgY2FuZGlkYXRlLCBjdHgsIHBhcmFtcyk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHByb2plY3Rpb25baSArIGV4cHMucHJvamVjdGlvbnMu\nbGVuZ3RoXSA9IHJlc3VsdDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBy\nb2plY3Rpb247CiAgICB9CgogICAgLyoqCiAgICAgKiBPcmRlciB0aGUgZ2l2\nZW4gbGlzdCBvZiBtYXRjaGVzIG9uIHRoZSBnaXZlbiB2YWx1ZS4KICAgICAq\nLwogICAgcHVibGljIExpc3Qgb3JkZXIoUXVlcnlFeHByZXNzaW9ucyBleHBz\nLCBMaXN0IG1hdGNoZXMsCiAgICAgICAgU3RvcmVDb250ZXh0IGN0eCwgT2Jq\nZWN0W10gcGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIG9yZGVyKGV4cHMsIGV4\ncHMub3JkZXJpbmcsIHRydWUsIG1hdGNoZXMsIGN0eCwgcGFyYW1zKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIE9yZGVyIHRoZSBnaXZlbiBsaXN0IG9mIG1h\ndGNoZXMgb24gdGhlIGdpdmVuIHZhbHVlLgogICAgICoKICAgICAqIEBwYXJh\nbSBwcm9qZWN0ZWQgd2hldGhlciBwcm9qZWN0aW9ucyBoYXZlIGJlZW4gYXBw\nbGllZCB0byB0aGUgbWF0Y2hlcyB5ZXQKICAgICAqLwogICAgcHJpdmF0ZSBM\naXN0IG9yZGVyKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywgVmFsdWVbXSBvcmRl\nclZhbHVlcywKICAgICAgICBib29sZWFuIHByb2plY3RlZCwgTGlzdCBtYXRj\naGVzLCBTdG9yZUNvbnRleHQgY3R4LCBPYmplY3RbXSBwYXJhbXMpIHsKICAg\nICAgICBpZiAobWF0Y2hlcyA9PSBudWxsIHx8IG1hdGNoZXMuaXNFbXB0eSgp\nCiAgICAgICAgICAgIHx8IG9yZGVyVmFsdWVzID09IG51bGwgfHwgb3JkZXJW\nYWx1ZXMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBtYXRjaGVz\nOwoKICAgICAgICBpbnQgcmVzdWx0cyA9IChwcm9qZWN0ZWQpID8gZXhwcy5w\ncm9qZWN0aW9ucy5sZW5ndGggOiAwOwogICAgICAgIGJvb2xlYW5bXSBhc2Mg\nPSAocHJvamVjdGVkKSA/IGV4cHMuYXNjZW5kaW5nIDogbnVsbDsKICAgICAg\nICBpbnQgaWR4OwogICAgICAgIGZvciAoaW50IGkgPSBvcmRlclZhbHVlcy5s\nZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICAvLyBpZiB0\naGlzIGlzIGEgcHJvamVjdGlvbiwgdGhlbiBpbiBwcm9qZWN0KCkgd2UgbXVz\ndCBoYXZlIHNlbGVjdGVkCiAgICAgICAgICAgIC8vIHRoZSBvcmRlcmluZyB2\nYWx1ZSBhbHJlYWR5IGFmdGVyIHRoZSBwcm9qZWN0aW9uIHZhbHVlcwogICAg\nICAgICAgICBpZHggPSAocmVzdWx0cyA+IDApID8gcmVzdWx0cyArIGkgOiAt\nMTsKICAgICAgICAgICAgQ29sbGVjdGlvbnMuc29ydChtYXRjaGVzLAogICAg\nICAgICAgICAgICAgbmV3IE9yZGVyVmFsdWVDb21wYXJhdG9yKChWYWwpIG9y\nZGVyVmFsdWVzW2ldLAogICAgICAgICAgICAgICAgICAgIGFzYyA9PSBudWxs\nIHx8IGFzY1tpXSwgaWR4LCBjdHgsIHBhcmFtcykpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbWF0Y2hlczsKICAgIH0KCiAgICAvKioKICAgICAqIEZp\nbHRlciB0aGUgZ2l2ZW4gbGlzdCBvZiBtYXRjaGVzLCByZW1vdmluZyBkdXBs\naWNhdGUgZW50cmllcy4KICAgICAqLwogICAgcHVibGljIExpc3QgZGlzdGlu\nY3QoUXVlcnlFeHByZXNzaW9ucyBleHBzLCBib29sZWFuIGZyb21FeHRlbnQs\nCiAgICAgICAgTGlzdCBtYXRjaGVzKSB7CiAgICAgICAgaWYgKG1hdGNoZXMg\nPT0gbnVsbCB8fCBtYXRjaGVzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0\ndXJuIG1hdGNoZXM7CgogICAgICAgIC8vIG5vIG5lZWQgdG8gZG8gZGlzdGlu\nY3QgaWYgbm90IGluc3RydWN0ZWQgdG8sIG9yIGlmIHRoZXNlIGFyZQogICAg\nICAgIC8vIGNhbmRpZGF0ZSBvYmplY3RzIGZyb20gYW4gZXh0ZW50CiAgICAg\nICAgaW50IGxlbiA9IGV4cHMucHJvamVjdGlvbnMubGVuZ3RoOwogICAgICAg\nIGlmICgoZXhwcy5kaXN0aW5jdCAmIGV4cHMuRElTVElOQ1RfVFJVRSkgPT0g\nMAogICAgICAgICAgICB8fCAoZnJvbUV4dGVudCAmJiBsZW4gPT0gMCkpCiAg\nICAgICAgICAgIHJldHVybiBtYXRjaGVzOwoKICAgICAgICBTZXQgc2VlbiA9\nIG5ldyBIYXNoU2V0KG1hdGNoZXMuc2l6ZSgpKTsKICAgICAgICBMaXN0IGRp\nc3RpbmN0ID0gbnVsbDsKICAgICAgICBPYmplY3QgY3VyOwogICAgICAgIE9i\namVjdCBrZXk7CiAgICAgICAgZm9yIChMaXN0SXRlcmF0b3IgbGkgPSBtYXRj\naGVzLmxpc3RJdGVyYXRvcigpOyBsaS5oYXNOZXh0KCk7KSB7CiAgICAgICAg\nICAgIGN1ciA9IGxpLm5leHQoKTsKICAgICAgICAgICAga2V5ID0gKGxlbiA+\nIDAgJiYgY3VyICE9IG51bGwpID8gbmV3IEFycmF5S2V5KChPYmplY3RbXSkg\nY3VyKSA6IGN1cjsKCiAgICAgICAgICAgIGlmIChzZWVuLmFkZChrZXkpKSB7\nCiAgICAgICAgICAgICAgICAvLyBrZXkgaGFzbid0IGJlZW4gc2VlbiBiZWZv\ncmU7IGlmIHdlJ3ZlIGNyZWF0ZWQgYSBkaXN0aW5jdAogICAgICAgICAgICAg\nICAgLy8gbGlzdCwga2VlcCBhZGRpbmcgdG8gaXQKICAgICAgICAgICAgICAg\nIGlmIChkaXN0aW5jdCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGRp\nc3RpbmN0LmFkZChjdXIpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGRpc3Rp\nbmN0ID09IG51bGwpIHsKICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8g\nY29weSB0aGUgbWF0Y2hlcyBsaXN0IGJlY2F1c2UgdGhlIGRpc3RpbmN0IGxp\nc3QKICAgICAgICAgICAgICAgIC8vIHdpbGwgYmUgZGlmZmVyZW50ICh3ZSd2\nZSBjb21lIGFjcm9zcyBhIG5vbi11bmlxdWUga2V5KTsgYWRkCiAgICAgICAg\nICAgICAgICAvLyBhbGwgdGhlIGVsZW1lbnRzIHdlJ3ZlIHNraXBwZWQgb3Zl\nciBzbyBmYXIKICAgICAgICAgICAgICAgIGRpc3RpbmN0ID0gbmV3IEFycmF5\nTGlzdChtYXRjaGVzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBkaXN0aW5j\ndC5hZGRBbGwobWF0Y2hlcy5zdWJMaXN0KDAsIGxpLnByZXZpb3VzSW5kZXgo\nKSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAo\nZGlzdGluY3QgPT0gbnVsbCkgPyBtYXRjaGVzIDogZGlzdGluY3Q7CiAgICB9\nCgogICAgcHVibGljIEV4cHJlc3Npb24gZW1wdHlFeHByZXNzaW9uKCkgewog\nICAgICAgIHJldHVybiBuZXcgRXhwKCk7CiAgICB9CgogICAgcHVibGljIEV4\ncHJlc3Npb24gYXNFeHByZXNzaW9uKFZhbHVlIHYpIHsKICAgICAgICByZXR1\ncm4gbmV3IFZhbEV4cHJlc3Npb24oKFZhbCkgdik7CiAgICB9CgogICAgcHVi\nbGljIEV4cHJlc3Npb24gZXF1YWwoVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBFcXVhbEV4cHJlc3Npb24oKFZhbCkgdjEsIChW\nYWwpIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBub3RFcXVh\nbChWYWx1ZSB2MSwgVmFsdWUgdjIpIHsKICAgICAgICByZXR1cm4gbmV3IE5v\ndEVxdWFsRXhwcmVzc2lvbigoVmFsKSB2MSwgKFZhbCkgdjIpOwogICAgfQoK\nICAgIHB1YmxpYyBFeHByZXNzaW9uIGxlc3NUaGFuKFZhbHVlIHYxLCBWYWx1\nZSB2MikgewogICAgICAgIHJldHVybiBuZXcgTGVzc1RoYW5FeHByZXNzaW9u\nKChWYWwpIHYxLCAoVmFsKSB2Mik7CiAgICB9CgogICAgcHVibGljIEV4cHJl\nc3Npb24gZ3JlYXRlclRoYW4oVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBHcmVhdGVyVGhhbkV4cHJlc3Npb24oKFZhbCkgdjEs\nIChWYWwpIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBsZXNz\nVGhhbkVxdWFsKFZhbHVlIHYxLCBWYWx1ZSB2MikgewogICAgICAgIHJldHVy\nbiBuZXcgTGVzc1RoYW5FcXVhbEV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwp\nIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBncmVhdGVyVGhh\nbkVxdWFsKFZhbHVlIHYxLCBWYWx1ZSB2MikgewogICAgICAgIHJldHVybiBu\nZXcgR3JlYXRlclRoYW5FcXVhbEV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwp\nIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBpc0VtcHR5KFZh\nbHVlIHYxKSB7CiAgICAgICAgcmV0dXJuIG5ldyBJc0VtcHR5RXhwcmVzc2lv\nbigoVmFsKSB2MSk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gaXNO\nb3RFbXB0eShWYWx1ZSB2MSkgewogICAgICAgIHJldHVybiBub3QoaXNFbXB0\neSh2MSkpOwogICAgfQoKICAgIHB1YmxpYyBFeHByZXNzaW9uIGNvbnRhaW5z\nKFZhbHVlIHYxLCBWYWx1ZSB2MikgewogICAgICAgIHJldHVybiBuZXcgQ29u\ndGFpbnNFeHByZXNzaW9uKChWYWwpIHYxLCAoVmFsKSB2Mik7CiAgICB9Cgog\nICAgcHVibGljIEV4cHJlc3Npb24gY29udGFpbnNLZXkoVmFsdWUgdjEsIFZh\nbHVlIHYyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb250YWluc0tleUV4cHJl\nc3Npb24oKFZhbCkgdjEsIChWYWwpIHYyKTsKICAgIH0KCiAgICBwdWJsaWMg\nRXhwcmVzc2lvbiBjb250YWluc1ZhbHVlKFZhbHVlIHYxLCBWYWx1ZSB2Mikg\newogICAgICAgIHJldHVybiBuZXcgQ29udGFpbnNWYWx1ZUV4cHJlc3Npb24o\nKFZhbCkgdjEsIChWYWwpIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUg\nZ2V0TWFwVmFsdWUoVmFsdWUgbWFwLCBWYWx1ZSBhcmcpIHsKICAgICAgICBy\nZXR1cm4gbmV3IEdldE1hcFZhbHVlKChWYWwpIG1hcCwgKFZhbCkgYXJnKTsK\nICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBpc0luc3RhbmNlKFZhbHVl\nIHYxLCBDbGFzcyBjKSB7CiAgICAgICAgcmV0dXJuIG5ldyBJbnN0YW5jZW9m\nRXhwcmVzc2lvbigoVmFsKSB2MSwgYyk7CiAgICB9CgogICAgcHVibGljIEV4\ncHJlc3Npb24gYW5kKEV4cHJlc3Npb24gZXhwMSwgRXhwcmVzc2lvbiBleHAy\nKSB7CiAgICAgICAgaWYgKGV4cDEgaW5zdGFuY2VvZiBCaW5kVmFyaWFibGVF\neHByZXNzaW9uKQogICAgICAgICAgICByZXR1cm4gbmV3IEJpbmRWYXJpYWJs\nZUFuZEV4cHJlc3Npb24oKEJpbmRWYXJpYWJsZUV4cHJlc3Npb24pIGV4cDEs\nCiAgICAgICAgICAgICAgICAoRXhwKSBleHAyKTsKICAgICAgICByZXR1cm4g\nbmV3IEFuZEV4cHJlc3Npb24oKEV4cCkgZXhwMSwgKEV4cCkgZXhwMik7CiAg\nICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gb3IoRXhwcmVzc2lvbiBleHAx\nLCBFeHByZXNzaW9uIGV4cDIpIHsKICAgICAgICByZXR1cm4gbmV3IE9yRXhw\ncmVzc2lvbigoRXhwKSBleHAxLCAoRXhwKSBleHAyKTsKICAgIH0KCiAgICBw\ndWJsaWMgRXhwcmVzc2lvbiBub3QoRXhwcmVzc2lvbiBleHApIHsKICAgICAg\nICByZXR1cm4gbmV3IE5vdEV4cHJlc3Npb24oKEV4cCkgZXhwKTsKICAgIH0K\nCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBiaW5kVmFyaWFibGUoVmFsdWUgdmFy\nLCBWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IEJpbmRWYXJpYWJs\nZUV4cHJlc3Npb24oKEJvdW5kVmFyaWFibGUpIHZhciwgKFZhbCkgdmFsKTsK\nICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBiaW5kS2V5VmFyaWFibGUo\nVmFsdWUgdmFyLCBWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IEJp\nbmRLZXlWYXJpYWJsZUV4cHJlc3Npb24oKEJvdW5kVmFyaWFibGUpIHZhciwg\nKFZhbCkgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBiaW5k\nVmFsdWVWYXJpYWJsZShWYWx1ZSB2YXIsIFZhbHVlIHZhbCkgewogICAgICAg\nIHJldHVybiBuZXcgQmluZFZhbHVlVmFyaWFibGVFeHByZXNzaW9uKChCb3Vu\nZFZhcmlhYmxlKSB2YXIsIChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGlj\nIEV4cHJlc3Npb24gZW5kc1dpdGgoVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBFbmRzV2l0aEV4cHJlc3Npb24oKFZhbCkgdjEs\nIChWYWwpIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBtYXRj\naGVzKFZhbHVlIHYxLCBWYWx1ZSB2MiwKICAgICAgICBTdHJpbmcgc2luZ2xl\nLCBTdHJpbmcgbXVsdGksIFN0cmluZyBlc2MpIHsKICAgICAgICByZXR1cm4g\nbmV3IE1hdGNoZXNFeHByZXNzaW9uKChWYWwpIHYxLCAoVmFsKSB2Miwgc2lu\nZ2xlLCBtdWx0aSwgZXNjLAogICAgICAgICAgICB0cnVlKTsKICAgIH0KCiAg\nICBwdWJsaWMgRXhwcmVzc2lvbiBub3RNYXRjaGVzKFZhbHVlIHYxLCBWYWx1\nZSB2MiwKICAgICAgICBTdHJpbmcgc2luZ2xlLCBTdHJpbmcgbXVsdGksIFN0\ncmluZyBlc2MpIHsKICAgICAgICByZXR1cm4gbmV3IE1hdGNoZXNFeHByZXNz\naW9uKChWYWwpIHYxLCAoVmFsKSB2Miwgc2luZ2xlLCBtdWx0aSwgZXNjLAog\nICAgICAgICAgICBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Np\nb24gc3RhcnRzV2l0aChWYWx1ZSB2MSwgVmFsdWUgdjIpIHsKICAgICAgICBy\nZXR1cm4gbmV3IFN0YXJ0c1dpdGhFeHByZXNzaW9uKChWYWwpIHYxLCAoVmFs\nKSB2Mik7CiAgICB9CgogICAgcHVibGljIFN1YnF1ZXJ5IG5ld1N1YnF1ZXJ5\nKENsYXNzTWV0YURhdGEgY2FuZGlkYXRlLCBib29sZWFuIHN1YnMsCiAgICAg\nICAgU3RyaW5nIGFsaWFzKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdWJRKGFs\naWFzKTsKICAgIH0KCiAgICBwdWJsaWMgUGF0aCBuZXdQYXRoKCkgewogICAg\nICAgIHJldHVybiBuZXcgQ2FuZGlkYXRlUGF0aCgpOwogICAgfQoKICAgIHB1\nYmxpYyBQYXRoIG5ld1BhdGgoVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBWYWx1ZVBhdGgoKFZhbCkgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMg\nTGl0ZXJhbCBuZXdMaXRlcmFsKE9iamVjdCB2YWwsIGludCBwYXJzZVR5cGUp\nIHsKICAgICAgICByZXR1cm4gbmV3IExpdCh2YWwsIHBhcnNlVHlwZSk7CiAg\nICB9CgogICAgcHVibGljIFZhbHVlIGdldFRoaXMoKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBUaGlzKCk7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGdldE51\nbGwoKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9CgogICAgcHVibGlj\nIFZhbHVlIGdldEN1cnJlbnREYXRlKCkgewogICAgICAgIHJldHVybiBDVVJS\nRU5UX0RBVEU7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGdldEN1cnJlbnRU\naW1lKCkgewogICAgICAgIHJldHVybiBDVVJSRU5UX0RBVEU7CiAgICB9Cgog\nICAgcHVibGljIFZhbHVlIGdldEN1cnJlbnRUaW1lc3RhbXAoKSB7CiAgICAg\nICAgcmV0dXJuIENVUlJFTlRfREFURTsKICAgIH0KCiAgICBwdWJsaWMgUGFy\nYW1ldGVyIG5ld1BhcmFtZXRlcihTdHJpbmcgbmFtZSwgQ2xhc3MgdHlwZSkg\newogICAgICAgIHJldHVybiBuZXcgUGFyYW0obmFtZSwgdHlwZSk7CiAgICB9\nCgogICAgcHVibGljIFZhbHVlIG5ld0V4dGVuc2lvbihGaWx0ZXJMaXN0ZW5l\nciBsaXN0ZW5lciwgVmFsdWUgdGFyZ2V0LAogICAgICAgIFZhbHVlIGFyZykg\newogICAgICAgIHJldHVybiBuZXcgRXh0ZW5zaW9uKGxpc3RlbmVyLCAoVmFs\nKSB0YXJnZXQsIChWYWwpIGFyZyk7CiAgICB9CgogICAgcHVibGljIFZhbHVl\nIG5ld0FnZ3JlZ2F0ZShBZ2dyZWdhdGVMaXN0ZW5lciBsaXN0ZW5lciwgVmFs\ndWUgYXJnKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBZ2dyZWdhdGUobGlzdGVu\nZXIsIChWYWwpIGFyZyk7CiAgICB9CgogICAgcHVibGljIEFyZ3VtZW50cyBu\nZXdBcmd1bWVudExpc3QoVmFsdWUgdmFsMSwgVmFsdWUgdmFsMikgewogICAg\nICAgIHJldHVybiBuZXcgQXJncyh2YWwxLCB2YWwyKTsKICAgIH0KCiAgICBw\ndWJsaWMgVmFsdWUgbmV3VW5ib3VuZFZhcmlhYmxlKFN0cmluZyBuYW1lLCBD\nbGFzcyB0eXBlKSB7CiAgICAgICAgVW5ib3VuZFZhcmlhYmxlIHZhciA9IG5l\ndyBVbmJvdW5kVmFyaWFibGUodHlwZSk7CiAgICAgICAgaWYgKF91bmJvdW5k\ncyA9PSBudWxsKQogICAgICAgICAgICBfdW5ib3VuZHMgPSBuZXcgQXJyYXlM\naXN0KDMpOwogICAgICAgIF91bmJvdW5kcy5hZGQodmFyKTsKICAgICAgICBy\nZXR1cm4gdmFyOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBuZXdCb3VuZFZh\ncmlhYmxlKFN0cmluZyBuYW1lLCBDbGFzcyB0eXBlKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBCb3VuZFZhcmlhYmxlKHR5cGUpOwogICAgfQoKICAgIHB1Ymxp\nYyBWYWx1ZSBjYXN0KFZhbHVlIHZhbCwgQ2xhc3MgY2xzKSB7CiAgICAgICAg\naWYgKHZhbCBpbnN0YW5jZW9mIENhbmRpZGF0ZVBhdGgpCiAgICAgICAgICAg\nICgoQ2FuZGlkYXRlUGF0aCkgdmFsKS5jYXN0VG8oY2xzKTsKICAgICAgICBl\nbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBCb3VuZFZhcmlhYmxlKQogICAgICAg\nICAgICAoKEJvdW5kVmFyaWFibGUpIHZhbCkuY2FzdFRvKGNscyk7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICB2YWwgPSBuZXcgQ2FzdCgoVmFsKSB2YWws\nIGNscyk7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KCiAgICBwdWJsaWMg\nVmFsdWUgYWRkKFZhbHVlIHZhbDEsIFZhbHVlIHZhbDIpIHsKICAgICAgICBy\nZXR1cm4gbmV3IEFkZCgoVmFsKSB2YWwxLCAoVmFsKSB2YWwyKTsKICAgIH0K\nCiAgICBwdWJsaWMgVmFsdWUgc3VidHJhY3QoVmFsdWUgdmFsMSwgVmFsdWUg\ndmFsMikgewogICAgICAgIHJldHVybiBuZXcgU3VidHJhY3QoKFZhbCkgdmFs\nMSwgKFZhbCkgdmFsMik7CiAgICB9CgogICAgcHVibGljIFZhbHVlIG11bHRp\ncGx5KFZhbHVlIHZhbDEsIFZhbHVlIHZhbDIpIHsKICAgICAgICByZXR1cm4g\nbmV3IE11bHRpcGx5KChWYWwpIHZhbDEsIChWYWwpIHZhbDIpOwogICAgfQoK\nICAgIHB1YmxpYyBWYWx1ZSBkaXZpZGUoVmFsdWUgdmFsMSwgVmFsdWUgdmFs\nMikgewogICAgICAgIHJldHVybiBuZXcgRGl2aWRlKChWYWwpIHZhbDEsIChW\nYWwpIHZhbDIpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBtb2QoVmFsdWUg\ndmFsMSwgVmFsdWUgdmFsMikgewogICAgICAgIHJldHVybiBuZXcgTW9kKChW\nYWwpIHZhbDEsIChWYWwpIHZhbDIpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1\nZSBhYnMoVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBYnMoKFZh\nbCkgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgaW5kZXhPZihWYWx1\nZSB2YWwxLCBWYWx1ZSB2YWwyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBJbmRl\neE9mKChWYWwpIHZhbDEsIChWYWwpIHZhbDIpOwogICAgfQoKICAgIHB1Ymxp\nYyBWYWx1ZSBjb25jYXQoVmFsdWUgdmFsMSwgVmFsdWUgdmFsMikgewogICAg\nICAgIHJldHVybiBuZXcgQ29uY2F0KChWYWwpIHZhbDEsIChWYWwpIHZhbDIp\nOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBzdHJpbmdMZW5ndGgoVmFsdWUg\nc3RyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdMZW5ndGgoKFZhbCkg\nc3RyKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgdHJpbShWYWx1ZSBzdHIs\nIFZhbHVlIHRyaW1DaGFyLCBCb29sZWFuIHdoZXJlKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBUcmltKChWYWwpIHN0ciwgKFZhbCkgdHJpbUNoYXIsIHdoZXJl\nKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgc3FydChWYWx1ZSB2YWwpIHsK\nICAgICAgICByZXR1cm4gbmV3IFNxcnQoKFZhbCkgdmFsKTsKICAgIH0KCiAg\nICBwdWJsaWMgVmFsdWUgc3Vic3RyaW5nKFZhbHVlIHZhbDEsIFZhbHVlIHZh\nbDIpIHsKICAgICAgICByZXR1cm4gbmV3IFN1YnN0cmluZygoVmFsKSB2YWwx\nLCAoVmFsKSB2YWwyKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgdG9VcHBl\nckNhc2UoVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBUb1VwcGVy\nQ2FzZSgoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSB0b0xv\nd2VyQ2FzZShWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IFRvTG93\nZXJDYXNlKChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGF2\nZyhWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IEF2ZygoVmFsKSB2\nYWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBjb3VudChWYWx1ZSB2YWwp\nIHsKICAgICAgICByZXR1cm4gbmV3IENvdW50KChWYWwpIHZhbCk7CiAgICB9\nCgogICAgcHVibGljIFZhbHVlIGRpc3RpbmN0KFZhbHVlIHZhbCkgewogICAg\nICAgIHJldHVybiBuZXcgRGlzdGluY3QoKFZhbCkgdmFsKTsKICAgIH0KCiAg\nICBwdWJsaWMgVmFsdWUgbWF4KFZhbHVlIHZhbCkgewogICAgICAgIHJldHVy\nbiBuZXcgTWF4KChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGljIFZhbHVl\nIG1pbihWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IE1pbigoVmFs\nKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBzdW0oVmFsdWUgdmFs\nKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdW0oKFZhbCkgdmFsKTsKICAgIH0K\nCiAgICBwdWJsaWMgVmFsdWUgYW55KFZhbHVlIHZhbCkgewogICAgICAgIHJl\ndHVybiBuZXcgQW55KChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGljIFZh\nbHVlIGFsbChWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IEFsbCgo\nVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBzaXplKFZhbHVl\nIHZhbCkgewogICAgICAgIHJldHVybiBuZXcgU2l6ZSgoVmFsKSB2YWwpOwog\nICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBnZXRPYmplY3RJZChWYWx1ZSB2YWwp\nIHsKICAgICAgICByZXR1cm4gbmV3IEdldE9iamVjdElkKChWYWwpIHZhbCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBLZXkgdGhhdCBpbXBsZW1lbnRzIGhh\nc2hDb2RlIGFuZCBlcXVhbHMgbWV0aG9kcyBmb3Igb2JqZWN0IGFycmF5cy4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQXJyYXlLZXkgewoK\nICAgICAgICBwcml2YXRlIGZpbmFsIE9iamVjdFtdIF9hcnI7CgogICAgICAg\nIHB1YmxpYyBBcnJheUtleShPYmplY3RbXSBhcnIpIHsKICAgICAgICAgICAg\nX2FyciA9IGFycjsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgaGFz\naENvZGUoKSB7CiAgICAgICAgICAgIGludCBycyA9IDE3OwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IF9hcnIubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICBycyA9IDM3ICogcnMgKyAoKF9hcnJbaV0gPT0gbnVsbCkg\nPyAwIDogX2FycltpXS5oYXNoQ29kZSgpKTsKICAgICAgICAgICAgcmV0dXJu\nIHJzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gZXF1YWxz\nKE9iamVjdCBvdGhlcikgewogICAgICAgICAgICBpZiAob3RoZXIgPT0gdGhp\ncykKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICBp\nZiAob3RoZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKCiAgICAgICAgICAgIE9iamVjdFtdIGFyciA9ICgoQXJyYXlLZXkpIG90\naGVyKS5fYXJyOwogICAgICAgICAgICBpZiAoX2Fyci5sZW5ndGggIT0gYXJy\nLmxlbmd0aCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfYXJyLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICAgICAgaWYgKCFPYmplY3RVdGlscy5lcXVhbHMoX2Fycltp\nXSwgYXJyW2ldKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIENvbXBhcmF0b3IgdGhhdCB1c2VzIHRoZSByZXN1bHQg\nb2YgZXZhbCdpbmcgYSBWYWx1ZSB0byBzb3J0IG9uLiBOdWxsCiAgICAgKiB2\nYWx1ZXMgYXJlIHBsYWNlZCBsYXN0IGlmIHNvcnRpbmcgaW4gYXNjZW5kaW5n\nIG9yZGVyLCBmaXJzdCBpZgogICAgICogZGVzY2VuZGluZy4KICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgT3JkZXJWYWx1ZUNvbXBhcmF0b3IK\nICAgICAgICBpbXBsZW1lbnRzIENvbXBhcmF0b3IgewoKICAgICAgICBwcml2\nYXRlIGZpbmFsIFN0b3JlQ29udGV4dCBfY3R4OwogICAgICAgIHByaXZhdGUg\nZmluYWwgVmFsIF92YWw7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBib29sZWFu\nIF9hc2M7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBpbnQgX2lkeDsKICAgICAg\nICBwcml2YXRlIGZpbmFsIE9iamVjdFtdIF9wYXJhbXM7CgogICAgICAgIHBy\naXZhdGUgT3JkZXJWYWx1ZUNvbXBhcmF0b3IoVmFsIHZhbCwgYm9vbGVhbiBh\nc2MsIGludCBpZHgsCiAgICAgICAgICAgIFN0b3JlQ29udGV4dCBjdHgsIE9i\namVjdFtdIHBhcmFtcykgewogICAgICAgICAgICBfY3R4ID0gY3R4OwogICAg\nICAgICAgICBfdmFsID0gdmFsOwogICAgICAgICAgICBfYXNjID0gYXNjOwog\nICAgICAgICAgICBfaWR4ID0gaWR4OwogICAgICAgICAgICBfcGFyYW1zID0g\ncGFyYW1zOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBjb21wYXJl\nKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7CiAgICAgICAgICAgIGlmIChfaWR4\nICE9IC0xKSB7CiAgICAgICAgICAgICAgICBvMSA9ICgoT2JqZWN0W10pIG8x\nKVtfaWR4XTsKICAgICAgICAgICAgICAgIG8yID0gKChPYmplY3RbXSkgbzIp\nW19pZHhdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nbzEgPSBfdmFsLmV2YWx1YXRlKG8xLCBvMSwgX2N0eCwgX3BhcmFtcyk7CiAg\nICAgICAgICAgICAgICBvMiA9IF92YWwuZXZhbHVhdGUobzIsIG8yLCBfY3R4\nLCBfcGFyYW1zKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG8x\nID09IG51bGwgJiYgbzIgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVy\nbiAwOwogICAgICAgICAgICBpZiAobzEgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgIHJldHVybiAoX2FzYykgPyAxIDogLTE7CiAgICAgICAgICAgIGlmIChv\nMiA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIChfYXNjKSA/IC0x\nIDogMTsKCiAgICAgICAgICAgIGlmIChvMSBpbnN0YW5jZW9mIEJvb2xlYW4g\nJiYgbzIgaW5zdGFuY2VvZiBCb29sZWFuKSB7CiAgICAgICAgICAgICAgICBp\nbnQgaTEgPSAoKEJvb2xlYW4pIG8xKS5ib29sZWFuVmFsdWUoKSA/IDEgOiAw\nOwogICAgICAgICAgICAgICAgaW50IGkyID0gKChCb29sZWFuKSBvMikuYm9v\nbGVhblZhbHVlKCkgPyAxIDogMDsKICAgICAgICAgICAgICAgIHJldHVybiBp\nMSAtIGkyOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgaWYgKF9hc2MpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuICgoQ29tcGFyYWJsZSkgbzEpLmNvbXBhcmVUbyhvMik7CiAgICAgICAg\nICAgICAgICByZXR1cm4gKChDb21wYXJhYmxlKSBvMikuY29tcGFyZVRvKG8x\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoQ2xhc3NDYXN0RXhjZXB0aW9uIGNj\nZSkgewogICAgICAgICAgICAgICAgTG9jYWxpemVyIGxvYyA9IExvY2FsaXpl\nci5mb3JQYWNrYWdlCiAgICAgICAgICAgICAgICAgICAgKEluTWVtb3J5RXhw\ncmVzc2lvbkZhY3RvcnkuY2xhc3MpOwogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24obG9jLmdldCgibm90LWNvbXAiLCBvMSwgbzIp\nKTsKCQkJfQoJCX0KCX0KfQo=\n","encoding":"base64"}

