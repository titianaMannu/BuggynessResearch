{"sha":"de572f5b74e700bfb032acadee5f7ee6b2166d37","node_id":"MDQ6QmxvYjIwNjM2NDpkZTU3MmY1Yjc0ZTcwMGJmYjAzMmFjYWRlZTVmN2VlNmIyMTY2ZDM3","size":27159,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/de572f5b74e700bfb032acadee5f7ee6b2166d37","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhOwoKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGph\ndmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5NYWxmb3JtZWRV\nUkxFeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5VUkw7CmltcG9ydCBqYXZh\nLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEu\ndXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQg\namF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBq\nYXZhLnV0aWwuemlwLlppcEZpbGU7CmltcG9ydCBqYXZhLnV0aWwuemlwLlpp\ncElucHV0U3RyZWFtOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5n\nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5t\nZXRhLkNsYXNzQXJnUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5tZXRhLkNsYXNzcGF0aE1ldGFEYXRhSXRlcmF0b3I7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuRmlsZU1ldGFEYXRhSXRlcmF0\nb3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuTWV0YURh\ndGFGaWx0ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEu\nTWV0YURhdGFJdGVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIubWV0YS5NZXRhRGF0YVBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIubWV0YS5NZXRhRGF0YVNlcmlhbGl6ZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuUmVzb3VyY2VNZXRhRGF0YUl0ZXJh\ndG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLlVSTE1l\ndGFEYXRhSXRlcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLm1ldGEuWmlwRmlsZU1ldGFEYXRhSXRlcmF0b3I7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLm1ldGEuWmlwU3RyZWFtTWV0YURhdGFJdGVyYXRv\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5GaWxlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5HZW5lcmFsRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2Vw\ndGlvbjsKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIEJhc2Ug\nY2xhc3MgZm9yIGZhY3RvcnkgaW1wbGVtZW50YXRpb25zIGJ1aWx0IGFyb3Vu\nZCBYTUwgbWV0YWRhdGEgZmlsZXMKICogaW4gdGhlIGNvbW1vbiBmb21hdC4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQHNpbmNlIDAuNC4wCiAqLwpw\ndWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RDRk1ldGFEYXRhRmFjdG9y\neQogICAgZXh0ZW5kcyBBYnN0cmFjdE1ldGFEYXRhRmFjdG9yeSB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChBYnN0cmFjdE1ldGFEYXRhRmFjdG9y\neS5jbGFzcyk7CgogICAgcHJvdGVjdGVkIENvbGxlY3Rpb24gZmlsZXMgPSBu\ndWxsOwogICAgcHJvdGVjdGVkIENvbGxlY3Rpb24gdXJscyA9IG51bGw7CiAg\nICBwcm90ZWN0ZWQgQ29sbGVjdGlvbiByc3JjcyA9IG51bGw7CiAgICBwcm90\nZWN0ZWQgQ29sbGVjdGlvbiBjcGF0aCA9IG51bGw7CgogICAgcHJpdmF0ZSBT\nZXQgX3R5cGVOYW1lcyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBTZXQgb2Yg\ne0BsaW5rIEZpbGV9cyBvZiBtZXRhZGF0YSBmaWxlcyBvciBkaXJlY3Rvcmll\ncyBzdXBwbGllZCBieSB1c2VyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRGaWxlcyhDb2xsZWN0aW9uIGZpbGVzKSB7CiAgICAgICAgdGhpcy5maWxl\ncyA9IGZpbGVzOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IG9mIHNlbWlj\nb2xvbi1zZXBhcmF0ZWQge0BsaW5rIEZpbGV9cyBvZiBtZXRhZGF0YSBmaWxl\ncyBvcgogICAgICogZGlyZWN0b3JpZXMgc3VwcGxpZWQgYnkgdXNlciB2aWEg\nYXV0by1jb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRGaWxlcyhTdHJpbmcgZmlsZXMpIHsKICAgICAgICBpZiAoU3RyaW5nVXRp\nbHMuaXNFbXB0eShmaWxlcykpCiAgICAgICAgICAgIHRoaXMuZmlsZXMgPSBu\ndWxsOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBTdHJpbmdbXSBzdHJz\nID0gU3RyaW5ncy5zcGxpdChmaWxlcywgIjsiLCAwKTsKICAgICAgICAgICAg\ndGhpcy5maWxlcyA9IG5ldyBIYXNoU2V0KChpbnQpIChzdHJzLmxlbmd0aCAq\nIDEuMzMgKyAxKSk7CgogICAgICAgICAgICBGaWxlIGZpbGU7CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Rycy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICAgICAgZmlsZSA9IG5ldyBGaWxlKHN0cnNbaV0pOwogICAg\nICAgICAgICAgICAgaWYgKGZpbGUuZXhpc3RzKCkpCiAgICAgICAgICAgICAg\nICAgICAgdGhpcy5maWxlcy5hZGQoZmlsZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgb2Yge0BsaW5rIFVS\nTH1zIG9mIG1ldGFkYXRhIGZpbGVzIG9yIGphcnMgc3VwcGxpZWQgYnkgdXNl\nci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VVJMcyhDb2xsZWN0aW9u\nIHVybHMpIHsKICAgICAgICB0aGlzLnVybHMgPSB1cmxzOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IG9mIHNlbWljb2xvbi1zZXBhcmF0ZWQge0BsaW5r\nIFVSTH1zIG9mIG1ldGFkYXRhIGZpbGVzIG9yIGphcnMKICAgICAqIHN1cHBs\naWVkIGJ5IHVzZXIgdmlhIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0VVJMcyhTdHJpbmcgdXJscykgewogICAgICAg\nIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHVybHMpKQogICAgICAgICAgICB0\naGlzLnVybHMgPSBudWxsOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBT\ndHJpbmdbXSBzdHJzID0gU3RyaW5ncy5zcGxpdCh1cmxzLCAiOyIsIDApOwog\nICAgICAgICAgICB0aGlzLnVybHMgPSBuZXcgSGFzaFNldCgoaW50KSAoc3Ry\ncy5sZW5ndGggKiAxLjMzICsgMSkpOwogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHJzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICAgICAgICAgIHRoaXMudXJscy5hZGQobmV3IFVS\nTChzdHJzW2ldKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE1hbGZvcm1lZFVS\nTEV4Y2VwdGlvbiBtdWUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBV\nc2VyRXhjZXB0aW9uKG11ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgb2YgcmVzb3VyY2UgcGF0aHMgb2Yg\nbWV0YWRhdGEgZmlsZXMgb3IgamFycyBzdXBwbGllZCBieSB1c2VyLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZXNvdXJjZXMoQ29sbGVjdGlvbiBy\nc3JjcykgewogICAgICAgIHRoaXMucnNyY3MgPSByc3JjczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCBvZiBzZW1pY29sb24tc2VwYXJhdGVkIHJlc291\ncmNlIHBhdGhzIG9mIG1ldGFkYXRhIGZpbGVzIG9yIGphcnMKICAgICAqIHN1\ncHBsaWVkIGJ5IHVzZXIgdmlhIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0UmVzb3VyY2VzKFN0cmluZyByc3Jjcykg\newogICAgICAgIC8vIGtlZXAgbGlzdCBtdXRhYmxlIHNvIHN1YmNsYXNzZXMg\nY2FuIGFkZCBpbXBsaWNpdCBsb2NhdGlvbnMKICAgICAgICB0aGlzLnJzcmNz\nID0gKFN0cmluZ1V0aWxzLmlzRW1wdHkocnNyY3MpKSA/IG51bGwKICAgICAg\nICAgICAgOiBuZXcgQXJyYXlMaXN0KEFycmF5cy5hc0xpc3QoU3RyaW5ncy5z\ncGxpdChyc3JjcywgIjsiLCAwKSkpOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IG9mIGNsYXNzcGF0aCBkaXJlY3RvcmllcyBvciBqYXJzIHRvIHNjYW4g\nZm9yIG1ldGFkYXRhIHN1cHBsaWVkCiAgICAgKiBieSB1c2VyLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRDbGFzc3BhdGhTY2FuKENvbGxlY3Rpb24g\nY3BhdGgpIHsKICAgICAgICB0aGlzLmNwYXRoID0gY3BhdGg7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgb2YgY2xhc3NwYXRoIGRpcmVjdG9yaWVzIG9y\nIGphcnMgdG8gc2NhbiBmb3IgbWV0YWRhdGEgc3VwcGxpZWQKICAgICAqIGJ5\nIHVzZXIgdmlhIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0Q2xhc3NwYXRoU2NhbihTdHJpbmcgY3BhdGgpIHsKICAg\nICAgICAvLyBrZWVwIGxpc3QgbXV0YWJsZSBzbyBzdWJjbGFzc2VzIGNhbiBh\nZGQgaW1wbGljaXQgbG9jYXRpb25zCiAgICAgICAgdGhpcy5jcGF0aCA9IChT\ndHJpbmdVdGlscy5pc0VtcHR5KGNwYXRoKSkgPyBudWxsCiAgICAgICAgICAg\nIDogbmV3IEFycmF5TGlzdChBcnJheXMuYXNMaXN0KFN0cmluZ3Muc3BsaXQo\nY3BhdGgsICI7IiwgMCkpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBz\ndG9yZShDbGFzc01ldGFEYXRhW10gbWV0YXMsIFF1ZXJ5TWV0YURhdGFbXSBx\ndWVyaWVzLAogICAgICAgIFNlcXVlbmNlTWV0YURhdGFbXSBzZXFzLCBpbnQg\nbW9kZSwgTWFwIG91dHB1dCkgewogICAgICAgIGlmIChtb2RlID09IE1PREVf\nTk9ORSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKGlz\nTWFwcGluZ09ubHlGYWN0b3J5KCkgJiYgKG1vZGUgJiBNT0RFX01BUFBJTkcp\nID09IDApCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBpZiAo\nIXN0cmljdCAmJiAobW9kZSAmIE1PREVfTUVUQSkgIT0gMCkKICAgICAgICAg\nICAgbW9kZSB8PSBNT0RFX01BUFBJTkc7CiAgICAgICAgQ2xhc3MgY2xzID0g\nKG1ldGFzLmxlbmd0aCA9PSAwKSA/IG51bGwgOiBtZXRhc1swXS5nZXREZXNj\ncmliZWRUeXBlKCk7CiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyID0gcmVw\nb3MuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAgICBnZXRDbGFzc1Jl\nc29sdmVySW5zdGFuY2UoKS5nZXRDbGFzc0xvYWRlcihjbHMsIG51bGwpOwog\nICAgICAgIE1hcCBjbHNOYW1lcyA9IG5ldyBIYXNoTWFwKChpbnQpIChtZXRh\ncy5sZW5ndGggKiAxLjMzICsgMSkpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbWV0YXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNsc05hbWVz\nLnB1dChtZXRhc1tpXS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpLCBt\nZXRhc1tpXSk7CgogICAgICAgIC8vIGFzc2lnbiBkZWZhdWx0IGZpbGVzIGlm\nIGluIG1ldGFkYXRhIG1vZGUgKGluIG90aGVyIG1vZGVzIHdlIGFzc3VtZQog\nICAgICAgIC8vIHRoZSBmaWxlcyB3b3VsZCBoYXZlIHRvIGJlIHJlYWQgYWxy\nZWFkeSB0byBjcmVhdGUgdGhlIG1ldGFkYXRhcykKICAgICAgICBTZXQgbWV0\nYUZpbGVzID0gbnVsbDsKICAgICAgICBTZXQgcXVlcnlGaWxlcyA9IG51bGw7\nCiAgICAgICAgaWYgKGlzTWFwcGluZ09ubHlGYWN0b3J5KCkgfHwgKG1vZGUg\nJiBNT0RFX01FVEEpICE9IDApCiAgICAgICAgICAgIG1ldGFGaWxlcyA9IGFz\nc2lnbkRlZmF1bHRNZXRhRGF0YUZpbGVzKG1ldGFzLCBxdWVyaWVzLCBzZXFz\nLCBtb2RlLAogICAgICAgICAgICAgICAgY2xzTmFtZXMpOwogICAgICAgIGlm\nICghaXNNYXBwaW5nT25seUZhY3RvcnkoKSAmJiAobW9kZSAmIE1PREVfUVVF\nUlkpICE9IDApCiAgICAgICAgICAgIHF1ZXJ5RmlsZXMgPSBhc3NpZ25EZWZh\ndWx0UXVlcnlGaWxlcyhxdWVyaWVzLCBjbHNOYW1lcyk7CgogICAgICAgIC8v\nIHBhcnNlIGFsbCBmaWxlcyB0byBiZSBzdXJlIHdlIGRvbid0IGRlbGV0ZSBl\neGlzdGluZyBtZXRhZGF0YSB3aGVuCiAgICAgICAgLy8gd3JpdGluZyBvdXQg\nbmV3IG1ldGFkYXRhLCB0aGVuIHNlcmlhbGl6ZQogICAgICAgIFNlcmlhbGl6\nZXIgc2VyOwogICAgICAgIFBhcnNlciBwYXJzZXI7CiAgICAgICAgaWYgKG1v\nZGUgIT0gTU9ERV9RVUVSWSkgewogICAgICAgICAgICBpbnQgc2VybW9kZSA9\nIChpc01hcHBpbmdPbmx5RmFjdG9yeSgpKSA/IG1vZGUgOiBtb2RlIHwgTU9E\nRV9NRVRBOwogICAgICAgICAgICBzZXIgPSBuZXdTZXJpYWxpemVyKCk7CiAg\nICAgICAgICAgIHNlci5zZXRNb2RlKHNlcm1vZGUpOwogICAgICAgICAgICBp\nZiAobWV0YUZpbGVzICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHBhcnNl\nciA9IG5ld1BhcnNlcihmYWxzZSk7CiAgICAgICAgICAgICAgICBwYXJzZXIu\nc2V0TW9kZShzZXJtb2RlKTsKICAgICAgICAgICAgICAgIHBhcnNlci5zZXRD\nbGFzc0xvYWRlcihsb2FkZXIpOwogICAgICAgICAgICAgICAgcGFyc2UocGFy\nc2VyLCBtZXRhRmlsZXMpOwoKICAgICAgICAgICAgICAgIE1ldGFEYXRhUmVw\nb3NpdG9yeSBwciA9IHBhcnNlci5nZXRSZXBvc2l0b3J5KCk7CiAgICAgICAg\nICAgICAgICBwci5zZXRTb3VyY2VNb2RlKG1vZGUpOwogICAgICAgICAgICAg\nICAgaWYgKGlzTWFwcGluZ09ubHlGYWN0b3J5KCkpCiAgICAgICAgICAgICAg\nICAgICAgcHIuc2V0UmVzb2x2ZShNT0RFX05PTkUpOwogICAgICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHByLnNldFJlc29sdmUoTU9E\nRV9NQVBQSU5HLCBmYWxzZSk7CiAgICAgICAgICAgICAgICBzZXIuYWRkQWxs\nKHByKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBtZXRhcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIHNl\nci5hZGRNZXRhRGF0YShtZXRhc1tpXSk7CiAgICAgICAgICAgIGlmICgobW9k\nZSAmIE1PREVfTUFQUElORykgIT0gMCkKICAgICAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgc2Vxcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgICAgICBzZXIuYWRkU2VxdWVuY2VNZXRhRGF0YShzZXFzW2ldKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBxdWVyaWVzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICAgICAgaWYgKHF1ZXJpZXNbaV0uZ2V0U291cmNl\nTW9kZSgpICE9IE1PREVfUVVFUlkKICAgICAgICAgICAgICAgICAgICAmJiAo\ncXVlcmllc1tpXS5nZXRTb3VyY2VNb2RlKCkgJiBtb2RlKSAhPSAwKQogICAg\nICAgICAgICAgICAgICAgIHNlci5hZGRRdWVyeU1ldGFEYXRhKHF1ZXJpZXNb\naV0pOwoKICAgICAgICAgICAgaW50IGZsYWdzID0gc2VyLlBSRVRUWTsKICAg\nICAgICAgICAgaWYgKChzdG9yZSAmIFNUT1JFX1ZFUkJPU0UpICE9IDApCiAg\nICAgICAgICAgICAgICBmbGFncyB8PSBzZXIuVkVSQk9TRTsKICAgICAgICAg\nICAgc2VyaWFsaXplKHNlciwgb3V0cHV0LCBmbGFncyk7CiAgICAgICAgfQoK\nICAgICAgICAvLyBkbyB3ZSBoYXZlIGFueSBxdWVyaWVzIHN0b3JlZCBpbiBx\ndWVyeSBmaWxlcz8KICAgICAgICBpZiAoIWlzTWFwcGluZ09ubHlGYWN0b3J5\nKCkpIHsKICAgICAgICAgICAgYm9vbGVhbiBxRmlsZXMgPSBxdWVyeUZpbGVz\nICE9IG51bGw7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyAhcUZpbGVz\nICYmIGkgPCBxdWVyaWVzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAg\ncUZpbGVzID0gcXVlcmllc1tpXS5nZXRTb3VyY2VNb2RlKCkgPT0gTU9ERV9R\nVUVSWTsKICAgICAgICAgICAgaWYgKHFGaWxlcykgewogICAgICAgICAgICAg\nICAgc2VyID0gbmV3U2VyaWFsaXplcigpOwogICAgICAgICAgICAgICAgc2Vy\nLnNldE1vZGUoTU9ERV9RVUVSWSk7CiAgICAgICAgICAgICAgICBpZiAocXVl\ncnlGaWxlcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgcGFyc2Vy\nID0gbmV3UGFyc2VyKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBwYXJz\nZXIuc2V0TW9kZShNT0RFX1FVRVJZKTsKICAgICAgICAgICAgICAgICAgICBw\nYXJzZXIuc2V0Q2xhc3NMb2FkZXIobG9hZGVyKTsKICAgICAgICAgICAgICAg\nICAgICBwYXJzZShwYXJzZXIsIHF1ZXJ5RmlsZXMpOwogICAgICAgICAgICAg\nICAgICAgIHNlci5hZGRBbGwocGFyc2VyLmdldFJlcG9zaXRvcnkoKSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAg\nICAgaWYgKHF1ZXJpZXNbaV0uZ2V0U291cmNlTW9kZSgpID09IE1PREVfUVVF\nUlkpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlci5hZGRRdWVyeU1ldGFE\nYXRhKHF1ZXJpZXNbaV0pOwogICAgICAgICAgICAgICAgc2VyaWFsaXplKHNl\nciwgb3V0cHV0LCBzZXIuUFJFVFRZKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBkcm9wKENsYXNzW10gY2xzLCBpbnQgbW9kZSwgQ2xhc3NMb2FkZXIg\nZW52TG9hZGVyKSB7CiAgICAgICAgaWYgKG1vZGUgPT0gTU9ERV9OT05FKQog\nICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoaXNNYXBwaW5n\nT25seUZhY3RvcnkoKSAmJiAobW9kZSAmIE1PREVfTUFQUElORykgPT0gMCkK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIFBhcnNlciBwYXJz\nZXIgPSBuZXdQYXJzZXIoZmFsc2UpOwogICAgICAgIE1ldGFEYXRhUmVwb3Np\ndG9yeSBwciA9IHBhcnNlci5nZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcHIu\nc2V0U291cmNlTW9kZShNT0RFX01BUFBJTkcsIGZhbHNlKTsKICAgICAgICBw\nci5zZXRSZXNvbHZlKE1PREVfTUFQUElORywgZmFsc2UpOwoKICAgICAgICAv\nLyBwYXJzZSBtZXRhZGF0YSBmb3IgYWxsIHRoZXNlIGNsYXNzZXMKICAgICAg\nICBpZiAoKG1vZGUgJiAoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HKSkgIT0g\nMCkgewogICAgICAgICAgICBwYXJzZXIuc2V0TW9kZSgoaXNNYXBwaW5nT25s\neUZhY3RvcnkoKSkgPyBtb2RlCiAgICAgICAgICAgICAgICA6IE1PREVfTUVU\nQSB8IE1PREVfTUFQUElORyB8IE1PREVfUVVFUlkpOwogICAgICAgICAgICBw\nYXJzZShwYXJzZXIsIGNscyk7CiAgICAgICAgfQogICAgICAgIGlmICghaXNN\nYXBwaW5nT25seUZhY3RvcnkoKSAmJiAobW9kZSAmIE1PREVfUVVFUlkpICE9\nIDApIHsKICAgICAgICAgICAgcGFyc2VyLnNldE1vZGUoTU9ERV9RVUVSWSk7\nCiAgICAgICAgICAgIHBhcnNlKHBhcnNlciwgY2xzKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIHJlbW92ZSBtZXRhZGF0YXMgZnJvbSByZXBvc2l0b3J5IG9y\nIGNsZWFyIHRoZWlyIG1hcHBpbmdzCiAgICAgICAgU2V0IGZpbGVzID0gbmV3\nIEhhc2hTZXQoKTsKICAgICAgICBTZXQgY2xzTmFtZXMgPSBudWxsOwogICAg\nICAgIGlmICgobW9kZSAmIChNT0RFX01FVEEgfCBNT0RFX01BUFBJTkcpKSAh\nPSAwKSB7CiAgICAgICAgICAgIGNsc05hbWVzID0gbmV3IEhhc2hTZXQoKGlu\ndCkgKGNscy5sZW5ndGggKiAxLjMzICsgMSkpOwogICAgICAgICAgICBDbGFz\nc01ldGFEYXRhIG1ldGE7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgY2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoY2xz\nW2ldID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY2xzTmFtZXMuYWRk\nKG51bGwpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nICAgIGNsc05hbWVzLmFkZChjbHNbaV0uZ2V0TmFtZSgpKTsKICAgICAgICAg\nICAgICAgIG1ldGEgPSBwci5nZXRNZXRhRGF0YShjbHNbaV0sIGVudkxvYWRl\nciwgZmFsc2UpOwogICAgICAgICAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgICAgIGlmIChnZXRTb3VyY2VGaWxlKG1ldGEp\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzLmFkZChn\nZXRTb3VyY2VGaWxlKG1ldGEpKTsKICAgICAgICAgICAgICAgICAgICBpZiAo\nKG1vZGUgJiBNT0RFX01FVEEpICE9IDApCiAgICAgICAgICAgICAgICAgICAg\nICAgIHByLnJlbW92ZU1ldGFEYXRhKG1ldGEpOwogICAgICAgICAgICAgICAg\nICAgIGVsc2UgaWYgKCFpc01hcHBpbmdPbmx5RmFjdG9yeSgpKQogICAgICAg\nICAgICAgICAgICAgICAgICBjbGVhck1hcHBpbmcobWV0YSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8v\nIHJlbW92ZSBxdWVyeSBtb2RlIG1ldGFkYXRhcyBzbyB3ZSBjYW4gc3RvcmUg\ndGhlbSBzZXBhcmF0ZWx5CiAgICAgICAgUXVlcnlNZXRhRGF0YVtdIHF1ZXJp\nZXMgPSBwci5nZXRRdWVyeU1ldGFEYXRhcygpOwogICAgICAgIExpc3QgcXFz\nID0gKCFpc01hcHBpbmdPbmx5RmFjdG9yeSgpICYmIChtb2RlICYgTU9ERV9R\nVUVSWSkgPT0gMCkKICAgICAgICAgICAgPyBudWxsIDogbmV3IEFycmF5TGlz\ndCgpOwogICAgICAgIGJvb2xlYW4gcmVtOwogICAgICAgIENsYXNzIGRlZjsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKCFpc01hcHBpbmdPbmx5RmFjdG9yeSgp\nICYmIHF1ZXJpZXNbaV0uZ2V0U291cmNlRmlsZSgpICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBmaWxlcy5hZGQocXVlcmllc1tpXS5nZXRTb3VyY2VGaWxl\nKCkpOwogICAgICAgICAgICBkZWYgPSBxdWVyaWVzW2ldLmdldERlZmluaW5n\nVHlwZSgpOwogICAgICAgICAgICByZW0gPSAocXVlcmllc1tpXS5nZXRTb3Vy\nY2VNb2RlKCkgJiBtb2RlKSAhPSAwCiAgICAgICAgICAgICAgICAmJiBjbHNO\nYW1lcy5jb250YWlucygoZGVmID09IG51bGwpID8gbnVsbCA6IGRlZi5nZXRO\nYW1lKCkpOwogICAgICAgICAgICBpZiAocmVtIHx8ICghaXNNYXBwaW5nT25s\neUZhY3RvcnkoKQogICAgICAgICAgICAgICAgJiYgcXVlcmllc1tpXS5nZXRT\nb3VyY2VNb2RlKCkgPT0gTU9ERV9RVUVSWSkpCiAgICAgICAgICAgICAgICBw\nci5yZW1vdmVRdWVyeU1ldGFEYXRhKHF1ZXJpZXNbaV0pOwogICAgICAgICAg\nICBpZiAocXFzICE9IG51bGwgJiYgcXVlcmllc1tpXS5nZXRTb3VyY2VNb2Rl\nKCkgPT0gTU9ERV9RVUVSWSAmJiAhcmVtKQogICAgICAgICAgICAgICAgcXFz\nLmFkZChxdWVyaWVzW2ldKTsKICAgICAgICB9CgogICAgICAgIC8vIHdyaXRl\nIG5ldyBtZXRhZGF0YSB3aXRob3V0IHJlbW92ZWQgaW5zdGFuY2VzCiAgICAg\nICAgYmFja3VwQW5kRGVsZXRlKGZpbGVzKTsKICAgICAgICBTZXJpYWxpemVy\nIHNlcjsKICAgICAgICBpZiAoKG1vZGUgJiAoTU9ERV9NRVRBIHwgTU9ERV9N\nQVBQSU5HKSkgIT0gMCkgewogICAgICAgICAgICBzZXIgPSBuZXdTZXJpYWxp\nemVyKCk7CiAgICAgICAgICAgIHNlci5zZXRNb2RlKChpc01hcHBpbmdPbmx5\nRmFjdG9yeSgpKSA/IG1vZGUgOiBtb2RlIHwgTU9ERV9NRVRBKTsKICAgICAg\nICAgICAgc2VyLmFkZEFsbChwcik7CiAgICAgICAgICAgIC8vIHJlbW92ZSBm\ncm9tIHNlcmlhbGl6ZXIgcmF0aGVyIHRoYW4gZnJvbSByZXBvc2l0b3J5IGFi\nb3ZlIHNvIHRoYXQKICAgICAgICAgICAgLy8gY2FsbGluZyBjb2RlIGNhbiB0\nYWtlIGFkdmFudGFnZSBvZiBtZXRhZGF0YSBzdGlsbCBpbiByZXBvcwogICAg\nICAgICAgICBpZiAoaXNNYXBwaW5nT25seUZhY3RvcnkoKSkKICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY2xzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICAgICAgICAgIHNlci5yZW1vdmVNZXRhRGF0YShwci5nZXRN\nZXRhRGF0YShjbHNbaV0sIGVudkxvYWRlciwKICAgICAgICAgICAgICAgICAg\nICAgICAgZmFsc2UpKTsKICAgICAgICAgICAgc2VyaWFsaXplKHNlciwgbnVs\nbCwgc2VyLlBSRVRUWSk7CiAgICAgICAgfQogICAgICAgIGlmIChxcXMgIT0g\nbnVsbCAmJiAhcXFzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBzZXIgPSBu\nZXdTZXJpYWxpemVyKCk7CiAgICAgICAgICAgIHNlci5zZXRNb2RlKE1PREVf\nUVVFUlkpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHFxcy5z\naXplKCk7IGkrKykKICAgICAgICAgICAgICAgIHNlci5hZGRRdWVyeU1ldGFE\nYXRhKChRdWVyeU1ldGFEYXRhKSBxcXMuZ2V0KGkpKTsKICAgICAgICAgICAg\nc2VyaWFsaXplKHNlciwgbnVsbCwgc2VyLlBSRVRUWSk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQXNz\naWduIGRlZmF1bHQgc291cmNlIGZpbGVzIHRvIHRoZSBnaXZlbiBtZXRhZGF0\nYXMuCiAgICAgKgogICAgICogQHBhcmFtIGNsc05hbWVzIG1hcCBvZiBjbGFz\ncyBuYW1lcyB0byBtZXRhZGF0YXMKICAgICAqIEByZXR1cm4gc2V0IG9mIGV4\naXN0aW5nIGZpbGVzIHVzZWQgYnkgdGhlc2UgbWV0YWRhdGFzLCBvcgogICAg\nICogbnVsbCBpZiBubyBleGlzdGluZyBmaWxlcwogICAgICovCiAgICBwcml2\nYXRlIFNldCBhc3NpZ25EZWZhdWx0TWV0YURhdGFGaWxlcyhDbGFzc01ldGFE\nYXRhW10gbWV0YXMsCiAgICAgICAgUXVlcnlNZXRhRGF0YVtdIHF1ZXJpZXMs\nIFNlcXVlbmNlTWV0YURhdGFbXSBzZXFzLCBpbnQgbW9kZSwKICAgICAgICBN\nYXAgY2xzTmFtZXMpIHsKICAgICAgICBTZXQgZmlsZXMgPSBudWxsOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgaWYgKGdldFNvdXJjZUZpbGUobWV0YXNbaV0pID09IG51\nbGwpCiAgICAgICAgICAgICAgICBzZXRTb3VyY2VGaWxlKG1ldGFzW2ldLCBk\nZWZhdWx0U291cmNlRmlsZShtZXRhc1tpXSkpOwogICAgICAgICAgICBpZiAo\nZ2V0U291cmNlRmlsZShtZXRhc1tpXSkuZXhpc3RzKCkpIHsKICAgICAgICAg\nICAgICAgIGlmIChmaWxlcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIGZpbGVzID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICAgICAgICAgIGZpbGVz\nLmFkZChnZXRTb3VyY2VGaWxlKG1ldGFzW2ldKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBxdWVyaWVz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChxdWVyaWVzW2ldLmdl\ndFNvdXJjZU1vZGUoKSA9PSBNT0RFX1FVRVJZCiAgICAgICAgICAgICAgICB8\nfCAobW9kZSAmIHF1ZXJpZXNbaV0uZ2V0U291cmNlTW9kZSgpKSA9PSAwKQog\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGlmIChxdWVy\naWVzW2ldLmdldFNvdXJjZUZpbGUoKSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgcXVlcmllc1tpXS5zZXRTb3VyY2UoZGVmYXVsdFNvdXJjZUZpbGUocXVl\ncmllc1tpXSwKICAgICAgICAgICAgICAgICAgICBjbHNOYW1lcyksIHF1ZXJp\nZXNbaV0uZ2V0U291cmNlU2NvcGUoKSwKICAgICAgICAgICAgICAgICAgICBx\ndWVyaWVzW2ldLmdldFNvdXJjZVR5cGUoKSk7CiAgICAgICAgICAgIGlmIChx\ndWVyaWVzW2ldLmdldFNvdXJjZUZpbGUoKS5leGlzdHMoKSkgewogICAgICAg\nICAgICAgICAgaWYgKGZpbGVzID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgZmlsZXMgPSBuZXcgSGFzaFNldCgpOwogICAgICAgICAgICAgICAgZmls\nZXMuYWRkKHF1ZXJpZXNbaV0uZ2V0U291cmNlRmlsZSgpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICBpZiAoKG1vZGUgJiBNT0RFX01BUFBJ\nTkcpICE9IDApIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBz\nZXFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0U291\ncmNlRmlsZShzZXFzW2ldKSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIHNldFNvdXJjZUZpbGUoc2Vxc1tpXSwgZGVmYXVsdFNvdXJjZUZpbGUoc2Vx\nc1tpXSwKICAgICAgICAgICAgICAgICAgICAgICAgY2xzTmFtZXMpKTsKICAg\nICAgICAgICAgICAgIGlmIChnZXRTb3VyY2VGaWxlKHNlcXNbaV0pLmV4aXN0\ncygpKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVzID09IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzID0gbmV3IEhhc2hTZXQo\nKTsKICAgICAgICAgICAgICAgICAgICBmaWxlcy5hZGQoZ2V0U291cmNlRmls\nZShzZXFzW2ldKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZpbGVzOwogICAgfQoKICAgIC8q\nKgogICAgICogQXNzaWduIGRlZmF1bHQgc291cmNlIGZpbGVzIHRvIHRoZSBn\naXZlbiBxdWVyaWVzLgogICAgICoKICAgICAqIEBwYXJhbSBjbHNOYW1lcyBt\nYXAgb2YgY2xhc3MgbmFtZXMgdG8gbWV0YWRhdGFzCiAgICAgKiBAcmV0dXJu\nIHNldCBvZiBleGlzdGluZyBmaWxlcyB1c2VkIGJ5IHRoZXNlIG1ldGFkYXRh\ncywgb3IKICAgICAqIG51bGwgaWYgbm8gZXhpc3RpbmcgZmlsZXMKICAgICAq\nLwogICAgcHJpdmF0ZSBTZXQgYXNzaWduRGVmYXVsdFF1ZXJ5RmlsZXMoUXVl\ncnlNZXRhRGF0YVtdIHF1ZXJpZXMsCiAgICAgICAgTWFwIGNsc05hbWVzKSB7\nCiAgICAgICAgU2V0IGZpbGVzID0gbnVsbDsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\naWYgKHF1ZXJpZXNbaV0uZ2V0U291cmNlTW9kZSgpICE9IE1PREVfUVVFUlkp\nCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYgKHF1\nZXJpZXNbaV0uZ2V0U291cmNlRmlsZSgpID09IG51bGwpCiAgICAgICAgICAg\nICAgICBxdWVyaWVzW2ldLnNldFNvdXJjZShkZWZhdWx0U291cmNlRmlsZShx\ndWVyaWVzW2ldLCBjbHNOYW1lcyksCiAgICAgICAgICAgICAgICAgICAgcXVl\ncmllc1tpXS5nZXRTb3VyY2VTY29wZSgpLCBxdWVyaWVzW2ldLmdldFNvdXJj\nZVR5cGUoKSk7CiAgICAgICAgICAgIGlmIChxdWVyaWVzW2ldLmdldFNvdXJj\nZUZpbGUoKS5leGlzdHMoKSkgewogICAgICAgICAgICAgICAgaWYgKGZpbGVz\nID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSBuZXcgSGFz\naFNldCgpOwogICAgICAgICAgICAgICAgZmlsZXMuYWRkKHF1ZXJpZXNbaV0u\nZ2V0U291cmNlRmlsZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICByZXR1cm4gZmlsZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdHJ1ZSBpZiB0aGlzIGZhY3RvcnkgZGVhbHMgb25seSB3aXRoIG1hcHBp\nbmcgZGF0YSwgYW5kIHJlbGllcwogICAgICogb24gYSBzZXBhcmF0ZSBmYWN0\nb3J5IGZvciBtZXRhZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gaXNNYXBwaW5nT25seUZhY3RvcnkoKSB7CiAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgYWxsIGdpdmVuIGZp\nbGVzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZShNZXRhRGF0\nYVBhcnNlciBwYXJzZXIsIENvbGxlY3Rpb24gZmlsZXMpIHsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGZpbGVzLml0\nZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgcGFy\nc2VyLnBhcnNlKChGaWxlKSBpdHIubmV4dCgpKTsKICAgICAgICB9IGNhdGNo\nIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdl\nbmVyYWxFeGNlcHRpb24oaW9lKTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQYXJzZSBhbGwgZ2l2ZW4gY2xhc3NzZXMuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHBhcnNlKE1ldGFEYXRhUGFyc2VyIHBhcnNlciwg\nQ2xhc3NbXSBjbHMpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNscy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgIHBhcnNlci5wYXJzZShjbHNbaV0sIGlzUGFyc2VUb3BEb3duKCkpOwog\nICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihpb2UpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcGFyc2UgY2xhc3Nl\ncyB0b3AgZG93bi4gRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBib29sZWFuIGlzUGFyc2VUb3BEb3duKCkgewogICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlbGwgdGhlIGdp\ndmVuIHNlcmlhbGllciB0byB3cml0ZSBpdHMgbWV0YWRhdGFzLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXJpYWxpemUoTWV0YURhdGFTZXJpYWxp\nemVyIHNlciwgTWFwIG91dHB1dCwgaW50IGZsYWdzKSB7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgaWYgKG91dHB1dCA9PSBudWxsKQogICAgICAgICAg\nICAgICAgc2VyLnNlcmlhbGl6ZShmbGFncyk7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIHNlci5zZXJpYWxpemUob3V0cHV0LCBmbGFncyk7\nCiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGlvZSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogQmFja3VwIGFuZCBkZWxldGUgdGhl\nIHNvdXJjZSBmaWxlcyBmb3IgdGhlIGdpdmVuIG1ldGFkYXRhcy4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgYmFja3VwQW5kRGVsZXRlKENvbGxlY3Rp\nb24gZmlsZXMpIHsKICAgICAgICBGaWxlIGZpbGU7CiAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBmaWxlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBmaWxlID0gKEZpbGUpIGl0ci5uZXh0KCk7CiAg\nICAgICAgICAgIGlmIChGaWxlcy5iYWNrdXAoZmlsZSwgZmFsc2UpICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBmaWxlLmRlbGV0ZSgpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIENsZWFyIG1hcHBpbmcgaW5mb3JtYXRp\nb24gZnJvbSB0aGUgZ2l2ZW4gbWV0YWRhdGEuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGNsZWFyTWFwcGluZyhDbGFzc01ldGFEYXRhIG1ldGEpIHsK\nICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NQVBQSU5HLCBmYWxz\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQg\nc291cmNlIGZpbGUgb2YgdGhlIGdpdmVuIG1ldGFkYXRhLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgRmlsZSBnZXRTb3VyY2VGaWxlKENsYXNzTWV0YURhdGEg\nbWV0YSkgewogICAgICAgIHJldHVybiBtZXRhLmdldFNvdXJjZUZpbGUoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY3VycmVudCBzb3VyY2Ug\nZmlsZSBvZiB0aGUgZ2l2ZW4gbWV0YWRhdGEuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHNldFNvdXJjZUZpbGUoQ2xhc3NNZXRhRGF0YSBtZXRhLCBG\naWxlIHNvdXJjZUZpbGUpIHsKICAgICAgICBtZXRhLnNldFNvdXJjZShzb3Vy\nY2VGaWxlLCBtZXRhLmdldFNvdXJjZVR5cGUoKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQgc291cmNlIGZpbGUgb2YgdGhl\nIGdpdmVuIG1ldGFkYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgRmlsZSBn\nZXRTb3VyY2VGaWxlKFNlcXVlbmNlTWV0YURhdGEgbWV0YSkgewogICAgICAg\nIHJldHVybiBtZXRhLmdldFNvdXJjZUZpbGUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgY3VycmVudCBzb3VyY2UgZmlsZSBvZiB0aGUgZ2l2\nZW4gbWV0YWRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNldFNv\ndXJjZUZpbGUoU2VxdWVuY2VNZXRhRGF0YSBtZXRhLCBGaWxlIHNvdXJjZUZp\nbGUpIHsKICAgICAgICBtZXRhLnNldFNvdXJjZShzb3VyY2VGaWxlLCBtZXRh\nLmdldFNvdXJjZVNjb3BlKCksCiAgICAgICAgICAgIG1ldGEuZ2V0U291cmNl\nVHlwZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGVm\nYXVsdCBmaWxlIGZvciB0aGUgZ2l2ZW4gbWV0YWRhdGEuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBhYnN0cmFjdCBGaWxlIGRlZmF1bHRTb3VyY2VGaWxlKENs\nYXNzTWV0YURhdGEgbWV0YSk7CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBk\nZWZhdWx0IGZpbGUgZm9yIHRoZSBnaXZlbiBxdWVyeS4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGFic3RyYWN0IEZpbGUgZGVmYXVsdFNvdXJjZUZpbGUoUXVl\ncnlNZXRhRGF0YSBxdWVyeSwKICAgICAgICBNYXAgY2xzTmFtZXMpOwoKICAg\nIC8qKgogICAgICogUmV0dXJuIGEgZGVmYXVsdCBmaWxlIGZvciB0aGUgZ2l2\nZW4gc2VxdWVuY2UuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBG\naWxlIGRlZmF1bHRTb3VyY2VGaWxlKFNlcXVlbmNlTWV0YURhdGEgc2VxLAog\nICAgICAgIE1hcCBjbHNOYW1lcyk7CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSBuZXcgbWV0YWRhdGEgcGFyc2VyLgogICAgICoKICAgICAqIEBwYXJhbSBs\nb2FkaW5nIGlmIHRydWUsIHRoaXMgd2lsbCBiZSB0aGUgY2FjaGVkIHBhcnNl\nciB1c2VkIGZvcgogICAgICogbG9hZGluZyBtZXRhZGF0YQogICAgICovCiAg\nICBwcm90ZWN0ZWQgYWJzdHJhY3QgUGFyc2VyIG5ld1BhcnNlcihib29sZWFu\nIGxvYWRpbmcpOwoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IG1ldGFk\nYXRhIHNlcmlhbGl6ZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFj\ndCBTZXJpYWxpemVyIG5ld1NlcmlhbGl6ZXIoKTsKCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgbWV0YWRhdGEgdGhhdCBkZWZpbmVzIHRoZSBnaXZlbiBx\ndWVyeSwgaWYgYW55LgogICAgICoKICAgICAqIEBwYXJhbSBjbHNOYW1lcyBt\nYXAgb2YgY2xhc3MgbmFtZXMgdG8gbWV0YWRhdGFzCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBDbGFzc01ldGFEYXRhIGdldERlZmluaW5nTWV0YURhdGEoUXVl\ncnlNZXRhRGF0YSBxdWVyeSwKICAgICAgICBNYXAgY2xzTmFtZXMpIHsKICAg\nICAgICBDbGFzcyBkZWYgPSBxdWVyeS5nZXREZWZpbmluZ1R5cGUoKTsKICAg\nICAgICBpZiAoZGVmICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiAoQ2xh\nc3NNZXRhRGF0YSkgY2xzTmFtZXMuZ2V0KGRlZi5nZXROYW1lKCkpOwoKICAg\nICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAgU3RyaW5nIHBrZzsKICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNsc05hbWVzLmVudHJ5U2V0KCku\naXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50\ncnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBwa2cg\nPSBTdHJpbmdzLmdldFBhY2thZ2VOYW1lKChTdHJpbmcpIGVudHJ5LmdldEtl\neSgpKTsKICAgICAgICAgICAgaWYgKHBrZy5sZW5ndGgoKSA9PSAwKQogICAg\nICAgICAgICAgICAgcmV0dXJuIChDbGFzc01ldGFEYXRhKSBlbnRyeS5nZXRW\nYWx1ZSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0K\nCiAgICBwdWJsaWMgU2V0IGdldFBlcnNpc3RlbnRUeXBlTmFtZXMoYm9vbGVh\nbiBkZXZwYXRoLCBDbGFzc0xvYWRlciBlbnZMb2FkZXIpIHsKICAgICAgICAv\nLyBzb21lIGNvbmZpZ3VyZWQgbG9jYXRpb25zIG1pZ2h0IGJlIGltcGxpY2l0\nIGluIHNwZWMsIHNvIHJldHVybgogICAgICAgIC8vIG51bGwgaWYgd2UgZG9u\nJ3QgZmluZCBhbnkgY2xhc3NlcywgcmF0aGVyIHRoYW4gaWYgd2UgZG9uJ3Qg\naGF2ZQogICAgICAgIC8vIGFueSBsb2NhdGlvbnMKICAgICAgICBpZiAoX3R5\ncGVOYW1lcyAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gKF90eXBlTmFt\nZXMuaXNFbXB0eSgpKSA/IG51bGwgOiBfdHlwZU5hbWVzOwoKICAgICAgICB0\ncnkgewogICAgICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSByZXBvcy5n\nZXRDb25maWd1cmF0aW9uKCkuCiAgICAgICAgICAgICAgICBnZXRDbGFzc1Jl\nc29sdmVySW5zdGFuY2UoKS5nZXRDbGFzc0xvYWRlcihnZXRDbGFzcygpLAog\nICAgICAgICAgICAgICAgZW52TG9hZGVyKTsKICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwoKICAgICAgICAg\nICAgU2V0IG5hbWVzID0gcGFyc2VQZXJzaXN0ZW50VHlwZU5hbWVzKGxvYWRl\ncik7CiAgICAgICAgICAgIGlmIChuYW1lcy5pc0VtcHR5KCkgJiYgZGV2cGF0\naCkKICAgICAgICAgICAgICAgIHNjYW4obmV3IENsYXNzcGF0aE1ldGFEYXRh\nSXRlcmF0b3IobnVsbCwgbmV3TWV0YURhdGFGaWx0ZXIoKSksCiAgICAgICAg\nICAgICAgICAgICAgbmV3Q2xhc3NBcmdQYXJzZXIoKSwgbmFtZXMsIGZhbHNl\nKTsKICAgICAgICAgICAgZWxzZSAvLyB3ZSBkb24ndCBjYWNoZSBhIGZ1bGwg\nZGV2IGNwIHNjYW4KICAgICAgICAgICAgICAgIF90eXBlTmFtZXMgPSBuYW1l\nczsKCiAgICAgICAgICAgIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgpKQogICAg\nICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoImZvdW5kLXBjcyIsIFN0\ncmluZy52YWx1ZU9mKG5hbWVzLnNpemUoKSksCiAgICAgICAgICAgICAgICAg\nICAgU3RyaW5nLnZhbHVlT2YoU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkg\nLSBzdGFydCkpKTsKICAgICAgICAgICAgcmV0dXJuIChuYW1lcy5pc0VtcHR5\nKCkpID8gbnVsbCA6IG5hbWVzOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0\naW9uIGlvZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2Vw\ndGlvbihpb2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIHBlcnNpc3RlbnQgdHlwZSBuYW1lcy4KICAgICAqLwogICAgcHJpdmF0\nZSBTZXQgcGFyc2VQZXJzaXN0ZW50VHlwZU5hbWVzKENsYXNzTG9hZGVyIGxv\nYWRlcikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENs\nYXNzQXJnUGFyc2VyIGNwYXJzZXIgPSBuZXdDbGFzc0FyZ1BhcnNlcigpOwog\nICAgICAgIFN0cmluZ1tdIGNsc3M7CiAgICAgICAgU2V0IG5hbWVzID0gbmV3\nIEhhc2hTZXQoKTsKICAgICAgICBpZiAoZmlsZXMgIT0gbnVsbCkgewogICAg\nICAgICAgICBGaWxlIGZpbGU7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gZmlsZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAg\nICAgICAgICAgICAgIGZpbGUgPSAoRmlsZSkgaXRyLm5leHQoKTsKICAgICAg\nICAgICAgICAgIGlmIChmaWxlLmlzRGlyZWN0b3J5KCkpIHsKICAgICAgICAg\nICAgICAgICAgICBzY2FuKG5ldyBGaWxlTWV0YURhdGFJdGVyYXRvcihkaXIs\nIG5ld01ldGFEYXRhRmlsdGVyKCkpLAogICAgICAgICAgICAgICAgICAgICAg\nICBjcGFyc2VyLCBuYW1lcywgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9IGVs\nc2UgaWYgKGZpbGUuZ2V0TmFtZSgpLmVuZHNXaXRoKCIuamFyIikpIHsKICAg\nICAgICAgICAgICAgICAgICBzY2FuKG5ldyBaaXBGaWxlTWV0YURhdGFJdGVy\nYXRvcihuZXcgWmlwRmlsZShmaWxlKSwKICAgICAgICAgICAgICAgICAgICAg\nICAgbmV3TWV0YURhdGFGaWx0ZXIoKSksIGNwYXJzZXIsIG5hbWVzLCB0cnVl\nKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg\nICAgY2xzcyA9IGNwYXJzZXIucGFyc2VUeXBlTmFtZXMobmV3IEZpbGVNZXRh\nRGF0YUl0ZXJhdG9yCiAgICAgICAgICAgICAgICAgICAgICAgIChmaWxlKSk7\nCiAgICAgICAgICAgICAgICAgICAgbmFtZXMuYWRkQWxsKEFycmF5cy5hc0xp\nc3QoY2xzcykpOwogICAgICAgICAgICAgICAgICAgIG1hcFBlcnNpc3RlbnRU\neXBlTmFtZXMoZmlsZS5nZXRBYnNvbHV0ZUZpbGUoKS50b1VSTCgpLAogICAg\nICAgICAgICAgICAgICAgICAgICBjbHNzKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBVUkwgdXJsOwogICAg\nICAgIGlmICh1cmxzICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSB1cmxzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7\nCiAgICAgICAgICAgICAgICB1cmwgPSAoVVJMKSBpdHIubmV4dCgpOwogICAg\nICAgICAgICAgICAgaWYgKCJqYXIiLmVxdWFscyh1cmwuZ2V0UHJvdG9jb2wo\nKSkKICAgICAgICAgICAgICAgICAgICAmJiB1cmwuZ2V0UGF0aCgpLmVuZHNX\naXRoKCIhLyIpKSB7CiAgICAgICAgICAgICAgICAgICAgc2NhbihuZXcgWmlw\nRmlsZU1ldGFEYXRhSXRlcmF0b3IodXJsLAogICAgICAgICAgICAgICAgICAg\nICAgICBuZXdNZXRhRGF0YUZpbHRlcigpKSwgY3BhcnNlciwgbmFtZXMsIHRy\ndWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICBjbHNzID0gY3BhcnNlci5wYXJzZVR5cGVOYW1lcyhuZXcgVVJMTWV0\nYURhdGFJdGVyYXRvcgogICAgICAgICAgICAgICAgICAgICAgICAodXJsKSk7\nCiAgICAgICAgICAgICAgICAgICAgbmFtZXMuYWRkQWxsKEFycmF5cy5hc0xp\nc3QoY2xzcykpOwogICAgICAgICAgICAgICAgICAgIG1hcFBlcnNpc3RlbnRU\neXBlTmFtZXModXJsLCBjbHNzKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAocnNyY3MgIT0gbnVsbCkg\newogICAgICAgICAgICBTdHJpbmcgcnNyYzsKICAgICAgICAgICAgTWV0YURh\ndGFJdGVyYXRvciBtaXRyOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nciA9IHJzcmNzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgICAgICByc3JjID0gKFN0cmluZykgaXRyLm5leHQoKTsKICAgICAg\nICAgICAgICAgIGlmIChyc3JjLmVuZHNXaXRoKCIuamFyIikpIHsKICAgICAg\nICAgICAgICAgICAgICB1cmwgPSBsb2FkZXIuZ2V0UmVzb3VyY2UocnNyYyk7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKHVybCAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHNjYW4obmV3IFppcFN0cmVhbU1ldGFEYXRh\nSXRlcmF0b3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChuZXcgWmlw\nSW5wdXRTdHJlYW0odXJsLm9wZW5TdHJlYW0oKSksCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgbmV3TWV0YURhdGFGaWx0ZXIoKSksIGNwYXJz\nZXIsIG5hbWVzLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1pdHIg\nPSBuZXcgUmVzb3VyY2VNZXRhRGF0YUl0ZXJhdG9yKHJzcmMsIGxvYWRlcik7\nCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG1pdHIuaGFzTmV4dCgpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IChVUkwpIG1pdHIubmV4\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICBjbHNzID0gY3BhcnNlci5w\nYXJzZVR5cGVOYW1lcyhuZXcgVVJMTWV0YURhdGFJdGVyYXRvcgogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKHVybCkpOwogICAgICAgICAgICAgICAg\nICAgICAgICBuYW1lcy5hZGRBbGwoQXJyYXlzLmFzTGlzdChjbHNzKSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIG1hcFBlcnNpc3RlbnRUeXBlTmFtZXMo\ndXJsLCBjbHNzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgbWl0ci5jbG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChjcGF0aCAhPSBudWxs\nKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGRpcnMgPSAoU3RyaW5nW10pIGNw\nYXRoLnRvQXJyYXkobmV3IFN0cmluZ1tjcGF0aC5zaXplKCldKTsKICAgICAg\nICAgICAgc2NhbihuZXcgQ2xhc3NwYXRoTWV0YURhdGFJdGVyYXRvcihkaXJz\nLCBuZXdNZXRhRGF0YUZpbHRlcigpKSwKICAgICAgICAgICAgICAgIGNwYXJz\nZXIsIG5hbWVzLCB0cnVlKTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVz\nICE9IG51bGwpCiAgICAgICAgICAgIG5hbWVzLmFkZEFsbCh0eXBlcyk7CiAg\nICAgICAgcmV0dXJuIG5hbWVzOwogICAgfQoKICAgIC8qKgogICAgICogU2Nh\nbiBmb3IgcGVyc2lzdGVudCB0eXBlIG5hbWVzIHVzaW5nIHRoZSBnaXZlbiBt\nZXRhZGF0YSBpdGVyYXRvci4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNj\nYW4oTWV0YURhdGFJdGVyYXRvciBtaXRyLCBDbGFzc0FyZ1BhcnNlciBjcGFy\nc2VyLCBTZXQgbmFtZXMsCiAgICAgICAgYm9vbGVhbiBtYXBOYW1lcykKICAg\nICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIE1hcCBtYXA7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgbWFwID0gY3BhcnNlci5tYXBUeXBl\nTmFtZXMobWl0cik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nbWl0ci5jbG9zZSgpOwogICAgICAgIH0KCiAgICAgICAgTWFwLkVudHJ5IGVu\ndHJ5OwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gbWFwLmVudHJ5U2V0\nKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAg\nZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBp\nZiAobWFwTmFtZXMpCiAgICAgICAgICAgICAgICBtYXBQZXJzaXN0ZW50VHlw\nZU5hbWVzKGVudHJ5LmdldEtleSgpLCAoU3RyaW5nW10pCiAgICAgICAgICAg\nICAgICAgICAgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgIG5hbWVz\nLmFkZEFsbChBcnJheXMuYXNMaXN0KChTdHJpbmdbXSkgZW50cnkuZ2V0VmFs\ndWUoKSkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEltcGxl\nbWVudCB0aGlzIG1ldGhvZCB0byBtYXAgbWV0YWRhdGEgcmVzb3VyY2VzIHRv\nIHRoZSBwZXJzaXN0ZW50CiAgICAgKiB0eXBlcyBjb250YWluZWQgd2l0aGlu\nIHRoZW0uIFRoZSBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgd2hlbgogICAgICog\ne0BsaW5rICNnZXRQZXJzaXN0ZW50VHlwZU5hbWVzfSBpcyBpbnZva2VkLgog\nICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBtYXBQZXJzaXN0ZW50VHlwZU5h\nbWVzKE9iamVjdCByc3JjLCBTdHJpbmdbXSBuYW1lcykgewogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIGEgbWV0YWRhdGEgZmlsdGVyIHRoYXQgaWRl\nbnRpZmllcyBtZXRhZGF0YSByZXNvdXJjZXMgd2hlbgogICAgICogcGVyZm9y\nbWluZyBqYXIgYW5kIGNsYXNzcGF0aCBzY2Fucy4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGFic3RyYWN0IE1ldGFEYXRhRmlsdGVyIG5ld01ldGFEYXRhRmls\ndGVyKCk7CgogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgc3Vw\nZXIuY2xlYXIoKTsKICAgICAgICBfdHlwZU5hbWVzID0gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIEludGVybmFsIHBhcnNlciBpbnRlcmZhY2UuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIFBhcnNlcgogICAg\nICAgIGV4dGVuZHMgTWV0YURhdGFQYXJzZXIgewoKICAgICAgICAvKioKICAg\nICAgICAgKiBSZXR1cm5zIHRoZSByZXBvc2l0b3J5IGZvciB0aGlzIHBhcnNl\nci4gSWYgbm9uZSBoYXMgYmVlbiBzZXQsCiAgICAgICAgICogY3JlYXRlcyBh\nIG5ldyByZXBvc2l0b3J5IGFuZCBzZXRzIGl0LgogICAgICAgICAqLwogICAg\nICAgIHB1YmxpYyBNZXRhRGF0YVJlcG9zaXRvcnkgZ2V0UmVwb3NpdG9yeSgp\nOwoKICAgICAgICAvKioKICAgICAgICAgKiBUaGUgcGFyc2UgbW9kZSBhY2Nv\ncmRpbmcgdG8gdGhlIGV4cGVjdGVkIGRvY3VtZW50IHR5cGUuCiAgICAgICAg\nICovCiAgICAgICAgcHVibGljIHZvaWQgc2V0TW9kZShpbnQgbW9kZSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBJbnRlcm5hbCBzZXJpYWxpemVyIGludGVy\nZmFjZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgU2Vy\naWFsaXplcgogICAgICAgIGV4dGVuZHMgTWV0YURhdGFTZXJpYWxpemVyIHsK\nCiAgICAgICAgLyoqCiAgICAgICAgICogVGhlIHNlcmlhbGl6YXRpb24gbW9k\nZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVjdGVkIGRvY3VtZW50IHR5cGUuIFRo\nZQogICAgICAgICAqIG1vZGUgY29uc3RhbnRzIGFjdCBhcyBiaXQgZmxhZ3Ms\nIGFuZCB0aGVyZWZvcmUgY2FuIGJlIGNvbWJpbmVkLgogICAgICAgICAqLwog\nICAgICAgIHB1YmxpYyB2b2lkIHNldE1vZGUoaW50IG1vZGUpOwoKICAgICAg\nICAvKioKICAgICAgICAgKiBBZGQgYSBjbGFzcyBtZXRhIGRhdGEgdG8gdGhl\nIHNldCB0byBiZSBzZXJpYWxpemVkLgogICAgICAgICAqLwogICAgICAgIHB1\nYmxpYyB2b2lkIGFkZE1ldGFEYXRhKENsYXNzTWV0YURhdGEgbWV0YSk7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIFJlbW92ZSBhIGNsYXNzIG1ldGEgZGF0\nYSBmcm9tIHRoZSBzZXQgdG8gYmUgc2VyaWFsaXplZC4KICAgICAgICAgKi8K\nICAgICAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVNZXRhRGF0YShDbGFzc01l\ndGFEYXRhIG1ldGEpOwoKICAgICAgICAvKioKICAgICAgICAgKiBBZGQgYSBz\nZXF1ZW5jZSBtZXRhIGRhdGEgdG8gdGhlIHNldCB0byBiZSBzZXJpYWxpemVk\nLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGFkZFNlcXVlbmNl\nTWV0YURhdGEoU2VxdWVuY2VNZXRhRGF0YSBtZXRhKTsKCiAgICAgICAgLyoq\nCiAgICAgICAgICogQWRkIGEgcXVlcnkgbWV0YSBkYXRhIHRvIHRoZSBzZXQg\ndG8gYmUgc2VyaWFsaXplZC4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\ndm9pZCBhZGRRdWVyeU1ldGFEYXRhKFF1ZXJ5TWV0YURhdGEgbWV0YSk7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIEFkZCBhbGwgY29tcG9uZW50cyBpbiB0\naGUgZ2l2ZW4gcmVwb3NpdG9yeSB0byB0aGUgc2V0IHRvIGJlCgkJICogc2Vy\naWFsaXplZC4KCQkgKi8KCQlwdWJsaWMgdm9pZCBhZGRBbGwgKE1ldGFEYXRh\nUmVwb3NpdG9yeSByZXBvcyk7Cgl9Cn0K\n","encoding":"base64"}

