{"sha":"bae011531c542e0692a16ac8b3c4bfe917768620","node_id":"MDQ6QmxvYjIwNjM2NDpiYWUwMTE1MzFjNTQyZTA2OTJhMTZhYzhiM2M0YmZlOTE3NzY4NjIw","size":11166,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bae011531c542e0692a16ac8b3c4bfe917768620","content":"LyoNCiAqIENvcHlyaWdodCAyMDA2IFRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbi4NCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExp\nY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBt\nYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0\naCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0\naGUgTGljZW5zZSBhdA0KICoNCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9s\naWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBi\neSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29m\ndHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRp\nc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQN\nCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICovDQpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhOw0KDQppbXBvcnQgamF2YS51\ndGlsLkFycmF5TGlzdDsNCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsNCmlt\ncG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7DQppbXBvcnQgamF2YS51dGlsLk1hcDsNCg0KaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOw0KaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5sYW5nLk9iamVjdFV0aWxzOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247DQppbXBvcnQg\nc2VycC51dGlsLk51bWJlcnM7DQoNCi8qKg0KICogQ2FwdHVyZXMgZmV0Y2gg\nZ3JvdXAgbWV0YWRhdGEuDQogKi8NCnB1YmxpYyBjbGFzcyBGZXRjaEdyb3Vw\nIHsNCg0KICAgIC8qKg0KICAgICAqIE5hbWUgb2YgdGhlIGRlZmF1bHQgZmV0\nY2ggZ3JvdXAuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgTkFNRV9ERUZBVUxUID0gImRlZmF1bHQiOw0KDQogICAgLyoqDQog\nICAgICogTmFtZSBvZiB0aGUgImFsbCIgZmV0Y2ggZ3JvdXAuDQogICAgICov\nDQogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTkFNRV9BTEwgPSAi\nYWxsIjsNCg0KICAgIC8qKg0KICAgICAqIERlZmF1bHQgZmllbGQgcmVjdXJz\naW9uIGRlcHRoLg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IFJFQ1VSU0lPTl9ERVBUSF9ERUZBVUxUID0gMTsNCg0KICAgIC8qKg0K\nICAgICAqIEluZmluaXRlIGRlcHRoLg0KICAgICAqLw0KCXB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IERFUFRIX0lORklOSVRFID0gLTE7DQoNCiAgICAvKioN\nCiAgICAgKiAgU3RhbmRhcmQgZGVmYXVsdCBmZXRjaCBncm91cC4NCiAgICAg\nKi8NCiAgICBzdGF0aWMgZmluYWwgRmV0Y2hHcm91cCBERUZBVUxUID0gbmV3\nIEZldGNoR3JvdXAoTkFNRV9ERUZBVUxULCB0cnVlKTsNCg0KICAgIC8qKg0K\nICAgICAqICBTdGFuZGFyZCAiYWxsIiBmZXRjaCBncm91cC4NCiAgICAgKi8N\nCiAgICBzdGF0aWMgZmluYWwgRmV0Y2hHcm91cCBBTEwgPSBuZXcgRmV0Y2hH\ncm91cChOQU1FX0FMTCwgZmFsc2UpOw0KDQogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQ0K\nICAgICAgICAoRmV0Y2hHcm91cC5jbGFzcyk7DQoNCiAgICBwcml2YXRlIGZp\nbmFsIFN0cmluZyBfbmFtZTsNCiAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0\nYURhdGEgX21ldGE7DQogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9yZWFk\nT25seTsNCiAgICBwcml2YXRlIExpc3QgX2luY2x1ZGVzOw0KICAgIHByaXZh\ndGUgTWFwIF9kZXB0aHM7DQogICAgcHJpdmF0ZSBCb29sZWFuIF9wb3N0TG9h\nZDsNCg0KICAgIC8qKg0KICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgaW1t\ndXRhYmxlIG5hbWUuDQogICAgICoNCiAgICAgKiBAcGFyYW0gbmFtZSBtdXN0\nIG5vdCBieSBudWxsIG9yIGVtcHR5Lg0KICAgICAqLw0KICAgIEZldGNoR3Jv\ndXAoQ2xhc3NNZXRhRGF0YSBjbSwgU3RyaW5nIG5hbWUpIHsNCiAgICAgICAg\nX21ldGEgPSBjbTsNCiAgICAgICAgX25hbWUgPSBuYW1lOw0KICAgICAgICBf\ncmVhZE9ubHkgPSBmYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBJ\nbnRlcm5hbCBjb25zdHJ1Y3RvciBmb3IgYnVpbHRpbiBmZXRjaCBncm91cHMu\nDQogICAgICovDQogICAgcHJpdmF0ZSBGZXRjaEdyb3VwKFN0cmluZyBuYW1l\nLCBib29sZWFuIHBvc3RMb2FkKSB7DQogICAgICAgIF9tZXRhID0gbnVsbDsN\nCiAgICAgICAgX25hbWUgPSBuYW1lOw0KICAgICAgICBfcG9zdExvYWQgPSAo\ncG9zdExvYWQpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsNCiAg\nICAgICAgX3JlYWRPbmx5ID0gdHJ1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAg\nICAgKiBDb3B5IHN0YXRlIGZyb20gdGhlIGdpdmVuIGZldGNoIGdyb3VwLg0K\nICAgICAqLw0KICAgIHZvaWQgY29weShGZXRjaEdyb3VwIGZnKSB7DQogICAg\nICAgIGlmIChmZy5faW5jbHVkZXMgIT0gbnVsbCkNCiAgICAgICAgICAgIGZv\nciAoSXRlcmF0b3IgaXRyID0gZmcuX2luY2x1ZGVzLml0ZXJhdG9yKCk7IGl0\nci5oYXNOZXh0KCk7KQ0KICAgICAgICAgICAgICAgIGFkZERlY2xhcmVkSW5j\nbHVkZSgoU3RyaW5nKSBpdHIubmV4dCgpKTsNCiAgICAgICAgaWYgKGZnLl9k\nZXB0aHMgIT0gbnVsbCkgew0KICAgICAgICAgICAgTWFwLkVudHJ5IGVudHJ5\nOw0KICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBmZy5fZGVwdGhz\nLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgDQogICAgICAgICAgICAgICAgaXRy\nLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgICAgICBlbnRyeSA9IChNYXAu\nRW50cnkpIGl0ci5uZXh0KCk7DQogICAgICAgICAgICAgICAgc2V0UmVjdXJz\naW9uRGVwdGgoKEZpZWxkTWV0YURhdGEpIGVudHJ5LmdldEtleSgpLCAoKE51\nbWJlcikgDQogICAgICAgICAgICAgICAgICAgIGVudHJ5LmdldFZhbHVlKCkp\nLmludFZhbHVlKCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAg\nICAgIGlmIChmZy5fcG9zdExvYWQgIT0gbnVsbCkNCiAgICAgICAgICAgIF9w\nb3N0TG9hZCA9IGZnLl9wb3N0TG9hZDsNCiAgICB9DQoNCiAgICAvKioNCiAg\nICAgKiBGZXRjaCBncm91cCBuYW1lLg0KICAgICAqLw0KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0TmFtZSgpIHsNCiAgICAgICAgcmV0dXJuIF9uYW1lOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIEluY2x1ZGVzIGdpdmVuIGZldGNoIGdy\nb3VwIHdpdGhpbiB0aGlzIHJlY2VpdmVyLg0KICAgICAqLw0KICAgIHB1Ymxp\nYyB2b2lkIGFkZERlY2xhcmVkSW5jbHVkZShTdHJpbmcgZmdOYW1lKSB7DQog\nICAgICAgIGlmIChfcmVhZE9ubHkpDQogICAgICAgICAgICB0aHJvdyBuZXcg\nVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICAgICAgaWYg\nKFN0cmluZ1V0aWxzLmlzRW1wdHkoZmdOYW1lKSkNCiAgICAgICAgICAgIHRo\ncm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibnVsbC1pbmNs\ndWRlLWZnIiwgdGhpcykpOw0KICAgICAgICBpZiAoX2luY2x1ZGVzID09IG51\nbGwpDQogICAgICAgICAgICBfaW5jbHVkZXMgPSBuZXcgQXJyYXlMaXN0KCk7\nDQogICAgICAgIGlmICghX2luY2x1ZGVzLmNvbnRhaW5zKGZnTmFtZSkpDQog\nICAgICAgICAgICBfaW5jbHVkZXMuYWRkKGZnTmFtZSk7DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogQWZmaXJtcyBpZiBnaXZlbiBmZXRjaCBncm91cCBp\ncyBpbmNsdWRlZCBieSB0aGlzIHJlY2VpdmVyLiAgSW5jbHVkZXMNCiAgICAg\nKiBzdXBlcmNsYXNzIGRlZmluaXRpb24gb2YgZmV0Y2ggZ3JvdXAgYW5kIG9w\ndGlvbmFsbHkgb3RoZXIgaW5jbHVkZWQgDQogICAgICogZ3JvdXBzLg0KICAg\nICAqDQogICAgICogQHBhcmFtIHJlY3Vyc2UgaWYgdHJ1ZSB0aGVuIHJlY3Vy\nc2l2ZWx5IGNoZWNrcyB3aXRoaW4gdGhlIGluY2x1ZGVkDQogICAgICogZmVj\ndGggZ3JvdXBzDQogICAgICovDQogICAgcHVibGljIGJvb2xlYW4gaW5jbHVk\nZXMoU3RyaW5nIGZnTmFtZSwgYm9vbGVhbiByZWN1cnNlKSB7DQogICAgICAg\nIC8vIGNoZWNrIG91ciBpbmNsdWRlcw0KICAgICAgICBpZiAoX2luY2x1ZGVz\nICE9IG51bGwpIHsNCiAgICAgICAgICAgIGlmIChfaW5jbHVkZXMuY29udGFp\nbnMoZmdOYW1lKSkNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAg\nICAgICAgICAgIGlmIChyZWN1cnNlKSB7DQogICAgICAgICAgICAgICAgRmV0\nY2hHcm91cCBmZzsNCiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGkg\nPSBfaW5jbHVkZXMuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICAgICAgICAgIGZnID0gX21ldGEuZ2V0RmV0Y2hHcm91cCgoU3Ry\naW5nKSBpLm5leHQoKSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChmZyAh\nPSBudWxsICYmIGZnLmluY2x1ZGVzKGZnTmFtZSwgdHJ1ZSkpDQogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAg\nICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKF9t\nZXRhICE9IG51bGwpIHsNCiAgICAgICAgICAgIC8vIGNoZWNrIHN1cGVyY2xh\nc3MgaW5jbHVkZXMNCiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgc3VwID0g\nX21ldGEuZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKTsNCiAgICAgICAgICAg\nIGlmIChzdXAgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIEZldGNoR3Jv\ndXAgc3VwRkcgPSBzdXAuZ2V0RmV0Y2hHcm91cChfbmFtZSk7DQogICAgICAg\nICAgICAgICAgaWYgKHN1cEZHICE9IG51bGwpDQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBzdXBGRy5pbmNsdWRlcyhmZ05hbWUsIHJlY3Vyc2UpOw0K\nICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBmYWxz\nZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm4gdGhlIGZldGNo\nIGdyb3VwIG5hbWVzIGRlY2xhcmVkIGluY2x1ZGVkIGJ5IHRoaXMgZ3JvdXAu\nDQogICAgICovDQogICAgcHVibGljIFN0cmluZ1tdIGdldERlY2xhcmVkSW5j\nbHVkZXMoKSB7DQogICAgICAgIC8vIG9ubHkgdXNlZCBkdXJpbmcgc2VyaWFs\naXphdGlvbjsgbm8gbmVlZCB0byBjYWNoZQ0KICAgICAgICByZXR1cm4gKF9p\nbmNsdWRlcyA9PSBudWxsKSA/IG5ldyBTdHJpbmdbMF0NCiAgICAgICAgICAg\nIDogKFN0cmluZ1tdKSBfaW5jbHVkZXMudG9BcnJheShuZXcgU3RyaW5nW19p\nbmNsdWRlcy5zaXplKCldKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBS\nZWN1cnNpb24gZGVwdGggZm9yIHRoZSBnaXZlbiBmaWVsZC4gIFRoaXMgaXMg\ndGhlIGRlcHRoIG9mIHJlbGF0aW9ucyBvZg0KICAgICAqIHRoZSBzYW1lIGNs\nYXNzIGFzIHRoaXMgb25lIHdlIGNhbiBmZXRjaCB0aHJvdWdoIHRoZSBnaXZl\nbiBmaWVsZC4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXRSZWN1cnNp\nb25EZXB0aChGaWVsZE1ldGFEYXRhIGZtLCBpbnQgZGVwdGgpIHsNCiAgICAg\nICAgaWYgKF9yZWFkT25seSkNCiAgICAgICAgICAgIHRocm93IG5ldyBVbnN1\ncHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOw0KICAgICAgICBpZiAoZGVw\ndGggPCAtMSkNCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2Vw\ndGlvbihfbG9jLmdldCgiaW52YWxpZC1mZy1kZXB0aCIsIF9uYW1lLCBmbSwg\nDQogICAgICAgICAgICAgICAgTnVtYmVycy52YWx1ZU9mKGRlcHRoKSkpOw0K\nICAgICAgICBpZiAoX2RlcHRocyA9PSBudWxsKQ0KICAgICAgICAgICAgX2Rl\ncHRocyA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgIF9kZXB0aHMucHV0KGZt\nLCBOdW1iZXJzLnZhbHVlT2YoZGVwdGgpKTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBSZWN1cnNpb24gZGVwdGggZm9yIHRoZSBnaXZlbiBmaWVsZC4g\nIFRoaXMgaXMgdGhlIGRlcHRoIG9mIHJlbGF0aW9ucyBvZg0KICAgICAqIHRo\nZSBzYW1lIGNsYXNzIGFzIHRoaXMgb25lIHdlIGNhbiBmZXRjaCB0aHJvdWdo\nIHRoZSBnaXZlbiBmaWVsZC4NCiAgICAgKi8NCiAgICBwdWJsaWMgaW50IGdl\ndFJlY3Vyc2lvbkRlcHRoKEZpZWxkTWV0YURhdGEgZm0pIHsNCiAgICAgICAg\nTnVtYmVyIGRlcHRoID0gZmluZFJlY3Vyc2lvbkRlcHRoKGZtKTsNCiAgICAg\nICAgcmV0dXJuIChkZXB0aCA9PSBudWxsKSA/IFJFQ1VSU0lPTl9ERVBUSF9E\nRUZBVUxUIDogZGVwdGguaW50VmFsdWUoKTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBSZXR1cm4gdGhlIHJlY3Vyc2lvbiBkZXB0aCBkZWNsYXJlZCBm\nb3IgdGhlIGdpdmVuIGZpZWxkLCBvciANCiAgICAgKiAwIGlmIG5vbmUuDQog\nICAgICovDQogICAgcHVibGljIGludCBnZXREZWNsYXJlZFJlY3Vyc2lvbkRl\ncHRoKEZpZWxkTWV0YURhdGEgZm0pIHsNCiAgICAgICAgTnVtYmVyIGRlcHRo\nID0gKF9kZXB0aHMgPT0gbnVsbCkgPyBudWxsIDogKE51bWJlcikgX2RlcHRo\ncy5nZXQoZm0pOw0KICAgICAgICByZXR1cm4gKGRlcHRoID09IG51bGwpID8g\nMCA6IGRlcHRoLmludFZhbHVlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogSGVscGVyIHRvIGZpbmQgcmVjdXJzaW9uIGRlcHRoIHJlY3Vyc2l2ZWx5\nIGluIG91ciBpbmNsdWRlcy4NCiAgICAgKi8NCiAgICBwcml2YXRlIE51bWJl\nciBmaW5kUmVjdXJzaW9uRGVwdGgoRmllbGRNZXRhRGF0YSBmbSkgeyANCiAg\nICAgICAgTnVtYmVyIGRlcHRoID0gKF9kZXB0aHMgPT0gbnVsbCkgPyBudWxs\nIDogKE51bWJlcikgX2RlcHRocy5nZXQoZm0pOw0KICAgICAgICBpZiAoZGVw\ndGggIT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBkZXB0aDsNCg0KICAg\nICAgICAvLyBjaGVjayBmb3Igc3VwZXJjbGFzcyBkZWNsYXJhdGlvbiBvZiBk\nZXB0aA0KICAgICAgICBOdW1iZXIgbWF4ID0gbnVsbDsNCiAgICAgICAgaWYg\nKF9tZXRhICE9IG51bGwgJiYgZm0uZ2V0RGVjbGFyaW5nTWV0YURhdGEoKSAh\nPSBfbWV0YSkgew0KICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBzdXAgPSBf\nbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpOw0KICAgICAgICAgICAg\naWYgKHN1cCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgRmV0Y2hHcm91\ncCBzdXBGRyA9IHN1cC5nZXRGZXRjaEdyb3VwKF9uYW1lKTsNCiAgICAgICAg\nICAgICAgICBpZiAoc3VwRkcgIT0gbnVsbCkNCiAgICAgICAgICAgICAgICAg\nICAgbWF4ID0gc3VwRkcuZmluZFJlY3Vyc2lvbkRlcHRoKGZtKTsNCiAgICAg\nICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoX2luY2x1ZGVzID09\nIG51bGwpDQogICAgICAgICAgICByZXR1cm4gbWF4Ow0KDQogICAgICAgIC8v\nIGZpbmQgbGFyZ2VzdCBpbmNsdWRlZCBkZXB0aA0KICAgICAgICBGZXRjaEdy\nb3VwIGZnOw0KICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF9pbmNsdWRl\ncy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgew0KICAgICAgICAgICAg\nZmcgPSBfbWV0YS5nZXRGZXRjaEdyb3VwKChTdHJpbmcpIGl0ci5uZXh0KCkp\nOw0KICAgICAgICAgICAgZGVwdGggPSAoZmcgPT0gbnVsbCkgPyBudWxsIDog\nZmcuZmluZFJlY3Vyc2lvbkRlcHRoKGZtKTsNCiAgICAgICAgICAgIGlmIChk\nZXB0aCAhPSBudWxsICYmIChtYXggPT0gbnVsbCANCiAgICAgICAgICAgICAg\nICB8fCBkZXB0aC5pbnRWYWx1ZSgpID4gbWF4LmludFZhbHVlKCkpKQ0KICAg\nICAgICAgICAgICAgIG1heCA9IGRlcHRoOw0KICAgICAgICB9DQogICAgICAg\nIHJldHVybiBtYXg7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmV0dXJu\nIHRoZSBmaWVsZHMgd2l0aCBkZWNsYXJlZCByZWN1cnNpb24gZGVwdGhzIGlu\nIHRoaXMgZ3JvdXAuDQogICAgICovDQogICAgcHVibGljIEZpZWxkTWV0YURh\ndGFbXSBnZXREZWNsYXJlZFJlY3Vyc2lvbkRlcHRoRmllbGRzKCkgew0KICAg\nICAgICAvLyB1c2VkIGluIHNlcmlhbGl6YXRpb24gb25seTsgbm8gbmVlZCB0\nbyBjYWNoZQ0KICAgICAgICBpZiAoX2RlcHRocyA9PSBudWxsKQ0KICAgICAg\nICAgICAgcmV0dXJuIG5ldyBGaWVsZE1ldGFEYXRhWzBdOw0KICAgICAgICAg\ncmV0dXJuIChGaWVsZE1ldGFEYXRhW10pIF9kZXB0aHMua2V5U2V0KCkudG9B\ncnJheQ0KICAgICAgICAgICAgKG5ldyBGaWVsZE1ldGFEYXRhW19kZXB0aHMu\nc2l6ZSgpXSk7DQogICAgfSANCg0KICAgIC8qKg0KICAgICAqIFdoZXRoZXIg\nbG9hZGluZyB0aGlzIGZldGNoIGdyb3VwIGNhdXNlcyBhIHBvc3QtbG9hZCBj\nYWxsYmFjayBvbiB0aGUNCiAgICAgKiBsb2FkZWQgaW5zdGFuY2UuDQogICAg\nICovDQogICAgcHVibGljIHZvaWQgc2V0UG9zdExvYWQgKGJvb2xlYW4gZmxh\nZykgew0KICAgICAgICBpZiAoX3JlYWRPbmx5ICYmIGZsYWcgIT0gaXNQb3N0\nTG9hZCgpKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3Bl\ncmF0aW9uRXhjZXB0aW9uKCk7DQogICAgCV9wb3N0TG9hZCA9IChmbGFnKSA/\nIEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0U7DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogV2hldGhlciBsb2FkaW5nIHRoaXMgZmV0Y2ggZ3JvdXAg\nY2F1c2VzIGEgcG9zdC1sb2FkIGNhbGxiYWNrIG9uIHRoZQ0KICAgICAqIGxv\nYWRlZCBpbnN0YW5jZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc1Bvc3RMb2FkICgpIHsNCiAgICAJaWYgKF9wb3N0TG9hZCAhPSBudWxsKQ0K\nICAgICAgICAgICAgcmV0dXJuIF9wb3N0TG9hZC5ib29sZWFuVmFsdWUoKTsN\nCg0KICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCkgew0KICAgICAgICAgICAg\nQ2xhc3NNZXRhRGF0YSBzdXAgPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRh\nRGF0YSgpOw0KICAgICAgICAgICAgaWYgKHN1cCAhPSBudWxsKSB7DQogICAg\nICAgICAgICAgICAgRmV0Y2hHcm91cCBzdXBGRyA9IHN1cC5nZXRGZXRjaEdy\nb3VwKF9uYW1lKTsNCiAgICAgICAgICAgICAgICBpZiAoc3VwRkcgIT0gbnVs\nbCAmJiBzdXBGRy5pc1Bvc3RMb2FkKCkpDQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAg\nICAgICAgaWYgKF9pbmNsdWRlcyA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOw0KICAgICAgICBGZXRjaEdyb3VwIGZnOw0KICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IF9pbmNsdWRlcy5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykgew0KICAgICAgICAgICAgZmcgPSBfbWV0YS5nZXRGZXRj\naEdyb3VwKChTdHJpbmcpIGl0ci5uZXh0KCkpOw0KICAgICAgICAgICAgaWYg\nKGZnICE9IG51bGwgJiYgZmcuaXNQb3N0TG9hZCgpKQ0KICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBm\nYWxzZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBXaGV0aGVyIHRoZSBw\nb3N0LWxvYWQgdmFsdWUgaXMgZGVjbGFyZWQgZm9yIHRoaXMgZ3JvdXAuICAN\nCiAgICAgKi8NCiAgICBwdWJsaWMgYm9vbGVhbiBpc1Bvc3RMb2FkRXhwbGlj\naXQoKSB7DQogICAgICAgIHJldHVybiBfcG9zdExvYWQgIT0gbnVsbDsNCiAg\nICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXNvbHZlIGFuZCB2YWxpZGF0ZSBm\nZXRjaCBncm91cCBtZXRhZGF0YS4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9p\nZCByZXNvbHZlKCkgew0KICAgICAgICBpZiAoX2luY2x1ZGVzID09IG51bGwp\nDQogICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgLy8gdmFsaWRhdGUg\naW5jbHVkZXMNCiAgICAgICAgU3RyaW5nIG5hbWU7DQogICAgICAgIEZldGNo\nR3JvdXAgZmc7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2luY2x1\nZGVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAg\nICBuYW1lID0gKFN0cmluZykgaXRyLm5leHQoKTsNCiAgICAgICAgICAgIGlm\nIChuYW1lLmVxdWFscyhfbmFtZSkpDQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJjeWNsaWMtZmciLCB0\naGlzLCBuYW1lKSk7DQogICAgICAgICAgICBmZyA9IF9tZXRhLmdldEZldGNo\nR3JvdXAobmFtZSk7DQogICAgICAgICAgICBpZiAoZmcgPT0gbnVsbCkNCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1mZy1pbmNsdWRlIiwgdGhpcywNCiAgICAgICAgICAgICAg\nICAgICAgbmFtZSkpOw0KICAgICAgICAgICAgaWYgKGZnLmluY2x1ZGVzKF9u\nYW1lLCB0cnVlKSkNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURh\ndGFFeGNlcHRpb24oX2xvYy5nZXQoImN5Y2xpYy1mZyIsIHRoaXMsIG5hbWUp\nKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvKioNCiAgICAgKiBB\nZmZpcm1zIGVxdWFsaXR5IGlmIHRoZSBvdGhlciBoYXMgdGhlIHNhbWUgbmFt\nZSBhbmQgZGVjbGFyaW5nIHR5cGUuDQogICAgICovDQogICAgcHVibGljIGJv\nb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgew0KICAgICAgICBpZiAob3Ro\nZXIgPT0gdGhpcykNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAg\nICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIEZldGNoR3JvdXApKQ0KICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICBGZXRjaEdyb3VwIHRoYXQg\nPSAoRmV0Y2hHcm91cCkgb3RoZXI7DQogICAgICAgIHJldHVybiBfbmFtZS5l\ncXVhbHModGhhdC5fbmFtZSkNCiAgICAgICAgICAgICYmIE9iamVjdFV0aWxz\nLmVxdWFscyhfbWV0YSwgdGhhdC5fbWV0YSk7DQogICAgfQ0KDQogICAgcHVi\nbGljIGludCBoYXNoQ29kZSgpIHsNCiAgICAgICAgcmV0dXJuIF9uYW1lLmhh\nc2hDb2RlKCkgKyAoKF9tZXRhID09IG51bGwpID8gMCA6IF9tZXRhLmhhc2hD\nb2RlKCkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmco\nKSB7DQogICAgICAgIHJldHVybiAoKF9tZXRhID09IG51bGwpID8gIkJ1aWx0\naW4iIDogX21ldGEudG9TdHJpbmcgKCkpICsgIi4iICsgX25hbWU7DQogICAg\nfQ0KfQ0K\n","encoding":"base64"}

