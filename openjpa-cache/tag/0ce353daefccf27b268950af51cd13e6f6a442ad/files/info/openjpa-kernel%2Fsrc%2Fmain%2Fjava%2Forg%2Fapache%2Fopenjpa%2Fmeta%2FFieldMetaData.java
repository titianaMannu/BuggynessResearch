{"sha":"2961d38d25e0cfe8035cf120a8f1f6bf36f45280","node_id":"MDQ6QmxvYjIwNjM2NDoyOTYxZDM4ZDI1ZTBjZmU4MDM1Y2YxMjBhOGYxZjZiZjM2ZjQ1Mjgw","size":61140,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2961d38d25e0cfe8035cf120a8f1f6bf36f45280","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhOwoKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkNvbnN0\ncnVjdG9yOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9y\ndCBqYXZhLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWVtYmVyOwppbXBvcnQgamF2\nYS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5sYW5nLnJlZmxl\nY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuVGltZVpvbmU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmNvbXBhcmF0\nb3JzLkNvbXBhcmF0b3JDaGFpbjsKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlQ29udGV4\ndDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1\ncmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KYXZhVmVy\nc2lvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9w\ndGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnhtbC5Db21t\nZW50YWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2Vw\ndGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5h\nbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1l\ndGFEYXRhRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLlVuc3VwcG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGls\nLlN0cmluZ3M7CgovKioKICogTWV0YWRhdGEgZm9yIGEgbWFuYWdlZCBjbGFz\ncyBmaWVsZC4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBj\nbGFzcyBGaWVsZE1ldGFEYXRhCiAgICBleHRlbmRzIEV4dGVuc2lvbnMKICAg\nIGltcGxlbWVudHMgVmFsdWVNZXRhRGF0YSwgTWV0YURhdGFDb250ZXh0LCBN\nZXRhRGF0YU1vZGVzLCBDb21tZW50YWJsZSB7CgogICAgLyoqCiAgICAgKiBD\nb25zdGFudCBzcGVjaWZ5aW5nIHRoYXQgbm8gbnVsbC12YWx1ZSB3YXMgZ2l2\nZW4uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE5VTExf\nVU5TRVQgPSAtMTsKCiAgICAvKioKICAgICAqIENvbnN0YW50IHNwZWNpZnlp\nbmcgdG8gdXNlIGEgZGF0YXN0b3JlIG51bGwgdG8gcGVyc2lzdCBudWxsIHZh\nbHVlcwogICAgICogaW4gb2JqZWN0IGZpZWxkcy4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgTlVMTF9OT05FID0gMDsKCiAgICAvKioK\nICAgICAqIENvbnN0YW50IHNwZWNpZnlpbmcgdG8gdXNlIGEgZGF0YXN0b3Jl\nIGRlZmF1bHQgdmFsdWUgdG8gcGVyc2lzdCBudWxsCiAgICAgKiB2YWx1ZXMg\naW4gb2JqZWN0IGZpZWxkcy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBpbnQgTlVMTF9ERUZBVUxUID0gMTsKCiAgICAvKioKICAgICAqIENv\nbnN0YW50IHNwZWNpZnlpbmcgdG8gdGhyb3cgYW4gZXhjZXB0aW9uIHdoZW4g\nYXR0ZW1wdGluZyB0byBwZXJzaXN0CiAgICAgKiBudWxsIHZhbHVlcyBpbiBv\nYmplY3QgZmllbGRzLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBOVUxMX0VYQ0VQVElPTiA9IDI7CgogICAgLyoqCiAgICAgKiBDb25z\ndGFudCBzcGVjaWZ5aW5nIHRoZSBtYW5hZ2VtZW50IGxldmVsIG9mIGEgZmll\nbGQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1BTkFH\nRV9QRVJTSVNURU5UID0gMzsKCiAgICAvKioKICAgICAqIENvbnN0YW50IHNw\nZWNpZnlpbmcgdGhlIG1hbmFnZW1lbnQgbGV2ZWwgb2YgYSBmaWVsZC4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTUFOQUdFX1RSQU5T\nQUNUSU9OQUwgPSAxOwoKICAgIC8qKgogICAgICogQ29uc3RhbnQgc3BlY2lm\neWluZyB0aGUgbWFuYWdlbWVudCBsZXZlbCBvZiBhIGZpZWxkLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBNQU5BR0VfTk9ORSA9IDA7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChGaWVsZE1ldGFEYXRhLmNs\nYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREZHX0ZBTFNF\nID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBERkdfVFJVRSA9\nIDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREZHX0VYUExJQ0lU\nID0gNDsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBNZXRob2QgREVGQVVM\nVF9NRVRIT0Q7CiAgICBzdGF0aWMgewogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIERFRkFVTFRfTUVUSE9EID0gT2JqZWN0LmNsYXNzLmdldE1ldGhvZCgi\nd2FpdCIsIChDbGFzc1tdKSBudWxsKTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAvLyBzaG91bGRuJ3QgZXZlciBoYXBw\nZW4KICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBuYW1lIGFuZCB0eXBlCiAgICBw\ncml2YXRlIGZpbmFsIFZhbHVlTWV0YURhdGEgX3ZhbDsKICAgIHByaXZhdGUg\nZmluYWwgVmFsdWVNZXRhRGF0YSBfa2V5OwogICAgcHJpdmF0ZSBmaW5hbCBW\nYWx1ZU1ldGFEYXRhIF9lbGVtOwogICAgcHJpdmF0ZSBmaW5hbCBDbGFzc01l\ndGFEYXRhIF9vd25lcjsKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIF9uYW1l\nOwogICAgcHJpdmF0ZSBDbGFzcyBfZGVjID0gbnVsbDsKICAgIHByaXZhdGUg\nQ2xhc3NNZXRhRGF0YSBfZGVjTWV0YSA9IG51bGw7CiAgICBwcml2YXRlIFN0\ncmluZyBfZnVsbE5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2Vt\nYmVkRnVsbE5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX3Jlc01vZGUg\nPSBNT0RFX05PTkU7CgogICAgLy8gbG9hZC9zdG9yZSBpbmZvCiAgICBwcml2\nYXRlIFN0cmluZ1tdIF9jb21tZW50cyA9IG51bGw7CiAgICBwcml2YXRlIGlu\ndCBfbGlzdEluZGV4ID0gLTE7CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8KICAgIC8vIE5vdGU6IGlmIHlvdSBhZGQgYWRkaXRpb25hbCBzdGF0ZSwg\nbWFrZSBzdXJlIHRvIGFkZCBpdCB0byBjb3B5KCkKICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vCgogICAgLy8gbWlzYyBpbmZvCiAgICBwcml2YXRlIENs\nYXNzIF9wcm94eUNsYXNzID0gbnVsbDsKICAgIHByaXZhdGUgT2JqZWN0IF9p\nbml0aWFsaXplciA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX3RyYW5z\naWVudCA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9wcmltS2V5ID0g\nZmFsc2U7CiAgICBwcml2YXRlIEJvb2xlYW4gX3ZlcnNpb24gPSBudWxsOwog\nICAgcHJpdmF0ZSBpbnQgX251bGxWYWx1ZSA9IE5VTExfVU5TRVQ7CiAgICBw\ncml2YXRlIGludCBfbWFuYWdlID0gTUFOQUdFX1BFUlNJU1RFTlQ7CiAgICBw\ncml2YXRlIGludCBfaW5kZXggPSAtMTsKICAgIHByaXZhdGUgaW50IF9kZWNJ\nbmRleCA9IC0xOwogICAgcHJpdmF0ZSBpbnQgX3BrSW5kZXggPSAtMTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfZXhwbGljaXQgPSBmYWxzZTsKICAgIHByaXZh\ndGUgaW50IF9kZmcgPSAwOwogICAgcHJpdmF0ZSBTZXQgX2ZnU2V0ID0gbnVs\nbDsKICAgIHByaXZhdGUgU3RyaW5nW10gX2ZncyA9IG51bGw7CiAgICBwcml2\nYXRlIFN0cmluZyAgIF9sZmcgPSBudWxsOwogICAgcHJpdmF0ZSBCb29sZWFu\nIF9scnMgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2V4dE5hbWUgPSBu\ndWxsOwogICAgcHJpdmF0ZSBNZXRob2QgX2V4dE1ldGhvZCA9IERFRkFVTFRf\nTUVUSE9EOwogICAgcHJpdmF0ZSBTdHJpbmcgX2ZhY3ROYW1lID0gbnVsbDsK\nICAgIHByaXZhdGUgTWVtYmVyIF9mYWN0TWV0aG9kID0gREVGQVVMVF9NRVRI\nT0Q7CiAgICBwcml2YXRlIFN0cmluZyBfZXh0U3RyaW5nID0gbnVsbDsKICAg\nIHByaXZhdGUgTWFwIF9leHRWYWx1ZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9N\nQVA7CiAgICBwcml2YXRlIE1hcCBfZmllbGRWYWx1ZXMgPSBDb2xsZWN0aW9u\ncy5FTVBUWV9NQVA7CiAgICBwcml2YXRlIE1lbWJlciBfYmFja2luZ01lbWJl\nciA9IG51bGw7CgogICAgLy8gaW50ZXJtZWRpYXRlIGFuZCBpbXBsIGRhdGEK\nICAgIHByaXZhdGUgYm9vbGVhbiBfaW50ZXJtZWRpYXRlID0gdHJ1ZTsKICAg\nIHByaXZhdGUgQm9vbGVhbiBfaW1wbERhdGEgPSBCb29sZWFuLlRSVUU7Cgog\nICAgLy8gdmFsdWUgZ2VuZXJhdGlvbgogICAgcHJpdmF0ZSBpbnQgX3ZhbFN0\ncmF0ZWd5ID0gLTE7CiAgICBwcml2YXRlIGludCBfdXBTdHJhdGVneSA9IC0x\nOwogICAgcHJpdmF0ZSBTdHJpbmcgX3NlcU5hbWUgPSBDbGFzc01ldGFEYXRh\nLkRFRkFVTFRfU1RSSU5HOwogICAgcHJpdmF0ZSBTZXF1ZW5jZU1ldGFEYXRh\nIF9zZXFNZXRhID0gbnVsbDsKCiAgICAvLyBpbnZlcnNlcwogICAgcHJpdmF0\nZSBTdHJpbmcgX21hcHBlZEJ5ID0gbnVsbDsKICAgIHByaXZhdGUgRmllbGRN\nZXRhRGF0YSBfbWFwcGVkQnlNZXRhID0gbnVsbDsKICAgIHByaXZhdGUgRmll\nbGRNZXRhRGF0YVtdIF9pbnZlcnNlcyA9IG51bGw7CiAgICBwcml2YXRlIFN0\ncmluZyBfaW52ZXJzZSA9IENsYXNzTWV0YURhdGEuREVGQVVMVF9TVFJJTkc7\nCgogICAgLy8gb3JkZXJpbmcgb24gbG9hZAogICAgcHJpdmF0ZSBPcmRlcltd\nIF9vcmRlcnMgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX29yZGVyRGVj\nID0gbnVsbDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLgogICAgICoK\nICAgICAqIEBwYXJhbSBuYW1lIHRoZSBmaWVsZCBuYW1lCiAgICAgKiBAcGFy\nYW0gdHlwZSB0aGUgZmllbGQgdHlwZQogICAgICogQHBhcmFtIG93bmVyIHRo\nZSBvd25pbmcgY2xhc3MgbWV0YWRhdGEKICAgICAqLwogICAgcHJvdGVjdGVk\nIEZpZWxkTWV0YURhdGEoU3RyaW5nIG5hbWUsIENsYXNzIHR5cGUsIENsYXNz\nTWV0YURhdGEgb3duZXIpIHsKICAgICAgICBfbmFtZSA9IG5hbWU7CiAgICAg\nICAgX293bmVyID0gb3duZXI7CiAgICAgICAgX2RlYyA9IG51bGw7CiAgICAg\nICAgX2RlY01ldGEgPSBudWxsOwogICAgICAgIF92YWwgPSBvd25lci5nZXRS\nZXBvc2l0b3J5KCkubmV3VmFsdWVNZXRhRGF0YSh0aGlzKTsKICAgICAgICBf\na2V5ID0gb3duZXIuZ2V0UmVwb3NpdG9yeSgpLm5ld1ZhbHVlTWV0YURhdGEo\ndGhpcyk7CiAgICAgICAgX2VsZW0gPSBvd25lci5nZXRSZXBvc2l0b3J5KCku\nbmV3VmFsdWVNZXRhRGF0YSh0aGlzKTsKCiAgICAgICAgc2V0RGVjbGFyZWRU\neXBlKHR5cGUpOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcGx5IHRoZSBi\nYWNraW5nIG1lbWJlciBvYmplY3Q7IHRoaXMgYWxsb3dzIHVzIHRvIHV0aWxp\nemUKICAgICAqIHBhcmFtZXRlcml6ZWQgdHlwZSBpbmZvcm1hdGlvbiBpZiBh\ndmFpbGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGJhY2tpbmdNZW1i\nZXIoTWVtYmVyIG1lbWJlcikgewogICAgICAgIGlmIChtZW1iZXIgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmIChNb2RpZmllci5p\nc1RyYW5zaWVudChtZW1iZXIuZ2V0TW9kaWZpZXJzKCkpKQogICAgICAgICAg\nICBfdHJhbnNpZW50ID0gdHJ1ZTsKCiAgICAgICAgX2JhY2tpbmdNZW1iZXIg\nPSBtZW1iZXI7CgogICAgICAgIENsYXNzIHR5cGU7CiAgICAgICAgQ2xhc3Nb\nXSB0eXBlczsKICAgICAgICBpZiAobWVtYmVyIGluc3RhbmNlb2YgRmllbGQp\nIHsKICAgICAgICAgICAgRmllbGQgZiA9IChGaWVsZCkgbWVtYmVyOwogICAg\nICAgICAgICB0eXBlID0gZi5nZXRUeXBlKCk7CiAgICAgICAgICAgIHR5cGVz\nID0gSmF2YVZlcnNpb25zLmdldFBhcmFtZXRlcml6ZWRUeXBlcyhmKTsKICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICBNZXRob2QgbWV0aCA9IChNZXRo\nb2QpIG1lbWJlcjsKICAgICAgICAgICAgdHlwZSA9IG1ldGguZ2V0UmV0dXJu\nVHlwZSgpOwogICAgICAgICAgICB0eXBlcyA9IEphdmFWZXJzaW9ucy5nZXRQ\nYXJhbWV0ZXJpemVkVHlwZXMobWV0aCk7CiAgICAgICAgfQoKICAgICAgICBz\nZXREZWNsYXJlZFR5cGUodHlwZSk7CiAgICAgICAgaWYgKENvbGxlY3Rpb24u\nY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBlKQogICAgICAgICAgICAmJiBf\nZWxlbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmplY3QuY2xhc3MKICAgICAg\nICAgICAgJiYgdHlwZXMubGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgX2Vs\nZW0uc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzBdKTsKICAgICAgICB9IGVsc2Ug\naWYgKE1hcC5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUpCiAgICAgICAg\nICAgICYmIHR5cGVzLmxlbmd0aCA9PSAyKSB7CiAgICAgICAgICAgIGlmIChf\na2V5LmdldERlY2xhcmVkVHlwZSgpID09IE9iamVjdC5jbGFzcykKICAgICAg\nICAgICAgICAgIF9rZXkuc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzBdKTsKICAg\nICAgICAgICAgaWYgKF9lbGVtLmdldERlY2xhcmVkVHlwZSgpID09IE9iamVj\ndC5jbGFzcykKICAgICAgICAgICAgICAgIF9lbGVtLnNldERlY2xhcmVkVHlw\nZSh0eXBlc1sxXSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBiYWNraW5nIG1lbWJlciBzdXBwbGllZCBpbiB7QGxpbmsg\nI2JhY2tpbmdNZW1iZXJ9LgogICAgICovCiAgICBwdWJsaWMgTWVtYmVyIGdl\ndEJhY2tpbmdNZW1iZXIoKSB7CiAgICAgICAgcmV0dXJuIF9iYWNraW5nTWVt\nYmVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG1ldGFkYXRhIHJlcG9z\naXRvcnkuCiAgICAgKi8KICAgIHB1YmxpYyBNZXRhRGF0YVJlcG9zaXRvcnkg\nZ2V0UmVwb3NpdG9yeSgpIHsKICAgICAgICByZXR1cm4gX293bmVyLmdldFJl\ncG9zaXRvcnkoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBjbGFzcyB0\naGF0IGRlZmluZXMgdGhlIG1ldGFkYXRhIGZvciB0aGlzIGZpZWxkLgogICAg\nICovCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXREZWZpbmluZ01ldGFE\nYXRhKCkgewogICAgICAgIHJldHVybiBfb3duZXI7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgZGVjbGFyaW5nIGNsYXNzLgogICAgICovCiAgICBwdWJs\naWMgQ2xhc3MgZ2V0RGVjbGFyaW5nVHlwZSgpIHsKICAgICAgICByZXR1cm4g\nKF9kZWMgPT0gbnVsbCkgPyBfb3duZXIuZ2V0RGVzY3JpYmVkVHlwZSgpIDog\nX2RlYzsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWNsYXJpbmcgY2xh\nc3MuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmluZ1R5cGUo\nQ2xhc3MgY2xzKSB7CiAgICAgICAgX2RlYyA9IGNsczsKICAgICAgICBfZGVj\nTWV0YSA9IG51bGw7CiAgICAgICAgX2Z1bGxOYW1lID0gbnVsbDsKICAgICAg\nICBfZW1iZWRGdWxsTmFtZSA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgZGVjbGFyaW5nIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgQ2xh\nc3NNZXRhRGF0YSBnZXREZWNsYXJpbmdNZXRhRGF0YSgpIHsKICAgICAgICBp\nZiAoX2RlYyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gX293bmVyOwog\nICAgICAgIGlmIChfZGVjTWV0YSA9PSBudWxsKQogICAgICAgICAgICBfZGVj\nTWV0YSA9IGdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0YShfZGVjLAogICAg\nICAgICAgICAgICAgX293bmVyLmdldEVudkNsYXNzTG9hZGVyKCksIHRydWUp\nOwogICAgICAgIHJldHVybiBfZGVjTWV0YTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBmaWVsZCBuYW1lLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGdldE5hbWUoKSB7CiAgICAgICAgcmV0dXJuIF9uYW1lOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGZpZWxkIG5hbWUsIHF1YWxpZmllZCBieSB0aGUg\nb3duaW5nIGNsYXNzLgogICAgICogQGRlcHJlY2F0ZWQgVXNlIGdldEZ1bGxO\nYW1lKGJvb2xlYW4pIGluc3RlYWQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJp\nbmcgZ2V0RnVsbE5hbWUoKSB7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1l\nKGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVsZCBuYW1l\nLCBxdWFsaWZpZWQgYnkgdGhlIG93bmluZyBjbGFzcyBhbmQgb3B0aW9uYWxs\neSB0aGUKICAgICAqIGVtYmVkZGluZyBvd25lcidzIG5hbWUgKGlmIGFueSku\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RnVsbE5hbWUoYm9vbGVh\nbiBlbWJlZE93bmVyKSB7CiAgICAgICAgaWYgKF9mdWxsTmFtZSA9PSBudWxs\nKQogICAgICAgICAgICBfZnVsbE5hbWUgPSBnZXREZWNsYXJpbmdUeXBlKCku\nZ2V0TmFtZSgpICsgIi4iICsgX25hbWU7CiAgICAgICAgaWYgKGVtYmVkT3du\nZXIgJiYgX2VtYmVkRnVsbE5hbWUgPT0gbnVsbCkgewogICAgICAgICAgICBp\nZiAoX293bmVyLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIF9lbWJlZEZ1bGxOYW1lID0gX2Z1bGxOYW1lOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBfZW1iZWRGdWxsTmFtZSA9\nIF9vd25lci5nZXRFbWJlZGRpbmdNZXRhRGF0YSgpLgogICAgICAgICAgICAg\nICAgICAgIGdldEZpZWxkTWV0YURhdGEoKS5nZXRGdWxsTmFtZSh0cnVlKSAr\nICIuIiArIF9mdWxsTmFtZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChl\nbWJlZE93bmVyKSA/IF9lbWJlZEZ1bGxOYW1lIDogX2Z1bGxOYW1lOwogICAg\nfQoKICAgIC8qKgogICAgICogTWV0YURhdGEgYWJvdXQgdGhlIGZpZWxkIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgVmFsdWVNZXRhRGF0YSBnZXRWYWx1\nZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIE1ldGFkYXRhIGFib3V0IHRoZSBrZXkgdmFsdWUuCiAgICAgKi8KICAg\nIHB1YmxpYyBWYWx1ZU1ldGFEYXRhIGdldEtleSgpIHsKICAgICAgICByZXR1\ncm4gX2tleTsKICAgIH0KCiAgICAvKioKICAgICAqIE1ldGFkYXRhIGFib3V0\nIHRoZSBlbGVtZW50IHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgVmFsdWVN\nZXRhRGF0YSBnZXRFbGVtZW50KCkgewogICAgICAgIHJldHVybiBfZWxlbTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoaXMgZmll\nbGQgaXMgbWFwcGVkIHRvIHRoZSBkYXRhc3RvcmUuIEJ5IGRlZmF1bHQsCiAg\nICAgKiByZXR1cm5zIHRydWUgZm9yIGFsbCBwZXJzaXN0ZW50IGZpZWxkcyB3\naG9zZSBkZWZpbmluZyBjbGFzcyBpcyBtYXBwZWQuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGlzTWFwcGVkKCkgewogICAgICAgIHJldHVybiBfbWFu\nYWdlID09IE1BTkFHRV9QRVJTSVNURU5UICYmIF9vd25lci5pc01hcHBlZCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHR5cGUgdGhpcyBmaWVsZCB3\nYXMgaW5pdGlhbGl6ZWQgd2l0aCwgYW5kIHRoZXJlZm9yZSB0aGUKICAgICAq\nIHR5cGUgdG8gdXNlIGZvciBwcm94aWVzIHdoZW4gbG9hZGluZyBkYXRhIGlu\ndG8gdGhpcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIENsYXNzIGdldFBy\nb3h5VHlwZSgpIHsKICAgICAgICByZXR1cm4gKF9wcm94eUNsYXNzID09IG51\nbGwpID8gZ2V0RGVjbGFyZWRUeXBlKCkgOiBfcHJveHlDbGFzczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSB0eXBlIHRoaXMgZmllbGQgd2FzIGluaXRp\nYWxpemVkIHdpdGgsIGFuZCB0aGVyZWZvcmUgdGhlCiAgICAgKiB0eXBlIHRv\nIHVzZSBmb3IgcHJveGllcyB3aGVuIGxvYWRpbmcgZGF0YSBpbnRvIHRoaXMg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByb3h5VHlwZShD\nbGFzcyB0eXBlKSB7CiAgICAgICAgX3Byb3h5Q2xhc3MgPSB0eXBlOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIGluaXRpYWxpemVyIHVzZWQgYnkgdGhl\nIGZpZWxkLCBvciBudWxsIGlmIG5vbmUuIFRoaXMKICAgICAqIGlzIGFkZGl0\naW9uYWwgaW5mb3JtYXRpb24gZm9yIGluaXRpYWxpemluZyB0aGUgZmllbGQs\nIHN1Y2ggYXMKICAgICAqIGEgY3VzdG9tIHtAbGluayBDb21wYXJhdG9yfSB1\nc2VkIGJ5IGEge0BsaW5rIFNldH0gb3IKICAgICAqIGEge0BsaW5rIFRpbWVa\nb25lfSB1c2VkIGJ5IGEge0BsaW5rIENhbGVuZGFyfS4KICAgICAqLwogICAg\ncHVibGljIE9iamVjdCBnZXRJbml0aWFsaXplcigpIHsKICAgICAgICByZXR1\ncm4gX2luaXRpYWxpemVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGlu\naXRpYWxpemVyIHVzZWQgYnkgdGhlIGZpZWxkLCBvciBudWxsIGlmIG5vbmUu\nIFRoaXMKICAgICAqIGlzIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gZm9yIGlu\naXRpYWxpemluZyB0aGUgZmllbGQsIHN1Y2ggYXMKICAgICAqIGEgY3VzdG9t\nIHtAbGluayBDb21wYXJhdG9yfSB1c2VkIGJ5IGEge0BsaW5rIFNldH0gb3IK\nICAgICAqIGEge0BsaW5rIFRpbWVab25lfSB1c2VkIGJ5IGEge0BsaW5rIENh\nbGVuZGFyfS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0SW5pdGlhbGl6\nZXIoT2JqZWN0IGluaXRpYWxpemVyKSB7CiAgICAgICAgX2luaXRpYWxpemVy\nID0gaW5pdGlhbGl6ZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\nd2hldGhlciB0aGlzIGlzIGEgdHJhbnNpZW50IGZpZWxkLgogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zaWVudCgpIHsKICAgICAgICByZXR1\ncm4gX3RyYW5zaWVudDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3\naGV0aGVyIHRoaXMgaXMgYSB0cmFuc2llbnQgZmllbGQuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFRyYW5zaWVudChib29sZWFuIHRyYW5zKSB7CiAg\nICAgICAgX3RyYW5zaWVudCA9IHRyYW5zOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIGFic29sdXRlIGluZGV4IG9mIHRoaXMgcGVyc2lzdGVudC90cmFu\nc2FjdGlvbmFsIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldElu\nZGV4KCkgewogICAgICAgIHJldHVybiBfaW5kZXg7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgYWJzb2x1dGUgaW5kZXggb2YgdGhpcyBwZXJzaXN0ZW50\nL3RyYW5zYWN0aW9uYWwgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldEluZGV4KGludCBpbmRleCkgewogICAgICAgIF9pbmRleCA9IGluZGV4\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHJlbGF0aXZlIGluZGV4IG9m\nIHRoaXMgcGVyc2lzdGVudC90cmFuc2FjdGlvbmFsIGZpZWxkLgogICAgICov\nCiAgICBwdWJsaWMgaW50IGdldERlY2xhcmVkSW5kZXgoKSB7CiAgICAgICAg\ncmV0dXJuIF9kZWNJbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBy\nZWxhdGl2ZSBpbmRleCBvZiB0aGlzIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25h\nbCBmaWVsZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGVjbGFyZWRJ\nbmRleChpbnQgaW5kZXgpIHsKICAgICAgICBfZGVjSW5kZXggPSBpbmRleDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBpbmRleCBpbiB3aGljaCB0aGlz\nIGZpZWxkIHdhcyBsaXN0ZWQgaW4gdGhlIG1ldGFkYXRhLiBEZWZhdWx0cyB0\nbwogICAgICogPGNvZGU+LTE8L2NvZGU+IGlmIHRoaXMgZmllbGQgd2FzIG5v\ndCBsaXN0ZWQgaW4gdGhlIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMg\naW50IGdldExpc3RpbmdJbmRleCgpIHsKICAgICAgICByZXR1cm4gX2xpc3RJ\nbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBpbmRleCBpbiB3aGlj\naCB0aGlzIGZpZWxkIHdhcyBsaXN0ZWQgaW4gdGhlIG1ldGFkYXRhLiBEZWZh\ndWx0cyB0bwogICAgICogPGNvZGU+LTE8L2NvZGU+IGlmIHRoaXMgZmllbGQg\nd2FzIG5vdCBsaXN0ZWQgaW4gdGhlIG1ldGFkYXRhLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRMaXN0aW5nSW5kZXgoaW50IGluZGV4KSB7CiAgICAg\nICAgX2xpc3RJbmRleCA9IGluZGV4OwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGFic29sdXRlIHByaW1hcnkga2V5IGluZGV4IGZvciB0aGlzIGZpZWxk\nLCBvciAtMSBpZiBub3QgYSBwcmltYXJ5CiAgICAgKiBrZXkuIFRoZSBmaXJz\ndCBwcmltYXJ5IGtleSBmaWVsZCBoYXMgaW5kZXggMCwgdGhlIHNlY29uZCBp\nbmRleCAxLCBldGMuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0UHJpbWFy\neUtleUluZGV4KCkgewogICAgICAgIHJldHVybiBfcGtJbmRleDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0ZSBwcmltYXJ5IGtleSBpbmRl\neCBmb3IgdGhpcyBmaWVsZCwgb3IgLTEgaWYgbm90IGEgcHJpbWFyeQogICAg\nICoga2V5LiBUaGUgZmlyc3QgcHJpbWFyeSBrZXkgZmllbGQgaGFzIGluZGV4\nIDAsIHRoZSBzZWNvbmQgaW5kZXggMSwgZXRjLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRQcmltYXJ5S2V5SW5kZXgoaW50IGluZGV4KSB7CiAgICAg\nICAgX3BrSW5kZXggPSBpbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgbWFuYWdlbWVudCBsZXZlbCBmb3IgdGhlIGZpZWxkLiBXaWxs\nIGJlIG9uZSBvZjoKICAgICAqIDx1bD4KICAgICAqIDxsaT57QGxpbmsgI01B\nTkFHRV9QRVJTSVNURU5UfTogdGhlIGZpZWxkIGlzIHBlcnNpc3RlbnQ8L2xp\nPgogICAgICogPGxpPntAbGluayAjTUFOQUdFX1RSQU5TQUNUSU9OQUx9OiB0\naGUgZmllbGQgaXMgdHJhbnNhY3Rpb25hbCBidXQgbm90CiAgICAgKiBwZXJz\naXN0ZW50PC9saT4KICAgICAqIDxsaT57QGxpbmsgI01BTkFHRV9OT05FfTog\ndGhlIGZpZWxkIGlzIG5vdCBtYW5hZ2VkPC9saT4KICAgICAqIDwvdWw+IERl\nZmF1bHRzIHRvIHtAbGluayAjTUFOQUdFX1BFUlNJU1RFTlR9LgogICAgICov\nCiAgICBwdWJsaWMgaW50IGdldE1hbmFnZW1lbnQoKSB7CiAgICAgICAgcmV0\ndXJuIF9tYW5hZ2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIG1hbmFnZW1lbnQgbGV2ZWwgZm9yIHRoZSBmaWVsZC4gV2lsbCBiZSBvbmUg\nb2Y6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfUEVS\nU0lTVEVOVH06IHRoZSBmaWVsZCBpcyBwZXJzaXN0ZW50PC9saT4KICAgICAq\nIDxsaT57QGxpbmsgI01BTkFHRV9UUkFOU0FDVElPTkFMfTogdGhlIGZpZWxk\nIGlzIHRyYW5zYWN0aW9uYWwgYnV0IG5vdAogICAgICogcGVyc2lzdGVudDwv\nbGk+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfTk9ORX06IHRoZSBmaWVs\nZCBpcyBub3QgbWFuYWdlZDwvbGk+CiAgICAgKiA8L3VsPiAKICAgICAqIERl\nZmF1bHRzIHRvIHtAbGluayAjTUFOQUdFX1BFUlNJU1RFTlR9LgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRNYW5hZ2VtZW50KGludCBtYW5hZ2UpIHsK\nICAgICAgICBpZiAoKF9tYW5hZ2UgPT0gTUFOQUdFX05PTkUpICE9IChtYW5h\nZ2UgPT0gTUFOQUdFX05PTkUpKQogICAgICAgICAgICBfb3duZXIuY2xlYXJG\naWVsZENhY2hlKCk7CiAgICAgICAgX21hbmFnZSA9IG1hbmFnZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBpcyBhIHByaW1hcnkga2V5\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1ByaW1hcnlL\nZXkoKSB7CiAgICAgICAgcmV0dXJuIF9wcmltS2V5OwogICAgfQoKICAgIC8q\nKgogICAgICogV2hldGhlciB0aGlzIGlzIGEgcHJpbWFyeSBrZXkgZmllbGQu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXkoYm9vbGVh\nbiBwcmltS2V5KSB7CiAgICAgICAgX3ByaW1LZXkgPSBwcmltS2V5OwogICAg\nfQoKICAgIC8qKgogICAgICogRm9yIGEgcHJpbWFyeSBrZXkgZmllbGQsIHJl\ndHVybiB0aGUgdHlwZSBvZiB0aGUgY29ycmVzcG9uZGluZyBvYmplY3QgaWQg\nCiAgICAgKiBjbGFzcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGludCBn\nZXRPYmplY3RJZEZpZWxkVHlwZUNvZGUoKSB7CiAgICAgICAgQ2xhc3NNZXRh\nRGF0YSByZWxtZXRhID0gZ2V0RGVjbGFyZWRUeXBlTWV0YURhdGEoKTsKICAg\nICAgICBpZiAocmVsbWV0YSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZ2V0RGVjbGFyZWRUeXBlQ29kZSgpOwogICAgICAgIGlmIChyZWxtZXRhLmdl\ndElkZW50aXR5VHlwZSgpID09IENsYXNzTWV0YURhdGEuSURfREFUQVNUT1JF\nKSB7CiAgICAgICAgICAgIGJvb2xlYW4gdW53cmFwID0gZ2V0UmVwb3NpdG9y\neSgpLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdldERlZmF1bHRzKCkuCiAgICAg\nICAgICAgICAgICBpc0RhdGFTdG9yZU9iamVjdElkRmllbGRVbndyYXBwZWQo\nKTsKICAgICAgICAgICAgcmV0dXJuICh1bndyYXApID8gSmF2YVR5cGVzLkxP\nTkcgOiBKYXZhVHlwZXMuT0JKRUNUOwogICAgICAgIH0KICAgICAgICBpZiAo\ncmVsbWV0YS5pc09wZW5KUEFJZGVudGl0eSgpKQogICAgICAgICAgICByZXR1\ncm4gcmVsbWV0YS5nZXRQcmltYXJ5S2V5RmllbGRzKClbMF0uZ2V0T2JqZWN0\nSWRGaWVsZFR5cGVDb2RlKCk7CiAgICAgICAgcmV0dXJuIEphdmFUeXBlcy5P\nQkpFQ1Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBGb3IgYSBwcmltYXJ5IGtl\neSBmaWVsZCwgcmV0dXJuIHRoZSB0eXBlIG9mIHRoZSBjb3JyZXNwb25kaW5n\nIG9iamVjdCBpZCAKICAgICAqIGNsYXNzIGZpZWxkLgogICAgICovCiAgICBw\ndWJsaWMgQ2xhc3MgZ2V0T2JqZWN0SWRGaWVsZFR5cGUoKSB7CiAgICAgICAg\nQ2xhc3NNZXRhRGF0YSByZWxtZXRhID0gZ2V0RGVjbGFyZWRUeXBlTWV0YURh\ndGEoKTsKICAgICAgICBpZiAocmVsbWV0YSA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICAgICAgc3dpdGNoIChy\nZWxtZXRhLmdldElkZW50aXR5VHlwZSgpKSB7CiAgICAgICAgICAgIGNhc2Ug\nQ2xhc3NNZXRhRGF0YS5JRF9EQVRBU1RPUkU6CiAgICAgICAgICAgICAgICBi\nb29sZWFuIHVud3JhcCA9IGdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0YUZh\nY3RvcnkoKS4KICAgICAgICAgICAgICAgICAgICBnZXREZWZhdWx0cygpLmlz\nRGF0YVN0b3JlT2JqZWN0SWRGaWVsZFVud3JhcHBlZCgpOwogICAgICAgICAg\nICAgICAgcmV0dXJuICh1bndyYXApID8gbG9uZy5jbGFzcyA6IE9iamVjdC5j\nbGFzczsKICAgICAgICAgICAgY2FzZSBDbGFzc01ldGFEYXRhLklEX0FQUExJ\nQ0FUSU9OOgogICAgICAgICAgICAgICAgaWYgKHJlbG1ldGEuaXNPcGVuSlBB\nSWRlbnRpdHkoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVsbWV0\nYS5nZXRQcmltYXJ5S2V5RmllbGRzKClbMF0uCiAgICAgICAgICAgICAgICAg\nICAgICAgIGdldE9iamVjdElkRmllbGRUeXBlKCk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gKHJlbG1ldGEuZ2V0T2JqZWN0SWRUeXBlKCkgPT0gbnVsbCkg\nPyBPYmplY3QuY2xhc3MKICAgICAgICAgICAgICAgICAgICA6IHJlbG1ldGEu\nZ2V0T2JqZWN0SWRUeXBlKCk7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICByZXR1cm4gT2JqZWN0LmNsYXNzOwogICAgICAgIH0gCiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaG9sZHMg\nb3B0aW1pc3RpYyB2ZXJzaW9uIGluZm9ybWF0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc1ZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIF92\nZXJzaW9uID09IEJvb2xlYW4uVFJVRTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdGhpcyBmaWVsZCBob2xkcyBvcHRpbWlzdGljIHZlcnNpb24g\naW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFZlcnNp\nb24oYm9vbGVhbiB2ZXJzaW9uKSB7CiAgICAgICAgX3ZlcnNpb24gPSAodmVy\nc2lvbikgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZBTFNFOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGluIHRoZSBk\nZWZhdWx0IGZldGNoIGdyb3VwLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc0luRGVmYXVsdEZldGNoR3JvdXAoKSB7CiAgICAgICAgaWYgKF9kZmcg\nPT0gMCkgewogICAgICAgICAgICBpZiAoX21hbmFnZSAhPSBNQU5BR0VfUEVS\nU0lTVEVOVCB8fCBpc1ByaW1hcnlLZXkoKSB8fCBpc1ZlcnNpb24oKSkKICAg\nICAgICAgICAgICAgIF9kZmcgPSBERkdfRkFMU0U7CiAgICAgICAgICAgIGVs\nc2UgewogICAgICAgICAgICAgICAgLy8gZmllbGQgbGVmdCBhcyBkZWZhdWx0\nOyBkZmcgc2V0dGluZyBkZXBlbmRzIG9uIHR5cGUKICAgICAgICAgICAgICAg\nIHN3aXRjaCAoZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAgICAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5QQzoKICAgICAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5QQ19VTlRZUEVEOgogICAgICAgICAgICAgICAgICAgICAgICBfZGZnID0g\nREZHX0ZBTFNFOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAg\nICAgICBfZGZnID0gREZHX1RSVUU7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIChfZGZnICYgREZH\nX1RSVUUpID4gMDsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhp\ncyBmaWVsZCBpcyBpbiB0aGUgZGVmYXVsdCBmZXRjaCBncm91cC4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0SW5EZWZhdWx0RmV0Y2hHcm91cChib29s\nZWFuIGRmZykgewogICAgICAgIGlmIChkZmcpCiAgICAgICAgICAgIF9kZmcg\nPSBERkdfVFJVRTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9kZmcgPSBE\nRkdfRkFMU0U7CiAgICAgICAgX2RmZyB8PSBERkdfRVhQTElDSVQ7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBkZWZhdWx0IGZldGNoIGdy\nb3VwIHNldHRpbmcgaXMgZXhwbGljaXQuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGlzRGVmYXVsdEZldGNoR3JvdXBFeHBsaWNpdCgpIHsKICAgICAg\nICByZXR1cm4gKF9kZmcgJiBERkdfRVhQTElDSVQpID4gMDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGRlZmF1bHQgZmV0Y2ggZ3JvdXAg\nc2V0dGluZyBpcyBleHBsaWNpdC4gQWxsb3cgc2V0dGluZwogICAgICogZm9y\nIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERlZmF1bHRG\nZXRjaEdyb3VwRXhwbGljaXQoYm9vbGVhbiBleHBsaWNpdCkgewogICAgICAg\nIGlmIChleHBsaWNpdCkKICAgICAgICAgICAgX2RmZyB8PSBERkdfRVhQTElD\nSVQ7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfZGZnICY9IH5ERkdfRVhQ\nTElDSVQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBuYW1lIG9m\nIHRoZSBjdXN0b20gZmV0Y2ggZ3JvdXBzIHRob3NlIGFyZSBhc3NvY2lhdGVk\nIHRvIHRoaXMgCiAgICAgKiByZWNlaXZlci4gIFRoaXMgZG9lcyBub3QgaW5j\nbHVkZSB0aGUgImRlZmF1bHQiIGFuZCAiYWxsIiBmZXRjaCBncm91cHMuCiAg\nICAgKgogICAgICogQHJldHVybiB0aGUgc2V0IG9mIGZldGNoIGdyb3VwIG5h\nbWVzLCBub3QgaW5jbHVkaW5nIHRoZSBkZWZhdWx0IGFuZAogICAgICogYWxs\nIGZldGNoIGdyb3Vwcy4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1tdIGdl\ndEN1c3RvbUZldGNoR3JvdXBzKCkgewogICAgICAgIGlmIChfZmdzID09IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKF9mZ1NldCA9PSBudWxsIHx8IF9tYW5h\nZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQgCiAgICAgICAgICAgICAgICB8fCBp\nc1ByaW1hcnlLZXkoKSB8fCBpc1ZlcnNpb24oKSkKICAgICAgICAgICAgICAg\nIF9mZ3MgPSBuZXcgU3RyaW5nWzBdOwogICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICBfZmdzID0gKFN0cmluZ1tdKSBfZmdTZXQudG9BcnJheShu\nZXcgU3RyaW5nW19mZ1NldC5zaXplKCldKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIF9mZ3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmV0Y2gg\nZ3JvdXAgdGhhdCBpcyB0byBiZSBsb2FkZWQgd2hlbiB0aGlzIHJlY2VpdmVy\nIGlzIGxvYWRlZCwgb3IKICAgICAqIG51bGwgaWYgbm9uZSBzZXQuCiAgICAg\nKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0TG9hZEZldGNoR3JvdXAgKCkgewog\nICAgCXJldHVybiBfbGZnOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRo\nZSBmZXRjaCBncm91cCB0aGF0IGlzIHRvIGJlIGxvYWRlZCB3aGVuIHRoaXMg\ncmVjZWl2ZXIgaXMgbG9hZGVkLCBvcgogICAgICogbnVsbCBpZiBub25lIHNl\ndC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TG9hZEZldGNoR3JvdXAg\nKFN0cmluZyBsZmcpIHsKICAgICAgICBpZiAoIiIuZXF1YWxzKGxmZykpCiAg\nICAgICAgICAgIGxmZyA9IG51bGw7CiAgICAJX2xmZyA9IGxmZzsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBpbiB0aGUg\nZ2l2ZW4gZmV0Y2ggZ3JvdXAuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGlzSW5GZXRjaEdyb3VwKFN0cmluZyBmZykgewogICAgICAgIGlmIChfbWFu\nYWdlICE9IE1BTkFHRV9QRVJTSVNURU5UIHx8IGlzUHJpbWFyeUtleSgpIHx8\nIGlzVmVyc2lvbigpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgaWYgKEZldGNoR3JvdXAuTkFNRV9BTEwuZXF1YWxzKGZnKSkKICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKEZldGNoR3JvdXAuTkFN\nRV9ERUZBVUxULmVxdWFscyhmZykpCiAgICAgICAgICAgIHJldHVybiBpc0lu\nRGVmYXVsdEZldGNoR3JvdXAoKTsKICAgICAgICByZXR1cm4gX2ZnU2V0ICE9\nIG51bGwgJiYgX2ZnU2V0LmNvbnRhaW5zKGZnKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB3aGV0aGVyIHRoaXMgZmllbGQgaXMgaW4gdGhlIGdpdmVu\nIGZldGNoIGdyb3VwLgogICAgICoKICAgICAqIEBwYXJhbSBmZyBpcyB0aGUg\nbmFtZSBvZiBhIGZldGNoIGdyb3VwIHRoYXQgbXVzdCBiZSBwcmVzZW50IGlu\nIHRoZQogICAgICogY2xhc3MgdGhhdCBkZWNsYXJlZCB0aGlzIGZpZWxkIG9y\nIGFueSBvZiBpdHMgcGVyc2lzdGVudCBzdXBlcmNsYXNzZXMuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldEluRmV0Y2hHcm91cChTdHJpbmcgZmcsIGJv\nb2xlYW4gaW4pIHsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShm\nZykpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihf\nbG9jLmdldCgiZW1wdHktZmctbmFtZSIsIHRoaXMpKTsKICAgICAgICBpZiAo\nZmcuZXF1YWxzKEZldGNoR3JvdXAuTkFNRV9BTEwpKQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgaWYgKGZnLmVxdWFscyhGZXRjaEdyb3VwLk5BTUVf\nREVGQVVMVCkpIHsKICAgICAgICAgICAgc2V0SW5EZWZhdWx0RmV0Y2hHcm91\ncChpbik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAg\naWYgKF9vd25lci5nZXRGZXRjaEdyb3VwKGZnKSA9PSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoInVu\na25vd24tZmciLCBmZywgdGhpcykpOwogICAgICAgIGlmIChpbiAmJiBfZmdT\nZXQgPT0gbnVsbCkKICAgICAgICAgICAgX2ZnU2V0ID0gbmV3IEhhc2hTZXQo\nKTsKICAgICAgICBpZiAoKGluICYmIF9mZ1NldC5hZGQoZmcpKQogICAgICAg\nICAgICB8fCAoIWluICYmIF9mZ1NldCAhPSBudWxsICYmIF9mZ1NldC5yZW1v\ndmUoZmcpKSkKICAgICAgICAgICAgX2ZncyA9IG51bGw7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogSG93IHRoZSBkYXRhIHN0b3JlIHNob3VsZCB0cmVh\ndCBudWxsIHZhbHVlcyBmb3IgdGhpcyBmaWVsZDoKICAgICAqIDx1bD4KICAg\nICAqIDxsaT57QGxpbmsgI05VTExfVU5TRVR9OiBubyB2YWx1ZSBzdXBwbGll\nZDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX05PTkV9OiBsZWF2ZSBu\ndWxsIHZhbHVlcyBhcyBudWxsIGluIHRoZSBkYXRhIHN0b3JlPC9saT4KICAg\nICAqIDxsaT57QGxpbmsgI05VTExfRVhDRVBUSU9OfTogdGhyb3cgYW4gZXhj\nZXB0aW9uIGlmIHRoaXMgZmllbGQgaXMgbnVsbAogICAgICogYXQgY29tbWl0\nPC9saT4KICAgICAqIDxsaT57QGxpbmsgI05VTExfREVGQVVMVH06IHVzZSB0\naGUgZGF0YWJhc2UgZGVmYXVsdCBpZiB0aGlzIGZpZWxkIGlzCiAgICAgKiBu\ndWxsIGF0IGNvbW1pdDwvbGk+CiAgICAgKiA8L3VsPiBEZWZhdWx0cyB0byB7\nQGxpbmsgI05VTExfVU5TRVR9LgogICAgICovCiAgICBwdWJsaWMgaW50IGdl\ndE51bGxWYWx1ZSgpIHsKICAgICAgICByZXR1cm4gX251bGxWYWx1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEhvdyB0aGUgZGF0YSBzdG9yZSBzaG91bGQg\ndHJlYXQgbnVsbCB2YWx1ZXMgZm9yIHRoaXMgZmllbGQ6CiAgICAgKiA8dWw+\nCiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX1VOU0VUfTogbm8gdmFsdWUgc3Vw\ncGxpZWQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9OT05FfTogbGVh\ndmUgbnVsbCB2YWx1ZXMgYXMgbnVsbCBpbiB0aGUgZGF0YSBzdG9yZTwvbGk+\nCiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0VYQ0VQVElPTn06IHRocm93IGFu\nIGV4Y2VwdGlvbiBpZiB0aGlzIGZpZWxkIGlzIG51bGwKICAgICAqIGF0IGNv\nbW1pdDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0RFRkFVTFR9OiB1\nc2UgdGhlIGRhdGFiYXNlIGRlZmF1bHQgaWYgdGhpcyBmaWVsZCBpcwogICAg\nICogbnVsbCBhdCBjb21taXQ8L2xpPgogICAgICogPC91bD4gRGVmYXVsdHMg\ndG8ge0BsaW5rICNOVUxMX1VOU0VUfS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0TnVsbFZhbHVlKGludCBudWxsVmFsdWUpIHsKICAgICAgICBfbnVs\nbFZhbHVlID0gbnVsbFZhbHVlOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0aGlzIGZpZWxkIGlzIGV4cGxpY2l0bHkgZGVjbGFyZWQgaW4gdGhl\nIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0V4cGxp\nY2l0KCkgewogICAgICAgIHJldHVybiBfZXhwbGljaXQ7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaXMgZXhwbGljaXRseSBk\nZWNsYXJlZCBpbiB0aGUgbWV0YWRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldEV4cGxpY2l0KGJvb2xlYW4gZXhwbGljaXQpIHsKICAgICAgICBf\nZXhwbGljaXQgPSBleHBsaWNpdDsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBmaWVsZCB0aGF0IHRoaXMgZmllbGQgc2hhcmVzIGEgbWFwcGluZyB3aXRo\nLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldE1hcHBlZEJ5KCkgewog\nICAgICAgIHJldHVybiBfbWFwcGVkQnk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJlcyBhIG1hcHBpbmcg\nd2l0aC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWFwcGVkQnkoU3Ry\naW5nIG1hcHBlZCkgewogICAgICAgIF9tYXBwZWRCeSA9IG1hcHBlZDsKICAg\nICAgICBfbWFwcGVkQnlNZXRhID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBmaWVsZCB0aGF0IHRoaXMgZmllbGQgc2hhcmVzIGEgbWFwcGlu\nZyB3aXRoLgogICAgICovCiAgICBwdWJsaWMgRmllbGRNZXRhRGF0YSBnZXRN\nYXBwZWRCeU1ldGFEYXRhKCkgewogICAgICAgIGlmIChfbWFwcGVkQnkgIT0g\nbnVsbCAmJiBfbWFwcGVkQnlNZXRhID09IG51bGwpIHsKICAgICAgICAgICAg\nQ2xhc3NNZXRhRGF0YSBtZXRhID0gbnVsbDsKICAgICAgICAgICAgc3dpdGNo\nIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5QQzoKICAgICAgICAgICAgICAgICAgICBtZXRhID0gZ2V0VHlwZU1l\ndGFEYXRhKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9\nIF9lbGVtLmdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZpZWxkID0gKG1ldGEgPT0gbnVsbCkgPyBudWxsCiAgICAgICAgICAg\nICAgICA6IG1ldGEuZ2V0RmllbGQoX21hcHBlZEJ5KTsKICAgICAgICAgICAg\naWYgKGZpZWxkID09IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLW1hcHBlZC1ieSIsIHRo\naXMsCiAgICAgICAgICAgICAgICAgICAgX21hcHBlZEJ5KSk7CiAgICAgICAg\nICAgIGlmIChmaWVsZC5nZXRNYXBwZWRCeSgpICE9IG51bGwpCiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQo\nImNpcmMtbWFwcGVkLWJ5IiwgdGhpcywKICAgICAgICAgICAgICAgICAgICBf\nbWFwcGVkQnkpKTsKICAgICAgICAgICAgX21hcHBlZEJ5TWV0YSA9IGZpZWxk\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX21hcHBlZEJ5TWV0YTsKICAg\nIH0KCiAgICAvKioKICAgICAqIExvZ2ljYWwgaW52ZXJzZSBmaWVsZC4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRJbnZlcnNlKCkgewogICAgICAg\nIGlmIChfaW52ZXJzZSA9PSBDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5H\nKQogICAgICAgICAgICBfaW52ZXJzZSA9IG51bGw7CiAgICAgICAgcmV0dXJu\nIF9pbnZlcnNlOwogICAgfQoKICAgIC8qKgogICAgICogTG9naWNhbCBpbnZl\ncnNlIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbnZlcnNl\nKFN0cmluZyBpbnZlcnNlKSB7CiAgICAgICAgX2ludmVyc2VzID0gbnVsbDsK\nICAgICAgICBfaW52ZXJzZSA9IGludmVyc2U7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gYWxsIGludmVyc2VzIG9mIHRoaXMgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhW10gZ2V0SW52ZXJzZU1ldGFE\nYXRhcygpIHsKICAgICAgICBpZiAoX2ludmVyc2VzID09IG51bGwpIHsKICAg\nICAgICAgICAgLy8gY2FuJ3QgZGVjbGFyZSBib3RoIGFuIGludmVyc2Ugb3du\nZXIgYW5kIGEgbG9naWNhbCBpbnZlcnNlCiAgICAgICAgICAgIFN0cmluZyBp\nbnYgPSBnZXRJbnZlcnNlKCk7CiAgICAgICAgICAgIGlmIChfbWFwcGVkQnkg\nIT0gbnVsbCAmJiBpbnYgIT0gbnVsbCAmJiAhX21hcHBlZEJ5LmVxdWFscyhp\nbnYpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJtYXBwZWQtbm90LWludmVyc2UiLAogICAgICAgICAg\nICAgICAgICAgIHRoaXMpKTsKCiAgICAgICAgICAgIC8vIGdldCB0aGUgbWV0\nYWRhdGEgZm9yIHRoZSB0eXBlIG9uIHRoZSBvdGhlciBzaWRlIG9mIHRoaXMg\ncmVsYXRpb24KICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gbnVs\nbDsKICAgICAgICAgICAgc3dpdGNoIChnZXRUeXBlQ29kZSgpKSB7CiAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAgICAgICAgICAgICAg\nICAgICBtZXRhID0gZ2V0VHlwZU1ldGFEYXRhKCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5B\nUlJBWToKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJ\nT046CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9IF9lbGVtLmdldFR5cGVN\nZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBDb2xsZWN0aW9uIGludmVyc2VzID0gbnVs\nbDsKICAgICAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgLy8gYWRkIG1hcHBlZCBieSBhbmQgbmFtZWQgaW52ZXJzZSwgaWYg\nYW55CiAgICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZpZWxkID0gZ2V0\nTWFwcGVkQnlNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgaWYgKGZpZWxk\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAvLyBtYXBwZWQgYnkg\nZmllbGQgaXNuJ3QgbmVjZXNzYXJpbHkgYSBwYyB0eXBlLCBidXQgYWxsCiAg\nICAgICAgICAgICAgICAgICAgLy8gaW52ZXJzZXMgbXVzdCBiZQogICAgICAg\nICAgICAgICAgICAgIGlmIChmaWVsZC5nZXRUeXBlQ29kZSgpID09IEphdmFU\neXBlcy5QQwogICAgICAgICAgICAgICAgICAgICAgICB8fCBmaWVsZC5nZXRF\nbGVtZW50KCkuZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuUEMpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgaW52ZXJzZXMgPSBuZXcgQXJyYXlMaXN0\nKDMpOwogICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5hZGQoZmll\nbGQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0g\nZWxzZSBpZiAoaW52ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBm\naWVsZCA9IG1ldGEuZ2V0RmllbGQoaW52KTsKICAgICAgICAgICAgICAgICAg\nICBpZiAoZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pbnZl\ncnNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsIGludikp\nOwogICAgICAgICAgICAgICAgICAgIGludmVyc2VzID0gbmV3IEFycmF5TGlz\ndCgzKTsKICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGQp\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHNjYW4g\ncmVsIHR5cGUgZm9yIGZpZWxkcyB0aGF0IG5hbWUgdGhpcyBmaWVsZCBhcyBh\nbiBpbnZlcnNlCiAgICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmll\nbGRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICAgICAgICAgIENsYXNz\nIHR5cGUgPSBnZXREZWNsYXJpbmdNZXRhRGF0YSgpLmdldERlc2NyaWJlZFR5\ncGUoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmll\nbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gc2tp\ncCBmaWVsZHMgdGhhdCBhcmVuJ3QgY29tcGF0aWJsZSB3aXRoIG91ciBvd25p\nbmcgY2xhc3MKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGZpZWxkc1tp\nXS5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKCF0eXBlLmlzQXNzaWduYWJsZUZyb20oZmllbGRzW2ldLmdldFR5cGUo\nKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAg\nICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5cGUuaXNBc3NpZ25h\nYmxlRnJvbShmaWVsZHNbaV0uCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgZ2V0RWxlbWVudCgpLmdldFR5cGUoKSkpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwog\nICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8g\naWYgdGhlIGZpZWxkIGRlY2xhcmVzIHVzIGFzIGl0cyBpbnZlcnNlIGFuZCB3\nZSBoYXZlbid0CiAgICAgICAgICAgICAgICAgICAgLy8gYWxyZWFkeSBhZGRl\nZCBpdCAod2UgbWlnaHQgaGF2ZSBpZiB3ZSBhbHNvIGRlY2xhcmVkIGl0CiAg\nICAgICAgICAgICAgICAgICAgLy8gYXMgb3VyIGludmVyc2UpLCBhZGQgaXQg\nbm93CiAgICAgICAgICAgICAgICAgICAgaWYgKF9uYW1lLmVxdWFscyhmaWVs\nZHNbaV0uZ2V0TWFwcGVkQnkoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nfHwgX25hbWUuZXF1YWxzKGZpZWxkc1tpXS5nZXRJbnZlcnNlKCkpKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnZlcnNlcyA9PSBudWxsKQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJzZXMgPSBuZXcgQXJy\nYXlMaXN0KDMpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWludmVy\nc2VzLmNvbnRhaW5zKGZpZWxkc1tpXSkpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGRzW2ldKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvcyA9IGdldFJlcG9z\naXRvcnkoKTsKICAgICAgICAgICAgaWYgKGludmVyc2VzID09IG51bGwpCiAg\nICAgICAgICAgICAgICBfaW52ZXJzZXMgPSByZXBvcy5FTVBUWV9GSUVMRFM7\nCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9pbnZlcnNlcyA9\nIChGaWVsZE1ldGFEYXRhW10pIGludmVyc2VzLnRvQXJyYXkKICAgICAgICAg\nICAgICAgICAgICAocmVwb3MubmV3RmllbGRNZXRhRGF0YUFycmF5KGludmVy\nc2VzLnNpemUoKSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2ludmVy\nc2VzOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmF0ZWd5IHRvIHVz\nZSBmb3IgaW5zZXJ0IHZhbHVlIGdlbmVyYXRpb24uCiAgICAgKiBPbmUgb2Yg\ndGhlIGNvbnN0YW50cyBmcm9tIHtAbGluayBWYWx1ZVN0cmF0ZWdpZXN9Lgog\nICAgICovCiAgICBwdWJsaWMgaW50IGdldFZhbHVlU3RyYXRlZ3koKSB7CiAg\nICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkKICAgICAgICAgICAgX3Zh\nbFN0cmF0ZWd5ID0gVmFsdWVTdHJhdGVnaWVzLk5PTkU7CiAgICAgICAgcmV0\ndXJuIF92YWxTdHJhdGVneTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBz\ndHJhdGVneSB0byB1c2UgZm9yIGluc2VydCB2YWx1ZSBnZW5lcmF0aW9uLgog\nICAgICogT25lIG9mIHRoZSBjb25zdGFudHMgZnJvbSB7QGxpbmsgVmFsdWVT\ndHJhdGVnaWVzfS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VmFsdWVT\ndHJhdGVneShpbnQgc3RyYXRlZ3kpIHsKICAgICAgICBfdmFsU3RyYXRlZ3kg\nPSBzdHJhdGVneTsKICAgICAgICBpZiAoc3RyYXRlZ3kgIT0gVmFsdWVTdHJh\ndGVnaWVzLlNFUVVFTkNFKQogICAgICAgICAgICBzZXRWYWx1ZVNlcXVlbmNl\nTmFtZShudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB2YWx1ZSBz\nZXF1ZW5jZSBuYW1lLCBvciBudWxsIGZvciBub25lLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFZhbHVlU2VxdWVuY2VOYW1lKCkgewogICAgICAg\nIGlmIChfc2VxTmFtZSA9PSBDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5H\nKQogICAgICAgICAgICBfc2VxTmFtZSA9IG51bGw7CiAgICAgICAgcmV0dXJu\nIF9zZXFOYW1lOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHZhbHVlIHNl\ncXVlbmNlIG5hbWUsIG9yIG51bGwgZm9yIG5vbmUuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFZhbHVlU2VxdWVuY2VOYW1lKFN0cmluZyBzZXFOYW1l\nKSB7CiAgICAgICAgX3NlcU5hbWUgPSBzZXFOYW1lOwogICAgICAgIF9zZXFN\nZXRhID0gbnVsbDsKICAgICAgICBpZiAoc2VxTmFtZSAhPSBudWxsKQogICAg\nICAgICAgICBzZXRWYWx1ZVN0cmF0ZWd5KFZhbHVlU3RyYXRlZ2llcy5TRVFV\nRU5DRSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRhZGF0YSBmb3IgdGhl\nIHZhbHVlIHNlcXVlbmNlLgogICAgICovCiAgICBwdWJsaWMgU2VxdWVuY2VN\nZXRhRGF0YSBnZXRWYWx1ZVNlcXVlbmNlTWV0YURhdGEoKSB7CiAgICAgICAg\naWYgKF9zZXFNZXRhID09IG51bGwgJiYgZ2V0VmFsdWVTZXF1ZW5jZU5hbWUo\nKSAhPSBudWxsKQogICAgICAgICAgICBfc2VxTWV0YSA9IGdldFJlcG9zaXRv\ncnkoKS5nZXRTZXF1ZW5jZU1ldGFEYXRhKF9vd25lciwKICAgICAgICAgICAg\nICAgIGdldFZhbHVlU2VxdWVuY2VOYW1lKCksIHRydWUpOwogICAgICAgIHJl\ndHVybiBfc2VxTWV0YTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdHJh\ndGVneSB0byB1c2Ugd2hlbiB1cGRhdGluZyB0aGUgZmllbGQuCiAgICAgKi8K\nICAgIHB1YmxpYyBpbnQgZ2V0VXBkYXRlU3RyYXRlZ3koKSB7CiAgICAgICAg\naWYgKGlzVmVyc2lvbigpKQogICAgICAgICAgICByZXR1cm4gVXBkYXRlU3Ry\nYXRlZ2llcy5SRVNUUklDVDsKICAgICAgICBpZiAoX3VwU3RyYXRlZ3kgPT0g\nLTEpCiAgICAgICAgICAgIF91cFN0cmF0ZWd5ID0gVXBkYXRlU3RyYXRlZ2ll\ncy5OT05FOwogICAgICAgIHJldHVybiBfdXBTdHJhdGVneTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCB0aGUgdXBkYXRlIHN0cmF0ZWd5LgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRVcGRhdGVTdHJhdGVneShpbnQgc3RyYXRl\nZ3kpIHsKICAgICAgICBfdXBTdHJhdGVneSA9IHN0cmF0ZWd5OwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGJhY2tlZCBi\neSBhIGxhcmdlIHJlc3VsdCBzZXQuCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGlzTFJTKCkgewogICAgICAgIHJldHVybiBfbHJzID09IEJvb2xlYW4u\nVFJVRSAmJiBfbWFuYWdlID09IE1BTkFHRV9QRVJTSVNURU5UOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGJhY2tlZCBi\neSBhIGxhcmdlIHJlc3VsdCBzZXQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldExSUyhib29sZWFuIGxycykgewogICAgICAgIF9scnMgPSAobHJzKSA/\nIEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0U7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgdXNlcyBpbnRlcm1lZGlhdGUg\nZGF0YSB3aGVuIGxvYWRpbmcvc3RvcmluZwogICAgICogaW5mb3JtYXRpb24g\ndGhyb3VnaCBhIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4gRGVmYXVs\ndHMgdG8gdHJ1ZS4KICAgICAqCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIjc2V0SW50ZXJtZWRpYXRlKGludCxPYmplY3QpCiAgICAgKi8KICAg\nIHB1YmxpYyBib29sZWFuIHVzZXNJbnRlcm1lZGlhdGUoKSB7CiAgICAgICAg\ncmV0dXJuIF9pbnRlcm1lZGlhdGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBX\naGV0aGVyIHRoaXMgZmllbGQgdXNlcyBpbnRlcm1lZGlhdGUgZGF0YSB3aGVu\nIGxvYWRpbmcvc3RvcmluZwogICAgICogaW5mb3JtYXRpb24gdGhyb3VnaCBh\nIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4gRGVmYXVsdHMgdG8gdHJ1\nZS4KICAgICAqCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0\nSW50ZXJtZWRpYXRlKGludCxPYmplY3QpCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFVzZXNJbnRlcm1lZGlhdGUoYm9vbGVhbiBpbnRlcm1lZGlhdGUp\nIHsKICAgICAgICBfaW50ZXJtZWRpYXRlID0gaW50ZXJtZWRpYXRlOwogICAg\nICAgIF9vd25lci5jbGVhckV4dHJhRmllbGREYXRhVGFibGUoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCB1c2VzIGltcGwg\nZGF0YSBpbiBjb25qdW5jdGlvbiB3aXRoIHN0YW5kYXJkCiAgICAgKiBmaWVs\nZCBkYXRhIHdoZW4gYWN0aW5nIG9uIGEge0BsaW5rIE9wZW5KUEFTdGF0ZU1h\nbmFnZXJ9LgogICAgICogRGVmYXVsdHMgdG8ge0BsaW5rIEJvb2xlYW4jVFJV\nRX0gKG5vbi1jYWNoYWJsZSBpbXBsIGRhdGEpLgogICAgICoKICAgICAqIEBy\nZXR1cm4ge0BsaW5rIEJvb2xlYW4jRkFMU0V9IGlmIHRoaXMgZmllbGQgZG9l\ncyBub3QgdXNlIGltcGwgZGF0YSwKICAgICAqIHtAbGluayBCb29sZWFuI1RS\nVUV9IGlmIHRoaXMgZmllbGQgdXNlcyBub24tY2FjaGFibGUgaW1wbAogICAg\nICogZGF0YSwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYgdGhpcyBmaWVsZCB1\nc2VzIGltcGwgZGF0YSB0aGF0CiAgICAgKiBzaG91bGQgYmUgY2FjaGVkIGFj\ncm9zcyBpbnN0YW5jZXMKICAgICAqIEBzZWUgT3BlbkpQQVN0YXRlTWFuYWdl\nciNzZXRJbXBsRGF0YShpbnQsT2JqZWN0KQogICAgICovCiAgICBwdWJsaWMg\nQm9vbGVhbiB1c2VzSW1wbERhdGEoKSB7CiAgICAgICAgcmV0dXJuIF9pbXBs\nRGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVs\nZCB1c2VzIGltcGwgZGF0YSBpbiBjb25qdW5jdGlvbiB3aXRoIHN0YW5kYXJk\nCiAgICAgKiBmaWVsZCBkYXRhIHdoZW4gYWN0aW5nIG9uIGEge0BsaW5rIE9w\nZW5KUEFTdGF0ZU1hbmFnZXJ9LgogICAgICoKICAgICAqIEBzZWUgT3BlbkpQ\nQVN0YXRlTWFuYWdlciNzZXRJbXBsRGF0YShpbnQsT2JqZWN0KQogICAgICog\nQHNlZSAjdXNlc0ltcGxEYXRhCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFVzZXNJbXBsRGF0YShCb29sZWFuIGltcGxEYXRhKSB7CiAgICAgICAgX2lt\ncGxEYXRhID0gaW1wbERhdGE7CiAgICAgICAgX293bmVyLmNsZWFyRXh0cmFG\naWVsZERhdGFUYWJsZSgpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG9y\nZGVyaW5ncyBmb3IgdGhpcyBmaWVsZCB0byBiZSBhcHBsaWVkIG9uIGxvYWQs\nIG9yIGVtcHR5IGFycmF5LgogICAgICovCiAgICBwdWJsaWMgT3JkZXJbXSBn\nZXRPcmRlcnMoKSB7CiAgICAgICAgaWYgKF9vcmRlcnMgPT0gbnVsbCkgewog\nICAgICAgICAgICBpZiAoX29yZGVyRGVjID09IG51bGwpCiAgICAgICAgICAg\nICAgICBfb3JkZXJzID0gZ2V0UmVwb3NpdG9yeSgpLkVNUFRZX09SREVSUzsK\nICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBTdHJpbmdbXSBk\nZWNzID0gU3RyaW5ncy5zcGxpdChfb3JkZXJEZWMsICIsIiwgMCk7CiAgICAg\nICAgICAgICAgICBPcmRlcltdIG9yZGVycyA9IGdldFJlcG9zaXRvcnkoKS5u\nZXdPcmRlckFycmF5KGRlY3MubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGlu\ndCBzcGM7CiAgICAgICAgICAgICAgICBib29sZWFuIGFzYzsKICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZGVjcy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICAgICAgICAgIGRlY3NbaV0gPSBkZWNzW2ldLnRyaW0o\nKTsKICAgICAgICAgICAgICAgICAgICBzcGMgPSBkZWNzW2ldLmluZGV4T2Yo\nJyAnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc3BjID09IC0xKQogICAg\nICAgICAgICAgICAgICAgICAgICBhc2MgPSB0cnVlOwogICAgICAgICAgICAg\nICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhc2MgPSBk\nZWNzW2ldLnN1YnN0cmluZyhzcGMgKyAxKS50cmltKCkuCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB0b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoImFz\nYyIpOwogICAgICAgICAgICAgICAgICAgICAgICBkZWNzW2ldID0gZGVjc1tp\nXS5zdWJzdHJpbmcoMCwgc3BjKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgb3JkZXJzW2ldID0gZ2V0UmVwb3NpdG9yeSgp\nLm5ld09yZGVyKHRoaXMsIGRlY3NbaV0sIGFzYyk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBfb3JkZXJzID0gb3JkZXJzOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfb3JkZXJzOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIG9yZGVyaW5ncyBmb3IgdGhpcyBmaWVs\nZCB0byBiZSBhcHBsaWVkIG9uIGxvYWQuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldE9yZGVycyhPcmRlcltdIG9yZGVycykgewogICAgICAgIF9vcmRl\nckRlYyA9IG51bGw7CiAgICAgICAgX29yZGVycyA9IG9yZGVyczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFN0cmluZyBkZWNsYXJpbmcgdGhlIG9yZGVyaW5n\ncyBmb3IgdGhpcyBmaWVsZCB0byBiZSBhcHBsaWVkIG9uIGxvYWQsCiAgICAg\nKiBvciBudWxsLiBUaGUgc3RyaW5nIGlzIG9mIHRoZSBmb3JtOjxiciAvPgog\nICAgICogPGNvZGU+b3JkZXJhYmxlWyBhc2N8ZGVzY11bLCAuLi5dPC9jb2Rl\nPjxiciAvPgogICAgICogVGhlIG9yZGVyYWJsZSA8Y29kZT4jZWxlbWVudDwv\nY29kZT4gaXMgdXNlZCB0byBkZW5vdGUgdGhlIHZhbHVlIG9mCiAgICAgKiB0\naGUgZmllbGQncyBlbGVtZW50cy4KICAgICAqLwogICAgcHVibGljIFN0cmlu\nZyBnZXRPcmRlckRlY2xhcmF0aW9uKCkgewogICAgICAgIGlmIChfb3JkZXJE\nZWMgPT0gbnVsbCAmJiBfb3JkZXJzICE9IG51bGwpIHsKICAgICAgICAgICAg\nU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfb3JkZXJzLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgICAgICBpZiAoaSA+IDApCiAgICAgICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoX29yZGVyc1tpXS5nZXROYW1lKCkpLmFwcGVuZCgiICIpOwogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgoX29yZGVyc1tpXS5pc0FzY2VuZGlu\nZygpKSA/ICJhc2MiIDogImRlc2MiKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBfb3JkZXJEZWMgPSBidWYudG9TdHJpbmcoKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIF9vcmRlckRlYzsKICAgIH0KCiAgICAvKioKICAgICAq\nIFN0cmluZyBkZWNsYXJpbmcgdGhlIG9yZGVyaW5ncyBmb3IgdGhpcyBmaWVs\nZCB0byBiZSBhcHBsaWVkIG9uIGxvYWQsCiAgICAgKiBvciBudWxsLiBUaGUg\nc3RyaW5nIGlzIG9mIHRoZSBmb3JtOjxiciAvPgogICAgICogPGNvZGU+b3Jk\nZXJhYmxlWyBhc2N8ZGVzY11bLCAuLi5dPC9jb2RlPjxiciAvPgogICAgICog\nVGhlIG9yZGVyYWJsZSA8Y29kZT4jZWxlbWVudDwvY29kZT4gaXMgdXNlZCB0\nbyBkZW5vdGUgdGhlIHZhbHVlIG9mCiAgICAgKiB0aGUgZmllbGQncyBlbGVt\nZW50cy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0T3JkZXJEZWNsYXJh\ndGlvbihTdHJpbmcgZGVjKSB7CiAgICAgICAgX29yZGVyRGVjID0gU3RyaW5n\nVXRpbHMudHJpbVRvTnVsbChkZWMpOwogICAgICAgIF9vcmRlcnMgPSBudWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogT3JkZXIgdGhpcyBmaWVsZCB2YWx1\nZSB3aGVuIGl0IGlzIGxvYWRlZC4KICAgICAqLwogICAgcHVibGljIE9iamVj\ndCBvcmRlcihPYmplY3QgdmFsKSB7CiAgICAgICAgaWYgKHZhbCA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgT3JkZXJbXSBv\ncmRlcnMgPSBnZXRPcmRlcnMoKTsKICAgICAgICBpZiAob3JkZXJzLmxlbmd0\naCA9PSAwKQogICAgICAgICAgICByZXR1cm4gdmFsOwoKICAgICAgICAvLyBj\ncmVhdGUgYSBjb21wYXJhdG9yIGZvciB0aGUgZWxlbWVudHMgb2YgdGhlIHZh\nbHVlCiAgICAgICAgQ29tcGFyYXRvciBjb21wOwogICAgICAgIGlmIChvcmRl\ncnMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIGNvbXAgPSBvcmRlcnNbMF0u\nZ2V0Q29tcGFyYXRvcigpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBM\naXN0IGNvbXBzID0gbnVsbDsKICAgICAgICAgICAgQ29tcGFyYXRvciBjdXJD\nb21wOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG9yZGVycy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY3VyQ29tcCA9IG9yZGVy\nc1tpXS5nZXRDb21wYXJhdG9yKCk7CiAgICAgICAgICAgICAgICBpZiAoY3Vy\nQ29tcCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBz\nID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBzID0gbmV3\nIEFycmF5TGlzdChvcmRlcnMubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAg\nICBpZiAoaSAhPSBjb21wcy5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKCJtaXhlZC1pbm1lbS1vcmRlcmlu\nZyIsIHRoaXMpKTsKICAgICAgICAgICAgICAgICAgICBjb21wcy5hZGQoY3Vy\nQ29tcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgaWYgKGNvbXBzID09IG51bGwpCiAgICAgICAgICAgICAgICBjb21w\nID0gbnVsbDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY29t\ncCA9IG5ldyBDb21wYXJhdG9yQ2hhaW4oY29tcHMpOwogICAgICAgIH0KCiAg\nICAgICAgaWYgKGNvbXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHZh\nbDsKCiAgICAgICAgLy8gc29ydAogICAgICAgIHN3aXRjaCAoZ2V0VHlwZUNv\nZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAg\nICAgICAgICAgICAgIExpc3QgbCA9IEphdmFUeXBlcy50b0xpc3QodmFsLCBf\nZWxlbS5nZXRUeXBlKCksIHRydWUpOwogICAgICAgICAgICAgICAgQ29sbGVj\ndGlvbnMuc29ydChsLCBjb21wKTsKICAgICAgICAgICAgICAgIHJldHVybiBK\nYXZhVHlwZXMudG9BcnJheShsLCBfZWxlbS5nZXRUeXBlKCkpOwogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICAg\nICAgaWYgKHZhbCBpbnN0YW5jZW9mIExpc3QpCiAgICAgICAgICAgICAgICAg\nICAgQ29sbGVjdGlvbnMuc29ydCgoTGlzdCkgdmFsLCBjb21wKTsKICAgICAg\nICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xv\nYy5nZXQoImNhbnQtb3JkZXIiLCB0aGlzKSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGUgZmllbGQgaXMgZXh0ZXJuYWxp\nemVkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0V4dGVybmFsaXpl\nZCgpIHsKICAgICAgICByZXR1cm4gZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkg\nIT0gbnVsbAogICAgICAgICAgICB8fCBnZXRFeHRlcm5hbFZhbHVlTWFwKCkg\nIT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIGdp\ndmVuIGZpZWxkIHZhbHVlIHRvIGl0cyBleHRlcm5hbCB2YWx1ZSB0aHJvdWdo\nIHRoZQogICAgICogcHJvdmlkZWQgZXh0ZXJuYWxpemVyLCBvciByZXR1cm4g\ndGhlIHZhbHVlIGFzLWlzIGlmIG5vIGV4dGVybmFsaXplci4KICAgICAqLwog\nICAgcHVibGljIE9iamVjdCBnZXRFeHRlcm5hbFZhbHVlKE9iamVjdCB2YWws\nIFN0b3JlQ29udGV4dCBjdHgpIHsKICAgICAgICBNYXAgZXh0VmFsdWVzID0g\nZ2V0RXh0ZXJuYWxWYWx1ZU1hcCgpOwogICAgICAgIGlmIChleHRWYWx1ZXMg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGV4dFZhbHVlcy5nZXQodmFs\nKTsKCiAgICAgICAgTWV0aG9kIGV4dGVybmFsaXplciA9IGdldEV4dGVybmFs\naXplck1ldGhvZCgpOwogICAgICAgIGlmIChleHRlcm5hbGl6ZXIgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIHZhbDsKCiAgICAgICAgLy8gc3BlY2lh\nbCBjYXNlIGZvciBxdWVyaWVzOiBhbGxvdyB0aGUgZ2l2ZW4gdmFsdWUgdG8g\ncGFzcyB0aHJvdWdoCiAgICAgICAgLy8gYXMtaXMgaWYgaXQgaXMgYWxyZWFk\neSBpbiBleHRlcm5hbGl6ZWQgZm9ybQogICAgICAgIGlmICh2YWwgIT0gbnVs\nbCAmJiBnZXRUeXBlKCkuaXNJbnN0YW5jZSh2YWwpCiAgICAgICAgICAgICYm\nICghZ2V0RGVjbGFyZWRUeXBlKCkuaXNJbnN0YW5jZSh2YWwpCiAgICAgICAg\nICAgIHx8IGdldERlY2xhcmVkVHlwZSgpID09IE9iamVjdC5jbGFzcykpCiAg\nICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIC8vIGVpdGhlciBpbnZva2UgdGhlIHN0YXRpYyB0b0V4dGVybmFsKHZh\nbFssIGN0eF0pIG1ldGhvZCwgb3IgdGhlCiAgICAgICAgICAgIC8vIG5vbi1z\ndGF0aWMgdmFsLnRvRXh0ZXJuYWwoW2N0eF0pIG1ldGhvZAogICAgICAgICAg\nICBpZiAoTW9kaWZpZXIuaXNTdGF0aWMoZXh0ZXJuYWxpemVyLmdldE1vZGlm\naWVycygpKSkgewogICAgICAgICAgICAgICAgaWYgKGV4dGVybmFsaXplci5n\nZXRQYXJhbWV0ZXJUeXBlcygpLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBleHRlcm5hbGl6ZXIuaW52b2tlKG51bGwsIG5ldyBP\nYmplY3RbXXsgdmFsIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVy\nbmFsaXplci5pbnZva2UobnVsbCwgbmV3IE9iamVjdFtdeyB2YWwsIGN0eCB9\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodmFsID09IG51bGwp\nCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgaWYg\nKGV4dGVybmFsaXplci5nZXRQYXJhbWV0ZXJUeXBlcygpLmxlbmd0aCA9PSAw\nKQogICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5pbnZva2Uo\ndmFsLCAoT2JqZWN0W10pIG51bGwpOwogICAgICAgICAgICByZXR1cm4gZXh0\nZXJuYWxpemVyLmludm9rZSh2YWwsIG5ldyBPYmplY3RbXXsgY3R4IH0pOwog\nICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAg\nICAgICAgdGhyb3cga2U7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJleHRlcm5hbGl6ZXItZXJyIiwgdGhpcywKICAgICAgICAgICAg\nICAgIEV4Y2VwdGlvbnMudG9TdHJpbmcodmFsKSwgZS50b1N0cmluZygpKSku\nc2V0Q2F1c2UoZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSByZXN1bHQgb2YgcGFzc2luZyB0aGUgZ2l2ZW4gZXh0ZXJu\nYWwgdmFsdWUgdGhyb3VnaCB0aGUKICAgICAqIGZhY3RvcnkgdG8gZ2V0IHRo\nZSBmaWVsZCB2YWx1ZS4gSWYgbm8gZmFjdG9yeSBpcyBwcmVzZW50LAogICAg\nICogdGhlIGdpdmVuIHZhbHVlIGlzIHJldHVybmVkIGFzLWlzLgogICAgICov\nCiAgICBwdWJsaWMgT2JqZWN0IGdldEZpZWxkVmFsdWUoT2JqZWN0IHZhbCwg\nU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAgIE1hcCBmaWVsZFZhbHVlcyA9\nIGdldEZpZWxkVmFsdWVNYXAoKTsKICAgICAgICBpZiAoZmllbGRWYWx1ZXMg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZpZWxkVmFsdWVzLmdldCh2\nYWwpOwoKICAgICAgICBNZW1iZXIgZmFjdG9yeSA9IGdldEZhY3RvcnlNZXRo\nb2QoKTsKICAgICAgICBpZiAoZmFjdG9yeSA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gdmFsOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAo\ndmFsID09IG51bGwgJiYgZ2V0TnVsbFZhbHVlKCkgPT0gTlVMTF9ERUZBVUxU\nKQogICAgICAgICAgICAgICAgcmV0dXJuIGdldERlY2xhcmVkVHlwZSgpLm5l\nd0luc3RhbmNlKCk7CgogICAgICAgICAgICAvLyBpbnZva2UgZWl0aGVyIHRo\nZSBjb25zdHJ1Y3RvciBmb3IgdGhlIGZpZWxkIHR5cGUsCiAgICAgICAgICAg\nIC8vIG9yIHRoZSBzdGF0aWMgdHlwZS50b0ZpZWxkKHZhbFssIGN0eF0pIG1l\ndGhvZAogICAgICAgICAgICBpZiAoZmFjdG9yeSBpbnN0YW5jZW9mIENvbnN0\ncnVjdG9yKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAg\nICByZXR1cm4gKChDb25zdHJ1Y3RvcikgZmFjdG9yeSkubmV3SW5zdGFuY2UK\nICAgICAgICAgICAgICAgICAgICAobmV3IE9iamVjdFtdeyB2YWwgfSk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIE1ldGhvZCBtZXRoID0gKE1ldGhv\nZCkgZmFjdG9yeTsKICAgICAgICAgICAgaWYgKG1ldGguZ2V0UGFyYW1ldGVy\nVHlwZXMoKS5sZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgIHJldHVybiBt\nZXRoLmludm9rZShudWxsLCBuZXcgT2JqZWN0W117IHZhbCB9KTsKICAgICAg\nICAgICAgcmV0dXJuIG1ldGguaW52b2tlKG51bGwsIG5ldyBPYmplY3RbXXsg\ndmFsLCBjdHggfSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgLy8gdW53cmFwIGNhdXNlCiAgICAgICAgICAgIGlmIChl\nIGluc3RhbmNlb2YgSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbikgewogICAg\nICAgICAgICAgICAgVGhyb3dhYmxlIHQgPSAoKEludm9jYXRpb25UYXJnZXRF\neGNlcHRpb24pIGUpLgogICAgICAgICAgICAgICAgICAgIGdldFRhcmdldEV4\nY2VwdGlvbigpOwogICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBF\ncnJvcikKICAgICAgICAgICAgICAgICAgICB0aHJvdyAoRXJyb3IpIHQ7CiAg\nICAgICAgICAgICAgICBlID0gKEV4Y2VwdGlvbikgdDsKCiAgICAgICAgICAg\nICAgICAvLyBhbGxvdyBudWxsIHZhbHVlcyB0byBjYXVzZSBOUEVzIGFuZCBp\nbGxlZ2FsIGFyZyBleGNlcHRpb25zCiAgICAgICAgICAgICAgICAvLyB3aXRo\nb3V0IGVycm9yCiAgICAgICAgICAgICAgICBpZiAodmFsID09IG51bGwgJiYg\nKGUgaW5zdGFuY2VvZiBOdWxsUG9pbnRlckV4Y2VwdGlvbgogICAgICAgICAg\nICAgICAgICAgIHx8IGUgaW5zdGFuY2VvZiBJbGxlZ2FsQXJndW1lbnRFeGNl\ncHRpb24pKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIE9wZW5K\nUEFFeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJvdyAoT3BlbkpQQUV4\nY2VwdGlvbikgZTsKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJmYWN0b3J5LWVyciIsIHRoaXMsCiAgICAgICAg\nICAgICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKHZhbCksIGUudG9TdHJpbmco\nKSkpLnNldENhdXNlKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBuYW1lIG9mIHRoaXMgZmllbGQncyBleHRlcm5hbGl6ZXIsIG9y\nIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRF\neHRlcm5hbGl6ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9leHROYW1lOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGV4\ndGVybmFsaXplciwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRFeHRlcm5hbGl6ZXIoU3RyaW5nIGV4dGVybmFsaXplcikg\newogICAgICAgIF9leHROYW1lID0gZXh0ZXJuYWxpemVyOwogICAgICAgIF9l\neHRNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBuYW1lIG9mIHRoaXMgZmllbGQncyBmYWN0b3J5LCBvciBudWxs\nIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RmFjdG9y\neSgpIHsKICAgICAgICByZXR1cm4gX2ZhY3ROYW1lOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGZhY3RvcnksIG9y\nIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RmFj\ndG9yeShTdHJpbmcgZmFjdG9yeSkgewogICAgICAgIF9mYWN0TmFtZSA9IGZh\nY3Rvcnk7CiAgICAgICAgX2ZhY3RNZXRob2QgPSBERUZBVUxUX01FVEhPRDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFByb3BlcnRpZXMgc3RyaW5nIG1hcHBp\nbmcgZmllbGQgdmFsdWVzIHRvIGV4dGVybmFsIHZhbHVlcy4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZyBnZXRFeHRlcm5hbFZhbHVlcygpIHsKICAgICAg\nICByZXR1cm4gX2V4dFN0cmluZzsKICAgIH0KCiAgICAvKioKICAgICAqIFBy\nb3BlcnRpZXMgc3RyaW5nIG1hcHBpbmcgZmllbGQgdmFsdWVzIHRvIGV4dGVy\nbmFsIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RXh0ZXJu\nYWxWYWx1ZXMoU3RyaW5nIHZhbHVlcykgewogICAgICAgIF9leHRTdHJpbmcg\nPSB2YWx1ZXM7CiAgICAgICAgX2V4dFZhbHVlcyA9IG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1hcHBpbmcgb2YgZmllbGQgdmFs\ndWVzIHRvIGV4dGVybmFsIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIE1h\ncCBnZXRFeHRlcm5hbFZhbHVlTWFwKCkgewogICAgICAgIHBhcnNlRXh0ZXJu\nYWxWYWx1ZXMoKTsKICAgICAgICByZXR1cm4gX2V4dFZhbHVlczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbWFwcGluZyBvZiBleHRlcm5h\nbCB2YWx1ZXMgdG8gZmllbGQgdmFsdWVzLgogICAgICovCiAgICBwdWJsaWMg\nTWFwIGdldEZpZWxkVmFsdWVNYXAoKSB7CiAgICAgICAgcGFyc2VFeHRlcm5h\nbFZhbHVlcygpOwogICAgICAgIHJldHVybiBfZmllbGRWYWx1ZXM7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBleHRlcm5hbCB2YWx1ZXMgaW50byBt\nYXBzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VFeHRlcm5hbFZh\nbHVlcygpIHsKICAgICAgICBpZiAoX2V4dFZhbHVlcyAhPSBDb2xsZWN0aW9u\ncy5FTVBUWV9NQVAKICAgICAgICAgICAgJiYgX2ZpZWxkVmFsdWVzICE9IENv\nbGxlY3Rpb25zLkVNUFRZX01BUCkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICBpZiAoX2V4dFN0cmluZyA9PSBudWxsKSB7CiAgICAgICAgICAgIF9l\neHRWYWx1ZXMgPSBudWxsOwogICAgICAgICAgICBfZmllbGRWYWx1ZXMgPSBu\ndWxsOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAv\nLyBwYXJzZSBzdHJpbmcgaW50byBvcHRpb25zOyB0aGlzIHRha2VzIGNhcmUg\nb2YgcHJvcGVyIHRyaW1taW5nIGV0YwogICAgICAgIE9wdGlvbnMgdmFsdWVz\nID0gQ29uZmlndXJhdGlvbnMucGFyc2VQcm9wZXJ0aWVzKF9leHRTdHJpbmcp\nOwogICAgICAgIGlmICh2YWx1ZXMuaXNFbXB0eSgpKQogICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLWV4dGVy\nbmFsLXZhbHVlcyIsIHRoaXMsCiAgICAgICAgICAgICAgICBfZXh0U3RyaW5n\nKSk7CgogICAgICAgIE1hcCBleHRWYWx1ZXMgPSBuZXcgSGFzaE1hcCgoaW50\nKSAodmFsdWVzLnNpemUoKSAqIDEuMzMgKyAxKSk7CiAgICAgICAgTWFwIGZp\nZWxkVmFsdWVzID0gbmV3IEhhc2hNYXAoKGludCkgKHZhbHVlcy5zaXplKCkg\nKiAxLjMzICsgMSkpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAg\nICBPYmplY3QgZXh0VmFsdWUsIGZpZWxkVmFsdWU7CiAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSB2YWx1ZXMuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBp\ndHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50\ncnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGZpZWxkVmFsdWUgPSB0cmFu\nc2Zvcm0oKFN0cmluZykgZW50cnkuZ2V0S2V5KCksCiAgICAgICAgICAgICAg\nICBnZXREZWNsYXJlZFR5cGVDb2RlKCkpOwogICAgICAgICAgICBleHRWYWx1\nZSA9IHRyYW5zZm9ybSgoU3RyaW5nKSBlbnRyeS5nZXRWYWx1ZSgpLCBnZXRU\neXBlQ29kZSgpKTsKCiAgICAgICAgICAgIGV4dFZhbHVlcy5wdXQoZmllbGRW\nYWx1ZSwgZXh0VmFsdWUpOwogICAgICAgICAgICBmaWVsZFZhbHVlcy5wdXQo\nZXh0VmFsdWUsIGZpZWxkVmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgX2V4\ndFZhbHVlcyA9IGV4dFZhbHVlczsKICAgICAgICBfZmllbGRWYWx1ZXMgPSBm\naWVsZFZhbHVlczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\nc3RyaW5nIHZhbHVlIGNvbnZlcnRlZCB0byB0aGUgZ2l2ZW4gdHlwZSBjb2Rl\nLiBUaGUgc3RyaW5nCiAgICAgKiBtdXN0IGJlIG5vbi1udWxsIGFuZCB0cmlt\nbWVkLgogICAgICovCiAgICBwcml2YXRlIE9iamVjdCB0cmFuc2Zvcm0oU3Ry\naW5nIHZhbCwgaW50IHR5cGVDb2RlKSB7CiAgICAgICAgaWYgKCJudWxsIi5l\ncXVhbHModmFsKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIHN3aXRjaCAodHlwZUNvZGUpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQk9PTEVBTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVB\nTl9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi52YWx1ZU9m\nKHZhbCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICAg\nICAgcmV0dXJuIEJ5dGUudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklO\nVF9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci52YWx1ZU9m\nKHZhbCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkdfT0JKOgogICAgICAgICAgICAg\nICAgcmV0dXJuIExvbmcudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nU0hPUlRfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIFNob3J0LnZhbHVl\nT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxFOgog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAgICAg\nICAgICAgICAgcmV0dXJuIERvdWJsZS52YWx1ZU9mKHZhbCk7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5GTE9BVF9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gRmxv\nYXQudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5D\nSEFSOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hhcmFjdGVyKHZhbC5jaGFyQXQo\nMCkpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TVFJJTkc6CiAgICAg\nICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgIH0KICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1leHRlcm5h\nbC10eXBlIiwgdGhpcykpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGV4\ndGVybmFsaXplciBtZXRob2QuCiAgICAgKi8KICAgIHB1YmxpYyBNZXRob2Qg\nZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgewogICAgICAgIGlmIChfbWFuYWdl\nICE9IE1BTkFHRV9QRVJTSVNURU5UKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAoX2V4dE1ldGhvZCA9PSBERUZBVUxUX01FVEhPRCkg\newogICAgICAgICAgICBpZiAoX2V4dE5hbWUgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgX2V4dE1ldGhvZCA9IGZpbmRNZXRob2QoX2V4dE5hbWUpOwog\nICAgICAgICAgICAgICAgaWYgKF9leHRNZXRob2QgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1leHRlcm5hbGl6ZXIiLAogICAgICAgICAgICAgICAgICAg\nICAgICB0aGlzLCBfZXh0TmFtZSkpOwogICAgICAgICAgICB9IGVsc2UKICAg\nICAgICAgICAgICAgIF9leHRNZXRob2QgPSBudWxsOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gX2V4dE1ldGhvZDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBmYWN0b3J5IG1ldGhvZCBvciBjb25zdHJ1Y3Rvci4KICAgICAqLwog\nICAgcHVibGljIE1lbWJlciBnZXRGYWN0b3J5TWV0aG9kKCkgewogICAgICAg\nIGlmIChfbWFuYWdlICE9IE1BTkFHRV9QRVJTSVNURU5UKQogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoX2ZhY3RNZXRob2QgPT0gREVG\nQVVMVF9NRVRIT0QpIHsKICAgICAgICAgICAgaWYgKGdldEV4dGVybmFsaXpl\nck1ldGhvZCgpID09IG51bGwpCiAgICAgICAgICAgICAgICBfZmFjdE1ldGhv\nZCA9IG51bGw7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2ZhY3ROYW1lID09IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgICAgIF9mYWN0TWV0aG9kID0gZ2V0\nRGVjbGFyZWRUeXBlKCkuZ2V0Q29uc3RydWN0b3IKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIChuZXcgQ2xhc3NbXXsgZ2V0VHlwZSgpIH0pOwogICAg\nICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAg\nX2ZhY3RNZXRob2QgPSBmaW5kTWV0aG9kKF9mYWN0TmFtZSk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgICAgIGlmICghKF9mYWN0TWV0aG9kIGluc3RhbmNlb2YgQ29uc3Ry\ndWN0b3IpCiAgICAgICAgICAgICAgICAgICAgJiYgIShfZmFjdE1ldGhvZCBp\nbnN0YW5jZW9mIE1ldGhvZCkpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZmFjdG9yeSIs\nIHRoaXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gX2ZhY3RNZXRob2Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaW5kIHRo\nZSBtZXRob2QgZm9yIHRoZSBzcGVjaWZpZWQgbmFtZS4gUG9zc2libGUgZm9y\nbXMgYXJlOgogICAgICogPHVsPgogICAgICogPGxpPnRvRXh0ZXJuYWxTdHJp\nbmc8L2xpPgogICAgICogPGxpPk15RmFjdG9yeUNsYXNzLnRvRXh0ZXJuYWxT\ndHJpbmc8L2xpPgogICAgICogPGxpPmNvbS5jb21wYW55Lk15RmFjdG9yeUNs\nYXNzLnRvRXh0ZXJuYWxTdHJpbmc8L2xpPgogICAgICogPC91bD4KICAgICAq\nCiAgICAgKiBAcGFyYW0gbWV0aG9kIHRoZSBuYW1lIG9mIHRoZSBtZXRob2Qg\ndG8gbG9jYXRlCiAgICAgKiBAcmV0dXJuIHRoZSBtZXRob2QgZm9yIGludm9j\nYXRpb24KICAgICAqLwogICAgcHJpdmF0ZSBNZXRob2QgZmluZE1ldGhvZChT\ndHJpbmcgbWV0aG9kKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1w\ndHkobWV0aG9kKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIC8vIGdldCBjbGFzcyBuYW1lIGFuZCBnZXQgcGFja2FnZSBuYW1lIGRpdmlk\nZSBvbiB0aGUgbGFzdCAnLicsIHNvIHRoZQogICAgICAgIC8vIG5hbWVzIGRv\nbid0IGFwcGx5IGluIHRoaXMgY2FzZSwgYnV0IHRoZSBtZXRob2RzIGRvIHdo\nYXQgd2Ugd2FudAogICAgICAgIFN0cmluZyBtZXRob2ROYW1lID0gU3RyaW5n\ncy5nZXRDbGFzc05hbWUobWV0aG9kKTsKICAgICAgICBTdHJpbmcgY2xzTmFt\nZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUobWV0aG9kKTsKCiAgICAgICAg\nQ2xhc3MgY2xzID0gbnVsbDsKICAgICAgICBDbGFzcyBvd25lciA9IF9vd25l\nci5nZXREZXNjcmliZWRUeXBlKCk7CgogICAgICAgIGlmIChjbHNOYW1lLmxl\nbmd0aCgpID09IDApCiAgICAgICAgICAgIGNscyA9IGdldERlY2xhcmVkVHlw\nZSgpOwogICAgICAgIGVsc2UgaWYgKGNsc05hbWUuZXF1YWxzKG93bmVyLmdl\ndE5hbWUoKSkKICAgICAgICAgICAgfHwgY2xzTmFtZS5lcXVhbHMoU3RyaW5n\ncy5nZXRDbGFzc05hbWUob3duZXIpKSkKICAgICAgICAgICAgY2xzID0gb3du\nZXI7CiAgICAgICAgZWxzZQogICAgICAgICAgICBjbHMgPSBKYXZhVHlwZXMu\nY2xhc3NGb3JOYW1lKGNsc05hbWUsIHRoaXMpOwoKICAgICAgICAvLyBmaW5k\nIHRoZSBuYW1lZCBtZXRob2QKICAgICAgICBNZXRob2RbXSBtZXRob2RzID0g\nY2xzLmdldE1ldGhvZHMoKTsKICAgICAgICBDbGFzc1tdIHBhcmFtczsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1ldGhvZHMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgaWYgKG1ldGhvZHNbaV0uZ2V0TmFtZSgpLmVxdWFs\ncyhtZXRob2ROYW1lKSkgewogICAgICAgICAgICAgICAgcGFyYW1zID0gbWV0\naG9kc1tpXS5nZXRQYXJhbWV0ZXJUeXBlcygpOwoKICAgICAgICAgICAgICAg\nIC8vIHN0YXRpYyBmYWN0b3J5IG1ldGhvZHMgcmVxdWlyZSBvbmUgYXJndW1l\nbnQgb3Igb25lIGFyZ3VtZW50CiAgICAgICAgICAgICAgICAvLyBwbHVzIGEg\nY3R4OyBub24tc3RhdGljIG1ldGhvZHMgcmVxdWlyZSB6ZXJvIGFyZ3VtZW50\ncyBvcgogICAgICAgICAgICAgICAgLy8ganVzdCBhIGN0eAogICAgICAgICAg\nICAgICAgaWYgKE1vZGlmaWVyLmlzU3RhdGljKG1ldGhvZHNbaV0uZ2V0TW9k\naWZpZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgJiYgKHBhcmFtcy5sZW5n\ndGggPT0gMSB8fCAocGFyYW1zLmxlbmd0aCA9PSAyCiAgICAgICAgICAgICAg\nICAgICAgJiYgaXNTdG9yZUNvbnRleHRQYXJhbWV0ZXIocGFyYW1zWzFdKSkp\nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRob2RzW2ldOwogICAg\nICAgICAgICAgICAgaWYgKCFNb2RpZmllci5pc1N0YXRpYyhtZXRob2RzW2ld\nLmdldE1vZGlmaWVycygpKQogICAgICAgICAgICAgICAgICAgICYmIChwYXJh\nbXMubGVuZ3RoID09IDAgfHwgKHBhcmFtcy5sZW5ndGggPT0gMQogICAgICAg\nICAgICAgICAgICAgICYmIGlzU3RvcmVDb250ZXh0UGFyYW1ldGVyKHBhcmFt\nc1swXSkpKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0aG9kc1tp\nXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUg\nZ2l2ZW4gdHlwZSBpcyBhIHN0b3JlIGNvbnRleHQgdHlwZTsgd2UgY2FuJ3QK\nICAgICAqIHVzZSB0aGUgc3RhbmRhcmQgPGNvZGU+aXNBc3NpZ25hYmxlRnJv\nbTwvY29kZT4gYmVjYXVzZSBvZiBjbGFzc2xvYWRlcgogICAgICogb2RkbmVz\ncy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBpc1N0b3Jl\nQ29udGV4dFBhcmFtZXRlcihDbGFzcyB0eXBlKSB7CiAgICAgICAgcmV0dXJu\nIFN0b3JlQ29udGV4dC5jbGFzcy5nZXROYW1lKCkuZXF1YWxzKHR5cGUuZ2V0\nTmFtZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewog\nICAgICAgIHJldHVybiBnZXRGdWxsTmFtZSh0cnVlKS5oYXNoQ29kZSgpOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIp\nIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykKICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBGaWVs\nZE1ldGFEYXRhKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiBnZXRGdWxsTmFtZSh0cnVlKS5lcXVhbHMoKChGaWVsZE1ldGFE\nYXRhKSBvdGhlcikuCiAgICAgICAgICAgIGdldEZ1bGxOYW1lKHRydWUpKTsK\nICAgIH0KCiAgICBwdWJsaWMgaW50IGNvbXBhcmVUbyhPYmplY3Qgb3RoZXIp\nIHsKICAgICAgICBpZiAob3RoZXIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIDE7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKHRydWUpLmNvbXBh\ncmVUbygoKEZpZWxkTWV0YURhdGEpIG90aGVyKS4KICAgICAgICAgICAgZ2V0\nRnVsbE5hbWUodHJ1ZSkpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9T\ndHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKHRydWUpOwog\nICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUmVz\nb2x2ZSBhbmQgdmFsaWRhdGUKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwoKICAgIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZvciB0aGlzIGZpZWxk\nLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFJlc29sdmUoKSB7CiAgICAg\nICAgcmV0dXJuIF9yZXNNb2RlOwogICAgfQoKICAgIC8qKgogICAgICogUmVz\nb2x2ZSBtb2RlIGZvciB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRSZXNvbHZlKGludCBtb2RlKSB7CiAgICAgICAgX3Jlc01vZGUg\nPSBtb2RlOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZv\nciB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZXNv\nbHZlKGludCBtb2RlLCBib29sZWFuIG9uKSB7CiAgICAgICAgaWYgKG1vZGUg\nPT0gTU9ERV9OT05FKQogICAgICAgICAgICBfcmVzTW9kZSA9IG1vZGU7CiAg\nICAgICAgZWxzZSBpZiAob24pCiAgICAgICAgICAgIF9yZXNNb2RlIHw9IG1v\nZGU7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfcmVzTW9kZSAmPSB+bW9k\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc29sdmUgYW5kIHZhbGlkYXRl\nIG1ldGFkYXRhLiBSZXR1cm4gdHJ1ZSBpZiBhbHJlYWR5IHJlc29sdmVkLgog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiByZXNvbHZlKGludCBtb2RlKSB7\nCiAgICAgICAgaWYgKChfcmVzTW9kZSAmIG1vZGUpID09IG1vZGUpCiAgICAg\nICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGludCBjdXIgPSBfcmVzTW9k\nZTsKICAgICAgICBfcmVzTW9kZSB8PSBtb2RlOwoKICAgICAgICBMb2cgbG9n\nID0gZ2V0UmVwb3NpdG9yeSgpLmdldExvZygpOwogICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2Mu\nZ2V0KCJyZXNvbHZlLWZpZWxkIiwgX293bmVyICsgIkAiCiAgICAgICAgICAg\nICAgICArIFN5c3RlbS5pZGVudGl0eUhhc2hDb2RlKF9vd25lcikgKyAiLiIg\nKyBfbmFtZSkpOwoKICAgICAgICAvLyB3ZSBvbmx5IHBlcmZvcm0gYWN0aW9u\ncyBmb3IgbWV0YWRhdGEgbW9kZQogICAgICAgIGlmICgobW9kZSAmIE1PREVf\nTUVUQSkgPT0gMCB8fCAoY3VyICYgTU9ERV9NRVRBKSAhPSAwKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIE1ldGhvZCBleHRlcm5hbGl6\nZXIgPSBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKTsKICAgICAgICBpZiAoZXh0\nZXJuYWxpemVyICE9IG51bGwpCiAgICAgICAgICAgIHNldFR5cGUoZXh0ZXJu\nYWxpemVyLmdldFJldHVyblR5cGUoKSk7CgogICAgICAgIC8vIG9ubHkgcGFz\ncyBvbiBtZXRhZGF0YSByZXNvbHZlIG1vZGUgc28gdGhhdCBtZXRhZGF0YSBp\ncyBhbHdheXMKICAgICAgICAvLyByZXNvbHZlZCBiZWZvcmUgYW55IG90aGVy\nIHJlc29sdmUgbW9kZXMgb3VyIHN1YmNsYXNzZXMgcGFzcyBhbG9uZwogICAg\nICAgIF92YWwucmVzb2x2ZShNT0RFX01FVEEpOwogICAgICAgIF9rZXkucmVz\nb2x2ZShNT0RFX01FVEEpOwogICAgICAgIF9lbGVtLnJlc29sdmUoTU9ERV9N\nRVRBKTsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gZ2V0\nUmVwb3NpdG9yeSgpOwogICAgICAgIGludCB2YWxpZGF0ZSA9IHJlcG9zLmdl\ndFZhbGlkYXRlKCk7CiAgICAgICAgaWYgKCh2YWxpZGF0ZSAmIE1ldGFEYXRh\nUmVwb3NpdG9yeS5WQUxJREFURV9NRVRBKSAhPSAwCiAgICAgICAgICAgICYm\nICghUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20K\nICAgICAgICAgICAgKF9vd25lci5nZXREZXNjcmliZWRUeXBlKCkpCiAgICAg\nICAgICAgIHx8ICh2YWxpZGF0ZSAmIE1ldGFEYXRhUmVwb3NpdG9yeS5WQUxJ\nREFURV9VTkVOSEFOQ0VEKSA9PSAwKSkgewogICAgICAgICAgICB2YWxpZGF0\nZUxSUygpOwogICAgICAgICAgICBpZiAoKHZhbGlkYXRlICYgcmVwb3MuVkFM\nSURBVEVfUlVOVElNRSkgPT0gMCkKICAgICAgICAgICAgICAgIHZhbGlkYXRl\nU3VwcG9ydGVkVHlwZSgpOwogICAgICAgICAgICB2YWxpZGF0ZVZhbHVlKCk7\nCiAgICAgICAgICAgIHZhbGlkYXRlRXh0ZW5zaW9uS2V5cygpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBWYWxpZGF0ZSB0aGF0IHRoaXMgZmllbGQgY2FuIGJlIHVzZWQgZm9yIExS\nUy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlTFJTKCkgewog\nICAgICAgIGlmICghaXNMUlMoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICAvLyBjYW4ndCB1c2UgbHJzIGZvciBhcnJheXMKICAgICAgICBpZiAo\nZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuQVJSQVkpCiAgICAgICAgICAg\nIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWxy\ncy1hcnJheSIsIHRoaXMpKTsKCiAgICAgICAgLy8gY2FuJ3QgdXNlIGxycyBm\nb3IgZXh0cmFuYWxpemVkIHZhbHMKICAgICAgICBpZiAoZ2V0RXh0ZXJuYWxp\nemVyTWV0aG9kKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1l\ndGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbHJzLWV4dGVybiIsIHRo\naXMpKTsKCiAgICAgICAgLy8gY2FuJ3QgdXNlIGxycyBmb3IgY29uY3JldGUg\ndHlwZXMKICAgICAgICBpZiAoZ2V0VHlwZSgpICE9IENvbGxlY3Rpb24uY2xh\nc3MgJiYgZ2V0VHlwZSgpICE9IE1hcC5jbGFzcwogICAgICAgICAgICAmJiBn\nZXRUeXBlKCkgIT0gU2V0LmNsYXNzKQogICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1scnMtY29uY3JldGUi\nLCB0aGlzKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0\nIHRoaXMgZmllbGQgaXMgc3VwcG9ydGVkIGJ5IHRoZSBydW50aW1lLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgdmFsaWRhdGVTdXBwb3J0ZWRUeXBlKCkg\newogICAgICAgIC8vIGxvZyB3YXJuaW5ncyBhYm91dCB0aGluZ3Mgd2UgZG9u\nJ3QgaGFuZGxlCiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiA9\nIGdldFJlcG9zaXRvcnkoKS5nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAg\nQ29sbGVjdGlvbiBvcHRzID0gY29uZi5zdXBwb3J0ZWRPcHRpb25zKCk7CiAg\nICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9nKGNvbmYuTE9HX01FVEFEQVRB\nKTsKICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICBpZiAoaXNF\nbWJlZGRlZCgpICYmCiAgICAgICAgICAgICAgICAgICAgIW9wdHMuY29udGFp\nbnMoY29uZi5PUFRJT05fRU1CRURERURfUkVMQVRJT04pKSB7CiAgICAgICAg\nICAgICAgICAgICAgc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAgICAgICAg\nICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJlZCIsIHRo\naXMpKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAg\naWYgKGlzRW1iZWRkZWQoKSAmJiBnZXREZWNsYXJlZFR5cGVDb2RlKCkgIT0g\nSmF2YVR5cGVzLlBDKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0RW1iZWRk\nZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgiY2FudC1lbWJlZC1leHRlcm4iLCB0aGlzKSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgIGlm\nICghb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9UWVBFX0NPTExFQ1RJT04p\nKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4\nY2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgX2xvYy5nZXQoInR5\ncGUtbm90LXN1cHBvcnRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAiQ29sbGVjdGlvbiIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIGlmIChf\nZWxlbS5pc0VtYmVkZGVkUEMoKQogICAgICAgICAgICAgICAgICAgICYmICFv\ncHRzLmNvbnRhaW5zKGNvbmYuT1BUSU9OX0VNQkVEREVEX0NPTExFQ1RJT05f\nUkVMQVRJT04pKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAg\nICAgIF9lbGVtLnNldEVtYmVkZGVkKGZhbHNlKTsKICAgICAgICAgICAgICAg\nICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAg\nICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImNhbnQtZW1iZWQtZWxlbWVu\ndCIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAg\nICAgICAgICAgICAgIGlmICghb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9U\nWVBFX0FSUkFZKSkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5z\ndXBwb3J0ZWRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgIF9s\nb2MuZ2V0KCJ0eXBlLW5vdC1zdXBwb3J0ZWQiLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIkFycmF5IiwgdGhpcykpOwogICAgICAgICAgICAgICAg\naWYgKF9lbGVtLmlzRW1iZWRkZWRQQygpCiAgICAgICAgICAgICAgICAgICAg\nJiYgIW9wdHMuY29udGFpbnMoY29uZi5PUFRJT05fRU1CRURERURfQ09MTEVD\nVElPTl9SRUxBVElPTikpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAg\nICAgICAgICAgX2VsZW0uc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAgICAg\nICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJlZC1l\nbGVtZW50IiwgdGhpcykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk1BUDoK\nICAgICAgICAgICAgICAgIGlmICghb3B0cy5jb250YWlucyhjb25mLk9QVElP\nTl9UWVBFX01BUCkpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVu\nc3VwcG9ydGVkRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICBf\nbG9jLmdldCgidHlwZS1ub3Qtc3VwcG9ydGVkIiwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICJNYXAiLCB0aGlzKSk7CiAgICAgICAgICAgICAgICBp\nZiAoX2VsZW0uaXNFbWJlZGRlZFBDKCkKICAgICAgICAgICAgICAgICAgICAm\nJiAhb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9FTUJFRERFRF9NQVBfUkVM\nQVRJT04pKSB7CiAgICAgICAgICAgICAgICAgICAgX2VsZW0uc2V0RW1iZWRk\nZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgiY2FudC1lbWJlZC1lbGVtZW50IiwgdGhpcykpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKF9rZXkuaXNFbWJlZGRl\nZFBDKCkKICAgICAgICAgICAgICAgICAgICAmJiAhb3B0cy5jb250YWlucyhj\nb25mLk9QVElPTl9FTUJFRERFRF9NQVBfUkVMQVRJT04pKSB7CiAgICAgICAg\nICAgICAgICAgICAgX2tleS5zZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVk\nLWtleSIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFZh\nbGlkYXRlIG91ciB2YWx1ZSBzdHJhdGVneS4KICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIHZhbGlkYXRlVmFsdWUoKSB7CiAgICAgICAgaWYgKGdldEV4dGVy\nbmFsaXplck1ldGhvZCgpICE9IG51bGwgJiYgZ2V0RXh0ZXJuYWxWYWx1ZU1h\ncCgpICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4\nY2VwdGlvbihfbG9jLmdldCgiZXh0ZXJuLWV4dGVybnZhbHVlcyIsIHRoaXMp\nKTsKICAgICAgICBpZiAoZ2V0VmFsdWVTdHJhdGVneSgpID09IFZhbHVlU3Ry\nYXRlZ2llcy5TRVFVRU5DRQogICAgICAgICAgICAmJiBnZXRWYWx1ZVNlcXVl\nbmNlTmFtZSgpID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRh\nRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tc2VxLW5hbWUiLCB0aGlzKSk7\nCiAgICAgICAgVmFsdWVTdHJhdGVnaWVzLmFzc2VydFN1cHBvcnRlZChnZXRW\nYWx1ZVN0cmF0ZWd5KCksIHRoaXMsCiAgICAgICAgICAgICJ2YWx1ZSBzdHJh\ndGVneSIpOwogICAgfQoKICAgIC8qKgogICAgICogQ29weSBzdGF0ZSBmcm9t\nIHRoZSBnaXZlbiBmaWVsZCB0byB0aGlzIG9uZS4gRG8gbm90IGNvcHkgbWFw\ncGluZwogICAgICogaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGNvcHkoRmllbGRNZXRhRGF0YSBmaWVsZCkgewogICAgICAgIHN1cGVy\nLmNvcHkoZmllbGQpOwoKICAgICAgICBfaW50ZXJtZWRpYXRlID0gZmllbGQu\ndXNlc0ludGVybWVkaWF0ZSgpOwogICAgICAgIF9pbXBsRGF0YSA9IGZpZWxk\nLnVzZXNJbXBsRGF0YSgpOwoKICAgICAgICAvLyBjb3B5IGZpZWxkLWxldmVs\nIGluZm87IHVzZSBnZXQgbWV0aG9kcyB0byBmb3JjZSByZXNvbHV0aW9uIG9m\nCiAgICAgICAgLy8gbGF6eSBkYXRhCiAgICAgICAgX3Byb3h5Q2xhc3MgPSBm\naWVsZC5nZXRQcm94eVR5cGUoKTsKICAgICAgICBfaW5pdGlhbGl6ZXIgPSBm\naWVsZC5nZXRJbml0aWFsaXplcigpOwogICAgICAgIF90cmFuc2llbnQgPSBm\naWVsZC5pc1RyYW5zaWVudCgpOwogICAgICAgIF9udWxsVmFsdWUgPSBmaWVs\nZC5nZXROdWxsVmFsdWUoKTsKICAgICAgICBfbWFuYWdlID0gZmllbGQuZ2V0\nTWFuYWdlbWVudCgpOwogICAgICAgIF9leHBsaWNpdCA9IGZpZWxkLmlzRXhw\nbGljaXQoKTsKICAgICAgICBfZXh0TmFtZSA9IGZpZWxkLmdldEV4dGVybmFs\naXplcigpOwogICAgICAgIF9leHRNZXRob2QgPSBERUZBVUxUX01FVEhPRDsK\nICAgICAgICBfZmFjdE5hbWUgPSBmaWVsZC5nZXRGYWN0b3J5KCk7CiAgICAg\nICAgX2ZhY3RNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAgICAgICBfZXh0\nU3RyaW5nID0gZmllbGQuZ2V0RXh0ZXJuYWxWYWx1ZXMoKTsKICAgICAgICBf\nZXh0VmFsdWVzID0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQOwogICAgICAgIF9m\naWVsZFZhbHVlcyA9IENvbGxlY3Rpb25zLkVNUFRZX01BUDsKICAgICAgICBf\ncHJpbUtleSA9IGZpZWxkLmlzUHJpbWFyeUtleSgpOwogICAgICAgIF9iYWNr\naW5nTWVtYmVyID0gZmllbGQuZ2V0QmFja2luZ01lbWJlcigpOwoKICAgICAg\nICAvLyBlbWJlZGRlZCBmaWVsZHMgY2FuJ3QgYmUgdmVyc2lvbnMKICAgICAg\nICBpZiAoX293bmVyLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgPT0gbnVsbCAm\nJiBfdmVyc2lvbiA9PSBudWxsKQogICAgICAgICAgICBfdmVyc2lvbiA9IChm\naWVsZC5pc1ZlcnNpb24oKSkgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZB\nTFNFOwoKICAgICAgICAvLyBvbmx5IGNvcHkgdGhpcyBkYXRhIGlmIG5vdCBh\nbHJlYWR5IHNldCBleHBsaWNpdGx5IGluIHRoaXMgaW5zdGFuY2UKICAgICAg\nICBpZiAoX2RmZyA9PSAwKSB7CiAgICAgICAgICAgIF9kZmcgPSAoZmllbGQu\naXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkpID8gREZHX1RSVUUgOiBERkdfRkFM\nU0U7CiAgICAgICAgICAgIGlmIChmaWVsZC5pc0RlZmF1bHRGZXRjaEdyb3Vw\nRXhwbGljaXQoKSkKICAgICAgICAgICAgICAgIF9kZmcgfD0gREZHX0VYUExJ\nQ0lUOwogICAgICAgIH0KICAgICAgICBpZiAoX2ZnU2V0ID09IG51bGwgJiYg\nZmllbGQuX2ZnU2V0ICE9IG51bGwpCiAgICAgICAgICAgIF9mZ1NldCA9IG5l\ndyBIYXNoU2V0KGZpZWxkLl9mZ1NldCk7CiAgICAgICAgaWYgKF9sZmcgPT0g\nbnVsbCkKICAgICAgICAgICAgX2xmZyA9IGZpZWxkLmdldExvYWRGZXRjaEdy\nb3VwKCk7CiAgICAgICAgaWYgKF9scnMgPT0gbnVsbCkKICAgICAgICAgICAg\nX2xycyA9IChmaWVsZC5pc0xSUygpKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xl\nYW4uRkFMU0U7CiAgICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkKICAg\nICAgICAgICAgX3ZhbFN0cmF0ZWd5ID0gZmllbGQuZ2V0VmFsdWVTdHJhdGVn\neSgpOwogICAgICAgIGlmIChfdXBTdHJhdGVneSA9PSAtMSkKICAgICAgICAg\nICAgX3VwU3RyYXRlZ3kgPSBmaWVsZC5nZXRVcGRhdGVTdHJhdGVneSgpOwog\nICAgICAgIGlmIChfc2VxTmFtZSA9PSBDbGFzc01ldGFEYXRhLkRFRkFVTFRf\nU1RSSU5HKSB7CiAgICAgICAgICAgIF9zZXFOYW1lID0gZmllbGQuZ2V0VmFs\ndWVTZXF1ZW5jZU5hbWUoKTsKICAgICAgICAgICAgX3NlcU1ldGEgPSBudWxs\nOwogICAgICAgIH0KICAgICAgICBpZiAoX2ludmVyc2UgPT0gQ2xhc3NNZXRh\nRGF0YS5ERUZBVUxUX1NUUklORykKICAgICAgICAgICAgX2ludmVyc2UgPSBm\naWVsZC5nZXRJbnZlcnNlKCk7CgogICAgICAgIC8vIGNvcHkgdmFsdWUgbWV0\nYWRhdGEKICAgICAgICBfdmFsLmNvcHkoZmllbGQpOwogICAgICAgIF9rZXku\nY29weShmaWVsZC5nZXRLZXkoKSk7CiAgICAgICAgX2VsZW0uY29weShmaWVs\nZC5nZXRFbGVtZW50KCkpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFk\nZEV4dGVuc2lvbktleXMoQ29sbGVjdGlvbiBleHRzKSB7CiAgICAgICAgZ2V0\nUmVwb3NpdG9yeSgpLmdldE1ldGFEYXRhRmFjdG9yeSgpLmFkZEZpZWxkRXh0\nZW5zaW9uS2V5cyhleHRzKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8K\nICAgIC8vIENvbW1lbnRhYmxlCiAgICAvLy8vLy8vLy8vLy8vLy8KCiAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0Q29tbWVudHMoKSB7CiAgICAgICAgcmV0dXJu\nIChfY29tbWVudHMgPT0gbnVsbCkgPyBFTVBUWV9DT01NRU5UUyA6IF9jb21t\nZW50czsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb21tZW50cyhTdHJp\nbmdbXSBjb21tZW50cykgewogICAgICAgIF9jb21tZW50cyA9IGNvbW1lbnRz\nOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nCiAgICAvLyBWYWx1ZU1ldGFEYXRhIGltcGxlbWVudGF0aW9uCiAgICAvLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBGaWVs\nZE1ldGFEYXRhIGdldEZpZWxkTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICB9CgogICAgcHVibGljIENsYXNzIGdldFR5cGUoKSB7CiAg\nICAgICAgcmV0dXJuIF92YWwuZ2V0VHlwZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldFR5cGUoQ2xhc3MgdHlwZSkgewogICAgICAgIF92YWwuc2V0\nVHlwZSh0eXBlKTsKICAgICAgICBpZiAodHlwZS5pc0FycmF5KCkpCiAgICAg\nICAgICAgIF9lbGVtLnNldFR5cGUodHlwZS5nZXRDb21wb25lbnRUeXBlKCkp\nOwogICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gUHJvcGVydGllcy5jbGFzcykg\newogICAgICAgICAgICBfa2V5LnNldFR5cGUoU3RyaW5nLmNsYXNzKTsKICAg\nICAgICAgICAgX2VsZW0uc2V0VHlwZShTdHJpbmcuY2xhc3MpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IGdldFR5cGVDb2RlKCkgewogICAg\nICAgIHJldHVybiBfdmFsLmdldFR5cGVDb2RlKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0VHlwZUNvZGUoaW50IGNvZGUpIHsKICAgICAgICBfdmFs\nLnNldFR5cGVDb2RlKGNvZGUpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGlzVHlwZVBDKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzVHlwZVBDKCk7\nCiAgICB9CgogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0VHlwZU1ldGFE\nYXRhKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldFR5cGVNZXRhRGF0YSgp\nOwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBnZXREZWNsYXJlZFR5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0RGVjbGFyZWRUeXBlKENsYXNzIHR5cGUp\nIHsKICAgICAgICBfdmFsLnNldERlY2xhcmVkVHlwZSh0eXBlKTsKICAgICAg\nICBpZiAodHlwZS5pc0FycmF5KCkpCiAgICAgICAgICAgIF9lbGVtLnNldERl\nY2xhcmVkVHlwZSh0eXBlLmdldENvbXBvbmVudFR5cGUoKSk7CiAgICAgICAg\nZWxzZSBpZiAodHlwZSA9PSBQcm9wZXJ0aWVzLmNsYXNzKSB7CiAgICAgICAg\nICAgIF9rZXkuc2V0RGVjbGFyZWRUeXBlKFN0cmluZy5jbGFzcyk7CiAgICAg\nICAgICAgIF9lbGVtLnNldERlY2xhcmVkVHlwZShTdHJpbmcuY2xhc3MpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IGdldERlY2xhcmVkVHlw\nZUNvZGUoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RGVjbGFyZWRUeXBl\nQ29kZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkVHlw\nZUNvZGUoaW50IHR5cGUpIHsKICAgICAgICBfdmFsLnNldERlY2xhcmVkVHlw\nZUNvZGUodHlwZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEZWNs\nYXJlZFR5cGVQQygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5pc0RlY2xhcmVk\nVHlwZVBDKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0\nRGVjbGFyZWRUeXBlTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwu\nZ2V0RGVjbGFyZWRUeXBlTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0VtYmVkZGVkKCkgewogICAgICAgIHJldHVybiBfdmFsLmlz\nRW1iZWRkZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFbWJlZGRl\nZChib29sZWFuIGVtYmVkZGVkKSB7CiAgICAgICAgX3ZhbC5zZXRFbWJlZGRl\nZChlbWJlZGRlZCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNFbWJl\nZGRlZFBDKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzRW1iZWRkZWRQQygp\nOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdldEVtYmVkZGVk\nTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RW1iZWRkZWRN\nZXRhRGF0YSgpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGFk\nZEVtYmVkZGVkTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuYWRk\nRW1iZWRkZWRNZXRhRGF0YSgpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0\nQ2FzY2FkZURlbGV0ZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRDYXNj\nYWRlRGVsZXRlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2FzY2Fk\nZURlbGV0ZShpbnQgZGVsZXRlKSB7CiAgICAgICAgX3ZhbC5zZXRDYXNjYWRl\nRGVsZXRlKGRlbGV0ZSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRDYXNj\nYWRlUGVyc2lzdCgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRDYXNjYWRl\nUGVyc2lzdCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhc2NhZGVQ\nZXJzaXN0KGludCBwZXJzaXN0KSB7CiAgICAgICAgX3ZhbC5zZXRDYXNjYWRl\nUGVyc2lzdChwZXJzaXN0KTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENh\nc2NhZGVBdHRhY2goKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Q2FzY2Fk\nZUF0dGFjaCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhc2NhZGVB\ndHRhY2goaW50IGF0dGFjaCkgewogICAgICAgIF92YWwuc2V0Q2FzY2FkZUF0\ndGFjaChhdHRhY2gpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0Q2FzY2Fk\nZVJlZnJlc2goKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Q2FzY2FkZVJl\nZnJlc2goKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDYXNjYWRlUmVm\ncmVzaChpbnQgcmVmcmVzaCkgewogICAgICAgIF92YWwuc2V0Q2FzY2FkZVJl\nZnJlc2gocmVmcmVzaCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNT\nZXJpYWxpemVkKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzU2VyaWFsaXpl\nZCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNlcmlhbGl6ZWQoYm9v\nbGVhbiBzZXJpYWxpemVkKSB7CiAgICAgICAgX3ZhbC5zZXRTZXJpYWxpemVk\nKHNlcmlhbGl6ZWQpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFs\ndWVNYXBwZWRCeSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRWYWx1ZU1h\ncHBlZEJ5KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VmFsdWVNYXBw\nZWRCeShTdHJpbmcgbWFwcGVkKSB7CiAgICAgICAgX3ZhbC5zZXRWYWx1ZU1h\ncHBlZEJ5KG1hcHBlZCk7CiAgICB9CgogICAgcHVibGljIEZpZWxkTWV0YURh\ndGEgZ2V0VmFsdWVNYXBwZWRCeU1ldGFEYXRhICgpCgl7CgkJcmV0dXJuIF92\nYWwuZ2V0VmFsdWVNYXBwZWRCeU1ldGFEYXRhICgpOwoJfQoKCXB1YmxpYyBD\nbGFzcyBnZXRUeXBlT3ZlcnJpZGUgKCkKCXsKCQlyZXR1cm4gX3ZhbC5nZXRU\neXBlT3ZlcnJpZGUgKCk7Cgl9CgoJcHVibGljIHZvaWQgc2V0VHlwZU92ZXJy\naWRlIChDbGFzcyB0eXBlKQoJewoJCV92YWwuc2V0VHlwZU92ZXJyaWRlICh0\neXBlKTsKCX0KCglwdWJsaWMgdm9pZCBjb3B5IChWYWx1ZU1ldGFEYXRhIHZt\nZCkKCXsKCQlfdmFsLmNvcHkgKHZtZCk7Cgl9Cn0K\n","encoding":"base64"}

