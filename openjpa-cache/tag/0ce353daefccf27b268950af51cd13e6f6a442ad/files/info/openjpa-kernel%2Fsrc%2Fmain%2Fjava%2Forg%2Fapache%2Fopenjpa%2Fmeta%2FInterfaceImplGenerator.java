{"sha":"0487c4056bc82392abc301725ad40baddf3e2325","node_id":"MDQ6QmxvYjIwNjM2NDowNDg3YzQwNTZiYzgyMzkyYWJjMzAxNzI1YWQ0MGJhZGRmM2UyMzI1","size":7507,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0487c4056bc82392abc301725ad40baddf3e2325","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhOwoKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhv\nZDsKaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5SW5wdXRTdHJlYW07CmltcG9y\ndCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLldlYWtIYXNo\nTWFwOwoKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdV\ndGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBDRW5o\nYW5jZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5h\nbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBzZXJwLmJ5dGVjb2RlLkJDQ2xhc3M7Cmlt\ncG9ydCBzZXJwLmJ5dGVjb2RlLkJDQ2xhc3NMb2FkZXI7CmltcG9ydCBzZXJw\nLmJ5dGVjb2RlLkJDRmllbGQ7CmltcG9ydCBzZXJwLmJ5dGVjb2RlLkJDTWV0\naG9kOwppbXBvcnQgc2VycC5ieXRlY29kZS5Db2RlOwppbXBvcnQgc2VycC5i\neXRlY29kZS5Db25zdGFudHM7CmltcG9ydCBzZXJwLmJ5dGVjb2RlLlByb2pl\nY3Q7CgoKLyoqCiAqIENyZWF0ZXMgaW1wbGVtZW50YXRpb25zIG9mIG1hbmFn\nZWQgaW50ZXJmYWNlcy4gIFdpbGwgdGhyb3cgZXhjZXB0aW9ucwogKiBvbiB1\nbmtub3duIHByb3BlcnRpZXMuCiAqCiAqIEBhdXRob3IgU3RldmUgS2ltCiAq\nLwpjbGFzcyBJbnRlcmZhY2VJbXBsR2VuZXJhdG9yIHsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBh\nY2thZ2UKICAgICAgICAoSW50ZXJmYWNlSW1wbEdlbmVyYXRvci5jbGFzcyk7\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUE9TVEZJWCA9ICJv\ncGVuanBhaW1wbCI7CgogICAgcHJpdmF0ZSBmaW5hbCBNZXRhRGF0YVJlcG9z\naXRvcnkgX3JlcG9zOwogICAgcHJpdmF0ZSBmaW5hbCBNYXAgX2ltcGxzID0g\nbmV3IFdlYWtIYXNoTWFwKCk7CiAgICBwcml2YXRlIGZpbmFsIFByb2plY3Qg\nX3Byb2plY3QgPSBuZXcgUHJvamVjdCgpOwogICAgcHJpdmF0ZSBmaW5hbCBC\nQ0NsYXNzTG9hZGVyIF9sb2FkZXIgPSBuZXcgQkNDbGFzc0xvYWRlcihfcHJv\namVjdCk7CgogICAgLy8gZGlzdGluY3QgcHJvamVjdCAvIGxvYWRlciBmb3Ig\nZW5oYW5jZWQgdmVyc2lvbiBvZiBjbGFzcwogICAgcHJpdmF0ZSBmaW5hbCBQ\ncm9qZWN0IF9lbmhQcm9qZWN0ID0gbmV3IFByb2plY3QoKTsKICAgIHByaXZh\ndGUgZmluYWwgQkNDbGFzc0xvYWRlciBfZW5oTG9hZGVyID0gbmV3IEJDQ2xh\nc3NMb2FkZXIoX2VuaFByb2plY3QpOwoKICAgIC8qKgogICAgICogQ29uc3Ry\ndWN0b3IuICBTdXBwbHkgcmVwb3NpdG9yeS4KICAgICAqLwogICAgcHVibGlj\nIEludGVyZmFjZUltcGxHZW5lcmF0b3IoTWV0YURhdGFSZXBvc2l0b3J5IHJl\ncG9zKSB7CiAgICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgYSBjb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiB0\naGUgZ2l2ZW4gdHlwZSwgcG9zc2libHkKICAgICAqIHJldHVybmluZyBhIGNh\nY2hlZCB2ZXJzaW9uIG9mIHRoZSBjbGFzcy4KICAgICAqLwogICAgcHVibGlj\nIHN5bmNocm9uaXplZCBDbGFzcyBjcmVhdGVJbXBsKENsYXNzTWV0YURhdGEg\nbWV0YSkgewogICAgICAgIENsYXNzIGlmYWNlID0gbWV0YS5nZXREZXNjcmli\nZWRUeXBlKCk7CgogICAgICAgIC8vIGNoZWNrIGNhY2hlLgogICAgICAgIENs\nYXNzIGltcGwgPSAoQ2xhc3MpIF9pbXBscy5nZXQoaWZhY2UpOwogICAgICAg\nIGlmIChpbXBsICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBpbXBsOwoK\nICAgICAgICBCQ0NsYXNzIGJjID0gX3Byb2plY3QubG9hZENsYXNzKGdldENs\nYXNzTmFtZShtZXRhKSk7CiAgICAgICAgYmMuZGVjbGFyZUludGVyZmFjZShp\nZmFjZSk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBzdXAgPSBtZXRhLmdldFBD\nU3VwZXJjbGFzc01ldGFEYXRhKCk7CiAgICAgICAgaWYgKHN1cCAhPSBudWxs\nKQogICAgICAgICAgICBiYy5zZXRTdXBlcmNsYXNzKHN1cC5nZXRJbnRlcmZh\nY2VJbXBsKCkpOwoKICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0g\nbWV0YS5nZXREZWNsYXJlZEZpZWxkcygpOwogICAgICAgIFNldCBtZXRob2Rz\nID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGZpZWxkcy5sZW5ndGg7IGkrKykgCiAgICAgICAgICAgIGFkZEZpZWxkKGJj\nLCBpZmFjZSwgZmllbGRzW2ldLCBtZXRob2RzKTsKICAgICAgICBpbnZhbGlk\nYXRlTm9uQmVhbk1ldGhvZHMoYmMsIGlmYWNlLCBtZXRob2RzKTsKCiAgICAg\nICAgLy8gZmlyc3QgbG9hZCB0aGUgYmFzZSBjbGFzcyBhcyB0aGUgZW5oYW5j\nZXIgcmVxdWlyZXMgdGhlIGNsYXNzCiAgICAgICAgLy8gdG8gYmUgYXZhaWxh\nYmxlCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbWV0YS5zZXRJbnRlcmZh\nY2VJbXBsKENsYXNzLmZvck5hbWUoYmMuZ2V0TmFtZSgpLCB0cnVlLCBfbG9h\nZGVyKSk7CiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKF9sb2MuZ2V0KCJp\nbnRlcmZhY2UtbG9hZCIpLCB0KS4KICAgICAgICAgICAgICAgIHNldEZhdGFs\nKHRydWUpOwogICAgICAgIH0KICAgICAgICAvLyBjb3B5IHRoZSBCQ0NsYXNz\nIGludG8gdGhlIGVuaGFuY2VyIHByb2plY3QuCiAgICAgICAgYmMgPSBfZW5o\nUHJvamVjdC5sb2FkQ2xhc3MobmV3IEJ5dGVBcnJheUlucHV0U3RyZWFtKGJj\nLnRvQnl0ZUFycmF5KCkpLCAKICAgICAgICAgICAgX2xvYWRlcik7CiAgICAg\nICAgUENFbmhhbmNlciBlbmhhbmNlciA9IG5ldyBQQ0VuaGFuY2VyKF9yZXBv\ncy5nZXRDb25maWd1cmF0aW9uKCksIGJjLCAKICAgICAgICAgICAgbWV0YSk7\nCgogICAgICAgIGludCByZXN1bHQgPSBlbmhhbmNlci5ydW4oKTsKICAgICAg\nICBpZiAocmVzdWx0ICE9IFBDRW5oYW5jZXIuRU5IQU5DRV9QQykKICAgICAg\nICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKF9sb2MuZ2V0KCJp\nbnRlcmZhY2UtYmFkZW5oYW5jZSIsIAogICAgICAgICAgICAgICAgaWZhY2Up\nKS5zZXRGYXRhbCh0cnVlKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgIC8v\nIGxvYWQgdGhlIGNsYXNzIGZvciByZWFsLgogICAgICAgICAgICBpbXBsID0g\nQ2xhc3MuZm9yTmFtZShiYy5nZXROYW1lKCksIHRydWUsIF9lbmhMb2FkZXIp\nOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAg\nIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihfbG9jLmdldCgiaW50ZXJm\nYWNlLWxvYWQyIiksIHQpLgogICAgICAgICAgICAgICAgc2V0RmF0YWwodHJ1\nZSk7CiAgICAgICAgfQogICAgICAgIC8vIGNhY2hlIHRoZSBnZW5lcmF0ZWQg\naW1wbC4KICAgICAgICBfaW1wbHMucHV0KGlmYWNlLCBpbXBsKTsKICAgICAg\nICByZXR1cm4gaW1wbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBiZWFu\nIGdldHRlcnMgYW5kIHNldHRlcnMsIGFsc28gcmVjb3JkaW5nIHNlZW4gbWV0\naG9kcwogICAgICogaW50byB0aGUgZ2l2ZW4gc2V0LgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgYWRkRmllbGQgKEJDQ2xhc3MgYmMsIENsYXNzIGlmYWNl\nLCBGaWVsZE1ldGFEYXRhIGZtZCwgCiAgICAgICAgU2V0IG1ldGhvZHMpIHsK\nICAgICAgICBTdHJpbmcgbmFtZSA9IGZtZC5nZXROYW1lKCk7CiAgICAgICAg\nQ2xhc3MgdHlwZSA9IGZtZC5nZXREZWNsYXJlZFR5cGUoKTsKICAgICAgICBC\nQ0ZpZWxkIGZpZWxkID0gYmMuZGVjbGFyZUZpZWxkKG5hbWUsIHR5cGUpOwog\nICAgICAgIGZpZWxkLnNldEFjY2Vzc0ZsYWdzKENvbnN0YW50cy5BQ0NFU1Nf\nUFJJVkFURSk7CgogICAgICAgIC8vIGdldHRlcgogICAgICAgIG5hbWUgPSBT\ndHJpbmdVdGlscy5jYXBpdGFsaXplKG5hbWUpOwogICAgICAgIFN0cmluZyBw\ncmVmaXggPSBpc0dldHRlcihpZmFjZSwgZm1kKSA/ICJnZXQiIDogImlzIjsK\nICAgICAgICBCQ01ldGhvZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZChwcmVm\naXggKyBuYW1lLCB0eXBlLCBudWxsKTsKICAgICAgICBtZXRoLm1ha2VQdWJs\naWMoKTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1ZSk7\nCiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2Rl\nLmdldGZpZWxkKCkuc2V0RmllbGQoZmllbGQpOwogICAgICAgIGNvZGUueHJl\ndHVybigpLnNldFR5cGUodHlwZSk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVN\nYXhTdGFjaygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7\nCiAgICAgICAgbWV0aG9kcy5hZGQoZ2V0TWV0aG9kU2FmZShpZmFjZSwgbWV0\naC5nZXROYW1lKCksIG51bGwpKTsKCiAgICAgICAgLy8gc2V0dGVyCiAgICAg\nICAgbWV0aCA9IGJjLmRlY2xhcmVNZXRob2QoInNldCIgKyBuYW1lLCB2b2lk\nLmNsYXNzLCBuZXcgQ2xhc3NbXXt0eXBlfSk7CiAgICAgICAgbWV0aC5tYWtl\nUHVibGljKCk7CiAgICAgICAgY29kZSA9IG1ldGguZ2V0Q29kZSh0cnVlKTsK\nICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgIGNvZGUu\neGxvYWQoKS5zZXRQYXJhbSgwKS5zZXRUeXBlKHR5cGUpOwogICAgICAgIGNv\nZGUucHV0ZmllbGQoKS5zZXRGaWVsZChmaWVsZCk7CiAgICAgICAgY29kZS52\ncmV0dXJuKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwog\nICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAgICAgICAgbWV0\naG9kcy5hZGQoZ2V0TWV0aG9kU2FmZShpZmFjZSwgbWV0aC5nZXROYW1lKCks\nIHR5cGUpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEludmFsaWRhdGUgbWV0\naG9kcyBvbiB0aGUgaW50ZXJmYWNlIHdoaWNoIGFyZSBub3QgbWFuYWdlZC4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGludmFsaWRhdGVOb25CZWFuTWV0\naG9kcyhCQ0NsYXNzIGJjLCBDbGFzcyBpZmFjZSwgCiAgICAgICAgU2V0IG1l\ndGhvZHMpIHsKICAgICAgICBNZXRob2RbXSBtZXRocyA9IGlmYWNlLmdldERl\nY2xhcmVkTWV0aG9kcygpOwogICAgICAgIEJDTWV0aG9kIG1ldGg7CiAgICAg\nICAgQ29kZSBjb2RlOwogICAgICAgIENsYXNzIHR5cGUgPSBfcmVwb3MuZ2V0\nTWV0YURhdGFGYWN0b3J5KCkuZ2V0RGVmYXVsdHMoKS4KICAgICAgICAgICAg\nZ2V0VW5pbXBsZW1lbnRlZEV4Y2VwdGlvblR5cGUoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IG1ldGhzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIGlmIChtZXRob2RzLmNvbnRhaW5zKG1ldGhzW2ldKSkKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBtZXRoID0gYmMuZGVjbGFy\nZU1ldGhvZChtZXRoc1tpXS5nZXROYW1lKCksIAogICAgICAgICAgICAgICAg\nbWV0aHNbaV0uZ2V0UmV0dXJuVHlwZSgpLCBtZXRoc1tpXS5nZXRQYXJhbWV0\nZXJUeXBlcygpKTsKICAgICAgICAgICAgbWV0aC5tYWtlUHVibGljKCk7CiAg\nICAgICAgICAgIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1ZSk7CiAgICAgICAg\nICAgIGNvZGUuYW5ldygpLnNldFR5cGUodHlwZSk7CiAgICAgICAgICAgIGNv\nZGUuZHVwKCk7CiAgICAgICAgICAgIGNvZGUuaW52b2tlc3BlY2lhbCgpLnNl\ndE1ldGhvZCh0eXBlLCAiPGluaXQ+Iiwgdm9pZC5jbGFzcywgbnVsbCk7CiAg\nICAgICAgICAgIGNvZGUuYXRocm93KCk7CiAgICAgICAgICAgIGNvZGUuY2Fs\nY3VsYXRlTWF4TG9jYWxzKCk7CiAgICAgICAgICAgIGNvZGUuY2FsY3VsYXRl\nTWF4U3RhY2soKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSB1bmlxdWUgY2xhc3MgbmFtZS4KICAgICAqLwogICAgcHJvdGVj\ndGVkIGZpbmFsIFN0cmluZyBnZXRDbGFzc05hbWUoQ2xhc3NNZXRhRGF0YSBt\nZXRhKSB7CiAgICAgICAgQ2xhc3MgaWZhY2UgPSBtZXRhLmdldERlc2NyaWJl\nZFR5cGUoKTsKICAgICAgICByZXR1cm4gaWZhY2UuZ2V0TmFtZSgpICsgIiQi\nICsgU3lzdGVtLmlkZW50aXR5SGFzaENvZGUoaWZhY2UpICsgUE9TVEZJWDsK\nICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBy\nZXR1cm4gdGhlIGdpdmVuIG1ldGhvZCAvIGFyZy4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgTWV0aG9kIGdldE1ldGhvZFNhZmUoQ2xhc3MgaWZhY2Us\nIFN0cmluZyBuYW1lLCBDbGFzcyBhcmcpIHsKICAgICAgICB0cnkgewogICAg\nICAgICAgICByZXR1cm4gaWZhY2UuZ2V0RGVjbGFyZWRNZXRob2QobmFtZSwg\nYXJnID09IG51bGwgPyBudWxsIDoKICAgICAgICAgICAgICAgIG5ldyBDbGFz\nc1tde2FyZ30pOwogICAgICAgIH0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbiAoX2xvYy5nZXQgKCJpbnRlcmZhY2UtbWlzbWF0Y2giLCBuYW1lKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\naXNHZXR0ZXIoQ2xhc3MgaWZhY2UsIEZpZWxkTWV0YURhdGEgZm1kKSB7CiAg\nICAgICAgaWYgKGZtZC5nZXRUeXBlKCkgIT0gYm9vbGVhbi5jbGFzcyAmJiBm\nbWQuZ2V0VHlwZSgpICE9IEJvb2xlYW4uY2xhc3MpCiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIE1ldGhvZCBt\nZXRoID0gaWZhY2UuZ2V0RGVjbGFyZWRNZXRob2QoImlzIiArIFN0cmluZ1V0\naWxzLmNhcGl0YWxpemUKICAgICAgICAgICAgICAgIChmbWQuZ2V0TmFtZSgp\nKSwgKENsYXNzW10pIG51bGwpOwogICAgICAgICAgICByZXR1cm4gbWV0aCA9\nPSBudWxsOwogICAgICAgIH0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4Y2VwdGlv\nbiBlKSB7fQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Cg==\n","encoding":"base64"}

