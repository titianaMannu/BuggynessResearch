{"sha":"5b8e88d9569be0f7e5dc83c04c486d71d195660b","node_id":"MDQ6QmxvYjIwNjM2NDo1YjhlODhkOTU2OWJlMGY3ZTVkYzgzYzA0YzQ4NmQ3MWQxOTU2NjBi","size":11084,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5b8e88d9569be0f7e5dc83c04c486d71d195660b","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhOwoKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGph\ndmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLlByaW50V3JpdGVy\nOwppbXBvcnQgamF2YS5pby5Xcml0ZXI7CmltcG9ydCBqYXZhLnV0aWwuSGFz\naE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51\ndGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYu\nT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuQ2xhc3NBcmdQYXJzZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuRmlsZXM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlvbjsKCi8q\nKgogKiBUb29sIGZvciBnZW5lcmF0aW5nIGRlZmF1bHQgbWV0YWRhdGEuCiAq\nCiAqIEBzaW5jZSAwLjMuMAogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVi\nbGljIGNsYXNzIE1ldGFEYXRhVG9vbAogICAgaW1wbGVtZW50cyBNZXRhRGF0\nYU1vZGVzIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJ\nT05fQUREID0gImFkZCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBBQ1RJT05fRFJPUCA9ICJkcm9wIjsKCiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZ1tdIEFDVElPTlMgPSBuZXcgU3RyaW5nW117CiAgICAgICAg\nQUNUSU9OX0FERCwKICAgICAgICBBQ1RJT05fRFJPUCwKICAgIH07CgogICAg\ncHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZShNZXRhRGF0YVRvb2wuY2xhc3MpOwoKICAgIHByaXZhdGUgZmlu\nYWwgT3BlbkpQQUNvbmZpZ3VyYXRpb24gX2NvbmY7CiAgICBwcml2YXRlIGZp\nbmFsIFN0cmluZyBfYWN0aW9uOwoKICAgIHByaXZhdGUgZmluYWwgU2V0IF9k\ncm9wOwogICAgcHJpdmF0ZSBNZXRhRGF0YVJlcG9zaXRvcnkgX3JlcG9zID0g\nbnVsbDsKICAgIHByaXZhdGUgRmlsZSBfZmlsZSA9IG51bGw7CiAgICBwcml2\nYXRlIFdyaXRlciBfd3JpdGVyID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVh\nbiBfZmx1c2ggPSBmYWxzZTsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9y\nLiBTdXBwbHkgY29uZmlndXJhdGlvbiBhbmQgYWN0aW9uLgogICAgICovCiAg\nICBwdWJsaWMgTWV0YURhdGFUb29sKE9wZW5KUEFDb25maWd1cmF0aW9uIGNv\nbmYsIFN0cmluZyBhY3Rpb24pIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAg\nICAgICAgX2FjdGlvbiA9IChhY3Rpb24gPT0gbnVsbCkgPyBBQ1RJT05fQURE\nIDogYWN0aW9uOwoKICAgICAgICBpZiAoQUNUSU9OX0RST1AuZXF1YWxzKF9h\nY3Rpb24pKQogICAgICAgICAgICBfZHJvcCA9IG5ldyBIYXNoU2V0KCk7CiAg\nICAgICAgZWxzZQogICAgICAgICAgICBfZHJvcCA9IG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgYWN0aW9uIHN1cHBsaWVkIG9uIGNvbnN0cnVj\ndGlvbi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRBY3Rpb24oKSB7\nCiAgICAgICAgcmV0dXJuIF9hY3Rpb247CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgZmlsZSB0byBnZW5lcmF0ZSBtZXRhZGF0YSB0by4KICAgICAqLwog\nICAgcHVibGljIEZpbGUgZ2V0RmlsZSgpIHsKICAgICAgICByZXR1cm4gX2Zp\nbGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmlsZSB0byBnZW5lcmF0\nZSBtZXRhZGF0YSB0by4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Rmls\nZShGaWxlIGZpbGUpIHsKICAgICAgICBfZmlsZSA9IGZpbGU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgd3JpdGVyIHRvIGdlbmVyYXRlIG1ldGFkYXRh\nIHRvLgogICAgICovCiAgICBwdWJsaWMgV3JpdGVyIGdldFdyaXRlcigpIHsK\nICAgICAgICByZXR1cm4gX3dyaXRlcjsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSB3cml0ZXIgdG8gZ2VuZXJhdGUgbWV0YWRhdGEgdG8uCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldFdyaXRlcihXcml0ZXIgd3JpdGVyKSB7CiAg\nICAgICAgX3dyaXRlciA9IHdyaXRlcjsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSByZXBvc2l0b3J5IHRvIHVzZSB0byBob2xkIG1ldGFkYXRhLgogICAg\nICovCiAgICBwdWJsaWMgTWV0YURhdGFSZXBvc2l0b3J5IGdldFJlcG9zaXRv\ncnkoKSB7CiAgICAgICAgaWYgKF9yZXBvcyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIF9yZXBvcyA9IG5ld1JlcG9zaXRvcnkoKTsKICAgICAgICAgICAgX3Jl\ncG9zLnNldFJlc29sdmUoTU9ERV9NQVBQSU5HLCBmYWxzZSk7CiAgICAgICAg\nICAgIE1ldGFEYXRhRmFjdG9yeSBmYWN0b3J5ID0gX3JlcG9zLmdldE1ldGFE\nYXRhRmFjdG9yeSgpOwogICAgICAgICAgICBmYWN0b3J5LmdldERlZmF1bHRz\nKCkuc2V0SWdub3JlTm9uUGVyc2lzdGVudChmYWxzZSk7CiAgICAgICAgICAg\nIGZhY3Rvcnkuc2V0U3RvcmVNb2RlKE1ldGFEYXRhRmFjdG9yeS5TVE9SRV9W\nRVJCT1NFKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZXBvczsKICAg\nIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBtZXRhZGF0YSByZXBv\nc2l0b3J5LgogICAgICovCiAgICBwcm90ZWN0ZWQgTWV0YURhdGFSZXBvc2l0\nb3J5IG5ld1JlcG9zaXRvcnkoKSB7CiAgICAgICAgcmV0dXJuIF9jb25mLm5l\nd01ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgcmVwb3NpdG9yeSB0byB1c2UgdG8gaG9sZCBtZXRhZGF0\nYS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVwb3NpdG9yeShNZXRh\nRGF0YVJlcG9zaXRvcnkgcmVwb3MpIHsKICAgICAgICBfcmVwb3MgPSByZXBv\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc2V0IHN0YXRlLiBUaGlzIGlz\nIGNhbGxlZCBhdXRvbWF0aWNhbGx5IGFmdGVyIGV2ZXJ5IHtAbGluayAjcmVj\nb3JkfS4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAg\nICAgX3JlcG9zID0gbnVsbDsKICAgICAgICBpZiAoX2Ryb3AgIT0gbnVsbCkK\nICAgICAgICAgICAgX2Ryb3AuY2xlYXIoKTsKICAgICAgICBfZmx1c2ggPSBm\nYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIEdlbmVyYXRlIG5ldyBtZXRh\nZGF0YSBmb3IgdGhlIGdpdmVuIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBydW4oQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKEFDVElPTl9EUk9Q\nLmVxdWFscyhfYWN0aW9uKSkKICAgICAgICAgICAgX2Ryb3AuYWRkKGNscyk7\nCiAgICAgICAgZWxzZSBpZiAoQUNUSU9OX0FERC5lcXVhbHMoX2FjdGlvbikp\nCiAgICAgICAgICAgIGFkZChjbHMpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiYWN0aW9u\nID09ICIgKyBfYWN0aW9uKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRk\nKENsYXNzIGNscykgewogICAgICAgIC8vIGFzc3VtZSBhbGwgdXNlci1kZWZp\nbmVkIHR5cGVzIGFyZSBQQ3MKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEg\nPSBnZXRSZXBvc2l0b3J5KCkuYWRkTWV0YURhdGEoY2xzKTsKICAgICAgICBG\naWVsZE1ldGFEYXRhW10gZm1kcyA9IG1ldGEuZ2V0RGVjbGFyZWRGaWVsZHMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKGZtZHNbaV0uZ2V0RGVjbGFyZWRUeXBl\nQ29kZSgpID09IEphdmFUeXBlcy5PQkpFQ1QKICAgICAgICAgICAgICAgICYm\nIGZtZHNbaV0uZ2V0RGVjbGFyZWRUeXBlKCkgIT0gT2JqZWN0LmNsYXNzKQog\nICAgICAgICAgICAgICAgZm1kc1tpXS5zZXREZWNsYXJlZFR5cGVDb2RlKEph\ndmFUeXBlcy5QQyk7CiAgICAgICAgfQogICAgICAgIG1ldGEuc2V0U291cmNl\nKF9maWxlLCBtZXRhLmdldFNvdXJjZVR5cGUoKSk7CiAgICAgICAgX2ZsdXNo\nID0gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlY29yZCBtZXRhZGF0\nYSBjaGFuZ2VzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCByZWNvcmQoKSB7\nCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3Np\ndG9yeSgpOwogICAgICAgIE1ldGFEYXRhRmFjdG9yeSBtZGYgPSByZXBvcy5n\nZXRNZXRhRGF0YUZhY3RvcnkoKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoX2Ryb3AgIT0gbnVsbCAmJiAhX2Ryb3AuaXNFbXB0eSgpCiAgICAg\nICAgICAgICAgICAmJiAhbWRmLmRyb3AoKENsYXNzW10pIF9kcm9wLnRvQXJy\nYXkobmV3IENsYXNzW19kcm9wLnNpemUoKV0pLAogICAgICAgICAgICAgICAg\nTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HIHwgTU9ERV9RVUVSWSwgbnVsbCkp\nIHsKICAgICAgICAgICAgICAgIExvZyBsb2cgPSBfY29uZi5nZXRMb2coT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKTsKICAgICAgICAgICAg\nICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJiYWQtZHJvcCIsIF9kcm9wKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFfZmx1c2gpCiAgICAgICAg\nICAgICAgICByZXR1cm47CgogICAgICAgICAgICBDbGFzc01ldGFEYXRhW10g\nbWV0YXMgPSByZXBvcy5nZXRNZXRhRGF0YXMoKTsKICAgICAgICAgICAgTWFw\nIG91dHB1dCA9IG51bGw7CgogICAgICAgICAgICAvLyBpZiB3ZSdyZSBvdXRw\ndXR0aW5nIHRvIHN0cmVhbSwgc2V0IGFsbCBtZXRhcyB0byBzYW1lIGZpbGUg\nc28KICAgICAgICAgICAgLy8gdGhleSBnZXQgcGxhY2VkIGluIHNpbmdsZSBz\ndHJpbmcKICAgICAgICAgICAgaWYgKF93cml0ZXIgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgb3V0cHV0ID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAg\nICAgICAgIEZpbGUgdG1wID0gbmV3IEZpbGUoIm9wZW5qcGF0bXAiKTsKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgICAgICAgICAgbWV0YXNbaV0uc2V0U291cmNl\nKHRtcCwgbWV0YXNbaV0uZ2V0U291cmNlVHlwZSgpKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBpZiAoIW1kZi5zdG9yZShtZXRhcywgbmV3IFF1ZXJ5\nTWV0YURhdGFbMF0sCiAgICAgICAgICAgICAgICBuZXcgU2VxdWVuY2VNZXRh\nRGF0YVswXSwgTU9ERV9NRVRBLCBvdXRwdXQpKQogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc3Rv\ncmUiKSk7CiAgICAgICAgICAgIGlmIChfd3JpdGVyICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIFByaW50V3JpdGVyIG91dCA9IG5ldyBQcmludFdyaXRl\ncihfd3JpdGVyKTsKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gb3V0cHV0LnZhbHVlcygpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAg\nICAgICAgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgICAgICAgICAgb3V0\nLnByaW50bG4oKFN0cmluZykgaXRyLm5leHQoKSk7CiAgICAgICAgICAgICAg\nICBvdXQuZmx1c2goKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICBmaW5hbGx5IHsKICAgICAgICAgICAgY2xlYXIoKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5NZXRhRGF0YVRvb2wgW29wdGlvbl0qCiAgICAgKiBbLWFj\ndGlvbi8tYSAmbHQ7YWRkIHwgZHJvcCZndDtdCiAgICAgKiAmbHQ7Y2xhc3Mg\nbmFtZSB8IC5qYXZhIGZpbGUgfCAuY2xhc3MgZmlsZSZndDsrCiAgICAgKiAg\nV2hlcmUgdGhlIGZvbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgog\nICAgICogPHVsPgogICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtw\ncm9wZXJ0aWVzIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlIHBhdGgK\nICAgICAqIG9yIHJlc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRp\nZXMgZmlsZSBjb250YWluaW5nIGluZm9ybWF0aW9uCiAgICAgKiBhcyBvdXRs\naW5lZCBpbiB7QGxpbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25h\nbC48L2xpPgogICAgICogPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsg\nJmx0O3Byb3BlcnR5IHZhbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBw\ncm9wZXJ0aWVzIG9mIHRoZSBPcGVuSlBBIHtAbGluayBPcGVuSlBBQ29uZmln\ndXJhdGlvbn0gY2FuIGJlIHNldCBieQogICAgICogdXNpbmcgdGhlaXIgbmFt\nZXMgYW5kIHN1cHBseWluZyBhIHZhbHVlLjwvbGk+CiAgICAgKiA8bGk+PGk+\nLWZpbGUvLWYgJmx0O3N0ZG91dCB8IG91dHB1dCBmaWxlIG9yIHJlc291cmNl\nJmd0OzwvaT46IFRoZSBwYXRoCiAgICAgKiBvciByZXNvdXJjZSBuYW1lIG9m\nIGEgZmlsZSB0aGUgbWV0YWRhdGEgc2hvdWxkIGJlIGdlbmVyYXRlZCB0by4K\nICAgICAqIElmIHRoZSBnaXZlbiBmaWxlIGFscmVhZHkgY29udGFpbnMgbWV0\nYWRhdGEsIHRoZSBnZW5lcmF0ZWQKICAgICAqIG1ldGFkYXRhIHdpbGwgYmUg\nbWVyZ2VkIGludG8gdGhlIGV4aXN0aW5nIGRvY3VtZW50LjwvbGk+CiAgICAg\nKiA8L3VsPgogICAgICogIFRoZSBhdmFpbGFibGUgYWN0aW9ucyBhcmU6CiAg\nICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+YWRkPC9pPjogR2VuZXJhdGUgZGVm\nYXVsdCBtZXRhZGF0YSBmb3IgdGhlIGdpdmVuIGNsYXNzZXMuIFRoaXMKICAg\nICAqIGlzIHRoZSBkZWZhdWx0IGFjdGlvbi48L2xpPgogICAgICogPGxpPjxp\nPmRyb3A8L2k+OiBSZW1vdmUgZXhpc3RpbmcgbWV0YWRhdGEgZm9yIHRoZSBn\naXZlbiBjbGFzc2VzLjwvbGk+CiAgICAgKiA8L3VsPgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKQogICAgICAg\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgT3B0aW9ucyBvcHRzID0g\nbmV3IE9wdGlvbnMoKTsKICAgICAgICBhcmdzID0gb3B0cy5zZXRGcm9tQ21k\nTGluZShhcmdzKTsKICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25m\nID0gbmV3IE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCgpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGlmICghcnVuKGNvbmYsIGFyZ3MsIG9wdHMpKQog\nICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKF9sb2MuZ2V0KCJ0\nb29sLXVzYWdlIikpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIGNvbmYuY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSdW4gdGhlIHRvb2wuIFJldHVybnMgZmFsc2UgaWYgYW55IGludmFsaWQg\nb3B0aW9ucyB3ZXJlIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGJvb2xlYW4gcnVuKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYsIFN0cmlu\nZ1tdIGFyZ3MsCiAgICAgICAgT3B0aW9ucyBvcHRzKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDAg\nfHwgb3B0cy5jb250YWluc0tleSgiaGVscCIpCiAgICAgICAgICAgIHx8IG9w\ndHMuY29udGFpbnNLZXkoIi1oZWxwIikpCiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKCiAgICAgICAgRmxhZ3MgZmxhZ3MgPSBuZXcgRmxhZ3MoKTsKICAg\nICAgICBmbGFncy5hY3Rpb24gPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJhY3Rp\nb24iLCAiYSIsIGZsYWdzLmFjdGlvbik7CiAgICAgICAgU3RyaW5nIGZpbGVO\nYW1lID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgiZmlsZSIsICJmIiwgbnVsbCk7\nCiAgICAgICAgaWYgKCJzdGRvdXQiLmVxdWFscyhmaWxlTmFtZSkpIHsKICAg\nICAgICAgICAgZmxhZ3Mud3JpdGVyID0gbmV3IFByaW50V3JpdGVyKFN5c3Rl\nbS5vdXQpOwogICAgICAgICAgICBmaWxlTmFtZSA9IG51bGw7CiAgICAgICAg\nfSBlbHNlIGlmICgic3RkZXJyIi5lcXVhbHMoZmlsZU5hbWUpKSB7CiAgICAg\nICAgICAgIGZsYWdzLndyaXRlciA9IG5ldyBQcmludFdyaXRlcihTeXN0ZW0u\nZXJyKTsKICAgICAgICAgICAgZmlsZU5hbWUgPSBudWxsOwogICAgICAgIH0K\nCiAgICAgICAgQ29uZmlndXJhdGlvbnMucG9wdWxhdGVDb25maWd1cmF0aW9u\nKGNvbmYsIG9wdHMpOwogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IGNv\nbmYuZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAgICAgIGdl\ndENsYXNzTG9hZGVyKE1ldGFEYXRhVG9vbC5jbGFzcywgbnVsbCk7CgogICAg\nICAgIGlmIChmaWxlTmFtZSAhPSBudWxsKQogICAgICAgICAgICBmbGFncy5m\naWxlID0gRmlsZXMuZ2V0RmlsZShmaWxlTmFtZSwgbG9hZGVyKTsKICAgICAg\nICByZXR1cm4gcnVuKGNvbmYsIGFyZ3MsIGZsYWdzLCBudWxsLCBsb2FkZXIp\nOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIHRoZSB0b29sLiBSZXR1cm4g\nZmFsc2UgaWYgaW52YWxpZCBvcHRpb25zIHdlcmUgZ2l2ZW4uIFRoZSBnaXZl\nbgogICAgICogcmVwb3NpdG9yeSBtYXkgYmUgbnVsbC4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihPcGVuSlBBQ29uZmlndXJhdGlv\nbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIEZsYWdzIGZsYWdzLCBN\nZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MsIENsYXNzTG9hZGVyIGxvYWRlcikK\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChhcmdz\nLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgaWYgKGZsYWdzLmFjdGlvbiA9PSBudWxsKQogICAgICAgICAgICBmbGFn\ncy5hY3Rpb24gPSBBQ1RJT05fQUREOwoKICAgICAgICBNZXRhRGF0YVRvb2wg\ndG9vbCA9IG5ldyBNZXRhRGF0YVRvb2woY29uZiwgZmxhZ3MuYWN0aW9uKTsK\nICAgICAgICBpZiAocmVwb3MgIT0gbnVsbCkgewogICAgICAgICAgICBNZXRh\nRGF0YUZhY3RvcnkgZmFjdG9yeSA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9y\neSgpOwogICAgICAgICAgICBmYWN0b3J5LmdldERlZmF1bHRzKCkuc2V0SWdu\nb3JlTm9uUGVyc2lzdGVudChmYWxzZSk7CiAgICAgICAgICAgIGZhY3Rvcnku\nc2V0U3RvcmVNb2RlKE1ldGFEYXRhRmFjdG9yeS5TVE9SRV9WRVJCT1NFKTsK\nICAgICAgICAgICAgdG9vbC5zZXRSZXBvc2l0b3J5KHJlcG9zKTsKICAgICAg\nICB9CiAgICAgICAgaWYgKGZsYWdzLmZpbGUgIT0gbnVsbCkKICAgICAgICAg\nICAgdG9vbC5zZXRGaWxlKGZsYWdzLmZpbGUpOwogICAgICAgIGlmIChmbGFn\ncy53cml0ZXIgIT0gbnVsbCkKICAgICAgICAgICAgdG9vbC5zZXRXcml0ZXIo\nZmxhZ3Mud3JpdGVyKTsKCiAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9n\nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19UT09MKTsKICAgICAgICBDbGFz\nc0FyZ1BhcnNlciBjYXAgPSBjb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkuCiAgICAgICAgICAgIGdldE1ldGFEYXRhRmFjdG9yeSgpLm5l\nd0NsYXNzQXJnUGFyc2VyKCk7CiAgICAgICAgY2FwLnNldENsYXNzTG9hZGVy\nKGxvYWRlcik7CiAgICAgICAgQ2xhc3NbXSBjbGFzc2VzOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICBjbGFzc2VzID0gY2FwLnBhcnNlVHlwZXMoYXJnc1tpXSk7CiAgICAg\nICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgY2xhc3Nlcy5sZW5ndGg7IGor\nKykgewogICAgICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoInRvb2wt\ncnVubmluZyIsIGNsYXNzZXNbal0sIGZsYWdzLmFjdGlvbikpOwogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB0b29sLnJ1bihj\nbGFzc2VzW2pdKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbiBpYWUpIHsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0b29sLXJl\nY29yZCIpKTsKICAgICAgICB0b29sLnJlY29yZCgpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIGZsYWdzLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIEZsYWdzIHsKCiAgICAgICAg\ncHVibGljIFN0cmluZyBhY3Rpb24gPSBBQ1RJT05fQUREOwogICAgICAgIHB1\nYmxpYyBGaWxlIGZpbGUgPSBudWxsOwoJCXB1YmxpYyBXcml0ZXIgd3JpdGVy\nID0gbnVsbDsKCX0KfQo=\n","encoding":"base64"}

