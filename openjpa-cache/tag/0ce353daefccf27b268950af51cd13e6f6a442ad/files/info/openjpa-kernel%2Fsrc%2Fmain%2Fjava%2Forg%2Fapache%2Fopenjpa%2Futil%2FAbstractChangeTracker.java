{"sha":"9c4083fa77f81b92153bd5867470b7126fadf211","node_id":"MDQ6QmxvYjIwNjM2NDo5YzQwODNmYTc3ZjgxYjkyMTUzYmQ1ODY3NDcwYjcxMjZmYWRmMjEx","size":5999,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9c4083fa77f81b92153bd5867470b7126fadf211","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGls\nLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5tYXAuSWRlbnRpdHlNYXA7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuc2V0Lk1hcEJh\nY2tlZFNldDsKCi8qKgogKiBCYXNlIGNsYXNzIHRoYXQgcHJvdmlkZXMgdXRp\nbGl0aWVzIHRvIGNoYW5nZSB0cmFja2Vycy4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGFic3RyYWN0IGNsYXNz\nIEFic3RyYWN0Q2hhbmdlVHJhY2tlcgogICAgaW1wbGVtZW50cyBDaGFuZ2VU\ncmFja2VyIHsKCiAgICAvKioKICAgICAqIENvbGxlY3Rpb24gb2YgYWRkZWQg\naXRlbXMuIE1heSBiZSBudWxsLgogICAgICovCiAgICBwcm90ZWN0ZWQgQ29s\nbGVjdGlvbiBhZGQgPSBudWxsOwoKICAgIC8qKgogICAgICogQ29sbGVjdGlv\nbiBvZiByZW1vdmVkIGl0ZW1zLiBNYXkgYmUgbnVsbC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIENvbGxlY3Rpb24gcmVtID0gbnVsbDsKCiAgICAvKioKICAg\nICAqIENvbGxlY3Rpb24gb2YgY2hhbmdlZCBpdGVtcy4gTWF5IGJlIG51bGwu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBDb2xsZWN0aW9uIGNoYW5nZSA9IG51\nbGw7CgogICAgcHJpdmF0ZSBib29sZWFuIF9hdXRvT2ZmID0gdHJ1ZTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfdHJhY2sgPSBmYWxzZTsKICAgIHByaXZhdGUg\nQm9vbGVhbiBfaWRlbnRpdHkgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX3Nl\ncSA9IC0xOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBj\nb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgQWJzdHJhY3RDaGFu\nZ2VUcmFja2VyKCkgewogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\nbyBhdXRvbWF0aWNhbGx5IHN0b3AgdHJhY2tpbmcgd2hlbiB0aGUgbnVtYmVy\nIG9mIGNoYW5nZXMKICAgICAqIGV4Y2VlZHMgdGhlIGNvbnRhaW5lciBzaXpl\nLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBnZXRBdXRvT2ZmKCkgewogICAgICAgIHJldHVybiBfYXV0b09mZjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gYXV0b21hdGljYWxseSBz\ndG9wIHRyYWNraW5nIHdoZW4gdGhlIG51bWJlciBvZiBjaGFuZ2VzCiAgICAg\nKiBleGNlZWRzIHRoZSBjb250YWluZXIgc2l6ZS4gRGVmYXVsdHMgdG8gdHJ1\nZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QXV0b09mZihib29sZWFu\nIGF1dG9PZmYpIHsKICAgICAgICBfYXV0b09mZiA9IGF1dG9PZmY7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gaXNUcmFja2luZygpIHsKICAgICAgICBy\nZXR1cm4gX3RyYWNrOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0VHJh\nY2tpbmcoKSB7CiAgICAgICAgX3RyYWNrID0gdHJ1ZTsKICAgICAgICBpZiAo\nX3NlcSA9PSAtMSkKICAgICAgICAgICAgX3NlcSA9IGluaXRpYWxTZXF1ZW5j\nZSgpOwogICAgICAgIHJlc2V0KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGluaXRpYWwgc2VxdWVuY2UgdmFsdWUgZm9yIHRoaXMgcHJv\neHkuIFR5cGljYWxseSB0aGlzIGlzCiAgICAgKiB0aGUgY29udGFpbmVyIHNp\nemUuIEFzc3VtZXMgYW4gdW5vcmRlcmVkIGNvbGxlY3Rpb24gYnkgZGVmYXVs\ndCwKICAgICAqIHJldHVybmluZyAwLgogICAgICovCiAgICBwcm90ZWN0ZWQg\naW50IGluaXRpYWxTZXF1ZW5jZSgpIHsKICAgICAgICByZXR1cm4gMDsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzdG9wVHJhY2tpbmcoKSB7CiAgICAgICAg\nX3RyYWNrID0gZmFsc2U7CiAgICAgICAgX3NlcSA9IC0xOwogICAgICAgIHJl\nc2V0KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNldCB0aGUgc3RhdGUg\nb2YgdGhlIHRyYWNrZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHJl\nc2V0KCkgewogICAgICAgIGlmIChhZGQgIT0gbnVsbCkKICAgICAgICAgICAg\nYWRkLmNsZWFyKCk7CiAgICAgICAgaWYgKHJlbSAhPSBudWxsKQogICAgICAg\nICAgICByZW0uY2xlYXIoKTsKICAgICAgICBpZiAoY2hhbmdlICE9IG51bGwp\nCiAgICAgICAgICAgIGNoYW5nZS5jbGVhcigpOwogICAgICAgIF9pZGVudGl0\neSA9IG51bGw7CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0QWRk\nZWQoKSB7CiAgICAgICAgcmV0dXJuIChhZGQgPT0gbnVsbCkgPyBDb2xsZWN0\naW9ucy5FTVBUWV9MSVNUIDogYWRkOwogICAgfQoKICAgIHB1YmxpYyBDb2xs\nZWN0aW9uIGdldFJlbW92ZWQoKSB7CiAgICAgICAgcmV0dXJuIChyZW0gPT0g\nbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUIDogcmVtOwogICAgfQoK\nICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldENoYW5nZWQoKSB7CiAgICAgICAg\ncmV0dXJuIChjaGFuZ2UgPT0gbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBUWV9M\nSVNUIDogY2hhbmdlOwogICAgfQoKICAgIC8qKgogICAgICogTm90aWZ5IHRo\nZSB0cmFja2VyIHRoYXQgdGhlIGdpdmVuIG9iamVjdCB3YXMgYWRkZWQuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZGVkKE9iamVjdCB2YWwpIHsK\nICAgICAgICBpZiAoIV90cmFjaykKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIHNldElkZW50aXR5KHZhbCk7CiAgICAgICAgYWRkKHZhbCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBNYXJrIHRoZSBnaXZlbiB2YWx1ZSBhcyBhZGRl\nZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IHZvaWQgYWRkKE9i\namVjdCB2YWwpOwoKICAgIC8qKgogICAgICogTm90aWZ5IHRoZSB0cmFja2Vy\nIHRoYXQgdGhlIGdpdmVuIG9iamVjdCB3YXMgcmVtb3ZlZC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcmVtb3ZlZChPYmplY3QgdmFsKSB7CiAgICAg\nICAgaWYgKCFfdHJhY2spCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBz\nZXRJZGVudGl0eSh2YWwpOwogICAgICAgIHJlbW92ZSh2YWwpOwogICAgfQoK\nICAgIC8qKgogICAgICogTWFyayB0aGUgZ2l2ZW4gdmFsdWUgYXMgcmVtb3Zl\nZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IHZvaWQgcmVtb3Zl\nKE9iamVjdCB2YWwpOwoKICAgIC8qKgogICAgICogTm90aWZ5IHRoZSB0cmFj\na2VyIHRoYXQgdGhlIGdpdmVuIG9iamVjdCB3YXMgY2hhbmdlZC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgY2hhbmdlZChPYmplY3QgdmFsKSB7CiAg\nICAgICAgaWYgKCFfdHJhY2spCiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICBzZXRJZGVudGl0eSh2YWwpOwogICAgICAgIGNoYW5nZSh2YWwpOwogICAg\nfQoKICAgIC8qKgogICAgICogTWFyayB0aGUgZ2l2ZW4gdmFsdWUgYXMgY2hh\nbmdlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IHZvaWQgY2hh\nbmdlKE9iamVjdCB2YWwpOwoKICAgIHB1YmxpYyBpbnQgZ2V0TmV4dFNlcXVl\nbmNlKCkgewogICAgICAgIHJldHVybiBfc2VxOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldE5leHRTZXF1ZW5jZShpbnQgc2VxKSB7CiAgICAgICAgX3Nl\ncSA9IHNlcTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBz\nZXQgZm9yIHN0b3JpbmcgYWRkcy9yZW1vdmVzL2NoYW5nZXMuIFRha2VzIGlu\ndG8gYWNjb3VudAogICAgICogd2hldGhlciB3ZSBuZWVkIHRvIHVzZSBhbiBp\nZGVudGl0eSBzZXQgb3Igc3RhbmRhcmQgc2V0LgogICAgICovCiAgICBwcm90\nZWN0ZWQgU2V0IG5ld1NldCgpIHsKICAgICAgICBpZiAoX2lkZW50aXR5ID09\nIEJvb2xlYW4uVFJVRSkKICAgICAgICAgICAgcmV0dXJuIE1hcEJhY2tlZFNl\ndC5kZWNvcmF0ZShuZXcgSWRlbnRpdHlNYXAoKSk7CiAgICAgICAgcmV0dXJu\nIG5ldyBIYXNoU2V0KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hl\ndGhlciB0byB1c2UgaWRlbnRpdHktYmFzZWQgZGF0YXN0cnVjdHVyZXMsIGFu\nZCBzd2l0Y2ggb3VyIGN1cnJlbnQKICAgICAqIGRhdGFzdHJ1Y3R1cmVzIGFw\ncHJvcHJpYXRlbHkgaWYgbmVlZGVkLiBXZSB1c2UgaWRlbnRpdHkgc3RydWN0\ndXJlcyBmb3IKICAgICAqIFBDIHR5cGVzIGluIGNhc2UgdGhlIHVzZXIgaGFz\nIGNvZGVkIHRoZW0gc3VjaCB0aGF0IHR3byBvYmplY3RzIHdpdGgKICAgICAq\nIGRpZmZlcmVudCBpZGVudGl0aWVzIGNhbiBjb21wYXJlIGVxdWFscygpLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgc2V0SWRlbnRpdHkoT2JqZWN0IHZh\nbCkgewogICAgICAgIGlmICh2YWwgPT0gbnVsbCB8fCBfaWRlbnRpdHkgIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBpZiAoSW1wbEhl\nbHBlci5pc01hbmFnZWRUeXBlKHZhbC5nZXRDbGFzcygpKSkKICAgICAgICAg\nICAgX2lkZW50aXR5ID0gQm9vbGVhbi5UUlVFOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgX2lkZW50aXR5ID0gQm9vbGVhbi5GQUxTRTsKCiAgICAgICAg\nYWRkID0gc3dpdGNoU3RydWN0dXJlKGFkZCwgX2lkZW50aXR5LmJvb2xlYW5W\nYWx1ZSgpKTsKICAgICAgICByZW0gPSBzd2l0Y2hTdHJ1Y3R1cmUocmVtLCBf\naWRlbnRpdHkuYm9vbGVhblZhbHVlKCkpOwogICAgICAgIGNoYW5nZSA9IHN3\naXRjaFN0cnVjdHVyZShjaGFuZ2UsIF9pZGVudGl0eS5ib29sZWFuVmFsdWUo\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTd2l0Y2ggZnJvbSBhbiBpZGVu\ndGl0eSBzdHJ1Y3R1cmUgdG8gYSBzdGFuZGFyZCBvbmUsIG9yIHZpY2UgdmVy\nc2EuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENvbGxlY3Rpb24gc3dp\ndGNoU3RydWN0dXJlKENvbGxlY3Rpb24gY3VyLAogICAgICAgIGJvb2xlYW4g\naWRlbnRpdHkpIHsKICAgICAgICBpZiAoY3VyID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChpZGVudGl0eSAmJiBjdXIg\naW5zdGFuY2VvZiBIYXNoU2V0KSB7CiAgICAgICAgICAgIGlmIChjdXIuaXNF\nbXB0eSgpKQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\nICAgIFNldCByZXBsYWNlID0gTWFwQmFja2VkU2V0LmRlY29yYXRlKG5ldyBJ\nZGVudGl0eU1hcCgpKTsKICAgICAgICAgICAgcmVwbGFjZS5hZGRBbGwoY3Vy\nKTsKICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2U7CiAgICAgICAgfQogICAg\nICAgIGlmICghaWRlbnRpdHkgJiYgIShjdXIgaW5zdGFuY2VvZiBIYXNoU2V0\nKSAmJiBjdXIgaW5zdGFuY2VvZiBTZXQpIHsKICAgICAgICAgICAgaWYgKGN1\nci5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICAgICAgcmV0dXJuIG5ldyBIYXNoU2V0IChjdXIpOwoJCX0KCQlyZXR1\ncm4gY3VyOwoJfQp9Cgo=\n","encoding":"base64"}

