{"sha":"b84ce7320b2e081d60057f4edab8077a86c2b573","node_id":"MDQ6QmxvYjIwNjM2NDpiODRjZTczMjBiMmUwODFkNjAwNTdmNGVkYWI4MDc3YTg2YzJiNTcz","size":11709,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b84ce7320b2e081d60057f4edab8077a86c2b573","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGph\ndmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTm9T\ndWNoRWxlbWVudEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5TZXQ7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLlByZWRpY2F0\nZTsKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5pdGVy\nYXRvcnMuRmlsdGVySXRlcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMuY29sbGVjdGlvbnMuaXRlcmF0b3JzLkl0ZXJhdG9yQ2hhaW47CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0\nYXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5DbG9zZWFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwoKLyoqCiAqIEEgY29sbGVjdGlvbiBwcm94eSBkZXNp\nZ25lZCBmb3IgY29sbGVjdGlvbnMgYmFja2VkIGJ5IGV4dHJlbWVseSBsYXJn\nZQogKiByZXN1bHQgc2V0cyBpbiB3aGljaCBlYWNoIGNhbGwgdG8ge0BsaW5r\nICNpdGVyYXRvcn0gbWF5IHBlcmZvcm0gYSBkYXRhYmFzZQogKiBxdWVyeS4g\nQ2hhbmdlcyB0byB0aGUgY29sbGVjdGlvbiBhcmUgdHJhY2tlZCB0aHJvdWdo\nIGEKICoge0BsaW5rIENoYW5nZVRyYWNrZXJ9LiBUaGlzIGNvbGxlY3Rpb24g\naGFzIHRoZSBmb2xsb3dpbmcgbGltaXRhdGlvbnM6CiAqIDx1bD4KICogPGxp\nPlRoZSA8Y29kZT5zaXplPC9jb2RlPiBtZXRob2QgbWF5IHJldHVybiB7QGxp\nbmsgSW50ZWdlciNNQVhfVkFMVUV9LjwvbGk+CiAqIDxsaT5UaGUgY29sbGVj\ndGlvbiBjYW5ub3QgY29udGFpbiBkdXBsaWNhdGUgZWxlbWVudHMuPC9saT4K\nICogPC91bD4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBh\nYnN0cmFjdCBjbGFzcyBBYnN0cmFjdExSU1Byb3h5Q29sbGVjdGlvbgogICAg\naW1wbGVtZW50cyBTZXQsIExSU1Byb3h5LCBQcmVkaWNhdGUsIENvbGxlY3Rp\nb25DaGFuZ2VUcmFja2VyIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBM\nb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAg\nKEFic3RyYWN0TFJTUHJveHlDb2xsZWN0aW9uLmNsYXNzKTsKCiAgICBwcml2\nYXRlIENsYXNzIF9lbGVtZW50VHlwZSA9IG51bGw7CiAgICBwcml2YXRlIENv\nbGxlY3Rpb25DaGFuZ2VUcmFja2VySW1wbCBfY3QgPSBudWxsOwogICAgcHJp\ndmF0ZSBPcGVuSlBBU3RhdGVNYW5hZ2VyIF9zbSA9IG51bGw7CiAgICBwcml2\nYXRlIGludCBfZmllbGQgPSAtMTsKICAgIHByaXZhdGUgT3BlbkpQQVN0YXRl\nTWFuYWdlciBfb3JpZ093bmVyID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9v\ncmlnRmllbGQgPSAtMTsKICAgIHByaXZhdGUgaW50IF9jb3VudCA9IC0xOwog\nICAgcHJpdmF0ZSBib29sZWFuIF9pdGVyYXRlZCA9IGZhbHNlOwoKICAgIC8q\nKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIGVs\nZW1lbnRUeXBlIHRoZSBhbGxvd2VkIHR5cGUgb2YgZWxlbWVudHMsIG9yIG51\nbGwgZm9yIG5vCiAgICAgKiByZXN0cmljdGlvbnMKICAgICAqIEBwYXJhbSBv\ncmRlcmVkIHRydWUgaWYgdGhpcyBjb2xsZWN0aW9uIGlzIG9yZGVyZWQKICAg\nICAqLwogICAgcHVibGljIEFic3RyYWN0TFJTUHJveHlDb2xsZWN0aW9uKENs\nYXNzIGVsZW1lbnRUeXBlLCBib29sZWFuIG9yZGVyZWQsCiAgICAgICAgT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9lbGVtZW50VHlw\nZSA9IGVsZW1lbnRUeXBlOwogICAgICAgIF9jdCA9IG5ldyBDb2xsZWN0aW9u\nQ2hhbmdlVHJhY2tlckltcGwodGhpcywgZmFsc2UsIG9yZGVyZWQsIGNvbmYp\nOwogICAgICAgIF9jdC5zZXRBdXRvT2ZmKGZhbHNlKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRPd25lcihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBp\nbnQgZmllbGQpIHsKICAgICAgICAvLyBjYW4ndCB0cmFuc2ZlciBvd25lcnNo\naXAgb2YgYW4gbHJzIHByb3h5CiAgICAgICAgaWYgKHNtICE9IG51bGwgJiYg\nX29yaWdPd25lciAhPSBudWxsCiAgICAgICAgICAgICYmIChfb3JpZ093bmVy\nICE9IHNtIHx8IF9vcmlnRmllbGQgIT0gZmllbGQpKSB7CiAgICAgICAgICAg\nIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoInRy\nYW5zZmVyLWxycyIsCiAgICAgICAgICAgICAgICBfb3JpZ093bmVyLmdldE1l\ndGFEYXRhKCkuZ2V0RmllbGQoX29yaWdGaWVsZCkpKTsKICAgICAgICB9Cgog\nICAgICAgIF9zbSA9IHNtOwogICAgICAgIF9maWVsZCA9IGZpZWxkOwoKICAg\nICAgICAvLyBrZWVwIHRyYWNrIG9mIG9yaWdpbmFsIG93bmVyIHNvIHdlIGNh\nbiBkZXRlY3QgdHJhbnNmZXIgYXR0ZW1wdHMKICAgICAgICBpZiAoc20gIT0g\nbnVsbCkgewogICAgICAgICAgICBfb3JpZ093bmVyID0gc207CiAgICAgICAg\nICAgIF9vcmlnRmllbGQgPSBmaWVsZDsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIE9wZW5KUEFTdGF0ZU1hbmFnZXIgZ2V0T3duZXIoKSB7CiAgICAg\nICAgcmV0dXJuIF9zbTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldE93bmVy\nRmllbGQoKSB7CiAgICAgICAgcmV0dXJuIF9maWVsZDsKICAgIH0KCiAgICBw\ndWJsaWMgQ2hhbmdlVHJhY2tlciBnZXRDaGFuZ2VUcmFja2VyKCkgewogICAg\nICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgY29w\neShPYmplY3Qgb3JpZykgewogICAgICAgIC8vIHVzZWQgdG8gc3RvcmUgZmll\nbGRzIGZvciByb2xsYmFjazsgd2UgZG9uJ3Qgc3RvcmUgbHJzIGZpZWxkcwog\nICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGFkZChPYmplY3QgbykgewogICAgICAgIFByb3hpZXMuYXNzZXJ0QWxsb3dl\nZFR5cGUobywgX2VsZW1lbnRUeXBlKTsKICAgICAgICBQcm94aWVzLmRpcnR5\nKHRoaXMpOwogICAgICAgIF9jdC5hZGRlZChvKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBhZGRBbGwoQ29sbGVj\ndGlvbiBhbGwpIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwogICAg\nICAgIGJvb2xlYW4gYWRkZWQgPSBmYWxzZTsKICAgICAgICBPYmplY3QgYWRk\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gYWxsLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGFkZCA9IGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIFByb3hpZXMuYXNzZXJ0QWxsb3dlZFR5cGUoYWRk\nLCBfZWxlbWVudFR5cGUpOwogICAgICAgICAgICBfY3QuYWRkZWQoYWRkKTsK\nICAgICAgICAgICAgYWRkZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gYWRkZWQ7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVtb3Zl\nKE9iamVjdCBvKSB7CiAgICAgICAgaWYgKCFjb250YWlucyhvKSkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIFByb3hpZXMuZGlydHkodGhp\ncyk7CiAgICAgICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIG8sIGZhbHNlKTsK\nICAgICAgICBfY3QucmVtb3ZlZChvKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVBbGwoQ29sbGVjdGlv\nbiBhbGwpIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwogICAgICAg\nIGJvb2xlYW4gcmVtb3ZlZCA9IGZhbHNlOwogICAgICAgIE9iamVjdCByZW07\nCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhbGwuaXRlcmF0b3IoKTsg\naXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgcmVtID0gaXRyLm5leHQo\nKTsKICAgICAgICAgICAgaWYgKHJlbW92ZShyZW0pKSB7CiAgICAgICAgICAg\nICAgICBQcm94aWVzLnJlbW92ZWQodGhpcywgcmVtLCBmYWxzZSk7CiAgICAg\nICAgICAgICAgICBfY3QucmVtb3ZlZChyZW0pOwogICAgICAgICAgICAgICAg\ncmVtb3ZlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHJlbW92ZWQ7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\ncmV0YWluQWxsKENvbGxlY3Rpb24gYWxsKSB7CiAgICAgICAgaWYgKGFsbC5p\nc0VtcHR5KCkpIHsKICAgICAgICAgICAgY2xlYXIoKTsKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBQcm94aWVzLmRpcnR5\nKHRoaXMpOwogICAgICAgIEl0ciBpdHIgPSAoSXRyKSBpdGVyYXRvcigpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGJvb2xlYW4gcmVtb3ZlZCA9IGZh\nbHNlOwogICAgICAgICAgICBPYmplY3QgcmVtOwogICAgICAgICAgICB3aGls\nZSAoaXRyLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgcmVtID0gaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgIGlmICghYWxsLmNvbnRhaW5zKHJl\nbSkpIHsKICAgICAgICAgICAgICAgICAgICBQcm94aWVzLnJlbW92ZWQodGhp\ncywgcmVtLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgX2N0LnJlbW92\nZWQocmVtKTsKICAgICAgICAgICAgICAgICAgICByZW1vdmVkID0gdHJ1ZTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBy\nZXR1cm4gcmVtb3ZlZDsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBpdHIuY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgY2xlYXIoKSB7CiAgICAgICAgUHJveGllcy5kaXJ0eSh0aGlzKTsKICAg\nICAgICBJdHIgaXRyID0gKEl0cikgaXRlcmF0b3IoKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBPYmplY3QgcmVtOwogICAgICAgICAgICB3aGlsZSAo\naXRyLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgcmVtID0gaXRyLm5l\neHQoKTsKICAgICAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0aGlzLCBy\nZW0sIGZhbHNlKTsKICAgICAgICAgICAgICAgIF9jdC5yZW1vdmVkKHJlbSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAg\nICAgICAgICAgIGl0ci5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBjb250YWlucyhPYmplY3QgbykgewogICAgICAgIGlm\nIChfZWxlbWVudFR5cGUgIT0gbnVsbCAmJiAhX2VsZW1lbnRUeXBlLmlzSW5z\ndGFuY2UobykpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBp\nZiAoX2N0LmdldEFkZGVkKCkuY29udGFpbnMobykpCiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgIGlmIChfY3QuZ2V0UmVtb3ZlZCgpLmNvbnRh\naW5zKG8pKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYg\nKCFoYXMobykpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWlu\nc0FsbChDb2xsZWN0aW9uIGFsbCkgewogICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gYWxsLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KQogICAgICAg\nICAgICBpZiAoIWNvbnRhaW5zKGl0ci5uZXh0KCkpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIHB1YmxpYyBPYmplY3RbXSB0b0FycmF5KCkgewogICAgICAgIHJldHVy\nbiBhc0xpc3QoKS50b0FycmF5KCk7CiAgICB9CgogICAgcHVibGljIE9iamVj\ndFtdIHRvQXJyYXkoT2JqZWN0W10gYSkgewogICAgICAgIHJldHVybiBhc0xp\nc3QoKS50b0FycmF5KGEpOwogICAgfQoKICAgIHByaXZhdGUgTGlzdCBhc0xp\nc3QoKSB7CiAgICAgICAgSXRyIGl0ciA9IChJdHIpIGl0ZXJhdG9yKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgTGlzdCBsaXN0ID0gbmV3IEFycmF5\nTGlzdCgpOwogICAgICAgICAgICB3aGlsZSAoaXRyLmhhc05leHQoKSkKICAg\nICAgICAgICAgICAgIGxpc3QuYWRkKGl0ci5uZXh0KCkpOwogICAgICAgICAg\nICByZXR1cm4gbGlzdDsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBpdHIuY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGlu\ndCBzaXplKCkgewogICAgICAgIGlmIChfY291bnQgPT0gLTEpCiAgICAgICAg\nICAgIF9jb3VudCA9IGNvdW50KCk7CiAgICAgICAgaWYgKF9jb3VudCA9PSBJ\nbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAgICAgICAgcmV0dXJuIF9jb3VudDsK\nICAgICAgICByZXR1cm4gX2NvdW50ICsgX2N0LmdldEFkZGVkKCkuc2l6ZSgp\nIC0gX2N0LmdldFJlbW92ZWQoKS5zaXplKCk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNFbXB0eSgpIHsKICAgICAgICByZXR1cm4gc2l6ZSgpID09\nIDA7CiAgICB9CgogICAgcHVibGljIEl0ZXJhdG9yIGl0ZXJhdG9yKCkgewog\nICAgICAgIF9pdGVyYXRlZCA9IHRydWU7CgogICAgICAgIEl0ZXJhdG9yQ2hh\naW4gY2hhaW4gPSBuZXcgSXRlcmF0b3JDaGFpbigpOwogICAgICAgIGNoYWlu\nLmFkZEl0ZXJhdG9yKG5ldyBGaWx0ZXJJdGVyYXRvcihpdHIoKSwgdGhpcykp\nOwoKICAgICAgICAvLyBub3RlIGhhdmUgdG8gY29weSBfY3QuZ2V0QWRkZWQg\ndG8gcHJldmVudCBjb25jdXJyZW50IG1vZCBlcnJvcnMKICAgICAgICBjaGFp\nbi5hZGRJdGVyYXRvcihuZXcgQXJyYXlMaXN0KF9jdC5nZXRBZGRlZCgpKS5p\ndGVyYXRvcigpKTsKICAgICAgICByZXR1cm4gbmV3IEl0cihjaGFpbik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiB1c2VkIGluIHRlc3Rpbmc7IHdlIG5lZWQg\ndG8gYmUgYWJsZSB0byBtYWtlIHN1cmUgdGhhdCBPcGVuSlBBIGRvZXMgbm90\nCiAgICAgKiBpdGVyYXRlIGxycyBmaWVsZHMgZHVyaW5nIHN0YW5kYXJkIGNy\ndWQgb3BlcmF0aW9ucwogICAgICovCiAgICBib29sZWFuIGlzSXRlcmF0ZWQo\nKSB7CiAgICAgICAgcmV0dXJuIF9pdGVyYXRlZDsKICAgIH0KCiAgICAvKioK\nICAgICAqIHVzZWQgaW4gdGVzdGluZzsgd2UgbmVlZCB0byBiZSBhYmxlIHRv\nIG1ha2Ugc3VyZSB0aGF0IE9wZW5KUEEgZG9lcyBub3QKICAgICAqIGl0ZXJh\ndGUgbHJzIGZpZWxkcyBkdXJpbmcgc3RhbmRhcmQgY3J1ZCBvcGVyYXRpb25z\nCiAgICAgKi8KICAgIHZvaWQgc2V0SXRlcmF0ZWQoYm9vbGVhbiBpdCkgewog\nICAgICAgIF9pdGVyYXRlZCA9IGl0OwogICAgfQoKICAgIHByb3RlY3RlZCBP\nYmplY3Qgd3JpdGVSZXBsYWNlKCkKICAgICAgICB0aHJvd3MgT2JqZWN0U3Ry\nZWFtRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gYXNMaXN0KCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgdGhpcyBtZXRob2QgdG8gcmV0\ndXJuIGFuIGl0ZXJhdG9yIG92ZXIgdGhlIGNvbnRlbnRzIG9mIHRoZQogICAg\nICogY29sbGVjdGlvbi4gVGhpcyBtZXRob2QgbWF5IGJlIGludm9rZWQgbXVs\ndGlwbGUgdGltZXMuIFRoZSByZXR1cm5lZAogICAgICogaXRlcmF0b3IgZG9l\ncyBub3QgaGF2ZSB0byBzdXBwb3J0IHRoZSB7QGxpbmsgSXRlcmF0b3IjcmVt\nb3ZlfSBtZXRob2QsCiAgICAgKiBhbmQgbWF5IGltcGxlbWVudCB7QGxpbmsg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkNsb3NlYWJsZX0uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBJdGVyYXRvciBpdHIoKTsKCiAg\nICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoZSBjb2xsZWN0aW9uIGNv\nbnRhaW5zIHRoZSBnaXZlbiBlbGVtZW50LgogICAgICovCiAgICBwcm90ZWN0\nZWQgYWJzdHJhY3QgYm9vbGVhbiBoYXMoT2JqZWN0IG8pOwoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gdGhlIGNv\nbGxlY3Rpb24sIG9yCiAgICAgKiB7QGxpbmsgSW50ZWdlciNNQVhfVkFMVUV9\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgaW50IGNvdW50KCk7\nCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUHJl\nZGljYXRlIEltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vCgogICAgcHVibGljIGJvb2xlYW4gZXZhbHVhdGUoT2JqZWN0\nIG8pIHsKICAgICAgICByZXR1cm4gIV9jdC5nZXRSZW1vdmVkKCkuY29udGFp\nbnMobyk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDb2xsZWN0aW9uQ2hhbmdlVHJhY2tl\nciBJbXBsZW1lbnRhdGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIGJvb2xlYW4gaXNUcmFj\na2luZygpIHsKICAgICAgICByZXR1cm4gX2N0LmlzVHJhY2tpbmcoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydFRyYWNraW5nKCkgewogICAgICAg\nIF9jdC5zdGFydFRyYWNraW5nKCk7CiAgICAgICAgcmVzZXQoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzdG9wVHJhY2tpbmcoKSB7CiAgICAgICAgX2N0\nLnN0b3BUcmFja2luZygpOwogICAgICAgIHJlc2V0KCk7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIHJlc2V0KCkgewogICAgICAgIGlmIChfY291bnQgIT0g\nSW50ZWdlci5NQVhfVkFMVUUpCiAgICAgICAgICAgIF9jb3VudCA9IC0xOwog\nICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldEFkZGVkKCkgewogICAg\nICAgIHJldHVybiBfY3QuZ2V0QWRkZWQoKTsKICAgIH0KCiAgICBwdWJsaWMg\nQ29sbGVjdGlvbiBnZXRSZW1vdmVkKCkgewogICAgICAgIHJldHVybiBfY3Qu\nZ2V0UmVtb3ZlZCgpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdl\ndENoYW5nZWQoKSB7CiAgICAgICAgcmV0dXJuIF9jdC5nZXRDaGFuZ2VkKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkZWQoT2JqZWN0IHZhbCkgewog\nICAgICAgIF9jdC5hZGRlZCh2YWwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHJlbW92ZWQoT2JqZWN0IHZhbCkgewogICAgICAgIF9jdC5yZW1vdmVkKHZh\nbCk7CiAgICB9CgogICAgcHVibGljIGludCBnZXROZXh0U2VxdWVuY2UoKSB7\nCiAgICAgICAgcmV0dXJuIF9jdC5nZXROZXh0U2VxdWVuY2UoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXROZXh0U2VxdWVuY2UoaW50IHNlcSkgewog\nICAgICAgIF9jdC5zZXROZXh0U2VxdWVuY2Uoc2VxKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdyYXBwZXIgYXJvdW5kIG91ciBmaWx0ZXJpbmcgaXRlcmF0\nb3IgY2hhaW4uCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgSXRyCiAgICAg\nICAgaW1wbGVtZW50cyBJdGVyYXRvciwgQ2xvc2VhYmxlIHsKCiAgICAgICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IE9QRU4gPSAwOwogICAgICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIGludCBMQVNUX0VMRU0gPSAxOwogICAgICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBDTE9TRUQgPSAyOwoKICAgICAg\nICBwcml2YXRlIGZpbmFsIEl0ZXJhdG9yQ2hhaW4gX2l0cjsKICAgICAgICBw\ncml2YXRlIE9iamVjdCBfbGFzdCA9IG51bGw7CiAgICAgICAgcHJpdmF0ZSBp\nbnQgX3N0YXRlID0gT1BFTjsKCiAgICAgICAgcHVibGljIEl0cihJdGVyYXRv\nckNoYWluIGl0cikgewogICAgICAgICAgICBfaXRyID0gaXRyOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzTmV4dCgpIHsKICAgICAg\nICAgICAgaWYgKF9zdGF0ZSA9PSBDTE9TRUQpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBjbG9zZSBhdXRvbWF0aWNh\nbGx5IGlmIG5vIG1vcmUgZWxlbWVudHMKICAgICAgICAgICAgaWYgKCFfaXRy\nLmhhc05leHQoKSkgewogICAgICAgICAgICAgICAgZnJlZSgpOwogICAgICAg\nICAgICAgICAgX3N0YXRlID0gTEFTVF9FTEVNOwogICAgICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVy\nbiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVjdCBuZXh0\nKCkgewogICAgICAgICAgICBpZiAoX3N0YXRlICE9IE9QRU4pCiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbigpOwog\nICAgICAgICAgICBfbGFzdCA9IF9pdHIubmV4dCgpOwogICAgICAgICAgICBy\nZXR1cm4gX2xhc3Q7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBy\nZW1vdmUoKSB7CiAgICAgICAgICAgIGlmIChfc3RhdGUgPT0gQ0xPU0VEIHx8\nIF9sYXN0ID09IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9T\ndWNoRWxlbWVudEV4Y2VwdGlvbigpOwogICAgICAgICAgICBQcm94aWVzLmRp\ncnR5KEFic3RyYWN0TFJTUHJveHlDb2xsZWN0aW9uLnRoaXMpOwogICAgICAg\nICAgICBfY3QucmVtb3ZlZChfbGFzdCk7CiAgICAgICAgICAgIFByb3hpZXMu\ncmVtb3ZlZChBYnN0cmFjdExSU1Byb3h5Q29sbGVjdGlvbi50aGlzLCBfbGFz\ndCwgZmFsc2UpOwogICAgICAgICAgICBfbGFzdCA9IG51bGw7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgICAgICAgICAg\nZnJlZSgpOwogICAgICAgICAgICBfc3RhdGUgPSBDTE9TRUQ7CiAgICAgICAg\nfQoKICAgICAgICBwcml2YXRlIHZvaWQgZnJlZSgpIHsKICAgICAgICAgICAg\naWYgKF9zdGF0ZSAhPSBPUEVOKQogICAgICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICAgICAgTGlzdCBpdHJzID0gX2l0ci5nZXRJdGVyYXRvcnMoKTsK\nICAgICAgICAgICAgSXRlcmF0b3IgaXRyOwogICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGl0cnMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAg\nICAgIGl0ciA9IChJdGVyYXRvcikgaXRycy5nZXQoaSk7CiAgICAgICAgICAg\nICAgICBpZiAoaXRyIGluc3RhbmNlb2YgRmlsdGVySXRlcmF0b3IpCiAgICAg\nICAgICAgICAgICAgICAgaXRyID0gKChGaWx0ZXJJdGVyYXRvcikgaXRyKS5n\nZXRJdGVyYXRvcigpOwogICAgICAgICAgICAgICAgSW1wbEhlbHBlci5jbG9z\nZShpdHIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcm90\nZWN0ZWQgdm9pZCBmaW5hbGl6ZSgpIHsKICAgICAgICAgICAgY2xvc2UoKTsK\nCQl9Cgl9Cn0K\n","encoding":"base64"}

