{"sha":"6baa8b4532b51a7991939ab67c5388c4687d724b","node_id":"MDQ6QmxvYjIwNjM2NDo2YmFhOGI0NTMyYjUxYTc5OTE5MzlhYjY3YzUzODhjNDY4N2Q3MjRi","size":3788,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6baa8b4532b51a7991939ab67c5388c4687d724b","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247\nCgovKioKICogRGVmYXVsdCB7QGxpbmsgTWFwQ2hhbmdlVHJhY2tlcn0uCiAq\nCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1Ymxp\nYyBjbGFzcyBNYXBDaGFuZ2VUcmFja2VySW1wbAogICAgZXh0ZW5kcyBBYnN0\ncmFjdENoYW5nZVRyYWNrZXIKICAgIGltcGxlbWVudHMgTWFwQ2hhbmdlVHJh\nY2tlciB7CgogICAgcHJpdmF0ZSBmaW5hbCBNYXAgX21hcDsKICAgIHByaXZh\ndGUgYm9vbGVhbiBfa2V5cyA9IHRydWU7CgogICAgLyoqCiAgICAgKiBDb25z\ndHJ1Y3Rvcjsgc3VwcGx5IGRlbGVnYXRlIG1hcC4KICAgICAqLwogICAgcHVi\nbGljIE1hcENoYW5nZVRyYWNrZXJJbXBsKE1hcCBtYXAsIE9wZW5KUEFDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfbWFwID0gbWFwOwogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGdldFRyYWNrS2V5cygpIHsKICAgICAgICBy\nZXR1cm4gX2tleXM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhY2tL\nZXlzKGJvb2xlYW4ga2V5cykgewogICAgICAgIF9rZXlzID0ga2V5czsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRlZChPYmplY3Qga2V5LCBPYmplY3Qg\ndmFsKSB7CiAgICAgICAgaWYgKF9rZXlzKQogICAgICAgICAgICBzdXBlci5h\nZGRlZChrZXkpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc3VwZXIuYWRk\nZWQodmFsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVkKE9iamVj\ndCBrZXksIE9iamVjdCB2YWwpIHsKICAgICAgICBpZiAoX2tleXMpCiAgICAg\nICAgICAgIHN1cGVyLnJlbW92ZWQoa2V5KTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIHN1cGVyLnJlbW92ZWQodmFsKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjaGFuZ2VkKE9iamVjdCBrZXksIE9iamVjdCBvbGRWYWwsIE9iamVj\ndCBuZXdWYWwpIHsKICAgICAgICBpZiAoX2tleXMpCiAgICAgICAgICAgIHN1\ncGVyLmNoYW5nZWQoa2V5KTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAg\nc3VwZXIucmVtb3ZlZChvbGRWYWwpOwogICAgICAgICAgICBzdXBlci5hZGRl\nZChuZXdWYWwpOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9p\nZCBhZGQoT2JqZWN0IG9iaikgewogICAgICAgIC8vIGlmIHRoZSBrZXkgd2Fz\nIHByZXZpb3VzbHkgcmVtb3ZlZCBhbmQgbm93IGFkZGVkIGJhY2ssIG1hcmsK\nICAgICAgICAvLyBpdCBhcyBhIGNoYW5nZTsgb3RoZXJ3aXNlIGl0J3MgYSBu\nZXcgYWRkaXRpb24KICAgICAgICBpZiAocmVtICE9IG51bGwgJiYgcmVtLnJl\nbW92ZShvYmopKSB7CiAgICAgICAgICAgIGlmIChjaGFuZ2UgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGNoYW5nZSA9IG5ld1NldCgpOwogICAgICAgICAg\nICBjaGFuZ2UuYWRkKG9iaik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgLy8gYWZ0ZXIgYSBwb2ludCBpdCBiZWNvbWVzIGluZWZmaWNpZW50IHRv\nIHRyYWNrIGNoYW5nZXMKICAgICAgICAgICAgaWYgKGdldEF1dG9PZmYoKSAm\nJiBnZXRBZGRlZCgpLnNpemUoKSArIGdldENoYW5nZWQoKS5zaXplKCkKICAg\nICAgICAgICAgICAgICsgZ2V0UmVtb3ZlZCgpLnNpemUoKSA+PSBfbWFwLnNp\nemUoKSkKICAgICAgICAgICAgICAgIHN0b3BUcmFja2luZygpOwogICAgICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChhZGQgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBhZGQgPSBuZXdTZXQoKTsKICAgICAgICAg\nICAgICAgIGFkZC5hZGQob2JqKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCByZW1vdmUoT2JqZWN0IG9iaikg\newogICAgICAgIC8vIG5vIGxvbmdlciBhIGNoYW5nZSwgaWYgaXQgd2FzIGJl\nZm9yZQogICAgICAgIGlmIChjaGFuZ2UgIT0gbnVsbCkKICAgICAgICAgICAg\nY2hhbmdlLnJlbW92ZShvYmopOwoKICAgICAgICAvLyBpZiBpdCB3YXMgYSBu\nZXcgYWRkaXRpb24sIGp1c3QgZm9yZ2V0IGl0OyBvdGhlcndpc2UgcmVtZW1i\nZXIKICAgICAgICAvLyB0aGF0IGl0IHdhcyByZW1vdmVkCiAgICAgICAgaWYg\nKGFkZCA9PSBudWxsIHx8ICFhZGQucmVtb3ZlKG9iaikpIHsKICAgICAgICAg\nICAgLy8gYWZ0ZXIgYSBwb2ludCBpdCBiZWNvbWVzIGluZWZmaWNpZW50IHRv\nIHRyYWNrIGNoYW5nZXMKICAgICAgICAgICAgaWYgKGdldEF1dG9PZmYoKSAm\nJiBnZXRBZGRlZCgpLnNpemUoKSArIGdldENoYW5nZWQoKS5zaXplKCkKICAg\nICAgICAgICAgICAgICsgZ2V0UmVtb3ZlZCgpLnNpemUoKSA+PSBfbWFwLnNp\nemUoKSkKICAgICAgICAgICAgICAgIHN0b3BUcmFja2luZygpOwogICAgICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChyZW0gPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICByZW0gPSBuZXdTZXQoKTsKICAgICAgICAg\nICAgICAgIHJlbS5hZGQob2JqKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBjaGFuZ2UoT2JqZWN0IGtleSkg\newogICAgICAgIC8vIGlmIHRoZSBrZXkgaXMgYWxyZWFkeSBjaGFuZ2VkIG9y\nIHRoZSBrZXkgaXMgbmV3bHkgYWRkZWQsIG5vdGhpbmcKICAgICAgICAvLyB0\nbyBkbwogICAgICAgIGlmICgoY2hhbmdlICE9IG51bGwgJiYgY2hhbmdlLmNv\nbnRhaW5zKGtleSkpCiAgICAgICAgICAgIHx8IChhZGQgIT0gbnVsbCAmJiBh\nZGQuY29udGFpbnMoa2V5KSkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAg\nICAgLy8gYWZ0ZXIgYSBwb2ludCBpdCBiZWNvbWVzIGluZWZmaWNpZW50IHRv\nIHRyYWNrIGNoYW5nZXMKICAgICAgICBpZiAoZ2V0QXV0b09mZigpICYmIGdl\ndEFkZGVkKCkuc2l6ZSgpICsgZ2V0Q2hhbmdlZCgpLnNpemUoKQogICAgICAg\nICAgICArIGdldFJlbW92ZWQoKS5zaXplKCkgPj0gX21hcC5zaXplKCkpCiAg\nICAgICAgICAgIHN0b3BUcmFja2luZygpOwogICAgICAgIGVsc2UgewogICAg\nICAgICAgICAvLyByZWNvcmQgdGhlIGNoYW5nZQogICAgICAgICAgICBpZiAo\nY2hhbmdlID09IG51bGwpCiAgICAgICAgICAgICAgICBjaGFuZ2UgPSBuZXdT\nZXQoKTsKICAgICAgICAgICAgY2hhbmdlLmFkZChrZXkpOwogICAgICAgIH0K\nICAgIH0KfQo=\n","encoding":"base64"}

