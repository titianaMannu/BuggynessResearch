{"sha":"a5a56c8476d55df669d2d7bf2db9b87d98a5728e","node_id":"MDQ6QmxvYjIwNjM2NDphNWE1NmM4NDc2ZDU1ZGY2NjlkMmQ3YmYyZGI5Yjg3ZDk4YTU3Mjhl","size":8019,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a5a56c8476d55df669d2d7bf2db9b87d98a5728e","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFic3RyYWN0U2V0OwppbXBvcnQg\namF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3RJdGVy\nYXRvcjsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwu\nU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQ\nQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5Mb2NhbGl6ZXI7CgovKioKICogVXRpbGl0eSBtZXRob2RzIGZvciBt\nYW5hZ2luZyBwcm94aWVzLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8K\ncHVibGljIGNsYXNzIFByb3hpZXMgewoKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgaW50IE1PREVfRU5UUlkgPSAwOwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgTU9ERV9LRVkgPSAxOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBp\nbnQgTU9ERV9WQUxVRSA9IDI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShQcm94aWVz\nLmNsYXNzKTsKCiAgICAvKioKICAgICAqIFVzZWQgYnkgcHJveHkgdHlwZXMg\ndG8gY2hlY2sgaWYgdGhlIGdpdmVuIG93bmVycyBhbmQgZmllbGQgbmFtZXMK\nICAgICAqIGFyZSBlcXVpdmFsZW50LgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGJvb2xlYW4gaXNPd25lcihQcm94eSBwcm94eSwgT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwKICAgICAgICBpbnQgZmllbGQpIHsKICAgICAgICByZXR1\ncm4gcHJveHkuZ2V0T3duZXIoKSA9PSBzbSAmJiBwcm94eS5nZXRPd25lckZp\nZWxkKCkgPT0gZmllbGQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2VkIGJ5\nIHByb3h5IHR5cGVzIHRvIGNoZWNrIHRoYXQgYW4gYXR0ZW1wdCB0byBhZGQg\nYSBuZXcgdmFsdWUgaXMgbGVnYWwuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBhc3NlcnRBbGxvd2VkVHlwZShPYmplY3QgdmFsdWUsIENsYXNz\nIGFsbG93ZWQpIHsKICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCAmJiBhbGxv\nd2VkICE9IG51bGwgJiYgIWFsbG93ZWQuaXNJbnN0YW5jZSh2YWx1ZSkpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nImJhZC1lbGVtLXR5cGUiLCBuZXcgT2JqZWN0W117CiAgICAgICAgICAgICAg\nICBhbGxvd2VkLmdldENsYXNzTG9hZGVyKCksCiAgICAgICAgICAgICAgICBh\nbGxvd2VkLAogICAgICAgICAgICAgICAgdmFsdWUuZ2V0Q2xhc3MoKS5nZXRD\nbGFzc0xvYWRlcigpLAogICAgICAgICAgICAgICAgdmFsdWUuZ2V0Q2xhc3Mo\nKQogICAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogVXNlZCBieSBwcm94eSB0eXBlcyB0byBkaXJ0eSB0aGVpciBvd25l\nci4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGRpcnR5KFByb3h5\nIHByb3h5KSB7CiAgICAgICAgaWYgKHByb3h5LmdldE93bmVyKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgcHJveHkuZ2V0T3duZXIoKS5kaXJ0eShwcm94eS5n\nZXRPd25lckZpZWxkKCkpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlZCBi\neSBwcm94eSB0eXBlcyB0byBub3RpZnkgdGhlaXIgb3duZXIgdGhhdCBhbiBl\nbGVtZW50IGhhcyBiZWVuCiAgICAgKiByZW1vdmVkLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgcmVtb3ZlZChQcm94eSBwcm94eSwgT2JqZWN0\nIHJlbW92ZWQsIGJvb2xlYW4ga2V5KSB7CiAgICAgICAgaWYgKHByb3h5Lmdl\ndE93bmVyKCkgIT0gbnVsbCAmJiByZW1vdmVkICE9IG51bGwpCiAgICAgICAg\nICAgIHByb3h5LmdldE93bmVyKCkucmVtb3ZlZChwcm94eS5nZXRPd25lckZp\nZWxkKCksIHJlbW92ZWQsIGtleSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYW4gaXRlcmF0b3IgdGhhdCBkaXJ0aWVzIGl0cyBvd25lciBvbiBj\nYWxscyB0byByZW1vdmUuIFRoaXMKICAgICAqIGl0ZXJhdG9yIGFzc3VtZXMg\ndGhhdCB0aGUgZ2l2ZW4gcHJveHkgY29sbGVjdGlvbiB1c2VzIGEKICAgICAq\nIHtAbGluayBDb2xsZWN0aW9uQ2hhbmdlVHJhY2tlcn0uCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgSXRlcmF0b3IgaXRlcmF0b3IoZmluYWwgUHJveHlD\nb2xsZWN0aW9uIHByb3h5LAogICAgICAgIGZpbmFsIEl0ZXJhdG9yIGl0cikg\newogICAgICAgIHJldHVybiBuZXcgSXRlcmF0b3IoKSB7CiAgICAgICAgICAg\nIHByaXZhdGUgT2JqZWN0IF9sYXN0ID0gbnVsbDsKCiAgICAgICAgICAgIHB1\nYmxpYyBib29sZWFuIGhhc05leHQoKSB7CiAgICAgICAgICAgICAgICByZXR1\ncm4gaXRyLmhhc05leHQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIE9iamVjdCBuZXh0KCkgewogICAgICAgICAgICAgICAgX2xhc3Qg\nPSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9sYXN0Owog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCByZW1vdmUo\nKSB7CiAgICAgICAgICAgICAgICBkaXJ0eShwcm94eSk7CiAgICAgICAgICAg\nICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBpZiAocHJveHku\nZ2V0Q2hhbmdlVHJhY2tlcigpICE9IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgKChDb2xsZWN0aW9uQ2hhbmdlVHJhY2tlcikgcHJveHkuZ2V0Q2hhbmdl\nVHJhY2tlcigpKS4KICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZChf\nbGFzdCk7CiAgICAgICAgICAgICAgICByZW1vdmVkKHByb3h5LCBfbGFzdCwg\nZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBhIHByb3h5IGl0ZXJhdG9yIHRoYXQgZGlydGll\ncyBpdHMgb3duZXIgb24gcmVtb3ZlLCBzZXQsIGFuZAogICAgICogYWRkLiBU\naGlzIGl0ZXJhdG9yIGFzc3VtZXMgdGhhdCB0aGUgZ2l2ZW4gcHJveHkgY29s\nbGVjdGlvbiB1c2VzIGEKICAgICAqIHtAbGluayBDb2xsZWN0aW9uQ2hhbmdl\nVHJhY2tlcn0uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgTGlzdEl0ZXJh\ndG9yIGxpc3RJdGVyYXRvcihmaW5hbCBQcm94eUNvbGxlY3Rpb24gcHJveHks\nCiAgICAgICAgZmluYWwgTGlzdEl0ZXJhdG9yIGl0ciwgZmluYWwgQ2xhc3Mg\nYWxsb3dlZCkgewogICAgICAgIHJldHVybiBuZXcgTGlzdEl0ZXJhdG9yKCkg\newogICAgICAgICAgICBwcml2YXRlIE9iamVjdCBfbGFzdCA9IG51bGw7Cgog\nICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIGl0ci5oYXNOZXh0KCk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyBpbnQgbmV4dEluZGV4KCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIGl0ci5uZXh0SW5kZXgoKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcHVibGljIE9iamVjdCBuZXh0KCkgewogICAgICAg\nICAgICAgICAgX2xhc3QgPSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIF9sYXN0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgYm9vbGVhbiBoYXNQcmV2aW91cygpIHsKICAgICAgICAgICAgICAgIHJl\ndHVybiBpdHIuaGFzUHJldmlvdXMoKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIGludCBwcmV2aW91c0luZGV4KCkgewogICAgICAgICAg\nICAgICAgcmV0dXJuIGl0ci5wcmV2aW91c0luZGV4KCk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgcHJldmlvdXMoKSB7CiAg\nICAgICAgICAgICAgICBfbGFzdCA9IGl0ci5wcmV2aW91cygpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIF9sYXN0OwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgdm9pZCBzZXQoT2JqZWN0IG8pIHsKICAgICAgICAgICAg\nICAgIGFzc2VydEFsbG93ZWRUeXBlKG8sIGFsbG93ZWQpOwogICAgICAgICAg\nICAgICAgZGlydHkocHJveHkpOwogICAgICAgICAgICAgICAgaXRyLnNldChv\nKTsKICAgICAgICAgICAgICAgIGlmIChwcm94eS5nZXRDaGFuZ2VUcmFja2Vy\nKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBwcm94eS5nZXRDaGFu\nZ2VUcmFja2VyKCkuc3RvcFRyYWNraW5nKCk7CiAgICAgICAgICAgICAgICBy\nZW1vdmVkKHByb3h5LCBfbGFzdCwgZmFsc2UpOwogICAgICAgICAgICAgICAg\nX2xhc3QgPSBvOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBhZGQoT2JqZWN0IG8pIHsKICAgICAgICAgICAgICAgIGFzc2VydEFs\nbG93ZWRUeXBlKG8sIGFsbG93ZWQpOwogICAgICAgICAgICAgICAgZGlydHko\ncHJveHkpOwogICAgICAgICAgICAgICAgaXRyLmFkZChvKTsKICAgICAgICAg\nICAgICAgIGlmIChwcm94eS5nZXRDaGFuZ2VUcmFja2VyKCkgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgICAgIGlmIChoYXNOZXh0KCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIHByb3h5LmdldENoYW5nZVRyYWNrZXIoKS5zdG9w\nVHJhY2tpbmcoKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICAgICAgICAgICgoQ29sbGVjdGlvbkNoYW5nZVRyYWNrZXIpIHBy\nb3h5LmdldENoYW5nZVRyYWNrZXIoKSkuCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBhZGRlZChvKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIF9sYXN0ID0gbzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIHZvaWQgcmVtb3ZlKCkgewogICAgICAgICAgICAgICAgZGlydHko\ncHJveHkpOwogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAgICAg\nICAgICAgICAgaWYgKHByb3h5LmdldENoYW5nZVRyYWNrZXIoKSAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgICgoQ29sbGVjdGlvbkNoYW5nZVRyYWNr\nZXIpIHByb3h5LmdldENoYW5nZVRyYWNrZXIoKSkuCiAgICAgICAgICAgICAg\nICAgICAgICAgIHJlbW92ZWQoX2xhc3QpOwogICAgICAgICAgICAgICAgcmVt\nb3ZlZChwcm94eSwgX2xhc3QsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAg\nICAgIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBwcm94eSBm\nb3IgdGhlIGdpdmVuIG1hcCBrZXkgb3IgZW50cnkgc2V0LgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIFNldCBlbnRyeVNldChmaW5hbCBQcm94eU1hcCBw\ncm94eSwgZmluYWwgU2V0IHNldCwKICAgICAgICBmaW5hbCBpbnQgbW9kZSkg\newogICAgICAgIHJldHVybiBuZXcgQWJzdHJhY3RTZXQoKSB7CiAgICAgICAg\nICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsKICAgICAgICAgICAgICAgIHJldHVy\nbiBzZXQuc2l6ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgYm9vbGVhbiByZW1vdmUoT2JqZWN0IG8pIHsKICAgICAgICAgICAgICAg\nIGlmIChtb2RlICE9IE1PREVfS0VZKQogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOwoKICAg\nICAgICAgICAgICAgIE1hcCBtYXAgPSAoTWFwKSBwcm94eTsKICAgICAgICAg\nICAgICAgIGlmICghbWFwLmNvbnRhaW5zS2V5KG8pKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIG1hcC5yZW1v\ndmUobyk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIEl0ZXJhdG9yIGl0ZXJhdG9yKCkg\newogICAgICAgICAgICAgICAgZmluYWwgSXRlcmF0b3IgaXRyID0gc2V0Lml0\nZXJhdG9yKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEl0ZXJhdG9y\nKCkgewogICAgICAgICAgICAgICAgICAgIHByaXZhdGUgTWFwLkVudHJ5IF9s\nYXN0ID0gbnVsbDsKCiAgICAgICAgICAgICAgICAgICAgcHVibGljIGJvb2xl\nYW4gaGFzTmV4dCgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIGl0ci5oYXNOZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgT2JqZWN0IG5leHQoKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIF9sYXN0ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQo\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1PREVfS0VZOgogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfbGFzdC5nZXRL\nZXkoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTU9ERV9W\nQUxVRToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nX2xhc3QuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIF9sYXN0OwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCByZW1vdmUoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpcnR5KHBy\nb3h5KTsKICAgICAgICAgICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJveHkuZ2V0Q2hhbmdlVHJh\nY2tlcigpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAo\nKE1hcENoYW5nZVRyYWNrZXIpIHByb3h5LmdldENoYW5nZVRyYWNrZXIoKSku\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZChfbGFz\ndC5nZXRLZXkoKSwgX2xhc3QuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIHJlbW92ZWQocHJveHksIF9sYXN0LmdldEtleSgpLCB0cnVl\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZChwcm94eSwgX2xh\nc3QuZ2V0VmFsdWUoKSwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHByb3RlY3RlZCBPYmplY3Qgd3JpdGVSZXBsYWNlKCkKICAgICAgICAgICAg\nICAgIHRocm93cyBPYmplY3RTdHJlYW1FeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgc3dpdGNoIChtb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBNT0RFX0tFWToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgo\nTWFwKSBwcm94eSkua2V5U2V0KCk7CiAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBNT0RFX1ZBTFVFOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nKChNYXApIHByb3h5KS52YWx1ZXMoKTsKICAgICAgICAgICAgICAgICAgICBk\nZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChNYXAp\nIHByb3h5KS5lbnRyeVNldCgpOwogICAgICAgICAgICAgICAgfQoJCQl9CgkJ\nfTsKCX0KfQoK\n","encoding":"base64"}

