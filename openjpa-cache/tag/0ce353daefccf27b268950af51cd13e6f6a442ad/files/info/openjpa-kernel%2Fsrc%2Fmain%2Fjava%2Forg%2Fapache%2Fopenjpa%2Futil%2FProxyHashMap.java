{"sha":"9174e027486a106f0216c87e899294d8257e1b52","node_id":"MDQ6QmxvYjIwNjM2NDo5MTc0ZTAyNzQ4NmExMDZmMDIxNmM4N2U4OTkyOTRkODI1N2UxYjUy","size":4665,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9174e027486a106f0216c87e899294d8257e1b52","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7\nCgovKioKICogRXh0ZW5zaW9uIG9mIHRoZSB7QGxpbmsgSGFzaE1hcH0gdHlw\nZSB0aGF0IGRpcnRpZXMgdGhlCiAqIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25h\nbCBmaWVsZCBpdCBpcyBhc3NpZ25lZCB0byBvbiBtb2RpZmljYXRpb24uCiAq\nIFRoZSBuZWVkIHRvIGRpcnR5IHRoZSBmaWVsZCBvbiA8Yj5hbnk8L2I+IG1v\nZGlmaWNhdGlvbiBtYW5kYXRlcyB0aGF0CiAqIHRoaXMgY2xhc3MgbXVzdCBv\ndmVycmlkZSBhbGwgbXV0YXRvciBtZXRob2RzIG9mIHRoZSBiYXNlIHR5cGUu\nCiAqIFRoaXMgbWF5IGxlYWQgdG8gbXVsdGlwbGUgY2FsbHMgdG8gPGNvZGU+\nZGlydHk8L2NvZGU+IGZvciBvbmUgc3RhdGUKICogY2hhbmdlIGlmIG9uZSBt\ndXRhdG9yIG1ldGhvZCBvZiB0aGUgYmFzZSB0eXBlIGNhbGxzIGFub3RoZXIu\nCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1\nYmxpYyBjbGFzcyBQcm94eUhhc2hNYXAKICAgIGV4dGVuZHMgSGFzaE1hcAog\nICAgaW1wbGVtZW50cyBQcm94eU1hcCB7CgogICAgcHJpdmF0ZSB0cmFuc2ll\nbnQgQ2xhc3MgX2tleVR5cGUgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2ll\nbnQgQ2xhc3MgX3ZhbHVlVHlwZSA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5z\naWVudCBPcGVuSlBBU3RhdGVNYW5hZ2VyIF9zbSA9IG51bGw7CiAgICBwcml2\nYXRlIHRyYW5zaWVudCBpbnQgX2ZpZWxkID0gLTE7CiAgICBwcml2YXRlIHRy\nYW5zaWVudCBNYXBDaGFuZ2VUcmFja2VyIF9jdCA9IG51bGw7CgogICAgcHVi\nbGljIFByb3h5SGFzaE1hcCgpIHsKICAgIH0KCiAgICBwdWJsaWMgUHJveHlI\nYXNoTWFwKENsYXNzIGtleVR5cGUsIENsYXNzIHZhbHVlVHlwZSwgYm9vbGVh\nbiB0cmFja0NoYW5nZXMsCiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24g\nY29uZikgewogICAgICAgIF9rZXlUeXBlID0ga2V5VHlwZTsKICAgICAgICBf\ndmFsdWVUeXBlID0gdmFsdWVUeXBlOwogICAgICAgIGlmICh0cmFja0NoYW5n\nZXMpCiAgICAgICAgICAgIF9jdCA9IG5ldyBNYXBDaGFuZ2VUcmFja2VySW1w\nbCh0aGlzLCBjb25mKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRPd25l\ncihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBpbnQgZmllbGQpIHsKICAgICAg\nICBfc20gPSBzbTsKICAgICAgICBfZmllbGQgPSBmaWVsZDsKICAgIH0KCiAg\nICBwdWJsaWMgT3BlbkpQQVN0YXRlTWFuYWdlciBnZXRPd25lcigpIHsKICAg\nICAgICByZXR1cm4gX3NtOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0T3du\nZXJGaWVsZCgpIHsKICAgICAgICByZXR1cm4gX2ZpZWxkOwogICAgfQoKICAg\nIHB1YmxpYyBDaGFuZ2VUcmFja2VyIGdldENoYW5nZVRyYWNrZXIoKSB7CiAg\nICAgICAgcmV0dXJuIF9jdDsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGNv\ncHkoT2JqZWN0IG9yaWcpIHsKICAgICAgICByZXR1cm4gbmV3IEhhc2hNYXAo\nKE1hcCkgb3JpZyk7CiAgICB9CgogICAgcHVibGljIFByb3h5TWFwIG5ld0lu\nc3RhbmNlKENsYXNzIGtleVR5cGUsIENsYXNzIHZhbHVlVHlwZSwKICAgICAg\nICBDb21wYXJhdG9yIGNvbXBhcmUsIGJvb2xlYW4gdHJhY2tDaGFuZ2VzLCBP\ncGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBQcm94eUhhc2hNYXAoa2V5VHlwZSwgdmFsdWVUeXBlLCB0cmFja0NoYW5n\nZXMsIGNvbmYpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsZWFyKCkgewog\nICAgICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgaWYgKF9jdCAh\nPSBudWxsKQogICAgICAgICAgICBfY3Quc3RvcFRyYWNraW5nKCk7CiAgICAg\nICAgTWFwLkVudHJ5IGVudHJ5OwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gc3VwZXIuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0aGlzLCBlbnRyeS5n\nZXRLZXkoKSwgdHJ1ZSk7CiAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0\naGlzLCBlbnRyeS5nZXRWYWx1ZSgpLCBmYWxzZSk7CiAgICAgICAgfQogICAg\nICAgIHN1cGVyLmNsZWFyKCk7CiAgICB9CgogICAgcHVibGljIFNldCBrZXlT\nZXQoKSB7CiAgICAgICAgcmV0dXJuIFByb3hpZXMuZW50cnlTZXQodGhpcywg\nc3VwZXIuZW50cnlTZXQoKSwgUHJveGllcy5NT0RFX0tFWSk7CiAgICB9Cgog\nICAgcHVibGljIENvbGxlY3Rpb24gdmFsdWVzKCkgewogICAgICAgIHJldHVy\nbiBQcm94aWVzLmVudHJ5U2V0KHRoaXMsIHN1cGVyLmVudHJ5U2V0KCksIFBy\nb3hpZXMuTU9ERV9WQUxVRSk7CiAgICB9CgogICAgcHVibGljIFNldCBlbnRy\neVNldCgpIHsKICAgICAgICByZXR1cm4gUHJveGllcy5lbnRyeVNldCh0aGlz\nLCBzdXBlci5lbnRyeVNldCgpLCBQcm94aWVzLk1PREVfRU5UUlkpOwogICAg\nfQoKICAgIHB1YmxpYyBPYmplY3QgcHV0KE9iamVjdCBrZXksIE9iamVjdCB2\nYWx1ZSkgewogICAgICAgIFByb3hpZXMuYXNzZXJ0QWxsb3dlZFR5cGUoa2V5\nLCBfa2V5VHlwZSk7CiAgICAgICAgUHJveGllcy5hc3NlcnRBbGxvd2VkVHlw\nZSh2YWx1ZSwgX3ZhbHVlVHlwZSk7CiAgICAgICAgUHJveGllcy5kaXJ0eSh0\naGlzKTsKICAgICAgICBib29sZWFuIGhhZCA9IGNvbnRhaW5zS2V5KGtleSk7\nCiAgICAgICAgT2JqZWN0IG9sZCA9IHN1cGVyLnB1dChrZXksIHZhbHVlKTsK\nICAgICAgICBpZiAoaGFkKSB7CiAgICAgICAgICAgIGlmIChfY3QgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIF9jdC5jaGFuZ2VkKGtleSwgb2xkLCB2YWx1\nZSk7CiAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0aGlzLCBvbGQsIGZh\nbHNlKTsKICAgICAgICB9IGVsc2UgaWYgKF9jdCAhPSBudWxsKQogICAgICAg\nICAgICBfY3QuYWRkZWQoa2V5LCB2YWx1ZSk7CiAgICAgICAgcmV0dXJuIG9s\nZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwdXRBbGwoTWFwIG0pIHsKICAg\nICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAgZm9yIChJdGVyYXRvciBp\ndHIgPSBtLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4dCgp\nOwogICAgICAgICAgICBwdXQoZW50cnkuZ2V0S2V5KCksIGVudHJ5LmdldFZh\nbHVlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHJl\nbW92ZShPYmplY3Qga2V5KSB7CiAgICAgICAgUHJveGllcy5kaXJ0eSh0aGlz\nKTsKICAgICAgICBib29sZWFuIGhhZCA9IGNvbnRhaW5zS2V5KGtleSk7CiAg\nICAgICAgT2JqZWN0IG9sZCA9IHN1cGVyLnJlbW92ZShrZXkpOwogICAgICAg\nIGlmIChoYWQpIHsKICAgICAgICAgICAgaWYgKF9jdCAhPSBudWxsKQogICAg\nICAgICAgICAgICAgX2N0LnJlbW92ZWQoa2V5LCBvbGQpOwogICAgICAgICAg\nICBQcm94aWVzLnJlbW92ZWQodGhpcywga2V5LCB0cnVlKTsKICAgICAgICAg\nICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIG9sZCwgZmFsc2UpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gb2xkOwogICAgfQoKICAgIHByb3RlY3RlZCBP\nYmplY3Qgd3JpdGVSZXBsYWNlKCkKICAgICAgICB0aHJvd3MgT2JqZWN0U3Ry\nZWFtRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX3NtICE9IG51bGwgJiYgX3Nt\nLmlzRGV0YWNoZWQoKSkKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAg\nICAgcmV0dXJuIGNvcHkodGhpcyk7CiAgICB9Cn0K\n","encoding":"base64"}

