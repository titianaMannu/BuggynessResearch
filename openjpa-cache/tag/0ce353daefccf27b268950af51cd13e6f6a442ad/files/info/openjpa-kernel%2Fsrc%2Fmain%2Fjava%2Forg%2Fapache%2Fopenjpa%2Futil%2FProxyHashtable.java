{"sha":"3730a031ac4643e92560caef96fc03080aca7f60","node_id":"MDQ6QmxvYjIwNjM2NDozNzMwYTAzMWFjNDY0M2U5MjU2MGNhZWY5NmZjMDMwODBhY2E3ZjYw","size":4681,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3730a031ac4643e92560caef96fc03080aca7f60","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5IYXNodGFi\nbGU7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdl\ncjsKCi8qKgogKiBFeHRlbnNpb24gb2YgdGhlIHtAbGluayBIYXNodGFibGV9\nIHR5cGUgdGhhdCBkaXJ0aWVzIHRoZQogKiBwZXJzaXN0ZW50L3RyYW5zYWN0\naW9uYWwgZmllbGQgaXQgaXMgYXNzaWduZWQgdG8gb24gbW9kaWZpY2F0aW9u\nLgogKiBUaGUgbmVlZCB0byBkaXJ0eSB0aGUgZmllbGQgb24gPGI+YW55PC9i\nPiBtb2RpZmljYXRpb24gbWFuZGF0ZXMgdGhhdAogKiB0aGlzIGNsYXNzIG11\nc3Qgb3ZlcnJpZGUgYWxsIG11dGF0b3IgbWV0aG9kcyBvZiB0aGUgYmFzZSB0\neXBlLgogKiBUaGlzIG1heSBsZWFkIHRvIG11bHRpcGxlIGNhbGxzIHRvIDxj\nb2RlPmRpcnR5PC9jb2RlPiBmb3Igb25lIHN0YXRlCiAqIGNoYW5nZSBpZiBv\nbmUgbXV0YXRvciBtZXRob2Qgb2YgdGhlIGJhc2UgdHlwZSBjYWxscyBhbm90\naGVyLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAq\nLwpwdWJsaWMgY2xhc3MgUHJveHlIYXNodGFibGUKICAgIGV4dGVuZHMgSGFz\naHRhYmxlCiAgICBpbXBsZW1lbnRzIFByb3h5TWFwIHsKCiAgICBwcml2YXRl\nIHRyYW5zaWVudCBDbGFzcyBfa2V5VHlwZSA9IG51bGw7CiAgICBwcml2YXRl\nIHRyYW5zaWVudCBDbGFzcyBfdmFsdWVUeXBlID0gbnVsbDsKICAgIHByaXZh\ndGUgdHJhbnNpZW50IE9wZW5KUEFTdGF0ZU1hbmFnZXIgX3NtID0gbnVsbDsK\nICAgIHByaXZhdGUgdHJhbnNpZW50IGludCBfZmllbGQgPSAtMTsKICAgIHBy\naXZhdGUgdHJhbnNpZW50IE1hcENoYW5nZVRyYWNrZXIgX2N0ID0gbnVsbDsK\nCiAgICBwdWJsaWMgUHJveHlIYXNodGFibGUoKSB7CiAgICB9CgogICAgcHVi\nbGljIFByb3h5SGFzaHRhYmxlKENsYXNzIGtleVR5cGUsIENsYXNzIHZhbHVl\nVHlwZSwgYm9vbGVhbiB0cmFja0NoYW5nZXMsCiAgICAgICAgT3BlbkpQQUNv\nbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9rZXlUeXBlID0ga2V5VHlw\nZTsKICAgICAgICBfdmFsdWVUeXBlID0gdmFsdWVUeXBlOwogICAgICAgIGlm\nICh0cmFja0NoYW5nZXMpCiAgICAgICAgICAgIF9jdCA9IG5ldyBNYXBDaGFu\nZ2VUcmFja2VySW1wbCh0aGlzLCBjb25mKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRPd25lcihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBpbnQgZmll\nbGQpIHsKICAgICAgICBfc20gPSBzbTsKICAgICAgICBfZmllbGQgPSBmaWVs\nZDsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVN0YXRlTWFuYWdlciBnZXRP\nd25lcigpIHsKICAgICAgICByZXR1cm4gX3NtOwogICAgfQoKICAgIHB1Ymxp\nYyBpbnQgZ2V0T3duZXJGaWVsZCgpIHsKICAgICAgICByZXR1cm4gX2ZpZWxk\nOwogICAgfQoKICAgIHB1YmxpYyBDaGFuZ2VUcmFja2VyIGdldENoYW5nZVRy\nYWNrZXIoKSB7CiAgICAgICAgcmV0dXJuIF9jdDsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGNvcHkoT2JqZWN0IG9yaWcpIHsKICAgICAgICByZXR1cm4g\nbmV3IEhhc2h0YWJsZSgoTWFwKSBvcmlnKTsKICAgIH0KCiAgICBwdWJsaWMg\nUHJveHlNYXAgbmV3SW5zdGFuY2UoQ2xhc3Mga2V5VHlwZSwgQ2xhc3MgdmFs\ndWVUeXBlLAogICAgICAgIENvbXBhcmF0b3IgY29tcGFyZSwgYm9vbGVhbiB0\ncmFja0NoYW5nZXMsIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAg\nICAgICByZXR1cm4gbmV3IFByb3h5SGFzaHRhYmxlKGtleVR5cGUsIHZhbHVl\nVHlwZSwgdHJhY2tDaGFuZ2VzLCBjb25mKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjbGVhcigpIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwog\nICAgICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgX2N0LnN0b3BU\ncmFja2luZygpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IHN1cGVyLmVudHJ5U2V0KCkuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFw\nLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBQcm94aWVzLnJlbW92\nZWQodGhpcywgZW50cnkuZ2V0S2V5KCksIHRydWUpOwogICAgICAgICAgICBQ\ncm94aWVzLnJlbW92ZWQodGhpcywgZW50cnkuZ2V0VmFsdWUoKSwgZmFsc2Up\nOwogICAgICAgIH0KICAgICAgICBzdXBlci5jbGVhcigpOwogICAgfQoKICAg\nIHB1YmxpYyBTZXQga2V5U2V0KCkgewogICAgICAgIHJldHVybiBQcm94aWVz\nLmVudHJ5U2V0KHRoaXMsIHN1cGVyLmVudHJ5U2V0KCksIFByb3hpZXMuTU9E\nRV9LRVkpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIHZhbHVlcygp\nIHsKICAgICAgICByZXR1cm4gUHJveGllcy5lbnRyeVNldCh0aGlzLCBzdXBl\nci5lbnRyeVNldCgpLCBQcm94aWVzLk1PREVfVkFMVUUpOwogICAgfQoKICAg\nIHB1YmxpYyBTZXQgZW50cnlTZXQoKSB7CiAgICAgICAgcmV0dXJuIFByb3hp\nZXMuZW50cnlTZXQodGhpcywgc3VwZXIuZW50cnlTZXQoKSwgUHJveGllcy5N\nT0RFX0VOVFJZKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHB1dChPYmpl\nY3Qga2V5LCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBQcm94aWVzLmFzc2Vy\ndEFsbG93ZWRUeXBlKGtleSwgX2tleVR5cGUpOwogICAgICAgIFByb3hpZXMu\nYXNzZXJ0QWxsb3dlZFR5cGUodmFsdWUsIF92YWx1ZVR5cGUpOwogICAgICAg\nIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgYm9vbGVhbiBoYWQgPSBj\nb250YWluc0tleShrZXkpOwogICAgICAgIE9iamVjdCBvbGQgPSBzdXBlci5w\ndXQoa2V5LCB2YWx1ZSk7CiAgICAgICAgaWYgKGhhZCkgewogICAgICAgICAg\nICBpZiAoX2N0ICE9IG51bGwpCiAgICAgICAgICAgICAgICBfY3QuY2hhbmdl\nZChrZXksIG9sZCwgdmFsdWUpOwogICAgICAgICAgICBQcm94aWVzLnJlbW92\nZWQodGhpcywgb2xkLCBmYWxzZSk7CiAgICAgICAgfSBlbHNlIGlmIChfY3Qg\nIT0gbnVsbCkKICAgICAgICAgICAgX2N0LmFkZGVkKGtleSwgdmFsdWUpOwog\nICAgICAgIHJldHVybiBvbGQ7CiAgICB9CgogICAgcHVibGljIHZvaWQgcHV0\nQWxsKE1hcCBtKSB7CiAgICAgICAgTWFwLkVudHJ5IGVudHJ5OwogICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRyID0gbS5lbnRyeVNldCgpLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGVudHJ5ID0gKE1hcC5F\nbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAgcHV0KGVudHJ5LmdldEtl\neSgpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIE9iamVjdCByZW1vdmUoT2JqZWN0IGtleSkgewogICAgICAgIFBy\nb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgYm9vbGVhbiBoYWQgPSBjb250\nYWluc0tleShrZXkpOwogICAgICAgIE9iamVjdCBvbGQgPSBzdXBlci5yZW1v\ndmUoa2V5KTsKICAgICAgICBpZiAoaGFkKSB7CiAgICAgICAgICAgIGlmIChf\nY3QgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jdC5yZW1vdmVkKGtleSwg\nb2xkKTsKICAgICAgICAgICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIGtleSwg\ndHJ1ZSk7CiAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0aGlzLCBvbGQs\nIGZhbHNlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9sZDsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHdyaXRlUmVwbGFjZSgpCiAgICAgICAg\ndGhyb3dzIE9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9z\nbSAhPSBudWxsICYmIF9zbS5pc0RldGFjaGVkKCkpCiAgICAgICAgICAgIHJl\ndHVybiB0aGlzOwogICAgICAgIHJldHVybiBjb3B5KHRoaXMpOwogICAgfQp9\nCg==\n","encoding":"base64"}

