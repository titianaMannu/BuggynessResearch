{"sha":"4b2c17e328d7b4b171a3ad6944f0cefcf752f323","node_id":"MDQ6QmxvYjIwNjM2NDo0YjJjMTdlMzI4ZDdiNGIxNzFhM2FkNjk0NGYwY2VmY2Y3NTJmMzIz","size":6534,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4b2c17e328d7b4b171a3ad6944f0cefcf752f323","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRv\ncjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51\ndGlsLkxpc3RJdGVyYXRvcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKCi8qKgogKiBF\neHRlbnNpb24gb2YgdGhlIHtAbGluayBMaW5rZWRMaXN0fSB0eXBlIHRoYXQg\nZGlydGllcyB0aGUKICogcGVyc2lzdGVudC90cmFuc2FjdGlvbmFsIGZpZWxk\nIGl0IGlzIGFzc2lnbmVkIHRvIG9uIG1vZGlmaWNhdGlvbi4KICogVGhlIG5l\nZWQgdG8gZGlydHkgdGhlIGZpZWxkIG9uIDxiPmFueTwvYj4gbW9kaWZpY2F0\naW9uIG1hbmRhdGVzIHRoYXQKICogdGhpcyBjbGFzcyBtdXN0IG92ZXJyaWRl\nIGFsbCBtdXRhdG9yIG1ldGhvZHMgb2YgdGhlIGJhc2UgdHlwZS4KICogVGhp\ncyBtYXkgbGVhZCB0byBtdWx0aXBsZSBjYWxscyB0byA8Y29kZT5kaXJ0eTwv\nY29kZT4gZm9yIG9uZSBzdGF0ZQogKiBjaGFuZ2UgaWYgb25lIG11dGF0b3Ig\nbWV0aG9kIG9mIHRoZSBiYXNlIHR5cGUgY2FsbHMgYW5vdGhlci4KICoKICog\nQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNs\nYXNzIFByb3h5TGlua2VkTGlzdAogICAgZXh0ZW5kcyBMaW5rZWRMaXN0CiAg\nICBpbXBsZW1lbnRzIFByb3h5Q29sbGVjdGlvbiB7CgogICAgcHJpdmF0ZSB0\ncmFuc2llbnQgQ2xhc3MgX2VsZW1lbnRUeXBlID0gbnVsbDsKICAgIHByaXZh\ndGUgdHJhbnNpZW50IE9wZW5KUEFTdGF0ZU1hbmFnZXIgX3NtID0gbnVsbDsK\nICAgIHByaXZhdGUgdHJhbnNpZW50IGludCBfZmllbGQgPSAtMTsKICAgIHBy\naXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb25DaGFuZ2VUcmFja2VyIF9jdCA9\nIG51bGw7CgogICAgcHVibGljIFByb3h5TGlua2VkTGlzdCgpIHsKICAgIH0K\nCiAgICBwdWJsaWMgUHJveHlMaW5rZWRMaXN0KENsYXNzIGVsZW1lbnRUeXBl\nLCBib29sZWFuIHRyYWNrQ2hhbmdlcywKICAgICAgICBPcGVuSlBBQ29uZmln\ndXJhdGlvbiBjb25mKSB7CiAgICAgICAgX2VsZW1lbnRUeXBlID0gZWxlbWVu\ndFR5cGU7CiAgICAgICAgaWYgKHRyYWNrQ2hhbmdlcykKICAgICAgICAgICAg\nX2N0ID0gbmV3IENvbGxlY3Rpb25DaGFuZ2VUcmFja2VySW1wbCh0aGlzLCB0\ncnVlLCB0cnVlLCBjb25mKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRP\nd25lcihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBpbnQgZmllbGQpIHsKICAg\nICAgICBfc20gPSBzbTsKICAgICAgICBfZmllbGQgPSBmaWVsZDsKICAgIH0K\nCiAgICBwdWJsaWMgT3BlbkpQQVN0YXRlTWFuYWdlciBnZXRPd25lcigpIHsK\nICAgICAgICByZXR1cm4gX3NtOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0\nT3duZXJGaWVsZCgpIHsKICAgICAgICByZXR1cm4gX2ZpZWxkOwogICAgfQoK\nICAgIHB1YmxpYyBDaGFuZ2VUcmFja2VyIGdldENoYW5nZVRyYWNrZXIoKSB7\nCiAgICAgICAgcmV0dXJuIF9jdDsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0\nIGNvcHkoT2JqZWN0IG9yaWcpIHsKICAgICAgICByZXR1cm4gbmV3IExpbmtl\nZExpc3QoKENvbGxlY3Rpb24pIG9yaWcpOwogICAgfQoKICAgIHB1YmxpYyBQ\ncm94eUNvbGxlY3Rpb24gbmV3SW5zdGFuY2UoQ2xhc3MgZWxlbWVudFR5cGUs\nIENvbXBhcmF0b3IgY29tcGFyZSwKICAgICAgICBib29sZWFuIHRyYWNrQ2hh\nbmdlcywgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIHJl\ndHVybiBuZXcgUHJveHlMaW5rZWRMaXN0KGVsZW1lbnRUeXBlLCB0cmFja0No\nYW5nZXMsIGNvbmYpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZChpbnQg\naW5kZXgsIE9iamVjdCB2YWx1ZSkgewogICAgICAgIFByb3hpZXMuYXNzZXJ0\nQWxsb3dlZFR5cGUodmFsdWUsIF9lbGVtZW50VHlwZSk7CiAgICAgICAgUHJv\neGllcy5kaXJ0eSh0aGlzKTsKICAgICAgICBpZiAoX2N0ICE9IG51bGwpCiAg\nICAgICAgICAgIF9jdC5zdG9wVHJhY2tpbmcoKTsKICAgICAgICBzdXBlci5h\nZGQoaW5kZXgsIHZhbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBh\nZGQoT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgUHJveGllcy5hc3NlcnRBbGxv\nd2VkVHlwZSh2YWx1ZSwgX2VsZW1lbnRUeXBlKTsKICAgICAgICBQcm94aWVz\nLmRpcnR5KHRoaXMpOwogICAgICAgIGlmIChzdXBlci5hZGQodmFsdWUpKSB7\nCiAgICAgICAgICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIF9jdC5hZGRlZCh2YWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgYWRkRmlyc3QoT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgUHJv\neGllcy5hc3NlcnRBbGxvd2VkVHlwZSh2YWx1ZSwgX2VsZW1lbnRUeXBlKTsK\nICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwogICAgICAgIHN1cGVyLmFk\nZEZpcnN0KHZhbHVlKTsKICAgICAgICBpZiAoX2N0ICE9IG51bGwpCiAgICAg\nICAgICAgIF9jdC5zdG9wVHJhY2tpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBhZGRMYXN0KE9iamVjdCB2YWx1ZSkgewogICAgICAgIFByb3hpZXMu\nYXNzZXJ0QWxsb3dlZFR5cGUodmFsdWUsIF9lbGVtZW50VHlwZSk7CiAgICAg\nICAgUHJveGllcy5kaXJ0eSh0aGlzKTsKICAgICAgICBzdXBlci5hZGRMYXN0\nKHZhbHVlKTsKICAgICAgICBpZiAoX2N0ICE9IG51bGwpCiAgICAgICAgICAg\nIF9jdC5hZGRlZCh2YWx1ZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\nYWRkQWxsKGludCBpbmRleCwgQ29sbGVjdGlvbiB2YWx1ZXMpIHsKICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHZhbHVlcy5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOyBpbmRleCsrKQogICAgICAgICAgICBhZGQoaW5kZXgsIGl0\nci5uZXh0KCkpOwogICAgICAgIHJldHVybiB2YWx1ZXMuc2l6ZSgpID4gMDsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBhZGRBbGwoQ29sbGVjdGlvbiB2\nYWx1ZXMpIHsKICAgICAgICBib29sZWFuIGFkZGVkID0gZmFsc2U7CiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSB2YWx1ZXMuaXRlcmF0b3IoKTsgaXRy\nLmhhc05leHQoKTspCiAgICAgICAgICAgIGFkZGVkID0gYWRkKGl0ci5uZXh0\nKCkpIHx8IGFkZGVkOwogICAgICAgIHJldHVybiBhZGRlZDsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBQcm94aWVzLmRpcnR5\nKHRoaXMpOwogICAgICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAg\nX2N0LnN0b3BUcmFja2luZygpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gc3VwZXIuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAg\nICAgIFByb3hpZXMucmVtb3ZlZCh0aGlzLCBpdHIubmV4dCgpLCBmYWxzZSk7\nCiAgICAgICAgc3VwZXIuY2xlYXIoKTsKICAgIH0KCiAgICBwdWJsaWMgSXRl\ncmF0b3IgaXRlcmF0b3IoKSB7CiAgICAgICAgcmV0dXJuIFByb3hpZXMuaXRl\ncmF0b3IodGhpcywgc3VwZXIuaXRlcmF0b3IoKSk7CiAgICB9CgogICAgcHVi\nbGljIExpc3RJdGVyYXRvciBsaXN0SXRlcmF0b3IoKSB7CiAgICAgICAgcmV0\ndXJuIFByb3hpZXMubGlzdEl0ZXJhdG9yKHRoaXMsIHN1cGVyLmxpc3RJdGVy\nYXRvcigpLCBfZWxlbWVudFR5cGUpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0\nSXRlcmF0b3IgbGlzdEl0ZXJhdG9yKGludCBpbmRleCkgewogICAgICAgIHJl\ndHVybiBQcm94aWVzLmxpc3RJdGVyYXRvcih0aGlzLCBzdXBlci5saXN0SXRl\ncmF0b3IoaW5kZXgpLAogICAgICAgICAgICBfZWxlbWVudFR5cGUpOwogICAg\nfQoKICAgIHB1YmxpYyBPYmplY3QgcmVtb3ZlKGludCBpbmRleCkgewogICAg\nICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgT2JqZWN0IHJlbSA9\nIHN1cGVyLnJlbW92ZShpbmRleCk7CiAgICAgICAgaWYgKF9jdCAhPSBudWxs\nKQogICAgICAgICAgICBfY3QucmVtb3ZlZChyZW0pOwogICAgICAgIFByb3hp\nZXMucmVtb3ZlZCh0aGlzLCByZW0sIGZhbHNlKTsKICAgICAgICByZXR1cm4g\ncmVtOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZShPYmplY3Qg\nbykgewogICAgICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgaWYg\nKHN1cGVyLnJlbW92ZShvKSkgewogICAgICAgICAgICBpZiAoX2N0ICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBfY3QucmVtb3ZlZChvKTsKICAgICAgICAg\nICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIG8sIGZhbHNlKTsKICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHJlbW92ZUZpcnN0KCkgewog\nICAgICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgT2JqZWN0IHJl\nbSA9IHN1cGVyLnJlbW92ZUZpcnN0KCk7CiAgICAgICAgaWYgKF9jdCAhPSBu\ndWxsKQogICAgICAgICAgICBfY3QucmVtb3ZlZChyZW0pOwogICAgICAgIFBy\nb3hpZXMucmVtb3ZlZCh0aGlzLCByZW0sIGZhbHNlKTsKICAgICAgICByZXR1\ncm4gcmVtOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgcmVtb3ZlTGFzdCgp\nIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwogICAgICAgIE9iamVj\ndCByZW0gPSBzdXBlci5yZW1vdmVMYXN0KCk7CiAgICAgICAgaWYgKF9jdCAh\nPSBudWxsKQogICAgICAgICAgICBfY3QucmVtb3ZlZChyZW0pOwogICAgICAg\nIFByb3hpZXMucmVtb3ZlZCh0aGlzLCByZW0sIGZhbHNlKTsKICAgICAgICBy\nZXR1cm4gcmVtOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUFs\nbChDb2xsZWN0aW9uIGMpIHsKICAgICAgICBib29sZWFuIHJlbW92ZWQgPSBm\nYWxzZTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGMuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgIHJlbW92ZWQgPSByZW1v\ndmUoaXRyLm5leHQoKSkgfHwgcmVtb3ZlZDsKICAgICAgICByZXR1cm4gcmVt\nb3ZlZDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiByZXRhaW5BbGwoQ29s\nbGVjdGlvbiBjKSB7CiAgICAgICAgaW50IHNpemUgPSBzaXplKCk7CiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBpdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykKICAgICAgICAgICAgaWYgKCFjLmNvbnRhaW5zKGl0ci5uZXh0KCkp\nKQogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAgICAgIHJldHVy\nbiBzaXplKCkgPCBzaXplOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qgc2V0\nKGludCBpbmRleCwgT2JqZWN0IGVsZW1lbnQpIHsKICAgICAgICBQcm94aWVz\nLmFzc2VydEFsbG93ZWRUeXBlKGVsZW1lbnQsIF9lbGVtZW50VHlwZSk7CiAg\nICAgICAgUHJveGllcy5kaXJ0eSh0aGlzKTsKICAgICAgICBpZiAoX2N0ICE9\nIG51bGwpCiAgICAgICAgICAgIF9jdC5zdG9wVHJhY2tpbmcoKTsKICAgICAg\nICBPYmplY3QgcmVtID0gc3VwZXIuc2V0KGluZGV4LCBlbGVtZW50KTsKICAg\nICAgICBpZiAocmVtICE9IGVsZW1lbnQpCiAgICAgICAgICAgIFByb3hpZXMu\ncmVtb3ZlZCh0aGlzLCByZW0sIGZhbHNlKTsKICAgICAgICByZXR1cm4gcmVt\nOwogICAgfQoKICAgIHByb3RlY3RlZCBPYmplY3Qgd3JpdGVSZXBsYWNlKCkK\nICAgICAgICB0aHJvd3MgT2JqZWN0U3RyZWFtRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAoX3NtICE9IG51bGwgJiYgX3NtLmlzRGV0YWNoZWQoKSkKICAgICAg\nICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgcmV0dXJuIGNvcHkodGhpcyk7\nCiAgICB9Cn0K\n","encoding":"base64"}

