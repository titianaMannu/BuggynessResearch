{"sha":"399d4d66513e627554cf4af63af56389e24666b3","node_id":"MDQ6QmxvYjIwNjM2NDozOTlkNGQ2NjUxM2U2Mjc1NTRjZjRhZjYzYWY1NjM4OWUyNDY2NmIz","size":4738,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/399d4d66513e627554cf4af63af56389e24666b3","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLmlvLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5PYmpl\nY3RTdHJlYW1FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9yOwppbXBvcnQgamF2YS51\ndGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQ\nQVN0YXRlTWFuYWdlcjsKCi8qKgogKiBFeHRlbnNpb24gb2YgdGhlIHtAbGlu\nayBQcm9wZXJ0aWVzfSB0eXBlIHRoYXQgZGlydGllcyB0aGUKICogcGVyc2lz\ndGVudC90cmFuc2FjdGlvbmFsIGZpZWxkIGl0IGlzIGFzc2lnbmVkIHRvIG9u\nIG1vZGlmaWNhdGlvbi4KICogVGhlIG5lZWQgdG8gZGlydHkgdGhlIGZpZWxk\nIG9uIDxiPmFueTwvYj4gbW9kaWZpY2F0aW9uIG1hbmRhdGVzIHRoYXQKICog\ndGhpcyBjbGFzcyBtdXN0IG92ZXJyaWRlIGFsbCBtdXRhdG9yIG1ldGhvZHMg\nb2YgdGhlIGJhc2UgdHlwZS4KICogVGhpcyBtYXkgbGVhZCB0byBtdWx0aXBs\nZSBjYWxscyB0byA8Y29kZT5kaXJ0eTwvY29kZT4gZm9yIG9uZSBzdGF0ZQog\nKiBjaGFuZ2UgaWYgb25lIG11dGF0b3IgbWV0aG9kIG9mIHRoZSBiYXNlIHR5\ncGUgY2FsbHMgYW5vdGhlci4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICog\nQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFByb3h5UHJvcGVydGllcwog\nICAgZXh0ZW5kcyBQcm9wZXJ0aWVzCiAgICBpbXBsZW1lbnRzIFByb3h5TWFw\nIHsKCiAgICBwcml2YXRlIHRyYW5zaWVudCBPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIF9zbSA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBpbnQgX2ZpZWxk\nID0gLTE7CiAgICBwcml2YXRlIHRyYW5zaWVudCBNYXBDaGFuZ2VUcmFja2Vy\nIF9jdCA9IG51bGw7CgogICAgcHVibGljIFByb3h5UHJvcGVydGllcygpIHsK\nICAgIH0KCiAgICBwdWJsaWMgUHJveHlQcm9wZXJ0aWVzKGJvb2xlYW4gdHJh\nY2tDaGFuZ2VzLCBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAg\nICAgaWYgKHRyYWNrQ2hhbmdlcykKICAgICAgICAgICAgX2N0ID0gbmV3IE1h\ncENoYW5nZVRyYWNrZXJJbXBsKHRoaXMsIGNvbmYpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldE93bmVyKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIGlu\ndCBmaWVsZCkgewogICAgICAgIF9zbSA9IHNtOwogICAgICAgIF9maWVsZCA9\nIGZpZWxkOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIGdldE93bmVyKCkgewogICAgICAgIHJldHVybiBfc207CiAgICB9CgogICAg\ncHVibGljIGludCBnZXRPd25lckZpZWxkKCkgewogICAgICAgIHJldHVybiBf\nZmllbGQ7CiAgICB9CgogICAgcHVibGljIENoYW5nZVRyYWNrZXIgZ2V0Q2hh\nbmdlVHJhY2tlcigpIHsKICAgICAgICByZXR1cm4gX2N0OwogICAgfQoKICAg\nIHB1YmxpYyBPYmplY3QgY29weShPYmplY3Qgb3JpZykgewogICAgICAgIFBy\nb3BlcnRpZXMgcHJvcHMgPSBuZXcgUHJvcGVydGllcygpOwogICAgICAgIHBy\nb3BzLnB1dEFsbCgoTWFwKSBvcmlnKTsKICAgICAgICByZXR1cm4gcHJvcHM7\nCiAgICB9CgogICAgcHVibGljIFByb3h5TWFwIG5ld0luc3RhbmNlKENsYXNz\nIGtleVR5cGUsIENsYXNzIHZhbHVlVHlwZSwKICAgICAgICBDb21wYXJhdG9y\nIGNvbXBhcmUsIGJvb2xlYW4gdHJhY2tDaGFuZ2VzLCBPcGVuSlBBQ29uZmln\ndXJhdGlvbiBjb25mKSB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm94eVByb3Bl\ncnRpZXModHJhY2tDaGFuZ2VzLCBjb25mKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjbGVhcigpIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwog\nICAgICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgX2N0LnN0b3BU\ncmFja2luZygpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IHN1cGVyLmVudHJ5U2V0KCkuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFw\nLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBQcm94aWVzLnJlbW92\nZWQodGhpcywgZW50cnkuZ2V0S2V5KCksIHRydWUpOwogICAgICAgICAgICBQ\ncm94aWVzLnJlbW92ZWQodGhpcywgZW50cnkuZ2V0VmFsdWUoKSwgZmFsc2Up\nOwogICAgICAgIH0KICAgICAgICBzdXBlci5jbGVhcigpOwogICAgfQoKICAg\nIHB1YmxpYyBTZXQga2V5U2V0KCkgewogICAgICAgIHJldHVybiBQcm94aWVz\nLmVudHJ5U2V0KHRoaXMsIHN1cGVyLmVudHJ5U2V0KCksIFByb3hpZXMuTU9E\nRV9LRVkpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIHZhbHVlcygp\nIHsKICAgICAgICByZXR1cm4gUHJveGllcy5lbnRyeVNldCh0aGlzLCBzdXBl\nci5lbnRyeVNldCgpLCBQcm94aWVzLk1PREVfVkFMVUUpOwogICAgfQoKICAg\nIHB1YmxpYyBTZXQgZW50cnlTZXQoKSB7CiAgICAgICAgcmV0dXJuIFByb3hp\nZXMuZW50cnlTZXQodGhpcywgc3VwZXIuZW50cnlTZXQoKSwgUHJveGllcy5N\nT0RFX0VOVFJZKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHB1dChPYmpl\nY3Qga2V5LCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBQcm94aWVzLmRpcnR5\nKHRoaXMpOwogICAgICAgIGJvb2xlYW4gaGFkID0gY29udGFpbnNLZXkoa2V5\nKTsKICAgICAgICBPYmplY3Qgb2xkID0gc3VwZXIucHV0KGtleSwgdmFsdWUp\nOwogICAgICAgIGlmIChoYWQpIHsKICAgICAgICAgICAgaWYgKF9jdCAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgX2N0LmNoYW5nZWQoa2V5LCBvbGQsIHZh\nbHVlKTsKICAgICAgICAgICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIG9sZCwg\nZmFsc2UpOwogICAgICAgIH0gZWxzZSBpZiAoX2N0ICE9IG51bGwpCiAgICAg\nICAgICAgIF9jdC5hZGRlZChrZXksIHZhbHVlKTsKICAgICAgICByZXR1cm4g\nb2xkOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHB1dEFsbChNYXAgbSkgewog\nICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IG0uZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIHB1dChlbnRyeS5nZXRLZXkoKSwgZW50cnkuZ2V0\nVmFsdWUoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\ncmVtb3ZlKE9iamVjdCBrZXkpIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRo\naXMpOwogICAgICAgIGJvb2xlYW4gaGFkID0gY29udGFpbnNLZXkoa2V5KTsK\nICAgICAgICBPYmplY3Qgb2xkID0gc3VwZXIucmVtb3ZlKGtleSk7CiAgICAg\nICAgaWYgKGhhZCkgewogICAgICAgICAgICBpZiAoX2N0ICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBfY3QucmVtb3ZlZChrZXksIG9sZCk7CiAgICAgICAg\nICAgIFByb3hpZXMucmVtb3ZlZCh0aGlzLCBrZXksIHRydWUpOwogICAgICAg\nICAgICBQcm94aWVzLnJlbW92ZWQodGhpcywgb2xkLCBmYWxzZSk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBvbGQ7CiAgICB9CgogICAgcHVibGljIE9i\namVjdCBzZXRQcm9wZXJ0eShTdHJpbmcga2V5LCBTdHJpbmcgdmFsdWUpIHsK\nICAgICAgICByZXR1cm4gcHV0KGtleSwgdmFsdWUpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGxvYWQoSW5wdXRTdHJlYW0gaW4pCiAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2N0ICE9IG51bGwpCiAgICAg\nICAgICAgIF9jdC5zdG9wVHJhY2tpbmcoKTsKICAgICAgICBzdXBlci5sb2Fk\nKGluKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHdyaXRlUmVwbGFj\nZSgpCiAgICAgICAgdGhyb3dzIE9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKF9zbSAhPSBudWxsICYmIF9zbS5pc0RldGFjaGVkKCkpCiAg\nICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIHJldHVybiBjb3B5KHRo\naXMpOwogICAgfQp9Cg==\n","encoding":"base64"}

