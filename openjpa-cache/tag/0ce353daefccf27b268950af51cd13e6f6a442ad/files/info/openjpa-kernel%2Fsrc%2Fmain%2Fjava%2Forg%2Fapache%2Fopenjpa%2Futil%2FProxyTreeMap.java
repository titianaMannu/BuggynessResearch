{"sha":"521d0388ad593f53202942fbb8f24aae636a0b4f","node_id":"MDQ6QmxvYjIwNjM2NDo1MjFkMDM4OGFkNTkzZjUzMjAyOTQyZmJiOGYyNGFhZTYzNmEwYjRm","size":5217,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/521d0388ad593f53202942fbb8f24aae636a0b4f","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRv\ncjsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0\nOwppbXBvcnQgamF2YS51dGlsLlNvcnRlZE1hcDsKaW1wb3J0IGphdmEudXRp\nbC5UcmVlTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9w\nZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwoKLyoqCiAqIEV4dGVuc2lv\nbiBvZiB0aGUge0BsaW5rIFRyZWVNYXB9IHR5cGUgdGhhdCBkaXJ0aWVzIHRo\nZQogKiBwZXJzaXN0ZW50L3RyYW5zYWN0aW9uYWwgZmllbGQgaXQgaXMgYXNz\naWduZWQgdG8gb24gbW9kaWZpY2F0aW9uLgogKiBUaGUgbmVlZCB0byBkaXJ0\neSB0aGUgZmllbGQgb24gPGI+YW55PC9iPiBtb2RpZmljYXRpb24gbWFuZGF0\nZXMgdGhhdAogKiB0aGlzIGNsYXNzIG11c3Qgb3ZlcnJpZGUgYWxsIG11dGF0\nb3IgbWV0aG9kcyBvZiB0aGUgYmFzZSB0eXBlLgogKiBUaGlzIG1heSBsZWFk\nIHRvIG11bHRpcGxlIGNhbGxzIHRvIDxjb2RlPmRpcnR5PC9jb2RlPiBmb3Ig\nb25lIHN0YXRlCiAqIGNoYW5nZSBpZiBvbmUgbXV0YXRvciBtZXRob2Qgb2Yg\ndGhlIGJhc2UgdHlwZSBjYWxscyBhbm90aGVyLgogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgUHJveHlU\ncmVlTWFwCiAgICBleHRlbmRzIFRyZWVNYXAKICAgIGltcGxlbWVudHMgUHJv\neHlNYXAgewoKICAgIHByaXZhdGUgdHJhbnNpZW50IENsYXNzIF9rZXlUeXBl\nID0gbnVsbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IENsYXNzIF92YWx1ZVR5\ncGUgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgT3BlbkpQQVN0YXRl\nTWFuYWdlciBfc20gPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgaW50\nIF9maWVsZCA9IC0xOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgTWFwQ2hhbmdl\nVHJhY2tlciBfY3QgPSBudWxsOwoKICAgIHB1YmxpYyBQcm94eVRyZWVNYXAo\nKSB7CiAgICB9CgogICAgcHVibGljIFByb3h5VHJlZU1hcChDbGFzcyBrZXlU\neXBlLCBDbGFzcyB2YWx1ZVR5cGUsIGJvb2xlYW4gdHJhY2tDaGFuZ2VzLAog\nICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBf\na2V5VHlwZSA9IGtleVR5cGU7CiAgICAgICAgX3ZhbHVlVHlwZSA9IHZhbHVl\nVHlwZTsKICAgICAgICBpZiAodHJhY2tDaGFuZ2VzKQogICAgICAgICAgICBf\nY3QgPSBuZXcgTWFwQ2hhbmdlVHJhY2tlckltcGwodGhpcywgY29uZik7CiAg\nICB9CgogICAgcHVibGljIFByb3h5VHJlZU1hcChDbGFzcyBrZXlUeXBlLCBD\nbGFzcyB2YWx1ZVR5cGUsIENvbXBhcmF0b3IgY29tcGFyZSwKICAgICAgICBi\nb29sZWFuIHRyYWNrQ2hhbmdlcywgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29u\nZikgewogICAgICAgIHN1cGVyKGNvbXBhcmUpOwogICAgICAgIF9rZXlUeXBl\nID0ga2V5VHlwZTsKICAgICAgICBfdmFsdWVUeXBlID0gdmFsdWVUeXBlOwog\nICAgICAgIGlmICh0cmFja0NoYW5nZXMpCiAgICAgICAgICAgIF9jdCA9IG5l\ndyBNYXBDaGFuZ2VUcmFja2VySW1wbCh0aGlzLCBjb25mKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRPd25lcihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBpbnQgZmllbGQpIHsKICAgICAgICBfc20gPSBzbTsKICAgICAgICBfZmll\nbGQgPSBmaWVsZDsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVN0YXRlTWFu\nYWdlciBnZXRPd25lcigpIHsKICAgICAgICByZXR1cm4gX3NtOwogICAgfQoK\nICAgIHB1YmxpYyBpbnQgZ2V0T3duZXJGaWVsZCgpIHsKICAgICAgICByZXR1\ncm4gX2ZpZWxkOwogICAgfQoKICAgIHB1YmxpYyBDaGFuZ2VUcmFja2VyIGdl\ndENoYW5nZVRyYWNrZXIoKSB7CiAgICAgICAgcmV0dXJuIF9jdDsKICAgIH0K\nCiAgICBwdWJsaWMgT2JqZWN0IGNvcHkoT2JqZWN0IG9yaWcpIHsKICAgICAg\nICBpZiAob3JpZyBpbnN0YW5jZW9mIFNvcnRlZE1hcCkKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBUcmVlTWFwKChTb3J0ZWRNYXApIG9yaWcpOwogICAgICAg\nIHJldHVybiBuZXcgVHJlZU1hcCgoTWFwKSBvcmlnKTsKICAgIH0KCiAgICBw\ndWJsaWMgUHJveHlNYXAgbmV3SW5zdGFuY2UoQ2xhc3Mga2V5VHlwZSwgQ2xh\nc3MgdmFsdWVUeXBlLAogICAgICAgIENvbXBhcmF0b3IgY29tcGFyZSwgYm9v\nbGVhbiB0cmFja0NoYW5nZXMsIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBpZiAoY29tcGFyZSA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbmV3IFByb3h5VHJlZU1hcChrZXlUeXBlLCB2YWx1ZVR5cGUsIHRy\nYWNrQ2hhbmdlcywgY29uZik7CiAgICAgICAgcmV0dXJuIG5ldyBQcm94eVRy\nZWVNYXAoa2V5VHlwZSwgdmFsdWVUeXBlLCBjb21wYXJlLCB0cmFja0NoYW5n\nZXMsCiAgICAgICAgICAgIGNvbmYpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGNsZWFyKCkgewogICAgICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAg\nICAgaWYgKF9jdCAhPSBudWxsKQogICAgICAgICAgICBfY3Quc3RvcFRyYWNr\naW5nKCk7CiAgICAgICAgTWFwLkVudHJ5IGVudHJ5OwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gc3VwZXIuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBp\ndHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50\ncnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0\naGlzLCBlbnRyeS5nZXRLZXkoKSwgdHJ1ZSk7CiAgICAgICAgICAgIFByb3hp\nZXMucmVtb3ZlZCh0aGlzLCBlbnRyeS5nZXRWYWx1ZSgpLCBmYWxzZSk7CiAg\nICAgICAgfQogICAgICAgIHN1cGVyLmNsZWFyKCk7CiAgICB9CgogICAgcHVi\nbGljIFNldCBrZXlTZXQoKSB7CiAgICAgICAgcmV0dXJuIFByb3hpZXMuZW50\ncnlTZXQodGhpcywgc3VwZXIuZW50cnlTZXQoKSwgUHJveGllcy5NT0RFX0tF\nWSk7CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gdmFsdWVzKCkgewog\nICAgICAgIHJldHVybiBQcm94aWVzLmVudHJ5U2V0KHRoaXMsIHN1cGVyLmVu\ndHJ5U2V0KCksIFByb3hpZXMuTU9ERV9WQUxVRSk7CiAgICB9CgogICAgcHVi\nbGljIFNldCBlbnRyeVNldCgpIHsKICAgICAgICByZXR1cm4gUHJveGllcy5l\nbnRyeVNldCh0aGlzLCBzdXBlci5lbnRyeVNldCgpLCBQcm94aWVzLk1PREVf\nRU5UUlkpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgcHV0KE9iamVjdCBr\nZXksIE9iamVjdCB2YWx1ZSkgewogICAgICAgIFByb3hpZXMuYXNzZXJ0QWxs\nb3dlZFR5cGUoa2V5LCBfa2V5VHlwZSk7CiAgICAgICAgUHJveGllcy5hc3Nl\ncnRBbGxvd2VkVHlwZSh2YWx1ZSwgX3ZhbHVlVHlwZSk7CiAgICAgICAgUHJv\neGllcy5kaXJ0eSh0aGlzKTsKICAgICAgICBib29sZWFuIGhhZCA9IGNvbnRh\naW5zS2V5KGtleSk7CiAgICAgICAgT2JqZWN0IG9sZCA9IHN1cGVyLnB1dChr\nZXksIHZhbHVlKTsKICAgICAgICBpZiAoaGFkKSB7CiAgICAgICAgICAgIGlm\nIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jdC5jaGFuZ2VkKGtl\neSwgb2xkLCB2YWx1ZSk7CiAgICAgICAgICAgIFByb3hpZXMucmVtb3ZlZCh0\naGlzLCBvbGQsIGZhbHNlKTsKICAgICAgICB9IGVsc2UgaWYgKF9jdCAhPSBu\ndWxsKQogICAgICAgICAgICBfY3QuYWRkZWQoa2V5LCB2YWx1ZSk7CiAgICAg\nICAgcmV0dXJuIG9sZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwdXRBbGwo\nTWFwIG0pIHsKICAgICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAgZm9y\nIChJdGVyYXRvciBpdHIgPSBtLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRy\nLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFwLkVudHJ5\nKSBpdHIubmV4dCgpOwogICAgICAgICAgICBwdXQoZW50cnkuZ2V0S2V5KCks\nIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IHJlbW92ZShPYmplY3Qga2V5KSB7CiAgICAgICAgUHJveGll\ncy5kaXJ0eSh0aGlzKTsKICAgICAgICBib29sZWFuIGhhZCA9IGNvbnRhaW5z\nS2V5KGtleSk7CiAgICAgICAgT2JqZWN0IG9sZCA9IHN1cGVyLnJlbW92ZShr\nZXkpOwogICAgICAgIGlmIChoYWQpIHsKICAgICAgICAgICAgaWYgKF9jdCAh\nPSBudWxsKQogICAgICAgICAgICAgICAgX2N0LnJlbW92ZWQoa2V5LCBvbGQp\nOwogICAgICAgICAgICBQcm94aWVzLnJlbW92ZWQodGhpcywga2V5LCB0cnVl\nKTsKICAgICAgICAgICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIG9sZCwgZmFs\nc2UpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gb2xkOwogICAgfQoKICAg\nIHByb3RlY3RlZCBPYmplY3Qgd3JpdGVSZXBsYWNlKCkKICAgICAgICB0aHJv\nd3MgT2JqZWN0U3RyZWFtRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX3NtICE9\nIG51bGwgJiYgX3NtLmlzRGV0YWNoZWQoKSkKICAgICAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICAgICAgcmV0dXJuIGNvcHkodGhpcyk7CiAgICB9Cn0K\n","encoding":"base64"}

