{"sha":"3447b30d5963e2ffa260ef761b89da3f2ed60572","node_id":"MDQ6QmxvYjIwNjM2NDozNDQ3YjMwZDU5NjNlMmZmYTI2MGVmNzYxYjg5ZGEzZjJlZDYwNTcy","size":7227,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3447b30d5963e2ffa260ef761b89da3f2ed60572","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRv\ncjsKaW1wb3J0IGphdmEudXRpbC5MaXN0SXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuVmVjdG9yOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwoKLyoqCiAqIEV4dGVu\nc2lvbiBvZiB0aGUge0BsaW5rIFZlY3Rvcn0gdHlwZSB0aGF0IGRpcnRpZXMg\ndGhlCiAqIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25hbCBmaWVsZCBpdCBpcyBh\nc3NpZ25lZCB0byBvbiBtb2RpZmljYXRpb24uCiAqIFRoZSBuZWVkIHRvIGRp\ncnR5IHRoZSBmaWVsZCBvbiA8Yj5hbnk8L2I+IG1vZGlmaWNhdGlvbiBtYW5k\nYXRlcyB0aGF0CiAqIHRoaXMgY2xhc3MgbXVzdCBvdmVycmlkZSBhbGwgbXV0\nYXRvciBtZXRob2RzIG9mIHRoZSBiYXNlIHR5cGUuCiAqIFRoaXMgbWF5IGxl\nYWQgdG8gbXVsdGlwbGUgY2FsbHMgdG8gPGNvZGU+ZGlydHk8L2NvZGU+IGZv\nciBvbmUgc3RhdGUKICogY2hhbmdlIGlmIG9uZSBtdXRhdG9yIG1ldGhvZCBv\nZiB0aGUgYmFzZSB0eXBlIGNhbGxzIGFub3RoZXIuCiAqCiAqIEBhdXRob3Ig\nQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBQcm94\neVZlY3RvcgogICAgZXh0ZW5kcyBWZWN0b3IKICAgIGltcGxlbWVudHMgUHJv\neHlDb2xsZWN0aW9uIHsKCiAgICBwcml2YXRlIHRyYW5zaWVudCBDbGFzcyBf\nZWxlbWVudFR5cGUgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgT3Bl\nbkpQQVN0YXRlTWFuYWdlciBfc20gPSBudWxsOwogICAgcHJpdmF0ZSB0cmFu\nc2llbnQgaW50IF9maWVsZCA9IC0xOwogICAgcHJpdmF0ZSB0cmFuc2llbnQg\nQ29sbGVjdGlvbkNoYW5nZVRyYWNrZXIgX2N0ID0gbnVsbDsKCiAgICBwdWJs\naWMgUHJveHlWZWN0b3IoKSB7CiAgICB9CgogICAgcHVibGljIFByb3h5VmVj\ndG9yKENsYXNzIGVsZW1lbnRUeXBlLCBib29sZWFuIHRyYWNrQ2hhbmdlcywK\nICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAg\nX2VsZW1lbnRUeXBlID0gZWxlbWVudFR5cGU7CiAgICAgICAgaWYgKHRyYWNr\nQ2hhbmdlcykKICAgICAgICAgICAgX2N0ID0gbmV3IENvbGxlY3Rpb25DaGFu\nZ2VUcmFja2VySW1wbCh0aGlzLCB0cnVlLCB0cnVlLCBjb25mKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRPd25lcihPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIHNtLCBpbnQgZmllbGQpIHsKICAgICAgICBfc20gPSBzbTsKICAgICAgICBf\nZmllbGQgPSBmaWVsZDsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVN0YXRl\nTWFuYWdlciBnZXRPd25lcigpIHsKICAgICAgICByZXR1cm4gX3NtOwogICAg\nfQoKICAgIHB1YmxpYyBpbnQgZ2V0T3duZXJGaWVsZCgpIHsKICAgICAgICBy\nZXR1cm4gX2ZpZWxkOwogICAgfQoKICAgIHB1YmxpYyBDaGFuZ2VUcmFja2Vy\nIGdldENoYW5nZVRyYWNrZXIoKSB7CiAgICAgICAgcmV0dXJuIF9jdDsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGNvcHkoT2JqZWN0IG9yaWcpIHsKICAg\nICAgICByZXR1cm4gbmV3IFZlY3RvcigoQ29sbGVjdGlvbikgb3JpZyk7CiAg\nICB9CgogICAgcHVibGljIFByb3h5Q29sbGVjdGlvbiBuZXdJbnN0YW5jZShD\nbGFzcyBlbGVtZW50VHlwZSwgQ29tcGFyYXRvciBjb21wYXJlLAogICAgICAg\nIGJvb2xlYW4gdHJhY2tDaGFuZ2VzLCBPcGVuSlBBQ29uZmlndXJhdGlvbiBj\nb25mKSB7CiAgICAgICAgcmV0dXJuIG5ldyBQcm94eVZlY3RvcihlbGVtZW50\nVHlwZSwgdHJhY2tDaGFuZ2VzLCBjb25mKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBhZGQoaW50IGluZGV4LCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBQ\ncm94aWVzLmFzc2VydEFsbG93ZWRUeXBlKHZhbHVlLCBfZWxlbWVudFR5cGUp\nOwogICAgICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgaWYgKF9j\ndCAhPSBudWxsKQogICAgICAgICAgICBfY3Quc3RvcFRyYWNraW5nKCk7CiAg\nICAgICAgc3VwZXIuYWRkKGluZGV4LCB2YWx1ZSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgaW5zZXJ0RWxlbWVudEF0KE9iamVjdCB2YWx1ZSwgaW50IGlu\nZGV4KSB7CiAgICAgICAgUHJveGllcy5hc3NlcnRBbGxvd2VkVHlwZSh2YWx1\nZSwgX2VsZW1lbnRUeXBlKTsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMp\nOwogICAgICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgX2N0LnN0\nb3BUcmFja2luZygpOwogICAgICAgIHN1cGVyLmluc2VydEVsZW1lbnRBdCh2\nYWx1ZSwgaW5kZXgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGFkZChP\nYmplY3QgdmFsdWUpIHsKICAgICAgICBQcm94aWVzLmFzc2VydEFsbG93ZWRU\neXBlKHZhbHVlLCBfZWxlbWVudFR5cGUpOwogICAgICAgIFByb3hpZXMuZGly\ndHkodGhpcyk7CiAgICAgICAgaWYgKHN1cGVyLmFkZCh2YWx1ZSkpIHsKICAg\nICAgICAgICAgaWYgKF9jdCAhPSBudWxsKQogICAgICAgICAgICAgICAgX2N0\nLmFkZGVkKHZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBhZGRFbGVtZW50KE9iamVjdCB2YWx1ZSkgewogICAgICAgIFByb3hp\nZXMuYXNzZXJ0QWxsb3dlZFR5cGUodmFsdWUsIF9lbGVtZW50VHlwZSk7CiAg\nICAgICAgUHJveGllcy5kaXJ0eSh0aGlzKTsKICAgICAgICBzdXBlci5hZGRF\nbGVtZW50KHZhbHVlKTsKICAgICAgICBpZiAoX2N0ICE9IG51bGwpCiAgICAg\nICAgICAgIF9jdC5hZGRlZCh2YWx1ZSk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gYWRkQWxsKGludCBpbmRleCwgQ29sbGVjdGlvbiB2YWx1ZXMpIHsK\nICAgICAgICBlbnN1cmVDYXBhY2l0eShzaXplKCkgKyB2YWx1ZXMuc2l6ZSgp\nKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHZhbHVlcy5pdGVyYXRv\ncigpOyBpdHIuaGFzTmV4dCgpOyBpbmRleCsrKQogICAgICAgICAgICBhZGQo\naW5kZXgsIGl0ci5uZXh0KCkpOwogICAgICAgIHJldHVybiB2YWx1ZXMuc2l6\nZSgpID4gMDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBhZGRBbGwoQ29s\nbGVjdGlvbiB2YWx1ZXMpIHsKICAgICAgICBlbnN1cmVDYXBhY2l0eShzaXpl\nKCkgKyB2YWx1ZXMuc2l6ZSgpKTsKICAgICAgICBib29sZWFuIGFkZGVkID0g\nZmFsc2U7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSB2YWx1ZXMuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgIGFkZGVkID0g\nYWRkKGl0ci5uZXh0KCkpIHx8IGFkZGVkOwogICAgICAgIHJldHVybiBhZGRl\nZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBQ\ncm94aWVzLmRpcnR5KHRoaXMpOwogICAgICAgIGlmIChfY3QgIT0gbnVsbCkK\nICAgICAgICAgICAgX2N0LnN0b3BUcmFja2luZygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgc2l6ZSgpOyBpKyspCiAgICAgICAgICAgIFByb3hp\nZXMucmVtb3ZlZCh0aGlzLCBnZXQoaSksIGZhbHNlKTsKICAgICAgICBzdXBl\nci5jbGVhcigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbEVs\nZW1lbnRzKCkgewogICAgICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAg\nICAgaWYgKF9jdCAhPSBudWxsKQogICAgICAgICAgICBfY3Quc3RvcFRyYWNr\naW5nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzaXplKCk7IGkr\nKykKICAgICAgICAgICAgUHJveGllcy5yZW1vdmVkKHRoaXMsIGdldChpKSwg\nZmFsc2UpOwogICAgICAgIHN1cGVyLnJlbW92ZUFsbEVsZW1lbnRzKCk7CiAg\nICB9CgogICAgcHVibGljIEl0ZXJhdG9yIGl0ZXJhdG9yKCkgewogICAgICAg\nIHJldHVybiBQcm94aWVzLml0ZXJhdG9yKHRoaXMsIHN1cGVyLml0ZXJhdG9y\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0SXRlcmF0b3IgbGlzdEl0ZXJh\ndG9yKCkgewogICAgICAgIHJldHVybiBQcm94aWVzLmxpc3RJdGVyYXRvcih0\naGlzLCBzdXBlci5saXN0SXRlcmF0b3IoKSwgX2VsZW1lbnRUeXBlKTsKICAg\nIH0KCiAgICBwdWJsaWMgTGlzdEl0ZXJhdG9yIGxpc3RJdGVyYXRvcihpbnQg\naW5kZXgpIHsKICAgICAgICByZXR1cm4gUHJveGllcy5saXN0SXRlcmF0b3Io\ndGhpcywgc3VwZXIubGlzdEl0ZXJhdG9yKGluZGV4KSwKICAgICAgICAgICAg\nX2VsZW1lbnRUeXBlKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHJlbW92\nZShpbnQgaW5kZXgpIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwog\nICAgICAgIE9iamVjdCByZW0gPSBzdXBlci5yZW1vdmUoaW5kZXgpOwogICAg\nICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgX2N0LnJlbW92ZWQo\ncmVtKTsKICAgICAgICBQcm94aWVzLnJlbW92ZWQodGhpcywgcmVtLCBmYWxz\nZSk7CiAgICAgICAgcmV0dXJuIHJlbTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCByZW1vdmVFbGVtZW50QXQoaW50IGluZGV4KSB7CiAgICAgICAgUHJveGll\ncy5kaXJ0eSh0aGlzKTsKICAgICAgICBPYmplY3QgcmVtID0gZ2V0KGluZGV4\nKTsKICAgICAgICBzdXBlci5yZW1vdmVFbGVtZW50QXQoaW5kZXgpOwogICAg\nICAgIGlmIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgX2N0LnJlbW92ZWQo\ncmVtKTsKICAgICAgICBQcm94aWVzLnJlbW92ZWQodGhpcywgcmVtLCBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlKE9iamVjdCBv\nKSB7CiAgICAgICAgUHJveGllcy5kaXJ0eSh0aGlzKTsKICAgICAgICBpZiAo\nc3VwZXIucmVtb3ZlKG8pKSB7CiAgICAgICAgICAgIGlmIChfY3QgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIF9jdC5yZW1vdmVkKG8pOwogICAgICAgICAg\nICBQcm94aWVzLnJlbW92ZWQodGhpcywgbywgZmFsc2UpOwogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUVsZW1lbnQoT2Jq\nZWN0IG8pIHsKICAgICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwogICAgICAg\nIGlmIChzdXBlci5yZW1vdmVFbGVtZW50KG8pKSB7CiAgICAgICAgICAgIGlm\nIChfY3QgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jdC5yZW1vdmVkKG8p\nOwogICAgICAgICAgICBQcm94aWVzLnJlbW92ZWQodGhpcywgbywgZmFsc2Up\nOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92\nZUFsbChDb2xsZWN0aW9uIGMpIHsKICAgICAgICBib29sZWFuIHJlbW92ZWQg\nPSBmYWxzZTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGMuaXRlcmF0\nb3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgIHJlbW92ZWQgPSBy\nZW1vdmUoaXRyLm5leHQoKSkgfHwgcmVtb3ZlZDsKICAgICAgICByZXR1cm4g\ncmVtb3ZlZDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiByZXRhaW5BbGwo\nQ29sbGVjdGlvbiBjKSB7CiAgICAgICAgaW50IHNpemUgPSBzaXplKCk7CiAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBpdGVyYXRvcigpOyBpdHIuaGFz\nTmV4dCgpOykKICAgICAgICAgICAgaWYgKCFjLmNvbnRhaW5zKGl0ci5uZXh0\nKCkpKQogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAgICAgIHJl\ndHVybiBzaXplKCkgPCBzaXplOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\nc2V0KGludCBpbmRleCwgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgUHJveGll\ncy5hc3NlcnRBbGxvd2VkVHlwZSh2YWx1ZSwgX2VsZW1lbnRUeXBlKTsKICAg\nICAgICBQcm94aWVzLmRpcnR5KHRoaXMpOwogICAgICAgIGlmIChfY3QgIT0g\nbnVsbCkKICAgICAgICAgICAgX2N0LnN0b3BUcmFja2luZygpOwogICAgICAg\nIE9iamVjdCByZW0gPSBzdXBlci5zZXQoaW5kZXgsIHZhbHVlKTsKICAgICAg\nICBQcm94aWVzLnJlbW92ZWQodGhpcywgcmVtLCBmYWxzZSk7CiAgICAgICAg\ncmV0dXJuIHJlbTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFbGVtZW50\nQXQoT2JqZWN0IHZhbHVlLCBpbnQgaW5kZXgpIHsKICAgICAgICBQcm94aWVz\nLmFzc2VydEFsbG93ZWRUeXBlKHZhbHVlLCBfZWxlbWVudFR5cGUpOwogICAg\nICAgIFByb3hpZXMuZGlydHkodGhpcyk7CiAgICAgICAgaWYgKF9jdCAhPSBu\ndWxsKQogICAgICAgICAgICBfY3Quc3RvcFRyYWNraW5nKCk7CiAgICAgICAg\nT2JqZWN0IHJlbSA9IGdldChpbmRleCk7CiAgICAgICAgc3VwZXIuc2V0RWxl\nbWVudEF0KHZhbHVlLCBpbmRleCk7CiAgICAgICAgUHJveGllcy5yZW1vdmVk\nKHRoaXMsIHJlbSwgZmFsc2UpOwogICAgfQoKICAgIHByb3RlY3RlZCBPYmpl\nY3Qgd3JpdGVSZXBsYWNlKCkKICAgICAgICB0aHJvd3MgT2JqZWN0U3RyZWFt\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX3NtICE9IG51bGwgJiYgX3NtLmlz\nRGV0YWNoZWQoKSkKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAg\ncmV0dXJuIGNvcHkodGhpcyk7CiAgICB9Cn0K\n","encoding":"base64"}

