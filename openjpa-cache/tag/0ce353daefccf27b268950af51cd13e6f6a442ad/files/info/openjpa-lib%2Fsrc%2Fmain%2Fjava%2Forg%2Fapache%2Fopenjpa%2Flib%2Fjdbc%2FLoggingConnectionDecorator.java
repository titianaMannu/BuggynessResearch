{"sha":"96861e8b08eba4ee253e4b624c610345f596591a","node_id":"MDQ6QmxvYjIwNjM2NDo5Njg2MWU4YjA4ZWJhNGVlMjUzZTRiNjI0YzYxMDM0NWY1OTY1OTFh","size":47225,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/96861e8b08eba4ee253e4b624c610345f596591a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIuamRiYzsKCmltcG9ydCBqYXZhLmlvLklucHV0U3RyZWFt\nOwppbXBvcnQgamF2YS5pby5SZWFkZXI7CmltcG9ydCBqYXZhLm1hdGguQmln\nRGVjaW1hbDsKaW1wb3J0IGphdmEuc3FsLkFycmF5OwppbXBvcnQgamF2YS5z\ncWwuQmF0Y2hVcGRhdGVFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5CbG9i\nOwppbXBvcnQgamF2YS5zcWwuQ2xvYjsKaW1wb3J0IGphdmEuc3FsLkNvbm5l\nY3Rpb247CmltcG9ydCBqYXZhLnNxbC5EYXRhYmFzZU1ldGFEYXRhOwppbXBv\ncnQgamF2YS5zcWwuRGF0ZTsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3Rh\ndGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVmOwppbXBvcnQgamF2YS5zcWwu\nUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0TWV0YURhdGE7\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNx\nbC5TUUxXYXJuaW5nOwppbXBvcnQgamF2YS5zcWwuU2F2ZXBvaW50OwppbXBv\ncnQgamF2YS5zcWwuU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuVGltZTsK\naW1wb3J0IGphdmEuc3FsLlRpbWVzdGFtcDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2\nYS51dGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5sb2cuTG9nOwoKLyoqCiAqIEEge0BsaW5rIENvbm5lY3Rpb25E\nZWNvcmF0b3J9IHRoYXQgY3JlYXRlcyBsb2dnaW5nIGNvbm5lY3Rpb25zIGFu\nZAogKiB7QGxpbmsgUmVwb3J0aW5nU1FMRXhjZXB0aW9ufXMuCiAqCiAqIEBh\ndXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBub2phdmFkb2MKICovCnB1\nYmxpYyBjbGFzcyBMb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvciBpbXBsZW1l\nbnRzIENvbm5lY3Rpb25EZWNvcmF0b3IgewoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIFN0cmluZyBTRVAgPSBTeXN0ZW0uZ2V0UHJvcGVydHkoImxpbmUu\nc2VwYXJhdG9yIik7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFdB\nUk5fSUdOT1JFID0gMDsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBX\nQVJOX0xPR19UUkFDRSA9IDE7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgV0FSTl9MT0dfSU5GTyA9IDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgV0FSTl9MT0dfV0FSTiA9IDM7CiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBpbnQgV0FSTl9MT0dfRVJST1IgPSA0OwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IFdBUk5fVEhST1cgPSA1OwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IFdBUk5fSEFORExFID0gNjsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIFN0cmluZ1tdIFdBUk5JTkdfQUNUSU9OUyA9IG5ldyBTdHJp\nbmdbN107CgogICAgc3RhdGljIHsKICAgICAgICBXQVJOSU5HX0FDVElPTlNb\nV0FSTl9JR05PUkVdID0gImlnbm9yZSI7CiAgICAgICAgV0FSTklOR19BQ1RJ\nT05TW1dBUk5fTE9HX1RSQUNFXSA9ICJ0cmFjZSI7CiAgICAgICAgV0FSTklO\nR19BQ1RJT05TW1dBUk5fTE9HX0lORk9dID0gImluZm8iOwogICAgICAgIFdB\nUk5JTkdfQUNUSU9OU1tXQVJOX0xPR19XQVJOXSA9ICJ3YXJuIjsKICAgICAg\nICBXQVJOSU5HX0FDVElPTlNbV0FSTl9MT0dfRVJST1JdID0gImVycm9yIjsK\nICAgICAgICBXQVJOSU5HX0FDVElPTlNbV0FSTl9USFJPV10gPSAidGhyb3ci\nOwogICAgICAgIFdBUk5JTkdfQUNUSU9OU1tXQVJOX0hBTkRMRV0gPSAiaGFu\nZGxlIjsKICAgIH0KCiAgICBwcml2YXRlIGZpbmFsIERhdGFTb3VyY2VMb2dz\nIF9sb2dzID0gbmV3IERhdGFTb3VyY2VMb2dzKCk7CiAgICBwcml2YXRlIFNR\nTEZvcm1hdHRlciBfZm9ybWF0dGVyOwogICAgcHJpdmF0ZSBib29sZWFuIF9w\ncmV0dHlQcmludDsKICAgIHByaXZhdGUgaW50IF9wcmV0dHlQcmludExpbmVM\nZW5ndGggPSA2MDsKICAgIHByaXZhdGUgaW50IF93YXJuaW5nQWN0aW9uID0g\nV0FSTl9JR05PUkU7CiAgICBwcml2YXRlIFNRTFdhcm5pbmdIYW5kbGVyIF93\nYXJuaW5nSGFuZGxlcjsKICAgIHByaXZhdGUgYm9vbGVhbiBfdHJhY2tQYXJh\nbWV0ZXJzID0gdHJ1ZTsKCiAgICAvKioKICAgICAqIElmIHNldCB0byA8Y29k\nZT50cnVlPC9jb2RlPiwgcHJldHR5LXByaW50IFNRTCBieSBydW5uaW5nIGl0\nCiAgICAgKiB0aHJvdWdoIHtAbGluayBTUUxGb3JtYXR0ZXIjcHJldHR5UHJp\nbnR9LiBJZgogICAgICogPGNvZGU+ZmFsc2U8L2NvZGU+LCBkb24ndCBwcmV0\ndHktcHJpbnQsIGFuZCBvdXRwdXQgU1FMIGxvZ3MgaW4KICAgICAqIGEgc2lu\nZ2xlIGxpbmUuIFByZXR0eS1wcmludGVkIFNRTCBjYW4gYmUgZWFzaWVyIGZv\nciBhIGh1bWFuIHRvCiAgICAgKiByZWFkLCBidXQgaXMgaGFyZGVyIHRvIHBh\ncnNlIHdpdGggdG9vbHMgbGlrZSBncmVwLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRQcmV0dHlQcmludChib29sZWFuIHByZXR0eVByaW50KSB7CiAg\nICAgICAgX3ByZXR0eVByaW50ID0gcHJldHR5UHJpbnQ7CiAgICAgICAgaWYg\nKF9mb3JtYXR0ZXIgPT0gbnVsbCAmJiBfcHJldHR5UHJpbnQpIHsKICAgICAg\nICAgICAgX2Zvcm1hdHRlciA9IG5ldyBTUUxGb3JtYXR0ZXIoKTsKICAgICAg\nICAgICAgX2Zvcm1hdHRlci5zZXRMaW5lTGVuZ3RoKF9wcmV0dHlQcmludExp\nbmVMZW5ndGgpOwogICAgICAgIH0gZWxzZSBpZiAoIV9wcmV0dHlQcmludCkK\nICAgICAgICAgICAgX2Zvcm1hdHRlciA9IG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBAc2VlICNzZXRQcmV0dHlQcmludAogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBnZXRQcmV0dHlQcmludCgpIHsKICAgICAgICByZXR1cm4g\nX3ByZXR0eVByaW50OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51bWJl\nciBvZiBjaGFyYWN0ZXJzIHRvIHByaW50IHBlciBsaW5lIHdoZW4KICAgICAq\nIHByZXR0eS1wcmludGluZyBvZiBTUUwgaXMgZW5hYmxlZC4gRGVmYXVsdHMg\ndG8gNjAgdG8gcHJvdmlkZQogICAgICogc29tZSBzcGFjZSBmb3IgYW55IGFu\ndC1yZWxhdGVkIGNoYXJhY3RlcnMgb24gdGhlIGxlZnQgb2YgYQogICAgICog\nc3RhbmRhcmQgODAtY2hhcmFjdGVyIGRpc3BsYXkuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFByZXR0eVByaW50TGluZUxlbmd0aChpbnQgbGVuZ3Ro\nKSB7CiAgICAgICAgX3ByZXR0eVByaW50TGluZUxlbmd0aCA9IGxlbmd0aDsK\nICAgICAgICBpZiAoX2Zvcm1hdHRlciAhPSBudWxsKQogICAgICAgICAgICBf\nZm9ybWF0dGVyLnNldExpbmVMZW5ndGgobGVuZ3RoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEBzZWUgI3NldFByZXR0eVByaW50TGluZUxlbmd0aAogICAg\nICovCiAgICBwdWJsaWMgaW50IGdldFByZXR0eVByaW50TGluZUxlbmd0aCgp\nIHsKICAgICAgICByZXR1cm4gX3ByZXR0eVByaW50TGluZUxlbmd0aDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdHJhY2sgcGFyYW1ldGVy\ncyBmb3IgdGhlIHB1cnBvc2VzIG9mIHJlcG9ydGluZyBleGNlcHRpb25zLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFja1BhcmFtZXRlcnMoYm9v\nbGVhbiB0cmFja1BhcmFtZXRlcnMpIHsKICAgICAgICBfdHJhY2tQYXJhbWV0\nZXJzID0gdHJhY2tQYXJhbWV0ZXJzOwogICAgfQoKICAgIC8qKgogICAgICog\nV2hldGhlciB0byB0cmFjayBwYXJhbWV0ZXJzIGZvciB0aGUgcHVycG9zZXMg\nb2YgcmVwb3J0aW5nIGV4Y2VwdGlvbnMuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGdldFRyYWNrUGFyYW1ldGVycygpIHsKICAgICAgICByZXR1cm4g\nX3RyYWNrUGFyYW1ldGVyczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoYXQg\ndG8gZG8gd2l0aCBTUUwgd2FybmluZ3MuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFdhcm5pbmdBY3Rpb24oU3RyaW5nIHdhcm5pbmdBY3Rpb24pIHsK\nICAgICAgICBpbnQgaW5kZXggPSBBcnJheXMuYXNMaXN0KFdBUk5JTkdfQUNU\nSU9OUykuaW5kZXhPZih3YXJuaW5nQWN0aW9uKTsKICAgICAgICBpZiAoaW5k\nZXggPCAwKQogICAgICAgICAgICBpbmRleCA9IFdBUk5fSUdOT1JFOwogICAg\nICAgIF93YXJuaW5nQWN0aW9uID0gaW5kZXg7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGF0IHRvIGRvIHdpdGggU1FMIHdhcm5pbmdzLgogICAgICovCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFdhcm5pbmdBY3Rpb24oKSB7CiAgICAgICAg\ncmV0dXJuIFdBUk5JTkdfQUNUSU9OU1tfd2FybmluZ0FjdGlvbl07CiAgICB9\nCgogICAgLyoqCiAgICAgKiBXaGF0IHRvIGRvIHdpdGggU1FMIHdhcm5pbmdz\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRXYXJuaW5nSGFuZGxlcihT\nUUxXYXJuaW5nSGFuZGxlciB3YXJuaW5nSGFuZGxlcikgewogICAgICAgIF93\nYXJuaW5nSGFuZGxlciA9IHdhcm5pbmdIYW5kbGVyOwogICAgfQoKICAgIC8q\nKgogICAgICogV2hhdCB0byBkbyB3aXRoIFNRTCB3YXJuaW5ncy4KICAgICAq\nLwogICAgcHVibGljIFNRTFdhcm5pbmdIYW5kbGVyIGdldFdhcm5pbmdIYW5k\nbGVyKCkgewogICAgICAgIHJldHVybiBfd2FybmluZ0hhbmRsZXI7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgbG9nIHRvIHdyaXRlIHRvLgogICAgICov\nCiAgICBwdWJsaWMgRGF0YVNvdXJjZUxvZ3MgZ2V0TG9ncygpIHsKICAgICAg\nICByZXR1cm4gX2xvZ3M7CiAgICB9CgogICAgcHVibGljIENvbm5lY3Rpb24g\nZGVjb3JhdGUoQ29ubmVjdGlvbiBjb25uKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdDb25uZWN0aW9uKGNvbm4p\nOwogICAgfQoKICAgIC8qKgogICAgICogSW5jbHVkZSBTUUwgaW4gZXhjZXB0\naW9uLgogICAgICovCiAgICBwcml2YXRlIFNRTEV4Y2VwdGlvbiB3cmFwKFNR\nTEV4Y2VwdGlvbiBzcWxlLCBTdGF0ZW1lbnQgc3RtbnQpIHsKICAgICAgICBp\nZiAoc3FsZSBpbnN0YW5jZW9mIFJlcG9ydGluZ1NRTEV4Y2VwdGlvbikKICAg\nICAgICAgICAgcmV0dXJuIChSZXBvcnRpbmdTUUxFeGNlcHRpb24pIHNxbGU7\nCiAgICAgICAgcmV0dXJuIG5ldyBSZXBvcnRpbmdTUUxFeGNlcHRpb24oc3Fs\nZSwgc3RtbnQpOwogICAgfQoKICAgIC8qKgogICAgICogSW5jbHVkZSBTUUwg\naW4gZXhjZXB0aW9uLgogICAgICovCiAgICBwcml2YXRlIFNRTEV4Y2VwdGlv\nbiB3cmFwKFNRTEV4Y2VwdGlvbiBzcWxlLCBTdHJpbmcgc3FsKSB7CiAgICAg\nICAgaWYgKHNxbGUgaW5zdGFuY2VvZiBSZXBvcnRpbmdTUUxFeGNlcHRpb24p\nCiAgICAgICAgICAgIHJldHVybiAoUmVwb3J0aW5nU1FMRXhjZXB0aW9uKSBz\ncWxlOwogICAgICAgIHJldHVybiBuZXcgUmVwb3J0aW5nU1FMRXhjZXB0aW9u\nKHNxbGUsIHNxbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnRlcmZhY2Ug\ndGhhdCBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB3aGF0IHRvIGRvIHdoZW4K\nICAgICAqIHtAbGluayBTUUxXYXJuaW5nfXMgb2NjdXIuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIFNRTFdhcm5pbmdIYW5kbGVyIHsK\nCiAgICAgICAgcHVibGljIHZvaWQgaGFuZGxlV2FybmluZyhTUUxXYXJuaW5n\nIHdhcm5pbmcpIHRocm93cyBTUUxFeGNlcHRpb247CiAgICB9CgogICAgLyoq\nCiAgICAgKiBMb2dnaW5nIGNvbm5lY3Rpb24uCiAgICAgKi8KICAgIHByaXZh\ndGUgY2xhc3MgTG9nZ2luZ0Nvbm5lY3Rpb24gZXh0ZW5kcyBEZWxlZ2F0aW5n\nQ29ubmVjdGlvbiB7CgogICAgICAgIHB1YmxpYyBMb2dnaW5nQ29ubmVjdGlv\nbihDb25uZWN0aW9uIGNvbm4pIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICBzdXBlcihjb25uKTsKICAgICAgICB9CgogICAgICAgIHByb3Rl\nY3RlZCBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmlu\nZyBzcWwsIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBhcmVTdGF0ZW1l\nbnQoc3FsLCBmYWxzZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExv\nZ2dpbmdQcmVwYXJlZFN0YXRlbWVudChzdG1udCwgc3FsKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAg\nICB0aHJvdyB3cmFwKHNlLCBzcWwpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFy\nZVN0YXRlbWVudChTdHJpbmcgc3FsLCBpbnQgcnNUeXBlLAogICAgICAgICAg\nICBpbnQgcnNDb25jdXIsIGJvb2xlYW4gd3JhcCkgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBQcmVw\nYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBhcmVTdGF0ZW1lbnQK\nICAgICAgICAgICAgICAgICAgICAoc3FsLCByc1R5cGUsIHJzQ29uY3VyLCBm\nYWxzZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdQcmVw\nYXJlZFN0YXRlbWVudChzdG1udCwgc3FsKTsKICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyB3\ncmFwKHNlLCBzcWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBwcm90ZWN0ZWQgU3RhdGVtZW50IGNyZWF0ZVN0YXRlbWVudChib29sZWFu\nIHdyYXApIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBTdGF0\nZW1lbnQgc3RtbnQgPSBzdXBlci5jcmVhdGVTdGF0ZW1lbnQoZmFsc2UpOwog\nICAgICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdTdGF0ZW1lbnQoc3RtbnQp\nOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFN0YXRlbWVudCBjcmVh\ndGVTdGF0ZW1lbnQoaW50IHR5cGUsIGludCBjb25jdXJyZW5jeSwKICAgICAg\nICAgICAgYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgU3RhdGVtZW50IHN0bW50ID0gc3VwZXIuY3JlYXRlU3RhdGVt\nZW50KHR5cGUsIGNvbmN1cnJlbmN5LCBmYWxzZSk7CiAgICAgICAgICAgIHJl\ndHVybiBuZXcgTG9nZ2luZ1N0YXRlbWVudChzdG1udCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBjb21taXQoKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50\nVGltZU1pbGxpcygpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgc3VwZXIuY29tbWl0KCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAg\nICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImNvbW1pdCIsIHN0YXJ0\nLCB0aGlzKTsKICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\ncm9sbGJhY2soKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc3VwZXIucm9sbGJhY2so\nKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlm\nIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAg\nX2xvZ3MubG9nSkRCQygicm9sbGJhY2siLCBzdGFydCwgdGhpcyk7CiAgICAg\nICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHN1cGVyLmNsb3NlKCk7CiAgICAgICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImNsb3Nl\nIiwgc3RhcnQsIHRoaXMpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgU2F2ZXBvaW50IHNldFNhdmVwb2ludCgpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVt\nLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwZXIuc2V0U2F2ZXBvaW50KCk7CiAgICAg\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3Mu\naXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxv\nZ0pEQkMoInNhdmVwb2ludCIsIHN0YXJ0LCB0aGlzKTsKICAgICAgICAgICAg\nICAgIGhhbmRsZVNRTFdhcm5pbmcoKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIFNhdmVwb2ludCBzZXRTYXZlcG9pbnQoU3Ry\naW5nIG5hbWUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBs\nb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuc2V0\nU2F2ZXBvaW50KG5hbWUpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJzYXZlcG9pbnQ6ICIgKyBu\nYW1lLCBzdGFydCwgdGhpcyk7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxX\nYXJuaW5nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIHJvbGxiYWNrKFNhdmVwb2ludCBzYXZlcG9pbnQpIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBzdXBlci5yb2xsYmFjayhzYXZlcG9pbnQpOwogICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dz\nLmlzSkRCQ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgIFN0cmlu\nZyBuYW1lID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICBuYW1lID0gc2F2ZXBvaW50LmdldFNhdmVw\nb2ludE5hbWUoKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxF\neGNlcHRpb24gc3FlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUg\nPSBTdHJpbmcudmFsdWVPZihzYXZlcG9pbnQuZ2V0U2F2ZXBvaW50SWQoKSk7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF9s\nb2dzLmxvZ0pEQkMoInJvbGxiYWNrOiAiICsgbmFtZSwgc3RhcnQsIHRoaXMp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaGFuZGxlU1FM\nV2FybmluZygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCByZWxlYXNlU2F2ZXBvaW50KFNhdmVwb2ludCBzYXZlcG9p\nbnQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIHN0\nYXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBzdXBlci5yZWxlYXNlU2F2ZXBvaW50\nKHNhdmVwb2ludCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgU3RyaW5nIG5hbWUgPSBudWxsOwogICAgICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBz\nYXZlcG9pbnQuZ2V0U2F2ZXBvaW50TmFtZSgpOwogICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWUpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgbmFtZSA9IFN0cmluZy52YWx1ZU9mKHNhdmVwb2ludC5n\nZXRTYXZlcG9pbnRJZCgpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygicmVsZWFzZTogIiArIG5h\nbWUsIHN0YXJ0LCB0aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFN0YXRlbWVudCBjcmVhdGVTdGF0\nZW1lbnQoaW50IHJlc3VsdFNldFR5cGUsCiAgICAgICAgICAgIGludCByZXN1\nbHRTZXRDb25jdXJyZW5jeSwgaW50IHJlc3VsdFNldEhvbGRhYmlsaXR5LCBi\nb29sZWFuIHdyYXApCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICBTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5jcmVhdGVT\ndGF0ZW1lbnQocmVzdWx0U2V0VHlwZSwKICAgICAgICAgICAgICAgIHJlc3Vs\ndFNldENvbmN1cnJlbmN5LCByZXN1bHRTZXRIb2xkYWJpbGl0eSwgZmFsc2Up\nOwogICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKCk7CiAgICAgICAgICAg\nIHJldHVybiBuZXcgTG9nZ2luZ1N0YXRlbWVudChzdG1udCk7CiAgICAgICAg\nfQoKICAgICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFy\nZVN0YXRlbWVudChTdHJpbmcgc3FsLAogICAgICAgICAgICBpbnQgcmVzdWx0\nU2V0VHlwZSwgaW50IHJlc3VsdFNldENvbmN1cnJlbmN5LAogICAgICAgICAg\nICBpbnQgcmVzdWx0U2V0SG9sZGFiaWxpdHksIGJvb2xlYW4gd3JhcCkgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBh\ncmVTdGF0ZW1lbnQKICAgICAgICAgICAgICAgICAgICAoc3FsLCByZXN1bHRT\nZXRUeXBlLCByZXN1bHRTZXRDb25jdXJyZW5jeSwKICAgICAgICAgICAgICAg\nICAgICAgICAgcmVzdWx0U2V0SG9sZGFiaWxpdHksIGZhbHNlKTsKICAgICAg\nICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoKTsKICAgICAgICAgICAgICAg\nIHJldHVybiBuZXcgTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50KHN0bW50LCBz\ncWwpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgIHRocm93IHdyYXAoc2UsIHNxbCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0\nYXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwsCiAgICAgICAg\nICAgIGludCBhdXRvR2VuZXJhdGVkS2V5cywgYm9vbGVhbiB3cmFwKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFy\nZVN0YXRlbWVudAogICAgICAgICAgICAgICAgICAgIChzcWwsIGF1dG9HZW5l\ncmF0ZWRLZXlzLCBmYWxzZSk7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxX\nYXJuaW5nKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdQ\ncmVwYXJlZFN0YXRlbWVudChzdG1udCwgc3FsKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyB3cmFwKHNlLCBzcWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRl\nbWVudChTdHJpbmcgc3FsLAogICAgICAgICAgICBpbnRbXSBjb2x1bW5JbmRl\neGVzLCBib29sZWFuIHdyYXApIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgUHJlcGFyZWRTdGF0ZW1l\nbnQgc3RtbnQgPSBzdXBlci5wcmVwYXJlU3RhdGVtZW50CiAgICAgICAgICAg\nICAgICAgICAgKHNxbCwgY29sdW1uSW5kZXhlcywgZmFsc2UpOwogICAgICAg\nICAgICAgICAgaGFuZGxlU1FMV2FybmluZygpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIG5ldyBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQoc3RtbnQsIHNx\nbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewog\nICAgICAgICAgICAgICAgdGhyb3cgd3JhcChzZSwgc3FsKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3Rh\ndGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwKICAgICAgICAg\nICAgU3RyaW5nW10gY29sdW1uTmFtZXMsIGJvb2xlYW4gd3JhcCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBhcmVT\ndGF0ZW1lbnQKICAgICAgICAgICAgICAgICAgICAoc3FsLCBjb2x1bW5OYW1l\ncywgZmFsc2UpOwogICAgICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZygp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMb2dnaW5nUHJlcGFyZWRT\ndGF0ZW1lbnQoc3RtbnQsIHNxbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgdGhyb3cgd3JhcChz\nZSwgc3FsKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIERhdGFiYXNlTWV0YURhdGEgZ2V0TWV0YURhdGEoYm9vbGVhbiB3\ncmFwKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgcmV0dXJuIG5ldyBMb2dnaW5nRGF0YWJhc2VNZXRhRGF0YShzdXBl\nci5nZXRNZXRhRGF0YShmYWxzZSkpOwogICAgICAgIH0KCiAgICAgICAgLyoq\nCiAgICAgICAgICogTG9nIHRpbWUgZWxhcHNlZCBzaW5jZSBnaXZlbiBzdGFy\ndC4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgbG9nVGltZShs\nb25nIHN0YXJ0VGltZSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIGlmIChfbG9ncy5pc1NRTEVuYWJsZWQoKSkKICAgICAgICAgICAgICAg\nIF9sb2dzLmxvZ1NRTCgic3BlbnQiLCBzdGFydFRpbWUsIHRoaXMpOyAKICAg\nICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIExvZyB0aW1lIGVsYXBz\nZWQgc2luY2UgZ2l2ZW4gc3RhcnQuCiAgICAgICAgICovCiAgICAgICAgcHJp\ndmF0ZSB2b2lkIGxvZ1NRTChTdGF0ZW1lbnQgc3RtbnQpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICBpZiAoX2xvZ3MuaXNTUUxFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBfbG9ncy5sb2dTUUwoImV4ZWN1dGluZyAi\nICsgc3RtbnQsIHRoaXMpOyAKICAgICAgICB9CgogICAgICAgIC8qKgogICAg\nICAgICAqIEhhbmRsZSBhbnkge0BsaW5rIFNRTFdhcm5pbmd9cyBvbiB0aGUg\nY3VycmVudCB7QGxpbmsgQ29ubmVjdGlvbn0uCiAgICAgICAgICoKICAgICAg\nICAgKiBAc2VlICNoYW5kbGVTUUxXYXJuaW5nKFNRTFdhcm5pbmcpCiAgICAg\nICAgICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIGhhbmRsZVNRTFdhcm5pbmco\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKF93YXJu\naW5nQWN0aW9uID09IFdBUk5fSUdOT1JFKQogICAgICAgICAgICAgICAgcmV0\ndXJuOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGhhbmRs\nZVNRTFdhcm5pbmcoZ2V0V2FybmluZ3MoKSk7CiAgICAgICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgICAgICBjbGVhcldhcm5pbmdzKCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEhh\nbmRsZSBhbnkge0BsaW5rIFNRTFdhcm5pbmd9cyBvbiB0aGUgc3BlY2lmaWVk\nIHtAbGluayBTdGF0ZW1lbnR9LgogICAgICAgICAqCiAgICAgICAgICogQHNl\nZSAjaGFuZGxlU1FMV2FybmluZyhTUUxXYXJuaW5nKQogICAgICAgICAqLwog\nICAgICAgIHByaXZhdGUgdm9pZCBoYW5kbGVTUUxXYXJuaW5nKFN0YXRlbWVu\ndCBzdG1udCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlm\nIChfd2FybmluZ0FjdGlvbiA9PSBXQVJOX0lHTk9SRSkKICAgICAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBoYW5kbGVTUUxXYXJuaW5nKHN0bW50LmdldFdhcm5pbmdzKCkpOwogICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgc3RtbnQuY2xl\nYXJXYXJuaW5ncygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBIYW5kbGUgYW55IHtAbGluayBTUUxXYXJuaW5n\nfXMgb24gdGhlIHNwZWNpZmllZCB7QGxpbmsgUmVzdWx0U2V0fS4KICAgICAg\nICAgKgogICAgICAgICAqIEBzZWUgI2hhbmRsZVNRTFdhcm5pbmcoU1FMV2Fy\nbmluZykKICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgaGFuZGxl\nU1FMV2FybmluZyhSZXN1bHRTZXQgcnMpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICBpZiAoX3dhcm5pbmdBY3Rpb24gPT0gV0FSTl9JR05P\nUkUpCiAgICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhycy5nZXRXYXJu\naW5ncygpKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgIHJzLmNsZWFyV2FybmluZ3MoKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogSGFuZGxlIHRoZSBzcGVjaWZp\nZWQge0BsaW5rIFNRTFdhcm5pbmd9IGRlcGVuZGluZyBvbiB0aGUKICAgICAg\nICAgKiBzZXR0aW5nIG9mIHRoZSB7QGxpbmsgI3NldFdhcm5pbmdBY3Rpb259\nIGF0dHJpYnV0ZS4KICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB3YXJu\naW5nIHRoZSB3YXJuaW5nIHRvIGhhbmRsZQogICAgICAgICAqLwogICAgICAg\nIHByaXZhdGUgdm9pZCBoYW5kbGVTUUxXYXJuaW5nKFNRTFdhcm5pbmcgd2Fy\nbmluZykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmICh3\nYXJuaW5nID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgIGlmIChfd2FybmluZ0FjdGlvbiA9PSBXQVJOX0lHTk9SRSkKICAg\nICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIExvZyBsb2cgPSBf\nbG9ncy5nZXRKREJDTG9nKCk7CiAgICAgICAgICAgIGZvciAoOyB3YXJuaW5n\nICE9IG51bGw7IHdhcm5pbmcgPSB3YXJuaW5nLmdldE5leHRXYXJuaW5nKCkp\nIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX3dhcm5pbmdBY3Rpb24pIHsK\nICAgICAgICAgICAgICAgICAgICBjYXNlIFdBUk5fTE9HX1RSQUNFOgogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2Uod2Fybmlu\nZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgICAgIGNhc2UgV0FSTl9MT0dfSU5GTzoKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBsb2cuaW5mbyh3YXJuaW5nKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBXQVJOX0xPR19XQVJOOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\nbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGxvZy53YXJuKHdhcm5pbmcpOwogICAgICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIFdBUk5fTE9HX0VS\nUk9SOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzRXJyb3JF\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cuZXJy\nb3Iod2FybmluZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgICAgIGNhc2UgV0FSTl9USFJPVzoKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8ganVzdCB0aHJvdyBpdCBhcyBpZiBpdCB3ZXJl\nIGEgU1FMRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93\nIHdhcm5pbmc7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBXQVJOX0hBTkRM\nRToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF93YXJuaW5nSGFuZGxl\nciAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3dhcm5p\nbmdIYW5kbGVyLmhhbmRsZVdhcm5pbmcod2FybmluZyk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1\nbHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZQogICAgICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nTWV0YWRhdGEgd3JhcHBlciB0aGF0IGxvZ3MgYWN0aW9ucy4KICAgICAgICAg\nKi8KICAgICAgICBwcml2YXRlIGNsYXNzIExvZ2dpbmdEYXRhYmFzZU1ldGFE\nYXRhCiAgICAgICAgICAgIGV4dGVuZHMgRGVsZWdhdGluZ0RhdGFiYXNlTWV0\nYURhdGEgewoKICAgICAgICAgICAgcHVibGljIExvZ2dpbmdEYXRhYmFzZU1l\ndGFEYXRhKERhdGFiYXNlTWV0YURhdGEgbWV0YSkgewogICAgICAgICAgICAg\nICAgc3VwZXIobWV0YSwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0QmVz\ndFJvd0lkZW50aWZpZXIoU3RyaW5nIGNhdGFsb2csCiAgICAgICAgICAgICAg\nICBTdHJpbmcgc2NoZW1hLCBTdHJpbmcgdGFibGUsIGludCBzY29wZSwgYm9v\nbGVhbiBudWxsYWJsZSkKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJs\nZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRC\nZXN0Um93SWRlbnRpZmllcjogIgogICAgICAgICAgICAgICAgICAgICAgICAr\nIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hICsgIiwgIiArIHRhYmxlLAogICAg\nICAgICAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsK\nICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRCZXN0Um93SWRlbnRp\nZmllcihjYXRhbG9nLCBzY2hlbWEsCiAgICAgICAgICAgICAgICAgICAgdGFi\nbGUsIHNjb3BlLCBudWxsYWJsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0Q2F0YWxvZ3MoKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNF\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygi\nZ2V0Q2F0YWxvZ3MiLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAg\nICAgICAgICAgIHJldHVybiBzdXBlci5nZXRDYXRhbG9ncygpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldENvbHVt\nblByaXZpbGVnZXMoU3RyaW5nIGNhdGFsb2csIFN0cmluZyBzY2hlbWEsCiAg\nICAgICAgICAgICAgICBTdHJpbmcgdGFibGUsIFN0cmluZyBjb2x1bW5OYW1l\nUGF0dGVybikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nICAgIF9sb2dzLmxvZ0pEQkMoImdldENvbHVtblByaXZpbGVnZXM6ICIKICAg\nICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVt\nYSArICIsICIgKyB0YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgTG9n\nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0Q29sdW1uUHJpdmlsZWdlcyhjYXRhbG9nLCBzY2hlbWEsCiAg\nICAgICAgICAgICAgICAgICAgdGFibGUsIGNvbHVtbk5hbWVQYXR0ZXJuKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldCBn\nZXRDb2x1bW5zKFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hUGF0dGVy\nbiwKICAgICAgICAgICAgICAgIFN0cmluZyB0YWJsZU5hbWVQYXR0ZXJuLCBT\ndHJpbmcgY29sdW1uTmFtZVBhdHRlcm4pCiAgICAgICAgICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5p\nc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9n\nSkRCQygiZ2V0Q29sdW1uczogIgogICAgICAgICAgICAgICAgICAgICAgICAr\nIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hUGF0dGVybiArICIsICIKICAgICAg\nICAgICAgICAgICAgICAgICAgKyB0YWJsZU5hbWVQYXR0ZXJuICsgIiwgIiAr\nIGNvbHVtbk5hbWVQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgICAgICBM\nb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRDb2x1bW5zKGNhdGFsb2csIHNjaGVtYVBhdHRlcm4sCiAg\nICAgICAgICAgICAgICAgICAgdGFibGVOYW1lUGF0dGVybiwgY29sdW1uTmFt\nZVBhdHRlcm4pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\nUmVzdWx0U2V0IGdldENyb3NzUmVmZXJlbmNlKFN0cmluZyBwcmltYXJ5Q2F0\nYWxvZywKICAgICAgICAgICAgICAgIFN0cmluZyBwcmltYXJ5U2NoZW1hLCBT\ndHJpbmcgcHJpbWFyeVRhYmxlLAogICAgICAgICAgICAgICAgU3RyaW5nIGZv\ncmVpZ25DYXRhbG9nLCBTdHJpbmcgZm9yZWlnblNjaGVtYSwKICAgICAgICAg\nICAgICAgIFN0cmluZyBmb3JlaWduVGFibGUpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRDcm9z\nc1JlZmVyZW5jZTogIgogICAgICAgICAgICAgICAgICAgICAgICArIHByaW1h\ncnlDYXRhbG9nICsgIiwgIiArIHByaW1hcnlTY2hlbWEgKyAiLCAiCiAgICAg\nICAgICAgICAgICAgICAgICAgICsgcHJpbWFyeVRhYmxlICsgIiwgIiArIGZv\ncmVpZ25DYXRhbG9nICsgIiwgIgogICAgICAgICAgICAgICAgICAgICAgICAr\nIGZvcmVpZ25TY2hlbWEgKyAiLCAiICsgZm9yZWlnblNjaGVtYSwKICAgICAg\nICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0Q3Jvc3NSZWZlcmVuY2Uo\ncHJpbWFyeUNhdGFsb2csIHByaW1hcnlTY2hlbWEsCiAgICAgICAgICAgICAg\nICAgICAgcHJpbWFyeVRhYmxlLCBmb3JlaWduQ2F0YWxvZywgZm9yZWlnblNj\naGVtYSwgZm9yZWlnblRhYmxlKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIFJlc3VsdFNldCBnZXRFeHBvcnRlZEtleXMoU3RyaW5nIGNh\ndGFsb2csIFN0cmluZyBzY2hlbWEsCiAgICAgICAgICAgICAgICBTdHJpbmcg\ndGFibGUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\naWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICBfbG9ncy5sb2dKREJDKCJnZXRFeHBvcnRlZEtleXM6ICIKICAgICAgICAg\nICAgICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYSArICIs\nICIgKyB0YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nv\nbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZ2V0RXhwb3J0ZWRLZXlzKGNhdGFsb2csIHNjaGVtYSwgdGFibGUpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldElt\ncG9ydGVkS2V5cyhTdHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYSwKICAg\nICAgICAgICAgICAgIFN0cmluZyB0YWJsZSkgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgp\nKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldEltcG9y\ndGVkS2V5czogIgogICAgICAgICAgICAgICAgICAgICAgICArIGNhdGFsb2cg\nKyAiLCAiICsgc2NoZW1hICsgIiwgIiArIHRhYmxlLAogICAgICAgICAgICAg\nICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRJbXBvcnRlZEtleXMoY2F0YWxvZywg\nc2NoZW1hLCB0YWJsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyBSZXN1bHRTZXQgZ2V0SW5kZXhJbmZvKFN0cmluZyBjYXRhbG9nLCBT\ndHJpbmcgc2NoZW1hLAogICAgICAgICAgICAgICAgU3RyaW5nIHRhYmxlLCBi\nb29sZWFuIHVuaXF1ZSwgYm9vbGVhbiBhcHByb3hpbWF0ZSkKICAgICAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\naWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICBfbG9ncy5sb2dKREJDKCJnZXRJbmRleEluZm86ICIKICAgICAgICAgICAg\nICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYSArICIsICIg\nKyB0YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5l\nY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0\nSW5kZXhJbmZvKGNhdGFsb2csIHNjaGVtYSwgdGFibGUsIHVuaXF1ZSwKICAg\nICAgICAgICAgICAgICAgICBhcHByb3hpbWF0ZSk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0UHJpbWFyeUtleXMo\nU3RyaW5nIGNhdGFsb2csIFN0cmluZyBzY2hlbWEsCiAgICAgICAgICAgICAg\nICBTdHJpbmcgdGFibGUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAg\nICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRQcmltYXJ5S2V5czogIgog\nICAgICAgICAgICAgICAgICAgICAgICArIGNhdGFsb2cgKyAiLCAiICsgc2No\nZW1hICsgIiwgIiArIHRhYmxlLAogICAgICAgICAgICAgICAgICAgICAgICBM\nb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRQcmltYXJ5S2V5cyhjYXRhbG9nLCBzY2hlbWEsIHRhYmxl\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNl\ndCBnZXRQcm9jZWR1cmVDb2x1bW5zKFN0cmluZyBjYXRhbG9nLAogICAgICAg\nICAgICAgICAgU3RyaW5nIHNjaGVtYVBhdHRlcm4sIFN0cmluZyBwcm9jZWR1\ncmVOYW1lUGF0dGVybiwKICAgICAgICAgICAgICAgIFN0cmluZyBjb2x1bW5O\nYW1lUGF0dGVybikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldFByb2NlZHVyZUNvbHVtbnM6ICIK\nICAgICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNj\naGVtYVBhdHRlcm4gKyAiLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsg\ncHJvY2VkdXJlTmFtZVBhdHRlcm4gKyAiLCAiICsgY29sdW1uTmFtZVBhdHRl\ncm4sCiAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9u\nLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFByb2Nl\nZHVyZUNvbHVtbnMoY2F0YWxvZywgc2NoZW1hUGF0dGVybiwKICAgICAgICAg\nICAgICAgICAgICBwcm9jZWR1cmVOYW1lUGF0dGVybiwgY29sdW1uTmFtZVBh\ndHRlcm4pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVz\ndWx0U2V0IGdldFByb2NlZHVyZXMoU3RyaW5nIGNhdGFsb2csCiAgICAgICAg\nICAgICAgICBTdHJpbmcgc2NoZW1hUGF0dGVybiwgU3RyaW5nIHByb2NlZHVy\nZU5hbWVQYXR0ZXJuKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldFBy\nb2NlZHVyZXM6ICIKICAgICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9n\nICsgIiwgIiArIHNjaGVtYVBhdHRlcm4gKyAiLCAiCiAgICAgICAgICAgICAg\nICAgICAgICAgICsgcHJvY2VkdXJlTmFtZVBhdHRlcm4sIExvZ2dpbmdDb25u\nZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdl\ndFByb2NlZHVyZXMoY2F0YWxvZywgc2NoZW1hUGF0dGVybiwKICAgICAgICAg\nICAgICAgICAgICBwcm9jZWR1cmVOYW1lUGF0dGVybik7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0U2NoZW1hcygp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9s\nb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9n\ncy5sb2dKREJDKCJnZXRTY2hlbWFzIiwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhp\ncyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U2NoZW1hcygp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0\nIGdldFRhYmxlUHJpdmlsZWdlcyhTdHJpbmcgY2F0YWxvZywKICAgICAgICAg\nICAgICAgIFN0cmluZyBzY2hlbWFQYXR0ZXJuLCBTdHJpbmcgdGFibGVOYW1l\nUGF0dGVybikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRUYWJsZVBy\naXZpbGVnZXMiLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRUYWJsZVByaXZpbGVnZXMoY2F0YWxv\nZywgc2NoZW1hUGF0dGVybiwKICAgICAgICAgICAgICAgICAgICB0YWJsZU5h\nbWVQYXR0ZXJuKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGlj\nIFJlc3VsdFNldCBnZXRUYWJsZXMoU3RyaW5nIGNhdGFsb2csIFN0cmluZyBz\nY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgU3RyaW5nIHRhYmxlTmFt\nZVBhdHRlcm4sIFN0cmluZ1tdIHR5cGVzKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0VGFibGVz\nOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIg\nKyBzY2hlbWFQYXR0ZXJuICsgIiwgIgogICAgICAgICAgICAgICAgICAgICAg\nICArIHRhYmxlTmFtZVBhdHRlcm4sIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFRhYmxlcyhjYXRh\nbG9nLCBzY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgIHRhYmxl\nTmFtZVBhdHRlcm4sIHR5cGVzKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIFJlc3VsdFNldCBnZXRUYWJsZVR5cGVzKCkgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJD\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMo\nImdldFRhYmxlVHlwZXMiLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAg\nICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRUYWJsZVR5cGVzKCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0\nVHlwZUluZm8oKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAg\nICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0VHlwZUluZm8iLCBMb2dnaW5nQ29u\nbmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5n\nZXRUeXBlSW5mbygpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgUmVzdWx0U2V0IGdldFVEVHMoU3RyaW5nIGNhdGFsb2csIFN0cmluZyBz\nY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgU3RyaW5nIHR5cGVOYW1l\nUGF0dGVybiwgaW50W10gdHlwZXMpIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAg\nICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRVRFRzIiwgTG9n\nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0VURUcyhjYXRhbG9nLCBzY2hlbWFQYXR0ZXJuLAogICAgICAg\nICAgICAgICAgICAgIHR5cGVOYW1lUGF0dGVybiwgdHlwZXMpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldFZlcnNp\nb25Db2x1bW5zKFN0cmluZyBjYXRhbG9nLAogICAgICAgICAgICAgICAgU3Ry\naW5nIHNjaGVtYSwgU3RyaW5nIHRhYmxlKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0VmVyc2lv\nbkNvbHVtbnM6ICIKICAgICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9n\nICsgIiwgIiArIHNjaGVtYSArICIsICIgKyB0YWJsZSwKICAgICAgICAgICAg\nICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VmVyc2lvbkNvbHVtbnMoY2F0YWxv\nZywgc2NoZW1hLCB0YWJsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIC8qKgogICAgICAgICAqIFN0YXRlbWVudCB3cmFwcGVyIHRoYXQg\nbG9ncyBTUUwgdG8gdGhlIHBhcmVudCBkYXRhIHNvdXJjZSBhbmQKICAgICAg\nICAgKiByZW1lbWJlcnMgdGhlIGxhc3QgcGllY2Ugb2YgU1FMIHRvIGJlIGV4\nZWN1dGVkIG9uIGl0LgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgY2xh\nc3MgTG9nZ2luZ1N0YXRlbWVudCBleHRlbmRzIERlbGVnYXRpbmdTdGF0ZW1l\nbnQgewoKICAgICAgICAgICAgcHJpdmF0ZSBTdHJpbmcgX3NxbCA9IG51bGw7\nCgogICAgICAgICAgICBwdWJsaWMgTG9nZ2luZ1N0YXRlbWVudChTdGF0ZW1l\nbnQgc3RtbnQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgc3VwZXIoc3RtbnQsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBhcHBlbmRJbmZv\nKFN0cmluZ0J1ZmZlciBidWYpIHsKICAgICAgICAgICAgICAgIGlmIChfc3Fs\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIg\nIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKF9mb3JtYXR0ZXIgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoX2Zvcm1hdHRl\nci5wcmV0dHlQcmludChfc3FsKSk7CiAgICAgICAgICAgICAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChfc3Fs\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQg\nd3JhcFJlc3VsdChSZXN1bHRTZXQgcnMsIGJvb2xlYW4gd3JhcCkgewogICAg\nICAgICAgICAgICAgaWYgKCF3cmFwIHx8IHJzID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIHN1cGVyLndyYXBSZXN1bHQocnMsIHdyYXAp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMb2dnaW5nUmVzdWx0U2V0\nKHJzLCB0aGlzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGlj\nIHZvaWQgY2FuY2VsKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImNhbmNlbCAiICsgdGhpcywgTG9n\nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICBzdXBlci5j\nYW5jZWwoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvdGVjdGVk\nIFJlc3VsdFNldCBleGVjdXRlUXVlcnkoU3RyaW5nIHNxbCwgYm9vbGVhbiB3\ncmFwKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBfc3FsID0gc3FsOwogICAgICAgICAgICAgICAgbG9n\nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3Rl\nbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVF1ZXJ5\nKHNxbCwgd3JhcCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyB3cmFwKHNl\nLCBMb2dnaW5nU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsK\nICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdT\ndGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyBpbnQgZXhlY3V0ZVVwZGF0ZShTdHJp\nbmcgc3FsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIF9zcWwgPSBzcWw7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAg\nICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1l\nTWlsbGlzKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlVXBkYXRlKHNxbCk7CiAgICAg\nICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyB3cmFwKHNlLCBMb2dnaW5nU3RhdGVtZW50\nLnRoaXMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAg\nICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdTdGF0ZW1lbnQudGhpcyk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyBib29sZWFuIGV4ZWN1dGUoU3RyaW5nIHNxbCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgICAgICBfc3FsID0gc3FsOwogICAgICAg\nICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZXhlY3V0ZShzcWwpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgd3JhcChz\nZSwgTG9nZ2luZ1N0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7\nCiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5n\nU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIGNsYXNzIExvZ2dpbmdQ\ncmVwYXJlZFN0YXRlbWVudAogICAgICAgICAgICBleHRlbmRzIERlbGVnYXRp\nbmdQcmVwYXJlZFN0YXRlbWVudCB7CgogICAgICAgICAgICBwcml2YXRlIGZp\nbmFsIFN0cmluZyBfc3FsOwogICAgICAgICAgICBwcml2YXRlIExpc3QgX3Bh\ncmFtcyA9IG51bGw7CiAgICAgICAgICAgIHByaXZhdGUgTGlzdCBfcGFyYW1C\nYXRjaCA9IG51bGw7CgogICAgICAgICAgICBwdWJsaWMgTG9nZ2luZ1ByZXBh\ncmVkU3RhdGVtZW50KFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBTdHJpbmcg\nc3FsKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBzdXBlcihzdG1udCwgTG9nZ2luZ0Nvbm5lY3Rpb24u\ndGhpcyk7CiAgICAgICAgICAgICAgICBfc3FsID0gc3FsOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwcm90ZWN0ZWQgUmVzdWx0U2V0IHdyYXBSZXN1\nbHQoUmVzdWx0U2V0IHJzLCBib29sZWFuIHdyYXApIHsKICAgICAgICAgICAg\nICAgIGlmICghd3JhcCB8fCBycyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBzdXBlci53cmFwUmVzdWx0KHJzLCB3cmFwKTsKICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgTG9nZ2luZ1Jlc3VsdFNldChycywgdGhp\ncyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBSZXN1\nbHRTZXQgZXhlY3V0ZVF1ZXJ5KFN0cmluZyBzcWwsIGJvb2xlYW4gd3JhcCkK\nICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZXhlY3V0ZVF1ZXJ5KHNxbCwgd3JhcCk7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICB0\naHJvdyB3cmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcyk7\nCiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\nICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGNsZWFy\nTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAgICAgICAgICBoYW5k\nbGVTUUxXYXJuaW5nKExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50aGlzKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIGludCBleGVjdXRlVXBkYXRlKFN0cmluZyBzcWwpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgbG9nU1FMKHRoaXMpOwog\nICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVVwZGF0ZShzcWwpOwogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgd3JhcChzZSwgTG9nZ2luZ1ByZXBhcmVk\nU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAg\nICAgICAgICAgICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAg\nICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5nUHJlcGFyZWRT\ndGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIGV4ZWN1dGUoU3RyaW5n\nIHNxbCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBs\nb2dTUUwodGhpcyk7CiAgICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlKHNx\nbCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyB3cmFwKHNlLCBMb2dnaW5n\nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwog\nICAgICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsK\nICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdQ\ncmVwYXJlZFN0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNldCBl\neGVjdXRlUXVlcnkoYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAg\nICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmV4ZWN1dGVRdWVyeSh3cmFwKTsKICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAg\nICAgIHRocm93IHdyYXAoc2UsIExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50\naGlzKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAg\nY2xlYXJMb2dQYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAgICAg\nIGhhbmRsZVNRTFdhcm5pbmcoTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRo\naXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgaW50IGV4ZWN1dGVVcGRhdGUoKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAg\nICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxs\naXMoKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHN1cGVyLmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAg\nICAgICAgIHRocm93IHdyYXAoc2UsIExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVu\ndC50aGlzKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAg\nICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAg\nICAgIGhhbmRsZVNRTFdhcm5pbmcoTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50\nLnRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgaW50W10gZXhlY3V0ZUJhdGNoKCkgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAg\nICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1l\nTWlsbGlzKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlQmF0Y2goKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgICAgIC8vIGlmIHRoZSBleGNlcHRpb24gaXMgYSBCYXRjaFVwZGF0\nZUV4Y2VwdGlvbiwgYW5kCiAgICAgICAgICAgICAgICAgICAgLy8gd2UgYXJl\nIHRyYWNraW5nIHBhcmFtZXRlcnMsIHRoZW4gc2V0IHRoZSBjdXJyZW50CiAg\nICAgICAgICAgICAgICAgICAgLy8gcGFyYW1ldGVyIHNldCB0byBiZSB0aGUg\naW5kZXggb2YgdGhlIGZhaWxlZAogICAgICAgICAgICAgICAgICAgIC8vIHN0\nYXRlbWVudCBzbyB0aGF0IHRoZSBSZXBvcnRpbmdTUUxFeGNlcHRpb24gd2ls\nbAogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIGNvcnJlY3QgcGFy\nYW0KICAgICAgICAgICAgICAgICAgICBpZiAoc2UgaW5zdGFuY2VvZiBCYXRj\naFVwZGF0ZUV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAmJiBf\ncGFyYW1CYXRjaCAhPSBudWxsICYmIHNob3VsZFRyYWNrUGFyYW1ldGVycygp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludFtdIGNvdW50ID0gKChC\nYXRjaFVwZGF0ZUV4Y2VwdGlvbikgc2UpLgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZ2V0VXBkYXRlQ291bnRzKCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChjb3VudCAhPSBudWxsICYmIGNvdW50Lmxlbmd0aCA8PSBf\ncGFyYW1CYXRjaC5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBpbmRleCA9IC0xOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjb3VudC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIC0zIGlzIFN0YXRlbWVudC5TVEFURU1FTlRfRkFJTEVE\nLCBidXQgaXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBv\nbmx5IGF2YWlsYWJsZSBpbiBKREsgMS40KwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGlmIChjb3VudFtpXSA9PSAtMykgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGk7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBubyAt\nMyBlbGVtZW50OiBpdCBtYXkgYmUgdGhhdCB0aGUgc2VydmVyIHN0b3BwZWQK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByb2Nlc3NpbmcsIHNv\nIHRoZSBzaXplIG9mIHRoZSBjb3VudCB3aWxsIGJlCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAvLyB0aGUgaW5kZXgKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGlmIChpbmRleCA9PSAtMSkKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBpbmRleCA9IGNvdW50Lmxlbmd0aCArIDE7CgogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjdXJyZW50IHBh\ncmFtcyB0byB0aGUgc2F2ZWQgdmFsdWVzCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoaW5kZXggPCBfcGFyYW1CYXRjaC5zaXplKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgX3BhcmFtcyA9IChMaXN0KSBf\ncGFyYW1CYXRjaC5nZXQoaW5kZXgpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIHRocm93IHdyYXAoc2UsIExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50aGlz\nKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgY2xl\nYXJMb2dQYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAgICAgIGhh\nbmRsZVNRTFdhcm5pbmcoTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRoaXMp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBleGVjdXRlKCkgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAg\nICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7\nCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBzdXBlci5leGVjdXRlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICB0aHJv\ndyB3cmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcyk7CiAg\nICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAg\nIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGNsZWFyTG9n\nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVT\nUUxXYXJuaW5nKExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50aGlzKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgY2FuY2VsKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImNhbmNlbCAiICsgdGhpcyAr\nICI6ICIgKyBfc3FsLAogICAgICAgICAgICAgICAgICAgICAgICBMb2dnaW5n\nQ29ubmVjdGlvbi50aGlzKTsKCiAgICAgICAgICAgICAgICBzdXBlci5jYW5j\nZWwoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2V0TnVsbChpbnQgaTEsIGludCBpMikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJudWxsIiwg\nbnVsbCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXROdWxsKGkxLCBpMik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEJv\nb2xlYW4oaW50IGksIGJvb2xlYW4gYikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgYik7CiAgICAg\nICAgICAgICAgICBzdXBlci5zZXRCb29sZWFuKGksIGIpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRCeXRlKGludCBpLCBi\neXRlIGIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nc2V0TG9nUGFyYW1ldGVyKGksIGIpOwogICAgICAgICAgICAgICAgc3VwZXIu\nc2V0Qnl0ZShpLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0U2hvcnQoaW50IGksIHNob3J0IHMpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGks\nIHMpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0U2hvcnQoaSwgcyk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEludChp\nbnQgaTEsIGludCBpMikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsIGkyKTsKICAgICAgICAgICAg\nICAgIHN1cGVyLnNldEludChpMSwgaTIpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBzZXRMb25nKGludCBpLCBsb25nIGwpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGksIGwpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0TG9uZyhp\nLCBsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2V0RmxvYXQoaW50IGksIGZsb2F0IGYpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksIGYpOwogICAg\nICAgICAgICAgICAgc3VwZXIuc2V0RmxvYXQoaSwgZik7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldERvdWJsZShpbnQgaSwg\nZG91YmxlIGQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgc2V0TG9nUGFyYW1ldGVyKGksIGQpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0RG91YmxlKGksIGQpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBzZXRCaWdEZWNpbWFsKGludCBpLCBCaWdEZWNpbWFs\nIGJkKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIkJpZ0RlY2ltYWwi\nLCBiZCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRCaWdEZWNpbWFsKGks\nIGJkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2V0U3RyaW5nKGludCBpLCBTdHJpbmcgcykgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlN0cmlu\nZyIsIHMpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0U3RyaW5nKGksIHMp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRC\neXRlcyhpbnQgaSwgYnl0ZVtdIGIpIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJieXRlW10iLCBi\nKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldEJ5dGVzKGksIGIpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXREYXRlKGlu\ndCBpLCBEYXRlIGQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJEYXRlIiwgZCk7CiAgICAgICAg\nICAgICAgICBzdXBlci5zZXREYXRlKGksIGQpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRUaW1lKGludCBpLCBUaW1lIHQp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9n\nUGFyYW1ldGVyKGksICJUaW1lIiwgdCk7CiAgICAgICAgICAgICAgICBzdXBl\nci5zZXRUaW1lKGksIHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRUaW1lc3RhbXAoaW50IGksIFRpbWVzdGFtcCB0KSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpLCAiVGltZXN0YW1wIiwgdCk7CiAgICAgICAgICAgICAgICBz\ndXBlci5zZXRUaW1lc3RhbXAoaSwgdCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNldEFzY2lpU3RyZWFtKGludCBpMSwgSW5w\ndXRTdHJlYW0gaXMsIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGkxLCAiSW5wdXRTdHJlYW0iLCBpcyk7CiAgICAgICAgICAgICAgICBzdXBl\nci5zZXRBc2NpaVN0cmVhbShpMSwgaXMsIGkyKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VW5pY29kZVN0cmVhbShpbnQg\naTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAgICAgICAgICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMpOwogICAgICAgICAgICAg\nICAgc3VwZXIuc2V0VW5pY29kZVN0cmVhbShpMiwgaXMsIGkyKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0QmluYXJ5U3Ry\nZWFtKGludCBpMSwgSW5wdXRTdHJlYW0gaXMsIGludCBpMikKICAgICAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nc2V0TG9nUGFyYW1ldGVyKGkxLCAiSW5wdXRTdHJlYW0iLCBpcyk7CiAgICAg\nICAgICAgICAgICBzdXBlci5zZXRCaW5hcnlTdHJlYW0oaTEsIGlzLCBpMik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNsZWFy\nUGFyYW1ldGVycygpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKGZhbHNlKTsKICAgICAgICAgICAg\nICAgIHN1cGVyLmNsZWFyUGFyYW1ldGVycygpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRPYmplY3QoaW50IGkxLCBPYmpl\nY3QgbywgaW50IGkyLCBpbnQgaTMpCiAgICAgICAgICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRl\ncihpMSwgIk9iamVjdCIsIG8pOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0\nT2JqZWN0KGkxLCBvLCBpMiwgaTMpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgdm9pZCBzZXRPYmplY3QoaW50IGkxLCBPYmplY3Qgbywg\naW50IGkyKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJPYmplY3Qi\nLCBvKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldE9iamVjdChpMSwgbywg\naTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBz\nZXRPYmplY3QoaW50IGksIE9iamVjdCBvKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiT2JqZWN0\nIiwgbyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRPYmplY3QoaSwgbyk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFkZEJh\ndGNoKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBp\nZiAoX2xvZ3MuaXNTUUxFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAg\nX2xvZ3MubG9nU1FMKCJiYXRjaGluZyAiICsgdGhpcywgTG9nZ2luZ0Nvbm5l\nY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIHN1cGVyLmFkZEJhdGNoKCk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNrUGFyYW1ldGVycygpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBvdXIgbGlz\ndCBpcyBpbml0aWFsaXplZAogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\nX3BhcmFtQmF0Y2ggPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIF9wYXJhbUJhdGNoID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBjb3B5IHBhcmFtZXRlcnMgc2luY2UgdGhleSB3\naWxsIGJlIHJlLXVzZWQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9w\nYXJhbXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9w\nYXJhbUJhdGNoLmFkZChuZXcgQXJyYXlMaXN0KF9wYXJhbXMpKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgX3BhcmFtQmF0Y2guYWRkKG51bGwpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBzZXRDaGFyYWN0ZXJTdHJlYW0oaW50IGkxLCBSZWFkZXIgciwg\naW50IGkyKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJSZWFkZXIi\nLCByKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldENoYXJhY3RlclN0cmVh\nbShpMSwgciwgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBzZXRSZWYoaW50IGksIFJlZiByKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiUmVm\nIiwgcik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRSZWYoaSwgcik7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEJsb2Io\naW50IGksIEJsb2IgYikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIkJsb2IiLCBiKTsKICAgICAg\nICAgICAgICAgIHN1cGVyLnNldEJsb2IoaSwgYik7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldENsb2IoaW50IGksIENsb2Ig\nYykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRM\nb2dQYXJhbWV0ZXIoaSwgIkNsb2IiLCBjKTsKICAgICAgICAgICAgICAgIHN1\ncGVyLnNldENsb2IoaSwgYyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHNldEFycmF5KGludCBpLCBBcnJheSBhKSB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRl\ncihpLCAiQXJyYXkiLCBhKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldEFy\ncmF5KGksIGEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\nUmVzdWx0U2V0TWV0YURhdGEgZ2V0TWV0YURhdGEoKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRNZXRh\nRGF0YSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBzZXREYXRlKGludCBpLCBEYXRlIGQsIENhbGVuZGFyIGMpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGksICJEYXRlIiwgZCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXREYXRl\nKGksIGQsIGMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRUaW1lKGludCBpLCBUaW1lIHQsIENhbGVuZGFyIGMpIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1l\ndGVyKGksICJUaW1lIiwgdCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRU\naW1lKGksIHQsIGMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBzZXRUaW1lc3RhbXAoaW50IGksIFRpbWVzdGFtcCB0LCBDYWxl\nbmRhciBjKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlRpbWVzdGFt\ncCIsIHQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0VGltZXN0YW1wKGks\nIHQsIGMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBzZXROdWxsKGludCBpMSwgaW50IGkyLCBTdHJpbmcgcykgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naTEsICJudWxsIiwgbnVsbCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRO\ndWxsKGkxLCBpMiwgcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBy\nb3RlY3RlZCB2b2lkIGFwcGVuZEluZm8oU3RyaW5nQnVmZmVyIGJ1Zikgewog\nICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiICIpOwogICAgICAgICAgICAg\nICAgaWYgKF9mb3JtYXR0ZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoU0VQKTsKICAgICAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKF9mb3JtYXR0ZXIucHJldHR5UHJpbnQoX3NxbCkpOwogICAgICAg\nICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoU0VQKTsKICAgICAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChfc3Fs\nKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBTdHJpbmdC\ndWZmZXIgcGFyYW1CdWYgPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKF9w\nYXJhbXMgIT0gbnVsbCAmJiAhX3BhcmFtcy5pc0VtcHR5KCkpIHsKICAgICAg\nICAgICAgICAgICAgICBwYXJhbUJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsK\nICAgICAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF9wYXJh\nbXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgcGFyYW1CdWYuYXBwZW5kKGl0ci5uZXh0KCkpOwogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHBhcmFtQnVmLmFwcGVuZCgiLCAiKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgaWYgKHBhcmFtQnVmICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAoIV9wcmV0dHlQcmludCkKICAgICAgICAgICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiICIpOwogICAgICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIltwYXJhbXM9IikuCiAgICAgICAgICAgICAgICAgICAg\nICAgIGFwcGVuZChwYXJhbUJ1Zi50b1N0cmluZygpKS5hcHBlbmQoIl0iKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN1cGVyLmFwcGVu\nZEluZm8oYnVmKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0\nZSB2b2lkIGNsZWFyTG9nUGFyYW1ldGVycyhib29sZWFuIGJhdGNoKSB7CiAg\nICAgICAgICAgICAgICBpZiAoX3BhcmFtcyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgICAgIF9wYXJhbXMuY2xlYXIoKTsKICAgICAgICAgICAgICAgIGlm\nIChiYXRjaCAmJiBfcGFyYW1CYXRjaCAhPSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIF9wYXJhbUJhdGNoLmNsZWFyKCk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHByaXZhdGUgYm9vbGVhbiBzaG91bGRUcmFja1BhcmFtZXRl\ncnMoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RyYWNrUGFyYW1ldGVy\ncyB8fCBfbG9ncy5pc1NRTEVuYWJsZWQoKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5k\nZXgsIGJvb2xlYW4gdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hvdWxk\nVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0TG9n\nUGFyYW1ldGVyKGluZGV4LCAiKGJvb2xlYW4pICIgKyB2YWwpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1l\ndGVyKGludCBpbmRleCwgYnl0ZSB2YWwpIHsKICAgICAgICAgICAgICAgIGlm\nIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAg\nICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoYnl0ZSkgIiArIHZhbCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQ\nYXJhbWV0ZXIoaW50IGluZGV4LCBkb3VibGUgdmFsKSB7CiAgICAgICAgICAg\nICAgICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAg\nICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKGRvdWJsZSkgIiAr\nIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9p\nZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBmbG9hdCB2YWwpIHsKICAg\nICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAg\nICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoZmxv\nYXQpICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2\nYXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgaW50IHZhbCkg\newogICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNrUGFyYW1ldGVycygp\nKQogICAgICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpbmRleCwg\nIihpbnQpICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBw\ncml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgbG9uZyB2\nYWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRl\ncnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5k\nZXgsICIobG9uZykgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBz\naG9ydCB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1Bh\ncmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0\nZXIoaW5kZXgsICIoc2hvcnQpICIgKyB2YWwpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBp\nbmRleCwgU3RyaW5nIHR5cGUsIE9iamVjdCB2YWwpIHsKICAgICAgICAgICAg\nICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoIiArIHR5cGUgKyAi\nKSAiICsgdmFsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0\nZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5kZXgsIFN0cmluZyB2YWwp\nIHsKICAgICAgICAgICAgICAgIGlmIChfcGFyYW1zID09IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgX3BhcmFtcyA9IG5ldyBBcnJheUxpc3QoKTsKICAg\nICAgICAgICAgICAgIHdoaWxlIChfcGFyYW1zLnNpemUoKSA8IGluZGV4KQog\nICAgICAgICAgICAgICAgICAgIF9wYXJhbXMuYWRkKG51bGwpOwogICAgICAg\nICAgICAgICAgaWYgKHZhbC5sZW5ndGgoKSA+IDgwKQogICAgICAgICAgICAg\nICAgICAgIHZhbCA9IHZhbC5zdWJzdHJpbmcoMCwgNzcpICsgIi4uLiI7CiAg\nICAgICAgICAgICAgICBfcGFyYW1zLnNldChpbmRleCAtIDEsIHZhbCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIFdhcm5pbmctaGFuZGxpbmcgcmVzdWx0IHNldC4KICAgICAgICAgKi8KICAg\nICAgICBwcml2YXRlIGNsYXNzIExvZ2dpbmdSZXN1bHRTZXQgZXh0ZW5kcyBE\nZWxlZ2F0aW5nUmVzdWx0U2V0IHsKCiAgICAgICAgICAgIHB1YmxpYyBMb2dn\naW5nUmVzdWx0U2V0KFJlc3VsdFNldCBycywgU3RhdGVtZW50IHN0bW50KSB7\nCiAgICAgICAgICAgICAgICBzdXBlcihycywgc3RtbnQpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBuZXh0KCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBzdXBlci5uZXh0KCk7CiAgICAgICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNR\nTFdhcm5pbmcoTG9nZ2luZ1Jlc3VsdFNldC50aGlzKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nY2xvc2UoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgc3VwZXIuY2xvc2UoKTsKICAg\nICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAg\naGFuZGxlU1FMV2FybmluZyhMb2dnaW5nUmVzdWx0U2V0LnRoaXMpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBiZWZvcmVGaXJzdCgpIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdXBl\nci5iZWZvcmVGaXJzdCgpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdS\nZXN1bHRTZXQudGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyTGFzdCgpIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICBzdXBlci5hZnRlckxhc3QoKTsKICAgICAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FM\nV2FybmluZyhMb2dnaW5nUmVzdWx0U2V0LnRoaXMpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBmaXJzdCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZmly\nc3QoKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5nUmVzdWx0U2V0LnRo\naXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgYm9vbGVhbiBsYXN0KCkgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBzdXBlci5sYXN0KCk7CiAgICAgICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoTG9n\nZ2luZ1Jlc3VsdFNldC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gYWJzb2x1dGUo\naW50IGEpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuYWJzb2x1\ndGUoYSk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoTG9nZ2luZ1Jlc3VsdFNldC50\naGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIGJvb2xlYW4gcmVsYXRpdmUoaW50IGEpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwZXIucmVsYXRpdmUoYSk7CiAgICAgICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGhhbmRs\nZVNRTFdhcm5pbmcoTG9nZ2luZ1Jlc3VsdFNldC50aGlzKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJv\nb2xlYW4gcHJldmlvdXMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLnByZXZpb3VzKCk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoTG9nZ2luZ1Jl\nc3VsdFNldC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

