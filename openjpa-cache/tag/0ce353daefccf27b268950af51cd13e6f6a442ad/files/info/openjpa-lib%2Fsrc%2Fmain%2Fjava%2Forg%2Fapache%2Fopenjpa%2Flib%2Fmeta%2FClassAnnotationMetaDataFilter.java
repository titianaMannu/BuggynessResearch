{"sha":"ba40d47f79e8e1e304ccf54b819e662ae0866500","node_id":"MDQ6QmxvYjIwNjM2NDpiYTQwZDQ3Zjc5ZThlMWUzMDRjY2Y1NGI4MTllNjYyYWUwODY2NTAw","size":6003,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ba40d47f79e8e1e304ccf54b819e662ae0866500","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIubWV0YTsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9u\nOwoKaW1wb3J0IHNlcnAuYnl0ZWNvZGUubG93bGV2ZWwuQ29uc3RhbnRQb29s\nVGFibGU7CgovKioKICogRmlsdGVyIHRoYXQgbG9va3MgZm9yIGNsYXNzZXMg\nd2l0aCBvbmUgb2YgYSBzZXQgb2YgYW5ub3RhdGlvbnMuCiAqIFNlZSBKREsg\nMS41IEpWTSBzcGVjIGZvciBkZXRhaWxzIG9uIGFubm90YXRpb24gYnl0ZWNv\nZGU6PGJyIC8+CiAqIGphdmEuc3VuLmNvbS9kb2NzL2Jvb2tzL3Ztc3BlYy8y\nbmQtZWRpdGlvbi9DbGFzc0ZpbGVGb3JtYXQtZmluYWwtZHJhZnQucGRmCiAq\nCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1Ymxp\nYyBjbGFzcyBDbGFzc0Fubm90YXRpb25NZXRhRGF0YUZpbHRlciBpbXBsZW1l\nbnRzIE1ldGFEYXRhRmlsdGVyIHsKCiAgICBwcml2YXRlIGZpbmFsIFN0cmlu\nZ1tdIF9hbm5vczsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBw\nbHkgYW5ub3RhdGlvbiB0byBtYXRjaCBhZ2FpbnN0LgogICAgICovCiAgICBw\ndWJsaWMgQ2xhc3NBbm5vdGF0aW9uTWV0YURhdGFGaWx0ZXIoQ2xhc3MgYW5u\nbykgewogICAgICAgIHRoaXMobmV3IENsYXNzW117IGFubm8gfSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGFubm90YXRp\nb25zIHRvIG1hdGNoIGFnYWluc3QuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\nc0Fubm90YXRpb25NZXRhRGF0YUZpbHRlcihDbGFzc1tdIGFubm9zKSB7CiAg\nICAgICAgX2Fubm9zID0gbmV3IFN0cmluZ1thbm5vcy5sZW5ndGhdOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYW5ub3MubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgIF9hbm5vc1tpXSA9ICJMIiArIGFubm9zW2ldLmdldE5hbWUo\nKS5yZXBsYWNlKCcuJywgJy8nKSArICI7IjsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBtYXRjaGVzKFJlc291cmNlIHJzcmMpIHRocm93cyBJT0V4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKF9hbm5vcy5sZW5ndGggPT0gMCB8fCAhcnNy\nYy5nZXROYW1lKCkuZW5kc1dpdGgoIi5jbGFzcyIpKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENvbnN0\nYW50UG9vbFRhYmxlIHRhYmxlID0gbmV3IENvbnN0YW50UG9vbFRhYmxlKHJz\ncmMuZ2V0Q29udGVudCgpKTsKICAgICAgICAgICAgaW50IGlkeCA9IHRhYmxl\nLmdldEVuZEluZGV4KCk7CiAgICAgICAgICAgIGlkeCArPSA2OyAvLyBza2lw\nIGFjY2VzcywgY2xzLCBzdXBlcgoKICAgICAgICAgICAgLy8gc2tpcCBpbnRl\ncmZhY2VzCiAgICAgICAgICAgIGludCBpbnRlcmZhY2VzID0gdGFibGUucmVh\nZFVuc2lnbmVkU2hvcnQoaWR4KTsKICAgICAgICAgICAgaWR4ICs9IDIgKyBp\nbnRlcmZhY2VzICogMjsKCiAgICAgICAgICAgIC8vIHNraXAgZmllbGRzIGFu\nZCBtZXRob2RzCiAgICAgICAgICAgIGludCBmaWVsZHMgPSB0YWJsZS5yZWFk\nVW5zaWduZWRTaG9ydChpZHgpOwogICAgICAgICAgICBpZHggKz0gMjsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmaWVsZHM7IGkrKykKICAg\nICAgICAgICAgICAgIGlkeCArPSBza2lwRmllbGRPck1ldGhvZCh0YWJsZSwg\naWR4KTsKICAgICAgICAgICAgaW50IG1ldGhvZHMgPSB0YWJsZS5yZWFkVW5z\naWduZWRTaG9ydChpZHgpOwogICAgICAgICAgICBpZHggKz0gMjsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtZXRob2RzOyBpKyspCiAgICAg\nICAgICAgICAgICBpZHggKz0gc2tpcEZpZWxkT3JNZXRob2QodGFibGUsIGlk\neCk7CgogICAgICAgICAgICAvLyBsb29rIGZvciBhbm5vdGF0aW9uIGF0dHJz\nCiAgICAgICAgICAgIGludCBhdHRycyA9IHRhYmxlLnJlYWRVbnNpZ25lZFNo\nb3J0KGlkeCk7CiAgICAgICAgICAgIGlkeCArPSAyOwogICAgICAgICAgICBp\nbnQgbmFtZTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhdHRy\nczsgaSsrKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gdGFibGUucmVhZFVu\nc2lnbmVkU2hvcnQoaWR4KTsKICAgICAgICAgICAgICAgIGlkeCArPSAyOwog\nICAgICAgICAgICAgICAgaWYgKCJSdW50aW1lVmlzaWJsZUFubm90YXRpb25z\nIi5lcXVhbHModGFibGUucmVhZFN0cmluZwogICAgICAgICAgICAgICAgICAg\nICh0YWJsZS5nZXQobmFtZSkpKSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gbWF0Y2hBbm5vdGF0aW9ucyh0YWJsZSwgaWR4ICsgNCk7CiAgICAgICAg\nICAgICAgICBpZHggKz0gNCArIHRhYmxlLnJlYWRJbnQoaWR4KTsKICAgICAg\nICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEFycmF5SW5kZXhPdXRPZkJvdW5k\nc0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBDbGFzc0Zv\ncm1hdEVycm9yKHJzcmMuZ2V0TmFtZSgpKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdo\nZXRoZXIgdGhlIGdpdmVuIGFubm90YXRpb25zIG1hdGNoIG91ciBjYW5kaWRh\ndGVzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gbWF0Y2hBbm5vdGF0\naW9ucyhDb25zdGFudFBvb2xUYWJsZSB0YWJsZSwgaW50IGlkeCkgewogICAg\nICAgIGludCBhbm5vcyA9IHRhYmxlLnJlYWRVbnNpZ25lZFNob3J0KGlkeCk7\nCiAgICAgICAgaWR4ICs9IDI7CgogICAgICAgIGludCB0eXBlOwogICAgICAg\nIGludCBwcm9wczsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFubm9z\nOyBpKyspIHsKICAgICAgICAgICAgdHlwZSA9IHRhYmxlLnJlYWRVbnNpZ25l\nZFNob3J0KGlkeCk7CiAgICAgICAgICAgIGlkeCArPSAyOwogICAgICAgICAg\nICBpZiAobWF0Y2hBbm5vdGF0aW9uKHRhYmxlLnJlYWRTdHJpbmcodGFibGUu\nZ2V0KHR5cGUpKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAg\nICAgICAgICAgIHByb3BzID0gdGFibGUucmVhZFVuc2lnbmVkU2hvcnQoaWR4\nKTsKICAgICAgICAgICAgaWR4ICs9IDI7CiAgICAgICAgICAgIGZvciAoaW50\nIGogPSAwOyBqIDwgcHJvcHM7IGorKykgewogICAgICAgICAgICAgICAgaWR4\nICs9IDI7IC8vIG5hbWUKICAgICAgICAgICAgICAgIGlkeCArPSBza2lwQW5u\nb3RhdGlvblByb3BlcnR5VmFsdWUodGFibGUsIGlkeCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVuIGFubm90YXRp\nb24gbWF0Y2hlcyBvdXIgY2FuZGlkYXRlcy4KICAgICAqLwogICAgcHJpdmF0\nZSBib29sZWFuIG1hdGNoQW5ub3RhdGlvbihTdHJpbmcgbmFtZSkgewogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Fubm9zLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBpZiAobmFtZS5lcXVhbHMoX2Fubm9zW2ldKSkKICAgICAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNraXAgYW4gYW5ub3RhdGlvbiBwcm9w\nZXJ0eSB2YWx1ZSwgcmV0dXJuaW5nIHRoZSBudW1iZXIgb2YgYnl0ZXMgc2tp\ncHBlZC4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgaW50IHNraXBBbm5v\ndGF0aW9uUHJvcGVydHlWYWx1ZShDb25zdGFudFBvb2xUYWJsZSB0YWJsZSwK\nICAgICAgICBpbnQgaWR4KSB7CiAgICAgICAgaW50IHNraXBwZWQgPSAwOwog\nICAgICAgIHN3aXRjaCAodGFibGUucmVhZEJ5dGUoaWR4ICsgc2tpcHBlZCsr\nKSkgewogICAgICAgICAgICBjYXNlICdaJzogLy8gYm9vbAogICAgICAgICAg\nICBjYXNlICdCJzogLy8gYnl0ZQogICAgICAgICAgICBjYXNlICdDJzogLy8g\nY2hhcgogICAgICAgICAgICBjYXNlICdEJzogLy8gZG91YmxlCiAgICAgICAg\nICAgIGNhc2UgJ0YnOiAvLyBmbG9hdAogICAgICAgICAgICBjYXNlICdJJzog\nLy8gaW50CiAgICAgICAgICAgIGNhc2UgJ0onOiAvLyBsb25nCiAgICAgICAg\nICAgIGNhc2UgJ1MnOiAvLyBzaG9ydAogICAgICAgICAgICBjYXNlICdzJzog\nLy8gc3RyaW5nCiAgICAgICAgICAgIGNhc2UgJ2MnOiAvLyBjbGFzcwogICAg\nICAgICAgICAgICAgc2tpcHBlZCArPSAyOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgJ2UnOiAvLyBlbnVtIHB0cgogICAgICAg\nICAgICAgICAgc2tpcHBlZCArPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgJ1snOiAvLyBhcnJheQogICAgICAgICAgICAg\nICAgaW50IHNpemUgPSB0YWJsZS5yZWFkVW5zaWduZWRTaG9ydChpZHggKyBz\na2lwcGVkKTsKICAgICAgICAgICAgICAgIHNraXBwZWQgKz0gMjsKICAgICAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKQogICAg\nICAgICAgICAgICAgICAgIHNraXBwZWQgKz0KICAgICAgICAgICAgICAgICAg\nICAgICAgc2tpcEFubm90YXRpb25Qcm9wZXJ0eVZhbHVlKHRhYmxlLCBpZHgg\nKyBza2lwcGVkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlICdAJzogLy8gYW5ubwogICAgICAgICAgICAgICAgc2tpcHBlZCAr\nPSAyOyAvLyB0eXBlCiAgICAgICAgICAgICAgICBpbnQgcHJvcHMgPSB0YWJs\nZS5yZWFkVW5zaWduZWRTaG9ydChpZHggKyBza2lwcGVkKTsKICAgICAgICAg\nICAgICAgIHNraXBwZWQgKz0gMjsKICAgICAgICAgICAgICAgIGZvciAoaW50\nIGogPSAwOyBqIDwgcHJvcHM7IGorKykgewogICAgICAgICAgICAgICAgICAg\nIHNraXBwZWQgKz0gMjsgLy8gbmFtZQogICAgICAgICAgICAgICAgICAgIHNr\naXBwZWQgKz0KICAgICAgICAgICAgICAgICAgICAgICAgc2tpcEFubm90YXRp\nb25Qcm9wZXJ0eVZhbHVlKHRhYmxlLCBpZHggKyBza2lwcGVkKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gc2tpcHBlZDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNraXAgdGhlIGN1cnJlbnQgZmllbGQgb3IgbWV0aG9kLCByZXR1cm5pbmcg\ndGhlIG51bWJlciBvZiBieXRlcyBza2lwcGVkLgogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBpbnQgc2tpcEZpZWxkT3JNZXRob2QoQ29uc3RhbnRQb29s\nVGFibGUgdGFibGUsIGludCBpZHgpIHsKICAgICAgICBpbnQgYXR0cnMgPSB0\nYWJsZS5yZWFkVW5zaWduZWRTaG9ydChpZHggKyA2KTsKICAgICAgICBpbnQg\nc2tpcHBlZCA9IDg7CiAgICAgICAgaW50IGxlbjsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGF0dHJzOyBpKyspIHsKICAgICAgICAgICAgbGVuID0g\ndGFibGUucmVhZEludChpZHggKyBza2lwcGVkICsgMik7CiAgICAgICAgICAg\nIHNraXBwZWQgKz0gNiArIGxlbjsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIHNraXBwZWQ7CiAgICB9Cn0K\n","encoding":"base64"}

