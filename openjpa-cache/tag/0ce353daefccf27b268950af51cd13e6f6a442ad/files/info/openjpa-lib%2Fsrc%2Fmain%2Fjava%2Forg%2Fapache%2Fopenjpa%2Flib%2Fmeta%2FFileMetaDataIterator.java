{"sha":"8355e72a1a6d558c5ddfcf4fb7cb34339b18654f","node_id":"MDQ6QmxvYjIwNjM2NDo4MzU1ZTcyYTFhNmQ1NThjNWRkZmNmNGZiN2NiMzQzMzliMTg2NTRm","size":4907,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8355e72a1a6d558c5ddfcf4fb7cb34339b18654f","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIubWV0YTsKCmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheU91\ndHB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEu\naW8uRmlsZUlucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTm9TdWNoRWxlbWVudEV4Y2Vw\ndGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwoKLyoqCiAqIEl0ZXJhdG9yIG92ZXIgYSBmaWxlLCBvciBvdmVy\nIGFsbCBtZXRhZGF0YSByZXNvdXJjZXMgYmVsb3cgYSBnaXZlbiBkaXJlY3Rv\ncnkuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICov\nCnB1YmxpYyBjbGFzcyBGaWxlTWV0YURhdGFJdGVyYXRvciBpbXBsZW1lbnRz\nIE1ldGFEYXRhSXRlcmF0b3IgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIGxvbmcgU0NBTl9MSU1JVCA9IDEwMDAwMDsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdl\nCiAgICAgICAgKEZpbGVNZXRhRGF0YUl0ZXJhdG9yLmNsYXNzKTsKCiAgICBw\ncml2YXRlIGZpbmFsIEl0ZXJhdG9yIF9pdHI7CiAgICBwcml2YXRlIEZpbGUg\nX2ZpbGUgPSBudWxsOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1\ncHBseSBtZXRhZGF0YSBmaWxlLgogICAgICovCiAgICBwdWJsaWMgRmlsZU1l\ndGFEYXRhSXRlcmF0b3IoRmlsZSBmaWxlKSB7CiAgICAgICAgX2l0ciA9IENv\nbGxlY3Rpb25zLnNpbmdsZXRvbihmaWxlKS5pdGVyYXRvcigpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSByb290IG9mIGRp\ncmVjdG9yeSB0cmVlIHRvIHNlYXJjaCBhbmQgb3B0aW9uYWwKICAgICAqIGZp\nbGUgZmlsdGVyLgogICAgICovCiAgICBwdWJsaWMgRmlsZU1ldGFEYXRhSXRl\ncmF0b3IoRmlsZSBkaXIsIE1ldGFEYXRhRmlsdGVyIGZpbHRlcikKICAgICAg\nICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChkaXIgPT0gbnVs\nbCkKICAgICAgICAgICAgX2l0ciA9IG51bGw7CiAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgIENvbGxlY3Rpb24gbWV0YXMgPSBuZXcgQXJyYXlMaXN0KCk7\nCiAgICAgICAgICAgIEZpbGVSZXNvdXJjZSByc3JjID0gKGZpbHRlciA9PSBu\ndWxsKSA/IG51bGwgOiBuZXcgRmlsZVJlc291cmNlKCk7CiAgICAgICAgICAg\nIHNjYW4oZGlyLCBmaWx0ZXIsIHJzcmMsIG1ldGFzLCAwKTsKICAgICAgICAg\nICAgX2l0ciA9IG1ldGFzLml0ZXJhdG9yKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogU2NhbiBhbGwgZmlsZXMgYmVsb3cgdGhlIGdpdmVu\nIG9uZSBmb3IgbWV0YWRhdGEgZmlsZXMsIGFkZGluZyB0aGVtCiAgICAgKiB0\nbyB0aGUgZ2l2ZW4gY29sbGVjdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBp\nbnQgc2NhbihGaWxlIGZpbGUsIE1ldGFEYXRhRmlsdGVyIGZpbHRlciwgRmls\nZVJlc291cmNlIHJzcmMsCiAgICAgICAgQ29sbGVjdGlvbiBtZXRhcywgaW50\nIHNjYW5uZWQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHNj\nYW5uZWQgPiBTQ0FOX0xJTUlUKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxs\nZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJ0b28tbWFueS1maWxlcyIs\nCiAgICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihTQ0FOX0xJTUlUKSku\nZ2V0TWVzc2FnZSgpKTsKICAgICAgICBzY2FubmVkKys7CgogICAgICAgIGlm\nIChmaWx0ZXIgPT0gbnVsbCkKICAgICAgICAgICAgbWV0YXMuYWRkKGZpbGUp\nOwogICAgICAgIGVsc2UgewogICAgICAgICAgICByc3JjLnNldEZpbGUoZmls\nZSk7CiAgICAgICAgICAgIGlmIChmaWx0ZXIubWF0Y2hlcyhyc3JjKSkKICAg\nICAgICAgICAgICAgIG1ldGFzLmFkZChmaWxlKTsKICAgICAgICAgICAgZWxz\nZSB7CiAgICAgICAgICAgICAgICBGaWxlW10gZmlsZXMgPSBmaWxlLmxpc3RG\naWxlcygpOwogICAgICAgICAgICAgICAgaWYgKGZpbGVzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmaWxlcy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgc2Nhbm5lZCA9\nIHNjYW4oZmlsZXNbaV0sIGZpbHRlciwgcnNyYywgbWV0YXMsIHNjYW5uZWQp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBzY2Fu\nbmVkOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc05leHQoKSB7CiAg\nICAgICAgcmV0dXJuIF9pdHIgIT0gbnVsbCAmJiBfaXRyLmhhc05leHQoKTsK\nICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IG5leHQoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIGlmIChfaXRyID09IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBOb1N1Y2hFbGVtZW50RXhjZXB0aW9uKCk7CgogICAgICAg\nIF9maWxlID0gKEZpbGUpIF9pdHIubmV4dCgpOwogICAgICAgIHJldHVybiBf\nZmlsZS5nZXRBYnNvbHV0ZUZpbGUoKS50b1VSTCgpOwogICAgfQoKICAgIHB1\nYmxpYyBJbnB1dFN0cmVhbSBnZXRJbnB1dFN0cmVhbSgpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKF9maWxlID09IG51bGwpCiAgICAgICAg\nICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKTsKICAgICAg\nICByZXR1cm4gbmV3IEZpbGVJbnB1dFN0cmVhbShfZmlsZSk7CiAgICB9Cgog\nICAgcHVibGljIEZpbGUgZ2V0RmlsZSgpIHsKICAgICAgICBpZiAoX2ZpbGUg\nPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4\nY2VwdGlvbigpOwogICAgICAgIHJldHVybiBfZmlsZTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRp\nYyBjbGFzcyBGaWxlUmVzb3VyY2UgaW1wbGVtZW50cyBNZXRhRGF0YUZpbHRl\nci5SZXNvdXJjZSB7CgogICAgICAgIHByaXZhdGUgRmlsZSBfZmlsZSA9IG51\nbGw7CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEZpbGUoRmlsZSBmaWxlKSB7\nCiAgICAgICAgICAgIF9maWxlID0gZmlsZTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsKICAgICAgICAgICAgcmV0dXJu\nIF9maWxlLmdldE5hbWUoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBi\neXRlW10gZ2V0Q29udGVudCgpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIGxvbmcgbGVuID0gX2ZpbGUubGVuZ3RoKCk7CiAgICAgICAgICAg\nIEZpbGVJbnB1dFN0cmVhbSBmaW4gPSBuZXcgRmlsZUlucHV0U3RyZWFtKF9m\naWxlKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGJ5dGVb\nXSBjb250ZW50OwogICAgICAgICAgICAgICAgaWYgKGxlbiA8PSAwIHx8IGxl\nbiA+IEludGVnZXIuTUFYX1ZBTFVFKSB7CiAgICAgICAgICAgICAgICAgICAg\nLy8gc29tZSBKVk1zIGRvbid0IHJldHVybiBhIHByb3BlciBsZW5ndGgKICAg\nICAgICAgICAgICAgICAgICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gYm91dCA9\nIG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKICAgICAgICAgICAgICAg\nICAgICBieXRlW10gYnVmID0gbmV3IGJ5dGVbMTAyNF07IAogICAgICAgICAg\nICAgICAgICAgIGZvciAoaW50IHI7IChyID0gZmluLnJlYWQoYnVmKSkgIT0g\nLTE7KQogICAgICAgICAgICAgICAgICAgICAgICBib3V0LndyaXRlKGJ1Ziwg\nMCwgcik7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGJvdXQudG9C\neXRlQXJyYXkoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgY29udGVudCA9IG5ldyBieXRlWyhpbnQpIGxlbl07CiAg\nICAgICAgICAgICAgICAgICAgZm9yIChpbnQgciwgbyA9IDA7IG8gPCBjb250\nZW50Lmxlbmd0aCAmJiAociA9IGZpbi4KICAgICAgICAgICAgICAgICAgICAg\nICAgcmVhZChjb250ZW50LCBvLCBjb250ZW50Lmxlbmd0aCAtIG8pKSAhPSAt\nMTsgbyArPSByKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIHJldHVybiBjb250ZW50OwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgdHJ5IHsgZmluLmNsb3NlKCk7IH0gY2F0Y2ggKElPRXhj\nZXB0aW9uIGlvZSkge30KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nfQo=\n","encoding":"base64"}

