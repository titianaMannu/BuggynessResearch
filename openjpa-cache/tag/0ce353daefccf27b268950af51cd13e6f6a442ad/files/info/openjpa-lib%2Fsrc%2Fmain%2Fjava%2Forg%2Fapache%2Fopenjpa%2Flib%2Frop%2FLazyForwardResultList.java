{"sha":"7a735d1f9758d6ec6c829bc600c02a4430646a85","node_id":"MDQ6QmxvYjIwNjM2NDo3YTczNWQxZjk3NThkNmVjNmM4MjliYzYwMGMwMmE0NDMwNjQ2YTg1","size":4913,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7a735d1f9758d6ec6c829bc600c02a4430646a85","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIucm9wOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFt\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0Owpp\nbXBvcnQgamF2YS51dGlsLkxpc3RJdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uOwoKLyoqCiAqIExhenkgZm9yd2Fy\nZC1vbmx5IHJlc3VsdCBsaXN0LgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQog\nKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgTGF6eUZvcndhcmRSZXN1\nbHRMaXN0IGV4dGVuZHMgQWJzdHJhY3RTZXF1ZW50aWFsUmVzdWx0TGlzdAog\nICAgaW1wbGVtZW50cyBSZXN1bHRMaXN0IHsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBpbnQgT1BFTiA9IDA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgQ0xPU0VEID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGlu\ndCBGUkVFRCA9IDI7CgogICAgcHJpdmF0ZSBSZXN1bHRPYmplY3RQcm92aWRl\nciBfcm9wID0gbnVsbDsKICAgIHByaXZhdGUgZmluYWwgTGlzdCBfbGlzdCA9\nIG5ldyBBcnJheUxpc3QoKTsKICAgIHByaXZhdGUgaW50IF9zdGF0ZSA9IE9Q\nRU47CiAgICBwcml2YXRlIGludCBfc2l6ZSA9IC0xOwoKICAgIHB1YmxpYyBM\nYXp5Rm9yd2FyZFJlc3VsdExpc3QoUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9w\nKSB7CiAgICAgICAgX3JvcCA9IHJvcDsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBfcm9wLm9wZW4oKTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhj\nZXB0aW9uIHJlKSB7CiAgICAgICAgICAgIGNsb3NlKCk7CiAgICAgICAgICAg\nIHRocm93IHJlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGNsb3NlKCk7CiAgICAgICAgICAgIF9yb3AuaGFuZGxlQ2hl\nY2tlZEV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNQcm92aWRlck9wZW4oKSB7CiAgICAgICAgcmV0dXJuIF9z\ndGF0ZSA9PSBPUEVOOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzQ2xv\nc2VkKCkgewogICAgICAgIHJldHVybiBfc3RhdGUgPT0gQ0xPU0VEOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgIGlmIChfc3Rh\ndGUgIT0gQ0xPU0VEKSB7CiAgICAgICAgICAgIGZyZWUoKTsKICAgICAgICAg\nICAgX3N0YXRlID0gQ0xPU0VEOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGdldChpbnQgaW5kZXgpIHsKICAgICAgICBhc3NlcnRPcGVu\nKCk7CgogICAgICAgIC8vIG9wdGltaXphdGlvbiBmb3IgZ2V0dGluZyBzZXF1\nbnRpYWxseQogICAgICAgIGlmIChpbmRleCA9PSBfbGlzdC5zaXplKCkpCiAg\nICAgICAgICAgIGFkZE5leHQoKTsKICAgICAgICBpZiAoaW5kZXggPCBfbGlz\ndC5zaXplKCkpCiAgICAgICAgICAgIHJldHVybiBfbGlzdC5nZXQoaW5kZXgp\nOwoKICAgICAgICByZXR1cm4gc3VwZXIuZ2V0KGluZGV4KTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgTGlzdEl0ZXJhdG9yIGl0cihpbnQgaW5kZXgpIHsKICAg\nICAgICByZXR1cm4gKF9zdGF0ZSAhPSBPUEVOKSA/IF9saXN0Lmxpc3RJdGVy\nYXRvcihpbmRleCkgOiBuZXcgSXRyKGluZGV4KTsKICAgIH0KCiAgICBwdWJs\naWMgaW50IHNpemUoKSB7CiAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAg\nIGlmIChfc2l6ZSAhPSAtMSkKICAgICAgICAgICAgcmV0dXJuIF9zaXplOwog\nICAgICAgIGlmIChfc3RhdGUgIT0gT1BFTikKICAgICAgICAgICAgcmV0dXJu\nIF9saXN0LnNpemUoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBfc2l6\nZSA9IF9yb3Auc2l6ZSgpOwogICAgICAgICAgICByZXR1cm4gX3NpemU7CiAg\nICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAg\nICAgICBjbG9zZSgpOwogICAgICAgICAgICB0aHJvdyByZTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICBjbG9zZSgpOwog\nICAgICAgICAgICBfcm9wLmhhbmRsZUNoZWNrZWRFeGNlcHRpb24oZSk7CiAg\nICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICB9CgogICAgcHJp\ndmF0ZSBib29sZWFuIGFkZE5leHQoKSB7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgaWYgKCFfcm9wLm5leHQoKSkgewogICAgICAgICAgICAgICAgZnJl\nZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIF9saXN0LmFkZChfcm9wLmdldFJlc3VsdE9iamVj\ndCgpKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRj\naCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICBjbG9zZSgp\nOwogICAgICAgICAgICB0aHJvdyByZTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICBjbG9zZSgpOwogICAgICAgICAgICBf\ncm9wLmhhbmRsZUNoZWNrZWRFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIGZyZWUoKSB7CiAgICAgICAgaWYgKF9zdGF0ZSA9PSBPUEVOKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfcm9wLmNsb3NlKCk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgX3N0YXRlID0gRlJFRUQ7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBPYmplY3Qgd3JpdGVSZXBsYWNlKCkgdGhyb3dzIE9i\namVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAgICAgICAgLy8gZnVsbHkgdHJhdmVy\nc2UgcmVzdWx0cwogICAgICAgIGlmIChfc3RhdGUgPT0gT1BFTikKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBpdHIoX2xpc3Quc2l6ZSgpKTsg\naXRyLmhhc05leHQoKTspCiAgICAgICAgICAgICAgICBpdHIubmV4dCgpOwog\nICAgICAgIHJldHVybiBfbGlzdDsKICAgIH0KCiAgICBwdWJsaWMgaW50IGhh\nc2hDb2RlKCkgewogICAgICAgIC8vIHN1cGVyY2xhc3MgdHJpZXMgdG8gdHJh\ndmVyc2VzIGVudGlyZSBsaXN0IGZvciBoYXNoY29kZQogICAgICAgIHJldHVy\nbiBTeXN0ZW0uaWRlbnRpdHlIYXNoQ29kZSh0aGlzKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7CiAgICAgICAg\nLy8gc3VwZXJjbGFzcyB0cmllcyB0byB0cmF2ZXJzZSBlbnRpcmUgbGlzdCBm\nb3IgZXF1YWxpdHkKICAgICAgICByZXR1cm4gb3RoZXIgPT0gdGhpczsKICAg\nIH0KCiAgICBwcml2YXRlIGNsYXNzIEl0ciBleHRlbmRzIEFic3RyYWN0TGlz\ndEl0ZXJhdG9yIHsKCiAgICAgICAgcHJpdmF0ZSBpbnQgX2lkeCA9IDA7Cgog\nICAgICAgIHB1YmxpYyBJdHIoaW50IGluZGV4KSB7CiAgICAgICAgICAgIF9p\nZHggPSBNYXRoLm1pbihpbmRleCwgX2xpc3Quc2l6ZSgpKTsKICAgICAgICAg\nICAgd2hpbGUgKF9pZHggPCBpbmRleCkKICAgICAgICAgICAgICAgIG5leHQo\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgbmV4dEluZGV4KCkg\newogICAgICAgICAgICByZXR1cm4gX2lkeDsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBpbnQgcHJldmlvdXNJbmRleCgpIHsKICAgICAgICAgICAgcmV0\ndXJuIF9pZHggLSAxOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gaGFzTmV4dCgpIHsKICAgICAgICAgICAgaWYgKF9saXN0LnNpemUoKSA+\nIF9pZHgpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgaWYgKF9zdGF0ZSAhPSBPUEVOKQogICAgICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgICAgICByZXR1cm4gYWRkTmV4dCgpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzUHJldmlvdXMoKSB7CiAg\nICAgICAgICAgIHJldHVybiBfaWR4ID4gMDsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBPYmplY3QgcHJldmlvdXMoKSB7CiAgICAgICAgICAgIGlmIChf\naWR4ID09IDApCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9TdWNoRWxl\nbWVudEV4Y2VwdGlvbigpOwogICAgICAgICAgICByZXR1cm4gX2xpc3QuZ2V0\nKC0tX2lkeCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IG5l\neHQoKSB7CiAgICAgICAgICAgIGlmICghaGFzTmV4dCgpKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IE5vU3VjaEVsZW1lbnRFeGNlcHRpb24oKTsKICAg\nICAgICAgICAgcmV0dXJuIF9saXN0LmdldChfaWR4KyspOwogICAgICAgIH0K\nICAgIH0KfQo=\n","encoding":"base64"}

