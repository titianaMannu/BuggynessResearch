{"sha":"3cc6650b36ced612f7bf53b7bf53eedafab0d9a3","node_id":"MDQ6QmxvYjIwNjM2NDozY2M2NjUwYjM2Y2VkNjEyZjdiZjUzYjdiZjUzZWVkYWZhYjBkOWEz","size":7249,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3cc6650b36ced612f7bf53b7bf53eedafab0d9a3","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIucm9wOwoKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9y\nOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLmV4Y2VwdGlvbi5O\nZXN0YWJsZVJ1bnRpbWVFeGNlcHRpb247CgovKioKICogQSByZXN1bHQgb2Jq\nZWN0IHByb3ZpZGVyIHRoYXQgbWVyZ2VzIG11bHRpcGxlIHJlc3VsdCBvYmpl\nY3QgcHJvdmlkZXIKICogZGVsZWdhdGVzLiBTdXBwb3J0IGV4aXN0cyBmb3Ig\nbWFpbnRhaW5pbmcgb3JkZXJpbmcgb2YgdGhlIGludGVybmFsbHkgaGVsZAog\nKiByZXN1bHRzLCBwcm92aWRlZCB0aGF0IGVhY2ggb2YgdGhlIGluZGl2aWR1\nYWwgcmVzdWx0cyBpcyBpdHNlbGYgb3JkZXJlZC4KICoKICogQGF1dGhvciBB\nYmUgV2hpdGUKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICovCnB1\nYmxpYyBjbGFzcyBNZXJnZWRSZXN1bHRPYmplY3RQcm92aWRlciBpbXBsZW1l\nbnRzIFJlc3VsdE9iamVjdFByb3ZpZGVyIHsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBieXRlIFVOT1BFTkVEID0gMDsKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIGJ5dGUgT1BFTkVEID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIGJ5dGUgVkFMVUUgPSAyOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nYnl0ZSBET05FID0gMzsKCiAgICBwcml2YXRlIGZpbmFsIFJlc3VsdE9iamVj\ndFByb3ZpZGVyW10gX3JvcHM7CiAgICBwcml2YXRlIGZpbmFsIENvbXBhcmF0\nb3IgX2NvbXA7CiAgICBwcml2YXRlIGZpbmFsIGJ5dGVbXSBfc3RhdHVzOwog\nICAgcHJpdmF0ZSBPYmplY3RbXSBfdmFsdWVzOwogICAgcHJpdmF0ZSBPYmpl\nY3RbXSBfb3JkZXJWYWx1ZXM7CiAgICBwcml2YXRlIE9iamVjdCBfY3VyID0g\nbnVsbDsKICAgIHByaXZhdGUgaW50IF9zaXplID0gLTE7CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3Rvci4gUHJvdmlkZSBkZWxlZ2F0ZXMuCiAgICAgKi8K\nICAgIHB1YmxpYyBNZXJnZWRSZXN1bHRPYmplY3RQcm92aWRlcihSZXN1bHRP\nYmplY3RQcm92aWRlcltdIHJvcHMpIHsKICAgICAgICB0aGlzKHJvcHMsIG51\nbGwpOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuIFByb3Zp\nZGUgZGVsZWdhdGVzIGFuZCBvcHRpb25hbCBjb21wYXJhdG9yLgogICAgICov\nCiAgICBwdWJsaWMgTWVyZ2VkUmVzdWx0T2JqZWN0UHJvdmlkZXIoUmVzdWx0\nT2JqZWN0UHJvdmlkZXJbXSByb3BzLAogICAgICAgIENvbXBhcmF0b3IgY29t\ncCkgewogICAgICAgIF9yb3BzID0gcm9wczsKICAgICAgICBfY29tcCA9IGNv\nbXA7CiAgICAgICAgX3N0YXR1cyA9IG5ldyBieXRlW3JvcHMubGVuZ3RoXTsK\nICAgICAgICBfdmFsdWVzID0gKGNvbXAgPT0gbnVsbCkgPyBudWxsIDogbmV3\nIE9iamVjdFtyb3BzLmxlbmd0aF07CiAgICAgICAgX29yZGVyVmFsdWVzID0g\nKGNvbXAgPT0gbnVsbCkgPyBudWxsIDogbmV3IE9iamVjdFtyb3BzLmxlbmd0\naF07CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21B\nY2Nlc3MoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIG9wZW4oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAv\nLyBpZiB3ZSBoYXZlIGEgY29tcGFyYXRvciwgdGhlbiBvcGVuIGFsbDsgZWxz\nZSBvcGVuIGZpcnN0CiAgICAgICAgaW50IGxlbiA9IChfY29tcCAhPSBudWxs\nKSA/IF9yb3BzLmxlbmd0aCA6IDE7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBsZW47IGkrKykgewogICAgICAgICAgICBfcm9wc1tpXS5vcGVuKCk7\nCiAgICAgICAgICAgIF9zdGF0dXNbaV0gPSBPUEVORUQ7CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGFic29sdXRlKGludCBwb3MpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRl\nZE9wZXJhdGlvbkV4Y2VwdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nc2l6ZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChfc2l6ZSAh\nPSAtMSkKICAgICAgICAgICAgcmV0dXJuIF9zaXplOwoKICAgICAgICAvLyBo\nYXZlIHRvIG9wZW4gYWxsIHRvIGdldCBzaXplcwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX3N0YXR1cy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAoX3N0YXR1c1tpXSA9PSBVTk9QRU5FRCkgewogICAgICAgICAgICAg\nICAgX3JvcHNbaV0ub3BlbigpOwogICAgICAgICAgICAgICAgX3N0YXR1c1tp\nXSA9IE9QRU5FRDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\naW50IHRvdGFsID0gMDsKICAgICAgICBpbnQgc2l6ZTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IF9yb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIHNpemUgPSBfcm9wc1tpXS5zaXplKCk7CiAgICAgICAgICAgIGlmIChz\naXplID09IEludGVnZXIuTUFYX1ZBTFVFKSB7CiAgICAgICAgICAgICAgICB0\nb3RhbCA9IHNpemU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgICAgICB0b3RhbCArPSBzaXplOwogICAgICAgIH0KICAg\nICAgICBfc2l6ZSA9IHRvdGFsOwogICAgICAgIHJldHVybiBfc2l6ZTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCByZXNldCgpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX3JvcHMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIGlmIChfc3RhdHVzW2ldICE9IFVOT1BFTkVEKQog\nICAgICAgICAgICAgICAgX3JvcHNbaV0ucmVzZXQoKTsKICAgICAgICBjbGVh\ncigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfcm9wcy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKF9zdGF0dXNb\naV0gIT0gVU5PUEVORUQpCiAgICAgICAgICAgICAgICAgICAgX3JvcHNbaV0u\nY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgIGlmIChlcnIgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICBlcnIgPSBlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICBjbGVhcigpOwogICAgICAgIGlmIChlcnIgIT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgZXJyOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBjbGVh\ncigpIHsKICAgICAgICBfY3VyID0gbnVsbDsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IF9yb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIF9z\ndGF0dXNbaV0gPSBPUEVORUQ7CiAgICAgICAgICAgIGlmIChfdmFsdWVzICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBfdmFsdWVzW2ldID0gbnVsbDsKICAg\nICAgICAgICAgaWYgKF9vcmRlclZhbHVlcyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgX29yZGVyVmFsdWVzW2ldID0gbnVsbDsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIHZvaWQgaGFuZGxlQ2hlY2tlZEV4Y2VwdGlvbihFeGNl\ncHRpb24gZSkgewogICAgICAgIGlmIChfcm9wcy5sZW5ndGggPT0gMCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IE5lc3RhYmxlUnVudGltZUV4Y2VwdGlvbihl\nKTsKICAgICAgICBfcm9wc1swXS5oYW5kbGVDaGVja2VkRXhjZXB0aW9uKGUp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIG5leHQoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICAvLyBpbml0aWFsaXplIGFsbCByb3BzIHdpdGgg\ndGhlIGxhdGVzdCB2YWx1ZXMKICAgICAgICBib29sZWFuIGhhc1ZhbHVlID0g\nZmFsc2U7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfc3RhdHVzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX3N0YXR1c1tpXSkg\newogICAgICAgICAgICAgICAgY2FzZSBVTk9QRU5FRDoKICAgICAgICAgICAg\nICAgICAgICAvLyB0aGlzIHdpbGwgb25seSBldmVyIGJlIHRoZSBjYXNlIGlm\nIHdlIGFyZW4ndCBvcmRlcmluZwogICAgICAgICAgICAgICAgICAgIF9yb3Bz\nW2ldLm9wZW4oKTsKICAgICAgICAgICAgICAgICAgICBfc3RhdHVzW2ldID0g\nT1BFTkVEOwogICAgICAgICAgICAgICAgICAgIC8vIG5vIGJyZWFrCiAgICAg\nICAgICAgICAgICBjYXNlIE9QRU5FRDoKICAgICAgICAgICAgICAgICAgICAv\nLyBpZiB0aGlzIHJvcCBoYXMgYSB2YWx1ZSwgY2FjaGUgaXQ7IGlmIHdlJ3Jl\nIG5vdCBvcmRlcmluZywKICAgICAgICAgICAgICAgICAgICAvLyB0aGVuIHRo\nYXQncyB0aGUgdmFsdWUgdG8gcmV0dXJuCiAgICAgICAgICAgICAgICAgICAg\naWYgKF9yb3BzW2ldLm5leHQoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICBpZiAoX2NvbXAgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgX2N1ciA9IF9yb3BzW2ldLmdldFJlc3VsdE9iamVjdCgpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBoYXNWYWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBfc3RhdHVzW2ldID0gVkFMVUU7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBfdmFsdWVzW2ldID0gX3JvcHNbaV0uZ2V0UmVzdWx0T2Jq\nZWN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb3JkZXJWYWx1\nZXNbaV0gPSBnZXRPcmRlcmluZ1ZhbHVlKF92YWx1ZXNbaV0sCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgaSwgX3JvcHNbaV0pOwogICAgICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNl\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9zdGF0dXNbaV0gPSBET05FOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2Fz\nZSBWQUxVRToKICAgICAgICAgICAgICAgICAgICAvLyB3ZSBvbmx5IHVzZSB0\naGlzIHN0YXRlIHdoZW4gb3JkZXJpbmcKICAgICAgICAgICAgICAgICAgICBo\nYXNWYWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGlmIHdlIGdldCB0\nbyB0aGlzIHBvaW50IHdpdGhvdXQgYSBjb21wYXJhdG9yLCBpdCBtZWFucyBu\nb25lCiAgICAgICAgLy8gb2Ygb3VyIHJvcHMgaGF2ZSBhbnkgbW9yZSB2YWx1\nZXMKICAgICAgICBpZiAoX2NvbXAgPT0gbnVsbCB8fCAhaGFzVmFsdWUpCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gZm9yIGFsbCB0\naGUgcm9wcyB3aXRoIHZhbHVlcywgZmluZCB0aGUgJ2xlYXN0JyBvbmUgYWNj\nb3JkaW5nIHRvCiAgICAgICAgLy8gdGhlIGNvbXBhcmF0b3IKICAgICAgICBp\nbnQgbGVhc3QgPSAtMTsKICAgICAgICBPYmplY3Qgb3JkZXJWYWwgPSBudWxs\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX29yZGVyVmFsdWVzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfc3RhdHVzW2ldICE9IFZB\nTFVFKQogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGlm\nIChsZWFzdCA9PSAtMSB8fCBfY29tcC5jb21wYXJlKF9vcmRlclZhbHVlc1tp\nXSwgb3JkZXJWYWwpIDwgMCkgewogICAgICAgICAgICAgICAgbGVhc3QgPSBp\nOwogICAgICAgICAgICAgICAgb3JkZXJWYWwgPSBfb3JkZXJWYWx1ZXNbaV07\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGFzc2lnbiB0\naGUgbGVhc3QgdmFsdWUgdG8gdGhlIGN1cnJlbnQgb25lLCBhbmQgY2xlYXIg\ndGhlIGNhY2hlZAogICAgICAgIC8vIHZhbHVlIGZvciB0aGF0IHJvcCBzbyB0\naGF0IHdlIGtub3cgdG8gZ2V0IHRoZSBuZXh0IHZhbHVlIGZvcgogICAgICAg\nIC8vIHRoZSBuZXh0IGNvbXBhcmlzb24KICAgICAgICBfY3VyID0gX3ZhbHVl\nc1tsZWFzdF07CiAgICAgICAgX3ZhbHVlc1tsZWFzdF0gPSBudWxsOwogICAg\nICAgIF9vcmRlclZhbHVlc1tsZWFzdF0gPSBudWxsOwogICAgICAgIF9zdGF0\ndXNbbGVhc3RdID0gT1BFTkVEOwogICAgICAgIHJldHVybiB0cnVlOwogICAg\nfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0UmVzdWx0T2JqZWN0KCkgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIF9jdXI7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIHZhbHVlIHRvIHVzZSBmb3Igb3JkZXJp\nbmcgb24gdGhlIGdpdmVuIHJlc3VsdCB2YWx1ZS4gUmV0dXJucwogICAgICog\ndGhlIHJlc3VsdCB2YWx1ZSBieSBkZWZhdWx0LgogICAgICoKICAgICAqIEBw\nYXJhbSB2YWwgdGhlIHJlc3VsdCB2YWx1ZQogICAgICogQHBhcmFtIGlkeCB0\naGUgaW5kZXggb2YgdGhlIHJlc3VsdCBvYmplY3QgcHJvdmlkZXIgaW4gdGhl\nIGFycmF5CiAgICAgKiBnaXZlbiBvbiBjb25zdHJ1Y3Rpb24gdGhhdCBwcm9k\ndWNlZCB0aGUgcmVzdWx0IHZhbHVlCiAgICAgKiBAcGFyYW0gcm9wIHRoZSBy\nZXN1bHQgb2JqZWN0IHByb3ZpZGVyIHRoYXQgcHJvZHVjZWQgdGhlIHJlc3Vs\ndCB2YWx1ZQogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGdldE9yZGVy\naW5nVmFsdWUoT2JqZWN0IHZhbCwgaW50IGlkeCwKICAgICAgICBSZXN1bHRP\nYmplY3RQcm92aWRlciByb3ApIHsKICAgICAgICByZXR1cm4gdmFsOwogICAg\nfQp9Cg==\n","encoding":"base64"}

