{"sha":"f702c4b58ffdc66406bccfa830c5adf7d92513f9","node_id":"MDQ6QmxvYjIwNjM2NDpmNzAyYzRiNThmZmRjNjY0MDZiY2NmYTgzMGM1YWRmN2Q5MjUxM2Y5","size":4919,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f702c4b58ffdc66406bccfa830c5adf7d92513f9","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIucm9wOwoKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFt\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoK\nLyoqCiAqIFJlc3VsdExpc3QgaW1wbGVtZW50YXRpb24gdGhhdCB1c2VzIGEg\nZm9yd2FyZC1zY3JvbGxpbmcgd2luZG93IG9mIHJlc3VsdHMuCiAqCiAqIEBh\ndXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFz\ncyBXaW5kb3dSZXN1bHRMaXN0IGV4dGVuZHMgQWJzdHJhY3ROb25TZXF1ZW50\naWFsUmVzdWx0TGlzdCB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50\nIE9QRU4gPSAwOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IEZSRUVE\nID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBDTE9TRUQgPSAy\nOwoKICAgIHByaXZhdGUgZmluYWwgT2JqZWN0W10gX3dpbmRvdzsKICAgIHBy\naXZhdGUgaW50IF9wb3MgPSAtMTsKICAgIHByaXZhdGUgUmVzdWx0T2JqZWN0\nUHJvdmlkZXIgX3JvcCA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX3Jh\nbmRvbSA9IGZhbHNlOwogICAgcHJpdmF0ZSBpbnQgX3N0YXRlID0gT1BFTjsK\nICAgIHByaXZhdGUgaW50IF9zaXplID0gLTE7CgogICAgcHVibGljIFdpbmRv\nd1Jlc3VsdExpc3QoUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9wKSB7CiAgICAg\nICAgdGhpcyhyb3AsIDEwKTsKICAgIH0KCiAgICBwdWJsaWMgV2luZG93UmVz\ndWx0TGlzdChSZXN1bHRPYmplY3RQcm92aWRlciByb3AsIGludCB3aW5kb3dT\naXplKSB7CiAgICAgICAgX3JvcCA9IHJvcDsKCiAgICAgICAgaWYgKHdpbmRv\nd1NpemUgPD0gMCkKICAgICAgICAgICAgd2luZG93U2l6ZSA9IDEwOwogICAg\nICAgIF93aW5kb3cgPSBuZXcgT2JqZWN0W3dpbmRvd1NpemVdOwoKICAgICAg\nICB0cnkgewogICAgICAgICAgICBfcm9wLm9wZW4oKTsKICAgICAgICAgICAg\nX3JhbmRvbSA9IF9yb3Auc3VwcG9ydHNSYW5kb21BY2Nlc3MoKTsKICAgICAg\nICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgICAg\nIGNsb3NlKCk7CiAgICAgICAgICAgIHRocm93IHJlOwogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGNsb3NlKCk7CiAgICAg\nICAgICAgIF9yb3AuaGFuZGxlQ2hlY2tlZEV4Y2VwdGlvbihlKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNQcm92aWRlck9wZW4o\nKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0ZSA9PSBPUEVOOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGlzQ2xvc2VkKCkgewogICAgICAgIHJldHVybiBf\nc3RhdGUgPT0gQ0xPU0VEOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3Nl\nKCkgewogICAgICAgIGlmIChfc3RhdGUgIT0gQ0xPU0VEKSB7CiAgICAgICAg\nICAgIGZyZWUoKTsKICAgICAgICAgICAgX3N0YXRlID0gQ0xPU0VEOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IHNpemUoKSB7CiAgICAgICAg\nYXNzZXJ0T3BlbigpOwogICAgICAgIGlmIChfc2l6ZSAhPSAtMSkKICAgICAg\nICAgICAgcmV0dXJuIF9zaXplOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIF9zaXplID0gX3JvcC5zaXplKCk7CiAgICAgICAgICAgIHJldHVybiBfc2l6\nZTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAg\nICAgICAgICAgIGNsb3NlKCk7CiAgICAgICAgICAgIHRocm93IHJlOwogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGNsb3Nl\nKCk7CiAgICAgICAgICAgIF9yb3AuaGFuZGxlQ2hlY2tlZEV4Y2VwdGlvbihl\nKTsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgT2JqZWN0IGdldEludGVybmFsKGludCBpbmRleCkgewogICAg\nICAgIC8vIG91dCBvZiByYW5nZT8KICAgICAgICBpZiAoaW5kZXggPCAwIHx8\nIChfc2l6ZSAhPSAtMSAmJiBpbmRleCA+PSBfc2l6ZSkpCiAgICAgICAgICAg\nIHJldHVybiBQQVNUX0VORDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nLy8gaWYgdGhpcyBpcyBiZWZvcmUgd2luZG93IHJhbmdlLCBtb3ZlIHdpbmRv\ndyBiYWNrCiAgICAgICAgICAgIGlmIChpbmRleCA8IF9wb3MpIHsKICAgICAg\nICAgICAgICAgIGlmICghX3JhbmRvbSB8fCBpbmRleCA9PSAwKQogICAgICAg\nICAgICAgICAgICAgIF9yb3AucmVzZXQoKTsKICAgICAgICAgICAgICAgIF9w\nb3MgPSAtMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaWYgdGhp\ncyBpcyB0aGUgZmlyc3QgZ2V0IG9yIHBhc3Qgd2luZG93IHJhbmdlLCBtb3Zl\nIHdpbmRvdwogICAgICAgICAgICBpZiAoX3BvcyA9PSAtMSB8fCBpbmRleCA+\nPSBfcG9zICsgX3dpbmRvdy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIC8v\nIHBvc2l0aW9uIHJlc3VsdCBwcm92aWRlciBqdXN0IGJlZm9yZSByZXF1ZXN0\nZWQgaW5kZXgKICAgICAgICAgICAgICAgIGlmIChfcmFuZG9tICYmIGluZGV4\nICE9IDApIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIV9yb3AuYWJzb2x1\ndGUoaW5kZXggLSAxKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIFBBU1RfRU5EOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICBpbnQgYmVnaW4gPSAoX3BvcyA9PSAtMSkgPyAwIDogX3Bv\ncyArIF93aW5kb3cubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIGZvciAo\naW50IGkgPSBiZWdpbjsgaSA8IGluZGV4OyBpKyspCiAgICAgICAgICAgICAg\nICAgICAgICAgIGlmICghX3JvcC5uZXh0KCkpCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gUEFTVF9FTkQ7CiAgICAgICAgICAgICAgICB9\nCgogICAgICAgICAgICAgICAgLy8gY3JlYXRlIHdpbmRvdyBzdGFydGluZyBh\ndCByZXF1ZXN0ZWQgaW5kZXgKICAgICAgICAgICAgICAgIGludCBlbmQgPSAt\nMTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX3dpbmRv\ndy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChlbmQg\nPT0gLTEgJiYgIV9yb3AubmV4dCgpKQogICAgICAgICAgICAgICAgICAgICAg\nICBlbmQgPSBpOwogICAgICAgICAgICAgICAgICAgIF93aW5kb3dbaV0gPSAo\nZW5kID09IC0xKSA/IF9yb3AuZ2V0UmVzdWx0T2JqZWN0KCkKICAgICAgICAg\nICAgICAgICAgICAgICAgOiBQQVNUX0VORDsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIF9wb3MgPSBpbmRleDsKCiAgICAgICAgICAgICAg\nICAvLyBpZiB0aGUgd2luZG93IHNwYW5zIHRoZSBlbnRpcmUgcmVzdWx0IGxp\nc3QsIGZyZWUKICAgICAgICAgICAgICAgIGlmIChlbmQgIT0gLTEgJiYgX3Bv\ncyA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgX3NpemUgPSBlbmQ7CiAg\nICAgICAgICAgICAgICAgICAgZnJlZSgpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBncmFiIHJlc3VsdCBmcm9t\nIHdpbmRvdwogICAgICAgICAgICByZXR1cm4gX3dpbmRvd1tpbmRleCAtIF9w\nb3NdOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsK\nICAgICAgICAgICAgY2xvc2UoKTsKICAgICAgICAgICAgdGhyb3cgcmU7CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgY2xv\nc2UoKTsKICAgICAgICAgICAgX3JvcC5oYW5kbGVDaGVja2VkRXhjZXB0aW9u\nKGUpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIGZyZWUoKSB7CiAgICAgICAgaWYgKF9zdGF0\nZSA9PSBPUEVOKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBfcm9wLmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3N0YXRlID0gRlJF\nRUQ7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qgd3JpdGVS\nZXBsYWNlKCkgdGhyb3dzIE9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKF9zdGF0ZSAhPSBPUEVOKQogICAgICAgICAgICByZXR1cm4gdGhp\nczsKCiAgICAgICAgLy8gbG9hZCByZXN1bHRzIGludG8gbGlzdAogICAgICAg\nIExpc3QgbGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ciA9IGl0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KQogICAg\nICAgICAgICBsaXN0LmFkZChpdHIubmV4dCgpKTsKICAgICAgICByZXR1cm4g\nbGlzdDsKICAgIH0KfQo=\n","encoding":"base64"}

