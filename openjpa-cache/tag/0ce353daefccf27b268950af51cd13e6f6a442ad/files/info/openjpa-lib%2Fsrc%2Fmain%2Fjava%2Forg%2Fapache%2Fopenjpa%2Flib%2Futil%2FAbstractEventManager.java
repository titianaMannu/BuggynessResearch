{"sha":"8eb4a07649377064c1ba508e0fdba0d150e0d662","node_id":"MDQ6QmxvYjIwNjM2NDo4ZWI0YTA3NjQ5Mzc3MDY0YzFiYTUwOGUwZmRiYTBkMTUwZTBkNjYy","size":4647,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8eb4a07649377064c1ba508e0fdba0d150e0d662","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbDsKCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEu\ndXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0Owpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CgovKioKICogQmFzZSBldmVudCBtYW5h\nZ2VyIHRoYXQgaGFuZGxlcyBhZGRpbmcvcmVtb3ZpbmcgbGlzdGVuZXJzCiAq\nIGFuZCBmaXJpbmcgZXZlbnRzLiBUaGlzIGNsYXNzIGlzIHJlZW50cmFudC1z\nYWZlOyBsaXN0ZW5lcnMgY2FuIGJlIGFkZGVkCiAqIGFuZCByZW1vdmVkIGJ5\nIG90aGVyIGxpc3RlbmVycyB3aGVuIHRoZXkgcmVjZWl2ZSBldmVudHMuIFRo\nZSBjaGFuZ2VzIHdpbGwKICogbm90IGJlIHZpc2libGUgdW50aWwgdGhlIGV2\nZW50IGZpcmUgdGhhdCBpbml0aWF0ZWQgdGhlIHJlY3Vyc2l2ZSBzZXF1ZW5j\nZQogKiBvZiBjYWxscyBjb21wbGV0ZXMsIGhvd2V2ZXIuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJh\nY3RFdmVudE1hbmFnZXIgaW1wbGVtZW50cyBFdmVudE1hbmFnZXIgewoKICAg\nIHByaXZhdGUgc3RhdGljIEV4Y2VwdGlvbltdIEVNUFRZX0VYQ0VQVElPTlMg\nPSBuZXcgRXhjZXB0aW9uWzBdOwoKICAgIHByaXZhdGUgYm9vbGVhbiBfZmly\naW5nID0gZmFsc2U7CiAgICBwcml2YXRlIENvbGxlY3Rpb24gX2xpc3RlbmVy\ncyA9IG51bGw7CiAgICBwcml2YXRlIENvbGxlY3Rpb24gX25ld0xpc3RlbmVy\ncyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBSZWdpc3RlciBhbiBldmVudCBs\naXN0ZW5lci4KICAgICAqLwogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lk\nIGFkZExpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGlmIChs\naXN0ZW5lciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\naWYgKF9maXJpbmcpIHsKICAgICAgICAgICAgaWYgKF9uZXdMaXN0ZW5lcnMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9uZXdMaXN0ZW5lcnMgPSBuZXdM\naXN0ZW5lckNvbGxlY3Rpb24oKTsKICAgICAgICAgICAgX25ld0xpc3RlbmVy\ncy5hZGRBbGwoX2xpc3RlbmVycyk7CiAgICAgICAgICAgIF9uZXdMaXN0ZW5l\ncnMuYWRkKGxpc3RlbmVyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICBpZiAoX2xpc3RlbmVycyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2xp\nc3RlbmVycyA9IG5ld0xpc3RlbmVyQ29sbGVjdGlvbigpOwogICAgICAgICAg\nICBfbGlzdGVuZXJzLmFkZChsaXN0ZW5lcik7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmVtb3ZlIGFuIGV2ZW50IGxpc3RlbmVyLgogICAg\nICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIGJvb2xlYW4gcmVtb3ZlTGlz\ndGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgaWYgKGxpc3RlbmVy\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBp\nZiAoX2ZpcmluZyAmJiBfbGlzdGVuZXJzLmNvbnRhaW5zKGxpc3RlbmVyKSkg\newogICAgICAgICAgICBpZiAoX25ld0xpc3RlbmVycyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgX25ld0xpc3RlbmVycyA9IG5ld0xpc3RlbmVyQ29sbGVj\ndGlvbigpOwogICAgICAgICAgICBfbmV3TGlzdGVuZXJzLmFkZEFsbChfbGlz\ndGVuZXJzKTsKICAgICAgICAgICAgcmV0dXJuIF9uZXdMaXN0ZW5lcnMucmVt\nb3ZlKGxpc3RlbmVyKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9saXN0\nZW5lcnMgIT0gbnVsbCAmJiBfbGlzdGVuZXJzLnJlbW92ZShsaXN0ZW5lcik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2\nZW4gaW5zdGFuY2UgaXMgaW4gdGhlIGxpc3Qgb2YgbGlzdGVuZXJzLgogICAg\nICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIGJvb2xlYW4gaGFzTGlzdGVu\nZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgcmV0dXJuIF9saXN0ZW5l\ncnMgIT0gbnVsbCAmJiBfbGlzdGVuZXJzLmNvbnRhaW5zKGxpc3RlbmVyKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZXJlIGFy\nZSBhbnkgcmVnaXN0ZXJlZCBsaXN0ZW5lcnMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzeW5jaHJvbml6ZWQgYm9vbGVhbiBoYXNMaXN0ZW5lcnMoKSB7CiAgICAg\nICAgcmV0dXJuIF9saXN0ZW5lcnMgIT0gbnVsbCAmJiAhX2xpc3RlbmVycy5p\nc0VtcHR5KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSByZWFk\nLW9ubHkgbGlzdCBvZiBsaXN0ZW5lcnMuCiAgICAgKi8KICAgIHB1YmxpYyBz\neW5jaHJvbml6ZWQgQ29sbGVjdGlvbiBnZXRMaXN0ZW5lcnMoKSB7CiAgICAg\nICAgcmV0dXJuIChfbGlzdGVuZXJzID09IG51bGwpID8gQ29sbGVjdGlvbnMu\nRU1QVFlfTElTVAogICAgICAgICAgICA6IENvbGxlY3Rpb25zLnVubW9kaWZp\nYWJsZUNvbGxlY3Rpb24oX2xpc3RlbmVycyk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBGaXJlIHRoZSBnaXZlbiBldmVudCB0byBhbGwgbGlzdGVuZXJzLgog\nICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIEV4Y2VwdGlvbltdIGZp\ncmVFdmVudChPYmplY3QgZXZlbnQpIHsKICAgICAgICBpZiAoX2xpc3RlbmVy\ncyA9PSBudWxsIHx8IF9saXN0ZW5lcnMuaXNFbXB0eSgpKQogICAgICAgICAg\nICByZXR1cm4gRU1QVFlfRVhDRVBUSU9OUzsKCiAgICAgICAgYm9vbGVhbiBy\nZWVudHJhbnQgPSBfZmlyaW5nOwogICAgICAgIF9maXJpbmcgPSB0cnVlOwog\nICAgICAgIExpc3QgZXhjZXB0aW9ucyA9IG51bGw7CiAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBfbGlzdGVuZXJzLml0ZXJhdG9yKCk7IGl0ci5oYXNO\nZXh0KCk7KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBm\naXJlRXZlbnQoZXZlbnQsIGl0ci5uZXh0KCkpOwogICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgaWYgKGV4Y2Vw\ndGlvbnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBleGNlcHRpb25z\nID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAgICAgICAgICAgIGV4Y2VwdGlv\nbnMuYWRkKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAv\nLyBpZiB0aGlzIHdhc24ndCBhIHJlZW50cmFudCBjYWxsLCByZWNvcmQgdGhh\ndCB3ZSdyZSBubyBsb25nZXIKICAgICAgICAvLyBpbiB0aGUgcHJvY2VzcyBv\nZiBmaXJpbmcgZXZlbnRzIGFuZCByZXBsYWNlIG91ciBpbml0aWFsIGxpc3Rl\nbmVyCiAgICAgICAgLy8gbGlzdCB3aXRoIHRoZSBzZXQgb2YgbmV3IGxpc3Rl\nbmVycwogICAgICAgIGlmICghcmVlbnRyYW50KSB7CiAgICAgICAgICAgIF9m\naXJpbmcgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKF9uZXdMaXN0ZW5lcnMg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9saXN0ZW5lcnMgPSBfbmV3TGlz\ndGVuZXJzOwogICAgICAgICAgICBfbmV3TGlzdGVuZXJzID0gbnVsbDsKICAg\nICAgICB9CgogICAgICAgIGlmIChleGNlcHRpb25zID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBFTVBUWV9FWENFUFRJT05TOwogICAgICAgIHJldHVy\nbiAoRXhjZXB0aW9uW10pIGV4Y2VwdGlvbnMudG9BcnJheQogICAgICAgICAg\nICAobmV3IEV4Y2VwdGlvbltleGNlcHRpb25zLnNpemUoKV0pOwogICAgfQoK\nICAgIC8qKgogICAgICogSW1wbGVtZW50IHRoaXMgbWV0aG9kIHRvIGZpcmUg\ndGhlIGdpdmVuIGV2ZW50IHRvIHRoZSBnaXZlbiBsaXN0ZW5lci4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IHZvaWQgZmlyZUV2ZW50KE9iamVj\ndCBldmVudCwgT2JqZWN0IGxpc3RlbmVyKQogICAgICAgIHRocm93cyBFeGNl\ncHRpb247CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBuZXcgY29udGFpbmVy\nIGZvciBsaXN0ZW5lcnMuIFVzZXMgYSBsaW5rZWQgbGlzdCBieSBkZWZhdWx0\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgQ29sbGVjdGlvbiBuZXdMaXN0ZW5l\nckNvbGxlY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIG5ldyBMaW5rZWRMaXN0\nKCk7CiAgICB9Cn0K\n","encoding":"base64"}

