{"sha":"5349789fc519eb12c6a4d07456c5ea233972e828","node_id":"MDQ6QmxvYjIwNjM2NDo1MzQ5Nzg5ZmM1MTllYjEyYzZhNGQwNzQ1NmM1ZWEyMzM5NzJlODI4","size":9424,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5349789fc519eb12c6a4d07456c5ea233972e828","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbDsKCmltcG9ydCBqYXZhLnRleHQuTWVzc2FnZUZv\ncm1hdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0\naWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1w\nb3J0IGphdmEudXRpbC5Mb2NhbGU7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLk1pc3NpbmdSZXNvdXJjZUV4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlJl\nc291cmNlQnVuZGxlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRIYXNoTWFwOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLmNvbmN1cnJlbnQuQ29weU9uV3Jp\ndGVBcnJheVNldDsKCi8qKgogKiBUaGUgTG9jYWxpemVyIHByb3ZpZGVzIGNv\nbnZlbmllbnQgYWNjZXNzIHRvIGxvY2FsaXplZAogKiBzdHJpbmdzLiBJdCBp\nbmxjdWRlcyBidWlsdC1pbiBzdXBwb3J0IGZvciBwYXJhbWV0ZXIgc3Vic3Rp\ndHV0aW9uIHRocm91Z2gKICogdGhlIHVzZSBvZiB0aGUge0BsaW5rIE1lc3Nh\nZ2VGb3JtYXR9IHV0aWxpdHkuCiAqIFN0cmluZ3MgYXJlIHN0b3JlZCBpbiBw\nZXItcGFja2FnZSB7QGxpbmsgUHJvcGVydGllc30gZmlsZXMuCiAqIFRoZSBw\ncm9wZXJ0eSBmaWxlIGZvciB0aGUgZGVmYXVsdCBsb2NhbGUgbXVzdCBiZSBu\nYW1lZAogKiA8Y29kZT5sb2NhbGl6ZXIucHJvcGVydGllczwvY29kZT4uIEFk\nZGl0aW9uYWwgbG9jYWxlcyBjYW4gYmUgc3VwcG9ydGVkCiAqIHRocm91Z2gg\nYWRkaXRpb25hbCBwcm9wZXJ0eSBmaWxlcyB1c2luZyB0aGUgbmFtaW5nIGNv\nbnZlbnRpb25zIHNwZWNpZmllZAogKiBpbiB0aGUge0BsaW5rIFJlc291cmNl\nQnVuZGxlfSBjbGFzcy4gRm9yIGV4YW1wbGUsIHRoZSBnZXJtYW4gbG9jYWxl\nCiAqIGNvdWxkIGJlIHN1cHBvcnRlZCB0aHJvdWdoIGEgPGNvZGU+bG9jYWxp\nemVyX2RlX0RFLnByb3BlcnRpZXM8L2NvZGU+IGZpbGUuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgTG9jYWxpemVyIHsKCiAg\nICAvLyBzdGF0aWMgY2FjaGUgb2YgcGFja2FnZStsb2MgbmFtZSB0byBsb2Nh\nbGl6ZXIgbWFwcGluZ3MKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE1hcCBf\nbG9jYWxpemVycyA9IG5ldyBDb25jdXJyZW50SGFzaE1hcCgpOwoKICAgIC8v\nIGxpc3Qgb2YgcmVzb3VyY2UgcHJvdmlkZXJzIHRvIGRlbGVnYXRlIHRvIHdo\nZW4gbG9jYXRpbmcgcmVzb3VyY2VzCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBDb2xsZWN0aW9uIF9wcm92aWRlcnMgPSBuZXcgQ29weU9uV3JpdGVBcnJh\neVNldAogICAgICAgIChBcnJheXMuYXNMaXN0KG5ldyBPYmplY3RbXXsKICAg\nICAgICAgICAgbmV3IFNpbXBsZVJlc291cmNlQnVuZGxlUHJvdmlkZXIoKSwK\nICAgICAgICAgICAgbmV3IFN0cmVhbVJlc291cmNlQnVuZGxlUHJvdmlkZXIo\nKSwKICAgICAgICAgICAgbmV3IFppcFJlc291cmNlQnVuZGxlUHJvdmlkZXIo\nKSwgfSkpOwoKICAgIC8qKgogICAgICogUmV0dXJuIGEgTG9jYWxpemVyIGlu\nc3RhbmNlIHRoYXQgd2lsbCBhY2Nlc3MgdGhlIHByb3BlcnRpZXMgZmlsZQog\nICAgICogaW4gdGhlIHBhY2thZ2Ugb2YgdGhlIGdpdmVuIGNsYXNzIHVzaW5n\nIHRoZSBzeXN0ZW0gZGVmYXVsdCBsb2NhbGUuCiAgICAgKgogICAgICogQHNl\nZSAjZm9yUGFja2FnZShDbGFzcyxMb2NhbGUpCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgTG9jYWxpemVyIGZvclBhY2thZ2UoQ2xhc3MgY2xzKSB7CiAg\nICAgICAgcmV0dXJuIGZvclBhY2thZ2UoY2xzLCBudWxsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiBhIExvY2FsaXplciBpbnN0YW5jZSB0aGF0\nIHdpbGwgYWNjZXNzIHRoZSBwcm9wZXJ0aWVzIGZpbGUKICAgICAqIGluIHRo\nZSBwYWNrYWdlIG9mIHRoZSBnaXZlbiBjbGFzcyB1c2luZyB0aGUgZ2l2ZW4g\nbG9jYWxlLgogICAgICoKICAgICAqIEBwYXJhbSBjbHMgdGhlIGNsYXNzIHdo\nb3NlIHBhY2thZ2UgdG8gY2hlY2sgZm9yIHRoZSBsb2NhbGl6ZWQKICAgICAq\nIHByb3BlcnRpZXMgZmlsZTsgaWYgbnVsbCwgdGhlIHN5c3RlbSB3aWxsIGNo\nZWNrIGZvcgogICAgICogYSB0b3AtbGV2ZWwgcHJvcGVydGllcyBmaWxlCiAg\nICAgKiBAcGFyYW0gbG9jYWxlIHRoZSBsb2NhbGUgdG8gd2hpY2ggc3RyaW5n\ncyBzaG91bGQgYmUgbG9jYWxpemVkOyBpZgogICAgICogbnVsbCwgdGhlIHN5\nc3RlbSBkZWZhdWx0IHdpbGwgYmUgYXNzdW1lZAogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIExvY2FsaXplciBmb3JQYWNrYWdlKENsYXNzIGNscywgTG9j\nYWxlIGxvY2FsZSkgewogICAgICAgIGlmIChsb2NhbGUgPT0gbnVsbCkKICAg\nICAgICAgICAgbG9jYWxlID0gTG9jYWxlLmdldERlZmF1bHQoKTsKCiAgICAg\nICAgaW50IGRvdCA9IChjbHMgPT0gbnVsbCkgPyAtMSA6IGNscy5nZXROYW1l\nKCkubGFzdEluZGV4T2YoJy4nKTsKICAgICAgICBTdHJpbmcgcGtnOwogICAg\nICAgIFN0cmluZyBmaWxlOwogICAgICAgIGlmIChkb3QgPT0gLTEpIHsKICAg\nICAgICAgICAgcGtnID0gIiI7CiAgICAgICAgICAgIGZpbGUgPSAibG9jYWxp\nemVyIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwa2cgPSBjbHMu\nZ2V0TmFtZSgpLnN1YnN0cmluZygwLCBkb3QpOwogICAgICAgICAgICBmaWxl\nID0gcGtnICsgIi5sb2NhbGl6ZXIiOwogICAgICAgIH0KICAgICAgICBTdHJp\nbmcga2V5ID0gZmlsZSArIGxvY2FsZS50b1N0cmluZygpOwoKICAgICAgICAv\nLyBubyBsb2NraW5nOyBvayBpZiBidW5kbGUgY3JlYXRlZCBtdWx0aXBsZSB0\naW1lcwogICAgICAgIC8vIGNoZWNrIGZvciBjYWNoZWQgdmVyc2lvbgogICAg\nICAgIExvY2FsaXplciBsb2MgPSAoTG9jYWxpemVyKSBfbG9jYWxpemVycy5n\nZXQoa2V5KTsKICAgICAgICBpZiAobG9jICE9IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBsb2M7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGxvYyA9\nIG5ldyBMb2NhbGl6ZXIocGtnLCBmaWxlLCBsb2NhbGUsIAogICAgICAgICAg\nICAgICAgY2xzID09IG51bGwgPyBudWxsIDogY2xzLmdldENsYXNzTG9hZGVy\nKCkpOwogICAgICAgICAgICBfbG9jYWxpemVycy5wdXQoa2V5LCBsb2MpOwog\nICAgICAgICAgICByZXR1cm4gbG9jOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJlZ2lzdGVyIGEgcmVzb3VyY2UgcHJvdmlkZXIuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBhZGRQcm92aWRlcihSZXNvdXJj\nZUJ1bmRsZVByb3ZpZGVyIHByb3ZpZGVyKSB7CiAgICAgICAgX3Byb3ZpZGVy\ncy5hZGQocHJvdmlkZXIpOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3Zl\nIGEgcmVzb3VyY2UgcHJvdmlkZXIuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgYm9vbGVhbiByZW1vdmVQcm92aWRlcihSZXNvdXJjZUJ1bmRsZVByb3Zp\nZGVyIHByb3ZpZGVyKSB7CiAgICAgICAgcmV0dXJuIF9wcm92aWRlcnMucmVt\nb3ZlKHByb3ZpZGVyKTsKICAgIH0KCiAgICBwcml2YXRlIFN0cmluZyBfZmls\nZTsKICAgIHByaXZhdGUgU3RyaW5nIF9wa2c7CiAgICBwcml2YXRlIFJlc291\ncmNlQnVuZGxlIF9idW5kbGUgPSBudWxsOwogICAgcHJpdmF0ZSBMb2NhbGUg\nX2xvY2FsZTsKICAgIHByaXZhdGUgQ2xhc3NMb2FkZXIgX2xvYWRlcjsKCiAg\nICBwcml2YXRlIExvY2FsaXplcihTdHJpbmcgcGtnLCBTdHJpbmcgZiwgTG9j\nYWxlIGxvY2FsZSwgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgX3Br\nZyA9IHBrZzsKICAgICAgICBfZmlsZSA9IGY7CiAgICAgICAgX2xvY2FsZSA9\nIGxvY2FsZTsKICAgICAgICBfbG9hZGVyID0gbG9hZGVyOwogICAgfQogICAg\nCiAgICBwcml2YXRlIFJlc291cmNlQnVuZGxlIGdldEJ1bmRsZSgpIHsKICAg\nICAgICAvLyBubyBsb2NraW5nOyBpdCdzIG9rIHRvIGNyZWF0ZSBtdWx0aXBs\nZSBidW5kbGVzCiAgICAgICAgaWYgKF9idW5kbGUgPT0gbnVsbCkgewogICAg\nICAgICAgICAvLyBmaW5kIHJlc291cmNlIGJ1bmRsZQogICAgICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IF9wcm92aWRlcnMuaXRlcmF0b3IoKTsKICAg\nICAgICAgICAgICAgIGl0ci5oYXNOZXh0KCkgJiYgX2J1bmRsZSA9PSBudWxs\nOyApIHsKICAgICAgICAgICAgICAgIF9idW5kbGUgPSAoKFJlc291cmNlQnVu\nZGxlUHJvdmlkZXIpIGl0ci5uZXh0KCkpCiAgICAgICAgICAgICAgICAgICAg\nLmZpbmRSZXNvdXJjZShfZmlsZSwgX2xvY2FsZSwgX2xvYWRlcik7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9idW5kbGU7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGxvY2FsaXplZCBzdHJp\nbmcgbWF0Y2hpbmcgdGhlIGdpdmVuIGtleS4KICAgICAqLwogICAgcHVibGlj\nIE1lc3NhZ2UgZ2V0KFN0cmluZyBrZXkpIHsKICAgICAgICByZXR1cm4gZ2V0\nKGtleSwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGxvY2FsaXplZCBzdHJpbmcgbWF0Y2hpbmcgdGhlIGdpdmVuIGtleS4KICAg\nICAqLwogICAgcHVibGljIE1lc3NhZ2UgZ2V0RmF0YWwoU3RyaW5nIGtleSkg\newogICAgICAgIHJldHVybiBnZXRGYXRhbChrZXksIG51bGwpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIG1h\ndGNoaW5nIHRoZSBnaXZlbiBrZXkuIFRoZSBnaXZlbgogICAgICogPGNvZGU+\nc3ViPC9jb2RlPiBvYmplY3Qgd2lsbCBiZSBwYWNrZWQgaW50byBhbiBhcnJh\neSBhbmQgc3Vic3RpdHV0ZWQKICAgICAqIGludG8gdGhlIGZvdW5kIHN0cmlu\nZyBhY2NvcmRpbmcgdG8gdGhlIHJ1bGVzIG9mIHRoZQogICAgICoge0BsaW5r\nIE1lc3NhZ2VGb3JtYXR9IGNsYXNzLgogICAgICoKICAgICAqIEBzZWUgI2dl\ndChTdHJpbmcpCiAgICAgKi8KICAgIHB1YmxpYyBNZXNzYWdlIGdldChTdHJp\nbmcga2V5LCBPYmplY3Qgc3ViKSB7CiAgICAgICAgcmV0dXJuIGdldChrZXks\nIG5ldyBPYmplY3RbXXsgc3ViIH0pOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIG1hdGNoaW5nIHRoZSBnaXZl\nbiBrZXkuIFRoZSBnaXZlbgogICAgICogPGNvZGU+c3ViPC9jb2RlPiBvYmpl\nY3Qgd2lsbCBiZSBwYWNrZWQgaW50byBhbiBhcnJheSBhbmQgc3Vic3RpdHV0\nZWQKICAgICAqIGludG8gdGhlIGZvdW5kIHN0cmluZyBhY2NvcmRpbmcgdG8g\ndGhlIHJ1bGVzIG9mIHRoZQogICAgICoge0BsaW5rIE1lc3NhZ2VGb3JtYXR9\nIGNsYXNzLgogICAgICoKICAgICAqIEBzZWUgI2dldEZhdGFsKFN0cmluZykK\nICAgICAqLwogICAgcHVibGljIE1lc3NhZ2UgZ2V0RmF0YWwoU3RyaW5nIGtl\neSwgT2JqZWN0IHN1YikgewogICAgICAgIHJldHVybiBnZXRGYXRhbChrZXks\nIG5ldyBPYmplY3RbXXsgc3ViIH0pOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIGZvciB0aGUgZ2l2ZW4ga2V5\nLgogICAgICoKICAgICAqIEBzZWUgI2dldChTdHJpbmcsT2JqZWN0KQogICAg\nICovCiAgICBwdWJsaWMgTWVzc2FnZSBnZXQoU3RyaW5nIGtleSwgT2JqZWN0\nIHN1YjEsIE9iamVjdCBzdWIyKSB7CiAgICAgICAgcmV0dXJuIGdldChrZXks\nIG5ldyBPYmplY3RbXXsgc3ViMSwgc3ViMiB9KTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgbG9jYWxpemVkIHN0cmluZyBmb3IgdGhlIGdp\ndmVuIGtleS4KICAgICAqCiAgICAgKiBAc2VlICNnZXRGYXRhbChTdHJpbmcs\nT2JqZWN0KQogICAgICovCiAgICBwdWJsaWMgTWVzc2FnZSBnZXRGYXRhbChT\ndHJpbmcga2V5LCBPYmplY3Qgc3ViMSwgT2JqZWN0IHN1YjIpIHsKICAgICAg\nICByZXR1cm4gZ2V0RmF0YWwoa2V5LCBuZXcgT2JqZWN0W117IHN1YjEsIHN1\nYjIgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGxvY2Fs\naXplZCBzdHJpbmcgZm9yIHRoZSBnaXZlbiBrZXkuCiAgICAgKgogICAgICog\nQHNlZSAjZ2V0KFN0cmluZyxPYmplY3QpCiAgICAgKi8KICAgIHB1YmxpYyBN\nZXNzYWdlIGdldChTdHJpbmcga2V5LCBPYmplY3Qgc3ViMSwgT2JqZWN0IHN1\nYjIsIE9iamVjdCBzdWIzKSB7CiAgICAgICAgcmV0dXJuIGdldChrZXksIG5l\ndyBPYmplY3RbXXsgc3ViMSwgc3ViMiwgc3ViMyB9KTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgbG9jYWxpemVkIHN0cmluZyBtYXRjaGlu\nZyB0aGUgZ2l2ZW4ga2V5LiBUaGUgZ2l2ZW4KICAgICAqIDxjb2RlPnN1YnM8\nL2NvZGU+IG9iamVjdHMgd2lsbCBiZSBzdWJzdGl0dXRlZAogICAgICogaW50\nbyB0aGUgZm91bmQgc3RyaW5nIGFjY29yZGluZyB0byB0aGUgcnVsZXMgb2Yg\ndGhlCiAgICAgKiB7QGxpbmsgTWVzc2FnZUZvcm1hdH0gY2xhc3MuCiAgICAg\nKgogICAgICogQHNlZSAjZ2V0KFN0cmluZykKICAgICAqLwogICAgcHVibGlj\nIE1lc3NhZ2UgZ2V0KFN0cmluZyBrZXksIE9iamVjdFtdIHN1YnMpIHsKICAg\nICAgICByZXR1cm4gbmV3IE1lc3NhZ2UoX3BrZywgZ2V0QnVuZGxlKCksIGtl\neSwgc3VicywgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBsb2NhbGl6ZWQgc3RyaW5nIG1hdGNoaW5nIHRoZSBnaXZlbiBrZXku\nIFRoZSBnaXZlbgogICAgICogPGNvZGU+c3ViczwvY29kZT4gb2JqZWN0cyB3\naWxsIGJlIHN1YnN0aXR1dGVkCiAgICAgKiBpbnRvIHRoZSBmb3VuZCBzdHJp\nbmcgYWNjb3JkaW5nIHRvIHRoZSBydWxlcyBvZiB0aGUKICAgICAqIHtAbGlu\nayBNZXNzYWdlRm9ybWF0fSBjbGFzcy4KICAgICAqCiAgICAgKiBAc2VlICNn\nZXRGYXRhbChTdHJpbmcpCiAgICAgKi8KICAgIHB1YmxpYyBNZXNzYWdlIGdl\ndEZhdGFsKFN0cmluZyBrZXksIE9iamVjdFtdIHN1YnMpIHsKICAgICAgICBy\nZXR1cm4gbmV3IE1lc3NhZ2UoX3BrZywgZ2V0QnVuZGxlKCksIGtleSwgc3Vi\ncywgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBIDxjb2RlPk1lc3Nh\nZ2U8L2NvZGU+IGNhbiBwcm92aWRlIGEgbG9jYWxpemVkIG1lc3NhZ2Ugdmlh\nIHRoZSAKICAgICAqIHtAbGluayAjZ2V0TWVzc2FnZX0gbWV0aG9kIGNhbGws\nIGFuZCBjYW4gYWxzbyBwcm92aWRlIHRoZSBvcmlnaW5hbCBrZXksCiAgICAg\nKiBwYWNrYWdlLCBhbmQgc3Vic3RpdHV0aW9uIGFycmF5IHRoYXQgd2VyZSB1\nc2VkIHRvIGFzc2VtYmxlIHRoZSBtZXNzYWdlLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGNsYXNzIE1lc3NhZ2UgewoKICAgICAgICBwcml2YXRlIGZp\nbmFsIFN0cmluZyBfcGtnOwogICAgICAgIHByaXZhdGUgZmluYWwgU3RyaW5n\nIF9rZXk7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBPYmplY3RbXSBfc3ViczsK\nICAgICAgICBwcml2YXRlIGZpbmFsIFN0cmluZyBfbG9jYWxpemVkTWVzc2Fn\nZTsKCiAgICAgICAgcHJpdmF0ZSBNZXNzYWdlKFN0cmluZyBwYWNrYWdlTmFt\nZSwgUmVzb3VyY2VCdW5kbGUgYnVuZGxlLCBTdHJpbmcga2V5LCAKICAgICAg\nICAgICAgT2JqZWN0W10gc3VicywgYm9vbGVhbiBmYXRhbCkgewogICAgICAg\nICAgICBpZiAoYnVuZGxlID09IG51bGwgJiYgZmF0YWwpCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKGtleSwg\na2V5LCBrZXkpOwoKICAgICAgICAgICAgX3BrZyA9IHBhY2thZ2VOYW1lOwog\nICAgICAgICAgICBfa2V5ID0ga2V5OwogICAgICAgICAgICBfc3VicyA9IHN1\nYnM7CiAgICAgICAgICAgIGlmIChidW5kbGUgPT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgX2xvY2FsaXplZE1lc3NhZ2UgPSBrZXk7CiAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgbG9jYWxpemVkID0g\nbnVsbDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAg\nICAgbG9jYWxpemVkID0gYnVuZGxlLmdldFN0cmluZyhrZXkpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uIG1y\nZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChmYXRhbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgbXJlOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgX2xvY2FsaXplZE1lc3NhZ2UgPSAobG9jYWxpemVk\nID09IG51bGwpID8ga2V5IDogbG9jYWxpemVkOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBUaGUgbG9jYWxpemVk\nIG1lc3NhZ2UuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIFN0cmluZyBn\nZXRNZXNzYWdlKCkgewogICAgICAgICAgICByZXR1cm4gTWVzc2FnZUZvcm1h\ndC5mb3JtYXQoX2xvY2FsaXplZE1lc3NhZ2UsIF9zdWJzKTsKICAgICAgICB9\nCgogICAgICAgIC8qKgogICAgICAgICAqIFRoZSB1bmlxdWUga2V5IGZvciB0\naGUgbG9jYWxpemVkIG1lc3NhZ2UuCiAgICAgICAgICovCiAgICAgICAgcHVi\nbGljIFN0cmluZyBnZXRLZXkoKSB7CiAgICAgICAgICAgIHJldHVybiBfa2V5\nOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogU3Vic3RpdHV0\naW9ucyBpbnNlcnRlZCBpbnRvIHRoZSBtZXNzYWdlLgogICAgICAgICAqLwog\nICAgICAgIHB1YmxpYyBPYmplY3RbXSBnZXRTdWJzdGl0dXRpb25zKCkgewog\nICAgICAgICAgICByZXR1cm4gX3N1YnM7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgU3RyaW5nIGdldFBhY2thZ2VOYW1lKCkgewogICAgICAgICAgICBy\nZXR1cm4gX3BrZzsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcg\ndG9TdHJpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRNZXNzYWdlKCk7\nCiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

