{"sha":"82cc6bd16a804c63dc1af703d78af74a895860a8","node_id":"MDQ6QmxvYjIwNjM2NDo4MmNjNmJkMTZhODA0YzYzZGMxYWY3MDNkNzhhZjc0YTg5NTg2MGE4","size":7674,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/82cc6bd16a804c63dc1af703d78af74a895860a8","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbDsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS51dGlsLkFycmF5\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLlZlY3RvcjsKCi8qKgogKiBDbGFzcyBsb2FkZXIgdHlw\nZSB0aGF0IGNhbiBiZSBjb25maWd1cmVkIHRvIGRlbGVnYXRlIHRvIG11bHRp\ncGxlCiAqIGludGVybmFsIGNsYXNzIGxvYWRlcnMuCiAqIFRoZSB7QGxpbmsg\nI1RIUkVBRF9MT0FERVJ9IGNvbnN0YW50IGlzIGEgbWFya2VyIHRoYXQgd2ls\nbCBiZSByZXBsYWNlZAogKiB3aXRoIHRoZSBjb250ZXh0IGxvYWRlciBvZiB0\naGUgY3VycmVudCB0aHJlYWQuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nLwpwdWJsaWMgY2xhc3MgTXVsdGlDbGFzc0xvYWRlciBleHRlbmRzIENsYXNz\nTG9hZGVyIHsKCiAgICAvKioKICAgICAqIE1hcmtlciB0aGF0IHdpbGwgYmUg\ncmVwbGFjZWQgd2l0aCB0aGUgY29udGV4dCBsb2FkZXIgb2YgdGhlIGN1cnJl\nbnQKICAgICAqIHRocmVhZCB3aGVuZXZlciBpdCBpcyBkaXNjb3ZlcmVkIGlu\nIHRoZSBjbGFzcyBsb2FkZXIgbGlzdC4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBDbGFzc0xvYWRlciBUSFJFQURfTE9BREVSID0gbnVsbDsK\nCiAgICAvKioKICAgICAqIFRoZSBzdGFuZGFyZCBzeXN0ZW0gY2xhc3MgbG9h\nZGVyLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIENsYXNzTG9h\nZGVyIFNZU1RFTV9MT0FERVIgPQogICAgICAgIENsYXNzTG9hZGVyLmdldFN5\nc3RlbUNsYXNzTG9hZGVyKCk7CgogICAgcHJpdmF0ZSBMaXN0IF9sb2FkZXJz\nID0gbmV3IEFycmF5TGlzdCg1KTsKCiAgICAvKioKICAgICAqIENvbnN0cnVj\ndG9yOyBpbml0aWFsaXplcyB0aGUgbG9hZGVyIHdpdGggYW4gZW1wdHkgbGlz\ndCBvZiBkZWxlZ2F0ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBNdWx0aUNsYXNz\nTG9hZGVyKCkgewogICAgICAgIHN1cGVyKG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29uc3RydWN0IHdpdGggdGhlIGNsYXNzIGxvYWRlcnMgb2Yg\nYW5vdGhlciBtdWx0aSBsb2FkZXIuCiAgICAgKi8KICAgIHB1YmxpYyBNdWx0\naUNsYXNzTG9hZGVyKE11bHRpQ2xhc3NMb2FkZXIgb3RoZXIpIHsKICAgICAg\nICBzdXBlcihudWxsKTsKICAgICAgICBhZGRDbGFzc0xvYWRlcnMob3RoZXIp\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBs\naXN0IGNvbnRhaW5zIHRoZSBnaXZlbiBjbGFzcyBsb2FkZXIgb3IgbWFya2Vy\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0NsYXNzTG9h\nZGVyKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIHJldHVybiBfbG9h\nZGVycy5jb250YWlucyhsb2FkZXIpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIGFuIGFycmF5IG9mIGFsbCBjb250YWluZWQgY2xhc3MgbG9hZGVy\ncy4KICAgICAqLwogICAgcHVibGljIENsYXNzTG9hZGVyW10gZ2V0Q2xhc3NM\nb2FkZXJzKCkgewogICAgICAgIENsYXNzTG9hZGVyW10gbG9hZGVycyA9IG5l\ndyBDbGFzc0xvYWRlcltzaXplKCldOwogICAgICAgIENsYXNzTG9hZGVyIGxv\nYWRlcjsKICAgICAgICBJdGVyYXRvciBpdHIgPSBfbG9hZGVycy5pdGVyYXRv\ncigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbG9hZGVycy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICBsb2FkZXIgPSAoQ2xhc3NMb2FkZXIp\nIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChsb2FkZXIgPT0gVEhSRUFE\nX0xPQURFUikKICAgICAgICAgICAgICAgIGxvYWRlciA9IFRocmVhZC5jdXJy\nZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCk7CiAgICAgICAg\nICAgIGxvYWRlcnNbaV0gPSBsb2FkZXI7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBsb2FkZXJzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBjbGFzcyBsb2FkZXIgYXQgdGhlIGdpdmVuIGluZGV4LgogICAgICovCiAg\nICBwdWJsaWMgQ2xhc3NMb2FkZXIgZ2V0Q2xhc3NMb2FkZXIoaW50IGluZGV4\nKSB7CiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyID0gKENsYXNzTG9hZGVy\nKSBfbG9hZGVycy5nZXQoaW5kZXgpOwogICAgICAgIGlmIChsb2FkZXIgPT0g\nVEhSRUFEX0xPQURFUikKICAgICAgICAgICAgbG9hZGVyID0gVGhyZWFkLmN1\ncnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKTsKICAgICAg\nICByZXR1cm4gbG9hZGVyOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRo\nZSBnaXZlbiBjbGFzcyBsb2FkZXIgdG8gdGhlIHNldCBvZiBsb2FkZXJzIHRo\nYXQgd2lsbCBiZSB0cmllZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUg\naWYgdGhlIGxvYWRlciB3YXMgYWRkZWQsIGZhbHNlIGlmIGFscmVhZHkgaW4g\ndGhlIGxpc3QKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gYWRkQ2xhc3NM\nb2FkZXIoQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgaWYgKF9sb2Fk\nZXJzLmNvbnRhaW5zKGxvYWRlcikpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICByZXR1cm4gX2xvYWRlcnMuYWRkKGxvYWRlcik7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVuIGNsYXNzIGxvYWRlciBh\ndCB0aGUgc3BlY2lmaWVkIGluZGV4LgogICAgICoKICAgICAqIEByZXR1cm4g\ndHJ1ZSBpZiB0aGUgbG9hZGVyIHdhcyBhZGRlZCwgZmFsc2UgaWYgYWxyZWFk\neSBpbiB0aGUgbGlzdAogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBhZGRD\nbGFzc0xvYWRlcihpbnQgaW5kZXgsIENsYXNzTG9hZGVyIGxvYWRlcikgewog\nICAgICAgIGlmIChfbG9hZGVycy5jb250YWlucyhsb2FkZXIpKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgX2xvYWRlcnMuYWRkKGluZGV4\nLCBsb2FkZXIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBjbGFzcyBsb2FkZXJzIG9mIHRoaXMgbG9hZGVy\nIHRvIHRob3NlIG9mIHRoZSBnaXZlbiBsb2FkZXIuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldENsYXNzTG9hZGVycyhNdWx0aUNsYXNzTG9hZGVyIG11\nbHRpKSB7CiAgICAgICAgY2xlYXIoKTsKICAgICAgICBhZGRDbGFzc0xvYWRl\ncnMobXVsdGkpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkcyBhbGwgY2xh\nc3MgbG9hZGVycyBmcm9tIHRoZSBnaXZlbiBtdWx0aSBsb2FkZXIgc3RhcnRp\nbmcgYXQgdGhlCiAgICAgKiBnaXZlbiBpbmRleC4KICAgICAqCiAgICAgKiBA\ncmV0dXJuIHRydWUgaWYgYW55IGxvYWRlcnMgd2VyZSBhZGRlZCwgZmFsc2Ug\naWYgYWxsIGFscmVhZHkgaW4gbGlzdAogICAgICovCiAgICBwdWJsaWMgYm9v\nbGVhbiBhZGRDbGFzc0xvYWRlcnMoaW50IGluZGV4LCBNdWx0aUNsYXNzTG9h\nZGVyIG11bHRpKSB7CiAgICAgICAgaWYgKG11bHRpID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gdXNlIGl0ZXJhdG9y\nIHNvIHRoYXQgdGhlIHRocmVhZCBsb2FkZXIgaXMgbm90IHJlc29sdmVkCiAg\nICAgICAgYm9vbGVhbiBhZGRlZCA9IGZhbHNlOwogICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRyID0gbXVsdGkuX2xvYWRlcnMuaXRlcmF0b3IoKTsgaXRyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgaWYgKGFkZENsYXNzTG9hZGVyKGlu\nZGV4LCAoQ2xhc3NMb2FkZXIpIGl0ci5uZXh0KCkpKSB7CiAgICAgICAgICAg\nICAgICBpbmRleCsrOwogICAgICAgICAgICAgICAgYWRkZWQgPSB0cnVlOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBhZGRlZDsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFkZHMgYWxsIHRoZSBjbGFzcyBsb2Fk\nZXJzIGZyb20gdGhlIGdpdmVuIG11bHRpIGxvYWRlci4KICAgICAqCiAgICAg\nKiBAcmV0dXJuIHRydWUgaWYgYW55IGxvYWRlcnMgd2VyZSBhZGRlZCwgZmFs\nc2UgaWYgYWxsIGFscmVhZHkgaW4gbGlzdAogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBhZGRDbGFzc0xvYWRlcnMoTXVsdGlDbGFzc0xvYWRlciBtdWx0\naSkgewogICAgICAgIGlmIChtdWx0aSA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIHVzZSBpdGVyYXRvciBzbyB0aGF0\nIHRoZSB0aHJlYWQgbG9hZGVyIGlzIG5vdCByZXNvbHZlZAogICAgICAgIGJv\nb2xlYW4gYWRkZWQgPSBmYWxzZTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nciA9IG11bHRpLl9sb2FkZXJzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7\nKQogICAgICAgICAgICBhZGRlZCA9IGFkZENsYXNzTG9hZGVyKChDbGFzc0xv\nYWRlcikgaXRyLm5leHQoKSkgfHwgYWRkZWQ7CiAgICAgICAgcmV0dXJuIGFk\nZGVkOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBnaXZlbiBs\nb2FkZXIgZnJvbSB0aGUgbGlzdC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRy\ndWUgaWYgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIGxpc3QKICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlQ2xhc3NMb2FkZXIoQ2xhc3NMb2Fk\nZXIgbG9hZGVyKSB7CiAgICAgICAgcmV0dXJuIF9sb2FkZXJzLnJlbW92ZShs\nb2FkZXIpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xlYXIgdGhlIGxpc3Qg\nb2YgY2xhc3MgbG9hZGVycy4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xl\nYXIoKSB7CiAgICAgICAgX2xvYWRlcnMuY2xlYXIoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIGludGVybmFsIGNsYXNz\nIGxvYWRlcnMuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsKICAg\nICAgICByZXR1cm4gX2xvYWRlcnMuc2l6ZSgpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRydWUgaWYgdGhlcmUgYXJlIG5vIGludGVybmFsIGNs\nYXNzIGxhb2RlcnMuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzRW1w\ndHkoKSB7CiAgICAgICAgcmV0dXJuIF9sb2FkZXJzLmlzRW1wdHkoKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgQ2xhc3MgZmluZENsYXNzKFN0cmluZyBuYW1l\nKSB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xh\nc3NMb2FkZXIgbG9hZGVyOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0g\nX2xvYWRlcnMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgbG9hZGVyID0gKENsYXNzTG9hZGVyKSBpdHIubmV4dCgpOwogICAg\nICAgICAgICBpZiAobG9hZGVyID09IFRIUkVBRF9MT0FERVIpCiAgICAgICAg\nICAgICAgICBsb2FkZXIgPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENv\nbnRleHRDbGFzc0xvYWRlcigpOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIENsYXNzLmZvck5hbWUobmFtZSwgZmFsc2UsIGxv\nYWRlcik7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IENsYXNz\nTm90Rm91bmRFeGNlcHRpb24obmFtZSk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIFVSTCBmaW5kUmVzb3VyY2UoU3RyaW5nIG5hbWUpIHsKICAgICAgICBDbGFz\nc0xvYWRlciBsb2FkZXI7CiAgICAgICAgVVJMIHJzcmM7CiAgICAgICAgZm9y\nIChJdGVyYXRvciBpdHIgPSBfbG9hZGVycy5pdGVyYXRvcigpOyBpdHIuaGFz\nTmV4dCgpOykgewogICAgICAgICAgICBsb2FkZXIgPSAoQ2xhc3NMb2FkZXIp\nIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChsb2FkZXIgPT0gVEhSRUFE\nX0xPQURFUikKICAgICAgICAgICAgICAgIGxvYWRlciA9IFRocmVhZC5jdXJy\nZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCk7CgogICAgICAg\nICAgICByc3JjID0gbG9hZGVyLmdldFJlc291cmNlKG5hbWUpOwogICAgICAg\nICAgICBpZiAocnNyYyAhPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJu\nIHJzcmM7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoK\nICAgIHByb3RlY3RlZCBFbnVtZXJhdGlvbiBmaW5kUmVzb3VyY2VzKFN0cmlu\nZyBuYW1lKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENsYXNzTG9h\nZGVyIGxvYWRlcjsKICAgICAgICBFbnVtZXJhdGlvbiByc3JjczsKICAgICAg\nICBPYmplY3QgcnNyYzsKICAgICAgICBWZWN0b3IgYWxsID0gbmV3IFZlY3Rv\ncigpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2xvYWRlcnMuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgbG9hZGVy\nID0gKENsYXNzTG9hZGVyKSBpdHIubmV4dCgpOwogICAgICAgICAgICBpZiAo\nbG9hZGVyID09IFRIUkVBRF9MT0FERVIpCiAgICAgICAgICAgICAgICBsb2Fk\nZXIgPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xv\nYWRlcigpOwoKICAgICAgICAgICAgcnNyY3MgPSBsb2FkZXIuZ2V0UmVzb3Vy\nY2VzKG5hbWUpOwogICAgICAgICAgICB3aGlsZSAocnNyY3MuaGFzTW9yZUVs\nZW1lbnRzKCkpIHsKICAgICAgICAgICAgICAgIHJzcmMgPSByc3Jjcy5uZXh0\nRWxlbWVudCgpOwogICAgICAgICAgICAgICAgaWYgKCFhbGwuY29udGFpbnMo\ncnNyYykpCiAgICAgICAgICAgICAgICAgICAgYWxsLmFkZEVsZW1lbnQocnNy\nYyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFs\nbC5lbGVtZW50cygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVxdWFs\ncyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIg\naW5zdGFuY2VvZiBNdWx0aUNsYXNzTG9hZGVyKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIHJldHVybiAoKE11bHRpQ2xhc3NMb2FkZXIp\nIG90aGVyKS5fbG9hZGVycy5lcXVhbHMoX2xvYWRlcnMpOwogICAgfQoKICAg\nIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAgcmV0dXJuIF9sb2Fk\nZXJzLmhhc2hDb2RlKCk7CiAgICB9Cn0K\n","encoding":"base64"}

