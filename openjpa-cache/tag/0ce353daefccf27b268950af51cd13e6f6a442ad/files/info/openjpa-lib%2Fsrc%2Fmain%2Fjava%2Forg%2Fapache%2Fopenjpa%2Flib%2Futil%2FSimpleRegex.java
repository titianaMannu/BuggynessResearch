{"sha":"5bc0dc5091505664ac9c3560562f307ac85fa9df","node_id":"MDQ6QmxvYjIwNjM2NDo1YmMwZGM1MDkxNTA1NjY0YWM5YzM1NjA1NjJmMzA3YWM4NWZhOWRm","size":5397,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5bc0dc5091505664ac9c3560562f307ac85fa9df","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbDsKCi8qKgogKiBBbGxvd3MgZm9yIHNpbXBsZSBy\nZWdleCBzdHlsZSB0ZXN0aW5nIG9mIHN0cmluZ3MuIFRoZSB3aWxkY2FyZCAn\nLicKICogaXMgdXNlZCB0byByZXByZXNlbnQgYW55IHNpbmdsZSBjaGFyYWN0\nZXIsIHdoaWxlICcuKicgaXMgdXNlZCB0byByZXByZXNlbnQKICogYW55IHNl\ncmllcyBvZiAwIG9yIG1vcmUgY2hhcmFjdGVycy4gRXhhbXBsZXM6PGJyIC8+\nCiAqIDxjb2RlPiBTaW1wbGVSZWdleCByZSA9IG5ldyBTaW1wbGVSZWdleCgi\ndGhlIHF1LmNrIC4qIGRvZyIsIHRydWUpOwogKiBib29sZWFuIG1hdGNoZXMg\nPSByZS5tYXRjaGVzKCJUaGUgcXVpY2sgZm94IGp1bXBlZCBvdmVyIHRoZSBs\nYXp5IGRvZyIpOwogKiA8L2NvZGU+CiAqCiAqIEBub2phdmFkb2MKICovCnB1\nYmxpYyBjbGFzcyBTaW1wbGVSZWdleCB7CgogICAgcHJpdmF0ZSBmaW5hbCBT\ndHJpbmcgZXhwcjsKICAgIHByaXZhdGUgZmluYWwgYm9vbGVhbiBjYXNlSW5z\nZW5zaXRpdmU7CgogICAgcHVibGljIFNpbXBsZVJlZ2V4KFN0cmluZyBleHBy\nLCBib29sZWFuIGNhc2VJbnNlbnNpdGl2ZSkgewogICAgICAgIHRoaXMuY2Fz\nZUluc2Vuc2l0aXZlID0gY2FzZUluc2Vuc2l0aXZlOwoKICAgICAgICAvLyBJ\nZiB3ZSdyZSBjYXNlIGluc2Vuc2l0aXZlLCB0b0xvd2VyQ2FzZSB0aGUgZXhw\nci4gIFdlJ2xsIHRvTG93ZXJDYXNlCiAgICAgICAgLy8gZWFjaCB0YXJnZXQs\nIHRvbywgaW4gdGhlIG1hdGNoZXMgY2FsbC4KICAgICAgICBpZiAoY2FzZUlu\nc2Vuc2l0aXZlKQogICAgICAgICAgICB0aGlzLmV4cHIgPSBleHByLnRvTG93\nZXJDYXNlKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICB0aGlzLmV4cHIg\nPSBleHByOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIG1hdGNoZXMoU3Ry\naW5nIHRhcmdldCkgewogICAgICAgIC8vIElmIHdlJ3JlIGNhc2UgaW5zZW5z\naXRpdmUsIHRvTG93ZXJDYXNlIHRoZSB0YXJnZXQKICAgICAgICBpZiAoY2Fz\nZUluc2Vuc2l0aXZlKQogICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQudG9M\nb3dlckNhc2UoKTsKCiAgICAgICAgLy8gQnkgZGVmYXVsdCwgd2UgYXJlIG5v\ndCBwb3NpdGlvbiBpbmRlcGVuZGVudCgibW9iaWxlIikuIFdlIG9ubHkKICAg\nICAgICAvLyBiZWNvbWUgcG9zaXRpb24gaW5kZXBlbmRlbnQgb25jZSB3ZSBo\naXQgb3VyIGZpcnN0ICIuKiIuCiAgICAgICAgYm9vbGVhbiBtb2JpbGUgPSBm\nYWxzZTsKCiAgICAgICAgLy8gRmluZCBvY2N1cnJlbmNlcyBvZiAiLioiIGlu\nIHRoZSBleHByZXNzaW9uLgogICAgICAgIGludCBleHByUG9zID0gMDsKICAg\nICAgICBpbnQgdGFyZ2V0UG9zID0gMDsKICAgICAgICB3aGlsZSAodHJ1ZSkg\newogICAgICAgICAgICAvLyBGaW5kIHRoZSBuZXh0IG9jY3VycmVuY2Ugb2Yg\nIi4qIgogICAgICAgICAgICBpbnQgc3RhciA9IGV4cHIuaW5kZXhPZigiLioi\nLCBleHByUG9zKTsKCiAgICAgICAgICAgIC8vIElmIHdlJ3JlIGF0IGEgIi4q\nIiBub3csIHNpbXBseSBza2lwIGl0IGFuZCBiZWNvbWUgcG9zaXRpb24KICAg\nICAgICAgICAgLy8gaW5kZXBlbmRlbnQKICAgICAgICAgICAgaWYgKHN0YXIg\nPT0gZXhwclBvcykgewogICAgICAgICAgICAgICAgbW9iaWxlID0gdHJ1ZTsK\nICAgICAgICAgICAgICAgIGV4cHJQb3MgKz0gMjsKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIElmIHRo\nZXJlIGFyZSBubyBtb3JlICIuKiJzLCB0aGVuIHdlJ3JlIGVmZmVjdGl2ZWx5\nIG5vIGxvbmdlcgogICAgICAgICAgICAvLyBwb3NpdGlvbiBpbmRlcGVuZGVu\ndChhc3N1bWluZyB3ZSBldmVuIHdlcmUgYmVmb3JlKSwgc2luY2UKICAgICAg\nICAgICAgLy8gd2UgbXVzdCBtYXRjaCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcK\nICAgICAgICAgICAgZWxzZSBpZiAoc3RhciA9PSAtMSkgewogICAgICAgICAg\nICAgICAgaW50IGxlbiA9IGV4cHIubGVuZ3RoKCkgLSBleHByUG9zOwoKICAg\nICAgICAgICAgICAgIC8vIElmIHdlJ3JlIG5vdCBtb2JpbGUsIHRoZW4gdGhl\nIHJlbWFpbmRlciBvZiB0aGUgZXhwciBhbmQKICAgICAgICAgICAgICAgIC8v\nIHRhcmdldCBtdXN0IGJlIHRoZSBzYW1lIGxlbmd0aC4gIElmIG5vdCwgdGhl\nbiBpdCdzIG5vdCBhCiAgICAgICAgICAgICAgICAvLyBtYXRjaC4gIElmIHdl\nJ3JlIG1vYmlsZSwgdGhlbiB0aGUgbGVuZ3RoIGRvZXNuJ3QgaGF2ZSB0bwog\nICAgICAgICAgICAgICAgLy8gYmUgdGhlIHNhbWUgYXMgbG9uZyBhcyB0aGUg\ncmVtYWluZGVyIG9mIHRoZSBleHByZXNzaW9uCiAgICAgICAgICAgICAgICAv\nLyBpcyBlcXVhbCB0byB0aGUgZW5kIG9mIHRoZSB0YXJnZXQKICAgICAgICAg\nICAgICAgIGlmICghbW9iaWxlICYmIHRhcmdldFBvcyAhPSB0YXJnZXQubGVu\nZ3RoKCkgLSBsZW4pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwoKICAgICAgICAgICAgICAgIC8vIEluIGFueWNhc2UsIHRoZSByZW1haW5p\nbmcgbGVuZ3RoIG9mIHRoZSB0YXJnZXQgbXVzdCBiZQogICAgICAgICAgICAg\nICAgLy8gYXQgbGVhc3QgYXMgbG9uZyBhcyB0aGUgcmVtYWluaW5nIGxlbmd0\naCBvZiB0aGUgZXhwcmVzc2lvbi4KICAgICAgICAgICAgICAgIC8vIChXZSBj\naGVjayBub3cgdG8gYXZvaWQgc2VuZGluZyBhIG5lZ2F0aXZlIHN0YXJ0IHBv\ncyB0bwogICAgICAgICAgICAgICAgLy8gaW5kZXhPZikKICAgICAgICAgICAg\nICAgIGlmICh0YXJnZXQubGVuZ3RoKCkgPCBsZW4pCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgICAgIC8vIE1hdGNo\nIHRoZSBlbmQgb2YgdGhlIHRhcmdldCB0byB0aGUgcmVtYWluZGVyIG9mIHRo\nZQogICAgICAgICAgICAgICAgLy8gZXhwcmVzc2lvbgogICAgICAgICAgICAg\nICAgaW50IG1hdGNoID0gaW5kZXhPZih0YXJnZXQsIHRhcmdldC5sZW5ndGgo\nKSAtIGxlbiwgZXhwclBvcywKICAgICAgICAgICAgICAgICAgICBsZW4sIHRy\ndWUpOwogICAgICAgICAgICAgICAgaWYgKG1hdGNoICE9IC0xKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBNYXRj\naCB0aGUgZnJhZ21lbnQgb2YgdGhlIGV4cHJlc3Npb24gdG8gdGhlIHRhcmdl\ndAogICAgICAgICAgICBpbnQgbWF0Y2ggPSBpbmRleE9mKHRhcmdldCwgdGFy\nZ2V0UG9zLCBleHByUG9zLAogICAgICAgICAgICAgICAgc3RhciAtIGV4cHJQ\nb3MsICFtb2JpbGUpOwogICAgICAgICAgICBpZiAobWF0Y2ggPT0gLTEpCiAg\nICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIHRhcmdl\ndFBvcyA9IG1hdGNoICsgc3RhciAtIGV4cHJQb3M7CiAgICAgICAgICAgIGV4\ncHJQb3MgPSBzdGFyICsgMjsKICAgICAgICAgICAgbW9iaWxlID0gdHJ1ZTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXRjaCBhIHNlY3Rp\nb24gb2YgdGFyZ2V0IHRvIGEgZnJhZ21lbnQgb2YgdGhlIGV4cHJlc3Npb24u\nCiAgICAgKiBJZiB3ZSdyZSBvbmx5IHRvIG1hdGNoIHRoZSBiZWdpbm5pbmcg\nb2YgdGhlIHRhcmdldCwgYmVnaW5Pbmx5CiAgICAgKiB3aWxsIGJlIHRydWUs\nIG90aGVyd2lzZSB3ZSBjYW4gbWF0Y2ggYW55bW9yZSBpbiB0aGUgdGFyZ2V0\nKHN0YXJ0aW5nCiAgICAgKiBhdCB0aGUgdGFyZ2V0U3RhcnQgcG9zaXRpb24p\nLiBBICIuIiBpbiB0aGUgZXhwcmVzc2lvbiBtYXRjaGVzIGFueQogICAgICog\nY2hhcmFjdGVyLgogICAgICovCiAgICBwcml2YXRlIGludCBpbmRleE9mKFN0\ncmluZyB0YXJnZXQsIGludCB0YXJnZXRTdGFydCwKICAgICAgICBpbnQgZXhw\nclN0YXJ0LCBpbnQgZXhwckxlbmd0aCwgYm9vbGVhbiBiZWdpbk9ubHkpIHsK\nICAgICAgICAvLyBSdW4gdGhyb3VnaCB0aGUgdGFyZ2V0IHNlZWluZyBpZiB0\naGVyZSBpcyBhIG1hdGNoCiAgICAgICAgd2hpbGUgKHRhcmdldC5sZW5ndGgo\nKSAtIHRhcmdldFN0YXJ0ID49IGV4cHJMZW5ndGgpIHsKICAgICAgICAgICAg\nLy8gQXNzdW1lIHN1Y2Nlc3MuICBJZiB0aGVyZSBpc24ndCBhIG1hdGNoIHdl\nJ2xsIGJyZWFrIG91dAogICAgICAgICAgICBib29sZWFuIGZvdW5kID0gdHJ1\nZTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBleHByTGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgIC8vICIuIiBpbiB0aGUgZXhwciBt\nYXRjaGVzIGFueSBjaGFyYWN0ZXIgaW4gdGhlIHRhcmdldAogICAgICAgICAg\nICAgICAgaWYgKGV4cHIuY2hhckF0KGV4cHJTdGFydCArIGkpICE9ICcuJyAm\nJgogICAgICAgICAgICAgICAgICAgIGV4cHIuY2hhckF0KGV4cHJTdGFydCAr\nIGkpICE9CiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5jaGFyQXQo\ndGFyZ2V0U3RhcnQgKyBpKSkgewogICAgICAgICAgICAgICAgICAgIGZvdW5k\nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGZvdW5k\nKQogICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFN0YXJ0OwoKICAgICAg\nICAgICAgLy8gSWYgd2UncmUgcG9zaXRpb24gZGVwZW5kZW50KGJlZ2luT25s\neSA9PSB0cnVlKSwgdGhlbiBkb24ndAogICAgICAgICAgICAvLyBjb250aW51\nZSB0aGUgc2VhcmNoCiAgICAgICAgICAgIGlmIChiZWdpbk9ubHkpCiAgICAg\nICAgICAgICAgICByZXR1cm4gLTE7CgogICAgICAgICAgICB0YXJnZXRTdGFy\ndCsrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gLTE7CiAgICB9Cn0K\n","encoding":"base64"}

