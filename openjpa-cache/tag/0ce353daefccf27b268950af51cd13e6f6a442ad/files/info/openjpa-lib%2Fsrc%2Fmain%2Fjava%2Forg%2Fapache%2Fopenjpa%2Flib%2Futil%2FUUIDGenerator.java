{"sha":"0e8c17a04d383315f650b71ecb0b5f4b7a717a6a","node_id":"MDQ6QmxvYjIwNjM2NDowZThjMTdhMDRkMzgzMzE1ZjY1MGI3MWVjYjBiNWY0YjdhNzE3YTZh","size":7649,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0e8c17a04d383315f650b71ecb0b5f4b7a717a6a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbDsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5uZXQuSW5ldEFkZHJlc3M7CmltcG9ydCBqYXZhLnNl\nY3VyaXR5LlNlY3VyZVJhbmRvbTsKaW1wb3J0IGphdmEudXRpbC5SYW5kb207\nCgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuZXhjZXB0aW9uLk5l\nc3RhYmxlUnVudGltZUV4Y2VwdGlvbjsKCi8qKgogKiBVVUlEIHZhbHVlIGdl\nbmVyYXRvci4gIEJhc2VkIG9uIHRoZSB0aW1lLWJhc2VkIGdlbmVyYXRvciBp\nbiB0aGUgQXBhY2hlCiAqIENvbW1vbnMgSWQgcHJvamVjdDogIGh0dHA6Ly9q\nYWthcnRhLmFwYWNoZS5vcmcvY29tbW9ucy9zYW5kYm94L2lkL3V1aWQuaHRt\nbAogKgogKiBUaGUgY29kZSBoYXMgYmVlbiB2YXN0bHkgc2ltcGxpZmllZCBh\nbmQgbW9kaWZpZWQgdG8gcmVwbGFjZSB0aGUgZXRoZXJuZXQKICogYWRkcmVz\ncyBvZiB0aGUgaG9zdCBtYWNoaW5lIHdpdGggdGhlIElQLCBzaW5jZSB3ZSBk\nbyBub3Qgd2FudCB0byByZXF1aXJlCiAqIG5hdGl2ZSBsaWJzIGFuZCBKYXZh\nIGNhbm5vdCBhY2Nlc3MgdGhlIE1BQyBhZGRyZXNzIGRpcmVjdGx5LgogKgog\nKiBJbiBzcGlyaXQsIGltcGxlbWVudHMgdGhlIElFVEYgVVVJRCBkcmFmdCBz\ncGVjaWZpY2F0aW9uLCBmb3VuZCBoZXJlOjxiciAvPgogKiBodHRwOi8vd3d3\nMS5pY3MudWNpLmVkdS9+ZWp3L2F1dGhvcmluZy91dWlkLWd1aWQvZHJhZnQt\nbGVhY2gtdXVpZHMtZ3VpZHMtMDEKICogLnR4dAogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZSwgS2V2aW4gU3V0dGVyCiAqIEBub2phdmFkb2MKICogQHNpbmNl\nIDAuMy4zCiAqLwpwdWJsaWMgY2xhc3MgVVVJREdlbmVyYXRvciB7CgogICAg\nLy8gaW5kZXhlcyB3aXRoaW4gdGhlIHV1aWQgYXJyYXkgZm9yIGNlcnRhaW4g\nYm91bmRhcmllcwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgYnl0ZSBJRFhf\nVElNRV9ISSA9IDY7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRlIElE\nWF9UWVBFID0gNjsgLy8gbXVsdGlwbGV4ZWQKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIGJ5dGUgSURYX1RJTUVfTUlEID0gNDsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIGJ5dGUgSURYX1RJTUVfTE8gPSAwOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgYnl0ZSBJRFhfVElNRV9TRVEgPSA4OwogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgYnl0ZSBJRFhfVkFSSUFUSU9OID0gODsgLy8gbXVs\ndGlwbGV4ZWQKCiAgICAvLyBpbmRleGVzIGFuZCBsZW5ndGhzIHdpdGhpbiB0\naGUgdGltZXN0YW1wIGZvciBjZXJ0YWluIGJvdW5kYXJpZXMKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIGJ5dGUgVFNfVElNRV9MT19JRFggPSA0OwogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgYnl0ZSBUU19USU1FX0xPX0xFTiA9IDQ7\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRlIFRTX1RJTUVfTUlEX0lE\nWCA9IDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRlIFRTX1RJTUVf\nTUlEX0xFTiA9IDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRlIFRT\nX1RJTUVfSElfSURYID0gMDsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGJ5\ndGUgVFNfVElNRV9ISV9MRU4gPSAyOwoKICAgIC8vIG9mZnNldCB0byBtb3Zl\nIGZyb20gMS8xLzE5NzAsIHdoaWNoIGlzIDAtdGltZSBmb3IgSmF2YSwgdG8g\nZ3JlZ29yaWFuCiAgICAvLyAwLXRpbWUgMTAvMTUvMTU4MiwgYW5kIG11bHRp\ncGxpZXIgdG8gZ28gZnJvbSAxMDBuc2VjIHRvIG1zZWMgdW5pdHMKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIGxvbmcgR1JFR19PRkZTRVQgPSAweDAxYjIx\nZGQyMTM4MTQwMDBMOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBN\nSUxMSV9NVUxUID0gMTAwMDBMOwoKICAgIC8vIHR5cGUgb2YgVVVJRCAtLSB0\naW1lIGJhc2VkCiAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBieXRlIFRZUEVf\nVElNRV9CQVNFRCA9IDB4MTA7CgogICAgLy8gcmFuZG9tIG51bWJlciBnZW5l\ncmF0b3IgdXNlZCB0byByZWR1Y2UgY29uZmxpY3RzIHdpdGggb3RoZXIgSlZN\ncywgYW5kCiAgICAvLyBoYXNoZXIgZm9yIHN0cmluZ3MuICBub3RlIHRoYXQg\nc2VjdXJlIHJhbmRvbSBpcyB2ZXJ5IHNsb3cgdGhlIGZpcnN0IHRpbWUKICAg\nIC8vIGl0IGlzIHVzZWQ7IGNvbnNpZGVyIHN3aXRjaGluZyB0byBhIHN0YW5k\nYXJkIHJhbmRvbQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgUmFuZG9tIFJB\nTkRPTSA9IG5ldyBTZWN1cmVSYW5kb20oKTsKCiAgICAvLyA0LWJ5dGUgSVAg\nYWRkcmVzcyArIDIgcmFuZG9tIGJ5dGVzIHRvIGNvbXBlbnNhdGUgZm9yIHRo\nZSBmYWN0IHRoYXQKICAgIC8vIHRoZSBNQUMgYWRkcmVzcyBpcyB1c3VhbGx5\nIDYgYnl0ZXMKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGJ5dGVbXSBJUDsK\nCiAgICAvLyBjb3VudGVyIGlzIGluaXRpYWxpemVkIHRvIDAgYW5kIGlzIGlu\nY3JlbWVudGVkIGZvciBlYWNoIHV1aWQgcmVxdWVzdAogICAgLy8gd2l0aGlu\nIHRoZSBzYW1lIHRpbWVzdGFtcCB3aW5kb3cuCiAgICBwcml2YXRlIHN0YXRp\nYyBpbnQgX2NvdW50ZXI7CgogICAgLy8gY3VycmVudCB0aW1lc3RhbXAgKHVz\nZWQgdG8gZGV0ZWN0IG11bHRpcGxlIHV1aWQgcmVxdWVzdHMgd2l0aGluIHNh\nbWUKICAgIC8vIHRpbWVzdGFtcCkKICAgIHByaXZhdGUgc3RhdGljIGxvbmcg\nX2N1cnJlbnRNaWxsaXM7CgogICAgLy8gbGFzdCB1c2VkIG1pbGxpcyB0aW1l\nLCBhbmQgYSBzZW1pLXJhbmRvbSBzZXF1ZW5jZSB0aGF0IGdldHMgcmVzZXQK\nICAgIC8vIHdoZW4gaXQgb3ZlcmZsb3dzCiAgICBwcml2YXRlIHN0YXRpYyBs\nb25nIF9sYXN0TWlsbGlzID0gMEw7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgTUFYXzE0QklUID0gMHgzRkZGOwogICAgcHJpdmF0ZSBzdGF0aWMg\nc2hvcnQgX3NlcSA9IChzaG9ydClSQU5ET00ubmV4dEludChNQVhfMTRCSVQp\nOwoKICAgIC8qCiAgICAgKiBTdGF0aWMgaW5pdGlhbGl6ZXIgdG8gZ2V0IHRo\nZSBJUCBhZGRyZXNzIG9mIHRoZSBob3N0IG1hY2hpbmUuCiAgICAgKi8KICAg\nIHN0YXRpYyB7CiAgICAgICAgYnl0ZVtdIGlwID0gbnVsbDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpcCA9IEluZXRBZGRyZXNzLmdldExvY2FsSG9z\ndCgpLmdldEFkZHJlc3MoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpb2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IE5lc3RhYmxlUnVudGlt\nZUV4Y2VwdGlvbihpb2UpOwogICAgICAgIH0KCiAgICAgICAgSVAgPSBuZXcg\nYnl0ZVs2XTsKICAgICAgICBSQU5ET00ubmV4dEJ5dGVzKElQKTsKICAgICAg\nICBTeXN0ZW0uYXJyYXljb3B5KGlwLCAwLCBJUCwgMiwgaXAubGVuZ3RoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHVuaXF1ZSBVVUlEIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJ5dGVbXSBuZXh0KCkg\newogICAgICAgIC8vIHNldCBpcCBhZGRyCiAgICAgICAgYnl0ZVtdIHV1aWQg\nPSBuZXcgYnl0ZVsxNl07CiAgICAgICAgU3lzdGVtLmFycmF5Y29weShJUCwg\nMCwgdXVpZCwgMTAsIElQLmxlbmd0aCk7CgogICAgICAgIC8vIFNldCB0aW1l\nIGluZm8uICBIYXZlIHRvIGRvIHRoaXMgcHJvY2Vzc2luZyB3aXRoaW4gYSBz\neW5jaHJvbml6ZWQKICAgICAgICAvLyBibG9jayBiZWNhdXNlIG9mIHRoZSBz\ndGF0aWNzLi4uCiAgICAgICAgbG9uZyBub3cgPSAwOwogICAgICAgIHN5bmNo\ncm9uaXplZCAoVVVJREdlbmVyYXRvci5jbGFzcykgewogICAgICAgICAgICAv\nLyBHZXQgdGhlIHRpbWUgdG8gdXNlIGZvciB0aGlzIHV1aWQuICBUaGlzIG1l\ndGhvZCBoYXMgdGhlIHNpZGUKICAgICAgICAgICAgLy8gZWZmZWN0IG9mIG1v\nZGlmeWluZyB0aGUgY2xvY2sgc2VxdWVuY2UsIGFzIHdlbGwuCiAgICAgICAg\nICAgIG5vdyA9IGdldFRpbWUoKTsKCiAgICAgICAgICAgIC8vIEluc2VydCB0\naGUgcmVzdWx0aW5nIGNsb2NrIHNlcXVlbmNlIGludG8gdGhlIHV1aWQKICAg\nICAgICAgICAgdXVpZFtJRFhfVElNRV9TRVFdID0gKGJ5dGUpICgoX3NlcSAm\nIDB4M0YwMCkgPj4+IDgpOwogICAgICAgICAgICB1dWlkW0lEWF9WQVJJQVRJ\nT05dIHw9IDB4ODA7CiAgICAgICAgICAgIHV1aWRbSURYX1RJTUVfU0VRKzFd\nID0gKGJ5dGUpIChfc2VxICYgMHhGRik7CgogICAgICAgIH0KCiAgICAgICAg\nLy8gaGF2ZSB0byBicmVhayB1cCB0aW1lIGJlY2F1c2UgYnl0ZXMgYXJlIHNw\ncmVhZCB0aHJvdWdoIHV1aWQKICAgICAgICBieXRlW10gdGltZUJ5dGVzID0g\nQnl0ZXMudG9CeXRlcyhub3cpOwoKICAgICAgICAvLyBDb3B5IHRpbWUgbG93\nCiAgICAgICAgU3lzdGVtLmFycmF5Y29weSh0aW1lQnl0ZXMsIFRTX1RJTUVf\nTE9fSURYLCB1dWlkLCBJRFhfVElNRV9MTywKICAgICAgICAgICAgICAgIFRT\nX1RJTUVfTE9fTEVOKTsKICAgICAgICAvLyBDb3B5IHRpbWUgbWlkCiAgICAg\nICAgU3lzdGVtLmFycmF5Y29weSh0aW1lQnl0ZXMsIFRTX1RJTUVfTUlEX0lE\nWCwgdXVpZCwgSURYX1RJTUVfTUlELAogICAgICAgICAgICAgICAgVFNfVElN\nRV9NSURfTEVOKTsKICAgICAgICAvLyBDb3B5IHRpbWUgaGkKICAgICAgICBT\neXN0ZW0uYXJyYXljb3B5KHRpbWVCeXRlcywgVFNfVElNRV9ISV9JRFgsIHV1\naWQsIElEWF9USU1FX0hJLAogICAgICAgICAgICAgICAgVFNfVElNRV9ISV9M\nRU4pOwogICAgICAgIC8vU2V0IHZlcnNpb24gKHRpbWUtYmFzZWQpCiAgICAg\nICAgdXVpZFtJRFhfVFlQRV0gfD0gVFlQRV9USU1FX0JBU0VEOyAvLyAwMDAx\nIDAwMDAKCiAgICAgICAgcmV0dXJuIHV1aWQ7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIG5leHQgdW5pcXVlIHV1aWQgdmFsdWUgYXMgYSAx\nNi1jaGFyYWN0ZXIgc3RyaW5nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIFN0cmluZyBuZXh0U3RyaW5nKCkgewogICAgICAgIGJ5dGVbXSBieXRlcyA9\nIG5leHQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gbmV3\nIFN0cmluZyhieXRlcywgIklTTy04ODU5LTEiKTsKICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmlu\nZyhieXRlcyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBuZXh0IHVuaXF1ZSB1dWlkIHZhbHVlIGFzIGEgMzItY2hhcmFj\ndGVyIGhleCBzdHJpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3Ry\naW5nIG5leHRIZXgoKSB7CiAgICAgICAgcmV0dXJuIEJhc2UxNkVuY29kZXIu\nZW5jb2RlKG5leHQoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhl\nIHRpbWVzdGFtcCB0byBiZSB1c2VkIGZvciB0aGlzIHV1aWQuICBNdXN0IGJl\nIGNhbGxlZCBmcm9tCiAgICAgKiBhIHN5bmNocm9uaXplZCBibG9jay4KICAg\nICAqCiAgICAgKiBAcmV0dXJuIGxvbmcgdGltZXN0YW1wCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGxvbmcgZ2V0VGltZSgpIHsKICAgICAgICBsb25n\nIG5ld1RpbWUgPSBnZXRVVUlEVGltZSgpOwogICAgICAgIGlmIChuZXdUaW1l\nIDw9IF9sYXN0TWlsbGlzKSB7CiAgICAgICAgICAgIGluY3JlbWVudFNlcXVl\nbmNlKCk7CiAgICAgICAgfQogICAgICAgIF9sYXN0TWlsbGlzID0gbmV3VGlt\nZTsKICAgICAgICByZXR1cm4gbmV3VGltZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEdldHMgdGhlIGFwcHJvcHJpYXRlbHkgbW9kaWZpZWQgdGltZXN0YW1l\ncCBmb3IgdGhlIFVVSUQuICBNdXN0IGJlIGNhbGxlZAogICAgICogZnJvbSBh\nIHN5bmNocm9uaXplZCBibG9jay4KICAgICAqCiAgICAgKiBAcmV0dXJuIGxv\nbmcgdGltZXN0YW1wIGluIDEwMG5zIGludGVydmFscyBzaW5jZSB0aGUgR3Jl\nZ29yaWFuIGNoYW5nZQogICAgICogb2Zmc2V0CiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIGxvbmcgZ2V0VVVJRFRpbWUoKSB7CiAgICAgICAgaWYgKF9j\ndXJyZW50TWlsbGlzICE9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKSB7\nCiAgICAgICAgICAgIF9jdXJyZW50TWlsbGlzID0gU3lzdGVtLmN1cnJlbnRU\naW1lTWlsbGlzKCk7CiAgICAgICAgICAgIF9jb3VudGVyID0gMDsgIC8vIHJl\nc2V0IGNvdW50ZXIKICAgICAgICB9CgogICAgICAgIC8vIGNoZWNrIHRvIHNl\nZSBpZiB3ZSBoYXZlIGNyZWF0ZWQgdG9vIG1hbnkgdXVpZCdzIGZvciB0aGlz\nIHRpbWVzdGFtcAogICAgICAgIGlmIChfY291bnRlciArIDEgPj0gTUlMTElf\nTVVMVCkgewogICAgICAgICAgICAvLyBPcmlnaW5hbCBhbGdvcml0aG0gdGhy\nZXcgZXhjZXB0aW9uLiAgU2VlbWVkIGxpa2Ugb3ZlcmtpbGwuCiAgICAgICAg\nICAgIC8vIExldCdzIGp1c3QgaW5jcmVtZW50IHRoZSB0aW1lc3RhbXAgaW5z\ndGVhZCBhbmQgc3RhcnQgb3Zlci4uLgogICAgICAgICAgICBfY3VycmVudE1p\nbGxpcysrOwogICAgICAgICAgICBfY291bnRlciA9IDA7CiAgICAgICAgfQoK\nICAgICAgICAvLyBjYWxjdWxhdGUgdGltZSBhcyBjdXJyZW50IG1pbGxpcyBw\nbHVzIG9mZnNldCB0aW1lcyAxMDAgbnMgdGlja3MKICAgICAgICBsb25nIGN1\ncnJlbnRUaW1lID0gKF9jdXJyZW50TWlsbGlzICsgR1JFR19PRkZTRVQpICog\nTUlMTElfTVVMVDsKCiAgICAgICAgLy8gcmV0dXJuIHRoZSB1dWlkIHRpbWUg\ncGx1cyB0aGUgYXJ0aWZpY2lhbCB0aWNrIGNvdW50ZXIgaW5jcmVtZW50ZWQK\nICAgICAgICByZXR1cm4gY3VycmVudFRpbWUgKyBfY291bnRlcisrOwogICAg\nfQoKICAgIC8qKgogICAgICogSW5jcmVtZW50cyB0aGUgY2xvY2sgc2VxdWVu\nY2UgZm9yIHRoaXMgdXVpZC4gIE11c3QgYmUgY2FsbGVkIGZyb20gYQogICAg\nICogc3luY2hyb25pemVkIGJsb2NrLgogICAgICovCiAgICBwcml2YXRlIHN0\nYXRpYyB2b2lkIGluY3JlbWVudFNlcXVlbmNlKCkgewogICAgICAgIC8vIGlu\nY3JlbWVudCwgYnV0IGlmIGl0J3MgZ3JlYXRlciB0aGFuIGl0cyAxNC1iaXRz\nLCByZXNldCBpdAogICAgICAgIGlmICgrK19zZXEgPiBNQVhfMTRCSVQpIHsK\nICAgICAgICAgICAgX3NlcSA9IChzaG9ydClSQU5ET00ubmV4dEludChNQVhf\nMTRCSVQpOyAgLy8gc2VtaS1yYW5kb20KICAgICAgICB9CiAgICB9CgoKfQo=\n","encoding":"base64"}

