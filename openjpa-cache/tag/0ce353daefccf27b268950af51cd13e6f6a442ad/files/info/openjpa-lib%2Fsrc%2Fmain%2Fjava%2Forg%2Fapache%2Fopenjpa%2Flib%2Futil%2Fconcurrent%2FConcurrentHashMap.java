{"sha":"3068111d7c82956953dd6e52de4a62c2ede9ca52","node_id":"MDQ6QmxvYjIwNjM2NDozMDY4MTExZDdjODI5NTY5NTNkZDZlNTJkZTRhNjJjMmVkZTljYTUy","size":29987,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3068111d7c82956953dd6e52de4a62c2ede9ca52","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5jb25jdXJyZW50OwoKaW1wb3J0IGphdmEuaW8u\nSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0U3RyZWFt\nOwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBq\nYXZhLmlvLlNlcmlhbGl6YWJsZTsKaW1wb3J0IGphdmEudXRpbC5BYnN0cmFj\ndENvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQWJzdHJhY3RNYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuQWJzdHJhY3RTZXQ7CmltcG9ydCBqYXZhLnV0aWwu\nQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0\nIGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTm9TdWNoRWxlbWVu\ndEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5SYW5kb207CmltcG9ydCBq\nYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5TaXplZE1hcDsKCi8qKgogKiBUaGlzIGNsYXNzIGltcGxlbWVudHMg\nYSBIYXNoTWFwIHdoaWNoIGhhcyBsaW1pdGVkIHN5bmNocm9uaXphdGlvbi4K\nICogSW4gcGFydGljdWxhciBtdXRhdG9ycyBhcmUgZ2VuZXJhbGx5IHN5bmNo\ncm9uaXplZCB3aGlsZSBhY2Nlc3NvcnMKICogYXJlIGdlbmVyYWxseSBub3Qu\nIEFkZGl0aW9uYWxseSB0aGUgSXRlcmF0b3JzIHJldHVybmVkIGJ5IHRoaXMK\nICogY2xhc3MgYXJlIG5vdCAiZmFpbC1mYXN0IiwgYnV0IGluc3RlYWQgdHJ5\nIHRvIGNvbnRpbnVlIHRvIGl0ZXJhdGUKICogb3ZlciB0aGUgZGF0YSBzdHJ1\nY3R1cmUgYWZ0ZXIgY2hhbmdlcyBoYXZlIGJlZW4gbWFkZS4KICogVGhlIHN5\nbmNocm9uaXphdGlvbiBzZW1hbnRpY3MgYXJlIGJ1aWx0IHJpZ2h0IGluIHRv\nIHRoZQogKiBpbXBsZW1lbnRhdGlvbiByYXRoZXIgdGhhbiB1c2luZyBhIGRl\nbGVnYXRpbmcgd3JhcHBlciBsaWtlIHRoZQogKiBvdGhlciBjb2xsZWN0aW9u\nIGNsYXNzZXMgZG8gYmVjYXVzZSBpdCB3YXNuJ3QgY2xlYXIgdG8gbWUgdGhh\ndCB0aGUKICogaG93IHRoZSB0d28gc2hvdWxkIGJlIHNlcGVyYXRlZCBvciB0\naGF0IGl0IHdvdWxkIGJlIHVzZWZ1bCB0byBkbwogKiBzby4gVGhpcyBjYW4g\ncHJvYmFibHkgYmUgYSB0b3BpYyBmb3IgZnVydGhlciBkZWJhdGUgaW4gdGhl\nIGZ1dHVyZS4KICogVGhpcyBjbGFzcyBpcyBiYXNlZCBoZWF2aWx5IG9uIHRo\nZSBIYXNoTWFwIGNsYXNzIGluIHRoZSBKYXZhCiAqIGNvbGxlY3Rpb25zIHBh\nY2thZ2UuCiAqLwpwdWJsaWMgY2xhc3MgQ29uY3VycmVudEhhc2hNYXAgZXh0\nZW5kcyBBYnN0cmFjdE1hcAogICAgaW1wbGVtZW50cyBDb25jdXJyZW50TWFw\nLCBTaXplZE1hcCwgQ2xvbmVhYmxlLCBTZXJpYWxpemFibGUgewoKICAgIC8q\nKgogICAgICogVGhlIGRlZmF1bHQgaW5pdGlhbCBjYXBhY2l0eSAtIE1VU1Qg\nYmUgYSBwb3dlciBvZiB0d28uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIGludCBERUZBVUxUX0lOSVRJQUxfQ0FQQUNJVFkgPSAxNjsKCiAg\nICAvKioKICAgICAqIFRoZSBtYXhpbXVtIGNhcGFjaXR5LCB1c2VkIGlmIGEg\naGlnaGVyIHZhbHVlIGlzIGltcGxpY2l0bHkgc3BlY2lmaWVkCiAgICAgKiBi\neSBlaXRoZXIgb2YgdGhlIGNvbnN0cnVjdG9ycyB3aXRoIGFyZ3VtZW50cy4K\nICAgICAqIE1VU1QgYmUgYSBwb3dlciBvZiB0d28gPD0gMTw8MzAuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBNQVhJTVVNX0NBUEFD\nSVRZID0gMSA8PCAzMDsKCiAgICAvKioKICAgICAqIFRoZSBsb2FkIGZhc3Qg\ndXNlZCB3aGVuIG5vbmUgc3BlY2lmaWVkIGluIGNvbnN0cnVjdG9yLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBmbG9hdCBERUZBVUxUX0xP\nQURfRkFDVE9SID0gMC43NWY7CgogICAgLyoqCiAgICAgKiBDYWNoZSBvZiBy\nYW5kb20gbnVtYmVycyB1c2VkIGluICJyYW5kb20iIG1ldGhvZHMsIHNpbmNl\nIGdlbmVyYXRpbmcgdGhlbQogICAgICogaXMgZXhwZW5zaXZlLiBXZSBob3Bl\nIGVhY2ggbWFwIGNoYW5nZXMgZW5vdWdoIGJldHdlZW4gY3ljbGluZyB0aHJv\ndWdoCiAgICAgKiB0aGlzIGxpc3QgdGhhdCB0aGUgb3ZlcmFsbCBlZmZlY3Qg\naXMgcmFuZG9tIGVub3VnaC4KICAgICAqLwogICAgc3RhdGljIGZpbmFsIGRv\ndWJsZVtdIFJBTkRPTVMgPSBuZXcgZG91YmxlWzEwMDBdOwoKICAgIHN0YXRp\nYyB7CiAgICAgICAgUmFuZG9tIHJhbmRvbSA9IG5ldyBSYW5kb20oKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IFJBTkRPTVMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIFJBTkRPTVNbaV0gPSByYW5kb20ubmV4dERvdWJsZSgp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHRhYmxlLCByZXNpemVkIGFz\nIG5lY2Vzc2FyeS4gTGVuZ3RoIE1VU1QgQWx3YXlzIGJlIGEgcG93ZXIgb2Yg\ndHdvLgogICAgICovCiAgICBwcml2YXRlIHRyYW5zaWVudCBFbnRyeVtdIHRh\nYmxlOwoKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBrZXktdmFsdWUg\nbWFwcGluZ3MgY29udGFpbmVkIGluIHRoaXMgaWRlbnRpdHkgaGFzaCBtYXAu\nCiAgICAgKi8KICAgIHByaXZhdGUgdHJhbnNpZW50IGludCBzaXplOwoKICAg\nIC8qKgogICAgICogVGhlIG5leHQgc2l6ZSB2YWx1ZSBhdCB3aGljaCB0byBy\nZXNpemUoY2FwYWNpdHkgKiBsb2FkIGZhY3RvcikuCiAgICAgKgogICAgICog\nQHNlcmlhbAogICAgICovCiAgICBwcml2YXRlIGludCB0aHJlc2hvbGQ7Cgog\nICAgLyoqCiAgICAgKiBUaGUgbG9hZCBmYWN0b3IgZm9yIHRoZSBoYXNoIHRh\nYmxlLgogICAgICoKICAgICAqIEBzZXJpYWwKICAgICAqLwogICAgcHJpdmF0\nZSBmaW5hbCBmbG9hdCBsb2FkRmFjdG9yOwoKICAgIC8qKgogICAgICogU3By\nZWFkICJyYW5kb20iIHJlbW92ZXMgYW5kIGl0ZXJhdGlvbi4KICAgICAqLwog\nICAgcHJpdmF0ZSBpbnQgcmFuZG9tRW50cnkgPSAwOwoKICAgIC8qKgogICAg\nICogTWF4aW11bSBlbnRyaWVzLgogICAgICovCiAgICBwcml2YXRlIGludCBt\nYXhTaXplID0gSW50ZWdlci5NQVhfVkFMVUU7CgogICAgLyoqCiAgICAgKiBD\nb25zdHJ1Y3RzIGFuIGVtcHR5IDx0dD5Db25jdXJyZW50SGFzaE1hcDwvdHQ+\nIHdpdGggdGhlIHNwZWNpZmllZCBpbml0aWFsCiAgICAgKiBjYXBhY2l0eSBh\nbmQgbG9hZCBmYWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIGluaXRpYWxD\nYXBhY2l0eSBUaGUgaW5pdGlhbCBjYXBhY2l0eS4KICAgICAqIEBwYXJhbSBs\nb2FkRmFjdG9yIFRoZSBsb2FkIGZhY3Rvci4KICAgICAqIEB0aHJvd3MgSWxs\nZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHRoZSBpbml0aWFsIGNhcGFjaXR5\nIGlzIG5lZ2F0aXZlCiAgICAgKiBvciB0aGUgbG9hZCBmYWN0b3IgaXMgbm9u\ncG9zaXRpdmUuCiAgICAgKi8KICAgIHB1YmxpYyBDb25jdXJyZW50SGFzaE1h\ncChpbnQgaW5pdGlhbENhcGFjaXR5LCBmbG9hdCBsb2FkRmFjdG9yKSB7CiAg\nICAgICAgaWYgKGluaXRpYWxDYXBhY2l0eSA8IDApIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSWxsZWdhbCBp\nbml0aWFsIGNhcGFjaXR5OiAiICsKICAgICAgICAgICAgICAgIGluaXRpYWxD\nYXBhY2l0eSk7CiAgICAgICAgfQogICAgICAgIGlmIChpbml0aWFsQ2FwYWNp\ndHkgPiBNQVhJTVVNX0NBUEFDSVRZKQogICAgICAgICAgICBpbml0aWFsQ2Fw\nYWNpdHkgPSBNQVhJTVVNX0NBUEFDSVRZOwogICAgICAgIGlmIChsb2FkRmFj\ndG9yIDw9IDAgfHwgbG9hZEZhY3RvciA+IDEpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSWxsZWdhbCBsb2Fk\nIGZhY3RvcjogIiArCiAgICAgICAgICAgICAgICBsb2FkRmFjdG9yKTsKICAg\nICAgICB9CgogICAgICAgIC8vIEZpbmQgYSBwb3dlciBvZiAyID49IGluaXRp\nYWxDYXBhY2l0eQogICAgICAgIGludCBjYXBhY2l0eSA9IDE7CiAgICAgICAg\nd2hpbGUgKGNhcGFjaXR5IDwgaW5pdGlhbENhcGFjaXR5KSBjYXBhY2l0eSA8\nPD0gMTsKCiAgICAgICAgdGhpcy5sb2FkRmFjdG9yID0gbG9hZEZhY3RvcjsK\nICAgICAgICB0aHJlc2hvbGQgPSAoaW50KSAoY2FwYWNpdHkgKiBsb2FkRmFj\ndG9yKTsKICAgICAgICB0YWJsZSA9IG5ldyBFbnRyeVtjYXBhY2l0eV07CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RzIGFuIGVtcHR5IDx0dD5D\nb25jdXJyZW50SGFzaE1hcDwvdHQ+IHdpdGggdGhlIHNwZWNpZmllZCBpbml0\naWFsCiAgICAgKiBjYXBhY2l0eSBhbmQgdGhlIGRlZmF1bHQgbG9hZCBmYWN0\nb3IoMC43NSkuCiAgICAgKgogICAgICogQHBhcmFtIGluaXRpYWxDYXBhY2l0\neSB0aGUgaW5pdGlhbCBjYXBhY2l0eS4KICAgICAqIEB0aHJvd3MgSWxsZWdh\nbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHRoZSBpbml0aWFsIGNhcGFjaXR5IGlz\nIG5lZ2F0aXZlLgogICAgICovCiAgICBwdWJsaWMgQ29uY3VycmVudEhhc2hN\nYXAoaW50IGluaXRpYWxDYXBhY2l0eSkgewogICAgICAgIHRoaXMoaW5pdGlh\nbENhcGFjaXR5LCBERUZBVUxUX0xPQURfRkFDVE9SKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdHMgYW4gZW1wdHkgPHR0PkNvbmN1cnJlbnRI\nYXNoTWFwPC90dD4gd2l0aCB0aGUgZGVmYXVsdCBpbml0aWFsCiAgICAgKiBj\nYXBhY2l0eSgxNikgYW5kIHRoZSBkZWZhdWx0IGxvYWQgZmFjdG9yKDAuNzUp\nLgogICAgICovCiAgICBwdWJsaWMgQ29uY3VycmVudEhhc2hNYXAoKSB7CiAg\nICAgICAgdGhpcyhERUZBVUxUX0lOSVRJQUxfQ0FQQUNJVFksIERFRkFVTFRf\nTE9BRF9GQUNUT1IpOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0\ncyBhIG5ldyA8dHQ+Q29uY3VycmVudEhhc2hNYXA8L3R0PiB3aXRoIHRoZSBz\nYW1lIG1hcHBpbmdzIGFzIHRoZQogICAgICogc3BlY2lmaWVkIDx0dD5NYXA8\nL3R0Pi4gVGhlIDx0dD5Db25jdXJyZW50SGFzaE1hcDwvdHQ+IGlzIGNyZWF0\nZWQgd2l0aAogICAgICogZGVmYXVsdCBsb2FkIGZhY3RvcigwLjc1KSBhbmQg\nYW4gaW5pdGlhbCBjYXBhY2l0eSBzdWZmaWNpZW50IHRvCiAgICAgKiBob2xk\nIHRoZSBtYXBwaW5ncyBpbiB0aGUgc3BlY2lmaWVkIDx0dD5NYXA8L3R0Pi4K\nICAgICAqCiAgICAgKiBAcGFyYW0gbSB0aGUgbWFwIHdob3NlIG1hcHBpbmdz\nIGFyZSB0byBiZSBwbGFjZWQgaW4gdGhpcyBtYXAuCiAgICAgKiBAdGhyb3dz\nIE51bGxQb2ludGVyRXhjZXB0aW9uIGlmIHRoZSBzcGVjaWZpZWQgbWFwIGlz\nIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBDb25jdXJyZW50SGFzaE1hcChN\nYXAgbSkgewogICAgICAgIHRoaXMoTWF0aC5tYXgoKGludCkgKG0uc2l6ZSgp\nIC8gREVGQVVMVF9MT0FEX0ZBQ1RPUikgKyAxLAogICAgICAgICAgICBERUZB\nVUxUX0lOSVRJQUxfQ0FQQUNJVFkpLCBERUZBVUxUX0xPQURfRkFDVE9SKTsK\nICAgICAgICBwdXRBbGwobSk7CiAgICB9CgogICAgLy8gaW50ZXJuYWwgdXRp\nbGl0aWVzCgogICAgLyoqCiAgICAgKiBWYWx1ZSByZXByZXNlbnRpbmcgbnVs\nbCBrZXlzIGluc2lkZSB0YWJsZXMuCiAgICAgKi8KICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIE9iamVjdCBOVUxMX0tFWSA9IG5ldyBPYmplY3QoKTsKCiAg\nICAvKioKICAgICAqIFJldHVybnMgaW50ZXJuYWwgcmVwcmVzZW50YXRpb24g\nZm9yIGtleS4gVXNlIE5VTExfS0VZIGlmIGtleSBpcyBudWxsLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3QgbWFza051bGwoT2JqZWN0IGtl\neSkgewogICAgICAgIHJldHVybiAoa2V5ID09IG51bGwgPyBOVUxMX0tFWSA6\nIGtleSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGtleSByZXBy\nZXNlbnRlZCBieSBzcGVjaWZpZWQgaW50ZXJuYWwgcmVwcmVzZW50YXRpb24u\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCB1bm1hc2tOdWxs\nKE9iamVjdCBrZXkpIHsKICAgICAgICByZXR1cm4gKGtleSA9PSBOVUxMX0tF\nWSA/IG51bGwgOiBrZXkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\ncyBhIGhhc2ggY29kZSBmb3Igbm9uLW51bGwgT2JqZWN0IHguCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIGludCBoYXNoKE9iamVjdCB4KSB7CiAgICAg\nICAgaW50IGggPSB4Lmhhc2hDb2RlKCk7CiAgICAgICAgcmV0dXJuIGggLSAo\naCA8PCA3KTsgLy8gaS5lLiwgLTEyNyAqIGgKICAgIH0KCiAgICAvKioKICAg\nICAqIENoZWNrIGZvciBlcXVhbGl0eSBvZiBub24tbnVsbCByZWZlcmVuY2Ug\neCBhbmQgcG9zc2libHktbnVsbCB5LgogICAgICovCiAgICBwcml2YXRlIHN0\nYXRpYyBib29sZWFuIGVxKE9iamVjdCB4LCBPYmplY3QgeSkgewogICAgICAg\nIHJldHVybiB4ID09IHkgfHwgeC5lcXVhbHMoeSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IGNhcGFjaXR5IG9mIGJhY2tp\nbmcgdGFibGUgaW4gdGhpcyBtYXAuCiAgICAgKgogICAgICogQHJldHVybiB0\naGUgY3VycmVudCBjYXBhY2l0eSBvZiBiYWNraW5nIHRhYmxlIGluIHRoaXMg\nbWFwLgogICAgICovCiAgICBwdWJsaWMgZmluYWwgaW50IGNhcGFjaXR5KCkg\newogICAgICAgIHJldHVybiB0YWJsZS5sZW5ndGg7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIHRoZSBsb2FkIGZhY3RvciBmb3IgdGhpcyBtYXAu\nCiAgICAgKgogICAgICogQHJldHVybiB0aGUgbG9hZCBmYWN0b3IgZm9yIHRo\naXMgbWFwLgogICAgICovCiAgICBwdWJsaWMgZmluYWwgZmxvYXQgbG9hZEZh\nY3RvcigpIHsKICAgICAgICByZXR1cm4gbG9hZEZhY3RvcjsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IGdldE1heFNpemUoKSB7CiAgICAgICAgcmV0dXJuIG1h\neFNpemU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TWF4U2l6ZShpbnQg\nbWF4U2l6ZSkgewogICAgICAgIHRoaXMubWF4U2l6ZSA9IChtYXhTaXplIDwg\nMCkgPyBJbnRlZ2VyLk1BWF9WQUxVRSA6IG1heFNpemU7CiAgICAgICAgaWYg\nKHRoaXMubWF4U2l6ZSAhPSBJbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAgICAg\nICAgcmVtb3ZlT3ZlcmZsb3codGhpcy5tYXhTaXplKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc0Z1bGwoKSB7CiAgICAgICAgcmV0dXJuIG1heFNp\nemUgIT0gSW50ZWdlci5NQVhfVkFMVUUgJiYgc2l6ZSgpID49IG1heFNpemU7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgb3ZlcmZsb3dSZW1vdmVkKE9iamVj\ndCBrZXksIE9iamVjdCB2YWx1ZSkgewogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJucyB0aGUgbnVtYmVyIG9mIGtleS12YWx1ZSBtYXBwaW5ncyBpbiB0\naGlzIG1hcC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBudW1iZXIgb2Yg\na2V5LXZhbHVlIG1hcHBpbmdzIGluIHRoaXMgbWFwLgogICAgICovCiAgICBw\ndWJsaWMgZmluYWwgaW50IHNpemUoKSB7CiAgICAgICAgcmV0dXJuIHNpemU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIDx0dD50cnVlPC90dD4g\naWYgdGhpcyBtYXAgY29udGFpbnMgbm8ga2V5LXZhbHVlIG1hcHBpbmdzLgog\nICAgICoKICAgICAqIEByZXR1cm4gPHR0PnRydWU8L3R0PiBpZiB0aGlzIG1h\ncCBjb250YWlucyBubyBrZXktdmFsdWUgbWFwcGluZ3MuCiAgICAgKi8KICAg\nIHB1YmxpYyBmaW5hbCBib29sZWFuIGlzRW1wdHkoKSB7CiAgICAgICAgcmV0\ndXJuIHNpemUgPT0gMDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMg\ndGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBzcGVjaWZpZWQga2V5IGlzIG1hcHBl\nZCBpbiB0aGlzIGlkZW50aXR5CiAgICAgKiBoYXNoIG1hcCwgb3IgPHR0Pm51\nbGw8L3R0PiBpZiB0aGUgbWFwIGNvbnRhaW5zIG5vIG1hcHBpbmcgZm9yIHRo\naXMga2V5LgogICAgICogQSByZXR1cm4gdmFsdWUgb2YgPHR0Pm51bGw8L3R0\nPiBkb2VzIG5vdCA8aT5uZWNlc3NhcmlseTwvaT4gaW5kaWNhdGUKICAgICAq\nIHRoYXQgdGhlIG1hcCBjb250YWlucyBubyBtYXBwaW5nIGZvciB0aGUga2V5\nOyBpdCBpcyBhbHNvIHBvc3NpYmxlIHRoYXQKICAgICAqIHRoZSBtYXAgZXhw\nbGljaXRseSBtYXBzIHRoZSBrZXkgdG8gPHR0Pm51bGw8L3R0Pi4gVGhlCiAg\nICAgKiA8dHQ+Y29udGFpbnNLZXk8L3R0PiBtZXRob2QgbWF5IGJlIHVzZWQg\ndG8gZGlzdGluZ3Vpc2ggdGhlc2UgdHdvIGNhc2VzLgogICAgICoKICAgICAq\nIEBwYXJhbSBrZXkgdGhlIGtleSB3aG9zZSBhc3NvY2lhdGVkIHZhbHVlIGlz\nIHRvIGJlIHJldHVybmVkLgogICAgICogQHJldHVybiB0aGUgdmFsdWUgdG8g\nd2hpY2ggdGhpcyBtYXAgbWFwcyB0aGUgc3BlY2lmaWVkIGtleSwgb3IKICAg\nICAqIDx0dD5udWxsPC90dD4gaWYgdGhlIG1hcCBjb250YWlucyBubyBtYXBw\naW5nIGZvciB0aGlzIGtleS4KICAgICAqIEBzZWUgI3B1dChPYmplY3QsIE9i\namVjdCkKICAgICAqLwogICAgcHVibGljIE9iamVjdCBnZXQoT2JqZWN0IGtl\neSkgewogICAgICAgIEVudHJ5IGUgPSBnZXRFbnRyeShrZXkpOwogICAgICAg\nIHJldHVybiBlID09IG51bGwgPyBudWxsIDogZS52YWx1ZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybnMgPHR0PnRydWU8L3R0PiBpZiB0aGlzIG1h\ncCBjb250YWlucyBhIG1hcHBpbmcgZm9yIHRoZQogICAgICogc3BlY2lmaWVk\nIGtleS4KICAgICAqCiAgICAgKiBAcGFyYW0ga2V5IFRoZSBrZXkgd2hvc2Ug\ncHJlc2VuY2UgaW4gdGhpcyBtYXAgaXMgdG8gYmUgdGVzdGVkCiAgICAgKiBA\ncmV0dXJuIDx0dD50cnVlPC90dD4gaWYgdGhpcyBtYXAgY29udGFpbnMgYSBt\nYXBwaW5nIGZvciB0aGUgc3BlY2lmaWVkCiAgICAgKiBrZXkuCiAgICAgKi8K\nICAgIHB1YmxpYyBmaW5hbCBib29sZWFuIGNvbnRhaW5zS2V5KE9iamVjdCBr\nZXkpIHsKICAgICAgICByZXR1cm4gZ2V0RW50cnkoa2V5KSAhPSBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgZW50cnkgYXNzb2Np\nYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGluIHRoZQogICAgICogQ29u\nY3VycmVudEhhc2hNYXAuIFJldHVybnMgbnVsbCBpZiB0aGUgQ29uY3VycmVu\ndEhhc2hNYXAgY29udGFpbnMgbm8KICAgICAqIG1hcHBpbmcgZm9yIHRoaXMg\na2V5LgogICAgICovCiAgICBwcm90ZWN0ZWQgRW50cnkgZ2V0RW50cnkoT2Jq\nZWN0IGtleSkgewogICAgICAgIE9iamVjdCBrID0gbWFza051bGwoa2V5KTsK\nICAgICAgICBpbnQgaGFzaCA9IGhhc2goayk7CiAgICAgICAgRW50cnlbXSB0\nYWIgPSB0YWJsZTsKICAgICAgICBmb3IgKEVudHJ5IGUgPSB0YWJbaGFzaCAm\nICh0YWIubGVuZ3RoIC0gMSldOyBlICE9IG51bGw7IGUgPSBlLm5leHQpIHsK\nICAgICAgICAgICAgaWYgKGUuaGFzaCA9PSBoYXNoICYmIGVxKGssIGUua2V5\nKSkgcmV0dXJuIGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogQXNzb2NpYXRlcyB0aGUgc3BlY2lmaWVk\nIHZhbHVlIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgaW4gdGhpcyBtYXAuCiAg\nICAgKiBJZiB0aGUgbWFwIHByZXZpb3VzbHkgY29udGFpbmVkIGEgbWFwcGlu\nZyBmb3IgdGhpcyBrZXksIHRoZSBvbGQKICAgICAqIHZhbHVlIGlzIHJlcGxh\nY2VkLgogICAgICoKICAgICAqIEBwYXJhbSBrZXkga2V5IHdpdGggd2hpY2gg\ndGhlIHNwZWNpZmllZCB2YWx1ZSBpcyB0byBiZSBhc3NvY2lhdGVkLgogICAg\nICogQHBhcmFtIHZhbHVlIHZhbHVlIHRvIGJlIGFzc29jaWF0ZWQgd2l0aCB0\naGUgc3BlY2lmaWVkIGtleS4KICAgICAqIEByZXR1cm4gcHJldmlvdXMgdmFs\ndWUgYXNzb2NpYXRlZCB3aXRoIHNwZWNpZmllZCBrZXksIG9yIDx0dD5udWxs\nPC90dD4KICAgICAqIGlmIHRoZXJlIHdhcyBubyBtYXBwaW5nIGZvciBrZXku\nIEEgPHR0Pm51bGw8L3R0PiByZXR1cm4gY2FuCiAgICAgKiBhbHNvIGluZGlj\nYXRlIHRoYXQgdGhlIENvbmN1cnJlbnRIYXNoTWFwIHByZXZpb3VzbHkgYXNz\nb2NpYXRlZAogICAgICogPHR0Pm51bGw8L3R0PiB3aXRoIHRoZSBzcGVjaWZp\nZWQga2V5LgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IHB1dChPYmplY3Qg\na2V5LCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBPYmplY3QgayA9IG1hc2tO\ndWxsKGtleSk7CiAgICAgICAgaW50IGhhc2ggPSBoYXNoKGspOwogICAgICAg\nIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICBpbnQgaSA9IGhh\nc2ggJiAodGFibGUubGVuZ3RoIC0gMSk7CgogICAgICAgICAgICBmb3IgKEVu\ndHJ5IGUgPSB0YWJsZVtpXTsgZSAhPSBudWxsOyBlID0gZS5uZXh0KSB7CiAg\nICAgICAgICAgICAgICBpZiAoZS5oYXNoID09IGhhc2ggJiYgZXEoaywgZS5r\nZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgT2JqZWN0IG9sZFZhbHVlID0g\nZS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBlLnZhbHVlID0gdmFsdWU7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sZFZhbHVlOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobWF4\nU2l6ZSAhPSBJbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAgICAgICAgICAgIHJl\nbW92ZU92ZXJmbG93KG1heFNpemUgLSAxKTsKICAgICAgICAgICAgdGFibGVb\naV0gPSBjcmVhdGVFbnRyeShoYXNoLCBrLCB2YWx1ZSwgdGFibGVbaV0pOwog\nICAgICAgICAgICBpZiAoc2l6ZSsrID49IHRocmVzaG9sZCkgcmVzaXplKDIg\nKiB0YWJsZS5sZW5ndGgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSBhbnkgZW50cmllcyBl\ncXVhbCB0byBvciBvdmVyIHRoZSBtYXggc2l6ZS4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHJlbW92ZU92ZXJmbG93KGludCBtYXhTaXplKSB7CiAgICAg\nICAgd2hpbGUgKHNpemUgPiBtYXhTaXplKSB7CiAgICAgICAgICAgIE1hcC5F\nbnRyeSBlbnRyeSA9IHJlbW92ZVJhbmRvbSgpOwogICAgICAgICAgICBpZiAo\nZW50cnkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBvdmVyZmxvd1JlbW92ZWQoZW50cnkuZ2V0S2V5KCksIGVudHJ5Lmdl\ndFZhbHVlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0\nIHB1dElmQWJzZW50KE9iamVjdCBrZXksIE9iamVjdCB2YWx1ZSkgewogICAg\nICAgIE9iamVjdCBrID0gbWFza051bGwoa2V5KTsKICAgICAgICBpbnQgaGFz\naCA9IGhhc2goayk7CiAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAg\nICAgICAgICAgIGludCBpID0gaGFzaCAmICh0YWJsZS5sZW5ndGggLSAxKTsK\nCiAgICAgICAgICAgIGZvciAoRW50cnkgZSA9IHRhYmxlW2ldOyBlICE9IG51\nbGw7IGUgPSBlLm5leHQpIHsKICAgICAgICAgICAgICAgIGlmIChlLmhhc2gg\nPT0gaGFzaCAmJiBlcShrLCBlLmtleSkpIHsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gZS52YWx1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgaWYgKG1heFNpemUgIT0gSW50ZWdlci5NQVhf\nVkFMVUUpCiAgICAgICAgICAgICAgICByZW1vdmVPdmVyZmxvdyhtYXhTaXpl\nIC0gMSk7CiAgICAgICAgICAgIHRhYmxlW2ldID0gY3JlYXRlRW50cnkoaGFz\naCwgaywgdmFsdWUsIHRhYmxlW2ldKTsKICAgICAgICAgICAgaWYgKHNpemUr\nKyA+PSB0aHJlc2hvbGQpIHJlc2l6ZSgyICogdGFibGUubGVuZ3RoKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZWhhc2hlcyB0aGUgY29udGVudHMgb2YgdGhpcyBtYXAgaW50byBh\nIG5ldyA8dHQ+Q29uY3VycmVudEhhc2hNYXA8L3R0PgogICAgICogaW5zdGFu\nY2Ugd2l0aCBhIGxhcmdlciBjYXBhY2l0eS4gVGhpcyBtZXRob2QgaXMgY2Fs\nbGVkIGF1dG9tYXRpY2FsbHkgd2hlbgogICAgICogdGhlIG51bWJlciBvZiBr\nZXlzIGluIHRoaXMgbWFwIGV4Y2VlZHMgaXRzIGNhcGFjaXR5IGFuZCBsb2Fk\nIGZhY3Rvci4KICAgICAqCiAgICAgKiBAcGFyYW0gbmV3Q2FwYWNpdHkgdGhl\nIG5ldyBjYXBhY2l0eSwgTVVTVCBiZSBhIHBvd2VyIG9mIHR3by4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIHJlc2l6ZShpbnQgbmV3Q2FwYWNpdHkpIHsK\nICAgICAgICAvLyBhc3NlcnQobmV3Q2FwYWNpdHkgJiAtbmV3Q2FwYWNpdHkp\nID09IG5ld0NhcGFjaXR5OyAvLyBwb3dlciBvZiAyCiAgICAgICAgRW50cnlb\nXSBvbGRUYWJsZSA9IHRhYmxlOwogICAgICAgIGludCBvbGRDYXBhY2l0eSA9\nIG9sZFRhYmxlLmxlbmd0aDsKCiAgICAgICAgLy8gY2hlY2sgaWYgbmVlZGVk\nCiAgICAgICAgaWYgKHNpemUgPCB0aHJlc2hvbGQgfHwgb2xkQ2FwYWNpdHkg\nPiBuZXdDYXBhY2l0eSkgcmV0dXJuOwoKICAgICAgICBFbnRyeVtdIG5ld1Rh\nYmxlID0gbmV3IEVudHJ5W25ld0NhcGFjaXR5XTsKICAgICAgICBpbnQgbWFz\nayA9IG5ld0NhcGFjaXR5IC0gMTsKICAgICAgICBmb3IgKGludCBpID0gb2xk\nQ2FwYWNpdHk7IGktLSA+IDA7KSB7CiAgICAgICAgICAgIGZvciAoRW50cnkg\nZSA9IG9sZFRhYmxlW2ldOyBlICE9IG51bGw7IGUgPSBlLm5leHQpIHsKICAg\nICAgICAgICAgICAgIEVudHJ5IGNsb25lID0gKEVudHJ5KSBlLmNsb25lKCk7\nCiAgICAgICAgICAgICAgICBpbnQgaiA9IGNsb25lLmhhc2ggJiBtYXNrOwog\nICAgICAgICAgICAgICAgY2xvbmUubmV4dCA9IG5ld1RhYmxlW2pdOwogICAg\nICAgICAgICAgICAgbmV3VGFibGVbal0gPSBjbG9uZTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICB0YWJsZSA9IG5ld1RhYmxlOwogICAgICAg\nIHRocmVzaG9sZCA9IChpbnQpIChuZXdDYXBhY2l0eSAqIGxvYWRGYWN0b3Ip\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29waWVzIGFsbCBvZiB0aGUgbWFw\ncGluZ3MgZnJvbSB0aGUgc3BlY2lmaWVkIG1hcCB0byB0aGlzIG1hcAogICAg\nICogVGhlc2UgbWFwcGluZ3Mgd2lsbCByZXBsYWNlIGFueSBtYXBwaW5ncyB0\naGF0CiAgICAgKiB0aGlzIG1hcCBoYWQgZm9yIGFueSBvZiB0aGUga2V5cyBj\ndXJyZW50bHkgaW4gdGhlIHNwZWNpZmllZCBtYXAuCiAgICAgKgogICAgICog\nQHBhcmFtIHQgbWFwcGluZ3MgdG8gYmUgc3RvcmVkIGluIHRoaXMgbWFwLgog\nICAgICogQHRocm93cyBOdWxsUG9pbnRlckV4Y2VwdGlvbiBpZiB0aGUgc3Bl\nY2lmaWVkIG1hcCBpcyBudWxsLgogICAgICovCiAgICBwdWJsaWMgZmluYWwg\nc3luY2hyb25pemVkIHZvaWQgcHV0QWxsKE1hcCB0KSB7CiAgICAgICAgLy8g\nRXhwYW5kIGVub3VnaCB0byBob2xkIHQncyBlbGVtZW50cyB3aXRob3V0IHJl\nc2l6aW5nLgogICAgICAgIGludCBuID0gdC5zaXplKCk7CiAgICAgICAgaWYg\nKG4gPT0gMCkgcmV0dXJuOwogICAgICAgIGlmIChuID49IHRocmVzaG9sZCkg\newogICAgICAgICAgICBuID0gKGludCkgKG4gLyBsb2FkRmFjdG9yICsgMSk7\nCiAgICAgICAgICAgIGlmIChuID4gTUFYSU1VTV9DQVBBQ0lUWSkgbiA9IE1B\nWElNVU1fQ0FQQUNJVFk7CiAgICAgICAgICAgIGludCBjYXBhY2l0eSA9IHRh\nYmxlLmxlbmd0aDsKICAgICAgICAgICAgd2hpbGUgKGNhcGFjaXR5IDwgbikg\nY2FwYWNpdHkgPDw9IDE7CiAgICAgICAgICAgIHJlc2l6ZShjYXBhY2l0eSk7\nCiAgICAgICAgfQoKICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSB0LmVudHJ5\nU2V0KCkuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAg\nIE1hcC5FbnRyeSBlID0gKE1hcC5FbnRyeSkgaS5uZXh0KCk7CiAgICAgICAg\nICAgIHB1dChlLmdldEtleSgpLCBlLmdldFZhbHVlKCkpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZXMgdGhlIG1hcHBpbmcgZm9y\nIHRoaXMga2V5IGZyb20gdGhpcyBtYXAgaWYgcHJlc2VudC4KICAgICAqCiAg\nICAgKiBAcGFyYW0ga2V5IGtleSB3aG9zZSBtYXBwaW5nIGlzIHRvIGJlIHJl\nbW92ZWQgZnJvbSB0aGUgbWFwLgogICAgICogQHJldHVybiBwcmV2aW91cyB2\nYWx1ZSBhc3NvY2lhdGVkIHdpdGggc3BlY2lmaWVkIGtleSwgb3IgPHR0Pm51\nbGw8L3R0PgogICAgICogaWYgdGhlcmUgd2FzIG5vIG1hcHBpbmcgZm9yIGtl\neS4gQSA8dHQ+bnVsbDwvdHQ+IHJldHVybiBjYW4KICAgICAqIGFsc28gaW5k\naWNhdGUgdGhhdCB0aGUgbWFwIHByZXZpb3VzbHkgYXNzb2NpYXRlZCA8dHQ+\nbnVsbDwvdHQ+CiAgICAgKiB3aXRoIHRoZSBzcGVjaWZpZWQga2V5LgogICAg\nICovCiAgICBwdWJsaWMgT2JqZWN0IHJlbW92ZShPYmplY3Qga2V5KSB7CiAg\nICAgICAgRW50cnkgZSA9IHJlbW92ZUVudHJ5Rm9yS2V5KGtleSk7CiAgICAg\nICAgcmV0dXJuIChlID09IG51bGwgPyBlIDogZS52YWx1ZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZW1vdmVzIGFuZCByZXR1cm5zIHRoZSBlbnRyeSBh\nc3NvY2lhdGVkIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgaW4gdGhlCiAgICAg\nKiBDb25jdXJyZW50SGFzaE1hcC4gUmV0dXJucyBudWxsIGlmIHRoZSBDb25j\ndXJyZW50SGFzaE1hcCBjb250YWlucyBubwogICAgICogbWFwcGluZyBmb3Ig\ndGhpcyBrZXkuCiAgICAgKi8KICAgIHByaXZhdGUgRW50cnkgcmVtb3ZlRW50\ncnlGb3JLZXkoT2JqZWN0IGtleSkgewogICAgICAgIE9iamVjdCBrID0gbWFz\na051bGwoa2V5KTsKICAgICAgICBpbnQgaGFzaCA9IGhhc2goayk7CiAgICAg\nICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIGludCBpID0g\naGFzaCAmICh0YWJsZS5sZW5ndGggLSAxKTsKICAgICAgICAgICAgRW50cnkg\nZSA9IHRhYmxlW2ldOwoKICAgICAgICAgICAgaWYgKGUgPT0gbnVsbCkgcmV0\ndXJuIG51bGw7CiAgICAgICAgICAgIGlmIChlLmhhc2ggPT0gaGFzaCAmJiBl\ncShrLCBlLmtleSkpIHsKICAgICAgICAgICAgICAgIHNpemUtLTsKICAgICAg\nICAgICAgICAgIHRhYmxlW2ldID0gZS5uZXh0OwogICAgICAgICAgICAgICAg\ncmV0dXJuIGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEVudHJ5IHBy\nZXYgPSBlOwogICAgICAgICAgICBmb3IgKGUgPSBlLm5leHQ7IGUgIT0gbnVs\nbDsgcHJldiA9IGUsIGUgPSBlLm5leHQpIHsKICAgICAgICAgICAgICAgIGlm\nIChlLmhhc2ggPT0gaGFzaCAmJiBlcShrLCBlLmtleSkpIHsKICAgICAgICAg\nICAgICAgICAgICBzaXplLS07CiAgICAgICAgICAgICAgICAgICAgcHJldi5u\nZXh0ID0gZS5uZXh0OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBlOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogU3BlY2lh\nbCB2ZXJzaW9uIG9mIHJlbW92ZSBmb3IgRW50cnlTZXQuCiAgICAgKi8KICAg\nIHByaXZhdGUgRW50cnkgcmVtb3ZlTWFwcGluZyhPYmplY3QgbykgewogICAg\nICAgIGlmICghKG8gaW5zdGFuY2VvZiBNYXAuRW50cnkpKSByZXR1cm4gbnVs\nbDsKCiAgICAgICAgTWFwLkVudHJ5IGVudHJ5ID0gKE1hcC5FbnRyeSkgbzsK\nICAgICAgICBPYmplY3QgayA9IG1hc2tOdWxsKGVudHJ5LmdldEtleSgpKTsK\nICAgICAgICBpbnQgaGFzaCA9IGhhc2goayk7CiAgICAgICAgc3luY2hyb25p\nemVkICh0aGlzKSB7CiAgICAgICAgICAgIGludCBpID0gaGFzaCAmICh0YWJs\nZS5sZW5ndGggLSAxKTsKICAgICAgICAgICAgRW50cnkgZSA9IHRhYmxlW2ld\nOwoKICAgICAgICAgICAgaWYgKGUgPT0gbnVsbCkgcmV0dXJuIG51bGw7CiAg\nICAgICAgICAgIGlmIChlLmhhc2ggPT0gaGFzaCAmJiBlLmVxdWFscyhlbnRy\neSkpIHsKICAgICAgICAgICAgICAgIHNpemUtLTsKICAgICAgICAgICAgICAg\nIHRhYmxlW2ldID0gZS5uZXh0OwogICAgICAgICAgICAgICAgcmV0dXJuIGU7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEVudHJ5IHByZXYgPSBlOwog\nICAgICAgICAgICBmb3IgKGUgPSBlLm5leHQ7IGUgIT0gbnVsbDsgcHJldiA9\nIGUsIGUgPSBlLm5leHQpIHsKICAgICAgICAgICAgICAgIGlmIChlLmhhc2gg\nPT0gaGFzaCAmJiBlLmVxdWFscyhlbnRyeSkpIHsKICAgICAgICAgICAgICAg\nICAgICBzaXplLS07CiAgICAgICAgICAgICAgICAgICAgcHJldi5uZXh0ID0g\nZS5uZXh0OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBlOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlcyBhbGwg\nbWFwcGluZ3MgZnJvbSB0aGlzIG1hcC4KICAgICAqLwogICAgcHVibGljIHN5\nbmNocm9uaXplZCB2b2lkIGNsZWFyKCkgewogICAgICAgIHRhYmxlID0gbmV3\nIEVudHJ5W3RhYmxlLmxlbmd0aF07CiAgICAgICAgc2l6ZSA9IDA7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gYXJiaXRyYXJ5IGVudHJ5IGlu\nZGV4LgogICAgICovCiAgICBwcml2YXRlIGludCByYW5kb21FbnRyeUluZGV4\nKCkgewogICAgICAgIGlmIChyYW5kb21FbnRyeSA9PSBSQU5ET01TLmxlbmd0\naCkKICAgICAgICAgICAgcmFuZG9tRW50cnkgPSAwOwogICAgICAgIHJldHVy\nbiAoaW50KSAoUkFORE9NU1tyYW5kb21FbnRyeSsrXSAqIHRhYmxlLmxlbmd0\naCk7CiAgICB9CgogICAgcHVibGljIE1hcC5FbnRyeSByZW1vdmVSYW5kb20o\nKSB7CiAgICAgICAgaWYgKHNpemUgPT0gMCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAg\nICAgICBpbnQgcmFuZG9tID0gcmFuZG9tRW50cnlJbmRleCgpOwogICAgICAg\nICAgICBpbnQgaW5kZXggPSBmaW5kRW50cnkocmFuZG9tLCByYW5kb20gJSAy\nID09IDAsIGZhbHNlKTsKICAgICAgICAgICAgaWYgKGluZGV4ID09IC0xKQog\nICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIEVudHJ5\nIHJlbSA9IHRhYmxlW2luZGV4XTsKICAgICAgICAgICAgdGFibGVbaW5kZXhd\nID0gcmVtLm5leHQ7CiAgICAgICAgICAgIHNpemUtLTsKICAgICAgICAgICAg\ncmV0dXJuIHJlbTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBG\naW5kIHRoZSBpbmRleCBvZiB0aGUgZW50cnkgbmVhcmVzdCB0aGUgZ2l2ZW4g\naW5kZXgsIHN0YXJ0aW5nIGluIHRoZQogICAgICogZ2l2ZW4gZGlyZWN0aW9u\nLgogICAgICovCiAgICBwcml2YXRlIGludCBmaW5kRW50cnkoaW50IHN0YXJ0\nLCBib29sZWFuIGZvcndhcmQsIGJvb2xlYW4gc2VhcmNoZWRPdGhlcikgewog\nICAgICAgIGlmIChmb3J3YXJkKSB7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSBzdGFydDsgaSA8IHRhYmxlLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAg\nICAgaWYgKHRhYmxlW2ldICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIGk7CiAgICAgICAgICAgIHJldHVybiAoc2VhcmNoZWRPdGhlciB8\nfCBzdGFydCA9PSAwKSA/IC0xCiAgICAgICAgICAgICAgICA6IGZpbmRFbnRy\neShzdGFydCAtIDEsIGZhbHNlLCB0cnVlKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICBmb3IgKGludCBpID0gc3RhcnQ7IGkgPj0gMDsgaS0tKQog\nICAgICAgICAgICAgICAgaWYgKHRhYmxlW2ldICE9IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgIHJldHVybiAoc2Vh\ncmNoZWRPdGhlciB8fCBzdGFydCA9PSB0YWJsZS5sZW5ndGggLSAxKSA/IC0x\nCiAgICAgICAgICAgICAgICA6IGZpbmRFbnRyeShzdGFydCArIDEsIHRydWUs\nIHRydWUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgSXRlcmF0b3Ig\ncmFuZG9tRW50cnlJdGVyYXRvcigpIHsKICAgICAgICAvLyBwYXNzIGluZGV4\nIHNvIGNhbGN1bGF0ZWQgYmVmb3JlIGl0ZXJhdG9yIHJlZnMgdGFibGUsIGlu\nIGNhc2UgdGFibGUKICAgICAgICAvLyBnZXRzIHJlcGxhY2Ugd2l0aCBhIGxh\ncmdlciBvbmUKICAgICAgICByZXR1cm4gbmV3IEhhc2hJdGVyYXRvcihFTlRS\nSUVTLCByYW5kb21FbnRyeUluZGV4KCkpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyA8dHQ+dHJ1ZTwvdHQ+IGlmIHRoaXMgbWFwIG1hcHMgb25l\nIG9yIG1vcmUga2V5cyB0byB0aGUKICAgICAqIHNwZWNpZmllZCB2YWx1ZS4K\nICAgICAqCiAgICAgKiBAcGFyYW0gdmFsdWUgdmFsdWUgd2hvc2UgcHJlc2Vu\nY2UgaW4gdGhpcyBtYXAgaXMgdG8gYmUgdGVzdGVkLgogICAgICogQHJldHVy\nbiA8dHQ+dHJ1ZTwvdHQ+IGlmIHRoaXMgbWFwIG1hcHMgb25lIG9yIG1vcmUg\na2V5cyB0byB0aGUKICAgICAqIHNwZWNpZmllZCB2YWx1ZS4KICAgICAqLwog\nICAgcHVibGljIGZpbmFsIGJvb2xlYW4gY29udGFpbnNWYWx1ZShPYmplY3Qg\ndmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIGNv\nbnRhaW5zTnVsbFZhbHVlKCk7CgogICAgICAgIEVudHJ5IHRhYltdID0gdGFi\nbGU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0YWIubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgZm9yIChFbnRyeSBlID0gdGFiW2ldOyBlICE9\nIG51bGw7IGUgPSBlLm5leHQpIHsKICAgICAgICAgICAgICAgIGlmICh2YWx1\nZS5lcXVhbHMoZS52YWx1ZSkpIHJldHVybiB0cnVlOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNwZWNpYWwtY2FzZSBjb2RlIGZvciBjb250YWluc1ZhbHVl\nIHdpdGggbnVsbCBhcmd1bWVudAogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gY29udGFpbnNOdWxsVmFsdWUoKSB7CiAgICAgICAgRW50cnkgdGFiW10g\nPSB0YWJsZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHRhYi5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICBmb3IgKEVudHJ5IGUgPSB0YWJbaV07\nIGUgIT0gbnVsbDsgZSA9IGUubmV4dCkgewogICAgICAgICAgICAgICAgaWYg\nKGUudmFsdWUgPT0gbnVsbCkgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJucyBhIHNoYWxsb3cgY29weSBvZiB0aGlzIDx0dD5D\nb25jdXJyZW50SGFzaE1hcDwvdHQ+IGluc3RhbmNlOiB0aGUKICAgICAqIGtl\neXMgYW5kIHZhbHVlcyB0aGVtc2VsdmVzIGFyZSBub3QgY2xvbmVkLgogICAg\nICoKICAgICAqIEByZXR1cm4gYSBzaGFsbG93IGNvcHkgb2YgdGhpcyBtYXAu\nCiAgICAgKi8KICAgIHB1YmxpYyBmaW5hbCBPYmplY3QgY2xvbmUoKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBDb25jdXJyZW50SGFzaE1hcCh0aGlzKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgRW50cnkgY3JlYXRlRW50cnkoaW50IGgsIE9i\namVjdCBrLCBPYmplY3QgdiwgRW50cnkgbikgewogICAgICAgIHJldHVybiBu\nZXcgRW50cnkoaCwgaywgdiwgbik7CiAgICB9CgogICAgcHJvdGVjdGVkIHN0\nYXRpYyBjbGFzcyBFbnRyeSBpbXBsZW1lbnRzIE1hcC5FbnRyeSB7CgogICAg\nICAgIGZpbmFsIE9iamVjdCBrZXk7CiAgICAgICAgT2JqZWN0IHZhbHVlOwog\nICAgICAgIGZpbmFsIGludCBoYXNoOwogICAgICAgIEVudHJ5IG5leHQ7Cgog\nICAgICAgIC8qKgogICAgICAgICAqIENyZWF0ZSBuZXcgZW50cnkuCiAgICAg\nICAgICovCiAgICAgICAgcHJvdGVjdGVkIEVudHJ5KGludCBoLCBPYmplY3Qg\naywgT2JqZWN0IHYsIEVudHJ5IG4pIHsKICAgICAgICAgICAgdmFsdWUgPSB2\nOwogICAgICAgICAgICBuZXh0ID0gbjsKICAgICAgICAgICAga2V5ID0gazsK\nICAgICAgICAgICAgaGFzaCA9IGg7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgT2JqZWN0IGdldEtleSgpIHsKICAgICAgICAgICAgcmV0dXJuIHVubWFz\na051bGwoa2V5KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0VmFsdWUoKSB7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBPYmplY3Qgc2V0VmFsdWUoT2JqZWN0IG5l\nd1ZhbHVlKSB7CiAgICAgICAgICAgIE9iamVjdCBvbGRWYWx1ZSA9IHZhbHVl\nOwogICAgICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlOwogICAgICAgICAgICBy\nZXR1cm4gb2xkVmFsdWU7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBlcXVhbHMoT2JqZWN0IG8pIHsKICAgICAgICAgICAgaWYgKCEobyBp\nbnN0YW5jZW9mIE1hcC5FbnRyeSkpIHJldHVybiBmYWxzZTsKICAgICAgICAg\nICAgTWFwLkVudHJ5IGUgPSAoTWFwLkVudHJ5KSBvOwogICAgICAgICAgICBP\nYmplY3QgazEgPSBnZXRLZXkoKTsKICAgICAgICAgICAgT2JqZWN0IGsyID0g\nZS5nZXRLZXkoKTsKICAgICAgICAgICAgaWYgKGsxID09IGsyIHx8IChrMSAh\nPSBudWxsICYmIGsxLmVxdWFscyhrMikpKSB7CiAgICAgICAgICAgICAgICBP\nYmplY3QgdjEgPSBnZXRWYWx1ZSgpOwogICAgICAgICAgICAgICAgT2JqZWN0\nIHYyID0gZS5nZXRWYWx1ZSgpOwogICAgICAgICAgICAgICAgaWYgKHYxID09\nIHYyIHx8ICh2MSAhPSBudWxsICYmIHYxLmVxdWFscyh2MikpKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAgICAgIHJldHVybiAoa2V5ID09\nIE5VTExfS0VZID8gMCA6IGtleS5oYXNoQ29kZSgpKSBeCiAgICAgICAgICAg\nICAgICAodmFsdWUgPT0gbnVsbCA/IDAgOiB2YWx1ZS5oYXNoQ29kZSgpKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7\nCiAgICAgICAgICAgIHJldHVybiBnZXRLZXkoKSArICI9IiArIGdldFZhbHVl\nKCk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgT2JqZWN0IGNsb25l\nKCkgewogICAgICAgICAgICAvLyBJdCBpcyB0aGUgY2FsbGVycyByZXNwb25z\naWJpbGl0eSB0byBzZXQgdGhlIG5leHQgZmllbGQKICAgICAgICAgICAgLy8g\nY29ycmVjdGx5LgogICAgICAgICAgICByZXR1cm4gbmV3IEVudHJ5KGhhc2gs\nIGtleSwgdmFsdWUsIG51bGwpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBU\neXBlcyBvZiBFbnVtZXJhdGlvbnMvSXRlcmF0aW9ucwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IEtFWVMgPSAwOwogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgaW50IFZBTFVFUyA9IDE7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgRU5UUklFUyA9IDI7CgogICAgLyoqCiAgICAgKiBNYXAgaXRlcmF0\nb3IuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgSGFzaEl0ZXJhdG9yIGlt\ncGxlbWVudHMgSXRlcmF0b3IgewoKICAgICAgICBmaW5hbCBFbnRyeVtdIHRh\nYmxlID0gQ29uY3VycmVudEhhc2hNYXAudGhpcy50YWJsZTsKICAgICAgICBm\naW5hbCBpbnQgdHlwZTsKICAgICAgICBpbnQgc3RhcnRJbmRleDsKICAgICAg\nICBpbnQgc3RvcEluZGV4ID0gMDsKICAgICAgICBpbnQgaW5kZXg7CiAgICAg\nICAgRW50cnkgZW50cnkgPSBudWxsOwogICAgICAgIEVudHJ5IGxhc3RSZXR1\ncm5lZCA9IG51bGw7CgogICAgICAgIEhhc2hJdGVyYXRvcihpbnQgdHlwZSwg\naW50IHN0YXJ0SW5kZXgpIHsKICAgICAgICAgICAgdGhpcy50eXBlID0gdHlw\nZTsKICAgICAgICAgICAgdGhpcy5zdGFydEluZGV4ID0gc3RhcnRJbmRleDsK\nICAgICAgICAgICAgaW5kZXggPSBzdGFydEluZGV4OwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGJvb2xlYW4gaGFzTmV4dCgpIHsKICAgICAgICAgICAg\naWYgKGVudHJ5ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHdoaWxlIChpbmRleCA+\nPSBzdG9wSW5kZXgpIHsKICAgICAgICAgICAgICAgIGlmICgoZW50cnkgPSB0\nYWJsZVtpbmRleC0tXSkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAg\nIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGlmIChzdG9wSW5kZXggPT0gMCkgewogICAgICAgICAg\nICAgICAgaW5kZXggPSB0YWJsZS5sZW5ndGggLSAxOwogICAgICAgICAgICAg\nICAgc3RvcEluZGV4ID0gc3RhcnRJbmRleCArIDE7CiAgICAgICAgICAgICAg\nICB3aGlsZSAoaW5kZXggPj0gc3RvcEluZGV4KSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKChlbnRyeSA9IHRhYmxlW2luZGV4LS1dKSAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgT2JqZWN0IG5leHQoKSB7CiAgICAgICAgICAgIGlmICghaGFz\nTmV4dCgpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vU3VjaEVsZW1l\nbnRFeGNlcHRpb24oKTsKICAgICAgICAgICAgRW50cnkgZSA9IGxhc3RSZXR1\ncm5lZCA9IGVudHJ5OwogICAgICAgICAgICBlbnRyeSA9IGUubmV4dDsKICAg\nICAgICAgICAgcmV0dXJuIHR5cGUgPT0gS0VZUyA/IGUua2V5IDogKHR5cGUg\nPT0gVkFMVUVTID8gZS52YWx1ZSA6IGUpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgcmVtb3ZlKCkgewogICAgICAgICAgICBpZiAobGFzdFJl\ndHVybmVkID09IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxs\nZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIHN5bmNocm9uaXpl\nZCAoQ29uY3VycmVudEhhc2hNYXAudGhpcykgewogICAgICAgICAgICAgICAg\nRW50cnlbXSB0YWIgPSBDb25jdXJyZW50SGFzaE1hcC50aGlzLnRhYmxlOwog\nICAgICAgICAgICAgICAgaW50IGluZGV4ID0gKGxhc3RSZXR1cm5lZC5oYXNo\nICYgMHg3RkZGRkZGRikgJSB0YWIubGVuZ3RoOwoKICAgICAgICAgICAgICAg\nIGZvciAoRW50cnkgZSA9IHRhYltpbmRleF0sIHByZXYgPSBudWxsOyBlICE9\nIG51bGw7CiAgICAgICAgICAgICAgICAgICAgcHJldiA9IGUsIGUgPSBlLm5l\neHQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PSBsYXN0UmV0dXJu\nZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYltpbmRleF0gPSBl\nLm5leHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHByZXYubmV4dCA9IGUubmV4dDsKICAgICAg\nICAgICAgICAgICAgICAgICAgc2l6ZS0tOwogICAgICAgICAgICAgICAgICAg\nICAgICBsYXN0UmV0dXJuZWQgPSBudWxsOwogICAgICAgICAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJdGVy\nYXRlZCBvZmYgdGFibGUgd2hlbiBkb2luZyByZW1vdmUiKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBWaWV3cwoKICAgIHByaXZh\ndGUgdHJhbnNpZW50IFNldCBlbnRyeVNldCA9IG51bGw7CiAgICBwcml2YXRl\nIHRyYW5zaWVudCBTZXQga2V5U2V0ID0gbnVsbDsKICAgIHByaXZhdGUgdHJh\nbnNpZW50IENvbGxlY3Rpb24gdmFsdWVzID0gbnVsbDsKCiAgICAvKioKICAg\nICAqIFJldHVybnMgYSBzZXQgdmlldyBvZiB0aGUga2V5cyBjb250YWluZWQg\naW4gdGhpcyBtYXAuIFRoZSBzZXQgaXMKICAgICAqIGJhY2tlZCBieSB0aGUg\nbWFwLCBzbyBjaGFuZ2VzIHRvIHRoZSBtYXAgYXJlIHJlZmxlY3RlZCBpbiB0\naGUgc2V0LCBhbmQKICAgICAqIHZpY2UtdmVyc2EuIFRoZSBzZXQgc3VwcG9y\ndHMgZWxlbWVudCByZW1vdmFsLCB3aGljaCByZW1vdmVzIHRoZQogICAgICog\nY29ycmVzcG9uZGluZyBtYXBwaW5nIGZyb20gdGhpcyBtYXAsIHZpYSB0aGUg\nPHR0Pkl0ZXJhdG9yLnJlbW92ZTwvdHQ+LAogICAgICogPHR0PlNldC5yZW1v\ndmU8L3R0PiwgPHR0PnJlbW92ZUFsbDwvdHQ+LCA8dHQ+cmV0YWluQWxsPC90\ndD4sIGFuZAogICAgICogPHR0PmNsZWFyPC90dD4gb3BlcmF0aW9ucy4gSXQg\nZG9lcyBub3Qgc3VwcG9ydCB0aGUgPHR0PmFkZDwvdHQ+IG9yCiAgICAgKiA8\ndHQ+YWRkQWxsPC90dD4gb3BlcmF0aW9ucy4KICAgICAqCiAgICAgKiBAcmV0\ndXJuIGEgc2V0IHZpZXcgb2YgdGhlIGtleXMgY29udGFpbmVkIGluIHRoaXMg\nbWFwLgogICAgICovCiAgICBwdWJsaWMgZmluYWwgU2V0IGtleVNldCgpIHsK\nICAgICAgICBTZXQga3MgPSBrZXlTZXQ7CiAgICAgICAgcmV0dXJuIChrcyAh\nPSBudWxsID8ga3MgOiAoa2V5U2V0ID0gbmV3IEtleVNldCgpKSk7CiAgICB9\nCgogICAgcHJpdmF0ZSBmaW5hbCBjbGFzcyBLZXlTZXQgZXh0ZW5kcyBBYnN0\ncmFjdFNldCB7CgogICAgICAgIHB1YmxpYyBJdGVyYXRvciBpdGVyYXRvcigp\nIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBIYXNoSXRlcmF0b3IoS0VZUywg\ndGFibGUubGVuZ3RoIC0gMSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\naW50IHNpemUoKSB7CiAgICAgICAgICAgIHJldHVybiBzaXplOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gY29udGFpbnMoT2JqZWN0IG8p\nIHsKICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5zS2V5KG8pOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlKE9iamVjdCBvKSB7\nCiAgICAgICAgICAgIHJldHVybiBDb25jdXJyZW50SGFzaE1hcC50aGlzLnJl\nbW92ZUVudHJ5Rm9yS2V5KG8pICE9IG51bGw7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICAgICAgQ29uY3VycmVu\ndEhhc2hNYXAudGhpcy5jbGVhcigpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybnMgYSBjb2xsZWN0aW9uIHZpZXcgb2YgdGhlIHZh\nbHVlcyBjb250YWluZWQgaW4gdGhpcyBtYXAuIFRoZQogICAgICogY29sbGVj\ndGlvbiBpcyBiYWNrZWQgYnkgdGhlIG1hcCwgc28gY2hhbmdlcyB0byB0aGUg\nbWFwIGFyZSByZWZsZWN0ZWQgaW4KICAgICAqIHRoZSBjb2xsZWN0aW9uLCBh\nbmQgdmljZS12ZXJzYS4gVGhlIGNvbGxlY3Rpb24gc3VwcG9ydHMgZWxlbWVu\ndAogICAgICogcmVtb3ZhbCwgd2hpY2ggcmVtb3ZlcyB0aGUgY29ycmVzcG9u\nZGluZyBtYXBwaW5nIGZyb20gdGhpcyBtYXAsIHZpYSB0aGUKICAgICAqIDx0\ndD5JdGVyYXRvci5yZW1vdmU8L3R0PiwgPHR0PkNvbGxlY3Rpb24ucmVtb3Zl\nPC90dD4sCiAgICAgKiA8dHQ+cmVtb3ZlQWxsPC90dD4sIDx0dD5yZXRhaW5B\nbGw8L3R0PiwgYW5kIDx0dD5jbGVhcjwvdHQ+IG9wZXJhdGlvbnMuCiAgICAg\nKiBJdCBkb2VzIG5vdCBzdXBwb3J0IHRoZSA8dHQ+YWRkPC90dD4gb3IgPHR0\nPmFkZEFsbDwvdHQ+IG9wZXJhdGlvbnMuCiAgICAgKgogICAgICogQHJldHVy\nbiBhIGNvbGxlY3Rpb24gdmlldyBvZiB0aGUgdmFsdWVzIGNvbnRhaW5lZCBp\nbiB0aGlzIG1hcC4KICAgICAqLwogICAgcHVibGljIGZpbmFsIENvbGxlY3Rp\nb24gdmFsdWVzKCkgewogICAgICAgIENvbGxlY3Rpb24gdnMgPSB2YWx1ZXM7\nCiAgICAgICAgcmV0dXJuICh2cyAhPSBudWxsID8gdnMgOiAodmFsdWVzID0g\nbmV3IFZhbHVlcygpKSk7CiAgICB9CgogICAgcHJpdmF0ZSBmaW5hbCBjbGFz\ncyBWYWx1ZXMgZXh0ZW5kcyBBYnN0cmFjdENvbGxlY3Rpb24gewoKICAgICAg\nICBwdWJsaWMgSXRlcmF0b3IgaXRlcmF0b3IoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBuZXcgSGFzaEl0ZXJhdG9yKFZBTFVFUywgdGFibGUubGVuZ3RoIC0g\nMSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IHNpemUoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzaXplOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gY29udGFpbnMoT2JqZWN0IG8pIHsKICAgICAgICAgICAg\ncmV0dXJuIGNvbnRhaW5zVmFsdWUobyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICAgICAgQ29uY3VycmVudEhh\nc2hNYXAudGhpcy5jbGVhcigpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybnMgYSBjb2xsZWN0aW9uIHZpZXcgb2YgdGhlIG1hcHBp\nbmdzIGNvbnRhaW5lZCBpbiB0aGlzIG1hcC4gRWFjaAogICAgICogZWxlbWVu\ndCBpbiB0aGUgcmV0dXJuZWQgY29sbGVjdGlvbiBpcyBhIDx0dD5NYXAuRW50\ncnk8L3R0Pi4gVGhlCiAgICAgKiBjb2xsZWN0aW9uIGlzIGJhY2tlZCBieSB0\naGUgbWFwLCBzbyBjaGFuZ2VzIHRvIHRoZSBtYXAgYXJlIHJlZmxlY3RlZCBp\nbgogICAgICogdGhlIGNvbGxlY3Rpb24sIGFuZCB2aWNlLXZlcnNhLiBUaGUg\nY29sbGVjdGlvbiBzdXBwb3J0cyBlbGVtZW50CiAgICAgKiByZW1vdmFsLCB3\naGljaCByZW1vdmVzIHRoZSBjb3JyZXNwb25kaW5nIG1hcHBpbmcgZnJvbSB0\naGUgbWFwLCB2aWEgdGhlCiAgICAgKiA8dHQ+SXRlcmF0b3IucmVtb3ZlPC90\ndD4sIDx0dD5Db2xsZWN0aW9uLnJlbW92ZTwvdHQ+LAogICAgICogPHR0PnJl\nbW92ZUFsbDwvdHQ+LCA8dHQ+cmV0YWluQWxsPC90dD4sIGFuZCA8dHQ+Y2xl\nYXI8L3R0PiBvcGVyYXRpb25zLgogICAgICogSXQgZG9lcyBub3Qgc3VwcG9y\ndCB0aGUgPHR0PmFkZDwvdHQ+IG9yIDx0dD5hZGRBbGw8L3R0PiBvcGVyYXRp\nb25zLgogICAgICoKICAgICAqIEByZXR1cm4gYSBjb2xsZWN0aW9uIHZpZXcg\nb2YgdGhlIG1hcHBpbmdzIGNvbnRhaW5lZCBpbiB0aGlzIG1hcC4KICAgICAq\nIEBzZWUgTWFwLkVudHJ5CiAgICAgKi8KICAgIHB1YmxpYyBmaW5hbCBTZXQg\nZW50cnlTZXQoKSB7CiAgICAgICAgU2V0IGVzID0gZW50cnlTZXQ7CiAgICAg\nICAgcmV0dXJuIChlcyAhPSBudWxsID8gZXMgOiAoZW50cnlTZXQgPSBuZXcg\nRW50cnlTZXQoKSkpOwogICAgfQoKICAgIHByaXZhdGUgZmluYWwgY2xhc3Mg\nRW50cnlTZXQgZXh0ZW5kcyBBYnN0cmFjdFNldCB7CgogICAgICAgIHB1Ymxp\nYyBJdGVyYXRvciBpdGVyYXRvcigpIHsKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBIYXNoSXRlcmF0b3IoRU5UUklFUywgdGFibGUubGVuZ3RoIC0gMSk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBjb250YWlucyhPYmpl\nY3QgbykgewogICAgICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgTWFwLkVu\ndHJ5KSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICBNYXAuRW50cnkgZSA9\nIChNYXAuRW50cnkpIG87CiAgICAgICAgICAgIEVudHJ5IGNhbmRpZGF0ZSA9\nIGdldEVudHJ5KGUuZ2V0S2V5KCkpOwogICAgICAgICAgICByZXR1cm4gY2Fu\nZGlkYXRlICE9IG51bGwgJiYgY2FuZGlkYXRlLmVxdWFscyhlKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZShPYmplY3Qgbykg\newogICAgICAgICAgICByZXR1cm4gcmVtb3ZlTWFwcGluZyhvKSAhPSBudWxs\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBzaXplKCkgewogICAg\nICAgICAgICByZXR1cm4gc2l6ZTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyB2b2lkIGNsZWFyKCkgewogICAgICAgICAgICBDb25jdXJyZW50SGFzaE1h\ncC50aGlzLmNsZWFyKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogU2F2ZSB0aGUgc3RhdGUgb2YgdGhlIDx0dD5Db25jdXJyZW50SGFzaE1h\ncDwvdHQ+IGluc3RhbmNlIHRvIGEgc3RyZWFtCiAgICAgKiAoaS5lLiwgc2Vy\naWFsaXplIGl0KS4KICAgICAqCiAgICAgKiBAc2VyaWFsRGF0YSBUaGUgPGk+\nY2FwYWNpdHk8L2k+IG9mIHRoZSBDb25jdXJyZW50SGFzaE1hcCh0aGUgbGVu\nZ3RoIG9mCiAgICAgKiB0aGUgYnVja2V0IGFycmF5KSBpcyBlbWl0dGVkKGlu\ndCksIGZvbGxvd2VkIGJ5IHRoZSA8aT5zaXplPC9pPiBvZiB0aGUKICAgICAq\nIENvbmN1cnJlbnRIYXNoTWFwKHRoZSBudW1iZXIgb2Yga2V5LXZhbHVlIG1h\ncHBpbmdzKSwgZm9sbG93ZWQgYnkgdGhlIGtleQogICAgICogKE9iamVjdCkg\nYW5kIHZhbHVlKE9iamVjdCkgZm9yIGVhY2gga2V5LXZhbHVlIG1hcHBpbmcg\ncmVwcmVzZW50ZWQgYnkgdGhlCiAgICAgKiBDb25jdXJyZW50SGFzaE1hcCBU\naGUga2V5LXZhbHVlIG1hcHBpbmdzIGFyZSBlbWl0dGVkIGluIHRoZSBvcmRl\nciB0aGF0CiAgICAgKiB0aGV5IGFyZSByZXR1cm5lZCBieSA8dHQ+ZW50cnlT\nZXQoKS5pdGVyYXRvcigpPC90dD4uCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCB3cml0ZU9iamVjdChPYmplY3RPdXRwdXRTdHJlYW0gcykgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBXcml0ZSBvdXQgdGhlIHRocmVzaG9s\nZCwgbG9hZGZhY3RvciwgYW5kIGFueSBoaWRkZW4gc3R1ZmYKICAgICAgICBz\nLmRlZmF1bHRXcml0ZU9iamVjdCgpOwoKICAgICAgICAvLyBXcml0ZSBvdXQg\nbnVtYmVyIG9mIGJ1Y2tldHMKICAgICAgICBzLndyaXRlSW50KHRhYmxlLmxl\nbmd0aCk7CgogICAgICAgIC8vIFdyaXRlIG91dCBzaXplKG51bWJlciBvZiBN\nYXBwaW5ncykKICAgICAgICBzLndyaXRlSW50KHNpemUpOwogICAgICAgIHMu\nd3JpdGVJbnQobWF4U2l6ZSk7CgogICAgICAgIC8vIFdyaXRlIG91dCBrZXlz\nIGFuZCB2YWx1ZXMoYWx0ZXJuYXRpbmcpCiAgICAgICAgZm9yIChJdGVyYXRv\nciBpID0gZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgTWFwLkVudHJ5IGUgPSAoTWFwLkVudHJ5KSBpLm5leHQo\nKTsKICAgICAgICAgICAgcy53cml0ZU9iamVjdChlLmdldEtleSgpKTsKICAg\nICAgICAgICAgcy53cml0ZU9iamVjdChlLmdldFZhbHVlKCkpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlh\nbFZlcnNpb25VSUQgPSAtNjQ1MjcwNjU1NjcyNDEyNTc3OEw7CgogICAgLyoq\nCiAgICAgKiBSZWNvbnN0aXR1dGUgdGhlIDx0dD5Db25jdXJyZW50SGFzaE1h\ncDwvdHQ+IGluc3RhbmNlIGZyb20gYSBzdHJlYW0oaS5lLiwKICAgICAqIGRl\nc2VyaWFsaXplIGl0KS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlYWRP\nYmplY3QoT2JqZWN0SW5wdXRTdHJlYW0gcykKICAgICAgICB0aHJvd3MgSU9F\neGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIC8v\nIFJlYWQgaW4gdGhlIHRocmVzaG9sZCwgbG9hZGZhY3RvciwgYW5kIGFueSBo\naWRkZW4gc3R1ZmYKICAgICAgICBzLmRlZmF1bHRSZWFkT2JqZWN0KCk7Cgog\nICAgICAgIC8vIFJlYWQgaW4gbnVtYmVyIG9mIGJ1Y2tldHMgYW5kIGFsbG9j\nYXRlIHRoZSBidWNrZXQgYXJyYXk7CiAgICAgICAgaW50IG51bUJ1Y2tldHMg\nPSBzLnJlYWRJbnQoKTsKICAgICAgICB0YWJsZSA9IG5ldyBFbnRyeVtudW1C\ndWNrZXRzXTsKCiAgICAgICAgLy8gUmVhZCBpbiBzaXplKG51bWJlciBvZiBN\nYXBwaW5ncykKICAgICAgICBpbnQgc2l6ZSA9IHMucmVhZEludCgpOwogICAg\nICAgIAogICAgICAgIC8vIHJlYWQgdGhlIG1heCBzaXplCiAgICAgICAgbWF4\nU2l6ZSA9IHMucmVhZEludCgpOwoKICAgICAgICAvLyBSZWFkIHRoZSBrZXlz\nIGFuZCB2YWx1ZXMsIGFuZCBwdXQgdGhlIG1hcHBpbmdzIGluIHRoZQogICAg\nICAgIC8vIENvbmN1cnJlbnRIYXNoTWFwCiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBzaXplOyBpKyspIHsKICAgICAgICAgICAgT2JqZWN0IGtleSA9\nIHMucmVhZE9iamVjdCgpOwogICAgICAgICAgICBPYmplY3QgdmFsdWUgPSBz\nLnJlYWRPYmplY3QoKTsKICAgICAgICAgICAgcHV0KGtleSwgdmFsdWUpOwog\nICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

