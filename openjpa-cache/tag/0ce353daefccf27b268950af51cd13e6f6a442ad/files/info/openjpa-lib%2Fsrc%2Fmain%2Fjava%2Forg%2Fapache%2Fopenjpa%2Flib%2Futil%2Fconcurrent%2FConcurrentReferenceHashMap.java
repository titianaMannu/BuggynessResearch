{"sha":"0f84723e5e3c265770a446b0f7d7b4c3fe967e68","node_id":"MDQ6QmxvYjIwNjM2NDowZjg0NzIzZTVlM2MyNjU3NzBhNDQ2YjBmN2Q3YjRjM2ZlOTY3ZTY4","size":33517,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0f84723e5e3c265770a446b0f7d7b4c3fe967e68","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5jb25jdXJyZW50OwoKaW1wb3J0IGphdmEubGFu\nZy5yZWYuUmVmZXJlbmNlUXVldWU7CmltcG9ydCBqYXZhLmxhbmcucmVmLlNv\nZnRSZWZlcmVuY2U7CmltcG9ydCBqYXZhLmxhbmcucmVmLldlYWtSZWZlcmVu\nY2U7CmltcG9ydCBqYXZhLnV0aWwuQWJzdHJhY3RNYXA7CmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsK\naW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTm9TdWNo\nRWxlbWVudEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5SYW5kb207Cmlt\ncG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5SZWZlcmVuY2VNYXA7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuU2l6ZWRNYXA7CgovKioKICogVGhpcyBjbGFzcyBp\nbXBsZW1lbnRzIGEgSGFzaE1hcCB3aGljaCBoYXMgbGltaXRlZCBzeW5jaHJv\nbml6YXRpb24KICogYW5kIHJlZmVyZW5jZSBrZXlzIG9yIHZhbHVlcyhidXQg\nbm90IGJvdGgpLiBJbiBwYXJ0aWN1bGFyIG11dGF0b3JzIGFyZQogKiBnZW5l\ncmFsbHkgc3luY2hyb25pemVkIHdoaWxlIGFjY2Vzc29ycyBhcmUgZ2VuZXJh\nbGx5IG5vdC4gQWRkaXRpb25hbGx5IHRoZQogKiBJdGVyYXRvcnMgcmV0dXJu\nZWQgYnkgdGhpcyBjbGFzcyBhcmUgbm90ICJmYWlsLWZhc3QiLCBidXQgaW5z\ndGVhZCB0cnkgdG8KICogY29udGludWUgdG8gaXRlcmF0ZSBvdmVyIHRoZSBk\nYXRhIHN0cnVjdHVyZSBhZnRlciBjaGFuZ2VzIGhhdmUgYmVlbgogKiBtYWRl\nLiBGaW5hbGx5IHB1cmdpbmcgb2YgdGhlIHJlZmVyZW5jZSBxdWV1ZSBpcyBv\nbmx5IGRvbmUgaW5zaWRlIG11dGF0b3JzLgogKiBOdWxsIGtleXMgYXJlIG5v\ndCBzdXBwb3J0ZWQgaWYga2V5cyB1c2UgcmVmZXJlbmNlcy4gTnVsbCB2YWx1\nZXMgYXJlIG5vdAogKiBzdXBwb3J0ZWQgaWYgdmFsdWVzIHVzZSByZWZlcmVu\nY2VzLgogKiBUaGlzIGNsYXNzIGlzIGJhc2VkIGhlYXZpbHkgb24gdGhlIFdl\nYWtIYXNoTWFwIGNsYXNzIGluIHRoZSBKYXZhCiAqIGNvbGxlY3Rpb25zIHBh\nY2thZ2UuCiAqLwpwdWJsaWMgY2xhc3MgQ29uY3VycmVudFJlZmVyZW5jZUhh\nc2hNYXAgZXh0ZW5kcyBBYnN0cmFjdE1hcAogICAgaW1wbGVtZW50cyBDb25j\ndXJyZW50TWFwLCBSZWZlcmVuY2VNYXAsIFNpemVkTWFwLCBDbG9uZWFibGUg\newoKICAgIC8qKgogICAgICogQ2FjaGUgb2YgcmFuZG9tIG51bWJlcnMgdXNl\nZCBpbiAicmFuZG9tIiBtZXRob2RzLCBzaW5jZSBnZW5lcmF0aW5nIHRoZW0K\nICAgICAqIGlzIGV4cGVuc2l2ZS4gV2UgaG9wZSBlYWNoIG1hcCBjaGFuZ2Vz\nIGVub3VnaCBiZXR3ZWVuIGN5Y2xpbmcgdGhyb3VnaAogICAgICogdGhpcyBs\naXN0IHRoYXQgdGhlIG92ZXJhbGwgZWZmZWN0IGlzIHJhbmRvbSBlbm91Z2gu\nCiAgICAgKi8KICAgIHN0YXRpYyBmaW5hbCBkb3VibGVbXSBSQU5ET01TID0g\nbmV3IGRvdWJsZVsxMDAwXTsKCiAgICBzdGF0aWMgewogICAgICAgIFJhbmRv\nbSByYW5kb20gPSBuZXcgUmFuZG9tKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBSQU5ET01TLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBSQU5E\nT01TW2ldID0gcmFuZG9tLm5leHREb3VibGUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBoYXNoIHRhYmxlIGRhdGEuCiAgICAgKi8KICAgIHByaXZh\ndGUgdHJhbnNpZW50IEVudHJ5W10gdGFibGU7CgogICAgLyoqCiAgICAgKiBU\naGUgdG90YWwgbnVtYmVyIG9mIGVudHJpZXMgaW4gdGhlIGhhc2ggdGFibGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgdHJhbnNpZW50IGludCBjb3VudDsKCiAg\nICAvKioKICAgICAqIFJlaGFzaGVzIHRoZSB0YWJsZSB3aGVuIGNvdW50IGV4\nY2VlZHMgdGhpcyB0aHJlc2hvbGQuCiAgICAgKi8KICAgIHByaXZhdGUgaW50\nIHRocmVzaG9sZDsKCiAgICAvKioKICAgICAqIFRoZSBsb2FkIGZhY3RvciBm\nb3IgdGhlIEhhc2hNYXAuCiAgICAgKi8KICAgIHByaXZhdGUgZmxvYXQgbG9h\nZEZhY3RvcjsKCiAgICAvKioKICAgICAqIFRoZSBrZXkgcmVmZXJlbmNlIHR5\ncGUuCiAgICAgKi8KICAgIHByaXZhdGUgaW50IGtleVR5cGU7CgogICAgLyoq\nCiAgICAgKiBUaGUgdmFsdWUgcmVmZXJlbmNlIHR5cGUuCiAgICAgKi8KICAg\nIHByaXZhdGUgaW50IHZhbHVlVHlwZTsKCiAgICAvKioKICAgICAqIFJlZmVy\nZW5jZSBxdWV1ZSBmb3IgY2xlYXJlZCBFbnRyaWVzCiAgICAgKi8KICAgIHBy\naXZhdGUgZmluYWwgUmVmZXJlbmNlUXVldWUgcXVldWUgPSBuZXcgUmVmZXJl\nbmNlUXVldWUoKTsKCiAgICAvKioKICAgICAqIFNwcmVhZCAicmFuZG9tIiBy\nZW1vdmVzIGFuZCBpdGVyYXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgaW50\nIHJhbmRvbUVudHJ5ID0gMDsKCiAgICAvKioKICAgICAqIE1heGltdW0gZW50\ncmllcy4KICAgICAqLwogICAgcHJpdmF0ZSBpbnQgbWF4U2l6ZSA9IEludGVn\nZXIuTUFYX1ZBTFVFOwoKICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gZXEo\nT2JqZWN0IHgsIE9iamVjdCB5KSB7CiAgICAgICAgcmV0dXJuIHggPT0geSB8\nfCAoeCAhPSBudWxsICYmIHguZXF1YWxzKHkpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnN0cnVjdHMgYSBuZXcsIGVtcHR5IEhhc2hNYXAgd2l0aCB0\naGUgc3BlY2lmaWVkIGluaXRpYWwKICAgICAqIGNhcGFjaXR5IGFuZCB0aGUg\nc3BlY2lmaWVkIGxvYWQgZmFjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBr\nZXlUeXBlIHRoZSByZWZlcmVuY2UgdHlwZSBvZiBtYXAga2V5cwogICAgICog\nQHBhcmFtIHZhbHVlVHlwZSB0aGUgcmVmZXJlbmNlIHR5cGUgb2YgbWFwIHZh\nbHVlcwogICAgICogQHBhcmFtIGluaXRpYWxDYXBhY2l0eSB0aGUgaW5pdGlh\nbCBjYXBhY2l0eSBvZiB0aGUgSGFzaE1hcC4KICAgICAqIEBwYXJhbSBsb2Fk\nRmFjdG9yIGEgbnVtYmVyIGJldHdlZW4gMC4wIGFuZCAxLjAuCiAgICAgKiBA\ndGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBuZWl0aGVyIGtl\neXMgbm9yIHZhbHVlcyB1c2UgaGFyZAogICAgICogcmVmZXJlbmNlcywgaWYg\ndGhlIGluaXRpYWwgY2FwYWNpdHkgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRv\nIHplcm8sIG9yIGlmCiAgICAgKiB0aGUgbG9hZCBmYWN0b3IgaXMgbGVzcyB0\naGFuIG9yIGVxdWFsIHRvIHplcm8KICAgICAqLwogICAgcHVibGljIENvbmN1\ncnJlbnRSZWZlcmVuY2VIYXNoTWFwKGludCBrZXlUeXBlLCBpbnQgdmFsdWVU\neXBlLAogICAgICAgIGludCBpbml0aWFsQ2FwYWNpdHksIGZsb2F0IGxvYWRG\nYWN0b3IpIHsKICAgICAgICBpZiAoaW5pdGlhbENhcGFjaXR5IDwgMCkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9u\nKCJJbGxlZ2FsIEluaXRpYWwgQ2FwYWNpdHk6ICIgKwogICAgICAgICAgICAg\nICAgaW5pdGlhbENhcGFjaXR5KTsKICAgICAgICB9CiAgICAgICAgaWYgKChs\nb2FkRmFjdG9yID4gMSkgfHwgKGxvYWRGYWN0b3IgPD0gMCkpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigiSWxs\nZWdhbCBMb2FkIGZhY3RvcjogIiArCiAgICAgICAgICAgICAgICBsb2FkRmFj\ndG9yKTsKICAgICAgICB9CiAgICAgICAgaWYgKGtleVR5cGUgIT0gSEFSRCAm\nJiB2YWx1ZVR5cGUgIT0gSEFSRCkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJFaXRoZXIga2V5cyBvciB2YWx1\nZXMgbXVzdCAiICsKICAgICAgICAgICAgICAgICJ1c2UgaGFyZCByZWZlcmVu\nY2VzLiIpOwogICAgICAgIH0KICAgICAgICB0aGlzLmtleVR5cGUgPSBrZXlU\neXBlOwogICAgICAgIHRoaXMudmFsdWVUeXBlID0gdmFsdWVUeXBlOwogICAg\nICAgIHRoaXMubG9hZEZhY3RvciA9IGxvYWRGYWN0b3I7CiAgICAgICAgdGFi\nbGUgPSBuZXcgRW50cnlbaW5pdGlhbENhcGFjaXR5XTsKICAgICAgICB0aHJl\nc2hvbGQgPSAoaW50KSAoaW5pdGlhbENhcGFjaXR5ICogbG9hZEZhY3Rvcik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RzIGEgbmV3LCBlbXB0\neSBIYXNoTWFwIHdpdGggdGhlIHNwZWNpZmllZCBpbml0aWFsIGNhcGFjaXR5\nCiAgICAgKiBhbmQgZGVmYXVsdCBsb2FkIGZhY3Rvci4KICAgICAqCiAgICAg\nKiBAcGFyYW0ga2V5VHlwZSB0aGUgcmVmZXJlbmNlIHR5cGUgb2YgbWFwIGtl\neXMKICAgICAqIEBwYXJhbSB2YWx1ZVR5cGUgdGhlIHJlZmVyZW5jZSB0eXBl\nIG9mIG1hcCB2YWx1ZXMKICAgICAqIEBwYXJhbSBpbml0aWFsQ2FwYWNpdHkg\ndGhlIGluaXRpYWwgY2FwYWNpdHkgb2YgdGhlIEhhc2hNYXAuCiAgICAgKi8K\nICAgIHB1YmxpYyBDb25jdXJyZW50UmVmZXJlbmNlSGFzaE1hcChpbnQga2V5\nVHlwZSwgaW50IHZhbHVlVHlwZSwKICAgICAgICBpbnQgaW5pdGlhbENhcGFj\naXR5KSB7CiAgICAgICAgdGhpcyhrZXlUeXBlLCB2YWx1ZVR5cGUsIGluaXRp\nYWxDYXBhY2l0eSwgMC43NWYpOwogICAgfQoKICAgIC8qKgogICAgICogQ29u\nc3RydWN0cyBhIG5ldywgZW1wdHkgSGFzaE1hcCB3aXRoIGEgZGVmYXVsdCBj\nYXBhY2l0eSBhbmQgbG9hZCBmYWN0b3IuCiAgICAgKgogICAgICogQHBhcmFt\nIGtleVR5cGUgdGhlIHJlZmVyZW5jZSB0eXBlIG9mIG1hcCBrZXlzCiAgICAg\nKiBAcGFyYW0gdmFsdWVUeXBlIHRoZSByZWZlcmVuY2UgdHlwZSBvZiBtYXAg\ndmFsdWVzCiAgICAgKi8KICAgIHB1YmxpYyBDb25jdXJyZW50UmVmZXJlbmNl\nSGFzaE1hcChpbnQga2V5VHlwZSwgaW50IHZhbHVlVHlwZSkgewogICAgICAg\nIHRoaXMoa2V5VHlwZSwgdmFsdWVUeXBlLCAxMSwgMC43NWYpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29uc3RydWN0cyBhIG5ldyBIYXNoTWFwIHdpdGgg\ndGhlIHNhbWUgbWFwcGluZ3MgYXMgdGhlIGdpdmVuCiAgICAgKiBNYXAuIFRo\nZSBIYXNoTWFwIGlzIGNyZWF0ZWQgd2l0aCBhIGNhcGFjaXR5IG9mIHRocmlj\nZSB0aGUgbnVtYmVyCiAgICAgKiBvZiBlbnRyaWVzIGluIHRoZSBnaXZlbiBN\nYXAgb3IgMTEgKHdoaWNoZXZlciBpcyBncmVhdGVyKSwgYW5kIGEKICAgICAq\nIGRlZmF1bHQgbG9hZCBmYWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIGtl\neVR5cGUgdGhlIHJlZmVyZW5jZSB0eXBlIG9mIG1hcCBrZXlzCiAgICAgKiBA\ncGFyYW0gdmFsdWVUeXBlIHRoZSByZWZlcmVuY2UgdHlwZSBvZiBtYXAgdmFs\ndWVzCiAgICAgKi8KICAgIHB1YmxpYyBDb25jdXJyZW50UmVmZXJlbmNlSGFz\naE1hcChpbnQga2V5VHlwZSwgaW50IHZhbHVlVHlwZSwgTWFwIHQpIHsKICAg\nICAgICB0aGlzKGtleVR5cGUsIHZhbHVlVHlwZSwgTWF0aC5tYXgoMyAqIHQu\nc2l6ZSgpLCAxMSksIDAuNzVmKTsKICAgICAgICBwdXRBbGwodCk7CiAgICB9\nCgogICAgcHVibGljIGludCBnZXRNYXhTaXplKCkgewogICAgICAgIHJldHVy\nbiBtYXhTaXplOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldE1heFNpemUo\naW50IG1heFNpemUpIHsKICAgICAgICB0aGlzLm1heFNpemUgPSAobWF4U2l6\nZSA8IDApID8gSW50ZWdlci5NQVhfVkFMVUUgOiBtYXhTaXplOwogICAgICAg\nIGlmICh0aGlzLm1heFNpemUgIT0gSW50ZWdlci5NQVhfVkFMVUUpCiAgICAg\nICAgICAgIHJlbW92ZU92ZXJmbG93KHRoaXMubWF4U2l6ZSk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gaXNGdWxsKCkgewogICAgICAgIHJldHVybiBt\nYXhTaXplICE9IEludGVnZXIuTUFYX1ZBTFVFICYmIHNpemUoKSA+PSBtYXhT\naXplOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG92ZXJmbG93UmVtb3ZlZChP\nYmplY3Qga2V5LCBPYmplY3QgdmFsdWUpIHsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBrZXktdmFsdWUgbWFwcGluZ3Mg\naW4gdGhpcyBNYXAuIFRoaXMKICAgICAqIHJlc3VsdCBpcyBhIHNuYXBzaG90\nLCBhbmQgbWF5IG5vdCByZWZsZWN0IHVucHJvY2Vzc2VkIGVudHJpZXMKICAg\nICAqIHRoYXQgd2lsbCBiZSByZW1vdmVkIGJlZm9yZSBuZXh0IGF0dGVtcHRl\nZCBhY2Nlc3MgYmVjYXVzZSB0aGV5CiAgICAgKiBhcmUgbm8gbG9uZ2VyIHJl\nZmVyZW5jZWQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsKICAg\nICAgICByZXR1cm4gY291bnQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm5zIHRydWUgaWYgdGhpcyBNYXAgY29udGFpbnMgbm8ga2V5LXZhbHVlIG1h\ncHBpbmdzLiBUaGlzCiAgICAgKiByZXN1bHQgaXMgYSBzbmFwc2hvdCwgYW5k\nIG1heSBub3QgcmVmbGVjdCB1bnByb2Nlc3NlZCBlbnRyaWVzCiAgICAgKiB0\naGF0IHdpbGwgYmUgcmVtb3ZlZCBiZWZvcmUgbmV4dCBhdHRlbXB0ZWQgYWNj\nZXNzIGJlY2F1c2UgdGhleQogICAgICogYXJlIG5vIGxvbmdlciByZWZlcmVu\nY2VkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0VtcHR5KCkgewog\nICAgICAgIHJldHVybiBjb3VudCA9PSAwOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyB0cnVlIGlmIHRoaXMgSGFzaE1hcCBtYXBzIG9uZSBvciBt\nb3JlIGtleXMgdG8gdGhlIHNwZWNpZmllZAogICAgICogdmFsdWUuCiAgICAg\nKgogICAgICogQHBhcmFtIHZhbHVlIHZhbHVlIHdob3NlIHByZXNlbmNlIGlu\nIHRoaXMgTWFwIGlzIHRvIGJlIHRlc3RlZC4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gY29udGFpbnNWYWx1ZShPYmplY3QgdmFsdWUpIHsKICAgICAg\nICBFbnRyeVtdIHRhYiA9IHRhYmxlOwoKICAgICAgICBpZiAodmFsdWUgPT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAodmFsdWVUeXBlICE9IEhBUkQpCiAg\nICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSB0YWIubGVuZ3RoOyBpLS0gPiAwOykKICAgICAgICAgICAgICAg\nIGZvciAoRW50cnkgZSA9IHRhYltpXTsgZSAhPSBudWxsOyBlID0gZS5nZXRO\nZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgaWYgKGUuZ2V0VmFsdWUoKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGludCBpID0gdGFi\nLmxlbmd0aDsgaS0tID4gMDspCiAgICAgICAgICAgICAgICBmb3IgKEVudHJ5\nIGUgPSB0YWJbaV07IGUgIT0gbnVsbDsgZSA9IGUuZ2V0TmV4dCgpKQogICAg\nICAgICAgICAgICAgICAgIGlmIChlcSh2YWx1ZSwgZS5nZXRWYWx1ZSgpKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybnMgdHJ1ZSBpZiB0aGlzIEhhc2hNYXAgY29udGFpbnMgYSBtYXBw\naW5nIGZvciB0aGUgc3BlY2lmaWVkIGtleS4KICAgICAqCiAgICAgKiBAcGFy\nYW0ga2V5IGtleSB3aG9zZSBwcmVzZW5jZSBpbiB0aGlzIE1hcCBpcyB0byBi\nZSB0ZXN0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGNvbnRhaW5z\nS2V5KE9iamVjdCBrZXkpIHsKICAgICAgICBpZiAoa2V5ID09IG51bGwgJiYg\na2V5VHlwZSAhPSBIQVJEKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7Cgog\nICAgICAgIEVudHJ5W10gdGFiID0gdGFibGU7CiAgICAgICAgaW50IGhhc2gg\nPSAoa2V5ID09IG51bGwpID8gMCA6IGtleS5oYXNoQ29kZSgpOwogICAgICAg\nIGludCBpbmRleCA9IChoYXNoICYgMHg3RkZGRkZGRikgJSB0YWIubGVuZ3Ro\nOwogICAgICAgIGZvciAoRW50cnkgZSA9IHRhYltpbmRleF07IGUgIT0gbnVs\nbDsgZSA9IGUuZ2V0TmV4dCgpKQogICAgICAgICAgICBpZiAoZS5nZXRIYXNo\nKCkgPT0gaGFzaCAmJiBlcShrZXksIGUuZ2V0S2V5KCkpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgdmFsdWUgdG8gd2hpY2gg\ndGhpcyBIYXNoTWFwIG1hcHMgdGhlIHNwZWNpZmllZCBrZXkuCiAgICAgKiBS\nZXR1cm5zIG51bGwgaWYgdGhlIEhhc2hNYXAgY29udGFpbnMgbm8gbWFwcGlu\nZyBmb3IgdGhpcyBrZXkuCiAgICAgKgogICAgICogQHBhcmFtIGtleSBrZXkg\nd2hvc2UgYXNzb2NpYXRlZCB2YWx1ZSBpcyB0byBiZSByZXR1cm5lZC4KICAg\nICAqLwogICAgcHVibGljIE9iamVjdCBnZXQoT2JqZWN0IGtleSkgewogICAg\nICAgIGlmIChrZXkgPT0gbnVsbCAmJiBrZXlUeXBlICE9IEhBUkQpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBFbnRyeVtdIHRhYiA9IHRh\nYmxlOwogICAgICAgIGludCBoYXNoID0gKGtleSA9PSBudWxsKSA/IDAgOiBr\nZXkuaGFzaENvZGUoKTsKICAgICAgICBpbnQgaW5kZXggPSAoaGFzaCAmIDB4\nN0ZGRkZGRkYpICUgdGFiLmxlbmd0aDsKICAgICAgICBmb3IgKEVudHJ5IGUg\nPSB0YWJbaW5kZXhdOyBlICE9IG51bGw7IGUgPSBlLmdldE5leHQoKSkKICAg\nICAgICAgICAgaWYgKChlLmdldEhhc2goKSA9PSBoYXNoKSAmJiBlcShrZXks\nIGUuZ2V0S2V5KCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIGUuZ2V0VmFs\ndWUoKTsKCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZWhhc2hlcyB0aGUgY29udGVudHMgb2YgdGhlIEhhc2hNYXAgaW50\nbyBhIEhhc2hNYXAgd2l0aCBhCiAgICAgKiBsYXJnZXIgY2FwYWNpdHkuIFRo\naXMgbWV0aG9kIGlzIGNhbGxlZCBhdXRvbWF0aWNhbGx5IHdoZW4gdGhlCiAg\nICAgKiBudW1iZXIgb2Yga2V5cyBpbiB0aGUgSGFzaE1hcCBleGNlZWRzIHRo\naXMgSGFzaE1hcCdzIGNhcGFjaXR5CiAgICAgKiBhbmQgbG9hZCBmYWN0b3Iu\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCByZWhhc2goKSB7CiAgICAgICAg\naW50IG9sZENhcGFjaXR5ID0gdGFibGUubGVuZ3RoOwogICAgICAgIEVudHJ5\nIG9sZE1hcFtdID0gdGFibGU7CgogICAgICAgIGludCBuZXdDYXBhY2l0eSA9\nIG9sZENhcGFjaXR5ICogMiArIDE7CiAgICAgICAgRW50cnkgbmV3TWFwW10g\nPSBuZXcgRW50cnlbbmV3Q2FwYWNpdHldOwoKICAgICAgICBmb3IgKGludCBp\nID0gb2xkQ2FwYWNpdHk7IGktLSA+IDA7KSB7CiAgICAgICAgICAgIGZvciAo\nRW50cnkgb2xkID0gb2xkTWFwW2ldOyBvbGQgIT0gbnVsbDspIHsKICAgICAg\nICAgICAgICAgIGlmICgoa2V5VHlwZSAhPSBIQVJEICYmIG9sZC5nZXRLZXko\nKSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHx8IHZhbHVlVHlwZSAh\nPSBIQVJEICYmIG9sZC5nZXRWYWx1ZSgpID09IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICBFbnRyeSBlID0gb2xkOwogICAgICAgICAgICAgICAgICAg\nIG9sZCA9IG9sZC5nZXROZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgZS5z\nZXROZXh0KG51bGwpOwogICAgICAgICAgICAgICAgICAgIGNvdW50LS07CiAg\nICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIEVu\ndHJ5IGUgPSAoRW50cnkpIG9sZC5jbG9uZShxdWV1ZSk7CiAgICAgICAgICAg\nICAgICAgICAgb2xkID0gb2xkLmdldE5leHQoKTsKCiAgICAgICAgICAgICAg\nICAgICAgaW50IGluZGV4ID0gKGUuZ2V0SGFzaCgpICYgMHg3RkZGRkZGRikg\nJSBuZXdDYXBhY2l0eTsKICAgICAgICAgICAgICAgICAgICBlLnNldE5leHQo\nbmV3TWFwW2luZGV4XSk7CiAgICAgICAgICAgICAgICAgICAgbmV3TWFwW2lu\nZGV4XSA9IGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIHRocmVzaG9sZCA9IChpbnQpIChuZXdDYXBhY2l0\neSAqIGxvYWRGYWN0b3IpOwogICAgICAgIHRhYmxlID0gbmV3TWFwOwogICAg\nfQoKICAgIC8qKgogICAgICogQXNzb2NpYXRlcyB0aGUgc3BlY2lmaWVkIHZh\nbHVlIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgaW4gdGhpcyBIYXNoTWFwLgog\nICAgICogSWYgdGhlIEhhc2hNYXAgcHJldmlvdXNseSBjb250YWluZWQgYSBt\nYXBwaW5nIGZvciB0aGlzIGtleSwgdGhlIG9sZAogICAgICogdmFsdWUgaXMg\ncmVwbGFjZWQuCiAgICAgKgogICAgICogQHBhcmFtIGtleSBrZXkgd2l0aCB3\naGljaCB0aGUgc3BlY2lmaWVkIHZhbHVlIGlzIHRvIGJlIGFzc29jaWF0ZWQu\nCiAgICAgKiBAcGFyYW0gdmFsdWUgdmFsdWUgdG8gYmUgYXNzb2NpYXRlZCB3\naXRoIHRoZSBzcGVjaWZpZWQga2V5LgogICAgICogQHJldHVybiBwcmV2aW91\ncyB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggc3BlY2lmaWVkIGtleSwgb3IgbnVs\nbCBpZiB0aGVyZQogICAgICogd2FzIG5vIG1hcHBpbmcgZm9yIGtleS4gQSBu\ndWxsIHJldHVybiBjYW4gYWxzbyBpbmRpY2F0ZSB0aGF0CiAgICAgKiB0aGUg\nSGFzaE1hcCBwcmV2aW91c2x5IGFzc29jaWF0ZWQgbnVsbCB3aXRoIHRoZSBz\ncGVjaWZpZWQga2V5LgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IHB1dChP\nYmplY3Qga2V5LCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBpZiAoKGtleSA9\nPSBudWxsICYmIGtleVR5cGUgIT0gSEFSRCkKICAgICAgICAgICAgfHwgKHZh\nbHVlID09IG51bGwgJiYgdmFsdWVUeXBlICE9IEhBUkQpKQogICAgICAgICAg\nICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJOdWxsIHJl\nZmVyZW5jZXMgbm90IHN1cHBvcnRlZCIpOwoKICAgICAgICBpbnQgaGFzaCA9\nIChrZXkgPT0gbnVsbCkgPyAwIDoga2V5Lmhhc2hDb2RlKCk7CiAgICAgICAg\nc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIGV4cHVuZ2VTdGFs\nZUVudHJpZXMoKTsKCiAgICAgICAgICAgIEVudHJ5W10gdGFiID0gdGFibGU7\nCiAgICAgICAgICAgIGludCBpbmRleCA9IDA7CgogICAgICAgICAgICBpbmRl\neCA9IChoYXNoICYgMHg3RkZGRkZGRikgJSB0YWIubGVuZ3RoOwogICAgICAg\nICAgICBmb3IgKEVudHJ5IGUgPSB0YWJbaW5kZXhdLCBwcmV2ID0gbnVsbDsg\nZSAhPSBudWxsOyBwcmV2ID0gZSwKICAgICAgICAgICAgICAgIGUgPSBlLmdl\ndE5leHQoKSkgewogICAgICAgICAgICAgICAgaWYgKChlLmdldEhhc2goKSA9\nPSBoYXNoKSAmJiBlcShrZXksIGUuZ2V0S2V5KCkpKSB7CiAgICAgICAgICAg\nICAgICAgICAgT2JqZWN0IG9sZCA9IGUuZ2V0VmFsdWUoKTsKICAgICAgICAg\nICAgICAgICAgICBpZiAodmFsdWVUeXBlID09IEhBUkQpCiAgICAgICAgICAg\nICAgICAgICAgICAgIGUuc2V0VmFsdWUodmFsdWUpOwogICAgICAgICAgICAg\nICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBlID0gbmV3\nRW50cnkoaGFzaCwgZS5nZXRLZXkoKSwgdmFsdWUsIGUuZ2V0TmV4dCgpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHRhYltpbmRleF0gPSBlOwogICAg\nICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBwcmV2LnNldE5leHQoZSk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBvbGQ7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChjb3VudCA+\nPSB0aHJlc2hvbGQpIHsKICAgICAgICAgICAgICAgIC8vIFJlaGFzaCB0aGUg\ndGFibGUgaWYgdGhlIHRocmVzaG9sZCBpcyBleGNlZWRlZAogICAgICAgICAg\nICAgICAgcmVoYXNoKCk7CgogICAgICAgICAgICAgICAgdGFiID0gdGFibGU7\nCiAgICAgICAgICAgICAgICBpbmRleCA9IChoYXNoICYgMHg3RkZGRkZGRikg\nJSB0YWIubGVuZ3RoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAo\nbWF4U2l6ZSAhPSBJbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAgICAgICAgICAg\nIHJlbW92ZU92ZXJmbG93KG1heFNpemUgLSAxKTsKICAgICAgICAgICAgdGFi\nW2luZGV4XSA9IG5ld0VudHJ5KGhhc2gsIGtleSwgdmFsdWUsIHRhYltpbmRl\neF0pOwogICAgICAgICAgICBjb3VudCsrOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBu\nZXcgZW50cnkuCiAgICAgKi8KICAgIHByaXZhdGUgRW50cnkgbmV3RW50cnko\naW50IGhhc2gsIE9iamVjdCBrZXksIE9iamVjdCB2YWx1ZSwgRW50cnkgbmV4\ndCkgewogICAgICAgIGludCByZWZUeXBlID0gKGtleVR5cGUgIT0gSEFSRCkg\nPyBrZXlUeXBlIDogdmFsdWVUeXBlOwogICAgICAgIHN3aXRjaCAocmVmVHlw\nZSkgewogICAgICAgICAgICBjYXNlIFdFQUs6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IFdlYWtFbnRyeShoYXNoLCBrZXksIHZhbHVlLCByZWZUeXBl\nID09IGtleVR5cGUsIG5leHQsCiAgICAgICAgICAgICAgICAgICAgcXVldWUp\nOwogICAgICAgICAgICBjYXNlIFNPRlQ6CiAgICAgICAgICAgICAgICByZXR1\ncm4gbmV3IFNvZnRFbnRyeShoYXNoLCBrZXksIHZhbHVlLCByZWZUeXBlID09\nIGtleVR5cGUsIG5leHQsCiAgICAgICAgICAgICAgICAgICAgcXVldWUpOwog\nICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIG5l\ndyBIYXJkRW50cnkoaGFzaCwga2V5LCB2YWx1ZSwgbmV4dCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIGFueSBlbnRyaWVzIGVx\ndWFsIHRvIG9yIG92ZXIgdGhlIG1heCBzaXplLgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgcmVtb3ZlT3ZlcmZsb3coaW50IG1heFNpemUpIHsKICAgICAg\nICB3aGlsZSAoY291bnQgPiBtYXhTaXplKSB7CiAgICAgICAgICAgIE1hcC5F\nbnRyeSBlbnRyeSA9IHJlbW92ZVJhbmRvbSgpOwogICAgICAgICAgICBpZiAo\nZW50cnkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBvdmVyZmxvd1JlbW92ZWQoZW50cnkuZ2V0S2V5KCksIGVudHJ5Lmdl\ndFZhbHVlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJl\nbW92ZXMgdGhlIG1hcHBpbmcgZm9yIHRoaXMga2V5IGZyb20gdGhpcyBIYXNo\nTWFwIGlmIHByZXNlbnQuCiAgICAgKgogICAgICogQHBhcmFtIGtleSBrZXkg\nd2hvc2UgbWFwcGluZyBpcyB0byBiZSByZW1vdmVkIGZyb20gdGhlIE1hcC4K\nICAgICAqIEByZXR1cm4gcHJldmlvdXMgdmFsdWUgYXNzb2NpYXRlZCB3aXRo\nIHNwZWNpZmllZCBrZXksIG9yIG51bGwgaWYgdGhlcmUKICAgICAqIHdhcyBu\nbyBtYXBwaW5nIGZvciBrZXkuIEEgbnVsbCByZXR1cm4gY2FuIGFsc28gaW5k\naWNhdGUgdGhhdAogICAgICogdGhlIEhhc2hNYXAgcHJldmlvdXNseSBhc3Nv\nY2lhdGVkIG51bGwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS4KICAgICAqLwog\nICAgcHVibGljIE9iamVjdCByZW1vdmUoT2JqZWN0IGtleSkgewogICAgICAg\nIGlmIChrZXkgPT0gbnVsbCAmJiBrZXlUeXBlICE9IEhBUkQpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwoKICAgICAgICBpbnQgaGFzaCA9IChrZXkgPT0g\nbnVsbCkgPyAwIDoga2V5Lmhhc2hDb2RlKCk7CiAgICAgICAgc3luY2hyb25p\nemVkICh0aGlzKSB7CiAgICAgICAgICAgIGV4cHVuZ2VTdGFsZUVudHJpZXMo\nKTsKCiAgICAgICAgICAgIEVudHJ5W10gdGFiID0gdGFibGU7CgogICAgICAg\nICAgICBpbnQgaW5kZXggPSAoaGFzaCAmIDB4N0ZGRkZGRkYpICUgdGFiLmxl\nbmd0aDsKICAgICAgICAgICAgZm9yIChFbnRyeSBlID0gdGFiW2luZGV4XSwg\ncHJldiA9IG51bGw7IGUgIT0gbnVsbDsKICAgICAgICAgICAgICAgIHByZXYg\nPSBlLCBlID0gZS5nZXROZXh0KCkpIHsKICAgICAgICAgICAgICAgIGlmICgo\nZS5nZXRIYXNoKCkgPT0gaGFzaCkgJiYgZXEoa2V5LCBlLmdldEtleSgpKSkg\newogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2ICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgICAgIHByZXYuc2V0TmV4dChlLmdldE5leHQoKSk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBwdXQgdGhl\nIGJ1Y2tldCBhZnRlciB1cwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgICAgICAgICAgdGFiW2luZGV4XSA9IGUuZ2V0TmV4dCgp\nOwoKICAgICAgICAgICAgICAgICAgICBjb3VudC0tOwogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBlLmdldFZhbHVlKCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlRXhwaXJlZCgpIHsKICAg\nICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAgZXhwdW5n\nZVN0YWxlRW50cmllcygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBrZXlFeHBpcmVkKE9iamVjdCB2YWx1ZSkgewogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHZhbHVlRXhwaXJlZChPYmplY3Qga2V5KSB7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gYXJiaXRyYXJ5IGVudHJ5IGluZGV4\nLgogICAgICovCiAgICBwcml2YXRlIGludCByYW5kb21FbnRyeUluZGV4KCkg\newogICAgICAgIGlmIChyYW5kb21FbnRyeSA9PSBSQU5ET01TLmxlbmd0aCkK\nICAgICAgICAgICAgcmFuZG9tRW50cnkgPSAwOwogICAgICAgIHJldHVybiAo\naW50KSAoUkFORE9NU1tyYW5kb21FbnRyeSsrXSAqIHRhYmxlLmxlbmd0aCk7\nCiAgICB9CgogICAgcHVibGljIE1hcC5FbnRyeSByZW1vdmVSYW5kb20oKSB7\nCiAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgIGV4\ncHVuZ2VTdGFsZUVudHJpZXMoKTsKICAgICAgICAgICAgaWYgKGNvdW50ID09\nIDApCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgICAg\nIGludCByYW5kb20gPSByYW5kb21FbnRyeUluZGV4KCk7CiAgICAgICAgICAg\nIGludCBpbmRleCA9IGZpbmRFbnRyeShyYW5kb20sIHJhbmRvbSAlIDIgPT0g\nMCwgZmFsc2UpOwogICAgICAgICAgICBpZiAoaW5kZXggPT0gLTEpCiAgICAg\nICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgRW50cnkgcmVt\nID0gdGFibGVbaW5kZXhdOwogICAgICAgICAgICB0YWJsZVtpbmRleF0gPSBy\nZW0uZ2V0TmV4dCgpOwogICAgICAgICAgICBjb3VudC0tOwogICAgICAgICAg\nICByZXR1cm4gcmVtOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIEZpbmQgdGhlIGluZGV4IG9mIHRoZSBlbnRyeSBuZWFyZXN0IHRoZSBnaXZl\nbiBpbmRleCwgc3RhcnRpbmcgaW4gdGhlCiAgICAgKiBnaXZlbiBkaXJlY3Rp\nb24uCiAgICAgKi8KICAgIHByaXZhdGUgaW50IGZpbmRFbnRyeShpbnQgc3Rh\ncnQsIGJvb2xlYW4gZm9yd2FyZCwgYm9vbGVhbiBzZWFyY2hlZE90aGVyKSB7\nCiAgICAgICAgaWYgKGZvcndhcmQpIHsKICAgICAgICAgICAgZm9yIChpbnQg\naSA9IHN0YXJ0OyBpIDwgdGFibGUubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nICAgICBpZiAodGFibGVbaV0gIT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gaTsKICAgICAgICAgICAgcmV0dXJuIChzZWFyY2hlZE90aGVy\nIHx8IHN0YXJ0ID09IDApID8gLTEKICAgICAgICAgICAgICAgIDogZmluZEVu\ndHJ5KHN0YXJ0IC0gMSwgZmFsc2UsIHRydWUpOwogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSBzdGFydDsgaSA+PSAwOyBpLS0p\nCiAgICAgICAgICAgICAgICBpZiAodGFibGVbaV0gIT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICAgICAgcmV0dXJuIChz\nZWFyY2hlZE90aGVyIHx8IHN0YXJ0ID09IHRhYmxlLmxlbmd0aCAtIDEpID8g\nLTEKICAgICAgICAgICAgICAgIDogZmluZEVudHJ5KHN0YXJ0ICsgMSwgdHJ1\nZSwgdHJ1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBJdGVyYXRv\nciByYW5kb21FbnRyeUl0ZXJhdG9yKCkgewogICAgICAgIC8vIHBhc3MgaW5k\nZXggc28gY2FsY3VsYXRlZCBiZWZvcmUgaXRlcmF0b3IgcmVmcyB0YWJsZSwg\naW4gY2FzZSB0YWJsZQogICAgICAgIC8vIGdldHMgcmVwbGFjZSB3aXRoIGEg\nbGFyZ2VyIG9uZQogICAgICAgIHJldHVybiBuZXcgSGFzaEl0ZXJhdG9yKEVO\nVFJJRVMsIHJhbmRvbUVudHJ5SW5kZXgoKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb3BpZXMgYWxsIG9mIHRoZSBtYXBwaW5ncyBmcm9tIHRoZSBzcGVj\naWZpZWQgTWFwIHRvIHRoaXMgSGFzaE1hcAogICAgICogVGhlc2UgbWFwcGlu\nZ3Mgd2lsbCByZXBsYWNlIGFueSBtYXBwaW5ncyB0aGF0IHRoaXMgSGFzaE1h\ncCBoYWQgZm9yIGFueQogICAgICogb2YgdGhlIGtleXMgY3VycmVudGx5IGlu\nIHRoZSBzcGVjaWZpZWQgTWFwLgogICAgICoKICAgICAqIEBwYXJhbSB0IE1h\ncHBpbmdzIHRvIGJlIHN0b3JlZCBpbiB0aGlzIE1hcC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgcHV0QWxsKE1hcCB0KSB7CiAgICAgICAgSXRlcmF0b3Ig\naSA9IHQuZW50cnlTZXQoKS5pdGVyYXRvcigpOwogICAgICAgIHdoaWxlIChp\nLmhhc05leHQoKSkgewogICAgICAgICAgICBNYXAuRW50cnkgZSA9IChNYXAu\nRW50cnkpIGkubmV4dCgpOwogICAgICAgICAgICBwdXQoZS5nZXRLZXkoKSwg\nZS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZW1vdmVzIGFsbCBtYXBwaW5ncyBmcm9tIHRoaXMgSGFzaE1hcC4KICAg\nICAqLwogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIGNsZWFyKCkgewog\nICAgICAgIC8vIGNsZWFyIG91dCByZWYgcXVldWUuIFdlIGRvbid0IG5lZWQg\ndG8gZXhwdW5nZSBlbnRyaWVzCiAgICAgICAgLy8gc2luY2UgdGFibGUgaXMg\nZ2V0dGluZyBjbGVhcmVkLgogICAgICAgIHdoaWxlIChxdWV1ZS5wb2xsKCkg\nIT0gbnVsbCkKICAgICAgICAgICAgOwogICAgICAgIHRhYmxlID0gbmV3IEVu\ndHJ5W3RhYmxlLmxlbmd0aF07CiAgICAgICAgY291bnQgPSAwOwogICAgICAg\nIC8vIEFsbG9jYXRpb24gb2YgYXJyYXkgbWF5IGhhdmUgY2F1c2VkIEdDLCB3\naGljaCBtYXkgaGF2ZSBjYXVzZWQKICAgICAgICAvLyBhZGRpdGlvbmFsIGVu\ndHJpZXMgdG8gZ28gc3RhbGUuICAgIFJlbW92aW5nIHRoZXNlIGVudHJpZXMg\nZnJvbQogICAgICAgIC8vIHRoZSByZWZlcmVuY2UgcXVldWUgd2lsbCBtYWtl\nIHRoZW0gZWxpZ2libGUgZm9yIHJlY2xhbWF0aW9uLgogICAgICAgIHdoaWxl\nIChxdWV1ZS5wb2xsKCkgIT0gbnVsbCkKICAgICAgICAgICAgOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJucyBhIHNoYWxsb3cgY29weSBvZiB0aGlz\nIEhhc2hNYXAuIFRoZSBrZXlzIGFuZCB2YWx1ZXMKICAgICAqIHRoZW1zZWx2\nZXMgYXJlIG5vdCBjbG9uZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzeW5jaHJv\nbml6ZWQgT2JqZWN0IGNsb25lKCkgewogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGV4cHVuZ2VTdGFsZUVudHJpZXMoKTsKCiAgICAgICAgICAgIENvbmN1\ncnJlbnRSZWZlcmVuY2VIYXNoTWFwIHQgPSAoQ29uY3VycmVudFJlZmVyZW5j\nZUhhc2hNYXApCiAgICAgICAgICAgICAgICBzdXBlci5jbG9uZSgpOwogICAg\nICAgICAgICB0LnRhYmxlID0gbmV3IEVudHJ5W3RhYmxlLmxlbmd0aF07CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSB0YWJsZS5sZW5ndGg7IGktLSA+IDA7\nKSB7CiAgICAgICAgICAgICAgICBFbnRyeSBlID0gdGFibGVbaV07CiAgICAg\nICAgICAgICAgICBpZiAoZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgdC50YWJsZVtpXSA9IChFbnRyeSkgZS5jbG9uZSh0LnF1ZXVlKTsKICAg\nICAgICAgICAgICAgICAgICBlID0gZS5nZXROZXh0KCk7CiAgICAgICAgICAg\nICAgICAgICAgZm9yIChFbnRyeSBrID0gdC50YWJsZVtpXTsgZSAhPSBudWxs\nOyBlID0gZS5nZXROZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nay5zZXROZXh0KChFbnRyeSkgZS5jbG9uZSh0LnF1ZXVlKSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGsgPSBrLmdldE5leHQoKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgdC5rZXlTZXQgPSBudWxsOwogICAgICAgICAgICB0LmVudHJ5\nU2V0ID0gbnVsbDsKICAgICAgICAgICAgdC52YWx1ZXMgPSBudWxsOwogICAg\nICAgICAgICByZXR1cm4gdDsKICAgICAgICB9IGNhdGNoIChDbG9uZU5vdFN1\ncHBvcnRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIHRoaXMgc2hv\ndWxkbid0IGhhcHBlbiwgc2luY2Ugd2UgYXJlIENsb25lYWJsZQogICAgICAg\nICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFcnJvcigpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvLyBWaWV3cwoKICAgIHByaXZhdGUgdHJhbnNpZW50IFNldCBr\nZXlTZXQgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgU2V0IGVudHJ5\nU2V0ID0gbnVsbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb24g\ndmFsdWVzID0gbnVsbDsKCiAgICAvKioKICAgICAqIFJldHVybnMgYSBTZXQg\ndmlldyBvZiB0aGUga2V5cyBjb250YWluZWQgaW4gdGhpcyBIYXNoTWFwLiBU\naGUgU2V0IGlzCiAgICAgKiBiYWNrZWQgYnkgdGhlIEhhc2hNYXAsIHNvIGNo\nYW5nZXMgdG8gdGhlIEhhc2hNYXAgYXJlIHJlZmxlY3RlZCBpbiB0aGUKICAg\nICAqIFNldCwgYW5kIHZpY2UtdmVyc2EuIFRoZSBTZXQgc3VwcG9ydHMgZWxl\nbWVudCByZW1vdmFsLCB3aGljaCByZW1vdmVzCiAgICAgKiB0aGUgY29ycmVz\ncG9uZGluZyBtYXBwaW5nIGZyb20gdGhlIEhhc2hNYXAsIHZpYSB0aGUgSXRl\ncmF0b3IucmVtb3ZlLAogICAgICogU2V0LnJlbW92ZSwgcmVtb3ZlQWxsIHJl\ndGFpbkFsbCwgYW5kIGNsZWFyIG9wZXJhdGlvbnMuIEl0IGRvZXMgbm90CiAg\nICAgKiBzdXBwb3J0IHRoZSBhZGQgb3IgYWRkQWxsIG9wZXJhdGlvbnMuCiAg\nICAgKi8KICAgIHB1YmxpYyBTZXQga2V5U2V0KCkgewogICAgICAgIGlmIChr\nZXlTZXQgPT0gbnVsbCkgewogICAgICAgICAgICBrZXlTZXQgPSBuZXcgamF2\nYS51dGlsLkFic3RyYWN0U2V0KCkgewogICAgICAgICAgICAgICAgcHVibGlj\nIEl0ZXJhdG9yIGl0ZXJhdG9yKCkgewogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBuZXcgSGFzaEl0ZXJhdG9yKEtFWVMsIHRhYmxlLmxlbmd0aCAtIDEp\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHB1YmxpYyBp\nbnQgc2l6ZSgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY291bnQ7\nCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHVibGljIGJv\nb2xlYW4gY29udGFpbnMoT2JqZWN0IG8pIHsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gY29udGFpbnNLZXkobyk7CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlKE9iamVjdCBv\nKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENvbmN1cnJlbnRSZWZl\ncmVuY2VIYXNoTWFwLnRoaXMucmVtb3ZlKG8pICE9IG51bGw7CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgY2xlYXIo\nKSB7CiAgICAgICAgICAgICAgICAgICAgQ29uY3VycmVudFJlZmVyZW5jZUhh\nc2hNYXAudGhpcy5jbGVhcigpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9OwogICAgICAgIH0KICAgICAgICByZXR1cm4ga2V5U2V0OwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJucyBhIENvbGxlY3Rpb24gdmlldyBv\nZiB0aGUgdmFsdWVzIGNvbnRhaW5lZCBpbiB0aGlzIEhhc2hNYXAuCiAgICAg\nKiBUaGUgQ29sbGVjdGlvbiBpcyBiYWNrZWQgYnkgdGhlIEhhc2hNYXAsIHNv\nIGNoYW5nZXMgdG8gdGhlIEhhc2hNYXAgYXJlCiAgICAgKiByZWZsZWN0ZWQg\naW4gdGhlIENvbGxlY3Rpb24sIGFuZCB2aWNlLXZlcnNhLiBUaGUgQ29sbGVj\ndGlvbiBzdXBwb3J0cwogICAgICogZWxlbWVudCByZW1vdmFsLCB3aGljaCBy\nZW1vdmVzIHRoZSBjb3JyZXNwb25kaW5nIG1hcHBpbmcgZnJvbSB0aGUKICAg\nICAqIEhhc2hNYXAsIHZpYSB0aGUgSXRlcmF0b3IucmVtb3ZlLCBDb2xsZWN0\naW9uLnJlbW92ZSwgcmVtb3ZlQWxsLAogICAgICogcmV0YWluQWxsIGFuZCBj\nbGVhciBvcGVyYXRpb25zLiBJdCBkb2VzIG5vdCBzdXBwb3J0IHRoZSBhZGQg\nb3IgYWRkQWxsCiAgICAgKiBvcGVyYXRpb25zLgogICAgICovCiAgICBwdWJs\naWMgQ29sbGVjdGlvbiB2YWx1ZXMoKSB7CiAgICAgICAgaWYgKHZhbHVlcyA9\nPSBudWxsKSB7CiAgICAgICAgICAgIHZhbHVlcyA9IG5ldyBqYXZhLnV0aWwu\nQWJzdHJhY3RDb2xsZWN0aW9uKCkgewogICAgICAgICAgICAgICAgcHVibGlj\nIEl0ZXJhdG9yIGl0ZXJhdG9yKCkgewogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBuZXcgSGFzaEl0ZXJhdG9yKFZBTFVFUywgdGFibGUubGVuZ3RoIC0g\nMSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHVibGlj\nIGludCBzaXplKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb3Vu\ndDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBjb250YWlucyhPYmplY3QgbykgewogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBjb250YWluc1ZhbHVlKG8pOwogICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNsZWFyKCkgewogICAg\nICAgICAgICAgICAgICAgIENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoTWFwLnRo\naXMuY2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybnMgYSBDb2xsZWN0aW9uIHZpZXcgb2YgdGhlIG1h\ncHBpbmdzIGNvbnRhaW5lZCBpbiB0aGlzIEhhc2hNYXAuCiAgICAgKiBFYWNo\nIGVsZW1lbnQgaW4gdGhlIHJldHVybmVkIGNvbGxlY3Rpb24gaXMgYSBNYXAu\nRW50cnkuIFRoZSBDb2xsZWN0aW9uCiAgICAgKiBpcyBiYWNrZWQgYnkgdGhl\nIEhhc2hNYXAsIHNvIGNoYW5nZXMgdG8gdGhlIEhhc2hNYXAgYXJlIHJlZmxl\nY3RlZCBpbiB0aGUKICAgICAqIENvbGxlY3Rpb24sIGFuZCB2aWNlLXZlcnNh\nLiBUaGUgQ29sbGVjdGlvbiBzdXBwb3J0cyBlbGVtZW50IHJlbW92YWwsCiAg\nICAgKiB3aGljaCByZW1vdmVzIHRoZSBjb3JyZXNwb25kaW5nIG1hcHBpbmcg\nZnJvbSB0aGUgSGFzaE1hcCwgdmlhIHRoZQogICAgICogSXRlcmF0b3IucmVt\nb3ZlLCBDb2xsZWN0aW9uLnJlbW92ZSwgcmVtb3ZlQWxsLCByZXRhaW5BbGwg\nYW5kIGNsZWFyCiAgICAgKiBvcGVyYXRpb25zLiBJdCBkb2VzIG5vdCBzdXBw\nb3J0IHRoZSBhZGQgb3IgYWRkQWxsIG9wZXJhdGlvbnMuCiAgICAgKgogICAg\nICogQHNlZSBNYXAuRW50cnkKICAgICAqLwogICAgcHVibGljIFNldCBlbnRy\neVNldCgpIHsKICAgICAgICBpZiAoZW50cnlTZXQgPT0gbnVsbCkgewogICAg\nICAgICAgICBlbnRyeVNldCA9IG5ldyBqYXZhLnV0aWwuQWJzdHJhY3RTZXQo\nKSB7CiAgICAgICAgICAgICAgICBwdWJsaWMgSXRlcmF0b3IgaXRlcmF0b3Io\nKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBIYXNoSXRlcmF0\nb3IoRU5UUklFUywgdGFibGUubGVuZ3RoIC0gMSk7CiAgICAgICAgICAgICAg\nICB9CgogICAgICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gY29udGFpbnMo\nT2JqZWN0IG8pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIShvIGluc3Rh\nbmNlb2YgTWFwLkVudHJ5KSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRy\neSA9IChNYXAuRW50cnkpIG87CiAgICAgICAgICAgICAgICAgICAgT2JqZWN0\nIGtleSA9IGVudHJ5LmdldEtleSgpOwogICAgICAgICAgICAgICAgICAgIEVu\ndHJ5W10gdGFiID0gdGFibGU7CiAgICAgICAgICAgICAgICAgICAgaW50IGhh\nc2ggPSAoa2V5ID09IG51bGwgPyAwIDoga2V5Lmhhc2hDb2RlKCkpOwogICAg\nICAgICAgICAgICAgICAgIGludCBpbmRleCA9IChoYXNoICYgMHg3RkZGRkZG\nRikgJSB0YWIubGVuZ3RoOwoKICAgICAgICAgICAgICAgICAgICBmb3IgKEVu\ndHJ5IGUgPSB0YWJbaW5kZXhdOyBlICE9IG51bGw7IGUgPSBlLmdldE5leHQo\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuZ2V0SGFzaCgpID09\nIGhhc2ggJiYgZXEoZSwgZW50cnkpKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHB1\nYmxpYyBib29sZWFuIHJlbW92ZShPYmplY3QgbykgewogICAgICAgICAgICAg\nICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNYXAuRW50cnkpKQogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAg\nICAgICAgTWFwLkVudHJ5IGVudHJ5ID0gKE1hcC5FbnRyeSkgbzsKICAgICAg\nICAgICAgICAgICAgICBPYmplY3Qga2V5ID0gZW50cnkuZ2V0S2V5KCk7CiAg\nICAgICAgICAgICAgICAgICAgc3luY2hyb25pemVkIChDb25jdXJyZW50UmVm\nZXJlbmNlSGFzaE1hcC50aGlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIEVudHJ5W10gdGFiID0gdGFibGU7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGludCBoYXNoID0gKGtleSA9PSBudWxsID8gMCA6IGtleS5oYXNoQ29kZSgp\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGluZGV4ID0gKGhhc2gg\nJiAweDdGRkZGRkZGKSAlIHRhYi5sZW5ndGg7CgogICAgICAgICAgICAgICAg\nICAgICAgICBmb3IgKEVudHJ5IGUgPSB0YWJbaW5kZXhdLCBwcmV2ID0gbnVs\nbDsgZSAhPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJl\ndiA9IGUsIGUgPSBlLmdldE5leHQoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKGUuZ2V0SGFzaCgpID09IGhhc2ggJiYgZXEoZSwgZW50\ncnkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBy\nZXYgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgcHJldi5zZXROZXh0KGUuZ2V0TmV4dCgpKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHRhYltpbmRleF0gPSBlLmdldE5leHQoKTsKCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQtLTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gY291bnQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAg\nICAgICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgICAgICAgICAg\nICAgQ29uY3VycmVudFJlZmVyZW5jZUhhc2hNYXAudGhpcy5jbGVhcigpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAg\nICAgICAgcmV0dXJuIGVudHJ5U2V0OwogICAgfQoKICAgIC8qKgogICAgICog\nRXhwdW5nZSBzdGFsZSBlbnRyaWVzIGZyb20gdGhlIHRhYmxlLgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgZXhwdW5nZVN0YWxlRW50cmllcygpIHsKICAg\nICAgICBPYmplY3QgcjsKICAgICAgICB3aGlsZSAoKHIgPSBxdWV1ZS5wb2xs\nKCkpICE9IG51bGwpIHsKICAgICAgICAgICAgRW50cnkgZW50cnkgPSAoRW50\ncnkpIHI7CiAgICAgICAgICAgIGludCBoYXNoID0gZW50cnkuZ2V0SGFzaCgp\nOwogICAgICAgICAgICBFbnRyeVtdIHRhYiA9IHRhYmxlOwogICAgICAgICAg\nICBpbnQgaW5kZXggPSAoaGFzaCAmIDB4N0ZGRkZGRkYpICUgdGFiLmxlbmd0\naDsKCiAgICAgICAgICAgIGZvciAoRW50cnkgZSA9IHRhYltpbmRleF0sIHBy\nZXYgPSBudWxsOyBlICE9IG51bGw7CiAgICAgICAgICAgICAgICBwcmV2ID0g\nZSwgZSA9IGUuZ2V0TmV4dCgpKSB7CiAgICAgICAgICAgICAgICBpZiAoZSA9\nPSBlbnRyeSkgewogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2ICE9IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXYuc2V0TmV4dChlLmdl\ndE5leHQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lz\nZSBwdXQgdGhlIGJ1Y2tldCBhZnRlciB1cwogICAgICAgICAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgdGFiW2luZGV4XSA9IGUu\nZ2V0TmV4dCgpOwoKICAgICAgICAgICAgICAgICAgICBjb3VudC0tOwogICAg\nICAgICAgICAgICAgICAgIGlmIChrZXlUeXBlID09IEhBUkQpCiAgICAgICAg\nICAgICAgICAgICAgICAgIHZhbHVlRXhwaXJlZChlLmdldEtleSgpKTsKICAg\nICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAg\nIGtleUV4cGlyZWQoZS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIEhhc2hNYXAgY29sbGlzaW9uIGxpc3QgZW50cnkuCiAgICAgKi8KICAgIHBy\naXZhdGUgc3RhdGljIGludGVyZmFjZSBFbnRyeSBleHRlbmRzIE1hcC5FbnRy\neSB7CgogICAgICAgIHB1YmxpYyBpbnQgZ2V0SGFzaCgpOwoKICAgICAgICBw\ndWJsaWMgRW50cnkgZ2V0TmV4dCgpOwoKICAgICAgICBwdWJsaWMgdm9pZCBz\nZXROZXh0KEVudHJ5IG5leHQpOwoKICAgICAgICBwdWJsaWMgT2JqZWN0IGNs\nb25lKFJlZmVyZW5jZVF1ZXVlIHF1ZXVlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEhhcmQgZW50cnkuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNs\nYXNzIEhhcmRFbnRyeSBpbXBsZW1lbnRzIEVudHJ5IHsKCiAgICAgICAgcHJp\ndmF0ZSBpbnQgaGFzaDsKICAgICAgICBwcml2YXRlIE9iamVjdCBrZXk7CiAg\nICAgICAgcHJpdmF0ZSBPYmplY3QgdmFsdWU7CiAgICAgICAgcHJpdmF0ZSBF\nbnRyeSBuZXh0OwoKICAgICAgICBIYXJkRW50cnkoaW50IGhhc2gsIE9iamVj\ndCBrZXksIE9iamVjdCB2YWx1ZSwgRW50cnkgbmV4dCkgewogICAgICAgICAg\nICB0aGlzLmhhc2ggPSBoYXNoOwogICAgICAgICAgICB0aGlzLmtleSA9IGtl\neTsKICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgICAgICAg\nICB0aGlzLm5leHQgPSBuZXh0OwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGludCBnZXRIYXNoKCkgewogICAgICAgICAgICByZXR1cm4gaGFzaDsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBFbnRyeSBnZXROZXh0KCkgewogICAg\nICAgICAgICByZXR1cm4gbmV4dDsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyB2b2lkIHNldE5leHQoRW50cnkgbmV4dCkgewogICAgICAgICAgICB0aGlz\nLm5leHQgPSBuZXh0OwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVj\ndCBjbG9uZShSZWZlcmVuY2VRdWV1ZSBxdWV1ZSkgewogICAgICAgICAgICAv\nLyBJdCBpcyB0aGUgY2FsbGVycyByZXNwb25zaWJpbGl0eSB0byBzZXQgdGhl\nIG5leHQgZmllbGQKICAgICAgICAgICAgLy8gY29ycmVjdGx5LgogICAgICAg\nICAgICByZXR1cm4gbmV3IEhhcmRFbnRyeShoYXNoLCBrZXksIHZhbHVlLCBu\ndWxsKTsKICAgICAgICB9CgogICAgICAgIC8vIE1hcC5FbnRyeSBPcHMKCiAg\nICAgICAgcHVibGljIE9iamVjdCBnZXRLZXkoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBrZXk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IGdl\ndFZhbHVlKCkgewogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IHNldFZhbHVlKE9iamVjdCB2YWx1\nZSkgewogICAgICAgICAgICBPYmplY3Qgb2xkVmFsdWUgPSB0aGlzLnZhbHVl\nOwogICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICAg\nIHJldHVybiBvbGRWYWx1ZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBi\nb29sZWFuIGVxdWFscyhPYmplY3QgbykgewogICAgICAgICAgICBpZiAoIShv\nIGluc3RhbmNlb2YgTWFwLkVudHJ5KSkgcmV0dXJuIGZhbHNlOwogICAgICAg\nICAgICBNYXAuRW50cnkgZSA9IChNYXAuRW50cnkpIG87CgogICAgICAgICAg\nICBPYmplY3QgazEgPSBrZXk7CiAgICAgICAgICAgIE9iamVjdCBrMiA9IGUu\nZ2V0S2V5KCk7CgogICAgICAgICAgICByZXR1cm4gKGsxID09IG51bGwgPyBr\nMiA9PSBudWxsIDogZXEoazEsIGsyKSkgJiYKICAgICAgICAgICAgICAgICh2\nYWx1ZSA9PSBudWxsID8gZS5nZXRWYWx1ZSgpID09IG51bGwKICAgICAgICAg\nICAgICAgICAgICA6IGVxKHZhbHVlLCBlLmdldFZhbHVlKCkpKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAg\nICAgIHJldHVybiBoYXNoIF4gKHZhbHVlID09IG51bGwgPyAwIDogdmFsdWUu\naGFzaENvZGUoKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5n\nIHRvU3RyaW5nKCkgewogICAgICAgICAgICByZXR1cm4ga2V5ICsgIj0iICsg\ndmFsdWUudG9TdHJpbmcoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXZWFrIGVudHJ5LgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBj\nbGFzcyBXZWFrRW50cnkgZXh0ZW5kcyBXZWFrUmVmZXJlbmNlIGltcGxlbWVu\ndHMgRW50cnkgewoKICAgICAgICBwcml2YXRlIGludCBoYXNoOwogICAgICAg\nIHByaXZhdGUgT2JqZWN0IGhhcmQ7CiAgICAgICAgcHJpdmF0ZSBib29sZWFu\nIGtleVJlZjsKICAgICAgICBwcml2YXRlIEVudHJ5IG5leHQ7CgogICAgICAg\nIFdlYWtFbnRyeShpbnQgaGFzaCwgT2JqZWN0IGtleSwgT2JqZWN0IHZhbHVl\nLCBib29sZWFuIGtleVJlZiwKICAgICAgICAgICAgRW50cnkgbmV4dCwgUmVm\nZXJlbmNlUXVldWUgcXVldWUpIHsKICAgICAgICAgICAgc3VwZXIoKGtleVJl\nZikgPyBrZXkgOiB2YWx1ZSwgcXVldWUpOwogICAgICAgICAgICB0aGlzLmhh\nc2ggPSBoYXNoOwogICAgICAgICAgICB0aGlzLmhhcmQgPSAoa2V5UmVmKSA/\nIHZhbHVlIDoga2V5OwogICAgICAgICAgICB0aGlzLmtleVJlZiA9IGtleVJl\nZjsKICAgICAgICAgICAgdGhpcy5uZXh0ID0gbmV4dDsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBpbnQgZ2V0SGFzaCgpIHsKICAgICAgICAgICAgcmV0\ndXJuIGhhc2g7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRW50cnkgZ2V0\nTmV4dCgpIHsKICAgICAgICAgICAgcmV0dXJuIG5leHQ7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBzZXROZXh0KEVudHJ5IG5leHQpIHsKICAg\nICAgICAgICAgdGhpcy5uZXh0ID0gbmV4dDsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBPYmplY3QgY2xvbmUoUmVmZXJlbmNlUXVldWUgcXVldWUpIHsK\nICAgICAgICAgICAgLy8gSXQgaXMgdGhlIGNhbGxlcnMgcmVzcG9uc2liaWxp\ndHkgdG8gc2V0IHRoZSBuZXh0IGZpZWxkCiAgICAgICAgICAgIC8vIGNvcnJl\nY3RseS4KICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWFrRW50cnkoaGFzaCwg\nZ2V0S2V5KCksIGdldFZhbHVlKCksIGtleVJlZiwgbnVsbCwKICAgICAgICAg\nICAgICAgIHF1ZXVlKTsKICAgICAgICB9CgogICAgICAgIC8vIE1hcC5FbnRy\neSBPcHMKCiAgICAgICAgcHVibGljIE9iamVjdCBnZXRLZXkoKSB7CiAgICAg\nICAgICAgIHJldHVybiAoa2V5UmVmKSA/IHN1cGVyLmdldCgpIDogaGFyZDsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3QgZ2V0VmFsdWUoKSB7\nCiAgICAgICAgICAgIHJldHVybiAoa2V5UmVmKSA/IGhhcmQgOiBzdXBlci5n\nZXQoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3Qgc2V0VmFs\ndWUoT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgICAgIGlmICgha2V5UmVmKQog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBdHRlbXB0IHRvIHJl\nc2V0IHJlZmVyZW5jZSB2YWx1ZS4iKTsKCiAgICAgICAgICAgIE9iamVjdCBv\nbGRWYWx1ZSA9IGhhcmQ7CiAgICAgICAgICAgIGhhcmQgPSB2YWx1ZTsKICAg\nICAgICAgICAgcmV0dXJuIG9sZFZhbHVlOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvKSB7CiAgICAgICAgICAg\nIGlmICghKG8gaW5zdGFuY2VvZiBNYXAuRW50cnkpKSByZXR1cm4gZmFsc2U7\nCiAgICAgICAgICAgIE1hcC5FbnRyeSBlID0gKE1hcC5FbnRyeSkgbzsKICAg\nICAgICAgICAgcmV0dXJuIGVxKGdldEtleSgpLCBlLmdldEtleSgpKSAmJiBl\ncShnZXRWYWx1ZSgpLCBlLmdldFZhbHVlKCkpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICAgICAgT2JqZWN0\nIHZhbCA9IGdldFZhbHVlKCk7CiAgICAgICAgICAgIHJldHVybiBoYXNoIF4g\nKHZhbCA9PSBudWxsID8gMCA6IHZhbC5oYXNoQ29kZSgpKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAg\nICAgIHJldHVybiBnZXRLZXkoKSArICI9IiArIGdldFZhbHVlKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogU29mdCBlbnRyeS4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU29mdEVudHJ5IGV4dGVuZHMg\nU29mdFJlZmVyZW5jZSBpbXBsZW1lbnRzIEVudHJ5IHsKCiAgICAgICAgcHJp\ndmF0ZSBpbnQgaGFzaDsKICAgICAgICBwcml2YXRlIE9iamVjdCBoYXJkOwog\nICAgICAgIHByaXZhdGUgYm9vbGVhbiBrZXlSZWY7CiAgICAgICAgcHJpdmF0\nZSBFbnRyeSBuZXh0OwoKICAgICAgICBTb2Z0RW50cnkoaW50IGhhc2gsIE9i\namVjdCBrZXksIE9iamVjdCB2YWx1ZSwgYm9vbGVhbiBrZXlSZWYsCiAgICAg\nICAgICAgIEVudHJ5IG5leHQsIFJlZmVyZW5jZVF1ZXVlIHF1ZXVlKSB7CiAg\nICAgICAgICAgIHN1cGVyKChrZXlSZWYpID8ga2V5IDogdmFsdWUsIHF1ZXVl\nKTsKICAgICAgICAgICAgdGhpcy5oYXNoID0gaGFzaDsKICAgICAgICAgICAg\ndGhpcy5oYXJkID0gKGtleVJlZikgPyB2YWx1ZSA6IGtleTsKICAgICAgICAg\nICAgdGhpcy5rZXlSZWYgPSBrZXlSZWY7CiAgICAgICAgICAgIHRoaXMubmV4\ndCA9IG5leHQ7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdldEhh\nc2goKSB7CiAgICAgICAgICAgIHJldHVybiBoYXNoOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIEVudHJ5IGdldE5leHQoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBuZXh0OwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0\nTmV4dChFbnRyeSBuZXh0KSB7CiAgICAgICAgICAgIHRoaXMubmV4dCA9IG5l\neHQ7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IGNsb25lKFJl\nZmVyZW5jZVF1ZXVlIHF1ZXVlKSB7CiAgICAgICAgICAgIC8vIEl0IGlzIHRo\nZSBjYWxsZXJzIHJlc3BvbnNpYmlsaXR5IHRvIHNldCB0aGUgbmV4dCBmaWVs\nZAogICAgICAgICAgICAvLyBjb3JyZWN0bHkuCiAgICAgICAgICAgIHJldHVy\nbiBuZXcgU29mdEVudHJ5KGhhc2gsIGdldEtleSgpLCBnZXRWYWx1ZSgpLCBr\nZXlSZWYsIG51bGwsCiAgICAgICAgICAgICAgICBxdWV1ZSk7CiAgICAgICAg\nfQoKICAgICAgICAvLyBNYXAuRW50cnkgT3BzCgogICAgICAgIHB1YmxpYyBP\nYmplY3QgZ2V0S2V5KCkgewogICAgICAgICAgICByZXR1cm4gKGtleVJlZikg\nPyBzdXBlci5nZXQoKSA6IGhhcmQ7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgT2JqZWN0IGdldFZhbHVlKCkgewogICAgICAgICAgICByZXR1cm4gKGtl\neVJlZikgPyBoYXJkIDogc3VwZXIuZ2V0KCk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgT2JqZWN0IHNldFZhbHVlKE9iamVjdCB2YWx1ZSkgewogICAg\nICAgICAgICBpZiAoIWtleVJlZikKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBFcnJvcigiQXR0ZW1wdCB0byByZXNldCByZWZlcmVuY2UgdmFsdWUuIik7\nCgogICAgICAgICAgICBPYmplY3Qgb2xkVmFsdWUgPSBoYXJkOwogICAgICAg\nICAgICBoYXJkID0gdmFsdWU7CiAgICAgICAgICAgIHJldHVybiBvbGRWYWx1\nZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhP\nYmplY3QgbykgewogICAgICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgTWFw\nLkVudHJ5KSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICBNYXAuRW50cnkg\nZSA9IChNYXAuRW50cnkpIG87CiAgICAgICAgICAgIHJldHVybiBlcShnZXRL\nZXkoKSwgZS5nZXRLZXkoKSkgJiYgZXEoZ2V0VmFsdWUoKSwgZS5nZXRWYWx1\nZSgpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgaGFzaENvZGUo\nKSB7CiAgICAgICAgICAgIE9iamVjdCB2YWwgPSBnZXRWYWx1ZSgpOwogICAg\nICAgICAgICByZXR1cm4gaGFzaCBeICh2YWwgPT0gbnVsbCA/IDAgOiB2YWwu\naGFzaENvZGUoKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5n\nIHRvU3RyaW5nKCkgewogICAgICAgICAgICByZXR1cm4gZ2V0S2V5KCkgKyAi\nPSIgKyBnZXRWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBUeXBl\ncyBvZiBFbnVtZXJhdGlvbnMvSXRlcmF0aW9ucwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IEtFWVMgPSAwOwogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgaW50IFZBTFVFUyA9IDE7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgRU5UUklFUyA9IDI7CgogICAgLyoqCiAgICAgKiBNYXAgaXRlcmF0b3Iu\nCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgSGFzaEl0ZXJhdG9yIGltcGxl\nbWVudHMgSXRlcmF0b3IgewoKICAgICAgICBmaW5hbCBFbnRyeVtdIHRhYmxl\nID0gQ29uY3VycmVudFJlZmVyZW5jZUhhc2hNYXAudGhpcy50YWJsZTsKICAg\nICAgICBmaW5hbCBpbnQgdHlwZTsKICAgICAgICBpbnQgc3RhcnRJbmRleDsK\nICAgICAgICBpbnQgc3RvcEluZGV4ID0gMDsKICAgICAgICBpbnQgaW5kZXg7\nCiAgICAgICAgRW50cnkgZW50cnkgPSBudWxsOwogICAgICAgIEVudHJ5IGxh\nc3RSZXR1cm5lZCA9IG51bGw7CgogICAgICAgIEhhc2hJdGVyYXRvcihpbnQg\ndHlwZSwgaW50IHN0YXJ0SW5kZXgpIHsKICAgICAgICAgICAgdGhpcy50eXBl\nID0gdHlwZTsKICAgICAgICAgICAgdGhpcy5zdGFydEluZGV4ID0gc3RhcnRJ\nbmRleDsKICAgICAgICAgICAgaW5kZXggPSBzdGFydEluZGV4OwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzTmV4dCgpIHsKICAgICAg\nICAgICAgaWYgKGVudHJ5ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHdoaWxlIChp\nbmRleCA+PSBzdG9wSW5kZXgpIHsKICAgICAgICAgICAgICAgIGlmICgoZW50\ncnkgPSB0YWJsZVtpbmRleC0tXSkgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGlmIChzdG9wSW5kZXggPT0gMCkgewogICAg\nICAgICAgICAgICAgaW5kZXggPSB0YWJsZS5sZW5ndGggLSAxOwogICAgICAg\nICAgICAgICAgc3RvcEluZGV4ID0gc3RhcnRJbmRleCArIDE7CiAgICAgICAg\nICAgICAgICB3aGlsZSAoaW5kZXggPj0gc3RvcEluZGV4KSB7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKChlbnRyeSA9IHRhYmxlW2luZGV4LS1dKSAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgT2JqZWN0IG5leHQoKSB7CiAgICAgICAgICAgIGlm\nICghaGFzTmV4dCgpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vU3Vj\naEVsZW1lbnRFeGNlcHRpb24oKTsKICAgICAgICAgICAgRW50cnkgZSA9IGxh\nc3RSZXR1cm5lZCA9IGVudHJ5OwogICAgICAgICAgICBlbnRyeSA9IGUuZ2V0\nTmV4dCgpOwogICAgICAgICAgICByZXR1cm4gdHlwZSA9PSBLRVlTID8gZS5n\nZXRLZXkoKQogICAgICAgICAgICAgICAgOiAodHlwZSA9PSBWQUxVRVMgPyBl\nLmdldFZhbHVlKCkgOiBlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIHJlbW92ZSgpIHsKICAgICAgICAgICAgaWYgKGxhc3RSZXR1cm5lZCA9\nPSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0\nZUV4Y2VwdGlvbigpOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKENvbmN1\ncnJlbnRSZWZlcmVuY2VIYXNoTWFwLnRoaXMpIHsKICAgICAgICAgICAgICAg\nIEVudHJ5W10gdGFiID0gQ29uY3VycmVudFJlZmVyZW5jZUhhc2hNYXAudGhp\ncy50YWJsZTsKICAgICAgICAgICAgICAgIGludCBpbmRleCA9IChsYXN0UmV0\ndXJuZWQuZ2V0SGFzaCgpICYgMHg3RkZGRkZGRikgJSB0YWIubGVuZ3RoOwoK\nICAgICAgICAgICAgICAgIGZvciAoRW50cnkgZSA9IHRhYltpbmRleF0sIHBy\nZXYgPSBudWxsOyBlICE9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgcHJl\ndiA9IGUsIGUgPSBlLmdldE5leHQoKSkgewogICAgICAgICAgICAgICAgICAg\nIGlmIChlID09IGxhc3RSZXR1cm5lZCkgewogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAocHJldiA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgdGFiW2luZGV4XSA9IGUuZ2V0TmV4dCgpOwogICAgICAgICAgICAg\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBw\ncmV2LnNldE5leHQoZS5nZXROZXh0KCkpOwogICAgICAgICAgICAgICAgICAg\nICAgICBjb3VudC0tOwogICAgICAgICAgICAgICAgICAgICAgICBsYXN0UmV0\ndXJuZWQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJdGVyYXRlZCBvZmYgdGFi\nbGUgd2hlbiBkb2luZyByZW1vdmUiKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICBpbnQgY2FwYWNpdHkoKSB7CiAgICAgICAgcmV0dXJu\nIHRhYmxlLmxlbmd0aDsKICAgIH0KCiAgICBmbG9hdCBsb2FkRmFjdG9yKCkg\newogICAgICAgIHJldHVybiBsb2FkRmFjdG9yOwogICAgfQp9Cg==\n","encoding":"base64"}

