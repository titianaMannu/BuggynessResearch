{"sha":"a77f573f4683cfa2305963f3ca8f43d11c810e8d","node_id":"MDQ6QmxvYjIwNjM2NDphNzdmNTczZjQ2ODNjZmEyMzA1OTYzZjNjYThmNDNkMTFjODEwZThk","size":14755,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a77f573f4683cfa2305963f3ca8f43d11c810e8d","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwovKgogKiBXcml0dGVuIGJ5IERh\nd2lkIEt1cnp5bmllYywgYmFzZWQgb24gY29kZSB3cml0dGVuIGJ5IERvdWcg\nTGVhIHdpdGggYXNzaXN0YW5jZQogKiBmcm9tIG1lbWJlcnMgb2YgSkNQIEpT\nUi0xNjYgRXhwZXJ0IEdyb3VwLiBSZWxlYXNlZCB0byB0aGUgcHVibGljIGRv\nbWFpbiwKICogYXMgZXhwbGFpbmVkIGF0IGh0dHA6Ly9jcmVhdGl2ZWNvbW1v\nbnMub3JnL2xpY2Vuc2VzL3B1YmxpY2RvbWFpbi4KICogVGhhbmtzIHRvIENy\nYWlnIE1hdHRvY2tzIGZvciBzdWdnZXN0aW5nIHRvIHVzZSA8Y29kZT5zdW4u\nbWlzYy5QZXJmPC9jb2RlPi4KICovCgpwYWNrYWdlIG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5jb25jdXJyZW50OwoKaW1wb3J0IGphdmEubGFuZy5y\nZWZsZWN0LkFycmF5OwppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250\ncm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9u\nOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CgovKioKICogVGhpcyBjbGFzcyBncm91cHMgdG9nZXRo\nZXIgdGhlIGZ1bmN0aW9uYWxpdHkgb2YgamF2YS51dGlsLmNvbmN1cnJlbnQg\ndGhhdAogKiBjYW5ub3QgYmUgZnVsbHkgYW5kIHJlbGlhYmx5IGltcGxlbWVu\ndGVkIGluIGJhY2twb3J0LCBidXQgZm9yIHdoaWNoIHNvbWUKICogZm9ybSBv\nZiBlbXVsYXRpb24gaXMgcG9zc2libGUuCiAqIEN1cnJlbnRseSwgdGhpcyBj\nbGFzcyBjb250YWlucyBtZXRob2RzIHJlbGF0ZWQgdG8gbmFub3NlY29uZC1w\ncmVjaXNpb24KICogdGltaW5nLCBwYXJ0aWN1bGFybHkgdmlhIHRoZSB7QGxp\nbmsgI25hbm9UaW1lfSBtZXRob2QuIFRvIG1lYXN1cmUgdGltZQogKiBhY2N1\ncmF0ZWx5LCB0aGlzIG1ldGhvZCBieSBkZWZhdWx0IHVzZXMgPGNvZGU+amF2\nYS5zdW4uUGVyZjwvY29kZT4gb24KICogSkRLMS40LjIgYW5kIGl0IGZhbGxz\nIGJhY2sgdG8gPGNvZGU+U3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzPC9jb2Rl\nPgogKiBvbiBlYXJsaWVyIEpES3MuCiAqCiAqIEBhdXRob3IgRGF3aWQgS3Vy\nenluaWVjCiAqIEB2ZXJzaW9uIDEuMAogKi8KcHVibGljIGZpbmFsIGNsYXNz\nIFV0aWxzIHsKCiAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBOYW5vVGltZXIg\nbmFub1RpbWVyOwogICAgcHJpdmF0ZSBmaW5hbCBzdGF0aWMgU3RyaW5nIHBy\nb3ZpZGVyUHJvcCA9CiAgICAgICAgImVkdS5lbW9yeS5tYXRoY3MuYmFja3Bv\ncnQuamF2YS51dGlsLmNvbmN1cnJlbnQuTmFub1RpbWVyUHJvdmlkZXIiOwoK\nICAgIHN0YXRpYyB7CiAgICAgICAgTmFub1RpbWVyIHRpbWVyID0gbnVsbDsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmcgbmFub1RpbWVyQ2xh\nc3NOYW1lID0gKFN0cmluZykKICAgICAgICAgICAgICAgIEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKG5ldyBQcml2aWxlZ2VkQWN0aW9uKCkgewog\nICAgICAgICAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgcnVuKCkgewogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3lzdGVtLmdldFByb3BlcnR5\nKHByb3ZpZGVyUHJvcCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChuYW5vVGltZXJDbGFzc05h\nbWUgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgQ2xhc3MgY2xzID0gQ2xh\nc3MuZm9yTmFtZShuYW5vVGltZXJDbGFzc05hbWUpOwogICAgICAgICAgICAg\nICAgdGltZXIgPSAoTmFub1RpbWVyKSBjbHMubmV3SW5zdGFuY2UoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigKICAgICAgICAgICAgICAg\nICJXQVJOSU5HOiB1bmFibGUgdG8gbG9hZCB0aGUgc3lzdGVtLXByb3BlcnR5\nLWRlZmluZWQgIiArCiAgICAgICAgICAgICAgICAgICAgIm5hbm90aW1lIHBy\nb3ZpZGVyOyBzd2l0Y2hpbmcgdG8gdGhlIGRlZmF1bHQiKTsKICAgICAgICAg\nICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICB9CgogICAgICAgIGlm\nICh0aW1lciA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICB0aW1lciA9IG5ldyBTdW5QZXJmUHJvdmlkZXIoKTsKICAgICAg\nICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIGUpIHsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaWYgKHRpbWVyID09IG51bGwpIHsKICAgICAg\nICAgICAgdGltZXIgPSBuZXcgTWlsbGlzUHJvdmlkZXIoKTsKICAgICAgICB9\nCgogICAgICAgIG5hbm9UaW1lciA9IHRpbWVyOwogICAgfQoKICAgIHByaXZh\ndGUgVXRpbHMoKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRo\nZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBtb3N0IHByZWNpc2UgYXZhaWxhYmxl\nIHN5c3RlbSB0aW1lciwKICAgICAqIGluIG5hbm9zZWNvbmRzLiBUaGlzIG1l\ndGhvZCBjYW4gb25seSBiZSB1c2VkIHRvIG1lYXN1cmUgZWxhcHNlZCB0aW1l\nIGFuZAogICAgICogaXMgbm90IHJlbGF0ZWQgdG8gYW55IG90aGVyIG5vdGlv\nbiBvZiBzeXN0ZW0gb3Igd2FsbC1jbG9jayB0aW1lLiBUaGUKICAgICAqIHZh\nbHVlIHJldHVybmVkIHJlcHJlc2VudHMgbmFub3NlY29uZHMgc2luY2Ugc29t\nZSBmaXhlZCBidXQgYXJiaXRyYXJ5CiAgICAgKiB0aW1lKHBlcmhhcHMgaW4g\ndGhlIGZ1dHVyZSwgc28gdmFsdWVzIG1heSBiZSBuZWdhdGl2ZSkuIFRoaXMg\nbWV0aG9kCiAgICAgKiBwcm92aWRlcyBuYW5vc2Vjb25kIHByZWNpc2lvbiwg\nYnV0IG5vdCBuZWNlc3NhcmlseSBuYW5vc2Vjb25kIGFjY3VyYWN5LgogICAg\nICogTm8gZ3VhcmFudGVlcyBhcmUgbWFkZSBhYm91dCBob3cgZnJlcXVlbnRs\neSB2YWx1ZXMgY2hhbmdlLiBEaWZmZXJlbmNlcwogICAgICogaW4gc3VjY2Vz\nc2l2ZSBjYWxscyB0aGF0IHNwYW4gZ3JlYXRlciB0aGFuIGFwcHJveGltYXRl\nbHkgMjkyIHllYXJzCiAgICAgKiAoMl42MyBuYW5vc2Vjb25kcykgd2lsbCBu\nb3QgYWNjdXJhdGVseSBjb21wdXRlIGVsYXBzZWQgdGltZSBkdWUgdG8KICAg\nICAqIG51bWVyaWNhbCBvdmVyZmxvdy4KICAgICAqIAogICAgICogPGVtPklt\ncGxlbWVudGF0aW9uIG5vdGU6PC9lbT5CeSBkZWZhdWx0LCB0aGlzIG1ldGhv\nZCB1c2VzCiAgICAgKiA8Y29kZT5zdW4ubWlzYy5QZXJmPC9jb2RlPiBvbiBK\nYXZhIDEuNC4yLCBhbmQgZmFsbHMgYmFjayB0bwogICAgICogU3lzdGVtLmN1\ncnJlbnRUaW1lTWlsbGlzKCkgZW11bGF0aW9uIG9uIGVhcmxpZXIgSkRLcy4g\nQ3VzdG9tCiAgICAgKiB0aW1lciBjYW4gYmUgcHJvdmlkZWQgdmlhIHRoZSBz\neXN0ZW0gcHJvcGVydHkKICAgICAqIDxjb2RlPmVkdS5lbW9yeS5tYXRoY3Mu\nYmFja3BvcnQuamF2YS51dGlsLmNvbmN1cnJlbnQuTmFub1RpbWVyUHJvdmlk\nZXI8L2NvZGU+LgogICAgICogVGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSBz\naG91bGQgbmFtZSBhIGNsYXNzIGltcGxlbWVudGluZwogICAgICoge0BsaW5r\nIE5hbm9UaW1lcn0gaW50ZXJmYWNlLgogICAgICogTm90ZTogb24gSkRLIDEu\nNC4yLCA8Y29kZT5zdW4ubWlzYy5QZXJmPC9jb2RlPiB0aW1lciBzZWVtcyB0\nbyBoYXZlCiAgICAgKiByZXNvbHV0aW9uIG9mIHRoZSBvcmRlciBvZiAxIG1p\nY3Jvc2Vjb25kLCBtZWFzdXJlZCBvbiBMaW51eC4KICAgICAqCiAgICAgKiBA\ncmV0dXJuIFRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBzeXN0ZW0gdGltZXIs\nIGluIG5hbm9zZWNvbmRzLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGxv\nbmcgbmFub1RpbWUoKSB7CiAgICAgICAgcmV0dXJuIG5hbm9UaW1lci5uYW5v\nVGltZSgpOwogICAgfQoKICAgIC8qKgogICAgICogQ2F1c2VzIHRoZSBjdXJy\nZW50IHRocmVhZCB0byB3YWl0IHVudGlsIGl0IGlzIHNpZ25hbGxlZCBvciBp\nbnRlcnJ1cHRlZCwKICAgICAqIG9yIHRoZSBzcGVjaWZpZWQgd2FpdGluZyB0\naW1lIGVsYXBzZXMuIFRoaXMgbWV0aG9kIG9yaWdpbmFsbHkgYXBwZWFycwog\nICAgICogaW4gdGhlIHtAbGluayBDb25kaXRpb259IGludGVyZmFjZSwgYnV0\nIGl0IHdhcyBtb3ZlZCB0byBoZXJlIHNpbmNlIGl0CiAgICAgKiBjYW4gb25s\neSBiZSBlbXVsYXRlZCwgd2l0aCB2ZXJ5IGxpdHRsZSBhY2N1cmFjeSBndWFy\nYW50ZWVzOiB0aGUKICAgICAqIGVmZmljaWVudCBpbXBsZW1lbnRhdGlvbiBy\nZXF1aXJlcyBhY2N1cmF0ZSBuYW5vc2Vjb25kIHRpbWVyIGFuZCBuYXRpdmUK\nICAgICAqIHN1cHBvcnQgZm9yIG5hbm9zZWNvbmQtcHJlY2lzaW9uIHdhaXQg\ncXVldWVzLCB3aGljaCBhcmUgbm90IHVzdWFsbHkKICAgICAqIHByZXNlbnQg\naW4gSlZNcyBwcmlvciB0byAxLjUuIExvc3Mgb2YgcHJlY2lzaW9uIG1heSBj\nYXVzZSB0b3RhbCB3YWl0aW5nCiAgICAgKiB0aW1lcyB0byBiZSBzeXN0ZW1h\ndGljYWxseSBzaG9ydGVyIHRoYW4gc3BlY2lmaWVkIHdoZW4gcmUtd2FpdHMg\nb2NjdXIuCiAgICAgKiBUaGUgbG9jayBhc3NvY2lhdGVkIHdpdGggdGhpcyBj\nb25kaXRpb24gaXMgYXRvbWljYWxseQogICAgICogcmVsZWFzZWQgYW5kIHRo\nZSBjdXJyZW50IHRocmVhZCBiZWNvbWVzIGRpc2FibGVkIGZvciB0aHJlYWQg\nc2NoZWR1bGluZwogICAgICogcHVycG9zZXMgYW5kIGxpZXMgZG9ybWFudCB1\nbnRpbCA8ZW0+b25lPC9lbT4gb2YgZml2ZSB0aGluZ3MgaGFwcGVuczoKICAg\nICAqIDx1bD4KICAgICAqIDxsaT5Tb21lIG90aGVyIHRocmVhZCBpbnZva2Vz\nIHRoZSB7QGxpbmsKICAgICAqIGVkdS5lbW9yeS5tYXRoY3MuYmFja3BvcnQu\namF2YS51dGlsLmNvbmN1cnJlbnQubG9ja3MuQ29uZGl0aW9uI3NpZ25hbH0K\nICAgICAqIG1ldGhvZCBmb3IgdGhpcwogICAgICogPHR0PkNvbmRpdGlvbjwv\ndHQ+IGFuZCB0aGUgY3VycmVudCB0aHJlYWQgaGFwcGVucyB0byBiZSBjaG9z\nZW4gYXMgdGhlCiAgICAgKiB0aHJlYWQgdG8gYmUgYXdha2VuZWQ7IG9yCiAg\nICAgKiA8bGk+U29tZSBvdGhlciB0aHJlYWQgaW52b2tlcyB0aGUge0BsaW5r\nCiAgICAgKiBlZHUuZW1vcnkubWF0aGNzLmJhY2twb3J0LmphdmEudXRpbC5j\nb25jdXJyZW50LmxvY2tzLkNvbmRpdGlvbiNzaWduYWxBbGx9CiAgICAgKiBt\nZXRob2QgZm9yIHRoaXMKICAgICAqIDx0dD5Db25kaXRpb248L3R0Pjsgb3IK\nICAgICAqIDxsaT5Tb21lIG90aGVyIHRocmVhZCB7QGxpbmsgVGhyZWFkI2lu\ndGVycnVwdCBpbnRlcnJ1cHRzfSB0aGUgY3VycmVudAogICAgICogdGhyZWFk\nLCBhbmQgaW50ZXJydXB0aW9uIG9mIHRocmVhZCBzdXNwZW5zaW9uIGlzIHN1\ncHBvcnRlZDsgb3IKICAgICAqIDxsaT5UaGUgc3BlY2lmaWVkIHdhaXRpbmcg\ndGltZSBlbGFwc2VzOyBvcgogICAgICogPGxpPkEgJnF1b3Q7PGVtPnNwdXJp\nb3VzIHdha2V1cDwvZW0+JnF1b3Q7IG9jY3Vycy4KICAgICAqIDwvdWw+IElu\nIGFsbCBjYXNlcywgYmVmb3JlIHRoaXMgbWV0aG9kIGNhbiByZXR1cm4gdGhl\nIGN1cnJlbnQgdGhyZWFkIG11c3QKICAgICAqIHJlLWFjcXVpcmUgdGhlIGxv\nY2sgYXNzb2NpYXRlZCB3aXRoIHRoaXMgY29uZGl0aW9uLiBXaGVuIHRoZQog\nICAgICogdGhyZWFkIHJldHVybnMgaXQgaXMgPGVtPmd1YXJhbnRlZWQ8L2Vt\nPiB0byBob2xkIHRoaXMgbG9jay4KICAgICAqIElmIHRoZSBjdXJyZW50IHRo\ncmVhZDoKICAgICAqIDx1bD4KICAgICAqIDxsaT5oYXMgaXRzIGludGVycnVw\ndGVkIHN0YXR1cyBzZXQgb24gZW50cnkgdG8gdGhpcyBtZXRob2Q7IG9yCiAg\nICAgKiA8bGk+aXMge0BsaW5rIFRocmVhZCNpbnRlcnJ1cHQgaW50ZXJydXB0\nZWR9IHdoaWxlIHdhaXRpbmcKICAgICAqIGFuZCBpbnRlcnJ1cHRpb24gb2Yg\ndGhyZWFkIHN1c3BlbnNpb24gaXMgc3VwcG9ydGVkLAogICAgICogPC91bD4K\nICAgICAqIHRoZW4ge0BsaW5rIEludGVycnVwdGVkRXhjZXB0aW9ufSBpcyB0\naHJvd24gYW5kIHRoZSBjdXJyZW50IHRocmVhZCdzCiAgICAgKiBpbnRlcnJ1\ncHRlZCBzdGF0dXMgaXMgY2xlYXJlZC4gSXQgaXMgbm90IHNwZWNpZmllZCwg\naW4gdGhlIGZpcnN0CiAgICAgKiBjYXNlLCB3aGV0aGVyIG9yIG5vdCB0aGUg\ndGVzdCBmb3IgaW50ZXJydXB0aW9uIG9jY3VycyBiZWZvcmUgdGhlIGxvY2sK\nICAgICAqIGlzIHJlbGVhc2VkLiBUaGUgbWV0aG9kIHJldHVybnMgYW4gZXN0\naW1hdGUgb2YgdGhlIG51bWJlciBvZiBuYW5vc2Vjb25kcwogICAgICogcmVt\nYWluaW5nIHRvIHdhaXQgZ2l2ZW4gdGhlIHN1cHBsaWVkIDx0dD5uYW5vc1Rp\nbWVvdXQ8L3R0PgogICAgICogdmFsdWUgdXBvbiByZXR1cm4sIG9yIGEgdmFs\ndWUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHplcm8gaWYgaXQKICAgICAqIHRp\nbWVkIG91dC4gQWNjdXJhY3kgb2YgdGhpcyBlc3RpbWF0ZSBpcyBkaXJlY3Rs\neSBkZXBlbmRlbnQgb24gdGhlCiAgICAgKiBhY2N1cmFjeSBvZiB7QGxpbmsg\nI25hbm9UaW1lfS4gVGhpcyB2YWx1ZSBjYW4gYmUgdXNlZCB0byBkZXRlcm1p\nbmUKICAgICAqIHdoZXRoZXIgYW5kIGhvdyBsb25nIHRvIHJlLXdhaXQgaW4g\nY2FzZXMgd2hlcmUgdGhlIHdhaXQgcmV0dXJucyBidXQgYW4KICAgICAqIGF3\nYWl0ZWQgY29uZGl0aW9uIHN0aWxsIGRvZXMgbm90IGhvbGQuIFR5cGljYWwg\ndXNlcyBvZiB0aGlzIG1ldGhvZCB0YWtlCiAgICAgKiB0aGUgZm9sbG93aW5n\nIGZvcm06CiAgICAgKiAKICAgICAqIDxwcmU+IHN5bmNocm9uaXplZCBib29s\nZWFuIGFNZXRob2QobG9uZyB0aW1lb3V0LCBUaW1lVW5pdCB1bml0KSB7CiAg\nICAgKiBsb25nIG5hbm9zVGltZW91dCA9IHVuaXQudG9OYW5vcyh0aW1lb3V0\nKTsKICAgICAqIHdoaWxlICghY29uZGl0aW9uQmVpbmdXYWl0ZWRGb3IpIHsg\naWYgKG5hbm9zVGltZW91dCAmZ3Q7IDApCiAgICAgKiBuYW5vc1RpbWVvdXQg\nPSB0aGVDb25kaXRpb24uYXdhaXROYW5vcyhuYW5vc1RpbWVvdXQpOyBlbHNl\nIHJldHVybiBmYWxzZTsKICAgICAqIH0gLy8gLi4uIH0KICAgICAqIDwvcHJl\nPgogICAgICogCiAgICAgKiA8Yj5JbXBsZW1lbnRhdGlvbiBDb25zaWRlcmF0\naW9uczwvYj4KICAgICAqIFRoZSBjdXJyZW50IHRocmVhZCBpcyBhc3N1bWVk\nIHRvIGhvbGQgdGhlIGxvY2sgYXNzb2NpYXRlZCB3aXRoIHRoaXMKICAgICAq\nIDx0dD5Db25kaXRpb248L3R0PiB3aGVuIHRoaXMgbWV0aG9kIGlzIGNhbGxl\nZC4KICAgICAqIEl0IGlzIHVwIHRvIHRoZSBpbXBsZW1lbnRhdGlvbiB0byBk\nZXRlcm1pbmUgaWYgdGhpcyBpcwogICAgICogdGhlIGNhc2UgYW5kIGlmIG5v\ndCwgaG93IHRvIHJlc3BvbmQuIFR5cGljYWxseSwgYW4gZXhjZXB0aW9uIHdp\nbGwgYmUKICAgICAqIHRocm93bihzdWNoIGFzIHtAbGluayBJbGxlZ2FsTW9u\naXRvclN0YXRlRXhjZXB0aW9ufSkgYW5kIHRoZQogICAgICogaW1wbGVtZW50\nYXRpb24gbXVzdCBkb2N1bWVudCB0aGF0IGZhY3QuCiAgICAgKiBBIGNvbmRp\ndGlvbiBpbXBsZW1lbnRhdGlvbiBjYW4gZmF2b3IgcmVzcG9uZGluZyB0byBh\nbiBpbnRlcnJ1cHQgb3ZlcgogICAgICogbm9ybWFsIG1ldGhvZCByZXR1cm4g\naW4gcmVzcG9uc2UgdG8gYSBzaWduYWwsIG9yIG92ZXIgaW5kaWNhdGluZyB0\naGUKICAgICAqIGVsYXBzZSBvZiB0aGUgc3BlY2lmaWVkIHdhaXRpbmcgdGlt\nZS4gSW4gZWl0aGVyIGNhc2UgdGhlIGltcGxlbWVudGF0aW9uCiAgICAgKiBt\ndXN0IGVuc3VyZSB0aGF0IHRoZSBzaWduYWwgaXMgcmVkaXJlY3RlZCB0byBh\nbm90aGVyIHdhaXRpbmcgdGhyZWFkLCBpZgogICAgICogdGhlcmUgaXMgb25l\nLgogICAgICoKICAgICAqIEBwYXJhbSBjb25kIHRoZSBjb25kaXRpb24gdG8g\nd2FpdCBmb3IKICAgICAqIEBwYXJhbSBuYW5vc1RpbWVvdXQgdGhlIG1heGlt\ndW0gdGltZSB0byB3YWl0LCBpbiBuYW5vc2Vjb25kcwogICAgICogQHJldHVy\nbiBBIHZhbHVlIGxlc3MgdGhhbiBvciBlcXVhbCB0byB6ZXJvIGlmIHRoZSB3\nYWl0IGhhcwogICAgICogdGltZWQgb3V0OyBvdGhlcndpc2UgYW4gZXN0aW1h\ndGUsIHRoYXQKICAgICAqIGlzIHN0cmljdGx5IGxlc3MgdGhhbiB0aGUgPHR0\nPm5hbm9zVGltZW91dDwvdHQ+IGFyZ3VtZW50LAogICAgICogb2YgdGhlIHRp\nbWUgc3RpbGwgcmVtYWluaW5nIHdoZW4gdGhpcyBtZXRob2QgcmV0dXJuZWQu\nCiAgICAgKiBAdGhyb3dzIEludGVycnVwdGVkRXhjZXB0aW9uIGlmIHRoZSBj\ndXJyZW50IHRocmVhZCBpcyBpbnRlcnJ1cHRlZChhbmQKICAgICAqIGludGVy\ncnVwdGlvbiBvZiB0aHJlYWQgc3VzcGVuc2lvbiBpcyBzdXBwb3J0ZWQpLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGxvbmcgYXdhaXROYW5vcyhDb25k\naXRpb24gY29uZCwgbG9uZyBuYW5vc1RpbWVvdXQpCiAgICAgICAgdGhyb3dz\nIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICBpZiAobmFub3NUaW1l\nb3V0IDw9IDApIHJldHVybiBuYW5vc1RpbWVvdXQ7CiAgICAgICAgbG9uZyBu\nb3cgPSBuYW5vVGltZSgpOwogICAgICAgIGNvbmQuYXdhaXQobmFub3NUaW1l\nb3V0LCBUaW1lVW5pdC5OQU5PU0VDT05EUyk7CiAgICAgICAgcmV0dXJuIG5h\nbm9zVGltZW91dCAtIChuYW5vVGltZSgpIC0gbm93KTsKICAgIH0KCiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBjbGFzcyBTdW5QZXJmUHJvdmlkZXIgaW1w\nbGVtZW50cyBOYW5vVGltZXIgewoKICAgICAgICBmaW5hbCBzdW4ubWlzYy5Q\nZXJmIHBlcmY7CiAgICAgICAgZmluYWwgbG9uZyBtdWx0aXBsaWVyLCBkaXZp\nc29yOwoKICAgICAgICBTdW5QZXJmUHJvdmlkZXIoKSB7CiAgICAgICAgICAg\nIHBlcmYgPSAoc3VuLm1pc2MuUGVyZikKICAgICAgICAgICAgICAgIEFjY2Vz\nc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKG5ldyBQcml2aWxlZ2VkQWN0aW9u\nKCkgewogICAgICAgICAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgcnVuKCkg\newogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VuLm1pc2MuUGVy\nZi5nZXRQZXJmKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgfSk7CiAgICAgICAgICAgIC8vIHRyeWluZyB0byBhdm9pZCBCT1RI\nIG92ZXJmbG93IGFuZCByb3VuZGluZyBlcnJvcnMKICAgICAgICAgICAgbG9u\nZyBudW1lcmF0b3IgPSAxMDAwMDAwMDAwOwogICAgICAgICAgICBsb25nIGRl\nbm9taW5hdG9yID0gcGVyZi5oaWdoUmVzRnJlcXVlbmN5KCk7CiAgICAgICAg\nICAgIGxvbmcgZ2NkID0gZ2NkKG51bWVyYXRvciwgZGVub21pbmF0b3IpOwog\nICAgICAgICAgICB0aGlzLm11bHRpcGxpZXIgPSBudW1lcmF0b3IgLyBnY2Q7\nCiAgICAgICAgICAgIHRoaXMuZGl2aXNvciA9IGRlbm9taW5hdG9yIC8gZ2Nk\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgbmFub1RpbWUoKSB7\nCiAgICAgICAgICAgIGxvbmcgY3RyID0gcGVyZi5oaWdoUmVzQ291bnRlcigp\nOwoKICAgICAgICAgICAgLy8gYW55dGhpbmcgbGVzcyBzb3BoaXN0aWNhdGVk\nIHN1ZmZlcnMgZWl0aGVyIGZyb20gcm91bmRpbmcgZXJyb3JzCiAgICAgICAg\nICAgIC8vIChGUCBhcml0aG1ldGljcywgYmFja3BvcnQgdjEuMCkgb3Igb3Zl\ncmZsb3csIHdoZW4gZ2NkIGlzIHNtYWxsCiAgICAgICAgICAgIC8vIChhIGJ1\nZyBpbiBiYWNrcG9ydCB2MS4wXzAxIHJlcG9ydGVkIGJ5IFJhbWVzaCBOZXRo\naSkKCiAgICAgICAgICAgIHJldHVybiAoKGN0ciAvIGRpdmlzb3IpICogbXVs\ndGlwbGllcikgKwogICAgICAgICAgICAgICAgKGN0ciAlIGRpdmlzb3IpICog\nbXVsdGlwbGllciAvIGRpdmlzb3I7CgogICAgICAgICAgICAvLyBldmVuIHRo\nZSBhYm92ZSBjYW4gdGhlb3JldGljYWxseSBjYXVzZSBwcm9ibGVtcyBpZiB5\nb3VyIEpWTSBpcwogICAgICAgICAgICAvLyBydW5uaW5nIGZvciBzdWZmaWNp\nZW50bHkgbG9uZyB0aW1lLCBidXQgInN1ZmZpY2llbnRseSIgbWVhbnMgMjky\nCiAgICAgICAgICAgIC8vIHllYXJzKHdvcnN0IGNhc2UpLCBvciAzMCwwMDAg\neWVhcnMoY29tbW9uIGNhc2UpLgoKICAgICAgICAgICAgLy8gRGV0YWlsczog\nd2hlbiB0aGUgdGlja3MgY3RyIG92ZXJmbG93cywgdGhlcmUgaXMgbm8gd2F5\nIHRvIGF2b2lkCiAgICAgICAgICAgIC8vIGRpc2NvbnRpbnVpdHkgaW4gY29t\ncHV0ZWQgbmFub3MsIGV2ZW4gaW4gaW5maW5pdGUgYXJpdGhtZXRpY3MsCiAg\nICAgICAgICAgIC8vIHVubGVzcyB3ZSBjb3VudCBudW1iZXIgb2Ygb3ZlcmZs\nb3dzIHRoYXQgdGhlIGN0ciB3ZW50IHRocm91Z2gKICAgICAgICAgICAgLy8g\nc2luY2UgdGhlIEpWTSBzdGFydGVkLiBUaGlzIGZvbGxvd3MgZnJvbSB0aGUg\nZmFjdCB0aGF0CiAgICAgICAgICAgIC8vICgyXjY0Km11bHRpcGxpZXIvZGl2\naXNvcikgbW9kKDJeNjQpID4gMCBpbiBnZW5lcmFsIGNhc2UuCiAgICAgICAg\nICAgIC8vIFRoZW9yZXRpY2FsbHkgd2UgY291bGQgZmluZCBvdXQgdGhlIG51\nbWJlciBvZiBvdmVyZmxvd3MgYnkKICAgICAgICAgICAgLy8gY2hlY2tpbmcg\nU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCksIGJ1dCB0aGlzIGlzIHVucmVs\naWFibGUKICAgICAgICAgICAgLy8gc2luY2UgdGhlIHN5c3RlbSB0aW1lIGNh\nbiB1bnByZWRpY3RhYmx5IGNoYW5nZSBkdXJpbmcgdGhlIEpWTQogICAgICAg\nICAgICAvLyBsaWZldGltZS4KICAgICAgICAgICAgLy8gVGhlIHRpbWUgdG8g\nb3ZlcmZsb3cgaXMgMl42MyAvIHRpY2tzIGZyZXF1ZW5jeS4gV2l0aCBjdXJy\nZW50CiAgICAgICAgICAgIC8vIHRpY2tzIGZyZXF1ZW5jaWVzIG9mIHNldmVy\nYWwgTUh6LCBpdCBnaXZlcyBhYm91dCAzMCwwMDAgeWVhcnMKICAgICAgICAg\nICAgLy8gYmVmb3JlIHRoZSBwcm9ibGVtIGhhcHBlbnMuIElmIHRpY2tzIGZy\nZXF1ZW5jeSByZWFjaGVzIDEgR0h6LCB0aGUKICAgICAgICAgICAgLy8gdGlt\nZSB0byBvdmVyZmxvdyBpcyAyOTIgeWVhcnMuIEl0IGlzIHVubGlrZWx5IHRo\nYXQgdGhlIGZyZXF1ZW5jeQogICAgICAgICAgICAvLyBldmVyIGV4Y2VlZHMg\nMSBHSHouIFdlIGNvdWxkIGRvdWJsZSB0aGUgdGltZSB0byBvdmVyZmxvdwog\nICAgICAgICAgICAvLyAodG8gMl42NCAvIGZyZXF1ZW5jeSkgYnkgdXNpbmcg\ndW5zaWduZWQgYXJpdGhtZXRpY3MsIGUuZy4gYnkKICAgICAgICAgICAgLy8g\nYWRkaW5nIHRoZSBmb2xsb3dpbmcgY29ycmVjdGlvbiB3aGVuZXZlciB0aGUg\ndGlja3MgaXMgbmVnYXRpdmU6CiAgICAgICAgICAgIC8vICAgICAgLTIqKChM\nb25nLk1JTl9WQUxVRSAvIGRpdmlzb3IpICogbXVsdGlwbGllciArCiAgICAg\nICAgICAgIC8vICAgICAgICAgIChMb25nLk1JTl9WQUxVRSAlIGRpdmlzb3Ip\nICogbXVsdGlwbGllciAvIGRpdmlzb3IpCiAgICAgICAgICAgIC8vIEJ1dCwg\nd2l0aCB0aGUgd29yc3QgY2FzZSBvZiBhcyBtdWNoIGFzIDI5MiB5ZWFycywg\naXQgZG9lcyBub3QKICAgICAgICAgICAgLy8gc2VlbSBqdXN0aWZpZWQuCiAg\nICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGNsYXNz\nIE1pbGxpc1Byb3ZpZGVyIGltcGxlbWVudHMgTmFub1RpbWVyIHsKCiAgICAg\nICAgTWlsbGlzUHJvdmlkZXIoKSB7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgbG9uZyBuYW5vVGltZSgpIHsKICAgICAgICAgICAgcmV0dXJuIFN5c3Rl\nbS5jdXJyZW50VGltZU1pbGxpcygpICogMTAwMDAwMDsKICAgICAgICB9CiAg\nICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgbG9uZyBnY2QobG9uZyBhLCBsb25n\nIGIpIHsKICAgICAgICBsb25nIHI7CiAgICAgICAgd2hpbGUgKGIgPiAwKSB7\nCiAgICAgICAgICAgIHIgPSBhICUgYjsKICAgICAgICAgICAgYSA9IGI7CiAg\nICAgICAgICAgIGIgPSByOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYTsK\nICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdFtdIGNvbGxlY3Rpb25U\nb0FycmF5KENvbGxlY3Rpb24gYykgewogICAgICAgIC8vIGd1ZXNzIHRoZSBh\ncnJheSBzaXplOyBleHBlY3QgdG8gcG9zc2libHkgYmUgZGlmZmVyZW50CiAg\nICAgICAgaW50IGxlbiA9IGMuc2l6ZSgpOwogICAgICAgIE9iamVjdFtdIGFy\nciA9IG5ldyBPYmplY3RbbGVuXTsKICAgICAgICBJdGVyYXRvciBpdHIgPSBj\nLml0ZXJhdG9yKCk7CiAgICAgICAgaW50IGlkeCA9IDA7CiAgICAgICAgd2hp\nbGUgKHRydWUpIHsKICAgICAgICAgICAgd2hpbGUgKGlkeCA8IGxlbiAmJiBp\ndHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAgICBhcnJbaWR4KytdID0g\naXRyLm5leHQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWl0\nci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgIGlmIChpZHggPT0gbGVu\nKSByZXR1cm4gYXJyOwogICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGhh\ndmUgdG8gdHJpbQogICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5cy5jb3B5\nT2YoYXJyLCBpZHgsIE9iamVjdFtdLmNsYXNzKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICAvLyBvdGhlcndpc2UsIGhhdmUgdG8gZ3JvdwogICAgICAg\nICAgICBpbnQgbmV3Y2FwID0gKChhcnIubGVuZ3RoIC8gMikgKyAxKSAqIDM7\nCiAgICAgICAgICAgIGlmIChuZXdjYXAgPCBhcnIubGVuZ3RoKSB7CiAgICAg\nICAgICAgICAgICAvLyBvdmVyZmxvdwogICAgICAgICAgICAgICAgaWYgKGFy\nci5sZW5ndGggPCBJbnRlZ2VyLk1BWF9WQUxVRSkgewogICAgICAgICAgICAg\nICAgICAgIG5ld2NhcCA9IEludGVnZXIuTUFYX1ZBTFVFOwogICAgICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nT3V0T2ZNZW1vcnlFcnJvcigicmVxdWlyZWQgYXJyYXkgc2l6ZSB0b28gbGFy\nZ2UiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nICAgICBhcnIgPSBBcnJheXMuY29weU9mKGFyciwgbmV3Y2FwLCBPYmplY3Rb\nXS5jbGFzcyk7CiAgICAgICAgICAgIGxlbiA9IG5ld2NhcDsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHN0YXRpYyBPYmplY3RbXSBjb2xsZWN0aW9u\nVG9BcnJheShDb2xsZWN0aW9uIGMsIE9iamVjdFtdIGEpIHsKICAgICAgICBD\nbGFzcyBhVHlwZSA9IGEuZ2V0Q2xhc3MoKTsKICAgICAgICAvLyBndWVzcyB0\naGUgYXJyYXkgc2l6ZTsgZXhwZWN0IHRvIHBvc3NpYmx5IGJlIGRpZmZlcmVu\ndAogICAgICAgIGludCBsZW4gPSBjLnNpemUoKTsKICAgICAgICBPYmplY3Rb\nXSBhcnIgPSAoYS5sZW5ndGggPj0gbGVuID8gYSA6CiAgICAgICAgICAgIChP\nYmplY3RbXSkgQXJyYXkubmV3SW5zdGFuY2UoYVR5cGUuZ2V0Q29tcG9uZW50\nVHlwZSgpLCBsZW4pKTsKICAgICAgICBJdGVyYXRvciBpdHIgPSBjLml0ZXJh\ndG9yKCk7CiAgICAgICAgaW50IGlkeCA9IDA7CiAgICAgICAgd2hpbGUgKHRy\ndWUpIHsKICAgICAgICAgICAgd2hpbGUgKGlkeCA8IGxlbiAmJiBpdHIuaGFz\nTmV4dCgpKSB7CiAgICAgICAgICAgICAgICBhcnJbaWR4KytdID0gaXRyLm5l\neHQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWl0ci5oYXNO\nZXh0KCkpIHsKICAgICAgICAgICAgICAgIGlmIChpZHggPT0gbGVuKSByZXR1\ncm4gYXJyOwogICAgICAgICAgICAgICAgaWYgKGFyciA9PSBhKSB7CiAgICAg\nICAgICAgICAgICAgICAgLy8gb3JpZyBhcnJheSAtPiBudWxsIHRlcm1pbmF0\nZQogICAgICAgICAgICAgICAgICAgIGFbaWR4XSA9IG51bGw7CiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIGE7CiAgICAgICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgICAgIC8vIGhhdmUgdG8gdHJpbQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBBcnJheXMuY29weU9mKGFyciwgaWR4LCBh\nVHlwZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgLy8gb3RoZXJ3aXNlLCBoYXZlIHRvIGdyb3cKICAgICAgICAgICAg\naW50IG5ld2NhcCA9ICgoYXJyLmxlbmd0aCAvIDIpICsgMSkgKiAzOwogICAg\nICAgICAgICBpZiAobmV3Y2FwIDwgYXJyLmxlbmd0aCkgewogICAgICAgICAg\nICAgICAgLy8gb3ZlcmZsb3cKICAgICAgICAgICAgICAgIGlmIChhcnIubGVu\nZ3RoIDwgSW50ZWdlci5NQVhfVkFMVUUpIHsKICAgICAgICAgICAgICAgICAg\nICBuZXdjYXAgPSBJbnRlZ2VyLk1BWF9WQUxVRTsKICAgICAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE91dE9m\nTWVtb3J5RXJyb3IoInJlcXVpcmVkIGFycmF5IHNpemUgdG9vIGxhcmdlIik7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nYXJyID0gQXJyYXlzLmNvcHlPZihhcnIsIG5ld2NhcCwgYVR5cGUpOwogICAg\nICAgICAgICBsZW4gPSBuZXdjYXA7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

