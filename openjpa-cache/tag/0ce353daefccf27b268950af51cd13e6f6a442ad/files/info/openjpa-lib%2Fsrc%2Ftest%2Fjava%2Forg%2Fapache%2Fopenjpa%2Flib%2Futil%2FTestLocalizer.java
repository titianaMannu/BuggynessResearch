{"sha":"ce9653873c7098e03302178751433434a21abdb7","node_id":"MDQ6QmxvYjIwNjM2NDpjZTk2NTM4NzNjNzA5OGUwMzMwMjE3ODc1MTQzMzQzNGEyMWFiZGI3","size":4052,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ce9653873c7098e03302178751433434a21abdb7","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2Us\nIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBub3Qg\ndXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBM\naWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vu\nc2UgYXQKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VO\nU0UtMi4wCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBv\nciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJpYnV0\nZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFT\nIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElP\nTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAq\nIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdv\ndmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5kZXIg\ndGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbDsKCmltcG9ydCBqYXZhLnV0aWwuTG9jYWxlOwppbXBvcnQgamF2\nYS51dGlsLk1pc3NpbmdSZXNvdXJjZUV4Y2VwdGlvbjsKCmltcG9ydCBqdW5p\ndC5mcmFtZXdvcmsuVGVzdDsKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0\nQ2FzZTsKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0U3VpdGU7CmltcG9y\ndCBqdW5pdC50ZXh0dWkuVGVzdFJ1bm5lcjsKCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyLk1lc3NhZ2U7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwudGVzdGxvY2FsaXplci5Mb2Nh\nbGl6ZXJUZXN0SGVscGVyOwoKLyoqCiAqIFRlc3RzIHRoZSBMb2NhbGl6ZXIu\nCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgVGVz\ndExvY2FsaXplciBleHRlbmRzIFRlc3RDYXNlIHsKCiAgICBwcml2YXRlIExv\nY2FsaXplciBfbG9jYWxzID0gbnVsbDsKCiAgICBwdWJsaWMgVGVzdExvY2Fs\naXplcihTdHJpbmcgdGVzdCkgewogICAgICAgIHN1cGVyKHRlc3QpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIF9sb2NhbHMg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShMb2NhbGl6ZXJUZXN0SGVscGVyLmNs\nYXNzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgZ2V0dGluZyBhIHN0\ncmluZyBmb3IgYSBjbGFzcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVz\ndEZvckNsYXNzKCkgewogICAgICAgIGFzc2VydEVxdWFscyhMb2NhbGUuZ2V0\nRGVmYXVsdCgpLmVxdWFscyhMb2NhbGUuR0VSTUFOWSkKICAgICAgICAgICAg\nPyAidmFsdWUxX2RlIiA6ICJ2YWx1ZTEiLCBfbG9jYWxzLmdldCgidGVzdC5s\nb2NhbDEiKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IGdldHRpbmcg\nYSBzdHJpbmcgZm9yIGEgbm9uLWRlZmF1bHQgbG9jYWxlLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0Rm9yTG9jYWxlKCkgewogICAgICAgIExvY2Fs\naXplciBsb2NsID0gTG9jYWxpemVyLmZvclBhY2thZ2UoTG9jYWxpemVyVGVz\ndEhlbHBlci5jbGFzcywKICAgICAgICAgICAgTG9jYWxlLkdFUk1BTlkpOwog\nICAgICAgIGFzc2VydEVxdWFscygidmFsdWUxX2RlIiwgbG9jbC5nZXQoInRl\nc3QubG9jYWwxIikpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdHMgdGhh\ndCBpZiBhIGxvY2FsZSBpcyBtaXNzaW5nIHRoZSBzeXN0ZW0gZmFsbHMgYmFj\nayB0byB0aGUgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVz\ndEZhbGxiYWNrTG9jYWxlKCkgewogICAgICAgIExvY2FsaXplciBsb2NsID0g\nTG9jYWxpemVyLmZvclBhY2thZ2UoTG9jYWxpemVyVGVzdEhlbHBlci5jbGFz\ncywKICAgICAgICAgICAgTG9jYWxlLkZSQU5DRSk7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKExvY2FsZS5nZXREZWZhdWx0KCkuZXF1YWxzKExvY2FsZS5HRVJN\nQU5ZKQogICAgICAgICAgICA/ICJ2YWx1ZTFfZGUiIDogInZhbHVlMSIsIGxv\nY2wuZ2V0KCJ0ZXN0LmxvY2FsMSIpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRlc3RzIHRoYXQgYSBudWxsIGNsYXNzIGFjY2Vzc2VzIHRoZSBsb2NhbGl6\nZXIucHJvcGVydGllcyBmaWxlCiAgICAgKiBmb3IgdGhlIHRvcC1sZXZlbChu\nbyBwYWNrYWdlKS4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdFRvcExl\ndmVsKCkgewogICAgICAgIExvY2FsaXplciBzeXN0ZW0gPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZShudWxsKTsKICAgICAgICBhc3NlcnRFcXVhbHMoInN5c3Rl\nbXZhbHVlMSIsIHN5c3RlbS5nZXQoInRlc3Quc3lzdGVtbG9jYWwiKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgdGhlIG1lc3NhZ2UgZm9y\nbWF0dGluZyB3b3JrcyBjb3JyZWN0bHkuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHRlc3RNZXNzYWdlRm9ybWF0KCkgewogICAgICAgIFN0cmluZyBzdWZm\naXggPSBMb2NhbGUuZ2V0RGVmYXVsdCgpLmVxdWFscyhMb2NhbGUuR0VSTUFO\nWSkgPyAiX2RlIiA6ICIiOwoKICAgICAgICBhc3NlcnRFcXVhbHMoInZhbHVl\nMiIgKyBzdWZmaXggKyAiIHggc2VwIHkiLCBfbG9jYWxzLmdldCgidGVzdC5s\nb2NhbDIiLAogICAgICAgICAgICBuZXcgU3RyaW5nW117ICJ4IiwgInkiIH0p\nKTsKCiAgICAgICAgLy8gdGVzdCB0aGF0IGl0IHRyZWF0ZXMgc2luZ2xlIG9i\namVjdHMgYXMgc2luZ2xlLWVsZW1lbnQgYXJyYXlzCiAgICAgICAgYXNzZXJ0\nRXF1YWxzKCJ2YWx1ZTIiICsgc3VmZml4ICsgIiB4IHNlcCB7MX0iLAogICAg\nICAgICAgICBfbG9jYWxzLmdldCgidGVzdC5sb2NhbDIiLCAieCIpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRlc3QgdGhhdCBhIHtAbGluayBNaXNzaW5n\nUmVzb3VyY2VFeGNlcHRpb259IGlzIHRocm93biBmb3IgbWlzc2luZwogICAg\nICogcmVzb3VyY2UgYnVuZGxlcy4KICAgICAqLwogICAgcHVibGljIHZvaWQg\ndGVzdE1pc3NpbmdCdW5kbGUoKSB7CiAgICAgICAgTG9jYWxpemVyIG1pc3Np\nbmcgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShTdHJpbmcuY2xhc3MpOwogICAg\nICAgIGFzc2VydEVxdWFscygiZm9vLmJhciIsIG1pc3NpbmcuZ2V0KCJmb28u\nYmFyIikpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1pc3NpbmcuZ2V0\nRmF0YWwoImZvby5iYXIiKTsKICAgICAgICAgICAgZmFpbCgiTm8gZXhjZXB0\naW9uIGZvciBmYXRhbCBnZXQgb24gbWlzc2luZyBidW5kbGUuIik7CiAgICAg\nICAgfSBjYXRjaCAoTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uIG1yZSkgewog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgdGhhdCBhIHtA\nbGluayBNaXNzaW5nUmVzb3VyY2VFeGNlcHRpb259IGlzIHRocm93biBmb3Ig\nbWlzc2luZyBrZXlzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWlz\nc2luZ0tleSgpIHsKICAgICAgICBhc3NlcnRFcXVhbHMoImZvby5iYXIiLCBf\nbG9jYWxzLmdldCgiZm9vLmJhciIpKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBfbG9jYWxzLmdldEZhdGFsKCJmb28uYmFyIik7CiAgICAgICAgICAg\nIGZhaWwoIk5vIGV4Y2VwdGlvbiBmb3IgZmF0YWwgZ2V0IG9uIG1pc3Npbmcg\na2V5LiIpOwogICAgICAgIH0gY2F0Y2ggKE1pc3NpbmdSZXNvdXJjZUV4Y2Vw\ndGlvbiBtcmUpIHsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1YmxpYyBz\ndGF0aWMgdm9pZCBhc3NlcnRFcXVhbHMoU3RyaW5nIHMsIE1lc3NhZ2UgbSkg\newogICAgICAgIGFzc2VydEVxdWFscyhzLCBtLmdldE1lc3NhZ2UoKSk7CiAg\nICB9CgogICAgcHVibGljIHN0YXRpYyBUZXN0IHN1aXRlKCkgewogICAgICAg\nIHJldHVybiBuZXcgVGVzdFN1aXRlKFRlc3RMb2NhbGl6ZXIuY2xhc3MpOwog\nICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFy\nZ3MpIHsKICAgICAgICBUZXN0UnVubmVyLnJ1bihzdWl0ZSgpKTsKICAgIH0K\nfQo=\n","encoding":"base64"}

