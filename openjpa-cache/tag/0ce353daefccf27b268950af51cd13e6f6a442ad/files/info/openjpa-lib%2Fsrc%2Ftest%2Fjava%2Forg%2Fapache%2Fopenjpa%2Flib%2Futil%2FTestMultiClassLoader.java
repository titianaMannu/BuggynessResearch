{"sha":"5bbc0a67c512fff6988d906b11ed58092043a1b4","node_id":"MDQ6QmxvYjIwNjM2NDo1YmJjMGE2N2M1MTJmZmY2OTg4ZDkwNmIxMWVkNTgwOTIwNDNhMWI0","size":5006,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5bbc0a67c512fff6988d906b11ed58092043a1b4","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNl\nLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90\nIHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUg\nTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNl\nbnNlIGF0CiAqICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElD\nRU5TRS0yLjAKICogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxh\ndyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJp\nYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4g\nIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJ\nVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQu\nCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdl\nIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5k\nZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbDsKCmltcG9ydCBqYXZhLm5ldC5VUkw7CgppbXBvcnQganVu\naXQuZnJhbWV3b3JrLlRlc3Q7CmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVz\ndENhc2U7CmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdFN1aXRlOwppbXBv\ncnQganVuaXQudGV4dHVpLlRlc3RSdW5uZXI7CgovKioKICogVGVzdHMgdGhl\nIHtAbGluayBNdWx0aUNsYXNzTG9hZGVyfS4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICovCnB1YmxpYyBjbGFzcyBUZXN0TXVsdGlDbGFzc0xvYWRlciBl\neHRlbmRzIFRlc3RDYXNlIHsKCiAgICBwcml2YXRlIENsYXNzTG9hZGVyIFNZ\nU1RFTV9MT0FERVIgPSBNdWx0aUNsYXNzTG9hZGVyLmNsYXNzLmdldENsYXNz\nTG9hZGVyKCk7CgogICAgcHJpdmF0ZSBNdWx0aUNsYXNzTG9hZGVyIF9sb2Fk\nZXIgPSBuZXcgTXVsdGlDbGFzc0xvYWRlcigpOwoKICAgIHB1YmxpYyBUZXN0\nTXVsdGlDbGFzc0xvYWRlcihTdHJpbmcgdGVzdCkgewogICAgICAgIHN1cGVy\nKHRlc3QpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAg\nICAgIF9sb2FkZXIuYWRkQ2xhc3NMb2FkZXIoTXVsdGlDbGFzc0xvYWRlci5U\nSFJFQURfTE9BREVSKTsKICAgICAgICBfbG9hZGVyLmFkZENsYXNzTG9hZGVy\nKFNZU1RFTV9MT0FERVIpOwogICAgfQoKICAgIC8qKgogICAgICogVGVzdHMg\nYmFzaWMgYWRkL3JlbW92ZSBmdW5jdGlvbmFsaXR5LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0QmFzaWMoKSB7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDIsIF9sb2FkZXIuc2l6ZSgpKTsKICAgICAgICBhc3NlcnRUcnVlKCFfbG9h\nZGVyLmlzRW1wdHkoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShfbG9hZGVyLmdl\ndENsYXNzTG9hZGVycygpWzBdID09IFNZU1RFTV9MT0FERVIpOwogICAgICAg\nIGFzc2VydEVxdWFscyhUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRl\neHRDbGFzc0xvYWRlcigpLAogICAgICAgICAgICBfbG9hZGVyLmdldENsYXNz\nTG9hZGVycygpWzFdKTsKICAgICAgICBhc3NlcnRUcnVlKF9sb2FkZXIuZ2V0\nQ2xhc3NMb2FkZXIoMCkgPT0gU1lTVEVNX0xPQURFUik7CiAgICAgICAgYXNz\nZXJ0VHJ1ZSghX2xvYWRlci5hZGRDbGFzc0xvYWRlcihfbG9hZGVyLlRIUkVB\nRF9MT0FERVIpKTsKCiAgICAgICAgRm9vTG9hZGVyIGZvbyA9IG5ldyBGb29M\nb2FkZXIoKTsKICAgICAgICBhc3NlcnRUcnVlKF9sb2FkZXIuYWRkQ2xhc3NM\nb2FkZXIoZm9vKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSghX2xvYWRlci5hZGRD\nbGFzc0xvYWRlcihmb28pKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMywgX2xv\nYWRlci5zaXplKCkpOwogICAgICAgIGFzc2VydEVxdWFscyhmb28sIF9sb2Fk\nZXIuZ2V0Q2xhc3NMb2FkZXJzKClbMl0pOwoKICAgICAgICBhc3NlcnRUcnVl\nKF9sb2FkZXIucmVtb3ZlQ2xhc3NMb2FkZXIoX2xvYWRlci5USFJFQURfTE9B\nREVSKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSghX2xvYWRlci5yZW1vdmVDbGFz\nc0xvYWRlcihfbG9hZGVyLlRIUkVBRF9MT0FERVIpKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMiwgX2xvYWRlci5zaXplKCkpOwogICAgICAgIGFzc2VydFRy\ndWUoX2xvYWRlci5nZXRDbGFzc0xvYWRlcnMoKVswXSA9PSBTWVNURU1fTE9B\nREVSKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZm9vLCBfbG9hZGVyLmdldENs\nYXNzTG9hZGVycygpWzFdKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZShfbG9hZGVy\nLnJlbW92ZUNsYXNzTG9hZGVyKGZvbykpOwogICAgICAgIGFzc2VydFRydWUo\nX2xvYWRlci5yZW1vdmVDbGFzc0xvYWRlcihTWVNURU1fTE9BREVSKSk7CiAg\nICAgICAgYXNzZXJ0VHJ1ZShfbG9hZGVyLmlzRW1wdHkoKSk7CgogICAgICAg\nIE11bHRpQ2xhc3NMb2FkZXIgbG9hZGVyMiA9IG5ldyBNdWx0aUNsYXNzTG9h\nZGVyKCk7CiAgICAgICAgbG9hZGVyMi5hZGRDbGFzc0xvYWRlcihNdWx0aUNs\nYXNzTG9hZGVyLlRIUkVBRF9MT0FERVIpOwogICAgICAgIGxvYWRlcjIuYWRk\nQ2xhc3NMb2FkZXIoU1lTVEVNX0xPQURFUik7CiAgICAgICAgYXNzZXJ0VHJ1\nZShfbG9hZGVyLmFkZENsYXNzTG9hZGVycyhsb2FkZXIyKSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZSghX2xvYWRlci5hZGRDbGFzc0xvYWRlcnMobG9hZGVyMikp\nOwogICAgICAgIEZvb0xvYWRlciBmb28yID0gbmV3IEZvb0xvYWRlcigpOwog\nICAgICAgIGxvYWRlcjIuYWRkQ2xhc3NMb2FkZXIoZm9vKTsKICAgICAgICBs\nb2FkZXIyLmFkZENsYXNzTG9hZGVyKGZvbzIpOwogICAgICAgIGFzc2VydFRy\ndWUoX2xvYWRlci5hZGRDbGFzc0xvYWRlcnMoMSwgbG9hZGVyMikpOwogICAg\nICAgIENsYXNzTG9hZGVyW10gbG9hZGVycyA9IF9sb2FkZXIuZ2V0Q2xhc3NM\nb2FkZXJzKCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShsb2FkZXJzWzBdID09IFNZ\nU1RFTV9MT0FERVIpOwogICAgICAgIGFzc2VydEVxdWFscyhUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRlcigpLAogICAgICAg\nICAgICBsb2FkZXJzWzNdKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZm9vLCBs\nb2FkZXJzWzFdKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZm9vMiwgbG9hZGVy\nc1syXSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IGZpbmRpbmcgY2xh\nc3Nlcy4KICAgICAqLwovKgogcHVibGljIHZvaWQgdGVzdENsYXNzRm9yTmFt\nZSgpCiB0aHJvd3MgRXhjZXB0aW9uCiB7CiBhc3NlcnRFcXVhbHMoTXVsdGlD\nbGFzc0xvYWRlci5jbGFzcywKIENsYXNzLmZvck5hbWUoTXVsdGlDbGFzc0xv\nYWRlci5jbGFzcy5nZXROYW1lKCksIHRydWUsIF9sb2FkZXIpKTsKIGFzc2Vy\ndFRydWUoX2xvYWRlci5yZW1vdmVDbGFzc0xvYWRlcihTWVNURU1fTE9BREVS\nKSk7CiBhc3NlcnRUcnVlKF9sb2FkZXIucmVtb3ZlQ2xhc3NMb2FkZXIoTXVs\ndGlDbGFzc0xvYWRlci5USFJFQURfTE9BREVSKSk7CiB0cnkKIHsKIC8vIGhh\ndmUgdG8gc3dpdGNoIGNsYXNzZXMgaGVyZSBiL2Mgb3RoZXIgaXMgbm93IGNh\nY2hlZAogYXNzZXJ0RXF1YWxzKFRlc3RNdWx0aUNsYXNzTG9hZGVyLmNsYXNz\nLCBDbGFzcy5mb3JOYW1lCiAoVGVzdE11bHRpQ2xhc3NMb2FkZXIuY2xhc3Mu\nZ2V0TmFtZSgpLCB0cnVlLCBfbG9hZGVyKSk7CiBmYWlsKCJTeXN0ZW0gY2xh\nc3MgbGFvZGVyIHN0aWxsIHdvcmtpbmcuIik7CiB9IGNhdGNoIChDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uIGNuZmUpCiB7CiB9CiB0cnkKIHsKIENsYXNzLmZv\nck5hbWUoImZvbyIsIHRydWUsIF9sb2FkZXIpOwogZmFpbCgiU29tZWhvdyBm\nb3VuZCAnZm9vJz8/PyIpOwogfSBjYXRjaCAoQ2xhc3NOb3RGb3VuZEV4Y2Vw\ndGlvbiBjbmZlKQogewogfQogX2xvYWRlci5hZGRDbGFzc0xvYWRlcihuZXcg\nRm9vTG9hZGVyKCkpOwogYXNzZXJ0RXF1YWxzKEludGVnZXIuY2xhc3MsIENs\nYXNzLmZvck5hbWUoImZvbyIsIHRydWUsIF9sb2FkZXIpKTsKIH0KKi8KCiAg\nICAvKioKICAgICAqIFRlc3QgZmluZGluZyByZXNvdXJjZXMuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHRlc3RHZXRSZXNvdXJjZSgpIHsKICAgICAgICBh\nc3NlcnROdWxsKF9sb2FkZXIuZ2V0UmVzb3VyY2UoImZvbyIpKTsKICAgICAg\nICBfbG9hZGVyLmFkZENsYXNzTG9hZGVyKG5ldyBGb29Mb2FkZXIoKSk7CiAg\nICAgICAgYXNzZXJ0Tm90TnVsbChfbG9hZGVyLmdldFJlc291cmNlKCJmb28i\nKSk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyBUZXN0IHN1aXRlKCkgewog\nICAgICAgIHJldHVybiBuZXcgVGVzdFN1aXRlKFRlc3RNdWx0aUNsYXNzTG9h\nZGVyLmNsYXNzKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFp\nbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgVGVzdFJ1bm5lci5ydW4oc3Vp\ndGUoKSk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgY2xhc3Mg\nRm9vTG9hZGVyIGV4dGVuZHMgQ2xhc3NMb2FkZXIgewoKICAgICAgICBwcm90\nZWN0ZWQgQ2xhc3MgZmluZENsYXNzKFN0cmluZyBuYW1lKSB0aHJvd3MgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmICgiZm9vIi5l\ncXVhbHMobmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci5j\nbGFzczsKICAgICAgICAgICAgdGhyb3cgbmV3IENsYXNzTm90Rm91bmRFeGNl\ncHRpb24obmFtZSk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgVVJM\nIGZpbmRSZXNvdXJjZShTdHJpbmcgbmFtZSkgewogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgaWYgKCJmb28iLmVxdWFscyhuYW1lKSkKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVSTCgiZmlsZTovLy9kZXYv\nbnVsbCIpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIH0KICAgIH0KfQo=\n","encoding":"base64"}

