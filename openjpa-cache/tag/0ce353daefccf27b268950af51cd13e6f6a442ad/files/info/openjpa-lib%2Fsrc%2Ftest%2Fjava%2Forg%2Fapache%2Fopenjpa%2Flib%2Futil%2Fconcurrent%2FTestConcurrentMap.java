{"sha":"b6a686bea91041c77ed91b8e240929d787996b48","node_id":"MDQ6QmxvYjIwNjM2NDpiNmE2ODZiZWE5MTA0MWM3N2VkOTFiOGUyNDA5MjlkNzg3OTk2YjQ4","size":4925,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b6a686bea91041c77ed91b8e240929d787996b48","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNl\nLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90\nIHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUg\nTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNl\nbnNlIGF0CiAqICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElD\nRU5TRS0yLjAKICogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxh\ndyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJp\nYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4g\nIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJ\nVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQu\nCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdl\nIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5k\nZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5jb25jdXJyZW50OwoKaW1wb3J0IGphdmEudXRpbC5BcnJh\neUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBq\nYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBv\ncnQgamF2YS51dGlsLlRyZWVTZXQ7CgppbXBvcnQganVuaXQuZnJhbWV3b3Jr\nLlRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLlJlZmVyZW5jZU1hcDsKCi8qKgogKiBUZXN0cyB0aGUgbWV0aG9kcyBvZiB7\nQGxpbmsgQ29uY3VycmVudE1hcH0uCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRl\nCiAqLwpwdWJsaWMgY2xhc3MgVGVzdENvbmN1cnJlbnRNYXAgZXh0ZW5kcyBU\nZXN0Q2FzZSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IEVOVFJJ\nRVMgPSAzMzM7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgU0xFRVAg\nPSAzOwoKICAgIHByaXZhdGUgQ29uY3VycmVudE1hcFtdIF9tYXBzID0gbmV3\nIENvbmN1cnJlbnRNYXBbXXsKICAgICAgICBuZXcgQ29uY3VycmVudEhhc2hN\nYXAoKSwKICAgICAgICBuZXcgQ29uY3VycmVudFJlZmVyZW5jZUhhc2hNYXAo\nUmVmZXJlbmNlTWFwLkhBUkQsIFJlZmVyZW5jZU1hcC5IQVJEKSwgfTsKCiAg\nICBwdWJsaWMgdm9pZCBzZXRVcCgpIHsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IEVOVFJJRVM7IGkrKykgewogICAgICAgICAgICBmb3IgKGludCBq\nID0gMDsgaiA8IF9tYXBzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAg\nICBpbnQga2V5ID0gaiAqIEVOVFJJRVMgKyBpOwogICAgICAgICAgICAgICAg\nX21hcHNbal0ucHV0KG5ldyBJbnRlZ2VyKGtleSksICJ2IiArIGtleSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFJlbW92ZVJhbmRvbSgpIHsKICAgICAgICBTZXQga2V5cyA9IG5ldyBU\ncmVlU2V0KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBFTlRSSUVT\nOyBpKyspCiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgX21hcHMu\nbGVuZ3RoOyBqKyspCiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKHJlbW92\nZVJhbmRvbShfbWFwc1tqXSwga2V5cykpOwogICAgICAgIHBvc3RSZW1vdmVU\nZXN0KGtleXMpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\ncmVtb3ZlUmFuZG9tKENvbmN1cnJlbnRNYXAgbWFwLCBTZXQga2V5cykgewog\nICAgICAgIE1hcC5FbnRyeSByZW0gPSBtYXAucmVtb3ZlUmFuZG9tKCk7CiAg\nICAgICAgcmV0dXJuIHJlbSAhPSBudWxsICYmIHJlbS5nZXRWYWx1ZSgpLmVx\ndWFscygidiIgKyByZW0uZ2V0S2V5KCkpCiAgICAgICAgICAgICYmIGtleXMu\nYWRkKHJlbS5nZXRLZXkoKSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHBv\nc3RSZW1vdmVUZXN0KFNldCBrZXlzKSB7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfbWFwcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhc3Nl\ncnRUcnVlKF9tYXBzW2ldLmlzRW1wdHkoKSk7CiAgICAgICAgICAgIGFzc2Vy\ndFRydWUoIV9tYXBzW2ldLmNvbnRhaW5zS2V5KG5ldyBJbnRlZ2VyKEVOVFJJ\nRVMgKiBpICsgaSkpKTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKGtleXMudG9TdHJpbmcoKSwgRU5UUklFUyAqIF9tYXBzLmxlbmd0aCwga2V5\ncy5zaXplKCkpOwogICAgfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9p\nZCB0ZXN0UmVtb3ZlUmFuZG9tVGhyZWFkZWQoKQogICAgICAgIHRocm93cyBJ\nbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgU2V0IGtleXMgPSBDb2xs\nZWN0aW9ucy5zeW5jaHJvbml6ZWRTZXQobmV3IFRyZWVTZXQoKSk7CiAgICAg\nICAgUmVtb3ZlUmFuZG9tUnVubmFibGVbXSBydW5zID0KICAgICAgICAgICAg\nbmV3IFJlbW92ZVJhbmRvbVJ1bm5hYmxlW0VOVFJJRVMgKiBfbWFwcy5sZW5n\ndGhdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgRU5UUklFUzsgaSsr\nKQogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IF9tYXBzLmxlbmd0\naDsgaisrKQogICAgICAgICAgICAgICAgcnVuc1tqICogRU5UUklFUyArIGld\nID0gbmV3IFJlbW92ZVJhbmRvbVJ1bm5hYmxlCiAgICAgICAgICAgICAgICAg\nICAgKF9tYXBzW2pdLCBrZXlzKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHJ1bnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIG5ldyBUaHJlYWQo\ncnVuc1tpXSkuc3RhcnQoKTsKICAgICAgICBUaHJlYWQuY3VycmVudFRocmVh\nZCgpLnNsZWVwKFNMRUVQICogRU5UUklFUyAqIF9tYXBzLmxlbmd0aCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBydW5zLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGFzc2VydFRydWUoU3RyaW5nLnZhbHVlT2YoaSksICFy\ndW5zW2ldLmVycm9yKTsKICAgICAgICAgICAgaWYgKHJ1bnNbaV0uaW50ZXJy\ndXB0ZWQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJydXB0ZWRF\neGNlcHRpb24oU3RyaW5nLnZhbHVlT2YoaSkpOwogICAgICAgIH0KICAgICAg\nICBwb3N0UmVtb3ZlVGVzdChrZXlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0SXRlcmF0ZSgpIHsKICAgICAgICBpdGVyYXRpb25UZXN0KGZhbHNl\nKTsKICAgIH0KCiAgICBwcml2YXRlIExpc3QgaXRlcmF0aW9uVGVzdChib29s\nZWFuIHJhbmRvbSkgewogICAgICAgIFNldCBrZXlzID0gbmV3IFRyZWVTZXQo\nKTsKICAgICAgICBMaXN0IG9yZGVyZWQgPSBuZXcgQXJyYXlMaXN0KDIwMCk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfbWFwcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBJdGVyYXRvciBpdHIgPSAocmFuZG9tKSA/IF9t\nYXBzW2ldLnJhbmRvbUVudHJ5SXRlcmF0b3IoKQogICAgICAgICAgICAgICAg\nOiBfbWFwc1tpXS5lbnRyeVNldCgpLml0ZXJhdG9yKCk7CiAgICAgICAgICAg\nIHdoaWxlIChpdHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAgICBNYXAu\nRW50cnkgZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJ2IiArIGVudHJ5LmdldEtleSgpLCBl\nbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUo\na2V5cyArICI6OiAiICsgX21hcHNbaV0uZ2V0Q2xhc3MoKSArICI6OiIKICAg\nICAgICAgICAgICAgICAgICArIGVudHJ5LmdldEtleSgpICsgIjo6IiArIGVu\ndHJ5LmdldFZhbHVlKCksCiAgICAgICAgICAgICAgICAgICAga2V5cy5hZGQo\nZW50cnkuZ2V0S2V5KCkpKTsKICAgICAgICAgICAgICAgIG9yZGVyZWQuYWRk\nKGVudHJ5LmdldEtleSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBhc3NlcnRFcXVhbHMoa2V5cy50b1N0cmluZygpLCBFTlRSSUVTICog\nX21hcHMubGVuZ3RoLCBrZXlzLnNpemUoKSk7CiAgICAgICAgcmV0dXJuIG9y\nZGVyZWQ7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFJhbmRvbUl0ZXJh\ndGUoKSB7CiAgICAgICAgTGlzdCBsMSA9IGl0ZXJhdGlvblRlc3QodHJ1ZSk7\nCiAgICAgICAgTGlzdCBsMiA9IGl0ZXJhdGlvblRlc3QodHJ1ZSk7CiAgICAg\nICAgYXNzZXJ0VHJ1ZSghbDEuZXF1YWxzKGwyKSk7CiAgICB9CgogICAgcHJp\ndmF0ZSBzdGF0aWMgY2xhc3MgUmVtb3ZlUmFuZG9tUnVubmFibGUgaW1wbGVt\nZW50cyBSdW5uYWJsZSB7CgogICAgICAgIHB1YmxpYyBib29sZWFuIGVycm9y\nID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW50ZXJydXB0ZWQg\nPSBmYWxzZTsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDb25jdXJyZW50TWFw\nIF9tYXA7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTZXQgX2tleXM7CgogICAg\nICAgIHB1YmxpYyBSZW1vdmVSYW5kb21SdW5uYWJsZShDb25jdXJyZW50TWFw\nIG1hcCwgU2V0IGtleXMpIHsKICAgICAgICAgICAgX21hcCA9IG1hcDsKICAg\nICAgICAgICAgX2tleXMgPSBrZXlzOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHN5bmNocm9uaXplZCB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2xl\nZXAoKGxvbmcpIChNYXRoLnJhbmRvbSgpICogU0xFRVApKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAg\nICAgICAgICAgIGludGVycnVwdGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBlcnJvciA9ICFyZW1vdmVSYW5kb20oX21hcCwgX2tleXMp\nOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

