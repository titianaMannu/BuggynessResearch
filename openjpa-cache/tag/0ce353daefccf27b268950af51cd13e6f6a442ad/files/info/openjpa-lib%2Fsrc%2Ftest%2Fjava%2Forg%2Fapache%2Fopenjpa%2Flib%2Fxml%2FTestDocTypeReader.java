{"sha":"21fff2124c56b9d0983cd120de88ddedb4f6eb3c","node_id":"MDQ6QmxvYjIwNjM2NDoyMWZmZjIxMjRjNTZiOWQwOTgzY2QxMjBkZTg4ZGRlZGI0ZjZlYjNj","size":7713,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/21fff2124c56b9d0983cd120de88ddedb4f6eb3c","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNl\nLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqIHlvdSBtYXkgbm90\nIHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUg\nTGljZW5zZS4KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNl\nbnNlIGF0CiAqICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElD\nRU5TRS0yLjAKICogIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxh\ndyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJp\nYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4g\nIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJ\nVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQu\nCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdl\nIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5k\nZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIueG1sOwoKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLlJlYWRlcjsKaW1wb3J0IGphdmEuaW8uU3RyaW5nUmVhZGVy\nOwppbXBvcnQgamF2YS5pby5TdHJpbmdXcml0ZXI7CmltcG9ydCBqYXZhLmlv\nLldyaXRlcjsKaW1wb3J0IGphdmF4LnhtbC5wYXJzZXJzLlNBWFBhcnNlcjsK\nCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdDsKaW1wb3J0IGp1bml0LmZy\nYW1ld29yay5UZXN0Q2FzZTsKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0\nU3VpdGU7CmltcG9ydCBqdW5pdC50ZXh0dWkuVGVzdFJ1bm5lcjsKaW1wb3J0\nIG9yZy54bWwuc2F4LklucHV0U291cmNlOwppbXBvcnQgb3JnLnhtbC5zYXgu\nU0FYRXhjZXB0aW9uOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYUGFyc2VFeGNl\ncHRpb247CmltcG9ydCBvcmcueG1sLnNheC5oZWxwZXJzLkRlZmF1bHRIYW5k\nbGVyOwoKLyoqCiAqIFRlc3RzIHRoZSB7QGxpbmsgRG9jVHlwZVJlYWRlcn0g\nYnkgY29tcGFyaW5nIHRoZSByZXN1bHRzIG9mIHBhc3NpbmcKICogdmFyaW91\ncyB4bWwgc3RyZWFtcyB0byB0aGUgZXhwZWN0ZWQgcmVzdWx0IHdpdGggaW5j\nbHVkZWQgZG9jIHR5cGUgaW5mby4KICoKICogQGF1dGhvciBBYmUgV2hpdGUK\nICovCnB1YmxpYyBjbGFzcyBUZXN0RG9jVHlwZVJlYWRlciBleHRlbmRzIFRl\nc3RDYXNlIHsKCiAgICBwcml2YXRlIFN0cmluZyBfZG9jVHlwZSA9IG51bGw7\nCiAgICBwcml2YXRlIFN0cmluZyBfdmFsaWRYTUwgPSBudWxsOwogICAgcHJp\ndmF0ZSBTdHJpbmcgX2ludmFsaWRYTUwgPSBudWxsOwogICAgcHJpdmF0ZSBT\ndHJpbmcgX2V4cGVjdGVkWE1MID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5n\nIF92YWxpZEhUTUwgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2V4cGVj\ndGVkSFRNTCA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfeG1sV2l0aERv\nY1R5cGUgPSBudWxsOwoKICAgIHB1YmxpYyBUZXN0RG9jVHlwZVJlYWRlcihT\ndHJpbmcgdGVzdCkgewogICAgICAgIHN1cGVyKHRlc3QpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIFN0cmluZ0J1ZmZlciBk\nb2NUeXBlID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIGRvY1R5cGUu\nYXBwZW5kKCI8IURPQ1RZUEUgZm9vIFtcbiIpOwogICAgICAgIGRvY1R5cGUu\nYXBwZW5kKCJcdDwhRUxFTUVOVCBmb28gKGJhcik+XG4iKTsKICAgICAgICBk\nb2NUeXBlLmFwcGVuZCgiXHQ8IUVMRU1FTlQgYmFyIEVNUFRZPlxuIik7CiAg\nICAgICAgZG9jVHlwZS5hcHBlbmQoIlx0PCFBVFRMSVNUIGJhciBhdHRyIENE\nQVRBIFwidmFsdWVcIj5cbiIpOwogICAgICAgIGRvY1R5cGUuYXBwZW5kKCJc\ndDwhQVRUTElTVCBiYXIgYXR0cjIgQ0RBVEEgXCJ2YWx1ZTJcIj5cbiIpOwog\nICAgICAgIGRvY1R5cGUuYXBwZW5kKCJdPlxuIik7CiAgICAgICAgX2RvY1R5\ncGUgPSBkb2NUeXBlLnRvU3RyaW5nKCk7CgogICAgICAgIFN0cmluZ0J1ZmZl\nciBleHBlY3RlZFhNTCA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBT\ndHJpbmcgaGVhZGVyID0gIjw/eG1sIHZlcnNpb249XCIxLjBcIj8+XG4iOwog\nICAgICAgIFN0cmluZyBjb21tZW50ID0gIjwhLS0gc29tZSA8IC4uLiA+IDwh\nIGZ1bmt5IC0+IC0gY29tbWVudCAtLT5cbiI7CiAgICAgICAgZXhwZWN0ZWRY\nTUwuYXBwZW5kKGhlYWRlcik7CiAgICAgICAgZXhwZWN0ZWRYTUwuYXBwZW5k\nKGNvbW1lbnQpOwogICAgICAgIGV4cGVjdGVkWE1MLmFwcGVuZChkb2NUeXBl\nLnRvU3RyaW5nKCkpOwoKICAgICAgICBTdHJpbmdCdWZmZXIgeG1sV2l0aERv\nY1R5cGUgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgeG1sV2l0aERv\nY1R5cGUuYXBwZW5kKGhlYWRlcik7CiAgICAgICAgeG1sV2l0aERvY1R5cGUu\nYXBwZW5kKGNvbW1lbnQpOwogICAgICAgIHhtbFdpdGhEb2NUeXBlLmFwcGVu\nZChkb2NUeXBlLnRvU3RyaW5nKCkpOwoKICAgICAgICBTdHJpbmdCdWZmZXIg\ndmFsaWRYTUwgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgdmFsaWRY\nTUwuYXBwZW5kKCI8Zm9vPlxuIik7CiAgICAgICAgdmFsaWRYTUwuYXBwZW5k\nKCJcdDxiYXIgYXR0cj1cIm5ld1ZhbHVlXCIvPlxuIik7CiAgICAgICAgdmFs\naWRYTUwuYXBwZW5kKCI8L2Zvbz4iKTsKICAgICAgICBleHBlY3RlZFhNTC5h\ncHBlbmQodmFsaWRYTUwudG9TdHJpbmcoKSk7CiAgICAgICAgeG1sV2l0aERv\nY1R5cGUuYXBwZW5kKHZhbGlkWE1MLnRvU3RyaW5nKCkpOwogICAgICAgIF92\nYWxpZFhNTCA9IGhlYWRlciArIGNvbW1lbnQgKyB2YWxpZFhNTC50b1N0cmlu\nZygpOwogICAgICAgIF9leHBlY3RlZFhNTCA9IGV4cGVjdGVkWE1MLnRvU3Ry\naW5nKCk7CiAgICAgICAgX3htbFdpdGhEb2NUeXBlID0geG1sV2l0aERvY1R5\ncGUudG9TdHJpbmcoKTsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGludmFsaWRY\nTUwgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgaW52YWxpZFhNTC5h\ncHBlbmQoIjw/eG1sIHZlcnNpb249XCIxLjBcIj8+XG4iKTsKICAgICAgICBp\nbnZhbGlkWE1MLmFwcGVuZCgiPGZvbz5cbiIpOwogICAgICAgIGludmFsaWRY\nTUwuYXBwZW5kKCJcdDx4eHggLz5cbiIpOwogICAgICAgIGludmFsaWRYTUwu\nYXBwZW5kKCI8L2Zvbz4iKTsKICAgICAgICBfaW52YWxpZFhNTCA9IGludmFs\naWRYTUwudG9TdHJpbmcoKTsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGV4cGVj\ndGVkSFRNTCA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBoZWFkZXIg\nPSAiICAgXG4gICI7CiAgICAgICAgZXhwZWN0ZWRIVE1MLmFwcGVuZChoZWFk\nZXIpOwogICAgICAgIGV4cGVjdGVkSFRNTC5hcHBlbmQoZG9jVHlwZS50b1N0\ncmluZygpKTsKICAgICAgICBTdHJpbmdCdWZmZXIgdmFsaWRIVE1MID0gbmV3\nIFN0cmluZ0J1ZmZlcigpOwogICAgICAgIHZhbGlkSFRNTC5hcHBlbmQoInNv\nbWUganVuayA8aHRtbD48Ym9keT48L2JvZHk+PC9odG1sPiAgIik7CiAgICAg\nICAgZXhwZWN0ZWRIVE1MLmFwcGVuZCh2YWxpZEhUTUwudG9TdHJpbmcoKSk7\nCiAgICAgICAgX3ZhbGlkSFRNTCA9IGhlYWRlciArIHZhbGlkSFRNTC50b1N0\ncmluZygpOwogICAgICAgIF9leHBlY3RlZEhUTUwgPSBleHBlY3RlZEhUTUwu\ndG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgYWdhaW5z\ndCBleHBlY3RlZCBkb2MgdHlwZSBpbmNsdXNpb24gYmVoYXZpb3IuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RJbmNsdWRlc0RvY1R5cGUoKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIGFzc2VydEVxdWFscyhfdmFsaWRY\nTUwsIGdldEluY2x1ZGVkU3RyaW5nKF92YWxpZFhNTCwgbnVsbCwgMSkpOwog\nICAgICAgIGFzc2VydEVxdWFscyhfdmFsaWRYTUwsIGdldEluY2x1ZGVkU3Ry\naW5nKF92YWxpZFhNTCwgbnVsbCwgNykpOwogICAgICAgIGFzc2VydEVxdWFs\ncyhfdmFsaWRIVE1MLCBnZXRJbmNsdWRlZFN0cmluZyhfdmFsaWRIVE1MLCBu\ndWxsLCAxKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKF92YWxpZEhUTUwsIGdl\ndEluY2x1ZGVkU3RyaW5nKF92YWxpZEhUTUwsIG51bGwsIDcpKTsKCiAgICAg\nICAgYXNzZXJ0RXF1YWxzKF9leHBlY3RlZFhNTCwgZ2V0SW5jbHVkZWRTdHJp\nbmcoX3ZhbGlkWE1MLCBfZG9jVHlwZSwgMSkpOwogICAgICAgIGFzc2VydEVx\ndWFscyhfZXhwZWN0ZWRYTUwsIGdldEluY2x1ZGVkU3RyaW5nKF92YWxpZFhN\nTCwgX2RvY1R5cGUsIDcpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoX2V4cGVj\ndGVkSFRNTCwgZ2V0SW5jbHVkZWRTdHJpbmcKICAgICAgICAgICAgKF92YWxp\nZEhUTUwsIF9kb2NUeXBlLCAxKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKF9l\neHBlY3RlZEhUTUwsIGdldEluY2x1ZGVkU3RyaW5nCiAgICAgICAgICAgIChf\ndmFsaWRIVE1MLCBfZG9jVHlwZSwgNykpOwoKICAgICAgICBhc3NlcnRFcXVh\nbHMoIiAgICIsIGdldEluY2x1ZGVkU3RyaW5nKCIgICAiLCBfZG9jVHlwZSwg\nMSkpOwogICAgICAgIGFzc2VydEVxdWFscygiICAgIiwgZ2V0SW5jbHVkZWRT\ndHJpbmcoIiAgICIsIF9kb2NUeXBlLCA3KSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUZXN0IHRoYXQgdGhlIGRvYyB0eXBlIGRlY2xhcmF0aW9uIGlzIG5v\ndCBpbmNsdWRlZCBpbiBmaWxlcyB3aXRoCiAgICAgKiBkb2MgdHlwZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RTdHJlYW1XaXRoRG9jVHlwZSgp\nIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgYXNzZXJ0RXF1YWxzKF94\nbWxXaXRoRG9jVHlwZSwgZ2V0SW5jbHVkZWRTdHJpbmcKICAgICAgICAgICAg\nKF94bWxXaXRoRG9jVHlwZSwgbnVsbCwgMSkpOwogICAgICAgIGFzc2VydEVx\ndWFscyhfeG1sV2l0aERvY1R5cGUsIGdldEluY2x1ZGVkU3RyaW5nCiAgICAg\nICAgICAgIChfeG1sV2l0aERvY1R5cGUsIG51bGwsIDcpKTsKICAgICAgICBh\nc3NlcnRFcXVhbHMoX3htbFdpdGhEb2NUeXBlLCBnZXRJbmNsdWRlZFN0cmlu\nZwogICAgICAgICAgICAoX3htbFdpdGhEb2NUeXBlLCBfZG9jVHlwZSwgMSkp\nOwogICAgICAgIGFzc2VydEVxdWFscyhfeG1sV2l0aERvY1R5cGUsIGdldElu\nY2x1ZGVkU3RyaW5nCiAgICAgICAgICAgIChfeG1sV2l0aERvY1R5cGUsIF9k\nb2NUeXBlLCA3KSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIHJlc3VsdCBvZiBpbmNsdWRpbmcgdGhlIGdpdmVuIGRvYyB0eXBlIGRlY2xh\ncmF0aW9uIHdpdGhpbgogICAgICogdGhlIGdpdmVuIFhNTCBieSByZWFkaW5n\nIDxjb2RlPmJ1ZlNpemU8L2NvZGU+IGNoYXJzIGF0IGEgdGltZS4KICAgICAq\nLwogICAgcHJpdmF0ZSBTdHJpbmcgZ2V0SW5jbHVkZWRTdHJpbmcoU3RyaW5n\nIHhtbCwgU3RyaW5nIGRvY1R5cGUsIGludCBidWZTaXplKQogICAgICAgIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nUmVhZGVyIHhtbFJl\nYWRlciA9IG5ldyBTdHJpbmdSZWFkZXIoeG1sKTsKICAgICAgICBTdHJpbmdS\nZWFkZXIgZG9jUmVhZGVyID0gbnVsbDsKICAgICAgICBpZiAoZG9jVHlwZSAh\nPSBudWxsKQogICAgICAgICAgICBkb2NSZWFkZXIgPSBuZXcgU3RyaW5nUmVh\nZGVyKGRvY1R5cGUpOwoKICAgICAgICBXcml0ZXIgd3JpdGVyID0gbmV3IFN0\ncmluZ1dyaXRlcigpOwogICAgICAgIFJlYWRlciByZWFkZXIgPSBuZXcgRG9j\nVHlwZVJlYWRlcih4bWxSZWFkZXIsIGRvY1JlYWRlcik7CiAgICAgICAgaWYg\nKGJ1ZlNpemUgPT0gMSkKICAgICAgICAgICAgZm9yIChpbnQgY2ggPSByZWFk\nZXIucmVhZCgpOyBjaCAhPSAtMTsgY2ggPSByZWFkZXIucmVhZCgpKQogICAg\nICAgICAgICAgICAgd3JpdGVyLndyaXRlKChpbnQpIGNoKTsKICAgICAgICBl\nbHNlIHsKICAgICAgICAgICAgY2hhcltdIGNoOwogICAgICAgICAgICBpbnQg\ncmVhZDsKICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAg\nICAgIGNoID0gbmV3IGNoYXJbYnVmU2l6ZV07CiAgICAgICAgICAgICAgICBy\nZWFkID0gcmVhZGVyLnJlYWQoY2gpOwogICAgICAgICAgICAgICAgaWYgKHJl\nYWQgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICB3cml0ZXIud3JpdGUoY2gsIDAsIHJlYWQpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gd3JpdGVyLnRvU3RyaW5n\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHRoYXQgdmFsaWRhdGlv\nbiBvY2N1cnMgY29ycmVjdGx5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0\nZXN0VmFsaWRhdGlvbigpIHRocm93cyBJT0V4Y2VwdGlvbiwgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBTQVhQYXJzZXIgcGFyc2VyID0gWE1MRmFjdG9yeS5n\nZXRTQVhQYXJzZXIoZmFsc2UsIGZhbHNlKTsKICAgICAgICBJbnB1dFNvdXJj\nZSBzb3VyY2UgPSBuZXcgSW5wdXRTb3VyY2UoKTsKCiAgICAgICAgc291cmNl\nLnNldENoYXJhY3RlclN0cmVhbShuZXcgU3RyaW5nUmVhZGVyKF92YWxpZFhN\nTCkpOwogICAgICAgIHBhcnNlci5wYXJzZShzb3VyY2UsIG5ldyBIYW5kbGVy\nKCkpOwogICAgICAgIHNvdXJjZS5zZXRDaGFyYWN0ZXJTdHJlYW0obmV3IFN0\ncmluZ1JlYWRlcihfaW52YWxpZFhNTCkpOwogICAgICAgIHBhcnNlci5wYXJz\nZShzb3VyY2UsIG5ldyBIYW5kbGVyKCkpOwoKICAgICAgICBwYXJzZXIgPSBY\nTUxGYWN0b3J5LmdldFNBWFBhcnNlcih0cnVlLCBmYWxzZSk7CiAgICAgICAg\nc291cmNlLnNldENoYXJhY3RlclN0cmVhbShuZXcgRG9jVHlwZVJlYWRlcihu\nZXcgU3RyaW5nUmVhZGVyCiAgICAgICAgICAgIChfdmFsaWRYTUwpLCBuZXcg\nU3RyaW5nUmVhZGVyKF9kb2NUeXBlKSkpOwogICAgICAgIHBhcnNlci5wYXJz\nZShzb3VyY2UsIG5ldyBIYW5kbGVyKCkpOwoKICAgICAgICB0cnkgewogICAg\nICAgICAgICBzb3VyY2Uuc2V0Q2hhcmFjdGVyU3RyZWFtKG5ldyBEb2NUeXBl\nUmVhZGVyKG5ldyBTdHJpbmdSZWFkZXIKICAgICAgICAgICAgICAgIChfaW52\nYWxpZFhNTCksIG5ldyBTdHJpbmdSZWFkZXIoX2RvY1R5cGUpKSk7CiAgICAg\nICAgICAgIHBhcnNlci5wYXJzZShzb3VyY2UsIG5ldyBIYW5kbGVyKCkpOwog\nICAgICAgICAgICBmYWlsKCJQYXJzZWQgaW52YWxpZCBkb2N1bWVudCIpOwog\nICAgICAgIH0gY2F0Y2ggKFNBWEV4Y2VwdGlvbiBzZSkgewogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIFRlc3Qgc3VpdGUoKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBUZXN0U3VpdGUoVGVzdERvY1R5cGVSZWFkZXIuY2xh\nc3MpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmlu\nZ1tdIGFyZ3MpIHsKICAgICAgICBUZXN0UnVubmVyLnJ1bihzdWl0ZSgpKTsK\nICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBIYW5kbGVyIGV4dGVu\nZHMgRGVmYXVsdEhhbmRsZXIgewoKICAgICAgICBwdWJsaWMgdm9pZCBlcnJv\ncihTQVhQYXJzZUV4Y2VwdGlvbiBzcGUpIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgICAgICB0aHJvdyBzcGU7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBmYXRhbEVycm9yKFNBWFBhcnNlRXhjZXB0aW9uIHNwZSkg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRocm93IHNwZTsK\nICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

