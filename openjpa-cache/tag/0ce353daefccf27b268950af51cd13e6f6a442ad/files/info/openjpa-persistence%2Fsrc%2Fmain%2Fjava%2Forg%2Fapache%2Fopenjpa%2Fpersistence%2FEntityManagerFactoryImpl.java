{"sha":"2f6cb5a36b14a1b2682d1e19fd6b6387e08b9f2a","node_id":"MDQ6QmxvYjIwNjM2NDoyZjZjYjVhMzZiMTRhMWIyNjgyZDFlMTlmZDZiNjM4N2UwOGI5ZjJh","size":10861,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2f6cb5a36b14a1b2682d1e19fd6b6387e08b9f2a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBqYXZhLmxhbmcucmVmbGVj\ndC5Db25zdHJ1Y3RvcjsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lkludm9j\nYXRpb25UYXJnZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLmxhbmcucmVmbGVj\ndC5NZXRob2Q7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRM\naXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwu\nTWFwOwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CmltcG9ydCBqYXZh\nLnV0aWwuU2V0OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFu\nYWdlckZhY3Rvcnk7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYu\nT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLkF1dG9EZXRhY2g7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLkJyb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuQnJva2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuRGVsZWdhdGluZ0Jyb2tlckZhY3Rvcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLkRlbGVnYXRpbmdGZXRjaENvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZldGNo\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nY29uZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIuY29uZi5Qcm9kdWN0RGVyaXZhdGlvbnM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuSW1wbEhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBzZXJwLnV0\naWwuU3RyaW5nczsKCi8qKgogKiBJbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsg\nRW50aXR5TWFuYWdlckZhY3Rvcnl9IHRoYXQgYWN0cyBhcyBhCiAqIGZhY2Fk\nZSB0byBhIHtAbGluayBCcm9rZXJGYWN0b3J5fS4KICoKICogQGF1dGhvciBN\nYXJjIFBydWQnaG9tbWVhdXgKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNs\nYXNzIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbAogICAgaW1wbGVtZW50cyBP\ncGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgewoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2th\nZ2UKICAgICAgICAoRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsLmNsYXNzKTsK\nCiAgICBwcml2YXRlIERlbGVnYXRpbmdCcm9rZXJGYWN0b3J5IF9mYWN0b3J5\nID0gbnVsbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbnN0cnVjdG9yPEZl\ndGNoUGxhbj4gX3BsYW4gPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQg\nU3RvcmVDYWNoZSBfY2FjaGUgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2ll\nbnQgUXVlcnlSZXN1bHRDYWNoZSBfcXVlcnlDYWNoZSA9IG51bGw7CgogICAg\nLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIHByb3ZpZGVkIGZvciBh\ndXRvLWluc3RhbnRpYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBFbnRpdHlN\nYW5hZ2VyRmFjdG9yeUltcGwoKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\ndXBwbHkgZGVsZWdhdGUgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsKEJyb2tlckZhY3Rvcnkg\nZmFjdG9yeSkgewogICAgICAgIHNldEJyb2tlckZhY3RvcnkoZmFjdG9yeSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxlZ2F0ZS4KICAgICAqLwogICAg\ncHVibGljIEJyb2tlckZhY3RvcnkgZ2V0QnJva2VyRmFjdG9yeSgpIHsKICAg\nICAgICByZXR1cm4gX2ZhY3RvcnkuZ2V0RGVsZWdhdGUoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIERlbGVnYXRlIG11c3QgYmUgcHJvdmlkZWQgYmVmb3Jl\nIHVzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QnJva2VyRmFjdG9y\neShCcm9rZXJGYWN0b3J5IGZhY3RvcnkpIHsKICAgICAgICBfZmFjdG9yeSA9\nIG5ldyBEZWxlZ2F0aW5nQnJva2VyRmFjdG9yeShmYWN0b3J5LAogICAgICAg\nICAgICBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMuVFJBTlNMQVRPUik7CiAgICB9\nCgogICAgcHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3Vy\nYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9mYWN0b3J5LmdldENvbmZpZ3Vy\nYXRpb24oKTsKICAgIH0KCiAgICBwdWJsaWMgUHJvcGVydGllcyBnZXRQcm9w\nZXJ0aWVzKCkgewogICAgICAgIHJldHVybiBfZmFjdG9yeS5nZXRQcm9wZXJ0\naWVzKCk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBwdXRVc2VyT2JqZWN0\nKE9iamVjdCBrZXksIE9iamVjdCB2YWwpIHsKICAgICAgICByZXR1cm4gX2Zh\nY3RvcnkucHV0VXNlck9iamVjdChrZXksIHZhbCk7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBnZXRVc2VyT2JqZWN0KE9iamVjdCBrZXkpIHsKICAgICAg\nICByZXR1cm4gX2ZhY3RvcnkuZ2V0VXNlck9iamVjdChrZXkpOwogICAgfQoK\nICAgIHB1YmxpYyBTdG9yZUNhY2hlIGdldFN0b3JlQ2FjaGUoKSB7CiAgICAg\nICAgX2ZhY3RvcnkubG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGlmIChfY2FjaGUgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24gY29uZiA9IF9mYWN0b3J5LmdldENvbmZpZ3VyYXRp\nb24oKTsKICAgICAgICAgICAgICAgIF9jYWNoZSA9IG5ldyBTdG9yZUNhY2hl\nSW1wbCh0aGlzLAogICAgICAgICAgICAgICAgICAgIGNvbmYuZ2V0RGF0YUNh\nY2hlTWFuYWdlckluc3RhbmNlKCkuZ2V0U3lzdGVtRGF0YUNhY2hlKCkpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBfY2FjaGU7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2ZhY3RvcnkudW5sb2NrKCk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBTdG9yZUNhY2hlIGdldFN0\nb3JlQ2FjaGUoU3RyaW5nIGNhY2hlTmFtZSkgewogICAgICAgIHJldHVybiBu\nZXcgU3RvcmVDYWNoZUltcGwodGhpcywgX2ZhY3RvcnkuZ2V0Q29uZmlndXJh\ndGlvbigpLgogICAgICAgICAgICBnZXREYXRhQ2FjaGVNYW5hZ2VySW5zdGFu\nY2UoKS5nZXREYXRhQ2FjaGUoY2FjaGVOYW1lKSk7CiAgICB9CgogICAgcHVi\nbGljIFF1ZXJ5UmVzdWx0Q2FjaGUgZ2V0UXVlcnlSZXN1bHRDYWNoZSgpIHsK\nICAgICAgICBfZmFjdG9yeS5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgaWYgKF9xdWVyeUNhY2hlID09IG51bGwpCiAgICAgICAgICAgICAg\nICBfcXVlcnlDYWNoZSA9IG5ldyBRdWVyeVJlc3VsdENhY2hlSW1wbChfZmFj\ndG9yeS4KICAgICAgICAgICAgICAgICAgICBnZXRDb25maWd1cmF0aW9uKCku\nZ2V0RGF0YUNhY2hlTWFuYWdlckluc3RhbmNlKCkuCiAgICAgICAgICAgICAg\nICAgICAgZ2V0U3lzdGVtUXVlcnlDYWNoZSgpKTsKICAgICAgICAgICAgcmV0\ndXJuIF9xdWVyeUNhY2hlOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIF9mYWN0b3J5LnVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgT3BlbkpQQUVudGl0eU1hbmFnZXIgY3JlYXRlRW50aXR5TWFuYWdl\ncigpIHsKICAgICAgICByZXR1cm4gY3JlYXRlRW50aXR5TWFuYWdlcihudWxs\nKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUVudGl0eU1hbmFnZXIgY3Jl\nYXRlRW50aXR5TWFuYWdlcihNYXAgcHJvcHMpIHsKICAgICAgICBpZiAocHJv\ncHMgPT0gbnVsbCkKICAgICAgICAgICAgcHJvcHMgPSBDb2xsZWN0aW9ucy5F\nTVBUWV9NQVA7CiAgICAgICAgZWxzZSBpZiAoIXByb3BzLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgcHJvcHMgPSBuZXcgSGFzaE1hcChwcm9wcyk7CgogICAg\nICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBnZXRDb25maWd1cmF0\naW9uKCk7CiAgICAgICAgU3RyaW5nIHVzZXIgPSAoU3RyaW5nKSBDb25maWd1\ncmF0aW9ucy5yZW1vdmVQcm9wZXJ0eQogICAgICAgICAgICAoIkNvbm5lY3Rp\nb25Vc2VyTmFtZSIsIHByb3BzKTsKICAgICAgICBpZiAodXNlciA9PSBudWxs\nKQogICAgICAgICAgICB1c2VyID0gY29uZi5nZXRDb25uZWN0aW9uVXNlck5h\nbWUoKTsKICAgICAgICBTdHJpbmcgcGFzcyA9IChTdHJpbmcpIENvbmZpZ3Vy\nYXRpb25zLnJlbW92ZVByb3BlcnR5CiAgICAgICAgICAgICgiQ29ubmVjdGlv\nblBhc3N3b3JkIiwgcHJvcHMpOwogICAgICAgIGlmIChwYXNzID09IG51bGwp\nCiAgICAgICAgICAgIHBhc3MgPSBjb25mLmdldENvbm5lY3Rpb25QYXNzd29y\nZCgpOwoKICAgICAgICBTdHJpbmcgc3RyID0gKFN0cmluZykgQ29uZmlndXJh\ndGlvbnMucmVtb3ZlUHJvcGVydHkKICAgICAgICAgICAgKCJUcmFuc2FjdGlv\nbk1vZGUiLCBwcm9wcyk7CiAgICAgICAgYm9vbGVhbiBtYW5hZ2VkOwogICAg\nICAgIGlmIChzdHIgPT0gbnVsbCkKICAgICAgICAgICAgbWFuYWdlZCA9IGNv\nbmYuaXNUcmFuc2FjdGlvbk1vZGVNYW5hZ2VkKCk7CiAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgIFZhbHVlIHZhbCA9IGNvbmYuZ2V0VmFsdWUoIlRyYW5z\nYWN0aW9uTW9kZSIpOwogICAgICAgICAgICBtYW5hZ2VkID0gQm9vbGVhbi5w\nYXJzZUJvb2xlYW4odmFsLnVuYWxpYXMoc3RyKSk7CiAgICAgICAgfQoKICAg\nICAgICBPYmplY3Qgb2JqID0gQ29uZmlndXJhdGlvbnMucmVtb3ZlUHJvcGVy\ndHkoIkNvbm5lY3Rpb25SZXRhaW5Nb2RlIiwgCiAgICAgICAgICAgIHByb3Bz\nKTsKICAgICAgICBpbnQgcmV0YWluTW9kZTsKICAgICAgICBpZiAob2JqIGlu\nc3RhbmNlb2YgTnVtYmVyKQogICAgICAgICAgICByZXRhaW5Nb2RlID0gKChO\ndW1iZXIpIG9iaikuaW50VmFsdWUoKTsKICAgICAgICBlbHNlIGlmIChvYmog\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0YWluTW9kZSA9IGNvbmYuZ2V0Q29u\nbmVjdGlvblJldGFpbk1vZGVDb25zdGFudCgpOwogICAgICAgIGVsc2Ugewog\nICAgICAgICAgICBWYWx1ZSB2YWwgPSBjb25mLmdldFZhbHVlKCJDb25uZWN0\naW9uUmV0YWluTW9kZSIpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgcmV0YWluTW9kZSA9IEludGVnZXIucGFyc2VJbnQodmFsLnVuYWxp\nYXMoKFN0cmluZykgb2JqKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRF\neGNlcHRpb24oX2xvYy5nZXQoImJhZC1lbS1wcm9wIiwKICAgICAgICAgICAg\nICAgICAgICAib3BlbmpwYS5Db25uZWN0aW9uUmV0YWluTW9kZSIsIG9iaiks\nCiAgICAgICAgICAgICAgICAgICAgbmV3IFRocm93YWJsZVtdeyBlIH0sIG9i\naiwgdHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEJy\nb2tlciBicm9rZXIgPSBfZmFjdG9yeS5uZXdCcm9rZXIodXNlciwgcGFzcywg\nbWFuYWdlZCwgcmV0YWluTW9kZSwKICAgICAgICAgICAgZmFsc2UpOwogICAg\nICAgIC8vIHdlIHNob3VsZCBhbGxvdyB0aGUgdXNlciB0byBzcGVjaWZ5IHRo\nZXNlIHNldHRpbmdzIGluIGNvbmYKICAgICAgICAvLyByZWdhcmRsZXNzIG9m\nIFBlcnNpc3RlbmNlQ29udGV4dFR5cGUKICAgICAgICBicm9rZXIuc2V0QXV0\nb0RldGFjaChBdXRvRGV0YWNoLkRFVEFDSF9DTE9TRSk7CiAgICAgICAgYnJv\na2VyLnNldERldGFjaGVkTmV3KGZhbHNlKTsKICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBlbSA9IG5ld0VudGl0eU1hbmFnZXJJbXBsKGJyb2tlcik7\nCgogICAgICAgIC8vIGFsbG93IHNldHRpbmcgb2Ygb3RoZXIgYmVhbiBwcm9w\nZXJ0aWVzIG9mIEVNCiAgICAgICAgU3RyaW5nW10gcHJlZml4ZXMgPSBQcm9k\ndWN0RGVyaXZhdGlvbnMuZ2V0Q29uZmlndXJhdGlvblByZWZpeGVzKCk7CiAg\nICAgICAgTGlzdDxSdW50aW1lRXhjZXB0aW9uPiBlcnJzID0gbnVsbDsKICAg\nICAgICBNZXRob2Qgc2V0dGVyID0gbnVsbDsKICAgICAgICBTdHJpbmcgcHJv\ncCwgcHJlZml4OwogICAgICAgIE9iamVjdCB2YWw7CiAgICAgICAgZm9yIChN\nYXAuRW50cnkgZW50cnkgOiAoU2V0PE1hcC5FbnRyeT4pIHByb3BzLmVudHJ5\nU2V0KCkpIHsKICAgICAgICAgICAgcHJvcCA9IChTdHJpbmcpIGVudHJ5Lmdl\ndEtleSgpOwogICAgICAgICAgICBwcmVmaXggPSBudWxsOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICBwcmVmaXggPSBwcmVmaXhlc1tpXSArICIuIjsK\nICAgICAgICAgICAgICAgIGlmIChwcm9wLnN0YXJ0c1dpdGgocHJlZml4KSkK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIHBy\nZWZpeCA9IG51bGw7IAogICAgICAgICAgICB9IAogICAgICAgICAgICBpZiAo\ncHJlZml4ID09IG51bGwpCiAgICAgICAgICAgICAgICBjb250aW51ZTsgCiAg\nICAgICAgICAgIHByb3AgPSBwcm9wLnN1YnN0cmluZyhwcmVmaXgubGVuZ3Ro\nKCkpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc2V0dGVy\nID0gSW1wbEhlbHBlci5nZXRTZXR0ZXIoZW0uZ2V0Q2xhc3MoKSwgcHJvcCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsK\nICAgICAgICAgICAgICAgIGlmIChlcnJzID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgZXJycyA9IG5ldyBMaW5rZWRMaXN0PFJ1bnRpbWVFeGNlcHRp\nb24+KCk7CiAgICAgICAgICAgICAgICBlcnJzLmFkZChQZXJzaXN0ZW5jZUV4\nY2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihrZSkpOwogICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHZhbCA9IGVudHJ5LmdldFZhbHVlKCk7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKCJudWxsIi5lcXVhbHModmFsKSkKICAg\nICAgICAgICAgICAgICAgICAgICAgdmFsID0gbnVsbDsKICAgICAgICAgICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IFN0\ncmluZ3MucGFyc2UoKFN0cmluZykgdmFsLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgc2V0dGVyLmdldFBhcmFtZXRlclR5cGVzKClbMF0pOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2V0dGVyLmludm9rZShl\nbSwgbmV3IE9iamVjdFtdeyB2YWwgfSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBBcmd1bWVudEV4Y2Vw\ndGlvbiBlcnIgPSBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQKICAg\nICAgICAgICAgICAgICAgICAoImJhZC1lbS1wcm9wIiwgcHJvcCwgZW50cnku\nZ2V0VmFsdWUoKSksCiAgICAgICAgICAgICAgICAgICAgbmV3IFRocm93YWJs\nZVtdeyBlIH0sIG51bGwsIHRydWUpOwogICAgICAgICAgICAgICAgaWYgKGVy\ncnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBlcnJzID0gbmV3IExp\nbmtlZExpc3Q8UnVudGltZUV4Y2VwdGlvbj4oKTsKICAgICAgICAgICAgICAg\nIGVycnMuYWRkKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIGlmIChlcnJzICE9IG51bGwpIHsKICAgICAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgICAgICAgICAgaWYgKGVycnMuc2l6ZSgpID09IDEpCiAgICAgICAg\nICAgICAgICB0aHJvdyBlcnJzLmdldCgwKTsKICAgICAgICAgICAgdGhyb3cg\nbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZW0tcHJvcHMi\nKSwKICAgICAgICAgICAgICAgIChUaHJvd2FibGVbXSkgZXJycy50b0FycmF5\nKG5ldyBUaHJvd2FibGVbZXJycy5zaXplKCldKSwKICAgICAgICAgICAgICAg\nIG51bGwsIHRydWUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZW07CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgZW50aXR5IG1hbmFn\nZXIgYXJvdW5kIHRoZSBnaXZlbiBicm9rZXIuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBFbnRpdHlNYW5hZ2VySW1wbCBuZXdFbnRpdHlNYW5hZ2VySW1wbChC\ncm9rZXIgYnJva2VyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBFbnRpdHlNYW5h\nZ2VySW1wbCh0aGlzLCBicm9rZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZExpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lciwgQ2xhc3Mu\nLi4gY2xhc3NlcykgewogICAgICAgIF9mYWN0b3J5LmFkZExpZmVjeWNsZUxp\nc3RlbmVyKGxpc3RlbmVyLCBjbGFzc2VzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCByZW1vdmVMaWZlY3ljbGVMaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIp\nIHsKICAgICAgICBfZmFjdG9yeS5yZW1vdmVMaWZlY3ljbGVMaXN0ZW5lcihs\naXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAg\nICAgICAgX2ZhY3RvcnkuY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBpc09wZW4oKSB7CiAgICAgICAgcmV0dXJuICFfZmFjdG9yeS5pc0Ns\nb3NlZCgpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9mYWN0b3J5Lmhhc2hDb2RlKCk7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAg\nIGlmIChvdGhlciA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIEVudGl0eU1hbmFnZXJG\nYWN0b3J5SW1wbCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICByZXR1cm4gX2ZhY3RvcnkuZXF1YWxzKCgoRW50aXR5TWFuYWdlckZhY3Rv\ncnlJbXBsKSBvdGhlcikuX2ZhY3RvcnkpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ3JlYXRlIGEgc3RvcmUtc3BlY2lmaWMgZmFjYWRlIGZvciB0aGUgZ2l2\nZW4gZmV0Y2ggY29uZmlndXJhdGlvbi4KCSAqIElmIG5vIGZhY2FkZSBjbGFz\ncyBleGlzdHMsIHdlIHVzZSB0aGUgZGVmYXVsdCB7QGxpbmsgRmV0Y2hQbGFu\nfS4KICAgICAqLwogICAgRmV0Y2hQbGFuIHRvRmV0Y2hQbGFuKEJyb2tlciBi\ncm9rZXIsIEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIGlm\nIChmZXRjaCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgRmV0Y2hDb25maWd1cmF0aW9uIGlubmVyID0gZmV0Y2g7CiAgICAg\nICAgaWYgKGlubmVyIGluc3RhbmNlb2YgRGVsZWdhdGluZ0ZldGNoQ29uZmln\ndXJhdGlvbikKICAgICAgICAgICAgaW5uZXIgPSAoKERlbGVnYXRpbmdGZXRj\naENvbmZpZ3VyYXRpb24pIGlubmVyKS4KICAgICAgICAgICAgICAgIGdldElu\nbmVybW9zdERlbGVnYXRlKCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGlmIChfcGxhbiA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBDbGFzcyBz\ndG9yZVR5cGUgPSAoYnJva2VyID09IG51bGwpID8gbnVsbCA6IGJyb2tlci4K\nICAgICAgICAgICAgICAgICAgICBnZXRTdG9yZU1hbmFnZXIoKS5nZXRJbm5l\ncm1vc3REZWxlZ2F0ZSgpLmdldENsYXNzKCk7CiAgICAgICAgICAgICAgICBD\nbGFzcyBjbHMgPSBfZmFjdG9yeS5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAg\nICAgICAgICAgICAgICAgZ2V0U3RvcmVGYWNhZGVUeXBlUmVnaXN0cnkoKS4K\nICAgICAgICAgICAgICAgICAgICBnZXRJbXBsZW1lbnRhdGlvbihGZXRjaFBs\nYW4uY2xhc3MsIHN0b3JlVHlwZSwgCiAgICAgICAgICAgICAgICAgICAgCQlG\nZXRjaFBsYW5JbXBsLmNsYXNzKTsKICAgICAgICAgICAgICAgIF9wbGFuID0g\nY2xzLmdldENvbnN0cnVjdG9yKEZldGNoQ29uZmlndXJhdGlvbi5jbGFzcyk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIF9wbGFuLm5ld0lu\nc3RhbmNlKGZldGNoKTsKICAgICAgICB9IGNhdGNoIChJbnZvY2F0aW9uVGFy\nZ2V0RXhjZXB0aW9uIGl0ZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0\nZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbgogICAgICAg\nICAgICAgICAgKGl0ZS5nZXRUYXJnZXRFeGNlcHRpb24oKSk7CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgUGVy\nc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7\nCiAgICAgICAgfQoJfQp9Cg==\n","encoding":"base64"}

