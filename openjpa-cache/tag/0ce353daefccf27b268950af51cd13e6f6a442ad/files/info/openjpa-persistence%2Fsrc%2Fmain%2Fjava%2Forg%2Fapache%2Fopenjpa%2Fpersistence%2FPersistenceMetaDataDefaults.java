{"sha":"0a114ef367f521564efc64f30c3c99d36d8673eb","node_id":"MDQ6QmxvYjIwNjM2NDowYTExNGVmMzY3ZjUyMTU2NGVmYzY0ZjMwYzNjOTlkMzZkODY3M2Vi","size":10510,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0a114ef367f521564efc64f30c3c99d36d8673eb","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6\nYWJsZTsKaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkFubm90YXRpb247\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Bbm5vdGF0ZWRFbGVtZW50Owpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxh\nbmcucmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5N\nZXRob2Q7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1w\nb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hT\nZXQ7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNl\ndDsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkJhc2ljOwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuRW1iZWRkYWJsZTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVtYmVkZGVkOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW1i\nZWRkZWRJZDsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLk1hbnlUb01hbnk7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5NYW55VG9PbmU7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5PbmVUb01hbnk7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5PbmVUb09uZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlBv\nc3RMb2FkOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUG9zdFBlcnNpc3Q7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5Qb3N0UmVtb3ZlOwppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuUG9zdFVwZGF0ZTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLlByZVBlcnNpc3Q7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5QcmVSZW1vdmU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QcmVVcGRh\ndGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5UcmFuc2llbnQ7CgppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkFic3RyYWN0TWV0YURhdGFE\nZWZhdWx0czsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVs\nZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2\nYVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFsdWVN\nZXRhRGF0YTsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UuUGVyc2lzdGVuY2VTdHJhdGVneS4qOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICog\nSlBBLWJhc2VkIG1ldGFkYXRhIGRlZmF1bHRzLgogKgogKiBAYXV0aG9yIFBh\ndHJpY2sgTGluc2tleQogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGlj\nIGNsYXNzIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cwogICAgZXh0ZW5k\ncyBBYnN0cmFjdE1ldGFEYXRhRGVmYXVsdHMgewoKICAgIHByaXZhdGUgYm9v\nbGVhbiBfYWxsb3dzTXVsdGlwbGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrID0g\ndHJ1ZTsKCiAgICBwcml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIgX2xvYyA9IExv\nY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFBlcnNpc3RlbmNlTWV0YURh\ndGFEZWZhdWx0cy5jbGFzcyk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTWFwPENsYXNzLCBQZXJzaXN0ZW5jZVN0cmF0ZWd5PiBfc3RyYXRzID0KICAg\nICAgICBuZXcgSGFzaE1hcDxDbGFzcywgUGVyc2lzdGVuY2VTdHJhdGVneT4o\nKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFNldDxTdHJpbmc+IF9pZ25v\ncmVkQW5ub3MgPSBuZXcgSGFzaFNldDxTdHJpbmc+KCk7CgogICAgc3RhdGlj\nIHsKICAgICAgICBfc3RyYXRzLnB1dChCYXNpYy5jbGFzcywgQkFTSUMpOwog\nICAgICAgIF9zdHJhdHMucHV0KE1hbnlUb09uZS5jbGFzcywgTUFOWV9PTkUp\nOwogICAgICAgIF9zdHJhdHMucHV0KE9uZVRvT25lLmNsYXNzLCBPTkVfT05F\nKTsKICAgICAgICBfc3RyYXRzLnB1dChFbWJlZGRlZC5jbGFzcywgRU1CRURE\nRUQpOwogICAgICAgIF9zdHJhdHMucHV0KEVtYmVkZGVkSWQuY2xhc3MsIEVN\nQkVEREVEKTsKICAgICAgICBfc3RyYXRzLnB1dChPbmVUb01hbnkuY2xhc3Ms\nIE9ORV9NQU5ZKTsKICAgICAgICBfc3RyYXRzLnB1dChNYW55VG9NYW55LmNs\nYXNzLCBNQU5ZX01BTlkpOwogICAgICAgIF9zdHJhdHMucHV0KFBlcnNpc3Rl\nbnQuY2xhc3MsIFBFUlMpOwogICAgICAgIF9zdHJhdHMucHV0KFBlcnNpc3Rl\nbnRDb2xsZWN0aW9uLmNsYXNzLCBQRVJTX0NPTEwpOwogICAgICAgIF9zdHJh\ndHMucHV0KFBlcnNpc3RlbnRNYXAuY2xhc3MsIFBFUlNfTUFQKTsKCiAgICAg\nICAgX2lnbm9yZWRBbm5vcy5hZGQoRGV0YWNoZWRTdGF0ZS5jbGFzcy5nZXRO\nYW1lKCkpOwogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFBvc3RMb2FkLmNs\nYXNzLmdldE5hbWUoKSk7CiAgICAgICAgX2lnbm9yZWRBbm5vcy5hZGQoUG9z\ndFBlcnNpc3QuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFu\nbm9zLmFkZChQb3N0UmVtb3ZlLmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAg\nX2lnbm9yZWRBbm5vcy5hZGQoUG9zdFVwZGF0ZS5jbGFzcy5nZXROYW1lKCkp\nOwogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFByZVBlcnNpc3QuY2xhc3Mu\nZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9zLmFkZChQcmVSZW1v\ndmUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9zLmFk\nZChQcmVVcGRhdGUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICBwdWJs\naWMgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzKCkgewogICAgICAgIHNl\ndENhbGxiYWNrTW9kZShDQUxMQkFDS19SRVRIUk9XIHwgQ0FMTEJBQ0tfUk9M\nTEJBQ0sgfAogICAgICAgICAgICBDQUxMQkFDS19GQUlMX0ZBU1QpOwogICAg\nICAgIHNldERhdGFTdG9yZU9iamVjdElkRmllbGRVbndyYXBwZWQodHJ1ZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvZGUgZm9yIHRo\nZSBzdHJhdGVneSBvZiB0aGUgZ2l2ZW4gbWVtYmVyLiBSZXR1cm4gbnVsbCBp\nZgogICAgICogbm8gc3RyYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgUGVyc2lzdGVuY2VTdHJhdGVneSBnZXRQZXJzaXN0ZW5jZVN0cmF0ZWd5\nCiAgICAgICAgKEZpZWxkTWV0YURhdGEgZm1kLCBNZW1iZXIgbWVtYmVyKSB7\nCiAgICAgICAgaWYgKG1lbWJlciA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICBBbm5vdGF0ZWRFbGVtZW50IGVsID0gKEFubm90\nYXRlZEVsZW1lbnQpIG1lbWJlcjsKICAgICAgICBpZiAoZWwuaXNBbm5vdGF0\naW9uUHJlc2VudChUcmFuc2llbnQuY2xhc3MpKQogICAgICAgICAgICByZXR1\ncm4gVFJBTlNJRU5UOwogICAgICAgIGlmIChmbWQgIT0gbnVsbAogICAgICAg\nICAgICAmJiBmbWQuZ2V0TWFuYWdlbWVudCgpICE9IEZpZWxkTWV0YURhdGEu\nTUFOQUdFX1BFUlNJU1RFTlQpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoK\nICAgICAgICAvLyBsb29rIGZvciBwZXJzaXN0ZW5jZSBzdHJhdGVneSBpbiBh\nbm5vdGF0aW9uIHRhYmxlCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBw\nc3RyYXQgPSBudWxsOwogICAgICAgIGZvciAoQW5ub3RhdGlvbiBhbm5vIDog\nZWwuZ2V0RGVjbGFyZWRBbm5vdGF0aW9ucygpKSB7CiAgICAgICAgICAgIGlm\nIChwc3RyYXQgIT0gbnVsbCAmJiBfc3RyYXRzLmNvbnRhaW5zS2V5KGFubm8u\nYW5ub3RhdGlvblR5cGUoKSkpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImFscmVhZHktcGVycyIsIG1l\nbWJlcikpOwogICAgICAgICAgICBpZiAocHN0cmF0ID09IG51bGwpCiAgICAg\nICAgICAgICAgICBwc3RyYXQgPSBfc3RyYXRzLmdldChhbm5vLmFubm90YXRp\nb25UeXBlKCkpOwogICAgICAgIH0KICAgICAgICBpZiAocHN0cmF0ICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBwc3RyYXQ7CgogICAgICAgIENsYXNz\nIHR5cGU7CiAgICAgICAgaW50IGNvZGU7CiAgICAgICAgaWYgKGZtZCAhPSBu\ndWxsKSB7CiAgICAgICAgICAgIHR5cGUgPSBmbWQuZ2V0VHlwZSgpOwogICAg\nICAgICAgICBjb2RlID0gZm1kLmdldFR5cGVDb2RlKCk7CiAgICAgICAgfSBl\nbHNlIGlmIChtZW1iZXIgaW5zdGFuY2VvZiBGaWVsZCkgewogICAgICAgICAg\nICB0eXBlID0gKChGaWVsZCkgbWVtYmVyKS5nZXRUeXBlKCk7CiAgICAgICAg\nICAgIGNvZGUgPSBKYXZhVHlwZXMuZ2V0VHlwZUNvZGUodHlwZSk7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgdHlwZSA9ICgoTWV0aG9kKSBtZW1i\nZXIpLmdldFJldHVyblR5cGUoKTsKICAgICAgICAgICAgY29kZSA9IEphdmFU\neXBlcy5nZXRUeXBlQ29kZSh0eXBlKTsKICAgICAgICB9CgogICAgICAgIHN3\naXRjaCAoY29kZSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJB\nWToKICAgICAgICAgICAgICAgIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcwog\nICAgICAgICAgICAgICAgICAgIHx8IHR5cGUgPT0gY2hhcltdLmNsYXNzCiAg\nICAgICAgICAgICAgICAgICAgfHwgdHlwZSA9PSBCeXRlW10uY2xhc3MKICAg\nICAgICAgICAgICAgICAgICB8fCB0eXBlID09IENoYXJhY3RlcltdLmNsYXNz\nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBCQVNJQzsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09M\nRUFOOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09MRUFOX09CSjoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURToKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQllURV9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkNIQVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVJf\nT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRV9PQko6CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5GTE9BVF9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklO\nVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UX09CSjoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuTE9OR19PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLlNIT1JUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVF9PQko6\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuQklHREVDSU1BTDoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQklHSU5URUdFUjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuREFURToKICAgICAgICAgICAgICAgIHJldHVybiBCQVNJQzsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgogICAgICAgICAgICAg\nICAgaWYgKEVudW0uY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBlKSkKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gQkFTSUM7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vIyMjIEVKQjM6IHdoYXQg\naWYgZGVmaW5lZCBpbiBYTUw/CiAgICAgICAgaWYgKHR5cGUuaXNBbm5vdGF0\naW9uUHJlc2VudChFbWJlZGRhYmxlLmNsYXNzKSkKICAgICAgICAgICAgcmV0\ndXJuIEVNQkVEREVEOwogICAgICAgIGlmIChTZXJpYWxpemFibGUuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbSh0eXBlKSkKICAgICAgICAgICAgcmV0dXJuIEJB\nU0lDOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgCiAgICAvKiog\nCiAgICAgKiBGbGFncyBpZiBtdWx0aXBsZSBtZXRob2RzIG9mIHRoZSBzYW1l\nIGNsYXNzIGNhbiBoYW5kbGUgdGhlIHNhbWUgCiAgICAgKiBjYWxsYmFjayBl\ndmVudC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0QWxsb3dzTXVs\ndGlwbGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrKCkgewogICAgICAgIHJldHVy\nbiBfYWxsb3dzTXVsdGlwbGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrOwogICAg\nfQogICAgCiAgICAvKiogCiAgICAgKiBGbGFncyBpZiBtdWx0aXBsZSBtZXRo\nb2RzIG9mIHRoZSBzYW1lIGNsYXNzIGNhbiBoYW5kbGUgdGhlIHNhbWUgCiAg\nICAgKiBjYWxsYmFjayBldmVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0QWxsb3dzTXVsdGlwbGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrKGJvb2xl\nYW4gZmxhZykgewogICAgICAgIF9hbGxvd3NNdWx0aXBsZU1ldGhvZHNGb3JT\nYW1lQ2FsbGJhY2sgPSBmbGFnOwogICAgfQoKICAgIC8qKgogICAgICogQXV0\nby1jb25maWd1cmF0aW9uIG1ldGhvZCBmb3IgdGhlIGRlZmF1bHQgYWNjZXNz\nIHR5cGUgb2YgYmFzZSBjbGFzc2VzIAogICAgICogd2l0aCBBQ0NFU1NfVU5L\nTk9XTgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREZWZhdWx0QWNjZXNz\nVHlwZShTdHJpbmcgdHlwZSkgewogICAgICAgIGlmICh0eXBlID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBpZiAoIlBST1BFUlRZIi5l\ncXVhbHModHlwZS50b1VwcGVyQ2FzZSgpKSkKICAgICAgICAgICAgc2V0RGVm\nYXVsdEFjY2Vzc1R5cGUoQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfUFJPUEVSVFkp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc2V0RGVmYXVsdEFjY2Vzc1R5\ncGUoQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfRklFTEQpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIHZvaWQgcG9wdWxhdGUoQ2xhc3NNZXRhRGF0\nYSBtZXRhLCBpbnQgYWNjZXNzKSB7CiAgICAgICAgc3VwZXIucG9wdWxhdGUo\nbWV0YSwgYWNjZXNzKTsKICAgICAgICBtZXRhLnNldERldGFjaGFibGUodHJ1\nZSk7CiAgICAgICAgLy8gZG8gbm90IGNhbGwgZ2V0KkZpZWxkcyBhcyBpdCB3\naWxsIGxvY2sgZG93biB0aGUgZmllbGRzLgogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIHZvaWQgcG9wdWxhdGUoRmllbGRNZXRhRGF0YSBm\nbWQpIHsKICAgICAgICBzZXRDYXNjYWRlTm9uZShmbWQpOwogICAgICAgIHNl\ndENhc2NhZGVOb25lKGZtZC5nZXRLZXkoKSk7CiAgICAgICAgc2V0Q2FzY2Fk\nZU5vbmUoZm1kLmdldEVsZW1lbnQoKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUdXJucyBvZmYgYXV0byBjYXNjYWRpbmcgb2YgcGVyc2lzdCwgcmVmcmVz\naCwgYXR0YWNoLgogICAgICovCiAgICBzdGF0aWMgdm9pZCBzZXRDYXNjYWRl\nTm9uZShWYWx1ZU1ldGFEYXRhIHZtZCkgewogICAgICAgIHZtZC5zZXRDYXNj\nYWRlUGVyc2lzdChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfTk9ORSk7CiAgICAg\nICAgdm1kLnNldENhc2NhZGVSZWZyZXNoKFZhbHVlTWV0YURhdGEuQ0FTQ0FE\nRV9OT05FKTsKICAgICAgICB2bWQuc2V0Q2FzY2FkZUF0dGFjaChWYWx1ZU1l\ndGFEYXRhLkNBU0NBREVfTk9ORSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwcm90ZWN0ZWQgaW50IGdldEFjY2Vzc1R5cGUoQ2xhc3NNZXRhRGF0YSBt\nZXRhKSB7CiAgICAgICAgcmV0dXJuIGdldEFjY2Vzc1R5cGUobWV0YS5nZXRE\nZXNjcmliZWRUeXBlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmVjdXJz\naXZlIGhlbHBlciB0byBkZXRlcm1pbmUgYWNjZXNzIHR5cGUgYmFzZWQgb24g\nYW5ub3RhdGlvbiBwbGFjZW1lbnQuCiAgICAgKi8KICAgIHByaXZhdGUgaW50\nIGdldEFjY2Vzc1R5cGUoQ2xhc3MgY2xzKSB7CiAgICAgICAgLy8gdHJhdmVy\nc2VkIGVudGlyZSBoaWVyYXJjaHkgd2l0aG91dCBmaW5kaW5nIGFubm90YXRp\nb25zCiAgICAgICAgaWYgKGNscyA9PSBudWxsIHx8IGNscyA9PSBPYmplY3Qu\nY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBDbGFzc01ldGFEYXRhLkFDQ0VT\nU19VTktOT1dOOwoKICAgICAgICBpbnQgYWNjZXNzID0gMDsKICAgICAgICBp\nZiAodXNlc0FjY2VzcyhjbHMuZ2V0RGVjbGFyZWRGaWVsZHMoKSkpCiAgICAg\nICAgICAgIGFjY2VzcyB8PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRDsK\nICAgICAgICBpZiAodXNlc0FjY2VzcyhjbHMuZ2V0RGVjbGFyZWRNZXRob2Rz\nKCkpKQogICAgICAgICAgICBhY2Nlc3MgfD0gQ2xhc3NNZXRhRGF0YS5BQ0NF\nU1NfUFJPUEVSVFk7CiAgICAgICAgcmV0dXJuIChhY2Nlc3MgPT0gMCkgPyBn\nZXRBY2Nlc3NUeXBlKGNscy5nZXRTdXBlcmNsYXNzKCkpIDogYWNjZXNzOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVu\nIG1lbWJlcnMgaGF2ZSBwZXJzaXN0ZW5jZSBhbm5vdGF0aW9ucy4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiB1c2VzQWNjZXNzKEFubm90\nYXRlZEVsZW1lbnRbXSBtZW1iZXJzKSB7CiAgICAgICAgQW5ub3RhdGlvbltd\nIGFubm9zOwogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbWVtYmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBhbm5vcyA9IG1lbWJlcnNbaV0uZ2V0QW5ub3RhdGlvbnMoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBhbm5vcy5sZW5ndGg7IGorKykg\newogICAgICAgICAgICAgICAgbmFtZSA9IGFubm9zW2pdLmFubm90YXRpb25U\neXBlKCkuZ2V0TmFtZSgpOwogICAgICAgICAgICAgICAgaWYgKChuYW1lLnN0\nYXJ0c1dpdGgoImphdmF4LnBlcnNpc3RlbmNlLiIpCiAgICAgICAgICAgICAg\nICAgICAgfHwgbmFtZS5zdGFydHNXaXRoKCJvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuIikpCiAgICAgICAgICAgICAgICAgICAgJiYgIV9pZ25v\ncmVkQW5ub3MuY29udGFpbnMobmFtZSkpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHByb3RlY3RlZCBib29sZWFuIGlz\nRGVmYXVsdFBlcnNpc3RlbnQoQ2xhc3NNZXRhRGF0YSBtZXRhLCBNZW1iZXIg\nbWVtYmVyLAogICAgICAgIFN0cmluZyBuYW1lKSB7CiAgICAgICAgaW50IG1v\nZHMgPSBtZW1iZXIuZ2V0TW9kaWZpZXJzKCk7CiAgICAgICAgaWYgKE1vZGlm\naWVyLmlzVHJhbnNpZW50KG1vZHMpKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CgogICAgICAgIGlmIChtZW1iZXIgaW5zdGFuY2VvZiBNZXRob2QpIHsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZv\nciBzZXR0ZXJzIGZvciBtZXRob2RzCiAgICAgICAgICAgICAgICBNZXRob2Qg\nc2V0dGVyID0gbWV0YS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0RGVjbGFyZWRN\nZXRob2QoInNldCIKICAgICAgICAgICAgICAgICAgICArIG5hbWUuc3Vic3Ry\naW5nKDAsIDEpLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnN1YnN0cmluZygxKSwK\nICAgICAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXSB7ICgoTWV0aG9kKSBt\nZW1iZXIpLmdldFJldHVyblR5cGUoKSB9KTsKICAgICAgICAgICAgICAgIGlm\nIChzZXR0ZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAvLyBlLmcuLCBOb1N1Y2hNZXRob2RFeGNlcHRpb24K\nICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdCA9\nIGdldFBlcnNpc3RlbmNlU3RyYXRlZ3kobnVsbCwgbWVtYmVyKTsKICAgICAg\nICBpZiAoc3RyYXQgPT0gbnVsbCB8fCBzdHJhdCA9PSBQZXJzaXN0ZW5jZVN0\ncmF0ZWd5LlRSQU5TSUVOVCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIHJldHVybiB0cnVlOwoJfQp9Cg==\n","encoding":"base64"}

