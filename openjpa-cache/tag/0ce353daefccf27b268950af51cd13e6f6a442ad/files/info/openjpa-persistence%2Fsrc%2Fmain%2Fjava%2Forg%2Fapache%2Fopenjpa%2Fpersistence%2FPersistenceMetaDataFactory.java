{"sha":"eedfbbd02c6ab40daa639694e52a1a60a42a54d9","node_id":"MDQ6QmxvYjIwNjM2NDplZWRmYmJkMDJjNmFiNDBkYWE2Mzk2OTRlNTJhMWE2MGE0MmE1NGQ5","size":13406,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/eedfbbd02c6ab40daa639694e52a1a60a42a54d9","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBqYXZhLmlvLkZpbGU7Cmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJM\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5D\nb2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW1iZWRkYWJsZTsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLk1hcHBlZFN1cGVyY2xhc3M7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5OYW1lZFF1ZXJpZXM7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5O\nYW1lZFF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTmFtZWROYXRp\ndmVRdWVyaWVzOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTmFtZWROYXRp\ndmVRdWVyeTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYu\nQ29uZmlndXJhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmNvbmYuR2VuZXJpY0NvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubWV0YS5DbGFzc0Fubm90YXRpb25NZXRhRGF0YUZp\nbHRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DbGFz\nc0FyZ1BhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0\nYS5NZXRhRGF0YUZpbHRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIubWV0YS5NZXRhRGF0YVBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLkFic3RyYWN0Q0ZNZXRhRGF0YUZhY3Rvcnk7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhRGVmYXVsdHM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YUZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5RdWVyeU1ldGFEYXRh\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuU2VxdWVuY2VNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkdlbmVyYWxF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRh\nRGF0YUV4Y2VwdGlvbjsKCi8qKgogKiB7QGxpbmsgTWV0YURhdGFGYWN0b3J5\nfSBmb3IgSlBBIG1ldGFkYXRhLgogKgogKiBAYXV0aG9yIFN0ZXZlIEtpbQog\nKiBAc2luY2UgMC40LjAKICovCnB1YmxpYyBjbGFzcyBQZXJzaXN0ZW5jZU1l\ndGFEYXRhRmFjdG9yeQogICAgZXh0ZW5kcyBBYnN0cmFjdENGTWV0YURhdGFG\nYWN0b3J5CiAgICBpbXBsZW1lbnRzIENvbmZpZ3VyYWJsZSwgR2VuZXJpY0Nv\nbmZpZ3VyYWJsZSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxp\nemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChQZXJz\naXN0ZW5jZU1ldGFEYXRhRmFjdG9yeS5jbGFzcyk7CgogICAgcHJpdmF0ZSBm\naW5hbCBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMgX2RlZiA9IAogICAg\nICAgIG5ldyBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMoKTsKICAgIHBy\naXZhdGUgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgX2Fu\nbm9QYXJzZXIgPSBudWxsOwogICAgcHJpdmF0ZSBYTUxQZXJzaXN0ZW5jZU1l\ndGFEYXRhUGFyc2VyIF94bWxQYXJzZXIgPSBudWxsOwogICAgcHJpdmF0ZSBN\nYXA8VVJMLCBTZXQ+IF94bWwgPSBudWxsOyAvLyB4bWwgcnNyYyAtPiBjbGFz\ncyBuYW1lcwogICAgcHJpdmF0ZSBTZXQ8VVJMPiBfdW5wYXJzZWQgPSBudWxs\nOyAvLyB4bWwgcnNyYwogICAgcHJpdmF0ZSBib29sZWFuIF9maWVsZE92ZXJy\naWRlID0gdHJ1ZTsKCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNlIGZp\nZWxkLWxldmVsIG92ZXJyaWRlIG9yIGNsYXNzLWxldmVsIG92ZXJyaWRlLgog\nICAgICogRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0RmllbGRPdmVycmlkZShib29sZWFuIGZpZWxkKSB7CiAgICAgICAg\nX2ZpZWxkT3ZlcnJpZGUgPSBmaWVsZDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gdXNlIGZpZWxkLWxldmVsIG92ZXJyaWRlIG9yIGNsYXNz\nLWxldmVsIG92ZXJyaWRlLgogICAgICogRGVmYXVsdHMgdG8gdHJ1ZS4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0RmllbGRPdmVycmlkZSgpIHsK\nICAgICAgICByZXR1cm4gX2ZpZWxkT3ZlcnJpZGU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gbWV0YWRhdGEgcGFyc2VyLCBjcmVhdGluZyBpdCBp\nZiBpdCBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0LgogICAgICovCiAgICBwdWJs\naWMgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgZ2V0QW5u\nb3RhdGlvblBhcnNlcigpIHsKICAgICAgICBpZiAoX2Fubm9QYXJzZXIgPT0g\nbnVsbCkgewogICAgICAgICAgICBfYW5ub1BhcnNlciA9IG5ld0Fubm90YXRp\nb25QYXJzZXIoKTsKICAgICAgICAgICAgX2Fubm9QYXJzZXIuc2V0UmVwb3Np\ndG9yeShyZXBvcyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfYW5ub1Bh\ncnNlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgbWV0YWRhdGEg\ncGFyc2VyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRBbm5vdGF0aW9u\nUGFyc2VyKAogICAgICAgIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRh\nUGFyc2VyIHBhcnNlcikgewogICAgICAgIGlmIChfYW5ub1BhcnNlciAhPSBu\ndWxsKQogICAgICAgICAgICBfYW5ub1BhcnNlci5zZXRSZXBvc2l0b3J5KG51\nbGwpOwogICAgICAgIGlmIChwYXJzZXIgIT0gbnVsbCkKICAgICAgICAgICAg\ncGFyc2VyLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgICAgIF9hbm5vUGFy\nc2VyID0gcGFyc2VyOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEg\nbmV3IG1ldGFkYXRhIHBhcnNlci4KICAgICAqLwogICAgcHJvdGVjdGVkIEFu\nbm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIG5ld0Fubm90YXRp\nb25QYXJzZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBbm5vdGF0aW9uUGVy\nc2lzdGVuY2VNZXRhRGF0YVBhcnNlcgogICAgICAgICAgICAocmVwb3MuZ2V0\nQ29uZmlndXJhdGlvbigpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiBYTUwgbWV0YWRhdGEgcGFyc2VyLCBjcmVhdGluZyBpdCBpZiBpdCBkb2Vz\nIG5vdCBhbHJlYWR5IGV4aXN0LgogICAgICovCiAgICBwdWJsaWMgWE1MUGVy\nc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBnZXRYTUxQYXJzZXIoKSB7CiAgICAg\nICAgaWYgKF94bWxQYXJzZXIgPT0gbnVsbCkgewogICAgICAgICAgICBfeG1s\nUGFyc2VyID0gbmV3WE1MUGFyc2VyKHRydWUpOwogICAgICAgICAgICBfeG1s\nUGFyc2VyLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgICAgICAgICBpZiAo\nX2ZpZWxkT3ZlcnJpZGUpCiAgICAgICAgICAgICAgICBfeG1sUGFyc2VyLnNl\ndEFubm90YXRpb25QYXJzZXIoZ2V0QW5ub3RhdGlvblBhcnNlcigpKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIF94bWxQYXJzZXI7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIG1ldGFkYXRhIHBhcnNlci4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0WE1MUGFyc2VyKFhNTFBlcnNpc3RlbmNlTWV0\nYURhdGFQYXJzZXIgcGFyc2VyKSB7CiAgICAgICAgaWYgKF94bWxQYXJzZXIg\nIT0gbnVsbCkKICAgICAgICAgICAgX3htbFBhcnNlci5zZXRSZXBvc2l0b3J5\nKG51bGwpOwogICAgICAgIGlmIChwYXJzZXIgIT0gbnVsbCkKICAgICAgICAg\nICAgcGFyc2VyLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgICAgIF94bWxQ\nYXJzZXIgPSBwYXJzZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSBuZXcgbWV0YWRhdGEgcGFyc2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBuZXdYTUxQYXJzZXIoYm9v\nbGVhbiBsb2FkaW5nKSB7CiAgICAgICAgcmV0dXJuIG5ldyBYTUxQZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyKHJlcG9zLmdldENvbmZpZ3VyYXRpb24oKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgc2VyaWFsaXpl\ncgogICAgICovCiAgICBwcm90ZWN0ZWQgWE1MUGVyc2lzdGVuY2VNZXRhRGF0\nYVNlcmlhbGl6ZXIgbmV3WE1MU2VyaWFsaXplcigpIHsKICAgICAgICByZXR1\ncm4gbmV3IFhNTFBlcnNpc3RlbmNlTWV0YURhdGFTZXJpYWxpemVyKHJlcG9z\nLmdldENvbmZpZ3VyYXRpb24oKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nbG9hZChDbGFzcyBjbHMsIGludCBtb2RlLCBDbGFzc0xvYWRlciBlbnZMb2Fk\nZXIpIHsKICAgICAgICBpZiAobW9kZSA9PSBNT0RFX05PTkUpCiAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICBpZiAoIXN0cmljdCAmJiAobW9kZSAmIE1P\nREVfTUVUQSkgIT0gMCkKICAgICAgICAgICAgbW9kZSB8PSBNT0RFX01BUFBJ\nTkc7CgogICAgICAgIC8vIGdldHRpbmcgdGhlIGxpc3Qgb2YgcGVyc2lzdGVu\ndCB0eXBlcyBydW5zIGNhbGxiYWNrcyB0bwogICAgICAgIC8vIG1hcFBlcnNp\nc3RlbnRUeXBlTmFtZXMgaWYgaXQgaGFzbid0IGJlZW4gY2FsbGVkIGFscmVh\nZHksIHdoaWNoCiAgICAgICAgLy8gY2FjaGVzIFhNTCByZXNvdXJjZXMKICAg\nICAgICBnZXRQZXJzaXN0ZW50VHlwZU5hbWVzKGZhbHNlLCBlbnZMb2FkZXIp\nOwogICAgICAgIFVSTCB4bWwgPSBmaW5kWE1MKGNscyk7CgogICAgICAgIC8v\nIHdlIGhhdmUgdG8gcGFyc2UgbWV0YWRhdGEgdXAtZnJvbnQgdG8gcmVnaXN0\nZXIgcGVyc2lzdGVuY2UgdW5pdAogICAgICAgIC8vIGRlZmF1bHRzIGFuZCBz\neXN0ZW0gY2FsbGJhY2tzCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhOwog\nICAgICAgIGJvb2xlYW4gcGFyc2VkWE1MID0gZmFsc2U7CiAgICAgICAgaWYg\nKF91bnBhcnNlZCAhPSBudWxsICYmICFfdW5wYXJzZWQuaXNFbXB0eSgpCiAg\nICAgICAgICAgICYmIChtb2RlICYgTU9ERV9NRVRBKSAhPSAwKSB7CiAgICAg\nICAgICAgIGZvciAoVVJMIHVybCA6IF91bnBhcnNlZCkKICAgICAgICAgICAg\nICAgIHBhcnNlWE1MKHVybCwgY2xzLCBtb2RlLCBlbnZMb2FkZXIpOwogICAg\nICAgICAgICBwYXJzZWRYTUwgPSBfdW5wYXJzZWQuY29udGFpbnMoeG1sKTsK\nICAgICAgICAgICAgX3VucGFyc2VkLmNsZWFyKCk7CgogICAgICAgICAgICAv\nLyBYTUwgcHJvY2VzcyBjaGVjawogICAgICAgICAgICBtZXRhID0gcmVwb3Mu\nZ2V0Q2FjaGVkTWV0YURhdGEoY2xzKTsKICAgICAgICAgICAgaWYgKG1ldGEg\nIT0gbnVsbCAmJiAobWV0YS5nZXRTb3VyY2VNb2RlKCkgJiBtb2RlKSA9PSBt\nb2RlKSB7CiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0cmF0ZWdpZXMobWV0\nYSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIC8vIG1pZ2h0IGhhdmUgYmVlbiBsb29raW5nIGZv\nciBzeXN0ZW0tbGV2ZWwgcXVlcnkKICAgICAgICBpZiAoY2xzID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gd2UgbWF5IHN0aWxs\nIG5lZWQgdG8gcGFyc2UgWE1MIGlmIHRoaXMgaXMgYSByZWRlcGxveSBvZiBh\nIGNsYXNzLCBvcgogICAgICAgIC8vIGlmIHdlJ3JlIGluIHN0cmljdCBxdWVy\neS1vbmx5IG1vZGUKICAgICAgICBpZiAoIXBhcnNlZFhNTCAmJiB4bWwgIT0g\nbnVsbCkgewogICAgICAgICAgICBwYXJzZVhNTCh4bWwsIGNscywgbW9kZSwg\nZW52TG9hZGVyKTsKICAgICAgICAgICAgLy8gWE1MIHByb2Nlc3MgY2hlY2sK\nICAgICAgICAgICAgbWV0YSA9IHJlcG9zLmdldENhY2hlZE1ldGFEYXRhKGNs\ncyk7CiAgICAgICAgICAgIGlmIChtZXRhICE9IG51bGwgJiYgKG1ldGEuZ2V0\nU291cmNlTW9kZSgpICYgbW9kZSkgPT0gbW9kZSkgewogICAgICAgICAgICAg\nICAgdmFsaWRhdGVTdHJhdGVnaWVzKG1ldGEpOwogICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBBbm5v\ndGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBwYXJzZXIgPSBnZXRB\nbm5vdGF0aW9uUGFyc2VyKCk7CiAgICAgICAgcGFyc2VyLnNldEVudkNsYXNz\nTG9hZGVyKGVudkxvYWRlcik7CiAgICAgICAgcGFyc2VyLnNldE1vZGUobW9k\nZSk7CiAgICAgICAgcGFyc2VyLnBhcnNlKGNscyk7CgogICAgICAgIG1ldGEg\nPSByZXBvcy5nZXRDYWNoZWRNZXRhRGF0YShjbHMpOwogICAgICAgIGlmICht\nZXRhICE9IG51bGwgJiYgKG1ldGEuZ2V0U291cmNlTW9kZSgpICYgbW9kZSkg\nPT0gbW9kZSkKICAgICAgICAgICAgdmFsaWRhdGVTdHJhdGVnaWVzKG1ldGEp\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGhlIGdpdmVuIFhNTCBy\nZXNvdXJjZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNlWE1MKFVS\nTCB4bWwsIENsYXNzIGNscywgaW50IG1vZGUsIENsYXNzTG9hZGVyIGVudkxv\nYWRlcikgewogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IHJlcG9zLmdl\ndENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0Q2xhc3NSZXNvbHZl\nckluc3RhbmNlKCkuZ2V0Q2xhc3NMb2FkZXIoY2xzLCBlbnZMb2FkZXIpOwog\nICAgICAgIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgeG1sUGFyc2Vy\nID0gZ2V0WE1MUGFyc2VyKCk7CiAgICAgICAgeG1sUGFyc2VyLnNldENsYXNz\nTG9hZGVyKGVudkxvYWRlciAhPSBudWxsID8gZW52TG9hZGVyIDogbG9hZGVy\nKTsKICAgICAgICB4bWxQYXJzZXIuc2V0RW52Q2xhc3NMb2FkZXIoZW52TG9h\nZGVyKTsKICAgICAgICB4bWxQYXJzZXIuc2V0TW9kZShtb2RlKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB4bWxQYXJzZXIucGFyc2UoeG1sKTsKICAg\nICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oaW9lKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBMb2NhdGUgdGhlIFhNTCByZXNvdXJjZSBm\nb3IgdGhlIGdpdmVuIGNsYXNzLgogICAgICovCiAgICBwcml2YXRlIFVSTCBm\naW5kWE1MKENsYXNzIGNscykgewogICAgICAgIGlmIChfeG1sICE9IG51bGwg\nJiYgY2xzICE9IG51bGwpCiAgICAgICAgICAgIGZvciAoTWFwLkVudHJ5PFVS\nTCwgU2V0PiBlbnRyeSA6IF94bWwuZW50cnlTZXQoKSkKICAgICAgICAgICAg\nICAgIGlmIChlbnRyeS5nZXRWYWx1ZSgpLmNvbnRhaW5zKGNscy5nZXROYW1l\nKCkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS5nZXRLZXko\nKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCB2b2lkIG1hcFBlcnNpc3RlbnRUeXBlTmFtZXMoT2Jq\nZWN0IHJzcmMsIFN0cmluZ1tdIG5hbWVzKSB7CiAgICAgICAgaWYgKCEocnNy\nYyBpbnN0YW5jZW9mIFVSTCkgfHwgcnNyYy50b1N0cmluZygpLmVuZHNXaXRo\nKCIuY2xhc3MiKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBpZiAo\nX3htbCA9PSBudWxsKQogICAgICAgICAgICBfeG1sID0gbmV3IEhhc2hNYXA8\nVVJMLCBTZXQ+KCk7CiAgICAgICAgX3htbC5wdXQoKFVSTCkgcnNyYywgbmV3\nIEhhc2hTZXQoQXJyYXlzLmFzTGlzdChuYW1lcykpKTsKICAgICAgICBpZiAo\nX3VucGFyc2VkID09IG51bGwpCiAgICAgICAgICAgIF91bnBhcnNlZCA9IG5l\ndyBIYXNoU2V0PFVSTD4oKTsKICAgICAgICBfdW5wYXJzZWQuYWRkKChVUkwp\nIHJzcmMpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIENsYXNz\nIGdldFF1ZXJ5U2NvcGUoU3RyaW5nIHF1ZXJ5TmFtZSwgQ2xhc3NMb2FkZXIg\nbG9hZGVyKSB7CiAgICAgICAgaWYgKHF1ZXJ5TmFtZSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBDb2xsZWN0aW9uIGNsYXNz\nZXMgPSByZXBvcy5sb2FkUGVyc2lzdGVudFR5cGVzKGZhbHNlLCBsb2FkZXIp\nOwogICAgICAgIGZvciAoQ2xhc3MgY2xzIDogKENvbGxlY3Rpb248Q2xhc3M+\nKSBjbGFzc2VzKSB7CiAgICAgICAgICAgIGlmIChjbHMuaXNBbm5vdGF0aW9u\nUHJlc2VudChOYW1lZFF1ZXJ5LmNsYXNzKSAmJiBoYXNOYW1lZFF1ZXJ5CiAg\nICAgICAgICAgICAgICAocXVlcnlOYW1lLCAoTmFtZWRRdWVyeSkgY2xzLmdl\ndEFubm90YXRpb24oTmFtZWRRdWVyeS5jbGFzcykpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIGNsczsKICAgICAgICAgICAgaWYgKGNscy5pc0Fubm90YXRp\nb25QcmVzZW50KE5hbWVkUXVlcmllcy5jbGFzcykgJiYKICAgICAgICAgICAg\nICAgIGhhc05hbWVkUXVlcnkocXVlcnlOYW1lLCAoKE5hbWVkUXVlcmllcykg\nY2xzLgogICAgICAgICAgICAgICAgICAgIGdldEFubm90YXRpb24oTmFtZWRR\ndWVyaWVzLmNsYXNzKSkudmFsdWUoKSkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gY2xzOwogICAgICAgICAgICBpZiAoY2xzLmlzQW5ub3RhdGlvblByZXNl\nbnQoTmFtZWROYXRpdmVRdWVyeS5jbGFzcykgJiYKICAgICAgICAgICAgICAg\nIGhhc05hbWVkTmF0aXZlUXVlcnkocXVlcnlOYW1lLCAoTmFtZWROYXRpdmVR\ndWVyeSkgY2xzLgogICAgICAgICAgICAgICAgICAgIGdldEFubm90YXRpb24o\nTmFtZWROYXRpdmVRdWVyeS5jbGFzcykpKQogICAgICAgICAgICAgICAgcmV0\ndXJuIGNsczsKICAgICAgICAgICAgaWYgKGNscy5pc0Fubm90YXRpb25QcmVz\nZW50KE5hbWVkTmF0aXZlUXVlcmllcy5jbGFzcykgJiYKICAgICAgICAgICAg\nICAgIGhhc05hbWVkTmF0aXZlUXVlcnkocXVlcnlOYW1lLCAoKE5hbWVkTmF0\naXZlUXVlcmllcykgY2xzLgogICAgICAgICAgICAgICAgICAgIGdldEFubm90\nYXRpb24oTmFtZWROYXRpdmVRdWVyaWVzLmNsYXNzKSkudmFsdWUoKSkpCiAg\nICAgICAgICAgICAgICByZXR1cm4gY2xzOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW4gaGFzTmFt\nZWRRdWVyeShTdHJpbmcgcXVlcnksIE5hbWVkUXVlcnkuLi4gcXVlcmllcykg\newogICAgICAgIGZvciAoTmFtZWRRdWVyeSBxIDogcXVlcmllcykgewogICAg\nICAgICAgICBpZiAocXVlcnkuZXF1YWxzKHEubmFtZSgpKSkKICAgICAgICAg\nICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGhhc05hbWVkTmF0\naXZlUXVlcnkoU3RyaW5nIHF1ZXJ5LAogICAgICAgIE5hbWVkTmF0aXZlUXVl\ncnkuLi4gcXVlcmllcykgewogICAgICAgIGZvciAoTmFtZWROYXRpdmVRdWVy\neSBxIDogcXVlcmllcykgewogICAgICAgICAgICBpZiAocXVlcnkuZXF1YWxz\nKHEubmFtZSgpKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgTWV0YURhdGFGaWx0ZXIgbmV3TWV0YURhdGFG\naWx0ZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDbGFzc0Fubm90YXRpb25N\nZXRhRGF0YUZpbHRlcihuZXcgQ2xhc3NbXXsKICAgICAgICAgICAgRW50aXR5\nLmNsYXNzLCBFbWJlZGRhYmxlLmNsYXNzLCBNYXBwZWRTdXBlcmNsYXNzLmNs\nYXNzIH0pOwogICAgfQoKICAgIC8qKgogICAgICogRW5zdXJlIGFsbCBmaWVs\nZHMgaGF2ZSBkZWNsYXJlZCBhIHN0cmF0ZWd5LgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgdmFsaWRhdGVTdHJhdGVnaWVzKENsYXNzTWV0YURhdGEgbWV0\nYSkgewogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBudWxsOwogICAgICAg\nIGZvciAoRmllbGRNZXRhRGF0YSBmbWQgOiBtZXRhLmdldERlY2xhcmVkRmll\nbGRzKCkpIHsKICAgICAgICAgICAgaWYgKCFmbWQuaXNFeHBsaWNpdCgpKSB7\nCiAgICAgICAgICAgICAgICBpZiAoYnVmID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwg\nIik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGZtZCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGJ1ZiAhPSBudWxsKQogICAg\nICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQo\nIm5vLXBlcnMtc3RyYXQiLCBidWYpKTsKICAgIH0KCiAgICBwdWJsaWMgTWV0\nYURhdGFEZWZhdWx0cyBnZXREZWZhdWx0cygpIHsKICAgICAgICByZXR1cm4g\nX2RlZjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBDbGFzc0Fy\nZ1BhcnNlciBuZXdDbGFzc0FyZ1BhcnNlcigpIHsKICAgICAgICBDbGFzc0Fy\nZ1BhcnNlciBwYXJzZXIgPSBuZXcgQ2xhc3NBcmdQYXJzZXIoKTsKICAgICAg\nICBwYXJzZXIuc2V0TWV0YURhdGFTdHJ1Y3R1cmUoInBhY2thZ2UiLCBudWxs\nLCBuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJlbnRpdHkiLCAiZW1iZWRk\nYWJsZSIsICJtYXBwZWQtc3VwZXJjbGFzcyIgfSwgImNsYXNzIik7CiAgICAg\nICAgcmV0dXJuIHBhcnNlcjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyB2b2lkIGNsZWFyKCkgewogICAgICAgIHN1cGVyLmNsZWFyKCk7CiAg\nICAgICAgaWYgKF9hbm5vUGFyc2VyICE9IG51bGwpCiAgICAgICAgICAgIF9h\nbm5vUGFyc2VyLmNsZWFyKCk7CiAgICAgICAgaWYgKF94bWxQYXJzZXIgIT0g\nbnVsbCkKICAgICAgICAgICAgX3htbFBhcnNlci5jbGVhcigpOwogICAgICAg\nIGlmIChfeG1sICE9IG51bGwpCiAgICAgICAgICAgIF94bWwuY2xlYXIoKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgUGFyc2VyIG5ld1BhcnNlcihib29sZWFu\nIGxvYWRpbmcpIHsKICAgICAgICByZXR1cm4gbmV3WE1MUGFyc2VyKGxvYWRp\nbmcpOwogICAgfQoKICAgIHByb3RlY3RlZCBTZXJpYWxpemVyIG5ld1Nlcmlh\nbGl6ZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ld1hNTFNlcmlhbGl6ZXIoKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHBhcnNl\nKE1ldGFEYXRhUGFyc2VyIHBhcnNlciwgQ2xhc3NbXSBjbHMpIHsKICAgICAg\nICBwYXJzZShwYXJzZXIsIENvbGxlY3Rpb25zLnNpbmdsZXRvbihkZWZhdWx0\nWE1MRmlsZSgpKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIEZpbGUgZGVmYXVs\ndFNvdXJjZUZpbGUoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgcmV0\ndXJuIGRlZmF1bHRYTUxGaWxlKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIEZp\nbGUgZGVmYXVsdFNvdXJjZUZpbGUoUXVlcnlNZXRhRGF0YSBxdWVyeSwgTWFw\nIGNsc05hbWVzKSB7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gZ2V0\nRGVmaW5pbmdNZXRhRGF0YShxdWVyeSwgY2xzTmFtZXMpOwogICAgICAgIEZp\nbGUgZmlsZSA9IChtZXRhID09IG51bGwpID8gbnVsbCA6IG1ldGEuZ2V0U291\ncmNlRmlsZSgpOwogICAgICAgIGlmIChmaWxlICE9IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBmaWxlOwogICAgICAgIHJldHVybiBkZWZhdWx0WE1MRmls\nZSgpOwogICAgfQoKICAgIHByb3RlY3RlZCBGaWxlIGRlZmF1bHRTb3VyY2VG\naWxlKFNlcXVlbmNlTWV0YURhdGEgc2VxLCBNYXAgY2xzTmFtZXMpIHsKICAg\nICAgICByZXR1cm4gZGVmYXVsdFhNTEZpbGUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIExvb2sgZm9yIE1FVEEtSU5GL29ybS54bWwsIGFuZCBpZiBpdCBk\nb2Vzbid0IGV4aXN0LCBjaG9vc2UgYSBkZWZhdWx0LgogICAgICovCiAgICBw\ncml2YXRlIEZpbGUgZGVmYXVsdFhNTEZpbGUoKSB7CiAgICAgICAgQ2xhc3NM\nb2FkZXIgbG9hZGVyID0gcmVwb3MuZ2V0Q29uZmlndXJhdGlvbigpLgogICAg\nICAgICAgICBnZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS5nZXRDbGFzc0xv\nYWRlcihnZXRDbGFzcygpLCBudWxsKTsKICAgICAgICBVUkwgcnNyYyA9IGxv\nYWRlci5nZXRSZXNvdXJjZSgiTUVUQS1JTkYvb3JtLnhtbCIpOwogICAgICAg\nIGlmIChyc3JjICE9IG51bGwpIHsKICAgICAgICAgICAgRmlsZSBmaWxlID0g\nbmV3IEZpbGUocnNyYy5nZXRGaWxlKCkpOwogICAgICAgICAgICBpZiAoZmls\nZS5leGlzdHMoKSkKICAgICAgICAgICAgICAgIHJldHVybiBmaWxlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gbmV3IEZpbGUoIm9ybS54bWwiKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb25maWd1cmF0aW9uKENvbmZpZ3Vy\nYXRpb24gY29uZikgewogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29u\nZmlndXJhdGlvbigpIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25m\naWd1cmF0aW9uKCkgewogICAgICAgIGlmIChyc3JjcyA9PSBudWxsKQogICAg\nICAgICAgICByc3JjcyA9IENvbGxlY3Rpb25zLnNpbmdsZXRvbigiTUVUQS1J\nTkYvb3JtLnhtbCIpOwogICAgICAgIGVsc2UKCQkJcnNyY3MuYWRkICgiTUVU\nQS1JTkYvb3JtLnhtbCIpOwoJfQoKICAgIHB1YmxpYyB2b2lkIHNldEludG8o\nT3B0aW9ucyBvcHRzKSB7CiAgICAgICAgb3B0cy5rZXlTZXQoKS5yZXRhaW5B\nbGwob3B0cy5zZXRJbnRvKF9kZWYpLmtleVNldCgpKTsKICAgIH0KfQo=\n","encoding":"base64"}

