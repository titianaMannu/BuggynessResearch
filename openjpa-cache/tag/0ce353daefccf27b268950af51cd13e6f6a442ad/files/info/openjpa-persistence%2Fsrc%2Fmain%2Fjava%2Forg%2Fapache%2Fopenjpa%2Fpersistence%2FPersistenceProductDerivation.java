{"sha":"04d19de3de38e406eb47b99df7a7ee525e208d7a","node_id":"MDQ6QmxvYjIwNjM2NDowNGQxOWRlM2RlMzhlNDA2ZWI0N2I5OWRmN2E3ZWU1MjVlMjA4ZDdh","size":18399,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/04d19de3de38e406eb47b99df7a7ee525e208d7a","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBqYXZhLmlvLkZpbGU7Cmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJM\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5NaXNzaW5nUmVzb3VyY2VFeGNlcHRpb247Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5zcGkuUGVyc2lzdGVuY2VVbml0SW5m\nbzsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLnNwaS5QZXJzaXN0ZW5jZVVu\naXRUcmFuc2FjdGlvblR5cGU7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFQcm9kdWN0RGVyaXZh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5BYnN0\ncmFjdFByb2R1Y3REZXJpdmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5jb25mLlByb2R1Y3REZXJpdmF0aW9uczsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25Qcm92\naWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5NYXBD\nb25maWd1cmF0aW9uUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLm1ldGEuWE1MTWV0YURhdGFQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLnhtbC5zYXgu\nQXR0cmlidXRlczsKaW1wb3J0IG9yZy54bWwuc2F4LlNBWEV4Y2VwdGlvbjsK\nCi8qKgogKiBTZXRzIEpQQSBzcGVjaWZpY2F0aW9uIGRlZmF1bHRzIGFuZCBw\nYXJzZXMgSlBBIHNwZWNpZmljYXRpb24gWE1MIGZpbGVzLgogKiAKICogRm9y\nIGdsb2JhbHMsIGxvb2tzIGluIDxjb2RlPm9wZW5qcGEucHJvcGVydGllczwv\nY29kZT4gc3lzdGVtIHByb3BlcnR5IGZvcgogKiB0aGUgbG9jYXRpb24gb2Yg\nYSBmaWxlIHRvIHBhcnNlLiBJZiBubyBzeXN0ZW0gcHJvcGVydHkgaXMgZGVm\naW5lZCwgdGhlCiAqIGRlZmF1bHQgcmVzb3VyY2UgbG9jYXRpb24gb2YgPGNv\nZGU+TUVUQS1JTkYvb3BlbmpwYS54bWw8L2NvZGU+IGlzIHVzZWQuCiAqCiAq\nIEZvciBkZWZhdWx0cywgbG9va3MgZm9yIDxjb2RlPk1FVEEtSU5GL3BlcnNp\nc3RlbmNlLnhtbDwvY29kZT4uCiAqIFdpdGhpbiA8Y29kZT5wZXJzaXN0ZW5j\nZS54bWw8L2NvZGU+LCBsb29rIGZvciB0aGUgbmFtZWQgcGVyc2lzdGVuY2Ug\ndW5pdCwgb3IKICogaWYgbm8gbmFtZSBnaXZlbiwgYW4gT3BlbkpQQSB1bml0\nIChwcmVmZXJyaW5nIGFuIHVubmFtZWQgT3BlbkpQQSB1bml0IHRvIAogKiBh\nIG5hbWVkIG9uZSkuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBQZXJzaXN0ZW5jZVByb2R1Y3REZXJp\ndmF0aW9uIAogICAgZXh0ZW5kcyBBYnN0cmFjdFByb2R1Y3REZXJpdmF0aW9u\nCiAgICBpbXBsZW1lbnRzIE9wZW5KUEFQcm9kdWN0RGVyaXZhdGlvbiB7Cgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgU1BFQ19KUEEgPSAianBh\nIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFMSUFTX0VKQiA9\nICJlamIiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgUlNSQ19H\nTE9CQUwgPSAiTUVUQS1JTkYvb3BlbmpwYS54bWwiOwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgUlNSQ19ERUZBVUxUID0gIk1FVEEtSU5GL3Bl\ncnNpc3RlbmNlLnhtbCI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChQ\nZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0aW9uLmNsYXNzKTsKCiAgICBwdWJs\naWMgdm9pZCBwdXRCcm9rZXJGYWN0b3J5QWxpYXNlcyhNYXAgbSkgewogICAg\nfQoKICAgIHB1YmxpYyBpbnQgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4g\nVFlQRV9TUEVDOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgdmFsaWRhdGUoKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIC8vIG1ha2Ugc3VyZSBKUEEgaXMgYXZhaWxhYmxlCiAgICAgICAgamF2\nYXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3RvcnkuY2xhc3MuZ2V0\nQ2xhc3NMb2FkZXIoKTsKICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgYm9vbGVhbiBiZWZvcmVDb25maWd1cmF0aW9uTG9hZChDb25maWd1\ncmF0aW9uIGMpIHsKICAgICAgICBpZiAoIShjIGluc3RhbmNlb2YgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb25JbXBsKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIAogICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCBj\nb25mID0gKE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCkgYzsKICAgICAgICBj\nb25mLm1ldGFGYWN0b3J5UGx1Z2luLnNldEFsaWFzKEFMSUFTX0VKQiwKICAg\nICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkuY2xhc3MuZ2V0\nTmFtZSgpKTsKICAgICAgICBjb25mLm1ldGFGYWN0b3J5UGx1Z2luLnNldEFs\naWFzKFNQRUNfSlBBLAogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRh\nRmFjdG9yeS5jbGFzcy5nZXROYW1lKCkpOwogICAgICAgIAogICAgICAgIGNv\nbmYuYWRkVmFsdWUobmV3IEVudGl0eU1hbmFnZXJGYWN0b3J5VmFsdWUoKSk7\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgYm9vbGVhbiBhZnRlclNwZWNpZmljYXRpb25TZXQoQ29uZmln\ndXJhdGlvbiBjKSB7CiAgICAgIGlmICghKGMgaW5zdGFuY2VvZiBPcGVuSlBB\nQ29uZmlndXJhdGlvbkltcGwpCiAgICAgICAgIHx8ICFTUEVDX0pQQS5lcXVh\nbHMoKChPcGVuSlBBQ29uZmlndXJhdGlvbiljKS5nZXRTcGVjaWZpY2F0aW9u\nKCkpKQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogCiAgICAgICAgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb25JbXBsIGNvbmYgPSAoT3BlbkpQQUNvbmZpZ3VyYXRp\nb25JbXBsKSBjOwogICAgICAgIGNvbmYubWV0YUZhY3RvcnlQbHVnaW4uc2V0\nRGVmYXVsdChTUEVDX0pQQSk7CiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBs\ndWdpbi5zZXRTdHJpbmcoU1BFQ19KUEEpOwogICAgICAgIGNvbmYubG9ja01h\nbmFnZXJQbHVnaW4uc2V0RGVmYXVsdCgidmVyc2lvbiIpOwogICAgICAgIGNv\nbmYubG9ja01hbmFnZXJQbHVnaW4uc2V0U3RyaW5nKCJ2ZXJzaW9uIik7CiAg\nICAgICAgY29uZi5ub250cmFuc2FjdGlvbmFsV3JpdGUuc2V0RGVmYXVsdCgi\ndHJ1ZSIpOwogICAgICAgIGNvbmYubm9udHJhbnNhY3Rpb25hbFdyaXRlLnNl\ndCh0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIExvYWQgY29uZmlndXJhdGlvbiBmcm9tIHRoZSBnaXZlbiBwZXJz\naXN0ZW5jZSB1bml0IHdpdGggdGhlIHNwZWNpZmllZAogICAgICogdXNlciBw\ncm9wZXJ0aWVzLgogICAgICovCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvblBy\nb3ZpZGVyIGxvYWQoUGVyc2lzdGVuY2VVbml0SW5mbyBwaW5mbywgTWFwIG0p\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAocGlu\nZm8gPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\naWYgKCFpc09wZW5KUEFQZXJzaXN0ZW5jZVByb3ZpZGVyKHBpbmZvLCBudWxs\nKSkgewogICAgICAgICAgICB3YXJuVW5rbm93blByb3ZpZGVyKHBpbmZvKTsK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBD\nb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRp\nb25Qcm92aWRlckltcGwoKTsKICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKFBl\ncnNpc3RlbmNlVW5pdEluZm9JbXBsLnRvT3BlbkpQQVByb3BlcnRpZXMocGlu\nZm8pKTsKICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKG0pOwogICAgICAgIGlm\nIChwaW5mbyBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsKSB7\nCiAgICAgICAgICAgIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsIGltcGwgPSAo\nUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwpIHBpbmZvOwogICAgICAgICAgICBp\nZiAoaW1wbC5nZXRQZXJzaXN0ZW5jZVhtbEZpbGVVcmwoKSAhPSBudWxsKQog\nICAgICAgICAgICAgICAgY3Auc2V0U291cmNlKGltcGwuZ2V0UGVyc2lzdGVu\nY2VYbWxGaWxlVXJsKCkudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBjcDsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgY29uZmln\ndXJhdGlvbiBmcm9tIHRoZSBnaXZlbiByZXNvdXJjZSBhbmQgdW5pdCBuYW1l\ncywgd2hpY2ggbWF5CiAgICAgKiBiZSBudWxsLgogICAgICovCiAgICBwdWJs\naWMgQ29uZmlndXJhdGlvblByb3ZpZGVyIGxvYWQoU3RyaW5nIHJzcmMsIFN0\ncmluZyBuYW1lLCBNYXAgbSkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgIGJvb2xlYW4gZXhwbGljaXQgPSAhU3RyaW5nVXRpbHMuaXNF\nbXB0eShyc3JjKTsKICAgICAgICBpZiAoIWV4cGxpY2l0KQogICAgICAgICAg\nICByc3JjID0gUlNSQ19ERUZBVUxUOwogICAgICAgIAogICAgICAgIENvbmZp\nZ3VyYXRpb25Qcm92aWRlckltcGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblBy\nb3ZpZGVySW1wbCgpOwogICAgICAgIEJvb2xlYW4gcmV0ID0gbG9hZChjcCwg\ncnNyYywgbmFtZSwgbSwgbnVsbCwgZXhwbGljaXQpOwogICAgICAgIGlmIChy\nZXQgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIChyZXQuYm9vbGVhblZh\nbHVlKCkpID8gY3AgOiBudWxsOwogICAgICAgIGlmIChleHBsaWNpdCkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIHBlcnNpc3RlbmNl\nLnhtbCBkb2VzIG5vdCBleGlzdDsganVzdCBsb2FkIG1hcAogICAgICAgIFBl\ncnNpc3RlbmNlVW5pdEluZm9JbXBsIHBpbmZvID0gbmV3IFBlcnNpc3RlbmNl\nVW5pdEluZm9JbXBsKCk7CiAgICAgICAgcGluZm8uZnJvbVVzZXJQcm9wZXJ0\naWVzKG0pOwogICAgICAgIGlmICghaXNPcGVuSlBBUGVyc2lzdGVuY2VQcm92\naWRlcihwaW5mbywgbnVsbCkpIHsKICAgICAgICAgICAgd2FyblVua25vd25Q\ncm92aWRlcihwaW5mbyk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgIH0KICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKHBpbmZvLnRvT3BlbkpQ\nQVByb3BlcnRpZXMoKSk7CiAgICAgICAgcmV0dXJuIGNwOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBs\nb2FkKFN0cmluZyByc3JjLCBTdHJpbmcgYW5jaG9yLCAKICAgICAgICBDbGFz\nc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAocnNyYyAhPSBudWxsICYmICFyc3JjLmVuZHNXaXRoKCIu\neG1sIikpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIENvbmZp\nZ3VyYXRpb25Qcm92aWRlckltcGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblBy\nb3ZpZGVySW1wbCgpOwogICAgICAgIGlmIChsb2FkKGNwLCByc3JjLCBhbmNo\nb3IsIG51bGwsIGxvYWRlciwgdHJ1ZSkgPT0gQm9vbGVhbi5UUlVFKQogICAg\nICAgICAgICByZXR1cm4gY3A7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvblByb3Zp\nZGVyIGxvYWQoRmlsZSBmaWxlLCBTdHJpbmcgYW5jaG9yKSAKICAgICAgICB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmICghZmlsZS5nZXROYW1l\nKCkuZW5kc1dpdGgoIi54bWwiKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCgogICAgICAgIENvbmZpZ3VyYXRpb25QYXJzZXIgcGFyc2VyID0gbmV3IENv\nbmZpZ3VyYXRpb25QYXJzZXIobnVsbCk7CiAgICAgICAgcGFyc2VyLnBhcnNl\nKGZpbGUpOwogICAgICAgIHJldHVybiBsb2FkKGZpbmRVbml0KChMaXN0PFBl\ncnNpc3RlbmNlVW5pdEluZm9JbXBsPikgCiAgICAgICAgICAgIHBhcnNlci5n\nZXRSZXN1bHRzKCksIGFuY2hvciwgbnVsbCksIG51bGwpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBs\nb2FkR2xvYmFscyhDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFBy\nb2R1Y3REZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsK\nICAgICAgICBTdHJpbmcgcnNyYyA9IG51bGw7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBwcmVmaXhlcy5sZW5ndGggJiYgU3RyaW5nVXRpbHMuaXNF\nbXB0eShyc3JjKTsgaSsrKQogICAgICAgICAgIHJzcmMgPSBTeXN0ZW0uZ2V0\nUHJvcGVydHkocHJlZml4ZXNbaV0gKyAiLnByb3BlcnRpZXMiKTsgCiAgICAg\nICAgYm9vbGVhbiBleHBsaWNpdCA9ICFTdHJpbmdVdGlscy5pc0VtcHR5KHJz\ncmMpOwogICAgICAgIFN0cmluZyBhbmNob3IgPSBudWxsOwogICAgICAgIGlu\ndCBpZHggPSAoIWV4cGxpY2l0KSA/IC0xIDogcnNyYy5sYXN0SW5kZXhPZign\nIycpOwogICAgICAgIGlmIChpZHggIT0gLTEpIHsKICAgICAgICAgICAgLy8g\nc2VwYXJhdGUgbmFtZSBmcm9tIDxyZXNyb3VjZT4jPG5hbWU+IHN0cmluZwog\nICAgICAgICAgICBpZiAoaWR4IDwgcnNyYy5sZW5ndGgoKSAtIDEpCiAgICAg\nICAgICAgICAgICBhbmNob3IgPSByc3JjLnN1YnN0cmluZyhpZHggKyAxKTsK\nICAgICAgICAgICAgcnNyYyA9IHJzcmMuc3Vic3RyaW5nKDAsIGlkeCk7CiAg\nICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHJzcmMp\nKQogICAgICAgICAgICByc3JjID0gUlNSQ19HTE9CQUw7CiAgICAgICAgZWxz\nZSBpZiAoIXJzcmMuZW5kc1dpdGgoIi54bWwiKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwg\nY3AgPSBuZXcgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCgpOwogICAgICAg\nIGlmIChsb2FkKGNwLCByc3JjLCBhbmNob3IsIG51bGwsIGxvYWRlciwgZXhw\nbGljaXQpID09IEJvb2xlYW4uVFJVRSkKICAgICAgICAgICAgcmV0dXJuIGNw\nOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkRGVmYXVsdHMo\nQ2xhc3NMb2FkZXIgbG9hZGVyKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCBjcCA9IG5l\ndyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKCk7CiAgICAgICAgaWYgKGxv\nYWQoY3AsIFJTUkNfREVGQVVMVCwgbnVsbCwgbnVsbCwgbG9hZGVyLCBmYWxz\nZSkgPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAgICByZXR1cm4gY3A7CiAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb29r\ncyB0aHJvdWdoIHRoZSByZXNvdXJjZXMgYXQgPGNvZGU+cnNyYzwvY29kZT4g\nZm9yIGEgY29uZmlndXJhdGlvbgogICAgICogZmlsZSB0aGF0IG1hdGNoZXMg\nPGNvZGU+bmFtZTwvY29kZT4gKG9yIGFuIHVubmFtZWQgb25lIGlmCiAgICAg\nKiA8Y29kZT5uYW1lPC9jb2RlPiBpcyA8Y29kZT5udWxsPC9jb2RlPiksIGFu\nZCBsb2FkcyB0aGUgWE1MIGluIHRoZQogICAgICogcmVzb3VyY2UgaW50byBh\nIG5ldyB7QGxpbmsgUGVyc2lzdGVuY2VVbml0SW5mb30uIFRoZW4sIGFwcGxp\nZXMgdGhlCiAgICAgKiBvdmVycmlkZXMgaW4gPGNvZGU+bTwvY29kZT4uCiAg\nICAgKgogICAgICogQHJldHVybiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBpZiB0\naGUgcmVzb3VyY2Ugd2FzIGxvYWRlZCwgbnVsbCBpZiBpdAogICAgICogZG9l\ncyBub3QgZXhpc3QsIG9yIHtAbGluayBCb29sZWFuI0ZBTFNFfSBpZiBpdCBp\ncyBub3QgZm9yIE9wZW5KUEEKICAgICAqLwogICAgcHJpdmF0ZSBCb29sZWFu\nIGxvYWQoQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCBjcCwgU3RyaW5nIHJz\ncmMsIAogICAgICAgIFN0cmluZyBuYW1lLCBNYXAgbSwgQ2xhc3NMb2FkZXIg\nbG9hZGVyLCBib29sZWFuIGV4cGxpY2l0KQogICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKGxvYWRlciA9PSBudWxsKQogICAgICAg\nICAgICBsb2FkZXIgPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRl\neHRDbGFzc0xvYWRlcigpOwoKICAgICAgICBFbnVtZXJhdGlvbjxVUkw+IHVy\nbHMgPSBsb2FkZXIuZ2V0UmVzb3VyY2VzKHJzcmMpOwogICAgICAgIGlmICgh\ndXJscy5oYXNNb3JlRWxlbWVudHMoKSkgewogICAgICAgICAgICBpZiAoIXJz\ncmMuc3RhcnRzV2l0aCgiTUVUQS1JTkYiKSkKICAgICAgICAgICAgICAgIHVy\nbHMgPSBsb2FkZXIuZ2V0UmVzb3VyY2VzKCJNRVRBLUlORi8iICsgcnNyYyk7\nCiAgICAgICAgICAgIGlmICghdXJscy5oYXNNb3JlRWxlbWVudHMoKSkKICAg\nICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAg\nQ29uZmlndXJhdGlvblBhcnNlciBwYXJzZXIgPSBuZXcgQ29uZmlndXJhdGlv\nblBhcnNlcihtKTsKICAgICAgICBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBw\naW5mbyA9IHBhcnNlUmVzb3VyY2VzKHBhcnNlciwgdXJscywgbmFtZSwgCiAg\nICAgICAgICAgIGxvYWRlcik7CiAgICAgICAgaWYgKHBpbmZvID09IG51bGwp\nIHsKICAgICAgICAgICAgaWYgKCFleHBsaWNpdCkKICAgICAgICAgICAgICAg\nIHJldHVybiBCb29sZWFuLkZBTFNFOwogICAgICAgICAgICB0aHJvdyBuZXcg\nTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKF9sb2MuZ2V0KCJtaXNzaW5nLXht\nbC1jb25maWciLCAKICAgICAgICAgICAgICAgIHJzcmMsIFN0cmluZy52YWx1\nZU9mKG5hbWUpKS5nZXRNZXNzYWdlKCksIGdldENsYXNzKCkuZ2V0TmFtZSgp\nLCAKICAgICAgICAgICAgICAgIHJzcmMpOwogICAgICAgIH0gZWxzZSBpZiAo\nIWlzT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIocGluZm8sIGxvYWRlcikp\nIHsKICAgICAgICAgICAgaWYgKCFleHBsaWNpdCkgewogICAgICAgICAgICAg\nICAgd2FyblVua25vd25Qcm92aWRlcihwaW5mbyk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gQm9vbGVhbi5GQUxTRTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJ1bmtub3duLXByb3ZpZGVyIiwgCiAgICAgICAgICAgICAgICByc3Jj\nLCBuYW1lLCBwaW5mby5nZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NOYW1l\nKCkpLgogICAgICAgICAgICAgICAgZ2V0TWVzc2FnZSgpLCBnZXRDbGFzcygp\nLmdldE5hbWUoKSwgcnNyYyk7CiAgICAgICAgfQogICAgICAgIGNwLmFkZFBy\nb3BlcnRpZXMocGluZm8udG9PcGVuSlBBUHJvcGVydGllcygpKTsKICAgICAg\nICBjcC5zZXRTb3VyY2UocGluZm8uZ2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJs\nKCkudG9TdHJpbmcoKSk7CiAgICAgICAgcmV0dXJuIEJvb2xlYW4uVFJVRTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIHJlc291cmNlcyBhdCB0aGUg\nZ2l2ZW4gbG9jYXRpb24uIFNlYXJjaGVzIGZvciBhCiAgICAgKiBQZXJzaXN0\nZW5jZVVuaXRJbmZvIHdpdGggdGhlIHJlcXVlc3RlZCBuYW1lLCBvciBhbiBP\ncGVuSlBBIHVuaXQgaWYKICAgICAqIG5vIG5hbWUgZ2l2ZW4gKHByZWZlcnJp\nbmcgYW4gdW5uYW1lZCBPcGVuSlBBIHVuaXQgdG8gYSBuYW1lZCBvbmUpLgog\nICAgICovCiAgICBwcml2YXRlIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsIHBh\ncnNlUmVzb3VyY2VzKENvbmZpZ3VyYXRpb25QYXJzZXIgcGFyc2VyLAogICAg\nICAgIEVudW1lcmF0aW9uPFVSTD4gdXJscywgU3RyaW5nIG5hbWUsIENsYXNz\nTG9hZGVyIGxvYWRlcikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIExpc3Q8UGVyc2lzdGVuY2VVbml0SW5mb0ltcGw+IHBpbmZvcyA9\nIAogICAgICAgICAgICBuZXcgQXJyYXlMaXN0PFBlcnNpc3RlbmNlVW5pdElu\nZm9JbXBsPigpOwogICAgICAgIGZvciAoVVJMIHVybCA6IENvbGxlY3Rpb25z\nLmxpc3QodXJscykpIHsKICAgICAgICAgICAgcGFyc2VyLnBhcnNlKHVybCk7\nCiAgICAgICAgICAgIHBpbmZvcy5hZGRBbGwoKExpc3Q8UGVyc2lzdGVuY2VV\nbml0SW5mb0ltcGw+KSBwYXJzZXIuZ2V0UmVzdWx0cygpKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGZpbmRVbml0KHBpbmZvcywgbmFtZSwgbG9hZGVy\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbmQgdGhlIHVuaXQgd2l0aCB0\naGUgZ2l2ZW4gbmFtZSwgb3IgYW4gT3BlbkpQQSB1bml0IGlmIG5vIG5hbWUg\naXMKICAgICAqIGdpdmVuIChwcmVmZXJyaW5nIGFuIHVubmFtZWQgT3BlbkpQ\nQSB1bml0IHRvIGEgbmFtZWQgb25lKS4KICAgICAqLwogICAgcHJpdmF0ZSBQ\nZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBmaW5kVW5pdChMaXN0PFBlcnNpc3Rl\nbmNlVW5pdEluZm9JbXBsPiAKICAgICAgICBwaW5mb3MsIFN0cmluZyBuYW1l\nLCBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBQZXJzaXN0ZW5jZVVu\naXRJbmZvSW1wbCBvanBhID0gbnVsbDsKICAgICAgICBmb3IgKFBlcnNpc3Rl\nbmNlVW5pdEluZm9JbXBsIHBpbmZvIDogcGluZm9zKSB7CiAgICAgICAgICAg\nIC8vIGZvdW5kIG5hbWVkIHVuaXQ/CiAgICAgICAgICAgIGlmIChuYW1lICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChuYW1lLmVxdWFscyhwaW5m\nby5nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkpKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBwaW5mbzsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoaXNPcGVuSlBBUGVyc2lz\ndGVuY2VQcm92aWRlcihwaW5mbywgbG9hZGVyKSkgewogICAgICAgICAgICAg\nICAgLy8gaWYgbm8gbmFtZSBnaXZlbiBhbmQgZm91bmQgdW5uYW1lZCB1bml0\nLCByZXR1cm4gaXQuICAKICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBy\nZWNvcmQgYXMgZGVmYXVsdCB1bml0IHVubGVzcyB3ZSBmaW5kIGEgCiAgICAg\nICAgICAgICAgICAvLyBiZXR0ZXIgbWF0Y2ggbGF0ZXIKICAgICAgICAgICAg\nICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHBpbmZvLmdldFBlcnNpc3Rl\nbmNlVW5pdE5hbWUoKSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBp\nbmZvOwogICAgICAgICAgICAgICAgaWYgKG9qcGEgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICBvanBhID0gcGluZm87CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIG9qcGE7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2ZW4gcGVyc2lzdGVuY2UgdW5p\ndCB1c2VzIGFuIE9wZW5KUEEgcHJvdmlkZXIuCiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIGJvb2xlYW4gaXNPcGVuSlBBUGVyc2lzdGVuY2VQcm92aWRl\ncgogICAgICAgIChQZXJzaXN0ZW5jZVVuaXRJbmZvIHBpbmZvLCBDbGFzc0xv\nYWRlciBsb2FkZXIpIHsKICAgICAgICBTdHJpbmcgcHJvdmlkZXIgPSBwaW5m\nby5nZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NOYW1lKCk7CiAgICAgICAg\naWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkocHJvdmlkZXIpIAogICAgICAgICAg\nICB8fCBQZXJzaXN0ZW5jZVByb3ZpZGVySW1wbC5jbGFzcy5nZXROYW1lKCku\nZXF1YWxzKHByb3ZpZGVyKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7Cgog\nICAgICAgIGlmIChsb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9hZGVy\nID0gVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2Fk\nZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoUGVyc2lzdGVu\nY2VQcm92aWRlckltcGwuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbQogICAgICAg\nICAgICAgICAgKENsYXNzLmZvck5hbWUocHJvdmlkZXIsIGZhbHNlLCBsb2Fk\nZXIpKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0g\nY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgIGxvZyhfbG9jLmdl\ndCgidW5sb2FkYWJsZS1wcm92aWRlciIsIHByb3ZpZGVyLCB0KS5nZXRNZXNz\nYWdlKCkpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdh\ncm4gdGhlIHVzZXIgdGhhdCB3ZSBjb3VsZCBvbmx5IGZpbmQgYW4gdW5yZWNv\nZ25pemVkIHBlcnNpc3RlbmNlIAogICAgICogcHJvdmlkZXIuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIHZvaWQgd2FyblVua25vd25Qcm92aWRlcihQ\nZXJzaXN0ZW5jZVVuaXRJbmZvIHBpbmZvKSB7CiAgICAgICAgbG9nKF9sb2Mu\nZ2V0KCJ1bnJlY29nbml6ZWQtcHJvdmlkZXIiLCAKICAgICAgICAgICAgcGlu\nZm8uZ2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpKS5nZXRNZXNz\nYWdlKCkpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIExvZyBhIG1lc3Nh\nZ2UuICAgCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgbG9nKFN0\ncmluZyBtc2cpIHsKICAgICAgICAvLyBhdCB0aGlzIHBvaW50IGxvZ2dpbmcg\naXNuJ3QgY29uZmlndXJlZCB5ZXQKICAgICAgICBTeXN0ZW0uZXJyLnByaW50\nbG4obXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIEN1c3RvbSBjb25maWd1\ncmF0aW9uIHByb3ZpZGVyLiAgIAogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGNsYXNzIENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwKICAgICAgICBleHRl\nbmRzIE1hcENvbmZpZ3VyYXRpb25Qcm92aWRlciB7CgogICAgICAgIHByaXZh\ndGUgU3RyaW5nIF9zb3VyY2U7CgogICAgICAgIHB1YmxpYyBDb25maWd1cmF0\naW9uUHJvdmlkZXJJbXBsKCkgewogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoTWFwIHByb3BzKSB7CiAgICAg\nICAgICAgIHN1cGVyKHByb3BzKTsKICAgICAgICB9CgogICAgICAgIC8qKgog\nICAgICAgICAqIFNldCB0aGUgc291cmNlIG9mIGluZm9ybWF0aW9uIGluIHRo\naXMgcHJvdmlkZXIuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIHZvaWQg\nc2V0U291cmNlKFN0cmluZyBzb3VyY2UpIHsKICAgICAgICAgICAgX3NvdXJj\nZSA9IHNvdXJjZTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyB2b2lkIHNldEludG8oQ29uZmlndXJhdGlvbiBjb25mKSB7\nCiAgICAgICAgICAgIGlmIChjb25mIGluc3RhbmNlb2YgT3BlbkpQQUNvbmZp\nZ3VyYXRpb24pCiAgICAgICAgICAgICAgICAoKE9wZW5KUEFDb25maWd1cmF0\naW9uKSBjb25mKS5zZXRTcGVjaWZpY2F0aW9uKFNQRUNfSlBBKTsKICAgICAg\nICAgICAgc3VwZXIuc2V0SW50byhjb25mLCBudWxsKTsKCiAgICAgICAgICAg\nIExvZyBsb2cgPSBjb25mLmdldENvbmZpZ3VyYXRpb25Mb2coKTsKICAgICAg\nICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAg\nICAgICBTdHJpbmcgc3JjID0gKF9zb3VyY2UgPT0gbnVsbCkgPyAiPyIgOiBf\nc291cmNlOwogICAgICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJj\nb25mLWxvYWQiLCBzcmMsIGdldFByb3BlcnRpZXMoKSkpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU0FYIGhhbmRs\nZXIgY2FwYWJsZSBvZiBwYXJzaW5nIGFuIEpQQSBwZXJzaXN0ZW5jZS54bWwg\nZmlsZS4KICAgICAqIFBhY2thZ2UtcHJvdGVjdGVkIGZvciB0ZXN0aW5nLgog\nICAgICovCiAgICBzdGF0aWMgY2xhc3MgQ29uZmlndXJhdGlvblBhcnNlcgog\nICAgICAgIGV4dGVuZHMgWE1MTWV0YURhdGFQYXJzZXIgewoKICAgICAgICBw\ncml2YXRlIGZpbmFsIE1hcCBfbWFwOwogICAgICAgIHByaXZhdGUgUGVyc2lz\ndGVuY2VVbml0SW5mb0ltcGwgX2luZm8gPSBudWxsOwogICAgICAgIHByaXZh\ndGUgVVJMIF9zb3VyY2UgPSBudWxsOwoKICAgICAgICBwdWJsaWMgQ29uZmln\ndXJhdGlvblBhcnNlcihNYXAgbWFwKSB7CiAgICAgICAgICAgIF9tYXAgPSBt\nYXA7CiAgICAgICAgICAgIHNldENhY2hpbmcoZmFsc2UpOwogICAgICAgICAg\nICBzZXRWYWxpZGF0aW5nKHRydWUpOwogICAgICAgICAgICBzZXRQYXJzZVRl\neHQodHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgdm9pZCBwYXJzZShVUkwgdXJsKQogICAgICAgICAgICB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBfc291cmNlID0gdXJsOwog\nICAgICAgICAgICBzdXBlci5wYXJzZSh1cmwpOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcGFyc2UoRmlsZSBm\naWxlKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAg\nICAgICBfc291cmNlID0gZmlsZS50b1VSTCgpOwogICAgICAgICAgICBzdXBl\nci5wYXJzZShmaWxlKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHByb3RlY3RlZCBPYmplY3QgZ2V0U2NoZW1hU291cmNlKCkgewog\nICAgICAgICAgICByZXR1cm4gZ2V0Q2xhc3MoKS5nZXRSZXNvdXJjZUFzU3Ry\nZWFtKCJwZXJzaXN0ZW5jZS14c2QucnNyYyIpOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgcmVzZXQoKSB7\nCiAgICAgICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAgICAgICAgIF9pbmZv\nID0gbnVsbDsKICAgICAgICAgICAgX3NvdXJjZSA9IG51bGw7CiAgICAgICAg\nfQoKICAgICAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydEVsZW1lbnQoU3Ry\naW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgICAgICBpZiAoY3VycmVudERlcHRo\nKCkgPT0gMSkKICAgICAgICAgICAgICAgIHN0YXJ0UGVyc2lzdGVuY2VVbml0\nKGF0dHJzKTsKICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudERlcHRoKCkg\nPT0gMyAmJiAicHJvcGVydHkiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAg\nICAgIF9pbmZvLnNldFByb3BlcnR5KGF0dHJzLmdldFZhbHVlKCJuYW1lIiks\nCiAgICAgICAgICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoInZhbHVlIikp\nOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAg\nIHByb3RlY3RlZCB2b2lkIGVuZEVsZW1lbnQoU3RyaW5nIG5hbWUpCiAgICAg\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgICAgICBpZiAo\nY3VycmVudERlcHRoKCkgPT0gMSkgewogICAgICAgICAgICAgICAgX2luZm8u\nZnJvbVVzZXJQcm9wZXJ0aWVzKF9tYXApOwogICAgICAgICAgICAgICAgYWRk\nUmVzdWx0KF9pbmZvKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAo\nY3VycmVudERlcHRoKCkgIT0gMikKICAgICAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgICAgIHN3aXRjaCAobmFtZS5jaGFyQXQoMCkpIHsKICAgICAg\nICAgICAgICAgIGNhc2UgJ2MnOiAvLyBjbGFzcwogICAgICAgICAgICAgICAg\nICAgIF9pbmZvLmFkZE1hbmFnZWRDbGFzc05hbWUoY3VycmVudFRleHQoKSk7\nCiAgICAgICAgICAgICAgICBjYXNlICdlJzogLy8gZXhjbHVkZS11bmxpc3Rl\nZC1jbGFzc2VzCiAgICAgICAgICAgICAgICAgICAgX2luZm8uc2V0RXhjbHVk\nZVVubGlzdGVkQ2xhc3NlcygidHJ1ZSIuZXF1YWxzSWdub3JlQ2FzZQogICAg\nICAgICAgICAgICAgICAgICAgICAoY3VycmVudFRleHQoKSkpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnaic6\nCiAgICAgICAgICAgICAgICAgICAgaWYgKCJqdGEtZGF0YS1zb3VyY2UiLmVx\ndWFscyhuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2luZm8uc2V0\nSnRhRGF0YVNvdXJjZU5hbWUoY3VycmVudFRleHQoKSk7CiAgICAgICAgICAg\nICAgICAgICAgZWxzZSAvLyBqYXItZmlsZQogICAgICAgICAgICAgICAgICAg\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIF9pbmZvLmFkZEphckZpbGVOYW1lKGN1cnJlbnRU\nZXh0KCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJbGxl\nZ2FsQXJndW1lbnRFeGNlcHRpb24gaWFlKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oaWFlLmdldE1lc3NhZ2Uo\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlICdtJzogLy8gbWFwcGluZy1maWxlCiAgICAgICAgICAgICAg\nICAgICAgX2luZm8uYWRkTWFwcGluZ0ZpbGVOYW1lKGN1cnJlbnRUZXh0KCkp\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSAnbic6IC8vIG5vbi1qdGEtZGF0YS1zb3VyY2UKICAgICAgICAgICAg\nICAgICAgICBfaW5mby5zZXROb25KdGFEYXRhU291cmNlTmFtZShjdXJyZW50\nVGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgJ3AnOgogICAgICAgICAgICAgICAgICAgIGlmICgicHJv\ndmlkZXIiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nX2luZm8uc2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZShjdXJyZW50\nVGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUGFyc2Ug\ncGVyc2lzdGVuY2UtdW5pdCBlbGVtZW50LgogICAgICAgICAqLwogICAgICAg\nIHByaXZhdGUgdm9pZCBzdGFydFBlcnNpc3RlbmNlVW5pdChBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgX2luZm8gPSBuZXcgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwo\nKTsKICAgICAgICAgICAgX2luZm8uc2V0UGVyc2lzdGVuY2VVbml0TmFtZShh\ndHRycy5nZXRWYWx1ZSgibmFtZSIpKTsKCiAgICAgICAgICAgIC8vIHdlIG9u\nbHkgcGFyc2UgdGhpcyBvdXJzZWx2ZXMgb3V0c2lkZSBhIGNvbnRhaW5lciwg\nc28gZGVmYXVsdAogICAgICAgICAgICAvLyB0cmFuc2FjdGlvbiB0eXBlIHRv\nIGxvY2FsCiAgICAgICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgidHJhbnNhY3Rpb24tdHlwZSIpOwogICAgICAgICAgICBpZiAodmFsID09\nIG51bGwpCiAgICAgICAgICAgICAgICBfaW5mby5zZXRUcmFuc2FjdGlvblR5\ncGUKICAgICAgICAgICAgICAgICAgICAoUGVyc2lzdGVuY2VVbml0VHJhbnNh\nY3Rpb25UeXBlLlJFU09VUkNFX0xPQ0FMKTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgX2luZm8uc2V0VHJhbnNhY3Rpb25UeXBlKEVudW0u\ndmFsdWVPZgogICAgICAgICAgICAgICAgICAgIChQZXJzaXN0ZW5jZVVuaXRU\ncmFuc2FjdGlvblR5cGUuY2xhc3MsIHZhbCkpOwoKICAgICAgICAgICAgaWYg\nKF9zb3VyY2UgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9pbmZvLnNldFBl\ncnNpc3RlbmNlWG1sRmlsZVVybChfc291cmNlKTsKCQl9Cgl9Cn0K\n","encoding":"base64"}

