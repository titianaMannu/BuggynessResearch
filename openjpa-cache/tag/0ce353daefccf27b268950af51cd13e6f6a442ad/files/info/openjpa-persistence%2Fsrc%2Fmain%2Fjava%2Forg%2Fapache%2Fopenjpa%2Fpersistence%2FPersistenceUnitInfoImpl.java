{"sha":"3439642b66e22f63b589166e8a83c81edbbd5d6c","node_id":"MDQ6QmxvYjIwNjM2NDozNDM5NjQyYjY2ZTIyZjYzYjU4OTE2NmU4YTgzYzgxZWRiYmQ1ZDZj","size":15807,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3439642b66e22f63b589166e8a83c81edbbd5d6c","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBqYXZhLmlvLkZpbGU7Cmlt\ncG9ydCBqYXZhLm5ldC5NYWxmb3JtZWRVUkxFeGNlcHRpb247CmltcG9ydCBq\nYXZhLm5ldC5VUklTeW50YXhFeGNlcHRpb247CmltcG9ydCBqYXZhLm5ldC5V\nUkw7CmltcG9ydCBqYXZhLm5ldC5VUkxEZWNvZGVyOwppbXBvcnQgamF2YS51\ndGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsK\naW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlBy\nb3BlcnRpZXM7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5zcGkuQ2xhc3NU\ncmFuc2Zvcm1lcjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLnNwaS5QZXJz\naXN0ZW5jZVVuaXRJbmZvOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uuc3Bp\nLlBlcnNpc3RlbmNlVW5pdFRyYW5zYWN0aW9uVHlwZTsKaW1wb3J0IGphdmF4\nLnNxbC5EYXRhU291cmNlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5tZXRhLlNvdXJjZVRyYWNrZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk11bHRpQ2xhc3NMb2FkZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuVGVtcG9yYXJ5Q2xh\nc3NMb2FkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5DbGFz\nc1Jlc29sdmVyOwoKLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHRoZSB7QGxp\nbmsgUGVyc2lzdGVuY2VVbml0SW5mb30gaW50ZXJmYWNlIHVzZWQgYnkgT3Bl\nbkpQQSAKICogd2hlbiBwYXJzaW5nIHBlcnNpc3RlbmNlIGNvbmZpZ3VyYXRp\nb24gaW5mb3JtYXRpb24uCiAqCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBj\nbGFzcyBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbAogICAgaW1wbGVtZW50cyBQ\nZXJzaXN0ZW5jZVVuaXRJbmZvLCBTb3VyY2VUcmFja2VyIHsKCiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIFN0cmluZyBLRVlfUFJPVklERVIgPSAiamF2YXgu\ncGVyc2lzdGVuY2UucHJvdmlkZXIiOwoKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIExvY2FsaXplciBzX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAg\nICAgICAgKFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsLmNsYXNzKTsKCiAgICBw\ncml2YXRlIFN0cmluZyBfbmFtZTsKICAgIHByaXZhdGUgZmluYWwgUHJvcGVy\ndGllcyBfcHJvcHMgPSBuZXcgUHJvcGVydGllcygpOwogICAgcHJpdmF0ZSBQ\nZXJzaXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGUgX3RyYW5zVHlwZSA9CiAg\nICAgICAgUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlLlJFU09VUkNF\nX0xPQ0FMOwoKICAgIHByaXZhdGUgU3RyaW5nIF9wcm92aWRlckNsYXNzTmFt\nZTsKICAgIHByaXZhdGUgTGlzdDxTdHJpbmc+IF9tYXBwaW5nRmlsZU5hbWVz\nOwogICAgcHJpdmF0ZSBMaXN0PFN0cmluZz4gX2VudGl0eUNsYXNzTmFtZXM7\nCiAgICBwcml2YXRlIExpc3Q8VVJMPiBfamFyRmlsZXM7CiAgICBwcml2YXRl\nIFN0cmluZyBfanRhRGF0YVNvdXJjZU5hbWU7CiAgICBwcml2YXRlIERhdGFT\nb3VyY2UgX2p0YURhdGFTb3VyY2U7CiAgICBwcml2YXRlIFN0cmluZyBfbm9u\nSnRhRGF0YVNvdXJjZU5hbWU7CiAgICBwcml2YXRlIERhdGFTb3VyY2UgX25v\nbkp0YURhdGFTb3VyY2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX2V4Y2x1ZGVV\nbmxpc3RlZDsKICAgIHByaXZhdGUgVVJMIF9wZXJzaXN0ZW5jZVhtbEZpbGU7\nCgogICAgLy8gQSBwZXJzaXN0ZW5jZSB1bml0IGlzIGRlZmluZWQgYnkgYSBw\nZXJzaXN0ZW5jZS54bWwgZmlsZS4gVGhlIGphcgogICAgLy8gZmlsZSBvciBk\naXJlY3Rvcnkgd2hvc2UgTUVUQS1JTkYgZGlyZWN0b3J5IGNvbnRhaW5zIHRo\nZQogICAgLy8gcGVyc2lzdGVuY2UueG1sIGZpbGUgaXMgdGVybWVkIHRoZSBy\nb290IG9mIHRoZSBwZXJzaXN0ZW5jZSB1bml0LgogICAgLy8KICAgIC8vIElu\nIEphdmEgRUUsIHRoZSByb290IG9mIGEgcGVyc2lzdGVuY2UgdW5pdCBtYXkg\nYmUgb25lIG9mIHRoZSBmb2xsb3dpbmc6CiAgICAvLyAtIGFuIEVKQi1KQVIg\nZmlsZQogICAgLy8gLSB0aGUgV0VCLUlORi9jbGFzc2VzIGRpcmVjdG9yeSBv\nZiBhIFdBUiBmaWxlWzM4XQogICAgLy8gLSBhIGphciBmaWxlIGluIHRoZSBX\nRUItSU5GL2xpYiBkaXJlY3Rvcnkgb2YgYSBXQVIgZmlsZQogICAgLy8gLSBh\nIGphciBmaWxlIGluIHRoZSByb290IG9mIHRoZSBFQVIKICAgIC8vIC0gYSBq\nYXIgZmlsZSBpbiB0aGUgRUFSIGxpYnJhcnkgZGlyZWN0b3J5CiAgICAvLyAt\nIGFuIGFwcGxpY2F0aW9uIGNsaWVudCBqYXIgZmlsZQogICAgcHJpdmF0ZSBV\nUkwgX3Jvb3Q7CgogICAgcHVibGljIENsYXNzTG9hZGVyIGdldENsYXNzTG9h\nZGVyKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1Ymxp\nYyBDbGFzc0xvYWRlciBnZXROZXdUZW1wQ2xhc3NMb2FkZXIoKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBUZW1wb3JhcnlDbGFzc0xvYWRlcihUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLgogICAgICAgICAgICBnZXRDb250ZXh0Q2xhc3NMb2Fk\nZXIoKSk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRQZXJzaXN0ZW5j\nZVVuaXROYW1lKCkgewogICAgICAgIHJldHVybiBfbmFtZTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRQZXJzaXN0ZW5jZVVuaXROYW1lKFN0cmluZyBl\nbU5hbWUpIHsKICAgICAgICBfbmFtZSA9IGVtTmFtZTsKICAgIH0KCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05hbWUo\nKSB7CiAgICAgICAgcmV0dXJuIF9wcm92aWRlckNsYXNzTmFtZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NO\nYW1lKFN0cmluZyBwcm92aWRlckNsYXNzTmFtZSkgewogICAgICAgIF9wcm92\naWRlckNsYXNzTmFtZSA9IHByb3ZpZGVyQ2xhc3NOYW1lOwogICAgfQoKICAg\nIHB1YmxpYyBQZXJzaXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGUgZ2V0VHJh\nbnNhY3Rpb25UeXBlKCkgewogICAgICAgIHJldHVybiBfdHJhbnNUeXBlOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFRyYW5zYWN0aW9uVHlwZShQZXJz\naXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGUgdHJhbnNUeXBlKSB7CiAgICAg\nICAgX3RyYW5zVHlwZSA9IHRyYW5zVHlwZTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nIGdldEp0YURhdGFTb3VyY2VOYW1lKCkgewogICAgICAgIHJldHVy\nbiBfanRhRGF0YVNvdXJjZU5hbWU7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0SnRhRGF0YVNvdXJjZU5hbWUoU3RyaW5nIGp0YSkgewogICAgICAgIF9q\ndGFEYXRhU291cmNlTmFtZSA9IGp0YTsKICAgICAgICBpZiAoanRhICE9IG51\nbGwpCiAgICAgICAgICAgIF9qdGFEYXRhU291cmNlID0gbnVsbDsKICAgIH0K\nCiAgICBwdWJsaWMgRGF0YVNvdXJjZSBnZXRKdGFEYXRhU291cmNlKCkgewog\nICAgICAgIHJldHVybiBfanRhRGF0YVNvdXJjZTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRKdGFEYXRhU291cmNlKERhdGFTb3VyY2UgZHMpIHsKICAg\nICAgICBfanRhRGF0YVNvdXJjZSA9IGRzOwogICAgICAgIGlmIChkcyAhPSBu\ndWxsKQogICAgICAgICAgICBfanRhRGF0YVNvdXJjZU5hbWUgPSBudWxsOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0Tm9uSnRhRGF0YVNvdXJjZU5h\nbWUoKSB7CiAgICAgICAgcmV0dXJuIF9ub25KdGFEYXRhU291cmNlTmFtZTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXROb25KdGFEYXRhU291cmNlTmFt\nZShTdHJpbmcgbm9uSnRhKSB7CiAgICAgICAgX25vbkp0YURhdGFTb3VyY2VO\nYW1lID0gbm9uSnRhOwogICAgICAgIGlmIChub25KdGEgIT0gbnVsbCkKICAg\nICAgICAgICAgX25vbkp0YURhdGFTb3VyY2UgPSBudWxsOwogICAgfQoKICAg\nIHB1YmxpYyBEYXRhU291cmNlIGdldE5vbkp0YURhdGFTb3VyY2UoKSB7CiAg\nICAgICAgcmV0dXJuIF9ub25KdGFEYXRhU291cmNlOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldE5vbkp0YURhdGFTb3VyY2UoRGF0YVNvdXJjZSBkcykg\newogICAgICAgIF9ub25KdGFEYXRhU291cmNlID0gZHM7CiAgICAgICAgaWYg\nKGRzICE9IG51bGwpCiAgICAgICAgICAgIF9ub25KdGFEYXRhU291cmNlTmFt\nZSA9IG51bGw7CiAgICB9CgogICAgcHVibGljIFVSTCBnZXRQZXJzaXN0ZW5j\nZVVuaXRSb290VXJsKCkgewogICAgICAgIHJldHVybiBfcm9vdDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRQZXJzaXN0ZW5jZVVuaXRSb290VXJsKFVS\nTCByb290KSB7CiAgICAgICAgX3Jvb3QgPSByb290OwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGV4Y2x1ZGVVbmxpc3RlZENsYXNzZXMoKSB7CiAgICAg\nICAgcmV0dXJuIF9leGNsdWRlVW5saXN0ZWQ7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0RXhjbHVkZVVubGlzdGVkQ2xhc3Nlcyhib29sZWFuIGV4Y2x1\nZGVVbmxpc3RlZCkgewogICAgICAgIF9leGNsdWRlVW5saXN0ZWQgPSBleGNs\ndWRlVW5saXN0ZWQ7CiAgICB9CgogICAgcHVibGljIExpc3Q8U3RyaW5nPiBn\nZXRNYXBwaW5nRmlsZU5hbWVzKCkgewogICAgICAgIHJldHVybiAoX21hcHBp\nbmdGaWxlTmFtZXMgPT0gbnVsbCkKICAgICAgICAgICAgPyAoTGlzdDxTdHJp\nbmc+KSBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUIDogX21hcHBpbmdGaWxlTmFt\nZXM7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkTWFwcGluZ0ZpbGVOYW1l\nKFN0cmluZyBuYW1lKSB7CiAgICAgICAgaWYgKF9tYXBwaW5nRmlsZU5hbWVz\nID09IG51bGwpCiAgICAgICAgICAgIF9tYXBwaW5nRmlsZU5hbWVzID0gbmV3\nIEFycmF5TGlzdDxTdHJpbmc+KCk7CiAgICAgICAgX21hcHBpbmdGaWxlTmFt\nZXMuYWRkKG5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0PFVSTD4gZ2V0\nSmFyRmlsZVVybHMoKSB7CiAgICAgICAgcmV0dXJuIChfamFyRmlsZXMgPT0g\nbnVsbCkgPyAoTGlzdDxVUkw+KSBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUIAog\nICAgICAgICAgICA6IF9qYXJGaWxlczsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBhZGRKYXJGaWxlKFVSTCBqYXIpIHsKICAgICAgICBpZiAoX2phckZpbGVz\nID09IG51bGwpCiAgICAgICAgICAgIF9qYXJGaWxlcyA9IG5ldyBBcnJheUxp\nc3Q8VVJMPigpOwogICAgICAgIF9qYXJGaWxlcy5hZGQoamFyKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBhZGRKYXJGaWxlTmFtZShTdHJpbmcgbmFtZSkg\newogICAgICAgIE11bHRpQ2xhc3NMb2FkZXIgbG9hZGVyID0gbmV3IE11bHRp\nQ2xhc3NMb2FkZXIoKTsKICAgICAgICBsb2FkZXIuYWRkQ2xhc3NMb2FkZXIo\nZ2V0Q2xhc3MoKS5nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICBsb2FkZXIu\nYWRkQ2xhc3NMb2FkZXIoTXVsdGlDbGFzc0xvYWRlci5USFJFQURfTE9BREVS\nKTsKICAgICAgICBVUkwgdXJsID0gbG9hZGVyLmdldFJlc291cmNlKG5hbWUp\nOwogICAgICAgIGlmICh1cmwgIT0gbnVsbCkgewogICAgICAgICAgICBhZGRK\nYXJGaWxlKHVybCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9Cgog\nICAgICAgIC8vIGphciBmaWxlIGlzIG5vdCBhIHJlc291cmNlOyBjaGVjayBj\nbGFzc3BhdGgKICAgICAgICBTdHJpbmdbXSBjcCA9IFN5c3RlbS5nZXRQcm9w\nZXJ0eSgiamF2YS5jbGFzcy5wYXRoIikuCiAgICAgICAgICAgIHNwbGl0KFN5\nc3RlbS5nZXRQcm9wZXJ0eSgicGF0aC5zZXBhcmF0b3IiKSk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjcC5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICBpZiAoY3BbaV0uZXF1YWxzKG5hbWUpCiAgICAgICAgICAgICAgICB8\nfCBjcFtpXS5lbmRzV2l0aChGaWxlLnNlcGFyYXRvckNoYXIgKyBuYW1lKSkg\newogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBh\nZGRKYXJGaWxlKG5ldyBGaWxlKGNwW2ldKS50b1VSTCgpKTsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGNhdGNoIChN\nYWxmb3JtZWRVUkxFeGNlcHRpb24gbXVlKSB7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw\ndGlvbihzX2xvYy5nZXQoImJhZC1qYXItbmFtZSIsIG5hbWUpLgogICAgICAg\nICAgICBnZXRNZXNzYWdlKCkpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0PFN0\ncmluZz4gZ2V0TWFuYWdlZENsYXNzTmFtZXMoKSB7CiAgICAgICAgcmV0dXJu\nIChfZW50aXR5Q2xhc3NOYW1lcyA9PSBudWxsKQogICAgICAgICAgICA/IChM\naXN0PFN0cmluZz4pIENvbGxlY3Rpb25zLkVNUFRZX0xJU1QgOiBfZW50aXR5\nQ2xhc3NOYW1lczsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRNYW5hZ2Vk\nQ2xhc3NOYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgaWYgKF9lbnRpdHlD\nbGFzc05hbWVzID09IG51bGwpCiAgICAgICAgICAgIF9lbnRpdHlDbGFzc05h\nbWVzID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7CiAgICAgICAgX2VudGl0\neUNsYXNzTmFtZXMuYWRkKG5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBQcm9w\nZXJ0aWVzIGdldFByb3BlcnRpZXMoKSB7CiAgICAgICAgcmV0dXJuIF9wcm9w\nczsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRQcm9wZXJ0eShTdHJpbmcg\na2V5LCBTdHJpbmcgdmFsdWUpIHsKICAgICAgICBfcHJvcHMuc2V0UHJvcGVy\ndHkoa2V5LCB2YWx1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkVHJh\nbnNmb3JtZXIoQ2xhc3NUcmFuc2Zvcm1lciB0cmFuc2Zvcm1lcikgewogICAg\nICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGxvY2F0aW9uIG9mIHRoZSBw\nZXJzaXN0ZW5jZS54bWwgcmVzb3VyY2UuIE1heSBiZSBudWxsLgogICAgICov\nCiAgICBwdWJsaWMgVVJMIGdldFBlcnNpc3RlbmNlWG1sRmlsZVVybCgpIHsK\nICAgICAgICByZXR1cm4gX3BlcnNpc3RlbmNlWG1sRmlsZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBsb2NhdGlvbiBvZiB0aGUgcGVyc2lzdGVuY2Uu\neG1sIHJlc291cmNlLiBNYXkgYmUgbnVsbC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJsKFVSTCB1cmwpIHsKICAg\nICAgICBfcGVyc2lzdGVuY2VYbWxGaWxlID0gdXJsOwogICAgfQoKICAgIC8q\nKgogICAgICogTG9hZCB0aGUgZ2l2ZW4gdXNlci1zdXBwbGllZCBtYXAgb2Yg\ncHJvcGVydGllcyBpbnRvIHRoaXMgcGVyc2lzdGVuY2UKICAgICAqIHVuaXQu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGZyb21Vc2VyUHJvcGVydGllcyhN\nYXAgbWFwKSB7CiAgICAgICAgaWYgKG1hcCA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm47CgogICAgICAgIE9iamVjdCBrZXk7CiAgICAgICAgT2JqZWN0\nIHZhbDsKICAgICAgICBmb3IgKE9iamVjdCBvIDogbWFwLmVudHJ5U2V0KCkp\nIHsKICAgICAgICAgICAga2V5ID0gKChNYXAuRW50cnkpIG8pLmdldEtleSgp\nOwogICAgICAgICAgICB2YWwgPSAoKE1hcC5FbnRyeSkgbykuZ2V0VmFsdWUo\nKTsKICAgICAgICAgICAgaWYgKEtFWV9QUk9WSURFUi5lcXVhbHMoa2V5KSkK\nICAgICAgICAgICAgICAgIHNldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05h\nbWUoKFN0cmluZykgdmFsKTsKICAgICAgICAgICAgZWxzZSBpZiAoImphdmF4\nLnBlcnNpc3RlbmNlLnRyYW5zYWN0aW9uVHlwZSIuZXF1YWxzKGtleSkpIHsK\nICAgICAgICAgICAgICAgIFBlcnNpc3RlbmNlVW5pdFRyYW5zYWN0aW9uVHlw\nZSB0dHlwZTsKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBT\ndHJpbmcpCiAgICAgICAgICAgICAgICAgICAgdHR5cGUgPSBFbnVtLnZhbHVl\nT2YoUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlLmNsYXNzLCAKICAg\nICAgICAgICAgICAgICAgICAgICAgKFN0cmluZykgdmFsKTsKICAgICAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB0dHlwZSA9IChQZXJz\naXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGUpIHZhbDsKICAgICAgICAgICAg\nICAgIHNldFRyYW5zYWN0aW9uVHlwZSh0dHlwZSk7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAoImphdmF4LnBlcnNpc3RlbmNlLmp0YURhdGFTb3VyY2UiLmVx\ndWFscyhrZXkpKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNl\nb2YgU3RyaW5nKQogICAgICAgICAgICAgICAgICAgIHNldEp0YURhdGFTb3Vy\nY2VOYW1lKChTdHJpbmcpIHZhbCk7CiAgICAgICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICAgICAgc2V0SnRhRGF0YVNvdXJjZSgoRGF0YVNvdXJj\nZSkgdmFsKTsKICAgICAgICAgICAgfSBlbHNlIGlmICgiamF2YXgucGVyc2lz\ndGVuY2Uubm9uSnRhRGF0YVNvdXJjZSIuZXF1YWxzKGtleSkpIHsKICAgICAg\nICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAgICAg\nICAgICAgICAgICAgc2V0Tm9uSnRhRGF0YVNvdXJjZU5hbWUoKFN0cmluZykg\ndmFsKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAg\nICBzZXROb25KdGFEYXRhU291cmNlKChEYXRhU291cmNlKSB2YWwpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKGtleSBpbnN0YW5jZW9mIFN0cmluZyAmJiB2\nYWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAgICAgICAgICAgICBzZXRQcm9w\nZXJ0eSgoU3RyaW5nKSBrZXksIChTdHJpbmcpIHZhbCk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5rIE1hcH0gY29u\ndGFpbmluZyB0aGUgcHJvcGVydGllcyBuZWNlc3NhcnkgdG8gY3JlYXRlCiAg\nICAgKiBhIHtAbGluayBDb25maWd1cmF0aW9ufSB0aGF0IHJlZmxlY3RzIHRo\nZSBpbmZvcm1hdGlvbiBpbiB0aGlzCiAgICAgKiBwZXJzaXN0ZW5jZSB1bml0\nIGluZm8uCiAgICAgKi8KICAgIHB1YmxpYyBNYXAgdG9PcGVuSlBBUHJvcGVy\ndGllcygpIHsKICAgICAgICByZXR1cm4gdG9PcGVuSlBBUHJvcGVydGllcyh0\naGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHtAbGluayBN\nYXB9IGNvbnRhaW5pbmcgdGhlIHByb3BlcnRpZXMgbmVjZXNzYXJ5IHRvIGNy\nZWF0ZQogICAgICogYSB7QGxpbmsgQ29uZmlndXJhdGlvbn0gdGhhdCByZWZs\nZWN0cyB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIGdpdmVuCiAgICAgKiBwZXJz\naXN0ZW5jZSB1bml0IGluZm8uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nTWFwIHRvT3BlbkpQQVByb3BlcnRpZXMoUGVyc2lzdGVuY2VVbml0SW5mbyBp\nbmZvKSB7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CiAgICAg\nICAgaWYgKGluZm8uZ2V0VHJhbnNhY3Rpb25UeXBlKCkgPT0gUGVyc2lzdGVu\nY2VVbml0VHJhbnNhY3Rpb25UeXBlLkpUQSkKICAgICAgICAgICAgbWFwLnB1\ndCgib3BlbmpwYS5UcmFuc2FjdGlvbk1vZGUiLCAibWFuYWdlZCIpOwoKICAg\nICAgICBib29sZWFuIGhhc0p0YSA9IGZhbHNlOwogICAgICAgIERhdGFTb3Vy\nY2UgZHMgPSBpbmZvLmdldEp0YURhdGFTb3VyY2UoKTsKICAgICAgICBpZiAo\nZHMgIT0gbnVsbCkgewogICAgICAgICAgICBtYXAucHV0KCJvcGVuanBhLkNv\nbm5lY3Rpb25GYWN0b3J5IiwgZHMpOwogICAgICAgICAgICBtYXAucHV0KCJv\ncGVuanBhLkNvbm5lY3Rpb25GYWN0b3J5TW9kZSIsICJtYW5hZ2VkIik7CiAg\nICAgICAgICAgIGhhc0p0YSA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChp\nbmZvIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwKICAgICAg\nICAgICAgJiYgKChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCkgaW5mbykuZ2V0\nSnRhRGF0YVNvdXJjZU5hbWUoKSAhPSBudWxsKXsKICAgICAgICAgICAgbWFw\nLnB1dCgib3BlbmpwYS5Db25uZWN0aW9uRmFjdG9yeU5hbWUiLCAoKFBlcnNp\nc3RlbmNlVW5pdEluZm9JbXBsKQogICAgICAgICAgICAgICAgaW5mbykuZ2V0\nSnRhRGF0YVNvdXJjZU5hbWUoKSk7CiAgICAgICAgICAgIG1hcC5wdXQoIm9w\nZW5qcGEuQ29ubmVjdGlvbkZhY3RvcnlNb2RlIiwgIm1hbmFnZWQiKTsKICAg\nICAgICAgICAgaGFzSnRhID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGRz\nID0gaW5mby5nZXROb25KdGFEYXRhU291cmNlKCk7CiAgICAgICAgaWYgKGRz\nICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKCFoYXNKdGEpCiAgICAgICAg\nICAgICAgICBtYXAucHV0KCJvcGVuanBhLkNvbm5lY3Rpb25GYWN0b3J5Iiwg\nZHMpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBtYXAucHV0\nKCJvcGVuanBhLkNvbm5lY3Rpb25GYWN0b3J5MiIsIGRzKTsKICAgICAgICB9\nIGVsc2UgaWYgKGluZm8gaW5zdGFuY2VvZiBQZXJzaXN0ZW5jZVVuaXRJbmZv\nSW1wbAogICAgICAgICAgICAmJiAoKFBlcnNpc3RlbmNlVW5pdEluZm9JbXBs\nKSBpbmZvKS5nZXROb25KdGFEYXRhU291cmNlTmFtZSgpCiAgICAgICAgICAg\nICE9IG51bGwpIHsKICAgICAgICAgICAgU3RyaW5nIG5vbkp0YU5hbWUgPSAo\nKFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsKSBpbmZvKS4KICAgICAgICAgICAg\nICAgIGdldE5vbkp0YURhdGFTb3VyY2VOYW1lKCk7CiAgICAgICAgICAgIGlm\nICghaGFzSnRhKQogICAgICAgICAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5D\nb25uZWN0aW9uRmFjdG9yeU5hbWUiLCBub25KdGFOYW1lKTsKICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5Db25u\nZWN0aW9uRmFjdG9yeTJOYW1lIiwgbm9uSnRhTmFtZSk7CiAgICAgICAgfQoK\nICAgICAgICBpZiAoaW5mby5nZXRDbGFzc0xvYWRlcigpICE9IG51bGwpCiAg\nICAgICAgICAgIG1hcC5wdXQoIm9wZW5qcGEuQ2xhc3NSZXNvbHZlciIsIG5l\ndyBDbGFzc1Jlc29sdmVySW1wbAogICAgICAgICAgICAgICAgKGluZm8uZ2V0\nQ2xhc3NMb2FkZXIoKSkpOwoKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0g\naW5mby5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgaWYgKHByb3BzICE9IG51\nbGwpIHsKICAgICAgICAgICAgbWFwLnB1dEFsbChwcm9wcyk7CiAgICAgICAg\nICAgIC8vIHRoaXMgaXNuJ3QgYSByZWFsIGNvbmZpZyBwcm9wZXJ0eTsgcmVt\nb3ZlIGl0CiAgICAgICAgICAgIG1hcC5yZW1vdmUoUGVyc2lzdGVuY2VQcm92\naWRlckltcGwuQ0xBU1NfVFJBTlNGT1JNRVJfT1BUSU9OUyk7CiAgICAgICAg\nfQoKICAgICAgICBQcm9wZXJ0aWVzIG1ldGFGYWN0b3J5UHJvcHMgPSBuZXcg\nUHJvcGVydGllcygpOwogICAgICAgIGlmIChpbmZvLmdldE1hbmFnZWRDbGFz\nc05hbWVzKCkgIT0gbnVsbCAKICAgICAgICAgICAgJiYgIWluZm8uZ2V0TWFu\nYWdlZENsYXNzTmFtZXMoKS5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgU3Ry\naW5nQnVmZmVyIHR5cGVzID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAg\nICAgICBmb3IgKFN0cmluZyB0eXBlIDogaW5mby5nZXRNYW5hZ2VkQ2xhc3NO\nYW1lcygpKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZXMubGVuZ3RoKCkg\nPiAwKQogICAgICAgICAgICAgICAgICAgIHR5cGVzLmFwcGVuZCgnOycpOwog\nICAgICAgICAgICAgICAgdHlwZXMuYXBwZW5kKHR5cGUpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIG1ldGFGYWN0b3J5UHJvcHMucHV0KCJUeXBlcyIs\nIHR5cGVzLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAgICAgICBpZiAoaW5m\nby5nZXRKYXJGaWxlVXJscygpICE9IG51bGwgJiYgIWluZm8uZ2V0SmFyRmls\nZVVybHMoKS5pc0VtcHR5KCkKICAgICAgICAgICAgfHwgKCFpbmZvLmV4Y2x1\nZGVVbmxpc3RlZENsYXNzZXMoKQogICAgICAgICAgICAmJiBpbmZvLmdldFBl\ncnNpc3RlbmNlVW5pdFJvb3RVcmwoKSAhPSBudWxsKSkgewogICAgICAgICAg\nICBTdHJpbmdCdWZmZXIgamFycyA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAg\nICAgICAgICAgU3RyaW5nIGZpbGUgPSBudWxsOwogICAgICAgICAgICBpZiAo\nIWluZm8uZXhjbHVkZVVubGlzdGVkQ2xhc3NlcygpCiAgICAgICAgICAgICAg\nICAmJiBpbmZvLmdldFBlcnNpc3RlbmNlVW5pdFJvb3RVcmwoKSAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBVUkwgdXJsID0gaW5mby5nZXRQZXJzaXN0\nZW5jZVVuaXRSb290VXJsKCk7CiAgICAgICAgICAgICAgICBpZiAoImZpbGUi\nLmVxdWFscyh1cmwuZ2V0UHJvdG9jb2woKSkpIC8vIGV4cGxvZGVkIGphcj8K\nICAgICAgICAgICAgICAgICAgICBmaWxlID0gVVJMRGVjb2Rlci5kZWNvZGUo\ndXJsLmdldFBhdGgoKSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICAgICAgamFycy5hcHBlbmQodXJsKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBmb3IgKFVSTCBqYXIgOiBpbmZvLmdldEphckZpbGVVcmxz\nKCkpIHsKICAgICAgICAgICAgICAgIGlmIChqYXJzLmxlbmd0aCgpID4gMCkK\nICAgICAgICAgICAgICAgICAgICBqYXJzLmFwcGVuZCgnOycpOwogICAgICAg\nICAgICAgICAgamFycy5hcHBlbmQoamFyKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAoZmlsZSAhPSBudWxsKQogICAgICAgICAgICAgICAgbWV0\nYUZhY3RvcnlQcm9wcy5wdXQoIkZpbGVzIiwgZmlsZSk7CiAgICAgICAgICAg\nIGlmIChqYXJzLmxlbmd0aCgpICE9IDApCiAgICAgICAgICAgICAgICBtZXRh\nRmFjdG9yeVByb3BzLnB1dCgiVVJMcyIsIGphcnMudG9TdHJpbmcoKSk7CiAg\nICAgICAgfQogICAgICAgIGlmIChpbmZvLmdldE1hcHBpbmdGaWxlTmFtZXMo\nKSAhPSBudWxsCiAgICAgICAgICAgICYmICFpbmZvLmdldE1hcHBpbmdGaWxl\nTmFtZXMoKS5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgU3RyaW5nQnVmZmVy\nIHJzcmNzID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAgICBmb3Ig\nKFN0cmluZyByc3JjIDogaW5mby5nZXRNYXBwaW5nRmlsZU5hbWVzKCkpIHsK\nICAgICAgICAgICAgICAgIGlmIChyc3Jjcy5sZW5ndGgoKSA+IDApCiAgICAg\nICAgICAgICAgICAgICAgcnNyY3MuYXBwZW5kKCc7Jyk7CiAgICAgICAgICAg\nICAgICByc3Jjcy5hcHBlbmQocnNyYyk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgbWV0YUZhY3RvcnlQcm9wcy5wdXQoIlJlc291cmNlcyIsIHJzcmNz\nLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAgICAgICBpZiAoIW1ldGFGYWN0\nb3J5UHJvcHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIC8vIHNldCBwZXJz\naXN0ZW50IGNsYXNzIGxvY2F0aW9ucyBhcyBwcm9wZXJ0aWVzIG9mIG1ldGFk\nYXRhIGZhY3RvcnkKICAgICAgICAgICAgU3RyaW5nIGZhY3RvcnkgPSAoU3Ry\naW5nKSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0eQogICAgICAgICAgICAg\nICAgKCJNZXRhRGF0YUZhY3RvcnkiLCBtYXApOwogICAgICAgICAgICBpZiAo\nZmFjdG9yeSA9PSBudWxsKQogICAgICAgICAgICAgICAgZmFjdG9yeSA9IENv\nbmZpZ3VyYXRpb25zLnNlcmlhbGl6ZVByb3BlcnRpZXMobWV0YUZhY3RvcnlQ\ncm9wcyk7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgU3Ry\naW5nIGNsc05hbWUgPSBDb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUoZmFj\ndG9yeSk7CiAgICAgICAgICAgICAgICBtZXRhRmFjdG9yeVByb3BzLnB1dEFs\nbChDb25maWd1cmF0aW9ucy5wYXJzZVByb3BlcnRpZXMKICAgICAgICAgICAg\nICAgICAgICAoQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhmYWN0b3J5\nKSkpOwogICAgICAgICAgICAgICAgZmFjdG9yeSA9IENvbmZpZ3VyYXRpb25z\nLmdldFBsdWdpbihjbHNOYW1lLAogICAgICAgICAgICAgICAgICAgIENvbmZp\nZ3VyYXRpb25zLnNlcmlhbGl6ZVByb3BlcnRpZXMobWV0YUZhY3RvcnlQcm9w\ncykpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG1hcC5wdXQoIm9wZW5q\ncGEuTWV0YURhdGFGYWN0b3J5IiwgZmFjdG9yeSk7CiAgICAgICAgfQoKICAg\nICAgICAvLyBhbHdheXMgcmVjb3JkIHByb3ZpZGVyIG5hbWUgZm9yIHByb2R1\nY3QgZGVyaXZhdGlvbnMgdG8gYWNjZXNzCiAgICAgICAgaWYgKGluZm8uZ2V0\nUGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpICE9IG51bGwpCiAgICAg\nICAgICAgIG1hcC5wdXQoS0VZX1BST1ZJREVSLCBpbmZvLmdldFBlcnNpc3Rl\nbmNlUHJvdmlkZXJDbGFzc05hbWUoKSk7CiAgICAgICAgcmV0dXJuIG1hcDsK\nICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIHB1Ymxp\nYyBGaWxlIGdldFNvdXJjZUZpbGUoKSB7CiAgICAgICAgaWYgKF9wZXJzaXN0\nZW5jZVhtbEZpbGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgRmlsZShf\ncGVyc2lzdGVuY2VYbWxGaWxlLnRvVVJJKCkpOwogICAgICAgIH0gY2F0Y2gg\nKFVSSVN5bnRheEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5l\ndyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyBPYmplY3QgZ2V0U291cmNlU2NvcGUoKSB7CiAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIGludCBnZXRTb3VyY2VU\neXBlKCkgewogICAgICAgIHJldHVybiBTUkNfWE1MOwogICAgfQoKICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0UmVzb3VyY2VOYW1lKCkgewogICAgICAgIHJldHVy\nbiAiUGVyc2lzdGVuY2VVbml0SW5mbzoiICsgX25hbWU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTaW1wbGUgY2xhc3MgcmVzb2x2ZXIgYnVpbHQgYXJvdW5k\nIHRoZSBwZXJzaXN0ZW5jZSB1bml0IGxvYWRlci4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgY2xhc3MgQ2xhc3NSZXNvbHZlckltcGwKICAgICAgICBp\nbXBsZW1lbnRzIENsYXNzUmVzb2x2ZXIgewoKICAgICAgICBwcml2YXRlIGZp\nbmFsIENsYXNzTG9hZGVyIF9sb2FkZXI7CgogICAgICAgIHB1YmxpYyBDbGFz\nc1Jlc29sdmVySW1wbChDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICAg\nICAgX2xvYWRlciA9IGxvYWRlcjsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBDbGFzc0xvYWRlciBnZXRDbGFzc0xvYWRlcihDbGFzcyBjdHgsIENsYXNz\nTG9hZGVyIGVudikgewogICAgICAgICAgICByZXR1cm4gX2xvYWRlcjsKICAg\nICAgICB9Cgl9Cn0K\n","encoding":"base64"}

