{"sha":"c48f6fcfe1a45d1b9c5200d21fa120334c99c246","node_id":"MDQ6QmxvYjIwNjM2NDpjNDhmNmZjZmUxYTQ1ZDFiOWM1MjAwZDIxZmExMjAzMzRjOTljMjQ2","size":6615,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c48f6fcfe1a45d1b9c5200d21fa120334c99c246","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5EaXNjcmltaW5hdG9yOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdEZWZh\ndWx0c0ltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRh\nLlZhbHVlTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzLkZsYXRDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZURpc2NyaW1pbmF0\nb3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuc3RyYXRzLk5vbmVWZXJzaW9uU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5OdW1iZXJWZXJzaW9uU3Ry\nYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0\ncmF0cy5TdWJjbGFzc0pvaW5EaXNjcmltaW5hdG9yU3RyYXRlZ3k7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5WYWx1ZU1h\ncERpc2NyaW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlZlcnRpY2FsQ2xhc3NTdHJhdGVneTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1h\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5TeW50\nYXhlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBl\nczsKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIFN1cHBsaWVz\nIGRlZmF1bHQgbWFwcGluZyBpbmZvcm1hdGlvbiBpbiBhY2NvcmRhbmNlIHdp\ndGggSlBBIHNwZWMuCiAqCiAqIEBhdXRob3IgU3RldmUgS2ltCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgUGVyc2lzdGVuY2VNYXBw\naW5nRGVmYXVsdHMKICAgIGV4dGVuZHMgTWFwcGluZ0RlZmF1bHRzSW1wbCB7\nCgogICAgcHVibGljIFBlcnNpc3RlbmNlTWFwcGluZ0RlZmF1bHRzKCkgewog\nICAgICAgIHNldERlZmF1bHRNaXNzaW5nSW5mbyh0cnVlKTsKICAgICAgICBz\nZXRTdG9yZUVudW1PcmRpbmFsKHRydWUpOwogICAgICAgIHNldE9yZGVyTGlz\ndHMoZmFsc2UpOwogICAgICAgIHNldEFkZE51bGxJbmRpY2F0b3IoZmFsc2Up\nOwogICAgICAgIHNldERpc2NyaW1pbmF0b3JDb2x1bW5OYW1lKCJEVFlQRSIp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIE9iamVjdCBnZXRT\ndHJhdGVneShWZXJzaW9uIHZlcnMsIGJvb2xlYW4gYWRhcHQpIHsKICAgICAg\nICBPYmplY3Qgc3RyYXQgPSBzdXBlci5nZXRTdHJhdGVneSh2ZXJzLCBhZGFw\ndCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IHZlcnMuZ2V0Q2xhc3NN\nYXBwaW5nKCk7CiAgICAgICAgaWYgKHN0cmF0ICE9IG51bGwgfHwgY2xzLmdl\ndEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwKICAgICAg\nICAgICAgfHwgY2xzLmdldFZlcnNpb25GaWVsZCgpICE9IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBzdHJhdDsKCiAgICAgICAgaWYgKHZlcnMuZ2V0TWFw\ncGluZ0luZm8oKS5nZXRDb2x1bW5zKCkuaXNFbXB0eSgpKQogICAgICAgICAg\nICByZXR1cm4gTm9uZVZlcnNpb25TdHJhdGVneS5nZXRJbnN0YW5jZSgpOwog\nICAgICAgIHJldHVybiBuZXcgTnVtYmVyVmVyc2lvblN0cmF0ZWd5KCk7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgT2JqZWN0IGdldFN0cmF0\nZWd5KERpc2NyaW1pbmF0b3IgZGlzYywgYm9vbGVhbiBhZGFwdCkgewogICAg\nICAgIE9iamVjdCBzdHJhdCA9IHN1cGVyLmdldFN0cmF0ZWd5KGRpc2MsIGFk\nYXB0KTsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gZGlzYy5nZXRDbGFz\nc01hcHBpbmcoKTsKICAgICAgICBpZiAoc3RyYXQgIT0gbnVsbCB8fCBjbHMu\nZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbAogICAg\nICAgICAgICB8fCBkaXNjLmdldE1hcHBpbmdJbmZvKCkuZ2V0VmFsdWUoKSAh\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gc3RyYXQ7CgogICAgICAgIC8v\nIGRvbid0IHVzZSBhIGNvbHVtbi1iYXNlZCBkaXNjcmltaW5hdG9yIGFwcHJv\nYWNoIHVubGVzcyB1c2VyIGhhcyBzZXQKICAgICAgICAvLyBhIGNvbHVtbiBl\neHBsaWNpdGx5IG9yIGlzIHVzaW5nIGZsYXQgaW5oZXJpdGFuY2UgZXhwbGlj\naXRseQogICAgICAgIGlmICghZGlzYy5nZXRNYXBwaW5nSW5mbygpLmdldENv\nbHVtbnMoKS5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiBuZXcgVmFs\ndWVNYXBEaXNjcmltaW5hdG9yU3RyYXRlZ3koKTsKCiAgICAgICAgQ2xhc3NN\nYXBwaW5nIGJhc2UgPSBjbHM7CiAgICAgICAgd2hpbGUgKGJhc2UuZ2V0TWFw\ncGluZ0luZm8oKS5nZXRIaWVyYXJjaHlTdHJhdGVneSgpID09IG51bGwKICAg\nICAgICAgICAgJiYgYmFzZS5nZXRQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0g\nbnVsbCkKICAgICAgICAgICAgYmFzZSA9IGJhc2UuZ2V0UENTdXBlcmNsYXNz\nTWFwcGluZygpOwoKICAgICAgICBzdHJhdCA9IGJhc2UuZ2V0TWFwcGluZ0lu\nZm8oKS5nZXRIaWVyYXJjaHlTdHJhdGVneSgpOwogICAgICAgIGlmIChGbGF0\nQ2xhc3NTdHJhdGVneS5BTElBUy5lcXVhbHMoc3RyYXQpKQogICAgICAgICAg\nICByZXR1cm4gbmV3IFZhbHVlTWFwRGlzY3JpbWluYXRvclN0cmF0ZWd5KCk7\nCiAgICAgICAgaWYgKFZlcnRpY2FsQ2xhc3NTdHJhdGVneS5BTElBUy5lcXVh\nbHMoc3RyYXQpCiAgICAgICAgICAgICYmIGRpY3Quam9pblN5bnRheCAhPSBK\nb2luU3ludGF4ZXMuU1lOVEFYX1RSQURJVElPTkFMKQogICAgICAgICAgICBy\nZXR1cm4gbmV3IFN1YmNsYXNzSm9pbkRpc2NyaW1pbmF0b3JTdHJhdGVneSgp\nOwogICAgICAgIHJldHVybiBOb25lRGlzY3JpbWluYXRvclN0cmF0ZWd5Lmdl\ndEluc3RhbmNlKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFRhYmxlTmFtZShDbGFzc01hcHBpbmcgY2xzLCBTY2hlbWEg\nc2NoZW1hKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZ3MuZ2V0Q2xhc3NOYW1l\nKGNscy5nZXREZXNjcmliZWRUeXBlKCkpLnJlcGxhY2UoJyQnLCAnXycpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXRUYWJs\nZU5hbWUoRmllbGRNYXBwaW5nIGZtLCBTY2hlbWEgc2NoZW1hKSB7CiAgICAg\nICAgLy8gYmFzZSBuYW1lIGlzIHRhYmxlIG9mIGRlZmluaW5nIHR5cGUgKyAn\nXycKICAgICAgICBTdHJpbmcgbmFtZSA9IGZtLmdldERlZmluaW5nTWFwcGlu\nZygpLmdldFRhYmxlKCkuZ2V0TmFtZSgpICsgIl8iOwoKICAgICAgICAvLyBp\nZiB0aGlzIGlzIGFuIGFzc29jYXRpb24gdGFibGUsIHNwZWMgc2F5cyB0byBz\ndWZmaXggd2l0aCB0YWJsZSBvZgogICAgICAgIC8vIHRoZSByZWxhdGVkIHR5\ncGUuIHNwZWMgZG9lc24ndCBjb3ZlciBvdGhlciBjYXNlczsgd2UncmUgZ29p\nbmcgdG8KICAgICAgICAvLyBzdWZmaXggd2l0aCB0aGUgZmllbGQgbmFtZQog\nICAgICAgIENsYXNzTWFwcGluZyByZWwgPSBmbS5nZXRFbGVtZW50TWFwcGlu\nZygpLmdldFR5cGVNYXBwaW5nKCk7CiAgICAgICAgYm9vbGVhbiBhc3NvYyA9\nIHJlbCAhPSBudWxsICYmIHJlbC5nZXRUYWJsZSgpICE9IG51bGwKICAgICAg\nICAgICAgJiYgZm0uZ2V0VHlwZUNvZGUoKSAhPSBKYXZhVHlwZXMuTUFQOwog\nICAgICAgIGlmIChhc3NvYykKICAgICAgICAgICAgbmFtZSArPSByZWwuZ2V0\nVGFibGUoKS5nZXROYW1lKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBu\nYW1lICs9IGZtLmdldE5hbWUoKTsKICAgICAgICByZXR1cm4gbmFtZS5yZXBs\nYWNlKCckJywgJ18nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyB2b2lkIHBvcHVsYXRlSm9pbkNvbHVtbihGaWVsZE1hcHBpbmcgZm0sIFRh\nYmxlIGxvY2FsLCBUYWJsZSBmb3JlaWduLAogICAgICAgIENvbHVtbiBjb2ws\nIE9iamVjdCB0YXJnZXQsIGludCBwb3MsIGludCBjb2xzKSB7CiAgICAgICAg\nLy8gb25seSB1c2Ugc3BlYyBkZWZhdWx0cyB3aXRoIGNvbHVtbiB0YXJnZXRz\nCiAgICAgICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgQ29sdW1uKSkKICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBpZiB0aGlzIGlzIGEgYmlk\naSByZWxhdGlvbiwgcHJlZml4IHdpdGggaW52ZXJzZSBmaWVsZCBuYW1lLCBl\nbHNlCiAgICAgICAgLy8gcHJlZml4IHdpdGggb3duaW5nIGVudGl0eSBuYW1l\nCiAgICAgICAgRmllbGRNYXBwaW5nW10gaW52ZXJzZXMgPSBmbS5nZXRJbnZl\ncnNlTWFwcGluZ3MoKTsKICAgICAgICBTdHJpbmcgbmFtZTsKICAgICAgICBp\nZiAoaW52ZXJzZXMubGVuZ3RoID4gMCkKICAgICAgICAgICAgbmFtZSA9IGlu\ndmVyc2VzWzBdLmdldE5hbWUoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIG5hbWUgPSBmbS5nZXREZWZpbmluZ01hcHBpbmcoKS5nZXRUeXBlQWxpYXMo\nKTsKCiAgICAgICAgLy8gc3VmZml4IHdpdGggJ18nICsgdGFyZ2V0IGNvbHVt\nbgogICAgICAgIG5hbWUgKz0gIl8iICsgKChDb2x1bW4pIHRhcmdldCkuZ2V0\nTmFtZSgpOwogICAgICAgIGNvbC5zZXROYW1lKG5hbWUpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcG9wdWxhdGVGb3JlaWduS2V5\nQ29sdW1uKFZhbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUsCiAgICAgICAg\nVGFibGUgbG9jYWwsIFRhYmxlIGZvcmVpZ24sIENvbHVtbiBjb2wsIE9iamVj\ndCB0YXJnZXQsIGJvb2xlYW4gaW52ZXJzZSwKICAgICAgICBpbnQgcG9zLCBp\nbnQgY29scykgewogICAgICAgIC8vIGlmIHRoaXMgaXMgYSBub24taW52ZXJz\nZSBjb2xsZWN0aW9uIGVsZW1lbnQga2V5LCBpdCBtdXN0IGJlIGluCiAgICAg\nICAgLy8gYSBqb2luIHRhYmxlOyBqcGEgc2F5cyB0byB1c2UgdGhlIHRhcmdl\ndCBjb2x1bW4gbmFtZSwKICAgICAgICAvLyB3aGljaCBpcyB0aGUgZGVmYXVs\ndAogICAgICAgIGlmICghaW52ZXJzZSAmJiB2bSA9PSB2bS5nZXRGaWVsZE1h\ncHBpbmcoKS5nZXRFbGVtZW50KCkKICAgICAgICAgICAgJiYgdm0uZ2V0Rmll\nbGRNYXBwaW5nKCkuZ2V0VHlwZUNvZGUoKSAhPSBKYXZhVHlwZXMuTUFQKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIG90aGVyd2lzZSBqcGEg\nYWx3YXlzIHVzZXMgPGZpZWxkPl88cGtjb2w+IGZvciBjb2x1bW4gbmFtZSwg\nZXZlbgogICAgICAgIC8vIHdoZW4gb25seSBvbmUgY29sCiAgICAgICAgaWYg\nKHRhcmdldCBpbnN0YW5jZW9mIENvbHVtbikKICAgICAgICAgICAgY29sLnNl\ndE5hbWUobmFtZSArICJfIiArICgoQ29sdW1uKSB0YXJnZXQpLmdldE5hbWUo\nKSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBwb3B1\nbGF0ZUNvbHVtbnMoVmVyc2lvbiB2ZXJzLCBUYWJsZSB0YWJsZSwgQ29sdW1u\nW10gY29scykgewogICAgICAgIC8vIGNoZWNrIGZvciB2ZXJzaW9uIGZpZWxk\nIGFuZCB1c2UgaXRzIG5hbWUgYXMgY29sdW1uIG5hbWUKICAgICAgICBGaWVs\nZE1hcHBpbmcgZm0gPSB2ZXJzLmdldENsYXNzTWFwcGluZygpLmdldFZlcnNp\nb25GaWVsZE1hcHBpbmcoKTsKICAgICAgICBpZiAoZm0gIT0gbnVsbCAmJiBj\nb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICBjb2xzWzBdLnNldE5hbWUo\nZm0uZ2V0TmFtZSgpKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN1cGVy\nLnBvcHVsYXRlQ29sdW1ucyh2ZXJzLCB0YWJsZSwgY29scyk7CiAgICB9Cn0K\n","encoding":"base64"}

