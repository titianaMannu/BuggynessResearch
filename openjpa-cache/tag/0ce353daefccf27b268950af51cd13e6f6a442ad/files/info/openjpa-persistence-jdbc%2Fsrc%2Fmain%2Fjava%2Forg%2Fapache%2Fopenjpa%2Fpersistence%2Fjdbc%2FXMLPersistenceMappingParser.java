{"sha":"04d7dd738dcc2ccd9707630831275ad223e51a17","node_id":"MDQ6QmxvYjIwNjM2NDowNGQ3ZGQ3MzhkY2MyY2NkOTcwNzYzMDgzMTI3NWFkMjIzZTUxYTE3","size":27754,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/04d7dd738dcc2ccd9707630831275ad223e51a17","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjOwoKaW1wb3J0IGphdmEuc3FsLlR5\ncGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nRGlzY3JpbWluYXRvclR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5F\nbnVtVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkluaGVyaXRhbmNl\nVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRlbXBvcmFsVHlwZTsK\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsK\naW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9ydCBvcmcueG1s\nLnNheC5TQVhFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZ0luZm87Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRpc2NyaW1pbmF0\nb3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5NYXBwaW5nUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuUXVlcnlSZXN1bHRNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5TZXF1ZW5jZU1hcHBp\nbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5FbnVtVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5zdHJhdHMuRmxhdENsYXNzU3RyYXRlZ3k7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5GdWxsQ2xhc3NT\ndHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nc3RyYXRzLk5vbmVDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmVydGljYWxDbGFzc1N0cmF0ZWd5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVt\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Vbmlx\ndWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuWE1MUGVyc2lz\ndGVuY2VNZXRhRGF0YVBhcnNlcjsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5NYXBwaW5nVGFnLio7CgovKioK\nICogQ3VzdG9tIFNBWCBwYXJzZXIgdXNlZCBieSB0aGUgc3lzdGVtIHRvIHBh\ncnNlIHBlcnNpc3RlbmNlIG1hcHBpbmcgZmlsZXMuCiAqCiAqIEBhdXRob3Ig\nU3RldmUgS2ltCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBYTUxQ\nZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIKICAgIGV4dGVuZHMgWE1MUGVyc2lz\ndGVuY2VNZXRhRGF0YVBhcnNlciB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgTWFwPFN0cmluZywgTWFwcGluZ1RhZz4gX2VsZW1zID0KICAgICAgICBu\nZXcgSGFzaE1hcDxTdHJpbmcsIE1hcHBpbmdUYWc+KCk7CgogICAgc3RhdGlj\nIHsKICAgICAgICBfZWxlbXMucHV0KCJhc3NvY2lhdGlvbi1vdmVycmlkZSIs\nIEFTU09DX09WRVJSSURFKTsKICAgICAgICBfZWxlbXMucHV0KCJhdHRyaWJ1\ndGUtb3ZlcnJpZGUiLCBBVFRSX09WRVJSSURFKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJjb2x1bW4iLCBDT0wpOwogICAgICAgIF9lbGVtcy5wdXQoImNvbHVt\nbi1yZXN1bHQiLCBDT0xVTU5fUkVTVUxUKTsKICAgICAgICBfZWxlbXMucHV0\nKCJkaXNjcmltaW5hdG9yLWNvbHVtbiIsIERJU0NSSU1fQ09MKTsKICAgICAg\nICBfZWxlbXMucHV0KCJkaXNjcmltaW5hdG9yLXZhbHVlIiwgRElTQ1JJTV9W\nQUwpOwogICAgICAgIF9lbGVtcy5wdXQoImVudGl0eS1yZXN1bHQiLCBFTlRJ\nVFlfUkVTVUxUKTsKICAgICAgICBfZWxlbXMucHV0KCJlbnVtZXJhdGVkIiwg\nRU5VTUVSQVRFRCk7CiAgICAgICAgX2VsZW1zLnB1dCgiZmllbGQtcmVzdWx0\nIiwgRklFTERfUkVTVUxUKTsKICAgICAgICBfZWxlbXMucHV0KCJpbmhlcml0\nYW5jZSIsIElOSEVSSVRBTkNFKTsKICAgICAgICBfZWxlbXMucHV0KCJqb2lu\nLWNvbHVtbiIsIEpPSU5fQ09MKTsKICAgICAgICBfZWxlbXMucHV0KCJpbnZl\ncnNlLWpvaW4tY29sdW1uIiwgQ09MKTsKICAgICAgICBfZWxlbXMucHV0KCJq\nb2luLXRhYmxlIiwgSk9JTl9UQUJMRSk7CiAgICAgICAgX2VsZW1zLnB1dCgi\ncHJpbWFyeS1rZXktam9pbi1jb2x1bW4iLCBQS19KT0lOX0NPTCk7CiAgICAg\nICAgX2VsZW1zLnB1dCgic2Vjb25kYXJ5LXRhYmxlIiwgU0VDT05EQVJZX1RB\nQkxFKTsKICAgICAgICBfZWxlbXMucHV0KCJzcWwtcmVzdWx0LXNldC1tYXBw\naW5nIiwgU1FMX1JFU1VMVF9TRVRfTUFQUElORyk7CiAgICAgICAgX2VsZW1z\nLnB1dCgidGFibGUiLCBUQUJMRSk7CiAgICAgICAgX2VsZW1zLnB1dCgidGFi\nbGUtZ2VuZXJhdG9yIiwgVEFCTEVfR0VOKTsKICAgICAgICBfZWxlbXMucHV0\nKCJ0ZW1wb3JhbCIsIFRFTVBPUkFMKTsKICAgIH0KCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNr\nYWdlCiAgICAgICAgKFhNTFBlcnNpc3RlbmNlTWFwcGluZ1BhcnNlci5jbGFz\ncyk7CgogICAgcHJpdmF0ZSBTdHJpbmcgX292ZXJyaWRlID0gbnVsbDsKICAg\nIHByaXZhdGUgU3RyaW5nIF9zY2hlbWEgPSBudWxsOwogICAgcHJpdmF0ZSBT\ndHJpbmcgX2NvbFRhYmxlID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9z\nZWNvbmRhcnlUYWJsZSA9IG51bGw7CiAgICBwcml2YXRlIExpc3Q8Q29sdW1u\nPiBfY29scyA9IG51bGw7CiAgICBwcml2YXRlIExpc3Q8Q29sdW1uPiBfam9p\nbkNvbHMgPSBudWxsOwogICAgcHJpdmF0ZSBMaXN0PENvbHVtbj4gX3N1cEpv\naW5Db2xzID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfbG9iID0gZmFs\nc2U7CiAgICBwcml2YXRlIFRlbXBvcmFsVHlwZSBfdGVtcG9yYWwgPSBudWxs\nOwogICAgcHJpdmF0ZSBFbnVtU2V0PFVuaXF1ZUZsYWc+IF91bmlxdWUgPSBF\nbnVtU2V0Lm5vbmVPZihVbmlxdWVGbGFnLmNsYXNzKTsKICAgIHByaXZhdGUg\nRGlzY3JpbWluYXRvclR5cGUgX2Rpc2NUeXBlOwogICAgcHJpdmF0ZSBDb2x1\nbW4gX2Rpc2NDb2w7CiAgICBwcml2YXRlIGludCBfcmVzdWx0SWR4ID0gMDsK\nCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIFhNTFBlcnNpc3RlbmNlTWFwcGlu\nZ1BhcnNlcihKREJDQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgc3Vw\nZXIoY29uZik7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\ndm9pZCByZXNldCgpIHsKICAgICAgICBzdXBlci5yZXNldCgpOwogICAgICAg\nIGNsZWFyQ29sdW1uSW5mbygpOwogICAgICAgIGNsZWFyQ2xhc3NJbmZvKCk7\nCiAgICAgICAgY2xlYXJTZWNvbmRhcnlUYWJsZUluZm8oKTsKICAgICAgICBf\nb3ZlcnJpZGUgPSBudWxsOwogICAgICAgIF9zY2hlbWEgPSBudWxsOwogICAg\nICAgIF9yZXN1bHRJZHggPSAwOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHJvdGVjdGVkIE9iamVjdCBzdGFydFN5c3RlbU1hcHBpbmdFbGVtZW50KFN0\ncmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIE1hcHBpbmdUYWcgdGFnID0gX2VsZW1z\nLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwpIHsKICAgICAg\nICAgICAgaWYgKCJzY2hlbWEiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAg\nICAgIHJldHVybiBuYW1lOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICB9CgogICAgICAgIGJvb2xlYW4gcmV0OwogICAgICAgIHN3aXRjaCAo\ndGFnKSB7CiAgICAgICAgICAgIGNhc2UgVEFCTEVfR0VOOgogICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRUYWJsZUdlbmVyYXRvcihhdHRycyk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBTUUxfUkVTVUxU\nX1NFVF9NQVBQSU5HOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRTUUxS\nZXN1bHRTZXRNYXBwaW5nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIEVOVElUWV9SRVNVTFQ6CiAgICAgICAgICAg\nICAgICByZXQgPSBzdGFydEVudGl0eVJlc3VsdChhdHRycyk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBGSUVMRF9SRVNVTFQ6\nCiAgICAgICAgICAgICAgICByZXQgPSBzdGFydEZpZWxkUmVzdWx0KGF0dHJz\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIENP\nTFVNTl9SRVNVTFQ6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydENvbHVt\nblJlc3VsdChhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldCA9IGZhbHNlOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gKHJldCkgPyB0YWcgOiBudWxsOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kU3lz\ndGVtTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgTWFwcGluZ1RhZyB0YWcgPSBfZWxl\nbXMuZ2V0KG5hbWUpOwogICAgICAgIGlmICh0YWcgPT0gbnVsbCkgewogICAg\nICAgICAgICBpZiAoInNjaGVtYSIuZXF1YWxzKG5hbWUpKQogICAgICAgICAg\nICAgICAgX3NjaGVtYSA9IGN1cnJlbnRUZXh0KCk7CiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB9CgogICAgICAgIHN3aXRjaCAodGFnKSB7CiAgICAg\nICAgICAgIGNhc2UgU1FMX1JFU1VMVF9TRVRfTUFQUElORzoKICAgICAgICAg\nICAgICAgIGVuZFNRTFJlc3VsdFNldE1hcHBpbmcoKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEVOVElUWV9SRVNVTFQ6CiAg\nICAgICAgICAgICAgICBlbmRFbnRpdHlSZXN1bHQoKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRDbGFzc01hcHBpbmdFbGVtZW50KFN0\ncmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIE1hcHBpbmdUYWcgdGFnID0gX2VsZW1z\nLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwoKICAgICAgICBib29sZWFuIHJldDsKICAgICAg\nICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICBjYXNlIFRBQkxFOgogICAg\nICAgICAgICAgICAgcmV0ID0gc3RhcnRUYWJsZShhdHRycyk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBTRUNPTkRBUllfVEFC\nTEU6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydFNlY29uZGFyeVRhYmxl\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIERJU0NSSU1fQ09MOgogICAgICAgICAgICAgICAgX2Rpc2NDb2wgPSBw\nYXJzZUNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICByZXQgPSB0cnVl\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRElT\nQ1JJTV9WQUw6CiAgICAgICAgICAgICAgICByZXQgPSB0cnVlOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSU5IRVJJVEFOQ0U6\nCiAgICAgICAgICAgICAgICByZXQgPSBzdGFydEluaGVyaXRhbmNlKGF0dHJz\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEFT\nU09DX09WRVJSSURFOgogICAgICAgICAgICBjYXNlIEFUVFJfT1ZFUlJJREU6\nCiAgICAgICAgICAgICAgICByZXQgPSBzdGFydEF0dHJpYnV0ZU92ZXJyaWRl\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIFBLX0pPSU5fQ09MOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRQ\ncmltYXJ5S2V5Sm9pbkNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBDT0w6CiAgICAgICAgICAgICAgICBy\nZXQgPSBzdGFydENvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBKT0lOX0NPTDoKICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0Sm9pbkNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKT0lOX1RBQkxFOgogICAgICAg\nICAgICAgICAgcmV0ID0gc3RhcnRKb2luVGFibGUoYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVEFCTEVfR0VOOgog\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRUYWJsZUdlbmVyYXRvcihhdHRy\ncyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBV\nTklRVUU6CiAgICAgICAgICAgICAgICBnZXRMb2coKS53YXJuKF9sb2MuZ2V0\nKCJ1bmlxdWUtY29uc3RyYWludHMiLCBjdXJyZW50RWxlbWVudCgpKSk7CiAg\nICAgICAgICAgICAgICByZXQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIFRFTVBPUkFMOgogICAgICAgICAgICBj\nYXNlIEVOVU1FUkFURUQ6CiAgICAgICAgICAgICAgICByZXQgPSB0cnVlOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgU1FMX1JF\nU1VMVF9TRVRfTUFQUElORzoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nU1FMUmVzdWx0U2V0TWFwcGluZyhhdHRycyk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgogICAgICAg\nICAgICAgICAgcmV0ID0gc3RhcnRFbnRpdHlSZXN1bHQoYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRklFTERfUkVT\nVUxUOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRGaWVsZFJlc3VsdChh\ndHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBDT0xVTU5fUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRD\nb2x1bW5SZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXQgPSBmYWxz\nZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChyZXQpID8gdGFnIDogbnVs\nbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGVu\nZENsYXNzTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgTWFwcGluZ1RhZyB0YWcgPSBf\nZWxlbXMuZ2V0KG5hbWUpOwogICAgICAgIGlmICh0YWcgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICBzd2l0Y2ggKHRhZykgewogICAg\nICAgICAgICBjYXNlIFNFQ09OREFSWV9UQUJMRToKICAgICAgICAgICAgICAg\nIGVuZFNlY29uZGFyeVRhYmxlKCk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBESVNDUklNX1ZBTDoKICAgICAgICAgICAgICAg\nIGVuZERpc2NyaW1pbmF0b3JWYWx1ZSgpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgQVRUUl9PVkVSUklERToKICAgICAgICAg\nICAgICAgIGVuZEF0dHJpYnV0ZU92ZXJyaWRlKCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKT0lOX1RBQkxFOgogICAgICAg\nICAgICAgICAgZW5kSm9pblRhYmxlKCk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBURU1QT1JBTDoKICAgICAgICAgICAgICAg\nIGVuZFRlbXBvcmFsKCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBFTlVNRVJBVEVEOgogICAgICAgICAgICAgICAgZW5kRW51\nbWVyYXRlZCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgU1FMX1JFU1VMVF9TRVRfTUFQUElORzoKICAgICAgICAgICAgICAg\nIGVuZFNRTFJlc3VsdFNldE1hcHBpbmcoKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIEVOVElUWV9SRVNVTFQ6CiAgICAgICAg\nICAgICAgICBlbmRFbnRpdHlSZXN1bHQoKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3Rl\nY3RlZCB2b2lkIHN0YXJ0Q2xhc3NNYXBwaW5nKENsYXNzTWV0YURhdGEgbWV0\nYSwgYm9vbGVhbiBtYXBwZWRTdXBlciwKICAgICAgICBBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlm\nIChtYXBwZWRTdXBlcikKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIG1l\ndGEpLmdldE1hcHBpbmdJbmZvKCkuc2V0U3RyYXRlZ3kKICAgICAgICAgICAg\nICAgIChOb25lQ2xhc3NTdHJhdGVneS5BTElBUyk7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmcoQ2xh\nc3NNZXRhRGF0YSBtZXRhKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIG1l\ndGE7CiAgICAgICAgaWYgKF9zdXBKb2luQ29scyAhPSBudWxsKQogICAgICAg\nICAgICBjbS5nZXRNYXBwaW5nSW5mbygpLnNldENvbHVtbnMoX3N1cEpvaW5D\nb2xzKTsKCiAgICAgICAgaWYgKF9kaXNjQ29sICE9IG51bGwpIHsKICAgICAg\nICAgICAgRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvIGRpbmZvID0gY20uZ2V0\nRGlzY3JpbWluYXRvcigpLgogICAgICAgICAgICAgICAgZ2V0TWFwcGluZ0lu\nZm8oKTsKICAgICAgICAgICAgaWYgKF9kaXNjVHlwZSAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBzd2l0Y2ggKF9kaXNjVHlwZSkgewogICAgICAgICAg\nICAgICAgICAgIGNhc2UgQ0hBUjoKICAgICAgICAgICAgICAgICAgICAgICAg\nX2Rpc2NDb2wuc2V0SmF2YVR5cGUoSmF2YVR5cGVzLkNIQVIpOwogICAgICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBj\nYXNlIElOVEVHRVI6CiAgICAgICAgICAgICAgICAgICAgICAgIF9kaXNjQ29s\nLnNldEphdmFUeXBlKEphdmFUeXBlcy5JTlQpOwogICAgICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Ogog\nICAgICAgICAgICAgICAgICAgICAgICBfZGlzY0NvbC5zZXRKYXZhVHlwZShK\nYXZhVHlwZXMuU1RSSU5HKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgZGluZm8uc2V0Q29sdW1ucyhBcnJheXMuYXNMaXN0KG5ldyBDb2x1bW5b\nXXsgX2Rpc2NDb2wgfSkpOwogICAgICAgIH0KICAgICAgICBjbGVhckNsYXNz\nSW5mbygpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xlYXIgY2FjaGVkIGNs\nYXNzIG1hcHBpbmcgaW5mby4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNs\nZWFyQ2xhc3NJbmZvKCkgewogICAgICAgIF9zdXBKb2luQ29scyA9IG51bGw7\nCiAgICAgICAgX2Rpc2NDb2wgPSBudWxsOwogICAgICAgIF9kaXNjVHlwZSA9\nIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGFydCB0cmFja2luZyBz\nZWNvbmRhcnkgdGFibGUgaW5mb3JtYXRpb24gYW5kIGNvbHVtbnMKICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0U2Vjb25kYXJ5VGFibGUoQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBfc2Vjb25kYXJ5VGFibGUgPSB0b1RhYmxlTmFtZShhdHRycy5n\nZXRWYWx1ZSgic2NoZW1hIiksCiAgICAgICAgICAgIGF0dHJzLmdldFZhbHVl\nKCJuYW1lIikpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBzZWNvbmRhcnkgdGFibGUgaW5mb3JtYXRpb24g\nYmFjayB0byB0aGUgb3duaW5nIGNsYXNzIG1hcHBpbmcuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBlbmRTZWNvbmRhcnlUYWJsZSgpIHsKICAgICAgICBD\nbGFzc01hcHBpbmcgY20gPSAoQ2xhc3NNYXBwaW5nKSBjdXJyZW50RWxlbWVu\ndCgpOwogICAgICAgIENsYXNzTWFwcGluZ0luZm8gaW5mbyA9IGNtLmdldE1h\ncHBpbmdJbmZvKCk7CiAgICAgICAgaW5mby5zZXRTZWNvbmRhcnlUYWJsZUpv\naW5Db2x1bW5zKF9zZWNvbmRhcnlUYWJsZSwgX2pvaW5Db2xzKTsKICAgICAg\nICBjbGVhclNlY29uZGFyeVRhYmxlSW5mbygpOwogICAgfQoKICAgIC8qKgog\nICAgICogQ2xlYXIgY2FjaGVkIHNlY29uZGFyeSB0YWJsZSBpbmZvLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXJTZWNvbmRhcnlUYWJsZUluZm8o\nKSB7CiAgICAgICAgX2pvaW5Db2xzID0gbnVsbDsKICAgICAgICBfc2Vjb25k\nYXJ5VGFibGUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\ndGFibGUtZ2VuZXJhdG9yLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4g\nc3RhcnRUYWJsZUdlbmVyYXRvcihBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAg\nICAgU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAg\nICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzSW5m\nb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoInBh\ncnNlLWdlbiIsIG5hbWUpKTsKICAgICAgICBpZiAoZ2V0UmVwb3NpdG9yeSgp\nLmdldENhY2hlZFNlcXVlbmNlTWV0YURhdGEobmFtZSkgIT0gbnVsbAogICAg\nICAgICAgICAmJiBsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBs\nb2cud2FybihfbG9jLmdldCgib3ZlcnJpZGUtZ2VuIiwgbmFtZSkpOwoKICAg\nICAgICBTZXF1ZW5jZU1hcHBpbmcgc2VxID0gKFNlcXVlbmNlTWFwcGluZykg\nZ2V0UmVwb3NpdG9yeSgpLgogICAgICAgICAgICBhZGRTZXF1ZW5jZU1ldGFE\nYXRhKG5hbWUpOwogICAgICAgIHNlcS5zZXRTZXF1ZW5jZVBsdWdpbihTZXF1\nZW5jZU1hcHBpbmcuSU1QTF9WQUxVRV9UQUJMRSk7CiAgICAgICAgc2VxLnNl\ndFRhYmxlKHRvVGFibGVOYW1lKGF0dHJzLmdldFZhbHVlKCJzY2hlbWEiKSwK\nICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoInRhYmxlIikpKTsKICAgICAg\nICBzZXEuc2V0UHJpbWFyeUtleUNvbHVtbihhdHRycy5nZXRWYWx1ZSgicGst\nY29sdW1uLW5hbWUiKSk7CiAgICAgICAgc2VxLnNldFNlcXVlbmNlQ29sdW1u\nKGF0dHJzLmdldFZhbHVlKCJ2YWx1ZS1jb2x1bW4tbmFtZSIpKTsKICAgICAg\nICBzZXEuc2V0UHJpbWFyeUtleVZhbHVlKGF0dHJzLmdldFZhbHVlKCJway1j\nb2x1bW4tdmFsdWUiKSk7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdl\ndFZhbHVlKCJpbml0aWFsLXZhbHVlIik7CiAgICAgICAgaWYgKHZhbCAhPSBu\ndWxsKQogICAgICAgICAgICBzZXEuc2V0SW5pdGlhbFZhbHVlKEludGVnZXIu\ncGFyc2VJbnQodmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nImFsbG9jYXRpb24tc2l6ZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkK\nICAgICAgICAgICAgc2VxLnNldEFsbG9jYXRlKEludGVnZXIucGFyc2VJbnQo\ndmFsKSk7CgogICAgICAgIE9iamVjdCBjdXIgPSBjdXJyZW50RWxlbWVudCgp\nOwogICAgICAgIE9iamVjdCBzY29wZSA9IChjdXIgaW5zdGFuY2VvZiBDbGFz\nc01ldGFEYXRhKQogICAgICAgICAgICA/ICgoQ2xhc3NNZXRhRGF0YSkgY3Vy\nKS5nZXREZXNjcmliZWRUeXBlKCkgOiBudWxsOwogICAgICAgIHNlcS5zZXRT\nb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBzY29wZSwgc2VxLlNSQ19YTUwpOwog\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFy\nc2UgaW5oZXJpdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBz\ndGFydEluaGVyaXRhbmNlKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBT\ndHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInN0cmF0ZWd5Iik7CiAgICAg\nICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNtID0gKENsYXNzTWFwcGluZykgY3Vy\ncmVudEVsZW1lbnQoKTsKICAgICAgICBDbGFzc01hcHBpbmdJbmZvIGluZm8g\nPSBjbS5nZXRNYXBwaW5nSW5mbygpOwogICAgICAgIHN3aXRjaCAoRW51bS52\nYWx1ZU9mKEluaGVyaXRhbmNlVHlwZS5jbGFzcywgdmFsKSkgewogICAgICAg\nICAgICBjYXNlIFNJTkdMRV9UQUJMRToKICAgICAgICAgICAgICAgIGluZm8u\nc2V0SGllcmFyY2h5U3RyYXRlZ3koRmxhdENsYXNzU3RyYXRlZ3kuQUxJQVMp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSk9J\nTkVEOgogICAgICAgICAgICAgICAgaW5mby5zZXRIaWVyYXJjaHlTdHJhdGVn\neShWZXJ0aWNhbENsYXNzU3RyYXRlZ3kuQUxJQVMpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVEFCTEVfUEVSX0NMQVNTOgog\nICAgICAgICAgICAgICAgaW5mby5zZXRIaWVyYXJjaHlTdHJhdGVneShGdWxs\nQ2xhc3NTdHJhdGVneS5BTElBUyk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQYXJzZSBkaXNjcmltaW5hdG9yLXZhbHVlLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgZW5kRGlzY3JpbWluYXRvclZhbHVlKCkgewogICAg\nICAgIFN0cmluZyB2YWwgPSBjdXJyZW50VGV4dCgpOwogICAgICAgIGlmIChT\ndHJpbmdVdGlscy5pc0VtcHR5KHZhbCkpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNtID0gKENsYXNzTWFwcGluZykgY3Vy\ncmVudEVsZW1lbnQoKTsKICAgICAgICBjbS5nZXREaXNjcmltaW5hdG9yKCku\nZ2V0TWFwcGluZ0luZm8oKS5zZXRWYWx1ZSh2YWwpOwogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgdGVtcG9yYWwuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBlbmRUZW1wb3JhbCgpIHsKICAgICAgICBTdHJpbmcgdGVtcCA9IGN1\ncnJlbnRUZXh0KCk7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5\nKHRlbXApKQogICAgICAgICAgICBfdGVtcG9yYWwgPSBFbnVtLnZhbHVlT2Yo\nVGVtcG9yYWxUeXBlLmNsYXNzLCB0ZW1wKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIGVudW1lcmF0ZWQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBlbmRFbnVtZXJhdGVkKCkgewogICAgICAgIFN0cmluZyB0ZXh0ID0gY3Vy\ncmVudFRleHQoKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eSh0\nZXh0KSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIEVudW1UeXBlIHR5\ncGUgPSBFbnVtLnZhbHVlT2YoRW51bVR5cGUuY2xhc3MsIHRleHQpOwoKICAg\nICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIFN0cmluZyBzdHJhdCA9IEVudW1WYWx1ZUhh\nbmRsZXIuY2xhc3MuZ2V0TmFtZSgpICsgIihTdG9yZU9yZGluYWw9IgogICAg\nICAgICAgICArIFN0cmluZy52YWx1ZU9mKHR5cGUgPT0gRW51bVR5cGUuT1JE\nSU5BTCkgKyAiKSI7CiAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCkuc2V0U3Ry\nYXRlZ3koc3RyYXQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIGJvb2xlYW4gc3RhcnRMb2IoQXR0cmlidXRlcyBhdHRycykKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoc3VwZXIuc3Rh\ncnRMb2IoYXR0cnMpKSB7CiAgICAgICAgICAgIF9sb2IgPSB0cnVlOwogICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogRXh0ZW5kIHRvIGNsZWFy\nIGFubm90YXRpb24gbWFwcGluZyBpbmZvLgogICAgICovCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0RmllbGRNYXBwaW5nKEZpZWxk\nTWV0YURhdGEgZmllbGQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc3RhcnRGaWVsZE1h\ncHBpbmcoZmllbGQsIGF0dHJzKTsKICAgICAgICBpZiAoZ2V0QW5ub3RhdGlv\nblBhcnNlcigpICE9IG51bGwpIHsKICAgICAgICAgICAgRmllbGRNYXBwaW5n\nIGZtID0gKEZpZWxkTWFwcGluZykgZmllbGQ7CiAgICAgICAgICAgIGZtLmdl\ndE1hcHBpbmdJbmZvKCkuY2xlYXIoKTsKICAgICAgICAgICAgZm0uZ2V0VmFs\ndWVJbmZvKCkuY2xlYXIoKTsKICAgICAgICAgICAgZm0uZ2V0RWxlbWVudE1h\ncHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwogICAgICAgICAgICBm\nbS5nZXRLZXlNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCkuY2xlYXIoKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBFeHRlbmQgdG8gc2V0IHRo\nZSBjb2x1bW5zLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCB2b2lkIGVuZEZpZWxkTWFwcGluZyhGaWVsZE1ldGFEYXRhIGZpZWxkKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIC8vIHNldHVw\nIGNvbHVtbnMgd2l0aCBjYWNoZWQgbG9iIGFuZCB0ZW1wb3JhbCBpbmZvCiAg\nICAgICAgRmllbGRNYXBwaW5nIGZtID0gKEZpZWxkTWFwcGluZykgZmllbGQ7\nCiAgICAgICAgaWYgKF9sb2IgfHwgX3RlbXBvcmFsICE9IG51bGwpIHsKICAg\nICAgICAgICAgaWYgKF9jb2xzID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIF9jb2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDEpOwogICAgICAgICAg\nICAgICAgX2NvbHMuYWRkKG5ldyBDb2x1bW4oKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgZm9yIChDb2x1bW4gY29sIDogX2NvbHMpIHsKICAgICAg\nICAgICAgICAgIGlmIChfbG9iICYmIChmbS5nZXREZWNsYXJlZFR5cGVDb2Rl\nKCkgPT0gSmF2YVR5cGVzLlNUUklORwogICAgICAgICAgICAgICAgICAgIHx8\nIGZtLmdldERlY2xhcmVkVHlwZSgpID09IGNoYXJbXS5jbGFzcwogICAgICAg\nICAgICAgICAgICAgIHx8IGZtLmdldERlY2xhcmVkVHlwZSgpID09IENoYXJh\nY3RlcltdLmNsYXNzKSkgewogICAgICAgICAgICAgICAgICAgIGNvbC5zZXRT\naXplKC0xKTsKICAgICAgICAgICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBl\ncy5DTE9CKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX2xvYikKICAg\nICAgICAgICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5CTE9CKTsKICAg\nICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN3aXRj\naCAoX3RlbXBvcmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ug\nREFURToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBl\nKFR5cGVzLkRBVEUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgVElNRToKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLlRJTUUp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGNhc2UgVElNRVNUQU1QOgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuVElNRVNUQU1QKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaWYgKF9jb2xzICE9IG51bGwpIHsKICAgICAg\nICAgICAgc3dpdGNoIChmbS5nZXREZWNsYXJlZFR5cGVDb2RlKCkpIHsKICAg\nICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAg\nICAgICAgICAgIGlmIChmbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBieXRlW10u\nY2xhc3MKICAgICAgICAgICAgICAgICAgICAgICAgfHwgZm0uZ2V0RGVjbGFy\nZWRUeXBlKCkgPT0gY2hhcltdLmNsYXNzCiAgICAgICAgICAgICAgICAgICAg\nICAgIHx8IGZtLmdldERlY2xhcmVkVHlwZSgpID09IENoYXJhY3RlcltdLmNs\nYXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZtLmdldFZhbHVlSW5m\nbygpLnNldENvbHVtbnMoX2NvbHMpOwogICAgICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICAgICAgLy8gZWxzZSBubyBicmVhawogICAgICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgICAgICBmbS5nZXRFbGVtZW50\nTWFwcGluZygpLmdldFZhbHVlSW5mbygpLnNldENvbHVtbnMoX2NvbHMpOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5z\nZXRDb2x1bW5zKF9jb2xzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBp\nZiAoX2NvbFRhYmxlICE9IG51bGwpCiAgICAgICAgICAgICAgICBmbS5nZXRN\nYXBwaW5nSW5mbygpLnNldFRhYmxlTmFtZShfY29sVGFibGUpOwogICAgICAg\nICAgICBzZXRVbmlxdWUoZm0pOwogICAgICAgIH0KICAgICAgICBjbGVhckNv\nbHVtbkluZm8oKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB1bmlxdWUg\nZm9yIGZpZWxkLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2V0VW5pcXVl\nKEZpZWxkTWFwcGluZyBmbSkgewogICAgICAgIGlmIChfdW5pcXVlLnNpemUo\nKSA9PSAyKSAvLyBpLmUuIFRSVUUgJiBGQUxTRQogICAgICAgICAgICBnZXRM\nb2coKS53YXJuKF9sb2MuZ2V0KCJpbmNvbnNpc3QtY29sLWF0dHJzIiwgZm0p\nKTsKICAgICAgICBlbHNlIGlmIChfdW5pcXVlLmNvbnRhaW5zKFVuaXF1ZUZs\nYWcuVFJVRSkpCiAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNldFVu\naXF1ZShuZXcgVW5pcXVlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xl\nYXIgZmllbGQgbGV2ZWwgY29sdW1uIGluZm9ybWF0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgY2xlYXJDb2x1bW5JbmZvKCkgewogICAgICAgIF9j\nb2xzID0gbnVsbDsKICAgICAgICBfam9pbkNvbHMgPSBudWxsOwogICAgICAg\nIF9jb2xUYWJsZSA9IG51bGw7CiAgICAgICAgX2xvYiA9IGZhbHNlOwogICAg\nICAgIF90ZW1wb3JhbCA9IG51bGw7CiAgICAgICAgX3VuaXF1ZS5jbGVhcigp\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgYXR0cmlidXRlLW92ZXJy\naWRlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRBdHRyaWJ1\ndGVPdmVycmlkZShBdHRyaWJ1dGVzIGF0dHIpIHsKICAgICAgICBfb3ZlcnJp\nZGUgPSBhdHRyLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgYXR0cmlidXRlIG92ZXJy\naWRlIGludG8gcHJvcGVyIG1hcHBpbmcuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBlbmRBdHRyaWJ1dGVPdmVycmlkZSgpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IGVsZW0gPSBjdXJyZW50RWxl\nbWVudCgpOwogICAgICAgIEZpZWxkTWFwcGluZyBmbTsKICAgICAgICBpZiAo\nZWxlbSBpbnN0YW5jZW9mIENsYXNzTWFwcGluZykKICAgICAgICAgICAgZm0g\nPSBnZXRBdHRyaWJ1dGVPdmVycmlkZSgoQ2xhc3NNYXBwaW5nKSBlbGVtKTsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIGZtID0gZ2V0QXR0cmlidXRlT3Zl\ncnJpZGUoKEZpZWxkTWFwcGluZykgZWxlbSk7CiAgICAgICAgaWYgKF9jb2xz\nICE9IG51bGwpIHsKICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCkuc2V0\nQ29sdW1ucyhfY29scyk7CiAgICAgICAgICAgIGlmIChfY29sVGFibGUgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCkuc2V0\nVGFibGVOYW1lKF9jb2xUYWJsZSk7CiAgICAgICAgICAgIHNldFVuaXF1ZShm\nbSk7CiAgICAgICAgfQogICAgICAgIGNsZWFyQ29sdW1uSW5mbygpOwogICAg\nICAgIF9vdmVycmlkZSA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIHByb3BlciBvdmVycmlkZS4KICAgICAqLwogICAgcHJpdmF0\nZSBGaWVsZE1hcHBpbmcgZ2V0QXR0cmlidXRlT3ZlcnJpZGUoQ2xhc3NNYXBw\naW5nIGNtKSB7CiAgICAgICAgRmllbGRNYXBwaW5nIHN1cCA9IChGaWVsZE1h\ncHBpbmcpIGNtLmdldERlZmluZWRTdXBlcmNsYXNzRmllbGQKICAgICAgICAg\nICAgKF9vdmVycmlkZSk7CiAgICAgICAgaWYgKHN1cCA9PSBudWxsKQogICAg\nICAgICAgICBzdXAgPSAoRmllbGRNYXBwaW5nKSBjbS5hZGREZWZpbmVkU3Vw\nZXJjbGFzc0ZpZWxkKF9vdmVycmlkZSwKICAgICAgICAgICAgICAgIE9iamVj\ndC5jbGFzcywgT2JqZWN0LmNsYXNzKTsKICAgICAgICByZXR1cm4gc3VwOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwcm9wZXIgb3ZlcnJp\nZGUuCiAgICAgKi8KICAgIHByaXZhdGUgRmllbGRNYXBwaW5nIGdldEF0dHJp\nYnV0ZU92ZXJyaWRlKEZpZWxkTWFwcGluZyBmbSkKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBDbGFzc01hcHBpbmcgZW1iZWQgPSBm\nbS5nZXRFbWJlZGRlZE1hcHBpbmcoKTsKICAgICAgICBpZiAoZW1iZWQgPT0g\nbnVsbCkKICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0\nKCJub3QtZW1iZWRkZWQiLCBmbSkpOwoKICAgICAgICBGaWVsZE1hcHBpbmcg\nZWZtID0gZW1iZWQuZ2V0RmllbGRNYXBwaW5nKF9vdmVycmlkZSk7CiAgICAg\nICAgaWYgKGVmbSA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBnZXRFeGNl\ncHRpb24oX2xvYy5nZXQoImVtYmVkLW92ZXJyaWRlLW5hbWUiLAogICAgICAg\nICAgICAgICAgZm0sIF9vdmVycmlkZSkpOwogICAgICAgIHJldHVybiBlZm07\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB0YWJsZS4KICAgICAqLwog\nICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0VGFibGUoQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJp\nbmcgdGFibGUgPSB0b1RhYmxlTmFtZShhdHRycy5nZXRWYWx1ZSgic2NoZW1h\nIiksCiAgICAgICAgICAgIGF0dHJzLmdldFZhbHVlKCJuYW1lIikpOwogICAg\nICAgIGlmICh0YWJsZSAhPSBudWxsKQogICAgICAgICAgICAoKENsYXNzTWFw\ncGluZykgY3VycmVudEVsZW1lbnQoKSkuZ2V0TWFwcGluZ0luZm8oKS5zZXRU\nYWJsZU5hbWUKICAgICAgICAgICAgICAgICh0YWJsZSk7CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBqb2luLXRh\nYmxlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRKb2luVGFi\nbGUoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBTdHJpbmcgdGFibGUgPSB0b1RhYmxlTmFtZShhdHRy\ncy5nZXRWYWx1ZSgic2NoZW1hIiksCiAgICAgICAgICAgIGF0dHJzLmdldFZh\nbHVlKCJuYW1lIikpOwogICAgICAgIGlmICh0YWJsZSAhPSBudWxsKQogICAg\nICAgICAgICAoKEZpZWxkTWFwcGluZykgY3VycmVudEVsZW1lbnQoKSkuZ2V0\nTWFwcGluZ0luZm8oKS5zZXRUYWJsZU5hbWUKICAgICAgICAgICAgICAgICh0\nYWJsZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgdGhlIGpvaW4gdGFibGUgaW5mb3JtYXRpb24gYmFjay4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZEpvaW5UYWJsZSgpIHsKICAgICAg\nICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBjdXJyZW50RWxl\nbWVudCgpOwogICAgICAgIGlmIChfam9pbkNvbHMgIT0gbnVsbCkKICAgICAg\nICAgICAgZm0uZ2V0TWFwcGluZ0luZm8oKS5zZXRDb2x1bW5zKF9qb2luQ29s\ncyk7CiAgICAgICAgaWYgKF9jb2xzICE9IG51bGwpCiAgICAgICAgICAgIGZt\nLmdldEVsZW1lbnRNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCkuc2V0Q29sdW1u\ncyhfY29scyk7CiAgICAgICAgY2xlYXJDb2x1bW5JbmZvKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQYXJzZSBwcmltYXJ5LWtleS1qb2luLWNvbHVtbi4K\nICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0UHJpbWFyeUtleUpv\naW5Db2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW4gY29sID0gcGFyc2VDb2x1bW4o\nYXR0cnMpOwogICAgICAgIGNvbC5zZXRGbGFnKENvbHVtbi5GTEFHX1BLX0pP\nSU4sIHRydWUpOwogICAgICAgIC8vIHBrIGpvaW4gY29sdW1ucyBvbiBmaWVs\nZHMgYWN0IGFzIGZpZWxkIGNvbHMKICAgICAgICBpZiAoY3VycmVudEVsZW1l\nbnQoKSBpbnN0YW5jZW9mIEZpZWxkTWFwcGluZykgewogICAgICAgICAgICBp\nZiAoX2NvbHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jb2xzID0gbmV3\nIEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAgICAgICBfY29scy5hZGQo\nY29sKTsKICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRQYXJlbnQoKSA9PSBT\nRUNPTkRBUllfVEFCTEUpIHsKICAgICAgICAgICAgLy8gcGsgam9pbiBjb2x1\nbW5zIGluIHNlY29uZGFyeSB0YWJsZSBhY3RzIGFzIGpvaW4gY29scwogICAg\nICAgICAgICBpZiAoX2pvaW5Db2xzID09IG51bGwpCiAgICAgICAgICAgICAg\nICBfam9pbkNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAgICAg\nICAgICAgIF9qb2luQ29scy5hZGQoY29sKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAvLyBtdXN0IGJlIHBrIGpvaW4gY29scyBmcm9tIHRoaXMg\nY2xhc3MgdG8gc3VwZXJjbGFzcwogICAgICAgICAgICBpZiAoX3N1cEpvaW5D\nb2xzID09IG51bGwpCiAgICAgICAgICAgICAgICBfc3VwSm9pbkNvbHMgPSBu\nZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAgICAgICAgICAgIF9zdXBKb2lu\nQ29scy5hZGQoY29sKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBqb2luLWNvbHVtbi4KICAg\nICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Sm9pbkNvbHVtbihBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIC8vIG9ubHkgam9pbiBjb2xzIGluIGEgam9pbiB0YWJsZSBqb2lu\nIGZpZWxkIHRhYmxlIHRvIGNsYXNzIHRhYmxlOwogICAgICAgIC8vIG90aGVy\ncyBhY3QgYXMgZGF0YSBmayBjb2xzCiAgICAgICAgaWYgKGN1cnJlbnRQYXJl\nbnQoKSAhPSBKT0lOX1RBQkxFKQogICAgICAgICAgICByZXR1cm4gc3RhcnRD\nb2x1bW4oYXR0cnMpOwoKICAgICAgICBpZiAoX2pvaW5Db2xzID09IG51bGwp\nCiAgICAgICAgICAgIF9qb2luQ29scyA9IG5ldyBBcnJheUxpc3Q8Q29sdW1u\nPigzKTsKICAgICAgICBfam9pbkNvbHMuYWRkKHBhcnNlQ29sdW1uKGF0dHJz\nKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSBjb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBz\ndGFydENvbHVtbihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIGlmIChfY29scyA9PSBudWxsKQogICAg\nICAgICAgICBfY29scyA9IG5ldyBBcnJheUxpc3Q8Q29sdW1uPigzKTsKICAg\nICAgICBfY29scy5hZGQocGFyc2VDb2x1bW4oYXR0cnMpKTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIGNv\nbHVtbiB3aXRoIHRoZSBnaXZlbiBhdHRyaWJ1dGVzLgogICAgICovCiAgICBw\ncml2YXRlIENvbHVtbiBwYXJzZUNvbHVtbihBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIENvbHVtbiBj\nb2wgPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQog\nICAgICAgICAgICBjb2wuc2V0TmFtZSh2YWwpOwogICAgICAgIHZhbCA9IGF0\ndHJzLmdldFZhbHVlKCJyZWZlcmVuY2VkLWNvbHVtbi1uYW1lIik7CiAgICAg\nICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0VGFyZ2V0\nKHZhbCk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImNvbHVtbi1k\nZWZpbml0aW9uIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAg\nICAgICBjb2wuc2V0VHlwZU5hbWUodmFsKTsKICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgicHJlY2lzaW9uIik7CiAgICAgICAgaWYgKHZhbCAhPSBu\ndWxsKQogICAgICAgICAgICBjb2wuc2V0U2l6ZShJbnRlZ2VyLnBhcnNlSW50\nKHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJsZW5ndGgi\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5z\nZXRTaXplKEludGVnZXIucGFyc2VJbnQodmFsKSk7CiAgICAgICAgdmFsID0g\nYXR0cnMuZ2V0VmFsdWUoInNjYWxlIik7CiAgICAgICAgaWYgKHZhbCAhPSBu\ndWxsKQogICAgICAgICAgICBjb2wuc2V0RGVjaW1hbERpZ2l0cyhJbnRlZ2Vy\nLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJudWxsYWJsZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAg\nICAgICAgY29sLnNldE5vdE51bGwoImZhbHNlIi5lcXVhbHModmFsKSk7CiAg\nICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImluc2VydGFibGUiKTsKICAg\nICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5zZXRGbGFn\nKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgImZhbHNlIi5lcXVhbHModmFs\nKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInVwZGF0YWJsZSIp\nOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNl\ndEZsYWcoQ29sdW1uLkZMQUdfVU5VUERBVEFCTEUsICJmYWxzZSIuZXF1YWxz\nKHZhbCkpOwoKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgidW5pcXVl\nIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBfdW5p\ncXVlLmFkZChFbnVtLnZhbHVlT2YoVW5pcXVlRmxhZy5jbGFzcywgdmFsLnRv\nVXBwZXJDYXNlKCkpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgi\ndGFibGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpIHsKICAgICAgICAg\nICAgaWYgKF9jb2xUYWJsZSAhPSBudWxsICYmICFfY29sVGFibGUuZXF1YWxz\nKHZhbCkpCiAgICAgICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xv\nYy5nZXQoInNlY29uZC1pbmNvbnNpc3QiLAogICAgICAgICAgICAgICAgICAg\nIGN1cnJlbnRFbGVtZW50KCkpKTsKICAgICAgICAgICAgX2NvbFRhYmxlID0g\ndmFsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29sOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIGEgdGFibGUgbmFtZSBmb3IgdGhlIGdpdmVu\nIGF0dHJpYnV0ZXMuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIHRvVGFi\nbGVOYW1lKFN0cmluZyBzY2hlbWEsIFN0cmluZyB0YWJsZSkgewogICAgICAg\nIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHRhYmxlKSkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgc2NoZW1hID0gU3RyaW5nVXRpbHMuaXNF\nbXB0eShzY2hlbWEpID8gX3NjaGVtYSA6IHNjaGVtYTsKICAgICAgICBpZiAo\nU3RyaW5nVXRpbHMuaXNFbXB0eShzY2hlbWEpKQogICAgICAgICAgICByZXR1\ncm4gdGFibGU7CiAgICAgICAgcmV0dXJuIHNjaGVtYSArICIuIiArIHRhYmxl\nOwogICAgfQoKICAgIC8qKgogICAgICogU3RhcnQgcHJvY2Vzc2luZyA8Y29k\nZT5zcWwtcmVzdWx0LXNldC1tYXBwaW5nPC9jb2RlPiBub2RlLgogICAgICog\nUHVzaGVzIHRoZSB7QGxpbmsgUXVlcnlSZXN1bHRNYXBwaW5nfSBvbnRvIHRo\nZSBzdGFjayBhcyBjdXJyZW50IGVsZW1lbnQuCiAgICAgKi8KICAgIHByaXZh\ndGUgYm9vbGVhbiBzdGFydFNRTFJlc3VsdFNldE1hcHBpbmcoQXR0cmlidXRl\ncyBhdHRycykgewogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFs\ndWUoIm5hbWUiKTsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAg\nICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy5p\nbmZvKF9sb2MuZ2V0KCJwYXJzZS1zcWxyc21hcHBpbmciLCBuYW1lKSk7Cgog\nICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gKE1hcHBpbmdSZXBv\nc2l0b3J5KSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgUXVlcnlSZXN1bHRN\nYXBwaW5nIHJlc3VsdCA9IHJlcG9zLmdldENhY2hlZFF1ZXJ5UmVzdWx0TWFw\ncGluZwogICAgICAgICAgICAobnVsbCwgbmFtZSk7CiAgICAgICAgaWYgKHJl\nc3VsdCAhPSBudWxsICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAg\nICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJvdmVycmlkZS1zcWxyc21hcHBpbmci\nLCBuYW1lLAogICAgICAgICAgICAgICAgY3VycmVudExvY2F0aW9uKCkpKTsK\nCiAgICAgICAgcmVzdWx0ID0gcmVwb3MuYWRkUXVlcnlSZXN1bHRNYXBwaW5n\nKG51bGwsIG5hbWUpOwogICAgICAgIHJlc3VsdC5zZXRMaXN0aW5nSW5kZXgo\nX3Jlc3VsdElkeCsrKTsKICAgICAgICBhZGRDb21tZW50cyhyZXN1bHQpOwoK\nICAgICAgICBPYmplY3QgY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAg\nICBPYmplY3Qgc2NvcGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0\nYSkKICAgICAgICAgICAgPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVz\nY3JpYmVkVHlwZSgpIDogbnVsbDsKICAgICAgICByZXN1bHQuc2V0U291cmNl\nKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUsIHJlc3VsdC5TUkNfWE1MKTsKCiAg\nICAgICAgcHVzaEVsZW1lbnQocmVzdWx0KTsKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZW5kU1FMUmVzdWx0U2V0TWFw\ncGluZygpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\ncG9wRWxlbWVudCgpOwogICAgfQoKICAgIC8qKgogICAgICogU3RhcnQgcHJv\nY2Vzc2luZyA8Y29kZT5lbnRpdHktcmVzdWx0PC9jb2RlPiBub2RlLgogICAg\nICogUHVzaGVzIHRoZSB7QGxpbmsgUXVlcnlSZXN1bHRNYXBwaW5nLlBDUmVz\ndWx0fQogICAgICogb250byB0aGUgc3RhY2sgYXMgY3VycmVudCBlbGVtZW50\nLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRFbnRpdHlSZXN1\nbHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBDbGFzcyBlbnRpdHlDbGFzcyA9IGNsYXNzRm9yTmFt\nZShhdHRycy5nZXRWYWx1ZSgiZW50aXR5LWNsYXNzIikpOwogICAgICAgIFN0\ncmluZyBkaXNjcmltaW5hdG9yID0gYXR0cnMuZ2V0VmFsdWUoImRpc2NyaW1p\nbmF0b3ItY29sdW1uIik7CgogICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZyBw\nYXJlbnQgPSAoUXVlcnlSZXN1bHRNYXBwaW5nKSBjdXJyZW50RWxlbWVudCgp\nOwogICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZy5QQ1Jlc3VsdCByZXN1bHQg\nPSBwYXJlbnQuYWRkUENSZXN1bHQoZW50aXR5Q2xhc3MpOwogICAgICAgIGlm\nICghU3RyaW5nVXRpbHMuaXNFbXB0eShkaXNjcmltaW5hdG9yKSkKICAgICAg\nICAgICAgcmVzdWx0LmFkZE1hcHBpbmcocmVzdWx0LkRJU0NSSU1JTkFUT1Is\nIGRpc2NyaW1pbmF0b3IpOwogICAgICAgIHB1c2hFbGVtZW50KHJlc3VsdCk7\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIGVuZEVudGl0eVJlc3VsdCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAgfQoKICAgIC8qKgogICAg\nICogUHJvY2VzcyBhIDxjb2RlPmZpZWxkLXJlc3VsdDwvY29kZT4gbm9kZS4K\nICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0RmllbGRSZXN1bHQo\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBTdHJpbmcgZmllbGROYW1lID0gYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKTsKICAgICAgICBTdHJpbmcgY29sdW1uTmFtZSA9IGF0dHJzLmdl\ndFZhbHVlKCJjb2x1bW4iKTsKCiAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5n\nLlBDUmVzdWx0IHBhcmVudCA9IChRdWVyeVJlc3VsdE1hcHBpbmcuUENSZXN1\nbHQpCiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgcGFy\nZW50LmFkZE1hcHBpbmcoZmllbGROYW1lLCBjb2x1bW5OYW1lKTsKICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFByb2Nlc3Mg\nYSA8Y29kZT5jb2x1bW4tcmVzdWx0PC9jb2RlPiBub2RlLgogICAgICovCiAg\nICBwcml2YXRlIGJvb2xlYW4gc3RhcnRDb2x1bW5SZXN1bHQoQXR0cmlidXRl\ncyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBRdWVyeVJlc3VsdE1hcHBpbmcgcGFyZW50ID0gKFF1ZXJ5UmVzdWx0TWFw\ncGluZykgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBwYXJlbnQuYWRkQ29s\ndW1uUmVzdWx0KGF0dHJzLmdldFZhbHVlKCJuYW1lIikpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogVHJhY2sgdW5pcXVl\nIGNvbHVtbiBzZXR0aW5ncy4KCSAqLwoJcHJpdmF0ZSBzdGF0aWMgZW51bSBV\nbmlxdWVGbGFnCgl7CgkJVFJVRSwKCQlGQUxTRQoJfQp9Cg==\n","encoding":"base64"}

