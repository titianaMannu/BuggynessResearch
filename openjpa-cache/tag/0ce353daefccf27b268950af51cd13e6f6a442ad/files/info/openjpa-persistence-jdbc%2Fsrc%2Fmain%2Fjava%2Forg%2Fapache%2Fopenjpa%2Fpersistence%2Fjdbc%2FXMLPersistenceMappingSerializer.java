{"sha":"7550204327988632885fb4a0140b6fb60380fe50","node_id":"MDQ6QmxvYjIwNjM2NDo3NTUwMjA0MzI3OTg4NjMyODg1ZmI0YTAxNDBiNmZiNjAzODBmZTUw","size":25291,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7550204327988632885fb4a0140b6fb60380fe50","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjOwoKaW1wb3J0IGphdmEuc3FsLlR5\ncGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25z\nOwppbXBvcnQgamF2YS51dGlsLkVudW1NYXA7CmltcG9ydCBqYXZhLnV0aWwu\nTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnVtVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRl\nbXBvcmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5T\ndHJpbmdVdGlsczsKaW1wb3J0IG9yZy54bWwuc2F4LlNBWEV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZp\nZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRh\nLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuQ2xhc3NNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdJ\nbmZvOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBw\naW5nUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuUXVlcnlSZXN1bHRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5TZXF1ZW5jZU1hcHBpbmc7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVlTWFwcGluZ0luZm87Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5FbnVt\nVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5zdHJhdHMuRmxhdENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5GdWxsQ2xhc3NTdHJhdGVn\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRz\nLlZlcnRpY2FsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBzdGF0aWMgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rlcy5NT0RFX01BUFBJ\nTkc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YVJl\ncG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5TZXF1\nZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLlBlcnNpc3RlbmNlU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVNl\ncmlhbGl6ZXI7CmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBT\nZXJpYWxpemVzIHBlcnNpc3RlbmNlIG1hcHBpbmcgdG8gWE1MLgogKgogKiBA\nc2luY2UgMC40LjAKICogQGF1dGhvciBTdGV2ZSBLaW0KICogQG5vamF2YWRv\nYwogKi8KcHVibGljIGNsYXNzIFhNTFBlcnNpc3RlbmNlTWFwcGluZ1Nlcmlh\nbGl6ZXIKICAgIGV4dGVuZHMgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVNlcmlh\nbGl6ZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBUWVBFX1JF\nU1VMVE1BUCA9IFRZUEVfUVVFUlkgKyAxOwoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIE1hcDxDb2xUeXBlLCBTdHJpbmc+IF9uYW1lczsKCiAgICBzdGF0\naWMgewogICAgICAgIF9uYW1lcyA9IG5ldyBFbnVtTWFwPENvbFR5cGUsIFN0\ncmluZz4oQ29sVHlwZS5jbGFzcyk7CiAgICAgICAgX25hbWVzLnB1dChDb2xU\neXBlLkNPTCwgImNvbHVtbiIpOwogICAgICAgIF9uYW1lcy5wdXQoQ29sVHlw\nZS5KT0lOLCAiam9pbi1jb2x1bW4iKTsKICAgICAgICBfbmFtZXMucHV0KENv\nbFR5cGUuSU5WRVJTRSwgImludmVyc2Utam9pbi1jb2x1bW4iKTsKICAgICAg\nICBfbmFtZXMucHV0KENvbFR5cGUuUEtfSk9JTiwgInByaW1hcnkta2V5LWpv\naW4tY29sdW1uIik7CiAgICAgICAgX25hbWVzLnB1dChDb2xUeXBlLkRJU0Ms\nICJkaXNjcmltaW5hdG9yLWNvbHVtbiIpOwogICAgfQoKICAgIHByaXZhdGUg\nTGlzdDxRdWVyeVJlc3VsdE1hcHBpbmc+IF9yZXN1bHRzID0gbnVsbDsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfc3luYyA9IGZhbHNlOwoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3IuIFN1cHBseSBjb25maWd1cmF0aW9uLgogICAgICov\nCiAgICBwdWJsaWMgWE1MUGVyc2lzdGVuY2VNYXBwaW5nU2VyaWFsaXplcihK\nREJDQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgc3VwZXIoY29uZik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIGF1dG9tYXRpY2Fs\nbHkgc3luY2hyb25pemUgbWFwcGluZyBpbmZvIHdpdGggZGF0YSBhdmFpbGFi\nbGUKICAgICAqIGZyb20gbWFwcGVkIGNvbXBvbmVudHMgYmVmb3JlIHNlcmlh\nbGl6YXRpb24uIERlZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBnZXRTeW5jTWFwcGluZ0luZm8oKSB7CiAgICAgICAgcmV0\ndXJuIF9zeW5jOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBh\ndXRvbWF0aWNhbGx5IHN5bmNocm9uaXplIG1hcHBpbmcgaW5mbyB3aXRoIGRh\ndGEgYXZhaWxhYmxlCiAgICAgKiBmcm9tIG1hcHBlZCBjb21wb25lbnRzIGJl\nZm9yZSBzZXJpYWxpemF0aW9uLiBEZWZhdWx0cyB0byBmYWxzZS4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0U3luY01hcHBpbmdJbmZvKGJvb2xlYW4g\nc3luYykgewogICAgICAgIF9zeW5jID0gc3luYzsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFkZHMgdGhlIGdpdmVuIHJlc3VsdCBzZXQgbWFwcGluZyB0byBs\nb2NhbCBjYWNoZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgYWRkUXVlcnlS\nZXN1bHRNYXBwaW5nKFF1ZXJ5UmVzdWx0TWFwcGluZyBtZXRhKSB7CiAgICAg\nICAgaWYgKF9yZXN1bHRzID09IG51bGwpCiAgICAgICAgICAgIF9yZXN1bHRz\nID0gbmV3IEFycmF5TGlzdDxRdWVyeVJlc3VsdE1hcHBpbmc+KCk7CiAgICAg\nICAgX3Jlc3VsdHMuYWRkKG1ldGEpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmVtb3ZlcyBnaXZlbiByZXN1bHQgc2V0IG1hcHBpbmcgZnJvbSB0aGUgbG9j\nYWwgY2FjaGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZVF1\nZXJ5UmVzdWx0TWFwcGluZyhRdWVyeVJlc3VsdE1hcHBpbmcgbWV0YSkgewog\nICAgICAgIHJldHVybiBfcmVzdWx0cyAhPSBudWxsICYmIF9yZXN1bHRzLnJl\nbW92ZShtZXRhKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIGFkZEFsbChNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MpIHsKICAgICAg\nICBzdXBlci5hZGRBbGwocmVwb3MpOwogICAgICAgIGZvciAoUXVlcnlSZXN1\nbHRNYXBwaW5nIHJlcyA6ICgoTWFwcGluZ1JlcG9zaXRvcnkpIHJlcG9zKQog\nICAgICAgICAgICAuZ2V0UXVlcnlSZXN1bHRNYXBwaW5ncygpKQogICAgICAg\nICAgICBhZGRRdWVyeVJlc3VsdE1hcHBpbmcocmVzKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUFsbChNZXRhRGF0\nYVJlcG9zaXRvcnkgcmVwb3MpIHsKICAgICAgICBib29sZWFuIHJlbW92ZWQg\nPSBzdXBlci5yZW1vdmVBbGwocmVwb3MpOwogICAgICAgIGZvciAoUXVlcnlS\nZXN1bHRNYXBwaW5nIHJlcyA6ICgoTWFwcGluZ1JlcG9zaXRvcnkpIHJlcG9z\nKQogICAgICAgICAgICAuZ2V0UXVlcnlSZXN1bHRNYXBwaW5ncygpKQogICAg\nICAgICAgICByZW1vdmVkIHw9IHJlbW92ZVF1ZXJ5UmVzdWx0TWFwcGluZyhy\nZXMpOwogICAgICAgIHJldHVybiByZW1vdmVkOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgc3VwZXIu\nY2xlYXIoKTsKICAgICAgICBpZiAoX3Jlc3VsdHMgIT0gbnVsbCkKICAgICAg\nICAgICAgX3Jlc3VsdHMuY2xlYXIoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\ndm9pZCBhZGRDb21tbWVudHMoT2JqZWN0IG9iaikKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoaXNNYXBwaW5nTW9kZSgpICYm\nICFpc01ldGFEYXRhTW9kZSgpKSB7CiAgICAgICAgICAgIGlmIChvYmogaW5z\ndGFuY2VvZiBDbGFzc01hcHBpbmcpCiAgICAgICAgICAgICAgICBvYmogPSAo\nKENsYXNzTWFwcGluZykgb2JqKS5nZXRNYXBwaW5nSW5mbygpOwogICAgICAg\nICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBGaWVsZE1hcHBpbmcpCiAg\nICAgICAgICAgICAgICBvYmogPSAoKEZpZWxkTWFwcGluZykgb2JqKS5nZXRN\nYXBwaW5nSW5mbygpOwogICAgICAgIH0KICAgICAgICBzdXBlci5hZGRDb21t\nZW50cyhvYmopOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVk\nIHZvaWQgc2VyaWFsaXplQ2xhc3MoQ2xhc3NNZXRhRGF0YSBtZXRhLCBib29s\nZWFuIGFjY2VzcykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoX3N5bmMgJiYgaXNNYXBwaW5nTW9kZSgpICYmIG1ldGEgaW5z\ndGFuY2VvZiBDbGFzc01hcHBpbmcpIHsKICAgICAgICAgICAgLy8gc3luYyBp\nZiByZXNvbHZlZCBhbmQgbWFwcGVkCiAgICAgICAgICAgIENsYXNzTWFwcGlu\nZyBjbHMgPSAoQ2xhc3NNYXBwaW5nKSBtZXRhOwogICAgICAgICAgICBpZiAo\nKGNscy5nZXRSZXNvbHZlKCkgJiBNT0RFX01BUFBJTkcpICE9IDAgJiYgY2xz\nLmlzTWFwcGVkKCkpIHsKICAgICAgICAgICAgICAgIGNscy5zeW5jTWFwcGlu\nZ0luZm8oKTsKICAgICAgICAgICAgICAgIGNscy5nZXREaXNjcmltaW5hdG9y\nKCkuc3luY01hcHBpbmdJbmZvKCk7CiAgICAgICAgICAgICAgICBjbHMuZ2V0\nVmVyc2lvbigpLnN5bmNNYXBwaW5nSW5mbygpOwogICAgICAgICAgICAgICAg\nRmllbGRNYXBwaW5nW10gZmllbGRzOwogICAgICAgICAgICAgICAgaWYgKGNs\ncy5nZXRFbWJlZGRpbmdNZXRhRGF0YSgpID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgZmllbGRzID0gY2xzLmdldERlZmluZWRGaWVsZE1hcHBpbmdz\nKCk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAg\nZmllbGRzID0gY2xzLmdldEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICAgICAg\nICAgIGZvciAoRmllbGRNYXBwaW5nIGYgOiBmaWVsZHMpCiAgICAgICAgICAg\nICAgICAgICAgZi5zeW5jTWFwcGluZ0luZm8oKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBzdXBlci5zZXJpYWxpemVDbGFzcyhtZXRhLCBh\nY2Nlc3MpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZv\naWQgc2VyaWFsaXplQ2xhc3NNYXBwaW5nQ29udGVudChDbGFzc01ldGFEYXRh\nIG1hcHBpbmcpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgQ2xhc3NNYXBwaW5nIGNscyA9IChDbGFzc01hcHBpbmcpIG1hcHBpbmc7\nCiAgICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0gY2xzLmdldE1hcHBp\nbmdJbmZvKCk7CiAgICAgICAgc2VyaWFsaXplVGFibGUoaW5mby5nZXRUYWJs\nZU5hbWUoKSwgInRhYmxlIiwgU3RyaW5ncwogICAgICAgICAgICAuZ2V0Q2xh\nc3NOYW1lKG1hcHBpbmcuZ2V0RGVzY3JpYmVkVHlwZSgpKSwgbnVsbCk7CiAg\nICAgICAgZm9yIChTdHJpbmcgc2Vjb25kIDogaW5mby5nZXRTZWNvbmRhcnlU\nYWJsZU5hbWVzKCkpCiAgICAgICAgICAgIHNlcmlhbGl6ZVRhYmxlKHNlY29u\nZCwgInNlY29uZGFyeS10YWJsZSIsIG51bGwsIGluZm8pOwogICAgICAgIHNl\ncmlhbGl6ZUNvbHVtbnMoaW5mbywgQ29sVHlwZS5QS19KT0lOLCBudWxsKTsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHNlcmlh\nbGl6ZUluaGVyaXRhbmNlQ29udGVudChDbGFzc01ldGFEYXRhIG1hcHBpbmcp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xhc3NN\nYXBwaW5nIGNscyA9IChDbGFzc01hcHBpbmcpIG1hcHBpbmc7CiAgICAgICAg\nQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0gY2xzLmdldE1hcHBpbmdJbmZvKCk7\nCiAgICAgICAgRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvIGRpbmZvID0gY2xz\nLmdldERpc2NyaW1pbmF0b3IoKQogICAgICAgICAgICAuZ2V0TWFwcGluZ0lu\nZm8oKTsKICAgICAgICBTdHJpbmcgc3RyYXQgPSBpbmZvLmdldEhpZXJhcmNo\neVN0cmF0ZWd5KCk7CiAgICAgICAgaWYgKEZsYXRDbGFzc1N0cmF0ZWd5LkFM\nSUFTLmVxdWFscyhzdHJhdCkpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgi\nc3RyYXRlZ3kiLCAiU0lOR0xFX1RBQkxFIik7CiAgICAgICAgZWxzZSBpZiAo\nVmVydGljYWxDbGFzc1N0cmF0ZWd5LkFMSUFTLmVxdWFscyhzdHJhdCkpCiAg\nICAgICAgICAgIGFkZEF0dHJpYnV0ZSgic3RyYXRlZ3kiLCAiSk9JTkVEIik7\nCiAgICAgICAgZWxzZSBpZiAoRnVsbENsYXNzU3RyYXRlZ3kuQUxJQVMuZXF1\nYWxzKHN0cmF0KSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJzdHJhdGVn\neSIsICJUQUJMRV9QRVJfQ0xBU1MiKTsKICAgICAgICBpZiAoc3RyYXQgIT0g\nbnVsbCkgewogICAgICAgICAgICBzdGFydEVsZW1lbnQoImluaGVyaXRhbmNl\nIik7CiAgICAgICAgICAgIGVuZEVsZW1lbnQoImluaGVyaXRhbmNlIik7CiAg\nICAgICAgfQogICAgICAgIGlmIChkaW5mby5nZXRWYWx1ZSgpICE9IG51bGwp\nIHsKICAgICAgICAgICAgc3RhcnRFbGVtZW50KCJkaXNjcmltaW5hdG9yLXZh\nbHVlIik7CiAgICAgICAgICAgIGFkZFRleHQoZGluZm8uZ2V0VmFsdWUoKSk7\nCiAgICAgICAgICAgIGVuZEVsZW1lbnQoImRpc2NyaW1pbmF0b3ItdmFsdWUi\nKTsKICAgICAgICB9CiAgICAgICAgc2VyaWFsaXplQ29sdW1ucyhkaW5mbywg\nQ29sVHlwZS5ESVNDLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ncmlhbGl6ZSB0YWJsZSBvcHRpb25hbGx5IGxpc3RpbmcgcHJpbWFyeS1rZXkt\nam9pbnMgc3RvcmVkCiAgICAgKiBpbiB0aGUgZ2l2ZW4ge0BsaW5rIENsYXNz\nTWFwcGluZ0luZm99LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFs\naXplVGFibGUoU3RyaW5nIHRhYmxlLCBTdHJpbmcgZWxlbWVudE5hbWUsCiAg\nICAgICAgU3RyaW5nIGRlZmF1bHROYW1lLCBDbGFzc01hcHBpbmdJbmZvIHNl\nY29uZGFyeUluZm8pCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgTGlzdDxDb2x1bW4+IGNvbHMgPSBudWxsOwogICAgICAgIGlmIChz\nZWNvbmRhcnlJbmZvICE9IG51bGwpCiAgICAgICAgICAgIGNvbHMgPSAoTGlz\ndDxDb2x1bW4+KSBzZWNvbmRhcnlJbmZvLmdldFNlY29uZGFyeVRhYmxlSm9p\nbkNvbHVtbnMKICAgICAgICAgICAgICAgICh0YWJsZSk7CgogICAgICAgIGJv\nb2xlYW4gcHJpbnQgPSBjb2xzICE9IG51bGwgJiYgY29scy5zaXplKCkgPiAw\nOwogICAgICAgIGlmICh0YWJsZSAhPSBudWxsCiAgICAgICAgICAgICYmIChk\nZWZhdWx0TmFtZSA9PSBudWxsIHx8ICFkZWZhdWx0TmFtZS5lcXVhbHModGFi\nbGUpKSkgewogICAgICAgICAgICBwcmludCA9IHRydWU7CiAgICAgICAgICAg\nIGludCBpbmRleCA9IHRhYmxlLmluZGV4T2YoJy4nKTsKICAgICAgICAgICAg\naWYgKGluZGV4IDwgMCkKICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgi\nbmFtZSIsIHRhYmxlKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAg\nICAgICBhZGRBdHRyaWJ1dGUoInNjaGVtYSIsIHRhYmxlLnN1YnN0cmluZygw\nLCBpbmRleCkpOwogICAgICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1l\nIiwgdGFibGUuc3Vic3RyaW5nKGluZGV4ICsgMSkpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIGlmIChwcmludCkgewogICAgICAgICAgICBz\ndGFydEVsZW1lbnQoZWxlbWVudE5hbWUpOwogICAgICAgICAgICBpZiAoY29s\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBmb3IgKENvbHVtbiBjb2wg\nOiBjb2xzKQogICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZUNvbHVtbihj\nb2wsIENvbFR5cGUuUEtfSk9JTiwgbnVsbCwgZmFsc2UpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGVuZEVsZW1lbnQoZWxlbWVudE5hbWUpOwogICAg\nICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29s\nZWFuIHNlcmlhbGl6ZUF0dHJpYnV0ZU92ZXJyaWRlKEZpZWxkTWV0YURhdGEg\nZm1kLAogICAgICAgIEZpZWxkTWV0YURhdGEgb3JpZykgewogICAgICAgIGlm\nIChvcmlnID09IG51bGwgfHwgZm1kID09IG9yaWcpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKCiAgICAgICAgRmllbGRNYXBwaW5nIGZpZWxkID0gKEZp\nZWxkTWFwcGluZykgZm1kOwogICAgICAgIEZpZWxkTWFwcGluZyBmaWVsZDIg\nPSAoRmllbGRNYXBwaW5nKSBvcmlnOwogICAgICAgIGlmIChmaWVsZC5nZXRN\nYXBwaW5nSW5mbygpLmhhc1NjaGVtYUNvbXBvbmVudHMoKQogICAgICAgICAg\nICB8fCBmaWVsZDIuZ2V0TWFwcGluZ0luZm8oKS5oYXNTY2hlbWFDb21wb25l\nbnRzKCkpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBWYWx1\nZU1hcHBpbmdJbmZvIGluZm8gPSBmaWVsZC5nZXRWYWx1ZUluZm8oKTsKICAg\nICAgICBMaXN0PENvbHVtbj4gY29scyA9IChMaXN0PENvbHVtbj4pIGluZm8u\nZ2V0Q29sdW1ucygpOwogICAgICAgIGlmIChjb2xzID09IG51bGwgfHwgY29s\ncy5zaXplKCkgPT0gMCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIFZhbHVlTWFwcGluZ0luZm8gaW5mbzIgPSBmaWVsZDIuZ2V0VmFsdWVJ\nbmZvKCk7CiAgICAgICAgTGlzdDxDb2x1bW4+IGNvbHMyID0gKExpc3Q8Q29s\ndW1uPikgaW5mbzIuZ2V0Q29sdW1ucygpOwogICAgICAgIGlmIChjb2xzMiA9\nPSBudWxsIHx8IGNvbHMyLnNpemUoKSAhPSBjb2xzLnNpemUoKSkKICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKGNvbHMuc2l6ZSgpICE9\nIDEpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBDb2x1bW4g\nY29sOwogICAgICAgIENvbHVtbiBjb2wyOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29scy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBjb2wg\nPSBjb2xzLmdldChpKTsKICAgICAgICAgICAgY29sMiA9IGNvbHMyLmdldChp\nKTsKICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5lcXVhbHMoY29sLmdl\ndE5hbWUoKSwgY29sMi5nZXROYW1lKCkpKQogICAgICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgICAgIGlmICghU3RyaW5nVXRpbHMuZXF1YWxz\nKGNvbC5nZXRUeXBlTmFtZSgpLCBjb2wyLmdldFR5cGVOYW1lKCkpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmIChjb2wu\nZ2V0U2l6ZSgpICE9IGNvbDIuZ2V0U2l6ZSgpKQogICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmIChjb2wuZ2V0RGVjaW1hbERp\nZ2l0cygpICE9IGNvbDIuZ2V0RGVjaW1hbERpZ2l0cygpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmIChjb2wuZ2V0Rmxh\nZyhDb2x1bW4uRkxBR19VTklOU0VSVEFCTEUpCiAgICAgICAgICAgICAgICAh\nPSBjb2wyLmdldEZsYWcoQ29sdW1uLkZMQUdfVU5JTlNFUlRBQkxFKSkKICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICBpZiAoY29s\nLmdldEZsYWcoQ29sdW1uLkZMQUdfVU5VUERBVEFCTEUpCiAgICAgICAgICAg\nICAgICAhPSBjb2wyLmdldEZsYWcoQ29sdW1uLkZMQUdfVU5VUERBVEFCTEUp\nKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCB2b2lkIHNlcmlhbGl6ZUF0dHJpYnV0ZU92ZXJyaWRlTWFwcGlu\nZ0NvbnRlbnQoRmllbGRNZXRhRGF0YSBmbWQsCiAgICAgICAgRmllbGRNZXRh\nRGF0YSBvcmlnKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIEZpZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIGZtZDsKICAg\nICAgICBzZXJpYWxpemVDb2x1bW5zKGZtLmdldFZhbHVlSW5mbygpLCBDb2xU\neXBlLkNPTCwgZm0uZ2V0TWFwcGluZ0luZm8oKQogICAgICAgICAgICAuZ2V0\nVGFibGVOYW1lKCkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIFBlcnNpc3RlbmNlU3RyYXRlZ3kgZ2V0U3RyYXRlZ3koRmllbGRNZXRh\nRGF0YSBmbWQpIHsKICAgICAgICBQZXJzaXN0ZW5jZVN0cmF0ZWd5IHN0cmF0\nID0gc3VwZXIuZ2V0U3RyYXRlZ3koZm1kKTsKICAgICAgICBGaWVsZE1hcHBp\nbmcgZmllbGQgPSAoRmllbGRNYXBwaW5nKSBmbWQ7CiAgICAgICAgc3dpdGNo\nIChzdHJhdCkgewogICAgICAgICAgICBjYXNlIE1BTllfTUFOWToKICAgICAg\nICAgICAgICAgIC8vIHdlIGNhbiBkaWZmZXJlbnRpYXRlIGEgb25lLW1hbnkg\nYnkgdGhlIGZhY3QgdGhhdCB0aGVyZSBpcyBubwogICAgICAgICAgICAgICAg\nLy8gc2Vjb25kYXJ5IHRhYmxlIGpvaW4sIG9yIHRoZSBmayBpcyB1bmlxdWUK\nICAgICAgICAgICAgICAgIGlmIChmaWVsZC5nZXRNYXBwZWRCeSgpID09IG51\nbGwKICAgICAgICAgICAgICAgICAgICAmJiAoZmllbGQuZ2V0TWFwcGluZ0lu\nZm8oKS5nZXRKb2luRGlyZWN0aW9uKCkKICAgICAgICAgICAgICAgICAgICA9\nPSBNYXBwaW5nSW5mby5KT0lOX05PTkUKICAgICAgICAgICAgICAgICAgICB8\nfCBmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVlSW5mbygpLmdl\ndFVuaXF1ZSgpCiAgICAgICAgICAgICAgICAgICAgIT0gbnVsbCkpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlU3RyYXRlZ3kuT05F\nX01BTlk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBNQU5ZX09ORToKICAgICAgICAgICAgICAgIC8vIGludmVyc2Ugam9pbiBj\nb2xzIG9yIHVuaXF1ZSBmaz8KICAgICAgICAgICAgICAgIGlmIChmaWVsZC5n\nZXRWYWx1ZUluZm8oKS5nZXRKb2luRGlyZWN0aW9uKCkKICAgICAgICAgICAg\nICAgICAgICA9PSBNYXBwaW5nSW5mby5KT0lOX0lOVkVSU0UKICAgICAgICAg\nICAgICAgICAgICB8fCBmaWVsZC5nZXRWYWx1ZUluZm8oKS5nZXRVbmlxdWUo\nKSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0\nZW5jZVN0cmF0ZWd5Lk9ORV9PTkU7CgogICAgICAgICAgICAgICAgLy8gc2Nh\nbiBmb3IgcHJpbWFyeS1rZXktam9pbi1jb2x1bW4KICAgICAgICAgICAgICAg\nIExpc3Q8Q29sdW1uPiBjb2xzID0gZmllbGQuZ2V0VmFsdWVJbmZvKCkuZ2V0\nQ29sdW1ucygpOwogICAgICAgICAgICAgICAgYm9vbGVhbiBwa0pvaW4gPSBj\nb2xzICE9IG51bGwgJiYgY29scy5zaXplKCkgPiAwOwogICAgICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IHBrSm9pbiAmJiBpIDwgY29scy5zaXplKCk7\nIGkrKykKICAgICAgICAgICAgICAgICAgICBwa0pvaW4gPSBjb2xzLmdldChp\nKS5nZXRGbGFnKENvbHVtbi5GTEFHX1BLX0pPSU4pOwogICAgICAgICAgICAg\nICAgaWYgKHBrSm9pbikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVy\nc2lzdGVuY2VTdHJhdGVneS5PTkVfT05FOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdHJhdDsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHNlcmlhbGl6ZUZpZWxk\nTWFwcGluZ0NvbnRlbnQoRmllbGRNZXRhRGF0YSBmbWQsCiAgICAgICAgUGVy\nc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSkKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoZm1kLmdldE1hcHBlZEJ5KCkgIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyB3aGlsZSBJ\nJ2QgbGlrZSB0byBkbyBhdXRvIGRldGVjdGlvbiBiYXNlZCBvbiBqb2luIGRp\ncmVjdGlvbnMsIGV0Yy4KICAgICAgICAvLyB0aGUgZGlzdGluZ3Vpc2hlZCBj\nb2x1bW4gLyB0YWJsZSAvIGV0YyBuYW1lcyBmb3JjZXMgb3VyIGhhbmQKICAg\nICAgICAvLyBlc3AgZm9yIE9wZW5KUEEgY3VzdG9tIG1hcHBpbmdzLgogICAg\nICAgIEZpZWxkTWFwcGluZyBmaWVsZCA9IChGaWVsZE1hcHBpbmcpIGZtZDsK\nICAgICAgICBzd2l0Y2ggKHN0cmF0ZWd5KSB7CiAgICAgICAgICAgIGNhc2Ug\nT05FX09ORToKICAgICAgICAgICAgY2FzZSBNQU5ZX09ORToKICAgICAgICAg\nICAgICAgIHNlcmlhbGl6ZUNvbHVtbnMoZmllbGQuZ2V0VmFsdWVJbmZvKCks\nIENvbFR5cGUuSk9JTiwKICAgICAgICAgICAgICAgICAgICBmaWVsZC5nZXRN\nYXBwaW5nSW5mbygpLmdldFRhYmxlTmFtZSgpKTsKICAgICAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICAgICAgY2FzZSBPTkVfTUFOWToKICAgICAgICAg\nICAgICAgIGlmIChmaWVsZC5nZXRNYXBwaW5nSW5mbygpLmdldEpvaW5EaXJl\nY3Rpb24oKSA9PQogICAgICAgICAgICAgICAgICAgIE1hcHBpbmdJbmZvLkpP\nSU5fTk9ORSkgewogICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZUNvbHVt\nbnMoZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKSwK\nICAgICAgICAgICAgICAgICAgICAgICAgQ29sVHlwZS5KT0lOLCBudWxsKTsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAvLyBlbHNlIG5vIGJyZWFrCiAgICAgICAgICAg\nIGNhc2UgTUFOWV9NQU5ZOgogICAgICAgICAgICAgICAgaWYgKGZpZWxkLmdl\ndE1hcHBpbmdJbmZvKCkuaGFzU2NoZW1hQ29tcG9uZW50cygpCiAgICAgICAg\nICAgICAgICAgICAgfHwgZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKS5nZXRW\nYWx1ZUluZm8oKQogICAgICAgICAgICAgICAgICAgIC5oYXNTY2hlbWFDb21w\nb25lbnRzKCkpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgdGFibGUg\nPSBmaWVsZC5nZXRNYXBwaW5nSW5mbygpLmdldFRhYmxlTmFtZSgpOwogICAg\nICAgICAgICAgICAgICAgIGlmICh0YWJsZSAhPSBudWxsKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGludCBpbmRleCA9IHRhYmxlLmluZGV4T2YoJy4n\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgibmFtZSIs\nIHRhYmxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInNjaGVtYSIs\nIHRhYmxlLnN1YnN0cmluZygwLCBpbmRleCkpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1lIiwgdGFibGUuc3Vic3Ry\naW5nKGluZGV4ICsgMSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHN0YXJ0\nRWxlbWVudCgiam9pbi10YWJsZSIpOwogICAgICAgICAgICAgICAgICAgIHNl\ncmlhbGl6ZUNvbHVtbnMoZmllbGQuZ2V0TWFwcGluZ0luZm8oKSwgQ29sVHlw\nZS5KT0lOLAogICAgICAgICAgICAgICAgICAgICAgICBudWxsKTsKICAgICAg\nICAgICAgICAgICAgICBzZXJpYWxpemVDb2x1bW5zKGZpZWxkLmdldEVsZW1l\nbnRNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCksCiAgICAgICAgICAgICAgICAg\nICAgICAgIENvbFR5cGUuSU5WRVJTRSwgbnVsbCk7CiAgICAgICAgICAgICAg\nICAgICAgZW5kRWxlbWVudCgiam9pbi10YWJsZSIpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAg\nICAgc2VyaWFsaXplQ29sdW1ucyhmaWVsZC5nZXRWYWx1ZUluZm8oKSwgQ29s\nVHlwZS5DT0wsCiAgICAgICAgICAgIGZpZWxkLmdldE1hcHBpbmdJbmZvKCku\nZ2V0VGFibGVOYW1lKCkpOwogICAgICAgIGlmIChzdHJhdGVneSA9PSBQZXJz\naXN0ZW5jZVN0cmF0ZWd5LkJBU0lDICYmIGlzTG9iKGZpZWxkKSkgewogICAg\nICAgICAgICBzdGFydEVsZW1lbnQoImxvYiIpOwogICAgICAgICAgICBlbmRF\nbGVtZW50KCJsb2IiKTsKICAgICAgICB9CiAgICAgICAgVGVtcG9yYWxUeXBl\nIHRlbXBvcmFsID0gZ2V0VGVtcG9yYWwoZmllbGQpOwogICAgICAgIGlmICh0\nZW1wb3JhbCAhPSBudWxsKSB7CiAgICAgICAgICAgIHN0YXJ0RWxlbWVudCgi\ndGVtcG9yYWwiKTsKICAgICAgICAgICAgYWRkVGV4dCh0ZW1wb3JhbC50b1N0\ncmluZygpKTsKICAgICAgICAgICAgZW5kRWxlbWVudCgidGVtcG9yYWwiKTsK\nICAgICAgICB9CgogICAgICAgIEVudW1UeXBlIGVudW1UeXBlID0gZ2V0RW51\nbVR5cGUoZmllbGQpOwogICAgICAgIGlmIChlbnVtVHlwZSAhPSBudWxsICYm\nIGVudW1UeXBlICE9IEVudW1UeXBlLk9SRElOQUwpIHsKICAgICAgICAgICAg\nc3RhcnRFbGVtZW50KCJlbnVtZXJhdGVkIik7CiAgICAgICAgICAgIGFkZFRl\neHQoZW51bVR5cGUudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGVuZEVsZW1l\nbnQoImVudW1lcmF0ZWQiKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBEZXRlcm1pbmUgaWYgdGhlIGZpZWxkIGlzIGEgbG9iLgogICAgICov\nCiAgICBwcml2YXRlIGJvb2xlYW4gaXNMb2IoRmllbGRNYXBwaW5nIGZpZWxk\nKSB7CiAgICAgICAgZm9yIChDb2x1bW4gY29sIDogKExpc3Q8Q29sdW1uPikg\nZmllbGQuZ2V0VmFsdWVJbmZvKCkuZ2V0Q29sdW1ucygpKQogICAgICAgICAg\nICBpZiAoY29sLmdldFR5cGUoKSA9PSBUeXBlcy5CTE9CIHx8IGNvbC5nZXRU\neXBlKCkgPT0gVHlwZXMuQ0xPQikKICAgICAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBmaWVsZCdzIHRlbXBvcmFsIHR5cGUuCiAgICAgKi8KICAg\nIHByaXZhdGUgVGVtcG9yYWxUeXBlIGdldFRlbXBvcmFsKEZpZWxkTWFwcGlu\nZyBmaWVsZCkgewogICAgICAgIGlmIChmaWVsZC5nZXREZWNsYXJlZFR5cGVD\nb2RlKCkgIT0gSmF2YVR5cGVzLkRBVEUKICAgICAgICAgICAgJiYgZmllbGQu\nZ2V0RGVjbGFyZWRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5DQUxFTkRBUikK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIERCRGljdGlvbmFy\neSBkaWN0ID0gKChKREJDQ29uZmlndXJhdGlvbikgZ2V0Q29uZmlndXJhdGlv\nbigpKQogICAgICAgICAgICAuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsK\nICAgICAgICBpbnQgZGVmID0gZGljdC5nZXRKREJDVHlwZShmaWVsZC5nZXRU\neXBlQ29kZSgpLCBmYWxzZSk7CiAgICAgICAgZm9yIChDb2x1bW4gY29sIDog\nKExpc3Q8Q29sdW1uPikgZmllbGQuZ2V0VmFsdWVJbmZvKCkuZ2V0Q29sdW1u\ncygpKSB7CiAgICAgICAgICAgIGlmIChjb2wuZ2V0VHlwZSgpID09IGRlZikK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBzd2l0Y2gg\nKGNvbC5nZXRUeXBlKCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgVHlwZXMu\nREFURToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGVtcG9yYWxUeXBl\nLkRBVEU7CiAgICAgICAgICAgICAgICBjYXNlIFR5cGVzLlRJTUU6CiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIFRlbXBvcmFsVHlwZS5USU1FOwogICAg\nICAgICAgICAgICAgY2FzZSBUeXBlcy5USU1FU1RBTVA6CiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIFRlbXBvcmFsVHlwZS5USU1FU1RBTVA7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gZW51bSB0eXBlIGZvciB0aGUgZmll\nbGQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBFbnVtVHlwZSBnZXRFbnVtVHlw\nZShGaWVsZE1hcHBpbmcgZmllbGQpIHsKICAgICAgICBpZiAoZmllbGQuZ2V0\nRGVjbGFyZWRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5PQkpFQ1QpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmICghKGZpZWxkLmdldEhh\nbmRsZXIoKSBpbnN0YW5jZW9mIEVudW1WYWx1ZUhhbmRsZXIpKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gKChFbnVtVmFsdWVI\nYW5kbGVyKSBmaWVsZC5nZXRIYW5kbGVyKCkpLmdldFN0b3JlT3JkaW5hbCgp\nCiAgICAgICAgICAgID8gRW51bVR5cGUuT1JESU5BTCA6IEVudW1UeXBlLlNU\nUklORzsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZSB0aGUgY29s\ndW1ucyBpbiB0aGUgZ2l2ZW4gbWFwcGluZyBpbmZvLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgc2VyaWFsaXplQ29sdW1ucyhNYXBwaW5nSW5mbyBpbmZv\nLCBDb2xUeXBlIHR5cGUsCiAgICAgICAgU3RyaW5nIHNlY29uZGFyeSkKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBMaXN0PENvbHVt\nbj4gY29scyA9IChMaXN0PENvbHVtbj4pIGluZm8uZ2V0Q29sdW1ucygpOwog\nICAgICAgIGlmIChjb2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICBmb3IgKENvbHVtbiBjb2wgOiBjb2xzKQogICAgICAgICAgICBz\nZXJpYWxpemVDb2x1bW4oY29sLCB0eXBlLCBzZWNvbmRhcnksIGluZm8uZ2V0\nVW5pcXVlKCkgIT0gbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXJp\nYWxpemUgYSBzaW5nbGUgY29sdW1uLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgc2VyaWFsaXplQ29sdW1uKENvbHVtbiBjb2wsIENvbFR5cGUgdHlwZSwg\nU3RyaW5nIHNlY29uZGFyeSwKICAgICAgICBib29sZWFuIHVuaXF1ZSkKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY29sLmdl\ndE5hbWUoKSAhPSBudWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoIm5h\nbWUiLCBjb2wuZ2V0TmFtZSgpKTsKICAgICAgICBpZiAoY29sLmdldFR5cGVO\nYW1lKCkgIT0gbnVsbCkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJjb2x1\nbW4tZGVmaW5pdGlvbiIsIGNvbC5nZXRUeXBlTmFtZSgpKTsKICAgICAgICBp\nZiAoY29sLmdldFRhcmdldCgpICE9IG51bGwKICAgICAgICAgICAgJiYgKHR5\ncGUgPT0gQ29sVHlwZS5KT0lOIHx8IHR5cGUgPT0gQ29sVHlwZS5JTlZFUlNF\nCiAgICAgICAgICAgIHx8IHR5cGUgPT0gQ29sVHlwZS5QS19KT0lOKSkKICAg\nICAgICAgICAgYWRkQXR0cmlidXRlKCJyZWZlcmVuY2VkLWNvbHVtbi1uYW1l\nIiwgY29sLmdldFRhcmdldCgpKTsKICAgICAgICBpZiAodHlwZSA9PSBDb2xU\neXBlLkNPTCB8fCB0eXBlID09IENvbFR5cGUuSk9JTgogICAgICAgICAgICB8\nfCB0eXBlID09IENvbFR5cGUuUEtfSk9JTikgewogICAgICAgICAgICBpZiAo\ndW5pcXVlKQogICAgICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJ1bmlxdWUi\nLCAidHJ1ZSIpOwogICAgICAgICAgICBpZiAoY29sLmlzTm90TnVsbCgpKQog\nICAgICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJudWxsYWJsZSIsICJmYWxz\nZSIpOwogICAgICAgICAgICBpZiAoY29sLmdldEZsYWcoQ29sdW1uLkZMQUdf\nVU5JTlNFUlRBQkxFKSkKICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgi\naW5zZXJ0YWJsZSIsICJmYWxzZSIpOwogICAgICAgICAgICBpZiAoY29sLmdl\ndEZsYWcoQ29sdW1uLkZMQUdfVU5VUERBVEFCTEUpKQogICAgICAgICAgICAg\nICAgYWRkQXR0cmlidXRlKCJ1cGRhdGFibGUiLCAiZmFsc2UiKTsKICAgICAg\nICAgICAgaWYgKHNlY29uZGFyeSAhPSBudWxsKQogICAgICAgICAgICAgICAg\nYWRkQXR0cmlidXRlKCJ0YWJsZSIsIHNlY29uZGFyeSk7CgogICAgICAgICAg\nICBpZiAodHlwZSA9PSBDb2xUeXBlLkNPTCkgewogICAgICAgICAgICAgICAg\naWYgKGNvbC5nZXRTaXplKCkgPiAwICYmIGNvbC5nZXRTaXplKCkgIT0gMjU1\nKQogICAgICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgibGVuZ3RoIiwg\nY29sLmdldFNpemUoKSArICIiKTsKICAgICAgICAgICAgICAgIGlmIChjb2wu\nZ2V0RGVjaW1hbERpZ2l0cygpICE9IDApCiAgICAgICAgICAgICAgICAgICAg\nYWRkQXR0cmlidXRlKCJzY2FsZSIsIGNvbC5nZXREZWNpbWFsRGlnaXRzKCkg\nKyAiIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHR5\ncGUgIT0gQ29sVHlwZS5DT0wgfHwgZ2V0QXR0cmlidXRlcygpLmdldExlbmd0\naCgpID4gMCkgewogICAgICAgICAgICBTdHJpbmcgbmFtZSA9IGNvbC5nZXRG\nbGFnKENvbHVtbi5GTEFHX1BLX0pPSU4pID8gX25hbWVzCiAgICAgICAgICAg\nICAgICAuZ2V0KENvbFR5cGUuUEtfSk9JTikgOiBfbmFtZXMuZ2V0KHR5cGUp\nOwogICAgICAgICAgICBzdGFydEVsZW1lbnQobmFtZSk7CiAgICAgICAgICAg\nIGVuZEVsZW1lbnQobmFtZSk7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHJvdGVjdGVkIFNlcmlhbGl6YXRpb25Db21wYXJhdG9yIG5l\nd1NlcmlhbGl6YXRpb25Db21wYXJhdG9yKCkgewogICAgICAgIHJldHVybiBu\nZXcgTWFwcGluZ1NlcmlhbGl6YXRpb25Db21wYXJhdG9yKCk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRTeXN0ZW1NYXBw\naW5nRWxlbWVudHMoQ29sbGVjdGlvbiB0b1NlcmlhbGl6ZSkgewogICAgICAg\nIGlmIChpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAgICB0b1NlcmlhbGl6ZS5h\nZGRBbGwoZ2V0UXVlcnlSZXN1bHRNYXBwaW5ncyhudWxsKSk7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgaW50IHR5cGUoT2JqZWN0IG8p\nIHsKICAgICAgICBpbnQgdHlwZSA9IHN1cGVyLnR5cGUobyk7CiAgICAgICAg\naWYgKHR5cGUgPT0gLTEgJiYgbyBpbnN0YW5jZW9mIFF1ZXJ5UmVzdWx0TWFw\ncGluZykKICAgICAgICAgICAgcmV0dXJuIFRZUEVfUkVTVUxUTUFQOwogICAg\nICAgIHJldHVybiB0eXBlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSByZXN1bHQgc2V0IG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gc2NvcGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgTGlzdDxRdWVyeVJlc3VsdE1hcHBpbmc+\nIGdldFF1ZXJ5UmVzdWx0TWFwcGluZ3MoQ2xhc3NNZXRhRGF0YSBjbSkgewog\nICAgICAgIGlmIChfcmVzdWx0cyA9PSBudWxsIHx8IF9yZXN1bHRzLmlzRW1w\ndHkoKSkKICAgICAgICAgICAgcmV0dXJuIChMaXN0PFF1ZXJ5UmVzdWx0TWFw\ncGluZz4pIENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7CgogICAgICAgIExpc3Q8\nUXVlcnlSZXN1bHRNYXBwaW5nPiByZXN1bHQgPSBudWxsOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX3Jlc3VsdHMuc2l6ZSgpOyBpKyspIHsKICAg\nICAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nIGVsZW1lbnQgPSBfcmVzdWx0\ncy5nZXQoaSk7CiAgICAgICAgICAgIGlmICgoY20gPT0gbnVsbCAmJiBlbGVt\nZW50LmdldFNvdXJjZVNjb3BlKCkgIT0gbnVsbCkgfHwgKGNtICE9IG51bGwK\nICAgICAgICAgICAgICAgICYmIGVsZW1lbnQuZ2V0U291cmNlU2NvcGUoKSAh\nPSBjbS5nZXREZXNjcmliZWRUeXBlKCkpKQogICAgICAgICAgICAgICAgY29u\ndGludWU7CgogICAgICAgICAgICBpZiAocmVzdWx0ID09IG51bGwpCiAgICAg\nICAgICAgICAgICByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PFF1ZXJ5UmVzdWx0\nTWFwcGluZz4oX3Jlc3VsdHMuc2l6ZSgpIC0gaSk7CiAgICAgICAgICAgIHJl\nc3VsdC5hZGQoZWxlbWVudCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAo\ncmVzdWx0ID09IG51bGwpCiAgICAgICAgICAgID8gKExpc3Q8UXVlcnlSZXN1\nbHRNYXBwaW5nPikgQ29sbGVjdGlvbnMuRU1QVFlfTElTVCA6IHJlc3VsdDsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHNlcmlh\nbGl6ZVN5c3RlbU1hcHBpbmdFbGVtZW50KE9iamVjdCBvYmopCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKG9iaiBpbnN0YW5j\nZW9mIFF1ZXJ5UmVzdWx0TWFwcGluZykKICAgICAgICAgICAgc2VyaWFsaXpl\nUXVlcnlSZXN1bHRNYXBwaW5nKChRdWVyeVJlc3VsdE1hcHBpbmcpIG9iaik7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXJp\nYWxpemVRdWVyeU1hcHBpbmdzKENsYXNzTWV0YURhdGEgbWV0YSkKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmb3IgKFF1ZXJ5UmVz\ndWx0TWFwcGluZyByZXMgOiBnZXRRdWVyeVJlc3VsdE1hcHBpbmdzKG1ldGEp\nKQogICAgICAgICAgICBzZXJpYWxpemVRdWVyeVJlc3VsdE1hcHBpbmcocmVz\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZSBnaXZlbiByZXN1\nbHQgc2V0IG1hcHBpbmcuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXJp\nYWxpemVRdWVyeVJlc3VsdE1hcHBpbmcoUXVlcnlSZXN1bHRNYXBwaW5nIG1l\ndGEpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKCFnZXRTZXJpYWxpemVBbm5vdGF0aW9ucygpCiAgICAgICAgICAgICYmIG1l\ndGEuZ2V0U291cmNlVHlwZSgpID09IG1ldGEuU1JDX0FOTk9UQVRJT05TKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIGFkZEF0dHJpYnV0ZSgibmFt\nZSIsIG1ldGEuZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVsZW1lbnQoInNx\nbC1yZXN1bHQtc2V0LW1hcHBpbmciKTsKICAgICAgICBmb3IgKFF1ZXJ5UmVz\ndWx0TWFwcGluZy5QQ1Jlc3VsdCBwYyA6IG1ldGEuZ2V0UENSZXN1bHRzKCkp\nIHsKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJlbnRpdHktY2xhc3MiLCBw\nYy5nZXRDYW5kaWRhdGVUeXBlKCkuZ2V0TmFtZSgpKTsKICAgICAgICAgICAg\nT2JqZWN0IGRpc2NyaW0gPSBwYy5nZXRNYXBwaW5nKHBjLkRJU0NSSU1JTkFU\nT1IpOwogICAgICAgICAgICBpZiAoZGlzY3JpbSAhPSBudWxsKQogICAgICAg\nICAgICAgICAgYWRkQXR0cmlidXRlKCJkaXNjcmltaW5hdG9yLWNvbHVtbiIs\nIGRpc2NyaW0udG9TdHJpbmcoKSk7CgogICAgICAgICAgICBzdGFydEVsZW1l\nbnQoImVudGl0eS1yZXN1bHQiKTsKICAgICAgICAgICAgZm9yIChTdHJpbmcg\ncGF0aCA6IHBjLmdldE1hcHBpbmdQYXRocygpKSB7CiAgICAgICAgICAgICAg\nICBhZGRBdHRyaWJ1dGUoIm5hbWUiLCBwYXRoKTsKICAgICAgICAgICAgICAg\nIGFkZEF0dHJpYnV0ZSgiY29sdW1uIiwgcGMuZ2V0TWFwcGluZyhwYXRoKS50\nb1N0cmluZygpKTsKICAgICAgICAgICAgICAgIHN0YXJ0RWxlbWVudCgiZmll\nbGQtcmVzdWx0Iik7CiAgICAgICAgICAgICAgICBlbmRFbGVtZW50KCJmaWVs\nZC1yZXN1bHQiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbmRFbGVt\nZW50KCJlbnRpdHktcmVzdWx0Iik7CiAgICAgICAgfQogICAgICAgIGZvciAo\nT2JqZWN0IGNvbCA6IG1ldGEuZ2V0Q29sdW1uUmVzdWx0cygpKSB7CiAgICAg\nICAgICAgIGFkZEF0dHJpYnV0ZSgibmFtZSIsIGNvbC50b1N0cmluZygpKTsK\nICAgICAgICAgICAgc3RhcnRFbGVtZW50KCJjb2x1bW4tcmVzdWx0Iik7CiAg\nICAgICAgICAgIGVuZEVsZW1lbnQoImNvbHVtbi1yZXN1bHQiKTsKICAgICAg\nICB9CiAgICAgICAgZW5kRWxlbWVudCgic3FsLXJlc3VsdC1zZXQtbWFwcGlu\nZyIpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQg\nc2VyaWFsaXplU2VxdWVuY2UoU2VxdWVuY2VNZXRhRGF0YSBtZXRhKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghZ2V0U2Vy\naWFsaXplQW5ub3RhdGlvbnMoKQogICAgICAgICAgICAmJiBtZXRhLmdldFNv\ndXJjZVR5cGUoKSA9PSBtZXRhLlNSQ19BTk5PVEFUSU9OUykKICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgIGlmIChTZXF1ZW5jZU1hcHBpbmcuSU1QTF9W\nQUxVRV9UQUJMRS5lcXVhbHMobWV0YS5nZXRTZXF1ZW5jZVBsdWdpbigpKSkg\newogICAgICAgICAgICBzdXBlci5zZXJpYWxpemVTZXF1ZW5jZShtZXRhKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgU2VxdWVu\nY2VNYXBwaW5nIHNlcSA9IChTZXF1ZW5jZU1hcHBpbmcpIG1ldGE7CiAgICAg\nICAgYWRkQXR0cmlidXRlKCJuYW1lIiwgc2VxLmdldE5hbWUoKSk7CiAgICAg\nICAgU3RyaW5nIHRhYmxlID0gc2VxLmdldFRhYmxlKCk7CiAgICAgICAgaWYg\nKHRhYmxlICE9IG51bGwpIHsKICAgICAgICAgICAgaW50IGRvdElkeCA9IHRh\nYmxlLmluZGV4T2YoJy4nKTsKICAgICAgICAgICAgaWYgKGRvdElkeCA9PSAt\nMSkKICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgidGFibGUiLCB0YWJs\nZSk7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgYWRkQXR0\ncmlidXRlKCJ0YWJsZSIsIHRhYmxlLnN1YnN0cmluZyhkb3RJZHggKyAxKSk7\nCiAgICAgICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInNjaGVtYSIsIHRhYmxl\nLnN1YnN0cmluZygwLCBkb3RJZHgpKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoc2VxLmdldFBy\naW1hcnlLZXlDb2x1bW4oKSkpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgi\ncGstY29sdW1uLW5hbWUiLCBzZXEuZ2V0UHJpbWFyeUtleUNvbHVtbigpKTsK\nICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoc2VxLmdldFNlcXVl\nbmNlQ29sdW1uKCkpKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInZhbHVl\nLWNvbHVtbi1uYW1lIiwgc2VxLmdldFNlcXVlbmNlQ29sdW1uKCkpOwogICAg\nICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShzZXEuZ2V0UHJpbWFyeUtl\neVZhbHVlKCkpKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInBrLWNvbHVt\nbi12YWx1ZSIsIHNlcS5nZXRQcmltYXJ5S2V5VmFsdWUoKSk7CiAgICAgICAg\naWYgKHNlcS5nZXRBbGxvY2F0ZSgpICE9IDUwICYmIHNlcS5nZXRBbGxvY2F0\nZSgpICE9IC0xKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImFsbG9jYXRp\nb24tc2l6ZSIsIHNlcS5nZXRBbGxvY2F0ZSgpICsgIiIpOwogICAgICAgIGlm\nIChzZXEuZ2V0SW5pdGlhbFZhbHVlKCkgIT0gMCAmJiBzZXEuZ2V0SW5pdGlh\nbFZhbHVlKCkgIT0gLTEpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiaW5p\ndGlhbC12YWx1ZSIsIHNlcS5nZXRJbml0aWFsVmFsdWUoKSArICIiKTsKICAg\nICAgICBzdGFydEVsZW1lbnQoInRhYmxlLWdlbmVyYXRvciIpOwogICAgICAg\nIGVuZEVsZW1lbnQoInRhYmxlLWdlbmVyYXRvciIpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29sdW1uIHR5cGVzIHNlcmlhbGl6ZWQgdW5kZXIgZGlmZmVy\nZW50IG5hbWVzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBlbnVtIENv\nbFR5cGUgewoKICAgICAgICBDT0wsCiAgICAgICAgSk9JTiwKICAgICAgICBJ\nTlZFUlNFLAogICAgICAgIFBLX0pPSU4sCiAgICAgICAgRElTQwogICAgfQoK\nICAgIC8qKgogICAgICogRXh0ZW5kcyB7QGxpbmsgU2VyaWFsaXphdGlvbkNv\nbXBhcmF0b3J9IGZvciBzdG9yZS1zcGVjaWZpYyB0YWdzIHN1Y2gKICAgICAq\nIGFzICZsdDtzcWwtcmVzdWx0LXNldC1tYXBwaW5nJmd0Oy4KICAgICAqCiAg\nICAgKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICAgICAqLwogICAgcHJvdGVj\ndGVkIGNsYXNzIE1hcHBpbmdTZXJpYWxpemF0aW9uQ29tcGFyYXRvcgogICAg\nICAgIGV4dGVuZHMgU2VyaWFsaXphdGlvbkNvbXBhcmF0b3IgewoKICAgICAg\nICBwcm90ZWN0ZWQgaW50IGNvbXBhcmVVbmtub3duKE9iamVjdCBvMSwgT2Jq\nZWN0IG8yKSB7CiAgICAgICAgICAgIGlmICghKG8xIGluc3RhbmNlb2YgUXVl\ncnlSZXN1bHRNYXBwaW5nKSkKICAgICAgICAgICAgICAgIHJldHVybiBzdXBl\nci5jb21wYXJlVW5rbm93bihvMSwgbzIpOwoKICAgICAgICAgICAgUXVlcnlS\nZXN1bHRNYXBwaW5nIHJlczEgPSAoUXVlcnlSZXN1bHRNYXBwaW5nKSBvMTsK\nICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nIHJlczIgPSAoUXVlcnlS\nZXN1bHRNYXBwaW5nKSBvMjsKCiAgICAgICAgICAgIC8vIHN5c3RlbSBzY29w\nZSBiZWZvcmUgY2xhc3Mgc2NvcGUKICAgICAgICAgICAgT2JqZWN0IHNjb3Bl\nMSA9IHJlczEuZ2V0U291cmNlU2NvcGUoKTsKICAgICAgICAgICAgT2JqZWN0\nIHNjb3BlMiA9IHJlczIuZ2V0U291cmNlU2NvcGUoKTsKICAgICAgICAgICAg\naWYgKHNjb3BlMSA9PSBudWxsICYmIHNjb3BlMiAhPSBudWxsKQogICAgICAg\nICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICBpZiAoc2NvcGUxICE9\nIG51bGwgJiYgc2NvcGUyID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1\ncm4gMTsKCiAgICAgICAgICAgIC8vIGNvbXBhcmUgb24gbGlzdGluZyBpbmRl\neCwgb3IgaWYgbm9uZS9zYW1lLCB1c2UgbmFtZQogICAgICAgICAgICBpbnQg\nbGlzdGluZ0luZGV4MSA9IHJlczEuZ2V0TGlzdGluZ0luZGV4KCk7CiAgICAg\nICAgICAgIGludCBsaXN0aW5nSW5kZXgyID0gcmVzMi5nZXRMaXN0aW5nSW5k\nZXgoKTsKICAgICAgICAgICAgaWYgKGxpc3RpbmdJbmRleDEgIT0gbGlzdGlu\nZ0luZGV4MikKICAgICAgICAgICAgICAgIHJldHVybiBsaXN0aW5nSW5kZXgx\nIC0gbGlzdGluZ0luZGV4MjsKICAgICAgICAgICAgcmV0dXJuIHJlczEuZ2V0\nTmFtZSAoKS5jb21wYXJlVG8gKHJlczIuZ2V0TmFtZSAoKSk7CgkJfQoJfQp9\nCg==\n","encoding":"base64"}

