{"sha":"129488f367241e73a1589d854d4bbca5d79dc0d5","node_id":"MDQ6QmxvYjIwNjM2NDoxMjk0ODhmMzY3MjQxZTczYTE1ODlkODU0ZDRiYmNhNWQ3OWRjMGQ1","size":14753,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/129488f367241e73a1589d854d4bbca5d79dc0d5","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5yZWxhdGlvbnM7CgppbXBvcnQgamF2YS51\ndGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLlF1ZXJ5OwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0Q2FzZTsK\naW1wb3J0IGp1bml0LnRleHR1aS5UZXN0UnVubmVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nOwoKLyoqCiAqIFBlcmZvcm0gYmFzaWMgb3BlcmF0aW9ucyBvbiBhbiBlbnRp\ndHkgd2l0aCBhIG1hbnktb25lIHJlbGF0aW9uIGFzIGl0cyBpZAogKiBmaWVs\nZC4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBU\nZXN0TWFueU9uZUFzSWQKICAgIGV4dGVuZHMgVGVzdENhc2UgewoKICAgIHBy\naXZhdGUgRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mOwogICAgcHJpdmF0ZSBs\nb25nIGlkOwogICAgcHJpdmF0ZSBsb25nIGRzaWQ7CiAgICBwcml2YXRlIGxv\nbmcgY2lkOwoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIE1h\ncCBwcm9wcyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgcHJvcHMucHV0KCJv\ncGVuanBhLk1ldGFEYXRhRmFjdG9yeSIsICJqcGEoVHlwZXM9IiAKICAgICAg\nICAgICAgKyBCYXNpY0VudGl0eS5jbGFzcy5nZXROYW1lKCkgKyAiOyIKICAg\nICAgICAgICAgKyBEYXRhU3RvcmVCYXNpY0VudGl0eS5jbGFzcy5nZXROYW1l\nKCkgKyAiOyIKICAgICAgICAgICAgKyBNYW55T25lSWRPd25lci5jbGFzcy5n\nZXROYW1lKCkgKyAiOyIKICAgICAgICAgICAgKyBEYXRhU3RvcmVNYW55T25l\nSWRPd25lci5jbGFzcy5nZXROYW1lKCkgKyAiOyIKICAgICAgICAgICAgKyBN\nYW55T25lQ29tcG91bmRJZE93bmVyLmNsYXNzLmdldE5hbWUoKSArICIpIik7\nCiAgICAgICAgZW1mID0gUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdl\nckZhY3RvcnkoInRlc3QiLCBwcm9wcyk7CgogICAgICAgIEJhc2ljRW50aXR5\nIGlkMSA9IG5ldyBCYXNpY0VudGl0eSgpOwogICAgICAgIGlkMS5zZXROYW1l\nKCJpZDEiKTsKICAgICAgICBCYXNpY0VudGl0eSBpZDIgPSBuZXcgQmFzaWNF\nbnRpdHkoKTsKICAgICAgICBpZDIuc2V0TmFtZSgiaWQyIik7CiAgICAgICAg\naWQxLnNldFJlbChpZDIpOwogICAgICAgIGlkMi5zZXRSZWwoaWQxKTsKICAg\nICAgICBEYXRhU3RvcmVCYXNpY0VudGl0eSBkc2lkMSA9IG5ldyBEYXRhU3Rv\ncmVCYXNpY0VudGl0eSgpOwogICAgICAgIGRzaWQxLnNldE5hbWUoImRzaWQx\nIik7CiAgICAgICAgZHNpZDEuc2V0UmVsKGlkMSk7CiAgICAgICAgRGF0YVN0\nb3JlQmFzaWNFbnRpdHkgZHNpZDIgPSBuZXcgRGF0YVN0b3JlQmFzaWNFbnRp\ndHkoKTsKICAgICAgICBkc2lkMi5zZXROYW1lKCJkc2lkMiIpOwogICAgICAg\nIGRzaWQyLnNldFJlbChpZDIpOwoKICAgICAgICBNYW55T25lSWRPd25lciBw\nYXJlbnQgPSBuZXcgTWFueU9uZUlkT3duZXIoKTsKICAgICAgICBwYXJlbnQu\nc2V0SWQoaWQxKTsKICAgICAgICBwYXJlbnQuc2V0TmFtZSgicGFyZW50Iik7\nCiAgICAgICAgTWFueU9uZUlkT3duZXIgY2hpbGQgPSBuZXcgTWFueU9uZUlk\nT3duZXIoKTsKICAgICAgICBjaGlsZC5zZXRJZChpZDIpOwogICAgICAgIGNo\naWxkLnNldE5hbWUoImNoaWxkIik7CiAgICAgICAgcGFyZW50LnNldFNlbGZS\nZWwoY2hpbGQpOwogICAgICAgIERhdGFTdG9yZU1hbnlPbmVJZE93bmVyIGRz\ncGFyZW50ID0gbmV3IERhdGFTdG9yZU1hbnlPbmVJZE93bmVyKCk7CiAgICAg\nICAgZHNwYXJlbnQuc2V0SWQoZHNpZDEpOwogICAgICAgIGRzcGFyZW50LnNl\ndE5hbWUoImRzcGFyZW50Iik7CiAgICAgICAgRGF0YVN0b3JlTWFueU9uZUlk\nT3duZXIgZHNjaGlsZCA9IG5ldyBEYXRhU3RvcmVNYW55T25lSWRPd25lcigp\nOwogICAgICAgIGRzY2hpbGQuc2V0SWQoZHNpZDIpOwogICAgICAgIGRzY2hp\nbGQuc2V0TmFtZSgiZHNjaGlsZCIpOwogICAgICAgIGRzcGFyZW50LnNldFNl\nbGZSZWwoZHNjaGlsZCk7CiAgICAgICAgTWFueU9uZUNvbXBvdW5kSWRPd25l\nciBjcGFyZW50ID0gbmV3IE1hbnlPbmVDb21wb3VuZElkT3duZXIoKTsKICAg\nICAgICBjcGFyZW50LnNldEVudGl0eUlkKGlkMSk7CiAgICAgICAgY3BhcmVu\ndC5zZXROYW1lKCJjcGFyZW50Iik7CiAgICAgICAgTWFueU9uZUNvbXBvdW5k\nSWRPd25lciBjY2hpbGQgPSBuZXcgTWFueU9uZUNvbXBvdW5kSWRPd25lcigp\nOwogICAgICAgIGNjaGlsZC5zZXRFbnRpdHlJZChpZDIpOwogICAgICAgIGNj\naGlsZC5zZXROYW1lKCJjY2hpbGQiKTsKICAgICAgICBjcGFyZW50LnNldFNl\nbGZSZWwoY2NoaWxkKTsKCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGVtLnBlcnNpc3QoaWQxKTsKICAg\nICAgICBlbS5wZXJzaXN0KGlkMik7CiAgICAgICAgZW0ucGVyc2lzdChkc2lk\nMSk7CiAgICAgICAgZW0ucGVyc2lzdChkc2lkMik7CiAgICAgICAgZW0ucGVy\nc2lzdChwYXJlbnQpOwogICAgICAgIGVtLnBlcnNpc3QoY2hpbGQpOwogICAg\nICAgIGVtLnBlcnNpc3QoZHNwYXJlbnQpOwogICAgICAgIGVtLnBlcnNpc3Qo\nZHNjaGlsZCk7CiAgICAgICAgZW0ucGVyc2lzdChjcGFyZW50KTsKICAgICAg\nICBlbS5wZXJzaXN0KGNjaGlsZCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5jb21taXQoKTsKICAgICAgICBpZCA9IGlkMS5nZXRJZCgpOwogICAg\nICAgIGFzc2VydFJlbGF0aW9ucyhlbSwgcGFyZW50KTsKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBvZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIp\nIGVtOwogICAgICAgIGRzaWQgPSAoTG9uZykgb2VtLmdldE9iamVjdElkKGRz\naWQxKTsKICAgICAgICBhc3NlcnREYXRhU3RvcmVSZWxhdGlvbnMob2VtLCBk\nc3BhcmVudCk7CiAgICAgICAgY2lkID0gY3BhcmVudC5nZXRMb25nSWQoKTsK\nICAgICAgICBhc3NlcnRDb21wb3VuZFJlbGF0aW9ucyhvZW0sIGNwYXJlbnQp\nOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVhckRvd24oKSB7CiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgRW50aXR5\nTWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICAg\nICAgZW0uY3JlYXRlUXVlcnkoImRlbGV0ZSBmcm9tIE1hbnlPbmVJZE93bmVy\nIikuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICBlbS5jcmVhdGVRdWVy\neSgiZGVsZXRlIGZyb20gRGF0YVN0b3JlTWFueU9uZUlkT3duZXIiKS4KICAg\nICAgICAgICAgICAgIGV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAgZW0u\nY3JlYXRlUXVlcnkoImRlbGV0ZSBmcm9tIE1hbnlPbmVDb21wb3VuZElkT3du\nZXIiKS4KICAgICAgICAgICAgICAgIGV4ZWN1dGVVcGRhdGUoKTsKICAgICAg\nICAgICAgZW0uY3JlYXRlUXVlcnkoImRlbGV0ZSBmcm9tIEJhc2ljRW50aXR5\nIikuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICBlbS5jcmVhdGVRdWVy\neSgiZGVsZXRlIGZyb20gRGF0YVN0b3JlQmFzaWNFbnRpdHkiKS5leGVjdXRl\nVXBkYXRlKCk7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29t\nbWl0KCk7CiAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAgIGVt\nZi5jbG9zZSgpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhc3NlcnRSZWxhdGlv\nbnMoRW50aXR5TWFuYWdlciBlbSwgTWFueU9uZUlkT3duZXIgcGFyZW50KSB7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJwYXJlbnQiLCBwYXJlbnQuZ2V0TmFt\nZSgpKTsKICAgICAgICBCYXNpY0VudGl0eSBpZDEgPSBwYXJlbnQuZ2V0SWQo\nKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGlkMSk7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKGlkLCBpZDEuZ2V0SWQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJpZDEiLCBpZDEuZ2V0TmFtZSgpKTsKICAgICAgICBhc3NlcnRUcnVlKGlk\nMSA9PSBlbS5maW5kKEJhc2ljRW50aXR5LmNsYXNzLCBpZCkpOwogICAgICAg\nIE1hbnlPbmVJZE93bmVyIGNoaWxkID0gcGFyZW50LmdldFNlbGZSZWwoKTsK\nICAgICAgICBhc3NlcnROb3ROdWxsKGNoaWxkKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoImNoaWxkIiwgY2hpbGQuZ2V0TmFtZSgpKTsKICAgICAgICBCYXNp\nY0VudGl0eSBpZDIgPSBjaGlsZC5nZXRJZCgpOwogICAgICAgIGFzc2VydE5v\ndE51bGwoaWQyKTsKICAgICAgICBhc3NlcnRFcXVhbHMoImlkMiIsIGlkMi5n\nZXROYW1lKCkpOwogICAgICAgIGFzc2VydFRydWUoaWQyID09IGVtLmZpbmQo\nQmFzaWNFbnRpdHkuY2xhc3MsIGlkMi5nZXRJZCgpKSk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZShpZDIgPT0gaWQxLmdldFJlbCgpKTsKICAgICAgICBhc3NlcnRU\ncnVlKGlkMSA9PSBpZDIuZ2V0UmVsKCkpOwogICAgICAgIGFzc2VydE51bGwo\nY2hpbGQuZ2V0U2VsZlJlbCgpKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\nYXNzZXJ0RGF0YVN0b3JlUmVsYXRpb25zKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGVtLCAKICAgICAgICBEYXRhU3RvcmVNYW55T25lSWRPd25lciBkc3BhcmVu\ndCkgewogICAgICAgIGFzc2VydEVxdWFscygiZHNwYXJlbnQiLCBkc3BhcmVu\ndC5nZXROYW1lKCkpOwogICAgICAgIERhdGFTdG9yZUJhc2ljRW50aXR5IGRz\naWQxID0gZHNwYXJlbnQuZ2V0SWQoKTsKICAgICAgICBhc3NlcnROb3ROdWxs\nKGRzaWQxKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZHNpZCwgKChMb25nKSBl\nbS5nZXRPYmplY3RJZChkc2lkMSkpLmxvbmdWYWx1ZSgpKTsKICAgICAgICBh\nc3NlcnRFcXVhbHMoImRzaWQxIiwgZHNpZDEuZ2V0TmFtZSgpKTsKICAgICAg\nICBhc3NlcnRUcnVlKGRzaWQxID09IGVtLmZpbmQoRGF0YVN0b3JlQmFzaWNF\nbnRpdHkuY2xhc3MsIGRzaWQpKTsKICAgICAgICBEYXRhU3RvcmVNYW55T25l\nSWRPd25lciBkc2NoaWxkID0gZHNwYXJlbnQuZ2V0U2VsZlJlbCgpOwogICAg\nICAgIGFzc2VydE5vdE51bGwoZHNjaGlsZCk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJkc2NoaWxkIiwgZHNjaGlsZC5nZXROYW1lKCkpOwogICAgICAgIERh\ndGFTdG9yZUJhc2ljRW50aXR5IGRzaWQyID0gZHNjaGlsZC5nZXRJZCgpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoZHNpZDIpOwogICAgICAgIGFzc2VydEVx\ndWFscygiZHNpZDIiLCBkc2lkMi5nZXROYW1lKCkpOwogICAgICAgIGFzc2Vy\ndFRydWUoZHNpZDIgPT0gZW0uZmluZChEYXRhU3RvcmVCYXNpY0VudGl0eS5j\nbGFzcywgCiAgICAgICAgICAgIGVtLmdldE9iamVjdElkKGRzaWQyKSkpOwog\nICAgICAgIGFzc2VydE51bGwoZHNjaGlsZC5nZXRTZWxmUmVsKCkpOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBhc3NlcnRDb21wb3VuZFJlbGF0aW9ucyhP\ncGVuSlBBRW50aXR5TWFuYWdlciBlbSwgCiAgICAgICAgTWFueU9uZUNvbXBv\ndW5kSWRPd25lciBjcGFyZW50KSB7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJj\ncGFyZW50IiwgY3BhcmVudC5nZXROYW1lKCkpOwogICAgICAgIEJhc2ljRW50\naXR5IGlkMSA9IGNwYXJlbnQuZ2V0RW50aXR5SWQoKTsKICAgICAgICBhc3Nl\ncnROb3ROdWxsKGlkMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGlkLCBpZDEu\nZ2V0SWQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJpZDEiLCBpZDEuZ2V0\nTmFtZSgpKTsKICAgICAgICBhc3NlcnRUcnVlKGlkMSA9PSBlbS5maW5kKEJh\nc2ljRW50aXR5LmNsYXNzLCBpZCkpOwogICAgICAgIE1hbnlPbmVDb21wb3Vu\nZElkT3duZXIgY2NoaWxkID0gY3BhcmVudC5nZXRTZWxmUmVsKCk7CiAgICAg\nICAgYXNzZXJ0Tm90TnVsbChjY2hpbGQpOwogICAgICAgIGFzc2VydEVxdWFs\ncygiY2NoaWxkIiwgY2NoaWxkLmdldE5hbWUoKSk7CiAgICAgICAgQmFzaWNF\nbnRpdHkgaWQyID0gY2NoaWxkLmdldEVudGl0eUlkKCk7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChpZDIpOwogICAgICAgIGFzc2VydEVxdWFscygiaWQyIiwg\naWQyLmdldE5hbWUoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShpZDIgPT0gZW0u\nZmluZChCYXNpY0VudGl0eS5jbGFzcywgaWQyLmdldElkKCkpKTsKICAgICAg\nICBhc3NlcnROdWxsKGNjaGlsZC5nZXRTZWxmUmVsKCkpOwogICAgICAgIE1h\nbnlPbmVDb21wb3VuZElkT3duZXJJZCBvaWQgPSAoTWFueU9uZUNvbXBvdW5k\nSWRPd25lcklkKSAKICAgICAgICAgICAgZW0uZ2V0T2JqZWN0SWQoY3BhcmVu\ndCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGlkLCBvaWQuZW50aXR5SWQpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RSZXRyaWV2ZVdpdGhNYW55T25l\nSWQoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgTWFueU9uZUlkT3duZXIgcGFyZW50\nID0gZW0uZmluZChNYW55T25lSWRPd25lci5jbGFzcywgaWQpOwogICAgICAg\nIGFzc2VydE5vdE51bGwocGFyZW50KTsKICAgICAgICBhc3NlcnRSZWxhdGlv\nbnMoZW0sIHBhcmVudCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0UmV0cmlldmVXaXRoRGF0YVN0b3JlTWFueU9u\nZUlkKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIERhdGFTdG9yZU1hbnlPbmVJZE93\nbmVyIGRzcGFyZW50ID0gCiAgICAgICAgICAgIGVtLmZpbmQoRGF0YVN0b3Jl\nTWFueU9uZUlkT3duZXIuY2xhc3MsIGRzaWQpOwogICAgICAgIGFzc2VydE5v\ndE51bGwoZHNwYXJlbnQpOwogICAgICAgIGFzc2VydERhdGFTdG9yZVJlbGF0\naW9ucygoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGVtLCBkc3BhcmVudCk7CiAg\nICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nUmV0cmlldmVXaXRoQ29tcG91bmRNYW55T25lSWQoKSB7CiAgICAgICAgRW50\naXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgTWFueU9uZUNvbXBvdW5kSWRPd25lcklkIG9pZCA9IG5ldyBNYW55\nT25lQ29tcG91bmRJZE93bmVySWQoKTsKICAgICAgICBvaWQuZW50aXR5SWQg\nPSBpZDsKICAgICAgICBvaWQubG9uZ0lkID0gY2lkOwogICAgICAgIE1hbnlP\nbmVDb21wb3VuZElkT3duZXIgY3BhcmVudCA9IAogICAgICAgICAgICBlbS5m\naW5kKE1hbnlPbmVDb21wb3VuZElkT3duZXIuY2xhc3MsIG9pZCk7CiAgICAg\nICAgYXNzZXJ0Tm90TnVsbChjcGFyZW50KTsKICAgICAgICBhc3NlcnRDb21w\nb3VuZFJlbGF0aW9ucygoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGVtLCBjcGFy\nZW50KTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHRlc3RBdHRlbXB0VG9DaGFuZ2VNYW55T25lKCkgewogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIE1hbnlPbmVJZE93bmVyIHBhcmVudCA9IGVtLmZpbmQoTWFueU9u\nZUlkT3duZXIuY2xhc3MsIGlkKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHBh\ncmVudCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChwYXJlbnQuZ2V0U2VsZlJl\nbCgpKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcGFyZW50LnNldElkKHBhcmVudC5n\nZXRTZWxmUmVsKCkuZ2V0SWQoKSk7IAogICAgICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgICAgICBmYWlsKCJTdWNjZXNz\nZnVsbHkgY2hhbmdlZCBpZCByZWxhdGlvbi4iKTsKICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBleHBlY3RlZAogICAg\nICAgICAgICBpZiAoZW0uZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQog\nICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygp\nOwogICAgICAgIH0KICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHRlc3RDaGFuZ2VSZWxhdGlvblRvTWFueU9uZU93bmVyKCkg\newogICAgICAgIEJhc2ljRW50aXR5IGlkMyA9IG5ldyBCYXNpY0VudGl0eSgp\nOwogICAgICAgIGlkMy5zZXROYW1lKCJpZDMiKTsKICAgICAgICBNYW55T25l\nSWRPd25lciBjaGlsZDIgPSBuZXcgTWFueU9uZUlkT3duZXIoKTsKICAgICAg\nICBjaGlsZDIuc2V0TmFtZSgiY2hpbGQyIik7CiAgICAgICAgY2hpbGQyLnNl\ndElkKGlkMyk7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5iZWdpbigpOwogICAgICAgIGVtLnBlcnNpc3QoaWQzKTsKICAgICAgICBl\nbS5wZXJzaXN0KGNoaWxkMik7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwoKICAgICAgICBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgTWFueU9uZUlk\nT3duZXIgcGFyZW50ID0gZW0uZmluZChNYW55T25lSWRPd25lci5jbGFzcywg\naWQpOwogICAgICAgIGFzc2VydE5vdE51bGwocGFyZW50KTsKICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgcGFyZW50LnNl\ndFNlbGZSZWwoY2hpbGQyKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CgogICAgICAgIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBwYXJlbnQgPSBl\nbS5maW5kKE1hbnlPbmVJZE93bmVyLmNsYXNzLCBpZCk7CiAgICAgICAgY2hp\nbGQyID0gcGFyZW50LmdldFNlbGZSZWwoKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoImNoaWxkMiIsIGNoaWxkMi5nZXROYW1lKCkpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhpZDMuZ2V0SWQoKSwgY2hpbGQyLmdldElkKCkuZ2V0SWQoKSk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0Q2hhbmdlUmVsYXRpb25Ub0RhdGFTdG9yZU1hbnlPbmVPd25lcigpIHsK\nICAgICAgICBEYXRhU3RvcmVCYXNpY0VudGl0eSBkc2lkMyA9IG5ldyBEYXRh\nU3RvcmVCYXNpY0VudGl0eSgpOwogICAgICAgIGRzaWQzLnNldE5hbWUoImRz\naWQzIik7CiAgICAgICAgRGF0YVN0b3JlTWFueU9uZUlkT3duZXIgZHNjaGls\nZDIgPSBuZXcgRGF0YVN0b3JlTWFueU9uZUlkT3duZXIoKTsKICAgICAgICBk\nc2NoaWxkMi5zZXROYW1lKCJkc2NoaWxkMiIpOwogICAgICAgIGRzY2hpbGQy\nLnNldElkKGRzaWQzKTsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1m\nLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChkc2lkMyk7CiAg\nICAgICAgZW0ucGVyc2lzdChkc2NoaWxkMik7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwoKICAg\nICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nRGF0YVN0b3JlTWFueU9uZUlkT3duZXIgZHNwYXJlbnQgPSAKICAgICAgICAg\nICAgZW0uZmluZChEYXRhU3RvcmVNYW55T25lSWRPd25lci5jbGFzcywgZHNp\nZCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChkc3BhcmVudCk7CiAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGRzcGFyZW50\nLnNldFNlbGZSZWwoZHNjaGlsZDIpOwogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKCiAgICAgICAg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIGRzcGFy\nZW50ID0gZW0uZmluZChEYXRhU3RvcmVNYW55T25lSWRPd25lci5jbGFzcywg\nZHNpZCk7CiAgICAgICAgZHNjaGlsZDIgPSBkc3BhcmVudC5nZXRTZWxmUmVs\nKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJkc2NoaWxkMiIsIGRzY2hpbGQy\nLmdldE5hbWUoKSk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgb2Vt\nID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBlbTsKICAgICAgICBhc3NlcnRF\ncXVhbHMob2VtLmdldE9iamVjdElkKGRzaWQzKSwgb2VtLmdldE9iamVjdElk\nKGRzY2hpbGQyLmdldElkKCkpKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RDaGFuZ2VSZWxhdGlvblRvQ29tcG91\nbmRNYW55T25lT3duZXIoKSB7CiAgICAgICAgQmFzaWNFbnRpdHkgaWQzID0g\nbmV3IEJhc2ljRW50aXR5KCk7CiAgICAgICAgaWQzLnNldE5hbWUoImlkMyIp\nOwogICAgICAgIE1hbnlPbmVDb21wb3VuZElkT3duZXIgY2NoaWxkMiA9IG5l\ndyBNYW55T25lQ29tcG91bmRJZE93bmVyKCk7CiAgICAgICAgY2NoaWxkMi5z\nZXROYW1lKCJjY2hpbGQyIik7CiAgICAgICAgY2NoaWxkMi5zZXRFbnRpdHlJ\nZChpZDMpOwogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCku\nYmVnaW4oKTsKICAgICAgICBlbS5wZXJzaXN0KGlkMyk7CiAgICAgICAgZW0u\ncGVyc2lzdChjY2hpbGQyKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CgogICAgICAgIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBNYW55T25lQ29t\ncG91bmRJZE93bmVySWQgb2lkID0gbmV3IE1hbnlPbmVDb21wb3VuZElkT3du\nZXJJZCgpOwogICAgICAgIG9pZC5lbnRpdHlJZCA9IGlkOwogICAgICAgIG9p\nZC5sb25nSWQgPSBjaWQ7IAogICAgICAgIE1hbnlPbmVDb21wb3VuZElkT3du\nZXIgY3BhcmVudCA9IGVtLmZpbmQoTWFueU9uZUNvbXBvdW5kSWRPd25lci5j\nbGFzcywgCiAgICAgICAgICAgIG9pZCk7CiAgICAgICAgYXNzZXJ0Tm90TnVs\nbChjcGFyZW50KTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgY3BhcmVudC5zZXRTZWxmUmVsKGNjaGlsZDIpOwogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0u\nY2xvc2UoKTsKCiAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIGNwYXJlbnQgPSBlbS5maW5kKE1hbnlPbmVDb21wb3Vu\nZElkT3duZXIuY2xhc3MsIG9pZCk7CiAgICAgICAgY2NoaWxkMiA9IGNwYXJl\nbnQuZ2V0U2VsZlJlbCgpOwogICAgICAgIGFzc2VydEVxdWFscygiY2NoaWxk\nMiIsIGNjaGlsZDIuZ2V0TmFtZSgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\naWQzLmdldElkKCksIGNjaGlsZDIuZ2V0RW50aXR5SWQoKS5nZXRJZCgpKTsK\nICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RRdWVyeSgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBRdWVyeSBxID0gZW0uY3Jl\nYXRlUXVlcnkoInNlbGVjdCBlIGZyb20gTWFueU9uZUlkT3duZXIgZSAiCiAg\nICAgICAgICAgICsgIndoZXJlIGUuaWQuaWQgPSA6aWQiKTsKICAgICAgICBx\nLnNldFBhcmFtZXRlcigiaWQiLCBpZCk7CiAgICAgICAgTWFueU9uZUlkT3du\nZXIgcGMgPSAoTWFueU9uZUlkT3duZXIpIHEuZ2V0U2luZ2xlUmVzdWx0KCk7\nCiAgICAgICAgYXNzZXJ0Tm90TnVsbChwYyk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJwYXJlbnQiLCBwYy5nZXROYW1lKCkpOwogICAgICAgIGVtLmNsb3Nl\nKCk7CgogICAgICAgIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsK\nICAgICAgICBCYXNpY0VudGl0eSBpZDEgPSBlbS5maW5kKEJhc2ljRW50aXR5\nLmNsYXNzLCBpZCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChpZDEpOwogICAg\nICAgIGFzc2VydEVxdWFscygiaWQxIiwgaWQxLmdldE5hbWUoKSk7CiAgICAg\nICAgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgZSBmcm9tIE1hbnlPbmVJ\nZE93bmVyIGUgd2hlcmUgZS5pZCA9IDppZCIpOwogICAgICAgIHEuc2V0UGFy\nYW1ldGVyKCJpZCIsIGlkMSk7CiAgICAgICAgcGMgPSAoTWFueU9uZUlkT3du\nZXIpIHEuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0Tm90TnVs\nbChwYyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJwYXJlbnQiLCBwYy5nZXRO\nYW1lKCkpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdERhdGFTdG9yZVF1ZXJ5KCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIERhdGFTdG9yZUJhc2ljRW50aXR5IGRzaWQxID0gZW0uZmluZChEYXRhU3Rv\ncmVCYXNpY0VudGl0eS5jbGFzcywgZHNpZCk7CiAgICAgICAgYXNzZXJ0Tm90\nTnVsbChkc2lkMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJkc2lkMSIsIGRz\naWQxLmdldE5hbWUoKSk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1\nZXJ5KCJzZWxlY3QgZSBmcm9tIERhdGFTdG9yZU1hbnlPbmVJZE93bmVyIGUg\nIgogICAgICAgICAgICArICJ3aGVyZSBlLmlkID0gOmlkIik7CiAgICAgICAg\ncS5zZXRQYXJhbWV0ZXIoImlkIiwgZHNpZDEpOwogICAgICAgIERhdGFTdG9y\nZU1hbnlPbmVJZE93bmVyIGRzcGMgPSAoRGF0YVN0b3JlTWFueU9uZUlkT3du\nZXIpIAogICAgICAgICAgICBxLmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAg\nIGFzc2VydE5vdE51bGwoZHNwYyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJk\nc3BhcmVudCIsIGRzcGMuZ2V0TmFtZSgpKTsKICAgICAgICBlbS5jbG9zZSgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RDb21wb3VuZFF1ZXJ5KCkg\newogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgi\nc2VsZWN0IGUgZnJvbSBNYW55T25lQ29tcG91bmRJZE93bmVyIGUgIgogICAg\nICAgICAgICArICJ3aGVyZSBlLmxvbmdJZCA9IDpjaWQgYW5kIGUuZW50aXR5\nSWQuaWQgPSA6aWQiKTsKICAgICAgICBxLnNldFBhcmFtZXRlcigiY2lkIiwg\nY2lkKTsKICAgICAgICBxLnNldFBhcmFtZXRlcigiaWQiLCBpZCk7CiAgICAg\nICAgTWFueU9uZUNvbXBvdW5kSWRPd25lciBwYyA9IChNYW55T25lQ29tcG91\nbmRJZE93bmVyKXEuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0\nTm90TnVsbChwYyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJjcGFyZW50Iiwg\ncGMuZ2V0TmFtZSgpKTsKICAgICAgICBlbS5jbG9zZSgpOwoKICAgICAgICBl\nbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQmFzaWNF\nbnRpdHkgaWQxID0gZW0uZmluZChCYXNpY0VudGl0eS5jbGFzcywgaWQpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoaWQxKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoImlkMSIsIGlkMS5nZXROYW1lKCkpOwogICAgICAgIHEgPSBlbS5jcmVh\ndGVRdWVyeSgic2VsZWN0IGUgZnJvbSBNYW55T25lQ29tcG91bmRJZE93bmVy\nIGUgIgogICAgICAgICAgICArICJ3aGVyZSBlLmxvbmdJZCA9IDpjaWQgYW5k\nIGUuZW50aXR5SWQgPSA6aWQiKTsKICAgICAgICBxLnNldFBhcmFtZXRlcigi\nY2lkIiwgY2lkKTsKICAgICAgICBxLnNldFBhcmFtZXRlcigiaWQiLCBpZDEp\nOwogICAgICAgIHBjID0gKE1hbnlPbmVDb21wb3VuZElkT3duZXIpIHEuZ2V0\nU2luZ2xlUmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChwYyk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKCJjcGFyZW50IiwgcGMuZ2V0TmFtZSgpKTsK\nICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMg\ndm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBUZXN0UnVubmVy\nLnJ1bihUZXN0TWFueU9uZUFzSWQuY2xhc3MpOwogICAgfQp9Cgo=\n","encoding":"base64"}

