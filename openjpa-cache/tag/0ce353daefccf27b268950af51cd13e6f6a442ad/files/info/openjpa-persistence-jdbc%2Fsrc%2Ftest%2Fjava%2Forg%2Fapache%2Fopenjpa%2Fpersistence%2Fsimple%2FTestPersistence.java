{"sha":"6ac77cb540c60b93e7f6eaf045d15ae52528ab94","node_id":"MDQ6QmxvYjIwNjM2NDo2YWM3N2NiNTQwYzYwYjkzZTdmNmVhZjA0NWQxNWFlNTI1MjhhYjk0","size":3640,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6ac77cb540c60b93e7f6eaf045d15ae52528ab94","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5zaW1wbGU7CgppbXBvcnQgamF2YS51dGls\nLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRW50aXR5VHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5QZXJzaXN0ZW5jZTsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsu\nVGVzdENhc2U7CmltcG9ydCBqdW5pdC50ZXh0dWkuVGVzdFJ1bm5lcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50\naXR5TWFuYWdlcjsKCi8qKgogKiBTaW1wbGUgdGVzdCBjYXNlIHRvIGdldCBh\nbiBFbnRpdHlNYW5hZ2VyIGFuZCBwZXJmb3JtIHNvbWUgYmFzaWMgb3BlcmF0\naW9ucy4KICoKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICovCnB1\nYmxpYyBjbGFzcyBUZXN0UGVyc2lzdGVuY2UKICAgIGV4dGVuZHMgVGVzdENh\nc2UgewoKICAgIHByaXZhdGUgRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mOwoK\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIE1hcCBwcm9wcyA9\nIG5ldyBIYXNoTWFwKCk7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLk1l\ndGFEYXRhRmFjdG9yeSIsCiAgICAgICAgICAgICJqcGEoVHlwZXM9IiArIEFs\nbEZpZWxkVHlwZXMuY2xhc3MuZ2V0TmFtZSgpICsgIikiKTsKICAgICAgICBl\nbWYgPSBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgi\ndGVzdCIsIHByb3BzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93\nbigpIHsKICAgICAgICBpZiAoZW1mID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB0cnkgewogICAgICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgICAgICBlbS5j\ncmVhdGVRdWVyeSgiZGVsZXRlIGZyb20gQWxsRmllbGRUeXBlcyIpLmV4ZWN1\ndGVVcGRhdGUoKTsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5j\nb21taXQoKTsKICAgICAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICAgICAg\nZW1mLmNsb3NlKCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdENyZWF0ZUVu\ndGl0eU1hbmFnZXIoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CgogICAgICAgIEVudGl0eVRyYW5z\nYWN0aW9uIHQgPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGFzc2Vy\ndE5vdE51bGwodCk7CiAgICAgICAgdC5iZWdpbigpOwogICAgICAgIHQuc2V0\nUm9sbGJhY2tPbmx5KCk7CiAgICAgICAgdC5yb2xsYmFjaygpOwoKICAgICAg\nICAvLyBvcGVuanBhLWZhY2FkZSB0ZXN0CiAgICAgICAgYXNzZXJ0VHJ1ZShl\nbSBpbnN0YW5jZW9mIE9wZW5KUEFFbnRpdHlNYW5hZ2VyKTsKICAgICAgICBP\ncGVuSlBBRW50aXR5TWFuYWdlciBvamVtID0gKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBlbTsKICAgICAgICBvamVtLmdldEZldGNoUGxhbigpLnNldE1heEZl\ndGNoRGVwdGgoMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIG9qZW0uZ2V0\nRmV0Y2hQbGFuKCkuZ2V0TWF4RmV0Y2hEZXB0aCgpKTsKICAgICAgICBlbS5j\nbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RQZXJzaXN0KCkg\newogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICBlbS5wZXJzaXN0KG5ldyBBbGxGaWVsZFR5cGVzKCkpOwog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAg\nZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnko\nKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwogICAgICAgIEFsbEZpZWxkVHlwZXMgYWZ0ID0gbmV3IEFsbEZpZWxk\nVHlwZXMoKTsKICAgICAgICBhZnQuc2V0U3RyaW5nRmllbGQoImZvbyIpOwog\nICAgICAgIGFmdC5zZXRJbnRGaWVsZCgxMCk7CiAgICAgICAgZW0ucGVyc2lz\ndChhZnQpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKCiAgICAgICAgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCku\nYmVnaW4oKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgZW0uY3JlYXRlUXVl\ncnkKICAgICAgICAgICAgKCJzZWxlY3QgeCBmcm9tIEFsbEZpZWxkVHlwZXMg\neCB3aGVyZSB4LnN0cmluZ0ZpZWxkID0gJ2ZvbyciKS4KICAgICAgICAgICAg\nZ2V0UmVzdWx0TGlzdCgpLnNpemUoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDAsIGVtLmNyZWF0ZVF1ZXJ5CiAgICAgICAgICAgICgic2VsZWN0IHggZnJv\nbSBBbGxGaWVsZFR5cGVzIHggd2hlcmUgeC5zdHJpbmdGaWVsZCA9ICdiYXIn\nIikuCiAgICAgICAgICAgIGdldFJlc3VsdExpc3QoKS5zaXplKCkpOwogICAg\nICAgIGFzc2VydEVxdWFscygxLCBlbS5jcmVhdGVRdWVyeQogICAgICAgICAg\nICAoInNlbGVjdCB4IGZyb20gQWxsRmllbGRUeXBlcyB4IHdoZXJlIHguaW50\nRmllbGQgPj0gMTAiKS4KICAgICAgICAgICAgZ2V0UmVzdWx0TGlzdCgpLnNp\nemUoKSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygp\nOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHN0YXRp\nYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgewogICAgICAgIFRlc3RSdW5u\nZXIucnVuKFRlc3RQZXJzaXN0ZW5jZS5jbGFzcyk7CiAgICB9Cn0KCg==\n","encoding":"base64"}

