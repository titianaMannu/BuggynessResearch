{"sha":"e836e5398a73eaadae10460e1d3d7df9dbc4f511","node_id":"MDQ6QmxvYjIwNjM2NDplODM2ZTUzOThhNzNlYWFkYWUxMDQ2MGUxZDNkN2RmOWRiYzRmNTEx","size":23914,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e836e5398a73eaadae10460e1d3d7df9dbc4f511","content":"LyoKICogQ29weXJpZ2h0IDIwMDYgVGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uLgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vu\nc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBu\nb3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRo\nZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExp\nY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2Vz\nL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNh\nYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICog\nZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQg\nb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9S\nIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGlt\ncGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxh\nbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlv\nbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUu\nb3BlbmpwYS54bWxzdG9yZTsKCmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheUlu\ncHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJl\nYW07CmltcG9ydCBqYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVX\ncml0ZXI7CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2\nYS5pby5PYmplY3RJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0\nT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Cmlt\ncG9ydCBqYXZhLmlvLldyaXRlcjsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0\nLkNvbnN0cnVjdG9yOwppbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7Cmlt\ncG9ydCBqYXZhLm1hdGguQmlnSW50ZWdlcjsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5EYXRl\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTG9jYWxlOwppbXBvcnQgamF2\nYS51dGlsLk1hcDsKaW1wb3J0IGphdmF4LnhtbC5wYXJzZXJzLlNBWFBhcnNl\ncjsKCmltcG9ydCBvcmcueG1sLnNheC5BdHRyaWJ1dGVzOwppbXBvcnQgb3Jn\nLnhtbC5zYXguU0FYRXhjZXB0aW9uOwppbXBvcnQgb3JnLnhtbC5zYXguaGVs\ncGVycy5EZWZhdWx0SGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5lbmhhbmNlLlBDUmVnaXN0cnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnV0aWwuQmFzZTE2RW5jb2RlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIueG1sLlhNTEZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnhtbC5YTUxXcml0ZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLklkOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuSW50ZXJuYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuU3RvcmVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5VbnN1cHBvcnRlZEV4Y2VwdGlvbjsKCi8qKgogKiBT\ndG9yZXMge0BsaW5rIE9iamVjdERhdGF9IG9iamVjdHMgYnkgc2VyaWFsaXpp\nbmcgYSBjb2xsZWN0aW9uCiAqIG9mIHRoZW0gaW50byBhbmQgb3V0IG9mIGFu\nIFhNTCBmaWxlLgogKi8KcHVibGljIGNsYXNzIFhNTEZpbGVIYW5kbGVyIHsK\nCiAgICBwcml2YXRlIGZpbmFsIFhNTENvbmZpZ3VyYXRpb24gX2NvbmY7Cgog\nICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGNvbmZpZ3VyYXRp\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBYTUxGaWxlSGFuZGxlcihYTUxDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBMb2FkcyBhbGwgaW5zdGFuY2VzIG9mIDxjb2Rl\nPm1ldGE8L2NvZGU+IGludG8gYSBsaXN0IG9mIG9iamVjdHMuCiAgICAgKiBU\naGUgZ2l2ZW4gPGNvZGU+bWV0YTwvY29kZT4gbXVzdCByZXByZXNlbnQgYSBs\nZWFzdC1kZXJpdmVkCiAgICAgKiBwZXJzaXN0ZW5jZS1jYXBhYmxlIHR5cGUu\nCiAgICAgKi8KICAgIHB1YmxpYyBDb2xsZWN0aW9uIGxvYWQoQ2xhc3NNZXRh\nRGF0YSBtZXRhKSB7CiAgICAgICAgRmlsZSBmID0gZ2V0RmlsZShtZXRhKTsK\nICAgICAgICBpZiAoIWYuZXhpc3RzKCkgfHwgZi5sZW5ndGgoKSA9PSAwKQog\nICAgICAgICAgICByZXR1cm4gQ29sbGVjdGlvbnMuRU1QVFlfU0VUOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiByZWFkKGYpOwogICAgICAg\nIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAg\ndGhyb3cga2U7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlYWQgYSBjb2xsZWN0aW9uIG9m\nIHtAbGluayBPYmplY3REYXRhfXMgZnJvbSB0aGUgY29udGVudHMgb2YgdGhl\nCiAgICAgKiBnaXZlbiBmaWxlLgogICAgICovCiAgICBwcml2YXRlIENvbGxl\nY3Rpb24gcmVhZChGaWxlIGYpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gcGFyc2UgdGhlIGZpbGUgYW5kIHJldHVybiB0aGUgb2Jq\nZWN0cyBpdCBjb250YWlucwogICAgICAgIFNBWFBhcnNlciBwYXJzZXIgPSBY\nTUxGYWN0b3J5LmdldFNBWFBhcnNlcihmYWxzZSwgZmFsc2UpOwogICAgICAg\nIE9iamVjdERhdGFIYW5kbGVyIGhhbmRsZXIgPSBuZXcgT2JqZWN0RGF0YUhh\nbmRsZXIoX2NvbmYpOwogICAgICAgIHBhcnNlci5wYXJzZShmLCBoYW5kbGVy\nKTsKICAgICAgICByZXR1cm4gaGFuZGxlci5nZXRFeHRlbnQoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybnMgYSB7QGxpbmsgRmlsZX0gb2JqZWN0\nIHRoYXQgPGNvZGU+bWV0YTwvY29kZT4gbGl2ZXMKICAgICAqIGluLiBUaGlz\nIGltcGxlbWVudGF0aW9uIGNyZWF0ZXMgYSBmaWxlbmFtZSBmcm9tIHRoZSBm\ndWxsIGNsYXNzCiAgICAgKiBuYW1lIG9mIHRoZSB0eXBlIGlkZW50aWZpZWQg\nYnkgPGNvZGU+bWV0YTwvY29kZT4sIGFuZCByZXR1cm5zCiAgICAgKiBhIHtA\nbGluayBGaWxlfSBvYmplY3QgdGhhdCBoYXMgdGhpcyBmaWxlbmFtZSBhbmQg\nd2hvc2UgYmFzZQogICAgICogZGlyZWN0b3J5IGlzIHRoZSBVUkwgaWRlbnRp\nZmllZCBieSB0aGUgPGNvZGU+Q29ubmVjdGlvblVSTDwvY29kZT4KICAgICAq\nIGNvbmZpZ3VyYXRpb24gcHJvcGVydHkuCiAgICAgKi8KICAgIHByaXZhdGUg\nRmlsZSBnZXRGaWxlKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIEZp\nbGUgYmFzZURpciA9IG5ldyBGaWxlKF9jb25mLmdldENvbm5lY3Rpb25VUkwo\nKSk7CiAgICAgICAgcmV0dXJuIG5ldyBGaWxlKGJhc2VEaXIsIG1ldGEuZ2V0\nRGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdG9yZXMgYWxsIGluc3RhbmNlcyBpbiA8Y29kZT5kYXRhczwvY29k\nZT4gaW50byB0aGUgYXBwcm9wcmlhdGUgZmlsZSwKICAgICAqIGFzIGRpY3Rh\ndGVkIGJ5IDxjb2RlPm1ldGE8L2NvZGU+LgogICAgICoKICAgICAqIEBwYXJh\nbSBtZXRhIHRoZSBsZWFzdC1kZXJpdmVkIHR5cGUgb2YgdGhlIGluc3RhbmNl\ncyBiZWluZyBzdG9yZWQKICAgICAqIEBwYXJhbSBkYXRhcyBhIGNvbGxlY3Rp\nb24gb2Yge0BsaW5rIE9iamVjdERhdGF9IGluc3RhbmNlcywgZWFjaAogICAg\nICogb2Ygd2hpY2ggcmVwcmVzZW50cyBhbiBvYmplY3Qgb2YgdHlwZSA8Y29k\nZT5tZXRhPC9jb2RlPgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzdG9yZShD\nbGFzc01ldGFEYXRhIG1ldGEsIENvbGxlY3Rpb24gZGF0YXMpIHsKICAgICAg\nICBpZiAobWV0YS5nZXRQQ1N1cGVyY2xhc3MoKSAhPSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKCiAgICAgICAg\nRmlsZSBmID0gZ2V0RmlsZShtZXRhKTsKICAgICAgICBpZiAoIWYuZ2V0UGFy\nZW50RmlsZSgpLmV4aXN0cygpKQogICAgICAgICAgICBmLmdldFBhcmVudEZp\nbGUoKS5ta2RpcnMoKTsKCiAgICAgICAgRmlsZVdyaXRlciBmdyA9IG51bGw7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZncgPSBuZXcgRmlsZVdyaXRl\ncihmKTsKICAgICAgICAgICAgd3JpdGUoZGF0YXMsIGZ3KTsKICAgICAgICB9\nIGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRo\ncm93IGtlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZncgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgZncuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkg\newogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFdyaXRlIHRoZSBnaXZlbiBjb2xsZWN0aW9uIG9mIHtAbGluayBP\nYmplY3REYXRhfXMgdG8gdGhlIGdpdmVuIGZpbGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCB3cml0ZShDb2xsZWN0aW9uIGRhdGFzLCBGaWxlV3JpdGVy\nIGZ3KQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIGNy\nZWF0ZSBhbiBYTUwgcHJldHR5IHByaW50ZXIgdG8gd3JpdGUgb3V0IHRoZSBv\nYmplY3RzCiAgICAgICAgV3JpdGVyIG91dCA9IG5ldyBYTUxXcml0ZXIoZncp\nOwoKICAgICAgICAvLyBzdGFydCB0aGUgZmlsZTsgdGhlIHJvb3Qgbm9kZSBp\ncyBhbiAiZXh0ZW50IgogICAgICAgIG91dC53cml0ZSgiPD94bWwgdmVyc2lv\nbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIj8+Iik7CiAgICAgICAgb3V0\nLndyaXRlKCI8ZXh0ZW50PiIpOwoKICAgICAgICAvLyBydW4gdGhyb3VnaCBl\nYWNoIG9iamVjdCBpbiB0aGUgY29sbGVjdGlvbgogICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRyID0gZGF0YXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgT2JqZWN0RGF0YSBvYmogPSAoT2JqZWN0RGF0YSkg\naXRyLm5leHQoKTsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0g\nb2JqLmdldE1ldGFEYXRhKCk7CgogICAgICAgICAgICAvLyB3cml0ZSBvdXQg\ndGhlICJvYmplY3QiIGVsZW1lbnQgc3RhcnQKICAgICAgICAgICAgb3V0Lndy\naXRlKCI8b2JqZWN0IGNsYXNzPVwiIik7CiAgICAgICAgICAgIG91dC53cml0\nZShtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpOwogICAgICAg\nICAgICBvdXQud3JpdGUoIlwiIG9pZD1cIiIpOwogICAgICAgICAgICBvdXQu\nd3JpdGUob2JqLmdldElkKCkudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIG91\ndC53cml0ZSgiXCIgdmVyc2lvbj1cIiIpOwogICAgICAgICAgICBvdXQud3Jp\ndGUob2JqLmdldFZlcnNpb24oKS50b1N0cmluZygpKTsKICAgICAgICAgICAg\nb3V0LndyaXRlKCJcIj4iKTsKCiAgICAgICAgICAgIC8vIHJ1biB0aHJvdWdo\nIGVhY2ggZmllbGQgd3JpdGluZyBvdXQgdGhlIHZhbHVlCiAgICAgICAgICAg\nIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgICAgICBpZiAoZm1kc1tpXS5nZXRNYW5hZ2VtZW50\nKCkgIT0gZm1kc1tpXS5NQU5BR0VfUEVSU0lTVEVOVCkKICAgICAgICAgICAg\nICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgICBvdXQud3JpdGUo\nIjxmaWVsZCBuYW1lPVwiIik7CiAgICAgICAgICAgICAgICBvdXQud3JpdGUo\nZm1kc1tpXS5nZXROYW1lKCkpOwogICAgICAgICAgICAgICAgb3V0LndyaXRl\nKCJcIj4iKTsKCiAgICAgICAgICAgICAgICAvLyB3cml0ZSBvdXQgdGhlIGZp\nZWxkIGRhdGEgZGVwZW5kaW5nIHVwb24gdHlwZQogICAgICAgICAgICAgICAg\nc3dpdGNoIChmbWRzW2ldLmdldFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAg\nICAgICAgICAgICBDb2xsZWN0aW9uIGMgPSAoQ29sbGVjdGlvbikgb2JqLmdl\ndEZpZWxkKGkpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAg\nICAgICAgICAgICAgICAgICAgICAvLyB3cml0ZSBvdXQgZWFjaCBvZiB0aGUg\nZWxlbWVudHMKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGVsZW1UeXBl\nID0gZm1kc1tpXS5nZXRFbGVtZW50KCkuZ2V0VHlwZUNvZGUoKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgZm9yIChJdGVyYXRvciBjaSA9IGMuaXRlcmF0\nb3IoKTsgY2kuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgb3V0LndyaXRlKCI8ZWxlbWVudD4iKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHdyaXRlRGF0YVZhbHVlKG91dCwgZWxlbVR5cGUsIGNp\nLm5leHQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQud3Jp\ndGUoIjwvZWxlbWVudD4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgICAg\nICAgICBNYXAgbSA9IChNYXApIG9iai5nZXRGaWVsZChpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKG0gPT0gbnVsbCkKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gd3JpdGUgb3V0IGVhY2ggb2YgdGhlIG1hcCBlbnRyaWVzCiAgICAgICAg\nICAgICAgICAgICAgICAgIENvbGxlY3Rpb24gZW50cmllcyA9IG0uZW50cnlT\nZXQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGtleVR5cGUgPSBm\nbWRzW2ldLmdldEtleSgpLmdldFR5cGVDb2RlKCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGludCB2YWx1ZVR5cGUgPSBmbWRzW2ldLmdldEVsZW1lbnQo\nKS5nZXRUeXBlQ29kZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGVpID0gZW50cmllcy5pdGVyYXRvcigpOyBlaS5oYXNOZXh0\nKCk7KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXAuRW50cnkg\nZSA9IChNYXAuRW50cnkpIGVpLm5leHQoKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIG91dC53cml0ZSgiPGtleT4iKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHdyaXRlRGF0YVZhbHVlKG91dCwga2V5VHlwZSwgZS5n\nZXRLZXkoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQud3Jp\ndGUoIjwva2V5PiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0\nLndyaXRlKCI8dmFsdWU+Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB3cml0ZURhdGFWYWx1ZShvdXQsIHZhbHVlVHlwZSwgZS5nZXRWYWx1ZSgp\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dC53cml0ZSgiPC92\nYWx1ZT4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVEYXRhVmFsdWUo\nb3V0LCBmbWRzW2ldLmdldFR5cGVDb2RlKCksCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBvYmouZ2V0RmllbGQoaSkpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgb3V0LndyaXRlKCI8L2ZpZWxkPiIpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIG91dC53cml0ZSgiPC9vYmplY3Q+Iik7\nCiAgICAgICAgfQogICAgICAgIG91dC53cml0ZSgiPC9leHRlbnQ+Iik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXcml0ZSBvdXQgdGhlIGRhdGEgdmFsdWUu\nIFRoaXMgbWV0aG9kIHdyaXRlcyBudWxscyBhcyAibnVsbCIsCiAgICAgKiBz\nZXJpYWxpemVzICh1c2luZyBKYXZhIHNlcmlhbGl6YXRpb24gYW5kIGJhc2Ux\nNiBlbmNvZGluZykgb3V0IG5vbi0KICAgICAqIHByaW1pdGl2ZXMvYm94ZWQg\ncHJpbWl0aXZlcyBhbmQgbm9uLXBlcnNpc3RlbnQgdHlwZXMsIGFuZCB3cml0\nZXMKICAgICAqIHByaW1pdGl2ZXMvYm94ZWQgcHJpbWl0aXZlcyBhbmQgb2lk\ncyB1c2luZyB0aGVpciB0b1N0cmluZy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgd3JpdGVEYXRhVmFsdWUoV3JpdGVyIG91dCwgaW50IHR5cGUsIE9iamVj\ndCB2YWwpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAv\nLyB3cml0ZSBudWxscyBhcyAibnVsbCIKICAgICAgICBpZiAodmFsID09IG51\nbGwpIHsKICAgICAgICAgICAgb3V0LndyaXRlKCJudWxsIik7CiAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHN3aXRjaCAodHlwZSkg\newogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5PQkpFQ1Q6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLk9JRDoKICAgICAgICAgICAgICAgIGlmICgh\nKHZhbCBpbnN0YW5jZW9mIFNlcmlhbGl6YWJsZSkpCiAgICAgICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKAogICAgICAg\nICAgICAgICAgICAgICAgICAiQ2Fubm90IHN0b3JlIG5vbi1zZXJpYWxpemFi\nbGUsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIG5vbi1wZXJz\naXN0ZW5jZS1jYXBhYmxlIHZhbHVlOiAiICsgdmFsKTsKCiAgICAgICAgICAg\nICAgICAvLyBzZXJpYWxpemUgb3V0IHRoZSBvYmplY3QgYW5kIGVuY29kZSB0\naGUgcmVzdWx0IHdpdGggYmFzZTE2CiAgICAgICAgICAgICAgICBCeXRlQXJy\nYXlPdXRwdXRTdHJlYW0gYmFvcyA9IG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJl\nYW0oODE5Mik7CiAgICAgICAgICAgICAgICBPYmplY3RPdXRwdXRTdHJlYW0g\nb29zID0gbmV3IE9iamVjdE91dHB1dFN0cmVhbShiYW9zKTsKICAgICAgICAg\nICAgICAgIG9vcy53cml0ZU9iamVjdCh2YWwpOwogICAgICAgICAgICAgICAg\nb29zLmNsb3NlKCk7CiAgICAgICAgICAgICAgICBvdXQud3JpdGUoQmFzZTE2\nRW5jb2Rlci5lbmNvZGUoYmFvcy50b0J5dGVBcnJheSgpKSk7CiAgICAgICAg\nICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNI\nQVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVJfT0JKOgogICAg\nICAgICAgICAgICAgLy8gcXVvdGUgY2hhcnMgc28gd2UgY2FuIGRpc3Rpbmd1\naXNoIHdoaXRlc3BhY2UgY2hhcnM7IHNwZWNpYWwKICAgICAgICAgICAgICAg\nIC8vIGNhc2UgZm9yIFwwCiAgICAgICAgICAgICAgICBjaGFyIGMgPSAoKENo\nYXJhY3RlcikgdmFsKS5jaGFyVmFsdWUoKTsKICAgICAgICAgICAgICAgIG91\ndC53cml0ZSgiJyIpOwogICAgICAgICAgICAgICAgaWYgKGMgPT0gJ1wwJykK\nICAgICAgICAgICAgICAgICAgICBvdXQud3JpdGUoIjB4MCIpOwogICAgICAg\nICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIG91dC53cml0ZShY\nTUxFbmNvZGVyLmVuY29kZSh2YWwudG9TdHJpbmcoKSkpOwogICAgICAgICAg\nICAgICAgb3V0LndyaXRlKCInIik7CiAgICAgICAgICAgICAgICBicmVhazsK\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoKICAgICAgICAg\nICAgICAgIC8vIHF1b3RlIHN0cmluZ3Mgc28gd2UgY2FuIGRpc3Rpbmd1aXNo\nIGxlYWRpbmcgYW5kIHRyYWlsaW5nCiAgICAgICAgICAgICAgICAvLyB3aGl0\nZXNwYWNlCiAgICAgICAgICAgICAgICBvdXQud3JpdGUoIlwiIik7CiAgICAg\nICAgICAgICAgICBvdXQud3JpdGUoWE1MRW5jb2Rlci5lbmNvZGUodmFsLnRv\nU3RyaW5nKCkpKTsKICAgICAgICAgICAgICAgIG91dC53cml0ZSgiXCIiKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuUEM6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDX1VOVFlQ\nRUQ6CiAgICAgICAgICAgICAgICAvLyB3cml0ZSB0aGUgdHlwZSBvZiBvaWQg\nb2JqZWN0ICsgJzonICsgb2lkIHN0cmluZwogICAgICAgICAgICAgICAgb3V0\nLndyaXRlKHZhbC5nZXRDbGFzcygpLmdldE5hbWUoKSk7CiAgICAgICAgICAg\nICAgICBvdXQud3JpdGUoJzonKTsKICAgICAgICAgICAgICAgIG91dC53cml0\nZShYTUxFbmNvZGVyLmVuY29kZSh2YWwudG9TdHJpbmcoKSkpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgLy8gbXVzdCBiZSBhIG51bWJlciBvZiBzaW1wbGUgdHlwZTsg\nbm8gbmVlZCB0byBlbmNvZGUKICAgICAgICAgICAgICAgIG91dC53cml0ZSh2\nYWwudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogVXNlZCB0byByZWNvbnN0cnVjdCB7QGxpbmsgT2JqZWN0RGF0YX0gaW5z\ndGFuY2VzIGZyb20gU0FYIGV2ZW50cy4KICAgICAqLwogICAgcHJpdmF0ZSBz\ndGF0aWMgY2xhc3MgT2JqZWN0RGF0YUhhbmRsZXIKICAgICAgICBleHRlbmRz\nIERlZmF1bHRIYW5kbGVyIHsKCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgQ2xhc3NbXSBBUkdTID0gbmV3IENsYXNzW117IFN0cmluZy5jbGFzcyB9\nOwoKICAgICAgICBwcml2YXRlIGZpbmFsIFhNTENvbmZpZ3VyYXRpb24gX2Nv\nbmY7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDb2xsZWN0aW9uIF9leHRlbnQg\nPSBuZXcgQXJyYXlMaXN0KCk7CgogICAgICAgIC8vIHBhcnNlIHN0YXRlCiAg\nICAgICAgcHJpdmF0ZSBPYmplY3REYXRhIF9vYmplY3Q7CiAgICAgICAgcHJp\ndmF0ZSBGaWVsZE1ldGFEYXRhIF9mbWQ7CiAgICAgICAgcHJpdmF0ZSBPYmpl\nY3QgX2ZpZWxkVmFsOwogICAgICAgIHByaXZhdGUgT2JqZWN0IF9rZXlWYWw7\nCiAgICAgICAgcHJpdmF0ZSBTdHJpbmdCdWZmZXIgX2J1ZjsKCiAgICAgICAg\nLyoqCiAgICAgICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBjb25maWd1cmF0\naW9uLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBPYmplY3REYXRhSGFu\nZGxlcihYTUxDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICAgICAgX2Nv\nbmYgPSBjb25mOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nUmV0dXJuIHRoZSByZXN1bHRzIG9mIHRoZSBwYXJzaW5nLgogICAgICAgICAq\nLwogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldEV4dGVudCgpIHsKICAg\nICAgICAgICAgcmV0dXJuIF9leHRlbnQ7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzdGFydEVsZW1lbnQoU3RyaW5nIHVyaSwgU3RyaW5nIGxv\nY2FsTmFtZSwgU3RyaW5nIHFOYW1lLAogICAgICAgICAgICBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0YXJ0RWxlbWVudChx\nTmFtZSwgYXR0cnMpOwogICAgICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhj\nZXB0aW9uIHJlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyByZTsKICAgICAg\nICAgICAgfSBjYXRjaCAoU0FYRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTQVhFeGNlcHRpb24o\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZhdGUg\ndm9pZCBzdGFydEVsZW1lbnQoU3RyaW5nIHFOYW1lLCBBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgc3dpdGNoIChxTmFtZS5jaGFyQXQoMCkpIHsKICAgICAgICAgICAgICAg\nIGNhc2UgJ28nOiAvLyBvYmplY3QKICAgICAgICAgICAgICAgICAgICAvLyBn\nZXQgdGhlIG1ldGFkYXRhIGZvciB0aGUgdHlwZSB3ZSdyZSByZWFkaW5nCiAg\nICAgICAgICAgICAgICAgICAgU3RyaW5nIHR5cGUgPSBhdHRycy5nZXRWYWx1\nZSgiY2xhc3MiKTsKICAgICAgICAgICAgICAgICAgICBDbGFzc01ldGFEYXRh\nIG1ldGEgPSBfY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgp\nLgogICAgICAgICAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YShjbGFzc0Zv\nck5hbWUodHlwZSksIG51bGwsIHRydWUpOwoKICAgICAgICAgICAgICAgICAg\nICAvLyBjb25zdHJ1Y3QgdGhlIG9pZCBvYmplY3QKICAgICAgICAgICAgICAg\nICAgICBPYmplY3Qgb2lkOwogICAgICAgICAgICAgICAgICAgIGlmIChtZXRh\nLmdldElkZW50aXR5VHlwZSgpID09IG1ldGEuSURfREFUQVNUT1JFKQogICAg\nICAgICAgICAgICAgICAgICAgICBvaWQgPSBuZXcgSWQoYXR0cnMuZ2V0VmFs\ndWUoIm9pZCIpLCBfY29uZiwgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBvaWQgPSBQQ1JlZ2lzdHJ5\nLm5ld09iamVjdElkKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoIm9pZCIpKTsK\nCiAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIGFuIE9iamVjdERhdGEg\ndGhhdCB3aWxsIGNvbnRhaW4gdGhlIGluZm9ybWF0aW9uCiAgICAgICAgICAg\nICAgICAgICAgLy8gZm9yIHRoaXMgaW5zdGFuY2UsIGFuZCBzZXQgdGhlIHZl\ncnNpb24KICAgICAgICAgICAgICAgICAgICBfb2JqZWN0ID0gbmV3IE9iamVj\ndERhdGEob2lkLCBtZXRhKTsKICAgICAgICAgICAgICAgICAgICBfb2JqZWN0\nLnNldFZlcnNpb24obmV3IExvbmcoYXR0cnMuZ2V0VmFsdWUoInZlcnNpb24i\nKSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAg\nICAgIGNhc2UgJ2YnOiAvLyBmaWVsZAogICAgICAgICAgICAgICAgICAgIC8v\nIHN0YXJ0IHBhcnNpbmcgYSBmaWVsZCBlbGVtZW50OiBmb3IgY29udGFpbmVy\nIHR5cGVzLAogICAgICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhl\nIGNvbnRhaW5lcjsgZm9yIG90aGVyIHR5cGVzLCBpbml0aWFsaXplIGEKICAg\nICAgICAgICAgICAgICAgICAvLyBidWZmZXIKICAgICAgICAgICAgICAgICAg\nICBfZm1kID0KICAgICAgICAgICAgICAgICAgICAgICAgX29iamVjdC5nZXRN\nZXRhRGF0YSgpLmdldEZpZWxkKGF0dHJzLmdldFZhbHVlKCJuYW1lIikpOwog\nICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2ZtZC5nZXRUeXBlQ29kZSgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNP\nTExFQ1RJT046CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkFSUkFZOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2ZpZWxk\nVmFsID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9maWVs\nZFZhbCA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9idWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgJ2UnOiAvLyBl\nbGVtZW50CiAgICAgICAgICAgICAgICBjYXNlICdrJzogLy8ga2V5CiAgICAg\nICAgICAgICAgICBjYXNlICd2JzogLy8gdmFsdWUKICAgICAgICAgICAgICAg\nICAgICAvLyBpbml0aWFsaXplIGEgYnVmZmVyIGZvciB0aGUgZWxlbWVudCB2\nYWx1ZQogICAgICAgICAgICAgICAgICAgIF9idWYgPSBuZXcgU3RyaW5nQnVm\nZmVyKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGVuZEVsZW1lbnQo\nU3RyaW5nIHVyaSwgU3RyaW5nIGxvY2FsTmFtZSwgU3RyaW5nIHFOYW1lKQog\nICAgICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIGVuZEVsZW1lbnQocU5hbWUpOwogICAg\nICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAg\nICAgICAgICAgICB0aHJvdyByZTsKICAgICAgICAgICAgfSBjYXRjaCAoU0FY\nRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAg\nICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBTQVhFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHByaXZhdGUgdm9pZCBlbmRFbGVtZW50KFN0\ncmluZyBxTmFtZSkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIE9iamVjdCB2YWw7CiAgICAgICAgICAgIHN3aXRjaCAocU5h\nbWUuY2hhckF0KDApKSB7CiAgICAgICAgICAgICAgICBjYXNlICdvJzogLy8g\nb2JqZWN0CiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBvYmplY3Qg\ndG8gb3VyIHJlc3VsdHMKICAgICAgICAgICAgICAgICAgICBfZXh0ZW50LmFk\nZChfb2JqZWN0KTsKCiAgICAgICAgICAgICAgICBjYXNlICdmJzogLy8gZmll\nbGQKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9mbWQuZ2V0VHlwZUNv\nZGUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5DT0xMRUNUSU9OOgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nZmllbGQgdmFsdWUgYWxyZWFkeSBjb25zdHJ1Y3RlZAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25z\ndHJ1Y3QgdGhlIGZpZWxkIHZhbHVlIGZyb20gdGV4dCB3aXRoaW4gdGhlIGVs\nZW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9maWVsZFZhbCA9\nIGZyb21YTUxTdHJpbmcoX2ZtZC5nZXRUeXBlQ29kZSgpLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIF9mbWQuZ2V0VHlwZU1ldGFEYXRhKCks\nIF9idWYudG9TdHJpbmcoKSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIGZpZWxkIHZhbHVlIGludG8g\ndGhlIG9iamVjdCBiZWluZyBwYXJzZWQKICAgICAgICAgICAgICAgICAgICBf\nb2JqZWN0LnNldEZpZWxkKF9mbWQuZ2V0SW5kZXgoKSwgX2ZpZWxkVmFsKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBj\nYXNlICdlJzogLy8gZWxlbWVudAogICAgICAgICAgICAgICAgICAgIC8vIGNh\nY2hlIGVsZW1lbnQgdmFsdWUKICAgICAgICAgICAgICAgICAgICB2YWwgPSBm\ncm9tWE1MU3RyaW5nKF9mbWQuZ2V0RWxlbWVudCgpLmdldFR5cGVDb2RlKCks\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9mbWQuZ2V0RWxlbWVudCgpLmdl\ndFR5cGVNZXRhRGF0YSgpLCBfYnVmLnRvU3RyaW5nKCkpOwogICAgICAgICAg\nICAgICAgICAgICgoQ29sbGVjdGlvbikgX2ZpZWxkVmFsKS5hZGQodmFsKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBj\nYXNlICdrJzogLy8ga2V5CiAgICAgICAgICAgICAgICAgICAgLy8gY2FjaGUg\na2V5IHZhbHVlCiAgICAgICAgICAgICAgICAgICAgX2tleVZhbCA9IGZyb21Y\nTUxTdHJpbmcoX2ZtZC5nZXRLZXkoKS5nZXRUeXBlQ29kZSgpLAogICAgICAg\nICAgICAgICAgICAgICAgICBfZm1kLmdldEtleSgpLmdldFR5cGVNZXRhRGF0\nYSgpLCBfYnVmLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgJ3YnOiAvLyB2YWx1ZQogICAg\nICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSB2YWx1ZSBhbmQgcHV0IGNhY2hl\nZCBrZXkgYW5kIHZhbHVlIGludG8gbWFwCiAgICAgICAgICAgICAgICAgICAg\ndmFsID0gZnJvbVhNTFN0cmluZyhfZm1kLmdldEVsZW1lbnQoKS5nZXRUeXBl\nQ29kZSgpLAogICAgICAgICAgICAgICAgICAgICAgICBfZm1kLmdldEVsZW1l\nbnQoKS5nZXRUeXBlTWV0YURhdGEoKSwgX2J1Zi50b1N0cmluZygpKTsKICAg\nICAgICAgICAgICAgICAgICBNYXAgbWFwID0gKE1hcCkgX2ZpZWxkVmFsOwog\nICAgICAgICAgICAgICAgICAgIG1hcC5wdXQoX2tleVZhbCwgdmFsKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgLy8gZG9uJ3QgY2FjaGUgdGV4dCBiZXR3ZWVuIGVsZW1lbnRzCiAg\nICAgICAgICAgIF9idWYgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgY2hhcmFjdGVycyhjaGFyW10gY2gsIGludCBzdGFydCwgaW50\nIGxlbmd0aCkgewogICAgICAgICAgICBpZiAoX2J1ZiAhPSBudWxsKQogICAg\nICAgICAgICAgICAgX2J1Zi5hcHBlbmQoY2gsIHN0YXJ0LCBsZW5ndGgpOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmVjcmVhdGUgYSBm\naWVsZCB2YWx1ZSBmcm9tIGl0cyBYTUwgc3RyaW5nLgogICAgICAgICAqLwog\nICAgICAgIHB1YmxpYyBPYmplY3QgZnJvbVhNTFN0cmluZyhpbnQgdHlwZSwg\nQ2xhc3NNZXRhRGF0YSByZWwsIFN0cmluZyBzdHIpCiAgICAgICAgICAgIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBzdHIgPSBzdHIudHJpbSgp\nOwogICAgICAgICAgICBpZiAoc3RyLmVxdWFscygibnVsbCIpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgICAgICBzd2l0Y2ggKHR5\ncGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJPT0xFQU46\nCiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09MRUFOX09CSjoK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi52YWx1ZU9mKHN0\ncik7CgogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURToKICAg\nICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgQnl0ZShzdHIpOwoKICAgICAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAgICAgICAgICAv\nLyBzdHJpcCBxdW90ZXM7IHNwZWNpYWwgY2FzZSBmb3IgMHgwCiAgICAgICAg\nICAgICAgICAgICAgc3RyID0gc3RyLnN1YnN0cmluZygxLCBzdHIubGVuZ3Ro\nKCkgLSAxKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc3RyLmVxdWFscygi\nMHgwIikpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hh\ncmFjdGVyKCdcMCcpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcg\nQ2hhcmFjdGVyKFhNTEVuY29kZXIuZGVjb2RlKHN0cikuY2hhckF0KDApKTsK\nCiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgRG91YmxlKHN0cik7CgogICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5GTE9BVF9PQko6CiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG5ldyBGbG9hdChzdHIpOwoKICAgICAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLklOVDoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLklOVF9PQko6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJ\nbnRlZ2VyKHN0cik7CgogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nTE9ORzoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkdfT0JK\nOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTG9uZyhzdHIpOwoK\nICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUOgogICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgU2hvcnQoc3RyKTsKCiAgICAgICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5OVU1CRVI6CiAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5CSUdERUNJTUFMOgogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBuZXcgQmlnRGVjaW1hbChzdHIpOwoKICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkJJR0lOVEVHRVI6CiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG5ldyBCaWdJbnRlZ2VyKHN0cik7CgogICAgICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOgogICAgICAgICAgICAgICAgICAg\nIC8vIHN0cmlwIHF1b3RlcwogICAgICAgICAgICAgICAgICAgIHN0ciA9IHN0\nci5zdWJzdHJpbmcoMSwgc3RyLmxlbmd0aCgpIC0gMSk7CiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIFhNTEVuY29kZXIuZGVjb2RlKHN0cik7CgogICAg\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgogICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuT0lEOgogICAgICAgICAgICAgICAgICAg\nIC8vIGNvbnZlcnQgdGhlIGNoYXJzIGludG8gYnl0ZXMsIGFuZCBydW4gdGhl\nbSB0aHJvdWdoIGFuIAogICAgICAgICAgICAgICAgICAgIC8vIE9iamVjdElu\ncHV0U3RyZWFtIGluIG9yZGVyIHRvIGdldCB0aGUgc2VyaWFsaXplZCBvYmpl\nY3QKICAgICAgICAgICAgICAgICAgICBieXRlW10gYnl0ZXMgPSBCYXNlMTZF\nbmNvZGVyLmRlY29kZShzdHIpOwogICAgICAgICAgICAgICAgICAgIEJ5dGVB\ncnJheUlucHV0U3RyZWFtIGJhaXMgPSBuZXcgQnl0ZUFycmF5SW5wdXRTdHJl\nYW0oYnl0ZXMpOwogICAgICAgICAgICAgICAgICAgIE9iamVjdElucHV0U3Ry\nZWFtIG9pcyA9IG5ldyBPYmplY3RJbnB1dFN0cmVhbShiYWlzKTsKICAgICAg\nICAgICAgICAgICAgICBPYmplY3QgZGF0YSA9IG9pcy5yZWFkT2JqZWN0KCk7\nCiAgICAgICAgICAgICAgICAgICAgb2lzLmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIGRhdGE7CgogICAgICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuREFURToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3\nIERhdGUoc3RyKTsKCiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5Q\nQzoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDX1VOVFlQRUQ6\nCiAgICAgICAgICAgICAgICAgICAgLy8gcGFyc2Ugb3V0IG9pZCBjbGFzcyBu\nYW1lIGFuZCB2YWx1ZQogICAgICAgICAgICAgICAgICAgIGludCBpZHggPSBz\ndHIuaW5kZXhPZignOicpOwogICAgICAgICAgICAgICAgICAgIENsYXNzIGlk\nQ2xhc3MgPSBjbGFzc0Zvck5hbWUoc3RyLnN1YnN0cmluZygwLCBpZHgpKTsK\nICAgICAgICAgICAgICAgICAgICBTdHJpbmcgaWRTdHIgPSBYTUxFbmNvZGVy\nLmRlY29kZShzdHIuc3Vic3RyaW5nKGlkeCArIDEpKTsKICAgICAgICAgICAg\nICAgICAgICBDb25zdHJ1Y3RvciBjb25zID0gaWRDbGFzcy5nZXRDb25zdHJ1\nY3RvcihBUkdTKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29ucy5u\nZXdJbnN0YW5jZShuZXcgT2JqZWN0W117IGlkU3RyIH0pOwoKICAgICAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPQ0FMRToKICAgICAgICAgICAgICAg\nICAgICBpbnQgdW5kZXIxID0gc3RyLmluZGV4T2YoJ18nKTsKICAgICAgICAg\nICAgICAgICAgICBpZiAodW5kZXIxID09IC0xKQogICAgICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gKG5ldyBMb2NhbGUoc3RyLCAiIikpOwoKICAgICAg\nICAgICAgICAgICAgICBpbnQgdW5kZXIyID0gc3RyLmluZGV4T2YoJ18nLCB1\nbmRlcjEgKyAxKTsKICAgICAgICAgICAgICAgICAgICBpZiAodW5kZXIyID09\nIC0xKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExvY2Fs\nZShzdHIuc3Vic3RyaW5nKDAsIHVuZGVyMSksCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBzdHIuc3Vic3RyaW5nKHVuZGVyMSArIDEpKTsKCiAgICAg\nICAgICAgICAgICAgICAgU3RyaW5nIGxhbmcgPSBzdHIuc3Vic3RyaW5nKDAs\nIHVuZGVyMSk7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGNvdW50cnkg\nPSBzdHIuc3Vic3RyaW5nKHVuZGVyMSArIDEsIHVuZGVyMik7CiAgICAgICAg\nICAgICAgICAgICAgU3RyaW5nIHZhcmlhbnQgPSBzdHIuc3Vic3RyaW5nKHVu\nZGVyMiArIDEpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTG9j\nYWxlKGxhbmcsIGNvdW50cnksIHZhcmlhbnQpOwoKICAgICAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVy\nbmFsRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIC8qKgogICAgICAgICAqIFJldHVybiB0aGUgY2xhc3MgZm9yIHRoZSBz\ncGVjaWZpZWQgbmFtZS4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIENs\nYXNzIGNsYXNzRm9yTmFtZShTdHJpbmcgbmFtZSkKICAgICAgICAgICAgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIENsYXNzTG9hZGVyIGxvYWRl\nciA9IF9jb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAg\nICAgICAgICAgZ2V0Q2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKSwgbnVsbCk7CiAg\nICAgICAgICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKG5hbWUsIHRydWUsIGxv\nYWRlcik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVXRpbGl0\neSBtZXRob2RzIGZvciBlbmNvZGluZyBhbmQgZGVjb2RpbmcgWE1MIHN0cmlu\nZ3MuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFhNTEVuY29k\nZXIgewoKICAgICAgICAvKioKICAgICAgICAgKiBFbmNvZGUgdGhlIGdpdmVu\nIHN0cmluZyBhcyBYTUwgdGV4dC4KICAgICAgICAgKi8KICAgICAgICBwdWJs\naWMgc3RhdGljIFN0cmluZyBlbmNvZGUoU3RyaW5nIHMpIHsKICAgICAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG51bGw7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcy5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAgICAg\nICAgICBzd2l0Y2ggKHMuY2hhckF0KGkpKSB7CiAgICAgICAgICAgICAgICAg\nICAgY2FzZSAnPCc6CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZiA9IGlu\naXRpYWxpemVCdWZmZXIoYnVmLCBzLCBpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiJmx0OyIpOwogICAgICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICc+JzoKICAg\nICAgICAgICAgICAgICAgICAgICAgYnVmID0gaW5pdGlhbGl6ZUJ1ZmZlcihi\ndWYsIHMsIGkpOwogICAgICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5k\nKCImZ3Q7Iik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgICAgIGNhc2UgJyYnOgogICAgICAgICAgICAgICAgICAg\nICAgICBidWYgPSBpbml0aWFsaXplQnVmZmVyKGJ1ZiwgcywgaSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiZhbXA7Iik7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChidWYgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\ncy5jaGFyQXQoaSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGlmIChidWYgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgICAgICAgICAgcmV0dXJuIHM7\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBEZWNvZGUgdGhl\nIGdpdmVuIFhNTCBzdHJpbmcuCiAgICAgICAgICovCiAgICAgICAgcHVibGlj\nIHN0YXRpYyBTdHJpbmcgZGVjb2RlKFN0cmluZyBzKSB7CiAgICAgICAgICAg\nIFN0cmluZ0J1ZmZlciBidWYgPSBudWxsOwogICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHMubGVuZ3RoKCk7IGkrKykgewogICAgICAgICAgICAg\nICAgY2hhciBjID0gcy5jaGFyQXQoaSk7CiAgICAgICAgICAgICAgICBpZiAo\nYyA9PSAnJicgJiYgcy5sZW5ndGgoKSA+IGkgKyAzKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKChzLmNoYXJBdChpICsgMSkgPT0gJ2wnIHx8IHMuY2hh\nckF0KGkgKyAxKSA9PSAnZycpCiAgICAgICAgICAgICAgICAgICAgICAgICYm\nIHMuY2hhckF0KGkgKyAyKSA9PSAndCcgJiYgcy5jaGFyQXQoaSArIDMpID09\nICc7JykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyAmbHQ7IG9yICZn\ndDsKICAgICAgICAgICAgICAgICAgICAgICAgYnVmID0gaW5pdGlhbGl6ZUJ1\nZmZlcihidWYsIHMsIGkpOwogICAgICAgICAgICAgICAgICAgICAgICBjID0g\nKHMuY2hhckF0KGkpID09ICdsJykgPyAnPCcgOiAnPic7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGkgKz0gMzsKICAgICAgICAgICAgICAgICAgICB9IGVs\nc2UgaWYgKHMubGVuZ3RoKCkgPiBpICsgNCAmJiBzLmNoYXJBdChpICsgMSkg\nPT0gJ2EnCiAgICAgICAgICAgICAgICAgICAgICAgICYmIHMuY2hhckF0KGkg\nKyAyKSA9PSAnbScgJiYgcy5jaGFyQXQoaSArIDMpID09ICdwJwogICAgICAg\nICAgICAgICAgICAgICAgICAmJiBzLmNoYXJBdChpICsgNCkgPT0gJzsnKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vICZhbXA7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGJ1ZiA9IGluaXRpYWxpemVCdWZmZXIoYnVmLCBzLCBp\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICcmJzsKICAgICAgICAg\nICAgICAgICAgICAgICAgaSArPSA0OwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChidWYgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGMpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGlmIChidWYgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgICAgICAgICAg\ncmV0dXJuIHM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBD\ncmVhdGUgYW5kIGluaXRpYWxpemUgYSBidWZmZXIgZm9yIHRoZSBlbmNvZGVk\nL2RlY29kZWQgc3RyaW5nIGlmCiAgICAgICAgICogbmVlZGVkLgogICAgICAg\nICAqLwogICAgICAgIHByaXZhdGUgc3RhdGljIFN0cmluZ0J1ZmZlciBpbml0\naWFsaXplQnVmZmVyKFN0cmluZ0J1ZmZlciBidWYsCiAgICAgICAgICAgIFN0\ncmluZyBzLCBpbnQgaSkgewogICAgICAgICAgICBpZiAoYnVmID09IG51bGwp\nIHsKICAgICAgICAgICAgICAgIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsK\nICAgICAgICAgICAgICAgIGlmIChpID4gMCkKICAgICAgICAgICAgICAgICAg\nICBidWYuYXBwZW5kIChzLnN1YnN0cmluZyAoMCwgaSkpOwoJCQl9CgkJCXJl\ndHVybiBidWY7CgkJfQoJfQp9Cg==\n","encoding":"base64"}

