{"sha":"aad1d2ac765c668a3f2b8871e20ed6502077a2d2","node_id":"MDQ6QmxvYjIwNjM2NDphYWQxZDJhYzc2NWM2NjhhM2YyYjg4NzFlMjBlZDY1MDIwNzdhMmQy","size":7224,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/aad1d2ac765c668a3f2b8871e20ed6502077a2d2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmF4LnNxbC5EYXRhU291cmNlOwppbXBvcnQg\namF2YXgudHJhbnNhY3Rpb24uVHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC50\ncmFuc2FjdGlvbi5UcmFuc2FjdGlvbk1hbmFnZXI7CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5n\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVt\nYUdyb3VwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNR\nTEV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLlN0b3JlQ29udGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5PcGVuSlBBRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuU3RvcmVFeGNlcHRpb247CgovKioKICogQWJzdHJhY3Qgc2VxdWVu\nY2UgaW1wbGVtZW50YXRpb24uIEhhbmRsZXMgb2J0YWluaW5nIHRoZSBwcm9w\nZXIKICogY29ubmVjdGlvbiB0byB1c2VkIGJhc2VkIG9uIHdoZXRoZXIgdGhl\nIHNlcXVlbmNlIGlzIHRyYW5zYWN0aW9uYWwgYW5kCiAqIHdoZXRoZXIgYSBz\nZWNvbmQgZGF0YXNvdXJjZSBpcyBjb25maWd1cmVkLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3RyYWN0\nSkRCQ1NlcQogICAgaW1wbGVtZW50cyBKREJDU2VxIHsKCiAgICBwcm90ZWN0\nZWQgaW50IHR5cGUgPSBUWVBFX0RFRkFVTFQ7CiAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IGN1cnJlbnQgPSBudWxsOwogICAgcHJpdmF0ZSBzdGF0aWMgVGhyZWFk\nTG9jYWwgX291dGVyVHJhbnNhY3Rpb24gPSBuZXcgVGhyZWFkTG9jYWwoKTsK\nCiAgICAvKioKICAgICAqIFJlY29yZHMgdGhlIHNlcXVlbmNlIHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFR5cGUoaW50IHR5cGUpIHsKICAg\nICAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgfQoKICAgIHB1YmxpYyBPYmpl\nY3QgbmV4dChTdG9yZUNvbnRleHQgY3R4LCBDbGFzc01ldGFEYXRhIG1ldGEp\nIHsKICAgICAgICBKREJDU3RvcmUgc3RvcmUgPSBnZXRTdG9yZShjdHgpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIE9iamVjdCBjdXJyZW50TG9jYWwg\nPSBuZXh0SW50ZXJuYWwoc3RvcmUsIChDbGFzc01hcHBpbmcpIG1ldGEpOwog\nICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudExvY2FsOwogICAgICAgICAg\nICByZXR1cm4gY3VycmVudExvY2FsOwogICAgICAgIH0gY2F0Y2ggKE9wZW5K\nUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIHRo\ncm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsIHN0b3JlLmdldERCRGlj\ndGlvbmFyeSgpKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgY3VycmVudChTdG9yZUNv\nbnRleHQgY3R4LCBDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBKREJD\nU3RvcmUgc3RvcmUgPSBnZXRTdG9yZShjdHgpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIHJldHVybiBjdXJyZW50SW50ZXJuYWwoc3RvcmUsIChDbGFz\nc01hcHBpbmcpIG1ldGEpOwogICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNl\ncHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIHRocm93IFNR\nTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsIHN0b3JlLmdldERCRGljdGlvbmFy\neSgpKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIGFsbG9jYXRlKGludCBhZGRpdGlvbmFs\nLCBTdG9yZUNvbnRleHQgY3R4LCBDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAg\nICAgICBKREJDU3RvcmUgc3RvcmUgPSBnZXRTdG9yZShjdHgpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGFsbG9jYXRlSW50ZXJuYWwoYWRkaXRpb25h\nbCwgc3RvcmUsIChDbGFzc01hcHBpbmcpIG1ldGEpOwogICAgICAgIH0gY2F0\nY2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cg\na2U7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsIHN0b3Jl\nLmdldERCRGljdGlvbmFyeSgpKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24o\nZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogTm8tb3AuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZFNjaGVtYShDbGFzc01hcHBpbmcg\nbWFwcGluZywgU2NoZW1hR3JvdXAgZ3JvdXApIHsKICAgIH0KCiAgICAvKioK\nICAgICAqIE5vLW9wLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgp\nIHsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbmV4dCBzZXF1\nZW5jZSBvYmplY3QuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBP\nYmplY3QgbmV4dEludGVybmFsKEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBD\nbGFzc01hcHBpbmcgbWFwcGluZykKICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nOwogICAgCiAgICAvKioKICAgICAqIFJldHVybiB0aGUge0BsaW5rIEpEQkND\nb25maWd1cmF0aW9ufSBmb3IgdGhpcyBzZXF1ZW5jZS4KICAgICAqLwogICAg\ncHVibGljIGFic3RyYWN0IEpEQkNDb25maWd1cmF0aW9uIGdldENvbmZpZ3Vy\nYXRpb24oKTsKCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCBz\nZXF1ZW5jZSBvYmplY3QuIEJ5IGRlZmF1bHQgcmV0dXJucyB0aGUgbGFzdAog\nICAgICogc2VxdWVuY2UgdmFsdWUgdXNlZCwgb3IgbnVsbCBpZiBubyBzZXF1\nZW5jZSB2YWx1ZXMgaGF2ZSBiZWVuIHJlcXVlc3RlZAogICAgICogeWV0LiBE\nZWZhdWx0IGltcGxlbWVudGF0aW9uIGlzIG5vdCB0aHJlYWRzYWZlLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGN1cnJlbnRJbnRlcm5hbChKREJD\nU3RvcmUgc3RvcmUsIENsYXNzTWFwcGluZyBtYXBwaW5nKQogICAgICAgIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIHJldHVybiBjdXJyZW50OwogICAg\nfQoKICAgIC8qKgogICAgICogQWxsb2NhdGUgYWRkaXRpb25hbCBzZXF1ZW5j\nZSB2YWx1ZXMuIERvZXMgbm90aGluZyBieSBkZWZhdWx0LgogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBhbGxvY2F0ZUludGVybmFsKGludCBhZGRpdGlv\nbmFsLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBFeHRyYWN0IHRoZSBzdG9yZSBmcm9tIHRoZSBnaXZlbiBj\nb250ZXh0LgogICAgICovCiAgICBwcml2YXRlIEpEQkNTdG9yZSBnZXRTdG9y\nZShTdG9yZUNvbnRleHQgY3R4KSB7CiAgICAgICAgcmV0dXJuIChKREJDU3Rv\ncmUpIGN0eC5nZXRTdG9yZU1hbmFnZXIoKS5nZXRJbm5lcm1vc3REZWxlZ2F0\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb25uZWN0\naW9uIHRvIHVzZSBiYXNlZCBvbiB0aGUgdHlwZSBvZiBzZXF1ZW5jZS4gVGhp\ncwogICAgICogY29ubmVjdGlvbiB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgY2xv\nc2VkOyBkbyBub3QgY2xvc2UgaXQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBD\nb25uZWN0aW9uIGdldENvbm5lY3Rpb24oSkRCQ1N0b3JlIHN0b3JlKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh0eXBlID09\nIFRZUEVfVFJBTlNBQ1RJT05BTCB8fCB0eXBlID09IFRZUEVfQ09OVElHVU9V\nUykKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmdldENvbm5lY3Rpb24oKTsK\nICAgICAgICBlbHNlIGlmIChzdXNwZW5kSW5KVEEoKSkgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgVHJhbnNhY3Rpb25NYW5hZ2VyIHRt\nID0gZ2V0Q29uZmlndXJhdGlvbigpCiAgICAgICAgICAgICAgICAgICAgLmdl\ndE1hbmFnZWRSdW50aW1lSW5zdGFuY2UoKS5nZXRUcmFuc2FjdGlvbk1hbmFn\nZXIoKTsKICAgICAgICAgICAgICAgIF9vdXRlclRyYW5zYWN0aW9uLnNldCh0\nbS5zdXNwZW5kKCkpOwogICAgICAgICAgICAgICAgdG0uYmVnaW4oKTsKICAg\nICAgICAgICAgICAgIHJldHVybiBzdG9yZS5nZXRDb25uZWN0aW9uKCk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBKREJDQ29uZmlndXJh\ndGlvbiBjb25mID0gc3RvcmUuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAg\nICAgICBEYXRhU291cmNlIGRzID0gY29uZi5nZXREYXRhU291cmNlMihzdG9y\nZS5nZXRDb250ZXh0KCkpOwogICAgICAgICAgICBDb25uZWN0aW9uIGNvbm4g\nPSBkcy5nZXRDb25uZWN0aW9uKCk7CiAgICAgICAgICAgIGlmIChjb25uLmdl\ndEF1dG9Db21taXQoKSkKICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0Nv\nbW1pdChmYWxzZSk7CiAgICAgICAgICAgIHJldHVybiBjb25uOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIENsb3NlIHRoZSBjdXJyZW50IGNv\nbm5lY3Rpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNsb3NlQ29u\nbmVjdGlvbihDb25uZWN0aW9uIGNvbm4pIHsKICAgICAgICBpZiAoY29ubiA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIGlmICh0eXBl\nID09IFRZUEVfVFJBTlNBQ1RJT05BTCB8fCB0eXBlID09IFRZUEVfQ09OVElH\nVU9VUykgewogICAgICAgICAgICAvLyBkbyBub3RoaW5nOyB0aGlzIHNlcSBp\ncyBwYXJ0IG9mIHRoZSBidXNpbmVzcyB0cmFuc2FjdGlvbgogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfSBlbHNlIGlmIChzdXNwZW5kSW5KVEEoKSkg\newogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgVHJhbnNhY3Rp\nb25NYW5hZ2VyIHRtID0gZ2V0Q29uZmlndXJhdGlvbigpCiAgICAgICAgICAg\nICAgICAgICAgLmdldE1hbmFnZWRSdW50aW1lSW5zdGFuY2UoKS5nZXRUcmFu\nc2FjdGlvbk1hbmFnZXIoKTsKICAgICAgICAgICAgICAgIHRtLmNvbW1pdCgp\nOwogICAgICAgICAgICAgICAgdHJ5IHsgY29ubi5jbG9zZSgpOyB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHt9CgogICAgICAgICAgICAgICAgVHJhbnNh\nY3Rpb24gb3V0ZXJUeG4gPSAoVHJhbnNhY3Rpb24pX291dGVyVHJhbnNhY3Rp\nb24uZ2V0KCk7CiAgICAgICAgICAgICAgICBpZiAob3V0ZXJUeG4gIT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICB0bS5yZXN1bWUob3V0ZXJUeG4pOwoK\nICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKTsKICAgICAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIF9vdXRlclRyYW5zYWN0\naW9uLnNldChudWxsKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25uLmNvbW1p\ndCgpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUo\nc2UpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\ndHJ5IHsgY29ubi5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHt9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogRGV0ZWN0IHdoZXRoZXIgb3Igbm90IE9wZW5KUEEgc2hvdWxk\nIHN1c3BlbmQgdGhlIHRyYW5zYWN0aW9uIGluIAogICAgICogYSBtYW5hZ2Vk\nIGVudmlyb25tZW50LgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBz\ndXNwZW5kSW5KVEEoKSB7CiAgICAgICAgcmV0dXJuIGdldENvbmZpZ3VyYXRp\nb24oKS5pc0Nvbm5lY3Rpb25GYWN0b3J5TW9kZU1hbmFnZWQoKSAmJiAKICAg\nICAgICAgICAgZ2V0Q29uZmlndXJhdGlvbigpLmdldENvbm5lY3Rpb25GYWN0\nb3J5MigpID09IG51bGw7CiAgICB9Cn0K\n","encoding":"base64"}

