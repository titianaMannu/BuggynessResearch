{"sha":"00d30264b636b43802f8bca285331d3ebb160ff6","node_id":"MDQ6QmxvYjIwNjM2NDowMGQzMDI2NGI2MzZiNDM4MDJmOGJjYTI4NTMzMWQzZWJiMTYwZmY2","size":14837,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/00d30264b636b43802f8bca285331d3ebb160ff6","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlz\nOwppbXBvcnQgamF2YS51dGlsLkJpdFNldDsKaW1wb3J0IGphdmEudXRpbC5D\nb2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBq\nYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21t\nb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5ldmVudC5SZW1vdGVDb21taXRFdmVudDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5ldmVudC5SZW1vdGVDb21taXRMaXN0ZW5lcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmFi\nbGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3Vy\ncmVudC5BYnN0cmFjdENvbmN1cnJlbnRFdmVudE1hbmFnZXI7CgppbXBvcnQg\nc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogQWJzdHJhY3Qge0BsaW5rIERh\ndGFDYWNoZX0gaW1wbGVtZW50YXRpb24gdGhhdCBwcm92aWRlcyB2YXJpb3Vz\nCiAqIHN0YXRpc3RpY3MsIGxvZ2dpbmcsIGFuZCB0aW1lb3V0IGZ1bmN0aW9u\nYWxpdHkgY29tbW9uIGFjcm9zcyBjYWNoZQogKiBpbXBsZW1lbnRhdGlvbnMu\nCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAqIEBhdXRob3IgQWJl\nIFdoaXRlCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3REYXRh\nQ2FjaGUKICAgIGV4dGVuZHMgQWJzdHJhY3RDb25jdXJyZW50RXZlbnRNYW5h\nZ2VyCiAgICBpbXBsZW1lbnRzIERhdGFDYWNoZSwgQ29uZmlndXJhYmxlIHsK\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBCaXRTZXQgRU1QVFlfQklUU0VU\nID0gbmV3IEJpdFNldCgwKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBM\nb2NhbGl6ZXIgc19sb2MgPQogICAgICAgIExvY2FsaXplci5mb3JQYWNrYWdl\nKEFic3RyYWN0RGF0YUNhY2hlLmNsYXNzKTsKCiAgICAvKioKICAgICAqIFRo\nZSBjb25maWd1cmF0aW9uIHNldCBieSB0aGUgc3lzdGVtLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZjsKCiAgICAv\nKioKICAgICAqIFRoZSBsb2cgdG8gdXNlLgogICAgICovCiAgICBwcm90ZWN0\nZWQgTG9nIGxvZzsKCiAgICBwcml2YXRlIFN0cmluZyBfbmFtZSA9IG51bGw7\nCiAgICBwcml2YXRlIGJvb2xlYW4gX2Nsb3NlZCA9IGZhbHNlOwogICAgcHJp\ndmF0ZSBTdHJpbmcgX3NjaGVkdWxlID0gbnVsbDsKICAgIAogICAgcHJvdGVj\ndGVkIFNldCBfaW5jbHVkZWRUeXBlczsKICAgIHByb3RlY3RlZCBTZXQgX2V4\nY2x1ZGVkVHlwZXM7CgogICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewog\nICAgICAgIHJldHVybiBfbmFtZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXROYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgX25hbWUgPSBuYW1lOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0RXZpY3Rpb25TY2hlZHVsZSgp\nIHsKICAgICAgICByZXR1cm4gX3NjaGVkdWxlOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEV2aWN0aW9uU2NoZWR1bGUoU3RyaW5nIHMpIHsKICAgICAg\nICBfc2NoZWR1bGUgPSBzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluaXRp\nYWxpemUoRGF0YUNhY2hlTWFuYWdlciBtYW5hZ2VyKSB7CiAgICAgICAgaWYg\nKF9zY2hlZHVsZSAhPSBudWxsICYmICEiIi5lcXVhbHMoX3NjaGVkdWxlKSkg\newogICAgICAgICAgICBEYXRhQ2FjaGVTY2hlZHVsZXIgc2NoZWR1bGVyID0g\nbWFuYWdlci5nZXREYXRhQ2FjaGVTY2hlZHVsZXIoKTsKICAgICAgICAgICAg\naWYgKHNjaGVkdWxlciAhPSBudWxsKQogICAgICAgICAgICAgICAgc2NoZWR1\nbGVyLnNjaGVkdWxlRXZpY3Rpb24odGhpcywgX3NjaGVkdWxlKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgY29tbWl0KENvbGxlY3Rpb24g\nYWRkaXRpb25zLCBDb2xsZWN0aW9uIG5ld1VwZGF0ZXMsCiAgICAgICAgQ29s\nbGVjdGlvbiBleGlzdGluZ1VwZGF0ZXMsIENvbGxlY3Rpb24gZGVsZXRlcykg\newogICAgICAgIC8vIHJlbW92ZSBhbGwgb2JqZWN0cyBpbiBkZWxldGVzIGxp\nc3QKICAgICAgICByZW1vdmVBbGxJbnRlcm5hbChkZWxldGVzKTsKCiAgICAg\nICAgLy8gbmV4dCwgYWRkIGFsbCB0aGUgbmV3IGFkZGl0aW9ucwogICAgICAg\nIHB1dEFsbEludGVybmFsKGFkZGl0aW9ucyk7CiAgICAgICAgcHV0QWxsSW50\nZXJuYWwobmV3VXBkYXRlcyk7CgogICAgICAgIC8vIHBvc3NpYmx5IGFkZCB0\naGUgZXhpc3RpbmcgdXBkYXRlcywgZGVwZW5kaW5nIG9uIHRoZQogICAgICAg\nIC8vIHNlbWFudGljcyBvZiB0aGUgY2FjaGUsIGFzIGRpY3RhdGVkIGJ5IHJl\nY2FjaGVVcGRhdGVzKCkKICAgICAgICBpZiAocmVjYWNoZVVwZGF0ZXMoKSkK\nICAgICAgICAgICAgcHV0QWxsSW50ZXJuYWwoZXhpc3RpbmdVcGRhdGVzKTsK\nCiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgIENvbGxlY3Rpb24gYWRkSWRzID0gbmV3IEFycmF5TGlzdChhZGRpdGlv\nbnMuc2l6ZSgpKTsKICAgICAgICAgICAgQ29sbGVjdGlvbiB1cElkcyA9IG5l\ndyBBcnJheUxpc3QobmV3VXBkYXRlcy5zaXplKCkpOwogICAgICAgICAgICBD\nb2xsZWN0aW9uIGV4SWRzID0gbmV3IEFycmF5TGlzdChleGlzdGluZ1VwZGF0\nZXMuc2l6ZSgpKTsKCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9\nIGFkZGl0aW9ucy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTspCiAgICAg\nICAgICAgICAgICBhZGRJZHMuYWRkKCgoRGF0YUNhY2hlUENEYXRhKSBpdGVy\nLm5leHQoKSkuZ2V0SWQoKSk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRlciA9IG5ld1VwZGF0ZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7\nKQogICAgICAgICAgICAgICAgdXBJZHMuYWRkKCgoRGF0YUNhY2hlUENEYXRh\nKSBpdGVyLm5leHQoKSkuZ2V0SWQoKSk7CiAgICAgICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRlciA9IGV4aXN0aW5nVXBkYXRlcy5pdGVyYXRvcigpOyBpdGVy\nLmhhc05leHQoKTspCiAgICAgICAgICAgICAgICBleElkcy5hZGQoKChEYXRh\nQ2FjaGVQQ0RhdGEpIGl0ZXIubmV4dCgpKS5nZXRJZCgpKTsKCiAgICAgICAg\nICAgIGxvZy50cmFjZShzX2xvYy5nZXQoImNhY2hlLWNvbW1pdCIsCiAgICAg\nICAgICAgICAgICBuZXcgT2JqZWN0W117IGFkZElkcywgdXBJZHMsIGV4SWRz\nLCBkZWxldGVzIH0pKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gY29udGFpbnMoT2JqZWN0IGtleSkgewogICAgICAgIERhdGFDYWNo\nZVBDRGF0YSBvID0gZ2V0SW50ZXJuYWwoa2V5KTsKICAgICAgICBpZiAobyAh\nPSBudWxsICYmIG8uaXNUaW1lZE91dCgpKSB7CiAgICAgICAgICAgIG8gPSBu\ndWxsOwogICAgICAgICAgICByZW1vdmVJbnRlcm5hbChrZXkpOwogICAgICAg\nICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAg\nICBsb2cudHJhY2Uoc19sb2MuZ2V0KCJjYWNoZS10aW1lb3V0Iiwga2V5KSk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBvICE9IG51bGw7CiAgICB9Cgog\nICAgcHVibGljIEJpdFNldCBjb250YWluc0FsbChDb2xsZWN0aW9uIGtleXMp\nIHsKICAgICAgICBpZiAoa2V5cy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJl\ndHVybiBFTVBUWV9CSVRTRVQ7CgogICAgICAgIEJpdFNldCBzZXQgPSBuZXcg\nQml0U2V0KGtleXMuc2l6ZSgpKTsKICAgICAgICBpbnQgaSA9IDA7CiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdGVyID0ga2V5cy5pdGVyYXRvcigpOyBpdGVy\nLmhhc05leHQoKTsgaSsrKQogICAgICAgICAgICBpZiAoY29udGFpbnMoaXRl\nci5uZXh0KCkpKQogICAgICAgICAgICAgICAgc2V0LnNldChpKTsKICAgICAg\nICByZXR1cm4gc2V0OwogICAgfQoKICAgIHB1YmxpYyBEYXRhQ2FjaGVQQ0Rh\ndGEgZ2V0KE9iamVjdCBrZXkpIHsKICAgICAgICBEYXRhQ2FjaGVQQ0RhdGEg\nbyA9IGdldEludGVybmFsKGtleSk7CiAgICAgICAgaWYgKG8gIT0gbnVsbCAm\nJiBvLmlzVGltZWRPdXQoKSkgewogICAgICAgICAgICBvID0gbnVsbDsKICAg\nICAgICAgICAgcmVtb3ZlSW50ZXJuYWwoa2V5KTsKICAgICAgICAgICAgaWYg\nKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLnRy\nYWNlKHNfbG9jLmdldCgiY2FjaGUtdGltZW91dCIsIGtleSkpOwogICAgICAg\nIH0KCiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAg\nICAgICAgIGlmIChvID09IG51bGwpCiAgICAgICAgICAgICAgICBsb2cudHJh\nY2Uoc19sb2MuZ2V0KCJjYWNoZS1taXNzIiwga2V5KSk7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIGxvZy50cmFjZShzX2xvYy5nZXQoImNh\nY2hlLWhpdCIsIGtleSkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG87\nCiAgICB9CgogICAgcHVibGljIERhdGFDYWNoZVBDRGF0YSBwdXQoRGF0YUNh\nY2hlUENEYXRhIGRhdGEpIHsKICAgICAgICBEYXRhQ2FjaGVQQ0RhdGEgbyA9\nIHB1dEludGVybmFsKGRhdGEuZ2V0SWQoKSwgZGF0YSk7CiAgICAgICAgaWYg\nKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2Uo\nc19sb2MuZ2V0KCJjYWNoZS1wdXQiLCBkYXRhLmdldElkKCkpKTsKICAgICAg\nICByZXR1cm4gKG8gPT0gbnVsbCB8fCBvLmlzVGltZWRPdXQoKSkgPyBudWxs\nIDogbzsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1cGRhdGUoRGF0YUNhY2hl\nUENEYXRhIGRhdGEpIHsKICAgICAgICBpZiAocmVjYWNoZVVwZGF0ZXMoKSkK\nICAgICAgICAgICAgcHV0SW50ZXJuYWwoZGF0YS5nZXRJZCgpLCBkYXRhKTsK\nICAgIH0KCiAgICBwdWJsaWMgRGF0YUNhY2hlUENEYXRhIHJlbW92ZShPYmpl\nY3Qga2V5KSB7CiAgICAgICAgRGF0YUNhY2hlUENEYXRhIG8gPSByZW1vdmVJ\nbnRlcm5hbChrZXkpOwogICAgICAgIGlmIChvICE9IG51bGwgJiYgby5pc1Rp\nbWVkT3V0KCkpCiAgICAgICAgICAgIG8gPSBudWxsOwogICAgICAgIGlmIChs\nb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICBpZiAobyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgiY2Fj\naGUtcmVtb3ZlLW1pc3MiLCBrZXkpKTsKICAgICAgICAgICAgZWxzZQogICAg\nICAgICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgiY2FjaGUtcmVtb3Zl\nLWhpdCIsIGtleSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbzsKICAg\nIH0KCiAgICBwdWJsaWMgQml0U2V0IHJlbW92ZUFsbChDb2xsZWN0aW9uIGtl\neXMpIHsKICAgICAgICBpZiAoa2V5cy5pc0VtcHR5KCkpCiAgICAgICAgICAg\nIHJldHVybiBFTVBUWV9CSVRTRVQ7CgogICAgICAgIEJpdFNldCBzZXQgPSBu\nZXcgQml0U2V0KGtleXMuc2l6ZSgpKTsKICAgICAgICBpbnQgaSA9IDA7CiAg\nICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0ga2V5cy5pdGVyYXRvcigpOyBp\ndGVyLmhhc05leHQoKTsgaSsrKQogICAgICAgICAgICBpZiAocmVtb3ZlKGl0\nZXIubmV4dCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgc2V0LnNldChp\nKTsKICAgICAgICByZXR1cm4gc2V0OwogICAgfQoKICAgIC8qKgogICAgICog\nUmVtb3ZlIHRoZSBvYmplY3RzIG9mIHRoZSBnaXZlbiBjbGFzcyBmcm9tIHRo\nZSBjYWNoZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVtb3ZlQWxsKENs\nYXNzIGNscywgYm9vbGVhbiBzdWJDbGFzc2VzKSB7CiAgICAgICAgcmVtb3Zl\nQWxsSW50ZXJuYWwoY2xzLCBzdWJDbGFzc2VzKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBwaW4oT2JqZWN0IGtleSkgewogICAgICAgIGJvb2xlYW4g\nYm9vbCA9IHBpbkludGVybmFsKGtleSk7CiAgICAgICAgaWYgKGxvZy5pc1Ry\nYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGlmIChib29sKQogICAgICAg\nICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgiY2FjaGUtcGluLWhpdCIs\nIGtleSkpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsb2cu\ndHJhY2Uoc19sb2MuZ2V0KCJjYWNoZS1waW4tbWlzcyIsIGtleSkpOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gYm9vbDsKICAgIH0KCiAgICBwdWJsaWMg\nQml0U2V0IHBpbkFsbChDb2xsZWN0aW9uIGtleXMpIHsKICAgICAgICBpZiAo\na2V5cy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiBFTVBUWV9CSVRT\nRVQ7CgogICAgICAgIEJpdFNldCBzZXQgPSBuZXcgQml0U2V0KGtleXMuc2l6\nZSgpKTsKICAgICAgICBpbnQgaSA9IDA7CiAgICAgICAgZm9yIChJdGVyYXRv\nciBpdGVyID0ga2V5cy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTsgaSsr\nKQogICAgICAgICAgICBpZiAocGluKGl0ZXIubmV4dCgpKSkKICAgICAgICAg\nICAgICAgIHNldC5zZXQoaSk7CiAgICAgICAgcmV0dXJuIHNldDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBwaW5BbGwoQ2xhc3MgY2xzLCBib29sZWFuIHN1\nYnMpIHsKICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAg\nICAgICAgbG9nLndhcm4oc19sb2MuZ2V0KCJjYWNoZS1jbGFzcy1waW4iLCBn\nZXROYW1lKCkpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiB1bnBpbihP\nYmplY3Qga2V5KSB7CiAgICAgICAgYm9vbGVhbiBib29sID0gdW5waW5JbnRl\ncm5hbChrZXkpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkg\newogICAgICAgICAgICBpZiAoYm9vbCkKICAgICAgICAgICAgICAgIGxvZy50\ncmFjZShzX2xvYy5nZXQoImNhY2hlLXVucGluLWhpdCIsIGtleSkpOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsb2cudHJhY2Uoc19sb2Mu\nZ2V0KCJjYWNoZS11bnBpbi1taXNzIiwga2V5KSk7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBib29sOwogICAgfQoKICAgIHB1YmxpYyBCaXRTZXQgdW5w\naW5BbGwoQ29sbGVjdGlvbiBrZXlzKSB7CiAgICAgICAgaWYgKGtleXMuaXNF\nbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gRU1QVFlfQklUU0VUOwoKICAg\nICAgICBCaXRTZXQgc2V0ID0gbmV3IEJpdFNldChrZXlzLnNpemUoKSk7CiAg\nICAgICAgaW50IGkgPSAwOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9\nIGtleXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7IGkrKykKICAgICAg\nICAgICAgaWYgKHVucGluKGl0ZXIubmV4dCgpKSkKICAgICAgICAgICAgICAg\nIHNldC5zZXQoaSk7CiAgICAgICAgcmV0dXJuIHNldDsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCB1bnBpbkFsbChDbGFzcyBjbHMsIGJvb2xlYW4gc3Vicykg\newogICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAg\nICBsb2cud2FybihzX2xvYy5nZXQoImNhY2hlLWNsYXNzLXVucGluIiwgZ2V0\nTmFtZSgpKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAg\nICAgICAgY2xlYXJJbnRlcm5hbCgpOwogICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgi\nY2FjaGUtY2xlYXIiLCBnZXROYW1lKCkpKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjbG9zZSgpIHsKICAgICAgICBjbG9zZSh0cnVlKTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBjbG9zZShib29sZWFuIGNsZWFyKSB7CiAgICAg\nICAgaWYgKCFfY2xvc2VkKSB7CiAgICAgICAgICAgIGlmIChjbGVhcikKICAg\nICAgICAgICAgICAgIGNsZWFySW50ZXJuYWwoKTsKICAgICAgICAgICAgX2Ns\nb3NlZCA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzQ2xvc2VkKCkgewogICAgICAgIHJldHVybiBfY2xvc2VkOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGFkZEV4cGlyYXRpb25MaXN0ZW5lcihFeHBp\ncmF0aW9uTGlzdGVuZXIgbGlzdGVuKSB7CiAgICAgICAgYWRkTGlzdGVuZXIo\nbGlzdGVuKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVFeHBp\ncmF0aW9uTGlzdGVuZXIoRXhwaXJhdGlvbkxpc3RlbmVyIGxpc3Rlbikgewog\nICAgICAgIHJldHVybiByZW1vdmVMaXN0ZW5lcihsaXN0ZW4pOwogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJu\nICJbIiArIHN1cGVyLnRvU3RyaW5nKCkgKyAiOiIgKyBfbmFtZSArICJdIjsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgbWV0aG9kIGlzIHBhcnQgb2Yg\ndGhlIHtAbGluayBSZW1vdGVDb21taXRMaXN0ZW5lcn0gaW50ZXJmYWNlLiBJ\nZgogICAgICogeW91ciBjYWNoZSBzdWJjbGFzcyByZWxpZXMgb24gT3BlbkpQ\nQSBmb3IgY2x1c3RlcmluZyBzdXBwb3J0LCBtYWtlIGl0CiAgICAgKiBpbXBs\nZW1lbnQgPGNvZGU+UmVtb3RlQ29tbWl0TGlzdGVuZXI8L2NvZGU+LiBUaGlz\nIG1ldGhvZCB3aWxsIHRha2UKICAgICAqIGNhcmUgb2YgaW52YWxpZGF0aW5n\nIGVudHJpZXMgZnJvbSByZW1vdGUgY29tbWl0cy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgYWZ0ZXJDb21taXQoUmVtb3RlQ29tbWl0RXZlbnQgZXZlbnQp\nIHsKICAgICAgICBpZiAoX2Nsb3NlZCkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBpZiAoZXZlbnQuZ2V0UGF5bG9hZFR5cGUoKSA9PSBSZW1vdGVD\nb21taXRFdmVudC5QQVlMT0FEX0VYVEVOVFMpIHsKICAgICAgICAgICAgcmVt\nb3ZlQWxsVHlwZU5hbWVzSW50ZXJuYWwoZXZlbnQuZ2V0VXBkYXRlZFR5cGVO\nYW1lcygpKTsKICAgICAgICAgICAgcmVtb3ZlQWxsVHlwZU5hbWVzSW50ZXJu\nYWwoZXZlbnQuZ2V0RGVsZXRlZFR5cGVOYW1lcygpKTsKICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICAvLyBkcm9wIGFsbCB0aGUgY29tbWl0dGVkIE9J\nRHMsIGV4Y2VwdGluZyBicmFuZAogICAgICAgICAgICAvLyBuZXcgT0lEcy4g\nYnJhbmQgbmV3IE9JRHMgZWl0aGVyIHdvbid0IGJlIGluCiAgICAgICAgICAg\nIC8vIHRoZSBjYWNoZSwgb3IgaWYgdGhleSBhcmUsIHdpbGwgYmUgbW9yZSB1\ncCB0byBkYXRlCiAgICAgICAgICAgIHJlbW92ZUFsbEludGVybmFsKGV2ZW50\nLmdldFVwZGF0ZWRPYmplY3RJZHMoKSk7CiAgICAgICAgICAgIHJlbW92ZUFs\nbEludGVybmFsKGV2ZW50LmdldERlbGV0ZWRPYmplY3RJZHMoKSk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogSW52b2tlIHdoZW4gYSBrZXkg\naXMgcmVtb3ZlZCBmcm9tIHRoaXMgY2FjaGUuIFByb3BhZ2F0ZXMgdGhlCiAg\nICAgKiBleHBpcmF0aW9uIGV2ZW50IG9uIHRvIGFsbCBleHBpcmF0aW9uIGxp\nc3RlbmVycyByZWdpc3RlcmVkCiAgICAgKiB3aXRoIHRoaXMgY2xhc3MuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGtleVJlbW92ZWQoT2JqZWN0IGtl\neSwgYm9vbGVhbiBleHBpcmVkKSB7CiAgICAgICAgLy8gTm90aWZ5IGFueSBl\neHBpcmF0aW9uIGxpc3RlbmVycyBvZiB0aGUgZXhwaXJhdGlvbi4KICAgICAg\nICBpZiAoaGFzTGlzdGVuZXJzKCkpCiAgICAgICAgICAgIGZpcmVFdmVudChu\nZXcgRXhwaXJhdGlvbkV2ZW50KHRoaXMsIGtleSwgZXhwaXJlZCkpOwoKICAg\nICAgICBpZiAoZXhwaXJlZCAmJiBsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAg\nICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgiY2FjaGUtZXhwaXJlZCIs\nIGtleSkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIDxjb2RlPnRy\ndWU8L2NvZGU+IGlmIHVwZGF0ZXMgdG8gZGF0YSBhbHJlYWR5IGluIHRoZQog\nICAgICogY2FjaGUgKGVpdGhlciBpbiB7QGxpbmsgI2NvbW1pdH0gb3IgdGhl\nIHtAbGluayAjdXBkYXRlfSkKICAgICAqIHNob3VsZCBiZSBwdXQgYmFjayBp\nbnRvIHRoZSBjYWNoZS4gUmV0dXJucyBmYWxzZSBieSBkZWZhdWx0LgogICAg\nICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiByZWNhY2hlVXBkYXRlcygpIHsK\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIG9iamVjdCBmb3IgdGhlIGdpdmVuIG9pZC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGFic3RyYWN0IERhdGFDYWNoZVBDRGF0YSBnZXRJbnRl\ncm5hbChPYmplY3Qgb2lkKTsKCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2\nZW4gb2JqZWN0IHRvIHRoZSBjYWNoZSwgcmV0dXJuaW5nIHRoZSBvbGQgb2Jq\nZWN0IHVuZGVyIHRoZQogICAgICogZ2l2ZW4gb2lkLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYWJzdHJhY3QgRGF0YUNhY2hlUENEYXRhIHB1dEludGVybmFs\nKE9iamVjdCBvaWQsCiAgICAgICAgRGF0YUNhY2hlUENEYXRhIHBjKTsKCiAg\nICAvKioKICAgICAqIEFsbCBhbGwgb2YgdGhlIGdpdmVuIG9iamVjdHMgdG8g\ndGhlIGNhY2hlLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwdXRBbGxJ\nbnRlcm5hbChDb2xsZWN0aW9uIHBjcykgewogICAgICAgIERhdGFDYWNoZVBD\nRGF0YSBwYzsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBwY3MuaXRl\ncmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIHBjID0g\nKERhdGFDYWNoZVBDRGF0YSkgaXRlci5uZXh0KCk7CiAgICAgICAgICAgIHB1\ndEludGVybmFsKHBjLmdldElkKCksIHBjKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIG9iamVjdCB1bmRlciB0aGUgZ2l2\nZW4gb2lkIGZyb20gdGhlIGNhY2hlLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nYWJzdHJhY3QgRGF0YUNhY2hlUENEYXRhIHJlbW92ZUludGVybmFsKE9iamVj\ndCBvaWQpOwoKICAgIC8qKgogICAgICogRXZpY3Qgb2JqZWN0cyBpbiBjYWNo\nZSBieSBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IHZv\naWQgcmVtb3ZlQWxsSW50ZXJuYWwoQ2xhc3MgY2xzLCBib29sZWFuIHN1YmNs\nYXNzZXMpOwoKICAgIC8qKgogICAgICogUmVtb3ZlIGFsbCBvYmplY3RzIHVu\nZGVyIHRoZSBnaXZlbiBvaWRzIGZyb20gdGhlIGNhY2hlLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCByZW1vdmVBbGxJbnRlcm5hbChDb2xsZWN0aW9u\nIG9pZHMpIHsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBvaWRzLml0\nZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykKICAgICAgICAgICAgcmVtb3Zl\nSW50ZXJuYWwoaXRlci5uZXh0KCkpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmVtb3ZlIGFsbCBvYmplY3RzIG9mIHRoZSBnaXZlbiBjbGFzcyBuYW1lcyBm\ncm9tIHRoZSBjYWNoZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcmVt\nb3ZlQWxsVHlwZU5hbWVzSW50ZXJuYWwoQ29sbGVjdGlvbiBjbGFzc05hbWVz\nKSB7CiAgICAgICAgQ29sbGVjdGlvbiBjbGFzc2VzID0gQ2FjaGVzLmFkZFR5\ncGVzQnlOYW1lKGNvbmYsIGNsYXNzTmFtZXMsIG51bGwpOwogICAgICAgIGlm\nIChjbGFzc2VzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAg\nICAgQ2xhc3MgY2xzOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGNs\nYXNzZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAg\nICAgIGNscyA9IChDbGFzcykgaXRlci5uZXh0KCk7CiAgICAgICAgICAgIGlm\nIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZy50\ncmFjZShzX2xvYy5nZXQoImNhY2hlLXJlbW92ZWNsYXNzIiwgY2xzLmdldE5h\nbWUoKSkpOwogICAgICAgICAgICByZW1vdmVBbGxJbnRlcm5hbChjbHMsIGZh\nbHNlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciB0\naGUgY2FjaGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCB2b2lk\nIGNsZWFySW50ZXJuYWwoKTsKCiAgICAvKioKICAgICAqIFBpbiBhbiBvYmpl\nY3QgdG8gdGhlIGNhY2hlLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJh\nY3QgYm9vbGVhbiBwaW5JbnRlcm5hbChPYmplY3Qgb2lkKTsKCiAgICAvKioK\nICAgICAqIFVucGluIGFuIG9iamVjdCBmcm9tIHRoZSBjYWNoZS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IGJvb2xlYW4gdW5waW5JbnRlcm5h\nbChPYmplY3Qgb2lkKTsKCiAgICAvLyAtLS0tLS0tLS0tIENvbmZpZ3VyYWJs\nZSBpbXBsZW1lbnRhdGlvbiAtLS0tLS0tLS0tCgogICAgcHVibGljIHZvaWQg\nc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAg\nICB0aGlzLmNvbmYgPSAoT3BlbkpQQUNvbmZpZ3VyYXRpb24pIGNvbmY7CiAg\nICAgICAgdGhpcy5sb2cgPSBjb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJh\ndGlvbi5MT0dfREFUQUNBQ0hFKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\ndGFydENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nZW5kQ29uZmlndXJhdGlvbigpIHsKICAgICAgICBpZiAoX25hbWUgPT0gbnVs\nbCkKICAgICAgICAgICAgc2V0TmFtZShOQU1FX0RFRkFVTFQpOwogICAgfQoK\nICAgIC8vIC0tLS0tLS0tLS0gQWJzdHJhY3RFdmVudE1hbmFnZXIgaW1wbGVt\nZW50YXRpb24gLS0tLS0tLS0tLQoKICAgIHByb3RlY3RlZCB2b2lkIGZpcmVF\ndmVudChPYmplY3QgZXZlbnQsIE9iamVjdCBsaXN0ZW5lcikgewogICAgICAg\nIEV4cGlyYXRpb25MaXN0ZW5lciBsaXN0ZW4gPSAoRXhwaXJhdGlvbkxpc3Rl\nbmVyKSBsaXN0ZW5lcjsKICAgICAgICBFeHBpcmF0aW9uRXZlbnQgZXYgPSAo\nRXhwaXJhdGlvbkV2ZW50KSBldmVudDsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBsaXN0ZW4ub25FeHBpcmUoZXYpOwogICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgbG9nLndhcm4oc19sb2MuZ2V0KCJleHAt\nbGlzdGVuZXItZXgiKSwgZSk7CgkJfQoJfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyB0aGUgb2JqZWN0cyBmb3IgdGhlIGdpdmVuIGtleSBMaXN0LgogICAg\nICovCiAgICBwdWJsaWMgTWFwIGdldEFsbChMaXN0IGtleXMpIHsKICAgICAg\nICBNYXAgcmVzdWx0TWFwID0gbmV3IEhhc2hNYXAoa2V5cy5zaXplKCkpOwog\nICAgICAgIGZvcihpbnQgaT0wOyBpPGtleXMuc2l6ZSgpOyBpKyspCiAgICAg\nICAgICAgIHJlc3VsdE1hcC5wdXQoa2V5cy5nZXQoaSksIGdldChrZXlzLmdl\ndChpKSkpOwogICAgICAgIHJldHVybiByZXN1bHRNYXA7CiAgICB9CiAgICAK\nICAgIHB1YmxpYyBTZXQgZ2V0VHlwZXMoKSB7CiAgICAgICAgcmV0dXJuIF9p\nbmNsdWRlZFR5cGVzOwogICAgfQogICAgCiAgICBwdWJsaWMgU2V0IGdldEV4\nY2x1ZGVkVHlwZXMoKSB7CiAgICAgICAgcmV0dXJuIF9leGNsdWRlZFR5cGVz\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFR5cGVzKFNldCB0eXBlcykg\newogICAgICAgIF9pbmNsdWRlZFR5cGVzID0gdHlwZXM7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0VHlwZXMoU3RyaW5nIHR5cGVzKSB7CiAgICAgICAg\nX2luY2x1ZGVkVHlwZXMgPQogICAgICAgICAgICBTdHJpbmdVdGlscy5pc0Vt\ncHR5KHR5cGVzKSA/IG51bGwgOiBuZXcgSGFzaFNldChBcnJheXMKICAgICAg\nICAgICAgICAgIC5hc0xpc3QoU3RyaW5ncy5zcGxpdCh0eXBlcywgIjsiLCAw\nKSkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEV4Y2x1ZGVkVHlwZXMo\nU2V0IHR5cGVzKSB7CiAgICAgICAgX2V4Y2x1ZGVkVHlwZXMgPSB0eXBlczsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFeGNsdWRlZFR5cGVzKFN0cmlu\nZyB0eXBlcykgewogICAgICAgIF9leGNsdWRlZFR5cGVzID0KICAgICAgICAg\nICAgU3RyaW5nVXRpbHMuaXNFbXB0eSh0eXBlcykgPyBudWxsIDogbmV3IEhh\nc2hTZXQoQXJyYXlzCiAgICAgICAgICAgICAgICAuYXNMaXN0KFN0cmluZ3Mu\nc3BsaXQodHlwZXMsICI7IiwgMCkpKTsKICAgIH0KfQo=\n","encoding":"base64"}

