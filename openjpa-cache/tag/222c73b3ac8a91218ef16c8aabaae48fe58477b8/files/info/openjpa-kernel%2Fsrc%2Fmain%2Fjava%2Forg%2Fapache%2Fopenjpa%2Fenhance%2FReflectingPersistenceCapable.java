{"sha":"daf5d060d3c3d6d0d77c4717a8ce420fd9d58def","node_id":"MDQ6QmxvYjIwNjM2NDpkYWY1ZDA2MGQzYzNkNmQwZDc3YzQ3MTdhOGNlNDIwZmQ5ZDU4ZGVm","size":11922,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/daf5d060d3c3d6d0d77c4717a8ce420fd9d58def","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlOwoKaW1wb3J0IGphdmEu\nbGFuZy5yZWZsZWN0LkZpZWxkOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nTWV0aG9kOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZh\nVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1l\ndGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQ\nQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5BcHBsaWNhdGlvbklkczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuT2JqZWN0SWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlN0YXRlTWFuYWdlckltcGw7CgovKioKICogSW1wbGVtZW50YXRp\nb24gb2YgdGhlIHtAbGluayBQZXJzaXN0ZW5jZUNhcGFibGV9IGludGVyZmFj\nZSB0aGF0IGNhbiBoYW5kbGUKICogdGhlIHBlcnNpc3RlbmNlLWNhcGFibGUg\nY29udHJhY3QgZm9yIGluc3RhbmNlcyB0aGF0IHdlcmUgbm90IGVuaGFuY2Vk\nCiAqIGJlZm9yZSBjbGFzcyBsb2FkIHRpbWUuCiAqCiAqIEBzaW5jZSAxLjAu\nMAogKi8KcHVibGljIGNsYXNzIFJlZmxlY3RpbmdQZXJzaXN0ZW5jZUNhcGFi\nbGUKICAgIGltcGxlbWVudHMgUGVyc2lzdGVuY2VDYXBhYmxlLCBNYW5hZ2Vk\nSW5zdGFuY2VQcm92aWRlciB7CgogICAgcHJpdmF0ZSBPYmplY3QgbzsKICAg\nIHByaXZhdGUgU3RhdGVNYW5hZ2VyIHNtOwogICAgcHJpdmF0ZSBQZXJzaXN0\nZW5jZUNhcGFibGUgcGNTdWJjbGFzc0luc3RhbmNlOwogICAgcHJpdmF0ZSBD\nbGFzc01ldGFEYXRhIG1ldGE7CgogICAgcHVibGljIFJlZmxlY3RpbmdQZXJz\naXN0ZW5jZUNhcGFibGUoT2JqZWN0IG8sIE9wZW5KUEFDb25maWd1cmF0aW9u\nIGNvbmYpIHsKICAgICAgICB0aGlzLm8gPSBvOwogICAgICAgIENsYXNzIHR5\ncGUgPSBvLmdldENsYXNzKCk7CiAgICAgICAgcGNTdWJjbGFzc0luc3RhbmNl\nID0gUENSZWdpc3RyeS5uZXdJbnN0YW5jZSh0eXBlLCBudWxsLCBmYWxzZSk7\nCiAgICAgICAgbWV0YSA9IGNvbmYuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5z\ndGFuY2UoKQogICAgICAgICAgICAuZ2V0TWV0YURhdGEodHlwZSwgbnVsbCwg\ndHJ1ZSk7CiAgICB9CgogICAgcHVibGljIGludCBwY0dldEVuaGFuY2VtZW50\nQ29udHJhY3RWZXJzaW9uKCkgewogICAgICAgIHJldHVybiBQQ0VuaGFuY2Vy\nLkVOSEFOQ0VSX1ZFUlNJT047CiAgICB9CgogICAgcHVibGljIE9iamVjdCBw\nY0dldEdlbmVyaWNDb250ZXh0KCkgewogICAgICAgIGlmIChzbSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIHJldHVybiBzbS5nZXRHZW5lcmljQ29udGV4dCgpOwogICAgfQoK\nICAgIHB1YmxpYyBTdGF0ZU1hbmFnZXIgcGNHZXRTdGF0ZU1hbmFnZXIoKSB7\nCiAgICAgICAgcmV0dXJuIHNtOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBj\nUmVwbGFjZVN0YXRlTWFuYWdlcihTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAg\nICB0aGlzLnNtID0gc207CiAgICB9CgogICAgcHVibGljIHZvaWQgcGNQcm92\naWRlRmllbGQoaW50IGkpIHsKICAgICAgICBzd2l0Y2ggKG1ldGEuZ2V0Rmll\nbGQoaSkuZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5CT09MRUFOOgogICAgICAgICAgICAgICAgc20ucHJvdmlkZWRCb29s\nZWFuRmllbGQodGhpcywgaSwKICAgICAgICAgICAgICAgICAgICAoKEJvb2xl\nYW4pIGdldFZhbHVlKGksIG8pKS5ib29sZWFuVmFsdWUoKSk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllU\nRToKICAgICAgICAgICAgICAgIHNtLnByb3ZpZGVkQnl0ZUZpZWxkKHRoaXMs\nIGksCiAgICAgICAgICAgICAgICAgICAgKChCeXRlKSBnZXRWYWx1ZShpLCBv\nKSkuYnl0ZVZhbHVlKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgICAgICBz\nbS5wcm92aWRlZENoYXJGaWVsZCh0aGlzLCBpLAogICAgICAgICAgICAgICAg\nICAgICgoQ2hhcmFjdGVyKSBnZXRWYWx1ZShpLCBvKSkuY2hhclZhbHVlKCkp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkRPVUJMRToKICAgICAgICAgICAgICAgIHNtLnByb3ZpZGVkRG91\nYmxlRmllbGQodGhpcywgaSwKICAgICAgICAgICAgICAgICAgICAoKERvdWJs\nZSkgZ2V0VmFsdWUoaSwgbykpLmRvdWJsZVZhbHVlKCkpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FU\nOgogICAgICAgICAgICAgICAgc20ucHJvdmlkZWRGbG9hdEZpZWxkKHRoaXMs\nIGksCiAgICAgICAgICAgICAgICAgICAgKChGbG9hdCkgZ2V0VmFsdWUoaSwg\nbykpLmZsb2F0VmFsdWUoKSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UOgogICAgICAgICAgICAgICAg\nc20ucHJvdmlkZWRJbnRGaWVsZCh0aGlzLCBpLAogICAgICAgICAgICAgICAg\nICAgICgoSW50ZWdlcikgZ2V0VmFsdWUoaSwgbykpLmludFZhbHVlKCkpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkxPTkc6CiAgICAgICAgICAgICAgICBzbS5wcm92aWRlZExvbmdGaWVs\nZCh0aGlzLCBpLAogICAgICAgICAgICAgICAgICAgICgoTG9uZykgZ2V0VmFs\ndWUoaSwgbykpLmxvbmdWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVDoKICAgICAgICAg\nICAgICAgIHNtLnByb3ZpZGVkU2hvcnRGaWVsZCh0aGlzLCBpLAogICAgICAg\nICAgICAgICAgICAgICgoU2hvcnQpIGdldFZhbHVlKGksIG8pKS5zaG9ydFZh\nbHVlKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLlNUUklORzoKICAgICAgICAgICAgICAgIHNtLnByb3Zp\nZGVkU3RyaW5nRmllbGQodGhpcywgaSwKICAgICAgICAgICAgICAgICAgICAo\nU3RyaW5nKSBnZXRWYWx1ZShpLCBvKSk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHNtLnBy\nb3ZpZGVkT2JqZWN0RmllbGQodGhpcywgaSwgZ2V0VmFsdWUoaSwgbykpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHBjUHJvdmlkZUZpZWxkcyhpbnRbXSBmaWVsZEluZGljZXMp\nIHsKICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgZmllbGRJbmRpY2VzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICBwY1Byb3ZpZGVGaWVsZChmaWVsZElu\nZGljZXNbaV0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBjUmVwbGFjZUZp\nZWxkKGludCBpKSB7CiAgICAgICAgc3dpdGNoKG1ldGEuZ2V0RmllbGQoaSku\nZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5C\nT09MRUFOOgogICAgICAgICAgICAgICAgc2V0VmFsdWUoaSwgbywgQm9vbGVh\nbi52YWx1ZU9mKAogICAgICAgICAgICAgICAgICAgIHNtLnJlcGxhY2VCb29s\nZWFuRmllbGQodGhpcywgaSkpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAgICAgICAgICAg\nICAgc2V0VmFsdWUoaSwgbywgbmV3IEJ5dGUoc20ucmVwbGFjZUJ5dGVGaWVs\nZCh0aGlzLCBpKSkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgICAgICBzZXRW\nYWx1ZShpLCBvLCBuZXcgQ2hhcmFjdGVyKHNtLnJlcGxhY2VDaGFyRmllbGQo\ndGhpcywgaSkpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAgICAgICAgICAgICAgICBzZXRW\nYWx1ZShpLCBvLCBuZXcgRG91YmxlKHNtLnJlcGxhY2VEb3VibGVGaWVsZCh0\naGlzLCBpKSkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICAgICAgc2V0VmFs\ndWUoaSwgbywgbmV3IEZsb2F0KHNtLnJlcGxhY2VGbG9hdEZpZWxkKHRoaXMs\nIGkpKSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuSU5UOgogICAgICAgICAgICAgICAgc2V0VmFsdWUoaSwg\nbywgbmV3IEludGVnZXIoc20ucmVwbGFjZUludEZpZWxkKHRoaXMsIGkpKSk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuTE9ORzoKICAgICAgICAgICAgICAgIHNldFZhbHVlKGksIG8sIG5l\ndyBMb25nKHNtLnJlcGxhY2VMb25nRmllbGQodGhpcywgaSkpKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5T\nSE9SVDoKICAgICAgICAgICAgICAgIHNldFZhbHVlKGksIG8sIG5ldyBTaG9y\ndChzbS5yZXBsYWNlU2hvcnRGaWVsZCh0aGlzLCBpKSkpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklO\nRzoKICAgICAgICAgICAgICAgIHNldFZhbHVlKGksIG8sIHNtLnJlcGxhY2VT\ndHJpbmdGaWVsZCh0aGlzLCBpKSk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHNldFZhbHVl\nKGksIG8sIHNtLnJlcGxhY2VPYmplY3RGaWVsZCh0aGlzLCBpKSk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgcGNSZXBsYWNlRmllbGRzKGludFtdIGZpZWxkSW5kaWNlcykgewog\nICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCBmaWVsZEluZGljZXMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIHBjUmVwbGFjZUZpZWxkKGZpZWxkSW5kaWNl\nc1tpXSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcGNDb3B5RmllbGQoT2Jq\nZWN0IGZyb21PYmplY3QsIGludCBpKSB7CiAgICAgICAgLy8gdGhpcyBkb2Vz\nbid0IG5lZWQgc3dpdGNoIHRyZWF0bWVudCBiZWNhdXNlIHdlJ3JlIGp1c3QK\nICAgICAgICAvLyByZWZsZWN0aW5nIG9uIGJvdGggc2lkZXMsIGJ5cGFzc2lu\nZyBmaWVsZCBtYW5hZ2Vycy4KICAgICAgICBzZXRWYWx1ZShpLCBvLCBnZXRW\nYWx1ZShpLCBmcm9tT2JqZWN0KSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncGNDb3B5RmllbGRzKE9iamVjdCBmcm9tT2JqZWN0LCBpbnRbXSBmaWVsZElu\nZGljZXMpIHsKICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgZmllbGRJbmRp\nY2VzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBwY0NvcHlGaWVsZChmcm9t\nT2JqZWN0LCBmaWVsZEluZGljZXNbaV0pOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHBjRGlydHkoU3RyaW5nIGZpZWxkTmFtZSkgewogICAgICAgIGlmIChz\nbSAhPSBudWxsKQogICAgICAgICAgICBzbS5kaXJ0eShmaWVsZE5hbWUpOwog\nICAgfQoKICAgIHB1YmxpYyBPYmplY3QgcGNGZXRjaE9iamVjdElkKCkgewog\nICAgICAgIGlmIChzbSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gc20u\nZmV0Y2hPYmplY3RJZCgpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBwY0dldFZlcnNp\nb24oKSB7CiAgICAgICAgaWYgKHNtID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIHNt\nLmdldFZlcnNpb24oKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBwY0lz\nRGlydHkoKSB7CiAgICAgICAgaWYgKHNtID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYg\nKHNtIGluc3RhbmNlb2YgU3RhdGVNYW5hZ2VySW1wbCkKICAgICAgICAgICAg\nICAgICgoU3RhdGVNYW5hZ2VySW1wbCkgc20pLmRpcnR5Q2hlY2soKTsKICAg\nICAgICAgICAgcmV0dXJuIHNtLmlzRGlydHkoKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gcGNJc1RyYW5zYWN0aW9uYWwoKSB7CiAg\nICAgICAgaWYgKHNtID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBzbS5pc1RyYW5z\nYWN0aW9uYWwoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBwY0lzUGVy\nc2lzdGVudCgpIHsKICAgICAgICBpZiAoc20gPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0\ndXJuIHNtLmlzUGVyc2lzdGVudCgpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIHBjSXNOZXcoKSB7CiAgICAgICAgaWYgKHNtID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIHJldHVybiBzbS5pc05ldygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHBjSXNEZWxldGVkKCkgewogICAgICAgIGlmIChzbSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZQogICAgICAgICAg\nICByZXR1cm4gc20uaXNEZWxldGVkKCk7CiAgICB9CgogICAgLy8gbnVsbCA9\nPSB1bmtub3duCiAgICBwdWJsaWMgQm9vbGVhbiBwY0lzRGV0YWNoZWQoKSB7\nCiAgICAgICAgaWYgKHNtICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBC\nb29sZWFuLnZhbHVlT2Yoc20uaXNEZXRhY2hlZCgpKTsKCiAgICAgICAgLy8g\nIyMjIyMgd2UgY291bGQgZG8gYSBsb3QgbW9yZSBoZXJlIGlmIGEgZGV0YWNo\nZWQgc3RhdGUgZmllbGQKICAgICAgICAvLyAjIyMjIyB3YXMgc3BlY2lmaWVk\nLgogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBQZXJz\naXN0ZW5jZUNhcGFibGUgcGNOZXdJbnN0YW5jZShTdGF0ZU1hbmFnZXIgc20s\nIGJvb2xlYW4gY2xlYXIpIHsKICAgICAgICByZXR1cm4gcGNTdWJjbGFzc0lu\nc3RhbmNlLnBjTmV3SW5zdGFuY2Uoc20sIGNsZWFyKTsKICAgIH0KCiAgICBw\ndWJsaWMgUGVyc2lzdGVuY2VDYXBhYmxlIHBjTmV3SW5zdGFuY2UoU3RhdGVN\nYW5hZ2VyIHNtLCBPYmplY3Qgb2lkLAogICAgICAgIGJvb2xlYW4gY2xlYXIp\nIHsKICAgICAgICByZXR1cm4gcGNTdWJjbGFzc0luc3RhbmNlLnBjTmV3SW5z\ndGFuY2Uoc20sIG9pZCwgY2xlYXIpOwogICAgfQoKICAgIHB1YmxpYyBPYmpl\nY3QgcGNOZXdPYmplY3RJZEluc3RhbmNlKCkgewogICAgICAgIEZpZWxkTWV0\nYURhdGFbXSBwa0ZpZWxkcyA9IG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygp\nOwogICAgICAgIE9iamVjdFtdIHBrcyA9IG5ldyBPYmplY3RbcGtGaWVsZHMu\nbGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBrRmllbGRz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBwa3NbaV0gPSBnZXRWYWx1ZShw\na0ZpZWxkc1tpXS5nZXRJbmRleCgpLCBvKTsKICAgICAgICByZXR1cm4gQXBw\nbGljYXRpb25JZHMuZnJvbVBLVmFsdWVzKHBrcywgbWV0YSk7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyBPYmplY3QgcGNOZXdPYmplY3RJZEluc3RhbmNlKE9i\namVjdCBvaWQpIHsKICAgICAgICByZXR1cm4gcGNTdWJjbGFzc0luc3RhbmNl\nLnBjTmV3T2JqZWN0SWRJbnN0YW5jZShvaWQpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHBjQ29weUtleUZpZWxkc1RvT2JqZWN0SWQoT2JqZWN0IG9pZCkg\newogICAgICAgIE9iamVjdCB0YXJnZXQ7CiAgICAgICAgaWYgKG9pZCBpbnN0\nYW5jZW9mIE9iamVjdElkKQogICAgICAgICAgICB0YXJnZXQgPSAoKE9iamVj\ndElkKSBvaWQpLmdldElkKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICB0\nYXJnZXQgPSBvaWQ7CgogICAgICAgIEZpZWxkTWV0YURhdGFbXSBwa3MgPSBt\nZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHBrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBPYmpl\nY3QgdmFsID0gZ2V0VmFsdWUocGtzW2ldLmdldEluZGV4KCksIG8pOwogICAg\nICAgICAgICBGaWVsZCBmID0gUmVmbGVjdGlvbi5maW5kRmllbGQodGFyZ2V0\nLmdldENsYXNzKCksIHBrc1tpXS5nZXROYW1lKCksCiAgICAgICAgICAgICAg\nICB0cnVlKTsKICAgICAgICAgICAgUmVmbGVjdGlvbi5zZXQodGFyZ2V0LCBm\nLCB2YWwpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwY0Nv\ncHlLZXlGaWVsZHNUb09iamVjdElkKEZpZWxkU3VwcGxpZXIgc3VwcGxpZXIs\nIE9iamVjdCBvYmopIHsKICAgICAgICAvLyBUaGlzIGlzIG9ubHkgZXZlciBp\nbnZva2VkIGFnYWluc3QgUENzIGluIHRoZSBQQ1JlZ2lzdHJ5LiBTdWNoIFBD\ncwogICAgICAgIC8vIHdpbGwgYWx3YXlzIGJlIGVuaGFuY2VkIHR5cGVzIG9y\nIHN1YnR5cGVzIG9mIHVzZXIgdHlwZXMsIGFuZCB3aWxsCiAgICAgICAgLy8g\nbmV2ZXIgYmUgYSBSZWZsZWN0aW5nUGVyc2lzdGVuY2VDYXBhYmxlLgogICAg\nICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHBjQ29weUtleUZpZWxkc0Zyb21PYmplY3RJZChGaWVs\nZENvbnN1bWVyIGNvbnN1bWVyLAogICAgICAgIE9iamVjdCBvYmopIHsKICAg\nICAgICAvLyBUaGlzIGlzIG9ubHkgZXZlciBpbnZva2VkIGFnYWluc3QgUENz\nIGluIHRoZSBQQ1JlZ2lzdHJ5LiBTdWNoIFBDcwogICAgICAgIC8vIHdpbGwg\nYWx3YXlzIGJlIGVuaGFuY2VkIHR5cGVzIG9yIHN1YnR5cGVzIG9mIHVzZXIg\ndHlwZXMsIGFuZCB3aWxsCiAgICAgICAgLy8gbmV2ZXIgYmUgYSBSZWZsZWN0\naW5nUGVyc2lzdGVuY2VDYXBhYmxlLgogICAgICAgIHRocm93IG5ldyBJbnRl\ncm5hbEV4Y2VwdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgcGNH\nZXREZXRhY2hlZFN0YXRlKCkgewogICAgICAgIC8vICMjIyMjIHdlIGNhbiBp\nbXBsZW1lbnQgdGhpcyBpZiBhIHN0YXRlIGZpZWxkIGhhcyBiZWVuIHNldAog\nICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBj\nU2V0RGV0YWNoZWRTdGF0ZShPYmplY3Qgc3RhdGUpIHsKICAgICAgICAvLyBT\ndGF0ZU1hbmFnZXJJbXBsIHdpbGwgaW52b2tlIHRoaXMgd2l0aCBudWxsIGR1\ncmluZyBpbnN0YW5jZQogICAgICAgIC8vIGluaXRpYWxpemF0aW9uCiAgICAg\nICAgaWYgKHN0YXRlICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBV\nbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOwogICAgICAgIC8vICMj\nIyMjIHdlIGNhbiBpbXBsZW1lbnQgdGhpcyBpZiBhIHN0YXRlIGZpZWxkIGhh\ncyBiZWVuIHNldAogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0TWFuYWdl\nZEluc3RhbmNlKCkgewogICAgICAgIHJldHVybiBvOwogICAgfQoKICAgIHBy\naXZhdGUgT2JqZWN0IGdldFZhbHVlKGludCBpLCBPYmplY3QgbykgewogICAg\nICAgIGlmIChtZXRhLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFzc01ldGFEYXRh\nLkFDQ0VTU19QUk9QRVJUWSkgewogICAgICAgICAgICBpZiAoIW1ldGEuaXNJ\nbnRlcmNlcHRpbmcoKSkgewogICAgICAgICAgICAgICAgTWV0aG9kIG1ldGgg\nPSBSZWZsZWN0aW9uLmZpbmRHZXR0ZXIobWV0YS5nZXREZXNjcmliZWRUeXBl\nKCksCiAgICAgICAgICAgICAgICAgICAgbWV0YS5nZXRGaWVsZChpKS5nZXRO\nYW1lKCksIHRydWUpOwogICAgICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3Rp\nb24uZ2V0KG8sIG1ldGgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgRmllbGQgZmllbGQgPSBSZWZsZWN0aW9uLmZpbmRGaWVsZCht\nZXRhLmdldERlc2NyaWJlZFR5cGUoKSwKICAgICAgICAgICAgICAgICAgICB0\nb0ZpZWxkTmFtZShpKSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nUmVmbGVjdGlvbi5nZXQobywgZmllbGQpOwogICAgICAgICAgICB9CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgRmllbGQgZmllbGQgPSAoRmllbGQp\nIG1ldGEuZ2V0RmllbGQoaSkuZ2V0QmFja2luZ01lbWJlcigpOwogICAgICAg\nICAgICByZXR1cm4gUmVmbGVjdGlvbi5nZXQobywgZmllbGQpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwcml2YXRlIFN0cmluZyB0b0ZpZWxkTmFtZShpbnQg\naSkgewogICAgICAgIGlmIChwY1N1YmNsYXNzSW5zdGFuY2UgaW5zdGFuY2Vv\nZiBBdHRyaWJ1dGVUcmFuc2xhdG9yKQogICAgICAgICAgICByZXR1cm4gKChB\ndHRyaWJ1dGVUcmFuc2xhdG9yKSBwY1N1YmNsYXNzSW5zdGFuY2UpCiAgICAg\nICAgICAgICAgICAucGNBdHRyaWJ1dGVJbmRleFRvRmllbGROYW1lKGkpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIG1ldGEuZ2V0RmllbGQo\naSkuZ2V0TmFtZSgpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzZXRWYWx1\nZShpbnQgaSwgT2JqZWN0IG8sIE9iamVjdCB2YWwpIHsKICAgICAgICBpZiAo\nbWV0YS5nZXRBY2Nlc3NUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1Nf\nUFJPUEVSVFkpIHsKICAgICAgICAgICAgaWYgKCFtZXRhLmlzSW50ZXJjZXB0\naW5nKCkpIHsKICAgICAgICAgICAgICAgIE1ldGhvZCBtZXRoID0gUmVmbGVj\ndGlvbi5maW5kU2V0dGVyKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLAogICAg\nICAgICAgICAgICAgICAgIG1ldGEuZ2V0RmllbGQoaSkuZ2V0TmFtZSgpLCB0\ncnVlKTsKICAgICAgICAgICAgICAgIFJlZmxlY3Rpb24uc2V0KG8sIG1ldGgs\nIHZhbCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBG\naWVsZCBmaWVsZCA9IFJlZmxlY3Rpb24uZmluZEZpZWxkKG1ldGEuZ2V0RGVz\nY3JpYmVkVHlwZSgpLAogICAgICAgICAgICAgICAgICAgIHRvRmllbGROYW1l\nKGkpLCB0cnVlKTsKICAgICAgICAgICAgICAgIFJlZmxlY3Rpb24uc2V0KG8s\nIGZpZWxkLCB2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgRmllbGQgZmllbGQgPSAoRmllbGQpIG1ldGEuZ2V0Rmll\nbGQoaSkuZ2V0QmFja2luZ01lbWJlcigpOwogICAgICAgICAgICBSZWZsZWN0\naW9uLnNldChvLCBmaWVsZCwgdmFsKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

