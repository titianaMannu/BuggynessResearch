{"sha":"42d08d0e1ba505812e1f9199dcd7954f915b47ef","node_id":"MDQ6QmxvYjIwNjM2NDo0MmQwOGQwZTFiYTUwNTgxMmUxZjkxOTlkY2Q3OTU0ZjkxNWI0N2Vm","size":48201,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/42d08d0e1ba505812e1f9199dcd7954f915b47ef","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmM7CgppbXBvcnQg\namF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUmVhZGVyOwpp\nbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9ydCBqYXZhLnNxbC5B\ncnJheTsKaW1wb3J0IGphdmEuc3FsLkJhdGNoVXBkYXRlRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS5zcWwuQmxvYjsKaW1wb3J0IGphdmEuc3FsLkNsb2I7Cmlt\ncG9ydCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuRGF0\nYWJhc2VNZXRhRGF0YTsKaW1wb3J0IGphdmEuc3FsLkRhdGU7CmltcG9ydCBq\nYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLlJl\nZjsKaW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3Fs\nLlJlc3VsdFNldE1ldGFEYXRhOwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwppbXBvcnQgamF2YS5zcWwuU1FMV2FybmluZzsKaW1wb3J0IGphdmEu\nc3FsLlNhdmVwb2ludDsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1w\nb3J0IGphdmEuc3FsLlRpbWU7CmltcG9ydCBqYXZhLnNxbC5UaW1lc3RhbXA7\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5DYWxlbmRhcjsKaW1wb3J0IGph\ndmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKCi8q\nKgogKiBBIHtAbGluayBDb25uZWN0aW9uRGVjb3JhdG9yfSB0aGF0IGNyZWF0\nZXMgbG9nZ2luZyBjb25uZWN0aW9ucyBhbmQKICoge0BsaW5rIFJlcG9ydGlu\nZ1NRTEV4Y2VwdGlvbn1zLgogKgogKiBAYXV0aG9yIE1hcmMgUHJ1ZCdob21t\nZWF1eAogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgTG9nZ2luZ0Nv\nbm5lY3Rpb25EZWNvcmF0b3IgaW1wbGVtZW50cyBDb25uZWN0aW9uRGVjb3Jh\ndG9yIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgU0VQID0g\nSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFyYXRvcigpOwoKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIGludCBXQVJOX0lHTk9SRSA9IDA7CiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBpbnQgV0FSTl9MT0dfVFJBQ0UgPSAxOwogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFdBUk5fTE9HX0lORk8gPSAyOwog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFdBUk5fTE9HX1dBUk4gPSAz\nOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IFdBUk5fTE9HX0VSUk9S\nID0gNDsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBXQVJOX1RIUk9X\nID0gNTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBXQVJOX0hBTkRM\nRSA9IDY7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBXQVJO\nSU5HX0FDVElPTlMgPSBuZXcgU3RyaW5nWzddOwoKICAgIHN0YXRpYyB7CiAg\nICAgICAgV0FSTklOR19BQ1RJT05TW1dBUk5fSUdOT1JFXSA9ICJpZ25vcmUi\nOwogICAgICAgIFdBUk5JTkdfQUNUSU9OU1tXQVJOX0xPR19UUkFDRV0gPSAi\ndHJhY2UiOwogICAgICAgIFdBUk5JTkdfQUNUSU9OU1tXQVJOX0xPR19JTkZP\nXSA9ICJpbmZvIjsKICAgICAgICBXQVJOSU5HX0FDVElPTlNbV0FSTl9MT0df\nV0FSTl0gPSAid2FybiI7CiAgICAgICAgV0FSTklOR19BQ1RJT05TW1dBUk5f\nTE9HX0VSUk9SXSA9ICJlcnJvciI7CiAgICAgICAgV0FSTklOR19BQ1RJT05T\nW1dBUk5fVEhST1ddID0gInRocm93IjsKICAgICAgICBXQVJOSU5HX0FDVElP\nTlNbV0FSTl9IQU5ETEVdID0gImhhbmRsZSI7CiAgICB9CgogICAgcHJpdmF0\nZSBmaW5hbCBEYXRhU291cmNlTG9ncyBfbG9ncyA9IG5ldyBEYXRhU291cmNl\nTG9ncygpOwogICAgcHJpdmF0ZSBTUUxGb3JtYXR0ZXIgX2Zvcm1hdHRlcjsK\nICAgIHByaXZhdGUgYm9vbGVhbiBfcHJldHR5UHJpbnQ7CiAgICBwcml2YXRl\nIGludCBfcHJldHR5UHJpbnRMaW5lTGVuZ3RoID0gNjA7CiAgICBwcml2YXRl\nIGludCBfd2FybmluZ0FjdGlvbiA9IFdBUk5fSUdOT1JFOwogICAgcHJpdmF0\nZSBTUUxXYXJuaW5nSGFuZGxlciBfd2FybmluZ0hhbmRsZXI7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX3RyYWNrUGFyYW1ldGVycyA9IHRydWU7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX3ByaW50UGFyYW1ldGVycyA9IGZhbHNlOwoKICAgIC8q\nKgogICAgICogSWYgc2V0IHRvIDxjb2RlPnRydWU8L2NvZGU+LCBwcmV0dHkt\ncHJpbnQgU1FMIGJ5IHJ1bm5pbmcgaXQKICAgICAqIHRocm91Z2gge0BsaW5r\nIFNRTEZvcm1hdHRlciNwcmV0dHlQcmludH0uIElmCiAgICAgKiA8Y29kZT5m\nYWxzZTwvY29kZT4sIGRvbid0IHByZXR0eS1wcmludCwgYW5kIG91dHB1dCBT\nUUwgbG9ncyBpbgogICAgICogYSBzaW5nbGUgbGluZS4gUHJldHR5LXByaW50\nZWQgU1FMIGNhbiBiZSBlYXNpZXIgZm9yIGEgaHVtYW4gdG8KICAgICAqIHJl\nYWQsIGJ1dCBpcyBoYXJkZXIgdG8gcGFyc2Ugd2l0aCB0b29scyBsaWtlIGdy\nZXAuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByZXR0eVByaW50KGJv\nb2xlYW4gcHJldHR5UHJpbnQpIHsKICAgICAgICBfcHJldHR5UHJpbnQgPSBw\ncmV0dHlQcmludDsKICAgICAgICBpZiAoX2Zvcm1hdHRlciA9PSBudWxsICYm\nIF9wcmV0dHlQcmludCkgewogICAgICAgICAgICBfZm9ybWF0dGVyID0gbmV3\nIFNRTEZvcm1hdHRlcigpOwogICAgICAgICAgICBfZm9ybWF0dGVyLnNldExp\nbmVMZW5ndGgoX3ByZXR0eVByaW50TGluZUxlbmd0aCk7CiAgICAgICAgfSBl\nbHNlIGlmICghX3ByZXR0eVByaW50KQogICAgICAgICAgICBfZm9ybWF0dGVy\nID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgI3NldFByZXR0\neVByaW50CiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldFByZXR0eVBy\naW50KCkgewogICAgICAgIHJldHVybiBfcHJldHR5UHJpbnQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgdG8gcHJp\nbnQgcGVyIGxpbmUgd2hlbgogICAgICogcHJldHR5LXByaW50aW5nIG9mIFNR\nTCBpcyBlbmFibGVkLiBEZWZhdWx0cyB0byA2MCB0byBwcm92aWRlCiAgICAg\nKiBzb21lIHNwYWNlIGZvciBhbnkgYW50LXJlbGF0ZWQgY2hhcmFjdGVycyBv\nbiB0aGUgbGVmdCBvZiBhCiAgICAgKiBzdGFuZGFyZCA4MC1jaGFyYWN0ZXIg\nZGlzcGxheS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJldHR5UHJp\nbnRMaW5lTGVuZ3RoKGludCBsZW5ndGgpIHsKICAgICAgICBfcHJldHR5UHJp\nbnRMaW5lTGVuZ3RoID0gbGVuZ3RoOwogICAgICAgIGlmIChfZm9ybWF0dGVy\nICE9IG51bGwpCiAgICAgICAgICAgIF9mb3JtYXR0ZXIuc2V0TGluZUxlbmd0\naChsZW5ndGgpOwogICAgfQoKICAgIC8qKgogICAgICogQHNlZSAjc2V0UHJl\ndHR5UHJpbnRMaW5lTGVuZ3RoCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0\nUHJldHR5UHJpbnRMaW5lTGVuZ3RoKCkgewogICAgICAgIHJldHVybiBfcHJl\ndHR5UHJpbnRMaW5lTGVuZ3RoOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byB0cmFjayBwYXJhbWV0ZXJzIGZvciB0aGUgcHVycG9zZXMgb2Yg\ncmVwb3J0aW5nIGV4Y2VwdGlvbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFRyYWNrUGFyYW1ldGVycyhib29sZWFuIHRyYWNrUGFyYW1ldGVycykg\newogICAgICAgIF90cmFja1BhcmFtZXRlcnMgPSB0cmFja1BhcmFtZXRlcnM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIHRyYWNrIHBhcmFt\nZXRlcnMgZm9yIHRoZSBwdXJwb3NlcyBvZiByZXBvcnRpbmcgZXhjZXB0aW9u\ncy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0VHJhY2tQYXJhbWV0\nZXJzKCkgewogICAgICAgIHJldHVybiBfdHJhY2tQYXJhbWV0ZXJzOwogICAg\nfQoKICAgIC8qKgogICAgICogPHA+CiAgICAgKiBXaGV0aGVyIHBhcmFtZXRl\nciB2YWx1ZXMgd2lsbCBiZSBwcmludGVkIGluIGV4Y2VwdGlvbiBtZXNzYWdl\ncyBvciBpbiB0cmFjZS4gVGhpcyBpcyBkaWZmZXJlbnQgZnJvbQogICAgICog\ndHJhY2tQYXJhbWV0ZXJzIHdoaWNoIGNvbnRyb2xzIHdoZXRoZXIgT3BlbkpQ\nQSB3aWxsIHRyYWNrIHBhcmFtZXRlcnMgaW50ZXJuYWxseSAodmlzaWJsZSB3\naGlsZSBkZWJ1Z2dpbmcgYW5kIHVzZWQKICAgICAqIGluIGJhdGNoaW5nKS4K\nICAgICAqIDwvcD4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0UHJp\nbnRQYXJhbWV0ZXJzKCkgewogICAgICAgIHJldHVybiBfcHJpbnRQYXJhbWV0\nZXJzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFByaW50UGFyYW1ldGVy\ncyhib29sZWFuIHByaW50UGFyYW1ldGVycykgewogICAgICAgIF9wcmludFBh\ncmFtZXRlcnMgPSBwcmludFBhcmFtZXRlcnM7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGF0IHRvIGRvIHdpdGggU1FMIHdhcm5pbmdzLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRXYXJuaW5nQWN0aW9uKFN0cmluZyB3YXJuaW5n\nQWN0aW9uKSB7CiAgICAgICAgaW50IGluZGV4ID0gQXJyYXlzLmFzTGlzdChX\nQVJOSU5HX0FDVElPTlMpLmluZGV4T2Yod2FybmluZ0FjdGlvbik7CiAgICAg\nICAgaWYgKGluZGV4IDwgMCkKICAgICAgICAgICAgaW5kZXggPSBXQVJOX0lH\nTk9SRTsKICAgICAgICBfd2FybmluZ0FjdGlvbiA9IGluZGV4OwogICAgfQoK\nICAgIC8qKgogICAgICogV2hhdCB0byBkbyB3aXRoIFNRTCB3YXJuaW5ncy4K\nICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRXYXJuaW5nQWN0aW9uKCkg\newogICAgICAgIHJldHVybiBXQVJOSU5HX0FDVElPTlNbX3dhcm5pbmdBY3Rp\nb25dOwogICAgfQoKICAgIC8qKgogICAgICogV2hhdCB0byBkbyB3aXRoIFNR\nTCB3YXJuaW5ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0V2Fybmlu\nZ0hhbmRsZXIoU1FMV2FybmluZ0hhbmRsZXIgd2FybmluZ0hhbmRsZXIpIHsK\nICAgICAgICBfd2FybmluZ0hhbmRsZXIgPSB3YXJuaW5nSGFuZGxlcjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoYXQgdG8gZG8gd2l0aCBTUUwgd2Fybmlu\nZ3MuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxXYXJuaW5nSGFuZGxlciBnZXRX\nYXJuaW5nSGFuZGxlcigpIHsKICAgICAgICByZXR1cm4gX3dhcm5pbmdIYW5k\nbGVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGxvZyB0byB3cml0ZSB0\nby4KICAgICAqLwogICAgcHVibGljIERhdGFTb3VyY2VMb2dzIGdldExvZ3Mo\nKSB7CiAgICAgICAgcmV0dXJuIF9sb2dzOwogICAgfQoKICAgIHB1YmxpYyBD\nb25uZWN0aW9uIGRlY29yYXRlKENvbm5lY3Rpb24gY29ubikgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG5ldyBMb2dnaW5nQ29ubmVj\ndGlvbihjb25uKTsKICAgIH0KCiAgICAvKioKICAgICAqIEluY2x1ZGUgU1FM\nIGluIGV4Y2VwdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBTUUxFeGNlcHRp\nb24gd3JhcChTUUxFeGNlcHRpb24gc3FsZSwgU3RhdGVtZW50IHN0bW50KSB7\nCiAgICAgICAgaWYgKHNxbGUgaW5zdGFuY2VvZiBSZXBvcnRpbmdTUUxFeGNl\ncHRpb24pCiAgICAgICAgICAgIHJldHVybiAoUmVwb3J0aW5nU1FMRXhjZXB0\naW9uKSBzcWxlOwogICAgICAgIHJldHVybiBuZXcgUmVwb3J0aW5nU1FMRXhj\nZXB0aW9uKHNxbGUsIHN0bW50KTsKICAgIH0KCiAgICAvKioKICAgICAqIElu\nY2x1ZGUgU1FMIGluIGV4Y2VwdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBT\nUUxFeGNlcHRpb24gd3JhcChTUUxFeGNlcHRpb24gc3FsZSwgU3RyaW5nIHNx\nbCkgewogICAgICAgIGlmIChzcWxlIGluc3RhbmNlb2YgUmVwb3J0aW5nU1FM\nRXhjZXB0aW9uKQogICAgICAgICAgICByZXR1cm4gKFJlcG9ydGluZ1NRTEV4\nY2VwdGlvbikgc3FsZTsKICAgICAgICByZXR1cm4gbmV3IFJlcG9ydGluZ1NR\nTEV4Y2VwdGlvbihzcWxlLCBzcWwpOwogICAgfQoKICAgIC8qKgogICAgICog\nSW50ZXJmYWNlIHRoYXQgYWxsb3dzIGN1c3RvbWl6YXRpb24gb2Ygd2hhdCB0\nbyBkbyB3aGVuCiAgICAgKiB7QGxpbmsgU1FMV2FybmluZ31zIG9jY3VyLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGludGVyZmFjZSBTUUxXYXJuaW5n\nSGFuZGxlciB7CgogICAgICAgIHB1YmxpYyB2b2lkIGhhbmRsZVdhcm5pbmco\nU1FMV2FybmluZyB3YXJuaW5nKSB0aHJvd3MgU1FMRXhjZXB0aW9uOwogICAg\nfQoKICAgIC8qKgogICAgICogTG9nZ2luZyBjb25uZWN0aW9uLgogICAgICov\nCiAgICBwcml2YXRlIGNsYXNzIExvZ2dpbmdDb25uZWN0aW9uIGV4dGVuZHMg\nRGVsZWdhdGluZ0Nvbm5lY3Rpb24gewoKICAgICAgICBwdWJsaWMgTG9nZ2lu\nZ0Nvbm5lY3Rpb24oQ29ubmVjdGlvbiBjb25uKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgc3VwZXIoY29ubik7CiAgICAgICAgfQoKICAg\nICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRl\nbWVudChTdHJpbmcgc3FsLCBib29sZWFuIHdyYXApCiAgICAgICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5wcmVw\nYXJlU3RhdGVtZW50KHNxbCwgZmFsc2UpOwogICAgICAgICAgICAgICAgcmV0\ndXJuIG5ldyBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQoc3RtbnQsIHNxbCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAg\nICAgICAgICAgICAgdGhyb3cgd3JhcChzZSwgc3FsKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVt\nZW50IHByZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwgaW50IHJzVHlwZSwK\nICAgICAgICAgICAgaW50IHJzQ29uY3VyLCBib29sZWFuIHdyYXApIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5wcmVwYXJl\nU3RhdGVtZW50CiAgICAgICAgICAgICAgICAgICAgKHNxbCwgcnNUeXBlLCBy\nc0NvbmN1ciwgZmFsc2UpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBM\nb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQoc3RtbnQsIHNxbCk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgd3JhcChzZSwgc3FsKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgcHJvdGVjdGVkIFN0YXRlbWVudCBjcmVhdGVTdGF0ZW1l\nbnQoYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgU3RhdGVtZW50IHN0bW50ID0gc3VwZXIuY3JlYXRlU3RhdGVtZW50\nKGZhbHNlKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBMb2dnaW5nU3RhdGVt\nZW50KHN0bW50KTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBTdGF0\nZW1lbnQgY3JlYXRlU3RhdGVtZW50KGludCB0eXBlLCBpbnQgY29uY3VycmVu\nY3ksCiAgICAgICAgICAgIGJvb2xlYW4gd3JhcCkgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLmNy\nZWF0ZVN0YXRlbWVudCh0eXBlLCBjb25jdXJyZW5jeSwgZmFsc2UpOwogICAg\nICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdTdGF0ZW1lbnQoc3RtbnQpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY29tbWl0KCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHN1cGVyLmNvbW1pdCgpOwogICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJs\nZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJjb21t\naXQiLCBzdGFydCwgdGhpcyk7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxX\nYXJuaW5nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIHJvbGxiYWNrKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxs\naXMoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN1cGVy\nLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoInJvbGxiYWNrIiwgc3RhcnQsIHRo\naXMpOwogICAgICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZygpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBjbG9z\nZSgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIHN0\nYXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBzdXBlci5jbG9zZSgpOwogICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlz\nSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dK\nREJDKCJjbG9zZSIsIHN0YXJ0LCB0aGlzKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFNhdmVwb2ludCBzZXRTYXZlcG9pbnQo\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgbG9uZyBzdGFy\ndCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnNldFNhdmVwb2lu\ndCgpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\naWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICBfbG9ncy5sb2dKREJDKCJzYXZlcG9pbnQiLCBzdGFydCwgdGhpcyk7CiAg\nICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTYXZlcG9pbnQgc2V0U2F2\nZXBvaW50KFN0cmluZyBuYW1lKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxp\ncygpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cGVyLnNldFNhdmVwb2ludChuYW1lKTsKICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygic2F2ZXBv\naW50OiAiICsgbmFtZSwgc3RhcnQsIHRoaXMpOwogICAgICAgICAgICAgICAg\naGFuZGxlU1FMV2FybmluZygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCByb2xsYmFjayhTYXZlcG9pbnQgc2F2ZXBv\naW50KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgc3VwZXIucm9sbGJhY2soc2F2ZXBv\naW50KTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAg\nICAgICBTdHJpbmcgbmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IHNhdmVwb2lu\ndC5nZXRTYXZlcG9pbnROYW1lKCk7CiAgICAgICAgICAgICAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNxZSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBuYW1lID0gU3RyaW5nLnZhbHVlT2Yoc2F2ZXBvaW50LmdldFNhdmVw\nb2ludElkKCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICBfbG9ncy5sb2dKREJDKCJyb2xsYmFjazogIiArIG5hbWUsIHN0\nYXJ0LCB0aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGhhbmRsZVNRTFdhcm5pbmcoKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgcmVsZWFzZVNhdmVwb2ludChTYXZlcG9p\nbnQgc2F2ZXBvaW50KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc3VwZXIucmVsZWFz\nZVNhdmVwb2ludChzYXZlcG9pbnQpOwogICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkg\newogICAgICAgICAgICAgICAgICAgIFN0cmluZyBuYW1lID0gbnVsbDsKICAg\nICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAg\nICBuYW1lID0gc2F2ZXBvaW50LmdldFNhdmVwb2ludE5hbWUoKTsKICAgICAg\nICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc3FlKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBTdHJpbmcudmFsdWVPZihz\nYXZlcG9pbnQuZ2V0U2F2ZXBvaW50SWQoKSk7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoInJlbGVh\nc2U6ICIgKyBuYW1lLCBzdGFydCwgdGhpcyk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBTdGF0ZW1lbnQg\nY3JlYXRlU3RhdGVtZW50KGludCByZXN1bHRTZXRUeXBlLAogICAgICAgICAg\nICBpbnQgcmVzdWx0U2V0Q29uY3VycmVuY3ksIGludCByZXN1bHRTZXRIb2xk\nYWJpbGl0eSwgYm9vbGVhbiB3cmFwKQogICAgICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgU3RhdGVtZW50IHN0bW50ID0gc3Vw\nZXIuY3JlYXRlU3RhdGVtZW50KHJlc3VsdFNldFR5cGUsCiAgICAgICAgICAg\nICAgICByZXN1bHRTZXRDb25jdXJyZW5jeSwgcmVzdWx0U2V0SG9sZGFiaWxp\ndHksIGZhbHNlKTsKICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZygpOwog\nICAgICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdTdGF0ZW1lbnQoc3RtbnQp\nOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVt\nZW50IHByZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwKICAgICAgICAgICAg\naW50IHJlc3VsdFNldFR5cGUsIGludCByZXN1bHRTZXRDb25jdXJyZW5jeSwK\nICAgICAgICAgICAgaW50IHJlc3VsdFNldEhvbGRhYmlsaXR5LCBib29sZWFu\nIHdyYXApIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBz\ndXBlci5wcmVwYXJlU3RhdGVtZW50CiAgICAgICAgICAgICAgICAgICAgKHNx\nbCwgcmVzdWx0U2V0VHlwZSwgcmVzdWx0U2V0Q29uY3VycmVuY3ksCiAgICAg\nICAgICAgICAgICAgICAgICAgIHJlc3VsdFNldEhvbGRhYmlsaXR5LCBmYWxz\nZSk7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKCk7CiAgICAg\nICAgICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVu\ndChzdG1udCwgc3FsKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyB3cmFwKHNlLCBzcWwp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQg\nUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChTdHJpbmcgc3Fs\nLAogICAgICAgICAgICBpbnQgYXV0b0dlbmVyYXRlZEtleXMsIGJvb2xlYW4g\nd3JhcCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1\ncGVyLnByZXBhcmVTdGF0ZW1lbnQKICAgICAgICAgICAgICAgICAgICAoc3Fs\nLCBhdXRvR2VuZXJhdGVkS2V5cywgZmFsc2UpOwogICAgICAgICAgICAgICAg\naGFuZGxlU1FMV2FybmluZygpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5l\ndyBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQoc3RtbnQsIHNxbCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgdGhyb3cgd3JhcChzZSwgc3FsKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50IHBy\nZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwKICAgICAgICAgICAgaW50W10g\nY29sdW1uSW5kZXhlcywgYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFByZXBh\ncmVkU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFyZVN0YXRlbWVudAog\nICAgICAgICAgICAgICAgICAgIChzcWwsIGNvbHVtbkluZGV4ZXMsIGZhbHNl\nKTsKICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoKTsKICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50\nKHN0bW50LCBzcWwpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgICAgIHRocm93IHdyYXAoc2UsIHNxbCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQ\ncmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWws\nCiAgICAgICAgICAgIFN0cmluZ1tdIGNvbHVtbk5hbWVzLCBib29sZWFuIHdy\nYXApIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBzdXBl\nci5wcmVwYXJlU3RhdGVtZW50CiAgICAgICAgICAgICAgICAgICAgKHNxbCwg\nY29sdW1uTmFtZXMsIGZhbHNlKTsKICAgICAgICAgICAgICAgIGhhbmRsZVNR\nTFdhcm5pbmcoKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTG9nZ2lu\nZ1ByZXBhcmVkU3RhdGVtZW50KHN0bW50LCBzcWwpOwogICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIHRo\ncm93IHdyYXAoc2UsIHNxbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIHByb3RlY3RlZCBEYXRhYmFzZU1ldGFEYXRhIGdldE1ldGFEYXRh\nKGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIHJldHVybiBuZXcgTG9nZ2luZ0RhdGFiYXNlTWV0\nYURhdGEoc3VwZXIuZ2V0TWV0YURhdGEoZmFsc2UpKTsKICAgICAgICB9Cgog\nICAgICAgIC8qKgogICAgICAgICAqIExvZyB0aW1lIGVsYXBzZWQgc2luY2Ug\nZ2l2ZW4gc3RhcnQuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSB2b2lk\nIGxvZ1RpbWUobG9uZyBzdGFydFRpbWUpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICBpZiAoX2xvZ3MuaXNTUUxFbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICBfbG9ncy5sb2dTUUwoInNwZW50Iiwgc3RhcnRUaW1lLCB0\naGlzKTsgCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBMb2cg\ndGltZSBlbGFwc2VkIHNpbmNlIGdpdmVuIHN0YXJ0LgogICAgICAgICAqLwog\nICAgICAgIHByaXZhdGUgdm9pZCBsb2dTUUwoU3RhdGVtZW50IHN0bW50KSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKF9sb2dzLmlz\nU1FMRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xvZ3MubG9nU1FMKCJl\neGVjdXRpbmcgIiArIHN0bW50LCB0aGlzKTsgCiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBIYW5kbGUgYW55IHtAbGluayBTUUxXYXJuaW5n\nfXMgb24gdGhlIGN1cnJlbnQge0BsaW5rIENvbm5lY3Rpb259LgogICAgICAg\nICAqCiAgICAgICAgICogQHNlZSAjaGFuZGxlU1FMV2FybmluZyhTUUxXYXJu\naW5nKQogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBoYW5kbGVT\nUUxXYXJuaW5nKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGlmIChfd2FybmluZ0FjdGlvbiA9PSBXQVJOX0lHTk9SRSkKICAgICAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBoYW5kbGVTUUxXYXJuaW5nKGdldFdhcm5pbmdzKCkpOwogICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgY2xlYXJXYXJuaW5n\ncygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAg\nICAgICAgKiBIYW5kbGUgYW55IHtAbGluayBTUUxXYXJuaW5nfXMgb24gdGhl\nIHNwZWNpZmllZCB7QGxpbmsgU3RhdGVtZW50fS4KICAgICAgICAgKgogICAg\nICAgICAqIEBzZWUgI2hhbmRsZVNRTFdhcm5pbmcoU1FMV2FybmluZykKICAg\nICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgaGFuZGxlU1FMV2Fybmlu\nZyhTdGF0ZW1lbnQgc3RtbnQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICBpZiAoX3dhcm5pbmdBY3Rpb24gPT0gV0FSTl9JR05PUkUpCiAg\nICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhzdG1udC5nZXRXYXJuaW5n\ncygpKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nIHN0bW50LmNsZWFyV2FybmluZ3MoKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogSGFuZGxlIGFueSB7QGxpbmsg\nU1FMV2FybmluZ31zIG9uIHRoZSBzcGVjaWZpZWQge0BsaW5rIFJlc3VsdFNl\ndH0uCiAgICAgICAgICoKICAgICAgICAgKiBAc2VlICNoYW5kbGVTUUxXYXJu\naW5nKFNRTFdhcm5pbmcpCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSB2\nb2lkIGhhbmRsZVNRTFdhcm5pbmcoUmVzdWx0U2V0IHJzKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKF93YXJuaW5nQWN0aW9uID09\nIFdBUk5fSUdOT1JFKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmco\ncnMuZ2V0V2FybmluZ3MoKSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICBycy5jbGVhcldhcm5pbmdzKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEhhbmRsZSB0\naGUgc3BlY2lmaWVkIHtAbGluayBTUUxXYXJuaW5nfSBkZXBlbmRpbmcgb24g\ndGhlCiAgICAgICAgICogc2V0dGluZyBvZiB0aGUge0BsaW5rICNzZXRXYXJu\naW5nQWN0aW9ufSBhdHRyaWJ1dGUuCiAgICAgICAgICoKICAgICAgICAgKiBA\ncGFyYW0gd2FybmluZyB0aGUgd2FybmluZyB0byBoYW5kbGUKICAgICAgICAg\nKi8KICAgICAgICBwcml2YXRlIHZvaWQgaGFuZGxlU1FMV2FybmluZyhTUUxX\nYXJuaW5nIHdhcm5pbmcpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICBpZiAod2FybmluZyA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICBpZiAoX3dhcm5pbmdBY3Rpb24gPT0gV0FSTl9J\nR05PUkUpCiAgICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICBM\nb2cgbG9nID0gX2xvZ3MuZ2V0SkRCQ0xvZygpOwogICAgICAgICAgICBmb3Ig\nKDsgd2FybmluZyAhPSBudWxsOyB3YXJuaW5nID0gd2FybmluZy5nZXROZXh0\nV2FybmluZygpKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKF93YXJuaW5n\nQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBXQVJOX0xPR19U\nUkFDRToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nLnRy\nYWNlKHdhcm5pbmcpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICBjYXNlIFdBUk5fTE9HX0lORk86CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmluZm8od2FybmluZyk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgICAgIGNhc2UgV0FSTl9MT0dfV0FSTjoKICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBsb2cud2Fybih3YXJuaW5nKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBX\nQVJOX0xPR19FUlJPUjoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxv\nZy5pc0Vycm9yRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbG9nLmVycm9yKHdhcm5pbmcpOwogICAgICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIFdBUk5fVEhST1c6\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgdGhyb3cgaXQgYXMg\naWYgaXQgd2VyZSBhIFNRTEV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAg\nICAgICB0aHJvdyB3YXJuaW5nOwogICAgICAgICAgICAgICAgICAgIGNhc2Ug\nV0FSTl9IQU5ETEU6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfd2Fy\nbmluZ0hhbmRsZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIF93YXJuaW5nSGFuZGxlci5oYW5kbGVXYXJuaW5nKHdhcm5pbmcpOwog\nICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAvLyBpZ25v\ncmUKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgog\nICAgICAgICAqIE1ldGFkYXRhIHdyYXBwZXIgdGhhdCBsb2dzIGFjdGlvbnMu\nCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBjbGFzcyBMb2dnaW5nRGF0\nYWJhc2VNZXRhRGF0YQogICAgICAgICAgICBleHRlbmRzIERlbGVnYXRpbmdE\nYXRhYmFzZU1ldGFEYXRhIHsKCiAgICAgICAgICAgIHB1YmxpYyBMb2dnaW5n\nRGF0YWJhc2VNZXRhRGF0YShEYXRhYmFzZU1ldGFEYXRhIG1ldGEpIHsKICAg\nICAgICAgICAgICAgIHN1cGVyKG1ldGEsIExvZ2dpbmdDb25uZWN0aW9uLnRo\naXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0\nU2V0IGdldEJlc3RSb3dJZGVudGlmaWVyKFN0cmluZyBjYXRhbG9nLAogICAg\nICAgICAgICAgICAgU3RyaW5nIHNjaGVtYSwgU3RyaW5nIHRhYmxlLCBpbnQg\nc2NvcGUsIGJvb2xlYW4gbnVsbGFibGUpCiAgICAgICAgICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5p\nc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9n\nSkRCQygiZ2V0QmVzdFJvd0lkZW50aWZpZXI6ICIKICAgICAgICAgICAgICAg\nICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYSArICIsICIgKyB0\nYWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rp\nb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0QmVz\ndFJvd0lkZW50aWZpZXIoY2F0YWxvZywgc2NoZW1hLAogICAgICAgICAgICAg\nICAgICAgIHRhYmxlLCBzY29wZSwgbnVsbGFibGUpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldENhdGFsb2dzKCkg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xv\nZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dz\nLmxvZ0pEQkMoImdldENhdGFsb2dzIiwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhp\ncyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0Q2F0YWxvZ3Mo\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNl\ndCBnZXRDb2x1bW5Qcml2aWxlZ2VzKFN0cmluZyBjYXRhbG9nLCBTdHJpbmcg\nc2NoZW1hLAogICAgICAgICAgICAgICAgU3RyaW5nIHRhYmxlLCBTdHJpbmcg\nY29sdW1uTmFtZVBhdHRlcm4pIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRDb2x1bW5Qcml2aWxl\nZ2VzOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyArICIs\nICIgKyBzY2hlbWEgKyAiLCAiICsgdGFibGUsCiAgICAgICAgICAgICAgICAg\nICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHN1cGVyLmdldENvbHVtblByaXZpbGVnZXMoY2F0YWxvZywg\nc2NoZW1hLAogICAgICAgICAgICAgICAgICAgIHRhYmxlLCBjb2x1bW5OYW1l\nUGF0dGVybik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBS\nZXN1bHRTZXQgZ2V0Q29sdW1ucyhTdHJpbmcgY2F0YWxvZywgU3RyaW5nIHNj\naGVtYVBhdHRlcm4sCiAgICAgICAgICAgICAgICBTdHJpbmcgdGFibGVOYW1l\nUGF0dGVybiwgU3RyaW5nIGNvbHVtbk5hbWVQYXR0ZXJuKQogICAgICAgICAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBp\nZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAg\nIF9sb2dzLmxvZ0pEQkMoImdldENvbHVtbnM6ICIKICAgICAgICAgICAgICAg\nICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYVBhdHRlcm4gKyAi\nLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgdGFibGVOYW1lUGF0dGVy\nbiArICIsICIgKyBjb2x1bW5OYW1lUGF0dGVybiwKICAgICAgICAgICAgICAg\nICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gc3VwZXIuZ2V0Q29sdW1ucyhjYXRhbG9nLCBzY2hlbWFQ\nYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgIHRhYmxlTmFtZVBhdHRlcm4s\nIGNvbHVtbk5hbWVQYXR0ZXJuKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIFJlc3VsdFNldCBnZXRDcm9zc1JlZmVyZW5jZShTdHJpbmcg\ncHJpbWFyeUNhdGFsb2csCiAgICAgICAgICAgICAgICBTdHJpbmcgcHJpbWFy\neVNjaGVtYSwgU3RyaW5nIHByaW1hcnlUYWJsZSwKICAgICAgICAgICAgICAg\nIFN0cmluZyBmb3JlaWduQ2F0YWxvZywgU3RyaW5nIGZvcmVpZ25TY2hlbWEs\nCiAgICAgICAgICAgICAgICBTdHJpbmcgZm9yZWlnblRhYmxlKSB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pE\nQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRC\nQygiZ2V0Q3Jvc3NSZWZlcmVuY2U6ICIKICAgICAgICAgICAgICAgICAgICAg\nICAgKyBwcmltYXJ5Q2F0YWxvZyArICIsICIgKyBwcmltYXJ5U2NoZW1hICsg\nIiwgIgogICAgICAgICAgICAgICAgICAgICAgICArIHByaW1hcnlUYWJsZSAr\nICIsICIgKyBmb3JlaWduQ2F0YWxvZyArICIsICIKICAgICAgICAgICAgICAg\nICAgICAgICAgKyBmb3JlaWduU2NoZW1hICsgIiwgIiArIGZvcmVpZ25TY2hl\nbWEsCiAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9u\nLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldENyb3Nz\nUmVmZXJlbmNlKHByaW1hcnlDYXRhbG9nLCBwcmltYXJ5U2NoZW1hLAogICAg\nICAgICAgICAgICAgICAgIHByaW1hcnlUYWJsZSwgZm9yZWlnbkNhdGFsb2cs\nIGZvcmVpZ25TY2hlbWEsIGZvcmVpZ25UYWJsZSk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0RXhwb3J0ZWRLZXlz\nKFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hLAogICAgICAgICAgICAg\nICAgU3RyaW5nIHRhYmxlKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0RXhwb3J0ZWRLZXlzOiAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBz\nY2hlbWEgKyAiLCAiICsgdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAg\nIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmdldEV4cG9ydGVkS2V5cyhjYXRhbG9nLCBzY2hlbWEsIHRh\nYmxlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3Vs\ndFNldCBnZXRJbXBvcnRlZEtleXMoU3RyaW5nIGNhdGFsb2csIFN0cmluZyBz\nY2hlbWEsCiAgICAgICAgICAgICAgICBTdHJpbmcgdGFibGUpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRC\nQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJD\nKCJnZXRJbXBvcnRlZEtleXM6ICIKICAgICAgICAgICAgICAgICAgICAgICAg\nKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYSArICIsICIgKyB0YWJsZSwKICAg\nICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0SW1wb3J0ZWRLZXlz\nKGNhdGFsb2csIHNjaGVtYSwgdGFibGUpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldEluZGV4SW5mbyhTdHJpbmcg\nY2F0YWxvZywgU3RyaW5nIHNjaGVtYSwKICAgICAgICAgICAgICAgIFN0cmlu\nZyB0YWJsZSwgYm9vbGVhbiB1bmlxdWUsIGJvb2xlYW4gYXBwcm94aW1hdGUp\nCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0SW5kZXhJbmZvOiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBzY2hl\nbWEgKyAiLCAiICsgdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgIExv\nZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cGVyLmdldEluZGV4SW5mbyhjYXRhbG9nLCBzY2hlbWEsIHRhYmxlLCB1\nbmlxdWUsCiAgICAgICAgICAgICAgICAgICAgYXBwcm94aW1hdGUpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldFBy\naW1hcnlLZXlzKFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hLAogICAg\nICAgICAgICAgICAgU3RyaW5nIHRhYmxlKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0UHJpbWFy\neUtleXM6ICIKICAgICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9nICsg\nIiwgIiArIHNjaGVtYSArICIsICIgKyB0YWJsZSwKICAgICAgICAgICAgICAg\nICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gc3VwZXIuZ2V0UHJpbWFyeUtleXMoY2F0YWxvZywgc2No\nZW1hLCB0YWJsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1Ymxp\nYyBSZXN1bHRTZXQgZ2V0UHJvY2VkdXJlQ29sdW1ucyhTdHJpbmcgY2F0YWxv\nZywKICAgICAgICAgICAgICAgIFN0cmluZyBzY2hlbWFQYXR0ZXJuLCBTdHJp\nbmcgcHJvY2VkdXJlTmFtZVBhdHRlcm4sCiAgICAgICAgICAgICAgICBTdHJp\nbmcgY29sdW1uTmFtZVBhdHRlcm4pIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAg\nICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRQcm9jZWR1cmVD\nb2x1bW5zOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyAr\nICIsICIgKyBzY2hlbWFQYXR0ZXJuICsgIiwgIgogICAgICAgICAgICAgICAg\nICAgICAgICArIHByb2NlZHVyZU5hbWVQYXR0ZXJuICsgIiwgIiArIGNvbHVt\nbk5hbWVQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgICAgICBMb2dnaW5n\nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVybiBzdXBl\nci5nZXRQcm9jZWR1cmVDb2x1bW5zKGNhdGFsb2csIHNjaGVtYVBhdHRlcm4s\nCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlTmFtZVBhdHRlcm4sIGNv\nbHVtbk5hbWVQYXR0ZXJuKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIFJlc3VsdFNldCBnZXRQcm9jZWR1cmVzKFN0cmluZyBjYXRhbG9n\nLAogICAgICAgICAgICAgICAgU3RyaW5nIHNjaGVtYVBhdHRlcm4sIFN0cmlu\nZyBwcm9jZWR1cmVOYW1lUGF0dGVybikKICAgICAgICAgICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlz\nSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dK\nREJDKCJnZXRQcm9jZWR1cmVzOiAiCiAgICAgICAgICAgICAgICAgICAgICAg\nICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWFQYXR0ZXJuICsgIiwgIgogICAg\nICAgICAgICAgICAgICAgICAgICArIHByb2NlZHVyZU5hbWVQYXR0ZXJuLCBM\nb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRQcm9jZWR1cmVzKGNhdGFsb2csIHNjaGVtYVBhdHRlcm4s\nCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlTmFtZVBhdHRlcm4pOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdl\ndFNjaGVtYXMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAg\nICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0U2NoZW1hcyIsIExvZ2dpbmdDb25u\nZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdl\ndFNjaGVtYXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGlj\nIFJlc3VsdFNldCBnZXRUYWJsZVByaXZpbGVnZXMoU3RyaW5nIGNhdGFsb2cs\nCiAgICAgICAgICAgICAgICBTdHJpbmcgc2NoZW1hUGF0dGVybiwgU3RyaW5n\nIHRhYmxlTmFtZVBhdHRlcm4pCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNF\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygi\nZ2V0VGFibGVQcml2aWxlZ2VzIiwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VGFibGVQcml2aWxl\nZ2VzKGNhdGFsb2csIHNjaGVtYVBhdHRlcm4sCiAgICAgICAgICAgICAgICAg\nICAgdGFibGVOYW1lUGF0dGVybik7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0VGFibGVzKFN0cmluZyBjYXRhbG9n\nLCBTdHJpbmcgc2NoZW1hUGF0dGVybiwKICAgICAgICAgICAgICAgIFN0cmlu\nZyB0YWJsZU5hbWVQYXR0ZXJuLCBTdHJpbmdbXSB0eXBlcykgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJD\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMo\nImdldFRhYmxlczogIgogICAgICAgICAgICAgICAgICAgICAgICArIGNhdGFs\nb2cgKyAiLCAiICsgc2NoZW1hUGF0dGVybiArICIsICIKICAgICAgICAgICAg\nICAgICAgICAgICAgKyB0YWJsZU5hbWVQYXR0ZXJuLCBMb2dnaW5nQ29ubmVj\ndGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRU\nYWJsZXMoY2F0YWxvZywgc2NoZW1hUGF0dGVybiwKICAgICAgICAgICAgICAg\nICAgICB0YWJsZU5hbWVQYXR0ZXJuLCB0eXBlcyk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0VGFibGVUeXBlcygp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9s\nb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9n\ncy5sb2dKREJDKCJnZXRUYWJsZVR5cGVzIiwgTG9nZ2luZ0Nvbm5lY3Rpb24u\ndGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VGFibGVU\neXBlcygpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVz\ndWx0U2V0IGdldFR5cGVJbmZvKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAg\nICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldFR5cGVJbmZvIiwg\nTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwZXIuZ2V0VHlwZUluZm8oKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIFJlc3VsdFNldCBnZXRVRFRzKFN0cmluZyBjYXRhbG9n\nLCBTdHJpbmcgc2NoZW1hUGF0dGVybiwKICAgICAgICAgICAgICAgIFN0cmlu\nZyB0eXBlTmFtZVBhdHRlcm4sIGludFtdIHR5cGVzKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0\nVURUcyIsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHN1cGVyLmdldFVEVHMoY2F0YWxvZywgc2NoZW1hUGF0dGVy\nbiwKICAgICAgICAgICAgICAgICAgICB0eXBlTmFtZVBhdHRlcm4sIHR5cGVz\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNl\ndCBnZXRWZXJzaW9uQ29sdW1ucyhTdHJpbmcgY2F0YWxvZywKICAgICAgICAg\nICAgICAgIFN0cmluZyBzY2hlbWEsIFN0cmluZyB0YWJsZSkgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJD\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMo\nImdldFZlcnNpb25Db2x1bW5zOiAiCiAgICAgICAgICAgICAgICAgICAgICAg\nICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWEgKyAiLCAiICsgdGFibGUsCiAg\nICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFZlcnNpb25Db2x1\nbW5zKGNhdGFsb2csIHNjaGVtYSwgdGFibGUpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBTdGF0ZW1lbnQgd3Jh\ncHBlciB0aGF0IGxvZ3MgU1FMIHRvIHRoZSBwYXJlbnQgZGF0YSBzb3VyY2Ug\nYW5kCiAgICAgICAgICogcmVtZW1iZXJzIHRoZSBsYXN0IHBpZWNlIG9mIFNR\nTCB0byBiZSBleGVjdXRlZCBvbiBpdC4KICAgICAgICAgKi8KICAgICAgICBw\ncml2YXRlIGNsYXNzIExvZ2dpbmdTdGF0ZW1lbnQgZXh0ZW5kcyBEZWxlZ2F0\naW5nU3RhdGVtZW50IHsKCiAgICAgICAgICAgIHByaXZhdGUgU3RyaW5nIF9z\ncWwgPSBudWxsOwoKICAgICAgICAgICAgcHVibGljIExvZ2dpbmdTdGF0ZW1l\nbnQoU3RhdGVtZW50IHN0bW50KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgICAgIHN1cGVyKHN0bW50LCBMb2dnaW5nQ29ubmVjdGlvbi50\naGlzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nYXBwZW5kSW5mbyhTdHJpbmdCdWZmZXIgYnVmKSB7CiAgICAgICAgICAgICAg\nICBpZiAoX3NxbCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiICIpOwogICAgICAgICAgICAgICAgICAgIGlmIChfZm9ybWF0\ndGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZChTRVApOwogICAgICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5k\nKF9mb3JtYXR0ZXIucHJldHR5UHJpbnQoX3NxbCkpOwogICAgICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoX3NxbCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm90ZWN0ZWQg\nUmVzdWx0U2V0IHdyYXBSZXN1bHQoUmVzdWx0U2V0IHJzLCBib29sZWFuIHdy\nYXApIHsKICAgICAgICAgICAgICAgIGlmICghd3JhcCB8fCBycyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci53cmFwUmVzdWx0\nKHJzLCB3cmFwKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTG9nZ2lu\nZ1Jlc3VsdFNldChycywgdGhpcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIGNhbmNlbCgpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJjYW5jZWwgIiAr\nIHRoaXMsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAg\nICAgc3VwZXIuY2FuY2VsKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5KFN0cmluZyBzcWws\nIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgX3NxbCA9IHNxbDsKICAgICAgICAg\nICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3Rh\ncnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4\nZWN1dGVRdWVyeShzcWwsIHdyYXApOwogICAgICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgd3JhcChzZSwgTG9nZ2luZ1N0YXRlbWVudC50aGlzKTsKICAgICAgICAg\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGlt\nZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMV2Fybmlu\nZyhMb2dnaW5nU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgaW50IGV4ZWN1dGVV\ncGRhdGUoU3RyaW5nIHNxbCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBfc3FsID0gc3FsOwogICAgICAgICAgICAgICAgbG9nU1FM\nKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5j\ndXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVVwZGF0ZShz\ncWwpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgd3JhcChzZSwgTG9nZ2lu\nZ1N0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAg\nICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5nU3RhdGVtZW50\nLnRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBleGVjdXRlKFN0cmluZyBzcWwpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgX3NxbCA9IHNx\nbDsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAg\nICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmV4ZWN1dGUoc3FsKTsKICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIHRo\ncm93IHdyYXAoc2UsIExvZ2dpbmdTdGF0ZW1lbnQudGhpcyk7CiAgICAgICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1Rp\nbWUoc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5p\nbmcoTG9nZ2luZ1N0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBjbGFz\ncyBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQKICAgICAgICAgICAgZXh0ZW5k\ncyBEZWxlZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQgewoKICAgICAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBTdHJpbmcgX3NxbDsKICAgICAgICAgICAgcHJpdmF0\nZSBMaXN0IF9wYXJhbXMgPSBudWxsOwogICAgICAgICAgICBwcml2YXRlIExp\nc3QgX3BhcmFtQmF0Y2ggPSBudWxsOwoKICAgICAgICAgICAgcHVibGljIExv\nZ2dpbmdQcmVwYXJlZFN0YXRlbWVudChQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndCwgU3RyaW5nIHNxbCkKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgc3VwZXIoc3RtbnQsIExvZ2dpbmdD\nb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgX3NxbCA9IHNxbDsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNl\ndCB3cmFwUmVzdWx0KFJlc3VsdFNldCBycywgYm9vbGVhbiB3cmFwKSB7CiAg\nICAgICAgICAgICAgICBpZiAoIXdyYXAgfHwgcnMgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwZXIud3JhcFJlc3VsdChycywgd3Jh\ncCk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExvZ2dpbmdSZXN1bHRT\nZXQocnMsIHRoaXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm90\nZWN0ZWQgUmVzdWx0U2V0IGV4ZWN1dGVRdWVyeShTdHJpbmcgc3FsLCBib29s\nZWFuIHdyYXApCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAg\nICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmV4ZWN1dGVRdWVyeShzcWwsIHdyYXApOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAg\nICAgICAgICAgdGhyb3cgd3JhcChzZSwgTG9nZ2luZ1ByZXBhcmVkU3RhdGVt\nZW50LnRoaXMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAg\nICAgICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAgICAgICAg\nICAgICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5nUHJlcGFyZWRTdGF0ZW1l\nbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHB1YmxpYyBpbnQgZXhlY3V0ZVVwZGF0ZShTdHJpbmcgc3Fs\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NR\nTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4ZWN1dGVVcGRhdGUo\nc3FsKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICAgICAgICAgIHRocm93IHdyYXAoc2UsIExvZ2dp\nbmdQcmVwYXJlZFN0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7\nCiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRydWUp\nOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoTG9nZ2lu\nZ1ByZXBhcmVkU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBleGVj\ndXRlKFN0cmluZyBzcWwpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZXhlY3V0ZShzcWwpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgd3JhcChz\nZSwgTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1l\nKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAgICBjbGVhckxvZ1BhcmFtZXRl\ncnModHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMV2Fybmlu\nZyhMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBS\nZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5KGJvb2xlYW4gd3JhcCkgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAg\nICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1l\nTWlsbGlzKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlUXVlcnkod3JhcCk7CiAgICAg\nICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyB3cmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRT\ndGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAg\nICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAg\nICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdQcmVwYXJlZFN0\nYXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcHVibGljIGludCBleGVjdXRlVXBkYXRlKCkgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhp\ncyk7CiAgICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJl\nbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlVXBkYXRlKCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyB3cmFwKHNlLCBMb2dnaW5nUHJlcGFy\nZWRTdGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAg\nICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAg\nICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdQcmVwYXJl\nZFN0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIGludFtdIGV4ZWN1dGVCYXRjaCgp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgbG9nU1FM\nKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5j\ndXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZUJhdGNoKCk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZXhjZXB0aW9uIGlzIGEg\nQmF0Y2hVcGRhdGVFeGNlcHRpb24sIGFuZAogICAgICAgICAgICAgICAgICAg\nIC8vIHdlIGFyZSB0cmFja2luZyBwYXJhbWV0ZXJzLCB0aGVuIHNldCB0aGUg\nY3VycmVudAogICAgICAgICAgICAgICAgICAgIC8vIHBhcmFtZXRlciBzZXQg\ndG8gYmUgdGhlIGluZGV4IG9mIHRoZSBmYWlsZWQKICAgICAgICAgICAgICAg\nICAgICAvLyBzdGF0ZW1lbnQgc28gdGhhdCB0aGUgUmVwb3J0aW5nU1FMRXhj\nZXB0aW9uIHdpbGwKICAgICAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBj\nb3JyZWN0IHBhcmFtCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlIGluc3Rh\nbmNlb2YgQmF0Y2hVcGRhdGVFeGNlcHRpb24KICAgICAgICAgICAgICAgICAg\nICAgICAgJiYgX3BhcmFtQmF0Y2ggIT0gbnVsbCAmJiBzaG91bGRUcmFja1Bh\ncmFtZXRlcnMoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnRbXSBj\nb3VudCA9ICgoQmF0Y2hVcGRhdGVFeGNlcHRpb24pIHNlKS4KICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGdldFVwZGF0ZUNvdW50cygpOwogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoY291bnQgIT0gbnVsbCAmJiBjb3VudC5s\nZW5ndGggPD0gX3BhcmFtQmF0Y2guc2l6ZSgpKQogICAgICAgICAgICAgICAg\nICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaW5k\nZXggPSAtMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgY291bnQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAvLyAtMyBpcyBTdGF0ZW1lbnQuU1RBVEVN\nRU5UX0ZBSUxFRCwgYnV0IGlzCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gb25seSBhdmFpbGFibGUgaW4gSkRLIDEuNCsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRbaV0gPT0gLTMpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gbm8gLTMgZWxlbWVudDogaXQgbWF5IGJlIHRoYXQgdGhlIHNlcnZl\nciBzdG9wcGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9j\nZXNzaW5nLCBzbyB0aGUgc2l6ZSBvZiB0aGUgY291bnQgd2lsbCBiZQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGluZGV4CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT0gLTEpCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBjb3VudC5sZW5ndGgg\nKyAxOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCB0aGUg\nY3VycmVudCBwYXJhbXMgdG8gdGhlIHNhdmVkIHZhbHVlcwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgX3BhcmFtQmF0Y2guc2l6\nZSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wYXJhbXMg\nPSAoTGlzdCkgX3BhcmFtQmF0Y2guZ2V0KGluZGV4KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICB0aHJvdyB3cmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRTdGF0\nZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAg\nICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAg\nICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdQcmVwYXJlZFN0YXRl\nbWVudC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gZXhlY3V0ZSgpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgbG9nU1FMKHRoaXMpOwog\nICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZSgpOwogICAgICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAg\nICAgICAgdGhyb3cgd3JhcChzZSwgTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50\nLnRoaXMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAg\nICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAgICAgICAgICAg\nICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQu\ndGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIGNhbmNlbCgpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJjYW5jZWwg\nIiArIHRoaXMgKyAiOiAiICsgX3NxbCwKICAgICAgICAgICAgICAgICAgICAg\nICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CgogICAgICAgICAgICAgICAg\nc3VwZXIuY2FuY2VsKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHNldE51bGwoaW50IGkxLCBpbnQgaTIpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkx\nLCAibnVsbCIsIG51bGwpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0TnVs\nbChpMSwgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRCb29sZWFuKGludCBpLCBib29sZWFuIGIpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGks\nIGIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0Qm9vbGVhbihpLCBiKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0Qnl0\nZShpbnQgaSwgYnl0ZSBiKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBiKTsKICAgICAgICAgICAg\nICAgIHN1cGVyLnNldEJ5dGUoaSwgYik7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNldFNob3J0KGludCBpLCBzaG9ydCBzKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpLCBzKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldFNob3J0\nKGksIHMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBzZXRJbnQoaW50IGkxLCBpbnQgaTIpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCBpMik7CiAg\nICAgICAgICAgICAgICBzdXBlci5zZXRJbnQoaTEsIGkyKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0TG9uZyhpbnQgaSwg\nbG9uZyBsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHNldExvZ1BhcmFtZXRlcihpLCBsKTsKICAgICAgICAgICAgICAgIHN1cGVy\nLnNldExvbmcoaSwgbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHNldEZsb2F0KGludCBpLCBmbG9hdCBmKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihp\nLCBmKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldEZsb2F0KGksIGYpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXREb3Vi\nbGUoaW50IGksIGRvdWJsZSBkKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBkKTsKICAgICAgICAg\nICAgICAgIHN1cGVyLnNldERvdWJsZShpLCBkKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0QmlnRGVjaW1hbChpbnQgaSwg\nQmlnRGVjaW1hbCBiZCkKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJC\naWdEZWNpbWFsIiwgYmQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0Qmln\nRGVjaW1hbChpLCBiZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHNldFN0cmluZyhpbnQgaSwgU3RyaW5nIHMpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGksICJTdHJpbmciLCBzKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldFN0\ncmluZyhpLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGlj\nIHZvaWQgc2V0Qnl0ZXMoaW50IGksIGJ5dGVbXSBiKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAi\nYnl0ZVtdIiwgYik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRCeXRlcyhp\nLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2V0RGF0ZShpbnQgaSwgRGF0ZSBkKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiRGF0ZSIsIGQp\nOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0RGF0ZShpLCBkKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZShpbnQg\naSwgVGltZSB0KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIHNldExvZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQpOwogICAgICAgICAg\nICAgICAgc3VwZXIuc2V0VGltZShpLCB0KTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKGludCBpLCBUaW1l\nc3RhbXAgdCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlRpbWVzdGFtcCIsIHQpOwogICAgICAg\nICAgICAgICAgc3VwZXIuc2V0VGltZXN0YW1wKGksIHQpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRBc2NpaVN0cmVhbShp\nbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAgICAgICAgICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMpOwogICAgICAgICAg\nICAgICAgc3VwZXIuc2V0QXNjaWlTdHJlYW0oaTEsIGlzLCBpMik7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFVuaWNvZGVT\ndHJlYW0oaW50IGkxLCBJbnB1dFN0cmVhbSBpcywgaW50IGkyKQogICAgICAg\nICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJJbnB1dFN0cmVhbSIsIGlzKTsKICAg\nICAgICAgICAgICAgIHN1cGVyLnNldFVuaWNvZGVTdHJlYW0oaTIsIGlzLCBp\nMik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNl\ndEJpbmFyeVN0cmVhbShpbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIp\nCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwg\naXMpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0QmluYXJ5U3RyZWFtKGkx\nLCBpcywgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBjbGVhclBhcmFtZXRlcnMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyhmYWxzZSk7CiAg\nICAgICAgICAgICAgICBzdXBlci5jbGVhclBhcmFtZXRlcnMoKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KGlu\ndCBpMSwgT2JqZWN0IG8sIGludCBpMiwgaW50IGkzKQogICAgICAgICAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRM\nb2dQYXJhbWV0ZXIoaTEsICJPYmplY3QiLCBvKTsKICAgICAgICAgICAgICAg\nIHN1cGVyLnNldE9iamVjdChpMSwgbywgaTIsIGkzKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KGludCBpMSwg\nT2JqZWN0IG8sIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkx\nLCAiT2JqZWN0Iiwgbyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRPYmpl\nY3QoaTEsIG8sIGkyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0T2JqZWN0KGludCBpLCBPYmplY3QgbykgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naSwgIk9iamVjdCIsIG8pOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0T2Jq\nZWN0KGksIG8pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBhZGRCYXRjaCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgaWYgKF9sb2dzLmlzU1FMRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgIF9sb2dzLmxvZ1NRTCgiYmF0Y2hpbmcgIiArIHRoaXMsIExv\nZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdXBlci5hZGRCYXRj\naCgpOwogICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFt\nZXRlcnMoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1\ncmUgb3VyIGxpc3QgaXMgaW5pdGlhbGl6ZWQKICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKF9wYXJhbUJhdGNoID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBfcGFyYW1CYXRjaCA9IG5ldyBBcnJheUxpc3QoKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29weSBwYXJhbWV0ZXJzIHNp\nbmNlIHRoZXkgd2lsbCBiZSByZS11c2VkCiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChfcGFyYW1zICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBfcGFyYW1CYXRjaC5hZGQobmV3IEFycmF5TGlzdChfcGFyYW1z\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIF9wYXJhbUJhdGNoLmFkZChudWxsKTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0\nYXJ0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2V0Q2hhcmFjdGVyU3RyZWFtKGludCBpMSwg\nUmVhZGVyIHIsIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkx\nLCAiUmVhZGVyIiwgcik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRDaGFy\nYWN0ZXJTdHJlYW0oaTEsIHIsIGkyKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2V0UmVmKGludCBpLCBSZWYgcikgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0\nZXIoaSwgIlJlZiIsIHIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0UmVm\nKGksIHIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBzZXRCbG9iKGludCBpLCBCbG9iIGIpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJCbG9iIiwg\nYik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRCbG9iKGksIGIpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRDbG9iKGlu\ndCBpLCBDbG9iIGMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJDbG9iIiwgYyk7CiAgICAgICAg\nICAgICAgICBzdXBlci5zZXRDbG9iKGksIGMpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRBcnJheShpbnQgaSwgQXJyYXkg\nYSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRM\nb2dQYXJhbWV0ZXIoaSwgIkFycmF5IiwgYSk7CiAgICAgICAgICAgICAgICBz\ndXBlci5zZXRBcnJheShpLCBhKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIFJlc3VsdFNldE1ldGFEYXRhIGdldE1ldGFEYXRhKCkgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3Vw\nZXIuZ2V0TWV0YURhdGEoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIHZvaWQgc2V0RGF0ZShpbnQgaSwgRGF0ZSBkLCBDYWxlbmRhciBj\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpLCAiRGF0ZSIsIGQpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0RGF0ZShpLCBkLCBjKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0VGltZShpbnQgaSwgVGltZSB0LCBDYWxlbmRh\nciBjKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQpOwogICAgICAgICAgICAgICAg\nc3VwZXIuc2V0VGltZShpLCB0LCBjKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKGludCBpLCBUaW1lc3Rh\nbXAgdCwgQ2FsZW5kYXIgYykKICAgICAgICAgICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGks\nICJUaW1lc3RhbXAiLCB0KTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldFRp\nbWVzdGFtcChpLCB0LCBjKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIHZvaWQgc2V0TnVsbChpbnQgaTEsIGludCBpMiwgU3RyaW5nIHMp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9n\nUGFyYW1ldGVyKGkxLCAibnVsbCIsIG51bGwpOwogICAgICAgICAgICAgICAg\nc3VwZXIuc2V0TnVsbChpMSwgaTIsIHMpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwcm90ZWN0ZWQgdm9pZCBhcHBlbmRJbmZvKFN0cmluZ0J1ZmZl\nciBidWYpIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKICAg\nICAgICAgICAgICAgIGlmIChfZm9ybWF0dGVyICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAgICAgICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZChfZm9ybWF0dGVyLnByZXR0eVByaW50KF9zcWwp\nKTsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoX3NxbCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAg\nICAgU3RyaW5nQnVmZmVyIHBhcmFtQnVmID0gbnVsbDsKICAgICAgICAgICAg\nICAgIGlmIChfcGFyYW1zICE9IG51bGwgJiYgIV9wYXJhbXMuaXNFbXB0eSgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgcGFyYW1CdWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChJdGVyYXRvciBp\ndHIgPSBfcGFyYW1zLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmKF9wcmludFBhcmFtZXRlcnMpIHsg\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbUJ1Zi5hcHBlbmQo\naXRyLm5leHQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbUJ1Zi5hcHBlbmQo\nIj8iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ci5uZXh0KCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKGl0ci5oYXNOZXh0KCkpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBwYXJhbUJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlm\nIChwYXJhbUJ1ZiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKCFfcHJldHR5UHJpbnQpCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoIiAiKTsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCJb\ncGFyYW1zPSIpLgogICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQocGFy\nYW1CdWYudG9TdHJpbmcoKSkuYXBwZW5kKCJdIik7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBzdXBlci5hcHBlbmRJbmZvKGJ1Zik7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBjbGVhckxv\nZ1BhcmFtZXRlcnMoYm9vbGVhbiBiYXRjaCkgewogICAgICAgICAgICAgICAg\naWYgKF9wYXJhbXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBfcGFy\nYW1zLmNsZWFyKCk7CiAgICAgICAgICAgICAgICBpZiAoYmF0Y2ggJiYgX3Bh\ncmFtQmF0Y2ggIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBfcGFyYW1C\nYXRjaC5jbGVhcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2\nYXRlIGJvb2xlYW4gc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIF90cmFja1BhcmFtZXRlcnMgfHwgX2xvZ3MuaXNT\nUUxFbmFibGVkKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZh\ndGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBib29sZWFuIHZh\nbCkgewogICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNrUGFyYW1ldGVy\ncygpKQogICAgICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpbmRl\neCwgIihib29sZWFuKSAiICsgdmFsKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5kZXgs\nIGJ5dGUgdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkVHJhY2tQ\nYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1l\ndGVyKGluZGV4LCAiKGJ5dGUpICIgKyB2YWwpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBp\nbmRleCwgZG91YmxlIHZhbCkgewogICAgICAgICAgICAgICAgaWYgKHNob3Vs\nZFRyYWNrUGFyYW1ldGVycygpKQogICAgICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpbmRleCwgIihkb3VibGUpICIgKyB2YWwpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1l\ndGVyKGludCBpbmRleCwgZmxvYXQgdmFsKSB7CiAgICAgICAgICAgICAgICBp\nZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAg\nICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKGZsb2F0KSAiICsgdmFsKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExv\nZ1BhcmFtZXRlcihpbnQgaW5kZXgsIGludCB2YWwpIHsKICAgICAgICAgICAg\nICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoaW50KSAiICsgdmFs\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNl\ndExvZ1BhcmFtZXRlcihpbnQgaW5kZXgsIGxvbmcgdmFsKSB7CiAgICAgICAg\nICAgICAgICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAg\nICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKGxvbmcpICIg\nKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZv\naWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgc2hvcnQgdmFsKSB7CiAg\nICAgICAgICAgICAgICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAg\nICAgICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKHNo\nb3J0KSAiICsgdmFsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJp\ndmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5kZXgsIFN0cmluZyB0\neXBlLCBPYmplY3QgdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hvdWxk\nVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0TG9n\nUGFyYW1ldGVyKGluZGV4LCAiKCIgKyB0eXBlICsgIikgIiArIHZhbCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQ\nYXJhbWV0ZXIoaW50IGluZGV4LCBTdHJpbmcgdmFsKSB7CiAgICAgICAgICAg\nICAgICBpZiAoX3BhcmFtcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIF9wYXJhbXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgICAgICB3\naGlsZSAoX3BhcmFtcy5zaXplKCkgPCBpbmRleCkKICAgICAgICAgICAgICAg\nICAgICBfcGFyYW1zLmFkZChudWxsKTsKICAgICAgICAgICAgICAgIGlmICh2\nYWwubGVuZ3RoKCkgPiA4MCkKICAgICAgICAgICAgICAgICAgICB2YWwgPSB2\nYWwuc3Vic3RyaW5nKDAsIDc3KSArICIuLi4iOwogICAgICAgICAgICAgICAg\nX3BhcmFtcy5zZXQoaW5kZXggLSAxLCB2YWwpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBXYXJuaW5nLWhhbmRs\naW5nIHJlc3VsdCBzZXQuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBj\nbGFzcyBMb2dnaW5nUmVzdWx0U2V0IGV4dGVuZHMgRGVsZWdhdGluZ1Jlc3Vs\ndFNldCB7CgogICAgICAgICAgICBwdWJsaWMgTG9nZ2luZ1Jlc3VsdFNldChS\nZXN1bHRTZXQgcnMsIFN0YXRlbWVudCBzdG1udCkgewogICAgICAgICAgICAg\nICAgc3VwZXIocnMsIHN0bW50KTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIGJvb2xlYW4gbmV4dCgpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gc3VwZXIubmV4dCgpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dp\nbmdSZXN1bHRTZXQudGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHN1cGVyLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5p\nbmcoTG9nZ2luZ1Jlc3VsdFNldC50aGlzKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgYmVmb3Jl\nRmlyc3QoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgc3VwZXIuYmVmb3JlRmlyc3Qo\nKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICAgICAgaGFuZGxlU1FMV2FybmluZyhMb2dnaW5nUmVzdWx0U2V0LnRoaXMp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBhZnRlckxhc3QoKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\nc3VwZXIuYWZ0ZXJMYXN0KCk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoTG9nZ2lu\nZ1Jlc3VsdFNldC50aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gZmlyc3QoKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmZpcnN0KCk7CiAgICAgICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGhhbmRs\nZVNRTFdhcm5pbmcoTG9nZ2luZ1Jlc3VsdFNldC50aGlzKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJv\nb2xlYW4gbGFzdCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nbGFzdCgpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdSZXN1bHRTZXQu\ndGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyBib29sZWFuIGFic29sdXRlKGludCBhKSB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmFic29sdXRlKGEpOwogICAgICAg\nICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBoYW5k\nbGVTUUxXYXJuaW5nKExvZ2dpbmdSZXN1bHRTZXQudGhpcyk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBi\nb29sZWFuIHJlbGF0aXZlKGludCBhKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLnJlbGF0aXZlKGEpOwogICAgICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKExv\nZ2dpbmdSZXN1bHRTZXQudGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIHByZXZpb3Vz\nKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5wcmV2aW91cygp\nOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nICAgICBoYW5kbGVTUUxXYXJuaW5nKExvZ2dpbmdSZXN1bHRTZXQudGhpcyk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICB9Cn0K\n","encoding":"base64"}

