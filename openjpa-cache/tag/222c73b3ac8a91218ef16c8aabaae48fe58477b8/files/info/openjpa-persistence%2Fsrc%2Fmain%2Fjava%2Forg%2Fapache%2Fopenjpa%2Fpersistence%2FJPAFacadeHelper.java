{"sha":"ffef42e7559028b56d6afd197fcfa802abdad5a6","node_id":"MDQ6QmxvYjIwNjM2NDpmZmVmNDJlNzU1OTAyOGI1NmQ2YWZkMTk3ZmNmYTgwMmFiZGFkNWE2","size":11302,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ffef42e7559028b56d6afd197fcfa802abdad5a6","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBq\nYXZhLm1hdGguQmlnRGVjaW1hbDsKaW1wb3J0IGphdmEubWF0aC5CaWdJbnRl\nZ2VyOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwpp\nbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwoKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXJGYWN0b3J5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkJpZ0RlY2ltYWxJZDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkJpZ0ludGVnZXJJZDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkJ5dGVJZDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLkNoYXJJZDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkRvdWJsZUlkOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuRmxvYXRJZDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLklkOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW1w\nbEhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludElk\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTG9uZ0lkOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT2JqZWN0SWQ7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBSWQ7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5TaG9ydElkOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuU3RyaW5nSWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwoKLyoqCiAqIEhlbHBlciBjbGFz\ncyBmb3Igc3dpdGNoaW5nIGJldHdlZW4gT3BlbkpQQSdzIEpQQSBmYWNhZGUg\nYW5kIHRoZSB1bmRlcmx5aW5nCiAqIEJyb2tlciBrZXJuZWwuCiAqCiAqIEBz\naW5jZSAxLjAuMAogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgSlBB\nRmFjYWRlSGVscGVyIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBFTV9LRVkgPQogICAgICAgICJvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuRW50aXR5TWFuYWdlciI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBFTUZfS0VZID0KICAgICAgICAib3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5IjsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9CiAgICAgICAgTG9j\nYWxpemVyLmZvclBhY2thZ2UoSlBBRmFjYWRlSGVscGVyLmNsYXNzKTsKCiAg\nICBwdWJsaWMgc3RhdGljIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSB0\nb0VudGl0eU1hbmFnZXJGYWN0b3J5KAogICAgICAgIEJyb2tlckZhY3Rvcnkg\nZmFjdG9yeSkgewogICAgICAgIGlmIChmYWN0b3J5ID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBmYWN0b3J5LmxvY2soKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnkgZW1mID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSkK\nICAgICAgICAgICAgICAgIGZhY3RvcnkuZ2V0VXNlck9iamVjdChFTUZfS0VZ\nKTsKICAgICAgICAgICAgaWYgKGVtZiA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBlbWYgPSBFbnRpdHlNYW5hZ2VyRmFjdG9yeVZhbHVlLm5ld0ZhY3Rv\ncnkoZmFjdG9yeSk7CiAgICAgICAgICAgICAgICBmYWN0b3J5LnB1dFVzZXJP\nYmplY3QoRU1GX0tFWSwgZW1mKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gZW1mOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIHRocm93IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1Bl\ncnNpc3RlbmNlRXhjZXB0aW9uKGUpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIGZhY3RvcnkudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB1bmRlcmx5aW5nIGJyb2tlciBm\nYWN0b3J5IGZvciB0aGUgZ2l2ZW4gcGVyc2lzdGVuY2UgbWFuYWdlcgogICAg\nICogZmFjdG9yeSBmYWNhZGUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nQnJva2VyRmFjdG9yeSB0b0Jyb2tlckZhY3RvcnkoRW50aXR5TWFuYWdlckZh\nY3RvcnkgZW1mKSB7CiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoIShlbWYgaW5zdGFuY2Vv\nZiBFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwpKSB7CiAgICAgICAgICAgIENs\nYXNzIGMgPSBlbWYuZ2V0Q2xhc3MoKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIC8vIGVpdGhlciBjYXN0IGhlcmUgbWF5IGZhaWwKICAg\nICAgICAgICAgICAgIGVtZiA9IChFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwp\nICgoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5KQogICAgICAgICAgICAg\nICAgICAgIGVtZikuZ2V0VXNlck9iamVjdChFTUZfS0VZKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoQ2xhc3NDYXN0RXhjZXB0aW9uIGNjZSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0\nKAogICAgICAgICAgICAgICAgICAgICJjYW50LWNvbnZlcnQtYnJva2VyZmFj\ndG9yeSIsIGMpLCBudWxsLCBudWxsLCBmYWxzZSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuICgoRW50aXR5TWFuYWdlckZhY3Rv\ncnlJbXBsKSBlbWYpLmdldEJyb2tlckZhY3RvcnkoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBhIHBlcnNpc3RlbmNlIG1hbmFnZXIgZmFjYWRl\nIHRvIHRoZSBnaXZlbiBicm9rZXIgcmV0YWluaW5nCiAgICAgKiBwcmV2aW91\nc2x5IGFzc29jaWF0ZWQgcGVyc2lzdGVuY2UgY29udGV4dCB0eXBlLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHRv\nRW50aXR5TWFuYWdlcihCcm9rZXIgYnJva2VyKSB7CiAgICAgICAgaWYgKGJy\nb2tlciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAg\nICAgYnJva2VyLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBP\ncGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50aXR5TWFuYWdl\ncikKICAgICAgICAgICAgICAgIGJyb2tlci5nZXRVc2VyT2JqZWN0KEVNX0tF\nWSk7CiAgICAgICAgICAgIGlmIChlbSA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwgZW1mID0gKEVudGl0eU1h\nbmFnZXJGYWN0b3J5SW1wbCkKICAgICAgICAgICAgICAgICAgICB0b0VudGl0\neU1hbmFnZXJGYWN0b3J5KGJyb2tlci5nZXRCcm9rZXJGYWN0b3J5KCkpOwog\nICAgICAgICAgICAgICAgZW0gPSBlbWYubmV3RW50aXR5TWFuYWdlckltcGwo\nYnJva2VyKTsKICAgICAgICAgICAgICAgIGJyb2tlci5wdXRVc2VyT2JqZWN0\nKEVNX0tFWSwgZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVy\nbiBlbTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5j\nZUV4Y2VwdGlvbihlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBicm9rZXIudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSB1bmRlcmx5aW5nIGJyb2tlciBmb3IgdGhlIGdp\ndmVuIGVudGl0eSBtYW5hZ2VyIGZhY2FkZS4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBCcm9rZXIgdG9Ccm9rZXIoRW50aXR5TWFuYWdlciBlbSkgewog\nICAgICAgIGlmIChlbSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAoIShlbSBpbnN0YW5jZW9mIEVudGl0eU1hbmFnZXJJ\nbXBsKSkgewogICAgICAgICAgICBDbGFzcyBjID0gZW0uZ2V0Q2xhc3MoKTsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIGVpdGhlciBj\nYXN0IGhlcmUgbWF5IGZhaWwKICAgICAgICAgICAgICAgIGVtID0gKEVudGl0\neU1hbmFnZXJJbXBsKSAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBlbSkuCiAg\nICAgICAgICAgICAgICAgICAgZ2V0VXNlck9iamVjdChFTV9LRVkpOwogICAg\nICAgICAgICB9IGNhdGNoIChDbGFzc0Nhc3RFeGNlcHRpb24gY2NlKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xv\nYy5nZXQoImNhbnQtY29udmVydC1icm9rZXIiLCBjKSwKICAgICAgICAgICAg\nICAgICAgICBudWxsLCBudWxsLCBmYWxzZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuICgoRW50aXR5TWFuYWdlckltcGwpIGVt\nKS5nZXRCcm9rZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMg\ndGhlIHtAbGluayBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFE\nYXRhfSBhc3NvY2lhdGVkIHdpdGggdGhlCiAgICAgKiBwZXJzaXN0ZW50IG9i\namVjdCA8Y29kZT5vPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBDbGFzc01ldGFEYXRhIGdldE1ldGFEYXRhKE9iamVjdCBvKSB7CiAgICAg\nICAgaWYgKG8gPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgRW50aXR5TWFuYWdlciBlbSA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5n\nZXRFbnRpdHlNYW5hZ2VyKG8pOwogICAgICAgIHJldHVybiAoZW0gPT0gbnVs\nbCkgPyBudWxsIDogZ2V0TWV0YURhdGEoZW0sCiAgICAgICAgICAgIEltcGxI\nZWxwZXIuZ2V0TWFuYWdlZEluc3RhbmNlKG8pLmdldENsYXNzKCkpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUge0BsaW5rIG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGF9IGFzc29jaWF0ZWQKICAg\nICAqIHdpdGggdGhlIHBlcnNpc3RlbnQgdHlwZSA8Y29kZT5jbHM8L2NvZGU+\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIENsYXNzTWV0YURhdGEgZ2V0\nTWV0YURhdGEoRW50aXR5TWFuYWdlciBlbSwgQ2xhc3MgY2xzKSB7CiAgICAg\nICAgaWYgKGVtID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBOdWxs\nUG9pbnRlckV4Y2VwdGlvbigiZW0gPT0gbnVsbCIpOwoKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlclNQSSBrZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFn\nZXJTUEkpCiAgICAgICAgICAgIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVt\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4ga2VtLmdldENv\nbmZpZ3VyYXRpb24oKS5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgp\nLgogICAgICAgICAgICAgICAgZ2V0TWV0YURhdGEoY2xzLCBrZW0uZ2V0Q2xh\nc3NMb2FkZXIoKSwgZmFsc2UpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIHRocm93IFBlcnNpc3RlbmNlRXhjZXB0aW9u\ncy50b1BlcnNpc3RlbmNlRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHtAbGluayBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhfSBhc3NvY2lhdGVkCiAgICAg\nKiB3aXRoIHRoZSBwZXJzaXN0ZW50IHR5cGUgPGNvZGU+Y2xzPC9jb2RlPi4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBDbGFzc01ldGFEYXRhIGdldE1l\ndGFEYXRhKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiwKICAgICAgICBDbGFz\ncyBjbHMpIHsKICAgICAgICBpZiAoZW1mID09IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigiZW1mID09IG51bGwi\nKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVt\nZlNQSSA9CiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnlTUEkpIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVtZik7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGVtZlNQSS5nZXRDb25maWd1cmF0\naW9uKCkuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4KICAgICAg\nICAgICAgICAgIGdldE1ldGFEYXRhKGNscywgbnVsbCwgZmFsc2UpOwogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93\nIFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9u\nKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0\nZSBmcm9tIGEgT3BlbkpQQSBpZGVudGl0eSBvYmplY3QgdG8gYSBQZXJzaXN0\nZW5jZSBvbmUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IGZy\nb21PcGVuSlBBT2JqZWN0SWQoT2JqZWN0IG9pZCkgewogICAgICAgIGlmIChv\naWQgaW5zdGFuY2VvZiBPcGVuSlBBSWQpCiAgICAgICAgICAgIHJldHVybiAo\nKE9wZW5KUEFJZCkgb2lkKS5nZXRJZE9iamVjdCgpOwogICAgICAgIHJldHVy\nbiBvaWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgZnJvbSBh\nIFBlcnNpc3RlbmNlIGlkZW50aXR5IG9iamVjdCB0byBhIE9wZW5KUEEgb25l\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCB0b09wZW5KUEFP\nYmplY3RJZChDbGFzc01ldGFEYXRhIG1ldGEsIE9iamVjdCBvaWQpIHsKICAg\nICAgICBpZiAob2lkID09IG51bGwgfHwgbWV0YSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ2xhc3MgY2xzID0gbWV0YS5n\nZXREZXNjcmliZWRUeXBlKCk7CiAgICAgICAgaWYgKG1ldGEuZ2V0SWRlbnRp\ndHlUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0YS5JRF9EQVRBU1RPUkUpCiAgICAg\nICAgICAgIHJldHVybiBuZXcgSWQoY2xzLCAoKE51bWJlcikgb2lkKS5sb25n\nVmFsdWUoKSk7CgogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBCeXRlKQog\nICAgICAgICAgICByZXR1cm4gbmV3IEJ5dGVJZChjbHMsIChCeXRlKSBvaWQp\nOwogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBDaGFyYWN0ZXIpCiAgICAg\nICAgICAgIHJldHVybiBuZXcgQ2hhcklkKGNscywgKENoYXJhY3Rlcikgb2lk\nKTsKICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgRG91YmxlKQogICAgICAg\nICAgICByZXR1cm4gbmV3IERvdWJsZUlkKGNscywgKERvdWJsZSkgb2lkKTsK\nICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgRmxvYXQpCiAgICAgICAgICAg\nIHJldHVybiBuZXcgRmxvYXRJZChjbHMsIChGbG9hdCkgb2lkKTsKICAgICAg\nICBpZiAob2lkIGluc3RhbmNlb2YgSW50ZWdlcikKICAgICAgICAgICAgcmV0\ndXJuIG5ldyBJbnRJZChjbHMsIChJbnRlZ2VyKSBvaWQpOwogICAgICAgIGlm\nIChvaWQgaW5zdGFuY2VvZiBMb25nKQogICAgICAgICAgICByZXR1cm4gbmV3\nIExvbmdJZChjbHMsIChMb25nKSBvaWQpOwogICAgICAgIGlmIChvaWQgaW5z\ndGFuY2VvZiBTaG9ydCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBTaG9ydElk\nKGNscywgKFNob3J0KSBvaWQpOwogICAgICAgIGlmIChvaWQgaW5zdGFuY2Vv\nZiBTdHJpbmcpCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nSWQoY2xz\nLCAoU3RyaW5nKSBvaWQpOwogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBC\naWdEZWNpbWFsKQogICAgICAgICAgICByZXR1cm4gbmV3IEJpZ0RlY2ltYWxJ\nZChjbHMsIChCaWdEZWNpbWFsKSBvaWQpOwogICAgICAgIGlmIChvaWQgaW5z\ndGFuY2VvZiBCaWdJbnRlZ2VyKQogICAgICAgICAgICByZXR1cm4gbmV3IEJp\nZ0ludGVnZXJJZChjbHMsIChCaWdJbnRlZ2VyKSBvaWQpOwogICAgICAgIHJl\ndHVybiBuZXcgT2JqZWN0SWQoY2xzLCBvaWQpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIGFuIGFycmF5IG9mIE9wZW5KUEEgb2lkcyBmb3IgdGhl\nIGdpdmVuIG5hdGl2ZSBvaWQgYXJyYXkuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgT2JqZWN0W10gdG9PcGVuSlBBT2JqZWN0SWRzKENsYXNzTWV0YURh\ndGEgbWV0YSwKICAgICAgICBPYmplY3QuLi4gb2lkcykgewogICAgICAgIGlm\nIChvaWRzID09IG51bGwgfHwgb2lkcy5sZW5ndGggPT0gMCkKICAgICAgICAg\nICAgcmV0dXJuIG9pZHM7CgogICAgICAgIC8vIHNpbmNlIHRoZSBjbGFzcyBp\nZiBmaXhlZCBmb3IgYWxsIG9pZHMsIHdlIGNhbiB0ZWxsIGlmIHdlIGhhdmUg\ndG8KICAgICAgICAvLyB0cmFuc2xhdGUgdGhlIGFycmF5IGJhc2VkIG9uIHdo\nZXRoZXIgdGhlIGZpcnN0IG9pZCBuZWVkcyB0cmFuc2xhdGluZwogICAgICAg\nIE9iamVjdCBvaWQgPSB0b09wZW5KUEFPYmplY3RJZChtZXRhLCBvaWRzWzBd\nKTsKICAgICAgICBpZiAob2lkID09IG9pZHNbMF0pCiAgICAgICAgICAgIHJl\ndHVybiBvaWRzOwoKICAgICAgICBPYmplY3RbXSBjb3B5ID0gbmV3IE9iamVj\ndFtvaWRzLmxlbmd0aF07CiAgICAgICAgY29weVswXSA9IG9pZDsKICAgICAg\nICBmb3IgKGludCBpID0gMTsgaSA8IG9pZHMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIGNvcHlbaV0gPSB0b09wZW5KUEFPYmplY3RJZChtZXRhLCBvaWRz\nW2ldKTsKICAgICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBhIGNvbGxlY3Rpb24gb2YgT3BlbkpQQSBvaWRzIGZvciB0\naGUgZ2l2ZW4gbmF0aXZlIG9pZCBjb2xsZWN0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIENvbGxlY3Rpb24gdG9PcGVuSlBBT2JqZWN0SWRzKENs\nYXNzTWV0YURhdGEgbWV0YSwKICAgICAgICBDb2xsZWN0aW9uIG9pZHMpIHsK\nICAgICAgICBpZiAob2lkcyA9PSBudWxsIHx8IG9pZHMuaXNFbXB0eSgpKQog\nICAgICAgICAgICByZXR1cm4gb2lkczsKCiAgICAgICAgLy8gc2luY2UgdGhl\nIGNsYXNzIGlmIGZpeGVkIGZvciBhbGwgb2lkcywgd2UgY2FuIHRlbGwgaWYg\nd2UgaGF2ZSB0bwogICAgICAgIC8vIHRyYW5zbGF0ZSB0aGUgYXJyYXkgYmFz\nZWQgb24gd2hldGhlciB0aGUgZmlyc3Qgb2lkIG5lZWRzIHRyYW5zbGF0aW5n\nCiAgICAgICAgSXRlcmF0b3IgaXRyID0gb2lkcy5pdGVyYXRvcigpOwogICAg\nICAgIE9iamVjdCBvcmlnID0gaXRyLm5leHQoKTsKICAgICAgICBPYmplY3Qg\nb2lkID0gdG9PcGVuSlBBT2JqZWN0SWQobWV0YSwgb3JpZyk7CiAgICAgICAg\naWYgKG9pZCA9PSBvcmlnKQogICAgICAgICAgICByZXR1cm4gb2lkczsKCiAg\nICAgICAgQ29sbGVjdGlvbiBjb3B5ID0gbmV3IEFycmF5TGlzdChvaWRzLnNp\nemUoKSk7CiAgICAgICAgY29weS5hZGQob2lkKTsKICAgICAgICB3aGlsZSAo\naXRyLmhhc05leHQoKSkKICAgICAgICAgICAgY29weS5hZGQodG9PcGVuSlBB\nT2JqZWN0SWQobWV0YSwgaXRyLm5leHQoKSkpOwogICAgICAgIHJldHVybiBj\nb3B5OwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNsYXRlIGZyb20gYSBP\ncGVuSlBBIGlkZW50aXR5IGNsYXNzIHRvIGEgbmF0aXZlIG9uZS4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBDbGFzcyBmcm9tT3BlbkpQQU9iamVjdElk\nQ2xhc3MoQ2xhc3Mgb2lkQ2xhc3MpIHsKICAgICAgICBpZiAob2lkQ2xhc3Mg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYg\nKG9pZENsYXNzID09IElkLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gTG9u\nZy5jbGFzczsKICAgICAgICBpZiAob2lkQ2xhc3MgPT0gQnl0ZUlkLmNsYXNz\nKQogICAgICAgICAgICByZXR1cm4gQnl0ZS5jbGFzczsKICAgICAgICBpZiAo\nb2lkQ2xhc3MgPT0gQ2hhcklkLmNsYXNzKQogICAgICAgICAgICByZXR1cm4g\nQ2hhcmFjdGVyLmNsYXNzOwogICAgICAgIGlmIChvaWRDbGFzcyA9PSBEb3Vi\nbGVJZC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIERvdWJsZS5jbGFzczsK\nICAgICAgICBpZiAob2lkQ2xhc3MgPT0gRmxvYXRJZC5jbGFzcykKICAgICAg\nICAgICAgcmV0dXJuIEZsb2F0LmNsYXNzOwogICAgICAgIGlmIChvaWRDbGFz\ncyA9PSBJbnRJZC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIEludGVnZXIu\nY2xhc3M7CiAgICAgICAgaWYgKG9pZENsYXNzID09IExvbmdJZC5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuIExvbmcuY2xhc3M7CiAgICAgICAgaWYgKG9p\nZENsYXNzID09IFNob3J0SWQuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBT\naG9ydC5jbGFzczsKICAgICAgICBpZiAob2lkQ2xhc3MgPT0gU3RyaW5nSWQu\nY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuY2xhc3M7CiAgICAg\nICAgaWYgKG9pZENsYXNzID09IEJpZ0RlY2ltYWxJZC5jbGFzcykKICAgICAg\nICAgICAgcmV0dXJuIEJpZ0RlY2ltYWwuY2xhc3M7CiAgICAgICAgaWYgKG9p\nZENsYXNzID09IEJpZ0ludGVnZXJJZC5jbGFzcykKICAgICAgICAgICAgcmV0\ndXJuIEJpZ0ludGVnZXIuY2xhc3M7CiAgICAgICAgcmV0dXJuIG9pZENsYXNz\nOwoJfQp9Cg==\n","encoding":"base64"}

