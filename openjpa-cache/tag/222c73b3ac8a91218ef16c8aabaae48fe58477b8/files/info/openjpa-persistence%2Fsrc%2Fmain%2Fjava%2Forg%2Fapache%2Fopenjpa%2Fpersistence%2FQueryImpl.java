{"sha":"06a2863c8a8301f32b2bf25ee8545e815a59fa57","node_id":"MDQ6QmxvYjIwNjM2NDowNmEyODYzYzhhODMwMWYzMmIyYmYyNWVlODU0NWU4MTVhNTlmYTU3","size":18891,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/06a2863c8a8301f32b2bf25ee8545e815a59fa57","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLmxhbmcucmVm\nbGVjdC5NZXRob2Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBq\nYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBv\ncnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkZsdXNoTW9kZVR5cGU7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlRlbXBvcmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMuY29sbGVjdGlvbnMubWFwLkxpbmtlZE1hcDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5lbmhhbmNlLlJlZmxlY3Rpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLkRlbGVnYXRpbmdRdWVyeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGVsZWdhdGluZ1Jlc3VsdExpc3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5TGFuZ3VhZ2Vz\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeU9wZXJh\ndGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMu\nQWdncmVnYXRlTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLmV4cHMuRmlsdGVyTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnJvcC5SZXN1bHRMaXN0OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7CgovKioKICogSW1wbGVtZW50\nYXRpb24gb2Yge0BsaW5rIFF1ZXJ5fSBpbnRlcmZhY2UuCiAqCiAqIEBhdXRo\nb3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBRdWVyeUltcGwKICAgIGlt\ncGxlbWVudHMgT3BlbkpQQVF1ZXJ5U1BJLCBTZXJpYWxpemFibGUgewoKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIE9iamVjdFtdIEVNUFRZX0FSUkFZID0g\nbmV3IE9iamVjdFswXTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2Nh\nbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFF1\nZXJ5SW1wbC5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBEZWxlZ2F0aW5n\nUXVlcnkgX3F1ZXJ5OwogICAgcHJpdmF0ZSB0cmFuc2llbnQgRW50aXR5TWFu\nYWdlckltcGwgX2VtOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgRmV0Y2hQbGFu\nIF9mZXRjaDsKCiAgICBwcml2YXRlIE1hcCBfbmFtZWQ7CiAgICBwcml2YXRl\nIExpc3QgX3Bvc2l0aW9uYWw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rv\ncjsgc3VwcGx5IGZhY3RvcnkgYW5kIGRlbGVnYXRlLgogICAgICovCiAgICBw\ndWJsaWMgUXVlcnlJbXBsKEVudGl0eU1hbmFnZXJJbXBsIGVtLAogICAgICAg\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcXVlcnkpIHsKICAg\nICAgICBfZW0gPSBlbTsKICAgICAgICBfcXVlcnkgPSBuZXcgRGVsZWdhdGlu\nZ1F1ZXJ5KHF1ZXJ5LAogICAgICAgICAgICBQZXJzaXN0ZW5jZUV4Y2VwdGlv\nbnMuZ2V0Um9sbGJhY2tUcmFuc2xhdG9yKGVtKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBEZWxlZ2F0ZS4KICAgICAqLwogICAgcHVibGljIG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgZ2V0RGVsZWdhdGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9xdWVyeS5nZXREZWxlZ2F0ZSgpOwogICAgfQoKICAgIHB1\nYmxpYyBPcGVuSlBBRW50aXR5TWFuYWdlciBnZXRFbnRpdHlNYW5hZ2VyKCkg\newogICAgICAgIHJldHVybiBfZW07CiAgICB9CgogICAgcHVibGljIFN0cmlu\nZyBnZXRMYW5ndWFnZSgpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LmdldExh\nbmd1YWdlKCk7CiAgICB9CgogICAgcHVibGljIFF1ZXJ5T3BlcmF0aW9uVHlw\nZSBnZXRPcGVyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIFF1ZXJ5T3BlcmF0\naW9uVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX3F1ZXJ5LmdldE9wZXJhdGlv\nbigpKTsKICAgIH0KCiAgICBwdWJsaWMgRmV0Y2hQbGFuIGdldEZldGNoUGxh\nbigpIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX3F1ZXJ5LmFzc2VydE5vdFNlcmlhbGl6ZWQoKTsKICAgICAgICBf\ncXVlcnkubG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChf\nZmV0Y2ggPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9mZXRjaCA9ICgoRW50\naXR5TWFuYWdlckZhY3RvcnlJbXBsKSBfZW0uCiAgICAgICAgICAgICAgICAg\nICAgZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKSkudG9GZXRjaFBsYW4oX3F1\nZXJ5LmdldEJyb2tlcigpLAogICAgICAgICAgICAgICAgICAgIF9xdWVyeS5n\nZXRGZXRjaENvbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgICAgIHJldHVybiBf\nZmV0Y2g7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX3F1ZXJ5\nLnVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgU3RyaW5n\nIGdldFF1ZXJ5U3RyaW5nKCkgewogICAgICAgIHJldHVybiBfcXVlcnkuZ2V0\nUXVlcnlTdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJ\nZ25vcmVDaGFuZ2VzKCkgewogICAgICAgIHJldHVybiBfcXVlcnkuZ2V0SWdu\nb3JlQ2hhbmdlcygpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkg\nc2V0SWdub3JlQ2hhbmdlcyhib29sZWFuIGlnbm9yZSkgewogICAgICAgIF9l\nbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfcXVlcnkuc2V0\nSWdub3JlQ2hhbmdlcyhpZ25vcmUpOwogICAgICAgIHJldHVybiB0aGlzOwog\nICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgYWRkRmlsdGVyTGlzdGVu\nZXIoRmlsdGVyTGlzdGVuZXIgbGlzdGVuZXIpIHsKICAgICAgICBfZW0uYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX3F1ZXJ5LmFkZEZpbHRl\nckxpc3RlbmVyKGxpc3RlbmVyKTsKICAgICAgICByZXR1cm4gdGhpczsKICAg\nIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHJlbW92ZUZpbHRlckxpc3Rl\nbmVyKEZpbHRlckxpc3RlbmVyIGxpc3RlbmVyKSB7CiAgICAgICAgX2VtLmFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9xdWVyeS5yZW1vdmVG\naWx0ZXJMaXN0ZW5lcihsaXN0ZW5lcik7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBhZGRBZ2dyZWdhdGVM\naXN0ZW5lcihBZ2dyZWdhdGVMaXN0ZW5lciBsaXN0ZW5lcikgewogICAgICAg\nIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfcXVlcnku\nYWRkQWdncmVnYXRlTGlzdGVuZXIobGlzdGVuZXIpOwogICAgICAgIHJldHVy\nbiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgcmVtb3Zl\nQWdncmVnYXRlTGlzdGVuZXIoQWdncmVnYXRlTGlzdGVuZXIgbGlzdGVuZXIp\nIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX3F1ZXJ5LnJlbW92ZUFnZ3JlZ2F0ZUxpc3RlbmVyKGxpc3RlbmVyKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVj\ndGlvbiBnZXRDYW5kaWRhdGVDb2xsZWN0aW9uKCkgewogICAgICAgIHJldHVy\nbiBfcXVlcnkuZ2V0Q2FuZGlkYXRlQ29sbGVjdGlvbigpOwogICAgfQoKICAg\nIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0Q2FuZGlkYXRlQ29sbGVjdGlvbihD\nb2xsZWN0aW9uIGNvbGwpIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgX3F1ZXJ5LnNldENhbmRpZGF0ZUNvbGxlY3Rp\nb24oY29sbCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVi\nbGljIENsYXNzIGdldFJlc3VsdENsYXNzKCkgewogICAgICAgIENsYXNzIHJl\ncyA9IF9xdWVyeS5nZXRSZXN1bHRUeXBlKCk7CiAgICAgICAgaWYgKHJlcyAh\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgIHJldHVy\nbiBfcXVlcnkuZ2V0Q2FuZGlkYXRlVHlwZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyBPcGVuSlBBUXVlcnkgc2V0UmVzdWx0Q2xhc3MoQ2xhc3MgY2xzKSB7CiAg\nICAgICAgX2VtLmFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGlm\nIChJbXBsSGVscGVyLmlzTWFuYWdlZFR5cGUoX2VtLmdldENvbmZpZ3VyYXRp\nb24oKSwgY2xzKSkKICAgICAgICAgICAgX3F1ZXJ5LnNldENhbmRpZGF0ZVR5\ncGUoY2xzLCB0cnVlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9xdWVy\neS5zZXRSZXN1bHRUeXBlKGNscyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gaGFzU3ViY2xhc3NlcygpIHsKICAg\nICAgICByZXR1cm4gX3F1ZXJ5Lmhhc1N1YmNsYXNzZXMoKTsKICAgIH0KCiAg\nICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNldFN1YmNsYXNzZXMoYm9vbGVhbiBz\ndWJzKSB7CiAgICAgICAgX2VtLmFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIENsYXNzIGNscyA9IF9xdWVyeS5nZXRDYW5kaWRhdGVUeXBlKCk7\nCiAgICAgICAgX3F1ZXJ5LnNldENhbmRpZGF0ZUV4dGVudChfcXVlcnkuZ2V0\nQnJva2VyKCkubmV3RXh0ZW50KGNscywgc3VicykpOwogICAgICAgIHJldHVy\nbiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0Rmlyc3RSZXN1bHQo\nKSB7CiAgICAgICAgcmV0dXJuIGFzSW50KF9xdWVyeS5nZXRTdGFydFJhbmdl\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0Rmlyc3RS\nZXN1bHQoaW50IHN0YXJ0UG9zaXRpb24pIHsKICAgICAgICBfZW0uYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgbG9uZyBlbmQ7CiAgICAgICAg\naWYgKF9xdWVyeS5nZXRFbmRSYW5nZSgpID09IExvbmcuTUFYX1ZBTFVFKQog\nICAgICAgICAgICBlbmQgPSBMb25nLk1BWF9WQUxVRTsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIGVuZCA9IHN0YXJ0UG9zaXRpb24gKwogICAgICAgICAg\nICAgICAgKF9xdWVyeS5nZXRFbmRSYW5nZSgpIC0gX3F1ZXJ5LmdldFN0YXJ0\nUmFuZ2UoKSk7CiAgICAgICAgX3F1ZXJ5LnNldFJhbmdlKHN0YXJ0UG9zaXRp\nb24sIGVuZCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVi\nbGljIGludCBnZXRNYXhSZXN1bHRzKCkgewogICAgICAgIHJldHVybiBhc0lu\ndChfcXVlcnkuZ2V0RW5kUmFuZ2UoKSAtIF9xdWVyeS5nZXRTdGFydFJhbmdl\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0TWF4UmVz\ndWx0cyhpbnQgbWF4KSB7CiAgICAgICAgX2VtLmFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIGxvbmcgc3RhcnQgPSBfcXVlcnkuZ2V0U3RhcnRS\nYW5nZSgpOwogICAgICAgIGlmIChtYXggPT0gSW50ZWdlci5NQVhfVkFMVUUp\nCiAgICAgICAgICAgIF9xdWVyeS5zZXRSYW5nZShzdGFydCwgTG9uZy5NQVhf\nVkFMVUUpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX3F1ZXJ5LnNldFJh\nbmdlKHN0YXJ0LCBzdGFydCArIG1heCk7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjb21waWxlKCkgewog\nICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBf\ncXVlcnkuY29tcGlsZSgpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoK\nICAgIHByaXZhdGUgT2JqZWN0IGV4ZWN1dGUoKSB7CiAgICAgICAgaWYgKCEg\naXNOYXRpdmUoKSAmJiBfcXVlcnkuZ2V0T3BlcmF0aW9uKCkgIT0gUXVlcnlP\ncGVyYXRpb25zLk9QX1NFTEVDVCkKICAgICAgICAgICAgdGhyb3cgbmV3IElu\ndmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibm90LXNlbGVjdC1xdWVy\neSIsCiAgICAgICAgICAgICAgICBfcXVlcnkuZ2V0UXVlcnlTdHJpbmcoKSks\nIG51bGwsIG51bGwsIGZhbHNlKTsKCiAgICAgICAgdmFsaWRhdGVQYXJhbWV0\nZXJzKCk7CgogICAgICAgIC8vIGhhbmRsZSB3aGljaCB0eXBlcyBvZiBwYXJh\nbWV0ZXJzIHdlIGFyZSB1c2luZywgaWYgYW55CiAgICAgICAgaWYgKF9wb3Np\ndGlvbmFsICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBfcXVlcnkuZXhl\nY3V0ZShfcG9zaXRpb25hbC50b0FycmF5KCkpOwogICAgICAgIGlmIChfbmFt\nZWQgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9xdWVyeS5leGVjdXRl\nKF9uYW1lZCk7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5leGVjdXRlKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRoZSB0eXBlcyBv\nZiB0aGUgcGFyYW1ldGVycyBhcmUgY29ycmVjdC4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHZhbGlkYXRlUGFyYW1ldGVycygpIHsKICAgICAgICBpZiAo\nX3Bvc2l0aW9uYWwgIT0gbnVsbCkgewogICAgICAgICAgICBMaW5rZWRNYXAg\ndHlwZXMgPSBfcXVlcnkuZ2V0UGFyYW1ldGVyVHlwZXMoKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDAsCiAgICAgICAgICAgICAgICBzaXplID0gTWF0\naC5taW4oX3Bvc2l0aW9uYWwuc2l6ZSgpLCB0eXBlcy5zaXplKCkpOwogICAg\nICAgICAgICAgICAgaSA8IHNpemU7IGkrKykKICAgICAgICAgICAgICAgIHZh\nbGlkYXRlUGFyYW1ldGVyKFN0cmluZy52YWx1ZU9mKGkpLAogICAgICAgICAg\nICAgICAgICAgIChDbGFzcykgdHlwZXMuZ2V0VmFsdWUoaSksIF9wb3NpdGlv\nbmFsLmdldChpKSk7CiAgICAgICAgfSBlbHNlIGlmIChfbmFtZWQgIT0gbnVs\nbCkgewogICAgICAgICAgICBNYXAgdHlwZXMgPSBfcXVlcnkuZ2V0UGFyYW1l\ndGVyVHlwZXMoKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpID0gX25h\nbWVkLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7CiAg\nICAgICAgICAgICAgICBNYXAuRW50cnkgZW50cnkgPSAoTWFwLkVudHJ5KSBp\nLm5leHQoKTsKICAgICAgICAgICAgICAgIFN0cmluZyBuYW1lID0gKFN0cmlu\nZykgZW50cnkuZ2V0S2V5KCk7CiAgICAgICAgICAgICAgICB2YWxpZGF0ZVBh\ncmFtZXRlcihuYW1lLCAoQ2xhc3MpIHR5cGVzLmdldChuYW1lKSwKICAgICAg\nICAgICAgICAgICAgICBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgdmFsaWRhdGVQ\nYXJhbWV0ZXIoU3RyaW5nIHBhcmFtRGVzYywgQ2xhc3MgdHlwZSwgT2JqZWN0\nIHBhcmFtKSB7CiAgICAgICAgLy8gbnVsbCBwYXJhbWV0ZXJzIGFyZSBhbGxv\nd2VkLCBzbyBhcmUgbm90IHZhbGlkYXRlZAogICAgICAgIGlmIChwYXJhbSA9\nPSBudWxsIHx8IHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICAvLyBjaGVjayB0aGUgcGFyYW1ldGVyIGFnYWluc3QgdGhlIHdy\nYXBwZWQgdHlwZQogICAgICAgIGlmICghRmlsdGVycy53cmFwKHR5cGUpLmlz\nSW5zdGFuY2UocGFyYW0pKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1l\nbnRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1wYXJhbS10eXBlIiwKICAgICAg\nICAgICAgICAgIHBhcmFtRGVzYywgcGFyYW0uZ2V0Q2xhc3MoKS5nZXROYW1l\nKCksIHR5cGUuZ2V0TmFtZSgpKSwKICAgICAgICAgICAgICAgIG51bGwsIG51\nbGwsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgTGlzdCBnZXRSZXN1bHRM\naXN0KCkgewogICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBPYmplY3Qgb2IgPSBleGVjdXRlKCk7CiAgICAgICAgaWYgKG9i\nIGluc3RhbmNlb2YgTGlzdCkgewogICAgICAgICAgICBMaXN0IHJldCA9IChM\naXN0KSBvYjsKICAgICAgICAgICAgaWYgKHJldCBpbnN0YW5jZW9mIFJlc3Vs\ndExpc3QpCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERlbGVnYXRpbmdS\nZXN1bHRMaXN0KChSZXN1bHRMaXN0KSByZXQsCiAgICAgICAgICAgICAgICAg\nICAgUGVyc2lzdGVuY2VFeGNlcHRpb25zLmdldFJvbGxiYWNrVHJhbnNsYXRv\ncihfZW0pKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0\ndXJuIHJldDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBDb2xsZWN0aW9u\ncy5zaW5nbGV0b25MaXN0KG9iKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4\nZWN1dGUgYSBxdWVyeSB0aGF0IHJldHVybnMgYSBzaW5nbGUgcmVzdWx0Lgog\nICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldFNpbmdsZVJlc3VsdCgpIHsK\nICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nLy8gdGVtcG9yYXJpbHkgc2V0IHF1ZXJ5IHRvIHVuaXF1ZSBzbyB0aGF0IGEg\nc2luZ2xlIHJlc3VsdCBpcyB2YWxpZGF0ZWQKICAgICAgICAvLyBhbmQgcmV0\ndXJuZWQ7IHVuc2V0IGFnYWluIGluIGNhc2UgdGhlIHVzZXIgZXhlY3V0ZXMg\ncXVlcnkgYWdhaW4KICAgICAgICAvLyB2aWEgZ2V0UmVzdWx0TGlzdAogICAg\nICAgIF9xdWVyeS5zZXRVbmlxdWUodHJ1ZSk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcmV0dXJuIGV4ZWN1dGUoKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBfcXVlcnkuc2V0VW5pcXVlKGZhbHNlKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIGludCBleGVjdXRlVXBkYXRlKCkgewog\nICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBp\nZiAoX3F1ZXJ5LmdldE9wZXJhdGlvbigpID09IFF1ZXJ5T3BlcmF0aW9ucy5P\nUF9ERUxFVEUpIHsKICAgICAgICAgICAgLy8gaGFuZGxlIHdoaWNoIHR5cGVz\nIG9mIHBhcmFtZXRlcnMgd2UgYXJlIHVzaW5nLCBpZiBhbnkKICAgICAgICAg\nICAgaWYgKF9wb3NpdGlvbmFsICE9IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gYXNJbnQoX3F1ZXJ5LmRlbGV0ZUFsbChfcG9zaXRpb25hbC50b0Fy\ncmF5KCkpKTsKICAgICAgICAgICAgaWYgKF9uYW1lZCAhPSBudWxsKQogICAg\nICAgICAgICAgICAgcmV0dXJuIGFzSW50KF9xdWVyeS5kZWxldGVBbGwoX25h\nbWVkKSk7CiAgICAgICAgICAgIHJldHVybiBhc0ludChfcXVlcnkuZGVsZXRl\nQWxsKCkpOwogICAgICAgIH0KICAgICAgICBpZiAoX3F1ZXJ5LmdldE9wZXJh\ndGlvbigpID09IFF1ZXJ5T3BlcmF0aW9ucy5PUF9VUERBVEUpIHsKICAgICAg\nICAgICAgLy8gaGFuZGxlIHdoaWNoIHR5cGVzIG9mIHBhcmFtZXRlcnMgd2Ug\nYXJlIHVzaW5nLCBpZiBhbnkKICAgICAgICAgICAgaWYgKF9wb3NpdGlvbmFs\nICE9IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gYXNJbnQoX3F1ZXJ5\nLnVwZGF0ZUFsbChfcG9zaXRpb25hbC50b0FycmF5KCkpKTsKICAgICAgICAg\nICAgaWYgKF9uYW1lZCAhPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJu\nIGFzSW50KF9xdWVyeS51cGRhdGVBbGwoX25hbWVkKSk7CiAgICAgICAgICAg\nIHJldHVybiBhc0ludChfcXVlcnkudXBkYXRlQWxsKCkpOwogICAgICAgIH0K\nICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJub3QtdXBkYXRlLWRlbGV0ZS1xdWVyeSIsCiAgICAgICAgICAgIF9x\ndWVyeS5nZXRRdWVyeVN0cmluZygpKSwgbnVsbCwgbnVsbCwgZmFsc2UpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ2FzdCB0aGUgc3BlY2lmaWVkIGxvbmcg\nZG93biB0byBhbiBpbnQsIGZpcnN0IGNoZWNraW5nIGZvciBvdmVyZmxvdy4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgaW50IGFzSW50KGxvbmcgbCkg\newogICAgICAgIGlmIChsID4gSW50ZWdlci5NQVhfVkFMVUUpCiAgICAgICAg\nICAgIHJldHVybiBJbnRlZ2VyLk1BWF9WQUxVRTsKICAgICAgICBpZiAobCA8\nIEludGVnZXIuTUlOX1ZBTFVFKSAvLyB1bmxpa2VseSwgYnV0IHdlIG1pZ2h0\nIGFzIHdlbGwgY2hlY2sKICAgICAgICAgICAgcmV0dXJuIEludGVnZXIuTUlO\nX1ZBTFVFOwogICAgICAgIHJldHVybiAoaW50KSBsOwogICAgfQoKICAgIHB1\nYmxpYyBGbHVzaE1vZGVUeXBlIGdldEZsdXNoTW9kZSgpIHsKICAgICAgICBy\nZXR1cm4gRW50aXR5TWFuYWdlckltcGwuZnJvbUZsdXNoQmVmb3JlUXVlcmll\ncyhfcXVlcnkuCiAgICAgICAgICAgIGdldEZldGNoQ29uZmlndXJhdGlvbigp\nLmdldEZsdXNoQmVmb3JlUXVlcmllcygpKTsKICAgIH0KCiAgICBwdWJsaWMg\nT3BlbkpQQVF1ZXJ5IHNldEZsdXNoTW9kZShGbHVzaE1vZGVUeXBlIGZsdXNo\nTW9kZSkgewogICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfcXVlcnkuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuc2V0Rmx1\nc2hCZWZvcmVRdWVyaWVzCiAgICAgICAgICAgIChFbnRpdHlNYW5hZ2VySW1w\nbC50b0ZsdXNoQmVmb3JlUXVlcmllcyhmbHVzaE1vZGUpKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNl\ndEhpbnQoU3RyaW5nIGtleSwgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgX2Vt\nLmFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGlmIChrZXkgPT0g\nbnVsbCB8fCAha2V5LnN0YXJ0c1dpdGgoIm9wZW5qcGEuIikpCiAgICAgICAg\nICAgIHJldHVybiB0aGlzOwogICAgICAgIFN0cmluZyBrID0ga2V5LnN1YnN0\ncmluZygib3BlbmpwYS4iLmxlbmd0aCgpKTsKCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgaWYgKCJTdWJjbGFzc2VzIi5lcXVhbHMoaykpIHsKICAgICAg\nICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZykKICAgICAg\nICAgICAgICAgICAgICB2YWx1ZSA9IEJvb2xlYW4udmFsdWVPZigoU3RyaW5n\nKSB2YWx1ZSk7CiAgICAgICAgICAgICAgICBzZXRTdWJjbGFzc2VzKCgoQm9v\nbGVhbikgdmFsdWUpLmJvb2xlYW5WYWx1ZSgpKTsKICAgICAgICAgICAgfSBl\nbHNlIGlmICgiRmlsdGVyTGlzdGVuZXIiLmVxdWFscyhrKSkKICAgICAgICAg\nICAgICAgIGFkZEZpbHRlckxpc3RlbmVyKEZpbHRlcnMuaGludFRvRmlsdGVy\nTGlzdGVuZXIodmFsdWUsCiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5Lmdl\ndEJyb2tlcigpLmdldENsYXNzTG9hZGVyKCkpKTsKICAgICAgICAgICAgZWxz\nZSBpZiAoIkZpbHRlckxpc3RlbmVycyIuZXF1YWxzKGspKSB7CiAgICAgICAg\nICAgICAgICBGaWx0ZXJMaXN0ZW5lcltdIGFyciA9IEZpbHRlcnMuaGludFRv\nRmlsdGVyTGlzdGVuZXJzKHZhbHVlLAogICAgICAgICAgICAgICAgICAgIF9x\ndWVyeS5nZXRCcm9rZXIoKS5nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICAgICAgICAgIGFkZEZpbHRlckxpc3RlbmVyKGFycltpXSk7\nCiAgICAgICAgICAgIH0gZWxzZSBpZiAoIkFnZ3JlZ2F0ZUxpc3RlbmVyIi5l\ncXVhbHMoaykpCiAgICAgICAgICAgICAgICBhZGRBZ2dyZWdhdGVMaXN0ZW5l\ncihGaWx0ZXJzLmhpbnRUb0FnZ3JlZ2F0ZUxpc3RlbmVyKHZhbHVlLAogICAg\nICAgICAgICAgICAgICAgIF9xdWVyeS5nZXRCcm9rZXIoKS5nZXRDbGFzc0xv\nYWRlcigpKSk7CiAgICAgICAgICAgIGVsc2UgaWYgKCJGaWx0ZXJMaXN0ZW5l\ncnMiLmVxdWFscyhrKSkgewogICAgICAgICAgICAgICAgQWdncmVnYXRlTGlz\ndGVuZXJbXSBhcnIgPSBGaWx0ZXJzLmhpbnRUb0FnZ3JlZ2F0ZUxpc3RlbmVy\ncwogICAgICAgICAgICAgICAgICAgICh2YWx1ZSwgX3F1ZXJ5LmdldEJyb2tl\ncigpLmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICAgICAgYWRkQWdncmVnYXRlTGlzdGVuZXIoYXJyW2ldKTsKICAgICAgICAg\nICAgfSBlbHNlIGlmIChrLnN0YXJ0c1dpdGgoIkZldGNoUGxhbi4iKSkgewog\nICAgICAgICAgICAgICAgayA9IGsuc3Vic3RyaW5nKCJGZXRjaFBsYW4uIi5s\nZW5ndGgoKSk7CiAgICAgICAgICAgICAgICBoaW50VG9TZXR0ZXIoZ2V0RmV0\nY2hQbGFuKCksIGssIHZhbHVlKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChr\nLnN0YXJ0c1dpdGgoImhpbnQuIikpIHsKICAgICAgICAgICAgICAgIGlmICgi\naGludC5PcHRpbWl6ZVJlc3VsdENvdW50Ii5lcXVhbHMoaykpIHsKICAgICAg\nICAgICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIHZhbHVlID0gbmV3IEludGVnZXIoKFN0cmluZykgdmFs\ndWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChOdW1iZXJG\nb3JtYXRFeGNlcHRpb24gbmZlKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\naWYgKCEodmFsdWUgaW5zdGFuY2VvZiBOdW1iZXIpIAogICAgICAgICAgICAg\nICAgICAgICAgICB8fCAoKE51bWJlcikgdmFsdWUpLmludFZhbHVlKCkgPCAw\nKQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRF\neGNlcHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICgiYmFkLXF1ZXJ5LWhpbnQtdmFsdWUiLCBrZXksIHZhbHVlKSwgbnVsbCwg\nbnVsbCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfcXVlcnkuZ2V0RmV0\nY2hDb25maWd1cmF0aW9uKCkuc2V0SGludChrZXksIHZhbHVlKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1xdWVyeS1o\naW50Iiwga2V5KSwKICAgICAgICAgICAgICAgICAgICBudWxsLCBudWxsLCBm\nYWxzZSk7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IFBlcnNpc3Rl\nbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9uKGUpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgaGludFRvU2V0dGVyKEZl\ndGNoUGxhbiBmZXRjaFBsYW4sIFN0cmluZyBrLCBPYmplY3QgdmFsdWUpIHsK\nICAgICAgICBpZiAoZmV0Y2hQbGFuID09IG51bGwgfHwgayA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIE1ldGhvZCBzZXR0ZXIgPSBS\nZWZsZWN0aW9uLmZpbmRTZXR0ZXIoZmV0Y2hQbGFuLmdldENsYXNzKCksIGss\nIHRydWUpOwogICAgICAgIENsYXNzIHBhcmFtVHlwZSA9IHNldHRlci5nZXRQ\nYXJhbWV0ZXJUeXBlcygpWzBdOwogICAgICAgIGlmIChFbnVtLmNsYXNzLmlz\nQXNzaWduYWJsZUZyb20ocGFyYW1UeXBlKSAmJiB2YWx1ZSBpbnN0YW5jZW9m\nIFN0cmluZykKICAgICAgICAgICAgdmFsdWUgPSBFbnVtLnZhbHVlT2YocGFy\nYW1UeXBlLCAoU3RyaW5nKSB2YWx1ZSk7CiAgICAgICAgCiAgICAgICAgRmls\ndGVycy5oaW50VG9TZXR0ZXIoZmV0Y2hQbGFuLCBrLCB2YWx1ZSk7CiAgICB9\nCgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRQYXJhbWV0ZXIoaW50IHBv\nc2l0aW9uLCBDYWxlbmRhciB2YWx1ZSwKICAgICAgICBUZW1wb3JhbFR5cGUg\ndCkgewogICAgICAgIHJldHVybiBzZXRQYXJhbWV0ZXIocG9zaXRpb24sIHZh\nbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNldFBhcmFt\nZXRlcihpbnQgcG9zaXRpb24sIERhdGUgdmFsdWUsCiAgICAgICAgVGVtcG9y\nYWxUeXBlIHR5cGUpIHsKICAgICAgICByZXR1cm4gc2V0UGFyYW1ldGVyKHBv\nc2l0aW9uLCB2YWx1ZSk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVy\neSBzZXRQYXJhbWV0ZXIoaW50IHBvc2l0aW9uLCBPYmplY3QgdmFsdWUpIHsK\nICAgICAgICBfcXVlcnkuYXNzZXJ0T3BlbigpOwogICAgICAgIF9lbS5hc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfcXVlcnkubG9jaygpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIG5vdCBhbGxvd2VkIHRvIG1p\neCBwb3NpdGlvbmFsIGFuZCBuYW1lZCBwYXJhbWV0ZXJzIChFRFIyIDMuNi40\nKQogICAgICAgICAgICBpZiAoX25hbWVkICE9IG51bGwpCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0\nCiAgICAgICAgICAgICAgICAgICAgKCJuby1wb3MtbmFtZWQtcGFyYW1zLW1p\neCIsIF9xdWVyeS5nZXRRdWVyeVN0cmluZygpKSwKICAgICAgICAgICAgICAg\nICAgICBudWxsLCBudWxsLCBmYWxzZSk7CgogICAgICAgICAgICBpZiAocG9z\naXRpb24gPCAxKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRT\ndGF0ZUV4Y2VwdGlvbihfbG9jLmdldAogICAgICAgICAgICAgICAgICAgICgi\naWxsZWdhbC1pbmRleCIsIHBvc2l0aW9uKSwgbnVsbCwgbnVsbCwgZmFsc2Up\nOwoKICAgICAgICAgICAgaWYgKF9wb3NpdGlvbmFsID09IG51bGwpCiAgICAg\nICAgICAgICAgICBfcG9zaXRpb25hbCA9IG5ldyBBcnJheUxpc3QoKTsKCiAg\nICAgICAgICAgIC8vIG1ha2Ugc3VyZSBpdCBpcyBhdCBsZWFzdCB0aGUgcmVx\ndWVzdGVkIHNpemUKICAgICAgICAgICAgd2hpbGUgKF9wb3NpdGlvbmFsLnNp\nemUoKSA8IHBvc2l0aW9uKQogICAgICAgICAgICAgICAgX3Bvc2l0aW9uYWwu\nYWRkKG51bGwpOwoKICAgICAgICAgICAgLy8gbm90ZSB0aGF0IHdlIGFkZCBp\ndCB0byBwb3NpdGlvbiAtIDEsIHNpbmNlIHNldFBvc2l0aW9uCiAgICAgICAg\nICAgIC8vIHN0YXJ0cyBhdCAxLCB3aGlsZSBMaXN0IHN0YXJ0cyBhdCAwCiAg\nICAgICAgICAgIF9wb3NpdGlvbmFsLnNldChwb3NpdGlvbiAtIDEsIHZhbHVl\nKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgX3F1ZXJ5LnVubG9jaygpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNldFBhcmFtZXRlcihTdHJp\nbmcgbmFtZSwgQ2FsZW5kYXIgdmFsdWUsCiAgICAgICAgVGVtcG9yYWxUeXBl\nIHQpIHsKICAgICAgICByZXR1cm4gc2V0UGFyYW1ldGVyKG5hbWUsIHZhbHVl\nKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNldFBhcmFtZXRl\ncihTdHJpbmcgbmFtZSwgRGF0ZSB2YWx1ZSwKICAgICAgICBUZW1wb3JhbFR5\ncGUgdHlwZSkgewogICAgICAgIHJldHVybiBzZXRQYXJhbWV0ZXIobmFtZSwg\ndmFsdWUpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0UGFy\nYW1ldGVyKFN0cmluZyBuYW1lLCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBf\ncXVlcnkuYXNzZXJ0T3BlbigpOwogICAgICAgIF9lbS5hc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICBfcXVlcnkubG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIC8vIG5vdCBhbGxvd2VkIHRvIG1peCBwb3NpdGlv\nbmFsIGFuZCBuYW1lZCBwYXJhbWV0ZXJzIChFRFIyIDMuNi40KQogICAgICAg\nICAgICBpZiAoX3Bvc2l0aW9uYWwgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQKICAg\nICAgICAgICAgICAgICAgICAoIm5vLXBvcy1uYW1lZC1wYXJhbXMtbWl4Iiwg\nX3F1ZXJ5LmdldFF1ZXJ5U3RyaW5nKCkpLAogICAgICAgICAgICAgICAgICAg\nIG51bGwsIG51bGwsIGZhbHNlKTsKCiAgICAgICAgICAgIGlmIChfbmFtZWQg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9uYW1lZCA9IG5ldyBIYXNoTWFw\nKCk7CiAgICAgICAgICAgIF9uYW1lZC5wdXQobmFtZSwgdmFsdWUpOwogICAg\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICBfcXVlcnkudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQogICAg\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc05hdGl2ZSgpIHsKICAgICAgICByZXR1\ncm4gUXVlcnlMYW5ndWFnZXMuTEFOR19TUUwuZXF1YWxzKGdldExhbmd1YWdl\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc1Bvc2l0aW9uYWxQ\nYXJhbWV0ZXJzKCkgewogICAgICAgIHJldHVybiBfcG9zaXRpb25hbCAhPSBu\ndWxsOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3RbXSBnZXRQb3NpdGlvbmFs\nUGFyYW1ldGVycygpIHsKICAgICAgICBfcXVlcnkubG9jaygpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHJldHVybiAoX3Bvc2l0aW9uYWwgPT0gbnVs\nbCkgPyBFTVBUWV9BUlJBWSA6IF9wb3NpdGlvbmFsLnRvQXJyYXkoKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfcXVlcnkudW5sb2NrKCk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0\nUGFyYW1ldGVycyhPYmplY3QuLi4gcGFyYW1zKSB7CiAgICAgICAgX3F1ZXJ5\nLmFzc2VydE9wZW4oKTsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX3F1ZXJ5LmxvY2soKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBfcG9zaXRpb25hbCA9IG51bGw7CiAgICAgICAgICAgIF9u\nYW1lZCA9IG51bGw7CiAgICAgICAgICAgIGlmIChwYXJhbXMgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGFyYW1zLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIHNldFBhcmFtZXRlcihp\nICsgMSwgcGFyYW1zW2ldKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX3F1ZXJ5LnVubG9jaygp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgTWFwIGdldE5hbWVkUGFy\nYW1ldGVycygpIHsKICAgICAgICBfcXVlcnkubG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHJldHVybiAoX25hbWVkID09IG51bGwpID8gQ29s\nbGVjdGlvbnMuRU1QVFlfTUFQCiAgICAgICAgICAgICAgICA6IENvbGxlY3Rp\nb25zLnVubW9kaWZpYWJsZU1hcChfbmFtZWQpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIF9xdWVyeS51bmxvY2soKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRQYXJhbWV0ZXJzKE1h\ncCBwYXJhbXMpIHsKICAgICAgICBfcXVlcnkuYXNzZXJ0T3BlbigpOwogICAg\nICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfcXVl\ncnkubG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9wb3NpdGlv\nbmFsID0gbnVsbDsKICAgICAgICAgICAgX25hbWVkID0gbnVsbDsKICAgICAg\nICAgICAgaWYgKHBhcmFtcyAhPSBudWxsKQogICAgICAgICAgICAgICAgZm9y\nIChNYXAuRW50cnkgZSA6IChTZXQ8TWFwLkVudHJ5PikgcGFyYW1zLmVudHJ5\nU2V0KCkpCiAgICAgICAgICAgICAgICAgICAgc2V0UGFyYW1ldGVyKChTdHJp\nbmcpIGUuZ2V0S2V5KCksIGUuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgIHJl\ndHVybiB0aGlzOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9x\ndWVyeS51bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIE9w\nZW5KUEFRdWVyeSBjbG9zZUFsbCgpIHsKICAgICAgICBfcXVlcnkuY2xvc2VB\nbGwoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nW10gZ2V0RGF0YVN0b3JlQWN0aW9ucyhNYXAgcGFyYW1zKSB7CiAg\nICAgICAgcmV0dXJuIF9xdWVyeS5nZXREYXRhU3RvcmVBY3Rpb25zKHBhcmFt\ncyk7CiAgICB9CgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAg\nICByZXR1cm4gX3F1ZXJ5Lmhhc2hDb2RlKCk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlmIChv\ndGhlciA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIFF1ZXJ5SW1wbCkpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gX3F1ZXJ5LmVxdWFs\ncygoKFF1ZXJ5SW1wbCkgb3RoZXIpLl9xdWVyeSk7Cgl9Cn0K\n","encoding":"base64"}

