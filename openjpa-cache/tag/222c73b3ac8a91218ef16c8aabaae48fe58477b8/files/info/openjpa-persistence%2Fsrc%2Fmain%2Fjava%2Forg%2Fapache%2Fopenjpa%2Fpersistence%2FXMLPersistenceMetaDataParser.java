{"sha":"c8c789d56557d85867667ca666b94e43e647ca76","node_id":"MDQ6QmxvYjIwNjM2NDpjOGM3ODlkNTY1NTdkODU4Njc2NjdjYTY2NmI5NGU0M2U2NDdjYTc2","size":55548,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c8c789d56557d85867667ca666b94e43e647ca76","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7Cmlt\ncG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuU3RhY2s7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5DYXNjYWRlVHlwZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkdlbmVyYXRpb25UeXBlOwppbXBvcnQgc3RhdGlj\nIGphdmF4LnBlcnNpc3RlbmNlLkNhc2NhZGVUeXBlLio7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\neG1sLnNheC5BdHRyaWJ1dGVzOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQ\nQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5o\nYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuZXZlbnQuQmVhbkxpZmVjeWNsZUNhbGxiYWNrczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5ldmVudC5MaWZlY3ljbGVDYWxsYmFja3M7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnQ7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTWV0aG9kTGlmZWN5\nY2xlQ2FsbGJhY2tzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5RdWVyeUxhbmd1YWdlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuanBxbC5KUFFMUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5tZXRhLkNGTWV0YURhdGFQYXJzZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkRlbGVnYXRpbmdNZXRhRGF0YUZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1l\ndGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5\ncGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTGlmZWN5Y2xl\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRh\nRGF0YURlZmF1bHRzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nTWV0YURhdGFGYWN0b3J5OwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLk1ldGFEYXRhTW9kZXMuKjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLk9yZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5WYWx1ZU1ldGFEYXRhOwppbXBvcnQgc3RhdGlj\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5NZXRhRGF0YVRhZy4q\nOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5QZXJzaXN0ZW5jZVN0cmF0ZWd5Lio7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5JbXBsSGVscGVyOwoKLyoqCiAqIEN1c3RvbSBTQVggcGFy\nc2VyIHVzZWQgYnkgdGhlIHN5c3RlbSB0byBxdWlja2x5IHBhcnNlIHBlcnNp\nc3RlbmNlIGkKICogbWV0YWRhdGEgZmlsZXMuCiAqCiAqIEBhdXRob3IgU3Rl\ndmUgS2ltCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBYTUxQZXJz\naXN0ZW5jZU1ldGFEYXRhUGFyc2VyCiAgICBleHRlbmRzIENGTWV0YURhdGFQ\nYXJzZXIKICAgIGltcGxlbWVudHMgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3Rv\ncnkuUGFyc2VyIHsKCiAgICAvLyBwYXJzZSBjb25zdGFudHMKICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fUEtHID0gInBhY2thZ2Ui\nOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9BQ0NF\nU1MgPSAiYWNjZXNzIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3Ry\naW5nIEVMRU1fQVRUUlMgPSAiYXR0cmlidXRlcyI7CiAgICBwcm90ZWN0ZWQg\nc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0xJU1RFTkVSID0gImVudGl0eS1s\naXN0ZW5lciI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTEVNX0NBU0NBREUgPSAiY2FzY2FkZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGlj\nIGZpbmFsIFN0cmluZyBFTEVNX0NBU0NBREVfQUxMID0gImNhc2NhZGUtYWxs\nIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FT\nQ0FERV9QRVIgPSAiY2FzY2FkZS1wZXJzaXN0IjsKICAgIHByb3RlY3RlZCBz\ndGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9NRVIgPSAiY2FzY2Fk\nZS1tZXJnZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTEVNX0NBU0NBREVfUkVNID0gImNhc2NhZGUtcmVtb3ZlIjsKICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9SRUYgPSAi\nY2FzY2FkZS1yZWZyZXNoIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fUFVfTUVUQSA9ICJwZXJzaXN0ZW5jZS11bml0LW1ldGFk\nYXRhIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1f\nUFVfREVGID0gInBlcnNpc3RlbmNlLXVuaXQtZGVmYXVsdHMiOwogICAgcHJv\ndGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9YTUxfTUFQX01FVEFf\nQ09NUExFVEUgPQogICAgICAgICJ4bWwtbWFwcGluZy1tZXRhZGF0YS1jb21w\nbGV0ZSI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPFN0cmluZywg\nT2JqZWN0PiBfZWxlbXMgPQogICAgICAgIG5ldyBIYXNoTWFwPFN0cmluZywg\nT2JqZWN0PigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgX2VsZW1zLnB1dChF\nTEVNX1BLRywgRUxFTV9QS0cpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9B\nQ0NFU1MsIEVMRU1fQUNDRVNTKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1f\nQVRUUlMsIEVMRU1fQVRUUlMpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9M\nSVNURU5FUiwgRUxFTV9MSVNURU5FUik7CiAgICAgICAgX2VsZW1zLnB1dChF\nTEVNX0NBU0NBREUsIEVMRU1fQ0FTQ0FERSk7CiAgICAgICAgX2VsZW1zLnB1\ndChFTEVNX0NBU0NBREVfQUxMLCBFTEVNX0NBU0NBREVfQUxMKTsKICAgICAg\nICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9QRVIsIEVMRU1fQ0FTQ0FERV9Q\nRVIpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX1JFTSwgRUxF\nTV9DQVNDQURFX1JFTSk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0NBU0NB\nREVfTUVSLCBFTEVNX0NBU0NBREVfTUVSKTsKICAgICAgICBfZWxlbXMucHV0\nKEVMRU1fQ0FTQ0FERV9SRUYsIEVMRU1fQ0FTQ0FERV9SRUYpOwogICAgICAg\nIF9lbGVtcy5wdXQoRUxFTV9QVV9NRVRBLCBFTEVNX1BVX01FVEEpOwogICAg\nICAgIF9lbGVtcy5wdXQoRUxFTV9QVV9ERUYsIEVMRU1fUFVfREVGKTsKICAg\nICAgICBfZWxlbXMucHV0KEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFLCBF\nTEVNX1hNTF9NQVBfTUVUQV9DT01QTEVURSk7CgogICAgICAgIF9lbGVtcy5w\ndXQoImVudGl0eS1saXN0ZW5lcnMiLCBFTlRJVFlfTElTVEVORVJTKTsKICAg\nICAgICBfZWxlbXMucHV0KCJwcmUtcGVyc2lzdCIsIFBSRV9QRVJTSVNUKTsK\nICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXBlcnNpc3QiLCBQT1NUX1BFUlNJ\nU1QpOwogICAgICAgIF9lbGVtcy5wdXQoInByZS1yZW1vdmUiLCBQUkVfUkVN\nT1ZFKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXJlbW92ZSIsIFBPU1Rf\nUkVNT1ZFKTsKICAgICAgICBfZWxlbXMucHV0KCJwcmUtdXBkYXRlIiwgUFJF\nX1VQREFURSk7CiAgICAgICAgX2VsZW1zLnB1dCgicG9zdC11cGRhdGUiLCBQ\nT1NUX1VQREFURSk7CiAgICAgICAgX2VsZW1zLnB1dCgicG9zdC1sb2FkIiwg\nUE9TVF9MT0FEKTsKICAgICAgICBfZWxlbXMucHV0KCJleGNsdWRlLWRlZmF1\nbHQtbGlzdGVuZXJzIiwgRVhDTFVERV9ERUZBVUxUX0xJU1RFTkVSUyk7CiAg\nICAgICAgX2VsZW1zLnB1dCgiZXhjbHVkZS1zdXBlcmNsYXNzLWxpc3RlbmVy\ncyIsCiAgICAgICAgICAgIEVYQ0xVREVfU1VQRVJDTEFTU19MSVNURU5FUlMp\nOwoKICAgICAgICBfZWxlbXMucHV0KCJuYW1lZC1xdWVyeSIsIFFVRVJZKTsK\nICAgICAgICBfZWxlbXMucHV0KCJuYW1lZC1uYXRpdmUtcXVlcnkiLCBOQVRJ\nVkVfUVVFUlkpOwogICAgICAgIF9lbGVtcy5wdXQoInF1ZXJ5LWhpbnQiLCBR\nVUVSWV9ISU5UKTsKICAgICAgICBfZWxlbXMucHV0KCJxdWVyeSIsIFFVRVJZ\nX1NUUklORyk7CgogICAgICAgIF9lbGVtcy5wdXQoImZsdXNoLW1vZGUiLCBG\nTFVTSF9NT0RFKTsKICAgICAgICBfZWxlbXMucHV0KCJzZXF1ZW5jZS1nZW5l\ncmF0b3IiLCBTRVFfR0VORVJBVE9SKTsKCiAgICAgICAgX2VsZW1zLnB1dCgi\naWQiLCBJRCk7CiAgICAgICAgX2VsZW1zLnB1dCgiaWQtY2xhc3MiLCBJRF9D\nTEFTUyk7CiAgICAgICAgX2VsZW1zLnB1dCgiZW1iZWRkZWQtaWQiLCBFTUJF\nRERFRF9JRCk7CiAgICAgICAgX2VsZW1zLnB1dCgidmVyc2lvbiIsIFZFUlNJ\nT04pOwogICAgICAgIF9lbGVtcy5wdXQoImdlbmVyYXRlZC12YWx1ZSIsIEdF\nTkVSQVRFRF9WQUxVRSk7CiAgICAgICAgX2VsZW1zLnB1dCgibWFwLWtleSIs\nIE1BUF9LRVkpOwogICAgICAgIF9lbGVtcy5wdXQoIm9yZGVyLWJ5IiwgT1JE\nRVJfQlkpOwogICAgICAgIF9lbGVtcy5wdXQoImxvYiIsIExPQik7CgogICAg\nICAgIF9lbGVtcy5wdXQoImJhc2ljIiwgQkFTSUMpOwogICAgICAgIF9lbGVt\ncy5wdXQoIm1hbnktdG8tb25lIiwgTUFOWV9PTkUpOwogICAgICAgIF9lbGVt\ncy5wdXQoIm9uZS10by1vbmUiLCBPTkVfT05FKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJlbWJlZGRlZCIsIEVNQkVEREVEKTsKICAgICAgICBfZWxlbXMucHV0\nKCJvbmUtdG8tbWFueSIsIE9ORV9NQU5ZKTsKICAgICAgICBfZWxlbXMucHV0\nKCJtYW55LXRvLW1hbnkiLCBNQU5ZX01BTlkpOwogICAgICAgIF9lbGVtcy5w\ndXQoInRyYW5zaWVudCIsIFRSQU5TSUVOVCk7CiAgICB9CgogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZQogICAgICAgIChYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2Vy\nLmNsYXNzKTsKCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0\naW9uIF9jb25mOwogICAgcHJpdmF0ZSBNZXRhRGF0YVJlcG9zaXRvcnkgX3Jl\ncG9zID0gbnVsbDsKICAgIHByaXZhdGUgQW5ub3RhdGlvblBlcnNpc3RlbmNl\nTWV0YURhdGFQYXJzZXIgX3BhcnNlciA9IG51bGw7CiAgICBwcml2YXRlIENs\nYXNzTG9hZGVyIF9lbnZMb2FkZXIgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQg\nX21vZGUgPSBNT0RFX05PTkU7CiAgICBwcml2YXRlIGJvb2xlYW4gX292ZXJy\naWRlID0gZmFsc2U7CgogICAgcHJpdmF0ZSBmaW5hbCBTdGFjayBfZWxlbWVu\ndHMgPSBuZXcgU3RhY2soKTsKICAgIHByaXZhdGUgZmluYWwgU3RhY2sgX3Bh\ncmVudHMgPSBuZXcgU3RhY2soKTsKCiAgICBwcml2YXRlIENsYXNzIF9jbHMg\nPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX2ZpZWxkUG9zID0gMDsKICAgIHBy\naXZhdGUgaW50IF9jbHNQb3MgPSAwOwogICAgcHJpdmF0ZSBpbnQgX2FjY2Vz\ncyA9IENsYXNzTWV0YURhdGEuQUNDRVNTX1VOS05PV047CiAgICBwcml2YXRl\nIFBlcnNpc3RlbmNlU3RyYXRlZ3kgX3N0cmF0ZWd5ID0gbnVsbDsKICAgIHBy\naXZhdGUgU2V0PENhc2NhZGVUeXBlPiBfY2FzY2FkZXMgPSBudWxsOwogICAg\ncHJpdmF0ZSBTZXQ8Q2FzY2FkZVR5cGU+IF9wa2dDYXNjYWRlcyA9IG51bGw7\nCgogICAgcHJpdmF0ZSBDbGFzcyBfbGlzdGVuZXIgPSBudWxsOwogICAgcHJp\ndmF0ZSBDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBfY2FsbGJh\nY2tzID0gbnVsbDsKICAgIHByaXZhdGUgaW50W10gX2hpZ2hzID0gbnVsbDsK\nCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIFhNTFBlcnNpc3RlbmNlTWV0YURh\ndGFQYXJzZXIoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAg\nIF9jb25mID0gY29uZjsKICAgICAgICBzZXRWYWxpZGF0aW5nKHRydWUpOwog\nICAgICAgIHNldExvZyhjb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlv\nbi5MT0dfTUVUQURBVEEpKTsKICAgICAgICBzZXRQYXJzZUNvbW1lbnRzKHRy\ndWUpOwogICAgICAgIHNldE1vZGUoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5H\nIHwgTU9ERV9RVUVSWSk7CiAgICAgICAgc2V0UGFyc2VUZXh0KHRydWUpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29uZmlndXJhdGlvbiBzdXBwbGllZCBv\nbiBjb25zdHJ1Y3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVy\nbiBfY29uZjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhbm5vdGF0aW9u\nIHBhcnNlci4gV2hlbiBjbGFzcyBpcyBkaXNjb3ZlcmVkIGluIGFuIFhNTCBm\naWxlLAogICAgICogd2UgZmlyc3QgcGFyc2UgYW55IGFubm90YXRpb25zIHBy\nZXNlbnQsIHRoZW4gb3ZlcnJpZGUgd2l0aCB0aGUgWE1MLgogICAgICovCiAg\nICBwdWJsaWMgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIg\nZ2V0QW5ub3RhdGlvblBhcnNlcigpIHsKICAgICAgICByZXR1cm4gX3BhcnNl\ncjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhbm5vdGF0aW9uIHBhcnNl\nci4gV2hlbiBjbGFzcyBpcyBkaXNjb3ZlcmVkIGluIGFuIFhNTCBmaWxlLAog\nICAgICogd2UgZmlyc3QgcGFyc2UgYW55IGFubm90YXRpb25zIHByZXNlbnQs\nIHRoZW4gb3ZlcnJpZGUgd2l0aCB0aGUgWE1MLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRBbm5vdGF0aW9uUGFyc2VyKEFubm90YXRpb25QZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyIHBhcnNlcil7CiAgICAgICAgX3BhcnNlciA9\nIHBhcnNlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHJl\ncG9zaXRvcnkgZm9yIHRoaXMgcGFyc2VyLiBJZiBub25lIGhhcyBiZWVuIHNl\ndCwgY3JlYXRlcwogICAgICogYSBuZXcgcmVwb3NpdG9yeSBhbmQgc2V0cyBp\ndC4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRhUmVwb3NpdG9yeSBnZXRS\nZXBvc2l0b3J5KCkgewogICAgICAgIGlmIChfcmVwb3MgPT0gbnVsbCkgewog\nICAgICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBfY29uZi5u\nZXdNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpOwogICAgICAgICAgICBN\nZXRhRGF0YUZhY3RvcnkgbWRmID0gcmVwb3MuZ2V0TWV0YURhdGFGYWN0b3J5\nKCk7CiAgICAgICAgICAgIGlmIChtZGYgaW5zdGFuY2VvZiBEZWxlZ2F0aW5n\nTWV0YURhdGFGYWN0b3J5KQogICAgICAgICAgICAgICAgbWRmID0gKChEZWxl\nZ2F0aW5nTWV0YURhdGFGYWN0b3J5KSBtZGYpLmdldElubmVybW9zdERlbGVn\nYXRlKCk7CiAgICAgICAgICAgIGlmIChtZGYgaW5zdGFuY2VvZiBQZXJzaXN0\nZW5jZU1ldGFEYXRhRmFjdG9yeSkKICAgICAgICAgICAgICAgICgoUGVyc2lz\ndGVuY2VNZXRhRGF0YUZhY3RvcnkpIG1kZikuc2V0WE1MUGFyc2VyKHRoaXMp\nOwogICAgICAgICAgICBfcmVwb3MgPSByZXBvczsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIF9yZXBvczsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgbWV0YWRhdGEgcmVwb3NpdG9yeSBmb3IgdGhpcyBwYXJzZXIuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldFJlcG9zaXRvcnkoTWV0YURhdGFSZXBv\nc2l0b3J5IHJlcG9zKSB7CiAgICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICAg\nICAgaWYgKHJlcG9zICE9IG51bGwKICAgICAgICAgICAgJiYgKHJlcG9zLmdl\ndFZhbGlkYXRlKCkgJiByZXBvcy5WQUxJREFURV9SVU5USU1FKSAhPSAwKQog\nICAgICAgICAgICBzZXRQYXJzZUNvbW1lbnRzKGZhbHNlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgZW52aXJvbm1lbnRhbCBjbGFzcyBs\nb2FkZXIgdG8gcGFzcyBvbiB0byBwYXJzZWQKICAgICAqIG1ldGFkYXRhIGlu\nc3RhbmNlcy4KICAgICAqLwogICAgcHVibGljIENsYXNzTG9hZGVyIGdldEVu\ndkNsYXNzTG9hZGVyKCkgewogICAgICAgIHJldHVybiBfZW52TG9hZGVyOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBlbnZpcm9ubWVudGFsIGNs\nYXNzIGxvYWRlciB0byBwYXNzIG9uIHRvIHBhcnNlZAogICAgICogbWV0YWRh\ndGEgaW5zdGFuY2VzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRFbnZD\nbGFzc0xvYWRlcihDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBfZW52\nTG9hZGVyID0gbG9hZGVyOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0byBhbGxvdyBsYXRlciBwYXJzZXMgb2YgbWFwcGluZyBpbmZvcm1hdGlv\nbiB0byBvdmVycmlkZQogICAgICogZWFybGllciBpbmZvcm1hdGlvbiBmb3Ig\ndGhlIHNhbWUgY2xhc3MuIERlZmF1bHRzIHRvIGZhbHNlLiBVc2VmdWwKICAg\nICAqIHdoZW4gYSB0b29sIGlzIG1hcHBpbmcgYSBjbGFzcywgc28gdGhhdCAu\namRvIGZpbGUgcGFydGlhbCBtYXBwaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBj\nYW4gYmUgdXNlZCBldmVuIHdoZW4gbWFwcGluZ3MgYXJlIHN0b3JlZCBpbiAu\nb3JtIGZpbGVzCiAgICAgKiBvciBvdGhlciBsb2NhdGlvbnMuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGdldE1hcHBpbmdPdmVycmlkZSgpIHsKICAg\nICAgICByZXR1cm4gX292ZXJyaWRlOwogICAgfQoKICAgIC8qKgogICAgICog\nV2hldGhlciB0byBhbGxvdyBsYXRlciBwYXJzZXMgb2YgbWFwcGluZyBpbmZv\ncm1hdGlvbiB0byBvdmVycmlkZQogICAgICogZWFybGllciBpbmZvcm1hdGlv\nbiBmb3IgdGhlIHNhbWUgY2xhc3MuIERlZmF1bHRzIHRvIGZhbHNlLiBVc2Vm\ndWwKICAgICAqIHdoZW4gYSB0b29sIGlzIG1hcHBpbmcgYSBjbGFzcywgc28g\ndGhhdCAuamRvIGZpbGUgcGFydGlhbCBtYXBwaW5nCiAgICAgKiBpbmZvcm1h\ndGlvbiBjYW4gYmUgdXNlZCBldmVuIHdoZW4gbWFwcGluZ3MgYXJlIHN0b3Jl\nZCBpbiAub3JtIGZpbGVzCiAgICAgKiBvciBvdGhlciBsb2NhdGlvbnMuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1hcHBpbmdPdmVycmlkZShib29s\nZWFuIG92ZXJyaWRlKSB7CiAgICAgICAgX292ZXJyaWRlID0gb3ZlcnJpZGU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgcGFyc2UgbW9kZSBhY2NvcmRp\nbmcgdG8gdGhlIGV4cGVjdGVkIGRvY3VtZW50IHR5cGUuIFRoZQogICAgICog\nbW9kZSBjb25zdGFudHMgYWN0IGFzIGJpdCBmbGFncywgYW5kIHRoZXJlZm9y\nZSBjYW4gYmUgY29tYmluZWQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0\nTW9kZSgpIHsKICAgICAgICByZXR1cm4gX21vZGU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgcGFyc2UgbW9kZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVj\ndGVkIGRvY3VtZW50IHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndE1vZGUoaW50IG1vZGUsIGJvb2xlYW4gb24pIHsKICAgICAgICBpZiAobW9k\nZSA9PSBNT0RFX05PTkUpCiAgICAgICAgICAgIHNldE1vZGUoTU9ERV9OT05F\nKTsKICAgICAgICBlbHNlIGlmIChvbikKICAgICAgICAgICAgc2V0TW9kZShf\nbW9kZSB8IG1vZGUpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc2V0TW9k\nZShfbW9kZSAmIH5tb2RlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBw\nYXJzZSBtb2RlIGFjY29yZGluZyB0byB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQg\ndHlwZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TW9kZShpbnQgbW9k\nZSkgewogICAgICAgIF9tb2RlID0gbW9kZTsKICAgICAgICBpZiAoX3BhcnNl\nciAhPSBudWxsKQogICAgICAgICAgICBfcGFyc2VyLnNldE1vZGUobW9kZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgZm9y\nIGludGVycHJldGluZyB7QGxpbmsgI2dldE1vZGV9LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBpc01ldGFEYXRhTW9kZSgpIHsKICAgICAgICBy\nZXR1cm4gKF9tb2RlICYgTU9ERV9NRVRBKSAhPSAwOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIGZvciBpbnRlcnByZXRpbmcg\ne0BsaW5rICNnZXRNb2RlfS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gaXNRdWVyeU1vZGUoKSB7CiAgICAgICAgcmV0dXJuIChfbW9kZSAmIE1P\nREVfUVVFUlkpICE9IDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5p\nZW5jZSBtZXRob2QgZm9yIGludGVycHJldGluZyB7QGxpbmsgI2dldE1vZGV9\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc01hcHBpbmdNb2Rl\nKCkgewogICAgICAgIHJldHVybiAoX21vZGUgJiBNT0RFX01BUFBJTkcpICE9\nIDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgd2Un\ncmUgaW4gbWFwcGluZyBtb2RlIG9yIGluIG1ldGFkYXRhIG1vZGUgd2l0aAog\nICAgICogbWFwcGluZyBvdmVycmlkZSBlbmFibGVkLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBpc01hcHBpbmdPdmVycmlkZU1vZGUoKSB7CiAg\nICAgICAgcmV0dXJuIGlzTWFwcGluZ01vZGUoKSB8fCAoX292ZXJyaWRlICYm\nIGlzTWV0YURhdGFNb2RlKCkpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gWE1MIHBhcnNpbmcKICAgIC8vLy8vLy8vLy8vLy8vLwoKICAg\nIC8qKgogICAgICogUHVzaCBhIHBhcnNlIGVsZW1lbnQgb250byB0aGUgc3Rh\nY2suCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHB1c2hFbGVtZW50KE9i\namVjdCBlbGVtKSB7CiAgICAgICAgX2VsZW1lbnRzLnB1c2goZWxlbSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQb3AgYSBwYXJzZSBlbGVtZW50IGZyb20g\ndGhlIHN0YWNrLgogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHBvcEVs\nZW1lbnQoKSB7CiAgICAgICAgcmV0dXJuIF9lbGVtZW50cy5wb3AoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCBlbGVtZW50\nIGJlaW5nIHBhcnNlZC4gTWF5IGJlIGEgY2xhc3MgbWV0YWRhdGEsCiAgICAg\nKiBmaWVsZCBtZXRhZGF0YSwgcXVlcnkgbWV0YWRhdGEsIGV0Yy4KICAgICAq\nLwogICAgcHJvdGVjdGVkIE9iamVjdCBjdXJyZW50RWxlbWVudCgpIHsKICAg\nICAgICBpZiAoX2VsZW1lbnRzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgcmV0dXJuIF9lbGVtZW50cy5wZWVrKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQge0BsaW5r\nIFBlcnNpc3RlbmNlU3RyYXRlZ3l9IGlmIGFueS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIFBlcnNpc3RlbmNlU3RyYXRlZ3kgY3VycmVudFN0cmF0ZWd5KCkg\newogICAgICAgIHJldHVybiBfc3RyYXRlZ3k7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIHRhZyBvZiB0aGUgY3VycmVudCBwYXJlbnQgZWxl\nbWVudC4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBjdXJyZW50UGFy\nZW50KCkgewogICAgICAgIGlmIChfcGFyZW50cy5pc0VtcHR5KCkpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBfcGFyZW50cy5w\nZWVrKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB3\nZSdyZSBydW5uaW5nIHRoZSBwYXJzZXIgYXQgcnVudGltZS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNSdW50aW1lKCkgewogICAgICAgIHJl\ndHVybiAoZ2V0UmVwb3NpdG9yeSgpLmdldFZhbGlkYXRlKCkKICAgICAgICAg\nICAgJiBNZXRhRGF0YVJlcG9zaXRvcnkuVkFMSURBVEVfUlVOVElNRSkgIT0g\nMDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBPYmplY3Qg\nZ2V0U2NoZW1hU291cmNlKCkgewogICAgICAgIHJldHVybiBYTUxQZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyLmNsYXNzLmdldFJlc291cmNlQXNTdHJlYW0K\nICAgICAgICAgICAgKCJvcm0teHNkLnJzcmMiKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0UGFja2FnZUF0dHJpYnV0\nZU5hbWUoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldENsYXNzQXR0cmlidXRl\nTmFtZSgpIHsKICAgICAgICByZXR1cm4gImNsYXNzIjsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBpbnQgZ2V0Q2xhc3NFbGVtZW50RGVw\ndGgoKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0NsYXNzRWxlbWVudE5hbWUoU3Ry\naW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gImVudGl0eSIuZXF1YWxzKG5h\nbWUpCiAgICAgICAgICAgIHx8ICJlbWJlZGRhYmxlIi5lcXVhbHMobmFtZSkK\nICAgICAgICAgICAgfHwgIm1hcHBlZC1zdXBlcmNsYXNzIi5lcXVhbHMobmFt\nZSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBy\nZXNldCgpIHsKICAgICAgICBzdXBlci5yZXNldCgpOwogICAgICAgIF9lbGVt\nZW50cy5jbGVhcigpOwogICAgICAgIF9wYXJlbnRzLmNsZWFyKCk7CiAgICAg\nICAgX2NscyA9IG51bGw7CiAgICAgICAgX2ZpZWxkUG9zID0gMDsKICAgICAg\nICBfY2xzUG9zID0gMDsKCiAgICAgICAgX2FjY2VzcyA9IENsYXNzTWV0YURh\ndGEuQUNDRVNTX1VOS05PV047CiAgICAgICAgX3N0cmF0ZWd5ID0gbnVsbDsK\nICAgICAgICBfbGlzdGVuZXIgPSBudWxsOwogICAgICAgIF9jYWxsYmFja3Mg\nPSBudWxsOwogICAgICAgIF9oaWdocyA9IG51bGw7CiAgICAgICAgX2Nhc2Nh\nZGVzID0gbnVsbDsKICAgICAgICBfcGtnQ2FzY2FkZXMgPSBudWxsOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRT\neXN0ZW1FbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIE9iamVjdCB0\nYWcgPSAoT2JqZWN0KSBfZWxlbXMuZ2V0KG5hbWUpOwogICAgICAgIGJvb2xl\nYW4gcmV0ID0gZmFsc2U7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAg\nICAgICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAg\nICAgICAgICAgIHRhZyA9IHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQobmFt\nZSwgYXR0cnMpOwogICAgICAgICAgICByZXQgPSB0YWcgIT0gbnVsbDsKICAg\nICAgICB9IGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFnKSB7\nCiAgICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsKICAg\nICAgICAgICAgICAgIGNhc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAgICAg\ncmV0ID0gc3RhcnROYW1lZFF1ZXJ5KGF0dHJzKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfSElOVDoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFF1ZXJ5SGludChhdHRy\ncyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIE5BVElWRV9RVUVSWToKICAgICAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydE5hbWVkTmF0aXZlUXVlcnkoYXR0cnMpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9TVFJJ\nTkc6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRRdWVyeVN0cmlu\nZyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihhdHRycyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZM\nVVNIX01PREU6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRGbHVz\naE1vZGUoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBFTlRJVFlfTElTVEVORVJTOgogICAgICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0RW50aXR5TGlzdGVuZXJzKGF0dHJzKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgUFJFX1BFUlNJU1Q6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfUEVS\nU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUFJFX1JFTU9WRToKICAgICAg\nICAgICAgICAgIGNhc2UgUE9TVF9SRU1PVkU6CiAgICAgICAgICAgICAgICBj\nYXNlIFBSRV9VUERBVEU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfVVBE\nQVRFOgogICAgICAgICAgICAgICAgY2FzZSBQT1NUX0xPQUQ6CiAgICAgICAg\nICAgICAgICAgICAgcmV0ID0gc3RhcnRDYWxsYmFjaygoTWV0YURhdGFUYWcp\nIHRhZywgYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICB3YXJu\nVW5zdXBwb3J0ZWRUYWcobmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nIGVsc2UgaWYgKHRhZyA9PSBFTEVNX1BVX01FVEEgfHwgdGFnID09IEVMRU1f\nUFVfREVGKQogICAgICAgICAgICByZXQgPSBpc01ldGFEYXRhTW9kZSgpOwog\nICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX1hNTF9NQVBfTUVUQV9DT01Q\nTEVURSkKICAgICAgICAgICAgc2V0QW5ub3RhdGlvblBhcnNlcihudWxsKTsK\nICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAgICAg\nICAgIHJldCA9IF9tb2RlICE9IE1PREVfUVVFUlk7CiAgICAgICAgZWxzZSBp\nZiAodGFnID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAgIHJldCA9IHN0\nYXJ0RW50aXR5TGlzdGVuZXIoYXR0cnMpOwogICAgICAgIGVsc2UgaWYgKHRh\nZyA9PSBFTEVNX0NBU0NBREUpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURh\ndGFNb2RlKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FE\nRV9BTEwgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9QRVIKICAgICAgICAgICAg\nfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9NRVIgfHwgdGFnID09IEVMRU1fQ0FT\nQ0FERV9SRU0KICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9S\nRUYpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0Q2FzY2FkZSh0YWcsIGF0dHJz\nKTsKCiAgICAgICAgaWYgKHJldCkKICAgICAgICAgICAgX3BhcmVudHMucHVz\naCh0YWcpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTeXN0ZW1FbGVtZW50KFN0cmlu\nZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCB0YWcgPSBfZWxlbXMuZ2V0KG5hbWUpOwogICAgICAgIGlmICh0\nYWcgPT0gbnVsbCAmJiBpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAg\nICAgICAgZW5kU3lzdGVtTWFwcGluZ0VsZW1lbnQobmFtZSk7CiAgICAgICAg\nZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAg\nICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWToKICAgICAgICAgICAgICAgICAgICBlbmROYW1l\nZFF1ZXJ5KCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFFVRVJZX0hJTlQ6CiAgICAgICAgICAgICAgICAgICAg\nZW5kUXVlcnlIaW50KCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIE5BVElWRV9RVUVSWToKICAgICAgICAgICAg\nICAgICAgICBlbmROYW1lZE5hdGl2ZVF1ZXJ5KCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX1NUUklO\nRzoKICAgICAgICAgICAgICAgICAgICBlbmRRdWVyeVN0cmluZygpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBT\nRVFfR0VORVJBVE9SOgogICAgICAgICAgICAgICAgICAgIGVuZFNlcXVlbmNl\nR2VuZXJhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRhZyA9PSBFTEVNX0FDQ0VT\nUykKICAgICAgICAgICAgZW5kQWNjZXNzKCk7CiAgICAgICAgZWxzZSBpZiAo\ndGFnID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAgIGVuZEVudGl0eUxp\nc3RlbmVyKCk7CgogICAgICAgIF9wYXJlbnRzLnBvcCgpOwogICAgfQoKICAg\nIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVt\nZW50IG91dHNpZGUgb2YgYW55IGNsYXNzLgogICAgICoKICAgICAqIEByZXR1\ncm4gdGhlIHRhZyBmb3IgdGhlIGdpdmVuIGVsZW1lbnQsIG9yIG51bGwgdG8g\nc2tpcCB0aGUgZWxlbWVudAogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0\nIHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBs\nZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5nIGVsZW1lbnQgb3V0c2lkZSBvZiBh\nbnkgY2xhc3MuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGVuZFN5c3Rl\nbU1hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIGJvb2xlYW4gc3RhcnRDbGFzc0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgT2JqZWN0IHRhZyA9IChPYmplY3QpIF9lbGVtcy5nZXQobmFt\nZSk7CiAgICAgICAgYm9vbGVhbiByZXQgPSBmYWxzZTsKICAgICAgICBpZiAo\ndGFnID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJy\naWRlTW9kZSgpKQogICAgICAgICAgICAgICAgdGFnID0gc3RhcnRDbGFzc01h\ncHBpbmdFbGVtZW50KG5hbWUsIGF0dHJzKTsKICAgICAgICAgICAgcmV0ID0g\ndGFnICE9IG51bGw7CiAgICAgICAgfSBlbHNlIGlmICh0YWcgaW5zdGFuY2Vv\nZiBNZXRhRGF0YVRhZykgewogICAgICAgICAgICBzd2l0Y2ggKChNZXRhRGF0\nYVRhZykgdGFnKSB7CiAgICAgICAgICAgICAgICBjYXNlIEdFTkVSQVRFRF9W\nQUxVRToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEdlbmVyYXRl\nZFZhbHVlKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgSUQ6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRJZChhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIEVNQkVEREVEX0lEOgogICAgICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0RW1iZWRkZWRJZChhdHRycyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElE\nX0NMQVNTOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0SWRDbGFz\ncyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIExPQjoKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydExvYihhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFFVRVJZOgogICAgICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0TmFtZWRRdWVyeShhdHRycyk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX0hJTlQ6\nCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRRdWVyeUhpbnQoYXR0\ncnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnROYW1lZE5hdGl2ZVF1ZXJ5KGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfU1RS\nSU5HOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0UXVlcnlTdHJp\nbmcoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBTRVFfR0VORVJBVE9SOgogICAgICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0U2VxdWVuY2VHZW5lcmF0b3IoYXR0cnMpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBW\nRVJTSU9OOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0VmVyc2lv\nbihhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIE1BUF9LRVk6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRNYXBLZXkoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGTFVTSF9NT0RFOgogICAgICAg\nICAgICAgICAgICAgIHJldCA9IHN0YXJ0Rmx1c2hNb2RlKGF0dHJzKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nT1JERVJfQlk6CiAgICAgICAgICAgICAgICBjYXNlIEVOVElUWV9MSVNURU5F\nUlM6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUo\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgRVhDTFVERV9ERUZBVUxUX0xJU1RFTkVSUzoKICAgICAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydEV4Y2x1ZGVEZWZhdWx0TGlzdGVuZXJzKGF0\ndHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgRVhDTFVERV9TVVBFUkNMQVNTX0xJU1RFTkVSUzoKICAgICAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydEV4Y2x1ZGVTdXBlcmNsYXNzTGlz\ndGVuZXJzKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgUFJFX1BFUlNJU1Q6CiAgICAgICAgICAgICAg\nICBjYXNlIFBPU1RfUEVSU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUFJF\nX1JFTU9WRToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9SRU1PVkU6CiAg\nICAgICAgICAgICAgICBjYXNlIFBSRV9VUERBVEU6CiAgICAgICAgICAgICAg\nICBjYXNlIFBPU1RfVVBEQVRFOgogICAgICAgICAgICAgICAgY2FzZSBQT1NU\nX0xPQUQ6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRDYWxsYmFj\naygoTWV0YURhdGFUYWcpIHRhZywgYXR0cnMpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAg\nICAgICAgICAgICB3YXJuVW5zdXBwb3J0ZWRUYWcobmFtZSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIFBlcnNp\nc3RlbmNlU3RyYXRlZ3kpIHsKICAgICAgICAgICAgUGVyc2lzdGVuY2VTdHJh\ndGVneSBwcyA9IChQZXJzaXN0ZW5jZVN0cmF0ZWd5KSB0YWc7CiAgICAgICAg\nICAgIHJldCA9IHN0YXJ0U3RyYXRlZ3kocHMsIGF0dHJzKTsKICAgICAgICAg\nICAgaWYgKHJldCkKICAgICAgICAgICAgICAgIF9zdHJhdGVneSA9IHBzOwog\nICAgICAgIH0gZWxzZSBpZiAodGFnID09IEVMRU1fTElTVEVORVIpCiAgICAg\nICAgICAgIHJldCA9IHN0YXJ0RW50aXR5TGlzdGVuZXIoYXR0cnMpOwogICAg\nICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0FUVFJTKQogICAgICAgICAgICBy\nZXQgPSBfbW9kZSAhPSBNT0RFX1FVRVJZOwogICAgICAgIGVsc2UgaWYgKHRh\nZyA9PSBFTEVNX0NBU0NBREUpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURh\ndGFNb2RlKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FE\nRV9BTEwgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9QRVIKICAgICAgICAgICAg\nfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9NRVIgfHwgdGFnID09IEVMRU1fQ0FT\nQ0FERV9SRU0KICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9S\nRUYpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0Q2FzY2FkZSh0YWcsIGF0dHJz\nKTsKCiAgICAgICAgaWYgKHJldCkKICAgICAgICAgICAgX3BhcmVudHMucHVz\naCh0YWcpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc0VsZW1lbnQoU3RyaW5n\nIG5hbWUpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nT2JqZWN0IHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYgKHRh\nZyA9PSBudWxsICYmIGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAg\nICAgICBlbmRDbGFzc01hcHBpbmdFbGVtZW50KG5hbWUpOwogICAgICAgIGVs\nc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFnKSB7CiAgICAgICAg\nICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsKICAgICAgICAgICAg\nICAgIGNhc2UgR0VORVJBVEVEX1ZBTFVFOgogICAgICAgICAgICAgICAgICAg\nIGVuZEdlbmVyYXRlZFZhbHVlKCk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIElEOgogICAgICAgICAgICAgICAg\nICAgIGVuZElkKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIEVNQkVEREVEX0lEOgogICAgICAgICAgICAgICAg\nICAgIGVuZEVtYmVkZGVkSWQoKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgSURfQ0xBU1M6CiAgICAgICAgICAg\nICAgICAgICAgZW5kSWRDbGFzcygpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBMT0I6CiAgICAgICAgICAgICAg\nICAgICAgZW5kTG9iKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFFVRVJZOgogICAgICAgICAgICAgICAgICAg\nIGVuZE5hbWVkUXVlcnkoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfSElOVDoKICAgICAgICAgICAg\nICAgICAgICBlbmRRdWVyeUhpbnQoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZOgogICAg\nICAgICAgICAgICAgICAgIGVuZE5hbWVkTmF0aXZlUXVlcnkoKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVF\nUllfU1RSSU5HOgogICAgICAgICAgICAgICAgICAgIGVuZFF1ZXJ5U3RyaW5n\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAgICAgICAgICAgICAgICAgICAgZW5k\nU2VxdWVuY2VHZW5lcmF0b3IoKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgVkVSU0lPTjoKICAgICAgICAgICAg\nICAgICAgICBlbmRWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX0JZOgogICAgICAgICAg\nICAgICAgICAgIGVuZE9yZGVyQnkoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGFnIGlu\nc3RhbmNlb2YgUGVyc2lzdGVuY2VTdHJhdGVneSkKICAgICAgICAgICAgZW5k\nU3RyYXRlZ3koKFBlcnNpc3RlbmNlU3RyYXRlZ3kpIHRhZyk7CiAgICAgICAg\nZWxzZSBpZiAodGFnID09IEVMRU1fQUNDRVNTKQogICAgICAgICAgICBlbmRB\nY2Nlc3MoKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9MSVNURU5F\nUikKICAgICAgICAgICAgZW5kRW50aXR5TGlzdGVuZXIoKTsKCiAgICAgICAg\nX3BhcmVudHMucG9wKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2cgd2Fy\nbmluZyBhYm91dCBhbiB1bnN1cHBvcnRlZCB0YWcuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCB3YXJuVW5zdXBwb3J0ZWRUYWcoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5p\nc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdl\ndCgidW5zdXBwb3J0ZWQtdGFnIiwgbmFtZSkpOwogICAgfQoKICAgIC8qKgog\nICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVtZW50IHdp\ndGhpbiBhIGNsYXNzLgogICAgICoKICAgICAqIEByZXR1cm4gdGhlIHRhZyBm\nb3IgdGhlIGdpdmVuIGVsZW1lbnQsIG9yIG51bGwgdG8gc2tpcCBlbGVtZW50\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRDbGFzc01hcHBp\nbmdFbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJldHVybiBudWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEg\nbWFwcGluZyBlbGVtZW50IHdpdGhpbiBhIGNsYXNzLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmdFbGVtZW50KFN0cmluZyBu\nYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRDbGFzcyhT\ndHJpbmcgZWxlbSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5zdGFydENsYXNzKGVsZW0s\nIGF0dHJzKTsKCiAgICAgICAgLy8gcXVlcnkgbW9kZSBvbmx5PwogICAgICAg\nIF9jbHMgPSBjbGFzc0Zvck5hbWUoY3VycmVudENsYXNzTmFtZSgpKTsKICAg\nICAgICBpZiAoX21vZGUgPT0gTU9ERV9RVUVSWSkgewogICAgICAgICAgICBp\nZiAoX3BhcnNlciAhPSBudWxsICYmCiAgICAgICAgICAgICAgICAhInRydWUi\nLmVxdWFscyhhdHRycy5nZXRWYWx1ZSgibWV0YWRhdGEtY29tcGxldGUiKSkp\nCiAgICAgICAgICAgICAgICBfcGFyc2VyLnBhcnNlKF9jbHMpOwogICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIExvZyBsb2cg\nPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2UtY2xhc3Mi\nLCBfY2xzLmdldE5hbWUoKSkpOwoKICAgICAgICBNZXRhRGF0YVJlcG9zaXRv\ncnkgcmVwb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgQ2xhc3NNZXRh\nRGF0YSBtZXRhID0gcmVwb3MuZ2V0Q2FjaGVkTWV0YURhdGEoX2Nscyk7CiAg\nICAgICAgaWYgKG1ldGEgIT0gbnVsbAogICAgICAgICAgICAmJiAoKGlzTWV0\nYURhdGFNb2RlKCkgJiYgKG1ldGEuZ2V0U291cmNlTW9kZSgpICYgTU9ERV9N\nRVRBKSAhPSAwKQogICAgICAgICAgICB8fCAoaXNNYXBwaW5nTW9kZSgpICYm\nIChtZXRhLmdldFNvdXJjZU1vZGUoKSAmIE1PREVfTUFQUElORykgIT0gMCkp\nKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiZHVwLW1l\ndGFkYXRhIiwgX2NscywgZ2V0U291cmNlTmFtZSgpKSk7CiAgICAgICAgICAg\nIF9jbHMgPSBudWxsOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQoKICAgICAgICAvLyBpZiB3ZSBkb24ndCBrbm93IHRoZSBhY2Nlc3Mg\ndHlwZSwgY2hlY2sgdG8gc2VlIGlmIGEgc3VwZXJjbGFzcwogICAgICAgIC8v\nIGhhcyBhbHJlYWR5IGRlZmluZWQgdGhlIGFjY2VzcyB0eXBlCiAgICAgICAg\naW50IGRlZmF1bHRBY2Nlc3MgPSBfYWNjZXNzOwogICAgICAgIGlmIChkZWZh\ndWx0QWNjZXNzID09IENsYXNzTWV0YURhdGEuQUNDRVNTX1VOS05PV04pIHsK\nICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBzdXAgPSByZXBvcy5nZXRDYWNo\nZWRNZXRhRGF0YShfY2xzLmdldFN1cGVyY2xhc3MoKSk7CiAgICAgICAgICAg\nIGlmIChzdXAgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGRlZmF1bHRBY2Nl\nc3MgPSBzdXAuZ2V0QWNjZXNzVHlwZSgpOwogICAgICAgIH0KCiAgICAgICAg\naWYgKG1ldGEgPT0gbnVsbCkgewogICAgICAgICAgICAvLyBhZGQgbWV0YWRh\ndGEgZm9yIHRoaXMgdHlwZQogICAgICAgICAgICBpbnQgYWNjZXNzID0gdG9B\nY2Nlc3NUeXBlKGF0dHJzLmdldFZhbHVlKCJhY2Nlc3MiKSwgZGVmYXVsdEFj\nY2Vzcyk7CiAgICAgICAgICAgIG1ldGEgPSByZXBvcy5hZGRNZXRhRGF0YShf\nY2xzLCBhY2Nlc3MpOwogICAgICAgICAgICBtZXRhLnNldEVudkNsYXNzTG9h\nZGVyKF9lbnZMb2FkZXIpOwogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1v\nZGUoTU9ERV9OT05FKTsKCiAgICAgICAgICAgIC8vIHBhcnNlIGFubm90YXRp\nb25zIGZpcnN0IHNvIFhNTCBvdmVycmlkZXMgdGhlbQogICAgICAgICAgICBp\nZiAoX3BhcnNlciAhPSBudWxsICYmCiAgICAgICAgICAgICAgICAhInRydWUi\nLmVxdWFscyhhdHRycy5nZXRWYWx1ZSgibWV0YWRhdGEtY29tcGxldGUiKSkp\nCiAgICAgICAgICAgICAgICBfcGFyc2VyLnBhcnNlKF9jbHMpOwogICAgICAg\nIH0KCiAgICAgICAgYm9vbGVhbiBtYXBwZWRTdXBlciA9ICJtYXBwZWQtc3Vw\nZXJjbGFzcyIuZXF1YWxzKGVsZW0pOwogICAgICAgIGlmIChpc01ldGFEYXRh\nTW9kZSgpKSB7CiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJj\nZUZpbGUoKSwgbWV0YS5TUkNfWE1MKTsKICAgICAgICAgICAgbWV0YS5zZXRT\nb3VyY2VNb2RlKE1PREVfTUVUQSwgdHJ1ZSk7CiAgICAgICAgICAgIG1ldGEu\nc2V0TGlzdGluZ0luZGV4KF9jbHNQb3MpOwogICAgICAgICAgICBTdHJpbmcg\nbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgICAgIGlm\nICghU3RyaW5nVXRpbHMuaXNFbXB0eShuYW1lKSkKICAgICAgICAgICAgICAg\nIG1ldGEuc2V0VHlwZUFsaWFzKG5hbWUpOwogICAgICAgICAgICBtZXRhLnNl\ndEFic3RyYWN0KG1hcHBlZFN1cGVyKTsKICAgICAgICAgICAgbWV0YS5zZXRF\nbWJlZGRlZE9ubHkobWFwcGVkU3VwZXIgfHwgImVtYmVkZGFibGUiLmVxdWFs\ncyhlbGVtKSk7CiAgICAgICAgICAgIGlmIChtYXBwZWRTdXBlcikKICAgICAg\nICAgICAgICAgIG1ldGEuc2V0SWRlbnRpdHlUeXBlKG1ldGEuSURfVU5LTk9X\nTik7CiAgICAgICAgfQogICAgICAgIGlmIChpc01hcHBpbmdNb2RlKCkpCiAg\nICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01BUFBJTkcsIHRy\ndWUpOwogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAg\nICAgICAgICAgc3RhcnRDbGFzc01hcHBpbmcobWV0YSwgbWFwcGVkU3VwZXIs\nIGF0dHJzKTsKICAgICAgICBpZiAoaXNRdWVyeU1vZGUoKSkKICAgICAgICAg\nICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfUVVFUlksIHRydWUpOwoKICAg\nICAgICBfY2xzUG9zKys7CiAgICAgICAgX2ZpZWxkUG9zID0gMDsKICAgICAg\nICBhZGRDb21tZW50cyhtZXRhKTsKICAgICAgICBwdXNoRWxlbWVudChtZXRh\nKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzKFN0cmluZyBlbGVtKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmIChfbW9kZSAh\nPSBNT0RFX1FVRVJZKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0\nYSA9IChDbGFzc01ldGFEYXRhKSBwb3BFbGVtZW50KCk7CiAgICAgICAgICAg\nIHN0b3JlQ2FsbGJhY2tzKG1ldGEpOwogICAgICAgICAgICBpZiAoaXNNYXBw\naW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgICAgICBlbmRDbGFzc01h\ncHBpbmcobWV0YSk7CiAgICAgICAgfQogICAgICAgIF9jbHMgPSBudWxsOwog\nICAgICAgIHN1cGVyLmVuZENsYXNzKGVsZW0pOwogICAgfQoKICAgIC8qKgog\nICAgICogSW1wbGVtZW50IHRvIGFkZCBtYXBwaW5nIGF0dHJpYnV0ZXMgdG8g\nY2xhc3MuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0Q2xhc3NN\nYXBwaW5nKENsYXNzTWV0YURhdGEgbWFwcGluZywKICAgICAgICBib29sZWFu\nIG1hcHBlZFN1cGVyLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVt\nZW50IHRvIGZpbmFsaXplIGNsYXNzIG1hcHBpbmcuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIGVuZENsYXNzTWFwcGluZyhDbGFzc01ldGFEYXRhIG1h\ncHBpbmcpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBEZWZhdWx0IGFjY2VzcyBlbGVtZW50LgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgZW5kQWNjZXNzKCkgewogICAgICAgIF9hY2Nl\nc3MgPSB0b0FjY2Vzc1R5cGUoY3VycmVudFRleHQoKSwgQ2xhc3NNZXRhRGF0\nYS5BQ0NFU1NfVU5LTk9XTik7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSB0aGUgZ2l2ZW4gc3RyaW5nIGFzIGFuIGVudGl0eSBhY2Nlc3MgdHlwZSwg\nZGVmYXVsdGluZyB0byBnaXZlbgogICAgICogZGVmYXVsdCBpZiBzdHJpbmcg\naXMgZW1wdHkuCiAgICAgKi8KICAgIHByaXZhdGUgaW50IHRvQWNjZXNzVHlw\nZShTdHJpbmcgc3RyLCBpbnQgZGVmKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0\naWxzLmlzRW1wdHkoc3RyKSkKICAgICAgICAgICAgcmV0dXJuIGRlZjsKICAg\nICAgICBpZiAoIlBST1BFUlRZIi5lcXVhbHMoc3RyKSkKICAgICAgICAgICAg\ncmV0dXJuIENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZOwogICAgICAg\nIHJldHVybiBDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIGZsdXNoLW1vZGUgZWxlbWVudC4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Rmx1c2hNb2RlKEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgidW5z\ndXBwb3J0ZWQiLCAiZmx1c2gtbW9kZSIsIGdldFNvdXJjZU5hbWUoKSkpOwog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIHNlcXVlbmNlLWdlbmVyYXRvci4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihBdHRyaWJ1dGVzIGF0\ndHJzKSB7CiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgbmFt\nZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9\nIGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkK\nICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1zZXF1ZW5j\nZSIsIG5hbWUpKTsKCiAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBtZXRhID0g\nZ2V0UmVwb3NpdG9yeSgpLmdldENhY2hlZFNlcXVlbmNlTWV0YURhdGEobmFt\nZSk7CiAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBsb2cuaXNXYXJuRW5h\nYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgib3ZlcnJp\nZGUtc2VxdWVuY2UiLCBuYW1lKSk7CgogICAgICAgIG1ldGEgPSBnZXRSZXBv\nc2l0b3J5KCkuYWRkU2VxdWVuY2VNZXRhRGF0YShuYW1lKTsKICAgICAgICBT\ndHJpbmcgc2VxID0gYXR0cnMuZ2V0VmFsdWUoInNlcXVlbmNlLW5hbWUiKTsK\nICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImluaXRpYWwt\ndmFsdWUiKTsKICAgICAgICBpbnQgaW5pdGlhbCA9IHZhbCA9PSBudWxsID8g\nMSA6IEludGVnZXIucGFyc2VJbnQodmFsKTsKICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgiYWxsb2NhdGlvbi1zaXplIik7CiAgICAgICAgaW50IGFs\nbG9jYXRlID0gdmFsID09IG51bGwgPyA1MCA6IEludGVnZXIucGFyc2VJbnQo\ndmFsKTsKCiAgICAgICAgU3RyaW5nIGNsc05hbWUsIHByb3BzOwogICAgICAg\nIGlmIChzZXEgPT0gbnVsbCB8fCBzZXEuaW5kZXhPZignKCcpID09IC0xKSB7\nCiAgICAgICAgICAgIGNsc05hbWUgPSBTZXF1ZW5jZU1ldGFEYXRhLklNUExf\nTkFUSVZFOwogICAgICAgICAgICBwcm9wcyA9IG51bGw7CiAgICAgICAgfSBl\nbHNlIHsgLy8gcGx1Z2luCiAgICAgICAgICAgIGNsc05hbWUgPSBDb25maWd1\ncmF0aW9ucy5nZXRDbGFzc05hbWUoc2VxKTsKICAgICAgICAgICAgcHJvcHMg\nPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKHNlcSk7CiAgICAgICAg\nICAgIHNlcSA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBtZXRhLnNldFNl\ncXVlbmNlUGx1Z2luKENvbmZpZ3VyYXRpb25zLmdldFBsdWdpbihjbHNOYW1l\nLCBwcm9wcykpOwogICAgICAgIG1ldGEuc2V0U2VxdWVuY2Uoc2VxKTsKICAg\nICAgICBtZXRhLnNldEluaXRpYWxWYWx1ZShpbml0aWFsKTsKICAgICAgICBt\nZXRhLnNldEFsbG9jYXRlKGFsbG9jYXRlKTsKCiAgICAgICAgT2JqZWN0IGN1\nciA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0g\nKGN1ciBpbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8g\nKChDbGFzc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51\nbGw7CiAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBz\nY29wZSwgbWV0YS5TUkNfWE1MKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTZXF1ZW5jZUdlbmVyYXRvcigp\nIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGlkLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydElkKEF0dHJpYnV0ZXMgYXR0cnMp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRN\nZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAgICAgICBmbWQu\nc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFByaW1hcnlLZXko\ndHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgZW5kSWQoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIGZpbmlzaEZpZWxkKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSBlbWJlZGRlZC1pZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJv\nb2xlYW4gc3RhcnRFbWJlZGRlZElkKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0\nYSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAgICAgICBmbWQuc2V0RXhw\nbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFByaW1hcnlLZXkodHJ1ZSk7\nCiAgICAgICAgZm1kLnNldEVtYmVkZGVkKHRydWUpOwogICAgICAgIGlmIChm\nbWQuZ2V0RW1iZWRkZWRNZXRhRGF0YSgpID09IG51bGwpCiAgICAgICAgICAg\nIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kRW1iZWRkZWRJZCgp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgZmluaXNo\nRmllbGQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGlkLWNsYXNz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydElkQ2xhc3Mo\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0g\nKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3Ry\naW5nIGNscyA9IGF0dHJzLmdldFZhbHVlKCJjbGFzcyIpOwogICAgICAgIENs\nYXNzIGlkQ2xzID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBp\nZENscyA9IGNsYXNzRm9yTmFtZShjbHMpOwogICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihf\nbG9jLmdldCgiaW52YWxpZC1pZC1jbGFzcyIsIG1ldGEsIGNscyksIHQpOwog\nICAgICAgIH0KICAgICAgICBtZXRhLnNldE9iamVjdElkVHlwZShpZENscywg\ndHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgZW5kSWRDbGFzcygpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBsb2IuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0TG9iKEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBpZiAoZm1kLmdldERlY2xhcmVkVHlwZUNvZGUo\nKSAhPSBKYXZhVHlwZXMuU1RSSU5HCiAgICAgICAgICAgICYmIGZtZC5nZXRE\nZWNsYXJlZFR5cGUoKSAhPSBjaGFyW10uY2xhc3MKICAgICAgICAgICAgJiYg\nZm1kLmdldERlY2xhcmVkVHlwZSgpICE9IENoYXJhY3RlcltdLmNsYXNzCiAg\nICAgICAgICAgICYmIGZtZC5nZXREZWNsYXJlZFR5cGUoKSAhPSBieXRlW10u\nY2xhc3MKICAgICAgICAgICAgJiYgZm1kLmdldERlY2xhcmVkVHlwZSgpICE9\nIEJ5dGVbXS5jbGFzcykKICAgICAgICAgICAgZm1kLnNldFNlcmlhbGl6ZWQo\ndHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgZW5kTG9iKCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGdlbmVyYXRlZC12YWx1\nZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRHZW5lcmF0\nZWRWYWx1ZShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJpZGVNb2Rl\nKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU3RyaW5n\nIHN0cmF0ZWd5ID0gYXR0cnMuZ2V0VmFsdWUoInN0cmF0ZWd5Iik7CiAgICAg\nICAgU3RyaW5nIGdlbmVyYXRvciA9IGF0dHJzLmdldFZhbHVlKCJnZW5lcmF0\nb3IiKTsKICAgICAgICBHZW5lcmF0aW9uVHlwZSB0eXBlID0gU3RyaW5nVXRp\nbHMuaXNFbXB0eShzdHJhdGVneSkKICAgICAgICAgICAgPyBHZW5lcmF0aW9u\nVHlwZS5BVVRPIDogR2VuZXJhdGlvblR5cGUudmFsdWVPZihzdHJhdGVneSk7\nCgogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEp\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgQW5ub3RhdGlvblBlcnNpc3Rl\nbmNlTWV0YURhdGFQYXJzZXIucGFyc2VHZW5lcmF0ZWRWYWx1ZShmbWQsIHR5\ncGUsCiAgICAgICAgICAgIGdlbmVyYXRvcik7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kR2VuZXJhdGVkVmFs\ndWUoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAg\nIC8qKgogICAgICogTGF6aWx5IHBhcnNlIGNhc2NhZGVzLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydENhc2NhZGUoT2JqZWN0IHRhZywg\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgU2V0PENhc2NhZGVUeXBlPiBjYXNj\nYWRlcyA9IG51bGw7CiAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50KCkgaW5z\ndGFuY2VvZiBGaWVsZE1ldGFEYXRhKSB7CiAgICAgICAgICAgIGlmIChfY2Fz\nY2FkZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jYXNjYWRlcyA9IEVu\ndW1TZXQubm9uZU9mKENhc2NhZGVUeXBlLmNsYXNzKTsKICAgICAgICAgICAg\nY2FzY2FkZXMgPSBfY2FzY2FkZXM7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgaWYgKF9wa2dDYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgX3BrZ0Nhc2NhZGVzID0gRW51bVNldC5ub25lT2YoQ2FzY2FkZVR5cGUu\nY2xhc3MpOwogICAgICAgICAgICBjYXNjYWRlcyA9IF9wa2dDYXNjYWRlczsK\nICAgICAgICB9CiAgICAgICAgYm9vbGVhbiBhbGwgPSBFTEVNX0NBU0NBREVf\nQUxMID09IHRhZzsKICAgICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9Q\nRVIgPT0gdGFnKQogICAgICAgICAgICBjYXNjYWRlcy5hZGQoUEVSU0lTVCk7\nCiAgICAgICAgaWYgKGFsbCB8fCBFTEVNX0NBU0NBREVfUkVNID09IHRhZykK\nICAgICAgICAgICAgY2FzY2FkZXMuYWRkKFJFTU9WRSk7CiAgICAgICAgaWYg\nKGFsbCB8fCBFTEVNX0NBU0NBREVfTUVSID09IHRhZykKICAgICAgICAgICAg\nY2FzY2FkZXMuYWRkKE1FUkdFKTsKICAgICAgICBpZiAoYWxsIHx8IEVMRU1f\nQ0FTQ0FERV9SRUYgPT0gdGFnKQogICAgICAgICAgICBjYXNjYWRlcy5hZGQo\nUkVGUkVTSCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTZXQgdGhlIGNhY2hlZCBjYXNjYWRlcyBpbnRvIHRoZSBmaWVs\nZC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2V0Q2FzY2FkZXMoRmll\nbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBTZXQ8Q2FzY2FkZVR5cGU+IGNh\nc2NhZGVzID0gX2Nhc2NhZGVzOwogICAgICAgIGlmIChfY2FzY2FkZXMgPT0g\nbnVsbCkKICAgICAgICAgICAgY2FzY2FkZXMgPSBfcGtnQ2FzY2FkZXM7CiAg\nICAgICAgaWYgKGNhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbjsKCiAgICAgICAgVmFsdWVNZXRhRGF0YSB2bWQgPSBmbWQ7CiAgICAgICAg\nc3dpdGNoIChfc3RyYXRlZ3kpIHsKICAgICAgICAgICAgY2FzZSBPTkVfTUFO\nWToKICAgICAgICAgICAgY2FzZSBNQU5ZX01BTlk6CiAgICAgICAgICAgICAg\nICB2bWQgPSBmbWQuZ2V0RWxlbWVudCgpOwogICAgICAgIH0KICAgICAgICBm\nb3IgKENhc2NhZGVUeXBlIGNhc2NhZGUgOiBjYXNjYWRlcykgewogICAgICAg\nICAgICBzd2l0Y2ggKGNhc2NhZGUpIHsKICAgICAgICAgICAgICAgIGNhc2Ug\nUEVSU0lTVDoKICAgICAgICAgICAgICAgICAgICB2bWQuc2V0Q2FzY2FkZVBl\ncnNpc3QoVmFsdWVNZXRhRGF0YS5DQVNDQURFX0lNTUVESUFURSk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE1F\nUkdFOgogICAgICAgICAgICAgICAgICAgIHZtZC5zZXRDYXNjYWRlQXR0YWNo\nKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9JTU1FRElBVEUpOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBSRU1PVkU6\nCiAgICAgICAgICAgICAgICAgICAgdm1kLnNldENhc2NhZGVEZWxldGUoVmFs\ndWVNZXRhRGF0YS5DQVNDQURFX0lNTUVESUFURSk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFJFRlJFU0g6CiAg\nICAgICAgICAgICAgICAgICAgdm1kLnNldENhc2NhZGVSZWZyZXNoKFZhbHVl\nTWV0YURhdGEuQ0FTQ0FERV9JTU1FRElBVEUpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIF9j\nYXNjYWRlcyA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBj\nb21tb24gZmllbGQgYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSBG\naWVsZE1ldGFEYXRhIHBhcnNlRmllbGQoQXR0cmlidXRlcyBhdHRycykKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDbGFzc01ldGFE\nYXRhIG1ldGEgPSAoQ2xhc3NNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsK\nICAgICAgICBTdHJpbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7\nCiAgICAgICAgRmllbGRNZXRhRGF0YSBmaWVsZCA9IG1ldGEuZ2V0RGVjbGFy\nZWRGaWVsZChuYW1lKTsKICAgICAgICBpZiAoKGZpZWxkID09IG51bGwgfHwg\nZmllbGQuZ2V0RGVjbGFyZWRUeXBlKCkgPT0gT2JqZWN0LmNsYXNzKQogICAg\nICAgICAgICAmJiBtZXRhLmdldERlc2NyaWJlZFR5cGUoKSAhPSBPYmplY3Qu\nY2xhc3MpIHsKICAgICAgICAgICAgTWVtYmVyIG1lbWJlciA9IG51bGw7CiAg\nICAgICAgICAgIENsYXNzIHR5cGUgPSBudWxsOwogICAgICAgICAgICBpbnQg\nZGVmID0gX3JlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdldERlZmF1bHRz\nKCkuCiAgICAgICAgICAgICAgICBnZXREZWZhdWx0QWNjZXNzVHlwZSgpOwog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKG1ldGEuZ2V0\nQWNjZXNzVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZ\nCiAgICAgICAgICAgICAgICAgICAgfHwgKG1ldGEuZ2V0QWNjZXNzVHlwZSgp\nID09IENsYXNzTWV0YURhdGEuQUNDRVNTX1VOS05PV04KICAgICAgICAgICAg\nICAgICAgICAmJiBkZWYgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfUFJPUEVS\nVFkpKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGNhcCA9IFN0cmlu\nZ1V0aWxzLmNhcGl0YWxpemUobmFtZSk7CiAgICAgICAgICAgICAgICAgICAg\ndHlwZSA9IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlciA9\nIChNZXRob2QpIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0RGVj\nbGFyZWRNZXRob2RBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgdHlwZSwgImdldCIgKyBjYXAsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKENsYXNzW10pIG51bGwpKTsvLyB2YXJhcmdzIGRpc2Ft\nYmlndWF0ZQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBleGNlcCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyID0gKE1ldGhvZCkgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0RGVjbGFyZWRNZXRo\nb2RBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHR5cGUsICJpcyIgKyBjYXAsIChDbGFzc1tdKSBudWxsKSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleGNlcDIpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGV4Y2VwOwogICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgICAgIHR5cGUgPSAoKE1ldGhvZCkgbWVtYmVyKS5n\nZXRSZXR1cm5UeXBlKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgIG1lbWJlciA9IChGaWVsZCkgQWNjZXNzQ29udHJv\nbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAgICAgICAgIEoy\nRG9Qcml2SGVscGVyLmdldERlY2xhcmVkRmllbGRBY3Rpb24oCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBtZXRhLmdldERlc2NyaWJlZFR5cGUoKSwg\nbmFtZSkpOwogICAgICAgICAgICAgICAgICAgIHR5cGUgPSAoKEZpZWxkKSBt\nZW1iZXIpLmdldFR5cGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGlm\nIChlIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikKICAg\nICAgICAgICAgICAgICAgICBlID0gKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0\naW9uKSBlKS5nZXRFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAgIHRocm93\nIGdldEV4Y2VwdGlvbihfbG9jLmdldCgiaW52YWxpZC1hdHRyIiwgbmFtZSwg\nbWV0YSksIGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZmll\nbGQgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgZmllbGQgPSBtZXRhLmFk\nZERlY2xhcmVkRmllbGQobmFtZSwgdHlwZSk7CiAgICAgICAgICAgICAgICBQ\nZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmll\nbGQpOwogICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1\nbHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEtleSgpKTsKICAgICAgICAg\nICAgICAgIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNjYWRl\nTm9uZShmaWVsZC5nZXRFbGVtZW50KCkpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGZpZWxkLmJhY2tpbmdNZW1iZXIobWVtYmVyKTsKICAgICAgICB9\nIGVsc2UgaWYgKGZpZWxkID09IG51bGwpIHsKICAgICAgICAgICAgZmllbGQg\nPSBtZXRhLmFkZERlY2xhcmVkRmllbGQobmFtZSwgT2JqZWN0LmNsYXNzKTsK\nICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzLnNldENh\nc2NhZGVOb25lKGZpZWxkKTsKICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRh\nRGF0YURlZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEtleSgpKTsK\nICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzLnNldENh\nc2NhZGVOb25lKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAgICAgICAgfQoKICAg\nICAgICBpZiAoaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgZmllbGQu\nc2V0TGlzdGluZ0luZGV4KF9maWVsZFBvcyk7CgogICAgICAgIF9maWVsZFBv\ncysrOwogICAgICAgIHB1c2hFbGVtZW50KGZpZWxkKTsKICAgICAgICBhZGRD\nb21tZW50cyhmaWVsZCk7CgogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlk\nZU1vZGUoKSkKICAgICAgICAgICAgc3RhcnRGaWVsZE1hcHBpbmcoZmllbGQs\nIGF0dHJzKTsKICAgICAgICByZXR1cm4gZmllbGQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQb3BzIGZpZWxkIGVsZW1lbnQuCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBmaW5pc2hGaWVsZCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmaWVsZCA9IChGaWVsZE1l\ndGFEYXRhKSBwb3BFbGVtZW50KCk7CiAgICAgICAgc2V0Q2FzY2FkZXMoZmll\nbGQpOwogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAg\nICAgICAgICAgZW5kRmllbGRNYXBwaW5nKGZpZWxkKTsKICAgICAgICBfc3Ry\nYXRlZ3kgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50\nIHRvIGFkZCBmaWVsZCBtYXBwaW5nIGRhdGEuIERvZXMgbm90aGluZyBieSBk\nZWZhdWx0LgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydEZpZWxk\nTWFwcGluZyhGaWVsZE1ldGFEYXRhIGZpZWxkLCBBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8q\nKgogICAgICogSW1wbGVtZW50IHRvIGZpbmFsaXplIGZpZWxkIG1hcHBpbmcu\nIERvZXMgbm90aGluZyBieSBkZWZhdWx0LgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBlbmRGaWVsZE1hcHBpbmcoRmllbGRNZXRhRGF0YSBmaWVsZCkK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioK\nICAgICAqIFBhcnNlIHZlcnNpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBi\nb29sZWFuIHN0YXJ0VmVyc2lvbihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxkTWV0YURhdGEg\nZm1kID0gcGFyc2VGaWVsZChhdHRycyk7CiAgICAgICAgZm1kLnNldEV4cGxp\nY2l0KHRydWUpOwogICAgICAgIGZtZC5zZXRWZXJzaW9uKHRydWUpOwogICAg\nICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVu\nZFZlcnNpb24oKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIGZpbmlzaEZpZWxkKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBzdHJhdGVneSBlbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc3RhcnRTdHJhdGVneShQZXJzaXN0ZW5jZVN0cmF0ZWd5IHN0cmF0ZWd5\nLAogICAgICAgIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSBwYXJz\nZUZpZWxkKGF0dHJzKTsKICAgICAgICBmbWQuc2V0RXhwbGljaXQodHJ1ZSk7\nCiAgICAgICAgZm1kLnNldE1hbmFnZW1lbnQoRmllbGRNZXRhRGF0YS5NQU5B\nR0VfUEVSU0lTVEVOVCk7CgogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5n\nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAg\nICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdyb3VwKCJFQUdFUiIu\nZXF1YWxzKHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJv\ncHRpb25hbCIpOwogICAgICAgIGlmICgiZmFsc2UiLmVxdWFscyh2YWwpKQog\nICAgICAgICAgICBmbWQuc2V0TnVsbFZhbHVlKEZpZWxkTWV0YURhdGEuTlVM\nTF9FWENFUFRJT04pOwogICAgICAgIGVsc2UgaWYgKCJ0cnVlIi5lcXVhbHMo\ndmFsKQogICAgICAgICAgICAgICAgJiYgZm1kLmdldE51bGxWYWx1ZSgpID09\nIEZpZWxkTWV0YURhdGEuTlVMTF9FWENFUFRJT04pIHsKICAgICAgICAgICAg\nLy8gUmVzZXQgdmFsdWUgaWYgdGhlIGZpZWxkIHdhcyBhbm5vdGF0ZWQgd2l0\naCBvcHRpb25hbD1mYWxzZS4gCiAgICAgICAgICAgIC8vIE90aGVyd2lzZSBs\nZWF2ZSBpdCBhbG9uZS4KICAgICAgICAgICAgZm1kLnNldE51bGxWYWx1ZShG\naWVsZE1ldGFEYXRhLk5VTExfVU5TRVQpOwogICAgICAgIH0KICAgICAgICBp\nZiAoaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpIHsKICAgICAgICAgICAgdmFs\nID0gYXR0cnMuZ2V0VmFsdWUoIm1hcHBlZC1ieSIpOwogICAgICAgICAgICBp\nZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgICAgICBmbWQuc2V0TWFwcGVk\nQnkodmFsKTsKICAgICAgICB9CiAgICAgICAgcGFyc2VTdHJhdGVneShmbWQs\nIHN0cmF0ZWd5LCBhdHRycyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIGVuZFN0cmF0ZWd5KFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kgc3RyYXRlZ3kpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlIHN0cmF0ZWd5IHNwZWNpZmljIGF0dHJpYnV0ZXMuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBwYXJzZVN0cmF0ZWd5KEZpZWxkTWV0YURhdGEg\nZm1kLAogICAgICAgIFBlcnNpc3RlbmNlU3RyYXRlZ3kgc3RyYXRlZ3ksIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgc3dpdGNoIChzdHJhdGVneSkgewogICAgICAgICAgICBjYXNl\nIEJBU0lDOgogICAgICAgICAgICAgICAgcGFyc2VCYXNpYyhmbWQsIGF0dHJz\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEVN\nQkVEREVEOgogICAgICAgICAgICAgICAgcGFyc2VFbWJlZGRlZChmbWQsIGF0\ndHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIE9ORV9PTkU6CiAgICAgICAgICAgICAgICBwYXJzZU9uZVRvT25lKGZtZCwg\nYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgTUFOWV9PTkU6CiAgICAgICAgICAgICAgICBwYXJzZU1hbnlUb09uZShm\nbWQsIGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIE1BTllfTUFOWToKICAgICAgICAgICAgICAgIHBhcnNlTWFueVRv\nTWFueShmbWQsIGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIE9ORV9NQU5ZOgogICAgICAgICAgICAgICAgcGFyc2VP\nbmVUb01hbnkoZm1kLCBhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBUUkFOU0lFTlQ6CiAgICAgICAgICAgICAgICBm\nbWQuc2V0TWFuYWdlbWVudChGaWVsZE1ldGFEYXRhLk1BTkFHRV9OT05FKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIGJhc2ljLgogICAgICovCiAgICBwcm90ZWN0ZWQg\ndm9pZCBwYXJzZUJhc2ljKEZpZWxkTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgZW1iZWRkZWQuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIHBhcnNlRW1iZWRkZWQoRmllbGRNZXRhRGF0YSBmbWQs\nIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgYXNzZXJ0UEMoZm1kLCAiRW1iZWRkZWQiKTsKICAgICAg\nICBmbWQuc2V0RW1iZWRkZWQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFNlcmlh\nbGl6ZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBhbnkgTG9iIGFubm90YXRpb24K\nICAgICAgICBpZiAoZm1kLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxs\nKQogICAgICAgICAgICBmbWQuYWRkRW1iZWRkZWRNZXRhRGF0YSgpOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhyb3cgcHJvcGVyIGV4Y2VwdGlvbiBpZiBn\naXZlbiB2YWx1ZSBpcyBub3QgcG9zc2libHkgcGVyc2lzdGVuY2UKICAgICAq\nIGNhcGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhc3NlcnRQQyhG\naWVsZE1ldGFEYXRhIGZtZCwgU3RyaW5nIGF0dHIpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFKYXZhVHlwZXMubWF5YmVQ\nQyhmbWQpKQogICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5n\nZXQoImJhZC1tZXRhLWFubm8iLCBmbWQsIGF0dHIpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIG9uZS10by1vbmUuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHBhcnNlT25lVG9PbmUoRmllbGRNZXRhRGF0YSBmbWQsIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ0YXJnZXQt\nZW50aXR5Iik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAg\nICBmbWQuc2V0VHlwZU92ZXJyaWRlKGNsYXNzRm9yTmFtZSh2YWwpKTsKICAg\nICAgICBhc3NlcnRQQyhmbWQsICJPbmVUb09uZSIpOwogICAgICAgIGZtZC5z\nZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJpZGUgYW55IExvYiBhbm5v\ndGF0aW9uCiAgICAgICAgaWYgKCFmbWQuaXNEZWZhdWx0RmV0Y2hHcm91cEV4\ncGxpY2l0KCkpCiAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdy\nb3VwKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgbWFueS10\nby1vbmUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlTWFueVRv\nT25lKEZpZWxkTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFN0cmluZyB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgidGFyZ2V0LWVudGl0eSIpOwogICAgICAgIGlm\nICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLnNldFR5cGVPdmVycmlk\nZShjbGFzc0Zvck5hbWUodmFsKSk7CiAgICAgICAgYXNzZXJ0UEMoZm1kLCAi\nTWFueVRvT25lIik7CiAgICAgICAgZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2Up\nOyAvLyBvdmVycmlkZSBhbnkgTG9iIGFubm90YXRpb24KICAgICAgICBpZiAo\nIWZtZC5pc0RlZmF1bHRGZXRjaEdyb3VwRXhwbGljaXQoKSkKICAgICAgICAg\nICAgZm1kLnNldEluRGVmYXVsdEZldGNoR3JvdXAodHJ1ZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQYXJzZSBtYW55LXRvLW1hbnkuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHBhcnNlTWFueVRvTWFueShGaWVsZE1ldGFEYXRh\nIGZtZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nInRhcmdldC1lbnRpdHkiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAg\nICAgICAgICAgIGZtZC5nZXRFbGVtZW50KCkuc2V0RGVjbGFyZWRUeXBlKGNs\nYXNzRm9yTmFtZSh2YWwpKTsKICAgICAgICBhc3NlcnRQQ0NvbGxlY3Rpb24o\nZm1kLCAiTWFueVRvTWFueSIpOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVk\nKGZhbHNlKTsgLy8gb3ZlcnJpZGUgTG9iIGluIGFubm90YXRpb24KICAgIH0K\nCiAgICAvKioKICAgICAqIFRocm93IGV4Y2VwdGlvbiBpZiBnaXZlbiBmaWVs\nZCBub3QgYSBjb2xsZWN0aW9uIG9mIHBvc3NpYmxlIHBlcnNpc3RlbmNlCiAg\nICAgKiBjYXBhYmxlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2Vy\ndFBDQ29sbGVjdGlvbihGaWVsZE1ldGFEYXRhIGZtZCwgU3RyaW5nIGF0dHIp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgc3dpdGNo\nIChmbWQuZ2V0RGVjbGFyZWRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5DT0xMRUNUSU9OOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6\nCiAgICAgICAgICAgICAgICBpZiAoSmF2YVR5cGVzLm1heWJlUEMoZm1kLmdl\ndEVsZW1lbnQoKSkpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICAvLyBubyBicmVhawogICAgICAgICAgICBkZWZhdWx0Ogog\nICAgICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJi\nYWQtbWV0YS1hbm5vIiwgZm1kLCBhdHRyKSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2Ugb25lLXRvLW1hbnkuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHBhcnNlT25lVG9NYW55KEZpZWxkTWV0YURhdGEg\nZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgi\ndGFyZ2V0LWVudGl0eSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAg\nICAgICAgICAgZm1kLmdldEVsZW1lbnQoKS5zZXREZWNsYXJlZFR5cGUoY2xh\nc3NGb3JOYW1lKHZhbCkpOwogICAgICAgIGFzc2VydFBDQ29sbGVjdGlvbihm\nbWQsICJPbmVUb01hbnkiKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChm\nYWxzZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgbWFwLWtleS4KICAgICAqLwogICAgcHJp\ndmF0ZSBib29sZWFuIHN0YXJ0TWFwS2V5KEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01h\ncHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwoKICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IChGaWVsZE1ldGFEYXRh\nKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBtYXBLZXkgPSBh\ndHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIGlmIChtYXBLZXkgPT0g\nbnVsbCkKICAgICAgICAgICAgZm1kLmdldEtleSgpLnNldFZhbHVlTWFwcGVk\nQnkoVmFsdWVNZXRhRGF0YS5NQVBQRURfQllfUEspOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgZm1kLmdldEtleSgpLnNldFZhbHVlTWFwcGVkQnkobWFw\nS2V5KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIG9yZGVyLWJ5LgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nZW5kT3JkZXJCeSgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3Vy\ncmVudEVsZW1lbnQoKTsKICAgICAgICBTdHJpbmcgZGVjID0gY3VycmVudFRl\neHQoKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShkZWMpKQog\nICAgICAgICAgICBkZWMgPSBPcmRlci5FTEVNRU5UICsgIiBhc2MiOwogICAg\nICAgIGZtZC5zZXRPcmRlckRlY2xhcmF0aW9uKGRlYyk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBQYXJzZSBuYW1lZC1xdWVyeS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGJvb2xlYW4gc3RhcnROYW1lZFF1ZXJ5KEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKCFpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7Cgog\nICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsK\nICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5p\nc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5n\nZXQoInBhcnNlLXF1ZXJ5IiwgbmFtZSkpOwoKICAgICAgICBRdWVyeU1ldGFE\nYXRhIG1ldGEgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0Q2FjaGVkUXVlcnlNZXRh\nRGF0YShudWxsLCBuYW1lKTsKICAgICAgICBpZiAobWV0YSAhPSBudWxsICYm\nIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9s\nb2MuZ2V0KCJvdmVycmlkZS1xdWVyeSIsIG5hbWUsIGN1cnJlbnRMb2NhdGlv\nbigpKSk7CgogICAgICAgIG1ldGEgPSBnZXRSZXBvc2l0b3J5KCkuYWRkUXVl\ncnlNZXRhRGF0YShudWxsLCBuYW1lKTsKICAgICAgICBtZXRhLnNldERlZmlu\naW5nVHlwZShfY2xzKTsKICAgICAgICBtZXRhLnNldFF1ZXJ5U3RyaW5nKGF0\ndHJzLmdldFZhbHVlKCJxdWVyeSIpKTsKICAgICAgICBtZXRhLnNldExhbmd1\nYWdlKEpQUUxQYXJzZXIuTEFOR19KUFFMKTsKCiAgICAgICAgT2JqZWN0IGN1\nciA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0g\nKGN1ciBpbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8g\nKChDbGFzc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51\nbGw7CiAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBz\nY29wZSwgbWV0YS5TUkNfWE1MKTsKICAgICAgICBpZiAoaXNNZXRhRGF0YU1v\nZGUoKSkKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUVU\nQSk7CiAgICAgICAgZWxzZSBpZiAoaXNNYXBwaW5nTW9kZSgpKQogICAgICAg\nICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NQVBQSU5HKTsKICAgICAg\nICBlbHNlCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX1FV\nRVJZKTsKICAgICAgICBwdXNoRWxlbWVudChtZXRhKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmROYW1lZFF1\nZXJ5KCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBw\nb3BFbGVtZW50KCk7CiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3Rh\ncnRRdWVyeVN0cmluZyhBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIHByb3RlY3RlZCB2b2lkIGVuZFF1ZXJ5U3RyaW5nKCkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBRdWVyeU1ldGFEYXRhIG1l\ndGEgPSAoUXVlcnlNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAg\nICBtZXRhLnNldFF1ZXJ5U3RyaW5nKGN1cnJlbnRUZXh0KCkpOwogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgcXVlcnktaGludC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRRdWVyeUhpbnQoQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBR\ndWVyeU1ldGFEYXRhIG1ldGEgPSAoUXVlcnlNZXRhRGF0YSkgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBtZXRhLmFkZEhpbnQoYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKSwgYXR0cnMuZ2V0VmFsdWUoInZhbHVlIikpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZFF1ZXJ5\nSGludCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQYXJzZSBuYXRpdmUtbmFtZWQtcXVlcnkuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0TmFtZWROYXRpdmVRdWVy\neShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIGlmICghaXNRdWVyeU1vZGUoKSkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgbmFtZSA9IGF0dHJzLmdl\ndFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwog\nICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAg\nbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1uYXRpdmUtcXVlcnkiLCBuYW1l\nKSk7CgogICAgICAgIFF1ZXJ5TWV0YURhdGEgbWV0YSA9IGdldFJlcG9zaXRv\ncnkoKS5nZXRDYWNoZWRRdWVyeU1ldGFEYXRhKG51bGwsIG5hbWUpOwogICAg\nICAgIGlmIChtZXRhICE9IG51bGwgJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkK\nICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoIm92ZXJyaWRlLXF1ZXJ5\nIiwgbmFtZSwgY3VycmVudExvY2F0aW9uKCkpKTsKCiAgICAgICAgbWV0YSA9\nIGdldFJlcG9zaXRvcnkoKS5hZGRRdWVyeU1ldGFEYXRhKG51bGwsIG5hbWUp\nOwogICAgICAgIG1ldGEuc2V0RGVmaW5pbmdUeXBlKF9jbHMpOwogICAgICAg\nIG1ldGEuc2V0UXVlcnlTdHJpbmcoYXR0cnMuZ2V0VmFsdWUoInF1ZXJ5Iikp\nOwogICAgICAgIG1ldGEuc2V0TGFuZ3VhZ2UoUXVlcnlMYW5ndWFnZXMuTEFO\nR19TUUwpOwogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgi\ncmVzdWx0LWNsYXNzIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKSB7CiAg\nICAgICAgICAgIENsYXNzIHR5cGUgPSBjbGFzc0Zvck5hbWUodmFsKTsKICAg\nICAgICAgICAgaWYgKEltcGxIZWxwZXIuaXNNYW5hZ2VkVHlwZShnZXRDb25m\naWd1cmF0aW9uKCksIHR5cGUpKQogICAgICAgICAgICAgICAgbWV0YS5zZXRD\nYW5kaWRhdGVUeXBlKHR5cGUpOwogICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICBtZXRhLnNldFJlc3VsdFR5cGUodHlwZSk7CiAgICAgICAgfQoK\nICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgicmVzdWx0LXNldC1tYXBw\naW5nIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBt\nZXRhLnNldFJlc3VsdFNldE1hcHBpbmdOYW1lKHZhbCk7CgogICAgICAgIE9i\namVjdCBjdXIgPSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIE9iamVjdCBz\nY29wZSA9IChjdXIgaW5zdGFuY2VvZiBDbGFzc01ldGFEYXRhKQogICAgICAg\nICAgICA/ICgoQ2xhc3NNZXRhRGF0YSkgY3VyKS5nZXREZXNjcmliZWRUeXBl\nKCkgOiBudWxsOwogICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJjZUZp\nbGUoKSwgc2NvcGUsIG1ldGEuU1JDX1hNTCk7CiAgICAgICAgaWYgKGlzTWV0\nYURhdGFNb2RlKCkpCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShN\nT0RFX01FVEEpOwogICAgICAgIGVsc2UgaWYgKGlzTWFwcGluZ01vZGUoKSkK\nICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUFQUElORyk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUo\nTU9ERV9RVUVSWSk7CiAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5k\nTmFtZWROYXRpdmVRdWVyeSgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAgfQoKICAgIC8qKgogICAg\nICogU3RhcnQgZW50aXR5LWxpc3RlbmVycwogICAgICovCiAgICBwcml2YXRl\nIGJvb2xlYW4gc3RhcnRFbnRpdHlMaXN0ZW5lcnMoQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQoKSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgLy8gcmVzZXQgbGlzdGVuZXJz\nIGRlY2xhcmVkIGluIGFubm90YXRpb25zLgogICAgICAgIExpZmVjeWNsZU1l\ndGFEYXRhIG1ldGEgPSAoKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50\nKCkpLgogICAgICAgICAgICBnZXRMaWZlY3ljbGVNZXRhRGF0YSgpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTGlmZWN5Y2xlRXZlbnQuQUxMX0VW\nRU5UUy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgbWV0YS5zZXREZWNsYXJl\nZENhbGxiYWNrcyhpLCBudWxsLCAwKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGV4Y2x1ZGUtZGVmYXVsdC1s\naXN0ZW5lcnMuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEV4\nY2x1ZGVEZWZhdWx0TGlzdGVuZXJzKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01ldGFE\nYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEpIGN1cnJlbnRF\nbGVtZW50KCk7CiAgICAgICAgbWV0YS5nZXRMaWZlY3ljbGVNZXRhRGF0YSgp\nLnNldElnbm9yZVN5c3RlbUxpc3RlbmVycyh0cnVlKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGV4Y2x1ZGUt\nc3VwZXJjbGFzcy1saXN0ZW5lcnMuCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBzdGFydEV4Y2x1ZGVTdXBlcmNsYXNzTGlzdGVuZXJzKEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0\nYURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgbWV0YS5nZXRMaWZl\nY3ljbGVNZXRhRGF0YSgpLnNldElnbm9yZVN1cGVyY2xhc3NDYWxsYmFja3MK\nICAgICAgICAgICAgKExpZmVjeWNsZU1ldGFEYXRhLklHTk9SRV9ISUdIKTsK\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGVudGl0eS1saXN0ZW5lci4KICAgICAqLwogICAgcHJpdmF0ZSBib29s\nZWFuIHN0YXJ0RW50aXR5TGlzdGVuZXIoQXR0cmlidXRlcyBhdHRycykKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBfbGlzdGVuZXIg\nPSBjbGFzc0Zvck5hbWUoYXR0cnMuZ2V0VmFsdWUoImNsYXNzIikpOwogICAg\nICAgIGJvb2xlYW4gc3lzdGVtID0gY3VycmVudEVsZW1lbnQoKSA9PSBudWxs\nOwogICAgICAgIENvbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJhY2tzPltdIHBh\ncnNlZCA9CiAgICAgICAgICAgIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFE\nYXRhUGFyc2VyLnBhcnNlQ2FsbGJhY2tNZXRob2RzKF9saXN0ZW5lciwKICAg\nICAgICAgICAgICAgIG51bGwsIHRydWUsIHRydWUsIF9yZXBvcyk7CiAgICAg\nICAgaWYgKHBhcnNlZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKCiAgICAgICAgaWYgKF9jYWxsYmFja3MgPT0gbnVsbCkgewogICAgICAg\nICAgICBfY2FsbGJhY2tzID0gKENvbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJh\nY2tzPltdKQogICAgICAgICAgICAgICAgbmV3IENvbGxlY3Rpb25bTGlmZWN5\nY2xlRXZlbnQuQUxMX0VWRU5UUy5sZW5ndGhdOwogICAgICAgICAgICBpZiAo\nIXN5c3RlbSkKICAgICAgICAgICAgICAgIF9oaWdocyA9IG5ldyBpbnRbTGlm\nZWN5Y2xlRXZlbnQuQUxMX0VWRU5UUy5sZW5ndGhdOwogICAgICAgIH0KICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBhcnNlZC5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBpZiAocGFyc2VkW2ldID09IG51bGwpCiAgICAgICAg\nICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYgKF9jYWxsYmFja3Nb\naV0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jYWxsYmFja3NbaV0gPSBw\nYXJzZWRbaV07CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9j\nYWxsYmFja3NbaV0uYWRkQWxsKHBhcnNlZFtpXSk7CiAgICAgICAgICAgIGlm\nICghc3lzdGVtKQogICAgICAgICAgICAgICAgX2hpZ2hzW2ldICs9IHBhcnNl\nZFtpXS5zaXplKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIHByaXZhdGUgdm9pZCBlbmRFbnRpdHlMaXN0ZW5lcigpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc2hvdWxk\nIGJlIGluIGVuZEVudGl0eUxpc3RlbmVycyBJIHRoaW5rIHRvIG1lcmdlIGNh\nbGxiYWNrcwogICAgICAgIC8vIGludG8gYSBzaW5nbGUgbGlzdGVuZXIuICBC\ndXQgdGhlbiB0aGUgdXNlciBjYW5ub3QgcmVtb3ZlLgogICAgICAgIGlmIChj\ndXJyZW50RWxlbWVudCgpID09IG51bGwgJiYgX2NhbGxiYWNrcyAhPSBudWxs\nKSB7CiAgICAgICAgICAgIF9yZXBvcy5hZGRTeXN0ZW1MaXN0ZW5lcihuZXcg\nUGVyc2lzdGVuY2VMaXN0ZW5lckFkYXB0ZXIKICAgICAgICAgICAgICAgIChf\nY2FsbGJhY2tzKSk7CiAgICAgICAgICAgIF9jYWxsYmFja3MgPSBudWxsOwog\nICAgICAgIH0KICAgICAgICBfbGlzdGVuZXIgPSBudWxsOwogICAgfQoKICAg\nIHByaXZhdGUgYm9vbGVhbiBzdGFydENhbGxiYWNrKE1ldGFEYXRhVGFnIGNh\nbGxiYWNrLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGludFtdIGV2ZW50cyA9\nIE1ldGFEYXRhUGFyc2Vycy5nZXRFdmVudFR5cGVzKGNhbGxiYWNrKTsKICAg\nICAgICBpZiAoZXZlbnRzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKCiAgICAgICAgYm9vbGVhbiBzeXN0ZW0gPSBjdXJyZW50RWxlbWVu\ndCgpID09IG51bGw7CiAgICAgICAgQ2xhc3MgdHlwZSA9IGN1cnJlbnRFbGVt\nZW50KCkgPT0gbnVsbCA/IG51bGwgOgogICAgICAgICAgICAoKENsYXNzTWV0\nYURhdGEpIGN1cnJlbnRFbGVtZW50KCkpLmdldERlc2NyaWJlZFR5cGUoKTsK\nICAgICAgICBpZiAodHlwZSA9PSBudWxsKQogICAgICAgICAgICB0eXBlID0g\nT2JqZWN0LmNsYXNzOwoKICAgICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxs\nKSB7CiAgICAgICAgICAgIF9jYWxsYmFja3MgPSAoQ29sbGVjdGlvbjxMaWZl\nY3ljbGVDYWxsYmFja3M+W10pCiAgICAgICAgICAgICAgICBuZXcgQ29sbGVj\ndGlvbltMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAg\nICAgICAgIGlmICghc3lzdGVtKQogICAgICAgICAgICAgICAgX2hpZ2hzID0g\nbmV3IGludFtMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAg\nICAgICAgfQoKICAgICAgICBNZXRhRGF0YURlZmF1bHRzIGRlZiA9IF9yZXBv\ncy5nZXRNZXRhRGF0YUZhY3RvcnkoKS5nZXREZWZhdWx0cygpOwogICAgICAg\nIExpZmVjeWNsZUNhbGxiYWNrcyBhZGFwdGVyOwogICAgICAgIGlmIChfbGlz\ndGVuZXIgIT0gbnVsbCkKICAgICAgICAgICAgYWRhcHRlciA9IG5ldyBCZWFu\nTGlmZWN5Y2xlQ2FsbGJhY2tzKF9saXN0ZW5lciwKICAgICAgICAgICAgICAg\nIGF0dHJzLmdldFZhbHVlKCJtZXRob2QtbmFtZSIpLCBmYWxzZSwgdHlwZSk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBhZGFwdGVyID0gbmV3IE1ldGhv\nZExpZmVjeWNsZUNhbGxiYWNrcyhfY2xzLAogICAgICAgICAgICAgICAgYXR0\ncnMuZ2V0VmFsdWUoIm1ldGhvZC1uYW1lIiksIGZhbHNlKTsKCiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgaW50IGV2ZW50ID0gZXZlbnRzW2ldOwogICAgICAgICAgICBp\nZiAoX2xpc3RlbmVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIE1ldGFE\nYXRhUGFyc2Vycy52YWxpZGF0ZU1ldGhvZHNGb3JTYW1lQ2FsbGJhY2soX2xp\nc3RlbmVyLAogICAgICAgICAgICAgICAgICAgIF9jYWxsYmFja3NbZXZlbnRd\nLCAoKEJlYW5MaWZlY3ljbGVDYWxsYmFja3MpIGFkYXB0ZXIpLgogICAgICAg\nICAgICAgICAgICAgIGdldENhbGxiYWNrTWV0aG9kKCksIGNhbGxiYWNrLCBk\nZWYsIGdldExvZygpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgIE1ldGFEYXRhUGFyc2Vycy52YWxpZGF0ZU1ldGhvZHNGb3JTYW1l\nQ2FsbGJhY2soX2NscywKICAgICAgICAgICAgICAgICAgICBfY2FsbGJhY2tz\nW2V2ZW50XSwgKChNZXRob2RMaWZlY3ljbGVDYWxsYmFja3MpIGFkYXB0ZXIp\nLgogICAgICAgICAgICAgICAgICAgIGdldENhbGxiYWNrTWV0aG9kKCksIGNh\nbGxiYWNrLCBkZWYsIGdldExvZygpKTsKCiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgaWYgKF9jYWxsYmFja3NbZXZlbnRdID09IG51bGwpCiAgICAgICAg\nICAgICAgICBfY2FsbGJhY2tzW2V2ZW50XSA9IG5ldyBBcnJheUxpc3Q8TGlm\nZWN5Y2xlQ2FsbGJhY2tzPigzKTsKICAgICAgICAgICAgX2NhbGxiYWNrc1tl\ndmVudF0uYWRkKGFkYXB0ZXIpOwogICAgICAgICAgICBpZiAoIXN5c3RlbSAm\nJiBfbGlzdGVuZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9oaWdoc1tl\ndmVudF0rKzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTdG9yZSBsaWZlY3ljbGUgbWV0YWRhdGEuCiAg\nICAgKi8KICAgIHByaXZhdGUgdm9pZCBzdG9yZUNhbGxiYWNrcyhDbGFzc01l\ndGFEYXRhIGNscykgewogICAgICAgIExpZmVjeWNsZU1ldGFEYXRhIG1ldGEg\nPSBjbHMuZ2V0TGlmZWN5Y2xlTWV0YURhdGEoKTsKICAgICAgICBDbGFzcyBz\ndXBDbHMgPSBjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldFN1cGVyY2xhc3Mo\nKTsKICAgICAgICBDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBz\ndXBDYWxscyA9IG51bGw7CiAgICAgICAgaWYgKCFPYmplY3QuY2xhc3MuZXF1\nYWxzKHN1cENscykpIHsKICAgICAgICAgICAgc3VwQ2FsbHMgPSBBbm5vdGF0\naW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlci5wYXJzZUNhbGxiYWNrTWV0\naG9kcwogICAgICAgICAgICAgICAgKHN1cENscywgbnVsbCwgdHJ1ZSwgZmFs\nc2UsIF9yZXBvcyk7CiAgICAgICAgfQogICAgICAgIGlmIChzdXBDYWxscyAh\nPSBudWxsKSB7CiAgICAgICAgICAgIGZvciAoaW50IGV2ZW50IDogTGlmZWN5\nY2xlRXZlbnQuQUxMX0VWRU5UUykgewogICAgICAgICAgICAgICAgaWYgKHN1\ncENhbGxzW2V2ZW50XSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIGNv\nbnRpbnVlOwogICAgICAgICAgICAgICAgbWV0YS5zZXROb25QQ1N1cGVyY2xh\nc3NDYWxsYmFja3MoZXZlbnQsIHN1cENhbGxzW2V2ZW50XS50b0FycmF5CiAg\nICAgICAgICAgICAgICAgICAgKG5ldyBMaWZlY3ljbGVDYWxsYmFja3Nbc3Vw\nQ2FsbHNbZXZlbnRdLnNpemUoKV0pLCAwKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIGZvciAoaW50IGV2ZW50IDogTGlmZWN5\nY2xlRXZlbnQuQUxMX0VWRU5UUykgewogICAgICAgICAgICBpZiAoX2NhbGxi\nYWNrc1tldmVudF0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICBtZXRhLnNldERlY2xhcmVkQ2FsbGJhY2tzKGV2ZW50\nLCAoTGlmZWN5Y2xlQ2FsbGJhY2tzW10pCiAgICAgICAgICAgICAgICBfY2Fs\nbGJhY2tzW2V2ZW50XS50b0FycmF5CiAgICAgICAgICAgICAgICAgICAgKG5l\ndyBMaWZlY3ljbGVDYWxsYmFja3NbX2NhbGxiYWNrc1tldmVudF0uc2l6ZSgp\nXSksCiAgICAgICAgICAgICAgICBfaGlnaHNbZXZlbnRdKTsKICAgICAgICB9\nCiAgICAgICAgX2NhbGxiYWNrcyA9IG51bGw7CiAgICAgICAgX2hpZ2hzID0g\nbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEluc3RhbnRpYXRlIHRoZSBn\naXZlbiBjbGFzcywgdGFraW5nIGludG8gYWNjb3VudCB0aGUgZGVmYXVsdCBw\nYWNrYWdlLgoJICovCglwcm90ZWN0ZWQgQ2xhc3MgY2xhc3NGb3JOYW1lKFN0\ncmluZyBuYW1lKQoJCXRocm93cyBTQVhFeGNlcHRpb24gewoJCWlmICgiRW50\naXR5Ii5lcXVhbHMobmFtZSkpCgkJCXJldHVybiBQZXJzaXN0ZW5jZUNhcGFi\nbGUuY2xhc3M7CgkJcmV0dXJuIHN1cGVyLmNsYXNzRm9yTmFtZShuYW1lLCBp\nc1J1bnRpbWUoKSk7Cgl9Cn0K\n","encoding":"base64"}

