{"sha":"1e462decf4b8328841d671a26c2ffbd81eb1d4f8","node_id":"MDQ6QmxvYjIwNjM2NDoxZTQ2MmRlY2Y0YjgzMjg4NDFkNjcxYTI2YzJmZmJkODFlYjFkNGY4","size":7052,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1e462decf4b8328841d671a26c2ffbd81eb1d4f8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdDsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsK\naW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5QZXJzaXN0ZW5jZTsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVz\ndENhc2U7CmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdFJlc3VsdDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRC\nRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nQWJzdHJhY3RCcm9rZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5Ccm9rZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLkpQQUZhY2FkZUhlbHBlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZh\nY3RvcnlTUEk7CgovKioKICogQmFzZSB0ZXN0IGNsYXNzIHByb3ZpZGluZyBw\nZXJzaXN0ZW5jZSB1dGlsaXRpZXMuCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xh\nc3MgUGVyc2lzdGVuY2VUZXN0Q2FzZQogICAgZXh0ZW5kcyBUZXN0Q2FzZSB7\nCgogICAgLyoqCiAgICAgKiBNYXJrZXIgb2JqZWN0IHlvdSBhbiBwYXNzIHRv\nIHtAbGluayAjc2V0VXB9IHRvIGluZGljYXRlIHRoYXQgdGhlCiAgICAgKiBk\nYXRhYmFzZSB0YWJsZXMgc2hvdWxkIGJlIGNsZWFyZWQuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgT2JqZWN0IENMRUFSX1RBQkxFUyA9\nIG5ldyBPYmplY3QoKTsKCiAgICAvKioKICAgICAqIFRoZSB7QGxpbmsgVGVz\ndFJlc3VsdH0gaW5zdGFuY2UgZm9yIHRoZSBjdXJyZW50IHRlc3QgcnVuLgog\nICAgICovCiAgICBwcm90ZWN0ZWQgVGVzdFJlc3VsdCB0ZXN0UmVzdWx0OwoK\nICAgIC8qKgogICAgICogQ3JlYXRlIGFuIGVudGl0eSBtYW5hZ2VyIGZhY3Rv\ncnkuIFB1dCB7QGxpbmsgI0NMRUFSX1RBQkxFU30gaW4KICAgICAqIHRoaXMg\nbGlzdCB0byB0ZWxsIHRoZSB0ZXN0IGZyYW1ld29yayB0byBkZWxldGUgYWxs\nIHRhYmxlIGNvbnRlbnRzCiAgICAgKiBiZWZvcmUgcnVubmluZyB0aGUgdGVz\ndHMuCiAgICAgKgogICAgICogQHBhcmFtIHByb3BzIGxpc3Qgb2YgcGVyc2lz\ndGVudCB0eXBlcyB1c2VkIGluIHRlc3RpbmcgYW5kL29yIAogICAgICogY29u\nZmlndXJhdGlvbiB2YWx1ZXMgaW4gdGhlIGZvcm0ga2V5LHZhbHVlLGtleSx2\nYWx1ZS4uLgogICAgICovCiAgICBwcm90ZWN0ZWQgT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5U1BJIGNyZWF0ZUVNRihPYmplY3QuLi4gcHJvcHMpIHsK\nICAgICAgICBNYXAgbWFwID0gbmV3IEhhc2hNYXAoU3lzdGVtLmdldFByb3Bl\ncnRpZXMoKSk7CiAgICAgICAgTGlzdDxDbGFzcz4gdHlwZXMgPSBuZXcgQXJy\nYXlMaXN0PENsYXNzPigpOwogICAgICAgIGJvb2xlYW4gcHJvcCA9IGZhbHNl\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKHByb3ApIHsKICAgICAgICAgICAgICAg\nIG1hcC5wdXQocHJvcHNbaSAtIDFdLCBwcm9wc1tpXSk7CiAgICAgICAgICAg\nICAgICBwcm9wID0gZmFsc2U7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJv\ncHNbaV0gPT0gQ0xFQVJfVEFCTEVTKSB7CiAgICAgICAgICAgICAgICBtYXAu\ncHV0KCJvcGVuanBhLmpkYmMuU3luY2hyb25pemVNYXBwaW5ncyIsCiAgICAg\nICAgICAgICAgICAgICAgImJ1aWxkU2NoZW1hKEZvcmVpZ25LZXlzPXRydWUs\nIiAKICAgICAgICAgICAgICAgICAgICArICJTY2hlbWFBY3Rpb249J2FkZCxk\nZWxldGVUYWJsZUNvbnRlbnRzJykiKTsKICAgICAgICAgICAgfSBlbHNlIGlm\nIChwcm9wc1tpXSBpbnN0YW5jZW9mIENsYXNzKQogICAgICAgICAgICAgICAg\ndHlwZXMuYWRkKChDbGFzcykgcHJvcHNbaV0pOwogICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICBwcm9wID0gdHJ1ZTsKICAgICAgICB9CgogICAg\nICAgIGlmICghdHlwZXMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIFN0cmlu\nZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgICAg\nIGZvciAoQ2xhc3MgYyA6IHR5cGVzKSB7CiAgICAgICAgICAgICAgICBpZiAo\nYnVmLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCI7Iik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGMuZ2V0TmFt\nZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtYXAucHV0KCJvcGVu\nanBhLk1ldGFEYXRhRmFjdG9yeSIsCiAgICAgICAgICAgICAgICAianBhKFR5\ncGVzPSIgKyBidWYudG9TdHJpbmcoKSArICIpIik7CiAgICAgICAgfQoKICAg\nICAgICByZXR1cm4gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkg\nUGVyc2lzdGVuY2UuCiAgICAgICAgICAgIGNyZWF0ZUVudGl0eU1hbmFnZXJG\nYWN0b3J5KGdldFBlcnNpc3RlbmNlVW5pdE5hbWUoKSwgbWFwKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFBlcnNpc3RlbmNlVW5pdE5hbWUo\nKSB7CiAgICAgICAgcmV0dXJuICJ0ZXN0IjsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIHJ1bihUZXN0UmVzdWx0IHRlc3RSZXN1bHQp\nIHsKICAgICAgICB0aGlzLnRlc3RSZXN1bHQgPSB0ZXN0UmVzdWx0OwogICAg\nICAgIHN1cGVyLnJ1bih0ZXN0UmVzdWx0KTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3VwZXIudGVhckRvd24o\nKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAvLyBpZiBhIHRlc3QgZmFpbGVkLCBzd2FsbG93IGFueSBleGNlcHRpb25z\nIHRoYXQgaGFwcGVuCiAgICAgICAgICAgIC8vIGR1cmluZyB0ZWFyLWRvd24s\nIGFzIHRoZXNlIGp1c3QgbWFzayB0aGUgb3JpZ2luYWwgcHJvYmxlbS4KICAg\nICAgICAgICAgaWYgKHRlc3RSZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQogICAg\nICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTYWZlbHkgY2xvc2UgdGhlIGdpdmVuIGZhY3RvcnkuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGNsb3NlRU1GKEVudGl0eU1hbmFn\nZXJGYWN0b3J5IGVtZikgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmICghZW1mLmlzT3Bl\nbigpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRlciA9ICgoQWJzdHJhY3RCcm9rZXJGYWN0b3J5KSBKUEFG\nYWNhZGVIZWxwZXIKICAgICAgICAgICAgLnRvQnJva2VyRmFjdG9yeShlbWYp\nKS5nZXRPcGVuQnJva2VycygpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgIGl0\nZXIuaGFzTmV4dCgpOyApIHsKICAgICAgICAgICAgQnJva2VyIGIgPSAoQnJv\na2VyKSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgaWYgKGIgIT0gbnVsbCAm\nJiAhYi5pc0Nsb3NlZCgpKSB7CiAgICAgICAgICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gSlBBRmFjYWRlSGVscGVyLnRvRW50aXR5TWFuYWdlcihiKTsK\nICAgICAgICAgICAgICAgIGlmIChlbS5nZXRUcmFuc2FjdGlvbigpLmlzQWN0\naXZlKCkpCiAgICAgICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5yb2xsYmFjaygpOwogICAgICAgICAgICAgICAgZW0uY2xvc2UoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZW1mLmNsb3NlKCk7CiAg\nICAgICAgcmV0dXJuICFlbWYuaXNPcGVuKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBEZWxldGUgYWxsIGluc3RhbmNlcyBvZiB0aGUgZ2l2ZW4gdHlwZXMg\ndXNpbmcgYnVsayBkZWxldGUgcXVlcmllcy4KICAgICAqLwogICAgcHJvdGVj\ndGVkIHZvaWQgY2xlYXIoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mLCBDbGFz\ncy4uLiB0eXBlcykgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCB8fCB0eXBl\ncy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBM\naXN0PENsYXNzTWV0YURhdGE+IG1ldGFzID0gbmV3IEFycmF5TGlzdDxDbGFz\nc01ldGFEYXRhPih0eXBlcy5sZW5ndGgpOwogICAgICAgIGZvciAoQ2xhc3Mg\nYyA6IHR5cGVzKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIEpQQUZhY2FkZUhlbHBlci5nZXRNZXRhRGF0YShlbWYsIGMpOwogICAgICAg\nICAgICBpZiAobWV0YSAhPSBudWxsKQogICAgICAgICAgICAgICAgbWV0YXMu\nYWRkKG1ldGEpOwogICAgICAgIH0KICAgICAgICBjbGVhcihlbWYsIG1ldGFz\nLnRvQXJyYXkobmV3IENsYXNzTWV0YURhdGFbbWV0YXMuc2l6ZSgpXSkpOwog\nICAgfQoKICAgIC8qKgogICAgICogRGVsZXRlIGFsbCBpbnN0YW5jZXMgb2Yg\ndGhlIHBlcnNpc3RlbnQgdHlwZXMgcmVnaXN0ZXJlZCB3aXRoIHRoZSBnaXZl\nbgogICAgICogZmFjdG9yeSB1c2luZyBidWxrIGRlbGV0ZSBxdWVyaWVzLgog\nICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhcihFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeSBlbWYpIHsKICAgICAgICBpZiAoZW1mID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICBjbGVhcihlbWYsICgoT3BlbkpQQUVu\ndGl0eU1hbmFnZXJGYWN0b3J5U1BJKSBlbWYpLmdldENvbmZpZ3VyYXRpb24o\nKS4KICAgICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2Uo\nKS5nZXRNZXRhRGF0YXMoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxl\ndGUgYWxsIGluc3RhbmNlcyBvZiB0aGUgZ2l2ZW4gdHlwZXMgdXNpbmcgYnVs\nayBkZWxldGUgcXVlcmllcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNs\nZWFyKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiwgQ2xhc3NNZXRhRGF0YS4u\nLiB0eXBlcykgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCB8fCB0eXBlcy5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBFbnRp\ndHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZm9y\nIChDbGFzc01ldGFEYXRhIG1ldGEgOiB0eXBlcykgewogICAgICAgICAgICBp\nZiAoIW1ldGEuaXNNYXBwZWQoKSB8fCBtZXRhLmlzRW1iZWRkZWRPbmx5KCkg\nCiAgICAgICAgICAgICAgICB8fCBNb2RpZmllci5pc0Fic3RyYWN0KG1ldGEu\nZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE1vZGlmaWVycygpKSkKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBlbS5jcmVhdGVRdWVyeSgi\nREVMRVRFIEZST00gIiArIG1ldGEuZ2V0VHlwZUFsaWFzKCkgKyAiIG8iKS4K\nICAgICAgICAgICAgICAgIGV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICB9CiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBl\nbnRpdHkgbmFtZSBmb3IgdGhlIGdpdmVuIHR5cGUuICAgCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBTdHJpbmcgZW50aXR5TmFtZShFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBlbWYsIENsYXNzIGMpIHsKICAgICAgICBDbGFzc01ldGFEYXRhIG1l\ndGEgPSBKUEFGYWNhZGVIZWxwZXIuZ2V0TWV0YURhdGEoZW1mLCBjKTsKICAg\nICAgICByZXR1cm4gKG1ldGEgPT0gbnVsbCkgPyBudWxsIDogbWV0YS5nZXRU\neXBlQWxpYXMoKTsKICAgIH0KICAgIAogICAgcHJvdGVjdGVkIERCRGljdGlv\nbmFyeSBnZXREQkRpY3Rpb25hcnkoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0\nb3J5U1BJIGVtZikgewogICAgICAgIHJldHVybiAoKEpEQkNDb25maWd1cmF0\naW9uKSBlbWYuZ2V0Q29uZmlndXJhdGlvbigpKQogICAgICAgICAgICAuZ2V0\nREJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgIH0KfQo=\n","encoding":"base64"}

