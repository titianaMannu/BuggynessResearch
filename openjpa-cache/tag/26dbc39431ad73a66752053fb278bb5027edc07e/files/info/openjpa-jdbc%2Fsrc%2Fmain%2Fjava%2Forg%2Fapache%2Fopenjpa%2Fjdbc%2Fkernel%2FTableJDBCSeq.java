{"sha":"7532cdf23650202baf12060c42e57fc07803d954","node_id":"MDQ6QmxvYjIwNjM2NDo3NTMyY2RmMjM2NTAyMDJiYWYxMjA2MGM0MmU1N2ZjMDc4MDNkOTU0","size":32042,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7532cdf23650202baf12060c42e57fc07803d954","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxF\neGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoTWFwOwoKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLk5vdFN1\ncHBvcnRlZEV4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMu\nbGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uSW1wbDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5n\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVt\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Qcmlt\nYXJ5S2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlNjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNjaGVtYS5TY2hlbWFUb29sOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlNjaGVtYXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbC5Sb3dJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIuY29uZi5Db25maWd1cmFibGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247Cgpp\nbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CmltcG9ydCBzZXJwLnV0aWwuU3Ry\naW5nczsKCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBOT1RFOiBEbyBub3QgY2hhbmdl\nIHByb3BlcnR5IG5hbWVzOyBzZWUgU2VxdWVuY2VNZXRhRGF0YQovLyBhbmQg\nU2VxdWVuY2VNYXBwaW5nIGZvciBzdGFuZGFyZCBwcm9wZXJ0eSBuYW1lcy4K\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCgovKioKICoge0BsaW5rIEpEQkNTZXF9IGltcGxl\nbWVudGF0aW9uIHRoYXQgdXNlcyBhIGRhdGFiYXNlIHRhYmxlCiAqIGZvciBz\nZXF1ZW5jZSBudW1iZXIgZ2VuZXJhdGlvbi4gVGhpcyBiYXNlIGltcGxlbWVu\ndGF0aW9uIHVzZXMgYSBzaW5nbGUKICogcm93IGZvciBhIGdsb2JhbCBzZXF1\nZW5jZSBudW1iZXIuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJs\naWMgY2xhc3MgVGFibGVKREJDU2VxCiAgICBleHRlbmRzIEFic3RyYWN0SkRC\nQ1NlcQogICAgaW1wbGVtZW50cyBDb25maWd1cmFibGUgewoKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9EUk9QID0gImRyb3AiOwog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJh\nZGQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0dF\nVCA9ICJnZXQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNU\nSU9OX1NFVCA9ICJzZXQiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExv\nY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAo\nVGFibGVKREJDU2VxLmNsYXNzKTsKCiAgICBwcml2YXRlIHRyYW5zaWVudCBK\nREJDQ29uZmlndXJhdGlvbiBfY29uZiA9IG51bGw7CiAgICBwcml2YXRlIHRy\nYW5zaWVudCBMb2cgX2xvZyA9IG51bGw7CiAgICBwcml2YXRlIGludCBfYWxs\nb2MgPSA1MDsKICAgIHByaXZhdGUgaW50IF9pbnRWYWx1ZSA9IDE7CiAgICBw\ncml2YXRlIGZpbmFsIEhhc2hNYXA8Q2xhc3NNYXBwaW5nLCBTdGF0dXM+IF9z\ndGF0ID0KICAgICAgICBuZXcgSGFzaE1hcDxDbGFzc01hcHBpbmcsIFN0YXR1\ncz4oKTsKCiAgICBwcml2YXRlIFN0cmluZyBfdGFibGUgPSAiT1BFTkpQQV9T\nRVFVRU5DRV9UQUJMRSI7CiAgICBwcml2YXRlIFN0cmluZyBfc2VxQ29sdW1u\nTmFtZSA9ICJTRVFVRU5DRV9WQUxVRSI7CiAgICBwcml2YXRlIFN0cmluZyBf\ncGtDb2x1bW5OYW1lID0gIklEIjsKICAgIHByaXZhdGUgU3RyaW5nW10gX3Vu\naXF1ZUNvbHVtbk5hbWVzOwoKICAgIHByaXZhdGUgQ29sdW1uIF9zZXFDb2x1\nbW4gPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW4gX3BrQ29sdW1uID0gbnVs\nbDsKICAgIAogICAgLyoqCiAgICAgKiBUaGUgc2VxdWVuY2UgdGFibGUgbmFt\nZS4gRGVmYXVsdHMgdG8gPGNvZGU+T1BFTkpQQV9TRVFVRU5DRV9UQUJMRTwv\nY29kZT4uCiAgICAgKiBCeSBkZWZhdWx0LCB0aGUgdGFibGUgd2lsbCBiZSBw\nbGFjZWQgaW4gdGhlIGZpcnN0IHNjaGVtYSBsaXN0ZWQgaW4geW91cgogICAg\nICogPGNvZGU+b3BlbmpwYS5qZGJjLlNjaGVtYXM8L2NvZGU+IHByb3BlcnR5\nLCBvciBpbiB0aGUgZGVmYXVsdCBzY2hlbWEgaWYKICAgICAqIHRoZSBwcm9w\nZXJ0eSBpcyBub3QgZ2l2ZW4uIElmIHlvdSBzcGVjaWZ5IGEgdGFibGUgbmFt\nZSBpbiB0aGUgZm9ybQogICAgICogPGNvZGU+Jmx0O3NjaGVtYSZndDsuJmx0\nO3RhYmxlJmd0OzwvY29kZT4sIHRoZW4gdGhlIGdpdmVuIHNjaGVtYQogICAg\nICogd2lsbCBiZSB1c2VkLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFRhYmxlKCkgewogICAgICAgIHJldHVybiBfdGFibGU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgc2VxdWVuY2UgdGFibGUgbmFtZS4gRGVmYXVsdHMg\ndG8gPGNvZGU+T1BFTkpQQV9TRVFVRU5DRV9UQUJMRTwvY29kZT4uCiAgICAg\nKiBCeSBkZWZhdWx0LCB0aGUgdGFibGUgd2lsbCBiZSBwbGFjZWQgaW4gdGhl\nIGZpcnN0IHNjaGVtYSBsaXN0ZWQgaW4geW91cgogICAgICogPGNvZGU+b3Bl\nbmpwYS5qZGJjLlNjaGVtYXM8L2NvZGU+IHByb3BlcnR5LCBvciBpbiB0aGUg\nZGVmYXVsdCBzY2hlbWEgaWYKICAgICAqIHRoZSBwcm9wZXJ0eSBpcyBub3Qg\nZ2l2ZW4uIElmIHlvdSBzcGVjaWZ5IGEgdGFibGUgbmFtZSBpbiB0aGUgZm9y\nbQogICAgICogPGNvZGU+Jmx0O3NjaGVtYSZndDsuJmx0O3RhYmxlJmd0Ozwv\nY29kZT4sIHRoZW4gdGhlIGdpdmVuIHNjaGVtYQogICAgICogd2lsbCBiZSB1\nc2VkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZShTdHJpbmcg\nbmFtZSkgewogICAgICAgIF90YWJsZSA9IG5hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBAZGVwcmVjYXRlZCBVc2Uge0BsaW5rICNzZXRUYWJsZX0uIFJl\ndGFpbmVkIGZvcgogICAgICogYmFja3dhcmRzLWNvbXBhdGliaWxpdHkJd2l0\naCBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFRhYmxlTmFtZShTdHJpbmcgbmFtZSkgewogICAgICAgIHNldFRhYmxl\nKG5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhl\nIGNvbHVtbiB0aGF0IGhvbGRzIHRoZSBzZXF1ZW5jZSB2YWx1ZS4gRGVmYXVs\ndHMKICAgICAqIHRvIDxjb2RlPlNFUVVFTkNFX1ZBTFVFPC9jb2RlPi4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTZXF1ZW5jZUNvbHVtbigpIHsK\nICAgICAgICByZXR1cm4gX3NlcUNvbHVtbk5hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgY29sdW1uIHRoYXQgaG9sZHMgdGhl\nIHNlcXVlbmNlIHZhbHVlLiBEZWZhdWx0cwogICAgICogdG8gPGNvZGU+U0VR\nVUVOQ0VfVkFMVUU8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRTZXF1ZW5jZUNvbHVtbihTdHJpbmcgc2VxdWVuY2VDb2x1bW4pIHsKICAg\nICAgICBfc2VxQ29sdW1uTmFtZSA9IHNlcXVlbmNlQ29sdW1uOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhlIHRhYmxlJ3MgcHJpbWFy\neSBrZXkgY29sdW1uLiBEZWZhdWx0cyB0bwogICAgICogPGNvZGU+SUQ8L2Nv\nZGU+LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFByaW1hcnlLZXlD\nb2x1bW4oKSB7CiAgICAgICAgcmV0dXJuIF9wa0NvbHVtbk5hbWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgdGFibGUncyBwcmlt\nYXJ5IGtleSBjb2x1bW4uIERlZmF1bHRzIHRvCiAgICAgKiA8Y29kZT5JRDwv\nY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXlD\nb2x1bW4oU3RyaW5nIHByaW1hcnlLZXlDb2x1bW4pIHsKICAgICAgICBfcGtD\nb2x1bW5OYW1lID0gcHJpbWFyeUtleUNvbHVtbjsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHNlcXVlbmNlcyB0byBhbGxv\nY2F0ZSBmb3IgZWFjaCB1cGRhdGUgb2YgdGhlCiAgICAgKiBzZXF1ZW5jZSB0\nYWJsZS4gU2VxdWVuY2UgbnVtYmVycyB3aWxsIGJlIGdyYWJiZWQgaW4gYmxv\nY2tzIG9mIHRoaXMKICAgICAqIHZhbHVlIHRvIHJlZHVjZSB0aGUgbnVtYmVy\nIG9mIHRyYW5zYWN0aW9ucyB0aGF0IG11c3QgYmUgcGVyZm9ybWVkIG9uCiAg\nICAgKiB0aGUgc2VxdWVuY2UgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBp\nbnQgZ2V0QWxsb2NhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9hbGxvYzsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHNlcXVl\nbmNlcyB0byBhbGxvY2F0ZSBmb3IgZWFjaCB1cGRhdGUgb2YgdGhlCiAgICAg\nKiBzZXF1ZW5jZSB0YWJsZS4gU2VxdWVuY2UgbnVtYmVycyB3aWxsIGJlIGdy\nYWJiZWQgaW4gYmxvY2tzIG9mIHRoaXMKICAgICAqIHZhbHVlIHRvIHJlZHVj\nZSB0aGUgbnVtYmVyIG9mIHRyYW5zYWN0aW9ucyB0aGF0IG11c3QgYmUgcGVy\nZm9ybWVkIG9uCiAgICAgKiB0aGUgc2VxdWVuY2UgdGFibGUuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldEFsbG9jYXRlKGludCBhbGxvYykgewogICAg\nICAgIF9hbGxvYyA9IGFsbG9jOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgbnVtYmVyIGFzIHRoZSBpbml0aWFsIG51bWJlciBmb3Ig\ndGhlIAogICAgICogR2VuZXJhdGVkVmFsdWUuVEFCTEUgc3RyYXRlZ3kgdG8g\nc3RhcnQgd2l0aC4gCiAgICAgKiBAcmV0dXJuIGFuIGluaXRpYWwgbnVtYmVy\nCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW5pdGlhbFZhbHVlKCkgeyAg\nICAgICAgCiAgICAgICAgcmV0dXJuIF9pbnRWYWx1ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgaW5pdGlhbCBudW1iZXIgaW4gdGhlIHRhYmxl\nIGZvciB0aGUgR2VuZXJhdGVkVmFsdWUuVEFCTEUKICAgICAqIHN0cmF0ZWd5\nIHRvIHVzZSBhcyBpbml0aWFsIG51bWJlci4gCiAgICAgKiBAcGFyYW0gaW50\nVmFsdWUuIFRoZSBpbml0aWFsIG51bWJlcgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRJbml0aWFsVmFsdWUoaW50IGludFZhbHVlKSB7CiAgICAgICAg\nX2ludFZhbHVlID0gaW50VmFsdWU7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogU2V0cyB0aGUgbmFtZXMgb2YgdGhlIGNvbHVtbnMgb24gd2hpY2ggYSB1\nbmlxdWUgY29uc3RyYWludCBpcyBzZXQuCiAgICAgKiBAcGFyYW0gY29sdW1u\nc05hbWVzIGFyZSBwYXNzZWQgYXMgYSBzaW5nbGUgU3RyaW5nIGNvbmNhdGVu\nYXRlZCB3aXRoCiAgICAgKiBhICd8JyBjaGFyYWN0ZXIuIFRoaXMgbWV0aG9k\nIHBhcnNlcyBpdCBiYWNrIHRvIGFycmF5IG9mIFN0cmluZ3MuIAogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRVbmlxdWVDb2x1bW5zKFN0cmluZyBjb2x1\nbW5OYW1lcykgewogICAgCV91bmlxdWVDb2x1bW5OYW1lcyA9IChTdHJpbmdV\ndGlscy5pc0VtcHR5KGNvbHVtbk5hbWVzKSkgCiAgICAJCT8gbnVsbCA6IFN0\ncmluZ1V0aWxzLnNwbGl0KGNvbHVtbk5hbWVzLCAnfCcpOwogICAgfQogICAg\nCiAgICBwdWJsaWMgU3RyaW5nIGdldFVuaXF1ZUNvbHVtbnMoKSB7CiAgICAJ\ncmV0dXJuIFN0cmluZ1V0aWxzLmpvaW4oX3VuaXF1ZUNvbHVtbk5hbWVzLCAn\nfCcpOwogICAgfQoKICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtA\nbGluayAjc2V0QWxsb2NhdGV9LiBSZXRhaW5lZCBmb3IgYmFja3dhcmRzCiAg\nICAgKiBjb21wYXRpYmlsaXR5IG9mIGF1dG8tY29uZmlndXJhdGlvbi4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0SW5jcmVtZW50KGludCBpbmMpIHsK\nICAgICAgICBzZXRBbGxvY2F0ZShpbmMpOwogICAgfQoKICAgIHB1YmxpYyBK\nREJDQ29uZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAg\nIHJldHVybiBfY29uZjsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb25m\naWd1cmF0aW9uKENvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9jb25m\nID0gKEpEQkNDb25maWd1cmF0aW9uKSBjb25mOwogICAgICAgIF9sb2cgPSBf\nY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkgewog\nICAgICAgIGJ1aWxkVGFibGUoKTsKICAgIH0KICAgIAoKICAgIHB1YmxpYyB2\nb2lkIGFkZFNjaGVtYShDbGFzc01hcHBpbmcgbWFwcGluZywgU2NoZW1hR3Jv\ndXAgZ3JvdXApIHsKICAgICAgICAvLyBTaW5jZSB0aGUgdGFibGUgaXMgY3Jl\nYXRlZCBieSBvcGVuanBhIGludGVybmFsbHkKICAgICAgICAvLyB3ZSBjYW4g\nY3JlYXRlIHRoZSB0YWJsZSBmb3IgZWFjaCBzY2hlbWEgd2l0aGluIHRoZSBQ\nVQogICAgICAgIC8vIGluIGhlcmUuCiAgICAgICAgCiAgICAgICAgU2NoZW1h\nW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVtYXMoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgU3RyaW5nIHNjaGVtYU5hbWUgPSBTdHJpbmdzLmdldFBhY2thZ2VO\nYW1lKF90YWJsZSk7CiAgICAgICAgICAgIGlmIChzY2hlbWFOYW1lLmxlbmd0\naCgpID09IDApCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1lID0gU2NoZW1h\ncy5nZXROZXdUYWJsZVNjaGVtYShfY29uZik7CiAgICAgICAgICAgIGlmIChz\nY2hlbWFOYW1lID09IG51bGwpCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1l\nID0gc2NoZW1hc1tpXS5nZXROYW1lKCk7CgogICAgICAgICAgICAvLyBjcmVh\ndGUgdGFibGUgaW4gdGhpcyBncm91cAogICAgICAgICAgICBTY2hlbWEgc2No\nZW1hID0gZ3JvdXAuZ2V0U2NoZW1hKHNjaGVtYU5hbWUpOwogICAgICAgICAg\nICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAgICAgICBzY2hlbWEg\nPSBncm91cC5hZGRTY2hlbWEoc2NoZW1hTmFtZSk7CiAgICAgICAgICAgIAog\nICAgICAgICAgICBUYWJsZSBjb3B5ID0gc2NoZW1hLmltcG9ydFRhYmxlKF9w\na0NvbHVtbi5nZXRUYWJsZSgpKTsKICAgICAgICAgICAgLy8gaW1wb3J0VGFi\nbGUoKSBkb2VzIG5vdCBpbXBvcnQgdW5pcXVlIGNvbnN0cmFpbnRzCiAgICAg\nICAgICAgIFVuaXF1ZVtdIHVuaXF1ZXMgPSBfcGtDb2x1bW4uZ2V0VGFibGUo\nKS5nZXRVbmlxdWVzKCk7CiAgICAgICAgICAgIGZvciAoVW5pcXVlIHUgOiB1\nbmlxdWVzKSB7CiAgICAgICAgICAgIAljb3B5LmltcG9ydFVuaXF1ZSh1KTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHJlc2V0\nIHRoZSB0YWJsZSBuYW1lIGluIHRoZSBjb2x1bW4gd2l0aCB0aGUKICAgICAg\nICAgICAgLy8gZnVsbHkgcXVhbGlmaWVkIG5hbWUgZm9yIG1hdGNoaW5nIHRo\nZSB0YWJsZSBuYW1lIGZyb20gdGhlCiAgICAgICAgICAgIC8vIENvbHVtbi4K\nICAgICAgICAgICAgX3BrQ29sdW1uLnJlc2V0VGFibGVOYW1lKHNjaGVtYU5h\nbWUgKyAiLiIKICAgICAgICAgICAgICAgICAgICArIF9wa0NvbHVtbi5nZXRU\nYWJsZU5hbWUoKSk7CiAgICAgICAgICAgIC8vIHNvbWUgZGF0YWJhc2VzIHJl\ncXVpcmUgdG8gY3JlYXRlIGFuIGluZGV4IGZvciB0aGUgc2VxdWVuY2UgdGFi\nbGUKICAgICAgICAgICAgX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKS5jcmVhdGVJbmRleElmTmVjZXNzYXJ5KHNjaGVtYSwKICAgICAgICAgICAg\nICAgICAgICBfdGFibGUsIF9wa0NvbHVtbik7CiAgICAgICAgfQogICAgfQoK\nICAgIHByb3RlY3RlZCBPYmplY3QgbmV4dEludGVybmFsKEpEQkNTdG9yZSBz\ndG9yZSwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcpCiAgICAgICAgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gaWYgbmVlZGVkLCBncmFiIHRoZSBuZXh0\nIGhhbmRmdWwgb2YgaWRzCiAgICAgICAgU3RhdHVzIHN0YXQgPSBnZXRTdGF0\ndXMobWFwcGluZyk7CiAgICAgICAgaWYgKHN0YXQgPT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdl\ndCgiYmFkLXNlcS10eXBlIiwKICAgICAgICAgICAgICAgIGdldENsYXNzKCks\nIG1hcHBpbmcpKTsKCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAg\nICAgc3luY2hyb25pemVkIChzdGF0KSB7CiAgICAgICAgICAgICAgICAvLyBt\nYWtlIHN1cmUgc2VxIGlzIGF0IGxlYXN0IDEsIHNpbmNlIGF1dG9hc3NpZ25l\nZCBpZHMgb2YgMCBjYW4KICAgICAgICAgICAgICAgIC8vIGNvbmZsaWN0IHdp\ndGggdW5pbml0aWFsaXplZCB2YWx1ZXMKICAgICAgICAgICAgICAgIHN0YXQu\nc2VxID0gTWF0aC5tYXgoc3RhdC5zZXEsIDEpOwogICAgICAgICAgICAgICAg\naWYgKHN0YXQuc2VxIDwgc3RhdC5tYXgpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIE51bWJlcnMudmFsdWVPZihzdGF0LnNlcSsrKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBhbGxvY2F0ZVNlcXVlbmNlKHN0b3JlLCBtYXBw\naW5nLCBzdGF0LCBfYWxsb2MsIHRydWUpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwcm90ZWN0ZWQgT2JqZWN0IGN1cnJlbnRJbnRlcm5hbChKREJDU3RvcmUg\nc3RvcmUsIENsYXNzTWFwcGluZyBtYXBwaW5nKQogICAgICAgIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGlmIChjdXJyZW50ID09IG51bGwpIHsKICAg\nICAgICAgICAgQ3VycmVudFNlcXVlbmNlUnVubmFibGUgcnVubmFibGUgPQog\nICAgICAgICAgICAgICAgbmV3IEN1cnJlbnRTZXF1ZW5jZVJ1bm5hYmxlKHN0\nb3JlLCBtYXBwaW5nKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIGlmIChzdXNwZW5kSW5KVEEoKSkgewogICAgICAgICAgICAgICAgICAg\nIC8vIE5vdFN1cHBvcnRlZEV4Y2VwdGlvbiBpcyB3cmFwcGVkIGluIGEgU3Rv\ncmVFeGNlcHRpb24gYnkKICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY2Fs\nbGVyLgogICAgICAgICAgICAgICAgICAgIF9jb25mLmdldE1hbmFnZWRSdW50\naW1lSW5zdGFuY2UoKS5kb05vblRyYW5zYWN0aW9uYWxXb3JrKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgcnVubmFibGUpOwogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBydW5uYWJsZS5ydW4o\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoUnVu\ndGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICAgICAgdGhyb3cgKEV4\nY2VwdGlvbikgKHJlLmdldENhdXNlKCkgPT0gbnVsbCA/IHJlIDogcmUuZ2V0\nQ2F1c2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIHN1cGVyLmN1cnJlbnRJbnRlcm5hbChzdG9yZSwgbWFwcGluZyk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYWxsb2NhdGVJbnRlcm5hbChpbnQg\nY291bnQsIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBDbGFzc01hcHBpbmcg\nbWFwcGluZykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBTdGF0dXMgc3RhdCA9IGdldFN0YXR1cyhtYXBwaW5nKTsKICAgICAgICBp\nZiAoc3RhdCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGludCBhdmFpbGFibGU7CiAg\nICAgICAgICAgIHN5bmNocm9uaXplZCAoc3RhdCkgewogICAgICAgICAgICAg\nICAgYXZhaWxhYmxlID0gKGludCkgKHN0YXQubWF4IC0gc3RhdC5zZXEpOwog\nICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZSA+PSBjb3VudCkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgYWxsb2NhdGVTZXF1ZW5jZShzdG9yZSwgbWFwcGluZywgc3RhdCwgY291\nbnQgLSBhdmFpbGFibGUsIGZhbHNlKTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGFwcHJvcHJpYXRlIHN0YXR1cyBvYmpl\nY3QgZm9yIHRoZSBnaXZlbiBjbGFzcywgb3IgbnVsbAogICAgICogaWYgY2Fu\nbm90IGhhbmRsZSB0aGUgZ2l2ZW4gY2xhc3MuIFRoZSBtYXBwaW5nIG1heSBi\nZSBudWxsLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RhdHVzIGdldFN0YXR1\ncyhDbGFzc01hcHBpbmcgbWFwcGluZykgeyAgCiAgICAgICAgU3RhdHVzIHN0\nYXR1cyA9IChTdGF0dXMpX3N0YXQuZ2V0KG1hcHBpbmcpOyAgICAgICAgCiAg\nICAgICAgaWYgKHN0YXR1cyA9PSBudWxsKXsgCiAgICAgICAgICAgIHN0YXR1\ncyA9IG5ldyBTdGF0dXMoKTsKICAgICAgICAgICAgX3N0YXQucHV0KG1hcHBp\nbmcsIHN0YXR1cyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdGF0dXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIHByaW1hcnkga2V5IGNv\nbHVtbiB0byB0aGUgZ2l2ZW4gdGFibGUgYW5kIHJldHVybiBpdC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIENvbHVtbiBhZGRQcmltYXJ5S2V5Q29sdW1uKFRh\nYmxlIHRhYmxlKSB7CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29u\nZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIENvbHVtbiBw\na0NvbHVtbiA9IHRhYmxlLmFkZENvbHVtbihkaWN0LmdldFZhbGlkQ29sdW1u\nTmFtZQogICAgICAgICAgICAoZ2V0UHJpbWFyeUtleUNvbHVtbigpLCB0YWJs\nZSkpOwogICAgICAgIHBrQ29sdW1uLnNldFR5cGUoZGljdC5nZXRQcmVmZXJy\nZWRUeXBlKFR5cGVzLlRJTllJTlQpKTsKICAgICAgICBwa0NvbHVtbi5zZXRK\nYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICByZXR1cm4gcGtDb2x1\nbW47CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHByaW1hcnkg\na2V5IHZhbHVlIGZvciB0aGUgc2VxdWVuY2UgdGFibGUgZm9yIHRoZSBnaXZl\nbiBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRQcmlt\nYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgcmV0dXJu\nIE51bWJlcnMudmFsdWVPZigwKTsKICAgIH0KCiAgICAvKioKICAgICAqIENy\nZWF0ZXMgdGhlIG9iamVjdC1sZXZlbCByZXByZXNlbnRhdGlvbiBvZiB0aGUg\nc2VxdWVuY2UgdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWls\nZFRhYmxlKCkgewogICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSBTdHJpbmdz\nLmdldENsYXNzTmFtZShfdGFibGUpOwogICAgICAgIFN0cmluZyBzY2hlbWFO\nYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfdGFibGUpOwogICAgICAg\nIGlmIChzY2hlbWFOYW1lLmxlbmd0aCgpID09IDApCiAgICAgICAgICAgIHNj\naGVtYU5hbWUgPSBTY2hlbWFzLmdldE5ld1RhYmxlU2NoZW1hKF9jb25mKTsK\nCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBuZXcgU2NoZW1hR3JvdXAo\nKTsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ3JvdXAuYWRkU2NoZW1hKHNj\naGVtYU5hbWUpOwoKICAgICAgICBUYWJsZSB0YWJsZSA9IHNjaGVtYS5hZGRU\nYWJsZSh0YWJsZU5hbWUpOwogICAgICAgIF9wa0NvbHVtbiA9IGFkZFByaW1h\ncnlLZXlDb2x1bW4odGFibGUpOwogICAgICAgIFByaW1hcnlLZXkgcGsgPSB0\nYWJsZS5hZGRQcmltYXJ5S2V5KCk7CiAgICAgICAgcGsuYWRkQ29sdW1uKF9w\na0NvbHVtbik7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYu\nZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBfc2VxQ29sdW1u\nID0gdGFibGUuYWRkQ29sdW1uKGRpY3QuZ2V0VmFsaWRDb2x1bW5OYW1lCiAg\nICAgICAgICAgIChfc2VxQ29sdW1uTmFtZSwgdGFibGUpKTsKICAgICAgICBf\nc2VxQ29sdW1uLnNldFR5cGUoZGljdC5nZXRQcmVmZXJyZWRUeXBlKFR5cGVz\nLkJJR0lOVCkpOwogICAgICAgIF9zZXFDb2x1bW4uc2V0SmF2YVR5cGUoSmF2\nYVR5cGVzLkxPTkcpOwogICAgICAgIAogICAgICAgIGlmIChfdW5pcXVlQ29s\ndW1uTmFtZXMgIT0gbnVsbCkgewogICAgCQlTdHJpbmcgdW5pcXVlTmFtZSA9\nIGRpY3QuZ2V0VmFsaWRVbmlxdWVOYW1lKCJVTlEiLCB0YWJsZSk7CiAgICAJ\nCVVuaXF1ZSB1ID0gdGFibGUuYWRkVW5pcXVlKHVuaXF1ZU5hbWUpOwogICAg\nCQlmb3IgKFN0cmluZyBjb2x1bW5OYW1lIDogX3VuaXF1ZUNvbHVtbk5hbWVz\nKSB7CiAgICAJCQlpZiAoIXRhYmxlLmNvbnRhaW5zQ29sdW1uKGNvbHVtbk5h\nbWUpKQogICAgCQkJCXRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJ1bmlxdWUtbWlzc2luZy1jb2x1bW4iLAogICAgCQkJCQljb2x1bW5OYW1l\nLCB0YWJsZS5nZXROYW1lKCksIHRhYmxlLmdldENvbHVtbk5hbWVzKCkpKTsK\nICAgIAkJCUNvbHVtbiBjb2wgPSB0YWJsZS5nZXRDb2x1bW4oY29sdW1uTmFt\nZSk7CiAgICAJCQl1LmFkZENvbHVtbihjb2wpOwogICAgCQl9CiAgICAgICAg\nfQogICAgICAgIAogICAgfQoKICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUg\nbWF4IGF2YWlsYWJsZSBzZXF1ZW5jZSB2YWx1ZS4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIGFsbG9jYXRlU2VxdWVuY2UoSkRCQ1N0b3JlIHN0b3JlLCBD\nbGFzc01hcHBpbmcgbWFwcGluZywKICAgICAgICAgICAgU3RhdHVzIHN0YXQs\nIGludCBhbGxvYywgYm9vbGVhbiB1cGRhdGVTdGF0U2VxKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBSdW5uYWJsZSBydW5uYWJsZSA9CiAgICAg\nICAgICAgIG5ldyBBbGxvY2F0ZVNlcXVlbmNlUnVubmFibGUoCiAgICAgICAg\nICAgICAgICAgICAgc3RvcmUsIG1hcHBpbmcsIHN0YXQsIGFsbG9jLCB1cGRh\ndGVTdGF0U2VxKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoc3Vz\ncGVuZEluSlRBKCkpIHsKICAgICAgICAgICAgICAgIC8vIE5vdFN1cHBvcnRl\nZEV4Y2VwdGlvbiBpcyB3cmFwcGVkIGluIGEgU3RvcmVFeGNlcHRpb24gYnkK\nICAgICAgICAgICAgICAgIC8vIHRoZSBjYWxsZXIuCiAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgX2NvbmYuZ2V0TWFuYWdlZFJ1bnRp\nbWVJbnN0YW5jZSgpLmRvTm9uVHJhbnNhY3Rpb25hbFdvcmsoCiAgICAgICAg\nICAgICAgICAgICAgICAgIHJ1bm5hYmxlKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIGNhdGNoKE5vdFN1cHBvcnRlZEV4Y2VwdGlvbiBu\nc2UpIHsgCiAgICAgICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIHNxbEV4\nID0gbmV3IFNRTEV4Y2VwdGlvbihuc2UuZ2V0TG9jYWxpemVkTWVzc2FnZSgp\nKTsKICAgICAgICAgICAgICAgICAgICBzcWxFeC5pbml0Q2F1c2UobnNlKTsK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBzcWxFeDsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJ1\nbm5hYmxlLnJ1bigpOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAo\nUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICBUaHJvd2FibGUg\nZSA9IHJlLmdldENhdXNlKCk7CiAgICAgICAgICAgIGlmKGUgaW5zdGFuY2Vv\nZiBTUUxFeGNlcHRpb24gKSAKICAgICAgICAgICAgICAgIHRocm93IChTUUxF\neGNlcHRpb24pIGU7CiAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAg\nICB0aHJvdyByZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbnNlcnRzIHRoZSBpbml0aWFsIHNlcXVlbmNlIGNvbHVtbiBpbnRvIHRoZSBk\nYXRhYmFzZS4KICAgICAqIAogICAgICogQHBhcmFtIG1hcHBpbmcKICAgICAq\nICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGZvciB0aGUgY2xhc3Mgd2hvc2Ug\nc2VxdWVuY2UgY29sdW1uIHdpbGwgYmUKICAgICAqICAgICAgICAgICAgdXBk\nYXRlZAogICAgICogQHBhcmFtIGNvbm4KICAgICAqICAgICAgICAgICAgQ29u\nbmVjdGlvbiB1c2VkIGlzc3VlIFNRTCBzdGF0ZW1lbnRzLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgaW5zZXJ0U2VxdWVuY2UoQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcsIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQog\nICAgICAgICAgICBfbG9nLnRyYWNlKF9sb2MuZ2V0KCJpbnNlcnQtc2VxIikp\nOwoKICAgICAgICBPYmplY3QgcGsgPSBnZXRQcmltYXJ5S2V5KG1hcHBpbmcp\nOwogICAgICAgIGlmIChwayA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc2VxLXR5\ncGUiLAogICAgICAgICAgICAgICAgZ2V0Q2xhc3MoKSwgbWFwcGluZykpOwoK\nICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlv\nbmFyeUluc3RhbmNlKCk7CiAgICAgICAgU3RyaW5nIHRhYmxlTmFtZSA9IHJl\nc29sdmVUYWJsZU5hbWUobWFwcGluZywgX3BrQ29sdW1uLmdldFRhYmxlKCkp\nOwogICAgICAgIFNRTEJ1ZmZlciBpbnNlcnQgPSBuZXcgU1FMQnVmZmVyKGRp\nY3QpLmFwcGVuZCgiSU5TRVJUIElOVE8gIikuCiAgICAgICAgICAgIGFwcGVu\nZCh0YWJsZU5hbWUpLmFwcGVuZCgiICgiKS4KICAgICAgICAgICAgYXBwZW5k\nKF9wa0NvbHVtbikuYXBwZW5kKCIsICIpLmFwcGVuZChfc2VxQ29sdW1uKS4K\nICAgICAgICAgICAgYXBwZW5kKCIpIFZBTFVFUyAoIikuCiAgICAgICAgICAg\nIGFwcGVuZFZhbHVlKHBrLCBfcGtDb2x1bW4pLmFwcGVuZCgiLCAiKS4KICAg\nICAgICAgICAgYXBwZW5kVmFsdWUoX2ludFZhbHVlLCBfc2VxQ29sdW1uKS5h\ncHBlbmQoIikiKTsKICAgICAgICAKICAgICAgICBib29sZWFuIHdhc0F1dG8g\nPSBjb25uLmdldEF1dG9Db21taXQoKTsKICAgICAgICBpZiAoIXdhc0F1dG8g\nJiYgIXN1c3BlbmRJbkpUQSgpKQogICAgICAgICAgICBjb25uLnNldEF1dG9D\nb21taXQodHJ1ZSk7CgogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50\nID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBzdG1udCA9IHBy\nZXBhcmVTdGF0ZW1lbnQoY29ubiwgaW5zZXJ0KTsKICAgICAgICAgICAgZXhl\nY3V0ZVVwZGF0ZShfY29uZiwgY29ubiwgc3RtbnQsIGluc2VydCwgUm93SW1w\nbC5BQ1RJT05fSU5TRVJUKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICBpZiAoc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7\nIHN0bW50LmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30K\nICAgICAgICAgICAgaWYgKCF3YXNBdXRvICYmICFzdXNwZW5kSW5KVEEoKSkK\nICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogR2V0IHRoZSBjdXJyZW50\nIHNlcXVlbmNlIHZhbHVlLgogICAgICogCiAgICAgKiBAcGFyYW0gbWFwcGlu\nZwogICAgICogICAgICAgICAgICBDbGFzc01hcHBpbmcgb2YgdGhlIGVudGl0\neSB3aG9zZSBzZXF1ZW5jZSB2YWx1ZSB3aWxsIGJlCiAgICAgKiAgICAgICAg\nICAgIG9idGFpbmVkLgogICAgICogQHBhcmFtIGNvbm4KICAgICAqICAgICAg\nICAgICAgQ29ubmVjdGlvbiB1c2VkIGlzc3VlIFNRTCBzdGF0ZW1lbnRzLgog\nICAgICogCiAgICAgKiBAcmV0dXJuIFRoZSBjdXJyZW50IHNlcXVlbmNlIHZh\nbHVlLCBvciA8Y29kZT5TRVFVRU5DRV9OT1RfRk9VTkQ8L2NvZGU+CiAgICAg\nKiAgICAgICAgIGlmIHRoZSBzZXF1ZW5jZSBjb3VsZCBub3QgYmUgZm91bmQu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBsb25nIGdldFNlcXVlbmNlKENsYXNz\nTWFwcGluZyBtYXBwaW5nLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVu\nYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgiZ2V0\nLXNlcSIpKTsKCiAgICAgICAgT2JqZWN0IHBrID0gZ2V0UHJpbWFyeUtleSht\nYXBwaW5nKTsKICAgICAgICBpZiAocGsgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIC0xOwoKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9jb25m\nLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCk7CiAgICAgICAgU1FMQnVmZmVy\nIHNlbCA9IG5ldyBTUUxCdWZmZXIoZGljdCkuYXBwZW5kKF9zZXFDb2x1bW4p\nOwogICAgICAgIFNRTEJ1ZmZlciB3aGVyZSA9IG5ldyBTUUxCdWZmZXIoZGlj\ndCkuYXBwZW5kKF9wa0NvbHVtbikuYXBwZW5kKCIgPSAiKS4KICAgICAgICAg\nICAgYXBwZW5kVmFsdWUocGssIF9wa0NvbHVtbik7CiAgICAgICAgU3RyaW5n\nIHRhYmxlTmFtZSA9IHJlc29sdmVUYWJsZU5hbWUobWFwcGluZywgX3NlcUNv\nbHVtbi5nZXRUYWJsZSgpKTsKICAgICAgICBTUUxCdWZmZXIgdGFibGVzID0g\nbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQodGFibGVOYW1lKTsKCiAgICAg\nICAgU1FMQnVmZmVyIHNlbGVjdCA9IGRpY3QudG9TZWxlY3Qoc2VsLCBudWxs\nLCB0YWJsZXMsIHdoZXJlLCBudWxsLCBudWxsLAogICAgICAgICAgICAgICAg\nbnVsbCwgZmFsc2UsIGRpY3Quc3VwcG9ydHNTZWxlY3RGb3JVcGRhdGUsIDAs\nIExvbmcuTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgZmFsc2UsIHRydWUp\nOwoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHByZXBhcmVT\ndGF0ZW1lbnQoY29ubiwgc2VsZWN0KTsKICAgICAgICBSZXN1bHRTZXQgcnMg\nPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJzID0gZXhlY3V0\nZVF1ZXJ5KF9jb25mLCBjb25uLCBzdG1udCwgc2VsZWN0KTsKICAgICAgICAg\nICAgcmV0dXJuIGdldFNlcXVlbmNlKHJzLCBkaWN0KTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICBpZiAocnMgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHRyeSB7IHJzLmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlv\nbiBzZSkge30KICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpICAgIAog\nICAgICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIEdyYWJzIHRoZSBuZXh0IGhhbmRmdWwgb2Ygc2VxdWVuY2UgbnVt\nYmVycy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHNlcXVl\nbmNlIHdhcyB1cGRhdGVkLCBmYWxzZSBpZiBubyBzZXF1ZW5jZQogICAgICog\ncm93IGV4aXN0ZWQgZm9yIHRoaXMgbWFwcGluZwogICAgICovCiAgICBwcm90\nZWN0ZWQgYm9vbGVhbiBzZXRTZXF1ZW5jZShDbGFzc01hcHBpbmcgbWFwcGlu\nZywgU3RhdHVzIHN0YXQsIGludCBpbmMsCiAgICAgICAgYm9vbGVhbiB1cGRh\ndGVTdGF0U2VxLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQo\nKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgidXBkYXRlLXNl\ncSIpKTsKCiAgICAgICAgT2JqZWN0IHBrID0gZ2V0UHJpbWFyeUtleShtYXBw\naW5nKTsKICAgICAgICBpZiAocGsgPT0gbnVsbCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXNl\ncS10eXBlIiwKICAgICAgICAgICAgICAgIGdldENsYXNzKCksIG1hcHBpbmcp\nKTsKCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRp\nY3Rpb25hcnlJbnN0YW5jZSgpOyAgICAgICAgCiAgICAgICAgU1FMQnVmZmVy\nIHdoZXJlID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoX3BrQ29sdW1u\nKS5hcHBlbmQoIiA9ICIpLgogICAgICAgICAgICBhcHBlbmRWYWx1ZShwaywg\nX3BrQ29sdW1uKTsKCiAgICAgICAgLy8gbG9vcCB1bnRpbCB3ZSBoYXZlIGEg\nc3VjY2Vzc2Z1bCBhdG9taWMgc2VsZWN0L3VwZGF0ZSBzZXF1ZW5jZQogICAg\nICAgIGxvbmcgY3VyID0gMDsKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBz\ndG1udDsKICAgICAgICBSZXN1bHRTZXQgcnM7CiAgICAgICAgU1FMQnVmZmVy\nIHVwZDsKICAgICAgICBmb3IgKGludCB1cGRhdGVzID0gMDsgdXBkYXRlcyA9\nPSAwOykgewogICAgICAgICAgICBzdG1udCA9IG51bGw7CiAgICAgICAgICAg\nIHJzID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGN1ciA9IGdldFNlcXVlbmNlKG1hcHBpbmcsIGNvbm4pOwogICAgICAgICAg\nICAgICAgaWYgKGN1ciA9PSAtMSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIHRoZSB2YWx1\nZQogICAgICAgICAgICAgICAgdXBkID0gbmV3IFNRTEJ1ZmZlcihkaWN0KTsK\nICAgICAgICAgICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSByZXNvbHZlVGFi\nbGVOYW1lKG1hcHBpbmcsIF9zZXFDb2x1bW4uZ2V0VGFibGUoKSk7CiAgICAg\nICAgICAgICAgICB1cGQuYXBwZW5kKCJVUERBVEUgIikuYXBwZW5kKHRhYmxl\nTmFtZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgU0VUICIpLmFw\ncGVuZChfc2VxQ29sdW1uKS5hcHBlbmQoIiA9ICIpLgogICAgICAgICAgICAg\nICAgICAgIGFwcGVuZFZhbHVlKE51bWJlcnMudmFsdWVPZihjdXIgKyBpbmMp\nLCBfc2VxQ29sdW1uKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiBX\nSEVSRSAiKS5hcHBlbmQod2hlcmUpLmFwcGVuZCgiIEFORCAiKS4KICAgICAg\nICAgICAgICAgICAgICBhcHBlbmQoX3NlcUNvbHVtbikuYXBwZW5kKCIgPSAi\nKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmRWYWx1ZShOdW1iZXJzLnZh\nbHVlT2YoY3VyKSwgX3NlcUNvbHVtbik7CgogICAgICAgICAgICAgICAgc3Rt\nbnQgPSBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIHVwZCk7CiAgICAgICAgICAg\nICAgICB1cGRhdGVzID0gZXhlY3V0ZVVwZGF0ZShfY29uZiwgY29ubiwgc3Rt\nbnQsIHVwZCwgUm93SW1wbC5BQ1RJT05fVVBEQVRFKTsKICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChycyAhPSBudWxsKSAK\nICAgICAgICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgpOyB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgICAgICBpZiAoc3Rt\nbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5j\nbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIHNldHVwIG5ldyBzZXF1ZW5j\nZSByYW5nZSAgICAgICAgCiAgICAgICAgc3luY2hyb25pemVkIChzdGF0KSB7\nCiAgICAgICAgICAgIGlmICh1cGRhdGVTdGF0U2VxICYmIHN0YXQuc2VxIDwg\nY3VyKQogICAgICAgICAgICAgICAgc3RhdC5zZXEgPSBjdXI7CiAgICAgICAg\nICAgIGlmIChzdGF0Lm1heCA8IGN1ciArIGluYykKICAgICAgICAgICAgICAg\nIHN0YXQubWF4ID0gY3VyICsgaW5jOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzb2x2ZSBhIGZ1bGx5\nIHF1YWxpZmllZCB0YWJsZSBuYW1lCiAgICAgKiAKICAgICAqIEBwYXJhbSBj\nbGFzcwogICAgICogICAgICAgICAgICBtYXBwaW5nIHRvIGdldCB0aGUgc2No\nZW1hIG5hbWUKICAgICAqLwogICAgcHVibGljIFN0cmluZyByZXNvbHZlVGFi\nbGVOYW1lKENsYXNzTWFwcGluZyBtYXBwaW5nLCBUYWJsZSB0YWJsZSkgewog\nICAgICAgIFN0cmluZyBzTmFtZSA9IG1hcHBpbmcuZ2V0VGFibGUoKS5nZXRT\nY2hlbWFOYW1lKCk7CiAgICAgICAgU3RyaW5nIHRhYmxlTmFtZTsKICAgICAg\nICBpZiAoc05hbWUgPT0gbnVsbCkKICAgICAgICAgICAgdGFibGVOYW1lID0g\ndGFibGUuZ2V0RnVsbE5hbWUoKTsKICAgICAgICBlbHNlIGlmICh0YWJsZS5n\nZXRTY2hlbWFOYW1lKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGFibGVOYW1l\nID0gdGFibGUuZ2V0RnVsbE5hbWUoKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIHRhYmxlTmFtZSA9IHNOYW1lICsgIi4iICsgdGFibGUuZ2V0TmFtZSgp\nOwogICAgICAgIHJldHVybiB0YWJsZU5hbWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDcmVhdGVzIHRoZSBzZXF1ZW5jZSB0YWJsZSBpbiB0aGUgREIuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hUYWJsZSgpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNJbmZv\nRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5nZXQoIm1h\na2Utc2VxLXRhYmxlIikpOwoKICAgICAgICAvLyBjcmVhdGUgdGhlIHRhYmxl\nCiAgICAgICAgU2NoZW1hVG9vbCB0b29sID0gbmV3IFNjaGVtYVRvb2woX2Nv\nbmYpOwogICAgICAgIHRvb2wuc2V0SWdub3JlRXJyb3JzKHRydWUpOwogICAg\nICAgIHRvb2wuY3JlYXRlVGFibGUoX3BrQ29sdW1uLmdldFRhYmxlKCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogRHJvcHMgdGhlIHNlcXVlbmNlIHRhYmxl\nIGluIHRoZSBEQi4KICAgICAqLwogICAgcHVibGljIHZvaWQgZHJvcFRhYmxl\nKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nX2xvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cuaW5mbyhf\nbG9jLmdldCgiZHJvcC1zZXEtdGFibGUiKSk7CgogICAgICAgIC8vIGRyb3Ag\ndGhlIHRhYmxlCiAgICAgICAgU2NoZW1hVG9vbCB0b29sID0gbmV3IFNjaGVt\nYVRvb2woX2NvbmYpOwogICAgICAgIHRvb2wuc2V0SWdub3JlRXJyb3JzKHRy\ndWUpOwogICAgICAgIHRvb2wuZHJvcFRhYmxlKF9wa0NvbHVtbi5nZXRUYWJs\nZSgpKTsKICAgIH0KCiAgICAvLy8vLy8vLy8KICAgIC8vIE1haW4KICAgIC8v\nLy8vLy8vLwoKICAgIC8qKgogICAgICogVXNhZ2U6IGphdmEgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlSkRCQ1NlcXVlbmNlIFtvcHRp\nb25dKgogICAgICogLWFjdGlvbi8tYSAmbHQ7YWRkIHwgZHJvcCB8IGdldCB8\nIHNldCZndDsgW3ZhbHVlXQogICAgICogIFdoZXJlIHRoZSBmb2xsb3dpbmcg\nb3B0aW9ucyBhcmUgcmVjb2duaXplZC4KICAgICAqIDx1bD4KICAgICAqIDxs\naT48aT4tcHJvcGVydGllcy8tcCAmbHQ7cHJvcGVydGllcyBmaWxlIG9yIHJl\nc291cmNlJmd0OzwvaT46IFRoZQogICAgICogcGF0aCBvciByZXNvdXJjZSBu\nYW1lIG9mIGEgT3BlbkpQQSBwcm9wZXJ0aWVzIGZpbGUgY29udGFpbmluZwog\nICAgICogaW5mb3JtYXRpb24gc3VjaCBhcyB0aGUgbGljZW5zZSBrZXkJYW5k\nIGNvbm5lY3Rpb24gZGF0YSBhcwogICAgICogb3V0bGluZWQgaW4ge0BsaW5r\nIEpEQkNDb25maWd1cmF0aW9ufS4gT3B0aW9uYWwuPC9saT4KICAgICAqIDxs\naT48aT4tJmx0O3Byb3BlcnR5IG5hbWUmZ3Q7ICZsdDtwcm9wZXJ0eSB2YWx1\nZSZndDs8L2k+OiBBbGwgYmVhbgogICAgICogcHJvcGVydGllcyBvZiB0aGUg\nT3BlbkpQQSB7QGxpbmsgSkRCQ0NvbmZpZ3VyYXRpb259IGNhbiBiZSBzZXQg\nYnkKICAgICAqIHVzaW5nIHRoZWlyCW5hbWVzIGFuZCBzdXBwbHlpbmcgYSB2\nYWx1ZS4gRm9yIGV4YW1wbGU6CiAgICAgKiA8Y29kZT4tbGljZW5zZUtleSBh\nZHNsZmphODNyM2xrYWRmPC9jb2RlPjwvbGk+CiAgICAgKiA8L3VsPgogICAg\nICogIFRoZSB2YXJpb3VzIGFjdGlvbnMgYXJlIGFzIGZvbGxvd3MuCiAgICAg\nKiA8dWw+CiAgICAgKiA8bGk+PGk+YWRkPC9pPjogQ3JlYXRlIHRoZSBzZXF1\nZW5jZSB0YWJsZS48L2xpPgogICAgICogPGxpPjxpPmRyb3A8L2k+OiBEcm9w\nIHRoZSBzZXF1ZW5jZSB0YWJsZS48L2xpPgogICAgICogPGxpPjxpPmdldDwv\naT46IFByaW50IHRoZSBjdXJyZW50IHNlcXVlbmNlIHZhbHVlLjwvbGk+CiAg\nICAgKiA8bGk+PGk+c2V0PC9pPjogU2V0IHRoZSBzZXF1ZW5jZSB2YWx1ZS48\nL2xpPgogICAgICogPC91bD4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2\nb2lkIG1haW4oU3RyaW5nW10gYXJncykKICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwog\nICAgICAgIGZpbmFsIFN0cmluZ1tdIGFyZ3VtZW50cyA9IG9wdHMuc2V0RnJv\nbUNtZExpbmUoYXJncyk7CiAgICAgICAgYm9vbGVhbiByZXQgPSBDb25maWd1\ncmF0aW9ucy5ydW5BZ2FpbnN0QWxsQW5jaG9ycyhvcHRzLAogICAgICAgICAg\nICBuZXcgQ29uZmlndXJhdGlvbnMuUnVubmFibGUoKSB7CiAgICAgICAgICAg\nIHB1YmxpYyBib29sZWFuIHJ1bihPcHRpb25zIG9wdHMpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiA9IG5ldyBKREJDQ29uZmlndXJhdGlvbkltcGwoKTsKICAgICAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRhYmxlSkRC\nQ1NlcS5ydW4oY29uZiwgYXJndW1lbnRzLCBvcHRzKTsKICAgICAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgY29uZi5jbG9z\nZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfSk7CiAgICAgICAgaWYgKCFyZXQpCiAgICAgICAgICAgIFN5c3RlbS5vdXQu\ncHJpbnRsbihfbG9jLmdldCgic2VxLXVzYWdlIikpOwogICAgfQoKICAgIC8q\nKgogICAgICogUnVuIHRoZSB0b29sLiBSZXR1cm5zIGZhbHNlIGlmIGludmFs\naWQgb3B0aW9ucyB3ZXJlIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGJvb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmlu\nZ1tdIGFyZ3MsCiAgICAgICAgT3B0aW9ucyBvcHRzKQogICAgICAgIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBhY3Rpb24gPSBvcHRzLnJl\nbW92ZVByb3BlcnR5KCJhY3Rpb24iLCAiYSIsIG51bGwpOwogICAgICAgIENv\nbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihjb25mLCBvcHRz\nKTsKICAgICAgICByZXR1cm4gcnVuKGNvbmYsIGFyZ3MsIGFjdGlvbik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSdW4gdGhlIHRvb2wuIFJldHVybiBmYWxz\nZSBpZiBhbiBpbnZhbGlkIG9wdGlvbiB3YXMgZ2l2ZW4uCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRpb24g\nY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBTdHJpbmcgYWN0aW9uKQog\nICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChhcmdzLmxl\nbmd0aCA+IDEgfHwgKGFyZ3MubGVuZ3RoICE9IDAKICAgICAgICAgICAgJiYg\nIUFDVElPTl9TRVQuZXF1YWxzKGFjdGlvbikpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIFRhYmxlSkRCQ1NlcSBzZXEgPSBuZXcgVGFi\nbGVKREJDU2VxKCk7CiAgICAgICAgU3RyaW5nIHByb3BzID0gQ29uZmlndXJh\ndGlvbnMuZ2V0UHJvcGVydGllcyhjb25mLmdldFNlcXVlbmNlKCkpOwogICAg\nICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKHNlcSwgY29u\nZiwgcHJvcHMpOwoKICAgICAgICBpZiAoQUNUSU9OX0RST1AuZXF1YWxzKGFj\ndGlvbikpCiAgICAgICAgICAgIHNlcS5kcm9wVGFibGUoKTsKICAgICAgICBl\nbHNlIGlmIChBQ1RJT05fQURELmVxdWFscyhhY3Rpb24pKQogICAgICAgICAg\nICBzZXEucmVmcmVzaFRhYmxlKCk7CiAgICAgICAgZWxzZSBpZiAoQUNUSU9O\nX0dFVC5lcXVhbHMoYWN0aW9uKSB8fCBBQ1RJT05fU0VULmVxdWFscyhhY3Rp\nb24pKSB7CiAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubiA9IGNvbmYuZ2V0\nRGF0YVNvdXJjZTIobnVsbCkuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgbG9uZyBjdXIgPSBzZXEuZ2V0U2Vx\ndWVuY2UobnVsbCwgY29ubik7CiAgICAgICAgICAgICAgICBpZiAoQUNUSU9O\nX0dFVC5lcXVhbHMoYWN0aW9uKSkKICAgICAgICAgICAgICAgICAgICBTeXN0\nZW0ub3V0LnByaW50bG4oY3VyKTsKICAgICAgICAgICAgICAgIGVsc2Ugewog\nICAgICAgICAgICAgICAgICAgIGxvbmcgc2V0OwogICAgICAgICAgICAgICAg\nICAgIGlmIChhcmdzLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICAgICAg\nICAgIHNldCA9IExvbmcucGFyc2VMb25nKGFyZ3NbMF0pOwogICAgICAgICAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2V0ID0g\nY3VyICsgc2VxLmdldEFsbG9jYXRlKCk7CiAgICAgICAgICAgICAgICAgICAg\naWYgKHNldCA8IGN1cikKICAgICAgICAgICAgICAgICAgICAgICAgc2V0ID0g\nY3VyOwogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAg\nICAgICAgICAgICBTdGF0dXMgc3RhdCA9IHNlcS5nZXRTdGF0dXMobnVsbCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcS5zZXRTZXF1ZW5jZShudWxs\nLCBzdGF0LCAoaW50KSAoc2V0IC0gY3VyKSwgdHJ1ZSwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGNvbm4pOwogICAgICAgICAgICAgICAgICAgICAg\nICBzZXQgPSBzdGF0LnNlcTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKHNldCk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2gg\nKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7fQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBlciBzdHJ1Y3QgdG8gaG9sZCBz\ndGF0dXMgaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0\naWMgY2xhc3MgU3RhdHVzCiAgICAgICAgaW1wbGVtZW50cyBTZXJpYWxpemFi\nbGUgewoKICAgICAgICBwdWJsaWMgbG9uZyBzZXEgPSAxTDsKICAgICAgICBw\ndWJsaWMgbG9uZyBtYXggPSAwTDsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\naXMgbWV0aG9kIGlzIHRvIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1KREJD\nIG9yIEpEQkMtbGlrZSAKICAgICAqIGltcGxlbWVudGF0aW9uIG9mIHByZXBh\ncmluZyBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBQcmVwYXJl\nZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KENvbm5lY3Rpb24gY29ubiwg\nU1FMQnVmZmVyIGJ1ZikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICByZXR1cm4gYnVmLnByZXBhcmVTdGF0ZW1lbnQoY29ubik7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJv\ndmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAg\nICogaW1wbGVtZW50YXRpb24gb2YgZXhlY3V0aW5nIHVwZGF0ZS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGludCBleGVjdXRlVXBkYXRlKEpEQkNDb25maWd1\ncmF0aW9uIGNvbmYsIENvbm5lY3Rpb24gY29ubiwgIAogICAgICAgIFByZXBh\ncmVkU3RhdGVtZW50IHN0bW50LCBTUUxCdWZmZXIgYnVmLCBpbnQgb3Bjb2Rl\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gc3RtbnQu\nZXhlY3V0ZVVwZGF0ZSgpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRo\naXMgbWV0aG9kIGlzIHRvIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1KREJD\nIG9yIEpEQkMtbGlrZSAKICAgICAqIGltcGxlbWVudGF0aW9uIG9mIGV4ZWN1\ndGluZyBxdWVyeS4KICAgICAqLwogICAgcHJvdGVjdGVkIFJlc3VsdFNldCBl\neGVjdXRlUXVlcnkoSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgQ29ubmVjdGlv\nbiBjb25uLAogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBTUUxC\ndWZmZXIgYnVmKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1\ncm4gc3RtbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICB9CiAgICAKICAgIC8qKgog\nICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Ig\nbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICogaW1wbGVtZW50YXRpb24g\nb2YgZ2V0dGluZyBzZXF1ZW5jZSBmcm9tIHRoZSByZXN1bHQgc2V0LgogICAg\nICovCiAgICBwcm90ZWN0ZWQgbG9uZyBnZXRTZXF1ZW5jZShSZXN1bHRTZXQg\ncnMsIERCRGljdGlvbmFyeSBkaWN0KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAocnMgPT0gbnVsbCB8fCAhcnMubmV4dCgpKQogICAgICAg\nICAgICByZXR1cm4gLTE7CiAgICAgICAgcmV0dXJuIGRpY3QuZ2V0TG9uZyhy\ncywgMSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGxvY2F0ZVNlcXVlbmNl\nUnVubmFibGUgaXMgYSBydW5uYWJsZSB3cmFwcGVyIHRoYXQgd2lsbCBpbnNl\ncnRzIHRoZQogICAgICogaW5pdGlhbCBzZXF1ZW5jZSB2YWx1ZSBpbnRvIHRo\nZSBkYXRhYmFzZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGNsYXNzIEFsbG9j\nYXRlU2VxdWVuY2VSdW5uYWJsZSBpbXBsZW1lbnRzIFJ1bm5hYmxlIHsKCiAg\nICAgICAgSkRCQ1N0b3JlIHN0b3JlID0gbnVsbDsKICAgICAgICBDbGFzc01h\ncHBpbmcgbWFwcGluZyA9IG51bGw7CiAgICAgICAgU3RhdHVzIHN0YXQgPSBu\ndWxsOwogICAgICAgIGludCBhbGxvYzsKICAgICAgICBib29sZWFuIHVwZGF0\nZVN0YXRTZXE7CgogICAgICAgIEFsbG9jYXRlU2VxdWVuY2VSdW5uYWJsZShK\nREJDU3RvcmUgc3RvcmUsIENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAg\nICAgICAgICAgU3RhdHVzIHN0YXQsIGludCBhbGxvYywgYm9vbGVhbiB1cGRh\ndGVTdGF0U2VxKSB7CiAgICAgICAgICAgIHRoaXMuc3RvcmUgPSBzdG9yZTsK\nICAgICAgICAgICAgdGhpcy5tYXBwaW5nID0gbWFwcGluZzsKICAgICAgICAg\nICAgdGhpcy5zdGF0ID0gc3RhdDsKICAgICAgICAgICAgdGhpcy5hbGxvYyA9\nIGFsbG9jOwogICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRTZXEgPSB1cGRh\ndGVTdGF0U2VxOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nVGhpcyBtZXRob2QgYWN0dWFsbHkgb2J0YWlucyB0aGUgY3VycmVudCBzZXF1\nZW5jZSB2YWx1ZS4KICAgICAgICAgKiAKICAgICAgICAgKiBAdGhyb3dzIFJ1\nbnRpbWVFeGNlcHRpb24KICAgICAgICAgKiAgICAgICAgICAgICBhbnkgU1FM\nRXhjZXB0aW9ucyB0aGF0IG9jY3VyIHdoZW4gb2J0YWluaW5nIHRoZSBzZXF1\nZW5jZQogICAgICAgICAqICAgICAgICAgICAgIHZhbHVlIGFyZSB3cmFwcGVk\nIGluIGEgcnVudGltZSBleGNlcHRpb24gdG8gYXZvaWQKICAgICAgICAgKiAg\nICAgICAgICAgICBicmVha2luZyB0aGUgUnVubmFibGUgbWV0aG9kIHNpZ25h\ndHVyZS4gVGhlIGNhbGxlciBjYW4KICAgICAgICAgKiAgICAgICAgICAgICBv\nYnRhaW4gdGhlICJyZWFsIiBleGNlcHRpb24gYnkgY2FsbGluZyBnZXRDYXVz\nZSgpLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHRo\ncm93cyBSdW50aW1lRXhjZXB0aW9uIHsKICAgICAgICAgICAgQ29ubmVjdGlv\nbiBjb25uID0gbnVsbDsKICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9\nIG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAvLyBU\ncnkgdG8gdXNlIHRoZSBzdG9yZSdzIGNvbm5lY3Rpb24uCiAgICAgICAgICAg\nICAgICAKICAgICAgICAgICAgICAgIGNvbm4gPSBnZXRDb25uZWN0aW9uKHN0\nb3JlKTsgIAogICAgICAgICAgICAgICAgYm9vbGVhbiBzZXF1ZW5jZVNldCA9\nCiAgICAgICAgICAgICAgICAgICAgc2V0U2VxdWVuY2UobWFwcGluZywgc3Rh\ndCwgYWxsb2MsIHVwZGF0ZVN0YXRTZXEsIGNvbm4pOwogICAgICAgICAgICAg\nICAgY2xvc2VDb25uZWN0aW9uKGNvbm4pOwoKICAgICAgICAgICAgICAgIGlm\nICghc2VxdWVuY2VTZXQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBpbnNl\ncnQgYSBuZXcgc2VxdWVuY2UgY29sdW1uLiAKICAgICAgICAgICAgICAgICAg\nICAvLyBQcmVmZXIgY29ubmVjdGlvbjIgLyBub24tanRhLWRhdGEtc291cmNl\nIHdoZW4gaW5zZXJ0aW5nIAogICAgICAgICAgICAgICAgICAgIC8vIGEgc2Vx\ndWVuY2UgY29sdW1uIHJlZ2FyZGxlc3Mgb2YgU2VxLnR5cGUuCiAgICAgICAg\nICAgICAgICAgICAgY29ubiA9IF9jb25mLmdldERhdGFTb3VyY2UyKHN0b3Jl\nLmdldENvbnRleHQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAgICAgICAgICAgIGluc2Vy\ndFNlcXVlbmNlKG1hcHBpbmcsIGNvbm4pOwogICAgICAgICAgICAgICAgICAg\nIGNvbm4uY2xvc2UoKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gbm93IHdl\nIHNob3VsZCBiZSBhYmxlIHRvIHVwZGF0ZSB1c2luZyB0aGUgY29ubmVjdGlv\nbiBwZXIKICAgICAgICAgICAgICAgICAgICAvLyBvbiB0aGUgc2VxIHR5cGUu\nCiAgICAgICAgICAgICAgICAgICAgY29ubiA9IGdldENvbm5lY3Rpb24oc3Rv\ncmUpOwogICAgICAgICAgICAgICAgICAgIGlmICghc2V0U2VxdWVuY2UobWFw\ncGluZywgc3RhdCwgYWxsb2MsIHVwZGF0ZVN0YXRTZXEsIGNvbm4pKQogICAg\nICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgKGVyciAhPSBudWxsKSA/IGVyciA6IG5ldyBTUUxFeGNlcHRpb24oX2xv\nYy5nZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm5vLXNl\ncS1yb3ciLCBtYXBwaW5nLCBfdGFibGUpLmdldE1lc3NhZ2UoKSk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNsb3NlQ29u\nbmVjdGlvbihjb25uKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGlm\nIChjb25uICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBjbG9zZUNv\nbm5lY3Rpb24oY29ubik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBSdW50aW1lRXhjZXB0aW9uIHJlID0gbmV3IFJ1bnRpbWVFeGNlcHRp\nb24oZS5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICAgICAgcmUuaW5pdENh\ndXNlKGUpOwogICAgICAgICAgICAgICAgdGhyb3cgcmU7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDdXJlbnRTZXF1\nZW5jZVJ1bm5hYmxlIGlzIGEgcnVubmFibGUgd3JhcHBlciB3aGljaCBvYnRh\naW5zIHRoZSBjdXJyZW50CiAgICAgKiBzZXF1ZW5jZSB2YWx1ZSBmcm9tIHRo\nZSBkYXRhYmFzZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGNsYXNzIEN1cnJl\nbnRTZXF1ZW5jZVJ1bm5hYmxlIGltcGxlbWVudHMgUnVubmFibGUgewogICAg\nICAgIHByaXZhdGUgSkRCQ1N0b3JlIF9zdG9yZTsKICAgICAgICBwcml2YXRl\nIENsYXNzTWFwcGluZyBfbWFwcGluZzsKCiAgICAgICAgQ3VycmVudFNlcXVl\nbmNlUnVubmFibGUoSkRCQ1N0b3JlIHN0b3JlLCBDbGFzc01hcHBpbmcgbWFw\ncGluZykgewogICAgICAgICAgICBfc3RvcmUgPSBzdG9yZTsKICAgICAgICAg\nICAgX21hcHBpbmcgPSBtYXBwaW5nOwogICAgICAgIH0KCiAgICAgICAgLyoq\nCiAgICAgICAgICogVGhpcyBtZXRob2QgYWN0dWFsbHkgb2J0YWlucyB0aGUg\nY3VycmVudCBzZXF1ZW5jZSB2YWx1ZS4KICAgICAgICAgKiAKICAgICAgICAg\nKiBAdGhyb3dzIFJ1bnRpbWVFeGNlcHRpb24KICAgICAgICAgKiAgICAgICAg\nICAgICBhbnkgU1FMRXhjZXB0aW9ucyB0aGF0IG9jY3VyIHdoZW4gb2J0YWlu\naW5nIHRoZSBzZXF1ZW5jZQogICAgICAgICAqICAgICAgICAgICAgIHZhbHVl\nIGFyZSB3cmFwcGVkIGluIGEgcnVudGltZSBleGNlcHRpb24gdG8gYXZvaWQK\nICAgICAgICAgKiAgICAgICAgICAgICBicmVha2luZyB0aGUgUnVubmFibGUg\nbWV0aG9kIHNpZ25hdHVyZS4gVGhlIGNhbGxlciBjYW4KICAgICAgICAgKiAg\nICAgICAgICAgICBvYnRhaW4gdGhlICJyZWFsIiBleGNlcHRpb24gYnkgY2Fs\nbGluZyBnZXRDYXVzZSgpLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2\nb2lkIHJ1bigpIHRocm93cyBSdW50aW1lRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgQ29ubmVjdGlvbiBjb25uID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIGNvbm4gPSBnZXRDb25uZWN0aW9uKF9zdG9yZSk7\nCiAgICAgICAgICAgICAgICBsb25nIGN1ciA9IGdldFNlcXVlbmNlKF9tYXBw\naW5nLCBjb25uKTsKICAgICAgICAgICAgICAgIGlmIChjdXIgIT0gLTEgKSAv\nLyBVU0UgdGhlIGNvbnN0YW50CiAgICAgICAgICAgICAgICAgICAgY3VycmVu\ndCA9IE51bWJlcnMudmFsdWVPZihjdXIpOwogICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc3FsZSkgewogICAgICAgICAgICAgICAgUnVudGlt\nZUV4Y2VwdGlvbiByZSA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKHNxbGUuZ2V0\nTWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgIHJlLmluaXRDYXVzZShzcWxl\nKTsKICAgICAgICAgICAgICAgIHRocm93IHJlOwogICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKGNvbm4gIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIGNsb3NlQ29ubmVjdGlvbihjb25uKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nfQo=\n","encoding":"base64"}

