{"sha":"6683be36abccea1cd3365c99b367133cd1d36bd8","node_id":"MDQ6QmxvYjIwNjM2NDo2NjgzYmUzNmFiY2NlYTFjZDMzNjVjOTliMzY3MTMzY2QxZDM2YmQ4","size":7415,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6683be36abccea1cd3365c99b367133cd1d36bd8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5KYXZhU1FMVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuSm9pbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuUmVzdWx0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLkZpbHRlcnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4\ncHMuRXhwcmVzc2lvblZpc2l0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5DbGFzc01ldGFEYXRhOwoKLyoqCiAqIEZpbHRlciBsaXN0ZW5l\nciB0aGF0IGV2YWx1YXRlcyB0byBhIHZhbHVlLgogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKi8KY2xhc3MgRXh0ZW5zaW9uCiAgICBleHRlbmRzIEFic3Ry\nYWN0VmFsCiAgICBpbXBsZW1lbnRzIFZhbCwgRXhwIHsKCiAgICBwcml2YXRl\nIGZpbmFsIEpEQkNGaWx0ZXJMaXN0ZW5lciBfbGlzdGVuZXI7CiAgICBwcml2\nYXRlIGZpbmFsIFZhbCBfdGFyZ2V0OwogICAgcHJpdmF0ZSBmaW5hbCBWYWwg\nX2FyZzsKICAgIHByaXZhdGUgZmluYWwgQ2xhc3NNYXBwaW5nIF9jYW5kaWRh\ndGU7CiAgICBwcml2YXRlIENsYXNzTWV0YURhdGEgX21ldGEgPSBudWxsOwog\nICAgcHJpdmF0ZSBDbGFzcyBfY2FzdCA9IG51bGw7CgogICAgLyoqCiAgICAg\nKiBDb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIEV4dGVuc2lvbihK\nREJDRmlsdGVyTGlzdGVuZXIgbGlzdGVuZXIsIFZhbCB0YXJnZXQsCiAgICAg\nICAgVmFsIGFyZywgQ2xhc3NNYXBwaW5nIGNhbmRpZGF0ZSkgewogICAgICAg\nIF9saXN0ZW5lciA9IGxpc3RlbmVyOwogICAgICAgIF90YXJnZXQgPSB0YXJn\nZXQ7CiAgICAgICAgX2FyZyA9IGFyZzsKICAgICAgICBfY2FuZGlkYXRlID0g\nY2FuZGlkYXRlOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdl\ndE1ldGFEYXRhKCkgewogICAgICAgIHJldHVybiBfbWV0YTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRNZXRhRGF0YShDbGFzc01ldGFEYXRhIG1ldGEp\nIHsKICAgICAgICBfbWV0YSA9IG1ldGE7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaXNWYXJpYWJsZSgpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNBZ2dyZWdhdGUoKSB7CiAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBnZXRU\neXBlKCkgewogICAgICAgIGlmIChfY2FzdCAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gX2Nhc3Q7CiAgICAgICAgQ2xhc3MgdGFyZ2V0Q2xhc3MgPSAo\nX3RhcmdldCA9PSBudWxsKSA/IG51bGwgOiBfdGFyZ2V0LmdldFR5cGUoKTsK\nICAgICAgICByZXR1cm4gX2xpc3RlbmVyLmdldFR5cGUodGFyZ2V0Q2xhc3Ms\nIGdldEFyZ1R5cGVzKCkpOwogICAgfQoKICAgIHByaXZhdGUgQ2xhc3NbXSBn\nZXRBcmdUeXBlcygpIHsKICAgICAgICBpZiAoX2FyZyA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoX2FyZyBpbnN0YW5j\nZW9mIEFyZ3MpCiAgICAgICAgICAgIHJldHVybiAoKEFyZ3MpIF9hcmcpLmdl\ndFR5cGVzKCk7CiAgICAgICAgcmV0dXJuIG5ldyBDbGFzc1tdeyBfYXJnLmdl\ndFR5cGUoKSB9OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEltcGxpY2l0\nVHlwZShDbGFzcyB0eXBlKSB7CiAgICAgICAgX2Nhc3QgPSB0eXBlOwogICAg\nfQoKICAgIHB1YmxpYyBFeHBTdGF0ZSBpbml0aWFsaXplKFNlbGVjdCBzZWws\nIEV4cENvbnRleHQgY3R4LCBpbnQgZmxhZ3MpIHsKICAgICAgICAvLyBub3Rl\nIHRoYXQgd2UgdGVsbCB0YXJnZXRzIGFuZCBhcmdzIHRvIGV4dGVuc2lvbnMg\ndGhhdCBhcmUgc3FsCiAgICAgICAgLy8gcGF0aHMgdG8gZ28gYWhlYWQgYW5k\nIGpvaW4gdG8gdGhlaXIgcmVsYXRlZCBvYmplY3QgKGlmIGFueSksCiAgICAg\nICAgLy8gYmVjYXVzZSB3ZSBhc3N1bWUgdGhhdCwgdW5saWtlIG1vc3Qgb3Bl\ncmF0aW9ucywgaWYgYSByZWxhdGlvbgogICAgICAgIC8vIGZpZWxkIGxpa2Ug\nYSAxLTEgaXMgZ2l2ZW4gYXMgdGhlIHRhcmdldCBvZiBhbiBleHRlbnNpb24s\nIHRoZW4KICAgICAgICAvLyB0aGUgZXh0ZW5zaW9uIHByb2JhYmx5IGFjdHMg\nb24gc29tZSBmaWVsZCBvciBjb2x1bW4gaW4gdGhlCiAgICAgICAgLy8gcmVs\nYXRlZCBvYmplY3QsIG5vdCB0aGUgMS0xIGZpZWxkIGl0c2VsZgogICAgICAg\nIEV4cFN0YXRlIHRhcmdldFN0YXRlID0gbnVsbDsKICAgICAgICBFeHBTdGF0\nZSBhcmdTdGF0ZSA9IG51bGw7CiAgICAgICAgaWYgKF90YXJnZXQgIT0gbnVs\nbCkKICAgICAgICAgICAgdGFyZ2V0U3RhdGUgPSBfdGFyZ2V0LmluaXRpYWxp\nemUoc2VsLCBjdHgsIEpPSU5fUkVMKTsKICAgICAgICBpZiAoX2FyZyAhPSBu\ndWxsKQogICAgICAgICAgICBhcmdTdGF0ZSA9IF9hcmcuaW5pdGlhbGl6ZShz\nZWwsIGN0eCwgSk9JTl9SRUwpOwogICAgICAgIEpvaW5zIGoxID0gKHRhcmdl\ndFN0YXRlID09IG51bGwpID8gbnVsbCA6IHRhcmdldFN0YXRlLmpvaW5zOwog\nICAgICAgIEpvaW5zIGoyID0gKGFyZ1N0YXRlID09IG51bGwpID8gbnVsbCA6\nIGFyZ1N0YXRlLmpvaW5zOwogICAgICAgIHJldHVybiBuZXcgRXh0ZW5zaW9u\nRXhwU3RhdGUoc2VsLmFuZChqMSwgajIpLCB0YXJnZXRTdGF0ZSwgCiAgICAg\nICAgICAgIGFyZ1N0YXRlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4cHJl\nc3Npb24gc3RhdGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNz\nIEV4dGVuc2lvbkV4cFN0YXRlCiAgICAgICAgZXh0ZW5kcyBFeHBTdGF0ZSB7\nCgogICAgICAgIHB1YmxpYyBmaW5hbCBFeHBTdGF0ZSB0YXJnZXRTdGF0ZTsK\nICAgICAgICBwdWJsaWMgZmluYWwgRXhwU3RhdGUgYXJnU3RhdGU7CgogICAg\nICAgIHB1YmxpYyBFeHRlbnNpb25FeHBTdGF0ZShKb2lucyBqb2lucywgRXhw\nU3RhdGUgdGFyZ2V0U3RhdGUsCiAgICAgICAgICAgIEV4cFN0YXRlIGFyZ1N0\nYXRlKSB7CiAgICAgICAgICAgIHN1cGVyKGpvaW5zKTsKICAgICAgICAgICAg\ndGhpcy50YXJnZXRTdGF0ZSA9IHRhcmdldFN0YXRlOwogICAgICAgICAgICB0\naGlzLmFyZ1N0YXRlID0gYXJnU3RhdGU7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNlbGVjdChTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0\neCwgRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIGJvb2xlYW4gcGtzKSB7CiAg\nICAgICAgc2VsLnNlbGVjdChuZXdTUUxCdWZmZXIoc2VsLCBjdHgsIHN0YXRl\nKSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2VsZWN0Q29sdW1u\ncyhTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUs\nIAogICAgICAgIGJvb2xlYW4gcGtzKSB7CiAgICAgICAgRXh0ZW5zaW9uRXhw\nU3RhdGUgZXN0YXRlID0gKEV4dGVuc2lvbkV4cFN0YXRlKSBzdGF0ZTsKICAg\nICAgICBpZiAoX3RhcmdldCAhPSBudWxsKQogICAgICAgICAgICBfdGFyZ2V0\nLnNlbGVjdENvbHVtbnMoc2VsLCBjdHgsIGVzdGF0ZS50YXJnZXRTdGF0ZSwg\ndHJ1ZSk7CiAgICAgICAgaWYgKF9hcmcgIT0gbnVsbCkKICAgICAgICAgICAg\nX2FyZy5zZWxlY3RDb2x1bW5zKHNlbCwgY3R4LCBlc3RhdGUuYXJnU3RhdGUs\nIHRydWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoU2VsZWN0\nIHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlKSB7CiAgICAg\nICAgc2VsLmdyb3VwQnkobmV3U1FMQnVmZmVyKHNlbCwgY3R4LCBzdGF0ZSkp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG9yZGVyQnkoU2VsZWN0IHNlbCwg\nRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAgICBib29s\nZWFuIGFzYykgewogICAgICAgIHNlbC5vcmRlckJ5KG5ld1NRTEJ1ZmZlcihz\nZWwsIGN0eCwgc3RhdGUpLCBhc2MsIGZhbHNlKTsKICAgIH0KCiAgICBwcml2\nYXRlIFNRTEJ1ZmZlciBuZXdTUUxCdWZmZXIoU2VsZWN0IHNlbCwgRXhwQ29u\ndGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlKSB7CiAgICAgICAgY2FsY3VsYXRl\nVmFsdWUoc2VsLCBjdHgsIHN0YXRlLCBudWxsLCBudWxsKTsKICAgICAgICBT\nUUxCdWZmZXIgYnVmID0gbmV3IFNRTEJ1ZmZlcihjdHguc3RvcmUuZ2V0REJE\naWN0aW9uYXJ5KCkpOwogICAgICAgIGFwcGVuZFRvKHNlbCwgY3R4LCBzdGF0\nZSwgYnVmLCAwKTsKICAgICAgICByZXR1cm4gYnVmOwogICAgfQoKICAgIHB1\nYmxpYyBPYmplY3QgbG9hZChFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3Rh\ndGUsIFJlc3VsdCByZXMpIAogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIHJldHVybiBGaWx0ZXJzLmNvbnZlcnQocmVzLmdldE9iamVj\ndCh0aGlzLAogICAgICAgICAgICBKYXZhU1FMVHlwZXMuSkRCQ19ERUZBVUxU\nLCBudWxsKSwgZ2V0VHlwZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBj\nYWxjdWxhdGVWYWx1ZShTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhw\nU3RhdGUgc3RhdGUsIAogICAgICAgIFZhbCBvdGhlciwgRXhwU3RhdGUgb3Ro\nZXJTdGF0ZSkgewogICAgICAgIEV4dGVuc2lvbkV4cFN0YXRlIGVzdGF0ZSA9\nIChFeHRlbnNpb25FeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgaWYgKF90YXJn\nZXQgIT0gbnVsbCkKICAgICAgICAgICAgX3RhcmdldC5jYWxjdWxhdGVWYWx1\nZShzZWwsIGN0eCwgZXN0YXRlLnRhcmdldFN0YXRlLCBudWxsLCBudWxsKTsK\nICAgICAgICBpZiAoX2FyZyAhPSBudWxsKQogICAgICAgICAgICBfYXJnLmNh\nbGN1bGF0ZVZhbHVlKHNlbCwgY3R4LCBlc3RhdGUuYXJnU3RhdGUsIG51bGws\nIG51bGwpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgbGVuZ3RoKFNlbGVjdCBz\nZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0ZSkgewogICAgICAg\nIHJldHVybiAxOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFwcGVuZFRvKFNl\nbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0ZSwgCiAg\nICAgICAgU1FMQnVmZmVyIHNxbCwgaW50IGluZGV4KSB7CiAgICAgICAgRXh0\nZW5zaW9uRXhwU3RhdGUgZXN0YXRlID0gKEV4dGVuc2lvbkV4cFN0YXRlKSBz\ndGF0ZTsKICAgICAgICBGaWx0ZXJWYWx1ZSB0YXJnZXQgPSAoX3RhcmdldCA9\nPSBudWxsKSA/IG51bGwKICAgICAgICAgICAgOiBuZXcgRmlsdGVyVmFsdWVJ\nbXBsKHNlbCwgY3R4LCBlc3RhdGUudGFyZ2V0U3RhdGUsIF90YXJnZXQpOwog\nICAgICAgIF9saXN0ZW5lci5hcHBlbmRUbyhzcWwsIHRhcmdldCwgZ2V0QXJn\ncyhzZWwsIGN0eCwgZXN0YXRlLmFyZ1N0YXRlKSwKICAgICAgICAgICAgX2Nh\nbmRpZGF0ZSwgY3R4LnN0b3JlKTsKICAgICAgICBzZWwuYXBwZW5kKHNxbCwg\nc3RhdGUuam9pbnMpOwogICAgfQoKICAgIHByaXZhdGUgRmlsdGVyVmFsdWVb\nXSBnZXRBcmdzKFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0\nZSBzdGF0ZSkgewogICAgICAgIGlmIChfYXJnID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChfYXJnIGluc3RhbmNlb2Yg\nQXJncykKICAgICAgICAgICAgcmV0dXJuICgoQXJncykgX2FyZykubmV3Rmls\ndGVyVmFsdWVzKHNlbCwgY3R4LCBzdGF0ZSk7CiAgICAgICAgcmV0dXJuIG5l\ndyBGaWx0ZXJWYWx1ZVtdIHsKICAgICAgICAgICAgbmV3IEZpbHRlclZhbHVl\nSW1wbChzZWwsIGN0eCwgc3RhdGUsIF9hcmcpCiAgICAgICAgfTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChFeHByZXNzaW9uVmlzaXRv\nciB2aXNpdG9yKSB7CiAgICAgICAgdmlzaXRvci5lbnRlcigoRXhwKSB0aGlz\nKTsKICAgICAgICBpZiAoX3RhcmdldCAhPSBudWxsKQogICAgICAgICAgICBf\ndGFyZ2V0LmFjY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgIGlmIChfYXJn\nICE9IG51bGwpCiAgICAgICAgICAgIF9hcmcuYWNjZXB0VmlzaXQodmlzaXRv\ncik7CiAgICAgICAgdmlzaXRvci5leGl0KChFeHApIHRoaXMpOwogICAgfQoK\nICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEV4cCBpbXBsZW1l\nbnRhdGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1Ymxp\nYyBFeHBTdGF0ZSBpbml0aWFsaXplKFNlbGVjdCBzZWwsIEV4cENvbnRleHQg\nY3R4LCBNYXAgY29udGFpbnMpIHsKICAgICAgICByZXR1cm4gaW5pdGlhbGl6\nZShzZWwsIGN0eCwgMCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5k\nVG8oU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRl\nLCAKICAgICAgICBTUUxCdWZmZXIgc3FsKSB7CiAgICAgICAgY2FsY3VsYXRl\nVmFsdWUoc2VsLCBjdHgsIHN0YXRlLCBudWxsLCBudWxsKTsKICAgICAgICBh\ncHBlbmRUbyhzZWwsIGN0eCwgc3RhdGUsIHNxbCwgMCk7CiAgICAgICAgc2Vs\nLmFwcGVuZChzcWwsIHN0YXRlLmpvaW5zKTsKICAgIH0KfQo=\n","encoding":"base64"}

