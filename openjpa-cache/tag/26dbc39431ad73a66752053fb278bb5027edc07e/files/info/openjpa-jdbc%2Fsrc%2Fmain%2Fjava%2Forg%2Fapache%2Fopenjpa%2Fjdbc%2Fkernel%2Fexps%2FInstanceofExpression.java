{"sha":"43046164129a0e72deb6233208120b6851526037","node_id":"MDQ6QmxvYjIwNjM2NDo0MzA0NjE2NDEyOWEwZTcyZGViNjIzMzIwODEyMGI2ODUxNTI2MDM3","size":6198,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/43046164129a0e72deb6233208120b6851526037","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5EaXNjcmltaW5hdG9yOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdSZXBvc2l0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5z\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVz\nc2lvblZpc2l0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5K\nYXZhVHlwZXM7CgovKioKICogVGVzdHMgd2hldGhlciB0aGUgZ2l2ZW4gcGF0\naCBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgZ2l2ZW4gY2xhc3MuCiAqCiAqIEBh\ndXRob3IgQWJlIFdoaXRlCiAqLwpjbGFzcyBJbnN0YW5jZW9mRXhwcmVzc2lv\nbgogICAgaW1wbGVtZW50cyBFeHAgewoKICAgIHByaXZhdGUgZmluYWwgUENQ\nYXRoIF9wYXRoOwogICAgcHJpdmF0ZSBmaW5hbCBDbGFzcyBfY2xzOwoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0b3IuIFN1cHBseSBwYXRoIGFuZCBjbGFz\ncyB0byB0ZXN0IGZvci4KICAgICAqLwogICAgcHVibGljIEluc3RhbmNlb2ZF\neHByZXNzaW9uKFBDUGF0aCBwYXRoLCBDbGFzcyBjbHMpIHsKICAgICAgICBf\ncGF0aCA9IHBhdGg7CiAgICAgICAgX2NscyA9IGNsczsKICAgIH0KCiAgICBw\ndWJsaWMgRXhwU3RhdGUgaW5pdGlhbGl6ZShTZWxlY3Qgc2VsLCBFeHBDb250\nZXh0IGN0eCwgTWFwIGNvbnRhaW5zKSB7CiAgICAgICAgLy8gbm90ZSB0aGF0\nIHdlIHRlbGwgdGhlIHBhdGggdG8gZ28gYWhlYWQgYW5kIGpvaW4gdG8gaXRz\nIHJlbGF0ZWQKICAgICAgICAvLyBvYmplY3QgKGlmIGFueSkgaW4gb3JkZXIg\ndG8gYWNjZXNzIGl0cyBjbGFzcyBpbmRpY2F0b3IKICAgICAgICBFeHBTdGF0\nZSBwYXRoU3RhdGUgPSBfcGF0aC5pbml0aWFsaXplKHNlbCwgY3R4LCBWYWwu\nSk9JTl9SRUwpOwoKICAgICAgICAvLyBkb2VzIHRoaXMgcGF0aCByZXByZXNl\nbnQgYSByZWxhdGlvbj8gIGlmIG5vdCwgd2hhdCBjbGFzcwogICAgICAgIC8v\nIGlzIHRoZSBmaWVsZD8KICAgICAgICBDbGFzc01hcHBpbmcgcmVsTWFwcGlu\nZyA9IF9wYXRoLmdldENsYXNzTWFwcGluZyhwYXRoU3RhdGUpOwogICAgICAg\nIENsYXNzIHJlbCA9IG51bGw7CiAgICAgICAgaWYgKHJlbE1hcHBpbmcgPT0g\nbnVsbCkgewogICAgICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQgPSBfcGF0\naC5nZXRGaWVsZE1hcHBpbmcocGF0aFN0YXRlKTsKICAgICAgICAgICAgc3dp\ndGNoIChmaWVsZC5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgaWYgKF9w\nYXRoLmlzS2V5KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbCA9IGZp\nZWxkLmdldEtleSgpLmdldERlY2xhcmVkVHlwZSgpOwogICAgICAgICAgICAg\nICAgICAgIC8vIG5vIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNP\nTExFQ1RJT046CiAgICAgICAgICAgICAgICAgICAgcmVsID0gZmllbGQuZ2V0\nRWxlbWVudCgpLmdldERlY2xhcmVkVHlwZSgpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAg\nICAgICAgICAgICByZWwgPSBmaWVsZC5nZXREZWNsYXJlZFR5cGUoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gZWxzZQogICAgICAgICAgICByZWwgPSBy\nZWxNYXBwaW5nLmdldERlc2NyaWJlZFR5cGUoKTsKCiAgICAgICAgLy8gaWYg\ndGhlIHBhdGggcmVwcmVzZW50cyBhIHJlbGF0aW9uLCBnZXQgaXRzIGNsYXNz\nIGluZGljYXRvciBhbmQKICAgICAgICAvLyBtYWtlIHN1cmUgaXQncyBqb2lu\nZWQgZG93biB0byBpdHMgYmFzZSB0eXBlCiAgICAgICAgRGlzY3JpbWluYXRv\nciBkaXNjcmltID0gKHJlbE1hcHBpbmcgPT0gbnVsbCAKICAgICAgICAgICAg\nfHwgIXJlbE1hcHBpbmcuZ2V0RGVzY3JpYmVkVHlwZSgpLmlzQXNzaWduYWJs\nZUZyb20oX2NscykpIAogICAgICAgICAgICA/IG51bGwgOiByZWxNYXBwaW5n\nLmdldERpc2NyaW1pbmF0b3IoKTsKICAgICAgICBDbGFzc01hcHBpbmcgbWFw\ncGluZyA9IG51bGw7CiAgICAgICAgSm9pbnMgam9pbnMgPSBwYXRoU3RhdGUu\nam9pbnM7CiAgICAgICAgaWYgKGRpc2NyaW0gIT0gbnVsbCkgewogICAgICAg\nICAgICAvLyBjYWNoZSBtYXBwaW5nIGZvciBjYXN0CiAgICAgICAgICAgIE1h\ncHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gY3R4LnN0b3JlLmdldENvbmZpZ3Vy\nYXRpb24oKS4KICAgICAgICAgICAgICAgIGdldE1hcHBpbmdSZXBvc2l0b3J5\nSW5zdGFuY2UoKTsKICAgICAgICAgICAgbWFwcGluZyA9IHJlcG9zLmdldE1h\ncHBpbmcoX2NscywgY3R4LnN0b3JlLmdldENvbnRleHQoKS4KICAgICAgICAg\nICAgICAgIGdldENsYXNzTG9hZGVyKCksIGZhbHNlKTsKCiAgICAgICAgICAg\nIC8vIGlmIG5vdCBsb29raW5nIGZvciBhIFBDLCBkb24ndCBib3RoZXIgd2l0\naCBpbmRpY2F0b3IKICAgICAgICAgICAgaWYgKG1hcHBpbmcgPT0gbnVsbCB8\nfCAhZGlzY3JpbS5oYXNDbGFzc0NvbmRpdGlvbnMobWFwcGluZywgdHJ1ZSkp\nCiAgICAgICAgICAgICAgICBkaXNjcmltID0gbnVsbDsKICAgICAgICAgICAg\nZWxzZSB7CiAgICAgICAgICAgICAgICBDbGFzc01hcHBpbmcgb3duZXIgPSBk\naXNjcmltLmdldENsYXNzTWFwcGluZygpOwogICAgICAgICAgICAgICAgQ2xh\nc3NNYXBwaW5nIGZyb20sIHRvOwogICAgICAgICAgICAgICAgaWYgKHJlbE1h\ncHBpbmcuZ2V0RGVzY3JpYmVkVHlwZSgpLmlzQXNzaWduYWJsZUZyb20KICAg\nICAgICAgICAgICAgICAgICAob3duZXIuZ2V0RGVzY3JpYmVkVHlwZSgpKSkg\newogICAgICAgICAgICAgICAgICAgIGZyb20gPSBvd25lcjsKICAgICAgICAg\nICAgICAgICAgICB0byA9IHJlbE1hcHBpbmc7CiAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGZyb20gPSByZWxNYXBwaW5n\nOwogICAgICAgICAgICAgICAgICAgIHRvID0gb3duZXI7CiAgICAgICAgICAg\nICAgICB9CgogICAgICAgICAgICAgICAgZm9yICg7IGZyb20gIT0gbnVsbCAm\nJiBmcm9tICE9IHRvOwogICAgICAgICAgICAgICAgICAgIGZyb20gPSBmcm9t\nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpKQogICAgICAgICAg\nICAgICAgICAgIGpvaW5zID0gZnJvbS5qb2luU3VwZXJjbGFzcyhqb2lucywg\nZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBuZXcgSW5zdGFuY2VvZkV4cFN0YXRlKGpvaW5zLCBwYXRoU3RhdGUsIG1h\ncHBpbmcsIGRpc2NyaW0sIHJlbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBF\neHByZXNzaW9uIHN0YXRlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBj\nbGFzcyBJbnN0YW5jZW9mRXhwU3RhdGUKICAgICAgICBleHRlbmRzIEV4cFN0\nYXRlIHsKCiAgICAgICAgcHVibGljIGZpbmFsIEV4cFN0YXRlIHBhdGhTdGF0\nZTsKICAgICAgICBwdWJsaWMgZmluYWwgQ2xhc3NNYXBwaW5nIG1hcHBpbmc7\nCiAgICAgICAgcHVibGljIGZpbmFsIERpc2NyaW1pbmF0b3IgZGlzY3JpbTsK\nICAgICAgICBwdWJsaWMgZmluYWwgQ2xhc3MgcmVsOwoKICAgICAgICBwdWJs\naWMgSW5zdGFuY2VvZkV4cFN0YXRlKEpvaW5zIGpvaW5zLCBFeHBTdGF0ZSBw\nYXRoU3RhdGUsIAogICAgICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZywg\nRGlzY3JpbWluYXRvciBkaXNjcmltLCBDbGFzcyByZWwpIHsKICAgICAgICAg\nICAgc3VwZXIoam9pbnMpOwogICAgICAgICAgICB0aGlzLnBhdGhTdGF0ZSA9\nIHBhdGhTdGF0ZTsKICAgICAgICAgICAgdGhpcy5tYXBwaW5nID0gbWFwcGlu\nZzsKICAgICAgICAgICAgdGhpcy5kaXNjcmltID0gZGlzY3JpbTsKICAgICAg\nICAgICAgdGhpcy5yZWwgPSByZWw7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGFwcGVuZFRvKFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4\nLCBFeHBTdGF0ZSBzdGF0ZSwgCiAgICAgICAgU1FMQnVmZmVyIHNxbCkgewog\nICAgICAgIC8vIGlmIG5vIGNsYXNzIGluZGljYXRvciBvciBhIGZpbmFsIGNs\nYXNzLCBqdXN0IGFwcGVuZCB0cnVlIG9yIGZhbHNlCiAgICAgICAgLy8gZGVw\nZW5kaW5nIG9uIHdoZXRoZXIgdGhlIGNhc3QgbWF0Y2hlcyB0aGUgZXhwZWN0\nZWQgdHlwZQogICAgICAgIEluc3RhbmNlb2ZFeHBTdGF0ZSBpc3RhdGUgPSAo\nSW5zdGFuY2VvZkV4cFN0YXRlKSBzdGF0ZTsKICAgICAgICBpZiAoaXN0YXRl\nLmRpc2NyaW0gPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoX2Nscy5pc0Fz\nc2lnbmFibGVGcm9tKGlzdGF0ZS5yZWwpKQogICAgICAgICAgICAgICAgc3Fs\nLmFwcGVuZCgiMSA9IDEiKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgc3FsLmFwcGVuZCgiMSA8PiAxIik7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgY3R4LnN0b3JlLmxvYWRTdWJjbGFzc2VzKGlzdGF0ZS5k\naXNjcmltLmdldENsYXNzTWFwcGluZygpKTsKICAgICAgICAgICAgU1FMQnVm\nZmVyIGJ1ZiA9IGlzdGF0ZS5kaXNjcmltLmdldENsYXNzQ29uZGl0aW9ucyhz\nZWwsCiAgICAgICAgICAgICAgICBpc3RhdGUuam9pbnMsIGlzdGF0ZS5tYXBw\naW5nLCB0cnVlKTsKICAgICAgICAgICAgc3FsLmFwcGVuZChidWYpOwogICAg\nICAgIH0KICAgICAgICBzZWwuYXBwZW5kKHNxbCwgaXN0YXRlLmpvaW5zKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3RDb2x1bW5zKFNlbGVjdCBz\nZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0ZSwgCiAgICAgICAg\nYm9vbGVhbiBwa3MpIHsKICAgICAgICBJbnN0YW5jZW9mRXhwU3RhdGUgaXN0\nYXRlID0gKEluc3RhbmNlb2ZFeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgaWYg\nKGlzdGF0ZS5kaXNjcmltICE9IG51bGwpCiAgICAgICAgICAgIHNlbC5zZWxl\nY3QoaXN0YXRlLmRpc2NyaW0uZ2V0Q29sdW1ucygpLCBpc3RhdGUuam9pbnMp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KEV4cHJlc3Np\nb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICB2aXNpdG9yLmVudGVyKHRo\naXMpOwogICAgICAgIF9wYXRoLmFjY2VwdFZpc2l0KHZpc2l0b3IpOwogICAg\nICAgIHZpc2l0b3IuZXhpdCh0aGlzKTsKICAgIH0KfQoK\n","encoding":"base64"}

