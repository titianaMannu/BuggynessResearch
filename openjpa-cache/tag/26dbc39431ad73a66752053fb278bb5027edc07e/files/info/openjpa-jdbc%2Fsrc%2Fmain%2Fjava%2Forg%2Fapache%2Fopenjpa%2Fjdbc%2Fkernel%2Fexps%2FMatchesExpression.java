{"sha":"977cc60c29cc85c231250e3fdc6b8e0239610036","node_id":"MDQ6QmxvYjIwNjM2NDo5NzdjYzYwYzI5Y2M4NWMyMzEyNTBlM2ZkYzZiOGUwMjM5NjEwMDM2","size":5579,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/977cc60c29cc85c231250e3fdc6b8e0239610036","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuU1FMQnVmZmVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlNlbGVjdDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uVmlzaXRvcjsKaW1wb3J0IHNl\ncnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIFRlc3QgaWYgYSBzdHJpbmcgbWF0\nY2hlcyBhIHJlZ2V4cC4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCmNs\nYXNzIE1hdGNoZXNFeHByZXNzaW9uCiAgICBpbXBsZW1lbnRzIEV4cCB7Cgog\nICAgcHJpdmF0ZSBmaW5hbCBWYWwgX3ZhbDsKICAgIHByaXZhdGUgZmluYWwg\nQ29uc3QgX2NvbnN0OwogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX3Npbmds\nZTsKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIF9tdWx0aTsKICAgIHByaXZh\ndGUgZmluYWwgU3RyaW5nIF9lc2NhcGU7CgogICAgLyoqCiAgICAgKiBDb25z\ndHJ1Y3Rvci4gU3VwcGx5IHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIE1h\ndGNoZXNFeHByZXNzaW9uKFZhbCB2YWwsIENvbnN0IGNvbiwKICAgICAgICBT\ndHJpbmcgc2luZ2xlLCBTdHJpbmcgbXVsdGksIFN0cmluZyBlc2NhcGUpIHsK\nICAgICAgICBfdmFsID0gdmFsOwogICAgICAgIF9jb25zdCA9IGNvbjsKICAg\nICAgICBfc2luZ2xlID0gc2luZ2xlOwogICAgICAgIF9tdWx0aSA9IG11bHRp\nOwogICAgICAgIF9lc2NhcGUgPSBlc2NhcGU7CiAgICB9CgogICAgcHVibGlj\nIEV4cFN0YXRlIGluaXRpYWxpemUoU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBj\ndHgsIE1hcCBjb250YWlucykgewogICAgICAgIEV4cFN0YXRlIHMxID0gX3Zh\nbC5pbml0aWFsaXplKHNlbCwgY3R4LCAwKTsKICAgICAgICBFeHBTdGF0ZSBz\nMiA9IF9jb25zdC5pbml0aWFsaXplKHNlbCwgY3R4LCAwKTsKICAgICAgICBy\nZXR1cm4gbmV3IEJpbmFyeU9wRXhwU3RhdGUoc2VsLmFuZChzMS5qb2lucywg\nczIuam9pbnMpLCBzMSwgczIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFw\ncGVuZFRvKFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBz\ndGF0ZSwgCiAgICAgICAgU1FMQnVmZmVyIGJ1ZikgewogICAgICAgIEJpbmFy\neU9wRXhwU3RhdGUgYnN0YXRlID0gKEJpbmFyeU9wRXhwU3RhdGUpIHN0YXRl\nOwogICAgICAgIF92YWwuY2FsY3VsYXRlVmFsdWUoc2VsLCBjdHgsIGJzdGF0\nZS5zdGF0ZTEsIF9jb25zdCwgYnN0YXRlLnN0YXRlMik7CiAgICAgICAgX2Nv\nbnN0LmNhbGN1bGF0ZVZhbHVlKHNlbCwgY3R4LCBic3RhdGUuc3RhdGUyLCBf\ndmFsLCBic3RhdGUuc3RhdGUxKTsKCiAgICAgICAgQ29sdW1uIGNvbCA9IG51\nbGw7CiAgICAgICAgaWYgKF92YWwgaW5zdGFuY2VvZiBQQ1BhdGgpIHsKICAg\nICAgICAgICAgQ29sdW1uW10gY29scyA9ICgoUENQYXRoKSBfdmFsKS5nZXRD\nb2x1bW5zKGJzdGF0ZS5zdGF0ZTEpOwogICAgICAgICAgICBpZiAoY29scy5s\nZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgIGNvbCA9IGNvbHNbMF07CiAg\nICAgICAgfQoKICAgICAgICBPYmplY3QgbyA9IF9jb25zdC5nZXRWYWx1ZShj\ndHgsIGJzdGF0ZS5zdGF0ZTIpOwogICAgICAgIGlmIChvID09IG51bGwpCiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoIjEgPD4gMSIpOwogICAgICAgIGVsc2Ug\newogICAgICAgICAgICAvLyBsb29rIGZvciBpZ25vcmUgY2FzZSBmbGFnIGFu\nZCBzdHJpcCBpdCBvdXQgaWYgcHJlc2VudAogICAgICAgICAgICBib29sZWFu\nIGlnbm9yZUNhc2UgPSBmYWxzZTsKICAgICAgICAgICAgU3RyaW5nIHN0ciA9\nIG8udG9TdHJpbmcoKTsKICAgICAgICAgICAgaW50IGlkeCA9IHN0ci5pbmRl\neE9mKCIoP2kpIik7CiAgICAgICAgICAgIGlmIChpZHggIT0gLTEpIHsKICAg\nICAgICAgICAgICAgIGlnbm9yZUNhc2UgPSB0cnVlOwogICAgICAgICAgICAg\nICAgaWYgKGlkeCArIDQgPCBzdHIubGVuZ3RoKCkpCiAgICAgICAgICAgICAg\nICAgICAgc3RyID0gc3RyLnN1YnN0cmluZygwLCBpZHgpICsgc3RyLnN1YnN0\ncmluZyhpZHggKyA0KTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDAsIGlkeCk7CiAgICAg\nICAgICAgICAgICBzdHIgPSBzdHIudG9Mb3dlckNhc2UoKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgLy8gYXBwZW5kIHRhcmdldAogICAgICAgICAg\nICBpZiAoaWdub3JlQ2FzZSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIkxPV0VSKCIpOwogICAgICAgICAgICBfdmFsLmFwcGVuZFRvKHNlbCwgY3R4\nLCBic3RhdGUuc3RhdGUxLCBidWYsIDApOwogICAgICAgICAgICBpZiAoaWdu\nb3JlQ2FzZSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIikiKTsKCiAg\nICAgICAgICAgIC8vIGNyZWF0ZSBhIERCIHdpbGRjYXJkIHN0cmluZyBieSBy\nZXBsYWNpbmcgdGhlCiAgICAgICAgICAgIC8vIG11bHRpIHRva2VuIChlLmcu\nLCAnLionKSBhbmQgdGhlIHNpbmdsZSB0b2tlbiAoZS5nLiwgIi4iKQogICAg\nICAgICAgICAvLyB3aXRoICclJyBhbmQgJy4nIHdpdGggJ18nCiAgICAgICAg\nICAgIHN0ciA9IHJlcGxhY2VFc2NhcGUoc3RyLCBfbXVsdGksICIlIiwgX2Vz\nY2FwZSk7CiAgICAgICAgICAgIHN0ciA9IHJlcGxhY2VFc2NhcGUoc3RyLCBf\nc2luZ2xlLCAiXyIsIF9lc2NhcGUpOwogICAgICAgICAgICBidWYuYXBwZW5k\nKCIgTElLRSAiKS5hcHBlbmRWYWx1ZShzdHIsIGNvbCk7CgogICAgICAgICAg\nICAvLyBlc2NhcGUgb3V0IGNoYXJhY3RlcnMgYnkgdXNpbmcgdGhlIGRhdGFi\nYXNlJ3MgZXNjYXBlIHNlcXVlbmNlCiAgICAgICAgICAgIGlmIChfZXNjYXBl\nICE9IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgRVNDQVBF\nICciKS5hcHBlbmQoX2VzY2FwZSkuYXBwZW5kKCInIik7CiAgICAgICAgfQog\nICAgICAgIHNlbC5hcHBlbmQoYnVmLCBzdGF0ZS5qb2lucyk7CiAgICB9Cgog\nICAgLyoqIAogICAgICogUGVyZm9ybSBhIHN0cmluZyByZXBsYWNlbWVudCB3\naXRoIHNpbXBsaXN0aWMgZXNjYXBlIGhhbmRpbmcuIAogICAgICogIAogICAg\nICogQHBhcmFtICBzdHIgICAgICB0aGUgc291cmNlIHN0cmluZwogICAgICog\nQHBhcmFtICBmcm9tICAgICB0aGUgc3RyaW5nIHRvIGZpbmQKICAgICAqIEBw\nYXJhbSAgdG8gICAgICAgdGhlIHN0cmluZyB0byByZXBsYWNlCiAgICAgKiBA\ncGFyYW0gIGVzY2FwZSAgIHRoZSBzdHJpbmcgdG8gdXNlIHRvIGVzY2FwZSBy\nZXBsYWNlbWVudAogICAgICogQHJldHVybiAgICAgICAgICB0aGUgcmVwbGFj\nZWQgc3RyaW5nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBy\nZXBsYWNlRXNjYXBlKFN0cmluZyBzdHIsIFN0cmluZyBmcm9tLCBTdHJpbmcg\ndG8sCiAgICAgICAgU3RyaW5nIGVzY2FwZSkgewogICAgICAgIFN0cmluZ1td\nIHBhcnRzID0gU3RyaW5ncy5zcGxpdChzdHIsIGZyb20sIEludGVnZXIuTUFY\nX1ZBTFVFKTsKICAgICAgICBTdHJpbmdCdWZmZXIgcmVwYnVmID0gbmV3IFN0\ncmluZ0J1ZmZlcigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGFy\ndHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGkgPiAwKSB7CiAg\nICAgICAgICAgICAgICAvLyBpZiB0aGUgcHJldmlvdXMgcGFydCBlbmRlZCB3\naXRoIGFuIGVzY2FwZSBjaGFyYWN0ZXIsIHRoZW4KICAgICAgICAgICAgICAg\nIC8vIGVzY2FwZSB0aGUgY2hhcmFjdGVyIGFuZCByZW1vdmUgdGhlIHByZXZp\nb3VzIGVzY2FwZTsKICAgICAgICAgICAgICAgIC8vIHRoaXMgZG9lc24ndCBz\ndXBwb3J0IGFueSBkb3VibGUtZXNjYXBpbmcgb3Igb3RoZXIgbW9yZQogICAg\nICAgICAgICAgICAgLy8gc29waGlzdGljYXRlZCBmZWF0dXJlcwogICAgICAg\nICAgICAgICAgaWYgKCFmcm9tLmVxdWFscyh0bykgJiYgcGFydHNbaSAtIDFd\nLmVuZHNXaXRoKGVzY2FwZSkpIHsKICAgICAgICAgICAgICAgICAgICByZXBi\ndWYuc2V0TGVuZ3RoKHJlcGJ1Zi5sZW5ndGgoKSAtIDEpOwogICAgICAgICAg\nICAgICAgICAgIHJlcGJ1Zi5hcHBlbmQoZnJvbSk7CiAgICAgICAgICAgICAg\nICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICByZXBidWYuYXBwZW5kKHRv\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXBidWYuYXBwZW5kKHBh\ncnRzW2ldKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlcGJ1Zi50b1N0\ncmluZygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNlbGVjdENvbHVtbnMo\nU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAK\nICAgICAgICBib29sZWFuIHBrcykgewogICAgICAgIEJpbmFyeU9wRXhwU3Rh\ndGUgYnN0YXRlID0gKEJpbmFyeU9wRXhwU3RhdGUpIHN0YXRlOwogICAgICAg\nIF92YWwuc2VsZWN0Q29sdW1ucyhzZWwsIGN0eCwgYnN0YXRlLnN0YXRlMSwg\ndHJ1ZSk7CiAgICAgICAgX2NvbnN0LnNlbGVjdENvbHVtbnMoc2VsLCBjdHgs\nIGJzdGF0ZS5zdGF0ZTIsIHRydWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFjY2VwdFZpc2l0KEV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAg\nICAgICB2aXNpdG9yLmVudGVyKHRoaXMpOwogICAgICAgIF92YWwuYWNjZXB0\nVmlzaXQodmlzaXRvcik7CiAgICAgICAgX2NvbnN0LmFjY2VwdFZpc2l0KHZp\nc2l0b3IpOwogICAgICAgIHZpc2l0b3IuZXhpdCh0aGlzKTsKICAgIH0KfQo=\n","encoding":"base64"}

