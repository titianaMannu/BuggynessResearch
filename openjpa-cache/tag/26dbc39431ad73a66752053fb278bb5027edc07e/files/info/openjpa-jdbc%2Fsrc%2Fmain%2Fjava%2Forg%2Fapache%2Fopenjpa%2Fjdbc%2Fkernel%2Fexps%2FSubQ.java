{"sha":"dcdb1510c09304a01ca5a911dc1884fd88f86bae","node_id":"MDQ6QmxvYjIwNjM2NDpkY2RiMTUxMGMwOTMwNGEwMWNhNWE5MTFkYzE4ODRmZDg4Zjg2YmFl","size":6772,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dcdb1510c09304a01ca5a911dc1884fd88f86bae","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNz\nTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nSmF2YVNRTFR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc3FsLlJlc3VsdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNx\nbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\ncWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5G\naWx0ZXJzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBz\nLkV4cHJlc3Npb25WaXNpdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5leHBzLlF1ZXJ5RXhwcmVzc2lvbnM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuU3VicXVlcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwoKLyoqCiAqIEEg\nc3VicXVlcnkuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpjbGFzcyBT\ndWJRCiAgICBleHRlbmRzIEFic3RyYWN0VmFsCiAgICBpbXBsZW1lbnRzIFN1\nYnF1ZXJ5IHsKCiAgICBwcml2YXRlIGZpbmFsIENsYXNzTWFwcGluZyBfY2Fu\nZGlkYXRlOwogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9zdWJzOwogICAg\ncHJpdmF0ZSBmaW5hbCBTdHJpbmcgX2FsaWFzOwogICAgcHJpdmF0ZSBmaW5h\nbCBTZWxlY3RDb25zdHJ1Y3RvciBfY29ucyA9IG5ldyBTZWxlY3RDb25zdHJ1\nY3RvcigpOwoKICAgIHByaXZhdGUgQ2xhc3MgX3R5cGUgPSBudWxsOwogICAg\ncHJpdmF0ZSBDbGFzc01ldGFEYXRhIF9tZXRhID0gbnVsbDsKICAgIHByaXZh\ndGUgUXVlcnlFeHByZXNzaW9ucyBfZXhwcyA9IG51bGw7CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNhbmRpZGF0ZSwgd2hldGhlciBz\ndWJjbGFzc2VzIGFyZSBpbmNsdWRlZCBpbgogICAgICogdGhlIHF1ZXJ5LCBh\nbmQgdGhlIHF1ZXJ5IGFsaWFzLgogICAgICovCiAgICBwdWJsaWMgU3ViUShD\nbGFzc01hcHBpbmcgY2FuZGlkYXRlLCBib29sZWFuIHN1YnMsIFN0cmluZyBh\nbGlhcykgewogICAgICAgIF9jYW5kaWRhdGUgPSBjYW5kaWRhdGU7CiAgICAg\nICAgX3N1YnMgPSBzdWJzOwogICAgICAgIF9hbGlhcyA9IGFsaWFzOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzdWJxdWVyeSBjYW5kaWRh\ndGUgdHlwZS4KICAgICAqLwogICAgcHVibGljIENsYXNzTWFwcGluZyBnZXRD\nYW5kaWRhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9jYW5kaWRhdGU7CiAgICB9\nCgogICAgcHVibGljIENsYXNzIGdldFR5cGUoKSB7CiAgICAgICAgaWYgKF9l\neHBzICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9leHBzLnByb2plY3Rp\nb25zLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgcmV0dXJuIF9jYW5k\naWRhdGUuZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAgICAgICBpZiAoX2V4\ncHMucHJvamVjdGlvbnMubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gX2V4cHMucHJvamVjdGlvbnNbMF0uZ2V0VHlwZSgpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gX3R5cGU7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0SW1wbGljaXRUeXBlKENsYXNzIHR5cGUpIHsKICAgICAgICBpZiAo\nX2V4cHMgIT0gbnVsbCAmJiBfZXhwcy5wcm9qZWN0aW9ucy5sZW5ndGggPT0g\nMSkKICAgICAgICAgICAgX2V4cHMucHJvamVjdGlvbnNbMF0uc2V0SW1wbGlj\naXRUeXBlKHR5cGUpOwogICAgICAgIF90eXBlID0gdHlwZTsKICAgIH0KCiAg\nICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXRNZXRhRGF0YSgpIHsKICAgICAg\nICByZXR1cm4gX21ldGE7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TWV0\nYURhdGEoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgX21ldGEgPSBt\nZXRhOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q2FuZGlkYXRlQWxp\nYXMoKSB7CiAgICAgICAgcmV0dXJuIF9hbGlhczsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRRdWVyeUV4cHJlc3Npb25zKFF1ZXJ5RXhwcmVzc2lvbnMg\ncXVlcnkpIHsKICAgICAgICBfZXhwcyA9IHF1ZXJ5OwogICAgfQoKICAgIHB1\nYmxpYyBFeHBTdGF0ZSBpbml0aWFsaXplKFNlbGVjdCBzZWwsIEV4cENvbnRl\neHQgY3R4LCBpbnQgZmxhZ3MpIHsKICAgICAgICBpZiAoX2V4cHMucHJvamVj\ndGlvbnMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIHJldHVybiAoKFZhbCkg\nX2V4cHMucHJvamVjdGlvbnNbMF0pLmluaXRpYWxpemUoc2VsLCBjdHgsIGZs\nYWdzKTsKICAgICAgICByZXR1cm4gRXhwU3RhdGUuTlVMTDsKICAgIH0KCiAg\nICBwdWJsaWMgT2JqZWN0IHRvRGF0YVN0b3JlVmFsdWUoU2VsZWN0IHNlbCwg\nRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAgICBPYmpl\nY3QgdmFsKSB7CiAgICAgICAgaWYgKF9leHBzLnByb2plY3Rpb25zLmxlbmd0\naCA9PSAwKQogICAgICAgICAgICByZXR1cm4gX2NhbmRpZGF0ZS50b0RhdGFT\ndG9yZVZhbHVlKHZhbCwKICAgICAgICAgICAgICAgIF9jYW5kaWRhdGUuZ2V0\nUHJpbWFyeUtleUNvbHVtbnMoKSwgY3R4LnN0b3JlKTsKICAgICAgICBpZiAo\nX2V4cHMucHJvamVjdGlvbnMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIHJl\ndHVybiAoKFZhbCkgX2V4cHMucHJvamVjdGlvbnNbMF0pLnRvRGF0YVN0b3Jl\nVmFsdWUoc2VsLCBjdHgsIAogICAgICAgICAgICAgICAgc3RhdGUsIHZhbCk7\nCiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZWxlY3QoU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0\nYXRlLCAKICAgICAgICBib29sZWFuIHBrcykgewogICAgICAgIHNlbGVjdENv\nbHVtbnMoc2VsLCBjdHgsIHN0YXRlLCBwa3MpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNlbGVjdENvbHVtbnMoU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBj\ndHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAgICBib29sZWFuIHBrcykgewog\nICAgICAgIHNlbC5zZWxlY3QobmV3U1FMQnVmZmVyKHNlbCwgY3R4LCBzdGF0\nZSksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoU2Vs\nZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlKSB7CiAg\nICAgICAgc2VsLmdyb3VwQnkobmV3U1FMQnVmZmVyKHNlbCwgY3R4LCBzdGF0\nZSkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG9yZGVyQnkoU2VsZWN0IHNl\nbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAgICBi\nb29sZWFuIGFzYykgewogICAgICAgIHNlbC5vcmRlckJ5KG5ld1NRTEJ1ZmZl\ncihzZWwsIGN0eCwgc3RhdGUpLCBhc2MsIGZhbHNlKTsKICAgIH0KCiAgICBw\ncml2YXRlIFNRTEJ1ZmZlciBuZXdTUUxCdWZmZXIoU2VsZWN0IHNlbCwgRXhw\nQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlKSB7CiAgICAgICAgU1FMQnVm\nZmVyIGJ1ZiA9IG5ldyBTUUxCdWZmZXIoY3R4LnN0b3JlLmdldERCRGljdGlv\nbmFyeSgpKTsKICAgICAgICBhcHBlbmRUbyhzZWwsIGN0eCwgc3RhdGUsIGJ1\nZiwgMCk7CiAgICAgICAgcmV0dXJuIGJ1ZjsKICAgIH0KCiAgICBwdWJsaWMg\nT2JqZWN0IGxvYWQoRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCBS\nZXN1bHQgcmVzKSAKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICByZXR1cm4gRmlsdGVycy5jb252ZXJ0KHJlcy5nZXRPYmplY3QodGhp\ncywKICAgICAgICAgICAgSmF2YVNRTFR5cGVzLkpEQkNfREVGQVVMVCwgbnVs\nbCksIGdldFR5cGUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2FsY3Vs\nYXRlVmFsdWUoU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRl\nIHN0YXRlLCAKICAgICAgICBWYWwgb3RoZXIsIEV4cFN0YXRlIG90aGVyU3Rh\ndGUpIHsKICAgIH0KCiAgICBwdWJsaWMgaW50IGxlbmd0aChTZWxlY3Qgc2Vs\nLCBFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUpIHsKICAgICAgICBy\nZXR1cm4gMTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRUbyhTZWxl\nY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAg\nICAgIFNRTEJ1ZmZlciBzcWwsIGludCBpbmRleCkgewogICAgICAgIGFwcGVu\nZFRvKHNlbCwgY3R4LCBzdGF0ZSwgc3FsLCBpbmRleCwgZmFsc2UpOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBhcHBlbmRUbyhTZWxlY3Qgc2VsLCBFeHBD\nb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIFNRTEJ1ZmZl\nciBzcWwsIGludCBpbmRleCwgYm9vbGVhbiBzaXplKSB7CiAgICAgICAgUXVl\ncnlFeHByZXNzaW9uc1N0YXRlIHN1YnN0YXRlID0gbmV3IFF1ZXJ5RXhwcmVz\nc2lvbnNTdGF0ZSgpOwogICAgICAgIFNlbGVjdCBzdWIgPSBfY29ucy5ldmFs\ndWF0ZShjdHgsIHNlbCwgX2FsaWFzLCBfZXhwcywgc3Vic3RhdGUpOwogICAg\nICAgIF9jb25zLnNlbGVjdChzdWIsIGN0eCwgX2NhbmRpZGF0ZSwgX3N1YnMs\nIF9leHBzLCBzdWJzdGF0ZSwgCiAgICAgICAgICAgIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24uRUFHRVJfTk9ORSk7CgogICAgICAgIGlmIChzaXplKQogICAg\nICAgICAgICBzcWwuYXBwZW5kQ291bnQoc3ViLCBjdHguZmV0Y2gpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgc3FsLmFwcGVuZChzdWIsIGN0eC5mZXRj\naCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5kSXNFbXB0eShTZWxl\nY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAg\nICAgIFNRTEJ1ZmZlciBzcWwpIHsKICAgICAgICBzcWwuYXBwZW5kKCJOT1Qg\nRVhJU1RTICIpOwogICAgICAgIGFwcGVuZFRvKHNlbCwgY3R4LCBzdGF0ZSwg\nc3FsLCAwKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRJc05vdEVt\ncHR5KFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0\nZSwgCiAgICAgICAgU1FMQnVmZmVyIHNxbCkgewogICAgICAgIHNxbC5hcHBl\nbmQoIkVYSVNUUyAiKTsKICAgICAgICBhcHBlbmRUbyhzZWwsIGN0eCwgc3Rh\ndGUsIHNxbCwgMCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5kU2l6\nZShTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUs\nIAogICAgICAgIFNRTEJ1ZmZlciBzcWwpIHsKICAgICAgICBhcHBlbmRUbyhz\nZWwsIGN0eCwgc3RhdGUsIHNxbCwgMCwgdHJ1ZSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgYWNjZXB0VmlzaXQoRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRv\ncikgewogICAgICAgIHZpc2l0b3IuZW50ZXIodGhpcyk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBfZXhwcy5wcm9qZWN0aW9ucy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgX2V4cHMucHJvamVjdGlvbnNbaV0uYWNjZXB0Vmlz\naXQodmlzaXRvcik7CiAgICAgICAgaWYgKF9leHBzLmZpbHRlciAhPSBudWxs\nKQogICAgICAgICAgICBfZXhwcy5maWx0ZXIuYWNjZXB0VmlzaXQodmlzaXRv\ncik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZXhwcy5ncm91cGlu\nZy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgX2V4cHMuZ3JvdXBpbmdbaV0u\nYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAgaWYgKF9leHBzLmhhdmlu\nZyAhPSBudWxsKQogICAgICAgICAgICBfZXhwcy5oYXZpbmcuYWNjZXB0Vmlz\naXQodmlzaXRvcik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZXhw\ncy5vcmRlcmluZy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgX2V4cHMub3Jk\nZXJpbmdbaV0uYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAgdmlzaXRv\nci5leGl0KHRoaXMpOwogICAgfQp9Cg==\n","encoding":"base64"}

