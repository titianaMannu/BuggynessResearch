{"sha":"2ad836c0d6031865c47f8a60e73171efb4803a4b","node_id":"MDQ6QmxvYjIwNjM2NDoyYWQ4MzZjMGQ2MDMxODY1YzQ3ZjhhNjBlNzMxNzFlZmI0ODAzYTRi","size":6140,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2ad836c0d6031865c47f8a60e73171efb4803a4b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwoKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZURpc2NyaW1pbmF0b3JT\ndHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nc3RyYXRzLlN1cGVyY2xhc3NEaXNjcmltaW5hdG9yU3RyYXRlZ3k7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5WYWx1ZU1h\ncERpc2NyaW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hR3JvdXA7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogSW5m\nb3JtYXRpb24gYWJvdXQgdGhlIG1hcHBpbmcgZnJvbSBhIGRpc2NyaW1pbmF0\nb3IgdG8gdGhlIHNjaGVtYSwgaW4KICogcmF3IGZvcm0uIFRoZSBjb2x1bW5z\nIGFuZCB0YWJsZXMgdXNlZCBpbiBtYXBwaW5nIGluZm8gd2lsbCBub3QgYmUg\ncGFydCBvZgogKiB0aGUge0BsaW5rIFNjaGVtYUdyb3VwfSB1c2VkIGF0IHJ1\nbnRpbWUuIFJhdGhlciwgdGhleSB3aWxsIGJlIHN0cnVjdHMKICogd2l0aCB0\naGUgcmVsZXZhbnQgcGllY2VzIG9mIGluZm9ybWF0aW9uIGZpbGxlZCBpbi4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBEaXNj\ncmltaW5hdG9yTWFwcGluZ0luZm8KICAgIGV4dGVuZHMgTWFwcGluZ0luZm8g\newoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0g\nTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoRGlzY3JpbWluYXRvck1h\ncHBpbmdJbmZvLmNsYXNzKTsKCiAgICBwcml2YXRlIFN0cmluZyBfdmFsdWUg\nPSBudWxsOwogICAgCiAgICAvKioKICAgICAqIFJhdyBkaXNjcmltaW5hdG9y\nIHZhbHVlIHN0cmluZy4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRW\nYWx1ZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbHVlOwogICAgfQoKICAgIC8q\nKgogICAgICogUmF3IGRpc2NyaW1pbmF0b3IgdmFsdWUgc3RyaW5nLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1ZShTdHJpbmcgdmFsdWUpIHsK\nICAgICAgICBfdmFsdWUgPSB2YWx1ZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgZGlzY3JpbWluYXRvciB2YWx1ZSBhcyBhbiBvYmplY3Qg\nb2YgdGhlIHJpZ2h0IHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0VmFsdWUoRGlzY3JpbWluYXRvciBkaXNjcmltLCBib29sZWFuIGFkYXB0\nKSB7CiAgICAgICAgaWYgKGRpc2NyaW0uZ2V0VmFsdWUoKSAhPSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gZGlzY3JpbS5nZXRWYWx1ZSgpOwogICAgICAg\nIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KF92YWx1ZSkpIHsKICAgICAgICAg\nICAgcmV0dXJuIGRpc2NyaW0uZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5nZXRN\nYXBwaW5nRGVmYXVsdHMoKS4KICAgICAgICAgICAgICAgIGdldERpc2NyaW1p\nbmF0b3JWYWx1ZShkaXNjcmltLCBhZGFwdCk7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIHN3aXRjaChkaXNjcmltLmdldEphdmFUeXBlKCkpIHsgCiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVDoKICAgICAgICAgICAgICAg\nIHJldHVybiBJbnRlZ2VyLnZhbHVlT2YoX3ZhbHVlKTsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQ0hBUjoKICAgICAgICAgICAgICAgcmV0dXJuIG5l\ndyBDaGFyYWN0ZXIoX3ZhbHVlLmNoYXJBdChfdmFsdWUuaW5kZXhPZignXCcn\nKSsxKSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoKICAg\nICAgICAgICAgZGVmYXVsdDogCiAgICAgICAgICAgICAgICByZXR1cm4gX3Zh\nbHVlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgY29sdW1ucyBzZXQgZm9yIHRoaXMgZGlzY3JpbWluYXRvciwgYmFzZWQg\nb24gdGhlIGdpdmVuCiAgICAgKiB0ZW1wbGF0ZXMuCiAgICAgKi8KICAgIHB1\nYmxpYyBDb2x1bW5bXSBnZXRDb2x1bW5zKERpc2NyaW1pbmF0b3IgZGlzY3Jp\nbSwgQ29sdW1uW10gdG1wbGF0ZXMsCiAgICAgICAgYm9vbGVhbiBhZGFwdCkg\newogICAgICAgIFRhYmxlIHRhYmxlID0gZGlzY3JpbS5nZXRDbGFzc01hcHBp\nbmcoKS5nZXRUYWJsZSgpOwogICAgICAgIGRpc2NyaW0uZ2V0TWFwcGluZ1Jl\ncG9zaXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMoKS5wb3B1bGF0ZUNvbHVt\nbnMKICAgICAgICAgICAgKGRpc2NyaW0sIHRhYmxlLCB0bXBsYXRlcyk7CiAg\nICAgICAgcmV0dXJuIGNyZWF0ZUNvbHVtbnMoZGlzY3JpbSwgbnVsbCwgdG1w\nbGF0ZXMsIHRhYmxlLCBhZGFwdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGluZGV4IHRvIHNldCBvbiB0aGUgZGlzY3JpbWluYXRvciBj\nb2x1bW5zLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBJ\nbmRleCBnZXRJbmRleChEaXNjcmltaW5hdG9yIGRpc2NyaW0sIENvbHVtbltd\nIGNvbHMsIGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICBJbmRleCBpZHggPSBu\ndWxsOwogICAgICAgIGlmIChjb2xzLmxlbmd0aCA+IDApCiAgICAgICAgICAg\nIGlkeCA9IGRpc2NyaW0uZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5nZXRNYXBw\naW5nRGVmYXVsdHMoKS4KICAgICAgICAgICAgICAgIGdldEluZGV4KGRpc2Ny\naW0sIGNvbHNbMF0uZ2V0VGFibGUoKSwgY29scyk7CiAgICAgICAgcmV0dXJu\nIGNyZWF0ZUluZGV4KGRpc2NyaW0sIG51bGwsIGlkeCwgY29scywgYWRhcHQp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25pemUgaW50ZXJuYWwg\naW5mb3JtYXRpb24gd2l0aCB0aGUgbWFwcGluZyBkYXRhIGZvciB0aGUgZ2l2\nZW4KICAgICAqIGRpc2NyaW1pbmF0b3IuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHN5bmNXaXRoKERpc2NyaW1pbmF0b3IgZGlzYykgewogICAgICAgIGNs\nZWFyKGZhbHNlKTsKCiAgICAgICAgLy8gc2V0IGlvIGJlZm9yZSBzeW5jaW5n\nIGNvbHMKICAgICAgICBzZXRDb2x1bW5JTyhkaXNjLmdldENvbHVtbklPKCkp\nOwogICAgICAgIHN5bmNDb2x1bW5zKGRpc2MsIGRpc2MuZ2V0Q29sdW1ucygp\nLCBkaXNjLmdldFZhbHVlKCkgIT0gbnVsbAogICAgICAgICAgICAmJiAhKGRp\nc2MuZ2V0VmFsdWUoKSBpbnN0YW5jZW9mIFN0cmluZykpOwogICAgICAgIHN5\nbmNJbmRleChkaXNjLCBkaXNjLmdldEluZGV4KCkpOwogICAgICAgIGlmIChk\naXNjLmdldFZhbHVlKCkgPT0gRGlzY3JpbWluYXRvci5OVUxMKQogICAgICAg\nICAgICBfdmFsdWUgPSAibnVsbCI7CiAgICAgICAgZWxzZSBpZiAoZGlzYy5n\nZXRWYWx1ZSgpICE9IG51bGwpCiAgICAgICAgICAgIF92YWx1ZSA9IGRpc2Mu\nZ2V0VmFsdWUoKS50b1N0cmluZygpOwoKICAgICAgICBpZiAoZGlzYy5nZXRT\ndHJhdGVneSgpID09IG51bGwKICAgICAgICAgICAgfHwgZGlzYy5nZXRTdHJh\ndGVneSgpIGluc3RhbmNlb2YgU3VwZXJjbGFzc0Rpc2NyaW1pbmF0b3JTdHJh\ndGVneSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBleHBsaWNp\ndCBkaXNjcmltaW5hdG9yIHN0cmF0ZWd5IGlmOgogICAgICAgIC8vIC0gdW5t\nYXBwZWQgY2xhc3MgYW5kIGRpc2NyaW1pbmF0b3IgaXMgbWFwcGVkCiAgICAg\nICAgLy8gLSBmaW5hbCBiYXNlIGNsYXNzIGFuZCBkaXNjcmltaW5hdG9yIGlz\nIG1hcHBlZAogICAgICAgIC8vIC0gdGFibGUtcGVyLWNsYXNzIHN1YmNsYXNz\nIGFuZCBkaXNjcmltaW5hdG9yIGlzIG1hcHBlZAogICAgICAgIC8vIC0gbWFw\ncGVkIHN1YmNsYXNzIGFuZCBkb2Vzbid0IHJlbHkgb24gc3VwZXJjbGFzcyBk\naXNjcmltaW5hdG9yCiAgICAgICAgLy8gLSBtYXBwZWQgYmFzZSBjbGFzcyBh\nbmQgZG9lc24ndCB1c2UgdmFsdWUtbWFwIHN0cmF0ZWd5IHdpdGggdmFsdWUK\nICAgICAgICAvLyAgIGFuZCBpc24ndCBhIGZpbmFsIGNsYXNzIHRoYXQgdXNl\ncyB0aGUgZmluYWwgc3RyYXRlZ3kKICAgICAgICBDbGFzc01hcHBpbmcgY2xz\nID0gZGlzYy5nZXRDbGFzc01hcHBpbmcoKTsKICAgICAgICBTdHJpbmcgc3Ry\nYXQgPSBkaXNjLmdldFN0cmF0ZWd5KCkuZ2V0QWxpYXMoKTsKICAgICAgICBi\nb29sZWFuIHN5bmMgPSBmYWxzZTsKCiAgICAgICAgaWYgKCFjbHMuaXNNYXBw\nZWQoKQogICAgICAgICAgICB8fCAoY2xzLmdldEpvaW5hYmxlUENTdXBlcmNs\nYXNzTWFwcGluZygpICE9IG51bGwKICAgICAgICAgICAgJiYgTW9kaWZpZXIu\naXNGaW5hbChjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE1vZGlmaWVycygp\nKSkKICAgICAgICAgICAgfHwgKGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFz\nc01hcHBpbmcoKSA9PSBudWxsCiAgICAgICAgICAgICYmIGNscy5nZXRNYXBw\nZWRQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbCkpCiAgICAgICAgICAg\nIHN5bmMgPSAhTm9uZURpc2NyaW1pbmF0b3JTdHJhdGVneS5BTElBUy5lcXVh\nbHMoc3RyYXQpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc3luYyA9IGNs\ncy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBudWxsCiAg\nICAgICAgICAgICAgICB8fCBfdmFsdWUgPT0gbnVsbAogICAgICAgICAgICAg\nICAgfHwgIVZhbHVlTWFwRGlzY3JpbWluYXRvclN0cmF0ZWd5LkFMSUFTLmVx\ndWFscyhzdHJhdCk7CgogICAgICAgIGlmIChzeW5jKQogICAgICAgICAgICBz\nZXRTdHJhdGVneShzdHJhdCk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nY2xlYXIoYm9vbGVhbiBjYW5GbGFncykgewogICAgICAgIHN1cGVyLmNsZWFy\nKGNhbkZsYWdzKTsKICAgICAgICBfdmFsdWUgPSBudWxsOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGNvcHkoTWFwcGluZ0luZm8gaW5mbykgewogICAgICAg\nIHN1cGVyLmNvcHkoaW5mbyk7CiAgICAgICAgaWYgKCEoaW5mbyBpbnN0YW5j\nZW9mIERpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbykpCiAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgaWYgKF92YWx1ZSA9PSBudWxsKQogICAgICAgICAg\nICBfdmFsdWUgPSAoKERpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbykgaW5mbyku\nZ2V0VmFsdWUoKTsKICAgIH0KfQo=\n","encoding":"base64"}

