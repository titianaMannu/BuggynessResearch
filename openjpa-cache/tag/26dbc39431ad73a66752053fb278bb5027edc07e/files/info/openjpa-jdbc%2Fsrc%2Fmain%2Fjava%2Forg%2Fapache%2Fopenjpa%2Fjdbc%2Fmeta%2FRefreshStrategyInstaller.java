{"sha":"5c5edff2657983d69e124c2a0556895c3d4b818d","node_id":"MDQ6QmxvYjIwNjM2NDo1YzVlZGZmMjY1Nzk4M2Q2OWUxMjRjMmEwNTU2ODk1YzNkNGI4MThk","size":4922,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5c5edff2657983d69e124c2a0556895c3d4b818d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlvbjsK\nCi8qKgogKiBBdHRlbXB0cyB0byBpbnN0YWxsIHVzaW5nIHRoZSBnaXZlbiBt\nYXBwaW5nIGluZm9ybWF0aW9uLiBJZiB0aGF0CiAqIGZhaWxzLCBjbGVhcnMg\ndGhlIG1hcHBpbmcgaW5mb3JtYXRpb24gYW5kIGNvbnN0cnVjdHMgbmV3IG1h\ncHBpbmdzLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9j\nCiAqIEBzaW5jZSAwLjQuMAogKi8KcHVibGljIGNsYXNzIFJlZnJlc2hTdHJh\ndGVneUluc3RhbGxlcgogICAgZXh0ZW5kcyBTdHJhdGVneUluc3RhbGxlciB7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChSZWZyZXNoU3RyYXRlZ3lJ\nbnN0YWxsZXIuY2xhc3MpOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7\nIHN1cHBseSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgUmVm\ncmVzaFN0cmF0ZWd5SW5zdGFsbGVyKE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nKSB7CiAgICAgICAgc3VwZXIocmVwb3MpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzQWRhcHRpbmcoKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgaW5zdGFsbFN0cmF0ZWd5KENsYXNzTWFw\ncGluZyBjbHMpIHsKICAgICAgICBDbGFzc1N0cmF0ZWd5IHN0cmF0ID0gcmVw\nb3MubmFtZWRTdHJhdGVneShjbHMpOwogICAgICAgIGlmIChzdHJhdCA9PSBu\ndWxsKQogICAgICAgICAgICBzdHJhdCA9IHJlcG9zLmRlZmF1bHRTdHJhdGVn\neShjbHMsIHRydWUpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNscy5z\nZXRTdHJhdGVneShzdHJhdCwgQm9vbGVhbi5UUlVFKTsKICAgICAgICB9IGNh\ndGNoIChNZXRhRGF0YUV4Y2VwdGlvbiBtZGUpIHsKICAgICAgICAgICAgLy8g\naWYgdGhpcyBpcyBhIGN1c3RvbSBzdHJhdGVneSwgZG9uJ3QgYXR0ZW1wdCB0\nbyBvdmVycmlkZQogICAgICAgICAgICBpZiAoaXNDdXN0b21TdHJhdGVneShz\ndHJhdCkpCiAgICAgICAgICAgICAgICB0aHJvdyBtZGU7CgogICAgICAgICAg\nICByZXBvcy5nZXRMb2coKS53YXJuKF9sb2MuZ2V0KCJmYXRhbC1jaGFuZ2Ui\nLCBjbHMsCiAgICAgICAgICAgICAgICBtZGUuZ2V0TWVzc2FnZSgpKSk7CiAg\nICAgICAgICAgIGNscy5jbGVhck1hcHBpbmcoKTsKICAgICAgICAgICAgY2xz\nLnNldFN0cmF0ZWd5KHJlcG9zLmRlZmF1bHRTdHJhdGVneShjbHMsIHRydWUp\nLCBCb29sZWFuLlRSVUUpOwogICAgICAgIH0KICAgICAgICBjbHMuc2V0U291\ncmNlTW9kZShjbHMuTU9ERV9NQVBQSU5HLCB0cnVlKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBpbnN0YWxsU3RyYXRlZ3koRmllbGRNYXBwaW5nIGZpZWxk\nKSB7CiAgICAgICAgRmllbGRTdHJhdGVneSBzdHJhdGVneSA9IHJlcG9zLm5h\nbWVkU3RyYXRlZ3koZmllbGQsIHRydWUpOwogICAgICAgIGlmIChzdHJhdGVn\neSA9PSBudWxsKQogICAgICAgICAgICBzdHJhdGVneSA9IHJlcG9zLmRlZmF1\nbHRTdHJhdGVneShmaWVsZCwgdHJ1ZSwgdHJ1ZSk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgZmllbGQuc2V0U3RyYXRlZ3koc3RyYXRlZ3ksIEJvb2xl\nYW4uVFJVRSk7CiAgICAgICAgfSBjYXRjaCAoTWV0YURhdGFFeGNlcHRpb24g\nbWRlKSB7CiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBjdXN0b20gc3Ry\nYXRlZ3ksIGRvbid0IG92ZXJyaWRlCiAgICAgICAgICAgIGlmIChpc0N1c3Rv\nbVN0cmF0ZWd5KHN0cmF0ZWd5KSkKICAgICAgICAgICAgICAgIHRocm93IG1k\nZTsKCiAgICAgICAgICAgIHJlcG9zLmdldExvZygpLndhcm4oX2xvYy5nZXQo\nImZhdGFsLWNoYW5nZSIsIGZpZWxkLAogICAgICAgICAgICAgICAgbWRlLmdl\ndE1lc3NhZ2UoKSkpOwogICAgICAgICAgICBmaWVsZC5jbGVhck1hcHBpbmco\nKTsKICAgICAgICAgICAgZmllbGQuc2V0SGFuZGxlcihudWxsKTsKICAgICAg\nICAgICAgZmllbGQuZ2V0S2V5TWFwcGluZygpLnNldEhhbmRsZXIobnVsbCk7\nCiAgICAgICAgICAgIGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCkuc2V0SGFu\nZGxlcihudWxsKTsKICAgICAgICAgICAgZmllbGQuc2V0U3RyYXRlZ3kocmVw\nb3MuZGVmYXVsdFN0cmF0ZWd5KGZpZWxkLCB0cnVlLCB0cnVlKSwKICAgICAg\nICAgICAgICAgIEJvb2xlYW4uVFJVRSk7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShWZXJzaW9uIHZlcnNpb24p\nIHsKICAgICAgICBWZXJzaW9uU3RyYXRlZ3kgc3RyYXQgPSByZXBvcy5uYW1l\nZFN0cmF0ZWd5KHZlcnNpb24pOwogICAgICAgIGlmIChzdHJhdCA9PSBudWxs\nKQogICAgICAgICAgICBzdHJhdCA9IHJlcG9zLmRlZmF1bHRTdHJhdGVneSh2\nZXJzaW9uLCB0cnVlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB2ZXJz\naW9uLnNldFN0cmF0ZWd5KHN0cmF0LCBCb29sZWFuLlRSVUUpOwogICAgICAg\nIH0gY2F0Y2ggKE1ldGFEYXRhRXhjZXB0aW9uIG1kZSkgewogICAgICAgICAg\nICAvLyBpZiB0aGlzIGlzIGEgY3VzdG9tIHN0cmF0ZWd5LCBkb24ndCBhdHRl\nbXB0IHRvIG92ZXJyaWRlCiAgICAgICAgICAgIGlmIChpc0N1c3RvbVN0cmF0\nZWd5KHN0cmF0KSkKICAgICAgICAgICAgICAgIHRocm93IG1kZTsKCiAgICAg\nICAgICAgIHJlcG9zLmdldExvZygpLndhcm4oX2xvYy5nZXQoImZhdGFsLWNo\nYW5nZSIsIHZlcnNpb24sCiAgICAgICAgICAgICAgICBtZGUuZ2V0TWVzc2Fn\nZSgpKSk7CiAgICAgICAgICAgIHZlcnNpb24uY2xlYXJNYXBwaW5nKCk7CiAg\nICAgICAgICAgIHZlcnNpb24uc2V0U3RyYXRlZ3kocmVwb3MuZGVmYXVsdFN0\ncmF0ZWd5KHZlcnNpb24sIHRydWUpLAogICAgICAgICAgICAgICAgQm9vbGVh\nbi5UUlVFKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5z\ndGFsbFN0cmF0ZWd5KERpc2NyaW1pbmF0b3IgZGlzY3JpbSkgewogICAgICAg\nIERpc2NyaW1pbmF0b3JTdHJhdGVneSBzdHJhdCA9IHJlcG9zLm5hbWVkU3Ry\nYXRlZ3koZGlzY3JpbSk7CiAgICAgICAgaWYgKHN0cmF0ID09IG51bGwpCiAg\nICAgICAgICAgIHN0cmF0ID0gcmVwb3MuZGVmYXVsdFN0cmF0ZWd5KGRpc2Ny\naW0sIHRydWUpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGRpc2NyaW0u\nc2V0U3RyYXRlZ3koc3RyYXQsIEJvb2xlYW4uVFJVRSk7CiAgICAgICAgfSBj\nYXRjaCAoTWV0YURhdGFFeGNlcHRpb24gbWRlKSB7CiAgICAgICAgICAgIC8v\nIGlmIHRoaXMgaXMgYSBjdXN0b20gc3RyYXRlZ3ksIGRvbid0IGF0dGVtcHQg\ndG8gb3ZlcnJpZGUKICAgICAgICAgICAgaWYgKGlzQ3VzdG9tU3RyYXRlZ3ko\nc3RyYXQpKQogICAgICAgICAgICAgICAgdGhyb3cgbWRlOwoKICAgICAgICAg\nICAgcmVwb3MuZ2V0TG9nKCkud2FybihfbG9jLmdldCgiZmF0YWwtY2hhbmdl\nIiwgZGlzY3JpbSwKICAgICAgICAgICAgICAgIG1kZS5nZXRNZXNzYWdlKCkp\nKTsKCiAgICAgICAgICAgIC8vIHJldGFpbiBvbGQgZGlzY3JpbWluYXRvciB2\nZXJzaW9uLCBpZiBhbnkKICAgICAgICAgICAgU3RyaW5nIHZhbCA9IGRpc2Ny\naW0uZ2V0TWFwcGluZ0luZm8oKS5nZXRWYWx1ZSgpOwogICAgICAgICAgICBk\naXNjcmltLmNsZWFyTWFwcGluZygpOwogICAgICAgICAgICBkaXNjcmltLmdl\ndE1hcHBpbmdJbmZvKCkuc2V0VmFsdWUodmFsKTsKICAgICAgICAgICAgZGlz\nY3JpbS5zZXRTdHJhdGVneShyZXBvcy5kZWZhdWx0U3RyYXRlZ3koZGlzY3Jp\nbSwgdHJ1ZSksCiAgICAgICAgICAgICAgICBCb29sZWFuLlRSVUUpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRo\nZSBnaXZlbiBzdHJhdGVneSBpcyBub3QgYSBidWlsdC1pbiB0eXBlLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGlzQ3VzdG9tU3RyYXRl\nZ3koU3RyYXRlZ3kgc3RyYXQpIHsKICAgICAgICByZXR1cm4gIXN0cmF0Lmdl\ndENsYXNzKCkuZ2V0TmFtZSgpLnN0YXJ0c1dpdGgoIm9yZy5hcGFjaGUub3Bl\nbmpwYS4iKTsKICAgIH0KfQo=\n","encoding":"base64"}

