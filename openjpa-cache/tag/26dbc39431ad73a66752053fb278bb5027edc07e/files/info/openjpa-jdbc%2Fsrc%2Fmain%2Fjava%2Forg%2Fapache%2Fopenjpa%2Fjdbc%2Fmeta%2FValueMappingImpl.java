{"sha":"17f396bb30c16603a7b0ffd9f7092a41687dbff5","node_id":"MDQ6QmxvYjIwNjM2NDoxN2YzOTZiYjMwYzE2NjAzYTdiMGZmZDlmNzA5MmE0MTY4N2RiZmY1","size":17558,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/17f396bb30c16603a7b0ffd9f7092a41687dbff5","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNo\nTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbklPOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5VbmlxdWU7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5WYWx1ZU1ldGFEYXRhSW1wbDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFF\neGNlcHRpb247CgovKioKICogU3RhbmRhbG9uZSB7QGxpbmsgVmFsdWVNYXBw\naW5nfSBpbXBsZW1lbnRhdGlvbi4KICoKICogQGF1dGhvciBBYmUgV2hpdGUK\nICogQHNpbmNlIDAuNC4wCiAqLwpwdWJsaWMgY2xhc3MgVmFsdWVNYXBwaW5n\nSW1wbAogICAgZXh0ZW5kcyBWYWx1ZU1ldGFEYXRhSW1wbAogICAgaW1wbGVt\nZW50cyBWYWx1ZU1hcHBpbmcgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAg\nICAoVmFsdWVNYXBwaW5nSW1wbC5jbGFzcyk7CgogICAgcHJpdmF0ZSBWYWx1\nZU1hcHBpbmdJbmZvIF9pbmZvOwogICAgcHJpdmF0ZSBWYWx1ZUhhbmRsZXIg\nX2hhbmRsZXIgPSBudWxsOwogICAgcHJpdmF0ZSBDbGFzc01hcHBpbmdbXSBf\ndHlwZUFyciA9IG51bGw7CgogICAgcHJpdmF0ZSBDb2x1bW5bXSBfY29scyA9\nIFNjaGVtYXMuRU1QVFlfQ09MVU1OUzsKICAgIHByaXZhdGUgQ29sdW1uSU8g\nX2lvID0gbnVsbDsKICAgIHByaXZhdGUgRm9yZWlnbktleSBfZmsgPSBudWxs\nOwogICAgcHJpdmF0ZSBNYXAgX3RhcmdldEZLcyA9IG51bGw7CiAgICBwcml2\nYXRlIEluZGV4IF9pZHggPSBudWxsOwogICAgcHJpdmF0ZSBVbmlxdWUgX3Vu\ncSA9IG51bGw7CiAgICBwcml2YXRlIGludCBfam9pbiA9IEpPSU5fRk9SV0FS\nRDsKICAgIHByaXZhdGUgYm9vbGVhbiBfY3JpdGVyaWEgPSBmYWxzZTsKICAg\nIHByaXZhdGUgaW50IF9wb2x5ID0gUE9MWV9UUlVFOwoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3IuIFN1cHBseSBvd25pbmcgbWFwcGluZy4KICAgICAq\nLwogICAgcHVibGljIFZhbHVlTWFwcGluZ0ltcGwoRmllbGRNYXBwaW5nIG93\nbmVyKSB7CiAgICAgICAgc3VwZXIob3duZXIpOwogICAgICAgIF9pbmZvID0g\nb3duZXIuZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5uZXdNYXBwaW5nSW5mbyh0\naGlzKTsKICAgICAgICBfaW5mby5zZXRVc2VDbGFzc0NyaXRlcmlhKG93bmVy\nLmdldE1hcHBpbmdSZXBvc2l0b3J5KCkuCiAgICAgICAgICAgIGdldE1hcHBp\nbmdEZWZhdWx0cygpLnVzZUNsYXNzQ3JpdGVyaWEoKSk7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogQ29uc3RydWN0b3IgZm9yIGRlc2VyaWFsaXphdGlv\nbi4KICAgICAqLwogICAgcHJvdGVjdGVkIFZhbHVlTWFwcGluZ0ltcGwoKSB7\nCiAgICAgICAgc3VwZXIoKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWVNYXBw\naW5nSW5mbyBnZXRWYWx1ZUluZm8oKSB7CiAgICAgICAgcmV0dXJuIF9pbmZv\nOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZUhhbmRsZXIgZ2V0SGFuZGxlcigp\nIHsKICAgICAgICByZXR1cm4gX2hhbmRsZXI7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0SGFuZGxlcihWYWx1ZUhhbmRsZXIgaGFuZGxlcikgewogICAg\nICAgIF9oYW5kbGVyID0gaGFuZGxlcjsKICAgIH0KCiAgICBwdWJsaWMgTWFw\ncGluZ1JlcG9zaXRvcnkgZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKSB7CiAgICAg\nICAgcmV0dXJuIChNYXBwaW5nUmVwb3NpdG9yeSkgZ2V0UmVwb3NpdG9yeSgp\nOwogICAgfQoKICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgZ2V0RmllbGRNYXBw\naW5nKCkgewogICAgICAgIHJldHVybiAoRmllbGRNYXBwaW5nKSBnZXRGaWVs\nZE1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzTWFwcGluZyBn\nZXRUeXBlTWFwcGluZygpIHsKICAgICAgICByZXR1cm4gKENsYXNzTWFwcGlu\nZykgZ2V0VHlwZU1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIENsYXNz\nTWFwcGluZyBnZXREZWNsYXJlZFR5cGVNYXBwaW5nKCkgewogICAgICAgIHJl\ndHVybiAoQ2xhc3NNYXBwaW5nKSBnZXREZWNsYXJlZFR5cGVNZXRhRGF0YSgp\nOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01hcHBpbmcgZ2V0RW1iZWRkZWRN\nYXBwaW5nKCkgewogICAgICAgIHJldHVybiAoQ2xhc3NNYXBwaW5nKSBnZXRF\nbWJlZGRlZE1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIEZpZWxkTWFw\ncGluZyBnZXRWYWx1ZU1hcHBlZEJ5TWFwcGluZygpIHsKICAgICAgICByZXR1\ncm4gKEZpZWxkTWFwcGluZykgZ2V0VmFsdWVNYXBwZWRCeU1ldGFEYXRhKCk7\nCiAgICB9CgogICAgcHVibGljIENvbHVtbltdIGdldENvbHVtbnMoKSB7CiAg\nICAgICAgaWYgKF9jb2xzLmxlbmd0aCAhPSAwKQogICAgICAgICAgICByZXR1\ncm4gX2NvbHM7CiAgICAgICAgaWYgKF9mayAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gX2ZrLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoZ2V0VmFs\ndWVNYXBwZWRCeSgpICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBnZXRW\nYWx1ZU1hcHBlZEJ5TWFwcGluZygpLmdldENvbHVtbnMoKTsKICAgICAgICBy\nZXR1cm4gX2NvbHM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29sdW1u\ncyhDb2x1bW5bXSBjb2xzKSB7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVsbCkK\nICAgICAgICAgICAgY29scyA9IFNjaGVtYXMuRU1QVFlfQ09MVU1OUzsKICAg\nICAgICBfY29scyA9IGNvbHM7CiAgICB9CgogICAgcHVibGljIENvbHVtbklP\nIGdldENvbHVtbklPKCkgewogICAgICAgIGlmIChfY29scy5sZW5ndGggPT0g\nMCAmJiBfZmsgPT0gbnVsbCAmJiBnZXRWYWx1ZU1hcHBlZEJ5KCkgIT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIGdldFZhbHVlTWFwcGVkQnlNYXBwaW5n\nKCkuZ2V0Q29sdW1uSU8oKTsKICAgICAgICByZXR1cm4gKF9pbyA9PSBudWxs\nKSA/IENvbHVtbklPLlVOUkVTVFJJQ1RFRCA6IF9pbzsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRDb2x1bW5JTyhDb2x1bW5JTyBpbykgewogICAgICAg\nIF9pbyA9IGlvOwogICAgfQoKICAgIHB1YmxpYyBGb3JlaWduS2V5IGdldEZv\ncmVpZ25LZXkoKSB7CiAgICAgICAgaWYgKF9mayA9PSBudWxsICYmIGdldFZh\nbHVlTWFwcGVkQnkoKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZ2V0\nVmFsdWVNYXBwZWRCeU1hcHBpbmcoKS5nZXRGb3JlaWduS2V5KCk7CiAgICAg\nICAgcmV0dXJuIF9mazsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRGb3Jl\naWduS2V5KEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBfZmsgPSBmazsKICAg\nICAgICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgX2pvaW4gPSBKT0lO\nX0ZPUldBUkQ7CiAgICB9CgogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0Rm9y\nZWlnbktleShDbGFzc01hcHBpbmcgdGFyZ2V0KSB7CiAgICAgICAgaWYgKF9m\nayA9PSBudWxsICYmIGdldFZhbHVlTWFwcGVkQnkoKSAhPSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gZ2V0VmFsdWVNYXBwZWRCeU1hcHBpbmcoKS5nZXRG\nb3JlaWduS2V5KHRhcmdldCk7CiAgICAgICAgaWYgKHRhcmdldCA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gX2ZrOwogICAgICAgIGlmIChfZmsgPT0g\nbnVsbCAmJiBfY29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIC8vIGFsd2F5cyB1c2UgbGVhc3QtZGVyaXZlZCBq\nb2luYWJsZSB0eXBlCiAgICAgICAgZm9yIChDbGFzc01hcHBpbmcgc3VwID0g\ndGFyZ2V0OyBzdXAgIT0gbnVsbDsKICAgICAgICAgICAgc3VwID0gc3VwLmdl\ndEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpKSB7CiAgICAgICAgICAg\nIGlmIChzdXAgPT0gZ2V0VHlwZU1ldGFEYXRhKCkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gX2ZrOwogICAgICAgICAgICB0YXJnZXQgPSBzdXA7CiAgICAg\nICAgfQoKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAg\nICAgaWYgKF90YXJnZXRGS3MgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nT2JqZWN0IGNhY2hlZEZLID0gX3RhcmdldEZLcy5nZXQodGFyZ2V0KTsKICAg\nICAgICAgICAgICAgIGlmIChjYWNoZWRGSyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiAoRm9yZWlnbktleSkgY2FjaGVkRks7CiAgICAg\nICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgX3RhcmdldEZLcyA9IG5l\ndyBIYXNoTWFwKCk7CgogICAgICAgICAgICBGb3JlaWduS2V5IG5ld2ZrID0g\nKF9qb2luID09IEpPSU5fRk9SV0FSRCkKICAgICAgICAgICAgICAgID8gbmV3\nRm9yd2FyZEZvcmVpZ25LZXkodGFyZ2V0KSA6IG5ld0ludmVyc2VGb3JlaWdu\nS2V5KHRhcmdldCk7CiAgICAgICAgICAgIF90YXJnZXRGS3MucHV0KHRhcmdl\ndCwgbmV3ZmspOwogICAgICAgICAgICByZXR1cm4gbmV3Zms7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgZm9yd2FyZCBmb3Jl\naWduIGtleSB0byB0aGUgZ2l2ZW4gdGFyZ2V0LgogICAgICovCiAgICBwcml2\nYXRlIEZvcmVpZ25LZXkgbmV3Rm9yd2FyZEZvcmVpZ25LZXkoQ2xhc3NNYXBw\naW5nIHRhcmdldCkgewogICAgICAgIFRhYmxlIHRhYmxlOwogICAgICAgIENv\nbHVtbltdIGNvbHM7CiAgICAgICAgaWYgKF9mayA9PSBudWxsKSB7CiAgICAg\nICAgICAgIHRhYmxlID0gX2NvbHNbMF0uZ2V0VGFibGUoKTsKICAgICAgICAg\nICAgY29scyA9IF9jb2xzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nIHRhYmxlID0gX2ZrLmdldFRhYmxlKCk7CiAgICAgICAgICAgIGNvbHMgPSBf\nZmsuZ2V0Q29sdW1ucygpOwogICAgICAgIH0KCiAgICAgICAgLy8gZ2F0aGVy\nIHRhcmdldCBjb2xzIGJlZm9yZSBhZGRpbmcgZm9yZWlnbiBrZXkgdG8gdGFi\nbGUgaW4gY2FzZQogICAgICAgIC8vIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxl\nIGxvb2tpbmcgZm9yIGEgdGFyZ2V0IGNvbAogICAgICAgIENvbHVtbltdIHRj\nb2xzID0gbmV3IENvbHVtbltjb2xzLmxlbmd0aF07CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nIGlmIChjb2xzW2ldLmdldFRhcmdldEZpZWxkKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHRjb2xzW2ldID0gZ2V0RXF1aXZhbGVudENvbHVtbihjb2xz\nW2ldLCB0YXJnZXQsCiAgICAgICAgICAgICAgICAgICAgY29sc1tpXS5nZXRU\nYXJnZXRGaWVsZCgpKTsKICAgICAgICAgICAgZWxzZSBpZiAoX2ZrICE9IG51\nbGwpCiAgICAgICAgICAgICAgICB0Y29sc1tpXSA9IGdldEVxdWl2YWxlbnRD\nb2x1bW4oX2ZrLmdldFByaW1hcnlLZXlDb2x1bW4KICAgICAgICAgICAgICAg\nICAgICAoY29sc1tpXSkuZ2V0TmFtZSgpLCB0YXJnZXQsIHRydWUpOwogICAg\nICAgICAgICBlbHNlIGlmIChjb2xzW2ldLmdldFRhcmdldCgpICE9IG51bGwp\nCiAgICAgICAgICAgICAgICB0Y29sc1tpXSA9IGdldEVxdWl2YWxlbnRDb2x1\nbW4oY29sc1tpXS5nZXRUYXJnZXQoKSwgdGFyZ2V0LAogICAgICAgICAgICAg\nICAgICAgIHRydWUpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICB0Y29sc1tpXSA9IGdldEVxdWl2YWxlbnRDb2x1bW4oY29sc1tpXS5nZXRO\nYW1lKCksIHRhcmdldCwKICAgICAgICAgICAgICAgICAgICBmYWxzZSk7CiAg\nICAgICAgfQoKICAgICAgICBGb3JlaWduS2V5IG5ld2ZrID0gdGFibGUuYWRk\nRm9yZWlnbktleSgpOwogICAgICAgIG5ld2ZrLnNldEpvaW5zKGNvbHMsIHRj\nb2xzKTsKICAgICAgICBpZiAoX2ZrICE9IG51bGwpIHsKICAgICAgICAgICAg\nY29scyA9IF9may5nZXRDb25zdGFudENvbHVtbnMoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgbmV3Zmsuam9pbkNvbnN0YW50KGNvbHNbaV0sIF9may5nZXRD\nb25zdGFudChjb2xzW2ldKSk7CgogICAgICAgICAgICBjb2xzID0gX2ZrLmdl\ndENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICAgICAgbmV3Zmsuam9pbkNvbnN0YW50KF9may5nZXRQcmltYXJ5S2V5Q29u\nc3RhbnQoY29sc1tpXSksCiAgICAgICAgICAgICAgICAgICAgZ2V0RXF1aXZh\nbGVudENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSwgdGFyZ2V0LCB0cnVlKSk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXdmazsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgZ2l2ZW4gbWFwcGluZydzIGVxdWl2YWxl\nbnQgdG8gdGhlIGdpdmVuIGNvbHVtbiwgdXNpbmcgdGhlCiAgICAgKiB0YXJn\nZXQgZmllbGQuCiAgICAgKi8KICAgIHByaXZhdGUgQ29sdW1uIGdldEVxdWl2\nYWxlbnRDb2x1bW4oQ29sdW1uIGNvbCwgQ2xhc3NNYXBwaW5nIHRhcmdldCwK\nICAgICAgICBTdHJpbmcgZmllbGROYW1lKSB7CiAgICAgICAgZmllbGROYW1l\nID0gZmllbGROYW1lLnN1YnN0cmluZyhmaWVsZE5hbWUuaW5kZXhPZignLicp\nICsgMSk7CiAgICAgICAgRmllbGRNYXBwaW5nIGZpZWxkID0gdGFyZ2V0Lmdl\ndEZpZWxkTWFwcGluZyhmaWVsZE5hbWUpOwogICAgICAgIGlmIChmaWVsZCA9\nPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRp\nb24oX2xvYy5nZXQoIm5vLWVxdWl2LWZpZWxkIiwKICAgICAgICAgICAgICAg\nIG5ldyBPYmplY3RbXXsgdGhpcywgdGFyZ2V0LCBmaWVsZE5hbWUsIGNvbCB9\nKSk7CgogICAgICAgIENvbHVtbltdIGNvbHMgPSBmaWVsZC5nZXRDb2x1bW5z\nKCk7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoICE9IDEpCiAgICAgICAgICAg\nIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWVx\ndWl2LWZpZWxkIiwKICAgICAgICAgICAgICAgIG5ldyBPYmplY3RbXXsgdGhp\ncywgdGFyZ2V0LCBmaWVsZE5hbWUsIGNvbCB9KSk7CgogICAgICAgIHJldHVy\nbiBjb2xzWzBdOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBn\naXZlbiBtYXBwaW5nJ3MgZXF1aXZhbGVudCBvZiB0aGUgZ2l2ZW4gY29sdW1u\nLgogICAgICovCiAgICBwcml2YXRlIENvbHVtbiBnZXRFcXVpdmFsZW50Q29s\ndW1uKFN0cmluZyBjb2xOYW1lLCBDbGFzc01hcHBpbmcgdGFyZ2V0LAogICAg\nICAgIGJvb2xlYW4gZXhwbGljaXQpIHsKICAgICAgICAvLyBpZiB0aGVyZSB3\nYXMgbm8gZXhwbGljaXQgdGFyZ2V0LCB1c2Ugc2luZ2xlIHBrIGNvbHVtbgog\nICAgICAgIGlmICghZXhwbGljaXQpIHsKICAgICAgICAgICAgZm9yIChDbGFz\nc01hcHBpbmcgY2xzID0gdGFyZ2V0OyBjbHMgIT0gbnVsbDsKICAgICAgICAg\nICAgICAgIGNscyA9IGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBp\nbmcoKSkgewogICAgICAgICAgICAgICAgaWYgKGNscy5nZXRUYWJsZSgpICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2xzLmdldFByaW1h\ncnlLZXlDb2x1bW5zKCkubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICAg\nICAgICAgIHJldHVybiBjbHMuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKVswXTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQ29sdW1uIHJldDsK\nICAgICAgICBmb3IgKENsYXNzTWFwcGluZyBjbHMgPSB0YXJnZXQ7IGNscyAh\nPSBudWxsOwogICAgICAgICAgICBjbHMgPSBjbHMuZ2V0Sm9pbmFibGVQQ1N1\ncGVyY2xhc3NNYXBwaW5nKCkpIHsKICAgICAgICAgICAgaWYgKGNscy5nZXRU\nYWJsZSgpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldCA9IGNscy5n\nZXRUYWJsZSgpLmdldENvbHVtbihjb2xOYW1lKTsKICAgICAgICAgICAgICAg\nIGlmIChyZXQgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\ncmV0OwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLWVxdWl2LWNvbCIs\nIHRoaXMsIHRhcmdldCwKICAgICAgICAgICAgY29sTmFtZSkpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIGFuIGludmVyc2UgZm9yZWlnbiBrZXkg\nZnJvbSB0aGUgZ2l2ZW4gcmVsYXRlZCB0eXBlIHRvIG91ciB0YWJsZS4KICAg\nICAqLwogICAgcHJpdmF0ZSBGb3JlaWduS2V5IG5ld0ludmVyc2VGb3JlaWdu\nS2V5KENsYXNzTWFwcGluZyB0YXJnZXQpIHsKICAgICAgICBGaWVsZE1hcHBp\nbmcgZmllbGQgPSBnZXRGaWVsZE1hcHBpbmcoKTsKICAgICAgICBGaWVsZE1h\ncHBpbmcgbWFwcGVkID0gZmllbGQuZ2V0TWFwcGVkQnlNYXBwaW5nKCk7CiAg\nICAgICAgaWYgKG1hcHBlZCA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImNhbnQtaW52ZXJzZSIs\nIHRoaXMpKTsKCiAgICAgICAgbWFwcGVkID0gdGFyZ2V0LmdldEZpZWxkTWFw\ncGluZyhtYXBwZWQuZ2V0SW5kZXgoKSk7CiAgICAgICAgaWYgKG1hcHBlZCA9\nPSBudWxsIHx8IG1hcHBlZC5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5Q\nQykKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJuby1lcXVpdi1tYXBwZWQtYnkiLAogICAgICAgICAgICAgICAg\ndGhpcywgdGFyZ2V0LCBmaWVsZC5nZXRNYXBwZWRCeSgpKSk7CiAgICAgICAg\ncmV0dXJuIG1hcHBlZC5nZXRGb3JlaWduS2V5KCk7CiAgICB9CgogICAgcHVi\nbGljIGludCBnZXRKb2luRGlyZWN0aW9uKCkgewogICAgICAgIGlmIChfZmsg\nPT0gbnVsbCAmJiBnZXRWYWx1ZU1hcHBlZEJ5KCkgIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIGdldFZhbHVlTWFwcGVkQnlNYXBwaW5nKCkuZ2V0Sm9p\nbkRpcmVjdGlvbigpOwogICAgICAgIHJldHVybiBfam9pbjsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRKb2luRGlyZWN0aW9uKGludCBkaXJlY3Rpb24p\nIHsKICAgICAgICBfam9pbiA9IGRpcmVjdGlvbjsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRGb3JlaWduS2V5KFJvdyByb3csIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgcmVsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIGlmIChyZWwgIT0gbnVsbCkKICAgICAgICAgICAgcm93LnNldEZvcmVp\nZ25LZXkoZ2V0Rm9yZWlnbktleSgoQ2xhc3NNYXBwaW5nKSByZWwuZ2V0TWV0\nYURhdGEoKSksCiAgICAgICAgICAgICAgICBfaW8sIHJlbCk7CiAgICAgICAg\nZWxzZSBpZiAoX2ZrICE9IG51bGwpCiAgICAgICAgICAgIHJvdy5zZXRGb3Jl\naWduS2V5KF9maywgX2lvLCBudWxsKTsKICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICAgICAgaWYgKF9pbyA9PSBudWxsIHx8IChyb3cuZ2V0\nQWN0aW9uKCkgPT0gUm93LkFDVElPTl9JTlNFUlQKICAgICAgICAgICAgICAg\nICAgICAmJiBfaW8uaXNJbnNlcnRhYmxlKGksIHRydWUpKQogICAgICAgICAg\nICAgICAgICAgIHx8IChyb3cuZ2V0QWN0aW9uKCkgIT0gUm93LkFDVElPTl9J\nTlNFUlQKICAgICAgICAgICAgICAgICAgICAmJiBfaW8uaXNVcGRhdGFibGUo\naSwgdHJ1ZSkpKQogICAgICAgICAgICAgICAgICAgIHJvdy5zZXROdWxsKF9j\nb2xzW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCB3aGVyZUZvcmVpZ25LZXkoUm93IHJvdywgT3BlbkpQQVN0\nYXRlTWFuYWdlciByZWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKHJlbCAhPSBudWxsKQogICAgICAgICAgICByb3cud2hl\ncmVGb3JlaWduS2V5KGdldEZvcmVpZ25LZXkoKENsYXNzTWFwcGluZykKICAg\nICAgICAgICAgICAgIHJlbC5nZXRNZXRhRGF0YSgpKSwgcmVsKTsKICAgICAg\nICBlbHNlIGlmIChfZmsgIT0gbnVsbCkKICAgICAgICAgICAgcm93LndoZXJl\nRm9yZWlnbktleShfZmssIG51bGwpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgICAgIHJvdy53aGVyZU51bGwoX2NvbHNbaV0pOwogICAgfQoK\nICAgIHB1YmxpYyBDbGFzc01hcHBpbmdbXSBnZXRJbmRlcGVuZGVudFR5cGVN\nYXBwaW5ncygpIHsKICAgICAgICBDbGFzc01hcHBpbmcgcmVsID0gZ2V0VHlw\nZU1hcHBpbmcoKTsKICAgICAgICBpZiAocmVsID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBDbGFzc01hcHBpbmcuRU1QVFlfTUFQUElOR1M7CiAgICAg\nICAgaWYgKF9wb2x5ICE9IFBPTFlfVFJVRSkgewogICAgICAgICAgICBpZiAo\nIXJlbC5pc01hcHBlZCgpKQogICAgICAgICAgICAgICAgcmV0dXJuIENsYXNz\nTWFwcGluZy5FTVBUWV9NQVBQSU5HUzsKICAgICAgICAgICAgaWYgKF90eXBl\nQXJyID09IG51bGwpCiAgICAgICAgICAgICAgICBfdHlwZUFyciA9IG5ldyBD\nbGFzc01hcHBpbmdbXXsgcmVsIH07CiAgICAgICAgICAgIHJldHVybiBfdHlw\nZUFycjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlbC5nZXRJbmRlcGVu\nZGVudEFzc2lnbmFibGVNYXBwaW5ncygpOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgZ2V0U2VsZWN0U3ViY2xhc3NlcygpIHsKICAgICAgICBDbGFzc01hcHBp\nbmcgcmVsID0gZ2V0VHlwZU1hcHBpbmcoKTsKICAgICAgICBpZiAocmVsID09\nIG51bGwgfHwgIXJlbC5pc01hcHBlZCgpKQogICAgICAgICAgICByZXR1cm4g\nLTE7CgogICAgICAgIHN3aXRjaCAoX3BvbHkpIHsKICAgICAgICAgICAgY2Fz\nZSBQT0xZX0ZBTFNFOgogICAgICAgICAgICAgICAgcmV0dXJuIChfY3JpdGVy\naWEpID8gU2VsZWN0LlNVQlNfTk9ORSA6IFNlbGVjdC5TVUJTX0VYQUNUOwog\nICAgICAgICAgICBjYXNlIFBPTFlfVFJVRToKICAgICAgICAgICAgICAgIENs\nYXNzTWFwcGluZ1tdIGFzc2lnbiA9IHJlbC5nZXRJbmRlcGVuZGVudEFzc2ln\nbmFibGVNYXBwaW5ncygpOwogICAgICAgICAgICAgICAgaWYgKGFzc2lnbi5s\nZW5ndGggIT0gMSB8fCBhc3NpZ25bMF0gIT0gcmVsKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgIC8vIG5vIGJyZWFr\nCiAgICAgICAgICAgIGNhc2UgUE9MWV9KT0lOQUJMRToKICAgICAgICAgICAg\nICAgIHJldHVybiAoX2NyaXRlcmlhKSA/IFNlbGVjdC5TVUJTX0pPSU5BQkxF\nCiAgICAgICAgICAgICAgICAgICAgOiBTZWxlY3QuU1VCU19BTllfSk9JTkFC\nTEU7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIFVuaXF1ZSBnZXRWYWx1ZVVuaXF1ZSgpIHsKICAgICAgICBy\nZXR1cm4gX3VucTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1ZVVu\naXF1ZShVbmlxdWUgdW5xKSB7CiAgICAgICAgX3VucSA9IHVucTsKICAgIH0K\nCiAgICBwdWJsaWMgSW5kZXggZ2V0VmFsdWVJbmRleCgpIHsKICAgICAgICBy\nZXR1cm4gX2lkeDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1ZUlu\nZGV4KEluZGV4IGlkeCkgewogICAgICAgIF9pZHggPSBpZHg7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gZ2V0VXNlQ2xhc3NDcml0ZXJpYSgpIHsKICAg\nICAgICBpZiAoX2ZrID09IG51bGwgJiYgZ2V0VmFsdWVNYXBwZWRCeSgpICE9\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBnZXRWYWx1ZU1hcHBlZEJ5TWFw\ncGluZygpLmdldFVzZUNsYXNzQ3JpdGVyaWEoKTsKICAgICAgICByZXR1cm4g\nX2NyaXRlcmlhOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVzZUNsYXNz\nQ3JpdGVyaWEoYm9vbGVhbiBjcml0ZXJpYSkgewogICAgICAgIF9jcml0ZXJp\nYSA9IGNyaXRlcmlhOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0UG9seW1v\ncnBoaWMoKSB7CiAgICAgICAgcmV0dXJuIF9wb2x5OwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldFBvbHltb3JwaGljKGludCBwb2x5KSB7CiAgICAgICAg\nX3BvbHkgPSBwb2x5OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZlNjaGVt\nYUNvbXBvbmVudHMoKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBf\nY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgX2NvbHNbaV0ucmVmKCk7\nCiAgICAgICAgaWYgKF9mayAhPSBudWxsKSB7CiAgICAgICAgICAgIF9may5y\nZWYoKTsKICAgICAgICAgICAgX2ZrLnJlZkNvbHVtbnMoKTsKICAgICAgICB9\nCgogICAgICAgIENsYXNzTWFwcGluZyBlbWJlZCA9IGdldEVtYmVkZGVkTWFw\ncGluZygpOwogICAgICAgIGlmIChlbWJlZCAhPSBudWxsKQogICAgICAgICAg\nICBlbWJlZC5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgbWFwQ29uc3RyYWludHMoU3RyaW5nIG5hbWUsIGJvb2xlYW4g\nYWRhcHQpIHsKICAgICAgICBfdW5xID0gX2luZm8uZ2V0VW5pcXVlKHRoaXMs\nIG5hbWUsIGFkYXB0KTsKICAgICAgICBfaWR4ID0gX2luZm8uZ2V0SW5kZXgo\ndGhpcywgbmFtZSwgYWRhcHQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNs\nZWFyTWFwcGluZygpIHsKICAgICAgICBfaGFuZGxlciA9IG51bGw7CiAgICAg\nICAgX2NvbHMgPSBTY2hlbWFzLkVNUFRZX0NPTFVNTlM7CiAgICAgICAgX3Vu\ncSA9IG51bGw7CiAgICAgICAgX2lkeCA9IG51bGw7CiAgICAgICAgX2ZrID0g\nbnVsbDsKICAgICAgICBfam9pbiA9IEpPSU5fRk9SV0FSRDsKICAgICAgICBf\naW5mby5jbGVhcigpOwogICAgICAgIHNldFJlc29sdmUoTU9ERV9NQVBQSU5H\nIHwgTU9ERV9NQVBQSU5HX0lOSVQsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzeW5jTWFwcGluZ0luZm8oKSB7CiAgICAgICAgaWYgKGdldFZh\nbHVlTWFwcGVkQnkoKSAhPSBudWxsKQogICAgICAgICAgICBfaW5mby5jbGVh\ncigpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBfaW5mby5zeW5jV2l0\naCh0aGlzKTsKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGVtYmVkID0gZ2V0\nRW1iZWRkZWRNYXBwaW5nKCk7CiAgICAgICAgICAgIGlmIChlbWJlZCAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgZW1iZWQuc3luY01hcHBpbmdJbmZvKCk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvcHlNYXBwaW5n\nSW5mbyhWYWx1ZU1hcHBpbmcgdm0pIHsKICAgICAgICBzZXRWYWx1ZU1hcHBl\nZEJ5KHZtLmdldFZhbHVlTWFwcGVkQnkoKSk7CiAgICAgICAgc2V0UG9seW1v\ncnBoaWModm0uZ2V0UG9seW1vcnBoaWMoKSk7CiAgICAgICAgX2luZm8uY29w\neSh2bS5nZXRWYWx1ZUluZm8oKSk7CgogICAgICAgIENsYXNzTWFwcGluZyBl\nbWJlZCA9IHZtLmdldEVtYmVkZGVkTWFwcGluZygpOwogICAgICAgIGlmIChl\nbWJlZCAhPSBudWxsICYmIGdldEVtYmVkZGVkTWFwcGluZygpICE9IG51bGwp\nIHsKICAgICAgICAgICAgRmllbGRNYXBwaW5nW10gdG1wbGF0ZXMgPSBlbWJl\nZC5nZXRGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgICAgIEZpZWxkTWFwcGlu\nZ1tdIGZtcyA9IGdldEVtYmVkZGVkTWFwcGluZygpLmdldEZpZWxkTWFwcGlu\nZ3MoKTsKICAgICAgICAgICAgaWYgKHRtcGxhdGVzLmxlbmd0aCA9PSBmbXMu\nbGVuZ3RoKQogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBm\nbXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgZm1zW2ldLmNv\ncHlNYXBwaW5nSW5mbyh0bXBsYXRlc1tpXSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIHJlc29sdmUoaW50IG1vZGUpIHsKICAgICAg\nICBpbnQgY3VyID0gZ2V0UmVzb2x2ZSgpOwogICAgICAgIGlmIChzdXBlci5y\nZXNvbHZlKG1vZGUpKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICBDbGFzc01hcHBpbmcgZW1iZWQgPSBnZXRFbWJlZGRlZE1hcHBpbmcoKTsK\nICAgICAgICBpZiAoZW1iZWQgIT0gbnVsbCkKICAgICAgICAgICAgZW1iZWQu\ncmVzb2x2ZShtb2RlKTsKICAgICAgICBpZiAoKG1vZGUgJiBNT0RFX01BUFBJ\nTkcpICE9IDAgJiYgKGN1ciAmIE1PREVfTUFQUElORykgPT0gMCkKICAgICAg\nICAgICAgcmVzb2x2ZU1hcHBpbmcoKTsKICAgICAgICBpZiAoKG1vZGUgJiBN\nT0RFX01BUFBJTkdfSU5JVCkgIT0gMCAmJiAoY3VyICYgTU9ERV9NQVBQSU5H\nX0lOSVQpID09IDApCiAgICAgICAgICAgIGluaXRpYWxpemVNYXBwaW5nKCk7\nCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0dXAgbWFwcGluZy4gT3VyIGhhbmRsZXIgd2lsbCBhbHJlYWR5IGhhdmUg\nYmVlbiBzZXQgYnkgb3VyIG93bmluZwogICAgICogZmllbGQuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCByZXNvbHZlTWFwcGluZygpIHsKICAgICAgICAv\nLyBtYXJrIG1hcHBlZCBjb2x1bW5zCiAgICAgICAgQ29sdW1uW10gY29sczsK\nICAgICAgICBpbnQgaW5zZXJ0RmxhZzsKICAgICAgICBpZiAoX2ZrICE9IG51\nbGwpIHsKICAgICAgICAgICAgY29scyA9IF9may5nZXRDb2x1bW5zKCk7CiAg\nICAgICAgICAgIGluc2VydEZsYWcgPSBDb2x1bW4uRkxBR19GS19JTlNFUlQ7\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29scyA9IGdldENvbHVt\nbnMoKTsKICAgICAgICAgICAgaW5zZXJ0RmxhZyA9IENvbHVtbi5GTEFHX0RJ\nUkVDVF9JTlNFUlQ7CiAgICAgICAgfQogICAgICAgIENvbHVtbklPIGlvID0g\nZ2V0Q29sdW1uSU8oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNv\nbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGlvLmlzSW5zZXJ0\nYWJsZShpLCBmYWxzZSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNldEZs\nYWcoaW5zZXJ0RmxhZywgdHJ1ZSk7CiAgICAgICAgICAgIGlmIChpby5pc1Vw\nZGF0YWJsZShpLCBmYWxzZSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNl\ndEZsYWcoaW5zZXJ0RmxhZywgdHJ1ZSk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUHJlcGFyZSBtYXBwaW5nIGZvciBydW50aW1lIHVzZS4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGluaXRpYWxpemVNYXBwaW5nKCkg\newogICAgICAgIGlmIChfZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nOwoKICAgICAgICAvLyBpZiBvdXIgZmsgY29scyBhcmUgZGlyZWN0IG1hcHBl\nZCBieSBvdGhlciB2YWx1ZXMsIG1ha2UgdGhlbQogICAgICAgIC8vIG5vbi1u\ndWxsYWJsZQogICAgICAgIENvbHVtbltdIGNvbHMgPSBfZmsuZ2V0Q29sdW1u\ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBpZiAoY29sc1tpXS5nZXRGbGFnKENvbHVt\nbi5GTEFHX0RJUkVDVF9JTlNFUlQpKQogICAgICAgICAgICAgICAgbmV3SU8o\nKS5zZXROdWxsSW5zZXJ0YWJsZShpLCBmYWxzZSk7CiAgICAgICAgICAgIGlm\nIChjb2xzW2ldLmdldEZsYWcoQ29sdW1uLkZMQUdfRElSRUNUX1VQREFURSkp\nCiAgICAgICAgICAgICAgICBuZXdJTygpLnNldE51bGxVcGRhdGFibGUoaSwg\nZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgYW55dGhpbmcgbWFw\ncyBvdXIgY29uc3RhbnQgZmsgY29scywgbWFrZSB0aGVtIHJlYWQgb25seQog\nICAgICAgIGludCBsZW4gPSBjb2xzLmxlbmd0aDsKICAgICAgICBjb2xzID0g\nX2ZrLmdldENvbnN0YW50Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAo\nY29sc1tpXS5nZXRGbGFnKENvbHVtbi5GTEFHX0RJUkVDVF9JTlNFUlQpCiAg\nICAgICAgICAgICAgICB8fCBjb2xzW2ldLmdldEZsYWcoQ29sdW1uLkZMQUdf\nRktfSU5TRVJUKSkKICAgICAgICAgICAgICAgIG5ld0lPKCkuc2V0SW5zZXJ0\nYWJsZShsZW4gKyBpLCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChjb2xzW2ld\nLmdldEZsYWcoQ29sdW1uLkZMQUdfRElSRUNUX1VQREFURSkKICAgICAgICAg\nICAgICAgIHx8IGNvbHNbaV0uZ2V0RmxhZyhDb2x1bW4uRkxBR19GS19VUERB\nVEUpKQogICAgICAgICAgICAgICAgbmV3SU8oKS5zZXRVcGRhdGFibGUobGVu\nICsgaSwgZmFsc2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgY29sdW1uIEkvTyBpbmZvcm1hdGlvbiwgY3JlYXRpbmcg\naXQgaWYgbmVjZXNzYXJ5LgogICAgICovCiAgICBwcml2YXRlIENvbHVtbklP\nIG5ld0lPKCkgewogICAgICAgIGlmIChfaW8gPT0gbnVsbCkKICAgICAgICAg\nICAgX2lvID0gbmV3IENvbHVtbklPKCk7CiAgICAgICAgcmV0dXJuIF9pbzsK\nICAgIH0KfQo=\n","encoding":"base64"}

