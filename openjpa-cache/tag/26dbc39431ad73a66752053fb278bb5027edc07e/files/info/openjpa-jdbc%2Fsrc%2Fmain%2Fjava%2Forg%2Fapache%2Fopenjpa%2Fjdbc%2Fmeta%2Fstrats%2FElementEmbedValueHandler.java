{"sha":"be1449419d0cf0aa5e559df818b3050ba3d64820","node_id":"MDQ6QmxvYjIwNjM2NDpiZTE0NDk0MTlkMGNmMGFhNWU1NTlkZjgxOGIzMDUwYmEzZDY0ODIw","size":6375,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/be1449419d0cf0aa5e559df818b3050ba3d64820","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzOw0KDQppbXBvcnQgamF2YS5zcWwuKjsNCmltcG9ydCBq\nYXZhLnV0aWwuKjsNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC4qOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuKjsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC4qOw0KaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuKjsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuKjsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuKjsNCg0KLyoqDQogKiA8cD5IYW5kbGVy\nIGZvciBlbWJlZGRlZCBvYmplY3RzIGFzIGVsZW1lbnRzIG9mIGEgY29sbGVj\ndGlvbiBvciBtYXAuICBGb3INCiAqIGVtYmVkZGVkIG9iamVjdHMgYXMgZmll\nbGRzLCB1c2UgdGhlIG1vcmUgcG93ZXJmdWwNCiAqIHtAbGluayBFbWJlZEZp\nZWxkU3RyYXRlZ3l9LjwvcD4NCiAqDQogKiBAYXV0aG9yIEFiZSBXaGl0ZQ0K\nICogQHNpbmNlIDAuNC4wLCAxLjEuMA0KICogQG5vamF2YWRvYw0KICovDQpw\ndWJsaWMgY2xhc3MgRWxlbWVudEVtYmVkVmFsdWVIYW5kbGVyDQogICAgZXh0\nZW5kcyBFbWJlZFZhbHVlSGFuZGxlcg0KICAgIGltcGxlbWVudHMgUmVsYXRp\nb25JZCB7DQoNCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlDQogICAgICAgIChFbGVtZW50\nRW1iZWRWYWx1ZUhhbmRsZXIuY2xhc3MpOw0KDQogICAgcHJpdmF0ZSBWYWx1\nZU1hcHBpbmcgX3ZtID0gbnVsbDsNCiAgICBwcml2YXRlIENvbHVtbltdIF9j\nb2xzID0gbnVsbDsNCiAgICBwcml2YXRlIE9iamVjdFtdIF9hcmdzID0gbnVs\nbDsNCiAgICBwcml2YXRlIGludCBfbnVsbElkeCA9IC0xOw0KICAgIHByaXZh\ndGUgYm9vbGVhbiBfc3ludGhldGljID0gZmFsc2U7DQoNCiAgICBwdWJsaWMg\nQ29sdW1uW10gbWFwKFZhbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUsIENv\nbHVtbklPIGlvLA0KICAgICAgICBib29sZWFuIGFkYXB0KSB7DQogICAgICAg\nIExpbmtlZExpc3QgY29scyA9IG5ldyBMaW5rZWRMaXN0KCk7DQogICAgICAg\nIExpbmtlZExpc3QgYXJncyA9IG5ldyBMaW5rZWRMaXN0KCk7DQogICAgICAg\nIHN1cGVyLm1hcCh2bSwgbmFtZSwgaW8sIGFkYXB0LCBjb2xzLCBhcmdzKTsN\nCg0KICAgICAgICBWYWx1ZU1hcHBpbmdJbmZvIHZpbmZvID0gdm0uZ2V0VmFs\ndWVJbmZvKCk7DQogICAgICAgIENvbHVtbiBudWxsSW5kID0gdmluZm8uZ2V0\nTnVsbEluZGljYXRvckNvbHVtbih2bSwgbmFtZSwNCiAgICAgICAgICAgIHZt\nLmdldEZpZWxkTWFwcGluZygpLmdldFRhYmxlKCksIGFkYXB0KTsNCiAgICAg\nICAgaWYgKG51bGxJbmQgIT0gbnVsbCkNCiAgICAgICAgICAgIHZtLnNldENv\nbHVtbnMobmV3IENvbHVtbltdeyBudWxsSW5kIH0pOw0KDQogICAgICAgIC8v\nIHJlY29yZCBpbmRleCBvZiBudWxsIGluZGljYXRvciBjb2x1bW4gYW5kIHdo\nZXRoZXIgaXQgaXMgc3ludGhldGljDQogICAgICAgIGlmIChudWxsSW5kICE9\nIG51bGwpIHsNCiAgICAgICAgICAgIF9udWxsSWR4ID0gY29scy5pbmRleE9m\nKG51bGxJbmQpOw0KICAgICAgICAgICAgaWYgKF9udWxsSWR4ID09IC0xKSB7\nDQogICAgICAgICAgICAgICAgY29scy5hZGRGaXJzdChudWxsSW5kKTsNCiAg\nICAgICAgICAgICAgICBhcmdzLmFkZEZpcnN0KG51bGwpOw0KICAgICAgICAg\nICAgICAgIF9udWxsSWR4ID0gMDsNCiAgICAgICAgICAgICAgICBfc3ludGhl\ndGljID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAg\nICAgIF92bSA9IHZtOw0KICAgICAgICBfY29scyA9IChDb2x1bW5bXSkgY29s\ncy50b0FycmF5KG5ldyBDb2x1bW5bY29scy5zaXplKCldKTsNCiAgICAgICAg\nX2FyZ3MgPSBhcmdzLnRvQXJyYXkoKTsNCiAgICAgICAgcmV0dXJuIF9jb2xz\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIG9iamVjdFZhbHVlUmVx\ndWlyZXNMb2FkKFZhbHVlTWFwcGluZyB2bSkgew0KICAgICAgICByZXR1cm4g\ndHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgT2JqZWN0IGdldFJlc3VsdEFy\nZ3VtZW50KFZhbHVlTWFwcGluZyB2bSkgew0KICAgICAgICByZXR1cm4gX2Fy\nZ3M7DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCB0b0RhdGFTdG9yZVZh\nbHVlKFZhbHVlTWFwcGluZyB2bSwgT2JqZWN0IHZhbCwNCiAgICAgICAgSkRC\nQ1N0b3JlIHN0b3JlKSB7DQogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nZW0gPSBzdG9yZS5nZXRDb250ZXh0KCkuZ2V0U3RhdGVNYW5hZ2VyKHZhbCk7\nDQogICAgICAgIE9iamVjdCBydmFsID0gbnVsbDsNCiAgICAgICAgaWYgKF9j\nb2xzLmxlbmd0aCA+IDEpDQogICAgICAgICAgICBydmFsID0gbmV3IE9iamVj\ndFtfY29scy5sZW5ndGhdOw0KDQogICAgICAgIC8vIHNldCBudWxsIGluZGlj\nYXRvciBjb2x1bW4NCiAgICAgICAgaW50IGlkeCA9IDA7DQogICAgICAgIGlm\nIChfc3ludGhldGljKSB7DQogICAgICAgICAgICBPYmplY3QgY3ZhbCA9ICgo\nRW1iZWRkZWRDbGFzc1N0cmF0ZWd5KSB2bS5nZXRFbWJlZGRlZE1hcHBpbmco\nKS4NCiAgICAgICAgICAgICAgICBnZXRTdHJhdGVneSgpKS5nZXROdWxsSW5k\naWNhdG9yVmFsdWUoZW0pOw0KICAgICAgICAgICAgaWYgKF9jb2xzLmxlbmd0\naCA9PSAxKQ0KICAgICAgICAgICAgICAgIHJldHVybiBjdmFsOw0KICAgICAg\nICAgICAgKChPYmplY3RbXSkgcnZhbClbaWR4KytdID0gY3ZhbDsNCiAgICAg\nICAgfQ0KDQogICAgICAgIHJldHVybiBzdXBlci50b0RhdGFTdG9yZVZhbHVl\nKGVtLCB2bSwgc3RvcmUsIF9jb2xzLCBydmFsLCBpZHgpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyBPYmplY3QgdG9PYmplY3RWYWx1ZShWYWx1ZU1hcHBpbmcg\ndm0sIE9iamVjdCB2YWwsDQogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nc20sIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBm\nZXRjaCkNCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7DQogICAgICAg\nIGlmIChzbSA9PSBudWxsKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IEludmFs\naWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiY2FudC1wcm9qZWN0LW93bmVk\nIiwNCiAgICAgICAgICAgICAgICB2bSkpOw0KDQogICAgICAgIC8vIGNoZWNr\nIG51bGwgaW5kaWNhdG9yIGZpcnN0DQogICAgICAgIGlmIChfbnVsbElkeCAh\nPSAtMSkgew0KICAgICAgICAgICAgT2JqZWN0IG52YWw7DQogICAgICAgICAg\nICBpZiAoX2NvbHMubGVuZ3RoID09IDEpDQogICAgICAgICAgICAgICAgbnZh\nbCA9IHZhbDsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBu\ndmFsID0gKChPYmplY3RbXSkgdmFsKVtfbnVsbElkeF07DQogICAgICAgICAg\nICBpZiAoKChFbWJlZGRlZENsYXNzU3RyYXRlZ3kpIHZtLmdldEVtYmVkZGVk\nTWFwcGluZygpLg0KICAgICAgICAgICAgICAgIGdldFN0cmF0ZWd5KCkpLmlu\nZGljYXRlc051bGwobnZhbCkpDQogICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBjcmVhdGUgZW1iZWRkZWQg\naW5zdGFuY2UNCiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBlbSA9IHN0\nb3JlLmdldENvbnRleHQoKS5lbWJlZChudWxsLCBudWxsLCBzbSwgdm0pOw0K\nICAgICAgICBpbnQgaWR4ID0gKF9zeW50aGV0aWMpID8gMSA6IDA7DQogICAg\nICAgIHN1cGVyLnRvT2JqZWN0VmFsdWUoZW0sIHZtLCB2YWwsIHN0b3JlLCBm\nZXRjaCwgX2NvbHMsIGlkeCk7DQoNCiAgICAgICAgLy8gYWZ0ZXIgbG9hZGlu\nZyBldmVyeXRoaW5nIGZyb20gcmVzdWx0LCBsb2FkIHRoZSByZXN0IG9mIHRo\nZQ0KICAgICAgICAvLyBjb25maWd1cmVkIGZpZWxkcw0KICAgICAgICBlbS5s\nb2FkKGZldGNoKTsNCiAgICAgICAgcmV0dXJuIGVtLmdldE1hbmFnZWRJbnN0\nYW5jZSgpOw0KICAgIH0NCg0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vDQogICAgLy8gUmVsYXRpb25JZCBpbXBsZW1lbnRhdGlvbg0KICAg\nIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCiAgICBwdWJsaWMg\nT2JqZWN0IHRvUmVsYXRpb25EYXRhU3RvcmVWYWx1ZShPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtLCBDb2x1bW4gY29sKSB7DQogICAgICAgIHJldHVybiB0b1Jl\nbGF0aW9uRGF0YVN0b3JlVmFsdWUoc20sIGNvbCwgMCk7DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogUmVjdXJzaXZlIGhlbHBlci4NCiAgICAgKi8NCiAg\nICBwcml2YXRlIE9iamVjdCB0b1JlbGF0aW9uRGF0YVN0b3JlVmFsdWUoT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSwgQ29sdW1uIGNvbCwNCiAgICAgICAgaW50\nIGlkeCkgew0KICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQgPSBmaW5kRmll\nbGQoY29sLCBpZHgpOw0KICAgICAgICBpZiAoZmllbGQgPT0gbnVsbCkNCiAg\nICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOw0KDQog\nICAgICAgIGlmIChmaWVsZC5nZXRIYW5kbGVyKCkgaW5zdGFuY2VvZiBSZWxh\ndGlvbklkKQ0KICAgICAgICAgICAgcmV0dXJuICgoUmVsYXRpb25JZCkgZmll\nbGQuZ2V0U3RyYXRlZ3koKSkuDQogICAgICAgICAgICAgICAgdG9SZWxhdGlv\nbkRhdGFTdG9yZVZhbHVlKHNtLCBjb2wpOw0KICAgICAgICBpZiAoZmllbGQu\nZ2V0U3RyYXRlZ3koKSBpbnN0YW5jZW9mIFJlbGF0aW9uSWQpDQogICAgICAg\nICAgICByZXR1cm4gKChSZWxhdGlvbklkKSBmaWVsZC5nZXRTdHJhdGVneSgp\nKS4NCiAgICAgICAgICAgICAgICB0b1JlbGF0aW9uRGF0YVN0b3JlVmFsdWUo\nc20sIGNvbCk7DQogICAgICAgIHJldHVybiB0b1JlbGF0aW9uRGF0YVN0b3Jl\nVmFsdWUoc20sIGNvbCwgZmllbGQuZ2V0SW5kZXgoKSArIDEpOw0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIEZpbmQgdGhlIGZpcnN0IGZpZWxkIG1hcHBp\nbmcgdGhhdCB1c2VzIHRoZSBnaXZlbiBjb2x1bW4gc3RhcnRpbmcgd2l0aA0K\nICAgICAqIHRoZSBnaXZlbiBmaWVsZCBpbmRleC4NCiAgICAgKi8NCiAgICBw\ncml2YXRlIEZpZWxkTWFwcGluZyBmaW5kRmllbGQoQ29sdW1uIGNvbCwgaW50\nIGlkeCkgew0KICAgICAgICBGaWVsZE1hcHBpbmdbXSBmbXMgPSBfdm0uZ2V0\nRW1iZWRkZWRNYXBwaW5nKCkuZ2V0RmllbGRNYXBwaW5ncygpOw0KICAgICAg\nICBDb2x1bW5bXSBjb2xzOw0KICAgICAgICBmb3IgKGludCBpID0gaWR4OyBp\nIDwgZm1zLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoZm1zW2ld\nLmdldE1hbmFnZW1lbnQoKSAhPSBGaWVsZE1hcHBpbmcuTUFOQUdFX1BFUlNJ\nU1RFTlQpDQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAg\nICBjb2xzID0gKChFbWJlZGRhYmxlKSBmbXNbaV0pLmdldENvbHVtbnMoKTsN\nCiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgY29scy5sZW5ndGg7\nIGorKykNCiAgICAgICAgICAgICAgICBpZiAoY29sc1tqXSA9PSBjb2wpDQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBmbXNbaV07DQogICAgICAgIH0N\nCiAgICAgICAgcmV0dXJuIG51bGw7DQoJfQ0KfQ0K\n","encoding":"base64"}

