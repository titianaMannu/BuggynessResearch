{"sha":"60cfbb54bed4a0eee8fd34718a7218f97f0c9d3b","node_id":"MDQ6QmxvYjIwNjM2NDo2MGNmYmI1NGJlZDRhMGVlZThmZDM0NzE4YTcyMThmOTdmMGM5ZDNi","size":6574,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/60cfbb54bed4a0eee8fd34718a7218f97f0c9d3b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJu\nZWwuSkRCQ0ZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5KREJDU3RvcmU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkVtYmVkZGFibGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuVmFsdWVNYXBwaW5nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW5J\nTzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0\nYXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5N\nZXRhRGF0YUV4Y2VwdGlvbjsKCi8qKgogKiBCYXNlIGNsYXNzIGZvciBlbWJl\nZGRlZCB2YWx1ZSBoYW5kbGVycy4KICoKICogQGF1dGhvciBBYmUgV2hpdGUK\nICogQHNpbmNlIDAuNC4wCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgRW1i\nZWRWYWx1ZUhhbmRsZXIKICAgIGV4dGVuZHMgQWJzdHJhY3RWYWx1ZUhhbmRs\nZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoRW1iZWRWYWx1ZUhh\nbmRsZXIuY2xhc3MpOwoKICAgIC8qKgogICAgICogTWFwcyBlbWJlZGRlZCB2\nYWx1ZSBhbmQgZ2F0aGVycyBjb2x1bW5zIGFuZCBhcmd1bWVudHMgaW50byBn\naXZlbiBsaXN0cy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgbWFwKFZh\nbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUsIENvbHVtbklPIGlvLAogICAg\nICAgIGJvb2xlYW4gYWRhcHQsIExpc3QgY29scywgTGlzdCBhcmdzKSB7CiAg\nICAgICAgLy8gaGF2ZSB0byByZXNvbHZlIGVtYmVkZGVkIHZhbHVlIHRvIGNv\nbGxlY3QgaXRzIGNvbHVtbnMKICAgICAgICB2bS5nZXRFbWJlZGRlZE1hcHBp\nbmcoKS5yZXNvbHZlKHZtLk1PREVfTUVUQSB8IHZtLk1PREVfTUFQUElORyk7\nCgogICAgICAgIC8vIGdhdGhlciBjb2x1bW5zIGFuZCByZXN1bHQgYXJndW1l\nbnRzCiAgICAgICAgRmllbGRNYXBwaW5nW10gZm1zID0gdm0uZ2V0RW1iZWRk\nZWRNYXBwaW5nKCkuZ2V0RmllbGRNYXBwaW5ncygpOwogICAgICAgIENvbHVt\nbltdIGN1ckNvbHM7CiAgICAgICAgT2JqZWN0W10gY3VyQXJnczsKICAgICAg\nICBDb2x1bW5JTyBjdXJJTzsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGZtcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoZm1zW2ldLmdl\ndE1hbmFnZW1lbnQoKSAhPSBGaWVsZE1hcHBpbmcuTUFOQUdFX1BFUlNJU1RF\nTlQpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYg\nKCEoZm1zW2ldLmdldFN0cmF0ZWd5KCkgaW5zdGFuY2VvZiBFbWJlZGRhYmxl\nKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlv\nbihfbG9jLmdldCgibm90LWVtYmVkZGFibGUiLAogICAgICAgICAgICAgICAg\nICAgIHZtLCBmbXNbaV0pKTsKCiAgICAgICAgICAgIGN1ckNvbHMgPSAoKEVt\nYmVkZGFibGUpIGZtc1tpXS5nZXRTdHJhdGVneSgpKS5nZXRDb2x1bW5zKCk7\nCiAgICAgICAgICAgIGN1cklPID0gKChFbWJlZGRhYmxlKSBmbXNbaV0uZ2V0\nU3RyYXRlZ3koKSkuZ2V0Q29sdW1uSU8oKTsKICAgICAgICAgICAgZm9yIChp\nbnQgaiA9IDA7IGogPCBjdXJDb2xzLmxlbmd0aDsgaisrKSB7CiAgICAgICAg\nICAgICAgICBpby5zZXRJbnNlcnRhYmxlKGNvbHMuc2l6ZSgpLCBjdXJJTy5p\nc0luc2VydGFibGUoaiwgZmFsc2UpKTsKICAgICAgICAgICAgICAgIGlvLnNl\ndE51bGxJbnNlcnRhYmxlKGNvbHMuc2l6ZSgpLAogICAgICAgICAgICAgICAg\nICAgIGN1cklPLmlzSW5zZXJ0YWJsZShqLCB0cnVlKSk7CiAgICAgICAgICAg\nICAgICBpby5zZXRVcGRhdGFibGUoY29scy5zaXplKCksIGN1cklPLmlzVXBk\nYXRhYmxlKGosIGZhbHNlKSk7CiAgICAgICAgICAgICAgICBpby5zZXROdWxs\nVXBkYXRhYmxlKGNvbHMuc2l6ZSgpLCBjdXJJTy5pc1VwZGF0YWJsZShqLCB0\ncnVlKSk7CiAgICAgICAgICAgICAgICBjb2xzLmFkZChjdXJDb2xzW2pdKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3VyQXJncyA9ICgoRW1iZWRk\nYWJsZSkgZm1zW2ldLmdldFN0cmF0ZWd5KCkpLmdldFJlc3VsdEFyZ3VtZW50\ncygpOwogICAgICAgICAgICBpZiAoY3VyQ29scy5sZW5ndGggPT0gMSkKICAg\nICAgICAgICAgICAgIGFyZ3MuYWRkKGN1ckFyZ3MpOwogICAgICAgICAgICBl\nbHNlIGlmIChjdXJDb2xzLmxlbmd0aCA+IDEpCiAgICAgICAgICAgICAgICBm\nb3IgKGludCBqID0gMDsgaiA8IGN1ckNvbHMubGVuZ3RoOyBqKyspCiAgICAg\nICAgICAgICAgICAgICAgYXJncy5hZGQoKGN1ckFyZ3MgPT0gbnVsbCkgPyBu\ndWxsCiAgICAgICAgICAgICAgICAgICAgICAgIDogKChPYmplY3RbXSkgY3Vy\nQXJncylbal0pOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEhl\nbHBlciB0byBjb252ZXJ0IGFuIG9iamVjdCB2YWx1ZSB0byBpdHMgZGF0YXN0\nb3JlIGVxdWl2YWxlbnQuCiAgICAgKgogICAgICogQHBhcmFtIGVtIHN0YXRl\nIG1hbmFnZXIgZm9yIGVtYmVkZGVkIG9iamVjdAogICAgICogQHBhcmFtIHZt\nIG93bmluZyB2YWx1ZQogICAgICogQHBhcmFtIHN0b3JlIHN0b3JlIG1hbmFn\nZXIKICAgICAqIEBwYXJhbSBjb2xzIGVtYmVkZGVkIGNvbHVtbnMKICAgICAq\nIEBwYXJhbSBydmFsIHJldHVybiBhcnJheSBpZiBtdWx0aXBsZSBjb2x1bW5z\nCiAgICAgKiBAcGFyYW0gaWR4IGluZGV4IGluIGNvbHVtbnMgYXJyYXkgdG8g\nc3RhcnQKICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCB0b0RhdGFTdG9y\nZVZhbHVlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgZW0sIFZhbHVlTWFwcGluZyB2\nbSwKICAgICAgICBKREJDU3RvcmUgc3RvcmUsIENvbHVtbltdIGNvbHMsIE9i\namVjdCBydmFsLCBpbnQgaWR4KSB7CiAgICAgICAgLy8gc2V0IHJlc3Qgb2Yg\nY29sdW1ucyBmcm9tIGZpZWxkcwogICAgICAgIEZpZWxkTWFwcGluZ1tdIGZt\ncyA9IHZtLmdldEVtYmVkZGVkTWFwcGluZygpLmdldEZpZWxkTWFwcGluZ3Mo\nKTsKICAgICAgICBPYmplY3QgY3ZhbDsKICAgICAgICBDb2x1bW5bXSBlY29s\nczsKICAgICAgICBFbWJlZGRhYmxlIGVtYmVkOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgZm1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlm\nIChmbXNbaV0uZ2V0TWFuYWdlbWVudCgpICE9IEZpZWxkTWFwcGluZy5NQU5B\nR0VfUEVSU0lTVEVOVCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICBlbWJlZCA9IChFbWJlZGRhYmxlKSBmbXNbaV0uZ2V0U3RyYXRl\nZ3koKTsKICAgICAgICAgICAgZWNvbHMgPSBlbWJlZC5nZXRDb2x1bW5zKCk7\nCiAgICAgICAgICAgIGlmIChlY29scy5sZW5ndGggPT0gMCkKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgY3ZhbCA9IChlbSA9PSBu\ndWxsKSA/IG51bGwgOiBlbS5mZXRjaChpKTsKICAgICAgICAgICAgY3ZhbCA9\nIGVtYmVkLnRvRW1iZWRkZWREYXRhU3RvcmVWYWx1ZShjdmFsLCBzdG9yZSk7\nCiAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAg\nICAgICAgcnZhbCA9IGN2YWw7CiAgICAgICAgICAgIGVsc2UgaWYgKGVjb2xz\nLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgKChPYmplY3RbXSkgcnZh\nbClbaWR4KytdID0gY3ZhbDsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAg\nICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGN2YWwsIDAsIHJ2YWwsIGlkeCwg\nZWNvbHMubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGlkeCArPSBlY29scy5s\nZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIHJ2YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBIZWxwZXIgdG8gY29udmVy\ndCBhIGRhdGFzdG9yZSB2YWx1ZSB0byBpdHMgb2JqZWN0IGVxdWl2YWxlbnQu\nCiAgICAgKgogICAgICogQHBhcmFtIGVtIHN0YXRlIG1hbmFnZXIgZm9yIGVt\nYmVkZGVkIG9iamVjdAogICAgICogQHBhcmFtIHZtIG93bmluZyB2YWx1ZQog\nICAgICogQHBhcmFtIHZhbCBkYXRhc3RvcmUgdmFsdWUKICAgICAqIEBwYXJh\nbSBzdG9yZSBvcHRpb25hbCBzdG9yZSBtYW5hZ2VyCiAgICAgKiBAcGFyYW0g\nZmV0Y2ggb3B0aW9uYWwgZmV0Y2ggY29uZmlndXJhdGlvbgogICAgICogQHBh\ncmFtIGNvbHMgZW1iZWRkZWQgY29sdW1ucwogICAgICogQHBhcmFtIGlkeCBp\nbmRleCBpbiBjb2x1bW5zIGFycmF5IHRvIHN0YXJ0CiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIHRvT2JqZWN0VmFsdWUoT3BlbkpQQVN0YXRlTWFuYWdl\nciBlbSwgVmFsdWVNYXBwaW5nIHZtLAogICAgICAgIE9iamVjdCB2YWwsIEpE\nQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwK\nICAgICAgICBDb2x1bW5bXSBjb2xzLCBpbnQgaWR4KQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIEZpZWxkTWFwcGluZ1tdIGZtcyA9\nIHZtLmdldEVtYmVkZGVkTWFwcGluZygpLmdldEZpZWxkTWFwcGluZ3MoKTsK\nICAgICAgICBFbWJlZGRhYmxlIGVtYmVkOwogICAgICAgIE9iamVjdCBjdmFs\nOwogICAgICAgIENvbHVtbltdIGVjb2xzOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgZm1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChm\nbXNbaV0uZ2V0TWFuYWdlbWVudCgpICE9IEZpZWxkTWFwcGluZy5NQU5BR0Vf\nUEVSU0lTVEVOVCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAg\nICAgICAgZW1iZWQgPSAoRW1iZWRkYWJsZSkgZm1zW2ldLmdldFN0cmF0ZWd5\nKCk7CiAgICAgICAgICAgIGVjb2xzID0gZW1iZWQuZ2V0Q29sdW1ucygpOwog\nICAgICAgICAgICBpZiAoZWNvbHMubGVuZ3RoID09IDApCiAgICAgICAgICAg\nICAgICBjdmFsID0gbnVsbDsKICAgICAgICAgICAgZWxzZSBpZiAoaWR4ID09\nIDAgJiYgZWNvbHMubGVuZ3RoID09IGNvbHMubGVuZ3RoKQogICAgICAgICAg\nICAgICAgY3ZhbCA9IHZhbDsKICAgICAgICAgICAgZWxzZSBpZiAoZWNvbHMu\nbGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICBjdmFsID0gKChPYmplY3Rb\nXSkgdmFsKVtpZHgrK107CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAg\nICAgICAgY3ZhbCA9IG5ldyBPYmplY3RbZWNvbHMubGVuZ3RoXTsKICAgICAg\nICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkodmFsLCBpZHgsIGN2YWwsIDAs\nIGVjb2xzLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBpZHggKz0gZWNvbHMu\nbGVuZ3RoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc3RvcmUg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIGVtYmVkLmxvYWRFbWJlZGRlZChl\nbSwgc3RvcmUsIGZldGNoLCBjdmFsKTsKICAgICAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgICAgICBjdmFsID0gZW1iZWQudG9FbWJlZGRlZE9iamVjdFZh\nbHVlKGN2YWwpOwogICAgICAgICAgICAgICAgZW0uc3RvcmUoZm1zW2ldLmdl\ndEluZGV4KCksIGN2YWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

