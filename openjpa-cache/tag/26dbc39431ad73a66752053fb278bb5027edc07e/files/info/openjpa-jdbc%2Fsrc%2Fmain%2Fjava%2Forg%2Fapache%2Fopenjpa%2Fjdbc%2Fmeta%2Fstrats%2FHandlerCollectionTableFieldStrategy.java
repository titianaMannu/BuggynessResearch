{"sha":"21861e4509dfc3a3c36072592b3c5cd03e834767","node_id":"MDQ6QmxvYjIwNjM2NDoyMTg2MWU0NTA5ZGZjM2EzYzM2MDcyNTkyYjNjNWNkMDNlODM0NzY3","size":9224,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/21861e4509dfc3a3c36072592b3c5cd03e834767","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzOw0KDQppbXBvcnQgamF2YS5zcWwuKjsNCmltcG9ydCBq\nYXZhLnV0aWwuKjsNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC4qOw0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC4q\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLio7DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuKjsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLio7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMua2VybmVsLio7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLio7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLio7DQoNCi8qKg0KICogPHA+TWFwcGluZyBmb3IgYSBjb2xsZWN0\naW9uIG9mIHZhbHVlcyBpbiBhIHNlcGFyYXRlIHRhYmxlIGNvbnRyb2xsZWQg\nYnkgYQ0KICoge0BsaW5rIFZhbHVlSGFuZGxlcn0uPC9wPg0KICoNCiAqIEBh\ndXRob3IgQWJlIFdoaXRlDQogKiBAc2luY2UgMC40LjAsIDEuMS4wDQogKi8N\nCnB1YmxpYyBjbGFzcyBIYW5kbGVyQ29sbGVjdGlvblRhYmxlRmllbGRTdHJh\ndGVneQ0KICAgIGV4dGVuZHMgU3RvcmVDb2xsZWN0aW9uRmllbGRTdHJhdGVn\neQ0KICAgIGltcGxlbWVudHMgTFJTQ29sbGVjdGlvbkZpZWxkU3RyYXRlZ3kg\new0KDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQ0KICAgICAgICAoSGFuZGxlckNvbGxl\nY3Rpb25UYWJsZUZpZWxkU3RyYXRlZ3kuY2xhc3MpOw0KDQogICAgcHJpdmF0\nZSBDb2x1bW5bXSBfY29scyA9IG51bGw7DQogICAgcHJpdmF0ZSBDb2x1bW5J\nTyBfaW8gPSBudWxsOw0KICAgIHByaXZhdGUgYm9vbGVhbiBfbG9hZCA9IGZh\nbHNlOw0KICAgIHByaXZhdGUgYm9vbGVhbiBfbG9iID0gZmFsc2U7DQogICAg\ncHJpdmF0ZSBib29sZWFuIF9lbWJlZCA9IGZhbHNlOw0KDQogICAgcHVibGlj\nIEZpZWxkTWFwcGluZyBnZXRGaWVsZE1hcHBpbmcoKSB7DQogICAgICAgIHJl\ndHVybiBmaWVsZDsNCiAgICB9DQoNCiAgICBwdWJsaWMgQ2xhc3NNYXBwaW5n\nW10gZ2V0SW5kZXBlbmRlbnRFbGVtZW50TWFwcGluZ3MoYm9vbGVhbiB0cmF2\nZXJzZSkgew0KICAgICAgICByZXR1cm4gQ2xhc3NNYXBwaW5nLkVNUFRZX01B\nUFBJTkdTOw0KICAgIH0NCg0KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRFbGVt\nZW50Q29sdW1ucyhDbGFzc01hcHBpbmcgZWxlbSkgew0KICAgICAgICByZXR1\ncm4gX2NvbHM7DQogICAgfQ0KDQogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0\nSm9pbkZvcmVpZ25LZXkoQ2xhc3NNYXBwaW5nIGVsZW0pIHsNCiAgICAgICAg\ncmV0dXJuIGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5KCk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgc2VsZWN0RWxlbWVudChTZWxlY3Qgc2VsLCBDbGFz\nc01hcHBpbmcgZWxlbSwgSkRCQ1N0b3JlIHN0b3JlLA0KICAgICAgICBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgZWFnZXJNb2RlLCBKb2lu\ncyBqb2lucykgew0KICAgICAgICBzZWwuc2VsZWN0KF9jb2xzLCBqb2lucyk7\nDQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBsb2FkRWxlbWVudChPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsDQogICAgICAg\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIFJlc3VsdCByZXMsIEpv\naW5zIGpvaW5zKQ0KICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsNCiAg\nICAgICAgcmV0dXJuIEhhbmRsZXJTdHJhdGVnaWVzLmxvYWRPYmplY3QoZmll\nbGQuZ2V0RWxlbWVudE1hcHBpbmcoKSwNCiAgICAgICAgICAgIHNtLCBzdG9y\nZSwgZmV0Y2gsIHJlcywgam9pbnMsIF9jb2xzLCBfbG9hZCk7DQogICAgfQ0K\nDQogICAgcHJvdGVjdGVkIEpvaW5zIGpvaW4oSm9pbnMgam9pbnMsIENsYXNz\nTWFwcGluZyBlbGVtKSB7DQogICAgICAgIHJldHVybiBqb2luKGpvaW5zLCBm\nYWxzZSk7DQogICAgfQ0KDQogICAgcHVibGljIEpvaW5zIGpvaW5FbGVtZW50\nUmVsYXRpb24oSm9pbnMgam9pbnMsIENsYXNzTWFwcGluZyBlbGVtKSB7DQog\nICAgICAgIHJldHVybiBqb2luUmVsYXRpb24oam9pbnMsIGZhbHNlLCBmYWxz\nZSk7DQogICAgfQ0KDQogICAgcHJvdGVjdGVkIFByb3h5IG5ld0xSU1Byb3h5\nKCkgew0KICAgICAgICByZXR1cm4gbmV3IExSU1Byb3h5Q29sbGVjdGlvbih0\naGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBh\nZGFwdCkgew0KICAgICAgICBpZiAoZmllbGQuZ2V0VHlwZUNvZGUoKSAhPSBK\nYXZhVHlwZXMuQ09MTEVDVElPTg0KICAgICAgICAgICAgJiYgZmllbGQuZ2V0\nVHlwZUNvZGUoKSAhPSBKYXZhVHlwZXMuQVJSQVkpDQogICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1jb2xs\nIiwgZmllbGQpKTsNCg0KICAgICAgICBhc3NlcnROb3RNYXBwZWRCeSgpOw0K\nICAgICAgICBmaWVsZC5nZXRWYWx1ZUluZm8oKS5hc3NlcnROb1NjaGVtYUNv\nbXBvbmVudHMoZmllbGQsICFhZGFwdCk7DQogICAgICAgIGZpZWxkLmdldEtl\neU1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5hc3NlcnROb1NjaGVtYUNvbXBv\nbmVudHMNCiAgICAgICAgICAgIChmaWVsZC5nZXRLZXkoKSwgIWFkYXB0KTsN\nCg0KICAgICAgICBWYWx1ZU1hcHBpbmcgZWxlbSA9IGZpZWxkLmdldEVsZW1l\nbnRNYXBwaW5nKCk7DQogICAgICAgIGlmIChlbGVtLmdldEhhbmRsZXIoKSA9\nPSBudWxsKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJuby1oYW5kbGVyIiwgZWxlbSkpOw0KDQogICAgICAg\nIGZpZWxkLm1hcEpvaW4oYWRhcHQsIHRydWUpOw0KICAgICAgICBfaW8gPSBu\nZXcgQ29sdW1uSU8oKTsNCiAgICAgICAgX2NvbHMgPSBIYW5kbGVyU3RyYXRl\nZ2llcy5tYXAoZWxlbSwgImVsZW1lbnQiLCBfaW8sIGFkYXB0KTsNCg0KICAg\nICAgICBGaWVsZE1hcHBpbmdJbmZvIGZpbmZvID0gZmllbGQuZ2V0TWFwcGlu\nZ0luZm8oKTsNCiAgICAgICAgQ29sdW1uIG9yZGVyQ29sID0gZmluZm8uZ2V0\nT3JkZXJDb2x1bW4oZmllbGQsIGZpZWxkLmdldFRhYmxlKCksIGFkYXB0KTsN\nCiAgICAgICAgZmllbGQuc2V0T3JkZXJDb2x1bW4ob3JkZXJDb2wpOw0KICAg\nICAgICBmaWVsZC5zZXRPcmRlckNvbHVtbklPKGZpbmZvLmdldENvbHVtbklP\nKCkpOw0KICAgICAgICBmaWVsZC5tYXBQcmltYXJ5S2V5KGFkYXB0KTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCBpbml0aWFsaXplKCkgew0KICAgICAg\nICBmb3IgKGludCBpID0gMDsgIV9sb2IgJiYgaSA8IF9jb2xzLmxlbmd0aDsg\naSsrKQ0KICAgICAgICAgICAgX2xvYiA9IF9jb2xzW2ldLmlzTG9iKCk7DQoN\nCiAgICAgICAgVmFsdWVNYXBwaW5nIGVsZW0gPSBmaWVsZC5nZXRFbGVtZW50\nTWFwcGluZygpOw0KICAgICAgICBfZW1iZWQgPSBlbGVtLmdldEVtYmVkZGVk\nTWV0YURhdGEoKSAhPSBudWxsOw0KICAgICAgICBfbG9hZCA9IGVsZW0uZ2V0\nSGFuZGxlcigpLm9iamVjdFZhbHVlUmVxdWlyZXNMb2FkKGVsZW0pOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyB2b2lkIGluc2VydChPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0pDQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gew0KICAgICAgICBpbnNlcnQoc20s\nIHN0b3JlLCBybSwgc20uZmV0Y2hPYmplY3QoZmllbGQuZ2V0SW5kZXgoKSkp\nOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBpbnNlcnQoT3BlbkpQQVN0\nYXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJt\nLA0KICAgICAgICBPYmplY3QgdmFscykNCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7DQogICAgICAgIENvbGxlY3Rpb24gY29sbDsNCiAgICAgICAg\naWYgKGZpZWxkLmdldFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLkFSUkFZKQ0K\nICAgICAgICAgICAgY29sbCA9IEphdmFUeXBlcy50b0xpc3QodmFscywgZmll\nbGQuZ2V0RWxlbWVudCgpLmdldFR5cGUoKSwNCiAgICAgICAgICAgICAgICBm\nYWxzZSk7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNvbGwgPSAoQ29s\nbGVjdGlvbikgdmFsczsNCiAgICAgICAgaWYgKGNvbGwgPT0gbnVsbCB8fCBj\nb2xsLmlzRW1wdHkoKSkNCiAgICAgICAgICAgIHJldHVybjsNCg0KICAgICAg\nICBSb3cgcm93ID0gcm0uZ2V0U2Vjb25kYXJ5Um93KGZpZWxkLmdldFRhYmxl\nKCksIFJvdy5BQ1RJT05fSU5TRVJUKTsNCiAgICAgICAgcm93LnNldEZvcmVp\nZ25LZXkoZmllbGQuZ2V0Sm9pbkZvcmVpZ25LZXkoKSwgZmllbGQuZ2V0Sm9p\nbkNvbHVtbklPKCksDQogICAgICAgICAgICBzbSk7DQoNCiAgICAgICAgVmFs\ndWVNYXBwaW5nIGVsZW0gPSBmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpOw0K\nICAgICAgICBDb2x1bW4gb3JkZXIgPSBmaWVsZC5nZXRPcmRlckNvbHVtbigp\nOw0KICAgICAgICBib29sZWFuIHNldE9yZGVyID0gZmllbGQuZ2V0T3JkZXJD\nb2x1bW5JTygpLmlzSW5zZXJ0YWJsZShvcmRlciwgZmFsc2UpOw0KICAgICAg\nICBpbnQgaWR4ID0gMDsNCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBj\nb2xsLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGlkeCsrKSB7DQogICAg\nICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQoZWxlbSwgaXRyLm5leHQo\nKSwgc3RvcmUsIHJvdywgX2NvbHMsDQogICAgICAgICAgICAgICAgX2lvLCB0\ncnVlKTsNCiAgICAgICAgICAgIGlmIChzZXRPcmRlcikNCiAgICAgICAgICAg\nICAgICByb3cuc2V0SW50KG9yZGVyLCBpZHgpOw0KICAgICAgICAgICAgcm0u\nZmx1c2hTZWNvbmRhcnlSb3cocm93KTsNCiAgICAgICAgfQ0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHVwZGF0ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0pDQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gew0KICAgICAgICBPYmplY3Qgb2JqID0gc20u\nZmV0Y2hPYmplY3QoZmllbGQuZ2V0SW5kZXgoKSk7DQogICAgICAgIENoYW5n\nZVRyYWNrZXIgY3QgPSBudWxsOw0KICAgICAgICBpZiAob2JqIGluc3RhbmNl\nb2YgUHJveHkpIHsNCiAgICAgICAgICAgIFByb3h5IHByb3h5ID0gKFByb3h5\nKSBvYmo7DQogICAgICAgICAgICBpZiAoUHJveGllcy5pc093bmVyKHByb3h5\nLCBzbSwgZmllbGQuZ2V0SW5kZXgoKSkpDQogICAgICAgICAgICAgICAgY3Qg\nPSBwcm94eS5nZXRDaGFuZ2VUcmFja2VyKCk7DQogICAgICAgIH0NCg0KICAg\nICAgICAvLyBpZiBubyBmaW5lLWdyYWluZWQgY2hhbmdlIHRyYWNraW5nIHRo\nZW4ganVzdCBkZWxldGUgYW5kIHJlaW5zZXJ0DQogICAgICAgIGlmIChjdCA9\nPSBudWxsIHx8ICFjdC5pc1RyYWNraW5nKCkpIHsNCiAgICAgICAgICAgIGRl\nbGV0ZShzbSwgc3RvcmUsIHJtKTsNCiAgICAgICAgICAgIGluc2VydChzbSwg\nc3RvcmUsIHJtLCBvYmopOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAg\nICB9DQoNCiAgICAgICAgLy8gZGVsZXRlIHRoZSByZW1vdmVzDQogICAgICAg\nIFZhbHVlTWFwcGluZyBlbGVtID0gZmllbGQuZ2V0RWxlbWVudE1hcHBpbmco\nKTsNCiAgICAgICAgQ29sbGVjdGlvbiByZW0gPSBjdC5nZXRSZW1vdmVkKCk7\nDQogICAgICAgIGlmICghcmVtLmlzRW1wdHkoKSkgew0KICAgICAgICAgICAg\nUm93IGRlbFJvdyA9IHJtLmdldFNlY29uZGFyeVJvdyhmaWVsZC5nZXRUYWJs\nZSgpLA0KICAgICAgICAgICAgICAgIFJvdy5BQ1RJT05fREVMRVRFKTsNCiAg\nICAgICAgICAgIGRlbFJvdy53aGVyZUZvcmVpZ25LZXkoZmllbGQuZ2V0Sm9p\nbkZvcmVpZ25LZXkoKSwgc20pOw0KICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSByZW0uaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsNCiAg\nICAgICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy53aGVyZShlbGVtLCBp\ndHIubmV4dCgpLCBzdG9yZSwgZGVsUm93LA0KICAgICAgICAgICAgICAgICAg\nICBfY29scyk7DQogICAgICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlS\nb3coZGVsUm93KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAg\nICAgIC8vIGluc2VydCB0aGUgYWRkcw0KICAgICAgICBDb2xsZWN0aW9uIGFk\nZCA9IGN0LmdldEFkZGVkKCk7DQogICAgICAgIGlmICghYWRkLmlzRW1wdHko\nKSkgew0KICAgICAgICAgICAgUm93IGFkZFJvdyA9IHJtLmdldFNlY29uZGFy\neVJvdyhmaWVsZC5nZXRUYWJsZSgpLA0KICAgICAgICAgICAgICAgIFJvdy5B\nQ1RJT05fSU5TRVJUKTsNCiAgICAgICAgICAgIGFkZFJvdy5zZXRGb3JlaWdu\nS2V5KGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5KCksDQogICAgICAgICAgICAg\nICAgZmllbGQuZ2V0Sm9pbkNvbHVtbklPKCksIHNtKTsNCg0KICAgICAgICAg\nICAgaW50IHNlcSA9IGN0LmdldE5leHRTZXF1ZW5jZSgpOw0KICAgICAgICAg\nICAgQ29sdW1uIG9yZGVyID0gZmllbGQuZ2V0T3JkZXJDb2x1bW4oKTsNCiAg\nICAgICAgICAgIGJvb2xlYW4gc2V0T3JkZXIgPSBmaWVsZC5nZXRPcmRlckNv\nbHVtbklPKCkuaXNJbnNlcnRhYmxlKG9yZGVyLA0KICAgICAgICAgICAgICAg\nIGZhbHNlKTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gYWRk\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IHNlcSsrKSB7DQogICAgICAg\nICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMuc2V0KGVsZW0sIGl0ci5uZXh0\nKCksIHN0b3JlLCBhZGRSb3csIF9jb2xzLA0KICAgICAgICAgICAgICAgICAg\nICBfaW8sIHRydWUpOw0KICAgICAgICAgICAgICAgIGlmIChzZXRPcmRlcikN\nCiAgICAgICAgICAgICAgICAgICAgYWRkUm93LnNldEludChvcmRlciwgc2Vx\nKTsNCiAgICAgICAgICAgICAgICBybS5mbHVzaFNlY29uZGFyeVJvdyhhZGRS\nb3cpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKG9yZGVyICE9\nIG51bGwpDQogICAgICAgICAgICAgICAgY3Quc2V0TmV4dFNlcXVlbmNlKHNl\ncSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBkZWxl\ndGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBS\nb3dNYW5hZ2VyIHJtKQ0KICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsN\nCiAgICAgICAgUm93IHJvdyA9IHJtLmdldEFsbFJvd3MoZmllbGQuZ2V0VGFi\nbGUoKSwgUm93LkFDVElPTl9ERUxFVEUpOw0KICAgICAgICByb3cud2hlcmVG\nb3JlaWduS2V5KGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5KCksIHNtKTsNCiAg\nICAgICAgcm0uZmx1c2hBbGxSb3dzKHJvdyk7DQogICAgfQ0KDQogICAgcHVi\nbGljIGludCBzdXBwb3J0c1NlbGVjdChTZWxlY3Qgc2VsLCBpbnQgdHlwZSwg\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwNCiAgICAgICAgSkRCQ1N0b3JlIHN0\nb3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7DQogICAgICAg\nIC8vIGNhbid0IGRvIGFueSBjb21iaW5lZCBzZWxlY3Qgd2l0aCBsb2JzLCBz\naW5jZSB0aGV5IGRvbid0IGFsbG93DQogICAgICAgIC8vIHNlbGVjdCBkaXN0\naW5jdC4gIGNhbnQgc2VsZWN0IGVhZ2VyIHBhcmFsbGVsIG9uIGVtYmVkZGVk\nLCBiZWNhdXNlDQogICAgICAgIC8vIGR1cmluZyBwYXJhbGxlbCByZXN1bHQg\ncHJvY2Vzc2luZyB0aGUgb3duaW5nIHNtIHdvbid0IGJlIGF2YWlsYWJsZQ0K\nICAgICAgICAvLyBmb3IgZWFjaCBlbGVtDQogICAgICAgIGlmIChfbG9iIHx8\nIChfZW1iZWQgJiYgdHlwZSA9PSBTZWxlY3QuRUFHRVJfUEFSQUxMRUwpKQ0K\nICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIHJldHVybiBzdXBlci5z\ndXBwb3J0c1NlbGVjdChzZWwsIHR5cGUsIHNtLCBzdG9yZSwgZmV0Y2gpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgdG9EYXRhU3RvcmVWYWx1ZShP\nYmplY3QgdmFsLCBKREJDU3RvcmUgc3RvcmUpIHsNCiAgICAgICAgcmV0dXJu\nIEhhbmRsZXJTdHJhdGVnaWVzLnRvRGF0YVN0b3JlVmFsdWUoZmllbGQuZ2V0\nRWxlbWVudE1hcHBpbmcoKSwNCiAgICAgICAgICAgIHZhbCwgX2NvbHMsIHN0\nb3JlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgSm9pbnMgam9pbihKb2lucyBq\nb2lucywgYm9vbGVhbiBmb3JjZU91dGVyKSB7DQogICAgICAgIHJldHVybiBm\naWVsZC5qb2luKGpvaW5zLCBmb3JjZU91dGVyLCB0cnVlKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgSm9pbnMgam9pblJlbGF0aW9uKEpvaW5zIGpvaW5zLCBi\nb29sZWFuIGZvcmNlT3V0ZXIsDQogICAgICAgIGJvb2xlYW4gdHJhdmVyc2Up\nIHsNCiAgICAgICAgaWYgKHRyYXZlcnNlKQ0KICAgICAgICAgICAgSGFuZGxl\nclN0cmF0ZWdpZXMuYXNzZXJ0Sm9pbmFibGUoZmllbGQuZ2V0RWxlbWVudE1h\ncHBpbmcoKSk7DQogICAgICAgIHJldHVybiBqb2luczsNCiAgICB9DQp9DQo=\n","encoding":"base64"}

