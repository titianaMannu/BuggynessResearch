{"sha":"12f04c3752ca424fa2453185af23d749cff88e57","node_id":"MDQ6QmxvYjIwNjM2NDoxMmYwNGMzNzUyY2E0MjRmYTI0NTMxODVhZjIzZDc0OWNmZjg4ZTU3","size":9837,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/12f04c3752ca424fa2453185af23d749cff88e57","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRC\nQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5D\nbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuUmVsYXRpb25JZDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5WYWx1ZU1hcHBpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVlTWFwcGluZ0luZm87CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbklPOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5zOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJlc3VsdDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW52YWxpZFN0YXRlRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4\nY2VwdGlvbjsKCi8qKgogKiBVdGlsaXR5IG1ldGhvZHMgZm9yIHN0cmF0ZWdp\nZXMgdXNpbmcgdmFsdWUgaGFuZGxlcnMuCiAqCiAqIEBhdXRob3IgQWJlIFdo\naXRlCiAqIEBzaW5jZSAwLjQuMAogKi8KcHVibGljIGNsYXNzIEhhbmRsZXJT\ndHJhdGVnaWVzIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6\nZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEhhbmRs\nZXJTdHJhdGVnaWVzLmNsYXNzKTsKCiAgICAvKioKICAgICAqIE1hcCB0aGUg\nZ2l2ZW4gdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQ29sdW1u\nW10gbWFwKFZhbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUsIENvbHVtbklP\nIGlvLAogICAgICAgIGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICBWYWx1ZU1h\ncHBpbmdJbmZvIHZpbmZvID0gdm0uZ2V0VmFsdWVJbmZvKCk7CiAgICAgICAg\ndmluZm8uYXNzZXJ0Tm9Kb2luKHZtLCB0cnVlKTsKICAgICAgICB2aW5mby5h\nc3NlcnROb0ZvcmVpZ25LZXkodm0sICFhZGFwdCk7CgogICAgICAgIENvbHVt\nbltdIGNvbHMgPSB2bS5nZXRIYW5kbGVyKCkubWFwKHZtLCBuYW1lLCBpbywg\nYWRhcHQpOwogICAgICAgIGlmIChjb2xzLmxlbmd0aCA+IDAgJiYgY29sc1sw\nXS5nZXRUYWJsZSgpID09IG51bGwpIHsKICAgICAgICAgICAgY29scyA9IHZp\nbmZvLmdldENvbHVtbnModm0sIG5hbWUsIGNvbHMsCiAgICAgICAgICAgICAg\nICB2bS5nZXRGaWVsZE1hcHBpbmcoKS5nZXRUYWJsZSgpLCBhZGFwdCk7CiAg\nICAgICAgICAgIENvbHVtbklPIG1hcHBlZElPID0gdmluZm8uZ2V0Q29sdW1u\nSU8oKTsKICAgICAgICAgICAgdm0uc2V0Q29sdW1ucyhjb2xzKTsKICAgICAg\nICAgICAgdm0uc2V0Q29sdW1uSU8obWFwcGVkSU8pOwogICAgICAgICAgICBp\nZiAobWFwcGVkSU8gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nICAgICAgICAgaW8uc2V0SW5zZXJ0YWJsZShpLCBtYXBwZWRJTy5pc0luc2Vy\ndGFibGUoaSwgZmFsc2UpKTsKICAgICAgICAgICAgICAgICAgICBpby5zZXRO\ndWxsSW5zZXJ0YWJsZShpLCBtYXBwZWRJTy5pc0luc2VydGFibGUoaSwgdHJ1\nZSkpOwogICAgICAgICAgICAgICAgICAgIGlvLnNldFVwZGF0YWJsZShpLCBt\nYXBwZWRJTy5pc1VwZGF0YWJsZShpLCBmYWxzZSkpOwogICAgICAgICAgICAg\nICAgICAgIGlvLnNldE51bGxVcGRhdGFibGUoaSwgbWFwcGVkSU8uaXNVcGRh\ndGFibGUoaSwgdHJ1ZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHZtLm1hcENvbnN0cmFpbnRzKG5hbWUs\nIGFkYXB0KTsKICAgICAgICByZXR1cm4gY29sczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgaW50byB0aGUgZ2l2ZW4gcm93\nLgogICAgICogUmV0dXJuIGZhbHNlIGlmIHRoZSBnaXZlbiB2YWx1ZSBjYW4g\nbm90IGJlIHNldCwgZm9yIGV4YW1wbGUsIGR1ZSB0byAKICAgICAqIG51bGwg\nY29uc3RyYWludHMgb24gdGhlIGNvbHVtbnMuIAogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGJvb2xlYW4gc2V0KFZhbHVlTWFwcGluZyB2bSwgT2JqZWN0\nIHZhbCwgSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIFJvdyByb3csIENvbHVt\nbltdIGNvbHMsIENvbHVtbklPIGlvLCBib29sZWFuIG51bGxOb25lKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICghY2FuU2V0\nQW55KHJvdywgaW8sIGNvbHMpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCgogICAgICAgIFZhbHVlSGFuZGxlciBoYW5kbGVyID0gdm0uZ2V0SGFuZGxl\ncigpOwogICAgICAgIHZhbCA9IGhhbmRsZXIudG9EYXRhU3RvcmVWYWx1ZSh2\nbSwgdmFsLCBzdG9yZSk7CiAgICAgICAgYm9vbGVhbiBpc1NldCA9IGZhbHNl\nOwogICAgICAgIGlmICh2YWwgPT0gbnVsbCkgewogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nICAgICBpZiAoY2FuU2V0KHJvdywgaW8sIGksIHRydWUpKSB7CiAgICAgICAg\nICAgICAgICAgICAgaXNTZXQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAg\nIHNldChyb3csIGNvbHNbaV0sIG51bGwsIGhhbmRsZXIsIG51bGxOb25lKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNvbHMubGVu\nZ3RoID09IDEpIHsKICAgICAgICAgICAgaWYgKGNhblNldChyb3csIGlvLCAw\nLCB2YWwgPT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgIGlzU2V0ID0gdHJ1\nZTsKICAgICAgICAgICAgICAgIHNldChyb3csIGNvbHNbMF0sIHZhbCwgaGFu\nZGxlciwgbnVsbE5vbmUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgT2JqZWN0W10gdmFscyA9IChPYmplY3RbXSkgdmFs\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHZhbHMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgICAgICBpZiAoY2FuU2V0KHJvdywgaW8sIGks\nIHZhbHNbaV0gPT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgICBpc1Nl\ndCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgc2V0KHJvdywgY29sc1tp\nXSwgdmFsc1tpXSwgaGFuZGxlciwgbnVsbE5vbmUpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gaXNTZXQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gY29sdW1u\nIGluZGV4IGlzIHNldHRhYmxlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBib29sZWFuIGNhblNldChSb3cgcm93LCBDb2x1bW5JTyBpbywgaW50IGks\nCiAgICAgICAgYm9vbGVhbiBudWxsVmFsdWUpIHsKICAgICAgICBpZiAocm93\nLmdldEFjdGlvbigpID09IFJvdy5BQ1RJT05fSU5TRVJUKQogICAgICAgIAly\nZXR1cm4gaW8uaXNJbnNlcnRhYmxlKGksIG51bGxWYWx1ZSk7CiAgICAgICAg\naWYgKHJvdy5nZXRBY3Rpb24oKSA9PSBSb3cuQUNUSU9OX1VQREFURSkKICAg\nICAgICAJcmV0dXJuIGlvLmlzVXBkYXRhYmxlKGksIG51bGxWYWx1ZSk7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdHJ1ZSBpZiB0aGUgYW55IGNvbHVtbiB1cCB0byB0aGUgZ2l2ZW4gaW5k\nZXggaXMgc2V0dGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJv\nb2xlYW4gY2FuU2V0QW55KFJvdyByb3csIENvbHVtbklPIGlvLCBDb2x1bW5b\nXSBjb2xzKSB7CiAgICAgICAgaWYgKHJvdy5nZXRBY3Rpb24oKSA9PSBSb3cu\nQUNUSU9OX0lOU0VSVCkKICAgICAgICAgICAgcmV0dXJuIGlvLmlzQW55SW5z\nZXJ0YWJsZShjb2xzLCBmYWxzZSk7CiAgICAgICAgaWYgKHJvdy5nZXRBY3Rp\nb24oKSA9PSBSb3cuQUNUSU9OX1VQREFURSkKICAgICAgICAgICAgcmV0dXJu\nIGlvLmlzQW55VXBkYXRhYmxlKGNvbHMsIGZhbHNlKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhIHZhbHVlIGlu\ndG8gYSByb3csIHRha2luZyBjYXJlIG5vdCB0byBvdmVycmlkZSBjb2x1bW4g\nZGVmdWFsdHMKICAgICAqIHdpdGggbnVsbHMgdW5sZXNzIHRoZSB1c2VyIHdh\nbnRzIHVzIHRvLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHNl\ndChSb3cgcm93LCBDb2x1bW4gY29sLCBPYmplY3QgdmFsLAogICAgICAgIFZh\nbHVlSGFuZGxlciBoYW5kbGVyLCBib29sZWFuIG51bGxOb25lKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh2YWwgPT0gbnVs\nbCkKICAgICAgICAgICAgcm93LnNldE51bGwoY29sLCBudWxsTm9uZSk7CiAg\nICAgICAgZWxzZSBpZiAoY29sLmlzUmVsYXRpb25JZCgpICYmIGhhbmRsZXIg\naW5zdGFuY2VvZiBSZWxhdGlvbklkKQogICAgICAgICAgICByb3cuc2V0UmVs\nYXRpb25JZChjb2wsIChPcGVuSlBBU3RhdGVNYW5hZ2VyKSB2YWwsCiAgICAg\nICAgICAgICAgICAoUmVsYXRpb25JZCkgaGFuZGxlcik7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICByb3cuc2V0T2JqZWN0KGNvbCwgdmFsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFkZCB3aGVyZSBjb25kaXRpb25zIHRvIHRoZSBn\naXZlbiByb3cuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCB3aGVy\nZShWYWx1ZU1hcHBpbmcgdm0sIE9iamVjdCB2YWwsIEpEQkNTdG9yZSBzdG9y\nZSwKICAgICAgICBSb3cgcm93LCBDb2x1bW5bXSBjb2xzKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChjb2xzLmxlbmd0aCA9\nPSAwKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIHZhbCA9IHRvRGF0\nYVN0b3JlVmFsdWUodm0sIHZhbCwgY29scywgc3RvcmUpOwogICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgcm93LndoZXJl\nTnVsbChjb2xzW2ldKTsKICAgICAgICBlbHNlIGlmIChjb2xzLmxlbmd0aCA9\nPSAxKQogICAgICAgICAgICB3aGVyZShyb3csIGNvbHNbMF0sIHZhbCk7CiAg\nICAgICAgZWxzZSB7CiAgICAgICAgICAgIE9iamVjdFtdIHZhbHMgPSAoT2Jq\nZWN0W10pIHZhbDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB2\nYWxzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgd2hlcmUocm93LCBj\nb2xzW2ldLCB2YWxzW2ldKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgYSB3aGVyZSBjb25kaXRpb24gb24gdGhlIGdpdmVuIHJvdy4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCB3aGVyZShSb3cgcm93\nLCBDb2x1bW4gY29sLCBPYmplY3QgdmFsKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAg\nICAgcm93LndoZXJlTnVsbChjb2wpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgcm93LndoZXJlT2JqZWN0KGNvbCwgdmFsKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIExvYWQgdGhlIE9iamVjdCB2YWx1ZSBmcm9tIHRoZSBnaXZlbiBy\nZXN1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IGxvYWRP\nYmplY3QoVmFsdWVNYXBwaW5nIHZtLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCwgUmVzdWx0IHJlcywKICAgICAgICBKb2lucyBqb2lucywg\nQ29sdW1uW10gY29scywgYm9vbGVhbiBvYmplY3RWYWx1ZVJlcXVpcmVzTG9h\nZCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nY29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFs\naWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiY2FudC1wcm9qZWN0LW93bmVk\nIiwKICAgICAgICAgICAgICAgIHZtKSk7CgogICAgICAgIE9iamVjdCB2YWwg\nPSBsb2FkRGF0YVN0b3JlKHZtLCByZXMsIGpvaW5zLCBjb2xzKTsKICAgICAg\nICBpZiAob2JqZWN0VmFsdWVSZXF1aXJlc0xvYWQpCiAgICAgICAgICAgIHJl\ndHVybiB2bS5nZXRIYW5kbGVyKCkudG9PYmplY3RWYWx1ZSh2bSwgdmFsLCBz\nbSwgc3RvcmUsIGZldGNoKTsKICAgICAgICByZXR1cm4gdm0uZ2V0SGFuZGxl\ncigpLnRvT2JqZWN0VmFsdWUodm0sIHZhbCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBMb2FkIHRoZSBkYXRhc3RvcmUgdmFsdWUgZnJvbSB0aGUgZ2l2ZW4g\ncmVzdWx0LiBUaGlzIG1ldGhvZCBkb2VzCiAgICAgKiA8Yj5ub3Q8L2I+IHBy\nb2Nlc3MgdGhlIGxvYWRlZCB2YWx1ZSB0aHJvdWdoCiAgICAgKiB7QGxpbmsg\nVmFsdWVIYW5kbGVyI3RvT2JqZWN0VmFsdWV9LgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIE9iamVjdCBsb2FkRGF0YVN0b3JlKFZhbHVlTWFwcGluZyB2\nbSwgUmVzdWx0IHJlcywKICAgICAgICBKb2lucyBqb2lucywgQ29sdW1uW10g\nY29scykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoY29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIHJl\ndHVybiByZXMuZ2V0T2JqZWN0KGNvbHNbMF0sIHZtLmdldEhhbmRsZXIoKS4K\nICAgICAgICAgICAgICAgIGdldFJlc3VsdEFyZ3VtZW50KHZtKSwgam9pbnMp\nOwoKICAgICAgICBPYmplY3RbXSB2YWxzID0gbmV3IE9iamVjdFtjb2xzLmxl\nbmd0aF07CiAgICAgICAgT2JqZWN0W10gYXJncyA9IChPYmplY3RbXSkgdm0u\nZ2V0SGFuZGxlcigpLmdldFJlc3VsdEFyZ3VtZW50KHZtKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgIHZhbHNbaV0gPSByZXMuZ2V0T2JqZWN0KGNvbHNbaV0sIChhcmdzID09\nIG51bGwpID8gbnVsbCA6IGFyZ3NbaV0sCiAgICAgICAgICAgICAgICBqb2lu\ncyk7CiAgICAgICAgcmV0dXJuIHZhbHM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZXJ0IHRoZSBnaXZlbiBvYmplY3QgdG8gaXRzIGRhdGFzdG9yZSB2\nYWx1ZShzKS4gUmVsYXRpb24gaWRzIGFyZQogICAgICogY29udmVydGVkIHRv\nIHRoZWlyIGZpbmFsIHZhbHVlcyBpbW1lZGlhdGVseS4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBPYmplY3QgdG9EYXRhU3RvcmVWYWx1ZShWYWx1ZU1h\ncHBpbmcgdm0sIE9iamVjdCB2YWwsCiAgICAgICAgQ29sdW1uW10gY29scywg\nSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgVmFsdWVIYW5kbGVyIGhhbmRs\nZXIgPSB2bS5nZXRIYW5kbGVyKCk7CiAgICAgICAgdmFsID0gaGFuZGxlci50\nb0RhdGFTdG9yZVZhbHVlKHZtLCB2YWwsIHN0b3JlKTsKICAgICAgICBpZiAo\ndmFsID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4g\nMSkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2JqZWN0W2NvbHMubGVu\nZ3RoXTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAg\nICAgICAvLyByZWxhdGlvbiBpZHMgYXJlIHJldHVybmVkIGFzIHN0YXRlIG1h\nbmFnZXJzOyByZXNvbHZlIHRoZSBmaW5hbAogICAgICAgIC8vIGRhdGFzdG9y\nZSB2YWx1ZSBpbW1lZGlhdGVseQogICAgICAgIE9iamVjdFtdIHZhbHM7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGlmICghY29sc1tpXS5pc1JlbGF0aW9uSWQoKSkKICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoIShoYW5k\nbGVyIGluc3RhbmNlb2YgUmVsYXRpb25JZCkpCiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEpIHsKICAg\nICAgICAgICAgICAgIHZhbCA9ICgoUmVsYXRpb25JZCkgaGFuZGxlcikudG9S\nZWxhdGlvbkRhdGFTdG9yZVZhbHVlCiAgICAgICAgICAgICAgICAgICAgKChP\ncGVuSlBBU3RhdGVNYW5hZ2VyKSB2YWwsIGNvbHNbaV0pOwogICAgICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAgICAgdmFscyA9IChPYmplY3RbXSkg\ndmFsOwogICAgICAgICAgICAgICAgdmFsc1tpXSA9ICgoUmVsYXRpb25JZCkg\naGFuZGxlcikudG9SZWxhdGlvbkRhdGFTdG9yZVZhbHVlCiAgICAgICAgICAg\nICAgICAgICAgKChPcGVuSlBBU3RhdGVNYW5hZ2VyKSB2YWxzW2ldLCBjb2xz\nW2ldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\ndmFsOwogICAgfQoKICAgIC8qKgogICAgICogVGhyb3cgdGhlIHByb3BlciBl\neGNlcHRpb24gaWYgdGhlIGdpdmVuIGhhbmRsZXItY29udHJvbGxlZCB2YWx1\nZQogICAgICogcmVwcmVzZW50cyBhbiB1bmpvaW5hYmxlIHJlbGF0aW9uLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYXNzZXJ0Sm9pbmFibGUo\nVmFsdWVNYXBwaW5nIHZtKSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIHJlbCA9\nIHZtLmdldFR5cGVNYXBwaW5nKCk7CiAgICAgICAgaWYgKHJlbCAhPSBudWxs\nICYmIChyZWwuZ2V0VGFibGUoKSA9PSBudWxsCiAgICAgICAgICAgIHx8ICFy\nZWwuZ2V0VGFibGUoKS5lcXVhbHModm0uZ2V0RmllbGRNYXBwaW5nKCkuZ2V0\nVGFibGUoKSkpKQogICAgICAgICAgICB0aHJvdyBSZWxhdGlvblN0cmF0ZWdp\nZXMudW5qb2luYWJsZSh2bSk7CiAgICB9Cn0K\n","encoding":"base64"}

