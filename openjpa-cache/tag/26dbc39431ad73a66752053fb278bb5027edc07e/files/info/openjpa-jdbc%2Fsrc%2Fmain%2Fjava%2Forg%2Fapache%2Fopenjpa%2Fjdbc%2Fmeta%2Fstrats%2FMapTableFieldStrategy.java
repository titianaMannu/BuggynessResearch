{"sha":"4a7598ebce12af810eb381f79eea1f79d65a1193","node_id":"MDQ6QmxvYjIwNjM2NDo0YTc1OThlYmNlMTJhZjgxMGViMzgxZjc5ZWVhMWY3OWQ2NWExMTkz","size":6196,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4a7598ebce12af810eb381f79eea1f79d65a1193","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5l\nbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkZpZWxkU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWln\nbktleTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Kb2lu\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5SZXN1bHQ7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJvd01hbmFnZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU2VsZWN0OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5h\nZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2Fs\naXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBl\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhj\nZXB0aW9uOwoKLyoqCiAqIEJhc2UgY2xhc3MgZm9yIG1hcCBtYXBwaW5ncy4g\nSGFuZGxlcyBtYW5hZ2luZyB0aGUgc2Vjb25kYXJ5IHRhYmxlCiAqIHVzZWQg\ndG8gaG9sZCBtYXAga2V5cyBhbmQgdmFsdWVzIGFuZCBsb2FkaW5nLiBTdWJj\nbGFzc2VzIG11c3QgaW1wbGVtZW50CiAqIGFic3RyYWN0IG1ldGhvZHMgYW5k\nIGluc2VydC91cGRhdGUgYmVoYXZpb3IgYXMgd2VsbCBhcyBvdmVycmlkaW5n\nCiAqIHtAbGluayBGaWVsZFN0cmF0ZWd5I3RvRGF0YVN0b3JlVmFsdWV9LAog\nKiB7QGxpbmsgRmllbGRTdHJhdGVneSN0b0tleURhdGFTdG9yZVZhbHVlfSwK\nICoge0BsaW5rIEZpZWxkU3RyYXRlZ3kjam9pblJlbGF0aW9ufSwgYW5kCiAq\nIHtAbGluayBGaWVsZFN0cmF0ZWd5I2pvaW5LZXlSZWxhdGlvbn0gaWYgbmVj\nZXNzYXJ5LgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGFi\nc3RyYWN0IGNsYXNzIE1hcFRhYmxlRmllbGRTdHJhdGVneQogICAgZXh0ZW5k\ncyBDb250YWluZXJGaWVsZFN0cmF0ZWd5CiAgICBpbXBsZW1lbnRzIExSU01h\ncEZpZWxkU3RyYXRlZ3kgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExv\nY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAo\nTWFwVGFibGVGaWVsZFN0cmF0ZWd5LmNsYXNzKTsKCiAgICBwdWJsaWMgRmll\nbGRNYXBwaW5nIGdldEZpZWxkTWFwcGluZygpIHsKICAgICAgICByZXR1cm4g\nZmllbGQ7CiAgICB9CgogICAgcHVibGljIENsYXNzTWFwcGluZ1tdIGdldElu\nZGVwZW5kZW50S2V5TWFwcGluZ3MoYm9vbGVhbiB0cmF2ZXJzZSkgewogICAg\nICAgIHJldHVybiAodHJhdmVyc2UpID8gZmllbGQuZ2V0S2V5TWFwcGluZygp\nLmdldEluZGVwZW5kZW50VHlwZU1hcHBpbmdzKCkKICAgICAgICAgICAgOiBD\nbGFzc01hcHBpbmcuRU1QVFlfTUFQUElOR1M7CiAgICB9CgogICAgcHVibGlj\nIENsYXNzTWFwcGluZ1tdIGdldEluZGVwZW5kZW50VmFsdWVNYXBwaW5ncyhi\nb29sZWFuIHRyYXZlcnNlKSB7CiAgICAgICAgcmV0dXJuICh0cmF2ZXJzZSkg\nPyBmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpLgogICAgICAgICAgICBnZXRJ\nbmRlcGVuZGVudFR5cGVNYXBwaW5ncygpIDogQ2xhc3NNYXBwaW5nLkVNUFRZ\nX01BUFBJTkdTOwogICAgfQoKICAgIHB1YmxpYyBGb3JlaWduS2V5IGdldEpv\naW5Gb3JlaWduS2V5KENsYXNzTWFwcGluZyBjbHMpIHsKICAgICAgICByZXR1\ncm4gZmllbGQuZ2V0Sm9pbkZvcmVpZ25LZXkoKTsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGRlcml2ZUtleShKREJDU3RvcmUgc3RvcmUsIE9iamVjdCB2\nYWx1ZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgZGVyaXZlVmFsdWUoSkRCQ1N0b3JlIHN0b3JlLCBPYmplY3Qg\na2V5KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJbnZva2VzIHtAbGluayBGaWVsZFN0cmF0ZWd5I2pvaW5LZXlSZWxh\ndGlvbn0gYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIEpvaW5zIGpv\naW5LZXlSZWxhdGlvbihKb2lucyBqb2lucywgQ2xhc3NNYXBwaW5nIGtleSkg\newogICAgICAgIHJldHVybiBqb2luS2V5UmVsYXRpb24oam9pbnMsIGZhbHNl\nLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2VzIHtAbGlu\nayBGaWVsZFN0cmF0ZWd5I2pvaW5SZWxhdGlvbn0gYnkgZGVmYXVsdC4KICAg\nICAqLwogICAgcHVibGljIEpvaW5zIGpvaW5WYWx1ZVJlbGF0aW9uKEpvaW5z\nIGpvaW5zLCBDbGFzc01hcHBpbmcgdmFsKSB7CiAgICAgICAgcmV0dXJuIGpv\naW5SZWxhdGlvbihqb2lucywgZmFsc2UsIGZhbHNlKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkgewogICAgICAgIGlmIChm\naWVsZC5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5NQVApCiAgICAgICAg\nICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm90\nLW1hcCIsIGZpZWxkKSk7CiAgICAgICAgaWYgKGZpZWxkLmdldEtleSgpLmdl\ndFZhbHVlTWFwcGVkQnkoKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm1hcHBlZC1ieS1rZXki\nLCBmaWVsZCkpOwogICAgICAgIGZpZWxkLmdldFZhbHVlSW5mbygpLmFzc2Vy\ndE5vU2NoZW1hQ29tcG9uZW50cyhmaWVsZCwgIWFkYXB0KTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBkZWxldGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwg\nSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIFJvdyByb3cgPSBybS5nZXRBbGxS\nb3dzKGZpZWxkLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fREVMRVRFKTsKICAg\nICAgICByb3cud2hlcmVGb3JlaWduS2V5KGZpZWxkLmdldEpvaW5Gb3JlaWdu\nS2V5KCksIHNtKTsKICAgICAgICBybS5mbHVzaEFsbFJvd3Mocm93KTsKICAg\nIH0KCiAgICBwdWJsaWMgaW50IHN1cHBvcnRzU2VsZWN0KFNlbGVjdCBzZWws\nIGludCB0eXBlLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAogICAgICAgIEpE\nQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkg\newogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxv\nYWQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLAog\nICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGZpZWxkLmlzTFJT\nKCkpIHsKICAgICAgICAgICAgc20uc3RvcmVPYmplY3RGaWVsZChmaWVsZC5n\nZXRJbmRleCgpLCBuZXcgTFJTUHJveHlNYXAodGhpcykpOwogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBzZWxlY3QgYWxsIGFu\nZCBsb2FkIGludG8gYSBub3JtYWwgcHJveHkKICAgICAgICBKb2luc1tdIGpv\naW5zID0gbmV3IEpvaW5zWzJdOwogICAgICAgIFJlc3VsdFtdIHJlcyA9IGdl\ndFJlc3VsdHMoc20sIHN0b3JlLCBmZXRjaCwKICAgICAgICAgICAgSkRCQ0Zl\ndGNoQ29uZmlndXJhdGlvbi5FQUdFUl9QQVJBTExFTCwgam9pbnMsIGZhbHNl\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBNYXAgbWFwID0gKE1hcCkg\nc20ubmV3UHJveHkoZmllbGQuZ2V0SW5kZXgoKSk7CiAgICAgICAgICAgIE9i\namVjdCBrZXksIHZhbDsKICAgICAgICAgICAgd2hpbGUgKHJlc1swXS5uZXh0\nKCkpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNbMV0gIT0gcmVzWzBdICYm\nICFyZXNbMV0ubmV4dCgpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoK\nICAgICAgICAgICAgICAgIGtleSA9IGxvYWRLZXkoc20sIHN0b3JlLCBmZXRj\naCwgcmVzWzBdLCBqb2luc1swXSk7CiAgICAgICAgICAgICAgICB2YWwgPSBs\nb2FkVmFsdWUoc20sIHN0b3JlLCBmZXRjaCwgcmVzWzFdLCBqb2luc1sxXSk7\nCiAgICAgICAgICAgICAgICBtYXAucHV0KGtleSwgdmFsKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBzbS5zdG9yZU9iamVjdChmaWVsZC5nZXRJbmRl\neCgpLCBtYXApOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHJl\nc1swXS5jbG9zZSgpOwogICAgICAgICAgICBpZiAocmVzWzFdICE9IHJlc1sw\nXSkKICAgICAgICAgICAgICAgIHJlc1sxXS5jbG9zZSgpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGxvYWRLZXlQcm9qZWN0aW9uKEpE\nQkNTdG9yZSBzdG9yZSwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoLCBSZXN1bHQgcmVzLCBKb2lucyBqb2lucykKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gbG9hZEtleShudWxs\nLCBzdG9yZSwgZmV0Y2gsIHJlcywgam9pbnMpOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgbG9hZFByb2plY3Rpb24oSkRCQ1N0b3JlIHN0b3JlLCBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLAogICAgICAgIFJlc3VsdCByZXMs\nIEpvaW5zIGpvaW5zKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHJldHVybiBsb2FkVmFsdWUobnVsbCwgc3RvcmUsIGZldGNoLCBy\nZXMsIGpvaW5zKTsKICAgIH0KCiAgICBwdWJsaWMgSm9pbnMgam9pbihKb2lu\ncyBqb2lucywgYm9vbGVhbiBmb3JjZU91dGVyKSB7CiAgICAgICAgcmV0dXJu\nIGZpZWxkLmpvaW4oam9pbnMsIGZvcmNlT3V0ZXIsIHRydWUpOwogICAgfQoK\nICAgIHB1YmxpYyBKb2lucyBqb2luS2V5KEpvaW5zIGpvaW5zLCBib29sZWFu\nIGZvcmNlT3V0ZXIpIHsKICAgICAgICByZXR1cm4gZmllbGQuam9pbihqb2lu\ncywgZm9yY2VPdXRlciwgdHJ1ZSk7CiAgICB9CgogICAgcHJvdGVjdGVkIEZv\ncmVpZ25LZXkgZ2V0Sm9pbkZvcmVpZ25LZXkoKSB7CiAgICAgICAgcmV0dXJu\nIGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5KCk7CiAgICB9CgogICAgcHJvdGVj\ndGVkIENsYXNzTWFwcGluZ1tdIGdldEluZGVwZW5kZW50RWxlbWVudE1hcHBp\nbmdzKGJvb2xlYW4gdHJhdmVyc2UpIHsKICAgICAgICByZXR1cm4gQ2xhc3NN\nYXBwaW5nLkVNUFRZX01BUFBJTkdTOwogICAgfQp9Cg==\n","encoding":"base64"}

