{"sha":"e71657c527172a9cd38341052f862e331a9f6acf","node_id":"MDQ6QmxvYjIwNjM2NDplNzE2NTdjNTI3MTcyYTljZDM4MzQxMDUyZjg2MmUzMzFhOWY2YWNm","size":11893,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e71657c527172a9cd38341052f862e331a9f6acf","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuQml0U2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CgppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBw\naW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVs\nZE1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3Fs\nLlJvdzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Sb3dJ\nbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJvd01h\nbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5K\nUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLlN0b3JlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5BcnJheVN0YXRlSW1hZ2U7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAqIFVzZXMg\nYSBzdGF0ZSBpbWFnZSB0byBkZXRlcm1pbmUgd2hldGhlciBjb25jdXJyZW5j\neSB2aW9sYXRpb25zIHRha2UgcGxhY2UuCiAqCiAqIEBhdXRob3IgQWJlIFdo\naXRlCiAqLwpwdWJsaWMgY2xhc3MgU3RhdGVDb21wYXJpc29uVmVyc2lvblN0\ncmF0ZWd5CiAgICBleHRlbmRzIEFic3RyYWN0VmVyc2lvblN0cmF0ZWd5IHsK\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBTElBUyA9ICJzdGF0\nZS1jb21wYXJpc29uIjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2Nh\nbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFN0\nYXRlQ29tcGFyaXNvblZlcnNpb25TdHJhdGVneS5jbGFzcyk7CgogICAgcHVi\nbGljIFN0cmluZyBnZXRBbGlhcygpIHsKICAgICAgICByZXR1cm4gQUxJQVM7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbWFwKGJvb2xlYW4gYWRhcHQpIHsK\nICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gdmVycy5nZXRDbGFzc01hcHBp\nbmcoKTsKICAgICAgICBpZiAoY2xzLmdldEpvaW5hYmxlUENTdXBlcmNsYXNz\nTWFwcGluZygpICE9IG51bGwKICAgICAgICAgICAgfHwgY2xzLmdldEVtYmVk\nZGluZ01ldGFEYXRhKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3\nIE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtYmFzZS12ZXJzIiwg\nY2xzKSk7CgogICAgICAgIHZlcnMuZ2V0TWFwcGluZ0luZm8oKS5hc3NlcnRO\nb1NjaGVtYUNvbXBvbmVudHModmVycywgdHJ1ZSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgaW5zZXJ0KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNT\ndG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHMgPSAo\nRmllbGRNYXBwaW5nW10pIHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGRzKCk7\nCiAgICAgICAgT2JqZWN0W10gc3RhdGUgPSBBcnJheVN0YXRlSW1hZ2UubmV3\nSW1hZ2UoZmllbGRzLmxlbmd0aCk7CiAgICAgICAgQml0U2V0IGxvYWRlZCA9\nIEFycmF5U3RhdGVJbWFnZS5nZXRMb2FkZWQoc3RhdGUpOwoKICAgICAgICAv\nLyB0YWtlIGEgc25hcHNob3Qgb2YgYWxsIHZlcnNpb25hYmxlIGZpZWxkIHZh\nbHVlcwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmICghZmllbGRzW2ldLmlzUHJpbWFy\neUtleSgpICYmIGZpZWxkc1tpXS5pc1ZlcnNpb25hYmxlKCkpIHsKICAgICAg\nICAgICAgICAgIGxvYWRlZC5zZXQoaSk7CiAgICAgICAgICAgICAgICBzdGF0\nZVtpXSA9IHNtLmZldGNoKGZpZWxkc1tpXS5nZXRJbmRleCgpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICBzbS5zZXROZXh0VmVyc2lvbihz\ndGF0ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyBm\nb3IgY2xhc3MgbWFwcGluZ3MgdGhhdCB0YWtlIG92ZXIgdGhlIGluc2VydAog\nICAgICogcHJvY2VzcywgYnV0IHN0aWxsIHdhbnQgdG8gdXNlIHRoaXMgaW5k\naWNhdG9yIGZvciBvcHRpbWlzdGljIGxvY2tpbmcuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIGN1c3RvbUluc2VydChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgaW5zZXJ0KHNtLCBzdG9yZSwgbnVsbCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdXBkYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20s\nIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBy\nZWNvcmRlZCBzdGF0ZSAoZm9yIGV4YW1wbGUsIG1vZGlmaWNhdGlvbiBtYWRl\nIHRvCiAgICAgICAgLy8gaG9sbG93IGluc3RhbmNlIGFuZCBubyBmaWVsZHMg\nZXZlcnkgbG9hZGVkKSwgY2FuJ3QgZG8gYW55dGhpbmcKICAgICAgICBPYmpl\nY3RbXSBzdGF0ZSA9IChPYmplY3RbXSkgc20uZ2V0VmVyc2lvbigpOwogICAg\nICAgIGlmIChzdGF0ZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47Cgog\nICAgICAgIEJpdFNldCBsb2FkZWQgPSBBcnJheVN0YXRlSW1hZ2UuZ2V0TG9h\nZGVkKHN0YXRlKTsKICAgICAgICBPYmplY3RbXSBuZXh0U3RhdGUgPSBBcnJh\neVN0YXRlSW1hZ2UuY2xvbmUoc3RhdGUpOwoKICAgICAgICAvLyBsb29wIHRo\ncm91Z2ggZmllbGRzIGFuZCB1cGRhdGUgY2hhbmdpbmcgdmFsdWVzIGZvciB0\naGUgbmV4dCBzdGF0ZQogICAgICAgIC8vIGltYWdlLCBwbHVzIGFkZCBXSEVS\nRSBjb25kaXRpb25zIG9uIHVwZGF0ZXMgdG8gbWFrZSBzdXJlIHRoYXQKICAg\nICAgICAvLyBkYiB2YWx1ZXMgbWF0Y2ggb3VyIHByZXZpb3VzIGltYWdlCiAg\nICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzID0gKEZpZWxkTWFwcGluZ1td\nKSBzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkcygpOwogICAgICAgIFJvdyBy\nb3c7CiAgICAgICAgaWYgKHNtLmlzVmVyc2lvbkNoZWNrUmVxdWlyZWQoKSkg\newogICAgICAgICAgICBmb3IgKGludCBpID0gMCwgbWF4ID0gbG9hZGVkLmxl\nbmd0aCgpOyBpIDwgbWF4OyBpKyspIHsKICAgICAgICAgICAgICAgIGlmICgh\nbG9hZGVkLmdldChpKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsK\nCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgb3VyIG5leHQgc3RhdGUgaW1h\nZ2Ugd2l0aCB0aGUgbmV3IGZpZWxkIHZhbHVlCiAgICAgICAgICAgICAgICBp\nZiAoc20uZ2V0RGlydHkoKS5nZXQoaSkgJiYgIXNtLmdldEZsdXNoZWQoKS5n\nZXQoaSkpCiAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlW2ldID0gc20u\nZmV0Y2goZmllbGRzW2ldLmdldEluZGV4KCkpOwoKICAgICAgICAgICAgICAg\nIC8vIGZldGNoIHRoZSByb3cgZm9yIHRoaXMgZmllbGQ7IGlmIG5vIHJvdyBl\neGlzdHMsIHRoZW4gd2UgY2FuJ3QKICAgICAgICAgICAgICAgIC8vIGFkZCBv\nbmUgYmVjYXVzZSB3ZSBoYXZlIG5vIHVwZGF0ZXMgdG8gcGVyZm9ybTsgdGhh\ndCBtZWFucyB3ZQogICAgICAgICAgICAgICAgLy8gd29uJ3QgZGV0ZWN0IE9M\nIGV4Y2VwdGlvbnMgd2hlbiBhbm90aGVyIHRyYW5zYWN0aW9uIGNoYW5nZXMK\nICAgICAgICAgICAgICAgIC8vIGZpZWxkcyB0aGF0IGFyZW4ndCBpbiBhbnkg\nb2YgdGhlIHNhbWUgdGFibGVzIGFzIGZpZWxkcyB0aGF0CiAgICAgICAgICAg\nICAgICAvLyB0aGlzIHRyYW5zYWN0aW9uIGNoYW5nZWQKICAgICAgICAgICAg\nICAgIHJvdyA9IHJtLmdldFJvdyhmaWVsZHNbaV0uZ2V0VGFibGUoKSwgUm93\nLkFDVElPTl9VUERBVEUsCiAgICAgICAgICAgICAgICAgICAgc20sIGZhbHNl\nKTsKICAgICAgICAgICAgICAgIGlmIChyb3cgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAvLyBzZXQg\nV0hFUkUgY3JpdGVyaWEgbWF0Y2hpbmcgdGhlIHByZXZpb3VzIHN0YXRlIGlt\nYWdlIHNvIHRoZQogICAgICAgICAgICAgICAgLy8gdXBkYXRlIHdpbGwgZmFp\nbCBmb3IgYW55IGNoYW5nZXMgbWFkZSBieSBhbm90aGVyIHRyYW5zYWN0aW9u\nCiAgICAgICAgICAgICAgICBmaWVsZHNbaV0ud2hlcmUoc20sIHN0b3JlLCBy\nbSwgc3RhdGVbaV0pOwogICAgICAgICAgICAgICAgcm93LnNldEZhaWxlZE9i\namVjdChzbS5nZXRNYW5hZ2VkSW5zdGFuY2UoKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgc20uc2V0TmV4dFZlcnNpb24obmV4dFN0YXRl\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgbWV0aG9kIGlzIGZvciBj\nbGFzcyBtYXBwaW5ncyB0aGF0IHRha2Ugb3ZlciB0aGUgdXBkYXRlCiAgICAg\nKiBwcm9jZXNzLCBidXQgc3RpbGwgd2FudCB0byB1c2UgdGhpcyBpbmRpY2F0\nb3IgZm9yIG9wdGltaXN0aWMgbG9ja2luZy4KICAgICAqCiAgICAgKiBAcGFy\nYW0gc20gdGhlIGluc3RhbmNlIHRvIHRlc3QKICAgICAqIEBwYXJhbSBzdG9y\nZSBzdG9yZSBtYW5hZ2VyIGNvbnRleHQKICAgICAqIEBwYXJhbSB0YWJsZSBv\nbmx5IHN0YXRlIGltYWdlIHZhbHVlcyBpbiB0aGlzIHRhYmxlIHdpbGwgYmUg\ndGVzdGVkOwogICAgICogaWYgdGhlIGN1c3RvbSBtYXBwaW5nIHVzZXMgZGlm\nZmVyZW50IHVwZGF0ZXMgZm9yCiAgICAgKiBkaWZmZXJlbnQgdGFibGVzLCB0\naGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIG11bHRpcGxlCiAgICAgKiB0aW1l\ncyBmb3IgdGhlIG11bHRpcGxlIHRhYmxlcwogICAgICogQHBhcmFtIHJlY29y\nZCBzZXQgdGhpcyBwYXJhbWV0ZXIgdG8gdHJ1ZSB0aGUgbGFzdCB0aW1lIHlv\ndSBjYWxsCiAgICAgKiB0aGlzIG1ldGhvZCwgc28gdGhlIGluZGljYXRvciBj\nYW4gc2V0dXAgdGhlIG5leHQKICAgICAqIHZlcnNpb24gb2YgdGhlIGdpdmVu\nIHN0YXRlIG1hbmFnZXIKICAgICAqIEByZXR1cm4gYSB7QGxpbmsgQ3VzdG9t\nVXBkYXRlfSB3aG9zZSBnZXRTUUwgbWV0aG9kIHlpZWxkcyBhCiAgICAgKiBi\nb29sZWFuIFNRTCBleHByZXNzaW9uIHRoYXQgdGVzdHMgd2hldGhlciB0aGUg\nY3VycmVudAogICAgICogcmVjb3JkIGlzIGVxdWFsIHRvIG91ciByZWNvcmRl\nZCBzdGF0ZSBpbWFnZSwgYW5kIHdob3NlCiAgICAgKiBzZXRQYXJhbWV0ZXJz\nIG1ldGhvZCBwYXJhbWV0ZXJpemVzIHRoZSBnaXZlbiBwcmVwYXJlZAogICAg\nICogc3RhdGVtZW50IHdpdGggdGhlIHZhbHVlcyB1c2VkIGluIHRoZSBhYm92\nZSBib29sZWFuIGV4cHJlc3Npb24KICAgICAqLwogICAgcHVibGljIEN1c3Rv\nbVVwZGF0ZSBjdXN0b21VcGRhdGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwg\nSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIFRhYmxlIHRhYmxlLCBib29sZWFu\nIHJlY29yZCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBDdXN0b21VcGRhdGUgY3VzdG9tID0gbmV3IEN1c3RvbVVwZGF0ZSh0YWJs\nZSk7CiAgICAgICAgT2JqZWN0W10gc3RhdGUgPSAoT2JqZWN0W10pIHNtLmdl\ndFZlcnNpb24oKTsKICAgICAgICBpZiAoc3RhdGUgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIGN1c3RvbTsKCiAgICAgICAgQml0U2V0IGxvYWRlZCA9\nIEFycmF5U3RhdGVJbWFnZS5nZXRMb2FkZWQoc3RhdGUpOwogICAgICAgIE9i\namVjdFtdIG5leHRTdGF0ZSA9IG51bGw7CiAgICAgICAgaWYgKHJlY29yZCkK\nICAgICAgICAgICAgbmV4dFN0YXRlID0gQXJyYXlTdGF0ZUltYWdlLmNsb25l\nKHN0YXRlKTsKCiAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzID0gKEZp\nZWxkTWFwcGluZ1tdKSBzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkcygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwLCBtYXggPSBsb2FkZWQubGVuZ3RoKCk7\nIGkgPCBtYXg7IGkrKykgewogICAgICAgICAgICBpZiAoIWxvYWRlZC5nZXQo\naSkpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIGlm\nIChyZWNvcmQgJiYgc20uZ2V0RGlydHkoKS5nZXQoaSkgJiYgIXNtLmdldEZs\ndXNoZWQoKS5nZXQoaSkpCiAgICAgICAgICAgICAgICBuZXh0U3RhdGVbaV0g\nPSBzbS5mZXRjaChmaWVsZHNbaV0uZ2V0SW5kZXgoKSk7CiAgICAgICAgICAg\nIGlmIChmaWVsZHNbaV0uZ2V0VGFibGUoKSA9PSB0YWJsZSkKICAgICAgICAg\nICAgICAgIGZpZWxkc1tpXS53aGVyZShzbSwgc3RvcmUsIGN1c3RvbSwgc3Rh\ndGVbaV0pOwogICAgICAgIH0KICAgICAgICBpZiAocmVjb3JkKQogICAgICAg\nICAgICBzbS5zZXROZXh0VmVyc2lvbihuZXh0U3RhdGUpOwoKICAgICAgICBy\nZXR1cm4gY3VzdG9tOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFmdGVyTG9h\nZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUpIHsK\nICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHMgPSAoRmllbGRNYXBwaW5n\nW10pIHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGRzKCk7CgogICAgICAgIE9i\namVjdFtdIHN0YXRlID0gKE9iamVjdFtdKSBzbS5nZXRWZXJzaW9uKCk7CiAg\nICAgICAgaWYgKHN0YXRlID09IG51bGwpCiAgICAgICAgICAgIHN0YXRlID0g\nQXJyYXlTdGF0ZUltYWdlLm5ld0ltYWdlKGZpZWxkcy5sZW5ndGgpOwogICAg\nICAgIEJpdFNldCBsb2FkZWQgPSBBcnJheVN0YXRlSW1hZ2UuZ2V0TG9hZGVk\nKHN0YXRlKTsKCiAgICAgICAgLy8gdGFrZSBhIHNuYXBzaG90IG9mIGFsbCB2\nZXJzaW9uYWJsZSBmaWVsZCB2YWx1ZXMgdGhhdCB3ZXJlIGxvYWRlZAogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGlmICghZmllbGRzW2ldLmlzUHJpbWFyeUtleSgpCiAg\nICAgICAgICAgICAgICAmJiBmaWVsZHNbaV0uaXNWZXJzaW9uYWJsZSgpCiAg\nICAgICAgICAgICAgICAmJiBzbS5nZXRMb2FkZWQoKS5nZXQoZmllbGRzW2ld\nLmdldEluZGV4KCkpCiAgICAgICAgICAgICAgICAmJiAhbG9hZGVkLmdldChp\nKQogICAgICAgICAgICAgICAgJiYgIXNtLmdldERpcnR5KCkuZ2V0KGZpZWxk\nc1tpXS5nZXRJbmRleCgpKSkgewogICAgICAgICAgICAgICAgbG9hZGVkLnNl\ndChpKTsKICAgICAgICAgICAgICAgIHN0YXRlW2ldID0gc20uZmV0Y2goZmll\nbGRzW2ldLmdldEluZGV4KCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHNtLnNldFZlcnNpb24oc3RhdGUpOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGNoZWNrVmVyc2lvbihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgYm9vbGVhbiB1cGRhdGVWZXJz\naW9uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nICh1cGRhdGVWZXJzaW9uKQogICAgICAgICAgICBzbS5zZXRWZXJzaW9uKG51\nbGwpOwogICAgICAgIHJldHVybiAhdXBkYXRlVmVyc2lvbjsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IGNvbXBhcmVWZXJzaW9uKE9iamVjdCB2MSwgT2JqZWN0\nIHYyKSB7CiAgICAgICAgcmV0dXJuIChBcnJheVN0YXRlSW1hZ2Uuc2FtZVZl\ncnNpb24oKE9iamVjdFtdKSB2MSwgKE9iamVjdFtdKSB2MikpCiAgICAgICAg\nICAgID8gU3RvcmVNYW5hZ2VyLlZFUlNJT05fU0FNRSA6IFN0b3JlTWFuYWdl\nci5WRVJTSU9OX0RJRkZFUkVOVDsKICAgIH0KCiAgICAvKioKICAgICAqIFJv\ndyBpbXBsZW1lbnRhdGlvbiB3ZSB1c2UgdG8gcGFzcyB0byB2ZXJzaW9uYWJs\nZSBtYXBwaW5ncyBzbyB0aGV5CiAgICAgKiBjYW4gc2V0IHVwIHRoZSB3aGVy\nZSBjb25kaXRpb25zIHdlIG5lZWQgdG8gYWRkIHRvIHVwZGF0ZSBzdGF0ZW1l\nbnRzLgogICAgICoKICAgICAqIEBhdXRob3IgQWJlIFdoaXRlCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ3VzdG9tVXBkYXRlCiAgICAgICAg\nZXh0ZW5kcyBSb3dJbXBsCiAgICAgICAgaW1wbGVtZW50cyBSb3dNYW5hZ2Vy\nIHsKCiAgICAgICAgcHJpdmF0ZSBDdXN0b21VcGRhdGUoVGFibGUgdGFibGUp\nIHsKICAgICAgICAgICAgdGhpcyh0YWJsZS5nZXRDb2x1bW5zKCkpOwogICAg\nICAgIH0KCiAgICAgICAgcHJpdmF0ZSBDdXN0b21VcGRhdGUoQ29sdW1uW10g\nY29scykgewogICAgICAgICAgICBzdXBlcihjb2xzLCBSb3cuQUNUSU9OX1VQ\nREFURSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1\ncm4gYSBib29sZWFuIFNRTCBleHByZXNzaW9uIHRoYXQgc2hvdWxkIGJlIGFk\nZGVkIHRvIHRoZQogICAgICAgICAqIFdIRVJFIGNsYXVzZSBvZiBhbiBVUERB\nVEUgdG8gdGVzdCB3aGV0aGVyIHRoZSBjdXJyZW50IGRhdGFiYXNlCiAgICAg\nICAgICogcmVjb3JkIG1hdGNoZXMgb3VyIHN0b3JlZCB2ZXJzaW9uLgogICAg\nICAgICAqLwogICAgICAgIHB1YmxpYyBTdHJpbmcgZ2V0U1FMKCkgewogICAg\nICAgICAgICBDb2x1bW5bXSBjb2xzID0gZ2V0VGFibGUoKS5nZXRDb2x1bW5z\nKCk7CiAgICAgICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICAgICAgICAgIGJvb2xlYW4gaGFzV2hlcmUgPSBmYWxz\nZTsKICAgICAgICAgICAgT2JqZWN0IHZhbDsKICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nICAgICB2YWwgPSBnZXRXaGVyZShjb2xzW2ldKTsKICAgICAgICAgICAgICAg\nIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBjb250aW51\nZTsKCiAgICAgICAgICAgICAgICBpZiAoaGFzV2hlcmUpCiAgICAgICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAgICAg\nIGlmICh2YWwgPT0gTlVMTCkKICAgICAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKGNvbHNbaV0pLmFwcGVuZCgiIElTIE5VTEwiKTsKICAgICAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGNvbHNb\naV0pLmFwcGVuZCgiID0gPyIpOwogICAgICAgICAgICAgICAgaGFzV2hlcmUg\nPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBidWYu\ndG9TdHJpbmcoKTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBSb3dJ\nbXBsIG5ld0luc3RhbmNlKENvbHVtbltdIGNvbHMsIGludCBhY3Rpb24pIHsK\nICAgICAgICAgICAgcmV0dXJuIG5ldyBDdXN0b21VcGRhdGUoY29scyk7CiAg\nICAgICAgfQoKICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwogICAgICAgIC8vIFJvd01hbmFnZXIgaW1wbGVtZW50YXRpb24KICAgICAg\nICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBoYXNBdXRvQXNzaWduQ29uc3RyYWludHMoKSB7CiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBDb2xsZWN0aW9uIGdldEluc2VydHMoKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIENvbGxlY3Rpb24gZ2V0VXBkYXRlcygpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXREZWxldGVzKCkgewogICAgICAg\nICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFNlY29uZGFyeVVwZGF0\nZXMoKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlv\nbigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIENvbGxlY3Rpb24gZ2V0\nU2Vjb25kYXJ5RGVsZXRlcygpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElu\ndGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nQ29sbGVjdGlvbiBnZXRBbGxSb3dVcGRhdGVzKCkgewogICAgICAgICAgICB0\naHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldEFsbFJvd0RlbGV0ZXMoKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFJvdyBnZXRSb3coVGFibGUgdGFibGUs\nIGludCBhY3Rpb24sIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAg\nICAgIGJvb2xlYW4gY3JlYXRlKSB7CiAgICAgICAgICAgIC8vIHZlcmlvbmFi\nbGUgbWFwcGluZ3Mgd2lsbCBuZXZlciB3YW50IHRvIGNyZWF0ZSByb3dzLCBz\nbyB3ZQogICAgICAgICAgICAvLyBjYW4gYWx3YXlzIHNhZmVseSByZXR1cm4g\nbnVsbAogICAgICAgICAgICBpZiAodGFibGUgIT0gZ2V0VGFibGUoKSkKICAg\nICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICByZXR1cm4g\ndGhpczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSb3cgZ2V0U2Vjb25k\nYXJ5Um93KFRhYmxlIHRhYmxlLCBpbnQgYWN0aW9uKSB7CiAgICAgICAgICAg\nIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHZvaWQgZmx1c2hTZWNvbmRhcnlSb3coUm93IHJvdykg\newogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJvdyBnZXRBbGxSb3dzKFRh\nYmxlIHRhYmxlLCBpbnQgYWN0aW9uKSB7CiAgICAgICAgICAgIHRocm93IG5l\ndyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgZmx1c2hBbGxSb3dzKFJvdyByb3cpIHsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHNldE9iamVjdChDb2x1bW4gY29sLCBPYmpl\nY3QgdmFsKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAg\nICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

