{"sha":"86f8320ffc40bb7c0fe85d5ccd23fe5ed5a6adeb","node_id":"MDQ6QmxvYjIwNjM2NDo4NmY4MzIwZmZjNDBiYjdjMGZlODVkNWNjZDIzZmU1ZWQ1YTZhZGVi","size":5003,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/86f8320ffc40bb7c0fe85d5ccd23fe5ed5a6adeb","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9y\ndCBqYXZhLnV0aWwuVHJlZVNldDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRpc2NyaW1pbmF0b3I7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRpc2NyaW1pbmF0b3JNYXBw\naW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuU2NoZW1hczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5K\nYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRh\nRGF0YUV4Y2VwdGlvbjsKCi8qKgogKiBNYXBzIG1ldGFkYXRhLWdpdmVuIHZh\nbHVlcyB0byBjbGFzc2VzLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8K\ncHVibGljIGNsYXNzIFZhbHVlTWFwRGlzY3JpbWluYXRvclN0cmF0ZWd5CiAg\nICBleHRlbmRzIEluVmFsdWVEaXNjcmltaW5hdG9yU3RyYXRlZ3kgewoKICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFMSUFTID0gInZhbHVlLW1h\ncCI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChWYWx1ZU1hcERpc2Ny\naW1pbmF0b3JTdHJhdGVneS5jbGFzcyk7CgogICAgcHJpdmF0ZSBNYXAgX3Zh\nbHMgPSBudWxsOwoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QWxpYXMoKSB7CiAg\nICAgICAgcmV0dXJuIEFMSUFTOwogICAgfQoKICAgIHByb3RlY3RlZCBpbnQg\nZ2V0SmF2YVR5cGUoKSB7CiAgICAgICAgT2JqZWN0IHZhbCA9IGRpc2MuZ2V0\nVmFsdWUoKTsKICAgICAgICBpZiAodmFsICE9IG51bGwgJiYgdmFsICE9IERp\nc2NyaW1pbmF0b3IuTlVMTCkKICAgICAgICAgICAgcmV0dXJuIEphdmFUeXBl\ncy5nZXRUeXBlQ29kZSh2YWwuZ2V0Q2xhc3MoKSk7CgogICAgICAgIC8vIGlm\nIHRoZSB1c2VyIHdhbnRzIHRoZSB0eXBlIHRvIGJlIG51bGwsIHdlIG5lZWQg\nYSBqZGJjLXR5cGUKICAgICAgICAvLyBvbiB0aGUgY29sdW1uIG9yIGFuIGV4\naXN0aW5nIGNvbHVtbiB0byBmaWd1cmUgb3V0IHRoZSBqYXZhIHR5cGUKICAg\nICAgICBEaXNjcmltaW5hdG9yTWFwcGluZ0luZm8gaW5mbyA9IGRpc2MuZ2V0\nTWFwcGluZ0luZm8oKTsKICAgICAgICBMaXN0IGNvbHMgPSBpbmZvLmdldENv\nbHVtbnMoKTsKICAgICAgICBDb2x1bW4gY29sID0gKGNvbHMuaXNFbXB0eSgp\nKSA/IG51bGwgOiAoQ29sdW1uKSBjb2xzLmdldCgwKTsKICAgICAgICBpZiAo\nY29sICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKGNvbC5nZXRKYXZhVHlw\nZSgpICE9IEphdmFUeXBlcy5PQkpFQ1QpCiAgICAgICAgICAgICAgICByZXR1\ncm4gY29sLmdldEphdmFUeXBlKCk7CiAgICAgICAgICAgIGlmIChjb2wuZ2V0\nVHlwZSgpICE9IFR5cGVzLk9USEVSKQogICAgICAgICAgICAgICAgcmV0dXJu\nIEphdmFUeXBlcy5nZXRUeXBlQ29kZShTY2hlbWFzLmdldEphdmFUeXBlCiAg\nICAgICAgICAgICAgICAgICAgKGNvbC5nZXRUeXBlKCksIGNvbC5nZXRTaXpl\nKCksIGNvbC5nZXREZWNpbWFsRGlnaXRzKCkpKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIEphdmFUeXBlcy5TVFJJTkc7CiAgICB9CgogICAgcHJvdGVj\ndGVkIE9iamVjdCBnZXREaXNjcmltaW5hdG9yVmFsdWUoQ2xhc3NNYXBwaW5n\nIGNscykgewogICAgICAgIE9iamVjdCB2YWwgPSBjbHMuZ2V0RGlzY3JpbWlu\nYXRvcigpLmdldFZhbHVlKCk7CiAgICAgICAgcmV0dXJuICh2YWwgPT0gRGlz\nY3JpbWluYXRvci5OVUxMKSA/IG51bGwgOiB2YWw7CiAgICB9CgogICAgcHJv\ndGVjdGVkIENsYXNzIGdldENsYXNzKE9iamVjdCB2YWwsIEpEQkNTdG9yZSBz\ndG9yZSkKICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKF92YWxzID09IG51bGwpIHsKICAgICAgICAgICAgQ2xh\nc3NNYXBwaW5nIGNscyA9IGRpc2MuZ2V0Q2xhc3NNYXBwaW5nKCk7CiAgICAg\nICAgICAgIENsYXNzTWFwcGluZ1tdIHN1YnMgPSBjbHMuZ2V0Sm9pbmFibGVQ\nQ1N1YmNsYXNzTWFwcGluZ3MoKTsKICAgICAgICAgICAgTWFwIG1hcCA9IG5l\ndyBIYXNoTWFwKChpbnQpICgoc3Vicy5sZW5ndGggKyAxKSAqIDEuMzMgKyAx\nKSk7CiAgICAgICAgICAgIG1hcERpc2NyaW1pbmF0b3JWYWx1ZShjbHMsIG1h\ncCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgICAgIG1hcERpc2NyaW1pbmF0b3JWYWx1\nZShzdWJzW2ldLCBtYXApOwogICAgICAgICAgICBfdmFscyA9IG1hcDsKICAg\nICAgICB9CgogICAgICAgIFN0cmluZyBzdHIgPSAodmFsID09IG51bGwpID8g\nbnVsbCA6IHZhbC50b1N0cmluZygpOwogICAgICAgIENsYXNzIGNscyA9IChD\nbGFzcykgX3ZhbHMuZ2V0KHN0cik7CiAgICAgICAgaWYgKGNscyAhPSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gY2xzOwogICAgICAgIHRocm93IG5ldyBD\nbGFzc05vdEZvdW5kRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bmtub3duLWRpc2Ny\naW0tdmFsdWUiLAogICAgICAgICAgICBuZXcgT2JqZWN0W117IHN0ciwgZGlz\nYy5nZXRDbGFzc01hcHBpbmcoKS5nZXREZXNjcmliZWRUeXBlKCkuCiAgICAg\nICAgICAgIGdldE5hbWUoKSwgbmV3IFRyZWVTZXQoX3ZhbHMua2V5U2V0KCkp\nIH0pLmdldE1lc3NhZ2UoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXAg\ndGhlIHN0cmluZ2lmaWVkIHZlcnNpb24gb2YgdGhlIGRpc2NyaW1pbmF0b3Ig\ndmFsdWUgb2YgdGhlIGdpdmVuIHR5cGUuCiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIHZvaWQgbWFwRGlzY3JpbWluYXRvclZhbHVlKENsYXNzTWFwcGlu\nZyBjbHMsIE1hcCBtYXApIHsKICAgICAgICAvLyBwb3NzaWJsZSB0aGF0IHNv\nbWUgdHlwZXMgd2lsbCBuZXZlciBiZSBwZXJzaXN0ZWQgYW5kIHRoZXJlZm9y\nZQogICAgICAgIC8vIGNhbiBoYXZlIG5vIGRpc2NyaW1pbmF0b3IgdmFsdWUK\nICAgICAgICBPYmplY3QgdmFsID0gY2xzLmdldERpc2NyaW1pbmF0b3IoKS5n\nZXRWYWx1ZSgpOwogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBTdHJpbmcgc3RyID0gKHZhbCA9PSBEaXNj\ncmltaW5hdG9yLk5VTEwpID8gbnVsbCA6IHZhbC50b1N0cmluZygpOwogICAg\nICAgIENsYXNzIGV4aXN0ID0gKENsYXNzKSBtYXAuZ2V0KHN0cik7CiAgICAg\nICAgaWYgKGV4aXN0ICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBN\nZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZHVwLWRpc2NyaW0tdmFsdWUi\nLAogICAgICAgICAgICAgICAgc3RyLCBleGlzdCwgY2xzKSk7CiAgICAgICAg\nbWFwLnB1dChzdHIsIGNscy5nZXREZXNjcmliZWRUeXBlKCkpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIG1hcChib29sZWFuIGFkYXB0KSB7CiAgICAgICAg\nT2JqZWN0IHZhbCA9IGRpc2MuZ2V0TWFwcGluZ0luZm8oKS5nZXRWYWx1ZShk\naXNjLCBhZGFwdCk7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsICYmICFNb2Rp\nZmllci5pc0Fic3RyYWN0KGRpc2MuZ2V0Q2xhc3NNYXBwaW5nKCkuCiAgICAg\nICAgICAgIGdldERlc2NyaWJlZFR5cGUoKS5nZXRNb2RpZmllcnMoKSkpCiAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgibm8tZGlzY3JpbS12YWx1ZSIsCiAgICAgICAgICAgICAgICBkaXNjLmdl\ndENsYXNzTWFwcGluZygpKSk7CgogICAgICAgIC8vIHdlIHNldCB0aGUgdmFs\ndWUgYmVmb3JlIG1hcHBpbmcgdG8gdXNlIHRvIGNhbGN1bGF0ZSB0aGUgdGVt\ncGxhdGUKICAgICAgICAvLyBjb2x1bW4ncyBqYXZhIHR5cGUKICAgICAgICBk\naXNjLnNldFZhbHVlKHZhbCk7CiAgICAgICAgc3VwZXIubWFwKGFkYXB0KTsK\nICAgIH0KfQo=\n","encoding":"base64"}

