{"sha":"fed5b547dc19e34e14d3cb8d4db53d1707d50bdc","node_id":"MDQ6QmxvYjIwNjM2NDpmZWQ1YjU0N2RjMTllMzRlMTRkM2NiOGQ0ZGI1M2QxNzA3ZDUwYmRj","size":5813,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fed5b547dc19e34e14d3cb8d4db53d1707d50bdc","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRC\nQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5D\nbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkNsYXNzTWFwcGluZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5tZXRhLkRlbGVnYXRpbmdKb2luYWJsZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuSm9pbmFibGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuUHJpbWFyeUtleTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Kb2luczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3Q7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNl\ncHRpb247CgovKioKICogTWFwcGluZyBmb3Igc3ViY2xhc3NlcyB0aGF0IGpv\naW4gdG8gdGhlaXIgc3VwZXJjbGFzcyB0YWJsZS4KICoKICogQGF1dGhvciBB\nYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBWZXJ0aWNhbENsYXNzU3RyYXRl\nZ3kKICAgIGV4dGVuZHMgQWJzdHJhY3RDbGFzc1N0cmF0ZWd5IHsKCiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBTElBUyA9ICJ2ZXJ0aWNhbCI7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChWZXJ0aWNhbENsYXNzU3Ry\nYXRlZ3kuY2xhc3MpOwoKICAgIHByaXZhdGUgQm9vbGVhbiBfZmtPaWQgPSBu\ndWxsOwoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QWxpYXMoKSB7CiAgICAgICAg\ncmV0dXJuIEFMSUFTOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG1hcChib29s\nZWFuIGFkYXB0KSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIHN1cCA9IGNscy5n\nZXRNYXBwZWRQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAgICAgICAgaWYgKHN1\ncCA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vdC1zdWIiLCBjbHMpKTsKCiAgICAgICAgQ2xh\nc3NNYXBwaW5nSW5mbyBpbmZvID0gY2xzLmdldE1hcHBpbmdJbmZvKCk7CiAg\nICAgICAgaW5mby5hc3NlcnROb0luZGV4KGNscywgZmFsc2UpOwogICAgICAg\nIGluZm8uYXNzZXJ0Tm9VbmlxdWUoY2xzLCBmYWxzZSk7CgogICAgICAgIC8v\nIGZvcmVpZ24ga2V5IGZyb20gdGhpcyBjbGFzcyB0byBvdXIgc3VwZXJjbGFz\ncwogICAgICAgIFRhYmxlIHRhYmxlID0gaW5mby5nZXRUYWJsZShjbHMsIGFk\nYXB0KTsKICAgICAgICBGb3JlaWduS2V5IGZrID0gaW5mby5nZXRTdXBlcmNs\nYXNzSm9pbihjbHMsIHRhYmxlLCBhZGFwdCk7CiAgICAgICAgQ29sdW1uW10g\ncGtDb2xzID0gZmsuZ2V0Q29sdW1ucygpOwoKICAgICAgICBjbHMuc2V0VGFi\nbGUodGFibGUpOwogICAgICAgIGNscy5zZXRKb2luRm9yZWlnbktleShmayk7\nCiAgICAgICAgY2xzLnNldFByaW1hcnlLZXlDb2x1bW5zKHBrQ29scyk7CiAg\nICAgICAgY2xzLnNldENvbHVtbklPKGluZm8uZ2V0Q29sdW1uSU8oKSk7Cgog\nICAgICAgIC8vIGFkZCBhIHByaW1hcnkga2V5IGlmIHdlIGRvbid0IGhhdmUg\nb25lIGFscmVhZHkKICAgICAgICBQcmltYXJ5S2V5IHBrID0gdGFibGUuZ2V0\nUHJpbWFyeUtleSgpOwogICAgICAgIGlmIChwayA9PSBudWxsKSB7CiAgICAg\nICAgICAgIFN0cmluZyBwa25hbWUgPSBudWxsOwogICAgICAgICAgICBpZiAo\nYWRhcHQpCiAgICAgICAgICAgICAgICBwa25hbWUgPSBjbHMuZ2V0TWFwcGlu\nZ1JlcG9zaXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMoKS4KICAgICAgICAg\nICAgICAgICAgICBnZXRQcmltYXJ5S2V5TmFtZShjbHMsIHRhYmxlKTsKICAg\nICAgICAgICAgcGsgPSB0YWJsZS5hZGRQcmltYXJ5S2V5KHBrbmFtZSk7CiAg\nICAgICAgICAgIHBrLnNldExvZ2ljYWwoIWFkYXB0KTsKICAgICAgICAgICAg\ncGsuc2V0Q29sdW1ucyhwa0NvbHMpOwogICAgICAgIH0KCiAgICAgICAgLy8g\nbWFwIGpvaW5hYmxlcwogICAgICAgIEpvaW5hYmxlIGpvaW47CiAgICAgICAg\nQ29sdW1uW10gY29sczsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBr\nQ29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBtYXkgaGF2ZSBh\nbHJlYWR5IHJlZ2lzdGVyZWQgYSBtdWx0aS1jb2x1bW4gam9pbmFibGUKICAg\nICAgICAgICAgaWYgKGNscy5nZXRKb2luYWJsZShwa0NvbHNbaV0pICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIC8v\nIGNyZWF0ZSBqb2luYWJsZSB0aGF0IGRlbGVnYXRlcyBhbGwgbWV0aG9kcyB0\nbyB0aGUgc3VwZXJjbGFzcycKICAgICAgICAgICAgLy8gam9pbmFibGUsIGJ1\ndCBjaGFuZ2VzIHRoZSBjb2x1bW5zIGFzIGFwcHJvcHJpYXRlIHVzaW5nCiAg\nICAgICAgICAgIC8vIG91ciBzdXBlcmNsYXNzIGpvaW4gZmsKICAgICAgICAg\nICAgam9pbiA9IHN1cC5hc3NlcnRKb2luYWJsZShmay5nZXRQcmltYXJ5S2V5\nQ29sdW1uKHBrQ29sc1tpXSkpOwogICAgICAgICAgICBqb2luID0gbmV3IERl\nbGVnYXRpbmdKb2luYWJsZShqb2luLCBmayk7CiAgICAgICAgICAgIGNvbHMg\nPSBqb2luLmdldENvbHVtbnMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9\nIDA7IGogPCBjb2xzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgY2xz\nLnNldEpvaW5hYmxlKGNvbHNbal0sIGpvaW4pOwogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBpbml0aWFsaXplKCkgewogICAgICAgIC8vIHRo\naXMgcmVxdWlyZXMgYWxsIGZpZWxkcyB0byBiZSByZXNvbHZlZCwgc28gZGVs\nYXkgaXQgdW50aWwgaW5pdAogICAgICAgIENsYXNzTWFwcGluZyBzdXAgPSBj\nbHMuZ2V0TWFwcGVkUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgIF9m\na09pZCA9IHN1cC5pc0ZvcmVpZ25LZXlPYmplY3RJZChjbHMuZ2V0Sm9pbkZv\ncmVpZ25LZXkoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5zZXJ0KE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFu\nYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBSb3cgcm93ID0gcm0uZ2V0Um93KGNscy5nZXRUYWJsZSgpLCBSb3cuQUNU\nSU9OX0lOU0VSVCwgc20sIHRydWUpOwogICAgICAgIHJvdy5zZXRQcmltYXJ5\nS2V5KGNscy5nZXRDb2x1bW5JTygpLCBzbSk7CiAgICAgICAgcm93LnNldEZv\ncmVpZ25LZXkoY2xzLmdldEpvaW5Gb3JlaWduS2V5KCksIGNscy5nZXRDb2x1\nbW5JTygpLCBzbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdXBkYXRlKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFu\nYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBSb3cgcm93ID0gcm0uZ2V0Um93KGNscy5nZXRUYWJsZSgpLCBSb3cuQUNU\nSU9OX1VQREFURSwgc20sIGZhbHNlKTsKICAgICAgICBpZiAocm93ICE9IG51\nbGwpIHsKICAgICAgICAgICAgcm93LndoZXJlUHJpbWFyeUtleShzbSk7CiAg\nICAgICAgICAgIHJvdy53aGVyZUZvcmVpZ25LZXkoY2xzLmdldEpvaW5Gb3Jl\naWduS2V5KCksIHNtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgZGVsZXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBz\ndG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBSb3cgcm93ID0gcm0uZ2V0Um93KGNscy5nZXRUYWJs\nZSgpLCBSb3cuQUNUSU9OX0RFTEVURSwgc20sIHRydWUpOwogICAgICAgIHJv\ndy53aGVyZVByaW1hcnlLZXkoc20pOwogICAgICAgIHJvdy53aGVyZUZvcmVp\nZ25LZXkoY2xzLmdldEpvaW5Gb3JlaWduS2V5KCksIHNtKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc1ByaW1hcnlLZXlPYmplY3RJZChib29sZWFu\nIGhhc0FsbCkgewogICAgICAgIHJldHVybiBCb29sZWFuLlRSVUUuZXF1YWxz\nKF9ma09pZCkgfHwgKCFoYXNBbGwgJiYgX2ZrT2lkID09IG51bGwpOwogICAg\nfQoKICAgIHB1YmxpYyBKb2lucyBqb2luU3VwZXJjbGFzcyhKb2lucyBqb2lu\ncywgYm9vbGVhbiB0b1RoaXMpIHsKICAgICAgICBpZiAodG9UaGlzKQogICAg\nICAgICAgICByZXR1cm4gam9pbnMub3V0ZXJKb2luKGNscy5nZXRKb2luRm9y\nZWlnbktleSgpLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgcmV0dXJuIGpvaW5z\nLmpvaW4oY2xzLmdldEpvaW5Gb3JlaWduS2V5KCksIGZhbHNlLCBmYWxzZSk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNFYWdlclNlbGVj\ndChTZWxlY3Qgc2VsLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAogICAgICAg\nIEpEQkNTdG9yZSBzdG9yZSwgQ2xhc3NNYXBwaW5nIGJhc2UsIEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4gc3RvcmUu\nZ2V0REJEaWN0aW9uYXJ5KCkuY2FuT3V0ZXJKb2luKHNlbC5nZXRKb2luU3lu\ndGF4KCksCiAgICAgICAgICAgIGNscy5nZXRKb2luRm9yZWlnbktleSgpKTsK\nICAgIH0KfQo=\n","encoding":"base64"}

