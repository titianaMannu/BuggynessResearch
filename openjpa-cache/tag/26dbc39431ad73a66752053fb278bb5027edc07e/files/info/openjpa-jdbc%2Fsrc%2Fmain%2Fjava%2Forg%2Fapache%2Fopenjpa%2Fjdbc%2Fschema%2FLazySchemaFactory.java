{"sha":"e531408cf53588dc1fe6e9d2d505773758333580","node_id":"MDQ6QmxvYjIwNjM2NDplNTMxNDA4Y2Y1MzU4OGRjMWZlNmU5ZDJkNTA1NzczNzU4MzMzNTgw","size":6271,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e531408cf53588dc1fe6e9d2d505773758333580","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFi\nYXNlTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5T\nUUxFeGNlcHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuY29uZi5Db25maWd1cmF0aW9uOwoKLyoqCiAqIEZhY3RvcnkgdGhhdCB1\nc2VzIGRhdGFiYXNlIG1ldGFkYXRhIHRvIGNvbnN0cnVjdCB0aGUgc3lzdGVt\nIHNjaGVtYS4KICogVGhlIGxhenkgc2NoZW1hIGZhY3Rvcnkgb25seSBsb2Fk\ncyB0YWJsZSBkYXRhIGFzIGl0IGlzIHJlcXVlc3RlZC4gSXQKICogZG9lcyBu\nb3QgcHJvcGVybHkgc3VwcG9ydCBvcGVyYXRpb25zIHRoYXQgcmVxdWlyZSBr\nbm93bGVkZ2Ugb2YgdGhlIGVudGlyZQogKiBzY2hlbWEuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgTGF6eVNjaGVtYUZhY3Rv\ncnkKICAgIGV4dGVuZHMgU2NoZW1hR3JvdXAKICAgIGltcGxlbWVudHMgU2No\nZW1hRmFjdG9yeSwgQ29uZmlndXJhYmxlIHsKCiAgICBwcml2YXRlIHRyYW5z\naWVudCBKREJDQ29uZmlndXJhdGlvbiBfY29uZiA9IG51bGw7CiAgICBwcml2\nYXRlIHRyYW5zaWVudCBDb25uZWN0aW9uIF9jb25uID0gbnVsbDsKICAgIHBy\naXZhdGUgdHJhbnNpZW50IERhdGFiYXNlTWV0YURhdGEgX21ldGEgPSBudWxs\nOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgU2NoZW1hR2VuZXJhdG9yIF9nZW4g\nPSBudWxsOwogICAgCiAgICBwcml2YXRlIGJvb2xlYW4gX2luZGV4ZXMgPSBm\nYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfcGtzID0gZmFsc2U7CiAgICBw\ncml2YXRlIGJvb2xlYW4gX2ZrcyA9IGZhbHNlOwoKICAgIHB1YmxpYyBib29s\nZWFuIGdldFByaW1hcnlLZXlzKCkgewogICAgICAgIHJldHVybiBfcGtzOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXlzKGJvb2xlYW4g\ncGtzKSB7CiAgICAgICAgX3BrcyA9IHBrczsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBnZXRGb3JlaWduS2V5cygpIHsKICAgICAgICByZXR1cm4gX2Zr\nczsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRGb3JlaWduS2V5cyhib29s\nZWFuIGZrcykgewogICAgICAgIF9ma3MgPSBma3M7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0SW5kZXhlcygpIHsKICAgICAgICByZXR1cm4gX2lu\nZGV4ZXM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0SW5kZXhlcyhib29s\nZWFuIGlkeCkgewogICAgICAgIF9pbmRleGVzID0gaWR4OwogICAgfQoKICAg\nIHB1YmxpYyBTY2hlbWFHcm91cCByZWFkU2NoZW1hKCkgewogICAgICAgIHJl\ndHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0b3JlU2NoZW1h\nKFNjaGVtYUdyb3VwIHNjaGVtYSkgewogICAgICAgIC8vIG5vdGhpbmcgdG8g\nZG8KICAgIH0KCiAgICBwdWJsaWMgVGFibGUgZmluZFRhYmxlKFN0cmluZyBu\nYW1lKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIFRhYmxlIHRhYmxlID0gc3VwZXIuZmlu\nZFRhYmxlKG5hbWUpOwogICAgICAgIGlmICh0YWJsZSAhPSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gdGFibGU7CgogICAgICAgIGdlbmVyYXRlU2NoZW1h\nT2JqZWN0KG5hbWUsIHRydWUpOwogICAgICAgIHJldHVybiBzdXBlci5maW5k\nVGFibGUobmFtZSk7CiAgICB9CgogICAgcHVibGljIFNlcXVlbmNlIGZpbmRT\nZXF1ZW5jZShTdHJpbmcgbmFtZSkgewogICAgICAgIGlmIChuYW1lID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBTZXF1ZW5j\nZSBzZXEgPSBzdXBlci5maW5kU2VxdWVuY2UobmFtZSk7CiAgICAgICAgaWYg\nKHNlcSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gc2VxOwoKICAgICAg\nICBnZW5lcmF0ZVNjaGVtYU9iamVjdChuYW1lLCBmYWxzZSk7CiAgICAgICAg\ncmV0dXJuIHN1cGVyLmZpbmRTZXF1ZW5jZShuYW1lKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdlbmVyYXRlIHRoZSB0YWJsZSBvciBzZXF1ZW5jZSB3aXRo\nIHRoZSBnaXZlbiBuYW1lLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZ2Vu\nZXJhdGVTY2hlbWFPYmplY3QoU3RyaW5nIG5hbWUsIGJvb2xlYW4gaXNUYWJs\nZSkgewogICAgICAgIC8vIGlmIGZ1bGwgbmFtZSwgc3BsaXQKICAgICAgICBT\ndHJpbmcgc2NoZW1hTmFtZSA9IG51bGw7CiAgICAgICAgU3RyaW5nIG9iamVj\ndE5hbWUgPSBuYW1lOwoKICAgICAgICAvLyBsb29rIGZvciB0aGUgc3RhbmRh\ncmQgc2NoZW1hIHNlcGFyYXRvci4uLgogICAgICAgIGludCBkb3RJZHggPSBu\nYW1lLmluZGV4T2YoJy4nKTsKICAgICAgICAvLyAuLi4gb3IgdGhlIGRpY3Rp\nb25hcnkgc2NoZW1hIHNlcGFyYXRvcgogICAgICAgIGlmIChkb3RJZHggPT0g\nLTEpIHsKICAgICAgICAgICAgU3RyaW5nIHNlcCA9IF9jb25mLmdldERCRGlj\ndGlvbmFyeUluc3RhbmNlKCkuY2F0YWxvZ1NlcGFyYXRvcjsKICAgICAgICAg\nICAgaWYgKCEiLiIuZXF1YWxzKHNlcCkpCiAgICAgICAgICAgICAgICBkb3RJ\nZHggPSBuYW1lLmluZGV4T2Yoc2VwKTsKICAgICAgICB9CgogICAgICAgIGlm\nIChkb3RJZHggIT0gLTEpIHsKICAgICAgICAgICAgc2NoZW1hTmFtZSA9IG5h\nbWUuc3Vic3RyaW5nKDAsIGRvdElkeCk7CiAgICAgICAgICAgIG9iamVjdE5h\nbWUgPSBuYW1lLnN1YnN0cmluZyhkb3RJZHggKyAxKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIHdlIHNoYXJlIGEgc2luZ2xlIGNvbm5lY3Rpb24gYWNyb3Nz\nIGFsbCBzY2hlbWFzLCBzbyBzeW5jaAogICAgICAgIC8vIG9uIHRoZSBzY2hl\nbWEgZ3JvdXAKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAg\nICAgICAgYm9vbGVhbiBjbG9zZSA9IGZhbHNlOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgLy8gdXNlIHRoZSBleGlzdGluZyBjb25uZWN0\naW9uIGlmIHBvc3NpYmxlOyB0aGlzIG1ldGhvZAogICAgICAgICAgICAgICAg\nLy8gbWlnaHQgYmUgcmVlbnRyYW50IGlmIGdlbmVyYXRpbmcgdGhlIGZvcmVp\nZ24ga2V5cyBmb3IKICAgICAgICAgICAgICAgIC8vIHRoaXMgdGFibGUgKHNl\nZSBiZWxvdykgcmVxdWlyZXMgbG9hZGluZyBhZGRpdGlvbmFsCiAgICAgICAg\nICAgICAgICAvLyB0YWJsZXM7IGluIHRoYXQgY2FzZSB3ZSBkb24ndCB3YW50\nIHRvIHNwYXduIGFkZGl0aW9uYWwKICAgICAgICAgICAgICAgIC8vIGNvbm5l\nY3Rpb25zCiAgICAgICAgICAgICAgICBpZiAoX2Nvbm4gPT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIF9jb25uID0gX2NvbmYuZ2V0RGF0YVNvdXJj\nZTIobnVsbCkuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAgICAgICAgICAg\nIGNsb3NlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBfbWV0YSA9IF9j\nb25uLmdldE1ldGFEYXRhKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAg\nICAgICAgICAgaWYgKGlzVGFibGUpIHsKICAgICAgICAgICAgICAgICAgICAv\nLyBnZW5lcmF0ZSB0aGUgdGFibGUgZnJvbSBkYXRhYmFzZSBtZXRhZGF0YQog\nICAgICAgICAgICAgICAgICAgIF9nZW4uZ2VuZXJhdGVUYWJsZXMoc2NoZW1h\nTmFtZSwgb2JqZWN0TmFtZSwgX2Nvbm4sIF9tZXRhKTsKICAgICAgICAgICAg\nICAgICAgICBUYWJsZSB0YWJsZSA9IHN1cGVyLmZpbmRUYWJsZShuYW1lKTsK\nCiAgICAgICAgICAgICAgICAgICAgaWYgKHRhYmxlICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKF9wa3MpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBfZ2VuLmdlbmVyYXRlUHJpbWFyeUtleXModGFibGUu\nZ2V0U2NoZW1hTmFtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHRhYmxlLmdldE5hbWUoKSwgX2Nvbm4sIF9tZXRhKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKF9pbmRleGVzKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgX2dlbi5nZW5lcmF0ZUluZGV4ZXModGFibGUuZ2V0U2No\nZW1hTmFtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRh\nYmxlLmdldE5hbWUoKSwgX2Nvbm4sIF9tZXRhKTsKCiAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIGdlbmVyYXRlIGZvcmVpZ24ga2V5cyBmcm9tIHRoZSB0\nYWJsZTsgdGhpcyBtaWdodAogICAgICAgICAgICAgICAgICAgICAgICAvLyBl\nbmQgdXAgcmUtY2FsbGluZyB0aGlzIGdldFRhYmxlIG1ldGhvZCBpZiB0aGUg\nZm9yZWlnbgogICAgICAgICAgICAgICAgICAgICAgICAvLyBrZXkgbGlua3Mg\ndG8gYSB0YWJsZSB0aGF0IGhhc24ndCBiZWVuIGxvYWRlZCB5ZXQKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKF9ma3MpCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBfZ2VuLmdlbmVyYXRlRm9yZWlnbktleXModGFibGUuZ2V0\nU2NoZW1hTmFtZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRhYmxlLmdldE5hbWUoKSwgX2Nvbm4sIF9tZXRhKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAg\nICAgICAgICBfZ2VuLmdlbmVyYXRlU2VxdWVuY2VzKHNjaGVtYU5hbWUsIG9i\namVjdE5hbWUsIF9jb25uLAogICAgICAgICAgICAgICAgICAgICAgICBfbWV0\nYSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewog\nICAgICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShz\nZSwKICAgICAgICAgICAgICAgICAgICBfY29uZi5nZXREQkRpY3Rpb25hcnlJ\nbnN0YW5jZSgpKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgIGlmIChjbG9zZSkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9jb25uLmNsb3NlKCk7CiAgICAg\nICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF9jb25u\nID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb25maWd1cmF0aW9u\nKENvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9jb25mID0gKEpEQkND\nb25maWd1cmF0aW9uKSBjb25mOwogICAgICAgIF9nZW4gPSBuZXcgU2NoZW1h\nR2VuZXJhdG9yKF9jb25mKTsKICAgICAgICBfZ2VuLnNldFNjaGVtYUdyb3Vw\nKHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJh\ndGlvbigpIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0\naW9uKCkgewogICAgfQp9Cg==\n","encoding":"base64"}

