{"sha":"490fd4179de36223c25d6117dc31f501d71ea01c","node_id":"MDQ6QmxvYjIwNjM2NDo0OTBmZDQxNzlkZTM2MjIzYzI1ZDYxMTdkYzMxZjUwMWQ3MWVhMDFj","size":7330,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/490fd4179de36223c25d6117dc31f501d71ea01c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnV0aWwuTWFw\nOwppbXBvcnQgamF2YS51dGlsLlRyZWVNYXA7CgppbXBvcnQgb3JnLmFwYWNo\nZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CgovKioKICogUmVwcmVzZW50\ncyBhIGRhdGFiYXNlIHNjaGVtYS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUK\nICovCnB1YmxpYyBjbGFzcyBTY2hlbWEKICAgIGltcGxlbWVudHMgQ29tcGFy\nYWJsZSwgU2VyaWFsaXphYmxlIHsKCiAgICBwcml2YXRlIFN0cmluZyBfbmFt\nZSA9IG51bGw7CiAgICBwcml2YXRlIFNjaGVtYUdyb3VwIF9ncm91cCA9IG51\nbGw7CiAgICBwcml2YXRlIE1hcCBfdGFibGVNYXAgPSBudWxsOwogICAgcHJp\ndmF0ZSBNYXAgX3NlcU1hcCA9IG51bGw7CgogICAgLy8gY2FjaGUKICAgIHBy\naXZhdGUgVGFibGVbXSBfdGFibGVzID0gbnVsbDsKICAgIHByaXZhdGUgU2Vx\ndWVuY2VbXSBfc2VxcyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBEZWZhdWx0\nIGNvbnN0cnVjdG9yLgogICAgICovCiAgICBwdWJsaWMgU2NoZW1hKCkgewog\nICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAg\nICogQHBhcmFtIG5hbWUgdGhlIHNjaGVtYSBuYW1lLCBpZiBhbnkKICAgICAq\nIEBwYXJhbSBncm91cCB0aGUgc2NoZW1hJ3Mgb3duaW5nIGdyb3VwCiAgICAg\nKi8KICAgIHB1YmxpYyBTY2hlbWEoU3RyaW5nIG5hbWUsIFNjaGVtYUdyb3Vw\nIGdyb3VwKSB7CiAgICAgICAgc2V0TmFtZShuYW1lKTsKICAgICAgICBfZ3Jv\ndXAgPSBncm91cDsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGxlZCB3aGVu\nIHRoZSBzY2hlbWEgaXMgcmVtb3ZlZCBmcm9tIGl0cyBncm91cC4gSW52YWxp\nZGF0ZXMgdGhlCiAgICAgKiBzY2hlbWEgYW5kIHJlbW92ZXMgYWxsIGl0cyBt\nZW1iZXIgdGFibGVzLgogICAgICovCiAgICB2b2lkIHJlbW92ZSgpIHsKICAg\nICAgICBUYWJsZVtdIHRhYnMgPSBnZXRUYWJsZXMoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHRhYnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nIHJlbW92ZVRhYmxlKHRhYnNbaV0pOwogICAgICAgIFNlcXVlbmNlW10gc2Vx\ncyA9IGdldFNlcXVlbmNlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgc2Vxcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3ZlU2VxdWVu\nY2Uoc2Vxc1tpXSk7CiAgICAgICAgX2dyb3VwID0gbnVsbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgc2NoZW1hJ3MgZ3JvdXAuCiAgICAg\nKi8KICAgIHB1YmxpYyBTY2hlbWFHcm91cCBnZXRTY2hlbWFHcm91cCgpIHsK\nICAgICAgICByZXR1cm4gX2dyb3VwOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBzY2hlbWEsIG9yIG51bGwgaWYgbm9u\nZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAg\nICAgIHJldHVybiBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgbmFtZSBvZiB0aGUgc2NoZW1hLiBUaGlzIG1ldGhvZCBjYW4gb25seSBi\nZSB1c2VkIGZvciBzY2hlbWFzCiAgICAgKiBub3QgYXR0YWNoZWQgdG8gYSBn\ncm91cC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TmFtZShTdHJpbmcg\nbmFtZSkgewogICAgICAgIGlmIChnZXRTY2hlbWFHcm91cCgpICE9IG51bGwp\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24o\nKTsKICAgICAgICBfbmFtZSA9IFN0cmluZ1V0aWxzLnRyaW1Ub051bGwobmFt\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNjaGVtYSdz\nIHRhYmxlcy4KICAgICAqLwogICAgcHVibGljIFRhYmxlW10gZ2V0VGFibGVz\nKCkgewogICAgICAgIGlmIChfdGFibGVzID09IG51bGwpCiAgICAgICAgICAg\nIF90YWJsZXMgPSAoX3RhYmxlTWFwID09IG51bGwpID8gbmV3IFRhYmxlWzBd\nIDogKFRhYmxlW10pCiAgICAgICAgICAgICAgICBfdGFibGVNYXAudmFsdWVz\nKCkudG9BcnJheShuZXcgVGFibGVbX3RhYmxlTWFwLnNpemUoKV0pOwogICAg\nICAgIHJldHVybiBfdGFibGVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSB0YWJsZSB3aXRoIHRoZSBnaXZlbiBuYW1lLCBvciBudWxsIGlm\nIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBUYWJsZSBnZXRUYWJsZShTdHJp\nbmcgbmFtZSkgewogICAgICAgIGlmIChuYW1lID09IG51bGwgfHwgX3RhYmxl\nTWFwID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIHJldHVybiAoVGFibGUpIF90YWJsZU1hcC5nZXQobmFtZS50b1VwcGVyQ2Fz\nZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBhIHRhYmxlIHRvIHRo\nZSBzY2hlbWEuCiAgICAgKi8KICAgIHB1YmxpYyBUYWJsZSBhZGRUYWJsZShT\ndHJpbmcgbmFtZSkgewogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0gZ2V0\nU2NoZW1hR3JvdXAoKTsKICAgICAgICBUYWJsZSB0YWI7CiAgICAgICAgaWYg\nKGdyb3VwICE9IG51bGwpIHsKICAgICAgICAgICAgZ3JvdXAuYWRkTmFtZShu\nYW1lLCB0cnVlKTsKICAgICAgICAgICAgdGFiID0gZ3JvdXAubmV3VGFibGUo\nbmFtZSwgdGhpcyk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHRhYiA9\nIG5ldyBUYWJsZShuYW1lLCB0aGlzKTsKICAgICAgICBpZiAoX3RhYmxlTWFw\nID09IG51bGwpCiAgICAgICAgICAgIF90YWJsZU1hcCA9IG5ldyBUcmVlTWFw\nKCk7CiAgICAgICAgX3RhYmxlTWFwLnB1dChuYW1lLnRvVXBwZXJDYXNlKCks\nIHRhYik7CiAgICAgICAgX3RhYmxlcyA9IG51bGw7CiAgICAgICAgcmV0dXJu\nIHRhYjsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4g\ndGFibGUgZnJvbSB0aGUgc2NoZW1hLgogICAgICoKICAgICAqIEByZXR1cm4g\ndHJ1ZSBpZiB0aGUgdGFibGUgd2FzIHJlbW92ZWQsIGZhbHNlIGlmIG5vdCBp\nbiB0aGUgc2NoZW1hCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92\nZVRhYmxlKFRhYmxlIHRhYikgewogICAgICAgIGlmICh0YWIgPT0gbnVsbCB8\nfCBfdGFibGVNYXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwoKICAgICAgICBUYWJsZSBjdXIgPSAoVGFibGUpIF90YWJsZU1hcC5nZXQo\ndGFiLmdldE5hbWUoKS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICBpZiAoIWN1\nci5lcXVhbHModGFiKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAg\nICAgICBfdGFibGVNYXAucmVtb3ZlKHRhYi5nZXROYW1lKCkudG9VcHBlckNh\nc2UoKSk7CiAgICAgICAgX3RhYmxlcyA9IG51bGw7CiAgICAgICAgU2NoZW1h\nR3JvdXAgZ3JvdXAgPSBnZXRTY2hlbWFHcm91cCgpOwogICAgICAgIGlmIChn\ncm91cCAhPSBudWxsKQogICAgICAgICAgICBncm91cC5yZW1vdmVOYW1lKHRh\nYi5nZXROYW1lKCkpOwogICAgICAgIHRhYi5yZW1vdmUoKTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcG9ydCBhIHRh\nYmxlIGZyb20gYW5vdGhlciBzY2hlbWEuCSBOb3RlIHRoYXQgdGhpcyBtZXRo\nb2QgZG9lcwogICAgICogPHN0cm9uZz5ub3Q8L3N0cm9uZz4gaW1wb3J0IGZv\ncmVpZ24ga2V5cywgaW5kZXhlcywgb3IgdW5pcXVlIGNvbnN0cmFpbnRzLgog\nICAgICovCiAgICBwdWJsaWMgVGFibGUgaW1wb3J0VGFibGUoVGFibGUgdGFi\nbGUpIHsKICAgICAgICBpZiAodGFibGUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIFRhYmxlIGNvcHkgPSBhZGRUYWJsZSh0\nYWJsZS5nZXROYW1lKCkpOwogICAgICAgIENvbHVtbltdIGNvbHMgPSB0YWJs\nZS5nZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBj\nb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBjb3B5LmltcG9ydENvbHVt\nbihjb2xzW2ldKTsKCiAgICAgICAgY29weS5pbXBvcnRQcmltYXJ5S2V5KHRh\nYmxlLmdldFByaW1hcnlLZXkoKSk7CiAgICAgICAgcmV0dXJuIGNvcHk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNjaGVtYSdzIHNlcXVl\nbmNlcy4KICAgICAqLwogICAgcHVibGljIFNlcXVlbmNlW10gZ2V0U2VxdWVu\nY2VzKCkgewogICAgICAgIGlmIChfc2VxcyA9PSBudWxsKQogICAgICAgICAg\nICBfc2VxcyA9IChfc2VxTWFwID09IG51bGwpID8gbmV3IFNlcXVlbmNlWzBd\nIDogKFNlcXVlbmNlW10pCiAgICAgICAgICAgICAgICBfc2VxTWFwLnZhbHVl\ncygpLnRvQXJyYXkobmV3IFNlcXVlbmNlW19zZXFNYXAuc2l6ZSgpXSk7CiAg\nICAgICAgcmV0dXJuIF9zZXFzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBzZXF1ZW5jZSB3aXRoIHRoZSBnaXZlbiBuYW1lLCBvciBudWxs\nIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBTZXF1ZW5jZSBnZXRTZXF1\nZW5jZShTdHJpbmcgbmFtZSkgewogICAgICAgIGlmIChuYW1lID09IG51bGwg\nfHwgX3NlcU1hcCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICByZXR1cm4gKFNlcXVlbmNlKSBfc2VxTWFwLmdldChuYW1lLnRv\nVXBwZXJDYXNlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgc2Vx\ndWVuY2UgdG8gdGhlIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFNlcXVl\nbmNlIGFkZFNlcXVlbmNlKFN0cmluZyBuYW1lKSB7CiAgICAgICAgU2NoZW1h\nR3JvdXAgZ3JvdXAgPSBnZXRTY2hlbWFHcm91cCgpOwogICAgICAgIFNlcXVl\nbmNlIHNlcTsKICAgICAgICBpZiAoZ3JvdXAgIT0gbnVsbCkgewogICAgICAg\nICAgICBncm91cC5hZGROYW1lKG5hbWUsIHRydWUpOwogICAgICAgICAgICBz\nZXEgPSBncm91cC5uZXdTZXF1ZW5jZShuYW1lLCB0aGlzKTsKICAgICAgICB9\nIGVsc2UKICAgICAgICAgICAgc2VxID0gbmV3IFNlcXVlbmNlKG5hbWUsIHRo\naXMpOwogICAgICAgIGlmIChfc2VxTWFwID09IG51bGwpCiAgICAgICAgICAg\nIF9zZXFNYXAgPSBuZXcgVHJlZU1hcCgpOwogICAgICAgIF9zZXFNYXAucHV0\nKG5hbWUudG9VcHBlckNhc2UoKSwgc2VxKTsKICAgICAgICBfc2VxcyA9IG51\nbGw7CiAgICAgICAgcmV0dXJuIHNlcTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJlbW92ZSB0aGUgZ2l2ZW4gc2VxdWVuY2UgZnJvbSB0aGUgc2NoZW1hLgog\nICAgICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgc2VxdWVuY2Ugd2Fz\nIHJlbW92ZWQsIGZhbHNlIGlmIG5vdCBpbiB0aGUgc2NoZW1hCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZVNlcXVlbmNlKFNlcXVlbmNlIHNl\ncSkgewogICAgICAgIGlmIChzZXEgPT0gbnVsbCB8fCBfc2VxTWFwID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU2VxdWVu\nY2UgY3VyID0gKFNlcXVlbmNlKSBfc2VxTWFwLmdldChzZXEuZ2V0TmFtZSgp\nLnRvVXBwZXJDYXNlKCkpOwogICAgICAgIGlmICghY3VyLmVxdWFscyhzZXEp\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIF9zZXFNYXAu\ncmVtb3ZlKHNlcS5nZXROYW1lKCkudG9VcHBlckNhc2UoKSk7CiAgICAgICAg\nX3NlcXMgPSBudWxsOwogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0gZ2V0\nU2NoZW1hR3JvdXAoKTsKICAgICAgICBpZiAoZ3JvdXAgIT0gbnVsbCkKICAg\nICAgICAgICAgZ3JvdXAucmVtb3ZlTmFtZShzZXEuZ2V0TmFtZSgpKTsKICAg\nICAgICBzZXEucmVtb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSBzZXF1ZW5jZSBmcm9tIGFub3Ro\nZXIgc2NoZW1hLgogICAgICovCiAgICBwdWJsaWMgU2VxdWVuY2UgaW1wb3J0\nU2VxdWVuY2UoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgaWYgKHNlcSA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU2VxdWVu\nY2UgY29weSA9IGFkZFNlcXVlbmNlKHNlcS5nZXROYW1lKCkpOwogICAgICAg\nIGNvcHkuc2V0SW5pdGlhbFZhbHVlKHNlcS5nZXRJbml0aWFsVmFsdWUoKSk7\nCiAgICAgICAgY29weS5zZXRJbmNyZW1lbnQoc2VxLmdldEluY3JlbWVudCgp\nKTsKICAgICAgICBjb3B5LnNldEFsbG9jYXRlKHNlcS5nZXRBbGxvY2F0ZSgp\nKTsKICAgICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICBwdWJsaWMgaW50\nIGNvbXBhcmVUbyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBTdHJpbmcgbmFt\nZSA9IGdldE5hbWUoKTsKICAgICAgICBTdHJpbmcgb3RoZXJOYW1lID0gKChT\nY2hlbWEpIG90aGVyKS5nZXROYW1lKCk7CiAgICAgICAgaWYgKG5hbWUgPT0g\nbnVsbCAmJiBvdGhlck5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIDA7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIDE7CiAgICAgICAgaWYgKG90aGVyTmFtZSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gLTE7CiAgICAgICAgcmV0dXJuIG5hbWUuY29tcGFyZVRv\nKG90aGVyTmFtZSk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmlu\nZygpIHsKICAgICAgICByZXR1cm4gZ2V0TmFtZSgpOwogICAgfQp9Cg==\n","encoding":"base64"}

