{"sha":"37dc91d3112f598d1869dc89b97bf55fdfa84a7a","node_id":"MDQ6QmxvYjIwNjM2NDozN2RjOTFkMzExMmY1OThkMTg2OWRjODliOTdiZjU1ZmRmYTg0YTdh","size":13832,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/37dc91d3112f598d1869dc89b97bf55fdfa84a7a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZh\nLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxNZXRhRGF0YVNlcmlhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxp\nemVyOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhjZXB0aW9uOwoKLyoqCiAq\nIFNlcmlhbGl6ZXMge0BsaW5rIFNjaGVtYX1zIHRvIFhNTCBtYXRjaGluZyB0\naGUgZG9jdW1lbnQKICogdHlwZSBkZWZpbml0aW9uIGRlZmluZWQgYnkgdGhl\nIHtAbGluayBYTUxTY2hlbWFQYXJzZXJ9LiBUaGUgc2VyaWFsaXplcgogKiBh\nY3R1YWxseSB3b3JrcyBhdCB0aGUgZmluZS1ncmFpbmVkIHRhYmxlIGxldmVs\nIHRvIGFsbG93IHlvdSB0byBzcGxpdAogKiBzY2hlbWFzIGFtb25nIG11bHRp\ncGxlIGZpbGVzLgogKiAgU2VyaWFsaXplcnMgYXJlIG5vdCB0aHJlYWQgc2Fm\nZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8K\ncHVibGljIGNsYXNzIFhNTFNjaGVtYVNlcmlhbGl6ZXIKICAgIGV4dGVuZHMg\nWE1MTWV0YURhdGFTZXJpYWxpemVyCiAgICBpbXBsZW1lbnRzIFNjaGVtYVNl\ncmlhbGl6ZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoWE1MU2No\nZW1hU2VyaWFsaXplci5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBDb2xs\nZWN0aW9uIF90YWJsZXMgPSBuZXcgVHJlZVNldCgpOwogICAgcHJpdmF0ZSBm\naW5hbCBDb2xsZWN0aW9uIF9zZXFzID0gbmV3IFRyZWVTZXQoKTsKCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdG9yLiBTdXBwbHkgY29uZmlndXJhdGlvbi4K\nICAgICAqLwogICAgcHVibGljIFhNTFNjaGVtYVNlcmlhbGl6ZXIoSkRCQ0Nv\nbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIHNldExvZyhjb25mLmdldExv\nZyhKREJDQ29uZmlndXJhdGlvbi5MT0dfU0NIRU1BKSk7CiAgICB9CgogICAg\ncHVibGljIFRhYmxlW10gZ2V0VGFibGVzKCkgewogICAgICAgIHJldHVybiAo\nVGFibGVbXSkgX3RhYmxlcy50b0FycmF5KG5ldyBUYWJsZVtfdGFibGVzLnNp\nemUoKV0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZFRhYmxlKFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgaWYgKHRhYmxlICE9IG51bGwpCiAgICAgICAg\nICAgIF90YWJsZXMuYWRkKHRhYmxlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiByZW1vdmVUYWJsZShUYWJsZSB0YWJsZSkgewogICAgICAgIHJldHVy\nbiBfdGFibGVzLnJlbW92ZSh0YWJsZSk7CiAgICB9CgogICAgcHVibGljIFNl\ncXVlbmNlW10gZ2V0U2VxdWVuY2VzKCkgewogICAgICAgIHJldHVybiAoU2Vx\ndWVuY2VbXSkgX3NlcXMudG9BcnJheShuZXcgU2VxdWVuY2VbX3NlcXMuc2l6\nZSgpXSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkU2VxdWVuY2UoU2Vx\ndWVuY2Ugc2VxKSB7CiAgICAgICAgaWYgKHNlcSAhPSBudWxsKQogICAgICAg\nICAgICBfc2Vxcy5hZGQoc2VxKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiByZW1vdmVTZXF1ZW5jZShTZXF1ZW5jZSBzZXEpIHsKICAgICAgICByZXR1\ncm4gX3NlcXMucmVtb3ZlKHNlcSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nYWRkQWxsKFNjaGVtYSBzY2hlbWEpIHsKICAgICAgICBpZiAoc2NoZW1hID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBUYWJsZVtdIHRh\nYmxlcyA9IHNjaGVtYS5nZXRUYWJsZXMoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHRhYmxlcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYWRk\nVGFibGUodGFibGVzW2ldKTsKICAgICAgICBTZXF1ZW5jZVtdIHNlcXMgPSBz\nY2hlbWEuZ2V0U2VxdWVuY2VzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBhZGRTZXF1ZW5j\nZShzZXFzW2ldKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRBbGwoU2No\nZW1hR3JvdXAgZ3JvdXApIHsKICAgICAgICBpZiAoZ3JvdXAgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIFNjaGVtYVtdIHNjaGVtYXMg\nPSBncm91cC5nZXRTY2hlbWFzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBhZGRBbGwo\nc2NoZW1hc1tpXSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVtb3Zl\nQWxsKFNjaGVtYSBzY2hlbWEpIHsKICAgICAgICBpZiAoc2NoZW1hID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgYm9vbGVh\nbiByZW1vdmVkID0gZmFsc2U7CiAgICAgICAgVGFibGVbXSB0YWJsZXMgPSBz\nY2hlbWEuZ2V0VGFibGVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCB0YWJsZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZWQgfD0g\ncmVtb3ZlVGFibGUodGFibGVzW2ldKTsKICAgICAgICBTZXF1ZW5jZVtdIHNl\ncXMgPSBzY2hlbWEuZ2V0U2VxdWVuY2VzKCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICByZW1v\ndmVkIHw9IHJlbW92ZVNlcXVlbmNlKHNlcXNbaV0pOwogICAgICAgIHJldHVy\nbiByZW1vdmVkOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUFs\nbChTY2hlbWFHcm91cCBncm91cCkgewogICAgICAgIGlmIChncm91cCA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGJvb2xl\nYW4gcmVtb3ZlZCA9IGZhbHNlOwogICAgICAgIFNjaGVtYVtdIHNjaGVtYXMg\nPSBncm91cC5nZXRTY2hlbWFzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICByZW1vdmVk\nIHw9IHJlbW92ZUFsbChzY2hlbWFzW2ldKTsKICAgICAgICByZXR1cm4gcmVt\nb3ZlZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAg\nICBfdGFibGVzLmNsZWFyKCk7CiAgICAgICAgX3NlcXMuY2xlYXIoKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgQ29sbGVjdGlvbiBnZXRPYmplY3RzKCkgewog\nICAgICAgIGlmIChfc2Vxcy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVy\nbiBfdGFibGVzOwogICAgICAgIGlmIChfdGFibGVzLmlzRW1wdHkoKSkKICAg\nICAgICAgICAgcmV0dXJuIF9zZXFzOwogICAgICAgIExpc3QgYWxsID0gbmV3\nIEFycmF5TGlzdChfc2Vxcy5zaXplKCkgKyBfdGFibGVzLnNpemUoKSk7CiAg\nICAgICAgYWxsLmFkZEFsbChfc2Vxcyk7CiAgICAgICAgYWxsLmFkZEFsbChf\ndGFibGVzKTsKICAgICAgICByZXR1cm4gYWxsOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIHNlcmlhbGl6ZShDb2xsZWN0aW9uIG9ianMpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gZ3JvdXAgdGhlIG9i\namVjdHMgYnkgc2NoZW1hCiAgICAgICAgTWFwIHNjaGVtYXMgPSBuZXcgSGFz\naE1hcCgpOwogICAgICAgIFN0cmluZyBzY2hlbWFOYW1lOwogICAgICAgIENv\nbGxlY3Rpb24gc2NoZW1hT2JqczsKICAgICAgICBPYmplY3Qgb2JqOwogICAg\nICAgIGZvciAoSXRlcmF0b3IgaXRyID0gb2Jqcy5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykgewogICAgICAgICAgICBvYmogPSBpdHIubmV4dCgpOwog\nICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgVGFibGUpCiAgICAgICAg\nICAgICAgICBzY2hlbWFOYW1lID0gKChUYWJsZSkgb2JqKS5nZXRTY2hlbWFO\nYW1lKCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHNjaGVt\nYU5hbWUgPSAoKFNlcXVlbmNlKSBvYmopLmdldFNjaGVtYU5hbWUoKTsKICAg\nICAgICAgICAgc2NoZW1hT2JqcyA9IChDb2xsZWN0aW9uKSBzY2hlbWFzLmdl\ndChzY2hlbWFOYW1lKTsKICAgICAgICAgICAgaWYgKHNjaGVtYU9ianMgPT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgc2NoZW1hT2JqcyA9IG5ldyBMaW5r\nZWRMaXN0KCk7CiAgICAgICAgICAgICAgICBzY2hlbWFzLnB1dChzY2hlbWFO\nYW1lLCBzY2hlbWFPYmpzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBz\nY2hlbWFPYmpzLmFkZChvYmopOwogICAgICAgIH0KCiAgICAgICAgc3RhcnRF\nbGVtZW50KCJzY2hlbWFzIik7CiAgICAgICAgTWFwLkVudHJ5IGVudHJ5Owog\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gc2NoZW1hcy5lbnRyeVNldCgp\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGVu\ndHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAgc2Vy\naWFsaXplU2NoZW1hKChTdHJpbmcpIGVudHJ5LmdldEtleSgpLCAoQ29sbGVj\ndGlvbikKICAgICAgICAgICAgICAgIGVudHJ5LmdldFZhbHVlKCkpOwogICAg\nICAgIH0KICAgICAgICBlbmRFbGVtZW50KCJzY2hlbWFzIik7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBvYmplY3RzIHRv\nZ2V0aGVyIGludG8gdGhlIGN1cnJlbnQgc2NoZW1hLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgc2VyaWFsaXplU2NoZW1hKFN0cmluZyBuYW1lLCBDb2xs\nZWN0aW9uIG9ianMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKG9ianMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIGlmIChnZXRMb2coKS5pc1RyYWNlRW5hYmxlZCgpKQogICAg\nICAgICAgICBnZXRMb2coKS50cmFjZShfbG9jLmdldCgic2VyLXNjaGVtYSIs\nIG5hbWUpKTsKCiAgICAgICAgaWYgKG5hbWUgIT0gbnVsbCkKICAgICAgICAg\nICAgYWRkQXR0cmlidXRlKCJuYW1lIiwgbmFtZSk7CiAgICAgICAgc3RhcnRF\nbGVtZW50KCJzY2hlbWEiKTsKCiAgICAgICAgLy8gdGFibGVzIGFuZCBzZXFz\nCiAgICAgICAgT2JqZWN0IG9iajsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nciA9IG9ianMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgb2JqID0gaXRyLm5leHQoKTsKICAgICAgICAgICAgaWYgKG9iaiBp\nbnN0YW5jZW9mIFRhYmxlKQogICAgICAgICAgICAgICAgc2VyaWFsaXplVGFi\nbGUoKFRhYmxlKSBvYmopOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAg\nICAgICBzZXJpYWxpemVTZXF1ZW5jZSgoU2VxdWVuY2UpIG9iaik7CiAgICAg\nICAgfQoKICAgICAgICBlbmRFbGVtZW50KCJzY2hlbWEiKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNlcmlhbGl6ZSB0aGUgZ2l2ZW4gc2VxdWVuY2UuCiAg\nICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXJpYWxpemVTZXF1ZW5jZShTZXF1\nZW5jZSBzZXEpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgYWRkQXR0cmlidXRlKCJuYW1lIiwgc2VxLmdldE5hbWUoKSk7CiAgICAg\nICAgaWYgKHNlcS5nZXRJbml0aWFsVmFsdWUoKSAhPSAxKQogICAgICAgICAg\nICBhZGRBdHRyaWJ1dGUoImluaXRpYWwtdmFsdWUiLAogICAgICAgICAgICAg\nICAgU3RyaW5nLnZhbHVlT2Yoc2VxLmdldEluaXRpYWxWYWx1ZSgpKSk7CiAg\nICAgICAgaWYgKHNlcS5nZXRJbmNyZW1lbnQoKSA+IDEpCiAgICAgICAgICAg\nIGFkZEF0dHJpYnV0ZSgiaW5jcmVtZW50IiwgU3RyaW5nLnZhbHVlT2Yoc2Vx\nLmdldEluY3JlbWVudCgpKSk7CiAgICAgICAgaWYgKHNlcS5nZXRBbGxvY2F0\nZSgpID4gMSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJhbGxvY2F0ZSIs\nIFN0cmluZy52YWx1ZU9mKHNlcS5nZXRBbGxvY2F0ZSgpKSk7CiAgICAgICAg\nc3RhcnRFbGVtZW50KCJzZXF1ZW5jZSIpOwogICAgICAgIGVuZEVsZW1lbnQo\nInNlcXVlbmNlIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXJpYWxpemVz\nIHRoZSBnaXZlbiB0YWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNl\ncmlhbGl6ZVRhYmxlKFRhYmxlIHRhYmxlKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIGFkZEF0dHJpYnV0ZSgibmFtZSIsIHRhYmxl\nLmdldE5hbWUoKSk7CiAgICAgICAgc3RhcnRFbGVtZW50KCJ0YWJsZSIpOwoK\nICAgICAgICAvLyBwcmltYXJ5IGtleQogICAgICAgIFByaW1hcnlLZXkgcGsg\nPSB0YWJsZS5nZXRQcmltYXJ5S2V5KCk7CiAgICAgICAgaWYgKHBrICE9IG51\nbGwpCiAgICAgICAgICAgIHNlcmlhbGl6ZVByaW1hcnlLZXkocGspOwoKICAg\nICAgICAvLyBjb2x1bW5zCiAgICAgICAgQ29sdW1uW10gY29scyA9IHRhYmxl\nLmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNv\nbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHNlcmlhbGl6ZUNvbHVtbihj\nb2xzW2ldKTsKCiAgICAgICAgLy8gZm9yZWlnbiBrZXlzCiAgICAgICAgRm9y\nZWlnbktleVtdIGZrcyA9IHRhYmxlLmdldEZvcmVpZ25LZXlzKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3MubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIHNlcmlhbGl6ZUZvcmVpZ25LZXkoZmtzW2ldKTsKCiAgICAgICAg\nLy8gaW5kZXhlcwogICAgICAgIEluZGV4W10gaWR4cyA9IHRhYmxlLmdldElu\nZGV4ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlkeHMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIHNlcmlhbGl6ZUluZGV4KGlkeHNbaV0p\nOwoKICAgICAgICAvLyB1bmlxdWUgY29uc3RyYWludHMKICAgICAgICBVbmlx\ndWVbXSB1bnFzID0gdGFibGUuZ2V0VW5pcXVlcygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nc2VyaWFsaXplVW5pcXVlKHVucXNbaV0pOwoKICAgICAgICBlbmRFbGVtZW50\nKCJ0YWJsZSIpOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplcyB0\naGUgZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2Vy\naWFsaXplQ29sdW1uKENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1lIiwgY29sLmdl\ndE5hbWUoKSk7CiAgICAgICAgYWRkQXR0cmlidXRlKCJ0eXBlIiwgU2NoZW1h\ncy5nZXRKREJDTmFtZShjb2wuZ2V0VHlwZSgpKSk7CiAgICAgICAgaWYgKCFT\ndHJpbmdVdGlscy5pc0VtcHR5KGNvbC5nZXRUeXBlTmFtZSgpKQogICAgICAg\nICAgICAmJiAhY29sLmdldFR5cGVOYW1lKCkuZXF1YWxzSWdub3JlQ2FzZQog\nICAgICAgICAgICAoU2NoZW1hcy5nZXRKREJDTmFtZShjb2wuZ2V0VHlwZSgp\nKSkpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgidHlwZS1uYW1lIiwgY29s\nLmdldFR5cGVOYW1lKCkpOwogICAgICAgIGlmIChjb2wuaXNOb3ROdWxsKCkp\nCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgibm90LW51bGwiLCAidHJ1ZSIp\nOwogICAgICAgIGlmIChjb2wuaXNBdXRvQXNzaWduZWQoKSkKICAgICAgICAg\nICAgYWRkQXR0cmlidXRlKCJhdXRvLWFzc2lnbiIsICJ0cnVlIik7CiAgICAg\nICAgaWYgKGNvbC5nZXREZWZhdWx0U3RyaW5nKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgYWRkQXR0cmlidXRlKCJkZWZhdWx0IiwgY29sLmdldERlZmF1bHRT\ndHJpbmcoKSk7CiAgICAgICAgaWYgKGNvbC5nZXRTaXplKCkgIT0gMCkKICAg\nICAgICAgICAgYWRkQXR0cmlidXRlKCJzaXplIiwgU3RyaW5nLnZhbHVlT2Yo\nY29sLmdldFNpemUoKSkpOwogICAgICAgIGlmIChjb2wuZ2V0RGVjaW1hbERp\nZ2l0cygpICE9IDApCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiZGVjaW1h\nbC1kaWdpdHMiLCBTdHJpbmcudmFsdWVPZgogICAgICAgICAgICAgICAgKGNv\nbC5nZXREZWNpbWFsRGlnaXRzKCkpKTsKICAgICAgICBzdGFydEVsZW1lbnQo\nImNvbHVtbiIpOwogICAgICAgIGVuZEVsZW1lbnQoImNvbHVtbiIpOwogICAg\nfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplcyB0aGUgZ2l2ZW4gcHJpbWFy\neSBrZXkuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXJpYWxpemVQcmlt\nYXJ5S2V5KFByaW1hcnlLZXkgcGspCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKHBrLmdldE5hbWUoKSAhPSBudWxsKQogICAg\nICAgICAgICBhZGRBdHRyaWJ1dGUoIm5hbWUiLCBway5nZXROYW1lKCkpOwog\nICAgICAgIGlmIChway5pc0xvZ2ljYWwoKSkKICAgICAgICAgICAgYWRkQXR0\ncmlidXRlKCJsb2dpY2FsIiwgInRydWUiKTsKCiAgICAgICAgQ29sdW1uW10g\nY29scyA9IHBrLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoY29scy5sZW5n\ndGggPT0gMSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJjb2x1bW4iLCBj\nb2xzWzBdLmdldE5hbWUoKSk7CiAgICAgICAgc3RhcnRFbGVtZW50KCJwayIp\nOwoKICAgICAgICAvLyBjb2x1bW5zCiAgICAgICAgaWYgKGNvbHMubGVuZ3Ro\nID4gMSkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgc2VyaWFsaXplT24oY29sc1tp\nXSk7CgogICAgICAgIGVuZEVsZW1lbnQoInBrIik7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBpbmRleC4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZUluZGV4KEluZGV4IGlkeCkKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBhZGRBdHRyaWJ1\ndGUoIm5hbWUiLCBpZHguZ2V0TmFtZSgpKTsKICAgICAgICBpZiAoaWR4Lmlz\nVW5pcXVlKCkpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgidW5pcXVlIiwg\nInRydWUiKTsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gaWR4LmdldENvbHVt\nbnMoKTsKICAgICAgICBpZiAoY29scy5sZW5ndGggPT0gMSkKICAgICAgICAg\nICAgYWRkQXR0cmlidXRlKCJjb2x1bW4iLCBjb2xzWzBdLmdldE5hbWUoKSk7\nCiAgICAgICAgc3RhcnRFbGVtZW50KCJpbmRleCIpOwoKICAgICAgICAvLyBj\nb2x1bW5zCiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4gMSkKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAg\nICAgICAgICAgICAgc2VyaWFsaXplT24oY29sc1tpXSk7CgogICAgICAgIGVu\nZEVsZW1lbnQoImluZGV4Iik7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXJp\nYWxpemVzIHRoZSBnaXZlbiBjb25zdHJhaW50LgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgc2VyaWFsaXplVW5pcXVlKFVuaXF1ZSB1bnEpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHVucS5nZXROYW1l\nKCkgIT0gbnVsbCkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1lIiwg\ndW5xLmdldE5hbWUoKSk7CiAgICAgICAgaWYgKHVucS5pc0RlZmVycmVkKCkp\nCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiZGVmZXJyZWQiLCAidHJ1ZSIp\nOwogICAgICAgIENvbHVtbltdIGNvbHMgPSB1bnEuZ2V0Q29sdW1ucygpOwog\nICAgICAgIGlmIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICBhZGRB\ndHRyaWJ1dGUoImNvbHVtbiIsIGNvbHNbMF0uZ2V0TmFtZSgpKTsKICAgICAg\nICBzdGFydEVsZW1lbnQoInVuaXF1ZSIpOwoKICAgICAgICAvLyBjb2x1bW5z\nCiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4gMSkKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICAgICAgc2VyaWFsaXplT24oY29sc1tpXSk7CgogICAgICAgIGVuZEVsZW1l\nbnQoInVuaXF1ZSIpOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXpl\ncyB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBzZXJpYWxpemVGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmspCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGZrLmdldE5h\nbWUoKSAhPSBudWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoIm5hbWUi\nLCBmay5nZXROYW1lKCkpOwoKICAgICAgICBpZiAoZmsuaXNEZWZlcnJlZCgp\nKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImRlZmVycmVkIiwgInRydWUi\nKTsKCiAgICAgICAgaWYgKGZrLmdldERlbGV0ZUFjdGlvbigpICE9IEZvcmVp\nZ25LZXkuQUNUSU9OX05PTkUpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgi\nZGVsZXRlLWFjdGlvbiIsIEZvcmVpZ25LZXkuZ2V0QWN0aW9uTmFtZQogICAg\nICAgICAgICAgICAgKGZrLmdldERlbGV0ZUFjdGlvbigpKSk7CiAgICAgICAg\naWYgKGZrLmdldFVwZGF0ZUFjdGlvbigpICE9IEZvcmVpZ25LZXkuQUNUSU9O\nX05PTkUKICAgICAgICAgICAgJiYgZmsuZ2V0VXBkYXRlQWN0aW9uKCkgIT0g\nRm9yZWlnbktleS5BQ1RJT05fUkVTVFJJQ1QpCiAgICAgICAgICAgIGFkZEF0\ndHJpYnV0ZSgidXBkYXRlLWFjdGlvbiIsIEZvcmVpZ25LZXkuZ2V0QWN0aW9u\nTmFtZQogICAgICAgICAgICAgICAgKGZrLmdldFVwZGF0ZUFjdGlvbigpKSk7\nCgogICAgICAgIENvbHVtbltdIGNvbHMgPSBmay5nZXRDb2x1bW5zKCk7CiAg\nICAgICAgQ29sdW1uW10gcGtzID0gZmsuZ2V0UHJpbWFyeUtleUNvbHVtbnMo\nKTsKICAgICAgICBDb2x1bW5bXSBjb25zdHMgPSBmay5nZXRDb25zdGFudENv\nbHVtbnMoKTsKICAgICAgICBDb2x1bW5bXSBjb25zdHNQSyA9IGZrLmdldENv\nbnN0YW50UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAgICBhZGRBdHRyaWJ1\ndGUoInRvLXRhYmxlIiwgZmsuZ2V0UHJpbWFyeUtleVRhYmxlKCkuZ2V0RnVs\nbE5hbWUoKSk7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEgJiYgY29u\nc3RzLmxlbmd0aCA9PSAwICYmIGNvbnN0c1BLLmxlbmd0aCA9PSAwKQogICAg\nICAgICAgICBhZGRBdHRyaWJ1dGUoImNvbHVtbiIsIGNvbHNbMF0uZ2V0TmFt\nZSgpKTsKICAgICAgICBzdGFydEVsZW1lbnQoImZrIik7CgogICAgICAgIC8v\nIGNvbHVtbnMKICAgICAgICBpZiAoY29scy5sZW5ndGggPiAxIHx8IGNvbnN0\ncy5sZW5ndGggPiAwIHx8IGNvbnN0c1BLLmxlbmd0aCA+IDApCiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgICAgIHNlcmlhbGl6ZUpvaW4oY29sc1tpXSwgcGtzW2ldKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbnN0cy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgc2VyaWFsaXplSm9pbihjb25zdHNbaV0sIGZrLmdl\ndENvbnN0YW50KGNvbnN0c1tpXSkpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgY29uc3RzUEsubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHNlcmlh\nbGl6ZUpvaW4oZmsuZ2V0UHJpbWFyeUtleUNvbnN0YW50KGNvbnN0c1BLW2ld\nKSwgY29uc3RzUEtbaV0pOwoKICAgICAgICBlbmRFbGVtZW50KCJmayIpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplcyB0aGUgZ2l2ZW4gY29s\ndW1uIHRvIGFuICdvbicgZWxlbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIHNlcmlhbGl6ZU9uKENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgYWRkQXR0cmlidXRlKCJjb2x1bW4iLCBj\nb2wuZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVsZW1lbnQoIm9uIik7CiAg\nICAgICAgZW5kRWxlbWVudCgib24iKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIGNvbHVtbnMgdG8gYSAnam9pbicgZWxl\nbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZUpvaW4o\nQ29sdW1uIGNvbCwgQ29sdW1uIHBrKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIGFkZEF0dHJpYnV0ZSgiY29sdW1uIiwgY29sLmdl\ndE5hbWUoKSk7CiAgICAgICAgYWRkQXR0cmlidXRlKCJ0by1jb2x1bW4iLCBw\nay5nZXROYW1lKCkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgiam9pbiIpOwog\nICAgICAgIGVuZEVsZW1lbnQoImpvaW4iKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIHZhbHVlcyB0byBhICdqb2luJyBl\nbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplSm9p\nbihPYmplY3QgdmFsLCBDb2x1bW4gcGspCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgYWRkQXR0cmlidXRlKCJ2YWx1ZSIsIHN0cmlu\nZ2lmeUNvbnN0YW50KHZhbCkpOwogICAgICAgIGFkZEF0dHJpYnV0ZSgidG8t\nY29sdW1uIiwgcGsuZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVsZW1lbnQo\nImpvaW4iKTsKICAgICAgICBlbmRFbGVtZW50KCJqb2luIik7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXJpYWxpemVzIHRoZSBnaXZlbiB2YWx1ZXMgdG8g\nYSAnam9pbicgZWxlbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNl\ncmlhbGl6ZUpvaW4oQ29sdW1uIGNvbCwgT2JqZWN0IHZhbCkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBhZGRBdHRyaWJ1dGUoImNv\nbHVtbiIsIGNvbC5nZXROYW1lKCkpOwogICAgICAgIGFkZEF0dHJpYnV0ZSgi\ndmFsdWUiLCBzdHJpbmdpZnlDb25zdGFudCh2YWwpKTsKICAgICAgICBzdGFy\ndEVsZW1lbnQoImpvaW4iKTsKICAgICAgICBlbmRFbGVtZW50KCJqb2luIik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTdHJpbmdpZnkgdGhlIGdpdmVuIGNv\nbnN0YW50IHZhbHVlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBTdHJp\nbmcgc3RyaW5naWZ5Q29uc3RhbnQoT2JqZWN0IHZhbCkgewogICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuICJudWxsIjsKICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICBy\nZXR1cm4gIiciICsgdmFsICsgIiciOwogICAgICAgIHJldHVybiB2YWwudG9T\ndHJpbmcoKTsKICAgIH0KfQo=\n","encoding":"base64"}

