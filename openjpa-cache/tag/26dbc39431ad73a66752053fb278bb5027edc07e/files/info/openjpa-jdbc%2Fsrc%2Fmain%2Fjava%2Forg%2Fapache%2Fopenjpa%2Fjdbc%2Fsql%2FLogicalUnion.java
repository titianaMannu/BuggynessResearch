{"sha":"9f28b9bb13d9e98902564a5a3646aad86d262fb1","node_id":"MDQ6QmxvYjIwNjM2NDo5ZjI4YjliYjEzZDllOTg5MDI1NjRhNWEzNjQ2YWFkODZkMjYyZmIx","size":29037,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9f28b9bb13d9e98902564a5a3646aad86d262fb1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwppbXBvcnQgamF2YS51dGlsLkJpdFNldDsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwpp\nbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJD\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVp\nZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEu\nVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJu\nYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5V\nbnN1cHBvcnRlZEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLlVzZXJFeGNlcHRpb247CgovKioKICogQSBsb2dpY2FsIHVuaW9u\nIG1hZGUgdXAgb2YgbXVsdGlwbGUgZGlzdGluY3Qgc2VsZWN0cyB3aG9zZSBy\nZXN1bHRzIGFyZQogKiBjb21iaW5lZCBpbiBtZW1vcnkuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgTG9naWNhbFVuaW9uCiAg\nICBpbXBsZW1lbnRzIFVuaW9uIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAg\nICAgKExvZ2ljYWxVbmlvbi5jbGFzcyk7CgogICAgcHJvdGVjdGVkIGZpbmFs\nIFVuaW9uU2VsZWN0W10gc2VsczsKICAgIHByb3RlY3RlZCBmaW5hbCBEQkRp\nY3Rpb25hcnkgZGljdDsKICAgIHByb3RlY3RlZCBmaW5hbCBDbGFzc01hcHBp\nbmdbXSBtYXBwaW5nczsKICAgIHByb3RlY3RlZCBmaW5hbCBCaXRTZXQgZGVz\nYyA9IG5ldyBCaXRTZXQoKTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZGlzdGlu\nY3QgPSB0cnVlOwogICAKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLgog\nICAgICoKICAgICAqIEBwYXJhbSBjb25mIHN5c3RlbSBjb25maWd1cmF0aW9u\nCiAgICAgKiBAcGFyYW0gc2VscyB0aGUgbnVtYmVyIG9mIFNRTCBzZWxlY3Rz\nIHRvIHVuaW9uIHRvZ2V0aGVyCiAgICAgKi8KICAgIHB1YmxpYyBMb2dpY2Fs\nVW5pb24oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgaW50IHNlbHMpIHsKICAg\nICAgICB0aGlzKGNvbmYsIHNlbHMsIG51bGwpOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29uc3RydWN0b3IgdXNlZCB0byBzZWVkIHRoZSBpbnRlcm5hbCBz\nZWxlY3RzLgogICAgICovCiAgICBwdWJsaWMgTG9naWNhbFVuaW9uKEpEQkND\nb25maWd1cmF0aW9uIGNvbmYsIFNlbGVjdFtdIHNlZWRzKSB7CiAgICAgICAg\ndGhpcyhjb25mLCBzZWVkcy5sZW5ndGgsIHNlZWRzKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIERlbGVnYXRlIGNvbnN0cnVjdG9yLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgTG9naWNhbFVuaW9uKEpEQkNDb25maWd1cmF0aW9uIGNvbmYs\nIGludCBzZWxzLCBTZWxlY3RbXSBzZWVkcykgewogICAgICAgIGlmIChzZWxz\nID09IDApCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlv\nbigic2VscyA9PSAwIik7CgogICAgICAgIGRpY3QgPSBjb25mLmdldERCRGlj\ndGlvbmFyeUluc3RhbmNlKCk7CiAgICAgICAgbWFwcGluZ3MgPSBuZXcgQ2xh\nc3NNYXBwaW5nW3NlbHNdOwogICAgICAgIHRoaXMuc2VscyA9IG5ldyBVbmlv\nblNlbGVjdFtzZWxzXTsKCiAgICAgICAgU2VsZWN0SW1wbCBzZWVkOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2VsczsgaSsrKSB7CiAgICAgICAg\nICAgIHNlZWQgPSAoc2VlZHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgID8g\nKFNlbGVjdEltcGwpIGNvbmYuZ2V0U1FMRmFjdG9yeUluc3RhbmNlKCkubmV3\nU2VsZWN0KCkKICAgICAgICAgICAgICAgIDogKFNlbGVjdEltcGwpIHNlZWRz\nW2ldOwogICAgICAgICAgICB0aGlzLnNlbHNbaV0gPSBuZXdVbmlvblNlbGVj\ndChzZWVkLCBpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBD\ncmVhdGUgYSBuZXcgdW5pb24gc2VsZWN0IHdpdGggdGhlIGdpdmVuIGRlbGVn\nYXRlIGFuZCB1bmlvbiBwb3NpdGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFVuaW9uU2VsZWN0IG5ld1VuaW9uU2VsZWN0KFNlbGVjdEltcGwgc2VlZCwg\naW50IHBvcykgewogICAgICAgIHJldHVybiBuZXcgVW5pb25TZWxlY3Qoc2Vl\nZCwgcG9zKTsKICAgIH0KCiAgICBwdWJsaWMgU2VsZWN0W10gZ2V0U2VsZWN0\ncygpIHsKICAgICAgICByZXR1cm4gc2VsczsKICAgIH0KICAgCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1VuaW9uKCkgewogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhYm9ydFVuaW9uKCkgewogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0T3JkZXJpbmcoKSB7CiAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIEpEQkNDb25maWd1cmF0aW9u\nIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0u\nZ2V0Q29uZmlndXJhdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBEQkRpY3Rp\nb25hcnkgZ2V0REJEaWN0aW9uYXJ5KCkgewogICAgICAgIHJldHVybiBkaWN0\nOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TZWxlY3QoYm9vbGVh\nbiBmb3JVcGRhdGUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsK\nICAgICAgICByZXR1cm4gZGljdC50b1NlbGVjdChzZWxzWzBdLCBmb3JVcGRh\ndGUsIGZldGNoKTsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIHRvU2Vs\nZWN0Q291bnQoKSB7CiAgICAgICAgcmV0dXJuIGRpY3QudG9TZWxlY3RDb3Vu\ndChzZWxzWzBdKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRBdXRv\nRGlzdGluY3QoKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0uZ2V0QXV0b0Rp\nc3RpbmN0KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0Rpc3Rp\nbmN0KGJvb2xlYW4gZGlzdGluY3QpIHsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHNlbHNbaV0u\nc2V0QXV0b0Rpc3RpbmN0KGRpc3RpbmN0KTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0Rpc3RpbmN0KCkgewogICAgICAgIHJldHVybiBfZGlzdGlu\nY3Q7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGlzdGluY3QoYm9vbGVh\nbiBkaXN0aW5jdCkgewogICAgICAgIF9kaXN0aW5jdCA9IGRpc3RpbmN0Owog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzTFJTKCkgewogICAgICAgIHJl\ndHVybiBzZWxzWzBdLmlzTFJTKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0TFJTKGJvb2xlYW4gbHJzKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzZWxzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZWxzW2ldLnNl\ndExSUyhscnMpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0RXhwZWN0ZWRS\nZXN1bHRDb3VudCgpIHsKICAgICAgICByZXR1cm4gc2Vsc1swXS5nZXRFeHBl\nY3RlZFJlc3VsdENvdW50KCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIHNldEV4cGVjdGVkUmVzdWx0Q291bnQoaW50IGV4cGVjdGVkUmVzdWx0Q291\nbnQsCiAgICAgICAgYm9vbGVhbiBmb3JjZSkgewogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgc2Vs\nc1tpXS5zZXRFeHBlY3RlZFJlc3VsdENvdW50KGV4cGVjdGVkUmVzdWx0Q291\nbnQsIGZvcmNlKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldEpvaW5TeW50\nYXgoKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0uZ2V0Sm9pblN5bnRheCgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEpvaW5TeW50YXgoaW50IHN5\nbnRheCkgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgc2Vsc1tpXS5zZXRKb2luU3ludGF4KHN5\nbnRheCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5k\nb21BY2Nlc3MoYm9vbGVhbiBmb3JVcGRhdGUpIHsKICAgICAgICBpZiAoc2Vs\ncy5sZW5ndGggPT0gMSkKICAgICAgICAgICAgcmV0dXJuIHNlbHNbMF0uc3Vw\ncG9ydHNSYW5kb21BY2Nlc3MoZm9yVXBkYXRlKTsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2Nr\naW5nKCkgewogICAgICAgIGlmIChzZWxzLmxlbmd0aCA9PSAxKQogICAgICAg\nICAgICByZXR1cm4gc2Vsc1swXS5zdXBwb3J0c0xvY2tpbmcoKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIGlmICghc2Vsc1tpXS5zdXBwb3J0c0xvY2tpbmcoKSkKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENvdW50KEpEQkNTdG9yZSBzdG9y\nZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpbnQg\nY291bnQgPSAwOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgY291bnQgKz0gc2Vsc1tpXS5nZXRD\nb3VudChzdG9yZSk7CiAgICAgICAgcmV0dXJuIGNvdW50OwogICAgfQoKICAg\nIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpCiAgICAgICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBleGVjdXRlKHN0b3JlLCBm\nZXRjaCwgbnVsbCk7CiAgICB9ICAgIAoKICAgIHB1YmxpYyBSZXN1bHQgZXhl\nY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24g\nZmV0Y2gsCiAgICAgICAgaW50IGxvY2tMZXZlbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gZXhlY3V0ZShzdG9yZSwg\nZmV0Y2gsIGxvY2tMZXZlbCwgbnVsbCk7CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gZmV0Y2gsIAogICAgICAgIExpc3QgcGFyYW1zKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChmZXRjaCA9\nPSBudWxsKQogICAgICAgICAgICBmZXRjaCA9IHN0b3JlLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpOwogICAgICAgIHJldHVybiBleGVjdXRlKHN0b3JlLCBm\nZXRjaCwgZmV0Y2guZ2V0UmVhZExvY2tMZXZlbCgpLCBwYXJhbXMpOwogICAg\nfQoKICAgIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUs\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAgICAgICAgaW50IGxv\nY2tMZXZlbCwgTGlzdCBwYXJhbXMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKGZldGNoID09IG51bGwpCiAgICAgICAgICAg\nIGZldGNoID0gc3RvcmUuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CgogICAg\nICAgIGlmIChzZWxzLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgIFJlc3Vs\ndCByZXMgPSBzZWxzWzBdLmV4ZWN1dGUoc3RvcmUsIGZldGNoLCBsb2NrTGV2\nZWwsIHBhcmFtcyk7CiAgICAgICAgICAgICgoQWJzdHJhY3RSZXN1bHQpIHJl\ncykuc2V0QmFzZU1hcHBpbmcobWFwcGluZ3NbMF0pOwogICAgICAgICAgICBy\nZXR1cm4gcmVzOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdldEV4cGVjdGVk\nUmVzdWx0Q291bnQoKSA9PSAxKSB7CiAgICAgICAgICAgIEFic3RyYWN0UmVz\ndWx0IHJlczsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICByZXMgPSAoQWJzdHJh\nY3RSZXN1bHQpIHNlbHNbaV0uZXhlY3V0ZShzdG9yZSwgZmV0Y2gsCiAgICAg\nICAgICAgICAgICAgICAgbG9ja0xldmVsLCBwYXJhbXMpOwogICAgICAgICAg\nICAgICAgcmVzLnNldEJhc2VNYXBwaW5nKG1hcHBpbmdzW2ldKTsKICAgICAg\nICAgICAgICAgIHJlcy5zZXRJbmRleE9mKGkpOwoKICAgICAgICAgICAgICAg\nIC8vIGlmIHdlIGdldCB0byB0aGUgbGFzdCBzZWxlY3QsIGp1c3QgcmV0dXJu\nIGl0cyByZXN1bHQKICAgICAgICAgICAgICAgIGlmIChpID09IHNlbHMubGVu\nZ3RoIC0gMSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwoKICAg\nICAgICAgICAgICAgIC8vIHJldHVybiB0aGUgZmlyc3QgcmVzdWx0IHRoYXQg\naGFzIGEgcm93CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIGlmICghcmVzLm5leHQoKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgcmVzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoQmFjaygpOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gcmVzOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICByZXMu\nY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nLy8gY3JlYXRlIGEgc2luZ2xlIHJlc3VsdCBmcm9tIGVhY2ggc2VsZWN0IGlu\nIG91ciBmYWtlIHVuaW9uLCBtZXJnaW5nCiAgICAgICAgLy8gdGhlbSBhcyBu\nZWVkZWQKICAgICAgICBBYnN0cmFjdFJlc3VsdFtdIHJlcyA9IG5ldyBBYnN0\ncmFjdFJlc3VsdFtzZWxzLmxlbmd0aF07CiAgICAgICAgTGlzdFtdIG9yZGVy\nSWR4cyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGlzdCBs\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJlcy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICAgICAgcmVzW2ldID0gKEFic3RyYWN0UmVz\ndWx0KSBzZWxzW2ldLmV4ZWN1dGUoc3RvcmUsIGZldGNoLAogICAgICAgICAg\nICAgICAgICAgIGxvY2tMZXZlbCwgcGFyYW1zKTsKICAgICAgICAgICAgICAg\nIHJlc1tpXS5zZXRCYXNlTWFwcGluZyhtYXBwaW5nc1tpXSk7CiAgICAgICAg\nICAgICAgICByZXNbaV0uc2V0SW5kZXhPZihpKTsKCiAgICAgICAgICAgICAg\nICBsID0gc2Vsc1tpXS5nZXRTZWxlY3RlZE9yZGVySW5kZXhlcygpOwogICAg\nICAgICAgICAgICAgaWYgKGwgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nICAgIGlmIChvcmRlcklkeHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICAgICAgb3JkZXJJZHhzID0gbmV3IExpc3Rbc2Vscy5sZW5ndGhdOwogICAg\nICAgICAgICAgICAgICAgIG9yZGVySWR4c1tpXSA9IGw7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IHJlc1tp\nXSAhPSBudWxsOyBpKyspCiAgICAgICAgICAgICAgICByZXNbaV0uY2xvc2Uo\nKTsKICAgICAgICAgICAgdGhyb3cgc2U7CiAgICAgICAgfQoKICAgICAgICAv\nLyBpZiBtdWx0aXBsZSBzZWxlY3RzIGhhdmUgb3JkZXJpbmcsIHVzZSBhIGNv\nbXBhcmF0b3IgdG8gY29sbGF0ZQogICAgICAgIFJlc3VsdENvbXBhcmF0b3Ig\nY29tcCA9IG51bGw7CiAgICAgICAgaWYgKG9yZGVySWR4cyAhPSBudWxsKQog\nICAgICAgICAgICBjb21wID0gbmV3IFJlc3VsdENvbXBhcmF0b3Iob3JkZXJJ\nZHhzLCBkZXNjLCBkaWN0KTsKICAgICAgICByZXR1cm4gbmV3IE1lcmdlZFJl\nc3VsdChyZXMsIGNvbXApOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNlbGVj\ndChVbmlvbi5TZWxlY3RvciBzZWxlY3RvcikgewogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgc2Vs\nZWN0b3Iuc2VsZWN0KHNlbHNbaV0sIGkpOwogICAgfQoKICAgIHB1YmxpYyBT\ndHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIHRvU2VsZWN0KGZh\nbHNlLCBudWxsKS5nZXRTUUwoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEEg\nY2FsbGJhY2sgdXNlZCB0byBjcmVhdGUgdGhlIHNlbGVjdHMgaW4gYSBTUUwg\ndW5pb24uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIFNl\nbGVjdG9yIHsKCiAgICAgICAgLyoqCiAgICAgICAgICogUG9wdWxhdGUgdGhl\nIDxjb2RlPmk8L2NvZGU+dGggc2VsZWN0IGluIHRoZSB1bmlvbi4KICAgICAg\nICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBzZWxlY3QoU2VsZWN0IHNlbCwg\naW50IGkpOwogICAgfQoKICAgIC8qKgogICAgICogQSBzZWxlY3QgdGhhdCBp\ncyBwYXJ0IG9mIGEgbG9naWNhbCB1bmlvbi4KICAgICAqLwogICAgcHVibGlj\nIGNsYXNzIFVuaW9uU2VsZWN0CiAgICAgICAgaW1wbGVtZW50cyBTZWxlY3Qg\newoKICAgICAgICBwcm90ZWN0ZWQgZmluYWwgU2VsZWN0SW1wbCBzZWw7CiAg\nICAgICAgcHJvdGVjdGVkIGZpbmFsIGludCBwb3M7CiAgICAgICAgcHJvdGVj\ndGVkIGludCBvcmRlcnMgPSAwOwogICAgICAgIHByb3RlY3RlZCBMaXN0IG9y\nZGVySWR4cyA9IG51bGw7CiAgICAgICAKICAgICAgICBwdWJsaWMgVW5pb25T\nZWxlY3QoU2VsZWN0SW1wbCBzZWwsIGludCBwb3MpIHsKICAgICAgICAgICAg\ndGhpcy5zZWwgPSBzZWw7CiAgICAgICAgICAgIHRoaXMucG9zID0gcG9zOwog\nICAgICAgICAgICBzZWwuc2V0UmVjb3JkT3JkZXJlZEluZGV4ZXModHJ1ZSk7\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBEZWxlZ2F0ZSBz\nZWxlY3QuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIFNlbGVjdEltcGwg\nZ2V0RGVsZWdhdGUoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWw7CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gdGhlIGluZGV4\nZXMgb2YgdGhlIGRhdGEgaW4gdGhlIHNlbGVjdCBjbGF1c2UgdGhpcyBxdWVy\neSBpcwogICAgICAgICAqIG9yZGVyZWQgYnkuCiAgICAgICAgICovCiAgICAg\nICAgcHVibGljIExpc3QgZ2V0U2VsZWN0ZWRPcmRlckluZGV4ZXMoKSB7CiAg\nICAgICAgICAgIGlmIChvcmRlcklkeHMgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgIG9yZGVySWR4cyA9IHNlbC5nZXRPcmRlcmVkSW5kZXhlcygpOwogICAg\nICAgICAgICByZXR1cm4gb3JkZXJJZHhzOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIEpEQkNDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0Q29uZmlndXJhdGlvbigpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBpbmRleE9mKCkgewogICAg\nICAgICAgICByZXR1cm4gcG9zOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIFNRTEJ1ZmZlciB0b1NlbGVjdChib29sZWFuIGZvclVwZGF0ZSwKICAgICAg\nICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAg\nICAgICByZXR1cm4gc2VsLnRvU2VsZWN0KGZvclVwZGF0ZSwgZmV0Y2gpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdENv\ndW50KCkgewogICAgICAgICAgICByZXR1cm4gc2VsLnRvU2VsZWN0Q291bnQo\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGdldEF1dG9E\naXN0aW5jdCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRBdXRvRGlz\ndGluY3QoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEF1\ndG9EaXN0aW5jdChib29sZWFuIGRpc3RpbmN0KSB7CiAgICAgICAgICAgIHNl\nbC5zZXRBdXRvRGlzdGluY3QoZGlzdGluY3QpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gaXNEaXN0aW5jdCgpIHsKICAgICAgICAgICAg\ncmV0dXJuIHNlbC5pc0Rpc3RpbmN0KCk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzZXREaXN0aW5jdChib29sZWFuIGRpc3RpbmN0KSB7CiAg\nICAgICAgICAgIHNlbC5zZXREaXN0aW5jdChkaXN0aW5jdCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc0xSUygpIHsKICAgICAgICAg\nICAgcmV0dXJuIHNlbC5pc0xSUygpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgc2V0TFJTKGJvb2xlYW4gbHJzKSB7CiAgICAgICAgICAgIHNl\nbC5zZXRMUlMobHJzKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQg\nZ2V0Sm9pblN5bnRheCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRK\nb2luU3ludGF4KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBz\nZXRKb2luU3ludGF4KGludCBqb2luU3ludGF4KSB7CiAgICAgICAgICAgIHNl\nbC5zZXRKb2luU3ludGF4KGpvaW5TeW50YXgpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3MoYm9vbGVh\nbiBmb3JVcGRhdGUpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zdXBwb3J0\nc1JhbmRvbUFjY2Vzcyhmb3JVcGRhdGUpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2NraW5nKCkgewogICAgICAgICAg\nICByZXR1cm4gc2VsLnN1cHBvcnRzTG9ja2luZygpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGludCBnZXRDb3VudChKREJDU3RvcmUgc3RvcmUpCiAg\nICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBy\nZXR1cm4gc2VsLmdldENvdW50KHN0b3JlKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIAogICAgICAgICAgICBMaXN0IHBh\ncmFtcykKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwuZXhlY3V0ZShzdG9yZSwgZmV0Y2gsIHBhcmFt\ncyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUmVzdWx0IGV4ZWN1dGUo\nSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNo\nLAogICAgICAgICAgICBpbnQgbG9ja0xldmVsLCBMaXN0IHBhcmFtcykKICAg\nICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJl\ndHVybiBzZWwuZXhlY3V0ZShzdG9yZSwgZmV0Y2gsIGxvY2tMZXZlbCwgcGFy\nYW1zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHQgZXhlY3V0\nZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0\nY2gpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICByZXR1cm4gc2VsLmV4ZWN1dGUoc3RvcmUsIGZldGNoKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUg\nc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAgICAgICAg\nICAgIGludCBsb2NrTGV2ZWwpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICByZXR1cm4gc2VsLmV4ZWN1dGUoc3RvcmUs\nIGZldGNoLCBsb2NrTGV2ZWwpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBwdWJsaWMgTGlzdCBnZXRTdWJzZWxlY3RzKCkgewogICAgICAgICAgICBy\nZXR1cm4gQ29sbGVjdGlvbnMuRU1QVFlfTElTVDsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBTZWxlY3QgZ2V0UGFyZW50KCkgewogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0U3Vic2VsZWN0UGF0aCgpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRQYXJlbnQoU2Vs\nZWN0IHBhcmVudCwgU3RyaW5nIHBhdGgpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bmlvbi1lbGVt\nZW50IikpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNlbGVjdCBnZXRG\ncm9tU2VsZWN0KCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEZyb21TZWxlY3QoU2VsZWN0\nIHNlbCkgewogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oX2xvYy5nZXQoInVuaW9uLWVsZW1lbnQiKSk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNFYWdlckpvaW4oYm9vbGVhbiB0\nb01hbnkpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5oYXNFYWdlckpvaW4o\ndG9NYW55KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGhh\nc0pvaW4oYm9vbGVhbiB0b01hbnkpIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5oYXNKb2luKHRvTWFueSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBpc1NlbGVjdGVkKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgICAg\nIHJldHVybiBzZWwuaXNTZWxlY3RlZCh0YWJsZSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRUYWJsZUFsaWFzZXMoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWwuZ2V0VGFibGVBbGlhc2VzKCk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgTGlzdCBnZXRTZWxlY3RzKCkgewogICAg\nICAgICAgICByZXR1cm4gc2VsLmdldFNlbGVjdHMoKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBMaXN0IGdldFNlbGVjdEFsaWFzZXMoKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwuZ2V0U2VsZWN0QWxpYXNlcygpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIExpc3QgZ2V0SWRlbnRpZmllckFsaWFzZXMo\nKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0SWRlbnRpZmllckFsaWFz\nZXMoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTUUxCdWZmZXIgZ2V0\nT3JkZXJpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0T3JkZXJp\nbmcoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTUUxCdWZmZXIgZ2V0\nR3JvdXBpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0R3JvdXBp\nbmcoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTUUxCdWZmZXIgZ2V0\nV2hlcmUoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0V2hlcmUoKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTUUxCdWZmZXIgZ2V0SGF2aW5n\nKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEhhdmluZygpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciBnZXRTUUwoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWwuZ2V0U1FMKCk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyB2b2lkIHNldFNRTChKREJDU3RvcmUgc3Rv\ncmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICAg\nICAgc2VsLnNldFNRTChzdG9yZSwgZmV0Y2gpOwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBwdWJsaWMgdm9pZCBhZGRKb2luQ2xhc3NDb25kaXRpb25z\nKCkgewogICAgICAgICAgICBzZWwuYWRkSm9pbkNsYXNzQ29uZGl0aW9ucygp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5zIGdldEpvaW5zKCkg\newogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5zKCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgSXRlcmF0b3IgZ2V0Sm9pbkl0ZXJhdG9yKCkg\newogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5JdGVyYXRvcigpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0U3RhcnRJbmRleCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRTdGFydEluZGV4KCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRFbmRJbmRleCgpIHsK\nICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRFbmRJbmRleCgpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0UmFuZ2UobG9uZyBzdGFydCwg\nbG9uZyBlbmQpIHsKICAgICAgICAgICAgc2VsLnNldFJhbmdlKHN0YXJ0LCBl\nbmQpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRDb2x1\nbW5BbGlhcyhDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\nZ2V0Q29sdW1uQWxpYXMoY29sKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0Q29sdW1uQWxpYXMoQ29sdW1uIGNvbCwgSm9pbnMgam9p\nbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRDb2x1bW5BbGlhcyhj\nb2wsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0Q29sdW1uQWxpYXMoU3RyaW5nIGNvbCwgVGFibGUgdGFibGUpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5nZXRDb2x1bW5BbGlhcyhjb2wsIHRhYmxl\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q29sdW1u\nQWxpYXMoU3RyaW5nIGNvbCwgVGFibGUgdGFibGUsIEpvaW5zIGpvaW5zKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0Q29sdW1uQWxpYXMoY29sLCB0\nYWJsZSwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gaXNBZ2dyZWdhdGUoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuaXNB\nZ2dyZWdhdGUoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNl\ndEFnZ3JlZ2F0ZShib29sZWFuIGFnZykgewogICAgICAgICAgICBzZWwuc2V0\nQWdncmVnYXRlKGFnZyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBpc0xvYigpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5pc0xvYigp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0TG9iKGJvb2xl\nYW4gbG9iKSB7CiAgICAgICAgICAgIHNlbC5zZXRMb2IobG9iKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNlbGVjdFBsYWNlaG9sZGVyKFN0\ncmluZyBzcWwpIHsKICAgICAgICAgICAgc2VsLnNlbGVjdFBsYWNlaG9sZGVy\nKHNxbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBjbGVhclNl\nbGVjdHMoKSB7CiAgICAgICAgICAgIHNlbC5jbGVhclNlbGVjdHMoKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIHNlbGVjdChTUUxCdWZm\nZXIgc3FsLCBPYmplY3QgaWQpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5z\nZWxlY3Qoc3FsLCBpZCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBzZWxlY3QoU1FMQnVmZmVyIHNxbCwgT2JqZWN0IGlkLCBKb2lucyBq\nb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVjdChzcWwsIGlk\nLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBz\nZWxlY3QoU3RyaW5nIHNxbCwgT2JqZWN0IGlkKSB7CiAgICAgICAgICAgIHJl\ndHVybiBzZWwuc2VsZWN0KHNxbCwgaWQpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gc2VsZWN0KFN0cmluZyBzcWwsIE9iamVjdCBpZCwg\nSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3Qo\nc3FsLCBpZCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gc2VsZWN0KENvbHVtbiBjb2wpIHsKICAgICAgICAgICAgcmV0dXJu\nIHNlbC5zZWxlY3QoY29sKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBi\nb29sZWFuIHNlbGVjdChDb2x1bW4gY29sLCBKb2lucyBqb2lucykgewogICAg\nICAgICAgICByZXR1cm4gc2VsLnNlbGVjdChjb2wsIGpvaW5zKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2VsZWN0KENvbHVtbltdIGNvbHMp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3QoY29scyk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgaW50IHNlbGVjdChDb2x1bW5bXSBjb2xz\nLCBKb2lucyBqb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVj\ndChjb2xzLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9p\nZCBzZWxlY3QoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2Vz\nLAogICAgICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlcikgewogICAgICAgICAgICBzZWxl\nY3QobWFwcGluZywgc3ViY2xhc3Nlcywgc3RvcmUsIGZldGNoLCBlYWdlciwg\nbnVsbCwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nc2VsZWN0KENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywK\nICAgICAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGZldGNoLCBpbnQgZWFnZXIsCiAgICAgICAgICAgIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgICAgIHNlbGVjdChtYXBwaW5nLCBzdWJjbGFzc2Vz\nLCBzdG9yZSwgZmV0Y2gsIGVhZ2VyLCBqb2lucywgZmFsc2UpOwogICAgICAg\nIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIHNlbGVjdChDbGFzc01hcHBpbmcg\nbWFwcGluZywgaW50IHN1YmNsYXNzZXMsCiAgICAgICAgICAgIEpEQkNTdG9y\nZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgaW50IGVh\nZ2VyLAogICAgICAgICAgICBKb2lucyBqb2lucywgYm9vbGVhbiBpZGVudGlm\naWVyKSB7CiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdGhlIGZpcnN0IChw\ncmltYXJ5KSBtYXBwaW5nIHNlbGVjdGVkIGZvciB0aGlzCiAgICAgICAgICAg\nIC8vIFNFTEVDVCwgcmVjb3JkIGl0IHNvIHdlIGNhbiBmaWd1cmUgb3V0IHdo\nYXQgdGhlIHJlc3VsdCB0eXBlIGlzCiAgICAgICAgICAgIC8vIHNpbmNlIHRo\nZSBkaXNjcmltaW5hdG9yIG1pZ2h0IG5vdCBiZSBzZWxlY3RlZAogICAgICAg\nICAgICBpZiAobWFwcGluZ3NbcG9zXSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgbWFwcGluZ3NbcG9zXSA9IG1hcHBpbmc7CgogICAgICAgICAgICBzZWwu\nc2VsZWN0KHRoaXMsIG1hcHBpbmcsIHN1YmNsYXNzZXMsIHN0b3JlLCBmZXRj\naCwgZWFnZXIsCiAgICAgICAgICAgICAgICBqb2lucywgaWRlbnRpZmllcik7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3RJZGVu\ndGlmaWVyKENvbHVtbiBjb2wpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5z\nZWxlY3RJZGVudGlmaWVyKGNvbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBzZWxlY3RJZGVudGlmaWVyKENvbHVtbiBjb2wsIEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2VsZWN0SWRlbnRp\nZmllcihjb2wsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBp\nbnQgc2VsZWN0SWRlbnRpZmllcihDb2x1bW5bXSBjb2xzKSB7CiAgICAgICAg\nICAgIHJldHVybiBzZWwuc2VsZWN0SWRlbnRpZmllcihjb2xzKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2VsZWN0SWRlbnRpZmllcihDb2x1\nbW5bXSBjb2xzLCBKb2lucyBqb2lucykgewogICAgICAgICAgICByZXR1cm4g\nc2VsLnNlbGVjdElkZW50aWZpZXIoY29scywgam9pbnMpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgc2VsZWN0SWRlbnRpZmllcihDbGFzc01h\ncHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNzZXMsCiAgICAgICAgICAgIEpE\nQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwg\naW50IGVhZ2VyKSB7CiAgICAgICAgICAgIHNlbGVjdChtYXBwaW5nLCBzdWJj\nbGFzc2VzLCBzdG9yZSwgZmV0Y2gsIGVhZ2VyLCBudWxsLCB0cnVlKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNlbGVjdElkZW50aWZpZXIo\nQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2VzLAogICAgICAg\nICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24g\nZmV0Y2gsIGludCBlYWdlciwKICAgICAgICAgICAgSm9pbnMgam9pbnMpIHsK\nICAgICAgICAgICAgc2VsZWN0KG1hcHBpbmcsIHN1YmNsYXNzZXMsIHN0b3Jl\nLCBmZXRjaCwgZWFnZXIsIGpvaW5zLCB0cnVlKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBpbnQgc2VsZWN0UHJpbWFyeUtleShDbGFzc01hcHBpbmcg\nbWFwcGluZykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVjdFByaW1h\ncnlLZXkobWFwcGluZyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50\nIHNlbGVjdFByaW1hcnlLZXkoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2VsZWN0UHJpbWFy\neUtleShtYXBwaW5nLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgaW50IG9yZGVyQnlQcmltYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5n\nLCBib29sZWFuIGFzYywKICAgICAgICAgICAgYm9vbGVhbiBzZWxlY3QpIHsK\nICAgICAgICAgICAgcmV0dXJuIG9yZGVyQnlQcmltYXJ5S2V5KG1hcHBpbmcs\nIGFzYywgbnVsbCwgc2VsZWN0KTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBpbnQgb3JkZXJCeVByaW1hcnlLZXkoQ2xhc3NNYXBwaW5nIG1hcHBpbmcs\nIGJvb2xlYW4gYXNjLAogICAgICAgICAgICBKb2lucyBqb2lucywgYm9vbGVh\nbiBzZWxlY3QpIHsKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIHBrcyA9IG1h\ncHBpbmc7CiAgICAgICAgICAgIHdoaWxlICghcGtzLmlzUHJpbWFyeUtleU9i\namVjdElkKHRydWUpKQogICAgICAgICAgICAgICAgcGtzID0gcGtzLmdldEpv\naW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgICAgICBDb2x1\nbW5bXSBjb2xzID0gcGtzLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAg\nICAgICAgIHJlY29yZE9yZGVyQ29sdW1ucyhjb2xzLCBhc2MpOwogICAgICAg\nICAgICByZXR1cm4gc2VsLm9yZGVyQnlQcmltYXJ5S2V5KG1hcHBpbmcsIGFz\nYywgam9pbnMsIHNlbGVjdCwKICAgICAgICAgICAgICAgIGlzVW5pb24oKSk7\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZWNvcmQgdGhh\ndCB3ZSdyZSBvcmRlcmluZyBieSBhIFNRTCBleHByZXNzaW9uLgogICAgICAg\nICAqLwogICAgICAgIHByb3RlY3RlZCB2b2lkIHJlY29yZE9yZGVyKE9iamVj\ndCBvcmQsIGJvb2xlYW4gYXNjKSB7CiAgICAgICAgICAgIGlmIChvcmQgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgb3Jk\nZXJJZHhzID0gbnVsbDsKCiAgICAgICAgICAgIGludCBpZHggPSBvcmRlcnMr\nKzsKICAgICAgICAgICAgaWYgKGRlc2MuZ2V0KGlkeCkgJiYgYXNjKQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nImluY29tcGF0LW9yZGVyaW5nIikpOwogICAgICAgICAgICBpZiAoIWFzYykK\nICAgICAgICAgICAgICAgIGRlc2Muc2V0KGlkeCk7CiAgICAgICAgfQoKICAg\nICAgICAvKioKICAgICAgICAgKiBSZWNvcmQgdGhhdCB3ZSdyZSBvcmRlcmlu\nZyBieSB0aGUgZ2l2ZW4gY29sdW1ucy4KICAgICAgICAgKi8KICAgICAgICBw\ncm90ZWN0ZWQgdm9pZCByZWNvcmRPcmRlckNvbHVtbnMoQ29sdW1uW10gY29s\ncywgYm9vbGVhbiBhc2MpIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgcmVjb3Jk\nT3JkZXIoY29sc1tpXSwgYXNjKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIG9yZGVyQnkoQ29sdW1uIGNvbCwgYm9vbGVhbiBhc2MsIGJv\nb2xlYW4gc2VsZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBvcmRlckJ5KGNv\nbCwgYXNjLCBudWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gb3JkZXJCeShDb2x1bW4gY29sLCBib29sZWFuIGFzYywg\nSm9pbnMgam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2VsZWN0KSB7CiAg\nICAgICAgICAgIHJlY29yZE9yZGVyKGNvbCwgYXNjKTsKICAgICAgICAgICAg\ncmV0dXJuIHNlbC5vcmRlckJ5KGNvbCwgYXNjLCBqb2lucywgc2VsZWN0LCBp\nc1VuaW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBvcmRl\nckJ5KENvbHVtbltdIGNvbHMsIGJvb2xlYW4gYXNjLCBib29sZWFuIHNlbGVj\ndCkgewogICAgICAgICAgICByZXR1cm4gb3JkZXJCeShjb2xzLCBhc2MsIG51\nbGwsIHNlbGVjdCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IG9y\nZGVyQnkoQ29sdW1uW10gY29scywgYm9vbGVhbiBhc2MsIEpvaW5zIGpvaW5z\nLAogICAgICAgICAgICBib29sZWFuIHNlbGVjdCkgewogICAgICAgICAgICBy\nZWNvcmRPcmRlckNvbHVtbnMoY29scywgYXNjKTsKICAgICAgICAgICAgcmV0\ndXJuIHNlbC5vcmRlckJ5KGNvbHMsIGFzYywgam9pbnMsIHNlbGVjdCwgaXNV\nbmlvbigpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIG9y\nZGVyQnkoU1FMQnVmZmVyIHNxbCwgYm9vbGVhbiBhc2MsIGJvb2xlYW4gc2Vs\nZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBvcmRlckJ5KHNxbCwgYXNjLCBu\ndWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gb3JkZXJCeShTUUxCdWZmZXIgc3FsLCBib29sZWFuIGFzYywgSm9pbnMg\nam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2VsZWN0KSB7CiAgICAgICAg\nICAgIHJlY29yZE9yZGVyKHNxbC5nZXRTUUwoZmFsc2UpLCBhc2MpOwogICAg\nICAgICAgICByZXR1cm4gc2VsLm9yZGVyQnkoc3FsLCBhc2MsIGpvaW5zLCBz\nZWxlY3QsIGlzVW5pb24oKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBvcmRlckJ5KFN0cmluZyBzcWwsIGJvb2xlYW4gYXNjLCBib29s\nZWFuIHNlbGVjdCkgewogICAgICAgICAgICByZXR1cm4gb3JkZXJCeShzcWws\nIGFzYywgbnVsbCwgc2VsZWN0KTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIG9yZGVyQnkoU3RyaW5nIHNxbCwgYm9vbGVhbiBhc2MsIEpv\naW5zIGpvaW5zLAogICAgICAgICAgICBib29sZWFuIHNlbGVjdCkgewogICAg\nICAgICAgICByZWNvcmRPcmRlcihzcWwsIGFzYyk7CiAgICAgICAgICAgIHJl\ndHVybiBzZWwub3JkZXJCeShzcWwsIGFzYywgam9pbnMsIHNlbGVjdCwgaXNV\nbmlvbigpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGNsZWFy\nT3JkZXJpbmcoKSB7CiAgICAgICAgICAgIHNlbC5jbGVhck9yZGVyaW5nKCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZVByaW1hcnlL\nZXkoT2JqZWN0IG9pZCwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcsCiAgICAgICAg\nICAgIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgICAgICBzZWwud2hlcmVQ\ncmltYXJ5S2V5KG9pZCwgbWFwcGluZywgc3RvcmUpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBwdWJsaWMgaW50IHdoZXJlUHJpbWFyeUtleShDbGFz\nc01hcHBpbmcgbWFwcGluZywgQ29sdW1uW10gdG9Db2xzLCAKICAgICAgICAg\nICAgQ29sdW1uW10gZnJvbUNvbHMsIE9iamVjdCBvaWQsIEpEQkNTdG9yZSBz\ndG9yZSwgUGF0aEpvaW5zIHBqLAogICAgICAgICAgICBTUUxCdWZmZXIgYnVm\nLCBMaXN0IHBhcm1MaXN0KSB7CiAgICAgICAgICAgIHJldHVybiBzZWwud2hl\ncmVQcmltYXJ5S2V5KG1hcHBpbmcsIHRvQ29scywgZnJvbUNvbHMsIG9pZCwg\nc3RvcmUsIHBqLCAKICAgICAgICAgICAgICAgIGJ1ZiwgcGFybUxpc3QpOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICAKCiAgICAgICAgcHVibGljIHZv\naWQgd2hlcmVGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmssIE9iamVjdCBvaWQs\nCiAgICAgICAgICAgIENsYXNzTWFwcGluZyBtYXBwaW5nLCBKREJDU3RvcmUg\nc3RvcmUpIHsKICAgICAgICAgICAgc2VsLndoZXJlRm9yZWlnbktleShmaywg\nb2lkLCBtYXBwaW5nLCBzdG9yZSk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCB3aGVyZShKb2lucyBqb2lucykgewogICAgICAgICAgICBzZWwu\nd2hlcmUoam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nd2hlcmUoU1FMQnVmZmVyIHNxbCkgewogICAgICAgICAgICBzZWwud2hlcmUo\nc3FsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdoZXJlKFNR\nTEJ1ZmZlciBzcWwsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC53\naGVyZShzcWwsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIHdoZXJlKFN0cmluZyBzcWwpIHsKICAgICAgICAgICAgc2VsLndoZXJl\nKHNxbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZShT\ndHJpbmcgc3FsLCBKb2lucyBqb2lucykgewogICAgICAgICAgICBzZWwud2hl\ncmUoc3FsLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9p\nZCBoYXZpbmcoU1FMQnVmZmVyIHNxbCkgewogICAgICAgICAgICBzZWwuaGF2\naW5nKHNxbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBoYXZp\nbmcoU1FMQnVmZmVyIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAg\nc2VsLmhhdmluZyhzcWwsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIGhhdmluZyhTdHJpbmcgc3FsKSB7CiAgICAgICAgICAgIHNl\nbC5oYXZpbmcoc3FsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lk\nIGhhdmluZyhTdHJpbmcgc3FsLCBKb2lucyBqb2lucykgewogICAgICAgICAg\nICBzZWwuaGF2aW5nKHNxbCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgZ3JvdXBCeShTUUxCdWZmZXIgc3FsKSB7CiAgICAgICAg\nICAgIHNlbC5ncm91cEJ5KHNxbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCBncm91cEJ5KFNRTEJ1ZmZlciBzcWwsIEpvaW5zIGpvaW5zKSB7\nCiAgICAgICAgICAgIHNlbC5ncm91cEJ5KHNxbCwgam9pbnMpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ3JvdXBCeShTdHJpbmcgc3FsKSB7\nCiAgICAgICAgICAgIHNlbC5ncm91cEJ5KHNxbCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCBncm91cEJ5KFN0cmluZyBzcWwsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KHNxbCwgam9pbnMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ3JvdXBCeShDb2x1bW4g\nY29sKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KGNvbCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCBncm91cEJ5KENvbHVtbiBjb2wsIEpv\naW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KGNvbCwgam9p\nbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ3JvdXBCeShD\nb2x1bW5bXSBjb2xzKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KGNvbHMp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ3JvdXBCeShDb2x1\nbW5bXSBjb2xzLCBKb2lucyBqb2lucykgewogICAgICAgICAgICBzZWwuZ3Jv\ndXBCeShjb2xzLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBncm91cEJ5KENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xh\nc3NlcywgCiAgICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgICAgICBzZWwuZ3JvdXBC\neShtYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0Y2gpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ3JvdXBCeShDbGFzc01hcHBpbmcg\nbWFwcGluZywgaW50IHN1YmNsYXNzZXMsIAogICAgICAgICAgICBKREJDU3Rv\ncmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KG1hcHBpbmcsIHN1\nYmNsYXNzZXMsIHN0b3JlLCBmZXRjaCwgam9pbnMpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIFNlbGVjdEV4ZWN1dG9yIHdoZXJlQ2xvbmUoaW50IHNl\nbHMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC53aGVyZUNsb25lKHNlbHMp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNlbGVjdEV4ZWN1dG9yIGZ1\nbGxDbG9uZShpbnQgc2VscykgewogICAgICAgICAgICByZXR1cm4gc2VsLmZ1\nbGxDbG9uZShzZWxzKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTZWxl\nY3RFeGVjdXRvciBlYWdlckNsb25lKEZpZWxkTWFwcGluZyBrZXksIGludCBl\nYWdlclR5cGUsCiAgICAgICAgICAgIGJvb2xlYW4gdG9NYW55LCBpbnQgc2Vs\ncykgewogICAgICAgICAgICBTZWxlY3RFeGVjdXRvciBleCA9IHNlbC5lYWdl\nckNsb25lKGtleSwgZWFnZXJUeXBlLCB0b01hbnksIHNlbHMpOwogICAgICAg\nICAgICByZXR1cm4gKGV4ID09IHNlbCkgPyB0aGlzIDogZXg7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgU2VsZWN0RXhlY3V0b3IgZ2V0RWFnZXIoRmll\nbGRNYXBwaW5nIGtleSkgewogICAgICAgICAgICBTZWxlY3RFeGVjdXRvciBl\neCA9IHNlbC5nZXRFYWdlcihrZXkpOwogICAgICAgICAgICByZXR1cm4gKGV4\nID09IHNlbCkgPyB0aGlzIDogZXg7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgSm9pbnMgbmV3Sm9pbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\nbmV3Sm9pbnMoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBu\nZXdPdXRlckpvaW5zKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLm5ld091\ndGVySm9pbnMoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGFw\ncGVuZChTUUxCdWZmZXIgYnVmLCBKb2lucyBqb2lucykgewogICAgICAgICAg\nICBzZWwuYXBwZW5kKGJ1Ziwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIEpvaW5zIGFuZChKb2lucyBqb2luczEsIEpvaW5zIGpvaW5zMikg\newogICAgICAgICAgICByZXR1cm4gc2VsLmFuZChqb2luczEsIGpvaW5zMik7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMgb3IoSm9pbnMgam9p\nbnMxLCBKb2lucyBqb2luczIpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5v\ncihqb2luczEsIGpvaW5zMik7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nSm9pbnMgb3V0ZXIoSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJu\nIHNlbC5vdXRlcihqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nU3RyaW5nIHRvU3RyaW5nKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLnRv\nU3RyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdldEV4\ncGVjdGVkUmVzdWx0Q291bnQoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\nZ2V0RXhwZWN0ZWRSZXN1bHRDb3VudCgpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgc2V0RXhwZWN0ZWRSZXN1bHRDb3VudChpbnQgZXhwZWN0\nZWRSZXN1bHRDb3VudCwgCiAgICAgICAgICAgIGJvb2xlYW4gZm9yY2UpIHsK\nICAgICAgICAgICAgc2VsLnNldEV4cGVjdGVkUmVzdWx0Q291bnQoZXhwZWN0\nZWRSZXN1bHRDb3VudCwgZm9yY2UpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIENvbXBhcmF0b3IgZm9yIGNvbGxhdGluZyBvcmRlcmVkIHJl\nc3VsdHMgd2hlbiBmYWtpbmcgYSB1bmlvbi4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgY2xhc3MgUmVzdWx0Q29tcGFyYXRvcgogICAgICAgIGltcGxl\nbWVudHMgTWVyZ2VkUmVzdWx0LlJlc3VsdENvbXBhcmF0b3IgewoKICAgICAg\nICBwcml2YXRlIGZpbmFsIExpc3RbXSBfb3JkZXJzOwogICAgICAgIHByaXZh\ndGUgZmluYWwgQml0U2V0IF9kZXNjOwogICAgICAgIHByaXZhdGUgZmluYWwg\nREJEaWN0aW9uYXJ5IF9kaWN0OwoKICAgICAgICBwdWJsaWMgUmVzdWx0Q29t\ncGFyYXRvcihMaXN0W10gb3JkZXJzLCBCaXRTZXQgZGVzYywgREJEaWN0aW9u\nYXJ5IGRpY3QpIHsKICAgICAgICAgICAgX29yZGVycyA9IG9yZGVyczsKICAg\nICAgICAgICAgX2Rlc2MgPSBkZXNjOwogICAgICAgICAgICBfZGljdCA9IGRp\nY3Q7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IGdldE9yZGVy\naW5nVmFsdWUoUmVzdWx0IHJlcywgaW50IGlkeCkgewogICAgICAgICAgICAv\nLyBpZiBvbmUgdmFsdWUganVzdCByZXR1cm4gaXQKICAgICAgICAgICAgUmVz\ndWx0U2V0IHJzID0gKChSZXN1bHRTZXRSZXN1bHQpIHJlcykuZ2V0UmVzdWx0\nU2V0KCk7CiAgICAgICAgICAgIGlmIChfb3JkZXJzW2lkeF0uc2l6ZSgpID09\nIDEpCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0T3JkZXJpbmdWYWx1ZShy\ncywgX29yZGVyc1tpZHhdLmdldCgwKSk7CgogICAgICAgICAgICAvLyByZXR1\ncm4gYXJyYXkgb2YgdmFsdWVzCiAgICAgICAgICAgIE9iamVjdFtdIHZhbHMg\nPSBuZXcgT2JqZWN0W19vcmRlcnNbaWR4XS5zaXplKCldOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICB2YWxzW2ldID0gZ2V0T3JkZXJpbmdWYWx1ZShycywgX29y\nZGVyc1tpZHhdLmdldChpKSk7CiAgICAgICAgICAgIHJldHVybiB2YWxzOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogRXh0cmFjdCB2YWx1\nZSBhdCBnaXZlbiBpbmRleCBmcm9tIHJlc3VsdCBzZXQuCiAgICAgICAgICov\nCiAgICAgICAgcHJpdmF0ZSBPYmplY3QgZ2V0T3JkZXJpbmdWYWx1ZShSZXN1\nbHRTZXQgcnMsIE9iamVjdCBpKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gX2RpY3QuZ2V0T2JqZWN0KHJzLCAoKEludGVn\nZXIpIGkpLmludFZhbHVlKCkgKyAxLCBudWxsKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBTUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCBfZGljdCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgY29tcGFyZShP\nYmplY3QgbzEsIE9iamVjdCBvMikgewogICAgICAgICAgICBpZiAobzEgPT0g\nbzIpCiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgaWYg\nKG8xID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNjLmdl\ndCgwKSkgPyAtMSA6IDE7CiAgICAgICAgICAgIGlmIChvMiA9PSBudWxsKQog\nICAgICAgICAgICAgICAgcmV0dXJuIChfZGVzYy5nZXQoMCkpID8gMSA6IC0x\nOwoKICAgICAgICAgICAgaW50IGNtcDsKICAgICAgICAgICAgaWYgKCEobzEg\naW5zdGFuY2VvZiBPYmplY3RbXSkpIHsKICAgICAgICAgICAgICAgIGlmICgh\nKG8yIGluc3RhbmNlb2YgT2JqZWN0W10pKSB7CiAgICAgICAgICAgICAgICAg\nICAgY21wID0gKChDb21wYXJhYmxlKSBvMSkuY29tcGFyZVRvKG8yKTsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNjLmdldCgwKSkgPyAtY21w\nIDogY21wOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNt\ncCA9ICgoQ29tcGFyYWJsZSkgbzEpLmNvbXBhcmVUbygoKE9iamVjdFtdKSBv\nMilbMF0pOwogICAgICAgICAgICAgICAgaWYgKGNtcCAhPSAwKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiAoX2Rlc2MuZ2V0KDApKSA/IC1jbXAgOiBj\nbXA7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGlmICghKG8yIGluc3RhbmNlb2YgT2JqZWN0W10pKSB7\nCiAgICAgICAgICAgICAgICBjbXAgPSAoKENvbXBhcmFibGUpICgoT2JqZWN0\nW10pIG8xKVswXSkuY29tcGFyZVRvKG8yKTsKICAgICAgICAgICAgICAgIGlm\nIChjbXAgIT0gMCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNj\nLmdldCgwKSkgPyAtY21wIDogY21wOwogICAgICAgICAgICAgICAgcmV0dXJu\nIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE9iamVjdFtdIGExID0g\nKE9iamVjdFtdKSBvMTsKICAgICAgICAgICAgT2JqZWN0W10gYTIgPSAoT2Jq\nZWN0W10pIG8yOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGEx\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjbXAgPSAoKENvbXBh\ncmFibGUpIGExW2ldKS5jb21wYXJlVG8oYTJbaV0pOwogICAgICAgICAgICAg\nICAgaWYgKGNtcCAhPSAwKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAo\nX2Rlc2MuZ2V0KGkpKSA/IC1jbXAgOiBjbXA7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcmV0dXJuIGExLmxlbmd0aCAtIGEyLmxlbmd0aDsKICAgICAg\nICB9CiAgICB9Cn0K\n","encoding":"base64"}

