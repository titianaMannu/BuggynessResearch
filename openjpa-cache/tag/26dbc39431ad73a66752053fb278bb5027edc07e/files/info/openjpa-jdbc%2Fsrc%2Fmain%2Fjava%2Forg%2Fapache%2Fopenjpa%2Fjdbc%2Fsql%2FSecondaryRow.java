{"sha":"7195c46003d89877ddd0c754067bfa43dea8de2e","node_id":"MDQ6QmxvYjIwNjM2NDo3MTk1YzQ2MDAzZDg5ODc3ZGRkMGM3NTQwNjdiZmE0M2RlYThkZTJl","size":6603,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7195c46003d89877ddd0c754067bfa43dea8de2e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuU1FMRXhjZXB0aW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5SZWxhdGlvbklkOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW5JTzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5h\nZ2VyOwoKLyoqCiAqIFNlY29uZGFyeSB0YWJsZSByb3cgdGhhdCB0cmFja3Mg\nZm9yZWlnbiBrZXlzIHRvIGF1dG8taW5jIGNvbHVtbnMuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBT\nZWNvbmRhcnlSb3cKICAgIGV4dGVuZHMgUm93SW1wbCB7CgogICAgcHJpdmF0\nZSBPcGVuSlBBU3RhdGVNYW5hZ2VyW10gX2ZrcyA9IG51bGw7CiAgICBwcml2\nYXRlIENvbHVtbklPW10gX2ZrSU8gPSBudWxsOwogICAgcHJpdmF0ZSBPcGVu\nSlBBU3RhdGVNYW5hZ2VyW10gX3JlbHMgPSBudWxsOwogICAgcHJpdmF0ZSBS\nZWxhdGlvbklkW10gX2NhbGxiYWNrcyA9IG51bGw7CgogICAgLyoqCiAgICAg\nKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IHRhYmxlIGFuZCBhY3Rpb24uCiAgICAg\nKi8KICAgIHB1YmxpYyBTZWNvbmRhcnlSb3coVGFibGUgdGFibGUsIGludCBh\nY3Rpb24pIHsKICAgICAgICB0aGlzKHRhYmxlLmdldENvbHVtbnMoKSwgYWN0\naW9uKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgU2Vjb25kYXJ5Um93KENvbHVt\nbltdIGNvbHMsIGludCBhY3Rpb24pIHsKICAgICAgICBzdXBlcihjb2xzLCBh\nY3Rpb24pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEZvcmVpZ25LZXko\nRm9yZWlnbktleSBmaywgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRGb3JlaWduS2V5\nKGZrLCBudWxsLCBzbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Rm9y\nZWlnbktleShGb3JlaWduS2V5IGZrLCBDb2x1bW5JTyBpbywKICAgICAgICBP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmICghZGVsYXlGb3JlaWduS2V5KGZrLCBzbSkp\nIHsKICAgICAgICAgICAgc3VwZXIuc2V0Rm9yZWlnbktleShmaywgaW8sIHNt\nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8g\nZm9yY2UgdmFsaWQKICAgICAgICBpZiAoY2FuU2V0QW55KGlvLCBmay5nZXRD\nb2x1bW5zKCkubGVuZ3RoCiAgICAgICAgICAgICsgZmsuZ2V0Q29uc3RhbnRD\nb2x1bW5zKCkubGVuZ3RoLCBmYWxzZSkpCiAgICAgICAgICAgIHNldFZhbGlk\nKHRydWUpOwoKICAgICAgICAvLyByZWNvcmQgZm9yZWlnIGtleSBmb3IgZGVs\nYXllZCBmbHVzaAogICAgICAgIGlmIChfZmtzID09IG51bGwpCiAgICAgICAg\nICAgIF9ma3MgPSBuZXcgT3BlbkpQQVN0YXRlTWFuYWdlcltnZXRUYWJsZSgp\nLmdldEZvcmVpZ25LZXlzKCkubGVuZ3RoXTsKICAgICAgICBfZmtzW2ZrLmdl\ndEluZGV4KCldID0gc207CgogICAgICAgIGlmIChfZmtJTyAhPSBudWxsKQog\nICAgICAgICAgICBfZmtJT1tmay5nZXRJbmRleCgpXSA9IGlvOwogICAgICAg\nIGVsc2UgaWYgKGlvICE9IG51bGwKICAgICAgICAgICAgJiYgKChnZXRBY3Rp\nb24oKSA9PSBBQ1RJT05fSU5TRVJUCiAgICAgICAgICAgICYmICFpby5pc0Fs\nbEluc2VydGFibGUoZmssIGZhbHNlKSkKICAgICAgICAgICAgfHwgKGdldEFj\ndGlvbigpICE9IEFDVElPTl9JTlNFUlQKICAgICAgICAgICAgJiYgIWlvLmlz\nQWxsVXBkYXRhYmxlKGZrLCBmYWxzZSkpKSkgewogICAgICAgICAgICBfZmtJ\nTyA9IG5ldyBDb2x1bW5JT1tfZmtzLmxlbmd0aF07CiAgICAgICAgICAgIF9m\na0lPW2ZrLmdldEluZGV4KCldID0gaW87CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmVjb3JkIGZvcmVpZ24ga2V5cyB0byBuZXcgYXV0by1p\nbmMgaW5zdGFuY2VzOyBmbHVzaCB0aGVtIG9ubHkgd2hlbgogICAgICogd2Ug\naGF2ZSB0byBnZW5lcmF0ZSBvdXIgU1FMIHRvIGdpdmUgdGhlIGluc3RhbmNl\nIGEgY2hhbmNlIHRvIGZpbmFsaXplCiAgICAgKiBpdHMgdmFsdWVzLgogICAg\nICovCiAgICBwcml2YXRlIGJvb2xlYW4gZGVsYXlGb3JlaWduS2V5KEZvcmVp\nZ25LZXkgZmssIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBy\nZXR1cm4gZmsuaXNQcmltYXJ5S2V5QXV0b0Fzc2lnbmVkKCkgJiYgZ2V0QWN0\naW9uKCkgIT0gQUNUSU9OX0RFTEVURQogICAgICAgICAgICAmJiBzbSAhPSBu\ndWxsICYmIHNtLmlzTmV3KCkgJiYgIXNtLmlzRmx1c2hlZCgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldFJlbGF0aW9uSWQoQ29sdW1uIGNvbCwgT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAgICBSZWxhdGlvbklkIHJlbCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoc20g\nPT0gbnVsbCB8fCBzbS5nZXRPYmplY3RJZCgpICE9IG51bGwgfHwgIXNtLmlz\nTmV3KCkKICAgICAgICAgICAgfHwgc20uaXNGbHVzaGVkKCkgfHwgIWlzUHJp\nbWFyeUtleUF1dG9Bc3NpZ25lZChzbSkpCiAgICAgICAgICAgIHN1cGVyLnNl\ndFJlbGF0aW9uSWQoY29sLCBzbSwgcmVsKTsKICAgICAgICBlbHNlIHsKICAg\nICAgICAgICAgaWYgKF9yZWxzID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIENvbHVtbltdIGNvbHMgPSBnZXRUYWJsZSgpLmdldFJlbGF0aW9uSWRDb2x1\nbW5zKCk7CiAgICAgICAgICAgICAgICBfcmVscyA9IG5ldyBPcGVuSlBBU3Rh\ndGVNYW5hZ2VyW2NvbHMubGVuZ3RoXTsKICAgICAgICAgICAgICAgIF9jYWxs\nYmFja3MgPSBuZXcgUmVsYXRpb25JZFtjb2xzLmxlbmd0aF07CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgaW50IGlkeCA9IGdldFJlbGF0aW9uSWRJbmRl\neChjb2wpOwogICAgICAgICAgICBfcmVsc1tpZHhdID0gc207CiAgICAgICAg\nICAgIF9jYWxsYmFja3NbaWR4XSA9IHJlbDsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IGludG8gb3VyIHJlbGF0\naW9uIGlkIGFycmF5IG9mIHRoZSB2YWx1ZSBmb3IgdGhlCiAgICAgKiBnaXZl\nbiBjb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgaW50IGdldFJlbGF0aW9u\nSWRJbmRleChDb2x1bW4gY29sKSB7CiAgICAgICAgQ29sdW1uW10gY29scyA9\nIGdldFRhYmxlKCkuZ2V0UmVsYXRpb25JZENvbHVtbnMoKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgIGlmIChjb2xzW2ldID09IGNvbCkKICAgICAgICAgICAgICAgIHJldHVy\nbiBpOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0cnVlIGlmIGFueSBwcmltYXJ5IGtleSBjb2x1bW5zIG9mIHRo\nZSBnaXZlbiBpbnN0YW5jZSBhcmUKICAgICAqIGF1dG8tYXNzaWduZWQuCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5\nQXV0b0Fzc2lnbmVkKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAg\nICBDbGFzc01hcHBpbmcgY2xzID0gKENsYXNzTWFwcGluZykgc20uZ2V0TWV0\nYURhdGEoKTsKICAgICAgICB3aGlsZSAoY2xzLmdldEpvaW5hYmxlUENTdXBl\ncmNsYXNzTWFwcGluZygpICE9IG51bGwpCiAgICAgICAgICAgIGNscyA9IGNs\ncy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKTsKICAgICAgICBD\nb2x1bW5bXSBjb2xzID0gY2xzLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBpZiAoY29sc1tpXS5pc0F1dG9Bc3NpZ25lZCgpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2VuZXJhdGVTUUwoREJE\naWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBp\nZiAoX2ZrcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBGb3JlaWduS2V5\nW10gZmtzID0gZ2V0VGFibGUoKS5nZXRGb3JlaWduS2V5cygpOwogICAgICAg\nICAgICAgICAgQ29sdW1uSU8gaW87CiAgICAgICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9ma3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoX2Zrc1tpXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGlvID0gKF9ma0lPID09IG51bGwpID8gbnVsbCA6IF9ma0lP\nW2ldOwogICAgICAgICAgICAgICAgICAgICAgICBzdXBlci5zZXRGb3JlaWdu\nS2V5KGZrc1tpXSwgaW8sIF9ma3NbaV0pOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAoX3JlbHMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgQ29sdW1u\nW10gY29scyA9IGdldFRhYmxlKCkuZ2V0UmVsYXRpb25JZENvbHVtbnMoKTsK\nICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX3JlbHMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgaWYgKF9yZWxzW2ldICE9\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIHN1cGVyLnNldFJlbGF0\naW9uSWQoY29sc1tpXSwgX3JlbHNbaV0sIF9jYWxsYmFja3NbaV0pOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRT\ndG9yZShzZSwgZGljdCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdXBl\nci5nZW5lcmF0ZVNRTChkaWN0KTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgUm93\nSW1wbCBuZXdJbnN0YW5jZShDb2x1bW5bXSBjb2xzLCBpbnQgYWN0aW9uKSB7\nCiAgICAgICAgcmV0dXJuIG5ldyBTZWNvbmRhcnlSb3coY29scywgYWN0aW9u\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb3B5SW50byhSb3dJbXBsIHJv\ndywgYm9vbGVhbiB3aGVyZU9ubHkpIHsKICAgICAgICBzdXBlci5jb3B5SW50\nbyhyb3csIHdoZXJlT25seSk7CiAgICAgICAgaWYgKF9ma3MgPT0gbnVsbCB8\nfCB3aGVyZU9ubHkgfHwgcm93LmdldEFjdGlvbigpID09IEFDVElPTl9ERUxF\nVEUKICAgICAgICAgICAgfHwgIShyb3cgaW5zdGFuY2VvZiBTZWNvbmRhcnlS\nb3cpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIFNlY29uZGFyeVJv\ndyBzcm93ID0gKFNlY29uZGFyeVJvdykgcm93OwogICAgICAgIGlmIChzcm93\nLl9ma3MgPT0gbnVsbCkKICAgICAgICAgICAgc3Jvdy5fZmtzID0gbmV3IE9w\nZW5KUEFTdGF0ZU1hbmFnZXJbX2Zrcy5sZW5ndGhdOwogICAgICAgIFN5c3Rl\nbS5hcnJheWNvcHkoX2ZrcywgMCwgc3Jvdy5fZmtzLCAwLCBfZmtzLmxlbmd0\naCk7CiAgICAgICAgaWYgKF9ma0lPICE9IG51bGwpIHsKICAgICAgICAgICAg\naWYgKHNyb3cuX2ZrSU8gPT0gbnVsbCkKICAgICAgICAgICAgICAgIHNyb3cu\nX2ZrSU8gPSBuZXcgQ29sdW1uSU9bX2ZrSU8ubGVuZ3RoXTsKICAgICAgICAg\nICAgU3lzdGVtLmFycmF5Y29weShfZmtJTywgMCwgc3Jvdy5fZmtJTywgMCwg\nX2ZrSU8ubGVuZ3RoKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

