{"sha":"b9b7a6508b231e246c36ce6b9adfc391dcfdcb88","node_id":"MDQ6QmxvYjIwNjM2NDpiOWI3YTY1MDhiMjMxZTI0NmMzNmNlNmI5YWRmYzM5MWRjZmRjYjg4","size":12202,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b9b7a6508b231e246c36ce6b9adfc391dcfdcb88","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmxvZzsNCg0KaW1wb3J0IGphdmEuaW8uRmlsZTsNCmltcG9ydCBqYXZh\nLmlvLkZpbGVPdXRwdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5JT0V4Y2Vw\ndGlvbjsNCmltcG9ydCBqYXZhLmlvLlByaW50U3RyZWFtOw0KaW1wb3J0IGph\ndmEuaW8uUHJpbnRXcml0ZXI7DQppbXBvcnQgamF2YS5pby5TdHJpbmdXcml0\nZXI7DQppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOw0K\naW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlv\nbjsNCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsNCmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7DQppbXBvcnQgamF2YS51dGlsLkxvY2FsZTsNCmltcG9y\ndCBqYXZhLnV0aWwuTWFwOw0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuR2VuZXJpY0NvbmZpZ3VyYWJsZTsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuRmlsZXM7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVy\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlv\nbnM7DQppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhh\nc2hNYXA7DQoNCi8qKg0KICogRGVmYXVsdCB7QGxpbmsgTG9nRmFjdG9yeX0g\naW1wbGVtZW50YXRpb24uIEZvciBlYXNlIG9mIGF1dG9tYXRpYw0KICogY29u\nZmlndXJhdGlvbiwgdGhpcyBpbXBsZW1lbnRhdGlvbiBrZXlzIG9uIG9ubHkg\ndGhlIGxhc3QgZG90LXNlcGFyYXRlZA0KICogdG9rZW4gb2YgdGhlIGxvZyBj\naGFubmVsIG5hbWUuDQogKg0KICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkN\nCiAqLw0KcHVibGljIGNsYXNzIExvZ0ZhY3RvcnlJbXBsIA0KICAgIGltcGxl\nbWVudHMgTG9nRmFjdG9yeSwgR2VuZXJpY0NvbmZpZ3VyYWJsZSwgQ29uZmln\ndXJhYmxlIHsNCg0KICAgIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UoTG9nRmFjdG9yeUltcGwuY2xhc3Mp\nOw0KICAgIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBfbG9jRW4gPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZSgNCiAgICAgICAgTG9nRmFjdG9yeUltcGwuY2xh\nc3MsIExvY2FsZS5FTkdMSVNIKTsNCg0KICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIFRSQUNFX1NUUiA9IF9sb2NFbi5nZXQoImxvZy10cmFjZSIp\nLmdldE1lc3NhZ2UoKTsNCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBJTkZPX1NUUiA9IF9sb2NFbi5nZXQoImxvZy1pbmZvIikuZ2V0TWVzc2Fn\nZSgpOw0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFdBUk5fU1RS\nID0gX2xvY0VuLmdldCgibG9nLXdhcm4iKS5nZXRNZXNzYWdlKCk7DQogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgRVJST1JfU1RSID0gX2xvY0Vu\nLmdldCgibG9nLWVycm9yIikuZ2V0TWVzc2FnZSgpOw0KICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIEZBVEFMX1NUUiA9IF9sb2NFbi5nZXQoImxv\nZy1mYXRhbCIpLmdldE1lc3NhZ2UoKTsNCg0KICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIFNURE9VVCA9ICJzdGRvdXQiOw0KICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIFNUREVSUiA9ICJzdGRlcnIiOw0KDQogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIE5FV0xJTkUgPSBKMkRvUHJp\ndkhlbHBlci5nZXRMaW5lU2VwYXJhdG9yKCk7DQoNCiAgICAvKioNCiAgICAg\nKiBUaGUgdGltZSBhdCB3aGljaCB0aGlzIGZhY3Rvcnkgd2FzIGluaXRpYWxp\nemVkLg0KICAgICAqLw0KICAgIHByb3RlY3RlZCBmaW5hbCBsb25nIGluaXRp\nYWxpemF0aW9uTWlsbGlzOw0KDQogICAgLyoqDQogICAgICogVGhlIHtAbGlu\nayBMb2d9cyB0aGF0IHRoaXMgZmFjdG9yeSBtYW5hZ2VzLCBrZXllZCBieSBs\nb2cgY2hhbm5lbCBuYW1lLg0KICAgICAqLw0KICAgIHByaXZhdGUgTWFwIF9s\nb2dzID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwKCk7IC8vIDxTdHJpbmcsTG9n\nPg0KDQogICAgLyoqDQogICAgICogVGhlIGRlZmF1bHQgbG9nZ2luZyBsZXZl\nbC4NCiAgICAgKi8NCiAgICBwcml2YXRlIHNob3J0IF9kZWZhdWx0TG9nTGV2\nZWwgPSBMb2cuSU5GTzsNCg0KICAgIC8qKg0KICAgICAqIFN0b3JhZ2UgZm9y\nIGxvZ2dpbmcgbGV2ZWwgY29uZmlndXJhdGlvbiBzcGVjaWZpZWQgYXQgY29u\nZmlndXJhdGlvbiB0aW1lLg0KICAgICAqLw0KICAgIHByaXZhdGUgTWFwIF9j\nb25maWd1cmVkTGV2ZWxzID0gbmV3IEhhc2hNYXAoKTsgLy8gPFN0cmluZyxJ\nbnRlZ2VyPg0KDQogICAgLyoqDQogICAgICogVGhlIHN0cmVhbSB0byB3cml0\nZSB0by4gRGVmYXVsdHMgdG8gU3lzdGVtLmVyci4NCiAgICAgKi8NCiAgICBw\ncml2YXRlIFByaW50U3RyZWFtIF9vdXQgPSBTeXN0ZW0uZXJyOw0KDQogICAg\nLyoqDQogICAgICogQSB0b2tlbiB0byBhZGQgdG8gYWxsIGxvZyBtZXNzYWdl\ncy4gSWYgPGNvZGU+bnVsbDwvY29kZT4sIHRoZSANCiAgICAgKiBjb25maWd1\ncmF0aW9uJ3MgaWQgd2lsbCBiZSB1c2VkLg0KICAgICAqLw0KICAgIHByaXZh\ndGUgU3RyaW5nIF9kaWFnQ29udGV4dCA9IG51bGw7DQogICAgcHJpdmF0ZSBi\nb29sZWFuIF9kaWFnQ29udGV4dENvbXB1dGVkID0gZmFsc2U7DQogICAgDQog\nICAgcHJpdmF0ZSBDb25maWd1cmF0aW9uIF9jb25mOw0KDQoNCiAgICBwdWJs\naWMgTG9nRmFjdG9yeUltcGwoKSB7DQogICAgICAgIGluaXRpYWxpemF0aW9u\nTWlsbGlzID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7DQogICAgfQ0K\nDQogICAgcHVibGljIExvZyBnZXRMb2coU3RyaW5nIGNoYW5uZWwpIHsNCiAg\nICAgICAgLy8gbm8gbG9ja2luZzsgb2sgaWYgc2FtZSBsb2cgY3JlYXRlZCBt\ndWx0aXBsZSB0aW1lcw0KICAgICAgICBMb2dJbXBsIGwgPSAoTG9nSW1wbCkg\nX2xvZ3MuZ2V0KGNoYW5uZWwpOw0KICAgICAgICBpZiAobCA9PSBudWxsKSB7\nDQogICAgICAgICAgICBsID0gbmV3TG9nSW1wbCgpOw0KICAgICAgICAgICAg\nbC5zZXRDaGFubmVsKGNoYW5uZWwpOw0KICAgICAgICAgICAgU2hvcnQgbHZs\nID0gKFNob3J0KSBfY29uZmlndXJlZExldmVscy5nZXQoc2hvcnRlbihjaGFu\nbmVsKSk7DQogICAgICAgICAgICBsLnNldExldmVsKGx2bCA9PSBudWxsID8g\nX2RlZmF1bHRMb2dMZXZlbCA6IGx2bC5zaG9ydFZhbHVlKCkpOw0KICAgICAg\nICAgICAgX2xvZ3MucHV0KGNoYW5uZWwsIGwpOw0KICAgICAgICB9DQogICAg\nICAgIHJldHVybiBsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIENyZWF0\nZSBhIG5ldyBsb2cuIFRoZSBsb2cgd2lsbCBiZSBjYWNoZWQuDQogICAgICov\nDQogICAgcHJvdGVjdGVkIExvZ0ltcGwgbmV3TG9nSW1wbCgpIHsNCiAgICAg\nICAgcmV0dXJuIG5ldyBMb2dJbXBsKCk7DQogICAgfQ0KDQogICAgLyoqDQog\nICAgICogVGhlIHN0cmluZyBuYW1lIG9mIHRoZSBkZWZhdWx0IGxldmVsIGZv\nciB1bmNvbmZpZ3VyZWQgbG9nIGNoYW5uZWxzOw0KICAgICAqIHVzZWQgZm9y\nIGF1dG9tYXRpYyBjb25maWd1cmF0aW9uLg0KICAgICAqLw0KICAgIHB1Ymxp\nYyB2b2lkIHNldERlZmF1bHRMZXZlbChTdHJpbmcgbGV2ZWwpIHsNCiAgICAg\nICAgX2RlZmF1bHRMb2dMZXZlbCA9IGdldExldmVsKGxldmVsKTsNCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBUaGUgZGVmYXVsdCBsZXZlbCBmb3IgdW5j\nb25maWd1cmVkIGxvZyBjaGFubmVscy4NCiAgICAgKi8NCiAgICBwdWJsaWMg\nc2hvcnQgZ2V0RGVmYXVsdExldmVsKCkgew0KICAgICAgICByZXR1cm4gX2Rl\nZmF1bHRMb2dMZXZlbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUaGUg\nZGVmYXVsdCBsZXZlbCBmb3IgdW5jb25maWd1cmVkIGxvZyBjaGFubmVscy4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXREZWZhdWx0TGV2ZWwoc2hv\ncnQgbGV2ZWwpIHsNCiAgICAgICAgX2RlZmF1bHRMb2dMZXZlbCA9IGxldmVs\nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEEgc3RyaW5nIHRvIHByZWZp\neCBhbGwgbG9nIG1lc3NhZ2VzIHdpdGguIFNldCB0bw0KICAgICAqIDxjb2Rl\nPm51bGw8L2NvZGU+IHRvIHVzZSB0aGUgY29uZmlndXJhdGlvbidzIElkIHBy\nb3BlcnR5IHNldHRpbmcuDQogICAgICovDQogICAgcHVibGljIHZvaWQgc2V0\nRGlhZ25vc3RpY0NvbnRleHQoU3RyaW5nIHZhbCkgew0KICAgICAgICBfZGlh\nZ0NvbnRleHQgPSB2YWw7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQSBz\ndHJpbmcgdG8gcHJlZml4IGFsbCBsb2cgbWVzc2FnZXMgd2l0aC4gU2V0IHRv\nDQogICAgICogPGNvZGU+bnVsbDwvY29kZT4gdG8gdXNlIHRoZSBjb25maWd1\ncmF0aW9uJ3MgSWQgcHJvcGVydHkgc2V0dGluZy4NCiAgICAgKi8NCiAgICBw\ndWJsaWMgU3RyaW5nIGdldERpYWdub3N0aWNDb250ZXh0KCkgew0KICAgICAg\nICBpZiAoIV9kaWFnQ29udGV4dENvbXB1dGVkKSB7DQogICAgICAgICAgICAv\nLyB0aGlzIGluaXRpYWxpemF0aW9uIGhhcyB0byBoYXBwZW4gbGF6aWx5IGJl\nY2F1c2UgdGhlcmUgaXMgbm8NCiAgICAgICAgICAgIC8vIGd1YXJhbnRlZSB0\naGF0IGNvbmYuZ2V0SWQoKSB3aWxsIGJlIHBvcHVsYXRlZCBieSB0aGUgdGlt\nZSB0aGF0DQogICAgICAgICAgICAvLyBlbmRDb25maWd1cmF0aW9uKCkgaXMg\nY2FsbGVkLg0KICAgICAgICAgICAgaWYgKF9kaWFnQ29udGV4dCA9PSBudWxs\nICYmIF9jb25mICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBfZGlhZ0Nv\nbnRleHQgPSBfY29uZi5nZXRJZCgpOw0KICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgaWYgKCIiLmVxdWFscyhfZGlhZ0NvbnRleHQpKQ0KICAgICAgICAg\nICAgICAgIF9kaWFnQ29udGV4dCA9IG51bGw7DQogICAgICAgICAgICBfZGlh\nZ0NvbnRleHRDb21wdXRlZCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgICAg\ncmV0dXJuIF9kaWFnQ29udGV4dDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAg\nKiBUaGUgc3RyZWFtIHRvIHdyaXRlIHRvLiBSZWNvZ25pemVkIHZhbHVlcyBh\ncmU6IDxjb2RlPnN0ZG91dDwvY29kZT4NCiAgICAgKiBhbmQgPGNvZGU+c3Rk\nZXJyPC9jb2RlPi4gQW55IG90aGVyIHZhbHVlIHdpbGwgYmUgY29uc2lkZXJl\nZCBhIGZpbGUgbmFtZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXRG\naWxlKFN0cmluZyBmaWxlKSB7DQogICAgICAgIGlmIChTVERPVVQuZXF1YWxz\nKGZpbGUpKQ0KICAgICAgICAgICAgX291dCA9IFN5c3RlbS5vdXQ7DQogICAg\nICAgIGVsc2UgaWYgKFNUREVSUi5lcXVhbHMoZmlsZSkpDQogICAgICAgICAg\nICBfb3V0ID0gU3lzdGVtLmVycjsNCiAgICAgICAgZWxzZSB7DQogICAgICAg\nICAgICBGaWxlIGYgPSBGaWxlcy5nZXRGaWxlKGZpbGUsIG51bGwpOw0KICAg\nICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBfb3V0ID0gbmV3IFBy\naW50U3RyZWFtKChGaWxlT3V0cHV0U3RyZWFtKQ0KICAgICAgICAgICAgICAg\nICAgICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgNCiAgICAgICAg\nICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0ZpbGVPdXRwdXRT\ndHJlYW1BY3Rpb24oDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKFN0\ncmluZykgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoDQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldENh\nbm9uaWNhbFBhdGhBY3Rpb24oZikpLA0KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHRydWUpKSk7DQogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxl\nZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgew0KICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImxv\nZy1iYWQtZmlsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBmaWxlKSAr\nICIgIiArIHBhZS5nZXRFeGNlcHRpb24oKSk7DQogICAgICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsNCiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJsb2ct\nYmFkLWZpbGUiLA0KICAgICAgICAgICAgICAgICAgICBmaWxlKSArICIgIiAr\nIGlvZS50b1N0cmluZygpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBzdHJlYW0gdG8gd3JpdGUg\ndG8uDQogICAgICovDQogICAgcHVibGljIFByaW50U3RyZWFtIGdldFN0cmVh\nbSgpIHsNCiAgICAgICAgcmV0dXJuIF9vdXQ7DQogICAgfQ0KDQogICAgLyoq\nDQogICAgICogVGhlIHN0cmVhbSB0byB3cml0ZSB0by4NCiAgICAgKi8NCiAg\nICBwdWJsaWMgdm9pZCBzZXRTdHJlYW0oUHJpbnRTdHJlYW0gc3RyZWFtKSB7\nDQogICAgICAgIGlmIChzdHJlYW0gPT0gbnVsbCkNCiAgICAgICAgICAgIHRo\ncm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigic3RyZWFtID09IG51bGwi\nKTsNCiAgICAgICAgX291dCA9IHN0cmVhbTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRo\nZSBzcGVjaWZpZWQgbG9nIGxldmVsIGNvbnN0YW50Lg0KICAgICAqLw0KICAg\nIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGdldExldmVsTmFtZShzaG9ydCBsZXZl\nbCkgew0KICAgICAgICBzd2l0Y2ggKGxldmVsKSB7DQogICAgICAgICAgICBj\nYXNlIExvZy5UUkFDRToNCiAgICAgICAgICAgICAgICByZXR1cm4gVFJBQ0Vf\nU1RSOw0KICAgICAgICAgICAgY2FzZSBMb2cuSU5GTzoNCiAgICAgICAgICAg\nICAgICByZXR1cm4gSU5GT19TVFI7DQogICAgICAgICAgICBjYXNlIExvZy5X\nQVJOOg0KICAgICAgICAgICAgICAgIHJldHVybiBXQVJOX1NUUjsNCiAgICAg\nICAgICAgIGNhc2UgTG9nLkVSUk9SOg0KICAgICAgICAgICAgICAgIHJldHVy\nbiBFUlJPUl9TVFI7DQogICAgICAgICAgICBjYXNlIExvZy5GQVRBTDoNCiAg\nICAgICAgICAgICAgICByZXR1cm4gRkFUQUxfU1RSOw0KICAgICAgICAgICAg\nZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXR1cm4gX2xvY0VuLmdldCgi\nbG9nLXVua25vd24iKS5nZXRNZXNzYWdlKCk7DQogICAgICAgIH0NCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIGEgc3ltYm9saWMgY29uc3Rh\nbnQgZm9yIHRoZSBzcGVjaWZpZWQgc3RyaW5nIGxldmVsLg0KICAgICAqLw0K\nICAgIHB1YmxpYyBzdGF0aWMgc2hvcnQgZ2V0TGV2ZWwoU3RyaW5nIHN0cikg\new0KICAgICAgICBzdHIgPSBzdHIudG9VcHBlckNhc2UoTG9jYWxlLkVOR0xJ\nU0gpLnRyaW0oKTsNCiAgICAgICAgc2hvcnQgdmFsID0gVFJBQ0VfU1RSLmVx\ndWFscyhzdHIpID8gTG9nLlRSQUNFIDoNCiAgICAgICAgICAgIElORk9fU1RS\nLmVxdWFscyhzdHIpID8gTG9nLklORk8gOg0KICAgICAgICAgICAgICAgIFdB\nUk5fU1RSLmVxdWFscyhzdHIpID8gTG9nLldBUk4gOg0KICAgICAgICAgICAg\nICAgICAgICBFUlJPUl9TVFIuZXF1YWxzKHN0cikgPyBMb2cuRVJST1IgOg0K\nICAgICAgICAgICAgICAgICAgICAgICAgRkFUQUxfU1RSLmVxdWFscyhzdHIp\nID8gTG9nLkZBVEFMIDogLTE7DQoNCiAgICAgICAgaWYgKHZhbCA9PSAtMSkN\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRp\nb24NCiAgICAgICAgICAgICAgICAoX2xvYy5nZXQoImxvZy1iYWQtY29uc3Rh\nbnQiLCBzdHIpLmdldE1lc3NhZ2UoKSk7DQoNCiAgICAgICAgcmV0dXJuIHZh\nbDsNCiAgICB9DQoNCiAgICAvLyAtLS0tLS0tLS0tIENvbmZpZ3VyYWJsZSBp\nbXBsZW1lbnRhdGlvbiAtLS0tLS0tLS0tDQogICAgDQogICAgcHVibGljIHZv\naWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYpIHsNCiAg\nICAgICAgX2NvbmYgPSBjb25mOw0KICAgIH0NCiAgICANCiAgICBwdWJsaWMg\ndm9pZCBzdGFydENvbmZpZ3VyYXRpb24oKSB7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsNCiAgICB9DQoNCiAgICAv\nLyAtLS0tLS0tLS0tIEdlbmVyaWNDb25maWd1cmFibGUgaW1wbGVtZW50YXRp\nb24gLS0tLS0tLS0tLQ0KDQogICAgcHVibGljIHZvaWQgc2V0SW50byhPcHRp\nb25zIG9wdHMpIHsNCiAgICAgICAgaWYgKCFvcHRzLmlzRW1wdHkoKSkgew0K\nICAgICAgICAgICAgTWFwLkVudHJ5IGU7DQogICAgICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ZXIgPSBvcHRzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRl\nci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICAgICAgZSA9IChNYXAuRW50\ncnkpIGl0ZXIubmV4dCgpOw0KICAgICAgICAgICAgICAgIF9jb25maWd1cmVk\nTGV2ZWxzLnB1dChzaG9ydGVuKChTdHJpbmcpIGUuZ2V0S2V5KCkpLA0KICAg\nICAgICAgICAgICAgICAgICBuZXcgU2hvcnQoZ2V0TGV2ZWwoKFN0cmluZykg\nZS5nZXRWYWx1ZSgpKSkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAg\nb3B0cy5jbGVhcigpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHJpdmF0\nZSBzdGF0aWMgU3RyaW5nIHNob3J0ZW4oU3RyaW5nIGNoYW5uZWwpIHsNCiAg\nICAgICAgcmV0dXJuIGNoYW5uZWwuc3Vic3RyaW5nKGNoYW5uZWwubGFzdElu\nZGV4T2YoJy4nKSArIDEpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEEg\nc2ltcGxlIGltcGxlbWVudGF0aW9uIG9mIHRoZSB7QGxpbmsgTG9nfSBpbnRl\ncmZhY2UuIFdyaXRlcw0KICAgICAqIG91dHB1dCB0byBzdGRlcnIuDQogICAg\nICovDQogICAgcHVibGljIGNsYXNzIExvZ0ltcGwgZXh0ZW5kcyBBYnN0cmFj\ndExvZyB7DQoNCiAgICAgICAgcHJpdmF0ZSBzaG9ydCBfbGV2ZWwgPSBJTkZP\nOw0KICAgICAgICBwcml2YXRlIFN0cmluZyBfY2hhbm5lbDsNCg0KICAgICAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0VuYWJsZWQoc2hvcnQgbGV2ZWwpIHsN\nCiAgICAgICAgICAgIHJldHVybiBsZXZlbCA+PSBfbGV2ZWw7DQogICAgICAg\nIH0NCg0KICAgICAgICBwcm90ZWN0ZWQgdm9pZCBsb2coc2hvcnQgbGV2ZWws\nIFN0cmluZyBtZXNzYWdlLCBUaHJvd2FibGUgdCkgew0KICAgICAgICAgICAg\nU3RyaW5nIG1zZyA9IGZvcm1hdE1lc3NhZ2UobGV2ZWwsIG1lc3NhZ2UsIHQp\nOw0KICAgICAgICAgICAgc3luY2hyb25pemVkIChfb3V0KSB7DQogICAgICAg\nICAgICAgICAgX291dC5wcmludChtc2cpOw0KICAgICAgICAgICAgfQ0KICAg\nICAgICB9DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIENvbnZlcnQgPGNv\nZGU+bWVzc2FnZTwvY29kZT4gaW50byBhIHN0cmluZyByZWFkeSB0byBiZSB3\ncml0dGVuIHRvDQogICAgICAgICAqIHRoZSBsb2cuIFRoZSBzdHJpbmcgc2hv\ndWxkIGluY2x1ZGUgdGhlIHRlcm1pbmF0aW5nIG5ld2xpbmUuDQogICAgICAg\nICAqDQogICAgICAgICAqIEBwYXJhbSB0IG1heSBiZSBudWxsDQogICAgICAg\nICAqLw0KICAgICAgICBwcm90ZWN0ZWQgU3RyaW5nIGZvcm1hdE1lc3NhZ2Uo\nc2hvcnQgbGV2ZWwsIFN0cmluZyBtZXNzYWdlLA0KICAgICAgICAgICAgVGhy\nb3dhYmxlIHQpIHsNCiAgICAgICAgICAgIC8vIHdlIHdyaXRlIHRvIGEgU3Ry\naW5nQnVmZmVyIGFuZCB0aGVuIGZsdXNoIGl0IGFsbCBhdA0KICAgICAgICAg\nICAgLy8gb25jZSBhcyBhIHNpbmdsZSBsaW5lLCBzaW5jZSBzb21lIGVudmly\nb25tZW50cyhlLmcuLCBKQm9zcykNCiAgICAgICAgICAgIC8vIG92ZXJyaWRl\nIHRoZSBTeXN0ZW0gb3V0cHV0IHN0cmVhbSB0byBmbHVzaCBhbnkgY2FsbHMN\nCiAgICAgICAgICAgIC8vIHRvIHdyaXRlIHdpdGhvdXQgcmVnYXJkIHRvIGxp\nbmUgYnJlYWtzLCBtYWtpbmcgdGhlDQogICAgICAgICAgICAvLyBvdXRwdXQg\naW5jb21wcmVoZW5zaWJlLg0KICAgICAgICAgICAgU3RyaW5nQnVmZmVyIGJ1\nZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsNCg0KICAgICAgICAgICAgYnVmLmFw\ncGVuZChnZXRPZmZzZXQoKSk7DQogICAgICAgICAgICBidWYuYXBwZW5kKCIg\nICIpOw0KICAgICAgICAgICAgaWYgKGdldERpYWdub3N0aWNDb250ZXh0KCkg\nIT0gbnVsbCkNCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGdldERpYWdu\nb3N0aWNDb250ZXh0KCkpLmFwcGVuZCgiICAiKTsNCiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoZ2V0TGV2ZWxOYW1lKGxldmVsKSk7DQogICAgICAgICAgICBp\nZiAobGV2ZWwgPT0gSU5GTyB8fCBsZXZlbCA9PSBXQVJOKQ0KICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsNCiAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiAgWyIpOw0KICAgICAgICAgICAgYnVmLmFwcGVuZChUaHJlYWQuY3Vy\ncmVudFRocmVhZCgpLmdldE5hbWUoKSk7DQogICAgICAgICAgICBidWYuYXBw\nZW5kKCJdICIpOw0KICAgICAgICAgICAgYnVmLmFwcGVuZChfY2hhbm5lbCk7\nDQogICAgICAgICAgICBidWYuYXBwZW5kKCIgLSAiKTsNCiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQobWVzc2FnZSk7DQogICAgICAgICAgICBidWYuYXBwZW5k\nKE5FV0xJTkUpOw0KDQogICAgICAgICAgICBpZiAodCAhPSBudWxsKSB7DQog\nICAgICAgICAgICAgICAgU3RyaW5nV3JpdGVyIHN3cml0ZXIgPSBuZXcgU3Ry\naW5nV3JpdGVyKCk7DQogICAgICAgICAgICAgICAgUHJpbnRXcml0ZXIgcHdy\naXRlciA9IG5ldyBQcmludFdyaXRlcihzd3JpdGVyKTsNCiAgICAgICAgICAg\nICAgICB0LnByaW50U3RhY2tUcmFjZShwd3JpdGVyKTsNCiAgICAgICAgICAg\nICAgICBwd3JpdGVyLmZsdXNoKCk7DQogICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZChzd3JpdGVyLnRvU3RyaW5nKCkpOw0KICAgICAgICAgICAgfQ0KICAg\nICAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOw0KICAgICAgICB9DQoN\nCiAgICAgICAgcHJpdmF0ZSBsb25nIGdldE9mZnNldCgpIHsNCiAgICAgICAg\nICAgIHJldHVybiBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAtIGluaXRp\nYWxpemF0aW9uTWlsbGlzOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGlj\nIHZvaWQgc2V0Q2hhbm5lbChTdHJpbmcgdmFsKSB7DQogICAgICAgICAgICBf\nY2hhbm5lbCA9IHZhbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0Q2hhbm5lbCgpIHsNCiAgICAgICAgICAgIHJldHVybiBfY2hh\nbm5lbDsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIHNldExl\ndmVsKHNob3J0IHZhbCkgew0KICAgICAgICAgICAgX2xldmVsID0gdmFsOw0K\nICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHNob3J0IGdldExldmVsKCkg\new0KICAgICAgICAgICAgcmV0dXJuIF9sZXZlbDsNCiAgICAgICAgfQ0KICAg\nIH0NCn0NCg==\n","encoding":"base64"}

