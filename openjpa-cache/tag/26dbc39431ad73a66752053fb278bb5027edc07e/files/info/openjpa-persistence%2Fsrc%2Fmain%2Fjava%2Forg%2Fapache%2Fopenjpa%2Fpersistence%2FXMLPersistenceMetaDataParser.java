{"sha":"3c5a083734684de4f07c0110ca76bc1f199e0c48","node_id":"MDQ6QmxvYjIwNjM2NDozYzVhMDgzNzM0Njg0ZGU0ZjA3YzAxMTBjYTc2YmMxZjE5OWUwYzQ4","size":56555,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3c5a083734684de4f07c0110ca76bc1f199e0c48","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7Cmlt\ncG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuU3RhY2s7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5DYXNjYWRlVHlwZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkdlbmVyYXRpb25UeXBlOwppbXBvcnQgc3RhdGlj\nIGphdmF4LnBlcnNpc3RlbmNlLkNhc2NhZGVUeXBlLio7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\neG1sLnNheC5BdHRyaWJ1dGVzOwppbXBvcnQgb3JnLnhtbC5zYXguTG9jYXRv\ncjsKaW1wb3J0IG9yZy54bWwuc2F4LlNBWEV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUGVyc2lzdGVuY2VD\nYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LkJlYW5M\naWZlY3ljbGVDYWxsYmFja3M7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZXZlbnQuTGlmZWN5Y2xlQ2FsbGJhY2tzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmV2ZW50LkxpZmVjeWNsZUV2ZW50OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmV2ZW50Lk1ldGhvZExpZmVjeWNsZUNhbGxiYWNrczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlMYW5ndWFnZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmpwcWwuSlBRTFBh\ncnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25m\naWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9n\nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DRk1l\ndGFEYXRhUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5EZWxlZ2F0aW5nTWV0YURhdGFGYWN0b3J5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkxpZmVjeWNsZU1ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFEZWZhdWx0czsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhRmFjdG9yeTsK\naW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0\nYU1vZGVzLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRh\nRGF0YVJlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5PcmRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlF1ZXJ5\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5TZXF1\nZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nVmFsdWVNZXRhRGF0YTsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UuTWV0YURhdGFUYWcuKjsKaW1wb3J0IHN0YXRpYyBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2VTdHJh\ndGVneS4qOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW1wbEhl\nbHBlcjsKCmltcG9ydCBzZXJwLnV0aWwuTnVtYmVyczsKCi8qKgogKiBDdXN0\nb20gU0FYIHBhcnNlciB1c2VkIGJ5IHRoZSBzeXN0ZW0gdG8gcXVpY2tseSBw\nYXJzZSBwZXJzaXN0ZW5jZSBpCiAqIG1ldGFkYXRhIGZpbGVzLgogKgogKiBA\nYXV0aG9yIFN0ZXZlIEtpbQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xh\nc3MgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlcgogICAgZXh0ZW5kcyBD\nRk1ldGFEYXRhUGFyc2VyCiAgICBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlTWV0\nYURhdGFGYWN0b3J5LlBhcnNlciB7CgogICAgLy8gcGFyc2UgY29uc3RhbnRz\nCiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX1BLRyA9\nICJwYWNrYWdlIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5n\nIEVMRU1fQUNDRVNTID0gImFjY2VzcyI7CiAgICBwcm90ZWN0ZWQgc3RhdGlj\nIGZpbmFsIFN0cmluZyBFTEVNX0FUVFJTID0gImF0dHJpYnV0ZXMiOwogICAg\ncHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9MSVNURU5FUiA9\nICJlbnRpdHktbGlzdGVuZXIiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgRUxFTV9DQVNDQURFID0gImNhc2NhZGUiOwogICAgcHJvdGVj\ndGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX0FMTCA9ICJj\nYXNjYWRlLWFsbCI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmlu\nZyBFTEVNX0NBU0NBREVfUEVSID0gImNhc2NhZGUtcGVyc2lzdCI7CiAgICBw\ncm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0NBU0NBREVfTUVS\nID0gImNhc2NhZGUtbWVyZ2UiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgRUxFTV9DQVNDQURFX1JFTSA9ICJjYXNjYWRlLXJlbW92ZSI7\nCiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0NBU0NB\nREVfUkVGID0gImNhc2NhZGUtcmVmcmVzaCI7CiAgICBwcm90ZWN0ZWQgc3Rh\ndGljIGZpbmFsIFN0cmluZyBFTEVNX1BVX01FVEEgPSAicGVyc2lzdGVuY2Ut\ndW5pdC1tZXRhZGF0YSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0\ncmluZyBFTEVNX1BVX0RFRiA9ICJwZXJzaXN0ZW5jZS11bml0LWRlZmF1bHRz\nIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fWE1M\nX01BUF9NRVRBX0NPTVBMRVRFID0KICAgICAgICAieG1sLW1hcHBpbmctbWV0\nYWRhdGEtY29tcGxldGUiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE1h\ncDxTdHJpbmcsIE9iamVjdD4gX2VsZW1zID0KICAgICAgICBuZXcgSGFzaE1h\ncDxTdHJpbmcsIE9iamVjdD4oKTsKCiAgICBzdGF0aWMgewogICAgICAgIF9l\nbGVtcy5wdXQoRUxFTV9QS0csIEVMRU1fUEtHKTsKICAgICAgICBfZWxlbXMu\ncHV0KEVMRU1fQUNDRVNTLCBFTEVNX0FDQ0VTUyk7CiAgICAgICAgX2VsZW1z\nLnB1dChFTEVNX0FUVFJTLCBFTEVNX0FUVFJTKTsKICAgICAgICBfZWxlbXMu\ncHV0KEVMRU1fTElTVEVORVIsIEVMRU1fTElTVEVORVIpOwogICAgICAgIF9l\nbGVtcy5wdXQoRUxFTV9DQVNDQURFLCBFTEVNX0NBU0NBREUpOwogICAgICAg\nIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX0FMTCwgRUxFTV9DQVNDQURFX0FM\nTCk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0NBU0NBREVfUEVSLCBFTEVN\nX0NBU0NBREVfUEVSKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FE\nRV9SRU0sIEVMRU1fQ0FTQ0FERV9SRU0pOwogICAgICAgIF9lbGVtcy5wdXQo\nRUxFTV9DQVNDQURFX01FUiwgRUxFTV9DQVNDQURFX01FUik7CiAgICAgICAg\nX2VsZW1zLnB1dChFTEVNX0NBU0NBREVfUkVGLCBFTEVNX0NBU0NBREVfUkVG\nKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fUFVfTUVUQSwgRUxFTV9QVV9N\nRVRBKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fUFVfREVGLCBFTEVNX1BV\nX0RFRik7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX1hNTF9NQVBfTUVUQV9D\nT01QTEVURSwgRUxFTV9YTUxfTUFQX01FVEFfQ09NUExFVEUpOwoKICAgICAg\nICBfZWxlbXMucHV0KCJlbnRpdHktbGlzdGVuZXJzIiwgRU5USVRZX0xJU1RF\nTkVSUyk7CiAgICAgICAgX2VsZW1zLnB1dCgicHJlLXBlcnNpc3QiLCBQUkVf\nUEVSU0lTVCk7CiAgICAgICAgX2VsZW1zLnB1dCgicG9zdC1wZXJzaXN0Iiwg\nUE9TVF9QRVJTSVNUKTsKICAgICAgICBfZWxlbXMucHV0KCJwcmUtcmVtb3Zl\nIiwgUFJFX1JFTU9WRSk7CiAgICAgICAgX2VsZW1zLnB1dCgicG9zdC1yZW1v\ndmUiLCBQT1NUX1JFTU9WRSk7CiAgICAgICAgX2VsZW1zLnB1dCgicHJlLXVw\nZGF0ZSIsIFBSRV9VUERBVEUpOwogICAgICAgIF9lbGVtcy5wdXQoInBvc3Qt\ndXBkYXRlIiwgUE9TVF9VUERBVEUpOwogICAgICAgIF9lbGVtcy5wdXQoInBv\nc3QtbG9hZCIsIFBPU1RfTE9BRCk7CiAgICAgICAgX2VsZW1zLnB1dCgiZXhj\nbHVkZS1kZWZhdWx0LWxpc3RlbmVycyIsIEVYQ0xVREVfREVGQVVMVF9MSVNU\nRU5FUlMpOwogICAgICAgIF9lbGVtcy5wdXQoImV4Y2x1ZGUtc3VwZXJjbGFz\ncy1saXN0ZW5lcnMiLAogICAgICAgICAgICBFWENMVURFX1NVUEVSQ0xBU1Nf\nTElTVEVORVJTKTsKCiAgICAgICAgX2VsZW1zLnB1dCgibmFtZWQtcXVlcnki\nLCBRVUVSWSk7CiAgICAgICAgX2VsZW1zLnB1dCgibmFtZWQtbmF0aXZlLXF1\nZXJ5IiwgTkFUSVZFX1FVRVJZKTsKICAgICAgICBfZWxlbXMucHV0KCJxdWVy\neS1oaW50IiwgUVVFUllfSElOVCk7CiAgICAgICAgX2VsZW1zLnB1dCgicXVl\ncnkiLCBRVUVSWV9TVFJJTkcpOwoKICAgICAgICBfZWxlbXMucHV0KCJmbHVz\naC1tb2RlIiwgRkxVU0hfTU9ERSk7CiAgICAgICAgX2VsZW1zLnB1dCgic2Vx\ndWVuY2UtZ2VuZXJhdG9yIiwgU0VRX0dFTkVSQVRPUik7CgogICAgICAgIF9l\nbGVtcy5wdXQoImlkIiwgSUQpOwogICAgICAgIF9lbGVtcy5wdXQoImlkLWNs\nYXNzIiwgSURfQ0xBU1MpOwogICAgICAgIF9lbGVtcy5wdXQoImVtYmVkZGVk\nLWlkIiwgRU1CRURERURfSUQpOwogICAgICAgIF9lbGVtcy5wdXQoInZlcnNp\nb24iLCBWRVJTSU9OKTsKICAgICAgICBfZWxlbXMucHV0KCJnZW5lcmF0ZWQt\ndmFsdWUiLCBHRU5FUkFURURfVkFMVUUpOwogICAgICAgIF9lbGVtcy5wdXQo\nIm1hcC1rZXkiLCBNQVBfS0VZKTsKICAgICAgICBfZWxlbXMucHV0KCJvcmRl\nci1ieSIsIE9SREVSX0JZKTsKICAgICAgICBfZWxlbXMucHV0KCJsb2IiLCBM\nT0IpOwoKICAgICAgICBfZWxlbXMucHV0KCJiYXNpYyIsIEJBU0lDKTsKICAg\nICAgICBfZWxlbXMucHV0KCJtYW55LXRvLW9uZSIsIE1BTllfT05FKTsKICAg\nICAgICBfZWxlbXMucHV0KCJvbmUtdG8tb25lIiwgT05FX09ORSk7CiAgICAg\nICAgX2VsZW1zLnB1dCgiZW1iZWRkZWQiLCBFTUJFRERFRCk7CiAgICAgICAg\nX2VsZW1zLnB1dCgib25lLXRvLW1hbnkiLCBPTkVfTUFOWSk7CiAgICAgICAg\nX2VsZW1zLnB1dCgibWFueS10by1tYW55IiwgTUFOWV9NQU5ZKTsKICAgICAg\nICBfZWxlbXMucHV0KCJ0cmFuc2llbnQiLCBUUkFOU0lFTlQpOwogICAgfQoK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9j\nYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoWE1MUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlci5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBPcGVuSlBB\nQ29uZmlndXJhdGlvbiBfY29uZjsKICAgIHByaXZhdGUgTWV0YURhdGFSZXBv\nc2l0b3J5IF9yZXBvcyA9IG51bGw7CiAgICBwcml2YXRlIEFubm90YXRpb25Q\nZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIF9wYXJzZXIgPSBudWxsOwogICAg\ncHJpdmF0ZSBDbGFzc0xvYWRlciBfZW52TG9hZGVyID0gbnVsbDsKICAgIHBy\naXZhdGUgaW50IF9tb2RlID0gTU9ERV9OT05FOwogICAgcHJpdmF0ZSBib29s\nZWFuIF9vdmVycmlkZSA9IGZhbHNlOwoKICAgIHByaXZhdGUgZmluYWwgU3Rh\nY2sgX2VsZW1lbnRzID0gbmV3IFN0YWNrKCk7CiAgICBwcml2YXRlIGZpbmFs\nIFN0YWNrIF9wYXJlbnRzID0gbmV3IFN0YWNrKCk7CgogICAgcHJpdmF0ZSBD\nbGFzcyBfY2xzID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9maWVsZFBvcyA9\nIDA7CiAgICBwcml2YXRlIGludCBfY2xzUG9zID0gMDsKICAgIHByaXZhdGUg\naW50IF9hY2Nlc3MgPSBDbGFzc01ldGFEYXRhLkFDQ0VTU19VTktOT1dOOwog\nICAgcHJpdmF0ZSBQZXJzaXN0ZW5jZVN0cmF0ZWd5IF9zdHJhdGVneSA9IG51\nbGw7CiAgICBwcml2YXRlIFNldDxDYXNjYWRlVHlwZT4gX2Nhc2NhZGVzID0g\nbnVsbDsKICAgIHByaXZhdGUgU2V0PENhc2NhZGVUeXBlPiBfcGtnQ2FzY2Fk\nZXMgPSBudWxsOwoKICAgIHByaXZhdGUgQ2xhc3MgX2xpc3RlbmVyID0gbnVs\nbDsKICAgIHByaXZhdGUgQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+\nW10gX2NhbGxiYWNrcyA9IG51bGw7CiAgICBwcml2YXRlIGludFtdIF9oaWdo\ncyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5\nIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBYTUxQZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICAgICAgc2V0VmFsaWRhdGlu\nZyh0cnVlKTsKICAgICAgICBzZXRMb2coY29uZi5nZXRMb2coT3BlbkpQQUNv\nbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKSk7CiAgICAgICAgc2V0UGFyc2VD\nb21tZW50cyh0cnVlKTsKICAgICAgICBzZXRNb2RlKE1PREVfTUVUQSB8IE1P\nREVfTUFQUElORyB8IE1PREVfUVVFUlkpOwogICAgICAgIHNldFBhcnNlVGV4\ndCh0cnVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbmZpZ3VyYXRpb24g\nc3VwcGxpZWQgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBwdWJsaWMg\nT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAg\nICAgICByZXR1cm4gX2NvbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUg\nYW5ub3RhdGlvbiBwYXJzZXIuIFdoZW4gY2xhc3MgaXMgZGlzY292ZXJlZCBp\nbiBhbiBYTUwgZmlsZSwKICAgICAqIHdlIGZpcnN0IHBhcnNlIGFueSBhbm5v\ndGF0aW9ucyBwcmVzZW50LCB0aGVuIG92ZXJyaWRlIHdpdGggdGhlIFhNTC4K\nICAgICAqLwogICAgcHVibGljIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFE\nYXRhUGFyc2VyIGdldEFubm90YXRpb25QYXJzZXIoKSB7CiAgICAgICAgcmV0\ndXJuIF9wYXJzZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYW5ub3Rh\ndGlvbiBwYXJzZXIuIFdoZW4gY2xhc3MgaXMgZGlzY292ZXJlZCBpbiBhbiBY\nTUwgZmlsZSwKICAgICAqIHdlIGZpcnN0IHBhcnNlIGFueSBhbm5vdGF0aW9u\ncyBwcmVzZW50LCB0aGVuIG92ZXJyaWRlIHdpdGggdGhlIFhNTC4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0QW5ub3RhdGlvblBhcnNlcihBbm5vdGF0\naW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBwYXJzZXIpewogICAgICAg\nIF9wYXJzZXIgPSBwYXJzZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm5zIHRoZSByZXBvc2l0b3J5IGZvciB0aGlzIHBhcnNlci4gSWYgbm9uZSBo\nYXMgYmVlbiBzZXQsIGNyZWF0ZXMKICAgICAqIGEgbmV3IHJlcG9zaXRvcnkg\nYW5kIHNldHMgaXQuCiAgICAgKi8KICAgIHB1YmxpYyBNZXRhRGF0YVJlcG9z\naXRvcnkgZ2V0UmVwb3NpdG9yeSgpIHsKICAgICAgICBpZiAoX3JlcG9zID09\nIG51bGwpIHsKICAgICAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9z\nID0gX2NvbmYubmV3TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAg\nICAgICAgICAgTWV0YURhdGFGYWN0b3J5IG1kZiA9IHJlcG9zLmdldE1ldGFE\nYXRhRmFjdG9yeSgpOwogICAgICAgICAgICBpZiAobWRmIGluc3RhbmNlb2Yg\nRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9yeSkKICAgICAgICAgICAgICAgIG1k\nZiA9ICgoRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9yeSkgbWRmKS5nZXRJbm5l\ncm1vc3REZWxlZ2F0ZSgpOwogICAgICAgICAgICBpZiAobWRmIGluc3RhbmNl\nb2YgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkpCiAgICAgICAgICAgICAg\nICAoKFBlcnNpc3RlbmNlTWV0YURhdGFGYWN0b3J5KSBtZGYpLnNldFhNTFBh\ncnNlcih0aGlzKTsKICAgICAgICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBfcmVwb3M7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgdGhlIG1ldGFkYXRhIHJlcG9zaXRvcnkgZm9yIHRoaXMgcGFy\nc2VyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZXBvc2l0b3J5KE1l\ndGFEYXRhUmVwb3NpdG9yeSByZXBvcykgewogICAgICAgIF9yZXBvcyA9IHJl\ncG9zOwogICAgICAgIGlmIChyZXBvcyAhPSBudWxsCiAgICAgICAgICAgICYm\nIChyZXBvcy5nZXRWYWxpZGF0ZSgpICYgcmVwb3MuVkFMSURBVEVfUlVOVElN\nRSkgIT0gMCkKICAgICAgICAgICAgc2V0UGFyc2VDb21tZW50cyhmYWxzZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGVudmlyb25tZW50\nYWwgY2xhc3MgbG9hZGVyIHRvIHBhc3Mgb24gdG8gcGFyc2VkCiAgICAgKiBt\nZXRhZGF0YSBpbnN0YW5jZXMuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc0xv\nYWRlciBnZXRFbnZDbGFzc0xvYWRlcigpIHsKICAgICAgICByZXR1cm4gX2Vu\ndkxvYWRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZW52aXJv\nbm1lbnRhbCBjbGFzcyBsb2FkZXIgdG8gcGFzcyBvbiB0byBwYXJzZWQKICAg\nICAqIG1ldGFkYXRhIGluc3RhbmNlcy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0RW52Q2xhc3NMb2FkZXIoQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAg\nICAgICAgX2VudkxvYWRlciA9IGxvYWRlcjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdG8gYWxsb3cgbGF0ZXIgcGFyc2VzIG9mIG1hcHBpbmcg\naW5mb3JtYXRpb24gdG8gb3ZlcnJpZGUKICAgICAqIGVhcmxpZXIgaW5mb3Jt\nYXRpb24gZm9yIHRoZSBzYW1lIGNsYXNzLiBEZWZhdWx0cyB0byBmYWxzZS4g\nVXNlZnVsCiAgICAgKiB3aGVuIGEgdG9vbCBpcyBtYXBwaW5nIGEgY2xhc3Ms\nIHNvIHRoYXQgLmpkbyBmaWxlIHBhcnRpYWwgbWFwcGluZwogICAgICogaW5m\nb3JtYXRpb24gY2FuIGJlIHVzZWQgZXZlbiB3aGVuIG1hcHBpbmdzIGFyZSBz\ndG9yZWQgaW4gLm9ybSBmaWxlcwogICAgICogb3Igb3RoZXIgbG9jYXRpb25z\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRNYXBwaW5nT3ZlcnJp\nZGUoKSB7CiAgICAgICAgcmV0dXJuIF9vdmVycmlkZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgdG8gYWxsb3cgbGF0ZXIgcGFyc2VzIG9mIG1h\ncHBpbmcgaW5mb3JtYXRpb24gdG8gb3ZlcnJpZGUKICAgICAqIGVhcmxpZXIg\naW5mb3JtYXRpb24gZm9yIHRoZSBzYW1lIGNsYXNzLiBEZWZhdWx0cyB0byBm\nYWxzZS4gVXNlZnVsCiAgICAgKiB3aGVuIGEgdG9vbCBpcyBtYXBwaW5nIGEg\nY2xhc3MsIHNvIHRoYXQgLmpkbyBmaWxlIHBhcnRpYWwgbWFwcGluZwogICAg\nICogaW5mb3JtYXRpb24gY2FuIGJlIHVzZWQgZXZlbiB3aGVuIG1hcHBpbmdz\nIGFyZSBzdG9yZWQgaW4gLm9ybSBmaWxlcwogICAgICogb3Igb3RoZXIgbG9j\nYXRpb25zLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNYXBwaW5nT3Zl\ncnJpZGUoYm9vbGVhbiBvdmVycmlkZSkgewogICAgICAgIF9vdmVycmlkZSA9\nIG92ZXJyaWRlOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHBhcnNlIG1v\nZGUgYWNjb3JkaW5nIHRvIHRoZSBleHBlY3RlZCBkb2N1bWVudCB0eXBlLiBU\naGUKICAgICAqIG1vZGUgY29uc3RhbnRzIGFjdCBhcyBiaXQgZmxhZ3MsIGFu\nZCB0aGVyZWZvcmUgY2FuIGJlIGNvbWJpbmVkLgogICAgICovCiAgICBwdWJs\naWMgaW50IGdldE1vZGUoKSB7CiAgICAgICAgcmV0dXJuIF9tb2RlOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIHBhcnNlIG1vZGUgYWNjb3JkaW5nIHRv\nIHRoZSBleHBlY3RlZCBkb2N1bWVudCB0eXBlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRNb2RlKGludCBtb2RlLCBib29sZWFuIG9uKSB7CiAgICAg\nICAgaWYgKG1vZGUgPT0gTU9ERV9OT05FKQogICAgICAgICAgICBzZXRNb2Rl\nKE1PREVfTk9ORSk7CiAgICAgICAgZWxzZSBpZiAob24pCiAgICAgICAgICAg\nIHNldE1vZGUoX21vZGUgfCBtb2RlKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIHNldE1vZGUoX21vZGUgJiB+bW9kZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgcGFyc2UgbW9kZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVjdGVk\nIGRvY3VtZW50IHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1v\nZGUoaW50IG1vZGUpIHsKICAgICAgICBfbW9kZSA9IG1vZGU7CiAgICAgICAg\naWYgKF9wYXJzZXIgIT0gbnVsbCkKICAgICAgICAgICAgX3BhcnNlci5zZXRN\nb2RlKG1vZGUpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2Ug\nbWV0aG9kIGZvciBpbnRlcnByZXRpbmcge0BsaW5rICNnZXRNb2RlfS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNNZXRhRGF0YU1vZGUoKSB7\nCiAgICAgICAgcmV0dXJuIChfbW9kZSAmIE1PREVfTUVUQSkgIT0gMDsKICAg\nIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3IgaW50\nZXJwcmV0aW5nIHtAbGluayAjZ2V0TW9kZX0uCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIGlzUXVlcnlNb2RlKCkgewogICAgICAgIHJldHVybiAo\nX21vZGUgJiBNT0RFX1FVRVJZKSAhPSAwOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVuaWVuY2UgbWV0aG9kIGZvciBpbnRlcnByZXRpbmcge0BsaW5r\nICNnZXRNb2RlfS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNN\nYXBwaW5nTW9kZSgpIHsKICAgICAgICByZXR1cm4gKF9tb2RlICYgTU9ERV9N\nQVBQSU5HKSAhPSAwOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0\ncnVlIGlmIHdlJ3JlIGluIG1hcHBpbmcgbW9kZSBvciBpbiBtZXRhZGF0YSBt\nb2RlIHdpdGgKICAgICAqIG1hcHBpbmcgb3ZlcnJpZGUgZW5hYmxlZC4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNNYXBwaW5nT3ZlcnJpZGVN\nb2RlKCkgewogICAgICAgIHJldHVybiBpc01hcHBpbmdNb2RlKCkgfHwgKF9v\ndmVycmlkZSAmJiBpc01ldGFEYXRhTW9kZSgpKTsKICAgIH0KCiAgICAvLy8v\nLy8vLy8vLy8vLy8KICAgIC8vIFhNTCBwYXJzaW5nCiAgICAvLy8vLy8vLy8v\nLy8vLy8KCiAgICAvKioKICAgICAqIFB1c2ggYSBwYXJzZSBlbGVtZW50IG9u\ndG8gdGhlIHN0YWNrLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwdXNo\nRWxlbWVudChPYmplY3QgZWxlbSkgewogICAgICAgIF9lbGVtZW50cy5wdXNo\nKGVsZW0pOwogICAgfQoKICAgIC8qKgogICAgICogUG9wIGEgcGFyc2UgZWxl\nbWVudCBmcm9tIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJvdGVjdGVkIE9i\namVjdCBwb3BFbGVtZW50KCkgewogICAgICAgIHJldHVybiBfZWxlbWVudHMu\ncG9wKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJl\nbnQgZWxlbWVudCBiZWluZyBwYXJzZWQuIE1heSBiZSBhIGNsYXNzIG1ldGFk\nYXRhLAogICAgICogZmllbGQgbWV0YWRhdGEsIHF1ZXJ5IG1ldGFkYXRhLCBl\ndGMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgY3VycmVudEVsZW1l\nbnQoKSB7CiAgICAgICAgaWYgKF9lbGVtZW50cy5pc0VtcHR5KCkpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBfZWxlbWVudHMu\ncGVlaygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjdXJy\nZW50IHtAbGluayBQZXJzaXN0ZW5jZVN0cmF0ZWd5fSBpZiBhbnkuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBQZXJzaXN0ZW5jZVN0cmF0ZWd5IGN1cnJlbnRT\ndHJhdGVneSgpIHsKICAgICAgICByZXR1cm4gX3N0cmF0ZWd5OwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB0YWcgb2YgdGhlIGN1cnJlbnQg\ncGFyZW50IGVsZW1lbnQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3Qg\nY3VycmVudFBhcmVudCgpIHsKICAgICAgICBpZiAoX3BhcmVudHMuaXNFbXB0\neSgpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4g\nX3BhcmVudHMucGVlaygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHdoZXRoZXIgd2UncmUgcnVubmluZyB0aGUgcGFyc2VyIGF0IHJ1bnRpbWUu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzUnVudGltZSgpIHsK\nICAgICAgICByZXR1cm4gKGdldFJlcG9zaXRvcnkoKS5nZXRWYWxpZGF0ZSgp\nCiAgICAgICAgICAgICYgTWV0YURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX1JV\nTlRJTUUpICE9IDA7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0\nZWQgT2JqZWN0IGdldFNjaGVtYVNvdXJjZSgpIHsKICAgICAgICByZXR1cm4g\nWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlci5jbGFzcy5nZXRSZXNvdXJj\nZUFzU3RyZWFtCiAgICAgICAgICAgICgib3JtLXhzZC5yc3JjIik7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFBhY2th\nZ2VBdHRyaWJ1dGVOYW1lKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRDbGFz\nc0F0dHJpYnV0ZU5hbWUoKSB7CiAgICAgICAgcmV0dXJuICJjbGFzcyI7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgaW50IGdldENsYXNz\nRWxlbWVudERlcHRoKCkgewogICAgICAgIHJldHVybiAxOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNDbGFzc0VsZW1l\nbnROYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuICJlbnRpdHki\nLmVxdWFscyhuYW1lKQogICAgICAgICAgICB8fCAiZW1iZWRkYWJsZSIuZXF1\nYWxzKG5hbWUpCiAgICAgICAgICAgIHx8ICJtYXBwZWQtc3VwZXJjbGFzcyIu\nZXF1YWxzKG5hbWUpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIHZvaWQgcmVzZXQoKSB7CiAgICAgICAgc3VwZXIucmVzZXQoKTsKICAg\nICAgICBfZWxlbWVudHMuY2xlYXIoKTsKICAgICAgICBfcGFyZW50cy5jbGVh\ncigpOwogICAgICAgIF9jbHMgPSBudWxsOwogICAgICAgIF9maWVsZFBvcyA9\nIDA7CiAgICAgICAgX2Nsc1BvcyA9IDA7CgogICAgICAgIF9hY2Nlc3MgPSBD\nbGFzc01ldGFEYXRhLkFDQ0VTU19VTktOT1dOOwogICAgICAgIF9zdHJhdGVn\neSA9IG51bGw7CiAgICAgICAgX2xpc3RlbmVyID0gbnVsbDsKICAgICAgICBf\nY2FsbGJhY2tzID0gbnVsbDsKICAgICAgICBfaGlnaHMgPSBudWxsOwogICAg\nICAgIF9jYXNjYWRlcyA9IG51bGw7CiAgICAgICAgX3BrZ0Nhc2NhZGVzID0g\nbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29s\nZWFuIHN0YXJ0U3lzdGVtRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRl\ncyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBPYmplY3QgdGFnID0gKE9iamVjdCkgX2VsZW1zLmdldChuYW1lKTsKICAg\nICAgICBib29sZWFuIHJldCA9IGZhbHNlOwogICAgICAgIGlmICh0YWcgPT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoaXNNYXBwaW5nT3ZlcnJpZGVNb2Rl\nKCkpCiAgICAgICAgICAgICAgICB0YWcgPSBzdGFydFN5c3RlbU1hcHBpbmdF\nbGVtZW50KG5hbWUsIGF0dHJzKTsKICAgICAgICAgICAgcmV0ID0gdGFnICE9\nIG51bGw7CiAgICAgICAgfSBlbHNlIGlmICh0YWcgaW5zdGFuY2VvZiBNZXRh\nRGF0YVRhZykgewogICAgICAgICAgICBzd2l0Y2ggKChNZXRhRGF0YVRhZykg\ndGFnKSB7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZOgogICAgICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0TmFtZWRRdWVyeShhdHRycyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFV\nRVJZX0hJTlQ6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRRdWVy\neUhpbnQoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAgICAgICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnROYW1lZE5hdGl2ZVF1ZXJ5KGF0dHJzKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nUVVFUllfU1RSSU5HOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nUXVlcnlTdHJpbmcoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBTRVFfR0VORVJBVE9SOgogICAgICAg\nICAgICAgICAgICAgIHJldCA9IHN0YXJ0U2VxdWVuY2VHZW5lcmF0b3IoYXR0\ncnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBGTFVTSF9NT0RFOgogICAgICAgICAgICAgICAgICAgIHJldCA9\nIHN0YXJ0Rmx1c2hNb2RlKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRU5USVRZX0xJU1RFTkVSUzoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEVudGl0eUxpc3RlbmVy\ncyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFBSRV9QRVJTSVNUOgogICAgICAgICAgICAgICAgY2Fz\nZSBQT1NUX1BFUlNJU1Q6CiAgICAgICAgICAgICAgICBjYXNlIFBSRV9SRU1P\nVkU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfUkVNT1ZFOgogICAgICAg\nICAgICAgICAgY2FzZSBQUkVfVVBEQVRFOgogICAgICAgICAgICAgICAgY2Fz\nZSBQT1NUX1VQREFURToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9MT0FE\nOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0Q2FsbGJhY2soKE1l\ndGFEYXRhVGFnKSB0YWcsIGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAg\nICAgICAgd2FyblVuc3VwcG9ydGVkVGFnKG5hbWUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT0gRUxFTV9QVV9NRVRBIHx8IHRh\nZyA9PSBFTEVNX1BVX0RFRikKICAgICAgICAgICAgcmV0ID0gaXNNZXRhRGF0\nYU1vZGUoKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9YTUxfTUFQ\nX01FVEFfQ09NUExFVEUpCiAgICAgICAgICAgIHNldEFubm90YXRpb25QYXJz\nZXIobnVsbCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQUNDRVNT\nKQogICAgICAgICAgICByZXQgPSBfbW9kZSAhPSBNT0RFX1FVRVJZOwogICAg\nICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RFTkVSKQogICAgICAgICAg\nICByZXQgPSBzdGFydEVudGl0eUxpc3RlbmVyKGF0dHJzKTsKICAgICAgICBl\nbHNlIGlmICh0YWcgPT0gRUxFTV9DQVNDQURFKQogICAgICAgICAgICByZXQg\nPSBpc01ldGFEYXRhTW9kZSgpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0NBU0NBREVfQUxMIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfUEVSCiAg\nICAgICAgICAgIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfTUVSIHx8IHRhZyA9\nPSBFTEVNX0NBU0NBREVfUkVNCiAgICAgICAgICAgIHx8IHRhZyA9PSBFTEVN\nX0NBU0NBREVfUkVGKQogICAgICAgICAgICByZXQgPSBzdGFydENhc2NhZGUo\ndGFnLCBhdHRycyk7CgogICAgICAgIGlmIChyZXQpCiAgICAgICAgICAgIF9w\nYXJlbnRzLnB1c2godGFnKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kU3lzdGVtRWxl\nbWVudChTdHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBPYmplY3QgdGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAg\nICAgICBpZiAodGFnID09IG51bGwgJiYgaXNNYXBwaW5nT3ZlcnJpZGVNb2Rl\nKCkpCiAgICAgICAgICAgIGVuZFN5c3RlbU1hcHBpbmdFbGVtZW50KG5hbWUp\nOwogICAgICAgIGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFn\nKSB7CiAgICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsK\nICAgICAgICAgICAgICAgIGNhc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAg\nICAgZW5kTmFtZWRRdWVyeSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAgICAg\nICAgICAgICAgIGVuZFF1ZXJ5SGludCgpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAg\nICAgICAgICAgICAgICAgICAgZW5kTmFtZWROYXRpdmVRdWVyeSgpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBR\nVUVSWV9TVFJJTkc6CiAgICAgICAgICAgICAgICAgICAgZW5kUXVlcnlTdHJp\nbmcoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAgICAgICAgICAgICAgICBl\nbmRTZXF1ZW5jZUdlbmVyYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT0g\nRUxFTV9BQ0NFU1MpCiAgICAgICAgICAgIGVuZEFjY2VzcygpOwogICAgICAg\nIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RFTkVSKQogICAgICAgICAgICBl\nbmRFbnRpdHlMaXN0ZW5lcigpOwoKICAgICAgICBfcGFyZW50cy5wb3AoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0byBwYXJzZSBhIG1h\ncHBpbmcgZWxlbWVudCBvdXRzaWRlIG9mIGFueSBjbGFzcy4KICAgICAqCiAg\nICAgKiBAcmV0dXJuIHRoZSB0YWcgZm9yIHRoZSBnaXZlbiBlbGVtZW50LCBv\nciBudWxsIHRvIHNraXAgdGhlIGVsZW1lbnQKICAgICAqLwogICAgcHJvdGVj\ndGVkIE9iamVjdCBzdGFydFN5c3RlbU1hcHBpbmdFbGVtZW50KFN0cmluZyBu\nYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgog\nICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVtZW50IG91\ndHNpZGUgb2YgYW55IGNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBlbmRTeXN0ZW1NYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSkKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0Q2xhc3NFbGVtZW50KFN0cmlu\nZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIE9iamVjdCB0YWcgPSAoT2JqZWN0KSBfZWxl\nbXMuZ2V0KG5hbWUpOwogICAgICAgIGJvb2xlYW4gcmV0ID0gZmFsc2U7CiAg\nICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChpc01h\ncHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAgICAgICAgIHRhZyA9IHN0\nYXJ0Q2xhc3NNYXBwaW5nRWxlbWVudChuYW1lLCBhdHRycyk7CiAgICAgICAg\nICAgIHJldCA9IHRhZyAhPSBudWxsOwogICAgICAgIH0gZWxzZSBpZiAodGFn\nIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAgICAgICAgc3dpdGNo\nICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAgICAgICAgY2FzZSBH\nRU5FUkFURURfVkFMVUU6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3Rh\ncnRHZW5lcmF0ZWRWYWx1ZShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElEOgogICAgICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0SWQoYXR0cnMpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFTUJFRERFRF9JRDoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEVtYmVkZGVkSWQoYXR0\ncnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBJRF9DTEFTUzoKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydElkQ2xhc3MoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBMT0I6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gc3RhcnRMb2IoYXR0cnMpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWToKICAgICAgICAg\nICAgICAgICAgICByZXQgPSBzdGFydE5hbWVkUXVlcnkoYXR0cnMpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBR\nVUVSWV9ISU5UOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0UXVl\ncnlIaW50KGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZOgogICAgICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0TmFtZWROYXRpdmVRdWVyeShhdHRycyk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIFFVRVJZX1NUUklORzoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndFF1ZXJ5U3RyaW5nKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydFNlcXVlbmNlR2VuZXJhdG9yKGF0\ndHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgVkVSU0lPTjoKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydFZlcnNpb24oYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBNQVBfS0VZOgogICAgICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0TWFwS2V5KGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkxVU0hfTU9E\nRToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEZsdXNoTW9kZShh\ndHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIE9SREVSX0JZOgogICAgICAgICAgICAgICAgY2FzZSBFTlRJ\nVFlfTElTVEVORVJTOgogICAgICAgICAgICAgICAgICAgIHJldCA9IGlzTWV0\nYURhdGFNb2RlKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIEVYQ0xVREVfREVGQVVMVF9MSVNURU5FUlM6CiAg\nICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRFeGNsdWRlRGVmYXVsdExp\nc3RlbmVycyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIEVYQ0xVREVfU1VQRVJDTEFTU19MSVNURU5F\nUlM6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRFeGNsdWRlU3Vw\nZXJjbGFzc0xpc3RlbmVycyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFBSRV9QRVJTSVNUOgogICAg\nICAgICAgICAgICAgY2FzZSBQT1NUX1BFUlNJU1Q6CiAgICAgICAgICAgICAg\nICBjYXNlIFBSRV9SRU1PVkU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1Rf\nUkVNT1ZFOgogICAgICAgICAgICAgICAgY2FzZSBQUkVfVVBEQVRFOgogICAg\nICAgICAgICAgICAgY2FzZSBQT1NUX1VQREFURToKICAgICAgICAgICAgICAg\nIGNhc2UgUE9TVF9MT0FEOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0\nYXJ0Q2FsbGJhY2soKE1ldGFEYXRhVGFnKSB0YWcsIGF0dHJzKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICAgICAgd2FyblVuc3VwcG9ydGVkVGFnKG5hbWUp\nOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0YWcgaW5zdGFu\nY2VvZiBQZXJzaXN0ZW5jZVN0cmF0ZWd5KSB7CiAgICAgICAgICAgIFBlcnNp\nc3RlbmNlU3RyYXRlZ3kgcHMgPSAoUGVyc2lzdGVuY2VTdHJhdGVneSkgdGFn\nOwogICAgICAgICAgICByZXQgPSBzdGFydFN0cmF0ZWd5KHBzLCBhdHRycyk7\nCiAgICAgICAgICAgIGlmIChyZXQpCiAgICAgICAgICAgICAgICBfc3RyYXRl\nZ3kgPSBwczsKICAgICAgICB9IGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RF\nTkVSKQogICAgICAgICAgICByZXQgPSBzdGFydEVudGl0eUxpc3RlbmVyKGF0\ndHJzKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9BVFRSUykKICAg\nICAgICAgICAgcmV0ID0gX21vZGUgIT0gTU9ERV9RVUVSWTsKICAgICAgICBl\nbHNlIGlmICh0YWcgPT0gRUxFTV9DQVNDQURFKQogICAgICAgICAgICByZXQg\nPSBpc01ldGFEYXRhTW9kZSgpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0NBU0NBREVfQUxMIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfUEVSCiAg\nICAgICAgICAgIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfTUVSIHx8IHRhZyA9\nPSBFTEVNX0NBU0NBREVfUkVNCiAgICAgICAgICAgIHx8IHRhZyA9PSBFTEVN\nX0NBU0NBREVfUkVGKQogICAgICAgICAgICByZXQgPSBzdGFydENhc2NhZGUo\ndGFnLCBhdHRycyk7CgogICAgICAgIGlmIChyZXQpCiAgICAgICAgICAgIF9w\nYXJlbnRzLnB1c2godGFnKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3NFbGVt\nZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIE9iamVjdCB0YWcgPSBfZWxlbXMuZ2V0KG5hbWUpOwogICAg\nICAgIGlmICh0YWcgPT0gbnVsbCAmJiBpc01hcHBpbmdPdmVycmlkZU1vZGUo\nKSkKICAgICAgICAgICAgZW5kQ2xhc3NNYXBwaW5nRWxlbWVudChuYW1lKTsK\nICAgICAgICBlbHNlIGlmICh0YWcgaW5zdGFuY2VvZiBNZXRhRGF0YVRhZykg\newogICAgICAgICAgICBzd2l0Y2ggKChNZXRhRGF0YVRhZykgdGFnKSB7CiAg\nICAgICAgICAgICAgICBjYXNlIEdFTkVSQVRFRF9WQUxVRToKICAgICAgICAg\nICAgICAgICAgICBlbmRHZW5lcmF0ZWRWYWx1ZSgpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBJRDoKICAgICAg\nICAgICAgICAgICAgICBlbmRJZCgpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFTUJFRERFRF9JRDoKICAgICAg\nICAgICAgICAgICAgICBlbmRFbWJlZGRlZElkKCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElEX0NMQVNTOgog\nICAgICAgICAgICAgICAgICAgIGVuZElkQ2xhc3MoKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTE9COgogICAg\nICAgICAgICAgICAgICAgIGVuZExvYigpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWToKICAgICAgICAg\nICAgICAgICAgICBlbmROYW1lZFF1ZXJ5KCk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX0hJTlQ6CiAg\nICAgICAgICAgICAgICAgICAgZW5kUXVlcnlIaW50KCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE5BVElWRV9R\nVUVSWToKICAgICAgICAgICAgICAgICAgICBlbmROYW1lZE5hdGl2ZVF1ZXJ5\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIFFVRVJZX1NUUklORzoKICAgICAgICAgICAgICAgICAgICBlbmRR\ndWVyeVN0cmluZygpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBTRVFfR0VORVJBVE9SOgogICAgICAgICAgICAg\nICAgICAgIGVuZFNlcXVlbmNlR2VuZXJhdG9yKCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFZFUlNJT046CiAg\nICAgICAgICAgICAgICAgICAgZW5kVmVyc2lvbigpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9CWToK\nICAgICAgICAgICAgICAgICAgICBlbmRPcmRlckJ5KCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2Ug\naWYgKHRhZyBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlU3RyYXRlZ3kpCiAgICAg\nICAgICAgIGVuZFN0cmF0ZWd5KChQZXJzaXN0ZW5jZVN0cmF0ZWd5KSB0YWcp\nOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0FDQ0VTUykKICAgICAg\nICAgICAgZW5kQWNjZXNzKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVM\nRU1fTElTVEVORVIpCiAgICAgICAgICAgIGVuZEVudGl0eUxpc3RlbmVyKCk7\nCgogICAgICAgIF9wYXJlbnRzLnBvcCgpOwogICAgfQoKICAgIC8qKgogICAg\nICogTG9nIHdhcm5pbmcgYWJvdXQgYW4gdW5zdXBwb3J0ZWQgdGFnLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgd2FyblVuc3VwcG9ydGVkVGFnKFN0cmlu\nZyBuYW1lKSB7CiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAg\nIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJh\nY2UoX2xvYy5nZXQoInVuc3VwcG9ydGVkLXRhZyIsIG5hbWUpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0byBwYXJzZSBhIG1hcHBpbmcg\nZWxlbWVudCB3aXRoaW4gYSBjbGFzcy4KICAgICAqCiAgICAgKiBAcmV0dXJu\nIHRoZSB0YWcgZm9yIHRoZSBnaXZlbiBlbGVtZW50LCBvciBudWxsIHRvIHNr\naXAgZWxlbWVudAogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHN0YXJ0\nQ2xhc3NNYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0\nbyBwYXJzZSBhIG1hcHBpbmcgZWxlbWVudCB3aXRoaW4gYSBjbGFzcy4KICAg\nICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3NNYXBwaW5nRWxlbWVu\ndChTdHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29sZWFuIHN0\nYXJ0Q2xhc3MoU3RyaW5nIGVsZW0sIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc3RhcnRD\nbGFzcyhlbGVtLCBhdHRycyk7CgogICAgICAgIC8vIHF1ZXJ5IG1vZGUgb25s\neT8KICAgICAgICBfY2xzID0gY2xhc3NGb3JOYW1lKGN1cnJlbnRDbGFzc05h\nbWUoKSk7CiAgICAgICAgaWYgKF9tb2RlID09IE1PREVfUVVFUlkpIHsKICAg\nICAgICAgICAgaWYgKF9wYXJzZXIgIT0gbnVsbCAmJgogICAgICAgICAgICAg\nICAgISJ0cnVlIi5lcXVhbHMoYXR0cnMuZ2V0VmFsdWUoIm1ldGFkYXRhLWNv\nbXBsZXRlIikpKQogICAgICAgICAgICAgICAgX3BhcnNlci5wYXJzZShfY2xz\nKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAg\nICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInBh\ncnNlLWNsYXNzIiwgX2Nscy5nZXROYW1lKCkpKTsKCiAgICAgICAgTWV0YURh\ndGFSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAg\nIENsYXNzTWV0YURhdGEgbWV0YSA9IHJlcG9zLmdldENhY2hlZE1ldGFEYXRh\nKF9jbHMpOwogICAgICAgIGlmIChtZXRhICE9IG51bGwKICAgICAgICAgICAg\nJiYgKChpc01ldGFEYXRhTW9kZSgpICYmIChtZXRhLmdldFNvdXJjZU1vZGUo\nKSAmIE1PREVfTUVUQSkgIT0gMCkKICAgICAgICAgICAgfHwgKGlzTWFwcGlu\nZ01vZGUoKSAmJiAobWV0YS5nZXRTb3VyY2VNb2RlKCkgJiBNT0RFX01BUFBJ\nTkcpICE9IDApKSkKICAgICAgICB7CiAgICAgICAgICAgIGlmIChsb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5n\nZXQoImR1cC1tZXRhZGF0YSIsIF9jbHMsIGdldFNvdXJjZU5hbWUoKSkpOwog\nICAgICAgICAgICBfY2xzID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgd2UgZG9uJ3Qga25vdyB0\naGUgYWNjZXNzIHR5cGUsIGNoZWNrIHRvIHNlZSBpZiBhIHN1cGVyY2xhc3MK\nICAgICAgICAvLyBoYXMgYWxyZWFkeSBkZWZpbmVkIHRoZSBhY2Nlc3MgdHlw\nZQogICAgICAgIGludCBkZWZhdWx0QWNjZXNzID0gX2FjY2VzczsKICAgICAg\nICBpZiAoZGVmYXVsdEFjY2VzcyA9PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19V\nTktOT1dOKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgc3VwID0gcmVw\nb3MuZ2V0Q2FjaGVkTWV0YURhdGEoX2Nscy5nZXRTdXBlcmNsYXNzKCkpOwog\nICAgICAgICAgICBpZiAoc3VwICE9IG51bGwpCiAgICAgICAgICAgICAgICBk\nZWZhdWx0QWNjZXNzID0gc3VwLmdldEFjY2Vzc1R5cGUoKTsKICAgICAgICB9\nCgogICAgICAgIGlmIChtZXRhID09IG51bGwpIHsKICAgICAgICAgICAgLy8g\nYWRkIG1ldGFkYXRhIGZvciB0aGlzIHR5cGUKICAgICAgICAgICAgaW50IGFj\nY2VzcyA9IHRvQWNjZXNzVHlwZShhdHRycy5nZXRWYWx1ZSgiYWNjZXNzIiks\nIGRlZmF1bHRBY2Nlc3MpOwogICAgICAgICAgICBtZXRhID0gcmVwb3MuYWRk\nTWV0YURhdGEoX2NscywgYWNjZXNzKTsKICAgICAgICAgICAgbWV0YS5zZXRF\nbnZDbGFzc0xvYWRlcihfZW52TG9hZGVyKTsKICAgICAgICAgICAgbWV0YS5z\nZXRTb3VyY2VNb2RlKE1PREVfTk9ORSk7CgogICAgICAgICAgICAvLyBwYXJz\nZSBhbm5vdGF0aW9ucyBmaXJzdCBzbyBYTUwgb3ZlcnJpZGVzIHRoZW0KICAg\nICAgICAgICAgaWYgKF9wYXJzZXIgIT0gbnVsbCAmJgogICAgICAgICAgICAg\nICAgISJ0cnVlIi5lcXVhbHMoYXR0cnMuZ2V0VmFsdWUoIm1ldGFkYXRhLWNv\nbXBsZXRlIikpKQogICAgICAgICAgICAgICAgX3BhcnNlci5wYXJzZShfY2xz\nKTsKICAgICAgICB9CgogICAgICAgIGJvb2xlYW4gbWFwcGVkU3VwZXIgPSAi\nbWFwcGVkLXN1cGVyY2xhc3MiLmVxdWFscyhlbGVtKTsKICAgICAgICBpZiAo\naXNNZXRhRGF0YU1vZGUoKSkgewogICAgICAgICAgICBtZXRhLnNldFNvdXJj\nZShnZXRTb3VyY2VGaWxlKCksIG1ldGEuU1JDX1hNTCk7CiAgICAgICAgICAg\nIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01FVEEsIHRydWUpOwogICAgICAg\nICAgICBMb2NhdG9yIGxvY2F0b3IgPSBnZXRMb2NhdGlvbigpLmdldExvY2F0\nb3IoKTsKICAgICAgICAgICAgaWYgKGxvY2F0b3IgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgbWV0YS5zZXRMaW5lTnVtYmVyKE51bWJlcnMudmFsdWVP\nZihsb2NhdG9yLmdldExpbmVOdW1iZXIoKSkpOwogICAgICAgICAgICAgICAg\nbWV0YS5zZXRDb2xOdW1iZXIoTnVtYmVycy52YWx1ZU9mKGxvY2F0b3IuZ2V0\nQ29sdW1uTnVtYmVyKCkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBt\nZXRhLnNldExpc3RpbmdJbmRleChfY2xzUG9zKTsKICAgICAgICAgICAgU3Ry\naW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgICAg\nICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkobmFtZSkpCiAgICAgICAgICAg\nICAgICBtZXRhLnNldFR5cGVBbGlhcyhuYW1lKTsKICAgICAgICAgICAgbWV0\nYS5zZXRFbWJlZGRlZE9ubHkobWFwcGVkU3VwZXIgfHwgImVtYmVkZGFibGUi\nLmVxdWFscyhlbGVtKSk7CiAgICAgICAgICAgIGlmIChtYXBwZWRTdXBlcikK\nICAgICAgICAgICAgICAgIG1ldGEuc2V0SWRlbnRpdHlUeXBlKG1ldGEuSURf\nVU5LTk9XTik7CiAgICAgICAgfQogICAgICAgIGlmIChpc01hcHBpbmdNb2Rl\nKCkpCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01BUFBJ\nTkcsIHRydWUpOwogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUo\nKSkKICAgICAgICAgICAgc3RhcnRDbGFzc01hcHBpbmcobWV0YSwgbWFwcGVk\nU3VwZXIsIGF0dHJzKTsKICAgICAgICBpZiAoaXNRdWVyeU1vZGUoKSkKICAg\nICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfUVVFUlksIHRydWUp\nOwoKICAgICAgICBfY2xzUG9zKys7CiAgICAgICAgX2ZpZWxkUG9zID0gMDsK\nICAgICAgICBhZGRDb21tZW50cyhtZXRhKTsKICAgICAgICBwdXNoRWxlbWVu\ndChtZXRhKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzKFN0cmluZyBlbGVt\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmIChf\nbW9kZSAhPSBNT0RFX1FVRVJZKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURh\ndGEgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBwb3BFbGVtZW50KCk7CiAgICAg\nICAgICAgIHN0b3JlQ2FsbGJhY2tzKG1ldGEpOwogICAgICAgICAgICBpZiAo\naXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgICAgICBlbmRD\nbGFzc01hcHBpbmcobWV0YSk7CiAgICAgICAgfQogICAgICAgIF9jbHMgPSBu\ndWxsOwogICAgICAgIHN1cGVyLmVuZENsYXNzKGVsZW0pOwogICAgfQoKICAg\nIC8qKgogICAgICogSW1wbGVtZW50IHRvIGFkZCBtYXBwaW5nIGF0dHJpYnV0\nZXMgdG8gY2xhc3MuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0\nQ2xhc3NNYXBwaW5nKENsYXNzTWV0YURhdGEgbWFwcGluZywKICAgICAgICBi\nb29sZWFuIG1hcHBlZFN1cGVyLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8qKgogICAgICog\nSW1wbGVtZW50IHRvIGZpbmFsaXplIGNsYXNzIG1hcHBpbmcuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzTWFwcGluZyhDbGFzc01ldGFE\nYXRhIG1hcHBpbmcpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IGFjY2VzcyBlbGVtZW50Lgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgZW5kQWNjZXNzKCkgewogICAgICAg\nIF9hY2Nlc3MgPSB0b0FjY2Vzc1R5cGUoY3VycmVudFRleHQoKSwgQ2xhc3NN\nZXRhRGF0YS5BQ0NFU1NfVU5LTk9XTik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSB0aGUgZ2l2ZW4gc3RyaW5nIGFzIGFuIGVudGl0eSBhY2Nlc3Mg\ndHlwZSwgZGVmYXVsdGluZyB0byBnaXZlbgogICAgICogZGVmYXVsdCBpZiBz\ndHJpbmcgaXMgZW1wdHkuCiAgICAgKi8KICAgIHByaXZhdGUgaW50IHRvQWNj\nZXNzVHlwZShTdHJpbmcgc3RyLCBpbnQgZGVmKSB7CiAgICAgICAgaWYgKFN0\ncmluZ1V0aWxzLmlzRW1wdHkoc3RyKSkKICAgICAgICAgICAgcmV0dXJuIGRl\nZjsKICAgICAgICBpZiAoIlBST1BFUlRZIi5lcXVhbHMoc3RyKSkKICAgICAg\nICAgICAgcmV0dXJuIENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZOwog\nICAgICAgIHJldHVybiBDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGZsdXNoLW1vZGUgZWxlbWVudC4K\nICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Rmx1c2hNb2RlKEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cu\naXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgidW5zdXBwb3J0ZWQiLCAiZmx1c2gtbW9kZSIsIGdldFNvdXJjZU5hbWUo\nKSkpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIHNlcXVlbmNlLWdlbmVyYXRvci4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGJvb2xlYW4gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihBdHRyaWJ1\ndGVzIGF0dHJzKSB7CiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1v\nZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJp\nbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9n\nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJs\nZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1z\nZXF1ZW5jZSIsIG5hbWUpKTsKCiAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBt\nZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmdldENhY2hlZFNlcXVlbmNlTWV0YURh\ndGEobmFtZSk7CiAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBsb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgi\nb3ZlcnJpZGUtc2VxdWVuY2UiLCBuYW1lKSk7CgogICAgICAgIG1ldGEgPSBn\nZXRSZXBvc2l0b3J5KCkuYWRkU2VxdWVuY2VNZXRhRGF0YShuYW1lKTsKICAg\nICAgICBTdHJpbmcgc2VxID0gYXR0cnMuZ2V0VmFsdWUoInNlcXVlbmNlLW5h\nbWUiKTsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImlu\naXRpYWwtdmFsdWUiKTsKICAgICAgICBpbnQgaW5pdGlhbCA9IHZhbCA9PSBu\ndWxsID8gMSA6IEludGVnZXIucGFyc2VJbnQodmFsKTsKICAgICAgICB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgiYWxsb2NhdGlvbi1zaXplIik7CiAgICAgICAg\naW50IGFsbG9jYXRlID0gdmFsID09IG51bGwgPyA1MCA6IEludGVnZXIucGFy\nc2VJbnQodmFsKTsKCiAgICAgICAgU3RyaW5nIGNsc05hbWUsIHByb3BzOwog\nICAgICAgIGlmIChzZXEgPT0gbnVsbCB8fCBzZXEuaW5kZXhPZignKCcpID09\nIC0xKSB7CiAgICAgICAgICAgIGNsc05hbWUgPSBTZXF1ZW5jZU1ldGFEYXRh\nLklNUExfTkFUSVZFOwogICAgICAgICAgICBwcm9wcyA9IG51bGw7CiAgICAg\nICAgfSBlbHNlIHsgLy8gcGx1Z2luCiAgICAgICAgICAgIGNsc05hbWUgPSBD\nb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUoc2VxKTsKICAgICAgICAgICAg\ncHJvcHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKHNlcSk7CiAg\nICAgICAgICAgIHNlcSA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBtZXRh\nLnNldFNlcXVlbmNlUGx1Z2luKENvbmZpZ3VyYXRpb25zLmdldFBsdWdpbihj\nbHNOYW1lLCBwcm9wcykpOwogICAgICAgIG1ldGEuc2V0U2VxdWVuY2Uoc2Vx\nKTsKICAgICAgICBtZXRhLnNldEluaXRpYWxWYWx1ZShpbml0aWFsKTsKICAg\nICAgICBtZXRhLnNldEFsbG9jYXRlKGFsbG9jYXRlKTsKCiAgICAgICAgT2Jq\nZWN0IGN1ciA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNj\nb3BlID0gKGN1ciBpbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAg\nICAgID8gKChDbGFzc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUo\nKSA6IG51bGw7CiAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmls\nZSgpLCBzY29wZSwgbWV0YS5TUkNfWE1MKTsKICAgICAgICBMb2NhdG9yIGxv\nY2F0b3IgPSBnZXRMb2NhdGlvbigpLmdldExvY2F0b3IoKTsKICAgICAgICBp\nZiAobG9jYXRvciAhPSBudWxsKSB7CiAgICAgICAgICAgIG1ldGEuc2V0TGlu\nZU51bWJlcihOdW1iZXJzLnZhbHVlT2YobG9jYXRvci5nZXRMaW5lTnVtYmVy\nKCkpKTsKICAgICAgICAgICAgbWV0YS5zZXRDb2xOdW1iZXIoTnVtYmVycy52\nYWx1ZU9mKGxvY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZv\naWQgZW5kU2VxdWVuY2VHZW5lcmF0b3IoKSB7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSBpZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4g\nc3RhcnRJZChBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gcGFyc2VG\naWVsZChhdHRycyk7CiAgICAgICAgZm1kLnNldEV4cGxpY2l0KHRydWUpOwog\nICAgICAgIGZtZC5zZXRQcmltYXJ5S2V5KHRydWUpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZElkKCkKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5pc2hGaWVs\nZCgpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZW1iZWRkZWQtaWQu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0RW1iZWRkZWRJ\nZChBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gcGFyc2VGaWVsZChh\ndHRycyk7CiAgICAgICAgZm1kLnNldEV4cGxpY2l0KHRydWUpOwogICAgICAg\nIGZtZC5zZXRQcmltYXJ5S2V5KHRydWUpOwogICAgICAgIGZtZC5zZXRFbWJl\nZGRlZCh0cnVlKTsKICAgICAgICBpZiAoZm1kLmdldEVtYmVkZGVkTWV0YURh\ndGEoKSA9PSBudWxsKQogICAgICAgICAgICBmbWQuYWRkRW1iZWRkZWRNZXRh\nRGF0YSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIGVuZEVtYmVkZGVkSWQoKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIGZpbmlzaEZpZWxkKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBQYXJzZSBpZC1jbGFzcy4KICAgICAqLwogICAgcHJvdGVj\ndGVkIGJvb2xlYW4gc3RhcnRJZENsYXNzKEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01l\ndGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAg\nICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBjdXJy\nZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBjbHMgPSBhdHRycy5nZXRW\nYWx1ZSgiY2xhc3MiKTsKICAgICAgICBDbGFzcyBpZENscyA9IG51bGw7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgaWRDbHMgPSBjbGFzc0Zvck5hbWUo\nY2xzKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAg\nICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQoImludmFsaWQtaWQt\nY2xhc3MiLCBtZXRhLCBjbHMpLCB0KTsKICAgICAgICB9CiAgICAgICAgbWV0\nYS5zZXRPYmplY3RJZFR5cGUoaWRDbHMsIHRydWUpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZElkQ2xhc3Mo\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgbG9iLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9v\nbGVhbiBzdGFydExvYihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0g\nKEZpZWxkTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgaWYg\nKGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkgIT0gSmF2YVR5cGVzLlNUUklO\nRwogICAgICAgICAgICAmJiBmbWQuZ2V0RGVjbGFyZWRUeXBlKCkgIT0gY2hh\ncltdLmNsYXNzCiAgICAgICAgICAgICYmIGZtZC5nZXREZWNsYXJlZFR5cGUo\nKSAhPSBDaGFyYWN0ZXJbXS5jbGFzcwogICAgICAgICAgICAmJiBmbWQuZ2V0\nRGVjbGFyZWRUeXBlKCkgIT0gYnl0ZVtdLmNsYXNzCiAgICAgICAgICAgICYm\nIGZtZC5nZXREZWNsYXJlZFR5cGUoKSAhPSBCeXRlW10uY2xhc3MpCiAgICAg\nICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKHRydWUpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZExvYigpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSBnZW5lcmF0ZWQtdmFsdWUuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIHN0YXJ0R2VuZXJhdGVkVmFsdWUoQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoIWlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBzdHJhdGVneSA9IGF0dHJzLmdl\ndFZhbHVlKCJzdHJhdGVneSIpOwogICAgICAgIFN0cmluZyBnZW5lcmF0b3Ig\nPSBhdHRycy5nZXRWYWx1ZSgiZ2VuZXJhdG9yIik7CiAgICAgICAgR2VuZXJh\ndGlvblR5cGUgdHlwZSA9IFN0cmluZ1V0aWxzLmlzRW1wdHkoc3RyYXRlZ3kp\nCiAgICAgICAgICAgID8gR2VuZXJhdGlvblR5cGUuQVVUTyA6IEdlbmVyYXRp\nb25UeXBlLnZhbHVlT2Yoc3RyYXRlZ3kpOwoKICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZCA9IChGaWVsZE1ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwog\nICAgICAgIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyLnBh\ncnNlR2VuZXJhdGVkVmFsdWUoZm1kLCB0eXBlLAogICAgICAgICAgICBnZW5l\ncmF0b3IpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIGVuZEdlbmVyYXRlZFZhbHVlKCkKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIExhemlseSBw\nYXJzZSBjYXNjYWRlcy4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4g\nc3RhcnRDYXNjYWRlKE9iamVjdCB0YWcsIEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01l\ndGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAg\nICAgIFNldDxDYXNjYWRlVHlwZT4gY2FzY2FkZXMgPSBudWxsOwogICAgICAg\nIGlmIChjdXJyZW50RWxlbWVudCgpIGluc3RhbmNlb2YgRmllbGRNZXRhRGF0\nYSkgewogICAgICAgICAgICBpZiAoX2Nhc2NhZGVzID09IG51bGwpCiAgICAg\nICAgICAgICAgICBfY2FzY2FkZXMgPSBFbnVtU2V0Lm5vbmVPZihDYXNjYWRl\nVHlwZS5jbGFzcyk7CiAgICAgICAgICAgIGNhc2NhZGVzID0gX2Nhc2NhZGVz\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChfcGtnQ2FzY2Fk\nZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9wa2dDYXNjYWRlcyA9IEVu\ndW1TZXQubm9uZU9mKENhc2NhZGVUeXBlLmNsYXNzKTsKICAgICAgICAgICAg\nY2FzY2FkZXMgPSBfcGtnQ2FzY2FkZXM7CiAgICAgICAgfQogICAgICAgIGJv\nb2xlYW4gYWxsID0gRUxFTV9DQVNDQURFX0FMTCA9PSB0YWc7CiAgICAgICAg\naWYgKGFsbCB8fCBFTEVNX0NBU0NBREVfUEVSID09IHRhZykKICAgICAgICAg\nICAgY2FzY2FkZXMuYWRkKFBFUlNJU1QpOwogICAgICAgIGlmIChhbGwgfHwg\nRUxFTV9DQVNDQURFX1JFTSA9PSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVz\nLmFkZChSRU1PVkUpOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURF\nX01FUiA9PSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChNRVJHRSk7\nCiAgICAgICAgaWYgKGFsbCB8fCBFTEVNX0NBU0NBREVfUkVGID09IHRhZykK\nICAgICAgICAgICAgY2FzY2FkZXMuYWRkKFJFRlJFU0gpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBjYWNo\nZWQgY2FzY2FkZXMgaW50byB0aGUgZmllbGQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHNldENhc2NhZGVzKEZpZWxkTWV0YURhdGEgZm1kKSB7CiAg\nICAgICAgU2V0PENhc2NhZGVUeXBlPiBjYXNjYWRlcyA9IF9jYXNjYWRlczsK\nICAgICAgICBpZiAoX2Nhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAgIGNh\nc2NhZGVzID0gX3BrZ0Nhc2NhZGVzOwogICAgICAgIGlmIChjYXNjYWRlcyA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIFZhbHVlTWV0\nYURhdGEgdm1kID0gZm1kOwogICAgICAgIHN3aXRjaCAoX3N0cmF0ZWd5KSB7\nCiAgICAgICAgICAgIGNhc2UgT05FX01BTlk6CiAgICAgICAgICAgIGNhc2Ug\nTUFOWV9NQU5ZOgogICAgICAgICAgICAgICAgdm1kID0gZm1kLmdldEVsZW1l\nbnQoKTsKICAgICAgICB9CiAgICAgICAgZm9yIChDYXNjYWRlVHlwZSBjYXNj\nYWRlIDogY2FzY2FkZXMpIHsKICAgICAgICAgICAgc3dpdGNoIChjYXNjYWRl\nKSB7CiAgICAgICAgICAgICAgICBjYXNlIFBFUlNJU1Q6CiAgICAgICAgICAg\nICAgICAgICAgdm1kLnNldENhc2NhZGVQZXJzaXN0KFZhbHVlTWV0YURhdGEu\nQ0FTQ0FERV9JTU1FRElBVEUpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBNRVJHRToKICAgICAgICAgICAgICAg\nICAgICB2bWQuc2V0Q2FzY2FkZUF0dGFjaChWYWx1ZU1ldGFEYXRhLkNBU0NB\nREVfSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgUkVNT1ZFOgogICAgICAgICAgICAgICAgICAg\nIHZtZC5zZXRDYXNjYWRlRGVsZXRlKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9J\nTU1FRElBVEUpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBSRUZSRVNIOgogICAgICAgICAgICAgICAgICAgIHZt\nZC5zZXRDYXNjYWRlUmVmcmVzaChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1N\nRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICBfY2FzY2FkZXMgPSBudWxsOwogICAg\nfQoKICAgIC8qKgogICAgICogUGFyc2UgY29tbW9uIGZpZWxkIGF0dHJpYnV0\nZXMuCiAgICAgKi8KICAgIHByaXZhdGUgRmllbGRNZXRhRGF0YSBwYXJzZUZp\nZWxkKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0\nYURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIG5hbWUg\nPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIEZpZWxkTWV0YURh\ndGEgZmllbGQgPSBtZXRhLmdldERlY2xhcmVkRmllbGQobmFtZSk7CiAgICAg\nICAgaWYgKChmaWVsZCA9PSBudWxsIHx8IGZpZWxkLmdldERlY2xhcmVkVHlw\nZSgpID09IE9iamVjdC5jbGFzcykKICAgICAgICAgICAgJiYgbWV0YS5nZXRE\nZXNjcmliZWRUeXBlKCkgIT0gT2JqZWN0LmNsYXNzKSB7CiAgICAgICAgICAg\nIE1lbWJlciBtZW1iZXIgPSBudWxsOwogICAgICAgICAgICBDbGFzcyB0eXBl\nID0gbnVsbDsKICAgICAgICAgICAgaW50IGRlZiA9IF9yZXBvcy5nZXRNZXRh\nRGF0YUZhY3RvcnkoKS5nZXREZWZhdWx0cygpLgogICAgICAgICAgICAgICAg\nZ2V0RGVmYXVsdEFjY2Vzc1R5cGUoKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIGlmIChtZXRhLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFz\nc01ldGFEYXRhLkFDQ0VTU19QUk9QRVJUWQogICAgICAgICAgICAgICAgICAg\nIHx8IChtZXRhLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFzc01ldGFEYXRhLkFD\nQ0VTU19VTktOT1dOCiAgICAgICAgICAgICAgICAgICAgJiYgZGVmID09IENs\nYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZKSkgewogICAgICAgICAgICAg\nICAgICAgIFN0cmluZyBjYXAgPSBTdHJpbmdVdGlscy5jYXBpdGFsaXplKG5h\nbWUpOwogICAgICAgICAgICAgICAgICAgIHR5cGUgPSBtZXRhLmdldERlc2Ny\naWJlZFR5cGUoKTsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgICAgICBtZW1iZXIgPSAoTWV0aG9kKSBBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEoyRG9Qcml2SGVscGVyLmdldERlY2xhcmVkTWV0aG9kQWN0aW9uKAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUsICJnZXQiICsg\nY2FwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChDbGFzc1td\nKSBudWxsKSk7Ly8gdmFyYXJncyBkaXNhbWJpZ3VhdGUKICAgICAgICAgICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXhjZXApIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIG1lbWJlciA9IChNZXRob2QpIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2\naWxlZ2VkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEoyRG9Q\ncml2SGVscGVyLmdldERlY2xhcmVkTWV0aG9kQWN0aW9uKAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlLCAiaXMiICsgY2FwLCAo\nQ2xhc3NbXSkgbnVsbCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZXhjZXAyKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB0aHJvdyBleGNlcDsKICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0\neXBlID0gKChNZXRob2QpIG1lbWJlcikuZ2V0UmV0dXJuVHlwZSgpOwogICAg\nICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBtZW1i\nZXIgPSAoRmllbGQpIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAog\nICAgICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXREZWNs\nYXJlZEZpZWxkQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbWV0YS5nZXREZXNjcmliZWRUeXBlKCksIG5hbWUpKTsKICAgICAgICAgICAg\nICAgICAgICB0eXBlID0gKChGaWVsZCkgbWVtYmVyKS5nZXRUeXBlKCk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFByaXZp\nbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgZSA9\nICgoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9u\nKCk7CiAgICAgICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5n\nZXQoImludmFsaWQtYXR0ciIsIG5hbWUsIG1ldGEpLCBlKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgaWYgKGZpZWxkID09IG51bGwpIHsKICAgICAg\nICAgICAgICAgIGZpZWxkID0gbWV0YS5hZGREZWNsYXJlZEZpZWxkKG5hbWUs\nIHR5cGUpOwogICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURl\nZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkKTsKICAgICAgICAgICAgICAg\nIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNjYWRlTm9uZShm\naWVsZC5nZXRLZXkoKSk7CiAgICAgICAgICAgICAgICBQZXJzaXN0ZW5jZU1l\ndGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0RWxlbWVu\ndCgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmaWVsZC5iYWNraW5n\nTWVtYmVyKG1lbWJlcik7CiAgICAgICAgfSBlbHNlIGlmIChmaWVsZCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIGZpZWxkID0gbWV0YS5hZGREZWNsYXJlZEZp\nZWxkKG5hbWUsIE9iamVjdC5jbGFzcyk7CiAgICAgICAgICAgIFBlcnNpc3Rl\nbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNjYWRlTm9uZShmaWVsZCk7CiAg\nICAgICAgICAgIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNj\nYWRlTm9uZShmaWVsZC5nZXRLZXkoKSk7CiAgICAgICAgICAgIFBlcnNpc3Rl\nbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNjYWRlTm9uZShmaWVsZC5nZXRF\nbGVtZW50KCkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzTWV0YURhdGFN\nb2RlKCkpCiAgICAgICAgICAgIGZpZWxkLnNldExpc3RpbmdJbmRleChfZmll\nbGRQb3MpOwoKICAgICAgICBfZmllbGRQb3MrKzsKICAgICAgICBwdXNoRWxl\nbWVudChmaWVsZCk7CiAgICAgICAgYWRkQ29tbWVudHMoZmllbGQpOwoKICAg\nICAgICBpZiAoaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAg\nIHN0YXJ0RmllbGRNYXBwaW5nKGZpZWxkLCBhdHRycyk7CiAgICAgICAgcmV0\ndXJuIGZpZWxkOwogICAgfQoKICAgIC8qKgogICAgICogUG9wcyBmaWVsZCBl\nbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZmluaXNoRmllbGQo\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxk\nTWV0YURhdGEgZmllbGQgPSAoRmllbGRNZXRhRGF0YSkgcG9wRWxlbWVudCgp\nOwogICAgICAgIHNldENhc2NhZGVzKGZpZWxkKTsKICAgICAgICBpZiAoaXNN\nYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgIGVuZEZpZWxkTWFw\ncGluZyhmaWVsZCk7CiAgICAgICAgX3N0cmF0ZWd5ID0gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0byBhZGQgZmllbGQgbWFwcGlu\nZyBkYXRhLiBEb2VzIG5vdGhpbmcgYnkgZGVmYXVsdC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgc3RhcnRGaWVsZE1hcHBpbmcoRmllbGRNZXRhRGF0\nYSBmaWVsZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0\nbyBmaW5hbGl6ZSBmaWVsZCBtYXBwaW5nLiBEb2VzIG5vdGhpbmcgYnkgZGVm\nYXVsdC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZW5kRmllbGRNYXBw\naW5nKEZpZWxkTWV0YURhdGEgZmllbGQpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB2ZXJzaW9u\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFZlcnNpb24o\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IHBhcnNlRmllbGQoYXR0\ncnMpOwogICAgICAgIGZtZC5zZXRFeHBsaWNpdCh0cnVlKTsKICAgICAgICBm\nbWQuc2V0VmVyc2lvbih0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRWZXJzaW9uKCkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5pc2hGaWVsZCgpOwog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugc3RyYXRlZ3kgZWxlbWVudC4K\nICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0U3RyYXRlZ3koUGVy\nc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSwKICAgICAgICBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIEZpZWxkTWV0YURhdGEgZm1kID0gcGFyc2VGaWVsZChhdHRycyk7CiAgICAg\nICAgZm1kLnNldEV4cGxpY2l0KHRydWUpOwogICAgICAgIGZtZC5zZXRNYW5h\nZ2VtZW50KEZpZWxkTWV0YURhdGEuTUFOQUdFX1BFUlNJU1RFTlQpOwoKICAg\nICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImZldGNoIik7CiAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuc2V0SW5E\nZWZhdWx0RmV0Y2hHcm91cCgiRUFHRVIiLmVxdWFscyh2YWwpKTsKICAgICAg\nICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgib3B0aW9uYWwiKTsKICAgICAgICBp\nZiAoImZhbHNlIi5lcXVhbHModmFsKSkKICAgICAgICAgICAgZm1kLnNldE51\nbGxWYWx1ZShGaWVsZE1ldGFEYXRhLk5VTExfRVhDRVBUSU9OKTsKICAgICAg\nICBlbHNlIGlmICgidHJ1ZSIuZXF1YWxzKHZhbCkKICAgICAgICAgICAgICAg\nICYmIGZtZC5nZXROdWxsVmFsdWUoKSA9PSBGaWVsZE1ldGFEYXRhLk5VTExf\nRVhDRVBUSU9OKSB7CiAgICAgICAgICAgIC8vIFJlc2V0IHZhbHVlIGlmIHRo\nZSBmaWVsZCB3YXMgYW5ub3RhdGVkIHdpdGggb3B0aW9uYWw9ZmFsc2UuIAog\nICAgICAgICAgICAvLyBPdGhlcndpc2UgbGVhdmUgaXQgYWxvbmUuCiAgICAg\nICAgICAgIGZtZC5zZXROdWxsVmFsdWUoRmllbGRNZXRhRGF0YS5OVUxMX1VO\nU0VUKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJyaWRl\nTW9kZSgpKSB7CiAgICAgICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJt\nYXBwZWQtYnkiKTsKICAgICAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAg\nICAgICAgICAgICAgZm1kLnNldE1hcHBlZEJ5KHZhbCk7CiAgICAgICAgfQog\nICAgICAgIHBhcnNlU3RyYXRlZ3koZm1kLCBzdHJhdGVneSwgYXR0cnMpOwog\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBl\nbmRTdHJhdGVneShQZXJzaXN0ZW5jZVN0cmF0ZWd5IHN0cmF0ZWd5KQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGZpbmlzaEZpZWxk\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBzdHJhdGVneSBzcGVj\naWZpYyBhdHRyaWJ1dGVzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFy\nc2VTdHJhdGVneShGaWVsZE1ldGFEYXRhIGZtZCwKICAgICAgICBQZXJzaXN0\nZW5jZVN0cmF0ZWd5IHN0cmF0ZWd5LCBBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHN3aXRjaCAoc3Ry\nYXRlZ3kpIHsKICAgICAgICAgICAgY2FzZSBCQVNJQzoKICAgICAgICAgICAg\nICAgIHBhcnNlQmFzaWMoZm1kLCBhdHRycyk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBFTUJFRERFRDoKICAgICAgICAgICAg\nICAgIHBhcnNlRW1iZWRkZWQoZm1kLCBhdHRycyk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBPTkVfT05FOgogICAgICAgICAg\nICAgICAgcGFyc2VPbmVUb09uZShmbWQsIGF0dHJzKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE1BTllfT05FOgogICAgICAg\nICAgICAgICAgcGFyc2VNYW55VG9PbmUoZm1kLCBhdHRycyk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBNQU5ZX01BTlk6CiAg\nICAgICAgICAgICAgICBwYXJzZU1hbnlUb01hbnkoZm1kLCBhdHRycyk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPTkVfTUFO\nWToKICAgICAgICAgICAgICAgIHBhcnNlT25lVG9NYW55KGZtZCwgYXR0cnMp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVFJB\nTlNJRU5UOgogICAgICAgICAgICAgICAgZm1kLnNldE1hbmFnZW1lbnQoRmll\nbGRNZXRhRGF0YS5NQU5BR0VfTk9ORSk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBiYXNp\nYy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VCYXNpYyhGaWVs\nZE1ldGFEYXRhIGZtZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIGVtYmVkZGVkLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZUVt\nYmVkZGVkKEZpZWxkTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGFzc2VydFBD\nKGZtZCwgIkVtYmVkZGVkIik7CiAgICAgICAgZm1kLnNldEVtYmVkZGVkKHRy\ndWUpOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3Zl\ncnJpZGUgYW55IExvYiBhbm5vdGF0aW9uCiAgICAgICAgaWYgKGZtZC5nZXRF\nbWJlZGRlZE1ldGFEYXRhKCkgPT0gbnVsbCkKICAgICAgICAgICAgZm1kLmFk\nZEVtYmVkZGVkTWV0YURhdGEoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\ncm93IHByb3BlciBleGNlcHRpb24gaWYgZ2l2ZW4gdmFsdWUgaXMgbm90IHBv\nc3NpYmx5IHBlcnNpc3RlbmNlCiAgICAgKiBjYXBhYmxlLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgYXNzZXJ0UEMoRmllbGRNZXRhRGF0YSBmbWQsIFN0\ncmluZyBhdHRyKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIGlmICghSmF2YVR5cGVzLm1heWJlUEMoZm1kKSkKICAgICAgICAgICAg\ndGhyb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbWV0YS1hbm5vIiwg\nZm1kLCBhdHRyKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBvbmUt\ndG8tb25lLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZU9uZVRv\nT25lKEZpZWxkTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFN0cmluZyB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgidGFyZ2V0LWVudGl0eSIpOwogICAgICAgIGlm\nICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLnNldFR5cGVPdmVycmlk\nZShjbGFzc0Zvck5hbWUodmFsKSk7CiAgICAgICAgYXNzZXJ0UEMoZm1kLCAi\nT25lVG9PbmUiKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxzZSk7\nIC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgogICAgICAgIGlmICgh\nZm1kLmlzRGVmYXVsdEZldGNoR3JvdXBFeHBsaWNpdCgpKQogICAgICAgICAg\nICBmbWQuc2V0SW5EZWZhdWx0RmV0Y2hHcm91cCh0cnVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIG1hbnktdG8tb25lLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBwYXJzZU1hbnlUb09uZShGaWVsZE1ldGFEYXRhIGZt\nZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRh\ncmdldC1lbnRpdHkiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAg\nICAgICAgIGZtZC5zZXRUeXBlT3ZlcnJpZGUoY2xhc3NGb3JOYW1lKHZhbCkp\nOwogICAgICAgIGFzc2VydFBDKGZtZCwgIk1hbnlUb09uZSIpOwogICAgICAg\nIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJpZGUgYW55IExv\nYiBhbm5vdGF0aW9uCiAgICAgICAgaWYgKCFmbWQuaXNEZWZhdWx0RmV0Y2hH\ncm91cEV4cGxpY2l0KCkpCiAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRG\nZXRjaEdyb3VwKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\nbWFueS10by1tYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJz\nZU1hbnlUb01hbnkoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3Ry\naW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuZ2V0RWxl\nbWVudCgpLnNldERlY2xhcmVkVHlwZShjbGFzc0Zvck5hbWUodmFsKSk7CiAg\nICAgICAgYXNzZXJ0UENDb2xsZWN0aW9uKGZtZCwgIk1hbnlUb01hbnkiKTsK\nICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxzZSk7IC8vIG92ZXJyaWRl\nIExvYiBpbiBhbm5vdGF0aW9uCiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJv\ndyBleGNlcHRpb24gaWYgZ2l2ZW4gZmllbGQgbm90IGEgY29sbGVjdGlvbiBv\nZiBwb3NzaWJsZSBwZXJzaXN0ZW5jZQogICAgICogY2FwYWJsZXMuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBhc3NlcnRQQ0NvbGxlY3Rpb24oRmllbGRN\nZXRhRGF0YSBmbWQsIFN0cmluZyBhdHRyKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIHN3aXRjaCAoZm1kLmdldERlY2xhcmVkVHlw\nZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgaWYg\nKEphdmFUeXBlcy5tYXliZVBDKGZtZC5nZXRFbGVtZW50KCkpKQogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgLy8gbm8gYnJl\nYWsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRocm93\nIGdldEV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLW1ldGEtYW5ubyIsIGZtZCwg\nYXR0cikpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIG9uZS10by1tYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJz\nZU9uZVRvTWFueShGaWVsZE1ldGFEYXRhIGZtZCwgQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJp\nbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdldC1lbnRpdHkiKTsKICAg\nICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGZtZC5nZXRFbGVt\nZW50KCkuc2V0RGVjbGFyZWRUeXBlKGNsYXNzRm9yTmFtZSh2YWwpKTsKICAg\nICAgICBhc3NlcnRQQ0NvbGxlY3Rpb24oZm1kLCAiT25lVG9NYW55Iik7CiAg\nICAgICAgZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBh\nbnkgTG9iIGFubm90YXRpb24KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIG1hcC1rZXkuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydE1h\ncEtleShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgRmllbGRNZXRh\nRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsK\nICAgICAgICBTdHJpbmcgbWFwS2V5ID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUi\nKTsKICAgICAgICBpZiAobWFwS2V5ID09IG51bGwpCiAgICAgICAgICAgIGZt\nZC5nZXRLZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KFZhbHVlTWV0YURhdGEuTUFQ\nUEVEX0JZX1BLKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZtZC5nZXRL\nZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KG1hcEtleSk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBvcmRlci1ieS4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZE9yZGVyQnkoKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxkTWV0YURhdGEg\nZm1kID0gKEZpZWxkTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAg\nICAgU3RyaW5nIGRlYyA9IGN1cnJlbnRUZXh0KCk7CiAgICAgICAgaWYgKFN0\ncmluZ1V0aWxzLmlzRW1wdHkoZGVjKSkKICAgICAgICAgICAgZGVjID0gT3Jk\nZXIuRUxFTUVOVCArICIgYXNjIjsKICAgICAgICBmbWQuc2V0T3JkZXJEZWNs\nYXJhdGlvbihkZWMpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgbmFt\nZWQtcXVlcnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0\nTmFtZWRRdWVyeShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNRdWVyeU1vZGUoKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgbmFtZSA9\nIGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9IGdl\ndExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAg\nICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1xdWVyeSIsIG5h\nbWUpKTsKCiAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRhID0gZ2V0UmVwb3Np\ndG9yeSgpLmdldENhY2hlZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFtZSk7CiAg\nICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBsb2cuaXNXYXJuRW5hYmxlZCgp\nKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgib3ZlcnJpZGUtcXVl\ncnkiLCBuYW1lLCBjdXJyZW50TG9jYXRpb24oKSkpOwoKICAgICAgICBtZXRh\nID0gZ2V0UmVwb3NpdG9yeSgpLmFkZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFt\nZSk7CiAgICAgICAgbWV0YS5zZXREZWZpbmluZ1R5cGUoX2Nscyk7CiAgICAg\nICAgbWV0YS5zZXRRdWVyeVN0cmluZyhhdHRycy5nZXRWYWx1ZSgicXVlcnki\nKSk7CiAgICAgICAgbWV0YS5zZXRMYW5ndWFnZShKUFFMUGFyc2VyLkxBTkdf\nSlBRTCk7CiAgICAgICAgTG9jYXRvciBsb2NhdG9yID0gZ2V0TG9jYXRpb24o\nKS5nZXRMb2NhdG9yKCk7CiAgICAgICAgaWYgKGxvY2F0b3IgIT0gbnVsbCkg\newogICAgICAgICAgICBtZXRhLnNldExpbmVOdW1iZXIoTnVtYmVycy52YWx1\nZU9mKGxvY2F0b3IuZ2V0TGluZU51bWJlcigpKSk7CiAgICAgICAgICAgIG1l\ndGEuc2V0Q29sTnVtYmVyKE51bWJlcnMudmFsdWVPZihsb2NhdG9yLmdldENv\nbHVtbk51bWJlcigpKSk7CiAgICAgICAgfQogICAgICAgIE9iamVjdCBjdXIg\nPSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIE9iamVjdCBzY29wZSA9IChj\ndXIgaW5zdGFuY2VvZiBDbGFzc01ldGFEYXRhKQogICAgICAgICAgICA/ICgo\nQ2xhc3NNZXRhRGF0YSkgY3VyKS5nZXREZXNjcmliZWRUeXBlKCkgOiBudWxs\nOwogICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2Nv\ncGUsIG1ldGEuU1JDX1hNTCk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2Rl\nKCkpCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01FVEEp\nOwogICAgICAgIGVsc2UgaWYgKGlzTWFwcGluZ01vZGUoKSkKICAgICAgICAg\nICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUFQUElORyk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9RVUVS\nWSk7CiAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kTmFtZWRRdWVy\neSgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9w\nRWxlbWVudCgpOwogICAgfQoKICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0\nUXVlcnlTdHJpbmcoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBlbmRRdWVyeVN0cmluZygpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRh\nID0gKFF1ZXJ5TWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAg\nbWV0YS5zZXRRdWVyeVN0cmluZyhjdXJyZW50VGV4dCgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIHF1ZXJ5LWhpbnQuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBib29sZWFuIHN0YXJ0UXVlcnlIaW50KEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgUXVl\ncnlNZXRhRGF0YSBtZXRhID0gKFF1ZXJ5TWV0YURhdGEpIGN1cnJlbnRFbGVt\nZW50KCk7CiAgICAgICAgbWV0YS5hZGRIaW50KGF0dHJzLmdldFZhbHVlKCJu\nYW1lIiksIGF0dHJzLmdldFZhbHVlKCJ2YWx1ZSIpKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRRdWVyeUhp\nbnQoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgbmF0aXZlLW5hbWVkLXF1ZXJ5LgogICAgICov\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydE5hbWVkTmF0aXZlUXVlcnko\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIWlzUXVlcnlNb2RlKCkpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKCiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRW\nYWx1ZSgibmFtZSIpOwogICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAg\nICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxv\nZy50cmFjZShfbG9jLmdldCgicGFyc2UtbmF0aXZlLXF1ZXJ5IiwgbmFtZSkp\nOwoKICAgICAgICBRdWVyeU1ldGFEYXRhIG1ldGEgPSBnZXRSZXBvc2l0b3J5\nKCkuZ2V0Q2FjaGVkUXVlcnlNZXRhRGF0YShudWxsLCBuYW1lKTsKICAgICAg\nICBpZiAobWV0YSAhPSBudWxsICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAg\nICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJvdmVycmlkZS1xdWVyeSIs\nIG5hbWUsIGN1cnJlbnRMb2NhdGlvbigpKSk7CgogICAgICAgIG1ldGEgPSBn\nZXRSZXBvc2l0b3J5KCkuYWRkUXVlcnlNZXRhRGF0YShudWxsLCBuYW1lKTsK\nICAgICAgICBtZXRhLnNldERlZmluaW5nVHlwZShfY2xzKTsKICAgICAgICBt\nZXRhLnNldFF1ZXJ5U3RyaW5nKGF0dHJzLmdldFZhbHVlKCJxdWVyeSIpKTsK\nICAgICAgICBtZXRhLnNldExhbmd1YWdlKFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdf\nU1FMKTsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInJl\nc3VsdC1jbGFzcyIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkgewogICAg\nICAgICAgICBDbGFzcyB0eXBlID0gY2xhc3NGb3JOYW1lKHZhbCk7CiAgICAg\nICAgICAgIGlmIChJbXBsSGVscGVyLmlzTWFuYWdlZFR5cGUoZ2V0Q29uZmln\ndXJhdGlvbigpLCB0eXBlKSkKICAgICAgICAgICAgICAgIG1ldGEuc2V0Q2Fu\nZGlkYXRlVHlwZSh0eXBlKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgbWV0YS5zZXRSZXN1bHRUeXBlKHR5cGUpOwogICAgICAgIH0KCiAg\nICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInJlc3VsdC1zZXQtbWFwcGlu\nZyIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgbWV0\nYS5zZXRSZXN1bHRTZXRNYXBwaW5nTmFtZSh2YWwpOwoKICAgICAgICBPYmpl\nY3QgY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2Nv\ncGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAg\nICAgPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgp\nIDogbnVsbDsKICAgICAgICBtZXRhLnNldFNvdXJjZShnZXRTb3VyY2VGaWxl\nKCksIHNjb3BlLCBtZXRhLlNSQ19YTUwpOwogICAgICAgIExvY2F0b3IgbG9j\nYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwogICAgICAgIGlm\nIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgbWV0YS5zZXRMaW5l\nTnVtYmVyKE51bWJlcnMudmFsdWVPZihsb2NhdG9yLmdldExpbmVOdW1iZXIo\nKSkpOwogICAgICAgICAgICBtZXRhLnNldENvbE51bWJlcihOdW1iZXJzLnZh\nbHVlT2YobG9jYXRvci5nZXRDb2x1bW5OdW1iZXIoKSkpOwogICAgICAgIH0K\nICAgICAgICBpZiAoaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgbWV0\nYS5zZXRTb3VyY2VNb2RlKE1PREVfTUVUQSk7CiAgICAgICAgZWxzZSBpZiAo\naXNNYXBwaW5nTW9kZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1v\nZGUoTU9ERV9NQVBQSU5HKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG1l\ndGEuc2V0U291cmNlTW9kZShNT0RFX1FVRVJZKTsKICAgICAgICBwdXNoRWxl\nbWVudChtZXRhKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmROYW1lZE5hdGl2ZVF1ZXJ5KCkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBwb3BFbGVtZW50KCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTdGFydCBlbnRpdHktbGlzdGVuZXJzCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEVudGl0eUxpc3RlbmVy\ncyhBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChjdXJyZW50RWxlbWVudCgp\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAv\nLyByZXNldCBsaXN0ZW5lcnMgZGVjbGFyZWQgaW4gYW5ub3RhdGlvbnMuCiAg\nICAgICAgTGlmZWN5Y2xlTWV0YURhdGEgbWV0YSA9ICgoQ2xhc3NNZXRhRGF0\nYSkgY3VycmVudEVsZW1lbnQoKSkuCiAgICAgICAgICAgIGdldExpZmVjeWNs\nZU1ldGFEYXRhKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBMaWZl\nY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICBtZXRhLnNldERlY2xhcmVkQ2FsbGJhY2tzKGksIG51bGwsIDApOwogICAg\nICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\nZXhjbHVkZS1kZWZhdWx0LWxpc3RlbmVycy4KICAgICAqLwogICAgcHJpdmF0\nZSBib29sZWFuIHN0YXJ0RXhjbHVkZURlZmF1bHRMaXN0ZW5lcnMoQXR0cmli\ndXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSAoQ2xhc3NN\nZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBtZXRhLmdldExp\nZmVjeWNsZU1ldGFEYXRhKCkuc2V0SWdub3JlU3lzdGVtTGlzdGVuZXJzKHRy\ndWUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2UgZXhjbHVkZS1zdXBlcmNsYXNzLWxpc3RlbmVycy4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0RXhjbHVkZVN1cGVyY2xhc3NM\naXN0ZW5lcnMoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkpCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBDbGFzc01ldGFEYXRh\nIG1ldGEgPSAoQ2xhc3NNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAg\nICAgICBtZXRhLmdldExpZmVjeWNsZU1ldGFEYXRhKCkuc2V0SWdub3JlU3Vw\nZXJjbGFzc0NhbGxiYWNrcwogICAgICAgICAgICAoTGlmZWN5Y2xlTWV0YURh\ndGEuSUdOT1JFX0hJR0gpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgZW50aXR5LWxpc3RlbmVyLgogICAgICov\nCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRFbnRpdHlMaXN0ZW5lcihBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIF9saXN0ZW5lciA9IGNsYXNzRm9yTmFtZShhdHRycy5nZXRWYWx1\nZSgiY2xhc3MiKSk7CiAgICAgICAgYm9vbGVhbiBzeXN0ZW0gPSBjdXJyZW50\nRWxlbWVudCgpID09IG51bGw7CiAgICAgICAgQ29sbGVjdGlvbjxMaWZlY3lj\nbGVDYWxsYmFja3M+W10gcGFyc2VkID0KICAgICAgICAgICAgQW5ub3RhdGlv\nblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIucGFyc2VDYWxsYmFja01ldGhv\nZHMoX2xpc3RlbmVyLAogICAgICAgICAgICAgICAgbnVsbCwgdHJ1ZSwgdHJ1\nZSwgX3JlcG9zKTsKICAgICAgICBpZiAocGFyc2VkID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBpZiAoX2NhbGxiYWNrcyA9\nPSBudWxsKSB7CiAgICAgICAgICAgIF9jYWxsYmFja3MgPSAoQ29sbGVjdGlv\nbjxMaWZlY3ljbGVDYWxsYmFja3M+W10pCiAgICAgICAgICAgICAgICBuZXcg\nQ29sbGVjdGlvbltMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0aF07\nCiAgICAgICAgICAgIGlmICghc3lzdGVtKQogICAgICAgICAgICAgICAgX2hp\nZ2hzID0gbmV3IGludFtMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0\naF07CiAgICAgICAgfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGFy\nc2VkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChwYXJzZWRbaV0g\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICBpZiAoX2NhbGxiYWNrc1tpXSA9PSBudWxsKQogICAgICAgICAgICAgICAg\nX2NhbGxiYWNrc1tpXSA9IHBhcnNlZFtpXTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tpXS5hZGRBbGwocGFyc2VkW2ld\nKTsKICAgICAgICAgICAgaWYgKCFzeXN0ZW0pCiAgICAgICAgICAgICAgICBf\naGlnaHNbaV0gKz0gcGFyc2VkW2ldLnNpemUoKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGVuZEVu\ndGl0eUxpc3RlbmVyKCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICAvLyBzaG91bGQgYmUgaW4gZW5kRW50aXR5TGlzdGVuZXJzIEkg\ndGhpbmsgdG8gbWVyZ2UgY2FsbGJhY2tzCiAgICAgICAgLy8gaW50byBhIHNp\nbmdsZSBsaXN0ZW5lci4gIEJ1dCB0aGVuIHRoZSB1c2VyIGNhbm5vdCByZW1v\ndmUuCiAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbCAmJiBf\nY2FsbGJhY2tzICE9IG51bGwpIHsKICAgICAgICAgICAgX3JlcG9zLmFkZFN5\nc3RlbUxpc3RlbmVyKG5ldyBQZXJzaXN0ZW5jZUxpc3RlbmVyQWRhcHRlcgog\nICAgICAgICAgICAgICAgKF9jYWxsYmFja3MpKTsKICAgICAgICAgICAgX2Nh\nbGxiYWNrcyA9IG51bGw7CiAgICAgICAgfQogICAgICAgIF9saXN0ZW5lciA9\nIG51bGw7CiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Q2FsbGJh\nY2soTWV0YURhdGFUYWcgY2FsbGJhY2ssIEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01l\ndGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgaW50W10gZXZlbnRzID0gTWV0YURhdGFQYXJzZXJzLmdldEV2ZW50VHlw\nZXMoY2FsbGJhY2spOwogICAgICAgIGlmIChldmVudHMgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBib29sZWFuIHN5c3Rl\nbSA9IGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbDsKICAgICAgICBDbGFzcyB0\neXBlID0gY3VycmVudEVsZW1lbnQoKSA9PSBudWxsID8gbnVsbCA6CiAgICAg\nICAgICAgICgoQ2xhc3NNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKSkuZ2V0\nRGVzY3JpYmVkVHlwZSgpOwogICAgICAgIGlmICh0eXBlID09IG51bGwpCiAg\nICAgICAgICAgIHR5cGUgPSBPYmplY3QuY2xhc3M7CgogICAgICAgIGlmIChf\nY2FsbGJhY2tzID09IG51bGwpIHsKICAgICAgICAgICAgX2NhbGxiYWNrcyA9\nIChDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSkKICAgICAgICAg\nICAgICAgIG5ldyBDb2xsZWN0aW9uW0xpZmVjeWNsZUV2ZW50LkFMTF9FVkVO\nVFMubGVuZ3RoXTsKICAgICAgICAgICAgaWYgKCFzeXN0ZW0pCiAgICAgICAg\nICAgICAgICBfaGlnaHMgPSBuZXcgaW50W0xpZmVjeWNsZUV2ZW50LkFMTF9F\nVkVOVFMubGVuZ3RoXTsKICAgICAgICB9CgogICAgICAgIE1ldGFEYXRhRGVm\nYXVsdHMgZGVmID0gX3JlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdldERl\nZmF1bHRzKCk7CiAgICAgICAgTGlmZWN5Y2xlQ2FsbGJhY2tzIGFkYXB0ZXI7\nCiAgICAgICAgaWYgKF9saXN0ZW5lciAhPSBudWxsKQogICAgICAgICAgICBh\nZGFwdGVyID0gbmV3IEJlYW5MaWZlY3ljbGVDYWxsYmFja3MoX2xpc3RlbmVy\nLAogICAgICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoIm1ldGhvZC1uYW1l\nIiksIGZhbHNlLCB0eXBlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGFk\nYXB0ZXIgPSBuZXcgTWV0aG9kTGlmZWN5Y2xlQ2FsbGJhY2tzKF9jbHMsCiAg\nICAgICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgibWV0aG9kLW5hbWUiKSwg\nZmFsc2UpOwoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGV2ZW50cy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICBpbnQgZXZlbnQgPSBldmVudHNb\naV07CiAgICAgICAgICAgIGlmIChfbGlzdGVuZXIgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgTWV0YURhdGFQYXJzZXJzLnZhbGlkYXRlTWV0aG9kc0Zv\nclNhbWVDYWxsYmFjayhfbGlzdGVuZXIsCiAgICAgICAgICAgICAgICAgICAg\nX2NhbGxiYWNrc1tldmVudF0sICgoQmVhbkxpZmVjeWNsZUNhbGxiYWNrcykg\nYWRhcHRlcikuCiAgICAgICAgICAgICAgICAgICAgZ2V0Q2FsbGJhY2tNZXRo\nb2QoKSwgY2FsbGJhY2ssIGRlZiwgZ2V0TG9nKCkpOwogICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgTWV0YURhdGFQYXJzZXJzLnZhbGlk\nYXRlTWV0aG9kc0ZvclNhbWVDYWxsYmFjayhfY2xzLAogICAgICAgICAgICAg\nICAgICAgIF9jYWxsYmFja3NbZXZlbnRdLCAoKE1ldGhvZExpZmVjeWNsZUNh\nbGxiYWNrcykgYWRhcHRlcikuCiAgICAgICAgICAgICAgICAgICAgZ2V0Q2Fs\nbGJhY2tNZXRob2QoKSwgY2FsbGJhY2ssIGRlZiwgZ2V0TG9nKCkpOwoKICAg\nICAgICAgICAgfQogICAgICAgICAgICBpZiAoX2NhbGxiYWNrc1tldmVudF0g\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jYWxsYmFja3NbZXZlbnRdID0g\nbmV3IEFycmF5TGlzdDxMaWZlY3ljbGVDYWxsYmFja3M+KDMpOwogICAgICAg\nICAgICBfY2FsbGJhY2tzW2V2ZW50XS5hZGQoYWRhcHRlcik7CiAgICAgICAg\nICAgIGlmICghc3lzdGVtICYmIF9saXN0ZW5lciAhPSBudWxsKQogICAgICAg\nICAgICAgICAgX2hpZ2hzW2V2ZW50XSsrOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlIGxpZmVj\neWNsZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHN0b3Jl\nQ2FsbGJhY2tzKENsYXNzTWV0YURhdGEgY2xzKSB7CiAgICAgICAgTGlmZWN5\nY2xlTWV0YURhdGEgbWV0YSA9IGNscy5nZXRMaWZlY3ljbGVNZXRhRGF0YSgp\nOwogICAgICAgIENsYXNzIHN1cENscyA9IGNscy5nZXREZXNjcmliZWRUeXBl\nKCkuZ2V0U3VwZXJjbGFzcygpOwogICAgICAgIENvbGxlY3Rpb248TGlmZWN5\nY2xlQ2FsbGJhY2tzPltdIHN1cENhbGxzID0gbnVsbDsKICAgICAgICBpZiAo\nIU9iamVjdC5jbGFzcy5lcXVhbHMoc3VwQ2xzKSkgewogICAgICAgICAgICBz\ndXBDYWxscyA9IEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2Vy\nLnBhcnNlQ2FsbGJhY2tNZXRob2RzCiAgICAgICAgICAgICAgICAoc3VwQ2xz\nLCBudWxsLCB0cnVlLCBmYWxzZSwgX3JlcG9zKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKHN1cENhbGxzICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChp\nbnQgZXZlbnQgOiBMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTKSB7CiAgICAg\nICAgICAgICAgICBpZiAoc3VwQ2FsbHNbZXZlbnRdID09IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICBtZXRh\nLnNldE5vblBDU3VwZXJjbGFzc0NhbGxiYWNrcyhldmVudCwgc3VwQ2FsbHNb\nZXZlbnRdLnRvQXJyYXkKICAgICAgICAgICAgICAgICAgICAobmV3IExpZmVj\neWNsZUNhbGxiYWNrc1tzdXBDYWxsc1tldmVudF0uc2l6ZSgpXSksIDApOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChfY2FsbGJhY2tz\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgZm9yIChp\nbnQgZXZlbnQgOiBMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTKSB7CiAgICAg\nICAgICAgIGlmIChfY2FsbGJhY2tzW2V2ZW50XSA9PSBudWxsKQogICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIG1ldGEuc2V0RGVjbGFy\nZWRDYWxsYmFja3MoZXZlbnQsIChMaWZlY3ljbGVDYWxsYmFja3NbXSkKICAg\nICAgICAgICAgICAgIF9jYWxsYmFja3NbZXZlbnRdLnRvQXJyYXkKICAgICAg\nICAgICAgICAgICAgICAobmV3IExpZmVjeWNsZUNhbGxiYWNrc1tfY2FsbGJh\nY2tzW2V2ZW50XS5zaXplKCldKSwKICAgICAgICAgICAgICAgIF9oaWdoc1tl\ndmVudF0pOwogICAgICAgIH0KICAgICAgICBfY2FsbGJhY2tzID0gbnVsbDsK\nICAgICAgICBfaGlnaHMgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nSW5zdGFudGlhdGUgdGhlIGdpdmVuIGNsYXNzLCB0YWtpbmcgaW50byBhY2Nv\ndW50IHRoZSBkZWZhdWx0IHBhY2thZ2UuCgkgKi8KCXByb3RlY3RlZCBDbGFz\ncyBjbGFzc0Zvck5hbWUoU3RyaW5nIG5hbWUpCgkJdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CgkJaWYgKCJFbnRpdHkiLmVxdWFscyhuYW1lKSkKCQkJcmV0dXJu\nIFBlcnNpc3RlbmNlQ2FwYWJsZS5jbGFzczsKCQlyZXR1cm4gc3VwZXIuY2xh\nc3NGb3JOYW1lKG5hbWUsIGlzUnVudGltZSgpKTsKCX0KfQo=\n","encoding":"base64"}

