{"sha":"c76f1f6afbc55763620149a48d5464c1139aee0e","node_id":"MDQ6QmxvYjIwNjM2NDpjNzZmMWY2YWZiYzU1NzYzNjIwMTQ5YTQ4ZDU0NjRjMTEzOWFlZTBl","size":48908,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c76f1f6afbc55763620149a48d5464c1139aee0e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmll\nbGQ7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZW1iZXI7CmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5NZXRob2Q7CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25z\nOwppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7CmltcG9ydCBqYXZhLnV0\naWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0\nIGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0\nIGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5TGFuZ3VhZ2VzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLkNGTWV0YURhdGFTZXJpYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLlNvdXJjZVRy\nYWNrZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSmF2\nYVZlcnNpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNs\nYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0\nYURhdGFJbmhlcml0YW5jZUNvbXBhcmF0b3I7CmltcG9ydCBzdGF0aWMgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rlcy4qOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuT3JkZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5RdWVyeU1ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuU2VxdWVuY2VNZXRhRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy54bWwuc2F4LlNBWEV4Y2VwdGlvbjsKaW1wb3J0IHNl\ncnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIFNlcmlhbGl6ZXMgcGVyc2lzdGVu\nY2UgbWV0YWRhdGEgYmFjayB0byBYTUwuCiAqIFRoaXMgY2xhc3MgcHJvY2Vz\nc2VzIGFsbCBvYmplY3QgbGV2ZWwgdGFncyB0aGF0IGFyZSBzdG9yZS1hZ25v\nc3RpYy4KICogSG93ZXZlciwgaXQgcHJvdmlkZXMgaG9va3MgZm9yIHRoZSBz\ndWJjbGFzc2VzIHRvIGluY2x1ZGUgc3RvcmUtc3BlY2lmaWMKICogdGFncyB0\nbyBiZSBzZXJpYWxpemVkIGJvdGggYXQgJmx0O2VudGl0eS1tYXBwaW5ncyZn\ndDsgYW5kCiAqICZsdDtlbnRpdHkmZ3Q7IGxldmVsLgogKgogKiBAc2luY2Ug\nMC40LjAKICogQGF1dGhvciBTdGV2ZSBLaW0KICogQG5vamF2YWRvYwogKi8K\ncHVibGljIGNsYXNzIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFTZXJpYWxpemVy\nCiAgICBleHRlbmRzIENGTWV0YURhdGFTZXJpYWxpemVyCiAgICBpbXBsZW1l\nbnRzIFBlcnNpc3RlbmNlTWV0YURhdGFGYWN0b3J5LlNlcmlhbGl6ZXIgewoK\nICAgIC8vIE5PVEU6IG9yZGVyIGlzIGltcG9ydGFudCEgdGhlc2UgY29uc3Rh\nbnRzIG11c3QgYmUgbWFpbnRhaW5lZCBpbgogICAgLy8gc2VyaWFsaXphdGlv\nbiBvcmRlci4gY29uc3RhbnRzIGFyZSBzcGFjZWQgc28gdGhhdCBzdWJjbGFz\nc2VzIGNhbgogICAgLy8gc2xpcCB0YWdzIGluLWJldHdlZW4KICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgaW50IFRZUEVfU0VRID0gMTA7CiAgICBwcm90\nZWN0ZWQgc3RhdGljIGZpbmFsIGludCBUWVBFX1FVRVJZID0gMjA7CiAgICBw\ncm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBUWVBFX01FVEEgPSAzMDsKICAg\nIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IFRZUEVfQ0xBU1NfU0VRUyA9\nIDQwOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgVFlQRV9DTEFT\nU19RVUVSSUVTID0gNTA7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChY\nTUxQZXJzaXN0ZW5jZU1ldGFEYXRhU2VyaWFsaXplci5jbGFzcyk7CgogICAg\ncHJpdmF0ZSBmaW5hbCBPcGVuSlBBQ29uZmlndXJhdGlvbiBfY29uZjsKICAg\nIHByaXZhdGUgTWFwPFN0cmluZywgQ2xhc3NNZXRhRGF0YT4gX21ldGFzID0g\nbnVsbDsKICAgIHByaXZhdGUgTWFwPFN0cmluZywgTGlzdD4gX3F1ZXJpZXMg\nPSBudWxsOwogICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBMaXN0PiBfc2VxcyA9\nIG51bGw7CiAgICBwcml2YXRlIGludCBfbW9kZSA9IE1PREVfTk9ORTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfYW5ub3MgPSB0cnVlOwogICAgcHJpdmF0ZSBT\nZXJpYWxpemF0aW9uQ29tcGFyYXRvciBfY29tcCA9IG51bGw7CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyBYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhU2VyaWFs\naXplcihPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgX2Nv\nbmYgPSBjb25mOwogICAgICAgIHNldExvZyhjb25mLmdldExvZyhPcGVuSlBB\nQ29uZmlndXJhdGlvbi5MT0dfTUVUQURBVEEpKTsKICAgICAgICBzZXRNb2Rl\nKE1PREVfTUVUQSB8IE1PREVfTUFQUElORyB8IE1PREVfUVVFUlkpOwogICAg\nfQoKICAgIC8qKgogICAgICogQ29uZmlndXJhdGlvbi4KICAgICAqLwogICAg\ncHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF9jb25mOwogICAgfQoKICAgIC8qKgogICAg\nICogV2hldGhlciB0byBzZXJpYWxpemUgY29udGVudCBvcmlnaW5hbGx5IHNw\nZWNpZmllZCBpbiBhbm5vdGF0aW9ucy4KICAgICAqIERlZmF1bHRzIHRvIHRy\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldFNlcmlhbGl6ZUFu\nbm90YXRpb25zKCkgewogICAgICAgIHJldHVybiBfYW5ub3M7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIHNlcmlhbGl6ZSBjb250ZW50IG9y\naWdpbmFsbHkgc3BlY2lmaWVkIGluIGFubm90YXRpb25zLgogICAgICogRGVm\nYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U2Vy\naWFsaXplQW5ub3RhdGlvbnMoYm9vbGVhbiBhbm5vcykgewogICAgICAgIF9h\nbm5vcyA9IGFubm9zOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHNlcmlh\nbGl6YXRpb24gbW9kZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVjdGVkIGRvY3Vt\nZW50IHR5cGUuIFRoZQogICAgICogbW9kZSBjb25zdGFudHMgYWN0IGFzIGJp\ndCBmbGFncywgYW5kIHRoZXJlZm9yZSBjYW4gYmUgY29tYmluZWQuCiAgICAg\nKi8KICAgIHB1YmxpYyBpbnQgZ2V0TW9kZSgpIHsKICAgICAgICByZXR1cm4g\nX21vZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2VyaWFsaXphdGlv\nbiBtb2RlIGFjY29yZGluZyB0byB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQgdHlw\nZS4gVGhlCiAgICAgKiBtb2RlIGNvbnN0YW50cyBhY3QgYXMgYml0IGZsYWdz\nLCBhbmQgdGhlcmVmb3JlIGNhbiBiZSBjb21iaW5lZC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0TW9kZShpbnQgbW9kZSkgewogICAgICAgIF9tb2Rl\nID0gbW9kZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzZXJpYWxpemF0\naW9uIG1vZGUgYWNjb3JkaW5nIHRvIHRoZSBleHBlY3RlZCBkb2N1bWVudCB0\neXBlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNb2RlKGludCBtb2Rl\nLCBib29sZWFuIG9uKSB7CiAgICAgICAgaWYgKG1vZGUgPT0gTU9ERV9OT05F\nKQogICAgICAgICAgICBzZXRNb2RlKE1PREVfTk9ORSk7CiAgICAgICAgZWxz\nZSBpZiAob24pCiAgICAgICAgICAgIHNldE1vZGUoX21vZGUgfCBtb2RlKTsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIHNldE1vZGUoX21vZGUgJiB+bW9k\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBPdmVycmlkZSB0byBub3Qgb3Zl\ncndyaXRlIGFubm90YXRpb25zLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCBGaWxlIGdldFNvdXJjZUZpbGUoT2JqZWN0IG9iaikgewog\nICAgICAgIEZpbGUgZmlsZSA9IHN1cGVyLmdldFNvdXJjZUZpbGUob2JqKTsK\nICAgICAgICBpZiAoZmlsZSA9PSBudWxsIHx8IGZpbGUuZ2V0TmFtZSgpLmVu\nZHNXaXRoKCIuamF2YSIpCiAgICAgICAgICAgIHx8IGZpbGUuZ2V0TmFtZSgp\nLmVuZHNXaXRoKCIuY2xhc3MiKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgcmV0dXJuIGZpbGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb252ZW5pZW5jZSBtZXRob2QgZm9yIGludGVycHJldGluZyB7QGxpbmsgI2dl\ndE1vZGV9LgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc01ldGFE\nYXRhTW9kZSgpIHsKICAgICAgICByZXR1cm4gKF9tb2RlICYgTU9ERV9NRVRB\nKSAhPSAwOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0\naG9kIGZvciBpbnRlcnByZXRpbmcge0BsaW5rICNnZXRNb2RlfS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNRdWVyeU1vZGUoKSB7CiAgICAg\nICAgcmV0dXJuIChfbW9kZSAmIE1PREVfUVVFUlkpICE9IDA7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgZm9yIGludGVycHJl\ndGluZyB7QGxpbmsgI2dldE1vZGV9LgogICAgICovCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBpc01hcHBpbmdNb2RlKCkgewogICAgICAgIHJldHVybiAoX21v\nZGUgJiBNT0RFX01BUFBJTkcpICE9IDA7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZW5pZW5jZSBtZXRob2QgZm9yIGludGVycHJldGluZyB7QGxpbmsg\nI2dldE1vZGV9LiBUYWtlcyBpbnRvCiAgICAgKiBhY2NvdW50IHdoZXRoZXIg\nbWFwcGluZyBpbmZvcm1hdGlvbiBpcyBsb2FkZWQgZm9yIHRoZSBnaXZlbiBp\nbnN0YW5jZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNNYXBw\naW5nTW9kZShDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4g\naXNNYXBwaW5nTW9kZSgpICYmIChtZXRhLmdldFNvdXJjZU1vZGUoKSAmIE1P\nREVfTUFQUElORykgIT0gMAogICAgICAgICAgICAmJiAobWV0YS5nZXRFbWJl\nZGRpbmdNZXRhRGF0YSgpICE9IG51bGwKICAgICAgICAgICAgfHwgIW1ldGEu\naXNFbWJlZGRlZE9ubHkoKSkKICAgICAgICAgICAgJiYgKG1ldGEuZ2V0RW1i\nZWRkaW5nTWV0YURhdGEoKSA9PSBudWxsCiAgICAgICAgICAgIHx8IGlzTWFw\ncGluZ01vZGUobWV0YS5nZXRFbWJlZGRpbmdNZXRhRGF0YSgpKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgZm9yIGludGVy\ncHJldGluZyB7QGxpbmsgI2dldE1vZGV9LiBUYWtlcyBpbnRvCiAgICAgKiBh\nY2NvdW50IHdoZXRoZXIgbWFwcGluZyBpbmZvcm1hdGlvbiBpcyBsb2FkZWQg\nZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gaXNNYXBwaW5nTW9kZShWYWx1ZU1ldGFEYXRhIHZtZCkgewog\nICAgICAgIHJldHVybiBpc01hcHBpbmdNb2RlKHZtZC5nZXRGaWVsZE1ldGFE\nYXRhKCkuZ2V0RGVmaW5pbmdNZXRhRGF0YSgpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFkZCBhIGNsYXNzIG1ldGEgZGF0YSB0byB0aGUgc2V0IHRvIGJl\nIHNlcmlhbGl6ZWQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZE1ldGFE\nYXRhKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIGlmIChtZXRhID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgaWYgKF9tZXRh\ncyA9PSBudWxsKQogICAgICAgICAgICBfbWV0YXMgPSBuZXcgSGFzaE1hcDxT\ndHJpbmcsIENsYXNzTWV0YURhdGE+KCk7CiAgICAgICAgX21ldGFzLnB1dCht\nZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCksIG1ldGEpOwogICAg\nfQoKICAgIC8qKgogICAgICogQWRkIGEgc2VxdWVuY2UgbWV0YSBkYXRhIHRv\nIHRoZSBzZXQgdG8gYmUgc2VyaWFsaXplZC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgYWRkU2VxdWVuY2VNZXRhRGF0YShTZXF1ZW5jZU1ldGFEYXRhIG1l\ndGEpIHsKICAgICAgICBpZiAobWV0YSA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIExpc3Qgc2VxcyA9IG51bGw7CiAgICAgICAgU3Ry\naW5nIGRlZk5hbWUgPSBudWxsOwogICAgICAgIGlmIChtZXRhLmdldFNvdXJj\nZVNjb3BlKCkgaW5zdGFuY2VvZiBDbGFzcykKICAgICAgICAgICAgZGVmTmFt\nZSA9ICgoQ2xhc3MpIG1ldGEuZ2V0U291cmNlU2NvcGUoKSkuZ2V0TmFtZSgp\nOwogICAgICAgIGlmIChfc2VxcyA9PSBudWxsKQogICAgICAgICAgICBfc2Vx\ncyA9IG5ldyBIYXNoTWFwPFN0cmluZywgTGlzdD4oKTsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIHNlcXMgPSBfc2Vxcy5nZXQoZGVmTmFtZSk7CgogICAg\nICAgIGlmIChzZXFzID09IG51bGwpIHsKICAgICAgICAgICAgc2VxcyA9IG5l\ndyBBcnJheUxpc3QoMyk7IC8vIGRvbid0IGV4cGVjdCBtYW55IHNlcXMgLyBj\nbGFzcwogICAgICAgICAgICBzZXFzLmFkZChtZXRhKTsKICAgICAgICAgICAg\nX3NlcXMucHV0KGRlZk5hbWUsIHNlcXMpOwogICAgICAgIH0gZWxzZSBpZiAo\nIXNlcXMuY29udGFpbnMobWV0YSkpCiAgICAgICAgICAgIHNlcXMuYWRkKG1l\ndGEpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgcXVlcnkgbWV0YSBk\nYXRhIHRvIHRoZSBzZXQgdG8gYmUgc2VyaWFsaXplZC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgYWRkUXVlcnlNZXRhRGF0YShRdWVyeU1ldGFEYXRhIG1l\ndGEpIHsKICAgICAgICBpZiAobWV0YSA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIExpc3QgcXVlcmllcyA9IG51bGw7CiAgICAgICAg\nU3RyaW5nIGRlZk5hbWUgPSBudWxsOwogICAgICAgIGlmIChtZXRhLmdldFNv\ndXJjZVNjb3BlKCkgaW5zdGFuY2VvZiBDbGFzcykKICAgICAgICAgICAgZGVm\nTmFtZSA9ICgoQ2xhc3MpIG1ldGEuZ2V0U291cmNlU2NvcGUoKSkuZ2V0TmFt\nZSgpOwogICAgICAgIGlmIChfcXVlcmllcyA9PSBudWxsKQogICAgICAgICAg\nICBfcXVlcmllcyA9IG5ldyBIYXNoTWFwPFN0cmluZywgTGlzdD4oKTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIHF1ZXJpZXMgPSBfcXVlcmllcy5nZXQo\nZGVmTmFtZSk7CgogICAgICAgIGlmIChxdWVyaWVzID09IG51bGwpIHsKICAg\nICAgICAgICAgcXVlcmllcyA9IG5ldyBBcnJheUxpc3QoMyk7IC8vIGRvbid0\nIGV4cGVjdCBtYW55IHF1ZXJpZXMgLyBjbGFzcwogICAgICAgICAgICBxdWVy\naWVzLmFkZChtZXRhKTsKICAgICAgICAgICAgX3F1ZXJpZXMucHV0KGRlZk5h\nbWUsIHF1ZXJpZXMpOwogICAgICAgIH0gZWxzZSBpZiAoIXF1ZXJpZXMuY29u\ndGFpbnMobWV0YSkpCiAgICAgICAgICAgIHF1ZXJpZXMuYWRkKG1ldGEpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIGFsbCBjb21wb25lbnRzIGluIHRo\nZSBnaXZlbiByZXBvc2l0b3J5IHRvIHRoZSBzZXQgdG8gYmUgc2VyaWFsaXpl\nZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgYWRkQWxsKE1ldGFEYXRhUmVw\nb3NpdG9yeSByZXBvcykgewogICAgICAgIGlmIChyZXBvcyA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIGZvciAoQ2xhc3NNZXRhRGF0\nYSBtZXRhIDogcmVwb3MuZ2V0TWV0YURhdGFzKCkpCiAgICAgICAgICAgIGFk\nZE1ldGFEYXRhKG1ldGEpOwogICAgICAgIGZvciAoU2VxdWVuY2VNZXRhRGF0\nYSBzZXEgOiByZXBvcy5nZXRTZXF1ZW5jZU1ldGFEYXRhcygpKQogICAgICAg\nICAgICBhZGRTZXF1ZW5jZU1ldGFEYXRhKHNlcSk7CiAgICAgICAgZm9yIChR\ndWVyeU1ldGFEYXRhIHF1ZXJ5IDogcmVwb3MuZ2V0UXVlcnlNZXRhRGF0YXMo\nKSkKICAgICAgICAgICAgYWRkUXVlcnlNZXRhRGF0YShxdWVyeSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZW1vdmUgYSBtZXRhZGF0YSBmcm9tIHRoZSBz\nZXQgdG8gYmUgc2VyaWFsaXplZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRy\ndWUgaWYgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHNldAogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiByZW1vdmVNZXRhRGF0YShDbGFzc01ldGFEYXRh\nIG1ldGEpIHsKICAgICAgICByZXR1cm4gX21ldGFzICE9IG51bGwgJiYgbWV0\nYSAhPSBudWxsCiAgICAgICAgICAgICYmIF9tZXRhcy5yZW1vdmUobWV0YS5n\nZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpKSAhPSBudWxsOwogICAgfQoK\nICAgIC8qKgogICAgICogUmVtb3ZlIGEgc2VxdWVuY2UgbWV0YWRhdGEgZnJv\nbSB0aGUgc2V0IHRvIGJlIHNlcmlhbGl6ZWQuCiAgICAgKgogICAgICogQHJl\ndHVybiB0cnVlIGlmIHJlbW92ZWQsIGZhbHNlIGlmIG5vdCBpbiBzZXQKICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlU2VxdWVuY2VNZXRhRGF0\nYShTZXF1ZW5jZU1ldGFEYXRhIG1ldGEpIHsKICAgICAgICBpZiAoX3NlcXMg\nPT0gbnVsbCB8fCBtZXRhID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICBTdHJpbmcgZGVmTmFtZSA9IG51bGw7CiAgICAgICAg\naWYgKG1ldGEuZ2V0U291cmNlU2NvcGUoKSBpbnN0YW5jZW9mIENsYXNzKQog\nICAgICAgICAgICBkZWZOYW1lID0gKChDbGFzcykgbWV0YS5nZXRTb3VyY2VT\nY29wZSgpKS5nZXROYW1lKCk7CiAgICAgICAgTGlzdCBzZXFzID0gX3NlcXMu\nZ2V0KGRlZk5hbWUpOwogICAgICAgIGlmIChzZXFzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoIXNlcXMucmVtb3Zl\nKG1ldGEpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYg\nKHNlcXMuaXNFbXB0eSgpKQogICAgICAgICAgICBfc2Vxcy5yZW1vdmUoZGVm\nTmFtZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZW1vdmUgYSBxdWVyeSBtZXRhZGF0YSBmcm9tIHRoZSBzZXQgdG8g\nYmUgc2VyaWFsaXplZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYg\ncmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHNldAogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiByZW1vdmVRdWVyeU1ldGFEYXRhKFF1ZXJ5TWV0YURhdGEg\nbWV0YSkgewogICAgICAgIGlmIChfcXVlcmllcyA9PSBudWxsIHx8IG1ldGEg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIFN0\ncmluZyBkZWZOYW1lID0gbnVsbDsKICAgICAgICBpZiAobWV0YS5nZXRTb3Vy\nY2VTY29wZSgpIGluc3RhbmNlb2YgQ2xhc3MpCiAgICAgICAgICAgIGRlZk5h\nbWUgPSAoKENsYXNzKSBtZXRhLmdldFNvdXJjZVNjb3BlKCkpLmdldE5hbWUo\nKTsKICAgICAgICBMaXN0IHF1ZXJpZXMgPSBfcXVlcmllcy5nZXQoZGVmTmFt\nZSk7CiAgICAgICAgaWYgKHF1ZXJpZXMgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgIGlmICghcXVlcmllcy5yZW1vdmUobWV0\nYSkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAocXVl\ncmllcy5pc0VtcHR5KCkpCiAgICAgICAgICAgIF9xdWVyaWVzLnJlbW92ZShk\nZWZOYW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJlbW92ZSBhbGwgdGhlIGNvbXBvbmVudHMgaW4gdGhlIGdpdmVu\nIHJlcG9zaXRvcnkgZnJvbSB0aGUgc2V0IHRvIGJlCiAgICAgKiBzZXJpYWxp\nemVkLgogICAgICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBhbnkgY29tcG9u\nZW50cyByZW1vdmVkLCBmYWxzZSBpZiBub25lIGluIHNldAogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiByZW1vdmVBbGwoTWV0YURhdGFSZXBvc2l0b3J5\nIHJlcG9zKSB7CiAgICAgICAgaWYgKHJlcG9zID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgYm9vbGVhbiByZW1vdmVkID0g\nZmFsc2U7CiAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIG1ldGFzID0gcmVwb3Mu\nZ2V0TWV0YURhdGFzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBt\nZXRhcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3ZlZCB8PSByZW1v\ndmVNZXRhRGF0YShtZXRhc1tpXSk7CiAgICAgICAgU2VxdWVuY2VNZXRhRGF0\nYVtdIHNlcXMgPSByZXBvcy5nZXRTZXF1ZW5jZU1ldGFEYXRhcygpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vxcy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgcmVtb3ZlZCB8PSByZW1vdmVTZXF1ZW5jZU1ldGFEYXRhKHNl\ncXNbaV0pOwogICAgICAgIFF1ZXJ5TWV0YURhdGFbXSBxdWVyaWVzID0gcmVw\nb3MuZ2V0UXVlcnlNZXRhRGF0YXMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92\nZWQgfD0gcmVtb3ZlUXVlcnlNZXRhRGF0YShxdWVyaWVzW2ldKTsKICAgICAg\nICByZXR1cm4gcmVtb3ZlZDsKICAgIH0KCiAgICAvKioKICAgICAqIENsZWFy\nIHRoZSBzZXQgb2YgbWV0YWRhdGFzIHRvIGJlIHNlcmlhbGl6ZWQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIGNsZWFyKCkgewogICAgICAgIGlmIChfbWV0\nYXMgIT0gbnVsbCkKICAgICAgICAgICAgX21ldGFzLmNsZWFyKCk7CiAgICAg\nICAgaWYgKF9zZXFzICE9IG51bGwpCiAgICAgICAgICAgIF9zZXFzLmNsZWFy\nKCk7CiAgICAgICAgaWYgKF9xdWVyaWVzICE9IG51bGwpCiAgICAgICAgICAg\nIF9xdWVyaWVzLmNsZWFyKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgQ29sbGVjdGlvbiBnZXRPYmplY3RzKCkgewogICAgICAgIExp\nc3QgYWxsID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIGlmIChpc1F1ZXJ5\nTW9kZSgpKQogICAgICAgICAgICBhZGRRdWVyeU1ldGFEYXRhcyhhbGwpOwog\nICAgICAgIGlmIChpc01hcHBpbmdNb2RlKCkpCiAgICAgICAgICAgIGFkZFNl\ncXVlbmNlTWV0YURhdGFzKGFsbCk7CiAgICAgICAgaWYgKChpc01ldGFEYXRh\nTW9kZSgpIHx8IGlzTWFwcGluZ01vZGUoKSkgJiYgX21ldGFzICE9IG51bGwp\nCiAgICAgICAgICAgIGFsbC5hZGRBbGwoX21ldGFzLnZhbHVlcygpKTsKICAg\nICAgICBpZiAoaXNNYXBwaW5nTW9kZSgpKQogICAgICAgICAgICBhZGRTeXN0\nZW1NYXBwaW5nRWxlbWVudHMoYWxsKTsKICAgICAgICBzZXJpYWxpemF0aW9u\nU29ydChhbGwpOwogICAgICAgIHJldHVybiBhbGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBZGQgc3lzdGVtLWxldmVsIG1hcHBpbmcgZWxlbWVudHMgdG8g\nYmUgc2VyaWFsaXplZC4gRG9lcyBub3RoaW5nCiAgICAgKiBieSBkZWZhdWx0\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRTeXN0ZW1NYXBwaW5n\nRWxlbWVudHMoQ29sbGVjdGlvbiB0b1NlcmlhbGl6ZSkgewogICAgfQoKICAg\nIC8qKgogICAgICogU29ydCB0aGUgZ2l2ZW4gY29sbGVjdGlvbiBvZiBvYmpl\nY3RzIHRvIGJlIHNlcmlhbGl6ZWQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBzZXJpYWxpemF0aW9uU29ydChMaXN0IG9ianMpIHsKICAgICAgICBpZiAo\nb2JqcyA9PSBudWxsIHx8IG9ianMuaXNFbXB0eSgpKQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgaWYgKF9jb21wID09IG51bGwpCiAgICAgICAgICAg\nIF9jb21wID0gbmV3U2VyaWFsaXphdGlvbkNvbXBhcmF0b3IoKTsKICAgICAg\nICBDb2xsZWN0aW9ucy5zb3J0KG9ianMsIF9jb21wKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSBhIG5ldyBjb21wYXJhdG9yIGZvciBvcmRlcmlu\nZyBvYmplY3RzIHRoYXQgYXJlIHRvIGJlIHNlcmlhbGl6ZWQuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBTZXJpYWxpemF0aW9uQ29tcGFyYXRvciBuZXdTZXJp\nYWxpemF0aW9uQ29tcGFyYXRvcigpIHsKICAgICAgICByZXR1cm4gX2NvbXA7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgc2VxdWVuY2UgbWV0YWRhdGEg\ndG8gdGhlIGdpdmVuIG1ldGFkYXRhcyBjb2xsZWN0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgYWRkU2VxdWVuY2VNZXRhRGF0YXMoQ29sbGVjdGlv\nbiBhbGwpIHsKICAgICAgICBpZiAoX3NlcXMgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBmb3IgKE1hcC5FbnRyeSBlbnRyeSA6IF9z\nZXFzLmVudHJ5U2V0KCkpIHsKICAgICAgICAgICAgaWYgKGVudHJ5LmdldEtl\neSgpID09IG51bGwpCiAgICAgICAgICAgICAgICBhbGwuYWRkQWxsKChMaXN0\nKSBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgZWxzZSBpZiAoX21l\ndGFzID09IG51bGwgfHwgIV9tZXRhcy5jb250YWluc0tleShlbnRyeS5nZXRL\nZXkoKSkpCiAgICAgICAgICAgICAgICBhbGwuYWRkKG5ldyBDbGFzc1NlcXMo\nKExpc3Q8U2VxdWVuY2VNZXRhRGF0YT4pCiAgICAgICAgICAgICAgICAgICAg\nZW50cnkuZ2V0VmFsdWUoKSkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIEFkZCBxdWVyeSBtZXRhZGF0YSB0byB0aGUgZ2l2ZW4gbWV0YWRh\ndGFzIGNvbGxlY3Rpb24uCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhZGRR\ndWVyeU1ldGFEYXRhcyhDb2xsZWN0aW9uIGFsbCkgewogICAgICAgIGlmIChf\ncXVlcmllcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIGZvciAoTWFwLkVudHJ5IGVudHJ5IDogX3F1ZXJpZXMuZW50cnlTZXQoKSkg\newogICAgICAgICAgICBpZiAoZW50cnkuZ2V0S2V5KCkgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGFsbC5hZGRBbGwoKExpc3QpIGVudHJ5LmdldFZhbHVl\nKCkpOwogICAgICAgICAgICBlbHNlIGlmIChfbW9kZSA9PSBNT0RFX1FVRVJZ\nIHx8IF9tZXRhcyA9PSBudWxsCiAgICAgICAgICAgICAgICB8fCAhX21ldGFz\nLmNvbnRhaW5zS2V5KGVudHJ5LmdldEtleSgpKSkKICAgICAgICAgICAgICAg\nIGFsbC5hZGQobmV3IENsYXNzUXVlcmllcygoTGlzdDxRdWVyeU1ldGFEYXRh\nPikKICAgICAgICAgICAgICAgICAgICBlbnRyeS5nZXRWYWx1ZSgpKSk7CiAg\nICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZv\naWQgc2VyaWFsaXplKENvbGxlY3Rpb24gb2JqZWN0cykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAvLyBjb3B5IGNvbGxlY3Rpb24g\ndG8gYXZvaWQgbXV0YXRpb24KICAgICAgICBPYmplY3QgbWV0YTsKICAgICAg\nICBib29sZWFuIHVuaXF1ZSA9IHRydWU7CiAgICAgICAgYm9vbGVhbiBmaWVs\nZEFjY2VzcyA9IGZhbHNlOwogICAgICAgIGJvb2xlYW4gcHJvcGVydHlBY2Nl\nc3MgPSBmYWxzZTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ID0gb2JqZWN0\ncy5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIG1l\ndGEgPSBpdC5uZXh0KCk7CiAgICAgICAgICAgIHN3aXRjaCAodHlwZShtZXRh\nKSkgewogICAgICAgICAgICAgICAgY2FzZSBUWVBFX01FVEE6CiAgICAgICAg\nICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBjbHMgPSAoQ2xhc3NNZXRhRGF0\nYSkgbWV0YTsKICAgICAgICAgICAgICAgICAgICBpZiAoY2xzLmdldEFjY2Vz\nc1R5cGUoKSA9PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRCkKICAgICAg\nICAgICAgICAgICAgICAgICAgZmllbGRBY2Nlc3MgPSB0cnVlOwogICAgICAg\nICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgcHJv\ncGVydHlBY2Nlc3MgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIC8vIG5v\nIGJyZWFrCiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAg\nICAgICAgIGlmICh1bmlxdWUgJiYgZ2V0UGFja2FnZSgpID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgICAgIHNldFBhY2thZ2UoZ2V0UGFja2FnZSht\nZXRhKSk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodW5pcXVlKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZSA9IGdldFBhY2thZ2Uo\nKS5lcXVhbHMoZ2V0UGFja2FnZShtZXRhKSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGlmICghdW5pcXVlKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgc2V0UGFja2FnZShudWxsKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHNlcmlhbGl6ZU5hbWVz\ncGFjZUF0dHJpYnV0ZXMoKTsKICAgICAgICBzdGFydEVsZW1lbnQoImVudGl0\neS1tYXBwaW5ncyIpOwogICAgICAgIGlmIChnZXRQYWNrYWdlKCkgIT0gbnVs\nbCkgewogICAgICAgICAgICBzdGFydEVsZW1lbnQoInBhY2thZ2UiKTsKICAg\nICAgICAgICAgYWRkVGV4dChnZXRQYWNrYWdlKCkpOwogICAgICAgICAgICBl\nbmRFbGVtZW50KCJwYWNrYWdlIik7CiAgICAgICAgfQogICAgICAgIGlmIChm\naWVsZEFjY2VzcyAhPSBwcm9wZXJ0eUFjY2VzcykgLy8gaS5lLiBvbmx5IG9u\nZQogICAgICAgIHsKICAgICAgICAgICAgaW50IGRlZiA9IGdldENvbmZpZ3Vy\nYXRpb24oKS5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLgogICAg\nICAgICAgICAgICAgZ2V0TWV0YURhdGFGYWN0b3J5KCkuZ2V0RGVmYXVsdHMo\nKS5nZXREZWZhdWx0QWNjZXNzVHlwZSgpOwogICAgICAgICAgICBTdHJpbmcg\nYWNjZXNzID0gbnVsbDsKICAgICAgICAgICAgaWYgKGZpZWxkQWNjZXNzICYm\nIGRlZiA9PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19QUk9QRVJUWSkKICAgICAg\nICAgICAgICAgIGFjY2VzcyA9ICJGSUVMRCI7CiAgICAgICAgICAgIGVsc2Ug\naWYgKHByb3BlcnR5QWNjZXNzICYmIGRlZiA9PSBDbGFzc01ldGFEYXRhLkFD\nQ0VTU19GSUVMRCkKICAgICAgICAgICAgICAgIGFjY2VzcyA9ICJQUk9QRVJU\nWSI7CiAgICAgICAgICAgIGlmIChhY2Nlc3MgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgc3RhcnRFbGVtZW50KCJhY2Nlc3MiKTsKICAgICAgICAgICAg\nICAgIGFkZFRleHQoYWNjZXNzKTsKICAgICAgICAgICAgICAgIGVuZEVsZW1l\nbnQoImFjY2VzcyIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAg\nIGZvciAoT2JqZWN0IG9iaiA6IG9iamVjdHMpIHsKICAgICAgICAgICAgaW50\nIHR5cGUgPSB0eXBlKG9iaik7CiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkg\newogICAgICAgICAgICAgICAgY2FzZSBUWVBFX01FVEE6CiAgICAgICAgICAg\nICAgICAgICAgc2VyaWFsaXplQ2xhc3MoKENsYXNzTWV0YURhdGEpIG9iaiwg\nZmllbGRBY2Nlc3MKICAgICAgICAgICAgICAgICAgICAgICAgJiYgcHJvcGVy\ndHlBY2Nlc3MpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBUWVBFX1NFUToKICAgICAgICAgICAgICAgICAgICBp\nZiAoaXNNYXBwaW5nTW9kZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBz\nZXJpYWxpemVTZXF1ZW5jZSgoU2VxdWVuY2VNZXRhRGF0YSkgb2JqKTsKICAg\nICAgICAgICAgICAgIGNhc2UgVFlQRV9RVUVSWToKICAgICAgICAgICAgICAg\nICAgICBzZXJpYWxpemVRdWVyeSgoUXVlcnlNZXRhRGF0YSkgb2JqKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nVFlQRV9DTEFTU19RVUVSSUVTOgogICAgICAgICAgICAgICAgICAgIGZvciAo\nUXVlcnlNZXRhRGF0YSBxdWVyeSA6ICgoQ2xhc3NRdWVyaWVzKSBvYmopCiAg\nICAgICAgICAgICAgICAgICAgICAgIC5nZXRRdWVyaWVzKCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIHNlcmlhbGl6ZVF1ZXJ5KHF1ZXJ5KTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgVFlQ\nRV9DTEFTU19TRVFTOgogICAgICAgICAgICAgICAgICAgIGlmIChpc01hcHBp\nbmdNb2RlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoU2VxdWVu\nY2VNZXRhRGF0YSBzZXEgOiAoKENsYXNzU2Vxcykgb2JqKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLmdldFNlcXVlbmNlcygpKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgc2VyaWFsaXplU2VxdWVuY2Uoc2VxKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1\nbHQ6CiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTWFwcGluZ01vZGUoKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplU3lzdGVtTWFwcGlu\nZ0VsZW1lbnQob2JqKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbmRFbGVtZW50KCJlbnRp\ndHktbWFwcGluZ3MiKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3Rl\nY3RlZCBTdHJpbmcgZ2V0UGFja2FnZShPYmplY3Qgb2JqKSB7CiAgICAgICAg\naW50IHR5cGUgPSB0eXBlKG9iaik7CiAgICAgICAgc3dpdGNoICh0eXBlKSB7\nCiAgICAgICAgICAgIGNhc2UgVFlQRV9NRVRBOgogICAgICAgICAgICAgICAg\ncmV0dXJuIFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUoKChDbGFzc01ldGFEYXRh\nKSBvYmopLgogICAgICAgICAgICAgICAgICAgIGdldERlc2NyaWJlZFR5cGUo\nKSk7CiAgICAgICAgICAgIGNhc2UgVFlQRV9RVUVSWToKICAgICAgICAgICAg\nY2FzZSBUWVBFX1NFUToKICAgICAgICAgICAgY2FzZSBUWVBFX0NMQVNTX1FV\nRVJJRVM6CiAgICAgICAgICAgIGNhc2UgVFlQRV9DTEFTU19TRVFTOgogICAg\nICAgICAgICAgICAgU291cmNlVHJhY2tlciBzdCA9IChTb3VyY2VUcmFja2Vy\nKSBvYmo7CiAgICAgICAgICAgICAgICBpZiAoc3QuZ2V0U291cmNlU2NvcGUo\nKSBpbnN0YW5jZW9mIENsYXNzKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBTdHJpbmdzLmdldFBhY2thZ2VOYW1lKChDbGFzcykgc3QuZ2V0U291cmNl\nU2NvcGUoKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdHlw\nZSBjb25zdGFudCBmb3IgdGhlIGdpdmVuIG9iamVjdCBiYXNlZCBvbiBpdHMg\ncnVudGltZQogICAgICogY2xhc3MuIElmIHRoZSBydW50aW1lIGNsYXNzIGRv\nZXMgbm90IGNvcnJlc3BvbmQgdG8gYW55IG9mIHRoZSBrbm93bgogICAgICog\ndHlwZXMgdGhlbiByZXR1cm5zIC0xLiBUaGlzIGNhbiBoYXBwZW4gZm9yIHRh\nZ3MKICAgICAqIHRoYXQgYXJlIG5vdCBoYW5kbGVkIGF0IHRoaXMgc3RvcmUt\nYWdub3N0aWMgbGV2ZWwuCiAgICAgKi8KICAgIHByb3RlY3RlZCBpbnQgdHlw\nZShPYmplY3QgbykgewogICAgICAgIGlmIChvIGluc3RhbmNlb2YgQ2xhc3NN\nZXRhRGF0YSkKICAgICAgICAgICAgcmV0dXJuIFRZUEVfTUVUQTsKICAgICAg\nICBpZiAobyBpbnN0YW5jZW9mIFF1ZXJ5TWV0YURhdGEpCiAgICAgICAgICAg\nIHJldHVybiBUWVBFX1FVRVJZOwogICAgICAgIGlmIChvIGluc3RhbmNlb2Yg\nU2VxdWVuY2VNZXRhRGF0YSkKICAgICAgICAgICAgcmV0dXJuIFRZUEVfU0VR\nOwogICAgICAgIGlmIChvIGluc3RhbmNlb2YgQ2xhc3NRdWVyaWVzKQogICAg\nICAgICAgICByZXR1cm4gVFlQRV9DTEFTU19RVUVSSUVTOwogICAgICAgIGlm\nIChvIGluc3RhbmNlb2YgQ2xhc3NTZXFzKQogICAgICAgICAgICByZXR1cm4g\nVFlQRV9DTEFTU19TRVFTOwogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNlcmlhbGl6ZSBuYW1lc3BhY2UgYXR0cmlidXRlcwog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplTmFtZXNwYWNlQXR0\ncmlidXRlcygpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgYWRkQXR0cmlidXRlKCJ4bWxucyIsICJodHRwOi8vamF2YS5zdW4uY29t\nL3htbC9ucy9wZXJzaXN0ZW5jZS9vcm0iKTsKICAgICAgICBhZGRBdHRyaWJ1\ndGUoInhtbG5zOnhzaSIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNj\naGVtYS1pbnN0YW5jZSIpOwogICAgICAgIGFkZEF0dHJpYnV0ZSgieHNpOnNj\naGVtYUxvY2F0aW9uIiwKICAgICAgICAgICAgImh0dHA6Ly9qYXZhLnN1bi5j\nb20veG1sL25zL3BlcnNpc3RlbmNlL29ybSBvcm1fMV8wLnhzZCIpOwogICAg\nICAgIGFkZEF0dHJpYnV0ZSgidmVyc2lvbiIsICIxLjAiKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNlcmlhbGl6ZSB1bmtub3duIG1hcHBpbmcgZWxlbWVu\ndCBhdCBzeXN0ZW0gbGV2ZWwuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIHNlcmlhbGl6ZVN5c3RlbU1hcHBpbmdFbGVtZW50KE9iamVjdCBvYmopCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXJpYWxpemUgcXVlcnkgbWV0YWRhdGEuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBzZXJpYWxpemVRdWVyeShRdWVyeU1ldGFEYXRhIG1ldGEp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFf\nYW5ub3MgJiYgbWV0YS5nZXRTb3VyY2VUeXBlKCkgPT0gbWV0YS5TUkNfQU5O\nT1RBVElPTlMpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgTG9nIGxv\nZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgp\nKSB7CiAgICAgICAgICAgIGlmIChtZXRhLmdldFNvdXJjZVNjb3BlKCkgaW5z\ndGFuY2VvZiBDbGFzcykKICAgICAgICAgICAgICAgIGxvZy5pbmZvKF9sb2Mu\nZ2V0KCJzZXItY2xzLXF1ZXJ5IiwKICAgICAgICAgICAgICAgICAgICBtZXRh\nLmdldFNvdXJjZVNjb3BlKCksIG1ldGEuZ2V0TmFtZSgpKSk7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJz\nZXItcXVlcnkiLCBtZXRhLmdldE5hbWUoKSkpOwogICAgICAgIH0KCiAgICAg\nICAgYWRkQ29tbWVudHMobWV0YSk7CiAgICAgICAgYWRkQXR0cmlidXRlKCJu\nYW1lIiwgbWV0YS5nZXROYW1lKCkpOwogICAgICAgIGFkZEF0dHJpYnV0ZSgi\ncXVlcnkiLCBtZXRhLmdldFF1ZXJ5U3RyaW5nKCkpOwogICAgICAgIGlmIChR\ndWVyeUxhbmd1YWdlcy5MQU5HX1NRTC5lcXVhbHMobWV0YS5nZXRMYW5ndWFn\nZSgpKSkgewogICAgICAgICAgICBpZiAobWV0YS5nZXRSZXN1bHRUeXBlKCkg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgicmVzdWx0\nLWNsYXNzIiwgbWV0YS5nZXRSZXN1bHRUeXBlKCkuZ2V0TmFtZSgpKTsKICAg\nICAgICAgICAgc3RhcnRFbGVtZW50KCJuYW1lZC1uYXRpdmUtcXVlcnkiKTsK\nICAgICAgICAgICAgc2VyaWFsaXplUXVlcnlIaW50cyhtZXRhKTsKICAgICAg\nICAgICAgZW5kRWxlbWVudCgibmFtZWQtbmF0aXZlLXF1ZXJ5Iik7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhcnRFbGVtZW50KCJuYW1lZC1x\ndWVyeSIpOwogICAgICAgICAgICBzZXJpYWxpemVRdWVyeUhpbnRzKG1ldGEp\nOwogICAgICAgICAgICBlbmRFbGVtZW50KCJuYW1lZC1xdWVyeSIpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZSBxdWVyeSBo\naW50cy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZVF1ZXJ5\nSGludHMoUXVlcnlNZXRhRGF0YSBtZXRhKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIFN0cmluZ1tdIGhpbnRzID0gbWV0YS5nZXRI\naW50S2V5cygpOwogICAgICAgIE9iamVjdFtdIHZhbHVlcyA9IG1ldGEuZ2V0\nSGludFZhbHVlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaGlu\ndHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJu\nYW1lIiwgaGludHNbaV0pOwogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInZh\nbHVlIiwgU3RyaW5nLnZhbHVlT2YodmFsdWVzW2ldKSk7CiAgICAgICAgICAg\nIHN0YXJ0RWxlbWVudCgicXVlcnktaGludCIpOwogICAgICAgICAgICBlbmRF\nbGVtZW50KCJxdWVyeS1oaW50Iik7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogU2VyaWFsaXplIHNlcXVlbmNlIG1ldGFkYXRhLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXJpYWxpemVTZXF1ZW5jZShTZXF1ZW5j\nZU1ldGFEYXRhIG1ldGEpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKCFfYW5ub3MgJiYgbWV0YS5nZXRTb3VyY2VUeXBlKCkg\nPT0gbWV0YS5TUkNfQU5OT1RBVElPTlMpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cu\naXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdl\ndCgic2VyLXNlcXVlbmNlIiwgbWV0YS5nZXROYW1lKCkpKTsKCiAgICAgICAg\nYWRkQ29tbWVudHMobWV0YSk7CiAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1l\nIiwgbWV0YS5nZXROYW1lKCkpOwoKICAgICAgICAvLyBwYXJzZSBvdXQgdGhl\nIGRhdGFzdG9yZSBzZXF1ZW5jZSBuYW1lLCBpZiBhbnkKICAgICAgICBTdHJp\nbmcgcGx1Z2luID0gbWV0YS5nZXRTZXF1ZW5jZVBsdWdpbigpOwogICAgICAg\nIFN0cmluZyBjbHNOYW1lID0gQ29uZmlndXJhdGlvbnMuZ2V0Q2xhc3NOYW1l\nKHBsdWdpbik7CiAgICAgICAgU3RyaW5nIHByb3BzID0gQ29uZmlndXJhdGlv\nbnMuZ2V0UHJvcGVydGllcyhwbHVnaW4pOwogICAgICAgIFN0cmluZyBkcyA9\nIG51bGw7CiAgICAgICAgaWYgKHByb3BzICE9IG51bGwpIHsKICAgICAgICAg\nICAgUHJvcGVydGllcyBtYXAgPSBDb25maWd1cmF0aW9ucy5wYXJzZVByb3Bl\ncnRpZXMocHJvcHMpOwogICAgICAgICAgICBkcyA9IChTdHJpbmcpIG1hcC5y\nZW1vdmUoIlNlcXVlbmNlIik7CiAgICAgICAgICAgIGlmIChkcyAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBwcm9wcyA9IENvbmZpZ3VyYXRpb25zLnNl\ncmlhbGl6ZVByb3BlcnRpZXMobWFwKTsKICAgICAgICAgICAgICAgIHBsdWdp\nbiA9IENvbmZpZ3VyYXRpb25zLmdldFBsdWdpbihjbHNOYW1lLCBwcm9wcyk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChkcyAhPSBu\ndWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInNlcXVlbmNlLW5hbWUi\nLCBkcyk7CiAgICAgICAgZWxzZSBpZiAocGx1Z2luICE9IG51bGwgJiYgIVNl\ncXVlbmNlTWV0YURhdGEuSU1QTF9OQVRJVkUuZXF1YWxzCiAgICAgICAgICAg\nIChwbHVnaW4pKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInNlcXVlbmNl\nLW5hbWUiLCBwbHVnaW4pOwogICAgICAgIGlmIChtZXRhLmdldEluaXRpYWxW\nYWx1ZSgpICE9IDAgJiYgbWV0YS5nZXRJbml0aWFsVmFsdWUoKSAhPSAtMSkK\nICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJpbml0aWFsLXZhbHVlIiwKICAg\nICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKG1ldGEuZ2V0SW5pdGlhbFZh\nbHVlKCkpKTsKICAgICAgICBpZiAobWV0YS5nZXRBbGxvY2F0ZSgpICE9IDUw\nICYmIG1ldGEuZ2V0QWxsb2NhdGUoKSAhPSAtMSkKICAgICAgICAgICAgYWRk\nQXR0cmlidXRlKCJhbGxvY2F0aW9uLXNpemUiLAogICAgICAgICAgICAgICAg\nU3RyaW5nLnZhbHVlT2YobWV0YS5nZXRBbGxvY2F0ZSgpKSk7CgogICAgICAg\nIHN0YXJ0RWxlbWVudCgic2VxdWVuY2UtZ2VuZXJhdG9yIik7CiAgICAgICAg\nZW5kRWxlbWVudCgic2VxdWVuY2UtZ2VuZXJhdG9yIik7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXJpYWxpemUgY2xhc3MgbWV0YWRhdGEuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIHNlcmlhbGl6ZUNsYXNzKENsYXNzTWV0YURh\ndGEgbWV0YSwgYm9vbGVhbiBhY2Nlc3MpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKCFfYW5ub3MgJiYgbWV0YS5nZXRTb3Vy\nY2VUeXBlKCkgPT0gbWV0YS5TUkNfQU5OT1RBVElPTlMpCiAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAg\nIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cuaW5m\nbyhfbG9jLmdldCgic2VyLWNsYXNzIiwgbWV0YSkpOwoKICAgICAgICBhZGRD\nb21tZW50cyhtZXRhKTsKICAgICAgICBhZGRBdHRyaWJ1dGUoImNsYXNzIiwg\nZ2V0Q2xhc3NOYW1lKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLgogICAgICAg\nICAgICBnZXROYW1lKCkpKTsKCiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2Rl\nKCkKICAgICAgICAgICAgJiYgIW1ldGEuZ2V0VHlwZUFsaWFzKCkuZXF1YWxz\nKFN0cmluZ3MuZ2V0Q2xhc3NOYW1lKG1ldGEuCiAgICAgICAgICAgIGdldERl\nc2NyaWJlZFR5cGUoKSkpKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoIm5h\nbWUiLCBtZXRhLmdldFR5cGVBbGlhcygpKTsKCiAgICAgICAgU3RyaW5nIG5h\nbWUgPSBnZXRFbnRpdHlFbGVtZW50TmFtZShtZXRhKTsKICAgICAgICBpZiAo\naXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgYWRkQ2xhc3NBdHRyaWJ1\ndGVzKG1ldGEsIGFjY2Vzcyk7CiAgICAgICAgaWYgKGlzTWFwcGluZ01vZGUo\nKSkKICAgICAgICAgICAgYWRkQ2xhc3NNYXBwaW5nQXR0cmlidXRlcyhtZXRh\nKTsKCiAgICAgICAgc3RhcnRFbGVtZW50KG5hbWUpOwogICAgICAgIGlmIChp\nc01hcHBpbmdNb2RlKCkpCiAgICAgICAgICAgIHNlcmlhbGl6ZUNsYXNzTWFw\ncGluZ0NvbnRlbnQobWV0YSk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2Rl\nKCkpCiAgICAgICAgICAgIHNlcmlhbGl6ZUlkQ2xhc3MobWV0YSk7CiAgICAg\nICAgaWYgKGlzTWFwcGluZ01vZGUoKSkKICAgICAgICAgICAgc2VyaWFsaXpl\nSW5oZXJpdGFuY2VDb250ZW50KG1ldGEpOwoKICAgICAgICBpZiAoaXNNYXBw\naW5nTW9kZSgpKSB7CiAgICAgICAgICAgIExpc3Qgc2VxcyA9IChfc2VxcyA9\nPSBudWxsKSA/IG51bGwgOiBfc2Vxcy5nZXQKICAgICAgICAgICAgICAgICht\nZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpOwogICAgICAgICAg\nICBpZiAoc2VxcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzZXJpYWxp\nemF0aW9uU29ydChzZXFzKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgc2Vxcy5zaXplKCk7IGkrKykKICAgICAgICAgICAgICAgICAg\nICBzZXJpYWxpemVTZXF1ZW5jZSgoU2VxdWVuY2VNZXRhRGF0YSkgc2Vxcy5n\nZXQoaSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAo\naXNRdWVyeU1vZGUoKSkgewogICAgICAgICAgICBMaXN0IHF1ZXJpZXMgPSAo\nX3F1ZXJpZXMgPT0gbnVsbCkgPyBudWxsIDogX3F1ZXJpZXMuZ2V0CiAgICAg\nICAgICAgICAgICAobWV0YS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgp\nKTsKICAgICAgICAgICAgaWYgKHF1ZXJpZXMgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgc2VyaWFsaXphdGlvblNvcnQocXVlcmllcyk7CiAgICAgICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJpZXMuc2l6ZSgpOyBp\nKyspCiAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplUXVlcnkoKFF1ZXJ5\nTWV0YURhdGEpIHF1ZXJpZXMuZ2V0KGkpKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAoaXNNYXBwaW5nTW9kZSgpKQogICAgICAgICAgICAgICAg\nc2VyaWFsaXplUXVlcnlNYXBwaW5ncyhtZXRhKTsKICAgICAgICB9CgogICAg\nICAgIExpc3Q8RmllbGRNZXRhRGF0YT4gZmllbGRzID0gbmV3IEFycmF5TGlz\ndChBcnJheXMuYXNMaXN0CiAgICAgICAgICAgIChtZXRhLmdldERlZmluZWRG\naWVsZHNJbkxpc3RpbmdPcmRlcigpKSk7CiAgICAgICAgQ29sbGVjdGlvbnMu\nc29ydChmaWVsZHMsIG5ldyBGaWVsZENvbXBhcmF0b3IoKSk7CgogICAgICAg\nIC8vIHNlcmlhbGl6ZSBhdHRyLW92ZXJyaWRlCiAgICAgICAgaWYgKGlzTWFw\ncGluZ01vZGUoKSkgewogICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZDsK\nICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBvcmlnOwogICAgICAgICAgICBm\nb3IgKEl0ZXJhdG9yPEZpZWxkTWV0YURhdGE+IGl0ID0gZmllbGRzLml0ZXJh\ndG9yKCk7IGl0Lmhhc05leHQoKTspCiAgICAgICAgICAgIHsKICAgICAgICAg\nICAgICAgIGZtZCA9IGl0Lm5leHQoKTsKICAgICAgICAgICAgICAgIGlmICht\nZXRhLmdldERlZmluZWRTdXBlcmNsYXNzRmllbGQoZm1kLmdldE5hbWUoKSkg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAg\nICAgICAgICAgIG9yaWcgPSBtZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRh\nKCkuZ2V0RmllbGQoZm1kLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICBp\nZiAoc2VyaWFsaXplQXR0cmlidXRlT3ZlcnJpZGUoZm1kLCBvcmlnKSkKICAg\nICAgICAgICAgICAgICAgICBzZXJpYWxpemVBdHRyaWJ1dGVPdmVycmlkZUNv\nbnRlbnQoZm1kLCBvcmlnKTsKICAgICAgICAgICAgICAgIGl0LnJlbW92ZSgp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZmllbGRz\nLnNpemUoKSA+IDAgJiYgKGlzTWV0YURhdGFNb2RlKCkgfHwgaXNNYXBwaW5n\nTW9kZSgpKSkgewogICAgICAgICAgICBzdGFydEVsZW1lbnQoImF0dHJpYnV0\nZXMiKTsKICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBvcmlnOwogICAgICAg\nICAgICBmb3IgKEZpZWxkTWV0YURhdGEgZm1kIDogZmllbGRzKSB7CiAgICAg\nICAgICAgICAgICBpZiAoZm1kLmdldERlY2xhcmluZ1R5cGUoKSAhPSBmbWQu\nZ2V0RGVmaW5pbmdNZXRhRGF0YSgpLgogICAgICAgICAgICAgICAgICAgIGdl\ndERlc2NyaWJlZFR5cGUoKSkgewogICAgICAgICAgICAgICAgICAgIG9yaWcg\nPSBmbWQuZ2V0RGVjbGFyaW5nTWV0YURhdGEoKS5nZXREZWNsYXJlZEZpZWxk\nCiAgICAgICAgICAgICAgICAgICAgICAgIChmbWQuZ2V0TmFtZSgpKTsKICAg\nICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgIG9yaWcg\nPSBudWxsOwogICAgICAgICAgICAgICAgc2VyaWFsaXplRmllbGQoZm1kLCBv\ncmlnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbmRFbGVtZW50KCJh\ndHRyaWJ1dGVzIik7CiAgICAgICAgfQogICAgICAgIGVuZEVsZW1lbnQobmFt\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGVudGl0eSBl\nbGVtZW50IG5hbWUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIFN0cmlu\nZyBnZXRFbnRpdHlFbGVtZW50TmFtZShDbGFzc01ldGFEYXRhIG1ldGEpIHsK\nICAgICAgICBzd2l0Y2ggKGdldEVudGl0eVRhZyhtZXRhKSkgewogICAgICAg\nICAgICBjYXNlIEVOVElUWToKICAgICAgICAgICAgICAgIHJldHVybiAiZW50\naXR5IjsKICAgICAgICAgICAgY2FzZSBFTUJFRERBQkxFOgogICAgICAgICAg\nICAgICAgcmV0dXJuICJlbWJlZGRhYmxlIjsKICAgICAgICAgICAgY2FzZSBN\nQVBQRURfU1VQRVJDTEFTUzoKICAgICAgICAgICAgICAgIHJldHVybiAibWFw\ncGVkLXN1cGVyY2xhc3MiOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgTWV0\nYURhdGFUYWcgZm9yIHRoZSBnaXZlbiBjbGFzcyBtZXRhIGRhdGEuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIE1ldGFEYXRhVGFnIGdldEVudGl0eVRh\nZyhDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICAvLyBARW1iZWRkYWJs\nZSBjbGFzc2VzIGNhbid0IGRlY2xhcmUgSWQgZmllbGRzCiAgICAgICAgaWYg\nKG1ldGEuaXNFbWJlZGRlZE9ubHkoKSAmJiBtZXRhLmdldFByaW1hcnlLZXlG\naWVsZHMoKS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIE1ldGFE\nYXRhVGFnLkVNQkVEREFCTEU7CiAgICAgICAgaWYgKG1ldGEuaXNNYXBwZWQo\nKSkKICAgICAgICAgICAgcmV0dXJuIE1ldGFEYXRhVGFnLkVOVElUWTsKICAg\nICAgICByZXR1cm4gTWV0YURhdGFUYWcuTUFQUEVEX1NVUEVSQ0xBU1M7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgY2xhc3MgYXR0cmlidXRlcy4KICAg\nICAqCiAgICAgKiBAcGFyYW0gYWNjZXNzIHdoZXRoZXIgdG8gd3JpdGUgYWNj\nZXNzCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhZGRDbGFzc0F0dHJpYnV0\nZXMoQ2xhc3NNZXRhRGF0YSBtZXRhLCBib29sZWFuIGFjY2VzcykgewogICAg\nICAgIGlmICghYWNjZXNzKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAg\naW50IGRlZiA9IGdldENvbmZpZ3VyYXRpb24oKS5nZXRNZXRhRGF0YVJlcG9z\naXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRNZXRhRGF0YUZhY3Rv\ncnkoKS5nZXREZWZhdWx0cygpLmdldERlZmF1bHRBY2Nlc3NUeXBlKCk7CiAg\nICAgICAgaWYgKG1ldGEuZ2V0QWNjZXNzVHlwZSgpID09IENsYXNzTWV0YURh\ndGEuQUNDRVNTX0ZJRUxECiAgICAgICAgICAgICYmIGRlZiA9PSBDbGFzc01l\ndGFEYXRhLkFDQ0VTU19QUk9QRVJUWSkKICAgICAgICAgICAgYWRkQXR0cmli\ndXRlKCJhY2Nlc3MiLCAiRklFTEQiKTsKICAgICAgICBlbHNlIGlmIChtZXRh\nLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19QUk9Q\nRVJUWQogICAgICAgICAgICAmJiBkZWYgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NF\nU1NfRklFTEQpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiYWNjZXNzIiwg\nIlBST1BFUlRZIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgbWFwcGlu\nZyBhdHRyaWJ1dGVzIGZvciB0aGUgZ2l2ZW4gY2xhc3MuIERvZXMgbm90aGlu\nZyBieSBkZWZhdWx0CiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZENs\nYXNzTWFwcGluZ0F0dHJpYnV0ZXMoQ2xhc3NNZXRhRGF0YSBtYXBwaW5nKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8qKgog\nICAgICogU2VyaWFsaXplIGlkLWNsYXNzLgogICAgICovCiAgICBwcml2YXRl\nIHZvaWQgc2VyaWFsaXplSWRDbGFzcyhDbGFzc01ldGFEYXRhIG1ldGEpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKG1ldGEu\nZ2V0SWRlbnRpdHlUeXBlKCkgIT0gQ2xhc3NNZXRhRGF0YS5JRF9BUFBMSUNB\nVElPTgogICAgICAgICAgICB8fCBtZXRhLmlzT3BlbkpQQUlkZW50aXR5KCkp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBz\ndXAgPSBtZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRhKCk7CiAgICAgICAg\nQ2xhc3Mgb2lkID0gbWV0YS5nZXRPYmplY3RJZFR5cGUoKTsKICAgICAgICBp\nZiAob2lkICE9IG51bGwgJiYgKHN1cCA9PSBudWxsIHx8IG9pZCAhPSBzdXAu\nZ2V0T2JqZWN0SWRUeXBlKCkpKSB7CiAgICAgICAgICAgIGFkZEF0dHJpYnV0\nZSgiY2xhc3MiLCBnZXRDbGFzc05hbWUob2lkLmdldE5hbWUoKSkpOwogICAg\nICAgICAgICBzdGFydEVsZW1lbnQoImlkLWNsYXNzIik7CiAgICAgICAgICAg\nIGVuZEVsZW1lbnQoImlkLWNsYXNzIik7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogU2VyaWFsaXplIGNsYXNzIG1hcHBpbmcgY29udGVudC4g\nRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIHNlcmlhbGl6ZUNsYXNzTWFwcGluZ0NvbnRlbnQoQ2xhc3NNZXRh\nRGF0YSBtYXBwaW5nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplIGluaGVyaXRhbmNlIGNv\nbnRlbnQuIERvZXMgbm90aGluZyBieSBkZWZhdWx0LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBzZXJpYWxpemVJbmhlcml0YW5jZUNvbnRlbnQoQ2xh\nc3NNZXRhRGF0YSBtYXBwaW5nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplIHF1ZXJ5IG1h\ncHBpbmdzLiBEb2VzIG5vdGhpbmcgYnkgZGVmYXVsdC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgc2VyaWFsaXplUXVlcnlNYXBwaW5ncyhDbGFzc01l\ndGFEYXRhIG1ldGEpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXJpYWxpemUgdGhlIGdpdmVuIGZpZWxk\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplRmllbGQoRmll\nbGRNZXRhRGF0YSBmbWQsIEZpZWxkTWV0YURhdGEgb3JpZykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoZm1kLmdldE1hbmFn\nZW1lbnQoKSAhPSBGaWVsZE1ldGFEYXRhLk1BTkFHRV9QRVJTSVNURU5UCiAg\nICAgICAgICAgICYmICFmbWQuaXNFeHBsaWNpdCgpKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIGFkZENvbW1lbnRzKGZtZCk7CiAgICAgICAgYWRk\nQXR0cmlidXRlKCJuYW1lIiwgZm1kLmdldE5hbWUoKSk7CgogICAgICAgIFN0\ncmluZyBzdHJhdGVneSA9IG51bGw7CiAgICAgICAgUGVyc2lzdGVuY2VTdHJh\ndGVneSBzdHJhdCA9IGdldFN0cmF0ZWd5KGZtZCk7CiAgICAgICAgVmFsdWVN\nZXRhRGF0YSBjYXNjYWRlcyA9IG51bGw7CiAgICAgICAgaWYgKGZtZC5pc1By\naW1hcnlLZXkoKSAmJiBzdHJhdCA9PSBQZXJzaXN0ZW5jZVN0cmF0ZWd5LkVN\nQkVEREVEKQogICAgICAgICAgICBzdHJhdGVneSA9ICJlbWJlZGRlZC1pZCI7\nCiAgICAgICAgZWxzZSBpZiAoZm1kLmlzUHJpbWFyeUtleSgpKQogICAgICAg\nICAgICBzdHJhdGVneSA9ICJpZCI7CiAgICAgICAgZWxzZSBpZiAoZm1kLmlz\nVmVyc2lvbigpKQogICAgICAgICAgICBzdHJhdGVneSA9ICJ2ZXJzaW9uIjsK\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgc3dpdGNoIChzdHJhdCkgewog\nICAgICAgICAgICAgICAgY2FzZSBUUkFOU0lFTlQ6CiAgICAgICAgICAgICAg\nICAgICAgc3RyYXRlZ3kgPSAidHJhbnNpZW50IjsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgQkFTSUM6CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIGFkZEJhc2ljQXR0cmlidXRlcyhmbWQpOwogICAg\nICAgICAgICAgICAgICAgIHN0cmF0ZWd5ID0gImJhc2ljIjsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRU1CRURE\nRUQ6CiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAiZW1iZWRkZWQi\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBNQU5ZX09ORToKICAgICAgICAgICAgICAgICAgICBpZiAoaXNNZXRh\nRGF0YU1vZGUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgYWRkTWFueVRv\nT25lQXR0cmlidXRlcyhmbWQpOwogICAgICAgICAgICAgICAgICAgIHN0cmF0\nZWd5ID0gIm1hbnktdG8tb25lIjsKICAgICAgICAgICAgICAgICAgICBjYXNj\nYWRlcyA9IGZtZDsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgT05FX09ORToKICAgICAgICAgICAgICAgICAgICBp\nZiAoaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nYWRkT25lVG9PbmVBdHRyaWJ1dGVzKGZtZCk7CiAgICAgICAgICAgICAgICAg\nICAgc3RyYXRlZ3kgPSAib25lLXRvLW9uZSI7CiAgICAgICAgICAgICAgICAg\nICAgY2FzY2FkZXMgPSBmbWQ7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIE9ORV9NQU5ZOgogICAgICAgICAgICAg\nICAgICAgIGlmIChpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICAgICAg\nICAgICAgICBhZGRPbmVUb01hbnlBdHRyaWJ1dGVzKGZtZCk7CiAgICAgICAg\nICAgICAgICAgICAgc3RyYXRlZ3kgPSAib25lLXRvLW1hbnkiOwogICAgICAg\nICAgICAgICAgICAgIGNhc2NhZGVzID0gZm1kLmdldEVsZW1lbnQoKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nTUFOWV9NQU5ZOgogICAgICAgICAgICAgICAgICAgIGlmIChpc01ldGFEYXRh\nTW9kZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBhZGRNYW55VG9NYW55\nQXR0cmlidXRlcyhmbWQpOwogICAgICAgICAgICAgICAgICAgIHN0cmF0ZWd5\nID0gIm1hbnktdG8tbWFueSI7CiAgICAgICAgICAgICAgICAgICAgY2FzY2Fk\nZXMgPSBmbWQuZ2V0RWxlbWVudCgpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpc01hcHBpbmdN\nb2RlKCkpCiAgICAgICAgICAgICAgICBhZGRTdHJhdGVneU1hcHBpbmdBdHRy\naWJ1dGVzKGZtZCk7CiAgICAgICAgfQogICAgICAgIGlmIChpc01hcHBpbmdN\nb2RlKGZtZCkpCiAgICAgICAgICAgIGFkZEZpZWxkTWFwcGluZ0F0dHJpYnV0\nZXMoZm1kLCBvcmlnKTsKCiAgICAgICAgc3RhcnRFbGVtZW50KHN0cmF0ZWd5\nKTsKICAgICAgICBpZiAoZm1kLmdldE9yZGVyRGVjbGFyYXRpb24oKSAhPSBu\ndWxsKSB7CiAgICAgICAgICAgIHN0YXJ0RWxlbWVudCgib3JkZXItYnkiKTsK\nICAgICAgICAgICAgaWYgKCEoT3JkZXIuRUxFTUVOVCArICIgYXNjIikuZXF1\nYWxzKGZtZC5nZXRPcmRlckRlY2xhcmF0aW9uKCkpKQogICAgICAgICAgICAg\nICAgYWRkVGV4dChmbWQuZ2V0T3JkZXJEZWNsYXJhdGlvbigpKTsKICAgICAg\nICAgICAgZW5kRWxlbWVudCgib3JkZXItYnkiKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKGlzTWFwcGluZ01vZGUoKSAmJiBmbWQuZ2V0S2V5KCkuZ2V0VmFs\ndWVNYXBwZWRCeSgpICE9IG51bGwpIHsKICAgICAgICAgICAgRmllbGRNZXRh\nRGF0YSBtYXBCeSA9IGZtZC5nZXRLZXkoKS5nZXRWYWx1ZU1hcHBlZEJ5TWV0\nYURhdGEoKTsKICAgICAgICAgICAgaWYgKCFtYXBCeS5pc1ByaW1hcnlLZXko\nKSB8fAogICAgICAgICAgICAgICAgbWFwQnkuZ2V0RGVmaW5pbmdNZXRhRGF0\nYSgpLmdldFByaW1hcnlLZXlGaWVsZHMoKS5sZW5ndGggIT0gMSkgewogICAg\nICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1lIiwgZm1kLmdldEtleSgp\nLmdldFZhbHVlTWFwcGVkQnkoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgc3RhcnRFbGVtZW50KCJtYXAta2V5Iik7CiAgICAgICAgICAgIGVuZEVs\nZW1lbnQoIm1hcC1rZXkiKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzTWFw\ncGluZ01vZGUoZm1kKSkKICAgICAgICAgICAgc2VyaWFsaXplRmllbGRNYXBw\naW5nQ29udGVudChmbWQsIHN0cmF0KTsKICAgICAgICBpZiAoY2FzY2FkZXMg\nIT0gbnVsbCAmJiBpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICBzZXJp\nYWxpemVDYXNjYWRlcyhjYXNjYWRlcyk7CiAgICAgICAgaWYgKGlzTWFwcGlu\nZ01vZGUoKSAmJiBzdHJhdCA9PSBQZXJzaXN0ZW5jZVN0cmF0ZWd5LkVNQkVE\nREVEKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IGZtZC5n\nZXRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgICAgIENsYXNzTWV0YURh\ndGEgb3duZXIgPSBnZXRDb25maWd1cmF0aW9uKCkuCiAgICAgICAgICAgICAg\nICBnZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLmdldE1ldGFEYXRh\nCiAgICAgICAgICAgICAgICAobWV0YS5nZXREZXNjcmliZWRUeXBlKCksIG1l\ndGEuZ2V0RW52Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAgICAgIEZp\nZWxkTWV0YURhdGEgZW9yaWc7CiAgICAgICAgICAgIGZvciAoRmllbGRNZXRh\nRGF0YSBlZm1kIDogbWV0YS5nZXRGaWVsZHMoKSkgewogICAgICAgICAgICAg\nICAgZW9yaWcgPSBvd25lci5nZXRGaWVsZChlZm1kLmdldE5hbWUoKSk7CiAg\nICAgICAgICAgICAgICBpZiAoc2VyaWFsaXplQXR0cmlidXRlT3ZlcnJpZGUo\nZWZtZCwgZW9yaWcpKQogICAgICAgICAgICAgICAgICAgIHNlcmlhbGl6ZUF0\ndHJpYnV0ZU92ZXJyaWRlQ29udGVudChlZm1kLCBlb3JpZyk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgZW5kRWxlbWVudChzdHJhdGVneSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgbWFwcGluZyBhdHRyaWJ1dGVz\nIGZvciB0aGUgZ2l2ZW4gZmllbGQuIERvZXMgbm90aGluZyBieSBkZWZhdWx0\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRGaWVsZE1hcHBpbmdB\ndHRyaWJ1dGVzKEZpZWxkTWV0YURhdGEgZm1kLAogICAgICAgIEZpZWxkTWV0\nYURhdGEgb3JpZykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFsd2F5cyByZXR1cm5zIGZhbHNlIGJ5IGRl\nZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHNlcmlhbGl6\nZUF0dHJpYnV0ZU92ZXJyaWRlKEZpZWxkTWV0YURhdGEgZm1kLAogICAgICAg\nIEZpZWxkTWV0YURhdGEgb3JpZykgewogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZSBhdHRyaWJ1dGUgb3Zl\ncnJpZGUgY29udGVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlcmlh\nbGl6ZUF0dHJpYnV0ZU92ZXJyaWRlQ29udGVudChGaWVsZE1ldGFEYXRhIGZt\nZCwKICAgICAgICBGaWVsZE1ldGFEYXRhIG9yaWcpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYWRkQXR0cmlidXRlKCJuYW1lIiwg\nZm1kLmdldE5hbWUoKSk7CiAgICAgICAgc3RhcnRFbGVtZW50KCJhdHRyaWJ1\ndGUtb3ZlcnJpZGUiKTsKICAgICAgICBzZXJpYWxpemVBdHRyaWJ1dGVPdmVy\ncmlkZU1hcHBpbmdDb250ZW50KGZtZCwgb3JpZyk7CiAgICAgICAgZW5kRWxl\nbWVudCgiYXR0cmlidXRlLW92ZXJyaWRlIik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXJpYWxpemUgYXR0cmlidXRlIG92ZXJyaWRlIG1hcHBpbmcgY29u\ndGVudC4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQsCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIHNlcmlhbGl6ZUF0dHJpYnV0ZU92ZXJyaWRlTWFwcGlu\nZ0NvbnRlbnQKICAgICAgICAoRmllbGRNZXRhRGF0YSBmbWQsIEZpZWxkTWV0\nYURhdGEgb3JpZykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZSBjYXNjYWRlcy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZUNhc2NhZGVzKFZhbHVlTWV0\nYURhdGEgdm1kKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIENvbGxlY3Rpb248U3RyaW5nPiBjYXNjYWRlcyA9IG51bGw7CiAgICAg\nICAgaWYgKHZtZC5nZXRDYXNjYWRlUGVyc2lzdCgpID09IFZhbHVlTWV0YURh\ndGEuQ0FTQ0FERV9JTU1FRElBVEUpIHsKICAgICAgICAgICAgaWYgKGNhc2Nh\nZGVzID09IG51bGwpCiAgICAgICAgICAgICAgICBjYXNjYWRlcyA9IG5ldyBB\ncnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAgICAgICBjYXNjYWRlcy5hZGQo\nImNhc2NhZGUtcGVyc2lzdCIpOwogICAgICAgIH0KICAgICAgICBpZiAodm1k\nLmdldENhc2NhZGVBdHRhY2goKSA9PSBWYWx1ZU1ldGFEYXRhLkNBU0NBREVf\nSU1NRURJQVRFKSB7CiAgICAgICAgICAgIGlmIChjYXNjYWRlcyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgY2FzY2FkZXMgPSBuZXcgQXJyYXlMaXN0PFN0\ncmluZz4oKTsKICAgICAgICAgICAgY2FzY2FkZXMuYWRkKCJjYXNjYWRlLW1l\ncmdlIik7CiAgICAgICAgfQogICAgICAgIGlmICh2bWQuZ2V0Q2FzY2FkZURl\nbGV0ZSgpID09IFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9JTU1FRElBVEUpIHsK\nICAgICAgICAgICAgaWYgKGNhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAg\nICAgICBjYXNjYWRlcyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAg\nICAgICAgICBjYXNjYWRlcy5hZGQoImNhc2NhZGUtcmVtb3ZlIik7CiAgICAg\nICAgfQogICAgICAgIGlmICh2bWQuZ2V0Q2FzY2FkZVJlZnJlc2goKSA9PSBW\nYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1NRURJQVRFKSB7CiAgICAgICAgICAg\nIGlmIChjYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAgICAgICAgY2FzY2Fk\nZXMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKICAgICAgICAgICAgY2Fz\nY2FkZXMuYWRkKCJjYXNjYWRlLXJlZnJlc2giKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKGNhc2NhZGVzICE9IG51bGwgJiYgY2FzY2FkZXMuc2l6ZSgpID09\nIDQpIC8vIEFMTAogICAgICAgIHsKICAgICAgICAgICAgY2FzY2FkZXMuY2xl\nYXIoKTsKICAgICAgICAgICAgY2FzY2FkZXMuYWRkKCJjYXNjYWRlLWFsbCIp\nOwogICAgICAgIH0KICAgICAgICBpZiAoY2FzY2FkZXMgIT0gbnVsbCkgewog\nICAgICAgICAgICBzdGFydEVsZW1lbnQoImNhc2NhZGUiKTsKICAgICAgICAg\nICAgZm9yIChTdHJpbmcgY2FzY2FkZSA6IGNhc2NhZGVzKSB7CiAgICAgICAg\nICAgICAgICBzdGFydEVsZW1lbnQoY2FzY2FkZSk7CiAgICAgICAgICAgICAg\nICBlbmRFbGVtZW50KGNhc2NhZGUpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGVuZEVsZW1lbnQoImNhc2NhZGUiKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNlcmlhbGl6ZWQgc3RyYXRlZ3kg\nbmFtZS4KICAgICAqLwogICAgcHJvdGVjdGVkIFBlcnNpc3RlbmNlU3RyYXRl\nZ3kgZ2V0U3RyYXRlZ3koRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBp\nZiAoZm1kLmdldE1hbmFnZW1lbnQoKSA9PSBmbWQuTUFOQUdFX05PTkUpCiAg\nICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVN0cmF0ZWd5LlRSQU5TSUVO\nVDsKCiAgICAgICAgaWYgKGZtZC5pc1NlcmlhbGl6ZWQoKQogICAgICAgICAg\nICB8fCBmbWQuZ2V0RGVjbGFyZWRUeXBlKCkgPT0gYnl0ZVtdLmNsYXNzCiAg\nICAgICAgICAgIHx8IGZtZC5nZXREZWNsYXJlZFR5cGUoKSA9PSBCeXRlW10u\nY2xhc3MKICAgICAgICAgICAgfHwgZm1kLmdldERlY2xhcmVkVHlwZSgpID09\nIGNoYXJbXS5jbGFzcwogICAgICAgICAgICB8fCBmbWQuZ2V0RGVjbGFyZWRU\neXBlKCkgPT0gQ2hhcmFjdGVyW10uY2xhc3MpCiAgICAgICAgICAgIHJldHVy\nbiBQZXJzaXN0ZW5jZVN0cmF0ZWd5LkJBU0lDOwoKICAgICAgICBGaWVsZE1l\ndGFEYXRhIG1hcHBlZEJ5OwogICAgICAgIHN3aXRjaCAoZm1kLmdldERlY2xh\ncmVkVHlwZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5Q\nQzoKICAgICAgICAgICAgICAgIGlmIChmbWQuaXNFbWJlZGRlZCgpKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVN0cmF0ZWd5LkVN\nQkVEREVEOwogICAgICAgICAgICAgICAgaWYgKGZtZC5nZXRNYXBwZWRCeSgp\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3Rl\nbmNlU3RyYXRlZ3kuT05FX09ORTsKICAgICAgICAgICAgICAgIEZpZWxkTWV0\nYURhdGFbXSBpbnZlcnNlcyA9IGZtZC5nZXRJbnZlcnNlTWV0YURhdGFzKCk7\nCiAgICAgICAgICAgICAgICBpZiAoaW52ZXJzZXMubGVuZ3RoID09IDEgJiYK\nICAgICAgICAgICAgICAgICAgICBpbnZlcnNlc1swXS5nZXRUeXBlQ29kZSgp\nID09IEphdmFUeXBlcy5QQyAmJgogICAgICAgICAgICAgICAgICAgIGludmVy\nc2VzWzBdLmdldE1hcHBlZEJ5TWV0YURhdGEoKSA9PSBmbWQpIHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VTdHJhdGVneS5PTkVf\nT05FOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJu\nIFBlcnNpc3RlbmNlU3RyYXRlZ3kuTUFOWV9PTkU7CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5DT0xMRUNUSU9OOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6\nCiAgICAgICAgICAgICAgICBtYXBwZWRCeSA9IGZtZC5nZXRNYXBwZWRCeU1l\ndGFEYXRhKCk7CiAgICAgICAgICAgICAgICBpZiAobWFwcGVkQnkgPT0gbnVs\nbCB8fCBtYXBwZWRCeS5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5QQykK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VTdHJhdGVn\neS5NQU5ZX01BTlk7CiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVu\nY2VTdHJhdGVneS5PTkVfTUFOWTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuT0lEOgogICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kuRU1CRURERUQ7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg\nICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VTdHJhdGVneS5CQVNJQzsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYmFzaWMgYXR0cmli\ndXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFkZEJhc2ljQXR0cmli\ndXRlcyhGaWVsZE1ldGFEYXRhIGZtZCkKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoIWZtZC5pc0luRGVmYXVsdEZldGNoR3Jv\ndXAoKSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJmZXRjaCIsICJMQVpZ\nIik7CiAgICAgICAgaWYgKGZtZC5nZXROdWxsVmFsdWUoKSA9PSBGaWVsZE1l\ndGFEYXRhLk5VTExfRVhDRVBUSU9OKQogICAgICAgICAgICBhZGRBdHRyaWJ1\ndGUoIm9wdGlvbmFsIiwgImZhbHNlIik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBZGQgbWFueS10by1vbmUgYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIGFkZE1hbnlUb09uZUF0dHJpYnV0ZXMoRmllbGRNZXRhRGF0\nYSBmbWQpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKCFmbWQuaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkpCiAgICAgICAgICAg\nIGFkZEF0dHJpYnV0ZSgiZmV0Y2giLCAiTEFaWSIpOwogICAgICAgIGlmIChm\nbWQuZ2V0TnVsbFZhbHVlKCkgPT0gRmllbGRNZXRhRGF0YS5OVUxMX0VYQ0VQ\nVElPTikKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJvcHRpb25hbCIsICJm\nYWxzZSIpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIG9uZS10by1vbmUg\nYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFkZE9uZVRv\nT25lQXR0cmlidXRlcyhGaWVsZE1ldGFEYXRhIGZtZCkKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWZtZC5pc0luRGVmYXVs\ndEZldGNoR3JvdXAoKSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJmZXRj\naCIsICJMQVpZIik7CiAgICAgICAgaWYgKGZtZC5nZXROdWxsVmFsdWUoKSA9\nPSBGaWVsZE1ldGFEYXRhLk5VTExfRVhDRVBUSU9OKQogICAgICAgICAgICBh\nZGRBdHRyaWJ1dGUoIm9wdGlvbmFsIiwgImZhbHNlIik7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBZGQgb25lLXRvLW1hbnkgYXR0cmlidXRlcy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGFkZE9uZVRvTWFueUF0dHJpYnV0ZXMoRmll\nbGRNZXRhRGF0YSBmbWQpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKGZtZC5pc0luRGVmYXVsdEZldGNoR3JvdXAoKSkKICAg\nICAgICAgICAgYWRkQXR0cmlidXRlKCJmZXRjaCIsICJFQUdFUiIpOwogICAg\nICAgIGFkZFRhcmdldEVudGl0eUF0dHJpYnV0ZShmbWQpOwogICAgfQoKICAg\nIC8qKgogICAgICogQWRkIG1hbnktdG8tbWFueSBhdHRyaWJ1dGVzLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgYWRkTWFueVRvTWFueUF0dHJpYnV0ZXMo\nRmllbGRNZXRhRGF0YSBmbWQpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKGZtZC5pc0luRGVmYXVsdEZldGNoR3JvdXAoKSkK\nICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJmZXRjaCIsICJFQUdFUiIpOwog\nICAgICAgIGFkZFRhcmdldEVudGl0eUF0dHJpYnV0ZShmbWQpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkIGEgdGFyZ2V0LWVudGl0eSBhdHRyaWJ1dGUg\ndG8gY29sbGVjdGlvbiBhbmQgbWFwIGZpZWxkcyB0aGF0IGRvCiAgICAgKiBu\nb3QgdXNlIGdlbmVyaWNzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRk\nVGFyZ2V0RW50aXR5QXR0cmlidXRlKEZpZWxkTWV0YURhdGEgZm1kKSAKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBNZW1iZXIgbWVt\nYmVyID0gZm1kLmdldEJhY2tpbmdNZW1iZXIoKTsKICAgICAgICBDbGFzc1td\nIHR5cGVzOwogICAgICAgIGlmIChtZW1iZXIgaW5zdGFuY2VvZiBGaWVsZCkK\nICAgICAgICAgICAgdHlwZXMgPSBKYXZhVmVyc2lvbnMuZ2V0UGFyYW1ldGVy\naXplZFR5cGVzKChGaWVsZCkgbWVtYmVyKTsKICAgICAgICBlbHNlIGlmICht\nZW1iZXIgaW5zdGFuY2VvZiBNZXRob2QpCiAgICAgICAgICAgIHR5cGVzID0g\nSmF2YVZlcnNpb25zLmdldFBhcmFtZXRlcml6ZWRUeXBlcygoTWV0aG9kKSBt\nZW1iZXIpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgdHlwZXMgPSBuZXcg\nQ2xhc3NbMF07CgogICAgICAgIHN3aXRjaCAoZm1kLmdldERlY2xhcmVkVHlw\nZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNU\nSU9OOgogICAgICAgICAgICAgICAgaWYgKHR5cGVzLmxlbmd0aCAhPSAxKQog\nICAgICAgICAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgidGFyZ2V0LWVudGl0\neSIsIGZtZC5nZXRFbGVtZW50KCkuCiAgICAgICAgICAgICAgICAgICAgICAg\nIGdldERlY2xhcmVkVHlwZSgpLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAg\nICAgICAgICAgICAgaWYgKHR5cGVzLmxlbmd0aCAhPSAyKQogICAgICAgICAg\nICAgICAgICAgIGFkZEF0dHJpYnV0ZSgidGFyZ2V0LWVudGl0eSIsIGZtZC5n\nZXRFbGVtZW50KCkuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldERlY2xh\ncmVkVHlwZSgpLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXJpYWxpemUgZmll\nbGQgbWFwcGluZyBjb250ZW50OyB0aGlzIHdpbGwgYmUgY2FsbGVkIGJlZm9y\nZQogICAgICoge0BsaW5rICNzZXJpYWxpemVWYWx1ZU1hcHBpbmdDb250ZW50\nfS4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHNlcmlhbGl6ZUZpZWxkTWFwcGluZ0NvbnRlbnQoRmllbGRN\nZXRhRGF0YSBmbWQsCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJh\ndGVneSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCBtYXBwaW5nIGF0dHJpYnV0ZXMgZm9yIHN0cmF0\nZWd5LiBTZXRzIG1hcHBlZC1ieSBieSBkZWZhdWx0LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBhZGRTdHJhdGVneU1hcHBpbmdBdHRyaWJ1dGVzKEZp\nZWxkTWV0YURhdGEgZm1kKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIGlmIChmbWQuZ2V0TWFwcGVkQnkoKSAhPSBudWxsKQogICAg\nICAgICAgICBhZGRBdHRyaWJ1dGUoIm1hcHBlZC1ieSIsIGZtZC5nZXRNYXBw\nZWRCeSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcHJlc2VudHMgb3Jk\nZXJlZCBzZXQgb2Yge0BsaW5rIFNlcXVlbmNlTWV0YURhdGF9cyB3aXRoIGEK\nICAgICAqIGNvbW1vbiBjbGFzcyBzY29wZS4KICAgICAqCiAgICAgKiBAYXV0\naG9yIFN0ZXBoZW4gS2ltCiAgICAgKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIK\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQ2xhc3NTZXFzCiAg\nICAgICAgaW1wbGVtZW50cyBTb3VyY2VUcmFja2VyLCBDb21wYXJhYmxlPENs\nYXNzU2Vxcz4sCiAgICAgICAgQ29tcGFyYXRvcjxTZXF1ZW5jZU1ldGFEYXRh\nPiB7CgogICAgICAgIHByaXZhdGUgZmluYWwgU2VxdWVuY2VNZXRhRGF0YVtd\nIF9zZXFzOwoKICAgICAgICBwdWJsaWMgQ2xhc3NTZXFzKExpc3Q8U2VxdWVu\nY2VNZXRhRGF0YT4gc2VxcykgewogICAgICAgICAgICBpZiAoc2VxcyA9PSBu\ndWxsIHx8IHNlcXMuaXNFbXB0eSgpKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CgogICAgICAgICAgICBfc2VxcyA9\nIChTZXF1ZW5jZU1ldGFEYXRhW10pIHNlcXMudG9BcnJheQogICAgICAgICAg\nICAgICAgKG5ldyBTZXF1ZW5jZU1ldGFEYXRhW3NlcXMuc2l6ZSgpXSk7CiAg\nICAgICAgICAgIEFycmF5cy5zb3J0KF9zZXFzLCB0aGlzKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBTZXF1ZW5jZU1ldGFEYXRhW10gZ2V0U2VxdWVu\nY2VzKCkgewogICAgICAgICAgICByZXR1cm4gX3NlcXM7CiAgICAgICAgfQoK\nICAgICAgICAvKioKICAgICAgICAgKiBDb21wYXJlIHNlcXVlbmNlIG1ldGFk\nYXRhIG9uIG5hbWUuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIGludCBj\nb21wYXJlKFNlcXVlbmNlTWV0YURhdGEgbzEsIFNlcXVlbmNlTWV0YURhdGEg\nbzIpIHsKICAgICAgICAgICAgcmV0dXJuIG8xLmdldE5hbWUoKS5jb21wYXJl\nVG8obzIuZ2V0TmFtZSgpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBG\naWxlIGdldFNvdXJjZUZpbGUoKSB7CiAgICAgICAgICAgIHJldHVybiBfc2Vx\nc1swXS5nZXRTb3VyY2VGaWxlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgT2JqZWN0IGdldFNvdXJjZVNjb3BlKCkgewogICAgICAgICAgICByZXR1\ncm4gX3NlcXNbMF0uZ2V0U291cmNlU2NvcGUoKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBpbnQgZ2V0U291cmNlVHlwZSgpIHsKICAgICAgICAgICAg\ncmV0dXJuIF9zZXFzWzBdLmdldFNvdXJjZVR5cGUoKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBTdHJpbmcgZ2V0UmVzb3VyY2VOYW1lKCkgewogICAg\nICAgICAgICByZXR1cm4gX3NlcXNbMF0uZ2V0UmVzb3VyY2VOYW1lKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdldExpbmVOdW1iZXIoKSB7\nCiAgICAgICAgICAgIHJldHVybiBfc2Vxc1swXS5nZXRMaW5lTnVtYmVyKCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdldENvbE51bWJlcigp\nIHsKICAgICAgICAgICAgcmV0dXJuIF9zZXFzWzBdLmdldENvbE51bWJlcigp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgaW50IGNvbXBh\ncmVUbyhDbGFzc1NlcXMgb3RoZXIpIHsKICAgICAgICAgICAgaWYgKG90aGVy\nID09IHRoaXMpCiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAg\nICAgaWYgKG90aGVyID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4g\nLTE7CiAgICAgICAgICAgIENsYXNzIHNjb3BlID0gKENsYXNzKSBnZXRTb3Vy\nY2VTY29wZSgpOwogICAgICAgICAgICBDbGFzcyBvc2NvcGUgPSAoQ2xhc3Mp\nIG90aGVyLmdldFNvdXJjZVNjb3BlKCk7CiAgICAgICAgICAgIHJldHVybiBz\nY29wZS5nZXROYW1lKCkuY29tcGFyZVRvKG9zY29wZS5nZXROYW1lKCkpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlcHJlc2VudHMgb3Jk\nZXJlZCBzZXQgb2Yge0BsaW5rIFF1ZXJ5TWV0YURhdGF9cyB3aXRoIGEKICAg\nICAqIGNvbW1vbiBjbGFzcyBzY29wZS4KICAgICAqCiAgICAgKiBAYXV0aG9y\nIFN0ZXBoZW4gS2ltCiAgICAgKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQ2xhc3NRdWVyaWVzCiAg\nICAgICAgaW1wbGVtZW50cyBTb3VyY2VUcmFja2VyLCBDb21wYXJhYmxlPENs\nYXNzUXVlcmllcz4sCiAgICAgICAgQ29tcGFyYXRvcjxRdWVyeU1ldGFEYXRh\nPiB7CgogICAgICAgIHByaXZhdGUgZmluYWwgUXVlcnlNZXRhRGF0YVtdIF9x\ndWVyaWVzOwoKICAgICAgICBwdWJsaWMgQ2xhc3NRdWVyaWVzKExpc3Q8UXVl\ncnlNZXRhRGF0YT4gcXVlcmllcykgewogICAgICAgICAgICBpZiAocXVlcmll\ncyA9PSBudWxsIHx8IHF1ZXJpZXMuaXNFbXB0eSgpKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CgogICAgICAgICAg\nICBfcXVlcmllcyA9IChRdWVyeU1ldGFEYXRhW10pIHF1ZXJpZXMudG9BcnJh\neQogICAgICAgICAgICAgICAgKG5ldyBRdWVyeU1ldGFEYXRhW3F1ZXJpZXMu\nc2l6ZSgpXSk7CiAgICAgICAgICAgIEFycmF5cy5zb3J0KF9xdWVyaWVzLCB0\naGlzKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBRdWVyeU1ldGFEYXRh\nW10gZ2V0UXVlcmllcygpIHsKICAgICAgICAgICAgcmV0dXJuIF9xdWVyaWVz\nOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogQ29tcGFyZSBx\ndWVyeSBtZXRhZGF0YS4gTm9ybWFsIHF1ZXJpZXMgYXBwZWFyIGJlZm9yZSBu\nYXRpdmUgcXVlcmllcy4KICAgICAgICAgKiBJZiB0aGUgZ2l2ZW4gcXVlcmll\ncyB1c2Ugc2FtZSBsYW5ndWFnZSwgdGhlbiB0aGVpciBuYW1lcyBhcmUKICAg\nICAgICAgKiBjb21wYXJlZC4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\naW50IGNvbXBhcmUoUXVlcnlNZXRhRGF0YSBvMSwgUXVlcnlNZXRhRGF0YSBv\nMikgewogICAgICAgICAgICAvLyBub3JtYWwgcXVlcmllcyBiZWZvcmUgbmF0\naXZlCiAgICAgICAgICAgIGlmICghU3RyaW5nVXRpbHMuZXF1YWxzKG8xLmdl\ndExhbmd1YWdlKCksIG8yLmdldExhbmd1YWdlKCkpKSB7CiAgICAgICAgICAg\nICAgICBpZiAoUXVlcnlMYW5ndWFnZXMuTEFOR19TUUwuZXF1YWxzKG8xLmdl\ndExhbmd1YWdlKCkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAxOwog\nICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbzEuZ2V0\nTmFtZSgpLmNvbXBhcmVUbyhvMi5nZXROYW1lKCkpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIEZpbGUgZ2V0U291cmNlRmlsZSgpIHsKICAgICAgICAg\nICAgcmV0dXJuIF9xdWVyaWVzWzBdLmdldFNvdXJjZUZpbGUoKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBPYmplY3QgZ2V0U291cmNlU2NvcGUoKSB7\nCiAgICAgICAgICAgIHJldHVybiBfcXVlcmllc1swXS5nZXRTb3VyY2VTY29w\nZSgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBnZXRTb3VyY2VU\neXBlKCkgewogICAgICAgICAgICByZXR1cm4gX3F1ZXJpZXNbMF0uZ2V0U291\ncmNlVHlwZSgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyBn\nZXRSZXNvdXJjZU5hbWUoKSB7CiAgICAgICAgICAgIHJldHVybiBfcXVlcmll\nc1swXS5nZXRSZXNvdXJjZU5hbWUoKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBpbnQgZ2V0TGluZU51bWJlcigpIHsKICAgICAgICAgICAgcmV0dXJu\nIF9xdWVyaWVzWzBdLmdldExpbmVOdW1iZXIoKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBpbnQgZ2V0Q29sTnVtYmVyKCkgewogICAgICAgICAgICBy\nZXR1cm4gX3F1ZXJpZXNbMF0uZ2V0Q29sTnVtYmVyKCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgaW50IGNvbXBhcmVUbyhDbGFzc1F1ZXJpZXMgb3Ro\nZXIpIHsKICAgICAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAg\nICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgaWYgKG90aGVyID09IG51\nbGwpCiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIENs\nYXNzIHNjb3BlID0gKENsYXNzKSBnZXRTb3VyY2VTY29wZSgpOwogICAgICAg\nICAgICBDbGFzcyBvc2NvcGUgPSAoQ2xhc3MpIG90aGVyLmdldFNvdXJjZVNj\nb3BlKCk7CiAgICAgICAgICAgIHJldHVybiBzY29wZS5nZXROYW1lKCkuY29t\ncGFyZVRvKG9zY29wZS5nZXROYW1lKCkpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIENvbXBhcmVzIGNsYXNlcywgc2VxdWVuY2VzLCBhbmQg\ncXVlcmllcyB0byBvcmRlciB0aGVtIGZvciBzZXJpYWxpemF0aW9uLgogICAg\nICogUGxhY2VzIHNlcXVlbmNlcyBmaXJzdCwgdGhlbiBjbGFzc2VzLCB0aGVu\nIHF1ZXJpZXMuIFNlcXVlbmNlcyBhbmQKICAgICAqIHF1ZXJpZXMgYXJlIG9y\nZGVyZWQgYWxwaGFiZXRpY2FsbHkgYnkgbmFtZS4gQ2xhc3NlcyBhcmUgcGxh\nY2VkIGluCiAgICAgKiBsaXN0aW5nIG9yZGVyLCBpbiBpbmhlcml0YW5jZSBv\ncmRlciB3aXRoaW4gdGhhdCwgYW5kIGluIGFscGhhYmV0aWNhbAogICAgICog\nb3JkZXIgd2l0aGluIHRoYXQuCiAgICAgKgogICAgICogQGF1dGhvciBTdGVw\naGVuIEtpbQogICAgICovCiAgICBwcm90ZWN0ZWQgY2xhc3MgU2VyaWFsaXph\ndGlvbkNvbXBhcmF0b3IKICAgICAgICBleHRlbmRzIE1ldGFEYXRhSW5oZXJp\ndGFuY2VDb21wYXJhdG9yIHsKCiAgICAgICAgcHVibGljIGludCBjb21wYXJl\nKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7CiAgICAgICAgICAgIGlmIChvMSA9\nPSBvMikKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICBp\nZiAobzEgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAg\nICAgICAgICBpZiAobzIgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVy\nbiAtMTsKCiAgICAgICAgICAgIGludCB0MSA9IHR5cGUobzEpOwogICAgICAg\nICAgICBpbnQgdDIgPSB0eXBlKG8yKTsKICAgICAgICAgICAgaWYgKHQxICE9\nIHQyKQogICAgICAgICAgICAgICAgcmV0dXJuIHQxIC0gdDI7CgogICAgICAg\nICAgICBzd2l0Y2ggKHQxKSB7CiAgICAgICAgICAgICAgICBjYXNlIFRZUEVf\nTUVUQToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZSgoQ2xh\nc3NNZXRhRGF0YSkgbzEsIChDbGFzc01ldGFEYXRhKSBvMik7CiAgICAgICAg\nICAgICAgICBjYXNlIFRZUEVfUVVFUlk6CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIGNvbXBhcmUoKFF1ZXJ5TWV0YURhdGEpIG8xLCAoUXVlcnlNZXRh\nRGF0YSkgbzIpOwogICAgICAgICAgICAgICAgY2FzZSBUWVBFX1NFUToKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZSgoU2VxdWVuY2VNZXRh\nRGF0YSkgbzEsCiAgICAgICAgICAgICAgICAgICAgICAgIChTZXF1ZW5jZU1l\ndGFEYXRhKSBvMik7CiAgICAgICAgICAgICAgICBjYXNlIFRZUEVfQ0xBU1Nf\nUVVFUklFUzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChDb21wYXJh\nYmxlKSBvMSkuY29tcGFyZVRvKG8yKTsKICAgICAgICAgICAgICAgIGNhc2Ug\nVFlQRV9DTEFTU19TRVFTOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAo\nKENvbXBhcmFibGUpIG8xKS5jb21wYXJlVG8obzIpOwogICAgICAgICAgICAg\nICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFy\nZVVua25vd24obzEsIG8yKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgLyoqCiAgICAgICAgICogQ29tcGFyZSB0d28gdW5yZWNvZ25pemVk\nIGVsZW1lbnRzIG9mIHRoZSBzYW1lIHR5cGUuIFRocm93cwogICAgICAgICAq\nIGV4Y2VwdGlvbiBieSBkZWZhdWx0LgogICAgICAgICAqLwogICAgICAgIHBy\nb3RlY3RlZCBpbnQgY29tcGFyZVVua25vd24oT2JqZWN0IG8xLCBPYmplY3Qg\nbzIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9u\nKCk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDb21wYXJl\nIGJldHdlZW4gdHdvIGNsYXNzIG1ldGFkYXRhLgogICAgICAgICAqLwogICAg\nICAgIHByaXZhdGUgaW50IGNvbXBhcmUoQ2xhc3NNZXRhRGF0YSBvMSwgQ2xh\nc3NNZXRhRGF0YSBvMikgewogICAgICAgICAgICBpbnQgbGkxID0gbzEuZ2V0\nTGlzdGluZ0luZGV4KCk7CiAgICAgICAgICAgIGludCBsaTIgPSBvMi5nZXRM\naXN0aW5nSW5kZXgoKTsKICAgICAgICAgICAgaWYgKGxpMSA9PSAtMSAmJiBs\naTIgPT0gLTEpIHsKICAgICAgICAgICAgICAgIE1ldGFEYXRhVGFnIHQxID0g\nZ2V0RW50aXR5VGFnKG8xKTsKICAgICAgICAgICAgICAgIE1ldGFEYXRhVGFn\nIHQyID0gZ2V0RW50aXR5VGFnKG8yKTsKICAgICAgICAgICAgICAgIGlmICh0\nMS5jb21wYXJlVG8odDIpICE9IDApCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHQxLmNvbXBhcmVUbyh0Mik7CiAgICAgICAgICAgICAgICBpbnQgaW5o\nZXIgPSBzdXBlci5jb21wYXJlKG8xLCBvMik7CiAgICAgICAgICAgICAgICBp\nZiAoaW5oZXIgIT0gMCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5o\nZXI7CiAgICAgICAgICAgICAgICByZXR1cm4gbzEuZ2V0RGVzY3JpYmVkVHlw\nZSgpLmdldE5hbWUoKS5jb21wYXJlVG8KICAgICAgICAgICAgICAgICAgICAo\nbzIuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKSk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIGlmIChsaTEgPT0gLTEpCiAgICAgICAgICAgICAg\nICByZXR1cm4gMTsKICAgICAgICAgICAgaWYgKGxpMiA9PSAtMSkKICAgICAg\nICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgcmV0dXJuIGxpMSAt\nIGxpMjsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIENvbXBh\ncmUgcXVlcnkgbWV0YWRhdGEuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0\nZSBpbnQgY29tcGFyZShRdWVyeU1ldGFEYXRhIG8xLCBRdWVyeU1ldGFEYXRh\nIG8yKSB7CiAgICAgICAgICAgIC8vIG5vcm1hbCBxdWVyaWVzIGJlZm9yZSBu\nYXRpdmUKICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5lcXVhbHMobzEu\nZ2V0TGFuZ3VhZ2UoKSwgbzIuZ2V0TGFuZ3VhZ2UoKSkpIHsKICAgICAgICAg\nICAgICAgIGlmIChRdWVyeUxhbmd1YWdlcy5MQU5HX1NRTC5lcXVhbHMobzEu\nZ2V0TGFuZ3VhZ2UoKSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7\nCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBvMS5n\nZXROYW1lKCkuY29tcGFyZVRvKG8yLmdldE5hbWUoKSk7CiAgICAgICAgfQoK\nICAgICAgICAvKioKICAgICAgICAgKiBDb21wYXJlIHNlcXVlbmNlIG1ldGFk\nYXRhLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgaW50IGNvbXBhcmUo\nU2VxdWVuY2VNZXRhRGF0YSBvMSwgU2VxdWVuY2VNZXRhRGF0YSBvMikgewog\nICAgICAgICAgICByZXR1cm4gbzEuZ2V0TmFtZSgpLmNvbXBhcmVUbyhvMi5n\nZXROYW1lKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNv\ncnRzIGZpZWxkcyBhY2NvcmRpbmcgdG8gbGlzdGluZyBvcmRlciwgdGhlbiBY\nU0Qgc3RyYXRlZ3kgb3JkZXIsCiAgICAgKiB0aGVuIG5hbWUgb3JkZXIuCiAg\nICAgKi8KICAgIHByaXZhdGUgY2xhc3MgRmllbGRDb21wYXJhdG9yCiAgICAg\nICAgaW1wbGVtZW50cyBDb21wYXJhdG9yIHsKCiAgICAgICAgcHVibGljIGlu\ndCBjb21wYXJlKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7CiAgICAgICAgICAg\nIEZpZWxkTWV0YURhdGEgZm1kMSA9IChGaWVsZE1ldGFEYXRhKSBvMTsKICAg\nICAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQyID0gKEZpZWxkTWV0YURhdGEp\nIG8yOwogICAgICAgICAgICBpZiAoZm1kMS5pc1ByaW1hcnlLZXkoKSkgewog\nICAgICAgICAgICAgICAgaWYgKGZtZDIuaXNQcmltYXJ5S2V5KCkpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIGZtZDEuY29tcGFyZVRvKGZtZDIpOwog\nICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGlmIChmbWQyLmlzUHJpbWFyeUtleSgpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIDE7CgogICAgICAgICAgICBpZiAoZm1kMS5pc1ZlcnNpb24o\nKSkgewogICAgICAgICAgICAgICAgaWYgKGZtZDIuaXNWZXJzaW9uKCkpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmVMaXN0aW5nT3JkZXIo\nZm1kMSwgZm1kMik7CgkJCQlyZXR1cm4gZ2V0U3RyYXRlZ3koZm1kMikgPT0g\nUGVyc2lzdGVuY2VTdHJhdGVneS5CQVNJQyA/IDEgOiAtMTsKCQkJfQoJCQlp\nZiAoZm1kMi5pc1ZlcnNpb24oKSkKCQkJCXJldHVybiBnZXRTdHJhdGVneShm\nbWQxKSA9PSBQZXJzaXN0ZW5jZVN0cmF0ZWd5LkJBU0lDID8gLTEgOiAxOwoK\nCQkJaW50IHN0Y21wID0gZ2V0U3RyYXRlZ3koZm1kMSkuY29tcGFyZVRvKGdl\ndFN0cmF0ZWd5KGZtZDIpKTsKICAgICAgICAgICAgaWYgKHN0Y21wICE9IDAp\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3RjbXA7CiAgICAgICAgICAgIHJl\ndHVybiBjb21wYXJlTGlzdGluZ09yZGVyKGZtZDEsIGZtZDIpOwogICAgICAg\nIH0KCiAgICAgICAgcHJpdmF0ZSBpbnQgY29tcGFyZUxpc3RpbmdPcmRlcihG\naWVsZE1ldGFEYXRhIGZtZDEsIEZpZWxkTWV0YURhdGEgZm1kMil7CiAgICAg\nICAgICAgIGludCBsY21wID0gZm1kMS5nZXRMaXN0aW5nSW5kZXgoKSAtIGZt\nZDIuZ2V0TGlzdGluZ0luZGV4KCk7CiAgICAgICAgICAgIGlmIChsY21wICE9\nIDApCiAgICAgICAgICAgICAgICByZXR1cm4gbGNtcDsKICAgICAgICAgICAg\ncmV0dXJuIGZtZDEuY29tcGFyZVRvKGZtZDIpOwoJCX0KCX0KfQo=\n","encoding":"base64"}

