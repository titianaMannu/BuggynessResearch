{"sha":"093774627730694a835ceff1d686fdb731c93b4b","node_id":"MDQ6QmxvYjIwNjM2NDowOTM3NzQ2Mjc3MzA2OTRhODM1Y2VmZjFkNjg2ZmRiNzMxYzkzYjRi","size":15856,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/093774627730694a835ceff1d686fdb731c93b4b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7\nCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwu\nTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5j\nb25jdXJyZW50LkNvbmN1cnJlbnRIYXNoTWFwOwoKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlBlcnNpc3RlbmNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5U\nZXN0Q2FzZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJu\nZWwuSkRCQ1N0b3JlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VySW1wbDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnlTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuT3BlbkpQQVBlcnNpc3RlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLnJlbGF0aW9ucy5UYmxDaGlsZDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5yZWxhdGlvbnMuVGJs\nR3JhbmRDaGlsZDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5yZWxhdGlvbnMuVGJsUGFyZW50OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLnNpbXBsZS5QZXJzb247CgovKgogKiBWZXJp\nZnkgbXVsdGlwbGUgcGVybXV0YXRpb25zIG9mIG9wZW5qcGEuamRiYy5RdWVy\neVNRTENhY2hlIHNldHRpbmdzLgogKi8KcHVibGljIGNsYXNzIFRlc3RRdWVy\neVNRTENhY2hlCiAgICBleHRlbmRzIFRlc3RDYXNlIHsKICAgIAogICAgZmlu\nYWwgaW50IG5UaHJlYWRzID0gNTsKICAgIGZpbmFsIGludCBuUGVvcGxlID0g\nMTAwOwogICAgZmluYWwgaW50IG5JdGVyYXRpb25zID0gMTA7CgogICAgLyoK\nICAgICAqIFZlcmlmeSBRdWVyeVNRTENhY2hlVmFsdWUgc2V0dGluZyAiYWxs\nIiBpcyBjYWNoaW5nIHF1ZXJpZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHRlc3RBbGxDYWNoZVNldHRpbmcoKSB7CiAgICAgICAgTWFwIHByb3BzID0g\nbmV3IEhhc2hNYXAoU3lzdGVtLmdldFByb3BlcnRpZXMoKSk7CiAgICAgICAg\ncHJvcHMucHV0KCJvcGVuanBhLk1ldGFEYXRhRmFjdG9yeSIsICJqcGEoVHlw\nZXM9IiAKICAgICAgICAgICAgKyBQZXJzb24uY2xhc3MuZ2V0TmFtZSgpICsg\nIikiKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5qcGEuamRiYy5RdWVyeVNR\nTENhY2hlIiwgImFsbCIpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSSBlbWYgPSAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5\nU1BJKQogICAgICAgICAgICBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdCgKICAg\nICAgICAgICAgICAgIFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJG\nYWN0b3J5KCJ0ZXN0IiwgcHJvcHMpKTsKICAgICAgICAKICAgICAgICBFbnRp\ndHlNYW5hZ2VySW1wbCBlbSA9IChFbnRpdHlNYW5hZ2VySW1wbCllbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEJyb2tlckltcGwgYnJva2Vy\nID0gKEJyb2tlckltcGwpIGVtLmdldEJyb2tlcigpOwogICAgICAgIERlbGVn\nYXRpbmdTdG9yZU1hbmFnZXIgZHN0b3JlID0gYnJva2VyLmdldFN0b3JlTWFu\nYWdlcigpOwogICAgICAgIEpEQkNTdG9yZU1hbmFnZXIganN0b3JlID0gCiAg\nICAgICAgICAgIChKREJDU3RvcmVNYW5hZ2VyKWRzdG9yZS5nZXRJbm5lcm1v\nc3REZWxlZ2F0ZSgpOwoKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJl\nZ2luKCk7CiAgICAgICAgUGVyc29uIHAgPSBuZXcgUGVyc29uKCk7CiAgICAg\nICAgcC5zZXRJZCgxKTsKICAgICAgICBlbS5wZXJzaXN0KHApOwogICAgICAg\nIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21t\naXQoKTsKICAgICAgICAKICAgICAgICBQZXJzb24gcDEgPSBlbS5maW5kKFBl\ncnNvbi5jbGFzcywgMSk7CiAgICAgICAgTWFwIHNxbENhY2hlID0ganN0b3Jl\nLmdldFF1ZXJ5U1FMQ2FjaGUoKTsKICAgICAgICBTZXQga2V5cyA9IHNxbENh\nY2hlLmtleVNldCgpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGtl\neXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAg\nIE1hcCBjYWNoZU1hcCA9IChNYXApIGl0ZXIubmV4dCgpOwogICAgICAgICAg\nICAvL21ha2Ugc3VyZSB0aGVyZSBpcyBhbiBlbnRyeSBpbiB0aGUgY2FjaGUK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGNhY2hlTWFwLnNpemUoKSk7\nICAgCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5yZW1vdmUocCk7CiAgICAgICAg\nZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1p\ndCgpOwogICAgICAgIAogICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgZW1m\nLmNsb3NlKCk7CiAgICB9CiAgICAKICAgIC8qCiAgICAgKiBWZXJpZnkgUXVl\ncnlTUUxDYWNoZVZhbHVlIHNldHRpbmcgInRydWUiIHVzZXMgdGhlIGV4cGVj\ndGVkIGNhY2hlCiAgICAgKiBpbXBsZW1lbnRhdGlvbiBhbmQgaXMgY2FjaGlu\nZy4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdFRydWVDYWNoZVNldHRp\nbmcoKSB7CiAgICAgICAgTWFwIHByb3BzID0gbmV3IEhhc2hNYXAoU3lzdGVt\nLmdldFByb3BlcnRpZXMoKSk7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBh\nLk1ldGFEYXRhRmFjdG9yeSIsICJqcGEoVHlwZXM9IiAKICAgICAgICAgICAg\nKyBQZXJzb24uY2xhc3MuZ2V0TmFtZSgpICsgIikiKTsKICAgICAgICBwcm9w\ncy5wdXQoIm9wZW5qcGEuamRiYy5RdWVyeVNRTENhY2hlIiwgInRydWUiKTsK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mID0g\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkKICAgICAgICAgICAg\nT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoCiAgICAgICAgICAgICAgICBQZXJz\naXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgidGVzdCIsIHBy\nb3BzKSk7CiAgICAgICAgCiAgICAgICAgRW50aXR5TWFuYWdlckltcGwgZW0g\nPSAoRW50aXR5TWFuYWdlckltcGwpZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBCcm9rZXJJbXBsIGJyb2tlciA9IChCcm9rZXJJbXBsKSBl\nbS5nZXRCcm9rZXIoKTsKICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2Vy\nIGRzdG9yZSA9IGJyb2tlci5nZXRTdG9yZU1hbmFnZXIoKTsKICAgICAgICBK\nREJDU3RvcmVNYW5hZ2VyIGpzdG9yZSA9IAogICAgICAgICAgICAoSkRCQ1N0\nb3JlTWFuYWdlcilkc3RvcmUuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAg\nICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAg\nICAgICAgUGVyc29uIHAgPSBuZXcgUGVyc29uKCk7CiAgICAgICAgcC5zZXRJ\nZCgxKTsKICAgICAgICBlbS5wZXJzaXN0KHApOwogICAgICAgIGVtLmZsdXNo\nKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAg\nICAgICAKICAgICAgICBQZXJzb24gcDEgPSBlbS5maW5kKFBlcnNvbi5jbGFz\ncywgMSk7CiAgICAgICAgTWFwIHNxbENhY2hlID0ganN0b3JlLmdldFF1ZXJ5\nU1FMQ2FjaGUoKTsKICAgICAgICBTZXQga2V5cyA9IHNxbENhY2hlLmtleVNl\ndCgpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGtleXMuaXRlcmF0\nb3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIE1hcCBjYWNo\nZU1hcCA9IChNYXApIGl0ZXIubmV4dCgpOwogICAgICAgICAgICAvL21ha2Ug\nc3VyZSB0aGVyZSBpcyBhbiBlbnRyeSBpbiB0aGUgY2FjaGUKICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKDEsIGNhY2hlTWFwLnNpemUoKSk7ICAgCiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVn\naW4oKTsKICAgICAgICBlbS5yZW1vdmUocCk7CiAgICAgICAgZW0uZmx1c2go\nKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAg\nICAgIAogICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgZW1mLmNsb3NlKCk7\nCiAgICB9CgogICAgLyoKICAgICAqIFZlcmlmeSBjYWNoaW5nIGlzIGRpc2Fi\nbGVkIHdoZW4gdGhlIFF1ZXJ5U1FMQ2FjaGVWYWx1ZSBzZXR0aW5nIGlzIAog\nICAgICogImZhbHNlIi4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdEZh\nbHNlQ2FjaGVTZXR0aW5nKCkgewogICAgICAgIE1hcCBwcm9wcyA9IG5ldyBI\nYXNoTWFwKFN5c3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIHByb3Bz\nLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3RvcnkiLCAianBhKFR5cGVzPSIg\nCiAgICAgICAgICAgICsgUGVyc29uLmNsYXNzLmdldE5hbWUoKSArICIpIik7\nCiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLmpkYmMuUXVlcnlTUUxDYWNo\nZSIsICJmYWxzZSIpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSSBlbWYgPSAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJ\nKQogICAgICAgICAgICBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdCgKICAgICAg\nICAgICAgICAgIFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0\nb3J5KCJ0ZXN0IiwgcHJvcHMpKTsKICAgICAgICAKICAgICAgICBFbnRpdHlN\nYW5hZ2VySW1wbCBlbSA9IChFbnRpdHlNYW5hZ2VySW1wbCllbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIEJyb2tlckltcGwgYnJva2VyID0g\nKEJyb2tlckltcGwpIGVtLmdldEJyb2tlcigpOwogICAgICAgIERlbGVnYXRp\nbmdTdG9yZU1hbmFnZXIgZHN0b3JlID0gYnJva2VyLmdldFN0b3JlTWFuYWdl\ncigpOwogICAgICAgIEpEQkNTdG9yZU1hbmFnZXIganN0b3JlID0gCiAgICAg\nICAgICAgIChKREJDU3RvcmVNYW5hZ2VyKWRzdG9yZS5nZXRJbm5lcm1vc3RE\nZWxlZ2F0ZSgpOwogICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuYmVnaW4oKTsKICAgICAgICBQZXJzb24gcCA9IG5ldyBQZXJzb24oKTsK\nICAgICAgICBwLnNldElkKDEpOwogICAgICAgIGVtLnBlcnNpc3QocCk7CiAg\nICAgICAgZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmNvbW1pdCgpOwogICAgICAgIAogICAgICAgIFBlcnNvbiBwMSA9IGVtLmZp\nbmQoUGVyc29uLmNsYXNzLCAxKTsKCiAgICAgICAgYXNzZXJ0RmFsc2UoanN0\nb3JlLmlzUXVlcnlTUUxDYWNoZU9uKCkpOwogICAgICAgIAogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5yZW1vdmUo\ncCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmNvbW1pdCgpOwogICAgICAgIAogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICAgICAgZW1mLmNsb3NlKCk7CiAgICB9CgogICAgLyoKICAgICAqIFZl\ncmlmeSBRdWVyeVNRTENhY2hlVmFsdWUgc2V0dGluZyB3aXRoIGEgY3VzdG9t\nIGNhY2hlIGJhY2tlbmQgdXNlcwogICAgICogdGhlIGV4cGVjdGVkIGNhY2hl\nIGltcGxlbWVudGF0aW9uIGFuZCBpcyBjYWNoaW5nLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0Q3VzdG9tQ2FjaGVTZXR0aW5nKCkgewogICAgICAg\nIE1hcCBwcm9wcyA9IG5ldyBIYXNoTWFwKFN5c3RlbS5nZXRQcm9wZXJ0aWVz\nKCkpOwogICAgICAgIHByb3BzLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3Rv\ncnkiLCAianBhKFR5cGVzPSIgCiAgICAgICAgICAgICsgUGVyc29uLmNsYXNz\nLmdldE5hbWUoKSArICIpIik7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBh\nLmpkYmMuUXVlcnlTUUxDYWNoZSIsIAogICAgICAgICAgICAib3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5UZXN0UXVlcnlTUUxDYWNoZS5DdXN0b21DYWNo\nZU1hcCIpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQ\nSSBlbWYgPSAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJKQogICAg\nICAgICAgICBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdCgKICAgICAgICAgICAg\nICAgIFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KCJ0\nZXN0IiwgcHJvcHMpKTsKICAgICAgICAKICAgICAgICBFbnRpdHlNYW5hZ2Vy\nSW1wbCBlbSA9IChFbnRpdHlNYW5hZ2VySW1wbCllbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIEJyb2tlckltcGwgYnJva2VyID0gKEJyb2tl\nckltcGwpIGVtLmdldEJyb2tlcigpOwogICAgICAgIERlbGVnYXRpbmdTdG9y\nZU1hbmFnZXIgZHN0b3JlID0gYnJva2VyLmdldFN0b3JlTWFuYWdlcigpOwog\nICAgICAgIEpEQkNTdG9yZU1hbmFnZXIganN0b3JlID0gCiAgICAgICAgICAg\nIChKREJDU3RvcmVNYW5hZ2VyKWRzdG9yZS5nZXRJbm5lcm1vc3REZWxlZ2F0\nZSgpOwogICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVn\naW4oKTsKICAgICAgICBQZXJzb24gcCA9IG5ldyBQZXJzb24oKTsKICAgICAg\nICBwLnNldElkKDEpOwogICAgICAgIGVtLnBlcnNpc3QocCk7CiAgICAgICAg\nZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1p\ndCgpOwogICAgICAgIAogICAgICAgIFBlcnNvbiBwMSA9IGVtLmZpbmQoUGVy\nc29uLmNsYXNzLCAxKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZShqc3RvcmUuaXNR\ndWVyeVNRTENhY2hlT24oKSk7CgogICAgICAgIE1hcCBzcWxDYWNoZSA9IGpz\ndG9yZS5nZXRRdWVyeVNRTENhY2hlKCk7CiAgICAgICAgU2V0IGtleXMgPSBz\ncWxDYWNoZS5rZXlTZXQoKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIg\nPSBrZXlzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAg\nICAgICBNYXAgY2FjaGVNYXAgPSAoTWFwKSBpdGVyLm5leHQoKTsKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZSgoY2FjaGVNYXAgaW5zdGFuY2VvZiAKICAgICAg\nICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuVGVzdFF1ZXJ5\nU1FMQ2FjaGUuQ3VzdG9tQ2FjaGVNYXApKTsKICAgICAgICAgICAgLy9tYWtl\nIHN1cmUgdGhlcmUgaXMgYW4gZW50cnkgaW4gdGhlIGNhY2hlCiAgICAgICAg\nICAgIGFzc2VydEVxdWFscygxLCBjYWNoZU1hcC5zaXplKCkpOyAgIAogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJl\nZ2luKCk7CiAgICAgICAgZW0ucmVtb3ZlKHApOwogICAgICAgIGVtLmZsdXNo\nKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAg\nICAgICAKICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIGVtZi5jbG9zZSgp\nOwogICAgfQoKICAgIC8qCiAgICAgKiBWZXJpZnkgYW4gZXhjZXB0aW9uIGlz\nIHRocm93biBpZiBhIGJhZCBjYWNoZSBpbXBsZW1lbnRhdGlvbiBjbGFzcwog\nICAgICogaXMgc3BlY2lmaWVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0\nZXN0QmFkQ3VzdG9tQ2FjaGVTZXR0aW5nKCkgewogICAgICAgIE1hcCBwcm9w\ncyA9IG5ldyBIYXNoTWFwKFN5c3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAg\nICAgIHByb3BzLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3RvcnkiLCAianBh\nKFR5cGVzPSIgCiAgICAgICAgICAgICsgUGVyc29uLmNsYXNzLmdldE5hbWUo\nKSArICIpIik7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLmpkYmMuUXVl\ncnlTUUxDYWNoZSIsIAogICAgICAgICAgICAib3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5UZXN0UXVlcnlTUUxDYWNoZS5CYWRDYWNoZU1hcCIpOwogICAg\nICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeVNQSSBlbWYgPSAKICAgICAgICAgICAgICAgIChPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpT3BlbkpQQVBlcnNpc3RlbmNl\nLmNhc3QoCiAgICAgICAgICAgICAgICAgICAgICAgIFBlcnNpc3RlbmNlLmNy\nZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KCJ0ZXN0IiwgcHJvcHMpKTsKICAg\nICAgICAgICAgLy8gRU1GIGNyZWF0aW9uIHNob3VsZCB0aHJvdyBhbiBleGNl\ncHRpb24gYmVjYXVzZSB0aGUgY2FjaGUgCiAgICAgICAgICAgIC8vIGltcGxl\nbWVudGF0aW9uIGNsYXNzIHdpbGwgbm90IGJlIGZvdW5kLgogICAgICAgICAg\nICBhc3NlcnRGYWxzZShmYWxzZSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSh0cnVlKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoKICAgICAqIFZlcmlmeSBtdWx0aS10aHJlYWRl\nZCBtdWx0aS1lbnRpdHkgbWFuYWdlciBmaW5kZXIgd29ya3Mgd2l0aCB0aGUK\nICAgICAqIFF1ZXJ5U1FMQ2FjaGUgc2V0IHRvICJhbGwiLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0TXVsdGlFTUNhY2hpbmdBbGwoKSB7CiAgICAg\nICAgTWFwIHByb3BzID0gbmV3IEhhc2hNYXAoU3lzdGVtLmdldFByb3BlcnRp\nZXMoKSk7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLk1ldGFEYXRhRmFj\ndG9yeSIsICJqcGEoVHlwZXM9IiAKICAgICAgICAgICAgKyBQZXJzb24uY2xh\nc3MuZ2V0TmFtZSgpICsgIikiKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5q\ncGEuamRiYy5RdWVyeVNRTENhY2hlIiwgCiAgICAgICAgICAgICJhbGwiKTsK\nICAgICAgICBydW5NdWx0aUVNQ2FjaGluZyhwcm9wcyk7ICAgICAgICAKICAg\nIH0KCiAgICAvKgogICAgICogVmVyaWZ5IG11bHRpLXRocmVhZGVkIG11bHRp\nLWVudGl0eSBtYW5hZ2VyIGZpbmRlciB3b3JrcyB3aXRoIHRoZQogICAgICog\nUXVlcnlTUUxDYWNoZSBzZXQgdG8gInRydWUiLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCB0ZXN0TXVsdGlFTUNhY2hpbmdUcnVlKCkgewogICAgICAgIE1h\ncCBwcm9wcyA9IG5ldyBIYXNoTWFwKFN5c3RlbS5nZXRQcm9wZXJ0aWVzKCkp\nOwogICAgICAgIHByb3BzLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3Rvcnki\nLCAianBhKFR5cGVzPSIgCiAgICAgICAgICAgICsgUGVyc29uLmNsYXNzLmdl\ndE5hbWUoKSArICIpIik7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLmpk\nYmMuUXVlcnlTUUxDYWNoZSIsIAogICAgICAgICAgICAidHJ1ZSIpOwogICAg\nICAgIHJ1bk11bHRpRU1DYWNoaW5nKHByb3BzKTsKICAgIH0KCiAgICAvKgog\nICAgICogVmVyaWZ5IFF1ZXJ5U1FMQ2FjaGVWYWx1ZSBzZXR0aW5nICJ0cnVl\nIiB1c2VzIHRoZSBleHBlY3RlZCBjYWNoZQogICAgICogaW1wbGVtZW50YXRp\nb24gYW5kIGlzIGNhY2hpbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRl\nc3RFYWdlckZldGNoKCkgewogICAgICAgIE1hcCBwcm9wcyA9IG5ldyBIYXNo\nTWFwKFN5c3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIHByb3BzLnB1\ndCgib3BlbmpwYS5NZXRhRGF0YUZhY3RvcnkiLCAianBhKFR5cGVzPSIKICAg\nICAgICAgICAgKyBUYmxDaGlsZC5jbGFzcy5nZXROYW1lKCkgKyAiOyIKICAg\nICAgICAgICAgKyBUYmxHcmFuZENoaWxkLmNsYXNzLmdldE5hbWUoKSArICI7\nIgogICAgICAgICAgICArIFRibFBhcmVudC5jbGFzcy5nZXROYW1lKCkgKyAi\nKSIpOwogICAgICAgIHByb3BzLnB1dCgib3BlbmpwYS5qZGJjLlF1ZXJ5U1FM\nQ2FjaGUiLCAidHJ1ZSIpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSSBlbWYgPSAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5\nU1BJKQogICAgICAgICAgICBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdCgKICAg\nICAgICAgICAgICAgIFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJG\nYWN0b3J5KCJ0ZXN0IiwgcHJvcHMpKTsKICAgICAgICAKICAgICAgICBFbnRp\ndHlNYW5hZ2VySW1wbCBlbSA9IChFbnRpdHlNYW5hZ2VySW1wbCllbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIAogICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IDI7IGkrKykgewogICAgICAgIAlUYmxQYXJlbnQgcCA9IG5ldyBUYmxQ\nYXJlbnQoKTsKICAgICAgICAJcC5zZXRQYXJlbnRJZChpKTsKICAgIAkJVGJs\nQ2hpbGQgYyA9IG5ldyBUYmxDaGlsZCgpOwogICAgCQljLnNldENoaWxkSWQo\naSk7CiAgICAgICAgICAgIGMuc2V0VGJsUGFyZW50KHApOwogICAgICAgICAg\nICBwLmFkZFRibENoaWxkKGMpOwogICAgIAkJZW0ucGVyc2lzdChwKTsKICAg\nIAkJZW0ucGVyc2lzdChjKTsKCiAgICAJCVRibEdyYW5kQ2hpbGQgZ2MgPSBu\nZXcgVGJsR3JhbmRDaGlsZCgpOwogICAgCQlnYy5zZXRHcmFuZENoaWxkSWQo\naSk7CiAgICAJCWdjLnNldFRibENoaWxkKGMpOwogICAgCQljLmFkZFRibEdy\nYW5kQ2hpbGQoZ2MpOwogICAgCQkKICAgIAkJZW0ucGVyc2lzdChwKTsKICAg\nIAkJZW0ucGVyc2lzdChjKTsKICAgIAkJZW0ucGVyc2lzdChnYyk7CiAgICAg\nICAgfQogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBlbS5jbGVhcigpOwogICAgICAg\nIAogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMjsgaSsrKSB7CiAgICAg\nICAgCVRibFBhcmVudCBwID0gZW0uZmluZChUYmxQYXJlbnQuY2xhc3MsIGkp\nOwogICAgICAgIAlpbnQgcGlkID0gcC5nZXRQYXJlbnRJZCgpOwogICAgICAg\nIAlhc3NlcnRFcXVhbHMocGlkLCBpKTsKICAgICAgICAJQ29sbGVjdGlvbjxU\nYmxDaGlsZD4gY2hpbGRyZW4gPSBwLmdldFRibENoaWxkcmVuKCk7CiAgICAg\nICAgCWJvb2xlYW4gaGFzQ2hpbGQgPSBmYWxzZTsKICAgICAgICAJZm9yIChU\nYmxDaGlsZCBjIDogY2hpbGRyZW4pIHsKICAgICAgICAJCWhhc0NoaWxkID0g\ndHJ1ZTsKICAgICAgICAJCUNvbGxlY3Rpb248VGJsR3JhbmRDaGlsZD4gZ2No\naWxkcmVuID0gYy5nZXRUYmxHcmFuZENoaWxkcmVuKCk7CiAgICAgICAgCQlp\nbnQgY2lkID0gYy5nZXRDaGlsZElkKCk7CiAgICAgICAgCQlhc3NlcnRFcXVh\nbHMoY2lkLCBpKTsKCSAgICAgICAgCWJvb2xlYW4gaGFzR3JhbmRDaGlsZCA9\nIGZhbHNlOwogICAgICAgIAkJZm9yIChUYmxHcmFuZENoaWxkIGdjIDogZ2No\naWxkcmVuKSB7CiAgICAgICAgCQkJaGFzR3JhbmRDaGlsZCA9IHRydWU7CiAg\nICAgICAgCQkJaW50IGdjSWQgPSBnYy5nZXRHcmFuZENoaWxkSWQoKTsKICAg\nICAgICAJCQlhc3NlcnRFcXVhbHMoZ2NJZCwgaSk7CiAgICAgICAgCQl9CiAg\nICAgICAgCQlhc3NlcnRUcnVlKGhhc0dyYW5kQ2hpbGQpOwogICAgICAgIAl9\nCiAgICAgICAgCWFzc2VydFRydWUoaGFzQ2hpbGQpOwogICAgICAgIH0KICAg\nICAgICBlbS5jbG9zZSgpOwogICAgICAgIGVtZi5jbG9zZSgpOwogICAgfQoK\nICAgIHByaXZhdGUgdm9pZCBydW5NdWx0aUVNQ2FjaGluZyhNYXAgcHJvcHMp\nIHsKCiAgICAgICAgRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mYWMgPSAKICAg\nICAgICAgICAgICAgIFBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJG\nYWN0b3J5KCJ0ZXN0IiwgcHJvcHMpOwoKICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gZW1mYWMuY3JlYXRlRW50aXR5TWFuYWdlcigpOyAgICAgICAgICAg\nIAoKICAgICAgICAvLyBDcmVhdGUgc29tZSBlbnRpdGllcwogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IG5QZW9wbGU7IGkrKykKICAgICAgICB7CiAgICAgICAgICAg\nIFBlcnNvbiBwID0gbmV3IFBlcnNvbigpOwogICAgICAgICAgICBwLnNldElk\nKGkpOwogICAgICAgICAgICBlbS5wZXJzaXN0KHApOwogICAgICAgIH0KICAg\nICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCku\nY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKCiAgICAgICAgVGhyZWFk\nW10gbmV3VGhyZWFkcyA9IG5ldyBUaHJlYWRbblRocmVhZHNdOwogICAgICAg\nIEZpbmRQZW9wbGVbXSBjdXN0b21lciA9IG5ldyBGaW5kUGVvcGxlW25UaHJl\nYWRzXTsKICAgICAgICAKICAgICAgICBmb3IgKGludCBpPTA7IGkgPCBuVGhy\nZWFkczsgaSsrKSB7CiAgICAgICAgICAgIGN1c3RvbWVyW2ldID0gbmV3IEZp\nbmRQZW9wbGUoZW1mYWMsIDAsIG5QZW9wbGUsIAogICAgICAgICAgICAgICAg\nbkl0ZXJhdGlvbnMsIGkpOwogICAgICAgICAgICBuZXdUaHJlYWRzW2ldID0g\nbmV3IFRocmVhZChjdXN0b21lcltpXSk7CiAgICAgICAgICAgIG5ld1RocmVh\nZHNbaV0uc3RhcnQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8g\nV2FpdCBmb3IgdGhlIHdvcmtlciB0aHJlYWRzIHRvIGNvbXBsZXRlCiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuVGhyZWFkczsgaSsrKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBuZXdUaHJlYWRzW2ldLmpv\naW4oKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgdGhpcy5mYWlsKCJDYXVnaHQgSW50\nZXJydXB0ZWQgRXhjZXB0aW9uOiAiICsgZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9ICAgCgogICAgICAgIC8vIFJ1biB0aHJvdWdoIHRoZSBzdGF0ZSBv\nZiBhbGwgcnVubmFibGVzIHRvIGFzc2VydCBpZiBhbnkgb2YgdGhlbQogICAg\nICAgIC8vIGZhaWxlZC4KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG5U\naHJlYWRzOyBpKyspIHsKICAgICAgICAgICAgYXNzZXJ0RmFsc2UoY3VzdG9t\nZXJbaV0uaGFkRmFpbHVyZXMoKSk7CiAgICAgICAgfQoKICAgICAgICAvLyBD\nbGVhbiB1cCB0aGUgZW50aXRpZXMgdXNlZCBpbiB0aGlzIHRlc3QKICAgICAg\nICBlbSA9IGVtZmFjLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsgICAgICAgICAg\nICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CgogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgblBlb3BsZTsgaSsrKSB7CiAgICAg\nICAgICAgIFBlcnNvbiBwID0gZW0uZmluZChQZXJzb24uY2xhc3MsIGkpOwog\nICAgICAgICAgICBlbS5yZW1vdmUocCk7CiAgICAgICAgfQogICAgICAgIGVt\nLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQo\nKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQogICAgCiAgICAvKgogICAg\nICogRW1wdHkgQ29uY3VycmVudEhhc2hNYXAgc3ViY2xhc3MuIFVzZWZ1bCBm\nb3IgdGVzdGluZyBjdXN0b20gY2FjaGUKICAgICAqIHN0b3JhZ2UgaW1wbGVt\nZW50YXRpb25zLgogICAgICovCiAgICBwdWJsaWMgY2xhc3MgQ3VzdG9tQ2Fj\naGVNYXAgZXh0ZW5kcyBDb25jdXJyZW50SGFzaE1hcCB7CiAgICAgICAgCiAg\nICB9CgogICAgLyoKICAgICAqIFNpbXBsZSBydW5uYWJsZSB0byB0ZXN0IGZp\nbmRlciBpbiBhIHRpZ2h0IGxvb3AuICBNdWx0aXBsZSBpbnN0YW5jZXMKICAg\nICAqIG9mIHRoaXMgcnVubmFibGUgd2lsbCBydW4gc2ltdWx0YW5lb3VzbHku\nCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgRmluZFBlb3BsZSBpbXBsZW1l\nbnRzIFJ1bm5hYmxlIHsKICAgICAgICAKICAgICAgICBwcml2YXRlIGludCBz\ndGFydElkOwogICAgICAgIHByaXZhdGUgaW50IGVuZElkOwogICAgICAgIHBy\naXZhdGUgaW50IHRocmVhZDsKICAgICAgICBwcml2YXRlIGludCBpdGVyYXRp\nb25zOwogICAgICAgIHByaXZhdGUgRW50aXR5TWFuYWdlckZhY3RvcnkgZW1m\nOwogICAgICAgIHByaXZhdGUgYm9vbGVhbiBmYWlsdXJlcyA9IGZhbHNlOwog\nICAgICAgIAogICAgICAgIHB1YmxpYyBGaW5kUGVvcGxlKEVudGl0eU1hbmFn\nZXJGYWN0b3J5IGVtZiwgCiAgICAgICAgICAgIGludCBzdGFydElkLCBpbnQg\nZW5kSWQsIGludCBpdGVyYXRpb25zLCBpbnQgdGhyZWFkKSB7CiAgICAgICAg\nICAgIHN1cGVyKCk7CiAgICAgICAgICAgIHRoaXMuc3RhcnRJZCA9IHN0YXJ0\nSWQ7CiAgICAgICAgICAgIHRoaXMuZW5kSWQgPSBlbmRJZDsKICAgICAgICAg\nICAgdGhpcy50aHJlYWQgPSB0aHJlYWQ7CiAgICAgICAgICAgIHRoaXMuaXRl\ncmF0aW9ucyA9IGl0ZXJhdGlvbnM7CiAgICAgICAgICAgIHRoaXMuZW1mID0g\nZW1mOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBoYWRGYWlsdXJlcygpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4g\nZmFpbHVyZXM7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2\nb2lkIHJ1bigpIHsKICAgICAgICAgICAgdHJ5IHsgICAgICAgICAgICAKICAg\nICAgICAgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOyAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9y\nIChpbnQgaiA9IDA7IGogPCBpdGVyYXRpb25zOyBqKyspIHsKICAgICAgICAg\nICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nc3RhcnRJZDsgaSA8IGVuZElkOyBpKyspIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgUGVyc29uIHAxID0gZW0uZmluZChQZXJzb24uY2xhc3MsIGkpOwog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAocDEuZ2V0SWQoKSAhPSBpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50\nbG4oIkZpbmRlciBmYWlsZWQ6ICIgKyBpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGZhaWx1cmVzID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9ICAg\nICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgZW0uY2xlYXIoKTsgIAogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgZW0uY2xvc2UoKTsgIAogICAgICAgICAgICB9\nIAogICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgZmFpbHVyZXMgPSB0cnVlOwogICAgICAgICAgICAgICBTeXN0ZW0u\nb3V0LnByaW50bG4oIlRocmVhZCAiICsgdGhyZWFkICsgIiBleGNlcHRpb24g\nOiIgKwogICAgICAgICAgICAgICAgICAgZSApOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

