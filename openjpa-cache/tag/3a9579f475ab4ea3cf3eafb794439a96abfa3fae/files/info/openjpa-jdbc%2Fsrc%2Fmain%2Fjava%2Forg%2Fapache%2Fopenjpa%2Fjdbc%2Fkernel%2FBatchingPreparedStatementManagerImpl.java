{"sha":"c09ce814663a63b7b16251cab405189d0afda098","node_id":"MDQ6QmxvYjIwNjM2NDpjMDljZTgxNDY2M2E2M2I3YjE2MjUxY2FiNDA1MTg5ZDBhZmRhMDk4","size":14634,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c09ce814663a63b7b16251cab405189d0afda098","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuU3RhdGVtZW50OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJvd0ltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5SZXBvcnRpbmdTUUxFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3B0aW1pc3RpY0V4\nY2VwdGlvbjsKCi8qKgogKiBCYXRjaCBwcmVwYXJlZCBzdGF0ZW1lbnQgbWFu\nYWdlciBpbXBsZW1lbnRhdGlvbi4gVGhpcyBwcmVwYXJlZCBzdGF0ZW1lbnQK\nICogbWFuYWdlciB3aWxsIHV0aWxpemUgdGhlIEpEQkMgYWRkQmF0Y2goKSBh\nbmQgZXhjZXV0ZUJhdGNoKCkgdG8gYmF0Y2ggdGhlIFNRTAogKiBzdGF0ZW1l\nbnRzIHRvZ2V0aGVyIHRvIGltcHJvdmUgdGhlIGV4ZWN1dGlvbiBwZXJmb3Jt\nYW5jZS4KICogCiAqIEBhdXRob3IgVGVyZXNhIEthbgogKi8KCnB1YmxpYyBj\nbGFzcyBCYXRjaGluZ1ByZXBhcmVkU3RhdGVtZW50TWFuYWdlckltcGwgZXh0\nZW5kcwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50TWFuYWdlckltcGwgewoK\nICAgIHByaXZhdGUgZmluYWwgc3RhdGljIExvY2FsaXplciBfbG9jID0gTG9j\nYWxpemVyCiAgICAgICAgICAgIC5mb3JQYWNrYWdlKEJhdGNoaW5nUHJlcGFy\nZWRTdGF0ZW1lbnRNYW5hZ2VySW1wbC5jbGFzcyk7CgogICAgcHJpdmF0ZSBT\ndHJpbmcgX2JhdGNoZWRTcWwgPSBudWxsOwogICAgcHJpdmF0ZSBMaXN0IF9i\nYXRjaGVkUm93cyA9IG5ldyBBcnJheUxpc3QoKTsKICAgIHByaXZhdGUgaW50\nIF9iYXRjaExpbWl0OwogICAgcHJpdmF0ZSBib29sZWFuIF9kaXNhYmxlQmF0\nY2ggPSBmYWxzZTsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLiBTdXBw\nbHkgY29ubmVjdGlvbi4KICAgICAqLwogICAgcHVibGljIEJhdGNoaW5nUHJl\ncGFyZWRTdGF0ZW1lbnRNYW5hZ2VySW1wbChKREJDU3RvcmUgc3RvcmUsCiAg\nICAgICAgQ29ubmVjdGlvbiBjb25uLCBpbnQgYmF0Y2hMaW1pdCkgewogICAg\nICAgIHN1cGVyKHN0b3JlLCBjb25uKTsKICAgICAgICBfYmF0Y2hMaW1pdCA9\nIGJhdGNoTGltaXQ7CiAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQo\nKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgiYmF0Y2hfbGlt\naXQiLCBTdHJpbmcudmFsdWVPZihfYmF0Y2hMaW1pdCkpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEZsdXNoIHRoZSBnaXZlbiByb3cgaW1tZWRpYXRlbHkg\nb3IgZGVmZXJyZWQgdGhlIGZsdXNoIGluIGJhdGNoLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBmbHVzaEFuZFVwZGF0ZShSb3dJbXBsIHJvdykgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGlzQmF0Y2hEaXNhYmxl\nZChyb3cpKSB7CiAgICAgICAgICAgIC8vIGlmIHRoZXJlIHdlcmUgc29tZSBz\ndGF0ZW1lbnRzIGJhdGNoZWQgYmVmb3JlLCB0aGVuCiAgICAgICAgICAgIC8v\nIHdlIG5lZWQgdG8gZmx1c2ggdGhlbSBvdXQgZmlyc3QgYmVmb3JlIHByb2Nl\nc3NpbmcgdGhlCiAgICAgICAgICAgIC8vIGN1cnJlbnQgbm9uIGJhdGNoIHBy\nb2Nlc3MuCiAgICAgICAgICAgIGZsdXNoQmF0Y2goKTsKCiAgICAgICAgICAg\nIHN1cGVyLmZsdXNoQW5kVXBkYXRlKHJvdyk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgLy8gcHJvY2VzcyB0aGUgU1FMIHN0YXRlbWVudCwgZWl0\naGVyIGV4ZWN1dGUgaXQgaW1tZWRpYXRlbHkgb3IKICAgICAgICAgICAgLy8g\nYmF0Y2ggaXQgZm9yIGxhdGVyIGV4ZWN1dGlvbi4KICAgICAgICAgICAgYmF0\nY2hPckV4ZWN1dGVSb3cocm93KTsKICAgICAgICB9CiAgICB9CgogICAgcHJv\ndGVjdGVkIHZvaWQgYmF0Y2hPckV4ZWN1dGVSb3coUm93SW1wbCByb3cpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBzcWwgPSByb3cu\nZ2V0U1FMKF9kaWN0KTsKICAgICAgICBpZiAoX2JhdGNoZWRTcWwgPT0gbnVs\nbCkgewogICAgICAgICAgICAvLyBicmFuZCBuZXcgU1FMCiAgICAgICAgICAg\nIF9iYXRjaGVkU3FsID0gc3FsOwogICAgICAgIH0gZWxzZSBpZiAoIXNxbC5l\ncXVhbHMoX2JhdGNoZWRTcWwpKSB7CiAgICAgICAgICAgIC8vIFNRTCBzdGF0\nZW1lbnRzIGNoYW5nZWQuCiAgICAgICAgICAgIHN3aXRjaCAoX2JhdGNoZWRS\nb3dzLnNpemUoKSkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAg\nICAgLy8gc2luZ2xlIGVudHJ5IGluIGNhY2hlLCBkaXJlY3QgU1FMIGV4ZWN1\ndGlvbi4gCiAgICAgICAgICAgICAgICBzdXBlci5mbHVzaEFuZFVwZGF0ZSgo\nUm93SW1wbCkgX2JhdGNoZWRSb3dzLmdldCgwKSk7CiAgICAgICAgICAgICAg\nICBfYmF0Y2hlZFJvd3MuY2xlYXIoKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgLy8gZmx1\nc2ggYWxsIGVudHJpZXMgaW4gY2FjaGUgaW4gYmF0Y2guCiAgICAgICAgICAg\nICAgICBmbHVzaEJhdGNoKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nX2JhdGNoZWRTcWwgPSBzcWw7CiAgICAgICAgfQogICAgICAgIF9iYXRjaGVk\nUm93cy5hZGQocm93KTsKICAgIH0KCiAgICAvKgogICAgICogQ29tcHV0ZSBp\nZiBiYXRjaGluZyBpcyBkaXNhYmxlZCwgYmFzZWQgb24gdmFsdWVzIG9mIGJh\ndGNoIGxpbWl0CiAgICAgKiBhbmQgZGF0YWJhc2UgY2hhcmFjdGVyaXN0aWNz\nLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gaXNCYXRjaERpc2FibGVk\nKFJvd0ltcGwgcm93KSB7CiAgICAgICAgYm9vbGVhbiBydG5WYWwgPSB0cnVl\nOwogICAgICAgIGludCBsaW1pdCA9IGdldEJhdGNoTGltaXQoKTsKICAgICAg\nICBpZiAoKGxpbWl0IDwgMCB8fCBsaW1pdCA+IDEpICYmICFpc0JhdGNoRGlz\nYWJsZWQoKSkgewogICAgICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nID0gcm93LmdldFByaW1hcnlLZXkoKTsKICAgICAgICAgICAgQ2xhc3NNYXBw\naW5nIGNtZCA9IG51bGw7CiAgICAgICAgICAgIGlmIChzbSAhPSBudWxsKQog\nICAgICAgICAgICAgICAgY21kID0gKENsYXNzTWFwcGluZykgc20uZ2V0TWV0\nYURhdGEoKTsKICAgICAgICAgICAgQ29sdW1uW10gYXV0b0Fzc2lnbiA9IG51\nbGw7CiAgICAgICAgICAgIGlmIChyb3cuZ2V0QWN0aW9uKCkgPT0gUm93LkFD\nVElPTl9JTlNFUlQpCiAgICAgICAgICAgICAgICBhdXRvQXNzaWduID0gcm93\nLmdldFRhYmxlKCkuZ2V0QXV0b0Fzc2lnbmVkQ29sdW1ucygpOwogICAgICAg\nICAgICAvLyB2YWxpZGF0ZSBiYXRjaCBjYXBhYmlsaXR5CiAgICAgICAgICAg\nIHJ0blZhbCA9IF9kaWN0CiAgICAgICAgICAgICAgICAudmFsaWRhdGVCYXRj\naFByb2Nlc3Mocm93LCBhdXRvQXNzaWduLCBzbSwgY21kKTsKICAgICAgICAg\nICAgc2V0QmF0Y2hEaXNhYmxlZChydG5WYWwpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gcnRuVmFsOwogICAgfQogICAgCiAgICAvKioKICAgICAqIGZs\ndXNoIGFsbCBjYWNoZWQgdXAgc3RhdGVtZW50cyB0byBiZSBleGVjdXRlZCBh\ncyBhIHNpbmdsZSBvciBiYXRjaGVkCiAgICAgKiBwcmVwYXJlZCBzdGF0ZW1l\nbnRzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBmbHVzaEJhdGNoKCkg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgTGlzdCBiYXRjaGVkUm93\ncyA9IGdldEJhdGNoZWRSb3dzKCk7CiAgICAgICAgU3RyaW5nIGJhdGNoZWRT\ncWwgPSBnZXRCYXRjaGVkU3FsKCk7CiAgICAgICAgaWYgKGJhdGNoZWRSb3dz\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgaW50IGJh\ndGNoU2l6ZSA9IGJhdGNoZWRSb3dzLnNpemUoKTsKICAgICAgICBpZiAoYmF0\nY2hlZFNxbCAhPSBudWxsICYmICBiYXRjaFNpemUgPiAwKSB7CiAgICAgICAg\nICAgIFByZXBhcmVkU3RhdGVtZW50IHBzID0gbnVsbDsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIFJvd0ltcGwgb25lcm93ID0gbnVsbDsK\nICAgICAgICAgICAgICAgIHBzID0gcHJlcGFyZVN0YXRlbWVudChiYXRjaGVk\nU3FsKTsKICAgICAgICAgICAgICAgIGlmIChiYXRjaFNpemUgPT0gMSkgewog\nICAgICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGUgYSBzaW5nbGUgcm93Lgog\nICAgICAgICAgICAgICAgICAgIG9uZXJvdyA9IChSb3dJbXBsKSBiYXRjaGVk\nUm93cy5nZXQoMCk7CiAgICAgICAgICAgICAgICAgICAgZmx1c2hTaW5nbGVS\nb3cob25lcm93LCBwcyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgICAgIC8vIGNhY2hlIGhhcyBtb3JlIHRoYW4gb25lIHJv\nd3MsIGV4ZWN1dGUgYXMgYmF0Y2guCiAgICAgICAgICAgICAgICAgICAgaW50\nIGNvdW50ID0gMDsKICAgICAgICAgICAgICAgICAgICBpbnQgYmF0Y2hlZFJv\nd3NCYXNlSW5kZXggPSAwOwogICAgICAgICAgICAgICAgICAgIEl0ZXJhdG9y\nIGl0ciA9IGJhdGNoZWRSb3dzLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAg\nICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgb25lcm93ID0gKFJvd0ltcGwpIGl0ci5uZXh0KCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChfYmF0Y2hMaW1pdCA9PSAxKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBmbHVzaFNpbmdsZVJvdyhvbmVy\nb3csIHBzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCA8IF9iYXRjaExp\nbWl0IHx8IF9iYXRjaExpbWl0ID09IC0xKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKHBzICE9IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIG9uZXJvdy5mbHVzaChwcywgX2RpY3Qs\nIF9zdG9yZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRk\nQmF0Y2gocHMsIG9uZXJvdywgY291bnQpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC8vIHJlYWNoIHRoZSBiYXRjaExpbWl0LCBleGVjdXRlIHRoZSBiYXRjaAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludFtdIHJ0biA9IGV4\nZWN1dGVCYXRjaChwcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY2hlY2tVcGRhdGVDb3VudChydG4sIGJhdGNoZWRSb3dzQmFzZUluZGV4\nLCBwcyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNo\nZWRSb3dzQmFzZUluZGV4ICs9IF9iYXRjaExpbWl0OwoKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAocHMgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgb25lcm93LmZsdXNoKHBzLCBf\nZGljdCwgX3N0b3JlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBhZGRCYXRjaChwcywgb25lcm93LCBjb3VudCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gcmVzZXQgdGhlIGNvdW50IHRvIDEgZm9y\nIG5ldyBiYXRjaAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv\ndW50ID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAvLyBlbmQgb2YgdGhlIGxvb3AsIGV4ZWN1dGUg\ndGhlIGJhdGNoCiAgICAgICAgICAgICAgICAgICAgaW50W10gcnRuID0gZXhl\nY3V0ZUJhdGNoKHBzKTsKICAgICAgICAgICAgICAgICAgICBjaGVja1VwZGF0\nZUNvdW50KHJ0biwgYmF0Y2hlZFJvd3NCYXNlSW5kZXgsIHBzKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgICAgICAvL0lmIHdlIGxvb2sgYXQgUHJlcGFy\nZWRTdGF0ZW1lbnRNYW5hZ2VySW1wbC5mbHVzaEFuZFVwZGF0ZSAod2hpY2gg\naXMgdGhlICdub24tYmF0Y2gnIGNvZGUgcGF0aAogICAgICAgICAgICAgICAg\nLy9zaW1pbGFyIHRvIHRoaXMgcGF0aCwgb3IgSSBzaG91bGQgc2F5LCB0aGUg\ncGF0aCB3aGljaCBpcyB0YWtlbiBpbnN0ZWFkIG9mIHRoaXMgcGF0aCB3aGVu\nCiAgICAgICAgICAgICAgICAvL3dlIGFyZW4ndCB1c2luZyBiYXRjaGluZyks\nIHdlIHNlZSB0aGF0IHRoZSBjYXRjaCBibG9jayBkb2Vzbid0IGRvIGEgJ3Nl\nLmdldE5leHRFeGNlcHRpb24nLgogICAgICAgICAgICAgICAgLy9XaGVuIHdl\nIGRvIGEgJ2dldE5leHRFeGNlcHRpb24nLCB0aGUgJ25leHQgZXhjZXB0aW9u\nJyBkb2Vzbid0IGNvbnRhaW4gdGhlIHNhbWUgbWVzc2FnZSBhcyBzZS4KICAg\nICAgICAgICAgICAgIC8vVGhhdCBpcywgJ25leHQgZXhjZXB0aW9uJyBjb250\nYWlucyBhIHN1YnNldCBtc2cgd2hpY2ggaXMgY29udGFpbmVkIGluIHNlLiAg\nRm9yIGxlZ2FjeSwgc2hvdWxkCiAgICAgICAgICAgICAgICAvL3dlIGNvbnRp\nbnV0ZSB0byB1c2UgJ3NxZXgnIGluIHRoZSAnb2xkIHBhdGgnIGFuZCB1c2Ug\nJ3NlJyBpbiB0aGUgbmV4dCBwYXRoL2NvZGU/Pz8/PwogICAgICAgICAgICAg\nICAgLy9TUUxFeGNlcHRpb24gc3FleCA9IHNlLmdldE5leHRFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgICAgIC8vaWYgKHNxZXggPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIC8vICAgIHNxZXggPSBzZTsKICAgICAgICAgICAgICAgIFNR\nTEV4Y2VwdGlvbiBzcWV4ID0gc2U7CiAgICAgICAgICAgICAgICAKICAgICAg\nICAgICAgICAgIGlmIChzZSBpbnN0YW5jZW9mIFJlcG9ydGluZ1NRTEV4Y2Vw\ndGlvbil7CiAgICAgICAgICAgICAgICAgIGludCBpbmRleCA9ICgoUmVwb3J0\naW5nU1FMRXhjZXB0aW9uKSBzZSkuZ2V0SW5kZXhPZkZpcnN0RmFpbGVkT2Jq\nZWN0KCk7CgogICAgICAgICAgICAgICAgICAvL2lmIHdlIGhhdmUgb25seSBi\nYXRjaGVkIG9uZSBzdGF0ZW1lbnQsIHRoZSBpbmRleCBzaG91bGQgYmUgMC4g\nIEFzIGNhbiBiZSBzZWVuIGFib3ZlLAogICAgICAgICAgICAgICAgICAvL2lm\nICdiYXRjaFNpemUgPT0gMScgYSBkaWZmZXJlbnQgcGF0aCBpcyB0YWtlbiAo\ndGhlICdzaW5nbGUgcm93JyBwYXRoKSwgYW5kIGlmIHRoYXQgcm93CiAgICAg\nICAgICAgICAgICAgIC8vZmFpbHMsIHdlIGtub3cgdGhhdCB0aGUgaW5kZXgg\naXMgMCBzaW5jZSB0aGVyZSBpcyBvbmx5IG9uZSByb3cuCiAgICAgICAgICAg\nICAgICAgIGlmIChiYXRjaFNpemUgPT0gMSl7CiAgICAgICAgICAgICAgICAg\nICAgICBpbmRleCA9IDA7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgCiAgICAgICAgICAgICAgICAgIC8vaW5kZXggc2hvdWxkIG5v\ndCBiZSBsZXNzIHRoYW4gMCB0aGlzIHBhdGgsIGJ1dCBpZiBmb3Igc29tZSBy\nZWFzb24gaXQgaXMsIGxldHMKICAgICAgICAgICAgICAgICAgLy9yZXNvcnQg\ndG8gdGhlICdvbGQgd2F5JyBhbmQgc2ltcGx5IHBhc3MgdGhlICdwcycgYXMg\ndGhlIGZhaWxlZCBvYmplY3QuCiAgICAgICAgICAgICAgICAgIGlmIChpbmRl\neCA8IDApeyAKICAgICAgICAgICAgICAgICAgICAgIHRocm93IFNRTEV4Y2Vw\ndGlvbnMuZ2V0U3RvcmUoc3FleCwgcHMsIF9kaWN0KTsKICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAg\nICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShzcWV4LCAo\nKFJvd0ltcGwpKF9iYXRjaGVkUm93cy5nZXQoaW5kZXgpKSkuZ2V0RmFpbGVk\nT2JqZWN0KCksIF9kaWN0KTsKICAgICAgICAgICAgICAgICAgfSAgICAgICAg\nICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBlbHNlewogICAgICAgICAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlv\nbnMuZ2V0U3RvcmUoc3FleCwgcHMsIF9kaWN0KTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIF9i\nYXRjaGVkU3FsID0gbnVsbDsKICAgICAgICAgICAgICAgIGJhdGNoZWRSb3dz\nLmNsZWFyKCk7CiAgICAgICAgICAgICAgICBpZiAocHMgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIC8vQ2xlYXIgdGhlIFBhcmFtcyBub3cuLi4u\nc2hvdWxkIHRoaXMgYmUgZG9uZSBhYm92ZT8gTm8uIAogICAgICAgICAgICAg\nICAgICAgIC8vaWYgSkRCQyBwcm92aWRlciB1c2luZyBQdXJlUXVlcnksIHBz\nIGlzIG51bGwKICAgICAgICAgICAgICAgICAgICBwcy5jbGVhclBhcmFtZXRl\ncnMoKTsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgICAgICBwcy5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWV4KSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc3FleCwgcHMs\nIF9kaWN0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoKICAg\nICAqIEV4ZWN1dGUgYW4gdXBkYXRlIG9mIGEgc2luZ2xlIHJvdy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGZsdXNoU2luZ2xlUm93KFJvd0ltcGwgcm93\nLCBQcmVwYXJlZFN0YXRlbWVudCBwcykKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAocHMgIT0gbnVsbCkKICAgICAgICAgICAg\ncm93LmZsdXNoKHBzLCBfZGljdCwgX3N0b3JlKTsKICAgICAgICBpbnQgY291\nbnQgPSBleGVjdXRlVXBkYXRlKHBzLCByb3cuZ2V0U1FMKF9kaWN0KSwgcm93\nKTsKICAgICAgICBpZiAoY291bnQgIT0gMSkgewogICAgICAgICAgICBsb2dT\nUUxXYXJuaW5ncyhwcyk7CiAgICAgICAgICAgIE9iamVjdCBmYWlsZWQgPSBy\nb3cuZ2V0RmFpbGVkT2JqZWN0KCk7CiAgICAgICAgICAgIGlmIChmYWlsZWQg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9leGNlcHRpb25zLmFkZChuZXcg\nT3B0aW1pc3RpY0V4Y2VwdGlvbihmYWlsZWQpKTsKICAgICAgICAgICAgZWxz\nZSBpZiAocm93LmdldEFjdGlvbigpID09IFJvdy5BQ1RJT05fSU5TRVJUKQog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihfbG9jLmdl\ndCgidXBkYXRlLWZhaWxlZC1uby1mYWlsZWQtb2JqIiwKICAgICAgICAgICAg\nICAgICAgICBTdHJpbmcudmFsdWVPZihjb3VudCksIHJvdy5nZXRTUUwoX2Rp\nY3QpKS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKgog\nICAgICogUHJvY2VzcyBleGVjdXRlQmF0Y2ggZnVuY3Rpb24gYXJyYXkgb2Yg\ncmV0dXJuIGNvdW50cy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNoZWNr\nVXBkYXRlQ291bnQoaW50W10gY291bnQsIGludCBiYXRjaGVkUm93c0Jhc2VJ\nbmRleCwKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBwcykKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyB2YWx1ZSBpbiBpbnRb\nXSBjb3VudCAgcmV0dXJuZWQgZnJvbSBleGVjdXRlQmF0Y2g6IAogICAgICAg\nIC8vICAgICAgICAgICAgICAgVXBkYXRlICAgICAgICAgIERlbGV0ZSAgICAg\nICAgSW5zZXJ0CiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAg\nICAgLy8gICAgICAgICAgICAgICBPSyAvIEVycm9yICAgICAgT0sgLyBFcnJv\nciAgICBPSyAvIEVycm9yCiAgICAgICAgLy8gREIyTFVXICAgICAgICAgMSAv\nIDAgICAgICAgICAgIDEgLyAwICAgICAgICAgMSAvIFNRTEV4Y2VwdGlvbgog\nICAgICAgIC8vIERCMi9aT1MgICAgICAgIDEgLyAwICAgICAgICAgICAxIC8g\nMCAgICAgICAgLTIgLyBTUUxFeGNlcHRpb24KICAgICAgICAvLyBPcmFjbGUg\nICAgICAgIC0yIC8gLTIgICAgICAgICAtMiAvIC0yICAgICAgIC0yIC8gU1FM\nRXhjZXB0aW9uCiAgICAgICAgaW50IGNudCA9IDA7CiAgICAgICAgaW50IHVw\nZGF0ZVN1Y2Nlc3NDbnQgPSBfZGljdC5nZXRCYXRjaFVwZGF0ZUNvdW50KHBz\nKTsKICAgICAgICBPYmplY3QgZmFpbGVkID0gbnVsbDsKICAgICAgICBMaXN0\nIGJhdGNoZWRSb3dzID0gZ2V0QmF0Y2hlZFJvd3MoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNvdW50Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIGNudCA9IGNvdW50W2ldOwogICAgICAgICAgICBSb3dJbXBsIHJvdyA9\nIChSb3dJbXBsKSBiYXRjaGVkUm93cy5nZXQoYmF0Y2hlZFJvd3NCYXNlSW5k\nZXggKyBpKTsKICAgICAgICAgICAgZmFpbGVkID0gcm93LmdldEZhaWxlZE9i\namVjdCgpOwogICAgICAgICAgICBzd2l0Y2ggKGNudCkgewogICAgICAgICAg\nICBjYXNlIFN0YXRlbWVudC5FWEVDVVRFX0ZBSUxFRDogLy8gLTMKICAgICAg\nICAgICAgICAgIGlmIChmYWlsZWQgIT0gbnVsbCB8fCByb3cuZ2V0QWN0aW9u\nKCkgPT0gUm93LkFDVElPTl9VUERBVEUpCiAgICAgICAgICAgICAgICAgICAg\nX2V4Y2VwdGlvbnMuYWRkKG5ldyBPcHRpbWlzdGljRXhjZXB0aW9uKGZhaWxl\nZCkpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAocm93LmdldEFjdGlvbigp\nID09IFJvdy5BQ1RJT05fSU5TRVJUKQogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBTUUxFeGNlcHRpb24oX2xvYy5nZXQoCiAgICAgICAgICAgICAg\nICAgICAgICAgICJ1cGRhdGUtZmFpbGVkLW5vLWZhaWxlZC1vYmoiLAogICAg\nICAgICAgICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihjb3VudFtpXSks\nIAogICAgICAgICAgICAgICAgICAgICAgICByb3cuZ2V0U1FMKF9kaWN0KSku\nZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIFN0YXRlbWVudC5TVUNDRVNTX05PX0lORk86IC8vIC0yCiAg\nICAgICAgICAgICAgICBpZiAoX2RpY3QucmVwb3J0c1N1Y2Nlc3NOb0luZm9P\nbkJhdGNoVXBkYXRlcyAmJgogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVN1\nY2Nlc3NDbnQgIT0gY291bnQubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAg\nICAgLy8gT3JhY2xlIGJhdGNoaW5nIHNwZWNpZmljczoKICAgICAgICAgICAg\nICAgICAgICAvLyB0cmVhdCB1cGRhdGUvZGVsZXRlIG9mIFNVQ0NFU1NfTk9f\nSU5GTyBhcyBmYWlsZWQgY2FzZQogICAgICAgICAgICAgICAgICAgIC8vIGJl\nY2F1c2U6CiAgICAgICAgICAgICAgICAgICAgLy8gMS4gdHJhbnNhY3Rpb24g\nc2hvdWxkIGJlIHJvbGxlZCBiYWNrLgogICAgICAgICAgICAgICAgICAgIC8v\nIDIuIGlmIERhdGFDYWNoZSBpcyBlbmFibGVkLCBvYmplY3RzIGluCiAgICAg\nICAgICAgICAgICAgICAgLy8gICAgY2FjaGUgc2hvdWxkIGJlIHJlbW92ZWQu\nCiAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWxlZCAhPSBudWxsKQogICAg\nICAgICAgICAgICAgICAgICAgICBfZXhjZXB0aW9ucy5hZGQobmV3IE9wdGlt\naXN0aWNFeGNlcHRpb24oZmFpbGVkKSk7CiAgICAgICAgICAgICAgICAgICAg\nZWxzZSBpZiAocm93LmdldEFjdGlvbigpID09IFJvdy5BQ1RJT05fSU5TRVJU\nKQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU1FMRXhjZXB0\naW9uKF9sb2MuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInVw\nZGF0ZS1mYWlsZWQtbm8tZmFpbGVkLW9iaiIsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBTdHJpbmcudmFsdWVPZihjb3VudFtpXSksIAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgcm93LmdldFNRTChfZGljdCkpLmdldE1l\nc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBp\nZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAg\nIF9sb2cudHJhY2UoX2xvYy5nZXQoImJhdGNoX3VwZGF0ZV9pbmZvIiwKICAg\nICAgICAgICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2YoY250KSwgCiAg\nICAgICAgICAgICAgICAgICAgICAgIHJvdy5nZXRTUUwoX2RpY3QpKS5nZXRN\nZXNzYWdlKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgMDogLy8gbm8gcm93IGlzIGluc2VydGVkLCB0cmVhdHMgaXQgYXMg\nZmFpbGVkCiAgICAgICAgICAgICAgICAvLyBjYXNlCiAgICAgICAgICAgICAg\nICBsb2dTUUxXYXJuaW5ncyhwcyk7CiAgICAgICAgICAgICAgICBpZiAoZmFp\nbGVkICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgX2V4Y2VwdGlvbnMu\nYWRkKG5ldyBPcHRpbWlzdGljRXhjZXB0aW9uKGZhaWxlZCkpOwogICAgICAg\nICAgICAgICAgZWxzZSBpZiAocm93LmdldEFjdGlvbigpID09IFJvdy5BQ1RJ\nT05fSU5TRVJUKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBTUUxF\neGNlcHRpb24oX2xvYy5nZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICJ1\ncGRhdGUtZmFpbGVkLW5vLWZhaWxlZC1vYmoiLAogICAgICAgICAgICAgICAg\nICAgICAgICBTdHJpbmcudmFsdWVPZihjb3VudFtpXSksIAogICAgICAgICAg\nICAgICAgICAgICAgICByb3cuZ2V0U1FMKF9kaWN0KSkuZ2V0TWVzc2FnZSgp\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0JhdGNoRGlzYWJsZWQoKSB7CiAgICAgICAgcmV0dXJuIF9k\naXNhYmxlQmF0Y2g7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QmF0Y2hE\naXNhYmxlZChib29sZWFuIGRpc2FibGVCYXRjaCkgewogICAgICAgIF9kaXNh\nYmxlQmF0Y2ggPSBkaXNhYmxlQmF0Y2g7CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRCYXRjaExpbWl0KCkgewogICAgICAgIHJldHVybiBfYmF0Y2hMaW1p\ndDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRCYXRjaExpbWl0KGludCBi\nYXRjaExpbWl0KSB7CiAgICAgICAgX2JhdGNoTGltaXQgPSBiYXRjaExpbWl0\nOwogICAgfQoKICAgIHB1YmxpYyBMaXN0IGdldEJhdGNoZWRSb3dzKCkgewog\nICAgICAgIHJldHVybiBfYmF0Y2hlZFJvd3M7CiAgICB9CgogICAgcHVibGlj\nIFN0cmluZyBnZXRCYXRjaGVkU3FsKCkgewogICAgICAgIHJldHVybiBfYmF0\nY2hlZFNxbDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRCYXRjaChQ\ncmVwYXJlZFN0YXRlbWVudCBwcywgUm93SW1wbCByb3csIAogICAgICAgICAg\nICBpbnQgY291bnQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHBz\nLmFkZEJhdGNoKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIGludFtdIGV4ZWN1\ndGVCYXRjaChQcmVwYXJlZFN0YXRlbWVudCBwcykgCiAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcHMuZXhlY3V0ZUJhdGNoKCk7\nCiAgICB9Cn0K\n","encoding":"base64"}

