{"sha":"b1beb7eeeffad6ea4a45de22dbb305d359baa4cc","node_id":"MDQ6QmxvYjIwNjM2NDpiMWJlYjdlZWVmZmFkNmVhNGE0NWRlMjJkYmIzMDVkMzU5YmFhNGNj","size":13289,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b1beb7eeeffad6ea4a45de22dbb305d359baa4cc","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS50ZXh0Lk1l\nc3NhZ2VGb3JtYXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYu\nT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbkltcGw7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyLkRC\nSWRlbnRpZmllcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlk\nZW50aWZpZXIuUXVhbGlmaWVkREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdyb3VwOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYVRv\nb2w7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2No\nZW1hczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5T\nZXF1ZW5jZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5E\nQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNv\nbmYuQ29uZmlndXJhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5jb25mLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247CgppbXBvcnQgc2VycC51dGls\nLlN0cmluZ3M7CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBOT1RFOiBEbyBub3QgY2hh\nbmdlIHByb3BlcnR5IG5hbWVzOyBzZWUgU2VxdWVuY2VNZXRhRGF0YQovLyBh\nbmQgU2VxdWVuY2VNYXBwaW5nIGZvciBzdGFuZGFyZCBwcm9wZXJ0eSBuYW1l\ncy4KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCgovKioKICoge0BsaW5rIEpEQkNTZXF9IGlt\ncGxlbWVudGF0aW9uIHRoYXQgdXNlcyBhIGRhdGFiYXNlIHNlcXVlbmNlcwog\nKiB0byBnZW5lcmF0ZSBudW1iZXJzLgogKgogKiBAc2VlIEpEQkNTZXEKICog\nQHNlZSBBYnN0cmFjdEpEQkNTZXEKICovCnB1YmxpYyBjbGFzcyBOYXRpdmVK\nREJDU2VxCiAgICBleHRlbmRzIEFic3RyYWN0SkRCQ1NlcQogICAgaW1wbGVt\nZW50cyBDb25maWd1cmFibGUgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEFDVElPTl9EUk9QID0gImRyb3AiOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJhZGQiOwogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0dFVCA9ICJnZXQiOwoKICAg\nIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UoTmF0aXZlSkRCQ1NlcS5jbGFzcyk7CgogICAgcHJpdmF0ZSBK\nREJDQ29uZmlndXJhdGlvbiBfY29uZiA9IG51bGw7CiAgICBwcml2YXRlIERC\nSWRlbnRpZmllciBfc2VxTmFtZSA9IERCSWRlbnRpZmllci5uZXdTZXF1ZW5j\nZSgiT1BFTkpQQV9TRVFVRU5DRSIpOwogICAgcHJpdmF0ZSBpbnQgX2luY3Jl\nbWVudCA9IDE7CiAgICBwcml2YXRlIGludCBfaW5pdGlhbCA9IDE7CiAgICBw\ncml2YXRlIGludCBfYWxsb2NhdGUgPSAwOwogICAgcHJpdmF0ZSBTZXF1ZW5j\nZSBfc2VxID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9zZWxlY3QgPSBu\ndWxsOwoKICAgIC8vIGZvciBkZXByZWNhdGVkIGF1dG8tY29uZmlndXJhdGlv\nbiBzdXBwb3J0CiAgICBwcml2YXRlIFN0cmluZyBfZm9ybWF0ID0gbnVsbDsK\nICAgIHByaXZhdGUgREJJZGVudGlmaWVyIF90YWJsZU5hbWUgPSBEQklkZW50\naWZpZXIubmV3VGFibGUoIkRVQUwiKTsKICAgIHByaXZhdGUgYm9vbGVhbiBf\nc3ViVGFibGUgPSBmYWxzZTsKCiAgICBwcml2YXRlIERCSWRlbnRpZmllciBf\nc2NoZW1hID0gREJJZGVudGlmaWVyLk5VTEw7CiAgICAgICAgCiAgICAvKioK\nICAgICAqIFRoZSBzZXF1ZW5jZSBuYW1lLiBEZWZhdWx0cyB0byA8Y29kZT5P\nUEVOSlBBX1NFUVVFTkNFPC9jb2RlPi4KICAgICAqLwogICAgLy8gQEdFVFRF\nUgogICAgcHVibGljIFN0cmluZyBnZXRTZXF1ZW5jZSgpIHsKICAgICAgICBy\nZXR1cm4gX3NlcU5hbWUuZ2V0TmFtZSgpOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIHNlcXVlbmNlIG5hbWUuIERlZmF1bHRzIHRvIDxjb2RlPk9QRU5K\nUEFfU0VRVUVOQ0U8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRTZXF1ZW5jZShTdHJpbmcgc2VxTmFtZSkgewogICAgICAgIF9zZXFOYW1l\nID0gREJJZGVudGlmaWVyLm5ld1NlcXVlbmNlKHNlcU5hbWUpOwogICAgfQoK\nICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayAjc2V0U2Vx\ndWVuY2V9LiBSZXRhaW5lZCBmb3IKICAgICAqIGJhY2t3YXJkcy1jb21wYXRp\nYmlsaXR5IGZvciBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIEBE\nZXByZWNhdGVkCiAgICBwdWJsaWMgdm9pZCBzZXRTZXF1ZW5jZU5hbWUoU3Ry\naW5nIHNlcU5hbWUpIHsKICAgICAgICBzZXRTZXF1ZW5jZShzZXFOYW1lKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgU2VxdWVuY2UjZ2V0SW5pdGlh\nbFZhbHVlCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW5pdGlhbFZhbHVl\nKCkgewogICAgICAgIHJldHVybiBfaW5pdGlhbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIEBzZWUgU2VxdWVuY2Ujc2V0SW5pdGlhbFZhbHVlCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldEluaXRpYWxWYWx1ZShpbnQgaW5pdGlhbCkg\newogICAgICAgIF9pbml0aWFsID0gaW5pdGlhbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIEBzZWUgU2VxdWVuY2UjZ2V0QWxsb2NhdGUKICAgICAqLwogICAg\ncHVibGljIGludCBnZXRBbGxvY2F0ZSgpIHsKICAgICAgICByZXR1cm4gX2Fs\nbG9jYXRlOwogICAgfQoKICAgIC8qKgogICAgICogQHNlZSBTZXF1ZW5jZSNz\nZXRBbGxvY2F0ZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRBbGxvY2F0\nZShpbnQgYWxsb2NhdGUpIHsKICAgICAgICBfYWxsb2NhdGUgPSBhbGxvY2F0\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgU2VxdWVuY2UjZ2V0SW5j\ncmVtZW50CiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW5jcmVtZW50KCkg\newogICAgICAgIHJldHVybiBfaW5jcmVtZW50OwogICAgfQoKICAgIC8qKgog\nICAgICogQHNlZSBTZXF1ZW5jZSNzZXRJbmNyZW1lbnQKICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0SW5jcmVtZW50KGludCBpbmNyZW1lbnQpIHsKICAg\nICAgICBfaW5jcmVtZW50ID0gaW5jcmVtZW50OwogICAgfQoKICAgIC8qKgog\nICAgICogQGRlcHJlY2F0ZWQgUmV0YWluZWQgZm9yIGJhY2t3YXJkcy1jb21w\nYXRpYmlsaXR5IGZvciBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAg\nIEBEZXByZWNhdGVkCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZU5hbWUoU3Ry\naW5nIHRhYmxlKSB7CiAgICAgICAgX3RhYmxlTmFtZSA9IERCSWRlbnRpZmll\nci5uZXdUYWJsZSh0YWJsZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGVw\ncmVjYXRlZCBSZXRhaW5lZCBmb3IgYmFja3dhcmRzLWNvbXBhdGliaWxpdHkg\nZm9yIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgQERlcHJlY2F0\nZWQKICAgIHB1YmxpYyB2b2lkIHNldEZvcm1hdChTdHJpbmcgZm9ybWF0KSB7\nCiAgICAgICAgX2Zvcm1hdCA9IGZvcm1hdDsKICAgICAgICBfc3ViVGFibGUg\nPSB0cnVlOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQg\nYWRkU2NoZW1hKENsYXNzTWFwcGluZyBtYXBwaW5nLCBTY2hlbWFHcm91cCBn\ncm91cCkgewogICAgICAgIC8vIHNlcXVlbmNlIGFscmVhZHkgZXhpc3RzPwog\nICAgICAgIFF1YWxpZmllZERCSWRlbnRpZmllciBwYXRoID0gUXVhbGlmaWVk\nREJJZGVudGlmaWVyLmdldFBhdGgoX3NlcU5hbWUpOwogICAgICAgIGlmIChn\ncm91cC5pc0tub3duU2VxdWVuY2UocGF0aCkpCiAgICAgICAgICAgIHJldHVy\nbjsKCiAgICAgICAgREJJZGVudGlmaWVyIHNjaGVtYU5hbWUgPSBnZXRTY2hl\nbWFJZGVudGlmaWVyKCk7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc0Vt\ncHR5KHNjaGVtYU5hbWUpKSB7CiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBw\nYXRoLmdldFNjaGVtYU5hbWUoKTsKICAgICAgICAgICAgaWYgKERCSWRlbnRp\nZmllci5pc0VtcHR5KHNjaGVtYU5hbWUpKQogICAgICAgICAgICAgICAgc2No\nZW1hTmFtZSA9IFNjaGVtYXMuZ2V0TmV3VGFibGVTY2hlbWFJZGVudGlmaWVy\nKF9jb25mKTsKICAgICAgICB9CgogICAgICAgIC8vIGNyZWF0ZSB0YWJsZSBp\nbiB0aGlzIGdyb3VwCiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdyb3VwLmdl\ndFNjaGVtYShzY2hlbWFOYW1lKTsKICAgICAgICBpZiAoc2NoZW1hID09IG51\nbGwpCiAgICAgICAgICAgIHNjaGVtYSA9IGdyb3VwLmFkZFNjaGVtYShzY2hl\nbWFOYW1lKTsKICAgICAgICBzY2hlbWEuaW1wb3J0U2VxdWVuY2UoX3NlcSk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgSkRCQ0NvbmZpZ3Vy\nYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2Nv\nbmY7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHNldENvbmZpZ3VyYXRp\nb24oQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgX2NvbmYgPSAoSkRC\nQ0NvbmZpZ3VyYXRpb24pIGNvbmY7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc3RhcnRDb25maWd1cmF0aW9uKCkgewogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgYnVpbGRTZXF1ZW5jZSgp\nOwoKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGlj\ndGlvbmFyeUluc3RhbmNlKCk7CiAgICAgICAgaWYgKF9mb3JtYXQgPT0gbnVs\nbCkgewogICAgICAgICAgICBfZm9ybWF0ID0gZGljdC5uZXh0U2VxdWVuY2VR\ndWVyeTsKICAgICAgICAgICAgaWYgKF9mb3JtYXQgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgibm8tc2VxLXNxbCIsIF9zZXFOYW1lKSk7CiAgICAgICAgfQogICAgICAg\nIGlmIChEQklkZW50aWZpZXIuaXNOdWxsKF90YWJsZU5hbWUpKQogICAgICAg\nICAgICBfdGFibGVOYW1lID0gREJJZGVudGlmaWVyLm5ld1RhYmxlKCJEVUFM\nIik7CgogICAgICAgIFN0cmluZyBuYW1lID0gZGljdC5nZXRGdWxsTmFtZShf\nc2VxKTsKICAgICAgICBPYmplY3RbXSBzdWJzID0gKF9zdWJUYWJsZSkgPyBu\nZXcgT2JqZWN0W117IG5hbWUsIF90YWJsZU5hbWUgfQogICAgICAgICAgICA6\nIG5ldyBPYmplY3RbXXsgbmFtZSB9OwogICAgICAgIF9zZWxlY3QgPSBNZXNz\nYWdlRm9ybWF0LmZvcm1hdChfZm9ybWF0LCBzdWJzKTsKICAgICAgICAKICAg\nICAgICB0eXBlID0gZGljdC5uYXRpdmVTZXF1ZW5jZVR5cGU7CiAgICB9CiAg\nICAKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIE9iamVjdCBuZXh0SW50\nZXJuYWwoSkRCQ1N0b3JlIHN0b3JlLCBDbGFzc01hcHBpbmcgbWFwcGluZykK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBDb25uZWN0\naW9uIGNvbm4gPSBnZXRDb25uZWN0aW9uKHN0b3JlKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICByZXR1cm4gZ2V0U2VxdWVuY2UoY29ubik7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY2xvc2VDb25uZWN0aW9uKGNv\nbm4pOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMg\ndGhlIHNlcXVlbmNlIG9iamVjdC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGJ1aWxkU2VxdWVuY2UoKSB7CiAgICAgICAgUXVhbGlmaWVkREJJZGVudGlm\naWVyIHBhdGggPSBRdWFsaWZpZWREQklkZW50aWZpZXIuZ2V0UGF0aChfc2Vx\nTmFtZSk7CiAgICAgICAgREJJZGVudGlmaWVyIHNlcU5hbWUgPSBwYXRoLmdl\ndElkZW50aWZpZXIoKTsKICAgICAgICAvLyBKUEEgMiBhZGRlZCBzY2hlbWEg\nYXMgYSBjb25maWd1cmFibGUgYXR0cmlidXRlIG9uICAKICAgICAgICAvLyBz\nZXF1ZW5jZSBnZW5lcmF0b3IuICBPcGVuSlBBIDw9IDEueCBhbGxvd2VkIHRo\naXMgdmlhCiAgICAgICAgLy8gc2NoZW1hLnNlcXVlbmNlIG9uIHRoZSBzZXF1\nZW5jZSBuYW1lLiAgU3BlY2lmeWluZyBhIHNjaGVtYQogICAgICAgIC8vIG5h\nbWUgb24gdGhlIGFubm90YXRpb24gb3IgaW4gdGhlIG9ybSB3aWxsIG92ZXJy\naWRlIHRoZSBvbGQgCiAgICAgICAgLy8gYmVoYXZpb3IuCiAgICAgICAgREJJ\nZGVudGlmaWVyIHNjaGVtYU5hbWUgPSBfc2NoZW1hOwogICAgICAgIGlmIChE\nQklkZW50aWZpZXIuaXNFbXB0eShzY2hlbWFOYW1lKSkgewogICAgICAgICAg\nICBzY2hlbWFOYW1lID0gcGF0aC5nZXRTY2hlbWFOYW1lKCk7CiAgICAgICAg\nICAgIGlmIChEQklkZW50aWZpZXIuaXNFbXB0eShzY2hlbWFOYW1lKSkKICAg\nICAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBTY2hlbWFzLmdldE5ld1RhYmxl\nU2NoZW1hSWRlbnRpZmllcihfY29uZik7CiAgICAgICAgfQoKICAgICAgICAv\nLyBidWlsZCB0aGUgc2VxdWVuY2UgaW4gb25lIG9mIHRoZSBkZXNpZ25hdGVk\nIHNjaGVtYXMKICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9IG5ldyBTY2hl\nbWFHcm91cCgpOwogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBncm91cC5hZGRT\nY2hlbWEoc2NoZW1hTmFtZSk7CgogICAgICAgIF9zZXEgPSBzY2hlbWEuYWRk\nU2VxdWVuY2Uoc2VxTmFtZSk7CiAgICAgICAgX3NlcS5zZXRJbml0aWFsVmFs\ndWUoX2luaXRpYWwpOwogICAgICAgIF9zZXEuc2V0SW5jcmVtZW50KF9pbmNy\nZW1lbnQpOwogICAgICAgIF9zZXEuc2V0QWxsb2NhdGUoX2FsbG9jYXRlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgdGhlIHNlcXVlbmNlIGlu\nIHRoZSBEQi4KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVmcmVzaFNlcXVl\nbmNlKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBM\nb2cgbG9nID0gX2NvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxP\nR19SVU5USU1FKTsKICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkK\nICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoIm1ha2UtbmF0aXZlLXNl\ncSIpKTsKCiAgICAgICAgLy8gY3JlYXRlIHRoZSBzZXF1ZW5jZQogICAgICAg\nIFNjaGVtYVRvb2wgdG9vbCA9IG5ldyBTY2hlbWFUb29sKF9jb25mKTsKICAg\nICAgICB0b29sLnNldElnbm9yZUVycm9ycyh0cnVlKTsKICAgICAgICB0b29s\nLmNyZWF0ZVNlcXVlbmNlKF9zZXEpOwogICAgfQoKICAgIC8qKgogICAgICog\nRHJvcHMgdGhlIHNlcXVlbmNlIGluIHRoZSBEQi4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgZHJvcFNlcXVlbmNlKCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBMb2cgbG9nID0gX2NvbmYuZ2V0TG9nKE9wZW5K\nUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAgICBpZiAobG9n\nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5n\nZXQoImRyb3AtbmF0aXZlLXNlcSIpKTsKCiAgICAgICAgLy8gZHJvcCB0aGUg\ndGFibGUKICAgICAgICBTY2hlbWFUb29sIHRvb2wgPSBuZXcgU2NoZW1hVG9v\nbChfY29uZik7CiAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJvcnModHJ1ZSk7\nCiAgICAgICAgdG9vbC5kcm9wU2VxdWVuY2UoX3NlcSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIG5leHQgc2VxdWVuY2UgdmFsdWUuCiAg\nICAgKi8KICAgIHByaXZhdGUgbG9uZyBnZXRTZXF1ZW5jZShDb25uZWN0aW9u\nIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0\nYW5jZSgpOwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVs\nbDsKICAgICAgICBSZXN1bHRTZXQgcnMgPSBudWxsOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVtZW50KF9z\nZWxlY3QpOwogICAgICAgICAgICBkaWN0LnNldFRpbWVvdXRzKHN0bW50LCBf\nY29uZiwgZmFsc2UpOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQodGhpcykg\newogICAgICAgICAgICAgICAgcnMgPSBzdG1udC5leGVjdXRlUXVlcnkoKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocnMubmV4dCgpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHJzLmdldExvbmcoMSk7CgogICAgICAgICAg\nICAvLyBubyByb3cgIT8KICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNl\ncHRpb24oX2xvYy5nZXQoImludmFsaWQtc2VxLXNxbCIsIF9zZWxlY3QpKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAvLyBjbGVhbiB1cCBv\ndXIgcmVzb3VyY2VzCiAgICAgICAgICAgIGlmIChycyAhPSBudWxsKQogICAg\nICAgICAgICAgICAgdHJ5IHsgcnMuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7fQogICAgICAgICAgICBpZiAoc3RtbnQgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIHRyeSB7IHN0bW50LmNsb3NlKCk7IH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICB9CiAgICB9CgogICAgLy8v\nLy8vLy8vCiAgICAvLyBNYWluCiAgICAvLy8vLy8vLy8KCiAgICAvKioKICAg\nICAqIFVzYWdlOiBqYXZhIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5OYXRpdmVKREJDU2VxdWVuY2UgW29wdGlvbl0qCiAgICAgKiAtYWN0aW9u\nLy1hICZsdDthZGQgfCBkcm9wIHwgZ2V0Jmd0OwogICAgICogIFdoZXJlIHRo\nZSBmb2xsb3dpbmcgb3B0aW9ucyBhcmUgcmVjb2duaXplZC4KICAgICAqIDx1\nbD4KICAgICAqIDxsaT48aT4tcHJvcGVydGllcy8tcCAmbHQ7cHJvcGVydGll\ncyBmaWxlIG9yIHJlc291cmNlJmd0OzwvaT46IFRoZQogICAgICogcGF0aCBv\nciByZXNvdXJjZSBuYW1lIG9mIGEgT3BlbkpQQSBwcm9wZXJ0aWVzIGZpbGUg\nY29udGFpbmluZwogICAgICogaW5mb3JtYXRpb24gc3VjaCBhcyB0aGUgbGlj\nZW5zZSBrZXkJYW5kIGNvbm5lY3Rpb24gZGF0YSBhcwogICAgICogb3V0bGlu\nZWQgaW4ge0BsaW5rIEpEQkNDb25maWd1cmF0aW9ufS4gT3B0aW9uYWwuPC9s\naT4KICAgICAqIDxsaT48aT4tJmx0O3Byb3BlcnR5IG5hbWUmZ3Q7ICZsdDtw\ncm9wZXJ0eSB2YWx1ZSZndDs8L2k+OiBBbGwgYmVhbgogICAgICogcHJvcGVy\ndGllcyBvZiB0aGUgT3BlbkpQQSB7QGxpbmsgSkRCQ0NvbmZpZ3VyYXRpb259\nIGNhbiBiZSBzZXQgYnkKICAgICAqIHVzaW5nIHRoZWlyCW5hbWVzIGFuZCBz\ndXBwbHlpbmcgYSB2YWx1ZS4gRm9yIGV4YW1wbGU6CiAgICAgKiA8Y29kZT4t\nbGljZW5zZUtleSBhZHNsZmphODNyM2xrYWRmPC9jb2RlPjwvbGk+CiAgICAg\nKiA8L3VsPgogICAgICogIFRoZSB2YXJpb3VzIGFjdGlvbnMgYXJlIGFzIGZv\nbGxvd3MuCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+YWRkPC9pPjogQ3Jl\nYXRlIHRoZSBzZXF1ZW5jZS48L2xpPgogICAgICogPGxpPjxpPmRyb3A8L2k+\nOiBEcm9wIHRoZSBzZXF1ZW5jZS48L2xpPgogICAgICogPGxpPjxpPmdldDwv\naT46IFByaW50IHRoZSBuZXh0IHNlcXVlbmNlIHZhbHVlLjwvbGk+CiAgICAg\nKiA8L3VsPgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihT\ndHJpbmdbXSBhcmdzKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmlu\nYWwgU3RyaW5nW10gYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShh\ncmdzKTsKICAgICAgICBib29sZWFuIHJldCA9IENvbmZpZ3VyYXRpb25zLnJ1\nbkFnYWluc3RBbGxBbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25m\naWd1cmF0aW9ucy5SdW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJv\nb2xlYW4gcnVuKE9wdGlvbnMgb3B0cykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IEpE\nQkNDb25maWd1cmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gTmF0aXZlSkRCQ1NlcS5ydW4o\nY29uZiwgYXJndW1lbnRzLCBvcHRzKTsKICAgICAgICAgICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgICAgICAgICAgY29uZi5jbG9zZSgpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAg\nICAgaWYgKCFyZXQpCiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbihf\nbG9jLmdldCgibmF0aXZlLXNlcS11c2FnZSIpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJucyBmYWxzZSBpZiBpbnZhbGlk\nIG9wdGlvbnMgd2VyZSBnaXZlbi4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBib29sZWFuIHJ1bihKREJDQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmdb\nXSBhcmdzLAogICAgICAgIE9wdGlvbnMgb3B0cykKICAgICAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgYWN0aW9uID0gb3B0cy5yZW1v\ndmVQcm9wZXJ0eSgiYWN0aW9uIiwgImEiLCBudWxsKTsKICAgICAgICBDb25m\naWd1cmF0aW9ucy5wb3B1bGF0ZUNvbmZpZ3VyYXRpb24oY29uZiwgb3B0cyk7\nCiAgICAgICAgcmV0dXJuIHJ1bihjb25mLCBhcmdzLCBhY3Rpb24pOwogICAg\nfQoKICAgIC8qKgogICAgICogUnVuIHRoZSB0b29sLiBSZXR1cm4gZmFsc2Ug\naWYgYW4gaW52YWxpZCBvcHRpb24gd2FzIGdpdmVuLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNv\nbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAgU3RyaW5nIGFjdGlvbikKICAg\nICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYXJncy5sZW5n\ndGggIT0gMCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBO\nYXRpdmVKREJDU2VxIHNlcSA9IG5ldyBOYXRpdmVKREJDU2VxKCk7CiAgICAg\nICAgU3RyaW5nIHByb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGll\ncyhjb25mLmdldFNlcXVlbmNlKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25z\nLmNvbmZpZ3VyZUluc3RhbmNlKHNlcSwgY29uZiwgcHJvcHMpOwoKICAgICAg\nICBpZiAoQUNUSU9OX0RST1AuZXF1YWxzKGFjdGlvbikpCiAgICAgICAgICAg\nIHNlcS5kcm9wU2VxdWVuY2UoKTsKICAgICAgICBlbHNlIGlmIChBQ1RJT05f\nQURELmVxdWFscyhhY3Rpb24pKQogICAgICAgICAgICBzZXEucmVmcmVzaFNl\ncXVlbmNlKCk7CiAgICAgICAgZWxzZSBpZiAoQUNUSU9OX0dFVC5lcXVhbHMo\nYWN0aW9uKSkgewogICAgICAgICAgICBDb25uZWN0aW9uIGNvbm4gPSBjb25m\nLmdldERhdGFTb3VyY2UyKG51bGwpLmdldENvbm5lY3Rpb24oKTsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxvbmcgY3VyID0gc2VxLmdl\ndFNlcXVlbmNlKGNvbm4pOwogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKGN1cik7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICB0cnkgeyBjb25uLmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBzZSkge30KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBAZGVwcmVjYXRlZAogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRTY2hlbWEoU3RyaW5nIHNjaGVtYSkgewogICAgICAg\nIF9zY2hlbWEgPSBEQklkZW50aWZpZXIubmV3U2NoZW1hKHNjaGVtYSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBAZGVwcmVjYXRlZAogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFNjaGVtYSgpIHsKICAgICAgICByZXR1cm4gX3Nj\naGVtYS5nZXROYW1lKCk7CiAgICB9CgogICAgcHVibGljIERCSWRlbnRpZmll\nciBnZXRTY2hlbWFJZGVudGlmaWVyKCkgewogICAgICAgIHJldHVybiBfc2No\nZW1hOwogICAgfQoKfQo=\n","encoding":"base64"}

