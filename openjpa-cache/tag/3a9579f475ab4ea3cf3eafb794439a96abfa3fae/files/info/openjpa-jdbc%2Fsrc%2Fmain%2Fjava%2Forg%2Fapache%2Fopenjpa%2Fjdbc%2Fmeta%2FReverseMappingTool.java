{"sha":"028dfdfed1ae9dd81f2c0b0955b5d54da9c85dba","node_id":"MDQ6QmxvYjIwNjM2NDowMjhkZmRmZWQxYWU5ZGQ4MWYyYzBiMDk1NWI1ZDU0ZGE5Yzg1ZGJh","size":80352,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/028dfdfed1ae9dd81f2c0b0955b5d54da9c85dba","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uQnVmZmVyZWRSZWFkZXI7CmltcG9ydCBqYXZhLmlvLkZpbGU7\nCmltcG9ydCBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uRmlsZU5vdEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5JT0V4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9ydCBq\nYXZhLmlvLklucHV0U3RyZWFtUmVhZGVyOwppbXBvcnQgamF2YS5pby5TdHJp\nbmdXcml0ZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xs\nZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNl\ncHRpb247CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBq\nYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5I\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZh\nLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGls\nLlNldDsKaW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5BcHBsaWNhdGlvbklkVG9v\nbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLkNvZGVHZW5l\ncmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpE\nQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5GdWxsQ2xhc3NTdHJhdGVn\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRz\nLkhhbmRsZXJGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuTWF4RW1iZWRkZWRCbG9iRmllbGRTdHJh\ndGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3Ry\nYXRzLk1heEVtYmVkZGVkQ2xvYkZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5Ob25lRGlzY3JpbWlu\nYXRvclN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5zdHJhdHMuUHJpbWl0aXZlRmllbGRTdHJhdGVneTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLgogICAgICAgIFJl\nbGF0aW9uQ29sbGVjdGlvbkludmVyc2VLZXlGaWVsZFN0cmF0ZWd5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuUmVsYXRp\nb25Db2xsZWN0aW9uVGFibGVGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuUmVsYXRpb25GaWVsZFN0\ncmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuU3RhdGVDb21wYXJpc29uVmVyc2lvblN0cmF0ZWd5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuU3RyaW5nRmll\nbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuc3RyYXRzLlN1YmNsYXNzSm9pbkRpc2NyaW1pbmF0b3JTdHJhdGVneTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlN1\ncGVyY2xhc3NEaXNjcmltaW5hdG9yU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5TdXBlcmNsYXNzVmVyc2lv\nblN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuVmVydGljYWxDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkluZGV4OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlLZXk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdl\nbmVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNjaGVtYS5TY2hlbWFQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuU2NoZW1hczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5VbmlxdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuWE1MU2NoZW1hUGFyc2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEV4Y2VwdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ29kZUZvcm1hdDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5GaWxlczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRh\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rl\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk5vbmVNZXRhRGF0\nYUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5RdWVy\neU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuU2Vx\ndWVuY2VNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9ydCBzZXJwLmJ5dGVjb2Rl\nLkJDQ2xhc3M7CmltcG9ydCBzZXJwLmJ5dGVjb2RlLkJDQ2xhc3NMb2FkZXI7\nCmltcG9ydCBzZXJwLmJ5dGVjb2RlLlByb2plY3Q7CmltcG9ydCBzZXJwLnV0\naWwuU3RyaW5nczsKCi8qKgogKiBSZXZlcnNlLW1hcHMgYSBzY2hlbWEgaW50\nbyBjbGFzcyBtYXBwaW5ncyBhbmQgdGhlIGFzc29jaWF0ZWQgamF2YQogKiBj\nb2RlLiBHZW5lcmF0ZXMgYSBKYXZhIGNvZGUgZmlsZXMgZm9yIHBlcnNpc3Rl\nbnQgY2xhc3NlcyBhbmQgYXNzb2NpYXRlZAogKiBpZGVudGl0eSBjbGFzc2Vz\nIGFuZCBtZXRhZGF0YS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1\nYmxpYyBjbGFzcyBSZXZlcnNlTWFwcGluZ1Rvb2wKICAgIGltcGxlbWVudHMg\nTWV0YURhdGFNb2RlcywgQ2xvbmVhYmxlIHsKCiAgICAvKioKICAgICAqIFVu\nbWFwcGVkIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBUQUJMRV9OT05FID0gMDsKCiAgICAvKioKICAgICAqIFByaW1hcnkg\ndGFibGUgZm9yIGEgbmV3IGJhc2UgY2xhc3MuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IFRBQkxFX0JBU0UgPSAxOwoKICAgIC8qKgog\nICAgICogU2Vjb25kYXJ5IHRhYmxlIG9mIGFuIGV4aXN0aW5nIGNsYXNzLiBU\naGVyZSBpcyBleGFjdGx5IG9uZSByb3cgaW4KICAgICAqIHRoaXMgdGFibGUg\nZm9yIGVhY2ggcm93IGluIHRoZSBwcmltYXJ5IHRhYmxlLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBUQUJMRV9TRUNPTkRBUlkgPSAy\nOwoKICAgIC8qKgogICAgICogU2Vjb25kYXJ5IHRhYmxlIG9mIGFuIGV4aXN0\naW5nIGNsYXNzLiBUaGVyZSBpcyB6ZXJvIG9yIG9uZSByb3cgaW4KICAgICAq\nIHRoaXMgdGFibGUgZm9yIGVhY2ggcm93IGluIHRoZSBwcmltYXJ5IHRhYmxl\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBUQUJMRV9T\nRUNPTkRBUllfT1VURVIgPSAzOwoKICAgIC8qKgogICAgICogQXNzb2NpYXRp\nb24gdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIFRBQkxFX0FTU09DSUFUSU9OID0gNDsKCiAgICAvKioKICAgICAqIFN1YmNs\nYXNzIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGlu\ndCBUQUJMRV9TVUJDTEFTUyA9IDU7CgogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgTEVWRUxfTk9ORSA9ICJub25lIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIExFVkVMX1BBQ0tBR0UgPSAicGFja2FnZSI7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBMRVZFTF9DTEFTUyA9ICJj\nbGFzcyI7CgogICAgLyoqCiAgICAgKiBBY2Nlc3MgdHlwZSBmb3IgZ2VuZXJh\ndGVkIHNvdXJjZSwgZGVmYXVsdHMgdG8gZmllbGQtYmFzZWQgYWNjZXNzLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ0NFU1Nf\nVFlQRV9GSUVMRCA9ICJmaWVsZCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBBQ0NFU1NfVFlQRV9QUk9QRVJUWSA9ICJwcm9wZXJ0eSI7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZQogICAgICAgIChSZXZlcnNlTWFwcGluZ1Rvb2wuY2xhc3Mp\nOwoKICAgIC8vIG1hcCBqYXZhIGtleXdvcmRzIHRvIHJlbGF0ZWQgd29yZHMg\ndG8gdXNlIGluIHRoZWlyIHBsYWNlCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBNYXAgX2phdmFLZXl3b3JkcyA9IG5ldyBIYXNoTWFwKCk7CgogICAgc3Rh\ndGljIHsKICAgICAgICBJbnB1dFN0cmVhbSBpbiA9IFJldmVyc2VNYXBwaW5n\nVG9vbC5jbGFzcy5nZXRSZXNvdXJjZUFzU3RyZWFtCiAgICAgICAgICAgICgi\namF2YS1rZXl3b3Jkcy5yc3JjIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgU3RyaW5nW10ga2V5d29yZHMgPSBTdHJpbmdzLnNwbGl0KG5ldyBCdWZm\nZXJlZFJlYWRlcgogICAgICAgICAgICAgICAgKG5ldyBJbnB1dFN0cmVhbVJl\nYWRlcihpbikpLnJlYWRMaW5lKCksICIsIiwgMCk7CgogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGtleXdvcmRzLmxlbmd0aDsgaSArPSAyKQog\nICAgICAgICAgICAgICAgX2phdmFLZXl3b3Jkcy5wdXQoa2V5d29yZHNbaV0s\nIGtleXdvcmRzW2kgKyAxXSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbihpb2UpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBpbi5jbG9zZSgpOwogICAgICAgICAgICB9\nIGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgcHJpdmF0ZSBmaW5hbCBKREJDQ29uZmlndXJhdGlv\nbiBfY29uZjsKICAgIHByaXZhdGUgZmluYWwgTG9nIF9sb2c7CiAgICBwcml2\nYXRlIGZpbmFsIE1hcCBfdGFibGVzID0gbmV3IEhhc2hNYXAoKTsKICAgIHBy\naXZhdGUgZmluYWwgUHJvamVjdCBfcHJvamVjdCA9IG5ldyBQcm9qZWN0KCk7\nCiAgICBwcml2YXRlIGZpbmFsIEJDQ2xhc3NMb2FkZXIgX2xvYWRlciA9IEFj\nY2Vzc0NvbnRyb2xsZXIKICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2\nSGVscGVyLm5ld0JDQ2xhc3NMb2FkZXJBY3Rpb24oX3Byb2plY3QpKTsKICAg\nIHByaXZhdGUgU3RyYXRlZ3lJbnN0YWxsZXIgX3N0cmF0ID0gbnVsbDsKICAg\nIHByaXZhdGUgU3RyaW5nIF9wYWNrYWdlID0gbnVsbDsKICAgIHByaXZhdGUg\nRmlsZSBfZGlyID0gbnVsbDsKICAgIHByaXZhdGUgTWFwcGluZ1JlcG9zaXRv\ncnkgX3JlcG9zID0gbnVsbDsKICAgIHByaXZhdGUgU2NoZW1hR3JvdXAgX3Nj\naGVtYSA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX251bGxBc09iaiA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9ibG9iQXNPYmogPSBmYWxz\nZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfdXNlR2VuZXJpY0NvbGwgPSBmYWxz\nZTsKICAgIHByaXZhdGUgUHJvcGVydGllcyBfdHlwZU1hcCA9IG51bGw7CiAg\nICBwcml2YXRlIGJvb2xlYW4gX3VzZUZLID0gZmFsc2U7CiAgICBwcml2YXRl\nIGJvb2xlYW4gX3VzZVNjaGVtYSA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29s\nZWFuIF9wa09uSm9pbiA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9k\nYXRhc3RvcmUgPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfYnVpbHRp\nbiA9IHRydWU7CiAgICBwcml2YXRlIGJvb2xlYW4gX2lubmVyID0gZmFsc2U7\nCiAgICBwcml2YXRlIFN0cmluZyBfaWRTdWZmaXggPSAiSWQiOwogICAgcHJp\ndmF0ZSBib29sZWFuIF9pbnZlcnNlID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9v\nbGVhbiBfZGV0YWNoYWJsZSA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFu\nIF9nZW5Bbm5vdGF0aW9ucyA9IGZhbHNlOwogICAgcHJpdmF0ZSBTdHJpbmcg\nX2FjY2Vzc1R5cGUgPSBBQ0NFU1NfVFlQRV9GSUVMRDsKICAgIHByaXZhdGUg\nQ29kZUZvcm1hdCBfZm9ybWF0ID0gbnVsbDsKICAgIHByaXZhdGUgUmV2ZXJz\nZUN1c3RvbWl6ZXIgX2N1c3RvbSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmlu\nZyBfZGlzY1N0cmF0ID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF92ZXJz\nU3RyYXQgPSBudWxsOwoKICAgIC8vIHdlIGhhdmUgdG8gdHJhY2sgZmllbGQg\nbmFtZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnV0IHRoZW4gYWJhbmRvbmVkIGJ5\nCiAgICAvLyB0aGUgY3VzdG9taXplciBzbyB0aGF0IHdlIGRvbid0IGF0dGVt\ncHQgdG8gdXNlIHRoZW0gYWdhaW47IGRvaW5nIHNvIGNhbgogICAgLy8gbWVz\ncyB1cCBjZXJ0YWluIGN1c3RvbWl6ZXJzIChidWcgODgxKQogICAgcHJpdmF0\nZSBTZXQgX2FiYW5kb25lZEZpZWxkTmFtZXMgPSBudWxsOwoKICAgIC8vIGdl\nbmVyYXRlZCBhbm5vdGF0aW9ucywga2V5ID0gbWV0YWRhdGEsIHZhbCA9IGxp\nc3Qgb2YgYW5ub3RhdGlvbnMKICAgIHByaXZhdGUgTWFwIF9hbm5vcyA9IG51\nbGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZp\nZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBSZXZlcnNlTWFwcGluZ1Rv\nb2woSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9jb25mID0g\nY29uZjsKICAgICAgICBfbG9nID0gY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3Vy\nYXRpb24uTE9HX01FVEFEQVRBKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgaW50ZXJuYWwgc3RyYXRlZ3kgaW5zdGFsbGVyLgogICAgICov\nCiAgICBwcml2YXRlIFN0cmF0ZWd5SW5zdGFsbGVyIGdldFN0cmF0ZWd5SW5z\ndGFsbGVyKCkgewogICAgICAgIGlmIChfc3RyYXQgPT0gbnVsbCkKICAgICAg\nICAgICAgX3N0cmF0ID0gbmV3IFJldmVyc2VTdHJhdGVneUluc3RhbGxlcihn\nZXRSZXBvc2l0b3J5KCkpOwogICAgICAgIHJldHVybiBfc3RyYXQ7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbmZpZ3VyYXRpb24gcHJv\ndmlkZWQgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBwdWJsaWMgSkRC\nQ0NvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICBy\nZXR1cm4gX2NvbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGxvZyB0byB3cml0ZSB0by4KICAgICAqLwogICAgcHVibGljIExvZyBnZXRM\nb2coKSB7CiAgICAgICAgcmV0dXJuIF9sb2c7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIGRlZmF1bHQgcGFja2FnZSBmb3IgdGhlIGdlbmVy\nYXRlZCBjbGFzc2VzLCBvciBudWxsIGlmIHVuc2V0LgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFBhY2thZ2VOYW1lKCkgewogICAgICAgIHJldHVy\nbiBfcGFja2FnZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZGVm\nYXVsdCBwYWNrYWdlIGZvciB0aGUgZ2VuZXJhdGVkIGNsYXNzZXM7IHVzZSBu\ndWxsIHRvCiAgICAgKiBpbmRpY2F0ZSBubyBwYWNrYWdlLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRQYWNrYWdlTmFtZShTdHJpbmcgcGFja2FnZU5h\nbWUpIHsKICAgICAgICBfcGFja2FnZSA9IFN0cmluZ1V0aWxzLnRyaW1Ub051\nbGwocGFja2FnZU5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGZp\nbGUgdG8gb3V0cHV0IHRoZSBnZW5lcmF0ZWQgY29kZSB0bywgb3IgbnVsbCBm\nb3IKICAgICAqIHRoZSBjdXJyZW50IGRpcmVjdG9yeS4gSWYgdGhlIGRpcmVj\ndG9yeSBtYXRjaGVzIHRoZSBwYWNrYWdlLCBpdCB3aWxsCiAgICAgKiBiZSB1\nc2VkLiBPdGhlcndpc2UsIHRoZSBwYWNrYWdlIHN0cnVjdHVyZSB3aWxsIGJl\nIGNyZWF0ZWQgdW5kZXIKICAgICAqIHRoaXMgZGlyZWN0b3J5LgogICAgICov\nCiAgICBwdWJsaWMgRmlsZSBnZXREaXJlY3RvcnkoKSB7CiAgICAgICAgcmV0\ndXJuIF9kaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmlsZSB0byBv\ndXRwdXQgdGhlIGdlbmVyYXRlZCBjb2RlIHRvLCBvciBudWxsIGZvcgogICAg\nICogdGhlIGN1cnJlbnQgZGlyZWN0b3J5LiBJZiB0aGUgZGlyZWN0b3J5IG1h\ndGNoZXMgdGhlIHBhY2thZ2UsIGl0IHdpbGwKICAgICAqIGJlIHVzZWQuIE90\naGVyd2lzZSwgdGhlIHBhY2thZ2Ugc3RydWN0dXJlIHdpbGwgYmUgY3JlYXRl\nZCB1bmRlcgogICAgICogdGhpcyBkaXJlY3RvcnkuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldERpcmVjdG9yeShGaWxlIGRpcikgewogICAgICAgIF9k\naXIgPSBkaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBp\nZiB0aGUgc2NoZW1hIG5hbWUgd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgZ2Vu\nZXJhdGVkCiAgICAgKiBjbGFzcyBuYW1lIGZvciBlYWNoIHRhYmxlLiBEZWZh\ndWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0\nVXNlU2NoZW1hTmFtZSgpIHsKICAgICAgICByZXR1cm4gX3VzZVNjaGVtYTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB3aGV0aGVyIHRoZSBzY2hlbWEg\nbmFtZSB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSBnZW5lcmF0ZWQKICAgICAq\nIGNsYXNzIG5hbWUgZm9yIGVhY2ggdGFibGUuIERlZmF1bHRzIHRvIGZhbHNl\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VTY2hlbWFOYW1lKGJv\nb2xlYW4gdXNlU2NoZW1hKSB7CiAgICAgICAgX3VzZVNjaGVtYSA9IHVzZVNj\naGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRo\nZSBmb3JlaWduIGtleSBuYW1lIHdpbGwgYmUgdXNlZCB0byBnZW5lcmF0ZQog\nICAgICogcmVsYXRpb24gbmFtZXMuIERlZmF1bHRzIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRVc2VGb3JlaWduS2V5TmFtZSgp\nIHsKICAgICAgICByZXR1cm4gX3VzZUZLOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHdoZXRoZXIgdGhlIGZvcmVpZ24ga2V5IG5hbWUgd2lsbCBiZSB1\nc2VkIHRvIGdlbmVyYXRlCiAgICAgKiByZWxhdGlvbiBuYW1lcy4gRGVmYXVs\ndHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVzZUZv\ncmVpZ25LZXlOYW1lKGJvb2xlYW4gdXNlRkspIHsKICAgICAgICBfdXNlRksg\nPSB1c2VGSzsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVy\nIGV2ZW4gbnVsbGFibGUgY29sdW1ucyB3aWxsIGJlIG1hcHBlZCB0byB3cmFw\ncGVycwogICAgICogcmF0aGVyIHRoYW4gcHJpbWl0aXZlcy4gRGVmYXVsdHMg\ndG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldE51bGxh\nYmxlQXNPYmplY3QoKSB7CiAgICAgICAgcmV0dXJuIF9udWxsQXNPYmo7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hldGhlciBldmVuIG51bGxhYmxl\nIGNvbHVtbnMgd2lsbCBiZSBtYXBwZWQgdG8gd3JhcHBlcnMKICAgICAqIHJh\ndGhlciB0aGFuIHByaW1pdGl2ZXMuIERlZmF1bHRzIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXROdWxsYWJsZUFzT2JqZWN0KGJvb2xl\nYW4gbnVsbEFzT2JqKSB7CiAgICAgICAgX251bGxBc09iaiA9IG51bGxBc09i\najsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcmV2ZXJzZS1t\nYXAgYmxvYiBjb2x1bW5zIGFzIGNvbnRhaW5pbmcgc2VyaWFsaXplZCBKYXZh\nCiAgICAgKiBvYmplY3RzLCByYXRoZXIgdGhhbiB0aGUgZGVmYXVsdCBvZiB1\nc2luZyBhIGJ5dGVbXSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZ2V0QmxvYkFzT2JqZWN0KCkgewogICAgICAgIHJldHVybiBfYmxvYkFz\nT2JqOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byByZXZlcnNl\nLW1hcCBibG9iIGNvbHVtbnMgYXMgY29udGFpbmluZyBzZXJpYWxpemVkIEph\ndmEKICAgICAqIG9iamVjdHMsIHJhdGhlciB0aGFuIHRoZSBkZWZhdWx0IG9m\nIHVzaW5nIGEgYnl0ZVtdIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRCbG9iQXNPYmplY3QoYm9vbGVhbiBibG9iQXNPYmopIHsKICAgICAg\nICBfYmxvYkFzT2JqID0gYmxvYkFzT2JqOwogICAgfQoKICAgIC8qKgogICAg\nICogV2hldGhlciB0byB1c2UgZ2VuZXJpYyBjb2xsZWN0aW9ucyBvbiBvbmUt\ndG8tbWFueSBhbmQgbWFueS10by1tYW55CiAgICAgKiByZWxhdGlvbnMgaW5z\ndGVhZCBvZiB1bnR5cGVkIGNvbGxlY3Rpb25zLgogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBnZXRVc2VHZW5lcmljQ29sbGVjdGlvbnMoKSB7CiAgICAg\nICAgcmV0dXJuIF91c2VHZW5lcmljQ29sbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdG8gdXNlIGdlbmVyaWMgY29sbGVjdGlvbnMgb24gb25l\nLXRvLW1hbnkgYW5kIG1hbnktdG8tbWFueQogICAgICogcmVsYXRpb25zIGlu\nc3RlYWQgb2YgdW50eXBlZCBjb2xsZWN0aW9ucy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0VXNlR2VuZXJpY0NvbGxlY3Rpb25zKGJvb2xlYW4gdXNl\nR2VuZXJpY0NvbGxlY3Rpb25zKSB7CiAgICAgICAgX3VzZUdlbmVyaWNDb2xs\nID0gdXNlR2VuZXJpY0NvbGxlY3Rpb25zOyAKICAgIH0KCiAgICAvKioKICAg\nICAqIE1hcCBvZiBKREJDLW5hbWUgdG8gSmF2YS10eXBlLW5hbWUgZW50cmll\ncyB0aGF0IGFsbG93cyBjdXN0b21pemF0aW9uCiAgICAgKiBvZiByZXZlcnNl\nIG1hcHBpbmcgY29sdW1ucyB0byBmaWVsZCB0eXBlcy4KICAgICAqLwogICAg\ncHVibGljIFByb3BlcnRpZXMgZ2V0VHlwZU1hcCgpIHsKICAgICAgICByZXR1\ncm4gX3R5cGVNYXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXAgb2YgSkRC\nQy1uYW1lIHRvIEphdmEtdHlwZS1uYW1lIGVudHJpZXMgdGhhdCBhbGxvd3Mg\nY3VzdG9taXphdGlvbgogICAgICogb2YgcmV2ZXJzZSBtYXBwaW5nIGNvbHVt\nbnMgdG8gZmllbGQgdHlwZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFR5cGVNYXAoUHJvcGVydGllcyB0eXBlTWFwKSB7CiAgICAgICAgX3R5cGVN\nYXAgPSB0eXBlTWFwOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRy\ndWUgaWYgam9pbiB0YWJsZXMgYXJlIGFsbG93ZWQgdG8gaGF2ZSBwcmltYXJ5\nIGtleXMsIGZhbHNlCiAgICAgKiBpZiBhbGwgcHJpbWFyeSBrZXkgdGFibGVz\nIHdpbGwgYmUgbWFwcGVkIGFzIHBlcnNpc3RlbnQgY2xhc3Nlcy4KICAgICAq\nIERlZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBnZXRQcmltYXJ5S2V5T25Kb2luKCkgewogICAgICAgIHJldHVybiBfcGtP\nbkpvaW47CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSBpZiBq\nb2luIHRhYmxlcyBhcmUgYWxsb3dlZCB0byBoYXZlIHByaW1hcnkga2V5cywg\nZmFsc2UKICAgICAqIGlmIGFsbCBwcmltYXJ5IGtleSB0YWJsZXMgd2lsbCBi\nZSBtYXBwZWQgYXMgcGVyc2lzdGVudCBjbGFzc2VzLgogICAgICogRGVmYXVs\ndHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1h\ncnlLZXlPbkpvaW4oYm9vbGVhbiBwa09uSm9pbikgewogICAgICAgIF9wa09u\nSm9pbiA9IHBrT25Kb2luOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0byB1c2UgZGF0YXN0b3JlIGlkZW50aXR5IHdoZW4gcG9zc2libGUuIERl\nZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRVc2VEYXRhU3RvcmVJZGVudGl0eSgpIHsKICAgICAgICByZXR1cm4gX2Rh\ndGFzdG9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNl\nIGRhdGFzdG9yZSBpZGVudGl0eSB3aGVuIHBvc3NpYmxlLiBEZWZhdWx0cyB0\nbyBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VXNlRGF0YVN0\nb3JlSWRlbnRpdHkoYm9vbGVhbiBkYXRhc3RvcmUpIHsKICAgICAgICBfZGF0\nYXN0b3JlID0gZGF0YXN0b3JlOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byB1c2UgYnVpbHQgaW4gaWRlbnRpdHkgY2xhc3NlcyB3aGVuIHBv\nc3NpYmxlLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBnZXRVc2VCdWlsdGluSWRlbnRpdHlDbGFzcygpIHsKICAgICAg\nICByZXR1cm4gX2J1aWx0aW47CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIHRvIHVzZSBidWlsdCBpbiBpZGVudGl0eSBjbGFzc2VzIHdoZW4gcG9z\nc2libGUuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFVzZUJ1aWx0aW5JZGVudGl0eUNsYXNzKGJvb2xlYW4gYnVpbHRp\nbikgewogICAgICAgIF9idWlsdGluID0gYnVpbHRpbjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgb3Igbm90IHRvIGdlbmVyYXRlIGlubmVyIGNs\nYXNzZXMgd2hlbiBjcmVhdGluZyBhcHBsaWNhdGlvbgogICAgICogaWRlbnRp\ndHkgY2xhc3Nlcy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0SW5u\nZXJJZGVudGl0eUNsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJuIF9pbm5lcjsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgb3Igbm90IHRvIGdlbmVy\nYXRlIGlubmVyIGNsYXNzZXMgd2hlbiBjcmVhdGluZyBhcHBsaWNhdGlvbgog\nICAgICogaWRlbnRpdHkgY2xhc3Nlcy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0SW5uZXJJZGVudGl0eUNsYXNzZXMoYm9vbGVhbiBpbm5lcikgewog\nICAgICAgIF9pbm5lciA9IGlubmVyOwogICAgfQoKICAgIC8qKgogICAgICog\nU3VmZml4IHVzZWQgdG8gY3JlYXRlIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNs\nYXNzIG5hbWUgZnJvbSBhIGNsYXNzIG5hbWUsCiAgICAgKiBvciBpbiB0aGUg\nY2FzZSBvZiBpbm5lciBpZGVudGl0eSBjbGFzc2VzLCB0aGUgaW5uZXIgY2xh\nc3MgbmFtZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRJZGVudGl0\neUNsYXNzU3VmZml4KCkgewogICAgICAgIHJldHVybiBfaWRTdWZmaXg7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTdWZmaXggdXNlZCB0byBjcmVhdGUgYXBw\nbGljYXRpb24gaWRlbnRpdHkgY2xhc3MgbmFtZSBmcm9tIGEgY2xhc3MgbmFt\nZSwKICAgICAqIG9yIGluIHRoZSBjYXNlIG9mIGlubmVyIGlkZW50aXR5IGNs\nYXNzZXMsIHRoZSBpbm5lciBjbGFzcyBuYW1lLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJZGVudGl0eUNsYXNzU3VmZml4KFN0cmluZyBzdWZmaXgp\nIHsKICAgICAgICBfaWRTdWZmaXggPSBzdWZmaXg7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRvIGdlbmVyYXRlIGludmVyc2UgMS1tYW55LzEt\nMSByZWxhdGlvbnMgZm9yIGFsbCBtYW55LTEvMS0xCiAgICAgKiByZWxhdGlv\nbnMuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGdldEludmVyc2VSZWxhdGlvbnMoKSB7CiAgICAgICAgcmV0dXJuIF9p\nbnZlcnNlOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBnZW5l\ncmF0ZSBpbnZlcnNlIDEtbWFueS8xLTEgcmVsYXRpb25zIGZvciBhbGwgbWFu\neS0xLzEtMQogICAgICogcmVsYXRpb25zLiBEZWZhdWx0cyB0byB0cnVlLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbnZlcnNlUmVsYXRpb25zKGJv\nb2xlYW4gaW52ZXJzZSkgewogICAgICAgIF9pbnZlcnNlID0gaW52ZXJzZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gbWFrZSBnZW5lcmF0\nZWQgY2xhc3NlcyBkZXRhY2hhYmxlLiBEZWZhdWx0cyB0byBmYWxzZS4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0RGV0YWNoYWJsZSgpIHsKICAg\nICAgICByZXR1cm4gX2RldGFjaGFibGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRvIG1ha2UgZ2VuZXJhdGVkIGNsYXNzZXMgZGV0YWNoYWJs\nZS4gRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldERldGFjaGFibGUoYm9vbGVhbiBkZXRhY2hhYmxlKSB7CiAgICAgICAg\nX2RldGFjaGFibGUgPSBkZXRhY2hhYmxlOwogICAgfQoKICAgIC8qKgogICAg\nICogRGVmYXVsdCBkaXNjcmltaW5hdG9yIHN0cmF0ZWd5IGZvciBiYXNlIGNs\nYXNzIG1hcHBpbmdzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldERp\nc2NyaW1pbmF0b3JTdHJhdGVneSgpIHsKICAgICAgICByZXR1cm4gX2Rpc2NT\ndHJhdDsKICAgIH0KCiAgICAvKioKICAgICAqIERlZmF1bHQgZGlzY3JpbWlu\nYXRvciBzdHJhdGVneSBmb3IgYmFzZSBjbGFzcyBtYXBwaW5ncy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0RGlzY3JpbWluYXRvclN0cmF0ZWd5KFN0\ncmluZyBkaXNjU3RyYXQpIHsKICAgICAgICBfZGlzY1N0cmF0ID0gZGlzY1N0\ncmF0OwogICAgfQoKICAgIC8qKgogICAgICogRGVmYXVsdCB2ZXJzaW9uIHN0\ncmF0ZWd5IGZvciBiYXNlIGNsYXNzIG1hcHBpbmdzLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFZlcnNpb25TdHJhdGVneSgpIHsKICAgICAgICBy\nZXR1cm4gX3ZlcnNTdHJhdDsKICAgIH0KCiAgICAvKioKICAgICAqIERlZmF1\nbHQgdmVyc2lvbiBzdHJhdGVneSBmb3IgYmFzZSBjbGFzcyBtYXBwaW5ncy4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VmVyc2lvblN0cmF0ZWd5KFN0\ncmluZyB2ZXJzaW9uU3RyYXQpIHsKICAgICAgICBfdmVyc1N0cmF0ID0gdmVy\nc2lvblN0cmF0OwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBn\nZW5lcmF0ZSBhbm5vdGF0aW9ucyBhbG9uZyB3aXRoIGdlbmVyYXRlZCBjb2Rl\nLiBEZWZhdWx0cwogICAgICogdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGdldEdlbmVyYXRlQW5ub3RhdGlvbnMoKSB7CiAgICAgICAg\ncmV0dXJuIF9nZW5Bbm5vdGF0aW9uczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gZ2VuZXJhdGUgYW5ub3RhdGlvbnMgYWxvbmcgd2l0aCBn\nZW5lcmF0ZWQgY29kZS4gRGVmYXVsdHMKICAgICAqIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRHZW5lcmF0ZUFubm90YXRpb25zKGJv\nb2xlYW4gZ2VuQW5ub3RhdGlvbnMpIHsKICAgICAgICBfZ2VuQW5ub3RhdGlv\nbnMgPSBnZW5Bbm5vdGF0aW9uczsKICAgIH0KCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgdG8gdXNlIGZpZWxkIG9yIHByb3BlcnR5LWJhc2VkIGFjY2VzcyBv\nbiBnZW5lcmF0ZWQgY29kZS4KICAgICAqIERlZmF1bHRzIHRvIGZpZWxkLWJh\nc2VkIGFjY2Vzcy4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRBY2Nl\nc3NUeXBlKCkgewogICAgICAgIHJldHVybiBfYWNjZXNzVHlwZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNlIGZpZWxkIG9yIHByb3Bl\ncnR5LWJhc2VkIGFjY2VzcyBvbiBnZW5lcmF0ZWQgY29kZS4KICAgICAqIERl\nZmF1bHRzIHRvIGZpZWxkLWJhc2VkIGFjY2Vzcy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0QWNjZXNzVHlwZShTdHJpbmcgYWNjZXNzVHlwZSkgewog\nICAgICAgIHRoaXMuX2FjY2Vzc1R5cGUgPSBBQ0NFU1NfVFlQRV9QUk9QRVJU\nWS5lcXVhbHNJZ25vcmVDYXNlKGFjY2Vzc1R5cGUpID8KICAgICAgICAgICAg\nQUNDRVNTX1RZUEVfUFJPUEVSVFkgOiBBQ0NFU1NfVFlQRV9GSUVMRDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBjb2RlIGZvcm1hdHRlciBmb3IgdGhl\nIGdlbmVyYXRlZCBKYXZhIGNvZGUuCiAgICAgKi8KICAgIHB1YmxpYyBDb2Rl\nRm9ybWF0IGdldENvZGVGb3JtYXQoKSB7CiAgICAgICAgcmV0dXJuIF9mb3Jt\nYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGNvZGUgZm9ybWF0\ndGVyIGZvciB0aGUgZ2VuZXJhdGVkIEphdmEgY29kZS4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0Q29kZUZvcm1hdChDb2RlRm9ybWF0IGZvcm1hdCkg\newogICAgICAgIF9mb3JtYXQgPSBmb3JtYXQ7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIGN1c3RvbWl6ZXIgaW4gdXNlLCBvciBudWxsIGlm\nIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBSZXZlcnNlQ3VzdG9taXplciBn\nZXRDdXN0b21pemVyKCkgewogICAgICAgIHJldHVybiBfY3VzdG9tOwogICAg\nfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBjdXN0b21pemVyLiBUaGUgY29u\nZmlndXJhdGlvbiBvbiB0aGUgY3VzdG9taXplciwgaWYgYW55LAogICAgICog\nc2hvdWxkIGFscmVhZHkgYmUgc2V0LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRDdXN0b21pemVyKFJldmVyc2VDdXN0b21pemVyIGN1c3RvbWl6ZXIp\nIHsKICAgICAgICBpZiAoY3VzdG9taXplciAhPSBudWxsKQogICAgICAgICAg\nICBjdXN0b21pemVyLnNldFRvb2wodGhpcyk7CiAgICAgICAgX2N1c3RvbSA9\nIGN1c3RvbWl6ZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIG1hcHBpbmcgcmVwb3NpdG9yeSB1c2VkIHRvIGhvbGQgZ2VuZXJhdGVkIG1h\ncHBpbmdzLiBZb3UKICAgICAqIGNhbiBhbHNvIHVzZSB0aGUgcmVwb3NpdG9y\neSB0byBzZWVkIHRoZSBzY2hlbWEgZ3JvdXAgdG8gZ2VuZXJhdGUKICAgICAq\nIGNsYXNzZXMgZnJvbS4KICAgICAqLwogICAgcHVibGljIE1hcHBpbmdSZXBv\nc2l0b3J5IGdldFJlcG9zaXRvcnkoKSB7CiAgICAgICAgaWYgKF9yZXBvcyA9\nPSBudWxsKSB7CiAgICAgICAgICAgIC8vIGNyZWF0ZSBlbXB0eSByZXBvc2l0\nb3J5CiAgICAgICAgICAgIF9yZXBvcyA9IF9jb25mLm5ld01hcHBpbmdSZXBv\nc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAgX3JlcG9zLnNldE1ldGFE\nYXRhRmFjdG9yeShOb25lTWV0YURhdGFGYWN0b3J5LmdldEluc3RhbmNlKCkp\nOwogICAgICAgICAgICBfcmVwb3Muc2V0TWFwcGluZ0RlZmF1bHRzKE5vbmVN\nYXBwaW5nRGVmYXVsdHMuZ2V0SW5zdGFuY2UoKSk7CiAgICAgICAgICAgIF9y\nZXBvcy5zZXRSZXNvbHZlKE1PREVfTk9ORSk7CiAgICAgICAgICAgIF9yZXBv\ncy5zZXRWYWxpZGF0ZShfcmVwb3MuVkFMSURBVEVfTk9ORSk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBfcmVwb3M7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIHJlcG9zaXRvcnkgdG8gdXNlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRSZXBvc2l0b3J5KE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nKSB7CiAgICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIHNjaGVtYSBncm91cCB0byByZXZlcnNlIG1hcC4g\nSWYgbm9uZSBoYXMgYmVlbiBzZXQsIHRoZQogICAgICogc2NoZW1hIHdpbGwg\nYmUgZ2VuZXJhdGVkIGZyb20gdGhlIGRhdGFiYXNlLgogICAgICovCiAgICBw\ndWJsaWMgU2NoZW1hR3JvdXAgZ2V0U2NoZW1hR3JvdXAoKSB7CiAgICAgICAg\naWYgKF9zY2hlbWEgPT0gbnVsbCkgewogICAgICAgICAgICBTY2hlbWFHZW5l\ncmF0b3IgZ2VuID0gbmV3IFNjaGVtYUdlbmVyYXRvcihfY29uZik7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBnZW4uZ2VuZXJhdGVTY2hl\nbWFzKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\newogICAgICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9y\nZShzZSwKICAgICAgICAgICAgICAgICAgICBfY29uZi5nZXREQkRpY3Rpb25h\ncnlJbnN0YW5jZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfc2No\nZW1hID0gZ2VuLmdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBfc2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBzY2hlbWEgdG8gcmV2ZXJzZSBtYXAuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIHNjaGVtYSkgewogICAg\nICAgIF9zY2hlbWEgPSBzY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGdlbmVyYXRlZCBtYXBwaW5ncy4KICAgICAqLwogICAgcHVi\nbGljIENsYXNzTWFwcGluZ1tdIGdldE1hcHBpbmdzKCkgewogICAgICAgIHJl\ndHVybiBnZXRSZXBvc2l0b3J5KCkuZ2V0TWFwcGluZ3MoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEdlbmVyYXRlIG1hcHBpbmdzIGFuZCBjbGFzcyBjb2Rl\nIGZvciB0aGUgY3VycmVudCBzY2hlbWEgZ3JvdXAuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAvLyBtYXAgYmFzZSBjbGFzc2Vz\nIGZpcnN0CiAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdldFNjaGVtYUdy\nb3VwKCkuZ2V0U2NoZW1hcygpOwogICAgICAgIFRhYmxlW10gdGFibGVzOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFzW2ldLmdldFRhYmxl\ncygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHRhYmxlcy5s\nZW5ndGg7IGorKykKICAgICAgICAgICAgICAgIGlmIChpc0Jhc2VUYWJsZSh0\nYWJsZXNbal0pKQogICAgICAgICAgICAgICAgICAgIG1hcEJhc2VDbGFzcyh0\nYWJsZXNbal0pOwogICAgICAgIH0KCiAgICAgICAgLy8gbWFwIHZlcnRpY2Fs\nIHN1YmNsYXNzZXMKICAgICAgICBTZXQgc3VicyA9IG51bGw7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIHRhYmxlcyA9IHNjaGVtYXNbaV0uZ2V0VGFibGVzKCk7CiAg\nICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFibGVzLmxlbmd0aDsg\naisrKSB7CiAgICAgICAgICAgICAgICBpZiAoIV90YWJsZXMuY29udGFpbnNL\nZXkodGFibGVzW2pdKQogICAgICAgICAgICAgICAgICAgICYmIGdldFNlY29u\nZGFyeVR5cGUodGFibGVzW2pdLCBmYWxzZSkgPT0gVEFCTEVfU1VCQ0xBU1Mp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc3VicyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgICAgICAgICBzdWJzID0gbmV3IEhhc2hTZXQoKTsKICAg\nICAgICAgICAgICAgICAgICBzdWJzLmFkZCh0YWJsZXNbal0pOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlm\nIChzdWJzICE9IG51bGwpCiAgICAgICAgICAgIG1hcFN1YmNsYXNzZXMoc3Vi\ncyk7CgogICAgICAgIC8vIG1hcCBmaWVsZHMgaW4gdGhlIHByaW1hcnkgdGFi\nbGVzIG9mIHRoZSBjbGFzc2VzCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNsczsK\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF90YWJsZXMudmFsdWVzKCku\naXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgY2xz\nID0gKENsYXNzTWFwcGluZykgaXRyLm5leHQoKTsKICAgICAgICAgICAgbWFw\nQ29sdW1ucyhjbHMsIGNscy5nZXRUYWJsZSgpLCBudWxsLCBmYWxzZSk7CiAg\nICAgICAgfQoKICAgICAgICAvLyBtYXAgYXNzb2NpYXRpb24gdGFibGVzLCBq\nb2luIHRhYmxlcywgYW5kIHNlY29uZGFyeSB0YWJsZXMKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgdGFibGVzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKysp\nCiAgICAgICAgICAgICAgICBpZiAoIV90YWJsZXMuY29udGFpbnNLZXkodGFi\nbGVzW2pdKSkKICAgICAgICAgICAgICAgICAgICBtYXBUYWJsZSh0YWJsZXNb\nal0sIGdldFNlY29uZGFyeVR5cGUodGFibGVzW2pdLCBmYWxzZSkpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gbWFwIGRpc2NyaW1pbmF0b3JzIGFuZCB2ZXJz\naW9ucywgbWFrZSBzdXJlIGlkZW50aXR5IHR5cGUgaXMgY29ycmVjdCwKICAg\nICAgICAvLyBzZXQgc2ltcGxlIGZpZWxkIGNvbHVtbiBqYXZhIHR5cGVzLCBh\nbmQgcmVmIHNjaGVtYSBjb21wb25lbnRzIHNvCiAgICAgICAgLy8gd2UgY2Fu\nIHRlbGwgd2hhdCBpcyB1bm1hcHBlZAogICAgICAgIEZpZWxkTWFwcGluZ1td\nIGZpZWxkczsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF90YWJsZXMu\ndmFsdWVzKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgY2xzID0gKENsYXNzTWFwcGluZykgaXRyLm5leHQoKTsKICAgICAg\nICAgICAgY2xzLnJlZlNjaGVtYUNvbXBvbmVudHMoKTsKICAgICAgICAgICAg\naWYgKGNscy5nZXREaXNjcmltaW5hdG9yKCkuZ2V0U3RyYXRlZ3koKSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgZ2V0U3RyYXRlZ3lJbnN0YWxsZXIoKS5p\nbnN0YWxsU3RyYXRlZ3kKICAgICAgICAgICAgICAgICAgICAoY2xzLmdldERp\nc2NyaW1pbmF0b3IoKSk7CiAgICAgICAgICAgIGNscy5nZXREaXNjcmltaW5h\ndG9yKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAgICAgICAgICBpZiAo\nY2xzLmdldFZlcnNpb24oKS5nZXRTdHJhdGVneSgpID09IG51bGwpCiAgICAg\nICAgICAgICAgICBnZXRTdHJhdGVneUluc3RhbGxlcigpLmluc3RhbGxTdHJh\ndGVneShjbHMuZ2V0VmVyc2lvbigpKTsKICAgICAgICAgICAgY2xzLmdldFZl\ncnNpb24oKS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CgogICAgICAgICAgICAv\nLyBkb3VibGUtY2hlY2sgaWRlbnRpdHkgdHlwZTsgaWYgaXQgd2FzIHNldCBm\nb3IgYnVpbHRpbiBpZGVudGl0eQogICAgICAgICAgICAvLyBpdCBtaWdodCBo\nYXZlIHRvIHN3aXRjaCB0byBzdGQgYXBwbGljYXRpb24gaWRlbnRpdHkgaWYg\ncGsgZmllbGQKICAgICAgICAgICAgLy8gbm90IGNvbXBhdGlibGUKICAgICAg\nICAgICAgaWYgKGNscy5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBudWxsCiAgICAg\nICAgICAgICAgICAmJiBjbHMuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NN\nYXBwaW5nLklEX0FQUExJQ0FUSU9OKSB7CiAgICAgICAgICAgICAgICBpZiAo\nY2xzLmdldFByaW1hcnlLZXlGaWVsZHMoKS5sZW5ndGggPT0gMCkKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xv\nYy5nZXQoIm5vLXBrLWZpZWxkcyIsIGNscykpOwogICAgICAgICAgICAgICAg\naWYgKGNscy5nZXRPYmplY3RJZFR5cGUoKSA9PSBudWxsCiAgICAgICAgICAg\nICAgICAgICAgfHwgKGNscy5pc09wZW5KUEFJZGVudGl0eSgpICYmICFpc0J1\naWx0aW5JZGVudGl0eShjbHMpKSkKICAgICAgICAgICAgICAgICAgICBzZXRP\nYmplY3RJZFR5cGUoY2xzKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjbHMu\nZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNYXBwaW5nLklEX0RBVEFTVE9S\nRSkKICAgICAgICAgICAgICAgIGNscy5nZXRQcmltYXJ5S2V5Q29sdW1ucygp\nWzBdLnNldEphdmFUeXBlKEphdmFUeXBlcy5MT05HKTsKCiAgICAgICAgICAg\nIC8vIHNldCBqYXZhIHR5cGVzIGZvciBzaW1wbGUgZmllbGRzOwogICAgICAg\nICAgICBmaWVsZHMgPSBjbHMuZ2V0RGVjbGFyZWRGaWVsZE1hcHBpbmdzKCk7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgICAgICBmaWVsZHNbaV0ucmVmU2NoZW1h\nQ29tcG9uZW50cygpOwogICAgICAgICAgICAgICAgc2V0Q29sdW1uSmF2YVR5\ncGUoZmllbGRzW2ldKTsKICAgICAgICAgICAgICAgIHNldENvbHVtbkphdmFU\neXBlKGZpZWxkc1tpXS5nZXRFbGVtZW50TWFwcGluZygpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gc2V0IHRoZSBqYXZhIHR5cGVz\nIG9mIGZvcmVpZ24ga2V5IGNvbHVtbnM7IHdlIGNvdWxkbid0IGRvIHRoaXMK\nICAgICAgICAvLyBlYXJsaWVyIGJlY2F1c2Ugd2UgcmVseSBvbiB0aGUgbGlu\na2VkLXRvIGNvbHVtbnMgdG8gZG8gaXQKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IF90YWJsZXMudmFsdWVzKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05l\neHQoKTspIHsKICAgICAgICAgICAgY2xzID0gKENsYXNzTWFwcGluZykgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgc2V0Rm9yZWlnbktleUphdmFUeXBlKGNs\ncy5nZXRKb2luRm9yZWlnbktleSgpKTsKCiAgICAgICAgICAgIGZpZWxkcyA9\nIGNscy5nZXREZWNsYXJlZEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIHNldEZvcmVpZ25LZXlKYXZhVHlwZShmaWVsZHNbaV0u\nZ2V0Sm9pbkZvcmVpZ25LZXkoKSk7CiAgICAgICAgICAgICAgICBzZXRGb3Jl\naWduS2V5SmF2YVR5cGUoZmllbGRzW2ldLmdldEZvcmVpZ25LZXkoKSk7CiAg\nICAgICAgICAgICAgICBzZXRGb3JlaWduS2V5SmF2YVR5cGUoZmllbGRzW2ld\nLmdldEVsZW1lbnRNYXBwaW5nKCkuCiAgICAgICAgICAgICAgICAgICAgZ2V0\nRm9yZWlnbktleSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgLy8gYWxsb3cgY3VzdG9taXplciB0byBtYXAgdW5tYXBwZWQgdGFibGVz\nLCBhbmQgd2FybiBhYm91dCBhbnl0aGluZwogICAgICAgIC8vIHRoYXQgZW5k\ncyB1cCB1bm1hcHBlZAogICAgICAgIENvbHVtbltdIGNvbHM7CiAgICAgICAg\nQ29sbGVjdGlvbiB1bm1hcHBlZENvbHMgPSBuZXcgQXJyYXlMaXN0KDUpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFzW2ldLmdldFRhYmxl\ncygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHRhYmxlcy5s\nZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgdW5tYXBwZWRDb2xzLmNs\nZWFyKCk7CiAgICAgICAgICAgICAgICBjb2xzID0gdGFibGVzW2pdLmdldENv\nbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwg\nY29scy5sZW5ndGg7IGsrKykKICAgICAgICAgICAgICAgICAgICBpZiAoY29s\nc1trXS5nZXRSZWZDb3VudCgpID09IDApCiAgICAgICAgICAgICAgICAgICAg\nICAgIHVubWFwcGVkQ29scy5hZGQoY29sc1trXSk7CgogICAgICAgICAgICAg\nICAgaWYgKHVubWFwcGVkQ29scy5zaXplKCkgPT0gY29scy5sZW5ndGgpIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAoX2N1c3RvbSA9PSBudWxsIHx8ICFf\nY3VzdG9tLnVubWFwcGVkVGFibGUodGFibGVzW2pdKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgX2xvZy5pbmZvKF9sb2MuZ2V0KCJ1bm1hcC10YWJsZSIs\nIHRhYmxlc1tqXSkpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1bm1h\ncHBlZENvbHMuc2l6ZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBfbG9n\nLmluZm8oX2xvYy5nZXQoInVubWFwLWNvbHMiLCB0YWJsZXNbal0sIHVubWFw\ncGVkQ29scykpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlm\nIChfY3VzdG9tICE9IG51bGwpCiAgICAgICAgICAgIF9jdXN0b20uY2xvc2Uo\nKTsKCiAgICAgICAgLy8gcmVzb2x2ZSBtYXBwaW5ncwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gX3RhYmxlcy52YWx1ZXMoKS5pdGVyYXRvcigpOyBp\ndHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIGl0\nci5uZXh0KCkpLnJlc29sdmUoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIE1hcCB0aGUgdGFibGUgb2YgdGhlIGdp\ndmVuIHR5cGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBtYXBUYWJsZShU\nYWJsZSB0YWJsZSwgaW50IHR5cGUpIHsKICAgICAgICBzd2l0Y2ggKHR5cGUp\nIHsKICAgICAgICAgICAgY2FzZSBUQUJMRV9TRUNPTkRBUlk6CiAgICAgICAg\nICAgIGNhc2UgVEFCTEVfU0VDT05EQVJZX09VVEVSOgogICAgICAgICAgICAg\nICAgbWFwU2Vjb25kYXJ5VGFibGUodGFibGUsIHR5cGUgIT0gVEFCTEVfU0VD\nT05EQVJZKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIFRBQkxFX0FTU09DSUFUSU9OOgogICAgICAgICAgICAgICAgbWFwQXNz\nb2NpYXRpb25UYWJsZSh0YWJsZSk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBp\nZiB0aGUgZ2l2ZW4gY2xhc3MgaXMgY29tcGF0aWJsZSB3aXRoIGJ1aWx0aW4g\naWRlbnRpdHkuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\naXNCdWlsdGluSWRlbnRpdHkoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAg\nIEZpZWxkTWFwcGluZ1tdIGZpZWxkcyA9IGNscy5nZXRQcmltYXJ5S2V5Rmll\nbGRNYXBwaW5ncygpOwogICAgICAgIGlmIChmaWVsZHMubGVuZ3RoICE9IDEp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBzd2l0Y2ggKGZp\nZWxkc1swXS5nZXREZWNsYXJlZFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQllURToKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQ0hBUjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQllURV9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVJfT0JK\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JKOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5TVFJJTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9JRDoK\nICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhl\nIEphdmEgdHlwZSBvZiB0aGUgY29sdW1uIGZvciB0aGUgZ2l2ZW4gdmFsdWUu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgc2V0Q29sdW1uSmF2\nYVR5cGUoVmFsdWVNYXBwaW5nIHZtKSB7CiAgICAgICAgQ29sdW1uW10gY29s\ncyA9IHZtLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoY29scy5sZW5ndGgg\nPT0gMSkKICAgICAgICAgICAgY29sc1swXS5zZXRKYXZhVHlwZSh2bS5nZXRE\nZWNsYXJlZFR5cGVDb2RlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0\nIHRoZSBKYXZhIHR5cGUgb2YgdGhlIGZvcmVpZ24ga2V5IGNvbHVtbnMuCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgc2V0Rm9yZWlnbktleUph\ndmFUeXBlKEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBpZiAoZmsgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIENvbHVtbltdIGNvbHMg\nPSBmay5nZXRDb2x1bW5zKCk7CiAgICAgICAgQ29sdW1uW10gcGtzID0gZmsu\nZ2V0UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChjb2xz\nW2ldLmdldEphdmFUeXBlKCkgPT0gSmF2YVR5cGVzLk9CSkVDVCkKICAgICAg\nICAgICAgICAgIGNvbHNbaV0uc2V0SmF2YVR5cGUocGtzW2ldLmdldEphdmFU\neXBlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlcyB7QGxpbmsgQ29k\nZUdlbmVyYXRvcn1zIHRvIHdyaXRlIHRoZSBKYXZhIGNvZGUgZm9yIHRoZSBn\nZW5lcmF0ZWQKICAgICAqIG1hcHBpbmdzIHRvIHRoZSBwcm9wZXIgcGFja2Fn\nZXMuCiAgICAgKgogICAgICogQHJldHVybiBhIGxpc3Qgb2Yge0BsaW5rIEZp\nbGV9IGluc3RhbmNlcyB0aGF0IHdlcmUgd3JpdHRlbgogICAgICovCiAgICBw\ndWJsaWMgTGlzdCByZWNvcmRDb2RlKCkKICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIHJldHVybiByZWNvcmRDb2RlKG51bGwpOwogICAg\nfQoKICAgIC8qKgogICAgICogV3JpdGUgdGhlIGNvZGUgZm9yIHRoZSB0b29s\nLgogICAgICoKICAgICAqIEBwYXJhbSBvdXRwdXQgaWYgbnVsbCwgdGhlbiBw\nZXJmb3JtIHRoZSB3cml0ZSBkaXJlY3RseQogICAgICogdG8gdGhlIGZpbGVz\neXN0ZW07IG90aGVyd2lzZSwgcG9wdWxhdGUgdGhlCiAgICAgKiBzcGVjaWZp\nZWQgbWFwIHdpdGgga2V5cyBhcyB0aGUgZ2VuZXJhdGVkCiAgICAgKiB7QGxp\nbmsgQ2xhc3NNYXBwaW5nfSBhbmQgdmFsdWVzIGFzIGEKICAgICAqIHtAbGlu\nayBTdHJpbmd9IHRoYXQgY29udGFpbnMgdGhlIGdlbmVyYXRlZCBjb2RlCiAg\nICAgKiBAcmV0dXJuIGEgbGlzdCBvZiB7QGxpbmsgRmlsZX0gaW5zdGFuY2Vz\nIHRoYXQgd2VyZSB3cml0dGVuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0IHJl\nY29yZENvZGUoTWFwIG91dHB1dCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24gewogICAgICAgIExpc3Qgd3JpdHRlbiA9IG5ldyBMaW5rZWRMaXN0KCk7\nCgogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzID0gZ2V0TWFwcGlu\nZ3MoKTsKICAgICAgICBSZXZlcnNlQ29kZUdlbmVyYXRvciBnZW47CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5nZXQoImNsYXNzLWNvZGUiLCBt\nYXBwaW5nc1tpXSkpOwoKICAgICAgICAgICAgQXBwbGljYXRpb25JZFRvb2wg\nYWlkID0gbmV3QXBwbGljYXRpb25JZFRvb2wobWFwcGluZ3NbaV0pOwogICAg\nICAgICAgICBpZiAoZ2V0R2VuZXJhdGVBbm5vdGF0aW9ucygpKQogICAgICAg\nICAgICAgICAgZ2VuID0gbmV3IEFubm90YXRlZENvZGVHZW5lcmF0b3IobWFw\ncGluZ3NbaV0sIGFpZCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgIGdlbiA9IG5ldyBSZXZlcnNlQ29kZUdlbmVyYXRvcihtYXBwaW5nc1tp\nXSwgYWlkKTsKCiAgICAgICAgICAgIGdlbi5nZW5lcmF0ZUNvZGUoKTsKCiAg\nICAgICAgICAgIGlmIChvdXRwdXQgPT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgZ2VuLndyaXRlQ29kZSgpOwogICAgICAgICAgICAgICAgd3JpdHRlbi5h\nZGQoZ2VuLmdldEZpbGUoKSk7CiAgICAgICAgICAgICAgICBpZiAoYWlkICE9\nIG51bGwgJiYgIWFpZC5pc0lubmVyQ2xhc3MoKSkKICAgICAgICAgICAgICAg\nICAgICBhaWQucmVjb3JkKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICBTdHJpbmdXcml0ZXIgd3JpdGVyID0gbmV3IFN0cmluZ1dy\naXRlcigpOwogICAgICAgICAgICAgICAgZ2VuLndyaXRlQ29kZSh3cml0ZXIp\nOwogICAgICAgICAgICAgICAgb3V0cHV0LnB1dChtYXBwaW5nc1tpXS5nZXRE\nZXNjcmliZWRUeXBlKCksIHdyaXRlci50b1N0cmluZygpKTsKCiAgICAgICAg\nICAgICAgICBpZiAoYWlkICE9IG51bGwgJiYgIWFpZC5pc0lubmVyQ2xhc3Mo\nKSkgewogICAgICAgICAgICAgICAgICAgIHdyaXRlciA9IG5ldyBTdHJpbmdX\ncml0ZXIoKTsKICAgICAgICAgICAgICAgICAgICBhaWQuc2V0V3JpdGVyKHdy\naXRlcik7CiAgICAgICAgICAgICAgICAgICAgYWlkLnJlY29yZCgpOwogICAg\nICAgICAgICAgICAgICAgIG91dHB1dC5wdXQobWFwcGluZ3NbaV0uZ2V0T2Jq\nZWN0SWRUeXBlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlci50\nb1N0cmluZygpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gd3JpdHRlbjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdyaXRlIHRoZSBnZW5lcmF0ZWQgbWV0YWRhdGEgdG8gdGhl\nIHByb3BlciBwYWNrYWdlcy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBz\nZXQgb2YgbWV0YWRhdGEge0BsaW5rIEZpbGV9cyB0aGF0IHdlcmUgd3JpdHRl\nbgogICAgICovCiAgICBwdWJsaWMgQ29sbGVjdGlvbiByZWNvcmRNZXRhRGF0\nYShib29sZWFuIHBlckNsYXNzKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHJlY29yZE1ldGFEYXRhKHBlckNsYXNzLCBu\ndWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIHRoZSBjb2RlIGZv\nciB0aGUgdG9vbC4KICAgICAqCiAgICAgKiBAcGFyYW0gb3V0cHV0IGlmIG51\nbGwsIHRoZW4gcGVyZm9ybSB0aGUgd3JpdGUgZGlyZWN0bHkKICAgICAqIHRv\nIHRoZSBmaWxlc3lzdGVtOyBvdGhlcndpc2UsIHBvcHVsYXRlIHRoZQogICAg\nICogc3BlY2lmaWVkIG1hcCB3aXRoIGtleXMgYXMgdGhlIGdlbmVyYXRlZAog\nICAgICoge0BsaW5rIENsYXNzTWFwcGluZ30gYW5kIHZhbHVlcyBhcyBhCiAg\nICAgKiB7QGxpbmsgU3RyaW5nfSB0aGF0IGNvbnRhaW5zIHRoZSBnZW5lcmF0\nZWQgY29kZQogICAgICogQHJldHVybiB0aGUgc2V0IG9mIG1ldGFkYXRhIHtA\nbGluayBGaWxlfXMgdGhhdCB3ZXJlIHdyaXR0ZW4KICAgICAqLwogICAgcHVi\nbGljIENvbGxlY3Rpb24gcmVjb3JkTWV0YURhdGEoYm9vbGVhbiBwZXJDbGFz\ncywgTWFwIG91dHB1dCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIC8vIHByZXRlbmQgbWFwcGluZ3MgYXJlIGFsbCByZXNvbHZlZAog\nICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzID0gZ2V0TWFwcGluZ3Mo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1hcHBpbmdzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBtYXBwaW5nc1tpXS5zZXRSZXNvbHZlKE1P\nREVfTUVUQSB8IE1PREVfTUFQUElORywgdHJ1ZSk7CgogICAgICAgIC8vIHN0\nb3JlIGluIHVzZXIncyBjb25maWd1cmVkIElPCiAgICAgICAgTWV0YURhdGFG\nYWN0b3J5IG1kZiA9IF9jb25mLm5ld01ldGFEYXRhRmFjdG9yeUluc3RhbmNl\nKCk7CiAgICAgICAgbWRmLnNldFJlcG9zaXRvcnkoZ2V0UmVwb3NpdG9yeSgp\nKTsKICAgICAgICBtZGYuc2V0U3RvcmVEaXJlY3RvcnkoX2Rpcik7CiAgICAg\nICAgaWYgKHBlckNsYXNzKQogICAgICAgICAgICBtZGYuc2V0U3RvcmVNb2Rl\nKE1ldGFEYXRhRmFjdG9yeS5TVE9SRV9QRVJfQ0xBU1MpOwogICAgICAgIG1k\nZi5zdG9yZShtYXBwaW5ncywgbmV3IFF1ZXJ5TWV0YURhdGFbMF0sIG5ldyBT\nZXF1ZW5jZU1ldGFEYXRhWzBdLAogICAgICAgICAgICBNT0RFX01FVEEgfCBN\nT0RFX01BUFBJTkcsIG91dHB1dCk7CgogICAgICAgIFNldCBmaWxlcyA9IG5l\ndyBUcmVlU2V0KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtYXBw\naW5ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKG1hcHBpbmdzW2ld\nLmdldFNvdXJjZUZpbGUoKSAhPSBudWxsKQogICAgICAgICAgICAgICAgZmls\nZXMuYWRkKG1hcHBpbmdzW2ldLmdldFNvdXJjZUZpbGUoKSk7CiAgICAgICAg\ncmV0dXJuIGZpbGVzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGJ1aWxkQW5u\nb3RhdGlvbnMoKSB7CiAgICAgICAgTWFwIG91dHB1dCA9IG5ldyBIYXNoTWFw\nKCk7CiAgICAgICAgLy8gcHJldGVuZCBtYXBwaW5ncyBhcmUgYWxsIHJlc29s\ndmVkCiAgICAgICAgQ2xhc3NNYXBwaW5nW10gbWFwcGluZ3MgPSBnZXRNYXBw\naW5ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3Mu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIG1hcHBpbmdzW2ldLnNldFJlc29s\ndmUoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HLCB0cnVlKTsKCiAgICAgICAg\nLy8gc3RvcmUgaW4gdXNlcidzIGNvbmZpZ3VyZWQgSU8KICAgICAgICBNZXRh\nRGF0YUZhY3RvcnkgbWRmID0gX2NvbmYubmV3TWV0YURhdGFGYWN0b3J5SW5z\ndGFuY2UoKTsKICAgICAgICBtZGYuc2V0UmVwb3NpdG9yeShnZXRSZXBvc2l0\nb3J5KCkpOwogICAgICAgIG1kZi5zZXRTdG9yZURpcmVjdG9yeShfZGlyKTsK\nICAgICAgICBtZGYuc3RvcmUobWFwcGluZ3MsIG5ldyBRdWVyeU1ldGFEYXRh\nWzBdLCBuZXcgU2VxdWVuY2VNZXRhRGF0YVswXSwKICAgICAgICAgICAgTU9E\nRV9NRVRBIHwgTU9ERV9NQVBQSU5HIHwgTU9ERV9BTk5fTUFQUElORywgb3V0\ncHV0KTsKICAgICAgICBfYW5ub3MgPSBvdXRwdXQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBzdHJpbmdpZmllZCBhbm5vdGF0\naW9ucyBmb3Igc3BlY2lmaWVkIG1ldGEuCiAgICAgKi8KICAgIHB1YmxpYyBM\naXN0IGdldEFubm90YXRpb25zRm9yTWV0YShPYmplY3QgbWV0YSkgewogICAg\nICAgIGlmIChudWxsID09IF9hbm5vcykKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgcmV0dXJuIChMaXN0KSBfYW5ub3MuZ2V0KG1ldGEpOwog\nICAgfQoKICAgIC8qKgogICAgICogR2VuZXJhdGUgYW5kIHdyaXRlIHRoZSBh\ncHBsaWNhdGlvbiBpZGVudGl0eSBjb2RlLgogICAgICovCiAgICBwcml2YXRl\nIEFwcGxpY2F0aW9uSWRUb29sIG5ld0FwcGxpY2F0aW9uSWRUb29sKENsYXNz\nTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgQXBwbGljYXRpb25JZFRvb2wg\ndG9vbDsKICAgICAgICBpZiAobWFwcGluZy5nZXRJZGVudGl0eVR5cGUoKSA9\nPSBDbGFzc01hcHBpbmcuSURfQVBQTElDQVRJT04KICAgICAgICAgICAgJiYg\nIW1hcHBpbmcuaXNPcGVuSlBBSWRlbnRpdHkoKQogICAgICAgICAgICAmJiBt\nYXBwaW5nLmdldFBDU3VwZXJjbGFzcygpID09IG51bGwpIHsKICAgICAgICAg\nICAgdG9vbCA9IG5ldyBBcHBsaWNhdGlvbklkVG9vbChfY29uZiwgbWFwcGlu\nZy5nZXREZXNjcmliZWRUeXBlKCksCiAgICAgICAgICAgICAgICBtYXBwaW5n\nKTsKICAgICAgICAgICAgdG9vbC5zZXREaXJlY3RvcnkoX2Rpcik7CiAgICAg\nICAgICAgIHRvb2wuc2V0Q29kZUZvcm1hdChfZm9ybWF0KTsKICAgICAgICAg\nICAgaWYgKCF0b29sLnJ1bigpKQogICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgICAgIHJldHVybiB0b29sOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNZXRob2RzIGZvciBjdXN0b21pemVy\ncyB0byB1c2UKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY2xhc3MgbWFwcGluZyBm\nb3IgdGhlIGdpdmVuIHRhYmxlLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8K\nICAgIHB1YmxpYyBDbGFzc01hcHBpbmcgZ2V0Q2xhc3NNYXBwaW5nKFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcpIF90YWJs\nZXMuZ2V0KHRhYmxlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nIG5ldyBjbGFzcyB0byBiZSBtYXBwZWQgdG8gYSB0YWJsZS4gVGhlIGNsYXNz\nIHdpbGwgc3RhcnQgb3V0CiAgICAgKiB3aXRoIGEgZGVmYXVsdCBhcHBsaWNh\ndGlvbiBpZGVudGl0eSBjbGFzcyBzZXQuCiAgICAgKi8KICAgIHB1YmxpYyBD\nbGFzc01hcHBpbmcgbmV3Q2xhc3NNYXBwaW5nKENsYXNzIGNscywgVGFibGUg\ndGFibGUpIHsKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IChDbGFz\nc01hcHBpbmcpIGdldFJlcG9zaXRvcnkoKS5hZGRNZXRhRGF0YShjbHMpOwog\nICAgICAgIENsYXNzIHN1cCA9IG1hcHBpbmcuZ2V0RGVzY3JpYmVkVHlwZSgp\nLmdldFN1cGVyY2xhc3MoKTsKICAgICAgICBpZiAoc3VwID09IE9iamVjdC5j\nbGFzcykKICAgICAgICAgICAgc2V0T2JqZWN0SWRUeXBlKG1hcHBpbmcpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgbWFwcGluZy5zZXRQQ1N1cGVyY2xh\nc3Moc3VwKTsKICAgICAgICBtYXBwaW5nLnNldFRhYmxlKHRhYmxlKTsKICAg\nICAgICBpZiAoX2RldGFjaGFibGUpCiAgICAgICAgICAgIG1hcHBpbmcuc2V0\nRGV0YWNoYWJsZSh0cnVlKTsKICAgICAgICBfdGFibGVzLnB1dCh0YWJsZSwg\nbWFwcGluZyk7CiAgICAgICAgcmV0dXJuIG1hcHBpbmc7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIGNsYXNzJyBvYmplY3RpZC1jbGFz\ncy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNldE9iamVjdElkVHlwZShD\nbGFzc01hcHBpbmcgY2xzKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBjbHMu\nZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKTsKICAgICAgICBpZiAoX2lu\nbmVyKQogICAgICAgICAgICBuYW1lICs9ICIkIjsKICAgICAgICBuYW1lICs9\nIF9pZFN1ZmZpeDsKICAgICAgICBjbHMuc2V0T2JqZWN0SWRUeXBlKGdlbmVy\nYXRlQ2xhc3MobmFtZSwgbnVsbCksIGZhbHNlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEdlbmVyYXRlIGEgbmV3IGNsYXNzIHdpdGggdGhlIGdpdmVuIG5h\nbWUuIElmIGEgbm9uLW51bGwgcGFyZW50IGNsYXNzCiAgICAgKiBpcyBnaXZl\nbiwgaXQgd2lsbCBiZSBzZXQgYXMgdGhlIHN1cGVyY2xhc3MuCiAgICAgKi8K\nICAgIHB1YmxpYyBDbGFzcyBnZW5lcmF0ZUNsYXNzKFN0cmluZyBuYW1lLCBD\nbGFzcyBwYXJlbnQpIHsKICAgICAgICBCQ0NsYXNzIGJjID0gX3Byb2plY3Qu\nbG9hZENsYXNzKG5hbWUsIG51bGwpOwogICAgICAgIGlmIChwYXJlbnQgIT0g\nbnVsbCkKICAgICAgICAgICAgYmMuc2V0U3VwZXJjbGFzcyhwYXJlbnQpOwog\nICAgICAgIGJjLmFkZERlZmF1bHRDb25zdHJ1Y3RvcigpOwoKICAgICAgICB0\ncnkgewogICAgICAgICAgICByZXR1cm4gQ2xhc3MuZm9yTmFtZShuYW1lLCBm\nYWxzZSwgX2xvYWRlcik7CiAgICAgICAgfSBjYXRjaCAoQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiBjbmZlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRl\ncm5hbEV4Y2VwdGlvbihjbmZlLnRvU3RyaW5nKCksIGNuZmUpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoZSBn\naXZlbiBmb3JlaWduIGtleSBpcyB1bmlxdWUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGlzVW5pcXVlKEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBQ\ncmltYXJ5S2V5IHBrID0gZmsuZ2V0VGFibGUoKS5nZXRQcmltYXJ5S2V5KCk7\nCiAgICAgICAgaWYgKHBrICE9IG51bGwgJiYgcGsuY29sdW1uc01hdGNoKGZr\nLmdldENvbHVtbnMoKSkpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIEluZGV4W10gaWR4ID0gZmsuZ2V0VGFibGUoKS5nZXRJbmRleGVzKCk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpZHgubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIGlmIChpZHhbaV0uaXNVbmlxdWUoKSAmJiBpZHhbaV0u\nY29sdW1uc01hdGNoKGZrLmdldENvbHVtbnMoKSkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICBVbmlxdWVbXSB1bnEgPSBmay5nZXRU\nYWJsZSgpLmdldFVuaXF1ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHVucS5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKHVucVtpXS5j\nb2x1bW5zTWF0Y2goZmsuZ2V0Q29sdW1ucygpKSkKICAgICAgICAgICAgICAg\nIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIElmIHRoZSBnaXZlbiB0YWJsZSBoYXMgYSBzaW5nbGUg\ndW5pcXVlIGZvcmVpZ24ga2V5IG9yIGEgZm9yZWlnbgogICAgICoga2V5IHRo\nYXQgbWF0Y2hlcyB0aGUgcHJpbWFyeSBrZXksIHJldHVybiBpdC4gRWxzZSBy\nZXR1cm4gbnVsbC4KICAgICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0\nVW5pcXVlRm9yZWlnbktleShUYWJsZSB0YWJsZSkgewogICAgICAgIEZvcmVp\nZ25LZXlbXSBma3MgPSB0YWJsZS5nZXRGb3JlaWduS2V5cygpOwogICAgICAg\nIFByaW1hcnlLZXkgcGsgPSB0YWJsZS5nZXRQcmltYXJ5S2V5KCk7CiAgICAg\nICAgRm9yZWlnbktleSB1bnEgPSBudWxsOwogICAgICAgIGludCBjb3VudCA9\nIDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3MubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKHBrICE9IG51bGwgJiYgcGsuY29sdW1u\nc01hdGNoKGZrc1tpXS5nZXRDb2x1bW5zKCkpKQogICAgICAgICAgICAgICAg\ncmV0dXJuIGZrc1tpXTsKICAgICAgICAgICAgaWYgKCFpc1VuaXF1ZShma3Nb\naV0pKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBj\nb3VudCsrOwogICAgICAgICAgICBpZiAodW5xID09IG51bGwpCiAgICAgICAg\nICAgICAgICB1bnEgPSBma3NbaV07CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiAoY291bnQgPT0gMSkgPyB1bnEgOiBudWxsOwogICAgfQoKICAgIC8qKgog\nICAgICogQWRkIGV4aXN0aW5nIHVuaXF1ZSBjb25zdHJhaW50cyBhbmQgaW5k\nZXhlcyB0byB0aGUgZ2l2ZW4gZmllbGQncyBqb2luLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBhZGRKb2luQ29uc3RyYWludHMoRmllbGRNYXBwaW5nIGZp\nZWxkKSB7CiAgICAgICAgRm9yZWlnbktleSBmayA9IGZpZWxkLmdldEpvaW5G\nb3JlaWduS2V5KCk7CiAgICAgICAgaWYgKGZrID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgSW5kZXggaWR4ID0gZmluZEluZGV4KGZr\nLmdldENvbHVtbnMoKSk7CiAgICAgICAgaWYgKGlkeCAhPSBudWxsKQogICAg\nICAgICAgICBmaWVsZC5zZXRKb2luSW5kZXgoaWR4KTsKICAgICAgICBVbmlx\ndWUgdW5xID0gZmluZFVuaXF1ZShmay5nZXRDb2x1bW5zKCkpOwogICAgICAg\nIGlmICh1bnEgIT0gbnVsbCkKICAgICAgICAgICAgZmllbGQuc2V0Sm9pblVu\naXF1ZSh1bnEpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGV4aXN0aW5n\nIHVuaXF1ZSBjb25zdHJhaW50cyBhbmQgaW5kZXhlcyB0byB0aGUgZ2l2ZW4g\ndmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZENvbnN0cmFpbnRz\nKFZhbHVlTWFwcGluZyB2bSkgewogICAgICAgIENvbHVtbltdIGNvbHMgPSAo\ndm0uZ2V0Rm9yZWlnbktleSgpICE9IG51bGwpCiAgICAgICAgICAgID8gdm0u\nZ2V0Rm9yZWlnbktleSgpLmdldENvbHVtbnMoKSA6IHZtLmdldENvbHVtbnMo\nKTsKICAgICAgICBJbmRleCBpZHggPSBmaW5kSW5kZXgoY29scyk7CiAgICAg\nICAgaWYgKGlkeCAhPSBudWxsKQogICAgICAgICAgICB2bS5zZXRWYWx1ZUlu\nZGV4KGlkeCk7CiAgICAgICAgVW5pcXVlIHVucSA9IGZpbmRVbmlxdWUoY29s\ncyk7CiAgICAgICAgaWYgKHVucSAhPSBudWxsKQogICAgICAgICAgICB2bS5z\nZXRWYWx1ZVVuaXF1ZSh1bnEpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBpbmRleCB3aXRoIHRoZSBnaXZlbiBjb2x1bW5zLgogICAgICov\nCiAgICBwcml2YXRlIEluZGV4IGZpbmRJbmRleChDb2x1bW5bXSBjb2xzKSB7\nCiAgICAgICAgaWYgKGNvbHMgPT0gbnVsbCB8fCBjb2xzLmxlbmd0aCA9PSAw\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgVGFibGUgdGFi\nbGUgPSBjb2xzWzBdLmdldFRhYmxlKCk7CiAgICAgICAgSW5kZXhbXSBpZHhz\nID0gdGFibGUuZ2V0SW5kZXhlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgaWR4cy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGlkeHNb\naV0uY29sdW1uc01hdGNoKGNvbHMpKQogICAgICAgICAgICAgICAgcmV0dXJu\nIGlkeHNbaV07CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIHVuaXF1ZSBjb25zdHJpYW50IHdpdGggdGhl\nIGdpdmVuIGNvbHVtbnMuCiAgICAgKi8KICAgIHByaXZhdGUgVW5pcXVlIGZp\nbmRVbmlxdWUoQ29sdW1uW10gY29scykgewogICAgICAgIGlmIChjb2xzID09\nIG51bGwgfHwgY29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIFRhYmxlIHRhYmxlID0gY29sc1swXS5nZXRUYWJs\nZSgpOwogICAgICAgIFVuaXF1ZVtdIHVucXMgPSB0YWJsZS5nZXRVbmlxdWVz\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICBpZiAodW5xc1tpXS5jb2x1bW5zTWF0Y2goY29s\ncykpCiAgICAgICAgICAgICAgICByZXR1cm4gdW5xc1tpXTsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vCiAgICAvLyBV\ndGlsaXRpZXMKICAgIC8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFJl\ndHVybiB3aGV0aGVyIHRoZSBnaXZlbiB0YWJsZSBpcyBhIGJhc2UgY2xhc3Mg\ndGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzQmFzZVRhYmxl\nKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgaWYgKHRhYmxlLmdldFByaW1hcnlL\nZXkoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgaW50IHR5cGUgPSBnZXRTZWNvbmRhcnlUeXBlKHRhYmxlLCB0cnVlKTsK\nICAgICAgICBpZiAodHlwZSAhPSAtMSkKICAgICAgICAgICAgcmV0dXJuIHR5\ncGUgPT0gVEFCTEVfQkFTRTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gX2N1c3RvbS5nZXRUYWJsZVR5cGUodGFi\nbGUsIFRBQkxFX0JBU0UpID09IFRBQkxFX0JBU0U7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgdGhlIHR5\ncGUgb2YgdGhlIHNlY29uZGFyeSBnaXZlbiB0YWJsZS4KICAgICAqLwogICAg\ncHJpdmF0ZSBpbnQgZ2V0U2Vjb25kYXJ5VHlwZShUYWJsZSB0YWJsZSwgYm9v\nbGVhbiBtYXliZUJhc2UpIHsKICAgICAgICBpbnQgdHlwZTsKICAgICAgICBG\nb3JlaWduS2V5W10gZmtzID0gdGFibGUuZ2V0Rm9yZWlnbktleXMoKTsKICAg\nICAgICBpZiAoZmtzLmxlbmd0aCA9PSAyCiAgICAgICAgICAgICYmICh0YWJs\nZS5nZXRQcmltYXJ5S2V5KCkgPT0gbnVsbCB8fCBfcGtPbkpvaW4pCiAgICAg\nICAgICAgICYmIGZrc1swXS5nZXRDb2x1bW5zKCkubGVuZ3RoICsgZmtzWzFd\nLmdldENvbHVtbnMoKS5sZW5ndGgKICAgICAgICAgICAgPT0gdGFibGUuZ2V0\nQ29sdW1ucygpLmxlbmd0aAogICAgICAgICAgICAmJiAoIWlzVW5pcXVlKGZr\nc1swXSkgfHwgIWlzVW5pcXVlKGZrc1sxXSkpKQogICAgICAgICAgICB0eXBl\nID0gVEFCTEVfQVNTT0NJQVRJT047CiAgICAgICAgZWxzZSBpZiAobWF5YmVC\nYXNlICYmIHRhYmxlLmdldFByaW1hcnlLZXkoKSAhPSBudWxsKQogICAgICAg\nICAgICB0eXBlID0gLTE7CiAgICAgICAgZWxzZSBpZiAoZ2V0VW5pcXVlRm9y\nZWlnbktleSh0YWJsZSkgIT0gbnVsbCkKICAgICAgICAgICAgdHlwZSA9IFRB\nQkxFX1NFQ09OREFSWTsKICAgICAgICBlbHNlIGlmIChma3MubGVuZ3RoID09\nIDEpCiAgICAgICAgICAgIHR5cGUgPSBUQUJMRV9OT05FOwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgdHlwZSA9IC0xOwoKICAgICAgICBpZiAoX2N1c3Rv\nbSAhPSBudWxsICYmIHR5cGUgIT0gLTEpCiAgICAgICAgICAgIHR5cGUgPSBf\nY3VzdG9tLmdldFRhYmxlVHlwZSh0YWJsZSwgdHlwZSk7CiAgICAgICAgcmV0\ndXJuIHR5cGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBBdHRlbXB0IHRvIGNy\nZWF0ZSBhIGJhc2UgY2xhc3MgZnJvbSB0aGUgZ2l2ZW4gdGFibGUuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBtYXBCYXNlQ2xhc3MoVGFibGUgdGFibGUp\nIHsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gbmV3Q2xhc3NNYXBwaW5n\nKHRhYmxlLCBudWxsKTsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gY2hlY2sgZm9yIGRhdGFzdG9y\nZSBpZGVudGl0eSBhbmQgYnVpbHRpbiBpZGVudGl0eTsgZm9yIG5vdwogICAg\nICAgIC8vIHdlIGFzc3VtZSB0aGF0IGFueSBub24tZGF0YXN0b3JlIHNpbmds\nZSBwcmltYXJ5IGtleSBjb2x1bW4gd2lsbCB1c2UKICAgICAgICAvLyBidWls\ndGluIGlkZW50aXR5OyBpZiB3ZSBkaXNjb3ZlciB0aGF0IHRoZSBwcmltYXJ5\nIGtleSBmaWVsZCBpcwogICAgICAgIC8vIG5vdCBjb21wYXRpYmxlIHdpdGgg\nYnVpbHRpbiBpZGVudGl0eSBsYXRlciwgdGhlbiB3ZSdsbCBhc3NpZ24KICAg\nICAgICAvLyBhbiBhcHBsaWNhdGlvbiBpZGVudGl0eSBjbGFzcwogICAgICAg\nIENvbHVtbltdIHBrcyA9IHRhYmxlLmdldFByaW1hcnlLZXkoKS5nZXRDb2x1\nbW5zKCk7CiAgICAgICAgY2xzLnNldFByaW1hcnlLZXlDb2x1bW5zKHBrcyk7\nCiAgICAgICAgaWYgKHBrcy5sZW5ndGggPT0gMSAmJiBfZGF0YXN0b3JlCiAg\nICAgICAgICAgICYmIHBrc1swXS5pc0NvbXBhdGlibGUoVHlwZXMuQklHSU5U\nLCBudWxsLCAwLCAwKSkgewogICAgICAgICAgICBjbHMuc2V0T2JqZWN0SWRU\neXBlKG51bGwsIGZhbHNlKTsKICAgICAgICAgICAgY2xzLnNldElkZW50aXR5\nVHlwZShDbGFzc01hcHBpbmcuSURfREFUQVNUT1JFKTsKICAgICAgICB9IGVs\nc2UgaWYgKHBrcy5sZW5ndGggPT0gMSAmJiBfYnVpbHRpbikKICAgICAgICAg\nICAgY2xzLnNldE9iamVjdElkVHlwZShudWxsLCBmYWxzZSk7CiAgICAgICAg\nY2xzLnNldFN0cmF0ZWd5KG5ldyBGdWxsQ2xhc3NTdHJhdGVneSgpLCBudWxs\nKTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxsKQogICAgICAgICAgICBf\nY3VzdG9tLmN1c3RvbWl6ZShjbHMpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXR0ZW1wdCB0byBjcmVhdGUgYSB2ZXJ0aWNhbCBzdWJjbGFzc2VzIGZyb20g\ndGhlIGdpdmVuIHRhYmxlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIG1h\ncFN1YmNsYXNzZXMoU2V0IHRhYmxlcykgewogICAgICAgIC8vIGxvb3AgdGhy\nb3VnaCB0YWJsZXMgdW50aWwgZWl0aGVyIGFsbCBhcmUgbWFwcGVkIG9yIG5v\nbmUgbGluayB0bwogICAgICAgIC8vIGEgbWFwcGVkIGJhc2UgY2xhc3MgdGFi\nbGUKICAgICAgICBDbGFzc01hcHBpbmcgYmFzZSwgc3ViOwogICAgICAgIFRh\nYmxlIHRhYmxlID0gbnVsbDsKICAgICAgICBGb3JlaWduS2V5IGZrID0gbnVs\nbDsKICAgICAgICB3aGlsZSAoIXRhYmxlcy5pc0VtcHR5KCkpIHsKICAgICAg\nICAgICAgLy8gZmluZCBhIHRhYmxlIHdpdGggYSBmb3JlaWduIGtleSBsaW5r\naW5nIHRvIGEgbWFwcGVkIHRhYmxlCiAgICAgICAgICAgIGJhc2UgPSBudWxs\nOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHRhYmxlcy5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgdGFi\nbGUgPSAoVGFibGUpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBmayA9\nIGdldFVuaXF1ZUZvcmVpZ25LZXkodGFibGUpOwogICAgICAgICAgICAgICAg\naWYgKGZrID09IG51bGwgJiYgdGFibGUuZ2V0Rm9yZWlnbktleXMoKS5sZW5n\ndGggPT0gMSkKICAgICAgICAgICAgICAgICAgICBmayA9IHRhYmxlLmdldEZv\ncmVpZ25LZXlzKClbMF07CiAgICAgICAgICAgICAgICBlbHNlIGlmIChmayA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGl0ci5yZW1vdmUoKTsKICAg\nICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJhc2Ug\nPSAoQ2xhc3NNYXBwaW5nKSBfdGFibGVzLmdldChmay5nZXRQcmltYXJ5S2V5\nVGFibGUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2UgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nICAgICAvLyBpZiBubyB0YWJsZXMgbGluayB0byBhIGJhc2UgdGFibGUsIG5v\ndGhpbmcgbGVmdCB0byBkbwogICAgICAgICAgICBpZiAoYmFzZSA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAgc3ViID0g\nbmV3Q2xhc3NNYXBwaW5nKHRhYmxlLCBiYXNlLmdldERlc2NyaWJlZFR5cGUo\nKSk7CiAgICAgICAgICAgIHN1Yi5zZXRKb2luRm9yZWlnbktleShmayk7CiAg\nICAgICAgICAgIHN1Yi5zZXRQcmltYXJ5S2V5Q29sdW1ucyhmay5nZXRDb2x1\nbW5zKCkpOwogICAgICAgICAgICBzdWIuc2V0SWRlbnRpdHlUeXBlKGJhc2Uu\nZ2V0SWRlbnRpdHlUeXBlKCkpOwogICAgICAgICAgICBzdWIuc2V0U3RyYXRl\nZ3kobmV3IFZlcnRpY2FsQ2xhc3NTdHJhdGVneSgpLCBudWxsKTsKICAgICAg\nICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9j\ndXN0b20uY3VzdG9taXplKHN1Yik7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQXR0ZW1wdCB0byByZXZlcnNlIG1hcCB0aGUgZ2l2ZW4gdGFi\nbGUgYXMgYW4gYXNzb2NpYXRpb24gdGFibGUuCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBtYXBBc3NvY2lhdGlvblRhYmxlKFRhYmxlIHRhYmxlKSB7CiAg\nICAgICAgRm9yZWlnbktleVtdIGZrcyA9IHRhYmxlLmdldEZvcmVpZ25LZXlz\nKCk7CiAgICAgICAgaWYgKGZrcy5sZW5ndGggIT0gMikKICAgICAgICAgICAg\ncmV0dXJuOwoKICAgICAgICBDbGFzc01hcHBpbmcgY2xzMSA9IChDbGFzc01h\ncHBpbmcpIF90YWJsZXMuZ2V0CiAgICAgICAgICAgIChma3NbMF0uZ2V0UHJp\nbWFyeUtleVRhYmxlKCkpOwogICAgICAgIENsYXNzTWFwcGluZyBjbHMyID0g\nKENsYXNzTWFwcGluZykgX3RhYmxlcy5nZXQKICAgICAgICAgICAgKGZrc1sx\nXS5nZXRQcmltYXJ5S2V5VGFibGUoKSk7CiAgICAgICAgaWYgKGNsczEgPT0g\nbnVsbCB8fCBjbHMyID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAg\nICAgICAgLy8gYWRkIGEgcmVsYXRpb24gZnJvbSBlYWNoIGNsYXNzIHRvIHRo\nZSBvdGhlciB0aHJvdWdoIHRoZQogICAgICAgIC8vIGFzc29jaWF0aW9uIHRh\nYmxlCiAgICAgICAgU3RyaW5nIG5hbWUgPSBnZXRSZWxhdGlvbk5hbWUoY2xz\nMi5nZXREZXNjcmliZWRUeXBlKCksIHRydWUsIGZrc1sxXSwKICAgICAgICAg\nICAgZmFsc2UsIGNsczEpOwogICAgICAgIEZpZWxkTWFwcGluZyBmaWVsZDEg\nPSBuZXdGaWVsZE1hcHBpbmcobmFtZSwgU2V0LmNsYXNzLCBudWxsLCBma3Nb\nMV0sCiAgICAgICAgICAgIGNsczEpOwogICAgICAgIGlmIChmaWVsZDEgIT0g\nbnVsbCkgewogICAgICAgICAgICBmaWVsZDEuc2V0Sm9pbkZvcmVpZ25LZXko\nZmtzWzBdKTsKICAgICAgICAgICAgYWRkSm9pbkNvbnN0cmFpbnRzKGZpZWxk\nMSk7CiAgICAgICAgICAgIFZhbHVlTWFwcGluZyB2bSA9IGZpZWxkMS5nZXRF\nbGVtZW50TWFwcGluZygpOwogICAgICAgICAgICB2bS5zZXREZWNsYXJlZFR5\ncGUoY2xzMi5nZXREZXNjcmliZWRUeXBlKCkpOwogICAgICAgICAgICB2bS5z\nZXRGb3JlaWduS2V5KGZrc1sxXSk7CiAgICAgICAgICAgIGFkZENvbnN0cmFp\nbnRzKHZtKTsKICAgICAgICAgICAgZmllbGQxLnNldFN0cmF0ZWd5KG5ldyBS\nZWxhdGlvbkNvbGxlY3Rpb25UYWJsZUZpZWxkU3RyYXRlZ3koKSwKICAgICAg\nICAgICAgICAgIG51bGwpOwogICAgICAgICAgICBpZiAoX2N1c3RvbSAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgX2N1c3RvbS5jdXN0b21pemUoZmllbGQx\nKTsKICAgICAgICB9CgogICAgICAgIG5hbWUgPSBnZXRSZWxhdGlvbk5hbWUo\nY2xzMS5nZXREZXNjcmliZWRUeXBlKCksIHRydWUsIGZrc1swXSwKICAgICAg\nICAgICAgZmFsc2UsIGNsczIpOwogICAgICAgIEZpZWxkTWFwcGluZyBmaWVs\nZDIgPSBuZXdGaWVsZE1hcHBpbmcobmFtZSwgU2V0LmNsYXNzLCBudWxsLCBm\na3NbMF0sCiAgICAgICAgICAgIGNsczIpOwogICAgICAgIGlmIChmaWVsZDIg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBmaWVsZDIu\nc2V0Sm9pbkZvcmVpZ25LZXkoZmtzWzFdKTsKICAgICAgICBhZGRKb2luQ29u\nc3RyYWludHMoZmllbGQyKTsKICAgICAgICBWYWx1ZU1hcHBpbmcgdm0gPSBm\naWVsZDIuZ2V0RWxlbWVudE1hcHBpbmcoKTsKICAgICAgICB2bS5zZXREZWNs\nYXJlZFR5cGUoY2xzMS5nZXREZXNjcmliZWRUeXBlKCkpOwogICAgICAgIHZt\nLnNldEZvcmVpZ25LZXkoZmtzWzBdKTsKICAgICAgICBhZGRDb25zdHJhaW50\ncyh2bSk7CiAgICAgICAgaWYgKGZpZWxkMSAhPSBudWxsICYmIGZpZWxkMS5n\nZXRNYXBwZWRCeSgpID09IG51bGwpCiAgICAgICAgICAgIGZpZWxkMi5zZXRN\nYXBwZWRCeShmaWVsZDEuZ2V0TmFtZSgpKTsKICAgICAgICBmaWVsZDIuc2V0\nU3RyYXRlZ3kobmV3IFJlbGF0aW9uQ29sbGVjdGlvblRhYmxlRmllbGRTdHJh\ndGVneSgpLCBudWxsKTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxsKQog\nICAgICAgICAgICBfY3VzdG9tLmN1c3RvbWl6ZShmaWVsZDIpOwogICAgfQoK\nICAgIC8qKgogICAgICogQXR0ZW1wdCB0byByZXZlcnNlIG1hcCB0aGUgZ2l2\nZW4gdGFibGUgYXMgYSBzZWNvbmRhcnkgdGFibGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBtYXBTZWNvbmRhcnlUYWJsZShUYWJsZSB0YWJsZSwgYm9v\nbGVhbiBvdXRlcikgewogICAgICAgIEZvcmVpZ25LZXkgZmsgPSBnZXRVbmlx\ndWVGb3JlaWduS2V5KHRhYmxlKTsKICAgICAgICBpZiAoZmsgPT0gbnVsbCAm\nJiB0YWJsZS5nZXRGb3JlaWduS2V5cygpLmxlbmd0aCA9PSAxKQogICAgICAg\nICAgICBmayA9IHRhYmxlLmdldEZvcmVpZ25LZXlzKClbMF07CiAgICAgICAg\nZWxzZSBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIENsYXNzTWFwcGluZyBjbHMgPSAoQ2xhc3NNYXBwaW5nKSBfdGFibGVz\nLmdldChmay5nZXRQcmltYXJ5S2V5VGFibGUoKSk7CiAgICAgICAgaWYgKGNs\ncyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgbWFwQ29s\ndW1ucyhjbHMsIHRhYmxlLCBmaywgb3V0ZXIpOwogICAgfQoKICAgIC8qKgog\nICAgICogTWFwIHRoZSBjb2x1bW5zIG9mIHRoZSBnaXZlbiB0YWJsZSB0byBm\naWVsZHMgb2YgdGhlIGdpdmVuIHR5cGUuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBtYXBDb2x1bW5zKENsYXNzTWFwcGluZyBjbHMsIFRhYmxlIHRhYmxl\nLCBGb3JlaWduS2V5IGpvaW4sCiAgICAgICAgYm9vbGVhbiBvdXRlcikgewog\nICAgICAgIC8vIGZpcnN0IG1hcCBmb3JlaWduIGtleXMgdG8gcmVsYXRpb25z\nCiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IHRhYmxlLmdldEZvcmVpZ25L\nZXlzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3MubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIGlmIChma3NbaV0gIT0gam9pbiAmJiBma3Nb\naV0gIT0gY2xzLmdldEpvaW5Gb3JlaWduS2V5KCkpCiAgICAgICAgICAgICAg\nICBtYXBGb3JlaWduS2V5KGNscywgZmtzW2ldLCBqb2luLCBvdXRlcik7Cgog\nICAgICAgIC8vIG1hcCBhbnkgY29sdW1ucyBub3QgY29udHJvbGxlZCBieSBm\nb3JlaWduIGtleXM7IGFsc28gZm9yY2UgcHJpbWFyeQogICAgICAgIC8vIGtl\neSBjb2xzIHRvIGdldCBtYXBwZWQgdG8gc2ltcGxlIGZpZWxkcyBldmVuIGlm\nIHRoZSBjb2x1bW5zIGFyZQogICAgICAgIC8vIGFsc28gZm9yZWlnbiBrZXkg\nY29sdW1ucwogICAgICAgIFByaW1hcnlLZXkgcGsgPSAoam9pbiAhPSBudWxs\nKSA/IG51bGwgOiB0YWJsZS5nZXRQcmltYXJ5S2V5KCk7CiAgICAgICAgYm9v\nbGVhbiBwa2NvbDsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gdGFibGUuZ2V0\nQ29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICBwa2NvbCA9IHBrICE9IG51bGwg\nJiYgcGsuY29udGFpbnNDb2x1bW4oY29sc1tpXSk7CiAgICAgICAgICAgIGlm\nIChwa2NvbCAmJiBjbHMuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNYXBw\naW5nLklEX0RBVEFTVE9SRSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwog\nICAgICAgICAgICBpZiAoKGNscy5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBudWxs\nICYmIHBrY29sKQogICAgICAgICAgICAgICAgfHwgIWlzRm9yZWlnbktleUNv\nbHVtbihjb2xzW2ldKSkKICAgICAgICAgICAgICAgIG1hcENvbHVtbihjbHMs\nIGNvbHNbaV0sIGpvaW4sIG91dGVyKTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBnaXZlbiBjb2x1bW4gYXBwZWFycyBp\nbiBhbnkgZm9yZWlnbiBrZXlzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBib29sZWFuIGlzRm9yZWlnbktleUNvbHVtbihDb2x1bW4gY29sKSB7CiAg\nICAgICAgRm9yZWlnbktleVtdIGZrcyA9IGNvbC5nZXRUYWJsZSgpLmdldEZv\ncmVpZ25LZXlzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3Mu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChma3NbaV0uY29udGFpbnND\nb2x1bW4oY29sKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIE1hcCBh\nIGZvcmVpZ24ga2V5IHRvIGEgcmVsYXRpb24uCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBtYXBGb3JlaWduS2V5KENsYXNzTWFwcGluZyBjbHMsIEZvcmVp\nZ25LZXkgZmssCiAgICAgICAgRm9yZWlnbktleSBqb2luLCBib29sZWFuIG91\ndGVyKSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIHJlbCA9IChDbGFzc01hcHBp\nbmcpIF90YWJsZXMuZ2V0KGZrLmdldFByaW1hcnlLZXlUYWJsZSgpKTsKICAg\nICAgICBpZiAocmVsID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAg\nICAgICAgU3RyaW5nIG5hbWUgPSBnZXRSZWxhdGlvbk5hbWUocmVsLmdldERl\nc2NyaWJlZFR5cGUoKSwgZmFsc2UsIGZrLAogICAgICAgICAgICBmYWxzZSwg\nY2xzKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQxID0gbmV3RmllbGRN\nYXBwaW5nKG5hbWUsIHJlbC5nZXREZXNjcmliZWRUeXBlKCksCiAgICAgICAg\nICAgIG51bGwsIGZrLCBjbHMpOwogICAgICAgIGlmIChmaWVsZDEgIT0gbnVs\nbCkgewogICAgICAgICAgICBmaWVsZDEuc2V0Sm9pbkZvcmVpZ25LZXkoam9p\nbik7CiAgICAgICAgICAgIGZpZWxkMS5zZXRKb2luT3V0ZXIob3V0ZXIpOwog\nICAgICAgICAgICBhZGRKb2luQ29uc3RyYWludHMoZmllbGQxKTsKICAgICAg\nICAgICAgZmllbGQxLnNldEZvcmVpZ25LZXkoZmspOwogICAgICAgICAgICBh\nZGRDb25zdHJhaW50cyhmaWVsZDEpOwogICAgICAgICAgICBmaWVsZDEuc2V0\nU3RyYXRlZ3kobmV3IFJlbGF0aW9uRmllbGRTdHJhdGVneSgpLCBudWxsKTsK\nICAgICAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIF9jdXN0b20uY3VzdG9taXplKGZpZWxkMSk7CiAgICAgICAgfQogICAg\nICAgIGlmICghX2ludmVyc2UgfHwgam9pbiAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm47CgogICAgICAgIC8vIGNyZWF0ZSBpbnZlcnNlIHJlbGF0aW9u\nCiAgICAgICAgYm9vbGVhbiB1bnEgPSBpc1VuaXF1ZShmayk7CiAgICAgICAg\nbmFtZSA9IGdldFJlbGF0aW9uTmFtZShjbHMuZ2V0RGVzY3JpYmVkVHlwZSgp\nLCAhdW5xLCBmaywgdHJ1ZSwgcmVsKTsKICAgICAgICBDbGFzcyB0eXBlID0g\nKHVucSkgPyBjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpIDogU2V0LmNsYXNzOwog\nICAgICAgIEZpZWxkTWFwcGluZyBmaWVsZDIgPSBuZXdGaWVsZE1hcHBpbmco\nbmFtZSwgdHlwZSwgbnVsbCwgZmssIHJlbCk7CiAgICAgICAgaWYgKGZpZWxk\nMiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKGZp\nZWxkMSAhPSBudWxsKQogICAgICAgICAgICBmaWVsZDIuc2V0TWFwcGVkQnko\nZmllbGQxLmdldE5hbWUoKSk7CiAgICAgICAgaWYgKHVucSkgewogICAgICAg\nICAgICBmaWVsZDIuc2V0Rm9yZWlnbktleShmayk7CiAgICAgICAgICAgIGZp\nZWxkMi5zZXRKb2luRGlyZWN0aW9uKGZpZWxkMi5KT0lOX0lOVkVSU0UpOwog\nICAgICAgICAgICBmaWVsZDIuc2V0U3RyYXRlZ3kobmV3IFJlbGF0aW9uRmll\nbGRTdHJhdGVneSgpLCBudWxsKTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICBWYWx1ZU1hcHBpbmcgdm0gPSBmaWVsZDIuZ2V0RWxlbWVudE1hcHBp\nbmcoKTsKICAgICAgICAgICAgdm0uc2V0RGVjbGFyZWRUeXBlKGNscy5nZXRE\nZXNjcmliZWRUeXBlKCkpOwogICAgICAgICAgICB2bS5zZXRGb3JlaWduS2V5\nKGZrKTsKICAgICAgICAgICAgdm0uc2V0Sm9pbkRpcmVjdGlvbih2bS5KT0lO\nX0VYUEVDVEVEX0lOVkVSU0UpOwogICAgICAgICAgICBmaWVsZDIuc2V0U3Ry\nYXRlZ3kobmV3IFJlbGF0aW9uQ29sbGVjdGlvbkludmVyc2VLZXlGaWVsZFN0\ncmF0ZWd5KCksCiAgICAgICAgICAgICAgICBudWxsKTsKICAgICAgICB9CiAg\nICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAgX2N1c3Rv\nbS5jdXN0b21pemUoZmllbGQyKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1h\ncCBhIGNvbHVtbiB0byBhIHNpbXBsZSBmaWVsZC4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIG1hcENvbHVtbihDbGFzc01hcHBpbmcgY2xzLCBDb2x1bW4g\nY29sLCBGb3JlaWduS2V5IGpvaW4sCiAgICAgICAgYm9vbGVhbiBvdXRlcikg\newogICAgICAgIFN0cmluZyBuYW1lID0gZ2V0RmllbGROYW1lKGNvbC5nZXRO\nYW1lKCksIGNscyk7CiAgICAgICAgQ2xhc3MgdHlwZSA9IGdldEZpZWxkVHlw\nZShjb2wsIGZhbHNlKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQgPSBu\nZXdGaWVsZE1hcHBpbmcobmFtZSwgdHlwZSwgY29sLCBudWxsLCBjbHMpOwog\nICAgICAgIGZpZWxkLnNldFNlcmlhbGl6ZWQodHlwZSA9PSBPYmplY3QuY2xh\nc3MpOwogICAgICAgIGZpZWxkLnNldEpvaW5Gb3JlaWduS2V5KGpvaW4pOwog\nICAgICAgIGZpZWxkLnNldEpvaW5PdXRlcihvdXRlcik7CiAgICAgICAgYWRk\nSm9pbkNvbnN0cmFpbnRzKGZpZWxkKTsKICAgICAgICBmaWVsZC5zZXRDb2x1\nbW5zKG5ldyBDb2x1bW5bXXsgY29sIH0pOwogICAgICAgIGFkZENvbnN0cmFp\nbnRzKGZpZWxkKTsKICAgICAgICBpZiAoY29sLmlzUHJpbWFyeUtleSgpCiAg\nICAgICAgICAgICYmIGNscy5nZXRJZGVudGl0eVR5cGUoKSAhPSBDbGFzc01h\ncHBpbmcuSURfREFUQVNUT1JFKQogICAgICAgICAgICBmaWVsZC5zZXRQcmlt\nYXJ5S2V5KHRydWUpOwoKICAgICAgICBGaWVsZFN0cmF0ZWd5IHN0cmF0Owog\nICAgICAgIGlmICh0eXBlLmlzUHJpbWl0aXZlKCkpCiAgICAgICAgICAgIHN0\ncmF0ID0gbmV3IFByaW1pdGl2ZUZpZWxkU3RyYXRlZ3koKTsKICAgICAgICBl\nbHNlIGlmIChjb2wuZ2V0VHlwZSgpID09IFR5cGVzLkNMT0IKICAgICAgICAg\nICAgJiYgX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKS5tYXhFbWJl\nZGRlZENsb2JTaXplICE9IC0xKQogICAgICAgICAgICBzdHJhdCA9IG5ldyBN\nYXhFbWJlZGRlZENsb2JGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgZWxzZSBp\nZiAoY29sLmlzTG9iKCkKICAgICAgICAgICAgJiYgX2NvbmYuZ2V0REJEaWN0\naW9uYXJ5SW5zdGFuY2UoKS5tYXhFbWJlZGRlZEJsb2JTaXplICE9IC0xKQog\nICAgICAgICAgICBzdHJhdCA9IG5ldyBNYXhFbWJlZGRlZEJsb2JGaWVsZFN0\ncmF0ZWd5KCk7CiAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBTdHJpbmcuY2xh\nc3MpCiAgICAgICAgICAgIHN0cmF0ID0gbmV3IFN0cmluZ0ZpZWxkU3RyYXRl\nZ3koKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0cmF0ID0gbmV3IEhh\nbmRsZXJGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgZmllbGQuc2V0U3RyYXRl\nZ3koc3RyYXQsIG51bGwpOwogICAgICAgIGlmIChfY3VzdG9tICE9IG51bGwp\nCiAgICAgICAgICAgIF9jdXN0b20uY3VzdG9taXplKGZpZWxkKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENyZWF0ZSBhIGNsYXNzIG1hcHBpbmcgZm9yIHRo\nZSBnaXZlbiB0YWJsZSwgb3IgcmV0dXJuIG51bGwgaWYKICAgICAqIGN1c3Rv\nbWl6ZXIgcmVqZWN0cy4KICAgICAqLwogICAgcHJpdmF0ZSBDbGFzc01hcHBp\nbmcgbmV3Q2xhc3NNYXBwaW5nKFRhYmxlIHRhYmxlLCBDbGFzcyBwYXJlbnQp\nIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGdldENsYXNzTmFtZSh0YWJsZSk7\nCiAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAgbmFt\nZSA9IF9jdXN0b20uZ2V0Q2xhc3NOYW1lKHRhYmxlLCBuYW1lKTsKICAgICAg\nICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICByZXR1cm4gbmV3Q2xhc3NNYXBwaW5nKGdlbmVyYXRlQ2xhc3Mo\nbmFtZSwgcGFyZW50KSwgdGFibGUpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgZmllbGQgbWFwcGluZyBmb3IgdGhlIGdpdmVuIGluZm8sIG9y\nIHJldHVybiBudWxsIGlmCiAgICAgKiBjdXN0b21pemVyIHJlamVjdHMuCiAg\nICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgbmV3RmllbGRNYXBwaW5n\nKFN0cmluZyBuYW1lLCBDbGFzcyB0eXBlLCBDb2x1bW4gY29sLAogICAgICAg\nIEZvcmVpZ25LZXkgZmssIENsYXNzTWFwcGluZyBkZWMpIHsKICAgICAgICBp\nZiAoX2N1c3RvbSAhPSBudWxsKSB7CiAgICAgICAgICAgIENvbHVtbltdIGNv\nbHMgPSAoZmsgPT0gbnVsbCkgPyBuZXcgQ29sdW1uW117IGNvbCB9CiAgICAg\nICAgICAgICAgICA6IGZrLmdldENvbHVtbnMoKTsKICAgICAgICAgICAgU3Ry\naW5nIG5ld05hbWUgPSBfY3VzdG9tLmdldEZpZWxkTmFtZShkZWMsIGNvbHMs\nIGZrLCBuYW1lKTsKICAgICAgICAgICAgaWYgKG5ld05hbWUgPT0gbnVsbCB8\nfCAhbmV3TmFtZS5lcXVhbHMobmFtZSkpIHsKICAgICAgICAgICAgICAgIGlm\nIChfYWJhbmRvbmVkRmllbGROYW1lcyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIF9hYmFuZG9uZWRGaWVsZE5hbWVzID0gbmV3IEhhc2hTZXQoKTsK\nICAgICAgICAgICAgICAgIF9hYmFuZG9uZWRGaWVsZE5hbWVzLmFkZChkZWMu\nZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKQogICAgICAgICAgICAgICAg\nICAgICsgIi4iICsgbmFtZSk7CiAgICAgICAgICAgICAgICBpZiAobmV3TmFt\nZSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgICAgICAgICAgbmFtZSA9IG5ld05hbWU7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIEZpZWxkTWFwcGluZyBmaWVsZCA9IGRlYy5h\nZGREZWNsYXJlZEZpZWxkTWFwcGluZyhuYW1lLCB0eXBlKTsKICAgICAgICBm\naWVsZC5zZXRFeHBsaWNpdCh0cnVlKTsKICAgICAgICByZXR1cm4gZmllbGQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBKYXZhIGlkZW50aWZp\nZXItZm9ybWF0dGVkIG5hbWUgZm9yIHRoZSBnaXZlbiB0YWJsZQogICAgICog\nbmFtZSwgdXNpbmcgdGhlIGRlZmF1bHQgcGFja2FnZS4KICAgICAqLwogICAg\ncHJpdmF0ZSBTdHJpbmcgZ2V0Q2xhc3NOYW1lKFRhYmxlIHRhYmxlKSB7CiAg\nICAgICAgU3RyaW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5nQnVpbGRlcigp\nOwogICAgICAgIGlmIChnZXRQYWNrYWdlTmFtZSgpICE9IG51bGwpCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoZ2V0UGFja2FnZU5hbWUoKSkuYXBwZW5kKCIu\nIik7CgogICAgICAgIFN0cmluZ1tdIHN1YnM7CiAgICAgICAgU3RyaW5nIG5h\nbWUgPSByZXBsYWNlSW52YWxpZENoYXJhY3RlcnModGFibGUuZ2V0U2NoZW1h\nTmFtZSgpKTsKICAgICAgICBpZiAoX3VzZVNjaGVtYSAmJiBuYW1lICE9IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKGFsbFVwcGVyQ2FzZShuYW1lKSkKICAg\nICAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAg\nICAgICAgIHN1YnMgPSBTdHJpbmdzLnNwbGl0KG5hbWUsICJfIiwgMCk7CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoU3RyaW5nVXRpbHMuY2Fw\naXRhbGlzZShzdWJzW2ldKSk7CiAgICAgICAgfQoKICAgICAgICBuYW1lID0g\ncmVwbGFjZUludmFsaWRDaGFyYWN0ZXJzKHRhYmxlLmdldE5hbWUoKSk7CiAg\nICAgICAgaWYgKGFsbFVwcGVyQ2FzZShuYW1lKSkKICAgICAgICAgICAgbmFt\nZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICBzdWJzID0gU3RyaW5n\ncy5zcGxpdChuYW1lLCAiXyIsIDApOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBtYWtl\nIHN1cmUgdGhlIG5hbWUgY2FuJ3QgY29uZmxpY3Qgd2l0aCBnZW5lcmF0ZWQg\naWQgY2xhc3MgbmFtZXM7CiAgICAgICAgICAgIC8vIGlmIHRoZSBuYW1lIHdv\ndWxkIGVuZCBpbiAnSWQnLCBtYWtlIGl0IGVuZCBpbiAnSWRlbnQnCiAgICAg\nICAgICAgIGlmIChpID09IHN1YnMubGVuZ3RoIC0gMSAmJiBzdWJzW2ldLmVx\ndWFsc0lnbm9yZUNhc2UoImlkIikpCiAgICAgICAgICAgICAgICBzdWJzW2ld\nID0gImlkZW50IjsKICAgICAgICAgICAgYnVmLmFwcGVuZChTdHJpbmdVdGls\ncy5jYXBpdGFsaXNlKHN1YnNbaV0pKTsKICAgICAgICB9CgogICAgICAgIHJl\ndHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIGRlZmF1bHQgSmF2YSBpZGVudGlmaWVyLWZvcm1hdHRlZCBuYW1l\nIGZvciB0aGUgZ2l2ZW4KICAgICAqIGNvbHVtbi90YWJsZSBuYW1lLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZpZWxkTmFtZShTdHJpbmcgbmFt\nZSwgQ2xhc3NNYXBwaW5nIGRlYykgewogICAgICAgIG5hbWUgPSByZXBsYWNl\nSW52YWxpZENoYXJhY3RlcnMobmFtZSk7CiAgICAgICAgaWYgKGFsbFVwcGVy\nQ2FzZShuYW1lKSkKICAgICAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNh\nc2UoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG5hbWUgPSBDaGFyYWN0\nZXIudG9Mb3dlckNhc2UobmFtZS5jaGFyQXQoMCkpICsgbmFtZS5zdWJzdHJp\nbmcoMSk7CgogICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3IFN0cmlu\nZ0J1aWxkZXIoKTsKICAgICAgICBTdHJpbmdbXSBzdWJzID0gU3RyaW5ncy5z\ncGxpdChuYW1lLCAiXyIsIDApOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgc3Vicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoaSA+IDAp\nCiAgICAgICAgICAgICAgICBzdWJzW2ldID0gU3RyaW5nVXRpbHMuY2FwaXRh\nbGlzZShzdWJzW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChzdWJzW2ld\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGdldFVuaXF1ZU5hbWUoYnVm\nLnRvU3RyaW5nKCksIGRlYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gYSBkZWZhdWx0IGphdmEgaWRlbnRpZmllci1mb3JtYXR0ZWQgZmllbGQg\ncmVsYXRpb24gbmFtZQogICAgICogZm9yIHRoZSBnaXZlbiBjbGFzcyBuYW1l\nLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRSZWxhdGlvbk5hbWUo\nQ2xhc3MgZmllbGRUeXBlLCBib29sZWFuIGNvbGwsCiAgICAgICAgRm9yZWln\nbktleSBmaywgYm9vbGVhbiBpbnZlcnNlLCBDbGFzc01hcHBpbmcgZGVjKSB7\nCiAgICAgICAgaWYgKF91c2VGSyAmJiBmay5nZXROYW1lKCkgIT0gbnVsbCkg\newogICAgICAgICAgICBTdHJpbmcgbmFtZSA9IGdldEZpZWxkTmFtZShmay5n\nZXROYW1lKCksIGRlYyk7CiAgICAgICAgICAgIGlmIChpbnZlcnNlICYmIGNv\nbGwpCiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZSArICJJbnZlcnNlcyI7\nCiAgICAgICAgICAgIGVsc2UgaWYgKGludmVyc2UpCiAgICAgICAgICAgICAg\nICBuYW1lID0gbmFtZSArICJJbnZlcnNlIjsKICAgICAgICAgICAgcmV0dXJu\nIGdldFVuaXF1ZU5hbWUobmFtZSwgZGVjKTsKICAgICAgICB9CgogICAgICAg\nIC8vIGdldCBqdXN0IHRoZSBjbGFzcyBuYW1lLCB3L28gcGFja2FnZQogICAg\nICAgIFN0cmluZyBuYW1lID0gZmllbGRUeXBlLmdldE5hbWUoKTsKICAgICAg\nICBuYW1lID0gbmFtZS5zdWJzdHJpbmcobmFtZS5sYXN0SW5kZXhPZignLicp\nICsgMSk7CgogICAgICAgIC8vIG1ha2UgdGhlIGZpcnN0IGNoYXJhY3RlciBs\nb3dlcmNhc2UgYW5kIHBsdXJhbGl6ZSBpZiBhIGNvbGxlY3Rpb24KICAgICAg\nICBuYW1lID0gQ2hhcmFjdGVyLnRvTG93ZXJDYXNlKG5hbWUuY2hhckF0KDAp\nKSArIG5hbWUuc3Vic3RyaW5nKDEpOwogICAgICAgIGlmIChjb2xsICYmICFu\nYW1lLmVuZHNXaXRoKCJzIikpCiAgICAgICAgICAgIG5hbWUgKz0gInMiOwoK\nICAgICAgICByZXR1cm4gZ2V0VW5pcXVlTmFtZShuYW1lLCBkZWMpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIHN0\ncmluZyBpcyBhbGwgdXBwZXJjYXNlIGxldHRlcnMuCiAgICAgKi8KICAgIHBy\naXZhdGUgc3RhdGljIGJvb2xlYW4gYWxsVXBwZXJDYXNlKFN0cmluZyBzdHIp\nIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN0ci5sZW5ndGgoKTsg\naSsrKSB7CiAgICAgICAgICAgIGlmIChDaGFyYWN0ZXIuaXNMZXR0ZXIoc3Ry\nLmNoYXJBdChpKSkKICAgICAgICAgICAgICAgICYmICFDaGFyYWN0ZXIuaXNV\ncHBlckNhc2Uoc3RyLmNoYXJBdChpKSkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAg\nfQoKICAgIC8qKgogICAgICogUmVwbGFjZSBjaGFyYWN0ZXJzIG5vdCBhbGxv\nd2VkIGluIEphdmEgbmFtZXMgd2l0aCBhbiB1bmRlcnNjb3JlOwogICAgICog\ncGFja2FnZS1wcml2YXRlIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBzdGF0\naWMgU3RyaW5nIHJlcGxhY2VJbnZhbGlkQ2hhcmFjdGVycyhTdHJpbmcgc3Ry\nKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoc3RyKSkKICAg\nICAgICAgICAgcmV0dXJuIHN0cjsKCiAgICAgICAgU3RyaW5nQnVpbGRlciBi\ndWYgPSBuZXcgU3RyaW5nQnVpbGRlcihzdHIpOwogICAgICAgIGNoYXIgYzsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJ1Zi5sZW5ndGgoKTsgaSsr\nKSB7CiAgICAgICAgICAgIGMgPSBidWYuY2hhckF0KGkpOwogICAgICAgICAg\nICBpZiAoYyA9PSAnJCcgfHwgIUNoYXJhY3Rlci5pc0phdmFJZGVudGlmaWVy\nUGFydChzdHIuY2hhckF0KGkpKSkKICAgICAgICAgICAgICAgIGJ1Zi5zZXRD\naGFyQXQoaSwgJ18nKTsKICAgICAgICB9CgogICAgICAgIC8vIHN0cmlwIGxl\nYWRpbmcgYW5kIHRyYWlsaW5nIHVuZGVyc2NvcmVzCiAgICAgICAgaW50IHN0\nYXJ0ID0gMDsKICAgICAgICB3aGlsZSAoc3RhcnQgPCBidWYubGVuZ3RoKCkg\nJiYgYnVmLmNoYXJBdChzdGFydCkgPT0gJ18nKQogICAgICAgICAgICBzdGFy\ndCsrOwogICAgICAgIGludCBlbmQgPSBidWYubGVuZ3RoKCkgLSAxOwogICAg\nICAgIHdoaWxlIChlbmQgPj0gMCAmJiBidWYuY2hhckF0KGVuZCkgPT0gJ18n\nKQogICAgICAgICAgICBlbmQtLTsKCiAgICAgICAgLy8gcG9zc2libGUgdGhh\ndCBhbGwgY2hhcnMgaW4gbmFtZSBhcmUgaW52YWxpZAogICAgICAgIGlmIChz\ndGFydCA+IGVuZCkKICAgICAgICAgICAgcmV0dXJuICJ4IjsKICAgICAgICBy\nZXR1cm4gYnVmLnN1YnN0cmluZyhzdGFydCwgZW5kICsgMSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBNb2RpZmllcyB0aGUgZ2l2ZW4gbmFtZSBhcyBuZWNl\nc3NhcnkgdG8gZW5zdXJlIHRoYXQgaXQgaXNuJ3QgYWxyZWFkeQogICAgICog\ndGFrZW4gYnkgYSBmaWVsZCBpbiB0aGUgZ2l2ZW4gcGFyZW50LgogICAgICov\nCiAgICBwcml2YXRlIFN0cmluZyBnZXRVbmlxdWVOYW1lKFN0cmluZyBuYW1l\nLCBDbGFzc01hcHBpbmcgZGVjKSB7CiAgICAgICAgLy8gbWFrZSBzdXJlIHRo\nZSBuYW1lIGlzbid0IGEga2V5d29yZAogICAgICAgIGlmIChfamF2YUtleXdv\ncmRzLmNvbnRhaW5zS2V5KG5hbWUpKQogICAgICAgICAgICBuYW1lID0gKFN0\ncmluZykgX2phdmFLZXl3b3Jkcy5nZXQobmFtZSk7CgogICAgICAgIC8vIHRo\naXMgaXMgdGhlIHNhbWUgYWxnb3JpdGhtIHVzZWQgaW4gREJEaWN0aW9uYXJ5\nIHRvIGdldCB1bmlxdWUgbmFtZXMKICAgICAgICBTdHJpbmcgcHJlZml4ID0g\nZGVjLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkgKyAiLiI7CiAgICAg\nICAgZm9yIChpbnQgdmVyc2lvbiA9IDIsIGNoYXJzID0gMTsKICAgICAgICAg\nICAgZGVjLmdldERlY2xhcmVkRmllbGQobmFtZSkgIT0gbnVsbAogICAgICAg\nICAgICAgICAgfHwgKF9hYmFuZG9uZWRGaWVsZE5hbWVzICE9IG51bGwKICAg\nICAgICAgICAgICAgICYmIF9hYmFuZG9uZWRGaWVsZE5hbWVzLmNvbnRhaW5z\nKHByZWZpeCArIG5hbWUpKTsgdmVyc2lvbisrKSB7CiAgICAgICAgICAgIGlm\nICh2ZXJzaW9uID4gMikKICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1\nYnN0cmluZygwLCBuYW1lLmxlbmd0aCgpIC0gY2hhcnMpOwogICAgICAgICAg\nICBpZiAodmVyc2lvbiA+PSBNYXRoLnBvdygxMCwgY2hhcnMpKQogICAgICAg\nICAgICAgICAgY2hhcnMrKzsKICAgICAgICAgICAgbmFtZSA9IG5hbWUgKyB2\nZXJzaW9uOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmFtZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGVmYXVsdCBmaWVsZCB0eXBl\nIGZvciB0aGUgZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBwdWJsaWMgQ2xh\nc3MgZ2V0RmllbGRUeXBlKENvbHVtbiBjb2wsIGJvb2xlYW4gZm9yY2VPYmpl\nY3QpIHsKICAgICAgICAvLyBjaGVjayB0aGUgY3VzdG9tIHR5cGUgbWFwIHRv\nIHNlZSBpZiB3ZSd2ZSBvdmVycmlkZGVuIHRoZQogICAgICAgIC8vIGRlZmF1\nbHQgdHlwZSB0byBjcmVhdGUgZm9yIGEgcmF3IFNRTCB0eXBlIG5hbWUKICAg\nICAgICBDbGFzcyB0eXBlID0gbnVsbDsKICAgICAgICBpZiAoX3R5cGVNYXAg\nIT0gbnVsbCkgewogICAgICAgICAgICAvLyBmaXJzdCB0cnkgIlRZUEUoU0la\nRSxERUNJTUFMUykiLCB0aGVuICJUWVBFKFNJWkUpLCB0aGVuICJUWVBFIgog\nICAgICAgICAgICBTdHJpbmdbXSBwcm9wTmFtZXMgPSBuZXcgU3RyaW5nW117\nCiAgICAgICAgICAgICAgICBjb2wuZ2V0VHlwZU5hbWUoKSArICIoIiArIGNv\nbC5nZXRTaXplKCkgKyAiLCIKICAgICAgICAgICAgICAgICAgICArIGNvbC5n\nZXREZWNpbWFsRGlnaXRzKCkgKyAiKSIsCiAgICAgICAgICAgICAgICBjb2wu\nZ2V0VHlwZU5hbWUoKSArICIoIiArIGNvbC5nZXRTaXplKCkgKyAiKSIsCiAg\nICAgICAgICAgICAgICBjb2wuZ2V0VHlwZU5hbWUoKQogICAgICAgICAgICB9\nOwoKICAgICAgICAgICAgU3RyaW5nIHR5cGVOYW1lID0gbnVsbDsKICAgICAg\nICAgICAgU3RyaW5nIHR5cGVTcGVjID0gbnVsbDsKICAgICAgICAgICAgaW50\nIG5hbWVJZHggPSAwOwogICAgICAgICAgICBmb3IgKDsgdHlwZVNwZWMgPT0g\nbnVsbCAmJiBuYW1lSWR4IDwgcHJvcE5hbWVzLmxlbmd0aDsgbmFtZUlkeCsr\nKSB7CiAgICAgICAgICAgICAgICBpZiAocHJvcE5hbWVzW25hbWVJZHhdID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAg\nICAgICAgICAgdHlwZVNwZWMgPSBTdHJpbmdVdGlscy50cmltVG9OdWxsKF90\neXBlTWFwLmdldFByb3BlcnR5CiAgICAgICAgICAgICAgICAgICAgKHByb3BO\nYW1lc1tuYW1lSWR4XSkpOwogICAgICAgICAgICAgICAgaWYgKHR5cGVTcGVj\nICE9IG51bGwpIAogICAgICAgICAgICAgICAgICAgIHR5cGVOYW1lID0gcHJv\ncE5hbWVzW25hbWVJZHhdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlm\nICh0eXBlU3BlYyAhPSBudWxsKQogICAgICAgICAgICAgICAgX2xvZy5pbmZv\nKF9sb2MuZ2V0KCJyZXZlcnNlLXR5cGUiLCB0eXBlTmFtZSwgdHlwZVNwZWMp\nKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2xvZy50cmFj\nZShfbG9jLmdldCgibm8tcmV2ZXJzZS10eXBlIiwKICAgICAgICAgICAgICAg\nICAgICBwcm9wTmFtZXNbcHJvcE5hbWVzLmxlbmd0aCAtIDFdKSk7CgogICAg\nICAgICAgICBpZiAodHlwZVNwZWMgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHR5cGUgPSBTdHJpbmdzLnRvQ2xhc3ModHlwZVNwZWMsIF9jb25mLgogICAg\nICAgICAgICAgICAgICAgIGdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLmdl\ndENsYXNzTG9hZGVyCiAgICAgICAgICAgICAgICAgICAgKFJldmVyc2VNYXBw\naW5nVG9vbC5jbGFzcywgbnVsbCkpOwogICAgICAgIH0KCiAgICAgICAgaWYg\nKHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAgdHlwZSA9IFNjaGVtYXMuZ2V0\nSmF2YVR5cGUoY29sLmdldFR5cGUoKSwgY29sLmdldFNpemUoKSwKICAgICAg\nICAgICAgICAgIGNvbC5nZXREZWNpbWFsRGlnaXRzKCkpOwogICAgICAgIGlm\nICh0eXBlID09IE9iamVjdC5jbGFzcykgewogICAgICAgICAgICBpZiAoIV9i\nbG9iQXNPYmopCiAgICAgICAgICAgICAgICByZXR1cm4gYnl0ZVtdLmNsYXNz\nOwogICAgICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICB9CgogICAgICAg\nIC8vIHRyZWF0IGNoYXJzIHNwZWNpYWxseTsgaWYgdGhlIGRpY3Rpb25hcnkg\naGFzIHN0b3JlQ2hhcnNBc051bWJlcnMKICAgICAgICAvLyBzZXQsIHRoZW4g\nd2UgY2FuJ3QgcmV2ZXJzZSBtYXAgaW50byBhIGNoYXI7IHVzZSBhIHN0cmlu\nZyBhbmQgdGVsbAogICAgICAgIC8vIHRoZSB1c2VyIHdoeSB3ZSBhcmUgZG9p\nbmcgc28KICAgICAgICBpZiAodHlwZSA9PSBjaGFyLmNsYXNzCiAgICAgICAg\nICAgICYmIF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkuc3RvcmVD\naGFyc0FzTnVtYmVycykgewogICAgICAgICAgICB0eXBlID0gU3RyaW5nLmNs\nYXNzOwogICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFibGVkKCkpCiAg\nICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImNhbnQtdXNlLWNo\nYXIiLCBjb2wuZ2V0RnVsbE5hbWUoKSkpOwogICAgICAgIH0KCiAgICAgICAg\naWYgKCF0eXBlLmlzUHJpbWl0aXZlKCkpCiAgICAgICAgICAgIHJldHVybiB0\neXBlOwogICAgICAgIGlmICghZm9yY2VPYmplY3QgJiYgKGNvbC5pc05vdE51\nbGwoKSB8fCAhX251bGxBc09iaikpCiAgICAgICAgICAgIHJldHVybiB0eXBl\nOwoKICAgICAgICAvLyBjb252ZXJ0IHRoZSB0eXBlIGludG8gdGhlIGFwcHJv\ncHJpYXRlIHdyYXBwZXIgY2xhc3MKICAgICAgICBzd2l0Y2ggKHR5cGUuZ2V0\nTmFtZSgpLmNoYXJBdCgwKSkgewogICAgICAgICAgICBjYXNlJ2InOgogICAg\nICAgICAgICAgICAgaWYgKHR5cGUgPT0gYm9vbGVhbi5jbGFzcykKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5jbGFzczsKICAgICAgICAg\nICAgICAgIHJldHVybiBCeXRlLmNsYXNzOwogICAgICAgICAgICBjYXNlJ2Mn\nOgogICAgICAgICAgICAgICAgcmV0dXJuIENoYXJhY3Rlci5jbGFzczsKICAg\nICAgICAgICAgY2FzZSdkJzoKICAgICAgICAgICAgICAgIHJldHVybiBEb3Vi\nbGUuY2xhc3M7CiAgICAgICAgICAgIGNhc2UnZic6CiAgICAgICAgICAgICAg\nICByZXR1cm4gRmxvYXQuY2xhc3M7CiAgICAgICAgICAgIGNhc2UnaSc6CiAg\nICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci5jbGFzczsKICAgICAgICAg\nICAgY2FzZSdsJzoKICAgICAgICAgICAgICAgIHJldHVybiBMb25nLmNsYXNz\nOwogICAgICAgICAgICBjYXNlJ3MnOgogICAgICAgICAgICAgICAgcmV0dXJu\nIFNob3J0LmNsYXNzOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbmV3IHRvb2wgd2l0\naCB0aGUgc2FtZSBzZXR0aW5ncyBhcyB0aGlzIG9uZS4gVXNlZCBpbiB3b3Jr\nYmVuY2guCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgY2xvbmUoKSB7CiAg\nICAgICAgUmV2ZXJzZU1hcHBpbmdUb29sIHRvb2wgPSBuZXcgUmV2ZXJzZU1h\ncHBpbmdUb29sKF9jb25mKTsKICAgICAgICB0b29sLnNldFNjaGVtYUdyb3Vw\nKGdldFNjaGVtYUdyb3VwKCkpOwogICAgICAgIHRvb2wuc2V0UGFja2FnZU5h\nbWUoZ2V0UGFja2FnZU5hbWUoKSk7CiAgICAgICAgdG9vbC5zZXREaXJlY3Rv\ncnkoZ2V0RGlyZWN0b3J5KCkpOwogICAgICAgIHRvb2wuc2V0VXNlU2NoZW1h\nTmFtZShnZXRVc2VTY2hlbWFOYW1lKCkpOwogICAgICAgIHRvb2wuc2V0VXNl\nRm9yZWlnbktleU5hbWUoZ2V0VXNlRm9yZWlnbktleU5hbWUoKSk7CiAgICAg\nICAgdG9vbC5zZXROdWxsYWJsZUFzT2JqZWN0KGdldE51bGxhYmxlQXNPYmpl\nY3QoKSk7CiAgICAgICAgdG9vbC5zZXRCbG9iQXNPYmplY3QoZ2V0QmxvYkFz\nT2JqZWN0KCkpOwogICAgICAgIHRvb2wuc2V0VXNlR2VuZXJpY0NvbGxlY3Rp\nb25zKGdldFVzZUdlbmVyaWNDb2xsZWN0aW9ucygpKTsKICAgICAgICB0b29s\nLnNldFByaW1hcnlLZXlPbkpvaW4oZ2V0UHJpbWFyeUtleU9uSm9pbigpKTsK\nICAgICAgICB0b29sLnNldFVzZURhdGFTdG9yZUlkZW50aXR5KGdldFVzZURh\ndGFTdG9yZUlkZW50aXR5KCkpOwogICAgICAgIHRvb2wuc2V0VXNlQnVpbHRp\nbklkZW50aXR5Q2xhc3MoZ2V0VXNlQnVpbHRpbklkZW50aXR5Q2xhc3MoKSk7\nCiAgICAgICAgdG9vbC5zZXRJbm5lcklkZW50aXR5Q2xhc3NlcyhnZXRJbm5l\ncklkZW50aXR5Q2xhc3NlcygpKTsKICAgICAgICB0b29sLnNldElkZW50aXR5\nQ2xhc3NTdWZmaXgoZ2V0SWRlbnRpdHlDbGFzc1N1ZmZpeCgpKTsKICAgICAg\nICB0b29sLnNldEludmVyc2VSZWxhdGlvbnMoZ2V0SW52ZXJzZVJlbGF0aW9u\ncygpKTsKICAgICAgICB0b29sLnNldERldGFjaGFibGUoZ2V0RGV0YWNoYWJs\nZSgpKTsKICAgICAgICB0b29sLnNldEdlbmVyYXRlQW5ub3RhdGlvbnMoZ2V0\nR2VuZXJhdGVBbm5vdGF0aW9ucygpKTsKICAgICAgICB0b29sLnNldEN1c3Rv\nbWl6ZXIoZ2V0Q3VzdG9taXplcigpKTsKICAgICAgICB0b29sLnNldENvZGVG\nb3JtYXQoZ2V0Q29kZUZvcm1hdCgpKTsKICAgICAgICByZXR1cm4gdG9vbDsK\nICAgIH0KCiAgICAvLy8vLy8vLwogICAgLy8gTWFpbgogICAgLy8vLy8vLy8K\nCiAgICAvKioKICAgICAqIFVzYWdlOiBqYXZhIG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuUmV2ZXJzZU1hcHBpbmdUb29sCiAgICAgKiBbb3B0aW9u\nXSogJmx0Oy5zY2hlbWEgZmlsZSBvciByZXNvdXJjZSZndDsqCiAgICAgKiAg\nV2hlcmUgdGhlIGZvbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgog\nICAgICogPHVsPgogICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtw\ncm9wZXJ0aWVzIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAg\nKiBwYXRoIG9yIHJlc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRp\nZXMgZmlsZSBjb250YWluaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBzdWNoIGFz\nIHRoZSBsaWNlbnNlIGtleQlkYXRhIGFzIG91dGxpbmVkIGluCiAgICAgKiB7\nQGxpbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgog\nICAgICogPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3Bl\ncnR5IHZhbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVz\nIG9mIHRoZSBPcGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2Fu\nIGJlIHNldCBieQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBs\neWluZyBhIHZhbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNl\nbnNlS2V5IGFkc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDxs\naT48aT4tc2NoZW1hcy8tcyAmbHQ7c2NoZW1hcyBhbmQgdGFibGVzJmd0Ozwv\naT46IENvbW1hLXNlcGFyYXRlZAogICAgICogbGlzdCBvZiBzY2hlbWFzIGFu\nZCB0YWJsZXMgdG8gcmV2ZXJzZS1tYXAuPC9saT4KICAgICAqIDxsaT48aT4t\ncGFja2FnZS8tcGtnICZsdDtwYWNrYWdlIG5hbWUmZ3Q7PC9pPjogVGhlIG5h\nbWUgb2YgdGhlIHBhY2thZ2UKICAgICAqIGZvciBhbGwgZ2VuZXJhdGVkIGNs\nYXNzZXMuIERlZmF1bHRzIHRvIG5vIHBhY2thZ2UuPC9saT4KICAgICAqIDxs\naT48aT4tZGlyZWN0b3J5Ly1kICZsdDtvdXRwdXQgZGlyZWN0b3J5Jmd0Ozwv\naT46IFRoZSBkaXJlY3Rvcnkgd2hlcmUKICAgICAqIGFsbCBnZW5lcmF0ZWQg\nY29kZSBzaG91bGQgYmUgcGxhY2VkLiBEZWZhdWx0cyB0byB0aGUgY3VycmVu\ndAogICAgICogZGlyZWN0b3J5LjwvbGk+CiAgICAgKiA8bGk+PGk+LXVzZVNj\naGVtYU5hbWUvLXNuICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNl\ndCB0aGlzIGZsYWcgdG8KICAgICAqIHRydWUgdG8gaW5jbHVkZSB0aGUgc2No\nZW1hIG5hbWUgYXMgcGFydCBvZiB0aGUgZ2VuZXJhdGVkIGNsYXNzIG5hbWUK\nICAgICAqIGZvciBlYWNoIHRhYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+LXVz\nZUZvcmVpZ25LZXlOYW1lLy1ma24gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7\nPC9pPjogU2V0IHRoaXMKICAgICAqIGZsYWcgdG8gdHJ1ZSB0byB1c2UgdGhl\nIGZvcmVpZ24ga2V5IG5hbWUgdG8gZ2VuZXJhdGUgZmllbGRzCiAgICAgKiBy\nZXByZXNlbnRpbmcgcmVsYXRpb25zIGJldHdlZW4gY2xhc3Nlcy48L2xpPgog\nICAgICogPGxpPjxpPi1udWxsYWJsZUFzT2JqZWN0Ly1ubyAmbHQ7dHJ1ZS90\nIHwgZmFsc2UvZiZndDs8L2k+OiBTZXQgdG8gdHJ1ZQogICAgICogdG8gbWFr\nZSBhbGwgbnVsbGFibGUgY29sdW1ucyBtYXAgdG8gb2JqZWN0IHR5cGVzOyBj\nb2x1bW5zIHRoYXQgd291bGQKICAgICAqIG5vcm1hbGx5IG1hcCB0byBhIHBy\naW1pdGl2ZSB3aWxsIG1hcCB0byB0aGUgYXBwcm9wcmlhdGUgd3JhcHBlcgog\nICAgICogdHlwZSBpbnN0ZWFkLjwvbGk+CiAgICAgKiA8bGk+PGk+LWJsb2JB\nc09iamVjdC8tYm8gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0\nIHRvIHRydWUKICAgICAqIHRvIG1ha2UgYWxsIGJpbmFyeSBjb2x1bW5zIG1h\ncCB0byBPYmplY3QgcmF0aGVyIHRoYW4gYnl0ZVtdLjwvbGk+CiAgICAgKiA8\nbGk+PGk+LXVzZUdlbmVyaWNDb2xsZWN0aW9ucy8tZ2MgJmx0O3RydWUvdCB8\nIGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvCiAgICAgKiB0cnVlIHRvIHVzZSBn\nZW5lcmljIGNvbGxlY3Rpb25zIG9uIE9uZVRvTWFueSBhbmQgTWFueVRvTWFu\neSByZWxhdGlvbnMKICAgICAqIChyZXF1aXJlcyBKREsgMS41IG9yIGhpZ2hl\ncikuPC9saT4KICAgICAqIDxsaT48aT4tdHlwZU1hcC8tdHlwICZsdDt0eXBl\ncyZndDs8L2k+OiBEZWZhdWx0IG1hcHBpbmcgb2YgU1FMIHR5cGUKICAgICAq\nIG5hbWVzIHRvIEphdmEgY2xhc3Nlcy48L2xpPgogICAgICogPGxpPjxpPi1w\ncmltYXJ5S2V5T25Kb2luLy1wa2ogJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7\nPC9pPjogU2V0IHRvIHRydWUKICAgICAqIHRvIGFsbG93IHByaW1hcnkga2V5\ncyBvbiBqb2luIHRhYmxlcy48L2xpPgogICAgICogPGxpPjxpPi11c2VEYXRh\nc3RvcmVJZGVudGl0eS8tZHMgJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9p\nPjogU2V0IHRvCiAgICAgKiB0cnVlIHRvIHVzZSBkYXRhc3RvcmUgaWRlbnRp\ndHkgd2hlcmUgcG9zc2libGUuPC9saT4KICAgICAqIDxsaT48aT4tdXNlQnVp\nbHRpbklkZW50aXR5Q2xhc3MvLWJpYyAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZn\ndDs8L2k+OiBTZXQKICAgICAqIHRvIGZhbHNlIHRvIG5ldmVyIHVzZSBPcGVu\nSlBBJ3MgYnVpbHRpbiBhcHBsaWNhdGlvbiBpZGVudGl0eQogICAgICogY2xh\nc3Nlcy48L2xpPgogICAgICogPGxpPjxpPi1pbm5lcklkZW50aXR5Q2xhc3Nl\ncy8taW5uICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0bwog\nICAgICogdHJ1ZSB0byBnZW5lcmF0ZSB0aGUgYXBwbGljYXRpb24gaWRlbnRp\ndHkgY2xhc3NlcyBhcyBpbm5lciBjbGFzc2VzLjwvbGk+CiAgICAgKiA8bGk+\nPGk+LWlkZW50aXR5Q2xhc3NTdWZmaXgvLWlzICZsdDtzdWZmaXgmZ3Q7PC9p\nPjogU3VmZml4IHRvIGFwcGVuZAogICAgICogdG8gY2xhc3MgbmFtZXMgdG8g\nY3JlYXRlIGlkZW50aXR5IGNsYXNzIG5hbWUsIG9yIGZvciBpbm5lciBpZGVu\ndGl0eQogICAgICogY2xhc3NlcywgdGhlIGlubmVyIGNsYXNzIG5hbWUuPC9s\naT4KICAgICAqIDxsaT48aT4taW52ZXJzZVJlbGF0aW9ucy8taXIgJmx0O3Ry\ndWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvCiAgICAgKiBmYWxzZSB0\nbyBwcmV2ZW50IHRoZSBjcmVhdGlvbiBvZiBpbnZlcnNlIDEtbWFueS8xLTEg\ncmVsYXRpb25zIGZvcgogICAgICogZWFjaCBlbmNvdW50ZXJlZCBtYW55LTEv\nMS0xIHJlbGF0aW9uLjwvbGk+CiAgICAgKiA8bGk+PGk+LWRldGFjaGFibGUv\nLWRldCAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBTZXQgdG8KICAg\nICAqIHRydWUgdG8gbWFrZSBnZW5lcmF0ZWQgY2xhc3NlcyBkZXRhY2hhYmxl\nLjwvbGk+CiAgICAgKiA8bGk+PGk+LWRpc2NyaW1pbmF0b3JTdHJhdGVneS8t\nZHMgJmx0O3N0cmF0ZWd5Jmd0OzwvaT46IFRoZSBkZWZhdWx0CiAgICAgKiBk\naXNjcmltaW5hdG9yIHN0cmF0ZWd5IHRvIHBsYWNlIG9uIGJhc2UgY2xhc3Nl\ncy48L2xpPgogICAgICogPGxpPjxpPi12ZXJzaW9uU3RyYXRlZ3kvLXZzICZs\ndDtzdHJhdGVneSZndDs8L2k+OiBUaGUgZGVmYXVsdAogICAgICogdmVyc2lv\nbiBzdHJhdGVneSB0byBwbGFjZSBvbiBiYXNlIGNsYXNzZXMuPC9saT4KICAg\nICAqIDxsaT48aT4tbWV0YWRhdGEvLW1kICZsdDtjbGFzcyB8IHBhY2thZ2Ug\nfCBub25lJmd0OzwvaT46IFNwZWNpZnkgdGhlCiAgICAgKiBsZXZlbCB0aGUg\nbWV0YWRhdGEgc2hvdWxkIGJlIGdlbmVyYXRlZCBhdC4gRGVmYXVsdHMgdG8g\nZ2VuZXJhdGluZyBhCiAgICAgKiBzaW5nbGUgcGFja2FnZS1sZXZlbCBtZXRh\nZGF0YSBmaWxlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWFubm90YXRpb25zLy1h\nbm4gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvIHRydWUg\ndG8KICAgICAqIGdlbmVyYXRlIEpQQSBhbm5vdGF0aW9ucyBpbiBnZW5lcmF0\nZWQgY29kZS48L2xpPgogICAgICogPGxpPjxpPi1hY2Nlc3NUeXBlLy1hY2Nl\nc3MgJmx0O2ZpZWxkIHwgcHJvcGVydHkmZ3Q7PC9pPjogQ2hhbmdlIGFjY2Vz\ncwogICAgICogdHlwZSBmb3IgZ2VuZXJhdGVkIGFubm90YXRpb25zLiBEZWZh\ndWx0cyB0byBmaWVsZCBhY2Nlc3MuPC9saT4KICAgICAqIDxsaT48aT4tY3Vz\ndG9taXplckNsYXNzLy1jYyAmbHQ7Y2xhc3MgbmFtZSZndDs8L2k+OiBUaGUg\nZnVsbCBjbGFzcwogICAgICogbmFtZSBvZiBhIHtAbGluayBSZXZlcnNlQ3Vz\ndG9taXplcn0gaW1wbGVtZW50YXRpb24gdG8gdXNlIHRvCiAgICAgKiBjdXN0\nb21pemUgdGhlIHJldmVyc2UgbWFwcGluZyBwcm9jZXNzLiBPcHRpb25hbC48\nL2xpPgogICAgICogPGxpPjxpPi1jdXN0b21pemVyUHJvcGVydGllcy8tY3Ag\nJmx0O3Byb3BlcnRpZXMgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+CiAgICAg\nKiA6IFRoZSBwYXRoIG9yIHJlc291cmNlIG5hbWUgb2YgYSBwcm9wZXJ0aWVz\nIGZpbGUgdGhhdCB3aWxsIGJlCiAgICAgKiBwYXNzZWQgdG8gdGhlIHJldmVy\nc2UgY3VzdG9taXplciBvbiBpbml0aWFsaXphdGlvbi4gT3B0aW9uYWwuPC9s\naT4KICAgICAqIDxsaT48aT4tY3VzdG9taXplci8tYy4mbHQ7cHJvcGVydHkg\nbmFtZSZndDsgJmx0OyBwcm9wZXJ0eSB2YWx1ZSZndDs8L2k+CiAgICAgKiA6\nIEFyZ3VtZW50cyBsaWtlIHRoaXMgd2lsbCBiZSB1c2VkIHRvIGNvbmZpZ3Vy\nZSB0aGUgYmVhbgogICAgICogcHJvcGVydGllcyBvZiB0aGUge0BsaW5rIFJl\ndmVyc2VDdXN0b21pemVyfS48L2xpPgogICAgICogPGxpPjxpPi1jb2RlRm9y\nbWF0Ly1jZi4mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0OyBwcm9wZXJ0eSB2\nYWx1ZSZndDs8L2k+CiAgICAgKiA6IEFyZ3VtZW50cyBsaWtlIHRoaXMgd2ls\nbCBiZSB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUgYmVhbgogICAgICogcHJvcGVy\ndGllcyBvZiB0aGUgaW50ZXJuYWwge0BsaW5rIENvZGVGb3JtYXR9LjwvbGk+\nCiAgICAgKiA8L3VsPgogICAgICogIEVhY2ggc2NoZW1hIGdpdmVuIGFzIGFu\nIGFyZ3VtZW50IHdpbGwgYmUgcmV2ZXJzZS1tYXBwZWQgaW50bwogICAgICog\ncGVyc2lzdGVudCBjbGFzc2VzIGFuZCBhc3NvY2lhdGVkIG1ldGFkYXRhLiBJ\nZiBubyBhcmd1bWVudHMgYXJlIGdpdmVuLAogICAgICogdGhlIGRhdGFiYXNl\nIHNjaGVtYXMgZGVmaW5lZCBieSB0aGUgc3lzdGVtIGNvbmZpZ3VyYXRpb24g\nd2lsbCBiZQogICAgICogcmV2ZXJzZS1tYXBwZWQuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpCiAgICAgICAg\ndGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewogICAgICAgIE9w\ndGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmluYWwgU3Ry\naW5nW10gYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShhcmdzKTsK\nICAgICAgICBib29sZWFuIHJldCA9IENvbmZpZ3VyYXRpb25zLnJ1bkFnYWlu\nc3RBbGxBbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25maWd1cmF0\naW9ucy5SdW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4g\ncnVuKE9wdGlvbnMgb3B0cykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IEpEQkNDb25m\naWd1cmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gUmV2ZXJzZU1hcHBpbmdUb29sLnJ1bihj\nb25mLCBhcmd1bWVudHMsIG9wdHMpOwogICAgICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgICAgICBjb25mLmNsb3NlKCk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAg\nICBpZiAoIXJldCkKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKF9s\nb2MuZ2V0KCJyZXZ0b29sLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAg\nICogUnVuIHRoZSB0b29sLiBSZXR1cm5zIGZhbHNlIGlmIGludmFsaWQgb3B0\naW9ucyB3ZXJlIGdpdmVuLgogICAgICoKICAgICAqIEBzZWUgI21haW4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihKREJDQ29uZmln\ndXJhdGlvbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIE9wdGlvbnMg\nb3B0cykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgLy8gZmxhZ3MKICAgICAgICBGbGFncyBmbGFncyA9IG5l\ndyBGbGFncygpOwogICAgICAgIGZsYWdzLnBhY2thZ2VOYW1lID0gb3B0cy5y\nZW1vdmVQcm9wZXJ0eQogICAgICAgICAgICAoInBhY2thZ2UiLCAicGtnIiwg\nZmxhZ3MucGFja2FnZU5hbWUpOwogICAgICAgIGZsYWdzLmRpcmVjdG9yeSA9\nIEZpbGVzLmdldEZpbGUKICAgICAgICAgICAgKG9wdHMucmVtb3ZlUHJvcGVy\ndHkoImRpcmVjdG9yeSIsICJkIiwgbnVsbCksIG51bGwpOwogICAgICAgIGZs\nYWdzLnVzZVNjaGVtYU5hbWUgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0\neQogICAgICAgICAgICAoInVzZVNjaGVtYU5hbWUiLCAic24iLCBmbGFncy51\nc2VTY2hlbWFOYW1lKTsKICAgICAgICBmbGFncy51c2VGb3JlaWduS2V5TmFt\nZSA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgi\ndXNlRm9yZWlnbktleU5hbWUiLCAiZmtuIiwgZmxhZ3MudXNlRm9yZWlnbktl\neU5hbWUpOwogICAgICAgIGZsYWdzLm51bGxhYmxlQXNPYmplY3QgPSBvcHRz\nLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoIm51bGxhYmxl\nQXNPYmplY3QiLCAibm8iLCBmbGFncy5udWxsYWJsZUFzT2JqZWN0KTsKICAg\nICAgICBmbGFncy5ibG9iQXNPYmplY3QgPSBvcHRzLnJlbW92ZUJvb2xlYW5Q\ncm9wZXJ0eQogICAgICAgICAgICAoImJsb2JBc09iamVjdCIsICJibyIsIGZs\nYWdzLmJsb2JBc09iamVjdCk7CiAgICAgICAgZmxhZ3MudXNlR2VuZXJpY0Nv\nbGxlY3Rpb25zID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAg\nICAgICAgKCJ1c2VHZW5lcmljQ29sbGVjdGlvbnMiLCAiZ2MiLCBmbGFncy51\nc2VHZW5lcmljQ29sbGVjdGlvbnMpOwogICAgICAgIGZsYWdzLnByaW1hcnlL\nZXlPbkpvaW4gPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAg\nICAgICAoInByaW1hcnlLZXlPbkpvaW4iLCAicGtqIiwgZmxhZ3MucHJpbWFy\neUtleU9uSm9pbik7CiAgICAgICAgZmxhZ3MudXNlRGF0YVN0b3JlSWRlbnRp\ndHkgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAo\nInVzZURhdGFzdG9yZUlkZW50aXR5IiwgImRzIiwgZmxhZ3MudXNlRGF0YVN0\nb3JlSWRlbnRpdHkpOwogICAgICAgIGZsYWdzLnVzZUJ1aWx0aW5JZGVudGl0\neUNsYXNzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAgICAg\nICAgKCJ1c2VCdWlsdGluSWRlbnRpdHlDbGFzcyIsICJiaWMiLCBmbGFncy51\nc2VCdWlsdGluSWRlbnRpdHlDbGFzcyk7CiAgICAgICAgZmxhZ3MuaW5uZXJJ\nZGVudGl0eUNsYXNzZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQog\nICAgICAgICAgICAoImlubmVySWRlbnRpdHlDbGFzc2VzIiwgImlubiIsIGZs\nYWdzLmlubmVySWRlbnRpdHlDbGFzc2VzKTsKICAgICAgICBmbGFncy5pZGVu\ndGl0eUNsYXNzU3VmZml4ID0gb3B0cy5yZW1vdmVQcm9wZXJ0eQogICAgICAg\nICAgICAoImlkZW50aXR5Q2xhc3NTdWZmaXgiLCAiaXMiLCBmbGFncy5pZGVu\ndGl0eUNsYXNzU3VmZml4KTsKICAgICAgICBmbGFncy5pbnZlcnNlUmVsYXRp\nb25zID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAgICAgICAg\nKCJpbnZlcnNlUmVsYXRpb25zIiwgImlyIiwgZmxhZ3MuaW52ZXJzZVJlbGF0\naW9ucyk7CiAgICAgICAgZmxhZ3MuZGV0YWNoYWJsZSA9IG9wdHMucmVtb3Zl\nQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiZGV0YWNoYWJsZSIsICJk\nZXQiLCBmbGFncy5kZXRhY2hhYmxlKTsKICAgICAgICBmbGFncy5kaXNjcmlt\naW5hdG9yU3RyYXRlZ3kgPSBvcHRzLnJlbW92ZVByb3BlcnR5CiAgICAgICAg\nICAgICgiZGlzY3JpbWluYXRvclN0cmF0ZWd5IiwgImRzIiwgZmxhZ3MuZGlz\nY3JpbWluYXRvclN0cmF0ZWd5KTsKICAgICAgICBmbGFncy52ZXJzaW9uU3Ry\nYXRlZ3kgPSBvcHRzLnJlbW92ZVByb3BlcnR5CiAgICAgICAgICAgICgidmVy\nc2lvblN0cmF0ZWd5IiwgInZzIiwgZmxhZ3MudmVyc2lvblN0cmF0ZWd5KTsK\nICAgICAgICBmbGFncy5tZXRhRGF0YUxldmVsID0gb3B0cy5yZW1vdmVQcm9w\nZXJ0eQogICAgICAgICAgICAoIm1ldGFkYXRhIiwgIm1kIiwgZmxhZ3MubWV0\nYURhdGFMZXZlbCk7ICAgICAgICAKICAgICAgICBmbGFncy5nZW5lcmF0ZUFu\nbm90YXRpb25zID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAg\nICAgICAgKCJhbm5vdGF0aW9ucyIsICJhbm4iLCBmbGFncy5nZW5lcmF0ZUFu\nbm90YXRpb25zKTsKICAgICAgICBmbGFncy5hY2Nlc3NUeXBlID0gb3B0cy5y\nZW1vdmVQcm9wZXJ0eQogICAgICAgICAgICAoImFjY2Vzc1R5cGUiLCAiYWNj\nZXNzIiwgZmxhZ3MuYWNjZXNzVHlwZSk7CgogICAgICAgIFN0cmluZyB0eXBl\nTWFwID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgidHlwZU1hcCIsICJ0eXAiLCBu\ndWxsKTsKICAgICAgICBpZiAodHlwZU1hcCAhPSBudWxsKQogICAgICAgICAg\nICBmbGFncy50eXBlTWFwID0gQ29uZmlndXJhdGlvbnMucGFyc2VQcm9wZXJ0\naWVzKHR5cGVNYXApOwoKICAgICAgICAvLyByZW1hcCB0aGUgLXMgc2hvcnRj\ndXQgdG8gdGhlICJzY2hlbWFzIiBwcm9wZXJ0eSBuYW1lIHNvIHRoYXQgaXQK\nICAgICAgICAvLyBnZXRzIHNldCBpbnRvIHRoZSBjb25maWd1cmF0aW9uCiAg\nICAgICAgaWYgKG9wdHMuY29udGFpbnNLZXkoInMiKSkKICAgICAgICAgICAg\nb3B0cy5wdXQoInNjaGVtYXMiLCBvcHRzLmdldCgicyIpKTsKCiAgICAgICAg\nLy8gY3VzdG9taXplcgogICAgICAgIFN0cmluZyBjdXN0b21DbHMgPSBvcHRz\nLnJlbW92ZVByb3BlcnR5KCJjdXN0b21pemVyQ2xhc3MiLCAiY2MiLAogICAg\nICAgICAgICBQcm9wZXJ0aWVzUmV2ZXJzZUN1c3RvbWl6ZXIuY2xhc3MuZ2V0\nTmFtZSgpKTsKICAgICAgICBGaWxlIGN1c3RvbUZpbGUgPSBGaWxlcy5nZXRG\naWxlCiAgICAgICAgICAgIChvcHRzLnJlbW92ZVByb3BlcnR5KCJjdXN0b21p\nemVyUHJvcGVydGllcyIsICJjcCIsIG51bGwpLCBudWxsKTsKICAgICAgICBQ\ncm9wZXJ0aWVzIGN1c3RvbVByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAg\nICAgICBpZiAoY3VzdG9tRmlsZSAhPSBudWxsICYmIChBY2Nlc3NDb250cm9s\nbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIu\nZXhpc3RzQWN0aW9uKGN1c3RvbUZpbGUpKSkuYm9vbGVhblZhbHVlKCkpIHsK\nICAgICAgICAgICAgRmlsZUlucHV0U3RyZWFtIGZpcyA9IG51bGw7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBmaXMgPSBBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICBKMkRv\nUHJpdkhlbHBlci5uZXdGaWxlSW5wdXRTdHJlYW1BY3Rpb24oY3VzdG9tRmls\nZSkpOwogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxlZ2VkQWN0aW9uRXhj\nZXB0aW9uIHBhZSkgewogICAgICAgICAgICAgICAgIHRocm93IChGaWxlTm90\nRm91bmRFeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBjdXN0b21Qcm9wcy5sb2FkKGZpcyk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIC8vIHNlcGFyYXRlIHRoZSBwcm9wZXJ0\naWVzIGZvciB0aGUgY3VzdG9taXplciBhbmQgY29kZSBmb3JtYXQKICAgICAg\nICBPcHRpb25zIGN1c3RvbU9wdHMgPSBuZXcgT3B0aW9ucygpOwogICAgICAg\nIE9wdGlvbnMgZm9ybWF0T3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAg\nTWFwLkVudHJ5IGVudHJ5OwogICAgICAgIFN0cmluZyBrZXk7CiAgICAgICAg\nZm9yIChJdGVyYXRvciBpdHIgPSBvcHRzLmVudHJ5U2V0KCkuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFw\nLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBrZXkgPSAoU3RyaW5n\nKSBlbnRyeS5nZXRLZXkoKTsKICAgICAgICAgICAgaWYgKGtleS5zdGFydHNX\naXRoKCJjdXN0b21pemVyLiIpKSB7CiAgICAgICAgICAgICAgICBjdXN0b21P\ncHRzLnB1dChrZXkuc3Vic3RyaW5nKDExKSwgZW50cnkuZ2V0VmFsdWUoKSk7\nCiAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAoa2V5LnN0YXJ0c1dpdGgoImMuIikpIHsKICAgICAgICAgICAg\nICAgIGN1c3RvbU9wdHMucHV0KGtleS5zdWJzdHJpbmcoMiksIGVudHJ5Lmdl\ndFZhbHVlKCkpOwogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKGtleS5zdGFydHNXaXRoKCJjb2RlRm9ybWF0\nLiIpKSB7CiAgICAgICAgICAgICAgICBmb3JtYXRPcHRzLnB1dChrZXkuc3Vi\nc3RyaW5nKDExKSwgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAg\nICBpdHIucmVtb3ZlKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5LnN0\nYXJ0c1dpdGgoImNmLiIpKSB7CiAgICAgICAgICAgICAgICBmb3JtYXRPcHRz\nLnB1dChrZXkuc3Vic3RyaW5nKDMpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAg\nICAgICAgICAgICAgIGl0ci5yZW1vdmUoKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgLy8gY29kZSBmb3JtYXQKICAgICAgICBpZiAoIWZv\ncm1hdE9wdHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGZsYWdzLmZvcm1h\ndCA9IG5ldyBDb2RlRm9ybWF0KCk7CiAgICAgICAgICAgIGZvcm1hdE9wdHMu\nc2V0SW50byhmbGFncy5mb3JtYXQpOwogICAgICAgIH0KCiAgICAgICAgLy8g\nc2V0dXAgYSBjb25maWd1cmF0aW9uIGluc3RhbmNlIHdpdGggY21kLWxpbmUg\naW5mbwogICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJh\ndGlvbihjb25mLCBvcHRzKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIg\nPSBjb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAgICAg\nICBnZXRDbGFzc0xvYWRlcihSZXZlcnNlTWFwcGluZ1Rvb2wuY2xhc3MsIG51\nbGwpOwoKICAgICAgICAvLyBjdXN0b21pemVyCiAgICAgICAgZmxhZ3MuY3Vz\ndG9taXplciA9IChSZXZlcnNlQ3VzdG9taXplcikgQ29uZmlndXJhdGlvbnMu\nCiAgICAgICAgICAgIG5ld0luc3RhbmNlKGN1c3RvbUNscywgbG9hZGVyKTsK\nICAgICAgICBpZiAoZmxhZ3MuY3VzdG9taXplciAhPSBudWxsKSB7CiAgICAg\nICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKGZsYWdz\nLmN1c3RvbWl6ZXIsIGNvbmYsCiAgICAgICAgICAgICAgICBjdXN0b21PcHRz\nKTsKICAgICAgICAgICAgZmxhZ3MuY3VzdG9taXplci5zZXRDb25maWd1cmF0\naW9uKGN1c3RvbVByb3BzKTsKICAgICAgICB9CgogICAgICAgIHJ1bihjb25m\nLCBhcmdzLCBmbGFncywgbG9hZGVyKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyB2b2lkIHJ1bihKREJDQ29uZmlndXJhdGlvbiBj\nb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIEZsYWdzIGZsYWdzLCBDbGFz\nc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBT\nUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBhcnNlIHRoZSBzY2hlbWEgdG8g\ncmV2ZXJzZS1tYXAKICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2coT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1RPT0wpOwogICAgICAgIFNjaGVtYUdy\nb3VwIHNjaGVtYTsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgewog\nICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1ydW5uaW5n\nIikpOwogICAgICAgICAgICBTY2hlbWFHZW5lcmF0b3IgZ2VuID0gbmV3IFNj\naGVtYUdlbmVyYXRvcihjb25mKTsKICAgICAgICAgICAgZ2VuLmdlbmVyYXRl\nU2NoZW1hcygpOwogICAgICAgICAgICBzY2hlbWEgPSBnZW4uZ2V0U2NoZW1h\nR3JvdXAoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTY2hlbWFQ\nYXJzZXIgcGFyc2VyID0gbmV3IFhNTFNjaGVtYVBhcnNlcihjb25mKTsKICAg\nICAgICAgICAgRmlsZSBmaWxlOwogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGZp\nbGUgPSBGaWxlcy5nZXRGaWxlKGFyZ3NbaV0sIGxvYWRlcik7CiAgICAgICAg\nICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1ydW5uaW5nLWZp\nbGUiLCBmaWxlKSk7CiAgICAgICAgICAgICAgICBwYXJzZXIucGFyc2UoZmls\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2NoZW1hID0gcGFyc2Vy\nLmdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBmbGFn\ncwogICAgICAgIFJldmVyc2VNYXBwaW5nVG9vbCB0b29sID0gbmV3IFJldmVy\nc2VNYXBwaW5nVG9vbChjb25mKTsKICAgICAgICB0b29sLnNldFNjaGVtYUdy\nb3VwKHNjaGVtYSk7CiAgICAgICAgdG9vbC5zZXRQYWNrYWdlTmFtZShmbGFn\ncy5wYWNrYWdlTmFtZSk7CiAgICAgICAgdG9vbC5zZXREaXJlY3RvcnkoZmxh\nZ3MuZGlyZWN0b3J5KTsKICAgICAgICB0b29sLnNldFVzZVNjaGVtYU5hbWUo\nZmxhZ3MudXNlU2NoZW1hTmFtZSk7CiAgICAgICAgdG9vbC5zZXRVc2VGb3Jl\naWduS2V5TmFtZShmbGFncy51c2VGb3JlaWduS2V5TmFtZSk7CiAgICAgICAg\ndG9vbC5zZXROdWxsYWJsZUFzT2JqZWN0KGZsYWdzLm51bGxhYmxlQXNPYmpl\nY3QpOwogICAgICAgIHRvb2wuc2V0QmxvYkFzT2JqZWN0KGZsYWdzLmJsb2JB\nc09iamVjdCk7CiAgICAgICAgdG9vbC5zZXRVc2VHZW5lcmljQ29sbGVjdGlv\nbnMoZmxhZ3MudXNlR2VuZXJpY0NvbGxlY3Rpb25zKTsKICAgICAgICB0b29s\nLnNldFR5cGVNYXAoZmxhZ3MudHlwZU1hcCk7CiAgICAgICAgdG9vbC5zZXRQ\ncmltYXJ5S2V5T25Kb2luKGZsYWdzLnByaW1hcnlLZXlPbkpvaW4pOwogICAg\nICAgIHRvb2wuc2V0VXNlRGF0YVN0b3JlSWRlbnRpdHkoZmxhZ3MudXNlRGF0\nYVN0b3JlSWRlbnRpdHkpOwogICAgICAgIHRvb2wuc2V0VXNlQnVpbHRpbklk\nZW50aXR5Q2xhc3MoZmxhZ3MudXNlQnVpbHRpbklkZW50aXR5Q2xhc3MpOwog\nICAgICAgIHRvb2wuc2V0SW5uZXJJZGVudGl0eUNsYXNzZXMoZmxhZ3MuaW5u\nZXJJZGVudGl0eUNsYXNzZXMpOwogICAgICAgIHRvb2wuc2V0SWRlbnRpdHlD\nbGFzc1N1ZmZpeChmbGFncy5pZGVudGl0eUNsYXNzU3VmZml4KTsKICAgICAg\nICB0b29sLnNldEludmVyc2VSZWxhdGlvbnMoZmxhZ3MuaW52ZXJzZVJlbGF0\naW9ucyk7CiAgICAgICAgdG9vbC5zZXREZXRhY2hhYmxlKGZsYWdzLmRldGFj\naGFibGUpOwogICAgICAgIHRvb2wuc2V0R2VuZXJhdGVBbm5vdGF0aW9ucyhm\nbGFncy5nZW5lcmF0ZUFubm90YXRpb25zKTsKICAgICAgICB0b29sLnNldEFj\nY2Vzc1R5cGUoZmxhZ3MuYWNjZXNzVHlwZSk7CiAgICAgICAgdG9vbC5zZXRD\ndXN0b21pemVyKGZsYWdzLmN1c3RvbWl6ZXIpOwogICAgICAgIHRvb2wuc2V0\nQ29kZUZvcm1hdChmbGFncy5mb3JtYXQpOwoKICAgICAgICAvLyBydW4KICAg\nICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1tYXAiKSk7CiAgICAg\nICAgdG9vbC5ydW4oKTsKICAgICAgICBpZiAoZmxhZ3MuZ2VuZXJhdGVBbm5v\ndGF0aW9ucykgewogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2\ndG9vbC1nZW4tYW5ub3MiKSk7CiAgICAgICAgICAgIHRvb2wuYnVpbGRBbm5v\ndGF0aW9ucygpOwogICAgICAgIH0KICAgICAgICBsb2cuaW5mbyhfbG9jLmdl\ndCgicmV2dG9vbC13cml0ZS1jb2RlIikpOwogICAgICAgIHRvb2wucmVjb3Jk\nQ29kZSgpOwogICAgICAgIGlmICghTEVWRUxfTk9ORS5lcXVhbHMoZmxhZ3Mu\nbWV0YURhdGFMZXZlbCkpIHsKICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5n\nZXQoInJldnRvb2wtd3JpdGUtbWV0YWRhdGEiKSk7CiAgICAgICAgICAgIHRv\nb2wucmVjb3JkTWV0YURhdGEoTEVWRUxfQ0xBU1MuZXF1YWxzKGZsYWdzLm1l\ndGFEYXRhTGV2ZWwpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBIb2xkZXIgZm9yIHJ1biBmbGFncy4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBjbGFzcyBGbGFncyB7CgogICAgICAgIHB1YmxpYyBTdHJpbmcgcGFj\na2FnZU5hbWUgPSBudWxsOwogICAgICAgIHB1YmxpYyBGaWxlIGRpcmVjdG9y\neSA9IG51bGw7CiAgICAgICAgcHVibGljIGJvb2xlYW4gdXNlU2NoZW1hTmFt\nZSA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIHVzZUZvcmVpZ25L\nZXlOYW1lID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gbnVsbGFi\nbGVBc09iamVjdCA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIGJs\nb2JBc09iamVjdCA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIHVz\nZUdlbmVyaWNDb2xsZWN0aW9ucyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBQ\ncm9wZXJ0aWVzIHR5cGVNYXAgPSBudWxsOwogICAgICAgIHB1YmxpYyBib29s\nZWFuIHByaW1hcnlLZXlPbkpvaW4gPSBmYWxzZTsKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiB1c2VEYXRhU3RvcmVJZGVudGl0eSA9IGZhbHNlOwogICAgICAg\nIHB1YmxpYyBib29sZWFuIHVzZUJ1aWx0aW5JZGVudGl0eUNsYXNzID0gdHJ1\nZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpbm5lcklkZW50aXR5Q2xhc3Nl\ncyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBTdHJpbmcgaWRlbnRpdHlDbGFz\nc1N1ZmZpeCA9ICJJZCI7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW52ZXJz\nZVJlbGF0aW9ucyA9IHRydWU7CiAgICAgICAgcHVibGljIGJvb2xlYW4gZGV0\nYWNoYWJsZSA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIGdlbmVy\nYXRlQW5ub3RhdGlvbnMgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgU3RyaW5n\nIGFjY2Vzc1R5cGUgPSBBQ0NFU1NfVFlQRV9GSUVMRDsKICAgICAgICBwdWJs\naWMgU3RyaW5nIG1ldGFEYXRhTGV2ZWwgPSBMRVZFTF9QQUNLQUdFOwogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZGlzY3JpbWluYXRvclN0cmF0ZWd5ID0gbnVs\nbDsKICAgICAgICBwdWJsaWMgU3RyaW5nIHZlcnNpb25TdHJhdGVneSA9IG51\nbGw7CiAgICAgICAgcHVibGljIFJldmVyc2VDdXN0b21pemVyIGN1c3RvbWl6\nZXIgPSBudWxsOwogICAgICAgIHB1YmxpYyBDb2RlRm9ybWF0IGZvcm1hdCA9\nIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2VkIHRvIGluc3RhbGwg\nZGlzY3JpbWluYXRvciBhbmQgdmVyc2lvbiBzdHJhdGVnaWVzIG9uCiAgICAg\nKiByZXZlcnNlLW1hcHBlZCBjbGFzc2VzLgogICAgICovCiAgICBwcml2YXRl\nIGNsYXNzIFJldmVyc2VTdHJhdGVneUluc3RhbGxlcgogICAgICAgIGV4dGVu\nZHMgU3RyYXRlZ3lJbnN0YWxsZXIgewoKICAgICAgICBwdWJsaWMgUmV2ZXJz\nZVN0cmF0ZWd5SW5zdGFsbGVyKE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zKSB7\nCiAgICAgICAgICAgIHN1cGVyKHJlcG9zKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShDbGFzc01hcHBpbmcgY2xz\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgaW5zdGFsbFN0cmF0\nZWd5KEZpZWxkTWFwcGluZyBmaWVsZCkgewogICAgICAgICAgICB0aHJvdyBu\nZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShWZXJzaW9uIHZlcnNpb24pIHsK\nICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IHZlcnNpb24uZ2V0Q2xh\nc3NNYXBwaW5nKCk7CiAgICAgICAgICAgIGlmIChjbHMuZ2V0UENTdXBlcmNs\nYXNzKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHZlcnNpb24uc2V0U3Ry\nYXRlZ3kobmV3IFN1cGVyY2xhc3NWZXJzaW9uU3RyYXRlZ3koKSwgbnVsbCk7\nCiAgICAgICAgICAgIGVsc2UgaWYgKF92ZXJzU3RyYXQgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgVmVyc2lvblN0cmF0ZWd5IHN0cmF0ID0gcmVwb3Mu\naW5zdGFudGlhdGVWZXJzaW9uU3RyYXRlZ3kKICAgICAgICAgICAgICAgICAg\nICAoX3ZlcnNTdHJhdCwgdmVyc2lvbik7CiAgICAgICAgICAgICAgICB2ZXJz\naW9uLnNldFN0cmF0ZWd5KHN0cmF0LCBudWxsKTsKICAgICAgICAgICAgfSBl\nbHNlCiAgICAgICAgICAgICAgICB2ZXJzaW9uLnNldFN0cmF0ZWd5KG5ldyBT\ndGF0ZUNvbXBhcmlzb25WZXJzaW9uU3RyYXRlZ3koKSwKICAgICAgICAgICAg\nICAgICAgICBudWxsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lk\nIGluc3RhbGxTdHJhdGVneShEaXNjcmltaW5hdG9yIGRpc2NyaW0pIHsKICAg\nICAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IGRpc2NyaW0uZ2V0Q2xhc3NN\nYXBwaW5nKCk7CiAgICAgICAgICAgIGlmIChjbHMuZ2V0UENTdXBlcmNsYXNz\nKCkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgZGlzY3JpbS5zZXRTdHJh\ndGVneShuZXcgU3VwZXJjbGFzc0Rpc2NyaW1pbmF0b3JTdHJhdGVneSgpLAog\nICAgICAgICAgICAgICAgICAgIG51bGwpOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKCFoYXNTdWJjbGFzc2VzKGNscykpIHsKICAgICAgICAgICAgICAgIGRp\nc2NyaW0uc2V0U3RyYXRlZ3koTm9uZURpc2NyaW1pbmF0b3JTdHJhdGVneS5n\nZXRJbnN0YW5jZSgpLAogICAgICAgICAgICAgICAgICAgIG51bGwpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKF9kaXNjU3RyYXQgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgRGlzY3JpbWluYXRvclN0cmF0ZWd5IHN0cmF0ID0gcmVw\nb3MuCiAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVEaXNjcmltaW5h\ndG9yU3RyYXRlZ3koX2Rpc2NTdHJhdCwgZGlzY3JpbSk7CiAgICAgICAgICAg\nICAgICBkaXNjcmltLnNldFN0cmF0ZWd5KHN0cmF0LCBudWxsKTsKICAgICAg\nICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBkaXNjcmltLnNldFN0cmF0\nZWd5KG5ldyBTdWJjbGFzc0pvaW5EaXNjcmltaW5hdG9yU3RyYXRlZ3koKSwK\nICAgICAgICAgICAgICAgICAgICBudWxsKTsKICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiBjbGFz\ncyBoYXMgYW55IG1hcHBlZCBwZXJzaXN0ZW50IHN1YmNsYXNzZXMuCiAgICAg\nICAgICovCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIGhhc1N1YmNsYXNzZXMo\nQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgICAgICBDbGFzc01ldGFEYXRh\nW10gbWV0YXMgPSByZXBvcy5nZXRNZXRhRGF0YXMoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBtZXRhcy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgICAgIGlmIChtZXRhc1tpXS5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBj\nbHMuZ2V0RGVzY3JpYmVkVHlwZSgpKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogRXh0ZW5zaW9uIG9mIHRoZSB7QGxp\nbmsgQ29kZUdlbmVyYXRvcn0gdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9taXpl\nCiAgICAgKiB0aGUgZm9ybWF0dGluZyBvZiB0aGVpciBnZW5lcmF0ZWQgY2xh\nc3Nlcy4KICAgICAqLwogICAgcHJpdmF0ZSBjbGFzcyBSZXZlcnNlQ29kZUdl\nbmVyYXRvcgogICAgICAgIGV4dGVuZHMgQ29kZUdlbmVyYXRvciB7CgogICAg\nICAgIHByb3RlY3RlZCBmaW5hbCBDbGFzc01hcHBpbmcgX21hcHBpbmc7CiAg\nICAgICAgcHJvdGVjdGVkIGZpbmFsIEFwcGxpY2F0aW9uSWRUb29sIF9hcHBp\nZDsKCiAgICAgICAgcHVibGljIFJldmVyc2VDb2RlR2VuZXJhdG9yKENsYXNz\nTWFwcGluZyBtYXBwaW5nLAogICAgICAgICAgICBBcHBsaWNhdGlvbklkVG9v\nbCBhaWQpIHsKICAgICAgICAgICAgc3VwZXIobWFwcGluZyk7CiAgICAgICAg\nICAgIHN1cGVyLnNldERpcmVjdG9yeShfZGlyKTsKICAgICAgICAgICAgc3Vw\nZXIuc2V0Q29kZUZvcm1hdChfZm9ybWF0KTsKCiAgICAgICAgICAgIF9tYXBw\naW5nID0gbWFwcGluZzsKICAgICAgICAgICAgaWYgKGFpZCAhPSBudWxsICYm\nIGFpZC5pc0lubmVyQ2xhc3MoKSkKICAgICAgICAgICAgICAgIF9hcHBpZCA9\nIGFpZDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2FwcGlk\nID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIElm\nIHRoZXJlIGlzIGFuIGlubmVyIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNsYXNz\nLCB0aGVuCiAgICAgICAgICogYWRkIGl0IHRvIHRoZSBib3R0b20gb2YgdGhl\nIGNsYXNzIGNvZGUuCiAgICAgICAgICovCiAgICAgICAgcHJvdGVjdGVkIHZv\naWQgY2xvc2VDbGFzc0JyYWNlKENvZGVGb3JtYXQgY29kZSkgewogICAgICAg\nICAgICBpZiAoX2FwcGlkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGNv\nZGUuYWZ0ZXJTZWN0aW9uKCk7CiAgICAgICAgICAgICAgICBjb2RlLmFwcGVu\nZChfYXBwaWQuZ2V0Q29kZSgpKTsKICAgICAgICAgICAgICAgIGNvZGUuZW5k\nbCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzdXBlci5jbG9zZUNs\nYXNzQnJhY2UoY29kZSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAg\nICAgKiBBZGQgdGhlIGxpc3Qgb2YgaW1wb3J0cyBmb3IgYW55IGlubmVyIGFw\ncCBpZCBjbGFzc2VzCiAgICAgICAgICoKICAgICAgICAgKiBAcmV0dXJuCiAg\nICAgICAgICovCiAgICAgICAgcHVibGljIFNldCBnZXRJbXBvcnRQYWNrYWdl\ncygpIHsKICAgICAgICAgICAgU2V0IHBrZ3MgPSBzdXBlci5nZXRJbXBvcnRQ\nYWNrYWdlcygpOwogICAgICAgICAgICBpZiAoX2FwcGlkICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBwa2dzLmFkZEFsbChfYXBwaWQuZ2V0SW1wb3J0UGFj\na2FnZXMoKSk7CiAgICAgICAgICAgIHJldHVybiBwa2dzOwogICAgICAgIH0K\nCiAgICAgICAgcHJvdGVjdGVkIFN0cmluZyBnZXRDbGFzc0NvZGUoKSB7CiAg\nICAgICAgICAgIHJldHVybiAoX2N1c3RvbSA9PSBudWxsKSA/IG51bGwgOiBf\nY3VzdG9tLmdldENsYXNzQ29kZShfbWFwcGluZyk7CiAgICAgICAgfQoKICAg\nICAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldEluaXRpYWxWYWx1ZShGaWVsZE1l\ndGFEYXRhIGZpZWxkKSB7CiAgICAgICAgICAgIGlmIChfY3VzdG9tID09IG51\nbGwpCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAg\ncmV0dXJuIF9jdXN0b20uZ2V0SW5pdGlhbFZhbHVlKChGaWVsZE1hcHBpbmcp\nIGZpZWxkKTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBTdHJpbmcg\nZ2V0RGVjbGFyYXRpb24oRmllbGRNZXRhRGF0YSBmaWVsZCkgewogICAgICAg\nICAgICBpZiAoX2N1c3RvbSA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgICAgIHJldHVybiBfY3VzdG9tLmdldERlY2xh\ncmF0aW9uKChGaWVsZE1hcHBpbmcpIGZpZWxkKTsKICAgICAgICB9CgogICAg\nICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0RmllbGRDb2RlKEZpZWxkTWV0YURh\ndGEgZmllbGQpIHsKICAgICAgICAgICAgaWYgKF9jdXN0b20gPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICByZXR1\ncm4gX2N1c3RvbS5nZXRGaWVsZENvZGUoKEZpZWxkTWFwcGluZykgZmllbGQp\nOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNlR2Vu\nZXJpY0NvbGxlY3Rpb25zKCkgewogICAgICAgICAgICByZXR1cm4gX3VzZUdl\nbmVyaWNDb2xsOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGNsYXNz\nIEFubm90YXRlZENvZGVHZW5lcmF0b3IKICAgICAgICBleHRlbmRzIFJldmVy\nc2VDb2RlR2VuZXJhdG9yIHsKCiAgICAgICAgcHVibGljIEFubm90YXRlZENv\nZGVHZW5lcmF0b3IgKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAgICAg\nICBBcHBsaWNhdGlvbklkVG9vbCBhaWQpIHsKICAgICAgICAgICAgc3VwZXIg\nKG1hcHBpbmcsIGFpZCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU2V0\nIGdldEltcG9ydFBhY2thZ2VzKCkgewogICAgICAgICAgICBTZXQgcGtncyA9\nIHN1cGVyLmdldEltcG9ydFBhY2thZ2VzKCk7CiAgICAgICAgICAgIHBrZ3Mu\nYWRkKCJqYXZheC5wZXJzaXN0ZW5jZSIpOwogICAgICAgICAgICByZXR1cm4g\ncGtnczsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBMaXN0IGdldENs\nYXNzQW5ub3RhdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRBbm5v\ndGF0aW9uc0Zvck1ldGEoX21hcHBpbmcpOwogICAgICAgIH0KCiAgICAgICAg\ncHJvdGVjdGVkIExpc3QgZ2V0RmllbGRBbm5vdGF0aW9ucyhGaWVsZE1ldGFE\nYXRhIGZpZWxkKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRBbm5vdGF0aW9u\nc0Zvck1ldGEoZmllbGQpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVk\nIGJvb2xlYW4gdXNlUHJvcGVydHlCYXNlZEFjY2VzcyAoKSB7CiAgICAgICAg\nICAgIHJldHVybiBBQ0NFU1NfVFlQRV9QUk9QRVJUWS5lcXVhbHMoX2FjY2Vz\nc1R5cGUpOwogICAgICAgIH0KCiAgICB9Cn0K\n","encoding":"base64"}

