{"sha":"7995575cc84734ec99480eff73d44ee1f26fc9f8","node_id":"MDQ6QmxvYjIwNjM2NDo3OTk1NTc1Y2M4NDczNGVjOTk0ODBlZmY3M2Q0NGVlMWYyNmZjOWY4","size":4335,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7995575cc84734ec99480eff73d44ee1f26fc9f8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwoKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVGaWVsZFN0cmF0ZWd5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4\nY2VwdGlvbjsKCi8qKgogKiBJbnN0YWxsZXIgdGhhdCBhdHRlbXB0cyB0byB1\nc2UgdGhlIGdpdmVuIG1hcHBpbmcgaW5mb3JtYXRpb24sIGFuZAogKiBmYWls\ncyBpZiBpdCBkb2VzIG5vdCB3b3JrLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0\nZQogKiBAbm9qYXZhZG9jCiAqIEBzaW5jZSAwLjQuMAogKi8KcHVibGljIGNs\nYXNzIFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcgogICAgZXh0ZW5kcyBTdHJh\ndGVneUluc3RhbGxlciB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChS\ndW50aW1lU3RyYXRlZ3lJbnN0YWxsZXIuY2xhc3MpOwoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3I7IHN1cHBseSBjb25maWd1cmF0aW9uLgogICAgICov\nCiAgICBwdWJsaWMgUnVudGltZVN0cmF0ZWd5SW5zdGFsbGVyKE1hcHBpbmdS\nZXBvc2l0b3J5IHJlcG9zKSB7CiAgICAgICAgc3VwZXIocmVwb3MpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShDbGFzc01hcHBp\nbmcgY2xzKSB7CiAgICAgICAgaWYgKChjbHMuZ2V0U291cmNlTW9kZSgpICYg\nY2xzLk1PREVfTUFQUElORykgPT0gMCkKICAgICAgICAgICAgdGhyb3cgbmV3\nIE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1tYXBwaW5nIiwgY2xz\nKSk7CgogICAgICAgIENsYXNzU3RyYXRlZ3kgc3RyYXQgPSByZXBvcy5uYW1l\nZFN0cmF0ZWd5KGNscyk7CiAgICAgICAgaWYgKHN0cmF0ID09IG51bGwpCiAg\nICAgICAgICAgIHN0cmF0ID0gcmVwb3MuZGVmYXVsdFN0cmF0ZWd5KGNscywg\nZmFsc2UpOwogICAgICAgIGNscy5zZXRTdHJhdGVneShzdHJhdCwgQm9vbGVh\nbi5GQUxTRSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5zdGFsbFN0cmF0\nZWd5KEZpZWxkTWFwcGluZyBmaWVsZCkgewogICAgICAgIEZpZWxkU3RyYXRl\nZ3kgc3RyYXRlZ3kgPSBudWxsOwogICAgICAgIENsYXNzTWFwcGluZyBvd25l\nciA9IGdldE91dGVybW9zdERlZmluaW5nTWFwcGluZyhmaWVsZCk7IAogICAg\nICAgIGlmIChvd25lciAhPSBudWxsICYmICFvd25lci5pc0VtYmVkZGFibGUo\nKSAmJiAhb3duZXIuaXNBYnN0cmFjdCgpKQogICAgICAgICAgICBzdHJhdGVn\neSA9IHJlcG9zLm5hbWVkU3RyYXRlZ3koZmllbGQsIHRydWUpOwogICAgICAg\nIGlmIChzdHJhdGVneSA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBzdHJhdGVneSA9IHJlcG9zLmRlZmF1bHRTdHJhdGVn\neShmaWVsZCwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICAgICB9IGNhdGNoIChN\nZXRhRGF0YUV4Y2VwdGlvbiBtZGUpIHsKICAgICAgICAgICAgICAgIC8vIGlm\nIHRoZSBwYXJlbnQgY2xhc3MgaXMgYWJzdHJhY3QgYW5kIGZpZWxkIGlzIHVu\nbWFwcGVkLAogICAgICAgICAgICAgICAgLy8gYWxsb3cgaXQgdG8gcGFzcyAo\nYXNzdW1lIHN1YmNsYXNzZXMgbWFwIHRoZSBmaWVsZCkKICAgICAgICAgICAg\nICAgIENsYXNzIGNscyA9IGZpZWxkLmdldERlZmluaW5nTWV0YURhdGEoKS5n\nZXREZXNjcmliZWRUeXBlKCk7CiAgICAgICAgICAgICAgICBpZiAoIU1vZGlm\naWVyLmlzQWJzdHJhY3QoY2xzLmdldE1vZGlmaWVycygpKQogICAgICAgICAg\nICAgICAgICAgIHx8IGZpZWxkLmdldE1hcHBlZEJ5KCkgIT0gbnVsbAogICAg\nICAgICAgICAgICAgICAgIHx8IGZpZWxkLmdldE1hcHBpbmdJbmZvKCkuaGFz\nU2NoZW1hQ29tcG9uZW50cygpCiAgICAgICAgICAgICAgICAgICAgfHwgZmll\nbGQuZ2V0VmFsdWVJbmZvKCkuaGFzU2NoZW1hQ29tcG9uZW50cygpCiAgICAg\nICAgICAgICAgICAgICAgfHwgZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKS5n\nZXRWYWx1ZUluZm8oKS5oYXNTY2hlbWFDb21wb25lbnRzKCkKICAgICAgICAg\nICAgICAgICAgICB8fCBmaWVsZC5nZXRLZXlNYXBwaW5nKCkuZ2V0VmFsdWVJ\nbmZvKCkuaGFzU2NoZW1hQ29tcG9uZW50cygpKQogICAgICAgICAgICAgICAg\nICAgIHRocm93IG1kZTsKCiAgICAgICAgICAgICAgICBzdHJhdGVneSA9IE5v\nbmVGaWVsZFN0cmF0ZWd5LmdldEluc3RhbmNlKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgZmllbGQuc2V0U3RyYXRlZ3koc3RyYXRlZ3ks\nIEJvb2xlYW4uRkFMU0UpOwogICAgfQogICAgCiAgICBwcml2YXRlIENsYXNz\nTWFwcGluZyBnZXRPdXRlcm1vc3REZWZpbmluZ01hcHBpbmcoVmFsdWVNZXRh\nRGF0YSB2bSkgewogICAgICAgIGlmICh2bSBpbnN0YW5jZW9mIEZpZWxkTWFw\ncGluZykgewogICAgICAgICAgICBDbGFzc01hcHBpbmcgb3duZXIgPSAoKEZp\nZWxkTWFwcGluZyl2bSkuZ2V0RGVmaW5pbmdNYXBwaW5nKCk7CiAgICAgICAg\nICAgIFZhbHVlTWV0YURhdGEgdmFsID0gb3duZXIuZ2V0RW1iZWRkaW5nTWV0\nYURhdGEoKTsKICAgICAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAg\nICAgICAgICAgcmV0dXJuIG93bmVyOyAKICAgICAgICAgICAgcmV0dXJuIGdl\ndE91dGVybW9zdERlZmluaW5nTWFwcGluZyh2YWwpOwogICAgICAgIH0gZWxz\nZSBpZiAodm0gaW5zdGFuY2VvZiBWYWx1ZU1hcHBpbmdJbXBsKSB7CiAgICAg\nICAgICAgIEZpZWxkTWFwcGluZyBvd25lciA9ICgoVmFsdWVNYXBwaW5nSW1w\nbCl2bSkuZ2V0RmllbGRNYXBwaW5nKCk7CiAgICAgICAgICAgIHJldHVybiBn\nZXRPdXRlcm1vc3REZWZpbmluZ01hcHBpbmcob3duZXIpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBp\nbnN0YWxsU3RyYXRlZ3koVmVyc2lvbiB2ZXJzaW9uKSB7CiAgICAgICAgVmVy\nc2lvblN0cmF0ZWd5IHN0cmF0ID0gcmVwb3MubmFtZWRTdHJhdGVneSh2ZXJz\naW9uKTsKICAgICAgICBpZiAoc3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAg\nc3RyYXQgPSByZXBvcy5kZWZhdWx0U3RyYXRlZ3kodmVyc2lvbiwgZmFsc2Up\nOwogICAgICAgIHZlcnNpb24uc2V0U3RyYXRlZ3koc3RyYXQsIEJvb2xlYW4u\nRkFMU0UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVn\neShEaXNjcmltaW5hdG9yIGRpc2NyaW0pIHsKICAgICAgICBEaXNjcmltaW5h\ndG9yU3RyYXRlZ3kgc3RyYXQgPSByZXBvcy5uYW1lZFN0cmF0ZWd5KGRpc2Ny\naW0pOwogICAgICAgIGlmIChzdHJhdCA9PSBudWxsKQogICAgICAgICAgICBz\ndHJhdCA9IHJlcG9zLmRlZmF1bHRTdHJhdGVneShkaXNjcmltLCBmYWxzZSk7\nCiAgICAgICAgZGlzY3JpbS5zZXRTdHJhdGVneShzdHJhdCwgQm9vbGVhbi5G\nQUxTRSk7CiAgICB9Cn0K\n","encoding":"base64"}

