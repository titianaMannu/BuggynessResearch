{"sha":"4f5d050f2c617ed029304d508f618385559eb04b","node_id":"MDQ6QmxvYjIwNjM2NDo0ZjVkMDUwZjJjNjE3ZWQwMjkzMDRkNTA4ZjYxODM4NTU1OWViMDRi","size":7018,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4f5d050f2c617ed029304d508f618385559eb04b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZpZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3Jl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01h\ncHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRp\nc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5zOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJlc3VsdDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAqIEJhc2Ug\nZGlzY3JpbWluYXRvciBzdHJhdGVneSB0aGF0IGRldGVybWluZXMgdGhlIGNs\nYXNzIG9mIGRhdGFiYXNlCiAqIHJlY29yZHMgdXNpbmcgYSBjb2x1bW4gaG9s\nZGluZyBhIHZhbHVlIG1hcHBlZCB0byBhIGNsYXNzLCBhbmQgbGltaXRzCiAq\nIFNFTEVDVHMgdXNpbmcgYW4gSU4gKC4uLikgc3RhdGVtZW50LgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIElu\nVmFsdWVEaXNjcmltaW5hdG9yU3RyYXRlZ3kKICAgIGV4dGVuZHMgQWJzdHJh\nY3REaXNjcmltaW5hdG9yU3RyYXRlZ3kgewoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoSW5WYWx1ZURpc2NyaW1pbmF0b3JTdHJhdGVneS5jbGFzcyk7\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIEphdmEgdHlwZSBjb2RlIGZy\nb20ge0BsaW5rIEphdmFUeXBlc30gZm9yIHRoZSBkaXNjcmltaW5hdG9yCiAg\nICAgKiB2YWx1ZXMuIFRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBkdXJpbmcg\nbWFwcGluZyBpbnN0YWxsYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBh\nYnN0cmFjdCBpbnQgZ2V0SmF2YVR5cGUoKTsKCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgZGlzY3JpbWluYXRvciB2YWx1ZSBmb3IgdGhlIGdpdmVuIHR5\ncGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPYmplY3QgZ2V0\nRGlzY3JpbWluYXRvclZhbHVlKENsYXNzTWFwcGluZyBjbHMpOwoKICAgIC8q\nKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4gZGlzY3JpbWluYXRvciB2YWx1\nZSB0byB0aGUgY29ycmVzcG9uZGluZyBjbGFzcy4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGFic3RyYWN0IENsYXNzIGdldENsYXNzKE9iamVjdCB2YWwsIEpE\nQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4\nY2VwdGlvbjsKCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkg\newogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSBkaXNjLmdldENsYXNzTWFw\ncGluZygpOwogICAgICAgIGlmIChjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xh\nc3NNYXBwaW5nKCkgIT0gbnVsbAogICAgICAgICAgICB8fCBjbHMuZ2V0RW1i\nZWRkaW5nTWV0YURhdGEoKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1iYXNlLWRpc2Mi\nLCBjbHMpKTsKCiAgICAgICAgRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvIGlu\nZm8gPSBkaXNjLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgaW5mby5hc3Nl\ncnROb0pvaW4oZGlzYywgdHJ1ZSk7CiAgICAgICAgaW5mby5hc3NlcnROb0Zv\ncmVpZ25LZXkoZGlzYywgIWFkYXB0KTsKICAgICAgICBpbmZvLmFzc2VydE5v\nVW5pcXVlKGRpc2MsIGZhbHNlKTsKCiAgICAgICAgQ29sdW1uIHRtcGxhdGUg\nPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgdG1wbGF0ZS5zZXRKYXZhVHlwZShn\nZXRKYXZhVHlwZSgpKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IGNs\ncy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldERCRGljdGlvbmFyeSgpOwog\nICAgICAgIERCSWRlbnRpZmllciB0eXBOYW1lID0gREJJZGVudGlmaWVyLm5l\nd0NvbHVtbigidHlwIiwgZGljdCAhPSBudWxsID8gZGljdC5kZWxpbWl0QWxs\nKCkgOiBmYWxzZSk7CiAgICAgICAgdG1wbGF0ZS5zZXRJZGVudGlmaWVyKHR5\ncE5hbWUpOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0gaW5mby5nZXRDb2x1\nbW5zKGRpc2MsIG5ldyBDb2x1bW5bXXsgdG1wbGF0ZSB9LCBhZGFwdCk7CiAg\nICAgICAgZGlzYy5zZXRDb2x1bW5zKGNvbHMpOwogICAgICAgIGRpc2Muc2V0\nQ29sdW1uSU8oaW5mby5nZXRDb2x1bW5JTygpKTsKCiAgICAgICAgSW5kZXgg\naWR4ID0gaW5mby5nZXRJbmRleChkaXNjLCBjb2xzLCBhZGFwdCk7CiAgICAg\nICAgZGlzYy5zZXRJbmRleChpZHgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGluc2VydChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3Rv\ncmUsIFJvd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgUm93IHJvdyA9IHJtLmdldFJvdyhkaXNjLmdldENsYXNz\nTWFwcGluZygpLmdldFRhYmxlKCksCiAgICAgICAgICAgIFJvdy5BQ1RJT05f\nSU5TRVJULCBzbSwgdHJ1ZSk7CiAgICAgICAgT2JqZWN0IGNscyA9IGdldERp\nc2NyaW1pbmF0b3JWYWx1ZSgoQ2xhc3NNYXBwaW5nKSBzbS5nZXRNZXRhRGF0\nYSgpKTsKICAgICAgICBpZiAoZGlzYy5nZXRDb2x1bW5JTygpLmlzSW5zZXJ0\nYWJsZSgwLCBjbHMgPT0gbnVsbCkpCiAgICAgICAgICAgIHJvdy5zZXRPYmpl\nY3QoZGlzYy5nZXRDb2x1bW5zKClbMF0sIGNscyk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gc2VsZWN0KFNlbGVjdCBzZWwsIENsYXNzTWFwcGluZyBt\nYXBwaW5nKSB7CiAgICAgICAgaWYgKGlzRmluYWwpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICBzZWwuc2VsZWN0KGRpc2MuZ2V0Q29sdW1u\ncygpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMg\nQ2xhc3MgZ2V0Q2xhc3MoSkRCQ1N0b3JlIHN0b3JlLCBDbGFzc01hcHBpbmcg\nYmFzZSwgUmVzdWx0IHJlcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBpZiAoaXNGaW5h\nbCAKICAgICAgICAgICAgICAgIHx8ICF1c2VEaXNjcmltQ29sdW1uKGJhc2Us\nIHJlcykKICAgICAgICAgICAgICAgIHx8IChiYXNlLmdldFBDU3VwZXJjbGFz\ncygpID09IG51bGwgJiYgYmFzZS5nZXRKb2luYWJsZVBDU3ViY2xhc3NNYXBw\naW5ncygpLmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICByZXR1cm4gYmFz\nZS5nZXREZXNjcmliZWRUeXBlKCk7CiAgICAgICAgfQoKICAgICAgICBPYmpl\nY3QgY2xzID0gcmVzLmdldE9iamVjdChkaXNjLmdldENvbHVtbnMoKVswXSwg\nZGlzYy5nZXRKYXZhVHlwZSgpLCBudWxsKTsKICAgICAgICByZXR1cm4gZ2V0\nQ2xhc3MoY2xzLCBzdG9yZSk7CiAgICB9CiAgICAKICAgIHByaXZhdGUgZmlu\nYWwgYm9vbGVhbiB1c2VEaXNjcmltQ29sdW1uKENsYXNzTWFwcGluZyBiYXNl\nLCBSZXN1bHQgcmVzKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAocmVzLmdldEJhc2VNYXBwaW5nKCkgIT0gbnVsbCAmJiBiYXNlICE9IG51\nbGwpIHsKICAgICAgICAgICAgLy8gY2hlY2sgd2hldGhlciB0aGUgcmVzdWx0\nIHR5cGUgaXMgYXNzaWduYWJsZSB0byB0aGUgYmFzZSBtYXBwaW5nLgogICAg\nICAgICAgICAvLyBpZiBub3QgYXNzaWduYWJsZSB0aGUgZGlzY3JpbWluYXRv\nciB2YWx1ZSB3aWxsIG5vdCBiZSBjb3JyZWN0LgogICAgICAgICAgICBpZiAo\nIWJhc2UuZ2V0RGVzY3JpYmVkVHlwZSgpLmlzQXNzaWduYWJsZUZyb20ocmVz\nLmdldEJhc2VNYXBwaW5nKCkuZ2V0RGVzY3JpYmVkVHlwZSgpKSkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIHJldHVybiByZXMuY29udGFpbnMoZGlzYy5nZXRDb2x1\nbW5zKClbMF0pOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc0NsYXNz\nQ29uZGl0aW9ucyhDbGFzc01hcHBpbmcgYmFzZSwgYm9vbGVhbiBzdWJjbGFz\nc2VzKSB7CiAgICAgICAgLy8gaWYgc2VsZWN0aW5nIHRoZSBmaXJzdCBtYXBw\nZWQgY2xhc3MgYW5kIGFsbCBzdWJjbGFzc2VzLCBubyBuZWVkCiAgICAgICAg\nLy8gdG8gbGltaXQgdGhlIHF1ZXJ5CiAgICAgICAgaWYgKGlzRmluYWwgfHwg\nKGJhc2UuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgPT0gbnVs\nbAogICAgICAgICAgICAmJiBzdWJjbGFzc2VzKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwoKICAgICAgICAvLyBpZiBubyBzdWJjbGFzc2VzIG9yIHN1\ncGVyY2xhc3MsIG5vIG5lZWQgZm9yIGNvbmRpdGlvbnMKICAgICAgICBDbGFz\nc01hcHBpbmdbXSBzdWJzID0gYmFzZS5nZXRKb2luYWJsZVBDU3ViY2xhc3NN\nYXBwaW5ncygpOwogICAgICAgIGlmIChzdWJzLmxlbmd0aCA9PSAwICYmIGJh\nc2UuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIGdldENsYXNzQ29uZGl0\naW9ucyhTZWxlY3Qgc2VsLCBKb2lucyBqb2lucywgCiAgICAgICAgQ2xhc3NN\nYXBwaW5nIGJhc2UsIGJvb2xlYW4gc3ViY2xhc3NlcykgewogICAgICAgIENv\nbHVtbiBjb2wgPSBkaXNjLmdldENvbHVtbnMoKVswXTsKICAgICAgICBTUUxC\ndWZmZXIgc3FsID0gbmV3IFNRTEJ1ZmZlcihzZWwuZ2V0Q29uZmlndXJhdGlv\nbigpLgogICAgICAgICAgICBnZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpKTsK\nICAgICAgICBTdHJpbmcgYWxpYXMgPSBzZWwuZ2V0Q29sdW1uQWxpYXMoY29s\nLCBqb2lucyk7CiAgICAgICAgYm9vbGVhbiBvdXRlciA9IGpvaW5zICE9IG51\nbGwgJiYgam9pbnMuaXNPdXRlcigpOwogICAgICAgIGlmIChvdXRlcikKICAg\nICAgICAgICAgc3FsLmFwcGVuZCgiKCIpOwogICAgICAgIHNxbC5hcHBlbmQo\nYWxpYXMpOwoKICAgICAgICAvLyBpZiBub3Qgc2VsZWN0aW5nIHN1YmNsYXNz\nZXMsIGxpbWl0IHRvIGp1c3QgdGhlIGdpdmVuIGNsYXNzCiAgICAgICAgQ2xh\nc3NNYXBwaW5nW10gc3VicyA9IGJhc2UuZ2V0Sm9pbmFibGVQQ1N1YmNsYXNz\nTWFwcGluZ3MoKTsKICAgICAgICBpZiAoIW91dGVyICYmICghc3ViY2xhc3Nl\ncyB8fCBzdWJzLmxlbmd0aCA9PSAwKSkKICAgICAgICAgICAgcmV0dXJuIHNx\nbC5hcHBlbmQoIiA9ICIpLmFwcGVuZFZhbHVlKGdldERpc2NyaW1pbmF0b3JW\nYWx1ZShiYXNlKSwKICAgICAgICAgICAgICAgIGNvbCk7CgogICAgICAgIGlm\nIChvdXRlcikKICAgICAgICAgICAgc3FsLmFwcGVuZCgiIElTICIpLmFwcGVu\nZFZhbHVlKG51bGwpLmFwcGVuZCgiIE9SICIpLmFwcGVuZChhbGlhcyk7CiAg\nICAgICAgc3FsLmFwcGVuZCgiIElOICgiKTsKICAgICAgICBzcWwuYXBwZW5k\nVmFsdWUoZ2V0RGlzY3JpbWluYXRvclZhbHVlKGJhc2UpLCBjb2wpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgc3FsLmFwcGVuZCgiLCAiKS5hcHBlbmRWYWx1ZShnZXREaXNj\ncmltaW5hdG9yVmFsdWUoc3Vic1tpXSksIGNvbCk7CiAgICAgICAgc3FsLmFw\ncGVuZCgiKSIpOwogICAgICAgIGlmIChvdXRlcikKICAgICAgICAgICAgc3Fs\nLmFwcGVuZCgiKSIpOwogICAgICAgIHJldHVybiBzcWw7CiAgICB9Cn0KCg==\n","encoding":"base64"}

