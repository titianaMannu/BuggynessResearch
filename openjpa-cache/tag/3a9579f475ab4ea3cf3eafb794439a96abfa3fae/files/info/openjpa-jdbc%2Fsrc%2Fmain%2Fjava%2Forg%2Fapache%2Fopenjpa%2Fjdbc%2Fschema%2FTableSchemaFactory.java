{"sha":"dc7355dfed4dfe10f4640bc36d6925c1b83ce9e5","node_id":"MDQ6QmxvYjIwNjM2NDpkYzczNTVkZmVkNGRmZTEwZjQ2NDBiYzM2ZDY5MjVjMWI4M2NlOWU1","size":17605,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dc7355dfed4dfe10f4640bc36d6925c1b83ce9e5","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyaW5n\nUmVhZGVyOwppbXBvcnQgamF2YS5pby5TdHJpbmdXcml0ZXI7CmltcG9ydCBq\nYXZhLmlvLldyaXRlcjsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247Cmlt\ncG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEu\nc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEuc3FsLlR5cGVzOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uSW1w\nbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIu\nTm9ybWFsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlk\nZW50aWZpZXIuREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuaWRlbnRpZmllci5RdWFsaWZpZWREQklkZW50aWZpZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxFeGNl\ncHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNv\nbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29u\nZi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5tZXRhLk1ldGFEYXRhU2VyaWFsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkdlbmVyYWxFeGNlcHRpb247CmltcG9ydCBzZXJwLnV0aWwu\nU3RyaW5nczsKCi8qKgogKiBGYWN0b3J5IHRoYXQgdXNlcyBhbiBYTUwgc2No\nZW1hIGRlZmluaXRpb24gc3RvcmVkIGluIGEgZGF0YWJhc2UgdGFibGUKICog\ndG8gcmVjb3JkIHRoZSBzeXN0ZW0gc2NoZW1hLgogKgogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIFRhYmxlU2NoZW1hRmFjdG9yeQog\nICAgaW1wbGVtZW50cyBTY2hlbWFGYWN0b3J5LCBDb25maWd1cmFibGUgewoK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9BREQgPSAi\nYWRkIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9E\nUk9QID0gImRyb3AiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoVGFi\nbGVTY2hlbWFGYWN0b3J5LmNsYXNzKTsKICAgIHByaXZhdGUgc3RhdGljIGJv\nb2xlYW4gX3JlZnJlc2hlZFRhYmxlID0gZmFsc2U7CgogICAgcHJpdmF0ZSBK\nREJDQ29uZmlndXJhdGlvbiBfY29uZiA9IG51bGw7CiAgICBwcml2YXRlIExv\nZyBfbG9nID0gbnVsbDsKICAgIHByaXZhdGUgREJJZGVudGlmaWVyIF90YWJs\nZSA9IERCSWRlbnRpZmllci5uZXdUYWJsZSgiT1BFTkpQQV9TQ0hFTUEiKTsK\nICAgIHByaXZhdGUgREJJZGVudGlmaWVyIF9wa0NvbHVtbk5hbWUgPSBEQklk\nZW50aWZpZXIubmV3Q29sdW1uKCJJRCIpOwogICAgcHJpdmF0ZSBEQklkZW50\naWZpZXIgX3NjaGVtYUNvbHVtbk5hbWUgPSBEQklkZW50aWZpZXIubmV3Q29s\ndW1uKCJTQ0hFTUFfREVGIik7CiAgICBwcml2YXRlIENvbHVtbiBfcGtDb2x1\nbW4gPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW4gX3NjaGVtYUNvbHVtbiA9\nIG51bGw7CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgc2NoZW1h\nIGRlZmluaXRpb24gdGFibGUuIERlZmF1bHRzIHRvCiAgICAgKiA8Y29kZT5P\nUEVOSlBBX1NDSEVNQTwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJp\nbmcgZ2V0VGFibGUoKSB7CiAgICAgICAgcmV0dXJuIF90YWJsZS5nZXROYW1l\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgc2No\nZW1hIGRlZmluaXRpb24gdGFibGUuIERlZmF1bHRzIHRvCiAgICAgKiA8Y29k\nZT5PUEVOSlBBX1NDSEVNQTwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFRhYmxlKFN0cmluZyBuYW1lKSB7CiAgICAgICAgX3RhYmxlID0g\nREJJZGVudGlmaWVyLm5ld1RhYmxlKG5hbWUpOwogICAgfQoKICAgIC8qKgog\nICAgICogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayAjc2V0VGFibGV9LiBSZXRh\naW5lZCBmb3IKICAgICAqIGJhY2t3YXJkcy1jb21wYXRpYmxlIGF1dG8tY29u\nZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VGFibGVO\nYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgc2V0VGFibGUobmFtZSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcHJpbWFyeSBr\nZXkgY29sdW1uIG9uIHRoZSBzY2hlbWEgZGVmaW5pdGlvbiB0YWJsZS4KICAg\nICAqIERlZmF1bHRzIHRvIDxjb2RlPklEPC9jb2RlPi4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0UHJpbWFyeUtleUNvbHVtbihTdHJpbmcgbmFtZSkg\newogICAgICAgIF9wa0NvbHVtbk5hbWUgPSBEQklkZW50aWZpZXIubmV3Q29s\ndW1uKG5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2Yg\ndGhlIHByaW1hcnkga2V5IGNvbHVtbiBvbiB0aGUgc2NoZW1hIGRlZmluaXRp\nb24gdGFibGUuCiAgICAgKiBEZWZhdWx0cyB0byA8Y29kZT5JRDwvY29kZT4u\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0UHJpbWFyeUtleUNvbHVt\nbigpIHsKICAgICAgICByZXR1cm4gX3BrQ29sdW1uTmFtZS5nZXROYW1lKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgc2NoZW1h\nIGNvbHVtbiBvbiB0aGUgc2NoZW1hIGRlZmluaXRpb24gdGFibGUuCiAgICAg\nKiBEZWZhdWx0cyB0byA8Y29kZT5TQ0hFTUFfREVGPC9jb2RlPi4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0U2NoZW1hQ29sdW1uKFN0cmluZyBuYW1l\nKSB7CiAgICAgICAgX3NjaGVtYUNvbHVtbk5hbWUgPSBEQklkZW50aWZpZXIu\nbmV3Q29sdW1uKG5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG5h\nbWUgb2YgdGhlIHNjaGVtYSBjb2x1bW4gb24gdGhlIHNjaGVtYSBkZWZpbml0\naW9uIHRhYmxlLgogICAgICogRGVmYXVsdHMgdG8gPGNvZGU+U0NIRU1BX0RF\nRjwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2NoZW1h\nQ29sdW1uKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hQ29sdW1uTmFtZS5n\nZXROYW1lKCk7CiAgICB9CgogICAgcHVibGljIEpEQkNDb25maWd1cmF0aW9u\nIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9jb25mOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENvbmZpZ3VyYXRpb24oQ29uZmln\ndXJhdGlvbiBjb25mKSB7CiAgICAgICAgX2NvbmYgPSAoSkRCQ0NvbmZpZ3Vy\nYXRpb24pIGNvbmY7CiAgICAgICAgX2xvZyA9IF9jb25mLmdldExvZyhKREJD\nQ29uZmlndXJhdGlvbi5MT0dfU0NIRU1BKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzdGFydENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsKICAgICAgICBidWlsZFRhYmxl\nKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgU2NoZW1h\nR3JvdXAgcmVhZFNjaGVtYSgpIHsKICAgICAgICBTdHJpbmcgc2NoZW1hID0g\nbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBzY2hlbWEgPSByZWFk\nU2NoZW1hQ29sdW1uKCk7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYmFkLXNjaC1y\nZWFkIiwgc2UpKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNjaGVtYSA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbmV3IFNjaGVtYUdyb3VwKCk7Cgog\nICAgICAgIFhNTFNjaGVtYVBhcnNlciBwYXJzZXIgPSBuZXcgWE1MU2NoZW1h\nUGFyc2VyKF9jb25mKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBwYXJz\nZXIucGFyc2UobmV3IFN0cmluZ1JlYWRlcihzY2hlbWEpLAogICAgICAgICAg\nICAgICAgX3NjaGVtYUNvbHVtbi5nZXRRdWFsaWZpZWRQYXRoKCkudG9TdHJp\nbmcoKSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGlvZSk7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBwYXJzZXIuZ2V0U2NoZW1hR3JvdXAo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdG9yZVNjaGVtYShTY2hlbWFH\ncm91cCBzY2hlbWEpIHsKICAgICAgICBYTUxTY2hlbWFTZXJpYWxpemVyIHNl\nciA9IG5ldyBYTUxTY2hlbWFTZXJpYWxpemVyKF9jb25mKTsKICAgICAgICBz\nZXIuYWRkQWxsKHNjaGVtYSk7CiAgICAgICAgV3JpdGVyIHdyaXRlciA9IG5l\ndyBTdHJpbmdXcml0ZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBz\nZXIuc2VyaWFsaXplKHdyaXRlciwgTWV0YURhdGFTZXJpYWxpemVyLkNPTVBB\nQ1QpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihpb2UpOwogICAg\nICAgIH0KCiAgICAgICAgU3RyaW5nIHNjaGVtYVN0ciA9IHdyaXRlci50b1N0\ncmluZygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdyaXRlU2NoZW1h\nQ29sdW1uKHNjaGVtYVN0cik7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYmFkLXNj\naC13cml0ZS0xIiwgc2UpKTsKCiAgICAgICAgICAgIC8vIG1heWJlIHRoZSB1\ncGRhdGUgZmFpbGVkIGIvYyB0aGUgc2VxdWVuY2UgdGFibGUgZG9lc24ndAog\nICAgICAgICAgICAvLyBleGlzdCB5ZXQ7IGNyZWF0ZSBpdCBub3c7IG5vdGUg\ndGhhdCB0aG91Z2ggd2Ugc3luY2hyb25pemUKICAgICAgICAgICAgLy8gaGVy\nZSwgb3RoZXIgSlZNcyBjYW4gc3RpbGwgYmUgdHJ5aW5nIHRvIGNyZWF0ZSB0\naGUgdGFibGUgYXQKICAgICAgICAgICAgLy8gdGhlIHNhbWUgdGltZSAodW5s\naWtlbHksIHNpbmNlIHRoaXMgaXMgYSBkZXYtdG9vbCBvcCkKICAgICAgICAg\nICAgc3luY2hyb25pemVkIChUYWJsZVNjaGVtYUZhY3RvcnkuY2xhc3MpIHsK\nICAgICAgICAgICAgICAgIGlmICghX3JlZnJlc2hlZFRhYmxlKSB7CiAgICAg\nICAgICAgICAgICAgICAgX3JlZnJlc2hlZFRhYmxlID0gdHJ1ZTsKICAgICAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBy\nZWZyZXNoVGFibGUoKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2xv\nZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBfbG9nLndhcm4oX2xvYy5nZXQoImJhZC1zY2gtcmVmIiwgZSkpOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHdyaXRlU2NoZW1h\nQ29sdW1uKHNjaGVtYVN0cik7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlz\nV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53\nYXJuKF9sb2MuZ2V0KCJiYWQtc2NoLXdyaXRlLTIiKSk7CgogICAgICAgICAg\nICAgICAgICAgIC8vIHRocm93IG9yaWdpbmFsIGV4Y2VwdGlvbgogICAgICAg\nICAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2Us\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9jb25mLmdldERCRGljdGlvbmFy\neUluc3RhbmNlKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlcyB0aGUg\nc2NoZW1hIHRhYmxlIGluIHRoZSBEQi4KICAgICAqLwogICAgcHVibGljIHZv\naWQgcmVmcmVzaFRhYmxlKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAg\nICAgIF9sb2cuaW5mbyhfbG9jLmdldCgibWFrZS1zY2gtdGFibGUiKSk7Cgog\nICAgICAgIC8vIGNyZWF0ZSB0aGUgdGFibGUKICAgICAgICBTY2hlbWFUb29s\nIHRvb2wgPSBuZXcgU2NoZW1hVG9vbChfY29uZik7CiAgICAgICAgdG9vbC5z\nZXRJZ25vcmVFcnJvcnModHJ1ZSk7CiAgICAgICAgdG9vbC5jcmVhdGVUYWJs\nZShfcGtDb2x1bW4uZ2V0VGFibGUoKSk7CgogICAgICAgIC8vIGluc2VydCBh\nbiBlbXB0eSBzY2hlbWEKICAgICAgICBDb25uZWN0aW9uIGNvbm4gPSBnZXRD\nb25uZWN0aW9uKCk7CiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQg\nPSBudWxsOwogICAgICAgIGJvb2xlYW4gd2FzQXV0byA9IHRydWU7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgd2FzQXV0byA9IGNvbm4uZ2V0QXV0b0Nv\nbW1pdCgpOwogICAgICAgICAgICBpZiAoIXdhc0F1dG8pCiAgICAgICAgICAg\nICAgICBjb25uLnNldEF1dG9Db21taXQodHJ1ZSk7CgogICAgICAgICAgICBE\nQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUluc3Rh\nbmNlKCk7CiAgICAgICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVt\nZW50KCJJTlNFUlQgSU5UTyAiCiAgICAgICAgICAgICAgICArIGRpY3QuZ2V0\nRnVsbE5hbWUoX3BrQ29sdW1uLmdldFRhYmxlKCksIGZhbHNlKQogICAgICAg\nICAgICAgICAgKyAiICgiICsgZGljdC5nZXRDb2x1bW5EQk5hbWUoX3BrQ29s\ndW1uKSArICIsICIgKyAKICAgICAgICAgICAgICAgIGRpY3QuZ2V0Q29sdW1u\nREJOYW1lKF9zY2hlbWFDb2x1bW4pICsgIikgVkFMVUVTICg/LCA/KSIpOwog\nICAgICAgICAgICBkaWN0LnNldEludChzdG1udCwgMSwgMSwgX3BrQ29sdW1u\nKTsKICAgICAgICAgICAgZGljdC5zZXROdWxsKHN0bW50LCAyLCBfc2NoZW1h\nQ29sdW1uLmdldFR5cGUoKSwgX3NjaGVtYUNvbHVtbik7CiAgICAgICAgICAg\nIGRpY3Quc2V0VGltZW91dHMoc3RtbnQsIF9jb25mLCB0cnVlKTsKICAgICAg\nICAgICAgc3RtbnQuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdG1udC5jbG9zZSgp\nOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghd2FzQXV0bykK\nICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25uLmNsb3NlKCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRHJv\ncHMgdGhlIHNlcXVlbmNlIHRhYmxlIGluIHRoZSBEQi4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgZHJvcFRhYmxlKCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpCiAg\nICAgICAgICAgIF9sb2cuaW5mbyhfbG9jLmdldCgiZHJvcC1zY2gtdGFibGUi\nKSk7CgogICAgICAgIC8vIGRyb3AgdGhlIHRhYmxlCiAgICAgICAgU2NoZW1h\nVG9vbCB0b29sID0gbmV3IFNjaGVtYVRvb2woX2NvbmYpOwogICAgICAgIHRv\nb2wuc2V0SWdub3JlRXJyb3JzKHRydWUpOwogICAgICAgIHRvb2wuZHJvcFRh\nYmxlKF9wa0NvbHVtbi5nZXRUYWJsZSgpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybnMgdGhlIHNjaGVtYSBhcyBhbiBYTUwgc3RyaW5nLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIHJlYWRTY2hlbWFDb2x1bW4oKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIERCRGljdGlvbmFy\neSBkaWN0ID0gX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAg\nICAgICBTUUxCdWZmZXIgc2VsID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBl\nbmQoX3NjaGVtYUNvbHVtbik7CiAgICAgICAgU1FMQnVmZmVyIHdoZXJlID0g\nbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoX3BrQ29sdW1uKS5hcHBlbmQo\nIiA9ICIpLgogICAgICAgICAgICBhcHBlbmRWYWx1ZSgxLCBfcGtDb2x1bW4p\nOwogICAgICAgIFNRTEJ1ZmZlciB0YWJsZXMgPSBuZXcgU1FMQnVmZmVyKGRp\nY3QpLmFwcGVuZChfcGtDb2x1bW4uZ2V0VGFibGUoKSk7CgogICAgICAgIFNR\nTEJ1ZmZlciBzZWxlY3QgPSBkaWN0LnRvU2VsZWN0KHNlbCwgbnVsbCwgdGFi\nbGVzLCB3aGVyZSwgbnVsbCwKICAgICAgICAgICAgbnVsbCwgbnVsbCwgZmFs\nc2UsIGZhbHNlLCAwLCBMb25nLk1BWF9WQUxVRSk7CgogICAgICAgIENvbm5l\nY3Rpb24gY29ubiA9IGdldENvbm5lY3Rpb24oKTsKICAgICAgICBQcmVwYXJl\nZFN0YXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgUmVzdWx0U2V0IHJz\nID0gbnVsbDsKICAgICAgICBib29sZWFuIHdhc0F1dG8gPSB0cnVlOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHdhc0F1dG8gPSBjb25uLmdldEF1dG9D\nb21taXQoKTsKICAgICAgICAgICAgaWYgKCF3YXNBdXRvKQogICAgICAgICAg\nICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KHRydWUpOwoKICAgICAgICAgICAg\nc3RtbnQgPSBzZWxlY3QucHJlcGFyZVN0YXRlbWVudChjb25uKTsKICAgICAg\nICAgICAgZGljdC5zZXRRdWVyeVRpbWVvdXQoc3RtbnQsIF9jb25mLmdldFF1\nZXJ5VGltZW91dCgpKTsKICAgICAgICAgICAgcnMgPSBzdG1udC5leGVjdXRl\nUXVlcnkoKTsKICAgICAgICAgICAgcnMubmV4dCgpOwogICAgICAgICAgICBT\ndHJpbmcgc2NoZW1hID0gKF9zY2hlbWFDb2x1bW4uZ2V0VHlwZSgpID09IFR5\ncGVzLkNMT0IpID8KICAgICAgICAgICAgICAgIGRpY3QuZ2V0Q2xvYlN0cmlu\nZyhycywgMSkgOiBkaWN0LmdldFN0cmluZyhycywgMSk7CiAgICAgICAgICAg\nIHJldHVybiBzY2hlbWE7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgaWYgKHJzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgIHJzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCF3YXNBdXRvKQogICAg\nICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KGZhbHNlKTsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXcml0ZXMg\ndGhlIHNjaGVtYSBhcyBhIHN0cmluZyB0byB0aGUgZGF0YWJhc2UuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHdyaXRlU2NoZW1hQ29sdW1uKFN0cmluZyBz\nY2hlbWEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nLy8gYWx3YXlzIHVzZSBzcGVjaWFsIGNsb2IgaGFuZGxpbmcgd2hlbiBkaWN0\nIGhhcyBtYXggZW1iZWRkZWQgc2l6ZTsKICAgICAgICAvLyBmb3Igc29tZSBy\nZWFzb24gb3B0aW1pemluZyBmb3Igc3RyaW5nIGxlbmd0aCBjYXVzZXMgZXJy\nb3JzCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRp\nY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIGJvb2xlYW4gZW1iZWRkZWQg\nPSBkaWN0Lm1heEVtYmVkZGVkQ2xvYlNpemUgPT0gLTE7CiAgICAgICAgU3Ry\naW5nIHVwZGF0ZTsKICAgICAgICBpZiAoZW1iZWRkZWQpCiAgICAgICAgICAg\nIHVwZGF0ZSA9ICJVUERBVEUgIiArIGRpY3QuZ2V0RnVsbE5hbWUoX3BrQ29s\ndW1uLmdldFRhYmxlKCksIGZhbHNlKQogICAgICAgICAgICAgICAgKyAiIFNF\nVCAiICsgZGljdC5nZXRDb2x1bW5EQk5hbWUoX3NjaGVtYUNvbHVtbikgKyAi\nID0gPyAgV0hFUkUgIiArCiAgICAgICAgICAgICAgICBkaWN0LmdldENvbHVt\nbklkZW50aWZpZXIoX3BrQ29sdW1uKSArICIgPSA/IjsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIHVwZGF0ZSA9ICJTRUxFQ1QgIiArIGRpY3QuZ2V0Q29s\ndW1uREJOYW1lKF9zY2hlbWFDb2x1bW4pICsgIiBGUk9NICIKICAgICAgICAg\nICAgICAgICsgZGljdC5nZXRGdWxsTmFtZShfcGtDb2x1bW4uZ2V0VGFibGUo\nKSwgZmFsc2UpCiAgICAgICAgICAgICAgICArICIgV0hFUkUgIiArIGRpY3Qu\nZ2V0Q29sdW1uREJOYW1lKF9wa0NvbHVtbikgKyAiID0gPyI7CgogICAgICAg\nIENvbm5lY3Rpb24gY29ubiA9IGdldENvbm5lY3Rpb24oKTsKICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgUmVzdWx0\nU2V0IHJzID0gbnVsbDsKICAgICAgICBib29sZWFuIHdhc0F1dG8gPSB0cnVl\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGlmIGVtYmVkZGVkIHdl\nIHdhbnQgYXV0b2NvbW1pdCB0cnVlLCBlbHNlIGZhbHNlCiAgICAgICAgICAg\nIHdhc0F1dG8gPSBjb25uLmdldEF1dG9Db21taXQoKTsKICAgICAgICAgICAg\naWYgKHdhc0F1dG8gIT0gZW1iZWRkZWQpCiAgICAgICAgICAgICAgICBjb25u\nLnNldEF1dG9Db21taXQoZW1iZWRkZWQpOwoKICAgICAgICAgICAgaWYgKGVt\nYmVkZGVkKSB7CiAgICAgICAgICAgICAgICBzdG1udCA9IGNvbm4ucHJlcGFy\nZVN0YXRlbWVudCh1cGRhdGUpOwogICAgICAgICAgICAgICAgaWYgKHNjaGVt\nYSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIGRpY3Quc2V0TnVsbChz\ndG1udCwgMSwgX3NjaGVtYUNvbHVtbi5nZXRUeXBlKCksCiAgICAgICAgICAg\nICAgICAgICAgICAgIF9zY2hlbWFDb2x1bW4pOwogICAgICAgICAgICAgICAg\nZWxzZSBpZiAoX3NjaGVtYUNvbHVtbi5nZXRUeXBlKCkgPT0gVHlwZXMuQ0xP\nQikKICAgICAgICAgICAgICAgICAgICBkaWN0LnNldENsb2JTdHJpbmcoc3Rt\nbnQsIDEsIHNjaGVtYSwgX3NjaGVtYUNvbHVtbik7CiAgICAgICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZGljdC5zZXRTdHJpbmcoc3Rt\nbnQsIDEsIHNjaGVtYSwgX3NjaGVtYUNvbHVtbik7CiAgICAgICAgICAgICAg\nICBkaWN0LnNldEludChzdG1udCwgMiwgMSwgX3BrQ29sdW1uKTsKICAgICAg\nICAgICAgICAgIGRpY3Quc2V0VGltZW91dHMoc3RtbnQsIF9jb25mLCB0cnVl\nKTsKICAgICAgICAgICAgICAgIHN0bW50LmV4ZWN1dGVVcGRhdGUoKTsKICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0bW50ID0gY29u\nbi5wcmVwYXJlU3RhdGVtZW50KHVwZGF0ZSwKICAgICAgICAgICAgICAgICAg\nICBSZXN1bHRTZXQuVFlQRV9TQ1JPTExfSU5TRU5TSVRJVkUsCiAgICAgICAg\nICAgICAgICAgICAgUmVzdWx0U2V0LkNPTkNVUl9VUERBVEFCTEUpOwogICAg\nICAgICAgICAgICAgZGljdC5zZXRJbnQoc3RtbnQsIDEsIDEsIF9wa0NvbHVt\nbik7CiAgICAgICAgICAgICAgICBkaWN0LnNldFRpbWVvdXRzKHN0bW50LCBf\nY29uZiwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBycyA9IHN0bW50LmV4ZWN1\ndGVRdWVyeSgpOwogICAgICAgICAgICAgICAgcnMubmV4dCgpOwogICAgICAg\nICAgICAgICAgZGljdC5wdXRTdHJpbmcocnMuZ2V0Q2xvYigxKSwgc2NoZW1h\nKTsKICAgICAgICAgICAgICAgIGNvbm4uY29tbWl0KCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGlm\nIChycyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICBycy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICBzdG1udC5jbG9zZSgpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIGlmICh3YXNBdXRvICE9IGVtYmVkZGVk\nKQogICAgICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KHdhc0F1dG8p\nOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29ubi5jbG9z\nZSgpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIENyZWF0ZXMgdGhlIG9iamVjdC1sZXZlbCByZXByZXNlbnRhdGlvbiBvZiB0\naGUgc2VxdWVuY2UgdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBi\ndWlsZFRhYmxlKCkgewogICAgICAgIFF1YWxpZmllZERCSWRlbnRpZmllciBw\nYXRoID0gUXVhbGlmaWVkREJJZGVudGlmaWVyLmdldFBhdGgoX3RhYmxlKTsK\nICAgICAgICBEQklkZW50aWZpZXIgdGFibGVOYW1lID0gcGF0aC5nZXRJZGVu\ndGlmaWVyKCk7CiAgICAgICAgREJJZGVudGlmaWVyIHNjaGVtYU5hbWUgPSBw\nYXRoLmdldFNjaGVtYU5hbWUoKTsKICAgICAgICBpZiAoREJJZGVudGlmaWVy\nLmlzRW1wdHkoc2NoZW1hTmFtZSkpCiAgICAgICAgICAgIHNjaGVtYU5hbWUg\nPSBTY2hlbWFzLmdldE5ld1RhYmxlU2NoZW1hSWRlbnRpZmllcihfY29uZik7\nCgogICAgICAgIC8vIGJ1aWxkIHRoZSB0YWJsZSBpbiBvbmUgb2YgdGhlIGRl\nc2lnbmF0ZWQgc2NoZW1hcwogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0g\nbmV3IFNjaGVtYUdyb3VwKCk7CiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdy\nb3VwLmFkZFNjaGVtYShzY2hlbWFOYW1lKTsKCiAgICAgICAgVGFibGUgdGFi\nbGUgPSBzY2hlbWEuYWRkVGFibGUodGFibGVOYW1lKTsKICAgICAgICBQcmlt\nYXJ5S2V5IHBrID0gdGFibGUuYWRkUHJpbWFyeUtleSgpOwoKICAgICAgICBE\nQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUluc3Rh\nbmNlKCk7CiAgICAgICAgX3BrQ29sdW1uID0gdGFibGUuYWRkQ29sdW1uKGRp\nY3QuZ2V0VmFsaWRDb2x1bW5OYW1lCiAgICAgICAgICAgIChfcGtDb2x1bW5O\nYW1lLCB0YWJsZSkpOwogICAgICAgIF9wa0NvbHVtbi5zZXRUeXBlKGRpY3Qu\nZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5USU5ZSU5UKSk7CiAgICAgICAgX3Br\nQ29sdW1uLnNldEphdmFUeXBlKEphdmFUeXBlcy5JTlQpOwogICAgICAgIHBr\nLmFkZENvbHVtbihfcGtDb2x1bW4pOwoKICAgICAgICBfc2NoZW1hQ29sdW1u\nID0gdGFibGUuYWRkQ29sdW1uKGRpY3QuZ2V0VmFsaWRDb2x1bW5OYW1lCiAg\nICAgICAgICAgIChfc2NoZW1hQ29sdW1uTmFtZSwgdGFibGUpKTsKICAgICAg\nICBfc2NoZW1hQ29sdW1uLnNldFR5cGUoZGljdC5nZXRQcmVmZXJyZWRUeXBl\nKFR5cGVzLkNMT0IpKTsKICAgICAgICBfc2NoZW1hQ29sdW1uLnNldEphdmFU\neXBlKEphdmFUeXBlcy5TVFJJTkcpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIGEgY29ubmVjdGlvbiB0byB1c2UuCiAgICAgKi8KICAgIHByaXZh\ndGUgQ29ubmVjdGlvbiBnZXRDb25uZWN0aW9uKCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gX2NvbmYuZ2V0RGF0YVNv\ndXJjZTIobnVsbCkuZ2V0Q29ubmVjdGlvbigpOwogICAgfQoKICAgIC8vLy8v\nLy8vLwogICAgLy8gTWFpbgogICAgLy8vLy8vLy8vCgogICAgLyoqCiAgICAg\nKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEu\nVGFibGVTY2hlbWFGYWN0b3J5CiAgICAgKiBbb3B0aW9uXSogLWFjdGlvbi8t\nYSAmbHQ7YWRkIHwgZHJvcCZndDsKICAgICAqICBXaGVyZSB0aGUgZm9sbG93\naW5nIG9wdGlvbnMgYXJlIHJlY29nbml6ZWQuCiAgICAgKiA8dWw+CiAgICAg\nKiA8bGk+PGk+LXByb3BlcnRpZXMvLXAgJmx0O3Byb3BlcnRpZXMgZmlsZSBv\nciByZXNvdXJjZSZndDs8L2k+OiBUaGUKICAgICAqIHBhdGggb3IgcmVzb3Vy\nY2UgbmFtZSBvZiBhIE9wZW5KUEEgcHJvcGVydGllcyBmaWxlIGNvbnRhaW5p\nbmcKICAgICAqIGluZm9ybWF0aW9uIHN1Y2ggYXMgdGhlIGxpY2Vuc2Uga2V5\nCWFuZCBjb25uZWN0aW9uIGRhdGEgYXMKICAgICAqIG91dGxpbmVkIGluIHtA\nbGluayBKREJDQ29uZmlndXJhdGlvbn0uIE9wdGlvbmFsLjwvbGk+CiAgICAg\nKiA8bGk+PGk+LSZsdDtwcm9wZXJ0eSBuYW1lJmd0OyAmbHQ7cHJvcGVydHkg\ndmFsdWUmZ3Q7PC9pPjogQWxsIGJlYW4KICAgICAqIHByb3BlcnRpZXMgb2Yg\ndGhlIE9wZW5KUEEge0BsaW5rIEpEQkNDb25maWd1cmF0aW9ufSBjYW4gYmUg\nc2V0IGJ5CiAgICAgKiB1c2luZyB0aGVpcgluYW1lcyBhbmQgc3VwcGx5aW5n\nIGEgdmFsdWUuIEZvciBleGFtcGxlOgogICAgICogPGNvZGU+LWxpY2Vuc2VL\nZXkgYWRzbGZqYTgzcjNsa2FkZjwvY29kZT48L2xpPgogICAgICogPC91bD4K\nICAgICAqICBUaGUgdmFyaW91cyBhY3Rpb25zIGFyZSBhcyBmb2xsb3dzLgog\nICAgICogPHVsPgogICAgICogPGxpPjxpPmFkZDwvaT46IENyZWF0ZSB0aGUg\nc2NoZW1hIHRhYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+ZHJvcDwvaT46IERy\nb3AgdGhlIHNjaGVtYSB0YWJsZS48L2xpPgogICAgICogPC91bD4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykK\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgT3B0aW9ucyBvcHRzID0gbmV3IE9wdGlvbnMoKTsKICAgICAgICBm\naW5hbCBTdHJpbmdbXSBhcmd1bWVudHMgPSBvcHRzLnNldEZyb21DbWRMaW5l\nKGFyZ3MpOwogICAgICAgIGJvb2xlYW4gcmV0ID0gQ29uZmlndXJhdGlvbnMu\ncnVuQWdhaW5zdEFsbEFuY2hvcnMob3B0cywKICAgICAgICAgICAgbmV3IENv\nbmZpZ3VyYXRpb25zLlJ1bm5hYmxlKCkgewogICAgICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBydW4oT3B0aW9ucyBvcHRzKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcg\nSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIHJldHVybiBUYWJsZVNjaGVtYUZhY3Rv\ncnkucnVuKGNvbmYsIGFyZ3VtZW50cywgb3B0cyk7CiAgICAgICAgICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGNvbmYuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0p\nOwogICAgICAgIGlmICghcmV0KQogICAgICAgICAgICBTeXN0ZW0ub3V0LnBy\naW50bG4oX2xvYy5nZXQoInNjaC11c2FnZSIpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJucyBmYWxzZSBpZiBpbnZhbGlk\nIG9wdGlvbnMgd2VyZSBnaXZlbi4KICAgICAqCiAgICAgKiBAc2VlICNtYWlu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0Nv\nbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRp\nb25zIG9wdHMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNl\ncHRpb24gewogICAgICAgIFN0cmluZyBhY3Rpb24gPSBvcHRzLnJlbW92ZVBy\nb3BlcnR5KCJhY3Rpb24iLCAiYSIsIG51bGwpOwogICAgICAgIENvbmZpZ3Vy\nYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihjb25mLCBvcHRzKTsKICAg\nICAgICByZXR1cm4gcnVuKGNvbmYsIGFjdGlvbik7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSdW4gdGhlIHRvb2wuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5n\nIGFjdGlvbikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLy8gcnVuIHRoZSBhY3Rpb24KICAgICAgICBUYWJs\nZVNjaGVtYUZhY3RvcnkgZmFjdG9yeSA9IG5ldyBUYWJsZVNjaGVtYUZhY3Rv\ncnkoKTsKICAgICAgICBTdHJpbmcgcHJvcHMgPSBDb25maWd1cmF0aW9ucy5n\nZXRQcm9wZXJ0aWVzKGNvbmYuZ2V0U2NoZW1hRmFjdG9yeSgpKTsKICAgICAg\nICBDb25maWd1cmF0aW9ucy5jb25maWd1cmVJbnN0YW5jZShmYWN0b3J5LCBj\nb25mLCBwcm9wcyk7CgogICAgICAgIGlmIChBQ1RJT05fRFJPUC5lcXVhbHMo\nYWN0aW9uKSkKICAgICAgICAgICAgZmFjdG9yeS5kcm9wVGFibGUoKTsKICAg\nICAgICBlbHNlIGlmIChBQ1RJT05fQURELmVxdWFscyhhY3Rpb24pKQogICAg\nICAgICAgICBmYWN0b3J5LnJlZnJlc2hUYWJsZSgpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQp9Cg==\n","encoding":"base64"}

