{"sha":"2daa460771cafb6118bc024b1f09aa0a2ba61e2d","node_id":"MDQ6QmxvYjIwNjM2NDoyZGFhNDYwNzcxY2FmYjYxMThiYzAyNGIxZjA5YWEwYTJiYTYxZTJk","size":19465,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2daa460771cafb6118bc024b1f09aa0a2ba61e2d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBq\nYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsK\naW1wb3J0IGphdmEudGV4dC5NZXNzYWdlRm9ybWF0OwppbXBvcnQgamF2YS51\ndGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZh\nLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLnJlZ2V4Lk1hdGNoZXI7Cmlt\ncG9ydCBqYXZhLnV0aWwucmVnZXguUGF0dGVybjsKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyLkRCSWRlbnRpZmllcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkZpbHRl\nclZhbHVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5Gb3JlaWduS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLkluZGV4OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLlNlcXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLlVuaXF1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuaWRlbnRpZmllci5JZGVudGlmaWVyVXRpbDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5TdG9yZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLlVuc3VwcG9ydGVkRXhjZXB0aW9uOwoKLyoq\nCiAqIERpY3Rpb25hcnkgZm9yIEZpcmViaXJkLiBTdXBwb3J0cyBGaXJlYmly\nZCB2ZXJzaW9ucyAxLjUsIDIuMCBhbmQgMi4xLgogKi8KcHVibGljIGNsYXNz\nIEZpcmViaXJkRGljdGlvbmFyeQogICAgZXh0ZW5kcyBEQkRpY3Rpb25hcnkg\newoKICAgIHB1YmxpYyBpbnQgZmlyZWJpcmRWZXJzaW9uID0gMDsKICAgIHB1\nYmxpYyBpbnQgaW5kZXhlZFZhcmNoYXJNYXhTaXplRkIxNSA9IDI1MjsKICAg\nIHB1YmxpYyBTdHJpbmcgcmFuZ2VTeW50YXggPSBudWxsOwogICAgcHJvdGVj\ndGVkIGxvbmcgbWF4Um93TnVtYmVySW5SYW5nZSA9IDE2MDAwMDAwMDAwTDsK\nCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGFsdGVyU2VxdWVuY2VTUUxGQjE1ID0g\nIlNFVCBHRU5FUkFUT1IgezB9IFRPIHsxfSI7CiAgICBwcm90ZWN0ZWQgU3Ry\naW5nIGFsdGVyU2VxdWVuY2VTUUxGQjIwID0KICAgICAgICAiQUxURVIgU0VR\nVUVOQ0UgezB9IFJFU1RBUlQgV0lUSCB7MX0iOwogICAgcHJvdGVjdGVkIFN0\ncmluZyBjcmVhdGVTZXF1ZW5jZVNRTEZCMTUgPSAiQ1JFQVRFIEdFTkVSQVRP\nUiB7MH0iOwogICAgcHJvdGVjdGVkIFN0cmluZyBjcmVhdGVTZXF1ZW5jZVNR\nTEZCMjAgPSAiQ1JFQVRFIFNFUVVFTkNFIHswfSI7CiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIGRyb3BTZXF1ZW5jZVNRTEZCMTUgPSAiRFJPUCBHRU5FUkFUT1Ig\nIjsKICAgIHByb3RlY3RlZCBTdHJpbmcgbmV4dFNlcXVlbmNlUXVlcnlGQjE1\nID0KICAgICAgICAiU0VMRUNUIEdFTl9JRCh7MH0sIDEpIEZST00gUkRCJERB\nVEFCQVNFIjsKICAgIHByb3RlY3RlZCBTdHJpbmcgbmV4dFNlcXVlbmNlUXVl\ncnlGQjIwID0KICAgICAgICAiU0VMRUNUIE5FWFQgVkFMVUUgRk9SIHswfSBG\nUk9NIFJEQiREQVRBQkFTRSI7CgogICAgcHJvdGVjdGVkIFN0cmluZyBhbHRl\nclNlcXVlbmNlU1FMID0gYWx0ZXJTZXF1ZW5jZVNRTEZCMjA7CiAgICBwcm90\nZWN0ZWQgU3RyaW5nIGNyZWF0ZVNlcXVlbmNlU1FMID0gY3JlYXRlU2VxdWVu\nY2VTUUxGQjIwOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEZCX1ZF\nUlNJT05fMTUgPSAxNTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEZC\nX1ZFUlNJT05fMjAgPSAyMDsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIEZCX1ZFUlNJT05fMjEgPSAyMTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBSQU5HRV9TWU5UQVhfRklSU1RfU0tJUCA9ICJmaXJzdHNraXAi\nOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgUkFOR0VfU1lOVEFY\nX1JPV1MgPSAicm93cyI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPQogICAgICAgIExvY2FsaXplci5mb3JQYWNrYWdlKEZp\ncmViaXJkRGljdGlvbmFyeS5jbGFzcyk7CgogICAgQFN1cHByZXNzV2Fybmlu\nZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgRmlyZWJpcmREaWN0aW9uYXJ5\nKCkgewogICAgICAgIHBsYXRmb3JtID0gIkZpcmViaXJkIjsKICAgICAgICB2\nYWxpZGF0aW9uU1FMID0gIlNFTEVDVCAxIEZST00gUkRCJERBVEFCQVNFIjsK\nICAgICAgICBzdXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMgPSBmYWxzZTsK\nCiAgICAgICAgdXNlR2V0U3RyaW5nRm9yQ2xvYnMgPSB0cnVlOwogICAgICAg\nIHVzZVNldFN0cmluZ0ZvckNsb2JzID0gdHJ1ZTsKICAgICAgICB1c2VHZXRC\neXRlc0ZvckJsb2JzID0gdHJ1ZTsKICAgICAgICB1c2VTZXRCeXRlc0ZvckJs\nb2JzID0gdHJ1ZTsKCiAgICAgICAgbWF4VGFibGVOYW1lTGVuZ3RoID0gMzE7\nCiAgICAgICAgbWF4Q29sdW1uTmFtZUxlbmd0aCA9IDMxOwogICAgICAgIG1h\neENvbnN0cmFpbnROYW1lTGVuZ3RoID0gMzE7CiAgICAgICAgbWF4SW5kZXhO\nYW1lTGVuZ3RoID0gMzE7CgogICAgICAgIHN1cHBvcnRzU2VsZWN0U3RhcnRJ\nbmRleCA9IHRydWU7CiAgICAgICAgc3VwcG9ydHNTZWxlY3RFbmRJbmRleCA9\nIHRydWU7CgogICAgICAgIHN1cHBvcnRzTXVsdGlwbGVOb250cmFuc2FjdGlv\nbmFsUmVzdWx0U2V0cyA9IGZhbHNlOwoKICAgICAgICBuZXh0U2VxdWVuY2VR\ndWVyeSA9IG5leHRTZXF1ZW5jZVF1ZXJ5RkIyMDsKICAgICAgICBzZXF1ZW5j\nZVNRTCA9CiAgICAgICAgICAgICJTRUxFQ1QgTlVMTCBBUyBTRVFVRU5DRV9T\nQ0hFTUEsIFJEQiRHRU5FUkFUT1JfTkFNRSAiCiAgICAgICAgICAgICAgICAr\nICJBUyBTRVFVRU5DRV9OQU1FIEZST00gUkRCJEdFTkVSQVRPUlMgIgogICAg\nICAgICAgICAgICAgKyAiV0hFUkUgKFJEQiRTWVNURU1fRkxBRyBJUyBOVUxM\nIE9SIFJEQiRTWVNURU1fRkxBRyA9IDApICI7CiAgICAgICAgc2VxdWVuY2VO\nYW1lU1FMID0gIkFORCBSREIkR0VORVJBVE9SX05BTUUgPSA/IjsKCiAgICAg\nICAgLy8gQSByb3VnaCBzdW0gb2YgcmVzZXJ2ZWQgd29yZHMgaW4gRmlyZWJp\ncmQgMS4wIC0gMi4xLgogICAgICAgIHJlc2VydmVkV29yZFNldC5hZGRBbGwo\nQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW10geyAiQUNUSVZFIiwgIkFETUlO\nIiwKICAgICAgICAgICAgIkFGVEVSIiwgIkFTQ0VORElORyIsICJBVVRPIiwg\nIkFVVE9EREwiLCAiQkFTRUQiLCAiQkFTRU5BTUUiLAogICAgICAgICAgICAi\nQkFTRV9OQU1FIiwgIkJFRk9SRSIsICJCSUdJTlQiLCAiQkxPQiIsICJCTE9C\nRURJVCIsICJCVUZGRVIiLAogICAgICAgICAgICAiQ0FDSEUiLCAiQ0hFQ0tf\nUE9JTlRfTEVOIiwgIkNIRUNLX1BPSU5UX0xFTkdUSCIsICJDT01QSUxFVElN\nRSIsCiAgICAgICAgICAgICJDT01QVVRFRCIsICJDTE9TRSIsICJDT05ESVRJ\nT05BTCIsICJDT05UQUlOSU5HIiwgIkNTVFJJTkciLAogICAgICAgICAgICAi\nQ1VSUkVOVF9DT05ORUNUSU9OIiwgIkNVUlJFTlRfUk9MRSIsICJDVVJSRU5U\nX1RSQU5TQUNUSU9OIiwKICAgICAgICAgICAgIkRBVEFCQVNFIiwgIkRCX0tF\nWSIsICJERUJVRyIsICJERVNDRU5ESU5HIiwgIkRPIiwgIkVDSE8iLCAiRURJ\nVCIsCiAgICAgICAgICAgICJFTlRSWV9QT0lOVCIsICJFVkVOVCIsICJFWElU\nIiwgIkVYVEVSTiIsICJGSUxFIiwgIkZJTFRFUiIsCiAgICAgICAgICAgICJG\nUkVFX0lUIiwgIkZVTkNUSU9OIiwgIkdEU0NPREUiLCAiR0VORVJBVE9SIiwg\nIkdFTl9JRCIsICJHTE9CQUwiLAogICAgICAgICAgICAiR09UTyIsICJHUk9V\nUF9DT01NSVRfV0FJVCIsICJHUk9VUF9DT01NSVRfV0FJVF9USU1FIiwgIkhF\nTFAiLAogICAgICAgICAgICAiSUYiLCAiSU5BQ1RJVkUiLCAiSU5ERVgiLCAi\nSU5JVCIsICJJTlBVVF9UWVBFIiwgIklTUUwiLAogICAgICAgICAgICAiTENf\nTUVTU0FHRVMiLCAiTENfVFlQRSIsICJMRVYiLCAiTE9HRklMRSIsICJMT0df\nQlVGRkVSX1NJWkUiLAogICAgICAgICAgICAiTE9HX0JVRl9TSVpFIiwgIkxP\nTkciLCAiTUFOVUFMIiwgIk1BWElNVU0iLCAiTUFYSU1VTV9TRUdNRU5UIiwK\nICAgICAgICAgICAgIk1BWF9TRUdNRU5UIiwgIk1FUkdFIiwgIk1FU1NBR0Ui\nLCAiTUlOVVRFIiwgIk1PRFVMRV9OQU1FIiwKICAgICAgICAgICAgIk5PQVVU\nTyIsICJOVU1fTE9HX0JVRlMiLCAiTlVNX0xPR19CVUZGRVJTIiwgIk9VVFBV\nVF9UWVBFIiwKICAgICAgICAgICAgIk9WRVJGTE9XIiwgIlBBR0UiLCAiUEFH\nRUxFTkdUSCIsICJQQUdFUyIsICJQQUdFX1NJWkUiLAogICAgICAgICAgICAi\nUEFSQU1FVEVSIiwgIlBBU1NXT1JEIiwgIlBMQU4iLCAiUE9TVF9FVkVOVCIs\nICJQUk9DRURVUkUiLAogICAgICAgICAgICAiUFJPVEVDVEVEIiwgIlFVSVQi\nLCAiUkFXX1BBUlRJVElPTlMiLCAiUkRCJERCX0tFWSIsCiAgICAgICAgICAg\nICJSRUNPUkRfVkVSU0lPTiIsICJSRUNSRUFURSIsICJSRUxFQVNFIiwgIlJF\nU0VSViIsICJSRVNFUlZJTkciLAogICAgICAgICAgICAiUkVUQUlOIiwgIlJF\nVFVSTiIsICJSRVRVUk5JTkdfVkFMVUVTIiwgIlJFVFVSTlMiLCAiUk9MRSIs\nCiAgICAgICAgICAgICJSVU5USU1FIiwgIlNBVkVQT0lOVCIsICJTRUdNRU5U\nIiwgIlNIQURPVyIsICJTSEFSRUQiLCAiU0hFTEwiLAogICAgICAgICAgICAi\nU0hPVyIsICJTSU5HVUxBUiIsICJTTkFQU0hPVCIsICJTT1JUIiwgIlNRTFdB\nUk5JTkciLCAiU1RBQklMSVRZIiwKICAgICAgICAgICAgIlNUQVJUIiwgIlNU\nQVJUSU5HIiwgIlNUQVJUUyIsICJTVEFURU1FTlQiLCAiU1RBVElDIiwgIlNU\nQVRJU1RJQ1MiLAogICAgICAgICAgICAiU1VCX1RZUEUiLCAiU1VTUEVORCIs\nICJURVJNSU5BVE9SIiwgIlRSSUdHRVIiLCAiVkFSSUFCTEUiLAogICAgICAg\nICAgICAiVkVSU0lPTiIsICJXQUlUIiwgIldFRUtEQVkiLCAiV0hJTEUiIH0p\nKTsKCiAgICAgICAgYmluYXJ5VHlwZU5hbWUgPSAiQkxPQiI7CiAgICAgICAg\nYml0VHlwZU5hbWUgPSAiU01BTExJTlQiOwogICAgICAgIGNoYXJUeXBlTmFt\nZSA9ICJDSEFSKDEpIjsKICAgICAgICBjbG9iVHlwZU5hbWUgPSAiQkxPQiBT\nVUJfVFlQRSAxIjsKICAgICAgICBkb3VibGVUeXBlTmFtZSA9ICJET1VCTEUg\nUFJFQ0lTSU9OIjsKICAgICAgICBmbG9hdFR5cGVOYW1lID0gIkRPVUJMRSBQ\nUkVDSVNJT04iOwogICAgICAgIGxvbmdWYXJiaW5hcnlUeXBlTmFtZSA9ICJC\nTE9CIjsKICAgICAgICBsb25nVmFyY2hhclR5cGVOYW1lID0gIkJMT0IgU1VC\nX1RZUEUgMSI7CiAgICAgICAgcmVhbFR5cGVOYW1lID0gIkZMT0FUIjsKICAg\nICAgICBzbWFsbGludFR5cGVOYW1lID0gIlNNQUxMSU5UIjsKICAgICAgICB0\naW55aW50VHlwZU5hbWUgPSAiU01BTExJTlQiOwogICAgICAgIHZhcmJpbmFy\neVR5cGVOYW1lID0gIkJMT0IiOwoKICAgICAgICBzdXBwb3J0c0xvY2tpbmdX\naXRoRGlzdGluY3RDbGF1c2UgPSBmYWxzZTsKICAgICAgICBzdXBwb3J0c0xv\nY2tpbmdXaXRoTXVsdGlwbGVUYWJsZXMgPSBmYWxzZTsKICAgICAgICBzdXBw\nb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2luID0gZmFsc2U7CiAgICAgICAgc3Vw\ncG9ydHNMb2NraW5nV2l0aElubmVySm9pbiA9IGZhbHNlOwogICAgICAgIGZv\nclVwZGF0ZUNsYXVzZSA9ICJGT1IgVVBEQVRFIFdJVEggTE9DSyI7CiAgICAg\nICAgc3VwcG9ydHNRdWVyeVRpbWVvdXQgPSBmYWxzZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIERldGVybWluZSBGaXJlYmlyZCB2ZXJzaW9uIGFuZCBjb25m\naWd1cmUgaXRzZWxmIGFjY29yZGluZ2x5LgogICAgICovCiAgICBAU3VwcHJl\nc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIHZvaWQgY29ubmVjdGVkQ29uZmlndXJhdGlvbihDb25uZWN0aW9uIGNv\nbm4pIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN1cGVyLmNvbm5l\nY3RlZENvbmZpZ3VyYXRpb24oY29ubik7CiAgICAgICAgZmlyZWJpcmRWZXJz\naW9uID0gZGV0ZXJtaW5lRmlyZWJpcmRWZXJzaW9uKGNvbm4pOwogICAgICAg\nIGRldGVybWluZVJhbmdlU3ludGF4KCk7CgogICAgICAgIGlmIChmaXJlYmly\nZFZlcnNpb24gPT0gRkJfVkVSU0lPTl8yMSkKICAgICAgICAgICAgc2VsZWN0\nV29yZFNldC5hZGQoIldJVEgiKTsKICAgICAgICBpZiAoIShmaXJlYmlyZFZl\ncnNpb24gPT0gRkJfVkVSU0lPTl8yMSkpIHsKICAgICAgICAgICAgY3Jvc3NK\nb2luQ2xhdXNlID0gIkpPSU4iOwogICAgICAgICAgICByZXF1aXJlc0NvbmRp\ndGlvbkZvckNyb3NzSm9pbiA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlm\nIChmaXJlYmlyZFZlcnNpb24gPT0gRkJfVkVSU0lPTl8xNSkgewogICAgICAg\nICAgICBzdHJpbmdMZW5ndGhGdW5jdGlvbiA9ICJTVFJMRU4oezB9KSI7CiAg\nICAgICAgICAgIHRyaW1MZWFkaW5nRnVuY3Rpb24gPSAiTFRSSU0oezB9KSI7\nCiAgICAgICAgICAgIHRyaW1UcmFpbGluZ0Z1bmN0aW9uID0gIlJUUklNKHsw\nfSkiOwogICAgICAgICAgICB0cmltQm90aEZ1bmN0aW9uID0gIkxUUklNKFJU\nUklNKHswfSkpIjsKICAgICAgICAgICAgYWx0ZXJTZXF1ZW5jZVNRTCA9IGFs\ndGVyU2VxdWVuY2VTUUxGQjE1OwogICAgICAgICAgICBjcmVhdGVTZXF1ZW5j\nZVNRTCA9IGNyZWF0ZVNlcXVlbmNlU1FMRkIxNTsKICAgICAgICAgICAgbmV4\ndFNlcXVlbmNlUXVlcnkgPSBuZXh0U2VxdWVuY2VRdWVyeUZCMTU7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogVXNlIGVpdGhlciA8Y29kZT5G\nSVJTVCAmbHQ7cCZndDsgU0tJUCAmbHQ7cSZndDs8L2NvZGU+IG9yCiAgICAg\nKiA8Y29kZT5ST1dTICZsdDttJmd0OyBUTyAmbHQ7biZndDs8L2NvZGU+IHN5\nbnRheC4gSWYgPGNvZGU+Uk9XUzwvY29kZT4KICAgICAqIHZhcmlhbnQgaXMg\ndXNlZCBhbmQgPGNvZGU+ZW5kPC9jb2RlPiBlcXVhbHMge0BsaW5rIExvbmcj\nTUFYX1ZBTFVFfSwgYQogICAgICogY29uc3RhbnQgaXMgdXNlZCBhcyA8Y29k\nZT4mbHQ7biZndDs8L2NvZGU+IHZhbHVlLgogICAgICovCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCB2b2lkIGFwcGVuZFNlbGVjdFJhbmdlKFNRTEJ1\nZmZlciBidWYsIGxvbmcgc3RhcnQsIGxvbmcgZW5kLAogICAgICAgIGJvb2xl\nYW4gc3Vic2VsZWN0KSB7CiAgICAgICAgaWYgKFJBTkdFX1NZTlRBWF9GSVJT\nVF9TS0lQLmVxdWFscyhyYW5nZVN5bnRheCkpIHsKICAgICAgICAgICAgaWYg\nKGVuZCAhPSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoIiBGSVJTVCAiKS5hcHBlbmRWYWx1ZShlbmQgLSBzdGFydCk7CiAg\nICAgICAgICAgIGlmIChzdGFydCAhPSAwKQogICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiIFNLSVAgIikuYXBwZW5kVmFsdWUoc3RhcnQpOwogICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBidWYuYXBwZW5kKCIg\nUk9XUyAiKTsKICAgICAgICBpZiAoc3RhcnQgPT0gMCkgewogICAgICAgICAg\nICBidWYuYXBwZW5kVmFsdWUoZW5kKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KCiAgICAgICAgYnVmLmFwcGVuZFZhbHVlKHN0YXJ0ICsgMSku\nYXBwZW5kKCIgVE8gIik7CiAgICAgICAgaWYgKGVuZCA9PSBMb25nLk1BWF9W\nQUxVRSkKICAgICAgICAgICAgYnVmLmFwcGVuZFZhbHVlKG1heFJvd051bWJl\nckluUmFuZ2UpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgYnVmLmFwcGVu\nZFZhbHVlKGVuZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUg\nRmlyZWJpcmQgdmVyc2lvbiBlaXRoZXIgYnkgdXNpbmcgSkRCQyAzIG1ldGhv\nZHMgb3IsIGlmIHRoZXkKICAgICAqIGFyZSBub3QgYXZhaWxhYmxlLCBieSBw\nYXJzaW5nIHRoZSB2YWx1ZSByZXR1cm5lZCBieQogICAgICoge0BsaW5rcGxh\naW4gRGF0YWJhc2VNZXRhRGF0YSNnZXREYXRhYmFzZVByb2R1Y3RWZXJzaW9u\nKCl9LiBVc2VyIGNhbgogICAgICogb3ZlcnJpZGUgRmlyZWJpcmQgdmVyc2lv\nbi4KICAgICAqLwogICAgcHJvdGVjdGVkIGludCBkZXRlcm1pbmVGaXJlYmly\nZFZlcnNpb24oQ29ubmVjdGlvbiBjb24pCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gTGV0IHVzZXIgb3ZlcnJpZGUgZmlyZWJp\ncmRWZXJzaW9uLgogICAgICAgIGlmIChmaXJlYmlyZFZlcnNpb24gIT0gMCkK\nICAgICAgICAgICAgcmV0dXJuIGZpcmViaXJkVmVyc2lvbjsKCiAgICAgICAg\nRGF0YWJhc2VNZXRhRGF0YSBtZXRhRGF0YSA9IGNvbi5nZXRNZXRhRGF0YSgp\nOwogICAgICAgIGludCBtYWogPSAwOwogICAgICAgIGludCBtaW4gPSAwOwog\nICAgICAgIGlmIChpc0pEQkMzKSB7CiAgICAgICAgICAgIG1haiA9IG1ldGFE\nYXRhLmdldERhdGFiYXNlTWFqb3JWZXJzaW9uKCk7CiAgICAgICAgICAgIG1p\nbiA9IG1ldGFEYXRhLmdldERhdGFiYXNlTWlub3JWZXJzaW9uKCk7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIC8vIFRoZSBwcm9kdWN0IHZlcnNpb24gbG9va3MgbGlrZQogICAgICAgICAg\nICAgICAgLy8gIkxJLVYyLjEuMS4xNzkxMCBGaXJlYmlyZCAyLjEsTEktVjIu\nMS4xLjE3OTEwIEZpcmViaXJkCiAgICAgICAgICAgICAgICAvLyAyLjEvdGNw\nIChob3N0bmFtZSkvUDEwIiBvcgogICAgICAgICAgICAgICAgLy8gIldJLVYx\nLjUuNS40OTI2IEZpcmViaXJkIDEuNTJXSS1WMS41LjUuNDkyNiBGaXJlYmly\nZCAxLjUvdGNwCiAgICAgICAgICAgICAgICAvLyAoaG9zdG5hbWUpL1AxMCIK\nICAgICAgICAgICAgICAgIFN0cmluZyBwcm9kdWN0VmVyc2lvbiA9IG1ldGFE\nYXRhLmdldERhdGFiYXNlUHJvZHVjdFZlcnNpb24oKTsKICAgICAgICAgICAg\nICAgIFBhdHRlcm4gcCA9IFBhdHRlcm4uY29tcGlsZSgiLiotVihcXGQpXFwu\nKFxcZClcXC4uKiIsCiAgICAgICAgICAgICAgICAgICAgUGF0dGVybi5DQVNF\nX0lOU0VOU0lUSVZFKTsKICAgICAgICAgICAgICAgIE1hdGNoZXIgbSA9IHAu\nbWF0Y2hlcihwcm9kdWN0VmVyc2lvbik7CiAgICAgICAgICAgICAgICBtLm1h\ndGNoZXMoKTsKICAgICAgICAgICAgICAgIFN0cmluZyBtYWpTdHJpbmcgPSBt\nLmdyb3VwKDEpOwogICAgICAgICAgICAgICAgU3RyaW5nIG1pblN0cmluZyA9\nIG0uZ3JvdXAoMik7CiAgICAgICAgICAgICAgICBtYWogPSBJbnRlZ2VyLnBh\ncnNlSW50KG1halN0cmluZyk7CiAgICAgICAgICAgICAgICBtaW4gPSBJbnRl\nZ2VyLnBhcnNlSW50KG1pblN0cmluZyk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCB1\nbmRlcnN0YW5kIHRoZSB2ZXJzaW9uIGZvcm1hdC4KICAgICAgICAgICAgICAg\nIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAg\nIGxvZy53YXJuKGUudG9TdHJpbmcoKSwgZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgaWYgKG1haiA8IDIpCiAgICAgICAgICAgIHJldHVy\nbiBGQl9WRVJTSU9OXzE1OwogICAgICAgIGlmIChtYWogPT0gMiAmJiBtaW4g\nPT0gMCkKICAgICAgICAgICAgcmV0dXJuIEZCX1ZFUlNJT05fMjA7CiAgICAg\nICAgcmV0dXJuIEZCX1ZFUlNJT05fMjE7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBEZXRlcm1pbmUgcmFuZ2Ugc3ludGF4IHRvIGJlIHVzZWQgZGVwZW5kaW5n\nIG9uIEZpcmViaXJkIHZlcnNpb24uCiAgICAgKiBVc2VyIGNhbiBvdmVycmlk\nZSByYW5nZSBzeW50YXguCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGRl\ndGVybWluZVJhbmdlU3ludGF4KCkgewogICAgICAgIC8vIExldCB1c2VyIG92\nZXJyaWRlIHJhbmdlU3ludGF4LgogICAgICAgIGlmIChyYW5nZVN5bnRheCA9\nPSBudWxsKQogICAgICAgICAgICByYW5nZVN5bnRheCA9CiAgICAgICAgICAg\nICAgICAoZmlyZWJpcmRWZXJzaW9uID09IEZCX1ZFUlNJT05fMTUpID8gUkFO\nR0VfU1lOVEFYX0ZJUlNUX1NLSVAKICAgICAgICAgICAgICAgICAgICA6IFJB\nTkdFX1NZTlRBWF9ST1dTOwoKICAgICAgICBpZiAoUkFOR0VfU1lOVEFYX0ZJ\nUlNUX1NLSVAuZXF1YWxzKHJhbmdlU3ludGF4KSkKICAgICAgICAgICAgcmFu\nZ2VQb3NpdGlvbiA9IFJBTkdFX1BSRV9ESVNUSU5DVDsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIHJhbmdlUG9zaXRpb24gPSBSQU5HRV9QT1NUX1NFTEVD\nVDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiA8Y29kZT4mbHQ7dmFs\ndWUmZ3Q7IEFTICZsdDt0eXBlJmd0OzwvY29kZT4uCiAgICAgKi8KICAgIEBP\ndmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXRQbGFjZWhvbGRlclZhbHVl\nU3RyaW5nKENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZ2V0\nUGxhY2Vob2xkZXJWYWx1ZVN0cmluZyhjb2wpICsgIiBBUyAiCiAgICAgICAg\nICAgICsgZ2V0VHlwZU5hbWUoY29sKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiA8Y29kZT4lPC9jb2RlPiBpZiA8Y29kZT50YWJsZU5hbWU8L2Nv\nZGU+IGlzIDxjb2RlPm51bGw8L2NvZGU+LAogICAgICogb3RoZXJ3aXNlIGRl\nbGVnYXRlIHRvIHN1cGVyIGltcGxlbWVudGF0aW9uLgogICAgICovCiAgICBA\nT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0VGFibGVOYW1lRm9y\nTWV0YWRhdGEoU3RyaW5nIHRhYmxlTmFtZSkgewogICAgICAgIHJldHVybiAo\ndGFibGVOYW1lID09IG51bGwpID8gSWRlbnRpZmllclV0aWwuUEVSQ0VOVCA6\nIAogICAgICAgICAgICBnZXRUYWJsZU5hbWVGb3JNZXRhZGF0YShEQklkZW50\naWZpZXIubmV3VGFibGUodGFibGVOYW1lKSk7CiAgICB9CgogICAgcHJvdGVj\ndGVkIFN0cmluZyBnZXRUYWJsZU5hbWVGb3JNZXRhZGF0YShEQklkZW50aWZp\nZXIgdGFibGVOYW1lKSB7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051\nbGwodGFibGVOYW1lKSkgewogICAgICAgICAgICByZXR1cm4gSWRlbnRpZmll\nclV0aWwuUEVSQ0VOVDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN1cGVy\nLmdldFRhYmxlTmFtZUZvck1ldGFkYXRhKHRhYmxlTmFtZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gPGNvZGU+JTwvY29kZT4gaWYgPGNvZGU+\nY29sdW1uTmFtZTwvY29kZT4gaXMgPGNvZGU+bnVsbDwvY29kZT4sCiAgICAg\nKiBvdGhlcndpc2UgZGVsZWdhdGUgdG8gc3VwZXIgaW1wbGVtZW50YXRpb24u\nCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBn\nZXRDb2x1bW5OYW1lRm9yTWV0YWRhdGEoU3RyaW5nIGNvbHVtbk5hbWUpIHsK\nICAgICAgICByZXR1cm4gKGNvbHVtbk5hbWUgPT0gbnVsbCkgPyAiJSIgOiBz\ndXBlcgogICAgICAgICAgICAuZ2V0Q29sdW1uTmFtZUZvck1ldGFkYXRhKGNv\nbHVtbk5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuCiAgICAg\nKiA8Y29kZT5BTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFtZSZndDsgRFJPUCAm\nbHQ7Y29sIG5hbWUmZ3Q7PC9jb2RlPi4KICAgICAqLwogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RHJvcENvbHVtblNRTChDb2x1bW4g\nY29sdW1uKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXSB7ICJBTFRF\nUiBUQUJMRSAiCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUoY29sdW1uLmdl\ndFRhYmxlKCksIGZhbHNlKSArICIgRFJPUCAiICsgZ2V0Q29sdW1uREJOYW1l\nKGNvbHVtbikgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBlaXRo\nZXIKICAgICAqIDxjb2RlPkNSRUFURSBTRVFVRU5DRSAmbHQ7c2VxdWVuY2Ug\nbmFtZSZndDs8L2NvZGU+IG9yCiAgICAgKiA8Y29kZT5DUkVBVEUgR0VORVJB\nVE9SICZsdDtzZXF1ZW5jZSBuYW1lJmd0OzwvY29kZT4uCiAgICAgKiBJZiBp\nbml0aWFsIHZhbHVlIG9mIHNlcXVlbmNlIGlzIHNldCwgcmV0dXJuIGFsc28K\nICAgICAqIGFuIGFwcHJvcHJpYXRlIDxjb2RlPkFMVEVSPC9jb2RlPiBzdGF0\nZW1lbnQuCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmlu\nZ1tdIGdldENyZWF0ZVNlcXVlbmNlU1FMKFNlcXVlbmNlIHNlcSkgewogICAg\nICAgIFN0cmluZyBzZXFOYW1lID0KICAgICAgICAgICAgY2hlY2tOYW1lTGVu\nZ3RoKGdldEZ1bGxOYW1lKHNlcSksIG1heFRhYmxlTmFtZUxlbmd0aCwKICAg\nICAgICAgICAgICAgICJsb25nLXNlcS1uYW1lIik7CiAgICAgICAgU3RyaW5n\nIGNyZWF0ZVNlcSA9CiAgICAgICAgICAgIE1lc3NhZ2VGb3JtYXQuZm9ybWF0\nKGNyZWF0ZVNlcXVlbmNlU1FMLCBuZXcgT2JqZWN0W10geyBzZXFOYW1lIH0p\nOwogICAgICAgIGlmIChzZXEuZ2V0SW5pdGlhbFZhbHVlKCkgPT0gMCkKICAg\nICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXSB7IGNyZWF0ZVNlcSB9OwoK\nICAgICAgICAvLyBVc2UgU3RyaW5nLnZhbHVlT2YgdG8gZ2V0IHJpZCBvZiBw\nb3NzaWJsZSBudW1iZXIgZm9ybWF0dGluZy4KICAgICAgICBTdHJpbmcgYWx0\nZXJTZXEgPQogICAgICAgICAgICBNZXNzYWdlRm9ybWF0LmZvcm1hdChhbHRl\nclNlcXVlbmNlU1FMLCBuZXcgT2JqZWN0W10geyBzZXFOYW1lLAogICAgICAg\nICAgICAgICAgU3RyaW5nLnZhbHVlT2Yoc2VxLmdldEluaXRpYWxWYWx1ZSgp\nKSB9KTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdIHsgY3JlYXRlU2Vx\nLCBhbHRlclNlcSB9OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIEZp\ncmViaXJkLXNwZWNpZmljIHN0YXRlbWVudCB0byBzZWxlY3QgdGhlIGxpc3Qg\nb2Ygc2VxdWVuY2VzLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3Rl\nY3RlZCBTdHJpbmcgZ2V0U2VxdWVuY2VzU1FMKFN0cmluZyBzY2hlbWFOYW1l\nLCBTdHJpbmcgc2VxdWVuY2VOYW1lKSB7CiAgICAgICAgcmV0dXJuIGdldFNl\ncXVlbmNlc1NRTChEQklkZW50aWZpZXIubmV3U2NoZW1hKHNjaGVtYU5hbWUp\nLCBEQklkZW50aWZpZXIubmV3U2VxdWVuY2Uoc2VxdWVuY2VOYW1lKSk7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFNl\ncXVlbmNlc1NRTChEQklkZW50aWZpZXIgc2NoZW1hTmFtZSwgREJJZGVudGlm\naWVyIHNlcXVlbmNlTmFtZSkgewogICAgICAgIFN0cmluZ0J1aWxkZXIgYnVm\nID0gbmV3IFN0cmluZ0J1aWxkZXIoc2VxdWVuY2VTUUwpOwogICAgICAgIGlm\nIChzZXF1ZW5jZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVu\nZChzZXF1ZW5jZU5hbWVTUUwpOwogICAgICAgIHJldHVybiBidWYudG9TdHJp\nbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGwgc3VwZXIgaW1wbGVt\nZW50YXRpb24gYW5kIHRyaW0gc2VxdWVuY2UgbmFtZS4gVGhpcyBpcyBiZWNh\ndXNlIG9mCiAgICAgKiB0cmFpbGluZyBzcGFjZXMgcHJvYmxlbTogPGNvZGU+\nUkRCJEdFTkVSQVRPUlMuUkRCJEdFTkVSQVRPUl9OQU1FPC9jb2RlPgogICAg\nICogaXMgPGNvZGU+Q0hBUigzMSk8L2NvZGU+IGFuZCB1c2luZyA8Y29kZT5S\nVFJJTTwvY29kZT4gVURGIGZ1bmN0aW9uIG9uCiAgICAgKiBGaXJlYmlyZCAx\nLjUgc3VycHJpc2luZ2x5IHJldHVybnMgYSBzdHJpbmcgcmlnaHQtcGFkZGVk\nIHdpdGggc3BhY2VzIHVwCiAgICAgKiB0byB0aGUgbGVuZ3RoIG9mIDI1NS4K\nICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgU2VxdWVuY2Ug\nbmV3U2VxdWVuY2UoUmVzdWx0U2V0IHNlcXVlbmNlTWV0YSkgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgU2VxdWVuY2Ugc2VxID0gc3VwZXIubmV3\nU2VxdWVuY2Uoc2VxdWVuY2VNZXRhKTsKICAgICAgICBzZXEuc2V0SWRlbnRp\nZmllcihEQklkZW50aWZpZXIudHJpbShzZXEuZ2V0SWRlbnRpZmllcigpKSk7\nCiAgICAgICAgcmV0dXJuIHNlcTsKICAgIH0KCiAgICAvKioKICAgICAqIE9u\nIEZpcmViaXJkIDEuNSByZXR1cm4KICAgICAqIDxjb2RlPkRST1AgR0VORVJB\nVE9SICZsdDtzZXF1ZW5jZSBuYW1lJmd0OzwvY29kZT4uCiAgICAgKiBPbiBG\naXJlYmlyZCAyLjAgYW5kIGxhdGVyIGRlbGVnYXRlIHRvIHRoZSBzdXBlciBp\nbXBsZW1lbnRhdGlvbi4KICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgU3RyaW5nW10gZ2V0RHJvcFNlcXVlbmNlU1FMKFNlcXVlbmNlIHNlcSkg\newogICAgICAgIGlmIChmaXJlYmlyZFZlcnNpb24gPT0gRkJfVkVSU0lPTl8x\nNSkKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXSB7IGRyb3BTZXF1\nZW5jZVNRTEZCMTUgKyBnZXRGdWxsTmFtZShzZXEpIH07CiAgICAgICAgcmV0\ndXJuIHN1cGVyLmdldERyb3BTZXF1ZW5jZVNRTChzZXEpOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhyb3cge0BsaW5rIFVuc3VwcG9ydGVkRXhjZXB0aW9u\nfS4gRmlyZWJpcmQgaW4gdmVyc2lvbiBlYXJsaWVyIHRoYW4gMi4xCiAgICAg\nKiBoYXMgbm8gc3VpdGFibGUgZnVuY3Rpb24uIEZpcmViaXJkIDIuMSBoYXMg\ndGhlIDxjb2RlPlBPU0lUSU9OPC9jb2RlPgogICAgICogZnVuY3Rpb24gYnV0\nIHVzaW5nIGl0IGhlcmUgcmVzdWx0cyBpbiBlcnJvcnMgbGlrZSAiZGF0YSB0\neXBlIHVua25vd24iIG9yCiAgICAgKiAiZXhwcmVzc2lvbiBldmFsdWF0aW9u\nIG5vdCBzdXBwb3J0ZWQiLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyB2b2lkIGluZGV4T2YoU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUg\nc3RyLCBGaWx0ZXJWYWx1ZSBmaW5kLAogICAgICAgIEZpbHRlclZhbHVlIHN0\nYXJ0KSB7CiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJmdW5jdGlvbi1ub3Qtc3VwcG9ydGVkIiwKICAgICAgICAg\nICAgZ2V0Q2xhc3MoKSwgIkxPQ0FURSIpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFVzZQogICAgICogPGNvZGU+U1VCU1RSSU5HKCZsdDtjb2wgbmFtZSZn\ndDsgRlJPTSAmbHQ7bSZndDsgRk9SICZsdDtuJmd0Oyk8L2NvZGU+LgogICAg\nICogUGFyYW1ldGVycyBhcmUgaW5saW5lZCBiZWNhdXNlIG5laXRoZXIgcGFy\nYW1ldGVyIGJpbmRpbmcgbm9yIGV4cHJlc3Npb25zCiAgICAgKiBhcmUgYWNj\nZXB0ZWQgYnkgRmlyZWJpcmQgaGVyZS4gQXMgYSByZXN1bHQsIGFuCiAgICAg\nKiB7QGxpbmsgVW5zdXBwb3J0ZWRFeGNlcHRpb259IGlzIHRocm93biB3aGVu\nIHNvbWV0aGluZyBlbHNlIHRoYW4gYQogICAgICogY29uc3RhbnQgaXMgdXNl\nZCBpbiA8Y29kZT5zdGFydDwvY29kZT4gb3IgPGNvZGU+ZW5kPC9jb2RlPi4K\nICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzdWJzdHJp\nbmcoU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0ZXJWYWx1\nZSBzdGFydCwKICAgICAgICBGaWx0ZXJWYWx1ZSBlbmQpIHsKICAgICAgICBi\ndWYuYXBwZW5kKHN1YnN0cmluZ0Z1bmN0aW9uTmFtZSkuYXBwZW5kKCIoIik7\nCiAgICAgICAgc3RyLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVu\nZCgiIEZST00gIik7CiAgICAgICAgaWYgKHN0YXJ0LmdldFZhbHVlKCkgaW5z\ndGFuY2VvZiBOdW1iZXIpIHsKICAgICAgICAgICAgbG9uZyBzdGFydExvbmcg\nPSB0b0xvbmcoc3RhcnQpOwogICAgICAgICAgICBidWYuYXBwZW5kKExvbmcu\ndG9TdHJpbmcoc3RhcnRMb25nICsgMSkpOwogICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbihfbG9j\nLmdldCgiZnVuY3Rpb24tbm90LXN1cHBvcnRlZCIsCiAgICAgICAgICAgICAg\nICBnZXRDbGFzcygpLCBzdWJzdHJpbmdGdW5jdGlvbk5hbWUgKyAiIHdpdGgg\nbm9uLWNvbnN0YW50cyIpKTsKICAgICAgICB9CiAgICAgICAgaWYgKGVuZCAh\nPSBudWxsKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBGT1IgIik7CiAg\nICAgICAgICAgIGlmIChzdGFydC5nZXRWYWx1ZSgpIGluc3RhbmNlb2YgTnVt\nYmVyCiAgICAgICAgICAgICAgICAmJiBlbmQuZ2V0VmFsdWUoKSBpbnN0YW5j\nZW9mIE51bWJlcikgewogICAgICAgICAgICAgICAgbG9uZyBzdGFydExvbmcg\nPSB0b0xvbmcoc3RhcnQpOwogICAgICAgICAgICAgICAgbG9uZyBlbmRMb25n\nID0gdG9Mb25nKGVuZCk7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKExv\nbmcudG9TdHJpbmcoZW5kTG9uZyAtIHN0YXJ0TG9uZykpOwogICAgICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9y\ndGVkRXhjZXB0aW9uKF9sb2MuZ2V0KAogICAgICAgICAgICAgICAgICAgICJm\ndW5jdGlvbi1ub3Qtc3VwcG9ydGVkIiwgZ2V0Q2xhc3MoKSwgc3Vic3RyaW5n\nRnVuY3Rpb25OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICsgIiB3aXRo\nIG5vbi1jb25zdGFudHMiKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAgfQoKICAgIC8qKgogICAgICog\nT24gRmlyZWJpcmQgMS41IHJlZHVjZSB0aGUgc2l6ZSBvZiBpbmRleGVkIDxj\nb2RlPlZBUkNIQVI8L2NvZGU+IGNvbHVtbgogICAgICogdG8gMjUyIG9yIGEg\ndmFsdWUgc3BlY2lmaWVkIGJ5IHVzZXIuIDI1MiBpcyB0aGUgbWF4aW11bSBG\naXJlYmlyZCAxLjUgY2FuCiAgICAgKiBoYW5kbGUgZm9yIG9uZS1jb2x1bW4g\naW5kZXhlcy4gT24gRmlyZWJpcmQgMi4wIGFuZCBsYXRlciBkZWxlZ2F0ZSB0\nbyB0aGUKICAgICAqIHN1cGVyIGltcGxlbWVudGF0aW9uLgogICAgICovCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBTdHJpbmcgYXBwZW5kU2l6ZShD\nb2x1bW4gY29sLCBTdHJpbmcgdHlwZU5hbWUpIHsKICAgICAgICBpZiAoZmly\nZWJpcmRWZXJzaW9uICE9IEZCX1ZFUlNJT05fMTUpCiAgICAgICAgICAgIHJl\ndHVybiBzdXBlci5hcHBlbmRTaXplKGNvbCwgdHlwZU5hbWUpOwoKICAgICAg\nICBpZiAoY29sLmdldFR5cGUoKSA9PSBUeXBlcy5WQVJDSEFSCiAgICAgICAg\nICAgICYmIGNvbC5nZXRTaXplKCkgPiBpbmRleGVkVmFyY2hhck1heFNpemVG\nQjE1CiAgICAgICAgICAgICYmIGNvbC5nZXRUYWJsZSgpICE9IG51bGwpIHsK\nCiAgICAgICAgICAgIGlmIChjb2wuaXNQcmltYXJ5S2V5KCkpIHsKICAgICAg\nICAgICAgICAgIGNvbC5zZXRTaXplKGluZGV4ZWRWYXJjaGFyTWF4U2l6ZUZC\nMTUpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmFwcGVuZFNpemUo\nY29sLCB0eXBlTmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgSW5k\nZXhbXSBpbmRleGVzID0gY29sLmdldFRhYmxlKCkuZ2V0SW5kZXhlcygpOwog\nICAgICAgICAgICBmb3IgKEluZGV4IGluZGV4IDogaW5kZXhlcykgewogICAg\nICAgICAgICAgICAgaWYgKGluZGV4LmNvbnRhaW5zQ29sdW1uKGNvbCkpIHsK\nICAgICAgICAgICAgICAgICAgICBjb2wuc2V0U2l6ZShpbmRleGVkVmFyY2hh\nck1heFNpemVGQjE1KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3Vw\nZXIuYXBwZW5kU2l6ZShjb2wsIHR5cGVOYW1lKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBVbmlxdWVbXSB1bmlxdWVz\nID0gY29sLmdldFRhYmxlKCkuZ2V0VW5pcXVlcygpOwogICAgICAgICAgICBm\nb3IgKFVuaXF1ZSB1bmlxdWUgOiB1bmlxdWVzKSB7CiAgICAgICAgICAgICAg\nICBpZiAodW5pcXVlLmNvbnRhaW5zQ29sdW1uKGNvbCkpIHsKICAgICAgICAg\nICAgICAgICAgICBjb2wuc2V0U2l6ZShpbmRleGVkVmFyY2hhck1heFNpemVG\nQjE1KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuYXBwZW5k\nU2l6ZShjb2wsIHR5cGVOYW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgICAgICBGb3JlaWduS2V5W10gZm9yZWlnbktleXMg\nPSBjb2wuZ2V0VGFibGUoKS5nZXRGb3JlaWduS2V5cygpOwogICAgICAgICAg\nICBmb3IgKEZvcmVpZ25LZXkgZm9yZWlnbktleSA6IGZvcmVpZ25LZXlzKSB7\nCiAgICAgICAgICAgICAgICBpZiAoZm9yZWlnbktleS5jb250YWluc0NvbHVt\nbihjb2wpKSB7CiAgICAgICAgICAgICAgICAgICAgY29sLnNldFNpemUoaW5k\nZXhlZFZhcmNoYXJNYXhTaXplRkIxNSk7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIHN1cGVyLmFwcGVuZFNpemUoY29sLCB0eXBlTmFtZSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIHN1cGVyLmFwcGVuZFNpemUoY29sLCB0eXBlTmFtZSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBVc2UgZXJyb3IgY29kZSBhcyBTUUwgc3RhdGUg\ncmV0dXJuZWQgYnkgRmlyZWJpcmQgaXMgYW1iaWd1b3VzLgogICAgICovCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBpbnQgbWF0Y2hFcnJvclN0YXRl\nKE1hcDxJbnRlZ2VyLFNldDxTdHJpbmc+PiBlcnJvclN0YXRlcywgU1FMRXhj\nZXB0aW9uIGV4KSB7CiAgICAgICAgU3RyaW5nIGVycm9yU3RhdGUgPSAiIitl\neC5nZXRFcnJvckNvZGUoKTsKICAgICAgICBmb3IgKE1hcC5FbnRyeTxJbnRl\nZ2VyLFNldDxTdHJpbmc+PiBzdGF0ZXMgOiBlcnJvclN0YXRlcy5lbnRyeVNl\ndCgpKSB7CiAgICAgICAgICAgIGlmIChzdGF0ZXMuZ2V0VmFsdWUoKS5jb250\nYWlucyhlcnJvclN0YXRlKSkKICAgICAgICAgICAgICAgIHJldHVybiBzdGF0\nZXMuZ2V0S2V5KCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBTdG9yZUV4\nY2VwdGlvbi5HRU5FUkFMOwogICAgfQp9Cg==\n","encoding":"base64"}

