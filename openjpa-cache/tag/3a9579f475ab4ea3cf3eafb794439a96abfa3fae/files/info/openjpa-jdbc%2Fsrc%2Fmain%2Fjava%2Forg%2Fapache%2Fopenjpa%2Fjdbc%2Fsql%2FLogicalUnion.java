{"sha":"d612f8e87a62cd161990c069c239c322a24a3965","node_id":"MDQ6QmxvYjIwNjM2NDpkNjEyZjhlODdhNjJjZDE2MTk5MGMwNjljMjM5YzMyMmEyNGEzOTY1","size":28947,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d612f8e87a62cd161990c069c239c322a24a3965","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwppbXBvcnQgamF2YS51dGlsLkJpdFNldDsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwpp\nbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJD\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1ZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5Db250ZXh0OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkZpZWxkTWFwcGlu\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1\nbW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9y\nZWlnbktleTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5M\nb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRl\ncm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlVuc3VwcG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBBIGxvZ2ljYWwgdW5p\nb24gbWFkZSB1cCBvZiBtdWx0aXBsZSBkaXN0aW5jdCBzZWxlY3RzIHdob3Nl\nIHJlc3VsdHMgYXJlCiAqIGNvbWJpbmVkIGluIG1lbW9yeS4KICoKICogQGF1\ndGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBMb2dpY2FsVW5pb24K\nICAgIGltcGxlbWVudHMgVW5pb24gewoKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAg\nICAgICAoTG9naWNhbFVuaW9uLmNsYXNzKTsKCiAgICBwcm90ZWN0ZWQgZmlu\nYWwgVW5pb25TZWxlY3RbXSBzZWxzOwogICAgcHJvdGVjdGVkIGZpbmFsIERC\nRGljdGlvbmFyeSBkaWN0OwogICAgcHJvdGVjdGVkIGZpbmFsIENsYXNzTWFw\ncGluZ1tdIG1hcHBpbmdzOwogICAgcHJvdGVjdGVkIGZpbmFsIEJpdFNldCBk\nZXNjID0gbmV3IEJpdFNldCgpOwogICAgcHJpdmF0ZSBib29sZWFuIF9kaXN0\naW5jdCA9IHRydWU7CiAgIAoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3Iu\nCiAgICAgKgogICAgICogQHBhcmFtIGNvbmYgc3lzdGVtIGNvbmZpZ3VyYXRp\nb24KICAgICAqIEBwYXJhbSBzZWxzIHRoZSBudW1iZXIgb2YgU1FMIHNlbGVj\ndHMgdG8gdW5pb24gdG9nZXRoZXIKICAgICAqLwogICAgcHVibGljIExvZ2lj\nYWxVbmlvbihKREJDQ29uZmlndXJhdGlvbiBjb25mLCBpbnQgc2Vscykgewog\nICAgICAgIHRoaXMoY29uZiwgc2VscywgbnVsbCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3RvciB1c2VkIHRvIHNlZWQgdGhlIGludGVybmFs\nIHNlbGVjdHMuCiAgICAgKi8KICAgIHB1YmxpYyBMb2dpY2FsVW5pb24oSkRC\nQ0NvbmZpZ3VyYXRpb24gY29uZiwgU2VsZWN0W10gc2VlZHMpIHsKICAgICAg\nICB0aGlzKGNvbmYsIHNlZWRzLmxlbmd0aCwgc2VlZHMpOwogICAgfQoKICAg\nIC8qKgogICAgICogRGVsZWdhdGUgY29uc3RydWN0b3IuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBMb2dpY2FsVW5pb24oSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiwgaW50IHNlbHMsIFNlbGVjdFtdIHNlZWRzKSB7CiAgICAgICAgaWYgKHNl\nbHMgPT0gMCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0\naW9uKCJzZWxzID09IDAiKTsKCiAgICAgICAgZGljdCA9IGNvbmYuZ2V0REJE\naWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBtYXBwaW5ncyA9IG5ldyBD\nbGFzc01hcHBpbmdbc2Vsc107CiAgICAgICAgdGhpcy5zZWxzID0gbmV3IFVu\naW9uU2VsZWN0W3NlbHNdOwoKICAgICAgICBTZWxlY3RJbXBsIHNlZWQ7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxzOyBpKyspIHsKICAgICAg\nICAgICAgc2VlZCA9IChzZWVkcyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nPyAoU2VsZWN0SW1wbCkgY29uZi5nZXRTUUxGYWN0b3J5SW5zdGFuY2UoKS5u\nZXdTZWxlY3QoKQogICAgICAgICAgICAgICAgOiAoU2VsZWN0SW1wbCkgc2Vl\nZHNbaV07CiAgICAgICAgICAgIHRoaXMuc2Vsc1tpXSA9IG5ld1VuaW9uU2Vs\nZWN0KHNlZWQsIGkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIENyZWF0ZSBhIG5ldyB1bmlvbiBzZWxlY3Qgd2l0aCB0aGUgZ2l2ZW4gZGVs\nZWdhdGUgYW5kIHVuaW9uIHBvc2l0aW9uLgogICAgICovCiAgICBwcm90ZWN0\nZWQgVW5pb25TZWxlY3QgbmV3VW5pb25TZWxlY3QoU2VsZWN0SW1wbCBzZWVk\nLCBpbnQgcG9zKSB7CiAgICAgICAgcmV0dXJuIG5ldyBVbmlvblNlbGVjdChz\nZWVkLCBwb3MpOwogICAgfQoKICAgIHB1YmxpYyBTZWxlY3RbXSBnZXRTZWxl\nY3RzKCkgewogICAgICAgIHJldHVybiBzZWxzOwogICAgfQogICAKICAgIHB1\nYmxpYyBib29sZWFuIGlzVW5pb24oKSB7CiAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFib3J0VW5pb24oKSB7CiAgICB9\nCgogICAgcHVibGljIFN0cmluZyBnZXRPcmRlcmluZygpIHsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0NvbmZpZ3VyYXRp\nb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gc2Vsc1sw\nXS5nZXRDb25maWd1cmF0aW9uKCk7CiAgICB9CgogICAgcHVibGljIERCRGlj\ndGlvbmFyeSBnZXREQkRpY3Rpb25hcnkoKSB7CiAgICAgICAgcmV0dXJuIGRp\nY3Q7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdChib29s\nZWFuIGZvclVwZGF0ZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkg\newogICAgICAgIHJldHVybiBkaWN0LnRvU2VsZWN0KHNlbHNbMF0sIGZvclVw\nZGF0ZSwgZmV0Y2gpOwogICAgfQogICAgCiAgICBwdWJsaWMgU1FMQnVmZmVy\nIGdldFNRTCgpIHsKICAgICAgICByZXR1cm4gc2Vscy5sZW5ndGggPT0gMSA/\nIHNlbHNbMF0uZ2V0U1FMKCkgOiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBT\nUUxCdWZmZXIgdG9TZWxlY3RDb3VudCgpIHsKICAgICAgICByZXR1cm4gZGlj\ndC50b1NlbGVjdENvdW50KHNlbHNbMF0pOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGdldEF1dG9EaXN0aW5jdCgpIHsKICAgICAgICByZXR1cm4gc2Vs\nc1swXS5nZXRBdXRvRGlzdGluY3QoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRBdXRvRGlzdGluY3QoYm9vbGVhbiBkaXN0aW5jdCkgewogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgc2Vsc1tpXS5zZXRBdXRvRGlzdGluY3QoZGlzdGluY3QpOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGlzRGlzdGluY3QoKSB7CiAgICAgICAg\ncmV0dXJuIF9kaXN0aW5jdDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRE\naXN0aW5jdChib29sZWFuIGRpc3RpbmN0KSB7CiAgICAgICAgX2Rpc3RpbmN0\nID0gZGlzdGluY3Q7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNMUlMo\nKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0uaXNMUlMoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRMUlMoYm9vbGVhbiBscnMpIHsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgIHNlbHNbaV0uc2V0TFJTKGxycyk7CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRFeHBlY3RlZFJlc3VsdENvdW50KCkgewogICAgICAgIHJldHVybiBz\nZWxzWzBdLmdldEV4cGVjdGVkUmVzdWx0Q291bnQoKTsKICAgIH0KICAgIAog\nICAgcHVibGljIHZvaWQgc2V0RXhwZWN0ZWRSZXN1bHRDb3VudChpbnQgZXhw\nZWN0ZWRSZXN1bHRDb3VudCwKICAgICAgICBib29sZWFuIGZvcmNlKSB7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBzZWxzW2ldLnNldEV4cGVjdGVkUmVzdWx0Q291bnQoZXhw\nZWN0ZWRSZXN1bHRDb3VudCwgZm9yY2UpOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgZ2V0Sm9pblN5bnRheCgpIHsKICAgICAgICByZXR1cm4gc2Vsc1swXS5n\nZXRKb2luU3ludGF4KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Sm9p\nblN5bnRheChpbnQgc3ludGF4KSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzZWxzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZWxzW2ldLnNl\ndEpvaW5TeW50YXgoc3ludGF4KTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c1JhbmRvbUFjY2Vzcyhib29sZWFuIGZvclVwZGF0ZSkgewog\nICAgICAgIGlmIChzZWxzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICByZXR1\ncm4gc2Vsc1swXS5zdXBwb3J0c1JhbmRvbUFjY2Vzcyhmb3JVcGRhdGUpOwog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c0xvY2tpbmcoKSB7CiAgICAgICAgaWYgKHNlbHMubGVuZ3Ro\nID09IDEpCiAgICAgICAgICAgIHJldHVybiBzZWxzWzBdLnN1cHBvcnRzTG9j\na2luZygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgaWYgKCFzZWxzW2ldLnN1cHBvcnRzTG9j\na2luZygpKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc011\nbHRpcGxlU2VsZWN0cygpIHsKICAgICAgICBpZiAoc2VscyAhPSBudWxsICYm\nIHNlbHMubGVuZ3RoID4gMSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgcmV0dXJuIHNlbHNbMF0uaGFzTXVsdGlwbGVTZWxlY3RzKCk7CiAg\nICB9CgogICAgcHVibGljIGludCBnZXRDb3VudChKREJDU3RvcmUgc3RvcmUp\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IGNv\ndW50ID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlbHMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIGNvdW50ICs9IHNlbHNbaV0uZ2V0Q291\nbnQoc3RvcmUpOwogICAgICAgIHJldHVybiBjb3VudDsKICAgIH0KCiAgICBw\ndWJsaWMgUmVzdWx0IGV4ZWN1dGUoSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmIChmZXRjaCA9PSBudWxsKQogICAgICAgICAg\nICBmZXRjaCA9IHN0b3JlLmdldEZldGNoQ29uZmlndXJhdGlvbigpOwogICAg\nICAgIHJldHVybiBleGVjdXRlKHN0b3JlLCBmZXRjaCwgZmV0Y2guZ2V0UmVh\nZExvY2tMZXZlbCgpKTsKICAgIH0KCiAgICBwdWJsaWMgUmVzdWx0IGV4ZWN1\ndGUoSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoLAogICAgICAgIGludCBsb2NrTGV2ZWwpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGZldGNoID09IG51bGwpCiAgICAg\nICAgICAgIGZldGNoID0gc3RvcmUuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7\nCgogICAgICAgIGlmIChzZWxzLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAg\nIFJlc3VsdCByZXMgPSBzZWxzWzBdLmV4ZWN1dGUoc3RvcmUsIGZldGNoLCBs\nb2NrTGV2ZWwpOwogICAgICAgICAgICAoKEFic3RyYWN0UmVzdWx0KSByZXMp\nLnNldEJhc2VNYXBwaW5nKG1hcHBpbmdzWzBdKTsKICAgICAgICAgICAgcmV0\ndXJuIHJlczsKICAgICAgICB9CgogICAgICAgIGlmIChnZXRFeHBlY3RlZFJl\nc3VsdENvdW50KCkgPT0gMSkgewogICAgICAgICAgICBBYnN0cmFjdFJlc3Vs\ndCByZXM7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgcmVzID0gKEFic3RyYWN0\nUmVzdWx0KSBzZWxzW2ldLmV4ZWN1dGUoc3RvcmUsIGZldGNoLAogICAgICAg\nICAgICAgICAgICAgIGxvY2tMZXZlbCk7CiAgICAgICAgICAgICAgICByZXMu\nc2V0QmFzZU1hcHBpbmcobWFwcGluZ3NbaV0pOwogICAgICAgICAgICAgICAg\ncmVzLnNldEluZGV4T2YoaSk7CgogICAgICAgICAgICAgICAgLy8gaWYgd2Ug\nZ2V0IHRvIHRoZSBsYXN0IHNlbGVjdCwganVzdCByZXR1cm4gaXRzIHJlc3Vs\ndAogICAgICAgICAgICAgICAgaWYgKGkgPT0gc2Vscy5sZW5ndGggLSAxKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7CgogICAgICAgICAgICAg\nICAgLy8gcmV0dXJuIHRoZSBmaXJzdCByZXN1bHQgdGhhdCBoYXMgYSByb3cK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKCFyZXMubmV4dCgpKQogICAgICAgICAgICAgICAgICAgICAgICByZXMuY2xv\nc2UoKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgcmVzLnB1c2hCYWNrKCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHJldHVybiByZXM7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIHJlcy5jbG9zZSgpOwog\nICAgICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBjcmVhdGUg\nYSBzaW5nbGUgcmVzdWx0IGZyb20gZWFjaCBzZWxlY3QgaW4gb3VyIGZha2Ug\ndW5pb24sIG1lcmdpbmcKICAgICAgICAvLyB0aGVtIGFzIG5lZWRlZAogICAg\nICAgIEFic3RyYWN0UmVzdWx0W10gcmVzID0gbmV3IEFic3RyYWN0UmVzdWx0\nW3NlbHMubGVuZ3RoXTsKICAgICAgICBMaXN0W10gb3JkZXJJZHhzID0gbnVs\nbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBMaXN0IGw7CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgICAgICByZXNbaV0gPSAoQWJzdHJhY3RSZXN1bHQpIHNlbHNb\naV0uZXhlY3V0ZShzdG9yZSwgZmV0Y2gsCiAgICAgICAgICAgICAgICAgICAg\nbG9ja0xldmVsKTsKICAgICAgICAgICAgICAgIHJlc1tpXS5zZXRCYXNlTWFw\ncGluZyhtYXBwaW5nc1tpXSk7CiAgICAgICAgICAgICAgICByZXNbaV0uc2V0\nSW5kZXhPZihpKTsKCiAgICAgICAgICAgICAgICBsID0gc2Vsc1tpXS5nZXRT\nZWxlY3RlZE9yZGVySW5kZXhlcygpOwogICAgICAgICAgICAgICAgaWYgKGwg\nIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGlmIChvcmRlcklkeHMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJJZHhzID0g\nbmV3IExpc3Rbc2Vscy5sZW5ndGhdOwogICAgICAgICAgICAgICAgICAgIG9y\nZGVySWR4c1tpXSA9IGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IHJlc1tpXSAhPSBudWxsOyBpKyspCiAg\nICAgICAgICAgICAgICByZXNbaV0uY2xvc2UoKTsKICAgICAgICAgICAgdGhy\nb3cgc2U7CiAgICAgICAgfQoKICAgICAgICAvLyBpZiBtdWx0aXBsZSBzZWxl\nY3RzIGhhdmUgb3JkZXJpbmcsIHVzZSBhIGNvbXBhcmF0b3IgdG8gY29sbGF0\nZQogICAgICAgIFJlc3VsdENvbXBhcmF0b3IgY29tcCA9IG51bGw7CiAgICAg\nICAgaWYgKG9yZGVySWR4cyAhPSBudWxsKQogICAgICAgICAgICBjb21wID0g\nbmV3IFJlc3VsdENvbXBhcmF0b3Iob3JkZXJJZHhzLCBkZXNjLCBkaWN0KTsK\nICAgICAgICByZXR1cm4gbmV3IE1lcmdlZFJlc3VsdChyZXMsIGNvbXApOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNlbGVjdChVbmlvbi5TZWxlY3RvciBz\nZWxlY3RvcikgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgc2VsZWN0b3Iuc2VsZWN0KHNlbHNb\naV0sIGkpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7\nCiAgICAgICAgcmV0dXJuIHRvU2VsZWN0KGZhbHNlLCBudWxsKS5nZXRTUUwo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEEgY2FsbGJhY2sgdXNlZCB0byBj\ncmVhdGUgdGhlIHNlbGVjdHMgaW4gYSBTUUwgdW5pb24uCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIFNlbGVjdG9yIHsKCiAgICAgICAg\nLyoqCiAgICAgICAgICogUG9wdWxhdGUgdGhlIDxjb2RlPmk8L2NvZGU+dGgg\nc2VsZWN0IGluIHRoZSB1bmlvbi4KICAgICAgICAgKi8KICAgICAgICBwdWJs\naWMgdm9pZCBzZWxlY3QoU2VsZWN0IHNlbCwgaW50IGkpOwogICAgfQoKICAg\nIC8qKgogICAgICogQSBzZWxlY3QgdGhhdCBpcyBwYXJ0IG9mIGEgbG9naWNh\nbCB1bmlvbi4KICAgICAqLwogICAgcHVibGljIGNsYXNzIFVuaW9uU2VsZWN0\nCiAgICAgICAgaW1wbGVtZW50cyBTZWxlY3QgewoKICAgICAgICBwcm90ZWN0\nZWQgZmluYWwgU2VsZWN0SW1wbCBzZWw7CiAgICAgICAgcHJvdGVjdGVkIGZp\nbmFsIGludCBwb3M7CiAgICAgICAgcHJvdGVjdGVkIGludCBvcmRlcnMgPSAw\nOwogICAgICAgIHByb3RlY3RlZCBMaXN0IG9yZGVySWR4cyA9IG51bGw7CiAg\nICAgICAKICAgICAgICBwdWJsaWMgVW5pb25TZWxlY3QoU2VsZWN0SW1wbCBz\nZWwsIGludCBwb3MpIHsKICAgICAgICAgICAgdGhpcy5zZWwgPSBzZWw7CiAg\nICAgICAgICAgIHRoaXMucG9zID0gcG9zOwogICAgICAgICAgICBzZWwuc2V0\nUmVjb3JkT3JkZXJlZEluZGV4ZXModHJ1ZSk7CiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBEZWxlZ2F0ZSBzZWxlY3QuCiAgICAgICAgICov\nCiAgICAgICAgcHVibGljIFNlbGVjdEltcGwgZ2V0RGVsZWdhdGUoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWw7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBSZXR1cm4gdGhlIGluZGV4ZXMgb2YgdGhlIGRhdGEgaW4g\ndGhlIHNlbGVjdCBjbGF1c2UgdGhpcyBxdWVyeSBpcwogICAgICAgICAqIG9y\nZGVyZWQgYnkuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIExpc3QgZ2V0\nU2VsZWN0ZWRPcmRlckluZGV4ZXMoKSB7CiAgICAgICAgICAgIGlmIChvcmRl\ncklkeHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIG9yZGVySWR4cyA9IHNl\nbC5nZXRPcmRlcmVkSW5kZXhlcygpOwogICAgICAgICAgICByZXR1cm4gb3Jk\nZXJJZHhzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpEQkNDb25maWd1\ncmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgICAgIHJldHVy\nbiBzZWwuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGludCBpbmRleE9mKCkgewogICAgICAgICAgICByZXR1cm4gcG9z\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVj\ndChib29sZWFuIGZvclVwZGF0ZSwKICAgICAgICAgICAgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgICAgICByZXR1cm4gc2VsLnRv\nU2VsZWN0KGZvclVwZGF0ZSwgZmV0Y2gpOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBwdWJsaWMgU1FMQnVmZmVyIGdldFNRTCgpIHsKICAgICAgICAg\nICAgcmV0dXJuIHNlbC5nZXRTUUwoKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBTUUxCdWZmZXIgdG9TZWxlY3RDb3VudCgpIHsKICAgICAgICAgICAg\ncmV0dXJuIHNlbC50b1NlbGVjdENvdW50KCk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBnZXRBdXRvRGlzdGluY3QoKSB7CiAgICAgICAg\nICAgIHJldHVybiBzZWwuZ2V0QXV0b0Rpc3RpbmN0KCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBzZXRBdXRvRGlzdGluY3QoYm9vbGVhbiBk\naXN0aW5jdCkgewogICAgICAgICAgICBzZWwuc2V0QXV0b0Rpc3RpbmN0KGRp\nc3RpbmN0KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGlz\nRGlzdGluY3QoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuaXNEaXN0aW5j\ndCgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0RGlzdGlu\nY3QoYm9vbGVhbiBkaXN0aW5jdCkgewogICAgICAgICAgICBzZWwuc2V0RGlz\ndGluY3QoZGlzdGluY3QpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gaXNMUlMoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuaXNMUlMo\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldExSUyhib29s\nZWFuIGxycykgewogICAgICAgICAgICBzZWwuc2V0TFJTKGxycyk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdldEpvaW5TeW50YXgoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWwuZ2V0Sm9pblN5bnRheCgpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0Sm9pblN5bnRheChpbnQgam9p\nblN5bnRheCkgewogICAgICAgICAgICBzZWwuc2V0Sm9pblN5bnRheChqb2lu\nU3ludGF4KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIHN1\ncHBvcnRzUmFuZG9tQWNjZXNzKGJvb2xlYW4gZm9yVXBkYXRlKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwuc3VwcG9ydHNSYW5kb21BY2Nlc3MoZm9yVXBk\nYXRlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzTG9ja2luZygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zdXBwb3J0\nc0xvY2tpbmcoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIGhhc011bHRpcGxlU2VsZWN0cygpIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5oYXNNdWx0aXBsZVNlbGVjdHMoKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBpbnQgZ2V0Q291bnQoSkRCQ1N0b3JlIHN0b3JlKQogICAgICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5nZXRDb3VudChzdG9yZSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nUmVzdWx0IGV4ZWN1dGUoSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25m\naWd1cmF0aW9uIGZldGNoKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5leGVjdXRlKHN0b3JlLCBm\nZXRjaCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUmVzdWx0IGV4ZWN1\ndGUoSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoLAogICAgICAgICAgICBpbnQgbG9ja0xldmVsKQogICAgICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5l\neGVjdXRlKHN0b3JlLCBmZXRjaCwgbG9ja0xldmVsKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBMaXN0IGdldFN1YnNlbGVjdHMoKSB7CiAgICAgICAg\nICAgIHJldHVybiBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFNlbGVjdCBnZXRQYXJlbnQoKSB7CiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0\ncmluZyBnZXRTdWJzZWxlY3RQYXRoKCkgewogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldFBhcmVu\ndChTZWxlY3QgcGFyZW50LCBTdHJpbmcgcGF0aCkgewogICAgICAgICAgICB0\naHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oX2xvYy5nZXQoInVuaW9u\nLWVsZW1lbnQiKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBz\nZXRIYXNTdWJzZWxlY3QoYm9vbGVhbiBoYXNTdWIpIHsKICAgICAgICAgICAg\nc2VsLnNldEhhc1N1YnNlbGVjdChoYXNTdWIpOwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBwdWJsaWMgYm9vbGVhbiBnZXRIYXNTdWJzZWxlY3QoKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0SGFzU3Vic2VsZWN0KCk7ICAg\nIAogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgU2VsZWN0IGdl\ndEZyb21TZWxlY3QoKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0RnJvbVNlbGVjdChTZWxl\nY3Qgc2VsKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4\nY2VwdGlvbihfbG9jLmdldCgidW5pb24tZWxlbWVudCIpKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBib29sZWFuIGhhc0VhZ2VySm9pbihib29sZWFu\nIHRvTWFueSkgewogICAgICAgICAgICByZXR1cm4gc2VsLmhhc0VhZ2VySm9p\nbih0b01hbnkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4g\naGFzSm9pbihib29sZWFuIHRvTWFueSkgewogICAgICAgICAgICByZXR1cm4g\nc2VsLmhhc0pvaW4odG9NYW55KTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIGlzU2VsZWN0ZWQoVGFibGUgdGFibGUpIHsKICAgICAgICAg\nICAgcmV0dXJuIHNlbC5pc1NlbGVjdGVkKHRhYmxlKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFRhYmxlQWxpYXNlcygpIHsK\nICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRUYWJsZUFsaWFzZXMoKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBMaXN0IGdldFNlbGVjdHMoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWwuZ2V0U2VsZWN0cygpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIExpc3QgZ2V0U2VsZWN0QWxpYXNlcygpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5nZXRTZWxlY3RBbGlhc2VzKCk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgTGlzdCBnZXRJZGVudGlmaWVyQWxpYXNl\ncygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRJZGVudGlmaWVyQWxp\nYXNlcygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciBn\nZXRPcmRlcmluZygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRPcmRl\ncmluZygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciBn\nZXRHcm91cGluZygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRHcm91\ncGluZygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciBn\nZXRXaGVyZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRXaGVyZSgp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNRTEJ1ZmZlciBnZXRIYXZp\nbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0SGF2aW5nKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBhZGRKb2luQ2xhc3NDb25k\naXRpb25zKCkgewogICAgICAgICAgICBzZWwuYWRkSm9pbkNsYXNzQ29uZGl0\naW9ucygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIEpvaW5zIGdldEpv\naW5zKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5zKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgSXRlcmF0b3IgZ2V0Sm9pbkl0ZXJh\ndG9yKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5JdGVyYXRv\ncigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgZ2V0U3RhcnRJ\nbmRleCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRTdGFydEluZGV4\nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRFbmRJbmRl\neCgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRFbmRJbmRleCgpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0UmFuZ2UobG9uZyBz\ndGFydCwgbG9uZyBlbmQpIHsKICAgICAgICAgICAgc2VsLnNldFJhbmdlKHN0\nYXJ0LCBlbmQpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyBn\nZXRDb2x1bW5BbGlhcyhDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIHJldHVy\nbiBzZWwuZ2V0Q29sdW1uQWxpYXMoY29sKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0Q29sdW1uQWxpYXMoQ29sdW1uIGNvbCwgSm9p\nbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRDb2x1bW5B\nbGlhcyhjb2wsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0Q29sdW1uQWxpYXMoQ29sdW1uIGNvbCwgT2JqZWN0IGFsaWFz\nKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0Q29sdW1uQWxpYXMoY29s\nLCBhbGlhcyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdl\ndENvbHVtbkFsaWFzKFN0cmluZyBjb2wsIFRhYmxlIHRhYmxlKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwuZ2V0Q29sdW1uQWxpYXMoY29sLCB0YWJsZSk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdldENvbHVtbkFs\naWFzKFN0cmluZyBjb2wsIFRhYmxlIHRhYmxlLCBKb2lucyBqb2lucykgewog\nICAgICAgICAgICByZXR1cm4gc2VsLmdldENvbHVtbkFsaWFzKGNvbCwgdGFi\nbGUsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIGlzQWdncmVnYXRlKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmlzQWdn\ncmVnYXRlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRB\nZ2dyZWdhdGUoYm9vbGVhbiBhZ2cpIHsKICAgICAgICAgICAgc2VsLnNldEFn\nZ3JlZ2F0ZShhZ2cpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gaXNMb2IoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuaXNMb2IoKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldExvYihib29sZWFu\nIGxvYikgewogICAgICAgICAgICBzZWwuc2V0TG9iKGxvYik7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZWxlY3RQbGFjZWhvbGRlcihTdHJp\nbmcgc3FsKSB7CiAgICAgICAgICAgIHNlbC5zZWxlY3RQbGFjZWhvbGRlcihz\ncWwpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xlYXJTZWxl\nY3RzKCkgewogICAgICAgICAgICBzZWwuY2xlYXJTZWxlY3RzKCk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3QoU1FMQnVmZmVy\nIHNxbCwgT2JqZWN0IGlkKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2Vs\nZWN0KHNxbCwgaWQpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gc2VsZWN0KFNRTEJ1ZmZlciBzcWwsIE9iamVjdCBpZCwgSm9pbnMgam9p\nbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3Qoc3FsLCBpZCwg\nam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gc2Vs\nZWN0KFN0cmluZyBzcWwsIE9iamVjdCBpZCkgewogICAgICAgICAgICByZXR1\ncm4gc2VsLnNlbGVjdChzcWwsIGlkKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBib29sZWFuIHNlbGVjdChTdHJpbmcgc3FsLCBPYmplY3QgaWQsIEpv\naW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2VsZWN0KHNx\nbCwgaWQsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29s\nZWFuIHNlbGVjdChDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIHJldHVybiBz\nZWwuc2VsZWN0KGNvbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBzZWxlY3QoQ29sdW1uIGNvbCwgSm9pbnMgam9pbnMpIHsKICAgICAg\nICAgICAgcmV0dXJuIHNlbC5zZWxlY3QoY29sLCBqb2lucyk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgaW50IHNlbGVjdChDb2x1bW5bXSBjb2xzKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuc2VsZWN0KGNvbHMpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGludCBzZWxlY3QoQ29sdW1uW10gY29scywg\nSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3Qo\nY29scywgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nc2VsZWN0KENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywK\nICAgICAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGZldGNoLCBpbnQgZWFnZXIpIHsKICAgICAgICAgICAgc2VsZWN0\nKG1hcHBpbmcsIHN1YmNsYXNzZXMsIHN0b3JlLCBmZXRjaCwgZWFnZXIsIG51\nbGwsIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNl\nbGVjdChDbGFzc01hcHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNzZXMsCiAg\nICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCwgaW50IGVhZ2VyLAogICAgICAgICAgICBKb2lucyBqb2lu\ncykgewogICAgICAgICAgICBzZWxlY3QobWFwcGluZywgc3ViY2xhc3Nlcywg\nc3RvcmUsIGZldGNoLCBlYWdlciwgam9pbnMsIGZhbHNlKTsKICAgICAgICB9\nCgogICAgICAgIHByaXZhdGUgdm9pZCBzZWxlY3QoQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcsIGludCBzdWJjbGFzc2VzLAogICAgICAgICAgICBKREJDU3RvcmUg\nc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdl\nciwKICAgICAgICAgICAgSm9pbnMgam9pbnMsIGJvb2xlYW4gaWRlbnRpZmll\ncikgewogICAgICAgICAgICAvLyBpZiB0aGlzIGlzIHRoZSBmaXJzdCAocHJp\nbWFyeSkgbWFwcGluZyBzZWxlY3RlZCBmb3IgdGhpcwogICAgICAgICAgICAv\nLyBTRUxFQ1QsIHJlY29yZCBpdCBzbyB3ZSBjYW4gZmlndXJlIG91dCB3aGF0\nIHRoZSByZXN1bHQgdHlwZSBpcwogICAgICAgICAgICAvLyBzaW5jZSB0aGUg\nZGlzY3JpbWluYXRvciBtaWdodCBub3QgYmUgc2VsZWN0ZWQKICAgICAgICAg\nICAgaWYgKG1hcHBpbmdzW3Bvc10gPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIG1hcHBpbmdzW3Bvc10gPSBtYXBwaW5nOwoKICAgICAgICAgICAgc2VsLnNl\nbGVjdCh0aGlzLCBtYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0Y2gs\nIGVhZ2VyLAogICAgICAgICAgICAgICAgam9pbnMsIGlkZW50aWZpZXIpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gc2VsZWN0SWRlbnRp\nZmllcihDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2Vs\nZWN0SWRlbnRpZmllcihjb2wpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gc2VsZWN0SWRlbnRpZmllcihDb2x1bW4gY29sLCBKb2lucyBq\nb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVjdElkZW50aWZp\nZXIoY29sLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50\nIHNlbGVjdElkZW50aWZpZXIoQ29sdW1uW10gY29scykgewogICAgICAgICAg\nICByZXR1cm4gc2VsLnNlbGVjdElkZW50aWZpZXIoY29scyk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgaW50IHNlbGVjdElkZW50aWZpZXIoQ29sdW1u\nW10gY29scywgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5zZWxlY3RJZGVudGlmaWVyKGNvbHMsIGpvaW5zKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHNlbGVjdElkZW50aWZpZXIoQ2xhc3NNYXBw\naW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2VzLAogICAgICAgICAgICBKREJD\nU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGlu\ndCBlYWdlcikgewogICAgICAgICAgICBzZWxlY3QobWFwcGluZywgc3ViY2xh\nc3Nlcywgc3RvcmUsIGZldGNoLCBlYWdlciwgbnVsbCwgdHJ1ZSk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZWxlY3RJZGVudGlmaWVyKENs\nYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywKICAgICAgICAg\nICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoLCBpbnQgZWFnZXIsCiAgICAgICAgICAgIEpvaW5zIGpvaW5zKSB7CiAg\nICAgICAgICAgIHNlbGVjdChtYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwg\nZmV0Y2gsIGVhZ2VyLCBqb2lucywgdHJ1ZSk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgaW50IHNlbGVjdFByaW1hcnlLZXkoQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3RQcmltYXJ5\nS2V5KG1hcHBpbmcpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBz\nZWxlY3RQcmltYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5nLCBKb2lucyBq\nb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVjdFByaW1hcnlL\nZXkobWFwcGluZywgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGludCBvcmRlckJ5UHJpbWFyeUtleShDbGFzc01hcHBpbmcgbWFwcGluZywg\nYm9vbGVhbiBhc2MsCiAgICAgICAgICAgIGJvb2xlYW4gc2VsZWN0KSB7CiAg\nICAgICAgICAgIHJldHVybiBvcmRlckJ5UHJpbWFyeUtleShtYXBwaW5nLCBh\nc2MsIG51bGwsIHNlbGVjdCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\naW50IG9yZGVyQnlQcmltYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5nLCBi\nb29sZWFuIGFzYywKICAgICAgICAgICAgSm9pbnMgam9pbnMsIGJvb2xlYW4g\nc2VsZWN0KSB7CiAgICAgICAgICAgIENsYXNzTWFwcGluZyBwa3MgPSBtYXBw\naW5nOwogICAgICAgICAgICB3aGlsZSAoIXBrcy5pc1ByaW1hcnlLZXlPYmpl\nY3RJZCh0cnVlKSkKICAgICAgICAgICAgICAgIHBrcyA9IHBrcy5nZXRKb2lu\nYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKTsKICAgICAgICAgICAgQ29sdW1u\nW10gY29scyA9IHBrcy5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAg\nICAgICByZWNvcmRPcmRlckNvbHVtbnMoY29scywgYXNjKTsKICAgICAgICAg\nICAgcmV0dXJuIHNlbC5vcmRlckJ5UHJpbWFyeUtleShtYXBwaW5nLCBhc2Ms\nIGpvaW5zLCBzZWxlY3QsCiAgICAgICAgICAgICAgICBpc1VuaW9uKCkpOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmVjb3JkIHRoYXQg\nd2UncmUgb3JkZXJpbmcgYnkgYSBTUUwgZXhwcmVzc2lvbi4KICAgICAgICAg\nKi8KICAgICAgICBwcm90ZWN0ZWQgdm9pZCByZWNvcmRPcmRlcihPYmplY3Qg\nb3JkLCBib29sZWFuIGFzYykgewogICAgICAgICAgICBpZiAob3JkID09IG51\nbGwpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIG9yZGVy\nSWR4cyA9IG51bGw7CgogICAgICAgICAgICBpbnQgaWR4ID0gb3JkZXJzKys7\nCiAgICAgICAgICAgIGlmIChkZXNjLmdldChpZHgpICYmIGFzYykKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJp\nbmNvbXBhdC1vcmRlcmluZyIpKTsKICAgICAgICAgICAgaWYgKCFhc2MpCiAg\nICAgICAgICAgICAgICBkZXNjLnNldChpZHgpOwogICAgICAgIH0KCiAgICAg\nICAgLyoqCiAgICAgICAgICogUmVjb3JkIHRoYXQgd2UncmUgb3JkZXJpbmcg\nYnkgdGhlIGdpdmVuIGNvbHVtbnMuCiAgICAgICAgICovCiAgICAgICAgcHJv\ndGVjdGVkIHZvaWQgcmVjb3JkT3JkZXJDb2x1bW5zKENvbHVtbltdIGNvbHMs\nIGJvb2xlYW4gYXNjKSB7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIHJlY29yZE9y\nZGVyKGNvbHNbaV0sIGFzYyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBvcmRlckJ5KENvbHVtbiBjb2wsIGJvb2xlYW4gYXNjLCBib29s\nZWFuIHNlbGVjdCkgewogICAgICAgICAgICByZXR1cm4gb3JkZXJCeShjb2ws\nIGFzYywgbnVsbCwgc2VsZWN0KTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIG9yZGVyQnkoQ29sdW1uIGNvbCwgYm9vbGVhbiBhc2MsIEpv\naW5zIGpvaW5zLAogICAgICAgICAgICBib29sZWFuIHNlbGVjdCkgewogICAg\nICAgICAgICByZWNvcmRPcmRlcihjb2wsIGFzYyk7CiAgICAgICAgICAgIHJl\ndHVybiBzZWwub3JkZXJCeShjb2wsIGFzYywgam9pbnMsIHNlbGVjdCwgaXNV\nbmlvbigpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgb3JkZXJC\neShDb2x1bW5bXSBjb2xzLCBib29sZWFuIGFzYywgYm9vbGVhbiBzZWxlY3Qp\nIHsKICAgICAgICAgICAgcmV0dXJuIG9yZGVyQnkoY29scywgYXNjLCBudWxs\nLCBzZWxlY3QpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBvcmRl\nckJ5KENvbHVtbltdIGNvbHMsIGJvb2xlYW4gYXNjLCBKb2lucyBqb2lucywK\nICAgICAgICAgICAgYm9vbGVhbiBzZWxlY3QpIHsKICAgICAgICAgICAgcmVj\nb3JkT3JkZXJDb2x1bW5zKGNvbHMsIGFzYyk7CiAgICAgICAgICAgIHJldHVy\nbiBzZWwub3JkZXJCeShjb2xzLCBhc2MsIGpvaW5zLCBzZWxlY3QsIGlzVW5p\nb24oKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBvcmRl\nckJ5KFNRTEJ1ZmZlciBzcWwsIGJvb2xlYW4gYXNjLCBib29sZWFuIHNlbGVj\ndCwKICAgICAgICAgICAgVmFsdWUgc2VsQXMpIHsKICAgICAgICAgICAgcmV0\ndXJuIG9yZGVyQnkoc3FsLCBhc2MsIG51bGwsIHNlbGVjdCwgc2VsQXMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gb3JkZXJCeShTUUxC\ndWZmZXIgc3FsLCBib29sZWFuIGFzYywgSm9pbnMgam9pbnMsCiAgICAgICAg\nICAgIGJvb2xlYW4gc2VsZWN0LCBWYWx1ZSBzZWxBcykgewogICAgICAgICAg\nICByZWNvcmRPcmRlcihzcWwuZ2V0U1FMKGZhbHNlKSwgYXNjKTsKICAgICAg\nICAgICAgcmV0dXJuIHNlbC5vcmRlckJ5KHNxbCwgYXNjLCBqb2lucywgc2Vs\nZWN0LCBpc1VuaW9uKCksIHNlbEFzKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBib29sZWFuIG9yZGVyQnkoU3RyaW5nIHNxbCwgYm9vbGVhbiBhc2Ms\nIGJvb2xlYW4gc2VsZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBvcmRlckJ5\nKHNxbCwgYXNjLCBudWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gb3JkZXJCeShTdHJpbmcgc3FsLCBib29sZWFuIGFz\nYywgSm9pbnMgam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2VsZWN0KSB7\nCiAgICAgICAgICAgIHJlY29yZE9yZGVyKHNxbCwgYXNjKTsKICAgICAgICAg\nICAgcmV0dXJuIHNlbC5vcmRlckJ5KHNxbCwgYXNjLCBqb2lucywgc2VsZWN0\nLCBpc1VuaW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nY2xlYXJPcmRlcmluZygpIHsKICAgICAgICAgICAgc2VsLmNsZWFyT3JkZXJp\nbmcoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdoZXJlUHJp\nbWFyeUtleShPYmplY3Qgb2lkLCBDbGFzc01hcHBpbmcgbWFwcGluZywKICAg\nICAgICAgICAgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgICAgIHNlbC53\naGVyZVByaW1hcnlLZXkob2lkLCBtYXBwaW5nLCBzdG9yZSk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZUZvcmVpZ25LZXkoRm9yZWln\nbktleSBmaywgT2JqZWN0IG9pZCwKICAgICAgICAgICAgQ2xhc3NNYXBwaW5n\nIG1hcHBpbmcsIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgICAgICBzZWwu\nd2hlcmVGb3JlaWduS2V5KGZrLCBvaWQsIG1hcHBpbmcsIHN0b3JlKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdoZXJlKEpvaW5zIGpvaW5z\nKSB7CiAgICAgICAgICAgIHNlbC53aGVyZShqb2lucyk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZShTUUxCdWZmZXIgc3FsKSB7CiAg\nICAgICAgICAgIHNlbC53aGVyZShzcWwpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIHZvaWQgd2hlcmUoU1FMQnVmZmVyIHNxbCwgSm9pbnMgam9pbnMp\nIHsKICAgICAgICAgICAgc2VsLndoZXJlKHNxbCwgam9pbnMpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgd2hlcmUoU3RyaW5nIHNxbCkgewog\nICAgICAgICAgICBzZWwud2hlcmUoc3FsKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyB2b2lkIHdoZXJlKFN0cmluZyBzcWwsIEpvaW5zIGpvaW5zKSB7\nCiAgICAgICAgICAgIHNlbC53aGVyZShzcWwsIGpvaW5zKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTUUxCdWZmZXIgc3FsKSB7\nCiAgICAgICAgICAgIHNlbC5oYXZpbmcoc3FsKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTUUxCdWZmZXIgc3FsLCBKb2lucyBq\nb2lucykgewogICAgICAgICAgICBzZWwuaGF2aW5nKHNxbCwgam9pbnMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgaGF2aW5nKFN0cmluZyBz\ncWwpIHsKICAgICAgICAgICAgc2VsLmhhdmluZyhzcWwpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgaGF2aW5nKFN0cmluZyBzcWwsIEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5oYXZpbmcoc3FsLCBqb2lucyk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBncm91cEJ5KFNRTEJ1\nZmZlciBzcWwpIHsKICAgICAgICAgICAgc2VsLmdyb3VwQnkoc3FsKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoU1FMQnVmZmVy\nIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgc2VsLmdyb3VwQnko\nc3FsLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBn\ncm91cEJ5KFN0cmluZyBzcWwpIHsKICAgICAgICAgICAgc2VsLmdyb3VwQnko\nc3FsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdyb3VwQnko\nU3RyaW5nIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgc2VsLmdy\nb3VwQnkoc3FsLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBncm91cEJ5KENvbHVtbiBjb2wpIHsKICAgICAgICAgICAgc2VsLmdy\nb3VwQnkoY29sKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdy\nb3VwQnkoQ29sdW1uIGNvbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAg\nc2VsLmdyb3VwQnkoY29sLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBncm91cEJ5KENvbHVtbltdIGNvbHMpIHsKICAgICAgICAg\nICAgc2VsLmdyb3VwQnkoY29scyk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCBncm91cEJ5KENvbHVtbltdIGNvbHMsIEpvaW5zIGpvaW5zKSB7\nCiAgICAgICAgICAgIHNlbC5ncm91cEJ5KGNvbHMsIGpvaW5zKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoQ2xhc3NNYXBwaW5n\nIG1hcHBpbmcsIGludCBzdWJjbGFzc2VzLCAKICAgICAgICAgICAgSkRCQ1N0\nb3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAg\nICAgICAgICAgIHNlbC5ncm91cEJ5KG1hcHBpbmcsIHN1YmNsYXNzZXMsIHN0\nb3JlLCBmZXRjaCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBn\ncm91cEJ5KENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3Nlcywg\nCiAgICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmln\ndXJhdGlvbiBmZXRjaCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgc2Vs\nLmdyb3VwQnkobWFwcGluZywgc3ViY2xhc3Nlcywgc3RvcmUsIGZldGNoLCBq\nb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU2VsZWN0RXhlY3V0\nb3Igd2hlcmVDbG9uZShpbnQgc2VscykgewogICAgICAgICAgICByZXR1cm4g\nc2VsLndoZXJlQ2xvbmUoc2Vscyk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgU2VsZWN0RXhlY3V0b3IgZnVsbENsb25lKGludCBzZWxzKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwuZnVsbENsb25lKHNlbHMpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFNlbGVjdEV4ZWN1dG9yIGVhZ2VyQ2xvbmUoRmll\nbGRNYXBwaW5nIGtleSwgaW50IGVhZ2VyVHlwZSwKICAgICAgICAgICAgYm9v\nbGVhbiB0b01hbnksIGludCBzZWxzKSB7CiAgICAgICAgICAgIFNlbGVjdEV4\nZWN1dG9yIGV4ID0gc2VsLmVhZ2VyQ2xvbmUoa2V5LCBlYWdlclR5cGUsIHRv\nTWFueSwgc2Vscyk7CiAgICAgICAgICAgIHJldHVybiAoZXggPT0gc2VsKSA/\nIHRoaXMgOiBleDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTZWxlY3RF\neGVjdXRvciBnZXRFYWdlcihGaWVsZE1hcHBpbmcga2V5KSB7CiAgICAgICAg\nICAgIFNlbGVjdEV4ZWN1dG9yIGV4ID0gc2VsLmdldEVhZ2VyKGtleSk7CiAg\nICAgICAgICAgIHJldHVybiAoZXggPT0gc2VsKSA/IHRoaXMgOiBleDsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBuZXdKb2lucygpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5uZXdKb2lucygpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIEpvaW5zIG5ld091dGVySm9pbnMoKSB7CiAgICAgICAg\nICAgIHJldHVybiBzZWwubmV3T3V0ZXJKb2lucygpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHZvaWQgYXBwZW5kKFNRTEJ1ZmZlciBidWYsIEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5hcHBlbmQoYnVmLCBqb2lucyk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMgYW5kKEpvaW5zIGpv\naW5zMSwgSm9pbnMgam9pbnMyKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\nYW5kKGpvaW5zMSwgam9pbnMyKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBKb2lucyBvcihKb2lucyBqb2luczEsIEpvaW5zIGpvaW5zMikgewogICAg\nICAgICAgICByZXR1cm4gc2VsLm9yKGpvaW5zMSwgam9pbnMyKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBvdXRlcihKb2lucyBqb2lucykg\newogICAgICAgICAgICByZXR1cm4gc2VsLm91dGVyKGpvaW5zKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwudG9TdHJpbmcoKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBpbnQgZ2V0RXhwZWN0ZWRSZXN1bHRDb3VudCgpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5nZXRFeHBlY3RlZFJlc3VsdENvdW50KCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRFeHBlY3RlZFJl\nc3VsdENvdW50KGludCBleHBlY3RlZFJlc3VsdENvdW50LCAKICAgICAgICAg\nICAgYm9vbGVhbiBmb3JjZSkgewogICAgICAgICAgICBzZWwuc2V0RXhwZWN0\nZWRSZXN1bHRDb3VudChleHBlY3RlZFJlc3VsdENvdW50LCBmb3JjZSk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRDb250ZXh0KENvbnRl\neHQgY29udGV4dCkgewogICAgICAgICAgICBzZWwuc2V0Q29udGV4dChjb250\nZXh0KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDb250ZXh0IGN0eCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5jdHgoKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHNldFNjaGVtYUFsaWFzKFN0cmluZyBzY2hl\nbWFBbGlhcykgewogICAgICAgICAgICBzZWwuc2V0U2NoZW1hQWxpYXMoc2No\nZW1hQWxpYXMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgbG9n\nRWFnZXJSZWxhdGlvbnMoKSB7CiAgICAgICAgICAgIHNlbC5sb2dFYWdlclJl\nbGF0aW9ucygpOyAgICAgICAgICAgIAogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIENvbXBhcmF0b3IgZm9yIGNvbGxhdGluZyBvcmRlcmVkIHJl\nc3VsdHMgd2hlbiBmYWtpbmcgYSB1bmlvbi4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgY2xhc3MgUmVzdWx0Q29tcGFyYXRvcgogICAgICAgIGltcGxl\nbWVudHMgTWVyZ2VkUmVzdWx0LlJlc3VsdENvbXBhcmF0b3IgewoKICAgICAg\nICBwcml2YXRlIGZpbmFsIExpc3RbXSBfb3JkZXJzOwogICAgICAgIHByaXZh\ndGUgZmluYWwgQml0U2V0IF9kZXNjOwogICAgICAgIHByaXZhdGUgZmluYWwg\nREJEaWN0aW9uYXJ5IF9kaWN0OwoKICAgICAgICBwdWJsaWMgUmVzdWx0Q29t\ncGFyYXRvcihMaXN0W10gb3JkZXJzLCBCaXRTZXQgZGVzYywgREJEaWN0aW9u\nYXJ5IGRpY3QpIHsKICAgICAgICAgICAgX29yZGVycyA9IG9yZGVyczsKICAg\nICAgICAgICAgX2Rlc2MgPSBkZXNjOwogICAgICAgICAgICBfZGljdCA9IGRp\nY3Q7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IGdldE9yZGVy\naW5nVmFsdWUoUmVzdWx0IHJlcywgaW50IGlkeCkgewogICAgICAgICAgICAv\nLyBpZiBvbmUgdmFsdWUganVzdCByZXR1cm4gaXQKICAgICAgICAgICAgUmVz\ndWx0U2V0IHJzID0gKChSZXN1bHRTZXRSZXN1bHQpIHJlcykuZ2V0UmVzdWx0\nU2V0KCk7CiAgICAgICAgICAgIGlmIChfb3JkZXJzW2lkeF0uc2l6ZSgpID09\nIDEpCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0T3JkZXJpbmdWYWx1ZShy\ncywgX29yZGVyc1tpZHhdLmdldCgwKSk7CgogICAgICAgICAgICAvLyByZXR1\ncm4gYXJyYXkgb2YgdmFsdWVzCiAgICAgICAgICAgIE9iamVjdFtdIHZhbHMg\nPSBuZXcgT2JqZWN0W19vcmRlcnNbaWR4XS5zaXplKCldOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICB2YWxzW2ldID0gZ2V0T3JkZXJpbmdWYWx1ZShycywgX29y\nZGVyc1tpZHhdLmdldChpKSk7CiAgICAgICAgICAgIHJldHVybiB2YWxzOwog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogRXh0cmFjdCB2YWx1\nZSBhdCBnaXZlbiBpbmRleCBmcm9tIHJlc3VsdCBzZXQuCiAgICAgICAgICov\nCiAgICAgICAgcHJpdmF0ZSBPYmplY3QgZ2V0T3JkZXJpbmdWYWx1ZShSZXN1\nbHRTZXQgcnMsIE9iamVjdCBpKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gX2RpY3QuZ2V0T2JqZWN0KHJzLCAoKEludGVn\nZXIpIGkpLmludFZhbHVlKCkgKyAxLCBudWxsKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBTUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCBfZGljdCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgY29tcGFyZShP\nYmplY3QgbzEsIE9iamVjdCBvMikgewogICAgICAgICAgICBpZiAobzEgPT0g\nbzIpCiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgaWYg\nKG8xID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNjLmdl\ndCgwKSkgPyAtMSA6IDE7CiAgICAgICAgICAgIGlmIChvMiA9PSBudWxsKQog\nICAgICAgICAgICAgICAgcmV0dXJuIChfZGVzYy5nZXQoMCkpID8gMSA6IC0x\nOwoKICAgICAgICAgICAgaW50IGNtcDsKICAgICAgICAgICAgaWYgKCEobzEg\naW5zdGFuY2VvZiBPYmplY3RbXSkpIHsKICAgICAgICAgICAgICAgIGlmICgh\nKG8yIGluc3RhbmNlb2YgT2JqZWN0W10pKSB7CiAgICAgICAgICAgICAgICAg\nICAgY21wID0gKChDb21wYXJhYmxlKSBvMSkuY29tcGFyZVRvKG8yKTsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNjLmdldCgwKSkgPyAtY21w\nIDogY21wOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNt\ncCA9ICgoQ29tcGFyYWJsZSkgbzEpLmNvbXBhcmVUbygoKE9iamVjdFtdKSBv\nMilbMF0pOwogICAgICAgICAgICAgICAgaWYgKGNtcCAhPSAwKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiAoX2Rlc2MuZ2V0KDApKSA/IC1jbXAgOiBj\nbXA7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGlmICghKG8yIGluc3RhbmNlb2YgT2JqZWN0W10pKSB7\nCiAgICAgICAgICAgICAgICBjbXAgPSAoKENvbXBhcmFibGUpICgoT2JqZWN0\nW10pIG8xKVswXSkuY29tcGFyZVRvKG8yKTsKICAgICAgICAgICAgICAgIGlm\nIChjbXAgIT0gMCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKF9kZXNj\nLmdldCgwKSkgPyAtY21wIDogY21wOwogICAgICAgICAgICAgICAgcmV0dXJu\nIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE9iamVjdFtdIGExID0g\nKE9iamVjdFtdKSBvMTsKICAgICAgICAgICAgT2JqZWN0W10gYTIgPSAoT2Jq\nZWN0W10pIG8yOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGEx\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjbXAgPSAoKENvbXBh\ncmFibGUpIGExW2ldKS5jb21wYXJlVG8oYTJbaV0pOwogICAgICAgICAgICAg\nICAgaWYgKGNtcCAhPSAwKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAo\nX2Rlc2MuZ2V0KGkpKSA/IC1jbXAgOiBjbXA7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcmV0dXJuIGExLmxlbmd0aCAtIGEyLmxlbmd0aDsKICAgICAg\nICB9CiAgICB9Cn0K\n","encoding":"base64"}

