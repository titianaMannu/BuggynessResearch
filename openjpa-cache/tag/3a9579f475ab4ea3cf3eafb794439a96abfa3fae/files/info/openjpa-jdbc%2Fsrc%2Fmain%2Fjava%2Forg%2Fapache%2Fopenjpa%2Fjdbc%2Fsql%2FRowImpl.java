{"sha":"4a88315d74fa82fe2805d15ead6c3c704b48769e","node_id":"MDQ6QmxvYjIwNjM2NDo0YTg4MzE1ZDc0ZmE4MmZlMjgwNWQxNWVhZDZjM2M3MDRiNDg3Njll","size":29688,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4a88315d74fa82fe2805d15ead6c3c704b48769e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUmVhZGVyOwpp\nbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9ydCBqYXZhLm1hdGgu\nQmlnSW50ZWdlcjsKaW1wb3J0IGphdmEuc3FsLkFycmF5OwppbXBvcnQgamF2\nYS5zcWwuQmxvYjsKaW1wb3J0IGphdmEuc3FsLkNsb2I7CmltcG9ydCBqYXZh\nLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuc3FsLlRpbWU7CmltcG9ydCBqYXZhLnNx\nbC5UaW1lc3RhbXA7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9y\ndCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5Mb2NhbGU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9y\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NN\nYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5K\nYXZhU1FMVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkpvaW5hYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5SZWxhdGlvbklkOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW5JTzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247CgovKioKICog\nQmFzaWMge0BsaW5rIFJvd30gaW1wbGVtZW50YXRpb24uCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBS\nb3dJbXBsCiAgICBpbXBsZW1lbnRzIFJvdywgQ2xvbmVhYmxlIHsKCiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIE9iamVjdCBOVUxMID0gbmV3IE9iamVjdCgp\nOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgVkFMSUQgPSAyIDw8\nIDA7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgUkFXID0gSW50ZWdl\nci5NSU5fVkFMVUU7CgogICAgcHJvdGVjdGVkIGJ5dGUgZmxhZ3MgPSAwOwog\nICAgcHJpdmF0ZSBmaW5hbCBDb2x1bW5bXSBfY29sczsKICAgIHByaXZhdGUg\nZmluYWwgaW50IF9hY3Rpb247CiAgICBwcml2YXRlIGZpbmFsIE9iamVjdFtd\nIF92YWxzOwogICAgcHJpdmF0ZSBmaW5hbCBpbnRbXSBfdHlwZXM7CgogICAg\ncHJpdmF0ZSBTdHJpbmcgX3NxbCA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xl\nYW4gX2lzRmx1c2hlZCA9IGZhbHNlOwoKICAgIC8qKgogICAgICogQ29uc3Ry\ndWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIHRhYmxlIHRoZSB0YWJsZSB0\naGUgcm93IGlzIGEgcGFydCBvZgogICAgICogQHBhcmFtIGFjdGlvbiB0aGUg\nYWN0aW9uIG9uIHRoZSByb3cKICAgICAqLwogICAgcHVibGljIFJvd0ltcGwo\nVGFibGUgdGFibGUsIGludCBhY3Rpb24pIHsKICAgICAgICB0aGlzKHRhYmxl\nLmdldENvbHVtbnMoKSwgYWN0aW9uKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nUm93SW1wbChDb2x1bW5bXSBjb2xzLCBpbnQgYWN0aW9uKSB7CiAgICAgICAg\nX2NvbHMgPSBjb2xzOwogICAgICAgIF9hY3Rpb24gPSBhY3Rpb247CgogICAg\nICAgIC8vIHdlIG5lZWQgcm9vbSBmb3IgdmFsdWVzIGFuZCB0eXBlcyBmb3Ig\nYWxsIGNvbHVtbnM7IGlmIGFuIHVwZGF0ZSBvcgogICAgICAgIC8vIGRlbGV0\nZSwgdGhlbiB3ZSBuZWVkIHRvIGRvdWJsZSB0aGF0IGZvciB3aGVyZSBjb2x1\nbW4gY29uZGl0aW9ucwogICAgICAgIGludCBsZW4gPSBfY29scy5sZW5ndGg7\nCiAgICAgICAgaWYgKGFjdGlvbiAhPSBBQ1RJT05fSU5TRVJUKQogICAgICAg\nICAgICBsZW4gKj0gMjsKICAgICAgICBfdmFscyA9IG5ldyBPYmplY3RbbGVu\nXTsKICAgICAgICBfdHlwZXMgPSBuZXcgaW50W2xlbl07CiAgICB9CgogICAg\ncHVibGljIFRhYmxlIGdldFRhYmxlKCkgewogICAgICAgIHJldHVybiBfY29s\nc1swXS5nZXRUYWJsZSgpOwogICAgfQoKICAgIHB1YmxpYyBDb2x1bW5bXSBn\nZXRDb2x1bW5zKCkgewogICAgICAgIHJldHVybiBfY29sczsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IGdldEFjdGlvbigpIHsKICAgICAgICByZXR1cm4gX2Fj\ndGlvbjsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1ZhbGlkKCkgewog\nICAgICAgIHJldHVybiAoZmxhZ3MgJiBWQUxJRCkgIT0gMDsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRWYWxpZChib29sZWFuIHZhbGlkKSB7CiAgICAg\nICAgaWYgKHZhbGlkKQogICAgICAgICAgICBmbGFncyB8PSBWQUxJRDsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIGZsYWdzICY9IH5WQUxJRDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoaXMgaW1wbGVtZW50YXRpb24gZG9lcyBub3Qg\ndHJhY2sgcHJpbWFyeSBrZXlzLgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQ\nQVN0YXRlTWFuYWdlciBnZXRQcmltYXJ5S2V5KCkgewogICAgICAgIHJldHVy\nbiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBpbXBsZW1lbnRh\ndGlvbiBkb2VzIG5vdCB0cmFjayBmYWlsZWQgb2JqZWN0cy4KICAgICAqLwog\nICAgcHVibGljIE9iamVjdCBnZXRGYWlsZWRPYmplY3QoKSB7CiAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIGltcGxl\nbWVudGF0aW9uIGRvZXMgbm90IHRyYWNrIGZhaWxlZCBvYmplY3RzLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRGYWlsZWRPYmplY3QoT2JqZWN0IGZh\naWxlZCkgewogICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2Vjb25kYXJ5IHJvd3MgY2Fubm90\nIGJlIGRlcGVuZGVudC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNE\nZXBlbmRlbnQoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSB2YWx1ZSBzZXQgZm9yIHVwZGF0ZSBv\nbiB0aGUgZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0\nIGdldFNldChDb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJuIF92YWxzW2dl\ndFNldEluZGV4KGNvbCldOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSB2YWx1ZSBzZXQgZm9yIHdoZXJlIG9uIHRoZSBnaXZlbiBjb2x1bW4u\nCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0V2hlcmUoQ29sdW1uIGNv\nbCkgewogICAgICAgIHJldHVybiBfdmFsc1tnZXRXaGVyZUluZGV4KGNvbCld\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXkoT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzZXRQcmltYXJ5S2V5KG51bGwsIHNtKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRQcmltYXJ5S2V5KENvbHVtbklPIGlvLCBPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIGZsdXNoUHJpbWFyeUtleShzbSwgaW8sIHRydWUpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlUHJpbWFyeUtleShPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGZsdXNoUHJpbWFyeUtleShzbSwgbnVsbCwgZmFsc2UpOwog\nICAgfQoKICAgIC8qKgogICAgICogRmx1c2ggdGhlIHByaW1hcnkga2V5IHZh\nbHVlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGZsdXNoUHJpbWFyeUtl\neShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBDb2x1bW5JTyBpbywKICAgICAg\nICBib29sZWFuIHNldCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IChDbGFzc01hcHBpbmcp\nIHNtLmdldE1ldGFEYXRhKCk7CiAgICAgICAgd2hpbGUgKG1hcHBpbmcuZ2V0\nVGFibGUoKSAhPSBnZXRUYWJsZSgpKQogICAgICAgICAgICBtYXBwaW5nID0g\nbWFwcGluZy5nZXRQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAgICAgICAgQ29s\ndW1uW10gY29scyA9IG1hcHBpbmcuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKTsK\nICAgICAgICBPYmplY3Qgb2lkID0gbWFwcGluZy51c2VJZENsYXNzRnJvbVBh\ncmVudCgpID8gc20uZ2V0T2JqZWN0SWQoKSA6IG51bGw7CiAgICAgICAgZmx1\nc2hKb2luVmFsdWVzKHNtLCBvaWQsIGNvbHMsIGNvbHMsIGlvLCBzZXQpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEZvcmVpZ25LZXkoRm9yZWlnbktl\neSBmaywgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRGb3JlaWduS2V5KGZrLCBudWxs\nLCBzbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Rm9yZWlnbktleShG\nb3JlaWduS2V5IGZrLCBDb2x1bW5JTyBpbywKICAgICAgICBPcGVuSlBBU3Rh\ndGVNYW5hZ2VyIHNtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGZsdXNoRm9yZWlnbktleShmaywgaW8sIHNtLCB0cnVlKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUZvcmVpZ25LZXkoRm9yZWlnbktl\neSBmaywgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBmbHVzaEZvcmVpZ25LZXkoZmssIG51\nbGwsIHNtLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciBh\nIGNpcmN1bGFyIGZvcmVpZ24ga2V5LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBjbGVhckZvcmVpZ25LZXkoRm9yZWlnbktleSBmaykKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBfc3FsID0gbnVsbDsKICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gZmsuZ2V0Q29sdW1ucygpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgX3ZhbHNbZ2V0U2V0SW5kZXgoY29sc1tpXSldID0gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIEZsdXNoIHRoZSBmb3JlaWduIGtleSB2YWx1ZXMu\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBmbHVzaEZvcmVpZ25LZXkoRm9y\nZWlnbktleSBmaywgQ29sdW1uSU8gaW8sCiAgICAgICAgT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwgYm9vbGVhbiBzZXQpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgZmx1c2hKb2luVmFsdWVzKHNtLCBudWxsLCBm\nay5nZXRQcmltYXJ5S2V5Q29sdW1ucygpLCBmay5nZXRDb2x1bW5zKCksCiAg\nICAgICAgICAgIGlvLCBzZXQpOwogICAgICAgIGlmIChzbSAhPSBudWxsKSB7\nCiAgICAgICAgICAgIENvbHVtbltdIGNvbHMgPSBmay5nZXRDb25zdGFudENv\nbHVtbnMoKTsKICAgICAgICAgICAgaW50IGxlbiA9IGZrLmdldENvbHVtbnMo\nKS5sZW5ndGg7CiAgICAgICAgICAgIE9iamVjdCBvYmo7CiAgICAgICAgICAg\nIGludCB0eXBlOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNv\nbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIG9iaiA9IGZrLmdl\ndENvbnN0YW50KGNvbHNbaV0pOwogICAgICAgICAgICAgICAgdHlwZSA9IGNv\nbHNbaV0uZ2V0SmF2YVR5cGUoKTsKICAgICAgICAgICAgICAgIGlmIChzZXQg\nJiYgY2FuU2V0KGlvLCBpICsgbGVuLCBvYmogPT0gbnVsbCkpCiAgICAgICAg\nICAgICAgICAgICAgc2V0T2JqZWN0KGNvbHNbaV0sIG9iaiwgdHlwZSwgZmFs\nc2UpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoIXNldCkKICAgICAgICAg\nICAgICAgICAgICB3aGVyZU9iamVjdChjb2xzW2ldLCBvYmosIHR5cGUpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nRmx1c2ggdGhlIGdpdmVuIGluc3RhbmNlIHZhbHVlIHRvIHRoZSBnaXZlbiBj\nb2x1bW5zLiBOb3RlIHRoYXQKICAgICAqIGZvcmVpZ24ga2V5cyBtYXkgaW5j\nbHVkZSBjb2x1bW5zIGFsc28gbWFwcGVkIGJ5IHNpbXBsZSB2YWx1ZXMuIFdl\nCiAgICAgKiB1c2UgYSBwcmlvcml0eSBtZWNoYW5pc20gdG8gZW5zdXJlIHRo\nYXQgd2UgZG8gbm90IGxldCB0aGUgbnVsbGluZwogICAgICogb2YgYSBmb3Jl\naWduIGtleSBudWxsIGNvbHVtbnMgYWxzbyBvd25lZCBieSBzaW1wbGUgdmFs\ndWVzLgogICAgICoKICAgICAqIEBwYXJhbSB0byB0aGUgaW5zdGFuY2UgYmVp\nbmcgam9pbmVkIHRvCiAgICAgKiBAcGFyYW0gdG9Db2xzIHRoZSBjb2x1bW5z\nIGJlaW5nIGpvaW5lZCB0bwogICAgICogQHBhcmFtIGZyb21Db2xzIHRoZSBj\nb2x1bW5zIGJlaW5nIGpvaW5lZCBmcm9tCiAgICAgKiBAcGFyYW0gaW8gaW5m\nb3JtYXRpb24gYWJvdXQgSS9PIGNhcGFiaWxpdGllcyBpbiB0aGlzIGNvbnRl\neHQKICAgICAqIEBwYXJhbSBzZXQgd2hldGhlciB0aGlzIHNob3VsZCBiZSBm\nbHVzaGVkIGFzIGFuIHVwZGF0ZSBvcgogICAgICogYXMgYSB3aGVyZSBjb25k\naXRpb24KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGZsdXNoSm9pblZhbHVl\ncyhPcGVuSlBBU3RhdGVNYW5hZ2VyIHRvLCBPYmplY3Qgb2lkLCBDb2x1bW5b\nXSB0b0NvbHMsCiAgICAgICAgQ29sdW1uW10gZnJvbUNvbHMsIENvbHVtbklP\nIGlvLCBib29sZWFuIHNldCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAodG8gPT0gbnVsbCkgewogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGZyb21Db2xzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgICAgICBpZiAoc2V0ICYmIGNhblNldChpbywgaSwgdHJ1ZSkpCiAg\nICAgICAgICAgICAgICAgICAgc2V0TnVsbChmcm9tQ29sc1tpXSk7CiAgICAg\nICAgICAgICAgICBlbHNlIGlmICghc2V0KQogICAgICAgICAgICAgICAgICAg\nIHdoZXJlTnVsbChmcm9tQ29sc1tpXSk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoc2V0ICYmICFj\nYW5TZXRBbnkoaW8sIGZyb21Db2xzLmxlbmd0aCwgZmFsc2UpKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIENsYXNzTWFwcGluZyB0b01hcHBpbmcg\nPSAoQ2xhc3NNYXBwaW5nKSB0by5nZXRNZXRhRGF0YSgpOwogICAgICAgIEpv\naW5hYmxlIGpvaW47CiAgICAgICAgT2JqZWN0IHZhbDsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHRvQ29scy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICAvLyBkb24ndCBldmVuIHRyYW5zbGF0ZSBqb2luIHZhbHVlIGlmIHVu\nc2V0dGFibGUKICAgICAgICAgICAgaWYgKHNldCkgewogICAgICAgICAgICAg\nICAgaWYgKF9hY3Rpb24gPT0gQUNUSU9OX0lOU0VSVCAmJiBmcm9tQ29sc1tp\nXS5pc0F1dG9Bc3NpZ25lZCgpKQogICAgICAgICAgICAgICAgICAgIGNvbnRp\nbnVlOwogICAgICAgICAgICAgICAgaWYgKCFjYW5TZXQoaW8sIGksIGZhbHNl\nKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgam9pbiA9IHRvTWFwcGluZy5hc3NlcnRKb2luYWJs\nZSh0b0NvbHNbaV0pOwogICAgICAgICAgICBpZiAob2lkICE9IG51bGwpCiAg\nICAgICAgICAgICAgICB2YWwgPSBqb2luLmdldEpvaW5WYWx1ZShvaWQsIHRv\nQ29sc1tpXSwgKEpEQkNTdG9yZSkgdG8uCiAgICAgICAgICAgICAgICAgICAg\nZ2V0Q29udGV4dCgpLmdldFN0b3JlTWFuYWdlcigpLmdldElubmVybW9zdERl\nbGVnYXRlKCkpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB2\nYWwgPSBqb2luLmdldEpvaW5WYWx1ZSh0bywgdG9Db2xzW2ldLCAoSkRCQ1N0\nb3JlKSB0by4KICAgICAgICAgICAgICAgICAgICBnZXRDb250ZXh0KCkuZ2V0\nU3RvcmVNYW5hZ2VyKCkuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKSk7CiAgICAg\nICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHNldCAmJiB2YWwgPT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgaWYgKGNhblNldChpbywgaSwgdHJ1ZSkp\nCiAgICAgICAgICAgICAgICAgICAgc2V0TnVsbChmcm9tQ29sc1tpXSk7CiAg\nICAgICAgICAgIH0gZWxzZSBpZiAoc2V0ICYmIHZhbCBpbnN0YW5jZW9mIFJh\ndykKICAgICAgICAgICAgICAgIHNldFJhdyhmcm9tQ29sc1tpXSwgdmFsLnRv\nU3RyaW5nKCkpOwogICAgICAgICAgICBlbHNlIGlmIChzZXQpCiAgICAgICAg\nICAgICAgICBzZXRPYmplY3QoZnJvbUNvbHNbaV0sIHZhbCwgdG9Db2xzW2ld\nLmdldEphdmFUeXBlKCksIGZhbHNlKTsKICAgICAgICAgICAgZWxzZSBpZiAo\ndmFsID09IG51bGwpCiAgICAgICAgICAgICAgICB3aGVyZU51bGwoZnJvbUNv\nbHNbaV0pOwogICAgICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBS\nYXcpCiAgICAgICAgICAgICAgICB3aGVyZVJhdyhmcm9tQ29sc1tpXSwgdmFs\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICB3aGVyZU9iamVjdChmcm9tQ29sc1tpXSwgdmFsLCB0b0NvbHNbaV0uZ2V0\nSmF2YVR5cGUoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRydWUgaWYgYW55IG9mIHRoZSBnaXZlbiBjb2x1bW4gaW5kZXhl\ncyBhcmUgc2V0dGFibGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIGNhblNldEFueShDb2x1bW5JTyBpbywgaW50IGksIGJvb2xlYW4gbnVsbFZh\nbHVlKSB7CiAgICAgICAgaWYgKGlvID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgIGlmIChfYWN0aW9uID09IEFDVElPTl9JTlNF\nUlQpCiAgICAgICAgICAgIHJldHVybiBpby5pc0FueUluc2VydGFibGUoaSwg\nbnVsbFZhbHVlKTsKICAgICAgICBpZiAoX2FjdGlvbiA9PSBBQ1RJT05fVVBE\nQVRFKQogICAgICAgICAgICByZXR1cm4gaW8uaXNBbnlVcGRhdGFibGUoaSwg\nbnVsbFZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBjb2x1bW4gaW5k\nZXggaXMgc2V0dGFibGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIGNhblNldChDb2x1bW5JTyBpbywgaW50IGksIGJvb2xlYW4gbnVsbFZhbHVl\nKSB7CiAgICAgICAgaWYgKGlvID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiB0cnVlOwogICAgICAgIGlmIChfYWN0aW9uID09IEFDVElPTl9JTlNFUlQp\nCiAgICAgICAgICAgIHJldHVybiBpby5pc0luc2VydGFibGUoaSwgbnVsbFZh\nbHVlKTsKICAgICAgICBpZiAoX2FjdGlvbiA9PSBBQ1RJT05fVVBEQVRFKQog\nICAgICAgICAgICByZXR1cm4gaW8uaXNVcGRhdGFibGUoaSwgbnVsbFZhbHVl\nKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRSZWxhdGlvbklkKENvbHVtbiBjb2wsIE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20sCiAgICAgICAgUmVsYXRpb25JZCByZWwpCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNvbCwgcmVsLnRv\nUmVsYXRpb25EYXRhU3RvcmVWYWx1ZShzbSwgY29sKSwKICAgICAgICAgICAg\nY29sLmdldEphdmFUeXBlKCksIGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENsZWFyIGEgY2lyY3VsYXIgcmVsYXRpb24gaWQuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIGNsZWFyUmVsYXRpb25JZChDb2x1bW4gY29sKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIF9zcWwgPSBudWxs\nOwogICAgICAgIF92YWxzW2dldFNldEluZGV4KGNvbCldID0gbnVsbDsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRBcnJheShDb2x1bW4gY29sLCBBcnJh\neSB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nc2V0T2JqZWN0KGNvbCwgdmFsLCBKYXZhU1FMVHlwZXMuQVJSQVksIGZhbHNl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRBc2NpaVN0cmVhbShDb2x1\nbW4gY29sLCBJbnB1dFN0cmVhbSB2YWwsIGludCBsZW5ndGgpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNvbCwg\nKHZhbCA9PSBudWxsKSA/IG51bGwgOiBuZXcgU2l6ZWQodmFsLCBsZW5ndGgp\nLAogICAgICAgICAgICBKYXZhU1FMVHlwZXMuQVNDSUlfU1RSRUFNLCBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QmlnRGVjaW1hbChDb2x1\nbW4gY29sLCBCaWdEZWNpbWFsIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCB2YWwsIEphdmFUeXBl\ncy5CSUdERUNJTUFMLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0QmlnSW50ZWdlcihDb2x1bW4gY29sLCBCaWdJbnRlZ2VyIHZhbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3Qo\nY29sLCB2YWwsIEphdmFUeXBlcy5CSUdJTlRFR0VSLCBmYWxzZSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0QmluYXJ5U3RyZWFtKENvbHVtbiBjb2ws\nIElucHV0U3RyZWFtIHZhbCwgaW50IGxlbmd0aCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCAodmFsID09\nIG51bGwpID8gbnVsbCA6IG5ldyBTaXplZCh2YWwsIGxlbmd0aCksCiAgICAg\nICAgICAgIEphdmFTUUxUeXBlcy5CSU5BUllfU1RSRUFNLCBmYWxzZSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0QmxvYihDb2x1bW4gY29sLCBCbG9i\nIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBz\nZXRPYmplY3QoY29sLCB2YWwsIEphdmFTUUxUeXBlcy5CTE9CLCBmYWxzZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Qm9vbGVhbihDb2x1bW4gY29s\nLCBib29sZWFuIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBzZXRPYmplY3QoY29sLCAoKHZhbCkgPyBCb29sZWFuLlRSVUUg\nOiBCb29sZWFuLkZBTFNFKSwKICAgICAgICAgICAgSmF2YVR5cGVzLkJPT0xF\nQU4sIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRCeXRlKENv\nbHVtbiBjb2wsIGJ5dGUgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHNldE9iamVjdChjb2wsIG5ldyBCeXRlKHZhbCksIEph\ndmFUeXBlcy5CWVRFLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0Qnl0ZXMoQ29sdW1uIGNvbCwgYnl0ZVtdIHZhbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCB2YWws\nIEphdmFTUUxUeXBlcy5CWVRFUywgZmFsc2UpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldENhbGVuZGFyKENvbHVtbiBjb2wsIENhbGVuZGFyIHZhbCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmpl\nY3QoY29sLCB2YWwsIEphdmFUeXBlcy5DQUxFTkRBUiwgZmFsc2UpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldENoYXIoQ29sdW1uIGNvbCwgY2hhciB2\nYWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0\nT2JqZWN0KGNvbCwgbmV3IENoYXJhY3Rlcih2YWwpLCBKYXZhVHlwZXMuQ0hB\nUiwgZmFsc2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENoYXJhY3Rl\nclN0cmVhbShDb2x1bW4gY29sLCBSZWFkZXIgdmFsLCBpbnQgbGVuZ3RoKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldE9iamVj\ndChjb2wsICh2YWwgPT0gbnVsbCkgPyBudWxsIDogbmV3IFNpemVkKHZhbCwg\nbGVuZ3RoKSwKICAgICAgICAgICAgSmF2YVNRTFR5cGVzLkNIQVJfU1RSRUFN\nLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2xvYihDb2x1\nbW4gY29sLCBDbG9iIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzZXRPYmplY3QoY29sLCB2YWwsIEphdmFTUUxUeXBlcy5D\nTE9CLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGF0ZShD\nb2x1bW4gY29sLCBEYXRlIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCB2YWwsIEphdmFUeXBlcy5E\nQVRFLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGF0ZShD\nb2x1bW4gY29sLCBqYXZhLnNxbC5EYXRlIHZhbCwgQ2FsZW5kYXIgY2FsKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIE9iamVjdCBv\nYmo7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsIHx8IGNhbCA9PSBudWxsKQog\nICAgICAgICAgICBvYmogPSB2YWw7CiAgICAgICAgZWxzZQogICAgICAgICAg\nICBvYmogPSBuZXcgQ2FsZW5kYXJkKHZhbCwgY2FsKTsKICAgICAgICBzZXRP\nYmplY3QoY29sLCBvYmosIEphdmFTUUxUeXBlcy5TUUxfREFURSwgZmFsc2Up\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERvdWJsZShDb2x1bW4gY29s\nLCBkb3VibGUgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHNldE9iamVjdChjb2wsIG5ldyBEb3VibGUodmFsKSwgSmF2YVR5\ncGVzLkRPVUJMRSwgZmFsc2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndEZsb2F0KENvbHVtbiBjb2wsIGZsb2F0IHZhbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCBuZXcgRmxv\nYXQodmFsKSwgSmF2YVR5cGVzLkZMT0FULCBmYWxzZSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0SW50KENvbHVtbiBjb2wsIGludCB2YWwpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNv\nbCwgdmFsLCBKYXZhVHlwZXMuSU5ULCBmYWxzZSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0TG9uZyhDb2x1bW4gY29sLCBsb25nIHZhbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29s\nLCB2YWwsIEphdmFUeXBlcy5MT05HLCBmYWxzZSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0TG9jYWxlKENvbHVtbiBjb2wsIExvY2FsZSB2YWwpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0\nKGNvbCwgdmFsLCBKYXZhVHlwZXMuTE9DQUxFLCBmYWxzZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0TnVsbChDb2x1bW4gY29sKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldE51bGwoY29sLCBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TnVsbChDb2x1bW4gY29s\nLCBib29sZWFuIG92ZXJyaWRlRGVmYXVsdCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCBudWxsLCBjb2wu\nZ2V0SmF2YVR5cGUoKSwgb3ZlcnJpZGVEZWZhdWx0KTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXROdW1iZXIoQ29sdW1uIGNvbCwgTnVtYmVyIHZhbCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmpl\nY3QoY29sLCB2YWwsIEphdmFUeXBlcy5OVU1CRVIsIGZhbHNlKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRSYXcoQ29sdW1uIGNvbCwgU3RyaW5nIHZh\nbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRP\nYmplY3QoY29sLCB2YWwsIFJBVywgZmFsc2UpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldFNob3J0KENvbHVtbiBjb2wsIHNob3J0IHZhbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29s\nLCBuZXcgU2hvcnQodmFsKSwgSmF2YVR5cGVzLlNIT1JULCBmYWxzZSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0U3RyaW5nKENvbHVtbiBjb2wsIFN0\ncmluZyB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgc2V0T2JqZWN0KGNvbCwgdmFsLCBKYXZhVHlwZXMuU1RSSU5HLCBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VGltZShDb2x1bW4gY29s\nLCBUaW1lIHZhbCwgQ2FsZW5kYXIgY2FsKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIE9iamVjdCBvYmo7CiAgICAgICAgaWYgKHZh\nbCA9PSBudWxsIHx8IGNhbCA9PSBudWxsKQogICAgICAgICAgICBvYmogPSB2\nYWw7CiAgICAgICAgZWxzZQogICAgICAgICAgICBvYmogPSBuZXcgQ2FsZW5k\nYXJkKHZhbCwgY2FsKTsKICAgICAgICBzZXRPYmplY3QoY29sLCBvYmosIEph\ndmFTUUxUeXBlcy5USU1FLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0VGltZXN0YW1wKENvbHVtbiBjb2wsIFRpbWVzdGFtcCB2YWwsIENh\nbGVuZGFyIGNhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBPYmplY3Qgb2JqOwogICAgICAgIGlmICh2YWwgPT0gbnVsbCB8fCBj\nYWwgPT0gbnVsbCkKICAgICAgICAgICAgb2JqID0gdmFsOwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgb2JqID0gbmV3IENhbGVuZGFyZCh2YWwsIGNhbCk7\nCiAgICAgICAgc2V0T2JqZWN0KGNvbCwgb2JqLCBKYXZhU1FMVHlwZXMuVElN\nRVNUQU1QLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0T2Jq\nZWN0KENvbHVtbiBjb2wsIE9iamVjdCB2YWwpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFJhdykK\nICAgICAgICAgICAgc2V0T2JqZWN0KGNvbCwgdmFsLCBSQVcsIGZhbHNlKTsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIHNldE9iamVjdChjb2wsIHZhbCwg\nY29sLmdldEphdmFUeXBlKCksIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB3aGVyZUFycmF5KENvbHVtbiBjb2wsIEFycmF5IHZhbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChj\nb2wsIHZhbCwgSmF2YVNRTFR5cGVzLlNRTF9BUlJBWSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgd2hlcmVBc2NpaVN0cmVhbShDb2x1bW4gY29sLCBJbnB1\ndFN0cmVhbSB2YWwsIGludCBsZW5ndGgpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgd2hlcmVPYmplY3QoY29sLCAodmFsID09IG51\nbGwpID8gbnVsbCA6IG5ldyBTaXplZCh2YWwsIGxlbmd0aCksCiAgICAgICAg\nICAgIEphdmFTUUxUeXBlcy5BU0NJSV9TVFJFQU0pOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdoZXJlQmlnRGVjaW1hbChDb2x1bW4gY29sLCBCaWdEZWNp\nbWFsIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVzLkJJR0RFQ0lNQUwp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlQmlnSW50ZWdlcihDb2x1\nbW4gY29sLCBCaWdJbnRlZ2VyIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5\ncGVzLkJJR0lOVEVHRVIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJl\nQmluYXJ5U3RyZWFtKENvbHVtbiBjb2wsIElucHV0U3RyZWFtIHZhbCwgaW50\nIGxlbmd0aCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICB3aGVyZU9iamVjdChjb2wsICh2YWwgPT0gbnVsbCkgPyBudWxsIDogbmV3\nIFNpemVkKHZhbCwgbGVuZ3RoKSwKICAgICAgICAgICAgSmF2YVNRTFR5cGVz\nLkJJTkFSWV9TVFJFQU0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJl\nQmxvYihDb2x1bW4gY29sLCBCbG9iIHZhbCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2\nYVNRTFR5cGVzLkJMT0IpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJl\nQm9vbGVhbihDb2x1bW4gY29sLCBib29sZWFuIHZhbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsICgo\ndmFsKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0UpLAogICAgICAg\nICAgICBKYXZhVHlwZXMuQk9PTEVBTik7CiAgICB9CgogICAgcHVibGljIHZv\naWQgd2hlcmVCeXRlKENvbHVtbiBjb2wsIGJ5dGUgdmFsKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwg\nbmV3IEJ5dGUodmFsKSwgSmF2YVR5cGVzLkJZVEUpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdoZXJlQnl0ZXMoQ29sdW1uIGNvbCwgYnl0ZVtdIHZhbCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9i\namVjdChjb2wsIHZhbCwgSmF2YVNRTFR5cGVzLkJZVEVTKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB3aGVyZUNhbGVuZGFyKENvbHVtbiBjb2wsIENhbGVu\nZGFyIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVzLkNBTEVOREFSKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUNoYXIoQ29sdW1uIGNvbCwg\nY2hhciB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgd2hlcmVPYmplY3QoY29sLCBuZXcgQ2hhcmFjdGVyKHZhbCksIEphdmFU\neXBlcy5DSEFSKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUNoYXJh\nY3RlclN0cmVhbShDb2x1bW4gY29sLCBSZWFkZXIgdmFsLCBpbnQgbGVuZ3Ro\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHdoZXJl\nT2JqZWN0KGNvbCwgKHZhbCA9PSBudWxsKSA/IG51bGwgOiBuZXcgU2l6ZWQo\ndmFsLCBsZW5ndGgpLAogICAgICAgICAgICBKYXZhU1FMVHlwZXMuQ0hBUl9T\nVFJFQU0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlQ2xvYihDb2x1\nbW4gY29sLCBDbG9iIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVNRTFR5cGVz\nLkNMT0IpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlRGF0ZShDb2x1\nbW4gY29sLCBEYXRlIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVzLkRB\nVEUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlRGF0ZShDb2x1bW4g\nY29sLCBqYXZhLnNxbC5EYXRlIHZhbCwgQ2FsZW5kYXIgY2FsKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIE9iamVjdCBvYmo7CiAg\nICAgICAgaWYgKHZhbCA9PSBudWxsIHx8IGNhbCA9PSBudWxsKQogICAgICAg\nICAgICBvYmogPSB2YWw7CiAgICAgICAgZWxzZQogICAgICAgICAgICBvYmog\nPSBuZXcgQ2FsZW5kYXJkKHZhbCwgY2FsKTsKICAgICAgICB3aGVyZU9iamVj\ndChjb2wsIG9iaiwgSmF2YVNRTFR5cGVzLlNRTF9EQVRFKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB3aGVyZURvdWJsZShDb2x1bW4gY29sLCBkb3VibGUg\ndmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHdo\nZXJlT2JqZWN0KGNvbCwgbmV3IERvdWJsZSh2YWwpLCBKYXZhVHlwZXMuRE9V\nQkxFKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUZsb2F0KENvbHVt\nbiBjb2wsIGZsb2F0IHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIG5ldyBGbG9hdCh2YWwpLCBK\nYXZhVHlwZXMuRkxPQVQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJl\nSW50KENvbHVtbiBjb2wsIGludCB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgd2hlcmVPYmplY3QoY29sLCB2YWwsIEphdmFU\neXBlcy5JTlQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlTG9uZyhD\nb2x1bW4gY29sLCBsb25nIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVz\nLkxPTkcpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlTG9jYWxlKENv\nbHVtbiBjb2wsIExvY2FsZSB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgd2hlcmVPYmplY3QoY29sLCB2YWwsIEphdmFUeXBl\ncy5MT0NBTEUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlTnVsbChD\nb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHdoZXJlT2JqZWN0KGNvbCwgbnVsbCwgY29sLmdldEphdmFUeXBlKCkp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlTnVtYmVyKENvbHVtbiBj\nb2wsIE51bWJlciB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgd2hlcmVPYmplY3QoY29sLCB2YWwsIEphdmFUeXBlcy5OVU1C\nRVIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlUmF3KENvbHVtbiBj\nb2wsIFN0cmluZyB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgd2hlcmVPYmplY3QoY29sLCB2YWwsIFJBVyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgd2hlcmVTaG9ydChDb2x1bW4gY29sLCBzaG9ydCB2\nYWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgd2hl\ncmVPYmplY3QoY29sLCBuZXcgU2hvcnQodmFsKSwgSmF2YVR5cGVzLlNIT1JU\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZVN0cmluZyhDb2x1bW4g\nY29sLCBTdHJpbmcgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgdmFsLCBKYXZhVHlwZXMuU1RS\nSU5HKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZVRpbWUoQ29sdW1u\nIGNvbCwgVGltZSB2YWwsIENhbGVuZGFyIGNhbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBPYmplY3Qgb2JqOwogICAgICAgIGlm\nICh2YWwgPT0gbnVsbCB8fCBjYWwgPT0gbnVsbCkKICAgICAgICAgICAgb2Jq\nID0gdmFsOwogICAgICAgIGVsc2UKICAgICAgICAgICAgb2JqID0gbmV3IENh\nbGVuZGFyZCh2YWwsIGNhbCk7CiAgICAgICAgd2hlcmVPYmplY3QoY29sLCBv\nYmosIEphdmFTUUxUeXBlcy5USU1FKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB3aGVyZVRpbWVzdGFtcChDb2x1bW4gY29sLCBUaW1lc3RhbXAgdmFsLCBD\nYWxlbmRhciBjYWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgT2JqZWN0IG9iajsKICAgICAgICBpZiAodmFsID09IG51bGwgfHwg\nY2FsID09IG51bGwpCiAgICAgICAgICAgIG9iaiA9IHZhbDsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIG9iaiA9IG5ldyBDYWxlbmRhcmQodmFsLCBjYWwp\nOwogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgb2JqLCBKYXZhU1FMVHlwZXMu\nVElNRVNUQU1QKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZU9iamVj\ndChDb2x1bW4gY29sLCBPYmplY3QgdmFsKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBSYXcpCiAg\nICAgICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgdmFsLCBSQVcpOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgd2hlcmVPYmplY3QoY29sLCB2YWwsIGNvbC5n\nZXRKYXZhVHlwZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbCBzZXQg\nY29sdW1uIG1ldGhvZHMgZGVsZWdhdGUgdG8gdGhpcyBvbmUuIFNldCB0aGUg\nZ2l2ZW4gb2JqZWN0CiAgICAgKiB1bmxlc3MgdGhpcyBpcyBhbiBpbnNlcnQg\nYW5kIHRoZSBnaXZlbiBjb2x1bW4gaXMgYXV0by1hc3NpZ25lZC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgc2V0T2JqZWN0KENvbHVtbiBjb2wsIE9i\namVjdCB2YWwsIGludCBtZXRhVHlwZSwKICAgICAgICBib29sZWFuIG92ZXJy\naWRlRGVmYXVsdCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAvLyBuZXZlciBzZXQgYXV0byBpbmNyZW1lbnQgY29sdW1ucyBhbmQg\naG9ub3IgY29sdW1uIGRlZmF1bHRzCiAgICAgICAgaWYgKF9hY3Rpb24gPT0g\nQUNUSU9OX0lOU0VSVCkgewogICAgICAgICAgICBpZiAoY29sLmlzQXV0b0Fz\nc2lnbmVkKCkpIHsKICAgICAgICAgICAgCS8vIE9QRU5KUEEtMzQ5OiB2YWxp\nZGF0ZSBiZWNhdXNlIHRoaXMgY2FuIGJlIHRoZSBvbmx5IGNvbHVtbgogICAg\nICAgICAgICAJc2V0VmFsaWQodHJ1ZSk7CiAgICAgICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFvdmVycmlkZURl\nZmF1bHQgJiYgdmFsID09IG51bGwgCiAgICAgICAgICAgICAgICAmJiBjb2wu\nZ2V0RGVmYXVsdFN0cmluZygpICE9IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICh2YWwgPT0gbnVsbCAmJiBj\nb2wuaXNOb3ROdWxsKCkpCiAgICAgICAgICAgIHZhbCA9IEphdmFTUUxUeXBl\ncy5nZXRFbXB0eVZhbHVlKGNvbC5nZXRKYXZhVHlwZSgpKTsKICAgICAgICBm\nbHVzaChjb2wsIHZhbCwgbWV0YVR5cGUsIHRydWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogQWxsIHdoZXJlIGNvbHVtbiBtZXRob2RzIGRlbGVnYXRlIHRv\nIHRoaXMgb25lLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCB3aGVyZU9i\namVjdChDb2x1bW4gY29sLCBPYmplY3QgdmFsLCBpbnQgbWV0YVR5cGUpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgZmx1c2goY29s\nLCB2YWwsIG1ldGFUeXBlLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBGbHVzaCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBzZXQgb3Igd2hlcmUgY29u\nZGl0aW9uLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZmx1c2goQ29sdW1u\nIGNvbCwgT2JqZWN0IHZhbCwgaW50IG1ldGFUeXBlLCBib29sZWFuIHNldCkg\newogICAgICAgIGludCBpZHggPSAoc2V0KSA/IGdldFNldEluZGV4KGNvbCkg\nOiBnZXRXaGVyZUluZGV4KGNvbCk7CiAgICAgICAgX3R5cGVzW2lkeF0gPSBt\nZXRhVHlwZTsKICAgICAgICBpZiAodmFsID09IG51bGwpCiAgICAgICAgICAg\nIF92YWxzW2lkeF0gPSBOVUxMOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nX3ZhbHNbaWR4XSA9IHZhbDsKICAgICAgICBpZiAoc2V0IHx8IF9hY3Rpb24g\nPT0gQUNUSU9OX0RFTEVURSkKICAgICAgICAgICAgc2V0VmFsaWQodHJ1ZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIFNRTCBmb3IgdGhl\nIG9wZXJhdGlvbiBvbiB0aGlzIHJvdy4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBnZXRTUUwoREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICBpZiAo\nIWlzVmFsaWQoKSkKICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIGlm\nIChfc3FsID09IG51bGwpCiAgICAgICAgICAgIF9zcWwgPSBnZW5lcmF0ZVNR\nTChkaWN0KTsKICAgICAgICByZXR1cm4gX3NxbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIEdlbmVyYXRlIHRoZSBTUUwgZm9yIHRoaXMgcm93OyB0aGUgcmVz\ndWx0IG9mIHRoaXMgbWV0aG9kIGlzIGNhY2hlZC4KICAgICAqLwogICAgcHJv\ndGVjdGVkIFN0cmluZyBnZW5lcmF0ZVNRTChEQkRpY3Rpb25hcnkgZGljdCkg\newogICAgICAgIHN3aXRjaCAoZ2V0QWN0aW9uKCkpIHsKICAgICAgICAgICAg\nY2FzZSBBQ1RJT05fVVBEQVRFOgogICAgICAgICAgICAgICAgcmV0dXJuIGdl\ndFVwZGF0ZVNRTChkaWN0KTsKICAgICAgICAgICAgY2FzZSBBQ1RJT05fSU5T\nRVJUOgogICAgICAgICAgICAgICAgcmV0dXJuIGdldEluc2VydFNRTChkaWN0\nKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVy\nbiBnZXREZWxldGVTUUwoZGljdCk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBTUUwgZm9yIGEgcHJlcGFyZWQgc3RhdGVt\nZW50IHVwZGF0ZSBvbiB0aGlzIHJvdy4KICAgICAqLwogICAgcHJpdmF0ZSBT\ndHJpbmcgZ2V0VXBkYXRlU1FMKERCRGljdGlvbmFyeSBkaWN0KSB7CiAgICAg\nICAgU3RyaW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwog\nICAgICAgIGJ1Zi5hcHBlbmQoIlVQREFURSAiKS5hcHBlbmQoZGljdC5nZXRG\ndWxsTmFtZShnZXRUYWJsZSgpLCBmYWxzZSkpLgogICAgICAgICAgICBhcHBl\nbmQoIiBTRVQgIik7CgogICAgICAgIGJvb2xlYW4gaGFzVmFsID0gZmFsc2U7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBpZiAoX3ZhbHNbaV0gPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgaWYgKGhhc1ZhbCkK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoZGljdC5nZXRDb2x1bW5EQk5hbWUoX2NvbHNbaV0pKTsK\nICAgICAgICAgICAgaWYgKF90eXBlc1tpXSA9PSBSQVcpCiAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKCIgPSAiKS5hcHBlbmQoX3ZhbHNbaV0pOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgPSA/\nIik7CiAgICAgICAgICAgIGhhc1ZhbCA9IHRydWU7CiAgICAgICAgfQoKICAg\nICAgICBhcHBlbmRXaGVyZShidWYsIGRpY3QpOwogICAgICAgIHJldHVybiBi\ndWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgU1FMIGZvciBhIHByZXBhcmVkIHN0YXRlbWVudCBpbnNlcnQgb24gdGhp\ncyByb3cuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldEluc2VydFNR\nTChEQkRpY3Rpb25hcnkgZGljdCkgewogICAgICAgIFN0cmluZ0J1aWxkZXIg\nYnVmID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBTdHJpbmdCdWls\nZGVyIHZhbHMgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAgIGJ1Zi5h\ncHBlbmQoIklOU0VSVCBJTlRPICIpLgogICAgICAgICAgICBhcHBlbmQoZGlj\ndC5nZXRGdWxsTmFtZShnZXRUYWJsZSgpLCBmYWxzZSkpLmFwcGVuZCgiICgi\nKTsKCiAgICAgICAgYm9vbGVhbiBoYXNWYWwgPSBmYWxzZTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IF9jb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGlmIChfdmFsc1tpXSA9PSBudWxsKQogICAgICAgICAgICAgICAg\nY29udGludWU7CgogICAgICAgICAgICBpZiAoaGFzVmFsKSB7CiAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgICAgICAgICAgdmFs\ncy5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnVm\nLmFwcGVuZChkaWN0LmdldENvbHVtbkRCTmFtZShfY29sc1tpXSkpOwogICAg\nICAgICAgICBpZiAoX3R5cGVzW2ldID09IFJBVykKICAgICAgICAgICAgICAg\nIHZhbHMuYXBwZW5kKF92YWxzW2ldKTsKICAgICAgICAgICAgZWxzZQogICAg\nICAgICAgICAgICAgdmFscy5hcHBlbmQoIj8iKTsKICAgICAgICAgICAgaGFz\nVmFsID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGJ1Zi5hcHBlbmQoIikg\nVkFMVUVTICgiKS5hcHBlbmQodmFscy50b1N0cmluZygpKS5hcHBlbmQoIiki\nKTsKICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIFNRTCBmb3IgYSBwcmVwYXJlZCBzdGF0\nZW1lbnQgZGVsZXRlIG9uIHRoaXMgcm93LgogICAgICovCiAgICBwcml2YXRl\nIFN0cmluZyBnZXREZWxldGVTUUwoREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAg\nICAgICBTdHJpbmdCdWlsZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7\nCiAgICAgICAgYnVmLmFwcGVuZCgiREVMRVRFIEZST00gIikuCiAgICAgICAg\nICAgIGFwcGVuZChkaWN0LmdldEZ1bGxOYW1lKGdldFRhYmxlKCksIGZhbHNl\nKSk7CiAgICAgICAgYXBwZW5kV2hlcmUoYnVmLCBkaWN0KTsKICAgICAgICBy\nZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\ncHBlbmRzIHRoZSB3aGVyZSBjbGF1c2Ugb250byB0aGUgZ2l2ZW4gc3FsIGJ1\nZmZlci4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFwcGVuZFdoZXJlKFN0\ncmluZ0J1aWxkZXIgYnVmLCBEQkRpY3Rpb25hcnkgZGljdCkgewogICAgICAg\nIGJvb2xlYW4gaGFzV2hlcmUgPSBmYWxzZTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IF9jb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlm\nIChfdmFsc1tnZXRXaGVyZUluZGV4KF9jb2xzW2ldKV0gPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgaWYgKCFoYXNX\naGVyZSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBXSEVSRSAiKTsK\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nIEFORCAiKTsKCiAgICAgICAgICAgIC8vIEdldCBwbGF0Zm9ybSBzcGVjaWZp\nYyB2ZXJzaW9uIGNvbHVtbiBuYW1lCiAgICAgICAgICAgIGlmIChfY29sc1tp\nXS5nZXRWZXJzaW9uU3RyYXRlZ3koKSAhPSBudWxsKQogICAgICAgICAgICAg\nICBidWYuYXBwZW5kKGRpY3QudG9EQk5hbWUoZGljdC5nZXRWZXJzaW9uQ29s\ndW1uKF9jb2xzW2ldLCBfY29sc1tpXQogICAgICAgICAgICAgICAgICAgLmdl\ndFRhYmxlSWRlbnRpZmllcigpKSkpLmFwcGVuZCgiID0gPyIpOwogICAgICAg\nICAgICAvLyBzcWxzZXJ2ZXIgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtcyB1c2lu\nZyBudWxsIHBhcmFtZXRlcnMgaW4gdGhlCiAgICAgICAgICAgIC8vIHdoZXJl\nIGNsYXVzZQogICAgICAgICAgICBlbHNlIGlmIChfdmFsc1tnZXRXaGVyZUlu\nZGV4KF9jb2xzW2ldKV0gPT0gTlVMTCkKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoZGljdC5nZXRDb2x1bW5EQk5hbWUoX2NvbHNbaV0pKS5hcHBlbmQo\nIiBJUyBOVUxMIik7CiAgICAgICAgICAgIGVsc2UgaWYgKF90eXBlc1tpXSA9\nPSBSQVcpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGRpY3QuZ2V0Q29s\ndW1uREJOYW1lKF9jb2xzW2ldKSkuYXBwZW5kKCIgPSAiKS5hcHBlbmQoX3Zh\nbHNbaV0pOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKGRpY3QuZ2V0Q29sdW1uREJOYW1lKF9jb2xzW2ldKSkuYXBwZW5k\nKCIgPSA/Iik7CiAgICAgICAgICAgIGhhc1doZXJlID0gdHJ1ZTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9mIHBhcmFt\nZXRlcnMgdGhhdCB3aWxsIGJlIHNldCBmb3IgdGhpcyByb3cuCiAgICAgKi8K\nICAgIHB1YmxpYyBpbnQgZ2V0UGFyYW1ldGVyQ291bnQoKSB7CiAgICAgICAg\ncmV0dXJuIF92YWxzLmxlbmd0aDsKICAgIH0KCiAgICAvKioKICAgICAqIEZs\ndXNoIHRoZSByb3cncyB2YWx1ZXMgdG8gdGhlIGdpdmVuIHByZXBhcmVkIHN0\nYXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgZmx1c2goUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIERCRGljdGlvbmFyeSBkaWN0LAogICAgICAg\nIEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBmbHVzaChzdG1udCwgMSwgZGljdCwgc3RvcmUpOwogICAg\nfQoKICAgIC8qKgogICAgICogRmx1c2ggdGhlIHJvdydzIHZhbHVlcyB0byB0\naGUgZ2l2ZW4gcHJlcGFyZWQgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBmbHVzaChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlk\neCwgREJEaWN0aW9uYXJ5IGRpY3QsCiAgICAgICAgSkRCQ1N0b3JlIHN0b3Jl\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewoKICAgICAgICAvLyB0\naGlzIHNpbXBsZSBtZXRob2Qgd29ya3MgYmVjYXVzZSB0aGUgU1FMIGlzIGFs\nd2F5cyBwcmVwYXJlZAogICAgICAgIC8vIGJhc2VkIG9uIHRoZSBpbmRleGlu\nZyBvZiB0aGUgY29sdW1ucyBpbiB0aGUgdGFibGUgb2JqZWN0IC0tIHRoZQog\nICAgICAgIC8vIHNhbWUgb3JkZXJpbmcgd2UgdXNlIHdoZW4gc3RvcmluZyB2\nYWx1ZXMgYW5kIG1ldGEgdHlwZXMuIHNraXAKICAgICAgICAvLyB1cGRhdGVz\nIHdoZW4gc2V0dGluZyBwYXJhbXMgZm9yIERFTEVURXM7IHRoZSB1cGRhdGVz\nIGFyZSBqdXN0IHRoZXJlCiAgICAgICAgLy8gdG8gbGV0IHVzIGV2YWwgZmsg\nY29uc3RyYWludHMKICAgICAgICBpbnQgaSA9IChnZXRBY3Rpb24oKSA9PSBB\nQ1RJT05fREVMRVRFKSA/IF9jb2xzLmxlbmd0aDogMDsKICAgICAgICBDb2x1\nbW4gY29sOwogICAgICAgIE9iamVjdCB2YWw7CiAgICAgICAgaW50IGhhbGYg\nPSBfdmFscy5sZW5ndGggLyAyOwogICAgICAgIGZvciAoOyBpIDwgX3ZhbHMu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKF92YWxzW2ldID09IG51\nbGwpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIC8v\nIHdlIGRvbid0IHNldCBudWxsIHBhcmFtcyBpbiB0aGUgV0hFUkUgY2xhdXNl\nOyB3ZSB1c2UgdGhlIE5VTEwKICAgICAgICAgICAgLy8ga2V5d29yZCBpbnN0\nZWFkIHRvIHNhdGlzZnkgc3Fsc2VydmVyCiAgICAgICAgICAgIGlmIChfdmFs\nc1tpXSA9PSBOVUxMICYmIGdldEFjdGlvbigpICE9IEFDVElPTl9JTlNFUlQg\nJiYgaSA+PSBoYWxmKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAg\nICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIHVwZGF0ZSB0aGUgdmFscyBhcnJh\neSB3aWxsIGJlIDIgeCB0aGUgY29scwogICAgICAgICAgICAvLyBhcnJheSBs\nZW5ndGg7IGl0IHJlcGVhdHMgZm9yIHdoZXJlIHZhbHVlcwogICAgICAgICAg\nICBpZiAoaSA8IF9jb2xzLmxlbmd0aCkKICAgICAgICAgICAgICAgIGNvbCA9\nIF9jb2xzW2ldOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBj\nb2wgPSBfY29sc1tpIC0gX2NvbHMubGVuZ3RoXTsKCiAgICAgICAgICAgIHZh\nbCA9IF92YWxzW2ldOwogICAgICAgICAgICBpZiAodmFsID09IE5VTEwpCiAg\nICAgICAgICAgICAgICB2YWwgPSBudWxsOwoKICAgICAgICAgICAgaWYgKHZh\nbCA9PSBudWxsIHx8IF90eXBlc1tpXSAhPSBSQVcpIHsKICAgICAgICAgICAg\nICAgIGRpY3Quc2V0VHlwZWQoc3RtbnQsIGlkeCwgdmFsLCBjb2wsIF90eXBl\nc1tpXSwgc3RvcmUpOwogICAgICAgICAgICAgICAgaWR4Kys7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYXJy\nYXkgdmFsdWUgYXJyYXkgaW5kZXggZm9yIHRoZSBnaXZlbiBjb2x1bW4ncyB2\nYWx1ZS4KICAgICAqLwogICAgcHJpdmF0ZSBpbnQgZ2V0U2V0SW5kZXgoQ29s\ndW1uIGNvbCkgewogICAgICAgIHJldHVybiBjb2wuZ2V0SW5kZXgoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBhcnJheSB2YWx1ZSBhcnJheSBpbmRl\neCBmb3IgdGhlIGdpdmVuIGNvbHVtbidzIHZhbHVlLgogICAgICovCiAgICBw\ncml2YXRlIGludCBnZXRXaGVyZUluZGV4KENvbHVtbiBjb2wpIHsKICAgICAg\nICByZXR1cm4gY29sLmdldEluZGV4KCkgKyBfY29scy5sZW5ndGg7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQZXJmb3JtcyBhIHByb3BlciBkZWVwIGNsb25l\nLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGNsb25lKCkgewogICAgICAg\nIFJvd0ltcGwgY2xvbmUgPSBuZXdJbnN0YW5jZShnZXRDb2x1bW5zKCksIGdl\ndEFjdGlvbigpKTsKICAgICAgICBjb3B5SW50byhjbG9uZSwgZmFsc2UpOwog\nICAgICAgIHJldHVybiBjbG9uZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIG5ldyByb3cuCiAgICAgKi8KICAgIHByb3RlY3RlZCBSb3dJbXBs\nIG5ld0luc3RhbmNlKENvbHVtbltdIGNvbHMsIGludCBhY3Rpb24pIHsKICAg\nICAgICByZXR1cm4gbmV3IFJvd0ltcGwoY29scywgYWN0aW9uKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvcHkgYWxsIHZhbHVlcyBmcm9tIHRoaXMgcm93\nIGludG8gdGhlIGdpdmVuIG9uZS4KICAgICAqCiAgICAgKiBAcGFyYW0gd2hl\ncmVPbmx5IGlmIHRydWUsIG9ubHkgY29weSB3aGVyZSBjb25kaXRpb25zCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGNvcHlJbnRvKFJvd0ltcGwgcm93LCBi\nb29sZWFuIHdoZXJlT25seSkgewogICAgICAgIGludCBhY3Rpb24gPSBnZXRB\nY3Rpb24oKTsKICAgICAgICBpbnQgcm93QWN0aW9uID0gcm93LmdldEFjdGlv\nbigpOwoKICAgICAgICBpbnQgc3RhcnQ7CiAgICAgICAgaW50IGxlbjsKICAg\nICAgICBpZiAod2hlcmVPbmx5KSB7CiAgICAgICAgICAgIGlmIChhY3Rpb24g\nPT0gQUNUSU9OX0lOU0VSVCB8fCByb3dBY3Rpb24gPT0gQUNUSU9OX0lOU0VS\nVCkKICAgICAgICAgICAgICAgIHN0YXJ0ID0gbGVuID0gMDsKICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgc3RhcnQgPSBsZW4gPSBfdmFscy5s\nZW5ndGggLyAyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YXJ0\nID0gMDsKICAgICAgICAgICAgaWYgKHJvd0FjdGlvbiA9PSBBQ1RJT05fSU5T\nRVJUICYmIGFjdGlvbiAhPSBBQ1RJT05fSU5TRVJUKQogICAgICAgICAgICAg\nICAgbGVuID0gX3ZhbHMubGVuZ3RoIC8gMjsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgbGVuID0gX3ZhbHMubGVuZ3RoOwogICAgICAgIH0K\nCiAgICAgICAgU3lzdGVtLmFycmF5Y29weShfdmFscywgc3RhcnQsIHJvdy5f\ndmFscywgc3RhcnQsIGxlbik7CiAgICAgICAgU3lzdGVtLmFycmF5Y29weShf\ndHlwZXMsIHN0YXJ0LCByb3cuX3R5cGVzLCBzdGFydCwgbGVuKTsKICAgICAg\nICBpZiAoaXNWYWxpZCgpKQogICAgICAgICAgICByb3cuc2V0VmFsaWQodHJ1\nZSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBPYmplY3RbXSBnZXRWYWxzKCkg\newogICAgICAgIHJldHVybiBfdmFsczsKICAgIH0KICAgIAogICAgcHVibGlj\nIGludFtdIGdldFR5cGVzKCkgewogICAgICAgIHJldHVybiBfdHlwZXM7CiAg\nICB9CiAgICAKICAgIHB1YmxpYyBib29sZWFuIGlzRmx1c2hlZCgpIHsKICAg\nICAgICByZXR1cm4gX2lzRmx1c2hlZDsKICAgIH0KICAgIAogICAgcHVibGlj\nIHZvaWQgc2V0Rmx1c2hlZChib29sZWFuIGlzRmx1c2hlZCkgewogICAgICAg\nIF9pc0ZsdXNoZWQgPSBpc0ZsdXNoZWQ7CiAgICB9Cn0K\n","encoding":"base64"}

