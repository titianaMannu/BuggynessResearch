{"sha":"82e343b6e26f6b5bd516a9cb780be9119e4847f1","node_id":"MDQ6QmxvYjIwNjM2NDo4MmUzNDNiNmUyNmY2YjViZDUxNmE5Y2I3ODBiZTkxMTllNDg0N2Yx","size":9402,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/82e343b6e26f6b5bd516a9cb780be9119e4847f1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEu\ndGV4dC5EYXRlRm9ybWF0OwppbXBvcnQgamF2YS50ZXh0LlNpbXBsZURhdGVG\nb3JtYXQ7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51\ndGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlN0cmluZ1Rva2VuaXpl\ncjsKaW1wb3J0IGphdmEudXRpbC5NYXAuRW50cnk7CmltcG9ydCBqYXZhLnV0\naWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5DbGVhcmFibGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW52YWxpZFN0YXRlRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4\nY2VwdGlvbjsKCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBD\ncm9uLXN0eWxlIGNsZWFyYWJsZSBldmljdGlvbi4gVW5kZXJzdGFuZHMgc2No\nZWR1bGVzIGJhc2VkIG9uIGNyb24gZm9ybWF0OgogKiA8bGk+PGNvZGU+bWlu\ndXRlIGhvdXIgbWRheSBtb250aCB3ZGF5PC9jb2RlPjwvbGk+CiAqIDxsaT48\nY29kZT4rbWludXRlPC9jb2RlPjwvbGk+CiAqIEZvciBleGFtcGxlOgogKiA8\nY29kZT4xNSwzMCA2LDE5IDIsMTAgMSAyIDwvY29kZT4KICogV291bGQgcnVu\nIGF0IDE1IGFuZCAzMCBwYXN0IHRoZSA2QU0gYW5kIDdQTSwgb24gdGhlIDJu\nZCBhbmQgMTB0aAogKiBvZiBKYW51YXJ5IHdoZW4gaXRzIGEgTW9uZGF5Lgog\nKgogKi8KcHVibGljIGNsYXNzIENsZWFyYWJsZVNjaGVkdWxlciBpbXBsZW1l\nbnRzIFJ1bm5hYmxlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2Nh\nbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKENsZWFyYWJsZVNj\naGVkdWxlci5jbGFzcyk7CgogICAgcHJpdmF0ZSBNYXA8Q2xlYXJhYmxlLFNj\naGVkdWxlPiBfY2xlYXJhYmxlcyA9IG5ldyBDb25jdXJyZW50SGFzaE1hcDxD\nbGVhcmFibGUsU2NoZWR1bGU+KCk7CiAgICBwcml2YXRlIGJvb2xlYW4gX3N0\nb3AgPSBmYWxzZTsKICAgIHByaXZhdGUgaW50IF9pbnRlcnZhbCA9IDE7CiAg\nICBwcml2YXRlIExvZyBfbG9nOwogICAgcHJpdmF0ZSBUaHJlYWQgX3RocmVh\nZDsKCiAgICBwdWJsaWMgQ2xlYXJhYmxlU2NoZWR1bGVyKE9wZW5KUEFDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfbG9nID0gY29uZi5nZXRMb2dG\nYWN0b3J5KCkuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19EQVRB\nQ0FDSEUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGludGVydmFsIHRp\nbWUgaW4gbWludXRlcyBiZXR3ZWVuIHNjaGVkdWxlciBjaGVja3MuIERlZmF1\nbHRzIHRvIDEuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW50ZXJ2YWwo\nKSB7CiAgICAgICAgcmV0dXJuIF9pbnRlcnZhbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBpbnRlcnZhbCB0aW1lIGluIG1pbnV0ZXMgYmV0d2VlbiBz\nY2hlZHVsZXIgY2hlY2tzLiBEZWZhdWx0cyB0byAxLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRJbnRlcnZhbChpbnQgaW50ZXJ2YWwpIHsKICAgICAg\nICBfaW50ZXJ2YWwgPSBpbnRlcnZhbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFN0b3AgdGhlIGFzc29jaWF0ZWQgdGhyZWFkIGlmIHRoZXJlIGFuZCBzdG9w\nIHRoZSBjdXJyZW50IHJ1bm5hYmxlLgogICAgICovCiAgICBwdWJsaWMgc3lu\nY2hyb25pemVkIHZvaWQgc3RvcCgpIHsKICAgICAgICBfc3RvcCA9IHRydWU7\nCiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGlzU3RvcHBlZCgpIHsKICAg\nICAgICByZXR1cm4gX3N0b3A7CiAgICB9CgogICAgLyoqCiAgICAgKiBTY2hl\nZHVsZSB0aGUgZ2l2ZW4gQ2xlYXJhYmxlIGZvciBjbGVhciB0byBiZSBjYWxs\nZWQuIFN0YXJ0cyB0aGUgc2NoZWR1bGluZyB0aHJlYWQKICAgICAqIGlmIG5v\ndCBzdGFydGVkLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZv\naWQgc2NoZWR1bGVFdmljdGlvbihDbGVhcmFibGUgY2xlYXJhYmxlLCBTdHJp\nbmcgdGltZXMpIHsKICAgICAgICBpZiAodGltZXMgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICBTY2hlZHVsZSBzY2hlZHVsZSA9IG5l\ndyBTY2hlZHVsZSh0aW1lcyk7CiAgICAgICAgX2NsZWFyYWJsZXMucHV0KGNs\nZWFyYWJsZSwgc2NoZWR1bGUpOwogICAgICAgIF9zdG9wID0gZmFsc2U7CiAg\nICAgICAgaWYgKF90aHJlYWQgPT0gbnVsbCkgewogICAgICAgICAgICBfdGhy\nZWFkID0KICAgICAgICAgICAgICAgIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2\naWxlZ2VkKEoyRG9Qcml2SGVscGVyCiAgICAgICAgICAgICAgICAgICAgLm5l\nd0RhZW1vblRocmVhZEFjdGlvbih0aGlzLCBfbG9jLmdldCgic2NoZWR1bGVy\nLW5hbWUiKQogICAgICAgICAgICAgICAgICAgICAgICAuZ2V0TWVzc2FnZSgp\nKSk7CiAgICAgICAgICAgIF90aHJlYWQuc3RhcnQoKTsKICAgICAgICAgICAg\naWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIF9s\nb2cudHJhY2UoX2xvYy5nZXQoInNjaGVkdWxlci1zdGFydCIsIF90aHJlYWQu\nZ2V0TmFtZSgpKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmVtb3ZlIHRoZSBnaXZlbiBDbGVhcmFibGUgZnJvbSBzY2hlZHVsaW5nLgog\nICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgcmVtb3ZlRnJv\nbVNjaGVkdWxlKENsZWFyYWJsZSBjbGVhcmFibGUpIHsKICAgICAgICBfY2xl\nYXJhYmxlcy5yZW1vdmUoY2xlYXJhYmxlKTsKICAgICAgICBpZiAoX2NsZWFy\nYWJsZXMuc2l6ZSgpID09IDApCiAgICAgICAgICAgIHN0b3AoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgaWYgKF9sb2cuaXNU\ncmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdl\ndCgic2NoZWR1bGVyLWludGVydmFsIiwgX2ludGVydmFsICsgIiIpKTsKCiAg\nICAgICAgRGF0ZSBsYXN0UnVuID0gbmV3IERhdGUoKTsKICAgICAgICBEYXRl\nRm9ybWF0IGZvbSA9IG5ldyBTaW1wbGVEYXRlRm9ybWF0KCJFIEhIOm1tOnNz\nIik7CiAgICAgICAgd2hpbGUgKCFpc1N0b3BwZWQoKSkgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKF9pbnRlcnZh\nbCAqIDYwICogMTAwMCk7CgogICAgICAgICAgICAgICAgRGF0ZSBub3cgPSBu\nZXcgRGF0ZSgpOwogICAgICAgICAgICAgICAgZm9yKEVudHJ5PENsZWFyYWJs\nZSwgU2NoZWR1bGU+IGVudHJ5IDogX2NsZWFyYWJsZXMuZW50cnlTZXQoKSl7\nCiAgICAgICAgICAgICAgICAgICAgQ2xlYXJhYmxlIGNsZWFyYWJsZSA9IGVu\ndHJ5LmdldEtleSgpOwogICAgICAgICAgICAgICAgICAgIFNjaGVkdWxlIHNj\naGVkdWxlID0gZW50cnkuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgICAgICAg\nICBpZiAoc2NoZWR1bGUubWF0Y2hlcyhsYXN0UnVuLCBub3cpKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nLnRyYWNlKF9sb2Mu\nZ2V0KCJzY2hlZHVsZXItY2xlYXIiLCBjbGVhcmFibGUsIGZvbS5mb3JtYXQo\nbm93KSkpOwogICAgICAgICAgICAgICAgICAgICAgICBldmljdChjbGVhcmFi\nbGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIGxhc3RSdW4gPSBub3c7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJzY2hlZHVsZXIt\nZmFpbCIpLCBlKS4KICAgICAgICAgICAgICAgICAgICBzZXRGYXRhbCh0cnVl\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgX2xvZy5pbmZv\nKF9sb2MuZ2V0KCJzY2hlZHVsZXItc3RvcCIpKTsKICAgICAgICBzeW5jaHJv\nbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAgaWYgKGlzU3RvcHBlZCgpKQog\nICAgICAgICAgICAgICAgX3RocmVhZCA9IG51bGw7IC8vIGJlIHN1cmUgdG8g\nZGVyZWYgdGhlIHRocmVhZCBzbyBpdCBjYW4gcmVzdGFydAogICAgICAgIH0K\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBldmljdChDbGVhcmFibGUgY2Fj\naGUpIHsKICAgICAgICBjYWNoZS5jbGVhcigpOwogICAgfQoKICAgIC8qKgog\nICAgICogU2ltcGxlIGNsYXNzIHdoaWNoIHJlcHJlc2VudHMgdGhlIGdpdmVu\nIHRpbWUgc2NoZWR1bGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNs\nYXNzIFNjaGVkdWxlIHsKCiAgICAgICAgc3RhdGljIGZpbmFsIGludFtdIFdJ\nTERDQVJEID0gbmV3IGludFswXTsKICAgICAgICBzdGF0aWMgZmluYWwgaW50\nW10gVU5JVFMgPSB7CiAgICAgICAgICAgIENhbGVuZGFyLk1PTlRILAogICAg\nICAgICAgICBDYWxlbmRhci5EQVlfT0ZfTU9OVEgsCiAgICAgICAgICAgIENh\nbGVuZGFyLkRBWV9PRl9XRUVLLAogICAgICAgICAgICBDYWxlbmRhci5IT1VS\nX09GX0RBWSwKICAgICAgICAgICAgQ2FsZW5kYXIuTUlOVVRFCiAgICAgICAg\nfTsKICAgICAgICBmaW5hbCBpbnRbXSBtb250aDsKICAgICAgICBmaW5hbCBp\nbnRbXSBkYXlPZk1vbnRoOwogICAgICAgIGZpbmFsIGludFtdIGRheU9mV2Vl\nazsKICAgICAgICBmaW5hbCBpbnRbXSBob3VyOwogICAgICAgIGZpbmFsIGlu\ndFtdIG1pbjsKCiAgICAgICAgcHVibGljIFNjaGVkdWxlKFN0cmluZyBkYXRl\nKSB7CiAgICAgICAgICAgIGludFtdIHRtaW4gPSBudWxsOwogICAgICAgICAg\nICBpZiAoZGF0ZS5zdGFydHNXaXRoKCIrIikpIHsKICAgICAgICAgICAgICAg\nIENhbGVuZGFyIGNhbCA9IENhbGVuZGFyLmdldEluc3RhbmNlKCk7CiAgICAg\nICAgICAgICAgICBpbnQgaW50ZXJ2YWwgPSBJbnRlZ2VyLnBhcnNlSW50KGRh\ndGUuc3Vic3RyaW5nKDEpKTsKICAgICAgICAgICAgICAgIGludCBjdXJyTWlu\nID0gY2FsLmdldChDYWxlbmRhci5NSU5VVEUpOwogICAgICAgICAgICAgICAg\nCiAgICAgICAgICAgICAgICB0bWluID0gbmV3IGludFs2MC9pbnRlcnZhbF07\nCiAgICAgICAgICAgICAgICBmb3IoaW50IGkgPSAwOyBpPHRtaW4ubGVuZ3Ro\nO2krKyl7CiAgICAgICAgICAgICAgICAgICAgaW50IHRlbXA7CiAgICAgICAg\nICAgICAgICAgICAgaWYoaT09MCl7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHRlbXA9Y3Vyck1pbitpbnRlcnZhbDsKICAgICAgICAgICAgICAgICAgICB9\nZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcD10bWluW2ktMV0r\naW50ZXJ2YWw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIGlmKHRlbXAgPj0gNjAgKXsKICAgICAgICAgICAgICAgICAgICAg\nICAgdGVtcCAtPSA2MDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICAgICAgdG1pbltpXT10ZW1wOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgQXJyYXlzLnNvcnQodG1pbik7CgogICAgICAgICAg\nICAgICAgbWluID0gdG1pbjsKICAgICAgICAgICAgICAgIGhvdXIgPSBXSUxE\nQ0FSRDsKICAgICAgICAgICAgICAgIGRheU9mTW9udGggPSBXSUxEQ0FSRDsK\nICAgICAgICAgICAgICAgIG1vbnRoID0gV0lMRENBUkQ7CiAgICAgICAgICAg\nICAgICBkYXlPZldlZWsgPSBXSUxEQ0FSRDsKICAgICAgICAgICAgfWVsc2V7\nCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgU3RyaW5nVG9rZW5pemVy\nIHRva2VuID0gbmV3IFN0cmluZ1Rva2VuaXplcihkYXRlLCAiIFx0Iik7CiAg\nICAgICAgICAgICAgICBpZiAodG9rZW4uY291bnRUb2tlbnMoKSAhPSA1KQog\nICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJiYWQtY291bnQiLCBkYXRlKSkuc2V0RmF0YWwodHJ1ZSk7CiAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIG1pbiA9\nIHBhcnNlKHRva2VuLm5leHRUb2tlbigpLCAwLCA2MCk7CiAgICAgICAgICAg\nICAgICAgICAgaG91ciA9IHBhcnNlKHRva2VuLm5leHRUb2tlbigpLCAwLCAy\nNCk7CiAgICAgICAgICAgICAgICAgICAgZGF5T2ZNb250aCA9IHBhcnNlKHRv\na2VuLm5leHRUb2tlbigpLCAxLCAzMSk7CiAgICAgICAgICAgICAgICAgICAg\nbW9udGggPSBwYXJzZSh0b2tlbi5uZXh0VG9rZW4oKSwgMSwgMTMpOwogICAg\nICAgICAgICAgICAgICAgIGRheU9mV2VlayA9IHBhcnNlKHRva2VuLm5leHRU\nb2tlbigpLCAxLCA4KTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93\nYWJsZSB0KSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJF\neGNlcHRpb24oX2xvYy5nZXQoImJhZC1zY2hlZHVsZSIsIGRhdGUpLCB0KS5z\nZXRGYXRhbCh0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBpbnRbXSBwYXJzZShTdHJp\nbmcgdG9rZW4sIGludCBtaW4sIGludCBtYXgpIHsKICAgICAgICAgICAgaWYg\nKCIqIi5lcXVhbHModG9rZW4udHJpbSgpKSkKICAgICAgICAgICAgICAgIHJl\ndHVybiBXSUxEQ0FSRDsKICAgICAgICAgICAgU3RyaW5nW10gdG9rZW5zID0g\nU3RyaW5ncy5zcGxpdCh0b2tlbiwgIiwiLCAwKTsKICAgICAgICAgICAgaW50\nIFtdIHRpbWVzID0gbmV3IGludFt0b2tlbnMubGVuZ3RoXTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgdGlt\nZXNbaV0gPSBJbnRlZ2VyLnBhcnNlSW50KHRva2Vuc1tpXSk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3Qt\nbnVtYmVyIiwgdG9rZW4pKS4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0\nRmF0YWwodHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBpZiAodGltZXNbaV0gPCBtaW4gfHwgdGltZXNbaV0gPj0gbWF4KQogICAg\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJub3QtcmFuZ2UiLCB0b2tlbiwKICAgICAgICAgICAgICAgICAgICAg\nICAgU3RyaW5nLnZhbHVlT2YobWluKSwgU3RyaW5nLnZhbHVlT2YobWF4KSkp\nLgogICAgICAgICAgICAgICAgICAgICAgICBzZXRGYXRhbCh0cnVlKTsKICAg\nICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdGltZXM7CiAgICAgICAg\nfQoKICAgICAgICBib29sZWFuIG1hdGNoZXMoRGF0ZSBsYXN0LCBEYXRlIG5v\ndykgewogICAgICAgICAgICBDYWxlbmRhciB0aW1lID0gQ2FsZW5kYXIuZ2V0\nSW5zdGFuY2UoKTsKICAgICAgICAgICAgdGltZS5zZXRUaW1lKG5vdyk7CiAg\nICAgICAgICAgIHRpbWUuc2V0KENhbGVuZGFyLlNFQ09ORCwgMCk7CiAgICAg\nICAgICAgIHRpbWUuc2V0KENhbGVuZGFyLk1JTExJU0VDT05ELCAwKTsKCiAg\nICAgICAgICAgIGludFtdW10gYWxsID0KICAgICAgICAgICAgICAgIG5ldyBp\nbnRbXVtdeyBtb250aCwgZGF5T2ZNb250aCwgZGF5T2ZXZWVrLCBob3VyLCBt\naW4gfTsKICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMobGFzdCwgbm93LCB0\naW1lLCBhbGwsIDApOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBib29s\nZWFuIG1hdGNoZXMoRGF0ZSBsYXN0LCBEYXRlIG5vdywgQ2FsZW5kYXIgdGlt\nZSwKICAgICAgICAgICAgaW50W11bXSB0aW1lcywgaW50IGRlcHRoKSB7CiAg\nICAgICAgICAgIGlmIChkZXB0aCA9PSBVTklUUy5sZW5ndGgpIHsKICAgICAg\nICAgICAgICAgIERhdGUgY29tcGFyZSA9IHRpbWUuZ2V0VGltZSgpOwogICAg\nICAgICAgICAgICAgcmV0dXJuIGNvbXBhcmUuY29tcGFyZVRvKGxhc3QpID49\nIDAgJiYKICAgICAgICAgICAgICAgICAgICBjb21wYXJlLmNvbXBhcmVUbyhu\nb3cpIDwgMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRpbWVz\nW2RlcHRoXSAhPSBXSUxEQ0FSRCkgewogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCB0aW1lc1tkZXB0aF0ubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgICAgICB0aW1lLnNldChVTklUU1tkZXB0aF0sIHRpbWVz\nW2RlcHRoXVtpXSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMo\nbGFzdCwgbm93LCB0aW1lLCB0aW1lcywgZGVwdGggKyAxKSkKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMobGFz\ndCwgbm93LCB0aW1lLCB0aW1lcywgZGVwdGggKyAxKTsKCQl9Cgl9Cn0K\n","encoding":"base64"}

