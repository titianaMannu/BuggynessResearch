{"sha":"99a2100d663fafed8f5f20ee1432f6f550420992","node_id":"MDQ6QmxvYjIwNjM2NDo5OWEyMTAwZDY2M2ZhZmVkOGY1ZjIwZWUxNDMyZjZmNTUwNDIwOTky","size":7301,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/99a2100d663fafed8f5f20ee1432f6f550420992","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZW5oYW5jZS5QQ0RhdGFHZW5lcmF0b3I7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuT2JqZWN0VmFsdWU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ2xvc2VhYmxl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7\nCgovKioKICogRGVmYXVsdCBkYXRhIGNhY2hlIG1hbmFnZXIgcHJvdmlkZXMg\naGFuZGxlIHRvIHV0aWxpdGllcyB7QGxpbmtwbGFpbiBQQ0RhdGFHZW5lcmF0\nb3J9LCB7QGxpbmtwbGFpbiBDbGVhcmFibGVTY2hlZHVsZXJ9CiAqIGFuZCB7\nQGxpbmtwbGFpbiBDYWNoZURpc3RyaWJ1dGlvblBvbGljeX0gZm9yIHRoZSBj\nYWNoZSBvcGVyYXRpb24uIFRoaXMgaW1wbGVtZW50YXRpb24gYWxzbyBkZXRl\ncm1pbmVzIHdoZXRoZXIgYQogKiBtYW5hZ2VkIHR5cGUgaXMgZWxpZ2libGUg\ndG8gY2FjaGUuCiAqIAogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAYXV0aG9y\nIFBhdHJpY2sgTGluc2tleQogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICov\nCnB1YmxpYyBjbGFzcyBEYXRhQ2FjaGVNYW5hZ2VySW1wbAogICAgaW1wbGVt\nZW50cyBDbG9zZWFibGUsIERhdGFDYWNoZU1hbmFnZXIgewoKICAgIHByaXZh\ndGUgT3BlbkpQQUNvbmZpZ3VyYXRpb24gX2NvbmY7CiAgICBwcml2YXRlIERh\ndGFDYWNoZSBfY2FjaGUgPSBudWxsOwogICAgcHJpdmF0ZSBRdWVyeUNhY2hl\nIF9xdWVyeUNhY2hlID0gbnVsbDsKICAgIHByaXZhdGUgRGF0YUNhY2hlUENE\nYXRhR2VuZXJhdG9yIF9wY0dlbmVyYXRvciA9IG51bGw7CiAgICBwcml2YXRl\nIENsZWFyYWJsZVNjaGVkdWxlciBfc2NoZWR1bGVyID0gbnVsbDsKICAgIHBy\naXZhdGUgQ2FjaGVEaXN0cmlidXRpb25Qb2xpY3kgX3BvbGljeSA9IG5ldyBE\nZWZhdWx0Q2FjaGVEaXN0cmlidXRpb25Qb2xpY3koKTsKICAgIHByaXZhdGUg\nTWFwPENsYXNzTWV0YURhdGEsQm9vbGVhbj4gX2NhY2hlYWJsZSA9IG5ldyBI\nYXNoTWFwPENsYXNzTWV0YURhdGEsIEJvb2xlYW4+KCk7CiAgICAKICAgIC8v\nIFByb3BlcnRpZXMgdGhhdCBhcmUgY29uZmlndXJlZCB2aWEgb3BlbmpwYS5E\nYXRhQ2FjaGUgYnV0IG5lZWQgdG8gYmUgdXNlZCBoZXJlLiBUaGlzIGlzIGhl\ncmUgdG8gc3VwcG9ydCB0aGUgMS4yCiAgICAvLyB3YXkgb2YgZG9pbmcgdGhp\nbmdzIHdpdGggb3BlbmpwYS5EYXRhQ2FjaGUoVHlwZXM9eDt5O3osRXhjbHVk\nZWRUeXBlcz1hKQogICAgcHJpdmF0ZSBTZXQ8U3RyaW5nPiBfaW5jbHVkZWRU\neXBlczsKICAgIHByaXZhdGUgU2V0PFN0cmluZz4gX2V4Y2x1ZGVkVHlwZXM7\nCiAgICAKICAgIHB1YmxpYyB2b2lkIGluaXRpYWxpemUoT3BlbkpQQUNvbmZp\nZ3VyYXRpb24gY29uZiwgT2JqZWN0VmFsdWUgZGF0YUNhY2hlLCBPYmplY3RW\nYWx1ZSBxdWVyeUNhY2hlKSB7CiAgICAgICAgX2NvbmYgPSBjb25mOwogICAg\nICAgIF9jYWNoZSA9IChEYXRhQ2FjaGUpIGRhdGFDYWNoZS5pbnN0YW50aWF0\nZShEYXRhQ2FjaGUuY2xhc3MsIGNvbmYpOwogICAgICAgIGlmIChfY2FjaGUg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAKICAgICAg\nICAvLyBjcmVhdGUgaGVscGVycyBiZWZvcmUgaW5pdGlhbGl6aW5nIGNhY2hl\ncwogICAgICAgIGlmIChjb25mLmdldER5bmFtaWNEYXRhU3RydWN0cygpKQog\nICAgICAgICAgICBfcGNHZW5lcmF0b3IgPSBuZXcgRGF0YUNhY2hlUENEYXRh\nR2VuZXJhdG9yKGNvbmYpOwogICAgICAgIF9zY2hlZHVsZXIgPSBuZXcgQ2xl\nYXJhYmxlU2NoZWR1bGVyKGNvbmYpOwogICAgICAgIAogICAgICAgIF9wb2xp\nY3kgPSBjb25mLmdldENhY2hlRGlzdHJpYnV0aW9uUG9saWN5SW5zdGFuY2Uo\nKTsKCiAgICAgICAgX2NhY2hlLmluaXRpYWxpemUodGhpcyk7CiAgICAgICAg\nX3F1ZXJ5Q2FjaGUgPSAoUXVlcnlDYWNoZSkgcXVlcnlDYWNoZS5pbnN0YW50\naWF0ZShRdWVyeUNhY2hlLmNsYXNzLCBjb25mKTsKICAgICAgICBpZiAoX3F1\nZXJ5Q2FjaGUgIT0gbnVsbCkKICAgICAgICAgICAgX3F1ZXJ5Q2FjaGUuaW5p\ndGlhbGl6ZSh0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgRGF0YUNhY2hlIGdl\ndFN5c3RlbURhdGFDYWNoZSgpIHsKICAgICAgICByZXR1cm4gZ2V0RGF0YUNh\nY2hlKG51bGwsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgRGF0YUNhY2hl\nIGdldERhdGFDYWNoZShTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiBn\nZXREYXRhQ2FjaGUobmFtZSwgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyB0aGUgbmFtZWQgY2FjaGUuIAogICAgICogSWYgdGhlIGdp\ndmVuIG5hbWUgaXMgbmFtZSBvciB0aGUgbmFtZSBvZiB0aGUgY2FjaGUgcGx1\nZ2luIHRoZW4gcmV0dXJucyB0aGUgbWFpbiBjYWNoZS4KICAgICAqIE90aGVy\nd2lzZSwge0BsaW5rcGxhaW4gRGF0YUNhY2hlI2dldFBhcnRpdGlvbihTdHJp\nbmcsIGJvb2xlYW4pIGRlbGVnYXRlc30gdG8gdGhlIG1haW4gY2FjaGUKICAg\nICAqIHRvIG9idGFpbiBhIHBhcnRpdGlvbi4gICAKICAgICAqLwogICAgcHVi\nbGljIERhdGFDYWNoZSBnZXREYXRhQ2FjaGUoU3RyaW5nIG5hbWUsIGJvb2xl\nYW4gY3JlYXRlKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8fCAoX2Nh\nY2hlICE9IG51bGwgJiYgbmFtZS5lcXVhbHMoX2NhY2hlLmdldE5hbWUoKSkp\nKQogICAgICAgICAgICByZXR1cm4gX2NhY2hlOwogICAgICAgIGlmIChfY2Fj\naGUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9jYWNoZS5nZXRQYXJ0\naXRpb24obmFtZSwgY3JlYXRlKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAg\nIH0KCiAgICBwdWJsaWMgUXVlcnlDYWNoZSBnZXRTeXN0ZW1RdWVyeUNhY2hl\nKCkgewogICAgICAgIHJldHVybiBfcXVlcnlDYWNoZTsKICAgIH0KCiAgICBw\ndWJsaWMgRGF0YUNhY2hlUENEYXRhR2VuZXJhdG9yIGdldFBDRGF0YUdlbmVy\nYXRvcigpIHsKICAgICAgICByZXR1cm4gX3BjR2VuZXJhdG9yOwogICAgfQoK\nICAgIHB1YmxpYyBDbGVhcmFibGVTY2hlZHVsZXIgZ2V0Q2xlYXJhYmxlU2No\nZWR1bGVyKCkgewogICAgICAgIHJldHVybiBfc2NoZWR1bGVyOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgIEltcGxIZWxwZXIu\nY2xvc2UoX2NhY2hlKTsKICAgICAgICBJbXBsSGVscGVyLmNsb3NlKF9xdWVy\neUNhY2hlKTsKICAgICAgICBpZiAoX3NjaGVkdWxlciAhPSBudWxsKQogICAg\nICAgICAgICBfc2NoZWR1bGVyLnN0b3AoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNlbGVjdCBjYWNoZSBmb3IgdGhlIGdpdmVuIG1hbmFnZWQgaW5zdGFu\nY2UuCiAgICAgKiBJZiB0eXBlIGJhc2VkIHZlcmlmaWNhdGlvbiBhZmZpcm1z\nIHRoZSB0eXBlIHRvIGJlIGNhY2hlZCB0aGVuIHRoZSBpbnN0YW5jZSBiYXNl\nZCBwb2xpY3kgCiAgICAgKiBpcyBjYWxsZWQgdG8gZGV0ZXJtaW5lIHRoZSB0\nYXJnZXQgY2FjaGUuICAKICAgICAqLwogICAgcHVibGljIERhdGFDYWNoZSBz\nZWxlY3RDYWNoZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7CiAgICAgICAg\naWYgKHNtID09IG51bGwgfHwgIWlzQ2FjaGFibGUoc20uZ2V0TWV0YURhdGEo\nKSkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIFN0cmluZyBu\nYW1lID0gX3BvbGljeS5zZWxlY3RDYWNoZShzbSwgbnVsbCk7CiAgICAgICAg\ncmV0dXJuIG5hbWUgPT0gbnVsbCA/IG51bGwgOiBnZXREYXRhQ2FjaGUobmFt\nZSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogR2V0cyB0aGUgaW5zdGFu\nY2UtYmFzZWQgY2FjaGUgZGlzdHJpYnV0aW9uIHBvbGljeSwgaWYgY29uZmln\ndXJlZC4gCiAgICAgKi8KICAgIHB1YmxpYyBDYWNoZURpc3RyaWJ1dGlvblBv\nbGljeSBnZXREaXN0cmlidXRpb25Qb2xpY3koKSB7CiAgICAgICAgcmV0dXJu\nIF9wb2xpY3k7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQWZmaXJtcyBp\nZiB0aGUgZ2l2ZW4gdHlwZSBpcyBlbGlnaWJsZSBmb3IgY2FjaGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGlzQ2FjaGFibGUoQ2xhc3NNZXRhRGF0\nYSBtZXRhKSB7CiAgICAgICAgQm9vbGVhbiByZXMgPSBfY2FjaGVhYmxlLmdl\ndChtZXRhKTsKICAgICAgICBpZihyZXMgIT0gbnVsbCl7CiAgICAgICAgICAg\nIHJldHVybiByZXM7CiAgICAgICAgfQoKICAgICAgICBCb29sZWFuIGlzQ2Fj\naGFibGUgPSBpc0NhY2hlYWJsZUJ5TW9kZShtZXRhKTsKICAgICAgICBpZiAo\naXNDYWNoYWJsZSA9PSBudWxsKSB7CiAgICAgICAgICAgaXNDYWNoYWJsZSA9\nIGlzQ2FjaGVhYmxlQnlUeXBlKG1ldGEpOwogICAgICAgIH0KICAgICAgICBf\nY2FjaGVhYmxlLnB1dChtZXRhLCBpc0NhY2hhYmxlKTsKICAgICAgICByZXR1\ncm4gaXNDYWNoYWJsZTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0\nVHlwZXMoU2V0PFN0cmluZz4gaW5jbHVkZWRUeXBlcywgU2V0PFN0cmluZz4g\nZXhjbHVkZWRUeXBlcyl7CiAgICAgICAgX2luY2x1ZGVkVHlwZXMgPSBpbmNs\ndWRlZFR5cGVzOwogICAgICAgIF9leGNsdWRlZFR5cGVzID0gZXhjbHVkZWRU\neXBlczsKICAgIH0KICAgIC8qKgogICAgICogQWZmaXJtcyB0aGUgZ2l2ZW4g\nY2xhc3MgaXMgZWxpZ2libGUgdG8gYmUgY2FjaGVkIGFjY29yZGluZyB0byB0\naGUgY2FjaGUgbW9kZQogICAgICogYW5kIHRoZSBjYWNoZSBlbmFibGUgZmxh\nZyBvbiB0aGUgZ2l2ZW4gbWV0YWRhdGEuCiAgICAgKiAgCiAgICAgKiBAcmV0\ndXJuIFRSVUUgb3IgRkFMU0UgaWYgIGNhY2hlIG1vZGUgaXMgY29uZmlndXJl\nZC4gbnVsbCBvdGhlcndpc2UuCiAgICAgKi8KICAgIHByaXZhdGUgQm9vbGVh\nbiBpc0NhY2hlYWJsZUJ5TW9kZShDbGFzc01ldGFEYXRhIG1ldGEpIHsgCiAg\nICAgICAgU3RyaW5nIG1vZGUgPSBfY29uZi5nZXREYXRhQ2FjaGVNb2RlKCk7\nCiAgICAgICAgaWYgKERhdGFDYWNoZU1vZGUuQUxMLnRvU3RyaW5nKCkuZXF1\nYWxzSWdub3JlQ2FzZShtb2RlKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICAgICAgaWYgKERhdGFDYWNoZU1vZGUuTk9ORS50b1N0cmluZygpLmVx\ndWFsc0lnbm9yZUNhc2UobW9kZSkpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICBpZiAoRGF0YUNhY2hlTW9kZS5FTkFCTEVfU0VMRUNUSVZF\nLnRvU3RyaW5nKCkuZXF1YWxzSWdub3JlQ2FzZShtb2RlKSkKICAgICAgICAg\nICAgcmV0dXJuIEJvb2xlYW4uVFJVRS5lcXVhbHMobWV0YS5nZXRDYWNoZUVu\nYWJsZWQoKSk7CiAgICAgICAgaWYgKERhdGFDYWNoZU1vZGUuRElTQUJMRV9T\nRUxFQ1RJVkUudG9TdHJpbmcoKS5lcXVhbHNJZ25vcmVDYXNlKG1vZGUpKQog\nICAgICAgICAgICByZXR1cm4gIUJvb2xlYW4uRkFMU0UuZXF1YWxzKG1ldGEu\nZ2V0Q2FjaGVFbmFibGVkKCkpOwogICAgICAgIHJldHVybiBudWxsOwogICAg\nfQogICAgCiAgICAvKioKICAgICAqIElzIHRoZSBnaXZlbiB0eXBlIGNhY2hl\nYWJsZSBieSBARGF0YUNhY2hlIGFubm90YXRpb24gb3Igb3BlbmpwYS5EYXRh\nQ2FjaGUoVHlwZXMvRXhjbHVkZWRUeXBlcykKICAgICAqICAKICAgICAqIEBz\nZWUgQ2xhc3NNZXRhRGF0YSNnZXREYXRhQ2FjaGVOYW1lKCkKICAgICAqLwog\nICAgcHJpdmF0ZSBCb29sZWFuIGlzQ2FjaGVhYmxlQnlUeXBlKENsYXNzTWV0\nYURhdGEgbWV0YSkgeyAKICAgICAgICBpZiAoX2luY2x1ZGVkVHlwZXMgIT0g\nbnVsbCAmJiBfaW5jbHVkZWRUeXBlcy5zaXplKCkgPiAwKSB7CiAgICAgICAg\nICAgIHJldHVybiBfaW5jbHVkZWRUeXBlcy5jb250YWlucyhtZXRhLmdldERl\nc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpOwogICAgICAgIH0KICAgICAgICBp\nZiAoX2V4Y2x1ZGVkVHlwZXMgIT0gbnVsbCAmJiBfZXhjbHVkZWRUeXBlcy5z\naXplKCkgPiAwKSB7CiAgICAgICAgICAgIGlmIChfZXhjbHVkZWRUeXBlcy5j\nb250YWlucyhtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpKSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBDYXNlIHdoZXJlIFR5cGVzIGlz\nIG5vdCBzZXQsIGFuZCBFeGNsdWRlZFR5cGVzIG9ubHkgaGFzIGEgc3ViIHNl\ndCBvZiBhbGwKICAgICAgICAgICAgICAgIC8vIEVudGl0aWVzLgogICAgICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgLy8gQ2hlY2sgZm9yIEBEYXRhQ2FjaGUgYW5ub3RhdGlvbnMK\nICAgICAgICByZXR1cm4gbWV0YS5nZXREYXRhQ2FjaGVOYW1lKCkgIT0gbnVs\nbDsKICAgIH0KfQo=\n","encoding":"base64"}

