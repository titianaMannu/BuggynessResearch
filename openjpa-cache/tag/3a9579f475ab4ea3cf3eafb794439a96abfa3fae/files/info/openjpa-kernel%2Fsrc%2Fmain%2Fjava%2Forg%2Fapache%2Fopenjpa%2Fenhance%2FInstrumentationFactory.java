{"sha":"2a0d0cce627980ef19434af2f8cfc827e43a85bc","node_id":"MDQ6QmxvYjIwNjM2NDoyYTBkMGNjZTYyNzk4MGVmMTk0MzRhZjJmOGNmYzgyN2U0M2E4NWJj","size":14508,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2a0d0cce627980ef19434af2f8cfc827e43a85bc","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW07\nCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5P\ndXRwdXRTdHJlYW1Xcml0ZXI7CmltcG9ydCBqYXZhLmlvLlByaW50V3JpdGVy\nOwppbXBvcnQgamF2YS5sYW5nLmluc3RydW1lbnQuSW5zdHJ1bWVudGF0aW9u\nOwppbXBvcnQgamF2YS5sYW5nLm1hbmFnZW1lbnQuTWFuYWdlbWVudEZhY3Rv\ncnk7CmltcG9ydCBqYXZhLmxhbmcubWFuYWdlbWVudC5SdW50aW1lTVhCZWFu\nOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS5uZXQuVVJMQ2xh\nc3NMb2FkZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xs\nZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkNvZGVTb3VyY2U7CmltcG9ydCBq\nYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuamFyLkF0dHJpYnV0ZXM7CmltcG9ydCBqYXZhLnV0aWwuamFyLkphckZp\nbGU7CmltcG9ydCBqYXZhLnV0aWwuamFyLk1hbmlmZXN0OwppbXBvcnQgamF2\nYS51dGlsLnppcC5aaXBFbnRyeTsKaW1wb3J0IGphdmEudXRpbC56aXAuWmlw\nT3V0cHV0U3RyZWFtOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nbG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5K\nYXZhVmVyc2lvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwoKCi8qKgogKiBGYWN0b3J5IGZvciBvYnRhaW5pbmcg\nYW4ge0BsaW5rIEluc3RydW1lbnRhdGlvbn0gaW5zdGFuY2UuCiAqCiAqIEBh\ndXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBzaW5jZSAxLjAuMAogKi8K\ncHVibGljIGNsYXNzIEluc3RydW1lbnRhdGlvbkZhY3RvcnkgewogICAgcHJp\ndmF0ZSBzdGF0aWMgSW5zdHJ1bWVudGF0aW9uIF9pbnN0OwogICAgcHJpdmF0\nZSBzdGF0aWMgYm9vbGVhbiBfZHluYW1pY2FsbHlJbnN0YWxsID0gdHJ1ZTsK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBfbmFtZSA9IEluc3Ry\ndW1lbnRhdGlvbkZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgpOwogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZSgKICAgICAgICBJbnN0cnVtZW50YXRpb25GYWN0b3J5LmNsYXNz\nKTsKICAgIAogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyBub3Qgc3lu\nY2hyb25pemVkIGJlY2F1c2Ugd2hlbiB0aGUgYWdlbnQgaXMgbG9hZGVkIGZy\nb20KICAgICAqIGdldEluc3RydW1lbnRhdGlvbigpIHRoYXQgbWV0aG9kIHdp\nbGwgY2F1c2UgYWdlbnRtYWluKC4uKSB0byBiZSBjYWxsZWQuCiAgICAgKiBT\neW5jaHJvbml6aW5nIHRoaXMgbWV0aG9kIHdvdWxkIGNhdXNlIGEgZGVhZGxv\nY2suCiAgICAgKiAKICAgICAqIEBwYXJhbSBpbnN0IFRoZSBpbnN0cnVtZW50\nYXRpb24gaW5zdGFuY2UgdG8gYmUgdXNlZCBieSB0aGlzIGZhY3RvcnkuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBzZXRJbnN0cnVtZW50YXRp\nb24oSW5zdHJ1bWVudGF0aW9uIGluc3QpIHsKICAgICAgICBfaW5zdCA9IGlu\nc3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25maWd1cmVzIHdoZXRoZXIg\nb3Igbm90IHRoaXMgaW5zdGFuY2Ugc2hvdWxkIGF0dGVtcHQgdG8gZHluYW1p\nY2FsbHkKICAgICAqIGluc3RhbGwgYW4gYWdlbnQgaW4gdGhlIFZNLiBEZWZh\ndWx0cyB0byA8Y29kZT50cnVlPC9jb2RlPi4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBzeW5jaHJvbml6ZWQgdm9pZCBzZXREeW5hbWljYWxseUluc3Rh\nbGxBZ2VudChib29sZWFuIHZhbCkgewogICAgICAgIF9keW5hbWljYWxseUlu\nc3RhbGwgPSB2YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBAcGFyYW0gbG9n\nIE9wZW5KUEEgbG9nLgogICAgICogQHJldHVybiBudWxsIGlmIEluc3RydW1l\nbnRhdGlvbiBjYW4gbm90IGJlIG9idGFpbmVkLCBvciBpZiBhbnkgCiAgICAg\nKiBFeGNlcHRpb25zIGFyZSBlbmNvdW50ZXJlZC4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBzeW5jaHJvbml6ZWQgSW5zdHJ1bWVudGF0aW9uIGdldElu\nc3RydW1lbnRhdGlvbihmaW5hbCBMb2cgbG9nKSB7CiAgICAgICAgaWYgKF9p\nbnN0ICE9IG51bGwgfHwgIV9keW5hbWljYWxseUluc3RhbGwpCiAgICAgICAg\nICAgIHJldHVybiBfaW5zdDsKCiAgICAgICAgLy8gZHluYW1pYyBsb2FkaW5n\nIG9mIHRoZSBhZ2VudCBpcyBvbmx5IGF2YWlsYWJsZSBpbiBKREsgMS42Kwog\nICAgICAgIGlmIChKYXZhVmVyc2lvbnMuVkVSU0lPTiA8IDYpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwoKICAgICAgICBBY2Nlc3NDb250cm9sbGVyLmRv\nUHJpdmlsZWdlZChuZXcgUHJpdmlsZWdlZEFjdGlvbjxPYmplY3Q+KCkgewog\nICAgICAgICAgICBwdWJsaWMgT2JqZWN0IHJ1bigpIHsKICAgICAgICAgICAg\nICAgIC8vIER5bmFtaWMgYWdlbnQgZW5oYW5jZW1lbnQgc2hvdWxkIG9ubHkg\nb2NjdXIgd2hlbiB0aGUgT3BlbkpQQSBsaWJyYXJ5IGlzIAogICAgICAgICAg\nICAgICAgLy8gbG9hZGVkIHVzaW5nIHRoZSBzeXN0ZW0gY2xhc3MgbG9hZGVy\nLiAgT3RoZXJ3aXNlLCB0aGUgT3BlbkpQQQogICAgICAgICAgICAgICAgLy8g\nbGlicmFyeSBtYXkgZ2V0IGxvYWRlZCBieSBzZXBhcmF0ZSwgZGlzanVuY3Qg\nbG9hZGVycywgbGVhZGluZyB0byBsaW5rYWdlIGlzc3Vlcy4KICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFJbnN0cnVt\nZW50YXRpb25GYWN0b3J5LmNsYXNzLmdldENsYXNzTG9hZGVyKCkuZXF1YWxz\nKAogICAgICAgICAgICAgICAgICAgICAgICBDbGFzc0xvYWRlci5nZXRTeXN0\nZW1DbGFzc0xvYWRlcigpKSkgewogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgCiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBjYW4ndCBmaW5kIHRo\nZSB0b29scy5qYXIsIHdlIGNhbid0IGxvYWQgdGhlIGFnZW50LgogICAgICAg\nICAgICAgICAgRmlsZSB0b29sc0phciA9IGZpbmRUb29sc0phcihsb2cpOwog\nICAgICAgICAgICAgICAgaWYgKHRvb2xzSmFyID09IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgICAgICBDbGFzczw/PiB2bUNsYXNzID0gbG9hZFZNQ2xh\nc3ModG9vbHNKYXIsIGxvZyk7CiAgICAgICAgICAgICAgICBpZiAodm1DbGFz\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTdHJpbmcgYWdl\nbnRQYXRoID0gZ2V0QWdlbnRKYXIobG9nKTsKICAgICAgICAgICAgICAgIGlm\nIChhZ2VudFBhdGggPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nbG9hZEFnZW50KGxvZywgYWdlbnRQYXRoLCB2bUNsYXNzKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9Ly8gZW5kIHJ1bigp\nCiAgICAgICAgfSk7CiAgICAgICAgLy8gSWYgdGhlIGxvYWQoLi4uKSBhZ2Vu\ndCBjYWxsIHdhcyBzdWNjZXNzZnVsLCB0aGlzIHZhcmlhYmxlIHdpbGwgbm8g\nCiAgICAgICAgLy8gbG9uZ2VyIGJlIG51bGwuCiAgICAgICAgcmV0dXJuIF9p\nbnN0OwogICAgfS8vZW5kIGdldEluc3RydW1lbnRhdGlvbigpCgogICAgLyoq\nCiAgICAgKiAgVGhlIG1ldGhvZCB0aGF0IGlzIGNhbGxlZCB3aGVuIGEgamFy\nIGlzIGFkZGVkIGFzIGFuIGFnZW50IGF0IHJ1bnRpbWUuCiAgICAgKiAgQWxs\nIHRoaXMgbWV0aG9kIGRvZXMgaXMgc3RvcmUgdGhlIHtAbGluayBJbnN0cnVt\nZW50YXRpb259IGZvcgogICAgICogIGxhdGVyIHVzZS4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyB2b2lkIGFnZW50bWFpbihTdHJpbmcgYWdlbnRBcmdz\nLCBJbnN0cnVtZW50YXRpb24gaW5zdCkgewogICAgICAgIEluc3RydW1lbnRh\ndGlvbkZhY3Rvcnkuc2V0SW5zdHJ1bWVudGF0aW9uKGluc3QpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGphciBmaWxlIGZvciB0aGUg\nc29sZSBwdXJwb3NlIG9mIHNwZWNpZnlpbmcgYW4gQWdlbnQtQ2xhc3MKICAg\nICAqIHRvIGxvYWQgaW50byB0aGUgSlZNLgogICAgICogCiAgICAgKiBAcmV0\ndXJuIGFic29sdXRlIHBhdGggdG8gdGhlIG5ldyBqYXIgZmlsZS4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIGNyZWF0ZUFnZW50SmFyKCkg\ndGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBGaWxlIGZpbGUgPQogICAg\nICAgICAgICBGaWxlLmNyZWF0ZVRlbXBGaWxlKEluc3RydW1lbnRhdGlvbkZh\nY3RvcnkuY2xhc3MuZ2V0TmFtZSgpLCAiLmphciIpOwogICAgICAgIGZpbGUu\nZGVsZXRlT25FeGl0KCk7CgogICAgICAgIFppcE91dHB1dFN0cmVhbSB6b3V0\nID0gbmV3IFppcE91dHB1dFN0cmVhbShuZXcgRmlsZU91dHB1dFN0cmVhbShm\naWxlKSk7CiAgICAgICAgem91dC5wdXROZXh0RW50cnkobmV3IFppcEVudHJ5\nKCJNRVRBLUlORi9NQU5JRkVTVC5NRiIpKTsKCiAgICAgICAgUHJpbnRXcml0\nZXIgd3JpdGVyID0gbmV3IFByaW50V3JpdGVyKG5ldyBPdXRwdXRTdHJlYW1X\ncml0ZXIoem91dCkpOwoKICAgICAgICB3cml0ZXIKICAgICAgICAgICAgLnBy\naW50bG4oIkFnZW50LUNsYXNzOiAiICsgSW5zdHJ1bWVudGF0aW9uRmFjdG9y\neS5jbGFzcy5nZXROYW1lKCkpOwogICAgICAgIHdyaXRlci5wcmludGxuKCJD\nYW4tUmVkZWZpbmUtQ2xhc3NlczogdHJ1ZSIpOwogICAgICAgIHdyaXRlci5w\ncmludGxuKCJDYW4tUmV0cmFuc2Zvcm0tQ2xhc3NlczogdHJ1ZSIpOwoKICAg\nICAgICB3cml0ZXIuY2xvc2UoKTsKCiAgICAgICAgcmV0dXJuIGZpbGUuZ2V0\nQWJzb2x1dGVQYXRoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIHBy\naXZhdGUgd29ya2VyIG1ldGhvZCBhdHRlbXB0cyB0byBmaW5kIFtqYXZhX2hv\nbWVdL2xpYi90b29scy5qYXIuCiAgICAgKiBOb3RlOiBUaGUgdG9vbHMuamFy\nIGlzIGEgcGFydCBvZiB0aGUgU0RLLCBpdCBpcyBub3QgcHJlc2VudCBpbiB0\naGUgSlJFLgogICAgICogCiAgICAgKiBAcmV0dXJuIElmIHRvb2xzLmphciBj\nYW4gYmUgZm91bmQsIGEgRmlsZSByZXByZXNlbnRpbmcgdG9vbHMuamFyLiA8\nQlI+CiAgICAgKiAgICAgICAgIElmIHRvb2xzLmphciBjYW5ub3QgYmUgZm91\nbmQsIG51bGwuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIEZpbGUgZmlu\nZFRvb2xzSmFyKExvZyBsb2cpIHsKICAgICAgICBTdHJpbmcgamF2YUhvbWUg\nPSBTeXN0ZW0uZ2V0UHJvcGVydHkoImphdmEuaG9tZSIpOwogICAgICAgIEZp\nbGUgamF2YUhvbWVGaWxlID0gbmV3IEZpbGUoamF2YUhvbWUpOwoKICAgICAg\nICAvLyBJQk0gSkRLIGhhY2sgLS0gZm9yIHNvbWUgcmVhc29uIHdoZW4gcnVu\nbmluZyBvbiB0aGUgSUJNIEpESywgdGhlIEpWTQogICAgICAgIC8vIGFwcGVu\nZHMgL2pyZSB0byB0aGUgamF2YS5ob21lIFN5c3RlbVByb3BlcnR5LiBSZW1v\ndmUgdGhlIGFkZGl0aW9uIHRvCiAgICAgICAgLy8gYmUgY29uc2lzdGVudCB3\naXRoIFN1bi4gTm90ZTogTm90IHN1cmUgaWYgdGhpcyBpcyBzb21ldGhpbmcg\nZGVwZW5kZW50CiAgICAgICAgLy8gb24gbXkgbWFjaGluZS4gTm90IHJlYWxs\neSB0aGF0IGJpZyBvZiBhIGRlYWwgc2luY2UgdGhpcyBpc24ndAogICAgICAg\nIC8vIHN1cHBvcnRlZCBvbiB0aGUgSUJNIEpESyBhdCB0aGlzIHBvaW50Lgog\nICAgICAgIEZpbGUgdG9vbHNKYXJGaWxlID0KICAgICAgICAgICAgbmV3IEZp\nbGUoamF2YUhvbWVGaWxlLCAibGliIiArIEZpbGUuc2VwYXJhdG9yICsgInRv\nb2xzLmphciIpOwogICAgICAgIGlmICh0b29sc0phckZpbGUuZXhpc3RzKCkg\nPT0gZmFsc2UpIHsKICAgICAgICAgICAgLy8gSWYgdG9vbHMgamFyIGZpbGUg\naXNuJ3QgZm91bmQsIHdlIG1heSBiZSBvbiBhbiBJQk0gSkRLLiBJZiB0aGUK\nICAgICAgICAgICAgLy8gamF2YS5ob21lIHByb3BlcnR5IGVuZHMgaW4gL2py\nZSwgdHJ5IHJlbW92aW5nIGl0IHRvIGxvb2sgZm9yIHRoZQogICAgICAgICAg\nICAvLyB0b29scy5qYXIuCiAgICAgICAgICAgIFN0cmluZyBhYnNQYXRoID0g\namF2YUhvbWVGaWxlLmdldEFic29sdXRlUGF0aCgpOwogICAgICAgICAgICBp\nZiAoYWJzUGF0aC5lbmRzV2l0aChGaWxlLnNlcGFyYXRvciArICJqcmUiKSA9\nPSB0cnVlKSB7CiAgICAgICAgICAgICAgICBqYXZhSG9tZUZpbGUgPSBqYXZh\nSG9tZUZpbGUuZ2V0UGFyZW50RmlsZSgpOwogICAgICAgICAgICAgICAgdG9v\nbHNKYXJGaWxlID0KICAgICAgICAgICAgICAgICAgICBuZXcgRmlsZShqYXZh\nSG9tZUZpbGUsICJsaWIiICsgRmlsZS5zZXBhcmF0b3IgKwogICAgICAgICAg\nICAgICAgICAgICAgICAidG9vbHMuamFyIik7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIGlmICh0b29sc0phckZpbGUuZXhpc3RzKCkgPT0g\nZmFsc2UpIHsKICAgICAgICAgICAgU3RyaW5nIHRvb2xzSmFyUGF0aCA9IHRv\nb2xzSmFyRmlsZS5nZXRBYnNvbHV0ZVBhdGgoKTsKICAgICAgICAgICAgaWYg\nKGxvZy5pc1RyYWNlRW5hYmxlZCgpID09IHRydWUpIHsKICAgICAgICAgICAg\nICAgIGxvZy50cmFjZShfbmFtZSArICIuZmluZFRvb2xzSmFyKCkgLS0gY291\nbGRuJ3QgZmluZCAiCiAgICAgICAgICAgICAgICAgICAgKyB0b29sc0phclBh\ndGgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gdG9vbHNKYXJGaWxlOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhpcyBwcml2YXRlIHdvcmtlciBtZXRob2Qgd2ls\nbCByZXR1cm4gYSBmdWxseSBxdWFsaWZpZWQgcGF0aCB0byBhIGphcgogICAg\nICogdGhhdCBoYXMgdGhpcyBjbGFzcyBkZWZpbmVkIGFzIGFuIEFnZW50LUNs\nYXNzIGluIGl0J3MKICAgICAqIE1FVEEtSU5GL21hbmlmZXN0Lm1mIGZpbGUu\nIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzIHRoZSBwYXRoIHNob3VsZAog\nICAgICogcG9pbnQgdG8gdGhlIE9wZW5KUEEgamFyLiBJZiBydW5uaW5nIGlu\nIGEgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnQgYQogICAgICogdGVtcG9yYXJ5\nIGphciBmaWxlIHdpbGwgYmUgY3JlYXRlZC4KICAgICAqIAogICAgICogQHJl\ndHVybiBhYnNvbHV0ZSBwYXRoIHRvIHRoZSBhZ2VudCBqYXIgb3IgbnVsbCBp\nZiBhbnl0aGluZyB1bmV4cGVjdGVkCiAgICAgKiBoYXBwZW5zLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgZ2V0QWdlbnRKYXIoTG9nIGxv\nZykgewogICAgICAgIEZpbGUgYWdlbnRKYXJGaWxlID0gbnVsbDsKICAgICAg\nICAvLyBGaW5kIHRoZSBuYW1lIG9mIHRoZSBGaWxlIHRoYXQgdGhpcyBjbGFz\ncyB3YXMgbG9hZGVkIGZyb20uIFRoYXQKICAgICAgICAvLyBqYXIgKnNob3Vs\nZCogYmUgdGhlIHNhbWUgbG9jYXRpb24gYXMgb3VyIGFnZW50LgogICAgICAg\nIENvZGVTb3VyY2UgY3MgPQogICAgICAgICAgICBJbnN0cnVtZW50YXRpb25G\nYWN0b3J5LmNsYXNzLmdldFByb3RlY3Rpb25Eb21haW4oKS5nZXRDb2RlU291\ncmNlKCk7CiAgICAgICAgaWYgKGNzICE9IG51bGwpIHsKICAgICAgICAgICAg\nVVJMIGxvYyA9IGNzLmdldExvY2F0aW9uKCk7CiAgICAgICAgICAgIGlmKGxv\nYyE9bnVsbCl7CiAgICAgICAgICAgICAgICBhZ2VudEphckZpbGUgPSBuZXcg\nRmlsZShsb2MuZ2V0RmlsZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICAKICAgICAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0aGUgRmls\nZSB0aGF0IHRoaXMgY2xhc3Mgd2FzIGxvYWRlZCBmcm9tIGhhcyB0aGlzCiAg\nICAgICAgLy8gY2xhc3MgZGVmaW5lZCBhcyB0aGUgQWdlbnQtQ2xhc3MuCiAg\nICAgICAgYm9vbGVhbiBjcmVhdGVKYXIgPSBmYWxzZTsKICAgICAgICBpZiAo\nY3MgPT0gbnVsbCB8fCBhZ2VudEphckZpbGUgPT0gbnVsbAogICAgICAgICAg\nICB8fCBhZ2VudEphckZpbGUuaXNEaXJlY3RvcnkoKSA9PSB0cnVlKSB7CiAg\nICAgICAgICAgIGNyZWF0ZUphciA9IHRydWU7CiAgICAgICAgfWVsc2UgaWYo\ndmFsaWRhdGVBZ2VudEphck1hbmlmZXN0KGFnZW50SmFyRmlsZSwgbG9nLCBf\nbmFtZSkgPT0gZmFsc2UpewogICAgICAgICAgICAvLyBXZSBoYXZlIGFuIGFn\nZW50SmFyRmlsZSwgYnV0IHRoaXMgY2xhc3MgaXNuJ3QgdGhlIEFnZW50LUNs\nYXNzLgogICAgICAgICAgICBjcmVhdGVKYXI9dHJ1ZTsgICAgICAgICAgIAog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBTdHJpbmcgYWdlbnRKYXI7CiAg\nICAgICAgaWYgKGNyZWF0ZUphciA9PSB0cnVlKSB7CiAgICAgICAgICAgIC8v\nIFRoaXMgY2FuIGhhcHBlbiB3aGVuIHJ1bm5pbmcgaW4gZWNsaXBzZSBhcyBh\nbiBPcGVuSlBBCiAgICAgICAgICAgIC8vIGRldmVsb3BlciBvciBmb3Igc29t\nZSByZWFzb24gdGhlIENvZGVTb3VyY2UgaXMgbnVsbC4gV2UKICAgICAgICAg\nICAgLy8gc2hvdWxkIGxvZyBhIHdhcm5pbmcgaGVyZSBiZWNhdXNlIHRoaXMg\nd2lsbCBjcmVhdGUgYSBqYXIKICAgICAgICAgICAgLy8gaW4geW91ciB0ZW1w\nIGRpcmVjdG9yeSB0aGF0IGRvZXNuJ3QgYWx3YXlzIGdldCBjbGVhbmVkIHVw\nLgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYWdlbnRKYXIg\nPSBjcmVhdGVBZ2VudEphcigpOwogICAgICAgICAgICAgICAgaWYgKGxvZy5p\nc0luZm9FbmFibGVkKCkgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAg\nIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0ZW1wLWZpbGUtY3JlYXRpb24iLCBhZ2Vu\ndEphcikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNo\nIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAg\nICAgbG9nLnRyYWNlKF9uYW1lICsgIi5nZXRBZ2VudEphcigpIGNhdWdodCB1\nbmV4cGVjdGVkICIKICAgICAgICAgICAgICAgICAgICAgICAgKyAiZXhjZXB0\naW9uLiIsIGlvZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBhZ2VudEphciA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICBhZ2VudEphciA9IGFnZW50SmFyRmlsZS5nZXRB\nYnNvbHV0ZVBhdGgoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBhZ2Vu\ndEphcjsKICAgIH0vL2VuZCBnZXRBZ2VudEphcgoKICAgIC8qKgogICAgICog\nQXR0YWNoIGFuZCBsb2FkIGFuIGFnZW50IGNsYXNzLiAKICAgICAqIAogICAg\nICogQHBhcmFtIGxvZyBMb2cgdXNlZCBpZiB0aGUgYWdlbnQgY2Fubm90IGJl\nIGxvYWRlZC4KICAgICAqIEBwYXJhbSBhZ2VudEphciBhYnNvbHV0ZSBwYXRo\nIHRvIHRoZSBhZ2VudCBqYXIuCiAgICAgKiBAcGFyYW0gdm1DbGFzcyBWaXJ0\ndWFsTWFjaGluZS5jbGFzcyBmcm9tIHRvb2xzLmphci4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgdm9pZCBsb2FkQWdlbnQoTG9nIGxvZywgU3RyaW5n\nIGFnZW50SmFyLCBDbGFzczw/PiB2bUNsYXNzKSB7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgLy8gZmlyc3Qgb2J0YWluIHRoZSBQSUQgb2YgdGhlIGN1\ncnJlbnRseS1ydW5uaW5nIHByb2Nlc3MKICAgICAgICAgICAgLy8gIyMjIHRo\naXMgcmVsaWVzIG9uIHRoZSB1bmRvY3VtZW50ZWQgY29udmVudGlvbiBvZiB0\naGUKICAgICAgICAgICAgLy8gUnVudGltZU1YQmVhbidzCiAgICAgICAgICAg\nIC8vICMjIyBuYW1lIHN0YXJ0aW5nIHdpdGggdGhlIFBJRCwgYnV0IHRoZXJl\nIGFwcGVhcnMgdG8gYmUgbm8gb3RoZXIKICAgICAgICAgICAgLy8gIyMjIHdh\neSB0byBvYnRhaW4gdGhlIGN1cnJlbnQgcHJvY2VzcycgaWQsIHdoaWNoIHdl\nIG5lZWQgZm9yCiAgICAgICAgICAgIC8vICMjIyB0aGUgYXR0YWNoIHByb2Nl\nc3MKICAgICAgICAgICAgUnVudGltZU1YQmVhbiBydW50aW1lID0gTWFuYWdl\nbWVudEZhY3RvcnkuZ2V0UnVudGltZU1YQmVhbigpOwogICAgICAgICAgICBT\ndHJpbmcgcGlkID0gcnVudGltZS5nZXROYW1lKCk7CiAgICAgICAgICAgIGlm\nIChwaWQuaW5kZXhPZigiQCIpICE9IC0xKQogICAgICAgICAgICAgICAgcGlk\nID0gcGlkLnN1YnN0cmluZygwLCBwaWQuaW5kZXhPZigiQCIpKTsKCiAgICAg\nICAgICAgIC8vIEpESzEuNjogbm93IGF0dGFjaCB0byB0aGUgY3VycmVudCBW\nTSBzbyB3ZSBjYW4gZGVwbG95IGEgbmV3IGFnZW50CiAgICAgICAgICAgIC8v\nICMjIyB0aGlzIGlzIGEgU3VuIEpWTSBzcGVjaWZpYyBmZWF0dXJlOyBvdGhl\nciBKVk1zIG1heSBvZmZlcgogICAgICAgICAgICAvLyAjIyMgdGhpcyBmZWF0\ndXJlLCBidXQgaW4gYW4gaW1wbGVtZW50YXRpb24tZGVwZW5kZW50IHdheQog\nICAgICAgICAgICBPYmplY3Qgdm0gPQogICAgICAgICAgICAgICAgdm1DbGFz\ncy5nZXRNZXRob2QoImF0dGFjaCIsIG5ldyBDbGFzczw/PltdIHsgU3RyaW5n\nLmNsYXNzIH0pCiAgICAgICAgICAgICAgICAgICAgLmludm9rZShudWxsLCBu\nZXcgU3RyaW5nW10geyBwaWQgfSk7CgogICAgICAgICAgICAvLyBub3cgZGVw\nbG95IHRoZSBhY3R1YWwgYWdlbnQsIHdoaWNoIHdpbGwgd2luZCB1cCBjYWxs\naW5nCiAgICAgICAgICAgIC8vIGFnZW50bWFpbigpCiAgICAgICAgICAgIHZt\nQ2xhc3MuZ2V0TWV0aG9kKCJsb2FkQWdlbnQiLCBuZXcgQ2xhc3NbXSB7IFN0\ncmluZy5jbGFzcyB9KQogICAgICAgICAgICAgICAgLmludm9rZSh2bSwgbmV3\nIE9iamVjdFtdIHsgYWdlbnRKYXIgfSk7CiAgICAgICAgICAgIHZtQ2xhc3Mu\nZ2V0TWV0aG9kKCJkZXRhY2giLCBuZXcgQ2xhc3NbXSB7fSkuaW52b2tlKHZt\nLAogICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdIHt9KTsKICAgICAgICB9\nIGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICBpZiAobG9nLmlz\nVHJhY2VFbmFibGVkKCkgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgLy8g\nTG9nIHRoZSBtZXNzYWdlIGZyb20gdGhlIGV4Y2VwdGlvbi4gRG9uJ3QgbG9n\nIHRoZSBlbnRpcmUKICAgICAgICAgICAgICAgIC8vIHN0YWNrIGFzIHRoaXMg\naXMgZXhwZWN0ZWQgd2hlbiBydW5uaW5nIG9uIGEgSkRLIHRoYXQgZG9lc24n\ndAogICAgICAgICAgICAgICAgLy8gc3VwcG9ydCB0aGUgQXR0YWNoIEFQSS4K\nICAgICAgICAgICAgICAgIGxvZy50cmFjZShfbmFtZSArICIubG9hZEFnZW50\nKCkgY2F1Z2h0IGFuIGV4Y2VwdGlvbi4gTWVzc2FnZTogIgogICAgICAgICAg\nICAgICAgICAgICsgdC5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGhpcyBwcml2YXRlIG1l\ndGhvZCB3aWxsIGNyZWF0ZSBhIG5ldyBjbGFzc2xvYWRlciBhbmQgYXR0ZW1w\ndCB0byBsb2FkIHRoZQogICAgICogY29tLnN1bi50b29scy5hdHRhY2guVmly\ndHVhbE1hY2hpbmUgY2xhc3MgZnJvbSB0aGUgcHJvdmlkZWQgdG9vbHNKYXIK\nICAgICAqIGZpbGUuCiAgICAgKiAKICAgICAqIEByZXR1cm4gY29tLnN1bi50\nb29scy5hdHRhY2guVmlydHVhbE1hY2hpbmUgY2xhc3MgPGJyPgogICAgICog\nICAgICAgICBvciBudWxsIGlmIHNvbWV0aGluZyB1bmV4cGVjdGVkIGhhcHBl\nbmVkLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBDbGFzczw/PiBsb2Fk\nVk1DbGFzcyhGaWxlIHRvb2xzSmFyLCBMb2cgbG9nKSB7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgVVJMQ2xhc3NMb2FkZXIgbG9hZGVyID0KICAgICAg\nICAgICAgICAgIG5ldyBVUkxDbGFzc0xvYWRlcihuZXcgVVJMW10geyB0b29s\nc0phci50b1VSSSgpLnRvVVJMKCkgfSwKICAgICAgICAgICAgICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRlcigp\nKTsKICAgICAgICAgICAgcmV0dXJuIGxvYWRlci5sb2FkQ2xhc3MoImNvbS5z\ndW4udG9vbHMuYXR0YWNoLlZpcnR1YWxNYWNoaW5lIik7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1Ry\nYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBsb2cudHJhY2UoX25h\nbWUKICAgICAgICAgICAgICAgICAgICArICIubG9hZFZNQ2xhc3MoKSBmYWls\nZWQgdG8gbG9hZCB0aGUgVmlydHVhbE1hY2hpbmUgY2xhc3MiKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoaXMgcHJpdmF0ZSB3b3JrZXIgbWV0aG9kIHdp\nbGwgdmFsaWRhdGUgdGhhdCB0aGUgcHJvdmlkZWQgYWdlbnRDbGFzc05hbWUK\nICAgICAqIGlzIGRlZmluZWQgYXMgdGhlIEFnZW50LUNsYXNzIGluIHRoZSBt\nYW5pZmVzdCBmaWxlIGZyb20gdGhlIHByb3ZpZGVkIGphci4KICAgICAqIAog\nICAgICogQHBhcmFtIGFnZW50SmFyRmlsZQogICAgICogICAgICAgICAgICBu\nb24tbnVsbCBhZ2VudCBqYXIgZmlsZS4KICAgICAqIEBwYXJhbSBsb2cKICAg\nICAqICAgICAgICAgICAgbm9uLW51bGwgbG9nZ2VyLgogICAgICogQHBhcmFt\nIGFnZW50Q2xhc3NOYW1lCiAgICAgKiAgICAgICAgICAgIHRoZSBub24tbnVs\nbCBhZ2VudCBjbGFzcyBuYW1lLgogICAgICogQHJldHVybiBUcnVlIGlmIHRo\nZSBwcm92aWRlZCBhZ2VudENsYXNzTmFtZSBpcyBkZWZpbmVkIGFzIHRoZSBB\nZ2VudC1DbGFzcwogICAgICogICAgICAgICBpbiB0aGUgbWFuaWZlc3QgZnJv\nbSB0aGUgcHJvdmlkZWQgYWdlbnRKYXJGaWxlLiBGYWxzZSBvdGhlcndpc2Uu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gdmFsaWRhdGVB\nZ2VudEphck1hbmlmZXN0KEZpbGUgYWdlbnRKYXJGaWxlLCBMb2cgbG9nLAog\nICAgICAgIFN0cmluZyBhZ2VudENsYXNzTmFtZSkgewogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIEphckZpbGUgamFyID0gbmV3IEphckZpbGUoYWdlbnRK\nYXJGaWxlKTsKICAgICAgICAgICAgTWFuaWZlc3QgbWFuaWZlc3QgPSBqYXIu\nZ2V0TWFuaWZlc3QoKTsKICAgICAgICAgICAgaWYgKG1hbmlmZXN0ID09IG51\nbGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBBdHRyaWJ1dGVzIGF0dHJpYnV0ZXMgPSBtYW5p\nZmVzdC5nZXRNYWluQXR0cmlidXRlcygpOwogICAgICAgICAgICBTdHJpbmcg\nYWMgPSBhdHRyaWJ1dGVzLmdldFZhbHVlKCJBZ2VudC1DbGFzcyIpOwogICAg\nICAgICAgICBpZiAoYWMgIT0gbnVsbCAmJiBhYy5lcXVhbHMoYWdlbnRDbGFz\nc05hbWUpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSA9PSB0cnVlKSB7CiAg\nICAgICAgICAgICAgICBsb2cudHJhY2UoX25hbWUKICAgICAgICAgICAgICAg\nICAgICArICIudmFsaWRhdGVBZ2VudEphck1hbmlmZXN0KCkgY2F1Z2h0IHVu\nZXhwZWN0ZWQgIgogICAgICAgICAgICAgICAgICAgICsgImV4Y2VwdGlvbiAi\nICsgZS5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0vLyBlbmQgdmFsaWRhdGVBZ2Vu\ndEphck1hbmlmZXN0ICAgCn0K\n","encoding":"base64"}

