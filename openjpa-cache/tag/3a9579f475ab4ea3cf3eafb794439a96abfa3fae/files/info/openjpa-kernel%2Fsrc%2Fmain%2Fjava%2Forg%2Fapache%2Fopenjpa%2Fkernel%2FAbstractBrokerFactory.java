{"sha":"9622ce67321aaa32e762c0e3ee18c690e0d8e6c2","node_id":"MDQ6QmxvYjIwNjM2NDo5NjIyY2U2NzMyMWFhYTMyZTc2MmMwZTNlZTE4YzY5MGUwZDhlNmMy","size":29951,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9622ce67321aaa32e762c0e3ee18c690e0d8e6c2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmxvY2tzLlJlZW50cmFudExvY2s7\nCgppbXBvcnQgamF2YXgudHJhbnNhY3Rpb24uU3RhdHVzOwppbXBvcnQgamF2\nYXgudHJhbnNhY3Rpb24uU3luY2hyb25pemF0aW9uOwppbXBvcnQgamF2YXgu\ndHJhbnNhY3Rpb24uVHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC50cmFuc2Fj\ndGlvbi5UcmFuc2FjdGlvbk1hbmFnZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmNvbGxlY3Rpb25zLnNldC5NYXBCYWNrZWRTZXQ7CmltcG9ydCBv\ncmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5jb25mLkJyb2tlclZhbHVlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmNvbmYuTWV0YURhdGFSZXBvc2l0b3J5VmFsdWU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5K\nUEFDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5jb25mLk9wZW5KUEFWZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmRhdGFjYWNoZS5EYXRhQ2FjaGVTdG9yZU1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZWUuTWFuYWdlZFJ1bnRpbWU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5NYW5hZ2VkQ2xhc3NTdWJjbGFz\nc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUENSZWdp\nc3RyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBlcnNp\nc3RlbmNlQ2FwYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5ldmVu\ndC5Ccm9rZXJGYWN0b3J5RXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuZXZlbnQuUmVtb3RlQ29tbWl0RXZlbnRNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLmNvbmN1cnJl\nbnQuQ29uY3VycmVudFJlZmVyZW5jZUhhc2hTZXQ7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YU1vZGVzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRh\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3Bl\nbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlVzZXJFeGNlcHRpb247CgovKioKICogQWJzdHJhY3QgaW1wbGVtZW50YXRp\nb24gb2YgdGhlIHtAbGluayBCcm9rZXJGYWN0b3J5fQogKiB0aGF0IG11c3Qg\nYmUgc3ViY2xhc3NlZCBmb3IgYSBzcGVjaWZpYyBydW50aW1lLgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKi8KQFN1cHByZXNzV2FybmluZ3MoInNlcmlh\nbCIpCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdEJyb2tlckZhY3Rv\ncnkKICAgIGltcGxlbWVudHMgQnJva2VyRmFjdG9yeSB7CgogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZShBYnN0cmFjdEJyb2tlckZhY3RvcnkuY2xhc3MpOwoKICAgIC8v\nIHN0YXRpYyBtYXBwaW5nIG9mIGNvbmZpZ3VyYXRpb25zIHRvIHBvb2xlZCBi\ncm9rZXIgZmFjdG9yaWVzCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBNYXA8\nT2JqZWN0LEFic3RyYWN0QnJva2VyRmFjdG9yeT4gX3Bvb2wgPSAKICAgICAg\nIENvbGxlY3Rpb25zLnN5bmNocm9uaXplZE1hcChuZXcgSGFzaE1hcDxPYmpl\nY3QsQWJzdHJhY3RCcm9rZXJGYWN0b3J5PigpKTsKCiAgICAvLyBjb25maWd1\ncmF0aW9uCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0aW9u\nIF9jb25mOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcmVhZE9u\nbHkgPSBmYWxzZTsKICAgIHByaXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX2Ns\nb3NlZCA9IGZhbHNlOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgUnVudGltZUV4\nY2VwdGlvbiBfY2xvc2VkRXhjZXB0aW9uID0gbnVsbDsKICAgIHByaXZhdGUg\nTWFwPE9iamVjdCxPYmplY3Q+IF91c2VyT2JqZWN0cyA9IG51bGw7CgogICAg\nLy8gaW50ZXJuYWwgbG9jazogc3BlYyBmb3JiaWRzIHN5bmNocm9uaXphdGlv\nbiBvbiB0aGlzIG9iamVjdAogICAgcHJpdmF0ZSBmaW5hbCBSZWVudHJhbnRM\nb2NrIF9sb2NrID0gbmV3IFJlZW50cmFudExvY2soKTsKCiAgICAvLyBtYXBz\nIGdsb2JhbCB0cmFuc2FjdGlvbnMgdG8gYXNzb2NpYXRlZCBicm9rZXJzCiAg\nICBwcml2YXRlIHRyYW5zaWVudCBDb25jdXJyZW50SGFzaE1hcDxPYmplY3Qs\nQ29sbGVjdGlvbjxCcm9rZXI+PiAKICAgICAgICBfdHJhbnNhY3Rpb25hbCA9\nIG5ldyBDb25jdXJyZW50SGFzaE1hcDxPYmplY3QsQ29sbGVjdGlvbjxCcm9r\nZXI+PigpOwoKICAgIC8vIHdlYWstcmVmIHRyYWNraW5nIG9mIG9wZW4gYnJv\na2VycwogICAgcHJpdmF0ZSB0cmFuc2llbnQgU2V0PEJyb2tlcj4gX2Jyb2tl\ncnM7CgogICAgLy8gY2FjaGUgdGhlIGNsYXNzIG5hbWVzIGxvYWRlZCBmcm9t\nIHRoZSBwZXJzaXN0ZW50IGNsYXNzZXMgcHJvcGVydHkgc28KICAgIC8vIHRo\nYXQgd2UgY2FuIHJlLWxvYWQgdGhlbSBmb3IgZWFjaCBuZXcgYnJva2VyCiAg\nICBwcml2YXRlIHRyYW5zaWVudCBDb2xsZWN0aW9uPFN0cmluZz4gX3BjQ2xh\nc3NOYW1lcyA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBDb2xsZWN0\naW9uPENsYXNzTG9hZGVyPiBfcGNDbGFzc0xvYWRlcnMgPSBudWxsOwogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcGVyc2lzdGVudFR5cGVzTG9h\nZGVkID0gZmFsc2U7CgogICAgLy8gbGlmZWN5Y2xlIGxpc3RlbmVycyB0byBw\nYXNzIHRvIGVhY2ggYnJva2VyCiAgICBwcml2YXRlIHRyYW5zaWVudCBNYXA8\nT2JqZWN0LCBDbGFzczw/PltdPiBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbnVs\nbDsKCiAgICAvLyB0cmFuc2FjdGlvbiBsaXN0ZW5lcnMgdG8gcGFzcyB0byBl\nYWNoIGJyb2tlcgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTGlzdDxPYmplY3Q+\nIF90cmFuc2FjdGlvbkxpc3RlbmVycyA9IG51bGw7CgogICAgLy8ga2V5IHVu\nZGVyIHdoaWNoIHRoaXMgaW5zdGFuY2UgY2FuIGJlIHN0b3JlZCBpbiB0aGUg\nYnJva2VyIHBvb2wKICAgIC8vIGFuZCBsYXRlciBpZGVudGlmaWVkCiAgICBw\ncml2YXRlIE9iamVjdCBfcG9vbEtleTsgICAKICAgIAogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYW4gaW50ZXJuYWwgZmFjdG9yeSBwb29sIGtleSBmb3IgdGhl\nIGdpdmVuIGNvbmZpZ3VyYXRpb24uCiAgICAgKgogICAgICogQHNpbmNlIDEu\nMS4wCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0aWMgT2JqZWN0IHRvUG9v\nbEtleShNYXA8U3RyaW5nLE9iamVjdD4gbWFwKSB7CiAgICAgICAgT2JqZWN0\nIGtleSA9IENvbmZpZ3VyYXRpb25zLmdldFByb3BlcnR5KCJJZCIsIG1hcCk7\nCiAgICAgICAgcmV0dXJuICgga2V5ICE9IG51bGwpID8ga2V5IDogbWFwOwog\nICAgfQoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgPGNvZGU+ZmFjdG9yeTwv\nY29kZT4gaW4gdGhlIHBvb2wgdW5kZXIgPGNvZGU+a2V5PC9jb2RlPi4KICAg\nICAqCiAgICAgKiBAc2luY2UgMS4xLjAKICAgICAqLwogICAgcHJvdGVjdGVk\nIHN0YXRpYyB2b2lkIHBvb2woT2JqZWN0IGtleSwgQWJzdHJhY3RCcm9rZXJG\nYWN0b3J5IGZhY3RvcnkpIHsKICAgICAgICBzeW5jaHJvbml6ZWQoX3Bvb2wp\nIHsKICAgICAgICAgICAgX3Bvb2wucHV0KGtleSwgZmFjdG9yeSk7CiAgICAg\nICAgICAgIGZhY3Rvcnkuc2V0UG9vbEtleShrZXkpOwogICAgICAgICAgICBm\nYWN0b3J5Lm1ha2VSZWFkT25seSgpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcG9vbGVkIGZhY3RvcnkgbWF0Y2hpbmcg\ndGhlIGdpdmVuIGtleSwgb3IgbnVsbAogICAgICogaWYgbm9uZS4gVGhlIGtl\neSBtdXN0IGJlIG9mIHRoZSBmb3JtIGNyZWF0ZWQgYnkge0BsaW5rICNnZXRQ\nb29sS2V5fS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBBYnN0cmFjdEJy\nb2tlckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeUZvcktleShPYmplY3Qga2V5\nKSB7CiAgICAgICAgcmV0dXJuIChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9w\nb29sLmdldChrZXkpOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0\nb3IuIENvbmZpZ3VyYXRpb24gbXVzdCBiZSBwcm92aWRlZCBvbiBjb25zdHJ1\nY3Rpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBBYnN0cmFjdEJyb2tlckZh\nY3RvcnkoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZmlnKSB7CiAgICAgICAg\nX2NvbmYgPSBjb25maWc7CiAgICAgICAgX2Jyb2tlcnMgPSBuZXdCcm9rZXJT\nZXQoKTsKICAgICAgICBnZXRQY0NsYXNzTG9hZGVycygpOwogICAgICAgIGlm\nIChjb25maWcuaXNJbml0aWFsaXplRWFnZXJseSgpKSB7CiAgICAgICAgICAg\nIG5ld0Jyb2tlcihfY29uZi5nZXRDb25uZWN0aW9uVXNlck5hbWUoKSwgCiAg\nICAgICAgICAgIAlfY29uZi5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKSwgCiAg\nICAgICAgICAgIAlfY29uZi5pc0Nvbm5lY3Rpb25GYWN0b3J5TW9kZU1hbmFn\nZWQoKSwKICAgICAgICAgICAgICAgIF9jb25mLmdldENvbm5lY3Rpb25SZXRh\naW5Nb2RlQ29uc3RhbnQoKSwgZmFsc2UpLmNsb3NlKCk7IAogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29uZmlndXJhdGlv\nbiBmb3IgdGhpcyBmYWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICBy\nZXR1cm4gX2NvbmY7CiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9r\nZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ld0Jyb2tlcihfY29uZi5nZXRDb25u\nZWN0aW9uVXNlck5hbWUoKSwgX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3Jk\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmlu\nZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIHJldHVybiBuZXdCcm9r\nZXIodXNlciwgcGFzcywgX2NvbmYuaXNUcmFuc2FjdGlvbk1vZGVNYW5hZ2Vk\nKCksIF9jb25mLmdldENvbm5lY3Rpb25SZXRhaW5Nb2RlQ29uc3RhbnQoKSk7\nCiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9rZXIoYm9vbGVhbiBt\nYW5hZ2VkLCBpbnQgY29ublJldGFpbk1vZGUpIHsKICAgICAgICByZXR1cm4g\nbmV3QnJva2VyKF9jb25mLmdldENvbm5lY3Rpb25Vc2VyTmFtZSgpLCBfY29u\nZi5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKSwgbWFuYWdlZCwgY29ublJldGFp\nbk1vZGUpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0\ncmluZyB1c2VyLCBTdHJpbmcgcGFzcywgYm9vbGVhbiBtYW5hZ2VkLCBpbnQg\nY29ublJldGFpbk1vZGUpIHsKICAgICAgICByZXR1cm4gbmV3QnJva2VyKHVz\nZXIsIHBhc3MsIG1hbmFnZWQsIGNvbm5SZXRhaW5Nb2RlLCB0cnVlKTsKICAg\nIH0KICAgIAogICAgcHVibGljIEJyb2tlciBuZXdCcm9rZXIoU3RyaW5nIHVz\nZXIsIFN0cmluZyBwYXNzLCBib29sZWFuIG1hbmFnZWQsIGludCBjb25uUmV0\nYWluTW9kZSwgYm9vbGVhbiBmaW5kRXhpc3RpbmcpIHsKICAgICAgICByZXR1\ncm4gbmV3QnJva2VyKHVzZXIsIHBhc3MsIG1hbmFnZWQsIGNvbm5SZXRhaW5N\nb2RlLCBmaW5kRXhpc3RpbmcsICIiLCAiIik7CiAgICB9CgogICAgcHVibGlj\nIEJyb2tlciBuZXdCcm9rZXIoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzLCBi\nb29sZWFuIG1hbmFnZWQsIGludCBjb25uUmV0YWluTW9kZSwgYm9vbGVhbiBm\naW5kRXhpc3RpbmcsCiAgICAgICAgU3RyaW5nIGNmMU5hbWUsIFN0cmluZyBj\nZjJOYW1lKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Bl\nbigpOwogICAgICAgICAgICBtYWtlUmVhZE9ubHkoKTsKCiAgICAgICAgICAg\nIEJyb2tlciBicm9rZXIgPSBudWxsOwogICAgICAgICAgICBpZiAoZmluZEV4\naXN0aW5nKQogICAgICAgICAgICAgICAgYnJva2VyID0gZmluZEJyb2tlcih1\nc2VyLCBwYXNzLCBtYW5hZ2VkKTsKICAgICAgICAgICAgaWYgKGJyb2tlciA9\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICBicm9rZXIgPSBuZXdCcm9rZXJJ\nbXBsKHVzZXIsIHBhc3MpOwogICAgICAgICAgICAgICAgYnJva2VyLnNldENv\nbm5lY3Rpb25GYWN0b3J5TmFtZShjZjFOYW1lKTsKICAgICAgICAgICAgICAg\nIGJyb2tlci5zZXRDb25uZWN0aW9uRmFjdG9yeTJOYW1lKGNmMk5hbWUpOwog\nICAgICAgICAgICAgICAgaW5pdGlhbGl6ZUJyb2tlcihtYW5hZ2VkLCBjb25u\nUmV0YWluTW9kZSwgYnJva2VyLCBmYWxzZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcmV0dXJuIGJyb2tlcjsKICAgICAgICB9IGNhdGNoIChPcGVu\nSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IGtlOwogICAg\nICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24ocmUpOwogICAgICAgIH0K\nICAgIH0KCiAgICB2b2lkIGluaXRpYWxpemVCcm9rZXIoYm9vbGVhbiBtYW5h\nZ2VkLCBpbnQgY29ublJldGFpbk1vZGUsIEJyb2tlciBicm9rZXIsIGJvb2xl\nYW4gZnJvbURlc2VyaWFsaXphdGlvbikgewogICAgICAgIGFzc2VydE9wZW4o\nKTsKICAgICAgICBtYWtlUmVhZE9ubHkoKTsKICAgICAgICAKICAgICAgICBE\nZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRzbSA9IGNyZWF0ZURlbGVnYXRpbmdT\ndG9yZU1hbmFnZXIoKTsKCiAgICAgICAgKChCcm9rZXJJbXBsKSBicm9rZXIp\nLmluaXRpYWxpemUodGhpcywgZHNtLCBtYW5hZ2VkLCBjb25uUmV0YWluTW9k\nZSwgZnJvbURlc2VyaWFsaXphdGlvbik7CiAgICAgICAgaWYgKCFmcm9tRGVz\nZXJpYWxpemF0aW9uKQogICAgICAgICAgICBhZGRMaXN0ZW5lcnMoYnJva2Vy\nKTsKCiAgICAgICAgLy8gaWYgd2UncmUgdXNpbmcgcmVtb3RlIGV2ZW50cywg\ncmVnaXN0ZXIgdGhlIGV2ZW50IG1hbmFnZXIgc28KICAgICAgICAvLyB0aGF0\nIGl0IGNhbiBicm9hZGNhc3QgY29tbWl0IG5vdGlmaWNhdGlvbnMgZnJvbSB0\naGUgYnJva2VyCiAgICAgICAgUmVtb3RlQ29tbWl0RXZlbnRNYW5hZ2VyIHJl\nbW90ZSA9IF9jb25mLmdldFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlcigpOwog\nICAgICAgIGlmIChyZW1vdGUuYXJlUmVtb3RlRXZlbnRzRW5hYmxlZCgpKQog\nICAgICAgICAgICBicm9rZXIuYWRkVHJhbnNhY3Rpb25MaXN0ZW5lcihyZW1v\ndGUpOwoKICAgICAgICBsb2FkUGVyc2lzdGVudFR5cGVzKGJyb2tlci5nZXRD\nbGFzc0xvYWRlcigpKTsKICAgICAgICBfYnJva2Vycy5hZGQoYnJva2VyKTsK\nICAgICAgICBfY29uZi5zZXRSZWFkT25seShDb25maWd1cmF0aW9uLklOSVRf\nU1RBVEVfRlJPWkVOKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBmYWN0\nb3J5LXJlZ2lzdGVyZWQgbGlmZWN5Y2xlIGxpc3RlbmVycyB0byB0aGUgYnJv\na2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRMaXN0ZW5lcnMo\nQnJva2VyIGJyb2tlcikgewogICAgICAgIGlmIChfbGlmZWN5Y2xlTGlzdGVu\nZXJzICE9IG51bGwgJiYgIV9saWZlY3ljbGVMaXN0ZW5lcnMuaXNFbXB0eSgp\nKSB7CiAgICAgICAgICAgIGZvciAoTWFwLkVudHJ5PE9iamVjdCxDbGFzczw/\nPltdPiBlbnRyeSA6IF9saWZlY3ljbGVMaXN0ZW5lcnMuZW50cnlTZXQoKSkg\newogICAgICAgICAgICAgICAgYnJva2VyLmFkZExpZmVjeWNsZUxpc3RlbmVy\nKGVudHJ5LmdldEtleSgpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKF90cmFuc2FjdGlvbkxpc3Rl\nbmVycyAhPSBudWxsICYmICFfdHJhbnNhY3Rpb25MaXN0ZW5lcnMuaXNFbXB0\neSgpKSB7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8T2JqZWN0PiBpdHIg\nPSBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMuaXRlcmF0b3IoKTsKICAgICAgICAg\nICAgICAgIGl0ci5oYXNOZXh0KCk7ICkgewogICAgICAgICAgICAgICAgYnJv\na2VyLmFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoaXRyLm5leHQoKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2Fk\nIHRoZSBjb25maWd1cmVkIHBlcnNpc3RlbnQgY2xhc3NlcyBsaXN0LiBQZXJm\nb3JtZWQgYXV0b21hdGljYWxseQogICAgICogd2hlbmV2ZXIgYSBicm9rZXIg\naXMgY3JlYXRlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgbG9hZFBlcnNp\nc3RlbnRUeXBlcyhDbGFzc0xvYWRlciBlbnZMb2FkZXIpIHsKICAgICAgICAv\nLyBpZiB3ZSd2ZSBsb2FkZWQgdGhlIHBlcnNpc3RlbnQgdHlwZXMgYW5kIHRo\nZSBjbGFzcyBuYW1lIGxpc3QKICAgICAgICAvLyBpcyBlbXB0eSwgdGhlbiB3\nZSBjYW4gc2ltcGx5IHJldHVybi4gTm90ZSB0aGF0IHRoZXJlIGlzIGEKICAg\nICAgICAvLyBwb3RlbnRpYWwgdGhyZWFkaW5nIHNjZW5hcmlvIGluIHdoaWNo\nIF9wZXJzaXN0ZW50VHlwZXNMb2FkZWQgaXMKICAgICAgICAvLyBmYWxzZSB3\naGVuIHJlYWQsIGJ1dCB0aGUgd29yayB0byBwb3B1bGF0ZSBfcGNDbGFzc05h\nbWVzIGhhcwogICAgICAgIC8vIGFscmVhZHkgYmVlbiBkb25lLiBUaGlzIGlz\nIG9rOyBfcGNDbGFzc05hbWVzIGNhbiB0b2xlcmF0ZQogICAgICAgIC8vIGNv\nbmN1cnJlbnQgYWNjZXNzLCBzbyB0aGUgd29yc3QgY2FzZSBpcyB0aGF0IHRo\nZSBsaXN0IGlzCiAgICAgICAgLy8gcGVyc2lzdGVudCB0eXBlIGRhdGEgaXMg\ncHJvY2Vzc2VkIG11bHRpcGxlIHRpbWVzLCB3aGljaCB0aGlzCiAgICAgICAg\nLy8gYWxnb3JpdGhtIHRha2VzIGludG8gYWNjb3VudC4KICAgICAgICBpZiAo\nX3BlcnNpc3RlbnRUeXBlc0xvYWRlZCAmJiBfcGNDbGFzc05hbWVzLmlzRW1w\ndHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBjYWNoZSBw\nZXJzaXN0ZW50IHR5cGUgbmFtZXMgaWYgbm90IGFscmVhZHkKICAgICAgICBD\nbGFzc0xvYWRlciBsb2FkZXIgPSBfY29uZi5nZXRDbGFzc1Jlc29sdmVySW5z\ndGFuY2UoKS4KICAgICAgICAgICAgZ2V0Q2xhc3NMb2FkZXIoZ2V0Q2xhc3Mo\nKSwgZW52TG9hZGVyKTsKICAgICAgICBDb2xsZWN0aW9uPENsYXNzPD8+PiB0\nb1JlZGVmaW5lID0gbmV3IEFycmF5TGlzdDxDbGFzczw/Pj4oKTsKICAgICAg\nICBpZiAoIV9wZXJzaXN0ZW50VHlwZXNMb2FkZWQpIHsKICAgICAgICAgICAg\nQ29sbGVjdGlvbjxDbGFzczw/Pj4gY2xzcyA9IF9jb25mLmdldE1ldGFEYXRh\nUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgICAgICBsb2FkUGVy\nc2lzdGVudFR5cGVzKGZhbHNlLCBsb2FkZXIsIF9jb25mLmlzSW5pdGlhbGl6\nZUVhZ2VybHkoKSk7CiAgICAgICAgICAgIGlmIChjbHNzLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgICAgIF9wY0NsYXNzTmFtZXMgPSBDb2xsZWN0aW9ucy5l\nbXB0eUxpc3QoKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAg\nICBDb2xsZWN0aW9uPFN0cmluZz4gYyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5n\nPihjbHNzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9y\nPENsYXNzPD8+PiBpdHIgPSBjbHNzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0\nKCk7KSB7CiAgICAgICAgICAgICAgICAgICAgQ2xhc3M8Pz4gY2xzID0gaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgICAgICBjLmFkZChjbHMuZ2V0TmFt\nZSgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAobmVlZHNTdWIoY2xzKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgdG9SZWRlZmluZS5hZGQoY2xzKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGdldFBjQ2xhc3NM\nb2FkZXJzKCkuYWRkKGxvYWRlcik7CiAgICAgICAgICAgICAgICBfcGNDbGFz\nc05hbWVzID0gYzsKICAgICAgICAgICAgfQogICAgICAgICAgICBfcGVyc2lz\ndGVudFR5cGVzTG9hZGVkID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAvLyByZWxvYWQgd2l0aCB0aGlzIGxvYWRlcgogICAgICAgICAg\nICBpZiAoZ2V0UGNDbGFzc0xvYWRlcnMoKS5hZGQobG9hZGVyKSkgewogICAg\nICAgICAgICAgICAgZm9yIChTdHJpbmcgY2xzTmFtZSA6IF9wY0NsYXNzTmFt\nZXMpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgICAgICBDbGFzczw/PiBjbHMgPSBDbGFzcy5mb3JOYW1lKGNsc05h\nbWUsIHRydWUsIGxvYWRlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChuZWVkc1N1YihjbHMpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\ndG9SZWRlZmluZS5hZGQoY2xzKTsKICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAgICAgICAgICAgICBf\nY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUp\nLndhcm4obnVsbCwgdCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAv\nLyBnZXQgdGhlIE1hbmFnZWRDbGFzc1N1YmNsYXNzZXIgaW50byB0aGUgbG9v\ncAogICAgICAgIE1hbmFnZWRDbGFzc1N1YmNsYXNzZXIucHJlcGFyZVVuZW5o\nYW5jZWRDbGFzc2VzKF9jb25mLCB0b1JlZGVmaW5lLCBlbnZMb2FkZXIpOwog\nICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBuZWVkc1N1YihDbGFzczw/PiBj\nbHMpIHsKICAgICAgICByZXR1cm4gIWNscy5pc0ludGVyZmFjZSgpCiAgICAg\nICAgICAgICYmICFQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3MuaXNBc3NpZ25h\nYmxlRnJvbShjbHMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZExpZmVj\neWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lciwgQ2xhc3M8Pz5bXSBjbGFz\nc2VzKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKF9saWZlY3ljbGVM\naXN0ZW5lcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9saWZlY3ljbGVM\naXN0ZW5lcnMgPSBuZXcgSGFzaE1hcDxPYmplY3QsIENsYXNzPD8+W10+KDcp\nOwogICAgICAgICAgICBfbGlmZWN5Y2xlTGlzdGVuZXJzLnB1dChsaXN0ZW5l\nciwgY2xhc3Nlcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\ndW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nbW92ZUxpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAg\nICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRP\ncGVuKCk7CiAgICAgICAgICAgIGlmIChfbGlmZWN5Y2xlTGlzdGVuZXJzICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBfbGlmZWN5Y2xlTGlzdGVuZXJzLnJl\nbW92ZShsaXN0ZW5lcik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAg\nICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2Vy\ndE9wZW4oKTsKICAgICAgICAgICAgaWYgKF90cmFuc2FjdGlvbkxpc3RlbmVy\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3RyYW5zYWN0aW9uTGlzdGVu\nZXJzID0gbmV3IExpbmtlZExpc3Q8T2JqZWN0PigpOwogICAgICAgICAgICBf\ndHJhbnNhY3Rpb25MaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlVHJhbnNhY3Rpb25MaXN0ZW5l\ncihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBp\nZiAoX3RyYW5zYWN0aW9uTGlzdGVuZXJzICE9IG51bGwpCiAgICAgICAgICAg\nICAgICBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMucmVtb3ZlKGxpc3RlbmVyKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYg\ndGhpcyBicm9rZXIgZmFjdG9yeSBpcyBjbG9zZWQuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGlzQ2xvc2VkKCkgewogICAgICAgIHJldHVybiBfY2xv\nc2VkOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAg\nIGxvY2soKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Bl\nbigpOwogICAgICAgICAgICBhc3NlcnROb0FjdGl2ZVRyYW5zYWN0aW9uKCk7\nCgogICAgICAgICAgICAvLyByZW1vdmUgZnJvbSBmYWN0b3J5IHBvb2wKICAg\nICAgICAgICAgc3luY2hyb25pemVkIChfcG9vbCkgewogICAgICAgICAgICAg\nICAgaWYgKF9wb29sLmdldChfcG9vbEtleSkgPT0gdGhpcykKICAgICAgICAg\nICAgICAgICAgICBfcG9vbC5yZW1vdmUoX3Bvb2xLZXkpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICAvLyBjbG9zZSBhbGwgYnJva2VycwogICAgICAg\nICAgICBmb3IgKEJyb2tlciBicm9rZXIgOiBfYnJva2VycykgewogICAgICAg\nICAgICAgICAgLy8gQ2hlY2sgZm9yIG51bGwgYmVjYXVzZSBfYnJva2VycyBt\nYXkgY29udGFpbiB3ZWFrIHJlZmVyZW5jZXMKICAgICAgICAgICAgICAgIGlm\nICgoYnJva2VyICE9IG51bGwpICYmICghYnJva2VyLmlzQ2xvc2VkKCkpKQog\nICAgICAgICAgICAgICAgICAgIGJyb2tlci5jbG9zZSgpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBpZihfY29uZi5tZXRhRGF0YVJlcG9zaXRvcnlB\ndmFpbGFibGUoKSkgewogICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG1ldGFk\nYXRhIHJlcG9zaXRvcnkgZnJvbSBsaXN0ZW5lciBsaXN0CiAgICAgICAgICAg\nICAgICBQQ1JlZ2lzdHJ5LnJlbW92ZVJlZ2lzdGVyQ2xhc3NMaXN0ZW5lcgog\nICAgICAgICAgICAgICAgICAgIChfY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRv\ncnlJbnN0YW5jZSgpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2Nv\nbmYuY2xvc2UoKTsKICAgICAgICAgICAgX2Nsb3NlZCA9IHRydWU7CiAgICAg\nICAgICAgIExvZyBsb2cgPSBfY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3Vy\nYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAgICAgICBpZiAobG9nLmlzVHJh\nY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBfY2xvc2VkRXhjZXB0aW9u\nID0gbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFN1YmNsYXNzZXMgc2hvdWxkIG92ZXJyaWRlIHRo\naXMgbWV0aG9kIHRvIGFkZCBhIDxjb2RlPlBsYXRmb3JtPC9jb2RlPgogICAg\nICogcHJvcGVydHkgbGlzdGluZyB0aGUgcnVudGltZSBwbGF0Zm9ybSwgc3Vj\naCBhczoKICAgICAqIDxjb2RlPk9wZW5KUEEgSkRCQyBFZGl0aW9uOiBPcmFj\nbGUgRGF0YWJhc2U8L2NvZGU+CiAgICAgKi8KICAgIHB1YmxpYyBNYXA8U3Ry\naW5nLE9iamVjdD4gZ2V0UHJvcGVydGllcygpIHsKICAgICAgICAvLyByZXF1\naXJlZCBwcm9wcyBhcmUgVmVuZG9yTmFtZSBhbmQgVmVyc2lvbk51bWJlcgog\nICAgICAgIE1hcDxTdHJpbmcsT2JqZWN0PiBwcm9wcyA9IF9jb25mLnRvUHJv\ncGVydGllcyh0cnVlKTsKICAgICAgICBwcm9wcy5wdXQoIlZlbmRvck5hbWUi\nLCBPcGVuSlBBVmVyc2lvbi5WRU5ET1JfTkFNRSk7CiAgICAgICAgcHJvcHMu\ncHV0KCJWZXJzaW9uTnVtYmVyIiwgT3BlbkpQQVZlcnNpb24uVkVSU0lPTl9O\nVU1CRVIpOwogICAgICAgIHByb3BzLnB1dCgiVmVyc2lvbklkIiwgT3BlbkpQ\nQVZlcnNpb24uVkVSU0lPTl9JRCk7CiAgICAgICAgcmV0dXJuIHByb3BzOwog\nICAgfQoKICAgIHB1YmxpYyBTZXQ8U3RyaW5nPiBnZXRTdXBwb3J0ZWRQcm9w\nZXJ0aWVzKCkgewogICAgICAgIHJldHVybiBfY29uZi5nZXRQcm9wZXJ0eUtl\neXMoKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFVzZXJPYmplY3Qo\nT2JqZWN0IGtleSkgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIHJldHVybiAo\nX3VzZXJPYmplY3RzID09IG51bGwpID8gbnVsbCA6IF91c2VyT2JqZWN0cy5n\nZXQoa2V5KTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxv\nY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIE9iamVjdCBwdXRV\nc2VyT2JqZWN0KE9iamVjdCBrZXksIE9iamVjdCB2YWwpIHsKICAgICAgICBs\nb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Blbigp\nOwogICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAgICAgICAgICAgICAg\nICByZXR1cm4gKF91c2VyT2JqZWN0cyA9PSBudWxsKSA/IG51bGwgOiBfdXNl\nck9iamVjdHMucmVtb3ZlKGtleSk7CgogICAgICAgICAgICBpZiAoX3VzZXJP\nYmplY3RzID09IG51bGwpCiAgICAgICAgICAgICAgICBfdXNlck9iamVjdHMg\nPSBuZXcgSGFzaE1hcDxPYmplY3QsT2JqZWN0PigpOwogICAgICAgICAgICBy\nZXR1cm4gX3VzZXJPYmplY3RzLnB1dChrZXksIHZhbCk7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGxvY2soKSB7CiAgICAgICAgX2xvY2subG9j\naygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHVubG9jaygpIHsKICAgICAg\nICBfbG9jay51bmxvY2soKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcGxh\nY2VzIHRoZSBmYWN0b3J5IHdpdGggdGhpcyBKVk1zIHBvb2xlZCB2ZXJzaW9u\nIGlmIGl0IGV4aXN0cy4gQWxzbwogICAgICogZnJlZXplcyB0aGUgZmFjdG9y\neS4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCByZWFkUmVzb2x2ZSgp\nCiAgICAgICAgdGhyb3dzIE9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAgICAg\nICAgQWJzdHJhY3RCcm9rZXJGYWN0b3J5IGZhY3RvcnkgPSBnZXRQb29sZWRG\nYWN0b3J5Rm9yS2V5KF9wb29sS2V5KTsKICAgICAgICBpZiAoZmFjdG9yeSAh\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFjdG9yeTsKCiAgICAgICAg\nLy8gcmVzZXQgdGhlc2UgdHJhbnNpZW50IGZpZWxkcyB0byBlbXB0eSB2YWx1\nZXMKICAgICAgICBfdHJhbnNhY3Rpb25hbCA9IG5ldyBDb25jdXJyZW50SGFz\naE1hcDxPYmplY3QsQ29sbGVjdGlvbjxCcm9rZXI+PigpOwogICAgICAgIF9i\ncm9rZXJzID0gbmV3QnJva2VyU2V0KCk7CgogICAgICAgIG1ha2VSZWFkT25s\neSgpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHByaXZhdGUg\nU2V0PEJyb2tlcj4gbmV3QnJva2VyU2V0KCkgewogICAgICAgIEJyb2tlclZh\nbHVlIGJ2OwogICAgICAgIGlmIChfY29uZiBpbnN0YW5jZW9mIE9wZW5KUEFD\nb25maWd1cmF0aW9uSW1wbCkKICAgICAgICAgICAgYnYgPSAoKE9wZW5KUEFD\nb25maWd1cmF0aW9uSW1wbCkgX2NvbmYpLmJyb2tlclBsdWdpbjsKICAgICAg\nICBlbHNlCiAgICAgICAgICAgIGJ2ID0gKEJyb2tlclZhbHVlKSBfY29uZi5n\nZXRWYWx1ZShCcm9rZXJWYWx1ZS5LRVkpOwoKICAgICAgICBpZiAoRmluYWxp\nemluZ0Jyb2tlckltcGwuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSgKICAgICAg\nICAgICAgYnYuZ2V0VGVtcGxhdGVCcm9rZXJUeXBlKF9jb25mKSkpIHsKICAg\nICAgICAgICAgcmV0dXJuIE1hcEJhY2tlZFNldC5kZWNvcmF0ZShuZXcgQ29u\nY3VycmVudEhhc2hNYXAoKSwgbmV3IE9iamVjdCgpIHsgfSk7CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBDb25jdXJyZW50UmVm\nZXJlbmNlSGFzaFNldDxCcm9rZXI+KENvbmN1cnJlbnRSZWZlcmVuY2VIYXNo\nU2V0LldFQUspOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8KICAgIC8vIE1ldGhvZHMgZm9yIE92ZXJyaWRlCiAgICAv\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFJldHVy\nbiBhIG5ldyBTdG9yZU1hbmFnZXIgZm9yIHRoaXMgcnVudGltZS4gTm90ZSB0\naGF0IHRoZSBpbnN0YW5jZQogICAgICogcmV0dXJuZWQgaGVyZSBtYXkgYmUg\nd3JhcHBlZCBiZWZvcmUgYmVpbmcgcGFzc2VkIHRvIHRoZQogICAgICoge0Bs\naW5rICNuZXdCcm9rZXJ9IG1ldGhvZC4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGFic3RyYWN0IFN0b3JlTWFuYWdlciBuZXdTdG9yZU1hbmFnZXIoKTsKCiAg\nICAvKioKICAgICAqIEZpbmQgYSBwb29sZWQgYnJva2VyLCBvciByZXR1cm4g\nbnVsbCBpZiBub25lLiBJZiB1c2luZwogICAgICogbWFuYWdlZCB0cmFuc2Fj\ndGlvbnMsIGxvb2tzIGZvciBhIHRyYW5zYWN0aW9uYWwgYnJva2VyOwogICAg\nICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbCBieSBkZWZhdWx0LiBUaGlzIG1l\ndGhvZCB3aWxsIGJlIGNhbGxlZCBiZWZvcmUKICAgICAqIHtAbGluayAjbmV3\nU3RvcmVNYW5hZ2VyfSBzbyB0aGF0IGZhY3Rvcnkgc3ViY2xhc3NlcyBpbXBs\nZW1lbnRpbmcKICAgICAqIHBvb2xpbmcgY2FuIHJldHVybiBhIG1hdGNoaW5n\nIG1hbmFnZXIgYmVmb3JlIGEgbmV3IHtAbGluayBTdG9yZU1hbmFnZXJ9CiAg\nICAgKiBpcyBjcmVhdGVkLgogICAgICovCiAgICBwcm90ZWN0ZWQgQnJva2Vy\nIGZpbmRCcm9rZXIoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzLCBib29sZWFu\nIG1hbmFnZWQpIHsKICAgICAgICBpZiAobWFuYWdlZCkKICAgICAgICAgICAg\ncmV0dXJuIGZpbmRUcmFuc2FjdGlvbmFsQnJva2VyKHVzZXIsIHBhc3MpOwog\nICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGEgYnJva2VyIGNvbmZpZ3VyZWQgd2l0aCB0aGUgcHJvcGVyIHNldHRp\nbmdzLgogICAgICogQnkgZGVmYXVsdCwgdGhpcyBtZXRob2QgY29uc3RydWN0\ncyBhIG5ldwogICAgICogQnJva2VySW1wbCBvZiB0aGUgY2xhc3Mgc2V0IGZv\nciB0aGlzIGZhY3RvcnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBCcm9rZXJJ\nbXBsIG5ld0Jyb2tlckltcGwoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzKSB7\nCiAgICAgICAgQnJva2VySW1wbCBicm9rZXIgPSBfY29uZi5uZXdCcm9rZXJJ\nbnN0YW5jZSh1c2VyLCBwYXNzKTsKICAgICAgICBpZiAoYnJva2VyID09IG51\nbGwpCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby1icm9rZXItY2xhc3MiLAogICAgICAgICAgICAgICAgX2NvbmYu\nZ2V0QnJva2VySW1wbCgpKSk7CgogICAgICAgIHJldHVybiBicm9rZXI7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0cmFuc2llbnQgc3RhdGUgdXNl\nZCBieSB0aGlzIGZhY3RvcnkgYmFzZWQgb24gdGhlCiAgICAgKiBjdXJyZW50\nIGNvbmZpZ3VyYXRpb24sIHdoaWNoIHdpbGwgc3Vic2VxdWVudGx5IGJlIGxv\nY2tlZCBkb3duLiBUaGlzCiAgICAgKiBtZXRob2Qgd2lsbCBiZSBjYWxsZWQg\nYmVmb3JlIHRoZSBmaXJzdCBicm9rZXIgaXMgcmVxdWVzdGVkLAogICAgICog\nYW5kIHdpbGwgYmUgcmUtY2FsbGVkIGVhY2ggdGltZSB0aGUgZmFjdG9yeSBp\ncyBkZXNlcmlhbGl6ZWQgaW50byBhIEpWTQogICAgICogdGhhdCBoYXMgbm8g\nY29uZmlndXJhdGlvbiBmb3IgdGhpcyBkYXRhIHN0b3JlLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBzZXR1cCgpIHsKICAgIH0KCiAgICAvLy8vLy8v\nLy8vLy8vCiAgICAvLyBVdGlsaXRpZXMKICAgIC8vLy8vLy8vLy8vLy8KCiAg\nICAvKioKICAgICAqIEZpbmQgYSBtYW5hZ2VkIHJ1bnRpbWUgYnJva2VyIGFz\nc29jaWF0ZWQgd2l0aCB0aGUKICAgICAqIGN1cnJlbnQgdHJhbnNhY3Rpb24s\nIG9yIHJldHVybnMgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwcm90ZWN0\nZWQgQnJva2VyIGZpbmRUcmFuc2FjdGlvbmFsQnJva2VyKFN0cmluZyB1c2Vy\nLCBTdHJpbmcgcGFzcykgewogICAgICAgIFRyYW5zYWN0aW9uIHRyYW5zOwog\nICAgICAgIE1hbmFnZWRSdW50aW1lIG1yID0gX2NvbmYuZ2V0TWFuYWdlZFJ1\nbnRpbWVJbnN0YW5jZSgpOwogICAgICAgIE9iamVjdCB0eEtleTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB0cmFucyA9IG1yLmdldFRyYW5zYWN0aW9u\nTWFuYWdlcigpLgogICAgICAgICAgICAgICAgZ2V0VHJhbnNhY3Rpb24oKTsK\nICAgICAgICAgICAgdHhLZXkgPSBtci5nZXRUcmFuc2FjdGlvbktleSgpOwoK\nICAgICAgICAgICAgaWYgKHRyYW5zID09IG51bGwKICAgICAgICAgICAgICAg\nIHx8IHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNfTk9fVFJB\nTlNBQ1RJT04KICAgICAgICAgICAgICAgIHx8IHRyYW5zLmdldFN0YXR1cygp\nID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikKICAgICAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24g\na2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxF\neGNlcHRpb24oZSk7CiAgICAgICAgfQoKICAgICAgICBDb2xsZWN0aW9uPEJy\nb2tlcj4gYnJva2VycyA9IF90cmFuc2FjdGlvbmFsLmdldCh0eEtleSk7CiAg\nICAgICAgaWYgKGJyb2tlcnMgIT0gbnVsbCkgewogICAgICAgICAgICAvLyB3\nZSBkb24ndCBuZWVkIHRvIHN5bmNocm9uaXplIG9uIGJyb2tlcnMgc2luY2Ug\nb25lIEpUQSB0cmFuc2FjdGlvbgogICAgICAgICAgICAvLyBjYW4gbmV2ZXIg\nYmUgYWN0aXZlIG9uIG11bHRpcGxlIGNvbmN1cnJlbnQgdGhyZWFkcy4KICAg\nICAgICAgICAgZm9yIChCcm9rZXIgYnJva2VyIDogYnJva2VycykgewogICAg\nICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmVxdWFscyhicm9rZXIuZ2V0\nQ29ubmVjdGlvblVzZXJOYW1lKCksIHVzZXIpIAogICAgICAgICAgICAgICAg\nICYmIFN0cmluZ1V0aWxzLmVxdWFscyhicm9rZXIuZ2V0Q29ubmVjdGlvblBh\nc3N3b3JkKCksIHBhc3MpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBi\ncm9rZXI7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25maWd1cmVzIHRoZSBn\naXZlbiBicm9rZXIgd2l0aCB0aGUgY3VycmVudCBmYWN0b3J5IG9wdGlvbiBz\nZXR0aW5ncy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgY29uZmlndXJl\nQnJva2VyKEJyb2tlckltcGwgYnJva2VyKSB7CiAgICAgICAgYnJva2VyLnNl\ndE9wdGltaXN0aWMoX2NvbmYuZ2V0T3B0aW1pc3RpYygpKTsKICAgICAgICBi\ncm9rZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoX2NvbmYuZ2V0Tm9udHJh\nbnNhY3Rpb25hbFJlYWQoKSk7CiAgICAgICAgYnJva2VyLnNldE5vbnRyYW5z\nYWN0aW9uYWxXcml0ZShfY29uZi5nZXROb250cmFuc2FjdGlvbmFsV3JpdGUo\nKSk7CiAgICAgICAgYnJva2VyLnNldFJldGFpblN0YXRlKF9jb25mLmdldFJl\ndGFpblN0YXRlKCkpOwogICAgICAgIGJyb2tlci5zZXRSZXN0b3JlU3RhdGUo\nX2NvbmYuZ2V0UmVzdG9yZVN0YXRlQ29uc3RhbnQoKSk7CiAgICAgICAgYnJv\na2VyLnNldEF1dG9DbGVhcihfY29uZi5nZXRBdXRvQ2xlYXJDb25zdGFudCgp\nKTsKICAgICAgICBicm9rZXIuc2V0SWdub3JlQ2hhbmdlcyhfY29uZi5nZXRJ\nZ25vcmVDaGFuZ2VzKCkpOwogICAgICAgIGJyb2tlci5zZXRNdWx0aXRocmVh\nZGVkKF9jb25mLmdldE11bHRpdGhyZWFkZWQoKSk7CiAgICAgICAgYnJva2Vy\nLnNldEF1dG9EZXRhY2goX2NvbmYuZ2V0QXV0b0RldGFjaENvbnN0YW50KCkp\nOwogICAgICAgIGJyb2tlci5zZXREZXRhY2hTdGF0ZShfY29uZi5nZXREZXRh\nY2hTdGF0ZUluc3RhbmNlKCkuZ2V0RGV0YWNoU3RhdGUoKSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBGcmVlemVzIHRoZSBjb25maWd1cmF0aW9uIG9mIHRo\naXMgZmFjdG9yeS4KICAgICAqLwogICAgcHVibGljIHZvaWQgbWFrZVJlYWRP\nbmx5KCkgewogICAgICAgIGlmIChfcmVhZE9ubHkpCiAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIC8vIGNoZWNrIGFnYWluCiAgICAgICAgICAgIGlmIChfcmVhZE9ubHkp\nCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIF9yZWFkT25s\neSA9IHRydWU7CgogICAgICAgICAgICBMb2cgbG9nID0gX2NvbmYuZ2V0TG9n\nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAgICAg\nICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgICAgICBs\nb2cuaW5mbyhnZXRGYWN0b3J5SW5pdGlhbGl6YXRpb25CYW5uZXIoKSk7CiAg\nICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAg\nICAgICAgICAgTWFwPFN0cmluZyxPYmplY3Q+IHByb3BzID0gX2NvbmYudG9Q\ncm9wZXJ0aWVzKHRydWUpOwogICAgICAgICAgICAgICAgU3RyaW5nIGxpbmVT\nZXAgPSBKMkRvUHJpdkhlbHBlci5nZXRMaW5lU2VwYXJhdG9yKCk7CiAgICAg\nICAgICAgICAgICBTdHJpbmdCdWlsZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWls\nZGVyKCk7CiAgICAgICAgICAgICAgICBNYXAuRW50cnk8Pyw/PiBlbnRyeTsK\nICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8TWFwLkVudHJ5PFN0cmlu\nZyxPYmplY3Q+PiBpdHIgPSBwcm9wcy5lbnRyeVNldCgpLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAgZW50cnkg\nPSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nZW50cnkuZ2V0S2V5KCkpLmFwcGVuZCgiOiAiKS5hcHBlbmQoZW50cnkuZ2V0\nVmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ci5oYXNOZXh0\nKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQobGluZVNl\ncCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsb2cudHJh\nY2UoX2xvYy5nZXQoImZhY3RvcnktcHJvcGVydGllcyIsIGJ1Zi50b1N0cmlu\nZygpKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHNldHVwIHRy\nYW5zaWVudCBzdGF0ZQogICAgICAgICAgICBzZXR1cCgpOwoKICAgICAgICAg\nICAgLy8gcmVnaXN0ZXIgdGhlIG1ldGRhdGEgcmVwb3NpdG9yeSB0byBhdXRv\nLWxvYWQgcGVyc2lzdGVudCB0eXBlcwogICAgICAgICAgICAvLyBhbmQgbWFr\nZSBzdXJlIHR5cGVzIGFyZSBlbmhhbmNlZAogICAgICAgICAgICBNZXRhRGF0\nYVJlcG9zaXRvcnkgcmVwb3MgPSBfY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRv\ncnlJbnN0YW5jZSgpOwogICAgICAgICAgICByZXBvcy5zZXRWYWxpZGF0ZShN\nZXRhRGF0YVJlcG9zaXRvcnkuVkFMSURBVEVfUlVOVElNRSwgdHJ1ZSk7CiAg\nICAgICAgICAgIHJlcG9zLnNldFJlc29sdmUoTWV0YURhdGFNb2Rlcy5NT0RF\nX01BUFBJTkdfSU5JVCwgdHJ1ZSk7CiAgICAgICAgICAgIFBDUmVnaXN0cnku\nYWRkUmVnaXN0ZXJDbGFzc0xpc3RlbmVyKHJlcG9zKTsKCiAgICAgICAgICAg\nIC8vIGZyZWV6ZSB1bmRlcmx5aW5nIGNvbmZpZ3VyYXRpb24gYW5kIGVhZ2Vy\nbHkgaW5pdGlhbGl6ZSB0bwogICAgICAgICAgICAvLyBhdm9pZCBzeW5jaHJv\nbml6YXRpb24KICAgICAgICAgICAgX2NvbmYuc2V0UmVhZE9ubHkoQ29uZmln\ndXJhdGlvbi5JTklUX1NUQVRFX0ZSRUVaSU5HKTsKICAgICAgICAgICAgX2Nv\nbmYuaW5zdGFudGlhdGVBbGwoKTsKICAgICAgICAgICAgaWYgKF9jb25mLmlz\nSW5pdGlhbGl6ZUVhZ2VybHkoKSkKICAgICAgICAgICAgCV9jb25mLnNldFJl\nYWRPbmx5KENvbmZpZ3VyYXRpb24uSU5JVF9TVEFURV9GUk9aRU4pOwogICAg\nICAgICAgICAvLyBmaXJlIGFuIGV2ZW50IGZvciBhbGwgdGhlIGJyb2tlciBm\nYWN0b3J5IGxpc3RlbmVycwogICAgICAgICAgICAvLyByZWdpc3RlcmVkIG9u\nIHRoZSBjb25maWd1cmF0aW9uLgogICAgICAgICAgICBfY29uZi5nZXRCcm9r\nZXJGYWN0b3J5RXZlbnRNYW5hZ2VyKCkuZmlyZUV2ZW50KAogICAgICAgICAg\nICAgICAgbmV3IEJyb2tlckZhY3RvcnlFdmVudCh0aGlzLAogICAgICAgICAg\nICAgICAgICAgIEJyb2tlckZhY3RvcnlFdmVudC5CUk9LRVJfRkFDVE9SWV9D\nUkVBVEVEKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5s\nb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIGFuIG9iamVjdCB0byBiZSB3cml0dGVuIHRvIHRoZSBsb2cgd2hlbiB0aGlz\nIGJyb2tlciBmYWN0b3J5CiAgICAgKiBpbml0aWFsaXplcy4gVGhpcyBoYXBw\nZW5zIGFmdGVyIHRoZSBjb25maWd1cmF0aW9uIGlzIGZ1bGx5IGxvYWRlZC4K\nICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRGYWN0b3J5SW5pdGlh\nbGl6YXRpb25CYW5uZXIoKSB7CiAgICAgICAgcmV0dXJuIF9sb2MuZ2V0KCJm\nYWN0b3J5LWluaXQiLCBPcGVuSlBBVmVyc2lvbi5WRVJTSU9OX05VTUJFUik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBhbiBleGNlcHRpb24gaWYg\ndGhlIGZhY3RvcnkgaXMgY2xvc2VkLiAgVGhlIGV4YWN0IG1lc3NhZ2UgYW5k\nCiAgICAgKiBjb250ZW50IG9mIHRoZSBleGNlcHRpb24gdmFyaWVzIHdoZXRo\nZXIgVFJBQ0UgaXMgZW5hYmxlZCBvciBub3QuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIGFzc2VydE9wZW4oKSB7CiAgICAgICAgaWYgKF9jbG9zZWQpIHsK\nICAgICAgICAgICAgaWYgKF9jbG9zZWRFeGNlcHRpb24gPT0gbnVsbCkgIC8v\nIFRSQUNFIG5vdCBlbmFibGVkCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MKICAgICAgICAgICAgICAgICAg\nICAgICAgLmdldCgiY2xvc2VkLWZhY3Rvcnktbm90cmFjZSIpKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRT\ndGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiY2xvc2VkLWZhY3RvcnkiKSkKICAg\nICAgICAgICAgICAgICAgICAgICAgLnNldENhdXNlKF9jbG9zZWRFeGNlcHRp\nb24pOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gQnJva2VyIHV0aWxpdGllcwogICAgLy8vLy8vLy8vLy8vLy8v\nLy8vLy8KCiAgICAvKioKICAgICAqIFRocm93cyBhIHtAbGluayBVc2VyRXhj\nZXB0aW9ufSBpZiBhIHRyYW5zYWN0aW9uIGlzIGFjdGl2ZS4gVGhlIHRocm93\nbgogICAgICogZXhjZXB0aW9uIHdpbGwgY29udGFpbiBhbGwgdGhlIEJyb2tl\ncnMgd2l0aCBhY3RpdmUgdHJhbnNhY3Rpb25zIGFzCiAgICAgKiBmYWlsZWQg\nb2JqZWN0cyBpbiB0aGUgbmVzdGVkIGV4Y2VwdGlvbnMuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBhc3NlcnROb0FjdGl2ZVRyYW5zYWN0aW9uKCkgewog\nICAgICAgIENvbGxlY3Rpb248VGhyb3dhYmxlPiBleGNzOwogICAgICAgIGlm\nIChfdHJhbnNhY3Rpb25hbC5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVy\nbjsKCiAgICAgICAgZXhjcyA9IG5ldyBBcnJheUxpc3Q8VGhyb3dhYmxlPihf\ndHJhbnNhY3Rpb25hbC5zaXplKCkpOwogICAgICAgIGZvciAoQ29sbGVjdGlv\nbjxCcm9rZXI+IGJyb2tlcnMgOiBfdHJhbnNhY3Rpb25hbC52YWx1ZXMoKSkg\newogICAgICAgICAgICBmb3IgKEJyb2tlciBicm9rZXIgOiBicm9rZXJzKSB7\nCiAgICAgICAgICAgICAgICBleGNzLmFkZChuZXcgSW52YWxpZFN0YXRlRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJhY3RpdmUiKSkuc2V0RmFpbGVkT2JqZWN0KGJy\nb2tlcikpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAo\nIWV4Y3MuaXNFbXB0eSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxp\nZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuZXN0ZWQtZXhjZXBzIikpLgog\nICAgICAgICAgICAgICAgc2V0TmVzdGVkVGhyb3dhYmxlcygoVGhyb3dhYmxl\nW10pIGV4Y3MudG9BcnJheShuZXcgVGhyb3dhYmxlW2V4Y3Muc2l6ZSgpXSkp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25pemUgdGhlIGdpdmVu\nIGJyb2tlciB3aXRoIGEgbWFuYWdlZCB0cmFuc2FjdGlvbiwKICAgICAqIG9w\ndGlvbmFsbHkgc3RhcnRpbmcgb25lIGlmIG5vbmUgaXMgaW4gcHJvZ3Jlc3Mu\nCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHN5bmNoZWQgd2l0aCB0\ncmFuc2FjdGlvbiwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGJvb2xl\nYW4gc3luY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb24oQnJva2VySW1wbCBicm9r\nZXIsIGJvb2xlYW4gYmVnaW4pIHsKICAgICAgICBUcmFuc2FjdGlvbiB0cmFu\nczsKICAgICAgICB0cnkgewogICAgICAgICAgICBNYW5hZ2VkUnVudGltZSBt\nciA9IGJyb2tlci5nZXRNYW5hZ2VkUnVudGltZSgpOwogICAgICAgICAgICBU\ncmFuc2FjdGlvbk1hbmFnZXIgdG0gPSBtci5nZXRUcmFuc2FjdGlvbk1hbmFn\nZXIoKTsKICAgICAgICAgICAgdHJhbnMgPSB0bS5nZXRUcmFuc2FjdGlvbigp\nOwogICAgICAgICAgICBpZiAodHJhbnMgIT0gbnVsbAogICAgICAgICAgICAg\nICAgJiYgKHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNfTk9f\nVFJBTlNBQ1RJT04KICAgICAgICAgICAgICAgIHx8IHRyYW5zLmdldFN0YXR1\ncygpID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikpCiAgICAgICAgICAgICAg\nICB0cmFucyA9IG51bGw7CgogICAgICAgICAgICBpZiAodHJhbnMgPT0gbnVs\nbCAmJiBiZWdpbikgewogICAgICAgICAgICAgICAgdG0uYmVnaW4oKTsKICAg\nICAgICAgICAgICAgIHRyYW5zID0gdG0uZ2V0VHJhbnNhY3Rpb24oKTsKICAg\nICAgICAgICAgfSBlbHNlIGlmICh0cmFucyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgLy8gc3luY2ggYnJv\na2VyIGFuZCB0cmFucwogICAgICAgICAgICB0cmFucy5yZWdpc3RlclN5bmNo\ncm9uaXphdGlvbihicm9rZXIpOwoKICAgICAgICAgICAgLy8gd2UgZG9uJ3Qg\nbmVlZCB0byBzeW5jaHJvbml6ZSBvbiBicm9rZXJzIG9yIGd1YXJkIGFnYWlu\nc3QgbXVsdGlwbGUKICAgICAgICAgICAgLy8gdGhyZWFkcyB1c2luZyB0aGUg\nc2FtZSB0cmFucyBzaW5jZSBvbmUgSlRBIHRyYW5zYWN0aW9uIGNhbiBuZXZl\ncgogICAgICAgICAgICAvLyBiZSBhY3RpdmUgb24gbXVsdGlwbGUgY29uY3Vy\ncmVudCB0aHJlYWRzLgogICAgICAgICAgICBPYmplY3QgdHhLZXkgPSBtci5n\nZXRUcmFuc2FjdGlvbktleSgpOwogICAgICAgICAgICBDb2xsZWN0aW9uPEJy\nb2tlcj4gYnJva2VycyA9IF90cmFuc2FjdGlvbmFsLmdldCh0eEtleSk7CiAg\nICAgICAgICAgIAogICAgICAgICAgICBpZiAoYnJva2VycyA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBicm9rZXJzID0gbmV3IEFycmF5TGlzdDxCcm9r\nZXI+KDIpOwogICAgICAgICAgICAgICAgX3RyYW5zYWN0aW9uYWwucHV0KHR4\nS2V5LCBicm9rZXJzKTsKICAgICAgICAgICAgICAgIHRyYW5zLnJlZ2lzdGVy\nU3luY2hyb25pemF0aW9uKG5ldyBSZW1vdmVUcmFuc2FjdGlvblN5bmModHhL\nZXkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicm9rZXJzLmFkZChi\ncm9rZXIpOwogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAg\nICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihl\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEg\nc2V0IG9mIGFsbCB0aGUgb3BlbiBicm9rZXJzIGFzc29jaWF0ZWQgd2l0aCB0\naGlzIGZhY3RvcnkuIFRoZQogICAgICogcmV0dXJuZWQgc2V0IGlzIHVubW9k\naWZpYWJsZSwgYW5kIG1heSBjb250YWluIG51bGwgcmVmZXJlbmNlcy4KICAg\nICAqLwogICAgcHVibGljIENvbGxlY3Rpb248QnJva2VyPiBnZXRPcGVuQnJv\na2VycygpIHsKICAgICAgICByZXR1cm4gQ29sbGVjdGlvbnMudW5tb2RpZmlh\nYmxlQ29sbGVjdGlvbihfYnJva2Vycyk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZWxlYXNlIDxjb2RlPmJyb2tlcjwvY29kZT4gZnJvbSBhbnkgaW50ZXJu\nYWwgZGF0YSBzdHJ1Y3R1cmVzLiBUaGlzCiAgICAgKiBpcyBpbnZva2VkIGJ5\nIDxjb2RlPmJyb2tlcjwvY29kZT4gYWZ0ZXIgdGhlIGJyb2tlciBpcyBmdWxs\neSBjbG9zZWQuCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIHJlbGVhc2VCcm9rZXIoQnJva2VySW1wbCBi\ncm9rZXIpIHsKICAgICAgICBfYnJva2Vycy5yZW1vdmUoYnJva2VyKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEByZXR1cm4gYSBrZXkgdGhhdCBjYW4gYmUg\ndXNlZCB0byBvYnRhaW4gdGhpcyBicm9rZXIgZmFjdG9yeSBmcm9tIHRoZQog\nICAgICogcG9vbCBhdCBhIGxhdGVyIHRpbWUuCiAgICAgKgogICAgICogQHNp\nbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0UG9vbEtl\neSgpIHsKICAgICAgICByZXR1cm4gX3Bvb2xLZXk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTZXQgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCB0byBvYnRhaW4g\ndGhpcyBicm9rZXIgZmFjdG9yeSBmcm9tIHRoZQogICAgICogcG9vbCBhdCBh\nIGxhdGVyIHRpbWUuCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAg\nKi8KICAgIHZvaWQgc2V0UG9vbEtleShPYmplY3Qga2V5KSB7CiAgICAgICAg\nX3Bvb2xLZXkgPSBrZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaW1wbGUg\nc3luY2hyb25pemF0aW9uIGxpc3RlbmVyIHRvIHJlbW92ZSBjb21wbGV0ZWQg\ndHJhbnNhY3Rpb25zCiAgICAgKiBmcm9tIG91ciBjYWNoZS4KICAgICAqLwog\nICAgcHJpdmF0ZSBjbGFzcyBSZW1vdmVUcmFuc2FjdGlvblN5bmMKICAgICAg\nICBpbXBsZW1lbnRzIFN5bmNocm9uaXphdGlvbiB7CgogICAgICAgIHByaXZh\ndGUgZmluYWwgT2JqZWN0IF90cmFuczsKCiAgICAgICAgcHVibGljIFJlbW92\nZVRyYW5zYWN0aW9uU3luYyhPYmplY3QgdHJhbnMpIHsKICAgICAgICAgICAg\nX3RyYW5zID0gdHJhbnM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9p\nZCBiZWZvcmVDb21wbGV0aW9uKCkgewogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgYWZ0ZXJDb21wbGV0aW9uKGludCBzdGF0dXMpIHsKICAgICAg\nICAgICAgX3RyYW5zYWN0aW9uYWwucmVtb3ZlIChfdHJhbnMpOwoJCX0KCX0K\nICAgIAogICAgLyoqCiAgICAgKiBNZXRob2QgaW5zdXJlcyB0aGF0IGRlc2Vy\naWFsaXplZCBFTUYgaGFzIHRoaXMgcmVmZXJlbmNlIHJlLWluc3RhbnRpYXRl\nZAogICAgICovCiAgICBwcml2YXRlIENvbGxlY3Rpb248Q2xhc3NMb2FkZXI+\nIGdldFBjQ2xhc3NMb2FkZXJzKCkgewogICAgICAgaWYgKF9wY0NsYXNzTG9h\nZGVycyA9PSBudWxsKQogICAgICAgICBfcGNDbGFzc0xvYWRlcnMgPSBuZXcg\nQ29uY3VycmVudFJlZmVyZW5jZUhhc2hTZXQ8Q2xhc3NMb2FkZXI+KENvbmN1\ncnJlbnRSZWZlcmVuY2VIYXNoU2V0LldFQUspOwogICAgICAgICAgCiAgICAg\nICByZXR1cm4gX3BjQ2xhc3NMb2FkZXJzOwogICAgfQoKICAgIC8qKgogICAg\nICogPFA+CiAgICAgKiBDcmVhdGUgYSBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2Vy\nIGZvciB1c2Ugd2l0aCBhIEJyb2tlciBjcmVhdGVkIGJ5IHRoaXMgZmFjdG9y\neS4KICAgICAqIElmIGEgRGF0YUNhY2hlIGhhcyBiZWVuIGVuYWJsZWQgYSBE\nYXRhQ2FjaGVTdG9yZU1hbmFnZXIgd2lsbCBiZSByZXR1cm5lZC4KICAgICAq\nIDwvUD4KICAgICAqIDxQPgogICAgICogSWYgbm8gRGF0YUNhY2hlIGlzIGlu\nIHVzZSBhbiBST1BTdG9yZU1hbmFnZXIgd2lsbCBiZSByZXR1cm5lZC4gCiAg\nICAgKiA8L1A+CiAgICAgKiAKICAgICAqIEByZXR1cm4gQSBkZWxlZ2F0aW5n\nIHN0b3JlIG1hbmFnZXIgc3VpdGFibGUgZm9yIHRoZSBjdXJyZW50CiAgICAg\nKiAgICAgICAgIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGNyZWF0ZURlbGVnYXRpbmdTdG9y\nZU1hbmFnZXIoKSB7IAogICAgICAgIC8vIGRlY29yYXRlIHRoZSBzdG9yZSBt\nYW5hZ2VyIGZvciBkYXRhIGNhY2hpbmcgYW5kIGN1c3RvbQogICAgICAgIC8v\nIHJlc3VsdCBvYmplY3QgcHJvdmlkZXJzOyBhbHdheXMgbWFrZSBzdXJlIGl0\nJ3MgYSBkZWxlZ2F0aW5nCiAgICAgICAgLy8gc3RvcmUgbWFuYWdlciwgYmVj\nYXVzZSBpdCdzIGVhc2llciBmb3IgdXNlcnMgdG8gZGVhbCB3aXRoCiAgICAg\nICAgLy8gdGhhdCB3YXkKICAgICAgICBTdG9yZU1hbmFnZXIgc20gPSBuZXdT\ndG9yZU1hbmFnZXIoKTsKICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2Vy\nIGRzbSA9IG51bGw7CiAgICAgICAgaWYgKF9jb25mLmdldERhdGFDYWNoZU1h\nbmFnZXJJbnN0YW5jZSgpLmdldFN5c3RlbURhdGFDYWNoZSgpICE9IG51bGwp\nIHsKICAgICAgICAgICAgZHNtID0gbmV3IERhdGFDYWNoZVN0b3JlTWFuYWdl\ncihzbSk7CiAgICAgICAgfQogICAgICAgIGRzbSA9IG5ldyBST1BTdG9yZU1h\nbmFnZXIoKGRzbSA9PSBudWxsKSA/IHNtIDogZHNtKTsKICAgICAgICAKICAg\nICAgICByZXR1cm4gZHNtOwogICAgfQp9Cgo=\n","encoding":"base64"}

