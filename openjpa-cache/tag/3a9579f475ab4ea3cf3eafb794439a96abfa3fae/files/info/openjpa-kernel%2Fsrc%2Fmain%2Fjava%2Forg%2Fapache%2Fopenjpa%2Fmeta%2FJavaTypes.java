{"sha":"14be496455aa1f17fba8d042390b5d84d39edd65","node_id":"MDQ6QmxvYjIwNjM2NDoxNGJlNDk2NDU1YWExZjE3ZmJhOGQwNDIzOTBiNWQ4NGQzOWVkZDY1","size":15834,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/14be496455aa1f17fba8d042390b5d84d39edd65","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5SZWFkZXI7CmltcG9y\ndCBqYXZhLmlvLlNlcmlhbGl6YWJsZTsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0LkFycmF5OwppbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9y\ndCBqYXZhLm1hdGguQmlnSW50ZWdlcjsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51\ndGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTG9jYWxlOwppbXBvcnQgamF2YS51\ndGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBlcnNpc3RlbmNlQ2FwYWJs\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DRk1ldGFE\nYXRhUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1l\ndGFEYXRhRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7Cgov\nKioKICogVHlwZSBjb25zdGFudHMgZm9yIG1hbmFnZWQgZmllbGRzLgogKgog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEphdmFUeXBl\ncyB7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQk9PTEVBTiA9IDA7\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBCWVRFID0gMTsKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IENIQVIgPSAyOwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgRE9VQkxFID0gMzsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEZMT0FUID0gNDsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IElOVCA9IDU7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBMT05H\nID0gNjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFNIT1JUID0gNzsK\nICAgIC8vIGtlZXAgT0JKRUNUIGFzIGZpcnN0IG5vbi1wcmltaXRpdmUgdHlw\nZSBjb2RlOyBvdGhlciBjb2RlIHJlbGllcyBvbiBpdAogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgT0JKRUNUID0gODsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IFNUUklORyA9IDk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBOVU1CRVIgPSAxMDsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIEFSUkFZID0gMTE7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBDT0xM\nRUNUSU9OID0gMTI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBNQVAg\nPSAxMzsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IERBVEUgPSAxNDsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFBDID0gMTU7CiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIGludCBCT09MRUFOX09CSiA9IDE2OwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgQllURV9PQkogPSAxNzsKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IENIQVJfT0JKID0gMTg7CiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIGludCBET1VCTEVfT0JKID0gMTk7CiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIGludCBGTE9BVF9PQkogPSAyMDsKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgaW50IElOVF9PQkogPSAyMTsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IExPTkdfT0JKID0gMjI7CiAgICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIGludCBTSE9SVF9PQkogPSAyMzsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEJJR0RFQ0lNQUwgPSAyNDsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEJJR0lOVEVHRVIgPSAyNTsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IExPQ0FMRSA9IDI2OwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgUENfVU5UWVBFRCA9IDI3OwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgQ0FMRU5EQVIgPSAyODsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IE9JRCA9IDI5OwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgSU5Q\nVVRfU1RSRUFNID0gMzA7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBJ\nTlBVVF9SRUFERVIgPSAzMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIEVOVU0gPSAzMjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6\nZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKEphdmFUeXBlcy5jbGFz\ncyk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPENsYXNzPD8+LCBJ\nbnRlZ2VyPiBfdHlwZUNvZGVzID0gbmV3IEhhc2hNYXA8Q2xhc3M8Pz4sIElu\ndGVnZXI+KCk7CgogICAgc3RhdGljIHsKICAgICAgICBfdHlwZUNvZGVzLnB1\ndChTdHJpbmcuY2xhc3MsIFNUUklORyk7CiAgICAgICAgX3R5cGVDb2Rlcy5w\ndXQoQm9vbGVhbi5jbGFzcywgQk9PTEVBTl9PQkopOwogICAgICAgIF90eXBl\nQ29kZXMucHV0KEJ5dGUuY2xhc3MsIEJZVEVfT0JKKTsKICAgICAgICBfdHlw\nZUNvZGVzLnB1dChDaGFyYWN0ZXIuY2xhc3MsIENIQVJfT0JKKTsKICAgICAg\nICBfdHlwZUNvZGVzLnB1dChEb3VibGUuY2xhc3MsIERPVUJMRV9PQkopOwog\nICAgICAgIF90eXBlQ29kZXMucHV0KEZsb2F0LmNsYXNzLCBGTE9BVF9PQkop\nOwogICAgICAgIF90eXBlQ29kZXMucHV0KEludGVnZXIuY2xhc3MsIElOVF9P\nQkopOwogICAgICAgIF90eXBlQ29kZXMucHV0KExvbmcuY2xhc3MsIExPTkdf\nT0JKKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChTaG9ydC5jbGFzcywgU0hP\nUlRfT0JKKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChEYXRlLmNsYXNzLCBE\nQVRFKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChqYXZhLnNxbC5EYXRlLmNs\nYXNzLCBEQVRFKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChqYXZhLnNxbC5U\naW1lc3RhbXAuY2xhc3MsIERBVEUpOwogICAgICAgIF90eXBlQ29kZXMucHV0\nKGphdmEuc3FsLlRpbWUuY2xhc3MsIERBVEUpOwogICAgICAgIF90eXBlQ29k\nZXMucHV0KEJpZ0ludGVnZXIuY2xhc3MsIEJJR0lOVEVHRVIpOwogICAgICAg\nIF90eXBlQ29kZXMucHV0KEJpZ0RlY2ltYWwuY2xhc3MsIEJJR0RFQ0lNQUwp\nOwogICAgICAgIF90eXBlQ29kZXMucHV0KE51bWJlci5jbGFzcywgTlVNQkVS\nKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChMb2NhbGUuY2xhc3MsIExPQ0FM\nRSk7CiAgICAgICAgX3R5cGVDb2Rlcy5wdXQoT2JqZWN0LmNsYXNzLCBPQkpF\nQ1QpOwogICAgICAgIF90eXBlQ29kZXMucHV0KFBlcnNpc3RlbmNlQ2FwYWJs\nZS5jbGFzcywgUENfVU5UWVBFRCk7CiAgICAgICAgX3R5cGVDb2Rlcy5wdXQo\nUHJvcGVydGllcy5jbGFzcywgTUFQKTsKICAgICAgICBfdHlwZUNvZGVzLnB1\ndChDYWxlbmRhci5jbGFzcywgQ0FMRU5EQVIpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBmaWVsZCBtZXRhZGF0YSB0eXBlIGNvZGUgZm9y\nIHRoZSBnaXZlbiBjbGFzcy4gRmlyc3QgY2xhc3MKICAgICAqIG9iamVjdHMg\nYXJlIG5vdCByZWNvZ25pemVkIGluIHRoaXMgbWV0aG9kLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGludCBnZXRUeXBlQ29kZShDbGFzczw/PiB0eXBl\nKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIE9CSkVDVDsKCiAgICAgICAgaWYgKHR5cGUuaXNQcmltaXRpdmUoKSkg\newogICAgICAgICAgICBzd2l0Y2ggKHR5cGUuZ2V0TmFtZSgpLmNoYXJBdCgw\nKSkgewogICAgICAgICAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuICh0eXBlID09IGJvb2xlYW4uY2xhc3MpID8gQk9PTEVB\nTiA6IEJZVEU7CiAgICAgICAgICAgICAgICBjYXNlICdjJzoKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gQ0hBUjsKICAgICAgICAgICAgICAgIGNhc2Ug\nJ2QnOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBET1VCTEU7CiAgICAg\nICAgICAgICAgICBjYXNlICdmJzoKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gRkxPQVQ7CiAgICAgICAgICAgICAgICBjYXNlICdpJzoKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gSU5UOwogICAgICAgICAgICAgICAgY2FzZSAn\nbCc6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExPTkc7CiAgICAgICAg\nICAgICAgICBjYXNlICdzJzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nU0hPUlQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEludGVn\nZXIgY29kZSA9IChJbnRlZ2VyKSBfdHlwZUNvZGVzLmdldCh0eXBlKTsKICAg\nICAgICBpZiAoY29kZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gY29k\nZS5pbnRWYWx1ZSgpOwoKICAgICAgICAvLyBoYXZlIHRvIGRvIHRoaXMgZmly\nc3QgdG8gY2F0Y2ggY3VzdG9tIGNvbGxlY3Rpb24gYW5kIG1hcCB0eXBlczsK\nICAgICAgICAvLyBvbiByZXNvbHZlIHdlIGZpZ3VyZSBvdXQgaWYgdGhlc2Ug\nY3VzdG9tIHR5cGVzIGFyZQogICAgICAgIC8vIHBlcnNpc3RlbmNlLWNhcGFi\nbGUKICAgICAgICBpZiAoQ29sbGVjdGlvbi5jbGFzcy5pc0Fzc2lnbmFibGVG\ncm9tKHR5cGUpKQogICAgICAgICAgICByZXR1cm4gQ09MTEVDVElPTjsKICAg\nICAgICBpZiAoTWFwLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAg\nICAgICAgICAgIHJldHVybiBNQVA7CiAgICAgICAgaWYgKHR5cGUuaXNBcnJh\neSgpKQogICAgICAgICAgICByZXR1cm4gQVJSQVk7CiAgICAgICAgaWYgKENh\nbGVuZGFyLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAgICAgICAg\nICAgIHJldHVybiBDQUxFTkRBUjsKCiAgICAgICAgaWYgKHR5cGUuaXNJbnRl\ncmZhY2UoKSkgewogICAgICAgICAgICBpZiAodHlwZSA9PSBTZXJpYWxpemFi\nbGUuY2xhc3MpCiAgICAgICAgICAgICAgICByZXR1cm4gT0JKRUNUOwogICAg\nICAgICAgICByZXR1cm4gUENfVU5UWVBFRDsKICAgICAgICB9CiAgICAgICAg\naWYgKHR5cGUuaXNBc3NpZ25hYmxlRnJvbShSZWFkZXIuY2xhc3MpKQogICAg\nICAgICAgICByZXR1cm4gSU5QVVRfUkVBREVSOwogICAgICAgIGlmICh0eXBl\nLmlzQXNzaWduYWJsZUZyb20gKElucHV0U3RyZWFtLmNsYXNzKSkKICAgICAg\nICAgICAgcmV0dXJuIElOUFVUX1NUUkVBTTsKICAgICAgICBpZiAoRW51bS5j\nbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUpKQogICAgICAgICAgICByZXR1\ncm4gRU5VTTsKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIE9CSkVDVDsK\nICAgIH0KIAogICAgLyoqCiAgICAgKiBDaGVjayB0aGUgZ2l2ZW4gbmFtZSBh\nZ2FpbnN0IHRoZSBzYW1lIHNldCBvZiBzdGFuZGFyZCBwYWNrYWdlcyB1c2Vk\nCiAgICAgKiB3aGVuIHBhcnNpbmcgbWV0YWRhdGEuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgQ2xhc3M8Pz4gY2xhc3NGb3JOYW1lKFN0cmluZyBuYW1l\nLCBDbGFzc01ldGFEYXRhIGNvbnRleHQpIHsKICAgICAgICByZXR1cm4gY2xh\nc3NGb3JOYW1lKG5hbWUsIGNvbnRleHQsIG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2hlY2sgdGhlIGdpdmVuIG5hbWUgYWdhaW5zdCB0aGUgc2Ft\nZSBzZXQgb2Ygc3RhbmRhcmQgcGFja2FnZXMgdXNlZAogICAgICogd2hlbiBw\nYXJzaW5nIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIENs\nYXNzPD8+IGNsYXNzRm9yTmFtZShTdHJpbmcgbmFtZSwgQ2xhc3NNZXRhRGF0\nYSBjb250ZXh0LCBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICByZXR1\ncm4gY2xhc3NGb3JOYW1lKG5hbWUsIGNvbnRleHQsIGNvbnRleHQuZ2V0RGVz\nY3JpYmVkVHlwZSgpLCBudWxsLAogICAgICAgICAgICBsb2FkZXIpOwogICAg\nfQoKICAgIC8qKgogICAgICogQ2hlY2sgdGhlIGdpdmVuIG5hbWUgYWdhaW5z\ndCB0aGUgc2FtZSBzZXQgb2Ygc3RhbmRhcmQgcGFja2FnZXMgdXNlZAogICAg\nICogd2hlbiBwYXJzaW5nIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIENsYXNzPD8+IGNsYXNzRm9yTmFtZShTdHJpbmcgbmFtZSwgVmFs\ndWVNZXRhRGF0YSBjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIGNsYXNzRm9y\nTmFtZShuYW1lLCBjb250ZXh0LCBudWxsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENoZWNrIHRoZSBnaXZlbiBuYW1lIGFnYWluc3QgdGhlIHNhbWUgc2V0\nIG9mIHN0YW5kYXJkIHBhY2thZ2VzIHVzZWQKICAgICAqIHdoZW4gcGFyc2lu\nZyBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBDbGFzczw/\nPiBjbGFzc0Zvck5hbWUoU3RyaW5nIG5hbWUsIFZhbHVlTWV0YURhdGEgY29u\ndGV4dCwgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgcmV0dXJuIGNs\nYXNzRm9yTmFtZShuYW1lLAogICAgICAgICAgICBjb250ZXh0LmdldEZpZWxk\nTWV0YURhdGEoKS5nZXREZWZpbmluZ01ldGFEYXRhKCksCiAgICAgICAgICAg\nIGNvbnRleHQuZ2V0RmllbGRNZXRhRGF0YSgpLmdldERlY2xhcmluZ1R5cGUo\nKSwgY29udGV4dCwgbG9hZGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIENo\nZWNrIHRoZSBnaXZlbiBuYW1lIGFnYWluc3QgdGhlIHNhbWUgc2V0IG9mIHN0\nYW5kYXJkIHBhY2thZ2VzIHVzZWQKICAgICAqIHdoZW4gcGFyc2luZyBtZXRh\nZGF0YS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgQ2xhc3M8Pz4gY2xh\nc3NGb3JOYW1lKFN0cmluZyBuYW1lLCBDbGFzc01ldGFEYXRhIG1ldGEsIENs\nYXNzPD8+IGRlYywgVmFsdWVNZXRhRGF0YSB2bWQsIAogICAgICAgIENsYXNz\nTG9hZGVyIGxvYWRlcikgewogICAgICAgIC8vIHNwZWNpYWwgY2FzZSBmb3Ig\nUGVyc2lzdGVuY2VDYXBhYmxlIGFuZCBPYmplY3QKICAgICAgICBpZiAoIlBl\ncnNpc3RlbmNlQ2FwYWJsZSIuZXF1YWxzKG5hbWUpCiAgICAgICAgICAgIHx8\nICJqYXZheC5qZG8uUGVyc2lzdGVuY2VDYXBhYmxlIi5lcXVhbHMobmFtZSkp\nIC8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5CiAgICAgICAgICAgIHJldHVy\nbiBQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3M7CiAgICAgICAgaWYgKCJPYmpl\nY3QiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5j\nbGFzczsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcCA9IG1ldGEu\nZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIGJvb2xlYW4gcnVudGltZSA9IChy\nZXAuZ2V0VmFsaWRhdGUoKSAmIE1ldGFEYXRhUmVwb3NpdG9yeS5WQUxJREFU\nRV9SVU5USU1FKSAhPSAwOwogICAgICAgIGlmIChsb2FkZXIgPT0gbnVsbCkK\nICAgICAgICAgICAgbG9hZGVyID0gcmVwLmdldENvbmZpZ3VyYXRpb24oKS5n\nZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS4KICAgICAgICAgICAgICAgIGdl\ndENsYXNzTG9hZGVyKGRlYywgbWV0YS5nZXRFbnZDbGFzc0xvYWRlcigpKTsK\nCiAgICAgICAgLy8gdHJ5IHRoZSBvd25lcidzIHBhY2thZ2UKICAgICAgICBT\ndHJpbmcgcGtnID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShkZWMpOwogICAg\nICAgIENsYXNzPD8+IGNscyA9IENGTWV0YURhdGFQYXJzZXIuY2xhc3NGb3JO\nYW1lKG5hbWUsIHBrZywgcnVudGltZSwgbG9hZGVyKTsKICAgICAgICBpZiAo\nY2xzID09IG51bGwgJiYgdm1kICE9IG51bGwpIHsKICAgICAgICAgICAgLy8g\ndHJ5IGFnYWluc3QgdGhpcyB2YWx1ZSB0eXBlJ3MgcGFja2FnZSB0b28KICAg\nICAgICAgICAgcGtnID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZSh2bWQuZ2V0\nRGVjbGFyZWRUeXBlKCkpOwogICAgICAgICAgICBjbHMgPSBDRk1ldGFEYXRh\nUGFyc2VyLmNsYXNzRm9yTmFtZShuYW1lLCBwa2csIHJ1bnRpbWUsIGxvYWRl\ncik7CiAgICAgICAgfQogICAgICAgIGlmIChjbHMgPT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJi\nYWQtY2xhc3MiLCBuYW1lLAogICAgICAgICAgICAgICAgKHZtZCA9PSBudWxs\nKSA/IChPYmplY3QpIG1ldGEgOiAoT2JqZWN0KSB2bWQpKTsKICAgICAgICBy\nZXR1cm4gY2xzOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUg\nZ2l2ZW4gb2JqZWN0IHRvIHRoZSBnaXZlbiB0eXBlIGlmIHBvc3NpYmxlLiBJ\nZiB0aGUgdHlwZSBpcwogICAgICogYSBudW1lcmljIHByaW1pdGl2ZSwgdGhp\ncyBtZXRob2Qgb25seSBndWFyYW50ZWVzIHRoYXQgdGhlIHJldHVybiB2YWx1\nZQogICAgICogaXMgYSB7QGxpbmsgTnVtYmVyfS4gSWYgbm8ga25vd24gY29u\ndmVyc2lvbiBvciB0aGUgdmFsdWUgaXMgbnVsbCwKICAgICAqIHJldHVybnMg\ndGhlIG9yaWdpbmFsIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIE9iamVjdCBjb252ZXJ0KE9iamVjdCB2YWwsIGludCB0eXBlQ29kZSkgewog\nICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CgogICAgICAgIHN3aXRjaCAodHlwZUNvZGUpIHsKICAgICAgICAgICAg\nY2FzZSBCSUdERUNJTUFMOgogICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0\nYW5jZW9mIEJpZ0RlY2ltYWwpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIHZhbDsKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBOdW1i\nZXIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCaWdEZWNpbWFs\nKCgoTnVtYmVyKSB2YWwpLmRvdWJsZVZhbHVlKCkpOwogICAgICAgICAgICAg\nICAgaWYgKHZhbCBpbnN0YW5jZW9mIFN0cmluZykKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gbmV3IEJpZ0RlY2ltYWwodmFsLnRvU3RyaW5nKCkpOwog\nICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgY2FzZSBC\nSUdJTlRFR0VSOgogICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9m\nIEJpZ0ludGVnZXIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsK\nICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBOdW1iZXIgfHwg\ndmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBuZXcgQmlnSW50ZWdlcih2YWwudG9TdHJpbmcoKSk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICBjYXNlIEJPT0xFQU46\nCiAgICAgICAgICAgIGNhc2UgQk9PTEVBTl9PQko6CiAgICAgICAgICAgICAg\nICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBCb29sZWFuLnZhbHVlT2YodmFsLnRvU3RyaW5nKCkpOwog\nICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgY2FzZSBC\nWVRFX09CSjoKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBC\neXRlKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAg\nICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTnVtYmVyKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgQnl0ZSgoKE51bWJlcikgdmFsKS5ieXRl\nVmFsdWUoKSk7CiAgICAgICAgICAgICAgICAvLyBubyBicmVhawogICAgICAg\nICAgICBjYXNlIEJZVEU6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3Rh\nbmNlb2YgU3RyaW5nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcg\nQnl0ZSh2YWwudG9TdHJpbmcoKSk7CiAgICAgICAgICAgICAgICByZXR1cm4g\ndmFsOwogICAgICAgICAgICBjYXNlIENIQVI6CiAgICAgICAgICAgIGNhc2Ug\nQ0hBUl9PQko6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2Yg\nQ2hhcmFjdGVyKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAg\nICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hhcmFjdGVyKHZhbC50b1N0\ncmluZygpLmNoYXJBdCgwKSk7CiAgICAgICAgICAgICAgICBpZiAodmFsIGlu\nc3RhbmNlb2YgTnVtYmVyKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBu\nZXcgQ2hhcmFjdGVyKChjaGFyKSAoKE51bWJlcikgdmFsKS5pbnRWYWx1ZSgp\nKTsKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIGNh\nc2UgREFURToKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBT\ndHJpbmcpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHZh\nbC50b1N0cmluZygpKTsKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAg\nICAgICAgICAgIGNhc2UgRE9VQkxFX09CSjoKICAgICAgICAgICAgICAgIGlm\nICh2YWwgaW5zdGFuY2VvZiBEb3VibGUpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2Vv\nZiBOdW1iZXIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb3Vi\nbGUoKChOdW1iZXIpIHZhbCkuZG91YmxlVmFsdWUoKSk7CiAgICAgICAgICAg\nICAgICAvLyBubyBicmVhawogICAgICAgICAgICBjYXNlIERPVUJMRToKICAg\nICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb3VibGUodmFsLnRvU3RyaW5n\nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAg\nY2FzZSBGTE9BVF9PQko6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3Rh\nbmNlb2YgRmxvYXQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsK\nICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBOdW1iZXIpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdCgoKE51bWJlcikg\ndmFsKS5mbG9hdFZhbHVlKCkpOwogICAgICAgICAgICAgICAgLy8gbm8gYnJl\nYWsKICAgICAgICAgICAgY2FzZSBGTE9BVDoKICAgICAgICAgICAgICAgIGlm\nICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIG5ldyBGbG9hdCh2YWwudG9TdHJpbmcoKSk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICBjYXNlIElOVF9PQko6CiAg\nICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgSW50ZWdlcikKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICAgICAg\naWYgKHZhbCBpbnN0YW5jZW9mIE51bWJlcikKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gKChOdW1iZXIpIHZhbCkuaW50VmFsdWUoKTsKICAgICAgICAg\nICAgICAgIC8vIG5vIGJyZWFrCiAgICAgICAgICAgIGNhc2UgSU5UOgogICAg\nICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFN0cmluZykKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gbmV3IEludGVnZXIodmFsLnRvU3RyaW5n\nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAg\nY2FzZSBMT05HX09CSjoKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBMb25nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAg\nICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTnVtYmVyKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiAoKE51bWJlcikgdmFsKS5sb25nVmFs\ndWUoKTsKICAgICAgICAgICAgICAgIC8vIG5vIGJyZWFrCiAgICAgICAgICAg\nIGNhc2UgTE9ORzoKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2Vv\nZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMb25n\nKHZhbC50b1N0cmluZygpKTsKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7\nCiAgICAgICAgICAgIGNhc2UgTlVNQkVSOgogICAgICAgICAgICAgICAgaWYg\nKHZhbCBpbnN0YW5jZW9mIE51bWJlcikKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gdmFsOwogICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9m\nIFN0cmluZykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJpZ0Rl\nY2ltYWwodmFsLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJu\nIHZhbDsKICAgICAgICAgICAgY2FzZSBTSE9SVF9PQko6CiAgICAgICAgICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgU2hvcnQpCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5z\ndGFuY2VvZiBOdW1iZXIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTaG9ydCgoKE51bWJlcikgdmFsKS5zaG9ydFZhbHVlKCkpOwogICAgICAg\nICAgICAgICAgLy8gbm8gYnJlYWsKICAgICAgICAgICAgY2FzZSBTSE9SVDoK\nICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTaG9ydCh2YWwudG9TdHJp\nbmcoKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAg\nICBjYXNlIFNUUklORzoKICAgICAgICAgICAgICAgIHJldHVybiB2YWwudG9T\ndHJpbmcoKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAg\nIHJldHVybiB2YWw7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRydWUgaWYgdGhlIChwb3NzaWJseSB1bnJlc29sdmVkKSBmaWVs\nZCBvciBpdHMgZWxlbWVudHMgbWlnaHQgYmUKICAgICAqIHBlcnNpc3RlbmNl\nIGNhcGFibGUgb2JqZWN0cy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBi\nb29sZWFuIG1heWJlUEMoRmllbGRNZXRhRGF0YSBmaWVsZCkgewogICAgICAg\nIHN3aXRjaCAoZmllbGQuZ2V0RGVjbGFyZWRUeXBlQ29kZSgpKSB7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICAgICAgcmV0dXJu\nIG1heWJlUEMoZmllbGQuZ2V0RWxlbWVudCgpKTsKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgcmV0dXJuIG1heWJl\nUEMoZmllbGQuZ2V0S2V5KCkpIHx8IG1heWJlUEMoZmllbGQuZ2V0RWxlbWVu\ndCgpKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJl\ndHVybiBtYXliZVBDKChWYWx1ZU1ldGFEYXRhKSBmaWVsZCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIChw\nb3NzaWJseSB1bnJlc29sdmVkKSB2YWx1ZSBtaWdodCBiZSBhIGZpcnN0IGNs\nYXNzCiAgICAgKiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nYm9vbGVhbiBtYXliZVBDKFZhbHVlTWV0YURhdGEgdmFsKSB7CiAgICAgICAg\ncmV0dXJuIG1heWJlUEModmFsLmdldERlY2xhcmVkVHlwZUNvZGUoKSwgdmFs\nLmdldERlY2xhcmVkVHlwZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0cnVlIGlmIHRoZSBnaXZlbiB1bnJlc29sdmVkIHR5cGVjb2RlL3R5\ncGUgcGFpciBtYXkgcmVwcmVzZW50IGEKICAgICAqIHBlcnNpc3RlbnQgb2Jq\nZWN0LgogICAgICovCiAgICBzdGF0aWMgYm9vbGVhbiBtYXliZVBDKGludCB0\neXBlQ29kZSwgQ2xhc3M8Pz4gdHlwZSkgewogICAgICAgIGlmICh0eXBlID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBzd2l0\nY2ggKHR5cGVDb2RlKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9C\nSkVDVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLlBDX1VOVFlQRUQ6CiAgICAgICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09M\nTEVDVElPTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAg\nICAgICAgICAgICAgcmV0dXJuICF0eXBlLmdldE5hbWUoKS5zdGFydHNXaXRo\nKCJqYXZhLnV0aWwuIik7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogSGVscGVyIG1ldGhvZCB0byByZXR1cm4gdGhlIGdpdmVuIGFy\ncmF5IHZhbHVlIGFzIGEgY29sbGVjdGlvbi4KICAgICAqLwogICAgQFN1cHBy\nZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgc3RhdGljIExp\nc3QgdG9MaXN0KE9iamVjdCB2YWwsIENsYXNzPD8+IGVsZW0sIGJvb2xlYW4g\nbXV0YWJsZSkgewogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIExpc3QgbDsKICAgICAgICBpZiAo\nIWVsZW0uaXNQcmltaXRpdmUoKSkgewogICAgICAgICAgICAvLyBpZiBhbiBv\nYmplY3QgYXJyYXksIHVzZSBidWlsdC1pbiBsaXN0IGZ1bmN0aW9uCiAgICAg\nICAgICAgIGwgPSBBcnJheXMuYXNMaXN0KChPYmplY3RbXSkgdmFsKTsKICAg\nICAgICAgICAgaWYgKG11dGFibGUpCiAgICAgICAgICAgICAgICBsID0gbmV3\nIEFycmF5TGlzdChsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAv\nLyBjb252ZXJ0IHRvIGxpc3Qgb2Ygd3JhcHBlciBvYmplY3RzCiAgICAgICAg\nICAgIGludCBsZW5ndGggPSBBcnJheS5nZXRMZW5ndGgodmFsKTsKICAgICAg\nICAgICAgbCA9IG5ldyBBcnJheUxpc3QobGVuZ3RoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgIGwuYWRkKEFycmF5LmdldCh2YWwsIGkpKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBIZWxwZXIgbWV0\naG9kIHRvIHJldHVybiB0aGUgZ2l2ZW4gY29sbGVjdGlvbiBhcyBhbiBhcnJh\neS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgdG9BcnJheShD\nb2xsZWN0aW9uPD8+IGNvbGwsIENsYXNzPD8+IGVsZW0pIHsKICAgICAgICBp\nZiAoY29sbCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgT2JqZWN0IGFycmF5ID0gQXJyYXkubmV3SW5zdGFuY2UoZWxlbSwg\nY29sbC5zaXplKCkpOwogICAgICAgIGludCBpZHggPSAwOwogICAgICAgIGZv\nciAoSXRlcmF0b3I8Pz4gaXRyID0gY29sbC5pdGVyYXRvcigpOyBpdHIuaGFz\nTmV4dCgpOyBpZHgrKykKICAgICAgICAgICAgQXJyYXkuc2V0KGFycmF5LCBp\nZHgsIGl0ci5uZXh0ICgpKTsKCQlyZXR1cm4gYXJyYXk7Cgl9Cn0K\n","encoding":"base64"}

