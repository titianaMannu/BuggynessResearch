{"sha":"eaa94b7a8e399d3e7ab204695d10d3ab28e1124f","node_id":"MDQ6QmxvYjIwNjM2NDplYWE5NGI3YThlMzk5ZDNlN2FiMjA0Njk1ZDEwZDNhYjI4ZTExMjRm","size":4441,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/eaa94b7a8e399d3e7ab204695d10d3ab28e1124f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbDsKCmltcG9ydCBqYXZh\nLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwoK\nLyoqCiAqIERhdGFzdG9yZSBpZGVudGl0eSB0eXBlLiBJbXBsZW1lbnRhdGlv\nbnMgbWF5IGNob29zZSB0byB1c2UgdGhpcyB0eXBlLAogKiBvciBjaG9vc2Ug\ndG8gdXNlIHRoZWlyIG93biBkYXRhc3RvcmUgaWRlbnRpdHkgdmFsdWVzLgog\nKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGZpbmFsIGNsYXNz\nIElkCiAgICBleHRlbmRzIE9wZW5KUEFJZCB7CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZShJZC5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBsb25nIF9pZDsKCiAg\nICAvKioKICAgICAqIENyZWF0ZSBhbiBpZCBmcm9tIHRoZSBnaXZlbiB0eXBl\nIGFuZCB2YWx1ZTsgdGhlIHZhbHVlIG1pZ2h0IGJlIGFuCiAgICAgKiBpZCBp\nbnN0bmFjZSwgYSBzdHJpbmdpZmllZCBpZCwgb3IgYSBwcmltYXJ5IGtleSB2\nYWx1ZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBJZCBuZXdJbnN0YW5j\nZShDbGFzcyBjbHMsIE9iamVjdCB2YWwpIHsKICAgICAgICBpZiAodmFsIGlu\nc3RhbmNlb2YgSWQpCiAgICAgICAgICAgIHJldHVybiAoSWQpIHZhbDsKICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICBy\nZXR1cm4gbmV3IElkKGNscywgKFN0cmluZykgdmFsKTsKICAgICAgICBpZiAo\ndmFsIGluc3RhbmNlb2YgTnVtYmVyKQogICAgICAgICAgICByZXR1cm4gbmV3\nIElkKGNscywgKChOdW1iZXIpIHZhbCkubG9uZ1ZhbHVlKCkpOwogICAgICAg\nIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBJZChj\nbHMsIDBMKTsKICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9j\nLmdldCgidW5rbm93bi1vaWQiLCBjbHMsIHZhbCwKICAgICAgICAgICAgdmFs\nLmdldENsYXNzKCkpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nbiBpZCBmcm9tIHRoZSByZXN1bHQgb2YgYSB7QGxpbmsgI3RvU3RyaW5nfSBj\nYWxsIG9uIGFub3RoZXIKICAgICAqIGluc3RhbmNlLgogICAgICovCiAgICBw\ndWJsaWMgSWQoU3RyaW5nIHN0cikgewogICAgICAgIHRoaXMoc3RyLCAoQ2xh\nc3NMb2FkZXIpIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRl\nIGFuIGlkIGZyb20gdGhlIHJlc3VsdCBvZiBhbiB7QGxpbmsgI3RvU3RyaW5n\nfSBjYWxsIG9uIGFub3RoZXIKICAgICAqIGluc3RhbmNlLgogICAgICovCiAg\nICBwdWJsaWMgSWQoU3RyaW5nIHN0ciwgT3BlbkpQQUNvbmZpZ3VyYXRpb24g\nY29uZiwgQ2xhc3NMb2FkZXIgYnJva2VyTG9hZGVyKSB7CiAgICAgICAgdGhp\ncyhzdHIsIChjb25mID09IG51bGwpID8gYnJva2VyTG9hZGVyIDogY29uZi4K\nICAgICAgICAgICAgZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuZ2V0Q2xh\nc3NMb2FkZXIoSWQuY2xhc3MsIGJyb2tlckxvYWRlcikpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIGFuIGlkIGZyb20gdGhlIHJlc3VsdCBvZiBh\nbiB7QGxpbmsgI3RvU3RyaW5nfSBjYWxsIG9uIGFub3RoZXIKICAgICAqIGlu\nc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgSWQoU3RyaW5nIHN0ciwgQ2xh\nc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgaWYgKGxvYWRlciA9PSBudWxs\nKQogICAgICAgICAgICBsb2FkZXIgPSBBY2Nlc3NDb250cm9sbGVyLmRvUHJp\ndmlsZWdlZCgKICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldENv\nbnRleHRDbGFzc0xvYWRlckFjdGlvbigpKTsKCiAgICAgICAgaWYgKHN0ciA9\nPSBudWxsKQogICAgICAgICAgICBfaWQgPSAwTDsKICAgICAgICBlbHNlIHsK\nICAgICAgICAgICAgaW50IGRhc2ggPSBzdHIuaW5kZXhPZignLScpOwogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdHlwZSA9IENsYXNzLmZv\nck5hbWUoc3RyLnN1YnN0cmluZygwLCBkYXNoKSwgdHJ1ZSwgbG9hZGVyKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJzdHJp\nbmctaWQiLCBzdHIpLCB0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBf\naWQgPSBMb25nLnBhcnNlTG9uZyhzdHIuc3Vic3RyaW5nKGRhc2ggKyAxKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0IGZy\nb20gdGhlIHJlc3VsdCBvZiBhIHtAbGluayAjdG9TdHJpbmd9IGNhbGwgb24g\nYW5vdGhlcgogICAgICogaW5zdGFuY2UuCiAgICAgKi8KICAgIHB1YmxpYyBJ\nZChDbGFzcyBjbHMsIFN0cmluZyBrZXkpIHsKICAgICAgICBzdXBlcihjbHMp\nOwoKICAgICAgICBpZiAoa2V5ID09IG51bGwpCiAgICAgICAgICAgIF9pZCA9\nIDBMOwogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBhbGxvdyBlaXRo\nZXIgc3RyaW5naWZpZWQgbG9uZyBvciByZXN1bHQgb2YgSWQudG9TdHJpbmcK\nICAgICAgICAgICAgaW50IGRhc2ggPSBrZXkuaW5kZXhPZignLScpOwogICAg\nICAgICAgICBpZiAoZGFzaCA+IDApIC8vIGRvbid0IGNoZWNrIGZvciAtMTsg\nbWlnaHQgYmUgbmVnYXRpdmUgbnVtYmVyCiAgICAgICAgICAgICAgICBrZXkg\nPSBrZXkuc3Vic3RyaW5nKGRhc2ggKyAxKTsKICAgICAgICAgICAgX2lkID0g\nTG9uZy5wYXJzZUxvbmcoa2V5KTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3QgZnJvbSBrZXkgdmFsdWUuCiAgICAgKi8KICAg\nIHB1YmxpYyBJZChDbGFzcyBjbHMsIExvbmcga2V5KSB7CiAgICAgICAgdGhp\ncyhjbHMsIChrZXkgPT0gbnVsbCkgPyAwTCA6IGtleS5sb25nVmFsdWUoKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgZnJvbSBrZXkgdmFs\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyBJZChDbGFzcyBjbHMsIGxvbmcga2V5\nKSB7CiAgICAgICAgc3VwZXIoY2xzKTsKICAgICAgICBfaWQgPSBrZXk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgZnJvbSBrZXkgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyBJZChDbGFzcyBjbHMsIGxvbmcga2V5LCBi\nb29sZWFuIHN1YnMpIHsKICAgICAgICBzdXBlcihjbHMsIHN1YnMpOwogICAg\nICAgIF9pZCA9IGtleTsKICAgIH0KCiAgICAvKioKICAgICAqIFByaW1hcnkg\na2V5LgogICAgICovCiAgICBwdWJsaWMgbG9uZyBnZXRJZCgpIHsKICAgICAg\nICByZXR1cm4gX2lkOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0SWRP\nYmplY3QoKSB7CiAgICAgICAgcmV0dXJuIF9pZDsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgaW50IGlkSGFzaCgpIHsKICAgICAgICByZXR1cm4gKGludCkgKF9p\nZCBeIChfaWQgPj4+IDMyKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gaWRFcXVhbHMoT3BlbkpQQUlkIG90aGVyKSB7CiAgICAgICAgcmV0dXJu\nIF9pZCA9PSAoKElkKSBvdGhlcikuX2lkOwoJfQp9Cg==\n","encoding":"base64"}

