{"sha":"e450e2e9b0fc4890c1554bd38b7663b44d376916","node_id":"MDQ6QmxvYjIwNjM2NDplNDUwZTJlOWIwZmM0ODkwYzE1NTRiZDM4Yjc2NjNiNDRkMzc2OTE2","size":6528,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e450e2e9b0fc4890c1554bd38b7663b44d376916","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcDsKCmltcG9ydCBq\nYXZhLmlvLk9iamVjdFN0cmVhbUV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQg\namF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKCi8qKgogKiBSYW5kb20tYWNjZXNz\nIHJlc3VsdCBsaXN0IGltcGxlbWVudGF0aW9uLiBJdCBtYWludGFpbnMgYSBt\nYXAKICogb2YgdGhlIGl0ZW1zIHRoYXQgd2UgaGF2ZSBhbHJlYWR5IGluc3Rh\nbnRpYXRlZC4KICoKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICog\nQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNs\nYXNzIFJhbmRvbUFjY2Vzc1Jlc3VsdExpc3QgZXh0ZW5kcyBBYnN0cmFjdE5v\nblNlcXVlbnRpYWxSZXN1bHRMaXN0IHsKCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBpbnQgT1BFTiA9IDA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgRlJFRUQgPSAxOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IENM\nT1NFRCA9IDI7CgogICAgLy8gZGF0YSBwcm92aWRlcgogICAgcHJpdmF0ZSBS\nZXN1bHRPYmplY3RQcm92aWRlciBfcm9wID0gbnVsbDsKCiAgICAvLyBob2xk\ncyBhbGwgdGhlIHJvdyB2YWx1ZXMgdGhhdCBoYXZlIGJlZW4gaW5zdGFudGlh\ndGVkIHNvIGZhcgogICAgcHJpdmF0ZSBNYXAgX3Jvd3MgPSBudWxsOwogICAg\ncHJpdmF0ZSBPYmplY3RbXSBfZnVsbCA9IG51bGw7CgogICAgLy8gYm9va2tl\nZXBpbmcKICAgIHByaXZhdGUgbG9uZyBfcmVxdWVzdHMgPSAwOwogICAgcHJp\ndmF0ZSBpbnQgX3N0YXRlID0gT1BFTjsKICAgIHByaXZhdGUgaW50IF9zaXpl\nID0gLTE7CgogICAgcHVibGljIFJhbmRvbUFjY2Vzc1Jlc3VsdExpc3QoUmVz\ndWx0T2JqZWN0UHJvdmlkZXIgcm9wKSB7CiAgICAgICAgX3JvcCA9IHJvcDsK\nICAgICAgICBfcm93cyA9IG5ld1Jvd01hcCgpOwoKICAgICAgICB0cnkgewog\nICAgICAgICAgICBfcm9wLm9wZW4oKTsKICAgICAgICB9IGNhdGNoIChSdW50\naW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgICAgIGNsb3NlKCk7CiAgICAg\nICAgICAgIHRocm93IHJlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIGNsb3NlKCk7CiAgICAgICAgICAgIF9yb3AuaGFu\nZGxlQ2hlY2tlZEV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBPdmVycmlkZSB0aGlzIG1ldGhvZCB0byBjb250cm9sIHdo\nYXQga2luZCBvZiBtYXAgaXMgdXNlZCBmb3IKICAgICAqIHRoZSBpbnN0YW50\naWF0ZWQgcm93cy4KICAgICAqLwogICAgcHJvdGVjdGVkIE1hcCBuZXdSb3dN\nYXAoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBIYXNoTWFwKCk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gaXNQcm92aWRlck9wZW4oKSB7CiAgICAgICAg\ncmV0dXJuIF9zdGF0ZSA9PSBPUEVOOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzQ2xvc2VkKCkgewogICAgICAgIHJldHVybiBfc3RhdGUgPT0gQ0xP\nU0VEOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAg\nIGlmIChfc3RhdGUgIT0gQ0xPU0VEKSB7CiAgICAgICAgICAgIGZyZWUoKTsK\nICAgICAgICAgICAgX3N0YXRlID0gQ0xPU0VEOwogICAgICAgIH0KICAgIH0K\nCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGdldEludGVybmFsKGludCBpbmRleCkg\newogICAgICAgIGlmIChfZnVsbCAhPSBudWxsKSB7CiAgICAgICAgICAgIGlm\nIChpbmRleCA+PSBfZnVsbC5sZW5ndGgpCiAgICAgICAgICAgICAgICByZXR1\ncm4gUEFTVF9FTkQ7CiAgICAgICAgICAgIHJldHVybiBfZnVsbFtpbmRleF07\nCiAgICAgICAgfQoKICAgICAgICBJbnRlZ2VyIGkgPSBpbmRleDsKICAgICAg\nICBPYmplY3QgcmV0ID0gX3Jvd3MuZ2V0KGkpOwogICAgICAgIGlmIChyZXQg\nIT0gbnVsbCkgewogICAgICAgICAgICBpZiAocmV0IGluc3RhbmNlb2YgTnVs\nbCkKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICBy\nZXR1cm4gcmV0OwogICAgICAgIH0KCiAgICAgICAgcmV0ID0gaW5zdGFudGlh\ndGVSb3coaSk7CiAgICAgICAgcmV0dXJuIChyZXQgPT0gbnVsbCkgPyBQQVNU\nX0VORCA6IHJldDsKICAgIH0KCiAgICAvKioKICAgICAqIEluc3RhbnRpYXRl\nIHRoZSByb3cgb2JqZWN0IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXguCiAgICAg\nKi8KICAgIHByaXZhdGUgT2JqZWN0IGluc3RhbnRpYXRlUm93KEludGVnZXIg\naSkgewogICAgICAgIF9yZXF1ZXN0cysrOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGlmICghX3JvcC5hYnNvbHV0ZShpLmludFZhbHVlKCkpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIFBBU1RfRU5EOwoKICAgICAgICAgICAgT2Jq\nZWN0IG9iID0gX3JvcC5nZXRSZXN1bHRPYmplY3QoKTsKICAgICAgICAgICAg\naWYgKG9iID09IG51bGwpCiAgICAgICAgICAgICAgICBvYiA9IG5ldyBOdWxs\nKCk7CgogICAgICAgICAgICAvLyBjYWNoZSB0aGUgcmVzdWx0CiAgICAgICAg\nICAgIF9yb3dzLnB1dChpLCBvYik7CgogICAgICAgICAgICAvLyBjaGVjayB0\nbyBzZWUgaWYgb3VyIG1hcCBpcyBmdWxsCiAgICAgICAgICAgIGNoZWNrQ29t\ncGxldGUoKTsKICAgICAgICAgICAgcmV0dXJuIG9iOwogICAgICAgIH0gY2F0\nY2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgY2xvc2Uo\nKTsKICAgICAgICAgICAgdGhyb3cgcmU7CiAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgY2xvc2UoKTsKICAgICAgICAgICAg\nX3JvcC5oYW5kbGVDaGVja2VkRXhjZXB0aW9uKGUpOwogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBD\naGVjayB0byBzZWUgaWYgdGhlIHNvZnQgbWFwIGlzIHRoZSBzYW1lIHNpemUg\nYXMgYWxsIHRoZQogICAgICogcm93cyBpbiB0aGUgUmVzdWx0OiBpZiBzbywg\nd2UgY29weSBvdmVyIHRoZSB2YWx1ZXMgdG8gYQogICAgICogaGFyZCByZWZl\ncmVuY2UgSGFzaFNldCBhbmQgY2xvc2UgdGhlIFJlc3VsdCBvYmplY3QgYXNz\nb2NpYXRlZCB3aXRoCiAgICAgKiB0aGlzIGVuZGVhdm91ci4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGNoZWNrQ29tcGxldGUoKSB7CiAgICAgICAgLy8g\nb25seSBjaGVjayBpZiB3ZSd2ZSBhY3R1YWxseSBnb3R0ZW4gdGhlIHNpemUg\nZm9yIHNvbWUgcmVhc29uIGFscmVhZHkKICAgICAgICBpZiAoX3NpemUgPT0g\nLTEgfHwgX3Jvd3Muc2l6ZSgpICE9IF9zaXplKQogICAgICAgICAgICByZXR1\ncm47CgogICAgICAgIE9iamVjdFtdIGZ1bGwgPSBuZXcgT2JqZWN0W19zaXpl\nXTsKICAgICAgICBpbnQgY291bnQgPSAwOwogICAgICAgIEludGVnZXIga2V5\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX3Jvd3Mua2V5U2V0KCku\naXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsgY291bnQrKykgewogICAgICAg\nICAgICBrZXkgPSAoSW50ZWdlcikgaXRyLm5leHQoKTsKICAgICAgICAgICAg\nZnVsbFtrZXkuaW50VmFsdWUoKV0gPSBfcm93cy5nZXQoa2V5KTsKICAgICAg\nICB9CgogICAgICAgIC8vIGRvdWJsZS1jaGVjaywgaW4gY2FzZSBhbnkgb2Yg\ndGhlIHNvZnQgcmVmZXJlbmNlcyB3ZXJlCiAgICAgICAgLy8gY2xlYW5lZCB1\ncCBiZXR3ZWVuIHRoZSB0aW1lIHdlIGNoZWNrZWQgdGhlIHNpemUgYW5kIHRo\nZQogICAgICAgIC8vIHRpbWUgd2UgY29tcGxldGVkIHRoZSBjb3B5IHRvIHRo\nZSBoYXJkIHJlZmVyZW5jZSBtYXAKICAgICAgICBpZiAoY291bnQgPT0gX3Np\nemUpIHsKICAgICAgICAgICAgX2Z1bGwgPSBmdWxsOwogICAgICAgICAgICBm\ncmVlKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBpbnQgc2l6ZSgp\nIHsKICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgaWYgKF9zaXplICE9\nIC0xKQogICAgICAgICAgICByZXR1cm4gX3NpemU7CiAgICAgICAgaWYgKF9m\ndWxsICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBfZnVsbC5sZW5ndGg7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3NpemUgPSBfcm9wLnNpemUo\nKTsKICAgICAgICAgICAgcmV0dXJuIF9zaXplOwogICAgICAgIH0gY2F0Y2gg\nKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgY2xvc2UoKTsK\nICAgICAgICAgICAgdGhyb3cgcmU7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgY2xvc2UoKTsKICAgICAgICAgICAgX3Jv\ncC5oYW5kbGVDaGVja2VkRXhjZXB0aW9uKGUpOwogICAgICAgICAgICByZXR1\ncm4gLTE7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBmcmVl\nKCkgewogICAgICAgIGlmIChfc3RhdGUgPT0gT1BFTikgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgX3JvcC5jbG9zZSgpOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB9CiAg\nICAgICAgICAgIF9yb3dzID0gbnVsbDsKICAgICAgICAgICAgX3N0YXRlID0g\nRlJFRUQ7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qgd3Jp\ndGVSZXBsYWNlKCkgdGhyb3dzIE9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKF9mdWxsICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\nZXcgTGlzdFJlc3VsdExpc3QoQXJyYXlzLmFzTGlzdChfZnVsbCkpOwogICAg\nICAgIEFycmF5TGlzdCBsaXN0ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRyID0gaXRlcmF0b3IoKTsgaXRyLmhhc05leHQo\nKTspCiAgICAgICAgICAgIGxpc3QuYWRkKGl0ci5uZXh0KCkpOwogICAgICAg\nIHJldHVybiBsaXN0OwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJp\nbmcoKSB7CiAgICAgICAgcmV0dXJuIGdldENsYXNzKCkuZ2V0TmFtZSgpCiAg\nICAgICAgICAgICsgIjsgaWRlbnRpdHk6ICIgKyBTeXN0ZW0uaWRlbnRpdHlI\nYXNoQ29kZSh0aGlzKQogICAgICAgICAgICArICI7IGNhY2hlZDogIiArIF9y\nb3dzLnNpemUoKQogICAgICAgICAgICArICI7IHJlcXVlc3RzOiAiICsgX3Jl\ncXVlc3RzOwogICAgfQoKICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7CiAg\nICAgICAgLy8gc3VwZXJjbGFzcyB0cmllcyB0byB0cmF2ZXJzZXMgZW50aXJl\nIGxpc3QgZm9yIGhhc2hjb2RlCiAgICAgICAgcmV0dXJuIFN5c3RlbS5pZGVu\ndGl0eUhhc2hDb2RlKHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICAvLyBzdXBlcmNsYXNz\nIHRyaWVzIHRvIHRyYXZlcnNlIGVudGlyZSBsaXN0IGZvciBlcXVhbGl0eQog\nICAgICAgIHJldHVybiBvdGhlciA9PSB0aGlzOwogICAgfQoKICAgIC8qKgog\nICAgICogVXNlZCB0byByZXByZXNlbnQgbnVsbHMgaW4gdGhlIHJlc3VsdCBs\naXN0LiBDYW4ndCB1c2UgYSBzaW5nbGV0b24KICAgICAqIHBhdHRlcm4sIGJl\nY2F1c2UgdGhlbiB0aGVyZSB3aWxsIGFsd2F5cyBiZSBhIGhhcmQgcmVmIHRv\nIGFsbCB0aGUKICAgICAqIG51bGxzLCBhbmQgdGhleSdsbCBuZXZlciBnZXQg\nR0MnZDsgdGhpcyBpcyBiYWQgaW4gdGhlIHVubGlrZWx5CiAgICAgKiBldmVu\ndCBvZiBhIGh1Z2UgcmVzdWx0IHNldCB3aXRoIGxvdHMgb2YgbnVsbHMuCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIE51bGwgewoKICAgIH0K\nfQoK\n","encoding":"base64"}

