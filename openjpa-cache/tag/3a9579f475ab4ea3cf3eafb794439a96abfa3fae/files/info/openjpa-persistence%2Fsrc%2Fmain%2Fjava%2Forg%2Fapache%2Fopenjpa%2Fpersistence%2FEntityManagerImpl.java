{"sha":"b71a36d3b80a49603c25b4247c59a63e24c4e1fe","node_id":"MDQ6QmxvYjIwNjM2NDpiNzFhMzZkM2I4MGE0OTYwM2MyNWI0MjQ3YzU5YTYzZTI0YzRlMWZl","size":60871,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b71a36d3b80a49603c25b4247c59a63e24c4e1fe","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5FeHRl\ncm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0OwppbXBv\ncnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLk9iamVjdFN0cmVhbUNsYXNzOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQXJyYXk7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5FbnVtU2V0OwppbXBvcnQgamF2YS51dGlsLklkZW50aXR5SGFz\naE1hcDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwu\nU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkNhY2hlUmV0cmlldmVN\nb2RlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuQ2FjaGVTdG9yZU1vZGU7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuRmx1c2hNb2RlVHlwZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkxvY2tNb2RlVHlwZTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLlF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHlw\nZWRRdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNy\naXRlcmlhUXVlcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJp\nYS5QYXJhbWV0ZXJFeHByZXNzaW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UubWV0YW1vZGVsLk1ldGFtb2RlbDsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLkNvbXBhdGliaWxpdHk7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5lZS5NYW5hZ2VkUnVudGltZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5lbmhhbmNlLlBDRW5oYW5jZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QQ1JlZ2lzdHJ5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUmVmbGVjdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RCcm9rZXJGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkRhdGFDYWNoZVJldHJp\nZXZlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGF0\nYUNhY2hlU3RvcmVNb2RlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5EZWxlZ2F0aW5nQnJva2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLkZpbmRDYWxsYmFja3M7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wQ2FsbGJhY2tzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1\nZXJ5Q2FjaGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5Rmx1c2hNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnlMYW5ndWFnZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlNlcTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nanBxbC5KUFFMUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkNsb3NlYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5D\nbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLlF1ZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5TZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNyaXRlcmlhQnVpbGRlckltcGw7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWEu\nT3BlbkpQQUNyaXRlcmlhQnVpbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcGVuSlBBQ3JpdGVyaWFRdWVy\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS52YWxp\nZGF0aW9uLlZhbGlkYXRpb25VdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3I7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKaW1wb3J0IHNl\ncnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHtA\nbGluayBFbnRpdHlNYW5hZ2VyfSBpbnRlcmZhY2UuCiAqCiAqIEBhdXRob3Ig\nUGF0cmljayBMaW5za2V5CiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBFbnRpdHlNYW5hZ2VySW1wbAogICAg\naW1wbGVtZW50cyBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSwgRXh0ZXJuYWxp\nemFibGUsCiAgICBGaW5kQ2FsbGJhY2tzLCBPcENhbGxiYWNrcywgQ2xvc2Vh\nYmxlLCBPcGVuSlBBRW50aXR5VHJhbnNhY3Rpb24gewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBh\nY2thZ2UoRW50aXR5TWFuYWdlckltcGwuY2xhc3MpOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgT2JqZWN0W10gRU1QVFlfT0JKRUNUUyA9IG5ldyBPYmpl\nY3RbMF07CiAgICAKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBH\nRVRfTE9DS19NT0RFID0gImdldExvY2tNb2RlIjsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIFN0cmluZyBMT0NLID0gImxvY2siOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgU3RyaW5nIFJFRlJFU0ggPSAicmVmcmVzaCI7CgogICAg\ncHJpdmF0ZSBEZWxlZ2F0aW5nQnJva2VyIF9icm9rZXI7CiAgICBwcml2YXRl\nIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBfZW1mOwogICAgcHJpdmF0ZSBN\nYXA8RmV0Y2hDb25maWd1cmF0aW9uLEZldGNoUGxhbj4gX3BsYW5zID0gbmV3\nIElkZW50aXR5SGFzaE1hcDxGZXRjaENvbmZpZ3VyYXRpb24sRmV0Y2hQbGFu\nPigxKTsKICAgIHByb3RlY3RlZCBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRv\nciBfcmV0ID0gUGVyc2lzdGVuY2VFeGNlcHRpb25zLmdldFJvbGxiYWNrVHJh\nbnNsYXRvcih0aGlzKTsKCiAgICBwdWJsaWMgRW50aXR5TWFuYWdlckltcGwo\nKSB7CiAgICAgICAgLy8gZm9yIEV4dGVybmFsaXphYmxlCiAgICB9CgogICAg\nLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGZhY3RvcnkgYW5kIGRl\nbGVnYXRlLgogICAgICovCiAgICBwdWJsaWMgRW50aXR5TWFuYWdlckltcGwo\nRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsIGZhY3RvcnksIEJyb2tlciBicm9r\nZXIpIHsKICAgICAgICBpbml0aWFsaXplKGZhY3RvcnksIGJyb2tlcik7CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIGluaXRpYWxpemUoRW50aXR5TWFuYWdl\nckZhY3RvcnlJbXBsIGZhY3RvcnksIEJyb2tlciBicm9rZXIpIHsKICAgICAg\nICBfZW1mID0gZmFjdG9yeTsKICAgICAgICBfYnJva2VyID0gbmV3IERlbGVn\nYXRpbmdCcm9rZXIoYnJva2VyLCBfcmV0KTsKICAgICAgICBfYnJva2VyLnNl\ndEltcGxpY2l0QmVoYXZpb3IodGhpcywgX3JldCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBCcm9rZXIgZGVsZWdhdGUuCiAgICAgKi8KICAgIHB1YmxpYyBC\ncm9rZXIgZ2V0QnJva2VyKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdl\ndERlbGVnYXRlKCk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBnZXRFbnRpdHlNYW5hZ2VyRmFjdG9yeSgpIHsKICAg\nICAgICByZXR1cm4gX2VtZjsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUNv\nbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCk7CiAgICB9CgogICAgcHVi\nbGljIEZldGNoUGxhbiBnZXRGZXRjaFBsYW4oKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgRmV0Y2hDb25maWd1cmF0aW9uIGZj\nID0gX2Jyb2tlci5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAg\nICAgRmV0Y2hQbGFuIGZwID0gX3BsYW5zLmdldChmYyk7CiAgICAgICAgICAg\nIGlmIChmcCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBmcCA9IF9lbWYu\ndG9GZXRjaFBsYW4oX2Jyb2tlciwgZmMpOwogICAgICAgICAgICAgICAgX3Bs\nYW5zLnB1dChmYywgZnApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJl\ndHVybiBmcDsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfYnJv\na2VyLnVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgRmV0\nY2hQbGFuIHB1c2hGZXRjaFBsYW4oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrKCk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5wdXNoRmV0Y2hDb25maWd1cmF0\naW9uKCk7CiAgICAgICAgICAgIHJldHVybiBnZXRGZXRjaFBsYW4oKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfYnJva2VyLnVubG9jaygp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwb3BGZXRjaFBs\nYW4oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nX2Jyb2tlci5wb3BGZXRjaENvbmZpZ3VyYXRpb24oKTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICBfYnJva2VyLnVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgQ29ubmVjdGlvblJldGFpbk1vZGUgZ2V0\nQ29ubmVjdGlvblJldGFpbk1vZGUoKSB7CiAgICAgICAgcmV0dXJuIENvbm5l\nY3Rpb25SZXRhaW5Nb2RlLmZyb21LZXJuZWxDb25zdGFudCgKICAgICAgICAg\nICAgX2Jyb2tlci5nZXRDb25uZWN0aW9uUmV0YWluTW9kZSgpKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zYWN0aW9uTWFuYWdlZCgpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5pc01hbmFnZWQoKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc01hbmFnZWQoKSB7CiAgICAgICAgcmV0dXJu\nIF9icm9rZXIuaXNNYW5hZ2VkKCk7CiAgICB9CgogICAgcHVibGljIE1hbmFn\nZWRSdW50aW1lIGdldE1hbmFnZWRSdW50aW1lKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldE1hbmFnZWRSdW50aW1lKCk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0U3luY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb25zKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldFN5bmNXaXRoTWFuYWdlZFRy\nYW5zYWN0aW9ucygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFN5bmNX\naXRoTWFuYWdlZFRyYW5zYWN0aW9ucyhib29sZWFuIHN5bmMpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndFN5bmNXaXRoTWFuYWdlZFRyYW5zYWN0aW9ucyhzeW5jKTsKICAgIH0KCiAg\nICBwdWJsaWMgQ2xhc3NMb2FkZXIgZ2V0Q2xhc3NMb2FkZXIoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKTsKICAgIH0KCiAg\nICBwdWJsaWMgU3RyaW5nIGdldENvbm5lY3Rpb25Vc2VyTmFtZSgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRDb25uZWN0aW9uVXNlck5hbWUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldENvbm5lY3Rpb25QYXNzd29y\nZCgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDb25uZWN0aW9uUGFz\nc3dvcmQoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRNdWx0aXRo\ncmVhZGVkKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE11bHRpdGhy\nZWFkZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRNdWx0aXRocmVh\nZGVkKGJvb2xlYW4gbXVsdGl0aHJlYWRlZCkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0TXVsdGl0aHJl\nYWRlZChtdWx0aXRocmVhZGVkKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBnZXRJZ25vcmVDaGFuZ2VzKCkgewogICAgICAgIHJldHVybiBfYnJva2Vy\nLmdldElnbm9yZUNoYW5nZXMoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXRJZ25vcmVDaGFuZ2VzKGJvb2xlYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRJZ25vcmVD\naGFuZ2VzKHZhbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0Tm9u\ndHJhbnNhY3Rpb25hbFJlYWQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nZ2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXROb250cmFuc2FjdGlvbmFsUmVhZChib29sZWFuIHZhbCkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQodmFsKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXROb250cmFuc2FjdGlvbmFsV3JpdGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRl\nKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25h\nbFdyaXRlKGJvb2xlYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXROb250cmFuc2FjdGlvbmFs\nV3JpdGUodmFsKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRPcHRp\nbWlzdGljKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE9wdGltaXN0\naWMoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRPcHRpbWlzdGljKGJv\nb2xlYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5zZXRPcHRpbWlzdGljKHZhbCk7CiAgICB9Cgog\nICAgcHVibGljIFJlc3RvcmVTdGF0ZVR5cGUgZ2V0UmVzdG9yZVN0YXRlKCkg\newogICAgICAgIHJldHVybiBSZXN0b3JlU3RhdGVUeXBlLmZyb21LZXJuZWxD\nb25zdGFudChfYnJva2VyLmdldFJlc3RvcmVTdGF0ZSgpKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRSZXN0b3JlU3RhdGUoUmVzdG9yZVN0YXRlVHlw\nZSB2YWwpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnNldFJlc3RvcmVTdGF0ZSh2YWwudG9LZXJuZWxDb25z\ndGFudCgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSZXN0b3JlU3Rh\ndGUoaW50IHJlc3RvcmUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnNldFJlc3RvcmVTdGF0ZShyZXN0b3Jl\nKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRSZXRhaW5TdGF0ZSgp\nIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRSZXRhaW5TdGF0ZSgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFJldGFpblN0YXRlKGJvb2xlYW4g\ndmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5zZXRSZXRhaW5TdGF0ZSh2YWwpOwogICAgfQoKICAgIHB1\nYmxpYyBBdXRvQ2xlYXJUeXBlIGdldEF1dG9DbGVhcigpIHsKICAgICAgICBy\nZXR1cm4gQXV0b0NsZWFyVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tl\nci5nZXRBdXRvQ2xlYXIoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nQXV0b0NsZWFyKEF1dG9DbGVhclR5cGUgdmFsKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvQ2xl\nYXIodmFsLnRvS2VybmVsQ29uc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0QXV0b0NsZWFyKGludCBhdXRvQ2xlYXIpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1\ndG9DbGVhcihhdXRvQ2xlYXIpOwogICAgfQoKICAgIHB1YmxpYyBEZXRhY2hT\ndGF0ZVR5cGUgZ2V0RGV0YWNoU3RhdGUoKSB7CiAgICAgICAgcmV0dXJuIERl\ndGFjaFN0YXRlVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXRE\nZXRhY2hTdGF0ZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXREZXRh\nY2hTdGF0ZShEZXRhY2hTdGF0ZVR5cGUgdHlwZSkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0RGV0YWNo\nU3RhdGUodHlwZS50b0tlcm5lbENvbnN0YW50KCkpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldERldGFjaFN0YXRlKGludCBkZXRhY2gpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndERldGFjaFN0YXRlKGRldGFjaCk7CiAgICB9CgogICAgcHVibGljIEVudW1T\nZXQ8QXV0b0RldGFjaFR5cGU+IGdldEF1dG9EZXRhY2goKSB7CiAgICAgICAg\ncmV0dXJuIEF1dG9EZXRhY2hUeXBlLnRvRW51bVNldChfYnJva2VyLmdldEF1\ndG9EZXRhY2goKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0Rl\ndGFjaChBdXRvRGV0YWNoVHlwZSBmbGFnKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNo\nKEF1dG9EZXRhY2hUeXBlLmZyb21FbnVtU2V0KEVudW1TZXQub2YoZmxhZykp\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRvRGV0YWNoKEVudW1T\nZXQ8QXV0b0RldGFjaFR5cGU+IGZsYWdzKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNo\nKEF1dG9EZXRhY2hUeXBlLmZyb21FbnVtU2V0KGZsYWdzKSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChpbnQgYXV0b0RldGFjaEZs\nYWdzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKGF1dG9EZXRhY2hGbGFncyk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChBdXRvRGV0YWNo\nVHlwZSB2YWx1ZSwgYm9vbGVhbiBvbikgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChB\ndXRvRGV0YWNoVHlwZS5mcm9tRW51bVNldChFbnVtU2V0Lm9mKHZhbHVlKSks\nb24pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2goaW50\nIGZsYWcsIGJvb2xlYW4gb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1dG9EZXRhY2goZmxhZywg\nb24pOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGdldEV2aWN0RnJvbVN0\nb3JlQ2FjaGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0RXZpY3RG\ncm9tRGF0YUNhY2hlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RXZp\nY3RGcm9tU3RvcmVDYWNoZShib29sZWFuIGV2aWN0KSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRFdmlj\ndEZyb21EYXRhQ2FjaGUoZXZpY3QpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGdldFBvcHVsYXRlU3RvcmVDYWNoZSgpIHsKICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXRQb3B1bGF0ZURhdGFDYWNoZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldFBvcHVsYXRlU3RvcmVDYWNoZShib29sZWFuIGNhY2hl\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRQb3B1bGF0ZURhdGFDYWNoZShjYWNoZSk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gaXNUcmFja0NoYW5nZXNCeVR5cGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuaXNUcmFja0NoYW5nZXNCeVR5cGUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFja0NoYW5nZXNCeVR5cGUo\nYm9vbGVhbiB0cmFja0J5VHlwZSkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0VHJhY2tDaGFuZ2VzQnlU\neXBlKHRyYWNrQnlUeXBlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc0xhcmdlVHJhbnNhY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIGlzVHJhY2tD\naGFuZ2VzQnlUeXBlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TGFy\nZ2VUcmFuc2FjdGlvbihib29sZWFuIHZhbHVlKSB7CiAgICAgICAgc2V0VHJh\nY2tDaGFuZ2VzQnlUeXBlKHZhbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IGdldFVzZXJPYmplY3QoT2JqZWN0IGtleSkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldFVzZXJPYmplY3Qoa2V5KTsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IHB1dFVzZXJPYmplY3QoT2JqZWN0IGtleSwgT2JqZWN0IHZh\nbCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIHJldHVybiBfYnJva2VyLnB1dFVzZXJPYmplY3Qoa2V5LCB2YWwpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoT2Jq\nZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgX2Jyb2tlci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKGxp\nc3RlbmVyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVUcmFuc2Fj\ndGlvbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVtb3ZlVHJh\nbnNhY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGlj\nIEVudW1TZXQ8Q2FsbGJhY2tNb2RlPiBnZXRUcmFuc2FjdGlvbkxpc3RlbmVy\nQ2FsbGJhY2tNb2RlcygpIHsKICAgICAgICByZXR1cm4gQ2FsbGJhY2tNb2Rl\nLnRvRW51bVNldCgKICAgICAgICAgICAgX2Jyb2tlci5nZXRUcmFuc2FjdGlv\nbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKCkpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoQ2FsbGJh\nY2tNb2RlIG1vZGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxs\nYmFja01vZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNl\ndChFbnVtU2V0Lm9mKG1vZGUpKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZShFbnVtU2V0PENh\nbGxiYWNrTW9kZT4gbW9kZXMpewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0VHJhbnNhY3Rpb25MaXN0ZW5l\nckNhbGxiYWNrTW9kZSgKICAgICAgICAgICAgQ2FsbGJhY2tNb2RlLmZyb21F\nbnVtU2V0KG1vZGVzKSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRUcmFu\nc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFuc2FjdGlvbkxpc3Rl\nbmVyQ2FsbGJhY2tNb2RlKGludCBjYWxsYmFja01vZGUpIHsKICAgICAgICB0\naHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRMaWZlY3ljbGVMaXN0ZW5lcihPYmpl\nY3QgbGlzdGVuZXIsIENsYXNzLi4uIGNsYXNzZXMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmFkZExpZmVj\neWNsZUxpc3RlbmVyKGxpc3RlbmVyLCBjbGFzc2VzKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByZW1vdmVMaWZlY3ljbGVMaXN0ZW5lcihPYmplY3QgbGlz\ndGVuZXIpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnJlbW92ZUxpZmVjeWNsZUxpc3RlbmVyKGxpc3RlbmVy\nKTsKICAgIH0KCiAgICBwdWJsaWMgRW51bVNldDxDYWxsYmFja01vZGU+IGdl\ndExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlcygpIHsKICAgICAgICBy\nZXR1cm4gQ2FsbGJhY2tNb2RlLnRvRW51bVNldCgKICAgICAgICAgICAgX2Jy\nb2tlci5nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxi\nYWNrTW9kZShDYWxsYmFja01vZGUgbW9kZSkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0TGlmZWN5Y2xl\nTGlzdGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9k\nZS5mcm9tRW51bVNldChFbnVtU2V0Lm9mKG1vZGUpKSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUo\nRW51bVNldDxDYWxsYmFja01vZGU+IG1vZGVzKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRMaWZlY3lj\nbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgKICAgICAgICAgICAgQ2FsbGJhY2tN\nb2RlLmZyb21FbnVtU2V0KG1vZGVzKSk7CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgpIHsKICAgICAg\nICByZXR1cm4gX2Jyb2tlci5nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNr\nTW9kZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExpZmVjeWNsZUxp\nc3RlbmVyQ2FsbGJhY2tNb2RlKGludCBjYWxsYmFja01vZGUpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKGNhbGxiYWNrTW9kZSk7\nCiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAg\nICBwdWJsaWMgPFQ+IFQgZ2V0UmVmZXJlbmNlKENsYXNzPFQ+IGNscywgT2Jq\nZWN0IG9pZCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIG9pZCA9IF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQpOwog\nICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5maW5kKG9pZCwgZmFsc2UsIHRo\naXMpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQi\nKQogICAgcHVibGljIDxUPiBUIGZpbmQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qg\nb2lkKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgaWYgKG9pZCA9PSBudWxsKQogICAgICAgIAlyZXR1cm4gbnVsbDsKICAg\nICAgICBvaWQgPSBfYnJva2VyLm5ld09iamVjdElkKGNscywgb2lkKTsKICAg\nICAgICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChvaWQsIHRydWUsIHRoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywg\nT2JqZWN0IG9pZCwgTG9ja01vZGVUeXBlIG1vZGUpIHsKICAgICAgICByZXR1\ncm4gZmluZChjbHMsIG9pZCwgbW9kZSwgbnVsbCk7CiAgICB9CgogICAgcHVi\nbGljIDxUPiBUIGZpbmQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lkLCAKICAg\nICAgICBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXMpewogICAgICAg\nIHJldHVybiBmaW5kKGNscywgb2lkLCBudWxsLCBwcm9wZXJ0aWVzKTsKICAg\nIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1\nYmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCwgTG9j\na01vZGVUeXBlIG1vZGUsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGll\ncykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIGNvbmZpZ3VyZUN1cnJlbnRDYWNoZU1vZGVzKGdldEZldGNoUGxhbigpLCBw\ncm9wZXJ0aWVzKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFu\nKHB1c2hGZXRjaFBsYW4oKSwgcHJvcGVydGllcywgbW9kZSwgdHJ1ZSk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgb2lkID0gX2Jyb2tlci5uZXdPYmpl\nY3RJZChjbHMsIG9pZCk7CiAgICAgICAgICAgIHJldHVybiAoVCkgX2Jyb2tl\nci5maW5kKG9pZCwgdHJ1ZSwgdGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgcG9wRmV0Y2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGlj\nIDxUPiBUW10gZmluZEFsbChDbGFzczxUPiBjbHMsIE9iamVjdC4uLiBvaWRz\nKSB7CiAgICAgICAgaWYgKG9pZHMubGVuZ3RoID09IDApCiAgICAgICAgICAg\nIHJldHVybiAoVFtdKSBBcnJheS5uZXdJbnN0YW5jZShjbHMsIDApOwogICAg\nICAgIENvbGxlY3Rpb248VD4gcmV0ID0gZmluZEFsbChjbHMsIEFycmF5cy5h\nc0xpc3Qob2lkcykpOwogICAgICAgIHJldHVybiByZXQudG9BcnJheSgoVFtd\nKSBBcnJheS5uZXdJbnN0YW5jZShjbHMsIHJldC5zaXplKCkpKTsKICAgIH0K\nCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1Ymxp\nYyA8VD4gQ29sbGVjdGlvbjxUPiBmaW5kQWxsKGZpbmFsIENsYXNzPFQ+IGNs\ncywgQ29sbGVjdGlvbiBvaWRzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgT2JqZWN0W10gb2JqcyA9IF9icm9rZXIuZmlu\nZEFsbChvaWRzLCB0cnVlLCBuZXcgRmluZENhbGxiYWNrcygpIHsKICAgICAg\nICAgICAgcHVibGljIE9iamVjdCBwcm9jZXNzQXJndW1lbnQoT2JqZWN0IG9p\nZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9icm9rZXIubmV3T2JqZWN0\nSWQoY2xzLCBvaWQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgT2JqZWN0IHByb2Nlc3NSZXR1cm4oT2JqZWN0IG9pZCwgT3BlbkpQQVN0\nYXRlTWFuYWdlciBzbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIEVudGl0\neU1hbmFnZXJJbXBsLnRoaXMucHJvY2Vzc1JldHVybihvaWQsIHNtKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHJldHVybiAoQ29sbGVj\ndGlvbjxUPikgQXJyYXlzLmFzTGlzdChvYmpzKTsKICAgIH0KCiAgICBAU3Vw\ncHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBm\naW5kQ2FjaGVkKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkg\nX2Jyb2tlci5maW5kQ2FjaGVkKF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBv\naWQpLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0T2JqZWN0\nSWRDbGFzcyhDbGFzcyBjbHMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBKUEFGYWNhZGVIZWxwZXIu\nZnJvbU9wZW5KUEFPYmplY3RJZENsYXNzCiAgICAgICAgICAgICAgICAoX2Jy\nb2tlci5nZXRPYmplY3RJZFR5cGUoY2xzKSk7CiAgICB9CgogICAgcHVibGlj\nIE9wZW5KUEFFbnRpdHlUcmFuc2FjdGlvbiBnZXRUcmFuc2FjdGlvbigpIHsK\nICAgICAgICBpZiAoX2Jyb2tlci5pc01hbmFnZWQoKSkKICAgICAgICAgICAg\ndGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiZ2V0\nLW1hbmFnZWQtdHJhbnMiKSwKICAgICAgICAgICAgICAgIG51bGwsIG51bGws\nIGZhbHNlKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBqb2luVHJhbnNhY3Rpb24oKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgaWYgKCFfYnJva2VyLnN5bmNXaXRo\nTWFuYWdlZFRyYW5zYWN0aW9uKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBU\ncmFuc2FjdGlvblJlcXVpcmVkRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAg\nICAgICAgICAoIm5vLW1hbmFnZWQtdHJhbnMiKSwgbnVsbCwgbnVsbCwgZmFs\nc2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGJlZ2luKCkgewogICAgICAg\nIF9icm9rZXIuYmVnaW4oKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb21t\naXQoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5jb21t\naXQoKTsKICAgICAgICB9IGNhdGNoIChSb2xsYmFja0V4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfSBjYXRjaCAoSWxsZWdh\nbFN0YXRlRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgZTsKICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgIAkvLyBQZXIg\nSlBBIDIuMCBzcGVjLCBpZiB0aGUgZXhjZXB0aW9uIHdhcyBkdWUgdG8gYSBK\nU1ItMzAzIAogICAgICAgICAgICAvLyBjb25zdHJhaW50IHZpb2xhdGlvbiwg\ndGhlIENvbnN0cmFpbnRWaW9sYXRpb25FeGNlcHRpb24gc2hvdWxkIGJlIAog\nICAgICAgICAgICAvLyB0aHJvd24uICBTaW5jZSBKU1ItMzAzIGlzIG9wdGlv\nbmFsLCB0aGUgY2FzdCB0byBSdW50aW1lRXhjZXB0aW9uIAogICAgICAgICAg\nICAvLyBwcmV2ZW50cyB0aGUgaW50cm9kdWN0aW9uIG9mIGEgcnVudGltZSBk\nZXBlbmRlbmN5IG9uIHRoZSBCViBBUEkuCiAgICAgICAgICAgIGlmIChWYWxp\nZGF0aW9uVXRpbHMuaXNDb25zdHJhaW50VmlvbGF0aW9uRXhjZXB0aW9uKGUp\nKQogICAgICAgICAgICAgICAgdGhyb3cgKFJ1bnRpbWVFeGNlcHRpb24pZTsK\nICAgICAgICAgICAgLy8gUm9sbGJhY2tFeGNlcHRpb25zIGFyZSBzcGVjaWFs\nIGFuZCBhcmVuJ3QgaGFuZGxlZCBieSB0aGUKICAgICAgICAgICAgLy8gbm9y\nbWFsIGV4Y2VwdGlvbiB0cmFuc2xhdG9yLCBzaW5jZSB0aGUgc3BlYyBzYXlz\nIHRoZXkKICAgICAgICAgICAgLy8gc2hvdWxkIGJlIHRocm93biB3aGVuZXZl\nciB0aGUgY29tbWl0IGZhaWxzIGZvciBhbnkgcmVhc29uIGF0CiAgICAgICAg\nICAgIC8vIGFsbCwgd2hlcmFzIHRoZSBleGNlcHRpb24gdHJhbnNsYXRvciBo\nYW5kbGVzIGV4Y2VwdGlvbnMgdGhhdAogICAgICAgICAgICAvLyBhcmUgY2F1\nc2VkIGZvciBzcGVjaWZpYyByZWFzb25zCiAgICAgICAgICAgIHRocm93IG5l\ndyBSb2xsYmFja0V4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIHZvaWQgcm9sbGJhY2soKSB7CiAgICAgICAgX2Jyb2tlci5yb2xs\nYmFjaygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvbW1pdEFuZFJlc3Vt\nZSgpIHsKICAgICAgICBfYnJva2VyLmNvbW1pdEFuZFJlc3VtZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrQW5kUmVzdW1lKCkgewogICAg\nICAgIF9icm9rZXIucm9sbGJhY2tBbmRSZXN1bWUoKTsKICAgIH0KCiAgICBw\ndWJsaWMgVGhyb3dhYmxlIGdldFJvbGxiYWNrQ2F1c2UoKSB7CiAgICAgICAg\naWYgKCFpc0FjdGl2ZSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdh\nbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby10cmFuc2FjdGlvbiIpCiAg\nICAgICAgICAgICAgICAuZ2V0TWVzc2FnZSgpKTsKCiAgICAgICAgcmV0dXJu\nIF9icm9rZXIuZ2V0Um9sbGJhY2tDYXVzZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGdldFJvbGxiYWNrT25seSgpIHsKICAgICAgICBpZiAoIWlz\nQWN0aXZlKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVF\neGNlcHRpb24oX2xvYy5nZXQoIm5vLXRyYW5zYWN0aW9uIikKICAgICAgICAg\nICAgICAgIC5nZXRNZXNzYWdlKCkpOwoKICAgICAgICByZXR1cm4gX2Jyb2tl\nci5nZXRSb2xsYmFja09ubHkoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXRSb2xsYmFja09ubHkoKSB7CiAgICAgICAgX2Jyb2tlci5zZXRSb2xsYmFj\na09ubHkoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSb2xsYmFja09u\nbHkoVGhyb3dhYmxlIGNhdXNlKSB7CiAgICAgICAgX2Jyb2tlci5zZXRSb2xs\nYmFja09ubHkoY2F1c2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNh\ndmVwb2ludChTdHJpbmcgbmFtZSkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0U2F2ZXBvaW50KG5hbWUp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrVG9TYXZlcG9pbnQo\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5yb2xsYmFja1RvU2F2ZXBvaW50KCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcm9sbGJhY2tUb1NhdmVwb2ludChTdHJpbmcgbmFtZSkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIucm9sbGJhY2tUb1NhdmVwb2ludChuYW1lKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZWxlYXNlU2F2ZXBvaW50KCkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVsZWFzZVNhdmVw\nb2ludCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VTYXZlcG9p\nbnQoU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQobmFtZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgZmx1c2goKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRP\ncGVuKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlv\nbigpOwogICAgICAgIF9icm9rZXIuZmx1c2goKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBwcmVGbHVzaCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnByZUZsdXNoKCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdmFsaWRhdGVDaGFuZ2VzKCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIudmFsaWRh\ndGVDaGFuZ2VzKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNBY3Rp\ndmUoKSB7CiAgICAgICAgcmV0dXJuIGlzT3BlbigpICYmIF9icm9rZXIuaXNB\nY3RpdmUoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N0b3JlQWN0\naXZlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmlzU3RvcmVBY3RpdmUo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBiZWdpblN0b3JlKCkgewogICAg\nICAgIF9icm9rZXIuYmVnaW5TdG9yZSgpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGNvbnRhaW5zKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBpZiAoZW50aXR5ID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIoZW50\naXR5KTsKICAgICAgICBpZiAoc20gPT0gbnVsbAogICAgICAgICAgICAmJiAh\nSW1wbEhlbHBlci5pc01hbmFnZWRUeXBlKGdldENvbmZpZ3VyYXRpb24oKSwg\nZW50aXR5LmdldENsYXNzKCkpKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJn\ndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1lbnRpdHkiLAogICAgICAg\nICAgICAgICAgZW50aXR5LmdldENsYXNzKCkpLCBudWxsLCBudWxsLCB0cnVl\nKTsKICAgICAgICByZXR1cm4gc20gIT0gbnVsbCAmJiAhc20uaXNEZWxldGVk\nKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNBbGwoT2Jq\nZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgZm9yIChPYmplY3QgZW50aXR5\nIDogZW50aXRpZXMpCiAgICAgICAgICAgIGlmICghY29udGFpbnMoZW50aXR5\nKSkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0Fs\nbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgZm9yIChPYmplY3Qg\nZW50aXR5IDogZW50aXRpZXMpCiAgICAgICAgICAgIGlmICghY29udGFpbnMo\nZW50aXR5KSkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwZXJzaXN0\nKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnBlcnNpc3QoZW50aXR5LCB0aGlzKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwZXJzaXN0QWxsKE9iamVjdC4uLiBl\nbnRpdGllcykgewogICAgICAgIHBlcnNpc3RBbGwoQXJyYXlzLmFzTGlzdChl\nbnRpdGllcykpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBlcnNpc3RBbGwo\nQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucGVyc2lzdEFsbChlbnRpdGll\ncywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlKE9iamVj\ndCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLmRlbGV0ZShlbnRpdHksIHRoaXMpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbChPYmplY3QuLi4gZW50aXRpZXMp\nIHsKICAgICAgICByZW1vdmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbChDb2xsZWN0aW9u\nIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5kZWxldGVBbGwoZW50aXRpZXMsIHRoaXMpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbGVhc2UoT2JqZWN0IGVudGl0eSkg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIucmVsZWFzZShlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHJlbGVhc2VBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\ncmVsZWFzZUFsbChlbnRpdGllcywgdGhpcyk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgcmVsZWFzZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAg\nICByZWxlYXNlQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHkpIHsKICAg\nICAgICByZWZyZXNoKGVudGl0eSwgbnVsbCwgbnVsbCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgcmVmcmVzaChPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5\ncGUgbW9kZSkgewogICAgICAgIHJlZnJlc2goZW50aXR5LCBtb2RlLCBudWxs\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRp\ndHksIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAgICAg\nIHJlZnJlc2goZW50aXR5LCBudWxsLCBwcm9wZXJ0aWVzKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHksIExvY2tNb2Rl\nVHlwZSBtb2RlLCBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXMpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBhc3Nl\ncnRWYWxpZEF0dGNoZWRFbnRpdHkoUkVGUkVTSCwgZW50aXR5KTsKCiAgICAg\nICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9wZXJhdGlvbigpOwogICAgICAgIGNv\nbmZpZ3VyZUN1cnJlbnRGZXRjaFBsYW4ocHVzaEZldGNoUGxhbigpLCBwcm9w\nZXJ0aWVzLCBtb2RlLCB0cnVlKTsKICAgICAgICBEYXRhQ2FjaGVSZXRyaWV2\nZU1vZGUgcm1vZGUgPSBnZXRGZXRjaFBsYW4oKS5nZXRDYWNoZVJldHJpZXZl\nTW9kZSgpOwogICAgICAgIGlmIChEYXRhQ2FjaGVSZXRyaWV2ZU1vZGUuVVNF\nLmVxdWFscyhybW9kZSkgfHwgcm1vZGUgPT0gbnVsbCkgewogICAgICAgICAg\nICBnZXRGZXRjaFBsYW4oKS5zZXRDYWNoZVJldHJpZXZlTW9kZShEYXRhQ2Fj\naGVSZXRyaWV2ZU1vZGUuQllQQVNTKTsKICAgICAgICAgICAgaWYgKHJtb2Rl\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIExvZyBsb2cgPSBfYnJva2Vy\nLmdldENvbmZpZ3VyYXRpb24oKS5nZXRDb25maWd1cmF0aW9uTG9nKCk7CiAg\nICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FjaGUtcmV0cmll\ndmUtb3ZlcnJpZGUiLCBFeGNlcHRpb25zLnRvU3RyaW5nKGVudGl0eSkpKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgfQogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIucmVmcmVzaChlbnRpdHks\nIHRoaXMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHBvcEZl\ndGNoUGxhbigpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZWZyZXNoQWxsKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuYXNzZXJ0V3JpdGVPcGVyYXRpb24oKTsKICAg\nICAgICBfYnJva2VyLnJlZnJlc2hBbGwoX2Jyb2tlci5nZXRUcmFuc2FjdGlv\nbmFsT2JqZWN0cygpLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZWZyZXNoQWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmFzc2VydFdy\naXRlT3BlcmF0aW9uKCk7CiAgICAgICAgX2Jyb2tlci5yZWZyZXNoQWxsKGVu\ndGl0aWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWZyZXNo\nQWxsKE9iamVjdC4uLiBlbnRpdGllcykgewogICAgICAgIHJlZnJlc2hBbGwo\nQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHJldHJpZXZlKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJldHJpZXZlKGVu\ndGl0eSwgdHJ1ZSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmV0\ncmlldmVBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmV0cmlldmVB\nbGwoZW50aXRpZXMsIHRydWUsIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHJldHJpZXZlQWxsKE9iamVjdC4uLiBlbnRpdGllcykgewogICAgICAg\nIHJldHJpZXZlQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBldmljdChPYmplY3QgZW50aXR5KSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5l\ndmljdChlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2\naWN0QWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmV2aWN0QWxsKGVu\ndGl0aWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBldmljdEFs\nbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICBldmljdEFsbChBcnJh\neXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nZXZpY3RBbGwoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5ldmljdEFsbCh0aGlzKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBldmljdEFsbChDbGFzcyBjbHMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmV2aWN0QWxs\nKF9icm9rZXIubmV3RXh0ZW50KGNscywgdHJ1ZSksIHRoaXMpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGV2aWN0QWxsKEV4dGVudCBleHRlbnQpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLmV2aWN0QWxsKCgoRXh0ZW50SW1wbCkgZXh0ZW50KS5nZXREZWxlZ2F0ZSgp\nLCB0aGlzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVj\na2VkIikKICAgIHB1YmxpYyA8VD4gVCBkZXRhY2hDb3B5KFQgZW50aXR5KSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgQ29t\ncGF0aWJpbGl0eSBjb21wYXQgPSB0aGlzLmdldENvbmZpZ3VyYXRpb24oKS4K\nICAgICAgICAgICAgZ2V0Q29tcGF0aWJpbGl0eUluc3RhbmNlKCk7CiAgICAg\nICAgYm9vbGVhbiBjb3B5T25EZXRhY2ggPSBjb21wYXQuZ2V0Q29weU9uRGV0\nYWNoKCk7CiAgICAgICAgYm9vbGVhbiBjYXNjYWRlV2l0aERldGFjaCA9IGNv\nbXBhdC5nZXRDYXNjYWRlV2l0aERldGFjaCgpOwogICAgICAgIC8vIFNldCBj\nb21wYXRpYmlsaXR5IG9wdGlvbnMgdG8gZ2V0IDEueCBkZXRhY2ggYmVoYXZp\nb3IKICAgICAgICBjb21wYXQuc2V0Q29weU9uRGV0YWNoKHRydWUpOwogICAg\nICAgIGNvbXBhdC5zZXRDYXNjYWRlV2l0aERldGFjaCh0cnVlKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBUIHQgPSAoVClfYnJva2VyLmRldGFjaChl\nbnRpdHksIHRoaXMpOwogICAgICAgICAgICByZXR1cm4gdDsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICAvLyBSZXNldCBjb21wYXRpYmlsaXR5\nIG9wdGlvbnMKICAgICAgICAgICAgY29tcGF0LnNldENvcHlPbkRldGFjaChj\nb3B5T25EZXRhY2gpOwogICAgICAgICAgICBjb21wYXQuc2V0Q2FzY2FkZVdp\ndGhEZXRhY2goY2FzY2FkZVdpdGhEZXRhY2gpOwogICAgICAgIH0gICAgICAg\nIAogICAgfQoKICAgIHB1YmxpYyBPYmplY3RbXSBkZXRhY2hBbGwoT2JqZWN0\nLi4uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZGV0YWNoQWxsKEFycmF5cy5h\nc0xpc3QoZW50aXRpZXMpLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgQ29s\nbGVjdGlvbiBkZXRhY2hBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBB\ncnJheXMuYXNMaXN0KF9icm9rZXIuZGV0YWNoQWxsKGVudGl0aWVzLCB0aGlz\nKSk7CiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIp\nCiAgICBwdWJsaWMgPFQ+IFQgbWVyZ2UoVCBlbnRpdHkpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gKFQpIF9i\ncm9rZXIuYXR0YWNoKGVudGl0eSwgdHJ1ZSwgdGhpcyk7CiAgICB9CgogICAg\ncHVibGljIE9iamVjdFtdIG1lcmdlQWxsKE9iamVjdC4uLiBlbnRpdGllcykg\newogICAgICAgIGlmIChlbnRpdGllcy5sZW5ndGggPT0gMCkKICAgICAgICAg\nICAgcmV0dXJuIEVNUFRZX09CSkVDVFM7CiAgICAgICAgcmV0dXJuIG1lcmdl\nQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKS50b0FycmF5KCk7CiAgICB9\nCgogICAgcHVibGljIENvbGxlY3Rpb24gbWVyZ2VBbGwoQ29sbGVjdGlvbiBl\nbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIHJldHVybiBBcnJheXMuYXNMaXN0KF9icm9rZXIuYXR0YWNoQWxs\nKGVudGl0aWVzLCB0cnVlLCB0aGlzKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgdHJhbnNhY3Rpb25hbChPYmplY3QgZW50aXR5LCBib29sZWFuIHVwZGF0\nZVZlcnNpb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLnRyYW5zYWN0aW9uYWwoZW50aXR5LCB1cGRhdGVW\nZXJzaW9uLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0cmFuc2Fj\ndGlvbmFsQWxsKENvbGxlY3Rpb24gb2JqcywgYm9vbGVhbiB1cGRhdGVWZXJz\naW9uKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci50cmFuc2FjdGlvbmFsQWxsKG9ianMsIHVwZGF0ZVZlcnNp\nb24sIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRyYW5zYWN0aW9u\nYWxBbGwoT2JqZWN0W10gb2JqcywgYm9vbGVhbiB1cGRhdGVWZXJzaW9uKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci50cmFuc2FjdGlvbmFsQWxsKEFycmF5cy5hc0xpc3Qob2JqcyksIHVw\nZGF0ZVZlcnNpb24sIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG5v\nbnRyYW5zYWN0aW9uYWwoT2JqZWN0IGVudGl0eSkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIubm9udHJhbnNh\nY3Rpb25hbChlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIG5vbnRyYW5zYWN0aW9uYWxBbGwoQ29sbGVjdGlvbiBvYmpzKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5u\nb250cmFuc2FjdGlvbmFsQWxsKG9ianMsIHRoaXMpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIG5vbnRyYW5zYWN0aW9uYWxBbGwoT2JqZWN0W10gb2Jqcykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIubm9udHJhbnNhY3Rpb25hbEFsbChBcnJheXMuYXNMaXN0KG9ianMp\nLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgR2VuZXJhdG9yIGdldE5hbWVk\nR2VuZXJhdG9yKFN0cmluZyBuYW1lKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU2VxdWVu\nY2VNZXRhRGF0YSBtZXRhID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCku\nCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5j\nZSgpLmdldFNlcXVlbmNlTWV0YURhdGEobmFtZSwKICAgICAgICAgICAgICAg\nIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAgICAg\nIFNlcSBzZXEgPSBtZXRhLmdldEluc3RhbmNlKF9icm9rZXIuZ2V0Q2xhc3NM\nb2FkZXIoKSk7CiAgICAgICAgICAgIHJldHVybiBuZXcgR2VuZXJhdG9ySW1w\nbChzZXEsIG5hbWUsIF9icm9rZXIsIG51bGwpOwogICAgICAgIH0gY2F0Y2gg\nKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cgUGVy\nc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24ocmUp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgR2VuZXJhdG9yIGdldElk\nR2VuZXJhdG9yKENsYXNzIGZvckNsYXNzKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBtZXRhID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCku\nCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5j\nZSgpLmdldE1ldGFEYXRhKGZvckNsYXNzLAogICAgICAgICAgICAgICAgX2Jy\nb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICAgICAgU2Vx\nIHNlcSA9IF9icm9rZXIuZ2V0SWRlbnRpdHlTZXF1ZW5jZShtZXRhKTsKICAg\nICAgICAgICAgcmV0dXJuIChzZXEgPT0gbnVsbCkgPyBudWxsIDogbmV3IEdl\nbmVyYXRvckltcGwoc2VxLCBudWxsLCBfYnJva2VyLAogICAgICAgICAgICAg\nICAgbWV0YSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lz\ndGVuY2VFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1Ymxp\nYyBHZW5lcmF0b3IgZ2V0RmllbGRHZW5lcmF0b3IoQ2xhc3MgZm9yQ2xhc3Ms\nIFN0cmluZyBmaWVsZE5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFzc01ldGFE\nYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAg\nICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0\nTWV0YURhdGEoZm9yQ2xhc3MsCiAgICAgICAgICAgICAgICBfYnJva2VyLmdl\ndENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZCA9IG1ldGEuZ2V0RmllbGQoZmllbGROYW1lKTsKICAgICAgICAg\nICAgaWYgKGZtZCA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1uYW1lZC1maWVsZCIs\nCiAgICAgICAgICAgICAgICAgICAgZm9yQ2xhc3MsIGZpZWxkTmFtZSksIG51\nbGwsIG51bGwsIGZhbHNlKTsKCiAgICAgICAgICAgIFNlcSBzZXEgPSBfYnJv\na2VyLmdldFZhbHVlU2VxdWVuY2UoZm1kKTsKICAgICAgICAgICAgcmV0dXJu\nIChzZXEgPT0gbnVsbCkgPyBudWxsIDogbmV3IEdlbmVyYXRvckltcGwoc2Vx\nLCBudWxsLCBfYnJva2VyLAogICAgICAgICAgICAgICAgbWV0YSk7CiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cg\nUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24o\nZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyA8VD4gRXh0ZW50PFQ+\nIGNyZWF0ZUV4dGVudChDbGFzczxUPiBjbHMsIGJvb2xlYW4gc3ViY2xhc3Nl\ncykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIHJldHVybiBuZXcgRXh0ZW50SW1wbDxUPih0aGlzLCBfYnJva2VyLm5ld0V4\ndGVudChjbHMsIHN1YmNsYXNzZXMpKTsKICAgIH0KCiAgICBAU3VwcHJlc3NX\nYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVHlwZWRRdWVy\neTxUPiBjcmVhdGVRdWVyeShTdHJpbmcgcXVlcnksIENsYXNzPFQ+IHJlc3Vs\ndENsYXNzKSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KHF1ZXJ5KS5z\nZXRSZXN1bHRDbGFzcyhyZXN1bHRDbGFzcyk7CiAgICB9CiAgICAKICAgIHB1\nYmxpYyBPcGVuSlBBUXVlcnkgY3JlYXRlUXVlcnkoU3RyaW5nIHF1ZXJ5KSB7\nCiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KEpQUUxQYXJzZXIuTEFOR19K\nUFFMLCBxdWVyeSk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBj\ncmVhdGVRdWVyeShTdHJpbmcgbGFuZ3VhZ2UsIFN0cmluZyBxdWVyeSkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIFN0cmluZyBxaWQgPSBxdWVyeTsKICAgICAgICAgICAg\nUHJlcGFyZWRRdWVyeSBwcSA9IEpQUUxQYXJzZXIuTEFOR19KUFFMLmVxdWFs\ncyhsYW5ndWFnZSkKICAgICAgICAgICAgICAgID8gZ2V0UHJlcGFyZWRRdWVy\neShxaWQpIDogbnVsbDsKICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5RdWVyeSBxID0gKHBxID09IG51bGwgfHwgIXBxLmlzSW5pdGlh\nbGl6ZWQoKSkKICAgICAgICAgICAgICAgID8gX2Jyb2tlci5uZXdRdWVyeShs\nYW5ndWFnZSwgcXVlcnkpCiAgICAgICAgICAgICAgICA6IF9icm9rZXIubmV3\nUXVlcnkocHEuZ2V0TGFuZ3VhZ2UoKSwgcHEpOwogICAgICAgICAgICAvLyBo\nYXZlIHRvIHZhbGlkYXRlIEpQUUwgYWNjb3JkaW5nIHRvIHNwZWMKICAgICAg\nICAgICAgaWYgKHBxID09IG51bGwgJiYgSlBRTFBhcnNlci5MQU5HX0pQUUwu\nZXF1YWxzKGxhbmd1YWdlKSkKICAgICAgICAgICAgICAgIHEuY29tcGlsZSgp\nOyAKICAgICAgICAgICAgaWYgKHBxICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgIHBxLnNldEludG8ocSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ncmV0dXJuIG5ld1F1ZXJ5SW1wbChxKS5zZXRJZChxaWQpOwogICAgICAgIH0g\nY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhy\nb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRp\nb24ocmUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIE9wZW5K\nUEFRdWVyeSBjcmVhdGVRdWVyeShRdWVyeSBxdWVyeSkgewogICAgICAgIGlm\nIChxdWVyeSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY3JlYXRlUXVl\ncnkoKFN0cmluZykgbnVsbCk7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVy\neSBxID0gKChRdWVyeUltcGwpIHF1ZXJ5KS5nZXREZWxlZ2F0ZSgpOwogICAg\nICAgIHJldHVybiBuZXdRdWVyeUltcGwoX2Jyb2tlci5uZXdRdWVyeShxLmdl\ndExhbmd1YWdlKCksIHEpKTsKICAgIH0KICAgIAogICAgQFN1cHByZXNzV2Fy\nbmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IFR5cGVkUXVlcnk8\nVD4gY3JlYXRlTmFtZWRRdWVyeShTdHJpbmcgbmFtZSwgQ2xhc3M8VD4gcmVz\ndWx0Q2xhc3MpIHsKICAgICAgICByZXR1cm4gY3JlYXRlTmFtZWRRdWVyeShu\nYW1lKS5zZXRSZXN1bHRDbGFzcyhyZXN1bHRDbGFzcyk7CiAgICB9CgogICAg\ncHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYW1lZFF1ZXJ5KFN0cmluZyBu\nYW1lKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgUXVlcnlNZXRhRGF0YSBtZXRhID0gX2Jyb2tlci5nZXRDb25maWd1\ncmF0aW9uKCkuCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9zaXRv\ncnlJbnN0YW5jZSgpLmdldFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFtZSwKICAg\nICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7\nCiAgICAgICAgICAgIFN0cmluZyBxaWQgPSBtZXRhLmdldFF1ZXJ5U3RyaW5n\nKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBQcmVwYXJlZFF1ZXJ5IHBx\nID0gSlBRTFBhcnNlci5MQU5HX0pQUUwuZXF1YWxzKG1ldGEuZ2V0TGFuZ3Vh\nZ2UoKSkKICAgICAgICAgICAgICAgID8gZ2V0UHJlcGFyZWRRdWVyeShxaWQp\nIDogbnVsbDsKICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5RdWVyeSBkZWwgPSAocHEgPT0gbnVsbCB8fCAhcHEuaXNJbml0aWFsaXpl\nZCgpKQogICAgICAgICAgICAgICAgPyBfYnJva2VyLm5ld1F1ZXJ5KG1ldGEu\nZ2V0TGFuZ3VhZ2UoKSwgbWV0YS5nZXRRdWVyeVN0cmluZygpKQogICAgICAg\nICAgICAgICAgOiBfYnJva2VyLm5ld1F1ZXJ5KHBxLmdldExhbmd1YWdlKCks\nIHBxKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChwcSAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBwcS5zZXRJbnRvKGRlbCk7CiAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtZXRhLnNldEludG8oZGVs\nKTsKICAgICAgICAgICAgICAgIGRlbC5jb21waWxlKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIE9wZW5KUEFRdWVyeSBxID0g\nbmV3UXVlcnlJbXBsKGRlbCkuc2V0SWQocWlkKTsKICAgICAgICAgICAgU3Ry\naW5nW10gaGludHMgPSBtZXRhLmdldEhpbnRLZXlzKCk7CiAgICAgICAgICAg\nIE9iamVjdFtdIHZhbHVlcyA9IG1ldGEuZ2V0SGludFZhbHVlcygpOwogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGhpbnRzLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICAgICAgcS5zZXRIaW50KGhpbnRzW2ldLCB2YWx1ZXNb\naV0pOwogICAgICAgICAgICByZXR1cm4gcTsKICAgICAgICB9IGNhdGNoIChS\ndW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgICAgIHRocm93IFBlcnNp\nc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9uKHJlKTsK\nICAgICAgICB9CiAgICB9ICAgIAoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkg\nY3JlYXRlTmF0aXZlUXVlcnkoU3RyaW5nIHF1ZXJ5KSB7CiAgICAgICAgdmFs\naWRhdGVTUUwocXVlcnkpOwogICAgICAgIHJldHVybiBjcmVhdGVRdWVyeShR\ndWVyeUxhbmd1YWdlcy5MQU5HX1NRTCwgcXVlcnkpOwogICAgfQoKICAgIHB1\nYmxpYyBPcGVuSlBBUXVlcnkgY3JlYXRlTmF0aXZlUXVlcnkoU3RyaW5nIHF1\nZXJ5LCBDbGFzcyBjbHMpIHsKICAgICAgICByZXR1cm4gY3JlYXRlTmF0aXZl\nUXVlcnkocXVlcnkpLnNldFJlc3VsdENsYXNzKGNscyk7CiAgICB9CgogICAg\ncHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVRdWVyeShTdHJpbmcg\ncXVlcnksIFN0cmluZyBtYXBwaW5nTmFtZSkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHZhbGlkYXRlU1FMKHF1ZXJ5KTsK\nICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IGtlcm5l\nbFF1ZXJ5ID0gX2Jyb2tlci5uZXdRdWVyeSgKICAgICAgICAgICAgUXVlcnlM\nYW5ndWFnZXMuTEFOR19TUUwsIHF1ZXJ5KTsKICAgICAgICBrZXJuZWxRdWVy\neS5zZXRSZXN1bHRNYXBwaW5nKG51bGwsIG1hcHBpbmdOYW1lKTsKICAgICAg\nICByZXR1cm4gbmV3UXVlcnlJbXBsKGtlcm5lbFF1ZXJ5KTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgPFQ+IFF1ZXJ5SW1wbDxUPiBuZXdRdWVyeUltcGwob3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBrZXJuZWxRdWVyeSkgewog\nICAgICAgIHJldHVybiBuZXcgUXVlcnlJbXBsPFQ+KHRoaXMsIF9yZXQsIGtl\ncm5lbFF1ZXJ5KTsKICAgIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlIHRo\nYXQgdGhlIHVzZXIgcHJvdmlkZWQgU1FMLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCB2YWxpZGF0ZVNRTChTdHJpbmcgcXVlcnkpIHsKICAgICAgICBp\nZiAoU3RyaW5nVXRpbHMudHJpbVRvTnVsbChxdWVyeSkgPT0gbnVsbCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0\nKCJuby1zcWwiKSwgbnVsbCwgbnVsbCwgZmFsc2UpOwogICAgfQogICAgCiAg\nICBQcmVwYXJlZFF1ZXJ5Q2FjaGUgZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldENhY2hlUHJlcGFyZWRRdWVy\neSgpID8KICAgICAgICAgICAgZ2V0Q29uZmlndXJhdGlvbigpLmdldFF1ZXJ5\nU1FMQ2FjaGVJbnN0YW5jZSgpIDogbnVsbDsKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBHZXRzIHRoZSBwcmVwYXJlZCBxdWVyeSBjYWNoZWQgYnkgdGhl\nIGdpdmVuIGtleS4gCiAgICAgKiAKICAgICAqIEByZXR1cm4gdGhlIGNhY2hl\nZCBQcmVwYXJlZFF1ZXJ5IG9yIG51bGwgaWYgbm9uZSBleGlzdHMuCiAgICAg\nKi8KICAgIFByZXBhcmVkUXVlcnkgZ2V0UHJlcGFyZWRRdWVyeShTdHJpbmcg\naWQpIHsKICAgICAgICBQcmVwYXJlZFF1ZXJ5Q2FjaGUgY2FjaGUgPSBnZXRQ\ncmVwYXJlZFF1ZXJ5Q2FjaGUoKTsKICAgICAgICByZXR1cm4gKGNhY2hlID09\nIG51bGwpID8gbnVsbCA6IGNhY2hlLmdldChpZCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0Rmx1c2hNb2RlKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2Rl\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAgICAgICAgX2Jyb2tlci5nZXRGZXRj\naENvbmZpZ3VyYXRpb24oKS5zZXRGbHVzaEJlZm9yZVF1ZXJpZXMKICAgICAg\nICAgICAgKHRvRmx1c2hCZWZvcmVRdWVyaWVzKGZsdXNoTW9kZSkpOwogICAg\nfQoKICAgIHB1YmxpYyBGbHVzaE1vZGVUeXBlIGdldEZsdXNoTW9kZSgpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmFzc2VydE9wZW4oKTsKICAgICAgICByZXR1cm4gZnJvbUZsdXNoQmVm\nb3JlUXVlcmllcyhfYnJva2VyLmdldEZldGNoQ29uZmlndXJhdGlvbigpLgog\nICAgICAgICAgICBnZXRGbHVzaEJlZm9yZVF1ZXJpZXMoKSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgb3VyIGludGVybmFsIGZsdXNoIGNv\nbnN0YW50IHRvIGEgZmx1c2ggbW9kZSBlbnVtIHZhbHVlLgogICAgICovCiAg\nICBzdGF0aWMgRmx1c2hNb2RlVHlwZSBmcm9tRmx1c2hCZWZvcmVRdWVyaWVz\nKGludCBmbHVzaCkgewogICAgICAgIHN3aXRjaCAoZmx1c2gpIHsKICAgICAg\nICAgICAgY2FzZSBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfVFJVRToKICAgICAg\nICAgICAgICAgIHJldHVybiBGbHVzaE1vZGVUeXBlLkFVVE87CiAgICAgICAg\nICAgIGNhc2UgUXVlcnlGbHVzaE1vZGVzLkZMVVNIX0ZBTFNFOgogICAgICAg\nICAgICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUuQ09NTUlUOwogICAgICAg\nICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNsYXRlIGEgZmx1\nc2ggbW9kZSBlbnVtIHZhbHVlIHRvIG91ciBpbnRlcm5hbCBmbHVzaCBjb25z\ndGFudC4KICAgICAqLwogICAgc3RhdGljIGludCB0b0ZsdXNoQmVmb3JlUXVl\ncmllcyhGbHVzaE1vZGVUeXBlIGZsdXNoTW9kZSkgewogICAgICAgIC8vIGNo\nb29zZSBkZWZhdWx0IGZvciBudWxsCiAgICAgICAgaWYgKGZsdXNoTW9kZSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gUXVlcnlGbHVzaE1vZGVzLkZM\nVVNIX1dJVEhfQ09OTkVDVElPTjsKICAgICAgICBpZiAoZmx1c2hNb2RlID09\nIEZsdXNoTW9kZVR5cGUuQVVUTykKICAgICAgICAgICAgcmV0dXJuIFF1ZXJ5\nRmx1c2hNb2Rlcy5GTFVTSF9UUlVFOwogICAgICAgIGlmIChmbHVzaE1vZGUg\nPT0gRmx1c2hNb2RlVHlwZS5DT01NSVQpCiAgICAgICAgICAgIHJldHVybiBR\ndWVyeUZsdXNoTW9kZXMuRkxVU0hfRkFMU0U7CiAgICAgICAgdGhyb3cgbmV3\nIEFyZ3VtZW50RXhjZXB0aW9uKGZsdXNoTW9kZS50b1N0cmluZygpLCBudWxs\nLCBudWxsLCBmYWxzZSk7CiAgICB9CgogICAgLyoKICAgICAqIFVzZWQgYnkg\nSmF2YSBFRSBDb250YWluZXJzIHRoYXQgd2lzaCB0byBwb29sIE9wZW5KUEEg\nRW50aXR5TWFuYWdlcnMuICBUaGUgc3BlY2lmaWNhdGlvbgogICAgICogZG9l\nc24ndCBhbGxvdyB0aGUgY2xvc2luZyBvZiBjb25uZWN0aW9ucyB3aXRoIHRo\nZSBjbGVhcigpIG1ldGhvZC4gIEJ5IGludHJvZHVjaW5nIHRoaXMKICAgICAq\nIG5ldyBtZXRob2QsIHdlIGNhbiBkbyBhZGRpdGlvbmFsIHByb2Nlc3Npbmcg\nKGFuZCBtYXliZSBtb3JlIGVmZmljaWVudCBwcm9jZXNzaW5nKSB0byAKICAg\nICAqIHByb3Blcmx5IHByZXBhcmUgYW4gRU0gZm9yIHBvb2xpbmcuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHByZXBhcmVGb3JQb29saW5nKCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGNsZWFyKCk7\nCiAgICAgICAgX2Jyb2tlci5sb2NrKCk7ICAvLyBzaW5jZSB0aGlzIGRpcmVj\ndCBjbG9zZSBwYXRoIGlzIG5vdCBwcm90ZWN0ZWQuLi4KICAgICAgICB0cnkg\newogICAgICAgICAgICBfYnJva2VyLmdldFN0b3JlTWFuYWdlcigpLmNsb3Nl\nKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2Jyb2tlci51\nbmxvY2soKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIGNsZWFyKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIF9icm9rZXIuZGV0YWNoQWxsKHRoaXMsIGZhbHNlKTsKICAgICAg\nICBfcGxhbnMuY2xlYXIoKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdl\ndERlbGVnYXRlKCkgewogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOwog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVy\nbiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBMb2NrTW9kZVR5cGUgZ2V0TG9j\na01vZGUoT2JqZWN0IGVudGl0eSkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0QWN0aXZlVHJhbnNh\nY3Rpb24oKTsKICAgICAgICBhc3NlcnRWYWxpZEF0dGNoZWRFbnRpdHkoR0VU\nX0xPQ0tfTU9ERSwgZW50aXR5KTsKICAgICAgICByZXR1cm4gTWl4ZWRMb2Nr\nTGV2ZWxzSGVscGVyLmZyb21Mb2NrTGV2ZWwoCiAgICAgICAgICAgIF9icm9r\nZXIuZ2V0TG9ja0xldmVsKGVudGl0eSkpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGxvY2soT2JqZWN0IGVudGl0eSwgTG9ja01vZGVUeXBlIG1vZGUpIHsK\nICAgICAgICBsb2NrKGVudGl0eSwgbW9kZSwgLTEpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGxvY2soT2JqZWN0IGVudGl0eSkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGFzc2VydFZhbGlkQXR0Y2hl\nZEVudGl0eShMT0NLLCBlbnRpdHkpOwogICAgICAgIF9icm9rZXIubG9jayhl\nbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2soT2Jq\nZWN0IGVudGl0eSwgTG9ja01vZGVUeXBlIG1vZGUsIGludCB0aW1lb3V0KSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNz\nZXJ0VmFsaWRBdHRjaGVkRW50aXR5KExPQ0ssIGVudGl0eSk7CgogICAgICAg\nIGNvbmZpZ3VyZUN1cnJlbnRGZXRjaFBsYW4ocHVzaEZldGNoUGxhbigpLCBu\ndWxsLCBtb2RlLCBmYWxzZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nX2Jyb2tlci5sb2NrKGVudGl0eSwgTWl4ZWRMb2NrTGV2ZWxzSGVscGVyLnRv\nTG9ja0xldmVsKG1vZGUpLCAgdGltZW91dCwgdGhpcyk7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgcG9wRmV0Y2hQbGFuKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2soT2JqZWN0IGVudGl0eSwg\nTG9ja01vZGVUeXBlIG1vZGUsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVy\ndGllcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIGFzc2VydFZhbGlkQXR0Y2hlZEVudGl0eShMT0NLLCBlbnRpdHkpOwog\nICAgICAgIF9icm9rZXIuYXNzZXJ0QWN0aXZlVHJhbnNhY3Rpb24oKTsKICAg\nICAgICBjb25maWd1cmVDdXJyZW50Q2FjaGVNb2RlcyhnZXRGZXRjaFBsYW4o\nKSwgcHJvcGVydGllcyk7CiAgICAgICAgY29uZmlndXJlQ3VycmVudEZldGNo\nUGxhbihwdXNoRmV0Y2hQbGFuKCksIHByb3BlcnRpZXMsIG1vZGUsIGZhbHNl\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBfYnJva2VyLmxvY2soZW50\naXR5LCBNaXhlZExvY2tMZXZlbHNIZWxwZXIudG9Mb2NrTGV2ZWwobW9kZSks\nCiAgICAgICAgICAgICAgICBfYnJva2VyLmdldEZldGNoQ29uZmlndXJhdGlv\nbigpLmdldExvY2tUaW1lb3V0KCksIHRoaXMpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIHBvcEZldGNoUGxhbigpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKENvbGxlY3Rpb24gZW50aXRp\nZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLmxvY2tBbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGxvY2tBbGwoQ29sbGVjdGlvbiBlbnRpdGllcywgTG9j\na01vZGVUeXBlIG1vZGUsIGludCB0aW1lb3V0KSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrQWxsKGVu\ndGl0aWVzLCBNaXhlZExvY2tMZXZlbHNIZWxwZXIudG9Mb2NrTGV2ZWwobW9k\nZSksCiAgICAgICAgICAgIHRpbWVvdXQsIHRoaXMpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGxvY2tBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAg\nICAgbG9ja0FsbChBcnJheXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgbG9ja0FsbChPYmplY3RbXSBlbnRpdGllcywgTG9j\na01vZGVUeXBlIG1vZGUsIGludCB0aW1lb3V0KSB7CiAgICAgICAgbG9ja0Fs\nbChBcnJheXMuYXNMaXN0KGVudGl0aWVzKSwgbW9kZSwgdGltZW91dCk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gY2FuY2VsQWxsKCkgewogICAgICAg\nIHJldHVybiBfYnJva2VyLmNhbmNlbEFsbCgpOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgZ2V0Q29ubmVjdGlvbigpIHsKICAgICAgICByZXR1cm4gX2Jy\nb2tlci5nZXRDb25uZWN0aW9uKCk7CiAgICB9CgogICAgcHVibGljIENvbGxl\nY3Rpb24gZ2V0TWFuYWdlZE9iamVjdHMoKSB7CiAgICAgICAgcmV0dXJuIF9i\ncm9rZXIuZ2V0TWFuYWdlZE9iamVjdHMoKTsKICAgIH0KCiAgICBwdWJsaWMg\nQ29sbGVjdGlvbiBnZXRUcmFuc2FjdGlvbmFsT2JqZWN0cygpIHsKICAgICAg\nICByZXR1cm4gX2Jyb2tlci5nZXRUcmFuc2FjdGlvbmFsT2JqZWN0cygpOwog\nICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFBlbmRpbmdUcmFuc2Fj\ndGlvbmFsT2JqZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRQ\nZW5kaW5nVHJhbnNhY3Rpb25hbE9iamVjdHMoKTsKICAgIH0KCiAgICBwdWJs\naWMgQ29sbGVjdGlvbiBnZXREaXJ0eU9iamVjdHMoKSB7CiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuZ2V0RGlydHlPYmplY3RzKCk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0T3JkZXJEaXJ0eU9iamVjdHMoKSB7CiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuZ2V0T3JkZXJEaXJ0eU9iamVjdHMoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRPcmRlckRpcnR5T2JqZWN0cyhib29sZWFu\nIG9yZGVyKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5zZXRPcmRlckRpcnR5T2JqZWN0cyhvcmRlcik7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgZGlydHlDbGFzcyhDbGFzcyBjbHMpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmRpcnR5VHlwZShjbHMpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5p\nbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIENvbGxlY3Rpb248Q2xhc3M+\nIGdldFBlcnNpc3RlZENsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJuIChDb2xs\nZWN0aW9uPENsYXNzPikgX2Jyb2tlci5nZXRQZXJzaXN0ZWRUeXBlcygpOwog\nICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAg\ncHVibGljIENvbGxlY3Rpb248Q2xhc3M+IGdldFVwZGF0ZWRDbGFzc2VzKCkg\newogICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIu\nZ2V0VXBkYXRlZFR5cGVzKCk7CiAgICB9CgogICAgQFN1cHByZXNzV2Fybmlu\nZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgQ29sbGVjdGlvbjxDbGFzcz4g\nZ2V0UmVtb3ZlZENsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJuIChDb2xsZWN0\naW9uPENsYXNzPikgX2Jyb2tlci5nZXREZWxldGVkVHlwZXMoKTsKICAgIH0K\nCiAgICBwdWJsaWMgPFQ+IFQgY3JlYXRlSW5zdGFuY2UoQ2xhc3M8VD4gY2xz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIChUKSBfYnJva2VyLm5ld0luc3RhbmNlKGNscyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5jbG9zZSgpOwogICAgICAg\nIF9wbGFucy5jbGVhcigpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlz\nT3BlbigpIHsKICAgICAgICByZXR1cm4gIV9icm9rZXIuaXNDbG9zZUludm9r\nZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkaXJ0eShPYmplY3Qgbywg\nU3RyaW5nIGZpZWxkKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IF9icm9rZXIu\nZ2V0U3RhdGVNYW5hZ2VyKG8pOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGlmIChzbSAhPSBudWxsKQogICAgICAgICAgICAgICAgc20uZGlydHkoZmll\nbGQpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNl\nRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IGdldE9iamVjdElkKE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBl\nci5mcm9tT3BlbkpQQU9iamVjdElkKF9icm9rZXIuZ2V0T2JqZWN0SWQobykp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzRGlydHkoT2JqZWN0IG8p\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBy\nZXR1cm4gX2Jyb2tlci5pc0RpcnR5KG8pOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzVHJhbnNhY3Rpb25hbChPYmplY3QgbykgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2Vy\nLmlzVHJhbnNhY3Rpb25hbChvKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc1BlcnNpc3RlbnQoT2JqZWN0IG8pIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5pc1BlcnNp\nc3RlbnQobyk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNOZXdseVBl\ncnNpc3RlbnQoT2JqZWN0IG8pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5pc05ldyhvKTsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1JlbW92ZWQoT2JqZWN0IG8pIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1\ncm4gX2Jyb2tlci5pc0RlbGV0ZWQobyk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaXNEZXRhY2hlZChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIu\naXNEZXRhY2hlZChlbnRpdHkpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0VmVyc2lvbihPYmplY3QgbykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2VyLmdldFZlcnNpb24o\nbyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBhcHByb3ByaWF0ZSBl\neGNlcHRpb24gaWYgY2xvc2UgaGFzIGJlZW4gaW52b2tlZCBidXQgdGhlIGJy\nb2tlcgogICAgICogaXMgc3RpbGwgb3Blbi4gIFdlIHRlc3Qgb25seSBmb3Ig\ndGhpcyBiZWNhdXNlIGlmIHRoZSBicm9rZXIgaXMgYWxyZWFkeQogICAgICog\nY2xvc2VkLCBpdCB3aWxsIHRocm93IGl0cyBvd24gbW9yZSBpbmZvcm1hdGl2\nZSBleGNlcHRpb24gd2hlbiB3ZSAKICAgICAqIGRlbGVnYXRlIHRoZSBwZW5k\naW5nIG9wZXJhdGlvbiB0byBpdC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZv\naWQgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCkgewogICAgICAgIGlmICghX2Jy\nb2tlci5pc0Nsb3NlZCgpICYmIF9icm9rZXIuaXNDbG9zZUludm9rZWQoKSkK\nICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihf\nbG9jLmdldCgiY2xvc2UtaW52b2tlZCIpLCBudWxsLAogICAgICAgICAgICAg\nICAgbnVsbCwgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBJ\nbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25pZiBpZiBlbnRpdHkgaXMgbm90IGEg\ndmFsaWQgZW50aXR5IG9yCiAgICAgKiBpZiBpdCBpcyBkZXRhY2hlZC4KICAg\nICAqLwogICAgdm9pZCBhc3NlcnRWYWxpZEF0dGNoZWRFbnRpdHkoU3RyaW5n\nIGNhbGwsIE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIoZW50aXR5KTsK\nICAgICAgICBpZiAoc20gPT0gbnVsbCB8fCAhc20uaXNQZXJzaXN0ZW50KCkg\nfHwgc20uaXNEZXRhY2hlZCgpIHx8IChjYWxsLmVxdWFscyhSRUZSRVNIKSAm\nJiBzbS5pc0RlbGV0ZWQoKSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgiaW52YWxpZF9lbnRp\ndHlfYXJndW1lbnQiLCAKICAgICAgICAgICAgICAgIGNhbGwsIGVudGl0eSA9\nPSBudWxsID8gIm51bGwiIDogRXhjZXB0aW9ucy50b1N0cmluZyhlbnRpdHkp\nKS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gRmluZENhbGxiYWNr\ncyBpbXBsZW1lbnRhdGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8KCiAgICBwdWJsaWMgT2JqZWN0IHByb2Nlc3NBcmd1bWVudChP\nYmplY3QgYXJnKSB7CiAgICAgICAgcmV0dXJuIGFyZzsKICAgIH0KCiAgICBw\ndWJsaWMgT2JqZWN0IHByb2Nlc3NSZXR1cm4oT2JqZWN0IG9pZCwgT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIHJldHVybiAoc20gPT0gbnVs\nbCB8fCBzbS5pc0RlbGV0ZWQoKSkgPyBudWxsIDogc20uZ2V0TWFuYWdlZElu\nc3RhbmNlKCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vCiAgICAvLyBPcENhbGxiYWNrcyBpbXBsZW1lbnRhdGlvbgogICAg\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIGlu\ndCBwcm9jZXNzQXJndW1lbnQoaW50IG9wLCBPYmplY3Qgb2JqLCBPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtKSB7CiAgICAgICAgc3dpdGNoIChvcCkgewogICAg\nICAgICAgICBjYXNlIE9QX0RFTEVURToKICAgICAgICAgICAgICAgIC8vIGNh\nc2NhZGUgdGhyb3VnaCBub24tcGVyc2lzdGVudCBub24tZGV0YWNoZWQgaW5z\ndGFuY2VzCiAgICAgICAgICAgICAgICBpZiAoc20gPT0gbnVsbCAmJiAhX2Jy\nb2tlci5pc0RldGFjaGVkKG9iaikpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIEFDVF9DQVNDQURFOwogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51\nbGwgJiYgIXNtLmlzRGV0YWNoZWQoKSAmJiAhc20uaXNQZXJzaXN0ZW50KCkp\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9DQVNDQURFOwogICAg\nICAgICAgICAgICAgLy8gaWdub3JlIGRlbGV0ZWQgaW5zdGFuY2VzCiAgICAg\nICAgICAgICAgICBpZiAoc20gIT0gbnVsbCAmJiBzbS5pc0RlbGV0ZWQoKSkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gQUNUX05PTkU7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9BVFRBQ0g6CiAg\nICAgICAgICAgICAgICAvLyBkaWUgb24gcmVtb3ZlZAogICAgICAgICAgICAg\nICAgaWYgKHNtICE9IG51bGwgJiYgc20uaXNEZWxldGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nInJlbW92ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICBFeGNlcHRpb25z\nLnRvU3RyaW5nKG9iaikpKS5zZXRGYWlsZWRPYmplY3Qob2JqKTsKICAgICAg\nICAgICAgICAgIC8vIGNhc2NhZGUgdGhyb3VnaCBtYW5hZ2VkIGluc3RhbmNl\ncwogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYgIXNtLmlzRGV0\nYWNoZWQoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQUNUX0NBU0NB\nREU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBP\nUF9SRUZSRVNIOgogICAgICAgICAgICAgICAgLy8gZGllIG9uIHVubWFuYWdl\nZCBpbnN0YW5jZXMKICAgICAgICAgICAgICAgIGlmIChzbSA9PSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJub3QtbWFuYWdlZCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nIEV4Y2VwdGlvbnMudG9TdHJpbmcob2JqKSkpLnNldEZhaWxlZE9iamVjdChv\nYmopOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nT1BfREVUQUNIOgogICAgICAgICAgICAgICAgaWYgKHNtID09IG51bGwgfHwg\nIXNtLmlzUGVyc2lzdGVudCgpIHx8IHNtLmlzRGV0YWNoZWQoKSkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gQUNUX05PTkU7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIEFDVF9SVU4gfCBB\nQ1RfQ0FTQ0FERTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkg\newogICAgICAgIHJldHVybiAoX2Jyb2tlciA9PSBudWxsKSA/IDAgOiBfYnJv\na2VyLmhhc2hDb2RlKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZXF1\nYWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlmIChvdGhlciA9PSB0aGlz\nKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoKG90aGVy\nID09IG51bGwpIHx8IChvdGhlci5nZXRDbGFzcygpICE9IHRoaXMuZ2V0Q2xh\nc3MoKSkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAo\nX2Jyb2tlciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZXF1YWxzKCgoRW50aXR5TWFuYWdlcklt\ncGwpIG90aGVyKS5fYnJva2VyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZWFkRXh0ZXJuYWwoT2JqZWN0SW5wdXQgaW4pCiAgICAgICAgdGhyb3dzIElP\nRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBfcmV0ID0gUGVyc2lzdGVuY2VFeGNlcHRpb25z\nLmdldFJvbGxiYWNrVHJhbnNsYXRvcih0aGlzKTsKCiAgICAgICAgICAgIC8v\nIHRoaXMgYXNzdW1lcyB0aGF0IHNlcmlhbGl6ZWQgQnJva2VycyBhcmUgZnJv\nbSBzb21ldGhpbmcKICAgICAgICAgICAgLy8gdGhhdCBleHRlbmRzIEFic3Ry\nYWN0QnJva2VyRmFjdG9yeS4KICAgICAgICAgICAgT2JqZWN0IGZhY3RvcnlL\nZXkgPSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgIEFic3RyYWN0QnJv\na2VyRmFjdG9yeSBmYWN0b3J5ID0KICAgICAgICAgICAgICAgIEFic3RyYWN0\nQnJva2VyRmFjdG9yeS5nZXRQb29sZWRGYWN0b3J5Rm9yS2V5KGZhY3RvcnlL\nZXkpOwogICAgICAgICAgICBieXRlW10gYnJva2VyQnl0ZXMgPSAoYnl0ZVtd\nKSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgIE9iamVjdElucHV0U3Ry\nZWFtIGlubmVySW4gPSBuZXcgQnJva2VyQnl0ZXNJbnB1dFN0cmVhbShicm9r\nZXJCeXRlcywKICAgICAgICAgICAgICAgIGZhY3RvcnkuZ2V0Q29uZmlndXJh\ndGlvbigpKTsKCiAgICAgICAgICAgIEJyb2tlciBicm9rZXIgPSAoQnJva2Vy\nKSBpbm5lckluLnJlYWRPYmplY3QoKTsKICAgICAgICAgICAgRW50aXR5TWFu\nYWdlckZhY3RvcnlJbXBsIGVtZiA9IChFbnRpdHlNYW5hZ2VyRmFjdG9yeUlt\ncGwpCiAgICAgICAgICAgICAgICBKUEFGYWNhZGVIZWxwZXIudG9FbnRpdHlN\nYW5hZ2VyRmFjdG9yeSgKICAgICAgICAgICAgICAgICAgICBicm9rZXIuZ2V0\nQnJva2VyRmFjdG9yeSgpKTsKICAgICAgICAgICAgYnJva2VyLnB1dFVzZXJP\nYmplY3QoSlBBRmFjYWRlSGVscGVyLkVNX0tFWSwgdGhpcyk7CiAgICAgICAg\nICAgIGluaXRpYWxpemUoZW1mLCBicm9rZXIpOwogICAgICAgIH0gY2F0Y2gg\nKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHJlID0gX3JldC50cmFuc2xhdGUocmUpOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nLy8gaWdub3JlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhyb3cgcmU7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdyaXRlRXh0ZXJu\nYWwoT2JqZWN0T3V0cHV0IG91dCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICB0cnkgewogICAgICAgICAgICAvLyB0aGlzIHJlcXVpcmVzIHRoYXQg\nb25seSBBYnN0cmFjdEJyb2tlckZhY3Rvcnktc291cmNlZAogICAgICAgICAg\nICAvLyBicm9rZXJzIGNhbiBiZSBzZXJpYWxpemVkCiAgICAgICAgICAgIE9i\namVjdCBmYWN0b3J5S2V5ID0gKChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9i\ncm9rZXIKICAgICAgICAgICAgICAgIC5nZXRCcm9rZXJGYWN0b3J5KCkpLmdl\ndFBvb2xLZXkoKTsKICAgICAgICAgICAgb3V0LndyaXRlT2JqZWN0KGZhY3Rv\ncnlLZXkpOwogICAgICAgICAgICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gYmFv\ncyA9IG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKICAgICAgICAgICAg\nT2JqZWN0T3V0cHV0U3RyZWFtIGlubmVyT3V0ID0gbmV3IE9iamVjdE91dHB1\ndFN0cmVhbShiYW9zKTsKICAgICAgICAgICAgaW5uZXJPdXQud3JpdGVPYmpl\nY3QoX2Jyb2tlci5nZXREZWxlZ2F0ZSgpKTsKICAgICAgICAgICAgaW5uZXJP\ndXQuZmx1c2goKTsKICAgICAgICAgICAgb3V0LndyaXRlT2JqZWN0KGJhb3Mu\ndG9CeXRlQXJyYXkoKSk7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2Vw\ndGlvbiByZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\ncmUgPSBfcmV0LnRyYW5zbGF0ZShyZSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBpZ25vcmUKICAg\nICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyByZTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQnJva2VyQnl0ZXNJbnB1\ndFN0cmVhbSBleHRlbmRzIE9iamVjdElucHV0U3RyZWFtIHsKCiAgICAgICAg\ncHJpdmF0ZSBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mOwoKICAgICAgICBC\ncm9rZXJCeXRlc0lucHV0U3RyZWFtKGJ5dGVbXSBieXRlcywgT3BlbkpQQUNv\nbmZpZ3VyYXRpb24gY29uZikKICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICAgICAgc3VwZXIobmV3IEJ5dGVBcnJheUlucHV0U3Ry\nZWFtKGJ5dGVzKSk7CiAgICAgICAgICAgIGlmIChjb25mID09IG51bGwpCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0\naW9uKAogICAgICAgICAgICAgICAgICAgICJJbGxlZ2FsIG51bGwgYXJndW1l\nbnQgdG8gT2JqZWN0SW5wdXRTdHJlYW1XaXRoTG9hZGVyIik7CiAgICAgICAg\nICAgIHRoaXMuY29uZiA9IGNvbmY7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBNYWtlIGEgcHJpbWl0aXZlIGFycmF5IGNsYXNzCiAgICAg\nICAgICovCiAgICAgICAgcHJpdmF0ZSBDbGFzcyBwcmltaXRpdmVUeXBlKGNo\nYXIgdHlwZSkgewogICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAg\nICAgICAgICAgIGNhc2UgJ0InOiByZXR1cm4gYnl0ZS5jbGFzczsKICAgICAg\nICAgICAgICAgIGNhc2UgJ0MnOiByZXR1cm4gY2hhci5jbGFzczsKICAgICAg\nICAgICAgICAgIGNhc2UgJ0QnOiByZXR1cm4gZG91YmxlLmNsYXNzOwogICAg\nICAgICAgICAgICAgY2FzZSAnRic6IHJldHVybiBmbG9hdC5jbGFzczsKICAg\nICAgICAgICAgICAgIGNhc2UgJ0knOiByZXR1cm4gaW50LmNsYXNzOwogICAg\nICAgICAgICAgICAgY2FzZSAnSic6IHJldHVybiBsb25nLmNsYXNzOwogICAg\nICAgICAgICAgICAgY2FzZSAnUyc6IHJldHVybiBzaG9ydC5jbGFzczsKICAg\nICAgICAgICAgICAgIGNhc2UgJ1onOiByZXR1cm4gYm9vbGVhbi5jbGFzczsK\nICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBudWxsOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgQ2xhc3M8Pz4g\ncmVzb2x2ZUNsYXNzKE9iamVjdFN0cmVhbUNsYXNzIGNsYXNzRGVzYykKICAg\nICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhj\nZXB0aW9uIHsKCiAgICAgICAgICAgIFN0cmluZyBjbmFtZSA9IGNsYXNzRGVz\nYy5nZXROYW1lKCk7CiAgICAgICAgICAgIGlmIChjbmFtZS5zdGFydHNXaXRo\nKCJbIikpIHsKICAgICAgICAgICAgICAgIC8vIEFuIGFycmF5CiAgICAgICAg\nICAgICAgICBDbGFzczw/PiBjb21wb25lbnQ7CQkvLyBjb21wb25lbnQgY2xh\nc3MKICAgICAgICAgICAgICAgIGludCBkY291bnQ7CQkJICAgIC8vIGRpbWVu\nc2lvbgogICAgICAgICAgICAgICAgZm9yIChkY291bnQ9MTsgY25hbWUuY2hh\nckF0KGRjb3VudCk9PSdbJzsgZGNvdW50KyspIDsKICAgICAgICAgICAgICAg\nIGlmIChjbmFtZS5jaGFyQXQoZGNvdW50KSA9PSAnTCcpIHsKICAgICAgICAg\nICAgICAgICAgICBjb21wb25lbnQgPSBsb29rdXBDbGFzcyhjbmFtZS5zdWJz\ndHJpbmcoZGNvdW50KzEsCiAgICAgICAgICAgICAgICAgICAgICAgIGNuYW1l\nLmxlbmd0aCgpLTEpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGNuYW1lLmxlbmd0aCgpICE9IGRjb3VudCsx\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uKGNuYW1lKTsvLyBtYWxmb3JtZWQKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50ID0g\ncHJpbWl0aXZlVHlwZShjbmFtZS5jaGFyQXQoZGNvdW50KSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICBpbnQgZGltW10gPSBuZXcgaW50\nW2Rjb3VudF07CiAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8ZGNv\ndW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBkaW1baV09MDsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5u\nZXdJbnN0YW5jZShjb21wb25lbnQsIGRpbSkuZ2V0Q2xhc3MoKTsKICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBsb29rdXBD\nbGFzcyhjbmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIElmIHRoaXMgaXMgYSBnZW5lcmF0ZWQgc3ViY2xh\nc3MsIGxvb2sgdXAgdGhlIGNvcnJlc3BvbmRpbmcgQ2xhc3MKICAgICAgICAg\nKiBvYmplY3QgdmlhIG1ldGFkYXRhLgogICAgICAgICAqLwogICAgICAgIHBy\naXZhdGUgQ2xhc3M8Pz4gbG9va3VwQ2xhc3MoU3RyaW5nIGNsYXNzTmFtZSkK\nICAgICAgICAgICAgdGhyb3dzIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIENsYXNz\nLmZvck5hbWUoY2xhc3NOYW1lKTsKICAgICAgICAgICAgfSBjYXRjaCAoQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBpZiAo\nUENFbmhhbmNlci5pc1BDU3ViY2xhc3NOYW1lKGNsYXNzTmFtZSkpIHsKICAg\nICAgICAgICAgICAgICAgICBTdHJpbmcgc3VwZXJOYW1lID0gUENFbmhhbmNl\nci50b01hbmFnZWRUeXBlTmFtZShjbGFzc05hbWUpOwogICAgICAgICAgICAg\nICAgICAgIENsYXNzTWV0YURhdGFbXSBtZXRhcyA9IGNvbmYuZ2V0TWV0YURh\ndGFSZXBvc2l0b3J5SW5zdGFuY2UoKQogICAgICAgICAgICAgICAgICAgICAg\nICAuZ2V0TWV0YURhdGFzKCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBtZXRhcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAoc3VwZXJOYW1lLmVxdWFscygKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG1ldGFzW2ldLmdldERlc2NyaWJlZFR5cGUo\nKS5nZXROYW1lKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gUENSZWdpc3RyeS5nZXRQQ1R5cGUoCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbWV0YXNbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3QgZm91bmQs\nIHRyeSB0byBsb29rIGZvciBpdCBhbnl3YXlzCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIENsYXNzLmZvck5hbWUoY2xhc3NOYW1lKTsKICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBkZXRhY2goT2JqZWN0IGVudGl0eSkgewog\nICAgICAgIGlmIChlbnRpdHkgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cg\nbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgibnVsbC1k\nZXRhY2giKS5nZXRNZXNzYWdlKCkpOwogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZGV0YWNoKGVudGl0eSwgdGhp\ncyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBxdWVyeSBmcm9t\nIHRoZSBnaXZlbiBDcml0cmlhUXVlcnkuCiAgICAgKiBDb21waWxlIHRvIHJl\nZ2lzdGVyIHRoZSBwYXJhbWV0ZXJzIGluIHRoaXMgcXVlcnkuCiAgICAgKi8K\nICAgIHB1YmxpYyA8VD4gVHlwZWRRdWVyeTxUPiBjcmVhdGVRdWVyeShDcml0\nZXJpYVF1ZXJ5PFQ+IGNyaXRlcmlhUXVlcnkpIHsKICAgICAgICAoKE9wZW5K\nUEFDcml0ZXJpYVF1ZXJ5PFQ+KWNyaXRlcmlhUXVlcnkpLmNvbXBpbGUoKTsg\nCiAgICAgICAgCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5R\ndWVyeSBrZXJuZWxRdWVyeSA9X2Jyb2tlci5uZXdRdWVyeShDcml0ZXJpYUJ1\naWxkZXJJbXBsLkxBTkdfQ1JJVEVSSUEsIGNyaXRlcmlhUXVlcnkpOwogICAg\nICAgIAogICAgICAgIFF1ZXJ5SW1wbDxUPiBmYWNhZGVRdWVyeSA9IG5ld1F1\nZXJ5SW1wbChrZXJuZWxRdWVyeSkuc2V0SWQoY3JpdGVyaWFRdWVyeS50b1N0\ncmluZygpKTsKICAgICAgICBTZXQ8UGFyYW1ldGVyRXhwcmVzc2lvbjw/Pj4g\ncGFyYW1zID0gY3JpdGVyaWFRdWVyeS5nZXRQYXJhbWV0ZXJzKCk7CiAgICAg\nICAgCiAgICAgICAgZm9yIChQYXJhbWV0ZXJFeHByZXNzaW9uPD8+IHBhcmFt\nIDogcGFyYW1zKSB7CiAgICAgICAgICAgIGZhY2FkZVF1ZXJ5LmRlY2xhcmVQ\nYXJhbWV0ZXIocGFyYW0sIHBhcmFtKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIGZhY2FkZVF1ZXJ5OwogICAgfQogICAgCiAgICBwdWJsaWMgT3BlbkpQ\nQVF1ZXJ5IGNyZWF0ZUR5bmFtaWNRdWVyeSgKICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UucXVlcnkuUXVlcnlEZWZpbml0aW9uIHFk\nZWYpIHsKICAgICAgICBTdHJpbmcganBxbCA9IF9lbWYuZ2V0RHluYW1pY1F1\nZXJ5QnVpbGRlcigpLnRvSlBRTChxZGVmKTsKICAgICAgICByZXR1cm4gY3Jl\nYXRlUXVlcnkoanBxbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXQgdGhl\nIHByb3BlcnRpZXMgdXNlZCBjdXJyZW50bHkgYnkgdGhpcyBlbnRpdHkgbWFu\nYWdlci4KICAgICAqIFRoZSBwcm9wZXJ0eSBrZXlzIGFuZCB0aGVpciB2YWx1\nZXMgYXJlIGhhcnZlc3RlZCBmcm9tIGtlcm5lbCBhcnRpZmFjdHMgbmFtZWx5\nCiAgICAgKiB0aGUgQnJva2VyIGFuZCBGZXRjaFBsYW4gYnkgcmVmbGVjdGlv\nbi4KICAgICAqIFRoZXNlIHByb3BlcnR5IGtleXMgYW5kIHZhbHVlcyB0aGF0\nIGRlbm90ZSB0aGUgYmVhbiBwcm9wZXJ0aWVzL3ZhbHVlcyBvZiB0aGUga2Vy\nbmVsIGFydGlmYWN0cwogICAgICogYXJlIGNvbnZlcnRlZCB0byB0aGUgb3Jp\nZ2luYWwga2V5cy92YWx1ZXMgdGhhdCB1c2VyIHVzZWQgdG8gc2V0IHRoZSBw\ncm9wZXJ0aWVzLgogICAgICogICAgCiAgICAgKi8KICAgIHB1YmxpYyBNYXA8\nU3RyaW5nLCBPYmplY3Q+IGdldFByb3BlcnRpZXMoKSB7CiAgICAgICAgTWFw\nPFN0cmluZyxPYmplY3Q+IHByb3BzID0gX2Jyb2tlci5nZXRQcm9wZXJ0aWVz\nKCk7CiAgICAgICAgZm9yIChTdHJpbmcgcyA6IF9icm9rZXIuZ2V0U3VwcG9y\ndGVkUHJvcGVydGllcygpKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXJuZWxL\nZXkgPSBnZXRCZWFuUHJvcGVydHlOYW1lKHMpOwogICAgICAgICAgICBNZXRo\nb2QgZ2V0dGVyID0gUmVmbGVjdGlvbi5maW5kR2V0dGVyKHRoaXMuZ2V0Q2xh\nc3MoKSwga2VybmVsS2V5LCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChnZXR0\nZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgU3RyaW5nIHVzZXJLZXkg\nPSBKUEFQcm9wZXJ0aWVzLmdldFVzZXJOYW1lKGtlcm5lbEtleSk7CiAgICAg\nICAgICAgICAgICBPYmplY3Qga3ZhbHVlICA9IFJlZmxlY3Rpb24uZ2V0KHRo\naXMsIGdldHRlcik7CiAgICAgICAgICAgICAgICBwcm9wcy5wdXQodXNlcktl\neS5lcXVhbHMoa2VybmVsS2V5KSA/IHMgOiB1c2VyS2V5LCBKUEFQcm9wZXJ0\naWVzLmNvbnZlcnRUb1VzZXJWYWx1ZSh1c2VyS2V5LCBrdmFsdWUpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBGZXRjaFBsYW4gZmV0Y2gg\nPSBnZXRGZXRjaFBsYW4oKTsKICAgICAgICBDbGFzczw/PiBmZXRjaFR5cGUg\nPSBmZXRjaC5nZXRDbGFzcygpOwogICAgICAgIFNldDxTdHJpbmc+IGZQcm9w\nZXJ0aWVzID0gUmVmbGVjdGlvbi5nZXRCZWFuU3R5bGVQcm9wZXJ0eU5hbWVz\nKGZldGNoVHlwZSk7CiAgICAgICAgZm9yIChTdHJpbmcgcyA6IGZQcm9wZXJ0\naWVzKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXJuZWxLZXkgPSBnZXRCZWFu\nUHJvcGVydHlOYW1lKHMpOwogICAgICAgICAgICBNZXRob2QgZ2V0dGVyID0g\nUmVmbGVjdGlvbi5maW5kR2V0dGVyKGZldGNoVHlwZSwga2VybmVsS2V5LCBm\nYWxzZSk7CiAgICAgICAgICAgIGlmIChnZXR0ZXIgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgU3RyaW5nIHVzZXJLZXkgPSBKUEFQcm9wZXJ0aWVzLmdl\ndFVzZXJOYW1lKGtlcm5lbEtleSk7CiAgICAgICAgICAgICAgICBPYmplY3Qg\na3ZhbHVlICA9IFJlZmxlY3Rpb24uZ2V0KGZldGNoLCBnZXR0ZXIpOwogICAg\nICAgICAgICAgICAgcHJvcHMucHV0KHVzZXJLZXkuZXF1YWxzKGtlcm5lbEtl\neSkgPyBzIDogdXNlcktleSwgSlBBUHJvcGVydGllcy5jb252ZXJ0VG9Vc2Vy\nVmFsdWUodXNlcktleSwga3ZhbHVlKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIHByb3BzOwogICAgfQoKICAgIHB1YmxpYyBP\ncGVuSlBBQ3JpdGVyaWFCdWlsZGVyIGdldENyaXRlcmlhQnVpbGRlcigpIHsK\nICAgICAgICByZXR1cm4gX2VtZi5nZXRDcml0ZXJpYUJ1aWxkZXIoKTsKICAg\nIH0KCiAgICBwdWJsaWMgU2V0PFN0cmluZz4gZ2V0U3VwcG9ydGVkUHJvcGVy\ndGllcygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRTdXBwb3J0ZWRQ\ncm9wZXJ0aWVzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVbndyYXBzIHRo\naXMgcmVjZWl2ZXIgdG8gYW4gaW5zdGFuY2Ugb2YgdGhlIGdpdmVuIGNsYXNz\nLCBpZiBwb3NzaWJsZS4KICAgICAqIAogICAgICogQGV4Y2VwdGlvbiBpZiB0\naGUgZ2l2ZW4gY2xhc3MgaXMgbnVsbCwgZ2VuZXJpYyA8Y29kZT5PYmplY3Qu\nY2xhc3M8L2NvZGU+IG9yIGEgY2xhc3MKICAgICAqIHRoYXQgaXMgbm90IHdy\nYXBwZWQgYnkgdGhpcyByZWNlaXZlci4gIAogICAgICovCiAgICBwdWJsaWMg\nPFQ+IFQgdW53cmFwKENsYXNzPFQ+IGNscykgewogICAgICAgIE9iamVjdFtd\nIGRlbGVnYXRlcyA9IG5ldyBPYmplY3RbXXtfYnJva2VyLmdldElubmVybW9z\ndERlbGVnYXRlKCksCiAgICAgICAgICAgIF9icm9rZXIuZ2V0RGVsZWdhdGUo\nKSwgX2Jyb2tlciwgdGhpc307CiAgICAgICAgZm9yIChPYmplY3QgbyA6IGRl\nbGVnYXRlcykgewogICAgICAgICAgICBpZiAoY2xzICE9IG51bGwgJiYgY2xz\nICE9IE9iamVjdC5jbGFzcyAmJiBjbHMuaXNJbnN0YW5jZShvKSkKICAgICAg\nICAgICAgICAgIHJldHVybiAoVClvOwogICAgICAgIH0KICAgICAgICAvLyBT\nZXQgdGhpcyB0cmFuc2FjdGlvbiB0byByb2xsYmFjayBvbmx5IChhcyBwZXIg\nc3BlYykgaGVyZSBiZWNhdXNlIHRoZSByYWlzZWQgZXhjZXB0aW9uIAogICAg\nICAgIC8vIGRvZXMgbm90IGdvIHRocm91Z2ggbm9ybWFsIGV4Y2VwdGlvbiB0\ncmFuc2xhdGlvbiBwYXRod2F5cwogICAgICAgIFJ1bnRpbWVFeGNlcHRpb24g\nZXggPSBuZXcgUGVyc2lzdGVuY2VFeGNlcHRpb24oX2xvYy5nZXQoInVud3Jh\ncC1lbS1pbnZhbGlkIiwgY2xzKS50b1N0cmluZygpLCBudWxsLCAKICAgICAg\nICAgICAgICAgIHRoaXMsIGZhbHNlKTsKICAgICAgICBpZiAoaXNBY3RpdmUo\nKSkKICAgICAgICAgICAgc2V0Um9sbGJhY2tPbmx5KGV4KTsKICAgICAgICB0\naHJvdyBleDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRRdWVyeVNRTENh\nY2hlKGJvb2xlYW4gZmxhZykgewogICAgICAgIF9icm9rZXIuc2V0Q2FjaGVQ\ncmVwYXJlZFF1ZXJ5KGZsYWcpOwogICAgfQogICAgCiAgICBwdWJsaWMgYm9v\nbGVhbiBnZXRRdWVyeVNRTENhY2hlKCkgewogICAgICAgIHJldHVybiBfYnJv\na2VyLmdldENhY2hlUHJlcGFyZWRRdWVyeSgpOwogICAgfQogICAgCiAgICBS\ndW50aW1lRXhjZXB0aW9uVHJhbnNsYXRvciBnZXRFeGNlcHRpb25UcmFuc2xh\ndG9yKCkgewogICAgICAgIHJldHVybiBfcmV0OwogICAgfQoKICAgIC8qKgog\nICAgICogUG9wdWxhdGUgdGhlIGdpdmVuIEZldGNoUGxhbiB3aXRoIHRoZSBn\naXZlbiBwcm9wZXJ0aWVzLiAKICAgICAqIE9wdGlvbmFsbHkgb3ZlcnJpZGVz\nIHRoZSBnaXZlbiBsb2NrIG1vZGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKEZldGNoUGxhbiBmZXRjaCwg\nTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzLCAKICAgICAgICAgICAg\nTG9ja01vZGVUeXBlIGxvY2ssIGJvb2xlYW4gcmVxdWlyZXNUeG4pIHsKICAg\nICAgICAvLyBoYW5kbGUgcHJvcGVydGllcyBpbiBtYXAgZmlyc3QKICAgICAg\nICBpZiAocHJvcGVydGllcyAhPSBudWxsKSB7CiAgICAgICAgICAgIGZvciAo\nTWFwLkVudHJ5PFN0cmluZywgT2JqZWN0PiBlbnRyeSA6IHByb3BlcnRpZXMu\nZW50cnlTZXQoKSkKICAgICAgICAgICAgICAgIGZldGNoLnNldEhpbnQoZW50\ncnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgIH0KICAg\nICAgICAvLyBvdmVycmlkZSB3aXRoIHRoZSBzcGVjaWZpYyBsb2NrTW9kZSwg\naWYgbmVlZGVkLgogICAgICAgIGlmIChsb2NrICE9IG51bGwgJiYgbG9jayAh\nPSBMb2NrTW9kZVR5cGUuTk9ORSkgewogICAgICAgICAgICBpZiAocmVxdWly\nZXNUeG4pIHsKICAgICAgICAgICAgICAgIF9icm9rZXIuYXNzZXJ0QWN0aXZl\nVHJhbnNhY3Rpb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBP\ndmVycmlkZSByZWFkIGxvY2sgbGV2ZWwKICAgICAgICAgICAgTG9ja01vZGVU\neXBlIGN1clJlYWRMb2NrTW9kZSA9IGZldGNoLmdldFJlYWRMb2NrTW9kZSgp\nOwogICAgICAgICAgICBpZiAobG9jayAhPSBjdXJSZWFkTG9ja01vZGUpCiAg\nICAgICAgICAgICAgICBmZXRjaC5zZXRSZWFkTG9ja01vZGUobG9jayk7CiAg\nICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAqIFBvcHVsYXRlIHRo\nZSBmZXRjaCBjb25maWd1cmF0aW9uIHdpdGggc3BlY2lmaWVkIGNhY2hlIG1v\nZGUgcHJvcGVydGllcy4KICAgICAqIFRoZSBjYWNoZSBtb2RlIHByb3BlcnRp\nZXMgbW9kaWZ5IHRoZSBmZXRjaCBjb25maWd1cmF0aW9uIGFuZCByZW1vdmUg\ndGhvc2UKICAgICAqIHByb3BlcnRpZXMuIFRoaXMgbWV0aG9kIHNob3VsZCBi\nZSBjYWxsZWQgPGVtPmJlZm9yZTwvZW0+IHRoZSBmZXRjaCBjb25maWd1cmF0\naW9uIG9mIHRoZSBjdXJyZW50IAogICAgICogY29udGV4dCBoYXMgYmVlbiBw\ndXNoZWQuCiAgICAgKiBAcGFyYW0gZmV0Y2ggdGhlIGZldGNoIGNvbmZpZ3Vy\nYXRpb24gb2YgdGhlIGN1cnJlbnQgY29udGV4dC4gTm90IHRoZSAKICAgICAq\nIG5ldyBjb25maWd1cmF0aW9uIHB1c2hlZCAoYW5kIGxhdGVyIHBvcHBlZCkg\nZHVyaW5nIGEgc2luZ2xlIG9wZXJhdGlvbi4KICAgICAqIAogICAgICogQHBh\ncmFtIHByb3BlcnRpZXMKICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNvbmZp\nZ3VyZUN1cnJlbnRDYWNoZU1vZGVzKEZldGNoUGxhbiBmZXRjaCwgTWFwPFN0\ncmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzKSB7CiAgICAgICAgaWYgKHByb3Bl\ncnRpZXMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIENh\nY2hlUmV0cmlldmVNb2RlIHJNb2RlID0gSlBBUHJvcGVydGllcy5nZXRFbnVt\nVmFsdWUoQ2FjaGVSZXRyaWV2ZU1vZGUuY2xhc3MsIAogICAgICAgICAgICAg\nICAgSlBBUHJvcGVydGllcy5DQUNIRV9SRVRSSUVWRV9NT0RFLCBwcm9wZXJ0\naWVzKTsKICAgICAgICBpZiAock1vZGUgIT0gbnVsbCkgewogICAgICAgICAg\nICBmZXRjaC5zZXRDYWNoZVJldHJpZXZlTW9kZShKUEFQcm9wZXJ0aWVzLmNv\nbnZlcnRUb0tlcm5lbFZhbHVlKERhdGFDYWNoZVJldHJpZXZlTW9kZS5jbGFz\ncywgCiAgICAgICAgICAgICAgICAgICAgSlBBUHJvcGVydGllcy5DQUNIRV9S\nRVRSSUVWRV9NT0RFLCByTW9kZSkpOwogICAgICAgICAgICBwcm9wZXJ0aWVz\nLnJlbW92ZShKUEFQcm9wZXJ0aWVzLkNBQ0hFX1JFVFJJRVZFX01PREUpOwog\nICAgICAgIH0KICAgICAgICBDYWNoZVN0b3JlTW9kZSBzTW9kZSA9IEpQQVBy\nb3BlcnRpZXMuZ2V0RW51bVZhbHVlKENhY2hlU3RvcmVNb2RlLmNsYXNzLCAK\nICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMuQ0FDSEVfU1RPUkVfTU9E\nRSwgcHJvcGVydGllcyk7CiAgICAgICAgaWYgKHNNb2RlICE9IG51bGwpIHsK\nICAgICAgICAgICAgZmV0Y2guc2V0Q2FjaGVTdG9yZU1vZGUoSlBBUHJvcGVy\ndGllcy5jb252ZXJ0VG9LZXJuZWxWYWx1ZShEYXRhQ2FjaGVTdG9yZU1vZGUu\nY2xhc3MsIAogICAgICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMuQ0FD\nSEVfU1RPUkVfTU9ERSwgc01vZGUpKTsKICAgICAgICAgICAgcHJvcGVydGll\ncy5yZW1vdmUoSlBBUHJvcGVydGllcy5DQUNIRV9TVE9SRV9NT0RFKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIE1ldGFtb2RlbCBnZXRNZXRhbW9k\nZWwoKSB7CiAgICAgICAgcmV0dXJuIF9lbWYuZ2V0TWV0YW1vZGVsKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBnaXZlbiBwcm9wZXJ0eSB0\nbyB0aGUgZ2l2ZW4gdmFsdWUsIHJlZmxlY3RpdmVseS4KICAgICAqIAogICAg\nICogVGhlIHByb3BlcnR5IGtleSBpcyB0cmFuc3Bvc2VkIHRvIGEgYmVhbi1z\ndHlsZSBwcm9wZXJ0eS4KICAgICAqIFRoZSB2YWx1ZSBpcyBjb252ZXJ0ZWQg\ndG8gYSB0eXBlIGNvbnN1bWFibGUgYnkgdGhlIGtlcm5lbC4KICAgICAqIEFm\ndGVyIHJlcXVpc2l0ZSB0cmFuc2Zvcm1hdGlvbiwgaWYgdGhlIHZhbHVlIGNh\nbiBub3QgYmUgc2V0CiAgICAgKiBvbiBlaXRoZXIgdGhpcyBpbnN0YW5jZSBv\nciBpdHMgZmV0Y2ggcGxhbiBieSByZWZsZWN0aW9uLAogICAgICogdGhlbiBh\nbiB3YXJuaW5nIG1lc3NhZ2UgKG5vdCBhbiBleGNlcHRpb24gYXMgcGVyIEpQ\nQSBzcGVjaWZpY2F0aW9uKSBpcyBpc3N1ZWQuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFByb3BlcnR5KFN0cmluZyBwcm9wLCBPYmplY3QgdmFsdWUp\nIHsKICAgICAgICBpZiAoIXNldEtlcm5lbFByb3BlcnR5KHRoaXMsIHByb3As\nIHZhbHVlKSkgewogICAgICAgICAgICBpZiAoIXNldEtlcm5lbFByb3BlcnR5\nKHRoaXMuZ2V0RmV0Y2hQbGFuKCksIHByb3AsIHZhbHVlKSkgewogICAgICAg\nICAgICAgICAgTG9nIGxvZyA9IGdldENvbmZpZ3VyYXRpb24oKS5nZXRMb2co\nT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAgICAg\nICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBsb2cud2FybihfbG9jLmdldCgiaWdub3JlZC1lbS1wcm9wIiwg\ncHJvcCwgdmFsdWUgPT0gbnVsbCA/ICIiIDogdmFsdWUuZ2V0Q2xhc3MoKSsi\nOiIgKyB2YWx1ZSkpOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBBdHRlbXB0\nIHRvIHNldCB0aGUgZ2l2ZW4gcHJvcGVydHkgYW5kIHZhbHVlIHRvIHRoZSBn\naXZlbiB0YXJnZXQgaW5zdGFuY2UuCiAgICAgKiBUaGUgb3JpZ2luYWwgcHJv\ncGVydHkgaXMgdHJhbnNwb3NlZCB0byBhIGJlYW4tc3R5bGUgcHJvcGVydHkg\nbmFtZS4KICAgICAqIFRoZSBvcmlnaW5hbCB2YWx1ZSBpcyB0cmFuc2Zvcm1l\nZCB0byBhIHR5cGUgY29uc3VtYWJsZSBieSB0aGUgdGFyZ2V0LgogICAgICog\nIAogICAgICogQHJldHVybiBpZiB0aGUgcHJvcGVydHkgY2FuIGJlIHNldCB0\nbyB0aGUgZ2l2ZW4gdGFyZ2V0LgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc2V0S2VybmVsUHJvcGVydHkoT2JqZWN0IHRhcmdldCwgU3RyaW5nIG9y\naWdpbmFsLCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBTdHJpbmcgYmVhblBy\nb3AgPSBnZXRCZWFuUHJvcGVydHlOYW1lKG9yaWdpbmFsKTsKICAgICAgICBK\nUEFQcm9wZXJ0aWVzLnJlY29yZChiZWFuUHJvcCwgb3JpZ2luYWwpOwogICAg\nICAgIENsYXNzPD8+IGtUeXBlICA9IG51bGw7CiAgICAgICAgT2JqZWN0ICAg\na1ZhbHVlID0gbnVsbDsKICAgICAgICBNZXRob2Qgc2V0dGVyID0gUmVmbGVj\ndGlvbi5maW5kU2V0dGVyKHRhcmdldC5nZXRDbGFzcygpLCBiZWFuUHJvcCwg\nZmFsc2UpOwogICAgICAgIGlmIChzZXR0ZXIgIT0gbnVsbCkgewogICAgICAg\nICAgICBrVHlwZSAgPSBzZXR0ZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKVswXTsK\nICAgICAgICAgICAga1ZhbHVlID0gY29udmVydFVzZXJWYWx1ZShvcmlnaW5h\nbCwgdmFsdWUsIGtUeXBlKTsKICAgICAgICAgICAgUmVmbGVjdGlvbi5zZXQo\ndGFyZ2V0LCBzZXR0ZXIsIGtWYWx1ZSk7CiAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIEZpZWxkIGZpZWxk\nID0gUmVmbGVjdGlvbi5maW5kRmllbGQodGFyZ2V0LmdldENsYXNzKCksIGJl\nYW5Qcm9wLCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChmaWVsZCAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBrVHlwZSAgPSBmaWVsZC5nZXRUeXBlKCk7\nCiAgICAgICAgICAgICAgICBrVmFsdWUgPSBjb252ZXJ0VXNlclZhbHVlKG9y\naWdpbmFsLCB2YWx1ZSwga1R5cGUpOwogICAgICAgICAgICAgICAgUmVmbGVj\ndGlvbi5zZXQodGFyZ2V0LCBmaWVsZCwga1ZhbHVlKTsKICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBF\neHRyYWN0IGEgYmVhbi1zdHlsZSBwcm9wZXJ0eSBuYW1lIGZyb20gdGhlIGdp\ndmVuIHN0cmluZy4KICAgICAqIElmIHRoZSBnaXZlbiBzdHJpbmcgaXMgPGNv\nZGU+ImEuYi54eXoiPC9jb2RlPiB0aGVuIHJldHVybnMgPGNvZGU+Inh5eiI8\nL2NvZGU+IAogICAgICovCiAgICBTdHJpbmcgZ2V0QmVhblByb3BlcnR5TmFt\nZShTdHJpbmcgdXNlcikgewogICAgICAgIFN0cmluZyByZXN1bHQgPSB1c2Vy\nOwogICAgICAgIGlmIChKUEFQcm9wZXJ0aWVzLmlzVmFsaWRLZXkodXNlcikp\nIHsKICAgICAgICAgICAgcmVzdWx0ID0gSlBBUHJvcGVydGllcy5nZXRCZWFu\nUHJvcGVydHkodXNlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\naW50IGRvdCA9IHVzZXIubGFzdEluZGV4T2YoJy4nKTsKICAgICAgICAgICAg\naWYgKGRvdCAhPSAtMSkKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHVzZXIu\nc3Vic3RyaW5nKGRvdCsxKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJl\nc3VsdDsgCiAgICB9CiAgICAKICAgIAogICAgLyoqCiAgICAgKiBDb252ZXJ0\nIHRoZSBnaXZlbiB2YWx1ZSB0byBhIHZhbHVlIGNvbnN1bWFibGUgYnkgT3Bl\nbkpQQSBrZXJuZWwgY29uc3RydWN0cy4KICAgICAqLwogICAgT2JqZWN0IGNv\nbnZlcnRVc2VyVmFsdWUoU3RyaW5nIGtleSwgT2JqZWN0IHZhbHVlLCBDbGFz\nczw/PiB0YXJnZXRUeXBlKSB7CiAgICAgICAgaWYgKEpQQVByb3BlcnRpZXMu\naXNWYWxpZEtleShrZXkpKSAKICAgICAgICAgICAgcmV0dXJuIEpQQVByb3Bl\ncnRpZXMuY29udmVydFRvS2VybmVsVmFsdWUodGFyZ2V0VHlwZSwga2V5LCB2\nYWx1ZSk7CiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSB7\nCiAgICAgICAgICAgIGlmICgibnVsbCIuZXF1YWxzKHZhbHVlKSkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5ncy5wYXJzZSgoU3RyaW5n\nKSB2YWx1ZSwgdGFyZ2V0VHlwZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQp9Cg==\n","encoding":"base64"}

