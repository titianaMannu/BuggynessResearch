{"sha":"cbd8be4ae5ff8b166690193ad6a0f1ea3f281d5d","node_id":"MDQ6QmxvYjIwNjM2NDpjYmQ4YmU0YWU1ZmY4YjE2NjY5MDE5M2FkNmEwZjFlYTNmMjgxZDVk","size":13978,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/cbd8be4ae5ff8b166690193ad6a0f1ea3f281d5d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uOwoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5NaXhlZExvY2tMZXZlbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5FeGNlcHRpb25zOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTG9ja0V4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk5vVHJhbnNhY3Rpb25F\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PYmpl\nY3RFeGlzdHNFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5PYmplY3ROb3RGb3VuZEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5PcHRpbWlzdGljRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuUXVlcnlFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5SdW50aW1lRXhjZXB0aW9u\nVHJhbnNsYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlN0\nb3JlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nVXNlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLldyYXBwZWRFeGNlcHRpb247CgovKioKICogQ29udmVydHMgZnJvbSBPcGVu\nSlBBIHRvIHBlcnNpc3RlbmNlIGV4Y2VwdGlvbiB0eXBlcy4KICoKICogQGF1\ndGhvciBBYmUgV2hpdGUKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgK\nICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNlRXhj\nZXB0aW9ucwogICAgZXh0ZW5kcyBFeGNlcHRpb25zIHsKCiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIFJ1bnRpbWVFeGNlcHRpb25UcmFuc2xhdG9yIFRSQU5T\nTEFUT1IgPQogICAgICAgIG5ldyBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRv\ncigpIHsKICAgICAgICAgICAgcHVibGljIFJ1bnRpbWVFeGNlcHRpb24gdHJh\nbnNsYXRlKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgICAg\nIHJldHVybiBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4\nY2VwdGlvbihyZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgIC8q\nKgogICAgICogUmV0dXJucyBhIHtAbGluayBSdW50aW1lRXhjZXB0aW9uVHJh\nbnNsYXRvcn0gdGhhdCB3aWxsIHBlcmZvcm0KICAgICAqIHRoZSBjb3JyZWN0\nIGV4Y2VwdGlvbiB0cmFuc2xhdGlvbiBhcyB3ZWxsIGFzIHJvbGwgYmFjayB0\naGUKICAgICAqIGN1cnJlbnQgdHJhbnNhY3Rpb24gd2hlbiBmb3IgYWxsIGJ1\ndCB7QGxpbmsgTm9SZXN1bHRFeGNlcHRpb259CiAgICAgKiBhbmQge0BsaW5r\nIE5vblVuaXF1ZVJlc3VsdEV4Y2VwdGlvbn0gaW4gYWNjb3JkYW5jZSB3aXRo\nCiAgICAgKiBzZWN0aW9uIDMuNyBvZiB0aGUgRUpCIDMuMCBzcGVjaWZpY2F0\naW9uLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFJ1bnRpbWVFeGNlcHRp\nb25UcmFuc2xhdG9yIGdldFJvbGxiYWNrVHJhbnNsYXRvcigKICAgICAgICBm\naW5hbCBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSkgewogICAgICAgIHJldHVy\nbiBuZXcgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3IoKSB7CiAgICAgICAg\nICAgIHByaXZhdGUgYm9vbGVhbiB0aHJvd2luZyA9IGZhbHNlOwoKICAgICAg\nICAgICAgcHVibGljIFJ1bnRpbWVFeGNlcHRpb24gdHJhbnNsYXRlKFJ1bnRp\nbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgICAgIFJ1bnRpbWVFeGNl\ncHRpb24gZXggPSB0b1BlcnNpc3RlbmNlRXhjZXB0aW9uKHJlKTsKICAgICAg\nICAgICAgICAgIGlmICghKGV4IGluc3RhbmNlb2YgTm9uVW5pcXVlUmVzdWx0\nRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgICAgICYmICEoZXggaW5zdGFu\nY2VvZiBOb1Jlc3VsdEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICAm\nJiAhKGV4IGluc3RhbmNlb2YgTG9ja1RpbWVvdXRFeGNlcHRpb24pCiAgICAg\nICAgICAgICAgICAgICAgJiYgIShleCBpbnN0YW5jZW9mIFF1ZXJ5VGltZW91\ndEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICAmJiAhdGhyb3dpbmcp\nIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgICAgICB0aHJvd2luZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChlbS5pc09wZW4oKSAmJiAoKEVudGl0eU1hbmFnZXJJbXBsKSBl\nbSkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgo\nRW50aXR5TWFuYWdlckltcGwpIGVtKS5zZXRSb2xsYmFja09ubHkoZXgpOwog\nICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIGhhbmRsZSByZS1lbnRyYW5jeQogICAgICAgICAgICAg\nICAgICAgICAgICB0aHJvd2luZyA9IGZhbHNlOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1\ncm4gZXg7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4gdGhyb3dhYmxlIHRvIHRoZSBw\ncm9wZXIgcGVyc2lzdGVuY2UgZXhjZXB0aW9uLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIFJ1bnRpbWVFeGNlcHRpb24gdG9QZXJzaXN0ZW5jZUV4Y2Vw\ndGlvbihUaHJvd2FibGUgdCkgewogICAgICAgIHJldHVybiAoUnVudGltZUV4\nY2VwdGlvbikgdHJhbnNsYXRlRXhjZXB0aW9uKHQsIHRydWUpOwogICAgfQoK\nICAgIC8qKgogICAgICogVHJhbnNsYXRlIHRoZSBnaXZlbiBleGNlcHRpb24u\nCiAgICAgKgogICAgICogQHBhcmFtIGNoZWNrZWQgd2hldGhlciB0byB0cmFu\nc2xhdGUgY2hlY2tlZCBleGNlcHRpb25zCiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIFRocm93YWJsZSB0cmFuc2xhdGVFeGNlcHRpb24oVGhyb3dhYmxl\nIHQsIGJvb2xlYW4gY2hlY2tlZCkgewogICAgICAgIGlmIChpc1BlcnNpc3Rl\nbmNlRXhjZXB0aW9uKHQpKQogICAgICAgICAgICByZXR1cm4gdDsKCiAgICAg\nICAgLy8gaW1tZWRpYXRlbHkgdGhyb3cgZXJyb3JzCiAgICAgICAgaWYgKHQg\naW5zdGFuY2VvZiBFcnJvcikKICAgICAgICAgICAgdGhyb3cgKEVycm9yKSB0\nOwoKICAgICAgICBPcGVuSlBBRXhjZXB0aW9uIGtlOwogICAgICAgIGlmICgh\nKHQgaW5zdGFuY2VvZiBPcGVuSlBBRXhjZXB0aW9uKSkgewogICAgICAgICAg\nICBpZiAoIWNoZWNrZWQgfHwgdCBpbnN0YW5jZW9mIFJ1bnRpbWVFeGNlcHRp\nb24pCiAgICAgICAgICAgICAgICByZXR1cm4gdDsKICAgICAgICAgICAga2Ug\nPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlv\nbih0LmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIGtlLnNldFN0YWNrVHJh\nY2UodC5nZXRTdGFja1RyYWNlKCkpOwogICAgICAgICAgICByZXR1cm4ga2U7\nCiAgICAgICAgfQoKICAgICAgICAvLyBpZiBvbmx5IG5lc3RlZCBleGNlcHRp\nb24gaXMgYSBwZXJzaXN0ZW5jZSBvbmUsIHJldHVybiBpdCBkaXJlY3RseQog\nICAgICAgIGtlID0gKE9wZW5KUEFFeGNlcHRpb24pIHQ7CiAgICAgICAgaWYg\nKGtlLmdldE5lc3RlZFRocm93YWJsZXMoKS5sZW5ndGggPT0gMQogICAgICAg\nICAgICAmJiBpc1BlcnNpc3RlbmNlRXhjZXB0aW9uKGtlLmdldENhdXNlKCkp\nKQogICAgICAgICAgICByZXR1cm4ga2UuZ2V0Q2F1c2UoKTsKCiAgICAgICAg\nLy8gUnVudGltZUV4Y2VwdGlvbnMgdGhyb3duIGZyb20gY2FsbGJhY2tzIHNo\nb3VsZCBiZSB0aHJvd24gZGlyZWN0bHkKICAgICAgICBpZiAoa2UuZ2V0VHlw\nZSgpID09IE9wZW5KUEFFeGNlcHRpb24uVVNFUgogICAgICAgICAgICAmJiBr\nZS5nZXRTdWJ0eXBlKCkgPT0gVXNlckV4Y2VwdGlvbi5DQUxMQkFDSwogICAg\nICAgICAgICAmJiBrZS5nZXROZXN0ZWRUaHJvd2FibGVzKCkubGVuZ3RoID09\nIDEpIHsKICAgICAgICAgICAgVGhyb3dhYmxlIGUgPSBrZS5nZXRDYXVzZSgp\nOwogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEludm9jYXRpb25UYXJn\nZXRFeGNlcHRpb24pCiAgICAgICAgICAgICAgICBlID0gZS5nZXRDYXVzZSgp\nOwoKICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBSdW50aW1lRXhjZXB0\naW9uKQogICAgICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgfQoKICAg\nICAgICAvLyBwZXJmb3JtIGludGVsbGlnZW50IHRyYW5zbGF0aW9uIG9mIG9w\nZW5qcGEgZXhjZXB0aW9ucwogICAgICAgIHN3aXRjaCAoa2UuZ2V0VHlwZSgp\nKSB7CiAgICAgICAgICAgIGNhc2UgT3BlbkpQQUV4Y2VwdGlvbi5TVE9SRToK\nICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVTdG9yZUV4Y2VwdGlv\nbihrZSk7CiAgICAgICAgICAgIGNhc2UgT3BlbkpQQUV4Y2VwdGlvbi5VU0VS\nOgogICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZVVzZXJFeGNlcHRp\nb24oa2UpOwogICAgICAgICAgICBjYXNlIE9wZW5KUEFFeGNlcHRpb24uV1JB\nUFBFRDoKICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVXcmFwcGVk\nRXhjZXB0aW9uKGtlKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAg\nICAgICAgIHJldHVybiB0cmFuc2xhdGVHZW5lcmFsRXhjZXB0aW9uKGtlKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgdGhl\nIGdpdmVuIHN0b3JlIGV4Y2VwdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBz\ndGF0aWMgVGhyb3dhYmxlIHRyYW5zbGF0ZVN0b3JlRXhjZXB0aW9uKE9wZW5K\nUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICBFeGNlcHRpb24gZTsKICAgICAg\nICBpbnQgc3VidHlwZSA9IGtlLmdldFN1YnR5cGUoKTsKICAgICAgICBTdHJp\nbmcgbXNnICA9IGtlLmdldE1lc3NhZ2UoKTsKICAgICAgICBUaHJvd2FibGVb\nXSBuZXN0ZWQgPSBnZXROZXN0ZWRUaHJvd2FibGVzKGtlKTsKICAgICAgICBP\nYmplY3QgZmFpbGVkID0gZ2V0RmFpbGVkT2JqZWN0KGtlKTsKICAgICAgICBi\nb29sZWFuIGZhdGFsID0ga2UuaXNGYXRhbCgpOwogICAgICAgIFRocm93YWJs\nZSBjYXVzZSA9IChrZS5nZXROZXN0ZWRUaHJvd2FibGVzKCkgIT0gbnVsbAog\nICAgICAgICAgICAgICAgICAgICAgICAmJiBrZS5nZXROZXN0ZWRUaHJvd2Fi\nbGVzKCkubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICAgICAgICAgICA/\nIGtlLmdldE5lc3RlZFRocm93YWJsZXMoKVswXSA6IG51bGw7CiAgICAgICAg\naWYgKHN1YnR5cGUgPT0gU3RvcmVFeGNlcHRpb24uT0JKRUNUX05PVF9GT1VO\nRCB8fCBjYXVzZSBpbnN0YW5jZW9mIE9iamVjdE5vdEZvdW5kRXhjZXB0aW9u\nKSB7CiAgICAgICAgICAgICAgICBlID0gbmV3IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5FbnRpdHlOb3RGb3VuZEV4Y2VwdGlvbihtc2csIG5l\nc3RlZCwgZmFpbGVkLCBmYXRhbCk7CiAgICAgICAgfSBlbHNlIGlmIChzdWJ0\neXBlID09IFN0b3JlRXhjZXB0aW9uLk9QVElNSVNUSUMJfHwgY2F1c2UgaW5z\ndGFuY2VvZiBPcHRpbWlzdGljRXhjZXB0aW9uKSB7CiAgICAgICAgICAgIAll\nID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcHRpbWlz\ndGljTG9ja0V4Y2VwdGlvbihtc2csIG5lc3RlZCwgZmFpbGVkLCBmYXRhbCk7\nCiAgICAgICAgfSBlbHNlIGlmIChzdWJ0eXBlID09IFN0b3JlRXhjZXB0aW9u\nLkxPQ0sgfHwgY2F1c2UgaW5zdGFuY2VvZiBMb2NrRXhjZXB0aW9uKSB7CiAg\nICAgICAgICAgIExvY2tFeGNlcHRpb24gbG9ja0V4ID0gKExvY2tFeGNlcHRp\nb24pIChrZSBpbnN0YW5jZW9mIExvY2tFeGNlcHRpb24gPyBrZSA6IGNhdXNl\nKTsgCiAgICAgICAgICAgIGlmIChsb2NrRXggIT0gbnVsbCAmJiBsb2NrRXgu\nZ2V0TG9ja0xldmVsKCkgPj0gTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfUEVTU0lN\nSVNUSUNfUkVBRCkgeyAKICAgICAgICAgICAgICAgIGlmICghbG9ja0V4Lmlz\nRmF0YWwoKSkgeyAKICAgICAgICAgICAgICAgICAgICBlID0gbmV3IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5Mb2NrVGltZW91dEV4Y2VwdGlv\nbihtc2csIG5lc3RlZCwgZmFpbGVkKTsgCiAgICAgICAgICAgICAgICB9IGVs\nc2UgeyAKICAgICAgICAgICAgICAgICAgICBlID0gbmV3IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5QZXNzaW1pc3RpY0xvY2tFeGNlcHRpb24o\nbXNnLCBuZXN0ZWQsIGZhaWxlZCk7IAogICAgICAgICAgICAgICAgfSAKICAg\nICAgICAgICAgfSBlbHNlIHsgCiAgICAgICAgICAgICAgICBlID0gbmV3IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcHRpbWlzdGljTG9ja0V4\nY2VwdGlvbihtc2csIG5lc3RlZCwgZmFpbGVkLCBmYXRhbCk7IAogICAgICAg\nICAgICB9IAogICAgICAgIH0gZWxzZSBpZiAoc3VidHlwZSA9PSBTdG9yZUV4\nY2VwdGlvbi5PQkpFQ1RfRVhJU1RTIHx8IGNhdXNlIGluc3RhbmNlb2YgT2Jq\nZWN0RXhpc3RzRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICBlID0gbmV3\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5FbnRpdHlFeGlzdHNF\neGNlcHRpb24obXNnLCBuZXN0ZWQsIGZhaWxlZCwgZmF0YWwpOwogICAgICAg\nIH0gZWxzZSBpZiAoc3VidHlwZSA9PSBTdG9yZUV4Y2VwdGlvbi5RVUVSWSB8\nfCBjYXVzZSBpbnN0YW5jZW9mIFF1ZXJ5RXhjZXB0aW9uKSB7CiAgICAgICAg\nICAgIFF1ZXJ5RXhjZXB0aW9uIHF1ZXJ5RXggPSAoUXVlcnlFeGNlcHRpb24p\nIChrZSBpbnN0YW5jZW9mIFF1ZXJ5RXhjZXB0aW9uID8ga2UgOiBjYXVzZSk7\nCiAgICAgICAgICAgIGlmICghcXVlcnlFeC5pc0ZhdGFsKCkpIHsKICAgICAg\nICAgICAgICAgIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLlF1ZXJ5VGltZW91dEV4Y2VwdGlvbihtc2csIG5lc3RlZCwgZmFpbGVk\nLCBmYWxzZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICBlID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5QZXJz\naXN0ZW5jZUV4Y2VwdGlvbihtc2csIG5lc3RlZCwgZmFpbGVkLCB0cnVlKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGUg\nPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLlBlcnNpc3Rl\nbmNlRXhjZXB0aW9uKG1zZywgbmVzdGVkLCBmYWlsZWQsIGZhdGFsKTsKICAg\nICAgICB9CiAgICAgICAgZS5zZXRTdGFja1RyYWNlKGtlLmdldFN0YWNrVHJh\nY2UoKSk7CiAgICAgICAgcmV0dXJuIGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUcmFuc2xhdGUgdGhlIGdpdmVuIHVzZXIgZXhjZXB0aW9uLgogICAgICog\nSWYgYSB7bGluayB7QGxpbmsgT3BlbkpQQUV4Y2VwdGlvbiNnZXRTdWJ0eXBl\nKCkgc3ViIHR5cGV9IGlzIHNldCBvbiB0aGUKICAgICAqIGdpdmVuIGV4Y2Vw\ndGlvbiB0aGVuIGEgY29ycmVzcG9uZGluZyBmYWNhZGUtbGV2ZWwgZXhjZXB0\naW9uIGkuZS4gdGhlCiAgICAgKiBleGNlcHRpb25zIHRoYXQgaW5oZXJpdCBK\nUEEtZGVmaW5lZCBleGNlcHRpb25zIGlzIGdlbmVyYXRlZC4KICAgICAqIElm\nIGdpdmVuIGV4Y2VwdGlvbiBpcyBub3QgZnVydGhlciBjbGFzc2lmaWVkIHRv\nIGEgc3ViIHR5cGUsIHRoZW4KICAgICAqIGFuIFtAbGluayB7QGxpbmsgI3Ry\nYW5zbGF0ZUludGVybmFsRXhjZXB0aW9uKE9wZW5KUEFFeGNlcHRpb24pfSBh\ndHRlbXB0fQogICAgICogaXMgbWFkZSB0byB0cmFuc2xhdGUgdGhlIGdpdmVu\nIE9wZW5KUEFFeGNlcHRpb24gYnkgaXRzIGludGVybmFsIGNhdXNlLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBFeGNlcHRpb24gdHJhbnNsYXRlVXNl\nckV4Y2VwdGlvbihPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgRXhj\nZXB0aW9uIGU7CiAgICAgICAgc3dpdGNoIChrZS5nZXRTdWJ0eXBlKCkpIHsK\nICAgICAgICAgICAgY2FzZSBVc2VyRXhjZXB0aW9uLk5PX1RSQU5TQUNUSU9O\nOgogICAgICAgICAgICAgICAgZSA9IG5ldwogICAgICAgICAgICAgICAgICAg\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5UcmFuc2FjdGlvblJl\ncXVpcmVkRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIChrZS5n\nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2Uu\naXNGYXRhbCgpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIFVzZXJFeGNlcHRpb24uTk9fUkVTVUxUOgogICAgICAgICAgICAg\nICAgZSA9IG5ldyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuTm9S\nZXN1bHRFeGNlcHRpb24KICAgICAgICAgICAgICAgICAgICAoa2UuZ2V0TWVz\nc2FnZSgpLCBnZXROZXN0ZWRUaHJvd2FibGVzKGtlKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2UuaXNGYXRhbCgp\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVz\nZXJFeGNlcHRpb24uTk9OX1VOSVFVRV9SRVNVTFQ6CiAgICAgICAgICAgICAg\nICBlID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5Ob25V\nbmlxdWVSZXN1bHRFeGNlcHRpb24KICAgICAgICAgICAgICAgICAgICAoa2Uu\nZ2V0TWVzc2FnZSgpLCBnZXROZXN0ZWRUaHJvd2FibGVzKGtlKSwKICAgICAg\nICAgICAgICAgICAgICAgICAgZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2UuaXNG\nYXRhbCgpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIFVzZXJFeGNlcHRpb24uSU5WQUxJRF9TVEFURToKICAgICAgICAgICAg\nICAgIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLklu\ndmFsaWRTdGF0ZUV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgIChrZS5n\nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAg\nICAgICAgICAgICAgICAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0Zh\ndGFsKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRl\nZmF1bHQ6CiAgICAgICAgICAgIAllID0gdHJhbnNsYXRlQ2F1c2Uoa2UpOwog\nICAgICAgIH0KICAgICAgICBlLnNldFN0YWNrVHJhY2Uoa2UuZ2V0U3RhY2tU\ncmFjZSgpKTsKICAgICAgICByZXR1cm4gZTsKICAgIH0KICAgIAogICAgLyoK\nICAgICAqIFRyYW5zbGF0ZSB0aGUgZ2l2ZW4gd3JhcHBlZCBleGNlcHRpb24u\nICBJZiBjb250YWlucyBhbiBFeGNlcHRpb24sIHJldHVybgogICAgICogdGhl\nIGV4Y2VwdGlvbi4gIElmIGNvbnRhaW5zIGEgVGhyb3dhYmxlLCB3cmFwIHRo\nZSB0aHJvd2FibGUgYW5kCiAgICAgKiByZXR1cm4gaXQuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIEV4Y2VwdGlvbiB0cmFuc2xhdGVXcmFwcGVkRXhj\nZXB0aW9uKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICBUaHJvd2Fi\nbGUgdCA9IGtlLmdldENhdXNlKCk7CiAgICAgICAgaWYgKHQgaW5zdGFuY2Vv\nZiBFeGNlcHRpb24pCiAgICAgICAgCXJldHVybiAoRXhjZXB0aW9uKXQ7CiAg\nICAgICAgcmV0dXJuIHRyYW5zbGF0ZUNhdXNlKGtlKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRyYW5zbGF0ZSB0byBhIGZhY2FkZS1sZXZlbCBleGNlcHRp\nb24gaWYgdGhlIGdpdmVuIGV4Y2VwdGlvbgogICAgICogICAgIGEpIGhhcyBh\nIGNhdXNlIGkuZS4gb25lIGFuZCBvbmx5IG5lc3RlZCBUaHJvd2FibGUKICAg\nICAqIGFuZCBiKSB0aGF0IGNhdXNlIGlzIG9uZSBvZiB0aGUga25vd24gaW50\nZXJuYWwgZXhjZXB0aW9uIHdoaWNoIGhhcyBhCiAgICAgKiAgICAgICAgZGly\nZWN0IGZhY2FkZS1sZXZlbCBjb3VudGVycGFydAogICAgICogICAgICAgIChm\nb3IgZXhhbXBsZSwgT2JqZWN0Tm90Rm91bmRFeGNlcHRpb24gY2FuIGJlIHRy\nYW5zbGF0ZWQgdG8KICAgICAqICAgICAgICAgRW50aXR5Tm90Rm91bmRFeGNl\ncHRpb24pLgogICAgICogSWYgdGhlIGFib3ZlIGNvbmRpdGlvbnMgYXJlIG5v\ndCBtZXQgdGhlbiByZXR1cm4gZ2VuZXJpYwogICAgICogICAgQXJndW1lbnRF\neGNlcHRpb24uCiAgICAgKgogICAgICogSW4gZWl0aGVyIGNhc2UsIHByZXNl\ncnZlIGFsbCB0aGUgZGV0YWlscy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgRXhjZXB0aW9uIHRyYW5zbGF0ZUNhdXNlKE9wZW5KUEFFeGNlcHRpb24g\na2UpIHsKICAgIAlUaHJvd2FibGUgY2F1c2UgPSBrZS5nZXRDYXVzZSgpOwog\nICAgCWlmIChjYXVzZSBpbnN0YW5jZW9mIE9iamVjdE5vdEZvdW5kRXhjZXB0\naW9uKSB7CiAgICAJCXJldHVybiBuZXcgRW50aXR5Tm90Rm91bmRFeGNlcHRp\nb24oCiAgICAJCSAgICAgICAga2UuZ2V0TWVzc2FnZSgpLCBnZXROZXN0ZWRU\naHJvd2FibGVzKGtlKSwKICAgICAgICAgICAgCSAgICBnZXRGYWlsZWRPYmpl\nY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgCX0gZWxzZSBpZiAoY2F1c2Ug\naW5zdGFuY2VvZiBPYmplY3RFeGlzdHNFeGNlcHRpb24pIHsKICAgIAkJcmV0\ndXJuIG5ldyBFbnRpdHlFeGlzdHNFeGNlcHRpb24oCiAgICAJCSAgICAgICAg\na2UuZ2V0TWVzc2FnZSgpLCBnZXROZXN0ZWRUaHJvd2FibGVzKGtlKSwKICAg\nICAgICAgICAgCSAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFs\nKCkpOwogICAgCX0gZWxzZSBpZiAoY2F1c2UgaW5zdGFuY2VvZiBOb1RyYW5z\nYWN0aW9uRXhjZXB0aW9uKSB7CiAgICAJCXJldHVybiBuZXcgVHJhbnNhY3Rp\nb25SZXF1aXJlZEV4Y2VwdGlvbigKICAgICAgICAJCSAgICBrZS5nZXRNZXNz\nYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgICAgICAg\nICAgCWdldEZhaWxlZE9iamVjdChrZSksIGtlLmlzRmF0YWwoKSk7CiAgICAJ\nfSBlbHNlIGlmIChjYXVzZSBpbnN0YW5jZW9mIE9wdGltaXN0aWNFeGNlcHRp\nb24pIHsKICAgIAkJcmV0dXJuIG5ldyBPcHRpbWlzdGljTG9ja0V4Y2VwdGlv\nbigKICAgICAgICAJCSAgICBrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRo\ncm93YWJsZXMoa2UpLAogICAgICAgICAgICAgICAgCWdldEZhaWxlZE9iamVj\ndChrZSksIGtlLmlzRmF0YWwoKSk7CiAgICAJfSBlbHNlIHsKICAgIAkJcmV0\ndXJuIG5ldyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuQXJndW1l\nbnRFeGNlcHRpb24oCiAgICAgICAgCQlrZS5nZXRNZXNzYWdlKCksIGdldE5l\nc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgIAkJZ2V0RmFpbGVkT2JqZWN0\nKGtlKSwga2UuaXNGYXRhbCgpKTsKICAgIAl9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUcmFuc2xhdGUgdGhlIGdpdmVuIGdlbmVyYWwgZXhjZXB0aW9uLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBUaHJvd2FibGUgdHJhbnNsYXRl\nR2VuZXJhbEV4Y2VwdGlvbihPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAg\nICAgRXhjZXB0aW9uIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLlBlcnNpc3RlbmNlRXhjZXB0aW9uCiAgICAgICAgICAgIChrZS5n\nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAg\nICAgICAgICAgZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2UuaXNGYXRhbCgpKTsK\nICAgICAgICBlLnNldFN0YWNrVHJhY2Uoa2UuZ2V0U3RhY2tUcmFjZSgpKTsK\nICAgICAgICByZXR1cm4gZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0cnVlIGlmIHRoZSBnaXZlbiBleGNlcHRpb24gaXMgYSBwZXJzaXN0ZW5j\nZSBleGNlcHRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xl\nYW4gaXNQZXJzaXN0ZW5jZUV4Y2VwdGlvbihUaHJvd2FibGUgdCkgewogICAg\nICAgIHJldHVybiB0LmdldENsYXNzKCkuZ2V0TmFtZSgpCiAgICAgICAgICAg\nIC5zdGFydHNXaXRoKCJvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgdGhlIG5lc3Rl\nZCB0aHJvd2FibGVzIG9mIHRoZSBnaXZlbiBvcGVuanBhIGV4Y2VwdGlvbiBp\nbnRvCiAgICAgKiBuZXN0ZWQgdGhyb3dhYmxlcyBmb3IgYSBwZXJzaXN0ZW5j\nZSBleGNlcHRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIFRocm93\nYWJsZVtdIGdldE5lc3RlZFRocm93YWJsZXMoT3BlbkpQQUV4Y2VwdGlvbiBr\nZSkgewogICAgICAgIFRocm93YWJsZVtdIG5lc3RlZCA9IGtlLmdldE5lc3Rl\nZFRocm93YWJsZXMoKTsKICAgICAgICBpZiAobmVzdGVkLmxlbmd0aCA9PSAw\nKQogICAgICAgICAgICByZXR1cm4gbmVzdGVkOwoKICAgICAgICBUaHJvd2Fi\nbGVbXSB0cmFucyA9IG5ldyBUaHJvd2FibGVbbmVzdGVkLmxlbmd0aF07CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuZXN0ZWQubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIHRyYW5zW2ldID0gdHJhbnNsYXRlRXhjZXB0aW9uKG5l\nc3RlZFtpXSwgZmFsc2UpOwogICAgICAgIHJldHVybiB0cmFuczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZmFpbGVkIG9iamVjdCBmb3Ig\ndGhlIGdpdmVuIGV4Y2VwdGlvbiwgcGVyZm9ybWluZyBhbnkKICAgICAqIG5l\nY2Vzc2FyeSBjb252ZXJzaW9ucy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgT2JqZWN0IGdldEZhaWxlZE9iamVjdChPcGVuSlBBRXhjZXB0aW9uIGtl\nKSB7CiAgICAgICAgT2JqZWN0IG8gPSBrZS5nZXRGYWlsZWRPYmplY3QoKTsK\nICAgICAgICBpZiAobyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAobyBpbnN0YW5jZW9mIEJyb2tlcikKICAgICAgICAg\nICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci50b0VudGl0eU1hbmFnZXIoKEJy\nb2tlcikgbyk7CiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci5mcm9t\nT3BlbkpQQU9iamVjdElkKG8pOwogICAgfQoKICAgIC8qKgogICAgICogSGVs\ncGVyIG1ldGhvZCB0byBleHRyYWN0IGEgbmVzdGVkIGV4Y2VwdGlvbiBmcm9t\nIGFuIGludGVybmFsIG5lc3RlZAogICAgICogYXJyYXkgaW4gYSBzYWZlIHdh\neS4KICAgICAqLwogICAgc3RhdGljIFRocm93YWJsZSBnZXRDYXVzZShUaHJv\nd2FibGVbXSBuZXN0ZWQpIHsKICAgICAgICBpZiAobmVzdGVkID09IG51bGwg\nfHwgbmVzdGVkLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKCQlyZXR1cm4gbmVzdGVkWzBdOwoJfQp9Cg==\n","encoding":"base64"}

