{"sha":"10ac2b31783102419cc42bddf079124a1433f76b","node_id":"MDQ6QmxvYjIwNjM2NDoxMGFjMmIzMTc4MzEwMjQxOWNjNDJiZGRmMDc5MTI0YTE0MzNmNzZi","size":71628,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/10ac2b31783102419cc42bddf079124a1433f76b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLm5ldC5VUkw7CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwpp\nbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuU3RhY2s7CgppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuQ2FzY2FkZVR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5HZW5l\ncmF0aW9uVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkxvY2tNb2Rl\nVHlwZTsKCmltcG9ydCBzdGF0aWMgamF2YXgucGVyc2lzdGVuY2UuQ2FzY2Fk\nZVR5cGUuKjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5K\nUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVu\naGFuY2UuUGVyc2lzdGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmV2ZW50LkJlYW5MaWZlY3ljbGVDYWxsYmFja3M7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlQ2FsbGJhY2tzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LkxpZmVjeWNsZUV2ZW50\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50Lk1ldGhvZExpZmVj\neWNsZUNhbGxiYWNrczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnlMYW5ndWFnZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLmpwcWwuSlBRTFBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIubWV0YS5DRk1ldGFEYXRhUGFyc2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5tZXRhLlNvdXJjZVRyYWNrZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuWE1MVmVyc2lvblBhcnNlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5BY2Nlc3NDb2RlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkRlbGVnYXRpbmdNZXRh\nRGF0YUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTGlm\nZWN5Y2xlTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5NZXRhRGF0YUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5NZXRhRGF0YUZhY3Rvcnk7CmltcG9ydCBzdGF0aWMgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rlcy4qOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuT3JkZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5RdWVyeU1ldGFEYXRhOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuU2VxdWVuY2VNZXRhRGF0YTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CgppbXBvcnQg\nc3RhdGljIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5NZXRhRGF0\nYVRhZy4qOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5QZXJzaXN0ZW5jZVN0cmF0ZWd5Lio7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9ydCBvcmcu\neG1sLnNheC5BdHRyaWJ1dGVzOwppbXBvcnQgb3JnLnhtbC5zYXguTG9jYXRv\ncjsKaW1wb3J0IG9yZy54bWwuc2F4LlNBWEV4Y2VwdGlvbjsKCgovKioKICog\nQ3VzdG9tIFNBWCBwYXJzZXIgdXNlZCBieSB0aGUgc3lzdGVtIHRvIHF1aWNr\nbHkgcGFyc2UgcGVyc2lzdGVuY2UKICogbWV0YWRhdGEgZmlsZXMuIFRoaXMg\ncGFyc2VyIG1heSBpbnZva2UKICoge0BsaW5rcGxhaW4gQW5ub3RhdGlvblBl\ncnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgYW5vdGhlciBwYXJzZXJ9IHRvIHNj\nYW4KICogc291cmNlIGNvZGUgYW5ub3RhdGlvbi4KICoKICogQGF1dGhvciBT\ndGV2ZSBLaW0KICogQGF1dGhvciBQaW5ha2kgUG9kZGFyCiAqIEBub2phdmFk\nb2MKICovCnB1YmxpYyBjbGFzcyBYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFy\nc2VyCiAgICBleHRlbmRzIENGTWV0YURhdGFQYXJzZXIKICAgIGltcGxlbWVu\ndHMgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkuUGFyc2VyIHsKCiAgICAv\nLyBwYXJzZSBjb25zdGFudHMKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fUEtHID0gInBhY2thZ2UiOwogICAgcHJvdGVjdGVkIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9BQ0NFU1MgPSAiYWNjZXNzIjsKICAg\nIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQVRUUlMgPSAi\nYXR0cmlidXRlcyI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmlu\nZyBFTEVNX0xJU1RFTkVSID0gImVudGl0eS1saXN0ZW5lciI7CiAgICBwcm90\nZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0NBU0NBREUgPSAiY2Fz\nY2FkZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVN\nX0NBU0NBREVfQUxMID0gImNhc2NhZGUtYWxsIjsKICAgIHByb3RlY3RlZCBz\ndGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9QRVIgPSAiY2FzY2Fk\nZS1wZXJzaXN0IjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5n\nIEVMRU1fQ0FTQ0FERV9NRVIgPSAiY2FzY2FkZS1tZXJnZSI7CiAgICBwcm90\nZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0NBU0NBREVfUkVNID0g\nImNhc2NhZGUtcmVtb3ZlIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fQ0FTQ0FERV9SRUYgPSAiY2FzY2FkZS1yZWZyZXNoIjsK\nICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FE\nRV9ERVQgPSAiY2FzY2FkZS1kZXRhY2giOwogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgRUxFTV9QVV9NRVRBID0gInBlcnNpc3RlbmNlLXVu\naXQtbWV0YWRhdGEiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgRUxFTV9QVV9ERUYgPSAicGVyc2lzdGVuY2UtdW5pdC1kZWZhdWx0cyI7\nCiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX1hNTF9N\nQVBfTUVUQV9DT01QTEVURSA9ICJ4bWwtbWFwcGluZy1tZXRhZGF0YS1jb21w\nbGV0ZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVN\nX0RFTElNX0lEUyA9ICJkZWxpbWl0ZWQtaWRlbnRpZmllcnMiOwogICAgCiAg\nICAvLyBUaGUgZm9sbG93aW5nIGlzIG5lZWRlZCBmb3IgaW5wdXQgaW50byB0\naGUgZGVsaW1pdFN0cmluZygpIG1ldGhvZAogICAgcHJvdGVjdGVkIHN0YXRp\nYyBlbnVtIGxvY2FsREJJZGVudGlmaWVycyB7CiAgICAgICAgU0VRVUVOQ0Vf\nR0VOX1NFUV9OQU1FLAogICAgICAgIFNFUVVFTkNFX0dFTl9TQ0hFTUEKICAg\nIH0gICAgCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPFN0cmluZywg\nT2JqZWN0PiBfZWxlbXMgPQogICAgICAgIG5ldyBIYXNoTWFwPFN0cmluZywg\nT2JqZWN0PigpOwoKICAgIC8vIE1hcCBmb3Igc3RvcmluZyBkZWZlcnJlZCBt\nZXRhZGF0YSB3aGljaCBuZWVkcyB0byBiZSBwb3B1bGF0ZWQKICAgIC8vIGFm\ndGVyIGVtYmVkZGFibGVzIGFyZSBsb2FkZWQuCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBNYXA8Q2xhc3M8Pz4sIEFycmF5TGlzdDxNZXRhRGF0YUNvbnRl\neHQ+PgogICAgICAgIF9lbWJlZGRhYmxlcyA9IG5ldyBIYXNoTWFwPENsYXNz\nPD8+LCBBcnJheUxpc3Q8TWV0YURhdGFDb250ZXh0Pj4oKTsKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIE1hcDxDbGFzczw/PiwgSW50ZWdlcj4KICAgICAg\nICBfZW1iZWRkYWJsZUFjY2VzcyA9IG5ldyBIYXNoTWFwPENsYXNzPD8+LCBJ\nbnRlZ2VyPigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgX2VsZW1zLnB1dChF\nTEVNX1BLRywgRUxFTV9QS0cpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9B\nQ0NFU1MsIEVMRU1fQUNDRVNTKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1f\nQVRUUlMsIEVMRU1fQVRUUlMpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9M\nSVNURU5FUiwgRUxFTV9MSVNURU5FUik7CiAgICAgICAgX2VsZW1zLnB1dChF\nTEVNX0NBU0NBREUsIEVMRU1fQ0FTQ0FERSk7CiAgICAgICAgX2VsZW1zLnB1\ndChFTEVNX0NBU0NBREVfQUxMLCBFTEVNX0NBU0NBREVfQUxMKTsKICAgICAg\nICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9QRVIsIEVMRU1fQ0FTQ0FERV9Q\nRVIpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX1JFTSwgRUxF\nTV9DQVNDQURFX1JFTSk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0NBU0NB\nREVfTUVSLCBFTEVNX0NBU0NBREVfTUVSKTsKICAgICAgICBfZWxlbXMucHV0\nKEVMRU1fQ0FTQ0FERV9SRUYsIEVMRU1fQ0FTQ0FERV9SRUYpOwogICAgICAg\nIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX0RFVCwgRUxFTV9DQVNDQURFX0RF\nVCk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX1BVX01FVEEsIEVMRU1fUFVf\nTUVUQSk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX1BVX0RFRiwgRUxFTV9Q\nVV9ERUYpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9YTUxfTUFQX01FVEFf\nQ09NUExFVEUsIEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFKTsKICAgICAg\nICBfZWxlbXMucHV0KEVMRU1fREVMSU1fSURTLCBFTEVNX0RFTElNX0lEUyk7\nCgogICAgICAgIF9lbGVtcy5wdXQoImVudGl0eS1saXN0ZW5lcnMiLCBFTlRJ\nVFlfTElTVEVORVJTKTsKICAgICAgICBfZWxlbXMucHV0KCJwcmUtcGVyc2lz\ndCIsIFBSRV9QRVJTSVNUKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXBl\ncnNpc3QiLCBQT1NUX1BFUlNJU1QpOwogICAgICAgIF9lbGVtcy5wdXQoInBy\nZS1yZW1vdmUiLCBQUkVfUkVNT1ZFKTsKICAgICAgICBfZWxlbXMucHV0KCJw\nb3N0LXJlbW92ZSIsIFBPU1RfUkVNT1ZFKTsKICAgICAgICBfZWxlbXMucHV0\nKCJwcmUtdXBkYXRlIiwgUFJFX1VQREFURSk7CiAgICAgICAgX2VsZW1zLnB1\ndCgicG9zdC11cGRhdGUiLCBQT1NUX1VQREFURSk7CiAgICAgICAgX2VsZW1z\nLnB1dCgicG9zdC1sb2FkIiwgUE9TVF9MT0FEKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJleGNsdWRlLWRlZmF1bHQtbGlzdGVuZXJzIiwgRVhDTFVERV9ERUZB\nVUxUX0xJU1RFTkVSUyk7CiAgICAgICAgX2VsZW1zLnB1dCgiZXhjbHVkZS1z\ndXBlcmNsYXNzLWxpc3RlbmVycyIsCiAgICAgICAgICAgIEVYQ0xVREVfU1VQ\nRVJDTEFTU19MSVNURU5FUlMpOwoKICAgICAgICBfZWxlbXMucHV0KCJuYW1l\nZC1xdWVyeSIsIFFVRVJZKTsKICAgICAgICBfZWxlbXMucHV0KCJuYW1lZC1u\nYXRpdmUtcXVlcnkiLCBOQVRJVkVfUVVFUlkpOwogICAgICAgIF9lbGVtcy5w\ndXQoInF1ZXJ5LWhpbnQiLCBRVUVSWV9ISU5UKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJxdWVyeSIsIFFVRVJZX1NUUklORyk7CgogICAgICAgIF9lbGVtcy5w\ndXQoImZsdXNoLW1vZGUiLCBGTFVTSF9NT0RFKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJzZXF1ZW5jZS1nZW5lcmF0b3IiLCBTRVFfR0VORVJBVE9SKTsKCiAg\nICAgICAgX2VsZW1zLnB1dCgiaWQiLCBJRCk7CiAgICAgICAgX2VsZW1zLnB1\ndCgiaWQtY2xhc3MiLCBJRF9DTEFTUyk7CiAgICAgICAgX2VsZW1zLnB1dCgi\nZW1iZWRkZWQtaWQiLCBFTUJFRERFRF9JRCk7CiAgICAgICAgX2VsZW1zLnB1\ndCgibWFwcy1pZCIsIE1BUFBFRF9CWV9JRCk7CiAgICAgICAgX2VsZW1zLnB1\ndCgidmVyc2lvbiIsIFZFUlNJT04pOwogICAgICAgIF9lbGVtcy5wdXQoImdl\nbmVyYXRlZC12YWx1ZSIsIEdFTkVSQVRFRF9WQUxVRSk7CiAgICAgICAgX2Vs\nZW1zLnB1dCgibWFwLWtleSIsIE1BUF9LRVkpOwogICAgICAgIF9lbGVtcy5w\ndXQoIm9yZGVyLWJ5IiwgT1JERVJfQlkpOwogICAgICAgIF9lbGVtcy5wdXQo\nIm9yZGVyLWNvbHVtbiIsIE9SREVSX0NPTFVNTik7CiAgICAgICAgX2VsZW1z\nLnB1dCgibG9iIiwgTE9CKTsKCiAgICAgICAgX2VsZW1zLnB1dCgiYmFzaWMi\nLCBCQVNJQyk7CiAgICAgICAgX2VsZW1zLnB1dCgibWFueS10by1vbmUiLCBN\nQU5ZX09ORSk7CiAgICAgICAgX2VsZW1zLnB1dCgib25lLXRvLW9uZSIsIE9O\nRV9PTkUpOwogICAgICAgIF9lbGVtcy5wdXQoImVtYmVkZGVkIiwgRU1CRURE\nRUQpOwogICAgICAgIF9lbGVtcy5wdXQoIm9uZS10by1tYW55IiwgT05FX01B\nTlkpOwogICAgICAgIF9lbGVtcy5wdXQoIm1hbnktdG8tbWFueSIsIE1BTllf\nTUFOWSk7CiAgICAgICAgX2VsZW1zLnB1dCgidHJhbnNpZW50IiwgVFJBTlNJ\nRU5UKTsKICAgICAgICBfZWxlbXMucHV0KCJlbGVtZW50LWNvbGxlY3Rpb24i\nLCBFTEVNX0NPTEwpOwogICAgICAgIF9lbGVtcy5wdXQoIm1hcC1rZXktY2xh\nc3MiLCBNQVBfS0VZX0NMQVNTKTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdl\nCiAgICAgICAgKFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIuY2xhc3Mp\nOwoKICAgIHByaXZhdGUgZmluYWwgT3BlbkpQQUNvbmZpZ3VyYXRpb24gX2Nv\nbmY7CiAgICBwcml2YXRlIE1ldGFEYXRhUmVwb3NpdG9yeSBfcmVwb3MgPSBu\ndWxsOwogICAgcHJpdmF0ZSBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0\nYVBhcnNlciBfcGFyc2VyID0gbnVsbDsKICAgIHByaXZhdGUgQ2xhc3NMb2Fk\nZXIgX2VudkxvYWRlciA9IG51bGw7CiAgICBwcml2YXRlIGludCBfbW9kZSA9\nIE1PREVfTk9ORTsKICAgIHByaXZhdGUgYm9vbGVhbiBfb3ZlcnJpZGUgPSBm\nYWxzZTsKCiAgICBwcml2YXRlIGZpbmFsIFN0YWNrPE9iamVjdD4gX2VsZW1l\nbnRzID0gbmV3IFN0YWNrPE9iamVjdD4oKTsKICAgIHByaXZhdGUgZmluYWwg\nU3RhY2s8T2JqZWN0PiBfcGFyZW50cyA9IG5ldyBTdGFjazxPYmplY3Q+KCk7\nCgogICAgcHJpdmF0ZSBDbGFzczw/PiBfY2xzID0gbnVsbDsKICAgIC8vIExp\nc3Qgb2YgY2xhc3NlcyBjdXJyZW50bHkgYmVpbmcgcGFyc2VkCiAgICBwcml2\nYXRlIEFycmF5TGlzdDxDbGFzczw/Pj4gX3BhcnNlTGlzdCA9IG5ldyBBcnJh\neUxpc3Q8Q2xhc3M8Pz4+KCk7CiAgICBwcml2YXRlIGludCBfZmllbGRQb3Mg\nPSAwOwogICAgcHJpdmF0ZSBpbnQgX2Nsc1BvcyA9IDA7CiAgICBwcml2YXRl\nIGludCBfYWNjZXNzID0gQWNjZXNzQ29kZS5VTktOT1dOOwogICAgcHJpdmF0\nZSBQZXJzaXN0ZW5jZVN0cmF0ZWd5IF9zdHJhdGVneSA9IG51bGw7CiAgICBw\ncml2YXRlIFNldDxDYXNjYWRlVHlwZT4gX2Nhc2NhZGVzID0gbnVsbDsKICAg\nIHByaXZhdGUgU2V0PENhc2NhZGVUeXBlPiBfcGtnQ2FzY2FkZXMgPSBudWxs\nOwoKICAgIHByaXZhdGUgQ2xhc3M8Pz4gX2xpc3RlbmVyID0gbnVsbDsKICAg\nIHByaXZhdGUgQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+W10gX2Nh\nbGxiYWNrcyA9IG51bGw7CiAgICBwcml2YXRlIENvbGxlY3Rpb248Q2xhc3M8\nPz4+IF9saXN0ZW5lcnMgPSBudWxsOwogICAgcHJpdmF0ZSBpbnRbXSBfaGln\naHMgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9pc1hNTE1hcHBpbmdN\nZXRhRGF0YUNvbXBsZXRlID0gZmFsc2U7CgogICAgcHJpdmF0ZSBTdHJpbmcg\nX29ybVZlcnNpb247CiAgICBwcml2YXRlIFN0cmluZyBfc2NoZW1hTG9jYXRp\nb247CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIE9STV9YU0Rf\nMV8wID0gIm9ybV8xXzAueHNkIjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIFN0cmluZyBPUk1fWFNEXzJfMCA9ICJvcm1fMl8wLnhzZCI7CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyBYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2Vy\nKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfY29uZiA9\nIGNvbmY7CiAgICAgICAgc2V0VmFsaWRhdGluZyh0cnVlKTsKICAgICAgICBz\nZXRMb2coY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX01F\nVEFEQVRBKSk7CiAgICAgICAgc2V0UGFyc2VDb21tZW50cyh0cnVlKTsKICAg\nICAgICBzZXRNb2RlKE1PREVfTUVUQSB8IE1PREVfTUFQUElORyB8IE1PREVf\nUVVFUlkpOwogICAgICAgIHNldFBhcnNlVGV4dCh0cnVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENvbmZpZ3VyYXRpb24gc3VwcGxpZWQgb24gY29uc3Ry\ndWN0aW9uLgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2NvbmY7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYW5ub3RhdGlvbiBwYXJzZXIu\nIFdoZW4gY2xhc3MgaXMgZGlzY292ZXJlZCBpbiBhbiBYTUwgZmlsZSwKICAg\nICAqIHdlIGZpcnN0IHBhcnNlIGFueSBhbm5vdGF0aW9ucyBwcmVzZW50LCB0\naGVuIG92ZXJyaWRlIHdpdGggdGhlIFhNTC4KICAgICAqLwogICAgcHVibGlj\nIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIGdldEFubm90\nYXRpb25QYXJzZXIoKSB7CiAgICAgICAgcmV0dXJuIF9wYXJzZXI7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgYW5ub3RhdGlvbiBwYXJzZXIuIFdoZW4g\nY2xhc3MgaXMgZGlzY292ZXJlZCBpbiBhbiBYTUwgZmlsZSwKICAgICAqIHdl\nIGZpcnN0IHBhcnNlIGFueSBhbm5vdGF0aW9ucyBwcmVzZW50LCB0aGVuIG92\nZXJyaWRlIHdpdGggdGhlIFhNTC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0QW5ub3RhdGlvblBhcnNlcihBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlciBwYXJzZXIpewogICAgICAgIF9wYXJzZXIgPSBwYXJzZXI7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSByZXBvc2l0b3J5\nIGZvciB0aGlzIHBhcnNlci4gSWYgbm9uZSBoYXMgYmVlbiBzZXQsIGNyZWF0\nZXMKICAgICAqIGEgbmV3IHJlcG9zaXRvcnkgYW5kIHNldHMgaXQuCiAgICAg\nKi8KICAgIHB1YmxpYyBNZXRhRGF0YVJlcG9zaXRvcnkgZ2V0UmVwb3NpdG9y\neSgpIHsKICAgICAgICBpZiAoX3JlcG9zID09IG51bGwpIHsKICAgICAgICAg\nICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gX2NvbmYubmV3TWV0YURh\ndGFSZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAgTWV0YURhdGFG\nYWN0b3J5IG1kZiA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAg\nICAgICAgICBpZiAobWRmIGluc3RhbmNlb2YgRGVsZWdhdGluZ01ldGFEYXRh\nRmFjdG9yeSkKICAgICAgICAgICAgICAgIG1kZiA9ICgoRGVsZWdhdGluZ01l\ndGFEYXRhRmFjdG9yeSkgbWRmKS5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpOwog\nICAgICAgICAgICBpZiAobWRmIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VNZXRh\nRGF0YUZhY3RvcnkpCiAgICAgICAgICAgICAgICAoKFBlcnNpc3RlbmNlTWV0\nYURhdGFGYWN0b3J5KSBtZGYpLnNldFhNTFBhcnNlcih0aGlzKTsKICAgICAg\nICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBfcmVwb3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG1ldGFk\nYXRhIHJlcG9zaXRvcnkgZm9yIHRoaXMgcGFyc2VyLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRSZXBvc2l0b3J5KE1ldGFEYXRhUmVwb3NpdG9yeSBy\nZXBvcykgewogICAgICAgIF9yZXBvcyA9IHJlcG9zOwogICAgICAgIGlmIChy\nZXBvcyAhPSBudWxsCiAgICAgICAgICAgICYmIChyZXBvcy5nZXRWYWxpZGF0\nZSgpICYgTWV0YURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX1JVTlRJTUUpICE9\nIDApCiAgICAgICAgICAgIHNldFBhcnNlQ29tbWVudHMoZmFsc2UpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBlbnZpcm9ubWVudGFsIGNs\nYXNzIGxvYWRlciB0byBwYXNzIG9uIHRvIHBhcnNlZAogICAgICogbWV0YWRh\ndGEgaW5zdGFuY2VzLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NMb2FkZXIg\nZ2V0RW52Q2xhc3NMb2FkZXIoKSB7CiAgICAgICAgcmV0dXJuIF9lbnZMb2Fk\nZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGVudmlyb25tZW50\nYWwgY2xhc3MgbG9hZGVyIHRvIHBhc3Mgb24gdG8gcGFyc2VkCiAgICAgKiBt\nZXRhZGF0YSBpbnN0YW5jZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndEVudkNsYXNzTG9hZGVyKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAg\nIF9lbnZMb2FkZXIgPSBsb2FkZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBX\naGV0aGVyIHRvIGFsbG93IGxhdGVyIHBhcnNlcyBvZiBtYXBwaW5nIGluZm9y\nbWF0aW9uIHRvIG92ZXJyaWRlCiAgICAgKiBlYXJsaWVyIGluZm9ybWF0aW9u\nIGZvciB0aGUgc2FtZSBjbGFzcy4gRGVmYXVsdHMgdG8gZmFsc2UuIFVzZWZ1\nbAogICAgICogd2hlbiBhIHRvb2wgaXMgbWFwcGluZyBhIGNsYXNzLCBzbyB0\naGF0IC5qZG8gZmlsZSBwYXJ0aWFsIG1hcHBpbmcKICAgICAqIGluZm9ybWF0\naW9uIGNhbiBiZSB1c2VkIGV2ZW4gd2hlbiBtYXBwaW5ncyBhcmUgc3RvcmVk\nIGluIC5vcm0gZmlsZXMKICAgICAqIG9yIG90aGVyIGxvY2F0aW9ucy4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0TWFwcGluZ092ZXJyaWRlKCkg\newogICAgICAgIHJldHVybiBfb3ZlcnJpZGU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRvIGFsbG93IGxhdGVyIHBhcnNlcyBvZiBtYXBwaW5n\nIGluZm9ybWF0aW9uIHRvIG92ZXJyaWRlCiAgICAgKiBlYXJsaWVyIGluZm9y\nbWF0aW9uIGZvciB0aGUgc2FtZSBjbGFzcy4gRGVmYXVsdHMgdG8gZmFsc2Uu\nIFVzZWZ1bAogICAgICogd2hlbiBhIHRvb2wgaXMgbWFwcGluZyBhIGNsYXNz\nLCBzbyB0aGF0IC5qZG8gZmlsZSBwYXJ0aWFsIG1hcHBpbmcKICAgICAqIGlu\nZm9ybWF0aW9uIGNhbiBiZSB1c2VkIGV2ZW4gd2hlbiBtYXBwaW5ncyBhcmUg\nc3RvcmVkIGluIC5vcm0gZmlsZXMKICAgICAqIG9yIG90aGVyIGxvY2F0aW9u\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWFwcGluZ092ZXJyaWRl\nKGJvb2xlYW4gb3ZlcnJpZGUpIHsKICAgICAgICBfb3ZlcnJpZGUgPSBvdmVy\ncmlkZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBwYXJzZSBtb2RlIGFj\nY29yZGluZyB0byB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4gVGhlCiAg\nICAgKiBtb2RlIGNvbnN0YW50cyBhY3QgYXMgYml0IGZsYWdzLCBhbmQgdGhl\ncmVmb3JlIGNhbiBiZSBjb21iaW5lZC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRNb2RlKCkgewogICAgICAgIHJldHVybiBfbW9kZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBwYXJzZSBtb2RlIGFjY29yZGluZyB0byB0aGUg\nZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0TW9kZShpbnQgbW9kZSwgYm9vbGVhbiBvbikgewogICAgICAgIGlm\nIChtb2RlID09IE1PREVfTk9ORSkKICAgICAgICAgICAgc2V0TW9kZShNT0RF\nX05PTkUpOwogICAgICAgIGVsc2UgaWYgKG9uKQogICAgICAgICAgICBzZXRN\nb2RlKF9tb2RlIHwgbW9kZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBz\nZXRNb2RlKF9tb2RlICYgfm1vZGUpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIHBhcnNlIG1vZGUgYWNjb3JkaW5nIHRvIHRoZSBleHBlY3RlZCBkb2N1\nbWVudCB0eXBlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNb2RlKGlu\ndCBtb2RlKSB7CiAgICAgICAgX21vZGUgPSBtb2RlOwogICAgICAgIGlmIChf\ncGFyc2VyICE9IG51bGwpCiAgICAgICAgICAgIF9wYXJzZXIuc2V0TW9kZSht\nb2RlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwYXJzZShVUkwgdXJsKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIC8vIHBlZWsgYXQgdGhlIGRv\nYyB0byBkZXRlcm1pbmUgdGhlIHZlcnNpb24KICAgICAgICBYTUxWZXJzaW9u\nUGFyc2VyIHZwID0gbmV3IFhNTFZlcnNpb25QYXJzZXIoImVudGl0eS1tYXBw\naW5ncyIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHZwLnBhcnNlKHVy\nbCk7CiAgICAgICAgICAgIF9vcm1WZXJzaW9uID0gdnAuZ2V0VmVyc2lvbigp\nOwogICAgICAgICAgICBfc2NoZW1hTG9jYXRpb24gPSB2cC5nZXRTY2hlbWFM\nb2NhdGlvbigpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAg\nICAgICAgICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgICAg\nICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgICAg\nICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInZlcnNpb24tY2hlY2stZXJyb3Ii\nLAogICAgICAgICAgICAgICAgICAgICAgICB1cmwudG9TdHJpbmcoKSkpOwog\nICAgICAgIH0KICAgICAgICBzdXBlci5wYXJzZSh1cmwpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHBhcnNlKEZpbGUgZmlsZSkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICAvLyBwZWVrIGF0IHRoZSBkb2MgdG8gZGV0ZXJtaW5l\nIHRoZSB2ZXJzaW9uCiAgICAgICAgWE1MVmVyc2lvblBhcnNlciB2cCA9IG5l\ndyBYTUxWZXJzaW9uUGFyc2VyKCJlbnRpdHktbWFwcGluZ3MiKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB2cC5wYXJzZShmaWxlKTsKICAgICAgICAg\nICAgX29ybVZlcnNpb24gPSB2cC5nZXRWZXJzaW9uKCk7CiAgICAgICAgICAg\nIF9zY2hlbWFMb2NhdGlvbiA9IHZwLmdldFNjaGVtYUxvY2F0aW9uKCk7CiAg\nICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAg\nIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICAgICAgICAgIGlmIChsb2cu\naXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShfbG9jLmdldCgidmVyc2lvbi1jaGVjay1lcnJvciIsCiAgICAgICAgICAg\nICAgICAgICAgICAgIGZpbGUudG9TdHJpbmcoKSkpOwogICAgICAgIH0KICAg\nICAgICBzdXBlci5wYXJzZShmaWxlKTsKICAgIH0KICAgIC8qKgogICAgICog\nQ29udmVuaWVuY2UgbWV0aG9kIGZvciBpbnRlcnByZXRpbmcge0BsaW5rICNn\nZXRNb2RlfS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNNZXRh\nRGF0YU1vZGUoKSB7CiAgICAgICAgcmV0dXJuIChfbW9kZSAmIE1PREVfTUVU\nQSkgIT0gMDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1l\ndGhvZCBmb3IgaW50ZXJwcmV0aW5nIHtAbGluayAjZ2V0TW9kZX0uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzUXVlcnlNb2RlKCkgewogICAg\nICAgIHJldHVybiAoX21vZGUgJiBNT0RFX1FVRVJZKSAhPSAwOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIGZvciBpbnRlcnBy\nZXRpbmcge0BsaW5rICNnZXRNb2RlfS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gaXNNYXBwaW5nTW9kZSgpIHsKICAgICAgICByZXR1cm4gKF9t\nb2RlICYgTU9ERV9NQVBQSU5HKSAhPSAwOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyB0cnVlIGlmIHdlJ3JlIGluIG1hcHBpbmcgbW9kZSBvciBp\nbiBtZXRhZGF0YSBtb2RlIHdpdGgKICAgICAqIG1hcHBpbmcgb3ZlcnJpZGUg\nZW5hYmxlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNNYXBw\naW5nT3ZlcnJpZGVNb2RlKCkgewogICAgICAgIHJldHVybiBpc01hcHBpbmdN\nb2RlKCkgfHwgKF9vdmVycmlkZSAmJiBpc01ldGFEYXRhTW9kZSgpKTsKICAg\nIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8KICAgIC8vIFhNTCBwYXJzaW5nCiAg\nICAvLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFB1c2ggYSBwYXJz\nZSBlbGVtZW50IG9udG8gdGhlIHN0YWNrLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBwdXNoRWxlbWVudChPYmplY3QgZWxlbSkgewogICAgICAgIF9l\nbGVtZW50cy5wdXNoKGVsZW0pOwogICAgfQoKICAgIC8qKgogICAgICogUG9w\nIGEgcGFyc2UgZWxlbWVudCBmcm9tIHRoZSBzdGFjay4KICAgICAqLwogICAg\ncHJvdGVjdGVkIE9iamVjdCBwb3BFbGVtZW50KCkgewogICAgICAgIHJldHVy\nbiBfZWxlbWVudHMucG9wKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQZWVr\nIGEgcGFyc2UgZWxlbWVudCBmcm9tIHRoZSBzdGFjay4KICAgICAqLwogICAg\ncHJvdGVjdGVkIE9iamVjdCBwZWVrRWxlbWVudCgpIHsKICAgICAgICByZXR1\ncm4gX2VsZW1lbnRzLnBlZWsoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgY3VycmVudCBlbGVtZW50IGJlaW5nIHBhcnNlZC4gTWF5IGJl\nIGEgY2xhc3MgbWV0YWRhdGEsCiAgICAgKiBmaWVsZCBtZXRhZGF0YSwgcXVl\ncnkgbWV0YWRhdGEsIGV0Yy4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVj\ndCBjdXJyZW50RWxlbWVudCgpIHsKICAgICAgICBpZiAoX2VsZW1lbnRzLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0\ndXJuIF9lbGVtZW50cy5wZWVrKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGN1cnJlbnQge0BsaW5rIFBlcnNpc3RlbmNlU3RyYXRlZ3l9\nIGlmIGFueS4KICAgICAqLwogICAgcHJvdGVjdGVkIFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kgY3VycmVudFN0cmF0ZWd5KCkgewogICAgICAgIHJldHVybiBfc3Ry\nYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHRhZyBv\nZiB0aGUgY3VycmVudCBwYXJlbnQgZWxlbWVudC4KICAgICAqLwogICAgcHJv\ndGVjdGVkIE9iamVjdCBjdXJyZW50UGFyZW50KCkgewogICAgICAgIGlmIChf\ncGFyZW50cy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIHJldHVybiBfcGFyZW50cy5wZWVrKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gd2hldGhlciB3ZSdyZSBydW5uaW5nIHRoZSBwYXJz\nZXIgYXQgcnVudGltZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4g\naXNSdW50aW1lKCkgewogICAgICAgIHJldHVybiAoZ2V0UmVwb3NpdG9yeSgp\nLmdldFZhbGlkYXRlKCkKICAgICAgICAgICAgJiBNZXRhRGF0YVJlcG9zaXRv\ncnkuVkFMSURBVEVfUlVOVElNRSkgIT0gMDsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCBPYmplY3QgZ2V0U2NoZW1hU291cmNlKCkgewog\nICAgICAgIC8vIHVzZSB0aGUgbGF0ZXN0IHNjaGVtYSBieSBkZWZhdWx0LiAg\nJ3Vua25vd24nIGRvY3Mgc2hvdWxkIHBhcnNlCiAgICAgICAgLy8gd2l0aCB0\naGUgbGF0ZXN0IHNjaGVtYS4KICAgICAgICBTdHJpbmcgb3JteHNkID0gIm9y\nbV8yXzAteHNkLnJzcmMiOwogICAgICAgIC8vIGlmIHRoZSB2ZXJzaW9uIGFu\nZC9vciBzY2hlbWEgbG9jYXRpb24gaXMgZm9yIDEuMCwgdXNlIHRoZSAxLjAK\nICAgICAgICAvLyBzY2hlbWEKICAgICAgICBpZiAoX29ybVZlcnNpb24gIT0g\nbnVsbCAmJgogICAgICAgICAgICBfb3JtVmVyc2lvbi5lcXVhbHMoWE1MVmVy\nc2lvblBhcnNlci5WRVJTSU9OXzFfMCkgfHwKICAgICAgICAgICAgKF9zY2hl\nbWFMb2NhdGlvbiAhPSBudWxsICYmCiAgICAgICAgICAgIF9zY2hlbWFMb2Nh\ndGlvbi5pbmRleE9mKE9STV9YU0RfMV8wKSAhPSAtMSkpIHsKICAgICAgICAg\nICAgb3JteHNkID0gIm9ybS14c2QucnNyYyI7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyLmNsYXNzLmdl\ndFJlc291cmNlQXNTdHJlYW0ob3JteHNkKTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0UGFja2FnZUF0dHJpYnV0ZU5h\nbWUoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldENsYXNzQXR0cmlidXRlTmFt\nZSgpIHsKICAgICAgICByZXR1cm4gImNsYXNzIjsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCBpbnQgZ2V0Q2xhc3NFbGVtZW50RGVwdGgo\nKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0NsYXNzRWxlbWVudE5hbWUoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICByZXR1cm4gImVudGl0eSIuZXF1YWxzKG5hbWUp\nCiAgICAgICAgICAgIHx8ICJlbWJlZGRhYmxlIi5lcXVhbHMobmFtZSkKICAg\nICAgICAgICAgfHwgIm1hcHBlZC1zdXBlcmNsYXNzIi5lcXVhbHMobmFtZSk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCByZXNl\ndCgpIHsKICAgIAkvLyBBZGQgYWxsIHJlbWFpbmluZyBkZWZlcnJlZCBlbWJl\nZGRhYmxlIG1ldGFkYXRhCiAgICAgICAgYWRkRGVmZXJyZWRFbWJlZGRhYmxl\nTWV0YURhdGEoKTsKCiAgICAgICAgc3VwZXIucmVzZXQoKTsKICAgICAgICBf\nZWxlbWVudHMuY2xlYXIoKTsKICAgICAgICBfcGFyZW50cy5jbGVhcigpOwog\nICAgICAgIF9jbHMgPSBudWxsOwogICAgICAgIF9wYXJzZUxpc3QuY2xlYXIo\nKTsKICAgICAgICBfZmllbGRQb3MgPSAwOwogICAgICAgIF9jbHNQb3MgPSAw\nOwoKICAgICAgICBfYWNjZXNzID0gQWNjZXNzQ29kZS5VTktOT1dOOwogICAg\nICAgIF9zdHJhdGVneSA9IG51bGw7CiAgICAgICAgX2xpc3RlbmVyID0gbnVs\nbDsKICAgICAgICBfY2FsbGJhY2tzID0gbnVsbDsKICAgICAgICBfaGlnaHMg\nPSBudWxsOwogICAgICAgIF9jYXNjYWRlcyA9IG51bGw7CiAgICAgICAgX3Br\nZ0Nhc2NhZGVzID0gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCBib29sZWFuIHN0YXJ0U3lzdGVtRWxlbWVudChTdHJpbmcgbmFt\nZSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBPYmplY3QgdGFnID0gKE9iamVjdCkgX2VsZW1zLmdl\ndChuYW1lKTsKICAgICAgICBib29sZWFuIHJldCA9IGZhbHNlOwogICAgICAg\nIGlmICh0YWcgPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoaXNNYXBwaW5n\nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgICAgICB0YWcgPSBzdGFydFN5\nc3RlbU1hcHBpbmdFbGVtZW50KG5hbWUsIGF0dHJzKTsKICAgICAgICAgICAg\ncmV0ID0gdGFnICE9IG51bGw7CiAgICAgICAgfSBlbHNlIGlmICh0YWcgaW5z\ndGFuY2VvZiBNZXRhRGF0YVRhZykgewogICAgICAgICAgICBzd2l0Y2ggKChN\nZXRhRGF0YVRhZykgdGFnKSB7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZ\nOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TmFtZWRRdWVyeShh\ndHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIFFVRVJZX0hJTlQ6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRRdWVyeUhpbnQoYXR0cnMpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAg\nICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnROYW1lZE5hdGl2ZVF1ZXJ5\nKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgUVVFUllfU1RSSU5HOgogICAgICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0UXVlcnlTdHJpbmcoYXR0cnMpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBTRVFfR0VORVJB\nVE9SOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0U2VxdWVuY2VH\nZW5lcmF0b3IoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSBGTFVTSF9NT0RFOgogICAgICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0Rmx1c2hNb2RlKGF0dHJzKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRU5USVRZ\nX0xJU1RFTkVSUzoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEVu\ndGl0eUxpc3RlbmVycyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIFBSRV9QRVJTSVNUOgogICAgICAg\nICAgICAgICAgY2FzZSBQT1NUX1BFUlNJU1Q6CiAgICAgICAgICAgICAgICBj\nYXNlIFBSRV9SRU1PVkU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfUkVN\nT1ZFOgogICAgICAgICAgICAgICAgY2FzZSBQUkVfVVBEQVRFOgogICAgICAg\nICAgICAgICAgY2FzZSBQT1NUX1VQREFURToKICAgICAgICAgICAgICAgIGNh\nc2UgUE9TVF9MT0FEOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nQ2FsbGJhY2soKE1ldGFEYXRhVGFnKSB0YWcsIGF0dHJzKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAg\nICAgICAgICAgICAgICAgICAgd2FyblVuc3VwcG9ydGVkVGFnKG5hbWUpOwog\nICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT0gRUxFTV9Q\nVV9NRVRBIHx8IHRhZyA9PSBFTEVNX1BVX0RFRikKICAgICAgICAgICAgcmV0\nID0gaXNNZXRhRGF0YU1vZGUoKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0g\nRUxFTV9YTUxfTUFQX01FVEFfQ09NUExFVEUpIHsKICAgICAgICAgICAgc2V0\nQW5ub3RhdGlvblBhcnNlcihudWxsKTsKICAgICAgICAgICAgX2lzWE1MTWFw\ncGluZ01ldGFEYXRhQ29tcGxldGUgPSB0cnVlOwogICAgICAgIH0KICAgICAg\nICBlbHNlIGlmICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAgICAgICAgIHJl\ndCA9IF9tb2RlICE9IE1PREVfUVVFUlk7CiAgICAgICAgZWxzZSBpZiAodGFn\nID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0RW50\naXR5TGlzdGVuZXIoYXR0cnMpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0RFTElNX0lEUykKICAgICAgICAgICAgcmV0ID0gc3RhcnREZWxpbWl0\nZWRJZGVudGlmaWVycygpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVN\nX0NBU0NBREUpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURhdGFNb2RlKCk7\nCiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FERV9BTEwgfHwg\ndGFnID09IEVMRU1fQ0FTQ0FERV9QRVIKICAgICAgICAgICAgfHwgdGFnID09\nIEVMRU1fQ0FTQ0FERV9NRVIgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9SRU0K\nICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9SRUYgfHwgdGFn\nID09IEVMRU1fQ0FTQ0FERV9ERVQpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0\nQ2FzY2FkZSh0YWcsIGF0dHJzKTsKCiAgICAgICAgaWYgKHJldCkKICAgICAg\nICAgICAgX3BhcmVudHMucHVzaCh0YWcpOwogICAgICAgIHJldHVybiByZXQ7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRT\neXN0ZW1FbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIE9iamVjdCB0YWcgPSBfZWxlbXMuZ2V0KG5h\nbWUpOwogICAgICAgIGlmICh0YWcgPT0gbnVsbCAmJiBpc01hcHBpbmdPdmVy\ncmlkZU1vZGUoKSkKICAgICAgICAgICAgZW5kU3lzdGVtTWFwcGluZ0VsZW1l\nbnQobmFtZSk7CiAgICAgICAgZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0\nYURhdGFUYWcpIHsKICAgICAgICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcp\nIHRhZykgewogICAgICAgICAgICAgICAgY2FzZSBRVUVSWToKICAgICAgICAg\nICAgICAgICAgICBlbmROYW1lZFF1ZXJ5KCk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX0hJTlQ6CiAg\nICAgICAgICAgICAgICAgICAgZW5kUXVlcnlIaW50KCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE5BVElWRV9R\nVUVSWToKICAgICAgICAgICAgICAgICAgICBlbmROYW1lZE5hdGl2ZVF1ZXJ5\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIFFVRVJZX1NUUklORzoKICAgICAgICAgICAgICAgICAgICBlbmRR\ndWVyeVN0cmluZygpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBTRVFfR0VORVJBVE9SOgogICAgICAgICAgICAg\nICAgICAgIGVuZFNlcXVlbmNlR2VuZXJhdG9yKCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYg\nKHRhZyA9PSBFTEVNX0FDQ0VTUykKICAgICAgICAgICAgZW5kQWNjZXNzKCk7\nCiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fTElTVEVORVIpCiAgICAg\nICAgICAgIGVuZEVudGl0eUxpc3RlbmVyKCk7CgogICAgICAgIF9wYXJlbnRz\nLnBvcCgpOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBh\ncnNlIGEgbWFwcGluZyBlbGVtZW50IG91dHNpZGUgb2YgYW55IGNsYXNzLgog\nICAgICoKICAgICAqIEByZXR1cm4gdGhlIHRhZyBmb3IgdGhlIGdpdmVuIGVs\nZW1lbnQsIG9yIG51bGwgdG8gc2tpcCB0aGUgZWxlbWVudAogICAgICovCiAg\nICBwcm90ZWN0ZWQgT2JqZWN0IHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQo\nU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5nIGVs\nZW1lbnQgb3V0c2lkZSBvZiBhbnkgY2xhc3MuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGVuZFN5c3RlbU1hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1l\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRDbGFzc0VsZW1l\nbnQoU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IHRhZyA9IChPYmpl\nY3QpIF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgYm9vbGVhbiByZXQgPSBm\nYWxzZTsKICAgICAgICBpZiAodGFnID09IG51bGwpIHsKICAgICAgICAgICAg\naWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICAgICAg\ndGFnID0gc3RhcnRDbGFzc01hcHBpbmdFbGVtZW50KG5hbWUsIGF0dHJzKTsK\nICAgICAgICAgICAgcmV0ID0gdGFnICE9IG51bGw7CiAgICAgICAgfSBlbHNl\nIGlmICh0YWcgaW5zdGFuY2VvZiBNZXRhRGF0YVRhZykgewogICAgICAgICAg\nICBzd2l0Y2ggKChNZXRhRGF0YVRhZykgdGFnKSB7CiAgICAgICAgICAgICAg\nICBjYXNlIEdFTkVSQVRFRF9WQUxVRToKICAgICAgICAgICAgICAgICAgICBy\nZXQgPSBzdGFydEdlbmVyYXRlZFZhbHVlKGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSUQ6CiAgICAg\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRJZChhdHRycyk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEVNQkVE\nREVEX0lEOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0RW1iZWRk\nZWRJZChhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIElEX0NMQVNTOgogICAgICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0SWRDbGFzcyhhdHRycyk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIExPQjoKICAgICAgICAg\nICAgICAgICAgICByZXQgPSBzdGFydExvYihhdHRycyk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZOgog\nICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TmFtZWRRdWVyeShhdHRy\ncyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIFFVRVJZX0hJTlQ6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0g\nc3RhcnRRdWVyeUhpbnQoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAgICAg\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnROYW1lZE5hdGl2ZVF1ZXJ5KGF0\ndHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgUVVFUllfU1RSSU5HOgogICAgICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0UXVlcnlTdHJpbmcoYXR0cnMpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBTRVFfR0VORVJBVE9S\nOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0U2VxdWVuY2VHZW5l\ncmF0b3IoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBWRVJTSU9OOgogICAgICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0VmVyc2lvbihhdHRycyk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE1BUF9LRVk6CiAgICAg\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRNYXBLZXkoYXR0cnMpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBN\nQVBfS0VZX0NMQVNTOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nTWFwS2V5Q2xhc3MoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBGTFVTSF9NT0RFOgogICAgICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0Rmx1c2hNb2RlKGF0dHJzKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgT1JE\nRVJfQ09MVU1OOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0T3Jk\nZXJDb2x1bW4oYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9CWToKICAgICAgICAgICAgICAg\nIGNhc2UgRU5USVRZX0xJU1RFTkVSUzoKICAgICAgICAgICAgICAgICAgICBy\nZXQgPSBpc01ldGFEYXRhTW9kZSgpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFWENMVURFX0RFRkFVTFRfTElT\nVEVORVJTOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0RXhjbHVk\nZURlZmF1bHRMaXN0ZW5lcnMoYXR0cnMpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFWENMVURFX1NVUEVSQ0xB\nU1NfTElTVEVORVJTOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nRXhjbHVkZVN1cGVyY2xhc3NMaXN0ZW5lcnMoYXR0cnMpOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBQUkVfUEVS\nU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9QRVJTSVNUOgogICAg\nICAgICAgICAgICAgY2FzZSBQUkVfUkVNT1ZFOgogICAgICAgICAgICAgICAg\nY2FzZSBQT1NUX1JFTU9WRToKICAgICAgICAgICAgICAgIGNhc2UgUFJFX1VQ\nREFURToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9VUERBVEU6CiAgICAg\nICAgICAgICAgICBjYXNlIFBPU1RfTE9BRDoKICAgICAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydENhbGxiYWNrKChNZXRhRGF0YVRhZykgdGFnLCBhdHRy\ncyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHdhcm5VbnN1cHBvcnRl\nZFRhZyhuYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAo\ndGFnIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VTdHJhdGVneSkgewogICAgICAg\nICAgICBQZXJzaXN0ZW5jZVN0cmF0ZWd5IHBzID0gKFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kpIHRhZzsKICAgICAgICAgICAgcmV0ID0gc3RhcnRTdHJhdGVneShw\ncywgYXR0cnMpOwogICAgICAgICAgICBpZiAocmV0KQogICAgICAgICAgICAg\nICAgX3N0cmF0ZWd5ID0gcHM7CiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT0g\nRUxFTV9MSVNURU5FUikKICAgICAgICAgICAgcmV0ID0gc3RhcnRFbnRpdHlM\naXN0ZW5lcihhdHRycyk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1f\nQVRUUlMpCiAgICAgICAgICAgIHJldCA9IF9tb2RlICE9IE1PREVfUVVFUlk7\nCiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FERSkKICAgICAg\nICAgICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUoKTsKICAgICAgICBlbHNlIGlm\nICh0YWcgPT0gRUxFTV9DQVNDQURFX0FMTCB8fCB0YWcgPT0gRUxFTV9DQVND\nQURFX1BFUgogICAgICAgICAgICB8fCB0YWcgPT0gRUxFTV9DQVNDQURFX01F\nUiB8fCB0YWcgPT0gRUxFTV9DQVNDQURFX1JFTQogICAgICAgICAgICB8fCB0\nYWcgPT0gRUxFTV9DQVNDQURFX1JFRiB8fCB0YWcgPT0gRUxFTV9DQVNDQURF\nX0RFVCkKICAgICAgICAgICAgcmV0ID0gc3RhcnRDYXNjYWRlKHRhZywgYXR0\ncnMpOwoKICAgICAgICBpZiAocmV0KQogICAgICAgICAgICBfcGFyZW50cy5w\ndXNoKHRhZyk7CiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzRWxlbWVudChTdHJp\nbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBPYmplY3QgdGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBpZiAo\ndGFnID09IG51bGwgJiYgaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAg\nICAgICAgIGVuZENsYXNzTWFwcGluZ0VsZW1lbnQobmFtZSk7CiAgICAgICAg\nZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAg\nICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAg\nICAgICAgY2FzZSBHRU5FUkFURURfVkFMVUU6CiAgICAgICAgICAgICAgICAg\nICAgZW5kR2VuZXJhdGVkVmFsdWUoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSUQ6CiAgICAgICAgICAgICAg\nICAgICAgZW5kSWQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgRU1CRURERURfSUQ6CiAgICAgICAgICAgICAg\nICAgICAgZW5kRW1iZWRkZWRJZCgpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBJRF9DTEFTUzoKICAgICAgICAg\nICAgICAgICAgICBlbmRJZENsYXNzKCk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIExPQjoKICAgICAgICAgICAg\nICAgICAgICBlbmRMb2IoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAg\nICAgZW5kTmFtZWRRdWVyeSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAgICAg\nICAgICAgICAgIGVuZFF1ZXJ5SGludCgpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAg\nICAgICAgICAgICAgICAgICAgZW5kTmFtZWROYXRpdmVRdWVyeSgpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBR\nVUVSWV9TVFJJTkc6CiAgICAgICAgICAgICAgICAgICAgZW5kUXVlcnlTdHJp\nbmcoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAgICAgICAgICAgICAgICBl\nbmRTZXF1ZW5jZUdlbmVyYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBWRVJTSU9OOgogICAgICAgICAg\nICAgICAgICAgIGVuZFZlcnNpb24oKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgT1JERVJfQlk6CiAgICAgICAg\nICAgICAgICAgICAgZW5kT3JkZXJCeSgpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0YWcg\naW5zdGFuY2VvZiBQZXJzaXN0ZW5jZVN0cmF0ZWd5KQogICAgICAgICAgICBl\nbmRTdHJhdGVneSgoUGVyc2lzdGVuY2VTdHJhdGVneSkgdGFnKTsKICAgICAg\nICBlbHNlIGlmICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAgICAgICAgIGVu\nZEFjY2VzcygpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RF\nTkVSKQogICAgICAgICAgICBlbmRFbnRpdHlMaXN0ZW5lcigpOwoKICAgICAg\nICBfcGFyZW50cy5wb3AoKTsKICAgIH0KCiAgICAvKioKICAgICAqIExvZyB3\nYXJuaW5nIGFib3V0IGFuIHVuc3VwcG9ydGVkIHRhZy4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHdhcm5VbnN1cHBvcnRlZFRhZyhTdHJpbmcgbmFtZSkg\newogICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9n\nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2Mu\nZ2V0KCJ1bnN1cHBvcnRlZC10YWciLCBuYW1lKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBJbXBsZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5nIGVsZW1lbnQg\nd2l0aGluIGEgY2xhc3MuCiAgICAgKgogICAgICogQHJldHVybiB0aGUgdGFn\nIGZvciB0aGUgZ2l2ZW4gZWxlbWVudCwgb3IgbnVsbCB0byBza2lwIGVsZW1l\nbnQKICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBzdGFydENsYXNzTWFw\ncGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gcGFyc2Ug\nYSBtYXBwaW5nIGVsZW1lbnQgd2l0aGluIGEgY2xhc3MuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzTWFwcGluZ0VsZW1lbnQoU3RyaW5n\nIG5hbWUpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9Cgog\nICAgYm9vbGVhbiBpc01ldGFEYXRhQ29tcGxldGUoQXR0cmlidXRlcyBhdHRy\ncykgewogICAgCXJldHVybiBhdHRycyAhPSBudWxsCiAgICAJICAgICYmICJ0\ncnVlIi5lcXVhbHMoYXR0cnMuZ2V0VmFsdWUoIm1ldGFkYXRhLWNvbXBsZXRl\nIikpOwogICAgfQoKICAgIHZvaWQgcmVzZXRBbm5vdGF0aW9uUGFyc2VyKCkg\newogICAgCXNldEFubm90YXRpb25QYXJzZXIoKChQZXJzaXN0ZW5jZU1ldGFE\nYXRhRmFjdG9yeSlnZXRSZXBvc2l0b3J5KCkKICAgIAkJCS5nZXRNZXRhRGF0\nYUZhY3RvcnkoKSkuZ2V0QW5ub3RhdGlvblBhcnNlcigpKTsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0Q2xhc3Mo\nU3RyaW5nIGVsZW0sIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYm9vbGVhbiBtZXRhRGF0YUNvbXBs\nZXRlID0gZmFsc2U7CiAgICAgICAgc3VwZXIuc3RhcnRDbGFzcyhlbGVtLCBh\ndHRycyk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFDb21wbGV0ZShhdHRycykp\nIHsKICAgICAgICAgICAgbWV0YURhdGFDb21wbGV0ZSA9IHRydWU7CiAgICAg\nICAgCXNldEFubm90YXRpb25QYXJzZXIobnVsbCk7CiAgICAgICAgfSBlbHNl\nIGlmICghX2lzWE1MTWFwcGluZ01ldGFEYXRhQ29tcGxldGUpewogICAgICAg\nIAlyZXNldEFubm90YXRpb25QYXJzZXIoKTsKICAgICAgICB9CgogICAgICAg\nIC8vIHF1ZXJ5IG1vZGUgb25seT8KICAgICAgICBfY2xzID0gY2xhc3NGb3JO\nYW1lKGN1cnJlbnRDbGFzc05hbWUoKSk7CgogICAgICAgIC8vIFByZXZlbnQg\nYSByZWVudHJhbnQgcGFyc2UgZm9yIHRoZSBzYW1lIGNsYXNzCiAgICAgICAg\naWYgKHBhcnNlTGlzdENvbnRhaW5zKF9jbHMpKSB7CiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmIChfbW9kZSA9PSBN\nT0RFX1FVRVJZKSB7CiAgICAgICAgICAgIGlmIChfcGFyc2VyICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBfcGFyc2VyLnBhcnNlKF9jbHMpOwogICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIExvZyBsb2cg\nPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2UtY2xhc3Mi\nLCBfY2xzLmdldE5hbWUoKSkpOwoKICAgICAgICBNZXRhRGF0YVJlcG9zaXRv\ncnkgcmVwb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgQ2xhc3NNZXRh\nRGF0YSBtZXRhID0gcmVwb3MuZ2V0Q2FjaGVkTWV0YURhdGEoX2Nscyk7CiAg\nICAgICAgaWYgKG1ldGEgIT0gbnVsbAogICAgICAgICAgICAmJiAoKGlzTWV0\nYURhdGFNb2RlKCkgJiYgKG1ldGEuZ2V0U291cmNlTW9kZSgpICYgTU9ERV9N\nRVRBKSAhPSAwKQogICAgICAgICAgICB8fCAoaXNNYXBwaW5nTW9kZSgpICYm\nIChtZXRhLmdldFNvdXJjZU1vZGUoKSAmIE1PREVfTUFQUElORykgIT0gMCkp\nKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiZHVwLW1l\ndGFkYXRhIiwgX2NscywgZ2V0U291cmNlTmFtZSgpKSk7CiAgICAgICAgICAg\nIF9jbHMgPSBudWxsOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQoKICAgICAgICBpbnQgYWNjZXNzID0gQWNjZXNzQ29kZS5VTktOT1dO\nOwogICAgICAgIGlmIChtZXRhID09IG51bGwpIHsKICAgICAgICAgICAgaW50\nIGFjY2Vzc0NvZGUgPSB0b0FjY2Vzc1R5cGUoYXR0cnMuZ2V0VmFsdWUoImFj\nY2VzcyIpKTsKICAgICAgICAgICAgLy8gaWYgYWNjZXNzIG5vdCBzcGVjaWZp\nZWQgYW5kIGFjY2VzcyB3YXMgc3BlY2lmaWVkIGF0CiAgICAgICAgICAgIC8v\nIHRoZSBzeXN0ZW0gbGV2ZWwsIHVzZSB0aGUgc3lzdGVtIGRlZmF1bHQgKHdo\naWNoIG1heQogICAgICAgICAgICAvLyBiZSBVTktOT1dOKQogICAgICAgICAg\nICBpZiAoYWNjZXNzQ29kZSA9PSBBY2Nlc3NDb2RlLlVOS05PV04pCiAgICAg\nICAgICAgICAgICBhY2Nlc3NDb2RlID0gX2FjY2VzczsKICAgICAgICAgICAg\nbWV0YSA9IHJlcG9zLmFkZE1ldGFEYXRhKF9jbHMsIGFjY2Vzc0NvZGUsIG1l\ndGFEYXRhQ29tcGxldGUpOwogICAgICAgICAgICBGaWVsZE1ldGFEYXRhW10g\nZm1kcyA9IG1ldGEuZ2V0RmllbGRzKCk7CiAgICAgICAgICAgIGlmIChtZXRh\nRGF0YUNvbXBsZXRlKSB7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZtZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAg\nICBmbWRzW2ldLnNldEV4cGxpY2l0KHRydWUpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgICAgIG1ldGEuc2V0RW52Q2xhc3NM\nb2FkZXIoX2VudkxvYWRlcik7CiAgICAgICAgICAgIG1ldGEuc2V0U291cmNl\nTW9kZShNT0RFX05PTkUpOwoKICAgICAgICAgICAgLy8gcGFyc2UgYW5ub3Rh\ndGlvbnMgZmlyc3Qgc28gWE1MIG92ZXJyaWRlcyB0aGVtCiAgICAgICAgICAg\nIGlmIChfcGFyc2VyICE9IG51bGwpCiAgICAgICAgICAgICAgICBfcGFyc2Vy\nLnBhcnNlKF9jbHMpOwogICAgICAgIH0KICAgICAgICBhY2Nlc3MgPSBtZXRh\nLmdldEFjY2Vzc1R5cGUoKTsKCiAgICAgICAgYm9vbGVhbiBtYXBwZWRTdXBl\nciA9ICJtYXBwZWQtc3VwZXJjbGFzcyIuZXF1YWxzKGVsZW0pOwogICAgICAg\nIGJvb2xlYW4gZW1iZWRkYWJsZSA9ICJlbWJlZGRhYmxlIi5lcXVhbHMoZWxl\nbSk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2RlKCkpIHsKICAgICAgICAg\nICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBTb3VyY2VUcmFj\na2VyLlNSQ19YTUwpOwogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUo\nTU9ERV9NRVRBLCB0cnVlKTsKICAgICAgICAgICAgTG9jYXRvciBsb2NhdG9y\nID0gZ2V0TG9jYXRpb24oKS5nZXRMb2NhdG9yKCk7CiAgICAgICAgICAgIGlm\nIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIG1ldGEuc2V0\nTGluZU51bWJlcihsb2NhdG9yLmdldExpbmVOdW1iZXIoKSk7CiAgICAgICAg\nICAgICAgICBtZXRhLnNldENvbE51bWJlcihsb2NhdG9yLmdldENvbHVtbk51\nbWJlcigpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZXRhLnNldExp\nc3RpbmdJbmRleChfY2xzUG9zKTsKICAgICAgICAgICAgU3RyaW5nIG5hbWUg\nPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgICAgICBpZiAoIVN0\ncmluZ1V0aWxzLmlzRW1wdHkobmFtZSkpCiAgICAgICAgICAgICAgICBtZXRh\nLnNldFR5cGVBbGlhcyhuYW1lKTsKICAgICAgICAgICAgbWV0YS5zZXRBYnN0\ncmFjdChtYXBwZWRTdXBlcik7CiAgICAgICAgICAgIG1ldGEuc2V0RW1iZWRk\nZWRPbmx5KG1hcHBlZFN1cGVyIHx8IGVtYmVkZGFibGUpOwoKICAgICAgICAg\nICAgaWYgKGVtYmVkZGFibGUpIHsKICAgICAgICAgICAgICAgIG1ldGEuc2V0\nRW1iZWRkYWJsZSgpOwogICAgICAgICAgICAgICAgc2V0RGVmZXJyZWRFbWJl\nZGRhYmxlQWNjZXNzVHlwZShfY2xzLCBhY2Nlc3MpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBpZiAoYXR0cnMuZ2V0VmFsdWUoImNhY2hl\nYWJsZSIpICE9IG51bGwpIHsKICAgICAgICAgICAgbWV0YS5zZXRDYWNoZUVu\nYWJsZWQoQm9vbGVhbi52YWx1ZU9mKGF0dHJzLmdldFZhbHVlKCJjYWNoZWFi\nbGUiKSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzTWFwcGluZ01vZGUo\nKSkKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUFQUElO\nRywgdHJ1ZSk7CiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgp\nKQogICAgICAgICAgICBzdGFydENsYXNzTWFwcGluZyhtZXRhLCBtYXBwZWRT\ndXBlciwgYXR0cnMpOwogICAgICAgIGlmIChpc1F1ZXJ5TW9kZSgpKQogICAg\nICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9RVUVSWSwgdHJ1ZSk7\nCgogICAgICAgIF9jbHNQb3MrKzsKICAgICAgICBfZmllbGRQb3MgPSAwOwog\nICAgICAgIGFkZENvbW1lbnRzKG1ldGEpOwogICAgICAgIHB1c2hFbGVtZW50\nKG1ldGEpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3MoU3RyaW5nIGVsZW0p\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9t\nb2RlICE9IE1PREVfUVVFUlkpIHsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0\nYSBtZXRhID0gKENsYXNzTWV0YURhdGEpIHBvcEVsZW1lbnQoKTsKICAgICAg\nICAgICAgc3RvcmVDYWxsYmFja3MobWV0YSk7CiAgICAgICAgICAgIGlmIChp\nc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAgICAgICAgIGVuZENs\nYXNzTWFwcGluZyhtZXRhKTsKICAgICAgICB9CiAgICAgICAgX2NscyA9IG51\nbGw7CiAgICAgICAgc3VwZXIuZW5kQ2xhc3MoZWxlbSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gYWRkIG1hcHBpbmcgYXR0cmlidXRl\ncyB0byBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRD\nbGFzc01hcHBpbmcoQ2xhc3NNZXRhRGF0YSBtYXBwaW5nLAogICAgICAgIGJv\nb2xlYW4gbWFwcGVkU3VwZXIsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbXBsZW1lbnQgdG8gZmluYWxpemUgY2xhc3MgbWFwcGluZy4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3NNYXBwaW5nKENsYXNzTWV0YURh\ndGEgbWFwcGluZykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nIH0KCiAgICAvKioKICAgICAqIERlZmF1bHQgYWNjZXNzIGVsZW1lbnQuCiAg\nICAgKi8KICAgIHByaXZhdGUgdm9pZCBlbmRBY2Nlc3MoKSB7CiAgICAgICAg\nX2FjY2VzcyA9IHRvQWNjZXNzVHlwZShjdXJyZW50VGV4dCgpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIHRoZSBnaXZlbiBzdHJpbmcgYXMgYW4g\nZW50aXR5IGFjY2VzcyB0eXBlLCBkZWZhdWx0aW5nIHRvIGdpdmVuCiAgICAg\nKiBkZWZhdWx0IGlmIHN0cmluZyBpcyBlbXB0eS4KICAgICAqLwogICAgcHJp\ndmF0ZSBpbnQgdG9BY2Nlc3NUeXBlKFN0cmluZyBzdHIpIHsKICAgICAgICBp\nZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShzdHIpKQogICAgICAgICAgICByZXR1\ncm4gQWNjZXNzQ29kZS5VTktOT1dOOwogICAgICAgIGlmICgiUFJPUEVSVFki\nLmVxdWFscyhzdHIpKQogICAgICAgICAgICByZXR1cm4gQWNjZXNzQ29kZS5F\nWFBMSUNJVCB8IEFjY2Vzc0NvZGUuUFJPUEVSVFk7CiAgICAgICAgcmV0dXJu\nIEFjY2Vzc0NvZGUuRVhQTElDSVQgfCBBY2Nlc3NDb2RlLkZJRUxEOwogICAg\nfQogICAgLyoqCiAgICAgKiBQYXJzZSBmbHVzaC1tb2RlIGVsZW1lbnQuCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEZsdXNoTW9kZShBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlz\nV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQo\nInVuc3VwcG9ydGVkIiwgImZsdXNoLW1vZGUiLCBnZXRTb3VyY2VOYW1lKCkp\nKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSBzZXF1ZW5jZS1nZW5lcmF0b3IuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIHN0YXJ0U2VxdWVuY2VHZW5lcmF0b3IoQXR0cmlidXRl\ncyBhdHRycykgewogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJpZGVNb2Rl\nKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU3RyaW5n\nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIExvZyBs\nb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2Utc2Vx\ndWVuY2UiLCBuYW1lKSk7CgogICAgICAgIFNlcXVlbmNlTWV0YURhdGEgbWV0\nYSA9IGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRTZXF1ZW5jZU1ldGFEYXRh\nKG5hbWUpOwogICAgICAgIGlmIChtZXRhICE9IG51bGwgJiYgbG9nLmlzV2Fy\nbkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoIm92\nZXJyaWRlLXNlcXVlbmNlIiwgbmFtZSkpOwoKICAgICAgICBtZXRhID0gZ2V0\nUmVwb3NpdG9yeSgpLmFkZFNlcXVlbmNlTWV0YURhdGEobmFtZSk7CiAgICAg\nICAgU3RyaW5nIHNlcSA9IGF0dHJzLmdldFZhbHVlKCJzZXF1ZW5jZS1uYW1l\nIik7CiAgICAgICAgLy8gRG8gbm90IG5vcm1hbGl6ZSB0aGUgc2VxdWVuY2Ug\nbmFtZSBpZiBpdCBhcHBlYXJzIHRvIGJlIGEgcGx1Z2luIAogICAgICAgIGlm\nIChzZXEuaW5kZXhPZignKCcpID09IC0xKXsKICAgICAgICAgICAgc2VxID0g\nbm9ybWFsaXplU2VxdWVuY2VOYW1lKHNlcSk7CiAgICAgICAgfQogICAgICAg\nIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiaW5pdGlhbC12YWx1ZSIp\nOwogICAgICAgIGludCBpbml0aWFsID0gdmFsID09IG51bGwgPyAxIDogSW50\nZWdlci5wYXJzZUludCh2YWwpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZh\nbHVlKCJhbGxvY2F0aW9uLXNpemUiKTsKICAgICAgICBpbnQgYWxsb2NhdGUg\nPSB2YWwgPT0gbnVsbCA/IDUwIDogSW50ZWdlci5wYXJzZUludCh2YWwpOwog\nICAgICAgIFN0cmluZyBzY2hlbWEgPSBub3JtYWxpemVTY2hlbWFOYW1lKGF0\ndHJzLmdldFZhbHVlKCJzY2hlbWEiKSk7CiAgICAgICAgU3RyaW5nIGNhdGFs\nb2cgPSBub3JtYWxpemVDYXRhbG9nTmFtZShhdHRycy5nZXRWYWx1ZSgiY2F0\nYWxvZyIpKTsKCiAgICAgICAgU3RyaW5nIGNsc05hbWUsIHByb3BzOwogICAg\nICAgIGlmIChzZXEgPT0gbnVsbCB8fCBzZXEuaW5kZXhPZignKCcpID09IC0x\nKSB7CiAgICAgICAgICAgIGNsc05hbWUgPSBTZXF1ZW5jZU1ldGFEYXRhLklN\nUExfTkFUSVZFOwogICAgICAgICAgICBwcm9wcyA9IG51bGw7CiAgICAgICAg\nfSBlbHNlIHsgLy8gcGx1Z2luCiAgICAgICAgICAgIGNsc05hbWUgPSBDb25m\naWd1cmF0aW9ucy5nZXRDbGFzc05hbWUoc2VxKTsKICAgICAgICAgICAgcHJv\ncHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKHNlcSk7CiAgICAg\nICAgICAgIHNlcSA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBtZXRhLnNl\ndFNlcXVlbmNlUGx1Z2luKENvbmZpZ3VyYXRpb25zLmdldFBsdWdpbihjbHNO\nYW1lLCBwcm9wcykpOwogICAgICAgIG1ldGEuc2V0U2VxdWVuY2Uoc2VxKTsK\nICAgICAgICBtZXRhLnNldEluaXRpYWxWYWx1ZShpbml0aWFsKTsKICAgICAg\nICBtZXRhLnNldEFsbG9jYXRlKGFsbG9jYXRlKTsKICAgICAgICBtZXRhLnNl\ndFNjaGVtYShzY2hlbWEpOwogICAgICAgIG1ldGEuc2V0Q2F0YWxvZyhjYXRh\nbG9nKTsKCiAgICAgICAgT2JqZWN0IGN1ciA9IGN1cnJlbnRFbGVtZW50KCk7\nCiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1ciBpbnN0YW5jZW9mIENsYXNz\nTWV0YURhdGEpCiAgICAgICAgICAgID8gKChDbGFzc01ldGFEYXRhKSBjdXIp\nLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7CiAgICAgICAgbWV0YS5zZXRT\nb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBzY29wZSwgU291cmNlVHJhY2tlci5T\nUkNfWE1MKTsKICAgICAgICBMb2NhdG9yIGxvY2F0b3IgPSBnZXRMb2NhdGlv\nbigpLmdldExvY2F0b3IoKTsKICAgICAgICBpZiAobG9jYXRvciAhPSBudWxs\nKSB7CiAgICAgICAgICAgIG1ldGEuc2V0TGluZU51bWJlcihsb2NhdG9yLmdl\ndExpbmVOdW1iZXIoKSk7CiAgICAgICAgICAgIG1ldGEuc2V0Q29sTnVtYmVy\nKGxvY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRT\nZXF1ZW5jZUdlbmVyYXRvcigpIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGlkLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydElk\nKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0\ndHJzKTsKICAgICAgICBmbWQuc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAg\nZm1kLnNldFByaW1hcnlLZXkodHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kSWQoKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGZpbmlzaEZpZWxkKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBlbWJlZGRlZC1pZC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRFbWJlZGRlZElkKEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsK\nICAgICAgICBmbWQuc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNl\ndFByaW1hcnlLZXkodHJ1ZSk7CiAgICAgICAgZm1kLnNldEVtYmVkZGVkKHRy\ndWUpOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsKICAgICAg\nICBpZiAoZm1kLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxsKQovLyAg\nICAgICAgICAgIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAg\nICAgIGRlZmVyRW1iZWRkYWJsZShmbWQuZ2V0RGVjbGFyZWRUeXBlKCksIGZt\nZCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVk\nIHZvaWQgZW5kRW1iZWRkZWRJZCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFBhcnNlIGlkLWNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBzdGFydElkQ2xhc3MoQXR0cmlidXRlcyBhdHRycykKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzTWV0YURh\ndGFNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\nQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEpIGN1cnJlbnRF\nbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIGNscyA9IGF0dHJzLmdldFZhbHVl\nKCJjbGFzcyIpOwogICAgICAgIENsYXNzPD8+IGlkQ2xzID0gbnVsbDsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBpZENscyA9IGNsYXNzRm9yTmFtZShj\nbHMpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAg\nICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9jLmdldCgiaW52YWxpZC1pZC1j\nbGFzcyIsIG1ldGEsIGNscyksIHQpOwogICAgICAgIH0KICAgICAgICBtZXRh\nLnNldE9iamVjdElkVHlwZShpZENscywgdHJ1ZSk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kSWRDbGFzcygp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQYXJzZSBsb2IuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29s\nZWFuIHN0YXJ0TG9iKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAo\nRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBpbnQg\ndHlwZUNvZGUgPSBmbWQuaXNFbGVtZW50Q29sbGVjdGlvbigpID8gZm1kLmdl\ndEVsZW1lbnQoKS5nZXREZWNsYXJlZFR5cGVDb2RlKCkgOiBmbWQuZ2V0RGVj\nbGFyZWRUeXBlQ29kZSgpOwogICAgICAgIENsYXNzPD8+IHR5cGUgPSBmbWQu\naXNFbGVtZW50Q29sbGVjdGlvbigpID8gZm1kLmdldEVsZW1lbnQoKS5nZXRE\nZWNsYXJlZFR5cGUoKSA6IGZtZC5nZXREZWNsYXJlZFR5cGUoKTsKICAgICAg\nICBpZiAodHlwZUNvZGUgIT0gSmF2YVR5cGVzLlNUUklORwogICAgICAgICAg\nICAmJiB0eXBlICE9IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAmJiB0eXBl\nICE9IENoYXJhY3RlcltdLmNsYXNzCiAgICAgICAgICAgICYmIHR5cGUgIT0g\nYnl0ZVtdLmNsYXNzCiAgICAgICAgICAgICYmIHR5cGUgIT0gQnl0ZVtdLmNs\nYXNzKQogICAgICAgICAgICBmbWQuc2V0U2VyaWFsaXplZCh0cnVlKTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBl\nbmRMb2IoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgZ2VuZXJhdGVkLXZhbHVlLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydEdlbmVyYXRlZFZhbHVlKEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgc3RyYXRlZ3kg\nPSBhdHRycy5nZXRWYWx1ZSgic3RyYXRlZ3kiKTsKICAgICAgICBTdHJpbmcg\nZ2VuZXJhdG9yID0gYXR0cnMuZ2V0VmFsdWUoImdlbmVyYXRvciIpOwogICAg\nICAgIEdlbmVyYXRpb25UeXBlIHR5cGUgPSBTdHJpbmdVdGlscy5pc0VtcHR5\nKHN0cmF0ZWd5KQogICAgICAgICAgICA/IEdlbmVyYXRpb25UeXBlLkFVVE8g\nOiBHZW5lcmF0aW9uVHlwZS52YWx1ZU9mKHN0cmF0ZWd5KTsKCiAgICAgICAg\nRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0\nYVBhcnNlci5wYXJzZUdlbmVyYXRlZFZhbHVlKGZtZCwgdHlwZSwKICAgICAg\nICAgICAgZ2VuZXJhdG9yKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRHZW5lcmF0ZWRWYWx1ZSgpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBMYXppbHkgcGFyc2UgY2FzY2FkZXMuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBib29sZWFuIHN0YXJ0Q2FzY2FkZShPYmplY3QgdGFnLCBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwoKICAgICAgICBTZXQ8Q2FzY2FkZVR5cGU+IGNhc2NhZGVzID0gbnVs\nbDsKICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQoKSBpbnN0YW5jZW9mIEZp\nZWxkTWV0YURhdGEpIHsKICAgICAgICAgICAgaWYgKF9jYXNjYWRlcyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgX2Nhc2NhZGVzID0gRW51bVNldC5ub25l\nT2YoQ2FzY2FkZVR5cGUuY2xhc3MpOwogICAgICAgICAgICBjYXNjYWRlcyA9\nIF9jYXNjYWRlczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAo\nX3BrZ0Nhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAgICAgICBfcGtnQ2Fz\nY2FkZXMgPSBFbnVtU2V0Lm5vbmVPZihDYXNjYWRlVHlwZS5jbGFzcyk7CiAg\nICAgICAgICAgIGNhc2NhZGVzID0gX3BrZ0Nhc2NhZGVzOwogICAgICAgIH0K\nICAgICAgICBib29sZWFuIGFsbCA9IEVMRU1fQ0FTQ0FERV9BTEwgPT0gdGFn\nOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1BFUiA9PSB0YWcp\nCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChQRVJTSVNUKTsKICAgICAgICBp\nZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9SRU0gPT0gdGFnKQogICAgICAgICAg\nICBjYXNjYWRlcy5hZGQoUkVNT1ZFKTsKICAgICAgICBpZiAoYWxsIHx8IEVM\nRU1fQ0FTQ0FERV9NRVIgPT0gdGFnKQogICAgICAgICAgICBjYXNjYWRlcy5h\nZGQoTUVSR0UpOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1JF\nRiA9PSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChSRUZSRVNIKTsK\nICAgICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9ERVQgPT0gdGFnKQog\nICAgICAgICAgICBjYXNjYWRlcy5hZGQoREVUQUNIKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY2FjaGVk\nIGNhc2NhZGVzIGludG8gdGhlIGZpZWxkLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBzZXRDYXNjYWRlcyhGaWVsZE1ldGFEYXRhIGZtZCkgewogICAg\nICAgIFNldDxDYXNjYWRlVHlwZT4gY2FzY2FkZXMgPSBfY2FzY2FkZXM7CiAg\nICAgICAgaWYgKF9jYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAgICBjYXNj\nYWRlcyA9IF9wa2dDYXNjYWRlczsKICAgICAgICBpZiAoY2FzY2FkZXMgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBWYWx1ZU1ldGFE\nYXRhIHZtZCA9IGZtZDsKICAgICAgICBzd2l0Y2ggKF9zdHJhdGVneSkgewog\nICAgICAgICAgICBjYXNlIE9ORV9NQU5ZOgogICAgICAgICAgICBjYXNlIE1B\nTllfTUFOWToKICAgICAgICAgICAgICAgIHZtZCA9IGZtZC5nZXRFbGVtZW50\nKCk7CiAgICAgICAgfQogICAgICAgIGZvciAoQ2FzY2FkZVR5cGUgY2FzY2Fk\nZSA6IGNhc2NhZGVzKSB7CiAgICAgICAgICAgIHN3aXRjaCAoY2FzY2FkZSkg\newogICAgICAgICAgICAgICAgY2FzZSBQRVJTSVNUOgogICAgICAgICAgICAg\nICAgICAgIHZtZC5zZXRDYXNjYWRlUGVyc2lzdChWYWx1ZU1ldGFEYXRhLkNB\nU0NBREVfSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgTUVSR0U6CiAgICAgICAgICAgICAgICAg\nICAgdm1kLnNldENhc2NhZGVBdHRhY2goVmFsdWVNZXRhRGF0YS5DQVNDQURF\nX0lNTUVESUFURSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIERFVEFDSDoKICAgICAgICAgICAgICAgICAgICB2\nbWQuc2V0Q2FzY2FkZURldGFjaChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1N\nRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgUkVNT1ZFOgogICAgICAgICAgICAgICAgICAgIHZtZC5z\nZXRDYXNjYWRlRGVsZXRlKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9JTU1FRElB\nVEUpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBSRUZSRVNIOgogICAgICAgICAgICAgICAgICAgIHZtZC5zZXRD\nYXNjYWRlUmVmcmVzaChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1NRURJQVRF\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBfY2FzY2FkZXMgPSBudWxsOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgY29tbW9uIGZpZWxkIGF0dHJpYnV0ZXMuCiAg\nICAgKi8KICAgIHByaXZhdGUgRmllbGRNZXRhRGF0YSBwYXJzZUZpZWxkKEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEp\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRy\ncy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIEZpZWxkTWV0YURhdGEgZmll\nbGQgPSBtZXRhLmdldERlY2xhcmVkRmllbGQobmFtZSk7CiAgICAgICAgaW50\nIGZsZEFjY2VzcyA9IGdldEZpZWxkQWNjZXNzKGZpZWxkLCBhdHRycyk7CiAg\nICAgICAgLy8gSWYgdGhlIGFjY2VzcyBkZWZpbmVkIGluIFhNTCBpcyBub3Qg\ndGhlIHNhbWUgYXMgd2hhdCB3YXMgZGVmaW5lZAogICAgICAgIC8vIGJ5IGRl\nZmF1bHQgb3IgYW5ub3RhdGlvbiwgZmluZCB0aGUgYXBwcm9wcmlhdGUgYmFj\na2luZyBtZW1iZXIgYW5kCiAgICAgICAgLy8gcmVwbGFjZSB3aGF0IGlzIGN1\ncnJlbnRseSBkZWZpbmVkIGluIG1ldGFkYXRhLgogICAgICAgIGlmICgoZmll\nbGQgPT0gbnVsbCB8fCBmaWVsZC5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmpl\nY3QuY2xhc3MgfHwKICAgICAgICAgICAgIGZpZWxkLmdldEFjY2Vzc1R5cGUo\nKSAhPSBmbGRBY2Nlc3MpCiAgICAgICAgICAgICYmIG1ldGEuZ2V0RGVzY3Jp\nYmVkVHlwZSgpICE9IE9iamVjdC5jbGFzcykgewogICAgICAgICAgICBNZW1i\nZXIgbWVtYmVyID0gX3JlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdldERl\nZmF1bHRzKCkKICAgICAJICAgICAgICAuZ2V0TWVtYmVyQnlQcm9wZXJ0eSht\nZXRhLCBuYW1lLCBmbGRBY2Nlc3MsIGZhbHNlKTsKICAgICAgICAgICAgQ2xh\nc3M8Pz4gdHlwZSA9IEZpZWxkLmNsYXNzLmlzSW5zdGFuY2UobWVtYmVyKSA/\nCiAgICAgICAgICAgICAgICAoKEZpZWxkKW1lbWJlcikuZ2V0VHlwZSgpIDog\nKChNZXRob2QpbWVtYmVyKS5nZXRSZXR1cm5UeXBlKCk7CgogICAgICAgICAg\nICBpZiAoZmllbGQgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgZmllbGQg\nPSBtZXRhLmFkZERlY2xhcmVkRmllbGQobmFtZSwgdHlwZSk7CiAgICAgICAg\nICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2Fk\nZU5vbmUoZmllbGQpOwogICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRh\nRGF0YURlZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEtleSgpKTsK\nICAgICAgICAgICAgICAgIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5z\nZXRDYXNjYWRlTm9uZShmaWVsZC5nZXRFbGVtZW50KCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGZpZWxkLmJhY2tpbmdNZW1iZXIobWVtYmVyKTsK\nICAgICAgICB9IGVsc2UgaWYgKGZpZWxkID09IG51bGwpIHsKICAgICAgICAg\nICAgZmllbGQgPSBtZXRhLmFkZERlY2xhcmVkRmllbGQobmFtZSwgT2JqZWN0\nLmNsYXNzKTsKICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1\nbHRzLnNldENhc2NhZGVOb25lKGZpZWxkKTsKICAgICAgICAgICAgUGVyc2lz\ndGVuY2VNZXRhRGF0YURlZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdl\ndEtleSgpKTsKICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1\nbHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAgICAg\nICAgfQoKICAgICAgICBpZiAoaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAg\nICAgZmllbGQuc2V0TGlzdGluZ0luZGV4KF9maWVsZFBvcyk7CgogICAgICAg\nIF9maWVsZFBvcysrOwogICAgICAgIHB1c2hFbGVtZW50KGZpZWxkKTsKICAg\nICAgICBhZGRDb21tZW50cyhmaWVsZCk7CgogICAgICAgIGlmIChpc01hcHBp\nbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAgICAgc3RhcnRGaWVsZE1hcHBp\nbmcoZmllbGQsIGF0dHJzKTsKICAgICAgICByZXR1cm4gZmllbGQ7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQb3BzIGZpZWxkIGVsZW1lbnQuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBmaW5pc2hGaWVsZCgpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmaWVsZCA9\nIChGaWVsZE1ldGFEYXRhKSBwb3BFbGVtZW50KCk7CiAgICAgICAgc2V0Q2Fz\nY2FkZXMoZmllbGQpOwogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1v\nZGUoKSkKICAgICAgICAgICAgZW5kRmllbGRNYXBwaW5nKGZpZWxkKTsKICAg\nICAgICBfc3RyYXRlZ3kgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nRGV0ZXJtaW5lcyBhY2Nlc3MgZm9yIGZpZWxkIGJhc2VkIHVwb24gZXhpc3Rp\nbmcgbWV0YWRhdGEgYW5kIFhNTAogICAgICogYXR0cmlidXRlcy4KICAgICAq\nCiAgICAgKiBAcGFyYW0gZmllbGQgRmllbGRNZXRhRGF0YSBjdXJyZW50IG1l\ndGFkYXRhIGZvciBmaWVsZAogICAgICogQHBhcmFtIGF0dHJzIFhNTCBBdHRy\naWJ1dGVzIGRlZmluZWQgb24gdGhpcyBmaWVsZAogICAgICogQHJldHVybgog\nICAgICovCiAgICBwcml2YXRlIGludCBnZXRGaWVsZEFjY2VzcyhGaWVsZE1l\ndGFEYXRhIGZpZWxkLCBBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgaWYg\nKGF0dHJzICE9IG51bGwpIHsKICAgICAgICAgICAgU3RyaW5nIGFjY2VzcyA9\nIGF0dHJzLmdldFZhbHVlKCJhY2Nlc3MiKTsKICAgICAgICAgICAgaWYgKCJQ\nUk9QRVJUWSIuZXF1YWxzKGFjY2VzcykpCiAgICAgICAgICAgICAgICByZXR1\ncm4gQWNjZXNzQ29kZS5FWFBMSUNJVCB8IEFjY2Vzc0NvZGUuUFJPUEVSVFk7\nCiAgICAgICAgICAgIGlmICgiRklFTEQiLmVxdWFscyhhY2Nlc3MpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIEFjY2Vzc0NvZGUuRVhQTElDSVQgfCBBY2Nl\nc3NDb2RlLkZJRUxEOwogICAgICAgIH0KICAgICAgICAvLyBDaGVjayBhY2Nl\nc3MgZGVmaW5lZCBvbiBmaWVsZCwgaWYgcHJvdmlkZWQKICAgICAgICBpZiAo\nZmllbGQgIT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gZmllbGQuZ2V0\nQWNjZXNzVHlwZSgpOwogICAgICAgIH0KICAgICAgICAvLyBPdGhlcndpc2Us\nIGdldCB0aGUgZGVmYXVsdCBhY2Nlc3MgdHlwZSBvZiB0aGUgZGVjbGFyaW5n\nIGNsYXNzCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0\nYURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgaWYgKG1ldGEgIT0g\nbnVsbCkgewogICAgICAgICAgICByZXR1cm4gQWNjZXNzQ29kZS50b0ZpZWxk\nQ29kZShtZXRhLmdldEFjY2Vzc1R5cGUoKSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBBY2Nlc3NDb2RlLlVOS05PV047CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJbXBsZW1lbnQgdG8gYWRkIGZpZWxkIG1hcHBpbmcgZGF0YS4gRG9l\ncyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2\nb2lkIHN0YXJ0RmllbGRNYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQsIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gZmluYWxpemUg\nZmllbGQgbWFwcGluZy4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIGVuZEZpZWxkTWFwcGluZyhGaWVsZE1l\ndGFEYXRhIGZpZWxkKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdmVyc2lvbi4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRWZXJzaW9uKEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nRmllbGRNZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAgICAg\nICBmbWQuc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFZlcnNp\nb24odHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJv\ndGVjdGVkIHZvaWQgZW5kVmVyc2lvbigpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIHN0cmF0ZWd5IGVsZW1lbnQuCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBzdGFydFN0cmF0ZWd5KFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kgc3RyYXRlZ3ksCiAgICAgICAgQXR0cmlidXRlcyBhdHRycykKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZCA9IHBhcnNlRmllbGQoYXR0cnMpOwogICAgICAgIGZtZC5zZXRF\neHBsaWNpdCh0cnVlKTsKICAgICAgICBmbWQuc2V0TWFuYWdlbWVudChGaWVs\nZE1ldGFEYXRhLk1BTkFHRV9QRVJTSVNURU5UKTsKCiAgICAgICAgU3RyaW5n\nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJvcHRpb25hbCIpOwogICAgICAgIGlm\nICgiZmFsc2UiLmVxdWFscyh2YWwpKQogICAgICAgICAgICBmbWQuc2V0TnVs\nbFZhbHVlKEZpZWxkTWV0YURhdGEuTlVMTF9FWENFUFRJT04pOwogICAgICAg\nIGVsc2UgaWYgKCJ0cnVlIi5lcXVhbHModmFsKQogICAgICAgICAgICAgICAg\nJiYgZm1kLmdldE51bGxWYWx1ZSgpID09IEZpZWxkTWV0YURhdGEuTlVMTF9F\nWENFUFRJT04pIHsKICAgICAgICAgICAgLy8gUmVzZXQgdmFsdWUgaWYgdGhl\nIGZpZWxkIHdhcyBhbm5vdGF0ZWQgd2l0aCBvcHRpb25hbD1mYWxzZS4KICAg\nICAgICAgICAgLy8gT3RoZXJ3aXNlIGxlYXZlIGl0IGFsb25lLgogICAgICAg\nICAgICBmbWQuc2V0TnVsbFZhbHVlKEZpZWxkTWV0YURhdGEuTlVMTF9VTlNF\nVCk7CiAgICAgICAgfQogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1v\nZGUoKSkgewogICAgICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgibWFw\ncGVkLWJ5Iik7CiAgICAgICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIGZtZC5zZXRNYXBwZWRCeSh2YWwpOwogICAgICAgIH0KICAg\nICAgICBwYXJzZVN0cmF0ZWd5KGZtZCwgc3RyYXRlZ3ksIGF0dHJzKTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZW5k\nU3RyYXRlZ3koUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSkKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5pc2hGaWVsZCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugc3RyYXRlZ3kgc3BlY2lm\naWMgYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNl\nU3RyYXRlZ3koRmllbGRNZXRhRGF0YSBmbWQsCiAgICAgICAgUGVyc2lzdGVu\nY2VTdHJhdGVneSBzdHJhdGVneSwgQXR0cmlidXRlcyBhdHRycykKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBzd2l0Y2ggKHN0cmF0\nZWd5KSB7CiAgICAgICAgICAgIGNhc2UgQkFTSUM6CiAgICAgICAgICAgICAg\nICBwYXJzZUJhc2ljKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgRU1CRURERUQ6CiAgICAgICAgICAgICAg\nICBwYXJzZUVtYmVkZGVkKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT05FX09ORToKICAgICAgICAgICAg\nICAgIHBhcnNlT25lVG9PbmUoZm1kLCBhdHRycyk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBNQU5ZX09ORToKICAgICAgICAg\nICAgICAgIHBhcnNlTWFueVRvT25lKGZtZCwgYXR0cnMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTUFOWV9NQU5ZOgogICAg\nICAgICAgICAgICAgcGFyc2VNYW55VG9NYW55KGZtZCwgYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT05FX01BTlk6\nCiAgICAgICAgICAgICAgICBwYXJzZU9uZVRvTWFueShmbWQsIGF0dHJzKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRSQU5T\nSUVOVDoKICAgICAgICAgICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRW\nYWx1ZSgiZmV0Y2giKTsKICAgICAgICAgICAgICAgIGlmICh2YWwgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRj\naEdyb3VwKCJFQUdFUiIuZXF1YWxzKHZhbCkpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgZm1kLnNldE1hbmFnZW1lbnQoRmllbGRNZXRh\nRGF0YS5NQU5BR0VfTk9ORSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBFTEVNX0NPTEw6CiAgICAgICAgICAgICAgICBwYXJz\nZUVsZW1lbnRDb2xsZWN0aW9uKGZtZCwgYXR0cnMpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGJhc2ljLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBwYXJzZUJhc2ljKEZpZWxkTWV0YURhdGEgZm1kLCBB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiZmV0Y2gi\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpIHsKICAgICAgICAgICAgZm1k\nLnNldEluRGVmYXVsdEZldGNoR3JvdXAoIkVBR0VSIi5lcXVhbHModmFsKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZW1iZWRk\nZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlRW1iZWRkZWQo\nRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYXNzZXJ0UEMoZm1kLCAi\nRW1iZWRkZWQiKTsKICAgICAgICBmbWQuc2V0SW5EZWZhdWx0RmV0Y2hHcm91\ncCh0cnVlKTsKICAgICAgICBmbWQuc2V0RW1iZWRkZWQodHJ1ZSk7CiAgICAg\nICAgZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBhbnkg\nTG9iIGFubm90YXRpb24KCiAgICAgICAgaWYgKGZtZC5nZXRFbWJlZGRlZE1l\ndGFEYXRhKCkgPT0gbnVsbCkKLy8gICAgICAgICAgICBmbWQuYWRkRW1iZWRk\nZWRNZXRhRGF0YSgpOwogICAgICAgICAgICBkZWZlckVtYmVkZGFibGUoZm1k\nLmdldERlY2xhcmVkVHlwZSgpLCBmbWQpOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhyb3cgcHJvcGVyIGV4Y2VwdGlvbiBpZiBnaXZlbiB2YWx1ZSBpcyBu\nb3QgcG9zc2libHkgcGVyc2lzdGVuY2UKICAgICAqIGNhcGFibGUuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBhc3NlcnRQQyhGaWVsZE1ldGFEYXRhIGZt\nZCwgU3RyaW5nIGF0dHIpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKCFKYXZhVHlwZXMubWF5YmVQQyhmbWQpKQogICAgICAg\nICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1tZXRhLWFu\nbm8iLCBmbWQsIGF0dHIpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIG9uZS10by1vbmUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNl\nT25lVG9PbmUoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5n\nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlmICh2\nYWwgPT0gbnVsbCB8fCAiRUFHRVIiLmVxdWFscyh2YWwpKSB7CiAgICAgICAg\nICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdyb3VwKHRydWUpOwogICAgICAg\nIH0KICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgidGFyZ2V0LWVudGl0\neSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1k\nLnNldFR5cGVPdmVycmlkZShjbGFzc0Zvck5hbWUodmFsKSk7CiAgICAgICAg\nYXNzZXJ0UEMoZm1kLCAiT25lVG9PbmUiKTsKICAgICAgICBmbWQuc2V0U2Vy\naWFsaXplZChmYWxzZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlv\nbgogICAgICAgIGJvb2xlYW4gb3JwaGFuUmVtb3ZhbCA9IEJvb2xlYW4udmFs\ndWVPZihhdHRycy5nZXRWYWx1ZSgKICAgICAgICAgICAgIm9ycGhhbi1yZW1v\ndmFsIikpOwogICAgICAgIHNldE9ycGhhblJlbW92YWwoZm1kLCBvcnBoYW5S\nZW1vdmFsKTsKICAgICAgICBTdHJpbmcgbWFwc0lkID0gYXR0cnMuZ2V0VmFs\ndWUoIm1hcHMtaWQiKTsKICAgICAgICBpZiAobWFwc0lkICE9IG51bGwpCiAg\nICAgICAgICAgIGZtZC5zZXRNYXBwZWRCeUlkVmFsdWUobWFwc0lkKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFBhcnNlIG1hbnktdG8tb25lLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZU1hbnlUb09uZShGaWVsZE1ldGFE\nYXRhIGZtZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFs\ndWUoImZldGNoIik7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsIHx8ICJFQUdF\nUiIuZXF1YWxzKHZhbCkpIHsKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVs\ndEZldGNoR3JvdXAodHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHZhbCA9IGF0\ndHJzLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAgaWYgKHZh\nbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuc2V0VHlwZU92ZXJyaWRlKGNs\nYXNzRm9yTmFtZSh2YWwpKTsKICAgICAgICBhc3NlcnRQQyhmbWQsICJNYW55\nVG9PbmUiKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxzZSk7IC8v\nIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgogICAgICAgIFN0cmluZyBt\nYXBzSWQgPSBhdHRycy5nZXRWYWx1ZSgibWFwcy1pZCIpOwogICAgICAgIGlm\nIChtYXBzSWQgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLnNldE1hcHBlZEJ5\nSWRWYWx1ZShtYXBzSWQpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\nbWFueS10by1tYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJz\nZU1hbnlUb01hbnkoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3Ry\naW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlm\nICh2YWwgIT0gbnVsbCkgewogICAgICAgICAgICBmbWQuc2V0SW5EZWZhdWx0\nRmV0Y2hHcm91cCgiRUFHRVIiLmVxdWFscyh2YWwpKTsKICAgICAgICB9CiAg\nICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdldC1lbnRpdHkiKTsK\nICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGZtZC5nZXRF\nbGVtZW50KCkuc2V0RGVjbGFyZWRUeXBlKGNsYXNzRm9yTmFtZSh2YWwpKTsK\nICAgICAgICBhc3NlcnRQQ0NvbGxlY3Rpb24oZm1kLCAiTWFueVRvTWFueSIp\nOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJp\nZGUgTG9iIGluIGFubm90YXRpb24KICAgIH0KCiAgICAvKioKICAgICAqIFRo\ncm93IGV4Y2VwdGlvbiBpZiBnaXZlbiBmaWVsZCBub3QgYSBjb2xsZWN0aW9u\nIG9mIHBvc3NpYmxlIHBlcnNpc3RlbmNlCiAgICAgKiBjYXBhYmxlcy4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydFBDQ29sbGVjdGlvbihGaWVs\nZE1ldGFEYXRhIGZtZCwgU3RyaW5nIGF0dHIpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgc3dpdGNoIChmbWQuZ2V0RGVjbGFyZWRU\neXBlQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZ\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICBp\nZiAoSmF2YVR5cGVzLm1heWJlUEMoZm1kLmdldEVsZW1lbnQoKSkpCiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAvLyBubyBi\ncmVhawogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhy\nb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbWV0YS1hbm5vIiwgZm1k\nLCBhdHRyKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUGFy\nc2Ugb25lLXRvLW1hbnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBh\ncnNlT25lVG9NYW55KEZpZWxkTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFN0\ncmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICBp\nZiAodmFsICE9IG51bGwpIHsKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVs\ndEZldGNoR3JvdXAoIkVBR0VSIi5lcXVhbHModmFsKSk7CiAgICAgICAgfQog\nICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7\nCiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuZ2V0\nRWxlbWVudCgpLnNldERlY2xhcmVkVHlwZShjbGFzc0Zvck5hbWUodmFsKSk7\nCiAgICAgICAgYXNzZXJ0UENDb2xsZWN0aW9uKGZtZCwgIk9uZVRvTWFueSIp\nOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJp\nZGUgYW55IExvYiBhbm5vdGF0aW9uCiAgICAgICAgYm9vbGVhbiBvcnBoYW5S\nZW1vdmFsID0gQm9vbGVhbi52YWx1ZU9mKGF0dHJzLmdldFZhbHVlKAogICAg\nICAgICAgICAib3JwaGFuLXJlbW92YWwiKSk7CiAgICAgICAgc2V0T3JwaGFu\nUmVtb3ZhbChmbWQuZ2V0RWxlbWVudCgpLCBvcnBoYW5SZW1vdmFsKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRPcnBoYW5SZW1vdmFsKFZhbHVl\nTWV0YURhdGEgdm1kLCBib29sZWFuIG9ycGhhblJlbW92YWwpIHsKICAgICAg\nICBpZiAob3JwaGFuUmVtb3ZhbCkKICAgICAgICAgICAgdm1kLnNldENhc2Nh\nZGVEZWxldGUoVmFsdWVNZXRhRGF0YS5DQVNDQURFX0FVVE8pOwogICAgfQoK\nICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlRWxlbWVudENvbGxlY3Rpb24oRmll\nbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJ0YXJnZXQtY2xhc3MiKTsKICAgICAgICBpZiAodmFsICE9\nIG51bGwpCiAgICAgICAgICAgIGZtZC5nZXRFbGVtZW50KCkuc2V0RGVjbGFy\nZWRUeXBlKGNsYXNzRm9yTmFtZSh2YWwpKTsKCiAgICAgICAgaWYgKGZtZC5n\nZXREZWNsYXJlZFR5cGVDb2RlKCkgIT0gSmF2YVR5cGVzLkNPTExFQ1RJT04g\nJiYKICAgICAgICAgICAgZm1kLmdldERlY2xhcmVkVHlwZUNvZGUoKSAhPSBK\nYXZhVHlwZXMuTUFQKQogICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24o\nX2xvYy5nZXQoImJhZC1tZXRhLWFubm8iLCBmbWQsCiAgICAgICAgICAgICAg\nICAgICAgIkVsZW1lbnRDb2xsZWN0aW9uIikpOwoKICAgICAgICB2YWwgPSBh\ndHRycy5nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICBpZiAodmFsICE9IG51\nbGwpCiAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdyb3VwKCJF\nQUdFUiIuZXF1YWxzKHZhbCkpOwogICAgICAgIGZtZC5zZXRFbGVtZW50Q29s\nbGVjdGlvbih0cnVlKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxz\nZSk7CiAgICAgICAgaWYgKEphdmFUeXBlcy5tYXliZVBDKGZtZC5nZXRFbGVt\nZW50KCkpICYmICFmbWQuZ2V0RWxlbWVudCgpLmdldERlY2xhcmVkVHlwZSgp\nLmlzRW51bSgpKSB7CiAgICAgICAgICAgIGZtZC5nZXRFbGVtZW50KCkuc2V0\nRW1iZWRkZWQodHJ1ZSk7CiAgICAgICAgICAgIGlmIChmbWQuZ2V0RWxlbWVu\ndCgpLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxsKQovLyAgICAgICAg\nICAgICAgICBmbWQuZ2V0RWxlbWVudCgpLmFkZEVtYmVkZGVkTWV0YURhdGEo\nKTsKICAgICAgICAgICAgICAgIGRlZmVyRW1iZWRkYWJsZShmbWQuZ2V0RWxl\nbWVudCgpLmdldERlY2xhcmVkVHlwZSgpLAogICAgICAgICAgICAgICAgICAg\nIGZtZC5nZXRFbGVtZW50KCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFBhcnNlIG1hcC1rZXkuCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBzdGFydE1hcEtleShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNNYXBwaW5nT3Zl\ncnJpZGVNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAg\nICAgRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBTdHJpbmcgbWFwS2V5ID0gYXR0cnMuZ2V0\nVmFsdWUoIm5hbWUiKTsKICAgICAgICBpZiAobWFwS2V5ID09IG51bGwpCiAg\nICAgICAgICAgIGZtZC5nZXRLZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KFZhbHVl\nTWV0YURhdGEuTUFQUEVEX0JZX1BLKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIGZtZC5nZXRLZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KG1hcEtleSk7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8qKgogICAgICogUGFy\nc2UgbWFwLWtleS1jbGFzcy4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIHN0YXJ0TWFwS2V5Q2xhc3MoQXR0cmlidXRlcyBhdHRycykKICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJp\nZGVNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\nRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBTdHJpbmcgbWFwS2V5Q2xhc3MgPSBhdHRycy5n\nZXRWYWx1ZSgiY2xhc3MiKTsKCiAgICAgICAgaWYgKG1hcEtleUNsYXNzICE9\nIG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZt\nZC5nZXRLZXkoKS5zZXREZWNsYXJlZFR5cGUoQ2xhc3MuZm9yTmFtZShtYXBL\nZXlDbGFzcykpOwogICAgICAgICAgICB9IGNhdGNoIChDbGFzc05vdEZvdW5k\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxl\nZ2FsQXJndW1lbnRFeGNlcHRpb24oIkNsYXNzIG5vdCBmb3VuZCIpOwogICAg\nICAgICAgICB9CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHRocm93IG5l\ndyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAgICAgICJUaGUg\ndmFsdWUgb2YgdGhlIE1hcEtleUNsYXNzIGNhbm5vdCBiZSBudWxsIik7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBvcmRlci1ieS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZE9yZGVy\nQnkoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZp\nZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpIGN1cnJlbnRFbGVt\nZW50KCk7CiAgICAgICAgU3RyaW5nIGRlYyA9IGN1cnJlbnRUZXh0KCk7CiAg\nICAgICAgaWYgKGZtZC5pc0VsZW1lbnRDb2xsZWN0aW9uKCkgJiYKICAgICAg\nICAgICAgZm1kLmdldEVsZW1lbnQoKS5nZXRFbWJlZGRlZE1ldGFEYXRhKCkg\nIT0gbnVsbCB8fAogICAgICAgICAgICBpc0RlZmVycmVkRW1iZWRkYWJsZShm\nbWQuZ2V0RWxlbWVudCgpLmdldERlY2xhcmVkVHlwZSgpLAogICAgICAgICAg\nICAgICAgZm1kLmdldEVsZW1lbnQoKSkpIHsKICAgICAgICAgICAgaWYgKGRl\nYy5sZW5ndGgoKSA9PSAwIHx8IGRlYy5lcXVhbHMoIkFTQyIpIHx8CiAgICAg\nICAgICAgICAgICBkZWMuZXF1YWxzKCJERVNDIikpCiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoCiAgICAg\nICAgICAgICAgICAgICAgImludmFsaWQtb3JkZXJCeSIsIGZtZCkpOwogICAg\nICAgIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShkZWMpIHx8\nIGRlYy5lcXVhbHMoIkFTQyIpKQogICAgICAgICAgICBkZWMgPSBPcmRlci5F\nTEVNRU5UICsgIiBhc2MiOwogICAgICAgIGVsc2UgaWYgKGRlYy5lcXVhbHMo\nIkRFU0MiKSkKICAgICAgICAgICAgZGVjID0gT3JkZXIuRUxFTUVOVCArICIg\nZGVzYyI7CgogICAgICAgIGZtZC5zZXRPcmRlckRlY2xhcmF0aW9uKGRlYyk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBuYW1lZC1xdWVyeS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnROYW1lZFF1ZXJ5KEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKCFpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFs\ndWUoIm5hbWUiKTsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cu\ndHJhY2UoX2xvYy5nZXQoInBhcnNlLXF1ZXJ5IiwgbmFtZSkpOwoKICAgICAg\nICBRdWVyeU1ldGFEYXRhIG1ldGEgPSBnZXRSZXBvc2l0b3J5KCkuc2VhcmNo\nUXVlcnlNZXRhRGF0YUJ5TmFtZShuYW1lKTsKICAgICAgICBpZiAobWV0YSAh\nPSBudWxsKSB7CiAgICAgICAgCUNsYXNzPD8+IGRlZlR5cGUgPSBtZXRhLmdl\ndERlZmluaW5nVHlwZSgpOwogICAgICAgICAgICBpZiAoKGRlZlR5cGUgIT0g\nX2NscykgJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkgewogICAgICAgICAgICAg\nICAgbG9nLndhcm4oX2xvYy5nZXQoImR1cC1xdWVyeSIsIG5hbWUsIGN1cnJl\nbnRMb2NhdGlvbigpLAogICAgICAgICAgICAJICAgICAgICBkZWZUeXBlKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7\nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAg\nbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5hZGRRdWVyeU1ldGFEYXRhKG51bGws\nIG5hbWUpOwogICAgICAgIG1ldGEuc2V0RGVmaW5pbmdUeXBlKF9jbHMpOwog\nICAgICAgIG1ldGEuc2V0UXVlcnlTdHJpbmcoYXR0cnMuZ2V0VmFsdWUoInF1\nZXJ5IikpOwogICAgICAgIG1ldGEuc2V0TGFuZ3VhZ2UoSlBRTFBhcnNlci5M\nQU5HX0pQUUwpOwogICAgICAgIFN0cmluZyBsb2NrTW9kZVN0ciA9IGF0dHJz\nLmdldFZhbHVlKCJsb2NrLW1vZGUiKTsKICAgICAgICBpZiAobG9ja01vZGVT\ndHIgIT0gbnVsbCkgewogICAgICAgICAgICBtZXRhLmFkZEhpbnQoIm9wZW5q\ncGEuRmV0Y2hQbGFuLlJlYWRMb2NrTW9kZSIsIExvY2tNb2RlVHlwZS52YWx1\nZU9mKGxvY2tNb2RlU3RyKSk7CiAgICAgICAgfQogICAgICAgIExvY2F0b3Ig\nbG9jYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwogICAgICAg\nIGlmIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgbWV0YS5zZXRM\naW5lTnVtYmVyKGxvY2F0b3IuZ2V0TGluZU51bWJlcigpKTsKICAgICAgICAg\nICAgbWV0YS5zZXRDb2xOdW1iZXIobG9jYXRvci5nZXRDb2x1bW5OdW1iZXIo\nKSk7CiAgICAgICAgfQogICAgICAgIE9iamVjdCBjdXIgPSBjdXJyZW50RWxl\nbWVudCgpOwogICAgICAgIE9iamVjdCBzY29wZSA9IChjdXIgaW5zdGFuY2Vv\nZiBDbGFzc01ldGFEYXRhKQogICAgICAgICAgICA/ICgoQ2xhc3NNZXRhRGF0\nYSkgY3VyKS5nZXREZXNjcmliZWRUeXBlKCkgOiBudWxsOwogICAgICAgIG1l\ndGEuc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUsIFNvdXJjZVRy\nYWNrZXIuU1JDX1hNTCk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2RlKCkp\nCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01FVEEpOwog\nICAgICAgIGVsc2UgaWYgKGlzTWFwcGluZ01vZGUoKSkKICAgICAgICAgICAg\nbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUFQUElORyk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9RVUVSWSk7\nCiAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kTmFtZWRRdWVyeSgp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxl\nbWVudCgpOwogICAgfQoKICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0UXVl\ncnlTdHJpbmcoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmRRdWVyeVN0cmluZygpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRhID0g\nKFF1ZXJ5TWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgbWV0\nYS5zZXRRdWVyeVN0cmluZyhjdXJyZW50VGV4dCgpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIHF1ZXJ5LWhpbnQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIHN0YXJ0UXVlcnlIaW50KEF0dHJpYnV0ZXMgYXR0cnMp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgUXVlcnlN\nZXRhRGF0YSBtZXRhID0gKFF1ZXJ5TWV0YURhdGEpIGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgbWV0YS5hZGRIaW50KGF0dHJzLmdldFZhbHVlKCJuYW1l\nIiksIGF0dHJzLmdldFZhbHVlKCJ2YWx1ZSIpKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRRdWVyeUhpbnQo\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgbmF0aXZlLW5hbWVkLXF1ZXJ5LgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydE5hbWVkTmF0aXZlUXVlcnkoQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIWlzUXVlcnlNb2RlKCkpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKCiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1\nZSgibmFtZSIpOwogICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAg\nICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50\ncmFjZShfbG9jLmdldCgicGFyc2UtbmF0aXZlLXF1ZXJ5IiwgbmFtZSkpOwoK\nICAgICAgICBRdWVyeU1ldGFEYXRhIG1ldGEgPSBnZXRSZXBvc2l0b3J5KCku\nZ2V0Q2FjaGVkUXVlcnlNZXRhRGF0YShudWxsLCBuYW1lKTsKICAgICAgICBp\nZiAobWV0YSAhPSBudWxsICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJvdmVycmlkZS1xdWVyeSIsIG5h\nbWUsIGN1cnJlbnRMb2NhdGlvbigpKSk7CgogICAgICAgIG1ldGEgPSBnZXRS\nZXBvc2l0b3J5KCkuYWRkUXVlcnlNZXRhRGF0YShudWxsLCBuYW1lKTsKICAg\nICAgICBtZXRhLnNldERlZmluaW5nVHlwZShfY2xzKTsKICAgICAgICBtZXRh\nLnNldFF1ZXJ5U3RyaW5nKGF0dHJzLmdldFZhbHVlKCJxdWVyeSIpKTsKICAg\nICAgICBtZXRhLnNldExhbmd1YWdlKFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FM\nKTsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInJlc3Vs\ndC1jbGFzcyIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkgewogICAgICAg\nICAgICBDbGFzczw/PiB0eXBlID0gY2xhc3NGb3JOYW1lKHZhbCk7CiAgICAg\nICAgICAgIGlmIChJbXBsSGVscGVyLmlzTWFuYWdlZFR5cGUoZ2V0Q29uZmln\ndXJhdGlvbigpLCB0eXBlKSkKICAgICAgICAgICAgICAgIG1ldGEuc2V0Q2Fu\nZGlkYXRlVHlwZSh0eXBlKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgbWV0YS5zZXRSZXN1bHRUeXBlKHR5cGUpOwogICAgICAgIH0KCiAg\nICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInJlc3VsdC1zZXQtbWFwcGlu\nZyIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgbWV0\nYS5zZXRSZXN1bHRTZXRNYXBwaW5nTmFtZSh2YWwpOwoKICAgICAgICBPYmpl\nY3QgY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2Nv\ncGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAg\nICAgPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgp\nIDogbnVsbDsKICAgICAgICBtZXRhLnNldFNvdXJjZShnZXRTb3VyY2VGaWxl\nKCksIHNjb3BlLCBTb3VyY2VUcmFja2VyLlNSQ19YTUwpOwogICAgICAgIExv\nY2F0b3IgbG9jYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwog\nICAgICAgIGlmIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgbWV0\nYS5zZXRMaW5lTnVtYmVyKGxvY2F0b3IuZ2V0TGluZU51bWJlcigpKTsKICAg\nICAgICAgICAgbWV0YS5zZXRDb2xOdW1iZXIobG9jYXRvci5nZXRDb2x1bW5O\ndW1iZXIoKSk7CiAgICAgICAgfQogICAgICAgIGlmIChpc01ldGFEYXRhTW9k\nZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NRVRB\nKTsKICAgICAgICBlbHNlIGlmIChpc01hcHBpbmdNb2RlKCkpCiAgICAgICAg\nICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01BUFBJTkcpOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfUVVF\nUlkpOwogICAgICAgIHB1c2hFbGVtZW50KG1ldGEpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZE5hbWVkTmF0\naXZlUXVlcnkoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIHBvcEVsZW1lbnQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXJ0\nIGVudGl0eS1saXN0ZW5lcnMKICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIHN0YXJ0RW50aXR5TGlzdGVuZXJzKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01ldGFE\nYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\naWYgKGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CgogICAgICAgIC8vIHJlc2V0IGxpc3RlbmVycyBkZWNsYXJl\nZCBpbiBhbm5vdGF0aW9ucy4KICAgICAgICBMaWZlY3ljbGVNZXRhRGF0YSBt\nZXRhID0gKChDbGFzc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpKS4KICAg\nICAgICAgICAgZ2V0TGlmZWN5Y2xlTWV0YURhdGEoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IExpZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIG1ldGEuc2V0RGVjbGFyZWRDYWxsYmFj\na3MoaSwgbnVsbCwgMCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQYXJzZSBleGNsdWRlLWRlZmF1bHQtbGlzdGVuZXJz\nLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRFeGNsdWRlRGVm\nYXVsdExpc3RlbmVycyhBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUo\nKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIENsYXNzTWV0\nYURhdGEgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgp\nOwogICAgICAgIG1ldGEuZ2V0TGlmZWN5Y2xlTWV0YURhdGEoKS5zZXRJZ25v\ncmVTeXN0ZW1MaXN0ZW5lcnModHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBleGNsdWRlLXN1cGVyY2xh\nc3MtbGlzdGVuZXJzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3Rh\ncnRFeGNsdWRlU3VwZXJjbGFzc0xpc3RlbmVycyhBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICgh\naXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBj\ndXJyZW50RWxlbWVudCgpOwogICAgICAgIG1ldGEuZ2V0TGlmZWN5Y2xlTWV0\nYURhdGEoKS5zZXRJZ25vcmVTdXBlcmNsYXNzQ2FsbGJhY2tzCiAgICAgICAg\nICAgIChMaWZlY3ljbGVNZXRhRGF0YS5JR05PUkVfSElHSCk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBlbnRp\ndHktbGlzdGVuZXIuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFy\ndEVudGl0eUxpc3RlbmVyKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgX2xpc3RlbmVyID0gY2xhc3NG\nb3JOYW1lKGF0dHJzLmdldFZhbHVlKCJjbGFzcyIpKTsKICAgICAgICBpZiAo\nIV9jb25mLmdldENhbGxiYWNrT3B0aW9uc0luc3RhbmNlKCkuZ2V0QWxsb3dz\nRHVwbGljYXRlTGlzdGVuZXIoKSkgewogICAgICAgICAgICBpZiAoX2xpc3Rl\nbmVycyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2xpc3RlbmVycyA9IG5l\ndyBBcnJheUxpc3Q8Q2xhc3M8Pz4+KCk7CiAgICAgICAgICAgIGlmIChfbGlz\ndGVuZXJzLmNvbnRhaW5zKF9saXN0ZW5lcikpIAogICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgICAgIF9saXN0ZW5lcnMuYWRkKF9saXN0\nZW5lcik7ICAgIAogICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgYm9v\nbGVhbiBzeXN0ZW0gPSBjdXJyZW50RWxlbWVudCgpID09IG51bGw7CiAgICAg\nICAgQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+W10gcGFyc2VkID0K\nICAgICAgICAgICAgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJz\nZXIucGFyc2VDYWxsYmFja01ldGhvZHMoX2xpc3RlbmVyLAogICAgICAgICAg\nICAgICAgbnVsbCwgdHJ1ZSwgdHJ1ZSwgX3JlcG9zKTsKICAgICAgICBpZiAo\ncGFyc2VkID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAg\nICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxsKSB7CiAgICAgICAgICAgIF9j\nYWxsYmFja3MgPSAoQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+W10p\nCiAgICAgICAgICAgICAgICBuZXcgQ29sbGVjdGlvbltMaWZlY3ljbGVFdmVu\ndC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgICAgIGlmICghc3lzdGVt\nKQogICAgICAgICAgICAgICAgX2hpZ2hzID0gbmV3IGludFtMaWZlY3ljbGVF\ndmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgfQogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGlmIChwYXJzZWRbaV0gPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoX2NhbGxiYWNrc1tpXSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tpXSA9IHBhcnNlZFtp\nXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2NhbGxiYWNr\nc1tpXS5hZGRBbGwocGFyc2VkW2ldKTsKICAgICAgICAgICAgaWYgKCFzeXN0\nZW0pCiAgICAgICAgICAgICAgICBfaGlnaHNbaV0gKz0gcGFyc2VkW2ldLnNp\nemUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIGVuZEVudGl0eUxpc3RlbmVyKCkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAvLyBzaG91bGQgYmUgaW4g\nZW5kRW50aXR5TGlzdGVuZXJzIEkgdGhpbmsgdG8gbWVyZ2UgY2FsbGJhY2tz\nCiAgICAgICAgLy8gaW50byBhIHNpbmdsZSBsaXN0ZW5lci4gIEJ1dCB0aGVu\nIHRoZSB1c2VyIGNhbm5vdCByZW1vdmUuCiAgICAgICAgaWYgKGN1cnJlbnRF\nbGVtZW50KCkgPT0gbnVsbCAmJiBfY2FsbGJhY2tzICE9IG51bGwpIHsKICAg\nICAgICAgICAgX3JlcG9zLmFkZFN5c3RlbUxpc3RlbmVyKG5ldyBQZXJzaXN0\nZW5jZUxpc3RlbmVyQWRhcHRlcgogICAgICAgICAgICAgICAgKF9jYWxsYmFj\na3MpKTsKICAgICAgICAgICAgX2NhbGxiYWNrcyA9IG51bGw7CiAgICAgICAg\nfQogICAgICAgIF9saXN0ZW5lciA9IG51bGw7CiAgICB9CgogICAgcHJpdmF0\nZSBib29sZWFuIHN0YXJ0Q2FsbGJhY2soTWV0YURhdGFUYWcgY2FsbGJhY2ss\nIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgaW50W10gZXZlbnRzID0gTWV0YURh\ndGFQYXJzZXJzLmdldEV2ZW50VHlwZXMoY2FsbGJhY2ssIF9jb25mKTsKICAg\nICAgICBpZiAoZXZlbnRzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKCiAgICAgICAgYm9vbGVhbiBzeXN0ZW0gPSBjdXJyZW50RWxlbWVu\ndCgpID09IG51bGw7CgogICAgICAgIC8vIElmIGluIGEgbXVsdGktbGV2ZWwg\ncGFyc2UsIGRvIG5vdCBhZGQgc3lzdGVtIGxldmVsIGxpc3RlbmVycy4KICAg\nICAgICAvLyBPdGhlcndpc2UsIHRoZXkgd2lsbCBnZXQgYWRkZWQgbXVsdGlw\nbGUgdGltZXMuCiAgICAgICAgaWYgKHN5c3RlbSAmJiBfcGFyc2VMaXN0ICE9\nIG51bGwgJiYgX3BhcnNlTGlzdC5zaXplKCkgPiAwKSB7CiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIENsYXNzPD8+IHR5\ncGUgPSBjdXJyZW50RWxlbWVudCgpID09IG51bGwgPyBudWxsIDoKICAgICAg\nICAgICAgKChDbGFzc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpKS5nZXRE\nZXNjcmliZWRUeXBlKCk7CiAgICAgICAgaWYgKHR5cGUgPT0gbnVsbCkKICAg\nICAgICAgICAgdHlwZSA9IE9iamVjdC5jbGFzczsKCiAgICAgICAgaWYgKF9j\nYWxsYmFja3MgPT0gbnVsbCkgewogICAgICAgICAgICBfY2FsbGJhY2tzID0g\nKENvbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJhY2tzPltdKQogICAgICAgICAg\nICAgICAgbmV3IENvbGxlY3Rpb25bTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5U\nUy5sZW5ndGhdOwogICAgICAgICAgICBpZiAoIXN5c3RlbSkKICAgICAgICAg\nICAgICAgIF9oaWdocyA9IG5ldyBpbnRbTGlmZWN5Y2xlRXZlbnQuQUxMX0VW\nRU5UUy5sZW5ndGhdOwogICAgICAgIH0KCiAgICAgICAgTGlmZWN5Y2xlQ2Fs\nbGJhY2tzIGFkYXB0ZXI7CiAgICAgICAgaWYgKF9saXN0ZW5lciAhPSBudWxs\nKQogICAgICAgICAgICBhZGFwdGVyID0gbmV3IEJlYW5MaWZlY3ljbGVDYWxs\nYmFja3MoX2xpc3RlbmVyLAogICAgICAgICAgICAgICAgYXR0cnMuZ2V0VmFs\ndWUoIm1ldGhvZC1uYW1lIiksIGZhbHNlLCB0eXBlKTsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIGFkYXB0ZXIgPSBuZXcgTWV0aG9kTGlmZWN5Y2xlQ2Fs\nbGJhY2tzKF9jbHMsCiAgICAgICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgi\nbWV0aG9kLW5hbWUiKSwgZmFsc2UpOwoKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpbnQg\nZXZlbnQgPSBldmVudHNbaV07CiAgICAgICAgICAgIGlmIChfbGlzdGVuZXIg\nIT0gbnVsbCkgewogICAgICAgICAgICAgICAgTWV0YURhdGFQYXJzZXJzLnZh\nbGlkYXRlTWV0aG9kc0ZvclNhbWVDYWxsYmFjayhfbGlzdGVuZXIsCiAgICAg\nICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tldmVudF0sICgoQmVhbkxpZmVj\neWNsZUNhbGxiYWNrcykgYWRhcHRlcikuCiAgICAgICAgICAgICAgICAgICAg\nZ2V0Q2FsbGJhY2tNZXRob2QoKSwgY2FsbGJhY2ssIF9jb25mLCBnZXRMb2co\nKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBNZXRh\nRGF0YVBhcnNlcnMudmFsaWRhdGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrKF9j\nbHMsCiAgICAgICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tldmVudF0sICgo\nTWV0aG9kTGlmZWN5Y2xlQ2FsbGJhY2tzKSBhZGFwdGVyKS4KICAgICAgICAg\nICAgICAgICAgICBnZXRDYWxsYmFja01ldGhvZCgpLCBjYWxsYmFjaywgX2Nv\nbmYsIGdldExvZygpKTsKCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKF9jYWxsYmFja3NbZXZlbnRdID09IG51bGwpCiAgICAgICAgICAgICAgICBf\nY2FsbGJhY2tzW2V2ZW50XSA9IG5ldyBBcnJheUxpc3Q8TGlmZWN5Y2xlQ2Fs\nbGJhY2tzPigzKTsKICAgICAgICAgICAgX2NhbGxiYWNrc1tldmVudF0uYWRk\nKGFkYXB0ZXIpOwogICAgICAgICAgICBpZiAoIXN5c3RlbSAmJiBfbGlzdGVu\nZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9oaWdoc1tldmVudF0rKzsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTdG9yZSBsaWZlY3ljbGUgbWV0YWRhdGEuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBzdG9yZUNhbGxiYWNrcyhDbGFzc01ldGFEYXRhIGNs\ncykgewogICAgICAgIExpZmVjeWNsZU1ldGFEYXRhIG1ldGEgPSBjbHMuZ2V0\nTGlmZWN5Y2xlTWV0YURhdGEoKTsKICAgICAgICBDbGFzczw/PiBzdXBDbHMg\nPSBjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldFN1cGVyY2xhc3MoKTsKICAg\nICAgICBDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBzdXBDYWxs\ncyA9IG51bGw7CiAgICAgICAgaWYgKCFPYmplY3QuY2xhc3MuZXF1YWxzKHN1\ncENscykpIHsKICAgICAgICAgICAgc3VwQ2FsbHMgPSBBbm5vdGF0aW9uUGVy\nc2lzdGVuY2VNZXRhRGF0YVBhcnNlci5wYXJzZUNhbGxiYWNrTWV0aG9kcwog\nICAgICAgICAgICAgICAgKHN1cENscywgbnVsbCwgdHJ1ZSwgZmFsc2UsIF9y\nZXBvcyk7CiAgICAgICAgfQogICAgICAgIGlmIChzdXBDYWxscyAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGZvciAoaW50IGV2ZW50IDogTGlmZWN5Y2xlRXZl\nbnQuQUxMX0VWRU5UUykgewogICAgICAgICAgICAgICAgaWYgKHN1cENhbGxz\nW2V2ZW50XSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICAgICAgbWV0YS5zZXROb25QQ1N1cGVyY2xhc3NDYWxs\nYmFja3MoZXZlbnQsIHN1cENhbGxzW2V2ZW50XS50b0FycmF5CiAgICAgICAg\nICAgICAgICAgICAgKG5ldyBMaWZlY3ljbGVDYWxsYmFja3Nbc3VwQ2FsbHNb\nZXZlbnRdLnNpemUoKV0pLCAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIGZvciAoaW50IGV2ZW50IDogTGlmZWN5Y2xlRXZl\nbnQuQUxMX0VWRU5UUykgewogICAgICAgICAgICBpZiAoX2NhbGxiYWNrc1tl\ndmVudF0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICBtZXRhLnNldERlY2xhcmVkQ2FsbGJhY2tzKGV2ZW50LCAoTGlm\nZWN5Y2xlQ2FsbGJhY2tzW10pCiAgICAgICAgICAgICAgICBfY2FsbGJhY2tz\nW2V2ZW50XS50b0FycmF5CiAgICAgICAgICAgICAgICAgICAgKG5ldyBMaWZl\nY3ljbGVDYWxsYmFja3NbX2NhbGxiYWNrc1tldmVudF0uc2l6ZSgpXSksCiAg\nICAgICAgICAgICAgICBfaGlnaHNbZXZlbnRdKTsKICAgICAgICB9CiAgICAg\nICAgX2NhbGxiYWNrcyA9IG51bGw7CiAgICAgICAgX2hpZ2hzID0gbnVsbDsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydE9yZGVyQ29sdW1u\nKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBJbnN0YW50aWF0ZSB0aGUgZ2l2ZW4gY2xhc3MsIHRha2luZyBpbnRvIGFj\nY291bnQgdGhlIGRlZmF1bHQgcGFja2FnZS4KCSAqLwoJcHJvdGVjdGVkIENs\nYXNzPD8+IGNsYXNzRm9yTmFtZShTdHJpbmcgbmFtZSkKCQl0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKCQlpZiAoIkVudGl0eSIuZXF1YWxzKG5hbWUpKQoJCQly\nZXR1cm4gUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNzOwoJCXJldHVybiBzdXBl\nci5jbGFzc0Zvck5hbWUobmFtZSwgaXNSdW50aW1lKCkpOwoJfQoKCS8qKgoJ\nICogUHJvY2VzcyBhbGwgZGVmZXJyZWQgZW1iZWRkYWJsZXMgdXNpbmcgYW4g\ndW5rbm93biBhY2Nlc3MgdHlwZS4KCSAqLwoJcHJvdGVjdGVkIHZvaWQgYWRk\nRGVmZXJyZWRFbWJlZGRhYmxlTWV0YURhdGEoKSB7CgkgICAgaWYgKF9lbWJl\nZGRhYmxlcyAhPSBudWxsICYmIF9lbWJlZGRhYmxlcy5zaXplKCkgPiAwKSB7\nCgkgICAgICAgIC8vIFJldmVyc2UgaXRlcmF0ZSB0aGUgYXJyYXkgb2YgcmVt\nYWluaW5nIGRlZmVycmVkIGVtYmVkZGFibGVzCgkgICAgICAgIC8vIHNpbmNl\nIGVsZW1lbnRzIHdpbGwgYmUgcmVtb3ZlZCBhcyB0aGV5IGFyZSBwcm9jZXNz\nZWQuCgkgICAgICAgIENsYXNzPD8+W10gY2xhc3NlcyA9IF9lbWJlZGRhYmxl\ncy5rZXlTZXQoKS50b0FycmF5KAoJICAgICAgICAgICAgbmV3IENsYXNzPD8+\nW19lbWJlZGRhYmxlcy5zaXplKCldKTsKCSAgICAgICAgZm9yIChpbnQgaSA9\nIGNsYXNzZXMubGVuZ3RoIC0gMSA7IGkgPj0gMDsgaS0tKSB7CgkgICAgICAg\nICAgICB0cnkgewoJICAgICAgICAgICAgICAgIEludGVnZXIgYWNjZXNzID0g\nX2VtYmVkZGFibGVBY2Nlc3MuZ2V0KGNsYXNzZXNbaV0pOwoJICAgICAgICAg\nICAgICAgIGlmIChhY2Nlc3MgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAg\nICAgICBhY2Nlc3MgPSBBY2Nlc3NDb2RlLlVOS05PV047CgkgICAgICAgICAg\nICAgICAgfQoJICAgICAgICAgICAgICAgIGFkZERlZmVycmVkRW1iZWRkYWJs\nZU1ldGFEYXRhKGNsYXNzZXNbaV0sCgkgICAgICAgICAgICAgICAgICAgIGFj\nY2Vzcyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURh\ndGFFeGNlcHRpb24oCgkgICAgICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJu\nby1lbWJlZGRhYmxlLW1ldGFkYXRhIiwKCSAgICAgICAgICAgICAgICAgICAg\nICAgIGNsYXNzZXNbaV0uZ2V0TmFtZSgpKSwgZSk7CgkgICAgICAgICAgICB9\nCgkgICAgICAgIH0KCSAgICB9CQoJfQoJCiAgICAvKioKICAgICAqIFByb2Nl\nc3MgYWxsIGRlZmVycmVkIGVtYmVkZGFibGVzIGFuZCBlbWJlZGRhYmxlIG1h\ncHBpbmcgb3ZlcnJpZGVzCiAgICAgKiBmb3IgYSBnaXZlbiBjbGFzcy4gIFRo\naXMgc2hvdWxkIG9ubHkgaGFwcGVuIGFmdGVyIHRoZSBhY2Nlc3MgdHlwZQog\nICAgICogb2YgdGhlIGVtYmVkZGFibGUgaXMga25vd24uCiAgICAgKgogICAg\nICogQHBhcmFtIGVtYmVkVHlwZSBlbWJlZGRhYmxlIGNsYXNzCiAgICAgKiBA\ncGFyYW0gYWNjZXNzIGNsYXNzIGxldmVsIGFjY2VzcyBmb3IgZW1iZWRkYWJs\nZQogICAgICogQHRocm93cyBTQVhFeGNlcHRpb24KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgYWRkRGVmZXJyZWRFbWJlZGRhYmxlTWV0YURhdGEoQ2xh\nc3M8Pz4gZW1iZWRUeXBlLAogICAgICAgIGludCBhY2Nlc3MpIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIEFycmF5TGlzdDxNZXRhRGF0YUNvbnRl\neHQ+IGZtZHMgPSBfZW1iZWRkYWJsZXMuZ2V0KGVtYmVkVHlwZSk7CiAgICAg\nICAgaWYgKGZtZHMgIT0gbnVsbCAmJiBmbWRzLnNpemUoKSA+IDApIHsKICAg\nICAgICAgICAgZm9yIChNZXRhRGF0YUNvbnRleHQgbWQgOiBmbWRzKSB7CiAg\nICAgICAgICAgICAgICBpZiAobWQgaW5zdGFuY2VvZiBGaWVsZE1ldGFEYXRh\nKSB7CiAgICAgICAgICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAo\nRmllbGRNZXRhRGF0YSltZDsKICAgICAgICAgICAgICAgICAgICBmbWQuYWRk\nRW1iZWRkZWRNZXRhRGF0YShhY2Nlc3MpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgZWxzZSBpZiAobWQgaW5zdGFuY2VvZiBWYWx1ZU1l\ndGFEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgVmFsdWVNZXRhRGF0YSB2\nbWQgPSAoVmFsdWVNZXRhRGF0YSltZDsKICAgICAgICAgICAgICAgICAgICB2\nbWQuYWRkRW1iZWRkZWRNZXRhRGF0YShhY2Nlc3MpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFwcGx5RGVmZXJyZWRF\nbWJlZGRhYmxlT3ZlcnJpZGVzKGVtYmVkVHlwZSk7CiAgICAgICAgICAgIC8v\nIENsZWFuIHVwIGRlZmVycmFscyBhZnRlciB0aGV5IGhhdmUgYmVlbiBwcm9j\nZXNzZWQKICAgICAgICAgICAgZm1kcy5jbGVhcigpOwogICAgICAgICAgICBf\nZW1iZWRkYWJsZXMucmVtb3ZlKGVtYmVkVHlwZSk7CiAgICAgICAgfQogICAg\nfQogICAgcHJvdGVjdGVkIHZvaWQgc2V0RGVmZXJyZWRFbWJlZGRhYmxlQWNj\nZXNzVHlwZShDbGFzczw/PiBlbWJlZFR5cGUsCiAgICAgICAgaW50IGFjY2Vz\ncykgewogICAgICAgIF9lbWJlZGRhYmxlQWNjZXNzLnB1dChlbWJlZFR5cGUs\nIGFjY2Vzcyk7CiAgICB9CgogICAgLyoKICAgICAqIENsZWFyIGFueSBkZWZl\ncnJlZCBtZXRhZGF0YQogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3Rl\nY3RlZCB2b2lkIGNsZWFyRGVmZXJyZWRNZXRhRGF0YSgpIHsKICAgICAgICBf\nZW1iZWRkYWJsZXMuY2xlYXIoKTsKICAgICAgICBfZW1iZWRkYWJsZUFjY2Vz\ncy5jbGVhcigpOwogICAgfQoKICAgIC8qCiAgICAgKiBEZXRlcm1pbmVzIHdo\nZXRoZXIgdGhlIGVtYmVkZGFibGUgdHlwZSBpcyBkZWZlcnJlZC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNEZWZlcnJlZEVtYmVkZGFibGUo\nQ2xhc3M8Pz4gZW1iZWRUeXBlLAogICAgICAgIE1ldGFEYXRhQ29udGV4dCBm\nbWQpIHsKICAgICAgICBBcnJheUxpc3Q8TWV0YURhdGFDb250ZXh0PiBmbWRz\nID0gX2VtYmVkZGFibGVzLmdldChlbWJlZFR5cGUpOwogICAgICAgIGlmIChm\nbWRzICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIGZtZHMuY29udGFp\nbnMoZm1kKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIC8qCiAgICAgKiBBZGQgdGhlIGZtZCB0byB0aGUgZGVmZXIgbGlz\ndCBmb3IgZm9yIHRoZSBnaXZlbiBlbWJlZGRhYmxlIHR5cGUKICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgZGVmZXJFbWJlZGRhYmxlKENsYXNzPD8+IGVt\nYmVkVHlwZSwgTWV0YURhdGFDb250ZXh0IGZtZCkgewogICAgICAgIEFycmF5\nTGlzdDxNZXRhRGF0YUNvbnRleHQ+IGZtZHMgPSBfZW1iZWRkYWJsZXMuZ2V0\nKGVtYmVkVHlwZSk7CiAgICAgICAgaWYgKGZtZHMgPT0gbnVsbCkgewogICAg\nICAgICAgICBmbWRzID0gbmV3IEFycmF5TGlzdDxNZXRhRGF0YUNvbnRleHQ+\nKCk7CiAgICAgICAgICAgIF9lbWJlZGRhYmxlcy5wdXQoZW1iZWRUeXBlLCBm\nbWRzKTsKICAgICAgICB9CiAgICAgICAgZm1kcy5hZGQoZm1kKTsKICAgIH0K\nCiAgICAvKgogICAgICogQXBwbHkgYW55IGRlZmVycmVkIG92ZXJyaWRlcy4K\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgYXBwbHlEZWZlcnJlZEVtYmVk\nZGFibGVPdmVycmlkZXMoQ2xhc3M8Pz4gY2xzKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgfQoKCS8qCgkgKiBBZGQgdGhlIGFycmF5IG9m\nIGNsYXNzZXMgdG8gdGhlIGFjdGl2ZSBwYXJzZSBsaXN0LgoJICovCiAgICBw\ndWJsaWMgdm9pZCBhZGRUb1BhcnNlTGlzdChBcnJheUxpc3Q8Q2xhc3M8Pz4+\nIHBhcnNlTGlzdCkgewogICAgICAgIGlmIChwYXJzZUxpc3QgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIF9wYXJzZUxpc3QuYWRkQWxs\nKHBhcnNlTGlzdCk7CiAgICB9CgogICAgLyoKICAgICAqIEFkZCB0aGUgY2xh\nc3MgdG8gdGhlIGFjdGl2ZSBwYXJzZSBsaXN0LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBhZGRUb1BhcnNlTGlzdChDbGFzczw/PiBwYXJlbnRDbHMpIHsK\nICAgICAgICBpZiAocGFyZW50Q2xzID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICBfcGFyc2VMaXN0LmFkZChwYXJlbnRDbHMpOwogICAg\nfQoKICAgIC8qCiAgICAgKiBXaGV0aGVyIHRoZSBhY3RpdmUgcGFyc2UgbGlz\ndCBjb250YWlucyB0aGUgc3BlY2lmaWVkIGNsYXNzLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBwYXJzZUxpc3RDb250YWlucyhDbGFzczw/PiBjbHMp\nIHsKICAgICAgICBpZiAoX3BhcnNlTGlzdC5zaXplKCkgPT0gMCkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBfcGFyc2VMaXN0\nLmNvbnRhaW5zKGNscyk7CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMg\ndGhlIGxpc3Qgb2YgY2xhc3NlcyBhY3RpdmVseSBiZWluZyBwYXJzZWQuCiAg\nICAgKi8KICAgIHB1YmxpYyBBcnJheUxpc3Q8Q2xhc3M8Pz4+IGdldFBhcnNl\nTGlzdCgpIHsKICAgICAgICByZXR1cm4gX3BhcnNlTGlzdDsKICAgIH0KCiAg\nICAvKgogICAgICogUmV0dXJucyBjbGFzcyBjdXJyZW50bHkgYmVpbmcgcGFy\nc2VkLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3M8Pz4gZ2V0UGFyc2VDbGFz\ncygpIHsKICAgICAgICByZXR1cm4gX2NsczsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgYm9vbGVhbiBzdGFydERlbGltaXRlZElkZW50aWZpZXJzKCkgewogICAg\nICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgcHJvdGVjdGVkIFN0\ncmluZyBub3JtYWxpemVTZXF1ZW5jZU5hbWUoU3RyaW5nIHNlcU5hbWUpIHsK\nICAgICAgICByZXR1cm4gc2VxTmFtZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIG5vcm1hbGl6ZVNjaGVtYU5hbWUoU3RyaW5nIHNjaE5hbWUpIHsK\nICAgICAgICByZXR1cm4gc2NoTmFtZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIG5vcm1hbGl6ZUNhdGFsb2dOYW1lKFN0cmluZyBjYXROYW1lKSB7\nCiAgICAgICAgcmV0dXJuIGNhdE5hbWU7CiAgICB9Cn0K\n","encoding":"base64"}

