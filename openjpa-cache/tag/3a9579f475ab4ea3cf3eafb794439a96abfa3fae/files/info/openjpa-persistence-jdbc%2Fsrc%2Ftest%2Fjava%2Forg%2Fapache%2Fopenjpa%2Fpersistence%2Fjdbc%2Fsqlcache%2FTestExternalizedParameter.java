{"sha":"478c5b9a1aed1cc82adca4503beb561d77400b1c","node_id":"MDQ6QmxvYjIwNjM2NDo0NzhjNWI5YTFhZWQxY2M4MmFkY2E0NTAzYmViNTYxZDc3NDAwYjFj","size":4452,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/478c5b9a1aed1cc82adca4503beb561d77400b1c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5z\ncWxjYWNoZTsKCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5Qcm9wZXJ0aWVzOwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVu\ndGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlN\nYW5hZ2VyRmFjdG9yeTsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENh\nc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5TdG9yZVF1\nZXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlF1\nZXJ5RXhwcmVzc2lvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnJvcC5SZXN1bHRMaXN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVuY2U7CgovKioKICogVGVzdHMg\ndGhhdCB3ZSBjYW4gZGV0ZWN0IGlmIGEgcXVlcnkgaXMgdXNpbmcgcXVlcnkg\ncGFyYW1ldGVycyBmb3IgZmllbGRzIHdob3NlIHZhbHVlcyBhcmUgZXh0ZXJu\nYWxpemVkLgogKiAKICogQGF1dGhvciBQaW5ha2kgUG9kZGFyCiAqCiAqLwpw\ndWJsaWMgY2xhc3MgVGVzdEV4dGVybmFsaXplZFBhcmFtZXRlciBleHRlbmRz\nIFRlc3RDYXNlIHsKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBSRVNPVVJD\nRSA9ICJNRVRBLUlORi9wZXJzaXN0ZW5jZS54bWwiOyAKICAgIHByaXZhdGUg\nc3RhdGljIFN0cmluZyBVTklUX05BTUUgPSAiUHJlcGFyZWRRdWVyeSI7CiAg\nICBwcml2YXRlIHN0YXRpYyBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWY7CiAg\nICAKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKGVtZiA9PSBudWxsKSB7CiAgICAgICAgICAgIFByb3Bl\ncnRpZXMgY29uZmlnID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICAgICAg\nY29uZmlnLnB1dCgib3BlbmpwYS5qZGJjLlN5bmNocm9uaXplTWFwcGluZ3Mi\nLCAiYnVpbGRTY2hlbWEoRm9yZWlnbktleXM9dHJ1ZSxTY2hlbWFBY3Rpb249\nJ2Ryb3AsYWRkJykiKTsKICAgICAgICAgICAgY29uZmlnLnB1dCgib3Blbmpw\nYS5qZGJjLlF1ZXJ5U1FMQ2FjaGUiLCAidHJ1ZSIpOwogICAgICAgICAgICBj\nb25maWcucHV0KCJvcGVuanBhLlJ1bnRpbWVVbmVuaGFuY2VkQ2xhc3NlcyIs\nICJ1bnN1cHBvcnRlZCIpOwogICAgICAgICAgICBjb25maWcucHV0KCJvcGVu\nanBhLkR5bmFtaWNFbmhhbmNlbWVudEFnZW50IiwgImZhbHNlIik7CiAgICAg\nICAgICAgIGNvbmZpZy5wdXQoIm9wZW5qcGEuTG9nIiwgIlNRTD1XQVJOIik7\nCiAgICAgICAgICAgIGVtZiA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5jcmVhdGVF\nbnRpdHlNYW5hZ2VyRmFjdG9yeShVTklUX05BTUUsIFJFU09VUkNFLCBjb25m\naWcpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVz\ndE5vRmFsc2VBbGFybU9uRXh0ZXJuYWxpemVkUGFyYW1ldGVyRGV0ZWN0aW9u\nKCkgewogICAgICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBiIGZyb20gQm9v\nayBiIHdoZXJlIGIudGl0bGU9OnRpdGxlIjsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBR\ndWVyeUV4cHJlc3Npb25zW10gZXhwcyA9IGdldEV4cHJlc3Npb25zKGVtLmNy\nZWF0ZVF1ZXJ5KGpwcWwpCiAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVy\nKCJ0aXRsZSIsIlhZWiIpCiAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlz\ndCgpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGV4cHMpOwogICAgICAgIAog\nICAgICAgIGFzc2VydEZhbHNlKGlzVXNpbmdFeHRlcm5hbGl6ZWRQYXJhbWV0\nZXIoZXhwc1swXSkpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nQ2FuRGV0ZWN0RXh0ZXJuYWxpemVkU2luZ2xlUGFyYW1ldGVyVmFsdWUoKSB7\nCiAgICAgICAgU3RyaW5nIGpwcWwgPSAic2VsZWN0IGIgZnJvbSBCb29rIGIg\nd2hlcmUgYi50b2tlbj06dG9rZW4iOwogICAgICAgIEVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIFF1ZXJ5\nRXhwcmVzc2lvbnNbXSBleHBzID0gZ2V0RXhwcmVzc2lvbnMoZW0uY3JlYXRl\nUXVlcnkoanBxbCkKICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoInRv\na2VuIiwiTUVESVVNIikKICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRMaXN0\nKCkpOwogICAgICAgIGFzc2VydE5vdE51bGwoZXhwcyk7CiAgICAgICAgCiAg\nICAgICAgYXNzZXJ0VHJ1ZShpc1VzaW5nRXh0ZXJuYWxpemVkUGFyYW1ldGVy\nKGV4cHNbMF0pKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdENh\nbkRldGVjdEV4dGVybmFsaXplZE1peGVkUGFyYW1ldGVyVmFsdWUoKSB7CiAg\nICAgICAgU3RyaW5nIGpwcWwgPSAic2VsZWN0IGIgZnJvbSBCb29rIGIgd2hl\ncmUgYi50b2tlbj06dG9rZW4gYW5kIGIudGl0bGUgPSA6dGl0bGUiOwogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNbXSBleHBzID0gZ2V0RXhw\ncmVzc2lvbnMoZW0uY3JlYXRlUXVlcnkoanBxbCkKICAgICAgICAgICAgICAg\nIC5zZXRQYXJhbWV0ZXIoInRva2VuIiwiTUVESVVNIikKICAgICAgICAgICAg\nICAgIC5zZXRQYXJhbWV0ZXIoInRva2VuIiwgIkxBUkdFIikKICAgICAgICAg\nICAgICAgIC5nZXRSZXN1bHRMaXN0KCkpOwogICAgICAgIGFzc2VydE5vdE51\nbGwoZXhwcyk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0VHJ1ZShpc1VzaW5n\nRXh0ZXJuYWxpemVkUGFyYW1ldGVyKGV4cHNbMF0pKTsKICAgIH0KICAgIAog\nICAgcHVibGljIFF1ZXJ5RXhwcmVzc2lvbnNbXSBnZXRFeHByZXNzaW9ucyhM\naXN0PD8+IHJlc3VsdCkgewogICAgICAgIE9iamVjdCB1c2VyT2JqZWN0ID0g\nKChSZXN1bHRMaXN0PD8+KXJlc3VsdCkuZ2V0VXNlck9iamVjdCgpOwogICAg\nICAgIGlmICh1c2VyT2JqZWN0ID09IG51bGwgfHwgIXVzZXJPYmplY3QuZ2V0\nQ2xhc3MoKS5pc0FycmF5KCkgfHwgKChPYmplY3RbXSl1c2VyT2JqZWN0KS5s\nZW5ndGggIT0gMikKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\nT2JqZWN0IGV4ZWN1dG9yID0gKChPYmplY3RbXSl1c2VyT2JqZWN0KVsxXTsK\nICAgICAgICBpZiAoZXhlY3V0b3IgaW5zdGFuY2VvZiBTdG9yZVF1ZXJ5LkV4\nZWN1dG9yID09IGZhbHNlKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICByZXR1cm4gKChTdG9yZVF1ZXJ5LkV4ZWN1dG9yKWV4ZWN1dG9yKS5n\nZXRRdWVyeUV4cHJlc3Npb25zKCk7CiAgICB9CiAgICAKICAgIGJvb2xlYW4g\naXNVc2luZ0V4dGVybmFsaXplZFBhcmFtZXRlcihRdWVyeUV4cHJlc3Npb25z\nIGV4cCkgewogICAgICAgIExpc3Q8RmllbGRNZXRhRGF0YT4gZm1kcyA9IGV4\ncC5nZXRQYXJhbWV0ZXJpemVkRmllbGRzKCk7CiAgICAgICAgZm9yIChGaWVs\nZE1ldGFEYXRhIGZtZCA6IGZtZHMpIHsKICAgICAgICAgICAgaWYgKGZtZC5p\nc0V4dGVybmFsaXplZCgpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCn0K\n","encoding":"base64"}

