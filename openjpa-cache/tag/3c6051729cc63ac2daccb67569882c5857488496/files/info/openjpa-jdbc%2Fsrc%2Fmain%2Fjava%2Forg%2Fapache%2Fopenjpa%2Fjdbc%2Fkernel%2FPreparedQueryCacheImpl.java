{"sha":"8799e63f9498e3fe879b316e77cc296bdb38f16c","node_id":"MDQ6QmxvYjIwNjM2NDo4Nzk5ZTYzZjk0OThlM2ZlODc5YjMxNmU3N2NjMjk2YmRiMzhmMTZj","size":12880,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8799e63f9498e3fe879b316e77cc296bdb38f16c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQg\namF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuVHJlZU1hcDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmxvY2tzLlJlZW50cmFudExv\nY2s7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRp\nbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5Q2FjaGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5RdWVyeUhpbnRzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5RdWVyeUxhbmd1YWdlczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuUXVlcnlTdGF0aXN0aWNzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuQ2FjaGVNYXA7CgovKioKICogQW4gaW1w\nbGVtZW50YXRpb24gb2YgdGhlIGNhY2hlIG9mIHtAbGluayBQcmVwYXJlZFF1\nZXJ5IHByZXBhcmVkIHF1ZXJpZXN9LiAKICogCiAqIEBhdXRob3IgUGluYWtp\nIFBvZGRhcgogKgogKiBAc2luY2UgMi4wLjAKICogCiAqIEBub2phdmFkb2MK\nICovCnB1YmxpYyBjbGFzcyBQcmVwYXJlZFF1ZXJ5Q2FjaGVJbXBsIGltcGxl\nbWVudHMgUHJlcGFyZWRRdWVyeUNhY2hlIHsKCXByaXZhdGUgc3RhdGljIGZp\nbmFsIFN0cmluZyBQQVRURVJOX1NFUEFSQVRPUiA9ICJcXDsiOwoJLy8gS2V5\nOiBRdWVyeSBpZGVudGlmaWVyIAoJcHJpdmF0ZSBmaW5hbCBNYXA8U3RyaW5n\nLCBQcmVwYXJlZFF1ZXJ5PiBfZGVsZWdhdGU7CgkvLyBLZXk6IFF1ZXJ5IGlk\nZW50aWZpZXIgVmFsdWU6IFJlYXNvbiB3aHkgZXhjbHVkZWQKCXByaXZhdGUg\nZmluYWwgTWFwPFN0cmluZywgRXhjbHVzaW9uPiBfdW5jYWNoYWJsZXM7Cglw\ncml2YXRlIGZpbmFsIExpc3Q8RXhjbHVzaW9uPiBfZXhjbHVzaW9uUGF0dGVy\nbnM7Cglwcml2YXRlIFF1ZXJ5U3RhdGlzdGljczxTdHJpbmc+IF9zdGF0czsK\nCXByaXZhdGUgYm9vbGVhbiBfc3RhdHNFbmFibGVkOwoJcHJpdmF0ZSBSZWVu\ndHJhbnRMb2NrIF9sb2NrID0gbmV3IFJlZW50cmFudExvY2soKTsKCXByaXZh\ndGUgTG9nIF9sb2c7CiAgICBwcml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIgX2xv\nYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKFByZXBhcmVkUXVlcnlDYWNoZUlt\ncGwuY2xhc3MpOwogICAgCglwdWJsaWMgUHJlcGFyZWRRdWVyeUNhY2hlSW1w\nbCgpIHsKCQlfZGVsZWdhdGUgPSBuZXcgQ2FjaGVNYXAoKTsKCQlfdW5jYWNo\nYWJsZXMgPSBuZXcgQ2FjaGVNYXAoKTsKCQlfZXhjbHVzaW9uUGF0dGVybnMg\nPSBuZXcgQXJyYXlMaXN0PEV4Y2x1c2lvbj4oKTsKCX0KCQogICAgcHVibGlj\nIEJvb2xlYW4gcmVnaXN0ZXIoU3RyaW5nIGlkLCBRdWVyeSBxdWVyeSwgRmV0\nY2hDb25maWd1cmF0aW9uIGhpbnRzKSB7CiAgICAgICAgaWYgKGlkID09IG51\nbGwgCiAgICAgICAgICAgIHx8IHF1ZXJ5ID09IG51bGwgCiAgICAgICAgICAg\nIHx8IFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLmVxdWFscyhxdWVyeS5nZXRM\nYW5ndWFnZSgpKSAKICAgICAgICAgICAgfHwgUXVlcnlMYW5ndWFnZXMuTEFO\nR19NRVRIT0RRTC5lcXVhbHMocXVlcnkuZ2V0TGFuZ3VhZ2UoKSkKICAgICAg\nICAgICAgfHwgaXNIaW50ZWQoaGludHMsIFF1ZXJ5SGludHMuSElOVF9JR05P\nUkVfUFJFUEFSRURfUVVFUlkpCiAgICAgICAgICAgIHx8IGlzSGludGVkKGhp\nbnRzLCBRdWVyeUhpbnRzLkhJTlRfSU5WQUxJREFURV9QUkVQQVJFRF9RVUVS\nWSkpCiAgICAgICAgICAgIHJldHVybiBCb29sZWFuLkZBTFNFOwogICAgICAg\nIGlmIChpc0NhY2hhYmxlKGlkKSA9PSBCb29sZWFuLkZBTFNFKQogICAgICAg\nICAgICByZXR1cm4gQm9vbGVhbi5GQUxTRTsKICAgICAgICBQcmVwYXJlZFF1\nZXJ5IGNhY2hlZCA9IGdldChpZCk7CiAgICAgICAgaWYgKGNhY2hlZCAhPSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gaW1wbGllcyB0aGF0\nIGl0IGlzIGFscmVhZHkgY2FjaGVkCiAgICAgICAgCiAgICAgICAgUHJlcGFy\nZWRRdWVyeSBuZXdFbnRyeSA9IG5ldyBQcmVwYXJlZFF1ZXJ5SW1wbChpZCwg\ncXVlcnkpOyAKICAgICAgICByZXR1cm4gY2FjaGUobmV3RW50cnkpOwoJfQoJ\nCglwdWJsaWMgTWFwPFN0cmluZyxTdHJpbmc+IGdldE1hcFZpZXcoKSB7CgkJ\nbG9jaygpOwoJCXRyeSB7CiAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmlu\nZz4gdmlldyA9IG5ldyBUcmVlTWFwPFN0cmluZywgU3RyaW5nPigpOwogICAg\nICAgICAgICBmb3IgKE1hcC5FbnRyeTxTdHJpbmcsIFByZXBhcmVkUXVlcnk+\nIGVudHJ5IDogX2RlbGVnYXRlLmVudHJ5U2V0KCkpCiAgICAgICAgICAgICAg\nICB2aWV3LnB1dChlbnRyeS5nZXRLZXkoKSwgZW50cnkuZ2V0VmFsdWUoKS5n\nZXRUYXJnZXRRdWVyeSgpKTsKCQkJcmV0dXJuIHZpZXc7CgkJfSBmaW5hbGx5\nIHsKCQkJdW5sb2NrKCk7CgkJfQoJfQoJCgkvKioKCSAqIENhY2hlIHRoZSBn\naXZlbiBxdWVyeSBrZXllZCBieSBpdHMgaWRlbnRpZmllci4gRG9lcyBub3Qg\nY2FjaGUgaWYgdGhlIAoJICogaWRlbnRpZmllciBtYXRjaGVzIGFueSBleGNs\ndXNpb24gcGF0dGVybiBvciBoYXMgYmVlbiBtYXJrZWQgYXMgCgkgKiBub24t\nY2FjaGFibGUuIEFsc28gcmVnaXN0ZXIgdGhlIGlkZW50aWZpZXIgYXMgbm90\nIGNhY2hhYmxlIGFnYWluc3QgCgkgKiB0aGUgbWF0Y2hlZCBleGNsdXNpb24g\ncGF0dGVybi4KCSAqLwoJcHVibGljIGJvb2xlYW4gY2FjaGUoUHJlcGFyZWRR\ndWVyeSBxKSB7CgkJbG9jaygpOwoJCXRyeSB7CgkJCVN0cmluZyBpZCA9IHEu\nZ2V0SWRlbnRpZmllcigpOwoJCQlpZiAoaXNDYWNoYWJsZShpZCkgPT0gQm9v\nbGVhbi5GQUxTRSkgewoJCQkJaWYgKF9sb2cgIT0gbnVsbCAmJiBfbG9nLmlz\nVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZy50cmFj\nZShfbG9jLmdldCgicHJlcGFyZWQtcXVlcnktbm90LWNhY2hhYmxlIiwgaWQp\nKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQlFeGNsdXNpb24gZXhjbHVz\naW9uID0gZ2V0TWF0Y2hlZEV4Y2x1c2lvblBhdHRlcm4oaWQpOwoJCQlpZiAo\nZXhjbHVzaW9uICE9IG51bGwpIHsKCQkJCW1hcmtVbmNhY2hhYmxlKGlkLCBl\neGNsdXNpb24pOwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCV9kZWxlZ2F0\nZS5wdXQoaWQsIHEpOwogICAgICAgICAgICBpZiAoX2xvZyAhPSBudWxsICYm\nIF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIF9sb2cu\ndHJhY2UoX2xvYy5nZXQoInByZXBhcmVkLXF1ZXJ5LWNhY2hlZCIsIGlkKSk7\nCgkJCXJldHVybiB0cnVlOwoJCX0gZmluYWxseSB7CgkJCXVubG9jaygpOwoJ\nCX0KCX0KCQogICAgcHVibGljIFByZXBhcmVkUXVlcnkgaW5pdGlhbGl6ZShT\ndHJpbmcga2V5LCBPYmplY3QgcmVzdWx0KSB7CiAgICAgICAgUHJlcGFyZWRR\ndWVyeSBwcSA9IGdldChrZXkpOwogICAgICAgIGlmIChwcSA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAKICAgICAgICBFeGNs\ndXNpb24gZXhjbHVzaW9uID0gcHEuaW5pdGlhbGl6ZShyZXN1bHQpOwogICAg\nICAgIGlmIChleGNsdXNpb24gIT0gbnVsbCkgewogICAgICAgICAgICBtYXJr\nVW5jYWNoYWJsZShrZXksIGV4Y2x1c2lvbik7CiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIH0gCiAgICAgICAgcmV0dXJuIHBxOwogICAgfQoJ\nCglwdWJsaWMgYm9vbGVhbiBpbnZhbGlkYXRlKFN0cmluZyBpZCkgewoJCWxv\nY2soKTsKCQl0cnkgewoJCQlpZiAoX2xvZyAhPSBudWxsICYmIF9sb2cuaXNU\ncmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIF9sb2cudHJhY2UoX2xv\nYy5nZXQoInByZXBhcmVkLXF1ZXJ5LWludmFsaWRhdGUiLCBpZCkpOwoJCQly\nZXR1cm4gX2RlbGVnYXRlLnJlbW92ZShpZCkgIT0gbnVsbDsKCQl9IGZpbmFs\nbHkgewoJCQl1bmxvY2soKTsKCQl9Cgl9CgkKICAgIHB1YmxpYyBQcmVwYXJl\nZFF1ZXJ5IGdldChTdHJpbmcgaWQpIHsKICAgICAgICBsb2NrKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIF9kZWxlZ2F0ZS5nZXQoaWQp\nOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwog\nICAgICAgIH0KICAgIH0KICAgIAoJcHVibGljIEJvb2xlYW4gaXNDYWNoYWJs\nZShTdHJpbmcgaWQpIHsKCQlsb2NrKCk7CgkJdHJ5IHsKCQkJaWYgKF91bmNh\nY2hhYmxlcy5jb250YWluc0tleShpZCkpCgkJCQlyZXR1cm4gQm9vbGVhbi5G\nQUxTRTsKCQkJaWYgKF9kZWxlZ2F0ZS5jb250YWluc0tleShpZCkpCgkJCQly\nZXR1cm4gQm9vbGVhbi5UUlVFOwoJCQlyZXR1cm4gbnVsbDsKCQl9IGZpbmFs\nbHkgewoJCQl1bmxvY2soKTsKCQl9Cgl9CgkKCXB1YmxpYyBQcmVwYXJlZFF1\nZXJ5IG1hcmtVbmNhY2hhYmxlKFN0cmluZyBpZCwgRXhjbHVzaW9uIGV4Y2x1\nc2lvbikgewoJCWxvY2soKTsKCQl0cnkgewoJCQlpZiAoX3VuY2FjaGFibGVz\nLnB1dChpZCwgZXhjbHVzaW9uKSA9PSBudWxsKSB7CgkJCSAgICBpZiAoX2xv\nZyAhPSBudWxsICYmIF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkgCgkJCSAgICAg\nICAgX2xvZy50cmFjZShfbG9jLmdldCgicHJlcGFyZWQtcXVlcnktdW5jYWNo\nZSIsIGlkLCBleGNsdXNpb24pKTsKCQkJfQoJCQlyZXR1cm4gX2RlbGVnYXRl\nLnJlbW92ZShpZCk7CgkJfSBmaW5hbGx5IHsKCQkJdW5sb2NrKCk7CgkJfQoJ\nfQoJCglwdWJsaWMgRXhjbHVzaW9uIGlzRXhjbHVkZWQoU3RyaW5nIGlkKSB7\nCgkJcmV0dXJuIGdldE1hdGNoZWRFeGNsdXNpb25QYXR0ZXJuKGlkKTsKCX0K\nCQoJcHVibGljIHZvaWQgc2V0RXhjbHVkZXMoU3RyaW5nIGV4Y2x1ZGVzKSB7\nCgkJbG9jaygpOwoJCXRyeSB7CgkJCWlmIChTdHJpbmdVdGlscy5pc0VtcHR5\nKGV4Y2x1ZGVzKSkKCQkJCXJldHVybjsKCQkJU3RyaW5nW10gcGF0dGVybnMg\nPSBleGNsdWRlcy5zcGxpdChQQVRURVJOX1NFUEFSQVRPUik7CgkJCWZvciAo\nU3RyaW5nIHBhdHRlcm4gOiBwYXR0ZXJucykKCQkJCWFkZEV4Y2x1c2lvblBh\ndHRlcm4ocGF0dGVybik7CgkJfSBmaW5hbGx5IHsKCQkJdW5sb2NrKCk7CgkJ\nfQoJfQoKCXB1YmxpYyBMaXN0PEV4Y2x1c2lvbj4gZ2V0RXhjbHVkZXMoKSB7\nCgkJcmV0dXJuIENvbGxlY3Rpb25zLnVubW9kaWZpYWJsZUxpc3QoX2V4Y2x1\nc2lvblBhdHRlcm5zKTsKCX0KCQoJLyoqCiAgICAgKiBBZGRzIGEgcGF0dGVy\nbiBmb3IgZXhjbHVzaW9uLiBBbnkgcXVlcnkgY2FjaGVkIGN1cnJlbnRseSB3\naG9zZSBpZGVudGlmaWVyCiAgICAgKiBtYXRjaGVzIHRoZSBnaXZlbiBwYXR0\nZXJuIHdpbGwgYmUgbWFya2VkIGludmFsaWRhdGVkIGFzIGEgc2lkZS1lZmZl\nY3QuCgkgKi8KCXB1YmxpYyB2b2lkIGFkZEV4Y2x1c2lvblBhdHRlcm4oU3Ry\naW5nIHBhdHRlcm4pIHsKCQlsb2NrKCk7CgkJdHJ5IHsKCQkgICAgU3RyaW5n\nIHJlYXNvbiA9IF9sb2MuZ2V0KCJwcmVwYXJlZC1xdWVyeS1leGNsdWRlZC1i\neS11c2VyIiwgcGF0dGVybikuZ2V0TWVzc2FnZSgpOwoJCQlFeGNsdXNpb24g\nZXhjbHVzaW9uID0gbmV3IFdlYWtFeGNsdXNpb24ocGF0dGVybiwgcmVhc29u\nKTsKCQkJX2V4Y2x1c2lvblBhdHRlcm5zLmFkZChleGNsdXNpb24pOwogICAg\nICAgICAgICBDb2xsZWN0aW9uPFN0cmluZz4gaW52YWxpZEtleXMgPSBnZXRN\nYXRjaGVkS2V5cyhwYXR0ZXJuLCBfZGVsZWdhdGUua2V5U2V0KCkpOwoJCQlm\nb3IgKFN0cmluZyBpbnZhbGlkS2V5IDogaW52YWxpZEtleXMpIHsKCQkJICAg\nIEV4Y2x1c2lvbiBpbnZhbGlkID0gbmV3IFdlYWtFeGNsdXNpb24oaW52YWxp\nZEtleSwgcmVhc29uKTsKCQkJCW1hcmtVbmNhY2hhYmxlKGludmFsaWRLZXks\nIGludmFsaWQpOwoJCQl9CgkJfSBmaW5hbGx5IHsKCQkJdW5sb2NrKCk7CgkJ\nfQoJfQoJCgkvKioKCSAqIFJlbW92ZXMgYSBwYXR0ZXJuIGZvciBleGNsdXNp\nb24uIEFueSBxdWVyeSBpZGVudGlmaWVyIG1hcmtlZCBhcyBub3QgCiAgICAg\nKiBjYWNoYWJsZSBkdWUgdG8gdGhlIGdpdmVuIHBhdHRlcm4gd2lsbCBub3cg\nYmUgcmVtb3ZlZCBmcm9tIHRoZSBsaXN0IG9mCgkgKiB1bmNhY2hhYmxlcyBh\ncyBhIHNpZGUtZWZmZWN0LgoJICovCglwdWJsaWMgdm9pZCByZW1vdmVFeGNs\ndXNpb25QYXR0ZXJuKFN0cmluZyBwYXR0ZXJuKSB7CgkJbG9jaygpOwoJCXRy\neSB7CiAgICAgICAgICAgIEV4Y2x1c2lvbiBleGNsdXNpb24gPSBuZXcgV2Vh\na0V4Y2x1c2lvbihwYXR0ZXJuLCBudWxsKTsKCQkJX2V4Y2x1c2lvblBhdHRl\ncm5zLnJlbW92ZShleGNsdXNpb24pOwogICAgICAgICAgICBDb2xsZWN0aW9u\nPFN0cmluZz4gcmVib3JucyA9IGdldE1hdGNoZWRLZXlzKHBhdHRlcm4sIF91\nbmNhY2hhYmxlcyk7CgkJCWZvciAoU3RyaW5nIHJlYm9ybktleSA6IHJlYm9y\nbnMpIHsKICAgICAgICAgICAgICAgIF91bmNhY2hhYmxlcy5yZW1vdmUocmVi\nb3JuS2V5KTsKCSAgICAgICAgICAgIGlmIChfbG9nICE9IG51bGwgJiYgX2xv\nZy5pc1RyYWNlRW5hYmxlZCgpKQoJICAgICAgICAgICAgICAgIF9sb2cudHJh\nY2UoX2xvYy5nZXQoInByZXBhcmVkLXF1ZXJ5LXJlbW92ZS1wYXR0ZXJuIiwg\ncGF0dGVybiwgcmVib3JuS2V5KSk7CgkJCX0KCQl9IGZpbmFsbHkgewoJCQl1\nbmxvY2soKTsKCQl9Cgl9CgkKCXB1YmxpYyBRdWVyeVN0YXRpc3RpY3M8U3Ry\naW5nPiBnZXRTdGF0aXN0aWNzKCkgewoJCXJldHVybiBfc3RhdHM7Cgl9CgkK\nCS8qKgoJICogR2V0cyB0aGUgcGF0dGVybiB0aGF0IG1hdGNoZXMgdGhlIGdp\ndmVuIGlkZW50aWZpZXIuCgkgKi8KCXByaXZhdGUgRXhjbHVzaW9uIGdldE1h\ndGNoZWRFeGNsdXNpb25QYXR0ZXJuKFN0cmluZyBpZCkgewoJCWZvciAoRXhj\nbHVzaW9uIHBhdHRlcm4gOiBfZXhjbHVzaW9uUGF0dGVybnMpCgkJCWlmIChw\nYXR0ZXJuLm1hdGNoZXMoaWQpKQoJCQkJcmV0dXJuIHBhdHRlcm47CgkJcmV0\ndXJuIG51bGw7Cgl9CgkKCS8qKgoJICogR2V0cyB0aGUga2V5cyBvZiB0aGUg\nZ2l2ZW4gbWFwIHdob3NlIHZhbHVlcyBtYXRjaCB0aGUgZ2l2ZW4gcGF0dGVy\nbi4gCgkgKi8KCXByaXZhdGUgQ29sbGVjdGlvbjxTdHJpbmc+IGdldE1hdGNo\nZWRLZXlzKFN0cmluZyBwYXR0ZXJuLCBNYXA8U3RyaW5nLEV4Y2x1c2lvbj4g\nbWFwKSB7CiAgICAgICAgTGlzdDxTdHJpbmc+IHJlc3VsdCA9IG5ldyBBcnJh\neUxpc3Q8U3RyaW5nPigpOwoJCWZvciAoTWFwLkVudHJ5PFN0cmluZywgRXhj\nbHVzaW9uPiBlbnRyeSA6IG1hcC5lbnRyeVNldCgpKSB7CgkJICAgIEV4Y2x1\nc2lvbiBleGNsdXNpb24gPSBlbnRyeS5nZXRWYWx1ZSgpOwoJCQlpZiAoIWV4\nY2x1c2lvbi5pc1N0cm9uZygpICYmIGV4Y2x1c2lvbi5tYXRjaGVzKHBhdHRl\ncm4pKSB7CgkJCQlyZXN1bHQuYWRkKGVudHJ5LmdldEtleSgpKTsKCQkJfQoJ\nCX0KCQlyZXR1cm4gcmVzdWx0OwoJfQoJCgkvKioKCSAqIEdldHMgdGhlIGVs\nZW1lbnRzIG9mIHRoZSBnaXZlbiBsaXN0IHdoaWNoIG1hdGNoIHRoZSBnaXZl\nbiBwYXR0ZXJuLiAKCSAqLwoJcHJpdmF0ZSBDb2xsZWN0aW9uPFN0cmluZz4g\nZ2V0TWF0Y2hlZEtleXMoU3RyaW5nIHBhdHRlcm4sIENvbGxlY3Rpb248U3Ry\naW5nPiBjb2xsKSB7CgkJTGlzdDxTdHJpbmc+IHJlc3VsdCA9IG5ldyBBcnJh\neUxpc3Q8U3RyaW5nPigpOwoJCWZvciAoU3RyaW5nIGtleSA6IGNvbGwpIHsK\nCQkJaWYgKG1hdGNoZXMocGF0dGVybiwga2V5KSkgewoJCQkJcmVzdWx0LmFk\nZChrZXkpOwoJCQl9CgkJfQoJCXJldHVybiByZXN1bHQ7Cgl9CgogICAgdm9p\nZCBsb2NrKCkgewogICAgICAgIGlmIChfbG9jayAhPSBudWxsKQogICAgICAg\nICAgICBfbG9jay5sb2NrKCk7CiAgICB9CgogICAgdm9pZCB1bmxvY2soKSB7\nCiAgICAgICAgaWYgKF9sb2NrICE9IG51bGwgJiYgX2xvY2suaXNMb2NrZWQo\nKSkKICAgICAgICAgICAgX2xvY2sudW5sb2NrKCk7CiAgICB9CiAgICAKICAg\nIGJvb2xlYW4gbWF0Y2hlcyhTdHJpbmcgcGF0dGVybiwgU3RyaW5nIHRhcmdl\ndCkgewogICAgCXJldHVybiB0YXJnZXQgIT0gbnVsbCAmJiAodGFyZ2V0LmVx\ndWFscyhwYXR0ZXJuKSAKICAgIAkgIHx8IHRhcmdldC5tYXRjaGVzKHBhdHRl\ncm4pKTsKICAgIH0KICAgIAogICAgYm9vbGVhbiBpc0hpbnRlZChGZXRjaENv\nbmZpZ3VyYXRpb24gZmV0Y2gsIFN0cmluZyBoaW50KSB7CiAgICAgICAgaWYg\nKGZldGNoID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICBPYmplY3QgcmVzdWx0ID0gZmV0Y2guZ2V0SGludChoaW50KTsKICAg\nICAgICByZXR1cm4gcmVzdWx0ICE9IG51bGwgJiYgInRydWUiLmVxdWFsc0ln\nbm9yZUNhc2UocmVzdWx0LnRvU3RyaW5nKCkpOwogICAgfQogICAgCiAgICBw\ndWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBfZGVsZWdhdGUuY2xlYXIo\nKTsKICAgICAgICBfc3RhdHMuY2xlYXIoKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgc2V0RW5hYmxlU3RhdGlzdGljcyhib29sZWFuIGVuYWJsZSl7\nCiAgICAgICAgX3N0YXRzRW5hYmxlZCA9IGVuYWJsZTsKICAgIH0KICAgIAog\nICAgcHVibGljIGJvb2xlYW4gZ2V0RW5hYmxlU3RhdGlzdGljcygpewogICAg\nICAgIHJldHVybiBfc3RhdHNFbmFibGVkOwogICAgfQogICAgICAgIAoJLy8t\nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t\nLS0tLS0tLS0tCgkvLyBDb25maWd1cmFibGUgY29udHJhY3QKCS8vLS0tLS0t\nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t\nLS0tLQogICAgcHVibGljIHZvaWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1\ncmF0aW9uIGNvbmYpIHsKICAgIAlfbG9nID0gY29uZi5nZXRMb2coT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkgewogICAgICAgIF9zdGF0cyA9\nIF9zdGF0c0VuYWJsZWQgPyBuZXcgUXVlcnlTdGF0aXN0aWNzLkRlZmF1bHQ8\nU3RyaW5nPigpIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nbmV3IFF1ZXJ5U3RhdGlzdGljcy5Ob25lPFN0cmluZz4oKTsKICAgIH0KICAg\nIAogICAgLyoqCiAgICAgKiBBbiBpbW11dGFibGUgYWJzdHJhY3QgcGF0dGVy\nbiBmb3IgZXhjbHVzaW9uLgogICAgICoKICAgICAqLwogICAgcHJpdmF0ZSBz\ndGF0aWMgYWJzdHJhY3QgY2xhc3MgRXhjbHVzaW9uUGF0dGVybiBpbXBsZW1l\nbnRzIFByZXBhcmVkUXVlcnlDYWNoZS5FeGNsdXNpb24gewogICAgICAgIHBy\naXZhdGUgZmluYWwgYm9vbGVhbiBfc3Ryb25nOwogICAgICAgIHByaXZhdGUg\nZmluYWwgU3RyaW5nICBfcGF0dGVybjsKICAgICAgICBwcml2YXRlIGZpbmFs\nIFN0cmluZyAgX3JlYXNvbjsKICAgICAgICAKICAgICAgICBwcml2YXRlIHN0\nYXRpYyBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKFBy\nZXBhcmVkUXVlcnlDYWNoZUltcGwuY2xhc3MpOwogICAgICAgIHByaXZhdGUg\nc3RhdGljIFN0cmluZyBTVFJPTkcgPSBfbG9jLmdldCgic3Ryb25nLWV4Y2x1\nc2lvbiIpLmdldE1lc3NhZ2UoKTsKICAgICAgICBwcml2YXRlIHN0YXRpYyBT\ndHJpbmcgV0VBSyAgID0gX2xvYy5nZXQoIndlYWstZXhjbHVzaW9uIikuZ2V0\nTWVzc2FnZSgpOwogICAgICAgIAogICAgICAgIHB1YmxpYyBFeGNsdXNpb25Q\nYXR0ZXJuKGJvb2xlYW4gc3Ryb25nLCBTdHJpbmcgcGF0dGVybiwgU3RyaW5n\nIHJlYXNvbikgewogICAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgICB0\naGlzLl9zdHJvbmcgPSBzdHJvbmc7CiAgICAgICAgICAgIHRoaXMuX3BhdHRl\ncm4gPSBwYXR0ZXJuOwogICAgICAgICAgICB0aGlzLl9yZWFzb24gPSByZWFz\nb247CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdldFBhdHRl\ncm4oKSB7CiAgICAgICAgICAgIHJldHVybiBfcGF0dGVybjsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBTdHJpbmcgZ2V0UmVhc29uKCkgewogICAgICAg\nICAgICByZXR1cm4gX3JlYXNvbjsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIGlzU3Ryb25nKCkgewogICAgICAgICAgICByZXR1cm4gX3N0\ncm9uZzsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIG1hdGNo\nZXMoU3RyaW5nIGlkKSB7CiAgICAgICAgICAgIHJldHVybiBfcGF0dGVybiAh\nPSBudWxsICYmIChfcGF0dGVybi5lcXVhbHMoaWQpIHx8IF9wYXR0ZXJuLm1h\ndGNoZXMoaWQpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyoqCiAg\nICAgICAgICogRXF1YWxzIGJ5IHN0cmVuZ3RoIGFuZCBwYXR0ZXJuIChub3Qg\nYnkgcmVhc29uKS4KICAgICAgICAgKi8KICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVy\nKSB7CiAgICAgICAgICAgIGlmIChvdGhlciA9PSB0aGlzKQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmICghKG90aGVyIGlu\nc3RhbmNlb2YgRXhjbHVzaW9uKSkKICAgICAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICAgICAgRXhjbHVzaW9uIHRoYXQgPSAoRXhjbHVzaW9u\nKW90aGVyOwogICAgICAgICAgICByZXR1cm4gdGhpcy5fc3Ryb25nID09IHRo\nYXQuaXNTdHJvbmcoKSAKICAgICAgICAgICAgICAgICYmIFN0cmluZ1V0aWxz\nLmVxdWFscyh0aGlzLl9wYXR0ZXJuLCB0aGF0LmdldFBhdHRlcm4oKSk7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAgICAgIHJldHVybiAoX3N0\ncm9uZyA/IDEgOiAwKSAKICAgICAgICAgICAgICAgICArIChfcGF0dGVybiA9\nPSBudWxsID8gMCA6IF9wYXR0ZXJuLmhhc2hDb2RlKCkpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewog\nICAgICAgICAgICBTdHJpbmdCdWlsZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWls\nZGVyKCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQoX3N0\ncm9uZyA/IFNUUk9ORyA6IFdFQUspLmFwcGVuZCgiLiAiKTsKICAgICAgICAg\nICAgaWYgKF9yZWFzb24gIT0gbnVsbCkKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoX3JlYXNvbik7CiAgICAgICAgICAgIHJldHVybiBidWYudG9TdHJp\nbmcoKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogU3Ry\nb25nIGV4Y2x1c2lvbi4KICAgICAqCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgY2xhc3MgU3Ryb25nRXhjbHVzaW9uIGV4dGVuZHMgRXhjbHVzaW9uUGF0\ndGVybiB7CgogICAgICAgIHB1YmxpYyBTdHJvbmdFeGNsdXNpb24oU3RyaW5n\nIHBhdHRlcm4sIFN0cmluZyByZWFzb24pIHsKICAgICAgICAgICAgc3VwZXIo\ndHJ1ZSwgcGF0dGVybiwgcmVhc29uKTsKICAgICAgICB9CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogV2VhayBleGNsdXNpb24uCiAgICAgKgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFdlYWtFeGNsdXNpb24gZXh0ZW5k\ncyBFeGNsdXNpb25QYXR0ZXJuIHsKCiAgICAgICAgcHVibGljIFdlYWtFeGNs\ndXNpb24oU3RyaW5nIHBhdHRlcm4sIFN0cmluZyByZWFzb24pIHsKICAgICAg\nICAgICAgc3VwZXIoZmFsc2UsIHBhdHRlcm4sIHJlYXNvbik7CiAgICAgICAg\nfQogICAgfQp9Cg==\n","encoding":"base64"}

