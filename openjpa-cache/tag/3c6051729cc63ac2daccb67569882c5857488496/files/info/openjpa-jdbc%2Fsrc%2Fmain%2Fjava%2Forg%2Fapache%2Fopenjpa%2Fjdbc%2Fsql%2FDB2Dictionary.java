{"sha":"0423444343ec97a59004512c5d76b19676d5be75","node_id":"MDQ6QmxvYjIwNjM2NDowNDIzNDQ0MzQzZWM5N2E1OTAwNDUxMmM1ZDc2YjE5Njc2ZDViZTc1","size":40075,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0423444343ec97a59004512c5d76b19676d5be75","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEubGFu\nZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEuc3FsLkJsb2I7CmltcG9y\ndCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuRGF0YWJh\nc2VNZXRhRGF0YTsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVtZW50\nOwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwu\nU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU3RhdGVtZW50OwppbXBv\ncnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwpp\nbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5TdHJpbmdU\nb2tlbml6ZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRl\nbnRpZmllci5EQklkZW50aWZpZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuSkRCQ0ZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkZpbHRlclZh\nbHVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4\ncHMuTGl0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVs\nLmV4cHMuUGFyYW07CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5r\nZXJuZWwuZXhwcy5WYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLkluZGV4OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLlNjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5TZXF1ZW5jZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuRmlsdGVyczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuTWl4ZWRMb2NrTGV2ZWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5leHBzLkxpdGVyYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLlN0b3JlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuVW5zdXBwb3J0ZWRFeGNlcHRpb247CgppbXBvcnQg\nc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogRGljdGlvbmFyeSBmb3IgSUJN\nIERCMiBkYXRhYmFzZS4KICovCnB1YmxpYyBjbGFzcyBEQjJEaWN0aW9uYXJ5\nCiAgICBleHRlbmRzIEFic3RyYWN0REIyRGljdGlvbmFyeSB7CiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5m\nb3JQYWNrYWdlCiAgICAgICAgKERCMkRpY3Rpb25hcnkuY2xhc3MpOwoKICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFZFTkRPUl9JQk0gPSAiaWJt\nIjsKICAgIHB1YmxpYyBTdHJpbmcgb3B0aW1pemVDbGF1c2UgPSAib3B0aW1p\nemUgZm9yIjsKICAgIHB1YmxpYyBTdHJpbmcgcm93Q2xhdXNlID0gInJvdyI7\nCiAgICBwcm90ZWN0ZWQgaW50IGRiMlNlcnZlclR5cGUgPSAwOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgZGIySVNlcmllc1Y1UjNPckVhcmxpZXIg\nPSAxOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgZGIyVURCVjgxT3JF\nYXJsaWVyID0gMjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IGRiMlpP\nU1Y4eE9yTGF0ZXIgPSAzOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQg\nZGIyVURCVjgyT3JMYXRlciA9IDQ7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBkYjJJU2VyaWVzVjVSNE9yTGF0ZXIgPSA1OwogICAgcHJvdGVjdGVk\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgZm9yVXBkYXRlID0gIkZPUiBVUERBVEUi\nOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgd2l0aFVSQ2xh\ndXNlID0gIldJVEggVVIiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgd2l0aENTQ2xhdXNlID0gIldJVEggQ1MiOwogICAgcHJvdGVjdGVk\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgd2l0aFJTQ2xhdXNlID0gIldJVEggUlMi\nOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgd2l0aFJSQ2xh\ndXNlID0gIldJVEggUlIiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgdXNlS2VlcFNoYXJlTG9ja0NsYXVzZQogICAgICAgID0gIlVTRSBB\nTkQgS0VFUCBTSEFSRSBMT0NLUyI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZp\nbmFsIFN0cmluZyB1c2VLZWVwVXBkYXRlTG9ja0NsYXVzZQogICAgICAgID0g\nIlVTRSBBTkQgS0VFUCBVUERBVEUgTE9DS1MiOwogICAgcHJvdGVjdGVkIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgdXNlS2VlcEV4Y2x1c2l2ZUxvY2tDbGF1c2UK\nICAgICAgICA9ICJVU0UgQU5EIEtFRVAgRVhDTFVTSVZFIExPQ0tTIjsKICAg\nIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIGZvclJlYWRPbmx5Q2xh\ndXNlID0gIkZPUiBSRUFEIE9OTFkiOwogICAgcHJvdGVjdGVkIFN0cmluZyBk\nYXRhYmFzZVByb2R1Y3ROYW1lID0gIiI7CiAgICBwcm90ZWN0ZWQgU3RyaW5n\nIGRhdGFiYXNlUHJvZHVjdFZlcnNpb24gPSAiIjsKICAgIHByb3RlY3RlZCBp\nbnQgbWFqID0gMDsKICAgIHByb3RlY3RlZCBpbnQgbWluID0gMDsKICAgIAog\nICAgcHJpdmF0ZSBpbnQgZGVmYXVsdEJhdGNoTGltaXQgPSAxMDA7CiAgICAK\nICAgIHB1YmxpYyBEQjJEaWN0aW9uYXJ5KCkgewogICAgICAgIHBsYXRmb3Jt\nID0gIkRCMiI7CiAgICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxFQ1QgRElT\nVElOQ1QoQ1VSUkVOVCBUSU1FU1RBTVApIEZST00gIgogICAgICAgICAgICAr\nICJTWVNJQk0uU1lTVEFCTEVTIjsKICAgICAgICBzdXBwb3J0c1NlbGVjdEVu\nZEluZGV4ID0gdHJ1ZTsKCiAgICAgICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAi\nVkFMVUVTIE5FWFRWQUwgRk9SIHswfSI7CgogICAgICAgIHNlcXVlbmNlU1FM\nID0gIlNFTEVDVCBTRVFTQ0hFTUEgQVMgU0VRVUVOQ0VfU0NIRU1BLCAiCiAg\nICAgICAgICAgICsgIlNFUU5BTUUgQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIFNZ\nU0NBVC5TRVFVRU5DRVMiOwogICAgICAgIHNlcXVlbmNlU2NoZW1hU1FMID0g\nIlNFUVNDSEVNQSA9ID8iOwogICAgICAgIHNlcXVlbmNlTmFtZVNRTCA9ICJT\nRVFOQU1FID0gPyI7CiAgICAgICAgY2hhcmFjdGVyQ29sdW1uU2l6ZSA9IDI1\nNDsKCiAgICAgICAgYmluYXJ5VHlwZU5hbWUgPSAiQkxPQigxTSkiOwogICAg\nICAgIGxvbmdWYXJiaW5hcnlUeXBlTmFtZSA9ICJCTE9CKDFNKSI7CiAgICAg\nICAgdmFyYmluYXJ5VHlwZU5hbWUgPSAiQkxPQigxTSkiOwogICAgICAgIGNs\nb2JUeXBlTmFtZSA9ICJDTE9CKDFNKSI7CiAgICAgICAgbG9uZ1ZhcmNoYXJU\neXBlTmFtZSA9ICJMT05HIFZBUkNIQVIiOwogICAgICAgIGRhdGVQcmVjaXNp\nb24gPSBNSUNSTzsKICAgICAgICBzdG9yZUNoYXJzQXNOdW1iZXJzID0gZmFs\nc2U7CgogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFsbChBcnJh\neXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkxPTkcgVkFS\nQ0hBUiBGT1IgQklUIERBVEEiLCAiTE9ORyBWQVJDSEFSIiwgIkxPTkcgVkFS\nR1JBUEhJQyIsCiAgICAgICAgfSkpOwogICAgICAgIHN5c3RlbVNjaGVtYXMg\nPSBuZXcgU3RyaW5nKAogICAgICAgICAgICAgICAgIlNZU0NBVCxTWVNJQk0s\nU1lTU1RBVCxTWVNJQk1BRE0sU1lTVE9PTFMiKTsKICAgICAgICBtYXhDb25z\ndHJhaW50TmFtZUxlbmd0aCA9IDE4OwogICAgICAgIG1heEluZGV4TmFtZUxl\nbmd0aCA9IDE4OwogICAgICAgIG1heENvbHVtbk5hbWVMZW5ndGggPSAzMDsK\nICAgICAgICBzdXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMgPSBmYWxzZTsK\nICAgICAgICBzdXBwb3J0c0RlZmF1bHREZWxldGVBY3Rpb24gPSBmYWxzZTsK\nICAgICAgICBzdXBwb3J0c0FsdGVyVGFibGVXaXRoRHJvcENvbHVtbiA9IGZh\nbHNlOwogICAgICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhPcmRlckNsYXVzZSA9\nIHRydWU7CgogICAgICAgIHN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0Q29sdW1u\ncyA9IGZhbHNlOwogICAgICAgIHJlcXVpcmVzQ2FzdEZvck1hdGhGdW5jdGlv\nbnMgPSB0cnVlOwogICAgICAgIHJlcXVpcmVzQ2FzdEZvckNvbXBhcmlzb25z\nID0gdHJ1ZTsKCiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0LmFkZEFsbChBcnJh\neXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkFGVEVSIiwg\nIkFMSUFTIiwgIkFMTE9XIiwgIkFQUExJQ0FUSU9OIiwgIkFTU09DSUFURSIs\nICJBU1VUSU1FIiwKICAgICAgICAgICAgIkFVRElUIiwgIkFVWCIsICJBVVhJ\nTElBUlkiLCAiQkVGT1JFIiwgIkJJTkFSWSIsICJCVUZGRVJQT09MIiwKICAg\nICAgICAgICAgIkNBQ0hFIiwgIkNBTEwiLCAiQ0FMTEVEIiwgIkNBUFRVUkUi\nLCAiQ0FSRElOQUxJVFkiLCAiQ0NTSUQiLAogICAgICAgICAgICAiQ0xVU1RF\nUiIsICJDT0xMRUNUSU9OIiwgIkNPTExJRCIsICJDT01NRU5UIiwgIkNPTkNB\nVCIsCiAgICAgICAgICAgICJDT05ESVRJT04iLCAiQ09OVEFJTlMiLCAiQ09V\nTlRfQklHIiwgIkNVUlJFTlRfTENfQ1RZUEUiLAogICAgICAgICAgICAiQ1VS\nUkVOVF9QQVRIIiwgIkNVUlJFTlRfU0VSVkVSIiwgIkNVUlJFTlRfVElNRVpP\nTkUiLCAiQ1lDTEUiLAogICAgICAgICAgICAiREFUQUJBU0UiLCAiREFZUyIs\nICJEQjJHRU5FUkFMIiwgIkRCMkdFTlJMIiwgIkRCMlNRTCIsCiAgICAgICAg\nICAgICJEQklORk8iLCAiREVGQVVMVFMiLCAiREVGSU5JVElPTiIsICJERVRF\nUk1JTklTVElDIiwgIkRJU0FMTE9XIiwKICAgICAgICAgICAgIkRPIiwgIkRT\nTkhBVFRSIiwgIkRTU0laRSIsICJEWU5BTUlDIiwgIkVBQ0giLCAiRURJVFBS\nT0MiLCAiRUxTRUlGIiwKICAgICAgICAgICAgIkVOQ09ESU5HIiwgIkVORC1F\nWEVDMSIsICJFUkFTRSIsICJFWENMVURJTkciLCAiRVhJVCIsICJGRU5DRUQi\nLAogICAgICAgICAgICAiRklFTERQUk9DIiwgIkZJTEUiLCAiRklOQUwiLCAi\nRlJFRSIsICJGVU5DVElPTiIsICJHRU5FUkFMIiwKICAgICAgICAgICAgIkdF\nTkVSQVRFRCIsICJHUkFQSElDIiwgIkhBTkRMRVIiLCAiSE9MRCIsICJIT1VS\nUyIsICJJRiIsCiAgICAgICAgICAgICJJTkNMVURJTkciLCAiSU5DUkVNRU5U\nIiwgIklOREVYIiwgIklOSEVSSVQiLCAiSU5PVVQiLCAiSU5URUdSSVRZIiwK\nICAgICAgICAgICAgIklTT0JJRCIsICJJVEVSQVRFIiwgIkpBUiIsICJKQVZB\nIiwgIkxBQkVMIiwgIkxDX0NUWVBFIiwgIkxFQVZFIiwKICAgICAgICAgICAg\nIkxJTktUWVBFIiwgIkxPQ0FMRSIsICJMT0NBVE9SIiwgIkxPQ0FUT1JTIiwg\nIkxPQ0siLCAiTE9DS01BWCIsCiAgICAgICAgICAgICJMT0NLU0laRSIsICJM\nT05HIiwgIkxPT1AiLCAiTUFYVkFMVUUiLCAiTUlDUk9TRUNPTkQiLAogICAg\nICAgICAgICAiTUlDUk9TRUNPTkRTIiwgIk1JTlVURVMiLCAiTUlOVkFMVUUi\nLCAiTU9ERSIsICJNT0RJRklFUyIsICJNT05USFMiLAogICAgICAgICAgICAi\nTkVXIiwgIk5FV19UQUJMRSIsICJOT0NBQ0hFIiwgIk5PQ1lDTEUiLCAiTk9E\nRU5BTUUiLCAiTk9ERU5VTUJFUiIsCiAgICAgICAgICAgICJOT01BWFZBTFVF\nIiwgIk5PTUlOVkFMVUUiLCAiTk9PUkRFUiIsICJOVUxMUyIsICJOVU1QQVJU\nUyIsICJPQklEIiwKICAgICAgICAgICAgIk9MRCIsICJPTERfVEFCTEUiLCAi\nT1BUSU1JWkFUSU9OIiwgIk9QVElNSVpFIiwgIk9VVCIsICJPVkVSUklESU5H\nIiwKICAgICAgICAgICAgIlBBQ0tBR0UiLCAiUEFSQU1FVEVSIiwgIlBBUlQi\nLCAiUEFSVElUSU9OIiwgIlBBVEgiLCAiUElFQ0VTSVpFIiwKICAgICAgICAg\nICAgIlBMQU4iLCAiUFJJUVRZIiwgIlBST0dSQU0iLCAiUFNJRCIsICJRVUVS\nWU5PIiwgIlJFQURTIiwgIlJFQ09WRVJZIiwKICAgICAgICAgICAgIlJFRkVS\nRU5DSU5HIiwgIlJFTEVBU0UiLCAiUkVOQU1FIiwgIlJFUEVBVCIsICJSRVNF\nVCIsICJSRVNJR05BTCIsCiAgICAgICAgICAgICJSRVNUQVJUIiwgIlJFU1VM\nVCIsICJSRVNVTFRfU0VUX0xPQ0FUT1IiLCAiUkVUVVJOIiwgIlJFVFVSTlMi\nLAogICAgICAgICAgICAiUk9VVElORSIsICJST1ciLCAiUlJOIiwgIlJVTiIs\nICJTQVZFUE9JTlQiLCAiU0NSQVRDSFBBRCIsCiAgICAgICAgICAgICJTRUNP\nTkRTIiwgIlNFQ1FUWSIsICJTRUNVUklUWSIsICJTRU5TSVRJVkUiLCAiU0lH\nTkFMIiwgIlNJTVBMRSIsCiAgICAgICAgICAgICJTT1VSQ0UiLCAiU1BFQ0lG\nSUMiLCAiU1FMSUQiLCAiU1RBTkRBUkQiLCAiU1RBUlQiLCAiU1RBVElDIiwK\nICAgICAgICAgICAgIlNUQVkiLCAiU1RPR1JPVVAiLCAiU1RPUkVTIiwgIlNU\nWUxFIiwgIlNVQlBBR0VTIiwgIlNZTk9OWU0iLAogICAgICAgICAgICAiU1lT\nRlVOIiwgIlNZU0lCTSIsICJTWVNQUk9DIiwgIlNZU1RFTSIsICJUQUJMRVNQ\nQUNFIiwgIlRSSUdHRVIiLAogICAgICAgICAgICAiVU5ETyIsICJVTlRJTCIs\nICJWQUxJRFBST0MiLCAiVkFSSUFCTEUiLCAiVkFSSUFOVCIsICJWQ0FUIiwK\nICAgICAgICAgICAgIlZPTFVNRVMiLCAiV0hJTEUiLCAiV0xNIiwgIllFQVJT\nIiwKICAgICAgICB9KSk7CiAgICAgICAgCiAgICAgICAgLy8gcmVzZXJ2ZWRX\nb3JkU2V0IHN1YnNldCB0aGF0IENBTk5PVCBiZSB1c2VkIGFzIHZhbGlkIGNv\nbHVtbiBuYW1lcwogICAgICAgIC8vIChpLmUuLCB3aXRob3V0IHN1cnJvdW5k\naW5nIHRoZW0gd2l0aCBkb3VibGUtcXVvdGVzKQogICAgICAgIGludmFsaWRD\nb2x1bW5Xb3JkU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdb\nXSB7CiAgICAgICAgICAgICJDT05TVFJBSU5UIiwgIkVORC1FWEVDIiwgIkVO\nRC1FWEVDMSIsIAogICAgICAgIH0pKTsKCgogICAgICAgIHN1cGVyLnNldEJh\ndGNoTGltaXQoZGVmYXVsdEJhdGNoTGltaXQpOwogICAgICAgIAogICAgICAg\nIHNlbGVjdFdvcmRTZXQuYWRkKCJXSVRIIik7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3NSZXN1bHRTZXQoU2VsZWN0\nIHNlbCwKICAgICAgICBib29sZWFuIGZvclVwZGF0ZSkgewogICAgICAgIHJl\ndHVybiAhZm9yVXBkYXRlCiAgICAgICAgICAgICYmIHN1cGVyLnN1cHBvcnRz\nUmFuZG9tQWNjZXNzUmVzdWx0U2V0KHNlbCwgZm9yVXBkYXRlKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBhcHBlbmRTZWxlY3RSYW5nZShTUUxCdWZm\nZXIgYnVmLCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAgICAgICBib29sZWFu\nIHN1YnNlbGVjdCkgewogICAgICAgIC8vIGFwcGVuZHMgdGhlIGxpdGVyYWwg\ncmFuZ2Ugc3RyaW5nLCBzaW5jZSBEQjIgaXMgdW5hYmxlIHRvIGhhbmRsZQog\nICAgICAgIC8vIGEgYm91bmQgcGFyYW1ldGVyIGZvciBpdAogICAgICAgIC8v\nIGRvIG5vdCBnZW5lcmF0ZSBGRVRDSCBGSVJTVCBjbGF1c2UgZm9yIHN1YnNl\nbGVjdAogICAgICAgIGlmICghc3Vic2VsZWN0KQogICAgICAgICAgICBidWYu\nYXBwZW5kKCIgRkVUQ0ggRklSU1QgIikuYXBwZW5kKExvbmcudG9TdHJpbmco\nZW5kKSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIiBST1dTIE9OTFkiKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBhcHBlbmRTZWxlY3QoU1FMQnVm\nZmVyIHNlbGVjdFNRTCwgT2JqZWN0IGFsaWFzLCBTZWxlY3Qgc2VsLAogICAg\nICAgIGludCBpZHgpIHsKICAgICAgICAvLyBpZiB0aGlzIGlzIGEgbGl0ZXJh\nbCB2YWx1ZSwgYWRkIGEgY2FzdC4uLgogICAgICAgIE9iamVjdCB2YWwgPSBz\nZWwuZ2V0U2VsZWN0cygpLmdldChpZHgpOwogICAgICAgIGJvb2xlYW4gdG9D\nYXN0ID0gKHZhbCBpbnN0YW5jZW9mIExpdCkgJiYgCiAgICAgICAgICAgICgo\nTGl0KXZhbCkuZ2V0UGFyc2VUeXBlKCkgIT0gTGl0ZXJhbC5UWVBFX0RBVEUg\nJiYgCiAgICAgICAgICAgICgoTGl0KXZhbCkuZ2V0UGFyc2VUeXBlKCkgIT0g\nTGl0ZXJhbC5UWVBFX1RJTUUgJiYKICAgICAgICAgICAgKChMaXQpdmFsKS5n\nZXRQYXJzZVR5cGUoKSAhPSBMaXRlcmFsLlRZUEVfVElNRVNUQU1QOwogICAg\nICAgIAogICAgICAgIGlmICh0b0Nhc3QpIAogICAgICAgICAgICBzZWxlY3RT\nUUwuYXBwZW5kKCJDQVNUKCIpOwoKICAgICAgICAvLyAuLi4gYW5kIGFkZCB0\naGUgc2VsZWN0IHBlciBzdXBlcidzIGJlaGF2aW9yLi4uCiAgICAgICAgc3Vw\nZXIuYXBwZW5kU2VsZWN0KHNlbGVjdFNRTCwgYWxpYXMsIHNlbCwgaWR4KTsK\nCiAgICAgICAgLy8gLi4uIGFuZCBmaW5pc2ggdGhlIGNhc3QKICAgICAgICBp\nZiAodG9DYXN0KSB7CiAgICAgICAgICAgIENsYXNzIGMgPSAoKExpdCkgdmFs\nKS5nZXRUeXBlKCk7CiAgICAgICAgICAgIGludCBqYXZhVHlwZUNvZGUgPSBK\nYXZhVHlwZXMuZ2V0VHlwZUNvZGUoYyk7CiAgICAgICAgICAgIGludCBqZGJj\nVHlwZUNvZGUgPSBnZXRKREJDVHlwZShqYXZhVHlwZUNvZGUsIGZhbHNlKTsK\nICAgICAgICAgICAgU3RyaW5nIHR5cGVOYW1lID0gZ2V0VHlwZU5hbWUoamRi\nY1R5cGVDb2RlKTsKICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgiIEFT\nICIgKyB0eXBlTmFtZSk7CgogICAgICAgICAgICAvLyBpZiB0aGUgbGl0ZXJh\nbCBpcyBhIHN0cmluZywgdXNlIHRoZSBkZWZhdWx0IGNoYXIgY29sIHNpemUK\nICAgICAgICAgICAgLy8gaW4gdGhlIGNhc3Qgc3RhdGVtZW50LgogICAgICAg\nICAgICBpZiAoU3RyaW5nLmNsYXNzLmVxdWFscyhjKSkKICAgICAgICAgICAg\nICAgIHNlbGVjdFNRTC5hcHBlbmQoIigiICsgY2hhcmFjdGVyQ29sdW1uU2l6\nZSArICIpIik7CgogICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIpIik7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVh\ndGVTZXF1ZW5jZVNRTChTZXF1ZW5jZSBzZXEpIHsKICAgICAgICBTdHJpbmdb\nXSBzcWwgPSBzdXBlci5nZXRDcmVhdGVTZXF1ZW5jZVNRTChzZXEpOwogICAg\nICAgIGlmIChzZXEuZ2V0QWxsb2NhdGUoKSA+IDEpCiAgICAgICAgICAgIHNx\nbFswXSArPSAiIENBQ0hFICIgKyBzZXEuZ2V0QWxsb2NhdGUoKTsKICAgICAg\nICByZXR1cm4gc3FsOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIFN0cmluZyBnZXRTZXF1ZW5jZXNTUUwoU3RyaW5nIHNjaGVtYU5hbWUs\nIFN0cmluZyBzZXF1ZW5jZU5hbWUpIHsKICAgICAgICByZXR1cm4gZ2V0U2Vx\ndWVuY2VzU1FMKERCSWRlbnRpZmllci5uZXdTY2hlbWEoc2NoZW1hTmFtZSks\nIAogICAgICAgICAgICBEQklkZW50aWZpZXIubmV3U2VxdWVuY2Uoc2VxdWVu\nY2VOYW1lKSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIGdldFNlcXVlbmNlc1NRTChEQklkZW50aWZpZXIgc2NoZW1hTmFt\nZSwgREJJZGVudGlmaWVyIHNlcXVlbmNlTmFtZSkgewogICAgICAgIFN0cmlu\nZ0J1aWxkZXIgYnVmID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBi\ndWYuYXBwZW5kKHNlcXVlbmNlU1FMKTsKICAgICAgICBpZiAoIURCSWRlbnRp\nZmllci5pc051bGwoc2NoZW1hTmFtZSkgfHwgIURCSWRlbnRpZmllci5pc051\nbGwoc2VxdWVuY2VOYW1lKSkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIFdI\nRVJFICIpOwogICAgICAgIGlmICghREJJZGVudGlmaWVyLmlzTnVsbChzY2hl\nbWFOYW1lKSkgewogICAgICAgICAgICBidWYuYXBwZW5kKHNlcXVlbmNlU2No\nZW1hU1FMKTsKICAgICAgICAgICAgaWYgKCFEQklkZW50aWZpZXIuaXNOdWxs\nKHNlcXVlbmNlTmFtZSkpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIg\nQU5EICIpOwogICAgICAgIH0KICAgICAgICBpZiAoIURCSWRlbnRpZmllci5p\nc051bGwoc2VxdWVuY2VOYW1lKSkKICAgICAgICAgICAgYnVmLmFwcGVuZChz\nZXF1ZW5jZU5hbWVTUUwpOwogICAgICAgIHJldHVybiBidWYudG9TdHJpbmco\nKTsKICAgIH0KCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBkZWNvcmF0ZShDb25u\nZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgLy8gc29tZSB2ZXJzaW9ucyBvZiB0aGUgREIyIGRyaXZlciBzZWVt\nIHRvIGRlZmF1bHQgdG8KICAgICAgICAvLyBSRUFEX1VOQ09NTUlUVEVELCB3\naGljaCB3aWxsIHByZXZlbnQgbG9ja2luZyBmcm9tIHdvcmtpbmcKICAgICAg\nICAvLyAobXVsdGlwbGUgU0VMRUNUIC4uLiBGT1IgVVBEQVRFIHN0YXRlbWVu\ndHMgYXJlIGFsbG93ZWQgb24KICAgICAgICAvLyB0aGUgc2FtZSBpbnN0YW5j\nZSk7IGlmIHdlIGhhdmUgbm90IG92ZXJyaWRkZW4gdGhlCiAgICAgICAgLy8g\ndHJhbnNhY3Rpb24gaXNvbGF0aW9uIGluIHRoZSBjb25maWd1cmF0aW9uLCBk\nZWZhdWx0IHRvCiAgICAgICAgLy8gVFJBTlNBQ1RJT05fUkVBRF9DT01NSVRU\nRUQKICAgICAgICBjb25uID0gc3VwZXIuZGVjb3JhdGUoY29ubik7CgogICAg\nICAgIGlmIChjb25mLmdldFRyYW5zYWN0aW9uSXNvbGF0aW9uQ29uc3RhbnQo\nKSA9PSAtMSAmJgogICAgICAgICAgICAgICAgY29ubi5nZXRUcmFuc2FjdGlv\nbklzb2xhdGlvbigpIDwKICAgICAgICAgICAgICAgIENvbm5lY3Rpb24uVFJB\nTlNBQ1RJT05fUkVBRF9DT01NSVRURUQpCiAgICAgICAgICAgIGNvbm4uc2V0\nVHJhbnNhY3Rpb25Jc29sYXRpb24oQ29ubmVjdGlvbi5UUkFOU0FDVElPTl9S\nRUFEX0NPTU1JVFRFRCk7CgogICAgICAgIHJldHVybiBjb25uOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNvbm5lY3RlZENvbmZpZ3VyYXRpb24oQ29ubmVj\ndGlvbiBjb25uKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzdXBl\nci5jb25uZWN0ZWRDb25maWd1cmF0aW9uKGNvbm4pOwoKICAgICAgICBEYXRh\nYmFzZU1ldGFEYXRhIG1ldGFEYXRhID0gY29ubi5nZXRNZXRhRGF0YSgpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN0cmluZyBzdHIgPSAiU0VMRUNU\nIENVUlJFTlQgU0NIRU1BIEZST00gU1lTSUJNLlNZU0RVTU1ZMSI7CiAgICAg\nICAgICAgIFN0YXRlbWVudCBzdG1udCA9IGNvbm4uY3JlYXRlU3RhdGVtZW50\nKCk7CiAgICAgICAgICAgIFJlc3VsdFNldCBycyA9IHN0bW50LmV4ZWN1dGVR\ndWVyeShzdHIpOwogICAgICAgICAgICBpZiAocnMubmV4dCgpKSB7CiAgICAg\nICAgICAgICAgICBTdHJpbmcgY3VyclNjaGVtYSA9IHJzLmdldFN0cmluZygx\nKTsKICAgICAgICAgICAgICAgIGlmIChjdXJyU2NoZW1hICE9IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgc2V0RGVmYXVsdFNjaGVtYU5hbWUoY3VyclNj\naGVtYS50cmltKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJzLmNs\nb3NlKCk7CiAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgaWYgKGxvZy5p\nc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLnRyYWNlKF9s\nb2MuZ2V0KCJjYW5fbm90X2dldF9jdXJyZW50X3NjaGVtYSIsIGUuZ2V0TWVz\nc2FnZSgpKSk7CiAgICAgICAgfQoKICAgICAgICBTdHJpbmcgZHJpdmVyTmFt\nZSA9IG1ldGFEYXRhLmdldERyaXZlck5hbWUoKTsKICAgICAgICBpZiAoZHJp\ndmVyTmFtZSAhPSBudWxsICYmIGRyaXZlck5hbWUuc3RhcnRzV2l0aCgiSUJN\nIERCMiIpKQogICAgICAgICAgICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfSUJN\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVO\nRE9SX09USEVSOwoKICAgICAgICBkYXRhYmFzZVByb2R1Y3ROYW1lID0gbnVs\nbFNhZmUobWV0YURhdGEuZ2V0RGF0YWJhc2VQcm9kdWN0TmFtZSgpKTsKICAg\nICAgICBkYXRhYmFzZVByb2R1Y3RWZXJzaW9uID0gbnVsbFNhZmUobWV0YURh\ndGEuZ2V0RGF0YWJhc2VQcm9kdWN0VmVyc2lvbigpKTsKICAgICAgICAKICAg\nICAgICAvLyBEZXRlcm1pbmUgdGhlIHR5cGUgb2YgREIyIGRhdGFiYXNlCiAg\nICAgICAgLy8gRmlyc3QgY2hlY2sgZm9yIEFTLzQwMAogICAgICAgIGdldFBy\nb2R1Y3RWZXJzaW9uTWFqb3JNaW5vckZvcklTZXJpZXMoKTsKCiAgICAgICAg\naWYgKG1haiA+IDApIHsKICAgICAgICAgICAgaWYgKGlzREIySVNlcmllc1Y1\nUjNPckVhcmxpZXIoKSkKICAgICAgICAgICAgICAgIGRiMlNlcnZlclR5cGUg\nPSBkYjJJU2VyaWVzVjVSM09yRWFybGllcjsKICAgICAgICAgICAgZWxzZSBp\nZiAoaXNEQjJJU2VyaWVzVjVSNE9yTGF0ZXIoKSkKICAgICAgICAgICAgICAg\nIGRiMlNlcnZlclR5cGUgPSBkYjJJU2VyaWVzVjVSNE9yTGF0ZXI7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIGlmIChkYjJTZXJ2ZXJUeXBlID09IDAp\nIHsKICAgICAgICAgICAgaWYgKGlzSkRCQzMpIHsKICAgICAgICAgICAgICAg\nIG1haiA9IG1ldGFEYXRhLmdldERhdGFiYXNlTWFqb3JWZXJzaW9uKCk7CiAg\nICAgICAgICAgICAgICBtaW4gPSBtZXRhRGF0YS5nZXREYXRhYmFzZU1pbm9y\nVmVyc2lvbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgIGdldFByb2R1Y3RWZXJzaW9uTWFqb3JNaW5vcigpOwoK\nICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSB0eXBlIG9mIERCMiBkYXRh\nYmFzZSBmb3IgWk9TICYgVURCCiAgICAgICAgICAgIGlmIChpc0RCMlVEQlY4\nMU9yRWFybGllcigpKQogICAgICAgICAgICAgICAgZGIyU2VydmVyVHlwZSA9\nIGRiMlVEQlY4MU9yRWFybGllcjsKICAgICAgICAgICAgZWxzZSBpZiAoaXNE\nQjJaT1NWOHhPckxhdGVyKCkpCiAgICAgICAgICAgICAgICBkYjJTZXJ2ZXJU\neXBlID0gZGIyWk9TVjh4T3JMYXRlcjsKICAgICAgICAgICAgZWxzZSBpZiAo\naXNEQjJVREJWODJPckxhdGVyKCkpCiAgICAgICAgICAgICAgICBkYjJTZXJ2\nZXJUeXBlID0gZGIyVURCVjgyT3JMYXRlcjsKICAgICAgICB9CgogICAgICAg\nIC8vIHZlcmlmeSB0aGF0IGRhdGFiYXNlIHByb2R1Y3QgaXMgc3VwcG9ydGVk\nCiAgICAgICAgaWYgKGRiMlNlcnZlclR5cGUgPT0gMCB8fCBtYWogPT0gMCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJkYi1ub3Qtc3VwcG9ydGVkIiwKICAgICAgICAgICAgICAgIG5l\ndyBPYmplY3RbXSB7ZGF0YWJhc2VQcm9kdWN0TmFtZSwgZGF0YWJhc2VQcm9k\ndWN0VmVyc2lvbiB9KSk7CgogICAgICAgIGlmIChtYWogPj0gOSB8fCAobWFq\nID09IDggJiYgbWluID49IDIpKSB7CiAgICAgICAgICAgIHN1cHBvcnRzTG9j\na2luZ1dpdGhNdWx0aXBsZVRhYmxlcyA9IHRydWU7CiAgICAgICAgICAgIHN1\ncHBvcnRzTG9ja2luZ1dpdGhJbm5lckpvaW4gPSB0cnVlOwogICAgICAgICAg\nICBzdXBwb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2luID0gdHJ1ZTsKICAgICAg\nICAgICAgZm9yVXBkYXRlQ2xhdXNlID0gIldJVEggUlIgVVNFIEFORCBLRUVQ\nIFVQREFURSBMT0NLUyI7CiAgICAgICAgICAgIGlmIChtYWogPj05KQogICAg\nICAgICAgICAgICAgc3VwcG9ydHNYTUxDb2x1bW4gPSB0cnVlOwogICAgICAg\nIH0KCiAgICAgICAgLy8gcGxhdGZvcm0gc3BlY2lmaWMgc2V0dGluZ3MKICAg\nICAgICBzd2l0Y2ggKGRiMlNlcnZlclR5cGUpIHsKICAgICAgICBjYXNlIGRi\nMlVEQlY4Mk9yTGF0ZXI6CiAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRLZXlR\ndWVyeSA9ICJTRUxFQ1QgSURFTlRJVFlfVkFMX0xPQ0FMKCkgRlJPTSAiCiAg\nICAgICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsKICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgY2FzZSAgZGIyWk9TVjh4T3JMYXRlcjoKICAg\nICAgICAgICAgLy8gREIyIFovT1MgCiAgICAgICAgICAgIGNoYXJhY3RlckNv\nbHVtblNpemUgPSAyNTU7CiAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRLZXlR\ndWVyeSA9ICJTRUxFQ1QgSURFTlRJVFlfVkFMX0xPQ0FMKCkgRlJPTSAiCiAg\nICAgICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsKICAgICAgICAg\nICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwgRk9SIHsw\nfSBGUk9NICIKICAgICAgICAgICAgICAgICsgIlNZU0lCTS5TWVNEVU1NWTEi\nOwogICAgICAgICAgICBzZXF1ZW5jZVNRTCA9ICJTRUxFQ1QgU0NIRU1BIEFT\nIFNFUVVFTkNFX1NDSEVNQSwgIgogICAgICAgICAgICAgICAgKyAiTkFNRSBB\nUyBTRVFVRU5DRV9OQU1FIEZST00gU1lTSUJNLlNZU1NFUVVFTkNFUyI7CiAg\nICAgICAgICAgIHNlcXVlbmNlU2NoZW1hU1FMID0gIlNDSEVNQSA9ID8iOwog\nICAgICAgICAgICBzZXF1ZW5jZU5hbWVTUUwgPSAiTkFNRSA9ID8iOwogICAg\nICAgICAgICBpZiAobWFqID09IDgpIHsKICAgICAgICAgICAgICAgIC8vIERC\nMiBaL09TIFZlcnNpb24gODogbm8gYmlnaW50IHN1cHBvcnQsIGhlbmNlIG1h\ncCBKYXZhCiAgICAgICAgICAgICAgICAvLyBsb25nIHRvIGRlY2ltYWwKICAg\nICAgICAgICAgICAgIGJpZ2ludFR5cGVOYW1lID0gIkRFQ0lNQUwoMzEsMCki\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNh\nc2UgZGIySVNlcmllc1Y1UjNPckVhcmxpZXI6CiAgICAgICAgY2FzZSBkYjJJ\nU2VyaWVzVjVSNE9yTGF0ZXI6CiAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRL\nZXlRdWVyeSA9ICJTRUxFQ1QgSURFTlRJVFlfVkFMX0xPQ0FMKCkgRlJPTSAi\nCiAgICAgICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsKICAgICAg\nICAgICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwgRk9S\nIHswfSBGUk9NICIKICAgICAgICAgICAgICAgICsgIlNZU0lCTS5TWVNEVU1N\nWTEiOwogICAgICAgICAgICB2YWxpZGF0aW9uU1FMID0gIlNFTEVDVCBESVNU\nSU5DVChDVVJSRU5UIFRJTUVTVEFNUCkgRlJPTSAiCiAgICAgICAgICAgICAg\nICArICJRU1lTMi5TWVNUQUJMRVMiOwogICAgICAgICAgICBzZXF1ZW5jZVNR\nTCA9ICJTRUxFQ1QgU0VRVUVOQ0VfU0NIRU1BLCAiCiAgICAgICAgICAgICAg\nICArICJTRVFVRU5DRV9OQU1FIEZST00gUVNZUzIuU1lTU0VRVUVOQ0VTIjsK\nICAgICAgICAgICAgc2VxdWVuY2VTY2hlbWFTUUwgPSAiU0VRVUVOQ0VfU0NI\nRU1BID0gPyI7CiAgICAgICAgICAgIHNlcXVlbmNlTmFtZVNRTCA9ICJTRVFV\nRU5DRV9OQU1FID0gPyI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0lzb2xhdGlvbkZv\nclVwZGF0ZSgpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdldCB0aGUgdXBkYXRlIGNsYXVzZSBmb3IgdGhlIHF1ZXJ5\nIGJhc2VkIG9uIHRoZQogICAgICogdXBkYXRlQ2xhdXNlIGFuZCBpc29sYXRp\nb25MZXZlbCBoaW50cwogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdl\ndEZvclVwZGF0ZUNsYXVzZShKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNo\nLAogICAgICAgIGJvb2xlYW4gaXNGb3JVcGRhdGUsIFNlbGVjdCBzZWwpIHsK\nICAgICAgICBpbnQgaXNvbGF0aW9uTGV2ZWw7CiAgICAgICAgLy8gRm9yIGRi\nMlVEQlY4MU9yRWFybGllciBhbmQgZGIySVNlcmllc1Y1UjNPckVhcmxpZXI6\nCiAgICAgICAgLy8gIm9wdGltaXplIGZvciIgY2xhdXNlIGFwcGVhcnMgYmVm\nb3JlICJmb3IgdXBkYXRlIiBjbGF1c2UuCiAgICAgICAgU3RyaW5nQnVmZmVy\nIGZvclVwZGF0ZVN0cmluZyA9IG5ldyBTdHJpbmdCdWZmZXIoZ2V0T3B0aW1p\nemVDbGF1c2Uoc2VsKSk7CiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBpc29s\nYXRpb25MZXZlbDsgdGhlIGZldGNoCiAgICAgICAgLy8gY29uZmlndXJhdGlv\nbiBkYXRhIG92ZXJyaWRlcyB0aGUgcGVyc2lzdGVuY2UueG1sIHZhbHVlCiAg\nICAgICAgaWYgKGZldGNoICE9IG51bGwgJiYgZmV0Y2guZ2V0SXNvbGF0aW9u\nKCkgIT0gLTEpCiAgICAgICAgICAgIGlzb2xhdGlvbkxldmVsID0gZmV0Y2gu\nZ2V0SXNvbGF0aW9uKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBpc29s\nYXRpb25MZXZlbCA9IGNvbmYuZ2V0VHJhbnNhY3Rpb25Jc29sYXRpb25Db25z\ndGFudCgpOwoKICAgICAgICBpZiAoZmV0Y2ggIT0gbnVsbCAmJiBmZXRjaC5n\nZXRSZWFkTG9ja0xldmVsKCkgPj0gCiAgICAgICAgICAgIE1peGVkTG9ja0xl\ndmVscy5MT0NLX1BFU1NJTUlTVElDX1dSSVRFKQogICAgICAgICAgICBpc29s\nYXRpb25MZXZlbCA9IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fU0VSSUFMSVpB\nQkxFOwoKICAgICAgICBpZiAoaXNGb3JVcGRhdGUpIHsKICAgICAgICAgICAg\nc3dpdGNoIChkYjJTZXJ2ZXJUeXBlKSB7CiAgICAgICAgICAgIGNhc2UgZGIy\nSVNlcmllc1Y1UjNPckVhcmxpZXI6CiAgICAgICAgICAgIGNhc2UgZGIyVURC\nVjgxT3JFYXJsaWVyOgogICAgICAgICAgICAgICAgaWYgKGlzb2xhdGlvbkxl\ndmVsID09IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fU0VSSUFMSVpBQkxFKQog\nICAgICAgICAgICAgICAgICAgIGZvclVwZGF0ZVN0cmluZy5hcHBlbmQoIiAi\nKS5hcHBlbmQoZm9yVXBkYXRlQ2xhdXNlKTsKICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICBmb3JVcGRhdGVTdHJpbmcuYXBwZW5k\nKCIgIikuYXBwZW5kKGZvclVwZGF0ZSkuYXBwZW5kKCIgIikKICAgICAgICAg\nICAgICAgICAgICAgICAgLmFwcGVuZCh3aXRoUlNDbGF1c2UpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgZGIyWk9TVjh4T3JM\nYXRlcjoKICAgICAgICAgICAgY2FzZSBkYjJVREJWODJPckxhdGVyOgogICAg\nICAgICAgICAgICAgaWYgKGlzb2xhdGlvbkxldmVsID09IENvbm5lY3Rpb24u\nVFJBTlNBQ1RJT05fU0VSSUFMSVpBQkxFKSB7CiAgICAgICAgICAgICAgICAg\nICAgZm9yVXBkYXRlU3RyaW5nLmFwcGVuZCgiICIpLmFwcGVuZChmb3JSZWFk\nT25seUNsYXVzZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgi\nICIpLmFwcGVuZCh3aXRoUlJDbGF1c2UpLmFwcGVuZCgiICIpLmFwcGVuZCgK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZUtlZXBVcGRhdGVMb2Nr\nQ2xhdXNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICAgICAgZm9yVXBkYXRlU3RyaW5nLmFwcGVuZCgiICIpLmFwcGVuZChm\nb3JSZWFkT25seUNsYXVzZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFw\ncGVuZCgiICIpLmFwcGVuZCh3aXRoUlNDbGF1c2UpLmFwcGVuZCgiICIpLmFw\ncGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZUtlZXBVcGRh\ndGVMb2NrQ2xhdXNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIGRiMklTZXJpZXNWNVI0T3JM\nYXRlcjoKICAgICAgICAgICAgICAgIGlmIChpc29sYXRpb25MZXZlbCA9PSBD\nb25uZWN0aW9uLlRSQU5TQUNUSU9OX1NFUklBTElaQUJMRSkgewogICAgICAg\nICAgICAgICAgICAgIGZvclVwZGF0ZVN0cmluZy5hcHBlbmQoIiAiKS5hcHBl\nbmQoZm9yUmVhZE9ubHlDbGF1c2UpCiAgICAgICAgICAgICAgICAgICAgICAg\nIC5hcHBlbmQoIiAiKS5hcHBlbmQod2l0aFJSQ2xhdXNlKS5hcHBlbmQoIiAi\nKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VLZWVw\nRXhjbHVzaXZlTG9ja0NsYXVzZSk7CiAgICAgICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgICAgIGZvclVwZGF0ZVN0cmluZy5hcHBlbmQo\nIiAiKS5hcHBlbmQoZm9yUmVhZE9ubHlDbGF1c2UpCiAgICAgICAgICAgICAg\nICAgICAgICAgIC5hcHBlbmQoIiAiKS5hcHBlbmQod2l0aFJTQ2xhdXNlKS5h\ncHBlbmQoIiAiKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB1c2VLZWVwRXhjbHVzaXZlTG9ja0NsYXVzZSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgCiAgICAgICAgcmV0dXJuIGZvclVwZGF0ZVN0cmluZy50b1N0\ncmluZygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzREIyVURCVjgy\nT3JMYXRlcigpIHsKICAgICAgICByZXR1cm4gKGRhdGFiYXNlUHJvZHVjdFZl\ncnNpb24uaW5kZXhPZigiU1FMIikgIT0gLTEKICAgICAgICAgICAgIHx8IGRh\ndGFiYXNlUHJvZHVjdE5hbWUuaW5kZXhPZigiREIyLyIpICE9IC0xKQogICAg\nICAgICAgICAgJiYgKChtYWogPT0gOCAmJiBtaW4gPj0gMikgfHwgKG1haiA+\nPSA5KSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEQjJaT1NWOHhP\nckxhdGVyKCkgewogICAgICAgcmV0dXJuIChkYXRhYmFzZVByb2R1Y3RWZXJz\naW9uLmluZGV4T2YoIkRTTiIpICE9IC0xCiAgICAgICAgICAgIHx8IGRhdGFi\nYXNlUHJvZHVjdE5hbWUuaW5kZXhPZigiREIyLyIpID09IC0xKQogICAgICAg\nICAgICAmJiBtYWogPj0gODsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc0RCMklTZXJpZXNWNVIzT3JFYXJsaWVyKCkgewogICAgICAgcmV0dXJuIChk\nYXRhYmFzZVByb2R1Y3ROYW1lLmluZGV4T2YoIkFTIikgIT0gLTEKICAgICAg\nICAgICAmJiAoKG1haiA9PSA1ICYmIG1pbiA8PTMpIHx8IG1haiA8IDUpKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RCMklTZXJpZXNWNVI0T3JM\nYXRlcigpIHsKICAgICAgIHJldHVybiBkYXRhYmFzZVByb2R1Y3ROYW1lLmlu\nZGV4T2YoIkFTIikgIT0gLTEKICAgICAgICAgICAmJiAobWFqID49NiB8fCAo\nbWFqID09IDUgJiYgbWluID49NCkpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzREIyVURCVjgxT3JFYXJsaWVyKCkgewogICAgICAgIHJldHVybiAo\nZGF0YWJhc2VQcm9kdWN0VmVyc2lvbi5pbmRleE9mKCJTUUwiKSAhPSAtMSAK\nICAgICAgICAgICAgfHwgZGF0YWJhc2VQcm9kdWN0TmFtZS5pbmRleE9mKCJE\nQjIvIikgIT0gLTEpIAogICAgICAgICAgICAmJiAoKG1haiA9PSA4ICYmIG1p\nbiA8PSAxKSB8fCBtYWogPCA4KTsKICAgIH0KCiAgICAvKiogR2V0IHRoZSB2\nZXJzaW9uIE1ham9yL01pbm9yIGZvciB0aGUgSVNlcmllcwogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgZ2V0UHJvZHVjdFZlcnNpb25NYWpvck1pbm9yRm9y\nSVNlcmllcygpIHsKICAgICAgICAvLyBJU2VyaWVzICAgIERCUHJvZE5hbWUg\nICAgICAgICAgICAgICAgIERCMiBVREIgZm9yIEFTLzQwMAogICAgICAgIC8v\nICAgKFRvb2xib3gpREJQcm9kVmVyc2lvbiAgICAgICAgICAgICAgMDUuMDQu\nMDAwMCBWNVI0bTAKICAgICAgICAvLyBJU2VyaWVzICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIERCMiBVREIgZm9yIEFTLzQwMAogICAgICAgIC8v\nICAgKE5hdGl2ZSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgVjVSNE0w\nCiAgICAgICAgLy8gbmV3IGpjYyAgICBEQlByb2RWZXJzaW9uICAgICAgICAg\nICAgICBRU1EwNTA0MCBvciBRU1EwNjAxMAogICAgICAgIGlmIChkYXRhYmFz\nZVByb2R1Y3ROYW1lLmluZGV4T2YoIkFTIikgIT0gLTEpIHsKICAgICAgICAg\nICAgLy8gZGVmYXVsdCB0byBWNVI0CiAgICAgICAgICAgIG1haiA9IDU7CiAg\nICAgICAgICAgIG1pbiA9IDQ7CiAgICAgICAgICAgIGludCBpbmRleCA9IGRh\ndGFiYXNlUHJvZHVjdFZlcnNpb24uaW5kZXhPZignVicpOwogICAgICAgICAg\nICBpZiAoaW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgIFN0cmluZyBz\nID0gZGF0YWJhc2VQcm9kdWN0VmVyc2lvbi5zdWJzdHJpbmcoaW5kZXgpOwog\nICAgICAgICAgICAgICAgcyA9IHMudG9VcHBlckNhc2UoKTsKCiAgICAgICAg\nICAgICAgICBTdHJpbmdUb2tlbml6ZXIgc3RyaW5ndG9rZW5pemVyID0gbmV3\nIFN0cmluZ1Rva2VuaXplcihzLCAiVlJNIgogICAgICAgICAgICAgICAgICAg\nICwgZmFsc2UpOwogICAgICAgICAgICAgICAgaWYgKHN0cmluZ3Rva2VuaXpl\nci5jb3VudFRva2VucygpID09IDMpIHsKICAgICAgICAgICAgICAgICAgICBT\ndHJpbmcgczEgPSBzdHJpbmd0b2tlbml6ZXIubmV4dFRva2VuKCk7CiAgICAg\nICAgICAgICAgICAgICAgbWFqID0gSW50ZWdlci5wYXJzZUludChzMSk7CiAg\nICAgICAgICAgICAgICAgICAgU3RyaW5nIHMyID0gIHN0cmluZ3Rva2VuaXpl\nci5uZXh0VG9rZW4oKTsKICAgICAgICAgICAgICAgICAgICBtaW4gPSBJbnRl\nZ2VyLnBhcnNlSW50KHMyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGluZGV4ID0gZGF0YWJhc2VQ\ncm9kdWN0VmVyc2lvbi5pbmRleE9mKCcwJyk7CiAgICAgICAgICAgICAgICBp\nZiAoaW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcg\ncyA9IGRhdGFiYXNlUHJvZHVjdFZlcnNpb24uc3Vic3RyaW5nKGluZGV4KTsK\nICAgICAgICAgICAgICAgICAgICBzID0gcy50b1VwcGVyQ2FzZSgpOwoKICAg\nICAgICAgICAgICAgICAgICBTdHJpbmdUb2tlbml6ZXIgc3RyaW5ndG9rZW5p\nemVyID0gbmV3IFN0cmluZ1Rva2VuaXplcihzLCAiMCIKICAgICAgICAgICAg\nICAgICAgICAgICAgLCBmYWxzZSk7ICAgICAgICAgICAgICAgICAgICAKICAg\nICAgICAgICAgICAgICAgICBpZiAoc3RyaW5ndG9rZW5pemVyLmNvdW50VG9r\nZW5zKCkgPT0gMikgewogICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcg\nczEgPSBzdHJpbmd0b2tlbml6ZXIubmV4dFRva2VuKCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIG1haiA9IEludGVnZXIucGFyc2VJbnQoczEpOwogICAg\nICAgICAgICAgICAgICAgICAgICBTdHJpbmcgczIgPSAgc3RyaW5ndG9rZW5p\nemVyLm5leHRUb2tlbigpOwogICAgICAgICAgICAgICAgICAgICAgICBtaW4g\nPSBJbnRlZ2VyLnBhcnNlSW50KHMyKTsKICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICB9CiAgICAKICAgIHByaXZhdGUgdm9pZCBnZXRQcm9kdWN0VmVyc2lvbk1h\nam9yTWlub3IoKSB7CiAgICAgICAgLy8gSW4gY2FzZSBKREJDIGRyaXZlciB2\nZXJzaW9uIGlzIGxvd2VyIHRoYW4gMwogICAgICAgIC8vIHVzZSBmb2xsb3dp\nbmcgaW5mbyB0byBkZXRlcm1pbmUgTWFqb3IgYW5kIE1pbm9yIAogICAgICAg\nIC8vICAgICAgICAgICAgICAgICAgICAgICAgQ0xJICAgIHZzICAgICAgSkND\nCiAgICAgICAgLy8gWkRCVjggREJQcm9kTmFtZSAgICAgICBEQjIgICAgICAg\nICAgICBEQjIKICAgICAgICAvLyAgICAgICBEQlByb2RWZXJzaW9uICAgIDA4\nLjAxLjAwMDUgICAgIERTTjA4MDE1CiAgICAgICAgLy8gWkRCVjkgICAgICAg\nICAgICAgICAgICBEQjIgICAgICAgICAgICBEQjIKICAgICAgICAvLyAgICAg\nICAgICAgICAgICAgICAgICAgIDA5LjAxLjAwMDUgICAgIERTTjA5MDE1CiAg\nICAgICAgLy8gV2luVjkgICAgICAgICAgICAgICAgICBEQjIvTlQgICAgICAg\nICBEQjIvTlQKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIDA5\nLjAxLjAwMDAgICAgIFNRTDA5MDEwCiAgICAgICAgLy8gU29sYXJpc1Y5ICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBEQjIvU1VONjQKICAgICAgICAv\nLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNRTDA5\nMDEKICAgICAgICAvLyBMaW51eCAgICAgICAgICAgICAgICAgIERCMi9MSU5V\nWCAgICAgIERCMi9MSU5VWAogICAgICAgIC8vICAgICAgICAgICAgICAgICAg\nICAgICAgMDkuMDEuMDAwMCAgICAgU1FMMDkwMQogICAgICAgIGlmIChkYXRh\nYmFzZVByb2R1Y3RWZXJzaW9uLmluZGV4T2YoIjA5IikgIT0gLTEpIHsKICAg\nICAgICAgICAgbWFqID0gOTsKICAgICAgICAgICAgaWYgKGRhdGFiYXNlUHJv\nZHVjdFZlcnNpb24uaW5kZXhPZigiMDEiKSAhPSAtMSkgewogICAgICAgICAg\nICAgICAgbWluID0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBp\nZiAoZGF0YWJhc2VQcm9kdWN0VmVyc2lvbi5pbmRleE9mKCIwOCIpICE9IC0x\nKSB7CiAgICAgICAgICAgIG1haiA9IDg7CiAgICAgICAgICAgIG1pbiA9IDI7\nCiAgICAgICAgICAgIGlmIChkYXRhYmFzZVByb2R1Y3RWZXJzaW9uLmluZGV4\nT2YoIjAxIikgIT0gLTEpIHsKICAgICAgICAgICAgICAgIG1pbiA9IDE7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIFN0\ncmluZyBnZXRPcHRpbWl6ZUNsYXVzZShTZWxlY3Qgc2VsKSB7CiAgICAgICAg\naWYgKHNlbCAhPSBudWxsICYmIHNlbC5nZXRFeHBlY3RlZFJlc3VsdENvdW50\nKCkgPiAwKSB7CiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3\nIFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiICIp\nLmFwcGVuZChvcHRpbWl6ZUNsYXVzZSkuYXBwZW5kKCIgIikKICAgICAgICAg\nICAgICAgIC5hcHBlbmQoU3RyaW5nLnZhbHVlT2Yoc2VsLmdldEV4cGVjdGVk\nUmVzdWx0Q291bnQoKSkpCiAgICAgICAgICAgICAgICAuYXBwZW5kKCIgIiku\nYXBwZW5kKHJvd0NsYXVzZSk7CiAgICAgICAgICAgIHJldHVybiBidWYudG9T\ndHJpbmcoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAiIjsKICAgIH0K\nCiAgICBwdWJsaWMgT3BlbkpQQUV4Y2VwdGlvbiBuZXdTdG9yZUV4Y2VwdGlv\nbihTdHJpbmcgbXNnLCBTUUxFeGNlcHRpb25bXSBjYXVzZXMsCiAgICAgICAg\nT2JqZWN0IGZhaWxlZCkgewogICAgICAgIGlmIChjYXVzZXMgIT0gbnVsbCAm\nJiBjYXVzZXMubGVuZ3RoID4gMCkKICAgICAgICAgICAgbXNnID0gYXBwZW5k\nRXh0ZW5kZWRFeGNlcHRpb25Nc2cobXNnLCBjYXVzZXNbMF0pOwogICAgICAg\nIHJldHVybiBzdXBlci5uZXdTdG9yZUV4Y2VwdGlvbihtc2csIGNhdXNlcywg\nZmFpbGVkKTsKICAgIH0KCiAgICAvKioKICAgICAqICBBcHBlbmQgZXhjZXB0\naW9uIGluZm9ybWF0aW9uIGZyb20gU1FMQ0EgdG8gdGhlIGV4aXN0aW5nCiAg\nICAgKiAgZXhjZXB0aW9uIG1lc3NhZ2UKICAgICAqLwogICAgcHJpdmF0ZSBT\ndHJpbmcgYXBwZW5kRXh0ZW5kZWRFeGNlcHRpb25Nc2coU3RyaW5nIG1zZywg\nU1FMRXhjZXB0aW9uIHNxbGUpewogICAgICAgZmluYWwgU3RyaW5nIEdFVFNR\nTENBID0iZ2V0U3FsY2EiOwogICAgICAgU3RyaW5nIGV4Y2VwdGlvbk1zZyA9\nIG5ldyBTdHJpbmcoKTsKICAgICAgIHRyeSB7CiAgICAgICAgICAgIE1ldGhv\nZCBzcWxjYU0yID0gc3FsZS5nZXROZXh0RXhjZXB0aW9uKCkuZ2V0Q2xhc3Mo\nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRNZXRob2QoR0VU\nU1FMQ0EsbnVsbCk7CiAgICAgICAgICAgIE9iamVjdCBzcWxjYSA9IHNxbGNh\nTTIuaW52b2tlKHNxbGUuZ2V0TmV4dEV4Y2VwdGlvbigpLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgT2JqZWN0W10g\ne30pOwogICAgICAgICAgICBNZXRob2QgIGdldFNxbEVycnBNZXRoZCA9IHNx\nbGNhLmdldENsYXNzKCkuCiAgICAgICAgICAgIGdldE1ldGhvZCgiZ2V0U3Fs\nRXJycCIsIG51bGwpOwogICAgICAgICAgICBNZXRob2QgIGdldFNxbFdhcm5N\nZXRoZCA9IHNxbGNhLmdldENsYXNzKCkuCiAgICAgICAgICAgIGdldE1ldGhv\nZCgiZ2V0U3FsV2FybiIsIG51bGwpOwogICAgICAgICAgICBNZXRob2QgIGdl\ndFNxbEVycmRNZXRoZCA9IHNxbGNhLmdldENsYXNzKCkuCiAgICAgICAgICAg\nIGdldE1ldGhvZCgiZ2V0U3FsRXJyZCIsIG51bGwpOwogICAgICAgICAgICBT\ndHJpbmdCdWlsZGVyIGVycmRTdHIgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwoK\nICAgICAgICAgICAgaW50W10gZXJyZHMgPSAoaW50W10pIGdldFNxbEVycmRN\nZXRoZC5pbnZva2Uoc3FsY2EsIG5ldyBPYmplY3RbXXt9KTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBlcnJkcy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgICAgIGVycmRTdHIuYXBwZW5kKGVycmRTdHIubGVuZ3RoKCkg\nPiAwID8gIiwgIiA6ICIiKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQo\nZXJyZHNbaV0pOwogICAgICAgICAgICBleGNlcHRpb25Nc2cgPSBleGNlcHRp\nb25Nc2cuY29uY2F0KCAiU1FMQ0EgT1VUUFVUIiArCiAgICAgICAgICAgICAg\nICAgICAgIltFcnJwPSIgKyBnZXRTcWxFcnJwTWV0aGQuaW52b2tlKHNxbGNh\nLCBuZXcgT2JqZWN0W117fSkKICAgICAgICAgICAgICAgICAgICArICIsIEVy\ncmQ9IiArIGVycmRTdHIpOwoKICAgICAgICAgICAgU3RyaW5nIFdhcm4gPSBu\nZXcgU3RyaW5nKChjaGFyW10pIGdldFNxbFdhcm5NZXRoZC4KICAgICAgICAg\nICAgICAgICAgICBpbnZva2Uoc3FsY2EsIG5ldyBPYmplY3RbXXt9KSk7CiAg\nICAgICAgICAgIGlmIChXYXJuLnRyaW0oKS5sZW5ndGgoKSAhPSAwKQogICAg\nICAgICAgICAgICAgZXhjZXB0aW9uTXNnID0gZXhjZXB0aW9uTXNnLmNvbmNh\ndCgiLCBXYXJuPSIgK1dhcm4gKyAiXSIgKTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgZXhjZXB0aW9uTXNnID0gZXhjZXB0aW9uTXNnLmNv\nbmNhdCggIl0iICk7CiAgICAgICAgICAgIG1zZyA9IG1zZy5jb25jYXQoZXhj\nZXB0aW9uTXNnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIGZvciBi\nYXRjaGVkIGV4ZWN1dGlvbiBmYWlsdXJlcywgU1FMRXhjZXB0aW9ucyBhcmUg\nbmVzdGVkCiAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBzcWxlMiA9IHNxbGUu\nZ2V0TmV4dEV4Y2VwdGlvbigpOwogICAgICAgICAgICB3aGlsZSAoc3FsZTIg\nIT0gbnVsbCkgeyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG1z\nZyA9IG1zZy5jb25jYXQoIlxuIiArIHNxbGUyLmdldE1lc3NhZ2UoKSk7CiAg\nICAgICAgICAgICAgICBzcWxlMiA9IHNxbGUyLmdldE5leHRFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0\ndXJuIG1zZzsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAg\nICAgICAgICByZXR1cm4gc3FsZS5nZXRNZXNzYWdlKCk7CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0RGIyU2VydmVyVHlwZSgpIHsKICAg\nICAgICByZXR1cm4gZGIyU2VydmVyVHlwZTsKICAgIH0KICAgIAogICAgcHJv\ndGVjdGVkIHZvaWQgYXBwZW5kTGVuZ3RoKFNRTEJ1ZmZlciBidWYsIGludCB0\neXBlKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gVHlwZXMuVkFSQ0hBUikKICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiKCIpLmFwcGVuZChJbnRlZ2VyLnRvU3Ry\naW5nKGNoYXJhY3RlckNvbHVtblNpemUpKS4KICAgICAgICAgICAgICAgIGFw\ncGVuZCgiKSIpOwogICAgfQoKICAgIC8qKgogICAgICogSWYgdGhpcyBkaWN0\naW9uYXJ5IHN1cHBvcnRzIFhNTCB0eXBlLAogICAgICogdXNlIHRoaXMgbWV0\naG9kIHRvIGFwcGVuZCB4bWwgcHJlZGljYXRlLgogICAgICogCiAgICAgKiBA\ncGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRlIHRoZSBjb21wYXJp\nc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBhcmlzb24gb3BlcmF0aW9u\nIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMgdGhlIGxlZnQgaGFuZCBz\naWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gcmhzIHRoZSBy\naWdodCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24KICAgICAqIEBwYXJh\nbSBsaHN4bWwgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGxlZnQgb3BlcmFuZCBt\nYXBzIHRvIHhtbAogICAgICogQHBhcmFtIHJoc3htbCBpbmRpY2F0ZXMgd2hl\ndGhlciB0aGUgcmlnaHQgb3BlcmFuZCBtYXBzIHRvIHhtbAogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBhcHBlbmRYbWxDb21wYXJpc29uKFNRTEJ1ZmZlciBi\ndWYsIFN0cmluZyBvcCwgRmlsdGVyVmFsdWUgbGhzLAogICAgICAgIEZpbHRl\nclZhbHVlIHJocywgYm9vbGVhbiBsaHN4bWwsIGJvb2xlYW4gcmhzeG1sKSB7\nCiAgICAgICAgc3VwZXIuYXBwZW5kWG1sQ29tcGFyaXNvbihidWYsIG9wLCBs\naHMsIHJocywgbGhzeG1sLCByaHN4bWwpOwogICAgICAgIGlmIChsaHN4bWwg\nJiYgcmhzeG1sKQogICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29uMihi\ndWYsIG9wLCBsaHMsIHJocyk7CiAgICAgICAgZWxzZSBpZiAobGhzeG1sKQog\nICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29uMShidWYsIG9wLCBsaHMs\nIHJocyk7CiAgICAgICAgZWxzZSAKICAgICAgICAgICAgYXBwZW5kWG1sQ29t\ncGFyaXNvbjEoYnVmLCBvcCwgcmhzLCBsaHMpOwogICAgfQoKICAgIC8qKgog\nICAgICogQXBwZW5kIGFuIHhtbCBjb21wYXJpc29uIHByZWRpY2F0ZS4KICAg\nICAqCiAgICAgKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRl\nIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBhcmlz\nb24gb3BlcmF0aW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMgdGhl\nIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uIChtYXBzIHRvIHht\nbCBjb2x1bW4pCiAgICAgKiBAcGFyYW0gcmhzIHRoZSByaWdodCBoYW5kIHNp\nZGUgb2YgdGhlIGNvbXBhcmlzb24KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGFwcGVuZFhtbENvbXBhcmlzb24xKFNRTEJ1ZmZlciBidWYsIFN0cmluZyBv\ncCwgCiAgICAgICAgICAgIEZpbHRlclZhbHVlIGxocywgRmlsdGVyVmFsdWUg\ncmhzKSB7CiAgICAgICAgYm9vbGVhbiBjYXN0cmhzID0gZmFsc2U7CiAgICAg\nICAgQ2xhc3MgcmMgPSBGaWx0ZXJzLndyYXAocmhzLmdldFR5cGUoKSk7CiAg\nICAgICAgaW50IHR5cGUgPSAwOwogICAgICAgIGlmIChyaHMuaXNDb25zdGFu\ndCgpKSB7CiAgICAgICAgICAgIHR5cGUgPSBnZXRKREJDVHlwZShKYXZhVHlw\nZXMuZ2V0VHlwZUNvZGUocmMpLCBmYWxzZSk7CiAgICAgICAgICAgIGNhc3Ry\naHMgPSB0cnVlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBhcHBlbmRY\nbWxFeGlzdHMoYnVmLCBsaHMpOwoKICAgICAgICBidWYuYXBwZW5kKCIgIiku\nYXBwZW5kKG9wKS5hcHBlbmQoIiAiKTsKICAgICAgICAKICAgICAgICBidWYu\nYXBwZW5kKCIkIik7CiAgICAgICAgaWYgKGNhc3RyaHMpCiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIlBhcm0iKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIHJocy5hcHBlbmRUbyhidWYpOwogICAgICAgIAogICAgICAgIGJ1Zi5hcHBl\nbmQoIl0nIFBBU1NJTkcgIik7CiAgICAgICAgYXBwZW5kWG1sVmFyKGJ1Ziwg\nbGhzKTsKICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgIAogICAg\nICAgIGlmIChjYXN0cmhzKQogICAgICAgICAgICBhcHBlbmRDYXN0KGJ1Ziwg\ncmhzLCB0eXBlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJocy5hcHBl\nbmRUbyhidWYpOwogICAgICAgIAogICAgICAgIGJ1Zi5hcHBlbmQoIiBBUyBc\nIiIpOwogICAgICAgIGlmIChjYXN0cmhzKQogICAgICAgICAgICBidWYuYXBw\nZW5kKCJQYXJtIik7CiAgICAgICAgZWxzZQogICAgICAgICAgICByaHMuYXBw\nZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCJcIikiKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBBcHBlbmQgYW4geG1sIGNvbXBhcmlzb24g\ncHJlZGljYXRlLiAoYm90aCBvcGVyYW5kcyBtYXAgdG8geG1sIGNvbHVtbikK\nICAgICAqCiAgICAgKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdy\naXRlIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBh\ncmlzb24gb3BlcmF0aW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMg\ndGhlIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uIChtYXBzIHRv\nIHhtbCBjb2x1bW4pCiAgICAgKiBAcGFyYW0gcmhzIHRoZSByaWdodCBoYW5k\nIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24gKG1hcHMgdG8geG1sIGNvbHVtbikK\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFwcGVuZFhtbENvbXBhcmlzb24y\nKFNRTEJ1ZmZlciBidWYsIFN0cmluZyBvcCwgCiAgICAgICAgICAgIEZpbHRl\nclZhbHVlIGxocywgRmlsdGVyVmFsdWUgcmhzKSB7CiAgICAgICAgYXBwZW5k\nWG1sRXhpc3RzKGJ1ZiwgbGhzKTsKICAgICAgICAKICAgICAgICBidWYuYXBw\nZW5kKCIgIikuYXBwZW5kKG9wKS5hcHBlbmQoIiAiKTsKICAgICAgICAKICAg\nICAgICBidWYuYXBwZW5kKCIkIikuYXBwZW5kKHJocy5nZXRDb2x1bW5BbGlh\ncygKICAgICAgICAgICAgcmhzLmdldEZpZWxkTWFwcGluZygpLmdldENvbHVt\nbnMoKVswXSkpLgogICAgICAgICAgICBhcHBlbmQoIi8qLyIpOwogICAgICAg\nIHJocy5hcHBlbmRUbyhidWYpOwogICAgICAgIAogICAgICAgIGJ1Zi5hcHBl\nbmQoIl0nIFBBU1NJTkcgIik7CiAgICAgICAgYXBwZW5kWG1sVmFyKGJ1Ziwg\nbGhzKTsKICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgIGFwcGVu\nZFhtbFZhcihidWYsIHJocyk7CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwog\nICAgfQogICAgCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kWG1sVmFyKFNRTEJ1\nZmZlciBidWYsIEZpbHRlclZhbHVlIHZhbCkgewogICAgICAgIGJ1Zi5hcHBl\nbmQodmFsLmdldENvbHVtbkFsaWFzKAogICAgICAgICAgICB2YWwuZ2V0Rmll\nbGRNYXBwaW5nKCkuZ2V0Q29sdW1ucygpWzBdKSkuCiAgICAgICAgICAgIGFw\ncGVuZCgiIEFTICIpLgogICAgICAgICAgICBhcHBlbmQoIlwiIikuYXBwZW5k\nKHZhbC5nZXRDb2x1bW5BbGlhcygKICAgICAgICAgICAgdmFsLmdldEZpZWxk\nTWFwcGluZygpLmdldENvbHVtbnMoKVswXSkpLgogICAgICAgICAgICBhcHBl\nbmQoIlwiIik7ICAgICAgICAKICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lk\nIGFwcGVuZFhtbEV4aXN0cyhTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSB2\nYWwpIHsKICAgICAgICBidWYuYXBwZW5kKCJYTUxFWElTVFMoJyIpOwogICAg\nICAgIGJ1Zi5hcHBlbmQoIiQiKS5hcHBlbmQodmFsLmdldENvbHVtbkFsaWFz\nKAogICAgICAgICAgICB2YWwuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0Q29sdW1u\ncygpWzBdKSkuCiAgICAgICAgICAgIGFwcGVuZCgiLypbIik7CiAgICAgICAg\ndmFsLmFwcGVuZFRvKGJ1Zik7ICAgICAgICAKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBhZGQgQ0FTVCBmb3IgYSBzY2FsYXIgZnVuY3Rpb24gd2hlcmUg\nb3BlcmFuZCBpcyBhIHBhcmFtCiAgICAgKiAKICAgICAqIEBwYXJhbSBmdW5j\nIG9yaWdpbmFsIHN0cmluZwogICAgICogQHBhcmFtIHRhcmdldCBzdWJzdHJp\nbmcgdG8gbG9vayBmb3IKICAgICAqIEBwYXJhbSBhc1N0cmluZyAKICAgICAq\nIEByZXR1cm4gdXBkYXRlZCBzdHJpbmcgKGZ1bmMpCiAgICAgKi8KICAgIHBy\naXZhdGUgU3RyaW5nIGFkZENhc3RBc1N0cmluZyhTdHJpbmcgZnVuYywgU3Ry\naW5nIHRhcmdldCwgCiAgICAgICAgICAgIFN0cmluZyBhc1N0cmluZykgewog\nICAgICAgIFN0cmluZyBmc3RyaW5nID0gZnVuYzsKICAgICAgICBpZiAoZnVu\nYy5pbmRleE9mKHRhcmdldCkgIT0gLTEpCiAgICAgICAgICAgIGZzdHJpbmcg\nPSBTdHJpbmdzLnJlcGxhY2UoCiAgICAgICAgICAgICAgICBmdW5jLCB0YXJn\nZXQsICJDQVNUKCIgKyB0YXJnZXQgKyBhc1N0cmluZyArICIpIik7CiAgICAg\nICAgcmV0dXJuIGZzdHJpbmc7CiAgICB9CgogICAgLyoqCiAgICAgKiBhZGQg\nQ0FTVCBmb3IgYSBmdW5jdGlvbiBvcGVyYXRvciB3aGVyZSBvcGVyYW5kIGlz\nIGEgcGFyYW0KICAgICAqIAogICAgICogQHBhcmFtIGZ1bmMgZnVuY3Rpb24g\nbmFtZQogICAgICogQHBhcmFtIHZhbCB0eXBlCiAgICAgKiBAcmV0dXJuIHVw\nZGF0ZWQgc3RyaW5nIChmdW5jKQogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGFkZENhc3RBc1R5cGUoU3RyaW5nIGZ1bmMsIFZhbCB2YWwpIHsKICAgICAg\nICBTdHJpbmcgZnN0cmluZyA9IG51bGw7CiAgICAgICAgU3RyaW5nIHR5cGUg\nPSBnZXRUeXBlTmFtZShnZXRKREJDVHlwZShKYXZhVHlwZXMuZ2V0VHlwZUNv\nZGUodmFsCiAgICAgICAgICAgIC5nZXRUeXBlKCkpLCBmYWxzZSkpOwogICAg\nICAgIGlmIChTdHJpbmcuY2xhc3MuZXF1YWxzKHZhbC5nZXRUeXBlKCkpKQog\nICAgICAgICAgICB0eXBlID0gdHlwZSArICIoIiArIGNoYXJhY3RlckNvbHVt\nblNpemUgKyAiKSI7CiAgICAgICAgZnN0cmluZyA9ICJDQVNUKD8gQVMgIiAr\nIHR5cGUgKyAiKSI7CiAgICAgICAgcmV0dXJuIGZzdHJpbmc7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGJhdGNoIGxpbWl0LiBJZiB0aGUg\nYmF0Y2hMaW1pdCBpcyAtMSwgY2hhbmdlIGl0IHRvIDEwMCBmb3IKICAgICAq\nIGJlc3QgcGVyZm9ybWFuY2UKICAgICAqLwogICAgcHVibGljIGludCBnZXRC\nYXRjaExpbWl0KCkgewogICAgICAgIGludCBsaW1pdCA9IHN1cGVyLmdldEJh\ndGNoTGltaXQoKTsKICAgICAgICBpZiAobGltaXQgPT0gVU5MSU1JVEVEKSB7\nCiAgICAgICAgICAgIGxpbWl0ID0gZGVmYXVsdEJhdGNoTGltaXQ7CiAgICAg\nICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgIGxvZy50cmFjZShfbG9jLmdldCgiYmF0Y2hfdW5saW1pdCIsIFN0cmlu\nZy52YWx1ZU9mKGxpbWl0KSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nbGltaXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvcnJl\nY3QgQ0FTVCBmdW5jdGlvbiBzeW50YXgKICAgICAqIAogICAgICogQHBhcmFt\nIHZhbCBvcGVyYW5kIG9mIGNhc3QKICAgICAqIEBwYXJhbSBmdW5jIG9yaWdp\nbmFsIHN0cmluZwogICAgICogQHJldHVybiBhIFN0cmluZyB3aXRoIHRoZSBj\nb3JyZWN0IENBU1QgZnVuY3Rpb24gc3ludGF4CiAgICAgKi8KICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0Q2FzdEZ1bmN0aW9uKFZhbCB2YWwsIFN0cmluZyBmdW5j\nKSB7CiAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIExpdCB8fCB2YWwgaW5z\ndGFuY2VvZiBQYXJhbSkgewogICAgICAgICAgICBpZiAoZnVuYy5pbmRleE9m\nKCJWQVJDSEFSIikgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGZ1bmMgPSBh\nZGRDYXN0QXNTdHJpbmcoZnVuYywgInswfSIsICIgQVMgVkFSQ0hBUigiICsg\ndmFyY2hhckNhc3RMZW5ndGggKyAiKSIpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmdW5jOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBjb3JyZWN0IENBU1QgZnVuY3Rpb24gc3ludGF4CiAg\nICAgKiAKICAgICAqIEBwYXJhbSB2YWwgb3BlcmFuZCBvZiBjYXN0CiAgICAg\nKiBAcGFyYW0gZnVuYyBvcmlnaW5hbCBzdHJpbmcKICAgICAqIEBwYXJhbSBj\nb2wgZGF0YWJhc2UgY29sdW1uCiAgICAgKiBAcmV0dXJuIGEgU3RyaW5nIHdp\ndGggdGhlIGNvcnJlY3QgQ0FTVCBmdW5jdGlvbiBzeW50YXgKICAgICAqLwog\nICAgcHVibGljIFN0cmluZyBnZXRDYXN0RnVuY3Rpb24oVmFsIHZhbCwgU3Ry\naW5nIGZ1bmMsIENvbHVtbiBjb2wpIHsKICAgICAgICBib29sZWFuIGRvQ2Fz\ndCA9IGZhbHNlOwogICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBMaXQgfHwg\ndmFsIGluc3RhbmNlb2YgUGFyYW0pIHsKICAgICAgICAgICAgZG9DYXN0ID0g\ndHJ1ZTsKICAgICAgICB9CiAgICAgICAgLy8gY2FzdCBhbnl0aGluZyBub3Qg\nYWxyZWFkeSBhIFZBUkNIQVIgdG8gVkFSQ0hBUgogICAgICAgIGlmIChjb2wu\nZ2V0VHlwZSgpICE9IFR5cGVzLlZBUkNIQVIpIHsKICAgICAgICAgICAgZG9D\nYXN0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGRvQ2FzdCA9PSB0\ncnVlKSB7CiAgICAgICAgICAgIGlmIChmdW5jLmluZGV4T2YoIlZBUkNIQVIi\nKSA9PSAtMSkgewogICAgICAgICAgICAgICAgZnVuYyA9IGFkZENhc3RBc1N0\ncmluZyhmdW5jLCAiezB9IiwgIiBBUyBWQVJDSEFSKCIgKyB2YXJjaGFyQ2Fz\ndExlbmd0aCArICIpIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGZ1bmM7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5kZXhP\nZihTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSBzdHIsIEZpbHRlclZhbHVl\nIGZpbmQsCiAgICAgICAgICAgIEZpbHRlclZhbHVlIHN0YXJ0KSB7CiAgICAg\nICAgaWYgKGZpbmQuZ2V0VmFsdWUoKSAhPSBudWxsKSB7IC8vIG5vbiBjb25z\ndGFudHMKICAgICAgICAgICAgYnVmLmFwcGVuZCgiKExPQ0FURShDQVNUKCgi\nKTsKICAgICAgICAgICAgZmluZC5hcHBlbmRUbyhidWYpOwogICAgICAgICAg\nICBidWYuYXBwZW5kKCIpIEFTIFZBUkNIQVIoMTAwMCkpLCAiKTsKICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICAvLyB0aGlzIGlzIGEgY29uc3RhbnQK\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiKExPQ0FURSgiKTsKICAgICAgICAg\nICAgZmluZC5hcHBlbmRUbyhidWYpOwogICAgICAgICAgICBidWYuYXBwZW5k\nKCIsICIpOwogICAgICAgIH0KICAgICAgICBpZiAoc3RyLmdldFZhbHVlKCkg\nIT0gbnVsbCkgewogICAgICAgICAgICBidWYuYXBwZW5kKCJDQVNUKCgiKTsK\nICAgICAgICAgICAgc3RyLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIikgQVMgVkFSQ0hBUigxMDAwKSkiKTsKICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICBzdHIuYXBwZW5kVG8oYnVmKTsKICAgICAgICB9\nCiAgICAgICAgaWYgKHN0YXJ0ICE9IG51bGwpIHsKICAgICAgICAgICAgaWYg\nKHN0YXJ0LmdldFZhbHVlKCkgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiLCBDQVNUKCgiKTsKICAgICAgICAgICAgICAgIHN0YXJ0\nLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIp\nIEFTIElOVEVHRVIpICsgMSIpOwogICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgICAg\nIHN0YXJ0LmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgYnVmLmFwcGVuZCgiKSAtIDEpIik7CiAgICB9CiAgICAKICAg\nIC8qKiAKICAgICAqIENhc3QgdGhlIHNwZWNpZmllZCB2YWx1ZSB0byB0aGUg\nc3BlY2lmaWVkIHR5cGUuCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUg\nYnVmZmVyIHRvIGFwcGVuZCB0aGUgY2FzdCB0bwogICAgICogQHBhcmFtIHZh\nbCB0aGUgdmFsdWUgdG8gY2FzdAogICAgICogQHBhcmFtIHR5cGUgdGhlIHR5\ncGUgb2YgdGhlIGNhc2UsIGUuZy4ge0BsaW5rIFR5cGVzI05VTUVSSUN9CiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGFwcGVuZENhc3QoU1FMQnVmZmVyIGJ1\nZiwgRmlsdGVyVmFsdWUgdmFsLCBpbnQgdHlwZSkgewoKICAgICAgICAvLyBD\nb252ZXJ0IHRoZSBjYXN0IGZ1bmN0aW9uOiAiQ0FTVCh7MH0gQVMgezF9KSIK\nICAgICAgICBpbnQgZmlyc3RQYXJhbSA9IGNhc3RGdW5jdGlvbi5pbmRleE9m\nKCJ7MH0iKTsKICAgICAgICBTdHJpbmcgcHJlID0gY2FzdEZ1bmN0aW9uLnN1\nYnN0cmluZygwLCBmaXJzdFBhcmFtKTsgLy8gIkNBU1QoIgogICAgICAgIFN0\ncmluZyBtaWQgPSBjYXN0RnVuY3Rpb24uc3Vic3RyaW5nKGZpcnN0UGFyYW0g\nKyAzKTsKICAgICAgICBpbnQgc2Vjb25kUGFyYW0gPSBtaWQuaW5kZXhPZigi\nezF9Iik7CiAgICAgICAgU3RyaW5nIHBvc3Q7CiAgICAgICAgaWYgKHNlY29u\nZFBhcmFtID4gLTEpIHsKICAgICAgICAgICAgcG9zdCA9IG1pZC5zdWJzdHJp\nbmcoc2Vjb25kUGFyYW0gKyAzKTsgLy8gIikiCiAgICAgICAgICAgIG1pZCA9\nIG1pZC5zdWJzdHJpbmcoMCwgc2Vjb25kUGFyYW0pOyAvLyAiIEFTICIKICAg\nICAgICB9IGVsc2UKICAgICAgICAgICAgcG9zdCA9ICIiOwoKICAgICAgICAv\nLyBObyBuZWVkIHRvIGFkZCBDQVNUIGlmIHRoZSB2YWx1ZSBpcyBhIGNvbnN0\nYW50CiAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIExpdCB8fCB2YWwgaW5z\ndGFuY2VvZiBQYXJhbSkgewogICAgICAgICAgICBidWYuYXBwZW5kKHByZSk7\nCiAgICAgICAgICAgIHZhbC5hcHBlbmRUbyhidWYpOwogICAgICAgICAgICBi\ndWYuYXBwZW5kKG1pZCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0VHlw\nZU5hbWUodHlwZSkpOwogICAgICAgICAgICBhcHBlbmRMZW5ndGgoYnVmLCB0\neXBlKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChwb3N0KTsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICB2YWwuYXBwZW5kVG8oYnVmKTsKICAgICAg\nICAgICAgU3RyaW5nIHNxbFN0cmluZyA9IGJ1Zi5nZXRTUUwoZmFsc2UpOwog\nICAgICAgICAgICBpZiAoc3FsU3RyaW5nLmVuZHNXaXRoKCI/IikpIHsKICAg\nICAgICAgICAgICAgIC8vIGNhc2UgIig/IiAtIGNvbnZlcnQgdG8gIkNBU1Qo\nPyBBUyB0eXBlIgogICAgICAgICAgICAgICAgU3RyaW5nIHR5cGVOYW1lID0g\nZ2V0VHlwZU5hbWUodHlwZSk7CiAgICAgICAgICAgICAgICBpZiAoU3RyaW5n\nLmNsYXNzLmVxdWFscyh2YWwuZ2V0VHlwZSgpKSkKICAgICAgICAgICAgICAg\nICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lICsgIigiICsgY2hhcmFjdGVyQ29s\ndW1uU2l6ZSArICIpIjsKICAgICAgICAgICAgICAgIFN0cmluZyBzdHIgPSAi\nQ0FTVCg/IEFTICIgKyB0eXBlTmFtZSArICIpIjsKICAgICAgICAgICAgICAg\nIGJ1Zi5yZXBsYWNlU3FsU3RyaW5nKHNxbFN0cmluZy5sZW5ndGgoKSAtIDEs\nCiAgICAgICAgICAgICAgICAgICAgICAgIHNxbFN0cmluZy5sZW5ndGgoKSwg\nc3RyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIENyZWF0ZSBhbiBpbmRleCBpZiBuZWNlc3NhcnkgZm9yIHNvbWUg\nZGF0YWJhc2UgdGFibGVzCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNyZWF0\nZUluZGV4SWZOZWNlc3NhcnkoU2NoZW1hIHNjaGVtYSwgU3RyaW5nIHRhYmxl\nLAogICAgICAgIENvbHVtbiBwa0NvbHVtbikgewogICAgICAgIGNyZWF0ZUlu\nZGV4SWZOZWNlc3Nhcnkoc2NoZW1hLCBEQklkZW50aWZpZXIubmV3VGFibGUo\ndGFibGUpLCAKICAgICAgICAgICAgcGtDb2x1bW4pOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGNyZWF0ZUluZGV4SWZOZWNlc3NhcnkoU2NoZW1hIHNjaGVt\nYSwgREJJZGVudGlmaWVyIHRhYmxlLAogICAgICAgICAgICBDb2x1bW4gcGtD\nb2x1bW4pIHsKICAgICAgICBpZiAoaXNEQjJaT1NWOHhPckxhdGVyKCkpIHsK\nICAgICAgICAgICAgLy8gYnVpbGQgdGhlIGluZGV4IGZvciB0aGUgc2VxdWVu\nY2UgdGFibGVzCiAgICAgICAgICAgIC8vIHRoZSBpbmRleCBuYW1lIHdpbGwg\nYmUgdGhlIGZ1bGx5IHF1YWxpZmllZCB0YWJsZSBuYW1lICsgX0lEWAogICAg\nICAgICAgICBUYWJsZSB0YWIgPSBzY2hlbWEuZ2V0VGFibGUodGFibGUpOwog\nICAgICAgICAgICBEQklkZW50aWZpZXIgaWR4TmFtZSA9IERCSWRlbnRpZmll\nci5hcHBlbmQodGFiLmdldEZ1bGxJZGVudGlmaWVyKCksICJJRFgiKTsKICAg\nICAgICAgICAgSW5kZXggaWR4ID0gdGFiLmFkZEluZGV4KGdldFZhbGlkSW5k\nZXhOYW1lKGlkeE5hbWUsIHRhYikpOwogICAgICAgICAgICBpZHguc2V0VW5p\ncXVlKHRydWUpOwogICAgICAgICAgICBpZHguYWRkQ29sdW1uKHBrQ29sdW1u\nKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIFN0cmluZyBudWxsU2FmZShT\ndHJpbmcgcykgewogICAgICAgIHJldHVybiBzID09IG51bGwgPyAiIiA6IHM7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBpc0Zh\ndGFsRXhjZXB0aW9uKGludCBzdWJ0eXBlLCBTUUxFeGNlcHRpb24gZXgpIHsK\nICAgICAgICBTdHJpbmcgZXJyb3JTdGF0ZSA9IGV4LmdldFNRTFN0YXRlKCk7\nCiAgICAgICAgaW50IGVycm9yQ29kZSA9IGV4LmdldEVycm9yQ29kZSgpOwog\nICAgICAgIGlmIChlcnJvckNvZGUgPT0gLTk1MiAmJiAiNTcwMTQiLmVxdWFs\ncyhlcnJvclN0YXRlKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIC8qCiAgICAgICAgICogQ2hlY2sgaWYgdGhpcyBFeGNlcHRpb24gd2Fz\nIGdlbmVyYXRlZCBieSBhIGxvY2sgdGltZW91dCBleHBpcmF0aW9uLgogICAg\nICAgICAqIFRoZSBmb2xsb3dpbmcgY3JpdGVyaWEgYXJlIHVzZWQgdG8gZGV0\nZXJtaW5lIHRoaXM6CiAgICAgICAgICogCiAgICAgICAgICogREIyIExVVyBJ\nbmZvY2VudGVyOiBTUUxTVEFURT01NzAzMyB3aXRoIHJlYXNvbiBjb2RlICI4\nMCIgaW5kaWNhdGVzCiAgICAgICAgICogdGhlIHN0YXRlbWVudCBmYWlsZWQg\nZHVlIHRvIHRpbWVvdXQuIERCMiBmb3Igei9PUyBTdG9yZWQgUHJvY2VkdXJl\nczoKICAgICAgICAgKiBUaHJvdWdoIHRoZSBDQUxMIGFuZCBCZXlvbmQsIHBh\nZ2UgMTg4OiBBbiBFcnJvckNvZGUgb2YgLTkxMyB3aXRoCiAgICAgICAgICog\nU1FMRVJSIDAwQzkwMDhFIG1lYW5zIGEgdGltZW91dCBoYXMgb2NjdXJyZWQu\nCiAgICAgICAgICovCiAgICAgICAgaWYgKHN1YnR5cGUgPT0gU3RvcmVFeGNl\ncHRpb24uTE9DSyAmJiAiNTcwMzMiLmVxdWFscyhlcnJvclN0YXRlKQogICAg\nICAgICAgICAmJiAoKGV4LmdldE1lc3NhZ2UoKS5pbmRleE9mKCI4MCIpICE9\nIC0xKSAKICAgICAgICAgICAgICAgIHx8IChlcnJvckNvZGUgPT0gLTkxMyAm\nJiBleC5nZXRNZXNzYWdlKCkuY29udGFpbnMoIjAwQzkwMDhFIikpKSkgewog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSAKICAgICAgICBp\nZiAoKHN1YnR5cGUgPT0gU3RvcmVFeGNlcHRpb24uUVVFUlkgJiYgIjU3MDE0\nIi5lcXVhbHMoZXJyb3JTdGF0ZSkgJiYKICAgICAgICAgICAgKGVycm9yQ29k\nZSA9PSAtOTUyIHx8IGVycm9yQ29kZSA9PSAtOTA1KSkpIHsKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3Vw\nZXIuaXNGYXRhbEV4Y2VwdGlvbihzdWJ0eXBlLCBleCk7CiAgICB9CiAgICAK\nICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgc2V0RGVsaW1pdGVk\nQ2FzZShEYXRhYmFzZU1ldGFEYXRhIG1ldGFEYXRhKSB7CiAgICAgICAgZGVs\naW1pdGVkQ2FzZSA9IFNDSEVNQV9DQVNFX1BSRVNFUlZFOwogICAgfQogICAg\nCiAgICAvKioKICAgICAqIFRoZSBUeXBlIDIgSkRCQyBEcml2ZXIgbWF5IHRo\ncm93IGFuIFNRTEV4Y2VwdGlvbiB3aGVuIHByb3ZpZGVkIGEgbm9uLQogICAg\nICogemVybyB0aW1lb3V0IGlmIHdlJ3JlIGNvbm5lY3RlZCB0byBaL09TLiBU\naGUgU1FMRXhjZXB0aW9uIHNob3VsZCBiZQogICAgICogbG9nZ2VkIGJ1dCBu\nb3QgdGhyb3duLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHNldFF1ZXJ5VGltZW91dChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwg\naW50IHRpbWVvdXQpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYoaXNEQjJaT1NWOHhPckxhdGVyKCkpIHsgCiAgICAgICAgICAg\nIHRyeSB7IAogICAgICAgICAgICAgICAgc3VwZXIuc2V0UXVlcnlUaW1lb3V0\nKHN0bW50LCB0aW1lb3V0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBj\nYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGlmIChs\nb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgIGxv\nZy50cmFjZShfbG9jLmdldCgiZXJyb3Itc2V0dGluZy1xdWVyeS10aW1lb3V0\nIiwgdGltZW91dCwKICAgICAgICAgICAgICAgICAgICAgICAgZS5nZXRNZXNz\nYWdlKCkpLCBlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBlbHNlIHsgCiAgICAgICAgICAgIHN1cGVyLnNl\ndFF1ZXJ5VGltZW91dChzdG1udCwgdGltZW91dCk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBh\ncmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRCeXRlcyhQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlk\neCwgYnl0ZVtdIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIGZvciBEQjIsIGlmIHRo\nZSBjb2x1bW4gd2FzIGRlZmluZWQgYXMgQ0hBUiBmb3IgQklUIERBVEEsIHRo\nZW4KICAgICAgICAvLyB3ZSB3YW50IHRvIHVzZSB0aGUgc2V0Qnl0ZXMgaW4g\nc3RlYWQgb2YgdGhlIHNldEJpbmFyeVN0cmVhbQogICAgICAgIGlmICh1c2VT\nZXRCeXRlc0ZvckJsb2JzIAogICAgICAgICAgICAgICAgfHwgKCFEQklkZW50\naWZpZXIuaXNOdWxsKGNvbC5nZXRUeXBlSWRlbnRpZmllcigpKSAmJiAKICAg\nICAgICAgICAgICAgIGNvbC5nZXRUeXBlSWRlbnRpZmllcigpLmdldE5hbWUo\nKS5jb250YWlucygiQklUIERBVEEiKSkpIHsKICAgICAgICAgICAgc3RtbnQu\nc2V0Qnl0ZXMoaWR4LCB2YWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIHNldEJpbmFyeVN0cmVhbShzdG1udCwgaWR4LCBuZXcgQnl0ZUFycmF5\nSW5wdXRTdHJlYW0odmFsKSwgdmFsLmxlbmd0aCwgY29sKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQg\nY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAg\nICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIGJ5dGVbXSBnZXRC\neXRlcyhSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHVzZUdldEJ5dGVzRm9yQmxv\nYnMpIHsKICAgICAgICAgICAgcmV0dXJuIHJzLmdldEJ5dGVzKGNvbHVtbik7\nCiAgICAgICAgfQogICAgICAgIGlmICh1c2VHZXRPYmplY3RGb3JCbG9icykg\newogICAgICAgICAgICByZXR1cm4gKGJ5dGVbXSkgcnMuZ2V0T2JqZWN0KGNv\nbHVtbik7CiAgICAgICAgfQoKICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHdl\nIGRvbid0IGhhdmUgYW55IGlkZWEgaWYgdGhlIERCMiBjb2x1bW4gd2FzIGRl\nZmluZWQgYXMKICAgICAgICAvLyAgICAgYSBibG9iIG9yIGlmIGl0IHdhcyBk\nZWZpbmVkIGFzIENIQVIgZm9yIEJJVCBEQVRBLgogICAgICAgIC8vIEZpcnN0\nIHRyeSBhcyBhIGJsb2IsIGlmIHRoYXQgZG9lc24ndCB3b3JrLCB0aGVuIHRy\neSBhcyBDSEFSIGZvciBCSVQgREFUQQogICAgICAgIC8vIElmIHRoYXQgZG9l\nc24ndCB3b3JrLCB0aGVuIGdvIGFoZWFkIGFuZCB0aHJvdyB0aGUgZmlyc3Qg\nZXhjZXB0aW9uCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQmxvYiBibG9i\nID0gZ2V0QmxvYihycywgY29sdW1uKTsKICAgICAgICAgICAgaWYgKGJsb2Ig\nPT0gbnVsbCkgewogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGludCBsZW5ndGgg\nPSAoaW50KSBibG9iLmxlbmd0aCgpOwogICAgICAgICAgICBpZiAobGVuZ3Ro\nID09IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gYmxvYi5n\nZXRCeXRlcygxLCBsZW5ndGgpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAo\nU1FMRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIHJldHVybiBycy5nZXRCeXRlcyhjb2x1bW4pOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGNhdGNoIChTUUxFeGNlcHRpb24gZTIpIHsKICAg\nICAgICAgICAgICAgIHRocm93IGU7ICAgICAgICAgICAgICAgIAogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

