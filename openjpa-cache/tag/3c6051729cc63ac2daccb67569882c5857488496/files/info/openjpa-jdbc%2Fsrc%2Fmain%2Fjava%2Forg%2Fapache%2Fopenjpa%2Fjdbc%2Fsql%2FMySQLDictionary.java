{"sha":"ba30cb0e70f12c84a14623977a6703701fa80352","node_id":"MDQ6QmxvYjIwNjM2NDpiYTMwY2IwZTcwZjEyYzg0YTE0NjIzOTc3YTY3MDM3MDFmYTgwMzUy","size":17979,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ba30cb0e70f12c84a14623977a6703701fa80352","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBq\nYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsK\naW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2\nYS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2\nYS51dGlsLlNldDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5T\ndHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlk\nZW50aWZpZXIuREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRmls\ndGVyVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zY2hlbWEuUHJpbWFyeUtleTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLlN0b3JlRXhjZXB0aW9uOwoKLyoqCiAqIERpY3Rpb25hcnkgZm9y\nIE15U1FMLgogKi8KcHVibGljIGNsYXNzIE15U1FMRGljdGlvbmFyeQogICAg\nZXh0ZW5kcyBEQkRpY3Rpb25hcnkgewoKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIFNFTEVDVF9ISU5UID0gIm9wZW5qcGEuaGludC5NeVNRTFNl\nbGVjdEhpbnQiOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIERF\nTElNSVRFUl9CQUNLX1RJQ0sgPSAiYCI7CiAgICAKICAgIC8qKgogICAgICog\nVGhlIE15U1FMIHRhYmxlIHR5cGUgdG8gdXNlIHdoZW4gY3JlYXRpbmcgdGFi\nbGVzOyBkZWZhdWx0cyB0byBpbm5vZGIuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgdGFibGVUeXBlID0gImlubm9kYiI7CgogICAgLyoqCiAgICAgKiBX\naGV0aGVyIHRvIHVzZSBjbG9iczsgZGVmYXVsdHMgdG8gdHJ1ZS4gU2V0IHRo\naXMgdG8gZmFsc2UgaWYgeW91IGhhdmUgYW4KICAgICAqIG9sZCB2ZXJzaW9u\nIG9mIE15U1FMIHdoaWNoIGRvZXMgbm90IGhhbmRsZSBjbG9icyBwcm9wZXJs\neS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gdXNlQ2xvYnMgPSB0cnVl\nOwoKICAgIC8qKgogICAgICogV2hldGhlciB0aGUgZHJpdmVyIGF1dG9tYXRp\nY2FsbHkgZGVzZXJpYWxpemVzIGJsb2JzLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBkcml2ZXJEZXNlcmlhbGl6ZXNCbG9icyA9IGZhbHNlOwoKICAg\nIC8qKgogICAgICogV2hldGhlciB0byBpbmxpbmUgbXVsdGktdGFibGUgYnVs\nay1kZWxldGUgb3BlcmF0aW9ucyBpbnRvIE15U1FMJ3MgCiAgICAgKiBjb21i\naW5lZCA8Y29kZT5ERUxFVEUgRlJPTSBmb28sIGJhciwgYmF6PC9jb2RlPiBz\neW50YXguIAogICAgICogRGVmYXVsdHMgdG8gZmFsc2UsIHNpbmNlIHRoaXMg\nbWF5IGZhaWwgaW4gdGhlIHByZXNlbmNlIG9mIElubm9EQiB0YWJsZXMKICAg\nICAqIHdpdGggZm9yZWlnbiBrZXlzLgogICAgICogQHNlZSBodHRwOi8vZGV2\nLm15c3FsLmNvbS9kb2MvcmVmbWFuLzUuMC9lbi9kZWxldGUuaHRtbAogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBvcHRpbWl6ZU11bHRpVGFibGVEZWxl\ndGVzID0gZmFsc2U7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcg\ndGlueUJsb2JUeXBlTmFtZSA9ICJUSU5ZQkxPQiI7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBtZWRpdW1CbG9iVHlwZU5hbWUgPSAiTUVESVVN\nQkxPQiI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBsb25nQmxv\nYlR5cGVOYW1lID0gIkxPTkdCTE9CIjsKCiAgICBwdWJsaWMgTXlTUUxEaWN0\naW9uYXJ5KCkgewogICAgICAgIHBsYXRmb3JtID0gIk15U1FMIjsKICAgICAg\nICB2YWxpZGF0aW9uU1FMID0gIlNFTEVDVCBOT1coKSI7CiAgICAgICAgZGlz\ndGluY3RDb3VudENvbHVtblNlcGFyYXRvciA9ICIsIjsKCiAgICAgICAgc3Vw\ncG9ydHNEZWZlcnJlZENvbnN0cmFpbnRzID0gZmFsc2U7CiAgICAgICAgY29u\nc3RyYWludE5hbWVNb2RlID0gQ09OU19OQU1FX01JRDsKICAgICAgICBzdXBw\nb3J0c011bHRpcGxlTm9udHJhbnNhY3Rpb25hbFJlc3VsdFNldHMgPSBmYWxz\nZTsKICAgICAgICByZXF1aXJlc0FsaWFzRm9yU3Vic2VsZWN0ID0gdHJ1ZTsg\nLy8gbmV3IHZlcnNpb25zCiAgICAgICAgcmVxdWlyZXNUYXJnZXRGb3JEZWxl\ndGUgPSB0cnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0U3RhcnRJbmRleCA9\nIHRydWU7CiAgICAgICAgc3VwcG9ydHNTZWxlY3RFbmRJbmRleCA9IHRydWU7\nCgogICAgICAgIGNvbmNhdGVuYXRlRnVuY3Rpb24gPSAiQ09OQ0FUKHswfSx7\nMX0pIjsKCiAgICAgICAgbWF4VGFibGVOYW1lTGVuZ3RoID0gNjQ7CiAgICAg\nICAgbWF4Q29sdW1uTmFtZUxlbmd0aCA9IDY0OwogICAgICAgIG1heEluZGV4\nTmFtZUxlbmd0aCA9IDY0OwogICAgICAgIG1heENvbnN0cmFpbnROYW1lTGVu\nZ3RoID0gNjQ7CiAgICAgICAgbWF4SW5kZXhlc1BlclRhYmxlID0gMzI7CiAg\nICAgICAgc2NoZW1hQ2FzZSA9IFNDSEVNQV9DQVNFX1BSRVNFUlZFOwoKICAg\nICAgICBzdXBwb3J0c0F1dG9Bc3NpZ24gPSB0cnVlOwogICAgICAgIGxhc3RH\nZW5lcmF0ZWRLZXlRdWVyeSA9ICJTRUxFQ1QgTEFTVF9JTlNFUlRfSUQoKSI7\nCiAgICAgICAgYXV0b0Fzc2lnbkNsYXVzZSA9ICJBVVRPX0lOQ1JFTUVOVCI7\nCgogICAgICAgIGNsb2JUeXBlTmFtZSA9ICJURVhUIjsKICAgICAgICBsb25n\nVmFyY2hhclR5cGVOYW1lID0gIlRFWFQiOwogICAgICAgIGxvbmdWYXJiaW5h\ncnlUeXBlTmFtZSA9ICJMT05HIFZBUkJJTkFSWSI7CiAgICAgICAgdGltZXN0\nYW1wVHlwZU5hbWUgPSAiREFURVRJTUUiOwogICAgICAgIHhtbFR5cGVOYW1l\nID0gIlRFWFQiOwogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFs\nbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkJP\nT0wiLCAiTE9ORyBWQVJCSU5BUlkiLCAiTUVESVVNQkxPQiIsICJMT05HQkxP\nQiIsCiAgICAgICAgICAgICJUSU5ZQkxPQiIsICJMT05HIFZBUkNIQVIiLCAi\nTUVESVVNVEVYVCIsICJMT05HVEVYVCIsICJURVhUIiwKICAgICAgICAgICAg\nIlRJTllURVhUIiwgIkRPVUJMRSBQUkVDSVNJT04iLCAiRU5VTSIsICJTRVQi\nLCAiREFURVRJTUUiLAogICAgICAgIH0pKTsKICAgICAgICByZXNlcnZlZFdv\ncmRTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdewogICAg\nICAgICAgICAiQVVUT19JTkNSRU1FTlQiLCAiQklOQVJZIiwgIkJMT0IiLCAi\nQ0hBTkdFIiwgIkVOVU0iLCAiSU5GSUxFIiwKICAgICAgICAgICAgIklOVDEi\nLCAiSU5UMiIsICJJTlQ0IiwgIkZMT0FUMSIsICJGTE9BVDIiLCAiRkxPQVQ0\nIiwgIkxPQUQiLAogICAgICAgICAgICAiTUVESVVNSU5UIiwgIk9VVEZJTEUi\nLCAiUkVQTEFDRSIsICJTVEFSVElORyIsICJURVhUIiwgIlVOU0lHTkVEIiwg\nCiAgICAgICAgICAgICJaRVJPRklMTCIsCiAgICAgICAgfSkpOwoKICAgICAg\nICAvLyByZXNlcnZlZFdvcmRTZXQgc3Vic2V0IHRoYXQgQ0FOTk9UIGJlIHVz\nZWQgYXMgdmFsaWQgY29sdW1uIG5hbWVzCiAgICAgICAgLy8gKGkuZS4sIHdp\ndGhvdXQgc3Vycm91bmRpbmcgdGhlbSB3aXRoIGRvdWJsZS1xdW90ZXMpCiAg\nICAgICAgaW52YWxpZENvbHVtbldvcmRTZXQuYWRkQWxsKEFycmF5cy5hc0xp\nc3QobmV3IFN0cmluZ1tdewogICAgICAgICAgICAiQUREIiwgIkFMTCIsICJB\nTFRFUiIsICJBTkQiLCAiQVMiLCAiQVNDIiwgIkJFVFdFRU4iLCAiQklOQVJZ\nIiwKICAgICAgICAgICAgIkJMT0IiLCAiQk9USCIsICJCWSIsICJDQVNDQURF\nIiwgIkNBU0UiLCAiQ0hBTkdFIiwgIkNIQVIiLCAKICAgICAgICAgICAgIkNI\nQVJBQ1RFUiIsICJDSEVDSyIsICJDT0xMQVRFIiwgIkNPTFVNTiIsICJDT05T\nVFJBSU5UIiwgIkNPTlRJTlVFIiwKICAgICAgICAgICAgIkNPTlZFUlQiLCAi\nQ1JFQVRFIiwgIkNST1NTIiwgIkNVUlJFTlRfREFURSIsICJDVVJSRU5UX1RJ\nTUUiLAogICAgICAgICAgICAiQ1VSUkVOVF9USU1FU1RBTVAiLCAiQ1VSUkVO\nVF9VU0VSIiwgIkNVUlNPUiIsICJERUMiLCAiREVDSU1BTCIsCiAgICAgICAg\nICAgICJERUNMQVJFIiwgIkRFRkFVTFQiLCAiREVMRVRFIiwgIkRFU0MiLCAi\nREVTQ1JJQkUiLCAiRElTVElOQ1QiLAogICAgICAgICAgICAiRE9VQkxFIiwg\nIkRST1AiLCAiRUxTRSIsICJFTkQtRVhFQyIsICJFWElTVFMiLCAiRkFMU0Ui\nLCAiRkVUQ0giLAogICAgICAgICAgICAiRkxPQVQiLCAiRkxPQVQ0IiwgIkZP\nUiIsICJGT1JFSUdOIiwgIkZST00iLCAiR1JBTlQiLCAiR1JPVVAiLAogICAg\nICAgICAgICAiSEFWSU5HIiwgIklOIiwgIklORklMRSIsICJJTk5FUiIsICJJ\nTlNFTlNJVElWRSIsICJJTlNFUlQiLCAiSU5UIiwKICAgICAgICAgICAgIklO\nVDEiLCAiSU5UMiIsICJJTlQ0IiwgIklOVEVHRVIiLCAiSU5URVJWQUwiLCAi\nSU5UTyIsICJJUyIsICJKT0lOIiwKICAgICAgICAgICAgIktFWSIsICJMRUFE\nSU5HIiwgIkxFRlQiLCAiTElLRSIsICJMT0FEIiwgIk1BVENIIiwgIk1FRElV\nTUlOVCIsCiAgICAgICAgICAgICJOQVRVUkFMIiwgIk5PVCIsICJOVUxMIiwg\nIk5VTUVSSUMiLCAiT04iLCAiT1BUSU9OIiwgIk9SIiwgIk9SREVSIiwKICAg\nICAgICAgICAgIk9VVEVSIiwgIk9VVEZJTEUiLCAiUFJFQ0lTSU9OIiwgIlBS\nSU1BUlkiLCAiUFJPQ0VEVVJFIiwgIlJFQUQiLAogICAgICAgICAgICAiUkVB\nTCIsICJSRUZFUkVOQ0VTIiwgIlJFUExBQ0UiLCAiUkVTVFJJQ1QiLCAiUkVW\nT0tFIiwgIlJJR0hUIiwKICAgICAgICAgICAgIlNDSEVNQSIsICJTRUxFQ1Qi\nLCAiU0VUIiwgIlNNQUxMSU5UIiwgIlNRTCIsICJTUUxTVEFURSIsCiAgICAg\nICAgICAgICJTVEFSVElORyIsICJUQUJMRSIsICJUSEVOIiwgIlRPIiwgIlRS\nQUlMSU5HIiwgIlRSVUUiLCAiVU5JT04iLAogICAgICAgICAgICAiVU5JUVVF\nIiwgIlVOU0lHTkVEIiwgIlVQREFURSIsICJVU0FHRSIsICJVU0lORyIsICJW\nQUxVRVMiLAogICAgICAgICAgICAiVkFSQ0hBUiIsICJWQVJZSU5HIiwgIldI\nRU4iLCAiV0hFUkUiLCAiV0lUSCIsICJXUklURSIsICJaRVJPRklMTCIsCiAg\nICAgICAgfSkpOwoKICAgICAgICAvLyBNeVNRTCByZXF1aXJlcyBkb3VibGUt\nZXNjYXBlIGZvciBzdHJpbmdzCiAgICAgICAgc2VhcmNoU3RyaW5nRXNjYXBl\nID0gIlxcXFwiOwoKICAgICAgICB0eXBlTW9kaWZpZXJTZXQuYWRkQWxsKEFy\ncmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdIHsgIlVOU0lHTkVEIiwKICAgICAg\nICAgICAgIlpFUk9GSUxMIiB9KSk7CgogICAgICAgIHNldExlYWRpbmdEZWxp\nbWl0ZXIoREVMSU1JVEVSX0JBQ0tfVElDSyk7CiAgICAgICAgc2V0VHJhaWxp\nbmdEZWxpbWl0ZXIoREVMSU1JVEVSX0JBQ0tfVElDSyk7CiAgICAgICAgCiAg\nICAgICAgZml4ZWRTaXplVHlwZU5hbWVTZXQucmVtb3ZlKCJOVU1FUklDIik7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjb25uZWN0\nZWRDb25maWd1cmF0aW9uKENvbm5lY3Rpb24gY29ubikgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ29uZmlndXJhdGlv\nbihjb25uKTsKCiAgICAgICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRhRGF0YSA9\nIGNvbm4uZ2V0TWV0YURhdGEoKTsKICAgICAgICBpbnQgbWFqID0gMDsKICAg\nICAgICBpbnQgbWluID0gMDsKICAgICAgICBpZiAoaXNKREJDMykgewogICAg\nICAgICAgICBtYWogPSBtZXRhRGF0YS5nZXREYXRhYmFzZU1ham9yVmVyc2lv\nbigpOwogICAgICAgICAgICBtaW4gPSBtZXRhRGF0YS5nZXREYXRhYmFzZU1p\nbm9yVmVyc2lvbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAvLyBUaGUgcHJvZHVjdCB2ZXJzaW9uIGxv\nb2tzIGxpa2UgNC4xLjMtbnQgb3IgNS4xLjMwCiAgICAgICAgICAgICAgICBT\ndHJpbmcgcHJvZHVjdFZlcnNpb24gPSBtZXRhRGF0YS5nZXREYXRhYmFzZVBy\nb2R1Y3RWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICBpbnRbXSB2ZXJzaW9u\ncyA9IGdldE1ham9yTWlub3JWZXJzaW9ucyhwcm9kdWN0VmVyc2lvbik7CiAg\nICAgICAgICAgICAgICBtYWogPSB2ZXJzaW9uc1swXTsKICAgICAgICAgICAg\nICAgIG1pbiA9IHZlcnNpb25zWzFdOwogICAgICAgICAgICB9IGNhdGNoIChJ\nbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nLy8gd2UgZG9uJ3QgdW5kZXJzdGFuZCB0aGUgdmVyc2lvbiBmb3JtYXQuCiAg\nICAgICAgICAgICAgICAvLyBUaGF0IGlzIG9rLiBXZSBqdXN0IHRha2UgdGhl\nIGRlZmF1bHQgdmFsdWVzLgogICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dh\ncm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oZS50\nb1N0cmluZygpLCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICBpZiAobWFqIDwgNCB8fCAobWFqID09IDQgJiYgbWluIDwgMSkpIHsKICAg\nICAgICAgICAgc3VwcG9ydHNTdWJzZWxlY3QgPSBmYWxzZTsKICAgICAgICAg\nICAgYWxsb3dzQWxpYXNJbkJ1bGtDbGF1c2UgPSBmYWxzZTsKICAgICAgICAg\nICAgc3VwcG9ydHNGb3JlaWduS2V5c0NvbXBvc2l0ZSA9IGZhbHNlOwogICAg\nICAgIH0KICAgICAgICBpZiAobWFqID4gNSB8fCAobWFqID09IDUgJiYgbWlu\nID49IDEpKQogICAgICAgICAgICBzdXBwb3J0c1hNTENvbHVtbiA9IHRydWU7\nCgogICAgICAgIGlmIChtZXRhRGF0YS5nZXREcml2ZXJNYWpvclZlcnNpb24o\nKSA8IDUpCiAgICAgICAgICAgIGRyaXZlckRlc2VyaWFsaXplc0Jsb2JzID0g\ndHJ1ZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBDb25uZWN0\naW9uIGRlY29yYXRlKENvbm5lY3Rpb24gY29ubikgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGNvbm4gPSBzdXBlci5kZWNvcmF0ZShjb25uKTsK\nICAgICAgICBTdHJpbmcgZHJpdmVyID0gY29uZi5nZXRDb25uZWN0aW9uRHJp\ndmVyTmFtZSgpOwogICAgICAgIGlmICgiY29tLm15c3FsLmpkYmMuUmVwbGlj\nYXRpb25Ecml2ZXIiLmVxdWFscyhkcml2ZXIpKQogICAgICAgICAgICBjb25u\nLnNldFJlYWRPbmx5KHRydWUpOwogICAgICAgIHJldHVybiBjb25uOwogICAg\nfQogICAgCiAgICBwcml2YXRlIHN0YXRpYyBpbnRbXSBnZXRNYWpvck1pbm9y\nVmVyc2lvbnMoU3RyaW5nIHZlcnNpb25TdHIpCiAgICAgICAgdGhyb3dzIEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IGJlZ2luSW5k\nZXggPSAwOwoKICAgICAgICB2ZXJzaW9uU3RyID0gdmVyc2lvblN0ci50cmlt\nKCk7CiAgICAgICAgY2hhcltdIGNoYXJBcnIgPSB2ZXJzaW9uU3RyLnRvQ2hh\nckFycmF5KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjaGFyQXJy\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChDaGFyYWN0ZXIuaXNE\naWdpdChjaGFyQXJyW2ldKSkgewogICAgICAgICAgICAgICAgYmVnaW5JbmRl\neCA9IGk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaW50IGVuZEluZGV4ID0gY2hhckFyci5sZW5n\ndGg7CiAgICAgICAgZm9yIChpbnQgaSA9IGJlZ2luSW5kZXgrMTsgaSA8IGNo\nYXJBcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGNoYXJBcnJb\naV0gIT0gJy4nICYmICFDaGFyYWN0ZXIuaXNEaWdpdChjaGFyQXJyW2ldKSkg\newogICAgICAgICAgICAgICAgZW5kSW5kZXggPSBpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIFN0\ncmluZ1tdIGFyciA9IHZlcnNpb25TdHIuc3Vic3RyaW5nKGJlZ2luSW5kZXgs\nIGVuZEluZGV4KS5zcGxpdCgiXFwuIik7CiAgICAgICAgaWYgKGFyci5sZW5n\ndGggPCAyKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50\nRXhjZXB0aW9uKCk7CgogICAgICAgIGludCBtYWogPSBJbnRlZ2VyLnBhcnNl\nSW50KGFyclswXSk7CiAgICAgICAgaW50IG1pbiA9IEludGVnZXIucGFyc2VJ\nbnQoYXJyWzFdKTsKICAgICAgICByZXR1cm4gbmV3IGludFtde21haiwgbWlu\nfTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmdbXSBn\nZXRDcmVhdGVUYWJsZVNRTChUYWJsZSB0YWJsZSkgewogICAgICAgIFN0cmlu\nZ1tdIHNxbCA9IHN1cGVyLmdldENyZWF0ZVRhYmxlU1FMKHRhYmxlKTsKICAg\nICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkodGFibGVUeXBlKSkKICAg\nICAgICAgICAgc3FsWzBdID0gc3FsWzBdICsgIiBFTkdJTkUgPSAiICsgdGFi\nbGVUeXBlOwogICAgICAgIHJldHVybiBzcWw7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RHJvcEluZGV4U1FMKEluZGV4\nIGluZGV4KSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkRST1Ag\nSU5ERVggIiArIGdldEZ1bGxOYW1lKGluZGV4KSArICIgT04gIgogICAgICAg\nICAgICArIGdldEZ1bGxOYW1lKGluZGV4LmdldFRhYmxlKCksIGZhbHNlKSB9\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIDxjb2RlPkFMVEVSIFRB\nQkxFICZsdDt0YWJsZSBuYW1lJmd0OyBEUk9QIFBSSU1BUlkgS0VZPC9jb2Rl\nPi4KICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nW10g\nZ2V0RHJvcFByaW1hcnlLZXlTUUwoUHJpbWFyeUtleSBwaykgewogICAgICAg\nIGlmIChEQklkZW50aWZpZXIuaXNOdWxsKHBrLmdldElkZW50aWZpZXIoKSkp\nCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAgIHJl\ndHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAgICAgICAg\nICsgZ2V0RnVsbE5hbWUocGsuZ2V0VGFibGUoKSwgZmFsc2UpCiAgICAgICAg\nICAgICsgIiBEUk9QIFBSSU1BUlkgS0VZIiB9OwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIDxjb2RlPkFMVEVSIFRBQkxFICZsdDt0YWJsZSBuYW1l\nJmd0OyBEUk9QIEZPUkVJR04gS0VZCiAgICAgKiAmbHQ7ZmsgbmFtZSZndDs8\nL2NvZGU+LgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJp\nbmdbXSBnZXREcm9wRm9yZWlnbktleVNRTChGb3JlaWduS2V5IGZrLCBDb25u\nZWN0aW9uIGNvbm4pIHsKICAgICAgICBpZiAoREJJZGVudGlmaWVyLmlzTnVs\nbChmay5nZXRJZGVudGlmaWVyKCkpKSB7CiAgICAgICAgICAgIERCSWRlbnRp\nZmllciBma05hbWUgPSBmay5sb2FkSWRlbnRpZmllckZyb21EQih0aGlzLGNv\nbm4pOwogICAgICAgICAgICBTdHJpbmdbXSByZXRWYWwgPSAoZmtOYW1lID09\nIG51bGwpID8gIG5ldyBTdHJpbmdbMF0gOgogICAgICAgICAgICAgICAgbmV3\nIFN0cmluZ1tdeyAiQUxURVIgVEFCTEUgIgogICAgICAgICAgICAgICAgKyBn\nZXRGdWxsTmFtZShmay5nZXRUYWJsZSgpLCBmYWxzZSkKICAgICAgICAgICAg\nICAgICsgIiBEUk9QIEZPUkVJR04gS0VZICIgKyB0b0RCTmFtZShma05hbWUp\nIH07CiAgICAgICAgICAgIHJldHVybiByZXRWYWw7ICAgCiAgICAgICAgfQog\nICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAg\nICAgICAgICAgICsgZ2V0RnVsbE5hbWUoZmsuZ2V0VGFibGUoKSwgZmFsc2Up\nCiAgICAgICAgICAgICsgIiBEUk9QIEZPUkVJR04gS0VZICIgKyB0b0RCTmFt\nZShmay5nZXRJZGVudGlmaWVyKCkpIH07CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0QWRkUHJpbWFyeUtleVNRTChQcmlt\nYXJ5S2V5IHBrKSB7CiAgICAgICAgU3RyaW5nW10gc3FsID0gc3VwZXIuZ2V0\nQWRkUHJpbWFyeUtleVNRTChwayk7CgogICAgICAgIC8vIG15c3FsIHJlcXVp\ncmVzIHRoYXQgYSBjb2x1bW4gYmUgZGVjbGFyZWQgTk9UIE5VTEwgYmVmb3Jl\nCiAgICAgICAgLy8gaXQgY2FuIGJlIG1hZGUgYSBwcmltYXJ5IGtleS4KICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gcGsuZ2V0Q29sdW1ucygpOwogICAgICAg\nIFN0cmluZ1tdIHJldCA9IG5ldyBTdHJpbmdbY29scy5sZW5ndGggKyBzcWwu\nbGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmV0W2ldID0gIkFMVEVSIFRBQkxF\nICIgKyBnZXRGdWxsTmFtZShjb2xzW2ldLmdldFRhYmxlKCksIGZhbHNlKQog\nICAgICAgICAgICAgICAgKyAiIENIQU5HRSAiICsgdG9EQk5hbWUoY29sc1tp\nXS5nZXRJZGVudGlmaWVyKCkpCiAgICAgICAgICAgICAgICArICIgIiArIHRv\nREJOYW1lKGNvbHNbaV0uZ2V0SWRlbnRpZmllcigpKSAvLyBuYW1lIHR3aWNl\nCiAgICAgICAgICAgICAgICArICIgIiArIGdldFR5cGVOYW1lKGNvbHNbaV0p\nICsgIiBOT1QgTlVMTCI7CiAgICAgICAgfQoKICAgICAgICBTeXN0ZW0uYXJy\nYXljb3B5KHNxbCwgMCwgcmV0LCBjb2xzLmxlbmd0aCwgc3FsLmxlbmd0aCk7\nCiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KICAgIAogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RGVsZXRlVGFibGVDb250ZW50c1NR\nTChUYWJsZVtdIHRhYmxlcyxDb25uZWN0aW9uIGNvbm4pIHsKICAgICAgICAv\nLyBteXNxbCA+PSA0IHN1cHBvcnRzIG1vcmUtb3B0aW1hbCBkZWxldGUgc3lu\ndGF4CiAgICAgICAgaWYgKCFvcHRpbWl6ZU11bHRpVGFibGVEZWxldGVzKQog\nICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RGVsZXRlVGFibGVDb250ZW50\nc1NRTCh0YWJsZXMsY29ubik7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAg\nIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3IFN0cmluZ0J1aWxkZXIodGFibGVz\nLmxlbmd0aCAqIDgpOwogICAgICAgICAgICBidWYuYXBwZW5kKCJERUxFVEUg\nRlJPTSAiKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0YWJs\nZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\ndG9EQk5hbWUodGFibGVzW2ldLmdldEZ1bGxJZGVudGlmaWVyKCkpKTsKICAg\nICAgICAgICAgICAgIGlmIChpIDwgdGFibGVzLmxlbmd0aCAtIDEpCiAgICAg\nICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdIHsgYnVmLnRvU3Ry\naW5nKCkgfTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgdm9pZCBhcHBlbmRTZWxlY3RSYW5nZShTUUxCdWZmZXIgYnVm\nLCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAgICAgICBib29sZWFuIHN1YnNl\nbGVjdCkgewogICAgICAgIGJ1Zi5hcHBlbmQoIiBMSU1JVCAiKS5hcHBlbmRW\nYWx1ZShzdGFydCkuYXBwZW5kKCIsICIpOwogICAgICAgIGlmIChlbmQgPT0g\nTG9uZy5NQVhfVkFMVUUpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmRWYWx1ZShM\nb25nLk1BWF9WQUxVRSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBidWYu\nYXBwZW5kVmFsdWUoZW5kIC0gc3RhcnQpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIENvbHVtbiBuZXdDb2x1bW4oUmVzdWx0U2V0IGNv\nbE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nQ29sdW1uIGNvbCA9IHN1cGVyLm5ld0NvbHVtbihjb2xNZXRhKTsKICAgICAg\nICBpZiAoY29sLmlzTm90TnVsbCgpICYmICIwIi5lcXVhbHMoY29sLmdldERl\nZmF1bHRTdHJpbmcoKSkpCiAgICAgICAgICAgIGNvbC5zZXREZWZhdWx0U3Ry\naW5nKG51bGwpOwogICAgICAgIHJldHVybiBjb2w7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgT2JqZWN0IGdldEJsb2JPYmplY3QoUmVzdWx0\nU2V0IHJzLCBpbnQgY29sdW1uLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gaWYgdGhlIHVzZXIg\naGFzIHNldCBhIGdldC1ibG9iIHN0cmF0ZWd5IGV4cGxpY2l0bHkgb3IgdGhl\nIGRyaXZlcgogICAgICAgIC8vIGRvZXMgbm90IGF1dG9tYXRpY2FsbHkgZGVz\nZXJpYWxpemUsIGRlbGVnYXRlIHRvIHN1cGVyCiAgICAgICAgaWYgKHVzZUdl\ndEJ5dGVzRm9yQmxvYnMgfHwgdXNlR2V0T2JqZWN0Rm9yQmxvYnMKICAgICAg\nICAgICAgfHwgIWRyaXZlckRlc2VyaWFsaXplc0Jsb2JzKQogICAgICAgICAg\nICByZXR1cm4gc3VwZXIuZ2V0QmxvYk9iamVjdChycywgY29sdW1uLCBzdG9y\nZSk7CgogICAgICAgIC8vIG1vc3QgbXlzcWwgZHJpdmVycyBkZXNlcmlhbGl6\nZSBvbiBnZXRPYmplY3QKICAgICAgICByZXR1cm4gcnMuZ2V0T2JqZWN0KGNv\nbHVtbik7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGdl\ndFByZWZlcnJlZFR5cGUoaW50IHR5cGUpIHsKICAgICAgICBpZiAodHlwZSA9\nPSBUeXBlcy5DTE9CICYmICF1c2VDbG9icykKICAgICAgICAgICAgcmV0dXJu\nIFR5cGVzLkxPTkdWQVJDSEFSOwogICAgICAgIHJldHVybiBzdXBlci5nZXRQ\ncmVmZXJyZWRUeXBlKHR5cGUpOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEFwcGVuZCBYTUwgY29tcGFyaXNvbi4KICAgICAqIAogICAgICogQHBhcmFt\nIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgog\nICAgICogQHBhcmFtIG9wIHRoZSBjb21wYXJpc29uIG9wZXJhdGlvbiB0byBw\nZXJmb3JtCiAgICAgKiBAcGFyYW0gbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBv\nZiB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFtIHJocyB0aGUgcmlnaHQg\naGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gbGhz\neG1sIGluZGljYXRlcyB3aGV0aGVyIHRoZSBsZWZ0IG9wZXJhbmQgbWFwcyB0\nbyBYTUwKICAgICAqIEBwYXJhbSByaHN4bWwgaW5kaWNhdGVzIHdoZXRoZXIg\ndGhlIHJpZ2h0IG9wZXJhbmQgbWFwcyB0byBYTUwKICAgICAqLwogICAgQE92\nZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRYbWxDb21wYXJpc29uKFNR\nTEJ1ZmZlciBidWYsIFN0cmluZyBvcCwgRmlsdGVyVmFsdWUgbGhzLAogICAg\nICAgIEZpbHRlclZhbHVlIHJocywgYm9vbGVhbiBsaHN4bWwsIGJvb2xlYW4g\ncmhzeG1sKSB7CiAgICAgICAgc3VwZXIuYXBwZW5kWG1sQ29tcGFyaXNvbihi\ndWYsIG9wLCBsaHMsIHJocywgbGhzeG1sLCByaHN4bWwpOwogICAgICAgIGlm\nIChsaHN4bWwpCiAgICAgICAgICAgIGFwcGVuZFhtbFZhbHVlKGJ1ZiwgbGhz\nKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGxocy5hcHBlbmRUbyhidWYp\nOwogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQob3ApLmFwcGVuZCgi\nICIpOwogICAgICAgIGlmIChyaHN4bWwpCiAgICAgICAgICAgIGFwcGVuZFht\nbFZhbHVlKGJ1ZiwgcmhzKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJo\ncy5hcHBlbmRUbyhidWYpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEFw\ncGVuZCBYTUwgY29sdW1uIHZhbHVlIHNvIHRoYXQgaXQgY2FuIGJlIHVzZWQg\naW4gY29tcGFyaXNvbnMuCiAgICAgKiAKICAgICAqIEBwYXJhbSBidWYgdGhl\nIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIHZhbHVlCiAgICAgKiBAcGFyYW0g\ndmFsIHRoZSB2YWx1ZSB0byBiZSB3cml0dGVuCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBhcHBlbmRYbWxWYWx1ZShTUUxCdWZmZXIgYnVmLCBGaWx0ZXJW\nYWx1ZSB2YWwpIHsKICAgICAgICBidWYuYXBwZW5kKCJFeHRyYWN0VmFsdWUo\nIikuCiAgICAgICAgICAgIGFwcGVuZCh2YWwuZ2V0Q29sdW1uQWxpYXModmFs\nLmdldEZpZWxkTWFwcGluZygpLmdldENvbHVtbnMoKVswXSkpLgogICAgICAg\nICAgICBhcHBlbmQoIiwnLyovIik7CiAgICAgICAgdmFsLmFwcGVuZFRvKGJ1\nZik7CiAgICAgICAgYnVmLmFwcGVuZCgiJykiKTsKICAgIH0KICAgIAogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGdldEJhdGNoRmV0Y2hTaXplKGlu\ndCBiYXRjaEZldGNoU2l6ZSkgewogICAgICAgIHJldHVybiBJbnRlZ2VyLk1J\nTl9WQUxVRTsKICAgIH0KCiAgICAvKioKICAgICAqIENoZWNrIHRvIHNlZSBp\nZiB3ZSBoYXZlIHNldCB0aGUge0BsaW5rICNTRUxFQ1RfSElOVH0gaW4gdGhl\nCiAgICAgKiBmZXRjaCBjb25maWd1cmF0aW9uLCBhbmQgaWYgc28sIGFwcGVu\nZCB0aGUgTXlTUUwgaGludCBhZnRlciB0aGUKICAgICAqICJTRUxFQ1QiIHBh\ncnQgb2YgdGhlIHF1ZXJ5LgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0U2VsZWN0T3BlcmF0aW9uKEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICBPYmplY3QgaGludCA9IGZldGNo\nID09IG51bGwgPyBudWxsIDogZmV0Y2guZ2V0SGludChTRUxFQ1RfSElOVCk7\nCiAgICAgICAgU3RyaW5nIHNlbGVjdCA9ICJTRUxFQ1QiOwogICAgICAgIGlm\nIChoaW50ICE9IG51bGwpCiAgICAgICAgICAgIHNlbGVjdCArPSAiICIgKyBo\naW50OwogICAgICAgIHJldHVybiBzZWxlY3Q7CiAgICB9CiAgICAKICAgIEBP\ndmVycmlkZQogICAgcHJvdGVjdGVkIENvbGxlY3Rpb248U3RyaW5nPiBnZXRT\nZWxlY3RUYWJsZUFsaWFzZXMoU2VsZWN0IHNlbCkgewogICAgICAgIFNldDxT\ndHJpbmc+IHJlc3VsdCA9IG5ldyBIYXNoU2V0PFN0cmluZz4oKTsKICAgICAg\nICBMaXN0PFN0cmluZz4gc2VsZWN0cyA9IHNlbC5nZXRJZGVudGlmaWVyQWxp\nYXNlcygpOwogICAgICAgIGZvciAoU3RyaW5nIHMgOiBzZWxlY3RzKSB7CiAg\nICAgICAgICAgIFN0cmluZyB0YWJsZUFsaWFzID0gcy5zdWJzdHJpbmcoMCwg\ncy5pbmRleE9mKCcuJykpOwogICAgICAgICAgICByZXN1bHQuYWRkKHRhYmxl\nQWxpYXMpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAg\nfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBpbnQgbWF0Y2hF\ncnJvclN0YXRlKE1hcDxJbnRlZ2VyLFNldDxTdHJpbmc+PiBlcnJvclN0YXRl\ncywgU1FMRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgaW50IHN0YXRlID0gc3Vw\nZXIubWF0Y2hFcnJvclN0YXRlKGVycm9yU3RhdGVzLCBleCk7CiAgICAgICAg\nLy8gT1BFTkpQQS0xNjE2IC0gU3BlY2lhbCBjYXNlIGZvciBNeVNRTCBub3Qg\ncmV0dXJuaW5nIGEgU1FMU3RhdGUgZm9yIHRpbWVvdXRzCiAgICAgICAgaWYg\nKHN0YXRlID09IFN0b3JlRXhjZXB0aW9uLkdFTkVSQUwgJiYgZXguZ2V0RXJy\nb3JDb2RlKCkgPT0gMCAmJiBleC5nZXRTUUxTdGF0ZSgpID09IG51bGwpIHsK\nICAgICAgICAgICAgLy8gbG9vayBhdCB0aGUgbmVzdGVkIE15U1FMIGV4Y2Vw\ndGlvbiBmb3IgbW9yZSBkZXRhaWxzCiAgICAgICAgICAgIFNRTEV4Y2VwdGlv\nbiBzcWxlID0gZXguZ2V0TmV4dEV4Y2VwdGlvbigpOwogICAgICAgICAgICBp\nZiAoc3FsZSAhPSBudWxsICYmIHNxbGUudG9TdHJpbmcoKS5zdGFydHNXaXRo\nKCJjb20ubXlzcWwuamRiYy5leGNlcHRpb25zLk15U1FMVGltZW91dEV4Y2Vw\ndGlvbiIpKSB7CiAgICAgICAgICAgICAgICBpZiAoY29uZiAhPSBudWxsICYm\nIGNvbmYuZ2V0TG9ja1RpbWVvdXQoKSAhPSAtMSkgewogICAgICAgICAgICAg\nICAgICAgIHN0YXRlID0gU3RvcmVFeGNlcHRpb24uTE9DSzsKICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBT\ndG9yZUV4Y2VwdGlvbi5RVUVSWTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc3RhdGU7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBpc0ZhdGFsRXhj\nZXB0aW9uKGludCBzdWJ0eXBlLCBTUUxFeGNlcHRpb24gZXgpIHsKICAgICAg\nICBpZiAoKHN1YnR5cGUgPT0gU3RvcmVFeGNlcHRpb24uTE9DSyAgJiYgZXgu\nZ2V0RXJyb3JDb2RlKCkgPT0gMTIwNSkKICAgICAgICAgIHx8KHN1YnR5cGUg\nPT0gU3RvcmVFeGNlcHRpb24uUVVFUlkgJiYgZXguZ2V0RXJyb3JDb2RlKCkg\nPT0gMTMxNykpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIH0KICAgICAgICBpZiAoZXguZ2V0RXJyb3JDb2RlKCkgPT0gMCAmJiBleC5n\nZXRTUUxTdGF0ZSgpID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICByZXR1cm4gc3VwZXIuaXNGYXRhbEV4Y2VwdGlvbihzdWJ0\neXBlLCBleCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBPUEVOSlBBLTc0MCBT\ncGVjaWFsIGNhc2UgZm9yIE15U3FsIHNwZWNpYWwgY29sdW1uIHR5cGVzLAog\nICAgICogbGlrZSBMT05HVEVYVCwgTE9OR0JMT0cgZXRjLi4KICAgICAqIEBz\nZWUgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeSNn\nZXRUeXBlTmFtZShvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29s\ndW1uKQogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0VHlwZU5hbWUoQ29sdW1uIGNvbCkgewogICAgICAgIGlmIChjb2wuZ2V0\nVHlwZSgpID09IFR5cGVzLkJMT0IpIHsKICAgICAgICAgICAgaWYgKGNvbC5n\nZXRTaXplKCkgPT0gMCkgICAvLyB1bmtub3duIHNpemUKICAgICAgICAgICAg\nICAgIHJldHVybiBibG9iVHlwZU5hbWU7ICAvLyByZXR1cm4gb2xkIGRlZmF1\nbHQgb2YgNjRLQgogICAgICAgICAgICBlbHNlIGlmIChjb2wuZ2V0U2l6ZSgp\nIDw9IDI1NSkKICAgICAgICAgICAgICAgIHJldHVybiB0aW55QmxvYlR5cGVO\nYW1lOwogICAgICAgICAgICBlbHNlIGlmIChjb2wuZ2V0U2l6ZSgpIDw9IDY1\nNTM1KQogICAgICAgICAgICAgICAgcmV0dXJuIGJsb2JUeXBlTmFtZTsgIC8v\nIG9sZCBkZWZhdWx0IG9mIDY0S0IKICAgICAgICAgICAgZWxzZSBpZiAoY29s\nLmdldFNpemUoKSA8PSAxNjc3NzIxNSkKICAgICAgICAgICAgICAgIHJldHVy\nbiBtZWRpdW1CbG9iVHlwZU5hbWU7CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIHJldHVybiBsb25nQmxvYlR5cGVOYW1lOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRUeXBlTmFtZShj\nb2wpOwogICAgICAgIH0KICAgIH0KfQoK\n","encoding":"base64"}

