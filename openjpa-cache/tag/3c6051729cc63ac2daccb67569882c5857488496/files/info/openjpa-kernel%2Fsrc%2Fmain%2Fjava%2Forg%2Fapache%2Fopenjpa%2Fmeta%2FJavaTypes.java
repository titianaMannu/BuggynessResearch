{"sha":"83eb8d96159e0b6b909c208295f17fd504c5b3d9","node_id":"MDQ6QmxvYjIwNjM2NDo4M2ViOGQ5NjE1OWUwYjZiOTA5YzIwODI5NWYxN2ZkNTA0YzViM2Q5","size":15849,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/83eb8d96159e0b6b909c208295f17fd504c5b3d9","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5SZWFkZXI7CmltcG9y\ndCBqYXZhLmlvLlNlcmlhbGl6YWJsZTsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0LkFycmF5OwppbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9y\ndCBqYXZhLm1hdGguQmlnSW50ZWdlcjsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51\ndGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTG9jYWxlOwppbXBvcnQgamF2YS51\ndGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBlcnNpc3RlbmNlQ2FwYWJs\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DRk1ldGFE\nYXRhUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1l\ndGFEYXRhRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7Cgov\nKioKICogVHlwZSBjb25zdGFudHMgZm9yIG1hbmFnZWQgZmllbGRzLgogKgog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEphdmFUeXBl\ncyB7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQk9PTEVBTiA9IDA7\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBCWVRFID0gMTsKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IENIQVIgPSAyOwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgRE9VQkxFID0gMzsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEZMT0FUID0gNDsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IElOVCA9IDU7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBMT05H\nID0gNjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFNIT1JUID0gNzsK\nICAgIC8vIGtlZXAgT0JKRUNUIGFzIGZpcnN0IG5vbi1wcmltaXRpdmUgdHlw\nZSBjb2RlOyBvdGhlciBjb2RlIHJlbGllcyBvbiBpdAogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgT0JKRUNUID0gODsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IFNUUklORyA9IDk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBOVU1CRVIgPSAxMDsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIEFSUkFZID0gMTE7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBDT0xM\nRUNUSU9OID0gMTI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBNQVAg\nPSAxMzsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IERBVEUgPSAxNDsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFBDID0gMTU7CiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIGludCBCT09MRUFOX09CSiA9IDE2OwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgQllURV9PQkogPSAxNzsKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IENIQVJfT0JKID0gMTg7CiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIGludCBET1VCTEVfT0JKID0gMTk7CiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIGludCBGTE9BVF9PQkogPSAyMDsKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgaW50IElOVF9PQkogPSAyMTsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IExPTkdfT0JKID0gMjI7CiAgICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIGludCBTSE9SVF9PQkogPSAyMzsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEJJR0RFQ0lNQUwgPSAyNDsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IEJJR0lOVEVHRVIgPSAyNTsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IExPQ0FMRSA9IDI2OwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgUENfVU5UWVBFRCA9IDI3OwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgQ0FMRU5EQVIgPSAyODsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IE9JRCA9IDI5OwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgSU5Q\nVVRfU1RSRUFNID0gMzA7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBJ\nTlBVVF9SRUFERVIgPSAzMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIEVOVU0gPSAzMjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6\nZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKEphdmFUeXBlcy5jbGFz\ncyk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPENsYXNzPD8+LCBJ\nbnRlZ2VyPiBfdHlwZUNvZGVzID0gbmV3IEhhc2hNYXA8Q2xhc3M8Pz4sIElu\ndGVnZXI+KCk7CgogICAgc3RhdGljIHsKICAgICAgICBfdHlwZUNvZGVzLnB1\ndChTdHJpbmcuY2xhc3MsIFNUUklORyk7CiAgICAgICAgX3R5cGVDb2Rlcy5w\ndXQoQm9vbGVhbi5jbGFzcywgQk9PTEVBTl9PQkopOwogICAgICAgIF90eXBl\nQ29kZXMucHV0KEJ5dGUuY2xhc3MsIEJZVEVfT0JKKTsKICAgICAgICBfdHlw\nZUNvZGVzLnB1dChDaGFyYWN0ZXIuY2xhc3MsIENIQVJfT0JKKTsKICAgICAg\nICBfdHlwZUNvZGVzLnB1dChEb3VibGUuY2xhc3MsIERPVUJMRV9PQkopOwog\nICAgICAgIF90eXBlQ29kZXMucHV0KEZsb2F0LmNsYXNzLCBGTE9BVF9PQkop\nOwogICAgICAgIF90eXBlQ29kZXMucHV0KEludGVnZXIuY2xhc3MsIElOVF9P\nQkopOwogICAgICAgIF90eXBlQ29kZXMucHV0KExvbmcuY2xhc3MsIExPTkdf\nT0JKKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChTaG9ydC5jbGFzcywgU0hP\nUlRfT0JKKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChEYXRlLmNsYXNzLCBE\nQVRFKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChqYXZhLnNxbC5EYXRlLmNs\nYXNzLCBEQVRFKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChqYXZhLnNxbC5U\naW1lc3RhbXAuY2xhc3MsIERBVEUpOwogICAgICAgIF90eXBlQ29kZXMucHV0\nKGphdmEuc3FsLlRpbWUuY2xhc3MsIERBVEUpOwogICAgICAgIF90eXBlQ29k\nZXMucHV0KEJpZ0ludGVnZXIuY2xhc3MsIEJJR0lOVEVHRVIpOwogICAgICAg\nIF90eXBlQ29kZXMucHV0KEJpZ0RlY2ltYWwuY2xhc3MsIEJJR0RFQ0lNQUwp\nOwogICAgICAgIF90eXBlQ29kZXMucHV0KE51bWJlci5jbGFzcywgTlVNQkVS\nKTsKICAgICAgICBfdHlwZUNvZGVzLnB1dChMb2NhbGUuY2xhc3MsIExPQ0FM\nRSk7CiAgICAgICAgX3R5cGVDb2Rlcy5wdXQoT2JqZWN0LmNsYXNzLCBPQkpF\nQ1QpOwogICAgICAgIF90eXBlQ29kZXMucHV0KFBlcnNpc3RlbmNlQ2FwYWJs\nZS5jbGFzcywgUENfVU5UWVBFRCk7CiAgICAgICAgX3R5cGVDb2Rlcy5wdXQo\nUHJvcGVydGllcy5jbGFzcywgTUFQKTsKICAgICAgICBfdHlwZUNvZGVzLnB1\ndChDYWxlbmRhci5jbGFzcywgQ0FMRU5EQVIpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBmaWVsZCBtZXRhZGF0YSB0eXBlIGNvZGUgZm9y\nIHRoZSBnaXZlbiBjbGFzcy4gRmlyc3QgY2xhc3MKICAgICAqIG9iamVjdHMg\nYXJlIG5vdCByZWNvZ25pemVkIGluIHRoaXMgbWV0aG9kLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGludCBnZXRUeXBlQ29kZShDbGFzczw/PiB0eXBl\nKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIE9CSkVDVDsKCiAgICAgICAgaWYgKHR5cGUuaXNQcmltaXRpdmUoKSkg\newogICAgICAgICAgICBzd2l0Y2ggKHR5cGUuZ2V0TmFtZSgpLmNoYXJBdCgw\nKSkgewogICAgICAgICAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuICh0eXBlID09IGJvb2xlYW4uY2xhc3MpID8gQk9PTEVB\nTiA6IEJZVEU7CiAgICAgICAgICAgICAgICBjYXNlICdjJzoKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gQ0hBUjsKICAgICAgICAgICAgICAgIGNhc2Ug\nJ2QnOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBET1VCTEU7CiAgICAg\nICAgICAgICAgICBjYXNlICdmJzoKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gRkxPQVQ7CiAgICAgICAgICAgICAgICBjYXNlICdpJzoKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gSU5UOwogICAgICAgICAgICAgICAgY2FzZSAn\nbCc6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExPTkc7CiAgICAgICAg\nICAgICAgICBjYXNlICdzJzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nU0hPUlQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEludGVn\nZXIgY29kZSA9IChJbnRlZ2VyKSBfdHlwZUNvZGVzLmdldCh0eXBlKTsKICAg\nICAgICBpZiAoY29kZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gY29k\nZS5pbnRWYWx1ZSgpOwoKICAgICAgICAvLyBoYXZlIHRvIGRvIHRoaXMgZmly\nc3QgdG8gY2F0Y2ggY3VzdG9tIGNvbGxlY3Rpb24gYW5kIG1hcCB0eXBlczsK\nICAgICAgICAvLyBvbiByZXNvbHZlIHdlIGZpZ3VyZSBvdXQgaWYgdGhlc2Ug\nY3VzdG9tIHR5cGVzIGFyZQogICAgICAgIC8vIHBlcnNpc3RlbmNlLWNhcGFi\nbGUKICAgICAgICBpZiAoQ29sbGVjdGlvbi5jbGFzcy5pc0Fzc2lnbmFibGVG\ncm9tKHR5cGUpKQogICAgICAgICAgICByZXR1cm4gQ09MTEVDVElPTjsKICAg\nICAgICBpZiAoTWFwLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAg\nICAgICAgICAgIHJldHVybiBNQVA7CiAgICAgICAgaWYgKHR5cGUuaXNBcnJh\neSgpKQogICAgICAgICAgICByZXR1cm4gQVJSQVk7CiAgICAgICAgaWYgKENh\nbGVuZGFyLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAgICAgICAg\nICAgIHJldHVybiBDQUxFTkRBUjsKCiAgICAgICAgaWYgKHR5cGUuaXNJbnRl\ncmZhY2UoKSkgewogICAgICAgICAgICBpZiAoU2VyaWFsaXphYmxlLmNsYXNz\nLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gT0JKRUNUOwogICAgICAgICAgICByZXR1cm4gUENfVU5UWVBFRDsKICAg\nICAgICB9CiAgICAgICAgaWYgKHR5cGUuaXNBc3NpZ25hYmxlRnJvbShSZWFk\nZXIuY2xhc3MpKQogICAgICAgICAgICByZXR1cm4gSU5QVVRfUkVBREVSOwog\nICAgICAgIGlmICh0eXBlLmlzQXNzaWduYWJsZUZyb20gKElucHV0U3RyZWFt\nLmNsYXNzKSkKICAgICAgICAgICAgcmV0dXJuIElOUFVUX1NUUkVBTTsKICAg\nICAgICBpZiAoRW51bS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUpKQog\nICAgICAgICAgICByZXR1cm4gRU5VTTsKICAgICAgICAgICAgCiAgICAgICAg\ncmV0dXJuIE9CSkVDVDsKICAgIH0KIAogICAgLyoqCiAgICAgKiBDaGVjayB0\naGUgZ2l2ZW4gbmFtZSBhZ2FpbnN0IHRoZSBzYW1lIHNldCBvZiBzdGFuZGFy\nZCBwYWNrYWdlcyB1c2VkCiAgICAgKiB3aGVuIHBhcnNpbmcgbWV0YWRhdGEu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQ2xhc3M8Pz4gY2xhc3NGb3JO\nYW1lKFN0cmluZyBuYW1lLCBDbGFzc01ldGFEYXRhIGNvbnRleHQpIHsKICAg\nICAgICByZXR1cm4gY2xhc3NGb3JOYW1lKG5hbWUsIGNvbnRleHQsIG51bGwp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgdGhlIGdpdmVuIG5hbWUg\nYWdhaW5zdCB0aGUgc2FtZSBzZXQgb2Ygc3RhbmRhcmQgcGFja2FnZXMgdXNl\nZAogICAgICogd2hlbiBwYXJzaW5nIG1ldGFkYXRhLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIENsYXNzPD8+IGNsYXNzRm9yTmFtZShTdHJpbmcgbmFt\nZSwgQ2xhc3NNZXRhRGF0YSBjb250ZXh0LCBDbGFzc0xvYWRlciBsb2FkZXIp\nIHsKICAgICAgICByZXR1cm4gY2xhc3NGb3JOYW1lKG5hbWUsIGNvbnRleHQs\nIGNvbnRleHQuZ2V0RGVzY3JpYmVkVHlwZSgpLCBudWxsLAogICAgICAgICAg\nICBsb2FkZXIpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgdGhlIGdp\ndmVuIG5hbWUgYWdhaW5zdCB0aGUgc2FtZSBzZXQgb2Ygc3RhbmRhcmQgcGFj\na2FnZXMgdXNlZAogICAgICogd2hlbiBwYXJzaW5nIG1ldGFkYXRhLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIENsYXNzPD8+IGNsYXNzRm9yTmFtZShT\ndHJpbmcgbmFtZSwgVmFsdWVNZXRhRGF0YSBjb250ZXh0KSB7CiAgICAgICAg\ncmV0dXJuIGNsYXNzRm9yTmFtZShuYW1lLCBjb250ZXh0LCBudWxsKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENoZWNrIHRoZSBnaXZlbiBuYW1lIGFnYWlu\nc3QgdGhlIHNhbWUgc2V0IG9mIHN0YW5kYXJkIHBhY2thZ2VzIHVzZWQKICAg\nICAqIHdoZW4gcGFyc2luZyBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBDbGFzczw/PiBjbGFzc0Zvck5hbWUoU3RyaW5nIG5hbWUsIFZh\nbHVlTWV0YURhdGEgY29udGV4dCwgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAg\nICAgICAgcmV0dXJuIGNsYXNzRm9yTmFtZShuYW1lLAogICAgICAgICAgICBj\nb250ZXh0LmdldEZpZWxkTWV0YURhdGEoKS5nZXREZWZpbmluZ01ldGFEYXRh\nKCksCiAgICAgICAgICAgIGNvbnRleHQuZ2V0RmllbGRNZXRhRGF0YSgpLmdl\ndERlY2xhcmluZ1R5cGUoKSwgY29udGV4dCwgbG9hZGVyKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENoZWNrIHRoZSBnaXZlbiBuYW1lIGFnYWluc3QgdGhl\nIHNhbWUgc2V0IG9mIHN0YW5kYXJkIHBhY2thZ2VzIHVzZWQKICAgICAqIHdo\nZW4gcGFyc2luZyBtZXRhZGF0YS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgQ2xhc3M8Pz4gY2xhc3NGb3JOYW1lKFN0cmluZyBuYW1lLCBDbGFzc01l\ndGFEYXRhIG1ldGEsIENsYXNzPD8+IGRlYywgVmFsdWVNZXRhRGF0YSB2bWQs\nIAogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIC8vIHNw\nZWNpYWwgY2FzZSBmb3IgUGVyc2lzdGVuY2VDYXBhYmxlIGFuZCBPYmplY3QK\nICAgICAgICBpZiAoIlBlcnNpc3RlbmNlQ2FwYWJsZSIuZXF1YWxzKG5hbWUp\nCiAgICAgICAgICAgIHx8ICJqYXZheC5qZG8uUGVyc2lzdGVuY2VDYXBhYmxl\nIi5lcXVhbHMobmFtZSkpIC8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5CiAg\nICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3M7CiAg\nICAgICAgaWYgKCJPYmplY3QiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAg\ncmV0dXJuIE9iamVjdC5jbGFzczsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0\nb3J5IHJlcCA9IG1ldGEuZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIGJvb2xl\nYW4gcnVudGltZSA9IChyZXAuZ2V0VmFsaWRhdGUoKSAmIE1ldGFEYXRhUmVw\nb3NpdG9yeS5WQUxJREFURV9SVU5USU1FKSAhPSAwOwogICAgICAgIGlmIChs\nb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9hZGVyID0gcmVwLmdldENv\nbmZpZ3VyYXRpb24oKS5nZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS4KICAg\nICAgICAgICAgICAgIGdldENsYXNzTG9hZGVyKGRlYywgbWV0YS5nZXRFbnZD\nbGFzc0xvYWRlcigpKTsKCiAgICAgICAgLy8gdHJ5IHRoZSBvd25lcidzIHBh\nY2thZ2UKICAgICAgICBTdHJpbmcgcGtnID0gU3RyaW5ncy5nZXRQYWNrYWdl\nTmFtZShkZWMpOwogICAgICAgIENsYXNzPD8+IGNscyA9IENGTWV0YURhdGFQ\nYXJzZXIuY2xhc3NGb3JOYW1lKG5hbWUsIHBrZywgcnVudGltZSwgbG9hZGVy\nKTsKICAgICAgICBpZiAoY2xzID09IG51bGwgJiYgdm1kICE9IG51bGwpIHsK\nICAgICAgICAgICAgLy8gdHJ5IGFnYWluc3QgdGhpcyB2YWx1ZSB0eXBlJ3Mg\ncGFja2FnZSB0b28KICAgICAgICAgICAgcGtnID0gU3RyaW5ncy5nZXRQYWNr\nYWdlTmFtZSh2bWQuZ2V0RGVjbGFyZWRUeXBlKCkpOwogICAgICAgICAgICBj\nbHMgPSBDRk1ldGFEYXRhUGFyc2VyLmNsYXNzRm9yTmFtZShuYW1lLCBwa2cs\nIHJ1bnRpbWUsIGxvYWRlcik7CiAgICAgICAgfQogICAgICAgIGlmIChjbHMg\nPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJiYWQtY2xhc3MiLCBuYW1lLAogICAgICAgICAgICAg\nICAgKHZtZCA9PSBudWxsKSA/IChPYmplY3QpIG1ldGEgOiAoT2JqZWN0KSB2\nbWQpKTsKICAgICAgICByZXR1cm4gY2xzOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVydCB0aGUgZ2l2ZW4gb2JqZWN0IHRvIHRoZSBnaXZlbiB0eXBl\nIGlmIHBvc3NpYmxlLiBJZiB0aGUgdHlwZSBpcwogICAgICogYSBudW1lcmlj\nIHByaW1pdGl2ZSwgdGhpcyBtZXRob2Qgb25seSBndWFyYW50ZWVzIHRoYXQg\ndGhlIHJldHVybiB2YWx1ZQogICAgICogaXMgYSB7QGxpbmsgTnVtYmVyfS4g\nSWYgbm8ga25vd24gY29udmVyc2lvbiBvciB0aGUgdmFsdWUgaXMgbnVsbCwK\nICAgICAqIHJldHVybnMgdGhlIG9yaWdpbmFsIHZhbHVlLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIE9iamVjdCBjb252ZXJ0KE9iamVjdCB2YWwsIGlu\ndCB0eXBlQ29kZSkgewogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIHN3aXRjaCAodHlwZUNvZGUp\nIHsKICAgICAgICAgICAgY2FzZSBCSUdERUNJTUFMOgogICAgICAgICAgICAg\nICAgaWYgKHZhbCBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwpCiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgIGlmICh2YWwg\naW5zdGFuY2VvZiBOdW1iZXIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIG5ldyBCaWdEZWNpbWFsKCgoTnVtYmVyKSB2YWwpLmRvdWJsZVZhbHVlKCkp\nOwogICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFN0cmluZykK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJpZ0RlY2ltYWwodmFs\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAg\nICAgICAgICAgY2FzZSBCSUdJTlRFR0VSOgogICAgICAgICAgICAgICAgaWYg\nKHZhbCBpbnN0YW5jZW9mIEJpZ0ludGVnZXIpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBOdW1iZXIgfHwgdmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgQmlnSW50ZWdlcih2YWwudG9TdHJp\nbmcoKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAg\nICBjYXNlIEJPT0xFQU46CiAgICAgICAgICAgIGNhc2UgQk9PTEVBTl9PQko6\nCiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuLnZhbHVlT2YodmFs\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAg\nICAgICAgICAgY2FzZSBCWVRFX09CSjoKICAgICAgICAgICAgICAgIGlmICh2\nYWwgaW5zdGFuY2VvZiBCeXRlKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiB2YWw7CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTnVt\nYmVyKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQnl0ZSgoKE51\nbWJlcikgdmFsKS5ieXRlVmFsdWUoKSk7CiAgICAgICAgICAgICAgICAvLyBu\nbyBicmVhawogICAgICAgICAgICBjYXNlIEJZVEU6CiAgICAgICAgICAgICAg\nICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBuZXcgQnl0ZSh2YWwudG9TdHJpbmcoKSk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICBjYXNlIENIQVI6CiAg\nICAgICAgICAgIGNhc2UgQ0hBUl9PQko6CiAgICAgICAgICAgICAgICBpZiAo\ndmFsIGluc3RhbmNlb2YgQ2hhcmFjdGVyKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiB2YWw7CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNl\nb2YgU3RyaW5nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hh\ncmFjdGVyKHZhbC50b1N0cmluZygpLmNoYXJBdCgwKSk7CiAgICAgICAgICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgTnVtYmVyKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBuZXcgQ2hhcmFjdGVyKChjaGFyKSAoKE51bWJlcikg\ndmFsKS5pbnRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7\nCiAgICAgICAgICAgIGNhc2UgREFURToKICAgICAgICAgICAgICAgIGlmICh2\nYWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIG5ldyBEYXRlKHZhbC50b1N0cmluZygpKTsKICAgICAgICAgICAgICAg\nIHJldHVybiB2YWw7CiAgICAgICAgICAgIGNhc2UgRE9VQkxFX09CSjoKICAg\nICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBEb3VibGUpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgIGlm\nICh2YWwgaW5zdGFuY2VvZiBOdW1iZXIpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIG5ldyBEb3VibGUoKChOdW1iZXIpIHZhbCkuZG91YmxlVmFsdWUo\nKSk7CiAgICAgICAgICAgICAgICAvLyBubyBicmVhawogICAgICAgICAgICBj\nYXNlIERPVUJMRToKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2Vv\nZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb3Vi\nbGUodmFsLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZh\nbDsKICAgICAgICAgICAgY2FzZSBGTE9BVF9PQko6CiAgICAgICAgICAgICAg\nICBpZiAodmFsIGluc3RhbmNlb2YgRmxvYXQpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBOdW1iZXIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBG\nbG9hdCgoKE51bWJlcikgdmFsKS5mbG9hdFZhbHVlKCkpOwogICAgICAgICAg\nICAgICAgLy8gbm8gYnJlYWsKICAgICAgICAgICAgY2FzZSBGTE9BVDoKICAg\nICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdCh2YWwudG9TdHJpbmco\nKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICBj\nYXNlIElOVF9PQko6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNl\nb2YgSW50ZWdlcikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsOwog\nICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIE51bWJlcikKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gKChOdW1iZXIpIHZhbCkuaW50VmFs\ndWUoKTsKICAgICAgICAgICAgICAgIC8vIG5vIGJyZWFrCiAgICAgICAgICAg\nIGNhc2UgSU5UOgogICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9m\nIFN0cmluZykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEludGVn\nZXIodmFsLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZh\nbDsKICAgICAgICAgICAgY2FzZSBMT05HX09CSjoKICAgICAgICAgICAgICAg\nIGlmICh2YWwgaW5zdGFuY2VvZiBMb25nKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiB2YWw7CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNl\nb2YgTnVtYmVyKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAoKE51bWJl\ncikgdmFsKS5sb25nVmFsdWUoKTsKICAgICAgICAgICAgICAgIC8vIG5vIGJy\nZWFrCiAgICAgICAgICAgIGNhc2UgTE9ORzoKICAgICAgICAgICAgICAgIGlm\nICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIG5ldyBMb25nKHZhbC50b1N0cmluZygpKTsKICAgICAgICAgICAg\nICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIGNhc2UgTlVNQkVSOgogICAg\nICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIE51bWJlcikKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICAgICAgaWYg\nKHZhbCBpbnN0YW5jZW9mIFN0cmluZykKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IEJpZ0RlY2ltYWwodmFsLnRvU3RyaW5nKCkpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAgY2FzZSBTSE9SVF9P\nQko6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU2hvcnQp\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAg\nICAgIGlmICh2YWwgaW5zdGFuY2VvZiBOdW1iZXIpCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIG5ldyBTaG9ydCgoKE51bWJlcikgdmFsKS5zaG9ydFZh\nbHVlKCkpOwogICAgICAgICAgICAgICAgLy8gbm8gYnJlYWsKICAgICAgICAg\nICAgY2FzZSBTSE9SVDoKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBT\naG9ydCh2YWwudG9TdHJpbmcoKSk7CiAgICAgICAgICAgICAgICByZXR1cm4g\ndmFsOwogICAgICAgICAgICBjYXNlIFNUUklORzoKICAgICAgICAgICAgICAg\nIHJldHVybiB2YWwudG9TdHJpbmcoKTsKICAgICAgICAgICAgZGVmYXVsdDoK\nICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIChwb3NzaWJseSB1\nbnJlc29sdmVkKSBmaWVsZCBvciBpdHMgZWxlbWVudHMgbWlnaHQgYmUKICAg\nICAqIHBlcnNpc3RlbmNlIGNhcGFibGUgb2JqZWN0cy4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBib29sZWFuIG1heWJlUEMoRmllbGRNZXRhRGF0YSBm\naWVsZCkgewogICAgICAgIHN3aXRjaCAoZmllbGQuZ2V0RGVjbGFyZWRUeXBl\nQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICAgICAgcmV0dXJuIG1heWJlUEMoZmllbGQuZ2V0RWxlbWVudCgpKTsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAg\nICAgcmV0dXJuIG1heWJlUEMoZmllbGQuZ2V0S2V5KCkpIHx8IG1heWJlUEMo\nZmllbGQuZ2V0RWxlbWVudCgpKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAgICAgICAgIHJldHVybiBtYXliZVBDKChWYWx1ZU1ldGFEYXRhKSBm\naWVsZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRydWUgaWYgdGhlIChwb3NzaWJseSB1bnJlc29sdmVkKSB2YWx1ZSBtaWdo\ndCBiZSBhIGZpcnN0IGNsYXNzCiAgICAgKiBvYmplY3QuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBtYXliZVBDKFZhbHVlTWV0YURhdGEg\ndmFsKSB7CiAgICAgICAgcmV0dXJuIG1heWJlUEModmFsLmdldERlY2xhcmVk\nVHlwZUNvZGUoKSwgdmFsLmdldERlY2xhcmVkVHlwZSgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiB1bnJlc29s\ndmVkIHR5cGVjb2RlL3R5cGUgcGFpciBtYXkgcmVwcmVzZW50IGEKICAgICAq\nIHBlcnNpc3RlbnQgb2JqZWN0LgogICAgICovCiAgICBzdGF0aWMgYm9vbGVh\nbiBtYXliZVBDKGludCB0eXBlQ29kZSwgQ2xhc3M8Pz4gdHlwZSkgewogICAg\nICAgIGlmICh0eXBlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICBzd2l0Y2ggKHR5cGVDb2RlKSB7CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuUEM6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDX1VOVFlQRUQ6\nCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgcmV0dXJuICF0eXBlLmdldE5h\nbWUoKS5zdGFydHNXaXRoKCJqYXZhLnV0aWwuIik7CiAgICAgICAgICAgIGRl\nZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogSGVscGVyIG1ldGhvZCB0byByZXR1\ncm4gdGhlIGdpdmVuIGFycmF5IHZhbHVlIGFzIGEgY29sbGVjdGlvbi4KICAg\nICAqLwogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBw\ndWJsaWMgc3RhdGljIExpc3QgdG9MaXN0KE9iamVjdCB2YWwsIENsYXNzPD8+\nIGVsZW0sIGJvb2xlYW4gbXV0YWJsZSkgewogICAgICAgIGlmICh2YWwgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIExpc3Qg\nbDsKICAgICAgICBpZiAoIWVsZW0uaXNQcmltaXRpdmUoKSkgewogICAgICAg\nICAgICAvLyBpZiBhbiBvYmplY3QgYXJyYXksIHVzZSBidWlsdC1pbiBsaXN0\nIGZ1bmN0aW9uCiAgICAgICAgICAgIGwgPSBBcnJheXMuYXNMaXN0KChPYmpl\nY3RbXSkgdmFsKTsKICAgICAgICAgICAgaWYgKG11dGFibGUpCiAgICAgICAg\nICAgICAgICBsID0gbmV3IEFycmF5TGlzdChsKTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAvLyBjb252ZXJ0IHRvIGxpc3Qgb2Ygd3JhcHBlciBv\nYmplY3RzCiAgICAgICAgICAgIGludCBsZW5ndGggPSBBcnJheS5nZXRMZW5n\ndGgodmFsKTsKICAgICAgICAgICAgbCA9IG5ldyBBcnJheUxpc3QobGVuZ3Ro\nKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkr\nKykKICAgICAgICAgICAgICAgIGwuYWRkKEFycmF5LmdldCh2YWwsIGkpKTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBIZWxwZXIgbWV0aG9kIHRvIHJldHVybiB0aGUgZ2l2ZW4gY29sbGVj\ndGlvbiBhcyBhbiBhcnJheS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBP\nYmplY3QgdG9BcnJheShDb2xsZWN0aW9uPD8+IGNvbGwsIENsYXNzPD8+IGVs\nZW0pIHsKICAgICAgICBpZiAoY29sbCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKCiAgICAgICAgT2JqZWN0IGFycmF5ID0gQXJyYXkubmV3\nSW5zdGFuY2UoZWxlbSwgY29sbC5zaXplKCkpOwogICAgICAgIGludCBpZHgg\nPSAwOwogICAgICAgIGZvciAoSXRlcmF0b3I8Pz4gaXRyID0gY29sbC5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOyBpZHgrKykKICAgICAgICAgICAgQXJy\nYXkuc2V0KGFycmF5LCBpZHgsIGl0ci5uZXh0ICgpKTsKCQlyZXR1cm4gYXJy\nYXk7Cgl9Cn0K\n","encoding":"base64"}

