{"sha":"ca944ae78d7b8dc056fa8c573db4975968387323","node_id":"MDQ6QmxvYjIwNjM2NDpjYTk0NGFlNzhkN2I4ZGMwNTZmYThjNTczZGI0OTc1OTY4Mzg3MzIz","size":7345,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ca944ae78d7b8dc056fa8c573db4975968387323","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbDsKCmltcG9ydCBqYXZh\nLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuQ29tcGF0aWJpbGl0eTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuRGV0YWNoZWRTdGF0ZU1hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFn\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1By\naXZIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xh\nc3NNZXRhRGF0YTsKCi8qKgogKiBVdGlsaXR5IG1ldGhvZHMgZm9yIG1hbmFn\naW5nIHByb3hpZXMuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJs\naWMgY2xhc3MgUHJveGllcyB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShQcm94aWVz\nLmNsYXNzKTsKCiAgICAvKioKICAgICAqIFVzZWQgYnkgcHJveHkgdHlwZXMg\ndG8gY2hlY2sgaWYgdGhlIGdpdmVuIG93bmVycyBhbmQgZmllbGQgbmFtZXMK\nICAgICAqIGFyZSBlcXVpdmFsZW50LgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGJvb2xlYW4gaXNPd25lcihQcm94eSBwcm94eSwgT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwKICAgICAgICBpbnQgZmllbGQpIHsKICAgICAgICByZXR1\ncm4gcHJveHkuZ2V0T3duZXIoKSA9PSBzbSAmJiBwcm94eS5nZXRPd25lckZp\nZWxkKCkgPT0gZmllbGQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2VkIGJ5\nIHByb3h5IHR5cGVzIHRvIGNoZWNrIHRoYXQgYW4gYXR0ZW1wdCB0byBhZGQg\nYSBuZXcgdmFsdWUgaXMgbGVnYWwuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBhc3NlcnRBbGxvd2VkVHlwZShPYmplY3QgdmFsdWUsIENsYXNz\nIGFsbG93ZWQpIHsKICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCAmJiBhbGxv\nd2VkICE9IG51bGwgJiYgIWFsbG93ZWQuaXNJbnN0YW5jZSh2YWx1ZSkpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nImJhZC1lbGVtLXR5cGUiLCBuZXcgT2JqZWN0W117CiAgICAgICAgICAgICAg\nICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAg\nICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDbGFzc0xvYWRlckFjdGlvbihh\nbGxvd2VkKSksCiAgICAgICAgICAgICAgICBhbGxvd2VkLAogICAgICAgICAg\nICAgICAgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAg\nICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q2xhc3NMb2FkZXJBY3Rp\nb24odmFsdWUuZ2V0Q2xhc3MoKSkpLAogICAgICAgICAgICAgICAgdmFsdWUu\nZ2V0Q2xhc3MoKQogICAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogVXNlZCBieSBwcm94eSB0eXBlcyB0byBkaXJ0eSB0\naGVpciBvd25lci4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGRp\ncnR5KFByb3h5IHByb3h5LCBib29sZWFuIHN0b3BUcmFja2luZykgewogICAg\nICAgIGlmIChwcm94eS5nZXRPd25lcigpICE9IG51bGwpCiAgICAgICAgICAg\nIHByb3h5LmdldE93bmVyKCkuZGlydHkocHJveHkuZ2V0T3duZXJGaWVsZCgp\nKTsKICAgICAgICBpZiAoc3RvcFRyYWNraW5nICYmIHByb3h5LmdldENoYW5n\nZVRyYWNrZXIoKSAhPSBudWxsKQogICAgICAgICAgICBwcm94eS5nZXRDaGFu\nZ2VUcmFja2VyKCkuc3RvcFRyYWNraW5nKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBVc2VkIGJ5IHByb3h5IHR5cGVzIHRvIG5vdGlmeSBjb2xsZWN0aW9u\nIG93bmVyIG9uIGVsZW1lbnQgcmVtb3ZhbC4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyB2b2lkIHJlbW92ZWQoUHJveHkgcHJveHksIE9iamVjdCByZW1v\ndmVkLCBib29sZWFuIGtleSkgewogICAgICAgIGlmIChwcm94eS5nZXRPd25l\ncigpICE9IG51bGwgJiYgcmVtb3ZlZCAhPSBudWxsKQogICAgICAgICAgICBw\ncm94eS5nZXRPd25lcigpLnJlbW92ZWQocHJveHkuZ2V0T3duZXJGaWVsZCgp\nLCByZW1vdmVkLCBrZXkpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlZCBi\neSBwcm94eSB0eXBlcyB0byBzZXJpYWxpemUgbm9uLXByb3h5IHZlcnNpb25z\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCB3cml0ZVJlcGxh\nY2UoUHJveHkgcHJveHksIGJvb2xlYW4gZGV0YWNoYWJsZSkgewogICAgICAg\nIC8qIE9QRU5KUEEtMTA5NyBSZW1vdmUgJHByb3h5IGNsYXNzZXMgZHVyaW5n\nIHNlcmlhbGl6YXRpb24gYmFzZWQgb246CiAgICAgICAgICogICAxKSBObyBQ\ncm94eSwgdGhlbiByZXR1cm4gYXMtaXMKICAgICAgICAgKiAgIDIpIFJ1bnRp\nbWUgY3JlYXRlZCBwcm94eSAoIWRldGFjaGFibGUpLCB0aGVuIHVucHJveHkK\nICAgICAgICAgKiAgIDMpIE5vIFN0YXRlTWFuYWdlciAoRGV0YWNoZWRTdGF0\nZUZpZWxkPT1mYWxzZSksIHRoZW4gcmV0dXJuIGFzLWlzCiAgICAgICAgICog\nICBHZXQgdGhlIG5ldyBJZ25vcmVEZXRhY2hlZFN0YXRlRmllbGRGb3JQcm94\neVNlcmlhbGl6YXRpb24KICAgICAgICAgKiAgICAgIENvbXBhdGliaWxpdHkg\nZmxhZyBmcm9tIGVpdGhlciB0aGUgbWV0YWRhdGEvY29uZmlndXJhdGlvbiBp\nZgogICAgICAgICAqICAgICAgdGhpcyBpcyBhIG5vcm1hbCBTdGF0ZU1hbmFn\nZXIsIG90aGVyd2lzZSB1c2UgdGhlIG5ldyBmbGFnCiAgICAgICAgICogICAg\nICBhZGRlZCB0byB0aGUgRGV0YWNoZWRTdGF0ZU1hbmFnZXIKICAgICAgICAg\nKiAgIDQpIElmIG5ldyAyLjAgYmVoYXZpb3IKICAgICAgICAgKiAgICAgIDRh\nKSBJZiBDbGFzc01ldGFEYXRhIGV4aXN0cyBhbmQgRGV0YWNoZWRTdGF0ZUZp\nZWxkID09IFRSVUUKICAgICAgICAgKiAgICAgICAgICB0aGVuIGRvIG5vdCBy\nZW1vdmUgdGhlIHByb3h5IGFuZCByZXR1cm4gYXMtaXMKICAgICAgICAgKiAg\nICAgIDRiKSBFbHNlLCB1c2luZyBEZXRhY2hlZFN0YXRlRmllbGQgb2YgdHJh\nbnNpZW50KGRlZmF1bHQpIG9yCiAgICAgICAgICogICAgICAgICAgZmFsc2Us\nIHNvIHVucHJveHkgCiAgICAgICAgICogICA1KSBJZiAxLjAgYXBwIG9yIHJl\ncXVlc3RlZCBvbGQgMS4wIGJlaGF2aW9yCiAgICAgICAgICogICAgICA1YSkg\nSWYgZGV0YWNoZWQsIHRoZW4gZG8gbm90IHVucHJveHkgYW5kIHJldHVybiBh\ncy1pcwogICAgICAgICAqICAgICAgNWIpIEVsc2UsIHVucHJveHkKICAgICAg\nICAgKiAKICAgICAgICAgKiBPcmlnaW5hbCBjb2RlIC0KICAgICAgICAgKiAg\nIDEpIFJ1bnRpbWUgY3JlYXRlZCBwcm94eSAoIWRldGFjaGFibGUpLCB0aGVu\nIHVucHJveHkKICAgICAgICAgKiAgIDIpIE5vIFByb3h5LCB0aGVuIHJldHVy\nbiBhcy1pcwogICAgICAgICAqICAgMykgTm8gU3RhdGVNYW5hZ2VyIChEZXRh\nY2hlZFN0YXRlRmllbGQ9PWZhbHNlKSwgdGhlbiByZXR1cm4gYXMtaXMKICAg\nICAgICAgKiAgIDQpIElmIGRldGFjaGVkLCB0aGVuIHJldHVybiBhcy1pcyA8\nLS0tIEVSUk9SIGFzIEVNLmNsZWFyKCkgbWFya3MKICAgICAgICAgKiAgICAg\nIGVudGl0eSBhcyBkZXRhY2hlZCBidXQgZG9lc24ndCByZW1vdmUgYW55ICRw\ncm94eSB1c2FnZQogICAgICAgICAqICAgNSkgRWxzZSwgdW5wcm94eQogICAg\nICAgICAqIAogICAgICAgICAqICBpZiAoZGV0YWNoYWJsZSAmJiAocHJveHkg\nPT0gbnVsbCB8fCBwcm94eS5nZXRPd25lcigpID09IG51bGwgCiAgICAgICAg\nICogICAgICB8fCBwcm94eS5nZXRPd25lcigpLmlzRGV0YWNoZWQoKSkpCiAg\nICAgICAgICogICAgICByZXR1cm4gcHJveHk7CiAgICAgICAgICoKICAgICAg\nICAgKi8KICAgICAgICBpZiAocHJveHkgPT0gbnVsbCkgewogICAgICAgICAg\nICByZXR1cm4gcHJveHk7CiAgICAgICAgfSBlbHNlIGlmICghZGV0YWNoYWJs\nZSkgewogICAgICAgICAgICAvLyBPUEVOSlBBLTE1NzEgLSB1c2luZyBvdXIg\ncnVudGltZSBnZW5lcmF0ZWQgcHJveGllcywgc28gcmVtb3ZlIGFueSAkcHJv\neHkKICAgICAgICAgICAgcmV0dXJuIHByb3h5LmNvcHkocHJveHkpOwogICAg\nICAgIH0gZWxzZSBpZiAocHJveHkuZ2V0T3duZXIoKSA9PSBudWxsKSB7CiAg\nICAgICAgICAgIC8vIG5vIFN0YXRlTWFuYWdlciAoRGV0YWNoZWRTdGF0ZUZp\nZWxkPT1mYWxzZSksIHNvIG5vICRwcm94eSB0byByZW1vdmUKICAgICAgICAg\nICAgcmV0dXJuIHByb3h5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nIC8vIHVzaW5nIGEgU3RhdGVNYW5hZ2VyLCBzbyBkZXRlcm1pbmUgd2hhdCBE\nZXRhY2hlZFN0YXRlIGlzIGJlaW5nIHVzZWQKICAgICAgICAgICAgT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSA9IHByb3h5LmdldE93bmVyKCk7ICAvLyBudWxs\nIGNoZWNrZWQgZm9yIGFib3ZlCiAgICAgICAgICAgIENsYXNzTWV0YURhdGEg\nbWV0YSA9IG51bGw7ICAgICAgICAgIC8vIGlmIG51bGwsIG5vIHByb3hpZXM/\nCiAgICAgICAgICAgIGJvb2xlYW4gdXNlRFNGRm9yVW5wcm94eSA9IGZhbHNl\nOyAgIC8vIGRlZmF1bHQgdG8gZmFsc2UgZm9yIG9sZCAxLjAgYmVoYXZpb3IK\nCiAgICAgICAgICAgIC8vIERldGFjaGVkU3RhdGVNbmFnZXIgaGFzIG5vIGNv\nbnRleHQgb3IgbWV0YWRhdGEsIHNvIHdlIGNhbid0IGdldCBjb25maWd1cmF0\naW9uIHNldHRpbmdzCiAgICAgICAgICAgIGlmICghcHJveHkuZ2V0T3duZXIo\nKS5pc0RldGFjaGVkKCkpIHsKICAgICAgICAgICAgICAgIENvbXBhdGliaWxp\ndHkgY29tcGF0ID0gbnVsbDsKICAgICAgICAgICAgICAgIG1ldGEgPSBzbS5n\nZXRNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgaWYgKG1ldGEgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgIGNvbXBhdCA9IG1ldGEuZ2V0UmVw\nb3NpdG9yeSgpLmdldENvbmZpZ3VyYXRpb24oKS5nZXRDb21wYXRpYmlsaXR5\nSW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc20uZ2V0\nQ29udGV4dCgpICE9IG51bGwgJiYgc20uZ2V0Q29udGV4dCgpLmdldENvbmZp\nZ3VyYXRpb24oKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgY29t\ncGF0ID0gc20uZ2V0Q29udGV4dCgpLmdldENvbmZpZ3VyYXRpb24oKS5nZXRD\nb21wYXRpYmlsaXR5SW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gbm8tb3AgLSB1c2luZyBhIFN0\nYXRlTWFuYWdlciwgYnV0IG5vIENvbXBhdGliaWxpdHkgc2V0dGluZ3MgYXZh\naWxhYmxlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAo\nY29tcGF0ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAvLyBuZXcg\nMi4wIGJlaGF2aW9yIG9mIHVzaW5nIERldGFjaGVkU3RhdGVGaWVsZCB0byBk\nZXRlcm1pbmUgdW5wcm94eSBkdXJpbmcgc2VyaWFsaXphdGlvbgogICAgICAg\nICAgICAgICAgICAgIHVzZURTRkZvclVucHJveHkgPSAhY29tcGF0LmdldEln\nbm9yZURldGFjaGVkU3RhdGVGaWVsZEZvclByb3h5U2VyaWFsaXphdGlvbigp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgLy8gVXNpbmcgYSBEZXRhY2hlZFN0YXRlTWFuYWdlciwg\nc28gdXNlIHRoZSBuZXcgZmxhZyBzaW5jZSB0aGVyZSBpcyBubyBjb250ZXh0\nIG9yIG1ldGFkYXRhCiAgICAgICAgICAgICAgICB1c2VEU0ZGb3JVbnByb3h5\nID0gKChEZXRhY2hlZFN0YXRlTWFuYWdlcilzbSkuZ2V0VXNlRFNGRm9yVW5w\ncm94eSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAg\nICBpZiAodXNlRFNGRm9yVW5wcm94eSkgewogICAgICAgICAgICAgICAgLy8g\ndXNlIG5ldyAyLjAgYmVoYXZpb3IKICAgICAgICAgICAgICAgIGlmICgobWV0\nYSAhPSBudWxsKSAmJiAoQm9vbGVhbi5UUlVFLmVxdWFscyhtZXRhLnVzZXNE\nZXRhY2hlZFN0YXRlKCkpKSkgewogICAgICAgICAgICAgICAgICAgIC8vIGNv\nbmZpZ3VyZWQgdG8gYWx3YXlzIHVzZSBhbmQgc2VyaWFsaXplIGEgU3RhdGVN\nYW5nZXIsIHNvIGtlZXAgYW55ICRwcm94eQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBwcm94eTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgLy8gYWxyZWFkeSBkZXRhY2hlZCBvciB1c2luZyBE\nZXRhY2hlZFN0YXRlRmllbGQ9PWZhbHNlIG9yIHRyYW5zaWVudCwgc28gcmVt\nb3ZlIGFueSAkcHJveHkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJv\neHkuY29weShwcm94eSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyB1c2Ugb2xkIDEuMCBiZWhh\ndmlvcgogICAgICAgICAgICAgICAgaWYgKHByb3h5LmdldE93bmVyKCkuaXNE\nZXRhY2hlZCgpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm94eTsK\nICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gcHJveHkuY29weShwcm94eSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9Cn0KCg==\n","encoding":"base64"}

