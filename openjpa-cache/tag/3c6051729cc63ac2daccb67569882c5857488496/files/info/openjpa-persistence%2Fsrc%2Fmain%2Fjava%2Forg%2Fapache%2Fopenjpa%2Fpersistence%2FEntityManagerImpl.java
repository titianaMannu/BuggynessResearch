{"sha":"d26fb0194d338ec08f89f0f369216fb7b6c91322","node_id":"MDQ6QmxvYjIwNjM2NDpkMjZmYjAxOTRkMzM4ZWMwOGY4OWYwZjM2OTIxNmZiN2I2YzkxMzIy","size":61551,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d26fb0194d338ec08f89f0f369216fb7b6c91322","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5FeHRl\ncm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0OwppbXBv\ncnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLk9iamVjdFN0cmVhbUNsYXNzOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQXJyYXk7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5FbnVtU2V0OwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuSWRlbnRpdHlIYXNoTWFwOwppbXBvcnQgamF2YS51\ndGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuQ2FjaGVSZXRyaWV2ZU1vZGU7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5DYWNoZVN0b3JlTW9kZTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5GbHVzaE1vZGVUeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTG9j\na01vZGVUeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUXVlcnk7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5UeXBlZFF1ZXJ5OwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuQ3JpdGVyaWFRdWVyeTsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlBhcmFtZXRlckV4cHJlc3Np\nb247CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5tZXRhbW9kZWwuTWV0YW1v\nZGVsOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuQ29tcGF0aWJp\nbGl0eTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVlLk1h\nbmFnZWRSdW50aW1lOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFu\nY2UuUENFbmhhbmNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlLlBDUmVnaXN0cnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5o\nYW5jZS5SZWZsZWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5BYnN0cmFjdEJyb2tlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLkJyb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuRGF0YUNhY2hlUmV0cmlldmVNb2RlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5EYXRhQ2FjaGVTdG9yZU1vZGU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkRlbGVnYXRpbmdCcm9r\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZldGNoQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nRmluZENhbGxiYWNrczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuT3BDYWxsYmFja3M7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLlByZXBhcmVkUXVlcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLlByZXBhcmVkUXVlcnlDYWNoZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlGbHVzaE1vZGVzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUxhbmd1YWdlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU2VxOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5qcHFsLkpQUUxQYXJzZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ2xvc2VhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVy\naWEuQ3JpdGVyaWFCdWlsZGVySW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcGVuSlBBQ3JpdGVyaWFCdWls\nZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmNy\naXRlcmlhLk9wZW5KUEFDcml0ZXJpYVF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLnZhbGlkYXRpb24uVmFsaWRhdGlvblV0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9u\nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2VwdGlv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuUnVudGltZUV4Y2Vw\ndGlvblRyYW5zbGF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5Vc2VyRXhjZXB0aW9uOwoKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoK\nLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHtAbGluayBFbnRpdHlNYW5hZ2Vy\nfSBpbnRlcmZhY2UuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAq\nIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBj\nbGFzcyBFbnRpdHlNYW5hZ2VySW1wbAogICAgaW1wbGVtZW50cyBPcGVuSlBB\nRW50aXR5TWFuYWdlclNQSSwgRXh0ZXJuYWxpemFibGUsCiAgICBGaW5kQ2Fs\nbGJhY2tzLCBPcENhbGxiYWNrcywgQ2xvc2VhYmxlLCBPcGVuSlBBRW50aXR5\nVHJhbnNhY3Rpb24gewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoRW50aXR5TWFuYWdl\nckltcGwuY2xhc3MpOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgT2JqZWN0\nW10gRU1QVFlfT0JKRUNUUyA9IG5ldyBPYmplY3RbMF07CiAgICAKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBHRVRfTE9DS19NT0RFID0gImdl\ndExvY2tNb2RlIjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBM\nT0NLID0gImxvY2siOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5n\nIFJFRlJFU0ggPSAicmVmcmVzaCI7CgogICAgcHJpdmF0ZSBEZWxlZ2F0aW5n\nQnJva2VyIF9icm9rZXI7CiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXJGYWN0\nb3J5SW1wbCBfZW1mOwogICAgcHJpdmF0ZSBNYXA8RmV0Y2hDb25maWd1cmF0\naW9uLEZldGNoUGxhbj4gX3BsYW5zID0gbmV3IElkZW50aXR5SGFzaE1hcDxG\nZXRjaENvbmZpZ3VyYXRpb24sRmV0Y2hQbGFuPigxKTsKICAgIHByb3RlY3Rl\nZCBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRvciBfcmV0ID0gUGVyc2lzdGVu\nY2VFeGNlcHRpb25zLmdldFJvbGxiYWNrVHJhbnNsYXRvcih0aGlzKTsKCiAg\nICBwdWJsaWMgRW50aXR5TWFuYWdlckltcGwoKSB7CiAgICAgICAgLy8gZm9y\nIEV4dGVybmFsaXphYmxlCiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1\nY3Rvcjsgc3VwcGx5IGZhY3RvcnkgYW5kIGRlbGVnYXRlLgogICAgICovCiAg\nICBwdWJsaWMgRW50aXR5TWFuYWdlckltcGwoRW50aXR5TWFuYWdlckZhY3Rv\ncnlJbXBsIGZhY3RvcnksIEJyb2tlciBicm9rZXIpIHsKICAgICAgICBpbml0\naWFsaXplKGZhY3RvcnksIGJyb2tlcik7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIGluaXRpYWxpemUoRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsIGZhY3Rv\ncnksIEJyb2tlciBicm9rZXIpIHsKICAgICAgICBfZW1mID0gZmFjdG9yeTsK\nICAgICAgICBfYnJva2VyID0gbmV3IERlbGVnYXRpbmdCcm9rZXIoYnJva2Vy\nLCBfcmV0KTsKICAgICAgICBfYnJva2VyLnNldEltcGxpY2l0QmVoYXZpb3Io\ndGhpcywgX3JldCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBCcm9rZXIgZGVs\nZWdhdGUuCiAgICAgKi8KICAgIHB1YmxpYyBCcm9rZXIgZ2V0QnJva2VyKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldERlbGVnYXRlKCk7CiAgICB9\nCgogICAgcHVibGljIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBnZXRF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSgpIHsKICAgICAgICByZXR1cm4gX2VtZjsK\nICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29u\nZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDb25m\naWd1cmF0aW9uKCk7CiAgICB9CgogICAgcHVibGljIEZldGNoUGxhbiBnZXRG\nZXRjaFBsYW4oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgRmV0Y2hDb25maWd1cmF0aW9uIGZjID0gX2Jyb2tlci5nZXRGZXRj\naENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgRmV0Y2hQbGFuIGZwID0g\nX3BsYW5zLmdldChmYyk7CiAgICAgICAgICAgIGlmIChmcCA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBmcCA9IF9lbWYudG9GZXRjaFBsYW4oX2Jyb2tl\nciwgZmMpOwogICAgICAgICAgICAgICAgX3BsYW5zLnB1dChmYywgZnApOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmcDsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBfYnJva2VyLnVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgRmV0Y2hQbGFuIHB1c2hGZXRjaFBs\nYW4oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nX2Jyb2tlci5wdXNoRmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAg\nIHJldHVybiBnZXRGZXRjaFBsYW4oKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICBfYnJva2VyLnVubG9jaygpOwogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBwb3BGZXRjaFBsYW4oKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5wb3BGZXRjaENv\nbmZpZ3VyYXRpb24oKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBfYnJva2VyLnVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgQ29ubmVjdGlvblJldGFpbk1vZGUgZ2V0Q29ubmVjdGlvblJldGFpbk1v\nZGUoKSB7CiAgICAgICAgcmV0dXJuIENvbm5lY3Rpb25SZXRhaW5Nb2RlLmZy\nb21LZXJuZWxDb25zdGFudCgKICAgICAgICAgICAgX2Jyb2tlci5nZXRDb25u\nZWN0aW9uUmV0YWluTW9kZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc1RyYW5zYWN0aW9uTWFuYWdlZCgpIHsKICAgICAgICByZXR1cm4gX2Jy\nb2tlci5pc01hbmFnZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc01hbmFnZWQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNNYW5hZ2Vk\nKCk7CiAgICB9CgogICAgcHVibGljIE1hbmFnZWRSdW50aW1lIGdldE1hbmFn\nZWRSdW50aW1lKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE1hbmFn\nZWRSdW50aW1lKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0U3lu\nY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb25zKCkgewogICAgICAgIHJldHVybiBf\nYnJva2VyLmdldFN5bmNXaXRoTWFuYWdlZFRyYW5zYWN0aW9ucygpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldFN5bmNXaXRoTWFuYWdlZFRyYW5zYWN0\naW9ucyhib29sZWFuIHN5bmMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFN5bmNXaXRoTWFuYWdlZFRy\nYW5zYWN0aW9ucyhzeW5jKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NMb2Fk\nZXIgZ2V0Q2xhc3NMb2FkZXIoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nZ2V0Q2xhc3NMb2FkZXIoKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndENvbm5lY3Rpb25Vc2VyTmFtZSgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tl\nci5nZXRDb25uZWN0aW9uVXNlck5hbWUoKTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nIGdldENvbm5lY3Rpb25QYXNzd29yZCgpIHsKICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBnZXRNdWx0aXRocmVhZGVkKCkgewogICAgICAg\nIHJldHVybiBfYnJva2VyLmdldE11bHRpdGhyZWFkZWQoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRNdWx0aXRocmVhZGVkKGJvb2xlYW4gbXVsdGl0\naHJlYWRlZCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIF9icm9rZXIuc2V0TXVsdGl0aHJlYWRlZChtdWx0aXRocmVhZGVk\nKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJZ25vcmVDaGFuZ2Vz\nKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldElnbm9yZUNoYW5nZXMo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRJZ25vcmVDaGFuZ2VzKGJv\nb2xlYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5zZXRJZ25vcmVDaGFuZ2VzKHZhbCk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gZ2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQo\nKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Tm9udHJhbnNhY3Rpb25h\nbFJlYWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXROb250cmFuc2Fj\ndGlvbmFsUmVhZChib29sZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0Tm9udHJhbnNhY3Rp\nb25hbFJlYWQodmFsKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRO\nb250cmFuc2FjdGlvbmFsV3JpdGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9r\nZXIuZ2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKGJvb2xlYW4gdmFs\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXROb250cmFuc2FjdGlvbmFsV3JpdGUodmFsKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRPcHRpbWlzdGljKCkgewogICAgICAg\nIHJldHVybiBfYnJva2VyLmdldE9wdGltaXN0aWMoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRPcHRpbWlzdGljKGJvb2xlYW4gdmFsKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5z\nZXRPcHRpbWlzdGljKHZhbCk7CiAgICB9CgogICAgcHVibGljIFJlc3RvcmVT\ndGF0ZVR5cGUgZ2V0UmVzdG9yZVN0YXRlKCkgewogICAgICAgIHJldHVybiBS\nZXN0b3JlU3RhdGVUeXBlLmZyb21LZXJuZWxDb25zdGFudChfYnJva2VyLmdl\ndFJlc3RvcmVTdGF0ZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRS\nZXN0b3JlU3RhdGUoUmVzdG9yZVN0YXRlVHlwZSB2YWwpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFJl\nc3RvcmVTdGF0ZSh2YWwudG9LZXJuZWxDb25zdGFudCgpKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRSZXN0b3JlU3RhdGUoaW50IHJlc3RvcmUpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLnNldFJlc3RvcmVTdGF0ZShyZXN0b3JlKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBnZXRSZXRhaW5TdGF0ZSgpIHsKICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXRSZXRhaW5TdGF0ZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldFJldGFpblN0YXRlKGJvb2xlYW4gdmFsKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRSZXRh\naW5TdGF0ZSh2YWwpOwogICAgfQoKICAgIHB1YmxpYyBBdXRvQ2xlYXJUeXBl\nIGdldEF1dG9DbGVhcigpIHsKICAgICAgICByZXR1cm4gQXV0b0NsZWFyVHlw\nZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXRBdXRvQ2xlYXIoKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0NsZWFyKEF1dG9DbGVh\nclR5cGUgdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5zZXRBdXRvQ2xlYXIodmFsLnRvS2VybmVsQ29u\nc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0NsZWFy\nKGludCBhdXRvQ2xlYXIpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1dG9DbGVhcihhdXRvQ2xlYXIp\nOwogICAgfQoKICAgIHB1YmxpYyBEZXRhY2hTdGF0ZVR5cGUgZ2V0RGV0YWNo\nU3RhdGUoKSB7CiAgICAgICAgcmV0dXJuIERldGFjaFN0YXRlVHlwZS5mcm9t\nS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXREZXRhY2hTdGF0ZSgpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXREZXRhY2hTdGF0ZShEZXRhY2hTdGF0\nZVR5cGUgdHlwZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuc2V0RGV0YWNoU3RhdGUodHlwZS50b0tlcm5l\nbENvbnN0YW50KCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERldGFj\naFN0YXRlKGludCBkZXRhY2gpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldERldGFjaFN0YXRlKGRldGFj\naCk7CiAgICB9CgogICAgcHVibGljIEVudW1TZXQ8QXV0b0RldGFjaFR5cGU+\nIGdldEF1dG9EZXRhY2goKSB7CiAgICAgICAgcmV0dXJuIEF1dG9EZXRhY2hU\neXBlLnRvRW51bVNldChfYnJva2VyLmdldEF1dG9EZXRhY2goKSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChBdXRvRGV0YWNoVHlw\nZSBmbGFnKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKEF1dG9EZXRhY2hUeXBlLmZy\nb21FbnVtU2V0KEVudW1TZXQub2YoZmxhZykpKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRBdXRvRGV0YWNoKEVudW1TZXQ8QXV0b0RldGFjaFR5cGU+\nIGZsYWdzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKEF1dG9EZXRhY2hUeXBlLmZy\nb21FbnVtU2V0KGZsYWdzKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nQXV0b0RldGFjaChpbnQgYXV0b0RldGFjaEZsYWdzKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRv\nRGV0YWNoKGF1dG9EZXRhY2hGbGFncyk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0QXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZSB2YWx1ZSwgYm9vbGVh\nbiBvbikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZS5mcm9t\nRW51bVNldChFbnVtU2V0Lm9mKHZhbHVlKSksb24pOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldEF1dG9EZXRhY2goaW50IGZsYWcsIGJvb2xlYW4gb24p\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBf\nYnJva2VyLnNldEF1dG9EZXRhY2goZmxhZywgb24pOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGdldEV2aWN0RnJvbVN0b3JlQ2FjaGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0RXZpY3RGcm9tRGF0YUNhY2hlKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0RXZpY3RGcm9tU3RvcmVDYWNoZShi\nb29sZWFuIGV2aWN0KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgX2Jyb2tlci5zZXRFdmljdEZyb21EYXRhQ2FjaGUoZXZp\nY3QpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGdldFBvcHVsYXRlU3Rv\ncmVDYWNoZSgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRQb3B1bGF0\nZURhdGFDYWNoZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBvcHVs\nYXRlU3RvcmVDYWNoZShib29sZWFuIGNhY2hlKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRQb3B1bGF0\nZURhdGFDYWNoZShjYWNoZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naXNUcmFja0NoYW5nZXNCeVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9r\nZXIuaXNUcmFja0NoYW5nZXNCeVR5cGUoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRUcmFja0NoYW5nZXNCeVR5cGUoYm9vbGVhbiB0cmFja0J5VHlw\nZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIuc2V0VHJhY2tDaGFuZ2VzQnlUeXBlKHRyYWNrQnlUeXBlKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0xhcmdlVHJhbnNhY3Rpb24o\nKSB7CiAgICAgICAgcmV0dXJuIGlzVHJhY2tDaGFuZ2VzQnlUeXBlKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0TGFyZ2VUcmFuc2FjdGlvbihib29s\nZWFuIHZhbHVlKSB7CiAgICAgICAgc2V0VHJhY2tDaGFuZ2VzQnlUeXBlKHZh\nbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFVzZXJPYmplY3Qo\nT2JqZWN0IGtleSkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldFVzZXJP\nYmplY3Qoa2V5KTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHB1dFVzZXJP\nYmplY3QoT2JqZWN0IGtleSwgT2JqZWN0IHZhbCkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2VyLnB1\ndFVzZXJPYmplY3Qoa2V5LCB2YWwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tl\nci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKGxpc3RlbmVyKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCByZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKE9iamVj\ndCBsaXN0ZW5lcikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIucmVtb3ZlVHJhbnNhY3Rpb25MaXN0ZW5lcihs\naXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIEVudW1TZXQ8Q2FsbGJhY2tN\nb2RlPiBnZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlcygpIHsK\nICAgICAgICByZXR1cm4gQ2FsbGJhY2tNb2RlLnRvRW51bVNldCgKICAgICAg\nICAgICAgX2Jyb2tlci5nZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tN\nb2RlKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFRyYW5zYWN0aW9u\nTGlzdGVuZXJDYWxsYmFja01vZGUoQ2FsbGJhY2tNb2RlIG1vZGUpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLnNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAg\nICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChFbnVtU2V0Lm9mKG1vZGUp\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhbnNhY3Rpb25MaXN0\nZW5lckNhbGxiYWNrTW9kZShFbnVtU2V0PENhbGxiYWNrTW9kZT4gbW9kZXMp\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIuc2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZSgKICAg\nICAgICAgICAgQ2FsbGJhY2tNb2RlLmZyb21FbnVtU2V0KG1vZGVzKSk7CiAg\nICB9CgogICAgcHVibGljIGludCBnZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldFRyYW5z\nYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKGlu\ndCBjYWxsYmFja01vZGUpIHsKICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0\nZWRPcGVyYXRpb25FeGNlcHRpb24oKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBhZGRMaWZlY3ljbGVMaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIsIENsYXNz\nLi4uIGNsYXNzZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLmFkZExpZmVjeWNsZUxpc3RlbmVyKGxpc3Rl\nbmVyLCBjbGFzc2VzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVM\naWZlY3ljbGVMaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJlbW92\nZUxpZmVjeWNsZUxpc3RlbmVyKGxpc3RlbmVyKTsKICAgIH0KCiAgICBwdWJs\naWMgRW51bVNldDxDYWxsYmFja01vZGU+IGdldExpZmVjeWNsZUxpc3RlbmVy\nQ2FsbGJhY2tNb2RlcygpIHsKICAgICAgICByZXR1cm4gQ2FsbGJhY2tNb2Rl\nLnRvRW51bVNldCgKICAgICAgICAgICAgX2Jyb2tlci5nZXRMaWZlY3ljbGVM\naXN0ZW5lckNhbGxiYWNrTW9kZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZShDYWxsYmFja01v\nZGUgbW9kZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIF9icm9rZXIuc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01v\nZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChFbnVt\nU2V0Lm9mKG1vZGUpKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TGlm\nZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoRW51bVNldDxDYWxsYmFja01v\nZGU+IG1vZGVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5zZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNr\nTW9kZSgKICAgICAgICAgICAgQ2FsbGJhY2tNb2RlLmZyb21FbnVtU2V0KG1v\nZGVzKSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRMaWZlY3ljbGVMaXN0\nZW5lckNhbGxiYWNrTW9kZSgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2Rl\nKGludCBjYWxsYmFja01vZGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldExpZmVjeWNsZUxpc3RlbmVy\nQ2FsbGJhY2tNb2RlKGNhbGxiYWNrTW9kZSk7CiAgICB9CgogICAgQFN1cHBy\nZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IFQgZ2V0\nUmVmZXJlbmNlKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIG9pZCA9IF9icm9r\nZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQpOwogICAgICAgIHJldHVybiAoVCkg\nX2Jyb2tlci5maW5kKG9pZCwgZmFsc2UsIHRoaXMpOwogICAgfQoKICAgIEBT\ndXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBU\nIGZpbmQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lkKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgaWYgKG9pZCA9PSBudWxs\nKQogICAgICAgIAlyZXR1cm4gbnVsbDsKICAgICAgICBvaWQgPSBfYnJva2Vy\nLm5ld09iamVjdElkKGNscywgb2lkKTsKICAgICAgICByZXR1cm4gKFQpIF9i\ncm9rZXIuZmluZChvaWQsIHRydWUsIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCwgTG9ja01v\nZGVUeXBlIG1vZGUpIHsKICAgICAgICByZXR1cm4gZmluZChjbHMsIG9pZCwg\nbW9kZSwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIDxUPiBUIGZpbmQoQ2xh\nc3M8VD4gY2xzLCBPYmplY3Qgb2lkLCAKICAgICAgICBNYXA8U3RyaW5nLCBP\nYmplY3Q+IHByb3BlcnRpZXMpewogICAgICAgIHJldHVybiBmaW5kKGNscywg\nb2lkLCBudWxsLCBwcm9wZXJ0aWVzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NX\nYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENs\nYXNzPFQ+IGNscywgT2JqZWN0IG9pZCwgTG9ja01vZGVUeXBlIG1vZGUsIE1h\ncDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHByb3BlcnRpZXMgPSBjbG9u\nZVByb3BlcnRpZXMocHJvcGVydGllcyk7CiAgICAgICAgY29uZmlndXJlQ3Vy\ncmVudENhY2hlTW9kZXMocHVzaEZldGNoUGxhbigpLCBwcm9wZXJ0aWVzKTsK\nICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKGdldEZldGNoUGxh\nbigpLCBwcm9wZXJ0aWVzLCBtb2RlLCB0cnVlKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBvaWQgPSBfYnJva2VyLm5ld09iamVjdElkKGNscywgb2lk\nKTsKICAgICAgICAgICAgcmV0dXJuIChUKSBfYnJva2VyLmZpbmQob2lkLCB0\ncnVlLCB0aGlzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBw\nb3BGZXRjaFBsYW4oKTsKICAgICAgICB9CiAgICB9CgogICAgQFN1cHByZXNz\nV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IFRbXSBmaW5k\nQWxsKENsYXNzPFQ+IGNscywgT2JqZWN0Li4uIG9pZHMpIHsKICAgICAgICBp\nZiAob2lkcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIChUW10p\nIEFycmF5Lm5ld0luc3RhbmNlKGNscywgMCk7CiAgICAgICAgQ29sbGVjdGlv\nbjxUPiByZXQgPSBmaW5kQWxsKGNscywgQXJyYXlzLmFzTGlzdChvaWRzKSk7\nCiAgICAgICAgcmV0dXJuIHJldC50b0FycmF5KChUW10pIEFycmF5Lm5ld0lu\nc3RhbmNlKGNscywgcmV0LnNpemUoKSkpOwogICAgfQoKICAgIEBTdXBwcmVz\nc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBDb2xsZWN0\naW9uPFQ+IGZpbmRBbGwoZmluYWwgQ2xhc3M8VD4gY2xzLCBDb2xsZWN0aW9u\nIG9pZHMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBPYmplY3RbXSBvYmpzID0gX2Jyb2tlci5maW5kQWxsKG9pZHMsIHRy\ndWUsIG5ldyBGaW5kQ2FsbGJhY2tzKCkgewogICAgICAgICAgICBwdWJsaWMg\nT2JqZWN0IHByb2Nlc3NBcmd1bWVudChPYmplY3Qgb2lkKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gX2Jyb2tlci5uZXdPYmplY3RJZChjbHMsIG9pZCk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgcHJv\nY2Vzc1JldHVybihPYmplY3Qgb2lkLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRW50aXR5TWFuYWdlckltcGwu\ndGhpcy5wcm9jZXNzUmV0dXJuKG9pZCwgc20pOwogICAgICAgICAgICB9CiAg\nICAgICAgfSk7CiAgICAgICAgcmV0dXJuIChDb2xsZWN0aW9uPFQ+KSBBcnJh\neXMuYXNMaXN0KG9ianMpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdz\nKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUIGZpbmRDYWNoZWQoQ2xh\nc3M8VD4gY2xzLCBPYmplY3Qgb2lkKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIChUKSBfYnJva2VyLmZpbmRD\nYWNoZWQoX2Jyb2tlci5uZXdPYmplY3RJZChjbHMsIG9pZCksIHRoaXMpOwog\nICAgfQoKICAgIHB1YmxpYyBDbGFzcyBnZXRPYmplY3RJZENsYXNzKENsYXNz\nIGNscykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIGlmIChjbHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci5mcm9tT3BlbkpQQU9i\namVjdElkQ2xhc3MKICAgICAgICAgICAgICAgIChfYnJva2VyLmdldE9iamVj\ndElkVHlwZShjbHMpKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUVudGl0\neVRyYW5zYWN0aW9uIGdldFRyYW5zYWN0aW9uKCkgewogICAgICAgIGlmIChf\nYnJva2VyLmlzTWFuYWdlZCgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52\nYWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJnZXQtbWFuYWdlZC10cmFu\ncyIpLAogICAgICAgICAgICAgICAgbnVsbCwgbnVsbCwgZmFsc2UpOwogICAg\nICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGpvaW5U\ncmFuc2FjdGlvbigpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBpZiAoIV9icm9rZXIuc3luY1dpdGhNYW5hZ2VkVHJhbnNh\nY3Rpb24oKSkKICAgICAgICAgICAgdGhyb3cgbmV3IFRyYW5zYWN0aW9uUmVx\ndWlyZWRFeGNlcHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICgibm8t\nbWFuYWdlZC10cmFucyIpLCBudWxsLCBudWxsLCBmYWxzZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgYmVnaW4oKSB7CiAgICAgICAgX2Jyb2tlci5iZWdp\nbigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvbW1pdCgpIHsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBfYnJva2VyLmNvbW1pdCgpOwogICAgICAg\nIH0gY2F0Y2ggKFJvbGxiYWNrRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\ndGhyb3cgZTsKICAgICAgICB9IGNhdGNoIChJbGxlZ2FsU3RhdGVFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgCS8vIFBlciBKUEEgMi4wIHNwZWMs\nIGlmIHRoZSBleGNlcHRpb24gd2FzIGR1ZSB0byBhIEpTUi0zMDMgCiAgICAg\nICAgICAgIC8vIGNvbnN0cmFpbnQgdmlvbGF0aW9uLCB0aGUgQ29uc3RyYWlu\ndFZpb2xhdGlvbkV4Y2VwdGlvbiBzaG91bGQgYmUgCiAgICAgICAgICAgIC8v\nIHRocm93bi4gIFNpbmNlIEpTUi0zMDMgaXMgb3B0aW9uYWwsIHRoZSBjYXN0\nIHRvIFJ1bnRpbWVFeGNlcHRpb24gCiAgICAgICAgICAgIC8vIHByZXZlbnRz\nIHRoZSBpbnRyb2R1Y3Rpb24gb2YgYSBydW50aW1lIGRlcGVuZGVuY3kgb24g\ndGhlIEJWIEFQSS4KICAgICAgICAgICAgaWYgKFZhbGlkYXRpb25VdGlscy5p\nc0NvbnN0cmFpbnRWaW9sYXRpb25FeGNlcHRpb24oZSkpCiAgICAgICAgICAg\nICAgICB0aHJvdyAoUnVudGltZUV4Y2VwdGlvbillOwogICAgICAgICAgICAv\nLyBSb2xsYmFja0V4Y2VwdGlvbnMgYXJlIHNwZWNpYWwgYW5kIGFyZW4ndCBo\nYW5kbGVkIGJ5IHRoZQogICAgICAgICAgICAvLyBub3JtYWwgZXhjZXB0aW9u\nIHRyYW5zbGF0b3IsIHNpbmNlIHRoZSBzcGVjIHNheXMgdGhleQogICAgICAg\nICAgICAvLyBzaG91bGQgYmUgdGhyb3duIHdoZW5ldmVyIHRoZSBjb21taXQg\nZmFpbHMgZm9yIGFueSByZWFzb24gYXQKICAgICAgICAgICAgLy8gYWxsLCB3\naGVyYXMgdGhlIGV4Y2VwdGlvbiB0cmFuc2xhdG9yIGhhbmRsZXMgZXhjZXB0\naW9ucyB0aGF0CiAgICAgICAgICAgIC8vIGFyZSBjYXVzZWQgZm9yIHNwZWNp\nZmljIHJlYXNvbnMgICAgICAgICAgICAKCiAgICAgICAgICAgIC8vIHBhc3Mg\nYWxvbmcgdGhlIGZhaWxlZCBvYmplY3QgaWYgb25lIGlzIGF2YWlsYWJsZS4K\nICAgICAgICAgICAgT2JqZWN0IGZhaWxlZE9iamVjdCA9IG51bGw7CiAgICAg\nICAgICAgIGlmIChlIGluc3RhbmNlb2YgRXhjZXB0aW9uSW5mbyl7CiAgICAg\nICAgICAgIAlmYWlsZWRPYmplY3QgPSAoKEV4Y2VwdGlvbkluZm8pZSkuZ2V0\nRmFpbGVkT2JqZWN0KCk7ICAgICAgICAgICAgCQogICAgICAgICAgICB9CiAg\nICAgICAgICAgIAogICAgICAgICAgICB0aHJvdyBuZXcgUm9sbGJhY2tFeGNl\ncHRpb24oZSkuc2V0RmFpbGVkT2JqZWN0KGZhaWxlZE9iamVjdCk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrKCkgewogICAg\nICAgIF9icm9rZXIucm9sbGJhY2soKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBjb21taXRBbmRSZXN1bWUoKSB7CiAgICAgICAgX2Jyb2tlci5jb21taXRB\nbmRSZXN1bWUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByb2xsYmFja0Fu\nZFJlc3VtZSgpIHsKICAgICAgICBfYnJva2VyLnJvbGxiYWNrQW5kUmVzdW1l\nKCk7CiAgICB9CgogICAgcHVibGljIFRocm93YWJsZSBnZXRSb2xsYmFja0Nh\ndXNlKCkgewogICAgICAgIGlmICghaXNBY3RpdmUoKSkKICAgICAgICAgICAg\ndGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibm8t\ndHJhbnNhY3Rpb24iKQogICAgICAgICAgICAgICAgLmdldE1lc3NhZ2UoKSk7\nCgogICAgICAgIHJldHVybiBfYnJva2VyLmdldFJvbGxiYWNrQ2F1c2UoKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRSb2xsYmFja09ubHkoKSB7\nCiAgICAgICAgaWYgKCFpc0FjdGl2ZSgpKQogICAgICAgICAgICB0aHJvdyBu\nZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby10cmFuc2Fj\ndGlvbiIpCiAgICAgICAgICAgICAgICAuZ2V0TWVzc2FnZSgpKTsKCiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0Um9sbGJhY2tPbmx5KCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0Um9sbGJhY2tPbmx5KCkgewogICAgICAgIF9i\ncm9rZXIuc2V0Um9sbGJhY2tPbmx5KCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0Um9sbGJhY2tPbmx5KFRocm93YWJsZSBjYXVzZSkgewogICAgICAg\nIF9icm9rZXIuc2V0Um9sbGJhY2tPbmx5KGNhdXNlKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRTYXZlcG9pbnQoU3RyaW5nIG5hbWUpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndFNhdmVwb2ludChuYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByb2xs\nYmFja1RvU2F2ZXBvaW50KCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIucm9sbGJhY2tUb1NhdmVwb2ludCgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrVG9TYXZlcG9pbnQo\nU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnJvbGxiYWNrVG9TYXZlcG9pbnQobmFtZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcmVsZWFzZVNhdmVwb2ludCgpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLnJlbGVhc2VTYXZlcG9pbnQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCByZWxlYXNlU2F2ZXBvaW50KFN0cmluZyBuYW1lKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5yZWxlYXNl\nU2F2ZXBvaW50KG5hbWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGZsdXNo\nKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIuYXNzZXJ0T3BlbigpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0\nQWN0aXZlVHJhbnNhY3Rpb24oKTsKICAgICAgICBfYnJva2VyLmZsdXNoKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcHJlRmx1c2goKSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5wcmVG\nbHVzaCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHZhbGlkYXRlQ2hhbmdl\ncygpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLnZhbGlkYXRlQ2hhbmdlcygpOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGlzQWN0aXZlKCkgewogICAgICAgIHJldHVybiBpc09wZW4o\nKSAmJiBfYnJva2VyLmlzQWN0aXZlKCk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaXNTdG9yZUFjdGl2ZSgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tl\nci5pc1N0b3JlQWN0aXZlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYmVn\naW5TdG9yZSgpIHsKICAgICAgICBfYnJva2VyLmJlZ2luU3RvcmUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWlucyhPYmplY3QgZW50aXR5\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\naWYgKGVudGl0eSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IF9icm9rZXIuZ2V0\nU3RhdGVNYW5hZ2VyKGVudGl0eSk7CiAgICAgICAgaWYgKHNtID09IG51bGwK\nICAgICAgICAgICAgJiYgIUltcGxIZWxwZXIuaXNNYW5hZ2VkVHlwZShnZXRD\nb25maWd1cmF0aW9uKCksIGVudGl0eS5nZXRDbGFzcygpKSkKICAgICAgICAg\nICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJub3Qt\nZW50aXR5IiwKICAgICAgICAgICAgICAgIGVudGl0eS5nZXRDbGFzcygpKSwg\nbnVsbCwgbnVsbCwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIHNtICE9IG51bGwg\nJiYgIXNtLmlzRGVsZXRlZCgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGNvbnRhaW5zQWxsKE9iamVjdC4uLiBlbnRpdGllcykgewogICAgICAgIGZv\nciAoT2JqZWN0IGVudGl0eSA6IGVudGl0aWVzKQogICAgICAgICAgICBpZiAo\nIWNvbnRhaW5zKGVudGl0eSkpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gY29udGFpbnNBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAg\nICAgIGZvciAoT2JqZWN0IGVudGl0eSA6IGVudGl0aWVzKQogICAgICAgICAg\nICBpZiAoIWNvbnRhaW5zKGVudGl0eSkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcGVyc2lzdChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5wZXJzaXN0\nKGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcGVyc2lz\ndEFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICBwZXJzaXN0QWxs\nKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBwZXJzaXN0QWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnBl\ncnNpc3RBbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHJlbW92ZShPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5kZWxldGUoZW50aXR5\nLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVBbGwoT2Jq\nZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVtb3ZlQWxsKEFycmF5cy5h\nc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1v\ndmVBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZGVsZXRlQWxsKGVu\ndGl0aWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWxlYXNl\nKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2UoZW50aXR5LCB0aGlzKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWxlYXNlQWxsKENvbGxlY3Rpb24g\nZW50aXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLnJlbGVhc2VBbGwoZW50aXRpZXMsIHRoaXMpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VBbGwoT2JqZWN0Li4uIGVu\ndGl0aWVzKSB7CiAgICAgICAgcmVsZWFzZUFsbChBcnJheXMuYXNMaXN0KGVu\ndGl0aWVzKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVmcmVzaChPYmpl\nY3QgZW50aXR5KSB7CiAgICAgICAgcmVmcmVzaChlbnRpdHksIG51bGwsIG51\nbGwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2goT2JqZWN0IGVu\ndGl0eSwgTG9ja01vZGVUeXBlIG1vZGUpIHsKICAgICAgICByZWZyZXNoKGVu\ndGl0eSwgbW9kZSwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVm\ncmVzaChPYmplY3QgZW50aXR5LCBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3Bl\ncnRpZXMpIHsKICAgICAgICByZWZyZXNoKGVudGl0eSwgbnVsbCwgcHJvcGVy\ndGllcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVmcmVzaChPYmplY3Qg\nZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwgTWFwPFN0cmluZywgT2JqZWN0\nPiBwcm9wZXJ0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRBdHRjaGVkRW50aXR5KFJFRlJFU0gs\nIGVudGl0eSk7CgogICAgICAgIF9icm9rZXIuYXNzZXJ0V3JpdGVPcGVyYXRp\nb24oKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKHB1c2hG\nZXRjaFBsYW4oKSwgcHJvcGVydGllcywgbW9kZSwgdHJ1ZSk7CiAgICAgICAg\nRGF0YUNhY2hlUmV0cmlldmVNb2RlIHJtb2RlID0gZ2V0RmV0Y2hQbGFuKCku\nZ2V0Q2FjaGVSZXRyaWV2ZU1vZGUoKTsKICAgICAgICBpZiAoRGF0YUNhY2hl\nUmV0cmlldmVNb2RlLlVTRS5lcXVhbHMocm1vZGUpIHx8IHJtb2RlID09IG51\nbGwpIHsKICAgICAgICAgICAgZ2V0RmV0Y2hQbGFuKCkuc2V0Q2FjaGVSZXRy\naWV2ZU1vZGUoRGF0YUNhY2hlUmV0cmlldmVNb2RlLkJZUEFTUyk7CiAgICAg\nICAgICAgIGlmIChybW9kZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBM\nb2cgbG9nID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCkuZ2V0Q29uZmln\ndXJhdGlvbkxvZygpOwogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5n\nZXQoImNhY2hlLXJldHJpZXZlLW92ZXJyaWRlIiwgRXhjZXB0aW9ucy50b1N0\ncmluZyhlbnRpdHkpKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5yZWZyZXNoKGVudGl0eSwg\ndGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgcG9wRmV0\nY2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nZnJlc2hBbGwoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9wZXJhdGlvbigpOwogICAg\nICAgIF9icm9rZXIucmVmcmVzaEFsbChfYnJva2VyLmdldFRyYW5zYWN0aW9u\nYWxPYmplY3RzKCksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nZnJlc2hBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0V3Jp\ndGVPcGVyYXRpb24oKTsKICAgICAgICBfYnJva2VyLnJlZnJlc2hBbGwoZW50\naXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hB\nbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVmcmVzaEFsbChB\ncnJheXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmV0cmlldmUoT2JqZWN0IGVudGl0eSkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmV0cmlldmUoZW50\naXR5LCB0cnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZXRy\naWV2ZUFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5yZXRyaWV2ZUFs\nbChlbnRpdGllcywgdHJ1ZSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmV0cmlldmVBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAg\ncmV0cmlldmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGV2aWN0KE9iamVjdCBlbnRpdHkpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmV2\naWN0KGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZXZp\nY3RBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RBbGwoZW50\naXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2aWN0QWxs\nKE9iamVjdC4uLiBlbnRpdGllcykgewogICAgICAgIGV2aWN0QWxsKEFycmF5\ncy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBl\ndmljdEFsbCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLmV2aWN0QWxsKHRoaXMpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGV2aWN0QWxsKENsYXNzIGNscykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RBbGwo\nX2Jyb2tlci5uZXdFeHRlbnQoY2xzLCB0cnVlKSwgdGhpcyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgZXZpY3RBbGwoRXh0ZW50IGV4dGVudCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nZXZpY3RBbGwoKChFeHRlbnRJbXBsKSBleHRlbnQpLmdldERlbGVnYXRlKCks\nIHRoaXMpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNr\nZWQiKQogICAgcHVibGljIDxUPiBUIGRldGFjaENvcHkoVCBlbnRpdHkpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBDb21w\nYXRpYmlsaXR5IGNvbXBhdCA9IHRoaXMuZ2V0Q29uZmlndXJhdGlvbigpLgog\nICAgICAgICAgICBnZXRDb21wYXRpYmlsaXR5SW5zdGFuY2UoKTsKICAgICAg\nICBib29sZWFuIGNvcHlPbkRldGFjaCA9IGNvbXBhdC5nZXRDb3B5T25EZXRh\nY2goKTsKICAgICAgICBib29sZWFuIGNhc2NhZGVXaXRoRGV0YWNoID0gY29t\ncGF0LmdldENhc2NhZGVXaXRoRGV0YWNoKCk7CiAgICAgICAgLy8gU2V0IGNv\nbXBhdGliaWxpdHkgb3B0aW9ucyB0byBnZXQgMS54IGRldGFjaCBiZWhhdmlv\ncgogICAgICAgIGNvbXBhdC5zZXRDb3B5T25EZXRhY2godHJ1ZSk7CiAgICAg\nICAgY29tcGF0LnNldENhc2NhZGVXaXRoRGV0YWNoKHRydWUpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIFQgdCA9IChUKV9icm9rZXIuZGV0YWNoKGVu\ndGl0eSwgdGhpcyk7CiAgICAgICAgICAgIHJldHVybiB0OwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIC8vIFJlc2V0IGNvbXBhdGliaWxpdHkg\nb3B0aW9ucwogICAgICAgICAgICBjb21wYXQuc2V0Q29weU9uRGV0YWNoKGNv\ncHlPbkRldGFjaCk7CiAgICAgICAgICAgIGNvbXBhdC5zZXRDYXNjYWRlV2l0\naERldGFjaChjYXNjYWRlV2l0aERldGFjaCk7CiAgICAgICAgfSAgICAgICAg\nCiAgICB9CgogICAgcHVibGljIE9iamVjdFtdIGRldGFjaEFsbChPYmplY3Qu\nLi4gZW50aXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5kZXRhY2hBbGwoQXJyYXlzLmFz\nTGlzdChlbnRpdGllcyksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBDb2xs\nZWN0aW9uIGRldGFjaEFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIEFy\ncmF5cy5hc0xpc3QoX2Jyb2tlci5kZXRhY2hBbGwoZW50aXRpZXMsIHRoaXMp\nKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikK\nICAgIHB1YmxpYyA8VD4gVCBtZXJnZShUIGVudGl0eSkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jy\nb2tlci5hdHRhY2goZW50aXR5LCB0cnVlLCB0aGlzKTsKICAgIH0KCiAgICBw\ndWJsaWMgT2JqZWN0W10gbWVyZ2VBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7\nCiAgICAgICAgaWYgKGVudGl0aWVzLmxlbmd0aCA9PSAwKQogICAgICAgICAg\nICByZXR1cm4gRU1QVFlfT0JKRUNUUzsKICAgICAgICByZXR1cm4gbWVyZ2VB\nbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpLnRvQXJyYXkoKTsKICAgIH0K\nCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBtZXJnZUFsbChDb2xsZWN0aW9uIGVu\ndGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgcmV0dXJuIEFycmF5cy5hc0xpc3QoX2Jyb2tlci5hdHRhY2hBbGwo\nZW50aXRpZXMsIHRydWUsIHRoaXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0cmFuc2FjdGlvbmFsKE9iamVjdCBlbnRpdHksIGJvb2xlYW4gdXBkYXRl\nVmVyc2lvbikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIF9icm9rZXIudHJhbnNhY3Rpb25hbChlbnRpdHksIHVwZGF0ZVZl\ncnNpb24sIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRyYW5zYWN0\naW9uYWxBbGwoQ29sbGVjdGlvbiBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNp\nb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLnRyYW5zYWN0aW9uYWxBbGwob2JqcywgdXBkYXRlVmVyc2lv\nbiwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdHJhbnNhY3Rpb25h\nbEFsbChPYmplY3RbXSBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNpb24pIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLnRyYW5zYWN0aW9uYWxBbGwoQXJyYXlzLmFzTGlzdChvYmpzKSwgdXBk\nYXRlVmVyc2lvbiwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbm9u\ndHJhbnNhY3Rpb25hbChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5ub250cmFuc2Fj\ndGlvbmFsKGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nbm9udHJhbnNhY3Rpb25hbEFsbChDb2xsZWN0aW9uIG9ianMpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLm5v\nbnRyYW5zYWN0aW9uYWxBbGwob2JqcywgdGhpcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgbm9udHJhbnNhY3Rpb25hbEFsbChPYmplY3RbXSBvYmpzKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci5ub250cmFuc2FjdGlvbmFsQWxsKEFycmF5cy5hc0xpc3Qob2Jqcyks\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0TmFtZWRH\nZW5lcmF0b3IoU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTZXF1ZW5j\nZU1ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4K\nICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNl\nKCkuZ2V0U2VxdWVuY2VNZXRhRGF0YShuYW1lLAogICAgICAgICAgICAgICAg\nX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICAgICAg\nU2VxIHNlcSA9IG1ldGEuZ2V0SW5zdGFuY2UoX2Jyb2tlci5nZXRDbGFzc0xv\nYWRlcigpKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmF0b3JJbXBs\nKHNlcSwgbmFtZSwgX2Jyb2tlciwgbnVsbCk7CiAgICAgICAgfSBjYXRjaCAo\nUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0aHJvdyBQZXJz\naXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihyZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0SWRH\nZW5lcmF0b3IoQ2xhc3MgZm9yQ2xhc3MpIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFz\nc01ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4K\nICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNl\nKCkuZ2V0TWV0YURhdGEoZm9yQ2xhc3MsCiAgICAgICAgICAgICAgICBfYnJv\na2VyLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBTZXEg\nc2VxID0gX2Jyb2tlci5nZXRJZGVudGl0eVNlcXVlbmNlKG1ldGEpOwogICAg\nICAgICAgICByZXR1cm4gKHNlcSA9PSBudWxsKSA/IG51bGwgOiBuZXcgR2Vu\nZXJhdG9ySW1wbChzZXEsIG51bGwsIF9icm9rZXIsCiAgICAgICAgICAgICAg\nICBtZXRhKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0\nZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIEdlbmVyYXRvciBnZXRGaWVsZEdlbmVyYXRvcihDbGFzcyBmb3JDbGFzcywg\nU3RyaW5nIGZpZWxkTmFtZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzTWV0YURh\ndGEgbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAg\nICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRN\nZXRhRGF0YShmb3JDbGFzcywKICAgICAgICAgICAgICAgIF9icm9rZXIuZ2V0\nQ2xhc3NMb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAgICAgIEZpZWxkTWV0YURh\ndGEgZm1kID0gbWV0YS5nZXRGaWVsZChmaWVsZE5hbWUpOwogICAgICAgICAg\nICBpZiAoZm1kID09IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5vLW5hbWVkLWZpZWxkIiwK\nICAgICAgICAgICAgICAgICAgICBmb3JDbGFzcywgZmllbGROYW1lKSwgbnVs\nbCwgbnVsbCwgZmFsc2UpOwoKICAgICAgICAgICAgU2VxIHNlcSA9IF9icm9r\nZXIuZ2V0VmFsdWVTZXF1ZW5jZShmbWQpOwogICAgICAgICAgICByZXR1cm4g\nKHNlcSA9PSBudWxsKSA/IG51bGwgOiBuZXcgR2VuZXJhdG9ySW1wbChzZXEs\nIG51bGwsIF9icm9rZXIsCiAgICAgICAgICAgICAgICBtZXRhKTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQ\nZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihl\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIDxUPiBFeHRlbnQ8VD4g\nY3JlYXRlRXh0ZW50KENsYXNzPFQ+IGNscywgYm9vbGVhbiBzdWJjbGFzc2Vz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIG5ldyBFeHRlbnRJbXBsPFQ+KHRoaXMsIF9icm9rZXIubmV3RXh0\nZW50KGNscywgc3ViY2xhc3NlcykpOwogICAgfQoKICAgIEBTdXBwcmVzc1dh\ncm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUeXBlZFF1ZXJ5\nPFQ+IGNyZWF0ZVF1ZXJ5KFN0cmluZyBxdWVyeSwgQ2xhc3M8VD4gcmVzdWx0\nQ2xhc3MpIHsKICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnkocXVlcnkpLnNl\ndFJlc3VsdENsYXNzKHJlc3VsdENsYXNzKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIE9wZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShTdHJpbmcgcXVlcnkpIHsK\nICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQ\nUUwsIHF1ZXJ5KTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNy\nZWF0ZVF1ZXJ5KFN0cmluZyBsYW5ndWFnZSwgU3RyaW5nIHF1ZXJ5KSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgU3RyaW5nIHFpZCA9IHF1ZXJ5OwogICAgICAgICAgICBQ\ncmVwYXJlZFF1ZXJ5IHBxID0gSlBRTFBhcnNlci5MQU5HX0pQUUwuZXF1YWxz\nKGxhbmd1YWdlKQogICAgICAgICAgICAgICAgPyBnZXRQcmVwYXJlZFF1ZXJ5\nKHFpZCkgOiBudWxsOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlF1ZXJ5IHEgPSAocHEgPT0gbnVsbCB8fCAhcHEuaXNJbml0aWFs\naXplZCgpKQogICAgICAgICAgICAgICAgPyBfYnJva2VyLm5ld1F1ZXJ5KGxh\nbmd1YWdlLCBxdWVyeSkKICAgICAgICAgICAgICAgIDogX2Jyb2tlci5uZXdR\ndWVyeShwcS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAgICAgICAgICAgIC8vIGhh\ndmUgdG8gdmFsaWRhdGUgSlBRTCBhY2NvcmRpbmcgdG8gc3BlYwogICAgICAg\nICAgICBpZiAocHEgPT0gbnVsbCAmJiBKUFFMUGFyc2VyLkxBTkdfSlBRTC5l\ncXVhbHMobGFuZ3VhZ2UpKQogICAgICAgICAgICAgICAgcS5jb21waWxlKCk7\nIAogICAgICAgICAgICBpZiAocHEgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgcHEuc2V0SW50byhxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBy\nZXR1cm4gbmV3UXVlcnlJbXBsKHEpLnNldElkKHFpZCk7CiAgICAgICAgfSBj\nYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0aHJv\ndyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlv\nbihyZSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgT3BlbkpQ\nQVF1ZXJ5IGNyZWF0ZVF1ZXJ5KFF1ZXJ5IHF1ZXJ5KSB7CiAgICAgICAgaWYg\nKHF1ZXJ5ID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBjcmVhdGVRdWVy\neSgoU3RyaW5nKSBudWxsKTsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5\nIHEgPSAoKFF1ZXJ5SW1wbCkgcXVlcnkpLmdldERlbGVnYXRlKCk7CiAgICAg\nICAgcmV0dXJuIG5ld1F1ZXJ5SW1wbChfYnJva2VyLm5ld1F1ZXJ5KHEuZ2V0\nTGFuZ3VhZ2UoKSwgcSkpOwogICAgfQogICAgCiAgICBAU3VwcHJlc3NXYXJu\naW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVHlwZWRRdWVyeTxU\nPiBjcmVhdGVOYW1lZFF1ZXJ5KFN0cmluZyBuYW1lLCBDbGFzczxUPiByZXN1\nbHRDbGFzcykgewogICAgICAgIHJldHVybiBjcmVhdGVOYW1lZFF1ZXJ5KG5h\nbWUpLnNldFJlc3VsdENsYXNzKHJlc3VsdENsYXNzKTsKICAgIH0KCiAgICBw\ndWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hbWVkUXVlcnkoU3RyaW5nIG5h\nbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLmFzc2VydE9wZW4oKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBRdWVyeU1ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3Vy\nYXRpb24oKS4KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9y\neUluc3RhbmNlKCkuZ2V0UXVlcnlNZXRhRGF0YShudWxsLCBuYW1lLAogICAg\nICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsK\nICAgICAgICAgICAgU3RyaW5nIHFpZCA9IG1ldGEuZ2V0UXVlcnlTdHJpbmco\nKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIFByZXBhcmVkUXVlcnkgcHEg\nPSBKUFFMUGFyc2VyLkxBTkdfSlBRTC5lcXVhbHMobWV0YS5nZXRMYW5ndWFn\nZSgpKQogICAgICAgICAgICAgICAgPyBnZXRQcmVwYXJlZFF1ZXJ5KHFpZCkg\nOiBudWxsOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLlF1ZXJ5IGRlbCA9IChwcSA9PSBudWxsIHx8ICFwcS5pc0luaXRpYWxpemVk\nKCkpCiAgICAgICAgICAgICAgICA/IF9icm9rZXIubmV3UXVlcnkobWV0YS5n\nZXRMYW5ndWFnZSgpLCBtZXRhLmdldFF1ZXJ5U3RyaW5nKCkpCiAgICAgICAg\nICAgICAgICA6IF9icm9rZXIubmV3UXVlcnkocHEuZ2V0TGFuZ3VhZ2UoKSwg\ncHEpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHBxICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgIHBxLnNldEludG8oZGVsKTsKICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG1ldGEuc2V0SW50byhkZWwp\nOwogICAgICAgICAgICAgICAgZGVsLmNvbXBpbGUoKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICAKICAgICAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBu\nZXdRdWVyeUltcGwoZGVsKS5zZXRJZChxaWQpOwogICAgICAgICAgICBTdHJp\nbmdbXSBoaW50cyA9IG1ldGEuZ2V0SGludEtleXMoKTsKICAgICAgICAgICAg\nT2JqZWN0W10gdmFsdWVzID0gbWV0YS5nZXRIaW50VmFsdWVzKCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaGludHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBxLnNldEhpbnQoaGludHNbaV0sIHZhbHVlc1tp\nXSk7CiAgICAgICAgICAgIHJldHVybiBxOwogICAgICAgIH0gY2F0Y2ggKFJ1\nbnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cgUGVyc2lz\ndGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24ocmUpOwog\nICAgICAgIH0KICAgIH0gICAgCgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBj\ncmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVlcnkpIHsKICAgICAgICB2YWxp\nZGF0ZVNRTChxdWVyeSk7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KFF1\nZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLCBxdWVyeSk7CiAgICB9CgogICAgcHVi\nbGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVl\ncnksIENsYXNzIGNscykgewogICAgICAgIHJldHVybiBjcmVhdGVOYXRpdmVR\ndWVyeShxdWVyeSkuc2V0UmVzdWx0Q2xhc3MoY2xzKTsKICAgIH0KCiAgICBw\ndWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hdGl2ZVF1ZXJ5KFN0cmluZyBx\ndWVyeSwgU3RyaW5nIG1hcHBpbmdOYW1lKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgdmFsaWRhdGVTUUwocXVlcnkpOwog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkga2VybmVs\nUXVlcnkgPSBfYnJva2VyLm5ld1F1ZXJ5KAogICAgICAgICAgICBRdWVyeUxh\nbmd1YWdlcy5MQU5HX1NRTCwgcXVlcnkpOwogICAgICAgIGtlcm5lbFF1ZXJ5\nLnNldFJlc3VsdE1hcHBpbmcobnVsbCwgbWFwcGluZ05hbWUpOwogICAgICAg\nIHJldHVybiBuZXdRdWVyeUltcGwoa2VybmVsUXVlcnkpOwogICAgfQoKICAg\nIHByb3RlY3RlZCA8VD4gUXVlcnlJbXBsPFQ+IG5ld1F1ZXJ5SW1wbChvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IGtlcm5lbFF1ZXJ5KSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBRdWVyeUltcGw8VD4odGhpcywgX3JldCwga2Vy\nbmVsUXVlcnkpOwogICAgfQoKICAgIC8qKgogICAgICogVmFsaWRhdGUgdGhh\ndCB0aGUgdXNlciBwcm92aWRlZCBTUUwuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIHZhbGlkYXRlU1FMKFN0cmluZyBxdWVyeSkgewogICAgICAgIGlm\nIChTdHJpbmdVdGlscy50cmltVG9OdWxsKHF1ZXJ5KSA9PSBudWxsKQogICAg\nICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQo\nIm5vLXNxbCIpLCBudWxsLCBudWxsLCBmYWxzZSk7CiAgICB9CiAgICAKICAg\nIFByZXBhcmVkUXVlcnlDYWNoZSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKSB7\nCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q2FjaGVQcmVwYXJlZFF1ZXJ5\nKCkgPwogICAgICAgICAgICBnZXRDb25maWd1cmF0aW9uKCkuZ2V0UXVlcnlT\nUUxDYWNoZUluc3RhbmNlKCkgOiBudWxsOwogICAgfQogICAgCiAgICAvKioK\nICAgICAqIEdldHMgdGhlIHByZXBhcmVkIHF1ZXJ5IGNhY2hlZCBieSB0aGUg\nZ2l2ZW4ga2V5LiAKICAgICAqIAogICAgICogQHJldHVybiB0aGUgY2FjaGVk\nIFByZXBhcmVkUXVlcnkgb3IgbnVsbCBpZiBub25lIGV4aXN0cy4KICAgICAq\nLwogICAgUHJlcGFyZWRRdWVyeSBnZXRQcmVwYXJlZFF1ZXJ5KFN0cmluZyBp\nZCkgewogICAgICAgIFByZXBhcmVkUXVlcnlDYWNoZSBjYWNoZSA9IGdldFBy\nZXBhcmVkUXVlcnlDYWNoZSgpOwogICAgICAgIHJldHVybiAoY2FjaGUgPT0g\nbnVsbCkgPyBudWxsIDogY2FjaGUuZ2V0KGlkKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRGbHVzaE1vZGUoRmx1c2hNb2RlVHlwZSBmbHVzaE1vZGUp\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBf\nYnJva2VyLmFzc2VydE9wZW4oKTsKICAgICAgICBfYnJva2VyLmdldEZldGNo\nQ29uZmlndXJhdGlvbigpLnNldEZsdXNoQmVmb3JlUXVlcmllcwogICAgICAg\nICAgICAodG9GbHVzaEJlZm9yZVF1ZXJpZXMoZmx1c2hNb2RlKSk7CiAgICB9\nCgogICAgcHVibGljIEZsdXNoTW9kZVR5cGUgZ2V0Rmx1c2hNb2RlKCkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuYXNzZXJ0T3BlbigpOwogICAgICAgIHJldHVybiBmcm9tRmx1c2hCZWZv\ncmVRdWVyaWVzKF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuCiAg\nICAgICAgICAgIGdldEZsdXNoQmVmb3JlUXVlcmllcygpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRyYW5zbGF0ZSBvdXIgaW50ZXJuYWwgZmx1c2ggY29u\nc3RhbnQgdG8gYSBmbHVzaCBtb2RlIGVudW0gdmFsdWUuCiAgICAgKi8KICAg\nIHN0YXRpYyBGbHVzaE1vZGVUeXBlIGZyb21GbHVzaEJlZm9yZVF1ZXJpZXMo\naW50IGZsdXNoKSB7CiAgICAgICAgc3dpdGNoIChmbHVzaCkgewogICAgICAg\nICAgICBjYXNlIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9UUlVFOgogICAgICAg\nICAgICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUuQVVUTzsKICAgICAgICAg\nICAgY2FzZSBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfRkFMU0U6CiAgICAgICAg\nICAgICAgICByZXR1cm4gRmx1c2hNb2RlVHlwZS5DT01NSVQ7CiAgICAgICAg\nICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgYSBmbHVz\naCBtb2RlIGVudW0gdmFsdWUgdG8gb3VyIGludGVybmFsIGZsdXNoIGNvbnN0\nYW50LgogICAgICovCiAgICBzdGF0aWMgaW50IHRvRmx1c2hCZWZvcmVRdWVy\naWVzKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2RlKSB7CiAgICAgICAgLy8gY2hv\nb3NlIGRlZmF1bHQgZm9yIG51bGwKICAgICAgICBpZiAoZmx1c2hNb2RlID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBRdWVyeUZsdXNoTW9kZXMuRkxV\nU0hfV0lUSF9DT05ORUNUSU9OOwogICAgICAgIGlmIChmbHVzaE1vZGUgPT0g\nRmx1c2hNb2RlVHlwZS5BVVRPKQogICAgICAgICAgICByZXR1cm4gUXVlcnlG\nbHVzaE1vZGVzLkZMVVNIX1RSVUU7CiAgICAgICAgaWYgKGZsdXNoTW9kZSA9\nPSBGbHVzaE1vZGVUeXBlLkNPTU1JVCkKICAgICAgICAgICAgcmV0dXJuIFF1\nZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9GQUxTRTsKICAgICAgICB0aHJvdyBuZXcg\nQXJndW1lbnRFeGNlcHRpb24oZmx1c2hNb2RlLnRvU3RyaW5nKCksIG51bGws\nIG51bGwsIGZhbHNlKTsKICAgIH0KCiAgICAvKgogICAgICogVXNlZCBieSBK\nYXZhIEVFIENvbnRhaW5lcnMgdGhhdCB3aXNoIHRvIHBvb2wgT3BlbkpQQSBF\nbnRpdHlNYW5hZ2Vycy4gIFRoZSBzcGVjaWZpY2F0aW9uCiAgICAgKiBkb2Vz\nbid0IGFsbG93IHRoZSBjbG9zaW5nIG9mIGNvbm5lY3Rpb25zIHdpdGggdGhl\nIGNsZWFyKCkgbWV0aG9kLiAgQnkgaW50cm9kdWNpbmcgdGhpcwogICAgICog\nbmV3IG1ldGhvZCwgd2UgY2FuIGRvIGFkZGl0aW9uYWwgcHJvY2Vzc2luZyAo\nYW5kIG1heWJlIG1vcmUgZWZmaWNpZW50IHByb2Nlc3NpbmcpIHRvIAogICAg\nICogcHJvcGVybHkgcHJlcGFyZSBhbiBFTSBmb3IgcG9vbGluZy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgcHJlcGFyZUZvclBvb2xpbmcoKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgY2xlYXIoKTsK\nICAgICAgICBfYnJva2VyLmxvY2soKTsgIC8vIHNpbmNlIHRoaXMgZGlyZWN0\nIGNsb3NlIHBhdGggaXMgbm90IHByb3RlY3RlZC4uLgogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIF9icm9rZXIuZ2V0U3RvcmVNYW5hZ2VyKCkuY2xvc2Uo\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfYnJva2VyLnVu\nbG9jaygpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQg\nY2xlYXIoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5kZXRhY2hBbGwodGhpcywgZmFsc2UpOwogICAgICAg\nIF9wbGFucy5jbGVhcigpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0\nRGVsZWdhdGUoKSB7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICB9CgogICAgcHVibGljIExvY2tNb2RlVHlwZSBnZXRMb2Nr\nTW9kZShPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2Fj\ndGlvbigpOwogICAgICAgIGFzc2VydFZhbGlkQXR0Y2hlZEVudGl0eShHRVRf\nTE9DS19NT0RFLCBlbnRpdHkpOwogICAgICAgIHJldHVybiBNaXhlZExvY2tM\nZXZlbHNIZWxwZXIuZnJvbUxvY2tMZXZlbCgKICAgICAgICAgICAgX2Jyb2tl\nci5nZXRMb2NrTGV2ZWwoZW50aXR5KSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgbG9jayhPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSkgewog\nICAgICAgIGxvY2soZW50aXR5LCBtb2RlLCAtMSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgbG9jayhPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRBdHRjaGVk\nRW50aXR5KExPQ0ssIGVudGl0eSk7CiAgICAgICAgX2Jyb2tlci5sb2NrKGVu\ndGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jayhPYmpl\nY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwgaW50IHRpbWVvdXQpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBhc3Nl\ncnRWYWxpZEF0dGNoZWRFbnRpdHkoTE9DSywgZW50aXR5KTsKCiAgICAgICAg\nY29uZmlndXJlQ3VycmVudEZldGNoUGxhbihwdXNoRmV0Y2hQbGFuKCksIG51\nbGwsIG1vZGUsIGZhbHNlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBf\nYnJva2VyLmxvY2soZW50aXR5LCBNaXhlZExvY2tMZXZlbHNIZWxwZXIudG9M\nb2NrTGV2ZWwobW9kZSksICB0aW1lb3V0LCB0aGlzKTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICBwb3BGZXRjaFBsYW4oKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jayhPYmplY3QgZW50aXR5LCBM\nb2NrTW9kZVR5cGUgbW9kZSwgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0\naWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgYXNzZXJ0VmFsaWRBdHRjaGVkRW50aXR5KExPQ0ssIGVudGl0eSk7CiAg\nICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwogICAg\nICAgIHByb3BlcnRpZXMgPSBjbG9uZVByb3BlcnRpZXMocHJvcGVydGllcyk7\nCiAgICAgICAgY29uZmlndXJlQ3VycmVudENhY2hlTW9kZXMocHVzaEZldGNo\nUGxhbigpLCBwcm9wZXJ0aWVzKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50\nRmV0Y2hQbGFuKGdldEZldGNoUGxhbigpLCBwcm9wZXJ0aWVzLCBtb2RlLCBm\nYWxzZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5sb2Nr\nKGVudGl0eSwgTWl4ZWRMb2NrTGV2ZWxzSGVscGVyLnRvTG9ja0xldmVsKG1v\nZGUpLAogICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRGZXRjaENvbmZpZ3Vy\nYXRpb24oKS5nZXRMb2NrVGltZW91dCgpLCB0aGlzKTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICBwb3BGZXRjaFBsYW4oKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbG9ja0FsbChDb2xsZWN0aW9uIGVu\ndGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5sb2NrQWxsKGVudGl0aWVzLCB0aGlzKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKENvbGxlY3Rpb24gZW50aXRpZXMs\nIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91dCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIubG9ja0Fs\nbChlbnRpdGllcywgTWl4ZWRMb2NrTGV2ZWxzSGVscGVyLnRvTG9ja0xldmVs\nKG1vZGUpLAogICAgICAgICAgICB0aW1lb3V0LCB0aGlzKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBsb2NrQWxsKE9iamVjdC4uLiBlbnRpdGllcykgewog\nICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGxvY2tBbGwoT2JqZWN0W10gZW50aXRpZXMs\nIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91dCkgewogICAgICAgIGxv\nY2tBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcyksIG1vZGUsIHRpbWVvdXQp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGNhbmNlbEFsbCgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5jYW5jZWxBbGwoKTsKICAgIH0KCiAgICBw\ndWJsaWMgT2JqZWN0IGdldENvbm5lY3Rpb24oKSB7CiAgICAgICAgcmV0dXJu\nIF9icm9rZXIuZ2V0Q29ubmVjdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBD\nb2xsZWN0aW9uIGdldE1hbmFnZWRPYmplY3RzKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldE1hbmFnZWRPYmplY3RzKCk7CiAgICB9CgogICAgcHVi\nbGljIENvbGxlY3Rpb24gZ2V0VHJhbnNhY3Rpb25hbE9iamVjdHMoKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0VHJhbnNhY3Rpb25hbE9iamVjdHMo\nKTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRQZW5kaW5nVHJh\nbnNhY3Rpb25hbE9iamVjdHMoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nZ2V0UGVuZGluZ1RyYW5zYWN0aW9uYWxPYmplY3RzKCk7CiAgICB9CgogICAg\ncHVibGljIENvbGxlY3Rpb24gZ2V0RGlydHlPYmplY3RzKCkgewogICAgICAg\nIHJldHVybiBfYnJva2VyLmdldERpcnR5T2JqZWN0cygpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGdldE9yZGVyRGlydHlPYmplY3RzKCkgewogICAg\nICAgIHJldHVybiBfYnJva2VyLmdldE9yZGVyRGlydHlPYmplY3RzKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0T3JkZXJEaXJ0eU9iamVjdHMoYm9v\nbGVhbiBvcmRlcikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuc2V0T3JkZXJEaXJ0eU9iamVjdHMob3JkZXIp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRpcnR5Q2xhc3MoQ2xhc3MgY2xz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5kaXJ0eVR5cGUoY2xzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NX\nYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyBDb2xsZWN0aW9uPENs\nYXNzPiBnZXRQZXJzaXN0ZWRDbGFzc2VzKCkgewogICAgICAgIHJldHVybiAo\nQ29sbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIuZ2V0UGVyc2lzdGVkVHlwZXMo\nKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikK\nICAgIHB1YmxpYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRVcGRhdGVkQ2xhc3Nl\ncygpIHsKICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248Q2xhc3M+KSBfYnJv\na2VyLmdldFVwZGF0ZWRUeXBlcygpOwogICAgfQoKICAgIEBTdXBwcmVzc1dh\ncm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIENvbGxlY3Rpb248Q2xh\nc3M+IGdldFJlbW92ZWRDbGFzc2VzKCkgewogICAgICAgIHJldHVybiAoQ29s\nbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIuZ2V0RGVsZXRlZFR5cGVzKCk7CiAg\nICB9CgogICAgcHVibGljIDxUPiBUIGNyZWF0ZUluc3RhbmNlKENsYXNzPFQ+\nIGNscykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIHJldHVybiAoVCkgX2Jyb2tlci5uZXdJbnN0YW5jZShjbHMpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuY2xvc2UoKTsKICAg\nICAgICBfcGxhbnMuY2xlYXIoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc09wZW4oKSB7CiAgICAgICAgcmV0dXJuICFfYnJva2VyLmlzQ2xvc2VJ\nbnZva2VkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZGlydHkoT2JqZWN0\nIG8sIFN0cmluZyBmaWVsZCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20gPSBfYnJv\na2VyLmdldFN0YXRlTWFuYWdlcihvKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBpZiAoc20gIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNtLmRpcnR5\nKGZpZWxkKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0\nZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIE9iamVjdCBnZXRPYmplY3RJZChPYmplY3QgbykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBKUEFGYWNhZGVI\nZWxwZXIuZnJvbU9wZW5KUEFPYmplY3RJZChfYnJva2VyLmdldE9iamVjdElk\nKG8pKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RpcnR5KE9iamVj\ndCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuaXNEaXJ0eShvKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1RyYW5zYWN0aW9uYWwoT2JqZWN0IG8pIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jy\nb2tlci5pc1RyYW5zYWN0aW9uYWwobyk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaXNQZXJzaXN0ZW50KE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNQ\nZXJzaXN0ZW50KG8pOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzTmV3\nbHlQZXJzaXN0ZW50KE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNOZXcobyk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNSZW1vdmVkKE9iamVjdCBv\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuaXNEZWxldGVkKG8pOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGlzRGV0YWNoZWQoT2JqZWN0IGVudGl0eSkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJv\na2VyLmlzRGV0YWNoZWQoZW50aXR5KTsKICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IGdldFZlcnNpb24oT2JqZWN0IG8pIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRWZXJz\naW9uKG8pOwogICAgfQoKICAgIC8qKgogICAgICogVGhyb3cgYXBwcm9wcmlh\ndGUgZXhjZXB0aW9uIGlmIGNsb3NlIGhhcyBiZWVuIGludm9rZWQgYnV0IHRo\nZSBicm9rZXIKICAgICAqIGlzIHN0aWxsIG9wZW4uICBXZSB0ZXN0IG9ubHkg\nZm9yIHRoaXMgYmVjYXVzZSBpZiB0aGUgYnJva2VyIGlzIGFscmVhZHkKICAg\nICAqIGNsb3NlZCwgaXQgd2lsbCB0aHJvdyBpdHMgb3duIG1vcmUgaW5mb3Jt\nYXRpdmUgZXhjZXB0aW9uIHdoZW4gd2UgCiAgICAgKiBkZWxlZ2F0ZSB0aGUg\ncGVuZGluZyBvcGVyYXRpb24gdG8gaXQuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIGFzc2VydE5vdENsb3NlSW52b2tlZCgpIHsKICAgICAgICBpZiAo\nIV9icm9rZXIuaXNDbG9zZWQoKSAmJiBfYnJva2VyLmlzQ2xvc2VJbnZva2Vk\nKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRp\nb24oX2xvYy5nZXQoImNsb3NlLWludm9rZWQiKSwgbnVsbCwKICAgICAgICAg\nICAgICAgIG51bGwsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhy\nb3cgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uaWYgaWYgZW50aXR5IGlzIG5v\ndCBhIHZhbGlkIGVudGl0eSBvcgogICAgICogaWYgaXQgaXMgZGV0YWNoZWQu\nCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0VmFsaWRBdHRjaGVkRW50aXR5KFN0\ncmluZyBjYWxsLCBPYmplY3QgZW50aXR5KSB7CiAgICAgICAgT3BlbkpQQVN0\nYXRlTWFuYWdlciBzbSA9IF9icm9rZXIuZ2V0U3RhdGVNYW5hZ2VyKGVudGl0\neSk7CiAgICAgICAgaWYgKHNtID09IG51bGwgfHwgIXNtLmlzUGVyc2lzdGVu\ndCgpIHx8IHNtLmlzRGV0YWNoZWQoKSB8fCAoY2FsbC5lcXVhbHMoUkVGUkVT\nSCkgJiYgc20uaXNEZWxldGVkKCkpKSB7CiAgICAgICAgICAgIHRocm93IG5l\ndyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImludmFsaWRf\nZW50aXR5X2FyZ3VtZW50IiwgCiAgICAgICAgICAgICAgICBjYWxsLCBlbnRp\ndHkgPT0gbnVsbCA/ICJudWxsIiA6IEV4Y2VwdGlvbnMudG9TdHJpbmcoZW50\naXR5KSkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIEZpbmRDYWxs\nYmFja3MgaW1wbGVtZW50YXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vCgogICAgcHVibGljIE9iamVjdCBwcm9jZXNzQXJndW1l\nbnQoT2JqZWN0IGFyZykgewogICAgICAgIHJldHVybiBhcmc7CiAgICB9Cgog\nICAgcHVibGljIE9iamVjdCBwcm9jZXNzUmV0dXJuKE9iamVjdCBvaWQsIE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICByZXR1cm4gKHNtID09\nIG51bGwgfHwgc20uaXNEZWxldGVkKCkpID8gbnVsbCA6IHNtLmdldE1hbmFn\nZWRJbnN0YW5jZSgpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLwogICAgLy8gT3BDYWxsYmFja3MgaW1wbGVtZW50YXRpb24K\nICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1Ymxp\nYyBpbnQgcHJvY2Vzc0FyZ3VtZW50KGludCBvcCwgT2JqZWN0IG9iaiwgT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIHN3aXRjaCAob3ApIHsK\nICAgICAgICAgICAgY2FzZSBPUF9ERUxFVEU6CiAgICAgICAgICAgICAgICAv\nLyBjYXNjYWRlIHRocm91Z2ggbm9uLXBlcnNpc3RlbnQgbm9uLWRldGFjaGVk\nIGluc3RhbmNlcwogICAgICAgICAgICAgICAgaWYgKHNtID09IG51bGwgJiYg\nIV9icm9rZXIuaXNEZXRhY2hlZChvYmopKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBBQ1RfQ0FTQ0FERTsKICAgICAgICAgICAgICAgIGlmIChzbSAh\nPSBudWxsICYmICFzbS5pc0RldGFjaGVkKCkgJiYgIXNtLmlzUGVyc2lzdGVu\ndCgpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBBQ1RfQ0FTQ0FERTsK\nICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBkZWxldGVkIGluc3RhbmNlcwog\nICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYgc20uaXNEZWxldGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9OT05FOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1BfQVRUQUNI\nOgogICAgICAgICAgICAgICAgLy8gZGllIG9uIHJlbW92ZWQKICAgICAgICAg\nICAgICAgIGlmIChzbSAhPSBudWxsICYmIHNtLmlzRGVsZXRlZCgpKQogICAg\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJyZW1vdmVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgRXhjZXB0\naW9ucy50b1N0cmluZyhvYmopKSkuc2V0RmFpbGVkT2JqZWN0KG9iaik7CiAg\nICAgICAgICAgICAgICAvLyBjYXNjYWRlIHRocm91Z2ggbWFuYWdlZCBpbnN0\nYW5jZXMKICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxsICYmICFzbS5p\nc0RldGFjaGVkKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9D\nQVNDQURFOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgT1BfUkVGUkVTSDoKICAgICAgICAgICAgICAgIC8vIGRpZSBvbiB1bm1h\nbmFnZWQgaW5zdGFuY2VzCiAgICAgICAgICAgICAgICBpZiAoc20gPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlv\nbihfbG9jLmdldCgibm90LW1hbmFnZWQiLAogICAgICAgICAgICAgICAgICAg\nICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKG9iaikpKS5zZXRGYWlsZWRPYmpl\nY3Qob2JqKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIE9QX0RFVEFDSDoKICAgICAgICAgICAgICAgIGlmIChzbSA9PSBudWxs\nIHx8ICFzbS5pc1BlcnNpc3RlbnQoKSB8fCBzbS5pc0RldGFjaGVkKCkpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9OT05FOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiBBQ1RfUlVO\nIHwgQUNUX0NBU0NBREU7CiAgICB9CgogICAgcHVibGljIGludCBoYXNoQ29k\nZSgpIHsKICAgICAgICByZXR1cm4gKF9icm9rZXIgPT0gbnVsbCkgPyAwIDog\nX2Jyb2tlci5oYXNoQ29kZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0g\ndGhpcykKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKChv\ndGhlciA9PSBudWxsKSB8fCAob3RoZXIuZ2V0Q2xhc3MoKSAhPSB0aGlzLmdl\ndENsYXNzKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\naWYgKF9icm9rZXIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIHJldHVybiBfYnJva2VyLmVxdWFscygoKEVudGl0eU1hbmFn\nZXJJbXBsKSBvdGhlcikuX2Jyb2tlcik7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmVhZEV4dGVybmFsKE9iamVjdElucHV0IGluKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgX3JldCA9IFBlcnNpc3RlbmNlRXhjZXB0\naW9ucy5nZXRSb2xsYmFja1RyYW5zbGF0b3IodGhpcyk7CgogICAgICAgICAg\nICAvLyB0aGlzIGFzc3VtZXMgdGhhdCBzZXJpYWxpemVkIEJyb2tlcnMgYXJl\nIGZyb20gc29tZXRoaW5nCiAgICAgICAgICAgIC8vIHRoYXQgZXh0ZW5kcyBB\nYnN0cmFjdEJyb2tlckZhY3RvcnkuCiAgICAgICAgICAgIE9iamVjdCBmYWN0\nb3J5S2V5ID0gaW4ucmVhZE9iamVjdCgpOwogICAgICAgICAgICBBYnN0cmFj\ndEJyb2tlckZhY3RvcnkgZmFjdG9yeSA9CiAgICAgICAgICAgICAgICBBYnN0\ncmFjdEJyb2tlckZhY3RvcnkuZ2V0UG9vbGVkRmFjdG9yeUZvcktleShmYWN0\nb3J5S2V5KTsKICAgICAgICAgICAgYnl0ZVtdIGJyb2tlckJ5dGVzID0gKGJ5\ndGVbXSkgaW4ucmVhZE9iamVjdCgpOwogICAgICAgICAgICBPYmplY3RJbnB1\ndFN0cmVhbSBpbm5lckluID0gbmV3IEJyb2tlckJ5dGVzSW5wdXRTdHJlYW0o\nYnJva2VyQnl0ZXMsCiAgICAgICAgICAgICAgICBmYWN0b3J5LmdldENvbmZp\nZ3VyYXRpb24oKSk7CgogICAgICAgICAgICBCcm9rZXIgYnJva2VyID0gKEJy\nb2tlcikgaW5uZXJJbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgIEVudGl0\neU1hbmFnZXJGYWN0b3J5SW1wbCBlbWYgPSAoRW50aXR5TWFuYWdlckZhY3Rv\ncnlJbXBsKQogICAgICAgICAgICAgICAgSlBBRmFjYWRlSGVscGVyLnRvRW50\naXR5TWFuYWdlckZhY3RvcnkoCiAgICAgICAgICAgICAgICAgICAgYnJva2Vy\nLmdldEJyb2tlckZhY3RvcnkoKSk7CiAgICAgICAgICAgIGJyb2tlci5wdXRV\nc2VyT2JqZWN0KEpQQUZhY2FkZUhlbHBlci5FTV9LRVksIHRoaXMpOwogICAg\nICAgICAgICBpbml0aWFsaXplKGVtZiwgYnJva2VyKTsKICAgICAgICB9IGNh\ndGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICByZSA9IF9yZXQudHJhbnNsYXRlKHJlKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIC8vIGlnbm9yZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRocm93\nIHJlOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3cml0ZUV4\ndGVybmFsKE9iamVjdE91dHB1dCBvdXQpIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gdGhpcyByZXF1aXJlcyB0\naGF0IG9ubHkgQWJzdHJhY3RCcm9rZXJGYWN0b3J5LXNvdXJjZWQKICAgICAg\nICAgICAgLy8gYnJva2VycyBjYW4gYmUgc2VyaWFsaXplZAogICAgICAgICAg\nICBPYmplY3QgZmFjdG9yeUtleSA9ICgoQWJzdHJhY3RCcm9rZXJGYWN0b3J5\nKSBfYnJva2VyCiAgICAgICAgICAgICAgICAuZ2V0QnJva2VyRmFjdG9yeSgp\nKS5nZXRQb29sS2V5KCk7CiAgICAgICAgICAgIG91dC53cml0ZU9iamVjdChm\nYWN0b3J5S2V5KTsKICAgICAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3RyZWFt\nIGJhb3MgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgICAgICAg\nICAgIE9iamVjdE91dHB1dFN0cmVhbSBpbm5lck91dCA9IG5ldyBPYmplY3RP\ndXRwdXRTdHJlYW0oYmFvcyk7CiAgICAgICAgICAgIGlubmVyT3V0LndyaXRl\nT2JqZWN0KF9icm9rZXIuZ2V0RGVsZWdhdGUoKSk7CiAgICAgICAgICAgIGlu\nbmVyT3V0LmZsdXNoKCk7CiAgICAgICAgICAgIG91dC53cml0ZU9iamVjdChi\nYW9zLnRvQnl0ZUFycmF5KCkpOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVF\neGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIHJlID0gX3JldC50cmFuc2xhdGUocmUpOwogICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gaWdub3Jl\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhyb3cgcmU7CiAgICAgICAg\nfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIEJyb2tlckJ5dGVz\nSW5wdXRTdHJlYW0gZXh0ZW5kcyBPYmplY3RJbnB1dFN0cmVhbSB7CgogICAg\nICAgIHByaXZhdGUgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZjsKCiAgICAg\nICAgQnJva2VyQnl0ZXNJbnB1dFN0cmVhbShieXRlW10gYnl0ZXMsIE9wZW5K\nUEFDb25maWd1cmF0aW9uIGNvbmYpCiAgICAgICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgICAgIHN1cGVyKG5ldyBCeXRlQXJyYXlJbnB1\ndFN0cmVhbShieXRlcykpOwogICAgICAgICAgICBpZiAoY29uZiA9PSBudWxs\nKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiSWxsZWdhbCBudWxsIGFy\nZ3VtZW50IHRvIE9iamVjdElucHV0U3RyZWFtV2l0aExvYWRlciIpOwogICAg\nICAgICAgICB0aGlzLmNvbmYgPSBjb25mOwogICAgICAgIH0KCiAgICAgICAg\nLyoqCiAgICAgICAgICogTWFrZSBhIHByaW1pdGl2ZSBhcnJheSBjbGFzcwog\nICAgICAgICAqLwogICAgICAgIHByaXZhdGUgQ2xhc3MgcHJpbWl0aXZlVHlw\nZShjaGFyIHR5cGUpIHsKICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAg\nICAgICAgICAgICAgICBjYXNlICdCJzogcmV0dXJuIGJ5dGUuY2xhc3M7CiAg\nICAgICAgICAgICAgICBjYXNlICdDJzogcmV0dXJuIGNoYXIuY2xhc3M7CiAg\nICAgICAgICAgICAgICBjYXNlICdEJzogcmV0dXJuIGRvdWJsZS5jbGFzczsK\nICAgICAgICAgICAgICAgIGNhc2UgJ0YnOiByZXR1cm4gZmxvYXQuY2xhc3M7\nCiAgICAgICAgICAgICAgICBjYXNlICdJJzogcmV0dXJuIGludC5jbGFzczsK\nICAgICAgICAgICAgICAgIGNhc2UgJ0onOiByZXR1cm4gbG9uZy5jbGFzczsK\nICAgICAgICAgICAgICAgIGNhc2UgJ1MnOiByZXR1cm4gc2hvcnQuY2xhc3M7\nCiAgICAgICAgICAgICAgICBjYXNlICdaJzogcmV0dXJuIGJvb2xlYW4uY2xh\nc3M7CiAgICAgICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIENsYXNz\nPD8+IHJlc29sdmVDbGFzcyhPYmplY3RTdHJlYW1DbGFzcyBjbGFzc0Rlc2Mp\nCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiB7CgogICAgICAgICAgICBTdHJpbmcgY25hbWUgPSBjbGFz\nc0Rlc2MuZ2V0TmFtZSgpOwogICAgICAgICAgICBpZiAoY25hbWUuc3RhcnRz\nV2l0aCgiWyIpKSB7CiAgICAgICAgICAgICAgICAvLyBBbiBhcnJheQogICAg\nICAgICAgICAgICAgQ2xhc3M8Pz4gY29tcG9uZW50OwkJLy8gY29tcG9uZW50\nIGNsYXNzCiAgICAgICAgICAgICAgICBpbnQgZGNvdW50OwkJCSAgICAvLyBk\naW1lbnNpb24KICAgICAgICAgICAgICAgIGZvciAoZGNvdW50PTE7IGNuYW1l\nLmNoYXJBdChkY291bnQpPT0nWyc7IGRjb3VudCsrKSA7CiAgICAgICAgICAg\nICAgICBpZiAoY25hbWUuY2hhckF0KGRjb3VudCkgPT0gJ0wnKSB7CiAgICAg\nICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbG9va3VwQ2xhc3MoY25hbWUu\nc3Vic3RyaW5nKGRjb3VudCsxLAogICAgICAgICAgICAgICAgICAgICAgICBj\nbmFtZS5sZW5ndGgoKS0xKSk7CiAgICAgICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgICAgIGlmIChjbmFtZS5sZW5ndGgoKSAhPSBkY291\nbnQrMSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbihjbmFtZSk7Ly8gbWFsZm9ybWVkCiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNvbXBvbmVu\ndCA9IHByaW1pdGl2ZVR5cGUoY25hbWUuY2hhckF0KGRjb3VudCkpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW50IGRpbVtdID0gbmV3\nIGludFtkY291bnRdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaT0wOyBp\nPGRjb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgZGltW2ldPTA7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gQXJy\nYXkubmV3SW5zdGFuY2UoY29tcG9uZW50LCBkaW0pLmdldENsYXNzKCk7CiAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9v\na3VwQ2xhc3MoY25hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICAvKioKICAgICAgICAgKiBJZiB0aGlzIGlzIGEgZ2VuZXJhdGVkIHN1\nYmNsYXNzLCBsb29rIHVwIHRoZSBjb3JyZXNwb25kaW5nIENsYXNzCiAgICAg\nICAgICogb2JqZWN0IHZpYSBtZXRhZGF0YS4KICAgICAgICAgKi8KICAgICAg\nICBwcml2YXRlIENsYXNzPD8+IGxvb2t1cENsYXNzKFN0cmluZyBjbGFzc05h\nbWUpCiAgICAgICAgICAgIHRocm93cyBDbGFzc05vdEZvdW5kRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBD\nbGFzcy5mb3JOYW1lKGNsYXNzTmFtZSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKENsYXNzTm90Rm91bmRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\naWYgKFBDRW5oYW5jZXIuaXNQQ1N1YmNsYXNzTmFtZShjbGFzc05hbWUpKSB7\nCiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHN1cGVyTmFtZSA9IFBDRW5o\nYW5jZXIudG9NYW5hZ2VkVHlwZU5hbWUoY2xhc3NOYW1lKTsKICAgICAgICAg\nICAgICAgICAgICBDbGFzc01ldGFEYXRhW10gbWV0YXMgPSBjb25mLmdldE1l\ndGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkKICAgICAgICAgICAgICAgICAg\nICAgICAgLmdldE1ldGFEYXRhcygpOwogICAgICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKHN1cGVyTmFtZS5lcXVhbHMoCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBtZXRhc1tpXS5nZXREZXNjcmliZWRU\neXBlKCkuZ2V0TmFtZSgpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIFBDUmVnaXN0cnkuZ2V0UENUeXBlKAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG1ldGFzW2ldLmdldERlc2NyaWJlZFR5cGUo\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3Mgbm90IGZv\ndW5kLCB0cnkgdG8gbG9vayBmb3IgaXQgYW55d2F5cwogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKGNsYXNzTmFtZSk7CiAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRocm93\nIGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgZGV0YWNoKE9iamVjdCBlbnRpdHkp\nIHsKICAgICAgICBpZiAoZW50aXR5ID09IG51bGwpCiAgICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoIm51\nbGwtZGV0YWNoIikuZ2V0TWVzc2FnZSgpKTsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmRldGFjaChlbnRpdHks\nIHRoaXMpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgcXVlcnkg\nZnJvbSB0aGUgZ2l2ZW4gQ3JpdHJpYVF1ZXJ5LgogICAgICogQ29tcGlsZSB0\nbyByZWdpc3RlciB0aGUgcGFyYW1ldGVycyBpbiB0aGlzIHF1ZXJ5LgogICAg\nICovCiAgICBwdWJsaWMgPFQ+IFR5cGVkUXVlcnk8VD4gY3JlYXRlUXVlcnko\nQ3JpdGVyaWFRdWVyeTxUPiBjcml0ZXJpYVF1ZXJ5KSB7CiAgICAgICAgKChP\ncGVuSlBBQ3JpdGVyaWFRdWVyeTxUPiljcml0ZXJpYVF1ZXJ5KS5jb21waWxl\nKCk7IAogICAgICAgIAogICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnkga2VybmVsUXVlcnkgPV9icm9rZXIubmV3UXVlcnkoQ3JpdGVy\naWFCdWlsZGVySW1wbC5MQU5HX0NSSVRFUklBLCBjcml0ZXJpYVF1ZXJ5KTsK\nICAgICAgICAKICAgICAgICBRdWVyeUltcGw8VD4gZmFjYWRlUXVlcnkgPSBu\nZXdRdWVyeUltcGwoa2VybmVsUXVlcnkpLnNldElkKGNyaXRlcmlhUXVlcnku\ndG9TdHJpbmcoKSk7CiAgICAgICAgU2V0PFBhcmFtZXRlckV4cHJlc3Npb248\nPz4+IHBhcmFtcyA9IGNyaXRlcmlhUXVlcnkuZ2V0UGFyYW1ldGVycygpOwog\nICAgICAgIAogICAgICAgIGZvciAoUGFyYW1ldGVyRXhwcmVzc2lvbjw/PiBw\nYXJhbSA6IHBhcmFtcykgewogICAgICAgICAgICBmYWNhZGVRdWVyeS5kZWNs\nYXJlUGFyYW1ldGVyKHBhcmFtLCBwYXJhbSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBmYWNhZGVRdWVyeTsKICAgIH0KICAgIAogICAgcHVibGljIE9w\nZW5KUEFRdWVyeSBjcmVhdGVEeW5hbWljUXVlcnkoCiAgICAgICAgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5LlF1ZXJ5RGVmaW5pdGlv\nbiBxZGVmKSB7CiAgICAgICAgU3RyaW5nIGpwcWwgPSBfZW1mLmdldER5bmFt\naWNRdWVyeUJ1aWxkZXIoKS50b0pQUUwocWRlZik7CiAgICAgICAgcmV0dXJu\nIGNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAgfQoKICAgIC8qKgogICAgICogR2V0\nIHRoZSBwcm9wZXJ0aWVzIHVzZWQgY3VycmVudGx5IGJ5IHRoaXMgZW50aXR5\nIG1hbmFnZXIuCiAgICAgKiBUaGUgcHJvcGVydHkga2V5cyBhbmQgdGhlaXIg\ndmFsdWVzIGFyZSBoYXJ2ZXN0ZWQgZnJvbSBrZXJuZWwgYXJ0aWZhY3RzIG5h\nbWVseQogICAgICogdGhlIEJyb2tlciBhbmQgRmV0Y2hQbGFuIGJ5IHJlZmxl\nY3Rpb24uCiAgICAgKiBUaGVzZSBwcm9wZXJ0eSBrZXlzIGFuZCB2YWx1ZXMg\ndGhhdCBkZW5vdGUgdGhlIGJlYW4gcHJvcGVydGllcy92YWx1ZXMgb2YgdGhl\nIGtlcm5lbCBhcnRpZmFjdHMKICAgICAqIGFyZSBjb252ZXJ0ZWQgdG8gdGhl\nIG9yaWdpbmFsIGtleXMvdmFsdWVzIHRoYXQgdXNlciB1c2VkIHRvIHNldCB0\naGUgcHJvcGVydGllcy4KICAgICAqICAgIAogICAgICovCiAgICBwdWJsaWMg\nTWFwPFN0cmluZywgT2JqZWN0PiBnZXRQcm9wZXJ0aWVzKCkgewogICAgICAg\nIE1hcDxTdHJpbmcsT2JqZWN0PiBwcm9wcyA9IF9icm9rZXIuZ2V0UHJvcGVy\ndGllcygpOwogICAgICAgIGZvciAoU3RyaW5nIHMgOiBfYnJva2VyLmdldFN1\ncHBvcnRlZFByb3BlcnRpZXMoKSkgewogICAgICAgICAgICBTdHJpbmcga2Vy\nbmVsS2V5ID0gZ2V0QmVhblByb3BlcnR5TmFtZShzKTsKICAgICAgICAgICAg\nTWV0aG9kIGdldHRlciA9IFJlZmxlY3Rpb24uZmluZEdldHRlcih0aGlzLmdl\ndENsYXNzKCksIGtlcm5lbEtleSwgZmFsc2UpOwogICAgICAgICAgICBpZiAo\nZ2V0dGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIFN0cmluZyB1c2Vy\nS2V5ID0gSlBBUHJvcGVydGllcy5nZXRVc2VyTmFtZShrZXJuZWxLZXkpOwog\nICAgICAgICAgICAgICAgT2JqZWN0IGt2YWx1ZSAgPSBSZWZsZWN0aW9uLmdl\ndCh0aGlzLCBnZXR0ZXIpOwogICAgICAgICAgICAgICAgcHJvcHMucHV0KHVz\nZXJLZXkuZXF1YWxzKGtlcm5lbEtleSkgPyBzIDogdXNlcktleSwgSlBBUHJv\ncGVydGllcy5jb252ZXJ0VG9Vc2VyVmFsdWUodXNlcktleSwga3ZhbHVlKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgRmV0Y2hQbGFuIGZl\ndGNoID0gZ2V0RmV0Y2hQbGFuKCk7CiAgICAgICAgQ2xhc3M8Pz4gZmV0Y2hU\neXBlID0gZmV0Y2guZ2V0Q2xhc3MoKTsKICAgICAgICBTZXQ8U3RyaW5nPiBm\nUHJvcGVydGllcyA9IFJlZmxlY3Rpb24uZ2V0QmVhblN0eWxlUHJvcGVydHlO\nYW1lcyhmZXRjaFR5cGUpOwogICAgICAgIGZvciAoU3RyaW5nIHMgOiBmUHJv\ncGVydGllcykgewogICAgICAgICAgICBTdHJpbmcga2VybmVsS2V5ID0gZ2V0\nQmVhblByb3BlcnR5TmFtZShzKTsKICAgICAgICAgICAgTWV0aG9kIGdldHRl\nciA9IFJlZmxlY3Rpb24uZmluZEdldHRlcihmZXRjaFR5cGUsIGtlcm5lbEtl\neSwgZmFsc2UpOwogICAgICAgICAgICBpZiAoZ2V0dGVyICE9IG51bGwpIHsK\nICAgICAgICAgICAgICAgIFN0cmluZyB1c2VyS2V5ID0gSlBBUHJvcGVydGll\ncy5nZXRVc2VyTmFtZShrZXJuZWxLZXkpOwogICAgICAgICAgICAgICAgT2Jq\nZWN0IGt2YWx1ZSAgPSBSZWZsZWN0aW9uLmdldChmZXRjaCwgZ2V0dGVyKTsK\nICAgICAgICAgICAgICAgIHByb3BzLnB1dCh1c2VyS2V5LmVxdWFscyhrZXJu\nZWxLZXkpID8gcyA6IHVzZXJLZXksIEpQQVByb3BlcnRpZXMuY29udmVydFRv\nVXNlclZhbHVlKHVzZXJLZXksIGt2YWx1ZSkpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBwcm9wczsKICAgIH0KCiAgICBwdWJs\naWMgT3BlbkpQQUNyaXRlcmlhQnVpbGRlciBnZXRDcml0ZXJpYUJ1aWxkZXIo\nKSB7CiAgICAgICAgcmV0dXJuIF9lbWYuZ2V0Q3JpdGVyaWFCdWlsZGVyKCk7\nCiAgICB9CgogICAgcHVibGljIFNldDxTdHJpbmc+IGdldFN1cHBvcnRlZFBy\nb3BlcnRpZXMoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0U3VwcG9y\ndGVkUHJvcGVydGllcygpOwogICAgfQoKICAgIC8qKgogICAgICogVW53cmFw\ncyB0aGlzIHJlY2VpdmVyIHRvIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlbiBj\nbGFzcywgaWYgcG9zc2libGUuCiAgICAgKiAKICAgICAqIEBleGNlcHRpb24g\naWYgdGhlIGdpdmVuIGNsYXNzIGlzIG51bGwsIGdlbmVyaWMgPGNvZGU+T2Jq\nZWN0LmNsYXNzPC9jb2RlPiBvciBhIGNsYXNzCiAgICAgKiB0aGF0IGlzIG5v\ndCB3cmFwcGVkIGJ5IHRoaXMgcmVjZWl2ZXIuICAKICAgICAqLwogICAgcHVi\nbGljIDxUPiBUIHVud3JhcChDbGFzczxUPiBjbHMpIHsKICAgICAgICBPYmpl\nY3RbXSBkZWxlZ2F0ZXMgPSBuZXcgT2JqZWN0W117X2Jyb2tlci5nZXRJbm5l\ncm1vc3REZWxlZ2F0ZSgpLAogICAgICAgICAgICBfYnJva2VyLmdldERlbGVn\nYXRlKCksIF9icm9rZXIsIHRoaXN9OwogICAgICAgIGZvciAoT2JqZWN0IG8g\nOiBkZWxlZ2F0ZXMpIHsKICAgICAgICAgICAgaWYgKGNscyAhPSBudWxsICYm\nIGNscyAhPSBPYmplY3QuY2xhc3MgJiYgY2xzLmlzSW5zdGFuY2UobykpCiAg\nICAgICAgICAgICAgICByZXR1cm4gKFQpbzsKICAgICAgICB9CiAgICAgICAg\nLy8gU2V0IHRoaXMgdHJhbnNhY3Rpb24gdG8gcm9sbGJhY2sgb25seSAoYXMg\ncGVyIHNwZWMpIGhlcmUgYmVjYXVzZSB0aGUgcmFpc2VkIGV4Y2VwdGlvbiAK\nICAgICAgICAvLyBkb2VzIG5vdCBnbyB0aHJvdWdoIG5vcm1hbCBleGNlcHRp\nb24gdHJhbnNsYXRpb24gcGF0aHdheXMKICAgICAgICBSdW50aW1lRXhjZXB0\naW9uIGV4ID0gbmV3IFBlcnNpc3RlbmNlRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1\nbndyYXAtZW0taW52YWxpZCIsIGNscykudG9TdHJpbmcoKSwgbnVsbCwgCiAg\nICAgICAgICAgICAgICB0aGlzLCBmYWxzZSk7CiAgICAgICAgaWYgKGlzQWN0\naXZlKCkpCiAgICAgICAgICAgIHNldFJvbGxiYWNrT25seShleCk7CiAgICAg\nICAgdGhyb3cgZXg7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0UXVlcnlT\nUUxDYWNoZShib29sZWFuIGZsYWcpIHsKICAgICAgICBfYnJva2VyLnNldENh\nY2hlUHJlcGFyZWRRdWVyeShmbGFnKTsKICAgIH0KICAgIAogICAgcHVibGlj\nIGJvb2xlYW4gZ2V0UXVlcnlTUUxDYWNoZSgpIHsKICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXRDYWNoZVByZXBhcmVkUXVlcnkoKTsKICAgIH0KICAgIAog\nICAgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3IgZ2V0RXhjZXB0aW9uVHJh\nbnNsYXRvcigpIHsKICAgICAgICByZXR1cm4gX3JldDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBvcHVsYXRlIHRoZSBnaXZlbiBGZXRjaFBsYW4gd2l0aCB0\naGUgZ2l2ZW4gcHJvcGVydGllcy4gCiAgICAgKiBPcHRpb25hbGx5IG92ZXJy\naWRlcyB0aGUgZ2l2ZW4gbG9jayBtb2RlLgogICAgICovCiAgICBwcml2YXRl\nIHZvaWQgY29uZmlndXJlQ3VycmVudEZldGNoUGxhbihGZXRjaFBsYW4gZmV0\nY2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcywgCiAgICAgICAg\nICAgIExvY2tNb2RlVHlwZSBsb2NrLCBib29sZWFuIHJlcXVpcmVzVHhuKSB7\nCiAgICAgICAgLy8gaGFuZGxlIHByb3BlcnRpZXMgaW4gbWFwIGZpcnN0CiAg\nICAgICAgaWYgKHByb3BlcnRpZXMgIT0gbnVsbCkgewogICAgICAgICAgICBm\nb3IgKE1hcC5FbnRyeTxTdHJpbmcsIE9iamVjdD4gZW50cnkgOiBwcm9wZXJ0\naWVzLmVudHJ5U2V0KCkpCiAgICAgICAgICAgICAgICBmZXRjaC5zZXRIaW50\nKGVudHJ5LmdldEtleSgpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICB9\nCiAgICAgICAgLy8gb3ZlcnJpZGUgd2l0aCB0aGUgc3BlY2lmaWMgbG9ja01v\nZGUsIGlmIG5lZWRlZC4KICAgICAgICBpZiAobG9jayAhPSBudWxsICYmIGxv\nY2sgIT0gTG9ja01vZGVUeXBlLk5PTkUpIHsKICAgICAgICAgICAgaWYgKHJl\ncXVpcmVzVHhuKSB7CiAgICAgICAgICAgICAgICBfYnJva2VyLmFzc2VydEFj\ndGl2ZVRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nLy8gT3ZlcnJpZGUgcmVhZCBsb2NrIGxldmVsCiAgICAgICAgICAgIExvY2tN\nb2RlVHlwZSBjdXJSZWFkTG9ja01vZGUgPSBmZXRjaC5nZXRSZWFkTG9ja01v\nZGUoKTsKICAgICAgICAgICAgaWYgKGxvY2sgIT0gY3VyUmVhZExvY2tNb2Rl\nKQogICAgICAgICAgICAgICAgZmV0Y2guc2V0UmVhZExvY2tNb2RlKGxvY2sp\nOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBQb3B1bGF0\nZSB0aGUgZmV0Y2ggY29uZmlndXJhdGlvbiB3aXRoIHNwZWNpZmllZCBjYWNo\nZSBtb2RlIHByb3BlcnRpZXMuCiAgICAgKiBUaGUgY2FjaGUgbW9kZSBwcm9w\nZXJ0aWVzIG1vZGlmeSB0aGUgZmV0Y2ggY29uZmlndXJhdGlvbiBhbmQgcmVt\nb3ZlIHRob3NlCiAgICAgKiBwcm9wZXJ0aWVzLiBUaGlzIG1ldGhvZCBzaG91\nbGQgYmUgY2FsbGVkIDxlbT5iZWZvcmU8L2VtPiB0aGUgZmV0Y2ggY29uZmln\ndXJhdGlvbiBvZiB0aGUgY3VycmVudCAKICAgICAqIGNvbnRleHQgaGFzIGJl\nZW4gcHVzaGVkLgogICAgICogQHBhcmFtIGZldGNoIHRoZSBmZXRjaCBjb25m\naWd1cmF0aW9uIG9mIHRoZSBjdXJyZW50IGNvbnRleHQuIE5vdCB0aGUgCiAg\nICAgKiBuZXcgY29uZmlndXJhdGlvbiBwdXNoZWQgKGFuZCBsYXRlciBwb3Bw\nZWQpIGR1cmluZyBhIHNpbmdsZSBvcGVyYXRpb24uCiAgICAgKiAKICAgICAq\nIEBwYXJhbSBwcm9wZXJ0aWVzCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBj\nb25maWd1cmVDdXJyZW50Q2FjaGVNb2RlcyhGZXRjaFBsYW4gZmV0Y2gsIE1h\ncDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAgICAgIGlmIChw\ncm9wZXJ0aWVzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICBDYWNoZVJldHJpZXZlTW9kZSByTW9kZSA9IEpQQVByb3BlcnRpZXMuZ2V0\nRW51bVZhbHVlKENhY2hlUmV0cmlldmVNb2RlLmNsYXNzLCAKICAgICAgICAg\nICAgICAgIEpQQVByb3BlcnRpZXMuQ0FDSEVfUkVUUklFVkVfTU9ERSwgcHJv\ncGVydGllcyk7CiAgICAgICAgaWYgKHJNb2RlICE9IG51bGwpIHsKICAgICAg\nICAgICAgZmV0Y2guc2V0Q2FjaGVSZXRyaWV2ZU1vZGUoSlBBUHJvcGVydGll\ncy5jb252ZXJ0VG9LZXJuZWxWYWx1ZShEYXRhQ2FjaGVSZXRyaWV2ZU1vZGUu\nY2xhc3MsIAogICAgICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMuQ0FD\nSEVfUkVUUklFVkVfTU9ERSwgck1vZGUpKTsKICAgICAgICAgICAgcHJvcGVy\ndGllcy5yZW1vdmUoSlBBUHJvcGVydGllcy5DQUNIRV9SRVRSSUVWRV9NT0RF\nKTsKICAgICAgICB9CiAgICAgICAgQ2FjaGVTdG9yZU1vZGUgc01vZGUgPSBK\nUEFQcm9wZXJ0aWVzLmdldEVudW1WYWx1ZShDYWNoZVN0b3JlTW9kZS5jbGFz\ncywgCiAgICAgICAgICAgICAgICBKUEFQcm9wZXJ0aWVzLkNBQ0hFX1NUT1JF\nX01PREUsIHByb3BlcnRpZXMpOwogICAgICAgIGlmIChzTW9kZSAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGZldGNoLnNldENhY2hlU3RvcmVNb2RlKEpQQVBy\nb3BlcnRpZXMuY29udmVydFRvS2VybmVsVmFsdWUoRGF0YUNhY2hlU3RvcmVN\nb2RlLmNsYXNzLCAKICAgICAgICAgICAgICAgICAgICBKUEFQcm9wZXJ0aWVz\nLkNBQ0hFX1NUT1JFX01PREUsIHNNb2RlKSk7CiAgICAgICAgICAgIHByb3Bl\ncnRpZXMucmVtb3ZlKEpQQVByb3BlcnRpZXMuQ0FDSEVfU1RPUkVfTU9ERSk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBNZXRhbW9kZWwgZ2V0TWV0\nYW1vZGVsKCkgewogICAgICAgIHJldHVybiBfZW1mLmdldE1ldGFtb2RlbCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0cyB0aGUgZ2l2ZW4gcHJvcGVy\ndHkgdG8gdGhlIGdpdmVuIHZhbHVlLCByZWZsZWN0aXZlbHkuCiAgICAgKiAK\nICAgICAqIFRoZSBwcm9wZXJ0eSBrZXkgaXMgdHJhbnNwb3NlZCB0byBhIGJl\nYW4tc3R5bGUgcHJvcGVydHkuCiAgICAgKiBUaGUgdmFsdWUgaXMgY29udmVy\ndGVkIHRvIGEgdHlwZSBjb25zdW1hYmxlIGJ5IHRoZSBrZXJuZWwuCiAgICAg\nKiBBZnRlciByZXF1aXNpdGUgdHJhbnNmb3JtYXRpb24sIGlmIHRoZSB2YWx1\nZSBjYW4gbm90IGJlIHNldAogICAgICogb24gZWl0aGVyIHRoaXMgaW5zdGFu\nY2Ugb3IgaXRzIGZldGNoIHBsYW4gYnkgcmVmbGVjdGlvbiwKICAgICAqIHRo\nZW4gYW4gd2FybmluZyBtZXNzYWdlIChub3QgYW4gZXhjZXB0aW9uIGFzIHBl\nciBKUEEgc3BlY2lmaWNhdGlvbikgaXMgaXNzdWVkLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRQcm9wZXJ0eShTdHJpbmcgcHJvcCwgT2JqZWN0IHZh\nbHVlKSB7CiAgICAgICAgaWYgKCFzZXRLZXJuZWxQcm9wZXJ0eSh0aGlzLCBw\ncm9wLCB2YWx1ZSkpIHsKICAgICAgICAgICAgaWYgKCFzZXRLZXJuZWxQcm9w\nZXJ0eSh0aGlzLmdldEZldGNoUGxhbigpLCBwcm9wLCB2YWx1ZSkpIHsKICAg\nICAgICAgICAgICAgIExvZyBsb2cgPSBnZXRDb25maWd1cmF0aW9uKCkuZ2V0\nTG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAg\nICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImlnbm9yZWQtZW0tcHJv\ncCIsIHByb3AsIHZhbHVlID09IG51bGwgPyAiIiA6IHZhbHVlLmdldENsYXNz\nKCkrIjoiICsgdmFsdWUpKTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQXR0\nZW1wdCB0byBzZXQgdGhlIGdpdmVuIHByb3BlcnR5IGFuZCB2YWx1ZSB0byB0\naGUgZ2l2ZW4gdGFyZ2V0IGluc3RhbmNlLgogICAgICogVGhlIG9yaWdpbmFs\nIHByb3BlcnR5IGlzIHRyYW5zcG9zZWQgdG8gYSBiZWFuLXN0eWxlIHByb3Bl\ncnR5IG5hbWUuCiAgICAgKiBUaGUgb3JpZ2luYWwgdmFsdWUgaXMgdHJhbnNm\nb3JtZWQgdG8gYSB0eXBlIGNvbnN1bWFibGUgYnkgdGhlIHRhcmdldC4KICAg\nICAqICAKICAgICAqIEByZXR1cm4gaWYgdGhlIHByb3BlcnR5IGNhbiBiZSBz\nZXQgdG8gdGhlIGdpdmVuIHRhcmdldC4KICAgICAqLwogICAgcHJpdmF0ZSBi\nb29sZWFuIHNldEtlcm5lbFByb3BlcnR5KE9iamVjdCB0YXJnZXQsIFN0cmlu\nZyBvcmlnaW5hbCwgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgU3RyaW5nIGJl\nYW5Qcm9wID0gZ2V0QmVhblByb3BlcnR5TmFtZShvcmlnaW5hbCk7CiAgICAg\nICAgSlBBUHJvcGVydGllcy5yZWNvcmQoYmVhblByb3AsIG9yaWdpbmFsKTsK\nICAgICAgICBDbGFzczw/PiBrVHlwZSAgPSBudWxsOwogICAgICAgIE9iamVj\ndCAgIGtWYWx1ZSA9IG51bGw7CiAgICAgICAgTWV0aG9kIHNldHRlciA9IFJl\nZmxlY3Rpb24uZmluZFNldHRlcih0YXJnZXQuZ2V0Q2xhc3MoKSwgYmVhblBy\nb3AsIGZhbHNlKTsKICAgICAgICBpZiAoc2V0dGVyICE9IG51bGwpIHsKICAg\nICAgICAgICAga1R5cGUgID0gc2V0dGVyLmdldFBhcmFtZXRlclR5cGVzKClb\nMF07CiAgICAgICAgICAgIGtWYWx1ZSA9IGNvbnZlcnRVc2VyVmFsdWUob3Jp\nZ2luYWwsIHZhbHVlLCBrVHlwZSk7CiAgICAgICAgICAgIFJlZmxlY3Rpb24u\nc2V0KHRhcmdldCwgc2V0dGVyLCBrVmFsdWUpOwogICAgICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBGaWVsZCBm\naWVsZCA9IFJlZmxlY3Rpb24uZmluZEZpZWxkKHRhcmdldC5nZXRDbGFzcygp\nLCBiZWFuUHJvcCwgZmFsc2UpOwogICAgICAgICAgICBpZiAoZmllbGQgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAga1R5cGUgID0gZmllbGQuZ2V0VHlw\nZSgpOwogICAgICAgICAgICAgICAga1ZhbHVlID0gY29udmVydFVzZXJWYWx1\nZShvcmlnaW5hbCwgdmFsdWUsIGtUeXBlKTsKICAgICAgICAgICAgICAgIFJl\nZmxlY3Rpb24uc2V0KHRhcmdldCwgZmllbGQsIGtWYWx1ZSk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogRXh0cmFjdCBhIGJlYW4tc3R5bGUgcHJvcGVydHkgbmFtZSBmcm9tIHRo\nZSBnaXZlbiBzdHJpbmcuCiAgICAgKiBJZiB0aGUgZ2l2ZW4gc3RyaW5nIGlz\nIDxjb2RlPiJhLmIueHl6IjwvY29kZT4gdGhlbiByZXR1cm5zIDxjb2RlPiJ4\neXoiPC9jb2RlPiAKICAgICAqLwogICAgU3RyaW5nIGdldEJlYW5Qcm9wZXJ0\neU5hbWUoU3RyaW5nIHVzZXIpIHsKICAgICAgICBTdHJpbmcgcmVzdWx0ID0g\ndXNlcjsKICAgICAgICBpZiAoSlBBUHJvcGVydGllcy5pc1ZhbGlkS2V5KHVz\nZXIpKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IEpQQVByb3BlcnRpZXMuZ2V0\nQmVhblByb3BlcnR5KHVzZXIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIGludCBkb3QgPSB1c2VyLmxhc3RJbmRleE9mKCcuJyk7CiAgICAgICAg\nICAgIGlmIChkb3QgIT0gLTEpCiAgICAgICAgICAgICAgICByZXN1bHQgPSB1\nc2VyLnN1YnN0cmluZyhkb3QrMSk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiByZXN1bHQ7IAogICAgfQogICAgCiAgICAKICAgIC8qKgogICAgICogQ29u\ndmVydCB0aGUgZ2l2ZW4gdmFsdWUgdG8gYSB2YWx1ZSBjb25zdW1hYmxlIGJ5\nIE9wZW5KUEEga2VybmVsIGNvbnN0cnVjdHMuCiAgICAgKi8KICAgIE9iamVj\ndCBjb252ZXJ0VXNlclZhbHVlKFN0cmluZyBrZXksIE9iamVjdCB2YWx1ZSwg\nQ2xhc3M8Pz4gdGFyZ2V0VHlwZSkgewogICAgICAgIGlmIChKUEFQcm9wZXJ0\naWVzLmlzVmFsaWRLZXkoa2V5KSkgCiAgICAgICAgICAgIHJldHVybiBKUEFQ\ncm9wZXJ0aWVzLmNvbnZlcnRUb0tlcm5lbFZhbHVlKHRhcmdldFR5cGUsIGtl\neSwgdmFsdWUpOwogICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmlu\nZykgewogICAgICAgICAgICBpZiAoIm51bGwiLmVxdWFscyh2YWx1ZSkpIHsK\nICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZ3MucGFyc2UoKFN0\ncmluZykgdmFsdWUsIHRhcmdldFR5cGUpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KCiAgICBwcml2YXRl\nIE1hcDxTdHJpbmcsIE9iamVjdD4gY2xvbmVQcm9wZXJ0aWVzKE1hcDxTdHJp\nbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAgICAgIGlmIChwcm9wZXJ0\naWVzICE9IG51bGwpIHsKICAgICAgICAgICAgcHJvcGVydGllcyA9IG5ldyBI\nYXNoTWFwPFN0cmluZywgT2JqZWN0Pihwcm9wZXJ0aWVzKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXM7CiAgICB9Cn0K\n","encoding":"base64"}

