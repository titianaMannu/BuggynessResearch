{"sha":"9c74950e9bbc496cddf078fe204659cf16c0ef84","node_id":"MDQ6QmxvYjIwNjM2NDo5Yzc0OTUwZTliYmM0OTZjZGRmMDc4ZmUyMDQ2NTljZjE2YzBlZjg0","size":38060,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9c74950e9bbc496cddf078fe204659cf16c0ef84","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOwppbXBvcnQgamF2YS5uZXQu\nTWFsZm9ybWVkVVJMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJMOwpp\nbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQg\namF2YS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7\nCmltcG9ydCBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDsKaW1wb3J0IGphdmEu\ndXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEu\ndXRpbC5NaXNzaW5nUmVzb3VyY2VFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlNoYXJlZENhY2hl\nTW9kZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlZhbGlkYXRpb25Nb2Rl\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uuc3BpLlBlcnNpc3RlbmNlVW5p\ndEluZm87CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5zcGkuUGVyc2lzdGVu\nY2VVbml0VHJhbnNhY3Rpb25UeXBlOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmNvbmYuQ29tcGF0aWJpbGl0eTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQVByb2R1Y3RE\nZXJpdmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuU3Bl\nY2lmaWNhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2Fj\naGUuRGF0YUNhY2hlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuTWl4ZWRMb2NrTGV2ZWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5RdWVyeUhpbnRzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5jb25mLkFic3RyYWN0UHJvZHVjdERlcml2YXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0\naW9uUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNv\nbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmNvbmYuTWFwQ29uZmlndXJhdGlvblByb3ZpZGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlByb2R1Y3REZXJpdmF0aW9uczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxNZXRhRGF0YVBhcnNl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxWZXJz\naW9uUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0\nZXM7CmltcG9ydCBvcmcueG1sLnNheC5TQVhFeGNlcHRpb247CgoKLyoqCiAq\nIFNldHMgSlBBIHNwZWNpZmljYXRpb24gZGVmYXVsdHMgYW5kIHBhcnNlcyBK\nUEEgc3BlY2lmaWNhdGlvbiBYTUwgZmlsZXMuCiAqIAogKiBGb3IgZ2xvYmFs\ncywgbG9va3MgaW4gPGNvZGU+b3BlbmpwYS5wcm9wZXJ0aWVzPC9jb2RlPiBz\neXN0ZW0gcHJvcGVydHkgZm9yCiAqIHRoZSBsb2NhdGlvbiBvZiBhIGZpbGUg\ndG8gcGFyc2UuIElmIG5vIHN5c3RlbSBwcm9wZXJ0eSBpcyBkZWZpbmVkLCB0\naGUKICogZGVmYXVsdCByZXNvdXJjZSBsb2NhdGlvbiBvZiA8Y29kZT5NRVRB\nLUlORi9vcGVuanBhLnhtbDwvY29kZT4gaXMgdXNlZC4KICoKICogRm9yIGRl\nZmF1bHRzLCBsb29rcyBmb3IgPGNvZGU+TUVUQS1JTkYvcGVyc2lzdGVuY2Uu\neG1sPC9jb2RlPi4KICogV2l0aGluIDxjb2RlPnBlcnNpc3RlbmNlLnhtbDwv\nY29kZT4sIGxvb2sgZm9yIHRoZSBuYW1lZCBwZXJzaXN0ZW5jZSB1bml0LCBv\ncgogKiBpZiBubyBuYW1lIGdpdmVuLCBhbiBPcGVuSlBBIHVuaXQgKHByZWZl\ncnJpbmcgYW4gdW5uYW1lZCBPcGVuSlBBIHVuaXQgdG8gCiAqIGEgbmFtZWQg\nb25lKS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwog\nKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNlUHJvZHVjdERlcml2YXRpb24g\nCiAgICBleHRlbmRzIEFic3RyYWN0UHJvZHVjdERlcml2YXRpb24KICAgIGlt\ncGxlbWVudHMgT3BlbkpQQVByb2R1Y3REZXJpdmF0aW9uIHsKCiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIFNwZWNpZmljYXRpb24gU1BFQ19KUEEgPSBuZXcg\nU3BlY2lmaWNhdGlvbigianBhIDIiKTsKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3BlY2lmaWNhdGlvbiBBTElBU19FSkIgPSBuZXcgU3BlY2lmaWNhdGlv\nbigiZWpiIDMiKTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFJT\nUkNfR0xPQkFMID0gIk1FVEEtSU5GL29wZW5qcGEueG1sIjsKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgU3RyaW5nIFJTUkNfREVGQVVMVCA9ICJNRVRBLUlO\nRi9wZXJzaXN0ZW5jZS54bWwiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBC\naWdEZWNpbWFsIFZFUlNJT05fMV8wID0gQmlnRGVjaW1hbC52YWx1ZU9mKDEu\nMCk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChQZXJzaXN0ZW5jZVBy\nb2R1Y3REZXJpdmF0aW9uLmNsYXNzKTsKCiAgICBwcml2YXRlIEhhc2hNYXA8\nU3RyaW5nLCBQVU5hbWVDb2xsaXNpb24+IF9wdU5hbWVDb2xsaXNpb25zCiAg\nICAgICAgPSBuZXcgSGFzaE1hcDxTdHJpbmcsUFVOYW1lQ29sbGlzaW9uPigp\nOwogICAgCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBQUkVGSVgg\nPSAiamF2YXgucGVyc2lzdGVuY2UiOyAKICAgIAogICAgcHJpdmF0ZSBzdGF0\naWMgU2V0PFN0cmluZz4gX2hpbnRzID0gbmV3IEhhc2hTZXQ8U3RyaW5nPigp\nOwogICAgCiAgICAvLyBQcm92aWRlciBuYW1lIHRvIGZpbHRlciBvdXQgUFVz\nIHRoYXQgZG9uJ3QgYmVsb25nIHRvIHRoaXMgZGVyaXZhdGlvbi4KICAgIHBy\nb3RlY3RlZCBTdHJpbmcgX3Byb3ZpZGVySW1wbE5hbWU7CgogICAgc3RhdGlj\nIHsKICAgICAgICBfaGludHMuYWRkKCJqYXZheC5wZXJzaXN0ZW5jZS5sb2Nr\nLnRpbWVvdXQiKTsKICAgICAgICBfaGludHMuYWRkKCJqYXZheC5wZXJzaXN0\nZW5jZS5xdWVyeS50aW1lb3V0Iik7CiAgICAgICAgCiAgICAgICAgX2hpbnRz\nLmFkZCgib3BlbmpwYS5GZXRjaFBsYW4uRXh0ZW5kZWRQYXRoTG9va3VwIik7\nCiAgICAgICAgX2hpbnRzLmFkZCgib3BlbmpwYS5GZXRjaEJhdGNoU2l6ZSIp\nOyAKICAgICAgICBfaGludHMuYWRkKCJvcGVuanBhLkZldGNoUGxhbi5GZXRj\naEJhdGNoU2l6ZSIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuTWF4\nRmV0Y2hEZXB0aCIpOyAKICAgICAgICBfaGludHMuYWRkKCJvcGVuanBhLkZl\ndGNoUGxhbi5NYXhGZXRjaERlcHRoIik7CiAgICAgICAgX2hpbnRzLmFkZCgi\nb3BlbmpwYS5Mb2NrVGltZW91dCIpOwogICAgICAgIF9oaW50cy5hZGQoIm9w\nZW5qcGEuRmV0Y2hQbGFuLkxvY2tUaW1lb3V0Iik7CiAgICAgICAgX2hpbnRz\nLmFkZCgib3BlbmpwYS5RdWVyeVRpbWVvdXQiKTsKICAgICAgICBfaGludHMu\nYWRkKCJvcGVuanBhLkZldGNoUGxhbi5RdWVyeVRpbWVvdXQiKTsKICAgICAg\nICBfaGludHMuYWRkKCJvcGVuanBhLkZsdXNoQmVmb3JlUXVlcmllcyIpOwog\nICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLkZsdXNoQmVm\nb3JlUXVlcmllcyIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuUmVh\nZExvY2tMZXZlbCIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0\nY2hQbGFuLlJlYWRMb2NrTGV2ZWwiKTsKICAgICAgICBfaGludHMuYWRkKCJv\ncGVuanBhLldyaXRlTG9ja0xldmVsIik7CiAgICAgICAgX2hpbnRzLmFkZCgi\nb3BlbmpwYS5GZXRjaFBsYW4uV3JpdGVMb2NrTGV2ZWwiKTsKICAgICAgICBf\naGludHMuYWRkKCJvcGVuanBhLkZldGNoUGxhbi5GZXRjaEJhdGNoU2l6ZSIp\nOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLkxvY2tT\nY29wZSIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFu\nLkxvY2tUaW1lb3V0Iik7CiAgICAgICAgX2hpbnRzLmFkZCgib3BlbmpwYS5G\nZXRjaFBsYW4uTWF4RmV0Y2hEZXB0aCIpOwogICAgICAgIF9oaW50cy5hZGQo\nIm9wZW5qcGEuRmV0Y2hQbGFuLlF1ZXJ5VGltZW91dCIpOwogICAgICAgIF9o\naW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLlJlYWRMb2NrTW9kZSIpOwog\nICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLldyaXRlTG9j\na01vZGUiKTsKICAgICAgICBfaGludHMuYWRkKFF1ZXJ5SGludHMuSElOVF9B\nR0dSRUdBVEVfTElTVEVORVIpOwogICAgICAgIF9oaW50cy5hZGQoUXVlcnlI\naW50cy5ISU5UX0FHR1JFR0FURV9MSVNURU5FUlMpOwogICAgICAgIF9oaW50\ncy5hZGQoUXVlcnlIaW50cy5ISU5UX0ZJTFRFUl9MSVNURU5FUik7CiAgICAg\nICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfRklMVEVSX0xJU1RFTkVS\nUyk7CiAgICAgICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfSUdOT1JF\nX0ZJTkRFUik7CiAgICAgICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRf\nSUdOT1JFX1BSRVBBUkVEX1FVRVJZKTsKICAgICAgICBfaGludHMuYWRkKFF1\nZXJ5SGludHMuSElOVF9JTlZBTElEQVRFX0ZJTkRFUik7CiAgICAgICAgX2hp\nbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfSU5WQUxJREFURV9QUkVQQVJFRF9R\nVUVSWSk7CiAgICAgICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfUEFS\nQU1fTUFSS0VSX0lOX1FVRVJZKTsKICAgICAgICBfaGludHMuYWRkKFF1ZXJ5\nSGludHMuSElOVF9SRUNBQ0hFX0ZJTkRFUik7CiAgICAgICAgX2hpbnRzLmFk\nZChRdWVyeUhpbnRzLkhJTlRfUkVTVUxUX0NPVU5UKTsKICAgICAgICBfaGlu\ndHMuYWRkKFF1ZXJ5SGludHMuSElOVF9TVUJDTEFTU0VTKTsKCiAgICAgICAg\nX2hpbnRzID0gQ29sbGVjdGlvbnMudW5tb2RpZmlhYmxlU2V0KF9oaW50cyk7\nCiAgICB9CiAgICAKCXB1YmxpYyBQZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0\naW9uKCkgewoJCV9wcm92aWRlckltcGxOYW1lID0gUGVyc2lzdGVuY2VQcm92\naWRlckltcGwuY2xhc3MuZ2V0TmFtZSgpOwoJfQogICAgCiAgICBwdWJsaWMg\ndm9pZCBwdXRCcm9rZXJGYWN0b3J5QWxpYXNlcyhNYXAgbSkgewogICAgfQoK\nICAgIHB1YmxpYyBpbnQgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gVFlQ\nRV9TUEVDOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0Q29uZmlndXJhdGlvblByZWZpeCgpIHsKICAgICAgICByZXR1\ncm4gUFJFRklYOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBTZXQ8U3RyaW5nPiBnZXRTdXBwb3J0ZWRRdWVyeUhpbnRzKCkgewogICAg\nICAgIHJldHVybiBfaGludHM7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCB2YWxpZGF0ZSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgLy8gbWFrZSBzdXJlIEpQQSBpcyBhdmFpbGFibGUKICAg\nICAgICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhl\nbHBlci5nZXRDbGFzc0xvYWRlckFjdGlvbigKICAgICAgICAgICAgamF2YXgu\ncGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3RvcnkuY2xhc3MpKTsKICAg\nIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBiZWZv\ncmVDb25maWd1cmF0aW9uTG9hZChDb25maWd1cmF0aW9uIGMpIHsKICAgICAg\nICBpZiAoIShjIGluc3RhbmNlb2YgT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBs\nKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIAogICAgICAg\nIE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCBjb25mID0gKE9wZW5KUEFDb25m\naWd1cmF0aW9uSW1wbCkgYzsKICAgICAgICBjb25mLm1ldGFGYWN0b3J5UGx1\nZ2luLnNldEFsaWFzKEFMSUFTX0VKQi5nZXROYW1lKCksIFBlcnNpc3RlbmNl\nTWV0YURhdGFGYWN0b3J5LmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgY29u\nZi5tZXRhRmFjdG9yeVBsdWdpbi5zZXRBbGlhcyhTUEVDX0pQQS5nZXROYW1l\nKCksICBQZXJzaXN0ZW5jZU1ldGFEYXRhRmFjdG9yeS5jbGFzcy5nZXROYW1l\nKCkpOwogICAgICAgIAogICAgICAgIGNvbmYuYWRkVmFsdWUobmV3IEVudGl0\neU1hbmFnZXJGYWN0b3J5VmFsdWUoKSk7CiAgICAgICAgCiAgICAgICAgY29u\nZi5yZWFkTG9ja0xldmVsLnNldEFsaWFzKCJvcHRpbWlzdGljIiwgU3RyaW5n\nLnZhbHVlT2YoTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfT1BUSU1JU1RJQykpOwog\nICAgICAgIGNvbmYucmVhZExvY2tMZXZlbC5zZXRBbGlhcygib3B0aW1pc3Rp\nYy1mb3JjZS1pbmNyZW1lbnQiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVl\nT2YoTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfT1BUSU1JU1RJQ19GT1JDRV9JTkNS\nRU1FTlQpKTsKICAgICAgICBjb25mLnJlYWRMb2NrTGV2ZWwuc2V0QWxpYXMo\nInBlc3NpbWlzdGljLXJlYWQiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVl\nT2YoTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfUEVTU0lNSVNUSUNfUkVBRCkpOwog\nICAgICAgIGNvbmYucmVhZExvY2tMZXZlbC5zZXRBbGlhcygicGVzc2ltaXN0\naWMtd3JpdGUiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVlT2YoTWl4ZWRM\nb2NrTGV2ZWxzLkxPQ0tfUEVTU0lNSVNUSUNfV1JJVEUpKTsKICAgICAgICBj\nb25mLnJlYWRMb2NrTGV2ZWwuc2V0QWxpYXMoInBlc3NpbWlzdGljLWZvcmNl\nLWluY3JlbWVudCIsIFN0cmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhl\nZExvY2tMZXZlbHMuTE9DS19QRVNTSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQp\nKTsKCiAgICAgICAgY29uZi53cml0ZUxvY2tMZXZlbC5zZXRBbGlhcygib3B0\naW1pc3RpYyIsIFN0cmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhlZExv\nY2tMZXZlbHMuTE9DS19PUFRJTUlTVElDKSk7CiAgICAgICAgY29uZi53cml0\nZUxvY2tMZXZlbC5zZXRBbGlhcygib3B0aW1pc3RpYy1mb3JjZS1pbmNyZW1l\nbnQiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVlT2YoTWl4ZWRMb2NrTGV2\nZWxzLkxPQ0tfT1BUSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQpKTsKICAgICAg\nICBjb25mLndyaXRlTG9ja0xldmVsLnNldEFsaWFzKCJwZXNzaW1pc3RpYy1y\nZWFkIiwgU3RyaW5nCiAgICAgICAgICAgIC52YWx1ZU9mKE1peGVkTG9ja0xl\ndmVscy5MT0NLX1BFU1NJTUlTVElDX1JFQUQpKTsKICAgICAgICBjb25mLndy\naXRlTG9ja0xldmVsLnNldEFsaWFzKCJwZXNzaW1pc3RpYy13cml0ZSIsIFN0\ncmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhlZExvY2tMZXZlbHMuTE9D\nS19QRVNTSU1JU1RJQ19XUklURSkpOwogICAgICAgIGNvbmYud3JpdGVMb2Nr\nTGV2ZWwuc2V0QWxpYXMoInBlc3NpbWlzdGljLWZvcmNlLWluY3JlbWVudCIs\nIFN0cmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhlZExvY2tMZXZlbHMu\nTE9DS19QRVNTSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQpKTsKCiAgICAgICAg\nY29uZi5sb2NrTWFuYWdlclBsdWdpbi5zZXRBbGlhcygibWl4ZWQiLCAib3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLk1peGVkTG9ja01hbmFnZXIi\nKTsKCiAgICAgICAgY29uZmlndXJlQmVhblZhbGlkYXRpb24oY29uZik7CiAg\nICAgICAgCiAgICAgICAgY29uZi5kYXRhQ2FjaGVNb2RlID0gY29uZi5hZGRT\ndHJpbmcoSlBBUHJvcGVydGllcy5DQUNIRV9NT0RFKTsKICAgICAgICBjb25m\nLmRhdGFDYWNoZU1vZGUuc2V0RGVmYXVsdChEYXRhQ2FjaGVNb2RlLlVOU1BF\nQ0lGSUVELnRvU3RyaW5nKCkpOwogICAgICAgIGNvbmYuZGF0YUNhY2hlTW9k\nZS5zZXQoRGF0YUNhY2hlTW9kZS5VTlNQRUNJRklFRC50b1N0cmluZygpKTsK\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQmVhbiBWYWxpZGF0aW9uIGNvbmZpZ3VyYXRpb24gaXMgdW51c3VhbCBi\nZWNhdXNlIGl0cyB1c2FnZSBvZiBlbnVtcyBhbmQga2V5cyB0aGF0CiAgICAg\nKiBkbyBub3QgaGF2ZSBjb3VudGVycGFydHMgaW4ga2VybmVsLgogICAgICog\nSGVuY2UgdGhlIHBsdWdpbnMgYXJlIGRlZmluZWQgaW4gcHJvZHVjdCBkZXJp\ndmF0aW9uIGluc3RlYWQgb2YgdGhlIGtlcm5lbCdzCiAgICAgKiBjb3JlIGNv\nbmZpZ3VyYXRpb24uCiAgICAgKiAKICAgICAqIEBwYXJhbSBjb25mCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBjb25maWd1cmVCZWFuVmFsaWRhdGlvbihP\ncGVuSlBBQ29uZmlndXJhdGlvbkltcGwgY29uZikgewogICAgICAgIC8vIFZh\nbGlkYXRpb24gZGVmaW5lcy9hZGRzIHRoZSBmb2xsb3dpbmcgcGx1Z2lucyB0\nbyBPcGVuSlBBIENvbmZpZ3VyYXRpb24KICAgICAgICBjb25mLnZhbGlkYXRp\nb25GYWN0b3J5ICAgICAgICAgPSBjb25mLmFkZE9iamVjdChKUEFQcm9wZXJ0\naWVzLlZBTElEQVRFX0ZBQ1RPUlkpOyAKICAgICAgICBjb25mLnZhbGlkYXRv\nciAgICAgICAgICAgICAgICAgPSBjb25mLmFkZE9iamVjdCgiVmFsaWRhdG9y\nIik7CiAgICAgICAgY29uZi52YWxpZGF0aW9uTW9kZSAgICAgICAgICAgID0g\nY29uZi5hZGRTdHJpbmcoSlBBUHJvcGVydGllcy5WQUxJREFURV9NT0RFKTsK\nICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVBlcnNpc3QgPSBjb25m\nLmFkZFN0cmluZyhKUEFQcm9wZXJ0aWVzLlZBTElEQVRFX1BSRV9QRVJTSVNU\nKTsKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZSAgPSBj\nb25mLmFkZFN0cmluZyhKUEFQcm9wZXJ0aWVzLlZBTElEQVRFX1BSRV9VUERB\nVEUpOwogICAgICAgIGNvbmYudmFsaWRhdGlvbkdyb3VwUHJlUmVtb3ZlICA9\nIGNvbmYuYWRkU3RyaW5nKEpQQVByb3BlcnRpZXMuVkFMSURBVEVfUFJFX1JF\nTU9WRSk7CiAgICAgICAgCiAgICAgICAgY29uZi52YWxpZGF0aW9uTW9kZS5z\nZXREeW5hbWljKHRydWUpOwogICAgICAgIFN0cmluZ1tdIGFsaWFzZXMgPSBu\nZXcgU3RyaW5nW10gewogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2Yo\nVmFsaWRhdGlvbk1vZGUuQVVUTyksCiAgICAgICAgICAgICAgICBTdHJpbmcu\ndmFsdWVPZihWYWxpZGF0aW9uTW9kZS5BVVRPKS50b0xvd2VyQ2FzZSgpLAog\nICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2YoVmFsaWRhdGlvbk1vZGUu\nQ0FMTEJBQ0spLAogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2YoVmFs\naWRhdGlvbk1vZGUuQ0FMTEJBQ0spLnRvTG93ZXJDYXNlKCksCiAgICAgICAg\nICAgICAgICBTdHJpbmcudmFsdWVPZihWYWxpZGF0aW9uTW9kZS5OT05FKSwK\nICAgICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKFZhbGlkYXRpb25Nb2Rl\nLk5PTkUpLnRvTG93ZXJDYXNlKCkKICAgICAgICB9OwogICAgICAgIGNvbmYu\ndmFsaWRhdGlvbk1vZGUuc2V0QWxpYXNlcyhhbGlhc2VzKTsKICAgICAgICBj\nb25mLnZhbGlkYXRpb25Nb2RlLnNldEFsaWFzTGlzdENvbXByZWhlbnNpdmUo\ndHJ1ZSk7CiAgICAgICAgY29uZi52YWxpZGF0aW9uTW9kZS5zZXREZWZhdWx0\nKGFsaWFzZXNbMF0pOwoKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFBy\nZVBlcnNpc3Quc2V0U3RyaW5nKEpQQVByb3BlcnRpZXMuVkFMSURBVEVfR1JP\nVVBfREVGQVVMVCk7CiAgICAgICAgY29uZi52YWxpZGF0aW9uR3JvdXBQcmVQ\nZXJzaXN0LnNldERlZmF1bHQoIiIpOwogICAgICAgIGNvbmYudmFsaWRhdGlv\nbkdyb3VwUHJlUGVyc2lzdC5zZXREeW5hbWljKHRydWUpOwoKICAgICAgICBj\nb25mLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZS5zZXRTdHJpbmcoSlBBUHJv\ncGVydGllcy5WQUxJREFURV9HUk9VUF9ERUZBVUxUKTsKICAgICAgICBjb25m\nLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZS5zZXREZWZhdWx0KCIiKTsKICAg\nICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZS5zZXREeW5hbWlj\nKHRydWUpOwoKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVJlbW92\nZS5zZXREZWZhdWx0KCIiKTsKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91\ncFByZVJlbW92ZS5zZXREeW5hbWljKHRydWUpOwoKICAgICAgICBjb25mLnZh\nbGlkYXRpb25GYWN0b3J5LnNldEluc3RhbnRpYXRpbmdHZXR0ZXIoImdldFZh\nbGlkYXRpb25GYWN0b3J5SW5zdGFuY2UiKTsKICAgICAgICBjb25mLnZhbGlk\nYXRpb25GYWN0b3J5LnNldER5bmFtaWModHJ1ZSk7CgogICAgICAgIGNvbmYu\ndmFsaWRhdG9yLnNldEluc3RhbnRpYXRpbmdHZXR0ZXIoImdldFZhbGlkYXRv\nckluc3RhbmNlIik7CiAgICAgICAgY29uZi52YWxpZGF0b3Iuc2V0RHluYW1p\nYyh0cnVlKTsKICAgICAgICBjb25mLnZhbGlkYXRvci5tYWtlUHJpdmF0ZSgp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gYWZ0\nZXJTcGVjaWZpY2F0aW9uU2V0KENvbmZpZ3VyYXRpb24gYykgewogICAgICAg\nIGlmICghT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsLmNsYXNzLmlzSW5zdGFu\nY2UoYykKICAgICAgICAgJiYgIVNQRUNfSlBBLmlzU2FtZSgoKE9wZW5KUEFD\nb25maWd1cmF0aW9uKSBjKS5nZXRTcGVjaWZpY2F0aW9uKCkpKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAKICAgICAgICBPcGVuSlBBQ29uZmlndXJh\ndGlvbkltcGwgY29uZiA9IChPcGVuSlBBQ29uZmlndXJhdGlvbkltcGwpIGM7\nCiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBsdWdpbi5zZXREZWZhdWx0KFNQ\nRUNfSlBBLmdldE5hbWUoKSk7CiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBs\ndWdpbi5zZXRTdHJpbmcoU1BFQ19KUEEuZ2V0TmFtZSgpKTsKICAgICAgICBj\nb25mLmxvY2tNYW5hZ2VyUGx1Z2luLnNldERlZmF1bHQoIm1peGVkIik7CiAg\nICAgICAgY29uZi5sb2NrTWFuYWdlclBsdWdpbi5zZXRTdHJpbmcoIm1peGVk\nIik7CiAgICAgICAgY29uZi5ub250cmFuc2FjdGlvbmFsV3JpdGUuc2V0RGVm\nYXVsdCgidHJ1ZSIpOwogICAgICAgIGNvbmYubm9udHJhbnNhY3Rpb25hbFdy\naXRlLnNldCh0cnVlKTsKICAgICAgICBTcGVjaWZpY2F0aW9uIHNwZWMgPSAo\nKE9wZW5KUEFDb25maWd1cmF0aW9uKSBjKS5nZXRTcGVjaWZpY2F0aW9uSW5z\ndGFuY2UoKTsKICAgICAgICBpbnQgc3BlY1ZlcnNpb24gPSBzcGVjLmdldFZl\ncnNpb24oKTsKICAgICAgICBDb21wYXRpYmlsaXR5IGNvbXBhdGliaWxpdHkg\nPSBjb25mLmdldENvbXBhdGliaWxpdHlJbnN0YW5jZSgpOwogICAgICAgIHNw\nZWMuc2V0Q29tcGF0aWJpbGl0eShjb21wYXRpYmlsaXR5KTsKICAgICAgICBp\nZiAoc3BlY1ZlcnNpb24gPCAyKSB7CiAgICAgICAgICAgIGNvbXBhdGliaWxp\ndHkuc2V0Rmx1c2hCZWZvcmVEZXRhY2godHJ1ZSk7CiAgICAgICAgICAgIGNv\nbXBhdGliaWxpdHkuc2V0Q29weU9uRGV0YWNoKHRydWUpOwogICAgICAgICAg\nICBjb21wYXRpYmlsaXR5LnNldFByaXZhdGVQZXJzaXN0ZW50UHJvcGVydGll\ncyh0cnVlKTsKICAgICAgICAgICAgY29tcGF0aWJpbGl0eS5zZXRJZ25vcmVE\nZXRhY2hlZFN0YXRlRmllbGRGb3JQcm94eVNlcmlhbGl6YXRpb24odHJ1ZSk7\nCiAgICAgICAgICAgIC8vIERpc2FibGUgYmVhbiB2YWxpZGF0aW9uIGZvciBz\ncGVjIGxldmVsIDwgMiBjb25maWd1cmF0aW9ucwogICAgICAgICAgICBjb25m\nLnZhbGlkYXRpb25Nb2RlLnNldChTdHJpbmcudmFsdWVPZihWYWxpZGF0aW9u\nTW9kZS5OT05FKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29t\ncGF0aWJpbGl0eS5zZXRBYnN0cmFjdE1hcHBpbmdVbmlEaXJlY3Rpb25hbCh0\ncnVlKTsKICAgICAgICAgICAgY29tcGF0aWJpbGl0eS5zZXROb25EZWZhdWx0\nTWFwcGluZ0FsbG93ZWQodHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTG9hZCBjb25maWd1cmF0\naW9uIGZyb20gdGhlIGdpdmVuIHBlcnNpc3RlbmNlIHVuaXQgd2l0aCB0aGUg\nc3BlY2lmaWVkCiAgICAgKiB1c2VyIHByb3BlcnRpZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZChQZXJzaXN0ZW5j\nZVVuaXRJbmZvIHBpbmZvLCBNYXAgbSkKICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIGlmIChwaW5mbyA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoIWlzT3BlbkpQQVBlcnNpc3Rl\nbmNlUHJvdmlkZXIocGluZm8sIG51bGwpKSB7CiAgICAgICAgICAgIHdhcm5V\nbmtub3duUHJvdmlkZXIocGluZm8pOwogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICB9CgogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlcklt\ncGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCgpOwogICAg\nICAgIGNwLmFkZFByb3BlcnRpZXMoUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwu\ndG9PcGVuSlBBUHJvcGVydGllcyhwaW5mbykpOwogICAgICAgIGNwLmFkZFBy\nb3BlcnRpZXMobSk7CiAgICAgICAgaWYgKHBpbmZvIGluc3RhbmNlb2YgUGVy\nc2lzdGVuY2VVbml0SW5mb0ltcGwpIHsKICAgICAgICAgICAgUGVyc2lzdGVu\nY2VVbml0SW5mb0ltcGwgaW1wbCA9IChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1w\nbCkgcGluZm87CiAgICAgICAgICAgIGlmIChpbXBsLmdldFBlcnNpc3RlbmNl\nWG1sRmlsZVVybCgpICE9IG51bGwpCiAgICAgICAgICAgICAgICBjcC5zZXRT\nb3VyY2UoaW1wbC5nZXRQZXJzaXN0ZW5jZVhtbEZpbGVVcmwoKS50b1N0cmlu\nZygpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNwOwogICAgfQoKICAg\nIC8qKgogICAgICogTG9hZCBjb25maWd1cmF0aW9uIGZyb20gdGhlIGdpdmVu\nIHJlc291cmNlIGFuZCB1bml0IG5hbWVzLCB3aGljaCBtYXkKICAgICAqIGJl\nIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlk\nZXIgbG9hZChTdHJpbmcgcnNyYywgU3RyaW5nIG5hbWUsIE1hcCBtKQogICAg\nICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgYm9vbGVhbiBleHBs\naWNpdCA9ICFTdHJpbmdVdGlscy5pc0VtcHR5KHJzcmMpOwogICAgICAgIGlm\nICghZXhwbGljaXQpCiAgICAgICAgICAgIHJzcmMgPSBSU1JDX0RFRkFVTFQ7\nCiAgICAgICAgCiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCBj\ncCA9IG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKCk7CiAgICAgICAg\nQm9vbGVhbiByZXQgPSBsb2FkKGNwLCByc3JjLCBuYW1lLCBtLCBudWxsLCBl\neHBsaWNpdCk7CiAgICAgICAgaWYgKHJldCAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gKHJldC5ib29sZWFuVmFsdWUoKSkgPyBjcCA6IG51bGw7CiAg\nICAgICAgaWYgKGV4cGxpY2l0KQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nCiAgICAgICAgLy8gcGVyc2lzdGVuY2UueG1sIGRvZXMgbm90IGV4aXN0OyBq\ndXN0IGxvYWQgbWFwCiAgICAgICAgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwg\ncGluZm8gPSBuZXcgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwoKTsKICAgICAg\nICBwaW5mby5mcm9tVXNlclByb3BlcnRpZXMobSk7CiAgICAgICAgaWYgKCFp\nc09wZW5KUEFQZXJzaXN0ZW5jZVByb3ZpZGVyKHBpbmZvLCBudWxsKSkgewog\nICAgICAgICAgICB3YXJuVW5rbm93blByb3ZpZGVyKHBpbmZvKTsKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGNwLmFkZFBy\nb3BlcnRpZXMocGluZm8udG9PcGVuSlBBUHJvcGVydGllcygpKTsKICAgICAg\nICByZXR1cm4gY3A7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\nQ29uZmlndXJhdGlvblByb3ZpZGVyIGxvYWQoU3RyaW5nIHJzcmMsIFN0cmlu\nZyBhbmNob3IsIAogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcikKICAgICAg\nICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChyc3JjICE9IG51\nbGwgJiYgIXJzcmMuZW5kc1dpdGgoIi54bWwiKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCBj\ncCA9IG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKCk7CiAgICAgICAg\naWYgKGxvYWQoY3AsIHJzcmMsIGFuY2hvciwgbnVsbCwgbG9hZGVyLCB0cnVl\nKSA9PSBCb29sZWFuLlRSVUUpCiAgICAgICAgICAgIHJldHVybiBjcDsKICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZChGaWxlIGZpbGUsIFN0\ncmluZyBhbmNob3IpIAogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKCFmaWxlLmdldE5hbWUoKS5lbmRzV2l0aCgiLnhtbCIpKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ29uZmlndXJhdGlv\nblBhcnNlciBwYXJzZXIgPSBuZXcgQ29uZmlndXJhdGlvblBhcnNlcihudWxs\nKTsKICAgICAgICBwYXJzZXIucGFyc2UoZmlsZSk7CiAgICAgICAgcmV0dXJu\nIGxvYWQoZmluZFVuaXQoKExpc3Q8UGVyc2lzdGVuY2VVbml0SW5mb0ltcGw+\nKSAKICAgICAgICAgICAgcGFyc2VyLmdldFJlc3VsdHMoKSwgYW5jaG9yLCBu\ndWxsKSwgbnVsbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\nU3RyaW5nIGdldERlZmF1bHRSZXNvdXJjZUxvY2F0aW9uKCkgewogICAgICAg\nIHJldHVybiBSU1JDX0RFRkFVTFQ7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgTGlzdCBnZXRBbmNob3JzSW5GaWxlKEZpbGUgZmlsZSkgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBDb25maWd1cmF0aW9uUGFyc2Vy\nIHBhcnNlciA9IG5ldyBDb25maWd1cmF0aW9uUGFyc2VyKG51bGwpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHBhcnNlci5wYXJzZShmaWxlKTsKICAg\nICAgICAgICAgcmV0dXJuIGdldFVuaXROYW1lcyhwYXJzZXIpOwogICAgICAg\nIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gbm90\nIGFsbCBjb25maWd1cmF0aW9uIGZpbGVzIGFyZSBYTUw7IHJldHVybiBudWxs\nIGlmIHVucGFyc2FibGUKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgfQogICAgfQoKICAgIHByaXZhdGUgTGlzdDxTdHJpbmc+IGdldFVuaXRO\nYW1lcyhDb25maWd1cmF0aW9uUGFyc2VyIHBhcnNlcikgewogICAgICAgIExp\nc3Q8UGVyc2lzdGVuY2VVbml0SW5mb0ltcGw+IHVuaXRzID0gcGFyc2VyLmdl\ndFJlc3VsdHMoKTsKICAgICAgICBMaXN0PFN0cmluZz4gbmFtZXMgPSBuZXcg\nQXJyYXlMaXN0PFN0cmluZz4oKTsKICAgICAgICBmb3IgKFBlcnNpc3RlbmNl\nVW5pdEluZm9JbXBsIHVuaXQgOiB1bml0cyl7CiAgICAgICAgCVN0cmluZyBw\ncm92aWRlciA9IHVuaXQuZ2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFt\nZSgpOwoJCQkvLyBPbmx5IGFkZCB0aGUgUFUgbmFtZSBpZiB0aGUgcHJvdmlk\nZXIgaXQgaXMgb3VycyBvciBub3Qgc3BlY2lmaWVkLgoJCQlpZiAocHJvdmlk\nZXIgPT0gbnVsbCB8fCBwcm92aWRlci5lcXVhbHMoX3Byb3ZpZGVySW1wbE5h\nbWUpKSB7CgkJCQluYW1lcy5hZGQodW5pdC5nZXRQZXJzaXN0ZW5jZVVuaXRO\nYW1lKCkpOwoJCQl9IGVsc2UgewoJCQkJLy8gU2hvdWxkIHRyYWNlIHNvbWV0\naGluZywgYnV0IGxvZ2dpbmcgaXNuJ3QgY29uZmlndXJlZCB5ZXQuCgkJCQkv\nLyBTd2FsbG93LgoJCQl9CiAgICAgICAgfQogICAgICAgIHJldHVybiBuYW1l\nczsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBMaXN0IGdldEFu\nY2hvcnNJblJlc291cmNlKFN0cmluZyByZXNvdXJjZSkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQ29uZmlndXJhdGlvblBhcnNlciBwYXJzZXIgPSBu\nZXcgQ29uZmlndXJhdGlvblBhcnNlcihudWxsKTsKICAgICAgICB0cnkgewog\nICAgICAgIAlMaXN0IHJlc3VsdHMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAg\nICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IEFjY2Vzc0NvbnRyb2xsZXIu\nZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIu\nZ2V0Q29udGV4dENsYXNzTG9hZGVyQWN0aW9uKCkpOwogICAgICAgICAgICBM\naXN0PFVSTD4gdXJscyA9IGdldFJlc291cmNlVVJMcyhyZXNvdXJjZSwgbG9h\nZGVyKTsKICAgICAgICAgICAgaWYgKHVybHMgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgZm9yIChVUkwgdXJsIDogdXJscykgewogICAgICAgICAgICAg\nICAgICAgIHBhcnNlci5wYXJzZSh1cmwpOwogICAgICAgICAgICAgICAgICAg\nIHJlc3VsdHMuYWRkQWxsKGdldFVuaXROYW1lcyhwYXJzZXIpKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4g\ncmVzdWx0czsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIC8vIG5vdCBhbGwgY29uZmlndXJhdGlvbiBmaWxlcyBhcmUg\nWE1MOyByZXR1cm4gbnVsbCBpZiB1bnBhcnNhYmxlCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZEdsb2JhbHMoQ2xh\nc3NMb2FkZXIgbG9hZGVyKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgU3RyaW5nW10gcHJlZml4ZXMgPSBQcm9kdWN0RGVyaXZhdGlv\nbnMuZ2V0Q29uZmlndXJhdGlvblByZWZpeGVzKCk7CiAgICAgICAgU3RyaW5n\nIHJzcmMgPSBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcHJl\nZml4ZXMubGVuZ3RoICYmIFN0cmluZ1V0aWxzLmlzRW1wdHkocnNyYyk7IGkr\nKykKICAgICAgICAgICByc3JjID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZp\nbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgIC5nZXRQcm9w\nZXJ0eUFjdGlvbihwcmVmaXhlc1tpXSArICIucHJvcGVydGllcyIpKTsgCiAg\nICAgICAgYm9vbGVhbiBleHBsaWNpdCA9ICFTdHJpbmdVdGlscy5pc0VtcHR5\nKHJzcmMpOwogICAgICAgIFN0cmluZyBhbmNob3IgPSBudWxsOwogICAgICAg\nIGludCBpZHggPSAoIWV4cGxpY2l0KSA/IC0xIDogcnNyYy5sYXN0SW5kZXhP\nZignIycpOwogICAgICAgIGlmIChpZHggIT0gLTEpIHsKICAgICAgICAgICAg\nLy8gc2VwYXJhdGUgbmFtZSBmcm9tIDxyZXNyb3VjZT4jPG5hbWU+IHN0cmlu\nZwogICAgICAgICAgICBpZiAoaWR4IDwgcnNyYy5sZW5ndGgoKSAtIDEpCiAg\nICAgICAgICAgICAgICBhbmNob3IgPSByc3JjLnN1YnN0cmluZyhpZHggKyAx\nKTsKICAgICAgICAgICAgcnNyYyA9IHJzcmMuc3Vic3RyaW5nKDAsIGlkeCk7\nCiAgICAgICAgfQogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHJz\ncmMpKQogICAgICAgICAgICByc3JjID0gUlNSQ19HTE9CQUw7CiAgICAgICAg\nZWxzZSBpZiAoIXJzcmMuZW5kc1dpdGgoIi54bWwiKSkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlcklt\ncGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCgpOwogICAg\nICAgIGlmIChsb2FkKGNwLCByc3JjLCBhbmNob3IsIG51bGwsIGxvYWRlciwg\nZXhwbGljaXQpID09IEJvb2xlYW4uVFJVRSkKICAgICAgICAgICAgcmV0dXJu\nIGNwOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkRGVmYXVs\ndHMoQ2xhc3NMb2FkZXIgbG9hZGVyKQogICAgICAgIHRocm93cyBJT0V4Y2Vw\ndGlvbiB7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCBjcCA9\nIG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKCk7CiAgICAgICAgaWYg\nKGxvYWQoY3AsIFJTUkNfREVGQVVMVCwgbnVsbCwgbnVsbCwgbG9hZGVyLCBm\nYWxzZSkgPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAgICByZXR1cm4gY3A7\nCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgICAvKioKICAgICAg\nKiBUaGlzIG1ldGhvZCBjaGVja3MgdG8gc2VlIGlmIHRoZSBwcm92aWRlZCA8\nY29kZT5wdU5hbWU8L2NvZGU+IHdhcwogICAgICAqIGRldGVjdGVkIGluIG11\nbHRpcGxlIHJlc291cmNlcy4gSWYgYSBjb2xsaXNpb24gaXMgZGV0ZWN0ZWQs\nIGEgd2FybmluZwogICAgICAqIHdpbGwgYmUgbG9nZ2VkIGFuZCB0aGlzIG1l\ndGhvZCB3aWxsIHJldHVybiA8Y29kZT50cnVlPC9jb2RlPi4KICAgICAgKiA8\ncD4KICAgICAgKi8KICAgICBwdWJsaWMgYm9vbGVhbiBjaGVja1B1TmFtZUNv\nbGxpc2lvbnMoTG9nIGxvZ2dlcixTdHJpbmcgcHVOYW1lKXsKICAgICAgICAg\nUFVOYW1lQ29sbGlzaW9uIHAgPSBfcHVOYW1lQ29sbGlzaW9ucy5nZXQocHVO\nYW1lKTsKICAgICAgICAgaWYgKHAgIT0gbnVsbCl7CiAgICAgICAgICAgICBw\nLmxvZ0NvbGxpc2lvbihsb2dnZXIpOwogICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgIH0KICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgIH0K\nCiAgICBwcml2YXRlIHN0YXRpYyBMaXN0PFVSTD4gZ2V0UmVzb3VyY2VVUkxz\nKFN0cmluZyByc3JjLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBFbnVtZXJhdGlvbjxVUkw+IHVy\nbHMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHVybHMgPSBB\nY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5n\nZXRSZXNvdXJjZXNBY3Rpb24obG9hZGVyLCByc3JjKSk7IAogICAgICAgICAg\nICBpZiAoIXVybHMuaGFzTW9yZUVsZW1lbnRzKCkpIHsKICAgICAgICAgICAg\nICAgIGlmICghcnNyYy5zdGFydHNXaXRoKCJNRVRBLUlORiIpKQogICAgICAg\nICAgICAgICAgICB1cmxzID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVn\nZWQoSjJEb1ByaXZIZWxwZXIuZ2V0UmVzb3VyY2VzQWN0aW9uKGxvYWRlciwg\nIk1FVEEtSU5GLyIgKyByc3JjKSk7CiAgICAgICAgICAgICAgICBpZiAoIXVy\nbHMuaGFzTW9yZUVsZW1lbnRzKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChQcml2\naWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAgICB0aHJv\ndyAoSU9FeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsKICAgICAgICB9\nCgogICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy5saXN0KHVybHMpOwogICAg\nfQoKICAgIC8qKgogICAgICogTG9va3MgdGhyb3VnaCB0aGUgcmVzb3VyY2Vz\nIGF0IDxjb2RlPnJzcmM8L2NvZGU+IGZvciBhIGNvbmZpZ3VyYXRpb24KICAg\nICAqIGZpbGUgdGhhdCBtYXRjaGVzIDxjb2RlPm5hbWU8L2NvZGU+IChvciBh\nbiB1bm5hbWVkIG9uZSBpZgogICAgICogPGNvZGU+bmFtZTwvY29kZT4gaXMg\nPGNvZGU+bnVsbDwvY29kZT4pLCBhbmQgbG9hZHMgdGhlIFhNTCBpbiB0aGUK\nICAgICAqIHJlc291cmNlIGludG8gYSBuZXcge0BsaW5rIFBlcnNpc3RlbmNl\nVW5pdEluZm99LiBUaGVuLCBhcHBsaWVzIHRoZQogICAgICogb3ZlcnJpZGVz\nIGluIDxjb2RlPm08L2NvZGU+LgogICAgICoKICAgICAqIEByZXR1cm4ge0Bs\naW5rIEJvb2xlYW4jVFJVRX0gaWYgdGhlIHJlc291cmNlIHdhcyBsb2FkZWQs\nIG51bGwgaWYgaXQKICAgICAqIGRvZXMgbm90IGV4aXN0LCBvciB7QGxpbmsg\nQm9vbGVhbiNGQUxTRX0gaWYgaXQgaXMgbm90IGZvciBPcGVuSlBBCiAgICAg\nKi8KICAgIHByaXZhdGUgQm9vbGVhbiBsb2FkKENvbmZpZ3VyYXRpb25Qcm92\naWRlckltcGwgY3AsIFN0cmluZyByc3JjLCAKICAgICAgICBTdHJpbmcgbmFt\nZSwgTWFwIG0sIENsYXNzTG9hZGVyIGxvYWRlciwgYm9vbGVhbiBleHBsaWNp\ndCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChs\nb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9hZGVyID0gQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIuZ2V0Q29udGV4\ndENsYXNzTG9hZGVyQWN0aW9uKCkpOwoKICAgICAgICBMaXN0PFVSTD4gdXJs\ncyA9IGdldFJlc291cmNlVVJMcyhyc3JjLCBsb2FkZXIpOwogICAgICAgIGlm\nICh1cmxzID09IG51bGwgfHwgdXJscy5zaXplKCkgPT0gMCkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIENvbmZpZ3VyYXRpb25QYXJzZXIg\ncGFyc2VyID0gbmV3IENvbmZpZ3VyYXRpb25QYXJzZXIobSk7CiAgICAgICAg\nUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwgcGluZm8gPSBwYXJzZVJlc291cmNl\ncyhwYXJzZXIsIHVybHMsIG5hbWUsIGxvYWRlcik7CiAgICAgICAgaWYgKHBp\nbmZvID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKCFleHBsaWNpdCkKICAg\nICAgICAgICAgICAgIHJldHVybiBCb29sZWFuLkZBTFNFOwogICAgICAgICAg\nICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJtaXNzaW5nLXhtbC1jb25maWciLCAKICAgICAgICAgICAgICAgIHJzcmMs\nIFN0cmluZy52YWx1ZU9mKG5hbWUpKS5nZXRNZXNzYWdlKCksIGdldENsYXNz\nKCkuZ2V0TmFtZSgpLCByc3JjKTsKICAgICAgICB9IGVsc2UgaWYgKCFpc09w\nZW5KUEFQZXJzaXN0ZW5jZVByb3ZpZGVyKHBpbmZvLCBsb2FkZXIpKSB7CiAg\nICAgICAgICAgIGlmICghZXhwbGljaXQpIHsKICAgICAgICAgICAgICAgIHdh\ncm5Vbmtub3duUHJvdmlkZXIocGluZm8pOwogICAgICAgICAgICAgICAgcmV0\ndXJuIEJvb2xlYW4uRkFMU0U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ndGhyb3cgbmV3IE1pc3NpbmdSZXNvdXJjZUV4Y2VwdGlvbihfbG9jLmdldCgi\ndW5rbm93bi1wcm92aWRlciIsIAogICAgICAgICAgICAgICAgcnNyYywgbmFt\nZSwgcGluZm8uZ2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpKS4K\nICAgICAgICAgICAgICAgIGdldE1lc3NhZ2UoKSwgZ2V0Q2xhc3MoKS5nZXRO\nYW1lKCksIHJzcmMpOwogICAgICAgIH0KICAgICAgICBjcC5hZGRQcm9wZXJ0\naWVzKHBpbmZvLnRvT3BlbkpQQVByb3BlcnRpZXMoKSk7CiAgICAgICAgY3Au\nc2V0U291cmNlKHBpbmZvLmdldFBlcnNpc3RlbmNlWG1sRmlsZVVybCgpLnRv\nU3RyaW5nKCkpOwogICAgICAgIHJldHVybiBCb29sZWFuLlRSVUU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSByZXNvdXJjZXMgYXQgdGhlIGdpdmVu\nIGxvY2F0aW9uLiBTZWFyY2hlcyBmb3IgYQogICAgICogUGVyc2lzdGVuY2VV\nbml0SW5mbyB3aXRoIHRoZSByZXF1ZXN0ZWQgbmFtZSwgb3IgYW4gT3BlbkpQ\nQSB1bml0IGlmCiAgICAgKiBubyBuYW1lIGdpdmVuIChwcmVmZXJyaW5nIGFu\nIHVubmFtZWQgT3BlbkpQQSB1bml0IHRvIGEgbmFtZWQgb25lKS4KICAgICAq\nLwogICAgcHJpdmF0ZSBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBwYXJzZVJl\nc291cmNlcyhDb25maWd1cmF0aW9uUGFyc2VyIHBhcnNlciwKICAgICAgICBM\naXN0PFVSTD4gdXJscywgU3RyaW5nIG5hbWUsIENsYXNzTG9hZGVyIGxvYWRl\ncikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIExpc3Q8\nUGVyc2lzdGVuY2VVbml0SW5mb0ltcGw+IHBpbmZvcyA9IG5ldyBBcnJheUxp\nc3Q8UGVyc2lzdGVuY2VVbml0SW5mb0ltcGw+KCk7CiAgICAgICAgZm9yIChV\nUkwgdXJsIDogdXJscykgewogICAgICAgICAgICBwYXJzZXIucGFyc2UodXJs\nKTsKICAgICAgICAgICAgcGluZm9zLmFkZEFsbCgoTGlzdDxQZXJzaXN0ZW5j\nZVVuaXRJbmZvSW1wbD4pIHBhcnNlci5nZXRSZXN1bHRzKCkpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gZmluZFVuaXQocGluZm9zLCBuYW1lLCBsb2Fk\nZXIpOwogICAgfQoKICAgIC8qKgogICAgICogRmluZCB0aGUgdW5pdCB3aXRo\nIHRoZSBnaXZlbiBuYW1lLCBvciBhbiBPcGVuSlBBIHVuaXQgaWYgbm8gbmFt\nZSBpcwogICAgICogZ2l2ZW4gKHByZWZlcnJpbmcgYW4gdW5uYW1lZCBPcGVu\nSlBBIHVuaXQgdG8gYSBuYW1lZCBvbmUpLgogICAgICovCiAgICBwcml2YXRl\nIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsIGZpbmRVbml0KExpc3Q8UGVyc2lz\ndGVuY2VVbml0SW5mb0ltcGw+IAogICAgICAgIHBpbmZvcywgU3RyaW5nIG5h\nbWUsIENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIFBlcnNpc3RlbmNl\nVW5pdEluZm9JbXBsIG9qcGEgPSBudWxsOwogICAgICAgIFBlcnNpc3RlbmNl\nVW5pdEluZm9JbXBsIHJlc3VsdCA9IG51bGw7CiAgICAgICAgZm9yIChQZXJz\naXN0ZW5jZVVuaXRJbmZvSW1wbCBwaW5mbyA6IHBpbmZvcykgewogICAgICAg\nICAgICAvLyBmb3VuZCBuYW1lZCB1bml0PwogICAgICAgICAgICBpZiAobmFt\nZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBpZiAobmFtZS5lcXVhbHMo\ncGluZm8uZ2V0UGVyc2lzdGVuY2VVbml0TmFtZSgpKSl7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsKXsKICAgICAgICAgICAgICAg\nICAgICAgICAgdGhpcy5hZGRQdU5hbWVDb2xsaXNpb24obmFtZSwgcmVzdWx0\nLmdldFBlcnNpc3RlbmNlWG1sRmlsZVVybCgpLnRvU3RyaW5nKCksCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcGluZm8uZ2V0UGVyc2lzdGVu\nY2VYbWxGaWxlVXJsKCkudG9TdHJpbmcoKSk7CgogICAgICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdyYWIg\nYSByZWYgdG8gdGhlIHBpbmZvIHRoYXQgbWF0Y2hlcyB0aGUgbmFtZSB3ZSdy\nZQogICAgICAgICAgICAgICAgICAgICAgICAvLyBsb29raW5nIGZvci4gS2Vl\ncCBnb2luZyB0byBsb29rIGZvciBkdXBsaWNhdGUgcHUgbmFtZXMuCiAgICAg\nICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHBpbmZvOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoaXNP\ncGVuSlBBUGVyc2lzdGVuY2VQcm92aWRlcihwaW5mbywgbG9hZGVyKSkgewog\nICAgICAgICAgICAgICAgLy8gaWYgbm8gbmFtZSBnaXZlbiBhbmQgZm91bmQg\ndW5uYW1lZCB1bml0LCByZXR1cm4gaXQuICAKICAgICAgICAgICAgICAgIC8v\nIG90aGVyd2lzZSByZWNvcmQgYXMgZGVmYXVsdCB1bml0IHVubGVzcyB3ZSBm\naW5kIGEgYmV0dGVyIG1hdGNoIGxhdGVyCiAgICAgICAgICAgICAgICBpZiAo\nU3RyaW5nVXRpbHMuaXNFbXB0eShwaW5mby5nZXRQZXJzaXN0ZW5jZVVuaXRO\nYW1lKCkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwaW5mbzsKICAg\nICAgICAgICAgICAgIGlmIChvanBhID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgb2pwYSA9IHBpbmZvOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIGlmKHJlc3VsdCE9bnVsbCl7CiAgICAgICAgICAgIHJldHVybiBy\nZXN1bHQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBvanBhOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVuIHBlcnNp\nc3RlbmNlIHVuaXQgdXNlcyBhbiBPcGVuSlBBIHByb3ZpZGVyLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGlzT3BlbkpQQVBlcnNpc3Rl\nbmNlUHJvdmlkZXIoUGVyc2lzdGVuY2VVbml0SW5mbyBwaW5mbywgQ2xhc3NM\nb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgU3RyaW5nIHByb3ZpZGVyID0gcGlu\nZm8uZ2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpOwogICAgICAg\nIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHByb3ZpZGVyKSB8fCBQZXJzaXN0\nZW5jZVByb3ZpZGVySW1wbC5jbGFzcy5nZXROYW1lKCkuZXF1YWxzKHByb3Zp\nZGVyKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIGlmIChs\nb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9hZGVyID0gQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIuZ2V0Q29udGV4\ndENsYXNzTG9hZGVyQWN0aW9uKCkpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGlmIChQZXJzaXN0ZW5jZVByb3ZpZGVySW1wbC5jbGFzcy5pc0Fzc2ln\nbmFibGVGcm9tKENsYXNzLmZvck5hbWUocHJvdmlkZXIsIGZhbHNlLCBsb2Fk\nZXIpKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0g\nY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgIGxvZyhfbG9jLmdl\ndCgidW5sb2FkYWJsZS1wcm92aWRlciIsIHByb3ZpZGVyLCB0KS5nZXRNZXNz\nYWdlKCkpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdh\ncm4gdGhlIHVzZXIgdGhhdCB3ZSBjb3VsZCBvbmx5IGZpbmQgYW4gdW5yZWNv\nZ25pemVkIHBlcnNpc3RlbmNlIAogICAgICogcHJvdmlkZXIuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIHZvaWQgd2FyblVua25vd25Qcm92aWRlcihQ\nZXJzaXN0ZW5jZVVuaXRJbmZvIHBpbmZvKSB7CiAgICAgICAgbG9nKF9sb2Mu\nZ2V0KCJ1bnJlY29nbml6ZWQtcHJvdmlkZXIiLCBwaW5mby5nZXRQZXJzaXN0\nZW5jZVByb3ZpZGVyQ2xhc3NOYW1lKCkpLmdldE1lc3NhZ2UoKSk7CiAgICB9\nCiAgICAKICAgIC8qKgogICAgICogTG9nIGEgbWVzc2FnZS4gICAKICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBsb2coU3RyaW5nIG1zZykgewog\nICAgICAgIC8vIGF0IHRoaXMgcG9pbnQgbG9nZ2luZyBpc24ndCBjb25maWd1\ncmVkIHlldAogICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihtc2cpOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBhZGRQdU5hbWVDb2xsaXNpb24oU3RyaW5n\nIHB1TmFtZSwgU3RyaW5nIGZpbGUxLCBTdHJpbmcgZmlsZTIpewogICAgICAg\nIFBVTmFtZUNvbGxpc2lvbiBwdW4gPSBfcHVOYW1lQ29sbGlzaW9ucy5nZXQo\ncHVOYW1lKTsKICAgICAgICBpZiAocHVuICE9IG51bGwpewogICAgICAgICAg\nICBwdW4uYWRkQ29sbGlzaW9uKGZpbGUxLCBmaWxlMik7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgX3B1TmFtZUNvbGxpc2lvbnMucHV0KHB1TmFt\nZSwgbmV3IFBVTmFtZUNvbGxpc2lvbihwdU5hbWUsIGZpbGUxLCBmaWxlMikp\nOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBDdXN0b20g\nY29uZmlndXJhdGlvbiBwcm92aWRlci4gICAKICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsCiAgICAg\nICAgZXh0ZW5kcyBNYXBDb25maWd1cmF0aW9uUHJvdmlkZXIgewoKICAgICAg\nICBwcml2YXRlIFN0cmluZyBfc291cmNlOwoKICAgICAgICBwdWJsaWMgQ29u\nZmlndXJhdGlvblByb3ZpZGVySW1wbCgpIHsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKE1hcCBwcm9wcykg\newogICAgICAgICAgICBzdXBlcihwcm9wcyk7CiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBTZXQgdGhlIHNvdXJjZSBvZiBpbmZvcm1hdGlv\nbiBpbiB0aGlzIHByb3ZpZGVyLgogICAgICAgICAqLwogICAgICAgIHB1Ymxp\nYyB2b2lkIHNldFNvdXJjZShTdHJpbmcgc291cmNlKSB7CiAgICAgICAgICAg\nIF9zb3VyY2UgPSBzb3VyY2U7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgdm9pZCBzZXRJbnRvKENvbmZpZ3VyYXRpb24g\nY29uZikgewogICAgICAgICAgICBpZiAoY29uZiBpbnN0YW5jZW9mIE9wZW5K\nUEFDb25maWd1cmF0aW9uKSB7CiAgICAgICAgICAgICAgICBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBvY29uZiA9IChPcGVuSlBBQ29uZmlndXJhdGlvbikgY29u\nZjsKICAgICAgICAgICAgICAgIE9iamVjdCBwZXJzaXN0ZW5jZVZlcnNpb24g\nPSBnZXRQcm9wZXJ0aWVzKCkuZ2V0KFBlcnNpc3RlbmNlVW5pdEluZm9JbXBs\nLlBFUlNJU1RFTkNFX1ZFUlNJT04pOwogICAgICAgICAgICAgICAgaWYgKHBl\ncnNpc3RlbmNlVmVyc2lvbiA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgb2NvbmYuc2V0U3BlY2lmaWNhdGlvbihTUEVDX0pQQSk7CiAgICAgICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIFNldCB0\naGUgc3BlYyBsZXZlbCBiYXNlZCBvbiB0aGUgcGVyc2lzdGVuY2UgdmVyc2lv\nbgogICAgICAgICAgICAgICAgICAgIG9jb25mLnNldFNwZWNpZmljYXRpb24o\nImpwYSAiICsgcGVyc2lzdGVuY2VWZXJzaW9uLnRvU3RyaW5nKCkpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAoKICAgICAgICAg\nICAgICAgIC8vIHdlIG1lcmdlIHNldmVyYWwgcGVyc2lzdGVuY2UueG1sIGVs\nZW1lbnRzIGludG8gdGhlIAogICAgICAgICAgICAgICAgLy8gTWV0YURhdGFG\nYWN0b3J5IHByb3BlcnR5IGltcGxpY2l0bHkuICBpZiB0aGUgdXNlciBoYXMg\nYQogICAgICAgICAgICAgICAgLy8gZ2xvYmFsIG9wZW5qcGEueG1sIHdpdGgg\ndGhpcyBwcm9wZXJ0eSBzZXQsIGl0cyB2YWx1ZSB3aWxsCiAgICAgICAgICAg\nICAgICAvLyBnZXQgb3ZlcndyaXR0ZW4gYnkgb3VyIGltcGxpY2l0IHNldHRp\nbmcuICBzbyBpbnN0ZWFkLCBjb21iaW5lCiAgICAgICAgICAgICAgICAvLyB0\naGUgZ2xvYmFsIHZhbHVlIHdpdGggb3VyIHNldHRpbmdzCiAgICAgICAgICAg\nICAgICBTdHJpbmcgb3JpZyA9IG9jb25mLmdldE1ldGFEYXRhRmFjdG9yeSgp\nOwogICAgICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KG9y\naWcpKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGtleSA9IFByb2R1\nY3REZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0aW9uS2V5KCJNZXRhRGF0YUZh\nY3RvcnkiLCBnZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgICAgICAgICAgICAg\nIE9iamVjdCBvdmVycmlkZSA9IGdldFByb3BlcnRpZXMoKS5nZXQoa2V5KTsK\nICAgICAgICAgICAgICAgICAgICBpZiAob3ZlcnJpZGUgaW5zdGFuY2VvZiBT\ndHJpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFByb3BlcnR5KGtl\neSwgQ29uZmlndXJhdGlvbnMuY29tYmluZVBsdWdpbnMob3JpZywgKFN0cmlu\nZykgb3ZlcnJpZGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgc3VwZXIuc2V0SW50byhjb25mLCBudWxsKTsKICAg\nICAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0Q29uZmlndXJhdGlvbkxvZygp\nOwogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAg\nICAgICAgICAgICAgIFN0cmluZyBzcmMgPSAoX3NvdXJjZSA9PSBudWxsKSA/\nICI/IiA6IF9zb3VyY2U7CiAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xv\nYy5nZXQoImNvbmYtbG9hZCIsIHNyYywgZ2V0UHJvcGVydGllcygpKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nQVggaGFuZGxlciBjYXBhYmxlIG9mIHBhcnNpbmcgYW4gSlBBIHBlcnNpc3Rl\nbmNlLnhtbCBmaWxlLgogICAgICogUGFja2FnZS1wcm90ZWN0ZWQgZm9yIHRl\nc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ29uZmln\ndXJhdGlvblBhcnNlcgogICAgICAgIGV4dGVuZHMgWE1MTWV0YURhdGFQYXJz\nZXIgewoKICAgICAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUEVS\nU0lTVEVOQ0VfWFNEXzFfMCA9ICJwZXJzaXN0ZW5jZV8xXzAueHNkIjsKICAg\nICAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUEVSU0lTVEVOQ0Vf\nWFNEXzJfMCA9ICJwZXJzaXN0ZW5jZV8yXzAueHNkIjsKCiAgICAgICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZQogICAgICAgICAgICAoQ29uZmlndXJhdGlvblBhcnNlci5j\nbGFzcyk7CgogICAgICAgIHByaXZhdGUgZmluYWwgTWFwIF9tYXA7CiAgICAg\nICAgcHJpdmF0ZSBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBfaW5mbyA9IG51\nbGw7CiAgICAgICAgcHJpdmF0ZSBVUkwgX3NvdXJjZSA9IG51bGw7CiAgICAg\nICAgcHJpdmF0ZSBTdHJpbmcgX3BlcnNpc3RlbmNlVmVyc2lvbjsKICAgICAg\nICBwcml2YXRlIFN0cmluZyBfc2NoZW1hTG9jYXRpb247CiAgICAgICAgcHJp\ndmF0ZSBib29sZWFuIF9leGNsdWRlVW5saXN0ZWRTZXQgPSBmYWxzZTsKCiAg\nICAgICAgcHVibGljIENvbmZpZ3VyYXRpb25QYXJzZXIoTWFwIG1hcCkgewog\nICAgICAgICAgICBfbWFwID0gbWFwOwogICAgICAgICAgICBzZXRDYWNoaW5n\nKGZhbHNlKTsKICAgICAgICAgICAgc2V0VmFsaWRhdGluZyh0cnVlKTsKICAg\nICAgICAgICAgc2V0UGFyc2VUZXh0KHRydWUpOwogICAgICAgIH0KCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcGFyc2UoVVJMIHVy\nbCkKICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgX3NvdXJjZSA9IHVybDsKCiAgICAgICAgICAgIC8vIHBlZWsgYXQgdGhl\nIGRvYyB0byBkZXRlcm1pbmUgdGhlIHZlcnNpb24KICAgICAgICAgICAgWE1M\nVmVyc2lvblBhcnNlciB2cCA9IG5ldyBYTUxWZXJzaW9uUGFyc2VyKCJwZXJz\naXN0ZW5jZSIpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\ndnAucGFyc2UodXJsKTsKICAgICAgICAgICAgICAgIF9wZXJzaXN0ZW5jZVZl\ncnNpb24gPSB2cC5nZXRWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICBfc2No\nZW1hTG9jYXRpb24gPSB2cC5nZXRTY2hlbWFMb2NhdGlvbigpOwogICAgICAg\nICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAgICAg\nICAgIGxvZyhfbG9jLmdldCgidmVyc2lvbi1jaGVjay1lcnJvciIsIAogICAg\nICAgICAgICAgICAgICAgICAgICBfc291cmNlLnRvU3RyaW5nKCkpLnRvU3Ry\naW5nKCkpOwogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgICAg\nIHN1cGVyLnBhcnNlKHVybCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgdm9pZCBwYXJzZShGaWxlIGZpbGUpCiAgICAg\nICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBfc291cmNlID0gQWNjZXNzQ29udHJvbGxlci5k\nb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgICAg\nICAudG9VUkxBY3Rpb24oZmlsZSkpOwogICAgICAgICAgICB9IGNhdGNoIChQ\ncml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgKE1hbGZvcm1lZFVSTEV4Y2VwdGlvbikgcGFlLmdldEV4Y2Vw\ndGlvbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHBlZWsgYXQg\ndGhlIGRvYyB0byBkZXRlcm1pbmUgdGhlIHZlcnNpb24KICAgICAgICAgICAg\nWE1MVmVyc2lvblBhcnNlciB2cCA9IG5ldyBYTUxWZXJzaW9uUGFyc2VyKCJw\nZXJzaXN0ZW5jZSIpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgdnAucGFyc2UoZmlsZSk7CiAgICAgICAgICAgICAgICBfcGVyc2lzdGVu\nY2VWZXJzaW9uID0gdnAuZ2V0VmVyc2lvbigpOwogICAgICAgICAgICAgICAg\nX3NjaGVtYUxvY2F0aW9uID0gdnAuZ2V0U2NoZW1hTG9jYXRpb24oKTsgICAg\nICAgICAgICAgICAgCiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nKF9sb2MuZ2V0KCJ2ZXJzaW9u\nLWNoZWNrLWVycm9yIiwgCiAgICAgICAgICAgICAgICAgICAgICAgIF9zb3Vy\nY2UudG9TdHJpbmcoKSkudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0gICAg\nICAgICAgICAKICAgICAgICAgICAgc3VwZXIucGFyc2UoZmlsZSk7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IGdldFNjaGVtYVNvdXJjZSgpIHsKICAgICAgICAgICAgLy8gdXNlIHRo\nZSB2ZXJzaW9uIDEgc2NoZW1hIGJ5IGRlZmF1bHQuICBub24tdmVyc2lvbmVk\nIGRvY3Mgd2lsbCAKICAgICAgICAgICAgLy8gY29udGludWUgdG8gcGFyc2Ug\nd2l0aCB0aGUgb2xkIHhtbCBpZiB0aGV5IGRvIG5vdCBjb250YWluIGEgCiAg\nICAgICAgICAgIC8vIHBlcnNpc3RlbmNlLXVuaXQuICB0aGF0IGlzIGN1cnJl\nbnRseSB0aGUgb25seSBzaWduaWZpY2FudCBjaGFuZ2UKICAgICAgICAgICAg\nLy8gdG8gdGhlIHNjaGVtYS4gIGlmIG1vcmUgc2lnbmlmaWNhbnQgY2hhbmdl\ncyBhcmUgbWFkZSBpbiB0aGUgCiAgICAgICAgICAgIC8vIGZ1dHVyZSwgdGhl\nIDIuMCBzY2hlbWEgbWF5IGJlIHByZWZlcmFibGUuCiAgICAgICAgICAgIFN0\ncmluZyBwZXJzaXN0ZW5jZXhzZCA9ICJwZXJzaXN0ZW5jZS14c2QucnNyYyI7\nCiAgICAgICAgICAgIC8vIGlmIHRoZSB2ZXJzaW9uIGFuZC9vciBzY2hlbWEg\nbG9jYXRpb24gaXMgZm9yIDEuMCwgdXNlIHRoZSAxLjAgCiAgICAgICAgICAg\nIC8vIHNjaGVtYQogICAgICAgICAgICBpZiAoX3BlcnNpc3RlbmNlVmVyc2lv\nbiAhPSBudWxsICYmIF9wZXJzaXN0ZW5jZVZlcnNpb24uZXF1YWxzKFhNTFZl\ncnNpb25QYXJzZXIuVkVSU0lPTl8yXzApIAogICAgICAgICAgICB8fCAoX3Nj\naGVtYUxvY2F0aW9uICE9IG51bGwgJiYgX3NjaGVtYUxvY2F0aW9uLmluZGV4\nT2YoUEVSU0lTVEVOQ0VfWFNEXzJfMCkgIT0gLTEpKSB7CiAgICAgICAgICAg\nICAgICBwZXJzaXN0ZW5jZXhzZCA9ICJwZXJzaXN0ZW5jZV8yXzAteHNkLnJz\ncmMiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBnZXRDbGFz\ncygpLmdldFJlc291cmNlQXNTdHJlYW0ocGVyc2lzdGVuY2V4c2QpOwogICAg\nICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHJvdGVjdGVkIHZv\naWQgcmVzZXQoKSB7CiAgICAgICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAg\nICAgICAgIF9pbmZvID0gbnVsbDsKICAgICAgICAgICAgX3NvdXJjZSA9IG51\nbGw7CiAgICAgICAgICAgIF9leGNsdWRlVW5saXN0ZWRTZXQgPSBmYWxzZTsK\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0RWxl\nbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChjdXJy\nZW50RGVwdGgoKSA9PSAxKQogICAgICAgICAgICAgICAgc3RhcnRQZXJzaXN0\nZW5jZVVuaXQoYXR0cnMpOwogICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50\nRGVwdGgoKSA9PSAzICYmICJwcm9wZXJ0eSIuZXF1YWxzKG5hbWUpKQogICAg\nICAgICAgICAgICAgX2luZm8uc2V0UHJvcGVydHkoYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKSwgYXR0cnMuZ2V0VmFsdWUoInZhbHVlIikpOwogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCB2\nb2lkIGVuZEVsZW1lbnQoU3RyaW5nIG5hbWUpCiAgICAgICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgICAgICBpZiAoY3VycmVudERlcHRo\nKCkgPT0gMSkgewogICAgICAgICAgICAgICAgZW5kUGVyc2lzdGVuY2VVbml0\nKCk7CiAgICAgICAgICAgICAgICBfaW5mby5mcm9tVXNlclByb3BlcnRpZXMo\nX21hcCk7CiAgICAgICAgICAgICAgICBhZGRSZXN1bHQoX2luZm8pOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGlmIChjdXJyZW50RGVwdGgoKSAhPSAy\nKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAgc3dpdGNo\nIChuYW1lLmNoYXJBdCgwKSkgewogICAgICAgICAgICAgICAgLy8gY2FzZXMg\nJ25hbWUnIGFuZCAndHJhbnNhY3Rpb24tdHlwZScgYXJlIGhhbmRsZWQgaW4K\nICAgICAgICAgICAgICAgIC8vICAgICAgc3RhcnRQZXJzaXN0ZW5jZVVuaXQo\nKQogICAgICAgICAgICAgICAgLy8gY2FzZSAncHJvcGVydHknIGZvciAncHJv\ncGVydGllcycgaXMgaGFuZGxlZCBpbiBzdGFydEVsZW1lbnQoKQogICAgICAg\nICAgICAgICAgY2FzZSAnYyc6IC8vIGNsYXNzCiAgICAgICAgICAgICAgICAg\nICAgX2luZm8uYWRkTWFuYWdlZENsYXNzTmFtZShjdXJyZW50VGV4dCgpKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgJ2UnOiAvLyBleGNsdWRlLXVubGlzdGVkLWNsYXNzZXMKICAgICAgICAg\nICAgICAgICAgICBzZXRFeGNsdWRlVW5saXN0ZWRDbGFzc2VzKGN1cnJlbnRU\nZXh0KCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSAnaic6CiAgICAgICAgICAgICAgICAgICAgaWYgKCJqdGEt\nZGF0YS1zb3VyY2UiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgX2luZm8uc2V0SnRhRGF0YVNvdXJjZU5hbWUoY3VycmVudFRleHQo\nKSk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7IC8vIGphci1maWxlIAog\nICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgX2luZm8uYWRkSmFyRmlsZU5hbWUoY3VycmVudFRleHQo\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbiBpYWUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihpYWUuZ2V0TWVzc2FnZSgpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgJ20nOiAvLyBtYXBwaW5nLWZpbGUKICAgICAgICAgICAgICAgICAg\nICBfaW5mby5hZGRNYXBwaW5nRmlsZU5hbWUoY3VycmVudFRleHQoKSk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nICduJzogLy8gbm9uLWp0YS1kYXRhLXNvdXJjZQogICAgICAgICAgICAgICAg\nICAgIF9pbmZvLnNldE5vbkp0YURhdGFTb3VyY2VOYW1lKGN1cnJlbnRUZXh0\nKCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSAncCc6CiAgICAgICAgICAgICAgICAgICAgaWYgKCJwcm92aWRl\nciIuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICBfaW5m\nby5zZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NOYW1lKGN1cnJlbnRUZXh0\nKCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSAncycgOiAvLyBzaGFyZWQtY2FjaGUtbW9kZQogICAgICAgICAg\nICAgICAgICAgIF9pbmZvLnNldFNoYXJlZENhY2hlTW9kZShKUEFQcm9wZXJ0\naWVzLmdldEVudW1WYWx1ZShTaGFyZWRDYWNoZU1vZGUuY2xhc3MsIGN1cnJl\nbnRUZXh0KCkpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgJ3YnOiAvLyB2YWxpZGF0aW9uLW1vZGUKICAgICAg\nICAgICAgICAgICAgICBfaW5mby5zZXRWYWxpZGF0aW9uTW9kZShKUEFQcm9w\nZXJ0aWVzLmdldEVudW1WYWx1ZShWYWxpZGF0aW9uTW9kZS5jbGFzcywgY3Vy\ncmVudFRleHQoKSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBUaGUgZGVmYXVsdCB2\nYWx1ZSBmb3IgZXhjbHVkZS11bmxpc3RlZC1jbGFzc2VzIHdhcyAKICAgICAg\nICAvLyBtb2RpZmllZCBpbiBKUEEgMi4wIGZyb20gZmFsc2UgdG8gdHJ1ZS4g\nIFNldCB0aGUgZGVmYXVsdAogICAgICAgIC8vIGJhc2VkIHVwb24gdGhlIHBl\ncnNpc3RlbmNlIHZlcnNpb24gdG8gcHJlc2VydmUgYmVoYXZpb3IgCiAgICAg\nICAgLy8gb2YgcHJlLUpQQSAyLjAgYXBwbGljYXRpb25zLgogICAgICAgIHBy\naXZhdGUgdm9pZCBzZXRFeGNsdWRlVW5saXN0ZWRDbGFzc2VzKFN0cmluZyB2\nYWx1ZSkgewogICAgICAgICAgICBpZiAoIV9leGNsdWRlVW5saXN0ZWRTZXQp\nIHsKICAgICAgICAgICAgICAgIEJpZ0RlY2ltYWwgdmVyc2lvbiA9IGdldFBl\ncnNpc3RlbmNlVmVyc2lvbigpOwogICAgICAgICAgICAgICAgYm9vbGVhbiBl\neGNsdWRlVW5saXN0ZWQ7CiAgICAgICAgICAgICAgICBpZiAodmVyc2lvbi5j\nb21wYXJlVG8oVkVSU0lPTl8xXzApID4gMCkgewogICAgICAgICAgICAgICAg\nICAgIGV4Y2x1ZGVVbmxpc3RlZCA9ICEoImZhbHNlIi5lcXVhbHNJZ25vcmVD\nYXNlKHZhbHVlKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgICAgIGV4Y2x1ZGVVbmxpc3RlZCA9ICJ0cnVlIi5lcXVhbHNJ\nZ25vcmVDYXNlKHZhbHVlKTsKICAgICAgICAgICAgICAgIH0gICAgICAgICAg\nICAgICAgICAgIAogICAgICAgICAgICAgICAgX2luZm8uc2V0RXhjbHVkZVVu\nbGlzdGVkQ2xhc3NlcyhleGNsdWRlVW5saXN0ZWQpOwogICAgICAgICAgICAg\nICAgX2V4Y2x1ZGVVbmxpc3RlZFNldCA9IHRydWU7ICAgICAgICAgICAgCiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIFBhcnNlIHBlcnNpc3RlbmNlLXVuaXQgZWxlbWVudC4KICAgICAgICAgKi8K\nICAgICAgICBwcml2YXRlIHZvaWQgc3RhcnRQZXJzaXN0ZW5jZVVuaXQoQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIF9leGNsdWRlVW5saXN0ZWRTZXQgPSBmYWxzZTsg\nICAgICAgICAgICAKICAgICAgICAgICAgX2luZm8gPSBuZXcgUGVyc2lzdGVu\nY2VVbml0SW5mb0ltcGwoKTsKICAgICAgICAgICAgX2luZm8uc2V0UGVyc2lz\ndGVuY2VVbml0TmFtZShhdHRycy5nZXRWYWx1ZSgibmFtZSIpKTsKICAgICAg\nICAgICAgX2luZm8uc2V0UGVyc2lzdGVuY2VYTUxTY2hlbWFWZXJzaW9uKF9w\nZXJzaXN0ZW5jZVZlcnNpb24pOwogICAgICAgICAgICAKICAgICAgICAgICAg\nLy8gd2Ugb25seSBwYXJzZSB0aGlzIG91cnNlbHZlcyBvdXRzaWRlIGEgY29u\ndGFpbmVyLCBzbyBkZWZhdWx0CiAgICAgICAgICAgIC8vIHRyYW5zYWN0aW9u\nIHR5cGUgdG8gbG9jYWwKICAgICAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJ0cmFuc2FjdGlvbi10eXBlIik7CiAgICAgICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9pbmZvLnNldFRyYW5z\nYWN0aW9uVHlwZShQZXJzaXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGUuUkVT\nT1VSQ0VfTE9DQUwpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICBfaW5mby5zZXRUcmFuc2FjdGlvblR5cGUoRW51bS52YWx1ZU9mKFBlcnNp\nc3RlbmNlVW5pdFRyYW5zYWN0aW9uVHlwZS5jbGFzcywgdmFsKSk7CgogICAg\nICAgICAgICBpZiAoX3NvdXJjZSAhPSBudWxsKQogICAgICAgICAgICAgICAg\nX2luZm8uc2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJsKF9zb3VyY2UpOwoJCX0K\nICAgICAgICAKICAgICAgICBwcml2YXRlIHZvaWQgZW5kUGVyc2lzdGVuY2VV\nbml0KCkgewogICAgICAgICAgICBpZiAoIV9leGNsdWRlVW5saXN0ZWRTZXQp\nIHsKICAgICAgICAgICAgICAgIHNldEV4Y2x1ZGVVbmxpc3RlZENsYXNzZXMo\nbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZh\ndGUgQmlnRGVjaW1hbCBnZXRQZXJzaXN0ZW5jZVZlcnNpb24oKSB7CiAgICAg\nICAgICAgIGlmIChfaW5mby5nZXRQZXJzaXN0ZW5jZVhNTFNjaGVtYVZlcnNp\nb24oKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgQmlnRGVjaW1hbChfaW5mby5nZXRQ\nZXJzaXN0ZW5jZVhNTFNjaGVtYVZlcnNpb24oKSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAg\nICAgICAgICAgICAgICAgICBsb2coX2xvYy5nZXQoImludmFsaWQtdmVyc2lv\nbi1hdHRyaWJ1dGUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgX2luZm8u\nZ2V0UGVyc2lzdGVuY2VYTUxTY2hlbWFWZXJzaW9uKCksCiAgICAgICAgICAg\nICAgICAgICAgICAgIFZFUlNJT05fMV8wLnRvU3RyaW5nKCkpLnRvU3RyaW5n\nKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nICAgIC8vIE9wZW5KUEEgc3VwcG9ydHMgcGVyc2lzdGVuY2UgZmlsZXMgd2l0\naG91dCBhIHZlcnNpb24gYXR0cmlidXRlLgogICAgICAgICAgICAvLyBBIHBl\ncnNpc3RlbmNlIGZpbGUgd2l0aG91dCBhIHZlcnNpb24gYXR0cmlidXRlIHdp\nbGwgYmUgY29uc2lkZXJlZAogICAgICAgICAgICAvLyBhIHZlcnNpb24gMS4w\nIHBlcnNpc3RlbmNlIGZpbGUgYnkgZGVmYXVsdCB0byBtYWludGFpbiBiYWNr\nd2FyZCAKICAgICAgICAgICAgLy8gY29tcGF0aWJpbGl0eS4KICAgICAgICAg\nICAgcmV0dXJuIFZFUlNJT05fMV8wOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgCiAgICAvKioKICAgICAqIFRoaXMgcHJpdmF0ZSBjbGFzcyBpcyB1c2Vk\nIHRvIGhvbGQgb250byBpbmZvcm1hdGlvbiByZWdhcmRpbmcKICAgICAqIFBl\ncnNpc3RlbnRVbml0IG5hbWUgY29sbGlzaW9ucy4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgY2xhc3MgUFVOYW1lQ29sbGlzaW9uewogICAgICAgIHBy\naXZhdGUgU3RyaW5nIF9wdU5hbWU7CiAgICAgICAgcHJpdmF0ZSBTZXQ8U3Ry\naW5nPiBfcmVzb3VyY2VzOwoKICAgICAgICBQVU5hbWVDb2xsaXNpb24oU3Ry\naW5nIHB1TmFtZSwgU3RyaW5nIGZpbGUxLCBTdHJpbmcgZmlsZTIpIHsKICAg\nICAgICAgICAgX3Jlc291cmNlcyA9IG5ldyBMaW5rZWRIYXNoU2V0PFN0cmlu\nZz4oKTsKICAgICAgICAgICAgX3Jlc291cmNlcy5hZGQoZmlsZTEpOwogICAg\nICAgICAgICBfcmVzb3VyY2VzLmFkZChmaWxlMik7CgogICAgICAgICAgICBf\ncHVOYW1lPXB1TmFtZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdm9p\nZCBsb2dDb2xsaXNpb24oTG9nIGxvZ2dlcil7CiAgICAgICAgICAgIGlmKGxv\nZ2dlci5pc1dhcm5FbmFibGVkKCkpewogICAgICAgICAgICAgICAgbG9nZ2Vy\nLndhcm4oX2xvYy5nZXRGYXRhbCgiZHVwLXB1IiwgbmV3IE9iamVjdFtde19w\ndU5hbWUsX3Jlc291cmNlcy50b1N0cmluZygpLAkKICAgICAgICAgICAgICAg\nICAgICBfcmVzb3VyY2VzLml0ZXJhdG9yKCkubmV4dCgpfSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZvaWQgYWRkQ29s\nbGlzaW9uKFN0cmluZyBmaWxlMSwgU3RyaW5nIGZpbGUyKXsKICAgICAgICAg\nICAgX3Jlc291cmNlcy5hZGQoZmlsZTEpOwogICAgICAgICAgICBfcmVzb3Vy\nY2VzLmFkZChmaWxlMik7CiAgICAgICAgfQoKICAgIH0KfQo=\n","encoding":"base64"}

