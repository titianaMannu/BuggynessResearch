{"sha":"ee1fd6af328f5ded8810d187f0362508f518d9de","node_id":"MDQ6QmxvYjIwNjM2NDplZTFmZDZhZjMyOGY1ZGVkODgxMGQxODdmMDM2MjUwOGY1MThkOWRl","size":19043,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ee1fd6af328f5ded8810d187f0362508f518d9de","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5uZXQuTWFsZm9ybWVkVVJM\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJJU3ludGF4RXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS5uZXQuVVJMRGVj\nb2RlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsK\naW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlByb3Bl\ncnRpZXM7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLlNoYXJlZENhY2hlTW9kZTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlZhbGlkYXRpb25Nb2RlOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2Uuc3BpLkNsYXNzVHJhbnNmb3JtZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5zcGkuUGVyc2lzdGVuY2VVbml0SW5mbzsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLnNwaS5QZXJzaXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGU7\nCmltcG9ydCBqYXZheC5zcWwuRGF0YVNvdXJjZTsKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNoZU1vZGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9u\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Qcm9kdWN0\nRGVyaXZhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1l\ndGEuU291cmNlVHJhY2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTXVsdGlDbGFzc0xvYWRlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLkNsYXNzUmVzb2x2ZXI7CgovKioKICogSW1w\nbGVtZW50YXRpb24gb2YgdGhlIHtAbGluayBQZXJzaXN0ZW5jZVVuaXRJbmZv\nfSBpbnRlcmZhY2UgdXNlZCBieSBPcGVuSlBBIAogKiB3aGVuIHBhcnNpbmcg\ncGVyc2lzdGVuY2UgY29uZmlndXJhdGlvbiBpbmZvcm1hdGlvbi4KICoKICog\nQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNlVW5pdElu\nZm9JbXBsCiAgICBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlVW5pdEluZm8sIFNv\ndXJjZVRyYWNrZXIgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n\nIFBFUlNJU1RFTkNFX1ZFUlNJT04gPSAiUGVyc2lzdGVuY2VWZXJzaW9uIjsK\nICAgIAogICAgLyoqCiAgICAgKiBQcm9wZXJ0aWVzIGtleSBmb3IgdGhlIFNI\nQVJFRF9DQUNIRV9NT0RFLiBUaGUgSlBBIDIuMCBzcGVjCiAgICAgKiBTaGFy\nZWRDYWNoZU1vZGUgbWFwcyB0byBPcGVuSlBBJ3MgRGF0YUNhY2hlTW9kZSBz\nbyB3ZSdyZSB1c2luZyB0aGF0CiAgICAgKiBjbGFzcycgc2ltcGxlIG5hbWUg\nYXMgdGhlIHByb3BlcnR5IGtleS4KICAgICAqLwovLyAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBTSEFSRURfQ0FDSEVfTU9ERT1EYXRhQ2FjaGVN\nb2RlLmNsYXNzLmdldFNpbXBsZU5hbWUoKTsgIAoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIExvY2FsaXplciBzX2xvYyA9IExvY2FsaXplci5mb3JQYWNr\nYWdlCiAgICAgICAgKFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsLmNsYXNzKTsK\nCiAgICBwcml2YXRlIFN0cmluZyBfbmFtZTsKICAgIHByaXZhdGUgZmluYWwg\nUHJvcGVydGllcyBfcHJvcHMgPSBuZXcgUHJvcGVydGllcygpOwogICAgcHJp\ndmF0ZSBQZXJzaXN0ZW5jZVVuaXRUcmFuc2FjdGlvblR5cGUgX3RyYW5zVHlw\nZSA9CiAgICAgICAgUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlLlJF\nU09VUkNFX0xPQ0FMOwoKICAgIHByaXZhdGUgU3RyaW5nIF9wcm92aWRlckNs\nYXNzTmFtZTsKICAgIHByaXZhdGUgTGlzdDxTdHJpbmc+IF9tYXBwaW5nRmls\nZU5hbWVzOwogICAgcHJpdmF0ZSBMaXN0PFN0cmluZz4gX2VudGl0eUNsYXNz\nTmFtZXM7CiAgICBwcml2YXRlIExpc3Q8VVJMPiBfamFyRmlsZXM7CiAgICBw\ncml2YXRlIFN0cmluZyBfanRhRGF0YVNvdXJjZU5hbWU7CiAgICBwcml2YXRl\nIERhdGFTb3VyY2UgX2p0YURhdGFTb3VyY2U7CiAgICBwcml2YXRlIFN0cmlu\nZyBfbm9uSnRhRGF0YVNvdXJjZU5hbWU7CiAgICBwcml2YXRlIERhdGFTb3Vy\nY2UgX25vbkp0YURhdGFTb3VyY2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX2V4\nY2x1ZGVVbmxpc3RlZDsKICAgIHByaXZhdGUgVVJMIF9wZXJzaXN0ZW5jZVht\nbEZpbGU7CiAgICBwcml2YXRlIFN0cmluZyBfc2NoZW1hVmVyc2lvbiA9ICIx\nLjAiOwogICAgcHJpdmF0ZSBWYWxpZGF0aW9uTW9kZSBfdmFsaWRhdGlvbk1v\nZGU7CiAgICBwcml2YXRlIFNoYXJlZENhY2hlTW9kZSBfc2hhcmVkQ2FjaGVN\nb2RlOwoKICAgIC8vIEEgcGVyc2lzdGVuY2UgdW5pdCBpcyBkZWZpbmVkIGJ5\nIGEgcGVyc2lzdGVuY2UueG1sIGZpbGUuIFRoZSBqYXIKICAgIC8vIGZpbGUg\nb3IgZGlyZWN0b3J5IHdob3NlIE1FVEEtSU5GIGRpcmVjdG9yeSBjb250YWlu\ncyB0aGUKICAgIC8vIHBlcnNpc3RlbmNlLnhtbCBmaWxlIGlzIHRlcm1lZCB0\naGUgcm9vdCBvZiB0aGUgcGVyc2lzdGVuY2UgdW5pdC4KICAgIC8vCiAgICAv\nLyBJbiBKYXZhIEVFLCB0aGUgcm9vdCBvZiBhIHBlcnNpc3RlbmNlIHVuaXQg\nbWF5IGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nOgogICAgLy8gLSBhbiBFSkIt\nSkFSIGZpbGUKICAgIC8vIC0gdGhlIFdFQi1JTkYvY2xhc3NlcyBkaXJlY3Rv\ncnkgb2YgYSBXQVIgZmlsZVszOF0KICAgIC8vIC0gYSBqYXIgZmlsZSBpbiB0\naGUgV0VCLUlORi9saWIgZGlyZWN0b3J5IG9mIGEgV0FSIGZpbGUKICAgIC8v\nIC0gYSBqYXIgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgRUFSCiAgICAvLyAt\nIGEgamFyIGZpbGUgaW4gdGhlIEVBUiBsaWJyYXJ5IGRpcmVjdG9yeQogICAg\nLy8gLSBhbiBhcHBsaWNhdGlvbiBjbGllbnQgamFyIGZpbGUKICAgIHByaXZh\ndGUgVVJMIF9yb290OwoKICAgIHB1YmxpYyBDbGFzc0xvYWRlciBnZXRDbGFz\nc0xvYWRlcigpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBw\ndWJsaWMgQ2xhc3NMb2FkZXIgZ2V0TmV3VGVtcENsYXNzTG9hZGVyKCkgewog\nICAgICAgIHJldHVybiBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChK\nMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAubmV3VGVtcG9yYXJ5Q2xhc3NM\nb2FkZXJBY3Rpb24oQWNjZXNzQ29udHJvbGxlcgogICAgICAgICAgICAgICAg\nLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NM\nb2FkZXJBY3Rpb24oKSkpKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFBlcnNpc3RlbmNlVW5pdE5hbWUoKSB7CiAgICAgICAgcmV0dXJuIF9uYW1l\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBlcnNpc3RlbmNlVW5pdE5h\nbWUoU3RyaW5nIGVtTmFtZSkgewogICAgICAgIF9uYW1lID0gZW1OYW1lOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0UGVyc2lzdGVuY2VQcm92aWRl\nckNsYXNzTmFtZSgpIHsKICAgICAgICByZXR1cm4gX3Byb3ZpZGVyQ2xhc3NO\nYW1lOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBlcnNpc3RlbmNlUHJv\ndmlkZXJDbGFzc05hbWUoU3RyaW5nIHByb3ZpZGVyQ2xhc3NOYW1lKSB7CiAg\nICAgICAgX3Byb3ZpZGVyQ2xhc3NOYW1lID0gcHJvdmlkZXJDbGFzc05hbWU7\nCiAgICB9CgogICAgcHVibGljIFBlcnNpc3RlbmNlVW5pdFRyYW5zYWN0aW9u\nVHlwZSBnZXRUcmFuc2FjdGlvblR5cGUoKSB7CiAgICAgICAgcmV0dXJuIF90\ncmFuc1R5cGU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhbnNhY3Rp\nb25UeXBlKFBlcnNpc3RlbmNlVW5pdFRyYW5zYWN0aW9uVHlwZSB0cmFuc1R5\ncGUpIHsKICAgICAgICBfdHJhbnNUeXBlID0gdHJhbnNUeXBlOwogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0SnRhRGF0YVNvdXJjZU5hbWUoKSB7CiAg\nICAgICAgcmV0dXJuIF9qdGFEYXRhU291cmNlTmFtZTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRKdGFEYXRhU291cmNlTmFtZShTdHJpbmcganRhKSB7\nCiAgICAgICAgX2p0YURhdGFTb3VyY2VOYW1lID0ganRhOwogICAgICAgIGlm\nIChqdGEgIT0gbnVsbCkKICAgICAgICAgICAgX2p0YURhdGFTb3VyY2UgPSBu\ndWxsOwogICAgfQoKICAgIHB1YmxpYyBEYXRhU291cmNlIGdldEp0YURhdGFT\nb3VyY2UoKSB7CiAgICAgICAgcmV0dXJuIF9qdGFEYXRhU291cmNlOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldEp0YURhdGFTb3VyY2UoRGF0YVNvdXJj\nZSBkcykgewogICAgICAgIF9qdGFEYXRhU291cmNlID0gZHM7CiAgICAgICAg\naWYgKGRzICE9IG51bGwpCiAgICAgICAgICAgIF9qdGFEYXRhU291cmNlTmFt\nZSA9IG51bGw7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXROb25KdGFE\nYXRhU291cmNlTmFtZSgpIHsKICAgICAgICByZXR1cm4gX25vbkp0YURhdGFT\nb3VyY2VOYW1lOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldE5vbkp0YURh\ndGFTb3VyY2VOYW1lKFN0cmluZyBub25KdGEpIHsKICAgICAgICBfbm9uSnRh\nRGF0YVNvdXJjZU5hbWUgPSBub25KdGE7CiAgICAgICAgaWYgKG5vbkp0YSAh\nPSBudWxsKQogICAgICAgICAgICBfbm9uSnRhRGF0YVNvdXJjZSA9IG51bGw7\nCiAgICB9CgogICAgcHVibGljIERhdGFTb3VyY2UgZ2V0Tm9uSnRhRGF0YVNv\ndXJjZSgpIHsKICAgICAgICByZXR1cm4gX25vbkp0YURhdGFTb3VyY2U7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0Tm9uSnRhRGF0YVNvdXJjZShEYXRh\nU291cmNlIGRzKSB7CiAgICAgICAgX25vbkp0YURhdGFTb3VyY2UgPSBkczsK\nICAgICAgICBpZiAoZHMgIT0gbnVsbCkKICAgICAgICAgICAgX25vbkp0YURh\ndGFTb3VyY2VOYW1lID0gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgVVJMIGdl\ndFBlcnNpc3RlbmNlVW5pdFJvb3RVcmwoKSB7CiAgICAgICAgcmV0dXJuIF9y\nb290OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBlcnNpc3RlbmNlVW5p\ndFJvb3RVcmwoVVJMIHJvb3QpIHsKICAgICAgICBfcm9vdCA9IHJvb3Q7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gZXhjbHVkZVVubGlzdGVkQ2xhc3Nl\ncygpIHsKICAgICAgICByZXR1cm4gX2V4Y2x1ZGVVbmxpc3RlZDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRFeGNsdWRlVW5saXN0ZWRDbGFzc2VzKGJv\nb2xlYW4gZXhjbHVkZVVubGlzdGVkKSB7CiAgICAgICAgX2V4Y2x1ZGVVbmxp\nc3RlZCA9IGV4Y2x1ZGVVbmxpc3RlZDsKICAgIH0KCiAgICBwdWJsaWMgTGlz\ndDxTdHJpbmc+IGdldE1hcHBpbmdGaWxlTmFtZXMoKSB7CiAgICAgICAgaWYg\nKF9tYXBwaW5nRmlsZU5hbWVzID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBDb2xsZWN0aW9ucy5lbXB0eUxpc3QoKTsKICAgICAgICByZXR1cm4gX21h\ncHBpbmdGaWxlTmFtZXM7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkTWFw\ncGluZ0ZpbGVOYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgaWYgKF9tYXBw\naW5nRmlsZU5hbWVzID09IG51bGwpCiAgICAgICAgICAgIF9tYXBwaW5nRmls\nZU5hbWVzID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7CiAgICAgICAgX21h\ncHBpbmdGaWxlTmFtZXMuYWRkKG5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBM\naXN0PFVSTD4gZ2V0SmFyRmlsZVVybHMoKSB7CiAgICAgICAgaWYgKF9qYXJG\naWxlcyA9PSBudWxsKSAKICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25z\nLmVtcHR5TGlzdCgpOwogICAgICAgIHJldHVybiBfamFyRmlsZXM7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgYWRkSmFyRmlsZShVUkwgamFyKSB7CiAgICAg\nICAgaWYgKF9qYXJGaWxlcyA9PSBudWxsKQogICAgICAgICAgICBfamFyRmls\nZXMgPSBuZXcgQXJyYXlMaXN0PFVSTD4oKTsKICAgICAgICBfamFyRmlsZXMu\nYWRkKGphcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkSmFyRmlsZU5h\nbWUoU3RyaW5nIG5hbWUpIHsKICAgICAgICBNdWx0aUNsYXNzTG9hZGVyIGxv\nYWRlciA9IEFjY2Vzc0NvbnRyb2xsZXIKICAgICAgICAgICAgLmRvUHJpdmls\nZWdlZChKMkRvUHJpdkhlbHBlci5uZXdNdWx0aUNsYXNzTG9hZGVyQWN0aW9u\nKCkpOwogICAgICAgIGxvYWRlci5hZGRDbGFzc0xvYWRlcihnZXRDbGFzcygp\nLmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgIGxvYWRlci5hZGRDbGFzc0xv\nYWRlcihNdWx0aUNsYXNzTG9hZGVyLlRIUkVBRF9MT0FERVIpOwogICAgICAg\nIFVSTCB1cmwgPSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAg\nICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0UmVzb3VyY2VBY3Rpb24obG9h\nZGVyLCBuYW1lKSk7CiAgICAgICAgaWYgKHVybCAhPSBudWxsKSB7CiAgICAg\nICAgICAgIGFkZEphckZpbGUodXJsKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KCiAgICAgICAgLy8gamFyIGZpbGUgaXMgbm90IGEgcmVzb3Vy\nY2U7IGNoZWNrIGNsYXNzcGF0aAogICAgICAgIFN0cmluZ1tdIGNwID0gKEFj\nY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICBKMkRv\nUHJpdkhlbHBlci5nZXRQcm9wZXJ0eUFjdGlvbigiamF2YS5jbGFzcy5wYXRo\nIikpKSAKICAgICAgICAgICAgLnNwbGl0KEoyRG9Qcml2SGVscGVyLmdldFBh\ndGhTZXBhcmF0b3IoKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBj\ncC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoY3BbaV0uZXF1YWxz\nKG5hbWUpCiAgICAgICAgICAgICAgICB8fCBjcFtpXS5lbmRzV2l0aChGaWxl\nLnNlcGFyYXRvckNoYXIgKyBuYW1lKSkgewogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICBhZGRKYXJGaWxlKEFjY2Vzc0NvbnRy\nb2xsZXIKICAgICAgICAgICAgICAgICAgICAgICAgLmRvUHJpdmlsZWdlZChK\nMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRv\nVVJMQWN0aW9uKG5ldyBGaWxlKGNwW2ldKSkpKTsKICAgICAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGNhdGNoIChQcml2aWxl\nZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoTWFsZm9ybWVkVVJM\nRXhjZXB0aW9uIG11ZSkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oc19sb2Mu\nZ2V0KCJiYWQtamFyLW5hbWUiLCBuYW1lKS4KICAgICAgICAgICAgZ2V0TWVz\nc2FnZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgTGlzdDxTdHJpbmc+IGdldE1h\nbmFnZWRDbGFzc05hbWVzKCkgewogICAgICAgIGlmIChfZW50aXR5Q2xhc3NO\nYW1lcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gQ29sbGVjdGlvbnMu\nZW1wdHlMaXN0KCk7CiAgICAgICAgcmV0dXJuIF9lbnRpdHlDbGFzc05hbWVz\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZE1hbmFnZWRDbGFzc05hbWUo\nU3RyaW5nIG5hbWUpIHsKICAgICAgICBpZiAoX2VudGl0eUNsYXNzTmFtZXMg\nPT0gbnVsbCkKICAgICAgICAgICAgX2VudGl0eUNsYXNzTmFtZXMgPSBuZXcg\nQXJyYXlMaXN0PFN0cmluZz4oKTsKICAgICAgICBfZW50aXR5Q2xhc3NOYW1l\ncy5hZGQobmFtZSk7CiAgICB9CgogICAgcHVibGljIFByb3BlcnRpZXMgZ2V0\nUHJvcGVydGllcygpIHsKICAgICAgICByZXR1cm4gX3Byb3BzOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldFByb3BlcnR5KFN0cmluZyBrZXksIFN0cmlu\nZyB2YWx1ZSkgewogICAgICAgIF9wcm9wcy5zZXRQcm9wZXJ0eShrZXksIHZh\nbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFuc2Zvcm1lcihD\nbGFzc1RyYW5zZm9ybWVyIHRyYW5zZm9ybWVyKSB7CiAgICAgICAgdGhyb3cg\nbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbG9jYXRpb24gb2YgdGhlIHBlcnNpc3RlbmNl\nLnhtbCByZXNvdXJjZS4gTWF5IGJlIG51bGwuCiAgICAgKi8KICAgIHB1Ymxp\nYyBVUkwgZ2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJsKCkgewogICAgICAgIHJl\ndHVybiBfcGVyc2lzdGVuY2VYbWxGaWxlOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIGxvY2F0aW9uIG9mIHRoZSBwZXJzaXN0ZW5jZS54bWwgcmVzb3Vy\nY2UuIE1heSBiZSBudWxsLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQ\nZXJzaXN0ZW5jZVhtbEZpbGVVcmwoVVJMIHVybCkgewogICAgICAgIF9wZXJz\naXN0ZW5jZVhtbEZpbGUgPSB1cmw7CiAgICB9CgogICAgLyoqCiAgICAgKiBM\nb2FkIHRoZSBnaXZlbiB1c2VyLXN1cHBsaWVkIG1hcCBvZiBwcm9wZXJ0aWVz\nIGludG8gdGhpcyBwZXJzaXN0ZW5jZQogICAgICogdW5pdC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgZnJvbVVzZXJQcm9wZXJ0aWVzKE1hcCBtYXApIHsK\nICAgICAgICBpZiAobWFwID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgT2JqZWN0IGtleTsKICAgICAgICBPYmplY3QgdmFsOwogICAg\nICAgIGZvciAoT2JqZWN0IG8gOiBtYXAuZW50cnlTZXQoKSkgewogICAgICAg\nICAgICBrZXkgPSAoKE1hcC5FbnRyeSkgbykuZ2V0S2V5KCk7CiAgICAgICAg\nICAgIHZhbCA9ICgoTWFwLkVudHJ5KSBvKS5nZXRWYWx1ZSgpOwogICAgICAg\nICAgICBpZiAoSlBBUHJvcGVydGllcy5QUk9WSURFUi5lcXVhbHMoa2V5KSkK\nICAgICAgICAgICAgICAgIHNldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05h\nbWUoKFN0cmluZykgdmFsKTsKICAgICAgICAgICAgZWxzZSBpZiAoSlBBUHJv\ncGVydGllcy5UUkFOU0FDVElPTl9UWVBFLmVxdWFscyhrZXkpKSB7CiAgICAg\nICAgICAgICAgICBzZXRUcmFuc2FjdGlvblR5cGUoSlBBUHJvcGVydGllcy5n\nZXRFbnVtVmFsdWUoUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlLmNs\nYXNzLCB2YWwpKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChKUEFQcm9wZXJ0\naWVzLkRBVEFTT1VSQ0VfSlRBLmVxdWFscyhrZXkpKSB7CiAgICAgICAgICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAg\nICAgICAgICAgc2V0SnRhRGF0YVNvdXJjZU5hbWUoKFN0cmluZykgdmFsKTsK\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nc2V0SnRhRGF0YVNvdXJjZSgoRGF0YVNvdXJjZSkgdmFsKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChKUEFQcm9wZXJ0aWVz\nLkRBVEFTT1VSQ0VfTk9OSlRBLmVxdWFscyhrZXkpKSB7CiAgICAgICAgICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAg\nICAgICAgICAgc2V0Tm9uSnRhRGF0YVNvdXJjZU5hbWUoKFN0cmluZykgdmFs\nKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg\nICAgc2V0Tm9uSnRhRGF0YVNvdXJjZSgoRGF0YVNvdXJjZSkgdmFsKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChKUEFQcm9w\nZXJ0aWVzLlZBTElEQVRFX01PREUuZXF1YWxzKGtleSkpIHsKICAgICAgICAg\nICAgICAgIHNldFZhbGlkYXRpb25Nb2RlKEpQQVByb3BlcnRpZXMuZ2V0RW51\nbVZhbHVlKFZhbGlkYXRpb25Nb2RlLmNsYXNzLCB2YWwpKTsKICAgICAgICAg\nICAgfSBlbHNlIGlmIChKUEFQcm9wZXJ0aWVzLkNBQ0hFX01PREUuZXF1YWxz\nKGtleSkpIHsgCiAgICAgICAgICAgICAgICBzZXRTaGFyZWRDYWNoZU1vZGUo\nSlBBUHJvcGVydGllcy5nZXRFbnVtVmFsdWUoU2hhcmVkQ2FjaGVNb2RlLmNs\nYXNzLCB2YWwpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgIF9wcm9wcy5wdXQoa2V5LCB2YWwpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5rIE1h\ncH0gY29udGFpbmluZyB0aGUgcHJvcGVydGllcyBuZWNlc3NhcnkgdG8gY3Jl\nYXRlCiAgICAgKiBhIHtAbGluayBDb25maWd1cmF0aW9ufSB0aGF0IHJlZmxl\nY3RzIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGlzCiAgICAgKiBwZXJzaXN0ZW5j\nZSB1bml0IGluZm8uCiAgICAgKi8KICAgIHB1YmxpYyBNYXAgdG9PcGVuSlBB\nUHJvcGVydGllcygpIHsKICAgICAgICByZXR1cm4gdG9PcGVuSlBBUHJvcGVy\ndGllcyh0aGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHtA\nbGluayBNYXB9IGNvbnRhaW5pbmcgdGhlIHByb3BlcnRpZXMgbmVjZXNzYXJ5\nIHRvIGNyZWF0ZQogICAgICogYSB7QGxpbmsgQ29uZmlndXJhdGlvbn0gdGhh\ndCByZWZsZWN0cyB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIGdpdmVuCiAgICAg\nKiBwZXJzaXN0ZW5jZSB1bml0IGluZm8uCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgTWFwIHRvT3BlbkpQQVByb3BlcnRpZXMoUGVyc2lzdGVuY2VVbml0\nSW5mbyBpbmZvKSB7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwPFN0\ncmluZyxPYmplY3Q+KCk7CiAgICAgICAgU2V0PFN0cmluZz4gYWRkZWQgPSBu\nZXcgSGFzaFNldDxTdHJpbmc+KCk7CiAgICAgICAgaWYgKGluZm8uZ2V0VHJh\nbnNhY3Rpb25UeXBlKCkgPT0gUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25U\neXBlLkpUQSkKICAgICAgICAgICAgcmVwbGFjZUFzT3BlbkpQQVByb3BlcnR5\nKG1hcCwgYWRkZWQsICJUcmFuc2FjdGlvbk1vZGUiLCAibWFuYWdlZCIpOwoK\nICAgICAgICBib29sZWFuIGhhc0p0YSA9IGZhbHNlOwogICAgICAgIERhdGFT\nb3VyY2UgZHMgPSBpbmZvLmdldEp0YURhdGFTb3VyY2UoKTsKICAgICAgICBp\nZiAoZHMgIT0gbnVsbCkgewogICAgICAgICAgICByZXBsYWNlQXNPcGVuSlBB\nUHJvcGVydHkobWFwLCBhZGRlZCwgIkNvbm5lY3Rpb25GYWN0b3J5IiwgZHMp\nOwogICAgICAgICAgICByZXBsYWNlQXNPcGVuSlBBUHJvcGVydHkobWFwLCBh\nZGRlZCwgIkNvbm5lY3Rpb25GYWN0b3J5TW9kZSIsICJtYW5hZ2VkIik7CiAg\nICAgICAgICAgIGhhc0p0YSA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlmIChp\nbmZvIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwKICAgICAg\nICAgICAgJiYgKChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCkgaW5mbykuZ2V0\nSnRhRGF0YVNvdXJjZU5hbWUoKSAhPSBudWxsKXsKICAgICAgICAgICAgcmVw\nbGFjZUFzT3BlbkpQQVByb3BlcnR5KG1hcCwgYWRkZWQsICJDb25uZWN0aW9u\nRmFjdG9yeU5hbWUiLCAKICAgICAgICAgICAgICAgICAgICAoKFBlcnNpc3Rl\nbmNlVW5pdEluZm9JbXBsKWluZm8pLmdldEp0YURhdGFTb3VyY2VOYW1lKCkp\nOwogICAgICAgICAgICByZXBsYWNlQXNPcGVuSlBBUHJvcGVydHkobWFwLCBh\nZGRlZCwgIkNvbm5lY3Rpb25GYWN0b3J5TW9kZSIsICJtYW5hZ2VkIik7CiAg\nICAgICAgICAgIGhhc0p0YSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBk\ncyA9IGluZm8uZ2V0Tm9uSnRhRGF0YVNvdXJjZSgpOwogICAgICAgIGlmIChk\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgICByZXBsYWNlQXNPcGVuSlBBUHJv\ncGVydHkobWFwLCBhZGRlZCwgaGFzSnRhID8gIkNvbm5lY3Rpb25GYWN0b3J5\nMiIgOiAiQ29ubmVjdGlvbkZhY3RvcnkiLCBkcyk7CiAgICAgICAgfSBlbHNl\nIGlmIChpbmZvIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwK\nICAgICAgICAgICAgJiYgKChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCkgaW5m\nbykuZ2V0Tm9uSnRhRGF0YVNvdXJjZU5hbWUoKSAhPSBudWxsKSB7CiAgICAg\nICAgICAgIFN0cmluZyBub25KdGFOYW1lID0gKChQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbCkgaW5mbykuZ2V0Tm9uSnRhRGF0YVNvdXJjZU5hbWUoKTsKICAg\nICAgICAgICAgcmVwbGFjZUFzT3BlbkpQQVByb3BlcnR5KG1hcCwgYWRkZWQs\nIGhhc0p0YSA/ICJDb25uZWN0aW9uRmFjdG9yeTJOYW1lIiA6ICJDb25uZWN0\naW9uRmFjdG9yeU5hbWUiLCAKICAgICAgICAgICAgICAgICAgICBub25KdGFO\nYW1lKTsKICAgICAgICB9CgogICAgICAgIGlmIChpbmZvLmdldENsYXNzTG9h\nZGVyKCkgIT0gbnVsbCkKICAgICAgICAgICAgcmVwbGFjZUFzT3BlbkpQQVBy\nb3BlcnR5KG1hcCwgYWRkZWQsICJDbGFzc1Jlc29sdmVyIiwgbmV3IENsYXNz\nUmVzb2x2ZXJJbXBsKGluZm8uZ2V0Q2xhc3NMb2FkZXIoKSkpOwoKICAgICAg\nICBQcm9wZXJ0aWVzIHByb3BzID0gaW5mby5nZXRQcm9wZXJ0aWVzKCk7CiAg\nICAgICAgaWYgKHByb3BzICE9IG51bGwpIHsKICAgICAgICAgICAgLy8gcmVt\nb3ZlIGFueSBvZiB0aGUgdGhpbmdzIHRoYXQgd2VyZSBzZXQgYWJvdmUKICAg\nICAgICAgICAgZm9yIChTdHJpbmcga2V5IDogYWRkZWQpIHsKICAgICAgICAg\nICAgICAgIGlmIChDb25maWd1cmF0aW9ucy5jb250YWluc1Byb3BlcnR5KGtl\neSwgcHJvcHMpKQogICAgICAgICAgICAgICAgICAgIENvbmZpZ3VyYXRpb25z\nLnJlbW92ZVByb3BlcnR5KGtleSwgcHJvcHMpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICAvLyBhZGQgYWxsIHRoZSBub24tY29uZmxpY3RpbmcgcHJv\ncHMgaW4gdGhlIDxwcm9wZXJ0aWVzPiBzZWN0aW9uCiAgICAgICAgICAgIG1h\ncC5wdXRBbGwocHJvcHMpOwoKICAgICAgICAgICAgLy8gdGhpcyBpc24ndCBh\nIHJlYWwgY29uZmlnIHByb3BlcnR5OyByZW1vdmUgaXQKICAgICAgICAgICAg\nbWFwLnJlbW92ZShQZXJzaXN0ZW5jZVByb3ZpZGVySW1wbC5DTEFTU19UUkFO\nU0ZPUk1FUl9PUFRJT05TKTsKICAgICAgICB9CgogICAgICAgIGlmICghQ29u\nZmlndXJhdGlvbnMuY29udGFpbnNQcm9wZXJ0eSgiSWQiLCBtYXApKQogICAg\nICAgICAgICBtYXAucHV0KCJvcGVuanBhLklkIiwgaW5mby5nZXRQZXJzaXN0\nZW5jZVVuaXROYW1lKCkpOwogICAgICAgIAogICAgICAgIFByb3BlcnRpZXMg\nbWV0YUZhY3RvcnlQcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAgICAgICAg\naWYgKGluZm8uZ2V0TWFuYWdlZENsYXNzTmFtZXMoKSAhPSBudWxsIAogICAg\nICAgICAgICAmJiAhaW5mby5nZXRNYW5hZ2VkQ2xhc3NOYW1lcygpLmlzRW1w\ndHkoKSkgewogICAgICAgICAgICBTdHJpbmdCdWlsZGVyIHR5cGVzID0gbmV3\nIFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgZm9yIChTdHJpbmcgdHlw\nZSA6IGluZm8uZ2V0TWFuYWdlZENsYXNzTmFtZXMoKSkgewogICAgICAgICAg\nICAgICAgaWYgKHR5cGVzLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgICAg\nICAgICB0eXBlcy5hcHBlbmQoJzsnKTsKICAgICAgICAgICAgICAgIHR5cGVz\nLmFwcGVuZCh0eXBlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZXRh\nRmFjdG9yeVByb3BzLnB1dCgiVHlwZXMiLCB0eXBlcy50b1N0cmluZygpKTsK\nICAgICAgICB9CiAgICAgICAgaWYgKGluZm8uZ2V0SmFyRmlsZVVybHMoKSAh\nPSBudWxsICYmICFpbmZvLmdldEphckZpbGVVcmxzKCkuaXNFbXB0eSgpCiAg\nICAgICAgICAgIHx8ICghaW5mby5leGNsdWRlVW5saXN0ZWRDbGFzc2VzKCkK\nICAgICAgICAgICAgJiYgaW5mby5nZXRQZXJzaXN0ZW5jZVVuaXRSb290VXJs\nKCkgIT0gbnVsbCkpIHsKICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBqYXJz\nID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgU3RyaW5nIGZp\nbGUgPSBudWxsOwogICAgICAgICAgICBpZiAoIWluZm8uZXhjbHVkZVVubGlz\ndGVkQ2xhc3NlcygpCiAgICAgICAgICAgICAgICAmJiBpbmZvLmdldFBlcnNp\nc3RlbmNlVW5pdFJvb3RVcmwoKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBVUkwgdXJsID0gaW5mby5nZXRQZXJzaXN0ZW5jZVVuaXRSb290VXJsKCk7\nCiAgICAgICAgICAgICAgICBpZiAoImZpbGUiLmVxdWFscyh1cmwuZ2V0UHJv\ndG9jb2woKSkpIC8vIGV4cGxvZGVkIGphcj8KICAgICAgICAgICAgICAgICAg\nICBmaWxlID0gVVJMRGVjb2Rlci5kZWNvZGUodXJsLmdldFBhdGgoKSk7CiAg\nICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgamFycy5h\ncHBlbmQodXJsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKFVS\nTCBqYXIgOiBpbmZvLmdldEphckZpbGVVcmxzKCkpIHsKICAgICAgICAgICAg\nICAgIGlmIChqYXJzLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgICAgICAg\nICBqYXJzLmFwcGVuZCgnOycpOwogICAgICAgICAgICAgICAgamFycy5hcHBl\nbmQoamFyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZmlsZSAh\nPSBudWxsKQogICAgICAgICAgICAgICAgbWV0YUZhY3RvcnlQcm9wcy5wdXQo\nIkZpbGVzIiwgZmlsZSk7CiAgICAgICAgICAgIGlmIChqYXJzLmxlbmd0aCgp\nICE9IDApCiAgICAgICAgICAgICAgICBtZXRhRmFjdG9yeVByb3BzLnB1dCgi\nVVJMcyIsIGphcnMudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgICAgIGlm\nIChpbmZvLmdldE1hcHBpbmdGaWxlTmFtZXMoKSAhPSBudWxsCiAgICAgICAg\nICAgICYmICFpbmZvLmdldE1hcHBpbmdGaWxlTmFtZXMoKS5pc0VtcHR5KCkp\nIHsKICAgICAgICAgICAgU3RyaW5nQnVpbGRlciByc3JjcyA9IG5ldyBTdHJp\nbmdCdWlsZGVyKCk7CiAgICAgICAgICAgIGZvciAoU3RyaW5nIHJzcmMgOiBp\nbmZvLmdldE1hcHBpbmdGaWxlTmFtZXMoKSkgewogICAgICAgICAgICAgICAg\naWYgKHJzcmNzLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgICAgICAgICBy\nc3Jjcy5hcHBlbmQoJzsnKTsKICAgICAgICAgICAgICAgIHJzcmNzLmFwcGVu\nZChyc3JjKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZXRhRmFjdG9y\neVByb3BzLnB1dCgiUmVzb3VyY2VzIiwgcnNyY3MudG9TdHJpbmcoKSk7CiAg\nICAgICAgfQoKICAgICAgICAvLyBzZXQgcGVyc2lzdGVudCBjbGFzcyBsb2Nh\ndGlvbnMgYXMgcHJvcGVydGllcyBvZiBtZXRhZGF0YSBmYWN0b3J5LAogICAg\nICAgIC8vIGNvbWJpbmluZyB0aGVtIHdpdGggYW55IGV4aXN0aW5nIG1ldGFk\nYXRhIGZhY3RvcnkgcHJvcHMKICAgICAgICBpZiAoIW1ldGFGYWN0b3J5UHJv\ncHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXkgPSBQcm9k\ndWN0RGVyaXZhdGlvbnMuZ2V0Q29uZmlndXJhdGlvbktleQogICAgICAgICAg\nICAgICAgKCJNZXRhRGF0YUZhY3RvcnkiLCBtYXApOwogICAgICAgICAgICBt\nYXAucHV0KGtleSwgQ29uZmlndXJhdGlvbnMuY29tYmluZVBsdWdpbnMoKFN0\ncmluZykgbWFwLmdldChrZXkpLAogICAgICAgICAgICAgICAgQ29uZmlndXJh\ndGlvbnMuc2VyaWFsaXplUHJvcGVydGllcyhtZXRhRmFjdG9yeVByb3BzKSkp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBhbHdheXMgcmVjb3Jk\nIHByb3ZpZGVyIG5hbWUgZm9yIHByb2R1Y3QgZGVyaXZhdGlvbnMgdG8gYWNj\nZXNzCiAgICAgICAgaWYgKGluZm8uZ2V0UGVyc2lzdGVuY2VQcm92aWRlckNs\nYXNzTmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIG1hcC5wdXQoSlBBUHJv\ncGVydGllcy5QUk9WSURFUiwgaW5mby5nZXRQZXJzaXN0ZW5jZVByb3ZpZGVy\nQ2xhc3NOYW1lKCkpOwogICAgICAgIAogICAgICAgIC8vIGNvbnZlcnQgdmFs\naWRhdGlvbi1tb2RlIGVudW0gdG8gYSBTdHJpbmdWYWx1ZQogICAgICAgIGlm\nIChpbmZvLmdldFZhbGlkYXRpb25Nb2RlKCkgIT0gbnVsbCkKICAgICAgICAg\nICAgbWFwLnB1dChKUEFQcm9wZXJ0aWVzLlZBTElEQVRFX01PREUsIGluZm8u\nZ2V0VmFsaWRhdGlvbk1vZGUoKSk7CgogICAgICAgIGlmIChpbmZvLmdldFBl\ncnNpc3RlbmNlWE1MU2NoZW1hVmVyc2lvbigpICE9IG51bGwpIHsKICAgICAg\nICAgICAgbWFwLnB1dChQRVJTSVNURU5DRV9WRVJTSU9OLCBpbmZvLmdldFBl\ncnNpc3RlbmNlWE1MU2NoZW1hVmVyc2lvbigpKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgaWYgKGluZm8uZ2V0U2hhcmVkQ2FjaGVNb2RlKCkgIT0g\nbnVsbCkgeyAKICAgICAgICAgICAgbWFwLnB1dChKUEFQcm9wZXJ0aWVzLkNB\nQ0hFX01PREUsIGluZm8uZ2V0U2hhcmVkQ2FjaGVNb2RlKCkpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICByZXR1cm4gbWFwOwogICAgfQoKICAgIC8q\nKgogICAgICogQWRkcyB0aGUgZ2l2ZW4ga2V5LXZhbCB0byB0aGUgZ2l2ZW4g\nbWFwIGFmdGVyIGFkZGluZyAib3BlbmpwYS4iIHByZWZpeCB0byB0aGUga2V5\nLgogICAgICogVHJhY2tzIHRoaXMgYWRkaXRpb24gaW4gdGhlIGdpdmVuIHNl\ndCBvZiBhZGRlZCBrZXlzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIHJlcGxhY2VBc09wZW5KUEFQcm9wZXJ0eShNYXAgbWFwLCBTZXQ8U3Ry\naW5nPiBhZGRlZCwgU3RyaW5nIGtleSwgT2JqZWN0IHZhbCkgewogICAgICAg\nIG1hcC5wdXQoIm9wZW5qcGEuIiArIGtleSwgdmFsKTsKICAgICAgICBhZGRl\nZC5hZGQoa2V5KTsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0t\nLQoKICAgIHB1YmxpYyBGaWxlIGdldFNvdXJjZUZpbGUoKSB7CiAgICAgICAg\naWYgKF9wZXJzaXN0ZW5jZVhtbEZpbGUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVy\nbiBuZXcgRmlsZShfcGVyc2lzdGVuY2VYbWxGaWxlLnRvVVJJKCkpOwogICAg\nICAgIH0gY2F0Y2ggKFVSSVN5bnRheEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0U291cmNlU2NvcGUo\nKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRTb3VyY2VUeXBlKCkgewogICAgICAgIHJldHVybiBTUkNfWE1MOwog\nICAgfQogICAgCiAgICBwdWJsaWMgaW50IGdldExpbmVOdW1iZXIoKSB7CiAg\nICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAgICAgCiAgICBwdWJsaWMgaW50\nIGdldENvbE51bWJlcigpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFJlc291cmNlTmFtZSgpIHsKICAgICAgICBy\nZXR1cm4gIlBlcnNpc3RlbmNlVW5pdEluZm86IiArIF9uYW1lOwogICAgfQoK\nICAgIC8qKgogICAgICogU2ltcGxlIGNsYXNzIHJlc29sdmVyIGJ1aWx0IGFy\nb3VuZCB0aGUgcGVyc2lzdGVuY2UgdW5pdCBsb2FkZXIuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ2xhc3NSZXNvbHZlckltcGwKICAgICAg\nICBpbXBsZW1lbnRzIENsYXNzUmVzb2x2ZXIgewoKICAgICAgICBwcml2YXRl\nIGZpbmFsIENsYXNzTG9hZGVyIF9sb2FkZXI7CgogICAgICAgIHB1YmxpYyBD\nbGFzc1Jlc29sdmVySW1wbChDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAg\nICAgICAgX2xvYWRlciA9IGxvYWRlcjsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBDbGFzc0xvYWRlciBnZXRDbGFzc0xvYWRlcihDbGFzcyBjdHgsIENs\nYXNzTG9hZGVyIGVudikgewogICAgICAgICAgICByZXR1cm4gX2xvYWRlcjsK\nICAgICAgICB9Cgl9CgogICAgcHVibGljIFN0cmluZyBnZXRQZXJzaXN0ZW5j\nZVhNTFNjaGVtYVZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIF9zY2hlbWFW\nZXJzaW9uOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBlcnNpc3RlbmNl\nWE1MU2NoZW1hVmVyc2lvbihTdHJpbmcgdmVyc2lvbikgewogICAgICAgIF9z\nY2hlbWFWZXJzaW9uID0gdmVyc2lvbjsKICAgIH0KCiAgICBwdWJsaWMgVmFs\naWRhdGlvbk1vZGUgZ2V0VmFsaWRhdGlvbk1vZGUoKSB7CiAgICAgICAgcmV0\ndXJuIF92YWxpZGF0aW9uTW9kZTsKICAgIH0KICAgIAogICAgcHVibGljIHZv\naWQgc2V0VmFsaWRhdGlvbk1vZGUoVmFsaWRhdGlvbk1vZGUgbW9kZSkgewog\nICAgICAgIF92YWxpZGF0aW9uTW9kZSA9IG1vZGU7CiAgICB9CgogICAgcHVi\nbGljIFNoYXJlZENhY2hlTW9kZSBnZXRTaGFyZWRDYWNoZU1vZGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9zaGFyZWRDYWNoZU1vZGU7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyB2b2lkIHNldFNoYXJlZENhY2hlTW9kZShTaGFyZWRDYWNoZU1v\nZGUgbW9kZSkgeyAKICAgICAgICBfc2hhcmVkQ2FjaGVNb2RlID0gbW9kZTsK\nICAgIH0KfQo=\n","encoding":"base64"}

