{"sha":"2c86467746eaeeb9fe12f35d703a678ba3b23126","node_id":"MDQ6QmxvYjIwNjM2NDoyYzg2NDY3NzQ2ZWFlZWI5ZmUxMmYzNWQ3MDNhNjc4YmEzYjIzMTI2","size":62399,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2c86467746eaeeb9fe12f35d703a678ba3b23126","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGF0YWNh\nY2hlOwoKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuTG9jYWxlOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRp\ndHlNYW5hZ2VyOwoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkFwcElkQ2FjaGVPYmplY3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGF0YWNh\nY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0QTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29tbW9uLmFwcHMu\nQ2FjaGVPYmplY3RBQ2hpbGQxOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5DYWNoZU9iamVj\ndEFDaGlsZDI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0QjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29t\nbW9uLmFwcHMuQ2FjaGVPYmplY3RCQ2hpbGQxOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5D\nYWNoZU9iamVjdEM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0RDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUu\nY29tbW9uLmFwcHMuQ2FjaGVPYmplY3RFOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5DYWNo\nZU9iamVjdEY7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0RzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29t\nbW9uLmFwcHMuQ2FjaGVPYmplY3RIOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy4KICAgICAg\nICBDYWNoZU9iamVjdEludGVyZmFjZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29tbW9uLmFwcHMuQ2FjaGVP\nYmplY3RKOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLmRhdGFjYWNoZS5jb21tb24uYXBwcy5SdW50aW1lVGVzdDE7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY29tbW9uLnV0aWxzLkFi\nc3RyYWN0VGVzdENhc2U7CmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuQXNzZXJ0\naW9uRmFpbGVkRXJyb3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0\nYWNhY2hlLkNvbmN1cnJlbnREYXRhQ2FjaGU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNoZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5kYXRhY2FjaGUuRGVsZWdhdGluZ0RhdGFDYWNoZTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuUXVlcnlDYWNoZTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuVHlwZXNDaGFu\nZ2VkRXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hl\nLkRhdGFDYWNoZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLkJyb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuUENEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5qcHFsLkpQUUxQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5FeHRlbnQ7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuSlBBRmFjYWRlSGVscGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFF\nbnRpdHlNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFu\nYWdlckZhY3RvcnlTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UuT3BlbkpQQVBlcnNpc3RlbmNlOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFRdWVyeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLkNhY2hlTWFwOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuSWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLlByb3h5RGF0ZTsKCi8qKgogKiAjIyMgc2hvdWxkIGFkZCAx\nLi4xIHJlbGF0aW9uIHRlc3QgIyMjIGFwcCBpZCBjb21wb3VuZCBrZXkgdGVz\ndAogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIENhY2hlVGVzdCBleHRlbmRz\nIEFic3RyYWN0VGVzdENhc2UgewoKICAgIHByaXZhdGUgc3RhdGljIFN0cmlu\nZyBPUklHX05BTUUgPSAib3JpZ05hbWUiOwoKICAgIHByaXZhdGUgc3RhdGlj\nIFN0cmluZyBORVdfTkFNRSA9ICJuZXdOYW1lIjsKCiAgICBwcml2YXRlIHN0\nYXRpYyBpbnQgT1JJR19BR0UgPSAzMDsKCiAgICBwcml2YXRlIHN0YXRpYyBT\ndHJpbmcgT1JJR19QQVJFTlRfTkFNRSA9ICJvcmlnUGFyZW50TmFtZSI7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgaW50IE9SSUdfUEFSRU5UX0FHRSA9IDMxOwoK\nICAgIHByaXZhdGUgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHRpbWVv\ndXRGYWN0b3J5ID0gbnVsbDsKCiAgICBwcml2YXRlIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBmYWN0b3J5ID0gbnVsbDsKCiAgICBwcml2YXRlIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5MiA9IG51bGw7Cgog\nICAgcHJpdmF0ZSBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3M7CgogICAgcHJp\ndmF0ZSBPYmplY3Qgb2lkOwoKICAgIHByaXZhdGUgT2JqZWN0IHBhcmVudE9p\nZDsKCiAgICBwcml2YXRlIE9iamVjdCBvaWR3aXRoY2xhc3M7CgogICAgcHJp\ndmF0ZSBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTsKCiAgICBwcml2YXRlIENh\nY2hlT2JqZWN0QSBhOwoKICAgIHB1YmxpYyBDYWNoZVRlc3QoU3RyaW5nIHRl\nc3QpIHsKICAgICAgICBzdXBlcih0ZXN0LCAiZGF0YWNhY2hlY2FjdHVzYXBw\nIik7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2xlYXIoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChP\ncGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIENsYXNzW10gdG9EZWxldGUgPSBuZXcgQ2xhc3NbXXsgQ2FjaGVPYmplY3RB\nLmNsYXNzLAogICAgICAgICAgICAgICAgQ2FjaGVPYmplY3RCLmNsYXNzLCBD\nYWNoZU9iamVjdEMuY2xhc3MsIENhY2hlT2JqZWN0RC5jbGFzcywKICAgICAg\nICAgICAgICAgIENhY2hlT2JqZWN0RS5jbGFzcywgQ2FjaGVPYmplY3RKLmNs\nYXNzLAogICAgICAgICAgICAgICAgQXBwSWRDYWNoZU9iamVjdC5jbGFzcywg\nfTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0b0RlbGV0ZS5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgc3RhcnRUeChlbSk7CiAg\nICAgICAgICAgICAgICBFeHRlbnQgZSA9IGVtLmNyZWF0ZUV4dGVudCh0b0Rl\nbGV0ZVtpXSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBJdGVyYXRvciBpdCA9\nIGUuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIHdoaWxlIChpdC5oYXNO\nZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICBlbS5yZW1vdmUoaXQubmV4\ndCgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVuZFR4\nKGVtKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAo\nT3BlbkpQQUV4Y2VwdGlvbiBqcGFlKSB7CiAgICAgICAgICAgIFRocm93YWJs\nZVtdIHRzID0ganBhZS5nZXROZXN0ZWRUaHJvd2FibGVzKCk7CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyB0cyAhPSBudWxsICYmIGkgPCB0cy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdHNbaV0ucHJpbnRTdGFja1Ry\nYWNlKCk7CiAgICAgICAgICAgIH0KLy8JCQlqcGFlLnByaW50U3RhY2tUcmFj\nZSgpOwoKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAg\nIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSBzdHJpbmcgYXJyYXkgb2YgZXh0cmEgY29uZmlndXJhdGlvbiBv\ncHRpb25zIGZvciB0aGUgc3BlY2lmaWVkCiAgICAgKiBjYWNoZS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IFN0cmluZ1tdIGdldENvbmZzKCk7\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzdHJpbmcgYXJyYXkgb2YgZXh0\ncmEgY29uZmlndXJhdGlvbiBvcHRpb25zIGZvciBhIHNlY29uZCBjYWNoZS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IFN0cmluZ1tdIGdldENv\nbmZzMigpOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBj\nYWNoZSBpcyBhIGNvaGVyZW50IG9uZSAob25lIHdoZXJlIGNoYW5nZXMgaW4g\nb25lCiAgICAgKiBjYWNoZSBhcmUgaW1tZWRpYXRlbHkgdmlzaWJsZSBlbHNl\nd2hlcmUpOyBvdGhlcndpc2UgcmV0dXJucyBmYWxzZS4gSW4gdGhlCiAgICAg\nKiBjb250ZXh0IG9mIHRoaXMgdGVzdCBjbGFzcywgY29oZXJlbmNlIGlzIGEg\nc2luZ2xlLUpWTSB0aGluZyBvbmx5LgogICAgICovCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBpc0NhY2hlQ29oZXJlbnQoKSB7CiAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CgogICAgICAgIC8qCiAgICAgICAgICogT3BlbkpQQSBkb2Vz\nIG5vdCBzZWVtIHRvIHN1cHBvcnQgcGx1cmFsIGNvbmZpZ3VyYXRpb24gcHJv\ncGVydGllcy4gIChBbHRob3VnaCBpdCBzZWVtcwogICAgICAgICAqIHRoYXQg\nS29kbyBkb2VzLi4uKSAgVW50aWwgT3BlbkpQQSBpcyB1cGRhdGVkIHRvIHN1\ncHBvcnQgdGhpcyBtdWx0aXBsZSBjb25maWd1cmF0aW9uCiAgICAgICAgICog\nc2V0dGluZywgdGhlIGZvbGxvd2luZyBjb25maWd1cmF0aW9uIGl0ZW0gd2ls\nbCBiZSBkaXNhYmxlZC4uLgogICAgICAgICAqIAogICAgICAgICAqIFNwZWNp\nZmljYWxseSwgdGhpcyB0eXBlIG9mIGNvbmZpZ3VyYXRpb24gaXMgY3VycmVu\ndGx5IG5vdCBhbGxvd2VkLi4uCiAgICAgICAgICogPHByb3BlcnR5IG5hbWU9\nIm9wZW5qcGEuRGF0YUNhY2hlIiB2YWx1ZT0idHJ1ZSwgdHJ1ZShOYW1lPXh4\neCkiLz4KICAgICAgICAgKi8KICAgICAgICBTdHJpbmdbXSBjb25mcyA9IGdl\ndENvbmZzKCk7Ci8vICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbmZz\nLmxlbmd0aDsgaSA9IGkgKyAyKSB7Ci8vICAgICAgICAgICAgaWYgKCJvcGVu\nanBhLkRhdGFDYWNoZSIuZXF1YWxzKGNvbmZzW2ldKSkKLy8gICAgICAgICAg\nICAgICAgY29uZnNbaSArIDFdICs9Ci8vICAgICAgICAgICAgICAgICAgICAi\nLCB0cnVlKE5hbWU9bm90LXRoZS1kZWZhdWx0LWNhY2hlLCBDYWNoZVNpemU9\nMTApIjsKLy8gICAgICAgIH0KLy8KICAgICAgICBTdHJpbmdbXSBjb25mczIg\nPSBnZXRDb25mczIoKTsKLy8gICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nY29uZnMyLmxlbmd0aDsgaSA9IGkgKyAyKSB7Ci8vICAgICAgICAgICAgaWYg\nKCJvcGVuanBhLkRhdGFDYWNoZSIuZXF1YWxzKGNvbmZzMltpXSkpCi8vICAg\nICAgICAgICAgICAgIGNvbmZzMltpICsgMV0gKz0KLy8gICAgICAgICAgICAg\nICAgICAgICIsIHRydWUoTmFtZT1ub3QtdGhlLWRlZmF1bHQtY2FjaGUsIENh\nY2hlU2l6ZT0xMCkiOwovLyAgICAgICAgfQoKICAgICAgICBNYXAgcHJvcHNN\nYXAxID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGNvbmZzLmxlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgICAgIHByb3Bz\nTWFwMS5wdXQoY29uZnNbaV0sIGNvbmZzW2kgKyAxXSk7CiAgICAgICAgfQog\nICAgICAgIE1hcCBwcm9wc01hcDIgPSBuZXcgSGFzaE1hcCgpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgY29uZnMyLmxlbmd0aDsgaSArPSAyKSB7\nCiAgICAgICAgICAgIHByb3BzTWFwMi5wdXQoY29uZnMyW2ldLCBjb25mczJb\naSArIDFdKTsKICAgICAgICB9CgogICAgICAgIGZhY3RvcnkgPSAoT3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5KSBnZXRFbWYocHJvcHNNYXAxKTsKICAg\nICAgICBmYWN0b3J5MiA9IChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnkp\nIGdldEVtZihwcm9wc01hcDIpOwoKICAgICAgICByZXBvcyA9IEpQQUZhY2Fk\nZUhlbHBlci50b0Jyb2tlckZhY3RvcnkoZmFjdG9yeSkuZ2V0Q29uZmlndXJh\ndGlvbigpCiAgICAgICAgICAgIC5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0\nYW5jZSgpOwoKICAgICAgICBTdHJpbmdbXSBiaWdnZXJDb25mcyA9IG5ldyBT\ndHJpbmdbY29uZnMubGVuZ3RoICsgMl07CiAgICAgICAgU3lzdGVtLmFycmF5\nY29weShjb25mcywgMCwgYmlnZ2VyQ29uZnMsIDAsIGNvbmZzLmxlbmd0aCk7\nCiAgICAgICAgYmlnZ2VyQ29uZnNbYmlnZ2VyQ29uZnMubGVuZ3RoIC0gMl0g\nPSAib3BlbmpwYS5EYXRhQ2FjaGVUaW1lb3V0IjsKICAgICAgICBiaWdnZXJD\nb25mc1tiaWdnZXJDb25mcy5sZW5ndGggLSAxXSA9ICIxMDAwIjsKICAgICAg\nICBNYXAgcHJvcHNNYXAzID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGJpZ2dlckNvbmZzLmxlbmd0aDsgaSArPSAyKSB7\nCiAgICAgICAgICAgIHByb3BzTWFwMy5wdXQoYmlnZ2VyQ29uZnNbaV0sIGJp\nZ2dlckNvbmZzW2kgKyAxXSk7CiAgICAgICAgfQogICAgICAgIHRpbWVvdXRG\nYWN0b3J5ID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSkgZ2V0RW1m\nKHByb3BzTWFwMyk7CgogICAgICAgIGNsZWFyKCk7CgogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBm\nYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7Cgog\nICAgICAgIENhY2hlT2JqZWN0QSBhOwogICAgICAgIENhY2hlT2JqZWN0QSBh\ncGFyZW50OwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIHdlIGNhbid0\nIHNwZWNpZnkgdGhpcyBmb3IgVXNlclRyYW5zYWN0aW9uCiAgICAgICAgICAg\nIC8qCiAgICAgICAgICAgICAgICAqIHBtLmN1cnJlbnRUcmFuc2FjdGlvbigp\nLnNldE5vbnRyYW5zYWN0aW9uYWxSZWFkKHRydWUpOwogICAgICAgICAgICAg\nICAgKiBwbS5jdXJyZW50VHJhbnNhY3Rpb24oKS5zZXRPcHRpbWlzdGljKHRy\ndWUpOwogICAgICAgICAgICAgICAgKi8KCi8vCQkJZW0uc2V0Tm9udHJhbnNh\nY3Rpb25hbFJlYWQodHJ1ZSk7Ci8vCQkJZW0uc2V0T3B0aW1pc3RpYyh0cnVl\nKTsKCiAgICAgICAgICAgIGEgPSBuZXcgQ2FjaGVPYmplY3RBKE9SSUdfTkFN\nRSwgT1JJR19BR0UpOwogICAgICAgICAgICBhcGFyZW50ID0gbmV3IENhY2hl\nT2JqZWN0QShPUklHX1BBUkVOVF9OQU1FLCBPUklHX1BBUkVOVF9BR0UpOwog\nICAgICAgICAgICBhLnNldFJlbGF0ZWRPYmplY3QoYXBhcmVudCk7CiAgICAg\nICAgICAgIExpbmtlZExpc3QgY2hpbGRyZW4gPSBuZXcgTGlua2VkTGlzdCgp\nOwogICAgICAgICAgICBjaGlsZHJlbi5hZGQoYSk7CiAgICAgICAgICAgIGFw\nYXJlbnQuc2V0UmVsYXRlZENvbGxlY3Rpb24oY2hpbGRyZW4pOwoKICAgICAg\nICAgICAgc3RhcnRUeChlbSk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QoYSk7\nCiAgICAgICAgICAgIGVtLnBlcnNpc3QoYXBhcmVudCk7CiAgICAgICAgICAg\nIG9pZCA9IGVtLmdldE9iamVjdElkKGEpOwogICAgICAgICAgICBvaWR3aXRo\nY2xhc3MgPSBuZXcgSWQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQudG9TdHJp\nbmcoKSk7CiAgICAgICAgICAgIHBhcmVudE9pZCA9IGVtLmdldE9iamVjdElk\nKGFwYXJlbnQpOwogICAgICAgICAgICBlbmRUeChlbSk7CiAgICAgICAgfQog\nICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAg\nICAgfQoKICAgICAgICAvLyBsb2FkIGFuIG9iamVjdCBpbiBhIHNlcGFyYXRl\nIHBtIGJlZm9yZSB0aGUgdXBkYXRlCiAgICAgICAgLy8gaGFwcGVucy4gVGhp\ncyBzaG91bGQgbm90IGNoYW5nZSwgZWxzZSB3ZSdyZSBpbgogICAgICAgIC8v\nIHZpb2xhdGlvbiBvZiB0aGUgc3BlYy4KICAgICAgICB0aGlzLmVtID0gZmFj\ndG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeCh0\naGlzLmVtKTsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBPcGVuSlBB\nRW50aXR5TWFuYWdlciBvcGVuRW09KE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSB0\naGlzLmVtOwogICAgICAgICAgICB0aGlzLmEgPSAoQ2FjaGVPYmplY3RBKSB0\naGlzLmVtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwoKICAgICAg\nICAgICAgLy8gbG9hZCB0aGUgcGFyZW50IGZvciB0ZXN0Q29sbGVjdGlvbnMo\nKS4KICAgICAgICAgICAgQ2FjaGVPYmplY3RBIHJlbCA9IHRoaXMuYS5nZXRS\nZWxhdGVkT2JqZWN0KCk7CiAgICAgICAgICAgIHJlbC5nZXRSZWxhdGVkQ29s\nbGVjdGlvbigpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAg\nICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZFR4KHRoaXMu\nZW0pOwogICAgICAgICAgICAvLyBlbmRFbSh0aGlzLmVtKTsKICAgICAgICB9\nCgogICAgICAgIGVtID0gZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3RhcnRUeChlbSk7CiAgICAg\nICAgICAgIGEgPSAoQ2FjaGVPYmplY3RBKSBlbS5maW5kKENhY2hlT2JqZWN0\nQS5jbGFzcywgb2lkKTsKICAgICAgICAgICAgYS5zZXROYW1lKE5FV19OQU1F\nKTsKCiAgICAgICAgICAgIGFwYXJlbnQgPSAoQ2FjaGVPYmplY3RBKSBlbS5m\naW5kKENhY2hlT2JqZWN0QS5jbGFzcywgcGFyZW50T2lkKTsKCiAgICAgICAg\nICAgIENhY2hlT2JqZWN0QSBhMiA9IG5ldyBDYWNoZU9iamVjdEEoT1JJR19O\nQU1FLCBPUklHX0FHRSk7CiAgICAgICAgICAgIGEyLnNldFJlbGF0ZWRPYmpl\nY3QoYXBhcmVudCk7CiAgICAgICAgICAgIGFwYXJlbnQuZ2V0UmVsYXRlZENv\nbGxlY3Rpb24oKS5hZGQoYTIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGEy\nKTsKICAgICAgICAgICAgZW5kVHgoZW0pOwoKICAgICAgICAgICAgYXNzZXJ0\nTmV3KGEpOwogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAg\nICAgZW5kRW0oZW0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGVuZEVt\nKGVtKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmFjdG9yeS5jbG9z\nZSgpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmFjdG9yeTIu\nY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgfQogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CgogICAg\nICAgIGZhY3RvcnkgPSBudWxsOwogICAgICAgIGZhY3RvcnkyID0gbnVsbDsK\nICAgICAgICB0aW1lb3V0RmFjdG9yeSA9IG51bGw7CiAgICAgICAgb2lkID0g\nbnVsbDsKICAgICAgICBwYXJlbnRPaWQgPSBudWxsOwogICAgICAgIGVtID0g\nbnVsbDsKICAgICAgICBhID0gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0RGVsZXRlZE9uZVRvT25lUmVsYXRpb25zKCkgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGZhY3RvcnkuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHN0YXJ0VHgoZW0pOwogICAgICAgICAgICBDYWNoZU9iamVjdEEgYSA9IChD\nYWNoZU9iamVjdEEpIGVtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQp\nOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGEuZ2V0UmVsYXRlZE9iamVj\ndCgpKTsKICAgICAgICAgICAgZW0ucmVtb3ZlKGEuZ2V0UmVsYXRlZE9iamVj\ndCgpKTsKICAgICAgICAgICAgZW5kVHgoZW0pOwogICAgICAgIH0KICAgICAg\nICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0oZW0pOwogICAgICAgIH0K\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbTIgPSBmYWN0b3J5LmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBDYWNo\nZU9iamVjdEEgYTIgPSAoQ2FjaGVPYmplY3RBKSBlbTIuZmluZChDYWNoZU9i\namVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgICAgIGFzc2VydE51bGwoYTIu\nZ2V0UmVsYXRlZE9iamVjdCgpKTsKICAgICAgICB9CiAgICAgICAgZmluYWxs\neSB7CiAgICAgICAgICAgIGVuZEVtKGVtMik7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RDYW5DYWNoZUV4dGVuc2lvbigpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIERhdGFDYWNoZSBjYWNoZSA9IGNhY2hl\nTWFuYWdlcihmYWN0b3J5KS5nZXRTeXN0ZW1EYXRhQ2FjaGUoKTsKCiAgICAg\nICAgLy8gZmlyc3QsIHRlc3QgY2FjaGluZyBvZiBuZXdseSBjcmVhdGVkIG9i\namVjdHMuCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSAoT3Bl\nbkpQQUVudGl0eU1hbmFnZXIpIGZhY3RvcnkKICAgICAgICAgICAgLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBPYmplY3QgbzsKICAgICAgICBP\nYmplY3Qgb2lkOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0YXJ0VHgo\nZW0pOwogICAgICAgICAgICBvID0gbmV3IENhY2hlT2JqZWN0QigiZm9vIik7\nCiAgICAgICAgICAgIGVtLnBlcnNpc3Qobyk7CiAgICAgICAgICAgIGVuZFR4\nKGVtKTsKICAgICAgICAgICAgb2lkID0gZW0uZ2V0T2JqZWN0SWQobyk7CiAg\nICAgICAgICAgIGFzc2VydE5vdE51bGwob2lkKTsKICAgICAgICAgICAgYXNz\nZXJ0TnVsbChjYWNoZS5nZXQob2lkKSk7CiAgICAgICAgfQogICAgICAgIGZp\nbmFsbHkgewogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAgICAgfQoKICAg\nICAgICAvLyBub3csIHRlc3QgY2FjaGluZyBvZiBkYXRhIGxvYWRlZCBmcm9t\nIHRoZSBkYXRhIHN0b3JlLgogICAgICAgIGVtID0gZmFjdG9yeS5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbyA9\nIGVtLmZpbmQoQ2FjaGVPYmplY3RCLmNsYXNzLCBvaWQpOwogICAgICAgICAg\nICBhc3NlcnROb3ROdWxsKG8pOwogICAgICAgICAgICBhc3NlcnROdWxsKGNh\nY2hlLmdldChvaWQpKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAg\nICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVzdEdldENhY2hlKCkgewogICAgICAgIC8vIGZpcnN0LCB0\nZXN0IGNhY2hpbmcgb2YgbmV3bHkgY3JlYXRlZCBvYmplY3RzLgogICAgICAg\nIERhdGFDYWNoZSBkZWZhdWx0Q2FjaGUgPSBjYWNoZU1hbmFnZXIoZmFjdG9y\neSkuZ2V0RGF0YUNhY2hlKAogICAgICAgICAgICBEYXRhQ2FjaGUuTkFNRV9E\nRUZBVUxULCBmYWxzZSk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChkZWZhdWx0\nQ2FjaGUpOwoKICAgICAgICBEYXRhQ2FjaGUgY2FjaGUgPSBjYWNoZU1hbmFn\nZXIoZmFjdG9yeSkuZ2V0U3lzdGVtRGF0YUNhY2hlKCk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKGRlZmF1bHRDYWNoZSwgY2FjaGUpOwoKICAgICAgICBDbGFz\nc01ldGFEYXRhIGFNZXRhID0gcmVwb3MuZ2V0TWV0YURhdGEoQ2FjaGVPYmpl\nY3RBLmNsYXNzLCBudWxsLCB0cnVlKTsKICAgICAgICBDbGFzc01ldGFEYXRh\nIGFDaGlsZDFNZXRhID0gcmVwb3MuZ2V0TWV0YURhdGEoQ2FjaGVPYmplY3RB\nQ2hpbGQxLmNsYXNzLAogICAgICAgICAgICBudWxsLCB0cnVlKTsKICAgICAg\nICBDbGFzc01ldGFEYXRhIGFDaGlsZDJNZXRhID0gcmVwb3MuZ2V0TWV0YURh\ndGEoQ2FjaGVPYmplY3RBQ2hpbGQyLmNsYXNzLAogICAgICAgICAgICBudWxs\nLCB0cnVlKTsKICAgICAgICBDbGFzc01ldGFEYXRhIGJNZXRhID0gcmVwb3Mu\nZ2V0TWV0YURhdGEoQ2FjaGVPYmplY3RCLmNsYXNzLCBudWxsLCB0cnVlKTsK\nICAgICAgICBDbGFzc01ldGFEYXRhIGJDaGlsZDFNZXRhID0gcmVwb3MuZ2V0\nTWV0YURhdGEoQ2FjaGVPYmplY3RCQ2hpbGQxLmNsYXNzLAogICAgICAgICAg\nICBudWxsLCB0cnVlKTsKICAgICAgICBDbGFzc01ldGFEYXRhIGNNZXRhID0g\ncmVwb3MuZ2V0TWV0YURhdGEoQ2FjaGVPYmplY3RDLmNsYXNzLCBudWxsLCB0\ncnVlKTsKICAgICAgICBDbGFzc01ldGFEYXRhIGRNZXRhID0gcmVwb3MuZ2V0\nTWV0YURhdGEoQ2FjaGVPYmplY3RELmNsYXNzLCBudWxsLCB0cnVlKTsKICAg\nICAgICBDbGFzc01ldGFEYXRhIGVNZXRhID0gcmVwb3MuZ2V0TWV0YURhdGEo\nQ2FjaGVPYmplY3RFLmNsYXNzLCBudWxsLCB0cnVlKTsKCiAgICAgICAgY2Fj\naGUgPSBhTWV0YS5nZXREYXRhQ2FjaGUoKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoZGVmYXVsdENhY2hlLCBjYWNoZSk7CiAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCIqKioqKipEYXRhQ2FjaGVOYW1lOiIKICAgICAgICAgICAgKyBh\nQ2hpbGQyTWV0YS5nZXREYXRhQ2FjaGVOYW1lKCkpOwogICAgICAgIGFzc2Vy\ndE51bGwoYUNoaWxkMk1ldGEuZ2V0RGF0YUNhY2hlKCkpOwoKICAgICAgICBh\nc3NlcnROdWxsKGJNZXRhLmdldERhdGFDYWNoZSgpKTsKCiAgICAgICAgYXNz\nZXJ0RXF1YWxzKGNNZXRhLmdldERhdGFDYWNoZSgpLCBkTWV0YS5nZXREYXRh\nQ2FjaGUoKSk7CiAgICAgICAgaWYgKGRNZXRhLmdldERhdGFDYWNoZSgpIGlu\nc3RhbmNlb2YgQ29uY3VycmVudERhdGFDYWNoZSkgewogICAgICAgICAgICBD\nb25jdXJyZW50RGF0YUNhY2hlIGRDYWNoZUltcGwgPQogICAgICAgICAgICAg\nICAgKENvbmN1cnJlbnREYXRhQ2FjaGUpIGRNZXRhLmdldERhdGFDYWNoZSgp\nOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoMTAsIGRDYWNoZUltcGwuZ2V0\nQ2FjaGVTaXplKCkpOwogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVhbHMo\nYU1ldGEuZ2V0RGF0YUNhY2hlKCksIGVNZXRhLmdldERhdGFDYWNoZSgpKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UHJpbWl0aXZlcygpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSAn\nYScgdGhhdCB3YXMgZm91bmQgYmVmb3JlIGNoYW5nZXMKICAgICAgICAvLyB3\nZXJlIG1hZGUgaXMgc3RpbGwgdmFsaWQuCiAgICAgICAgYXNzZXJ0T2xkKGEp\nOwogICAgICAgIGVtLnJlZnJlc2goYSk7CiAgICAgICAgYXNzZXJ0TmV3KGEp\nOwogICAgfQoKICAgIC8vIEZJWE1FIFNlZXRoYSBTZXAgMjUsMjAwNgogICAg\nLyoKICAgICAgKiBwdWJsaWMgdm9pZCB0ZXN0Q29sbGVjdGlvbnMoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsgQ2FjaGVPYmplY3RBIHBhcmVudCA9CiAgICAgICog\nKENhY2hlT2JqZWN0QSkgZW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsT1JJ\nR19QQVJFTlRfTkFNRSk7CiAgICAgICogYXNzZXJ0RXF1YWxzKDEsIHBhcmVu\ndC5nZXRSZWxhdGVkQ29sbGVjdGlvbigpLnNpemUoKSk7CiAgICAgICogZW0u\ncmVmcmVzaChwYXJlbnQpOyBhc3NlcnRFcXVhbHMoMiwKICAgICAgKiBwYXJl\nbnQuZ2V0UmVsYXRlZENvbGxlY3Rpb24oKS5zaXplKCkpOyB9CiAgICAgICov\nCgogICAgLy8gRklYTUUgU2VldGhhIFNlcCAyNSwyMDA2CiAgICAvKgogICAg\nICAqIHB1YmxpYyB2b2lkIHRlc3RFeHBpcmVkQ29sbGVjdGlvbnMoKSB7IENh\nY2hlT2JqZWN0QSBwYXJlbnQgPQogICAgICAqIChDYWNoZU9iamVjdEEpIGVt\nLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLE9SSUdfUEFSRU5UX05BTUUpOwog\nICAgICAqIGVtLnJlZnJlc2gocGFyZW50KTsgQ29sbGVjdGlvbiByZWxhdGVk\nT2lkcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICogZm9yIChJdGVyYXRvciBp\ndGVyID0gcGFyZW50LmdldFJlbGF0ZWRDb2xsZWN0aW9uKCkuaXRlcmF0b3Io\nKTsKICAgICAgKiAgICAgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICogcmVs\nYXRlZE9pZHMuYWRkKEpET0hlbHBlci5nZXRPYmplY3RJZChpdGVyLm5leHQo\nKSkpOyB9CiAgICAgICoKICAgICAgKiBDbGFzc01ldGFEYXRhIG1ldGEgPSBy\nZXBvcy5nZXRNZXRhRGF0YShDYWNoZU9iamVjdEEuY2xhc3MsIG51bGwsIHRy\ndWUpOwogICAgICAqIERhdGFDYWNoZSBjYWNoZSA9IG1ldGEuZ2V0RGF0YUNh\nY2hlKCk7CiAgICAgICogIC8vIGRyb3AgdGhlIHJlbGF0ZWQgZGF0YSBmcm9t\nIHRoZSBjYWNoZSBmb3IgKEl0ZXJhdG9yIGl0ZXIgPQogICAgICAqIHJlbGF0\nZWRPaWRzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgY2FjaGUucmVt\nb3ZlKGl0ZXIubmV4dCgpKTsKICAgICAgKgogICAgICAqIFBlcnNpc3RlbmNl\nTWFuYWdlciBwbTIgPSBmYWN0b3J5LmdldFBlcnNpc3RlbmNlTWFuYWdlcigp\nOyB0cnkgewogICAgICAqIGFzc2VydFRydWUoY2FjaGUuY29udGFpbnMocGFy\nZW50T2lkKSk7IHBhcmVudCA9IChDYWNoZU9iamVjdEEpCiAgICAgICogcG0y\nLmdldE9iamVjdEJ5SWQocGFyZW50T2lkLCB0cnVlKTsKICAgICAgKgogICAg\nICAqIHRyeSB7IGZvciAoSXRlcmF0b3IgaXRlciA9IHJlbGF0ZWRPaWRzLml0\nZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykKICAgICAgKiBhc3NlcnRGYWxz\nZShjYWNoZS5jb250YWlucyhpdGVyLm5leHQoKSkpOyB9IGNhdGNoIChBc3Nl\ncnRpb25GYWlsZWRFcnJvcgogICAgICAqIGUpIHsgYnVnKDQ2NywgImRhdGEg\nY2FjaGUgY2FuIG92ZXItZWFnZXJseSBsb2FkIHJlbGF0aW9uIGRhdGEiKTsg\nfSB9CiAgICAgICogZmluYWxseSB7IGNsb3NlKHBtMik7IH0gfQogICAgICAq\nLwoKICAgIHB1YmxpYyB2b2lkIHRlc3RFeHBpcmVkUmVsYXRpb25zKCkgewog\nICAgICAgIENhY2hlT2JqZWN0QSBhID0gKENhY2hlT2JqZWN0QSkgZW0uZmlu\nZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgZW0ucmVmcmVz\naChhKTsKICAgICAgICBPYmplY3QgcmVsYXRpb25PaWQgPSBlbS5nZXRPYmpl\nY3RJZChhLmdldFJlbGF0ZWRPYmplY3QoKSk7CiAgICAgICAgcmVsYXRpb25P\naWQgPSBuZXcgSWQoQ2FjaGVPYmplY3RBLmNsYXNzLCByZWxhdGlvbk9pZC50\nb1N0cmluZygpKTsKCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gcmVw\nb3MuZ2V0TWV0YURhdGEoQ2FjaGVPYmplY3RBLmNsYXNzLCBudWxsLCB0cnVl\nKTsKICAgICAgICBEYXRhQ2FjaGUgY2FjaGUgPSBtZXRhLmdldERhdGFDYWNo\nZSgpOwoKICAgICAgICAvLyBkcm9wIHRoZSByZWxhdGVkIGRhdGEgZnJvbSB0\naGUgY2FjaGUKICAgICAgICBjYWNoZS5yZW1vdmUocmVsYXRpb25PaWQpOwoK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTIgPSAoT3BlbkpQQUVu\ndGl0eU1hbmFnZXIpIGZhY3RvcnkKICAgICAgICAgICAgLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRU\ncnVlKGNhY2hlLmNvbnRhaW5zKG9pZHdpdGhjbGFzcykpOwogICAgICAgICAg\nICAvL2EgPSAoQ2FjaGVPYmplY3RBKSBlbTIuZmluZChDYWNoZU9iamVjdEEu\nY2xhc3MsIG9pZCk7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgYXNzZXJ0RmFsc2UoY2FjaGUuY29udGFpbnMocmVsYXRpb25PaWQpKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCAoQXNzZXJ0aW9uRmFp\nbGVkRXJyb3IgZSkgewogICAgICAgICAgICAgICAgLy8gYnVnKDQ2NywgImRh\ndGEgY2FjaGUgY2FuIG92ZXItZWFnZXJseSBsb2FkIHJlbGF0aW9uIGRhdGEi\nKTsKICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgKiBJIGRv\nbid0IHRoaW5rIHRoaXMgaXMgYSBidWcsIG5vciBzaG91bGQgdGhpcyBleGNl\ncHRpb24KICAgICAgICAgICAgICAgICAqIG9jY3VyLiAgU2luY2Ugd2UncmUg\nZG9pbmcgYSBmaW5kKCkgb3BlcmF0aW9uIGFib3ZlIGFuZCB0aGlzCiAgICAg\nICAgICAgICAgICAgKiBmaWVsZCAoUmVsYXRlZE9iaikgaGFzIGEgZGVmYXVs\ndCBGZXRjaCB0eXBlIG9mIEVBR0VSLCB0aGVuCiAgICAgICAgICAgICAgICAg\nKiB3ZSBzaG91bGQgYmUgcmUtbG9hZGluZyB0aGUgUmVsYXRlZE9iaiBhbmQg\naXQgd2lsbCBiZSBwdXQgYmFjawogICAgICAgICAgICAgICAgICogaW4gdGhl\nIGNhY2hlLi4uICBTbywgYnkgY29tbWVudGluZyBvdXQgdGhlIGFib3ZlIGZp\nbmQoKQogICAgICAgICAgICAgICAgICogb3BlcmF0aW9uIChvciBvdmVycmlk\naW5nIHRoZSBkZWZhdWx0IEZldGNoIHR5cGUgdG8gRUFHRVIpLCB0aGVuCiAg\nICAgICAgICAgICAgICAgKiB0aGlzIGFzc2VydEZhbHNlIHdvcmtzLi4uCiAg\nICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIGUucHJpbnRTdGFj\na1RyYWNlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZmlu\nYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVtMik7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RQQ0FycmF5cygpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIG5ld0VtID0g\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgc3RhcnRUeChuZXdFbSk7CiAgICAgICAgICAgIENhY2hlT2JqZWN0QSBw\nYXJlbnQgPSAoQ2FjaGVPYmplY3RBKSBuZXdFbS5maW5kKENhY2hlT2JqZWN0\nQS5jbGFzcywKICAgICAgICAgICAgICAgIHBhcmVudE9pZCk7CiAgICAgICAg\nICAgIENhY2hlT2JqZWN0QSBhID0gKENhY2hlT2JqZWN0QSkgbmV3RW0uZmlu\nZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgICAgIGEuc2V0\nUmVsYXRlZEFycmF5KG5ldyBDYWNoZU9iamVjdEFbXXsgcGFyZW50LCBhIH0p\nOwogICAgICAgICAgICBlbmRUeChuZXdFbSk7CiAgICAgICAgfQogICAgICAg\nIGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShuZXdFbSk7CiAgICAgICAg\nfQoKICAgICAgICBuZXdFbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFj\ndG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVP\nYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgICAgICBDYWNoZU9iamVjdEFb\nXSBhcnJheSA9IGEuZ2V0UmVsYXRlZEFycmF5KCk7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscygyLCBhcnJheS5sZW5ndGgpOwogICAgICAgICAgICBhc3Nl\ncnRUcnVlKGFycmF5WzBdIGluc3RhbmNlb2YgQ2FjaGVPYmplY3RBKTsKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShhcnJheVsxXSBpbnN0YW5jZW9mIENhY2hl\nT2JqZWN0QSk7CgogICAgICAgICAgICBPYmplY3QgYXJyYXlPaWQgPSBuZXdF\nbS5nZXRPYmplY3RJZChhcnJheVswXSk7CiAgICAgICAgICAgIGlmICghYXJy\nYXlPaWQuZXF1YWxzKHBhcmVudE9pZCkgJiYgIWFycmF5T2lkLmVxdWFscyhv\naWQpKSB7CiAgICAgICAgICAgICAgICBmYWlsKCJhcnJheSBkb2VzIG5vdCBj\nb250YWluIGNvcnJlY3Qgb2lkcyIpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBhcnJheU9pZCA9IG5ld0VtLmdldE9iamVjdElkKGFycmF5WzFdKTsK\nICAgICAgICAgICAgaWYgKCFhcnJheU9pZC5lcXVhbHMocGFyZW50T2lkKSAm\nJiAhYXJyYXlPaWQuZXF1YWxzKG9pZCkpIHsKICAgICAgICAgICAgICAgIGZh\naWwoImFycmF5IGRvZXMgbm90IGNvbnRhaW4gY29ycmVjdCBvaWRzIik7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAg\nICAgICAgIGVuZEVtKG5ld0VtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVzdFN0cmluZ0FycmF5cygpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIG5ld0VtID0gKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3Rh\ncnRUeChuZXdFbSk7CiAgICAgICAgICAgIENhY2hlT2JqZWN0QSBhID0gKENh\nY2hlT2JqZWN0QSkgbmV3RW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9p\nZCk7CiAgICAgICAgICAgIGEuc2V0U3RyaW5nQXJyYXkobmV3IFN0cmluZ1td\neyAic3RyaW5nMCIsICJzdHJpbmcxIiwgInN0cmluZzIiIH0pOwogICAgICAg\nICAgICBlbmRUeChuZXdFbSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkg\newogICAgICAgICAgICBlbmRFbShuZXdFbSk7CiAgICAgICAgfQoKICAgICAg\nICBuZXdFbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeS5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RBLmNs\nYXNzLCBvaWQpOwogICAgICAgICAgICBTdHJpbmdbXSBhcnJheSA9IGEuZ2V0\nU3RyaW5nQXJyYXkoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDMsIGFy\ncmF5Lmxlbmd0aCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygic3RyaW5n\nMCIsIGFycmF5WzBdKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJzdHJp\nbmcxIiwgYXJyYXlbMV0pOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoInN0\ncmluZzIiLCBhcnJheVsyXSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkg\newogICAgICAgICAgICBlbmRFbShuZXdFbSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RQcmltaXRpdmVBcnJheXMoKSB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBuZXdF\nbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAg\nICAuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHN0YXJ0VHgobmV3RW0pOwogICAgICAgICAgICBDYWNoZU9iamVj\ndEEgYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RB\nLmNsYXNzLCBvaWQpOwogICAgICAgICAgICBhLnNldFByaW1pdGl2ZUFycmF5\nKG5ldyBmbG9hdFtdeyAwLCAxLCAyIH0pOwogICAgICAgICAgICBlbmRUeChu\nZXdFbSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAgICAg\nICBlbmRFbShuZXdFbSk7CiAgICAgICAgfQoKICAgICAgICBuZXdFbSA9IChP\ncGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYSA9IChDYWNoZU9i\namVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwog\nICAgICAgICAgICBmbG9hdFtdIGFycmF5ID0gYS5nZXRQcmltaXRpdmVBcnJh\neSgpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoMywgYXJyYXkubGVuZ3Ro\nKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDAuMEYsIGFycmF5WzBdLCAw\nKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDEuMEYsIGFycmF5WzFdLCAw\nKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDIuMGYsIGFycmF5WzJdLCAw\nKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVu\nZEVtKG5ld0VtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdERhdGVBcnJheXMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBP\ncGVuSlBBRW50aXR5TWFuYWdlciBuZXdFbSA9IChPcGVuSlBBRW50aXR5TWFu\nYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIENhY2hlT2JqZWN0QSBhOwogICAgICAgIERhdGVbXSBk\nYXRlQXJyYXk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3RhcnRUeChu\nZXdFbSk7CiAgICAgICAgICAgIGEgPSAoQ2FjaGVPYmplY3RBKSBuZXdFbS5m\naW5kKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsKICAgICAgICAgICAgZGF0\nZUFycmF5ID0gbmV3IERhdGVbXXsgbmV3IERhdGUoKSwgbmV3IERhdGUoKSwg\nbmV3IERhdGUoKSB9OwogICAgICAgICAgICBhLnNldERhdGVBcnJheShkYXRl\nQXJyYXkpOwogICAgICAgICAgICBlbmRUeChuZXdFbSk7CiAgICAgICAgfQog\nICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShuZXdFbSk7CiAg\nICAgICAgfQoKICAgICAgICBuZXdFbSA9IChPcGVuSlBBRW50aXR5TWFuYWdl\ncikgZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQo\nQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgICAgICBEYXRlW10g\nYXJyYXkgPSBhLmdldERhdGVBcnJheSgpOwogICAgICAgICAgICBpZiAoYXJy\nYXlbMF0gPT0gZGF0ZUFycmF5WzBdKSB7CiAgICAgICAgICAgICAgICBmYWls\nKCJkYXRlIG9iamVjdHMgYXJlIHRoZSBzYW1lIik7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVt\nKG5ld0VtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndERhdGUoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBuZXdFbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFj\ndG9yeQogICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAg\nICAgIENhY2hlT2JqZWN0QSBhOwogICAgICAgIERhdGUgZDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBzdGFydFR4KG5ld0VtKTsKICAgICAgICAgICAg\nYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RBLmNs\nYXNzLCBvaWQpOwogICAgICAgICAgICBkID0gbmV3IERhdGUoKTsKICAgICAg\nICAgICAgYS5zZXREYXRlKGQpOwogICAgICAgICAgICBlbmRUeChuZXdFbSk7\nCiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBlbmRF\nbShuZXdFbSk7CiAgICAgICAgfQoKICAgICAgICAvLyBzbGVlcCBhIGJpdCBz\nbyB3ZSBjYW4gZW5zdXJlIHRoYXQgdGhlIGRhdGUgZG9lc24ndCBqdXN0CiAg\nICAgICAgLy8gaGFwcGVuIHRvIGJlIHRoZSBzYW1lLgogICAgICAgIFRocmVh\nZC5zbGVlcCgxMDApOwoKICAgICAgICBuZXdFbSA9IChPcGVuSlBBRW50aXR5\nTWFuYWdlcikgZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgYSA9IChDYWNoZU9iamVjdEEpIG5ld0Vt\nLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgICAgICBE\nYXRlIGQyID0gYS5nZXREYXRlKCk7CiAgICAgICAgICAgIGlmIChkID09IGQy\nKSB7CiAgICAgICAgICAgICAgICBmYWlsKCJkYXRlIG9iamVjdHMgYXJlIHRo\nZSBzYW1lIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFzc2VydEVx\ndWFscyhkLmdldFRpbWUoKSwgZDIuZ2V0VGltZSgpKTsKICAgICAgICB9CiAg\nICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKG5ld0VtKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdExvY2FsZSgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIG5ld0VtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAg\nICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRU\neChuZXdFbSk7CiAgICAgICAgQ2FjaGVPYmplY3RBIGEgPSAoQ2FjaGVPYmpl\nY3RBKSBuZXdFbS5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsKICAg\nICAgICBMb2NhbGUgbCA9IExvY2FsZS5nZXREZWZhdWx0KCk7CiAgICAgICAg\nYS5zZXRMb2NhbGUobCk7CiAgICAgICAgZW5kVHgobmV3RW0pOwoKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBuZXdFbTIgPSAoT3BlbkpQQUVudGl0\neU1hbmFnZXIpIGZhY3RvcnkKICAgICAgICAgICAgLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKCiAgICAgICAgYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtMi5m\naW5kKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsKICAgICAgICBMb2NhbGUg\nbDIgPSBhLmdldExvY2FsZSgpOwogICAgICAgIC8vIGxvY2FsZXMgYXJlIGlt\nbXV0YWJsZSBhbmQgZmluYWwsIHNvIHRoZSBkaWZmZXJlbnQgY2FjaGVkCiAg\nICAgICAgLy8gY29waWVzIHNob3VsZCBiZSA9PS4KICAgICAgICBpZiAobCAh\nPSBsMikgewogICAgICAgICAgICBmYWlsKCJsb2NhbGUgb2JqZWN0cyBhcmUg\nbm90IHRoZSBzYW1lLiIpOwogICAgICAgIH0KCiAgICAgICAgZW5kRW0obmV3\nRW0pOwogICAgICAgIGVuZEVtKG5ld0VtMik7CiAgICB9CgogICAgLy8gLS0t\nLS0tLS0tLSBUZXN0IHF1ZXJ5IGNhY2hpbmcgLS0tLS0tLS0tLQogICAgLy8g\nKiBGQ09zIGFzIHBhcmFtcwogICAgLy8gKiBtdWx0aS10aHJlYWRlZCBzdHVm\nZgogICAgLy8gKiBhY2Nlc3MgcGF0aCBzdHVmZiAoc2VlIGFsc28gVGVzdFF1\nZXJ5QWNjZXNzUGF0aCkKICAgIC8vICogc2VyaWFsaXphYmlsaXR5IG9mIHJl\ndHVybmVkIGxpc3RzCiAgICAvLyAqIFBNLnNldFF1ZXJ5Q2FjaGVFbmFibGVk\nIChmYWxzZSk7CiAgICAvLyAqIFF1ZXJ5LnNldFF1ZXJ5Q2FjaGVFbmFibGVk\nIChmYWxzZSk7CiAgICAvLyAqIFBlc3NpbWlzdGljIHRyYW5zYWN0aW9ucwoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RCYXNpY1F1ZXJ5KCkgewogICAgICAgIGJh\nc2ljUXVlcmllcyhmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKSwgQm9v\nbGVhbi5GQUxTRSwgMywgMSk7CiAgICAgICAgYmFzaWNRdWVyaWVzKGZhY3Rv\ncnkuY3JlYXRlRW50aXR5TWFuYWdlcigpLCBCb29sZWFuLlRSVUUsIDMsIDEp\nOwoKICAgICAgICAvLyBtYW51YWxseSBub3RpZnkgdGhlIGNhY2hlIG9mIGNo\nYW5nZXMKICAgICAgICBRdWVyeUNhY2hlIGNhY2hlID0gY2FjaGVNYW5hZ2Vy\nKGZhY3RvcnkpLmdldFN5c3RlbVF1ZXJ5Q2FjaGUoKTsKCiAgICAgICAgLy8g\ndGVzdCB0byBzZWUgaWYgbW9kaWZ5aW5nIEIgY2F1c2VzIEEncyBxdWVyeSBj\nYWNoZSB0byBiZSBmbHVzaGVkCiAgICAgICAgU2V0IHMgPSBuZXcgSGFzaFNl\ndCgpOwogICAgICAgIHMuYWRkKENhY2hlT2JqZWN0Qi5jbGFzcyk7CiAgICAg\nICAgY2FjaGUub25UeXBlc0NoYW5nZWQobmV3IFR5cGVzQ2hhbmdlZEV2ZW50\nKHRoaXMsIHMpKTsKICAgICAgICBiYXNpY1F1ZXJpZXMoZmFjdG9yeS5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCksIEJvb2xlYW4uVFJVRSwgMywgMSk7CgogICAg\nICAgIC8vIHRlc3QgdG8gc2VlIGlmIG1vZGlmeWluZyBBIGNhdXNlcyBBJ3Mg\ncXVlcnkgY2FjaGUgdG8gYmUgZmx1c2hlZAogICAgICAgIHMuYWRkKENhY2hl\nT2JqZWN0QS5jbGFzcyk7CiAgICAgICAgY2FjaGUub25UeXBlc0NoYW5nZWQo\nbmV3IFR5cGVzQ2hhbmdlZEV2ZW50KHRoaXMsIHMpKTsKICAgICAgICBiYXNp\nY1F1ZXJpZXMoZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCksIEJvb2xl\nYW4uRkFMU0UsIDMsIDEpOwoKICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCBu\nb24tbWFudWFsIG5vdGlmaWNhdGlvbiB3b3JrcwogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBzdGFydFR4KGVtKTsKICAgICAgICAg\nICAgQ2FjaGVPYmplY3RBIGEgPSBuZXcgQ2FjaGVPYmplY3RBKE9SSUdfTkFN\nRSwgT1JJR19BR0UpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGEpOwogICAg\nICAgICAgICBlbmRUeChlbSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkg\newogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAgICAgfQoKICAgICAgICBi\nYXNpY1F1ZXJpZXMoZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCksIEJv\nb2xlYW4uRkFMU0UsIDQsIDIpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lk\nIGJhc2ljUXVlcmllcyhFbnRpdHlNYW5hZ2VyIGVtLCBCb29sZWFuIGluQ2Fj\naGUsIGludCBhbGxTaXplLAogICAgICAgIGludCBvcmlnU2l6ZSkgewogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIGxvbmcgc3RhcnQ7CiAgICAgICAgICAg\nIGxvbmcgcTFwMTsKICAgICAgICAgICAgbG9uZyBxMXAyOwogICAgICAgICAg\nICBsb25nIHEycDE7CiAgICAgICAgICAgIGxvbmcgcTJwMjsKCiAgICAgICAg\nICAgIEJyb2tlciBicm9rZXIgPSBKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXIo\nZW0pOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5IHEgPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBKUFFM\nUGFyc2VyLkxBTkdfSlBRTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAgICAg\nICAgICAgKyBDYWNoZU9iamVjdEEuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpICsg\nIiBhIik7CiAgICAgICAgICAgIHEuc2V0Q2FuZGlkYXRlRXh0ZW50KGJyb2tl\nci5uZXdFeHRlbnQoQ2FjaGVPYmplY3RBLmNsYXNzLCBmYWxzZSkpOwogICAg\nICAgICAgICBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICBhc3NlcnRJbkNhY2hlKHEsIGluQ2FjaGUpOwogICAgICAg\nICAgICBMaXN0IGwgPSAoTGlzdCkgcS5leGVjdXRlKCk7CiAgICAgICAgICAg\nIGl0ZXJhdGUobCk7CiAgICAgICAgICAgIHExcDEgPSBTeXN0ZW0uY3VycmVu\ndFRpbWVNaWxsaXMoKSAtIHN0YXJ0OwoKICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKGFsbFNpemUsIGwuc2l6ZSgpKTsKCiAgICAgICAgICAgIHN0YXJ0ID0g\nU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgIExpc3Qg\nbDIgPSAoTGlzdCkgcS5leGVjdXRlKCk7CiAgICAgICAgICAgIGl0ZXJhdGUo\nbDIpOwogICAgICAgICAgICBxMXAyID0gU3lzdGVtLmN1cnJlbnRUaW1lTWls\nbGlzKCkgLSBzdGFydDsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGFsbFNp\nemUsIGwyLnNpemUoKSk7CgogICAgICAgICAgICBxID0gYnJva2VyLm5ld1F1\nZXJ5KEpQUUxQYXJzZXIuTEFOR19KUFFMLAogICAgICAgICAgICAgICAgInNl\nbGVjdCBhLm5hbWUsYS5hZ2UgZnJvbSAiCiAgICAgICAgICAgICAgICAgICAg\nKyBDYWNoZU9iamVjdEEuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpCiAgICAgICAg\nICAgICAgICAgICAgKyAiIGEgd2hlcmUgYS5uYW1lID0gOm4gQU5EIGEuYWdl\nID0gOmEiKTsKICAgICAgICAgICAgcS5zZXRDYW5kaWRhdGVFeHRlbnQoYnJv\na2VyLm5ld0V4dGVudChDYWNoZU9iamVjdEEuY2xhc3MsIGZhbHNlKSk7CiAg\nICAgICAgICAgIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7\nCiAgICAgICAgICAgIGFzc2VydEluQ2FjaGUocSwgaW5DYWNoZSwgbmV3IE9i\namVjdFtdeyBPUklHX05BTUUsCiAgICAgICAgICAgICAgICBuZXcgSW50ZWdl\ncihPUklHX0FHRSkgfSk7CiAgICAgICAgICAgIGwgPSAoTGlzdCkgcS5leGVj\ndXRlKG5ldyBPYmplY3RbXXsgT1JJR19OQU1FLAogICAgICAgICAgICAgICAg\nbmV3IEludGVnZXIoT1JJR19BR0UpIH0pOwogICAgICAgICAgICBpdGVyYXRl\nKGwpOwogICAgICAgICAgICBxMnAxID0gU3lzdGVtLmN1cnJlbnRUaW1lTWls\nbGlzKCkgLSBzdGFydDsKCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhvcmln\nU2l6ZSwgbC5zaXplKCkpOwoKICAgICAgICAgICAgc3RhcnQgPSBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgbDIgPSAoTGlzdCkg\ncS5leGVjdXRlKG5ldyBPYmplY3RbXXsgT1JJR19OQU1FLAogICAgICAgICAg\nICAgICAgbmV3IEludGVnZXIoT1JJR19BR0UpIH0pOwogICAgICAgICAgICBp\ndGVyYXRlKGwyKTsKICAgICAgICAgICAgcTJwMiA9IFN5c3RlbS5jdXJyZW50\nVGltZU1pbGxpcygpIC0gc3RhcnQ7CgogICAgICAgICAgICBhc3NlcnRFcXVh\nbHMob3JpZ1NpemUsIGwyLnNpemUoKSk7CiAgICAgICAgICAgIC8vIFN5c3Rl\nbS5vdXQucHJpbnRsbiAoImluQ2FjaGU6ICIgKyBpbkNhY2hlICsgIjtcdCBx\nMXAxOiAiICsgcTFwMQogICAgICAgICAgICAvLyArICI7XHQgcTFwMjogIiAr\nIHExcDIgKyAiO1x0IHEycDE6ICIgKyBxMnAxICsgIjtcdCBxMnAyOiAiCiAg\nICAgICAgICAgIC8vICsgcTJwMik7CiAgICAgICAgfQogICAgICAgIGZpbmFs\nbHkgewogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3ROb25DYWNoZWFibGVDbGFzcygpIHsKICAg\nICAgICBCcm9rZXIgYnJva2VyID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2Vy\nRmFjdG9yeShmYWN0b3J5KS5uZXdCcm9rZXIoKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IHEg\nPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBKUFFMUGFyc2Vy\nLkxBTkdfSlBRTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAgICAgICAgICAg\nKyBDYWNoZU9iamVjdEIuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpICsgIiBhIik7\nCgogICAgICAgICAgICBDb2xsZWN0aW9uIGMgPSAoQ29sbGVjdGlvbikgcS5l\neGVjdXRlKCk7CiAgICAgICAgICAgIGl0ZXJhdGUoYyk7CgogICAgICAgICAg\nICAvLyBRdWVyeSByZXN1bHRzIGFyZSBubyBsb25nZXIgZGVwZW5kZW50IG9u\nIGNhY2hlYWJpbGl0eSBvZiBhbiBlbnRpdHkuCiAgICAgICAgICAgIGFzc2Vy\ndEluQ2FjaGUocSwgQm9vbGVhbi5UUlVFKTsKICAgICAgICB9CiAgICAgICAg\nZmluYWxseSB7CiAgICAgICAgICAgIGNsb3NlKGJyb2tlcik7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb25DYWNoZWFibGVBY2Nl\nc3NQYXRoKCkgewogICAgICAgIEJyb2tlciBicm9rZXIgPSBKUEFGYWNhZGVI\nZWxwZXIudG9Ccm9rZXJGYWN0b3J5KGZhY3RvcnkpLm5ld0Jyb2tlcigpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5uZXdRdWVyeSgKICAgICAgICAgICAg\nICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEgRlJPTSAiCiAg\nICAgICAgICAgICAgICArIENhY2hlT2JqZWN0QS5jbGFzcy5nZXRTaW1wbGVO\nYW1lKCkKICAgICAgICAgICAgICAgICsgIiBhIHdoZXJlIGEucmVsYXRlZEIu\nc3RyID0gJ2ZvbyciKTsKICAgICAgICAgICAgLy8gInJlbGF0ZWRCLnN0ciA9\nPSAnZm9vJyIpOwogICAgICAgICAgICBxLnNldENhbmRpZGF0ZUV4dGVudChi\ncm9rZXIubmV3RXh0ZW50KENhY2hlT2JqZWN0QS5jbGFzcywgZmFsc2UpKTsK\nCiAgICAgICAgICAgIENvbGxlY3Rpb24gYyA9IChDb2xsZWN0aW9uKSBxLmV4\nZWN1dGUoKTsKICAgICAgICAgICAgaXRlcmF0ZShjKTsKCiAgICAgICAgIC8v\nIFF1ZXJ5IHJlc3VsdHMgYXJlIG5vIGxvbmdlciBkZXBlbmRlbnQgb24gY2Fj\naGVhYmlsaXR5IG9mIGFuIGVudGl0eS4KICAgICAgICAgICAgYXNzZXJ0SW5D\nYWNoZShxLCBCb29sZWFuLlRSVUUpOwogICAgICAgIH0KICAgICAgICBmaW5h\nbGx5IHsKICAgICAgICAgICAgY2xvc2UoYnJva2VyKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdE5vbkNhY2hlYWJsZVN1YmNsYXNz\nZXMxKCkgewogICAgICAgIEJyb2tlciBicm9rZXIgPSBKUEFGYWNhZGVIZWxw\nZXIudG9Ccm9rZXJGYWN0b3J5KGZhY3RvcnkpLm5ld0Jyb2tlcigpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGEgcXVlcnkgb24gdGhlIENhY2hl\nT2JqZWN0QSBjbGFzcyBpbmNsdWRlcyBhbiB1bmNhY2hlYWJsZQogICAgICAg\nICAgICAvLyBjbGFzczsgaXQgc2hvdWxkIHRoZXJlZm9yZSBub3QgYmUgY2Fj\naGVhYmxlLgogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLlF1ZXJ5IHEgPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBK\nUFFMUGFyc2VyLkxBTkdfSlBRTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAg\nICAgICAgICAgKyBDYWNoZU9iamVjdEEuY2xhc3MuZ2V0U2ltcGxlTmFtZSgp\nICsgIiBhIik7CgogICAgICAgICAgICBDb2xsZWN0aW9uIGMgPSAoQ29sbGVj\ndGlvbikgcS5leGVjdXRlKCk7CiAgICAgICAgICAgIGl0ZXJhdGUoYyk7Cgog\nICAgICAgICAgICBhc3NlcnRJbkNhY2hlKHEsIEJvb2xlYW4uRkFMU0UpOwog\nICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgY2xvc2Uo\nYnJva2VyKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndE5vbkNhY2hlYWJsZVN1YmNsYXNzZXMyKCkgewogICAgICAgIEJyb2tlciBi\ncm9rZXIgPSBKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJGYWN0b3J5KGZhY3Rv\ncnkpLm5ld0Jyb2tlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8v\nIGEgcXVlcnkgb24gdGhlIENhY2hlT2JqZWN0QSBleHRlbnQgY29uZmlndXJl\nZCB3aXRob3V0CiAgICAgICAgICAgIC8vIHN1YmNsYXNzZXMgZG9lcyBub3Qg\naW5jbHVkZSBhbiB1bmNhY2hlYWJsZSBjbGFzczsgaXQgc2hvdWxkCiAgICAg\nICAgICAgIC8vIHRoZXJlZm9yZSBiZSBjYWNoZWFibGUuCiAgICAgICAgICAg\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5u\nZXdRdWVyeSgKICAgICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFM\nLCAic2VsZWN0IGEgZnJvbSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2Jq\nZWN0QS5jbGFzcy5nZXRTaW1wbGVOYW1lKCkgKyAiIGEiKTsKICAgICAgICAg\nICAgcS5zZXRDYW5kaWRhdGVFeHRlbnQoYnJva2VyLm5ld0V4dGVudChDYWNo\nZU9iamVjdEEuY2xhc3MsIGZhbHNlKSk7CgogICAgICAgICAgICBDb2xsZWN0\naW9uIGMgPSAoQ29sbGVjdGlvbikgcS5leGVjdXRlKCk7CiAgICAgICAgICAg\nIGl0ZXJhdGUoYyk7CgogICAgICAgICAgICBhc3NlcnRJbkNhY2hlKHEsIEJv\nb2xlYW4uVFJVRSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAg\nICAgICAgICBjbG9zZShicm9rZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0Q2FjaGVOYW1lcygpIHsKICAgICAgICBhc3NlcnRD\nYWNoZU5hbWUoQ2FjaGVPYmplY3RBLmNsYXNzLCBEYXRhQ2FjaGUuTkFNRV9E\nRUZBVUxUKTsKICAgICAgICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RB\nQ2hpbGQxLmNsYXNzLCBEYXRhQ2FjaGUuTkFNRV9ERUZBVUxUKTsKICAgICAg\nICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RBQ2hpbGQyLmNsYXNzLCBu\ndWxsKTsKICAgICAgICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RCLmNs\nYXNzLCBudWxsKTsKICAgICAgICAvKgogICAgICAgICAqIER1ZSB0byB0aGUg\ncHJvYmxlbSBkb2N1bWVudGVkIGluIHRoZSBzZXR1cCgpIHJvdXRpbmUsIHRo\nZSBmb2xsb3dpbmcgdGVzdHMgYXJlIG5vdCB2YWxpZC4uLgogICAgICAgICAq\nLwovLyAgICAgICAgYXNzZXJ0Q2FjaGVOYW1lKENhY2hlT2JqZWN0QkNoaWxk\nMS5jbGFzcywgbnVsbCk7Ly8gc3ViLWNsYXNzZXMgc2hvdWxkIGluaGVyaXQg\ncGFyZW50J3MgQENhY2hlYWJsZSBzZXR0aW5nCi8vICAgICAgICBhc3NlcnRD\nYWNoZU5hbWUoQ2FjaGVPYmplY3RDLmNsYXNzLCAibm90LXRoZS1kZWZhdWx0\nLWNhY2hlIik7IG11bHRpcGxlIGRhdGFjYWNoZSBpbnN0YW50aWF0aW9uIG5v\ndCB3b3JraW5nLi4uCi8vICAgICAgICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVP\nYmplY3RELmNsYXNzLCAibm90LXRoZS1kZWZhdWx0LWNhY2hlIik7CiAgICAg\nICAgYXNzZXJ0Q2FjaGVOYW1lKENhY2hlT2JqZWN0RS5jbGFzcywgRGF0YUNh\nY2hlLk5BTUVfREVGQVVMVCk7CiAgICAgICAgYXNzZXJ0Q2FjaGVOYW1lKENh\nY2hlT2JqZWN0Ri5jbGFzcywgRGF0YUNhY2hlLk5BTUVfREVGQVVMVCk7CiAg\nICAgICAgYXNzZXJ0Q2FjaGVOYW1lKENhY2hlT2JqZWN0Ry5jbGFzcywgRGF0\nYUNhY2hlLk5BTUVfREVGQVVMVCk7CiAgICAgICAgYXNzZXJ0Q2FjaGVOYW1l\nKENhY2hlT2JqZWN0SC5jbGFzcywgRGF0YUNhY2hlLk5BTUVfREVGQVVMVCk7\nCiAgICAgICAgYXNzZXJ0Q2FjaGVOYW1lKENhY2hlT2JqZWN0Si5jbGFzcywg\nRGF0YUNhY2hlLk5BTUVfREVGQVVMVCk7CiAgICAgICAgYXNzZXJ0Q2FjaGVO\nYW1lKEFwcElkQ2FjaGVPYmplY3QuY2xhc3MsIERhdGFDYWNoZS5OQU1FX0RF\nRkFVTFQpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhc3NlcnRDYWNoZU5h\nbWUoQ2xhc3MgY2xzLCBTdHJpbmcgY2FjaGVOYW1lKSB7CiAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVscGVyLmdldE1ldGFEYXRh\nKGZhY3RvcnksIGNscyk7CiAgICAgICAgaWYgKGNhY2hlTmFtZSA9PSBudWxs\nKQogICAgICAgICAgICBhc3NlcnROdWxsKG1ldGEuZ2V0RGF0YUNhY2hlKCkp\nOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBhc3NlcnROb3ROdWxsKG1l\ndGEuZ2V0RGF0YUNhY2hlKCkpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\nY2FjaGVOYW1lLCBtZXRhLmdldERhdGFDYWNoZSgpLmdldE5hbWUoKSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8vIEZJWE1FIFNlZXRoYSBTZXAgMjYsMjAw\nNgogICAgLy8gbm90IGFibGUgdG8gcmVwbGFjZSBwbS5uZXdRdWVyeShDYWNo\nZU9iamVjdEEuY2xhc3MpOwogICAgLyoKICAgICAgKiBwdWJsaWMgdm9pZCB0\nZXN0UXVlcnlBZ2dyZWdhdGVzKCkgeyBQZXJzaXN0ZW5jZU1hbmFnZXIgcG0g\nPQogICAgICAqIGZhY3RvcnkuZ2V0UGVyc2lzdGVuY2VNYW5hZ2VyKCk7IHRy\neSB7IFF1ZXJ5IHEgPQogICAgICAqIHBtLm5ld1F1ZXJ5KENhY2hlT2JqZWN0\nQS5jbGFzcyk7IHEuc2V0UmVzdWx0KCJtYXggKGFnZSkiKTsgT2JqZWN0IG8g\nPQogICAgICAqIHEuZXhlY3V0ZSgpOyBhc3NlcnRUcnVlKCJvIG11c3QgYmUg\naW5zdGFuY2VvZiBOdW1iZXIiLCBvIGluc3RhbmNlb2YKICAgICAgKiBOdW1i\nZXIpOyB9IGZpbmFsbHkgeyBjbG9zZShwbSk7IH0gfQogICAgICAqLwoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RDYWNoZTIoKSB7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgZW0xID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTIgPSBudWxsOwogICAgICAgIERh\ndGFDYWNoZSBjYWNoZTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ2Fj\naGVPYmplY3RBIGExID0gKENhY2hlT2JqZWN0QSkgZW0xLmZpbmQoQ2FjaGVP\nYmplY3RBLmNsYXNzLCBvaWQpOwoKICAgICAgICAgICAgZW0yID0gKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5Mi5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7CiAgICAgICAgICAgIENhY2hlT2JqZWN0QSBhMiA9IChDYWNoZU9iamVj\ndEEpIGVtMi5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsKCiAgICAg\nICAgICAgIC8vIGFzc2VydCB0aGF0IHRoZSBvaWQgaXMgaW4gZmFjdG9yeTIn\ncyBjYWNoZQogICAgICAgICAgICAvL01ldGFEYXRhUmVwb3NpdG9yeSByZXBv\nczIgPSBmYWN0b3J5Mi5nZXRDb25maWd1cmF0aW9uKCkKICAgICAgICAgICAg\nLy8gICAgLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICAg\nICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvczIgPQogICAgICAgICAg\nICAgICAgKCgoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkgZmFj\ndG9yeTIpKQogICAgICAgICAgICAgICAgLmdldENvbmZpZ3VyYXRpb24oKSku\nZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAg\nQ2xhc3NNZXRhRGF0YSBtZXRhID0gcmVwb3MyCiAgICAgICAgICAgICAgICAu\nZ2V0TWV0YURhdGEoQ2FjaGVPYmplY3RBLmNsYXNzLCBlbTIuZ2V0Q2xhc3NM\nb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAgICAgIGNhY2hlID0gbWV0YS5nZXRE\nYXRhQ2FjaGUoKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShjYWNoZS5jb250\nYWlucyhvaWR3aXRoY2xhc3MpKTsKCiAgICAgICAgICAgIC8vIG1vZGlmeSB0\naGUgb2JqZWN0LgogICAgICAgICAgICBzdGFydFR4KGVtMSk7CiAgICAgICAg\nICAgIGExLnNldE5hbWUoYTEuZ2V0TmFtZSgpICsgIiBjaGFuZ2VkIik7CiAg\nICAgICAgICAgIGVuZFR4KGVtMSk7CiAgICAgICAgfQogICAgICAgIGZpbmFs\nbHkgewogICAgICAgICAgICBpZiAoZW0yICE9IG51bGwpCiAgICAgICAgICAg\nICAgICBlbmRFbShlbTIpOwogICAgICAgICAgICBlbmRFbShlbTEpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gaWYgdGhlIGNhY2hlIGlzIGEgY29oZXJlbnQg\nb25lLCB0aGVuIHRoZSBjaGFuZ2VzIHNob3VsZCBiZQogICAgICAgIC8vIHNl\nZW4uIE90aGVyd2lzZSwgdGhleSBzaG91bGQgbm90LgogICAgICAgIGlmIChp\nc0NhY2hlQ29oZXJlbnQoKSB8fCBmYWN0b3J5ID09IGZhY3RvcnkyKQogICAg\nICAgICAgICBhc3NlcnRUcnVlKCJrZXkgIiArIG9pZCArICIgd2FzIG5vdCBp\nbiBjYWNoZTsgc2hvdWxkIGhhdmUgYmVlbiIsCiAgICAgICAgICAgICAgICBj\nYWNoZS5jb250YWlucyhvaWR3aXRoY2xhc3MpKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIGFzc2VydEZhbHNlKCJrZXkgIiArIG9pZCArICIgd2FzIGlu\nIGNhY2hlOyBzaG91bGQgbm90IGhhdmUgYmVlbiIsCiAgICAgICAgICAgICAg\nICBjYWNoZS5jb250YWlucyhvaWR3aXRoY2xhc3MpKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0VGltZW91dHMxKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgdGltZW91dHNUZXN0MSgxKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0aW1lb3V0c1Rlc3QxKGludCB0cmllcykgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgLy8gdGhpcyBjcmF6eSBmb3IgbG9vcGluZyBzdHVmZiBp\ncyBoZXJlIGJlY2F1c2Ugd2UncmUgc2VlaW5nCiAgICAgICAgLy8gaW50ZXJt\naXR0ZW50IGZhaWx1cmVzIHdpdGggdGhlIGdhcmJhZ2UgY29sbGVjdG9yIGtp\nY2tpbmcgaW4KICAgICAgICAvLyBkdXJpbmcgdGVzdGluZy4gU28sIHRoaXMg\nZGVjcmVhc2VzIHRoZSBjaGFuY2VzIHRoYXQgdGhhdAogICAgICAgIC8vIHdp\nbGwgaGFwcGVuLgogICAgICAgIEV4Y2VwdGlvbiBlID0gbnVsbDsKICAgICAg\nICBpbnQgaTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdHJpZXM7IGkrKykg\newogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGltZW91dHNI\nZWxwZXIoZmFjdG9yeSk7CiAgICAgICAgICAgICAgICAvLyBhbnkgc3VjY2Vz\nc2VzIHdpbGwgcGFzcyB0aGUgdGVzdAogICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24g\nZXgpIHsKICAgICAgICAgICAgICAgIGUgPSBleDsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgdGhyb3cgZTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0VGltZW91dHMyKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgdGltZW91dHNUZXN0MigzMCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGltZW91dHNUZXN0MihpbnQgdHJpZXMpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIEVycm9yIGUgPSBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgdHJpZXM7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgdGltZW91dHNIZWxwZXIodGltZW91dEZhY3RvcnkpOwogICAg\nICAgICAgICAgICAgLy8gYW55IHN1Y2Nlc3NlcyB3aWxsIHBhc3MgdGhlIHRl\nc3QKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBjYXRjaCAoQXNzZXJ0aW9uRmFpbGVkRXJyb3IgYWZlKSB7CiAg\nICAgICAgICAgICAgICBlID0gYWZlOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICB0aHJvdyBlOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB0\naW1lb3V0c0hlbHBlcihPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgZmFj\ndG9yeSkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikg\nZmFjdG9yeQogICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAg\nICAgICAgLy8gZ2V0IHN0YXJ0aW5nIHRpbWUgZm9yIHNsZWVwIGNhbGN1bGF0\naW9ucyBiZWxvdwogICAgICAgICAgICBEYXRlIHN0YXJ0VGltZSA9IG5ldyBE\nYXRlKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBDYWNoZU9iamVjdEUg\nZSA9IG5ldyBDYWNoZU9iamVjdEUoImUiKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChlKTsKCiAgICAgICAgICAgIENhY2hlT2JqZWN0RiBmID0gbmV3IENh\nY2hlT2JqZWN0RigiZiIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGYpOwoK\nICAgICAgICAgICAgQ2FjaGVPYmplY3RHIGcgPSBuZXcgQ2FjaGVPYmplY3RH\nKCJnIik7CiAgICAgICAgICAgIGVtLnBlcnNpc3QoZyk7CgogICAgICAgICAg\nICBDYWNoZU9iamVjdEggaCA9IG5ldyBDYWNoZU9iamVjdEgoImgiKTsKICAg\nICAgICAgICAgZW0ucGVyc2lzdChoKTsKICAgICAgICAgICAgCiAgICAgICAg\nICAgIGVuZFR4KGVtKTsKCiAgICAgICAgICAgIE9iamVjdFtdIGlkcyA9IG5l\ndyBPYmplY3RbNF07CiAgICAgICAgICAgIGlkc1swXSA9IG5ldyBJZChDYWNo\nZU9iamVjdEUuY2xhc3MsIGVtLmdldE9iamVjdElkKGUpLnRvU3RyaW5nKCkp\nOwogICAgICAgICAgICBpZHNbMV0gPSBuZXcgSWQoQ2FjaGVPYmplY3RGLmNs\nYXNzLCBlbS5nZXRPYmplY3RJZChmKS50b1N0cmluZygpKTsKICAgICAgICAg\nICAgaWRzWzJdID0gbmV3IElkKENhY2hlT2JqZWN0Ry5jbGFzcywgZW0uZ2V0\nT2JqZWN0SWQoZykudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGlkc1szXSA9\nIG5ldyBJZChDYWNoZU9iamVjdEguY2xhc3MsIGVtLmdldE9iamVjdElkKGgp\nLnRvU3RyaW5nKCkpOwoKICAgICAgICAgICAgLy8gYnVpbGQgdXAgc29tZSBx\ndWVyaWVzIHRvIHRlc3QKCiAgICAgICAgICAgIC8vIHRoaXMgb25lIHNob3Vs\nZCBiZSBvbmx5IG9uIHRoZSBzdXBlcmNsYXNzLCBzaW5jZQogICAgICAgICAg\nICAvLyBDYWNoZU9iamVjdEYgaGFzIGEgdGltZW91dC4KICAgICAgICAgICAg\nQnJva2VyIGJyb2tlciA9IEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihlbSk7\nCiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkg\ncTEgPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBKUFFMUGFy\nc2VyLkxBTkdfSlBRTCwgInNlbGVjdCBhIGZyb20gIgogICAgICAgICAgICAg\nICAgKyBDYWNoZU9iamVjdEUuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpICsgIiBh\nIik7CiAgICAgICAgICAgIHExLnNldENhbmRpZGF0ZUV4dGVudChicm9rZXIu\nbmV3RXh0ZW50KENhY2hlT2JqZWN0RS5jbGFzcywgZmFsc2UpKTsKICAgICAg\nICAgICAgaXRlcmF0ZSgoQ29sbGVjdGlvbikgcTEuZXhlY3V0ZSgpKTsKICAg\nICAgICAgICAgYXNzZXJ0SW5DYWNoZShxMSwgQm9vbGVhbi5UUlVFKTsKCiAg\nICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcTIg\nPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBKUFFMUGFyc2Vy\nLkxBTkdfSlBRTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAgICAgICAgICAg\nKyBDYWNoZU9iamVjdEYuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpICsgIiBhIik7\nCiAgICAgICAgICAgIGl0ZXJhdGUoKENvbGxlY3Rpb24pIHEyLmV4ZWN1dGUo\nKSk7CiAgICAgICAgICAgIGFzc2VydEluQ2FjaGUocTIsIEJvb2xlYW4uVFJV\nRSk7CgogICAgICAgICAgICBEYXRlIGN1cnJlbnRUaW1lID0gbmV3IERhdGUo\nKTsKICAgICAgICAgICAgbG9uZyBkaWZmID0gKGN1cnJlbnRUaW1lLmdldFRp\nbWUoKSAtIHN0YXJ0VGltZS5nZXRUaW1lKCkpOwogICAgICAgICAgICBsb25n\nIHNsZWVwID0gMDsKICAgICAgICAgICAgCiAgICAgICAgICAgIGdldExvZygp\nLmluZm8oIkNhY2hlVGVzdC50aW1lb3V0c0hlbHBlcigpIHRlc3RpbmcgYWxs\nIGFyZSBzdGlsbCBpbiB0aGUgY2FjaGUsIGVsYXBzZWQgdGltZT0iK2RpZmYp\nOwogICAgICAgICAgICBEYXRhQ2FjaGUgY2FjaGUgPSBjYWNoZU1hbmFnZXIo\nZmFjdG9yeSkuZ2V0RGF0YUNhY2hlKAogICAgICAgICAgICAgICAgRGF0YUNh\nY2hlLk5BTUVfREVGQVVMVCwgZmFsc2UpOwogICAgICAgICAgICBpZiAoZGlm\nZiA8IDUwMCkgewogICAgICAgICAgICAgICAgLy8gYWxsIHNob3VsZCBzdGls\nbCBiZSBpbiB0aGUgY2FjaGUKICAgICAgICAgICAgICAgIGNoZWNrQ2FjaGUo\nY2FjaGUsIGlkcywgbmV3IGJvb2xlYW5bXXsgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwg\ndHJ1ZSB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nIC8vIG5lZWQgdG8gc2tpcCB0aGUgdGVzdCBvbiBzbG93IHN5c3RlbXMgb3Ig\nd2hlbiB1c2luZyByZW1vdGUgREIgY29ubmVjdGlvbnMKICAgICAgICAgICAg\nICAgIGdldExvZygpLndhcm4oIkNhY2hlVGVzdC50aW1lb3V0c0hlbHBlcigp\nIHNraXBwaW5nIGNoZWNrQ2FjaGUoYWxsLCA8NTAwKSBiZWNhdXNlIGRpZmY9\nIitkaWZmKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAg\nICAgLy8gc2hvdWxkIGNhdXNlIGggdG8gYmUgZHJvcHBlZCAodGltZW91dD01\nMDApCiAgICAgICAgICAgIGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKTsKICAg\nICAgICAgICAgZGlmZiA9IChjdXJyZW50VGltZS5nZXRUaW1lKCkgLSBzdGFy\ndFRpbWUuZ2V0VGltZSgpKTsKICAgICAgICAgICAgc2xlZXAgPSA3NTAgLSBk\naWZmOwogICAgICAgICAgICBpZiAoc2xlZXAgPiAwKSB7CiAgICAgICAgICAg\nICAgICBnZXRMb2coKS5pbmZvKCJDYWNoZVRlc3QudGltZW91dHNIZWxwZXIo\nKSB0ZXN0aW5nIGggdG8gYmUgZHJvcHBlZCBieSB3YWl0aW5nIHNsZWVwPSIr\nc2xlZXApOwogICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQo\nKS5zbGVlcChzbGVlcCk7CiAgICAgICAgICAgICAgICBUaHJlYWQueWllbGQo\nKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNsZWVw\nID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoKGRpZmYgKyBz\nbGVlcCkgPCA5NTApIHsKICAgICAgICAgICAgICAgIC8vIG9ubHkgaCBzaG91\nbGQgYmUgZHJvcHBlZAogICAgICAgICAgICAgICAgY2hlY2tDYWNoZShjYWNo\nZSwgaWRzLCBuZXcgYm9vbGVhbltdeyB0cnVlLCB0cnVlLCB0cnVlLCBmYWxz\nZSB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8v\nIG5lZWQgdG8gc2tpcCB0aGUgdGVzdCBvbiBzbG93IHN5c3RlbXMgb3Igd2hl\nbiB1c2luZyByZW1vdGUgREIgY29ubmVjdGlvbnMKICAgICAgICAgICAgICAg\nIGdldExvZygpLndhcm4oIkNhY2hlVGVzdC50aW1lb3V0c0hlbHBlcigpIHNr\naXBwaW5nIGNoZWNrQ2FjaGUoaD01MDApIGJlY2F1c2UgZGlmZj0iKyhkaWZm\nK3NsZWVwKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGlmIHRo\naXMgcnVuIGhhcyBhIGRlZmF1bHQgdGltZW91dCAoc2V0IHRvIDEgc2VjIGlu\nIHRoZSB0ZXN0CiAgICAgICAgICAgIC8vIGNhc2UpLCBlIHNob3VsZCBiZSB0\naW1lZCBvdXQgYnkgdGhpcyBwb2ludC4KICAgICAgICAgICAgLy9ib29sZWFu\nIGVTdGF0dXMgPQogICAgICAgICAgICAvLyAgICAhKGZhY3RvcnkuZ2V0Q29u\nZmlndXJhdGlvbigpLmdldERhdGFDYWNoZVRpbWVvdXQoKSA+IDApOwogICAg\nICAgICAgICBib29sZWFuIGVTdGF0dXMgPSAhKCgoKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeVNQSSkgZmFjdG9yeSkKICAgICAgICAgICAgICAgICAg\nICAuZ2V0Q29uZmlndXJhdGlvbigpKS5nZXREYXRhQ2FjaGVUaW1lb3V0KCkg\nPiAwKTsKCiAgICAgICAgICAgIC8vIHNob3VsZCBjYXVzZSBmIHRvIGJlIGRy\nb3BwZWQgKHRpbWVvdXQ9MTAwMCkKICAgICAgICAgICAgY3VycmVudFRpbWUg\nPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICBkaWZmID0gY3VycmVudFRpbWUu\nZ2V0VGltZSgpIC0gc3RhcnRUaW1lLmdldFRpbWUoKTsKICAgICAgICAgICAg\nc2xlZXAgPSAyMDAwIC0gZGlmZjsKICAgICAgICAgICAgaWYgKHNsZWVwID4g\nMCkgewogICAgICAgICAgICAgICAgZ2V0TG9nKCkuaW5mbygiQ2FjaGVUZXN0\nLnRpbWVvdXRzSGVscGVyKCkgdGVzdGluZyBmIHRvIGJlIGRyb3BwZWQgYnkg\nd2FpdGluZyBzbGVlcD0iK3NsZWVwKTsKICAgICAgICAgICAgICAgIFRocmVh\nZC5jdXJyZW50VGhyZWFkKCkuc2xlZXAoc2xlZXApOwogICAgICAgICAgICAg\nICAgVGhyZWFkLnlpZWxkKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICBzbGVlcCA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgaWYgKChkaWZmICsgc2xlZXApIDwgNDkwMCkgewogICAgICAgICAgICAg\nICAgLy8gZSBpcyBjb25kaXRpb25hbCwgaCBhbmQgZiBzaG91bGQgYmUgZHJv\ncHBlZCwgYnV0IG5vdCBnIHlldAogICAgICAgICAgICAgICAgY2hlY2tDYWNo\nZShjYWNoZSwgaWRzLCBuZXcgYm9vbGVhbltdeyBlU3RhdHVzLCBmYWxzZSwg\ndHJ1ZSwgZmFsc2UgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAvLyBuZWVkIHRvIHNraXAgdGhlIHRlc3Qgb24gc2xvdyBzeXN0\nZW1zIG9yIHdoZW4gdXNpbmcgcmVtb3RlIERCIGNvbm5lY3Rpb25zCiAgICAg\nICAgICAgICAgICBnZXRMb2coKS53YXJuKCJDYWNoZVRlc3QudGltZW91dHNI\nZWxwZXIoKSBza2lwcGluZyBjaGVja0NhY2hlKGY9MTAwMCkgYmVjYXVzZSBk\naWZmPSIrKGRpZmYrc2xlZXApKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gYXQgdGhpcyBwb2ludCwgcTIgc2hvdWxkIGJlIGRyb3BwZWQgKGJl\nY2F1c2UgaXRzIGNhbmRpZGF0ZQogICAgICAgICAgICAvLyBjbGFzcyBpcyBD\nYWNoZU9iamVjdEYpLCBhbmQgcTEgbWlnaHQgYmUgZHJvcHBlZCwgZGVwZW5k\naW5nCiAgICAgICAgICAgIC8vIG9uIHdoZXRoZXIgb3Igbm90IHdlJ3ZlIGdv\ndCBhIHRpbWVvdXQgY29uZmlndXJlZC4KICAgICAgICAgICAgYXNzZXJ0SW5D\nYWNoZShxMSwgKGVTdGF0dXMpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5G\nQUxTRSk7CiAgICAgICAgICAgIGFzc2VydEluQ2FjaGUocTIsIEJvb2xlYW4u\nRkFMU0UpOwoKICAgICAgICAgICAgLy8gc2hvdWxkIGNhdXNlIGcgdG8gYmUg\nZHJvcHBlZCAodGltZW91dD01MDAwKQogICAgICAgICAgICBjdXJyZW50VGlt\nZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIGRpZmYgPSBjdXJyZW50VGlt\nZS5nZXRUaW1lKCkgLSBzdGFydFRpbWUuZ2V0VGltZSgpOwogICAgICAgICAg\nICBzbGVlcCA9IDYwMDAgLSBkaWZmOwogICAgICAgICAgICBpZiAoc2xlZXAg\nPiAwKSB7CiAgICAgICAgICAgICAgICBnZXRMb2coKS5pbmZvKCJDYWNoZVRl\nc3QudGltZW91dHNIZWxwZXIoKSB0ZXN0aW5nIGcgdG8gYmUgZHJvcHBlZCBi\neSB3YWl0aW5nIHNsZWVwPSIrc2xlZXApOwogICAgICAgICAgICAgICAgVGhy\nZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVlcChzbGVlcCk7CiAgICAgICAgICAg\nICAgICBUaHJlYWQueWllbGQoKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICAvLyBhbGwgb2YgdGhlbSBzaG91bGQgYmUgZHJvcHBlZCBub3csIHNpbmNl\nIGRpZmYgPiA1MDAwCiAgICAgICAgICAgIGNoZWNrQ2FjaGUoY2FjaGUsIGlk\ncywgbmV3IGJvb2xlYW5bXXsgZVN0YXR1cywgZmFsc2UsIGZhbHNlLCBmYWxz\nZSB9KTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAg\nIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFF1ZXJ5VGltZW91dHMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBxdWVyeVRpbWVvdXRzSGVscGVyKGZhY3RvcnkpOwogICAgICAgIHF1ZXJ5\nVGltZW91dHNIZWxwZXIodGltZW91dEZhY3RvcnkpOwogICAgfQoKICAgIHBy\naXZhdGUgdm9pZCBxdWVyeVRpbWVvdXRzSGVscGVyKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBmYWN0b3J5KQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3Rh\ncnRUeChlbSk7CgogICAgICAgICAgICAvLyBnZXQgc3RhcnRpbmcgdGltZSBm\nb3Igc2xlZXAgY2FsY3VsYXRpb25zIGJlbG93CiAgICAgICAgICAgIERhdGUg\nc3RhcnRUaW1lID0gbmV3IERhdGUoKTsKCiAgICAgICAgICAgIENhY2hlT2Jq\nZWN0RSBlID0gbmV3IENhY2hlT2JqZWN0RSgiZSIpOwogICAgICAgICAgICBl\nbS5wZXJzaXN0KGUpOwoKICAgICAgICAgICAgQ2FjaGVPYmplY3RGIGYgPSBu\nZXcgQ2FjaGVPYmplY3RGKCJmIik7CiAgICAgICAgICAgIGVtLnBlcnNpc3Qo\nZik7CgogICAgICAgICAgICBlbmRUeChlbSk7CgogICAgICAgICAgICAvLyBi\ndWlsZCB1cCBzb21lIHF1ZXJpZXMgdG8gdGVzdAogICAgICAgICAgICBCcm9r\nZXIgYnJva2VyID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVtKTsKICAg\nICAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxMSA9\nIGJyb2tlcgogICAgICAgICAgICAgICAgLm5ld1F1ZXJ5KEpQUUxQYXJzZXIu\nTEFOR19KUFFMLCAiU0VMRUNUIGEgRlJPTSBDYWNoZU9iamVjdEUgYSIpOwoK\nICAgICAgICAgICAgcTEuc2V0Q2FuZGlkYXRlRXh0ZW50KGJyb2tlci5uZXdF\neHRlbnQoQ2FjaGVPYmplY3RFLmNsYXNzLCBmYWxzZSkpOwogICAgICAgICAg\nICBpdGVyYXRlKChDb2xsZWN0aW9uKSBxMS5leGVjdXRlKCkpOwogICAgICAg\nICAgICBhc3NlcnRJbkNhY2hlKHExLCBCb29sZWFuLlRSVUUpOwoKICAgICAg\nICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxMiA9IGJy\nb2tlcgogICAgICAgICAgICAgICAgLm5ld1F1ZXJ5KEpQUUxQYXJzZXIuTEFO\nR19KUFFMLCAiU0VMRUNUIGEgRlJPTSBDYWNoZU9iamVjdEYgYSIpOwogICAg\nICAgICAgICBpdGVyYXRlKChDb2xsZWN0aW9uKSBxMi5leGVjdXRlKCkpOwog\nICAgICAgICAgICBhc3NlcnRJbkNhY2hlKHEyLCBCb29sZWFuLlRSVUUpOwoK\nICAgICAgICAgICAgLy8gaWYgdGhpcyBydW4gaGFzIGEgZGVmYXVsdCB0aW1l\nb3V0IChzZXQgdG8gMSBzZWMgaW4gdGhlIHRlc3QKICAgICAgICAgICAgLy8g\nY2FzZSksIGUgc2hvdWxkIGJlIHRpbWVkIG91dCBieSB0aGlzIHBvaW50Lgog\nICAgICAgICAgICAvL2Jvb2xlYW4gZVRpbWVkT3V0ID0KICAgICAgICAgICAg\nLy8gICAgZmFjdG9yeS5nZXRDb25maWd1cmF0aW9uKCkuZ2V0RGF0YUNhY2hl\nVGltZW91dCgpID4gMDsKICAgICAgICAgICAgYm9vbGVhbiBlVGltZWRPdXQg\nPQogICAgICAgICAgICAgICAgKCgoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSSkgZmFjdG9yeSkuZ2V0Q29uZmlndXJhdGlvbigpKQogICAgICAg\nICAgICAgICAgICAgIC5nZXREYXRhQ2FjaGVUaW1lb3V0KCkgPiAwKTsKCiAg\nICAgICAgICAgIC8vIHNob3VsZCBjYXVzZSBmIHRvIGJlIGRyb3BwZWQuCiAg\nICAgICAgICAgIERhdGUgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpOwogICAg\nICAgICAgICBsb25nIGRpZmYgPSBjdXJyZW50VGltZS5nZXRUaW1lKCkgLSBz\ndGFydFRpbWUuZ2V0VGltZSgpOwogICAgICAgICAgICBsb25nIHNsZWVwID0g\nMjAwMCAtIGRpZmY7CiAgICAgICAgICAgIGlmIChzbGVlcCA+IDApIHsKICAg\nICAgICAgICAgICAgIGdldExvZygpLnRyYWNlKCJDYWNoZVRlc3QucXVlcnlU\naW1lb3V0c0hlbHBlcigpIHRlc3RpbmcgZiB0byBiZSBkcm9wcGVkIGJ5IHdh\naXRpbmcgc2xlZXA9IitzbGVlcCk7CiAgICAgICAgICAgICAgICBUaHJlYWQu\nY3VycmVudFRocmVhZCgpLnNsZWVwKHNsZWVwKTsKICAgICAgICAgICAgICAg\nIFRocmVhZC55aWVsZCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAv\nLyBhdCB0aGlzIHBvaW50LCBxMiBzaG91bGQgYmUgZHJvcHBlZCAoYmVjYXVz\nZSBpdHMgY2FuZGlkYXRlCiAgICAgICAgICAgIC8vIGNsYXNzIGlzIENhY2hl\nT2JqZWN0RiksIGFuZCBxMSBtaWdodCBiZSBkcm9wcGVkLCBkZXBlbmRpbmcK\nICAgICAgICAgICAgLy8gb24gd2hldGhlciBvciBub3Qgd2UndmUgZ290IGEg\ndGltZW91dCBjb25maWd1cmVkLgogICAgICAgICAgICBhc3NlcnRJbkNhY2hl\nKHExLCAoZVRpbWVkT3V0KSA/IEJvb2xlYW4uRkFMU0UgOiBCb29sZWFuLlRS\nVUUpOwogICAgICAgICAgICBhc3NlcnRJbkNhY2hlKHEyLCBCb29sZWFuLkZB\nTFNFKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAg\nIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFF1ZXJ5SW1wbGljaXRFdmljdGlvbnMoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBB\nRW50aXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFJ1bnRp\nbWVUZXN0MVtdIGhlbHBlck9ianMgPSBuZXcgUnVudGltZVRlc3QxWzVdOwog\nICAgICAgICAgICBoZWxwZXJPYmpzWzBdID0gbmV3IFJ1bnRpbWVUZXN0MSgp\nOwogICAgICAgICAgICBoZWxwZXJPYmpzWzFdID0gbmV3IFJ1bnRpbWVUZXN0\nMSgpOwogICAgICAgICAgICBoZWxwZXJPYmpzWzJdID0gbmV3IFJ1bnRpbWVU\nZXN0MSgpOwogICAgICAgICAgICBoZWxwZXJPYmpzWzNdID0gbmV3IFJ1bnRp\nbWVUZXN0MSgpOwogICAgICAgICAgICBoZWxwZXJPYmpzWzRdID0gbmV3IFJ1\nbnRpbWVUZXN0MSgpOwogICAgICAgICAgICBzdGFydFR4KGVtKTsKICAgICAg\nICAgICAgZW0ucGVyc2lzdChoZWxwZXJPYmpzWzBdKTsKICAgICAgICAgICAg\nZW0ucGVyc2lzdChoZWxwZXJPYmpzWzFdKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChoZWxwZXJPYmpzWzJdKTsKICAgICAgICAgICAgZW0ucGVyc2lzdCho\nZWxwZXJPYmpzWzNdKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChoZWxwZXJP\nYmpzWzRdKTsKICAgICAgICAgICAgZW5kVHgoZW0pOwoKICAgICAgICAgICAg\nRGF0YUNhY2hlIGNhY2hlID0gY2FjaGVNYW5hZ2VyKGZhY3RvcnkpLmdldERh\ndGFDYWNoZSgKICAgICAgICAgICAgICAgIERhdGFDYWNoZS5OQU1FX0RFRkFV\nTFQsIGZhbHNlKTsKCiAgICAgICAgICAgIGlmICghaXNPcGVuSlBBQ2FjaGUo\nY2FjaGUpKSB7CiAgICAgICAgICAgICAgICBidWcoNjI3LCAiVGFuZ29zb2wg\nY2FjaGUgaW1wbCBuZWVkcyBtb2Rlcm5pemF0aW9uIik7CiAgICAgICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChj\nYWNoZSBpbnN0YW5jZW9mIERlbGVnYXRpbmdEYXRhQ2FjaGUpCiAgICAgICAg\nICAgICAgICBjYWNoZSA9ICgoRGVsZWdhdGluZ0RhdGFDYWNoZSkgY2FjaGUp\nLmdldElubmVybW9zdERlbGVnYXRlKCk7CiAgICAgICAgICAgIGlmIChjYWNo\nZSBpbnN0YW5jZW9mIENvbmN1cnJlbnREYXRhQ2FjaGUpIHsKICAgICAgICAg\nICAgICAgIENhY2hlTWFwIG1hcCA9ICgoQ29uY3VycmVudERhdGFDYWNoZSkg\nY2FjaGUpLmdldENhY2hlTWFwKCk7CiAgICAgICAgICAgICAgICBtYXAuc2V0\nQ2FjaGVTaXplKDMpOwogICAgICAgICAgICAgICAgbWFwLnNldFNvZnRSZWZl\ncmVuY2VTaXplKDApOwogICAgICAgICAgICB9IAoKICAgICAgICAgICAgc3Rh\ncnRUeChlbSk7CiAgICAgICAgICAgIENhY2hlT2JqZWN0SCBoID0gbmV3IENh\nY2hlT2JqZWN0SCgiaCIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGgpOwog\nICAgICAgICAgICBDYWNoZU9iamVjdEogaiA9IG5ldyBDYWNoZU9iamVjdEoo\nImoiLCBoKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChqKTsKICAgICAgICAg\nICAgZW5kVHgoZW0pOwogICAgICAgICAgICBPYmplY3QgaG9pZCA9IGVtLmdl\ndE9iamVjdElkKGgpOwogICAgICAgICAgICBPYmplY3Qgam9pZCA9IGVtLmdl\ndE9iamVjdElkKGopOwoKICAgICAgICAgICAgT2JqZWN0IGhvaWR3aXRoY2xh\nc3MgPSBuZXcgSWQoQ2FjaGVPYmplY3RILmNsYXNzLCBob2lkLnRvU3RyaW5n\nKCkpOwogICAgICAgICAgICBPYmplY3Qgam9pZHdpdGhjbGFzcyA9IG5ldyBJ\nZChDYWNoZU9iamVjdEouY2xhc3MsIGpvaWQudG9TdHJpbmcoKSk7CiAgICAg\nICAgICAgIGVuZEVtKGVtKTsKCiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBq\nIGFuZCBoIGFyZSBpbiBjYWNoZTsgbWF5IG5vdCBiZSBpZiBub3QgTFJVCiAg\nICAgICAgICAgIGludCBhdHRlbXB0cyA9IDA7CiAgICAgICAgICAgIGZvciAo\nOyBhdHRlbXB0cyA8IDEwMCAmJiAhY2FjaGUuY29udGFpbnMoam9pZHdpdGhj\nbGFzcyk7IGF0dGVtcHRzKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAg\nICAgIGVtID0gZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgICAgICAgICBpZiAoIWNhY2hlLmNvbnRhaW5zKGhvaWR3aXRoY2xhc3Mp\nKQogICAgICAgICAgICAgICAgICAgIGVtLmZpbmQoQ2FjaGVPYmplY3RILmNs\nYXNzLCBob2lkKTsKICAgICAgICAgICAgICAgIGlmICghY2FjaGUuY29udGFp\nbnMoam9pZHdpdGhjbGFzcykpCiAgICAgICAgICAgICAgICAgICAgZW0uZmlu\nZChDYWNoZU9iamVjdEouY2xhc3MsIGpvaWQpOwogICAgICAgICAgICAgICAg\nZW5kRW0oZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFzc2VydFRy\ndWUoIkNvdWxkIG5vdCBnZXQgcXVlcmllZCBvYmplY3RzIGludG8gY2FjaGUi\nLAogICAgICAgICAgICAgICAgYXR0ZW1wdHMgPCAxMDApOwoKICAgICAgICAg\nICAgLy8gYnVpbGQgdXAgYSBxdWVyeSB0aGF0IHVzZXMgSCBpbiBpdHMgYWNj\nZXNzIHBhdGguLi4KICAgICAgICAgICAgZW0gPSBmYWN0b3J5LmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAgQnJva2VyIGJyb2tlciA9IEpQ\nQUZhY2FkZUhlbHBlci50b0Jyb2tlcihlbSk7CiAgICAgICAgICAgIG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5uZXdRdWVy\neSgKICAgICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAiU2Vs\nZWN0IGEgRlJPTSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0Si5j\nbGFzcy5nZXRTaW1wbGVOYW1lKCkKICAgICAgICAgICAgICAgICsgIiBhIHdo\nZXJlIGEuc3RyID0gJ2gnIik7CiAgICAgICAgICAgIGl0ZXJhdGUoKENvbGxl\nY3Rpb24pIHEuZXhlY3V0ZSgpKTsKICAgICAgICAgICAgYXNzZXJ0SW5DYWNo\nZShxLCBCb29sZWFuLlRSVUUpOwogICAgICAgICAgICBlbmRFbShlbSk7Cgog\nICAgICAgICAgICAvLyBmb3JjZSBoIG91dCBvZiB0aGUgY2FjaGUuIHdlIG1p\nZ2h0IGhhdmUgdG8gdHJ5IG11bHRpcGxlIHRpbWVzCiAgICAgICAgICAgIC8v\nIGlmIHRoZSBjYWNoZSBpcyBub3QgTFJVCiAgICAgICAgICAgIGF0dGVtcHRz\nID0gMDsKICAgICAgICAgICAgZm9yICg7IGF0dGVtcHRzIDwgMTAwICYmIGNh\nY2hlLmNvbnRhaW5zKGpvaWR3aXRoY2xhc3MpOyBhdHRlbXB0cysrKQogICAg\nICAgICAgICB7CiAgICAgICAgICAgICAgICBlbSA9IGZhY3RvcnkuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCA1OyBpKyspCiAgICAgICAgICAgICAgICAgICAgZW0uZmluZChS\ndW50aW1lVGVzdDEuY2xhc3MsIGVtLmdldE9iamVjdElkKGhlbHBlck9ianNb\naV0pKTsKICAgICAgICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBhc3NlcnRUcnVlKCJDb3VsZCBub3Qga2ljayBxdWVy\naWVkIG9iamVjdHMgb3V0IG9mIGNhY2hlIiwKICAgICAgICAgICAgICAgIGF0\ndGVtcHRzIDwgMTAwKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8qCiAg\nICAgICAgICAgICAqIE5vdCBhIHZhbGlkIHRlc3QuLi4gIEF0IGxlYXN0IG5v\ndCB3aXRoIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uLi4uCiAgICAgICAg\nICAgICAqIAogICAgICAgICAgICAgKiBKdXN0IHJlbW92aW5nIGl0ZW1zIGZy\nb20gdGhlIERhdGFDYWNoZSAoYXMgZG9uZSB2aWEgdGhlIHByZXZpb3VzIGxv\nb3ApIGlzIG5vdCBzdWZmaWNpZW50CiAgICAgICAgICAgICAqIHRvIHJlbW92\nZSB0aGUgZW50cmllcyBmcm9tIHRoZSBRdWVyeUNhY2hlLiAgQ3VycmVudGx5\nLCB0aGlzIG5vdGlmaWNhdGlvbiBpcyBkb25lIGF0IHRoZSBlbmQKICAgICAg\nICAgICAgICogb2YgYSB0cmFuc2FjdGlvbiBhZnRlciBpbnNlcnRzLCB1cGRh\ndGVzLCBhbmQgZGVsZXRlcyBoYXZlIGJlZW4gcGVyZm9ybWVkLiAgVGhlbiwg\ndGhlIAogICAgICAgICAgICAgKiB1cGRhdGVDYWNoZXMoKSBtZXRob2QgaXMg\naW52b2tlZCBvbiB0aGUgRGF0YUNhY2hlU3RvcmVNYW5hZ2VyIHdoaWNoIHdp\nbGwgZmxvdyB0aGUgcmVxdWVzdCB0bwogICAgICAgICAgICAgKiB0aGUgUXVl\ncnlDYWNoZS4gIFdpdGggbm8gZGlyZWN0IHVwZGF0ZXMgdG8gdGhlICJFbnRp\ndGllcyBvZiBpbnRlcmVzdCIsIHRoZW4gdGhlcmUncyBub3RoaW5nIHRvCiAg\nICAgICAgICAgICAqIGZsb3cgb3ZlciB0byB0aGUgUXVlcnlDYWNoZSBmb3Ig\nY2xlYW51cC4gIEV2ZW4gcHV0dGluZyB0aGUgYWJvdmUgbG9vcCB3aXRoaW4g\nYSB0cmFuc2FjdGlvbiBpcwogICAgICAgICAgICAgKiBub3Qgc3VmZmljaWVu\ndCwgc2luY2UgdGhlcmUgaGF2ZSBiZWVuIG5vIHVwZGF0ZXMgdG8gdGhlICJF\nbnRpdGllcyBvZiBpbnRlcmVzdCIuCiAgICAgICAgICAgICAqLwovLyAgICAg\nICAgICAgIGVtID0gZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7Ci8v\nICAgICAgICAgICAgYnJva2VyID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2Vy\nKGVtKTsKLy8gICAgICAgICAgICBxID0gYnJva2VyLm5ld1F1ZXJ5KEpQUUxQ\nYXJzZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEgRlJPTSAiCi8vICAgICAgICAg\nICAgICAgICsgQ2FjaGVPYmplY3RKLmNsYXNzLmdldFNpbXBsZU5hbWUoKQov\nLyAgICAgICAgICAgICAgICArICIgYSB3aGVyZSBhLnN0ciA9ICdoJyIpOwov\nLyAgICAgICAgICAgIHRyeSB7Ci8vICAgICAgICAgICAgICAgIGFzc2VydElu\nQ2FjaGUocSwgbnVsbCk7Ci8vICAgICAgICAgICAgfQovLyAgICAgICAgICAg\nIGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBlKSB7Ci8vICAgICAgICAg\nICAgICAgIGJ1Zyg2MjYsICJxdWVyeSBjYWNoZSBpbnZhbGlkYXRpb24gaXMg\nYnJva2VuIik7Ci8vICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gIyMj\nIHNob3VsZCB0ZXN0IHJlbW90ZSBldmVudHMgY2F1c2luZyBxdWVyaWVzIHRv\nIGV2aWN0LgogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAg\nICAgZW5kRW0oZW0pOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBGSVhNRSBT\nRWV0aGEgU2VwIDI2LDIwMDYKICAgIC8vIG5vdCBhYmxlIHRvIHJlcGxhY2Ug\ncG0ubmV3UXVlcnkoQ2FjaGVPYmplY3RFLmNsYXNzKTsKICAgIC8qCiAgICAg\nICogcHVibGljIHZvaWQgdGVzdEFsbGVnZWRRdWVyeU9yZGVyaW5nQ2hhbmdl\ncygpIHRocm93cyBFeGNlcHRpb24geyAvLwogICAgICAqIGluc3BpcmVkIGJ5\nIHRzYyAzMDEzLiBwY2w6IEkgaGF2ZSBub3QgYmVlbiBhYmxlIHRvIGdldCB0\naGlzIC8vIHRlc3QgY2FzZQogICAgICAqIHRvIGFjdHVhbGx5IGZhaWwuIEhv\nd2V2ZXIsIGR1cmluZyBhbmFseXNpcyBvZiAvLyAzMDEzJ3Mgc3RhY2sgdHJh\nY2VzLCBJCiAgICAgICogZGlzY292ZXJlZCB0aGF0IHRoZSAvLyBRdWVyeUtl\neS5lcXVhbHMoKSBtZXRob2QgZGlkIG5vdCBkZWFsIHdpdGggdGhlCiAgICAg\nICogb3JkZXJpbmcgLy8gZmllbGQgY29ycmVjdGx5LCBwb3NzaWJseSBjYXVz\naW5nIHRoZSBwcm9ibGVtLgogICAgICAqCiAgICAgICogT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpCiAgICAgICog\nZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7IHRyeSB7IHN0YXJ0VHgo\nZW0sCiAgICAgICogKCkpOyBDYWNoZU9iamVjdEUgZSA9IG5ldyBDYWNoZU9i\namVjdEUoImUiKTsgZW0ucGVyc2lzdChlKTsKICAgICAgKiBlbmRUeChlbSk7\nIH0gZmluYWxseSB7CiAgICAgICogZW5kRW0oZW0pOyB9CiAgICAgICoKICAg\nICAgKiBlbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOyBRdWVy\neSBxOyBDb2xsZWN0aW9uIGM7IExpc3QgbDsgdHJ5IHsKICAgICAgKiBxID0g\nZW0uY3JlYXRlUXVlcnkoQ2FjaGVPYmplY3RFLmNsYXNzKTsgcS5zZXRPcmRl\ncmluZygic3RyIGFzY2VuZGluZyIpOwogICAgICAqIGMgPSAoQ29sbGVjdGlv\nbikgcS5leGVjdXRlKCk7IGwgPSBuZXcgTGlua2VkTGlzdChjKTsKICAgICAg\nKiBhc3NlcnRFcXVhbHMoMSwgYy5zaXplKCkpOyB9IGZpbmFsbHkgeyBlbmRF\nbShlbSk7IH0KICAgICAgKgogICAgICAqIGVtID0gZmFjdG9yeS5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7IHRyeSB7IHEgPQogICAgICAqIGVtLmNyZWF0ZVF1\nZXJ5KENhY2hlT2JqZWN0RS5jbGFzcyk7IHEuc2V0T3JkZXJpbmcoInN0ciBh\nc2NlbmRpbmciKTsgYyA9CiAgICAgICogKENvbGxlY3Rpb24pIHEuZXhlY3V0\nZSgpOyBsID0gbmV3IExpbmtlZExpc3QoYyk7IGFzc2VydEVxdWFscygxLAog\nICAgICAqIGMuc2l6ZSgpKTsgfSBmaW5hbGx5IHsgZW5kRW0oZW0pOyB9CiAg\nICAgICoKICAgICAgKiB0cnkgeyBlbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOyBxID0KICAgICAgKiBlbS5jcmVhdGVRdWVyeShDYWNoZU9i\namVjdEUuY2xhc3MpOyBxLnNldE9yZGVyaW5nKCJzdHIgZGVzY2VuZGluZyIp\nOyBjID0KICAgICAgKiAoQ29sbGVjdGlvbikgcS5leGVjdXRlKCk7IGFzc2Vy\ndEVxdWFscygxLCBjLnNpemUoKSk7IGwgPSBuZXcKICAgICAgKiBMaW5rZWRM\naXN0KGMpOyB9IGZpbmFsbHkgeyBlbmRFbShlbSk7IH0gfQogICAgICAqLwoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RBbGxlZ2VkQ29uY3VycmVudE1vZGlmaWNh\ndGlvbkV4Y2VwdGlvbigpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgQ2FjaGVPYmplY3RFIGU7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVscGVyLmdl\ndE1ldGFEYXRhKGVtLAogICAgICAgICAgICAgICAgQ2FjaGVPYmplY3RFLmNs\nYXNzKTsKICAgICAgICAgICAgaWYgKCFpc09wZW5KUEFDYWNoZShtZXRhLmdl\ndERhdGFDYWNoZSgpKSkKICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAg\nICAgICAgIHN0YXJ0VHgoZW0pOwogICAgICAgICAgICBlID0gbmV3IENhY2hl\nT2JqZWN0RSgiZSIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGUpOwogICAg\nICAgICAgICBlbmRUeChlbSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkg\newogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAgICAgfQoKICAgICAgICBl\nbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAgICAgICAgLy8g\nZmluZCB0aGUgbmV3IG9iamVjdC4uLgogICAgICAgICAgICBPcGVuSlBBUXVl\ncnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgYSBGUk9NICIKICAgICAg\nICAgICAgICAgICsgQ2FjaGVPYmplY3RFLmNsYXNzLmdldFNpbXBsZU5hbWUo\nKQogICAgICAgICAgICAgICAgKyAiIGEgd2hlcmUgYS5zdHIgPSAnZSciKTsK\nICAgICAgICAgICAgZSA9IChDYWNoZU9iamVjdEUpICgoQ29sbGVjdGlvbikg\ncS5nZXRSZXN1bHRMaXN0KCkpLml0ZXJhdG9yKCkKICAgICAgICAgICAgICAg\nIC5uZXh0KCk7CgogICAgICAgICAgICAvLyAuLi4gYW5kIG1vZGlmeSB0aGUg\nY2hhbmdlZCBvYmplY3QuCiAgICAgICAgICAgIGUuc2V0U3RyKCJlMiIpOwog\nICAgICAgICAgICBlLnNldFN0cigiZTMiKTsKICAgICAgICAgICAgZW5kVHgo\nZW0pOwogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAg\nZW5kRW0oZW0pOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGJvb2xl\nYW4gaXNPcGVuSlBBQ2FjaGUoRGF0YUNhY2hlIGNhY2hlKSB7CiAgICAgICAg\naWYgKGNhY2hlIGluc3RhbmNlb2YgRGVsZWdhdGluZ0RhdGFDYWNoZSkKICAg\nICAgICAgICAgY2FjaGUgPSAoKERlbGVnYXRpbmdEYXRhQ2FjaGUpIGNhY2hl\nKS5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpOwoKICAgICAgICByZXR1cm4gY2Fj\naGUgaW5zdGFuY2VvZiBDb25jdXJyZW50RGF0YUNhY2hlOwogICAgfQoKICAg\nIC8vIC0tLS0tLS0tLS0gdXRpbGl0eSBtZXRob2RzIC0tLS0tLS0tLS0KCiAg\nICBwcml2YXRlIHZvaWQgY2hlY2tDYWNoZShEYXRhQ2FjaGUgY2FjaGUsIE9i\namVjdFtdIGlkcywgYm9vbGVhbltdIHN0YXRpKSB7CiAgICAgICAgQ2FjaGVU\nZXN0SGVscGVyLmNoZWNrQ2FjaGUodGhpcywgY2FjaGUsIGlkcywgc3RhdGkp\nOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhc3NlcnRJbkNhY2hlKG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSwKICAgICAgICBCb29sZWFu\nIGluQ2FjaGUpIHsKICAgICAgICBDYWNoZVRlc3RIZWxwZXIuYXNzZXJ0SW5D\nYWNoZSh0aGlzLCBxLCBpbkNhY2hlKTsKICAgIH0KCiAgICBwcml2YXRlIHZv\naWQgYXNzZXJ0SW5DYWNoZShvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5IHEsCiAgICAgICAgQm9vbGVhbiBpbkNhY2hlLCBPYmplY3RbXSBhcmdz\nKSB7CiAgICAgICAgQ2FjaGVUZXN0SGVscGVyLmFzc2VydEluQ2FjaGUodGhp\ncywgcSwgaW5DYWNoZSwgYXJncyk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIGl0ZXJhdGUoQ29sbGVjdGlvbiBjKSB7CiAgICAgICAgQ2FjaGVUZXN0SGVs\ncGVyLml0ZXJhdGUoYyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdElu\ndGVyZmFjZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyIG5ld0VtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBzdGFydFR4KG5ld0VtKTsKICAgICAgICBDYWNoZU9iamVjdEEgYSA9\nIChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNz\nLCBvaWQpOwogICAgICAgIENhY2hlT2JqZWN0QyBjID0gbmV3IENhY2hlT2Jq\nZWN0QygiYmxhaCIpOwogICAgICAgIGEuc2V0UmVsYXRlZEludGVyZmFjZShj\nKTsKICAgICAgICBlbmRUeChuZXdFbSk7CiAgICAgICAgT2JqZWN0IGNJZCA9\nIG5ld0VtLmdldE9iamVjdElkKGMpOwogICAgICAgIGVuZEVtKG5ld0VtKTsK\nCiAgICAgICAgbmV3RW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGZhY3Rv\ncnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIGEgPSAoQ2FjaGVP\nYmplY3RBKSBuZXdFbS5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsK\nCiAgICAgICAgQ2FjaGVPYmplY3RJbnRlcmZhY2UgYzIgPSBhLmdldFJlbGF0\nZWRJbnRlcmZhY2UoKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGMyKTsKCiAg\nICAgICAgYXNzZXJ0RXF1YWxzKGNJZCwgbmV3RW0uZ2V0T2JqZWN0SWQoYzIp\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcmllc09uQ29sbGVj\ndGlvbnNEb250VXNlQ2FjaGUoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGZhY3RvcnkKICAg\nICAgICAgICAgLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBzdGFydFR4KGVtKTsKICAgICAgICAgICAgQ2FjaGVP\nYmplY3RFIGUgPSBuZXcgQ2FjaGVPYmplY3RFKCJlIik7CiAgICAgICAgICAg\nIGVtLnBlcnNpc3QoZSk7CiAgICAgICAgICAgIGVuZFR4KGVtKTsKICAgICAg\nICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVtKTsK\nICAgICAgICB9CgogICAgICAgIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBPcGVu\nSlBBUXVlcnkgcTsKICAgICAgICBDb2xsZWN0aW9uIGM7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgYSBG\nUk9NICIKICAgICAgICAgICAgICAgICsgQ2FjaGVPYmplY3RFLmNsYXNzLmdl\ndFNpbXBsZU5hbWUoKQogICAgICAgICAgICAgICAgKyAiIGEgd2hlcmUgYS5z\ndHIgPSAnZSciKTsKICAgICAgICAgICAgYyA9IG5ldyBBcnJheUxpc3QoKENv\nbGxlY3Rpb24pIHEuZ2V0UmVzdWx0TGlzdCgpKTsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKDEsIGMuc2l6ZSgpKTsKICAgICAgICAgICAgcS5jbG9zZUFs\nbCgpOwogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAg\nZW5kRW0oZW0pOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGZhY3RvcnkuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICBxID0gZW0uY3JlYXRlUXVl\ncnkoInNlbGVjdCBhIEZST00gIgogICAgICAgICAgICAgICAgKyBDYWNoZU9i\namVjdEUuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpCiAgICAgICAgICAgICAgICAr\nICIgYSB3aGVyZSBhLnN0ciA9ICdlJyIpOwogICAgICAgICAgICBxLnNldENh\nbmRpZGF0ZUNvbGxlY3Rpb24obmV3IEFycmF5TGlzdCgwKSk7CiAgICAgICAg\nICAgIGMgPSAoQ29sbGVjdGlvbikgcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAg\nICAgICAgIGFzc2VydEVxdWFscygwLCBjLnNpemUoKSk7CiAgICAgICAgICAg\nIHEuY2xvc2VBbGwoKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAg\nICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVzdERGR0ZpZWxkc0xvYWRlZDEoKSB7CiAgICAgICAgZGZn\nRmllbGRzTG9hZGVkSGVscGVyKGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0REZHRmllbGRzTG9hZGVkMigpIHsKICAgICAgICBkZmdGaWVs\nZHNMb2FkZWRIZWxwZXIodHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nZGZnRmllbGRzTG9hZGVkSGVscGVyKGJvb2xlYW4gcmVsYXRlZCkgewogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgc3RhcnRUeChlbSk7CiAgICAgICAgT3BlbkpQQVF1\nZXJ5IHE7CiAgICAgICAgQ29sbGVjdGlvbiBjOwogICAgICAgIHRyeSB7Cgog\nICAgICAgICAgICBxID0gZW0uY3JlYXRlUXVlcnkoCiAgICAgICAgICAgICAg\nICAic2VsZWN0IGEgRlJPTSAiICsgQ2FjaGVPYmplY3RBLmNsYXNzLmdldFNp\nbXBsZU5hbWUoKQogICAgICAgICAgICAgICAgICAgICsgIiBhIHdoZXJlIGEu\nbmFtZSA9IDpwTmFtZSIpLnNldFBhcmFtZXRlcigicE5hbWUiLAogICAgICAg\nICAgICAgICAgT1JJR19OQU1FKTsKCiAgICAgICAgICAgIGMgPSBuZXcgQXJy\nYXlMaXN0KChDb2xsZWN0aW9uKSBxLmdldFJlc3VsdExpc3QoKSk7CiAgICAg\nICAgICAgIGFzc2VydEVxdWFscygxLCBjLnNpemUoKSk7CiAgICAgICAgICAg\nIENhY2hlT2JqZWN0QSBhID0gKENhY2hlT2JqZWN0QSkgYy5pdGVyYXRvcigp\nLm5leHQoKTsKICAgICAgICAgICAgaWYgKHJlbGF0ZWQpCiAgICAgICAgICAg\nICAgICBhLmdldFJlbGF0ZWRBcnJheSgpOwogICAgICAgICAgICBlbS5kZXRh\nY2goYSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhPUklHX05BTUUsIGEu\nZ2V0TmFtZSgpKTsKICAgICAgICAgICAgcS5jbG9zZUFsbCgpOwogICAgICAg\nIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgcm9sbGJhY2tUeChl\nbSk7CiAgICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLy8gRklYTUUgU2VldGhhIFNlcCAyNiwyMDA2CiAgICAvKgogICAgICAq\nIHB1YmxpYyB2b2lkIHRlc3RRdWVyaWVzQWZ0ZXJNb2RpZmljYXRpb25BcmVO\nb3RJbkNhY2hlKCkgewogICAgICAqIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVt\nID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKQogICAgICAqIGZhY3RvcnkuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOyBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTIg\nPQogICAgICAqIChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeS5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICoKICAgICAgKiAvL0ZJWE1FIFNl\nZXRoYSBTZXAgMjYsMjAwNiAvL2VtLnNldElnbm9yZUNhY2hlKGZhbHNlKTsK\nICAgICAgKiAvL2VtMi5zZXRJZ25vcmVDYWNoZShmYWxzZSk7ICgoRmV0Y2hQ\nbGFuKSBlbS5nZXRGZXRjaFBsYW4oKSkuCiAgICAgICogc2V0Rmx1c2hCZWZv\ncmVRdWVyaWVzKEZldGNoUGxhbi5GTFVTSF9UUlVFKTsgKChGZXRjaFBsYW4p\nCiAgICAgICogZW0yLmdldEZldGNoUGxhbigpKS4gc2V0Rmx1c2hCZWZvcmVR\ndWVyaWVzKEZldGNoUGxhbi5GTFVTSF9UUlVFKTsKICAgICAgKgogICAgICAq\nIHRyeSB7IHN0YXJ0VHgoZW0pOyBDYWNoZU9iamVjdEUgZSA9IG5ldwogICAg\nICAqIENhY2hlT2JqZWN0RSgiZSIpOyBlbS5wZXJzaXN0KGUpOyBlbmRUeChl\nbSwKICAgICAgKiAoKSk7CiAgICAgICoKICAgICAgKiBzdGFydFR4KGVtKTsK\nICAgICAgKiAgLy8gZmlyc3QsIGEgcXVlcnkgdGhhdCBzaG91bGQgZ2V0IGlu\ndG8gdGhlIGNhY2hlLiBCcm9rZXIgYnJva2VyID0KICAgICAgKiBKUEFGYWNh\nZGVIZWxwZXIudG9Ccm9rZXIoZW0pOyBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLlF1ZXJ5IHEgPQogICAgICAqIGJyb2tlci5uZXdRdWVyeShKUFFMUGFy\nc2VyLkxBTkdfSlBRTCwgQ2FjaGVPYmplY3RFLmNsYXNzLCAic3RyID09CiAg\nICAgICogXCJlXCIiKTsgQ29sbGVjdGlvbiBjID0gKENvbGxlY3Rpb24pIHEu\nZXhlY3V0ZSgpOyBmb3IgKEl0ZXJhdG9yIGl0ZXIgPQogICAgICAqIGMuaXRl\ncmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSBpdGVyLm5leHQoKTsKICAgICAg\nKgogICAgICAqIGFzc2VydEVxdWFscygxLCBjLnNpemUoKSk7IGFzc2VydElu\nQ2FjaGUocSwgQm9vbGVhbi5UUlVFKTsKICAgICAgKgogICAgICAqIEJyb2tl\nciBicm9rZXIyID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVtMik7CiAg\nICAgICogb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxMiA9IGJy\nb2tlcjIubmV3UXVlcnkocS5nZXRMYW5ndWFnZSgpLAogICAgICAqIHEpOwog\nICAgICAqICAvLyBtYWtlIHNvbWUgbW9kaWZpY2F0aW9ucyBhbmQgbG9vayBh\nZ2Fpbi4gU2hvdWxkIHJldHVybiAvL3R3byByZXN1bHRzLgogICAgICAqIGUg\nPSBuZXcgQ2FjaGVPYmplY3RFKCJlIik7IGVtLnBlcnNpc3QoZSk7CiAgICAg\nICoKICAgICAgKiBxID0gYnJva2VyLm5ld1F1ZXJ5KEpQUUxQYXJzZXIuTEFO\nR19KUFFMLCBDYWNoZU9iamVjdEUuY2xhc3MsICJzdHIgPT0KICAgICAgKiBc\nImVcIiIpOyBjID0gKENvbGxlY3Rpb24pIHEuZXhlY3V0ZSgpOyBhc3NlcnRF\ncXVhbHMoMiwgYy5zaXplKCkpOyBmb3IKICAgICAgKiAoSXRlcmF0b3IgaXRl\nciA9IGMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSBpdGVyLm5leHQo\nKTsKICAgICAgKiAgLy8gb3JpZ2luYWwgcXVlcnkgc2hvdWxkIHN0aWxsIGJl\nIGluIGNhY2hlIGFzc2VydEluQ2FjaGUocTIsCiAgICAgICogQm9vbGVhbi5U\nUlVFKTsKICAgICAgKgogICAgICAqIENvbGxlY3Rpb24gYzIgPSAoQ29sbGVj\ndGlvbikgcTIuZXhlY3V0ZSgpOyBhc3NlcnRFcXVhbHMoMSwgYzIuc2l6ZSgp\nKTsKICAgICAgKiAgLy8gbmV3IHF1ZXJ5IHNob3VsZCBub3QgbWFrZSBpdCBp\nbnRvIGNhY2hlCiAgICAgICoKICAgICAgKiBxID0gYnJva2VyIC5uZXdRdWVy\neShKUFFMUGFyc2VyLkxBTkdfSlBRTCwgQ2FjaGVPYmplY3RFLmNsYXNzLCBu\ndWxsKTsKICAgICAgKiBjID0gKENvbGxlY3Rpb24pIHEuZXhlY3V0ZSgpOyBh\nc3NlcnRFcXVhbHMoMiwgYy5zaXplKCkpOwogICAgICAqIGZvciAoSXRlcmF0\nb3IgaXRlciA9IGMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSBpdGVy\nLm5leHQoKTsKICAgICAgKgogICAgICAqIGFzc2VydEluQ2FjaGUocSwgQm9v\nbGVhbi5GQUxTRSk7IH0gZmluYWxseSB7CiAgICAgICogcm9sbGJhY2tUeChl\nbSk7CiAgICAgICogZW5kRW0oZW0pOwogICAgICAqIGVuZEVtKGVtMik7IH0g\nfQogICAgICAqLwoKICAgIHB1YmxpYyB2b2lkIHRlc3RDYWNoZWRRdWVyeUNs\nb3N1cmVSZWxlYXNlc1Jlc291cmNlcygpIHsKICAgICAgICAvLyBQZXJzaXN0\nZW5jZU1hbmFnZXJGYWN0b3J5IGZhY3RvcnkgPQogICAgICAgIC8vIEtvZG9I\nZWxwZXIuY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkgKCk7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBpbml0RW0gPSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKICAgICAgICBzdGFydFR4KGluaXRFbSk7CiAgICAgICAgQ2Fj\naGVPYmplY3RFIGUgPSBuZXcgQ2FjaGVPYmplY3RFKCJlIik7CiAgICAgICAg\naW5pdEVtLnBlcnNpc3QoZSk7CiAgICAgICAgZW5kVHgoaW5pdEVtKTsKICAg\nICAgICBlbmRFbShpbml0RW0pOwoKICAgICAgICBCcm9rZXIgYnJva2VyID0g\nSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyRmFjdG9yeShmYWN0b3J5KS5uZXdC\ncm9rZXIoKTsKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5IHEgPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgIEpQUUxQYXJz\nZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEgRlJPTSAiCiAgICAgICAgICAgICsg\nQ2FjaGVPYmplY3RFLmNsYXNzLmdldFNpbXBsZU5hbWUoKQogICAgICAgICAg\nICArICIgYSB3aGVyZSBhLnN0ciA9ICdlJyIpOwogICAgICAgIENvbGxlY3Rp\nb24gYyA9IChDb2xsZWN0aW9uKSBxLmV4ZWN1dGUoKTsKICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ZXIgPSBjLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgp\nOykKICAgICAgICAgICAgaXRlci5uZXh0KCk7CgogICAgICAgIGFzc2VydEVx\ndWFscygxLCBjLnNpemUoKSk7CiAgICAgICAgYXNzZXJ0SW5DYWNoZShxLCBC\nb29sZWFuLlRSVUUpOwoKICAgICAgICBJbXBsSGVscGVyLmNsb3NlKGMpOwoK\nICAgICAgICBicm9rZXIuY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0TXV0YWJsZVNDT3NBcmVDb252ZXJ0ZWQoKSB7CiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgZW0wID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0xID0gKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7CgogICAgICAgIHN0YXJ0VHgoZW0wKTsKICAgICAgICBD\nYWNoZU9iamVjdEEgYSA9IChDYWNoZU9iamVjdEEpIGVtMC5maW5kKENhY2hl\nT2JqZWN0QS5jbGFzcywgb2lkKTsKCiAgICAgICAgRGF0ZSBkID0gbmV3IERh\ndGUoKTsKICAgICAgICBhLnNldERhdGUoZCk7CgogICAgICAgIGVuZFR4KGVt\nMCk7CiAgICAgICAgRGF0YUNhY2hlIGNhY2hlID0gY2FjaGVNYW5hZ2VyKGZh\nY3RvcnkpLmdldERhdGFDYWNoZSgKICAgICAgICAgICAgRGF0YUNhY2hlLk5B\nTUVfREVGQVVMVCwgZmFsc2UpOwogICAgICAgIGFzc2VydFRydWUoY2FjaGUu\nY29udGFpbnMob2lkd2l0aGNsYXNzKSk7CiAgICAgICAgY2FjaGUucmVtb3Zl\nKG9pZHdpdGhjbGFzcyk7CgogICAgICAgIGEgPSAoQ2FjaGVPYmplY3RBKSBl\nbTEuZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZShjYWNoZS5jb250YWlucyhvaWR3aXRoY2xhc3MpKTsKCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgUENEYXRhIGRhdGEgPSBjYWNoZS5nZXQo\nb2lkd2l0aGNsYXNzKTsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRh\nID0KICAgICAgICAgICAgICAgICgoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0\nb3J5U1BJKSBPcGVuSlBBUGVyc2lzdGVuY2UKICAgICAgICAgICAgICAgICAg\nICAuY2FzdChmYWN0b3J5KSkuZ2V0Q29uZmlndXJhdGlvbigpCiAgICAgICAg\nICAgICAgICAgICAgLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCku\nZ2V0TWV0YURhdGEoYS5nZXRDbGFzcygpLAogICAgICAgICAgICAgICAgICAg\nIG51bGwsIGZhbHNlKTsKICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQg\nPSBtZXRhLmdldEZpZWxkKCJkYXRlIik7CiAgICAgICAgICAgIGQgPSAoRGF0\nZSkgZGF0YS5nZXREYXRhKGZtZC5nZXRJbmRleCgpKTsKICAgICAgICAgICAg\nQnJva2VyIGJyb2tlciA9IEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihlbTEp\nOwogICAgICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gYnJva2Vy\nLmdldFN0YXRlTWFuYWdlcihhKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShz\nbSA9PSAoKFByb3h5RGF0ZSkgYS5nZXREYXRlKCkpLmdldE93bmVyKCkpOwog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMoRGF0ZS5jbGFzcywgZC5nZXRDbGFz\ncygpKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAg\nIGVuZEVtKGVtMCk7CiAgICAgICAgICAgIGVuZEVtKGVtMSk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RFbXB0eVJlc3VsdHNBcmVD\nYWNoZWQoKSB7CiAgICAgICAgQnJva2VyIGJyb2tlciA9IEpQQUZhY2FkZUhl\nbHBlci50b0Jyb2tlckZhY3RvcnkoZmFjdG9yeSkubmV3QnJva2VyKCk7CiAg\nICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxID0gYnJv\na2VyLm5ld1F1ZXJ5KAogICAgICAgICAgICBKUFFMUGFyc2VyLkxBTkdfSlBR\nTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAgICAgICArIENhY2hlT2JqZWN0\nQUNoaWxkMS5jbGFzcy5nZXRTaW1wbGVOYW1lKCkKICAgICAgICAgICAgKyAi\nIGEgd2hlcmUgYS5uYW1lID0gJ3Rlc3RFbXB0eVJlc3VsdHNBcmVDYWNoZWQn\nIik7CiAgICAgICAgQ29sbGVjdGlvbiBjID0gKENvbGxlY3Rpb24pIHEuZXhl\nY3V0ZSgpOwogICAgICAgIGFzc2VydEVxdWFscygwLCBjLnNpemUoKSk7CiAg\nICAgICAgYXNzZXJ0SW5DYWNoZShxLCBCb29sZWFuLlRSVUUpOwogICAgICAg\nIGJyb2tlci5jbG9zZSgpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBkb2Fz\nc2VydFRydWUoRW50aXR5TWFuYWdlciBlbSwgU3RyaW5nIG5hbWUsIGludCBh\nZ2UpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQ2FjaGVP\nYmplY3RBIGEgPSAoQ2FjaGVPYmplY3RBKSBlbS5maW5kKENhY2hlT2JqZWN0\nQS5jbGFzcywgb2lkKTsKICAgICAgICBhc3NlcnRUcnVlKG5hbWUuZXF1YWxz\nKGEuZ2V0TmFtZSgpKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShhLmdldEFnZSgp\nID09IGFnZSk7CiAgICAgICAgZW5kRW0oZW0pOwogICAgfQoKICAgIHByaXZh\ndGUgdm9pZCBhc3NlcnROZXcoQ2FjaGVPYmplY3RBIGEpIHsKICAgICAgICBh\nc3NlcnRUcnVlKE5FV19OQU1FLmVxdWFscyhhLmdldE5hbWUoKSkpOwogICAg\nICAgIGFzc2VydFRydWUoT1JJR19BR0UgPT0gYS5nZXRBZ2UoKSk7CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIGFzc2VydE9sZChDYWNoZU9iamVjdEEgYSkg\newogICAgICAgIGFzc2VydFRydWUoT1JJR19OQU1FLmVxdWFscyhhLmdldE5h\nbWUoKSkpOwogICAgICAgIGFzc2VydFRydWUoT1JJR19BR0UgPT0gYS5nZXRB\nZ2UoKSk7CiAgICB9CgogICAgcHJpdmF0ZSBEYXRhQ2FjaGVNYW5hZ2VyIGNh\nY2hlTWFuYWdlcihPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgZmFjdG9y\neSkgewogICAgICAgIHJldHVybiBDYWNoZVRlc3RIZWxwZXIKICAgICAgICAg\nICAgLmNhY2hlTWFuYWdlcihKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJGYWN0\nb3J5KGZhY3RvcnkpKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY2xvc2Uo\nRW50aXR5TWFuYWdlciBlbSkgewogICAgICAgIHJvbGxiYWNrVHgoZW0pOwog\nICAgICAgIGVuZEVtKGVtKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY2xv\nc2UoQnJva2VyIGJyb2tlcikgewogICAgICAgIGlmIChicm9rZXIuaXNBY3Rp\ndmUoKSkKICAgICAgICAgICAgYnJva2VyLnJvbGxiYWNrKCk7CiAgICAgICAg\nYnJva2VyLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyB2b2lk\nIG1haW4oU3RyaW5nW10gYXJncykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIFN0cmluZyB0eXBlID0gYXJnc1tpXTsKCiAgICAgICAgICAg\nIENhY2hlVGVzdCBjOwogICAgICAgICAgICBpZiAodHlwZS5lcXVhbHMoInRj\ncCIpKSB7CiAgICAgICAgICAgICAgICBjID0gbmV3IERpc3RyaWJ1dGVkQ2Fj\naGVUZXN0KCJ0aW1lIHRlc3QiLAogICAgICAgICAgICAgICAgICAgIENvbmN1\ncnJlbnREYXRhQ2FjaGUuY2xhc3MpOwogICAgICAgICAgICB9IGVsc2UgaWYg\nKHR5cGUuZXF1YWxzKCJqbXMiKSkgewogICAgICAgICAgICAgICAgYyA9IG5l\ndyBEaXN0cmlidXRlZENhY2hlVGVzdCgidGltZSB0ZXN0IiwKICAgICAgICAg\nICAgICAgICAgICBDb25jdXJyZW50RGF0YUNhY2hlLmNsYXNzKTsKICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGMgPSBuZXcgVGVzdExv\nY2FsQ2FjaGUoInRpbWUgdGVzdCIpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBjLnNldFVwKCk7CiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgaW50IGNvdW50\nID0gMTAwMDsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBjb3Vu\ndDsgaisrKSB7CiAgICAgICAgICAgICAgICBjLmRvYXNzZXJ0VHJ1ZShjLmZh\nY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpLCBORVdfTkFNRSwKICAgICAg\nICAgICAgICAgICAgICBPUklHX0FHRSk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKGNvdW50ICsgIiBpdGVyYXRpb25z\nIGluICIKICAgICAgICAgICAgICAgICsgKFN5c3RlbS5jdXJyZW50VGltZU1p\nbGxpcygpIC0gc3RhcnQpICsgIiBtaWxsaXMiKTsKICAgICAgICAgICAgYy50\nZWFyRG93bigpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

