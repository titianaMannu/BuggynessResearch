{"sha":"5f0e07155ee373058b637f9efee671f1d815bb99","node_id":"MDQ6QmxvYjIwNjM2NDo1ZjBlMDcxNTVlZTM3MzA1OGI2MzdmOWVmZWU2NzFmMWQ4MTViYjk5","size":18618,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5f0e07155ee373058b637f9efee671f1d815bb99","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGV0YWNo\nOwoKaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5SW5wdXRTdHJlYW07CmltcG9y\ndCBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0U3Ry\nZWFtOwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9y\ndCBqYXZhLnV0aWwuQXJyYXlMaXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLkNvbXBhdGliaWxpdHk7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFn\nZXJGYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFQZXJzaXN0ZW5jZTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVNRlRlc3RDYXNlOwoK\ncHVibGljIGNsYXNzIFRlc3REZXRhY2hOb1Byb3h5IGV4dGVuZHMgU2luZ2xl\nRU1GVGVzdENhc2UgewogICAgCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgbnVtRW50aXRpZXMgPSAzOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nU3RyaW5nIFBST1hZID0gbmV3IFN0cmluZygiJHByb3h5Iik7CiAgICBwcml2\nYXRlIExvZyBfbG9nOwogICAgCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHsK\nICAgICAgICBzZXRVcChEUk9QX1RBQkxFUywgRW50aXR5MjAuY2xhc3MpOwog\nICAgICAgIF9sb2cgPSBlbWYuZ2V0Q29uZmlndXJhdGlvbigpLmdldExvZygi\ndGVzdCIpOwogICAgICAgIGNyZWF0ZUVudGl0aWVzKG51bUVudGl0aWVzKTsK\nICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGNyZWF0ZUVudGl0aWVzKGlu\ndCBjb3VudCkgewogICAgICAgIEVudGl0eTIwIGUyMCA9IG51bGw7CiAgICAg\nICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICBmb3IgKGludCBpPTA7IGk8Y291bnQ7IGkrKykgewogICAg\nICAgICAgICBlMjAgPSBuZXcgRW50aXR5MjAoaSk7CiAgICAgICAgICAgIGVt\nLnBlcnNpc3QoZTIwKTsKICAgICAgICB9CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQog\nICAgCiAgICAvKiAKICAgICAqIFZlcmlmeSB0aGF0IGFuIGluLXBsYWNlIGRl\ndGFjaGVkIGVudGl0eSBkb2VzIG5vdCB1c2UgdGhlIHByb3h5IGNsYXNzZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3REZXRhY2gyMCgpIHsKICAg\nICAgICBJbnRlZ2VyIGlkID0gbmV3IEludGVnZXIoMCk7CiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjIgPSAKICAgICAgICAg\nICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkgT3BlbkpQQVBl\ncnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KAogICAgICAg\nICAgICAiTm9Qcm94eTJOZXciLCAib3JnL2FwYWNoZS9vcGVuanBhL3BlcnNp\nc3RlbmNlL2RldGFjaC9wZXJzaXN0ZW5jZTIueG1sIik7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChlbWYyKTsKCiAgICAgICAgTG9nIGxvZyA9IGVtZjIuZ2V0\nQ29uZmlndXJhdGlvbigpLmdldExvZygidGVzdCIpOwogICAgICAgIGlmIChs\nb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKCIq\nKioqKiB0ZXN0RGV0YWNoMjAoKSAqKioqKiIpOwogICAgICAgIAogICAgICAg\nIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICBDb21w\nYXRpYmlsaXR5IGNvbXBhdCA9IGVtZjIuZ2V0Q29uZmlndXJhdGlvbigpLmdl\ndENvbXBhdGliaWxpdHlJbnN0YW5jZSgpOwogICAgICAgICAgICBhc3NlcnRO\nb3ROdWxsKGNvbXBhdCk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiRmx1c2hC\nZWZvcmVEZXRhY2g9IiArIGNvbXBhdC5nZXRGbHVzaEJlZm9yZURldGFjaCgp\nKTsKICAgICAgICAgICAgbG9nLnRyYWNlKCJDb3B5T25EZXRhY2g9IiArIGNv\nbXBhdC5nZXRDb3B5T25EZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50cmFj\nZSgiQ2FzY2FkZVdpdGhEZXRhY2g9IiArIGNvbXBhdC5nZXRDYXNjYWRlV2l0\naERldGFjaCgpKTsKICAgICAgICAgICAgbG9nLnRyYWNlKCJJZ25vcmVEZXRh\nY2hlZFN0YXRlRmllbGRGb3JQcm94eVNlcmlhbGl6YXRpb249IiArCiAgICAg\nICAgICAgICAgICBjb21wYXQuZ2V0SWdub3JlRGV0YWNoZWRTdGF0ZUZpZWxk\nRm9yUHJveHlTZXJpYWxpemF0aW9uKCkpOwogICAgICAgIH0KCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYyLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAg\nIEVudGl0eTIwIGUyMCA9IGVtLmZpbmQoRW50aXR5MjAuY2xhc3MsIGlkKTsK\nICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAg\nIGxvZy50cmFjZSgiKiogdGVzdERldGFjaDIwKCkgLSBhZnRlciBmaW5kIik7\nCiAgICAgICAgYXNzZXJ0VHJ1ZShlbS5jb250YWlucyhlMjApKTsKICAgICAg\nICBhc3NlcnRGYWxzZShlbS5pc0RldGFjaGVkKGUyMCkpOwogICAgICAgIHZl\ncmlmeVNlcmlhbGl6YWJsZShlMjAsIHRydWUsIGZhbHNlKTsKICAgICAgICAK\nICAgICAgICAvLyBuZXcgb3BlbmpwYS0yLjAuMCBiZWhhdmlvciwgd2hlcmUg\nZGV0YWNoKCkgZG9lc24ndCByZXR1cm4gdXBkYXRlZCBlbnRpdHksIGJ1dCBk\nb2VzIGl0IGluLXBsYWNlCiAgICAgICAgZW0uZGV0YWNoKGUyMCk7CiAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cu\ndHJhY2UoIioqIHRlc3REZXRhY2gyMCgpIC0gYWZ0ZXIgZGV0YWNoIik7CiAg\nICAgICAgLy8gaW4tcGxhY2UgdXBkYXRlZCBlbnRpdHkgc2hvdWxkIG5vdCBo\nYXZlIGFueSBwcm94eSBjbGFzc2VzIGFuZCBzaG91bGQgYmUgZGV0YWNoZWQK\nICAgICAgICBhc3NlcnRGYWxzZShlbS5jb250YWlucyhlMjApKTsKICAgICAg\nICBhc3NlcnRUcnVlKGVtLmlzRGV0YWNoZWQoZTIwKSk7CiAgICAgICAgdmVy\naWZ5U2VyaWFsaXphYmxlKGUyMCwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICAg\nICAgICAKICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIGVtZjIuY2xvc2Uo\nKTsKICAgIH0KCiAgICAvKiAKICAgICAqIFZlcmlmeSB0aGF0IGEgZGV0YWNo\nQ29weSgpIHJldHVybmVkIGVudGl0eSBkb2VzIG5vdCBjb250YWluIGFueSBw\ncm94eSBjbGFzc2VzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGV0\nYWNoQ29weTIwKCkgewogICAgICAgIEludGVnZXIgaWQgPSBuZXcgSW50ZWdl\ncigwKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkg\nZW1mMiA9IAogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0\nb3J5U1BJKSBPcGVuSlBBUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdl\nckZhY3RvcnkoCiAgICAgICAgICAgICJOb1Byb3h5Mk5ldyIsICJvcmcvYXBh\nY2hlL29wZW5qcGEvcGVyc2lzdGVuY2UvZGV0YWNoL3BlcnNpc3RlbmNlMi54\nbWwiKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGVtZjIpOwoKICAgICAgICBM\nb2cgbG9nID0gZW1mMi5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TG9nKCJ0ZXN0\nIik7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAg\nICAgICBsb2cudHJhY2UoIioqKioqIHRlc3REZXRhY2hDb3B5MjAoKSAqKioq\nKiIpOwogICAgICAgIAogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQo\nKSkgewogICAgICAgICAgICBDb21wYXRpYmlsaXR5IGNvbXBhdCA9IGVtZjIu\nZ2V0Q29uZmlndXJhdGlvbigpLmdldENvbXBhdGliaWxpdHlJbnN0YW5jZSgp\nOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGNvbXBhdCk7CiAgICAgICAg\nICAgIGxvZy50cmFjZSgiRmx1c2hCZWZvcmVEZXRhY2g9IiArIGNvbXBhdC5n\nZXRGbHVzaEJlZm9yZURldGFjaCgpKTsKICAgICAgICAgICAgbG9nLnRyYWNl\nKCJDb3B5T25EZXRhY2g9IiArIGNvbXBhdC5nZXRDb3B5T25EZXRhY2goKSk7\nCiAgICAgICAgICAgIGxvZy50cmFjZSgiQ2FzY2FkZVdpdGhEZXRhY2g9IiAr\nIGNvbXBhdC5nZXRDYXNjYWRlV2l0aERldGFjaCgpKTsKICAgICAgICAgICAg\nbG9nLnRyYWNlKCJJZ25vcmVEZXRhY2hlZFN0YXRlRmllbGRGb3JQcm94eVNl\ncmlhbGl6YXRpb249IiArCiAgICAgICAgICAgICAgICBjb21wYXQuZ2V0SWdu\nb3JlRGV0YWNoZWRTdGF0ZUZpZWxkRm9yUHJveHlTZXJpYWxpemF0aW9uKCkp\nOwogICAgICAgIH0KCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0g\nPSBlbWYyLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBlbS5jbGVh\ncigpOwoKICAgICAgICBFbnRpdHkyMCBlMjAgPSBlbS5maW5kKEVudGl0eTIw\nLmNsYXNzLCBpZCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgp\nKQogICAgICAgICAgICBsb2cudHJhY2UoIioqIHRlc3REZXRhY2hDb3B5MjAo\nKSAtIGFmdGVyIGZpbmQiKTsKICAgICAgICBhc3NlcnRUcnVlKGVtLmNvbnRh\naW5zKGUyMCkpOwogICAgICAgIGFzc2VydEZhbHNlKGVtLmlzRGV0YWNoZWQo\nZTIwKSk7CiAgICAgICAgdmVyaWZ5U2VyaWFsaXphYmxlKGUyMCwgdHJ1ZSwg\nZmFsc2UpOwogICAgICAgIAogICAgICAgIC8vIFRlc3QgbmV3IGRldGFjaENv\ncHkoKSBtZXRob2QgYWRkZWQgaW4gMi4wLjAKICAgICAgICBFbnRpdHkyMCBl\nMjBjb3B5ID0gZW0uZGV0YWNoQ29weShlMjApOwogICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKCIqKiBU\nZXN0RGV0YWNoQ29weTIwKCkgLSBhZnRlciBkZXRhY2hDb3B5Iik7CiAgICAg\nICAgLy8gdmVyaWZ5IGUyMCBpcyBzYW1lIGFzIGFib3ZlCiAgICAgICAgYXNz\nZXJ0VHJ1ZShlbS5jb250YWlucyhlMjApKTsKICAgICAgICBhc3NlcnRGYWxz\nZShlbS5pc0RldGFjaGVkKGUyMCkpOwogICAgICAgIHZlcmlmeVNlcmlhbGl6\nYWJsZShlMjAsIHRydWUsIGZhbHNlKTsKICAgICAgICAvLyB2ZXJpZnkgY29w\neSBkb2VzIG5vdCBoYXZlIGFueSBwcm94eSBjbGFzc2VzIChpbi1wbGFjZSB1\ncGRhdGVkKSBpcyBkZXRhY2hlZAogICAgICAgIGFzc2VydEZhbHNlKGVtLmNv\nbnRhaW5zKGUyMGNvcHkpKTsKICAgICAgICBhc3NlcnRUcnVlKGVtLmlzRGV0\nYWNoZWQoZTIwY29weSkpOwogICAgICAgIHZlcmlmeVNlcmlhbGl6YWJsZShl\nMjBjb3B5LCBmYWxzZSwgZmFsc2UpOwogICAgICAgIAogICAgICAgIGVtLmNs\nb3NlKCk7CiAgICAgICAgZW1mMi5jbG9zZSgpOwogICAgfQoKICAgIC8qCiAg\nICAgKiBWZXJpZnkgdGhhdCBpbi1wbGFjZSBkZXRhY2hBbGwgZW50aXRpZXMg\nZG8gbm90IHVzZSB0aGUgcHJveHkgY2xhc3Nlcy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgdGVzdERldGFjaEFsbDIwKCkgewogICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBlbWYyID0gCiAgICAgICAgICAgIChP\ncGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0\nZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgKICAgICAgICAgICAg\nIk5vUHJveHkyTmV3IiwgIm9yZy9hcGFjaGUvb3BlbmpwYS9wZXJzaXN0ZW5j\nZS9kZXRhY2gvcGVyc2lzdGVuY2UyLnhtbCIpOwogICAgICAgIGFzc2VydE5v\ndE51bGwoZW1mMik7CgogICAgICAgIExvZyBsb2cgPSBlbWYyLmdldENvbmZp\nZ3VyYXRpb24oKS5nZXRMb2coInRlc3QiKTsKICAgICAgICBpZiAobG9nLmlz\nVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZSgiKioqKiog\ndGVzdERldGFjaEFsbDIwKCkgKioqKioiKTsKICAgICAgICAKICAgICAgICBp\nZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgQ29tcGF0\naWJpbGl0eSBjb21wYXQgPSBlbWYyLmdldENvbmZpZ3VyYXRpb24oKS5nZXRD\nb21wYXRpYmlsaXR5SW5zdGFuY2UoKTsKICAgICAgICAgICAgYXNzZXJ0Tm90\nTnVsbChjb21wYXQpOwogICAgICAgICAgICBsb2cudHJhY2UoIkZsdXNoQmVm\nb3JlRGV0YWNoPSIgKyBjb21wYXQuZ2V0Rmx1c2hCZWZvcmVEZXRhY2goKSk7\nCiAgICAgICAgICAgIGxvZy50cmFjZSgiQ29weU9uRGV0YWNoPSIgKyBjb21w\nYXQuZ2V0Q29weU9uRGV0YWNoKCkpOwogICAgICAgICAgICBsb2cudHJhY2Uo\nIkNhc2NhZGVXaXRoRGV0YWNoPSIgKyBjb21wYXQuZ2V0Q2FzY2FkZVdpdGhE\nZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiSWdub3JlRGV0YWNo\nZWRTdGF0ZUZpZWxkRm9yUHJveHlTZXJpYWxpemF0aW9uPSIgKwogICAgICAg\nICAgICAgICAgY29tcGF0LmdldElnbm9yZURldGFjaGVkU3RhdGVGaWVsZEZv\nclByb3h5U2VyaWFsaXphdGlvbigpKTsKICAgICAgICB9CgogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mMi5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgZW0uY2xlYXIoKTsKCiAgICAgICAgQXJyYXlMaXN0\nPEVudGl0eTIwPiBlMjBMaXN0ID0gbmV3IEFycmF5TGlzdDxFbnRpdHkyMD4o\nbnVtRW50aXRpZXMpOwogICAgICAgIGZvciAoaW50IGk9MDsgaTxudW1FbnRp\ndGllczsgaSsrKSB7CiAgICAgICAgICAgIEVudGl0eTIwIGUyMCA9IGVtLmZp\nbmQoRW50aXR5MjAuY2xhc3MsIG5ldyBJbnRlZ2VyKGkpKTsKICAgICAgICAg\nICAgZTIwTGlzdC5hZGQoZTIwKTsKICAgICAgICAgICAgaWYgKGxvZy5pc1Ry\nYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLnRyYWNlKCIqKiB0\nZXN0RGV0YWNoQWxsMjAoKSAtIGFmdGVyIGZpbmQgRW50aXR5MjAoIiArIGkg\nKyAiKSIpOwogICAgICAgICAgICBhc3NlcnRUcnVlKGVtLmNvbnRhaW5zKGUy\nMCkpOwogICAgICAgICAgICBhc3NlcnRGYWxzZShlbS5pc0RldGFjaGVkKGUy\nMCkpOwogICAgICAgICAgICB2ZXJpZnlTZXJpYWxpemFibGUoZTIwLCB0cnVl\nLCBmYWxzZSk7ICAgICAgICAgICAgCiAgICAgICAgfQoKICAgICAgICAvLyBu\nZXcgb3BlbmpwYS0yLjAuMCBiZWhhdmlvciwgd2hlcmUgZGV0YWNoQWxsKCkg\ndXBkYXRlcyBlbnRpdGllcyBpbi1wbGFjZQogICAgICAgIC8vIEFycmF5TGlz\ndDxFbnRpdHkyMD4gZTIwTGlzdENvcHkgPSBuZXcgQXJyYXlMaXN0PEVudGl0\neTIwPihlbS5kZXRhY2hBbGwoZTIwTGlzdCkpOwogICAgICAgIC8vIGVtLmRl\ndGFjaEFsbChlMjBMaXN0KTsgICAvLyBmb3Igc29tZSByZWFzb24gY2FsbGlu\nZyB3aXRoIENvbGxlY3Rpb24gY2F1c2VzIGEgTlBFLCBzbyB1c2UgT2JqZWN0\nW10gaW5zdGVhZAogICAgICAgIGVtLmRldGFjaEFsbChlMjBMaXN0LmdldCgw\nKSwgZTIwTGlzdC5nZXQoMSksIGUyMExpc3QuZ2V0KDIpKTsKICAgICAgICBm\nb3IgKGludCBpPTA7IGk8bnVtRW50aXRpZXM7IGkrKykgewogICAgICAgICAg\nICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBs\nb2cudHJhY2UoIioqIHRlc3REZXRhY2hBbGwyMCgpIC0gYWZ0ZXIgRU0uZGV0\nYWNoQWxsKCkgdmVyaWZ5IGUyMExpc3QoIiArIGkgKyAiKSIpOwogICAgICAg\nICAgICBFbnRpdHkyMCBlMjAgPSBlMjBMaXN0LmdldChpKTsKICAgICAgICAg\nICAgLy8gZW50aXR5IHNob3VsZCBub3QgaGF2ZSBhbnkgcHJveHkgY2xhc3Nl\ncyAoaW4tcGxhY2UgdXBkYXRlZCkgYW5kIGlzIGRldGFjaGVkCiAgICAgICAg\nICAgIGFzc2VydEZhbHNlKGVtLmNvbnRhaW5zKGUyMCkpOwogICAgICAgICAg\nICBhc3NlcnRUcnVlKGVtLmlzRGV0YWNoZWQoZTIwKSk7CiAgICAgICAgICAg\nIHZlcmlmeVNlcmlhbGl6YWJsZShlMjAsIHRydWUsIGZhbHNlKTsKICAgICAg\nICB9CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgZW1mMi5jbG9zZSgp\nOwogICAgfQoKICAgIC8qCiAgICAgKiBWZXJpZnkgdGhhdCBhZnRlciBFTS5j\nbGVhcigpIGVudGl0aWVzIHN0aWxsIGNvbnRhaW4gcHJveHkgY2xhc3NlcyBm\nb3IgMS4wIGFwcHMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RDbGVh\ncjEwQ29tcGF0KCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSSBlbWYxID0gCiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFu\nYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0ZW5jZS5jcmVhdGVFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSgKICAgICAgICAgICAgIk5vUHJveHkxQ29tcGF0\nIiwgIm9yZy9hcGFjaGUvb3BlbmpwYS9wZXJzaXN0ZW5jZS9kZXRhY2gvcGVy\nc2lzdGVuY2UxLnhtbCIpOwogICAgICAgIGFzc2VydE5vdE51bGwoZW1mMSk7\nCgogICAgICAgIExvZyBsb2cgPSBlbWYxLmdldENvbmZpZ3VyYXRpb24oKS5n\nZXRMb2coInRlc3QiKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgIGxvZy50cmFjZSgiKioqKiogdGVzdENsZWFyMTBD\nb21wYXQoKSAqKioqKiIpOwogICAgICAgIAogICAgICAgIGlmIChsb2cuaXNU\ncmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICBDb21wYXRpYmlsaXR5IGNv\nbXBhdCA9IGVtZjEuZ2V0Q29uZmlndXJhdGlvbigpLmdldENvbXBhdGliaWxp\ndHlJbnN0YW5jZSgpOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGNvbXBh\ndCk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiRmx1c2hCZWZvcmVEZXRhY2g9\nIiArIGNvbXBhdC5nZXRGbHVzaEJlZm9yZURldGFjaCgpKTsKICAgICAgICAg\nICAgbG9nLnRyYWNlKCJDb3B5T25EZXRhY2g9IiArIGNvbXBhdC5nZXRDb3B5\nT25EZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiQ2FzY2FkZVdp\ndGhEZXRhY2g9IiArIGNvbXBhdC5nZXRDYXNjYWRlV2l0aERldGFjaCgpKTsK\nICAgICAgICAgICAgbG9nLnRyYWNlKCJJZ25vcmVEZXRhY2hlZFN0YXRlRmll\nbGRGb3JQcm94eVNlcmlhbGl6YXRpb249IiArCiAgICAgICAgICAgICAgICBj\nb21wYXQuZ2V0SWdub3JlRGV0YWNoZWRTdGF0ZUZpZWxkRm9yUHJveHlTZXJp\nYWxpemF0aW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0gPSBlbWYxLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBlbS5jbGVhcigpOwoKICAgICAgICBBcnJheUxpc3Q8RW50aXR5MjA+\nIGUyMExpc3QgPSBuZXcgQXJyYXlMaXN0PEVudGl0eTIwPihudW1FbnRpdGll\ncyk7CiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bUVudGl0aWVzOyBpKysp\nIHsKICAgICAgICAgICAgRW50aXR5MjAgZTIwID0gZW0uZmluZChFbnRpdHky\nMC5jbGFzcywgbmV3IEludGVnZXIoaSkpOwogICAgICAgICAgICBlMjBMaXN0\nLmFkZChlMjApOwogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoIioqIHRlc3RDbGVhcjEw\nQ29tcGF0KCkgLSBhZnRlciBmaW5kIEVudGl0eTIwKCIgKyBpICsgIikiKTsK\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZShlbS5jb250YWlucyhlMjApKTsKICAg\nICAgICAgICAgYXNzZXJ0RmFsc2UoZW0uaXNEZXRhY2hlZChlMjApKTsKICAg\nICAgICAgICAgdmVyaWZ5U2VyaWFsaXphYmxlKGUyMCwgdHJ1ZSwgZmFsc2Up\nOyAgICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgZW0uY2xlYXIoKTsK\nCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bUVudGl0aWVzOyBpKyspIHsK\nICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgbG9nLnRyYWNlKCIqKiB0ZXN0Q2xlYXIxMENvbXBhdCgpIC0g\nYWZ0ZXIgRU0uY2xlYXIoKSB2ZXJpZnkgRW50aXR5MjAoIiArIGkgKyAiKSIp\nOwogICAgICAgICAgICBFbnRpdHkyMCBlMjAgPSBlMjBMaXN0LmdldChpKTsK\nICAgICAgICAgICAgYXNzZXJ0RmFsc2UoZW0uY29udGFpbnMoZTIwKSk7CiAg\nICAgICAgICAgIGFzc2VydFRydWUoZW0uaXNEZXRhY2hlZChlMjApKTsKICAg\nICAgICAgICAgLy8gT2xkIDEuMC8xLjIgQmVoYXZpb3IgLQogICAgICAgICAg\nICAvLyAgIHRoZSAkcHJveHkgY2xhc3NlcyBhcmUgbm90IHJlbW92ZWQgZHVy\naW5nIHNlcmlhbGl6YXRpb24KICAgICAgICAgICAgdmVyaWZ5U2VyaWFsaXph\nYmxlKGUyMCwgdHJ1ZSwgdHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBlbS5j\nbG9zZSgpOwogICAgICAgIGVtZjEuY2xvc2UoKTsKICAgIH0KCiAgICAvKgog\nICAgICogVmVyaWZ5IHRoYXQgYWZ0ZXIgRU0uY2xlYXIoKSBlbnRpdGllcyBz\ndGlsbCBjb250YWluIHByb3h5IGNsYXNzZXMgZm9yIDEuMCBhcHBzLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2xlYXIyMENvbXBhdCgpIHsKICAg\nICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mMiA9IAog\nICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJKSBP\ncGVuSlBBUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZhY3Rvcnko\nCiAgICAgICAgICAgICJOb1Byb3h5MkNvbXBhdCIsICJvcmcvYXBhY2hlL29w\nZW5qcGEvcGVyc2lzdGVuY2UvZGV0YWNoL3BlcnNpc3RlbmNlMi54bWwiKTsK\nICAgICAgICBhc3NlcnROb3ROdWxsKGVtZjIpOwoKICAgICAgICBMb2cgbG9n\nID0gZW1mMi5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TG9nKCJ0ZXN0Iik7CiAg\nICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBs\nb2cudHJhY2UoIioqKioqIHRlc3RDbGVhcjIwQ29tcGF0KCkgKioqKioiKTsK\nICAgICAgICAKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsK\nICAgICAgICAgICAgQ29tcGF0aWJpbGl0eSBjb21wYXQgPSBlbWYyLmdldENv\nbmZpZ3VyYXRpb24oKS5nZXRDb21wYXRpYmlsaXR5SW5zdGFuY2UoKTsKICAg\nICAgICAgICAgYXNzZXJ0Tm90TnVsbChjb21wYXQpOwogICAgICAgICAgICBs\nb2cudHJhY2UoIkZsdXNoQmVmb3JlRGV0YWNoPSIgKyBjb21wYXQuZ2V0Rmx1\nc2hCZWZvcmVEZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiQ29w\neU9uRGV0YWNoPSIgKyBjb21wYXQuZ2V0Q29weU9uRGV0YWNoKCkpOwogICAg\nICAgICAgICBsb2cudHJhY2UoIkNhc2NhZGVXaXRoRGV0YWNoPSIgKyBjb21w\nYXQuZ2V0Q2FzY2FkZVdpdGhEZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50\ncmFjZSgiSWdub3JlRGV0YWNoZWRTdGF0ZUZpZWxkRm9yUHJveHlTZXJpYWxp\nemF0aW9uPSIgKwogICAgICAgICAgICAgICAgY29tcGF0LmdldElnbm9yZURl\ndGFjaGVkU3RhdGVGaWVsZEZvclByb3h5U2VyaWFsaXphdGlvbigpKTsKICAg\nICAgICB9CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1m\nMi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uY2xlYXIoKTsK\nCiAgICAgICAgQXJyYXlMaXN0PEVudGl0eTIwPiBlMjBMaXN0ID0gbmV3IEFy\ncmF5TGlzdDxFbnRpdHkyMD4obnVtRW50aXRpZXMpOwogICAgICAgIGZvciAo\naW50IGk9MDsgaTxudW1FbnRpdGllczsgaSsrKSB7CiAgICAgICAgICAgIEVu\ndGl0eTIwIGUyMCA9IGVtLmZpbmQoRW50aXR5MjAuY2xhc3MsIG5ldyBJbnRl\nZ2VyKGkpKTsKICAgICAgICAgICAgZTIwTGlzdC5hZGQoZTIwKTsKICAgICAg\nICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgbG9nLnRyYWNlKCIqKiB0ZXN0Q2xlYXIyMENvbXBhdCgpIC0gYWZ0ZXIg\nZmluZCBFbnRpdHkyMCgiICsgaSArICIpIik7CiAgICAgICAgICAgIGFzc2Vy\ndFRydWUoZW0uY29udGFpbnMoZTIwKSk7CiAgICAgICAgICAgIGFzc2VydEZh\nbHNlKGVtLmlzRGV0YWNoZWQoZTIwKSk7CiAgICAgICAgICAgIHZlcmlmeVNl\ncmlhbGl6YWJsZShlMjAsIHRydWUsIGZhbHNlKTsgICAgICAgICAgICAKICAg\nICAgICB9CgogICAgICAgIGVtLmNsZWFyKCk7CgogICAgICAgIGZvciAoaW50\nIGk9MDsgaTxudW1FbnRpdGllczsgaSsrKSB7CiAgICAgICAgICAgIGlmIChs\nb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZy50cmFj\nZSgiKiogdGVzdENsZWFyMjBDb21wYXQoKSAtIGFmdGVyIEVNLmNsZWFyKCkg\ndmVyaWZ5IEVudGl0eTIwKCIgKyBpICsgIikiKTsKICAgICAgICAgICAgRW50\naXR5MjAgZTIwID0gZTIwTGlzdC5nZXQoaSk7CiAgICAgICAgICAgIGFzc2Vy\ndEZhbHNlKGVtLmNvbnRhaW5zKGUyMCkpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKGVtLmlzRGV0YWNoZWQoZTIwKSk7CiAgICAgICAgICAgIC8vIE9sZCAx\nLjAvMS4yIEJlaGF2aW9yIC0KICAgICAgICAgICAgLy8gICB0aGUgJHByb3h5\nIGNsYXNzZXMgYXJlIG5vdCByZW1vdmVkIGR1cmluZyBzZXJpYWxpemF0aW9u\nCiAgICAgICAgICAgIHZlcmlmeVNlcmlhbGl6YWJsZShlMjAsIHRydWUsIHRy\ndWUpOwogICAgICAgIH0KCiAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICBl\nbWYyLmNsb3NlKCk7CiAgICB9CgogICAgLyoKICAgICAqIFZlcmlmeSB0aGF0\nIGFmdGVyIEVNLmNsZWFyKCkgZW50aXRpZXMgZG8gbm90IGNvbnRhaW4gcHJv\neHkgY2xhc3NlcyBmb3IgMi4wIGFwcHMuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHRlc3RDbGVhcjIwTmV3KCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeVNQSSBlbWYyID0gCiAgICAgICAgICAgIChPcGVuSlBB\nRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0ZW5jZS5j\ncmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgKICAgICAgICAgICAgIk5vUHJv\neHkyTmV3IiwgIm9yZy9hcGFjaGUvb3BlbmpwYS9wZXJzaXN0ZW5jZS9kZXRh\nY2gvcGVyc2lzdGVuY2UyLnhtbCIpOwogICAgICAgIGFzc2VydE5vdE51bGwo\nZW1mMik7CgogICAgICAgIExvZyBsb2cgPSBlbWYyLmdldENvbmZpZ3VyYXRp\nb24oKS5nZXRMb2coInRlc3QiKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VF\nbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZSgiKioqKiogdGVzdENs\nZWFyMjBOZXcoKSAqKioqKiIpOwogICAgICAgIAogICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICBDb21wYXRpYmlsaXR5\nIGNvbXBhdCA9IGVtZjIuZ2V0Q29uZmlndXJhdGlvbigpLmdldENvbXBhdGli\naWxpdHlJbnN0YW5jZSgpOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGNv\nbXBhdCk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiRmx1c2hCZWZvcmVEZXRh\nY2g9IiArIGNvbXBhdC5nZXRGbHVzaEJlZm9yZURldGFjaCgpKTsKICAgICAg\nICAgICAgbG9nLnRyYWNlKCJDb3B5T25EZXRhY2g9IiArIGNvbXBhdC5nZXRD\nb3B5T25EZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50cmFjZSgiQ2FzY2Fk\nZVdpdGhEZXRhY2g9IiArIGNvbXBhdC5nZXRDYXNjYWRlV2l0aERldGFjaCgp\nKTsKICAgICAgICAgICAgbG9nLnRyYWNlKCJJZ25vcmVEZXRhY2hlZFN0YXRl\nRmllbGRGb3JQcm94eVNlcmlhbGl6YXRpb249IiArCiAgICAgICAgICAgICAg\nICBjb21wYXQuZ2V0SWdub3JlRGV0YWNoZWRTdGF0ZUZpZWxkRm9yUHJveHlT\nZXJpYWxpemF0aW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYyLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsK\nICAgICAgICBlbS5jbGVhcigpOwoKICAgICAgICBBcnJheUxpc3Q8RW50aXR5\nMjA+IGUyMExpc3QgPSBuZXcgQXJyYXlMaXN0PEVudGl0eTIwPihudW1FbnRp\ndGllcyk7CiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bUVudGl0aWVzOyBp\nKyspIHsKICAgICAgICAgICAgRW50aXR5MjAgZTIwID0gZW0uZmluZChFbnRp\ndHkyMC5jbGFzcywgbmV3IEludGVnZXIoaSkpOwogICAgICAgICAgICBlMjBM\naXN0LmFkZChlMjApOwogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoIioqIHRlc3RDbGVh\ncjIwTmV3KCkgLSBhZnRlciBmaW5kIEVudGl0eTIwKCIgKyBpICsgIikiKTsK\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZShlbS5jb250YWlucyhlMjApKTsKICAg\nICAgICAgICAgYXNzZXJ0RmFsc2UoZW0uaXNEZXRhY2hlZChlMjApKTsKICAg\nICAgICAgICAgdmVyaWZ5U2VyaWFsaXphYmxlKGUyMCwgdHJ1ZSwgZmFsc2Up\nOyAgICAgICAgICAgIAogICAgICAgIH0KCiAgICAgICAgZW0uY2xlYXIoKTsK\nCiAgICAgICAgZm9yIChpbnQgaT0wOyBpPG51bUVudGl0aWVzOyBpKyspIHsK\nICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgbG9nLnRyYWNlKCIqKiB0ZXN0Q2xlYXIyME5ldygpIC0gYWZ0\nZXIgRU0uY2xlYXIoKSB2ZXJpZnkgRW50aXR5MjAoIiArIGkgKyAiKSIpOwog\nICAgICAgICAgICBFbnRpdHkyMCBlMjAgPSBlMjBMaXN0LmdldChpKTsKICAg\nICAgICAgICAgYXNzZXJ0RmFsc2UoZW0uY29udGFpbnMoZTIwKSk7CiAgICAg\nICAgICAgIGFzc2VydFRydWUoZW0uaXNEZXRhY2hlZChlMjApKTsKICAgICAg\nICAgICAgLy8gT1BFTkpQQS0xMDk3IE5ldyBiZWhhdmlvciAtICRwcm94eSBj\nbGFzc2VzIGFyZSByZW1vdmVkCiAgICAgICAgICAgIHZlcmlmeVNlcmlhbGl6\nYWJsZShlMjAsIHRydWUsIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIGVt\nLmNsb3NlKCk7CiAgICAgICAgZW1mMi5jbG9zZSgpOwogICAgfQoKICAgIC8q\nKgogICAgICogVGVzdCB0aGF0IHRoZSBlbnRpdHkgaXMvaXMgbm90IHVzaW5n\nIG91ciAkcHJveHkgY2xhc3NlcyBiZWZvcmUKICAgICAqIGFuZCBhZnRlciBz\nZXJpYWxpemF0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSBlMjAgRW50aXR5\nIHRvIHRlc3QuCiAgICAgKiBAcGFyYW0gdXNlc1Byb3h5QmVmb3JlIHZlcmlm\neSB0aGF0IHRoZSBlbnRpdHkgdXNlcyB0aGUgJHByb3h5IGNsYXNzZXMKICAg\nICAqICAgICAgICBiZWZvcmUgc2VyaWFsaXphdGlvbiBpZiB0cnVlIGFuZCBk\nb2VzIG5vdCBpZiBmYWxzZS4KICAgICAqIEBwYXJhbSB1c2VzUHJveHlBZnRl\nciB2ZXJpZnkgdGhhdCB0aGUgZW50aXR5IHVzZXMgdGhlICRwcm94eSBjbGFz\nc2VzCiAgICAgKiAgICAgICAgYWZ0ZXIgc2VyaWFsaXphdGlvbiBpZiB0cnVl\nIGFuZCBkb2VzIG5vdCBpZiBmYWxzZS4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIHZlcmlmeVNlcmlhbGl6YWJsZShFbnRpdHkyMCBlMjAsIGJvb2xlYW4g\ndXNlc1Byb3h5QmVmb3JlLAogICAgICAgICAgICBib29sZWFuIHVzZXNQcm94\neUFmdGVyKSB7CiAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGJhb3Mg\nPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgICAgICAgT2JqZWN0\nT3V0cHV0U3RyZWFtIG9vcyA9IG51bGw7CiAgICAgICAgYnl0ZVtdIGUyMGJ5\ndGVzID0gbnVsbDsKICAgICAgICAKICAgICAgICBpZiAoX2xvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9nLnRyYWNlKCJ2ZXJpZnlTZXJp\nYWxpemFibGUoKSAtIGJlZm9yZSBzZXJpYWxpemUiKTsKICAgICAgICB2ZXJp\nZnlFbnRpdGllcyhlMjAsIHVzZXNQcm94eUJlZm9yZSk7CgogICAgICAgIC8v\nIGZpcnN0IHNlcmlhbGl6ZQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG9v\ncyA9IG5ldyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyk7CiAgICAgICAgICAg\nIG9vcy53cml0ZU9iamVjdChlMjApOwogICAgICAgICAgICBlMjBieXRlcyA9\nIGJhb3MudG9CeXRlQXJyYXkoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIGZhaWwoZS50b1N0cmluZygpKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgaWYgKG9vcyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIG9v\ncy5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\nLy8gdGhlbiBkZXNlcmlhbGl6ZSBhbmQgYXNzZXJ0IG5vICRwcm94eSBjbGFz\nc2VzIGV4aXN0CiAgICAgICAgQnl0ZUFycmF5SW5wdXRTdHJlYW0gYmFpcyA9\nIG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbShlMjBieXRlcyk7CiAgICAgICAg\nT2JqZWN0SW5wdXRTdHJlYW0gb2lzID0gbnVsbDsKICAgICAgICBFbnRpdHky\nMCBlMjBuZXcgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG9p\ncyA9IG5ldyBPYmplY3RJbnB1dFN0cmVhbShiYWlzKTsKICAgICAgICAgICAg\nZTIwbmV3ID0gKEVudGl0eTIwKSBvaXMucmVhZE9iamVjdCgpOwogICAgICAg\nICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgX2xvZy50cmFjZSgidmVyaWZ5U2VyaWFsaXphYmxlKCkgLSBhZnRlciBk\nZXNlcmlhbGl6ZSIpOwogICAgICAgICAgICB2ZXJpZnlFbnRpdGllcyhlMjBu\nZXcsIHVzZXNQcm94eUFmdGVyKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIGZhaWwoZS50b1N0cmluZygpKTsKICAg\nICAgICB9IGNhdGNoIChDbGFzc05vdEZvdW5kRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgZmFpbChlLnRvU3RyaW5nKCkpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAob2lz\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgb2lzLmNsb3NlKCk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHZlcmlm\neUVudGl0aWVzKEVudGl0eTIwIGUyMCwgYm9vbGVhbiB1c2VzUHJveHkpIHsK\nICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgIF9sb2cudHJhY2UoInZlcmlmeUVudGl0aWVzKCkgLSBhc3NlcnRpbmcg\nZXhwZWN0ZWQgcHJveHkgdXNhZ2UgaXMgIiArIHVzZXNQcm94eSk7CiAgICAg\nICAgICAgIHByaW50Q2xhc3NOYW1lcyhlMjApOwogICAgICAgIH0KICAgICAg\nICBhc3NlcnRUcnVlKCJFeHBlY3RlZCBzcWxEYXRlIGVuZHNXaXRoKCRwcm94\neSkgdG8gcmV0dXJuICIgKyB1c2VzUHJveHksCiAgICAgICAgICAgIHVzZXNQ\ncm94eSA9PSBlMjAuZ2V0RGF0ZSgpLmdldENsYXNzKCkuZ2V0Q2Fub25pY2Fs\nTmFtZSgpLmVuZHNXaXRoKFBST1hZKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgi\nRXhwZWN0ZWQgc3FsVGltZSBlbmRzV2l0aCgkcHJveHkpIHRvIHJldHVybiAi\nICsgdXNlc1Byb3h5LAogICAgICAgICAgICB1c2VzUHJveHkgPT0gZTIwLmdl\ndFRpbWUoKS5nZXRDbGFzcygpLmdldENhbm9uaWNhbE5hbWUoKS5lbmRzV2l0\naChQUk9YWSkpOwogICAgICAgIGFzc2VydFRydWUoIkV4cGVjdGVkIHNxbFRp\nbWVzdGFtcCBlbmRzV2l0aCgkcHJveHkpIHRvIHJldHVybiAiICsgdXNlc1By\nb3h5LAogICAgICAgICAgICB1c2VzUHJveHkgPT0gZTIwLmdldFRpbWVzdGFt\ncCgpLmdldENsYXNzKCkuZ2V0Q2Fub25pY2FsTmFtZSgpLmVuZHNXaXRoKFBS\nT1hZKSk7CiAgICAgICAgCiAgICB9CiAgICAKICAgIHByaXZhdGUgdm9pZCBw\ncmludENsYXNzTmFtZXMoRW50aXR5MjAgZTIwKSB7CiAgICAgICAgaWYgKF9s\nb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICBfbG9nLnRyYWNl\nKCJzcWxEYXRlID0gIiArIGUyMC5nZXREYXRlKCkuZ2V0Q2xhc3MoKS5nZXRD\nYW5vbmljYWxOYW1lKCkpOwogICAgICAgICAgICBfbG9nLnRyYWNlKCJzcWxU\naW1lID0gIiArIGUyMC5nZXRUaW1lKCkuZ2V0Q2xhc3MoKS5nZXRDYW5vbmlj\nYWxOYW1lKCkpOwogICAgICAgICAgICBfbG9nLnRyYWNlKCJzcWxUaW1lc3Rh\nbXAgPSAiICsgZTIwLmdldFRpbWVzdGFtcCgpLmdldENsYXNzKCkuZ2V0Q2Fu\nb25pY2FsTmFtZSgpKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

