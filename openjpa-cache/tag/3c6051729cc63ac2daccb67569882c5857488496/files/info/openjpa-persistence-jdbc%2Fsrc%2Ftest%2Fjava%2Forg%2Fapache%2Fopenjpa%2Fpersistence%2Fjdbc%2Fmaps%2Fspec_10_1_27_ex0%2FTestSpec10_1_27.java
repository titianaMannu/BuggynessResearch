{"sha":"5dacbc530fbb889a4a0ebb03e16c6afe5a544209","node_id":"MDQ6QmxvYjIwNjM2NDo1ZGFjYmM1MzBmYmI4ODlhNGEwZWJiMDNlMTZjNmFmZTVhNTQ0MjA5","size":11459,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5dacbc530fbb889a4a0ebb03e16c6afe5a544209","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5t\nYXBzLnNwZWNfMTBfMV8yN19leDA7CgppbXBvcnQgamF2YS51dGlsLkxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5F\nbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNl\nLkVudGl0eVRyYW5zYWN0aW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nUXVlcnk7CgppbXBvcnQganVuaXQuZnJhbWV3b3JrLkFzc2VydDsKCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5SW1wbDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LkFsbG93RmFp\nbHVyZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50\nZXN0LlNRTExpc3RlbmVyVGVzdENhc2U7CgpwdWJsaWMgY2xhc3MgVGVzdFNw\nZWMxMF8xXzI3IGV4dGVuZHMgU1FMTGlzdGVuZXJUZXN0Q2FzZSB7CiAgICBw\ndWJsaWMgaW50IG51bUl0ZW1zID0gMjsKICAgIHB1YmxpYyBpbnQgbnVtSW1h\nZ2VzUGVySXRlbSA9IDM7CiAgICBwdWJsaWMgaW50IG51bUNvbXBhbnkgPSAy\nOwogICAgcHVibGljIGludCBudW1EaXZpc2lvbnNQZXJDbyA9IDI7CiAgICBw\ndWJsaWMgaW50IGl0ZW1JZCA9IDE7CiAgICBwdWJsaWMgaW50IGNvbXBJZCA9\nIDE7CiAgICBwdWJsaWMgaW50IGRpdklkID0gMTsKICAgIHB1YmxpYyBpbnQg\ndnBJZCA9IDE7CiAgICBwdWJsaWMgTGlzdDxDb21wbnkxPiByc0FsbENvbXBu\neTEgPSBudWxsOwogICAgcHVibGljIExpc3Q8Q29tcG55Mj4gcnNBbGxDb21w\nbnkyID0gbnVsbDsKCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHsKICAgICAg\nICBzdXBlci5zZXRVcChDTEVBUl9UQUJMRVMsCiAgICAgICAgICAgICAgICBD\nb21wbnkxLmNsYXNzLCBDb21wbnkyLmNsYXNzLAogICAgICAgICAgICAgICAg\nSXRlbTEuY2xhc3MsIEl0ZW0yLmNsYXNzLAogICAgICAgICAgICAgICAgRGl2\naXNpb24uY2xhc3MsIFZpY2VQcmVzaWRlbnQuY2xhc3MpOwogICAgICAgIGNy\nZWF0ZU9iaihlbWYpOwogICAgICAgIHJzQWxsQ29tcG55MSA9IGdldEFsbChD\nb21wbnkxLmNsYXNzKTsKICAgICAgICByc0FsbENvbXBueTIgPSBnZXRBbGwo\nQ29tcG55Mi5jbGFzcyk7CiAgICB9CgogICAgQEFsbG93RmFpbHVyZQogICAg\ncHVibGljIHZvaWQgdGVzdFF1ZXJ5SW5NZW1vcnlRdWFsaWZpZWRJZCgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIHF1ZXJ5UXVhbGlmaWVkSWQodHJ1\nZSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeVF1YWxp\nZmllZElkKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgcXVlcnlRdWFs\naWZpZWRJZChmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2Fu\nZGlkYXRlKFF1ZXJ5IHEsIENsYXNzPD8+IGNseikgCiAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLlF1ZXJ5SW1wbDw/PiBxMSA9IAogICAgICAgICAgICAob3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLlF1ZXJ5SW1wbDw/PikgcTsKICAg\nICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IHEyID0gcTEu\nZ2V0RGVsZWdhdGUoKTsKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLlF1ZXJ5SW1wbCBxaSA9IChRdWVyeUltcGwpIHEyOwogICAgICAgIGlm\nIChjbHogPT0gQ29tcG55MS5jbGFzcykKICAgICAgICAgICAgcWkuc2V0Q2Fu\nZGlkYXRlQ29sbGVjdGlvbihyc0FsbENvbXBueTEpOwogICAgICAgIGVsc2Ug\naWYgKGNseiA9PSBDb21wbnkyLmNsYXNzKQogICAgICAgICAgICBxaS5zZXRD\nYW5kaWRhdGVDb2xsZWN0aW9uKHJzQWxsQ29tcG55Mik7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgcXVlcnlRdWFsaWZpZWRJZChib29sZWFuIGluTWVtb3J5\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVt\nID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAgU3RyaW5n\nIHF1ZXJ5ID0gInNlbGVjdCBLRVkoZSkgZnJvbSBDb21wbnkxIGMsICIgKwog\nICAgICAgICAgICAiIGluIChjLm9yZ3MpIGUgb3JkZXIgYnkgYy5pZCI7CiAg\nICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KTsKICAgICAg\nICBpZiAoaW5NZW1vcnkpIAogICAgICAgICAgICBzZXRDYW5kaWRhdGUocSwg\nQ29tcG55MS5jbGFzcyk7CiAgICAgICAgTGlzdDw/PiBycyA9IHEuZ2V0UmVz\ndWx0TGlzdCgpOwogICAgICAgIERpdmlzaW9uIGQgPSAoRGl2aXNpb24pIHJz\nLmdldCgwKTsKCiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICBxdWVyeSA9\nICJzZWxlY3QgRU5UUlkoZSkgZnJvbSBDb21wbnkxIGMsICIgKwogICAgICAg\nICIgaW4gKGMub3JncykgZSBvcmRlciBieSBjLmlkIjsKICAgICAgICBxID0g\nZW0uY3JlYXRlUXVlcnkocXVlcnkpOwogICAgICAgIGlmIChpbk1lbW9yeSkg\nCiAgICAgICAgICAgIHNldENhbmRpZGF0ZShxLCBDb21wbnkxLmNsYXNzKTsK\nICAgICAgICBycyA9IHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIE1hcC5F\nbnRyeSBtZSA9IChNYXAuRW50cnkpIHJzLmdldCgwKTsKCiAgICAgICAgYXNz\nZXJ0VHJ1ZShkLmVxdWFscyhtZS5nZXRLZXkoKSkpOwoKICAgICAgICBxdWVy\neSA9ICJzZWxlY3QgS0VZKGUpIGZyb20gQ29tcG55MiBjLCAiICsKICAgICAg\nICAgICAgIiBpbiAoYy5vcmdzKSBlIG9yZGVyIGJ5IGMuaWQiOwogICAgICAg\nIHEgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSk7CiAgICAgICAgaWYgKGluTWVt\nb3J5KSAKICAgICAgICAgICAgc2V0Q2FuZGlkYXRlKHEsIENvbXBueTIuY2xh\nc3MpOwogICAgICAgIHJzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAg\nZCA9IChEaXZpc2lvbikgcnMuZ2V0KDApOwoKICAgICAgICBlbS5jbGVhcigp\nOwogICAgICAgIHF1ZXJ5ID0gInNlbGVjdCBFTlRSWShlKSBmcm9tIENvbXBu\neTIgYywgIiArCiAgICAgICAgICAgICIgaW4gKGMub3JncykgZSBvcmRlciBi\neSBjLmlkIjsKICAgICAgICBxID0gZW0uY3JlYXRlUXVlcnkocXVlcnkpOwog\nICAgICAgIGlmIChpbk1lbW9yeSkgCiAgICAgICAgICAgIHNldENhbmRpZGF0\nZShxLCBDb21wbnkyLmNsYXNzKTsKICAgICAgICBycyA9IHEuZ2V0UmVzdWx0\nTGlzdCgpOwogICAgICAgIG1lID0gKE1hcC5FbnRyeSkgcnMuZ2V0KDApOwoK\nICAgICAgICBhc3NlcnRUcnVlKGQuZXF1YWxzKG1lLmdldEtleSgpKSk7CiAg\nICAgICAgCiAgICAgICAgLy8gbmV3IHRlc3RzIGZvciBlbGVtZW50IGNvbGxl\nY3Rpb24KICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIHF1ZXJ5ID0gInNl\nbGVjdCBpbSBmcm9tIEl0ZW0xIGksIGluIChpLmltYWdlcykgaW0gIiArCiAg\nICAgICAgICAgICIgb3JkZXIgYnkgVkFMVUUoaW0pIjsKICAgICAgICBxID0g\nZW0uY3JlYXRlUXVlcnkocXVlcnkpOwogICAgICAgIGlmIChpbk1lbW9yeSkg\nCiAgICAgICAgICAgIHNldENhbmRpZGF0ZShxLCBJdGVtMS5jbGFzcyk7CiAg\nICAgICAgcnMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMobnVtSXRlbXMgKiBudW1JbWFnZXNQZXJJdGVtLCBycy5zaXplKCkp\nOwogICAgICAgIAogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgcXVlcnkg\nPSAic2VsZWN0IGltIGZyb20gSXRlbTEgaSwgaW4gKGkuaW1hZ2VzKSBpbSAi\nICsKICAgICAgICAgICAgIiB3aGVyZSBWQUxVRShpbSkgPSAnZmlsZTExJyI7\nCiAgICAgICAgcSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KTsKICAgICAgICBp\nZiAoaW5NZW1vcnkpIAogICAgICAgICAgICBzZXRDYW5kaWRhdGUocSwgSXRl\nbTEuY2xhc3MpOwogICAgICAgIHJzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKDEsIHJzLnNpemUoKSk7CiAgICAgICAgCiAg\nICAgICAgZW0uY2xlYXIoKTsKICAgICAgICBxdWVyeSA9ICJzZWxlY3QgaW0g\nZnJvbSBJdGVtMSBpLCBpbiAoaS5pbWFnZXMpIGltICIgKwogICAgICAgICAg\nICAiIGdyb3VwIGJ5IGltICIgKwogICAgICAgICAgICAiIGhhdmluZyBWQUxV\nRShpbSkgbGlrZSAnZmlsZTElJyI7CiAgICAgICAgcSA9IGVtLmNyZWF0ZVF1\nZXJ5KHF1ZXJ5KTsKICAgICAgICBpZiAoaW5NZW1vcnkpIAogICAgICAgICAg\nICBzZXRDYW5kaWRhdGUocSwgSXRlbTEuY2xhc3MpOwogICAgICAgIHJzID0g\ncS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bUlt\nYWdlc1Blckl0ZW0sIHJzLnNpemUoKSk7ICAgICAgIAoKICAgICAgICBlbS5j\nbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeU9iaigp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHF1ZXJ5T2JqKGVtZik7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgY3JlYXRlT2JqKEVudGl0eU1hbmFnZXJG\nYWN0b3J5IGVtZikgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0\naW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgbnVtSXRlbXM7IGkrKykKICAgICAgICAgICAgY3Jl\nYXRlSXRlbTEoZW0sIGl0ZW1JZCsrKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IG51bUl0ZW1zOyBpKyspCiAgICAgICAgICAgIGNyZWF0ZUl0ZW0y\nKGVtLCBpdGVtSWQrKyk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBu\ndW1Db21wYW55OyBpKyspCiAgICAgICAgICAgIGNyZWF0ZUNvbXBhbnkxKGVt\nLCBjb21wSWQrKyk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1D\nb21wYW55OyBpKyspCiAgICAgICAgICAgIGNyZWF0ZUNvbXBhbnkyKGVtLCBj\nb21wSWQrKyk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGVtLmZs\ndXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9z\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUl0ZW0xKEVudGl0\neU1hbmFnZXIgZW0sIGludCBpZCkgewogICAgICAgIEl0ZW0xIGl0ZW0gPSBu\nZXcgSXRlbTEoKTsKICAgICAgICBpdGVtLnNldElkKGlkKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IG51bUltYWdlc1Blckl0ZW07IGkrKykgewog\nICAgICAgICAgICBpdGVtLmFkZEltYWdlKCJpbWFnZSIgKyBpZCArIGksICJm\naWxlIiArIGlkICsgaSk7CiAgICAgICAgfQogICAgICAgIGVtLnBlcnNpc3Qo\naXRlbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY3JlYXRlSXRlbTIoRW50\naXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAgICAgICAgSXRlbTIgaXRlbSA9\nIG5ldyBJdGVtMigpOwogICAgICAgIGl0ZW0uc2V0SWQoaWQpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtSW1hZ2VzUGVySXRlbTsgaSsrKSB7\nCiAgICAgICAgICAgIGl0ZW0uYWRkSW1hZ2UoImltYWdlIiArIGlkICsgaSwg\nImZpbGUiICsgaWQgKyBpKTsKICAgICAgICB9CiAgICAgICAgZW0ucGVyc2lz\ndChpdGVtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVDb21wYW55\nMShFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBDb21wbnkx\nIGMgPSBuZXcgQ29tcG55MSgpOwogICAgICAgIGMuc2V0SWQoaWQpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRGl2aXNpb25zUGVyQ287IGkr\nKykgewogICAgICAgICAgICBEaXZpc2lvbiBkID0gY3JlYXRlRGl2aXNpb24o\nZW0sIGRpdklkKyspOwogICAgICAgICAgICBWaWNlUHJlc2lkZW50IHZwID0g\nY3JlYXRlVmljZVByZXNpZGVudChlbSwgdnBJZCsrKTsKICAgICAgICAgICAg\nYy5hZGRUb09yZ2FuaXphdGlvbihkLCB2cCk7CiAgICAgICAgICAgIGVtLnBl\ncnNpc3QoZCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QodnApOwogICAgICAg\nIH0KICAgICAgICBlbS5wZXJzaXN0KGMpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGNyZWF0ZUNvbXBhbnkyKEVudGl0eU1hbmFnZXIgZW0sIGludCBpZCkg\newogICAgICAgIENvbXBueTIgYyA9IG5ldyBDb21wbnkyKCk7CiAgICAgICAg\nYy5zZXRJZChpZCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1E\naXZpc2lvbnNQZXJDbzsgaSsrKSB7CiAgICAgICAgICAgIERpdmlzaW9uIGQg\nPSBjcmVhdGVEaXZpc2lvbihlbSwgZGl2SWQrKyk7CiAgICAgICAgICAgIFZp\nY2VQcmVzaWRlbnQgdnAgPSBjcmVhdGVWaWNlUHJlc2lkZW50KGVtLCB2cElk\nKyspOwogICAgICAgICAgICBjLmFkZFRvT3JnYW5pemF0aW9uKGQsIHZwKTsK\nICAgICAgICAgICAgZW0ucGVyc2lzdChkKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdCh2cCk7CiAgICAgICAgfQogICAgICAgIGVtLnBlcnNpc3QoYyk7CiAg\nICB9CgogICAgcHVibGljIERpdmlzaW9uIGNyZWF0ZURpdmlzaW9uKEVudGl0\neU1hbmFnZXIgZW0sIGludCBpZCkgewogICAgICAgIERpdmlzaW9uIGQgPSBu\nZXcgRGl2aXNpb24oKTsKICAgICAgICBkLnNldElkKGlkKTsKICAgICAgICBk\nLnNldE5hbWUoImQiICsgaWQpOwogICAgICAgIHJldHVybiBkOwogICAgfQoK\nICAgIHB1YmxpYyBWaWNlUHJlc2lkZW50IGNyZWF0ZVZpY2VQcmVzaWRlbnQo\nRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAgICAgICAgVmljZVByZXNp\nZGVudCB2cCA9IG5ldyBWaWNlUHJlc2lkZW50KCk7CiAgICAgICAgdnAuc2V0\nSWQoaWQpOwogICAgICAgIHZwLnNldE5hbWUoInZwIiArIGlkKTsKICAgICAg\nICByZXR1cm4gdnA7CiAgICB9CgogICAgcHVibGljIHZvaWQgZmluZE9iaihF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYpIHsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAg\nSXRlbTEgaXRlbTEgPSBlbS5maW5kKEl0ZW0xLmNsYXNzLCAxKTsKICAgICAg\nICBhc3NlcnRJdGVtMShpdGVtMSk7CgogICAgICAgIEl0ZW0yIGl0ZW0yID0g\nZW0uZmluZChJdGVtMi5jbGFzcywgNCk7CiAgICAgICAgYXNzZXJ0SXRlbTIo\naXRlbTIpOwoKICAgICAgICBDb21wbnkxIGMxID0gZW0uZmluZChDb21wbnkx\nLmNsYXNzLCAxKTsKICAgICAgICBhc3NlcnRDb21wYW55MShjMSk7CgogICAg\nICAgIENvbXBueTIgYzIgPSBlbS5maW5kKENvbXBueTIuY2xhc3MsIDMpOwog\nICAgICAgIGFzc2VydENvbXBhbnkyKGMyKTsKCiAgICAgICAgRGl2aXNpb24g\nZCA9IGVtLmZpbmQoRGl2aXNpb24uY2xhc3MsIDEpOwogICAgICAgIGFzc2Vy\ndERpdmlzaW9uKGQpOwoKICAgICAgICBWaWNlUHJlc2lkZW50IHZwID0gZW0u\nZmluZChWaWNlUHJlc2lkZW50LmNsYXNzLCAxKTsKICAgICAgICBhc3NlcnRW\naWNlUHJlc2lkZW50KHZwKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhc3Nl\ncnRJdGVtMShJdGVtMSBpdGVtKSB7CiAgICAgICAgaW50IGlkID0gaXRlbS5n\nZXRJZCgpOwogICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gaW1hZ2VzID0g\naXRlbS5nZXRJbWFnZXMoKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxz\nKG51bUltYWdlc1Blckl0ZW0sIGltYWdlcy5zaXplKCkpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGFzc2VydEl0ZW0yKEl0ZW0yIGl0ZW0pIHsKICAgICAg\nICBpbnQgaWQgPSBpdGVtLmdldElkKCk7CiAgICAgICAgTWFwPFN0cmluZywg\nU3RyaW5nPiBpbWFnZXMgPSBpdGVtLmdldEltYWdlcygpOwogICAgICAgIEFz\nc2VydC5hc3NlcnRFcXVhbHMobnVtSW1hZ2VzUGVySXRlbSwgaW1hZ2VzLnNp\nemUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0Q29tcGFueTEo\nQ29tcG55MSBjKSB7CiAgICAgICAgaW50IGlkID0gYy5nZXRJZCgpOwogICAg\nICAgIE1hcDxEaXZpc2lvbiwgVmljZVByZXNpZGVudD4gb3JnYW5pemF0aW9u\nID0gYy5nZXRPcmdhbml6YXRpb24oKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0\nRXF1YWxzKDIsb3JnYW5pemF0aW9uLnNpemUoKSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgYXNzZXJ0Q29tcGFueTIoQ29tcG55MiBjKSB7CiAgICAgICAg\naW50IGlkID0gYy5nZXRJZCgpOwogICAgICAgIE1hcDxEaXZpc2lvbiwgVmlj\nZVByZXNpZGVudD4gb3JnYW5pemF0aW9uID0gYy5nZXRPcmdhbml6YXRpb24o\nKTsKICAgICAgICBBc3NlcnQuYXNzZXJ0RXF1YWxzKDIsb3JnYW5pemF0aW9u\nLnNpemUoKSk7CiAgICB9ICAgIAoKICAgIHB1YmxpYyB2b2lkIGFzc2VydERp\ndmlzaW9uKERpdmlzaW9uIGQpIHsKICAgICAgICBpbnQgaWQgPSBkLmdldElk\nKCk7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBkLmdldE5hbWUoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRWaWNlUHJlc2lkZW50KFZpY2VQcmVz\naWRlbnQgdnApIHsKICAgICAgICBpbnQgaWQgPSB2cC5nZXRJZCgpOwogICAg\nICAgIFN0cmluZyBuYW1lID0gdnAuZ2V0TmFtZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHF1ZXJ5T2JqKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZikg\newogICAgICAgIHF1ZXJ5SXRlbShlbWYpOwogICAgICAgIHF1ZXJ5Q29tcGFu\neShlbWYpOwogICAgICAgIHF1ZXJ5RGl2aXNpb24oZW1mKTsKICAgICAgICBx\ndWVyeVZpY2VQcmVzaWRlbnQoZW1mKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBxdWVyeUl0ZW0oRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7CiAgICAg\nICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRy\nYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1\nZXJ5IHExID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBpIGZyb20gSXRlbTEg\naSIpOwogICAgICAgIExpc3Q8SXRlbTE+IGlzMSA9IHExLmdldFJlc3VsdExp\nc3QoKTsKICAgICAgICBmb3IgKEl0ZW0xIGl0ZW0gOiBpczEpewogICAgICAg\nICAgICBhc3NlcnRJdGVtMShpdGVtKTsKICAgICAgICB9CgogICAgICAgIFF1\nZXJ5IHEyID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBpIGZyb20gSXRlbTIg\naSIpOwogICAgICAgIExpc3Q8SXRlbTI+IGlzMiA9IHEyLmdldFJlc3VsdExp\nc3QoKTsKICAgICAgICBmb3IgKEl0ZW0yIGl0ZW0gOiBpczIpewogICAgICAg\nICAgICBhc3NlcnRJdGVtMihpdGVtKTsKICAgICAgICB9CiAgICAgICAgdHJh\nbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHF1ZXJ5Q29tcGFueShFbnRpdHlNYW5hZ2VyRmFjdG9yeSBl\nbWYpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFu\nID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICB0cmFuLmJlZ2luKCk7\nCiAgICAgICAgUXVlcnkgcTEgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IGMg\nZnJvbSBDb21wbnkxIGMiKTsKICAgICAgICBMaXN0PENvbXBueTE+IGNzMSA9\nIHExLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKENvbXBueTEgYyA6\nIGNzMSl7CiAgICAgICAgICAgIGFzc2VydENvbXBhbnkxKGMpOwogICAgICAg\nIH0KICAgICAgICBRdWVyeSBxMiA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3Qg\nYyBmcm9tIENvbXBueTIgYyIpOwogICAgICAgIExpc3Q8Q29tcG55Mj4gY3My\nID0gcTIuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGZvciAoQ29tcG55MiBj\nIDogY3MyKXsKICAgICAgICAgICAgYXNzZXJ0Q29tcGFueTIoYyk7CiAgICAg\nICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeURpdmlzaW9uKEVudGl0\neU1hbmFnZXJGYWN0b3J5IGVtZikgewogICAgICAgIEVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0\neVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAg\nICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRl\nUXVlcnkoInNlbGVjdCBkIGZyb20gRGl2aXNpb24gZCIpOwogICAgICAgIExp\nc3Q8RGl2aXNpb24+IGRzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAg\nZm9yIChEaXZpc2lvbiBkIDogZHMpewogICAgICAgICAgICBhc3NlcnREaXZp\nc2lvbihkKTsKICAgICAgICB9CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAg\nICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHF1ZXJ5\nVmljZVByZXNpZGVudChFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYpIHsKICAg\nICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0\nVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAg\nUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgdnAgZnJvbSBWaWNl\nUHJlc2lkZW50IHZwIik7CiAgICAgICAgTGlzdDxWaWNlUHJlc2lkZW50PiB2\ncHMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKFZpY2VQcmVz\naWRlbnQgdnAgOiB2cHMpewogICAgICAgICAgICBhc3NlcnRWaWNlUHJlc2lk\nZW50KHZwKTsKICAgICAgICB9CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAg\nICAgICBlbS5jbG9zZSgpOwogICAgfSAgICAKfQo=\n","encoding":"base64"}

