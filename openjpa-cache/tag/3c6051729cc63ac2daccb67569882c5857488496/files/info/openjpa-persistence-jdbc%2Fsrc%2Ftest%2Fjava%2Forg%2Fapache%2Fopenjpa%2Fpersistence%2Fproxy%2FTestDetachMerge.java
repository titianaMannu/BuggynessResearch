{"sha":"a14f4dda097572808ac08b234c0631941825d591","node_id":"MDQ6QmxvYjIwNjM2NDphMTRmNGRkYTA5NzU3MjgwOGFjMDhiMjM0YzA2MzE5NDE4MjVkNTkx","size":30831,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a14f4dda097572808ac08b234c0631941825d591","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHk7\nCgppbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9ydCBqYXZhLnV0\naWwuQ2FsZW5kYXI7CmltcG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGph\ndmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlVVSUQ7CgppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5jb25mLkNvbXBhdGliaWxpdHk7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLk9wZW5KUEFQZXJzaXN0ZW5jZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LkFsbG93RmFpbHVyZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVNRlRl\nc3RDYXNlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5wcm94eS5lbnRpdGllcy5BZGRyZXNzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLnByb3h5LmVudGl0aWVzLkFubnVpdHlIb2xk\nZXJDYXRlZ29yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5wcm94eS5lbnRpdGllcy5Bbm51aXR5UGVyc2lzdGVibGVPYmplY3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHku\nZW50aXRpZXMuQ29udGFjdFR5cGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UucHJveHkuZW50aXRpZXMuSUFubnVpdHk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHkuZW50aXRp\nZXMuSUFubnVpdHlIb2xkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UucHJveHkuZW50aXRpZXMuSUNvbnRhY3Q7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHkuZW50aXRpZXMu\nSUVxdWl0eUFubnVpdHk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UucHJveHkuZW50aXRpZXMuSUZpeGVkQW5udWl0eTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5wcm94eS5lbnRpdGll\ncy5JUGF5b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UucHJveHkuZW50aXRpZXMuSVBheW91dDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5wcm94eS5lbnRpdGllcy5JUmlkZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHkuZW50\naXRpZXMuUGVyc29uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLnByb3h5LmVudGl0aWVzLlJpZGVyVHlwZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5wcm94eS5lbnRpdGllcy5Bbm51\naXR5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnBy\nb3h5LmVudGl0aWVzLkFubnVpdHlIb2xkZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHkuZW50aXRpZXMuQ29udGFjdDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5wcm94eS5l\nbnRpdGllcy5FcXVpdHlBbm51aXR5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLnByb3h5LmVudGl0aWVzLkZpeGVkQW5udWl0eTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5wcm94eS5l\nbnRpdGllcy5QYXlvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5wcm94eS5lbnRpdGllcy5QYXlvdXQ7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHkuZW50aXRpZXMuUmlkZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucHJveHku\nZW50aXRpZXMuQW5udWl0eVR5cGU7CgoKLyoKICogVGVzdCB0aGUgY29tcGxp\nY2F0ZWQgaW50ZXJhY3Rpb24gYmV0d2VlbiBEZXRhY2hlZCBlbnRpdGllcywg\nUHJveHkgY2xhc3NlcwogKiBhbmQgTWVyZ2luZyBjaGFuZ2VzIG1hZGUgaW4g\nUHJveHlDb2xsZWN0aW9ucyBiYWNrIGludG8gZW50aXRpZXMuCiAqIAogKiBU\naGlzIGNvZGUgaXMgYmFzZWQgb24gQWNtZVRlc3QyLCB3aGljaCB3YXMgb3Jp\nZ2luYWxseSB3cml0dGVuIGJ5CiAqIE1vaGFtbWFkIGF0IElCTSBhbmQgY29u\ndHJpYnV0ZWQgdW5kZXIgQVNMIDIuMC4KICovCnB1YmxpYyBjbGFzcyBUZXN0\nRGV0YWNoTWVyZ2UgZXh0ZW5kcyBTaW5nbGVFTUZUZXN0Q2FzZSB7CiAgICAg\nICAgICAgIAogICAgcHVibGljIHZvaWQgc2V0VXAoKSB7CiAgICAgICAgc2V0\nVXAoRFJPUF9UQUJMRVMsIEFkZHJlc3MuY2xhc3MsIEFubnVpdHkuY2xhc3Ms\nIEFubnVpdHlIb2xkZXIuY2xhc3MsIEFubnVpdHlQZXJzaXN0ZWJsZU9iamVj\ndC5jbGFzcywKICAgICAgICAgICAgQ29udGFjdC5jbGFzcywgRXF1aXR5QW5u\ndWl0eS5jbGFzcywgRml4ZWRBbm51aXR5LmNsYXNzLCBQYXlvci5jbGFzcywg\nUGF5b3V0LmNsYXNzLAogICAgICAgICAgICBQZXJzb24uY2xhc3MsIFJpZGVy\nLmNsYXNzKTsKICAgIH0KICAgIAogICAgLyogCiAgICAgKiBUZXN0IGRlZmF1\nbHQgMS4wIGNvbXBhdGliaWxpdHkgYmVoYXZpb3IsIHdoaWNoIHNob3VsZCBw\nYXNzIEFTLUlTCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RBbm51aXR5\nMUNvbXBhdCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBlbWYxID0gCiAgICAgICAgICAgIChP\ncGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0\nZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgKICAgICAgICAgICAg\nIkFubnVpdHkxQ29tcGF0IiwgIm9yZy9hcGFjaGUvb3BlbmpwYS9wZXJzaXN0\nZW5jZS9wcm94eS9wZXJzaXN0ZW5jZTEueG1sIik7CiAgICAgICAgYXNzZXJ0\nTm90TnVsbChlbWYxKTsKCiAgICAgICAgTG9nIGxvZyA9IGVtZjEuZ2V0Q29u\nZmlndXJhdGlvbigpLmdldExvZygidGVzdCIpOwoKICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgQ29tcGF0aWJpbGl0\neSBjb21wYXQgPSBlbWYxLmdldENvbmZpZ3VyYXRpb24oKS5nZXRDb21wYXRp\nYmlsaXR5SW5zdGFuY2UoKTsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChj\nb21wYXQpOwogICAgICAgICAgICBsb2cudHJhY2UoInN0YXJ0ZWQgdGVzdEFu\nbnVpdHkxQ29tcGF0KCkiKTsKICAgICAgICAgICAgbG9nLnRyYWNlKCJGbHVz\naEJlZm9yZURldGFjaD0iICsgY29tcGF0LmdldEZsdXNoQmVmb3JlRGV0YWNo\nKCkpOwogICAgICAgICAgICBsb2cudHJhY2UoIkNvcHlPbkRldGFjaD0iICsg\nY29tcGF0LmdldENvcHlPbkRldGFjaCgpKTsKICAgICAgICAgICAgbG9nLnRy\nYWNlKCJDYXNjYWRlV2l0aERldGFjaD0iICsgY29tcGF0LmdldENhc2NhZGVX\naXRoRGV0YWNoKCkpOwogICAgICAgICAgICBsb2cudHJhY2UoIklnbm9yZURl\ndGFjaGVkU3RhdGVGaWVsZEZvclByb3h5U2VyaWFsaXphdGlvbj0iICsKICAg\nICAgICAgICAgICAgIGNvbXBhdC5nZXRJZ25vcmVEZXRhY2hlZFN0YXRlRmll\nbGRGb3JQcm94eVNlcmlhbGl6YXRpb24oKSk7CiAgICAgICAgfQoKICAgICAg\nICB0cnkgewogICAgICAgICAgICBleGVjdXRlKGVtZjEpOwogICAgICAgIH0g\nY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gZSkgewogICAgICAgICAgICBmYWls\nKCJ0ZXN0QW51aXR5MUNvbXBhdCgpIHNob3VsZCBub3QgaGF2ZSBjYXVzZWQg\nYW4gZXhlY3B0aW9uISIgKyBlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICBlbWYxLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQogICAgCiAg\nICAvKiAKICAgICAqIFRlc3QgZGVmYXVsdCAyLjAgY29tcGF0aWJpbGl0eSBi\nZWhhdmlvciwgd2hpY2ggc2hvdWxkIFBBU1MKICAgICAqLwogICAgcHVibGlj\nIHZvaWQgdGVzdEFubnVpdHkyQ29tcGF0KCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjIg\nPSAKICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQ\nSSkgT3BlbkpQQVBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0\nb3J5KAogICAgICAgICAgICAiQW5udWl0eTJDb21wYXQiLCAib3JnL2FwYWNo\nZS9vcGVuanBhL3BlcnNpc3RlbmNlL3Byb3h5L3BlcnNpc3RlbmNlMi54bWwi\nKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGVtZjIpOwoKICAgICAgICBMb2cg\nbG9nID0gZW1mMi5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TG9nKCJ0ZXN0Iik7\nCgogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAg\nICAgICBDb21wYXRpYmlsaXR5IGNvbXBhdCA9IGVtZjIuZ2V0Q29uZmlndXJh\ndGlvbigpLmdldENvbXBhdGliaWxpdHlJbnN0YW5jZSgpOwogICAgICAgICAg\nICBhc3NlcnROb3ROdWxsKGNvbXBhdCk7CiAgICAgICAgICAgIGxvZy50cmFj\nZSgic3RhcnRlZCB0ZXN0QW5udWl0eTJDb21wYXQoKSIpOwogICAgICAgICAg\nICBsb2cudHJhY2UoIkZsdXNoQmVmb3JlRGV0YWNoPSIgKyBjb21wYXQuZ2V0\nRmx1c2hCZWZvcmVEZXRhY2goKSk7CiAgICAgICAgICAgIGxvZy50cmFjZSgi\nQ29weU9uRGV0YWNoPSIgKyBjb21wYXQuZ2V0Q29weU9uRGV0YWNoKCkpOwog\nICAgICAgICAgICBsb2cudHJhY2UoIkNhc2NhZGVXaXRoRGV0YWNoPSIgKyBj\nb21wYXQuZ2V0Q2FzY2FkZVdpdGhEZXRhY2goKSk7CiAgICAgICAgICAgIGxv\nZy50cmFjZSgiSWdub3JlRGV0YWNoZWRTdGF0ZUZpZWxkRm9yUHJveHlTZXJp\nYWxpemF0aW9uPSIgKwogICAgICAgICAgICAgICAgY29tcGF0LmdldElnbm9y\nZURldGFjaGVkU3RhdGVGaWVsZEZvclByb3h5U2VyaWFsaXphdGlvbigpKTsK\nICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGV4ZWN1dGUo\nZW1mMik7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIGZhaWwoInRlc3RBbnVpdHkyQ29tcGF0KCkgc2hvdWxk\nIG5vdCBoYXZlIGNhdXNlZCBhbiBleGVjcHRpb24hIiArIGUpOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIGVtZjIuY2xvc2UoKTsKICAgICAg\nICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgdm9pZCBleGVjdXRlKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBteUVNRikgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgTG9nIGxvZyA9IG15RU1GLmdldENvbmZpZ3VyYXRp\nb24oKS5nZXRMb2coInRlc3QiKTsKICAgICAgICAvL0VudGl0eU1hbmFnZXIg\nZW0gPSBteUVNRi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgSUNv\nbnRhY3QgY29udGFjdCA9IG51bGw7CiAgICAgICAgCiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgbG9nLnRyYWNlKCJjcmVhdGluZyBjb250YWN0Iik7CiAgICAg\nICAgICAgIHRyeSB7ICAgICAgIAogICAgICAgICAgICAgICAgY29udGFjdCA9\nIGNyZWF0ZUNvbnRhY3QobXlFTUYpOyAgICAgIAogICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9nLmVycm9y\nKCJDcmVhdGUgQ29udGFjdCBmYWlsZWQuIiwgZSk7CiAgICAgICAgICAgICAg\nICB0aHJvdyBlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgdmVyaWZ5Q29udGFjdFZhbHVl\ncyhteUVNRiwgY29udGFjdCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoIkNyZWF0ZSBD\nb250YWN0IHZlcmlmaWNhdGlvbiBmYWlsZWQuIiwgZSk7CiAgICAgICAgICAg\nICAgICB0aHJvdyBlOwogICAgICAgICAgICAgICAgLy8gZG8gbm90IHJldHVy\nbiwgYXMgdGhpcyBtaWdodCBiZSBhIHNtYWxsIGJ1ZyB0aGF0IHdlIGNhbiBi\neXBhc3MKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAg\naWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9n\nLnRyYWNlKCJjcmVhdGluZyBhbm51aXR5IGhvbGRlciIpOwogICAgICAgICAg\nICBJQW5udWl0eUhvbGRlciBhbm51aXR5SG9sZGVyID0gbnVsbDsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGFubnVpdHlIb2xkZXIgPSBj\ncmVhdGVBbm51aXR5SG9sZGVyKG15RU1GLCBjb250YWN0KTsgICAgICAgICAg\nIAogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgbG9nLmVycm9yKCJmYWlsZWQgdG8gY3JlYXRlIEFubnVpdHkg\nSG9sZGVyIFN1Y2Nlc3NmdWxseS4iLCBlKTsKICAgICAgICAgICAgICAgIHRo\ncm93IGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICB2ZXJpZnlBbm51aXR5SG9sZGVyVmFs\ndWVzKG15RU1GLCBhbm51aXR5SG9sZGVyKTsKICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGxvZy5pbmZvKCJm\nYWlsZWQgdG8gdmVyaWZ5IGNyZWF0ZSBhbm51aXR5IGhvbGRlciBzdWNjZXNz\nZnVseS4iLCBlKTsKICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZy50cmFjZSgiY3JlYXRp\nbmcgcGF5b3IiKTsKICAgICAgICAgICAgSVBheW9yIHBheW9yID0gbnVsbDsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHBheW9yID0gY3Jl\nYXRlUGF5b3IobXlFTUYpOwogICAgICAgICAgICB9IGNhdGNoKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoImZhaWxlZCB0byBj\ncmVhdGUgcGF5b3Igc3VjY2Vzc2Z1bHkuIiwgZSk7CiAgICAgICAgICAgICAg\nICB0aHJvdyBlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgdmVyaWZ5UGF5b3JWYWx1ZXMo\nbXlFTUYsIHBheW9yKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgICAgIGxvZy5lcnJvcigiZmFpbGVkIHRvIHZl\ncmlmeSBjcmVhdGUgcGF5b3Igc3VjY2Vzc2Z1bHkuIiwgZSk7CiAgICAgICAg\nICAgICAgICB0aHJvdyBlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAog\nICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICBsb2cudHJhY2UoImNyZWF0aW5nIGFubnVpdHkiKTsKICAgICAg\nICAgICAgSUFubnVpdHkgYW5udWl0eSA9bnVsbDsgICAgIAogICAgICAgICAg\nICBBbm51aXR5VHlwZSBhbm51aXR5VHlwZSA9IEFubnVpdHlUeXBlLkZJWEVE\nOwogICAgICAgICAgICB0cnkgeyAgICAgICAgICAgCiAgICAgICAgICAgICAg\nICBhbm51aXR5ID0gY3JlYXRlQW5udWl0eVdpdGhSaWRlcihteUVNRiwgYW5u\ndWl0eVR5cGUpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgbG9nLmVycm9yKCJmYWlsZWQgdG8gY3JlYXRl\nIGFubnVpdHkgc3VjY2Vzc2Z1bHkuIiwgZSk7CiAgICAgICAgICAgICAgICB0\naHJvdyBlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgbG9nLnRyYWNlKCJ2ZXJpZnkgYW5u\ndWl0eSB3aXRoIHJpZGVyIik7CiAgICAgICAgICAgICAgICB2ZXJpZnlBbm51\naXR5VmFsdWVzKG15RU1GLCBhbm51aXR5LCBhbm51aXR5VHlwZSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICBsb2cuZXJyb3IoImZhaWxlZCB0byB2ZXJpZnkgY3JlYXRlIGFubnVpdHkg\nc3VjY2Vzc2Z1bHkuIiwgZSk7CiAgICAgICAgICAgICAgICB0aHJvdyBlOwog\nICAgICAgICAgICB9ICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAg\naWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9n\nLnRyYWNlKCJ1cGF0aW5nIGFubnVpdHkiKTsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIGxvZy50cmFjZSgiY3JlYXRlIGFubnVpdHkgd2l0\naCBwYXlvdXQiKTsKICAgICAgICAgICAgICAgIGFubnVpdHkgPSBjcmVhdGVB\nbm51aXR5UGF5b3V0KG15RU1GLCBhbm51aXR5KTsKICAgICAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGxvZy5lcnJv\ncigiZmFpbGVkIHRvIGNyZWF0ZSBhbm51aXR5IHN1Y2Nlc3NmdWx5LiIsIGUp\nOwogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHZl\ncmlmeUFubnVpdHlWYWx1ZXMobXlFTUYsIGFubnVpdHksIGFubnVpdHlUeXBl\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIGxvZy5lcnJvcigiZmFpbGVkIHRvIHZlcmlmeSBjcmVhdGUg\nYW5udWl0eSBzdWNjZXNzZnVseS4iLCBlKTsKICAgICAgICAgICAgICAgIHRo\ncm93IGU7CiAgICAgICAgICAgIH0gICAgICAgCiAgICAgICAgICAgIAogICAg\nICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAg\nICAgICBsb2cudHJhY2UoInVwYXRpbmcgYW5udWl0eSIpOwogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGNy\nZWF0ZUVNKG15RU1GKTsKICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICAgICAgICAgICAgICBhbm51aXR5Lmdl\ndFBheW9ycygpLmFkZChwYXlvcik7CiAgICAgICAgICAgICAgICAgICAgYW5u\ndWl0eS5zZXRBbm51aXR5SG9sZGVySWQoYW5udWl0eUhvbGRlci5nZXRJZCgp\nKTsKICAgICAgICAgICAgICAgICAgICBhbm51aXR5ID0gZW0ubWVyZ2UoYW5u\ndWl0eSk7CiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNv\nbW1pdCgpOwogICAgICAgICAgICAgICAgY2xvc2VFTShlbSk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBs\nb2cuZXJyb3IoImZhaWxlZCB0byB1cGRhdGUgYW5udWl0eSBzdWNjZXNzZnVs\neS4iLCBlKTsKICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICB2ZXJpZnlBbm51aXR5VmFsdWVzKG15RU1GLCBhbm51aXR5LCBhbm51\naXR5VHlwZSk7IAogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgbG9nLmVycm9yKCJmYWlsZWQgdG8gdmVyaWZ5\nIGFubnVpdHkgdXBkYXRlIHN1Y2Nlc3NmdWx5LiIsIGUpOwogICAgICAgICAg\nICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgfQogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIGxvZy5lcnJvcigic2NlbmFyaW86IGZhaWxlZC4i\nKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoInNjZW5hcmlvOiBj\nb21wbGV0ZWQuIik7CiAgICB9CgogICAgcHJpdmF0ZSBJQW5udWl0eSBjcmVh\ndGVBbm51aXR5UGF5b3V0KE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQ\nSSBteUVNRiwgSUFubnVpdHkgYW5udWl0eSkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBjcmVhdGVFTShteUVNRik7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIElQYXlvdXQgcGF5b3V0ID0g\nbmV3IFBheW91dCgpOwogICAgICAgIHBheW91dC5zZXRBbm51aXR5KGFubnVp\ndHkpOwogICAgICAgIHBheW91dC5zZXRUYXhhYmxlQW1vdW50KG5ldyBCaWdE\nZWNpbWFsKDEwMC4wMCkpOwogICAgICAgIHBheW91dC5zZXRTdGFydERhdGUo\nQ2FsZW5kYXIuZ2V0SW5zdGFuY2UoKSk7CiAgICAgICAgcGF5b3V0LnNldEVu\nZERhdGUoQ2FsZW5kYXIuZ2V0SW5zdGFuY2UoKSk7CiAgICAgICAgcGF5b3V0\nLnNldElkKGdldElkKCkpOwogICAgICAgIGVtLnBlcnNpc3QocGF5b3V0KTsK\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBhbm51aXR5\nLmdldFBheW91dHMoKS5hZGQocGF5b3V0KTsKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIGNsb3NlRU0oZW0pOwogICAg\nICAgIHJldHVybiBhbm51aXR5OwogICAgfQoKICAgIHByaXZhdGUgSUFubnVp\ndHkgY3JlYXRlQW5udWl0eVdpdGhSaWRlcihPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnlTUEkgbXlFTUYsIEFubnVpdHlUeXBlIGFubnVpdHlUeXBlKSB7\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGNyZWF0ZUVNKG15RU1GKTsK\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAg\nSUFubnVpdHkgYW5udWl0eSA9IGNyZWF0ZUFubnVpdHkoYW5udWl0eVR5cGUp\nOwogICAgICAgIElSaWRlciByaWRlcjEgPSBnZXRSaWRlcigpOwogICAgICAg\nIElSaWRlciByaWRlcjIgPSBnZXRSaWRlcigpOwogICAgICAgIElSaWRlciBy\naWRlcjMgPSBnZXRSaWRlcigpOwogICAgICAgIGFubnVpdHkuZ2V0UmlkZXJz\nKCkuYWRkKHJpZGVyMSk7CiAgICAgICAgYW5udWl0eS5nZXRSaWRlcnMoKS5h\nZGQocmlkZXIyKTsgICAgCiAgICAgICAgYW5udWl0eS5nZXRSaWRlcnMoKS5h\nZGQocmlkZXIzKTsKICAgICAgICBlbS5wZXJzaXN0KGFubnVpdHkpOwogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgY2xv\nc2VFTShlbSk7CiAgICAgICAgcmV0dXJuIGFubnVpdHk7CiAgICB9CgogICAg\ncHJpdmF0ZSBJQW5udWl0eSBjcmVhdGVBbm51aXR5KEFubnVpdHlUeXBlIGFu\nbnVpdHlUeXBlKSB7CiAgICAgICAgaWYgKEFubnVpdHlUeXBlLkJBU0lDLmVx\ndWFscyhhbm51aXR5VHlwZSkpIHsKICAgICAgICAgICAgQW5udWl0eSBhbm51\naXR5ID0gbmV3IEFubnVpdHkoKTsKICAgICAgICAgICAgYW5udWl0eS5zZXRJ\nZChnZXRJZCgpKTsKICAgICAgICAgICAgYW5udWl0eS5zZXRBbW91bnQoNTAw\nLjAwKTsKICAgICAgICAgICAgYW5udWl0eS5zZXRBY2NvdW50TnVtYmVyKCIx\nMjM0NTYiKTsKICAgICAgICAgICAgcmV0dXJuIGFubnVpdHk7CiAgICAgICAg\nfQogICAgICAgIGlmIChBbm51aXR5VHlwZS5FUVVJVFkuZXF1YWxzKGFubnVp\ndHlUeXBlKSkgewogICAgICAgICAgICBFcXVpdHlBbm51aXR5IGFubnVpdHkg\nPSBuZXcgRXF1aXR5QW5udWl0eSgpOwogICAgICAgICAgICBhbm51aXR5LnNl\ndElkKGdldElkKCkpOwogICAgICAgICAgICBhbm51aXR5LnNldEFtb3VudCg1\nMDAuMDApOwogICAgICAgICAgICBhbm51aXR5LnNldEFjY291bnROdW1iZXIo\nIjEyMzQ1NiIpOwogICAgICAgICAgICBhbm51aXR5LnNldEZ1bmROYW1lcygi\nU29tZXRoaW5nIG5vdGhpbmcgd3JvbmciKTsKICAgICAgICAgICAgYW5udWl0\neS5zZXRJbmRleFJhdGUoMTAuOTkpOwogICAgICAgICAgICBhbm51aXR5LnNl\ndExhc3RQYWlkQW10KDEwMC4wMCk7CiAgICAgICAgICAgIHJldHVybiBhbm51\naXR5OwogICAgICAgIH0KICAgICAgICBpZiAoQW5udWl0eVR5cGUuRklYRUQu\nZXF1YWxzKGFubnVpdHlUeXBlKSkgewogICAgICAgICAgICBGaXhlZEFubnVp\ndHkgYW5udWl0eSA9IG5ldyBGaXhlZEFubnVpdHkoKTsKICAgICAgICAgICAg\nKChGaXhlZEFubnVpdHkpYW5udWl0eSkuc2V0UmF0ZSgxMC4wKTsgICAgICAg\nIAogICAgICAgICAgICBhbm51aXR5LnNldElkKGdldElkKCkpOwogICAgICAg\nICAgICBhbm51aXR5LnNldEFtb3VudCg1MDAuMDApOwogICAgICAgICAgICBh\nbm51aXR5LnNldEFjY291bnROdW1iZXIoIjEyMzQ1NiIpOwogICAgICAgICAg\nICByZXR1cm4gYW5udWl0eTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgcHJpdmF0ZSBJUmlkZXIgZ2V0UmlkZXIoKSB7CiAg\nICAgICAgSVJpZGVyIHJpZGVyID0gbmV3IFJpZGVyKCk7CiAgICAgICAgcmlk\nZXIuc2V0SWQoZ2V0SWQoKSk7CiAgICAgICAgcmlkZXIuc2V0UnVsZSgiUGF5\nIik7CiAgICAgICAgcmlkZXIuc2V0VHlwZShSaWRlclR5cGUuUkVQTEFDRSk7\nCiAgICAgICAgcmlkZXIuc2V0RWZmZWN0aXZlRGF0ZShuZXcgRGF0ZSgpKTsK\nICAgICAgICByZXR1cm4gcmlkZXI7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIHZlcmlmeUFubnVpdHlWYWx1ZXMoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0\nb3J5U1BJIG15RU1GLCBJQW5udWl0eSBhbm51aXR5LCBBbm51aXR5VHlwZSBh\nbm51aXR5VHlwZSkKICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIElB\nbm51aXR5IHJlc3VsdHMgPSBmaW5kQW5udWl0eUJ5SWQobXlFTUYsIEFubnVp\ndHkuY2xhc3MsIGFubnVpdHkuZ2V0SWQoKSk7CiAgICAgICAgaWYgKGFubnVp\ndHkgaW5zdGFuY2VvZiBJRml4ZWRBbm51aXR5KSB7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFsKChJRml4ZWRBbm51aXR5KWFubnVpdHksIChJRml4ZWRBbm51\naXR5KXJlc3VsdHMsCiAgICAgICAgICAgICAgICAiRml4ZWQgQW5udWl0eSBm\ncm9tIENsaWVudCBpcyBub3QgZXF1YWwgdG8gREIgdmFsdWUiLCAiTWlzbWFj\ndGggd2FzIGZvdW5kLiIpOwogICAgICAgIH0gZWxzZSBpZiAoYW5udWl0eSBp\nbnN0YW5jZW9mIElFcXVpdHlBbm51aXR5KSB7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFsKChJRXF1aXR5QW5udWl0eSlhbm51aXR5LCAoSUVxdWl0eUFubnVp\ndHkpcmVzdWx0cywKICAgICAgICAgICAgICAgICAgICAiRXF1aXR5IEFubnVp\ndHkgZnJvbSBDbGllbnQgaXMgbm90IGVxdWFsIHRvIERCIHZhbHVlIiwgIk1p\nc21hY3RoIHdhcyBmb3VuZC4iKTsgICAgICAgICAgCiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWwoYW5udWl0eSwgcmVzdWx0cywK\nICAgICAgICAgICAgICAgICAgICAiQmFzaWMgQW5udWl0eSBmcm9tIENsaWVu\ndCBpcyBub3QgZXF1YWwgdG8gREIgdmFsdWUiLCAiTWlzbWFjdGggd2FzIGZv\ndW5kLiIpOyAgICAgICAgICAgCiAgICAgICAgfQogICAgCiAgICAgICAgYXNz\nZXJ0RXF1YWwoYW5udWl0eS5nZXRQYXlvdXRzKCksIHJlc3VsdHMuZ2V0UGF5\nb3V0cygpLCAKICAgICAgICAgICAgICAgICJBbm51aXR5IHBheW91dHMgZnJv\nbSBDbGllbnQgaXMgbm90IGVxdWFsIHRvIERCIHZhbHVlIiwgIk1pc21hY3Ro\nIHdhcyBmb3VuZCBpbiBudW1iZXIgb2YgcGF5b3V0cyIpOyAgICAgCiAgICAg\nICAgYm9vbGVhbiBmb3VuZCA9IGZhbHNlOwogICAgICAgIGlmIChhbm51aXR5\nLmdldFBheW91dHMoKSAhPSBudWxsKSB7CiAgICAgICAgICAgIElQYXlvdXQg\nY2xpZW50UGF5b3V0ID0gbnVsbDsKICAgICAgICAgICAgZm9yIChpbnQgaT0w\nOyBpPGFubnVpdHkuZ2V0UGF5b3V0cygpLnNpemUoKTsgaSsrKSB7ICAgICAK\nICAgICAgICAgICAgICAgIGZvdW5kID0gZmFsc2U7ICAvLyByZXNldAogICAg\nICAgICAgICAgICAgY2xpZW50UGF5b3V0ID0gYW5udWl0eS5nZXRQYXlvdXRz\nKCkuZ2V0KGkpOwogICAgICAgICAgICAgICAgZm9yIChJUGF5b3V0IHJlc3Vs\ndFBheW91dDogcmVzdWx0cy5nZXRQYXlvdXRzKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoY2xpZW50UGF5b3V0LmdldElkKCkuZXF1YWxzKHJlc3Vs\ndFBheW91dC5nZXRJZCgpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGZv\ndW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0RXF1\nYWwoY2xpZW50UGF5b3V0LCByZXN1bHRQYXlvdXQsIAogICAgICAgICAgICAg\nICAgICAgICAgICAiQW5udWl0eSBQYXlvdXQgZnJvbSBDbGllbnQgaXMgbm90\nIGVxdWFsIHRvIERCIHZhbHVlIGF0IGxvY2F0aW9uOiAiICtpICwgIk1pc21h\nY3RoIHdhcyBmb3VuZCIpOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewog\nICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBp\nZiAoIShmb3VuZCkgJiYgY2xpZW50UGF5b3V0ICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigiQW5u\ndWl0eTogUGF5b3V0IGZyb20gY2xpZW50IGlzIG5vdCBlcXVhbCB0byBEQi4g\nICIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkZvdW5kIFBheW91\ndCB3aXRoIGlkOiAiICsgY2xpZW50UGF5b3V0LmdldElkKCkgKyAKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICIgb24gdGhlIGNsaWVudCBzaWRlLCBi\ndXQgbm90IGluIHRoZSBkYXRhYmFzZSBmb3IgYW5udWl0eSBpZDoiICsgYW5u\ndWl0eS5nZXRJZCgpKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBhc3NlcnRSaWRlcnNFcXVhbChhbm51aXR5LmdldFJpZGVycygpLCBy\nZXN1bHRzLmdldFJpZGVycygpLCAKICAgICAgICAgICAgICAgICJBbm51aXR5\nIHJpZGVyIGZyb20gQ2xpZW50IGlzIG5vdCBlcXVhbCB0byBEQiB2YWx1ZSIs\nICJNaXNtYWN0aCB3YXMgZm91bmQgaW4gbnVtYmVyIG9mIHJpZGVyIik7ICAg\nICAKICAgICAgICBpZiAoYW5udWl0eS5nZXRSaWRlcnMoKSAhPSBudWxsKSB7\nCiAgICAgICAgICAgIElSaWRlciBjbGllbnRSaWRlciA9IG51bGw7CiAgICAg\nICAgICAgIGZvciAoaW50IGk9MDsgaTxhbm51aXR5LmdldFJpZGVycygpLnNp\nemUoKTsgaSsrKSB7ICAgICAgCiAgICAgICAgICAgICAgICBmb3VuZCA9IGZh\nbHNlOyAgLy8gcmVzZXQKICAgICAgICAgICAgICAgIGNsaWVudFJpZGVyID0g\nYW5udWl0eS5nZXRSaWRlcnMoKS5nZXQoaSk7CiAgICAgICAgICAgICAgICBm\nb3IgKElSaWRlciByZXN1bHRSaWRlciA6IHJlc3VsdHMuZ2V0UmlkZXJzKCkp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2xpZW50UmlkZXIuZ2V0SWQo\nKS5lcXVhbHMocmVzdWx0UmlkZXIuZ2V0SWQoKSkpewogICAgICAgICAgICAg\nICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGFzc2VydEVxdWFsKGNsaWVudFJpZGVyLCByZXN1bHRSaWRlciwgCiAg\nICAgICAgICAgICAgICAgICAgICAgICJBbm51aXR5IHJpZGVyIGZyb20gQ2xp\nZW50IGlzIG5vdCBlcXVhbCB0byBEQiB2YWx1ZSBhdCBsb2NhdGlvbjogIiAr\naSAsICJNaXNtYWN0aCB3YXMgZm91bmQiKTsKICAgICAgICAgICAgICAgICAg\nICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgaWYgKCEoZm91bmQpICYmIGNsaWVudFJpZGVyICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2Vw\ndGlvbigiQW5udWl0eTogUmlkZXIgZnJvbSBjbGllbnQgaXMgbm90IGVxdWFs\nIHRvIERCLiAgIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRm91\nbmQgcmlkZXIgd2l0aCBpZDogIiArIGNsaWVudFJpZGVyLmdldElkKCkgKyAK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgb24gdGhlIGNsaWVudCBz\naWRlLCBidXQgbm90IGluIHRoZSBkYXRhYmFzZSBmb3IgYW5udWl0eSBpZDoi\nICsgYW5udWl0eS5nZXRJZCgpKTsKICAgICAgICAgICAgICAgICAgICAKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBhc3NlcnRQYXlvcnNFcXVhbChhbm51aXR5LmdldFBheW9y\ncygpLCByZXN1bHRzLmdldFBheW9ycygpLCAKICAgICAgICAgICAgICAgICJB\nbm51aXR5IFBheW9yIGZyb20gQ2xpZW50IGlzIG5vdCBlcXVhbCB0byBEQiB2\nYWx1ZSIsICJNaXNtYWN0aCB3YXMgZm91bmQuIik7CiAgICAgICAgaWYgKGFu\nbnVpdHkuZ2V0UGF5b3JzKCkgIT0gbnVsbCkgewogICAgICAgICAgICBJUGF5\nb3IgY2xpZW50UGF5b3IgPSBudWxsOwogICAgICAgICAgICBmb3IgKGludCBp\nPTA7IGk8YW5udWl0eS5nZXRQYXlvcnMoKS5zaXplKCk7IGkrKykgeyAgICAg\nIAogICAgICAgICAgICAgICAgZm91bmQgPSBmYWxzZTsgIC8vIHJlc2V0CiAg\nICAgICAgICAgICAgICBjbGllbnRQYXlvciA9IGFubnVpdHkuZ2V0UGF5b3Jz\nKCkuZ2V0KGkpOwogICAgICAgICAgICAgICAgZm9yIChJUGF5b3IgcmVzdWx0\nUGF5b3IgOiByZXN1bHRzLmdldFBheW9ycygpKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKGNsaWVudFBheW9yLmdldElkKCkuZXF1YWxzKHJlc3VsdFBh\neW9yLmdldElkKCkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQg\nPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbChh\nbm51aXR5LmdldFBheW9ycygpLmdldChpKSwgcmVzdWx0UGF5b3IsIAogICAg\nICAgICAgICAgICAgICAgICAgICAiQW5udWl0eSBwYXlvciBmcm9tIENsaWVu\ndCBpcyBub3QgZXF1YWwgdG8gREIgdmFsdWUgYXQgbG9jYXRpb246ICIgK2kg\nLCAiTWlzbWFjdGggd2FzIGZvdW5kIik7CiAgICAgICAgICAgICAgICAgICAg\nfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIGlmICghKGZvdW5kKSAmJiBjbGllbnRQYXlvciAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRp\nb24oIkFubnVpdHk6IFBheW9yIGZyb20gY2xpZW50IGlzIG5vdCBlcXVhbCB0\nbyBEQi4gICIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkZvdW5k\nIHBheW9yIHdpdGggaWQ6ICIgKyBjbGllbnRQYXlvci5nZXRJZCgpICsgCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAiIG9uIHRoZSBjbGllbnQgc2lk\nZSwgYnV0IG5vdCBpbiB0aGUgZGF0YWJhc2UgZm9yIGFubnVpdHkgaWQ6IiAr\nIGFubnVpdHkuZ2V0SWQoKSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAg\nICAKICAgIHByaXZhdGUgdm9pZCBhc3NlcnRFcXVhbChJQW5udWl0eSBhbm51\naXR5LCBJQW5udWl0eSByZXN1bHRzLCBTdHJpbmcgc3RyaW5nLCBTdHJpbmcg\nc3RyaW5nMikgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYoYW5udWl0\neSA9PSBudWxsICYmIHJlc3VsdHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIGlmIChhbm51aXR5ID09IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBBbm51aXRp\nZXMgISBlcXVhbCAoQW5udWl0eSB3YXMgbnVsbCkuIik7CiAgICAgICAgaWYg\nKCFhbm51aXR5LmdldElkKCkuZXF1YWxzKHJlc3VsdHMuZ2V0SWQoKSkpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oIkFubnVp\ndHk6IEFubnVpdGllcyAhIGVxdWFsIChBbm51aXR5IGlkcyBub3QgdGhlIHNh\nbWUpLiIpOwogICAgICAgIH0KICAgICAgICBhc3NlcnRQYXlvcnNFcXVhbChh\nbm51aXR5LmdldFBheW9ycygpLCByZXN1bHRzLmdldFBheW9ycygpLCBzdHJp\nbmcsIHN0cmluZzIpOwogICAgICAgIGFzc2VydFJpZGVyc0VxdWFsKGFubnVp\ndHkuZ2V0UmlkZXJzKCksIHJlc3VsdHMuZ2V0UmlkZXJzKCksIHN0cmluZywg\nc3RyaW5nMik7CiAgICAgICAgYXNzZXJ0RXF1YWwoYW5udWl0eS5nZXRQYXlv\ndXRzKCkscmVzdWx0cy5nZXRQYXlvdXRzKCksIHN0cmluZywgc3RyaW5nMik7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFzc2VydEVxdWFsKElFcXVpdHlB\nbm51aXR5IGFubnVpdHksIElFcXVpdHlBbm51aXR5IHJlc3VsdHMsIFN0cmlu\nZyBzdHJpbmcsIFN0cmluZyBzdHJpbmcyKQogICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYoYW5udWl0eSA9PSBudWxsICYmIHJlc3VsdHMgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmIChhbm51aXR5\nID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0\naW9uKCJBbm51aXR5OiBBbm51aXRpZXMgISBlcXVhbCAoRXF1aXR5QW5udWl0\neSB3YXMgbnVsbCkuIik7CiAgICAgICAgaWYgKCFhbm51aXR5LmdldElkKCku\nZXF1YWxzKHJlc3VsdHMuZ2V0SWQoKSkpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IFJ1bnRpbWVFeGNlcHRpb24oIkFubnVpdHk6IEFubnVpdGllcyAhIGVx\ndWFsIChFcXVpdHlBbm51aXR5IGlkcyBub3QgdGhlIHNhbWUpLiIpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBhc3NlcnRQYXlvcnNFcXVhbChhbm51\naXR5LmdldFBheW9ycygpLCByZXN1bHRzLmdldFBheW9ycygpLCBzdHJpbmcs\nIHN0cmluZzIpOwogICAgICAgIGFzc2VydFJpZGVyc0VxdWFsKGFubnVpdHku\nZ2V0UmlkZXJzKCksIHJlc3VsdHMuZ2V0UmlkZXJzKCksIHN0cmluZywgc3Ry\naW5nMik7CiAgICAgICAgYXNzZXJ0RXF1YWwoYW5udWl0eS5nZXRQYXlvdXRz\nKCkscmVzdWx0cy5nZXRQYXlvdXRzKCksIHN0cmluZywgc3RyaW5nMik7CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIGFzc2VydEVxdWFsKElGaXhlZEFubnVp\ndHkgYW5udWl0eSwgSUZpeGVkQW5udWl0eSByZXN1bHRzLCBTdHJpbmcgc3Ry\naW5nLCBTdHJpbmcgc3RyaW5nMikKICAgIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGlmKGFubnVpdHkgPT0gbnVsbCAmJiByZXN1bHRzID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBpZiAoYW5udWl0eSA9PSBu\ndWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigi\nQW5udWl0eTogQW5udWl0aWVzICEgZXF1YWwgKEZpeGVkQW5udWl0eSB3YXMg\nbnVsbCkuIik7CiAgICAgICAgaWYgKCFhbm51aXR5LmdldElkKCkuZXF1YWxz\nKHJlc3VsdHMuZ2V0SWQoKSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFJ1\nbnRpbWVFeGNlcHRpb24oIkFubnVpdHk6IEFubnVpdGllcyAhIGVxdWFsIChG\naXhlZEFubnVpdHkgaWRzIG5vdCB0aGUgc2FtZSkuIik7CiAgICAgICAgfQog\nICAgICAgIGFzc2VydFBheW9yc0VxdWFsKGFubnVpdHkuZ2V0UGF5b3JzKCks\nIHJlc3VsdHMuZ2V0UGF5b3JzKCksIHN0cmluZywgc3RyaW5nMik7CiAgICAg\nICAgYXNzZXJ0UmlkZXJzRXF1YWwoYW5udWl0eS5nZXRSaWRlcnMoKSwgcmVz\ndWx0cy5nZXRSaWRlcnMoKSwgc3RyaW5nLCBzdHJpbmcyKTsKICAgICAgICBh\nc3NlcnRFcXVhbChhbm51aXR5LmdldFBheW91dHMoKSxyZXN1bHRzLmdldFBh\neW91dHMoKSwgc3RyaW5nLCBzdHJpbmcyKTsKICAgIH0KCiAgICBwcml2YXRl\nIElBbm51aXR5IGZpbmRBbm51aXR5QnlJZChPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnlTUEkgbXlFTUYsIENsYXNzPEFubnVpdHk+IGNsYXNzMSwgU3Ry\naW5nIGlkKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGNyZWF0ZUVN\nKG15RU1GKTsKICAgICAgICBJQW5udWl0eSBhbm4gPSBlbS5maW5kKGNsYXNz\nMSwgaWQpOwogICAgICAgIGNsb3NlRU0oZW0pOwogICAgICAgIHJldHVybiBh\nbm47CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFzc2VydEVxdWFsKExpc3Q8\nSVBheW91dD4gcGF5b3V0cywgTGlzdDxJUGF5b3V0PiBwYXlvdXRzMiwgU3Ry\naW5nIHN0cmluZywgU3RyaW5nIHN0cmluZzIpCiAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBpZiAocGF5b3V0cyA9PSBudWxsICYmIHBheW91dHMy\nID09IG51bGwpIAogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKHBh\neW91dHMgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVF\neGNlcHRpb24oIkFubnVpdHk6IElQYXlvdXQgbGlzdCBub3QgdGhlIHNhbWUg\nKHBheW91dHMgd2FzIG51bGwpISIpOwogICAgICAgIGlmIChwYXlvdXRzLnNp\nemUoKSAhPSBwYXlvdXRzMi5zaXplKCkpCiAgICAgICAgICAgIHRocm93IG5l\ndyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBJUGF5b3V0IGxpc3Qgbm90\nIHRoZSBzYW1lIChwYXlvdXRzIHNpemUgbm90IHRoZSBzYW1lKSEiKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBheW91dHMuc2l6ZSgpOyBpKysp\nIHsKICAgICAgICAgICAgSVBheW91dCBwYXlvdXQgPSBwYXlvdXRzLmdldChp\nKTsKICAgICAgICAgICAgYm9vbGVhbiBmb3VuZCA9IGZhbHNlOwogICAgICAg\nICAgICBmb3IgKGludCBqID0gMDsgaSA8IHBheW91dHMyLnNpemUoKTsgaisr\nKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIGFzc2VydEVxdWFsKHBheW91dCwgcGF5b3V0czIuZ2V0KGopLCBzdHJpbmcs\nIHN0cmluZzIpOwogICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgY29u\ndGludWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIFJ1bnRpbWVFeGNlcHRpb24oIkFubnVpdHk6IElQYXlvdXQgbGlzdCBub3Qg\ndGhlIHNhbWUgKG5vIG1hdGNoIGZvdW5kKSEiKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0RXF1YWwo\nSVBheW91dCBjbGllbnRQYXlvdXQsIElQYXlvdXQgcmVzdWx0UGF5b3V0LCBT\ndHJpbmcgc3RyaW5nLCBTdHJpbmcgc3RyaW5nMikKICAgIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIGlmIChjbGllbnRQYXlvdXQgPT0gbnVsbCAmJiBy\nZXN1bHRQYXlvdXQgPT0gbnVsbCkgCiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICBpZiAoY2xpZW50UGF5b3V0ID09IG51bGwpCiAgICAgICAgICAgIHRo\ncm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBJUGF5b3V0IG5v\ndCB0aGUgc2FtZSAoY2xpZW50UGF5b3V0IHdhcyBudWxsKSEgIiArCiAgICAg\nICAgICAgICAgICBzdHJpbmcgKyAiICIgKyBzdHJpbmcyKTsKICAgICAgICBp\nZiAoY2xpZW50UGF5b3V0LmdldElkKCkuZXF1YWxzKHJlc3VsdFBheW91dC5n\nZXRJZCgpKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIHRocm93IG5l\ndyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBJUGF5b3V0IG5vdCB0aGUg\nc2FtZSAoY2xpZW50UGF5b3V0IGlkcyBub3QgdGhlIHNhbWUpISAiICsKICAg\nICAgICAgICAgc3RyaW5nICsgIiAiICsgc3RyaW5nMik7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIGFzc2VydFJpZGVyc0VxdWFsKExpc3Q8SVJpZGVyPiBy\naWRlcnMsIExpc3Q8SVJpZGVyPiByaWRlcnMyLCBTdHJpbmcgc3RyaW5nLCBT\ndHJpbmcgc3RyaW5nMikKICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIGlmIChyaWRlcnMgPT0gbnVsbCAmJiByaWRlcnMyID09IG51bGwpIAogICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKHJpZGVycyA9PSBudWxsKQog\nICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigiQW5udWl0\neTogSVJpZGVyIGxpc3Qgbm90IHRoZSBzYW1lIChyaWRlcnMgd2FzIG51bGwp\nISIpOwogICAgICAgIGlmIChyaWRlcnMuc2l6ZSgpICE9IHJpZGVyczIuc2l6\nZSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigi\nQW5udWl0eTogSVJpZGVyIGxpc3Qgbm90IHRoZSBzYW1lIChyaWRlcnMgc2l6\nZSBub3QgdGhlIHNhbWUpISIpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgcmlkZXJzLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIElSaWRlciBy\naWRlciA9IHJpZGVycy5nZXQoaSk7CiAgICAgICAgICAgIGJvb2xlYW4gZm91\nbmQgPSBmYWxzZTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGkgPCBy\naWRlcnMyLnNpemUoKTsgaisrKSB7CiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIGFzc2VydEVxdWFsKHJpZGVyLCByaWRlcnMy\nLmdldChqKSwgc3RyaW5nLCBzdHJpbmcyKTsKICAgICAgICAgICAgICAgICAg\nICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBJ\nUmlkZXIgbGlzdCBub3QgdGhlIHNhbWUgKG1hdGNoIG5vdCBmb3VuZCkhIik7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIGFzc2VydEVxdWFsKElSaWRlciBjbGllbnRSaWRlciwgSVJpZGVyIHJl\nc3VsdFJpZGVyLCBTdHJpbmcgc3RyaW5nLCBTdHJpbmcgc3RyaW5nMikgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGNsaWVudFJpZGVyID09IG51\nbGwgJiYgcmVzdWx0UmlkZXIgPT0gbnVsbCkgCiAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICBpZiAoY2xpZW50UmlkZXIgPT0gbnVsbCkKICAgICAgICAg\nICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oIkFubnVpdHk6IElSaWRl\nciBub3QgdGhlIHNhbWUgKGNsaWVudFJpZGVyIHdhcyBudWxsKSEgIiArCiAg\nICAgICAgICAgICAgICBzdHJpbmcgKyAiICIgKyBzdHJpbmcyKTsKICAgICAg\nICBpZiAoY2xpZW50UmlkZXIuZ2V0SWQoKS5lcXVhbHMocmVzdWx0UmlkZXIu\nZ2V0SWQoKSkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB0aHJvdyBu\nZXcgUnVudGltZUV4Y2VwdGlvbigiQW5udWl0eTogSVJpZGVyIG5vdCB0aGUg\nc2FtZSAobm8gbWF0Y2ggZm91bmQpISAiICsKICAgICAgICAgICAgc3RyaW5n\nICsgIiAiICsgc3RyaW5nMik7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFz\nc2VydFBheW9yc0VxdWFsKExpc3Q8SVBheW9yPiBwYXlvcnMsIExpc3Q8SVBh\neW9yPiBwYXlvcnMyLCBTdHJpbmcgc3RyaW5nLCBTdHJpbmcgc3RyaW5nMikK\nICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChwYXlvcnMgPT0g\nbnVsbCAmJiBwYXlvcnMyID09IG51bGwpIAogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgaWYgKHBheW9ycyA9PSBudWxsKQogICAgICAgICAgICB0aHJv\ndyBuZXcgUnVudGltZUV4Y2VwdGlvbigiQW5udWl0eTogSVBheW9yIGxpc3Qg\nbm90IHRoZSBzYW1lIChwYXlvcnMgd2FzIG51bGwpISIpOwogICAgICAgIGlm\nIChwYXlvcnMuc2l6ZSgpICE9IHBheW9yczIuc2l6ZSgpKQogICAgICAgICAg\nICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigiQW5udWl0eTogSVBheW9y\nIGxpc3Qgbm90IHRoZSBzYW1lIChwYXlvcnMgc2l6ZSBub3QgdGhlIHNhbWUp\nISBwYXlvcnM9IiArCiAgICAgICAgICAgICAgICBwYXlvcnMudG9BcnJheSgp\nLnRvU3RyaW5nKCkgKyAiLCBwYXlvcnMyPSIgKyBwYXlvcnMyLnRvU3RyaW5n\nKCkpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGF5b3JzLnNpemUo\nKTsgaSsrKSB7CiAgICAgICAgICAgIElQYXlvciBwYXlvciA9IHBheW9ycy5n\nZXQoaSk7CiAgICAgICAgICAgIGJvb2xlYW4gZm91bmQgPSBmYWxzZTsKICAg\nICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGkgPCBwYXlvcnMyLnNpemUoKTsg\naisrKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIGFzc2VydEVxdWFsKHBheW9yLCBwYXlvcnMyLmdldChqKSwgc3RyaW5n\nLCBzdHJpbmcyKTsKICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7\nCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIGNv\nbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBJUGF5b3IgbGlzdCBub3Qg\ndGhlIHNhbWUgKG5vIG1hdGNoIGZvdW5kKSEiKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgdmVyaWZ5UGF5b3JW\nYWx1ZXMoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIG15RU1GLCBJ\nUGF5b3IgcGF5b3IpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIElQYXlv\nciByZXN1bHRzID0gbnVsbDsgCiAgICAgICAgcmVzdWx0cyA9IGZpbmRQYXlv\nckJ5SWQobXlFTUYsIFBheW9yLmNsYXNzLCBwYXlvci5nZXRJZCgpKTsKICAg\nICAgICBhc3NlcnRFcXVhbChwYXlvciwgcmVzdWx0cywKICAgICAgICAgICAg\nICAgICJQYXlvciBmcm9tIENsaWVudCBpcyBub3QgZXF1YWwgdG8gREIgdmFs\ndWUuIiwgIk1pc21hY3RoIHdhcyBmb3VuZC4iKTsKICAgIH0KCiAgICBwcml2\nYXRlIElQYXlvciBmaW5kUGF5b3JCeUlkKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSSBteUVNRiwgQ2xhc3M8UGF5b3I+IGNsYXNzMSwgU3RyaW5n\nIGlkKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGNyZWF0ZUVNKG15\nRU1GKTsKICAgICAgICBJUGF5b3IgaXAgPSBlbS5maW5kKGNsYXNzMSwgaWQp\nOwogICAgICAgIGNsb3NlRU0oZW0pOwogICAgICAgIHJldHVybiBpcDsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0RXF1YWwoSVBheW9yIHBheW9y\nLCBJUGF5b3IgcmVzdWx0cywgU3RyaW5nIHN0cmluZywgU3RyaW5nIHN0cmlu\nZzIpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChwYXlvciA9PSBu\ndWxsICYmIHJlc3VsdHMgPT0gbnVsbCkgCiAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICBpZiAocGF5b3IgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cg\nbmV3IFJ1bnRpbWVFeGNlcHRpb24oIkFubnVpdHk6IElQYXlvciBub3QgdGhl\nIHNhbWUgKHBheW9yIHdhcyBudWxsKSEgIiArCiAgICAgICAgICAgICAgICBz\ndHJpbmcgKyAiICIgKyBzdHJpbmcyKTsKICAgICAgICBpZiAocGF5b3IuZ2V0\nSWQoKS5lcXVhbHMocmVzdWx0cy5nZXRJZCgpKSkKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJBbm51\naXR5OiBJUGF5b3Igbm90IHRoZSBzYW1lIChubyBtYXRjaCBmb3VuZCkhICIg\nKwogICAgICAgICAgICBzdHJpbmcgKyAiICIgKyBzdHJpbmcyKTsKICAgIH0K\nCiAgICBwcml2YXRlIElQYXlvciBjcmVhdGVQYXlvcihPcGVuSlBBRW50aXR5\nTWFuYWdlckZhY3RvcnlTUEkgbXlFTUYpIHsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gY3JlYXRlRU0obXlFTUYpOwogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBJUGF5b3IgcGF5b3IgPSBuZXcg\nUGF5b3IoKTsKICAgICAgICBwYXlvci5zZXRJZChnZXRJZCgpKTsKICAgICAg\nICBwYXlvci5zZXROYW1lKCJQYXlvciIpOwogICAgICAgIGVtLnBlcnNpc3Qo\ncGF5b3IpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7\nCiAgICAgICAgY2xvc2VFTShlbSk7CiAgICAgICAgcmV0dXJuIHBheW9yOwog\nICAgfQoKICAgIHByaXZhdGUgdm9pZCB2ZXJpZnlBbm51aXR5SG9sZGVyVmFs\ndWVzKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBteUVNRiwgSUFu\nbnVpdHlIb2xkZXIgYW5udWl0eUhvbGRlcikKICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIElBbm51aXR5SG9sZGVyIHJlc3VsdCA9IG51bGw7CiAg\nICAgICAgcmVzdWx0ID0gZmluZEhvbGRlckJ5SWQobXlFTUYsIEFubnVpdHlI\nb2xkZXIuY2xhc3MsIGFubnVpdHlIb2xkZXIuZ2V0SWQoKSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWwoYW5udWl0eUhvbGRlciwgcmVzdWx0LCAKICAgICAgICAg\nICAgIkFubnVpdHkgSG9sZGVyIGZyb20gQ2xpZW50IGlzIG5vdCBlcXVhbCB0\nbyBEQiB2YWx1ZS4iLCAiTWlzbWFjdGggd2FzIGZvdW5kLiIpOwogICAgICAg\nIGFzc2VydEVxdWFsKGFubnVpdHlIb2xkZXIuZ2V0Q29udGFjdCgpLCByZXN1\nbHQuZ2V0Q29udGFjdCgpLCAKICAgICAgICAgICAgICAgICJBbm51aXR5IEhv\nbGRlciBDb250YWN0IGZyb20gQ2xpZW50IGlzIG5vdCBlcXVhbCB0byBEQiB2\nYWx1ZS4iLCAiTWlzbWFjdGggd2FzIGZvdW5kLiIpOwogICAgfQogICAgCiAg\nICBwcml2YXRlIElBbm51aXR5SG9sZGVyIGZpbmRIb2xkZXJCeUlkKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBteUVNRiwgQ2xhc3M8QW5udWl0\neUhvbGRlcj4gY2xhc3MxLCBTdHJpbmcgaWQpCiAgICB7CiAgICAgICAgRW50\naXR5TWFuYWdlciBlbSA9IGNyZWF0ZUVNKG15RU1GKTsKICAgICAgICBJQW5u\ndWl0eUhvbGRlciByZXN1bHQgPSBlbS5maW5kKGNsYXNzMSwgaWQpOwogICAg\nICAgIGNsb3NlRU0oZW0pOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9\nCgogICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyIGNyZWF0ZUVNKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBteUVNRikgewogICAgICAgIHJldHVy\nbiBteUVNRi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIGNsb3NlRU0oRW50aXR5TWFuYWdlciBlbSkgewogICAgICAg\nIGlmIChlbSAhPSBudWxsKSB7CiAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAg\nICAgICAgICAgIGVtID0gbnVsbDsKICAgICAgICB9CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIGFzc2VydEVxdWFsKElBbm51aXR5SG9sZGVyIGFubnVpdHlI\nb2xkZXIsIElBbm51aXR5SG9sZGVyIHJlc3VsdHMsIFN0cmluZyBzdHJpbmcs\nIFN0cmluZyBzdHJpbmcyKQogICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIGlmIChhbm51aXR5SG9sZGVyID09IG51bGwgJiYgcmVzdWx0cyA9\nPSBudWxsKSAKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\naWYgKGFubnVpdHlIb2xkZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBJQW5udWl0eUhv\nbGRlciBub3QgdGhlIHNhbWUgKGFubnVpdHlIb2xkZXIgd2FzIG51bGwpISAi\nICsKICAgICAgICAgICAgICAgICAgICBzdHJpbmcgKyAiICIgKyBzdHJpbmcy\nKTsKICAgICAgICAgICAgaWYgKGFubnVpdHlIb2xkZXIuZ2V0SWQoKS5lcXVh\nbHMocmVzdWx0cy5nZXRJZCgpKSkKICAgICAgICAgICAgICAgIHJldHVybjsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oIkFubnVp\ndHk6IElBbm51aXR5SG9sZGVyIG5vdCB0aGUgc2FtZSAobm8gbWF0Y2ggZm91\nbmQpISAiICsKICAgICAgICAgICAgICAgIHN0cmluZyArICIgIiArIHN0cmlu\nZzIpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhc3NlcnRFcXVhbChJQ29u\ndGFjdCBjb250YWN0LCBJQ29udGFjdCBjb250YWN0MiwgU3RyaW5nIHN0cmlu\nZywgU3RyaW5nIHN0cmluZzIpIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIGlmIChjb250YWN0ID09IG51bGwgJiYgY29udGFjdDIgPT0gbnVsbCkgCiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICBpZiAoY29udGFjdCA9PSBudWxs\nKQogICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigiQW5u\ndWl0eTogQ29udGFjdHMgbm90IHRoZSBzYW1lIChjb250YWN0IHdhcyBudWxs\nKSEgIiArCiAgICAgICAgICAgICAgICBzdHJpbmcgKyAiICIgKyBzdHJpbmcy\nKTsKICAgICAgICBpZiAoY29udGFjdC5nZXRJZCgpLmVxdWFscyhjb250YWN0\nMi5nZXRJZCgpKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIHRocm93\nIG5ldyBSdW50aW1lRXhjZXB0aW9uKCJBbm51aXR5OiBDb250YWN0cyBub3Qg\ndGhlIHNhbWUgKG5vIG1hdGNoIGZvdW5kKSEgIiArCiAgICAgICAgICAgIHN0\ncmluZyArICIgIiArIHN0cmluZzIpOwogICAgfQoKICAgIHByaXZhdGUgSUFu\nbnVpdHlIb2xkZXIgY3JlYXRlQW5udWl0eUhvbGRlcihPcGVuSlBBRW50aXR5\nTWFuYWdlckZhY3RvcnlTUEkgbXlFTUYsIElDb250YWN0IGNvbnRhY3QpIHsK\nICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gY3JlYXRlRU0obXlFTUYpOwog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBJ\nQW5udWl0eUhvbGRlciBhbm51aXR5SG9sZGVyID0gbmV3IEFubnVpdHlIb2xk\nZXIoKTsKICAgICAgICBhbm51aXR5SG9sZGVyLnNldENhdGVnb3J5KEFubnVp\ndHlIb2xkZXJDYXRlZ29yeS5NRVRBTCk7CiAgICAgICAgYW5udWl0eUhvbGRl\nci5zZXRDb250YWN0KGNvbnRhY3QpOwogICAgICAgIGFubnVpdHlIb2xkZXIu\nc2V0SWQoZ2V0SWQoKSk7CiAgICAgICAgYW5udWl0eUhvbGRlci5zZXRGaXJz\ndE5hbWUoImJvYiIpOwogICAgICAgIGFubnVpdHlIb2xkZXIuc2V0RGF0ZU9m\nQmlydGgobmV3IERhdGUoKSk7CiAgICAgICAgYW5udWl0eUhvbGRlci5zZXRH\nb3Zlcm5tZW50SWQoIlVTIik7CiAgICAgICAgYW5udWl0eUhvbGRlci5zZXRM\nYXN0TmFtZSgiZG9nIik7CiAgICAgICAgYW5udWl0eUhvbGRlci5zZXRUaW1l\nT2ZCaXJ0aChuZXcgRGF0ZSgpKTsKICAgICAgICBlbS5wZXJzaXN0KGFubnVp\ndHlIb2xkZXIpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0\nKCk7CiAgICAgICAgY2xvc2VFTShlbSk7CiAgICAgICAgcmV0dXJuIGFubnVp\ndHlIb2xkZXI7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHZlcmlmeUNvbnRh\nY3RWYWx1ZXMoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIG15RU1G\nLCBJQ29udGFjdCBjb250YWN0KSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICAvLyByZWFkIHRoZSBjb250YWN0IHdpdGggaWQuCiAgICAgICAgSUNvbnRh\nY3QgcmVzdWx0cyA9IG51bGw7CiAgICAgICAgcmVzdWx0cyA9IGZpbmRDb250\nYWN0QnlJZChteUVNRiwgQ29udGFjdC5jbGFzcywgY29udGFjdC5nZXRJZCgp\nKTsKICAgICAgICBhc3NlcnRFcXVhbChjb250YWN0LCByZXN1bHRzLCAKICAg\nICAgICAgICAgIkNvbnRhY3QgZnJvbSBDbGllbnQgaXMgbm90IGVxdWFsIHRv\nIERCIHZhbHVlLiIsICJNaXNtYWN0aCB3YXMgZm91bmQuIik7ICAgICAKICAg\nIH0KCiAgICBwcml2YXRlIElDb250YWN0IGZpbmRDb250YWN0QnlJZChPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgbXlFTUYsIENsYXNzPENvbnRh\nY3Q+IGNsYXNzMSwgU3RyaW5nIGlkKSB7CiAgICAgICAgRW50aXR5TWFuYWdl\nciBlbSA9IGNyZWF0ZUVNKG15RU1GKTsKICAgICAgICBJQ29udGFjdCBpYyA9\nIGVtLmZpbmQoY2xhc3MxLCBpZCk7CiAgICAgICAgY2xvc2VFTShlbSk7CiAg\nICAgICAgcmV0dXJuIGljOwogICAgfQoKICAgIHByaXZhdGUgSUNvbnRhY3Qg\nY3JlYXRlQ29udGFjdChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkg\nbXlFTUYpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gY3JlYXRlRU0o\nbXlFTUYpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsK\nICAgICAgICBJQ29udGFjdCBjb250YWN0ID0gbnVsbDsKICAgICAgICBjb250\nYWN0ID0gbmV3IENvbnRhY3QoKTsKICAgICAgICBjb250YWN0LnNldENvbnRh\nY3RUeXBlKENvbnRhY3RUeXBlLkJVU0lORVNTKTsKICAgICAgICBjb250YWN0\nLnNldElkKGdldElkKCkpOwogICAgICAgIGNvbnRhY3Quc2V0RW1haWwoImhl\ncmVAdGhlcmUiKTsKICAgICAgICBjb250YWN0LnNldFBob25lKCI1NTUtNTU1\nNSIpOwogICAgICAgIGVtLnBlcnNpc3QoY29udGFjdCk7CiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBjbG9zZUVNKGVt\nKTsKICAgICAgICByZXR1cm4gY29udGFjdDsKICAgIH0KCiAgICBwcml2YXRl\nIFN0cmluZyBnZXRJZCgpIHsKICAgICAgICBVVUlEIHVpZCA9IFVVSUQucmFu\nZG9tVVVJRCgpOwogICAgICAgIHJldHVybiB1aWQudG9TdHJpbmcoKTsKICAg\nIH0KCn0K\n","encoding":"base64"}

