{"sha":"9e50e0a53c636b611d9b8cfd5385d2decd047b1b","node_id":"MDQ6QmxvYjIwNjM2NDo5ZTUwZTBhNTNjNjM2YjYxMWQ5YjhjZmQ1Mzg1ZDJkZWNkMDQ3YjFi","size":4992,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9e50e0a53c636b611d9b8cfd5385d2decd047b1b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucXVlcnlj\nYWNoZTsKCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuTmFtZWRRdWVyeTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UucXVlcnljYWNoZS5jb21tb24uYXBwcy5FbnRpdHkxOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5Y2Fj\naGUuY29tbW9uLmFwcHMuRW50aXR5MjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNRTExpc3RlbmVyVGVzdENhc2U7CgpA\nTmFtZWRRdWVyeShuYW1lID0gInNldFBhcmFtMSIsCiAgICBxdWVyeSA9ICJT\nRUxFQ1QgbyBGUk9NIEVudGl0eTEgbyBXSEVSRSBvLnBrID0gOnBrIikKcHVi\nbGljIGNsYXNzIFRlc3RRdWVyeUNhY2hlIGV4dGVuZHMgU1FMTGlzdGVuZXJU\nZXN0Q2FzZSB7CgogICAgRW50aXR5TWFuYWdlciBlbTsKCiAgICBwdWJsaWMg\ndm9pZCBzZXRVcCgpIHsKICAgICAgICBzdXBlci5zZXRVcCgKICAgICAgICAg\nICAgRFJPUF9UQUJMRVMsCiAgICAgICAgICAgICJvcGVuanBhLlF1ZXJ5Q2Fj\naGUiLCAidHJ1ZSIsIAogICAgICAgICAgICAib3BlbmpwYS5SZW1vdGVDb21t\naXRQcm92aWRlciIsInNqdm0iLAogICAgICAgICAgICBFbnRpdHkxLmNsYXNz\nLEVudGl0eTIuY2xhc3MKICAgICAgICAvLyAsIm9wZW5qcGEuTG9nIiwiU1FM\nPXRyYWNlIgogICAgICAgICAgICApOwogICAgICAgIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgLy9jcmVhdGUgYW5kIHBlcnNp\nc3QgbXVsdGlwbGUgZW50aXR5MSBpbnN0YW5jZXMKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgRW50aXR5MSBl\nbnQgPSBuZXcgRW50aXR5MShpLCAic3RyaW5nIiArIGksIGkgKyAyKTsKICAg\nICAgICAgICAgRW50aXR5MiBlbnQyID0gbmV3IEVudGl0eTIoaSAqIDIsICJl\nbnQyIiArIGksIGkpOwogICAgICAgICAgICBlbnQuc2V0RW50aXR5MkZpZWxk\nKGVudDIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGVudCk7CiAgICAgICAg\nfQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdENhY2hlZFF1ZXJ5KCl7CiAgICAgICAg\nZW0uY3JlYXRlUXVlcnkoIlNlbGVjdCBvYmplY3QobykgZnJvbSBFbnRpdHkx\nIG8iKS5nZXRSZXN1bHRMaXN0KCkuZ2V0KDApOyAgICAgICAgCiAgICAgICAg\ncmVzZXRTUUwoKTsKICAgICAgICBlbS5jcmVhdGVRdWVyeSgiU2VsZWN0IG9i\namVjdChvKSBmcm9tIEVudGl0eTEgbyIpLmdldFJlc3VsdExpc3QoKS5nZXQo\nMCk7CiAgICAgICAgZW0uY3JlYXRlUXVlcnkoIlNlbGVjdCBvYmplY3Qobykg\nZnJvbSBFbnRpdHkxIG8iKS5nZXRSZXN1bHRMaXN0KCkuZ2V0KDApOwogICAg\nICAgIAogICAgICAgIGFzc2VydEVxdWFscygwLCBnZXRTUUxDb3VudCgpKTsK\nICAgICAgICAKICAgIH0KICAgIHB1YmxpYyB2b2lkIHRlc3RSZXN1bHRMaXN0\nKCkgewogICAgICAgIExpc3QgbGlzdCA9IGVtLmNyZWF0ZVF1ZXJ5KCJTZWxl\nY3Qgb2JqZWN0KG8pIGZyb20gRW50aXR5MSBvIikKICAgICAgICAgICAgLmdl\ndFJlc3VsdExpc3QoKTsKCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEwLCBsaXN0\nLnNpemUoKSk7CgogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RHZXRTaW5n\nbGVMaXN0KCkgewoKICAgICAgICBTdHJpbmcgY3VyciA9IDIgKyAiIjsKCiAg\nICAgICAgRW50aXR5MSByZXQgPSAoRW50aXR5MSkgZW0KICAgICAgICAgICAg\nLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgbyBGUk9NIEVudGl0eTEgbyBXSEVSRSBv\nLnBrID0gOnBrIikKICAgICAgICAgICAgLnNldFBhcmFtZXRlcigicGsiLCBM\nb25nLnZhbHVlT2YoY3VycikpCiAgICAgICAgICAgIC5nZXRTaW5nbGVSZXN1\nbHQoKTsKCiAgICAgICAgYXNzZXJ0Tm90TnVsbChyZXQpOwogICAgICAgIGFz\nc2VydEVxdWFscygic3RyaW5nMiIsIHJldC5nZXRTdHJpbmdGaWVsZCgpKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoNCwgcmV0LmdldEludEZpZWxkKCkpOwoK\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEV4ZWN1dGVVcGRhdGUoKSB7\nCiAgICAgICAgU3RyaW5nIGN1cnIgPSAyICsgIiI7CiAgICAgICAgU3RyaW5n\nIGN1cnIyID0gMjIgKyAiIjsKCgogICAgICAgIHN0YXJ0VHgoZW0pOwoKICAg\nICAgICBFbnRpdHkxIGVudGl0eTEgPSAoRW50aXR5MSkgZW0KICAgICAgICAg\nICAgLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgbyBGUk9NIEVudGl0eTEgbyBXSEVS\nRSBvLnBrID0gOnBrIikKICAgICAgICAgICAgLnNldFBhcmFtZXRlcigicGsi\nLCBMb25nLnZhbHVlT2YoY3VycikpCiAgICAgICAgICAgIC5nZXRTaW5nbGVS\nZXN1bHQoKTsKCiAgICAgICAgaW50IHJldCA9IGVtLmNyZWF0ZVF1ZXJ5KCJE\nZWxldGUgRlJPTSBFbnRpdHkxIG8gV0hFUkUgby5wayA9IDpwayIpCiAgICAg\nICAgICAgIC5zZXRQYXJhbWV0ZXIoInBrIiwgTG9uZy52YWx1ZU9mKGN1cnIp\nKQogICAgICAgICAgICAuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhyZXQsIDEpOwoKICAgICAgICAvLyBjYXNjYWRlIHJlbW92ZSBk\nb2Vzbid0IHJlbW92ZSB0aGUgZW50aXR5MgogICAgICAgIGludCByZXRUbXAg\nPSBlbS5jcmVhdGVRdWVyeSgiRGVsZXRlIEZST00gRW50aXR5MiBvIFdIRVJF\nIG8ucGsgPSA6cGsiKQogICAgICAgICAgICAuc2V0UGFyYW1ldGVyKCJwayIs\nIGVudGl0eTEuZ2V0RW50aXR5MkZpZWxkKCkuZ2V0UGsoKSkKICAgICAgICAg\nICAgLmV4ZWN1dGVVcGRhdGUoKTsKCiAgICAgICAgaW50IHJldDIgPSBlbS5j\ncmVhdGVRdWVyeSgiRGVsZXRlIEZST00gRW50aXR5MSBvIFdIRVJFIG8ucGsg\nPSA6cGsiKQogICAgICAgICAgICAuc2V0UGFyYW1ldGVyKCJwayIsIExvbmcu\ndmFsdWVPZihjdXJyMikpCiAgICAgICAgICAgIC5leGVjdXRlVXBkYXRlKCk7\nCgogICAgICAgIGFzc2VydEVxdWFscyhyZXQyLCAwKTsKCiAgICAgICAgZW5k\nVHgoZW0pOwoKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2V0TWF4UmVz\ndWx0cygpIHsKCgogICAgICAgIExpc3QgbCA9IGVtLmNyZWF0ZVF1ZXJ5KCJT\nZWxlY3Qgb2JqZWN0KG8pIGZyb20gRW50aXR5MSBvIikKICAgICAgICAgICAg\nLnNldE1heFJlc3VsdHMoNSkKICAgICAgICAgICAgLmdldFJlc3VsdExpc3Qo\nKTsKCiAgICAgICAgYXNzZXJ0Tm90TnVsbChsKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoNSwgbC5zaXplKCkpOwoKCiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFNldEZpcnN0UmVzdWx0cygpIHsKCgogICAgICAgIExpc3QgbCA9IGVt\nLmNyZWF0ZVF1ZXJ5KCJTZWxlY3Qgb2JqZWN0KG8pIGZyb20gRW50aXR5MSBv\nIikKICAgICAgICAgICAgLnNldEZpcnN0UmVzdWx0KDMpCiAgICAgICAgICAg\nIC5nZXRSZXN1bHRMaXN0KCk7CgogICAgICAgIEVudGl0eTEgZW50ID0gKEVu\ndGl0eTEpIGwuZ2V0KDApOwoKICAgICAgICBhc3NlcnROb3ROdWxsKGVudCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJzdHJpbmczIiwgZW50LmdldFN0cmlu\nZ0ZpZWxkKCkpOwogICAgICAgIGFzc2VydEVxdWFscyg1LCBlbnQuZ2V0SW50\nRmllbGQoKSk7CgoKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydFR4\nKEVudGl0eU1hbmFnZXIgZW0pIHsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmJlZ2luKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNB\nY3RpdmVUeChFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgcmV0dXJuIGVt\nLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBlbmRUeChFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAgICAg\naWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkgewogICAgICAg\nICAgICBpZiAoZW0uZ2V0VHJhbnNhY3Rpb24oKS5nZXRSb2xsYmFja09ubHko\nKSkKICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJh\nY2soKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

