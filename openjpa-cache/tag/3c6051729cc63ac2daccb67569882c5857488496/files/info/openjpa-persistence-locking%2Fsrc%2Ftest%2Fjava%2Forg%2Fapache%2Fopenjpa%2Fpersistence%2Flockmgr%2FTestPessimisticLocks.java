{"sha":"0f91668d3b9e17059c437e53b9d54ec8c30a8e90","node_id":"MDQ6QmxvYjIwNjM2NDowZjkxNjY4ZDNiOWUxNzA1OWM0MzdlNTNiOWQ1NGVjOGMzMGE4ZTkw","size":17074,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0f91668d3b9e17059c437e53b9d54ec8c30a8e90","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5sb2NrbWdyOwoK\naW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5Mb2NrTW9kZVR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QZXNz\naW1pc3RpY0xvY2tFeGNlcHRpb247CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5RdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlF1ZXJ5VGltZW91\ndEV4Y2VwdGlvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlR5cGVkUXVl\ncnk7CgppbXBvcnQganVuaXQuZnJhbWV3b3JrLkFzc2VydGlvbkZhaWxlZEVy\ncm9yOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRC\nQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLkxvY2tUaW1lb3V0RXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuU1FMTGlzdGVuZXJU\nZXN0Q2FzZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wZW5K\nUEFFeGNlcHRpb247CgovKioKICogVGVzdCBQZXNzaW1pc3RpYyBMb2NrIGFu\nZCBleGNlcHRpb24gYmVoYXZpb3IgYWdhaW5zdCBFbnRpdHlNYW5hZ2VyIGFu\nZCBRdWVyeQogKiBpbnRlcmZhY2UgbWV0aG9kcy4KICovCnB1YmxpYyBjbGFz\ncyBUZXN0UGVzc2ltaXN0aWNMb2NrcyBleHRlbmRzIFNRTExpc3RlbmVyVGVz\ndENhc2UgewoKICAgIHByaXZhdGUgREJEaWN0aW9uYXJ5IGRpY3QgPSBudWxs\nOwoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHNldFVwKENM\nRUFSX1RBQkxFUywgRW1wbG95ZWUuY2xhc3MsIERlcGFydG1lbnQuY2xhc3Ms\nICJvcGVuanBhLkxvY2tNYW5hZ2VyIiwgIm1peGVkIik7CgogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBudWxsOwogICAgICAgIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmJlZ2luKCk7CgogICAgICAgIEVtcGxveWVlIGUxLCBlMjsKICAgICAgICBE\nZXBhcnRtZW50IGQxLCBkMjsKICAgICAgICBkMSA9IG5ldyBEZXBhcnRtZW50\nKCk7CiAgICAgICAgZDEuc2V0SWQoMTApOwogICAgICAgIGQxLnNldE5hbWUo\nIkQxMCIpOwoKICAgICAgICBlMSA9IG5ldyBFbXBsb3llZSgpOwogICAgICAg\nIGUxLnNldElkKDEpOwogICAgICAgIGUxLnNldERlcGFydG1lbnQoZDEpOwog\nICAgICAgIGUxLnNldEZpcnN0TmFtZSgiZmlyc3QuMSIpOwogICAgICAgIGUx\nLnNldExhc3ROYW1lKCJsYXN0LjEiKTsKCiAgICAgICAgZDIgPSBuZXcgRGVw\nYXJ0bWVudCgpOwogICAgICAgIGQyLnNldElkKDIwKTsKICAgICAgICBkMi5z\nZXROYW1lKCJEMjAiKTsKCiAgICAgICAgZTIgPSBuZXcgRW1wbG95ZWUoKTsK\nICAgICAgICBlMi5zZXRJZCgyKTsKICAgICAgICBlMi5zZXREZXBhcnRtZW50\nKGQyKTsKICAgICAgICBlMi5zZXRGaXJzdE5hbWUoImZpcnN0LjIiKTsKICAg\nICAgICBlMi5zZXRMYXN0TmFtZSgibGFzdC4yIik7CgogICAgICAgIGVtLnBl\ncnNpc3QoZDEpOwogICAgICAgIGVtLnBlcnNpc3QoZDIpOwogICAgICAgIGVt\nLnBlcnNpc3QoZTEpOwogICAgICAgIGVtLnBlcnNpc3QoZTIpOwogICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICB9CgogICAgLyoK\nICAgICAqIFRlc3QgZmluZCB3aXRoIHBlc3NpbWlzdGljIGxvY2sgYWZ0ZXIg\nYSBxdWVyeSB3aXRoIHBlc3NpbWlzdGljIGxvY2suCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHRlc3RGaW5kQWZ0ZXJRdWVyeVdpdGhQZXNzaW1pc3RpY0xv\nY2tzKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0xID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtMiA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0xLmdldFRy\nYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBUeXBlZFF1ZXJ5PEVtcGxv\neWVlPiBxdWVyeSA9IGVtMS5jcmVhdGVRdWVyeSgic2VsZWN0IGUgZnJvbSBF\nbXBsb3llZSBlIHdoZXJlIGUuaWQgPCAxMCIsIEVtcGxveWVlLmNsYXNzKQog\nICAgICAgICAgICAgICAgLnNldEZpcnN0UmVzdWx0KDEpOwogICAgICAgIC8v\nIExvY2sgYWxsIHNlbGVjdGVkIEVtcGxveWVlcywgc2tpcCB0aGUgZmlyc3Qg\nb25lLCBpLmUgc2hvdWxkIGxvY2sKICAgICAgICAvLyBFbXBsb3llZSgyKQog\nICAgICAgIHF1ZXJ5LnNldExvY2tNb2RlKExvY2tNb2RlVHlwZS5QRVNTSU1J\nU1RJQ19SRUFEKTsKICAgICAgICBxdWVyeS5zZXRIaW50KCJqYXZheC5wZXJz\naXN0ZW5jZS5xdWVyeS50aW1lb3V0IiwgMjAwMCk7CiAgICAgICAgTGlzdDxF\nbXBsb3llZT4gZW1wbG95ZWVzID0gcXVlcnkuZ2V0UmVzdWx0TGlzdCgpOwog\nICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgMSBlbGVtZW50IHdpdGgg\nZW1wbHllZSBpZD0yIiwgZW1wbG95ZWVzLnNpemUoKSwgMSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZSgiVGVzdCBFbXBsb3llZSBmaXJzdCBuYW1lID0gJ2ZpcnN0\nLjInIiwgZW1wbG95ZWVzLmdldCgwKS5nZXRGaXJzdE5hbWUoKS5lcXVhbHMo\nImZpcnN0LjEiKQogICAgICAgICAgICAgICAgfHwgZW1wbG95ZWVzLmdldCgw\nKS5nZXRGaXJzdE5hbWUoKS5lcXVhbHMoImZpcnN0LjIiKSk7CgogICAgICAg\nIGVtMi5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgTWFwPFN0\ncmluZywgT2JqZWN0PiBoaW50cyA9IG5ldyBIYXNoTWFwPFN0cmluZywgT2Jq\nZWN0PigpOwogICAgICAgIGhpbnRzLnB1dCgiamF2YXgucGVyc2lzdGVuY2Uu\nbG9jay50aW1lb3V0IiwgMjAwMCk7CiAgICAgICAgLy8gZmluZCBFbXBsb3ll\nZSgyKSB3aXRoIGEgbG9jaywgc2hvdWxkIGJsb2NrIGFuZCBleHBlY3RlZCBh\nCiAgICAgICAgLy8gUGVzc2ltaXN0aWNMb2NrRXhjZXB0aW9uCiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgZW0yLmZpbmQoRW1wbG95ZWUuY2xhc3MsIDIs\nIExvY2tNb2RlVHlwZS5QRVNTSU1JU1RJQ19SRUFELCBoaW50cyk7CiAgICAg\nICAgICAgIGZhaWwoIlVuZXhjcGVjdGVkIGZpbmQgc3VjY2VlZGVkLiBTaG91\nbGQgdGhyb3cgYSBQZXNzaW1pc3RpY0xvY2tFeGNlcHRpb24uIik7CiAgICAg\nICAgfSBjYXRjaCAoVGhyb3dhYmxlIGUpIHsKICAgICAgICAgICAgYXNzZXJ0\nRXJyb3IoZSwgUGVzc2ltaXN0aWNMb2NrRXhjZXB0aW9uLmNsYXNzKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZW0xLmdldFRyYW5z\nYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgIGVtMS5nZXRU\ncmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIGlmIChlbTIu\nZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAgICAgICAgICAg\nZW0yLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAgICB9Cgog\nICAgICAgIGVtMS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAg\nVHlwZWRRdWVyeTxEZXBhcnRtZW50PiBxdWVyeTIgPSBlbTEuY3JlYXRlUXVl\ncnkoInNlbGVjdCBlLmRlcGFydG1lbnQgZnJvbSBFbXBsb3llZSBlIHdoZXJl\nIGUuaWQgPCAxMCIsCiAgICAgICAgICAgICAgICBEZXBhcnRtZW50LmNsYXNz\nKS5zZXRGaXJzdFJlc3VsdCgxKTsKICAgICAgICAvLyBMb2NrIGFsbCBzZWxl\nY3RlZCBEZXBhcnRtZW50cywgc2tpcCB0aGUgZmlyc3Qgb25lLCBpLmUgc2hv\ndWxkCiAgICAgICAgLy8gbG9jayBEZXBhcnRtZW50KDIwKQogICAgICAgIHF1\nZXJ5LnNldExvY2tNb2RlKExvY2tNb2RlVHlwZS5QRVNTSU1JU1RJQ19SRUFE\nKTsKICAgICAgICBxdWVyeS5zZXRIaW50KCJqYXZheC5wZXJzaXN0ZW5jZS5x\ndWVyeS50aW1lb3V0IiwgMjAwMCk7CiAgICAgICAgTGlzdDxEZXBhcnRtZW50\nPiBkZXB0cyA9IHF1ZXJ5Mi5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKCJFeHBlY3RlZCAxIGVsZW1lbnQgd2l0aCBkZXBhcnRtZW50\nIGlkPTIwIiwgZGVwdHMuc2l6ZSgpLCAxKTsKICAgICAgICBhc3NlcnRUcnVl\nKCJUZXN0IGRlcGFydG1lbnQgbmFtZSA9ICdEMjAnIiwgZGVwdHMuZ2V0KDAp\nLmdldE5hbWUoKS5lcXVhbHMoIkQxMCIpCiAgICAgICAgICAgICAgICB8fCBk\nZXB0cy5nZXQoMCkuZ2V0TmFtZSgpLmVxdWFscygiRDIwIikpOwoKICAgICAg\nICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIE1hcDxT\ndHJpbmcsIE9iamVjdD4gbWFwID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBPYmpl\nY3Q+KCk7CiAgICAgICAgbWFwLnB1dCgiamF2YXgucGVyc2lzdGVuY2UubG9j\nay50aW1lb3V0IiwgMjAwMCk7CiAgICAgICAgLy8gZmluZCBFbXBsb3llZSgy\nKSB3aXRoIGEgbG9jaywgbm8gYmxvY2sgc2luY2Ugb25seSBkZXBhcnRtZW50\nIHdhcwogICAgICAgIC8vIGxvY2tlZAogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIEVtcGxveWVlIGVtcCA9IGVtMi5maW5kKEVtcGxveWVlLmNsYXNzLCAx\nLCBMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfUkVBRCwgbWFwKTsKICAgICAg\nICAgICAgYXNzZXJ0Tm90TnVsbCgiUXVlcnkgbG9ja3MgZGVwYXJ0bWVudCBv\nbmx5LCB0aGVyZWZvcmUgc2hvdWxkIGZpbmQgRW1wbG95ZWUuIiwgZW1wKTsK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0IEVtcGxveWVlIGZpcnN0\nIG5hbWUgPSAnZmlyc3QuMSciLCBlbXAuZ2V0Rmlyc3ROYW1lKCksICJmaXJz\ndC4xIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4KSB7CiAgICAg\nICAgICAgIGZhaWwoIkNhdWdodCB1bmV4cGVjdGVkICIgKyBleC5nZXRDbGFz\ncygpLmdldE5hbWUoKSArICI6IiArIGV4LmdldE1lc3NhZ2UoKSk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKGVtMS5nZXRUcmFuc2Fj\ndGlvbigpLmlzQWN0aXZlKCkpCiAgICAgICAgICAgICAgICBlbTEuZ2V0VHJh\nbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAgICAgICAgICBpZiAoZW0yLmdl\ndFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgIGVt\nMi5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgfQogICAg\nICAgIGVtMS5jbG9zZSgpOwogICAgICAgIGVtMi5jbG9zZSgpOwogICAgfQoK\nICAgIC8qCiAgICAgKiBUZXN0IGZpbmQgd2l0aCBwZXNzaW1pc3RpYyBsb2Nr\nIGFmdGVyIGEgcXVlcnkgd2l0aCBwZXNzaW1pc3RpYyBsb2NrLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0RmluZEFmdGVyUXVlcnlPcmRlckJ5V2l0\naFBlc3NpbWlzdGljTG9ja3MoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBl\nbTEgPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0\neU1hbmFnZXIgZW0yID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBlbTEuZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIFF1\nZXJ5IHF1ZXJ5ID0gZW0xLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgZSBmcm9tIEVt\ncGxveWVlIGUgd2hlcmUgZS5pZCA8IDEwIG9yZGVyIGJ5IGUuaWQiKS5zZXRG\naXJzdFJlc3VsdCgxKTsKICAgICAgICAvLyBMb2NrIGFsbCBzZWxlY3RlZCBF\nbXBsb3llZXMsIHNraXAgdGhlIGZpcnN0IG9uZSwgaS5lIHNob3VsZCBsb2Nr\nCiAgICAgICAgLy8gRW1wbG95ZWUoMikKICAgICAgICBxdWVyeS5zZXRMb2Nr\nTW9kZShMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfUkVBRCk7CiAgICAgICAg\ncXVlcnkuc2V0SGludCgiamF2YXgucGVyc2lzdGVuY2UucXVlcnkudGltZW91\ndCIsIDIwMDApOwogICAgICAgIExpc3Q8RW1wbG95ZWU+IHEgPSBxdWVyeS5n\nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJFeHBlY3Rl\nZCAxIGVsZW1lbnQgd2l0aCBlbXBseWVlIGlkPTIiLCBxLnNpemUoKSwgMSk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0IEVtcGxveWVlIGZpcnN0IG5h\nbWUgPSAnZmlyc3QuMiciLCBxLmdldCgwKS5nZXRGaXJzdE5hbWUoKSwgImZp\ncnN0LjIiKTsKCiAgICAgICAgZW0yLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICBNYXA8U3RyaW5nLCBPYmplY3Q+IG1hcCA9IG5ldyBIYXNo\nTWFwPFN0cmluZywgT2JqZWN0PigpOwogICAgICAgIG1hcC5wdXQoImphdmF4\nLnBlcnNpc3RlbmNlLmxvY2sudGltZW91dCIsIDIwMDApOwogICAgICAgIC8v\nIGZpbmQgRW1wbG95ZWUoMikgd2l0aCBhIGxvY2ssIHNob3VsZCBibG9jayBh\nbmQgZXhwZWN0ZWQgYQogICAgICAgIC8vIFBlc3NpbWlzdGljTG9ja0V4Y2Vw\ndGlvbgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGVtMi5maW5kKEVtcGxv\neWVlLmNsYXNzLCAyLCBMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfUkVBRCwg\nbWFwKTsKICAgICAgICAgICAgZmFpbCgiVW5leGNwZWN0ZWQgZmluZCBzdWNj\nZWVkZWQuIFNob3VsZCB0aHJvdyBhIFBlc3NpbWlzdGljTG9ja0V4Y2VwdGlv\nbi4iKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICBhc3NlcnRFcnJvcihlLCBQZXNzaW1pc3RpY0xvY2tFeGNlcHRpb24u\nY2xhc3MpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChl\nbTEuZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAgICAgICAg\nICAgZW0xLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAgICAg\nICAgaWYgKGVtMi5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZlKCkpCiAgICAg\nICAgICAgICAgICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwog\nICAgICAgIH0KCiAgICAgICAgZW0xLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICBxdWVyeSA9IGVtMS5jcmVhdGVRdWVyeSgic2VsZWN0IGUu\nZGVwYXJ0bWVudCBmcm9tIEVtcGxveWVlIGUgd2hlcmUgZS5pZCA8IDEwIG9y\nZGVyIGJ5IGUuZGVwYXJ0bWVudC5pZCIpCiAgICAgICAgICAgICAgICAuc2V0\nRmlyc3RSZXN1bHQoMSk7CiAgICAgICAgLy8gTG9jayBhbGwgc2VsZWN0ZWQg\nRGVwYXJ0bWVudHMsIHNraXAgdGhlIGZpcnN0IG9uZSwgaS5lIHNob3VsZAog\nICAgICAgIC8vIGxvY2sgRGVwYXJ0bWVudCgyMCkKICAgICAgICBxdWVyeS5z\nZXRMb2NrTW9kZShMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfUkVBRCk7CiAg\nICAgICAgcXVlcnkuc2V0SGludCgiamF2YXgucGVyc2lzdGVuY2UucXVlcnku\ndGltZW91dCIsIDIwMDApOwogICAgICAgIExpc3Q8RGVwYXJ0bWVudD4gcmVz\ndWx0ID0gcXVlcnkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGFzc2VydEVx\ndWFscygiRXhwZWN0ZWQgMSBlbGVtZW50IHdpdGggZGVwYXJ0bWVudCBpZD0y\nMCIsIHEuc2l6ZSgpLCAxKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlRlc3Qg\nZGVwYXJ0bWVudCBuYW1lID0gJ0QyMCciLCByZXN1bHQuZ2V0KDApLmdldE5h\nbWUoKSwgIkQyMCIpOwoKICAgICAgICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5i\nZWdpbigpOwogICAgICAgIG1hcC5jbGVhcigpOwogICAgICAgIG1hcC5wdXQo\nImphdmF4LnBlcnNpc3RlbmNlLmxvY2sudGltZW91dCIsIDIwMDApOwogICAg\nICAgIC8vIGZpbmQgRW1wbG95ZWUoMikgd2l0aCBhIGxvY2ssIG5vIGJsb2Nr\nIHNpbmNlIG9ubHkgZGVwYXJ0bWVudCB3YXMKICAgICAgICAvLyBsb2NrZWQK\nICAgICAgICB0cnkgewogICAgICAgICAgICBFbXBsb3llZSBlbXAgPSBlbTIu\nZmluZChFbXBsb3llZS5jbGFzcywgMSwgTG9ja01vZGVUeXBlLlBFU1NJTUlT\nVElDX1JFQUQsIG1hcCk7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoIlF1\nZXJ5IGxvY2tzIGRlcGFydG1lbnQgb25seSwgdGhlcmVmb3JlIHNob3VsZCBm\naW5kIEVtcGxveWVlLiIsIGVtcCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygiVGVzdCBFbXBsb3llZSBmaXJzdCBuYW1lID0gJ2ZpcnN0LjEnIiwgZW1w\nLmdldEZpcnN0TmFtZSgpLCAiZmlyc3QuMSIpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBleCkgewogICAgICAgICAgICBmYWlsKCJDYXVnaHQgdW5l\neHBlY3RlZCAiICsgZXguZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiOiIgKyBl\neC5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGlmIChlbTEuZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAg\nICAgICAgICAgICAgZW0xLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsK\nICAgICAgICAgICAgaWYgKGVtMi5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZl\nKCkpCiAgICAgICAgICAgICAgICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5yb2xs\nYmFjaygpOwogICAgICAgIH0KICAgICAgICBlbTEuY2xvc2UoKTsKICAgICAg\nICBlbTIuY2xvc2UoKTsKICAgIH0KCiAgICAvKgogICAgICogVGVzdCBxdWVy\neSB3aXRoIHBlc3NpbWlzdGljIGxvY2sgYWZ0ZXIgYSBmaW5kIHdpdGggcGVz\nc2ltaXN0aWMgbG9jay4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdFF1\nZXJ5QWZ0ZXJGaW5kV2l0aFBlc3NpbWlzdGljTG9ja3MoKSB7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbTEgPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIEVudGl0eU1hbmFnZXIgZW0yID0gZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBlbTIuZ2V0\nVHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgICAgICBNYXA8U3RyaW5n\nLCBPYmplY3Q+IG1hcCA9IG5ldyBIYXNoTWFwPFN0cmluZywgT2JqZWN0Pigp\nOwogICAgICAgICAgICBtYXAucHV0KCJqYXZheC5wZXJzaXN0ZW5jZS5sb2Nr\nLnRpbWVvdXQiLCAyMDAwKTsKICAgICAgICAgICAgLy8gTG9jayBFbXBseWVl\nKDEpLCBubyBkZXBhcnRtZW50IHNob3VsZCBiZSBsb2NrZWQKICAgICAgICAg\nICAgZW0yLmZpbmQoRW1wbG95ZWUuY2xhc3MsIDEsIExvY2tNb2RlVHlwZS5Q\nRVNTSU1JU1RJQ19SRUFELCBtYXApOwoKICAgICAgICAgICAgZW0xLmdldFRy\nYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICAgICAgUXVlcnkgcXVlcnkg\nPSBlbTEuY3JlYXRlUXVlcnkoInNlbGVjdCBlLmRlcGFydG1lbnQgZnJvbSBF\nbXBsb3llZSBlIHdoZXJlIGUuaWQgPCAxMCIpLnNldEZpcnN0UmVzdWx0KDEp\nOwogICAgICAgICAgICBxdWVyeS5zZXRMb2NrTW9kZShMb2NrTW9kZVR5cGUu\nUEVTU0lNSVNUSUNfUkVBRCk7CiAgICAgICAgICAgIHF1ZXJ5LnNldEhpbnQo\nImphdmF4LnBlcnNpc3RlbmNlLnF1ZXJ5LnRpbWVvdXQiLCAyMDAwKTsKICAg\nICAgICAgICAgLy8gTG9jayBhbGwgc2VsZWN0ZWQgRGVwYXJ0bWVudCBidXQg\nc2tpcCB0aGUgZmlyc3QsIGkuZS4gbG9jawogICAgICAgICAgICAvLyBEZXBh\ncnRtZW50KDIwKSwgc2hvdWxkIHF1ZXJ5IHN1Y2Nlc3NmdWxseS4KICAgICAg\nICAgICAgTGlzdDxEZXBhcnRtZW50PiBxID0gcXVlcnkuZ2V0UmVzdWx0TGlz\ndCgpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkV4cGVjdGVkIDEgZWxl\nbWVudCB3aXRoIGRlcGFydG1lbnQgaWQ9MjAiLCBxLnNpemUoKSwgMSk7CiAg\nICAgICAgICAgIGFzc2VydFRydWUoIlRlc3QgZGVwYXJ0bWVudCBuYW1lID0g\nJ0QyMCciLCBxLmdldCgwKS5nZXROYW1lKCkuZXF1YWxzKCJEMTAiKQogICAg\nICAgICAgICAgICAgICAgIHx8IHEuZ2V0KDApLmdldE5hbWUoKS5lcXVhbHMo\nIkQyMCIpKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXgpIHsKICAg\nICAgICAgICAgZmFpbCgiQ2F1Z2h0IHVuZXhwZWN0ZWQgIiArIGV4LmdldENs\nYXNzKCkuZ2V0TmFtZSgpICsgIjoiICsgZXguZ2V0TWVzc2FnZSgpKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZW0xLmdldFRyYW5z\nYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgIGVtMS5nZXRU\ncmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIGlmIChlbTIu\nZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAgICAgICAgICAg\nZW0yLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAgICB9Cgog\nICAgICAgIGVtMi5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CgogICAgICAg\nIE1hcDxTdHJpbmcsIE9iamVjdD4gbWFwID0gbmV3IEhhc2hNYXA8U3RyaW5n\nLCBPYmplY3Q+KCk7CiAgICAgICAgbWFwLnB1dCgiamF2YXgucGVyc2lzdGVu\nY2UubG9jay50aW1lb3V0IiwgMjAwMCk7CiAgICAgICAgLy8gTG9jayBFbXBs\neWVlKDIpLCBubyBkZXBhcnRtZW50IHNob3VsZCBiZSBsb2NrZWQKICAgICAg\nICBlbTIuZmluZChFbXBsb3llZS5jbGFzcywgMiwgTG9ja01vZGVUeXBlLlBF\nU1NJTUlTVElDX1JFQUQsIG1hcCk7CgogICAgICAgIGVtMS5nZXRUcmFuc2Fj\ndGlvbigpLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcXVlcnkgPSBlbTEuY3Jl\nYXRlUXVlcnkoInNlbGVjdCBlIGZyb20gRW1wbG95ZWUgZSB3aGVyZSBlLmlk\nIDwgMTAiKS5zZXRGaXJzdFJlc3VsdCgxKTsKICAgICAgICAvLyBMb2NrIGFs\nbCBzZWxlY3RlZCBFbXBsb3llZXMsIHNraXAgdGhlIGZpcnN0IG9uZSwgaS5l\nIHNob3VsZCBsb2NrCiAgICAgICAgLy8gRW1wbG95ZWUoMikKICAgICAgICBx\ndWVyeS5zZXRMb2NrTW9kZShMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfUkVB\nRCk7CiAgICAgICAgcXVlcnkuc2V0SGludCgiamF2YXgucGVyc2lzdGVuY2Uu\ncXVlcnkudGltZW91dCIsIDEwMDApOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIExpc3Q8RW1wbG95ZWU+IHEgPSBxdWVyeS5nZXRSZXN1bHRMaXN0KCk7\nCiAgICAgICAgICAgIGZhaWwoIlVuZXhjcGVjdGVkIGZpbmQgc3VjY2VlZGVk\nLiBTaG91bGQgdGhyb3cgYSBQZXNzaW1pc3RpY0xvY2tFeGNlcHRpb24uIik7\nCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nYXNzZXJ0RXJyb3IoZSwgUGVzc2ltaXN0aWNMb2NrRXhjZXB0aW9uLmNsYXNz\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZW0xLmdl\ndFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgIGVt\nMS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIGlm\nIChlbTIuZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAgICAg\nICAgICAgZW0yLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAg\nICB9CiAgICAgICAgZW0xLmNsb3NlKCk7CiAgICAgICAgZW0yLmNsb3NlKCk7\nCiAgICB9CgogICAgLyoKICAgICAqIFRlc3QgcXVlcnkgd2l0aCBwZXNzaW1p\nc3RpYyBsb2NrIGFmdGVyIGEgZmluZCB3aXRoIHBlc3NpbWlzdGljIGxvY2su\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeU9yZGVyQnlBZnRl\nckZpbmRXaXRoUGVzc2ltaXN0aWNMb2NrcygpIHsKICAgICAgICBFbnRpdHlN\nYW5hZ2VyIGVtMSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgRW50aXR5TWFuYWdlciBlbTIgPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIGVtMi5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAg\nICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBtYXAgPSBuZXcgSGFzaE1hcDxT\ndHJpbmcsIE9iamVjdD4oKTsKICAgICAgICBtYXAucHV0KCJqYXZheC5wZXJz\naXN0ZW5jZS5sb2NrLnRpbWVvdXQiLCAyMDAwKTsKICAgICAgICAvLyBMb2Nr\nIEVtcGx5ZWUoMSksIG5vIGRlcGFydG1lbnQgc2hvdWxkIGJlIGxvY2tlZAog\nICAgICAgIGVtMi5maW5kKEVtcGxveWVlLmNsYXNzLCAxLCBMb2NrTW9kZVR5\ncGUuUEVTU0lNSVNUSUNfUkVBRCwgbWFwKTsKCiAgICAgICAgZW0xLmdldFRy\nYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBRdWVyeSBxdWVyeSA9IGVt\nMS5jcmVhdGVRdWVyeSgic2VsZWN0IGUuZGVwYXJ0bWVudCBmcm9tIEVtcGxv\neWVlIGUgd2hlcmUgZS5pZCA8IDEwIG9yZGVyIGJ5IGUuZGVwYXJ0bWVudC5p\nZCIpCiAgICAgICAgICAgICAgICAuc2V0Rmlyc3RSZXN1bHQoMSk7CiAgICAg\nICAgcXVlcnkuc2V0TG9ja01vZGUoTG9ja01vZGVUeXBlLlBFU1NJTUlTVElD\nX1JFQUQpOwogICAgICAgIHF1ZXJ5LnNldEhpbnQoImphdmF4LnBlcnNpc3Rl\nbmNlLnF1ZXJ5LnRpbWVvdXQiLCAyMDAwKTsKICAgICAgICAvLyBMb2NrIGFs\nbCBzZWxlY3RlZCBEZXBhcnRtZW50IGJ1dCBza2lwIHRoZSBmaXJzdCwgaS5l\nLiBsb2NrCiAgICAgICAgLy8gRGVwYXJ0bWVudCgyMCksIHNob3VsZCBxdWVy\neSBzdWNjZXNzZnVsbHkuCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGlz\ndDxEZXBhcnRtZW50PiBxID0gcXVlcnkuZ2V0UmVzdWx0TGlzdCgpOwogICAg\nICAgICAgICBhc3NlcnRFcXVhbHMoIkV4cGVjdGVkIDEgZWxlbWVudCB3aXRo\nIGRlcGFydG1lbnQgaWQ9MjAiLCBxLnNpemUoKSwgMSk7CiAgICAgICAgICAg\nIGFzc2VydEVxdWFscygiVGVzdCBkZXBhcnRtZW50IG5hbWUgPSAnRDIwJyIs\nIHEuZ2V0KDApLmdldE5hbWUoKSwgIkQyMCIpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBleCkgewogICAgICAgICAgICBmYWlsKCJDYXVnaHQgdW5l\neHBlY3RlZCAiICsgZXguZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiOiIgKyBl\neC5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGlmIChlbTEuZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAg\nICAgICAgICAgICAgZW0xLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsK\nICAgICAgICAgICAgaWYgKGVtMi5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZl\nKCkpCiAgICAgICAgICAgICAgICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5yb2xs\nYmFjaygpOwogICAgICAgIH0KCiAgICAgICAgZW0yLmdldFRyYW5zYWN0aW9u\nKCkuYmVnaW4oKTsKCiAgICAgICAgbWFwLmNsZWFyKCk7CiAgICAgICAgbWFw\nLnB1dCgiamF2YXgucGVyc2lzdGVuY2UubG9jay50aW1lb3V0IiwgMjAwMCk7\nCiAgICAgICAgLy8gTG9jayBFbXBseWVlKDIpLCBubyBkZXBhcnRtZW50IHNo\nb3VsZCBiZSBsb2NrZWQKICAgICAgICBlbTIuZmluZChFbXBsb3llZS5jbGFz\ncywgMiwgTG9ja01vZGVUeXBlLlBFU1NJTUlTVElDX1JFQUQsIG1hcCk7Cgog\nICAgICAgIGVtMS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAg\ncXVlcnkgPSBlbTEuY3JlYXRlUXVlcnkoInNlbGVjdCBlIGZyb20gRW1wbG95\nZWUgZSB3aGVyZSBlLmlkIDwgMTAgb3JkZXIgYnkgZS5kZXBhcnRtZW50Lmlk\nIikuc2V0Rmlyc3RSZXN1bHQoMSk7CiAgICAgICAgLy8gTG9jayBhbGwgc2Vs\nZWN0ZWQgRW1wbG95ZWVzLCBza2lwIHRoZSBmaXJzdCBvbmUsIGkuZSBzaG91\nbGQgbG9jawogICAgICAgIC8vIEVtcGxveWVlKDIpCiAgICAgICAgcXVlcnku\nc2V0TG9ja01vZGUoTG9ja01vZGVUeXBlLlBFU1NJTUlTVElDX1JFQUQpOwog\nICAgICAgIHF1ZXJ5LnNldEhpbnQoImphdmF4LnBlcnNpc3RlbmNlLnF1ZXJ5\nLnRpbWVvdXQiLCAyMDAwKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBM\naXN0PD8+IHEgPSBxdWVyeS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAg\nIGZhaWwoIlVuZXhjcGVjdGVkIGZpbmQgc3VjY2VlZGVkLiBTaG91bGQgdGhy\nb3cgYSBQZXNzaW1pc3RpY0xvY2tFeGNlcHRpb24uIik7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgYXNzZXJ0RXJyb3Io\nZSwgUGVzc2ltaXN0aWNMb2NrRXhjZXB0aW9uLmNsYXNzKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZW0xLmdldFRyYW5zYWN0aW9u\nKCkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgIGVtMS5nZXRUcmFuc2Fj\ndGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIGlmIChlbTIuZ2V0VHJh\nbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAgICAgICAgICAgZW0yLmdl\ndFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAgICB9CiAgICAgICAg\nZW0xLmNsb3NlKCk7CiAgICAgICAgZW0yLmNsb3NlKCk7CiAgICB9CgogICAg\nLyoKICAgICAqIFRlc3QgbXVsdGlwbGUgZXhlY3V0aW9uIG9mIHRoZSBzYW1l\nIHF1ZXJ5IHdpdGggcGVzc2ltaXN0aWMgbG9jay4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgdGVzdFJlcGVhdGVkUXVlcnlXaXRoUGVzc2ltaXN0aWNMb2Nr\ncygpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICByZXNldFNRTCgpOwogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBTdHJpbmcganBx\nbCA9ICJzZWxlY3QgZS5maXJzdE5hbWUgZnJvbSBFbXBsb3llZSBlIHdoZXJl\nIGUuaWQgPSAxIjsKICAgICAgICBRdWVyeSBxMSA9IGVtLmNyZWF0ZVF1ZXJ5\nKGpwcWwpOwogICAgICAgIHExLnNldExvY2tNb2RlKExvY2tNb2RlVHlwZS5Q\nRVNTSU1JU1RJQ19XUklURSk7CiAgICAgICAgU3RyaW5nIGZpcnN0TmFtZTEg\nPSAoU3RyaW5nKSBxMS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICAvL0V4\ncGVjdGVkIHNxbCBmb3IgRGVyYnkgaXM6CiAgICAgICAgLy9TRUxFQ1QgdDAu\nZmlyc3ROYW1lIEZST00gRW1wbG95ZWUgdDAgV0hFUkUgKHQwLmlkID0gQ0FT\nVCg/IEFTIEJJR0lOVCkpIEZPUiBVUERBVEUgV0lUSCBSUgogICAgICAgIFN0\ncmluZyBTUUwxID0gdG9TdHJpbmcoc3FsKTsKICAgICAgICAKICAgICAgICAv\nLyBydW4gdGhlIHNlY29uZCB0aW1lCiAgICAgICAgcmVzZXRTUUwoKTsKICAg\nICAgICBRdWVyeSBxMiA9IGVtLmNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAgICAg\nIHEyLnNldExvY2tNb2RlKExvY2tNb2RlVHlwZS5QRVNTSU1JU1RJQ19XUklU\nRSk7CiAgICAgICAgU3RyaW5nIGZpcnN0TmFtZTIgPSAoU3RyaW5nKSBxMi5n\nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICBTdHJpbmcgU1FMMiA9IHRvU3Ry\naW5nKHNxbCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKFNRTDEsIFNRTDIpOwog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBc3NlcnQgdGhhdCBhbiBleGNlcHRpb24gb2YgcHJv\ncGVyIHR5cGUgaGFzIGJlZW4gdGhyb3duLiBBbHNvIGNoZWNrcyB0aGF0CiAg\nICAgKiB0aGF0IHRoZSBleGNlcHRpb24gaGFzIHBvcHVsYXRlZCB0aGUgZmFp\nbGVkIG9iamVjdC4KICAgICAqIAogICAgICogQHBhcmFtIGFjdHVhbAogICAg\nICogICAgICAgICAgICBleGNlcHRpb24gYmVpbmcgdGhyb3duCiAgICAgKiBA\ncGFyYW0gZXhwZWNldGVkCiAgICAgKiAgICAgICAgICAgIHR5cGUgb2YgdGhl\nIGV4Y2VwdGlvbgogICAgICovCiAgICB2b2lkIGFzc2VydEVycm9yKFRocm93\nYWJsZSBhY3R1YWwsIENsYXNzPD8gZXh0ZW5kcyBUaHJvd2FibGU+IGV4cGVj\ndGVkKSB7CiAgICAgICAgaWYgKCFleHBlY3RlZC5pc0Fzc2lnbmFibGVGcm9t\nKGFjdHVhbC5nZXRDbGFzcygpKSkgewogICAgICAgICAgICBhY3R1YWwucHJp\nbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAgIHRocm93IG5ldyBBc3NlcnRp\nb25GYWlsZWRFcnJvcihhY3R1YWwuZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAi\nIHdhcyByYWlzZWQgYnV0IGV4cGVjdGVkICIKICAgICAgICAgICAgICAgICAg\nICArIGV4cGVjdGVkLmdldE5hbWUoKSk7CiAgICAgICAgfQogICAgICAgIE9i\namVjdCBmYWlsZWQgPSBnZXRGYWlsZWRPYmplY3QoYWN0dWFsKTsKICAgICAg\nICBhc3NlcnROb3ROdWxsKCJGYWlsZWQgb2JqZWN0IGlzIG51bGwiLCBmYWls\nZWQpOwogICAgICAgIGFzc2VydE5vdEVxdWFscygibnVsbCIsIGZhaWxlZCk7\nCiAgICB9CgogICAgT2JqZWN0IGdldEZhaWxlZE9iamVjdChUaHJvd2FibGUg\nZSkgewogICAgICAgIGlmIChlIGluc3RhbmNlb2YgTG9ja1RpbWVvdXRFeGNl\ncHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuICgoTG9ja1RpbWVvdXRFeGNl\ncHRpb24pIGUpLmdldE9iamVjdCgpOwogICAgICAgIH0KICAgICAgICBpZiAo\nZSBpbnN0YW5jZW9mIFBlc3NpbWlzdGljTG9ja0V4Y2VwdGlvbikgewogICAg\nICAgICAgICByZXR1cm4gKChQZXNzaW1pc3RpY0xvY2tFeGNlcHRpb24pIGUp\nLmdldEVudGl0eSgpOwogICAgICAgIH0KICAgICAgICBpZiAoZSBpbnN0YW5j\nZW9mIFF1ZXJ5VGltZW91dEV4Y2VwdGlvbikgewogICAgICAgICAgICByZXR1\ncm4gKChRdWVyeVRpbWVvdXRFeGNlcHRpb24pIGUpLmdldFF1ZXJ5KCk7CiAg\nICAgICAgfQogICAgICAgIGlmIChlIGluc3RhbmNlb2YgT3BlbkpQQUV4Y2Vw\ndGlvbikgewogICAgICAgICAgICByZXR1cm4gKChPcGVuSlBBRXhjZXB0aW9u\nKSBlKS5nZXRGYWlsZWRPYmplY3QoKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

