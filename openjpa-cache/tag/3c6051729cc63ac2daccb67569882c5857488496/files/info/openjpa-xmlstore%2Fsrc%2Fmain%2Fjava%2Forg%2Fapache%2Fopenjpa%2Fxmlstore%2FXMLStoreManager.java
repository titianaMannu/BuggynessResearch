{"sha":"0456e1b562f65b68c26f6d7e8a04d1d0b0570460","node_id":"MDQ6QmxvYjIwNjM2NDowNDU2ZTFiNTYyZjY1YjY4YzI2ZjZkN2U4YTA0ZDFkMGIwNTcwNDYw","size":11003,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0456e1b562f65b68c26f6d7e8a04d1d0b0570460","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEueG1sc3RvcmU7CgppbXBvcnQg\namF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5CaXRTZXQ7\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmFic3RyYWN0c3RvcmUuQWJzdHJhY3RTdG9yZU1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVu\nSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5QQ1N0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5y\nb3AuTGlzdFJlc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5yb3AuUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3B0aW1pc3RpY0V4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlN0b3JlRXhjZXB0\naW9uOwoKLyoqCiAqIFN0b3JlIG1hbmFnZXIgdG8gYSBiYWNrLWVuZCBjb25z\naXN0aW5nIG9mIFhNTCBmaWxlcy4gVGhpcwogKiBpbXBsZW1lbnRhdGlvbiBh\nY2Nlc3NlcyBkYXRhIHRocm91Z2ggdGhlIHtAbGluayBYTUxTdG9yZX0gYXNz\nb2NpYXRlZCB3aXRoCiAqIGl0cyB7QGxpbmsgWE1MQ29uZmlndXJhdGlvbn0u\nIENvbmZpZ3VyYXRpb24gaW5zdGFuY2VzIGFyZSBzaGFyZWQgYnkgYWxsCiAq\nIHN0b3JlIG1hbmFnZXJzIG93bmVkIGJ5IGFsbCBicm9rZXJzIGNyZWF0ZWQg\nd2l0aCB0aGUgc2FtZSBmYWN0b3J5LgogKgogKiBAc2VlIEFic3RyYWN0U3Rv\ncmVNYW5hZ2VyCiAqLwpwdWJsaWMgY2xhc3MgWE1MU3RvcmVNYW5hZ2VyCiAg\nICBleHRlbmRzIEFic3RyYWN0U3RvcmVNYW5hZ2VyIHsKCiAgICBwcml2YXRl\nIFhNTENvbmZpZ3VyYXRpb24gX2NvbmY7CiAgICBwcml2YXRlIFhNTFN0b3Jl\nIF9zdG9yZTsKCiAgICAvLyBjaGFuZ2VkIGRhdGEgd2l0aGluIHRoZSBjdXJy\nZW50IHRyYW5zYWN0aW9uCiAgICBwcml2YXRlIENvbGxlY3Rpb24gX3VwZGF0\nZXM7CiAgICBwcml2YXRlIENvbGxlY3Rpb24gX2RlbGV0ZXM7CgogICAgcHJv\ndGVjdGVkIENvbGxlY3Rpb24gZ2V0VW5zdXBwb3J0ZWRPcHRpb25zKCkgewog\nICAgICAgIENvbGxlY3Rpb24gYyA9IHN1cGVyLmdldFVuc3VwcG9ydGVkT3B0\naW9ucygpOwoKICAgICAgICAvLyByZW1vdmUgb3B0aW9ucyB3ZSBkbyBzdXBw\nb3J0IGJ1dCB0aGUgYWJzdHJhY3Qgc3RvcmUgZG9lc24ndAogICAgICAgIGMu\ncmVtb3ZlKE9wZW5KUEFDb25maWd1cmF0aW9uLk9QVElPTl9JRF9EQVRBU1RP\nUkUpOwogICAgICAgIGMucmVtb3ZlKE9wZW5KUEFDb25maWd1cmF0aW9uLk9Q\nVElPTl9PUFRJTUlTVElDKTsKCiAgICAgICAgLy8gYW5kIGFkZCBzb21lIHRo\nYXQgd2UgZG9uJ3Qgc3VwcG9ydCBidXQgdGhlIGFic3RyYWN0IHN0b3JlIGRv\nZXMKICAgICAgICBjLmFkZChPcGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05f\nRU1CRURERURfUkVMQVRJT04pOwogICAgICAgIGMuYWRkKE9wZW5KUEFDb25m\naWd1cmF0aW9uLk9QVElPTl9FTUJFRERFRF9DT0xMRUNUSU9OX1JFTEFUSU9O\nKTsKICAgICAgICBjLmFkZChPcGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05f\nRU1CRURERURfTUFQX1JFTEFUSU9OKTsKICAgICAgICByZXR1cm4gYzsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgT3BlbkpQQUNvbmZpZ3VyYXRpb24gbmV3Q29u\nZmlndXJhdGlvbigpIHsKICAgICAgICAvLyBvdmVycmlkZSB0byB1c2Ugb3Vy\nIGNvbmZpZ3VyYXRpb24gdHlwZQogICAgICAgIHJldHVybiBuZXcgWE1MQ29u\nZmlndXJhdGlvbigpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIG9wZW4o\nKSB7CiAgICAgICAgLy8gY2FjaGUgb3BlcmF0aW9uYWwgc3RhdGUKICAgICAg\nICBfY29uZiA9IChYTUxDb25maWd1cmF0aW9uKSBjdHguZ2V0Q29uZmlndXJh\ndGlvbigpOwogICAgICAgIF9zdG9yZSA9IF9jb25mLmdldFN0b3JlKCk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gZXhpc3RzKE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20sIE9iamVjdCBjb250ZXh0KSB7CiAgICAgICAgLy8gc2VlIGlm\nIHRoZSBnaXZlbiBvYmplY3QgZXhpc3RzIGluIHRoZSBzdG9yZQogICAgICAg\nIHJldHVybiBfc3RvcmUuZ2V0RGF0YShzbS5nZXRNZXRhRGF0YSgpLCBzbS5n\nZXRPYmplY3RJZCgpKSAhPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nSW5jcmVtZW50IHRoZSB2ZXJzaW9uIGluZGljYXRvciBpbiB0aGUgZ2l2ZW4g\nc3RhdGUgbWFuYWdlci4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9p\nZCBpbmNyZW1lbnRWZXJzaW9uKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsK\nICAgICAgICBsb25nIHZlcnNpb24gPSAwOwogICAgICAgIGlmIChzbS5nZXRW\nZXJzaW9uKCkgIT0gbnVsbCkKICAgICAgICAgICAgdmVyc2lvbiA9ICgoTG9u\nZykgc20uZ2V0VmVyc2lvbigpKS5sb25nVmFsdWUoKSArIDE7CiAgICAgICAg\nc20uc2V0TmV4dFZlcnNpb24odmVyc2lvbik7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaW5pdGlhbGl6ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBQ\nQ1N0YXRlIHN0YXRlLAogICAgICAgIEZldGNoQ29uZmlndXJhdGlvbiBmZXRj\naCwgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAvLyB3ZSBtYXkgYWxyZWFk\neSBoYXZlIGxvb2tlZCB1cCB0aGUgYmFja2luZyBPYmplY3REYXRhIChzZWUg\nb3VyIGV4dGVudAogICAgICAgIC8vIGltcGxlbWVudGF0aW9uIGJlbG93KSwg\nYW5kIHBhc3NlZCBpdCB0aHJvdWdoIGFzIHRoZSBjb250ZXh0OyBpZgogICAg\nICAgIC8vIG5vdCwgdGhlbiBsb29rIGl0IHVwIGluIHRoZSBzdG9yZQogICAg\nICAgIE9iamVjdERhdGEgZGF0YTsKICAgICAgICBpZiAoY29udGV4dCAhPSBu\ndWxsKQogICAgICAgICAgICBkYXRhID0gKE9iamVjdERhdGEpIGNvbnRleHQ7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBkYXRhID0gX3N0b3JlLmdldERh\ndGEoc20uZ2V0TWV0YURhdGEoKSwgc20uZ2V0T2JqZWN0SWQoKSk7CgogICAg\nICAgIC8vIG5vIG1hdGNoaW5nIHJlY29yZD8KICAgICAgICBpZiAoZGF0YSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIC8v\nIGluaXRpYWxpemUgdGhlIHN0YXRlIG1hbmFnZXIgd2l0aCBhIG5ldyBpbnN0\nYW5jZSBvZiB0aGUgcmlnaHQKICAgICAgICAvLyB0eXBlIGFuZCBsaWZlY3lj\nbGUgc3RhdGUKICAgICAgICBzbS5pbml0aWFsaXplKGRhdGEuZ2V0TWV0YURh\ndGEoKS5nZXREZXNjcmliZWRUeXBlKCksIHN0YXRlKTsKCiAgICAgICAgLy8g\nbG9hZCB0aGUgZGF0YSBmcm9tIHRoZSBPYmplY3REYXRhIGludG8gdGhlIHN0\nYXRlIG1ncjsgbm90ZSB0aGF0CiAgICAgICAgLy8gdGhpcyBzdG9yZSBtYW5h\nZ2VyIGRvZXNuJ3QgZG8gYW55IGxvY2tpbmcgLS0gaXQgcmVsaWVzIG9uIHRo\nZQogICAgICAgIC8vIHN5c3RlbSdzIGxvY2sgbWFuYWdlciB0byBsb2NrIGFm\ndGVyIHRoZSBsb2FkIGlzIGNvbXBsZXRlCiAgICAgICAgZGF0YS5sb2FkKHNt\nLCBmZXRjaCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gbG9hZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBCaXRT\nZXQgZmllbGRzLAogICAgICAgIEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwg\naW50IGxvY2tMZXZlbCwgT2JqZWN0IGNvbnRleHQpIHsKICAgICAgICAvLyB3\nZSBtYXkgYWxyZWFkeSBoYXZlIGxvb2tlZCB1cCB0aGUgYmFja2luZyBPYmpl\nY3REYXRhIChzZWUgb3VyIGV4dGVudAogICAgICAgIC8vIGltcGxlbWVudGF0\naW9uIGJlbG93KSwgYW5kIHBhc3NlZCBpdCB0aHJvdWdoIGFzIHRoZSBjb250\nZXh0OyBpZgogICAgICAgIC8vIG5vdCwgdGhlbiBsb29rIGl0IHVwIGluIHRo\nZSBzdG9yZQogICAgICAgIE9iamVjdERhdGEgZGF0YTsKICAgICAgICBpZiAo\nY29udGV4dCAhPSBudWxsKQogICAgICAgICAgICBkYXRhID0gKE9iamVjdERh\ndGEpIGNvbnRleHQ7CiAgICAgICAgZWxzZQogICAgICAgICAgICBkYXRhID0g\nX3N0b3JlLmdldERhdGEoc20uZ2V0TWV0YURhdGEoKSwgc20uZ2V0T2JqZWN0\nSWQoKSk7CgogICAgICAgIC8vIG5vIG1hdGNoaW5nIHJlY29yZD8KICAgICAg\nICBpZiAoZGF0YSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCgogICAgICAgIC8vIGxvYWQgdGhlIGRhdGEgZnJvbSB0aGUgT2JqZWN0RGF0\nYSBpbnRvIHRoZSBzdGF0ZSBtZ3I7IG5vdGUgdGhhdAogICAgICAgIC8vIHRo\naXMgc3RvcmUgbWFuYWdlciBkb2Vzbid0IGRvIGFueSBsb2NraW5nIC0tIGl0\nIHJlbGllcyBvbiB0aGUKICAgICAgICAvLyBzeXN0ZW0ncyBsb2NrIG1hbmFn\nZXIgdG8gbG9jayBhZnRlciB0aGUgbG9hZCBpcyBjb21wbGV0ZQogICAgICAg\nIGRhdGEubG9hZChzbSwgZmllbGRzLCBmZXRjaCk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3luY1ZlcnNpb24o\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgT2JqZWN0IGNvbnRleHQpIHsKICAg\nICAgICBpZiAoc20uZ2V0VmVyc2lvbigpID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gd2UgbWF5IGFscmVhZHkgaGF2\nZSBsb29rZWQgdXAgdGhlIGJhY2tpbmcgT2JqZWN0RGF0YSAoc2VlIG91ciBl\neHRlbnQKICAgICAgICAvLyBpbXBsZW1lbnRhdGlvbiBiZWxvdyksIGFuZCBw\nYXNzZWQgaXQgdGhyb3VnaCBhcyB0aGUgY29udGV4dDsgaWYKICAgICAgICAv\nLyBub3QsIHRoZW4gbG9vayBpdCB1cCBpbiB0aGUgc3RvcmUKICAgICAgICBP\nYmplY3REYXRhIGRhdGE7CiAgICAgICAgaWYgKGNvbnRleHQgIT0gbnVsbCkK\nICAgICAgICAgICAgZGF0YSA9IChPYmplY3REYXRhKSBjb250ZXh0OwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgZGF0YSA9IF9zdG9yZS5nZXREYXRhKHNt\nLmdldE1ldGFEYXRhKCksIHNtLmdldE9iamVjdElkKCkpOwoKICAgICAgICAv\nLyBubyByZWNvcmQ/CiAgICAgICAgaWYgKGRhdGEgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyBpZiB0aGUgdmVyc2lv\nbiBvZiBkYXRhIGhlbGQgYnkgdGhlIHN0YXRlIG1nciBpcyB0aGUgc2FtZSBh\ncyB0aGUKICAgICAgICAvLyB2ZXJzaW9uIGluIHRoZSBkYXRhc3RvcmUsIHJl\ndHVybiB0cnVlLCBsZXR0aW5nIHRoZSBicm9rZXIga25vdyB0aGF0CiAgICAg\nICAgLy8gaXQgZG9lc24ndCBuZWVkIHRvIGxvYWQgYW55IG1vcmUgZGF0YQog\nICAgICAgIGlmIChzbS5nZXRWZXJzaW9uKCkuZXF1YWxzKGRhdGEuZ2V0VmVy\nc2lvbigpKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIC8v\nIHNldCB0aGUgdmVyc2lvbiB0byBiZSB1cC10by1kYXRlLCBhbmQgcmV0dXJu\nIGZhbHNlIGxldHRpbmcKICAgICAgICAvLyB0aGUgYnJva2VyIGtub3cgdGhh\ndCBpdCBuZWVkcyB0byBsb2FkIHVwLXRvLWRhdGUgZGF0YQogICAgICAgIHNt\nLnNldFZlcnNpb24oZGF0YS5nZXRWZXJzaW9uKCkpOwogICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBiZWdpbigpIHsKICAg\nICAgICBfc3RvcmUuYmVnaW5UcmFuc2FjdGlvbigpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGNvbW1pdCgpIHsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBfc3RvcmUuZW5kVHJhbnNhY3Rpb24oX3VwZGF0ZXMsIF9kZWxldGVzKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfdXBkYXRlcyA9IG51\nbGw7CiAgICAgICAgICAgIF9kZWxldGVzID0gbnVsbDsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcm9sbGJhY2soKSB7CiAgICAgICAgX3Vw\nZGF0ZXMgPSBudWxsOwogICAgICAgIF9kZWxldGVzID0gbnVsbDsKICAgICAg\nICBfc3RvcmUuZW5kVHJhbnNhY3Rpb24obnVsbCwgbnVsbCk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIENvbGxlY3Rpb24gZmx1c2goQ29sbGVjdGlvbiBwTmV3\nLCBDb2xsZWN0aW9uIHBOZXdVcGRhdGVkLAogICAgICAgIENvbGxlY3Rpb24g\ncE5ld0ZsdXNoZWREZWxldGVkLCBDb2xsZWN0aW9uIHBEaXJ0eSwgQ29sbGVj\ndGlvbiBwRGVsZXRlZCkgewogICAgICAgIC8vIHdlIGRvbid0IHN1cHBvcnQg\naW5jcmVtZW50YWwgZmx1c2hpbmcsIHNvIHBOZXdVcGRhdGVkIGFuZAogICAg\nICAgIC8vIHBOZXdGbHVzaGVkRGVsZXRlZCBzaG91bGQgYmUgZW1wdHk7IHdl\nIGlnbm9yZSB0aGVtIGhlcmUKCiAgICAgICAgLy8gdHJhY2sgb3B0aW1pc3Rp\nYyB2aW9sYXRpb25zCiAgICAgICAgQ29sbGVjdGlvbiBleGNlcHMgPSBuZXcg\nTGlua2VkTGlzdCgpOwoKICAgICAgICAvLyBjb252ZXJ0IGluc3RhbmNlcyB0\nbyBPYmplY3REYXRhcwogICAgICAgIF91cGRhdGVzID0gbmV3IEFycmF5TGlz\ndChwTmV3LnNpemUoKSArIHBEaXJ0eS5zaXplKCkpOwogICAgICAgIF9kZWxl\ndGVzID0gbmV3IEFycmF5TGlzdChwRGVsZXRlZC5zaXplKCkpOwoKICAgICAg\nICAvLyBjb252ZXJ0IGFkZGl0aW9ucwogICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gcE5ldy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICAvLyBjcmVhdGUgbmV3IG9iamVjdCBkYXRhIGZvciBpbnN0YW5j\nZQogICAgICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIE9iamVj\ndCBvaWQgPSBzbS5nZXRPYmplY3RJZCgpOwogICAgICAgICAgICBPYmplY3RE\nYXRhIGRhdGEgPSBfc3RvcmUuZ2V0RGF0YShzbS5nZXRNZXRhRGF0YSgpLCBv\naWQpOwogICAgICAgICAgICBpZiAoZGF0YSAhPSBudWxsKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKCJBdHRlbXB0IHRvIGlu\nc2VydCAiCiAgICAgICAgICAgICAgICAgICAgKyAibmV3IG9iamVjdCAiICsg\nc20uZ2V0TWFuYWdlZEluc3RhbmNlKCkKICAgICAgICAgICAgICAgICAgICAr\nICJ3aXRoIHRoZSBzYW1lIG9pZCBhcyBhbiBleGlzdGluZyBpbnN0YW5jZTog\nIiArIG9pZCkuCiAgICAgICAgICAgICAgICAgICAgc2V0RmF0YWwodHJ1ZSk7\nCgogICAgICAgICAgICBkYXRhID0gbmV3IE9iamVjdERhdGEob2lkLCBzbS5n\nZXRNZXRhRGF0YSgpKTsKICAgICAgICAgICAgaW5jcmVtZW50VmVyc2lvbihz\nbSk7CiAgICAgICAgICAgIGRhdGEuc3RvcmUoc20pOwogICAgICAgICAgICBf\ndXBkYXRlcy5hZGQoZGF0YSk7CiAgICAgICAgfQoKICAgICAgICAvLyBjb252\nZXJ0IHVwZGF0ZXMKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHBEaXJ0\neS5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gKE9wZW5KUEFTdGF0ZU1hbmFnZXIp\nIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIE9iamVjdERhdGEgZGF0YSA9IF9z\ndG9yZS5nZXREYXRhKHNtLmdldE1ldGFEYXRhKCksCiAgICAgICAgICAgICAg\nICBzbS5nZXRPYmplY3RJZCgpKTsKCiAgICAgICAgICAgIC8vIGlmIGRhdGEg\naGFzIGJlZW4gZGVsZXRlZCBvciBoYXMgdGhlIHdyb25nIHZlcnNpb24sIHJl\nY29yZAogICAgICAgICAgICAvLyBvcHQgbG9jayB2aW9sYXRpb24KICAgICAg\nICAgICAgaWYgKGRhdGEgPT0gbnVsbCB8fCAhZGF0YS5nZXRWZXJzaW9uKCku\nZXF1YWxzKHNtLmdldFZlcnNpb24oKSkpIHsKICAgICAgICAgICAgICAgIGV4\nY2Vwcy5hZGQobmV3IE9wdGltaXN0aWNFeGNlcHRpb24KICAgICAgICAgICAg\nICAgICAgICAoc20uZ2V0TWFuYWdlZEluc3RhbmNlKCkpKTsKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAv\nLyBzdG9yZSBjaGFuZ2VzCiAgICAgICAgICAgIGluY3JlbWVudFZlcnNpb24o\nc20pOwogICAgICAgICAgICBkYXRhID0gKE9iamVjdERhdGEpIGRhdGEuY2xv\nbmUoKTsKICAgICAgICAgICAgZGF0YS5zdG9yZShzbSk7CiAgICAgICAgICAg\nIF91cGRhdGVzLmFkZChkYXRhKTsKICAgICAgICB9CgogICAgICAgIC8vIGNv\nbnZlcnQgZGVsZXRlcwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gcERl\nbGV0ZWQuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IChPcGVuSlBBU3RhdGVNYW5h\nZ2VyKSBpdHIubmV4dCgpOwogICAgICAgICAgICBPYmplY3REYXRhIGRhdGEg\nPSBfc3RvcmUuZ2V0RGF0YShzbS5nZXRNZXRhRGF0YSgpLAogICAgICAgICAg\nICAgICAgc20uZ2V0T2JqZWN0SWQoKSk7CgogICAgICAgICAgICAvLyByZWNv\ncmQgZGVsZXRlCiAgICAgICAgICAgIGlmIChkYXRhICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBfZGVsZXRlcy5hZGQoZGF0YSk7CiAgICAgICAgfQoKICAg\nICAgICByZXR1cm4gZXhjZXBzOwogICAgfQoKICAgIHB1YmxpYyBSZXN1bHRP\nYmplY3RQcm92aWRlciBleGVjdXRlRXh0ZW50KENsYXNzTWV0YURhdGEgbWV0\nYSwKICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMsIEZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCkgewogICAgICAgIC8vIGFzayB0aGUgc3RvcmUgZm9yIGFs\nbCBPYmplY3REYXRhcyBmb3IgdGhlIGdpdmVuIHR5cGU7IHRoaXMKICAgICAg\nICAvLyBhY3R1YWxseSBnaXZlcyB1cyBhbGwgaW5zdGFuY2VzIG9mIHRoZSBi\nYXNlIGNsYXNzIG9mIHRoZSB0eXBlCiAgICAgICAgT2JqZWN0RGF0YVtdIGRh\ndGFzID0gX3N0b3JlLmdldERhdGEobWV0YSk7CiAgICAgICAgQ2xhc3MgY2Fu\nZGlkYXRlID0gbWV0YS5nZXREZXNjcmliZWRUeXBlKCk7CgogICAgICAgIC8v\nIGNyZWF0ZSBhIGxpc3Qgb2YgdGhlIGNvcnJlc3BvbmRpbmcgcGVyc2lzdGVu\ndCBvYmplY3RzIHRoYXQKICAgICAgICAvLyBtYXRjaCB0aGUgdHlwZSBhbmQg\nc3ViY2xhc3NlcyBjcml0ZXJpYQogICAgICAgIExpc3QgcGNzID0gbmV3IEFy\ncmF5TGlzdChkYXRhcy5sZW5ndGgpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgZGF0YXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgLy8gZG9l\ncyB0aGlzIGluc3RhbmNlIGJlbG9uZyBpbiB0aGUgZXh0ZW50PwogICAgICAg\nICAgICBDbGFzcyBjID0gZGF0YXNbaV0uZ2V0TWV0YURhdGEoKS5nZXREZXNj\ncmliZWRUeXBlKCk7CiAgICAgICAgICAgIGlmIChjICE9IGNhbmRpZGF0ZSAm\nJiAoIXN1YmNsYXNzZXMKICAgICAgICAgICAgICAgIHx8ICFjYW5kaWRhdGUu\naXNBc3NpZ25hYmxlRnJvbShjKSkpCiAgICAgICAgICAgICAgICBjb250aW51\nZTsKCiAgICAgICAgICAgIC8vIGxvb2sgdXAgdGhlIHBjIGluc3RhbmNlIGZv\nciB0aGUgZGF0YSwgcGFzc2luZyBpbiB0aGUgZGF0YQogICAgICAgICAgICAv\nLyBhcyB3ZWxsIHNvIHRoYXQgd2UgY2FuIHRha2UgYWR2YW50YWdlIG9mIHRo\nZSBmYWN0IHRoYXQgd2UndmUKICAgICAgICAgICAgLy8gYWxyZWFkeSBsb29r\nZWQgaXQgdXAuICBub3RlIHRoYXQgaW4gdGhlIHN0b3JlIG1hbmFnZXIncwog\nICAgICAgICAgICAvLyBpbml0aWFsaXplKCksIGxvYWQoKSwgZXRjIG1ldGhv\nZHMgd2UgY2hlY2sgZm9yIHRoaXMgZGF0YQogICAgICAgICAgICAvLyBiZWlu\nZyBwYXNzZWQgdGhyb3VnaCBhbmQgc2F2ZSBvdXJzZWx2ZXMgYSB0cmlwIHRv\nIHRoZSBzdG9yZQogICAgICAgICAgICAvLyBpZiBpdCBpcyBwcmVzZW50OyB0\naGlzIGlzIHBhcnRpY3VsYXJseSBpbXBvcnRhbnQgaW4gc3lzdGVtcwogICAg\nICAgICAgICAvLyB3aGVyZSBhIHRyaXAgdG8gdGhlIHN0b3JlIGNhbiBiZSBl\neHBlbnNpdmUuCiAgICAgICAgICAgIHBjcy5hZGQoY3R4LmZpbmQoZGF0YXNb\naV0uZ2V0SWQoKSwgZmV0Y2gsIG51bGwsIGRhdGFzW2ldLCAwKSk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBuZXcgTGlzdFJlc3VsdE9iamVjdFByb3Zp\nZGVyKHBjcyk7CiAgICB9CiAgICBwdWJsaWMgYm9vbGVhbiBpc0NhY2hlZChM\naXN0PE9iamVjdD4gb2lkcywgQml0U2V0IGVkYXRhKSB7CiAgICAgICAgLy8g\nWE1MU3RvcmVNYW5hZ2VyIGRvZXMgbm90IGNhY2hlIG9pZHMuIAogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KfQo=\n","encoding":"base64"}

