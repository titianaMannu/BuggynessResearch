{"sha":"c863a288e73efd5701eae970e58d37092854af25","node_id":"MDQ6QmxvYjIwNjM2NDpjODYzYTI4OGU3M2VmZDU3MDFlYWU5NzBlNThkMzcwOTI4NTRhZjI1","size":11483,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c863a288e73efd5701eae970e58d37092854af25","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5SZXN1\nbHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNs\nYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb25JbXBsOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnJvcC5FYWdlclJlc3VsdExpc3Q7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5MaXN0UmVzdWx0T2JqZWN0\nUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5S\nZXN1bHRMaXN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3Au\nUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnJvcC5TaW1wbGVSZXN1bHRMaXN0OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5yb3AuU29mdFJhbmRvbUFjY2Vzc1Jlc3VsdExpc3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5XaW5kb3dSZXN1\nbHRMaXN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxk\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2Vy\nRXhjZXB0aW9uOwoKLyoqCiAqIEpEQkMgZXh0ZW5zaW9ucyB0byBPcGVuSlBB\nJ3Mge0BsaW5rIEZldGNoQ29uZmlndXJhdGlvbn0uCiAqCiAqIEBhdXRob3Ig\nQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uSW1wbAogICAgZXh0ZW5kcyBGZXRjaENvbmZp\nZ3VyYXRpb25JbXBsCiAgICBpbXBsZW1lbnRzIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb24gewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbkltcGwuY2xhc3MpOwoKICAgIC8qKgogICAgICogQ29u\nZmlndXJhYmxlIEpEQkMgc3RhdGUgc2hhcmVkIHRocm91Z2hvdXQgYSB0cmF2\nZXJzYWwgY2hhaW4uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNz\nIEpEQkNDb25maWd1cmF0aW9uU3RhdGUgaW1wbGVtZW50cyBTZXJpYWxpemFi\nbGUgewogICAgICAgIHB1YmxpYyBpbnQgZWFnZXJNb2RlID0gMDsKICAgICAg\nICBwdWJsaWMgaW50IHN1YmNsYXNzTW9kZSA9IDA7CiAgICAgICAgcHVibGlj\nIGludCB0eXBlID0gMDsKICAgICAgICBwdWJsaWMgaW50IGRpcmVjdGlvbiA9\nIDA7CiAgICAgICAgcHVibGljIGludCBzaXplID0gMDsKICAgICAgICBwdWJs\naWMgaW50IHN5bnRheCA9IDA7CiAgICAgICAgcHVibGljIFNldCBqb2lucyA9\nIG51bGw7CiAgICAgICAgcHVibGljIGludCBpc29sYXRpb25MZXZlbCA9IC0x\nOwogICAgfQoKICAgIHByaXZhdGUgZmluYWwgSkRCQ0NvbmZpZ3VyYXRpb25T\ndGF0ZSBfc3RhdGU7CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb25JbXBsKCkgewogICAgICAgIHRoaXMobnVsbCwgbnVsbCk7CiAgICB9Cgog\nICAgcHJpdmF0ZSBKREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbChDb25maWd1\ncmF0aW9uU3RhdGUgc3RhdGUsIAogICAgICAgIEpEQkNDb25maWd1cmF0aW9u\nU3RhdGUganN0YXRlKSB7CiAgICAgICAgc3VwZXIoc3RhdGUpOwogICAgICAg\nIF9zdGF0ZSA9IChqc3RhdGUgPT0gbnVsbCkgPyBuZXcgSkRCQ0NvbmZpZ3Vy\nYXRpb25TdGF0ZSgpIDoganN0YXRlOwogICAgfQoKICAgIHByb3RlY3RlZCBG\nZXRjaENvbmZpZ3VyYXRpb25JbXBsIG5ld0luc3RhbmNlKENvbmZpZ3VyYXRp\nb25TdGF0ZSBzdGF0ZSkgewogICAgICAgIEpEQkNDb25maWd1cmF0aW9uU3Rh\ndGUganN0YXRlID0gKHN0YXRlID09IG51bGwpID8gbnVsbCA6IF9zdGF0ZTsK\nICAgICAgICByZXR1cm4gbmV3IEpEQkNGZXRjaENvbmZpZ3VyYXRpb25JbXBs\nKHN0YXRlLCBqc3RhdGUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENv\nbnRleHQoU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAgIHN1cGVyLnNldENv\nbnRleHQoY3R4KTsKICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0g\nZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKTsKICAgICAgICBpZiAoY29uZiA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIHNldEVhZ2VyRmV0\nY2hNb2RlKGNvbmYuZ2V0RWFnZXJGZXRjaE1vZGVDb25zdGFudCgpKTsKICAg\nICAgICBzZXRTdWJjbGFzc0ZldGNoTW9kZShjb25mLmdldFN1YmNsYXNzRmV0\nY2hNb2RlQ29uc3RhbnQoKSk7CiAgICAgICAgc2V0UmVzdWx0U2V0VHlwZShj\nb25mLmdldFJlc3VsdFNldFR5cGVDb25zdGFudCgpKTsKICAgICAgICBzZXRG\nZXRjaERpcmVjdGlvbihjb25mLmdldEZldGNoRGlyZWN0aW9uQ29uc3RhbnQo\nKSk7CiAgICAgICAgc2V0TFJTU2l6ZShjb25mLmdldExSU1NpemVDb25zdGFu\ndCgpKTsKICAgICAgICBzZXRKb2luU3ludGF4KGNvbmYuZ2V0REJEaWN0aW9u\nYXJ5SW5zdGFuY2UoKS5qb2luU3ludGF4KTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjb3B5KEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAg\nIHN1cGVyLmNvcHkoZmV0Y2gpOwogICAgICAgIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb24gamYgPSAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikgZmV0Y2g7CiAg\nICAgICAgc2V0RWFnZXJGZXRjaE1vZGUoamYuZ2V0RWFnZXJGZXRjaE1vZGUo\nKSk7CiAgICAgICAgc2V0U3ViY2xhc3NGZXRjaE1vZGUoamYuZ2V0U3ViY2xh\nc3NGZXRjaE1vZGUoKSk7CiAgICAgICAgc2V0UmVzdWx0U2V0VHlwZShqZi5n\nZXRSZXN1bHRTZXRUeXBlKCkpOwogICAgICAgIHNldEZldGNoRGlyZWN0aW9u\nKGpmLmdldEZldGNoRGlyZWN0aW9uKCkpOwogICAgICAgIHNldExSU1NpemUo\namYuZ2V0TFJTU2l6ZSgpKTsKICAgICAgICBzZXRKb2luU3ludGF4KGpmLmdl\ndEpvaW5TeW50YXgoKSk7CiAgICAgICAgYWRkSm9pbnMoamYuZ2V0Sm9pbnMo\nKSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRFYWdlckZldGNoTW9kZSgp\nIHsKICAgICAgICByZXR1cm4gX3N0YXRlLmVhZ2VyTW9kZTsKICAgIH0KCiAg\nICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRFYWdlckZldGNo\nTW9kZShpbnQgbW9kZSkgewogICAgICAgIGlmIChtb2RlID09IERFRkFVTFQp\nIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpE\nQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGlmIChjb25mICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBtb2RlID0gY29uZi5nZXRFYWdlckZldGNo\nTW9kZUNvbnN0YW50KCk7CiAgICAgICAgfQogICAgICAgIGlmIChtb2RlICE9\nIERFRkFVTFQpCiAgICAgICAgICAgIF9zdGF0ZS5lYWdlck1vZGUgPSBtb2Rl\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nZ2V0U3ViY2xhc3NGZXRjaE1vZGUoKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0\nZS5zdWJjbGFzc01vZGU7CiAgICB9CgogICAgcHVibGljIGludCBnZXRTdWJj\nbGFzc0ZldGNoTW9kZShDbGFzc01hcHBpbmcgY2xzKSB7CiAgICAgICAgaWYg\nKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gX3N0YXRlLnN1YmNs\nYXNzTW9kZTsKICAgICAgICBpbnQgbW9kZSA9IGNscy5nZXRTdWJjbGFzc0Zl\ndGNoTW9kZSgpOwogICAgICAgIGlmIChtb2RlID09IERFRkFVTFQpCiAgICAg\nICAgICAgIHJldHVybiBfc3RhdGUuc3ViY2xhc3NNb2RlOwogICAgICAgIHJl\ndHVybiBNYXRoLm1pbihtb2RlLCBfc3RhdGUuc3ViY2xhc3NNb2RlKTsKICAg\nIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRTdWJj\nbGFzc0ZldGNoTW9kZShpbnQgbW9kZSkgewogICAgICAgIGlmIChtb2RlID09\nIERFRkFVTFQpIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGlmIChj\nb25mICE9IG51bGwpCiAgICAgICAgICAgICAgICBtb2RlID0gY29uZi5nZXRT\ndWJjbGFzc0ZldGNoTW9kZUNvbnN0YW50KCk7CiAgICAgICAgfQogICAgICAg\nIGlmIChtb2RlICE9IERFRkFVTFQpCiAgICAgICAgICAgIF9zdGF0ZS5zdWJj\nbGFzc01vZGUgPSBtb2RlOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoK\nICAgIHB1YmxpYyBpbnQgZ2V0UmVzdWx0U2V0VHlwZSgpIHsKICAgICAgICBy\nZXR1cm4gX3N0YXRlLnR5cGU7CiAgICB9CgogICAgcHVibGljIEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24gc2V0UmVzdWx0U2V0VHlwZShpbnQgdHlwZSkgewog\nICAgICAgIGlmICh0eXBlID09IERFRkFVTFQpIHsKICAgICAgICAgICAgSkRC\nQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7\nCiAgICAgICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBfc3RhdGUudHlwZSA9IGNvbmYuZ2V0UmVzdWx0U2V0VHlwZUNvbnN0YW50\nKCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS50eXBlID0g\ndHlwZTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGdldEZldGNoRGlyZWN0aW9uKCkgewogICAgICAgIHJldHVybiBfc3Rh\ndGUuZGlyZWN0aW9uOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25m\naWd1cmF0aW9uIHNldEZldGNoRGlyZWN0aW9uKGludCBkaXJlY3Rpb24pIHsK\nICAgICAgICBpZiAoZGlyZWN0aW9uID09IERFRkFVTFQpIHsKICAgICAgICAg\nICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0\naW9uKCk7CiAgICAgICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBfc3RhdGUuZGlyZWN0aW9uID0gY29uZi5nZXRGZXRjaERpcmVj\ndGlvbkNvbnN0YW50KCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9z\ndGF0ZS5kaXJlY3Rpb24gPSBkaXJlY3Rpb247CiAgICAgICAgcmV0dXJuIHRo\naXM7CiAgICB9CgogICAgcHVibGljIGludCBnZXRMUlNTaXplKCkgewogICAg\nICAgIHJldHVybiBfc3RhdGUuc2l6ZTsKICAgIH0KCiAgICBwdWJsaWMgSkRC\nQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRMUlNTaXplKGludCBzaXplKSB7CiAg\nICAgICAgaWYgKHNpemUgPT0gREVGQVVMVCkgewogICAgICAgICAgICBKREJD\nQ29uZmlndXJhdGlvbiBjb25mID0gZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKTsK\nICAgICAgICAgICAgaWYgKGNvbmYgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIF9zdGF0ZS5zaXplID0gY29uZi5nZXRMUlNTaXplQ29uc3RhbnQoKTsKICAg\nICAgICB9IGVsc2UKICAgICAgICAgICAgX3N0YXRlLnNpemUgPSBzaXplOwog\nICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0\nSm9pblN5bnRheCgpIHsKICAgICAgICByZXR1cm4gX3N0YXRlLnN5bnRheDsK\nICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRK\nb2luU3ludGF4KGludCBzeW50YXgpIHsKICAgICAgICBpZiAoc3ludGF4ID09\nIERFRkFVTFQpIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGlmIChj\nb25mICE9IG51bGwpCiAgICAgICAgICAgICAgICBfc3RhdGUuc3ludGF4ID0g\nY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpLmpvaW5TeW50YXg7CiAg\nICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS5zeW50YXggPSBzeW50\nYXg7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIFJl\nc3VsdExpc3QgbmV3UmVzdWx0TGlzdChSZXN1bHRPYmplY3RQcm92aWRlciBy\nb3ApIHsKICAgICAgICAvLyBpZiBidWlsdCBhcm91bmQgYSBsaXN0LCBqdXN0\nIHVzZSBhIHNpbXBsZSB3cmFwcGVyCiAgICAgICAgaWYgKHJvcCBpbnN0YW5j\nZW9mIExpc3RSZXN1bHRPYmplY3RQcm92aWRlcikKICAgICAgICAgICAgcmV0\ndXJuIG5ldyBTaW1wbGVSZXN1bHRMaXN0KHJvcCk7CgogICAgICAgIC8vIGlm\nIGJ1aWx0IGFyb3VuZCBhIHBhZ2luZyBsaXN0LCB1c2UgYSB3aW5kb3cgcHJv\ndmlkZXIgd2l0aCB0aGUKICAgICAgICAvLyBzYW1lIHdpbmRvdyBzaXplCiAg\nICAgICAgaWYgKHJvcCBpbnN0YW5jZW9mIFBhZ2luZ1Jlc3VsdE9iamVjdFBy\nb3ZpZGVyKQogICAgICAgICAgICByZXR1cm4gbmV3IFdpbmRvd1Jlc3VsdExp\nc3Qocm9wLCAoKFBhZ2luZ1Jlc3VsdE9iamVjdFByb3ZpZGVyKQogICAgICAg\nICAgICAgICAgcm9wKS5nZXRQYWdlU2l6ZSgpKTsKCiAgICAgICAgLy8gaWYg\nZmV0Y2ggc2l6ZSA8IDAganVzdCByZWFkIGluIGFsbCByZXN1bHRzIGltbWVk\naWF0ZWx5CiAgICAgICAgaWYgKGdldEZldGNoQmF0Y2hTaXplKCkgPCAwKQog\nICAgICAgICAgICByZXR1cm4gbmV3IEVhZ2VyUmVzdWx0TGlzdChyb3ApOwoK\nICAgICAgICAvLyBpZiBmb3dhcmQgb25seSBvciBmb3J3YXJkIGRpcmVjdGlv\nbiB1c2UgYSBmb3J3YXJkIHdpbmRvdwogICAgICAgIGlmIChfc3RhdGUudHlw\nZSA9PSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFkKICAgICAgICAgICAg\nfHwgX3N0YXRlLmRpcmVjdGlvbiA9PSBSZXN1bHRTZXQuRkVUQ0hfRk9SV0FS\nRAogICAgICAgICAgICB8fCAhcm9wLnN1cHBvcnRzUmFuZG9tQWNjZXNzKCkp\nIHsKICAgICAgICAgICAgaWYgKGdldEZldGNoQmF0Y2hTaXplKCkgPiAwICYm\nIGdldEZldGNoQmF0Y2hTaXplKCkgPD0gNTApCiAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IFdpbmRvd1Jlc3VsdExpc3Qocm9wLCBnZXRGZXRjaEJhdGNo\nU2l6ZSgpKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBXaW5kb3dSZXN1bHRM\naXN0KHJvcCwgNTApOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgc2tpcHBp\nbmcgYXJvdW5kIHVzZSBhIGNhY2hpbmcgcmFuZG9tIGFjY2VzcyBsaXN0CiAg\nICAgICAgaWYgKF9zdGF0ZS5kaXJlY3Rpb24gPT0gUmVzdWx0U2V0LkZFVENI\nX1VOS05PV04pCiAgICAgICAgICAgIHJldHVybiBuZXcgU29mdFJhbmRvbUFj\nY2Vzc1Jlc3VsdExpc3Qocm9wKTsKCiAgICAgICAgLy8gc2Nyb2xsaW5nIHJl\ndmVyc2UuLi4ganVzdCB1c2Ugbm9uLWNhY2hpbmcgc2ltcGxlIHJlc3VsdCBs\naXN0CiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVSZXN1bHRMaXN0KHJvcCk7\nCiAgICB9CgogICAgcHVibGljIFNldCBnZXRKb2lucygpIHsKICAgICAgICBy\nZXR1cm4gKF9zdGF0ZS5qb2lucyA9PSBudWxsKSA/IENvbGxlY3Rpb25zLkVN\nUFRZX1NFVCA6IF9zdGF0ZS5qb2luczsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBoYXNKb2luKFN0cmluZyBmaWVsZCkgewogICAgICAgIHJldHVybiBf\nc3RhdGUuam9pbnMgIT0gbnVsbCAmJiBfc3RhdGUuam9pbnMuY29udGFpbnMo\nZmllbGQpOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGFkZEpvaW4oU3RyaW5nIGpvaW4pIHsKICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eShqb2luKSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVz\nZXJFeGNlcHRpb24oX2xvYy5nZXQoIm51bGwtam9pbiIpKTsKICAgICAgICAK\nICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYg\nKF9zdGF0ZS5qb2lucyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3N0YXRl\nLmpvaW5zID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICAgICAgX3N0YXRlLmpv\naW5zLmFkZChqb2luKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICB1bmxvY2soKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gYWRkSm9p\nbnMoQ29sbGVjdGlvbiBqb2lucykgewogICAgICAgIGlmIChqb2lucyA9PSBu\ndWxsIHx8IGpvaW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIHRo\naXM7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBqb2lucy5pdGVyYXRv\ncigpOyBpdHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgYWRkSm9pbigoU3Ry\naW5nKSBpdHIubmV4dCgpKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0K\nCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiByZW1vdmVKb2lu\nKFN0cmluZyBmaWVsZCkgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBpZiAoX3N0YXRlLmpvaW5zICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBfc3RhdGUuam9pbnMucmVtb3ZlKGZpZWxkKTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gcmVtb3ZlSm9pbnMoQ29sbGVjdGlvbiBqb2lu\ncykgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoX3N0YXRlLmpvaW5zICE9IG51bGwpCiAgICAgICAgICAgICAgICBf\nc3RhdGUuam9pbnMucmVtb3ZlQWxsKGpvaW5zKTsKICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gY2xlYXJKb2lucygpIHsKICAgICAgICBsb2NrKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9zdGF0ZS5qb2lucyAhPSBudWxs\nKQogICAgICAgICAgICAgICAgX3N0YXRlLmpvaW5zLmNsZWFyKCk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nZ2V0SXNvbGF0aW9uKCkgewogICAgICAgIHJldHVybiBfc3RhdGUuaXNvbGF0\naW9uTGV2ZWw7CiAgICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb24gc2V0SXNvbGF0aW9uKGludCBsZXZlbCkgewogICAgICAgIGlmIChs\nZXZlbCAhPSAtMSAmJiBsZXZlbCAhPSBERUZBVUxUCiAgICAgICAgICAgICYm\nIGxldmVsICE9IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fTk9ORQogICAgICAg\nICAgICAmJiBsZXZlbCAhPSBDb25uZWN0aW9uLlRSQU5TQUNUSU9OX1JFQURf\nVU5DT01NSVRURUQKICAgICAgICAgICAgJiYgbGV2ZWwgIT0gQ29ubmVjdGlv\nbi5UUkFOU0FDVElPTl9SRUFEX0NPTU1JVFRFRAogICAgICAgICAgICAmJiBs\nZXZlbCAhPSBDb25uZWN0aW9uLlRSQU5TQUNUSU9OX1JFUEVBVEFCTEVfUkVB\nRAogICAgICAgICAgICAmJiBsZXZlbCAhPSBDb25uZWN0aW9uLlRSQU5TQUNU\nSU9OX1NFUklBTElaQUJMRSkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxBcmd1bWVudEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIF9sb2MuZ2V0\nKCJiYWQtbGV2ZWwiLCBJbnRlZ2VyLnZhbHVlT2YobGV2ZWwpKS5nZXRNZXNz\nYWdlKCkpOwoKICAgICAgICBpZiAobGV2ZWwgPT0gREVGQVVMVCkKICAgICAg\nICAgICAgX3N0YXRlLmlzb2xhdGlvbkxldmVsID0gLTE7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBfc3RhdGUuaXNvbGF0aW9uTGV2ZWwgPSBsZXZlbDsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0Zl\ndGNoQ29uZmlndXJhdGlvbiB0cmF2ZXJzZUpEQkMoRmllbGRNZXRhRGF0YSBm\nbSkgewogICAgICAgIHJldHVybiAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikg\ndHJhdmVyc2UoZm0pOwogICAgfQoKICAgIC8qKgogICAgICogQWNjZXNzIEpE\nQkMgY29uZmlndXJhdGlvbiBpbmZvcm1hdGlvbi4gTWF5IHJldHVybiBudWxs\nIGlmIG5vdCBhCiAgICAgKiBKREJDIGJhY2stZW5kIChwb3NzaWJsZSB0byBn\nZXQgYSBKREJDRmV0Y2hDb25maWd1cmF0aW9uIG9uIG5vbi1KREJDCiAgICAg\nKiBiYWNrIGVuZCBpbiByZW1vdGUgY2xpZW50KS4KICAgICAqLwogICAgcHJp\ndmF0ZSBKREJDQ29uZmlndXJhdGlvbiBnZXRKREJDQ29uZmlndXJhdGlvbigp\nIHsKICAgICAgICBTdG9yZUNvbnRleHQgY3R4ID0gZ2V0Q29udGV4dCgpOwog\nICAgICAgIGlmIChjdHggPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiA9IGN0eC5n\nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKCEoY29uZiBpbnN0YW5j\nZW9mIEpEQkNDb25maWd1cmF0aW9uKSkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgcmV0dXJuIChKREJDQ29uZmlndXJhdGlvbikgY29uZjsK\nICAgIH0KfQo=\n","encoding":"base64"}

