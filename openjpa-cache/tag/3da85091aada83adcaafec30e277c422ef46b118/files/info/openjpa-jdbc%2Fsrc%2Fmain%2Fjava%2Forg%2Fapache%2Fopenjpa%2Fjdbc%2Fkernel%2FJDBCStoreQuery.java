{"sha":"1ae44bfe727fe0196be91650d8746eb237f97d17","node_id":"MDQ6QmxvYjIwNjM2NDoxYWU0NGJmZTcyN2ZlMDE5NmJlOTE2NTBkODc0NmViMjM3Zjk3ZDE3","size":26818,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1ae44bfe727fe0196be91650d8746eb237f97d17","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQml0U2V0OwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnRN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVs\nLmV4cHMuRXhwQ29udGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLmtlcm5lbC5leHBzLkdldENvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkpEQkNFeHByZXNzaW9uRmFjdG9y\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBz\nLkpEQkNTdHJpbmdDb250YWluczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLmtlcm5lbC5leHBzLkpEQkNXaWxkY2FyZE1hdGNoOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuUXVlcnlFeHBy\nZXNzaW9uc1N0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\na2VybmVsLmV4cHMuU1FMRW1iZWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuZXhwcy5TUUxFeHByZXNzaW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuU1FMVmFsdWU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGlu\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRN\nYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuVmVydGljYWxDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMQnVmZmVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEV4Y2VwdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlVuaW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5FeHByZXNzaW9uU3RvcmVRdWVyeTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3JkZXJpbmdNZXJn\nZWRSZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuUXVlcnlIaW50czsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uUGFyc2Vy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkZpbHRl\nckxpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5l\neHBzLlF1ZXJ5RXhwcmVzc2lvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnJvcC5NZXJnZWRSZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJhbmdlUmVzdWx0T2JqZWN0\nUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5S\nZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLm1ldGEuVmFsdWVNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLlVzZXJFeGNlcHRpb247CmltcG9ydCBzZXJwLnV0aWwuTnVt\nYmVyczsKCi8qKgogKiBKREJDIHF1ZXJ5IGltcGxlbWVudGF0aW9uLgogKgog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMg\nY2xhc3MgSkRCQ1N0b3JlUXVlcnkgCiAgICBleHRlbmRzIEV4cHJlc3Npb25T\ndG9yZVF1ZXJ5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBUYWJsZSBJ\nTlZBTElEID0gbmV3IFRhYmxlKCk7CgogICAgLy8gYWRkIGFsbCBzdGFuZGFy\nZCBmaWx0ZXIgYW5kIGFnZ3JlZ2F0ZSBsaXN0ZW5lcnMgdG8gdGhlc2UgbWFw\ncwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwIF9saXN0ZW5lcnMgPSBu\nZXcgSGFzaE1hcCgpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgLy8gZGVwcmVj\nYXRlZCBleHRlbnNpb25zCiAgICAgICAgX2xpc3RlbmVycy5wdXQoSkRCQ1N0\ncmluZ0NvbnRhaW5zLlRBRywgbmV3IEpEQkNTdHJpbmdDb250YWlucygpKTsK\nICAgICAgICBfbGlzdGVuZXJzLnB1dChKREJDV2lsZGNhcmRNYXRjaC5UQUcs\nIG5ldyBKREJDV2lsZGNhcmRNYXRjaCgpKTsKICAgICAgICBfbGlzdGVuZXJz\nLnB1dChTUUxFeHByZXNzaW9uLlRBRywgbmV3IFNRTEV4cHJlc3Npb24oKSk7\nCiAgICAgICAgX2xpc3RlbmVycy5wdXQoU1FMVmFsdWUuVEFHLCBuZXcgU1FM\nVmFsdWUoKSk7CgogICAgICAgIC8vIGpkYmMtc3BlY2lmaWMgZXh0ZW5zaW9u\ncwogICAgICAgIF9saXN0ZW5lcnMucHV0KEdldENvbHVtbi5UQUcsIG5ldyBH\nZXRDb2x1bW4oKSk7CiAgICAgICAgX2xpc3RlbmVycy5wdXQoU1FMRW1iZWQu\nVEFHLCBuZXcgU1FMRW1iZWQoKSk7CiAgICB9CgogICAgcHJpdmF0ZSBmaW5h\nbCB0cmFuc2llbnQgSkRCQ1N0b3JlIF9zdG9yZTsKCiAgICAvKioKICAgICAq\nIENvbnN0cnVjdG9yLiBTdXBwbHkgc3RvcmUgbWFuYWdlci4KICAgICAqLwog\nICAgcHVibGljIEpEQkNTdG9yZVF1ZXJ5KEpEQkNTdG9yZSBzdG9yZSwgRXhw\ncmVzc2lvblBhcnNlciBwYXJzZXIpIHsKICAgICAgICBzdXBlcihwYXJzZXIp\nOwogICAgICAgIF9zdG9yZSA9IHN0b3JlOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBzdG9yZS4KICAgICAqLwogICAgcHVibGljIEpEQkNT\ndG9yZSBnZXRTdG9yZSgpIHsKICAgICAgICByZXR1cm4gX3N0b3JlOwogICAg\nfQoKICAgIHB1YmxpYyBGaWx0ZXJMaXN0ZW5lciBnZXRGaWx0ZXJMaXN0ZW5l\ncihTdHJpbmcgdGFnKSB7CiAgICAgICAgcmV0dXJuIChGaWx0ZXJMaXN0ZW5l\ncikgX2xpc3RlbmVycy5nZXQodGFnKTsKICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IG5ld0NvbXBpbGF0aW9uS2V5KCkgewogICAgICAgIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gZmV0Y2ggPSAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikg\nY3R4CiAgICAgICAgICAgIC5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKICAg\nICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKGZldGNoLmdldEpvaW5TeW50\nYXgoKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNEYXRh\nU3RvcmVFeGVjdXRpb24oKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgcHJvdGVjdGVkIENsYXNzTWV0YURhdGFbXSBnZXRJbmRlcGVuZGVu\ndEV4cHJlc3Npb25DYW5kaWRhdGVzKAogICAgICAgIENsYXNzTWV0YURhdGEg\nbWV0YSwgYm9vbGVhbiBzdWJjbGFzc2VzKSB7CiAgICAgICAgaWYgKCFzdWJj\nbGFzc2VzKQogICAgICAgICAgICByZXR1cm4gbmV3IENsYXNzTWFwcGluZ1td\nIHsgKENsYXNzTWFwcGluZykgbWV0YSB9OwogICAgICAgIHJldHVybiAoKENs\nYXNzTWFwcGluZykgbWV0YSkuZ2V0SW5kZXBlbmRlbnRBc3NpZ25hYmxlTWFw\ncGluZ3MoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgRXhwcmVzc2lvbkZhY3Rv\ncnkgZ2V0RXhwcmVzc2lvbkZhY3RvcnkoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7\nCiAgICAgICAgcmV0dXJuIG5ldyBKREJDRXhwcmVzc2lvbkZhY3RvcnkoKENs\nYXNzTWFwcGluZykgbWV0YSk7CiAgICB9CgogICAgcHJvdGVjdGVkIFJlc3Vs\ndE9iamVjdFByb3ZpZGVyIGV4ZWN1dGVRdWVyeShFeGVjdXRvciBleCwKICAg\nICAgICBDbGFzc01ldGFEYXRhIGJhc2UsIENsYXNzTWV0YURhdGFbXSBtZXRh\ncywgYm9vbGVhbiBzdWJjbGFzc2VzLAogICAgICAgIEV4cHJlc3Npb25GYWN0\nb3J5W10gZmFjdHMsIFF1ZXJ5RXhwcmVzc2lvbnNbXSBleHBzLCBPYmplY3Rb\nXSBwYXJhbXMsCiAgICAgICAgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICBpZiAo\nbWV0YXMubGVuZ3RoID4gMSAmJiBleHBzWzBdLmlzQWdncmVnYXRlKCkpCiAg\nICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKExvY2FsaXplci5m\nb3JQYWNrYWdlKEpEQkNTdG9yZVF1ZXJ5LmNsYXNzKS4KICAgICAgICAgICAg\nICAgIGdldCgibXVsdC1tYXBwaW5nLWFnZ3JlZ2F0ZSIsIEFycmF5cy5hc0xp\nc3QobWV0YXMpKSk7CgogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdz\nID0gKENsYXNzTWFwcGluZ1tdKSBtZXRhczsKICAgICAgICBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uIGZldGNoID0gKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24p\nIAogICAgICAgICAgICBjdHguZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgaWYgKGV4cHNbMF0uZmV0Y2hQYXRocyAhPSBudWxsKSB7CiAgICAg\nICAgICAgIGZldGNoLmFkZEZpZWxkcyhBcnJheXMuYXNMaXN0KGV4cHNbMF0u\nZmV0Y2hQYXRocykpOwogICAgICAgICAgICBmZXRjaC5hZGRKb2lucyhBcnJh\neXMuYXNMaXN0KGV4cHNbMF0uZmV0Y2hQYXRocykpOwogICAgICAgIH0KCiAg\nICAgICAgaW50IGVhZ2VyID0gY2FsY3VsYXRlRWFnZXJNb2RlKGV4cHNbMF0s\nIHJhbmdlLnN0YXJ0LCByYW5nZS5lbmQpOwogICAgICAgIGludCBzdWJjbGFz\nc01vZGUgPSBmZXRjaC5nZXRTdWJjbGFzc0ZldGNoTW9kZSgoQ2xhc3NNYXBw\naW5nKSBiYXNlKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9zdG9y\nZS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICBsb25nIHN0YXJ0ID0gKG1h\ncHBpbmdzLmxlbmd0aCA9PSAxICYmIGRpY3Quc3VwcG9ydHNTZWxlY3RTdGFy\ndEluZGV4KSAKICAgICAgICAgICAgPyByYW5nZS5zdGFydCA6IDBMOwogICAg\nICAgIGxvbmcgZW5kID0gKGRpY3Quc3VwcG9ydHNTZWxlY3RFbmRJbmRleCkg\nPyByYW5nZS5lbmQgOiBMb25nLk1BWF9WQUxVRTsKCiAgICAgICAgUXVlcnlF\neHByZXNzaW9uc1N0YXRlW10gc3RhdGVzID0gbmV3IFF1ZXJ5RXhwcmVzc2lv\nbnNTdGF0ZVtleHBzLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzdGF0ZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHN0YXRlc1tp\nXSA9IG5ldyBRdWVyeUV4cHJlc3Npb25zU3RhdGUoKTsKICAgICAgICBFeHBD\nb250ZXh0IGN0eCA9IG5ldyBFeHBDb250ZXh0KF9zdG9yZSwgcGFyYW1zLCBm\nZXRjaCk7CgogICAgICAgIC8vIGFkZCBzZWxlY3RzIHdpdGggcG9wdWxhdGUg\nV0hFUkUgY29uZGl0aW9ucyB0byBsaXN0CiAgICAgICAgTGlzdCBzZWxzID0g\nbmV3IEFycmF5TGlzdChtYXBwaW5ncy5sZW5ndGgpOwogICAgICAgIExpc3Qg\nc2VsTWFwcGluZ3MgPSBuZXcgQXJyYXlMaXN0KG1hcHBpbmdzLmxlbmd0aCk7\nCiAgICAgICAgQml0U2V0IHN1YmNsYXNzQml0cyA9IG5ldyBCaXRTZXQoKTsK\nICAgICAgICBCaXRTZXQgbmV4dEJpdHMgPSBuZXcgQml0U2V0KCk7CiAgICAg\nICAgYm9vbGVhbiB1bmlvbmFibGUgPSBjcmVhdGVXaGVyZVNlbGVjdHMoc2Vs\ncywgbWFwcGluZ3MsIHNlbE1hcHBpbmdzLAogICAgICAgICAgICBzdWJjbGFz\nc2VzLCBzdWJjbGFzc0JpdHMsIG5leHRCaXRzLCBmYWN0cywgZXhwcywgc3Rh\ndGVzLCBjdHgsCiAgICAgICAgICAgIHN1YmNsYXNzTW9kZSkKICAgICAgICAg\nICAgJiYgc3ViY2xhc3NNb2RlID09IEpEQkNGZXRjaENvbmZpZ3VyYXRpb24u\nRUFHRVJfSk9JTgogICAgICAgICAgICAmJiBzdGFydCA9PSAwCiAgICAgICAg\nICAgICYmIGVuZCA9PSBMb25nLk1BWF9WQUxVRTsKCiAgICAgICAgLy8gd2Ug\nbWlnaHQgd2FudCB0byB1c2UgbHJzIHNldHRpbmdzIGlmIHdlIGNhbid0IHVz\nZSB0aGUgcmFuZ2UKICAgICAgICBpZiAoc2Vscy5zaXplKCkgPiAxKQogICAg\nICAgICAgICBzdGFydCA9IDBMOwogICAgICAgIGJvb2xlYW4gbHJzID0gcmFu\nZ2UubHJzIHx8IChmZXRjaC5nZXRGZXRjaEJhdGNoU2l6ZSgpID49IDAgCiAg\nICAgICAgICAgICYmIChzdGFydCAhPSByYW5nZS5zdGFydCB8fCBlbmQgIT0g\ncmFuZ2UuZW5kKSk7CgogICAgICAgIFJlc3VsdE9iamVjdFByb3ZpZGVyW10g\ncm9wcyA9IG51bGw7CiAgICAgICAgUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9w\nID0gbnVsbDsKICAgICAgICBpZiAodW5pb25hYmxlKSB7CiAgICAgICAgICAg\nIFVuaW9uIHVuaW9uID0gX3N0b3JlLmdldFNRTEZhY3RvcnkoKS5uZXdVbmlv\nbigKICAgICAgICAgICAgICAgIChTZWxlY3RbXSkgc2Vscy50b0FycmF5KG5l\ndyBTZWxlY3Rbc2Vscy5zaXplKCldKSk7CiAgICAgICAgICAgIEJpdFNldFtd\nIHBhZ2VkID0gcG9wdWxhdGVVbmlvbih1bmlvbiwgbWFwcGluZ3MsIHN1YmNs\nYXNzZXMsIGZhY3RzLAogICAgICAgICAgICAgICAgZXhwcywgc3RhdGVzLCBj\ndHgsIGxycywgZWFnZXIsIHN0YXJ0LCBlbmQpOwogICAgICAgICAgICB1bmlv\nbi5zZXRMUlMobHJzKTsKICAgICAgICAgICAgcm9wID0gZXhlY3V0ZVVuaW9u\nKHVuaW9uLCBtYXBwaW5ncywgZXhwcywgc3RhdGVzLCBjdHgsIHBhZ2VkKTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoc2Vscy5zaXplKCkg\nPiAxKQogICAgICAgICAgICAgICAgcm9wcyA9IG5ldyBSZXN1bHRPYmplY3RQ\ncm92aWRlcltzZWxzLnNpemUoKV07CgogICAgICAgICAgICBTZWxlY3Qgc2Vs\nOwogICAgICAgICAgICBCaXRTZXQgcGFnZWQ7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwLCBpZHggPSAwOyBpIDwgc2Vscy5zaXplKCk7IGkrKykgewog\nICAgICAgICAgICAgICAgc2VsID0gKFNlbGVjdCkgc2Vscy5nZXQoaSk7CiAg\nICAgICAgICAgICAgICBwYWdlZCA9IHBvcHVsYXRlU2VsZWN0KHNlbCwgKENs\nYXNzTWFwcGluZykgc2VsTWFwcGluZ3MuZ2V0KGkpLAogICAgICAgICAgICAg\nICAgICAgIHN1YmNsYXNzQml0cy5nZXQoaSksIChKREJDRXhwcmVzc2lvbkZh\nY3RvcnkpIGZhY3RzW2lkeF0sCiAgICAgICAgICAgICAgICAgICAgZXhwc1tp\nZHhdLCBzdGF0ZXNbaWR4XSwgY3R4LCBscnMsIGVhZ2VyLCBzdGFydCwgZW5k\nKTsKCiAgICAgICAgICAgICAgICByb3AgPSBleGVjdXRlU2VsZWN0KHNlbCwg\nKENsYXNzTWFwcGluZykgc2VsTWFwcGluZ3MuZ2V0KGkpLAogICAgICAgICAg\nICAgICAgICAgIGV4cHNbaWR4XSwgc3RhdGVzW2lkeF0sIGN0eCwgcGFnZWQs\nIHN0YXJ0LCBlbmQpOwogICAgICAgICAgICAgICAgaWYgKHJvcHMgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICByb3BzW2ldID0gcm9wOwoKICAgICAg\nICAgICAgICAgIGlmIChuZXh0Qml0cy5nZXQoaSkpCiAgICAgICAgICAgICAg\nICAgICAgaWR4Kys7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIGlmIChyb3BzICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKGV4cHNbMF0u\nYXNjZW5kaW5nLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgcm9wID0g\nbmV3IE1lcmdlZFJlc3VsdE9iamVjdFByb3ZpZGVyKHJvcHMpOwogICAgICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHJvcCA9IG5ldyBPcmRlcmlu\nZ01lcmdlZFJlc3VsdE9iamVjdFByb3ZpZGVyKHJvcHMsCiAgICAgICAgICAg\nICAgICAgICAgZXhwc1swXS5hc2NlbmRpbmcsIGV4LCB0aGlzLCBwYXJhbXMp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBuZWVkIHRv\nIGZha2UgcmVzdWx0IHJhbmdlPwogICAgICAgIGlmICgocm9wcyAhPSBudWxs\nICYmIHJhbmdlLmVuZCAhPSBMb25nLk1BWF9WQUxVRSkgCiAgICAgICAgICAg\nIHx8IHN0YXJ0ICE9IHJhbmdlLnN0YXJ0IHx8IGVuZCAhPSByYW5nZS5lbmQp\nCiAgICAgICAgICAgIHJvcCA9IG5ldyBSYW5nZVJlc3VsdE9iamVjdFByb3Zp\nZGVyKHJvcCwgcmFuZ2Uuc3RhcnQsIHJhbmdlLmVuZCk7CiAgICAgICAgcmV0\ndXJuIHJvcDsKICAgIH0KCiAgICAvKioKICAgICAqIFNlbGVjdCBkYXRhIGZv\nciB0aGUgZ2l2ZW4gdW5pb24sIHJldHVybmluZyBwYWdlZCBmaWVsZHMuCiAg\nICAgKi8KICAgIHByaXZhdGUgQml0U2V0W10gcG9wdWxhdGVVbmlvbihVbmlv\nbiB1bmlvbiwgZmluYWwgQ2xhc3NNYXBwaW5nW10gbWFwcGluZ3MsCiAgICAg\nICAgZmluYWwgYm9vbGVhbiBzdWJjbGFzc2VzLCBmaW5hbCBFeHByZXNzaW9u\nRmFjdG9yeVtdIGZhY3RzLAogICAgICAgIGZpbmFsIFF1ZXJ5RXhwcmVzc2lv\nbnNbXSBleHBzLCBmaW5hbCBRdWVyeUV4cHJlc3Npb25zU3RhdGVbXSBzdGF0\nZXMsCiAgICAgICAgZmluYWwgRXhwQ29udGV4dCBjdHgsIGZpbmFsIGJvb2xl\nYW4gbHJzLCBmaW5hbCBpbnQgZWFnZXIsCiAgICAgICAgZmluYWwgbG9uZyBz\ndGFydCwgZmluYWwgbG9uZyBlbmQpIHsKICAgICAgICBmaW5hbCBCaXRTZXRb\nXSBwYWdlZCA9IChleHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aCA+IDApID8g\nbnVsbAogICAgICAgICAgICA6IG5ldyBCaXRTZXRbbWFwcGluZ3MubGVuZ3Ro\nXTsKICAgICAgICB1bmlvbi5zZWxlY3QobmV3IFVuaW9uLlNlbGVjdG9yKCkg\newogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZWxlY3QoU2VsZWN0IHNlbCwg\naW50IGlkeCkgewogICAgICAgICAgICAgICAgQml0U2V0IGJpdHMgPSBwb3B1\nbGF0ZVNlbGVjdChzZWwsIG1hcHBpbmdzW2lkeF0sIHN1YmNsYXNzZXMsCiAg\nICAgICAgICAgICAgICAgICAgKEpEQkNFeHByZXNzaW9uRmFjdG9yeSkgZmFj\ndHNbaWR4XSwgZXhwc1tpZHhdLCBzdGF0ZXNbaWR4XSwKICAgICAgICAgICAg\nICAgICAgICBjdHgsICBscnMsIGVhZ2VyLCBzdGFydCwgZW5kKTsKICAgICAg\nICAgICAgICAgIGlmIChwYWdlZCAhPSBudWxsKQogICAgICAgICAgICAgICAg\nICAgIHBhZ2VkW2lkeF0gPSBiaXRzOwogICAgICAgICAgICB9CiAgICAgICAg\nfSk7CiAgICAgICAgcmV0dXJuIHBhZ2VkOwogICAgfQoKICAgIC8qKgogICAg\nICogU2VsZWN0IGRhdGEgZm9yIHRoZSBnaXZlbiBzZWxlY3QsIHJldHVybmlu\nZyBwYWdlZCBmaWVsZHMuCiAgICAgKi8KICAgIHByaXZhdGUgQml0U2V0IHBv\ncHVsYXRlU2VsZWN0KFNlbGVjdCBzZWwsIENsYXNzTWFwcGluZyBtYXBwaW5n\nLAogICAgICAgIGJvb2xlYW4gc3ViY2xhc3NlcywgSkRCQ0V4cHJlc3Npb25G\nYWN0b3J5IGZhY3QsIFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywKICAgICAgICBR\ndWVyeUV4cHJlc3Npb25zU3RhdGUgc3RhdGUsIEV4cENvbnRleHQgY3R4LCBi\nb29sZWFuIGxycywgaW50IGVhZ2VyLAogICAgICAgIGxvbmcgc3RhcnQsIGxv\nbmcgZW5kKSB7CiAgICAgICAgc2VsLnNldExSUyhscnMpOwogICAgICAgIHNl\nbC5zZXRSYW5nZShzdGFydCwgZW5kKTsKCiAgICAgICAgQml0U2V0IHBhZ2Vk\nID0gbnVsbDsKICAgICAgICBpZiAoZXhwcy5wcm9qZWN0aW9ucy5sZW5ndGgg\nPT0gMCkgewogICAgICAgICAgICBwYWdlZCA9IFBhZ2luZ1Jlc3VsdE9iamVj\ndFByb3ZpZGVyLmdldFBhZ2VkRmllbGRzKHNlbCwgbWFwcGluZywKICAgICAg\nICAgICAgICAgIF9zdG9yZSwgY3R4LmZldGNoLCBlYWdlciwgZW5kIC0gc3Rh\ncnQpOwogICAgICAgICAgICBpZiAocGFnZWQgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGVhZ2VyID0gSkRCQ0ZldGNoQ29uZmlndXJhdGlvbi5FQUdFUl9K\nT0lOOwogICAgICAgIH0KCiAgICAgICAgZmFjdC5nZXRTZWxlY3RDb25zdHJ1\nY3RvcigpLnNlbGVjdChzZWwsIGN0eCwgbWFwcGluZywgc3ViY2xhc3Nlcywg\nZXhwcywKICAgICAgICAgICAgc3RhdGUsIGVhZ2VyKTsKICAgICAgICByZXR1\ncm4gcGFnZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBFeGVjdXRlIHRoZSBn\naXZlbiB1bmlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBSZXN1bHRPYmplY3RQ\ncm92aWRlciBleGVjdXRlVW5pb24oVW5pb24gdW5pb24sCiAgICAgICAgQ2xh\nc3NNYXBwaW5nW10gbWFwcGluZ3MsIFF1ZXJ5RXhwcmVzc2lvbnNbXSBleHBz\nLCAKICAgICAgICBRdWVyeUV4cHJlc3Npb25zU3RhdGVbXSBzdGF0ZXMsIEV4\ncENvbnRleHQgY3R4LCBCaXRTZXRbXSBwYWdlZCkgewogICAgICAgIGlmIChl\neHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aCA+IDApCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgUHJvamVjdGlvblJlc3VsdE9iamVjdFByb3ZpZGVyKHVuaW9u\nLCBleHBzLCBzdGF0ZXMsIGN0eCk7CgogICAgICAgIGlmIChwYWdlZCAhPSBu\ndWxsKQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBhZ2VkLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgaWYgKHBhZ2VkW2ldICE9IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQYWdpbmdSZXN1\nbHRPYmplY3RQcm92aWRlcih1bmlvbiwgbWFwcGluZ3MsCiAgICAgICAgICAg\nICAgICAgICAgICAgIF9zdG9yZSwgY3R4LmZldGNoLCBwYWdlZCwgTG9uZy5N\nQVhfVkFMVUUpOwoKICAgICAgICByZXR1cm4gbmV3IEluc3RhbmNlUmVzdWx0\nT2JqZWN0UHJvdmlkZXIodW5pb24sIG1hcHBpbmdzWzBdLCBfc3RvcmUsCiAg\nICAgICAgICAgIGN0eC5mZXRjaCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBF\neGVjdXRlIHRoZSBnaXZlbiBzZWxlY3QuCiAgICAgKi8KICAgIHByaXZhdGUg\nUmVzdWx0T2JqZWN0UHJvdmlkZXIgZXhlY3V0ZVNlbGVjdChTZWxlY3Qgc2Vs\nLCBDbGFzc01hcHBpbmcgbWFwcGluZywKICAgICAgICBRdWVyeUV4cHJlc3Np\nb25zIGV4cHMsIFF1ZXJ5RXhwcmVzc2lvbnNTdGF0ZSBzdGF0ZSwgRXhwQ29u\ndGV4dCBjdHgsIAogICAgICAgIEJpdFNldCBwYWdlZCwgbG9uZyBzdGFydCwg\nbG9uZyBlbmQpIHsKICAgICAgICBpZiAoZXhwcy5wcm9qZWN0aW9ucy5sZW5n\ndGggPiAwKQogICAgICAgICAgICByZXR1cm4gbmV3IFByb2plY3Rpb25SZXN1\nbHRPYmplY3RQcm92aWRlcihzZWwsIGV4cHMsIHN0YXRlLCBjdHgpOwogICAg\nICAgIGlmIChwYWdlZCAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gbmV3\nIFBhZ2luZ1Jlc3VsdE9iamVjdFByb3ZpZGVyKHNlbCwgbWFwcGluZywgX3N0\nb3JlLCAKICAgICAgICAgICAgICAgIGN0eC5mZXRjaCwgcGFnZWQsIGVuZCAt\nIHN0YXJ0KTsKICAgICAgICByZXR1cm4gbmV3IEluc3RhbmNlUmVzdWx0T2Jq\nZWN0UHJvdmlkZXIoc2VsLCBtYXBwaW5nLCBfc3RvcmUsIAogICAgICAgICAg\nICBjdHguZmV0Y2gpOwogICAgfQoKICAgIC8qKgogICAgICogR2VuZXJhdGUg\ndGhlIHNlbGVjdHMgd2l0aCBXSEVSRSBjb25kaXRpb25zIG5lZWRlZCB0byBl\neGVjdXRlIHRoZSBxdWVyeQogICAgICogZm9yIHRoZSBnaXZlbiBtYXBwaW5n\ncy4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGNyZWF0ZVdoZXJlU2Vs\nZWN0cyhMaXN0IHNlbHMsIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzLAogICAg\nICAgIExpc3Qgc2VsTWFwcGluZ3MsIGJvb2xlYW4gc3ViY2xhc3NlcywgQml0\nU2V0IHN1YmNsYXNzQml0cywKICAgICAgICBCaXRTZXQgbmV4dEJpdHMsIEV4\ncHJlc3Npb25GYWN0b3J5W10gZmFjdHMsIFF1ZXJ5RXhwcmVzc2lvbnNbXSBl\neHBzLAogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNTdGF0ZVtdIHN0YXRlcywg\nRXhwQ29udGV4dCBjdHgsIGludCBzdWJjbGFzc01vZGUpIHsKICAgICAgICBO\ndW1iZXIgb3B0SGludCA9IChOdW1iZXIpIGN0eC5mZXRjaC5nZXRIaW50CiAg\nICAgICAgICAgIChRdWVyeUhpbnRzLkhJTlRfUkVTVUxUX0NPVU5UKTsKICAg\nICAgICBDbGFzc01hcHBpbmdbXSB2ZXJ0czsKICAgICAgICBib29sZWFuIHVu\naW9uYWJsZSA9IHRydWU7CiAgICAgICAgU2VsZWN0IHNlbDsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IG1hcHBpbmdzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIC8vIGRldGVybWluZSB2ZXJ0aWNhbCBtYXBwaW5ncyB0byBz\nZWxlY3Qgc2VwYXJhdGVseQogICAgICAgICAgICB2ZXJ0cyA9IGdldFZlcnRp\nY2FsTWFwcGluZ3MobWFwcGluZ3NbaV0sIHN1YmNsYXNzZXMsIGV4cHNbaV0s\nCiAgICAgICAgICAgICAgICBzdWJjbGFzc01vZGUpOwogICAgICAgICAgICBp\nZiAodmVydHMubGVuZ3RoID09IDEgJiYgc3ViY2xhc3NlcykKICAgICAgICAg\nICAgICAgIHN1YmNsYXNzQml0cy5zZXQoc2Vscy5zaXplKCkpOwoKICAgICAg\nICAgICAgLy8gY3JlYXRlIGNyaXRlcmlhIHNlbGVjdCBhbmQgY2xvbmUgZm9y\nIGVhY2ggdmVydCBtYXBwaW5nCiAgICAgICAgICAgIHNlbCA9ICgoSkRCQ0V4\ncHJlc3Npb25GYWN0b3J5KSBmYWN0c1tpXSkuZ2V0U2VsZWN0Q29uc3RydWN0\nb3IoKS4KICAgICAgICAgICAgICAgIGV2YWx1YXRlKGN0eCwgbnVsbCwgbnVs\nbCwgZXhwc1tpXSwgc3RhdGVzW2ldKTsKICAgICAgICAgICAgaWYgKG9wdEhp\nbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAgc2VsLnNldEV4cGVjdGVkUmVz\ndWx0Q291bnQob3B0SGludC5pbnRWYWx1ZSgpLCB0cnVlKTsKICAgICAgICAg\nICAgZWxzZSBpZiAodGhpcy5jdHguaXNVbmlxdWUoKSkKICAgICAgICAgICAg\nICAgIHNlbC5zZXRFeHBlY3RlZFJlc3VsdENvdW50KDEsIGZhbHNlKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB2ZXJ0cy5sZW5ndGg7IGor\nKykgewogICAgICAgICAgICAgICAgc2VsTWFwcGluZ3MuYWRkKHZlcnRzW2pd\nKTsKICAgICAgICAgICAgICAgIGlmIChqID09IHZlcnRzLmxlbmd0aCAtIDEp\nIHsKICAgICAgICAgICAgICAgICAgICBuZXh0Qml0cy5zZXQoc2Vscy5zaXpl\nKCkpOwogICAgICAgICAgICAgICAgICAgIHNlbHMuYWRkKHNlbCk7CiAgICAg\nICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBzZWxzLmFk\nZChzZWwuZnVsbENsb25lKDEpKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gdHVybiBvZmYgdW5pb25pbmcgaWYgYSBnaXZlbiBpbmRlcGVuZGVu\ndCBtYXBwaW5nIHJlcXVpcmVzCiAgICAgICAgICAgIC8vIG11bHRpcGxlIHNl\nbGVjdHMsIG9yIGlmIHdlJ3JlIHVzaW5nIEZST00gc2VsZWN0cwogICAgICAg\nICAgICBpZiAodmVydHMubGVuZ3RoID4gMSB8fCBzZWwuZ2V0RnJvbVNlbGVj\ndCgpICE9IG51bGwpCiAgICAgICAgICAgICAgICB1bmlvbmFibGUgPSBmYWxz\nZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVuaW9uYWJsZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiBhbGwgdGhlIHZlcnRpY2FsIG1hcHBp\nbmdzIHRvIHNlbGVjdCBzZXBhcmF0ZWx5LiBEZXBlbmRzIG9uCiAgICAgKiBz\ndWJjbGFzcyBmZXRjaCBtb2RlIGFuZCB0aGUgdHlwZSBvZiBxdWVyeS4KICAg\nICAqLwogICAgcHJpdmF0ZSBDbGFzc01hcHBpbmdbXSBnZXRWZXJ0aWNhbE1h\ncHBpbmdzKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAgIGJvb2xlYW4g\nc3ViY2xhc3NlcywgUXVlcnlFeHByZXNzaW9ucyBleHBzLCBpbnQgc3ViY2xh\nc3NNb2RlKSB7CiAgICAgICAgaWYgKCFzdWJjbGFzc2VzIHx8IGV4cHMucHJv\namVjdGlvbnMubGVuZ3RoID4gMCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBD\nbGFzc01hcHBpbmdbXSB7IG1hcHBpbmcgfTsKCiAgICAgICAgaWYgKHN1YmNs\nYXNzTW9kZSAhPSBKREJDRmV0Y2hDb25maWd1cmF0aW9uLkVBR0VSX1BBUkFM\nTEVMCiAgICAgICAgICAgIHx8ICFoYXNWZXJ0aWNhbFN1YmNsYXNzZXMobWFw\ncGluZykpCiAgICAgICAgICAgIHJldHVybiBuZXcgQ2xhc3NNYXBwaW5nW10g\neyBtYXBwaW5nIH07CgogICAgICAgIExpc3Qgc3VicyA9IG5ldyBBcnJheUxp\nc3QoNCk7CiAgICAgICAgYWRkU3ViY2xhc3NlcyhtYXBwaW5nLCBzdWJzKTsK\nICAgICAgICByZXR1cm4gKENsYXNzTWFwcGluZ1tdKSBzdWJzLnRvQXJyYXko\nbmV3IENsYXNzTWFwcGluZ1tzdWJzLnNpemUoKV0pOwogICAgfQoKICAgIC8q\nKgogICAgICogUmVjdXJzaXZlIGhlbHBlciB0byBhZGQgbWFwcGluZ3MgZm9y\nIHN1YmNsYXNzZXMgdG8gdGhlIGdpdmVuIGxpc3QuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBhZGRTdWJjbGFzc2VzKENsYXNzTWFwcGluZyBtYXBwaW5n\nLCBDb2xsZWN0aW9uIHN1YnMpIHsKICAgICAgICAvLyBwb3NzaWJsZSBmdXR1\ncmUgb3B0aW1pemF0aW9uczoKICAgICAgICAvLyAtIGlmIG5vIGZpZWxkcyBp\nbiBtZXRhIG9yIGl0cyBzdWJjbGFzc2VzIChhbmQgbm90IGluIGFuCiAgICAg\nICAgLy8gICBhbHJlYWR5LXNlbGVjdGVkIHRhYmxlKSBhcmUgaW4gdGhlIGN1\ncnJlbnQgZmV0Y2gKICAgICAgICAvLyAgIGNvbmZpZ3VyYXRpb24sIHN0b3Ag\nY3JlYXRpbmcgbmV3IGV4ZWN1dG9ycwogICAgICAgIC8vIC0gYWxsb3cgYW4g\nZXhlY3V0b3IgdG8gc2VsZWN0IGEgcmFuZ2Ugb2Ygc3ViY2xhc3NlcywgcmF0\naGVyCiAgICAgICAgLy8gICB0aGFuIGp1c3QgYWxsIHN1YmNsYXNzZXMgLyBu\nbyBzdWJjbGFzc2VzOyB0aGlzIHdvdWxkCiAgICAgICAgLy8gICBhbGxvdyB1\ncyB0byBkbyBqdXN0IG9uZSBxdWVyeSBwZXIgYWN0dWFsIHZlcnRpY2FsbHkt\nbWFwcGVkCiAgICAgICAgLy8gICBzdWJjbGFzcywgcmF0aGVyIHRoYW4gb25l\nIHBlciBtYXBwZWQgc3ViY2xhc3MsIGFzIGlzIGhhcHBlbmluZyBub3cKCiAg\nICAgICAgc3Vicy5hZGQobWFwcGluZyk7CiAgICAgICAgaWYgKCFoYXNWZXJ0\naWNhbFN1YmNsYXNzZXMobWFwcGluZykpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgLy8gcmVjdXJzZSBvbiBpbW1lZGlhdGUgc3ViY2xhc3Nlcwog\nICAgICAgIENsYXNzTWFwcGluZ1tdIHN1Yk1hcHBpbmdzID0gbWFwcGluZy5n\nZXRKb2luYWJsZVBDU3ViY2xhc3NNYXBwaW5ncygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgc3ViTWFwcGluZ3MubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIGlmIChzdWJNYXBwaW5nc1tpXS5nZXRKb2luYWJsZVBDU3VwZXJj\nbGFzc01hcHBpbmcoKSA9PSBtYXBwaW5nKQogICAgICAgICAgICAgICAgYWRk\nU3ViY2xhc3NlcyhzdWJNYXBwaW5nc1tpXSwgc3Vicyk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2ZW4gY2xhc3MgaGFz\nIGFueSB2ZXJ0aWNhbCBzdWJjbGFzc2VzLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBib29sZWFuIGhhc1ZlcnRpY2FsU3ViY2xhc3NlcyhDbGFzc01h\ncHBpbmcgbWFwcGluZykgewogICAgICAgIENsYXNzTWFwcGluZ1tdIHN1YnMg\nPSBtYXBwaW5nLmdldEpvaW5hYmxlUENTdWJjbGFzc01hcHBpbmdzKCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdWJzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBpZiAoc3Vic1tpXS5nZXRTdHJhdGVneSgpIGluc3RhbmNl\nb2YgVmVydGljYWxDbGFzc1N0cmF0ZWd5KQogICAgICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIGVhZ2VyIG1vZGUgZGVwZW5kcyBvbiB0aGUgdW5pcXVl\nIHNldHRpbmcgYW5kIHJhbmdlLiBJZiB0aGUgcmFuZ2UKICAgICAqIHByb2R1\nY2VzIDAgcmVzdWx0cywgdXNlIGVhZ2VyIHNldHRpbmcgb2Ygbm9uZS4gSWYg\naXQgcHJvZHVjZXMgMSByZXN1bHQKICAgICAqIG9yIHRoZSBxdWVyeSBpcyB1\nbmlxdWUsIHVzZSBhbiBlYWdlciBzZXR0aW5nIG9mIHNpbmdsZS4gT3RoZXJ3\naXNlIHVzZQogICAgICogYW4gZWFnZXIgbW9kZSBvZiBtdWx0aXBsZS4KICAg\nICAqLwogICAgcHJpdmF0ZSBpbnQgY2FsY3VsYXRlRWFnZXJNb2RlKFF1ZXJ5\nRXhwcmVzc2lvbnMgZXhwcywgbG9uZyBzdGFydCwKICAgICAgICBsb25nIGVu\nZCkgewogICAgICAgIGlmIChleHBzLnByb2plY3Rpb25zLmxlbmd0aCA+IDAg\nfHwgc3RhcnQgPj0gZW5kKQogICAgICAgICAgICByZXR1cm4gRWFnZXJGZXRj\naE1vZGVzLkVBR0VSX05PTkU7CiAgICAgICAgaWYgKGVuZCAtIHN0YXJ0ID09\nIDEgfHwgY3R4LmlzVW5pcXVlKCkpCiAgICAgICAgICAgIHJldHVybiBFYWdl\nckZldGNoTW9kZXMuRUFHRVJfSk9JTjsKICAgICAgICByZXR1cm4gRWFnZXJG\nZXRjaE1vZGVzLkVBR0VSX1BBUkFMTEVMOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBOdW1iZXIgZXhlY3V0ZURlbGV0ZShFeGVjdXRvciBleCwgQ2xhc3NNZXRh\nRGF0YSBiYXNlLAogICAgICAgIENsYXNzTWV0YURhdGFbXSBtZXRhcywgYm9v\nbGVhbiBzdWJjbGFzc2VzLCBFeHByZXNzaW9uRmFjdG9yeVtdIGZhY3RzLAog\nICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNbXSBleHBzLCBPYmplY3RbXSBwYXJh\nbXMpIHsKICAgICAgICByZXR1cm4gZXhlY3V0ZUJ1bGtPcGVyYXRpb24oZXgs\nIGJhc2UsIG1ldGFzLCBzdWJjbGFzc2VzLCBmYWN0cywgZXhwcywKICAgICAg\nICAgICAgcGFyYW1zLCBudWxsKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgTnVt\nYmVyIGV4ZWN1dGVVcGRhdGUoRXhlY3V0b3IgZXgsIENsYXNzTWV0YURhdGEg\nYmFzZSwKICAgICAgICBDbGFzc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4g\nc3ViY2xhc3NlcywgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAg\nICBRdWVyeUV4cHJlc3Npb25zW10gZXhwcywgT2JqZWN0W10gcGFyYW1zKSB7\nCiAgICAgICAgcmV0dXJuIGV4ZWN1dGVCdWxrT3BlcmF0aW9uKGV4LCBiYXNl\nLCBtZXRhcywgc3ViY2xhc3NlcywgZmFjdHMsIGV4cHMsCiAgICAgICAgICAg\nIHBhcmFtcywgZXhwc1swXS51cGRhdGVzKTsKICAgIH0KCiAgICBwcml2YXRl\nIE51bWJlciBleGVjdXRlQnVsa09wZXJhdGlvbihFeGVjdXRvciBleCwgQ2xh\nc3NNZXRhRGF0YSBiYXNlLAogICAgICAgIENsYXNzTWV0YURhdGFbXSBtZXRh\ncywgYm9vbGVhbiBzdWJjbGFzc2VzLCBFeHByZXNzaW9uRmFjdG9yeVtdIGZh\nY3RzLAogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNbXSBleHBzLCBPYmplY3Rb\nXSBwYXJhbXMsIE1hcCB1cGRhdGVzKSB7CiAgICAgICAgLy8gd2UgY2Fubm90\nIGV4ZWN1dGUgYSBidWxrIGRlbGV0ZSBzdGF0ZW1lbnQgd2hlbiBoYXZlIG1h\ncHBpbmdzIGluCiAgICAgICAgLy8gbXVsdGlwbGUgdGFibGVzLCBzbyBpbmRp\nY2F0ZSB3ZSB3YW50IHRvIHVzZSBpbi1tZW1vcnkgd2l0aCBudWxsCiAgICAg\nICAgQ2xhc3NNYXBwaW5nW10gbWFwcGluZ3MgPSAoQ2xhc3NNYXBwaW5nW10p\nIG1ldGFzOwogICAgICAgIGJvb2xlYW4gaXNVcGRhdGUgPSB1cGRhdGVzICE9\nIG51bGwgJiYgdXBkYXRlcy5zaXplKCkgPiAwOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgaWYgKCFpc1NpbmdsZVRhYmxlTWFwcGluZyhtYXBwaW5nc1tpXSwgc3Vi\nY2xhc3NlcykgJiYgIWlzVXBkYXRlKQogICAgICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgICAgICBpZiAoIWlzVXBkYXRlKSB7CiAgICAgICAg\nICAgICAgICAvLyBpZiB0aGVyZSBhcmUgYW55IGRlbGV0ZSBjYWxsYmFja3Ms\nIHdlIG5lZWQgdG8KICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGUgaW4tbWVt\nb3J5IHNvIHRoZSBjYWxsYmFja3MgYXJlIGludm9rZWQKICAgICAgICAgICAg\nICAgIExpZmVjeWNsZUV2ZW50TWFuYWdlciBtZ3IgPSBjdHguZ2V0U3RvcmVD\nb250ZXh0KCkuZ2V0QnJva2VyKCkKICAgICAgICAgICAgICAgICAgICAuZ2V0\nTGlmZWN5Y2xlRXZlbnRNYW5hZ2VyKCk7CiAgICAgICAgICAgICAgICBpZiAo\nbWdyLmhhc0RlbGV0ZUxpc3RlbmVycyhudWxsLCBtYXBwaW5nc1tpXSkpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0\nY2ggPSAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikgCiAgICAgICAgICAgIGN0\neC5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBFeHBDb250ZXh0\nIGN0eCA9IG5ldyBFeHBDb250ZXh0KF9zdG9yZSwgcGFyYW1zLCBmZXRjaCk7\nCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfc3RvcmUuZ2V0REJEaWN0\naW9uYXJ5KCk7CiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1N0YXRlW10gc3Rh\ndGUgPSBuZXcgUXVlcnlFeHByZXNzaW9uc1N0YXRlW2V4cHMubGVuZ3RoXTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN0YXRlLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICBzdGF0ZVtpXSA9IG5ldyBRdWVyeUV4cHJlc3Npb25z\nU3RhdGUoKTsKCiAgICAgICAgU1FMQnVmZmVyW10gc3FsID0gbmV3IFNRTEJ1\nZmZlclttYXBwaW5ncy5sZW5ndGhdOwogICAgICAgIEpEQkNFeHByZXNzaW9u\nRmFjdG9yeSBqZGJjRmFjdG9yeTsKICAgICAgICBTZWxlY3Qgc2VsOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgamRiY0ZhY3RvcnkgPSAoSkRCQ0V4cHJlc3Npb25G\nYWN0b3J5KSBmYWN0c1tpXTsKICAgICAgICAgICAgc2VsID0gamRiY0ZhY3Rv\ncnkuZ2V0U2VsZWN0Q29uc3RydWN0b3IoKS5ldmFsdWF0ZShjdHgsIG51bGws\nIG51bGwsCiAgICAgICAgICAgICAgICBleHBzW2ldLCBzdGF0ZVtpXSk7CiAg\nICAgICAgICAgIGpkYmNGYWN0b3J5LmdldFNlbGVjdENvbnN0cnVjdG9yKCku\nc2VsZWN0KHNlbCwgY3R4LCBtYXBwaW5nc1tpXSwgCiAgICAgICAgICAgICAg\nICBzdWJjbGFzc2VzLCBleHBzW2ldLCBzdGF0ZVtpXSwgCiAgICAgICAgICAg\nICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uLkVBR0VSX05PTkUpOwoKICAg\nICAgICAgICAgLy8gc3BlY2lmaWNhdGlvbiBvZiB0aGUgInVkcGF0ZXMiIG1h\ncCBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzCiAgICAgICAgICAgIC8vIGFuIHVw\nZGF0ZSBxdWVyeTsgb3RoZXJ3aXNlLCB0aGlzIGlzIGEgZGVsZXRlIHN0YXRl\nbWVudAogICAgICAgICAgICAvLyBUaGUgYnVsayBvcGVyYXRpb24gd2lsbCBy\nZXR1cm4gbnVsbCB0byBpbmRpY2F0ZSB0aGF0IHRoZSBkYXRhYmFzZQogICAg\nICAgICAgICAvLyBkb2VzIG5vdCBzdXBwb3J0IHRoZSByZXF1ZXN0IGJ1bGsg\nZGVsZXRlIG9wZXJhdGlvbjsgaW4KICAgICAgICAgICAgLy8gdGhpcyBjYXNl\nLCB3ZSBuZWVkIHRvIHBlcmZvcm0gdGhlIHF1ZXJ5IGluLW1lbW9yeSBhbmQK\nICAgICAgICAgICAgLy8gbWFudWFsbHkgZGVsZXRlIHRoZSBpbnN0YW5jZXMK\nICAgICAgICAgICAgaWYgKHVwZGF0ZXMgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgIHNxbFtpXSA9IGRpY3QudG9EZWxldGUobWFwcGluZ3NbaV0sIHNlbCwg\ncGFyYW1zKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgc3Fs\nW2ldID0gZGljdC50b1VwZGF0ZShtYXBwaW5nc1tpXSwgc2VsLCBfc3RvcmUs\nIHBhcmFtcywKICAgICAgICAgICAgICAgICAgICB1cGRhdGVzKTsKCiAgICAg\nICAgICAgIGlmIChzcWxbaV0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgLy8gd2UgbmVlZCB0byBt\nYWtlIHN1cmUgd2UgaGF2ZSBhbiBhY3RpdmUgc3RvcmUgY29ubmVjdGlvbgog\nICAgICAgIF9zdG9yZS5nZXRDb250ZXh0KCkuYmVnaW5TdG9yZSgpOwoKICAg\nICAgICBDb25uZWN0aW9uIGNvbm4gPSBfc3RvcmUuZ2V0Q29ubmVjdGlvbigp\nOwogICAgICAgIGxvbmcgY291bnQgPSAwOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50OwogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IHNxbC5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICAgICAgc3RtbnQgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICBzdG1udCA9IHNxbFtpXS5wcmVwYXJlU3Rh\ndGVtZW50KGNvbm4pOwogICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IHN0\nbW50LmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgICAgIHRyeSB7IHN0bW50LmNsb3NlKCk7IH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICB0aHJvdyBTUUxFeGNlcHRpb25zLmdldFN0b3Jl\nKHNlLCBjdHgsIF9zdG9yZS5nZXREQkRpY3Rpb25hcnkoKSk7CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgdHJ5IHsgY29ubi5jbG9zZSgpOyB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBOdW1iZXJzLnZhbHVlT2YoY291bnQpOwogICAgfQoKICAgIC8q\nKgogICAgICogV2hldGhlciB0aGUgZ2l2ZW4gbWFwcGluZyBvY2N1cGllcyBv\nbmx5IG9uZSB0YWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGlz\nU2luZ2xlVGFibGVNYXBwaW5nKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAg\nICAgIGJvb2xlYW4gc3ViY2xhc3NlcykgewogICAgICAgIENsYXNzTWFwcGlu\nZyByb290ID0gbWFwcGluZzsKICAgICAgICB3aGlsZSAocm9vdC5nZXRKb2lu\nYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBudWxsKQogICAgICAgICAg\nICByb290ID0gcm9vdC5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmco\nKTsKICAgICAgICBpZiAoaGFzVmVydGljYWxTdWJjbGFzc2VzKHJvb3QpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIHdlIGNhbm5v\ndCBleGVjdXRlIGEgYnVsayBkZWxldGUgaWYgYW55IG9mIHRoZQogICAgICAg\nIC8vIGZpZWxkIG1hcHBpbmdzIGZvciB0aGUgY2FuZGlkYXRlcyBoYXZlIGNv\nbHVtbnMKICAgICAgICAvLyBpbiBhbnkgb3RoZXIgdGFibGUsIHNpbmNlIGJ1\nbGsgZGVsZXRpbmcganVzdCBmcm9tIHRoZQogICAgICAgIC8vIGNsYXNzIHdp\nbGwgbGVhdmUgZGFuZ2xpbmcgcmVsYXRpb25zOyB3ZSBtaWdodCBiZSBhYmxl\nCiAgICAgICAgLy8gdG8gaXNzdWUgYnVsayBkZWxldGVzIHNlcGFyYXRlbHkg\nZm9yIHRoZSBqb2lucyAocG9zc2libHkKICAgICAgICAvLyB1c2luZyBhIHRl\nbXBvcmFyeSB0YWJsZSB0byBzZWxlY3QgdGhlIHByaW1hcnkga2V5cyBmb3IK\nICAgICAgICAvLyBhbGwgdGhlIHJlbGF0ZWQgdGFibGVzIGFuZCB0aGVuIGlz\nc2luZyBhIGRlbGV0ZSBhZ2FpbnN0IHRob3NlCiAgICAgICAgLy8ga2V5cyks\nIGJ1dCB0aGF0IGxvZ2ljIGlzIG5vdCBjdXJyZW50bHkgaW1wbGVtZW50ZWQK\nICAgICAgICBUYWJsZSB0YWJsZSA9IGdldFRhYmxlKG1hcHBpbmcuZ2V0Rmll\nbGRNYXBwaW5ncygpLCBudWxsKTsKICAgICAgICBpZiAodGFibGUgPT0gSU5W\nQUxJRCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAo\nc3ViY2xhc3NlcykgewogICAgICAgICAgICAvLyBpZiB3ZSBhcmUgaW5jbHVk\naW5nIHN1YmNsYXNzZXMsIHdlIGFsc28gbmVlZCB0byBnYXRoZXIKICAgICAg\nICAgICAgLy8gYWxsIHRoZSBtYXBwaW5ncyBmb3IgYWxsIGtub3duIHN1YmNs\nYXNzZXMKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nW10gc3VicyA9IG1hcHBp\nbmcuZ2V0Sm9pbmFibGVQQ1N1YmNsYXNzTWFwcGluZ3MoKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IHN1YnMgIT0gbnVsbCAmJiBpIDwgc3Vicy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdGFibGUgPSBnZXRUYWJs\nZShzdWJzW2ldLmdldERlZmluZWRGaWVsZE1hcHBpbmdzKCksIHRhYmxlKTsK\nICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PSBJTlZBTElEKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgc2luZ2xlIHRhYmxlIGZvciB0aGUgZ2l2ZW4gZmll\nbGRzLCBvciBJTlZBTElEIGlmIHRoZXkKICAgICAqIHVzZSBtdWx0aXBsZSB0\nYWJsZXMuCiAgICAgKi8KICAgIHByaXZhdGUgVGFibGUgZ2V0VGFibGUoRmll\nbGRNYXBwaW5nW10gZmllbGRzLCBUYWJsZSB0YWJsZSkgewogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIHRhYmxlID0gZ2V0VGFibGUoZmllbGRzW2ldLCB0YWJsZSk7CiAg\nICAgICAgICAgIGlmICh0YWJsZSA9PSBJTlZBTElEKQogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0YWJsZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdGFibGUgZm9yIHRoZSBm\naWVsZCBpZiB0aGUgZ2l2ZW4gdGFibGUgaGFzbid0IGJlZW4gc2V0CiAgICAg\nKiB5ZXQsIG9yIGlmIHRoZSB0YWJsZXMgbWF0Y2guIElmIHRoZSBmaWVsZCB1\nc2VzIGEgZGlmZmVyZW50IHRhYmxlLAogICAgICogcmV0dXJucyBJTlZBTElE\nLiBBbHNvIHJldHVybnMgSU5WQUxJRCBpZiBmaWVsZCBpcyBkZXBlbmRlbnQu\nCiAgICAgKi8KICAgIHByaXZhdGUgVGFibGUgZ2V0VGFibGUoRmllbGRNYXBw\naW5nIGZtLCBUYWJsZSB0YWJsZSkgewogICAgICAgIGlmIChmbS5nZXRDYXNj\nYWRlRGVsZXRlKCkgIT0gVmFsdWVNZXRhRGF0YS5DQVNDQURFX05PTkUpCiAg\nICAgICAgICAgIHJldHVybiBJTlZBTElEOwoKICAgICAgICBDb2x1bW5bXSBj\nb2x1bW5zID0gZm0uZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBjb2x1bW5zICE9IG51bGwgJiYgaSA8IGNvbHVtbnMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKHRhYmxlID09IG51bGwpCiAgICAgICAg\nICAgICAgICB0YWJsZSA9IGNvbHVtbnNbaV0uZ2V0VGFibGUoKTsKICAgICAg\nICAgICAgZWxzZSBpZiAodGFibGUgIT0gY29sdW1uc1tpXS5nZXRUYWJsZSgp\nKQogICAgICAgICAgICAgICAgcmV0dXJuIElOVkFMSUQ7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiB0YWJsZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgTnVt\nYmVyIGV4ZWN1dGVVcGRhdGUoQ2xhc3NNZXRhRGF0YSBiYXNlLCBDbGFzc01l\ndGFEYXRhW10gbWV0YXMsCiAgICAgICAgYm9vbGVhbiBzdWJjbGFzc2VzLCBF\neHByZXNzaW9uRmFjdG9yeVtdIGZhY3RzLAogICAgICAgIFF1ZXJ5RXhwcmVz\nc2lvbnNbXSBwYXJzZWQsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmdbXSBnZXRE\nYXRhU3RvcmVBY3Rpb25zKENsYXNzTWV0YURhdGEgYmFzZSwKICAgICAgICBD\nbGFzc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xhc3NlcywgRXhw\ncmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4cHJlc3Np\nb25zW10gZXhwcywgT2JqZWN0W10gcGFyYW1zLCBSYW5nZSByYW5nZSkgewog\nICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzID0gKENsYXNzTWFwcGlu\nZ1tdKSBtZXRhczsKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoID0gKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24pIGN0eC4KICAgICAgICAg\nICAgZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKGV4cHNb\nMF0uZmV0Y2hQYXRocyAhPSBudWxsKSB7CiAgICAgICAgICAgIGZldGNoLmFk\nZEZpZWxkcyhBcnJheXMuYXNMaXN0KGV4cHNbMF0uZmV0Y2hQYXRocykpOwog\nICAgICAgICAgICBmZXRjaC5hZGRKb2lucyhBcnJheXMuYXNMaXN0KGV4cHNb\nMF0uZmV0Y2hQYXRocykpOwogICAgICAgIH0KCiAgICAgICAgaW50IGVhZ2Vy\nID0gY2FsY3VsYXRlRWFnZXJNb2RlKGV4cHNbMF0sIHJhbmdlLnN0YXJ0LCBy\nYW5nZS5lbmQpOwogICAgICAgIGVhZ2VyID0gTWF0aC5taW4oZWFnZXIsIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24uRUFHRVJfSk9JTik7CiAgICAgICAgaW50\nIHN1YmNsYXNzTW9kZSA9IGZldGNoLmdldFN1YmNsYXNzRmV0Y2hNb2RlKChD\nbGFzc01hcHBpbmcpIGJhc2UpOwogICAgICAgIERCRGljdGlvbmFyeSBkaWN0\nID0gX3N0b3JlLmdldERCRGljdGlvbmFyeSgpOwogICAgICAgIGxvbmcgc3Rh\ncnQgPSAobWFwcGluZ3MubGVuZ3RoID09IDEgJiYgZGljdC5zdXBwb3J0c1Nl\nbGVjdFN0YXJ0SW5kZXgpIAogICAgICAgICAgICA/IHJhbmdlLnN0YXJ0IDog\nMEw7CiAgICAgICAgbG9uZyBlbmQgPSAoZGljdC5zdXBwb3J0c1NlbGVjdEVu\nZEluZGV4KSA/IHJhbmdlLmVuZCA6IExvbmcuTUFYX1ZBTFVFOwoKICAgICAg\nICBRdWVyeUV4cHJlc3Npb25zU3RhdGVbXSBzdGF0ZXMgPSBuZXcgUXVlcnlF\neHByZXNzaW9uc1N0YXRlW2V4cHMubGVuZ3RoXTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHN0YXRlcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nc3RhdGVzW2ldID0gbmV3IFF1ZXJ5RXhwcmVzc2lvbnNTdGF0ZSgpOwogICAg\nICAgIEV4cENvbnRleHQgY3R4ID0gbmV3IEV4cENvbnRleHQoX3N0b3JlLCBw\nYXJhbXMsIGZldGNoKTsKCiAgICAgICAgLy8gYWRkIHNlbGVjdHMgd2l0aCBw\nb3B1bGF0ZSBXSEVSRSBjb25kaXRpb25zIHRvIGxpc3QKICAgICAgICBMaXN0\nIHNlbHMgPSBuZXcgQXJyYXlMaXN0KG1hcHBpbmdzLmxlbmd0aCk7CiAgICAg\nICAgTGlzdCBzZWxNYXBwaW5ncyA9IG5ldyBBcnJheUxpc3QobWFwcGluZ3Mu\nbGVuZ3RoKTsKICAgICAgICBCaXRTZXQgc3ViY2xhc3NCaXRzID0gbmV3IEJp\ndFNldCgpOwogICAgICAgIEJpdFNldCBuZXh0Qml0cyA9IG5ldyBCaXRTZXQo\nKTsKICAgICAgICBib29sZWFuIHVuaW9uYWJsZSA9IGNyZWF0ZVdoZXJlU2Vs\nZWN0cyhzZWxzLCBtYXBwaW5ncywgc2VsTWFwcGluZ3MsCiAgICAgICAgICAg\nIHN1YmNsYXNzZXMsIHN1YmNsYXNzQml0cywgbmV4dEJpdHMsIGZhY3RzLCBl\neHBzLCBzdGF0ZXMsIGN0eCwgCiAgICAgICAgICAgIHN1YmNsYXNzTW9kZSkg\nJiYgc3ViY2xhc3NNb2RlID09IEpEQkNGZXRjaENvbmZpZ3VyYXRpb24uRUFH\nRVJfSk9JTjsKICAgICAgICBpZiAoc2Vscy5zaXplKCkgPiAxKQogICAgICAg\nICAgICBzdGFydCA9IDBMOwoKICAgICAgICBpZiAodW5pb25hYmxlKSB7CiAg\nICAgICAgICAgIFVuaW9uIHVuaW9uID0gX3N0b3JlLmdldFNRTEZhY3Rvcnko\nKS5uZXdVbmlvbigKICAgICAgICAgICAgICAgIChTZWxlY3RbXSkgc2Vscy50\nb0FycmF5KG5ldyBTZWxlY3Rbc2Vscy5zaXplKCldKSk7CiAgICAgICAgICAg\nIHBvcHVsYXRlVW5pb24odW5pb24sIG1hcHBpbmdzLCBzdWJjbGFzc2VzLCBm\nYWN0cywgZXhwcywgc3RhdGVzLCBjdHgsCiAgICAgICAgICAgICAgICBmYWxz\nZSwgZWFnZXIsIHN0YXJ0LCBlbmQpOwogICAgICAgICAgICBpZiAodW5pb24u\naXNVbmlvbigpKQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdb\nXSB7dW5pb24udG9TZWxlY3QoZmFsc2UsIGZldGNoKS5nZXRTUUwodHJ1ZSl9\nOwogICAgICAgICAgICBzZWxzID0gQXJyYXlzLmFzTGlzdCh1bmlvbi5nZXRT\nZWxlY3RzKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFNlbGVj\ndCBzZWw7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwLCBpZHggPSAwOyBp\nIDwgc2Vscy5zaXplKCk7IGkrKykgewogICAgICAgICAgICAgICAgc2VsID0g\nKFNlbGVjdCkgc2Vscy5nZXQoaSk7CiAgICAgICAgICAgICAgICBwb3B1bGF0\nZVNlbGVjdChzZWwsIChDbGFzc01hcHBpbmcpIHNlbE1hcHBpbmdzLmdldChp\nKSwKICAgICAgICAgICAgICAgICAgICBzdWJjbGFzc0JpdHMuZ2V0KGkpLCAo\nSkRCQ0V4cHJlc3Npb25GYWN0b3J5KSBmYWN0c1tpZHhdLAogICAgICAgICAg\nICAgICAgICAgIGV4cHNbaWR4XSwgc3RhdGVzW2lkeF0sIGN0eCwgZmFsc2Us\nIGVhZ2VyLCBzdGFydCwgZW5kKTsKICAgICAgICAgICAgICAgIGlmIChuZXh0\nQml0cy5nZXQoaSkpCiAgICAgICAgICAgICAgICAgICAgaWR4Kys7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIFN0cmluZ1tdIHNxbCA9IG5l\ndyBTdHJpbmdbc2Vscy5zaXplKCldOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgc2Vscy5zaXplKCk7IGkrKykKICAgICAgICAgICAgc3FsW2ldID0g\nKChTZWxlY3QpIHNlbHMuZ2V0KGkpKS50b1NlbGVjdChmYWxzZSwgZmV0Y2gp\nLmdldFNRTCh0cnVlKTsKICAgICAgICByZXR1cm4gc3FsOwogICAgfQp9Cg==\n","encoding":"base64"}

