{"sha":"c2d5805f42fb06bde01fd6118bbe916fa082a43b","node_id":"MDQ6QmxvYjIwNjM2NDpjMmQ1ODA1ZjQyZmIwNmJkZTAxZmQ2MTE4YmJlOTE2ZmEwODJhNDNi","size":12091,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c2d5805f42fb06bde01fd6118bbe916fa082a43b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyZWFt\nVG9rZW5pemVyOwppbXBvcnQgamF2YS5pby5TdHJpbmdSZWFkZXI7CmltcG9y\ndCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFy\nZWRTdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGph\ndmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdS\nZXBvc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5RdWVyeVJlc3VsdE1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJlc3VsdFNldFJlc3VsdDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9uczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RTdG9yZVF1ZXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUNvbnRl\neHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlUXVl\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5SYW5nZVJl\nc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5yb3AuUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247CmltcG9ydCBzZXJw\nLnV0aWwuTnVtYmVyczsKCi8qKgogKiBBIFNRTCBxdWVyeS4KICoKICogQGF1\ndGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNz\nIFNRTFN0b3JlUXVlcnkKICAgIGV4dGVuZHMgQWJzdHJhY3RTdG9yZVF1ZXJ5\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFNRTFN0b3JlUXVlcnku\nY2xhc3MpOwoKICAgIHByaXZhdGUgdHJhbnNpZW50IGZpbmFsIEpEQkNTdG9y\nZSBfc3RvcmU7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgYSBxdWVyeSBt\nYW5hZ2VkIGJ5IHRoZSBnaXZlbiBjb250ZXh0LgogICAgICovCiAgICBwdWJs\naWMgU1FMU3RvcmVRdWVyeShKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBf\nc3RvcmUgPSBzdG9yZTsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ1N0b3JlIGdl\ndFN0b3JlKCkgewogICAgICAgIHJldHVybiBfc3RvcmU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBVdGlsaXR5IG1ldGhvZCB0byBzdWJzdGl0dXRlICc/bnVt\nJyBmb3IgcGFyYW1ldGVycyBpbiB0aGUgZ2l2ZW4gU1FMCiAgICAgKiBzdGF0\nZW1lbnQsIGFuZCByZS1vcmRlciB0aGUgPGNvZGU+cGFyYW1zPC9jb2RlPiBh\ncnJheSB0byBtYXRjaAogICAgICogdGhlIG9yZGVyIG9mIHRoZSBzcGVjaWZp\nZWQgcGFyYW1ldGVycy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgU3Ry\naW5nIHN1YnN0aXR1dGVQYXJhbXMoU3RyaW5nIHNxbCwgTGlzdCBwYXJhbXMp\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBpZiB0\naGVyZSdzIG5vICI/MSIgcG9zaXRpb25hbCBwYXJhbWV0ZXIsIHRoZW4gd2Ug\nZG9uJ3QgbmVlZCB0bwogICAgICAgIC8vIHBlcmZvcm0gdGhlIHBhcnNpbmcg\ncHJvY2VzcwogICAgICAgIGlmIChzcWwuaW5kZXhPZigiPzEiKSA9PSAtMSkK\nICAgICAgICAgICAgcmV0dXJuIHNxbDsKCiAgICAgICAgTGlzdCBwYXJhbU9y\nZGVyID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIFN0cmVhbVRva2VuaXpl\nciB0b2sgPSBuZXcgU3RyZWFtVG9rZW5pemVyKG5ldyBTdHJpbmdSZWFkZXIo\nc3FsKSk7CiAgICAgICAgdG9rLnJlc2V0U3ludGF4KCk7CiAgICAgICAgdG9r\nLnF1b3RlQ2hhcignXCcnKTsKICAgICAgICB0b2sud29yZENoYXJzKCcwJywg\nJzknKTsKICAgICAgICB0b2sud29yZENoYXJzKCc/JywgJz8nKTsKCiAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoc3FsLmxl\nbmd0aCgpKTsKICAgICAgICBmb3IgKGludCB0dHlwZTsgKHR0eXBlID0gdG9r\nLm5leHRUb2tlbigpKSAhPSBTdHJlYW1Ub2tlbml6ZXIuVFRfRU9GOykgewog\nICAgICAgICAgICBzd2l0Y2ggKHR0eXBlKSB7CiAgICAgICAgICAgICAgICBj\nYXNlIFN0cmVhbVRva2VuaXplci5UVF9XT1JEOgogICAgICAgICAgICAgICAg\nICAgIC8vIGEgdG9rZW4gaXMgYSBwb3NpdGlvbmFsIHBhcmFtZXRlciBpZiBp\ndCBzdGFydHMgd2l0aAogICAgICAgICAgICAgICAgICAgIC8vIGEgIj8iIGFu\nZCB0aGUgcmVzdCBvZiB0aGUgdG9rZW4gYXJlIGFsbCBudW1iZXJzCiAgICAg\nICAgICAgICAgICAgICAgaWYgKHRvay5zdmFsLnN0YXJ0c1dpdGgoIj8iKSAm\nJiB0b2suc3ZhbC5sZW5ndGgoKSA+IDEgJiYKICAgICAgICAgICAgICAgICAg\nICAgICAgdG9rLnN2YWwuc3Vic3RyaW5nKDEpLmluZGV4T2YoIj8iKSA9PSAt\nMSkgewogICAgICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCI/Iik7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtT3JkZXIuYWRkKEludGVn\nZXIudmFsdWVPZih0b2suc3ZhbC5zdWJzdHJpbmcoMSkpKTsKICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCh0b2suc3ZhbCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlJ1wnJzoKICAgICAgICAgICAgICAgICAg\nICBidWYuYXBwZW5kKCdcJycpOwogICAgICAgICAgICAgICAgICAgIGlmICh0\nb2suc3ZhbCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQodG9rLnN2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICBi\ndWYuYXBwZW5kKCdcJycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgoY2hhcikgdHR5cGUp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBub3cgZ28g\ndGhyb3VnaCB0aGUgcGFyYW1PcmRlciBsaXN0IGFuZCByZS1vcmRlciB0aGUg\ncGFyYW1zIGFycmF5CiAgICAgICAgTGlzdCB0cmFuc2xhdGVkID0gbmV3IEFy\ncmF5TGlzdCgpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaSA9IHBhcmFtT3Jk\nZXIuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGlu\ndCBpbmRleCA9ICgoTnVtYmVyKSBpLm5leHQoKSkuaW50VmFsdWUoKSAtIDE7\nCiAgICAgICAgICAgIGlmIChpbmRleCA+PSBwYXJhbXMuc2l6ZSgpKQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nInNxbHF1ZXJ5LW1pc3NpbmctcGFyYW1zIiwKICAgICAgICAgICAgICAgICAg\nICBzcWwsIFN0cmluZy52YWx1ZU9mKGluZGV4KSwgcGFyYW1zKSk7CiAgICAg\nICAgICAgIHRyYW5zbGF0ZWQuYWRkKHBhcmFtcy5nZXQoaW5kZXgpKTsKICAg\nICAgICB9CgogICAgICAgIC8vIHRyYW5zZmVyIHRoZSB0cmFuc2xhdGVkIGxp\nc3QgaW50byB0aGUgb3JpZ2luYWwgcGFyYW1zIGxpc3QKICAgICAgICBwYXJh\nbXMuY2xlYXIoKTsKICAgICAgICBwYXJhbXMuYWRkQWxsKHRyYW5zbGF0ZWQp\nOwogICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c1BhcmFtZXRlckRlY2xhcmF0aW9ucygp\nIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gc3VwcG9ydHNEYXRhU3RvcmVFeGVjdXRpb24oKSB7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIEV4ZWN1dG9yIG5ld0Rh\ndGFTdG9yZUV4ZWN1dG9yKENsYXNzTWV0YURhdGEgbWV0YSwKICAgICAgICBi\nb29sZWFuIHN1YmNsYXNzZXMpIHsKICAgICAgICByZXR1cm4gbmV3IFNRTEV4\nZWN1dG9yKHRoaXMsIG1ldGEpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHJlcXVpcmVzQ2FuZGlkYXRlVHlwZSgpIHsKICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVxdWlyZXNQYXJhbWV0\nZXJEZWNsYXJhdGlvbnMoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIC8qKgogICAgICogRXhlY3V0ZXMgdGhlIGZpbHRlciBhcyBhIFNR\nTCBxdWVyeS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU1FM\nRXhlY3V0b3IKICAgICAgICBleHRlbmRzIEFic3RyYWN0RXhlY3V0b3IgewoK\nICAgICAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0YURhdGEgX21ldGE7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9zZWxlY3Q7CiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBib29sZWFuIF9jYWxsOyAgIC8vIG5hdGl2ZSBjYWxs\nIHN0b3JlZCBwcm9jZWR1cmUKICAgICAgICBwcml2YXRlIGZpbmFsIFF1ZXJ5\nUmVzdWx0TWFwcGluZyBfcmVzdWx0TWFwcGluZzsKCiAgICAgICAgcHVibGlj\nIFNRTEV4ZWN1dG9yKFNRTFN0b3JlUXVlcnkgcSwgQ2xhc3NNZXRhRGF0YSBj\nYW5kaWRhdGUpIHsKICAgICAgICAgICAgUXVlcnlDb250ZXh0IGN0eCA9IHEu\nZ2V0Q29udGV4dCgpOwogICAgICAgICAgICBTdHJpbmcgcmVzdWx0TWFwcGlu\nZyA9IGN0eC5nZXRSZXN1bHRNYXBwaW5nTmFtZSgpOwogICAgICAgICAgICBp\nZiAocmVzdWx0TWFwcGluZyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3Jl\nc3VsdE1hcHBpbmcgPSBudWxsOwogICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgIENsYXNzTG9hZGVyIGVudkxvYWRlciA9IGN0eC5nZXRTdG9y\nZUNvbnRleHQoKS5nZXRDbGFzc0xvYWRlcigpOwogICAgICAgICAgICAgICAg\nTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBxLmdldFN0b3JlKCkuZ2V0Q29u\nZmlndXJhdGlvbigpLgogICAgICAgICAgICAgICAgICAgIGdldE1hcHBpbmdS\nZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIF9yZXN1bHRN\nYXBwaW5nID0gcmVwb3MuZ2V0UXVlcnlSZXN1bHRNYXBwaW5nCiAgICAgICAg\nICAgICAgICAgICAgKGN0eC5nZXRSZXN1bHRNYXBwaW5nU2NvcGUoKSwgcmVz\ndWx0TWFwcGluZywgZW52TG9hZGVyLAogICAgICAgICAgICAgICAgICAgICAg\nICB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfbWV0YSA9IGNh\nbmRpZGF0ZTsKCiAgICAgICAgICAgIFN0cmluZyBzcWwgPSBTdHJpbmdVdGls\ncy50cmltVG9OdWxsKGN0eC5nZXRRdWVyeVN0cmluZygpKTsKICAgICAgICAg\nICAgaWYgKHNxbCA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm5vLXNxbCIpKTsKICAgICAgICAg\nICAgX3NlbGVjdCA9IHNxbC5sZW5ndGgoKSA+IDYKICAgICAgICAgICAgICAg\nICYmIHNxbC5zdWJzdHJpbmcoMCwgNikuZXF1YWxzSWdub3JlQ2FzZSgic2Vs\nZWN0Iik7CiAgICAgICAgICAgIF9jYWxsID0gc3FsLmxlbmd0aCgpID4gNAog\nICAgICAgICAgICAgICAgJiYgc3FsLnN1YnN0cmluZygwLCA0KS5lcXVhbHNJ\nZ25vcmVDYXNlKCJjYWxsIik7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\naW50IGdldE9wZXJhdGlvbihTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICBy\nZXR1cm4gX3NlbGVjdCA/IE9QX1NFTEVDVCA6IAogICAgICAgICAgICAgICAg\nKHEuZ2V0Q29udGV4dCgpLmdldENhbmRpZGF0ZVR5cGUoKSAhPSBudWxsCiAg\nICAgICAgICAgICAgICAgICAgICAgIHx8IHEuZ2V0Q29udGV4dCgpLmdldFJl\nc3VsdFR5cGUoKSAhPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgIHx8\nIHEuZ2V0Q29udGV4dCgpLmdldFJlc3VsdE1hcHBpbmdOYW1lKCkgIT0gbnVs\nbCAKICAgICAgICAgICAgICAgICAgICAgICAgfHwgcS5nZXRDb250ZXh0KCku\nZ2V0UmVzdWx0TWFwcGluZ1Njb3BlKCkgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICAgICAgPyBPUF9TRUxFQ1QgOiBPUF9VUERBVEU7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgTnVtYmVyIGV4ZWN1dGVVcGRhdGUoU3RvcmVR\ndWVyeSBxLCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICAgICAgSkRCQ1N0\nb3JlIHN0b3JlID0gKChTUUxTdG9yZVF1ZXJ5KSBxKS5nZXRTdG9yZSgpOwog\nICAgICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IHN0b3JlLmdldERCRGlj\ndGlvbmFyeSgpOwogICAgICAgICAgICBTdHJpbmcgc3FsID0gcS5nZXRDb250\nZXh0KCkuZ2V0UXVlcnlTdHJpbmcoKTsKCiAgICAgICAgICAgIExpc3QgcGFy\nYW1MaXN0OwogICAgICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDApIHsK\nICAgICAgICAgICAgICAgIHBhcmFtTGlzdCA9IG5ldyBBcnJheUxpc3QoQXJy\nYXlzLmFzTGlzdChwYXJhbXMpKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgc3FsID0gc3Vic3RpdHV0ZVBhcmFtcyhzcWws\nIHBhcmFtTGlzdCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2Vw\ndGlvbiBpb2UpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihpb2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9IGVsc2UKICAgICAgICAgICAgICAgIHBhcmFtTGlzdCA9IENvbGxlY3Rp\nb25zLkVNUFRZX0xJU1Q7CgogICAgICAgICAgICBTUUxCdWZmZXIgYnVmID0g\nbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoc3FsKTsKICAgICAgICAgICAg\nQ29ubmVjdGlvbiBjb25uID0gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAg\nICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoID0gKEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24pCiAgICAgICAgICAgICAgICBxLmdldENvbnRl\neHQoKS5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKCiAgICAgICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIHN0bW50ID0gYnVmLnByZXBhcmVDYWxsKGNv\nbm4pOwoKICAgICAgICAgICAgICAgIGludCBpbmRleCA9IDA7CiAgICAgICAg\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBwYXJhbUxpc3QuaXRlcmF0b3Io\nKTsgaS5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgICAgIGRpY3Quc2V0\nVW5rbm93bihzdG1udCwgKytpbmRleCwgaS5uZXh0KCksIG51bGwpOwogICAg\nICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpbnQgY291bnQgPSAwOwog\nICAgICAgICAgICAgICAgaWYgKF9jYWxsICYmIHN0bW50LmV4ZWN1dGUoKSA9\nPSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIGNvdW50ID0gc3RtbnQu\nZ2V0VXBkYXRlQ291bnQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIG5hdGl2ZSBp\nbnNlcnQsIHVwZGF0ZSwgZGVsZXRlCiAgICAgICAgICAgICAgICAgICAgY291\nbnQgPSBzdG1udC5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKGNvdW50\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAg\nICAgICAgICAgICAgICBpZiAoc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UyKSB7fQogICAgICAgICAgICAgICAgdHJ5IHsgY29ubi5jbG9z\nZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UyKSB7fQogICAgICAgICAg\nICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShzZSwgZGljdCk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1\nbHRPYmplY3RQcm92aWRlciBleGVjdXRlUXVlcnkoU3RvcmVRdWVyeSBxLAog\nICAgICAgICAgICBPYmplY3RbXSBwYXJhbXMsIFJhbmdlIHJhbmdlKSB7CiAg\nICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSA9ICgoU1FMU3RvcmVRdWVyeSkg\ncSkuZ2V0U3RvcmUoKTsKICAgICAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3Qg\nPSBzdG9yZS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICAgICAgU3RyaW5n\nIHNxbCA9IHEuZ2V0Q29udGV4dCgpLmdldFF1ZXJ5U3RyaW5nKCk7CgogICAg\nICAgICAgICBMaXN0IHBhcmFtTGlzdDsKICAgICAgICAgICAgaWYgKHBhcmFt\ncy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBwYXJhbUxpc3QgPSBu\nZXcgQXJyYXlMaXN0KEFycmF5cy5hc0xpc3QocGFyYW1zKSk7CiAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHNxbCA9IHN1YnN0\naXR1dGVQYXJhbXMoc3FsLCBwYXJhbUxpc3QpOwogICAgICAgICAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oaW9lKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBwYXJh\nbUxpc3QgPSBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwoKICAgICAgICAgICAg\nU1FMQnVmZmVyIGJ1ZiA9IG5ldyBTUUxCdWZmZXIoZGljdCkuYXBwZW5kKHNx\nbCk7CiAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubiA9IHN0b3JlLmdldENv\nbm5lY3Rpb24oKTsKICAgICAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlv\nbiBmZXRjaCA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9uKQogICAgICAgICAg\nICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7\nCgogICAgICAgICAgICBSZXN1bHRPYmplY3RQcm92aWRlciByb3A7CiAgICAg\nICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIC8vIHVzZSB0aGUgcmlnaHQg\nbWV0aG9kIGRlcGVuZGluZyBvbiBzZWwgdnMuIHByb2MsIGxycyBzZXR0aW5n\nCiAgICAgICAgICAgICAgICBpZiAoX3NlbGVjdCAmJiAhcmFuZ2UubHJzKQog\nICAgICAgICAgICAgICAgICAgIHN0bW50ID0gYnVmLnByZXBhcmVTdGF0ZW1l\nbnQoY29ubik7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChfc2VsZWN0KQog\nICAgICAgICAgICAgICAgICAgIHN0bW50ID0gYnVmLnByZXBhcmVTdGF0ZW1l\nbnQoY29ubiwgZmV0Y2gsIC0xLCAtMSk7CiAgICAgICAgICAgICAgICBlbHNl\nIGlmICghcmFuZ2UubHJzKQogICAgICAgICAgICAgICAgICAgIHN0bW50ID0g\nYnVmLnByZXBhcmVDYWxsKGNvbm4pOwogICAgICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgICAgIHN0bW50ID0gYnVmLnByZXBhcmVDYWxsKGNv\nbm4sIGZldGNoLCAtMSwgLTEpOwoKICAgICAgICAgICAgICAgIGludCBpbmRl\neCA9IDA7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBwYXJh\nbUxpc3QuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KQogICAgICAgICAgICAg\nICAgICAgIGRpY3Quc2V0VW5rbm93bihzdG1udCwgKytpbmRleCwgaS5uZXh0\nKCksIG51bGwpOwoKICAgICAgICAgICAgICAgIFJlc3VsdFNldFJlc3VsdCBy\nZXMgPSBuZXcgUmVzdWx0U2V0UmVzdWx0KGNvbm4sIHN0bW50LAogICAgICAg\nICAgICAgICAgICAgIHN0bW50LmV4ZWN1dGVRdWVyeSgpLCBzdG9yZSk7CiAg\nICAgICAgICAgICAgICBpZiAoX3Jlc3VsdE1hcHBpbmcgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICByb3AgPSBuZXcgTWFwcGVkUXVlcnlSZXN1bHRP\nYmplY3RQcm92aWRlcihfcmVzdWx0TWFwcGluZywKICAgICAgICAgICAgICAg\nICAgICAgICAgc3RvcmUsIGZldGNoLCByZXMpOwogICAgICAgICAgICAgICAg\nZWxzZSBpZiAocS5nZXRDb250ZXh0KCkuZ2V0Q2FuZGlkYXRlVHlwZSgpICE9\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgcm9wID0gbmV3IEdlbmVyaWNS\nZXN1bHRPYmplY3RQcm92aWRlcigoQ2xhc3NNYXBwaW5nKSBfbWV0YSwKICAg\nICAgICAgICAgICAgICAgICAgICAgc3RvcmUsIGZldGNoLCByZXMpOwogICAg\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHJvcCA9IG5l\ndyBTUUxQcm9qZWN0aW9uUmVzdWx0T2JqZWN0UHJvdmlkZXIoc3RvcmUsIGZl\ndGNoLAogICAgICAgICAgICAgICAgICAgICAgICByZXMsIHEuZ2V0Q29udGV4\ndCgpLmdldFJlc3VsdFR5cGUoKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgaWYgKHN0bW50ICE9\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2Uo\nKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlMikge30KICAgICAgICAgICAg\nICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlMikge30KICAgICAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMu\nZ2V0U3RvcmUoc2UsIGRpY3QpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBpZiAocmFuZ2Uuc3RhcnQgIT0gMCB8fCByYW5nZS5lbmQgIT0gTG9uZy5N\nQVhfVkFMVUUpCiAgICAgICAgICAgICAgICByb3AgPSBuZXcgUmFuZ2VSZXN1\nbHRPYmplY3RQcm92aWRlcihyb3AsIHJhbmdlLnN0YXJ0LHJhbmdlLmVuZCk7\nCiAgICAgICAgICAgIHJldHVybiByb3A7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0RGF0YVN0b3JlQWN0aW9ucyhTdG9yZVF1ZXJ5\nIHEsIE9iamVjdFtdIHBhcmFtcywKICAgICAgICAgICAgUmFuZ2UgcmFuZ2Up\nIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgcS5nZXRDb250\nZXh0KCkuZ2V0UXVlcnlTdHJpbmcoKSB9OwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gaXNQYWNraW5nKFN0b3JlUXVlcnkgcSkgewogICAg\nICAgICAgICByZXR1cm4gcS5nZXRDb250ZXh0KCkuZ2V0Q2FuZGlkYXRlVHlw\nZSgpID09IG51bGw7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

