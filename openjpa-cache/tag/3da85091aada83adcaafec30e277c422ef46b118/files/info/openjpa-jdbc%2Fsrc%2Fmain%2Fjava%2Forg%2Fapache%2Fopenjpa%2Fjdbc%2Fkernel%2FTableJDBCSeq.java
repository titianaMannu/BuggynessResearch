{"sha":"92735ad9504d6c92003fb87d43cf4d45d08e7bfc","node_id":"MDQ6QmxvYjIwNjM2NDo5MjczNWFkOTUwNGQ2YzkyMDAzZmI4N2Q0M2NmNGQ0NWQwOGU3YmZj","size":22065,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/92735ad9504d6c92003fb87d43cf4d45d08e7bfc","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxF\neGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmln\ndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuUHJpbWFyeUtleTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hR3JvdXA7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hVG9vbDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFzOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9u\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1\ncmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29u\nZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkph\ndmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFs\naWRTdGF0ZUV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAudXRpbC5OdW1iZXJzOwpp\nbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8g\nTk9URTogRG8gbm90IGNoYW5nZSBwcm9wZXJ0eSBuYW1lczsgc2VlIFNlcXVl\nbmNlTWV0YURhdGEKLy8gYW5kIFNlcXVlbmNlTWFwcGluZyBmb3Igc3RhbmRh\ncmQgcHJvcGVydHkgbmFtZXMuCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKLyoqCiAqIHtA\nbGluayBKREJDU2VxfSBpbXBsZW1lbnRhdGlvbiB0aGF0IHVzZXMgYSBkYXRh\nYmFzZSB0YWJsZQogKiBmb3Igc2VxdWVuY2UgbnVtYmVyIGdlbmVyYXRpb24u\nIFRoaXMgYmFzZSBpbXBsZW1lbnRhdGlvbiB1c2VzIGEgc2luZ2xlCiAqIHJv\ndyBmb3IgYSBnbG9iYWwgc2VxdWVuY2UgbnVtYmVyLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIFRhYmxlSkRCQ1NlcQogICAg\nZXh0ZW5kcyBBYnN0cmFjdEpEQkNTZXEKICAgIGltcGxlbWVudHMgQ29uZmln\ndXJhYmxlIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJ\nT05fRFJPUCA9ICJkcm9wIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIEFDVElPTl9BREQgPSAiYWRkIjsKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIEFDVElPTl9HRVQgPSAiZ2V0IjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIEFDVElPTl9TRVQgPSAic2V0IjsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5m\nb3JQYWNrYWdlCiAgICAgICAgKFRhYmxlSkRCQ1NlcS5jbGFzcyk7CgogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgSkRCQ0NvbmZpZ3VyYXRpb24gX2NvbmYgPSBu\ndWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgTG9nIF9sb2cgPSBudWxsOwog\nICAgcHJpdmF0ZSBpbnQgX2FsbG9jID0gNTA7CiAgICBwcml2YXRlIGZpbmFs\nIFN0YXR1cyBfc3RhdCA9IG5ldyBTdGF0dXMoKTsKCiAgICBwcml2YXRlIFN0\ncmluZyBfdGFibGUgPSAiT1BFTkpQQV9TRVFVRU5DRV9UQUJMRSI7CiAgICBw\ncml2YXRlIFN0cmluZyBfc2VxQ29sdW1uTmFtZSA9ICJTRVFVRU5DRV9WQUxV\nRSI7CiAgICBwcml2YXRlIFN0cmluZyBfcGtDb2x1bW5OYW1lID0gIklEIjsK\nCiAgICBwcml2YXRlIENvbHVtbiBfc2VxQ29sdW1uID0gbnVsbDsKICAgIHBy\naXZhdGUgQ29sdW1uIF9wa0NvbHVtbiA9IG51bGw7CgogICAgLyoqCiAgICAg\nKiBUaGUgc2VxdWVuY2UgdGFibGUgbmFtZS4gRGVmYXVsdHMgdG8gPGNvZGU+\nT1BFTkpQQV9TRVFVRU5DRV9UQUJMRTwvY29kZT4uCiAgICAgKiBCeSBkZWZh\ndWx0LCB0aGUgdGFibGUgd2lsbCBiZSBwbGFjZWQgaW4gdGhlIGZpcnN0IHNj\naGVtYSBsaXN0ZWQgaW4geW91cgogICAgICogPGNvZGU+b3BlbmpwYS5qZGJj\nLlNjaGVtYXM8L2NvZGU+IHByb3BlcnR5LCBvciBpbiB0aGUgZGVmYXVsdCBz\nY2hlbWEgaWYKICAgICAqIHRoZSBwcm9wZXJ0eSBpcyBub3QgZ2l2ZW4uIElm\nIHlvdSBzcGVjaWZ5IGEgdGFibGUgbmFtZSBpbiB0aGUgZm9ybQogICAgICog\nPGNvZGU+Jmx0O3NjaGVtYSZndDsuJmx0O3RhYmxlJmd0OzwvY29kZT4sIHRo\nZW4gdGhlIGdpdmVuIHNjaGVtYQogICAgICogd2lsbCBiZSB1c2VkLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFRhYmxlKCkgewogICAgICAgIHJl\ndHVybiBfdGFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2VxdWVu\nY2UgdGFibGUgbmFtZS4gRGVmYXVsdHMgdG8gPGNvZGU+T1BFTkpQQV9TRVFV\nRU5DRV9UQUJMRTwvY29kZT4uCiAgICAgKiBCeSBkZWZhdWx0LCB0aGUgdGFi\nbGUgd2lsbCBiZSBwbGFjZWQgaW4gdGhlIGZpcnN0IHNjaGVtYSBsaXN0ZWQg\naW4geW91cgogICAgICogPGNvZGU+b3BlbmpwYS5qZGJjLlNjaGVtYXM8L2Nv\nZGU+IHByb3BlcnR5LCBvciBpbiB0aGUgZGVmYXVsdCBzY2hlbWEgaWYKICAg\nICAqIHRoZSBwcm9wZXJ0eSBpcyBub3QgZ2l2ZW4uIElmIHlvdSBzcGVjaWZ5\nIGEgdGFibGUgbmFtZSBpbiB0aGUgZm9ybQogICAgICogPGNvZGU+Jmx0O3Nj\naGVtYSZndDsuJmx0O3RhYmxlJmd0OzwvY29kZT4sIHRoZW4gdGhlIGdpdmVu\nIHNjaGVtYQogICAgICogd2lsbCBiZSB1c2VkLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRUYWJsZShTdHJpbmcgbmFtZSkgewogICAgICAgIF90YWJs\nZSA9IG5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGVwcmVjYXRlZCBV\nc2Uge0BsaW5rICNzZXRUYWJsZX0uIFJldGFpbmVkIGZvcgogICAgICogYmFj\na3dhcmRzLWNvbXBhdGliaWxpdHkJd2l0aCBhdXRvLWNvbmZpZ3VyYXRpb24u\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFRhYmxlTmFtZShTdHJpbmcg\nbmFtZSkgewogICAgICAgIHNldFRhYmxlKG5hbWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIG5hbWUgb2YgdGhlIGNvbHVtbiB0aGF0IGhvbGRzIHRo\nZSBzZXF1ZW5jZSB2YWx1ZS4gRGVmYXVsdHMKICAgICAqIHRvIDxjb2RlPlNF\nUVVFTkNFX1ZBTFVFPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIFN0cmlu\nZyBnZXRTZXF1ZW5jZUNvbHVtbigpIHsKICAgICAgICByZXR1cm4gX3NlcUNv\nbHVtbk5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0\naGUgY29sdW1uIHRoYXQgaG9sZHMgdGhlIHNlcXVlbmNlIHZhbHVlLiBEZWZh\ndWx0cwogICAgICogdG8gPGNvZGU+U0VRVUVOQ0VfVkFMVUU8L2NvZGU+Lgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTZXF1ZW5jZUNvbHVtbihTdHJp\nbmcgc2VxdWVuY2VDb2x1bW4pIHsKICAgICAgICBfc2VxQ29sdW1uTmFtZSA9\nIHNlcXVlbmNlQ29sdW1uOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG5h\nbWUgb2YgdGhlIHRhYmxlJ3MgcHJpbWFyeSBrZXkgY29sdW1uLiBEZWZhdWx0\ncyB0bwogICAgICogPGNvZGU+SUQ8L2NvZGU+LgogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIGdldFByaW1hcnlLZXlDb2x1bW4oKSB7CiAgICAgICAgcmV0\ndXJuIF9wa0NvbHVtbk5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUg\nbmFtZSBvZiB0aGUgdGFibGUncyBwcmltYXJ5IGtleSBjb2x1bW4uIERlZmF1\nbHRzIHRvCiAgICAgKiA8Y29kZT5JRDwvY29kZT4uCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFByaW1hcnlLZXlDb2x1bW4oU3RyaW5nIHByaW1hcnlL\nZXlDb2x1bW4pIHsKICAgICAgICBfcGtDb2x1bW5OYW1lID0gcHJpbWFyeUtl\neUNvbHVtbjsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbnVt\nYmVyIG9mIHNlcXVlbmNlcyB0byBhbGxvY2F0ZSBmb3IgZWFjaCB1cGRhdGUg\nb2YgdGhlCiAgICAgKiBzZXF1ZW5jZSB0YWJsZS4gU2VxdWVuY2UgbnVtYmVy\ncyB3aWxsIGJlIGdyYWJiZWQgaW4gYmxvY2tzIG9mIHRoaXMKICAgICAqIHZh\nbHVlIHRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIHRyYW5zYWN0aW9ucyB0aGF0\nIG11c3QgYmUgcGVyZm9ybWVkIG9uCiAgICAgKiB0aGUgc2VxdWVuY2UgdGFi\nbGUuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0QWxsb2NhdGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9hbGxvYzsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgbnVtYmVyIG9mIHNlcXVlbmNlcyB0byBhbGxvY2F0ZSBmb3Ig\nZWFjaCB1cGRhdGUgb2YgdGhlCiAgICAgKiBzZXF1ZW5jZSB0YWJsZS4gU2Vx\ndWVuY2UgbnVtYmVycyB3aWxsIGJlIGdyYWJiZWQgaW4gYmxvY2tzIG9mIHRo\naXMKICAgICAqIHZhbHVlIHRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIHRyYW5z\nYWN0aW9ucyB0aGF0IG11c3QgYmUgcGVyZm9ybWVkIG9uCiAgICAgKiB0aGUg\nc2VxdWVuY2UgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEFs\nbG9jYXRlKGludCBhbGxvYykgewogICAgICAgIF9hbGxvYyA9IGFsbG9jOwog\nICAgfQoKICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayAj\nc2V0QWxsb2NhdGV9LiBSZXRhaW5lZCBmb3IgYmFja3dhcmRzCiAgICAgKiBj\nb21wYXRpYmlsaXR5IG9mIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0SW5jcmVtZW50KGludCBpbmMpIHsKICAgICAg\nICBzZXRBbGxvY2F0ZShpbmMpOwogICAgfQoKICAgIHB1YmxpYyBKREJDQ29u\nZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVy\nbiBfY29uZjsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb25maWd1cmF0\naW9uKENvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9jb25mID0gKEpE\nQkNDb25maWd1cmF0aW9uKSBjb25mOwogICAgICAgIF9sb2cgPSBfY29uZi5n\nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkgewogICAgICAg\nIGJ1aWxkVGFibGUoKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgYWRk\nU2NoZW1hKENsYXNzTWFwcGluZyBtYXBwaW5nLCBTY2hlbWFHcm91cCBncm91\ncCkgewogICAgICAgIC8vIHRhYmxlIGFscmVhZHkgZXhpc3RzPwogICAgICAg\nIGlmIChncm91cC5pc0tub3duVGFibGUoX3RhYmxlKSkKICAgICAgICAgICAg\ncmV0dXJuOwoKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSA9IFN0cmluZ3Mu\nZ2V0UGFja2FnZU5hbWUoX3RhYmxlKTsKICAgICAgICBpZiAoc2NoZW1hTmFt\nZS5sZW5ndGgoKSA9PSAwKQogICAgICAgICAgICBzY2hlbWFOYW1lID0gU2No\nZW1hcy5nZXROZXdUYWJsZVNjaGVtYShfY29uZik7CgogICAgICAgIC8vIGNy\nZWF0ZSB0YWJsZSBpbiB0aGlzIGdyb3VwCiAgICAgICAgU2NoZW1hIHNjaGVt\nYSA9IGdyb3VwLmdldFNjaGVtYShzY2hlbWFOYW1lKTsKICAgICAgICBpZiAo\nc2NoZW1hID09IG51bGwpCiAgICAgICAgICAgIHNjaGVtYSA9IGdyb3VwLmFk\nZFNjaGVtYShzY2hlbWFOYW1lKTsKICAgICAgICBzY2hlbWEuaW1wb3J0VGFi\nbGUoX3BrQ29sdW1uLmdldFRhYmxlKCkpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBPYmplY3QgbmV4dEludGVybmFsKEpEQkNTdG9yZSBzdG9yZSwgQ2xhc3NN\nYXBwaW5nIG1hcHBpbmcpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgLy8gaWYgbmVlZGVkLCBncmFiIHRoZSBuZXh0IGhhbmRmdWwgb2Yg\naWRzCiAgICAgICAgU3RhdHVzIHN0YXQgPSBnZXRTdGF0dXMobWFwcGluZyk7\nCiAgICAgICAgaWYgKHN0YXQgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cg\nbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXNlcS10\neXBlIiwKICAgICAgICAgICAgICAgIGdldENsYXNzKCksIG1hcHBpbmcpKTsK\nCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgc3luY2hyb25p\nemVkIChzdGF0KSB7CiAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgc2Vx\nIGlzIGF0IGxlYXN0IDEsIHNpbmNlIGF1dG9hc3NpZ25lZCBpZHMgb2YgMCBj\nYW4KICAgICAgICAgICAgICAgIC8vIGNvbmZsaWN0IHdpdGggdW5pbml0aWFs\naXplZCB2YWx1ZXMKICAgICAgICAgICAgICAgIHN0YXQuc2VxID0gTWF0aC5t\nYXgoc3RhdC5zZXEsIDEpOwogICAgICAgICAgICAgICAgaWYgKHN0YXQuc2Vx\nIDwgc3RhdC5tYXgpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE51bWJl\ncnMudmFsdWVPZihzdGF0LnNlcSsrKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBhbGxvY2F0ZVNlcXVlbmNlKHN0b3JlLCBtYXBwaW5nLCBzdGF0LCBf\nYWxsb2MsIHRydWUpOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQg\nT2JqZWN0IGN1cnJlbnRJbnRlcm5hbChKREJDU3RvcmUgc3RvcmUsIENsYXNz\nTWFwcGluZyBtYXBwaW5nKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGlmIChjdXJyZW50ID09IG51bGwpIHsKICAgICAgICAgICAgQ29u\nbmVjdGlvbiBjb25uID0gZ2V0Q29ubmVjdGlvbihzdG9yZSk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsb25nIGN1ciA9IGdldFNlcXVl\nbmNlKG1hcHBpbmcsIGNvbm4pOwogICAgICAgICAgICAgICAgaWYgKGN1ciAh\nPSAtMSkKICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gTnVtYmVycy52\nYWx1ZU9mKGN1cik7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICBjbG9zZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN1cGVyLmN1cnJlbnRJbnRlcm5h\nbChzdG9yZSwgbWFwcGluZyk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nYWxsb2NhdGVJbnRlcm5hbChpbnQgY291bnQsIEpEQkNTdG9yZSBzdG9yZSwK\nICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZykKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBTdGF0dXMgc3RhdCA9IGdldFN0YXR1\ncyhtYXBwaW5nKTsKICAgICAgICBpZiAoc3RhdCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAg\nICAgIGludCBhdmFpbGFibGU7CiAgICAgICAgICAgIHN5bmNocm9uaXplZCAo\nc3RhdCkgewogICAgICAgICAgICAgICAgYXZhaWxhYmxlID0gKGludCkgKHN0\nYXQubWF4IC0gc3RhdC5zZXEpOwogICAgICAgICAgICAgICAgaWYgKGF2YWls\nYWJsZSA+PSBjb3VudCkKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgYWxsb2NhdGVTZXF1ZW5jZShzdG9y\nZSwgbWFwcGluZywgc3RhdCwgY291bnQgLSBhdmFpbGFibGUsIGZhbHNlKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGFw\ncHJvcHJpYXRlIHN0YXR1cyBvYmplY3QgZm9yIHRoZSBnaXZlbiBjbGFzcywg\nb3IgbnVsbAogICAgICogaWYgY2Fubm90IGhhbmRsZSB0aGUgZ2l2ZW4gY2xh\nc3MuIFRoZSBtYXBwaW5nIG1heSBiZSBudWxsLgogICAgICovCiAgICBwcm90\nZWN0ZWQgU3RhdHVzIGdldFN0YXR1cyhDbGFzc01hcHBpbmcgbWFwcGluZykg\newogICAgICAgIHJldHVybiBfc3RhdDsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFkZCB0aGUgcHJpbWFyeSBrZXkgY29sdW1uIHRvIHRoZSBnaXZlbiB0YWJs\nZSBhbmQgcmV0dXJuIGl0LgogICAgICovCiAgICBwcm90ZWN0ZWQgQ29sdW1u\nIGFkZFByaW1hcnlLZXlDb2x1bW4oVGFibGUgdGFibGUpIHsKICAgICAgICBE\nQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUluc3Rh\nbmNlKCk7CiAgICAgICAgQ29sdW1uIHBrQ29sdW1uID0gdGFibGUuYWRkQ29s\ndW1uKGRpY3QuZ2V0VmFsaWRDb2x1bW5OYW1lCiAgICAgICAgICAgIChnZXRQ\ncmltYXJ5S2V5Q29sdW1uKCksIHRhYmxlKSk7CiAgICAgICAgcGtDb2x1bW4u\nc2V0VHlwZShkaWN0LmdldFByZWZlcnJlZFR5cGUoVHlwZXMuVElOWUlOVCkp\nOwogICAgICAgIHBrQ29sdW1uLnNldEphdmFUeXBlKEphdmFUeXBlcy5JTlQp\nOwogICAgICAgIHJldHVybiBwa0NvbHVtbjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgcHJpbWFyeSBrZXkgdmFsdWUgZm9yIHRoZSBnaXZl\nbiBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRQcmlt\nYXJ5S2V5KENsYXNzTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgcmV0dXJu\nIE51bWJlcnMudmFsdWVPZigwKTsKICAgIH0KCiAgICAvKioKICAgICAqIENy\nZWF0ZXMgdGhlIG9iamVjdC1sZXZlbCByZXByZXNlbnRhdGlvbiBvZiB0aGUg\nc2VxdWVuY2UgdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWls\nZFRhYmxlKCkgewogICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSBTdHJpbmdz\nLmdldENsYXNzTmFtZShfdGFibGUpOwogICAgICAgIFN0cmluZyBzY2hlbWFO\nYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfdGFibGUpOwogICAgICAg\nIGlmIChzY2hlbWFOYW1lLmxlbmd0aCgpID09IDApCiAgICAgICAgICAgIHNj\naGVtYU5hbWUgPSBTY2hlbWFzLmdldE5ld1RhYmxlU2NoZW1hKF9jb25mKTsK\nCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBuZXcgU2NoZW1hR3JvdXAo\nKTsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ3JvdXAuYWRkU2NoZW1hKHNj\naGVtYU5hbWUpOwoKICAgICAgICBUYWJsZSB0YWJsZSA9IHNjaGVtYS5hZGRU\nYWJsZSh0YWJsZU5hbWUpOwogICAgICAgIF9wa0NvbHVtbiA9IGFkZFByaW1h\ncnlLZXlDb2x1bW4odGFibGUpOwogICAgICAgIFByaW1hcnlLZXkgcGsgPSB0\nYWJsZS5hZGRQcmltYXJ5S2V5KCk7CiAgICAgICAgcGsuYWRkQ29sdW1uKF9w\na0NvbHVtbik7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYu\nZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBfc2VxQ29sdW1u\nID0gdGFibGUuYWRkQ29sdW1uKGRpY3QuZ2V0VmFsaWRDb2x1bW5OYW1lCiAg\nICAgICAgICAgIChfc2VxQ29sdW1uTmFtZSwgdGFibGUpKTsKICAgICAgICBf\nc2VxQ29sdW1uLnNldFR5cGUoZGljdC5nZXRQcmVmZXJyZWRUeXBlKFR5cGVz\nLkJJR0lOVCkpOwogICAgICAgIF9zZXFDb2x1bW4uc2V0SmF2YVR5cGUoSmF2\nYVR5cGVzLkxPTkcpOwogICAgfQoKICAgIC8qKgogICAgICogVXBkYXRlcyB0\naGUgbWF4IGF2YWlsYWJsZSBzZXF1ZW5jZSB2YWx1ZS4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGFsbG9jYXRlU2VxdWVuY2UoSkRCQ1N0b3JlIHN0b3Jl\nLCBDbGFzc01hcHBpbmcgbWFwcGluZywKICAgICAgICBTdGF0dXMgc3RhdCwg\naW50IGFsbG9jLCBib29sZWFuIHVwZGF0ZVN0YXRTZXEpIAogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIENvbm5lY3Rpb24gY29ubiA9\nIGdldENvbm5lY3Rpb24oc3RvcmUpOwogICAgICAgIHRyeSB7IAogICAgICAg\nICAgICBpZiAoc2V0U2VxdWVuY2UobWFwcGluZywgc3RhdCwgYWxsb2MsIHVw\nZGF0ZVN0YXRTZXEsIGNvbm4pKQogICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICB0aHJvdyBTUUxFeGNlcHRpb25zLmdldFN0b3JlKF9sb2MuZ2V0KCJiYWQt\nc2VxLXVwIiwgX3RhYmxlKSwKICAgICAgICAgICAgICAgIHNlLCBfY29uZi5n\nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBjbG9zZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIHBvc3Np\nYmxlIHRoYXQgd2UgbWlnaHQgZ2V0IGVycm9ycyB3aGVuIGluc2VydGluZyBp\nZgogICAgICAgICAgICAvLyBhbm90aGVyIHRocmVhZC9wcm9jZXNzIGlzIGlu\nc2VydGluZyBzYW1lIHBrIGF0IHNhbWUgdGltZQogICAgICAgICAgICBTUUxF\neGNlcHRpb24gZXJyID0gbnVsbDsgCiAgICAgICAgICAgIC8vICMjIyB3aHkg\nZG9lcyB0aGlzIG5vdCBjYWxsIGdldENvbm5lY3Rpb24oKSAvIGNsb3NlQ29u\nbmVjdGlvbigpPwogICAgICAgICAgICBjb25uID0gX2NvbmYuZ2V0RGF0YVNv\ndXJjZTIoc3RvcmUuZ2V0Q29udGV4dCgpKS5nZXRDb25uZWN0aW9uKCk7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpbnNlcnRTZXF1ZW5j\nZShtYXBwaW5nLCBjb25uKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAgICAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIHRyeSB7IGNvbm4u\nY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAg\nICAgICB9CgogICAgICAgICAgICAvLyBub3cgd2Ugc2hvdWxkIGJlIGFibGUg\ndG8gdXBkYXRlLi4uCiAgICAgICAgICAgIGNvbm4gPSBnZXRDb25uZWN0aW9u\nKHN0b3JlKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlm\nICghc2V0U2VxdWVuY2UobWFwcGluZywgc3RhdCwgYWxsb2MsIHVwZGF0ZVN0\nYXRTZXEsIGNvbm4pKQogICAgICAgICAgICAgICAgICAgIHRocm93IChlcnIg\nIT0gbnVsbCkgPyBlcnIgOiBuZXcgU1FMRXhjZXB0aW9uKF9sb2MuZ2V0CiAg\nICAgICAgICAgICAgICAgICAgICAgICgibm8tc2VxLXJvdyIsIG1hcHBpbmcs\nIF90YWJsZSkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgICAgIGNsb3NlQ29ubmVjdGlvbihjb25uKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZTIp\nIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShf\nbG9jLmdldCgiYmFkLXNlcS11cCIsIF90YWJsZSksCiAgICAgICAgICAgICAg\nICBzZTIsIF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkpOwogICAg\nICAgIH0gCiAgICB9CgogICAgLyoqCiAgICAgKiBJbnNlcnRzIHRoZSBpbml0\naWFsIHNlcXVlbmNlIGluZm9ybWF0aW9uIGludG8gdGhlIGRhdGFiYXNlLCBp\nZiBhbnkuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBpbnNlcnRTZXF1ZW5j\nZShDbGFzc01hcHBpbmcgbWFwcGluZywgQ29ubmVjdGlvbiBjb25uKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfbG9nLmlz\nVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cudHJhY2UoX2xvYy5n\nZXQoImluc2VydC1zZXEiKSk7CgogICAgICAgIE9iamVjdCBwayA9IGdldFBy\naW1hcnlLZXkobWFwcGluZyk7CiAgICAgICAgaWYgKHBrID09IG51bGwpCiAg\nICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1zZXEtdHlwZSIsCiAgICAgICAgICAgICAgICBnZXRDbGFz\ncygpLCBtYXBwaW5nKSk7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0g\nX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBTUUxC\ndWZmZXIgaW5zZXJ0ID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoIklO\nU0VSVCBJTlRPICIpLgogICAgICAgICAgICBhcHBlbmQoX3BrQ29sdW1uLmdl\ndFRhYmxlKCkpLmFwcGVuZCgiICgiKS4KICAgICAgICAgICAgYXBwZW5kKF9w\na0NvbHVtbikuYXBwZW5kKCIsICIpLmFwcGVuZChfc2VxQ29sdW1uKS4KICAg\nICAgICAgICAgYXBwZW5kKCIpIFZBTFVFUyAoIikuCiAgICAgICAgICAgIGFw\ncGVuZFZhbHVlKHBrLCBfcGtDb2x1bW4pLmFwcGVuZCgiLCAiKS4KICAgICAg\nICAgICAgYXBwZW5kVmFsdWUoTnVtYmVycy52YWx1ZU9mKDEpLCBfc2VxQ29s\ndW1uKS5hcHBlbmQoIikiKTsKCiAgICAgICAgYm9vbGVhbiB3YXNBdXRvID0g\nY29ubi5nZXRBdXRvQ29tbWl0KCk7CiAgICAgICAgaWYgKCF3YXNBdXRvICYm\nICFzdXNwZW5kSW5KVEEoKSkKICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29t\nbWl0KHRydWUpOwoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9\nIG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3RtbnQgPSBpbnNl\ncnQucHJlcGFyZVN0YXRlbWVudChjb25uKTsKICAgICAgICAgICAgc3RtbnQu\nZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsg\nc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQog\nICAgICAgICAgICBpZiAoIXdhc0F1dG8gJiYgIXN1c3BlbmRJbkpUQSgpKQog\nICAgICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KGZhbHNlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJl\nbnQgc2VxdWVuY2UgdmFsdWUsIG9yIC0xIGlmIHVuYXR0YWluYWJsZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGxvbmcgZ2V0U2VxdWVuY2UoQ2xhc3NNYXBw\naW5nIG1hcHBpbmcsIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxl\nZCgpKQogICAgICAgICAgICBfbG9nLnRyYWNlKF9sb2MuZ2V0KCJnZXQtc2Vx\nIikpOwoKICAgICAgICBPYmplY3QgcGsgPSBnZXRQcmltYXJ5S2V5KG1hcHBp\nbmcpOwogICAgICAgIGlmIChwayA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gLTE7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYuZ2V0\nREJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBTUUxCdWZmZXIgc2Vs\nID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoX3NlcUNvbHVtbik7CiAg\nICAgICAgU1FMQnVmZmVyIHdoZXJlID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5h\ncHBlbmQoX3BrQ29sdW1uKS5hcHBlbmQoIiA9ICIpLgogICAgICAgICAgICBh\ncHBlbmRWYWx1ZShwaywgX3BrQ29sdW1uKTsKICAgICAgICBTUUxCdWZmZXIg\ndGFibGVzID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoX3NlcUNvbHVt\nbi5nZXRUYWJsZSgpKTsKCiAgICAgICAgU1FMQnVmZmVyIHNlbGVjdCA9IGRp\nY3QudG9TZWxlY3Qoc2VsLCBudWxsLCB0YWJsZXMsIHdoZXJlLCBudWxsLAog\nICAgICAgICAgICBudWxsLCBudWxsLCBmYWxzZSwgZGljdC5zdXBwb3J0c1Nl\nbGVjdEZvclVwZGF0ZSwgMCwgTG9uZy5NQVhfVkFMVUUpOwoKICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHNlbGVjdC5wcmVwYXJlU3RhdGVt\nZW50KGNvbm4pOwogICAgICAgIFJlc3VsdFNldCBycyA9IG51bGw7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcnMgPSBzdG1udC5leGVjdXRlUXVlcnko\nKTsKICAgICAgICAgICAgaWYgKCFycy5uZXh0KCkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gLTE7CiAgICAgICAgICAgIHJldHVybiBkaWN0LmdldExvbmco\ncnMsIDEpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChy\ncyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgcnMuY2xvc2UoKTsg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgICAgICB0cnkg\neyBzdG1udC5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogR3JhYnMgdGhlIG5l\neHQgaGFuZGZ1bCBvZiBzZXF1ZW5jZSBudW1iZXJzLgogICAgICoKICAgICAq\nIEByZXR1cm4gdHJ1ZSBpZiB0aGUgc2VxdWVuY2Ugd2FzIHVwZGF0ZWQsIGZh\nbHNlIGlmIG5vIHNlcXVlbmNlCiAgICAgKiByb3cgZXhpc3RlZCBmb3IgdGhp\ncyBtYXBwaW5nCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHNldFNl\ncXVlbmNlKENsYXNzTWFwcGluZyBtYXBwaW5nLCBTdGF0dXMgc3RhdCwgaW50\nIGluYywKICAgICAgICBib29sZWFuIHVwZGF0ZVN0YXRTZXEsIENvbm5lY3Rp\nb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9n\nLnRyYWNlKF9sb2MuZ2V0KCJ1cGRhdGUtc2VxIikpOwoKICAgICAgICBPYmpl\nY3QgcGsgPSBnZXRQcmltYXJ5S2V5KG1hcHBpbmcpOwogICAgICAgIGlmIChw\nayA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRl\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc2VxLXR5cGUiLAogICAgICAgICAg\nICAgICAgZ2V0Q2xhc3MoKSwgbWFwcGluZykpOwoKICAgICAgICBEQkRpY3Rp\nb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCk7\nCiAgICAgICAgU1FMQnVmZmVyIHdoZXJlID0gbmV3IFNRTEJ1ZmZlcihkaWN0\nKS5hcHBlbmQoX3BrQ29sdW1uKS5hcHBlbmQoIiA9ICIpLgogICAgICAgICAg\nICBhcHBlbmRWYWx1ZShwaywgX3BrQ29sdW1uKTsKCiAgICAgICAgLy8gbG9v\ncCB1bnRpbCB3ZSBoYXZlIGEgc3VjY2Vzc2Z1bCBhdG9taWMgc2VsZWN0L3Vw\nZGF0ZSBzZXF1ZW5jZQogICAgICAgIGxvbmcgY3VyID0gMDsKICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udDsKICAgICAgICBSZXN1bHRTZXQgcnM7\nCiAgICAgICAgU1FMQnVmZmVyIHVwZDsKICAgICAgICBmb3IgKGludCB1cGRh\ndGVzID0gMDsgdXBkYXRlcyA9PSAwOykgewogICAgICAgICAgICBzdG1udCA9\nIG51bGw7CiAgICAgICAgICAgIHJzID0gbnVsbDsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGN1ciA9IGdldFNlcXVlbmNlKG1hcHBpbmcs\nIGNvbm4pOwogICAgICAgICAgICAgICAgaWYgKGN1ciA9PSAtMSkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAgICAg\nLy8gdXBkYXRlIHRoZSB2YWx1ZQogICAgICAgICAgICAgICAgdXBkID0gbmV3\nIFNRTEJ1ZmZlcihkaWN0KTsKICAgICAgICAgICAgICAgIHVwZC5hcHBlbmQo\nIlVQREFURSAiKS5hcHBlbmQoX3NlcUNvbHVtbi5nZXRUYWJsZSgpKS4KICAg\nICAgICAgICAgICAgICAgICBhcHBlbmQoIiBTRVQgIikuYXBwZW5kKF9zZXFD\nb2x1bW4pLmFwcGVuZCgiID0gIikuCiAgICAgICAgICAgICAgICAgICAgYXBw\nZW5kVmFsdWUoTnVtYmVycy52YWx1ZU9mKGN1ciArIGluYyksIF9zZXFDb2x1\nbW4pLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiIFdIRVJFICIpLmFw\ncGVuZCh3aGVyZSkuYXBwZW5kKCIgQU5EICIpLgogICAgICAgICAgICAgICAg\nICAgIGFwcGVuZChfc2VxQ29sdW1uKS5hcHBlbmQoIiA9ICIpLgogICAgICAg\nICAgICAgICAgICAgIGFwcGVuZFZhbHVlKE51bWJlcnMudmFsdWVPZihjdXIp\nLCBfc2VxQ29sdW1uKTsKCiAgICAgICAgICAgICAgICBzdG1udCA9IHVwZC5w\ncmVwYXJlU3RhdGVtZW50KGNvbm4pOwogICAgICAgICAgICAgICAgdXBkYXRl\ncyA9IHN0bW50LmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgIGlmIChycyAhPSBudWxsKSAKICAgICAg\nICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgpOyB9IGNhdGNoIChTUUxF\neGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgICAgICBpZiAoc3RtbnQgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSgp\nOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIC8vIHNldHVwIG5ldyBzZXF1ZW5jZSByYW5n\nZQogICAgICAgIHN5bmNocm9uaXplZCAoc3RhdCkgewogICAgICAgICAgICBp\nZiAodXBkYXRlU3RhdFNlcSAmJiBzdGF0LnNlcSA8IGN1cikKICAgICAgICAg\nICAgICAgIHN0YXQuc2VxID0gY3VyOwogICAgICAgICAgICBpZiAoc3RhdC5t\nYXggPCBjdXIgKyBpbmMpCiAgICAgICAgICAgICAgICBzdGF0Lm1heCA9IGN1\nciArIGluYzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIHRoZSBzZXF1ZW5jZSB0YWJsZSBp\nbiB0aGUgREIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hUYWJs\nZSgpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKF9sb2cuaXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9nLmluZm8o\nX2xvYy5nZXQoIm1ha2Utc2VxLXRhYmxlIikpOwoKICAgICAgICAvLyBjcmVh\ndGUgdGhlIHRhYmxlCiAgICAgICAgU2NoZW1hVG9vbCB0b29sID0gbmV3IFNj\naGVtYVRvb2woX2NvbmYpOwogICAgICAgIHRvb2wuc2V0SWdub3JlRXJyb3Jz\nKHRydWUpOwogICAgICAgIHRvb2wuY3JlYXRlVGFibGUoX3BrQ29sdW1uLmdl\ndFRhYmxlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogRHJvcHMgdGhlIHNl\ncXVlbmNlIHRhYmxlIGluIHRoZSBEQi4KICAgICAqLwogICAgcHVibGljIHZv\naWQgZHJvcFRhYmxlKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAg\nIF9sb2cuaW5mbyhfbG9jLmdldCgiZHJvcC1zZXEtdGFibGUiKSk7CgogICAg\nICAgIC8vIGRyb3AgdGhlIHRhYmxlCiAgICAgICAgU2NoZW1hVG9vbCB0b29s\nID0gbmV3IFNjaGVtYVRvb2woX2NvbmYpOwogICAgICAgIHRvb2wuc2V0SWdu\nb3JlRXJyb3JzKHRydWUpOwogICAgICAgIHRvb2wuZHJvcFRhYmxlKF9wa0Nv\nbHVtbi5nZXRUYWJsZSgpKTsKICAgIH0KCiAgICAvLy8vLy8vLy8KICAgIC8v\nIE1haW4KICAgIC8vLy8vLy8vLwoKICAgIC8qKgogICAgICogVXNhZ2U6IGph\ndmEgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlSkRCQ1Nl\ncXVlbmNlIFtvcHRpb25dKgogICAgICogLWFjdGlvbi8tYSAmbHQ7YWRkIHwg\nZHJvcCB8IGdldCB8IHNldCZndDsgW3ZhbHVlXQogICAgICogIFdoZXJlIHRo\nZSBmb2xsb3dpbmcgb3B0aW9ucyBhcmUgcmVjb2duaXplZC4KICAgICAqIDx1\nbD4KICAgICAqIDxsaT48aT4tcHJvcGVydGllcy8tcCAmbHQ7cHJvcGVydGll\ncyBmaWxlIG9yIHJlc291cmNlJmd0OzwvaT46IFRoZQogICAgICogcGF0aCBv\nciByZXNvdXJjZSBuYW1lIG9mIGEgT3BlbkpQQSBwcm9wZXJ0aWVzIGZpbGUg\nY29udGFpbmluZwogICAgICogaW5mb3JtYXRpb24gc3VjaCBhcyB0aGUgbGlj\nZW5zZSBrZXkJYW5kIGNvbm5lY3Rpb24gZGF0YSBhcwogICAgICogb3V0bGlu\nZWQgaW4ge0BsaW5rIEpEQkNDb25maWd1cmF0aW9ufS4gT3B0aW9uYWwuPC9s\naT4KICAgICAqIDxsaT48aT4tJmx0O3Byb3BlcnR5IG5hbWUmZ3Q7ICZsdDtw\ncm9wZXJ0eSB2YWx1ZSZndDs8L2k+OiBBbGwgYmVhbgogICAgICogcHJvcGVy\ndGllcyBvZiB0aGUgT3BlbkpQQSB7QGxpbmsgSkRCQ0NvbmZpZ3VyYXRpb259\nIGNhbiBiZSBzZXQgYnkKICAgICAqIHVzaW5nIHRoZWlyCW5hbWVzIGFuZCBz\ndXBwbHlpbmcgYSB2YWx1ZS4gRm9yIGV4YW1wbGU6CiAgICAgKiA8Y29kZT4t\nbGljZW5zZUtleSBhZHNsZmphODNyM2xrYWRmPC9jb2RlPjwvbGk+CiAgICAg\nKiA8L3VsPgogICAgICogIFRoZSB2YXJpb3VzIGFjdGlvbnMgYXJlIGFzIGZv\nbGxvd3MuCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+YWRkPC9pPjogQ3Jl\nYXRlIHRoZSBzZXF1ZW5jZSB0YWJsZS48L2xpPgogICAgICogPGxpPjxpPmRy\nb3A8L2k+OiBEcm9wIHRoZSBzZXF1ZW5jZSB0YWJsZS48L2xpPgogICAgICog\nPGxpPjxpPmdldDwvaT46IFByaW50IHRoZSBjdXJyZW50IHNlcXVlbmNlIHZh\nbHVlLjwvbGk+CiAgICAgKiA8bGk+PGk+c2V0PC9pPjogU2V0IHRoZSBzZXF1\nZW5jZSB2YWx1ZS48L2xpPgogICAgICogPC91bD4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcg\nT3B0aW9ucygpOwogICAgICAgIGFyZ3MgPSBvcHRzLnNldEZyb21DbWRMaW5l\nKGFyZ3MpOwogICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcg\nSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgaWYgKCFydW4oY29uZiwgYXJncywgb3B0cykpCiAgICAgICAgICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oX2xvYy5nZXQoInNlcS11c2FnZSIp\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjb25mLmNsb3Nl\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUnVuIHRoZSB0\nb29sLiBSZXR1cm5zIGZhbHNlIGlmIGludmFsaWQgb3B0aW9ucyB3ZXJlIGdp\ndmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKEpE\nQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAg\nT3B0aW9ucyBvcHRzKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIGlmIChvcHRzLmNvbnRhaW5zS2V5KCJoZWxwIikgfHwgb3B0cy5jb250\nYWluc0tleSgiLWhlbHAiKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoK\nICAgICAgICBTdHJpbmcgYWN0aW9uID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgi\nYWN0aW9uIiwgImEiLCBudWxsKTsKICAgICAgICBDb25maWd1cmF0aW9ucy5w\nb3B1bGF0ZUNvbmZpZ3VyYXRpb24oY29uZiwgb3B0cyk7CiAgICAgICAgcmV0\ndXJuIHJ1bihjb25mLCBhcmdzLCBhY3Rpb24pOwogICAgfQoKICAgIC8qKgog\nICAgICogUnVuIHRoZSB0b29sLiBSZXR1cm4gZmFsc2UgaWYgYW4gaW52YWxp\nZCBvcHRpb24gd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGJvb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1td\nIGFyZ3MsCiAgICAgICAgU3RyaW5nIGFjdGlvbikKICAgICAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxIHx8IChh\ncmdzLmxlbmd0aCAhPSAwCiAgICAgICAgICAgICYmICFBQ1RJT05fU0VULmVx\ndWFscyhhY3Rpb24pKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAg\nICAgICBUYWJsZUpEQkNTZXEgc2VxID0gbmV3IFRhYmxlSkRCQ1NlcSgpOwog\nICAgICAgIFN0cmluZyBwcm9wcyA9IENvbmZpZ3VyYXRpb25zLmdldFByb3Bl\ncnRpZXMoY29uZi5nZXRTZXF1ZW5jZSgpKTsKICAgICAgICBDb25maWd1cmF0\naW9ucy5jb25maWd1cmVJbnN0YW5jZShzZXEsIGNvbmYsIHByb3BzKTsKCiAg\nICAgICAgaWYgKEFDVElPTl9EUk9QLmVxdWFscyhhY3Rpb24pKQogICAgICAg\nICAgICBzZXEuZHJvcFRhYmxlKCk7CiAgICAgICAgZWxzZSBpZiAoQUNUSU9O\nX0FERC5lcXVhbHMoYWN0aW9uKSkKICAgICAgICAgICAgc2VxLnJlZnJlc2hU\nYWJsZSgpOwogICAgICAgIGVsc2UgaWYgKEFDVElPTl9HRVQuZXF1YWxzKGFj\ndGlvbikgfHwgQUNUSU9OX1NFVC5lcXVhbHMoYWN0aW9uKSkgewogICAgICAg\nICAgICBDb25uZWN0aW9uIGNvbm4gPSBjb25mLmdldERhdGFTb3VyY2UyKG51\nbGwpLmdldENvbm5lY3Rpb24oKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIGxvbmcgY3VyID0gc2VxLmdldFNlcXVlbmNlKG51bGwsIGNv\nbm4pOwogICAgICAgICAgICAgICAgaWYgKEFDVElPTl9HRVQuZXF1YWxzKGFj\ndGlvbikpCiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKGN1cik7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICBsb25nIHNldDsKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5s\nZW5ndGggPiAwKQogICAgICAgICAgICAgICAgICAgICAgICBzZXQgPSBMb25n\nLnBhcnNlTG9uZyhhcmdzWzBdKTsKICAgICAgICAgICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICAgICAgICAgIHNldCA9IGN1ciArIHNlcS5nZXRB\nbGxvY2F0ZSgpOwogICAgICAgICAgICAgICAgICAgIGlmIChzZXQgPCBjdXIp\nCiAgICAgICAgICAgICAgICAgICAgICAgIHNldCA9IGN1cjsKICAgICAgICAg\nICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgU3Rh\ndHVzIHN0YXQgPSBzZXEuZ2V0U3RhdHVzKG51bGwpOwogICAgICAgICAgICAg\nICAgICAgICAgICBzZXEuc2V0U2VxdWVuY2UobnVsbCwgc3RhdCwgKGludCkg\nKHNldCAtIGN1ciksIHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBjb25uKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0ID0gc3RhdC5z\nZXE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIFN5c3RlbS5lcnIucHJpbnRsbihzZXQpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChOdW1iZXJGb3JtYXRF\neGNlcHRpb24gbmZlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICB0cnkg\neyBjb25uLmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30K\nICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBIZWxwZXIgc3RydWN0IHRvIGhvbGQgc3RhdHVzIGluZm9ybWF0\naW9uLgogICAgICovCiAgICBwcm90ZWN0ZWQgc3RhdGljIGNsYXNzIFN0YXR1\ncwogICAgICAgIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHsKCiAgICAgICAg\ncHVibGljIGxvbmcgc2VxID0gMUw7CiAgICAgICAgcHVibGljIGxvbmcgbWF4\nID0gMEw7CiAgICB9Cn0K\n","encoding":"base64"}

