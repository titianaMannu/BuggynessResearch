{"sha":"3f5a31bcf1237d08405fcc835aa65c6b1035691a","node_id":"MDQ6QmxvYjIwNjM2NDozZjVhMzFiY2YxMjM3ZDA4NDA1ZmNjODM1YWE2NWM2YjEwMzU2OTFh","size":7325,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3f5a31bcf1237d08405fcc835aa65c6b1035691a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7Cmlt\ncG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbC5Kb2luczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb25WaXNpdG9yOwoKLyoqCiAqIFRl\nc3RzIHdoZXRoZXIgYSB2YWx1ZSBpcyBJTiBhIGNvbGxlY3Rpb24uCiAqCiAq\nIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpjbGFzcyBJbkV4cHJlc3Npb24KICAg\nIGltcGxlbWVudHMgRXhwIHsKCiAgICBwcml2YXRlIGZpbmFsIFZhbCBfdmFs\nOwogICAgcHJpdmF0ZSBmaW5hbCBDb25zdCBfY29uc3Q7CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IHRoZSB2YWx1ZSB0byB0ZXN0IGFu\nZCB0aGUgY29uc3RhbnQgdG8gb2J0YWluCiAgICAgKiB0aGUgcGFyYW1ldGVy\ncyBmcm9tLgogICAgICovCiAgICBwdWJsaWMgSW5FeHByZXNzaW9uKFZhbCB2\nYWwsIENvbnN0IGNvbnN0YW50KSB7CiAgICAgICAgX3ZhbCA9IHZhbDsKICAg\nICAgICBfY29uc3QgPSBjb25zdGFudDsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnN0YW50IGNvbGxlY3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBDb25z\ndCBnZXRDb25zdGFudCgpIHsKICAgICAgICByZXR1cm4gX2NvbnN0OwogICAg\nfQoKICAgIC8qKgogICAgICogQ29udGFpbmVkIHZhbHVlLgogICAgICovCiAg\nICBwdWJsaWMgVmFsIGdldFZhbHVlKCkgewogICAgICAgIHJldHVybiBfdmFs\nOwogICAgfQoKICAgIHB1YmxpYyBFeHBTdGF0ZSBpbml0aWFsaXplKFNlbGVj\ndCBzZWwsIEV4cENvbnRleHQgY3R4LCBNYXAgY29udGFpbnMpIHsKICAgICAg\nICBFeHBTdGF0ZSB2YWx1ZVN0YXRlID0gX3ZhbC5pbml0aWFsaXplKHNlbCwg\nY3R4LCAwKTsKICAgICAgICBFeHBTdGF0ZSBjb25zdGFudFN0YXRlID0gX2Nv\nbnN0LmluaXRpYWxpemUoc2VsLCBjdHgsIDApOwogICAgICAgIHJldHVybiBu\nZXcgSW5FeHBTdGF0ZSh2YWx1ZVN0YXRlLmpvaW5zLCBjb25zdGFudFN0YXRl\nLCB2YWx1ZVN0YXRlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4cHJlc3Np\nb24gc3RhdGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIElu\nRXhwU3RhdGUKICAgICAgICBleHRlbmRzIEV4cFN0YXRlIHsKCiAgICAgICAg\ncHVibGljIGZpbmFsIEV4cFN0YXRlIGNvbnN0YW50U3RhdGU7CiAgICAgICAg\ncHVibGljIGZpbmFsIEV4cFN0YXRlIHZhbHVlU3RhdGU7CgogICAgICAgIHB1\nYmxpYyBJbkV4cFN0YXRlKEpvaW5zIGpvaW5zLCBFeHBTdGF0ZSBjb25zdGFu\ndFN0YXRlLCAKICAgICAgICAgICAgRXhwU3RhdGUgdmFsdWVTdGF0ZSkgewog\nICAgICAgICAgICBzdXBlcihqb2lucyk7CiAgICAgICAgICAgIHRoaXMuY29u\nc3RhbnRTdGF0ZSA9IGNvbnN0YW50U3RhdGU7CiAgICAgICAgICAgIHRoaXMu\ndmFsdWVTdGF0ZSA9IHZhbHVlU3RhdGU7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGFwcGVuZFRvKFNlbGVjdCBzZWwsIEV4cENvbnRleHQg\nY3R4LCBFeHBTdGF0ZSBzdGF0ZSwgCiAgICAgICAgU1FMQnVmZmVyIGJ1Zikg\newogICAgICAgIEluRXhwU3RhdGUgaXN0YXRlID0gKEluRXhwU3RhdGUpIHN0\nYXRlOyAKICAgICAgICBfY29uc3QuY2FsY3VsYXRlVmFsdWUoc2VsLCBjdHgs\nIGlzdGF0ZS5jb25zdGFudFN0YXRlLCBudWxsLCBudWxsKTsKICAgICAgICBf\ndmFsLmNhbGN1bGF0ZVZhbHVlKHNlbCwgY3R4LCBpc3RhdGUudmFsdWVTdGF0\nZSwgbnVsbCwgbnVsbCk7CgogICAgICAgIExpc3QgbGlzdCA9IG51bGw7CiAg\nICAgICAgQ29sbGVjdGlvbiBjb2xsID0gZ2V0Q29sbGVjdGlvbihjdHgsIGlz\ndGF0ZS5jb25zdGFudFN0YXRlKTsKICAgICAgICBpZiAoY29sbCAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGxpc3QgPSBuZXcgQXJyYXlMaXN0KGNvbGwuc2l6\nZSgpKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBjb2xsLml0\nZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgbGlz\ndC5hZGQoX3ZhbC50b0RhdGFTdG9yZVZhbHVlKHNlbCwgY3R4LCBpc3RhdGUu\ndmFsdWVTdGF0ZSwgCiAgICAgICAgICAgICAgICAgICAgaXRyLm5leHQoKSkp\nOwogICAgICAgIH0KCiAgICAgICAgQ29sdW1uW10gY29scyA9IG51bGw7CiAg\nICAgICAgaWYgKF92YWwgaW5zdGFuY2VvZiBQQ1BhdGgpCiAgICAgICAgICAg\nIGNvbHMgPSAoKFBDUGF0aCkgX3ZhbCkuZ2V0Q29sdW1ucyhpc3RhdGUudmFs\ndWVTdGF0ZSk7CiAgICAgICAgZWxzZSBpZiAoX3ZhbCBpbnN0YW5jZW9mIEdl\ndE9iamVjdElkKQogICAgICAgICAgICBjb2xzID0gKChHZXRPYmplY3RJZCkg\nX3ZhbCkuZ2V0Q29sdW1ucyhpc3RhdGUudmFsdWVTdGF0ZSk7CgogICAgICAg\nIGlmIChsaXN0ID09IG51bGwgfHwgbGlzdC5pc0VtcHR5KCkpCiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIjEgPD4gMSIpOwogICAgICAgIGVsc2UgaWYgKF92\nYWwubGVuZ3RoKHNlbCwgY3R4LCBpc3RhdGUudmFsdWVTdGF0ZSkgPT0gMSkK\nICAgICAgICAgICAgY3JlYXRlSW5Db250YWlucyhzZWwsIGN0eCwgaXN0YXRl\nLnZhbHVlU3RhdGUsIGJ1ZiwgbGlzdCwgY29scyk7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBvckNvbnRhaW5zKHNlbCwgY3R4LCBpc3RhdGUudmFsdWVT\ndGF0ZSwgYnVmLCBsaXN0LCBjb2xzKTsKICAgICAgICBzZWwuYXBwZW5kKGJ1\nZiwgc3RhdGUuam9pbnMpOwogICAgfQoKICAgIC8qKgogICAgICogQmFzZWQg\nb24gdGhlIGluQ2xhdXNlTGltaXQgb2YgdGhlIERCRGljdGlvbmFyeSwgY3Jl\nYXRlIHRoZSBuZWVkZWQgSU4gCiAgICAgKiBjbGF1c2VzCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBjcmVhdGVJbkNvbnRhaW5zKFNlbGVjdCBzZWwsIEV4\ncENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0ZSwgCiAgICAgICAgU1FMQnVm\nZmVyIGJ1ZiwgTGlzdCBsaXN0LCBDb2x1bW5bXSBjb2xzKSB7CgogICAgICAg\nIGludCBpbkNsYXVzZUxpbWl0ID0gY3R4LnN0b3JlLmdldERCRGljdGlvbmFy\neSgpLmluQ2xhdXNlTGltaXQ7CiAgICAgICAgaWYgKGluQ2xhdXNlTGltaXQg\nPD0gMCB8fCBsaXN0LnNpemUoKSA8PSBpbkNsYXVzZUxpbWl0KQogICAgICAg\nICAgICBpbkNvbnRhaW5zKHNlbCwgY3R4LCBzdGF0ZSwgYnVmLCBsaXN0LCBj\nb2xzKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nKCIpOwogICAgICAgICAgICBmb3IgKGludCBsb3cgPSAwLCBoaWdoOyBsb3cg\nPCBsaXN0LnNpemUoKTsgbG93ID0gaGlnaCkgewogICAgICAgICAgICAgICAg\naWYgKGxvdyA+IDApCiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nIE9SICIpOwogICAgICAgICAgICAgICAgaGlnaCA9IGphdmEubGFuZy5NYXRo\nLm1pbihsb3cgKyBpbkNsYXVzZUxpbWl0LCBsaXN0LnNpemUoKSk7CiAgICAg\nICAgICAgICAgICBpbkNvbnRhaW5zKHNlbCwgY3R4LCBzdGF0ZSwgYnVmLCBs\naXN0LnN1Ykxpc3QobG93LCBoaWdoKSwgY29scyk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBhbiBJTiBjbGF1c2Ugd2l0aCB0\naGUgdmFsdWUgb2YgdGhlIGdpdmVuIGNvbGxlY3Rpb24uCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBpbkNvbnRhaW5zKFNlbGVjdCBzZWwsIEV4cENvbnRl\neHQgY3R4LCBFeHBTdGF0ZSBzdGF0ZSwgCiAgICAgICAgU1FMQnVmZmVyIGJ1\nZiwgQ29sbGVjdGlvbiBjb2xsLCBDb2x1bW5bXSBjb2xzKSB7CiAgICAgICAg\nX3ZhbC5hcHBlbmRUbyhzZWwsIGN0eCwgc3RhdGUsIGJ1ZiwgMCk7CiAgICAg\nICAgYnVmLmFwcGVuZCgiIElOICgiKTsKCiAgICAgICAgQ29sdW1uIGNvbCA9\nIChjb2xzICE9IG51bGwgJiYgY29scy5sZW5ndGggPT0gMSkgPyBjb2xzWzBd\nIDogbnVsbDsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNvbGwuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgYnVmLmFw\ncGVuZFZhbHVlKGl0ci5uZXh0KCksIGNvbCk7CiAgICAgICAgICAgIGlmIChp\ndHIuaGFzTmV4dCgpKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAi\nKTsKICAgICAgICB9CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAgfQoK\nICAgIC8qKgogICAgICogSWYgdGhlIHZhbHVlIHRvIHRlc3QgaXMgYSBjb21w\nb3VuZCBrZXksIHdlIGNhbid0IHVzZSBJTiwKICAgICAqIHNvIGNyZWF0ZSBh\nIGNsYXVzZSBsaWtlICcoYSA9IGIgQU5EIGMgPSBkKSBPUiAoZSA9IGYgQU5E\nIGcgPSBoKSAuLi4nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBvckNvbnRh\naW5zKFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0\nZSwgCiAgICAgICAgU1FMQnVmZmVyIGJ1ZiwgQ29sbGVjdGlvbiBjb2xsLCBD\nb2x1bW5bXSBjb2xzKSB7CiAgICAgICAgaWYgKGNvbGwuc2l6ZSgpID4gMSkK\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiKCIpOwoKICAgICAgICBPYmplY3Rb\nXSB2YWxzOwogICAgICAgIENvbHVtbiBjb2w7CiAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSBjb2xsLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7\nCiAgICAgICAgICAgIHZhbHMgPSAoT2JqZWN0W10pIGl0ci5uZXh0KCk7Cgog\nICAgICAgICAgICBidWYuYXBwZW5kKCIoIik7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgdmFscy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgY29sID0gKGNvbHMgIT0gbnVsbCAmJiBjb2xzLmxlbmd0aCA9PSB2\nYWxzLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICA/IGNvbHNbaV0gOiBu\ndWxsOwogICAgICAgICAgICAgICAgaWYgKGkgPiAwKQogICAgICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgIik7CgogICAgICAgICAgICAgICAg\nX3ZhbC5hcHBlbmRUbyhzZWwsIGN0eCwgc3RhdGUsIGJ1ZiwgaSk7CiAgICAg\nICAgICAgICAgICBpZiAodmFsc1tpXSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBJUyAiKTsKICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgPSAiKTsKICAg\nICAgICAgICAgICAgIGJ1Zi5hcHBlbmRWYWx1ZSh2YWxzW2ldLCBjb2wpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIikiKTsKCiAg\nICAgICAgICAgIGlmIChpdHIuaGFzTmV4dCgpKQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIE9SICIpOwogICAgICAgIH0KICAgICAgICBpZiAoY29s\nbC5zaXplKCkgPiAxKQogICAgICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2VsZWN0Q29sdW1ucyhTZWxlY3Qgc2Vs\nLCBFeHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIGJv\nb2xlYW4gcGtzKSB7CiAgICAgICAgSW5FeHBTdGF0ZSBpc3RhdGUgPSAoSW5F\neHBTdGF0ZSkgc3RhdGU7IAogICAgICAgIF9jb25zdC5zZWxlY3RDb2x1bW5z\nKHNlbCwgY3R4LCBpc3RhdGUuY29uc3RhbnRTdGF0ZSwgdHJ1ZSk7CiAgICAg\nICAgX3ZhbC5zZWxlY3RDb2x1bW5zKHNlbCwgY3R4LCBpc3RhdGUudmFsdWVT\ndGF0ZSwgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGNvbGxlY3Rpb24gdG8gdGVzdCBmb3IgY29udGFpbm1lbnQgd2l0aC4KICAg\nICAqLwogICAgcHJvdGVjdGVkIENvbGxlY3Rpb24gZ2V0Q29sbGVjdGlvbihF\neHBDb250ZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUpIHsKICAgICAgICBPYmpl\nY3QgdmFsID0gX2NvbnN0LmdldFZhbHVlKGN0eCwgc3RhdGUpOwoKICAgICAg\nICAvLyB3cmFwIG5vbi1Db2xsZWN0aW9uIHBhcmFtZXRlcnMgaW4gYSBDb2xs\nZWN0aW9ucyBzbyB0aGUgcXVlcnkKICAgICAgICAvLyBsYW51YWdlIGNhbiBw\nZXJtaXQgdmFyYXJncyAiaW4iIGNsYXVzZXMKICAgICAgICBpZiAoISh2YWwg\naW5zdGFuY2VvZiBDb2xsZWN0aW9uKSkKICAgICAgICAgICAgdmFsID0gQ29s\nbGVjdGlvbnMuc2luZ2xldG9uKHZhbCk7CgogICAgICAgIHJldHVybiAoQ29s\nbGVjdGlvbikgdmFsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZp\nc2l0KEV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICB2aXNp\ndG9yLmVudGVyKHRoaXMpOwogICAgICAgIF92YWwuYWNjZXB0VmlzaXQodmlz\naXRvcik7CiAgICAgICAgX2NvbnN0LmFjY2VwdFZpc2l0KHZpc2l0b3IpOwog\nICAgICAgIHZpc2l0b3IuZXhpdCh0aGlzKTsKICAgIH0KfQo=\n","encoding":"base64"}

