{"sha":"290e457479c20f63c649b9b753f6e2dd82b80f92","node_id":"MDQ6QmxvYjIwNjM2NDoyOTBlNDU3NDc5YzIwZjYzYzY0OWI5Yjc1M2Y2ZTJkZDgyYjgwZjky","size":19200,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/290e457479c20f63c649b9b753f6e2dd82b80f92","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkJpdFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBv\ncnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5zOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLlNvdXJjZVRyYWNrZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi54bWwuQ29tbWVudGFibGU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YU1vZGVzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRp\nb247CmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBNYXBwaW5n\nIG9mIGEgcXVlcnkgcmVzdWx0IHNldCB0byBzY2FsYXIgYW5kL29yIHBlcnNp\nc3RlbmNlLWNhcGFibGUKICogb2JqZWN0LWxldmVsIHZhbHVlcy4KICoKICog\nQGF1dGhvciBQaW5ha2kgUG9kZGFyCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nLwpwdWJsaWMgY2xhc3MgUXVlcnlSZXN1bHRNYXBwaW5nCiAgICBpbXBsZW1l\nbnRzIE1ldGFEYXRhTW9kZXMsIFNvdXJjZVRyYWNrZXIsIENvbW1lbnRhYmxl\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFF1ZXJ5UmVzdWx0TWFw\ncGluZy5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX25hbWU7\nCiAgICBwcml2YXRlIGZpbmFsIE1hcHBpbmdSZXBvc2l0b3J5IF9yZXBvczsK\nICAgIHByaXZhdGUgRmlsZSBfZmlsZSA9IG51bGw7CiAgICBwcml2YXRlIE9i\namVjdCBfc2NvcGUgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX3NyY1R5cGUg\nPSBTUkNfT1RIRVI7CiAgICBwcml2YXRlIGludCBfbW9kZSA9IE1PREVfUVVF\nUlk7CiAgICBwcml2YXRlIENsYXNzIF9jbGFzcyA9IG51bGw7CiAgICBwcml2\nYXRlIGludCBfaWR4ID0gMDsKICAgIHByaXZhdGUgU3RyaW5nW10gX2NvbW1l\nbnRzID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdCBfY29sTGlzdCA9IG51bGw7\nCiAgICBwcml2YXRlIExpc3QgX3BjTGlzdCA9IG51bGw7CgogICAgcHJpdmF0\nZSBQQ1Jlc3VsdFtdIF9wY3MgPSBudWxsOwogICAgcHJpdmF0ZSBPYmplY3Rb\nXSBfY29scyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Qgd2l0\naCB0aGUgZ2l2ZW4gbmFtZS4KICAgICAqLwogICAgUXVlcnlSZXN1bHRNYXBw\naW5nKFN0cmluZyBuYW1lLCBNYXBwaW5nUmVwb3NpdG9yeSByZXBvcykgewog\nICAgICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBfcmVwb3MgPSByZXBvczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbmFtZSBmb3IgdGhp\ncyBxdWVyeSByZXN1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0\nTmFtZSgpIHsKICAgICAgICByZXR1cm4gX25hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgY2xhc3MgdGhhdCBkZWZpbmVzIHRoaXMgcXVlcnkgcmVz\ndWx0LCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\ncyBnZXREZWZpbmluZ1R5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9jbGFzczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBjbGFzcyB0aGF0IGRlZmluZXMg\ndGhpcyBxdWVyeSByZXN1bHQsIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0RGVmaW5pbmdUeXBlKENsYXNzIGNscykgewog\nICAgICAgIF9jbGFzcyA9IGNsczsKICAgIH0KCiAgICAvKioKICAgICAqIElk\ncyBvZiBtYXBwZWQgc2NhbGFyIGNvbHVtbnMgaW4gdGhlIHJlc3VsdC4gVGhl\nc2Ugd2lsbCB0eXBpY2FsbHkgYmUKICAgICAqIGNvbHVtbiBuYW1lcy4KICAg\nICAqCiAgICAgKiBAc2VlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5S\nZXN1bHQKICAgICAqLwogICAgcHVibGljIE9iamVjdFtdIGdldENvbHVtblJl\nc3VsdHMoKSB7CiAgICAgICAgaWYgKF9jb2xzID09IG51bGwpIHsKICAgICAg\nICAgICAgT2JqZWN0W10gY29sczsKICAgICAgICAgICAgaWYgKF9jb2xMaXN0\nID09IG51bGwpCiAgICAgICAgICAgICAgICBjb2xzID0gbmV3IE9iamVjdFsw\nXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY29scyA9IF9j\nb2xMaXN0LnRvQXJyYXkoKTsKICAgICAgICAgICAgX2NvbHMgPSBjb2xzOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gX2NvbHM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBZGQgdGhlIGlkIG9mIGEgbWFwcGVkIGNvbHVtbiBpbiB0aGUg\ncXVlcnkgcmVzdWx0LiBUaGlzIHdpbGwgdHlwaWNhbGx5CiAgICAgKiBiZSBh\nIGNvbHVtbiBuYW1lLgogICAgICoKICAgICAqIEBzZWUgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJlc3VsdAogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBhZGRDb2x1bW5SZXN1bHQoT2JqZWN0IGlkKSB7CiAgICAgICAgX2NvbHMg\nPSBudWxsOwogICAgICAgIGlmIChfY29sTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICBfY29sTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBfY29s\nTGlzdC5hZGQoaWQpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBtYXBwZWQgcGVyc2lzdGVuY2UtY2FwYWJsZSB0eXBlcyBpbiB0aGUgcXVl\ncnkgcmVzdWx0LgogICAgICovCiAgICBwdWJsaWMgUENSZXN1bHRbXSBnZXRQ\nQ1Jlc3VsdHMoKSB7CiAgICAgICAgaWYgKF9wY3MgPT0gbnVsbCkgewogICAg\nICAgICAgICBQQ1Jlc3VsdFtdIHBjczsKICAgICAgICAgICAgaWYgKF9wY0xp\nc3QgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHBjcyA9IG5ldyBQQ1Jlc3Vs\ndFswXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcGNzID0g\nKFBDUmVzdWx0W10pIF9wY0xpc3QudG9BcnJheQogICAgICAgICAgICAgICAg\nICAgIChuZXcgUENSZXN1bHRbX3BjTGlzdC5zaXplKCldKTsKICAgICAgICAg\nICAgX3BjcyA9IHBjczsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9wY3M7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBtYXBwZWQgcGVyc2lzdGVu\nY2UtY2FwYWJsZSByZXN1bHQgd2l0aCB0aGUgZ2l2ZW4gY2FuZGlkYXRlIHR5\ncGUuCiAgICAgKi8KICAgIHB1YmxpYyBQQ1Jlc3VsdCBhZGRQQ1Jlc3VsdChD\nbGFzcyBjYW5kaWRhdGUpIHsKICAgICAgICBfcGNzID0gbnVsbDsKICAgICAg\nICBQQ1Jlc3VsdCBwYyA9IG5ldyBQQ1Jlc3VsdChjYW5kaWRhdGUpOwogICAg\nICAgIGlmIChfcGNMaXN0ID09IG51bGwpCiAgICAgICAgICAgIF9wY0xpc3Qg\nPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgX3BjTGlzdC5hZGQocGMpOwog\nICAgICAgIHJldHVybiBwYzsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBz\nb3VyY2UgbW9kZSBvZiB0aGlzIHF1ZXJ5IHJlc3VsdC4KICAgICAqLwogICAg\ncHVibGljIGludCBnZXRTb3VyY2VNb2RlKCkgewogICAgICAgIHJldHVybiBf\nbW9kZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzb3VyY2UgbW9kZSBv\nZiB0aGlzIHF1ZXJ5IHJlc3VsdC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0U291cmNlTW9kZShpbnQgbW9kZSkgewogICAgICAgIF9tb2RlID0gbW9k\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGF0aXZlIG9yZGVyIG9mIHJl\nc3VsdCBtYXBwaW5nIGluIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMg\naW50IGdldExpc3RpbmdJbmRleCgpIHsKICAgICAgICByZXR1cm4gX2lkeDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJlbGF0aXZlIG9yZGVyIG9mIHJlc3Vs\ndCBtYXBwaW5nIGluIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRMaXN0aW5nSW5kZXgoaW50IGlkeCkgewogICAgICAgIF9pZHggPSBp\nZHg7CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAg\nICAgICByZXR1cm4gX25hbWU7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8v\nCiAgICAvLyBDb21tZW50YWJsZQogICAgLy8vLy8vLy8vLy8vLy8vCgogICAg\ncHVibGljIFN0cmluZ1tdIGdldENvbW1lbnRzKCkgewogICAgICAgIHJldHVy\nbiAoX2NvbW1lbnRzID09IG51bGwpID8gRU1QVFlfQ09NTUVOVFMgOiBfY29t\nbWVudHM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29tbWVudHMoU3Ry\naW5nW10gY29tbWVudHMpIHsKICAgICAgICBfY29tbWVudHMgPSBjb21tZW50\nczsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gU291cmNlVHJhY2tlciBpbXBsZW1lbnRhdGlvbgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgRmls\nZSBnZXRTb3VyY2VGaWxlKCkgewogICAgICAgIHJldHVybiBfZmlsZTsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFNvdXJjZVNjb3BlKCkgewogICAg\nICAgIHJldHVybiBfc2NvcGU7CiAgICB9CgogICAgcHVibGljIGludCBnZXRT\nb3VyY2VUeXBlKCkgewogICAgICAgIHJldHVybiBfc3JjVHlwZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRTb3VyY2UoRmlsZSBmaWxlLCBPYmplY3Qg\nc2NvcGUsIGludCBzcmNUeXBlKSB7CiAgICAgICAgX2ZpbGUgPSBmaWxlOwog\nICAgICAgIF9zY29wZSA9IHNjb3BlOwogICAgICAgIF9zcmNUeXBlID0gc3Jj\nVHlwZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldFJlc291cmNlTmFt\nZSgpIHsKICAgICAgICByZXR1cm4gKF9jbGFzcyA9PSBudWxsKSA/IF9uYW1l\nIDogX2NsYXNzLmdldE5hbWUoKSArICI6IiArIF9uYW1lOwogICAgfQoKICAg\nIC8qKgogICAgICogQSBwZXJzaXN0ZW5jZS1jYXBhYmxlIHJlc3VsdC4KICAg\nICAqLwogICAgcHVibGljIGNsYXNzIFBDUmVzdWx0IHsKCiAgICAgICAgLyoq\nCiAgICAgICAgICogUGF0aCB0b2tlbiB0byByZXByZXNlbnQgYSBkaXNjcmlt\naW5hdG9yLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIERJU0NSSU1JTkFUT1IgPSAiPGRpc2NyaW1pbmF0b3I+IjsK\nCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDbGFzcyBfY2FuZGlkYXRlOwogICAg\nICAgIHByaXZhdGUgQ2xhc3NNYXBwaW5nIF9jYW5kaWRhdGVNYXAgPSBudWxs\nOwogICAgICAgIHByaXZhdGUgTWFwIF9yYXdNYXBwaW5ncyA9IG51bGw7IC8v\nIHN0cmluZy0+b2JqZWN0CiAgICAgICAgcHJpdmF0ZSBNYXAgX21hcHBpbmdz\nID0gbnVsbDsgLy8gbGlzdC0+Y29sdW1ubWFwCiAgICAgICAgcHJpdmF0ZSBN\nYXAgX2VhZ2VyID0gbnVsbDsgLy8gbGlzdC0+ZmV0Y2hpbmZvCiAgICAgICAg\ncHJpdmF0ZSBGZXRjaEluZm8gX2ZldGNoSW5mbyA9IG51bGw7IC8vIGZvciB0\nb3AtbGV2ZWwKCiAgICAgICAgLyoqCiAgICAgICAgICogU3VwcGx5IGNhbmRp\nZGF0ZSB0eXBlIG9uIGNvbnN0cnVjdGlvbi4KICAgICAgICAgKi8KICAgICAg\nICBwcml2YXRlIFBDUmVzdWx0KENsYXNzIGNhbmRpZGF0ZSkgewogICAgICAg\nICAgICBfY2FuZGlkYXRlID0gY2FuZGlkYXRlOwogICAgICAgIH0KCiAgICAg\nICAgLyoqCiAgICAgICAgICogVGhlIHJlc3VsdCBjYW5kaWRhdGUgY2xhc3Mu\nCiAgICAgICAgICovCiAgICAgICAgcHVibGljIENsYXNzIGdldENhbmRpZGF0\nZVR5cGUoKSB7CiAgICAgICAgICAgIHJldHVybiBfY2FuZGlkYXRlOwogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogQ2FuZGlkYXRlIG1hcHBp\nbmcuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIENsYXNzTWFwcGluZyBn\nZXRDYW5kaWRhdGVUeXBlTWFwcGluZygpIHsKICAgICAgICAgICAgaWYgKF9j\nYW5kaWRhdGVNYXAgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jYW5kaWRh\ndGVNYXAgPSBfcmVwb3MuZ2V0TWFwcGluZyhfY2FuZGlkYXRlLCBudWxsLCB0\ncnVlKTsKICAgICAgICAgICAgcmV0dXJuIF9jYW5kaWRhdGVNYXA7CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gdGhlIHJhdyBt\nYXBwaW5nIHBhdGhzIHN1cHBsaWVkIHdpdGgge0BsaW5rICNhZGRNYXBwaW5n\nfSwgb3IKICAgICAgICAgKiBlbXB0eSBhcnJheSBpZiBub25lLgogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRNYXBwaW5nUGF0aHMo\nKSB7CiAgICAgICAgICAgIGlmIChfcmF3TWFwcGluZ3MgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAgICAg\nICBDb2xsZWN0aW9uIGtleXMgPSBfcmF3TWFwcGluZ3Mua2V5U2V0KCk7CiAg\nICAgICAgICAgIHJldHVybiAoU3RyaW5nW10pIGtleXMudG9BcnJheShuZXcg\nU3RyaW5nW2tleXMuc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBSZXR1cm4gdGhlIG1hcHBpbmcgaWQgZm9yIHRoZSBnaXZl\nbiBwYXRoIHN1cHBsaWVkIHdpdGgKICAgICAgICAgKiB7QGxpbmsgI2FkZE1h\ncHBpbmd9LCBvciBudWxsIGlmIG5vbmUuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIE9iamVjdCBnZXRNYXBwaW5nKFN0cmluZyBwYXRoKSB7CiAgICAg\nICAgICAgIHJldHVybiAoX3Jhd01hcHBpbmdzID09IG51bGwpID8gbnVsbCA6\nIF9yYXdNYXBwaW5ncy5nZXQocGF0aCk7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBNYXAgdGhlIGdpdmVuIHBhdGggdG8gdGhlIGdpdmVu\nIHJlc3VsdCBpZC4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBh\nZGRNYXBwaW5nKFN0cmluZyBwYXRoLCBPYmplY3QgaWQpIHsKICAgICAgICAg\nICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkocGF0aCkpCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm51\nbGwtcGF0aCIsCiAgICAgICAgICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBw\naW5nLnRoaXMsIF9jYW5kaWRhdGUpKTsKCiAgICAgICAgICAgIF9tYXBwaW5n\ncyA9IG51bGw7CiAgICAgICAgICAgIF9lYWdlciA9IG51bGw7CiAgICAgICAg\nICAgIF9mZXRjaEluZm8gPSBudWxsOwogICAgICAgICAgICBpZiAoX3Jhd01h\ncHBpbmdzID09IG51bGwpCiAgICAgICAgICAgICAgICBfcmF3TWFwcGluZ3Mg\nPSBuZXcgSGFzaE1hcCgpOwogICAgICAgICAgICBfcmF3TWFwcGluZ3MucHV0\nKHBhdGgsIGlkKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIE1hcCB0aGUgZ2l2ZW4gcmVxdWVzdCBvbnRvIGEgcmVzdWx0IGlkLgogICAg\nICAgICAqCiAgICAgICAgICogQHBhcmFtIHBhdGggc3RhY2sgb2YgZGF0YSBy\nZXF1ZXN0cyAoc2VlCiAgICAgICAgICoge0BsaW5rIG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5SZXN1bHQjc3RhcnREYXRhUmVxdWVzdH0pCiAgICAg\nICAgICogQHBhcmFtIGlkIHJlcXVlc3RlZCBpZCBvciBjb2x1bW4gKHNlZQog\nICAgICAgICAqIHtAbGluayBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwu\nUmVzdWx0fSBBUElzKQogICAgICAgICAqIEBwYXJhbSBqb2lucyByZXF1ZXN0\nZWQgam9pbnMsIG9yIG51bGwKICAgICAgICAgKiBAcmV0dXJuIHRoZSBpZCBv\nciBjb2x1bW4gdG8gZmV0Y2ggZnJvbSB0aGUgcmVzdWx0CiAgICAgICAgICog\nKHR5cGljYWxseSBhIGNvbHVtbiBuYW1lKQogICAgICAgICAqLwogICAgICAg\nIHB1YmxpYyBPYmplY3QgbWFwKExpc3QgcGF0aCwgT2JqZWN0IGlkLCBKb2lu\ncyBqb2lucykgewogICAgICAgICAgICBpZiAoX3Jhd01hcHBpbmdzID09IG51\nbGwgfHwgIShpZCBpbnN0YW5jZW9mIENvbHVtbikpCiAgICAgICAgICAgICAg\nICByZXR1cm4gaWQ7CgogICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAg\nICAgIENvbHVtbk1hcCBjbSA9IChDb2x1bW5NYXApIF9tYXBwaW5ncy5nZXQo\ncGF0aCk7CiAgICAgICAgICAgIHJldHVybiAoY20gPT0gbnVsbCkgPyBpZCA6\nIGNtLm1hcCgoQ29sdW1uKSBpZCk7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgbWFwcGVkIHJlc3VsdCBj\nb250YWlucyBlYWdlciBkYXRhIGZvciB0aGUgZ2l2ZW4KICAgICAgICAgKiBm\naWVsZCBhdCB0aGUgZ2l2ZW4gcGF0aC4KICAgICAgICAgKgogICAgICAgICAq\nIEBwYXJhbSBwYXRoIHN0YWNrIG9mIGRhdGEgcmVxdWVzdHMgKHNlZQogICAg\nICAgICAqIHtAbGluayBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUmVz\ndWx0I3N0YXJ0RGF0YVJlcXVlc3R9KQogICAgICAgICAqLwogICAgICAgIHB1\nYmxpYyBib29sZWFuIGhhc0VhZ2VyKExpc3QgcGF0aCwgRmllbGRNYXBwaW5n\nIGZpZWxkKSB7CiAgICAgICAgICAgIGlmIChfcmF3TWFwcGluZ3MgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAg\nIHJlc29sdmUoKTsKICAgICAgICAgICAgaWYgKHBhdGguaXNFbXB0eSgpKQog\nICAgICAgICAgICAgICAgcmV0dXJuIF9mZXRjaEluZm8uZWFnZXIuZ2V0KGZp\nZWxkLmdldEluZGV4KCkpOwogICAgICAgICAgICBpZiAoX2VhZ2VyID09IG51\nbGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAg\nIEZldGNoSW5mbyBpbmZvID0gKEZldGNoSW5mbykgX2VhZ2VyLmdldChwYXRo\nKTsKICAgICAgICAgICAgcmV0dXJuIGluZm8gIT0gbnVsbCAmJiBpbmZvLmVh\nZ2VyLmdldChmaWVsZC5nZXRJbmRleCgpKTsKICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIFJldHVybiB0aGUgZmllbGQgaW5kZXhlcyB0byBl\neGNsdWRlIHdoZW4gbG9hZGluZyBkYXRhIGZvciB0aGUKICAgICAgICAgKiBn\naXZlbiBwYXRoLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBCaXRTZXQg\nZ2V0RXhjbHVkZXMoTGlzdCBwYXRoKSB7CiAgICAgICAgICAgIGlmIChfcmF3\nTWFwcGluZ3MgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICBpZiAocGF0\naC5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICByZXR1cm4gX2ZldGNoSW5m\nby5leGNsdWRlczsKICAgICAgICAgICAgaWYgKF9lYWdlciA9PSBudWxsKQog\nICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIEZldGNo\nSW5mbyBpbmZvID0gKEZldGNoSW5mbykgX2VhZ2VyLmdldChwYXRoKTsKICAg\nICAgICAgICAgcmV0dXJuIChpbmZvID09IG51bGwpID8gbnVsbCA6IGluZm8u\nZXhjbHVkZXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBS\nZXNvbHZlIGludGVybmFsIGRhdGFzdHJ1Y3R1cmVzIGZyb20gcmF3IG1hcHBp\nbmdzLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgc3luY2hyb25pemVk\nIHZvaWQgcmVzb2x2ZSgpIHsKICAgICAgICAgICAgaWYgKF9yYXdNYXBwaW5n\ncyA9PSBudWxsIHx8IF9tYXBwaW5ncyAhPSBudWxsKQogICAgICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICAgICAgX21hcHBpbmdzID0gbmV3IEhhc2hN\nYXAoKTsKICAgICAgICAgICAgX2ZldGNoSW5mbyA9IG5ldyBGZXRjaEluZm8o\nZ2V0Q2FuZGlkYXRlVHlwZU1hcHBpbmcoKSk7CgogICAgICAgICAgICBNYXAu\nRW50cnkgZW50cnk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0g\nX3Jhd01hcHBpbmdzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICAg\nICAgICAgIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBlbnRy\neSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBy\nZXNvbHZlTWFwcGluZygoU3RyaW5nKSBlbnRyeS5nZXRLZXkoKSwgZW50cnku\nZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIFJlc29sdmUgdGhlIGdpdmVuIG1hcHBpbmcgcGF0\naC4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgcmVzb2x2ZU1h\ncHBpbmcoU3RyaW5nIHBhdGgsIE9iamVjdCBpZCkgewogICAgICAgICAgICAv\nLyBidWlsZCB1cCBwYXRoIHRvIHNlY29uZC10by1sYXN0IHRva2VuCiAgICAg\nICAgICAgIFN0cmluZ1tdIHRva2VucyA9IFN0cmluZ3Muc3BsaXQocGF0aCwg\nIi4iLCAwKTsKICAgICAgICAgICAgTGlzdCBycGF0aCA9IG5ldyBBcnJheUxp\nc3QodG9rZW5zLmxlbmd0aCk7CiAgICAgICAgICAgIENsYXNzTWFwcGluZyBj\nYW5kaWRhdGUgPSBnZXRDYW5kaWRhdGVUeXBlTWFwcGluZygpOwogICAgICAg\nICAgICBGaWVsZE1hcHBpbmcgZm0gPSBudWxsOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHRva2Vucy5sZW5ndGggLSAxOyBpKyspIHsKICAg\nICAgICAgICAgICAgIGZtID0gY2FuZGlkYXRlLmdldEZpZWxkTWFwcGluZyh0\nb2tlbnNbaV0pOwogICAgICAgICAgICAgICAgaWYgKGZtID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJiYWQtcGF0aCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nIFF1ZXJ5UmVzdWx0TWFwcGluZy50aGlzLCBfY2FuZGlkYXRlLCBwYXRoKSk7\nCgogICAgICAgICAgICAgICAgaWYgKGZtLmdldEVtYmVkZGVkTWFwcGluZygp\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICByZWNvcmRJbmNsdWRl\nZChjYW5kaWRhdGUsIHJwYXRoLCBmbSk7CiAgICAgICAgICAgICAgICAgICAg\nY2FuZGlkYXRlID0gZm0uZ2V0RW1iZWRkZWRNYXBwaW5nKCk7CiAgICAgICAg\nICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUg\nPSBmbS5nZXRUeXBlTWFwcGluZygpOwogICAgICAgICAgICAgICAgaWYgKGNh\nbmRpZGF0ZSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgidW50cmF2ZXJzYWJsZS1w\nYXRoIiwKICAgICAgICAgICAgICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBw\naW5nLnRoaXMsIF9jYW5kaWRhdGUsIHBhdGgpKTsKICAgICAgICAgICAgICAg\nIHJwYXRoLmFkZChmbSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFN0\ncmluZyBsYXN0VG9rZW4gPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdOwog\nICAgICAgICAgICBpZiAoRElTQ1JJTUlOQVRPUi5lcXVhbHMobGFzdFRva2Vu\nKSkgewogICAgICAgICAgICAgICAgRGlzY3JpbWluYXRvciBkaXNjcmltID0g\nY2FuZGlkYXRlLmdldERpc2NyaW1pbmF0b3IoKTsKICAgICAgICAgICAgICAg\nIHJwYXRoLmFkZChkaXNjcmltKTsKICAgICAgICAgICAgICAgIGFzc2VydFNp\nbmdsZUNvbHVtbihkaXNjcmltLmdldENvbHVtbnMoKSwgcGF0aCk7CiAgICAg\nICAgICAgICAgICBfbWFwcGluZ3MucHV0KHJwYXRoLCBuZXcgU2luZ2xlQ29s\ndW1uTWFwKGlkKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICBGaWVsZE1hcHBpbmcgbGFzdCA9IGNhbmRpZGF0ZS5nZXRGaWVsZE1h\ncHBpbmcobGFzdFRva2VuKTsKICAgICAgICAgICAgICAgIGlmIChsYXN0ID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bnRyYXZlcnNhYmxlLXBhdGgiLAogICAg\nICAgICAgICAgICAgICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcudGhpcywg\nX2NhbmRpZGF0ZSwgcGF0aCkpOwogICAgICAgICAgICAgICAgQ29sdW1uW10g\nY29scyA9IGxhc3QuZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAgaWYg\nKGxhc3QuaXNWZXJzaW9uKCkpCiAgICAgICAgICAgICAgICAgICAgY29scyA9\nIGNhbmRpZGF0ZS5nZXRWZXJzaW9uKCkuZ2V0Q29sdW1ucygpOwogICAgICAg\nICAgICAgICAgYXNzZXJ0U2luZ2xlQ29sdW1uKGNvbHMsIHBhdGgpOwogICAg\nICAgICAgICAgICAgQ29sdW1uIGNvbCA9IGNvbHNbMF07CiAgICAgICAgICAg\nICAgICAKICAgICAgICAgICAgICAgIC8vIHNwZWNpYWwtY2FzZSBvaWQgZmll\nbGRzLCBzaW5jZSBwYXRoIGxpc3RzIHN1cHBsaWVkIGZvcgogICAgICAgICAg\nICAgICAgLy8gdGhlbSBhdCBydW50aW1lIGRvbid0IGluY2x1ZGUgdGhlIGVt\nYmVkZGVkIGZpZWxkcwogICAgICAgICAgICAgICAgaWYgKGZtICE9IG51bGwg\nJiYgZm0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5PSUQp\nIHsKICAgICAgICAgICAgICAgICAgICBhZGRDb21wbGV4Q29sdW1uTWFwcGlu\nZyhmbSwgcnBhdGgsIGNvbCwgaWQpOwogICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAo\nZm0gIT0gbnVsbCAmJiBmbS5nZXRGb3JlaWduS2V5KCkgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBsYXN0IGZpZWxkIGlzIG9u\nZSBvZiB0aGUgam9pbmFibGVzIHVzZWQgaW4gdGhlCiAgICAgICAgICAgICAg\nICAgICAgLy8gcmVsYXRpb24ncyBmb3JlaWduIGtleSwgbWFwIHRvIHJlbGF0\naW9uIGZpZWxkIHBhdGguCiAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3\naXNlLCByZWNvcmQgdGhhdCB3ZSBoYXZlIGFuIGVhZ2VyIHJlc3VsdAogICAg\nICAgICAgICAgICAgICAgIENvbHVtbiBma0NvbCA9IGZtLmdldEZvcmVpZ25L\nZXkoKS5nZXRDb2x1bW4oY29sKTsKICAgICAgICAgICAgICAgICAgICBpZiAo\nZmtDb2wgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ29t\ncGxleENvbHVtbk1hcHBpbmcoZm0sIG5ldyBBcnJheUxpc3QocnBhdGgpLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgZmtDb2wsIGlkKTsKICAgICAg\nICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAg\ncmVjb3JkRWFnZXIoY2FuZGlkYXRlLCBycGF0aCwgZm0pOwogICAgICAgICAg\nICAgICAgICAgICAgICByZWNvcmRJbmNsdWRlZChjYW5kaWRhdGUsIHJwYXRo\nLCBsYXN0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICByZWNvcmRJbmNsdWRlZChj\nYW5kaWRhdGUsIHJwYXRoLCBsYXN0KTsKCiAgICAgICAgICAgICAgICAvLyBt\nYXAgdG8gcmVsYXRlZCBmaWVsZCBwYXRoLiBiZWNhdXNlIHRoZSBTaW5nbGVD\nb2x1bW5NYXAKICAgICAgICAgICAgICAgIC8vIGRvZXNuJ3QgdGVzdCB0aGUg\ncmVxdWVzdGVkIGNvbHVtbiwgaXQgd2lsbCBhY2NlcHQKICAgICAgICAgICAg\nICAgIC8vIHJlcXVlc3RzIGZvciBib3RoIHRoZSBmayBjb2wgb3IgdGhlIHJl\nbGF0ZWQgZmllbGQgY29sCiAgICAgICAgICAgICAgICBycGF0aC5hZGQobGFz\ndCk7CiAgICAgICAgICAgICAgICBfbWFwcGluZ3MucHV0KHJwYXRoLCBuZXcg\nU2luZ2xlQ29sdW1uTWFwKGlkKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIC8qKgogICAgICAgICAqIENyZWF0ZSBhbiBhcHByb3ByaWF0\nZSBjb2x1bW4gbWFwcGluZyBmb3IgdGhlIGdpdmVuIGZpZWxkLgogICAgICAg\nICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBhZGRDb21wbGV4Q29sdW1uTWFw\ncGluZyhGaWVsZE1hcHBpbmcgZm0sIExpc3QgcnBhdGgsCiAgICAgICAgICAg\nIENvbHVtbiBjb2wsIE9iamVjdCBpZCkgewogICAgICAgICAgICBpZiAoZm0u\nZ2V0Q29sdW1ucygpLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgX21h\ncHBpbmdzLnB1dChycGF0aCwgbmV3IFNpbmdsZUNvbHVtbk1hcChpZCkpOwog\nICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIE11bHRpQ29sdW1u\nTWFwIG1jbSA9IChNdWx0aUNvbHVtbk1hcCkgX21hcHBpbmdzLmdldChycGF0\naCk7CiAgICAgICAgICAgICAgICBpZiAobWNtID09IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICBtY20gPSBuZXcgTXVsdGlDb2x1bW5NYXAoZm0uZ2V0\nQ29sdW1ucygpKTsKICAgICAgICAgICAgICAgICAgICBfbWFwcGluZ3MucHV0\nKHJwYXRoLCBtY20pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgbWNtLnNldChjb2wsIGlkKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgLyoqCiAgICAgICAgICogRm9yIG5vdywgd2Ugb25seSBhbGxv\ndyBtYXBwaW5ncyB3aXRoIGEgc2luZ2xlIGNvbHVtbi4gSW4gdGhlCiAgICAg\nICAgICogZnV0dXJlIHdlIG1pZ2h0IGludHJvZHVjZSBhIHN5bnRheCB0byBt\nYXAgbXVsdGlwbGUgY29sdW1ucy4KICAgICAgICAgKi8KICAgICAgICBwcml2\nYXRlIHZvaWQgYXNzZXJ0U2luZ2xlQ29sdW1uKENvbHVtbltdIGNvbHMsIFN0\ncmluZyBwYXRoKSB7CiAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCAhPSAx\nKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJudW0tY29scy1wYXRoIiwKICAgICAgICAgICAgICAgICAg\nICBRdWVyeVJlc3VsdE1hcHBpbmcudGhpcywgX2NhbmRpZGF0ZSwgcGF0aCkp\nOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmVjb3JkIHRo\nYXQgdGhlcmUgbWF5IGJlIGVhZ2VyIGRhdGEgZm9yIHRoZSBnaXZlbiBmaWVs\nZCBhdCB0aGUgZ2l2ZW4KICAgICAgICAgKiBwYXRoLgogICAgICAgICAqLwog\nICAgICAgIHByaXZhdGUgdm9pZCByZWNvcmRFYWdlcihDbGFzc01hcHBpbmcg\nY2FuZGlkYXRlLCBMaXN0IHBhdGgsCiAgICAgICAgICAgIEZpZWxkTWFwcGlu\nZyBmbSkgewogICAgICAgICAgICBpZiAocGF0aC5zaXplKCkgPT0gMSkgewog\nICAgICAgICAgICAgICAgX2ZldGNoSW5mby5lYWdlci5zZXQoZm0uZ2V0SW5k\nZXgoKSk7CiAgICAgICAgICAgICAgICBfZmV0Y2hJbmZvLmV4Y2x1ZGVzLmNs\nZWFyKGZtLmdldEluZGV4KCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICAgICAgLy8gcmVjb3JkIGF0IHByZXZpb3VzIHBhdGgKICAgICAg\nICAgICAgICAgIExpc3QgY29weSA9IG5ldyBBcnJheUxpc3QocGF0aC5zaXpl\nKCkgLSAxKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nY29weS5zaXplKCk7IGkrKykKICAgICAgICAgICAgICAgICAgICBjb3B5LmFk\nZChwYXRoLmdldChpKSk7CgogICAgICAgICAgICAgICAgaWYgKF9lYWdlciA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9lYWdlciA9IG5ldyBIYXNo\nTWFwKCk7CiAgICAgICAgICAgICAgICBGZXRjaEluZm8gaW5mbyA9IChGZXRj\naEluZm8pIF9lYWdlci5nZXQoY29weSk7CiAgICAgICAgICAgICAgICBpZiAo\naW5mbyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IG5l\ndyBGZXRjaEluZm8oY2FuZGlkYXRlKTsKICAgICAgICAgICAgICAgICAgICBf\nZWFnZXIucHV0KGNvcHksIGluZm8pOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgaW5mby5lYWdlci5zZXQoZm0uZ2V0SW5kZXgoKSk7CiAg\nICAgICAgICAgICAgICBpbmZvLmV4Y2x1ZGVzLmNsZWFyKGZtLmdldEluZGV4\nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAg\nICAgICAgKiBSZWNvcmQgdGhhdCB0aGUgZmllbGQgYXQgdGhlIGdpdmVuIHBh\ndGggaXMgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdHMuCiAgICAgICAgICovCiAg\nICAgICAgcHJpdmF0ZSB2b2lkIHJlY29yZEluY2x1ZGVkKENsYXNzTWFwcGlu\nZyBjYW5kaWRhdGUsIExpc3QgcGF0aCwKICAgICAgICAgICAgRmllbGRNYXBw\naW5nIGZtKSB7CiAgICAgICAgICAgIGlmIChwYXRoLmlzRW1wdHkoKSkKICAg\nICAgICAgICAgICAgIF9mZXRjaEluZm8uZXhjbHVkZXMuY2xlYXIoZm0uZ2V0\nSW5kZXgoKSk7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAg\naWYgKF9lYWdlciA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9lYWdl\nciA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgICAgICBGZXRjaEluZm8g\naW5mbyA9IChGZXRjaEluZm8pIF9lYWdlci5nZXQocGF0aCk7CiAgICAgICAg\nICAgICAgICBpZiAoaW5mbyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgaW5mbyA9IG5ldyBGZXRjaEluZm8oY2FuZGlkYXRlKTsKICAgICAgICAg\nICAgICAgICAgICBfZWFnZXIucHV0KG5ldyBBcnJheUxpc3QocGF0aCksIGlu\nZm8pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW5mby5l\neGNsdWRlcy5jbGVhcihmbS5nZXRJbmRleCgpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEZldGNoIGluZm9ybWF0\naW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBGZXRjaElu\nZm8gewoKICAgICAgICAvKioKICAgICAgICAgKiBJbmRleGVzIG9mIGZpZWxk\ncyB0byBleGNsdWRlIGZyb20gbG9hZGluZy4KICAgICAgICAgKi8KICAgICAg\nICBwdWJsaWMgZmluYWwgQml0U2V0IGV4Y2x1ZGVzOwoKICAgICAgICAvKioK\nICAgICAgICAgKiBJbmRleGVzIG9mIGVhZ2VyIGZpZWxkcy4KICAgICAgICAg\nKi8KICAgICAgICBwdWJsaWMgZmluYWwgQml0U2V0IGVhZ2VyOwoKICAgICAg\nICBwdWJsaWMgRmV0Y2hJbmZvKENsYXNzTWFwcGluZyB0eXBlKSB7CiAgICAg\nICAgICAgIEZpZWxkTWFwcGluZ1tdIGZtcyA9IHR5cGUuZ2V0RmllbGRNYXBw\naW5ncygpOwogICAgICAgICAgICBlYWdlciA9IG5ldyBCaXRTZXQoZm1zLmxl\nbmd0aCk7CiAgICAgICAgICAgIGV4Y2x1ZGVzID0gbmV3IEJpdFNldChmbXMu\nbGVuZ3RoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbXMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBpZiAoIWZtc1tpXS5pc1By\naW1hcnlLZXkoKSkKICAgICAgICAgICAgICAgICAgICBleGNsdWRlcy5zZXQo\naSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogTWFwcGluZyBv\nZiBjb2x1bW5zIHRvIHJlc3VsdCBpZHMuCiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIGludGVyZmFjZSBDb2x1bW5NYXAgewoKICAgICAgICAvKioKICAg\nICAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBpZCBmb3IgdGhlIGdpdmVuIGNv\nbHVtbiwgb3IgdGhlIGdpdmVuIGNvbHVtCiAgICAgICAgICogaWYgbm9uZS4K\nICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgT2JqZWN0IG1hcChDb2x1bW4g\nY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIHtAbGluayBDb2x1bW5NYXB9\nIHNwZWNpYWxpemVkIGZvciBhIHNpbmdsZSBjb2x1bW4uCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGNsYXNzIFNpbmdsZUNvbHVtbk1hcAogICAgICAg\nIGltcGxlbWVudHMgQ29sdW1uTWFwIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5h\nbCBPYmplY3QgX2lkOwoKICAgICAgICBwdWJsaWMgU2luZ2xlQ29sdW1uTWFw\nKE9iamVjdCBpZCkgewogICAgICAgICAgICBfaWQgPSBpZDsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBPYmplY3QgbWFwKENvbHVtbiBjb2wpIHsKICAg\nICAgICAgICAgcmV0dXJuIF9pZDsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBfaWQu\ndG9TdHJpbmcoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiB7\nQGxpbmsgQ29sdW1uTWFwfSBzcGVjaWFsaXplZCBmb3IgYSBtdWx0aXBsZSBj\nb2x1bW5zLgogICAgICogTWFwcyBjb2x1bW5zIGluIGxpbmVhciB0aW1lLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBNdWx0aUNvbHVtbk1h\ncAogICAgICAgIGltcGxlbWVudHMgQ29sdW1uTWFwIHsKCiAgICAgICAgcHJp\ndmF0ZSBmaW5hbCBMaXN0IF9jb2xzOwogICAgICAgIHByaXZhdGUgZmluYWwg\nT2JqZWN0W10gX2lkczsKCiAgICAgICAgcHVibGljIE11bHRpQ29sdW1uTWFw\nKENvbHVtbltdIGNvbHMpIHsKICAgICAgICAgICAgX2NvbHMgPSBBcnJheXMu\nYXNMaXN0KGNvbHMpOwogICAgICAgICAgICBfaWRzID0gbmV3IE9iamVjdFtj\nb2xzLmxlbmd0aF07CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0\nIG1hcChDb2x1bW4gY29sKSB7CiAgICAgICAgICAgIGludCBpZHggPSBfY29s\ncy5pbmRleE9mKGNvbCk7CiAgICAgICAgICAgIHJldHVybiAoaWR4ID09IC0x\nKSA/IGNvbCA6IF9pZHNbaWR4XTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyB2b2lkIHNldChDb2x1bW4gY29sLCBPYmplY3QgaWQpIHsKICAgICAgICAg\nICAgaW50IGlkeCA9IF9jb2xzLmluZGV4T2YoY29sKTsKICAgICAgICAgICAg\naWYgKGlkeCAhPSAtMSkKICAgICAgICAgICAgICAgIF9pZHNbaWR4XSA9IGlk\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygp\nIHsKICAgICAgICAgICAgcmV0dXJuIF9jb2xzICsgIj0iICsgQXJyYXlzLmFz\nTGlzdChfaWRzKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

