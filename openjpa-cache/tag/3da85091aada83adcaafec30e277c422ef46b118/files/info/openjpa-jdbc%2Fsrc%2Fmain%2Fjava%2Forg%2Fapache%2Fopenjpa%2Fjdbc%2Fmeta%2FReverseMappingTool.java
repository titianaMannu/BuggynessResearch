{"sha":"b5a76118789957b0113caa224b15c04aa5a82711","node_id":"MDQ6QmxvYjIwNjM2NDpiNWE3NjExODc4OTk1N2IwMTEzY2FhMjI0YjE1YzA0YWE1YTgyNzEx","size":74129,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b5a76118789957b0113caa224b15c04aa5a82711","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uQnVmZmVyZWRSZWFkZXI7CmltcG9ydCBqYXZhLmlvLkZpbGU7\nCmltcG9ydCBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLklucHV0U3RyZWFtOwpp\nbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbVJlYWRlcjsKaW1wb3J0IGphdmEu\naW8uU3RyaW5nV3JpdGVyOwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0Owpp\nbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxp\nbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuVHJlZVNldDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuQXBwbGlj\nYXRpb25JZFRvb2w7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5j\nZS5Db2RlR2VuZXJhdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb25JbXBsOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRnVsbENs\nYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5IYW5kbGVyRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk1heEVtYmVkZGVkQmxv\nYkZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5NYXhFbWJlZGRlZENsb2JGaWVsZFN0cmF0ZWd5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9u\nZURpc2NyaW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlByaW1pdGl2ZUZpZWxkU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5S\nZWxhdGlvbkNvbGxlY3Rpb25JbnZlcnNlS2V5RmllbGRTdHJhdGVneTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlJlbGF0\naW9uQ29sbGVjdGlvblRhYmxlRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlJlbGF0aW9uRmllbGRT\ndHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nc3RyYXRzLlN0YXRlQ29tcGFyaXNvblZlcnNpb25TdHJhdGVneTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlN0cmluZ0Zp\nZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5TdWJjbGFzc0pvaW5EaXNjcmltaW5hdG9yU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5T\ndXBlcmNsYXNzRGlzY3JpbWluYXRvclN0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuU3VwZXJjbGFzc1ZlcnNp\nb25TdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuc3RyYXRzLlZlcnRpY2FsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5QcmltYXJ5S2V5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFH\nZW5lcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuU2NoZW1hR3JvdXA7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zY2hlbWEuU2NoZW1hUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc2NoZW1hLlNjaGVtYXM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc2NoZW1hLlhNTFNjaGVtYVBhcnNlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxFeGNlcHRpb25zOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25z\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkNvZGVGb3JtYXQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuRmlsZXM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhRmFjdG9yeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhTW9kZXM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5Ob25lTWV0YURhdGFGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuUXVlcnlNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlNlcXVlbmNl\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRl\ncm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLk1ldGFEYXRhRXhjZXB0aW9uOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0Ns\nYXNzOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0NsYXNzTG9hZGVyOwppbXBv\ncnQgc2VycC5ieXRlY29kZS5Qcm9qZWN0OwppbXBvcnQgc2VycC51dGlsLlN0\ncmluZ3M7CgovKioKICogUmV2ZXJzZS1tYXBzIGEgc2NoZW1hIGludG8gY2xh\nc3MgbWFwcGluZ3MgYW5kIHRoZSBhc3NpY2lhdGVkIGphdmEKICogY29kZS4g\nR2VuZXJhdGVzIGEgSmF2YSBjb2RlIGZpbGVzIGZvciBwZXJzaXN0ZW50IGNs\nYXNzZXMgYW5kIGFzc29jaWF0ZWQKICogaWRlbnRpdHkgY2xhc3NlcyBhbmQg\nbWV0YWRhdGEuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMg\nY2xhc3MgUmV2ZXJzZU1hcHBpbmdUb29sCiAgICBpbXBsZW1lbnRzIE1ldGFE\nYXRhTW9kZXMsIENsb25lYWJsZSB7CgogICAgLyoqCiAgICAgKiBVbm1hcHBl\nZCB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQg\nVEFCTEVfTk9ORSA9IDA7CgogICAgLyoqCiAgICAgKiBQcmltYXJ5IHRhYmxl\nIGZvciBhIG5ldyBiYXNlIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGludCBUQUJMRV9CQVNFID0gMTsKCiAgICAvKioKICAgICAq\nIFNlY29uZGFyeSB0YWJsZSBvZiBhbiBleGlzdGluZyBjbGFzcy4gVGhlcmUg\naXMgZXhhY3RseSBvbmUgcm93IGluCiAgICAgKiB0aGlzIHRhYmxlIGZvciBl\nYWNoIHJvdyBpbiB0aGUgcHJpbWFyeSB0YWJsZS4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgVEFCTEVfU0VDT05EQVJZID0gMjsKCiAg\nICAvKioKICAgICAqIFNlY29uZGFyeSB0YWJsZSBvZiBhbiBleGlzdGluZyBj\nbGFzcy4gVGhlcmUgaXMgemVybyBvciBvbmUgcm93IGluCiAgICAgKiB0aGlz\nIHRhYmxlIGZvciBlYWNoIHJvdyBpbiB0aGUgcHJpbWFyeSB0YWJsZS4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVEFCTEVfU0VDT05E\nQVJZX09VVEVSID0gMzsKCiAgICAvKioKICAgICAqIEFzc29jaWF0aW9uIHRh\nYmxlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBUQUJM\nRV9BU1NPQ0lBVElPTiA9IDQ7CgogICAgLyoqCiAgICAgKiBTdWJjbGFzcyB0\nYWJsZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVEFC\nTEVfU1VCQ0xBU1MgPSA1OwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIExFVkVMX1BBQ0tBR0UgPSAicGFja2FnZSI7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBMRVZFTF9DTEFTUyA9ICJjbGFzcyI7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZQogICAgICAgIChSZXZlcnNlTWFwcGluZ1Rvb2wuY2xhc3MpOwoK\nICAgIC8vIG1hcCBqYXZhIGtleXdvcmRzIHRvIHJlbGF0ZWQgd29yZHMgdG8g\ndXNlIGluIHRoZWlyIHBsYWNlCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBN\nYXAgX2phdmFLZXl3b3JkcyA9IG5ldyBIYXNoTWFwKCk7CgogICAgc3RhdGlj\nIHsKICAgICAgICBJbnB1dFN0cmVhbSBpbiA9IFJldmVyc2VNYXBwaW5nVG9v\nbC5jbGFzcy5nZXRSZXNvdXJjZUFzU3RyZWFtCiAgICAgICAgICAgICgiamF2\nYS1rZXl3b3Jkcy5yc3JjIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nU3RyaW5nW10ga2V5d29yZHMgPSBTdHJpbmdzLnNwbGl0KG5ldyBCdWZmZXJl\nZFJlYWRlcgogICAgICAgICAgICAgICAgKG5ldyBJbnB1dFN0cmVhbVJlYWRl\ncihpbikpLnJlYWRMaW5lKCksICIsIiwgMCk7CgogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGtleXdvcmRzLmxlbmd0aDsgaSArPSAyKQogICAg\nICAgICAgICAgICAgX2phdmFLZXl3b3Jkcy5wdXQoa2V5d29yZHNbaV0sIGtl\neXdvcmRzW2kgKyAxXSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24g\naW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlv\nbihpb2UpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBpbi5jbG9zZSgpOwogICAgICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgcHJpdmF0ZSBmaW5hbCBKREJDQ29uZmlndXJhdGlvbiBf\nY29uZjsKICAgIHByaXZhdGUgZmluYWwgTG9nIF9sb2c7CiAgICBwcml2YXRl\nIGZpbmFsIE1hcCBfdGFibGVzID0gbmV3IEhhc2hNYXAoKTsKICAgIHByaXZh\ndGUgZmluYWwgUHJvamVjdCBfcHJvamVjdCA9IG5ldyBQcm9qZWN0KCk7CiAg\nICBwcml2YXRlIGZpbmFsIEJDQ2xhc3NMb2FkZXIgX2xvYWRlciA9IG5ldyBC\nQ0NsYXNzTG9hZGVyKF9wcm9qZWN0KTsKICAgIHByaXZhdGUgU3RyYXRlZ3lJ\nbnN0YWxsZXIgX3N0cmF0ID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9w\nYWNrYWdlID0gbnVsbDsKICAgIHByaXZhdGUgRmlsZSBfZGlyID0gbnVsbDsK\nICAgIHByaXZhdGUgTWFwcGluZ1JlcG9zaXRvcnkgX3JlcG9zID0gbnVsbDsK\nICAgIHByaXZhdGUgU2NoZW1hR3JvdXAgX3NjaGVtYSA9IG51bGw7CiAgICBw\ncml2YXRlIGJvb2xlYW4gX251bGxBc09iaiA9IGZhbHNlOwogICAgcHJpdmF0\nZSBib29sZWFuIF9ibG9iQXNPYmogPSBmYWxzZTsKICAgIHByaXZhdGUgUHJv\ncGVydGllcyBfdHlwZU1hcCA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4g\nX3VzZUZLID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX3VzZVNjaGVt\nYSA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9wa09uSm9pbiA9IGZh\nbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9kYXRhc3RvcmUgPSBmYWxzZTsK\nICAgIHByaXZhdGUgYm9vbGVhbiBfYnVpbHRpbiA9IHRydWU7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX2lubmVyID0gZmFsc2U7CiAgICBwcml2YXRlIFN0cmlu\nZyBfaWRTdWZmaXggPSAiSWQiOwogICAgcHJpdmF0ZSBib29sZWFuIF9pbnZl\ncnNlID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZGV0YWNoYWJsZSA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBDb2RlRm9ybWF0IF9mb3JtYXQgPSBudWxs\nOwogICAgcHJpdmF0ZSBSZXZlcnNlQ3VzdG9taXplciBfY3VzdG9tID0gbnVs\nbDsKICAgIHByaXZhdGUgU3RyaW5nIF9kaXNjU3RyYXQgPSBudWxsOwogICAg\ncHJpdmF0ZSBTdHJpbmcgX3ZlcnNTdHJhdCA9IG51bGw7CgogICAgLy8gd2Ug\naGF2ZSB0byB0cmFjayBmaWVsZCBuYW1lcyB0aGF0IHdlcmUgY3JlYXRlZCBi\ndXQgdGhlbiBhYmFuZG9uZWQgYnkKICAgIC8vIHRoZSBjdXN0b21pemVyIHNv\nIHRoYXQgd2UgZG9uJ3QgYXR0ZW1wdCB0byB1c2UgdGhlbSBhZ2FpbjsgZG9p\nbmcgc28gY2FuCiAgICAvLyBtZXNzIHVwIGNlcnRhaW4gY3VzdG9taXplcnMg\nKGJ1ZyA4ODEpCiAgICBwcml2YXRlIFNldCBfYWJhbmRvbmVkRmllbGROYW1l\ncyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5\nIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBSZXZlcnNlTWFw\ncGluZ1Rvb2woSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9j\nb25mID0gY29uZjsKICAgICAgICBfbG9nID0gY29uZi5nZXRMb2coSkRCQ0Nv\nbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgaW50ZXJuYWwgc3RyYXRlZ3kgaW5zdGFsbGVyLgog\nICAgICovCiAgICBwcml2YXRlIFN0cmF0ZWd5SW5zdGFsbGVyIGdldFN0cmF0\nZWd5SW5zdGFsbGVyKCkgewogICAgICAgIGlmIChfc3RyYXQgPT0gbnVsbCkK\nICAgICAgICAgICAgX3N0cmF0ID0gbmV3IFJldmVyc2VTdHJhdGVneUluc3Rh\nbGxlcihnZXRSZXBvc2l0b3J5KCkpOwogICAgICAgIHJldHVybiBfc3RyYXQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbmZpZ3VyYXRp\nb24gcHJvdmlkZWQgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBwdWJs\naWMgSkRCQ0NvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAg\nICAgICByZXR1cm4gX2NvbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIGxvZyB0byB3cml0ZSB0by4KICAgICAqLwogICAgcHVibGljIExv\nZyBnZXRMb2coKSB7CiAgICAgICAgcmV0dXJuIF9sb2c7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGRlZmF1bHQgcGFja2FnZSBmb3IgdGhl\nIGdlbmVyYXRlZCBjbGFzc2VzLCBvciBudWxsIGlmIHVuc2V0LgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIGdldFBhY2thZ2VOYW1lKCkgewogICAgICAg\nIHJldHVybiBfcGFja2FnZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgZGVmYXVsdCBwYWNrYWdlIGZvciB0aGUgZ2VuZXJhdGVkIGNsYXNzZXM7\nIHVzZSBudWxsIHRvCiAgICAgKiBpbmRpY2F0ZSBubyBwYWNrYWdlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRQYWNrYWdlTmFtZShTdHJpbmcgcGFj\na2FnZU5hbWUpIHsKICAgICAgICBfcGFja2FnZSA9IFN0cmluZ1V0aWxzLnRy\naW1Ub051bGwocGFja2FnZU5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGZpbGUgdG8gb3V0cHV0IHRoZSBnZW5lcmF0ZWQgY29kZSB0bywgb3Ig\nbnVsbCBmb3IKICAgICAqIHRoZSBjdXJyZW50IGRpcmVjdG9yeS4gSWYgdGhl\nIGRpcmVjdG9yeSBtYXRjaGVzIHRoZSBwYWNrYWdlLCBpdCB3aWxsCiAgICAg\nKiBiZSB1c2VkLiBPdGhlcndpc2UsIHRoZSBwYWNrYWdlIHN0cnVjdHVyZSB3\naWxsIGJlIGNyZWF0ZWQgdW5kZXIKICAgICAqIHRoaXMgZGlyZWN0b3J5Lgog\nICAgICovCiAgICBwdWJsaWMgRmlsZSBnZXREaXJlY3RvcnkoKSB7CiAgICAg\nICAgcmV0dXJuIF9kaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmls\nZSB0byBvdXRwdXQgdGhlIGdlbmVyYXRlZCBjb2RlIHRvLCBvciBudWxsIGZv\ncgogICAgICogdGhlIGN1cnJlbnQgZGlyZWN0b3J5LiBJZiB0aGUgZGlyZWN0\nb3J5IG1hdGNoZXMgdGhlIHBhY2thZ2UsIGl0IHdpbGwKICAgICAqIGJlIHVz\nZWQuIE90aGVyd2lzZSwgdGhlIHBhY2thZ2Ugc3RydWN0dXJlIHdpbGwgYmUg\nY3JlYXRlZCB1bmRlcgogICAgICogdGhpcyBkaXJlY3RvcnkuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldERpcmVjdG9yeShGaWxlIGRpcikgewogICAg\nICAgIF9kaXIgPSBkaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndHJ1ZSBpZiB0aGUgc2NoZW1hIG5hbWUgd2lsbCBiZSBpbmNsdWRlZCBpbiB0\naGUgZ2VuZXJhdGVkCiAgICAgKiBjbGFzcyBuYW1lIGZvciBlYWNoIHRhYmxl\nLiBEZWZhdWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZ2V0VXNlU2NoZW1hTmFtZSgpIHsKICAgICAgICByZXR1cm4gX3VzZVNj\naGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB3aGV0aGVyIHRoZSBz\nY2hlbWEgbmFtZSB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSBnZW5lcmF0ZWQK\nICAgICAqIGNsYXNzIG5hbWUgZm9yIGVhY2ggdGFibGUuIERlZmF1bHRzIHRv\nIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VTY2hlbWFO\nYW1lKGJvb2xlYW4gdXNlU2NoZW1hKSB7CiAgICAgICAgX3VzZVNjaGVtYSA9\nIHVzZVNjaGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0\naGVyIHRoZSBmb3JlaWduIGtleSBuYW1lIHdpbGwgYmUgdXNlZCB0byBnZW5l\ncmF0ZQogICAgICogcmVsYXRpb24gbmFtZXMuIERlZmF1bHRzIHRvIGZhbHNl\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRVc2VGb3JlaWduS2V5\nTmFtZSgpIHsKICAgICAgICByZXR1cm4gX3VzZUZLOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHdoZXRoZXIgdGhlIGZvcmVpZ24ga2V5IG5hbWUgd2ls\nbCBiZSB1c2VkIHRvIGdlbmVyYXRlCiAgICAgKiByZWxhdGlvbiBuYW1lcy4g\nRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFVzZUZvcmVpZ25LZXlOYW1lKGJvb2xlYW4gdXNlRkspIHsKICAgICAgICBf\ndXNlRksgPSB1c2VGSzsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3\naGV0aGVyIGV2ZW4gbnVsbGFibGUgY29sdW1ucyB3aWxsIGJlIG1hcHBlZCB0\nbyB3cmFwcGVycwogICAgICogcmF0aGVyIHRoYW4gcHJpbWl0aXZlcy4gRGVm\nYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdl\ndE51bGxhYmxlQXNPYmplY3QoKSB7CiAgICAgICAgcmV0dXJuIF9udWxsQXNP\nYmo7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hldGhlciBldmVuIG51\nbGxhYmxlIGNvbHVtbnMgd2lsbCBiZSBtYXBwZWQgdG8gd3JhcHBlcnMKICAg\nICAqIHJhdGhlciB0aGFuIHByaW1pdGl2ZXMuIERlZmF1bHRzIHRvIGZhbHNl\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXROdWxsYWJsZUFzT2JqZWN0\nKGJvb2xlYW4gbnVsbEFzT2JqKSB7CiAgICAgICAgX251bGxBc09iaiA9IG51\nbGxBc09iajsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcmV2\nZXJzZS1tYXAgYmxvYiBjb2x1bW5zIGFzIGNvbnRhaW5pbmcgc2VyaWFsaXpl\nZCBKYXZhCiAgICAgKiBvYmplY3RzLCByYXRoZXIgdGhhbiB0aGUgZGVmYXVs\ndCBvZiB1c2luZyBhIGJ5dGVbXSBmaWVsZC4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gZ2V0QmxvYkFzT2JqZWN0KCkgewogICAgICAgIHJldHVybiBf\nYmxvYkFzT2JqOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBy\nZXZlcnNlLW1hcCBibG9iIGNvbHVtbnMgYXMgY29udGFpbmluZyBzZXJpYWxp\nemVkIEphdmEKICAgICAqIG9iamVjdHMsIHJhdGhlciB0aGFuIHRoZSBkZWZh\ndWx0IG9mIHVzaW5nIGEgYnl0ZVtdIGZpZWxkLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRCbG9iQXNPYmplY3QoYm9vbGVhbiBibG9iQXNPYmopIHsK\nICAgICAgICBfYmxvYkFzT2JqID0gYmxvYkFzT2JqOwogICAgfQoKICAgIC8q\nKgogICAgICogTWFwIG9mIEpEQkMtbmFtZSB0byBKYXZhLXR5cGUtbmFtZSBl\nbnRyaWVzIHRoYXQgYWxsb3dzIGN1c3RvbWl6YXRpb24KICAgICAqIG9mIHJl\ndmVyc2UgbWFwcGluZyBjb2x1bW5zIHRvIGZpZWxkIHR5cGVzLgogICAgICov\nCiAgICBwdWJsaWMgUHJvcGVydGllcyBnZXRUeXBlTWFwKCkgewogICAgICAg\nIHJldHVybiBfdHlwZU1hcDsKICAgIH0KCiAgICAvKioKICAgICAqIE1hcCBv\nZiBKREJDLW5hbWUgdG8gSmF2YS10eXBlLW5hbWUgZW50cmllcyB0aGF0IGFs\nbG93cyBjdXN0b21pemF0aW9uCiAgICAgKiBvZiByZXZlcnNlIG1hcHBpbmcg\nY29sdW1ucyB0byBmaWVsZCB0eXBlcy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0VHlwZU1hcChQcm9wZXJ0aWVzIHR5cGVNYXApIHsKICAgICAgICBf\ndHlwZU1hcCA9IHR5cGVNYXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdHJ1ZSBpZiBqb2luIHRhYmxlcyBhcmUgYWxsb3dlZCB0byBoYXZlIHBy\naW1hcnkga2V5cywgZmFsc2UKICAgICAqIGlmIGFsbCBwcmltYXJ5IGtleSB0\nYWJsZXMgd2lsbCBiZSBtYXBwZWQgYXMgcGVyc2lzdGVudCBjbGFzc2VzLgog\nICAgICogRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGdldFByaW1hcnlLZXlPbkpvaW4oKSB7CiAgICAgICAgcmV0dXJu\nIF9wa09uSm9pbjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVl\nIGlmIGpvaW4gdGFibGVzIGFyZSBhbGxvd2VkIHRvIGhhdmUgcHJpbWFyeSBr\nZXlzLCBmYWxzZQogICAgICogaWYgYWxsIHByaW1hcnkga2V5IHRhYmxlcyB3\naWxsIGJlIG1hcHBlZCBhcyBwZXJzaXN0ZW50IGNsYXNzZXMuCiAgICAgKiBE\nZWZhdWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nUHJpbWFyeUtleU9uSm9pbihib29sZWFuIHBrT25Kb2luKSB7CiAgICAgICAg\nX3BrT25Kb2luID0gcGtPbkpvaW47CiAgICB9CgogICAgLyoqCiAgICAgKiBX\naGV0aGVyIHRvIHVzZSBkYXRhc3RvcmUgaWRlbnRpdHkgd2hlbiBwb3NzaWJs\nZS4gRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGdldFVzZURhdGFTdG9yZUlkZW50aXR5KCkgewogICAgICAgIHJldHVy\nbiBfZGF0YXN0b3JlOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\nbyB1c2UgZGF0YXN0b3JlIGlkZW50aXR5IHdoZW4gcG9zc2libGUuIERlZmF1\nbHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VE\nYXRhU3RvcmVJZGVudGl0eShib29sZWFuIGRhdGFzdG9yZSkgewogICAgICAg\nIF9kYXRhc3RvcmUgPSBkYXRhc3RvcmU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRvIHVzZSBidWlsdCBpbiBpZGVudGl0eSBjbGFzc2VzIHdo\nZW4gcG9zc2libGUuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGdldFVzZUJ1aWx0aW5JZGVudGl0eUNsYXNzKCkgewog\nICAgICAgIHJldHVybiBfYnVpbHRpbjsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gdXNlIGJ1aWx0IGluIGlkZW50aXR5IGNsYXNzZXMgd2hl\nbiBwb3NzaWJsZS4gRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0VXNlQnVpbHRpbklkZW50aXR5Q2xhc3MoYm9vbGVhbiBi\ndWlsdGluKSB7CiAgICAgICAgX2J1aWx0aW4gPSBidWlsdGluOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciBvciBub3QgdG8gZ2VuZXJhdGUgaW5u\nZXIgY2xhc3NlcyB3aGVuIGNyZWF0aW5nIGFwcGxpY2F0aW9uCiAgICAgKiBp\nZGVudGl0eSBjbGFzc2VzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRJbm5lcklkZW50aXR5Q2xhc3NlcygpIHsKICAgICAgICByZXR1cm4gX2lu\nbmVyOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBvciBub3QgdG8g\nZ2VuZXJhdGUgaW5uZXIgY2xhc3NlcyB3aGVuIGNyZWF0aW5nIGFwcGxpY2F0\naW9uCiAgICAgKiBpZGVudGl0eSBjbGFzc2VzLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJbm5lcklkZW50aXR5Q2xhc3Nlcyhib29sZWFuIGlubmVy\nKSB7CiAgICAgICAgX2lubmVyID0gaW5uZXI7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdWZmaXggdXNlZCB0byBjcmVhdGUgYXBwbGljYXRpb24gaWRlbnRp\ndHkgY2xhc3MgbmFtZSBmcm9tIGEgY2xhc3MgbmFtZSwKICAgICAqIG9yIGlu\nIHRoZSBjYXNlIG9mIGlubmVyIGlkZW50aXR5IGNsYXNzZXMsIHRoZSBpbm5l\nciBjbGFzcyBuYW1lLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldElk\nZW50aXR5Q2xhc3NTdWZmaXgoKSB7CiAgICAgICAgcmV0dXJuIF9pZFN1ZmZp\neDsKICAgIH0KCiAgICAvKioKICAgICAqIFN1ZmZpeCB1c2VkIHRvIGNyZWF0\nZSBhcHBsaWNhdGlvbiBpZGVudGl0eSBjbGFzcyBuYW1lIGZyb20gYSBjbGFz\ncyBuYW1lLAogICAgICogb3IgaW4gdGhlIGNhc2Ugb2YgaW5uZXIgaWRlbnRp\ndHkgY2xhc3NlcywgdGhlIGlubmVyIGNsYXNzIG5hbWUuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldElkZW50aXR5Q2xhc3NTdWZmaXgoU3RyaW5nIHN1\nZmZpeCkgewogICAgICAgIF9pZFN1ZmZpeCA9IHN1ZmZpeDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgdG8gZ2VuZXJhdGUgaW52ZXJzZSAxLW1h\nbnkvMS0xIHJlbGF0aW9ucyBmb3IgYWxsIG1hbnktMS8xLTEKICAgICAqIHJl\nbGF0aW9ucy4gRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gZ2V0SW52ZXJzZVJlbGF0aW9ucygpIHsKICAgICAgICByZXR1\ncm4gX2ludmVyc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRv\nIGdlbmVyYXRlIGludmVyc2UgMS1tYW55LzEtMSByZWxhdGlvbnMgZm9yIGFs\nbCBtYW55LTEvMS0xCiAgICAgKiByZWxhdGlvbnMuIERlZmF1bHRzIHRvIHRy\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEludmVyc2VSZWxhdGlv\nbnMoYm9vbGVhbiBpbnZlcnNlKSB7CiAgICAgICAgX2ludmVyc2UgPSBpbnZl\ncnNlOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBtYWtlIGdl\nbmVyYXRlZCBjbGFzc2VzIGRldGFjaGFibGUuIERlZmF1bHRzIHRvIGZhbHNl\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXREZXRhY2hhYmxlKCkg\newogICAgICAgIHJldHVybiBfZGV0YWNoYWJsZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZXRoZXIgdG8gbWFrZSBnZW5lcmF0ZWQgY2xhc3NlcyBkZXRh\nY2hhYmxlLiBEZWZhdWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0RGV0YWNoYWJsZShib29sZWFuIGRldGFjaGFibGUpIHsKICAg\nICAgICBfZGV0YWNoYWJsZSA9IGRldGFjaGFibGU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBEZWZhdWx0IGRpc2NyaW1pbmF0b3Igc3RyYXRlZ3kgZm9yIGJh\nc2UgY2xhc3MgbWFwcGluZ3MuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0RGlzY3JpbWluYXRvclN0cmF0ZWd5KCkgewogICAgICAgIHJldHVybiBf\nZGlzY1N0cmF0OwogICAgfQoKICAgIC8qKgogICAgICogRGVmYXVsdCBkaXNj\ncmltaW5hdG9yIHN0cmF0ZWd5IGZvciBiYXNlIGNsYXNzIG1hcHBpbmdzLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREaXNjcmltaW5hdG9yU3RyYXRl\nZ3koU3RyaW5nIGRpc2NTdHJhdCkgewogICAgICAgIF9kaXNjU3RyYXQgPSBk\naXNjU3RyYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IHZlcnNp\nb24gc3RyYXRlZ3kgZm9yIGJhc2UgY2xhc3MgbWFwcGluZ3MuCiAgICAgKi8K\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmVyc2lvblN0cmF0ZWd5KCkgewogICAg\nICAgIHJldHVybiBfdmVyc1N0cmF0OwogICAgfQoKICAgIC8qKgogICAgICog\nRGVmYXVsdCB2ZXJzaW9uIHN0cmF0ZWd5IGZvciBiYXNlIGNsYXNzIG1hcHBp\nbmdzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRWZXJzaW9uU3RyYXRl\nZ3koU3RyaW5nIHZlcnNpb25TdHJhdCkgewogICAgICAgIF92ZXJzU3RyYXQg\nPSB2ZXJzaW9uU3RyYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgY29k\nZSBmb3JtYXR0ZXIgZm9yIHRoZSBnZW5lcmF0ZWQgSmF2YSBjb2RlLgogICAg\nICovCiAgICBwdWJsaWMgQ29kZUZvcm1hdCBnZXRDb2RlRm9ybWF0KCkgewog\nICAgICAgIHJldHVybiBfZm9ybWF0OwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBjb2RlIGZvcm1hdHRlciBmb3IgdGhlIGdlbmVyYXRlZCBKYXZh\nIGNvZGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldENvZGVGb3JtYXQo\nQ29kZUZvcm1hdCBmb3JtYXQpIHsKICAgICAgICBfZm9ybWF0ID0gZm9ybWF0\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjdXN0b21pemVy\nIGluIHVzZSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMg\nUmV2ZXJzZUN1c3RvbWl6ZXIgZ2V0Q3VzdG9taXplcigpIHsKICAgICAgICBy\nZXR1cm4gX2N1c3RvbTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUg\nY3VzdG9taXplci4gVGhlIGNvbmZpZ3VyYXRpb24gb24gdGhlIGN1c3RvbWl6\nZXIsIGlmIGFueSwKICAgICAqIHNob3VsZCBhbHJlYWR5IGJlIHNldC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0Q3VzdG9taXplcihSZXZlcnNlQ3Vz\ndG9taXplciBjdXN0b21pemVyKSB7CiAgICAgICAgaWYgKGN1c3RvbWl6ZXIg\nIT0gbnVsbCkKICAgICAgICAgICAgY3VzdG9taXplci5zZXRUb29sKHRoaXMp\nOwogICAgICAgIF9jdXN0b20gPSBjdXN0b21pemVyOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBtYXBwaW5nIHJlcG9zaXRvcnkgdXNlZCB0\nbyBob2xkIGdlbmVyYXRlZCBtYXBwaW5ncy4gWW91CiAgICAgKiBjYW4gYWxz\nbyB1c2UgdGhlIHJlcG9zaXRvcnkgdG8gc2VlZCB0aGUgc2NoZW1hIGdyb3Vw\nIHRvIGdlbmVyYXRlCiAgICAgKiBjbGFzc2VzIGZyb20uCiAgICAgKi8KICAg\nIHB1YmxpYyBNYXBwaW5nUmVwb3NpdG9yeSBnZXRSZXBvc2l0b3J5KCkgewog\nICAgICAgIGlmIChfcmVwb3MgPT0gbnVsbCkgewogICAgICAgICAgICAvLyBj\ncmVhdGUgZW1wdHkgcmVwb3NpdG9yeQogICAgICAgICAgICBfcmVwb3MgPSBf\nY29uZi5uZXdNYXBwaW5nUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICAgICAg\nICAgIF9yZXBvcy5zZXRNZXRhRGF0YUZhY3RvcnkoTm9uZU1ldGFEYXRhRmFj\ndG9yeS5nZXRJbnN0YW5jZSgpKTsKICAgICAgICAgICAgX3JlcG9zLnNldE1h\ncHBpbmdEZWZhdWx0cyhOb25lTWFwcGluZ0RlZmF1bHRzLmdldEluc3RhbmNl\nKCkpOwogICAgICAgICAgICBfcmVwb3Muc2V0UmVzb2x2ZShNT0RFX05PTkUp\nOwogICAgICAgICAgICBfcmVwb3Muc2V0VmFsaWRhdGUoX3JlcG9zLlZBTElE\nQVRFX05PTkUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX3JlcG9zOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSByZXBvc2l0b3J5IHRvIHVz\nZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVwb3NpdG9yeShNYXBw\naW5nUmVwb3NpdG9yeSByZXBvcykgewogICAgICAgIF9yZXBvcyA9IHJlcG9z\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzY2hlbWEgZ3Jv\ndXAgdG8gcmV2ZXJzZSBtYXAuIElmIG5vbmUgaGFzIGJlZW4gc2V0LCB0aGUK\nICAgICAqIHNjaGVtYSB3aWxsIGJlIGdlbmVyYXRlZCBmcm9tIHRoZSBkYXRh\nYmFzZS4KICAgICAqLwogICAgcHVibGljIFNjaGVtYUdyb3VwIGdldFNjaGVt\nYUdyb3VwKCkgewogICAgICAgIGlmIChfc2NoZW1hID09IG51bGwpIHsKICAg\nICAgICAgICAgU2NoZW1hR2VuZXJhdG9yIGdlbiA9IG5ldyBTY2hlbWFHZW5l\ncmF0b3IoX2NvbmYpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgZ2VuLmdlbmVyYXRlU2NoZW1hcygpOwogICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIHRocm93IFNR\nTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsCiAgICAgICAgICAgICAgICAgICAg\nX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKSk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgX3NjaGVtYSA9IGdlbi5nZXRTY2hlbWFHcm91cCgp\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX3NjaGVtYTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCB0aGUgc2NoZW1hIHRvIHJldmVyc2UgbWFwLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hlbWFHcm91cChTY2hlbWFH\ncm91cCBzY2hlbWEpIHsKICAgICAgICBfc2NoZW1hID0gc2NoZW1hOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBnZW5lcmF0ZWQgbWFwcGlu\nZ3MuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01hcHBpbmdbXSBnZXRNYXBw\naW5ncygpIHsKICAgICAgICByZXR1cm4gZ2V0UmVwb3NpdG9yeSgpLmdldE1h\ncHBpbmdzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZW5lcmF0ZSBtYXBw\naW5ncyBhbmQgY2xhc3MgY29kZSBmb3IgdGhlIGN1cnJlbnQgc2NoZW1hIGdy\nb3VwLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAg\nLy8gbWFwIGJhc2UgY2xhc3NlcyBmaXJzdAogICAgICAgIFNjaGVtYVtdIHNj\naGVtYXMgPSBnZXRTY2hlbWFHcm91cCgpLmdldFNjaGVtYXMoKTsKICAgICAg\nICBUYWJsZVtdIHRhYmxlczsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGFibGVzID0g\nc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAgICAgZm9yIChpbnQg\naiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKyspCiAgICAgICAgICAgICAg\nICBpZiAoaXNCYXNlVGFibGUodGFibGVzW2pdKSkKICAgICAgICAgICAgICAg\nICAgICBtYXBCYXNlQ2xhc3ModGFibGVzW2pdKTsKICAgICAgICB9CgogICAg\nICAgIC8vIG1hcCB2ZXJ0aWNhbCBzdWJjbGFzc2VzCiAgICAgICAgU2V0IHN1\nYnMgPSBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1h\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFz\nW2ldLmdldFRhYmxlcygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsg\naiA8IHRhYmxlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYg\nKCFfdGFibGVzLmNvbnRhaW5zS2V5KHRhYmxlc1tqXSkKICAgICAgICAgICAg\nICAgICAgICAmJiBnZXRTZWNvbmRhcnlUeXBlKHRhYmxlc1tqXSwgZmFsc2Up\nID09IFRBQkxFX1NVQkNMQVNTKSB7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKHN1YnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgc3VicyA9\nIG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgICAgICAgICAgc3Vicy5hZGQo\ndGFibGVzW2pdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBpZiAoc3VicyAhPSBudWxsKQogICAgICAgICAg\nICBtYXBTdWJjbGFzc2VzKHN1YnMpOwoKICAgICAgICAvLyBtYXAgZmllbGRz\nIGluIHRoZSBwcmltYXJ5IHRhYmxlcyBvZiB0aGUgY2xhc3NlcwogICAgICAg\nIENsYXNzTWFwcGluZyBjbHM7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSBfdGFibGVzLnZhbHVlcygpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgIGNscyA9IChDbGFzc01hcHBpbmcpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIG1hcENvbHVtbnMoY2xzLCBjbHMuZ2V0VGFibGUo\nKSwgbnVsbCwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gbWFwIGFz\nc29jaWF0aW9uIHRhYmxlcywgam9pbiB0YWJsZXMsIGFuZCBzZWNvbmRhcnkg\ndGFibGVzCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRhYmxlcyA9IHNjaGVtYXNbaV0u\nZ2V0VGFibGVzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwg\ndGFibGVzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgaWYgKCFfdGFi\nbGVzLmNvbnRhaW5zS2V5KHRhYmxlc1tqXSkpCiAgICAgICAgICAgICAgICAg\nICAgbWFwVGFibGUodGFibGVzW2pdLCBnZXRTZWNvbmRhcnlUeXBlKHRhYmxl\nc1tqXSwgZmFsc2UpKTsKICAgICAgICB9CgogICAgICAgIC8vIG1hcCBkaXNj\ncmltaW5hdG9ycyBhbmQgdmVyc2lvbnMsIG1ha2Ugc3VyZSBpZGVudGl0eSB0\neXBlIGlzIGNvcnJlY3QsCiAgICAgICAgLy8gc2V0IHNpbXBsZSBmaWVsZCBj\nb2x1bW4gamF2YSB0eXBlcywgYW5kIHJlZiBzY2hlbWEgY29tcG9uZW50cyBz\nbwogICAgICAgIC8vIHdlIGNhbiB0ZWxsIHdoYXQgaXMgdW5tYXBwZWQKICAg\nICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHM7CiAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSBfdGFibGVzLnZhbHVlcygpLml0ZXJhdG9yKCk7IGl0ci5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGNscyA9IChDbGFzc01hcHBpbmcp\nIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGNscy5yZWZTY2hlbWFDb21wb25l\nbnRzKCk7CiAgICAgICAgICAgIGlmIChjbHMuZ2V0RGlzY3JpbWluYXRvcigp\nLmdldFN0cmF0ZWd5KCkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGdldFN0\ncmF0ZWd5SW5zdGFsbGVyKCkuaW5zdGFsbFN0cmF0ZWd5CiAgICAgICAgICAg\nICAgICAgICAgKGNscy5nZXREaXNjcmltaW5hdG9yKCkpOwogICAgICAgICAg\nICBjbHMuZ2V0RGlzY3JpbWluYXRvcigpLnJlZlNjaGVtYUNvbXBvbmVudHMo\nKTsKICAgICAgICAgICAgaWYgKGNscy5nZXRWZXJzaW9uKCkuZ2V0U3RyYXRl\nZ3koKSA9PSBudWxsKQogICAgICAgICAgICAgICAgZ2V0U3RyYXRlZ3lJbnN0\nYWxsZXIoKS5pbnN0YWxsU3RyYXRlZ3koY2xzLmdldFZlcnNpb24oKSk7CiAg\nICAgICAgICAgIGNscy5nZXRWZXJzaW9uKCkucmVmU2NoZW1hQ29tcG9uZW50\ncygpOwoKICAgICAgICAgICAgLy8gZG91YmxlLWNoZWNrIGlkZW50aXR5IHR5\ncGU7IGlmIGl0IHdhcyBzZXQgZm9yIGJ1aWx0aW4gaWRlbnRpdHkKICAgICAg\nICAgICAgLy8gaXQgbWlnaHQgaGF2ZSB0byBzd2l0Y2ggdG8gc3RkIGFwcGxp\nY2F0aW9uIGlkZW50aXR5IGlmIHBrIGZpZWxkCiAgICAgICAgICAgIC8vIG5v\ndCBjb21wYXRpYmxlCiAgICAgICAgICAgIGlmIChjbHMuZ2V0UENTdXBlcmNs\nYXNzKCkgPT0gbnVsbAogICAgICAgICAgICAgICAgJiYgY2xzLmdldElkZW50\naXR5VHlwZSgpID09IENsYXNzTWFwcGluZy5JRF9BUFBMSUNBVElPTikgewog\nICAgICAgICAgICAgICAgaWYgKGNscy5nZXRQcmltYXJ5S2V5RmllbGRzKCku\nbGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1l\ndGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1way1maWVsZHMiLCBjbHMp\nKTsKICAgICAgICAgICAgICAgIGlmIChjbHMuZ2V0T2JqZWN0SWRUeXBlKCkg\nPT0gbnVsbAogICAgICAgICAgICAgICAgICAgIHx8IChjbHMuaXNPcGVuSlBB\nSWRlbnRpdHkoKSAmJiAhaXNCdWlsdGluSWRlbnRpdHkoY2xzKSkpCiAgICAg\nICAgICAgICAgICAgICAgc2V0T2JqZWN0SWRUeXBlKGNscyk7CiAgICAgICAg\nICAgIH0gZWxzZSBpZiAoY2xzLmdldElkZW50aXR5VHlwZSgpID09IENsYXNz\nTWFwcGluZy5JRF9EQVRBU1RPUkUpCiAgICAgICAgICAgICAgICBjbHMuZ2V0\nUHJpbWFyeUtleUNvbHVtbnMoKVswXS5zZXRKYXZhVHlwZShKYXZhVHlwZXMu\nTE9ORyk7CgogICAgICAgICAgICAvLyBzZXQgamF2YSB0eXBlcyBmb3Igc2lt\ncGxlIGZpZWxkczsKICAgICAgICAgICAgZmllbGRzID0gY2xzLmdldERlY2xh\ncmVkRmllbGRNYXBwaW5ncygpOwogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAg\nZmllbGRzW2ldLnJlZlNjaGVtYUNvbXBvbmVudHMoKTsKICAgICAgICAgICAg\nICAgIHNldENvbHVtbkphdmFUeXBlKGZpZWxkc1tpXSk7CiAgICAgICAgICAg\nICAgICBzZXRDb2x1bW5KYXZhVHlwZShmaWVsZHNbaV0uZ2V0RWxlbWVudE1h\ncHBpbmcoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8v\nIHNldCB0aGUgamF2YSB0eXBlcyBvZiBmb3JlaWduIGtleSBjb2x1bW5zOyB3\nZSBjb3VsZG4ndCBkbyB0aGlzCiAgICAgICAgLy8gZWFybGllciBiZWNhdXNl\nIHdlIHJlbHkgb24gdGhlIGxpbmtlZC10byBjb2x1bW5zIHRvIGRvIGl0CiAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfdGFibGVzLnZhbHVlcygpLml0\nZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGNscyA9\nIChDbGFzc01hcHBpbmcpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIHNldEZv\ncmVpZ25LZXlKYXZhVHlwZShjbHMuZ2V0Sm9pbkZvcmVpZ25LZXkoKSk7Cgog\nICAgICAgICAgICBmaWVsZHMgPSBjbHMuZ2V0RGVjbGFyZWRGaWVsZE1hcHBp\nbmdzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBzZXRGb3JlaWduS2V5\nSmF2YVR5cGUoZmllbGRzW2ldLmdldEpvaW5Gb3JlaWduS2V5KCkpOwogICAg\nICAgICAgICAgICAgc2V0Rm9yZWlnbktleUphdmFUeXBlKGZpZWxkc1tpXS5n\nZXRGb3JlaWduS2V5KCkpOwogICAgICAgICAgICAgICAgc2V0Rm9yZWlnbktl\neUphdmFUeXBlKGZpZWxkc1tpXS5nZXRFbGVtZW50TWFwcGluZygpLgogICAg\nICAgICAgICAgICAgICAgIGdldEZvcmVpZ25LZXkoKSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIC8vIGFsbG93IGN1c3RvbWl6ZXIgdG8g\nbWFwIHVubWFwcGVkIHRhYmxlcywgYW5kIHdhcm4gYWJvdXQgYW55dGhpbmcK\nICAgICAgICAvLyB0aGF0IGVuZHMgdXAgdW5tYXBwZWQKICAgICAgICBDb2x1\nbW5bXSBjb2xzOwogICAgICAgIENvbGxlY3Rpb24gdW5tYXBwZWRDb2xzID0g\nbmV3IEFycmF5TGlzdCg1KTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGFibGVzID0g\nc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAgICAgZm9yIChpbnQg\naiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAg\nICAgIHVubWFwcGVkQ29scy5jbGVhcigpOwogICAgICAgICAgICAgICAgY29s\ncyA9IHRhYmxlc1tqXS5nZXRDb2x1bW5zKCk7CiAgICAgICAgICAgICAgICBm\nb3IgKGludCBrID0gMDsgayA8IGNvbHMubGVuZ3RoOyBrKyspCiAgICAgICAg\nICAgICAgICAgICAgaWYgKGNvbHNba10uZ2V0UmVmQ291bnQoKSA9PSAwKQog\nICAgICAgICAgICAgICAgICAgICAgICB1bm1hcHBlZENvbHMuYWRkKGNvbHNb\na10pOwoKICAgICAgICAgICAgICAgIGlmICh1bm1hcHBlZENvbHMuc2l6ZSgp\nID09IGNvbHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKF9j\ndXN0b20gPT0gbnVsbCB8fCAhX2N1c3RvbS51bm1hcHBlZFRhYmxlKHRhYmxl\nc1tqXSkpCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9j\nLmdldCgidW5tYXAtdGFibGUiLCB0YWJsZXNbal0pKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSBpZiAodW5tYXBwZWRDb2xzLnNpemUoKSA+IDApCiAgICAg\nICAgICAgICAgICAgICAgX2xvZy5pbmZvKF9sb2MuZ2V0KCJ1bm1hcC1jb2xz\nIiwgdGFibGVzW2pdLCB1bm1hcHBlZENvbHMpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxsKQogICAgICAg\nICAgICBfY3VzdG9tLmNsb3NlKCk7CgogICAgICAgIC8vIHJlc29sdmUgbWFw\ncGluZ3MKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF90YWJsZXMudmFs\ndWVzKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAg\nICgoQ2xhc3NNYXBwaW5nKSBpdHIubmV4dCgpKS5yZXNvbHZlKE1PREVfTUVU\nQSB8IE1PREVfTUFQUElORyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXAg\ndGhlIHRhYmxlIG9mIHRoZSBnaXZlbiB0eXBlLgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgbWFwVGFibGUoVGFibGUgdGFibGUsIGludCB0eXBlKSB7CiAg\nICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgVEFCTEVf\nU0VDT05EQVJZOgogICAgICAgICAgICBjYXNlIFRBQkxFX1NFQ09OREFSWV9P\nVVRFUjoKICAgICAgICAgICAgICAgIG1hcFNlY29uZGFyeVRhYmxlKHRhYmxl\nLCB0eXBlICE9IFRBQkxFX1NFQ09OREFSWSk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBUQUJMRV9BU1NPQ0lBVElPTjoKICAg\nICAgICAgICAgICAgIG1hcEFzc29jaWF0aW9uVGFibGUodGFibGUpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGNsYXNzIGlzIGNvbXBh\ndGlibGUgd2l0aCBidWlsdGluIGlkZW50aXR5LgogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBib29sZWFuIGlzQnVpbHRpbklkZW50aXR5KENsYXNzTWFw\ncGluZyBjbHMpIHsKICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHMgPSBj\nbHMuZ2V0UHJpbWFyeUtleUZpZWxkTWFwcGluZ3MoKTsKICAgICAgICBpZiAo\nZmllbGRzLmxlbmd0aCAhPSAxKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgc3dpdGNoIChmaWVsZHNbMF0uZ2V0RGVjbGFyZWRUeXBlQ29k\nZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLklOVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9O\nRzoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuSU5UX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9OR19P\nQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUX09CSjoKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5PSUQ6CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBKYXZhIHR5cGUgb2YgdGhlIGNvbHVtbiBm\nb3IgdGhlIGdpdmVuIHZhbHVlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyB2b2lkIHNldENvbHVtbkphdmFUeXBlKFZhbHVlTWFwcGluZyB2bSkgewog\nICAgICAgIENvbHVtbltdIGNvbHMgPSB2bS5nZXRDb2x1bW5zKCk7CiAgICAg\nICAgaWYgKGNvbHMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIGNvbHNbMF0u\nc2V0SmF2YVR5cGUodm0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgSmF2YSB0eXBlIG9mIHRoZSBmb3Jl\naWduIGtleSBjb2x1bW5zLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIHNldEZvcmVpZ25LZXlKYXZhVHlwZShGb3JlaWduS2V5IGZrKSB7CiAg\nICAgICAgaWYgKGZrID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gZmsuZ2V0Q29sdW1ucygpOwogICAgICAg\nIENvbHVtbltdIHBrcyA9IGZrLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBpZiAoY29sc1tpXS5nZXRKYXZhVHlwZSgpID09IEphdmFU\neXBlcy5PQkpFQ1QpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNldEphdmFU\neXBlKHBrc1tpXS5nZXRKYXZhVHlwZSgpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFVzZXMge0BsaW5rIENvZGVHZW5lcmF0b3J9cyB0byB3cml0ZSB0aGUg\nSmF2YSBjb2RlIGZvciB0aGUgZ2VuZXJhdGVkCiAgICAgKiBtYXBwaW5ncyB0\nbyB0aGUgcHJvcGVyIHBhY2thZ2VzLgogICAgICoKICAgICAqIEByZXR1cm4g\nYSBsaXN0IG9mIHtAbGluayBGaWxlfSBpbnN0YW5jZXMgdGhhdCB3ZXJlIHdy\naXR0ZW4KICAgICAqLwogICAgcHVibGljIExpc3QgcmVjb3JkQ29kZSgpCiAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcmVj\nb3JkQ29kZShudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIHRo\nZSBjb2RlIGZvciB0aGUgdG9vbC4KICAgICAqCiAgICAgKiBAcGFyYW0gb3V0\ncHV0IGlmIG51bGwsIHRoZW4gcGVyZm9ybSB0aGUgd3JpdGUgZGlyZWN0bHkK\nICAgICAqIHRvIHRoZSBmaWxlc3lzdGVtOyBvdGhlcndpc2UsIHBvcHVsYXRl\nIHRoZQogICAgICogc3BlY2lmaWVkIG1hcCB3aXRoIGtleXMgYXMgdGhlIGdl\nbmVyYXRlZAogICAgICoge0BsaW5rIENsYXNzTWFwcGluZ30gYW5kIHZhbHVl\ncyBhcyBhCiAgICAgKiB7QGxpbmsgU3RyaW5nfSB0aGF0IGNvbnRhaW5zIHRo\nZSBnZW5lcmF0ZWQgY29kZQogICAgICogQHJldHVybiBhIGxpc3Qgb2Yge0Bs\naW5rIEZpbGV9IGluc3RhbmNlcyB0aGF0IHdlcmUgd3JpdHRlbgogICAgICov\nCiAgICBwdWJsaWMgTGlzdCByZWNvcmRDb2RlKE1hcCBvdXRwdXQpCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBMaXN0IHdyaXR0ZW4g\nPSBuZXcgTGlua2VkTGlzdCgpOwoKICAgICAgICBDbGFzc01hcHBpbmdbXSBt\nYXBwaW5ncyA9IGdldE1hcHBpbmdzKCk7CiAgICAgICAgUmV2ZXJzZUNvZGVH\nZW5lcmF0b3IgZ2VuOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFw\ncGluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKF9sb2cuaXNJ\nbmZvRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xvZy5pbmZvKF9sb2Mu\nZ2V0KCJjbGFzcy1jb2RlIiwgbWFwcGluZ3NbaV0pKTsKCiAgICAgICAgICAg\nIEFwcGxpY2F0aW9uSWRUb29sIGFpZCA9IG5ld0FwcGxpY2F0aW9uSWRUb29s\nKG1hcHBpbmdzW2ldKTsKICAgICAgICAgICAgZ2VuID0gbmV3IFJldmVyc2VD\nb2RlR2VuZXJhdG9yKG1hcHBpbmdzW2ldLCBhaWQpOwogICAgICAgICAgICBn\nZW4uZ2VuZXJhdGVDb2RlKCk7CgogICAgICAgICAgICBpZiAob3V0cHV0ID09\nIG51bGwpIHsKICAgICAgICAgICAgICAgIGdlbi53cml0ZUNvZGUoKTsKICAg\nICAgICAgICAgICAgIHdyaXR0ZW4uYWRkKGdlbi5nZXRGaWxlKCkpOwogICAg\nICAgICAgICAgICAgaWYgKGFpZCAhPSBudWxsICYmICFhaWQuaXNJbm5lckNs\nYXNzKCkpCiAgICAgICAgICAgICAgICAgICAgYWlkLnJlY29yZCgpOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgU3RyaW5nV3JpdGVy\nIHdyaXRlciA9IG5ldyBTdHJpbmdXcml0ZXIoKTsKICAgICAgICAgICAgICAg\nIGdlbi53cml0ZUNvZGUod3JpdGVyKTsKICAgICAgICAgICAgICAgIG91dHB1\ndC5wdXQobWFwcGluZ3NbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpLCB3cml0ZXIu\ndG9TdHJpbmcoKSk7CgogICAgICAgICAgICAgICAgaWYgKGFpZCAhPSBudWxs\nICYmICFhaWQuaXNJbm5lckNsYXNzKCkpIHsKICAgICAgICAgICAgICAgICAg\nICB3cml0ZXIgPSBuZXcgU3RyaW5nV3JpdGVyKCk7CiAgICAgICAgICAgICAg\nICAgICAgYWlkLnNldFdyaXRlcih3cml0ZXIpOwogICAgICAgICAgICAgICAg\nICAgIGFpZC5yZWNvcmQoKTsKICAgICAgICAgICAgICAgICAgICBvdXRwdXQu\ncHV0KG1hcHBpbmdzW2ldLmdldE9iamVjdElkVHlwZSgpLAogICAgICAgICAg\nICAgICAgICAgICAgICB3cml0ZXIudG9TdHJpbmcoKSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIHdyaXR0ZW47CiAgICB9CgogICAgLyoqCiAgICAgKiBXcml0ZSB0aGUgZ2Vu\nZXJhdGVkIG1ldGFkYXRhIHRvIHRoZSBwcm9wZXIgcGFja2FnZXMuCiAgICAg\nKgogICAgICogQHJldHVybiB0aGUgc2V0IG9mIG1ldGFkYXRhIHtAbGluayBG\naWxlfXMgdGhhdCB3ZXJlIHdyaXR0ZW4KICAgICAqLwogICAgcHVibGljIENv\nbGxlY3Rpb24gcmVjb3JkTWV0YURhdGEoYm9vbGVhbiBwZXJDbGFzcykKICAg\nICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIHJldHVybiByZWNv\ncmRNZXRhRGF0YShwZXJDbGFzcywgbnVsbCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXcml0ZSB0aGUgY29kZSBmb3IgdGhlIHRvb2wuCiAgICAgKgogICAg\nICogQHBhcmFtIG91dHB1dCBpZiBudWxsLCB0aGVuIHBlcmZvcm0gdGhlIHdy\naXRlIGRpcmVjdGx5CiAgICAgKiB0byB0aGUgZmlsZXN5c3RlbTsgb3RoZXJ3\naXNlLCBwb3B1bGF0ZSB0aGUKICAgICAqIHNwZWNpZmllZCBtYXAgd2l0aCBr\nZXlzIGFzIHRoZSBnZW5lcmF0ZWQKICAgICAqIHtAbGluayBDbGFzc01hcHBp\nbmd9IGFuZCB2YWx1ZXMgYXMgYQogICAgICoge0BsaW5rIFN0cmluZ30gdGhh\ndCBjb250YWlucyB0aGUgZ2VuZXJhdGVkIGNvZGUKICAgICAqIEByZXR1cm4g\ndGhlIHNldCBvZiBtZXRhZGF0YSB7QGxpbmsgRmlsZX1zIHRoYXQgd2VyZSB3\ncml0dGVuCiAgICAgKi8KICAgIHB1YmxpYyBDb2xsZWN0aW9uIHJlY29yZE1l\ndGFEYXRhKGJvb2xlYW4gcGVyQ2xhc3MsIE1hcCBvdXRwdXQpCiAgICAgICAg\ndGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBwcmV0ZW5kIG1hcHBp\nbmdzIGFyZSBhbGwgcmVzb2x2ZWQKICAgICAgICBDbGFzc01hcHBpbmdbXSBt\nYXBwaW5ncyA9IGdldE1hcHBpbmdzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgbWFw\ncGluZ3NbaV0uc2V0UmVzb2x2ZShNT0RFX01FVEEgfCBNT0RFX01BUFBJTkcs\nIHRydWUpOwoKICAgICAgICAvLyBzdG9yZSBpbiB1c2VyJ3MgY29uZmlndXJl\nZCBJTwogICAgICAgIE1ldGFEYXRhRmFjdG9yeSBtZGYgPSBfY29uZi5uZXdN\nZXRhRGF0YUZhY3RvcnlJbnN0YW5jZSgpOwogICAgICAgIG1kZi5zZXRSZXBv\nc2l0b3J5KGdldFJlcG9zaXRvcnkoKSk7CiAgICAgICAgbWRmLnNldFN0b3Jl\nRGlyZWN0b3J5KF9kaXIpOwogICAgICAgIGlmIChwZXJDbGFzcykKICAgICAg\nICAgICAgbWRmLnNldFN0b3JlTW9kZShNZXRhRGF0YUZhY3RvcnkuU1RPUkVf\nUEVSX0NMQVNTKTsKICAgICAgICBtZGYuc3RvcmUobWFwcGluZ3MsIG5ldyBR\ndWVyeU1ldGFEYXRhWzBdLCBuZXcgU2VxdWVuY2VNZXRhRGF0YVswXSwKICAg\nICAgICAgICAgTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HLCBvdXRwdXQpOwoK\nICAgICAgICBTZXQgZmlsZXMgPSBuZXcgVHJlZVNldCgpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIGlmIChtYXBwaW5nc1tpXS5nZXRTb3VyY2VGaWxlKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIGZpbGVzLmFkZChtYXBwaW5nc1tpXS5nZXRT\nb3VyY2VGaWxlKCkpOwogICAgICAgIHJldHVybiBmaWxlczsKICAgIH0KCiAg\nICAvKioKICAgICAqIEdlbmVyYXRlIGFuZCB3cml0ZSB0aGUgYXBwbGljYXRp\nb24gaWRlbnRpdHkgY29kZS4KICAgICAqLwogICAgcHJpdmF0ZSBBcHBsaWNh\ndGlvbklkVG9vbCBuZXdBcHBsaWNhdGlvbklkVG9vbChDbGFzc01hcHBpbmcg\nbWFwcGluZykgewogICAgICAgIEFwcGxpY2F0aW9uSWRUb29sIHRvb2w7CiAg\nICAgICAgaWYgKG1hcHBpbmcuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NN\nYXBwaW5nLklEX0FQUExJQ0FUSU9OCiAgICAgICAgICAgICYmICFtYXBwaW5n\nLmlzT3BlbkpQQUlkZW50aXR5KCkKICAgICAgICAgICAgJiYgbWFwcGluZy5n\nZXRQQ1N1cGVyY2xhc3MoKSA9PSBudWxsKSB7CiAgICAgICAgICAgIHRvb2wg\nPSBuZXcgQXBwbGljYXRpb25JZFRvb2woX2NvbmYsIG1hcHBpbmcuZ2V0RGVz\nY3JpYmVkVHlwZSgpLAogICAgICAgICAgICAgICAgbWFwcGluZyk7CiAgICAg\nICAgICAgIHRvb2wuc2V0RGlyZWN0b3J5KF9kaXIpOwogICAgICAgICAgICB0\nb29sLnNldENvZGVGb3JtYXQoX2Zvcm1hdCk7CiAgICAgICAgICAgIGlmICgh\ndG9vbC5ydW4oKSkKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgICAgICByZXR1cm4gdG9vbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLwogICAgLy8gTWV0aG9kcyBmb3IgY3VzdG9taXplcnMgdG8gdXNl\nCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNsYXNzIG1hcHBpbmcgZm9yIHRoZSBn\naXZlbiB0YWJsZSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJs\naWMgQ2xhc3NNYXBwaW5nIGdldENsYXNzTWFwcGluZyhUYWJsZSB0YWJsZSkg\newogICAgICAgIHJldHVybiAoQ2xhc3NNYXBwaW5nKSBfdGFibGVzLmdldCh0\nYWJsZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgY2xh\nc3MgdG8gYmUgbWFwcGVkIHRvIGEgdGFibGUuIFRoZSBjbGFzcyB3aWxsIHN0\nYXJ0IG91dAogICAgICogd2l0aCBhIGRlZmF1bHQgYXBwbGljYXRpb24gaWRl\nbnRpdHkgY2xhc3Mgc2V0LgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NNYXBw\naW5nIG5ld0NsYXNzTWFwcGluZyhDbGFzcyBjbHMsIFRhYmxlIHRhYmxlKSB7\nCiAgICAgICAgQ2xhc3NNYXBwaW5nIG1hcHBpbmcgPSAoQ2xhc3NNYXBwaW5n\nKSBnZXRSZXBvc2l0b3J5KCkuYWRkTWV0YURhdGEoY2xzKTsKICAgICAgICBD\nbGFzcyBzdXAgPSBtYXBwaW5nLmdldERlc2NyaWJlZFR5cGUoKS5nZXRTdXBl\ncmNsYXNzKCk7CiAgICAgICAgaWYgKHN1cCA9PSBPYmplY3QuY2xhc3MpCiAg\nICAgICAgICAgIHNldE9iamVjdElkVHlwZShtYXBwaW5nKTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIG1hcHBpbmcuc2V0UENTdXBlcmNsYXNzKHN1cCk7\nCiAgICAgICAgbWFwcGluZy5zZXRUYWJsZSh0YWJsZSk7CiAgICAgICAgaWYg\nKF9kZXRhY2hhYmxlKQogICAgICAgICAgICBtYXBwaW5nLnNldERldGFjaGFi\nbGUodHJ1ZSk7CiAgICAgICAgX3RhYmxlcy5wdXQodGFibGUsIG1hcHBpbmcp\nOwogICAgICAgIHJldHVybiBtYXBwaW5nOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHRoZSBnaXZlbiBjbGFzcycgb2JqZWN0aWQtY2xhc3MuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBzZXRPYmplY3RJZFR5cGUoQ2xhc3NNYXBw\naW5nIGNscykgewogICAgICAgIFN0cmluZyBuYW1lID0gY2xzLmdldERlc2Ny\naWJlZFR5cGUoKS5nZXROYW1lKCk7CiAgICAgICAgaWYgKF9pbm5lcikKICAg\nICAgICAgICAgbmFtZSArPSAiJCI7CiAgICAgICAgbmFtZSArPSBfaWRTdWZm\naXg7CiAgICAgICAgY2xzLnNldE9iamVjdElkVHlwZShnZW5lcmF0ZUNsYXNz\nKG5hbWUsIG51bGwpLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBH\nZW5lcmF0ZSBhIG5ldyBjbGFzcyB3aXRoIHRoZSBnaXZlbiBuYW1lLiBJZiBh\nIG5vbi1udWxsIHBhcmVudCBjbGFzcwogICAgICogaXMgZ2l2ZW4sIGl0IHdp\nbGwgYmUgc2V0IGFzIHRoZSBzdXBlcmNsYXNzLgogICAgICovCiAgICBwdWJs\naWMgQ2xhc3MgZ2VuZXJhdGVDbGFzcyhTdHJpbmcgbmFtZSwgQ2xhc3MgcGFy\nZW50KSB7CiAgICAgICAgQkNDbGFzcyBiYyA9IF9wcm9qZWN0LmxvYWRDbGFz\ncyhuYW1lLCBudWxsKTsKICAgICAgICBpZiAocGFyZW50ICE9IG51bGwpCiAg\nICAgICAgICAgIGJjLnNldFN1cGVyY2xhc3MocGFyZW50KTsKICAgICAgICBi\nYy5hZGREZWZhdWx0Q29uc3RydWN0b3IoKTsKCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcmV0dXJuIENsYXNzLmZvck5hbWUobmFtZSwgZmFsc2UsIF9s\nb2FkZXIpOwogICAgICAgIH0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNlcHRp\nb24gY25mZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNl\ncHRpb24oY25mZS50b1N0cmluZygpLCBjbmZlKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2ZW4gZm9y\nZWlnbiBrZXkgaXMgdW5pcXVlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc1VuaXF1ZShGb3JlaWduS2V5IGZrKSB7CiAgICAgICAgUHJpbWFyeUtl\neSBwayA9IGZrLmdldFRhYmxlKCkuZ2V0UHJpbWFyeUtleSgpOwogICAgICAg\nIGlmIChwayAhPSBudWxsICYmIHBrLmNvbHVtbnNNYXRjaChmay5nZXRDb2x1\nbW5zKCkpKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBJbmRl\neFtdIGlkeCA9IGZrLmdldFRhYmxlKCkuZ2V0SW5kZXhlcygpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgaWR4Lmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICBpZiAoaWR4W2ldLmlzVW5pcXVlKCkgJiYgaWR4W2ldLmNvbHVtbnNN\nYXRjaChmay5nZXRDb2x1bW5zKCkpKQogICAgICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICAgICAgVW5pcXVlW10gdW5xID0gZmsuZ2V0VGFibGUoKS5n\nZXRVbmlxdWVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnEu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmICh1bnFbaV0uY29sdW1uc01h\ndGNoKGZrLmdldENvbHVtbnMoKSkpCiAgICAgICAgICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJZiB0aGUgZ2l2ZW4gdGFibGUgaGFzIGEgc2luZ2xlIHVuaXF1ZSBm\nb3JlaWduIGtleSBvciBhIGZvcmVpZ24KICAgICAqIGtleSB0aGF0IG1hdGNo\nZXMgdGhlIHByaW1hcnkga2V5LCByZXR1cm4gaXQuIEVsc2UgcmV0dXJuIG51\nbGwuCiAgICAgKi8KICAgIHB1YmxpYyBGb3JlaWduS2V5IGdldFVuaXF1ZUZv\ncmVpZ25LZXkoVGFibGUgdGFibGUpIHsKICAgICAgICBGb3JlaWduS2V5W10g\nZmtzID0gdGFibGUuZ2V0Rm9yZWlnbktleXMoKTsKICAgICAgICBQcmltYXJ5\nS2V5IHBrID0gdGFibGUuZ2V0UHJpbWFyeUtleSgpOwogICAgICAgIEZvcmVp\nZ25LZXkgdW5xID0gbnVsbDsKICAgICAgICBpbnQgY291bnQgPSAwOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmtzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIGlmIChwayAhPSBudWxsICYmIHBrLmNvbHVtbnNNYXRjaChm\na3NbaV0uZ2V0Q29sdW1ucygpKSkKICAgICAgICAgICAgICAgIHJldHVybiBm\na3NbaV07CiAgICAgICAgICAgIGlmICghaXNVbmlxdWUoZmtzW2ldKSkKICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgY291bnQrKzsK\nICAgICAgICAgICAgaWYgKHVucSA9PSBudWxsKQogICAgICAgICAgICAgICAg\ndW5xID0gZmtzW2ldOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKGNvdW50\nID09IDEpID8gdW5xIDogbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFk\nZCBleGlzdGluZyB1bmlxdWUgY29uc3RyYWludHMgYW5kIGluZGV4ZXMgdG8g\ndGhlIGdpdmVuIGZpZWxkJ3Mgam9pbi4KICAgICAqLwogICAgcHVibGljIHZv\naWQgYWRkSm9pbkNvbnN0cmFpbnRzKEZpZWxkTWFwcGluZyBmaWVsZCkgewog\nICAgICAgIEZvcmVpZ25LZXkgZmsgPSBmaWVsZC5nZXRKb2luRm9yZWlnbktl\neSgpOwogICAgICAgIGlmIChmayA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm47CgogICAgICAgIEluZGV4IGlkeCA9IGZpbmRJbmRleChmay5nZXRDb2x1\nbW5zKCkpOwogICAgICAgIGlmIChpZHggIT0gbnVsbCkKICAgICAgICAgICAg\nZmllbGQuc2V0Sm9pbkluZGV4KGlkeCk7CiAgICAgICAgVW5pcXVlIHVucSA9\nIGZpbmRVbmlxdWUoZmsuZ2V0Q29sdW1ucygpKTsKICAgICAgICBpZiAodW5x\nICE9IG51bGwpCiAgICAgICAgICAgIGZpZWxkLnNldEpvaW5VbmlxdWUodW5x\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBleGlzdGluZyB1bmlxdWUg\nY29uc3RyYWludHMgYW5kIGluZGV4ZXMgdG8gdGhlIGdpdmVuIHZhbHVlLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBhZGRDb25zdHJhaW50cyhWYWx1ZU1h\ncHBpbmcgdm0pIHsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gKHZtLmdldEZv\ncmVpZ25LZXkoKSAhPSBudWxsKQogICAgICAgICAgICA/IHZtLmdldEZvcmVp\nZ25LZXkoKS5nZXRDb2x1bW5zKCkgOiB2bS5nZXRDb2x1bW5zKCk7CiAgICAg\nICAgSW5kZXggaWR4ID0gZmluZEluZGV4KGNvbHMpOwogICAgICAgIGlmIChp\nZHggIT0gbnVsbCkKICAgICAgICAgICAgdm0uc2V0VmFsdWVJbmRleChpZHgp\nOwogICAgICAgIFVuaXF1ZSB1bnEgPSBmaW5kVW5pcXVlKGNvbHMpOwogICAg\nICAgIGlmICh1bnEgIT0gbnVsbCkKICAgICAgICAgICAgdm0uc2V0VmFsdWVV\nbmlxdWUodW5xKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\naW5kZXggd2l0aCB0aGUgZ2l2ZW4gY29sdW1ucy4KICAgICAqLwogICAgcHJp\ndmF0ZSBJbmRleCBmaW5kSW5kZXgoQ29sdW1uW10gY29scykgewogICAgICAg\nIGlmIChjb2xzID09IG51bGwgfHwgY29scy5sZW5ndGggPT0gMCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIFRhYmxlIHRhYmxlID0gY29s\nc1swXS5nZXRUYWJsZSgpOwogICAgICAgIEluZGV4W10gaWR4cyA9IHRhYmxl\nLmdldEluZGV4ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlk\neHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChpZHhzW2ldLmNvbHVt\nbnNNYXRjaChjb2xzKSkKICAgICAgICAgICAgICAgIHJldHVybiBpZHhzW2ld\nOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSB1bmlxdWUgY29uc3RyaWFudCB3aXRoIHRoZSBnaXZlbiBj\nb2x1bW5zLgogICAgICovCiAgICBwcml2YXRlIFVuaXF1ZSBmaW5kVW5pcXVl\nKENvbHVtbltdIGNvbHMpIHsKICAgICAgICBpZiAoY29scyA9PSBudWxsIHx8\nIGNvbHMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBudWxsOwoK\nICAgICAgICBUYWJsZSB0YWJsZSA9IGNvbHNbMF0uZ2V0VGFibGUoKTsKICAg\nICAgICBVbmlxdWVbXSB1bnFzID0gdGFibGUuZ2V0VW5pcXVlcygpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgaWYgKHVucXNbaV0uY29sdW1uc01hdGNoKGNvbHMpKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHVucXNbaV07CiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLwogICAgLy8gVXRpbGl0aWVz\nCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hl\ndGhlciB0aGUgZ2l2ZW4gdGFibGUgaXMgYSBiYXNlIGNsYXNzIHRhYmxlLgog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0Jhc2VUYWJsZShUYWJsZSB0\nYWJsZSkgewogICAgICAgIGlmICh0YWJsZS5nZXRQcmltYXJ5S2V5KCkgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGludCB0\neXBlID0gZ2V0U2Vjb25kYXJ5VHlwZSh0YWJsZSwgdHJ1ZSk7CiAgICAgICAg\naWYgKHR5cGUgIT0gLTEpCiAgICAgICAgICAgIHJldHVybiB0eXBlID09IFRB\nQkxFX0JBU0U7CiAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIF9jdXN0b20uZ2V0VGFibGVUeXBlKHRhYmxlLCBUQUJM\nRV9CQVNFKSA9PSBUQUJMRV9CQVNFOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHRoZSB0eXBlIG9mIHRo\nZSBzZWNvbmRhcnkgZ2l2ZW4gdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUg\naW50IGdldFNlY29uZGFyeVR5cGUoVGFibGUgdGFibGUsIGJvb2xlYW4gbWF5\nYmVCYXNlKSB7CiAgICAgICAgaW50IHR5cGU7CiAgICAgICAgRm9yZWlnbktl\neVtdIGZrcyA9IHRhYmxlLmdldEZvcmVpZ25LZXlzKCk7CiAgICAgICAgaWYg\nKGZrcy5sZW5ndGggPT0gMgogICAgICAgICAgICAmJiAodGFibGUuZ2V0UHJp\nbWFyeUtleSgpID09IG51bGwgfHwgX3BrT25Kb2luKQogICAgICAgICAgICAm\nJiBma3NbMF0uZ2V0Q29sdW1ucygpLmxlbmd0aCArIGZrc1sxXS5nZXRDb2x1\nbW5zKCkubGVuZ3RoCiAgICAgICAgICAgID09IHRhYmxlLmdldENvbHVtbnMo\nKS5sZW5ndGgKICAgICAgICAgICAgJiYgKCFpc1VuaXF1ZShma3NbMF0pIHx8\nICFpc1VuaXF1ZShma3NbMV0pKSkKICAgICAgICAgICAgdHlwZSA9IFRBQkxF\nX0FTU09DSUFUSU9OOwogICAgICAgIGVsc2UgaWYgKG1heWJlQmFzZSAmJiB0\nYWJsZS5nZXRQcmltYXJ5S2V5KCkgIT0gbnVsbCkKICAgICAgICAgICAgdHlw\nZSA9IC0xOwogICAgICAgIGVsc2UgaWYgKGdldFVuaXF1ZUZvcmVpZ25LZXko\ndGFibGUpICE9IG51bGwpCiAgICAgICAgICAgIHR5cGUgPSBUQUJMRV9TRUNP\nTkRBUlk7CiAgICAgICAgZWxzZSBpZiAoZmtzLmxlbmd0aCA9PSAxKQogICAg\nICAgICAgICB0eXBlID0gVEFCTEVfTk9ORTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIHR5cGUgPSAtMTsKCiAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVs\nbCAmJiB0eXBlICE9IC0xKQogICAgICAgICAgICB0eXBlID0gX2N1c3RvbS5n\nZXRUYWJsZVR5cGUodGFibGUsIHR5cGUpOwogICAgICAgIHJldHVybiB0eXBl\nOwogICAgfQoKICAgIC8qKgogICAgICogQXR0ZW1wdCB0byBjcmVhdGUgYSBi\nYXNlIGNsYXNzIGZyb20gdGhlIGdpdmVuIHRhYmxlLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgbWFwQmFzZUNsYXNzKFRhYmxlIHRhYmxlKSB7CiAgICAg\nICAgQ2xhc3NNYXBwaW5nIGNscyA9IG5ld0NsYXNzTWFwcGluZyh0YWJsZSwg\nbnVsbCk7CiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIC8vIGNoZWNrIGZvciBkYXRhc3RvcmUgaWRlbnRp\ndHkgYW5kIGJ1aWx0aW4gaWRlbnRpdHk7IGZvciBub3cKICAgICAgICAvLyB3\nZSBhc3N1bWUgdGhhdCBhbnkgbm9uLWRhdGFzdG9yZSBzaW5nbGUgcHJpbWFy\neSBrZXkgY29sdW1uIHdpbGwgdXNlCiAgICAgICAgLy8gYnVpbHRpbiBpZGVu\ndGl0eTsgaWYgd2UgZGlzY292ZXIgdGhhdCB0aGUgcHJpbWFyeSBrZXkgZmll\nbGQgaXMKICAgICAgICAvLyBub3QgY29tcGF0aWJsZSB3aXRoIGJ1aWx0aW4g\naWRlbnRpdHkgbGF0ZXIsIHRoZW4gd2UnbGwgYXNzaWduCiAgICAgICAgLy8g\nYW4gYXBwbGljYXRpb24gaWRlbnRpdHkgY2xhc3MKICAgICAgICBDb2x1bW5b\nXSBwa3MgPSB0YWJsZS5nZXRQcmltYXJ5S2V5KCkuZ2V0Q29sdW1ucygpOwog\nICAgICAgIGNscy5zZXRQcmltYXJ5S2V5Q29sdW1ucyhwa3MpOwogICAgICAg\nIGlmIChwa3MubGVuZ3RoID09IDEgJiYgX2RhdGFzdG9yZQogICAgICAgICAg\nICAmJiBwa3NbMF0uaXNDb21wYXRpYmxlKFR5cGVzLkJJR0lOVCwgbnVsbCwg\nMCwgMCkpIHsKICAgICAgICAgICAgY2xzLnNldE9iamVjdElkVHlwZShudWxs\nLCBmYWxzZSk7CiAgICAgICAgICAgIGNscy5zZXRJZGVudGl0eVR5cGUoQ2xh\nc3NNYXBwaW5nLklEX0RBVEFTVE9SRSk7CiAgICAgICAgfSBlbHNlIGlmIChw\na3MubGVuZ3RoID09IDEgJiYgX2J1aWx0aW4pCiAgICAgICAgICAgIGNscy5z\nZXRPYmplY3RJZFR5cGUobnVsbCwgZmFsc2UpOwogICAgICAgIGNscy5zZXRT\ndHJhdGVneShuZXcgRnVsbENsYXNzU3RyYXRlZ3koKSwgbnVsbCk7CiAgICAg\nICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAgX2N1c3RvbS5j\ndXN0b21pemUoY2xzKTsKICAgIH0KCiAgICAvKioKICAgICAqIEF0dGVtcHQg\ndG8gY3JlYXRlIGEgdmVydGljYWwgc3ViY2xhc3NlcyBmcm9tIHRoZSBnaXZl\nbiB0YWJsZXMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBtYXBTdWJjbGFz\nc2VzKFNldCB0YWJsZXMpIHsKICAgICAgICAvLyBsb29wIHRocm91Z2ggdGFi\nbGVzIHVudGlsIGVpdGhlciBhbGwgYXJlIG1hcHBlZCBvciBub25lIGxpbmsg\ndG8KICAgICAgICAvLyBhIG1hcHBlZCBiYXNlIGNsYXNzIHRhYmxlCiAgICAg\nICAgQ2xhc3NNYXBwaW5nIGJhc2UsIHN1YjsKICAgICAgICBUYWJsZSB0YWJs\nZSA9IG51bGw7CiAgICAgICAgRm9yZWlnbktleSBmayA9IG51bGw7CiAgICAg\nICAgd2hpbGUgKCF0YWJsZXMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIC8v\nIGZpbmQgYSB0YWJsZSB3aXRoIGEgZm9yZWlnbiBrZXkgbGlua2luZyB0byBh\nIG1hcHBlZCB0YWJsZQogICAgICAgICAgICBiYXNlID0gbnVsbDsKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSB0YWJsZXMuaXRlcmF0b3IoKTsg\naXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIHRhYmxlID0gKFRh\nYmxlKSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgZmsgPSBnZXRVbmlx\ndWVGb3JlaWduS2V5KHRhYmxlKTsKICAgICAgICAgICAgICAgIGlmIChmayA9\nPSBudWxsICYmIHRhYmxlLmdldEZvcmVpZ25LZXlzKCkubGVuZ3RoID09IDEp\nCiAgICAgICAgICAgICAgICAgICAgZmsgPSB0YWJsZS5nZXRGb3JlaWduS2V5\ncygpWzBdOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoZmsgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAgICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBiYXNlID0gKENsYXNz\nTWFwcGluZykgX3RhYmxlcy5nZXQoZmsuZ2V0UHJpbWFyeUtleVRhYmxlKCkp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChiYXNlICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAgICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g\naWYgbm8gdGFibGVzIGxpbmsgdG8gYSBiYXNlIHRhYmxlLCBub3RoaW5nIGxl\nZnQgdG8gZG8KICAgICAgICAgICAgaWYgKGJhc2UgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIHN1YiA9IG5ld0NsYXNz\nTWFwcGluZyh0YWJsZSwgYmFzZS5nZXREZXNjcmliZWRUeXBlKCkpOwogICAg\nICAgICAgICBzdWIuc2V0Sm9pbkZvcmVpZ25LZXkoZmspOwogICAgICAgICAg\nICBzdWIuc2V0UHJpbWFyeUtleUNvbHVtbnMoZmsuZ2V0Q29sdW1ucygpKTsK\nICAgICAgICAgICAgc3ViLnNldElkZW50aXR5VHlwZShiYXNlLmdldElkZW50\naXR5VHlwZSgpKTsKICAgICAgICAgICAgc3ViLnNldFN0cmF0ZWd5KG5ldyBW\nZXJ0aWNhbENsYXNzU3RyYXRlZ3koKSwgbnVsbCk7CiAgICAgICAgICAgIGlm\nIChfY3VzdG9tICE9IG51bGwpCiAgICAgICAgICAgICAgICBfY3VzdG9tLmN1\nc3RvbWl6ZShzdWIpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIEF0dGVtcHQgdG8gcmV2ZXJzZSBtYXAgdGhlIGdpdmVuIHRhYmxlIGFzIGFu\nIGFzc29jaWF0aW9uIHRhYmxlLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nbWFwQXNzb2NpYXRpb25UYWJsZShUYWJsZSB0YWJsZSkgewogICAgICAgIEZv\ncmVpZ25LZXlbXSBma3MgPSB0YWJsZS5nZXRGb3JlaWduS2V5cygpOwogICAg\nICAgIGlmIChma3MubGVuZ3RoICE9IDIpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNsczEgPSAoQ2xhc3NNYXBwaW5nKSBf\ndGFibGVzLmdldAogICAgICAgICAgICAoZmtzWzBdLmdldFByaW1hcnlLZXlU\nYWJsZSgpKTsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzMiA9IChDbGFzc01h\ncHBpbmcpIF90YWJsZXMuZ2V0CiAgICAgICAgICAgIChma3NbMV0uZ2V0UHJp\nbWFyeUtleVRhYmxlKCkpOwogICAgICAgIGlmIChjbHMxID09IG51bGwgfHwg\nY2xzMiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8v\nIGFkZCBhIHJlbGF0aW9uIGZyb20gZWFjaCBjbGFzcyB0byB0aGUgb3RoZXIg\ndGhyb3VnaCB0aGUKICAgICAgICAvLyBhc3NvY2lhdGlvbiB0YWJsZQogICAg\nICAgIFN0cmluZyBuYW1lID0gZ2V0UmVsYXRpb25OYW1lKGNsczIuZ2V0RGVz\nY3JpYmVkVHlwZSgpLCB0cnVlLCBma3NbMV0sCiAgICAgICAgICAgIGZhbHNl\nLCBjbHMxKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQxID0gbmV3Rmll\nbGRNYXBwaW5nKG5hbWUsIFNldC5jbGFzcywgbnVsbCwgZmtzWzFdLAogICAg\nICAgICAgICBjbHMxKTsKICAgICAgICBpZiAoZmllbGQxICE9IG51bGwpIHsK\nICAgICAgICAgICAgZmllbGQxLnNldEpvaW5Gb3JlaWduS2V5KGZrc1swXSk7\nCiAgICAgICAgICAgIGFkZEpvaW5Db25zdHJhaW50cyhmaWVsZDEpOwogICAg\nICAgICAgICBWYWx1ZU1hcHBpbmcgdm0gPSBmaWVsZDEuZ2V0RWxlbWVudE1h\ncHBpbmcoKTsKICAgICAgICAgICAgdm0uc2V0RGVjbGFyZWRUeXBlKGNsczIu\nZ2V0RGVzY3JpYmVkVHlwZSgpKTsKICAgICAgICAgICAgdm0uc2V0Rm9yZWln\nbktleShma3NbMV0pOwogICAgICAgICAgICBhZGRDb25zdHJhaW50cyh2bSk7\nCiAgICAgICAgICAgIGZpZWxkMS5zZXRTdHJhdGVneShuZXcgUmVsYXRpb25D\nb2xsZWN0aW9uVGFibGVGaWVsZFN0cmF0ZWd5KCksCiAgICAgICAgICAgICAg\nICBudWxsKTsKICAgICAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIF9jdXN0b20uY3VzdG9taXplKGZpZWxkMSk7CiAgICAg\nICAgfQoKICAgICAgICBuYW1lID0gZ2V0UmVsYXRpb25OYW1lKGNsczEuZ2V0\nRGVzY3JpYmVkVHlwZSgpLCB0cnVlLCBma3NbMF0sCiAgICAgICAgICAgIGZh\nbHNlLCBjbHMyKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQyID0gbmV3\nRmllbGRNYXBwaW5nKG5hbWUsIFNldC5jbGFzcywgbnVsbCwgZmtzWzBdLAog\nICAgICAgICAgICBjbHMyKTsKICAgICAgICBpZiAoZmllbGQyID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgZmllbGQyLnNldEpvaW5G\nb3JlaWduS2V5KGZrc1sxXSk7CiAgICAgICAgYWRkSm9pbkNvbnN0cmFpbnRz\nKGZpZWxkMik7CiAgICAgICAgVmFsdWVNYXBwaW5nIHZtID0gZmllbGQyLmdl\ndEVsZW1lbnRNYXBwaW5nKCk7CiAgICAgICAgdm0uc2V0RGVjbGFyZWRUeXBl\nKGNsczEuZ2V0RGVzY3JpYmVkVHlwZSgpKTsKICAgICAgICB2bS5zZXRGb3Jl\naWduS2V5KGZrc1swXSk7CiAgICAgICAgYWRkQ29uc3RyYWludHModm0pOwog\nICAgICAgIGlmIChmaWVsZDEgIT0gbnVsbCAmJiBmaWVsZDEuZ2V0TWFwcGVk\nQnkoKSA9PSBudWxsKQogICAgICAgICAgICBmaWVsZDIuc2V0TWFwcGVkQnko\nZmllbGQxLmdldE5hbWUoKSk7CiAgICAgICAgZmllbGQyLnNldFN0cmF0ZWd5\nKG5ldyBSZWxhdGlvbkNvbGxlY3Rpb25UYWJsZUZpZWxkU3RyYXRlZ3koKSwg\nbnVsbCk7CiAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAg\nICAgX2N1c3RvbS5jdXN0b21pemUoZmllbGQyKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEF0dGVtcHQgdG8gcmV2ZXJzZSBtYXAgdGhlIGdpdmVuIHRhYmxl\nIGFzIGEgc2Vjb25kYXJ5IHRhYmxlLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgbWFwU2Vjb25kYXJ5VGFibGUoVGFibGUgdGFibGUsIGJvb2xlYW4gb3V0\nZXIpIHsKICAgICAgICBGb3JlaWduS2V5IGZrID0gZ2V0VW5pcXVlRm9yZWln\nbktleSh0YWJsZSk7CiAgICAgICAgaWYgKGZrID09IG51bGwgJiYgdGFibGUu\nZ2V0Rm9yZWlnbktleXMoKS5sZW5ndGggPT0gMSkKICAgICAgICAgICAgZmsg\nPSB0YWJsZS5nZXRGb3JlaWduS2V5cygpWzBdOwogICAgICAgIGVsc2UgaWYg\nKGZrID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBDbGFz\nc01hcHBpbmcgY2xzID0gKENsYXNzTWFwcGluZykgX3RhYmxlcy5nZXQoZmsu\nZ2V0UHJpbWFyeUtleVRhYmxlKCkpOwogICAgICAgIGlmIChjbHMgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIG1hcENvbHVtbnMoY2xz\nLCB0YWJsZSwgZmssIG91dGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1h\ncCB0aGUgY29sdW1ucyBvZiB0aGUgZ2l2ZW4gdGFibGUgdG8gZmllbGRzIG9m\nIHRoZSBnaXZlbiB0eXBlLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgbWFw\nQ29sdW1ucyhDbGFzc01hcHBpbmcgY2xzLCBUYWJsZSB0YWJsZSwgRm9yZWln\nbktleSBqb2luLAogICAgICAgIGJvb2xlYW4gb3V0ZXIpIHsKICAgICAgICAv\nLyBmaXJzdCBtYXAgZm9yZWlnbiBrZXlzIHRvIHJlbGF0aW9ucwogICAgICAg\nIEZvcmVpZ25LZXlbXSBma3MgPSB0YWJsZS5nZXRGb3JlaWduS2V5cygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmtzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBpZiAoZmtzW2ldICE9IGpvaW4gJiYgZmtzW2ldICE9IGNs\ncy5nZXRKb2luRm9yZWlnbktleSgpKQogICAgICAgICAgICAgICAgbWFwRm9y\nZWlnbktleShjbHMsIGZrc1tpXSwgam9pbiwgb3V0ZXIpOwoKICAgICAgICAv\nLyBtYXAgYW55IGNvbHVtbnMgbm90IGNvbnRyb2xsZWQgYnkgZm9yZWlnbiBr\nZXlzOyBhbHNvIGZvcmNlIHByaW1hcnkKICAgICAgICAvLyBrZXkgY29scyB0\nbyBnZXQgbWFwcGVkIHRvIHNpbXBsZSBmaWVsZHMgZXZlbiBpZiB0aGUgY29s\ndW1ucyBhcmUKICAgICAgICAvLyBhbHNvIGZvcmVpZ24ga2V5IGNvbHVtbnMK\nICAgICAgICBQcmltYXJ5S2V5IHBrID0gKGpvaW4gIT0gbnVsbCkgPyBudWxs\nIDogdGFibGUuZ2V0UHJpbWFyeUtleSgpOwogICAgICAgIGJvb2xlYW4gcGtj\nb2w7CiAgICAgICAgQ29sdW1uW10gY29scyA9IHRhYmxlLmdldENvbHVtbnMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgcGtjb2wgPSBwayAhPSBudWxsICYmIHBrLmNv\nbnRhaW5zQ29sdW1uKGNvbHNbaV0pOwogICAgICAgICAgICBpZiAocGtjb2wg\nJiYgY2xzLmdldElkZW50aXR5VHlwZSgpID09IENsYXNzTWFwcGluZy5JRF9E\nQVRBU1RPUkUpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg\nICAgaWYgKChjbHMuZ2V0UENTdXBlcmNsYXNzKCkgPT0gbnVsbCAmJiBwa2Nv\nbCkKICAgICAgICAgICAgICAgIHx8ICFpc0ZvcmVpZ25LZXlDb2x1bW4oY29s\nc1tpXSkpCiAgICAgICAgICAgICAgICBtYXBDb2x1bW4oY2xzLCBjb2xzW2ld\nLCBqb2luLCBvdXRlcik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogV2hldGhlciB0aGUgZ2l2ZW4gY29sdW1uIGFwcGVhcnMgaW4gYW55IGZv\ncmVpZ24ga2V5cy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVh\nbiBpc0ZvcmVpZ25LZXlDb2x1bW4oQ29sdW1uIGNvbCkgewogICAgICAgIEZv\ncmVpZ25LZXlbXSBma3MgPSBjb2wuZ2V0VGFibGUoKS5nZXRGb3JlaWduS2V5\ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmtzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICBpZiAoZmtzW2ldLmNvbnRhaW5zQ29sdW1uKGNv\nbCkpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXAgYSBmb3JlaWdu\nIGtleSB0byBhIHJlbGF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nbWFwRm9yZWlnbktleShDbGFzc01hcHBpbmcgY2xzLCBGb3JlaWduS2V5IGZr\nLAogICAgICAgIEZvcmVpZ25LZXkgam9pbiwgYm9vbGVhbiBvdXRlcikgewog\nICAgICAgIENsYXNzTWFwcGluZyByZWwgPSAoQ2xhc3NNYXBwaW5nKSBfdGFi\nbGVzLmdldChmay5nZXRQcmltYXJ5S2V5VGFibGUoKSk7CiAgICAgICAgaWYg\nKHJlbCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIFN0\ncmluZyBuYW1lID0gZ2V0UmVsYXRpb25OYW1lKHJlbC5nZXREZXNjcmliZWRU\neXBlKCksIGZhbHNlLCBmaywKICAgICAgICAgICAgZmFsc2UsIGNscyk7CiAg\nICAgICAgRmllbGRNYXBwaW5nIGZpZWxkMSA9IG5ld0ZpZWxkTWFwcGluZyhu\nYW1lLCByZWwuZ2V0RGVzY3JpYmVkVHlwZSgpLAogICAgICAgICAgICBudWxs\nLCBmaywgY2xzKTsKICAgICAgICBpZiAoZmllbGQxICE9IG51bGwpIHsKICAg\nICAgICAgICAgZmllbGQxLnNldEpvaW5Gb3JlaWduS2V5KGpvaW4pOwogICAg\nICAgICAgICBmaWVsZDEuc2V0Sm9pbk91dGVyKG91dGVyKTsKICAgICAgICAg\nICAgYWRkSm9pbkNvbnN0cmFpbnRzKGZpZWxkMSk7CiAgICAgICAgICAgIGZp\nZWxkMS5zZXRGb3JlaWduS2V5KGZrKTsKICAgICAgICAgICAgYWRkQ29uc3Ry\nYWludHMoZmllbGQxKTsKICAgICAgICAgICAgZmllbGQxLnNldFN0cmF0ZWd5\nKG5ldyBSZWxhdGlvbkZpZWxkU3RyYXRlZ3koKSwgbnVsbCk7CiAgICAgICAg\nICAgIGlmIChfY3VzdG9tICE9IG51bGwpCiAgICAgICAgICAgICAgICBfY3Vz\ndG9tLmN1c3RvbWl6ZShmaWVsZDEpOwogICAgICAgIH0KICAgICAgICBpZiAo\nIV9pbnZlcnNlIHx8IGpvaW4gIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nOwoKICAgICAgICAvLyBjcmVhdGUgaW52ZXJzZSByZWxhdGlvbgogICAgICAg\nIGJvb2xlYW4gdW5xID0gaXNVbmlxdWUoZmspOwogICAgICAgIG5hbWUgPSBn\nZXRSZWxhdGlvbk5hbWUoY2xzLmdldERlc2NyaWJlZFR5cGUoKSwgIXVucSwg\nZmssIHRydWUsIHJlbCk7CiAgICAgICAgQ2xhc3MgdHlwZSA9ICh1bnEpID8g\nY2xzLmdldERlc2NyaWJlZFR5cGUoKSA6IFNldC5jbGFzczsKICAgICAgICBG\naWVsZE1hcHBpbmcgZmllbGQyID0gbmV3RmllbGRNYXBwaW5nKG5hbWUsIHR5\ncGUsIG51bGwsIGZrLCByZWwpOwogICAgICAgIGlmIChmaWVsZDIgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmIChmaWVsZDEgIT0g\nbnVsbCkKICAgICAgICAgICAgZmllbGQyLnNldE1hcHBlZEJ5KGZpZWxkMS5n\nZXROYW1lKCkpOwogICAgICAgIGlmICh1bnEpIHsKICAgICAgICAgICAgZmll\nbGQyLnNldEZvcmVpZ25LZXkoZmspOwogICAgICAgICAgICBmaWVsZDIuc2V0\nSm9pbkRpcmVjdGlvbihmaWVsZDIuSk9JTl9JTlZFUlNFKTsKICAgICAgICAg\nICAgZmllbGQyLnNldFN0cmF0ZWd5KG5ldyBSZWxhdGlvbkZpZWxkU3RyYXRl\nZ3koKSwgbnVsbCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgVmFs\ndWVNYXBwaW5nIHZtID0gZmllbGQyLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAg\nICAgICAgICAgIHZtLnNldERlY2xhcmVkVHlwZShjbHMuZ2V0RGVzY3JpYmVk\nVHlwZSgpKTsKICAgICAgICAgICAgdm0uc2V0Rm9yZWlnbktleShmayk7CiAg\nICAgICAgICAgIHZtLnNldEpvaW5EaXJlY3Rpb24odm0uSk9JTl9FWFBFQ1RF\nRF9JTlZFUlNFKTsKICAgICAgICAgICAgZmllbGQyLnNldFN0cmF0ZWd5KG5l\ndyBSZWxhdGlvbkNvbGxlY3Rpb25JbnZlcnNlS2V5RmllbGRTdHJhdGVneSgp\nLAogICAgICAgICAgICAgICAgbnVsbCk7CiAgICAgICAgfQogICAgICAgIGlm\nIChfY3VzdG9tICE9IG51bGwpCiAgICAgICAgICAgIF9jdXN0b20uY3VzdG9t\naXplKGZpZWxkMik7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXAgYSBjb2x1\nbW4gdG8gYSBzaW1wbGUgZmllbGQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBtYXBDb2x1bW4oQ2xhc3NNYXBwaW5nIGNscywgQ29sdW1uIGNvbCwgRm9y\nZWlnbktleSBqb2luLAogICAgICAgIGJvb2xlYW4gb3V0ZXIpIHsKICAgICAg\nICBTdHJpbmcgbmFtZSA9IGdldEZpZWxkTmFtZShjb2wuZ2V0TmFtZSgpLCBj\nbHMpOwogICAgICAgIENsYXNzIHR5cGUgPSBnZXRGaWVsZFR5cGUoY29sLCBm\nYWxzZSk7CiAgICAgICAgRmllbGRNYXBwaW5nIGZpZWxkID0gbmV3RmllbGRN\nYXBwaW5nKG5hbWUsIHR5cGUsIGNvbCwgbnVsbCwgY2xzKTsKICAgICAgICBm\naWVsZC5zZXRTZXJpYWxpemVkKHR5cGUgPT0gT2JqZWN0LmNsYXNzKTsKICAg\nICAgICBmaWVsZC5zZXRKb2luRm9yZWlnbktleShqb2luKTsKICAgICAgICBm\naWVsZC5zZXRKb2luT3V0ZXIob3V0ZXIpOwogICAgICAgIGFkZEpvaW5Db25z\ndHJhaW50cyhmaWVsZCk7CiAgICAgICAgZmllbGQuc2V0Q29sdW1ucyhuZXcg\nQ29sdW1uW117IGNvbCB9KTsKICAgICAgICBhZGRDb25zdHJhaW50cyhmaWVs\nZCk7CiAgICAgICAgaWYgKGNvbC5pc1ByaW1hcnlLZXkoKQogICAgICAgICAg\nICAmJiBjbHMuZ2V0SWRlbnRpdHlUeXBlKCkgIT0gQ2xhc3NNYXBwaW5nLklE\nX0RBVEFTVE9SRSkKICAgICAgICAgICAgZmllbGQuc2V0UHJpbWFyeUtleSh0\ncnVlKTsKCiAgICAgICAgRmllbGRTdHJhdGVneSBzdHJhdDsKICAgICAgICBp\nZiAodHlwZS5pc1ByaW1pdGl2ZSgpKQogICAgICAgICAgICBzdHJhdCA9IG5l\ndyBQcmltaXRpdmVGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgZWxzZSBpZiAo\nY29sLmdldFR5cGUoKSA9PSBUeXBlcy5DTE9CCiAgICAgICAgICAgICYmIF9j\nb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkubWF4RW1iZWRkZWRDbG9i\nU2l6ZSAhPSAtMSkKICAgICAgICAgICAgc3RyYXQgPSBuZXcgTWF4RW1iZWRk\nZWRDbG9iRmllbGRTdHJhdGVneSgpOwogICAgICAgIGVsc2UgaWYgKGNvbC5p\nc0xvYigpCiAgICAgICAgICAgICYmIF9jb25mLmdldERCRGljdGlvbmFyeUlu\nc3RhbmNlKCkubWF4RW1iZWRkZWRCbG9iU2l6ZSAhPSAtMSkKICAgICAgICAg\nICAgc3RyYXQgPSBuZXcgTWF4RW1iZWRkZWRCbG9iRmllbGRTdHJhdGVneSgp\nOwogICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gU3RyaW5nLmNsYXNzKQogICAg\nICAgICAgICBzdHJhdCA9IG5ldyBTdHJpbmdGaWVsZFN0cmF0ZWd5KCk7CiAg\nICAgICAgZWxzZQogICAgICAgICAgICBzdHJhdCA9IG5ldyBIYW5kbGVyRmll\nbGRTdHJhdGVneSgpOwogICAgICAgIGZpZWxkLnNldFN0cmF0ZWd5KHN0cmF0\nLCBudWxsKTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxsKQogICAgICAg\nICAgICBfY3VzdG9tLmN1c3RvbWl6ZShmaWVsZCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgYSBjbGFzcyBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4g\ndGFibGUsIG9yIHJldHVybiBudWxsIGlmCiAgICAgKiBjdXN0b21pemVyIHJl\namVjdHMuCiAgICAgKi8KICAgIHByaXZhdGUgQ2xhc3NNYXBwaW5nIG5ld0Ns\nYXNzTWFwcGluZyhUYWJsZSB0YWJsZSwgQ2xhc3MgcGFyZW50KSB7CiAgICAg\nICAgU3RyaW5nIG5hbWUgPSBnZXRDbGFzc05hbWUodGFibGUpOwogICAgICAg\nIGlmIChfY3VzdG9tICE9IG51bGwpCiAgICAgICAgICAgIG5hbWUgPSBfY3Vz\ndG9tLmdldENsYXNzTmFtZSh0YWJsZSwgbmFtZSk7CiAgICAgICAgaWYgKG5h\nbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\ncmV0dXJuIG5ld0NsYXNzTWFwcGluZyhnZW5lcmF0ZUNsYXNzKG5hbWUsIHBh\ncmVudCksIHRhYmxlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nIGZpZWxkIG1hcHBpbmcgZm9yIHRoZSBnaXZlbiBpbmZvLCBvciByZXR1cm4g\nbnVsbCBpZgogICAgICogY3VzdG9taXplciByZWplY3RzLgogICAgICovCiAg\nICBwdWJsaWMgRmllbGRNYXBwaW5nIG5ld0ZpZWxkTWFwcGluZyhTdHJpbmcg\nbmFtZSwgQ2xhc3MgdHlwZSwgQ29sdW1uIGNvbCwKICAgICAgICBGb3JlaWdu\nS2V5IGZrLCBDbGFzc01hcHBpbmcgZGVjKSB7CiAgICAgICAgaWYgKF9jdXN0\nb20gIT0gbnVsbCkgewogICAgICAgICAgICBDb2x1bW5bXSBjb2xzID0gKGZr\nID09IG51bGwpID8gbmV3IENvbHVtbltdeyBjb2wgfQogICAgICAgICAgICAg\nICAgOiBmay5nZXRDb2x1bW5zKCk7CiAgICAgICAgICAgIFN0cmluZyBuZXdO\nYW1lID0gX2N1c3RvbS5nZXRGaWVsZE5hbWUoZGVjLCBjb2xzLCBmaywgbmFt\nZSk7CiAgICAgICAgICAgIGlmIChuZXdOYW1lID09IG51bGwgfHwgIW5ld05h\nbWUuZXF1YWxzKG5hbWUpKSB7CiAgICAgICAgICAgICAgICBpZiAoX2FiYW5k\nb25lZEZpZWxkTmFtZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBf\nYWJhbmRvbmVkRmllbGROYW1lcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAg\nICAgICAgICBfYWJhbmRvbmVkRmllbGROYW1lcy5hZGQoZGVjLmdldERlc2Ny\naWJlZFR5cGUoKS5nZXROYW1lKCkKICAgICAgICAgICAgICAgICAgICArICIu\nIiArIG5hbWUpOwogICAgICAgICAgICAgICAgaWYgKG5ld05hbWUgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAg\nICAgICAgIG5hbWUgPSBuZXdOYW1lOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQgPSBkZWMuYWRkRGVjbGFy\nZWRGaWVsZE1hcHBpbmcobmFtZSwgdHlwZSk7CiAgICAgICAgZmllbGQuc2V0\nRXhwbGljaXQodHJ1ZSk7CiAgICAgICAgcmV0dXJuIGZpZWxkOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIGEgSmF2YSBpZGVudGlmaWVyLWZvcm1h\ndHRlZCBuYW1lIGZvciB0aGUgZ2l2ZW4gdGFibGUKICAgICAqIG5hbWUsIHVz\naW5nIHRoZSBkZWZhdWx0IHBhY2thZ2UuCiAgICAgKi8KICAgIHByaXZhdGUg\nU3RyaW5nIGdldENsYXNzTmFtZShUYWJsZSB0YWJsZSkgewogICAgICAgIFN0\ncmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAg\naWYgKGdldFBhY2thZ2VOYW1lKCkgIT0gbnVsbCkKICAgICAgICAgICAgYnVm\nLmFwcGVuZChnZXRQYWNrYWdlTmFtZSgpKS5hcHBlbmQoIi4iKTsKCiAgICAg\nICAgU3RyaW5nW10gc3ViczsKICAgICAgICBTdHJpbmcgbmFtZSA9IHJlcGxh\nY2VJbnZhbGlkQ2hhcmFjdGVycyh0YWJsZS5nZXRTY2hlbWFOYW1lKCkpOwog\nICAgICAgIGlmIChfdXNlU2NoZW1hICYmIG5hbWUgIT0gbnVsbCkgewogICAg\nICAgICAgICBpZiAoYWxsVXBwZXJDYXNlKG5hbWUpKQogICAgICAgICAgICAg\nICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgc3Vi\ncyA9IFN0cmluZ3Muc3BsaXQobmFtZSwgIl8iLCAwKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBzdWJzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZChTdHJpbmdVdGlscy5jYXBpdGFsaXNlKHN1\nYnNbaV0pKTsKICAgICAgICB9CgogICAgICAgIG5hbWUgPSByZXBsYWNlSW52\nYWxpZENoYXJhY3RlcnModGFibGUuZ2V0TmFtZSgpKTsKICAgICAgICBpZiAo\nYWxsVXBwZXJDYXNlKG5hbWUpKQogICAgICAgICAgICBuYW1lID0gbmFtZS50\nb0xvd2VyQ2FzZSgpOwogICAgICAgIHN1YnMgPSBTdHJpbmdzLnNwbGl0KG5h\nbWUsICJfIiwgMCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdWJz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUg\nbmFtZSBjYW4ndCBjb25mbGljdCB3aXRoIGdlbmVyYXRlZCBpZCBjbGFzcyBu\nYW1lczsKICAgICAgICAgICAgLy8gaWYgdGhlIG5hbWUgd291bGQgZW5kIGlu\nICdJZCcsIG1ha2UgaXQgZW5kIGluICdJZGVudCcKICAgICAgICAgICAgaWYg\nKGkgPT0gc3Vicy5sZW5ndGggLSAxICYmIHN1YnNbaV0uZXF1YWxzSWdub3Jl\nQ2FzZSgiaWQiKSkKICAgICAgICAgICAgICAgIHN1YnNbaV0gPSAiaWRlbnQi\nOwogICAgICAgICAgICBidWYuYXBwZW5kKFN0cmluZ1V0aWxzLmNhcGl0YWxp\nc2Uoc3Vic1tpXSkpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGJ1Zi50\nb1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgZGVm\nYXVsdCBKYXZhIGlkZW50aWZpZXItZm9ybWF0dGVkIG5hbWUgZm9yIHRoZSBn\naXZlbgogICAgICogY29sdW1uL3RhYmxlIG5hbWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0RmllbGROYW1lKFN0cmluZyBuYW1lLCBDbGFzc01h\ncHBpbmcgZGVjKSB7CiAgICAgICAgbmFtZSA9IHJlcGxhY2VJbnZhbGlkQ2hh\ncmFjdGVycyhuYW1lKTsKICAgICAgICBpZiAoYWxsVXBwZXJDYXNlKG5hbWUp\nKQogICAgICAgICAgICBuYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgbmFtZSA9IENoYXJhY3Rlci50b0xvd2Vy\nQ2FzZShuYW1lLmNoYXJBdCgwKSkgKyBuYW1lLnN1YnN0cmluZygxKTsKCiAg\nICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsK\nICAgICAgICBTdHJpbmdbXSBzdWJzID0gU3RyaW5ncy5zcGxpdChuYW1lLCAi\nXyIsIDApOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoaSA+IDApCiAgICAgICAgICAg\nICAgICBzdWJzW2ldID0gU3RyaW5nVXRpbHMuY2FwaXRhbGlzZShzdWJzW2ld\nKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChzdWJzW2ldKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGdldFVuaXF1ZU5hbWUoYnVmLnRvU3RyaW5nKCks\nIGRlYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBkZWZhdWx0\nIGphdmEgaWRlbnRpZmllci1mb3JtYXR0ZWQgZmllbGQgcmVsYXRpb24gbmFt\nZQogICAgICogZm9yIHRoZSBnaXZlbiBjbGFzcyBuYW1lLgogICAgICovCiAg\nICBwcml2YXRlIFN0cmluZyBnZXRSZWxhdGlvbk5hbWUoQ2xhc3MgZmllbGRU\neXBlLCBib29sZWFuIGNvbGwsCiAgICAgICAgRm9yZWlnbktleSBmaywgYm9v\nbGVhbiBpbnZlcnNlLCBDbGFzc01hcHBpbmcgZGVjKSB7CiAgICAgICAgaWYg\nKF91c2VGSyAmJiBmay5nZXROYW1lKCkgIT0gbnVsbCkgewogICAgICAgICAg\nICBTdHJpbmcgbmFtZSA9IGdldEZpZWxkTmFtZShmay5nZXROYW1lKCksIGRl\nYyk7CiAgICAgICAgICAgIGlmIChpbnZlcnNlICYmIGNvbGwpCiAgICAgICAg\nICAgICAgICBuYW1lID0gbmFtZSArICJJbnZlcnNlcyI7CiAgICAgICAgICAg\nIGVsc2UgaWYgKGludmVyc2UpCiAgICAgICAgICAgICAgICBuYW1lID0gbmFt\nZSArICJJbnZlcnNlIjsKICAgICAgICAgICAgcmV0dXJuIGdldFVuaXF1ZU5h\nbWUobmFtZSwgZGVjKTsKICAgICAgICB9CgogICAgICAgIC8vIGdldCBqdXN0\nIHRoZSBjbGFzcyBuYW1lLCB3L28gcGFja2FnZQogICAgICAgIFN0cmluZyBu\nYW1lID0gZmllbGRUeXBlLmdldE5hbWUoKTsKICAgICAgICBuYW1lID0gbmFt\nZS5zdWJzdHJpbmcobmFtZS5sYXN0SW5kZXhPZignLicpICsgMSk7CgogICAg\nICAgIC8vIG1ha2UgdGhlIGZpcnN0IGNoYXJhY3RlciBsb3dlcmNhc2UgYW5k\nIHBsdXJhbGl6ZSBpZiBhIGNvbGxlY3Rpb24KICAgICAgICBuYW1lID0gQ2hh\ncmFjdGVyLnRvTG93ZXJDYXNlKG5hbWUuY2hhckF0KDApKSArIG5hbWUuc3Vi\nc3RyaW5nKDEpOwogICAgICAgIGlmIChjb2xsICYmICFuYW1lLmVuZHNXaXRo\nKCJzIikpCiAgICAgICAgICAgIG5hbWUgKz0gInMiOwoKICAgICAgICByZXR1\ncm4gZ2V0VW5pcXVlTmFtZShuYW1lLCBkZWMpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIHN0cmluZyBpcyBhbGwg\ndXBwZXJjYXNlIGxldHRlcnMuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIGJvb2xlYW4gYWxsVXBwZXJDYXNlKFN0cmluZyBzdHIpIHsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IHN0ci5sZW5ndGgoKTsgaSsrKSB7CiAgICAg\nICAgICAgIGlmIChDaGFyYWN0ZXIuaXNMZXR0ZXIoc3RyLmNoYXJBdChpKSkK\nICAgICAgICAgICAgICAgICYmICFDaGFyYWN0ZXIuaXNVcHBlckNhc2Uoc3Ry\nLmNoYXJBdChpKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogUmVwbGFjZSBjaGFyYWN0ZXJzIG5vdCBhbGxvd2VkIGluIEphdmEg\nbmFtZXMgd2l0aCBhbiB1bmRlcnNjb3JlOwogICAgICogcGFja2FnZS1wcml2\nYXRlIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBzdGF0aWMgU3RyaW5nIHJl\ncGxhY2VJbnZhbGlkQ2hhcmFjdGVycyhTdHJpbmcgc3RyKSB7CiAgICAgICAg\naWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoc3RyKSkKICAgICAgICAgICAgcmV0\ndXJuIHN0cjsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJp\nbmdCdWZmZXIoc3RyKTsKICAgICAgICBjaGFyIGM7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBidWYubGVuZ3RoKCk7IGkrKykgewogICAgICAgICAg\nICBjID0gYnVmLmNoYXJBdChpKTsKICAgICAgICAgICAgaWYgKGMgPT0gJyQn\nIHx8ICFDaGFyYWN0ZXIuaXNKYXZhSWRlbnRpZmllclBhcnQoc3RyLmNoYXJB\ndChpKSkpCiAgICAgICAgICAgICAgICBidWYuc2V0Q2hhckF0KGksICdfJyk7\nCiAgICAgICAgfQoKICAgICAgICAvLyBzdHJpcCBsZWFkaW5nIGFuZCB0cmFp\nbGluZyB1bmRlcnNjb3JlcwogICAgICAgIGludCBzdGFydCA9IDA7CiAgICAg\nICAgd2hpbGUgKHN0YXJ0IDwgYnVmLmxlbmd0aCgpICYmIGJ1Zi5jaGFyQXQo\nc3RhcnQpID09ICdfJykKICAgICAgICAgICAgc3RhcnQrKzsKICAgICAgICBp\nbnQgZW5kID0gYnVmLmxlbmd0aCgpIC0gMTsKICAgICAgICB3aGlsZSAoZW5k\nID49IDAgJiYgYnVmLmNoYXJBdChlbmQpID09ICdfJykKICAgICAgICAgICAg\nZW5kLS07CgogICAgICAgIC8vIHBvc3NpYmxlIHRoYXQgYWxsIGNoYXJzIGlu\nIG5hbWUgYXJlIGludmFsaWQKICAgICAgICBpZiAoc3RhcnQgPiBlbmQpCiAg\nICAgICAgICAgIHJldHVybiAieCI7CiAgICAgICAgcmV0dXJuIGJ1Zi5zdWJz\ndHJpbmcoc3RhcnQsIGVuZCArIDEpOwogICAgfQoKICAgIC8qKgogICAgICog\nTW9kaWZpZXMgdGhlIGdpdmVuIG5hbWUgYXMgbmVjZXNzYXJ5IHRvIGVuc3Vy\nZSB0aGF0IGl0IGlzbid0IGFscmVhZHkKICAgICAqIHRha2VuIGJ5IGEgZmll\nbGQgaW4gdGhlIGdpdmVuIHBhcmVudC4KICAgICAqLwogICAgcHJpdmF0ZSBT\ndHJpbmcgZ2V0VW5pcXVlTmFtZShTdHJpbmcgbmFtZSwgQ2xhc3NNYXBwaW5n\nIGRlYykgewogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgbmFtZSBpc24ndCBh\nIGtleXdvcmQKICAgICAgICBpZiAoX2phdmFLZXl3b3Jkcy5jb250YWluc0tl\neShuYW1lKSkKICAgICAgICAgICAgbmFtZSA9IChTdHJpbmcpIF9qYXZhS2V5\nd29yZHMuZ2V0KG5hbWUpOwoKICAgICAgICAvLyB0aGlzIGlzIHRoZSBzYW1l\nIGFsZ29yaXRobSB1c2VkIGluIERCRGljdGlvbmFyeSB0byBnZXQgdW5pcXVl\nIG5hbWVzCiAgICAgICAgU3RyaW5nIHByZWZpeCA9IGRlYy5nZXREZXNjcmli\nZWRUeXBlKCkuZ2V0TmFtZSgpICsgIi4iOwogICAgICAgIGZvciAoaW50IHZl\ncnNpb24gPSAyLCBjaGFycyA9IDE7CiAgICAgICAgICAgIGRlYy5nZXREZWNs\nYXJlZEZpZWxkKG5hbWUpICE9IG51bGwKICAgICAgICAgICAgICAgIHx8IChf\nYWJhbmRvbmVkRmllbGROYW1lcyAhPSBudWxsCiAgICAgICAgICAgICAgICAm\nJiBfYWJhbmRvbmVkRmllbGROYW1lcy5jb250YWlucyhwcmVmaXggKyBuYW1l\nKSk7IHZlcnNpb24rKykgewogICAgICAgICAgICBpZiAodmVyc2lvbiA+IDIp\nCiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMCwgbmFt\nZS5sZW5ndGgoKSAtIGNoYXJzKTsKICAgICAgICAgICAgaWYgKHZlcnNpb24g\nPj0gTWF0aC5wb3coMTAsIGNoYXJzKSkKICAgICAgICAgICAgICAgIGNoYXJz\nKys7CiAgICAgICAgICAgIG5hbWUgPSBuYW1lICsgdmVyc2lvbjsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIGRlZmF1bHQgZmllbGQgdHlwZSBmb3IgdGhlIGdpdmVu\nIGNvbHVtbi4KICAgICAqLwogICAgcHVibGljIENsYXNzIGdldEZpZWxkVHlw\nZShDb2x1bW4gY29sLCBib29sZWFuIGZvcmNlT2JqZWN0KSB7CiAgICAgICAg\nLy8gY2hlY2sgdGhlIGN1c3RvbSB0eXBlIG1hcCB0byBzZWUgaWYgd2UndmUg\nb3ZlcnJpZGRlbiB0aGUKICAgICAgICAvLyBkZWZhdWx0IHR5cGUgdG8gY3Jl\nYXRlIGZvciBhIHJhdyBTUUwgdHlwZSBuYW1lCiAgICAgICAgQ2xhc3MgdHlw\nZSA9IG51bGw7CiAgICAgICAgaWYgKF90eXBlTWFwICE9IG51bGwpIHsKICAg\nICAgICAgICAgLy8gZmlyc3QgdHJ5ICJUWVBFKFNJWkUsREVDSU1BTFMpIiwg\ndGhlbiAiVFlQRShTSVpFKSwgdGhlbiAiVFlQRSIKICAgICAgICAgICAgU3Ry\naW5nW10gcHJvcE5hbWVzID0gbmV3IFN0cmluZ1tdewogICAgICAgICAgICAg\nICAgY29sLmdldFR5cGVOYW1lKCkgKyAiKCIgKyBjb2wuZ2V0U2l6ZSgpICsg\nIiwiCiAgICAgICAgICAgICAgICAgICAgKyBjb2wuZ2V0RGVjaW1hbERpZ2l0\ncygpICsgIikiLAogICAgICAgICAgICAgICAgY29sLmdldFR5cGVOYW1lKCkg\nKyAiKCIgKyBjb2wuZ2V0U2l6ZSgpICsgIikiLAogICAgICAgICAgICAgICAg\nY29sLmdldFR5cGVOYW1lKCkKICAgICAgICAgICAgfTsKCiAgICAgICAgICAg\nIFN0cmluZyB0eXBlTmFtZSA9IG51bGw7CiAgICAgICAgICAgIFN0cmluZyB0\neXBlU3BlYyA9IG51bGw7CiAgICAgICAgICAgIGludCBuYW1lSWR4ID0gMDsK\nICAgICAgICAgICAgZm9yICg7IHR5cGVTcGVjID09IG51bGwgJiYgbmFtZUlk\neCA8IHByb3BOYW1lcy5sZW5ndGg7IG5hbWVJZHgrKykgewogICAgICAgICAg\nICAgICAgaWYgKHByb3BOYW1lc1tuYW1lSWR4XSA9PSBudWxsKQogICAgICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIHR5cGVT\ncGVjID0gU3RyaW5nVXRpbHMudHJpbVRvTnVsbChfdHlwZU1hcC5nZXRQcm9w\nZXJ0eQogICAgICAgICAgICAgICAgICAgIChwcm9wTmFtZXNbbmFtZUlkeF0p\nKTsKICAgICAgICAgICAgICAgIGlmICh0eXBlU3BlYyAhPSBudWxsKSAKICAg\nICAgICAgICAgICAgICAgICB0eXBlTmFtZSA9IHByb3BOYW1lc1tuYW1lSWR4\nXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodHlwZVNwZWMgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9jLmdldCgicmV2\nZXJzZS10eXBlIiwgdHlwZU5hbWUsIHR5cGVTcGVjKSk7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIF9sb2cudHJhY2UoX2xvYy5nZXQoIm5v\nLXJldmVyc2UtdHlwZSIsCiAgICAgICAgICAgICAgICAgICAgcHJvcE5hbWVz\nW3Byb3BOYW1lcy5sZW5ndGggLSAxXSkpOwoKICAgICAgICAgICAgaWYgKHR5\ncGVTcGVjICE9IG51bGwpCiAgICAgICAgICAgICAgICB0eXBlID0gU3RyaW5n\ncy50b0NsYXNzKHR5cGVTcGVjLCBfY29uZi4KICAgICAgICAgICAgICAgICAg\nICBnZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS5nZXRDbGFzc0xvYWRlcgog\nICAgICAgICAgICAgICAgICAgIChSZXZlcnNlTWFwcGluZ1Rvb2wuY2xhc3Ms\nIG51bGwpKTsKICAgICAgICB9CgogICAgICAgIGlmICh0eXBlID09IG51bGwp\nCiAgICAgICAgICAgIHR5cGUgPSBTY2hlbWFzLmdldEphdmFUeXBlKGNvbC5n\nZXRUeXBlKCksIGNvbC5nZXRTaXplKCksCiAgICAgICAgICAgICAgICBjb2wu\nZ2V0RGVjaW1hbERpZ2l0cygpKTsKICAgICAgICBpZiAodHlwZSA9PSBPYmpl\nY3QuY2xhc3MpIHsKICAgICAgICAgICAgaWYgKCFfYmxvYkFzT2JqKQogICAg\nICAgICAgICAgICAgcmV0dXJuIGJ5dGVbXS5jbGFzczsKICAgICAgICAgICAg\ncmV0dXJuIHR5cGU7CiAgICAgICAgfQoKICAgICAgICAvLyB0cmVhdCBjaGFy\ncyBzcGVjaWFsbHk7IGlmIHRoZSBkaWN0aW9uYXJ5IGhhcyBzdG9yZUNoYXJz\nQXNOdW1iZXJzCiAgICAgICAgLy8gc2V0LCB0aGVuIHdlIGNhbid0IHJldmVy\nc2UgbWFwIGludG8gYSBjaGFyOyB1c2UgYSBzdHJpbmcgYW5kIHRlbGwKICAg\nICAgICAvLyB0aGUgdXNlciB3aHkgd2UgYXJlIGRvaW5nIHNvCiAgICAgICAg\naWYgKHR5cGUgPT0gY2hhci5jbGFzcwogICAgICAgICAgICAmJiBfY29uZi5n\nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpLnN0b3JlQ2hhcnNBc051bWJlcnMp\nIHsKICAgICAgICAgICAgdHlwZSA9IFN0cmluZy5jbGFzczsKICAgICAgICAg\nICAgaWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nX2xvZy53YXJuKF9sb2MuZ2V0KCJjYW50LXVzZS1jaGFyIiwgY29sLmdldEZ1\nbGxOYW1lKCkpKTsKICAgICAgICB9CgogICAgICAgIGlmICghdHlwZS5pc1By\naW1pdGl2ZSgpKQogICAgICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICBp\nZiAoIWZvcmNlT2JqZWN0ICYmIChjb2wuaXNOb3ROdWxsKCkgfHwgIV9udWxs\nQXNPYmopKQogICAgICAgICAgICByZXR1cm4gdHlwZTsKCiAgICAgICAgLy8g\nY29udmVydCB0aGUgdHlwZSBpbnRvIHRoZSBhcHByb3ByaWF0ZSB3cmFwcGVy\nIGNsYXNzCiAgICAgICAgc3dpdGNoICh0eXBlLmdldE5hbWUoKS5jaGFyQXQo\nMCkpIHsKICAgICAgICAgICAgY2FzZSdiJzoKICAgICAgICAgICAgICAgIGlm\nICh0eXBlID09IGJvb2xlYW4uY2xhc3MpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIEJvb2xlYW4uY2xhc3M7CiAgICAgICAgICAgICAgICByZXR1cm4g\nQnl0ZS5jbGFzczsKICAgICAgICAgICAgY2FzZSdjJzoKICAgICAgICAgICAg\nICAgIHJldHVybiBDaGFyYWN0ZXIuY2xhc3M7CiAgICAgICAgICAgIGNhc2Un\nZCc6CiAgICAgICAgICAgICAgICByZXR1cm4gRG91YmxlLmNsYXNzOwogICAg\nICAgICAgICBjYXNlJ2YnOgogICAgICAgICAgICAgICAgcmV0dXJuIEZsb2F0\nLmNsYXNzOwogICAgICAgICAgICBjYXNlJ2knOgogICAgICAgICAgICAgICAg\ncmV0dXJuIEludGVnZXIuY2xhc3M7CiAgICAgICAgICAgIGNhc2UnbCc6CiAg\nICAgICAgICAgICAgICByZXR1cm4gTG9uZy5jbGFzczsKICAgICAgICAgICAg\nY2FzZSdzJzoKICAgICAgICAgICAgICAgIHJldHVybiBTaG9ydC5jbGFzczsK\nICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBhIG5ldyB0b29sIHdpdGggdGhlIHNhbWUgc2V0\ndGluZ3MgYXMgdGhpcyBvbmUuIFVzZWQgaW4gd29ya2JlbmNoLgogICAgICov\nCiAgICBwdWJsaWMgT2JqZWN0IGNsb25lKCkgewogICAgICAgIFJldmVyc2VN\nYXBwaW5nVG9vbCB0b29sID0gbmV3IFJldmVyc2VNYXBwaW5nVG9vbChfY29u\nZik7CiAgICAgICAgdG9vbC5zZXRTY2hlbWFHcm91cChnZXRTY2hlbWFHcm91\ncCgpKTsKICAgICAgICB0b29sLnNldFBhY2thZ2VOYW1lKGdldFBhY2thZ2VO\nYW1lKCkpOwogICAgICAgIHRvb2wuc2V0RGlyZWN0b3J5KGdldERpcmVjdG9y\neSgpKTsKICAgICAgICB0b29sLnNldFVzZVNjaGVtYU5hbWUoZ2V0VXNlU2No\nZW1hTmFtZSgpKTsKICAgICAgICB0b29sLnNldFVzZUZvcmVpZ25LZXlOYW1l\nKGdldFVzZUZvcmVpZ25LZXlOYW1lKCkpOwogICAgICAgIHRvb2wuc2V0TnVs\nbGFibGVBc09iamVjdChnZXROdWxsYWJsZUFzT2JqZWN0KCkpOwogICAgICAg\nIHRvb2wuc2V0QmxvYkFzT2JqZWN0KGdldEJsb2JBc09iamVjdCgpKTsKICAg\nICAgICB0b29sLnNldFByaW1hcnlLZXlPbkpvaW4oZ2V0UHJpbWFyeUtleU9u\nSm9pbigpKTsKICAgICAgICB0b29sLnNldFVzZURhdGFTdG9yZUlkZW50aXR5\nKGdldFVzZURhdGFTdG9yZUlkZW50aXR5KCkpOwogICAgICAgIHRvb2wuc2V0\nVXNlQnVpbHRpbklkZW50aXR5Q2xhc3MoZ2V0VXNlQnVpbHRpbklkZW50aXR5\nQ2xhc3MoKSk7CiAgICAgICAgdG9vbC5zZXRJbm5lcklkZW50aXR5Q2xhc3Nl\ncyhnZXRJbm5lcklkZW50aXR5Q2xhc3NlcygpKTsKICAgICAgICB0b29sLnNl\ndElkZW50aXR5Q2xhc3NTdWZmaXgoZ2V0SWRlbnRpdHlDbGFzc1N1ZmZpeCgp\nKTsKICAgICAgICB0b29sLnNldEludmVyc2VSZWxhdGlvbnMoZ2V0SW52ZXJz\nZVJlbGF0aW9ucygpKTsKICAgICAgICB0b29sLnNldERldGFjaGFibGUoZ2V0\nRGV0YWNoYWJsZSgpKTsKICAgICAgICB0b29sLnNldEN1c3RvbWl6ZXIoZ2V0\nQ3VzdG9taXplcigpKTsKICAgICAgICB0b29sLnNldENvZGVGb3JtYXQoZ2V0\nQ29kZUZvcm1hdCgpKTsKICAgICAgICByZXR1cm4gdG9vbDsKICAgIH0KCiAg\nICAvLy8vLy8vLwogICAgLy8gTWFpbgogICAgLy8vLy8vLy8KCiAgICAvKioK\nICAgICAqIFVzYWdlOiBqYXZhIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuUmV2ZXJzZU1hcHBpbmdUb29sCiAgICAgKiBbb3B0aW9uXSogJmx0Oy5z\nY2hlbWEgZmlsZSBvciByZXNvdXJjZSZndDsqCiAgICAgKiAgV2hlcmUgdGhl\nIGZvbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVs\nPgogICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVz\nIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9y\nIHJlc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBj\nb250YWluaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBzdWNoIGFzIHRoZSBsaWNl\nbnNlIGtleQlkYXRhIGFzIG91dGxpbmVkIGluCiAgICAgKiB7QGxpbmsgT3Bl\nbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgogICAgICogPGxp\nPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3BlcnR5IHZhbHVl\nJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVzIG9mIHRoZSBP\ncGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2FuIGJlIHNldCBi\neQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBseWluZyBhIHZh\nbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNlbnNlS2V5IGFk\nc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDxsaT48aT4tc2No\nZW1hcy8tcyAmbHQ7c2NoZW1hcyBhbmQgdGFibGVzJmd0OzwvaT46IENvbW1h\nLXNlcGFyYXRlZAogICAgICogbGlzdCBvZiBzY2hlbWFzIGFuZCB0YWJsZXMg\ndG8gcmV2ZXJzZS1tYXAuPC9saT4KICAgICAqIDxsaT48aT4tcGFja2FnZS8t\ncGtnICZsdDtwYWNrYWdlIG5hbWUmZ3Q7PC9pPjogVGhlIG5hbWUgb2YgdGhl\nIHBhY2thZ2UKICAgICAqIGZvciBhbGwgZ2VuZXJhdGVkIGNsYXNzZXMuIERl\nZmF1bHRzIHRvIG5vIHBhY2thZ2UuPC9saT4KICAgICAqIDxsaT48aT4tZGly\nZWN0b3J5Ly1kICZsdDtvdXRwdXQgZGlyZWN0b3J5Jmd0OzwvaT46IFRoZSBk\naXJlY3Rvcnkgd2hlcmUKICAgICAqIGFsbCBnZW5lcmF0ZWQgY29kZSBzaG91\nbGQgYmUgcGxhY2VkLiBEZWZhdWx0cyB0byB0aGUgY3VycmVudAogICAgICog\nZGlyZWN0b3J5LjwvbGk+CiAgICAgKiA8bGk+PGk+LXVzZVNjaGVtYU5hbWUv\nLXNuICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0aGlzIGZs\nYWcgdG8KICAgICAqIHRydWUgdG8gaW5jbHVkZSB0aGUgc2NoZW1hIG5hbWUg\nYXMgcGFydCBvZiB0aGUgZ2VuZXJhdGVkIGNsYXNzIG5hbWUKICAgICAqIGZv\nciBlYWNoIHRhYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+LXVzZUZvcmVpZ25L\nZXlOYW1lLy1ma24gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0\nIHRoaXMKICAgICAqIGZsYWcgdG8gdHJ1ZSB0byB1c2UgdGhlIGZvcmVpZ24g\na2V5IG5hbWUgdG8gZ2VuZXJhdGUgZmllbGRzCiAgICAgKiByZXByZXNlbnRp\nbmcgcmVsYXRpb25zIGJldHdlZW4gY2xhc3Nlcy48L2xpPgogICAgICogPGxp\nPjxpPi1udWxsYWJsZUFzT2JqZWN0Ly1ubyAmbHQ7dHJ1ZS90IHwgZmFsc2Uv\nZiZndDs8L2k+OiBTZXQgdG8gdHJ1ZQogICAgICogdG8gbWFrZSBhbGwgbnVs\nbGFibGUgY29sdW1ucyBtYXAgdG8gb2JqZWN0IHR5cGVzOyBjb2x1bW5zIHRo\nYXQgd291bGQKICAgICAqIG5vcm1hbGx5IG1hcCB0byBhIHByaW1pdGl2ZSB3\naWxsIG1hcCB0byB0aGUgYXBwcm9wcmlhdGUgd3JhcHBlcgogICAgICogdHlw\nZSBpbnN0ZWFkLjwvbGk+CiAgICAgKiA8bGk+PGk+LWJsb2JBc09iamVjdC8t\nYm8gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvIHRydWUK\nICAgICAqIHRvIG1ha2UgYWxsIGJpbmFyeSBjb2x1bW5zIG1hcCB0byBPYmpl\nY3QgcmF0aGVyIHRoYW4gYnl0ZVtdLjwvbGk+CiAgICAgKiA8bGk+PGk+LXR5\ncGVNYXAvLXR5cCAmbHQ7dHlwZXMmZ3Q7PC9pPjogRGVmYXVsdCBtYXBwaW5n\nIG9mIFNRTCB0eXBlCiAgICAgKiBuYW1lcyB0byBKYXZhIGNsYXNzZXMuPC9s\naT4KICAgICAqIDxsaT48aT4tcHJpbWFyeUtleU9uSm9pbi8tcGtqICZsdDt0\ncnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0byB0cnVlCiAgICAgKiB0\nbyBhbGxvdyBwcmltYXJ5IGtleXMgb24gam9pbiB0YWJsZXMuPC9saT4KICAg\nICAqIDxsaT48aT4tdXNlRGF0YXN0b3JlSWRlbnRpdHkvLWRzICZsdDt0cnVl\nL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0bwogICAgICogdHJ1ZSB0byB1\nc2UgZGF0YXN0b3JlIGlkZW50aXR5IHdoZXJlIHBvc3NpYmxlLjwvbGk+CiAg\nICAgKiA8bGk+PGk+LXVzZUJ1aWx0aW5JZGVudGl0eUNsYXNzLy1iaWMgJmx0\nO3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0CiAgICAgKiB0byBmYWxz\nZSB0byBuZXZlciB1c2UgT3BlbkpQQSdzIGJ1aWx0aW4gYXBwbGljYXRpb24g\naWRlbnRpdHkKICAgICAqIGNsYXNzZXMuPC9saT4KICAgICAqIDxsaT48aT4t\naW5uZXJJZGVudGl0eUNsYXNzZXMvLWlubiAmbHQ7dHJ1ZS90IHwgZmFsc2Uv\nZiZndDs8L2k+OiBTZXQgdG8KICAgICAqIHRydWUgdG8gZ2VuZXJhdGUgdGhl\nIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNsYXNzZXMgYXMgaW5uZXIgY2xhc3Nl\ncy48L2xpPgogICAgICogPGxpPjxpPi1pZGVudGl0eUNsYXNzU3VmZml4Ly1p\ncyAmbHQ7c3VmZml4Jmd0OzwvaT46IFN1ZmZpeCB0byBhcHBlbmQKICAgICAq\nIHRvIGNsYXNzIG5hbWVzIHRvIGNyZWF0ZSBpZGVudGl0eSBjbGFzcyBuYW1l\nLCBvciBmb3IgaW5uZXIgaWRlbnRpdHkKICAgICAqIGNsYXNzZXMsIHRoZSBp\nbm5lciBjbGFzcyBuYW1lLjwvbGk+CiAgICAgKiA8bGk+PGk+LWludmVyc2VS\nZWxhdGlvbnMvLWlyICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNl\ndCB0bwogICAgICogZmFsc2UgdG8gcHJldmVudCB0aGUgY3JlYXRpb24gb2Yg\naW52ZXJzZSAxLW1hbnkvMS0xIHJlbGF0aW9ucyBmb3IKICAgICAqIGVhY2gg\nZW5jb3VudGVyZWQgbWFueS0xLzEtMSByZWxhdGlvbi48L2xpPgogICAgICog\nPGxpPjxpPi1kZXRhY2hhYmxlLy1kZXQgJmx0O3RydWUvdCB8IGZhbHNlL2Ym\nZ3Q7PC9pPjogU2V0IHRvCiAgICAgKiB0cnVlIHRvIG1ha2UgZ2VuZXJhdGVk\nIGNsYXNzZXMgZGV0YWNoYWJsZS48L2xpPgogICAgICogPGxpPjxpPi1kaXNj\ncmltaW5hdG9yU3RyYXRlZ3kvLWRzICZsdDtzdHJhdGVneSZndDs8L2k+OiBU\naGUgZGVmYXVsdAogICAgICogZGlzY3JpbWluYXRvciBzdHJhdGVneSB0byBw\nbGFjZSBvbiBiYXNlIGNsYXNzZXMuPC9saT4KICAgICAqIDxsaT48aT4tdmVy\nc2lvblN0cmF0ZWd5Ly12cyAmbHQ7c3RyYXRlZ3kmZ3Q7PC9pPjogVGhlIGRl\nZmF1bHQKICAgICAqIHZlcnNpb24gc3RyYXRlZ3kgdG8gcGxhY2Ugb24gYmFz\nZSBjbGFzc2VzLjwvbGk+CiAgICAgKiA8bGk+PGk+LW1ldGFkYXRhLy1tZCAm\nbHQ7Y2xhc3MgfCBwYWNrYWdlJmd0OzwvaT46IFNwZWNpZnkgdGhlIGxldmVs\nIHRoZQogICAgICogbWV0YWRhdGEgc2hvdWxkIGJlIGdlbmVyYXRlZCBhdC4g\nRGVmYXVsdHMgdG8gZ2VuZXJhdGluZyBhCiAgICAgKiBzaW5nbGUgcGFja2Fn\nZS1sZXZlbCBtZXRhZGF0YSBmaWxlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWN1\nc3RvbWl6ZXJDbGFzcy8tY2MgJmx0O2NsYXNzIG5hbWUmZ3Q7PC9pPjogVGhl\nIGZ1bGwgY2xhc3MKICAgICAqIG5hbWUgb2YgYSB7QGxpbmsgUmV2ZXJzZUN1\nc3RvbWl6ZXJ9IGltcGxlbWVudGF0aW9uIHRvIHVzZSB0bwogICAgICogY3Vz\ndG9taXplIHRoZSByZXZlcnNlIG1hcHBpbmcgcHJvY2Vzcy4gT3B0aW9uYWwu\nPC9saT4KICAgICAqIDxsaT48aT4tY3VzdG9taXplclByb3BlcnRpZXMvLWNw\nICZsdDtwcm9wZXJ0aWVzIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPgogICAg\nICogOiBUaGUgcGF0aCBvciByZXNvdXJjZSBuYW1lIG9mIGEgcHJvcGVydGll\ncyBmaWxlIHRoYXQgd2lsbCBiZQogICAgICogcGFzc2VkIHRvIHRoZSByZXZl\ncnNlIGN1c3RvbWl6ZXIgb24gaW5pdGlhbGl6YXRpb24uIE9wdGlvbmFsLjwv\nbGk+CiAgICAgKiA8bGk+PGk+LWN1c3RvbWl6ZXIvLWMuJmx0O3Byb3BlcnR5\nIG5hbWUmZ3Q7ICZsdDsgcHJvcGVydHkgdmFsdWUmZ3Q7PC9pPgogICAgICog\nOiBBcmd1bWVudHMgbGlrZSB0aGlzIHdpbGwgYmUgdXNlZCB0byBjb25maWd1\ncmUgdGhlIGJlYW4KICAgICAqIHByb3BlcnRpZXMgb2YgdGhlIHtAbGluayBS\nZXZlcnNlQ3VzdG9taXplcn0uPC9saT4KICAgICAqIDxsaT48aT4tY29kZUZv\ncm1hdC8tY2YuJmx0O3Byb3BlcnR5IG5hbWUmZ3Q7ICZsdDsgcHJvcGVydHkg\ndmFsdWUmZ3Q7PC9pPgogICAgICogOiBBcmd1bWVudHMgbGlrZSB0aGlzIHdp\nbGwgYmUgdXNlZCB0byBjb25maWd1cmUgdGhlIGJlYW4KICAgICAqIHByb3Bl\ncnRpZXMgb2YgdGhlIGludGVybmFsIHtAbGluayBDb2RlRm9ybWF0fS48L2xp\nPgogICAgICogPC91bD4KICAgICAqICBFYWNoIHNjaGVtYSBnaXZlbiBhcyBh\nbiBhcmd1bWVudCB3aWxsIGJlIHJldmVyc2UtbWFwcGVkIGludG8KICAgICAq\nIHBlcnNpc3RlbnQgY2xhc3NlcyBhbmQgYXNzb2NpYXRlZCBtZXRhZGF0YS4g\nSWYgbm8gYXJndW1lbnRzIGFyZSBnaXZlbiwKICAgICAqIHRoZSBkYXRhYmFz\nZSBzY2hlbWFzIGRlZmluZWQgYnkgdGhlIHN5c3RlbSBjb25maWd1cmF0aW9u\nIHdpbGwgYmUKICAgICAqIHJldmVyc2UtbWFwcGVkLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKQogICAgICAg\nIHRocm93cyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0aW9uIHsKICAgICAgICBP\ncHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwogICAgICAgIGFyZ3MgPSBv\ncHRzLnNldEZyb21DbWRMaW5lKGFyZ3MpOwogICAgICAgIEpEQkNDb25maWd1\ncmF0aW9uIGNvbmYgPSBuZXcgSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCFydW4oY29uZiwgYXJncywg\nb3B0cykpCiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oX2xv\nYy5nZXQoInJldnRvb2wtdXNhZ2UiKSk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgY29uZi5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJucyBmYWxzZSBpZiBp\nbnZhbGlkIG9wdGlvbnMgd2VyZSBnaXZlbi4KICAgICAqCiAgICAgKiBAc2Vl\nICNtYWluCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4o\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAg\nICBPcHRpb25zIG9wdHMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBT\nUUxFeGNlcHRpb24gewogICAgICAgIGlmIChvcHRzLmNvbnRhaW5zS2V5KCJo\nZWxwIikgfHwgb3B0cy5jb250YWluc0tleSgiLWhlbHAiKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyBmbGFncwogICAgICAgIEZs\nYWdzIGZsYWdzID0gbmV3IEZsYWdzKCk7CiAgICAgICAgZmxhZ3MucGFja2Fn\nZU5hbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5CiAgICAgICAgICAgICgicGFj\na2FnZSIsICJwa2ciLCBmbGFncy5wYWNrYWdlTmFtZSk7CiAgICAgICAgZmxh\nZ3MuZGlyZWN0b3J5ID0gRmlsZXMuZ2V0RmlsZQogICAgICAgICAgICAob3B0\ncy5yZW1vdmVQcm9wZXJ0eSgiZGlyZWN0b3J5IiwgImQiLCBudWxsKSwgbnVs\nbCk7CiAgICAgICAgZmxhZ3MudXNlU2NoZW1hTmFtZSA9IG9wdHMucmVtb3Zl\nQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgidXNlU2NoZW1hTmFtZSIs\nICJzbiIsIGZsYWdzLnVzZVNjaGVtYU5hbWUpOwogICAgICAgIGZsYWdzLnVz\nZUZvcmVpZ25LZXlOYW1lID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkK\nICAgICAgICAgICAgKCJ1c2VGb3JlaWduS2V5TmFtZSIsICJma24iLCBmbGFn\ncy51c2VGb3JlaWduS2V5TmFtZSk7CiAgICAgICAgZmxhZ3MubnVsbGFibGVB\nc09iamVjdCA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAg\nICAgICgibnVsbGFibGVBc09iamVjdCIsICJubyIsIGZsYWdzLm51bGxhYmxl\nQXNPYmplY3QpOwogICAgICAgIGZsYWdzLmJsb2JBc09iamVjdCA9IG9wdHMu\ncmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiYmxvYkFzT2Jq\nZWN0IiwgImJvIiwgZmxhZ3MuYmxvYkFzT2JqZWN0KTsKICAgICAgICBmbGFn\ncy5wcmltYXJ5S2V5T25Kb2luID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVy\ndHkKICAgICAgICAgICAgKCJwcmltYXJ5S2V5T25Kb2luIiwgInBraiIsIGZs\nYWdzLnByaW1hcnlLZXlPbkpvaW4pOwogICAgICAgIGZsYWdzLnVzZURhdGFT\ndG9yZUlkZW50aXR5ID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAg\nICAgICAgICAgKCJ1c2VEYXRhc3RvcmVJZGVudGl0eSIsICJkcyIsIGZsYWdz\nLnVzZURhdGFTdG9yZUlkZW50aXR5KTsKICAgICAgICBmbGFncy51c2VCdWls\ndGluSWRlbnRpdHlDbGFzcyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5\nCiAgICAgICAgICAgICgidXNlQnVpbHRpbklkZW50aXR5Q2xhc3MiLCAiYmlj\nIiwgZmxhZ3MudXNlQnVpbHRpbklkZW50aXR5Q2xhc3MpOwogICAgICAgIGZs\nYWdzLmlubmVySWRlbnRpdHlDbGFzc2VzID0gb3B0cy5yZW1vdmVCb29sZWFu\nUHJvcGVydHkKICAgICAgICAgICAgKCJpbm5lcklkZW50aXR5Q2xhc3NlcyIs\nICJpbm4iLCBmbGFncy5pbm5lcklkZW50aXR5Q2xhc3Nlcyk7CiAgICAgICAg\nZmxhZ3MuaWRlbnRpdHlDbGFzc1N1ZmZpeCA9IG9wdHMucmVtb3ZlUHJvcGVy\ndHkKICAgICAgICAgICAgKCJpZGVudGl0eUNsYXNzU3VmZml4IiwgImlzIiwg\nZmxhZ3MuaWRlbnRpdHlDbGFzc1N1ZmZpeCk7CiAgICAgICAgZmxhZ3MuaW52\nZXJzZVJlbGF0aW9ucyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAg\nICAgICAgICAgICgiaW52ZXJzZVJlbGF0aW9ucyIsICJpciIsIGZsYWdzLmlu\ndmVyc2VSZWxhdGlvbnMpOwogICAgICAgIGZsYWdzLmRldGFjaGFibGUgPSBv\ncHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImRldGFj\naGFibGUiLCAiZGV0IiwgZmxhZ3MuZGV0YWNoYWJsZSk7CiAgICAgICAgZmxh\nZ3MuZGlzY3JpbWluYXRvclN0cmF0ZWd5ID0gb3B0cy5yZW1vdmVQcm9wZXJ0\neQogICAgICAgICAgICAoImRpc2NyaW1pbmF0b3JTdHJhdGVneSIsICJkcyIs\nIGZsYWdzLmRpc2NyaW1pbmF0b3JTdHJhdGVneSk7CiAgICAgICAgZmxhZ3Mu\ndmVyc2lvblN0cmF0ZWd5ID0gb3B0cy5yZW1vdmVQcm9wZXJ0eQogICAgICAg\nICAgICAoInZlcnNpb25TdHJhdGVneSIsICJ2cyIsIGZsYWdzLnZlcnNpb25T\ndHJhdGVneSk7CiAgICAgICAgZmxhZ3MubWV0YURhdGFMZXZlbCA9IG9wdHMu\ncmVtb3ZlUHJvcGVydHkKICAgICAgICAgICAgKCJtZXRhZGF0YSIsICJtZCIs\nIGZsYWdzLm1ldGFEYXRhTGV2ZWwpOwoKICAgICAgICBTdHJpbmcgdHlwZU1h\ncCA9IG9wdHMucmVtb3ZlUHJvcGVydHkoInR5cGVNYXAiLCAidHlwIiwgbnVs\nbCk7CiAgICAgICAgaWYgKHR5cGVNYXAgIT0gbnVsbCkKICAgICAgICAgICAg\nZmxhZ3MudHlwZU1hcCA9IENvbmZpZ3VyYXRpb25zLnBhcnNlUHJvcGVydGll\ncyh0eXBlTWFwKTsKCiAgICAgICAgLy8gcmVtYXAgdGhlIC1zIHNob3J0Y3V0\nIHRvIHRoZSAic2NoZW1hcyIgcHJvcGVydHkgbmFtZSBzbyB0aGF0IGl0CiAg\nICAgICAgLy8gZ2V0cyBzZXQgaW50byB0aGUgY29uZmlndXJhdGlvbgogICAg\nICAgIGlmIChvcHRzLmNvbnRhaW5zS2V5KCJzIikpCiAgICAgICAgICAgIG9w\ndHMucHV0KCJzY2hlbWFzIiwgb3B0cy5nZXQoInMiKSk7CgogICAgICAgIC8v\nIGN1c3RvbWl6ZXIKICAgICAgICBTdHJpbmcgY3VzdG9tQ2xzID0gb3B0cy5y\nZW1vdmVQcm9wZXJ0eSgiY3VzdG9taXplckNsYXNzIiwgImNjIiwKICAgICAg\nICAgICAgUHJvcGVydGllc1JldmVyc2VDdXN0b21pemVyLmNsYXNzLmdldE5h\nbWUoKSk7CiAgICAgICAgRmlsZSBjdXN0b21GaWxlID0gRmlsZXMuZ2V0Rmls\nZQogICAgICAgICAgICAob3B0cy5yZW1vdmVQcm9wZXJ0eSgiY3VzdG9taXpl\nclByb3BlcnRpZXMiLCAiY3AiLCBudWxsKSwgbnVsbCk7CiAgICAgICAgUHJv\ncGVydGllcyBjdXN0b21Qcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAgICAg\nICAgaWYgKGN1c3RvbUZpbGUgIT0gbnVsbCAmJiBjdXN0b21GaWxlLmV4aXN0\ncygpKQogICAgICAgICAgICBjdXN0b21Qcm9wcy5sb2FkKG5ldyBGaWxlSW5w\ndXRTdHJlYW0oY3VzdG9tRmlsZSkpOwoKICAgICAgICAvLyBzZXBhcmF0ZSB0\naGUgcHJvcGVydGllcyBmb3IgdGhlIGN1c3RvbWl6ZXIgYW5kIGNvZGUgZm9y\nbWF0CiAgICAgICAgT3B0aW9ucyBjdXN0b21PcHRzID0gbmV3IE9wdGlvbnMo\nKTsKICAgICAgICBPcHRpb25zIGZvcm1hdE9wdHMgPSBuZXcgT3B0aW9ucygp\nOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBTdHJpbmcga2V5\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gb3B0cy5lbnRyeVNldCgp\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGVu\ndHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAga2V5\nID0gKFN0cmluZykgZW50cnkuZ2V0S2V5KCk7CiAgICAgICAgICAgIGlmIChr\nZXkuc3RhcnRzV2l0aCgiY3VzdG9taXplci4iKSkgewogICAgICAgICAgICAg\nICAgY3VzdG9tT3B0cy5wdXQoa2V5LnN1YnN0cmluZygxMSksIGVudHJ5Lmdl\ndFZhbHVlKCkpOwogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKGtleS5zdGFydHNXaXRoKCJjLiIpKSB7CiAg\nICAgICAgICAgICAgICBjdXN0b21PcHRzLnB1dChrZXkuc3Vic3RyaW5nKDIp\nLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIGl0ci5yZW1v\ndmUoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkuc3RhcnRzV2l0aCgi\nY29kZUZvcm1hdC4iKSkgewogICAgICAgICAgICAgICAgZm9ybWF0T3B0cy5w\ndXQoa2V5LnN1YnN0cmluZygxMSksIGVudHJ5LmdldFZhbHVlKCkpOwogICAg\nICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKGtleS5zdGFydHNXaXRoKCJjZi4iKSkgewogICAgICAgICAgICAgICAg\nZm9ybWF0T3B0cy5wdXQoa2V5LnN1YnN0cmluZygzKSwgZW50cnkuZ2V0VmFs\ndWUoKSk7CiAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGNvZGUgZm9ybWF0CiAgICAg\nICAgaWYgKCFmb3JtYXRPcHRzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBm\nbGFncy5mb3JtYXQgPSBuZXcgQ29kZUZvcm1hdCgpOwogICAgICAgICAgICBm\nb3JtYXRPcHRzLnNldEludG8oZmxhZ3MuZm9ybWF0KTsKICAgICAgICB9Cgog\nICAgICAgIC8vIHNldHVwIGEgY29uZmlndXJhdGlvbiBpbnN0YW5jZSB3aXRo\nIGNtZC1saW5lIGluZm8KICAgICAgICBDb25maWd1cmF0aW9ucy5wb3B1bGF0\nZUNvbmZpZ3VyYXRpb24oY29uZiwgb3B0cyk7CiAgICAgICAgQ2xhc3NMb2Fk\nZXIgbG9hZGVyID0gY29uZi5nZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS4K\nICAgICAgICAgICAgZ2V0Q2xhc3NMb2FkZXIoUmV2ZXJzZU1hcHBpbmdUb29s\nLmNsYXNzLCBudWxsKTsKCiAgICAgICAgLy8gY3VzdG9taXplcgogICAgICAg\nIGZsYWdzLmN1c3RvbWl6ZXIgPSAoUmV2ZXJzZUN1c3RvbWl6ZXIpIENvbmZp\nZ3VyYXRpb25zLgogICAgICAgICAgICBuZXdJbnN0YW5jZShjdXN0b21DbHMs\nIGxvYWRlcik7CiAgICAgICAgaWYgKGZsYWdzLmN1c3RvbWl6ZXIgIT0gbnVs\nbCkgewogICAgICAgICAgICBDb25maWd1cmF0aW9ucy5jb25maWd1cmVJbnN0\nYW5jZShmbGFncy5jdXN0b21pemVyLCBjb25mLAogICAgICAgICAgICAgICAg\nY3VzdG9tT3B0cyk7CiAgICAgICAgICAgIGZsYWdzLmN1c3RvbWl6ZXIuc2V0\nQ29uZmlndXJhdGlvbihjdXN0b21Qcm9wcyk7CiAgICAgICAgfQoKICAgICAg\nICBydW4oY29uZiwgYXJncywgZmxhZ3MsIGxvYWRlcik7CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSdW4gdGhlIHRvb2wu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBydW4oSkRCQ0NvbmZp\nZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBGbGFncyBm\nbGFncywgQ2xhc3NMb2FkZXIgbG9hZGVyKQogICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiwgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBwYXJzZSB0aGUg\nc2NoZW1hIHRvIHJldmVyc2UtbWFwCiAgICAgICAgTG9nIGxvZyA9IGNvbmYu\nZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19UT09MKTsKICAgICAg\nICBTY2hlbWFHcm91cCBzY2hlbWE7CiAgICAgICAgaWYgKGFyZ3MubGVuZ3Ro\nID09IDApIHsKICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoInJldnRv\nb2wtcnVubmluZyIpKTsKICAgICAgICAgICAgU2NoZW1hR2VuZXJhdG9yIGdl\nbiA9IG5ldyBTY2hlbWFHZW5lcmF0b3IoY29uZik7CiAgICAgICAgICAgIGdl\nbi5nZW5lcmF0ZVNjaGVtYXMoKTsKICAgICAgICAgICAgc2NoZW1hID0gZ2Vu\nLmdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgU2NoZW1hUGFyc2VyIHBhcnNlciA9IG5ldyBYTUxTY2hlbWFQYXJzZXIo\nY29uZik7CiAgICAgICAgICAgIEZpbGUgZmlsZTsKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgICAgICBmaWxlID0gRmlsZXMuZ2V0RmlsZShhcmdzW2ldLCBsb2FkZXIp\nOwogICAgICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoInJldnRvb2wt\ncnVubmluZy1maWxlIiwgZmlsZSkpOwogICAgICAgICAgICAgICAgcGFyc2Vy\nLnBhcnNlKGZpbGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNjaGVt\nYSA9IHBhcnNlci5nZXRTY2hlbWFHcm91cCgpOwogICAgICAgIH0KCiAgICAg\nICAgLy8gZmxhZ3MKICAgICAgICBSZXZlcnNlTWFwcGluZ1Rvb2wgdG9vbCA9\nIG5ldyBSZXZlcnNlTWFwcGluZ1Rvb2woY29uZik7CiAgICAgICAgdG9vbC5z\nZXRTY2hlbWFHcm91cChzY2hlbWEpOwogICAgICAgIHRvb2wuc2V0UGFja2Fn\nZU5hbWUoZmxhZ3MucGFja2FnZU5hbWUpOwogICAgICAgIHRvb2wuc2V0RGly\nZWN0b3J5KGZsYWdzLmRpcmVjdG9yeSk7CiAgICAgICAgdG9vbC5zZXRVc2VT\nY2hlbWFOYW1lKGZsYWdzLnVzZVNjaGVtYU5hbWUpOwogICAgICAgIHRvb2wu\nc2V0VXNlRm9yZWlnbktleU5hbWUoZmxhZ3MudXNlRm9yZWlnbktleU5hbWUp\nOwogICAgICAgIHRvb2wuc2V0TnVsbGFibGVBc09iamVjdChmbGFncy5udWxs\nYWJsZUFzT2JqZWN0KTsKICAgICAgICB0b29sLnNldEJsb2JBc09iamVjdChm\nbGFncy5ibG9iQXNPYmplY3QpOwogICAgICAgIHRvb2wuc2V0VHlwZU1hcChm\nbGFncy50eXBlTWFwKTsKICAgICAgICB0b29sLnNldFByaW1hcnlLZXlPbkpv\naW4oZmxhZ3MucHJpbWFyeUtleU9uSm9pbik7CiAgICAgICAgdG9vbC5zZXRV\nc2VEYXRhU3RvcmVJZGVudGl0eShmbGFncy51c2VEYXRhU3RvcmVJZGVudGl0\neSk7CiAgICAgICAgdG9vbC5zZXRVc2VCdWlsdGluSWRlbnRpdHlDbGFzcyhm\nbGFncy51c2VCdWlsdGluSWRlbnRpdHlDbGFzcyk7CiAgICAgICAgdG9vbC5z\nZXRJbm5lcklkZW50aXR5Q2xhc3NlcyhmbGFncy5pbm5lcklkZW50aXR5Q2xh\nc3Nlcyk7CiAgICAgICAgdG9vbC5zZXRJZGVudGl0eUNsYXNzU3VmZml4KGZs\nYWdzLmlkZW50aXR5Q2xhc3NTdWZmaXgpOwogICAgICAgIHRvb2wuc2V0SW52\nZXJzZVJlbGF0aW9ucyhmbGFncy5pbnZlcnNlUmVsYXRpb25zKTsKICAgICAg\nICB0b29sLnNldERldGFjaGFibGUoZmxhZ3MuZGV0YWNoYWJsZSk7CiAgICAg\nICAgdG9vbC5zZXRDdXN0b21pemVyKGZsYWdzLmN1c3RvbWl6ZXIpOwogICAg\nICAgIHRvb2wuc2V0Q29kZUZvcm1hdChmbGFncy5mb3JtYXQpOwoKICAgICAg\nICAvLyBydW4KICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1t\nYXAiKSk7CiAgICAgICAgdG9vbC5ydW4oKTsKICAgICAgICBsb2cuaW5mbyhf\nbG9jLmdldCgicmV2dG9vbC13cml0ZS1jb2RlIikpOwogICAgICAgIHRvb2wu\ncmVjb3JkQ29kZSgpOwogICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJyZXZ0\nb29sLXdyaXRlLW1ldGFkYXRhIikpOwogICAgICAgIHRvb2wucmVjb3JkTWV0\nYURhdGEoTEVWRUxfQ0xBU1MuZXF1YWxzKGZsYWdzLm1ldGFEYXRhTGV2ZWwp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhvbGRlciBmb3IgcnVuIGZsYWdz\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIEZsYWdzIHsKCiAg\nICAgICAgcHVibGljIFN0cmluZyBwYWNrYWdlTmFtZSA9IG51bGw7CiAgICAg\nICAgcHVibGljIEZpbGUgZGlyZWN0b3J5ID0gbnVsbDsKICAgICAgICBwdWJs\naWMgYm9vbGVhbiB1c2VTY2hlbWFOYW1lID0gZmFsc2U7CiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gdXNlRm9yZWlnbktleU5hbWUgPSBmYWxzZTsKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBudWxsYWJsZUFzT2JqZWN0ID0gZmFsc2U7CiAg\nICAgICAgcHVibGljIGJvb2xlYW4gYmxvYkFzT2JqZWN0ID0gZmFsc2U7CiAg\nICAgICAgcHVibGljIFByb3BlcnRpZXMgdHlwZU1hcCA9IG51bGw7CiAgICAg\nICAgcHVibGljIGJvb2xlYW4gcHJpbWFyeUtleU9uSm9pbiA9IGZhbHNlOwog\nICAgICAgIHB1YmxpYyBib29sZWFuIHVzZURhdGFTdG9yZUlkZW50aXR5ID0g\nZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gdXNlQnVpbHRpbklkZW50\naXR5Q2xhc3MgPSB0cnVlOwogICAgICAgIHB1YmxpYyBib29sZWFuIGlubmVy\nSWRlbnRpdHlDbGFzc2VzID0gZmFsc2U7CiAgICAgICAgcHVibGljIFN0cmlu\nZyBpZGVudGl0eUNsYXNzU3VmZml4ID0gIklkIjsKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBpbnZlcnNlUmVsYXRpb25zID0gdHJ1ZTsKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBkZXRhY2hhYmxlID0gZmFsc2U7CiAgICAgICAgcHVibGlj\nIFN0cmluZyBtZXRhRGF0YUxldmVsID0gTEVWRUxfUEFDS0FHRTsKICAgICAg\nICBwdWJsaWMgU3RyaW5nIGRpc2NyaW1pbmF0b3JTdHJhdGVneSA9IG51bGw7\nCiAgICAgICAgcHVibGljIFN0cmluZyB2ZXJzaW9uU3RyYXRlZ3kgPSBudWxs\nOwogICAgICAgIHB1YmxpYyBSZXZlcnNlQ3VzdG9taXplciBjdXN0b21pemVy\nID0gbnVsbDsKICAgICAgICBwdWJsaWMgQ29kZUZvcm1hdCBmb3JtYXQgPSBu\ndWxsOwogICAgfQoKICAgIC8qKgogICAgICogVXNlZCB0byBpbnN0YWxsIGRp\nc2NyaW1pbmF0b3IgYW5kIHZlcnNpb24gc3RyYXRlZ2llcyBvbgogICAgICog\ncmV2ZXJzZS1tYXBwZWQgY2xhc3Nlcy4KICAgICAqLwogICAgcHJpdmF0ZSBj\nbGFzcyBSZXZlcnNlU3RyYXRlZ3lJbnN0YWxsZXIKICAgICAgICBleHRlbmRz\nIFN0cmF0ZWd5SW5zdGFsbGVyIHsKCiAgICAgICAgcHVibGljIFJldmVyc2VT\ndHJhdGVneUluc3RhbGxlcihNYXBwaW5nUmVwb3NpdG9yeSByZXBvcykgewog\nICAgICAgICAgICBzdXBlcihyZXBvcyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBpbnN0YWxsU3RyYXRlZ3koQ2xhc3NNYXBwaW5nIGNscykg\newogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVn\neShGaWVsZE1hcHBpbmcgZmllbGQpIHsKICAgICAgICAgICAgdGhyb3cgbmV3\nIEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCBpbnN0YWxsU3RyYXRlZ3koVmVyc2lvbiB2ZXJzaW9uKSB7CiAg\nICAgICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSB2ZXJzaW9uLmdldENsYXNz\nTWFwcGluZygpOwogICAgICAgICAgICBpZiAoY2xzLmdldFBDU3VwZXJjbGFz\ncygpICE9IG51bGwpCiAgICAgICAgICAgICAgICB2ZXJzaW9uLnNldFN0cmF0\nZWd5KG5ldyBTdXBlcmNsYXNzVmVyc2lvblN0cmF0ZWd5KCksIG51bGwpOwog\nICAgICAgICAgICBlbHNlIGlmIChfdmVyc1N0cmF0ICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIFZlcnNpb25TdHJhdGVneSBzdHJhdCA9IHJlcG9zLmlu\nc3RhbnRpYXRlVmVyc2lvblN0cmF0ZWd5CiAgICAgICAgICAgICAgICAgICAg\nKF92ZXJzU3RyYXQsIHZlcnNpb24pOwogICAgICAgICAgICAgICAgdmVyc2lv\nbi5zZXRTdHJhdGVneShzdHJhdCwgbnVsbCk7CiAgICAgICAgICAgIH0gZWxz\nZQogICAgICAgICAgICAgICAgdmVyc2lvbi5zZXRTdHJhdGVneShuZXcgU3Rh\ndGVDb21wYXJpc29uVmVyc2lvblN0cmF0ZWd5KCksCiAgICAgICAgICAgICAg\nICAgICAgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBp\nbnN0YWxsU3RyYXRlZ3koRGlzY3JpbWluYXRvciBkaXNjcmltKSB7CiAgICAg\nICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSBkaXNjcmltLmdldENsYXNzTWFw\ncGluZygpOwogICAgICAgICAgICBpZiAoY2xzLmdldFBDU3VwZXJjbGFzcygp\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGRpc2NyaW0uc2V0U3RyYXRl\nZ3kobmV3IFN1cGVyY2xhc3NEaXNjcmltaW5hdG9yU3RyYXRlZ3koKSwKICAg\nICAgICAgICAgICAgICAgICBudWxsKTsKICAgICAgICAgICAgfSBlbHNlIGlm\nICghaGFzU3ViY2xhc3NlcyhjbHMpKSB7CiAgICAgICAgICAgICAgICBkaXNj\ncmltLnNldFN0cmF0ZWd5KE5vbmVEaXNjcmltaW5hdG9yU3RyYXRlZ3kuZ2V0\nSW5zdGFuY2UoKSwKICAgICAgICAgICAgICAgICAgICBudWxsKTsKICAgICAg\nICAgICAgfSBlbHNlIGlmIChfZGlzY1N0cmF0ICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgIERpc2NyaW1pbmF0b3JTdHJhdGVneSBzdHJhdCA9IHJlcG9z\nLgogICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlRGlzY3JpbWluYXRv\nclN0cmF0ZWd5KF9kaXNjU3RyYXQsIGRpc2NyaW0pOwogICAgICAgICAgICAg\nICAgZGlzY3JpbS5zZXRTdHJhdGVneShzdHJhdCwgbnVsbCk7CiAgICAgICAg\nICAgIH0gZWxzZQogICAgICAgICAgICAgICAgZGlzY3JpbS5zZXRTdHJhdGVn\neShuZXcgU3ViY2xhc3NKb2luRGlzY3JpbWluYXRvclN0cmF0ZWd5KCksCiAg\nICAgICAgICAgICAgICAgICAgbnVsbCk7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2ZW4gY2xhc3Mg\naGFzIGFueSBtYXBwZWQgcGVyc2lzdGVudCBzdWJjbGFzc2VzLgogICAgICAg\nICAqLwogICAgICAgIHByaXZhdGUgYm9vbGVhbiBoYXNTdWJjbGFzc2VzKENs\nYXNzTWFwcGluZyBjbHMpIHsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YVtd\nIG1ldGFzID0gcmVwb3MuZ2V0TWV0YURhdGFzKCk7CiAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgICAgICBpZiAobWV0YXNbaV0uZ2V0UENTdXBlcmNsYXNzKCkgPT0gY2xz\nLmdldERlc2NyaWJlZFR5cGUoKSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIEV4dGVuc2lvbiBvZiB0aGUge0BsaW5r\nIENvZGVHZW5lcmF0b3J9IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZQog\nICAgICogdGhlIGZvcm1hdHRpbmcgb2YgdGhlaXIgZ2VuZXJhdGVkIGNsYXNz\nZXMuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgUmV2ZXJzZUNvZGVHZW5l\ncmF0b3IKICAgICAgICBleHRlbmRzIENvZGVHZW5lcmF0b3IgewoKICAgICAg\nICBwcml2YXRlIGZpbmFsIENsYXNzTWFwcGluZyBfbWFwcGluZzsKICAgICAg\nICBwcml2YXRlIGZpbmFsIEFwcGxpY2F0aW9uSWRUb29sIF9hcHBpZDsKCiAg\nICAgICAgcHVibGljIFJldmVyc2VDb2RlR2VuZXJhdG9yKENsYXNzTWFwcGlu\nZyBtYXBwaW5nLAogICAgICAgICAgICBBcHBsaWNhdGlvbklkVG9vbCBhaWQp\nIHsKICAgICAgICAgICAgc3VwZXIobWFwcGluZyk7CiAgICAgICAgICAgIHN1\ncGVyLnNldERpcmVjdG9yeShfZGlyKTsKICAgICAgICAgICAgc3VwZXIuc2V0\nQ29kZUZvcm1hdChfZm9ybWF0KTsKCiAgICAgICAgICAgIF9tYXBwaW5nID0g\nbWFwcGluZzsKICAgICAgICAgICAgaWYgKGFpZCAhPSBudWxsICYmIGFpZC5p\nc0lubmVyQ2xhc3MoKSkKICAgICAgICAgICAgICAgIF9hcHBpZCA9IGFpZDsK\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2FwcGlkID0gbnVs\nbDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIElmIHRoZXJl\nIGlzIGFuIGlubmVyIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNsYXNzLCB0aGVu\nCiAgICAgICAgICogYWRkIGl0IHRvIHRoZSBib3R0b20gb2YgdGhlIGNsYXNz\nIGNvZGUuCiAgICAgICAgICovCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgY2xv\nc2VDbGFzc0JyYWNlKENvZGVGb3JtYXQgY29kZSkgewogICAgICAgICAgICBp\nZiAoX2FwcGlkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGNvZGUuYWZ0\nZXJTZWN0aW9uKCk7CiAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZChfYXBw\naWQuZ2V0Q29kZSgpKTsKICAgICAgICAgICAgICAgIGNvZGUuZW5kbCgpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBzdXBlci5jbG9zZUNsYXNzQnJh\nY2UoY29kZSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBB\nZGQgdGhlIGxpc3Qgb2YgaW1wb3J0cyBmb3IgYW55IGlubmVyIGFwcCBpZCBj\nbGFzc2VzCiAgICAgICAgICoKICAgICAgICAgKiBAcmV0dXJuCiAgICAgICAg\nICovCiAgICAgICAgcHVibGljIFNldCBnZXRJbXBvcnRQYWNrYWdlcygpIHsK\nICAgICAgICAgICAgU2V0IHBrZ3MgPSBzdXBlci5nZXRJbXBvcnRQYWNrYWdl\ncygpOwogICAgICAgICAgICBpZiAoX2FwcGlkICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBwa2dzLmFkZEFsbChfYXBwaWQuZ2V0SW1wb3J0UGFja2FnZXMo\nKSk7CiAgICAgICAgICAgIHJldHVybiBwa2dzOwogICAgICAgIH0KCiAgICAg\nICAgcHJvdGVjdGVkIFN0cmluZyBnZXRDbGFzc0NvZGUoKSB7CiAgICAgICAg\nICAgIHJldHVybiAoX2N1c3RvbSA9PSBudWxsKSA/IG51bGwgOiBfY3VzdG9t\nLmdldENsYXNzQ29kZShfbWFwcGluZyk7CiAgICAgICAgfQoKICAgICAgICBw\ncm90ZWN0ZWQgU3RyaW5nIGdldEluaXRpYWxWYWx1ZShGaWVsZE1ldGFEYXRh\nIGZpZWxkKSB7CiAgICAgICAgICAgIGlmIChfY3VzdG9tID09IG51bGwpCiAg\nICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgcmV0dXJu\nIF9jdXN0b20uZ2V0SW5pdGlhbFZhbHVlKChGaWVsZE1hcHBpbmcpIGZpZWxk\nKTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0RGVj\nbGFyYXRpb24oRmllbGRNZXRhRGF0YSBmaWVsZCkgewogICAgICAgICAgICBp\nZiAoX2N1c3RvbSA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgICAgIHJldHVybiBfY3VzdG9tLmdldERlY2xhcmF0aW9u\nKChGaWVsZE1hcHBpbmcpIGZpZWxkKTsKICAgICAgICB9CgogICAgICAgIHBy\nb3RlY3RlZCBTdHJpbmcgZ2V0RmllbGRDb2RlKEZpZWxkTWV0YURhdGEgZmll\nbGQpIHsKICAgICAgICAgICAgaWYgKF9jdXN0b20gPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICByZXR1cm4gX2N1\nc3RvbS5nZXRGaWVsZENvZGUoKEZpZWxkTWFwcGluZykgZmllbGQpOwogICAg\nICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

