{"sha":"730f1430d4c3bde7fd7e080f68cef5c5c633ef84","node_id":"MDQ6QmxvYjIwNjM2NDo3MzBmMTQzMGQ0YzNiZGU3ZmQ3ZTA4MGY2OGNlZjVjNWM2MzNlZjg0","size":6164,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/730f1430d4c3bde7fd7e080f68cef5c5c633ef84","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5EaXNjcmltaW5hdG9y\nTWFwcGluZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLkluZGV4OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc3FsLkpvaW5zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3Fs\nLlJlc3VsdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5S\nb3c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93TWFu\nYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxC\ndWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU2Vs\nZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBB\nU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1l\ndGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAqIEJhc2UgZGlzY3JpbWluYXRvciBz\ndHJhdGVneSB0aGF0IGRldGVybWluZXMgdGhlIGNsYXNzIG9mIGRhdGFiYXNl\nCiAqIHJlY29yZHMgdXNpbmcgYSBjb2x1bW4gaG9sZGluZyBhIHZhbHVlIG1h\ncHBlZCB0byBhIGNsYXNzLCBhbmQgbGltaXRzCiAqIFNFTEVDVHMgdXNpbmcg\nYW4gSU4gKC4uLikgc3RhdGVtZW50LgogKgogKiBAYXV0aG9yIEFiZSBXaGl0\nZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEluVmFsdWVEaXNjcmltaW5h\ndG9yU3RyYXRlZ3kKICAgIGV4dGVuZHMgQWJzdHJhY3REaXNjcmltaW5hdG9y\nU3RyYXRlZ3kgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoSW5WYWx1\nZURpc2NyaW1pbmF0b3JTdHJhdGVneS5jbGFzcyk7CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIEphdmEgdHlwZSBjb2RlIGZyb20ge0BsaW5rIEphdmFU\neXBlc30gZm9yIHRoZSBkaXNjcmltaW5hdG9yCiAgICAgKiB2YWx1ZXMuIFRo\naXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBkdXJpbmcgbWFwcGluZyBpbnN0YWxs\nYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBpbnQgZ2V0\nSmF2YVR5cGUoKTsKCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGlzY3Jp\nbWluYXRvciB2YWx1ZSBmb3IgdGhlIGdpdmVuIHR5cGUuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBhYnN0cmFjdCBPYmplY3QgZ2V0RGlzY3JpbWluYXRvclZh\nbHVlKENsYXNzTWFwcGluZyBjbHMpOwoKICAgIC8qKgogICAgICogQ29udmVy\ndCB0aGUgZ2l2ZW4gZGlzY3JpbWluYXRvciB2YWx1ZSB0byB0aGUgY29ycmVz\ncG9uZGluZyBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIENsYXNzIGdldENsYXNzKE9iamVjdCB2YWwsIEpEQkNTdG9yZSBzdG9yZSkK\nICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbjsKCiAgICBw\ndWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkgewogICAgICAgIENsYXNz\nTWFwcGluZyBjbHMgPSBkaXNjLmdldENsYXNzTWFwcGluZygpOwogICAgICAg\nIGlmIChjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0g\nbnVsbAogICAgICAgICAgICB8fCBjbHMuZ2V0RW1iZWRkaW5nTWV0YURhdGEo\nKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vdC1iYXNlLWRpc2MiLCBjbHMpKTsKCiAgICAg\nICAgRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvIGluZm8gPSBkaXNjLmdldE1h\ncHBpbmdJbmZvKCk7CiAgICAgICAgaW5mby5hc3NlcnROb0pvaW4oZGlzYywg\ndHJ1ZSk7CiAgICAgICAgaW5mby5hc3NlcnROb0ZvcmVpZ25LZXkoZGlzYywg\nIWFkYXB0KTsKICAgICAgICBpbmZvLmFzc2VydE5vVW5pcXVlKGRpc2MsIGZh\nbHNlKTsKCiAgICAgICAgQ29sdW1uIHRtcGxhdGUgPSBuZXcgQ29sdW1uKCk7\nCiAgICAgICAgdG1wbGF0ZS5zZXRKYXZhVHlwZShnZXRKYXZhVHlwZSgpKTsK\nICAgICAgICB0bXBsYXRlLnNldE5hbWUoInR5cCIpOwoKICAgICAgICBDb2x1\nbW5bXSBjb2xzID0gaW5mby5nZXRDb2x1bW5zKGRpc2MsIG5ldyBDb2x1bW5b\nXXsgdG1wbGF0ZSB9LCBhZGFwdCk7CiAgICAgICAgZGlzYy5zZXRDb2x1bW5z\nKGNvbHMpOwogICAgICAgIGRpc2Muc2V0Q29sdW1uSU8oaW5mby5nZXRDb2x1\nbW5JTygpKTsKCiAgICAgICAgSW5kZXggaWR4ID0gaW5mby5nZXRJbmRleChk\naXNjLCBjb2xzLCBhZGFwdCk7CiAgICAgICAgZGlzYy5zZXRJbmRleChpZHgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluc2VydChPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0pCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgUm93IHJvdyA9\nIHJtLmdldFJvdyhkaXNjLmdldENsYXNzTWFwcGluZygpLmdldFRhYmxlKCks\nCiAgICAgICAgICAgIFJvdy5BQ1RJT05fSU5TRVJULCBzbSwgdHJ1ZSk7CiAg\nICAgICAgT2JqZWN0IGNscyA9IGdldERpc2NyaW1pbmF0b3JWYWx1ZSgoQ2xh\nc3NNYXBwaW5nKSBzbS5nZXRNZXRhRGF0YSgpKTsKICAgICAgICBpZiAoZGlz\nYy5nZXRDb2x1bW5JTygpLmlzSW5zZXJ0YWJsZSgwLCBjbHMgPT0gbnVsbCkp\nCiAgICAgICAgICAgIHJvdy5zZXRPYmplY3QoZGlzYy5nZXRDb2x1bW5zKClb\nMF0sIGNscyk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc2VsZWN0KFNl\nbGVjdCBzZWwsIENsYXNzTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgaWYg\nKGlzRmluYWwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBz\nZWwuc2VsZWN0KGRpc2MuZ2V0Q29sdW1ucygpKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0Q2xhc3MoSkRCQ1N0\nb3JlIHN0b3JlLCBDbGFzc01hcHBpbmcgYmFzZSwgUmVzdWx0IHJlcykKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoaXNGaW5hbCB8fCAhcmVzLmNvbnRhaW5zKGRp\nc2MuZ2V0Q29sdW1ucygpWzBdKQogICAgICAgICAgICB8fCAoYmFzZS5nZXRQ\nQ1N1cGVyY2xhc3MoKSA9PSBudWxsCiAgICAgICAgICAgICYmIGJhc2UuZ2V0\nSm9pbmFibGVQQ1N1YmNsYXNzTWFwcGluZ3MoKS5sZW5ndGggPT0gMCkpCiAg\nICAgICAgICAgIHJldHVybiBiYXNlLmdldERlc2NyaWJlZFR5cGUoKTsKCiAg\nICAgICAgT2JqZWN0IGNscyA9IHJlcy5nZXRPYmplY3QoZGlzYy5nZXRDb2x1\nbW5zKClbMF0sIC0xLCBudWxsKTsKICAgICAgICByZXR1cm4gZ2V0Q2xhc3Mo\nY2xzLCBzdG9yZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaGFzQ2xh\nc3NDb25kaXRpb25zKENsYXNzTWFwcGluZyBiYXNlLCBib29sZWFuIHN1YmNs\nYXNzZXMpIHsKICAgICAgICAvLyBpZiBzZWxlY3RpbmcgdGhlIGZpcnN0IG1h\ncHBlZCBjbGFzcyBhbmQgYWxsIHN1YmNsYXNzZXMsIG5vIG5lZWQKICAgICAg\nICAvLyB0byBsaW1pdCB0aGUgcXVlcnkKICAgICAgICBpZiAoaXNGaW5hbCB8\nfCAoYmFzZS5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSA9PSBu\ndWxsCiAgICAgICAgICAgICYmIHN1YmNsYXNzZXMpKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIGlmIG5vIHN1YmNsYXNzZXMgb3Ig\nc3VwZXJjbGFzcywgbm8gbmVlZCBmb3IgY29uZGl0aW9ucwogICAgICAgIENs\nYXNzTWFwcGluZ1tdIHN1YnMgPSBiYXNlLmdldEpvaW5hYmxlUENTdWJjbGFz\nc01hcHBpbmdzKCk7CiAgICAgICAgaWYgKHN1YnMubGVuZ3RoID09IDAgJiYg\nYmFzZS5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgZ2V0Q2xhc3NDb25k\naXRpb25zKFNlbGVjdCBzZWwsIEpvaW5zIGpvaW5zLCAKICAgICAgICBDbGFz\nc01hcHBpbmcgYmFzZSwgYm9vbGVhbiBzdWJjbGFzc2VzKSB7CiAgICAgICAg\nQ29sdW1uIGNvbCA9IGRpc2MuZ2V0Q29sdW1ucygpWzBdOwogICAgICAgIFNR\nTEJ1ZmZlciBzcWwgPSBuZXcgU1FMQnVmZmVyKHNlbC5nZXRDb25maWd1cmF0\naW9uKCkuCiAgICAgICAgICAgIGdldERCRGljdGlvbmFyeUluc3RhbmNlKCkp\nOwogICAgICAgIGJvb2xlYW4gb3V0ZXIgPSBqb2lucyAhPSBudWxsICYmIGpv\naW5zLmlzT3V0ZXIoKTsKICAgICAgICBpZiAob3V0ZXIpCiAgICAgICAgICAg\nIHNxbC5hcHBlbmQoIigiKTsKICAgICAgICBTdHJpbmcgYWxpYXMgPSBzZWwu\nZ2V0Q29sdW1uQWxpYXMoY29sLCBqb2lucyk7CiAgICAgICAgc3FsLmFwcGVu\nZChhbGlhcyk7CgogICAgICAgIC8vIGlmIG5vdCBzZWxlY3Rpbmcgc3ViY2xh\nc3NlcywgbGltaXQgdG8ganVzdCB0aGUgZ2l2ZW4gY2xhc3MKICAgICAgICBD\nbGFzc01hcHBpbmdbXSBzdWJzID0gYmFzZS5nZXRKb2luYWJsZVBDU3ViY2xh\nc3NNYXBwaW5ncygpOwogICAgICAgIGlmICghb3V0ZXIgJiYgKCFzdWJjbGFz\nc2VzIHx8IHN1YnMubGVuZ3RoID09IDApKQogICAgICAgICAgICByZXR1cm4g\nc3FsLmFwcGVuZCgiID0gIikuYXBwZW5kVmFsdWUoZ2V0RGlzY3JpbWluYXRv\nclZhbHVlKGJhc2UpLAogICAgICAgICAgICAgICAgY29sKTsKCiAgICAgICAg\naWYgKG91dGVyKQogICAgICAgICAgICBzcWwuYXBwZW5kKCIgSVMgIikuYXBw\nZW5kVmFsdWUobnVsbCkuYXBwZW5kKCIgT1IgIikuYXBwZW5kKGFsaWFzKTsK\nICAgICAgICBzcWwuYXBwZW5kKCIgSU4gKCIpOwogICAgICAgIHNxbC5hcHBl\nbmRWYWx1ZShnZXREaXNjcmltaW5hdG9yVmFsdWUoYmFzZSksIGNvbCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdWJzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBzcWwuYXBwZW5kKCIsICIpLmFwcGVuZFZhbHVlKGdldERp\nc2NyaW1pbmF0b3JWYWx1ZShzdWJzW2ldKSwgY29sKTsKICAgICAgICBzcWwu\nYXBwZW5kKCIpIik7CiAgICAgICAgaWYgKG91dGVyKQogICAgICAgICAgICBz\ncWwuYXBwZW5kKCIpIik7CiAgICAgICAgcmV0dXJuIHNxbDsKICAgIH0KfQo=\n","encoding":"base64"}

