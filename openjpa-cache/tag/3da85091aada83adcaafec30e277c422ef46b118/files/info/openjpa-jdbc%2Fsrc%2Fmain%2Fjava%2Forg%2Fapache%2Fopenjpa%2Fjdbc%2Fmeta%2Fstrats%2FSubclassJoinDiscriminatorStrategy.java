{"sha":"dea031dcdb2351231965e204615dd36118715157","node_id":"MDQ6QmxvYjIwNjM2NDpkZWEwMzFkY2RiMjM1MTIzMTk2NWUyMDQ2MTVkZDM2MTE4NzE1MTU3","size":6567,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dea031dcdb2351231965e204615dd36118715157","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5EaXNjcmltaW5hdG9y\nTWFwcGluZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNxbC5Kb2luU3ludGF4ZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuSm9pbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuUmVzdWx0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogRGlzY3JpbWluYXRvciBz\ndHJhdGVneSB0aGF0IG91dGVyIGpvaW5zIHRvIGFsbCBwb3NzaWJsZSBzdWJj\nbGFzcyB0YWJsZXMKICogdG8gZGV0ZXJtaW5lIHRoZSBjbGFzcyBvZiBhbiBp\nbnN0YW5jZS4gVGhpcyBpbmRpY2F0b3IgdHlwZSBzaG91bGQgb25seQogKiBi\nZSB1c2VkIHdpdGggdmVydGljYWwgaW5oZXJpdGFuY2UgaGllcmFyY2hpZXMu\nCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgU3Vi\nY2xhc3NKb2luRGlzY3JpbWluYXRvclN0cmF0ZWd5CiAgICBleHRlbmRzIEFi\nc3RyYWN0RGlzY3JpbWluYXRvclN0cmF0ZWd5IHsKCiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBBTElBUyA9ICJzdWJjbGFzcy1qb2luIjsKCiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2Fs\naXplci5mb3JQYWNrYWdlCiAgICAgICAgKFN1YmNsYXNzSm9pbkRpc2NyaW1p\nbmF0b3JTdHJhdGVneS5jbGFzcyk7CgogICAgcHVibGljIFN0cmluZyBnZXRB\nbGlhcygpIHsKICAgICAgICByZXR1cm4gQUxJQVM7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgbWFwKGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICBDbGFzc01h\ncHBpbmcgY2xzID0gZGlzYy5nZXRDbGFzc01hcHBpbmcoKTsKICAgICAgICBp\nZiAoY2xzLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51\nbGwKICAgICAgICAgICAgfHwgY2xzLmdldEVtYmVkZGluZ01ldGFEYXRhKCkg\nIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJub3QtYmFzZS1kaXNjIiwgY2xzKSk7CgogICAgICAg\nIERpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbyBpbmZvID0gZGlzYy5nZXRNYXBw\naW5nSW5mbygpOwogICAgICAgIGluZm8uYXNzZXJ0Tm9TY2hlbWFDb21wb25l\nbnRzKGRpc2MsIHRydWUpOwoKICAgICAgICAvLyBtYWtlIHN1cmUgb3V0ZXIg\nam9pbnMgYXJlIHN1cHBvcnRlZAogICAgICAgIERCRGljdGlvbmFyeSBkaWN0\nID0gY2xzLmdldE1hcHBpbmdSZXBvc2l0b3J5KCkuZ2V0REJEaWN0aW9uYXJ5\nKCk7CiAgICAgICAgaWYgKGRpY3Quam9pblN5bnRheCA9PSBKb2luU3ludGF4\nZXMuU1lOVEFYX1RSQURJVElPTkFMKQogICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm91dGVyLWpvaW4tc3VwcG9y\ndCIsIGNscykpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHNlbGVjdChT\nZWxlY3Qgc2VsLCBDbGFzc01hcHBpbmcgbWFwcGluZykgewogICAgICAgIGlm\nIChpc0ZpbmFsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAg\nIC8vIG1ha2Ugc3VyZSB0byBzZWxlY3Qgb3VyIGZpcnN0IHBrIGNvbCBzbyB0\naGF0IHdlIGRldGVjdCBpdCBhcwogICAgICAgIC8vIG5vbi1udWxsIGluIGdl\ndENsYXNzOyBpZiB3ZSBoYXZlIG5vIHN1cGVyY2xhc3Mgd2UgZG9uJ3QgbmVl\nZCB0bwogICAgICAgIC8vIGRvIHRoaXMgYmVjYXVzZSB0aGUgYmFzZSBjbGFz\ncyBhbHdheXMgc2VsZWN0cyBpdHMgcGtzIGFueXdheQogICAgICAgIGJvb2xl\nYW4gc2VsZCA9IGZhbHNlOwogICAgICAgIGlmIChtYXBwaW5nLmdldFByaW1h\ncnlLZXlDb2x1bW5zKCkubGVuZ3RoID4gMAogICAgICAgICAgICAmJiBtYXBw\naW5nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwp\nIHsKICAgICAgICAgICAgc2VsLnNlbGVjdChtYXBwaW5nLmdldFByaW1hcnlL\nZXlDb2x1bW5zKClbMF0pOwogICAgICAgICAgICBzZWxkID0gdHJ1ZTsKICAg\nICAgICB9CgogICAgICAgIENsYXNzTWFwcGluZ1tdIHN1YnMgPSBtYXBwaW5n\nLmdldEpvaW5hYmxlUENTdWJjbGFzc01hcHBpbmdzKCk7CiAgICAgICAgaWYg\nKHN1YnMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBzZWxkOwoK\nICAgICAgICAvLyBvdXRlciBqb2luIHRvIGVhY2ggc3ViY2xhc3MgYW5kIHNl\nbGVjdCBpdHMgZmlyc3QgcGsgY29sOwogICAgICAgIC8vIHRoZSBzdWJjbGFz\ncyBhcnJheSBpcyBhbHJlYWR5IG9yZGVyZWQgaW4gbGV2ZWxzIG9mIGluaGVy\naXRhbmNlLCBzbwogICAgICAgIC8vIGVhY2ggc3ViY2xhc3Mgb25seSBoYXMg\ndG8gam9pbiBmcm9tIGl0cyBkaXJlY3Qgc3VwZXJjbGFzcwogICAgICAgIENv\nbHVtbltdIHBrczsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN1YnMu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHN1YnNbaV0uZ2V0Sm9p\nbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgcGtzID0gc3Vic1tpXS5n\nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgICAgICBpZiAocGtzLmxl\nbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHNlbC5zZWxlY3QocGtzWzBd\nLCBzdWJzW2ldLmpvaW5TdXBlcmNsYXNzCiAgICAgICAgICAgICAgICAgICAg\nKHNlbC5uZXdKb2lucygpLCB0cnVlKSk7CiAgICAgICAgICAgICAgICBzZWxk\nID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gc2VsZDsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0Q2xhc3MoSkRC\nQ1N0b3JlIHN0b3JlLCBDbGFzc01hcHBpbmcgYmFzZSwgUmVzdWx0IHJlcykK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoaXNGaW5hbCkKICAgICAgICAgICAgcmV0\ndXJuIGJhc2UuZ2V0RGVzY3JpYmVkVHlwZSgpOwoKICAgICAgICAvLyBmaW5k\nIHRoZSBtb3N0IGRlcml2ZWQgY2xhc3Mgd2l0aCBhIG5vbi1udWxsIHBrIGNv\nbCBpbiB0aGUgcmVzdWx0LgogICAgICAgIC8vIG5vdGUgdGhhdCB3ZSBkb24n\ndCBwZXJmb3JtIGFueSBqb2lucyBoZXJlLCB0YWtpbmcgYWR2YW50YWdlIG9m\nIHRoZQogICAgICAgIC8vIGZhY3QgdGhhdCByZXN1bHQgam9pbnMgYXJlIHVu\nbmVjZXNzYXJ5IHdoZW4gdGhlcmUgaXMgbm8gcmVsYXRpb24KICAgICAgICAv\nLyBpbnZvbHZlZDsgd2UncmUgY2hlYXRpbmcgYSBsaXR0bGUKICAgICAgICBD\nbGFzc01hcHBpbmdbXSBzdWJzID0gYmFzZS5nZXRKb2luYWJsZVBDU3ViY2xh\nc3NNYXBwaW5ncygpOwogICAgICAgIENsYXNzIGRlcml2ZWQgPSBiYXNlLmdl\ndERlc2NyaWJlZFR5cGUoKTsKICAgICAgICBDb2x1bW5bXSBwa3M7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdWJzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIHBrcyA9IHN1YnNbaV0uZ2V0UHJpbWFyeUtleUNvbHVtbnMo\nKTsKICAgICAgICAgICAgaWYgKHBrcy5sZW5ndGggPT0gMCkKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgLy8gcG9zc2libGUgdGhh\ndCBhIHNpYmxpbmcgY2xhc3MgY29scyB3ZXJlIGFscmVhZHkgZGlzY292ZXJl\nZCwgaW4KICAgICAgICAgICAgLy8gd2hpY2ggY2FzZSB3ZSBjYW4gc2tpcCB0\naGlzIHN1YgogICAgICAgICAgICBpZiAoIWRlcml2ZWQuaXNBc3NpZ25hYmxl\nRnJvbShzdWJzW2ldLmdldERlc2NyaWJlZFR5cGUoKSkpCiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIC8vIHNlZSBpZiBhbGwgcGsg\nY29scyBhcmUgbm9uLW51bGwKICAgICAgICAgICAgaWYgKHJlcy5jb250YWlu\ncyhwa3NbMF0pCiAgICAgICAgICAgICAgICAmJiByZXMuZ2V0T2JqZWN0KHBr\nc1swXSwgLTEsIG51bGwpICE9IG51bGwpCiAgICAgICAgICAgICAgICBkZXJp\ndmVkID0gc3Vic1tpXS5nZXREZXNjcmliZWRUeXBlKCk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBkZXJpdmVkOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGhhc0NsYXNzQ29uZGl0aW9ucyhDbGFzc01hcHBpbmcgYmFzZSwgYm9v\nbGVhbiBzdWJjbGFzc2VzKSB7CiAgICAgICAgaWYgKGlzRmluYWwgfHwgc3Vi\nY2xhc3NlcykKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIENs\nYXNzTWFwcGluZ1tdIHN1YnMgPSBiYXNlLmdldEpvaW5hYmxlUENTdWJjbGFz\nc01hcHBpbmdzKCk7CiAgICAgICAgaWYgKHN1YnMubGVuZ3RoID09IDApCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIGdldENsYXNzQ29uZGl0aW9u\ncyhTZWxlY3Qgc2VsLCBKb2lucyBqb2lucywgCiAgICAgICAgQ2xhc3NNYXBw\naW5nIGJhc2UsIGJvb2xlYW4gc3ViY2xhc3NlcykgewogICAgICAgIC8vIGFk\nZCBjb25kaXRpb25zIG1ha2luZyBzdXJlIG5vIHN1YmNsYXNzIHRhYmxlcyBo\nYXZlIHJlY29yZHMgZm9yCiAgICAgICAgLy8gdGhpcyBpbnN0YW5jZQogICAg\nICAgIENsYXNzTWFwcGluZ1tdIHN1YnMgPSBiYXNlLmdldEpvaW5hYmxlUENT\ndWJjbGFzc01hcHBpbmdzKCk7CiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IG51\nbGw7CiAgICAgICAgQ29sdW1uW10gcGtzOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBwa3Mg\nPSBzdWJzW2ldLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgICAg\nIGlmIChwa3MubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICBjb250aW51\nZTsKCiAgICAgICAgICAgIGlmIChidWYgPT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgLy8gbWFrZSBzdXJlIHRoZSBiYXNlIGNsYXNzIGlzIGFsaWFzZWQg\nZmlyc3Qgc28gdGhhdCB3ZSBkb24ndAogICAgICAgICAgICAgICAgLy8gZW5k\nIHVwIHdpdGggb3VyIG91dGVyIGpvaW5zIGJlZm9yZSB0aGUgaW5uZXIgb25l\ncwogICAgICAgICAgICAgICAgYnVmID0gbmV3IFNRTEJ1ZmZlcihzZWwuZ2V0\nQ29uZmlndXJhdGlvbigpLgogICAgICAgICAgICAgICAgICAgIGdldERCRGlj\ndGlvbmFyeUluc3RhbmNlKCkpOwogICAgICAgICAgICAgICAgc2VsLmdldENv\nbHVtbkFsaWFzKGJhc2UuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKVswXSwgam9p\nbnMpOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoIiBBTkQgIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoc2VsLmdl\ndENvbHVtbkFsaWFzKHBrc1swXSwgam9pbnMpKS5hcHBlbmQoIiBJUyBOVUxM\nIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBidWY7CiAgICB9Cn0K\n","encoding":"base64"}

