{"sha":"413f95d8238a6de8302fbac337fde4c95a253f60","node_id":"MDQ6QmxvYjIwNjM2NDo0MTNmOTVkODIzOGE2ZGU4MzAyZmJhYzMzN2ZkZTRjOTVhMjUzZjYw","size":137647,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/413f95d8238a6de8302fbac337fde4c95a253f60","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEuaW8uQnl0ZUFy\ncmF5SW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uSW5w\ndXRTdHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLlJlYWRlcjsKaW1wb3J0\nIGphdmEuaW8uU3RyaW5nUmVhZGVyOwppbXBvcnQgamF2YS5pby5Xcml0ZXI7\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhj\nZXB0aW9uOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBv\ncnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9ydCBqYXZhLm1hdGguQmln\nSW50ZWdlcjsKaW1wb3J0IGphdmEuc3FsLkFycmF5OwppbXBvcnQgamF2YS5z\ncWwuQmxvYjsKaW1wb3J0IGphdmEuc3FsLkNsb2I7CmltcG9ydCBqYXZhLnNx\nbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuRGF0YWJhc2VNZXRhRGF0\nYTsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVtZW50OwppbXBvcnQg\namF2YS5zcWwuUmVmOwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU1FM\nV2FybmluZzsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0IGph\ndmEuc3FsLlRpbWU7CmltcG9ydCBqYXZhLnNxbC5UaW1lc3RhbXA7CmltcG9y\ndCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEudGV4dC5NZXNzYWdlRm9y\nbWF0OwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51\ndGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9y\ndCBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwppbXBvcnQgamF2YS51dGlsLkxvY2FsZTsKaW1wb3J0IGphdmEudXRp\nbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YXguc3Fs\nLkRhdGFTb3VyY2U7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcu\nU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5j\nb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRXhw\nQ29udGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5l\nbC5leHBzLkV4cFN0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMua2VybmVsLmV4cHMuRmlsdGVyVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5WYWw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5KYXZhU1FMVHlwZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkRhdGFT\nb3VyY2VGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuTmFtZVNldDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5QcmltYXJ5S2V5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TZXF1ZW5jZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5VbmlxdWU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuQ29ubmVjdGlvbkRl\nY29yYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5M\nb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnV0aWwuTG9jYWxpemVyLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5SZWZlcmVudGlhbEludGVncml0eUV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlNlcmlh\nbGl6YXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5TdG9y\nZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVu\nc3VwcG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuVXNlckV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAudXRp\nbC5OdW1iZXJzOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovKioKICog\nQ2xhc3Mgd2hpY2ggYWxsb3dzIHRoZSBjcmVhdGlvbiBvZiBTUUwgZHluYW1p\nY2FsbHksIGluIGEKICogZGF0YWJhc2UgYWdub3N0aWMgZmFzaGlvbi4gU3Vi\nY2xhc3MgZm9yIHRoZSBudWFuY2VzIG9mIGRpZmZlcmVudCBkYXRhIHN0b3Jl\ncy4KICovCnB1YmxpYyBjbGFzcyBEQkRpY3Rpb25hcnkKICAgIGltcGxlbWVu\ndHMgQ29uZmlndXJhYmxlLCBDb25uZWN0aW9uRGVjb3JhdG9yLCBKb2luU3lu\ndGF4ZXMsCiAgICBMb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvci5TUUxXYXJu\naW5nSGFuZGxlciB7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcg\nVkVORE9SX09USEVSID0gIm90aGVyIjsKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIFZFTkRPUl9EQVRBRElSRUNUID0gImRhdGFkaXJlY3QiOwoK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFNDSEVNQV9DQVNFX1VQ\nUEVSID0gInVwcGVyIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n\nIFNDSEVNQV9DQVNFX0xPV0VSID0gImxvd2VyIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFNDSEVNQV9DQVNFX1BSRVNFUlZFID0gInByZXNl\ncnZlIjsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBDT05TX05B\nTUVfQkVGT1JFID0gImJlZm9yZSI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBDT05TX05BTUVfTUlEID0gIm1pZCI7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBDT05TX05BTUVfQUZURVIgPSAiYWZ0ZXIiOwoK\nICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IFJBTkdFX1BPU1RfU0VM\nRUNUID0gMDsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IFJBTkdF\nX1BSRV9ESVNUSU5DVCA9IDE7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFs\nIGludCBSQU5HRV9QT1NUX0RJU1RJTkNUID0gMjsKICAgIHByb3RlY3RlZCBz\ndGF0aWMgZmluYWwgaW50IFJBTkdFX1BPU1RfTE9DSyA9IDM7CgogICAgcHJv\ndGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgTkFOTyA9IDE7CiAgICBwcm90ZWN0\nZWQgc3RhdGljIGZpbmFsIGludCBNSUNSTyA9IE5BTk8gKiAxMDAwOwogICAg\ncHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgTUlMTEkgPSBNSUNSTyAqIDEw\nMDA7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBDRU5USSA9IE1J\nTExJICogMTA7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBERUNJ\nID0gTUlMTEkgKiAxMDA7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGlu\ndCBTRUMgPSBNSUxMSSAqIDEwMDA7CgogICAgcHJvdGVjdGVkIHN0YXRpYyBm\naW5hbCBpbnQgTkFNRV9BTlkgPSAwOwogICAgcHJvdGVjdGVkIHN0YXRpYyBm\naW5hbCBpbnQgTkFNRV9UQUJMRSA9IDE7CiAgICBwcm90ZWN0ZWQgc3RhdGlj\nIGZpbmFsIGludCBOQU1FX1NFUVVFTkNFID0gMjsKCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgWkVST19EQVRFX1NUUiA9CiAgICAgICAgIici\nICsgbmV3IGphdmEuc3FsLkRhdGUoMCkgKyAiJyI7CiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgWkVST19USU1FX1NUUiA9ICInIiArIG5ldyBU\naW1lKDApICsgIiciOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5n\nIFpFUk9fVElNRVNUQU1QX1NUUiA9CiAgICAgICAgIiciICsgbmV3IFRpbWVz\ndGFtcCgwKSArICInIjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2Nh\nbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKERC\nRGljdGlvbmFyeS5jbGFzcyk7CgogICAgLy8gc2NoZW1hIGRhdGEKICAgIHB1\nYmxpYyBTdHJpbmcgcGxhdGZvcm0gPSAiR2VuZXJpYyI7CiAgICBwdWJsaWMg\nU3RyaW5nIGRyaXZlclZlbmRvciA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5n\nIGNhdGFsb2dTZXBhcmF0b3IgPSAiLiI7CiAgICBwdWJsaWMgYm9vbGVhbiBj\ncmVhdGVQcmltYXJ5S2V5cyA9IHRydWU7CiAgICBwdWJsaWMgU3RyaW5nIGNv\nbnN0cmFpbnROYW1lTW9kZSA9IENPTlNfTkFNRV9CRUZPUkU7CiAgICBwdWJs\naWMgaW50IG1heFRhYmxlTmFtZUxlbmd0aCA9IDEyODsKICAgIHB1YmxpYyBp\nbnQgbWF4Q29sdW1uTmFtZUxlbmd0aCA9IDEyODsKICAgIHB1YmxpYyBpbnQg\nbWF4Q29uc3RyYWludE5hbWVMZW5ndGggPSAxMjg7CiAgICBwdWJsaWMgaW50\nIG1heEluZGV4TmFtZUxlbmd0aCA9IDEyODsKICAgIHB1YmxpYyBpbnQgbWF4\nSW5kZXhlc1BlclRhYmxlID0gSW50ZWdlci5NQVhfVkFMVUU7CiAgICBwdWJs\naWMgYm9vbGVhbiBzdXBwb3J0c0ZvcmVpZ25LZXlzID0gdHJ1ZTsKICAgIHB1\nYmxpYyBib29sZWFuIHN1cHBvcnRzVGltZXN0YW1wTmFub3MgPSB0cnVlOwog\nICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNVbmlxdWVDb25zdHJhaW50cyA9\nIHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0RlZmVycmVkQ29u\nc3RyYWludHMgPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNS\nZXN0cmljdERlbGV0ZUFjdGlvbiA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c0Nhc2NhZGVEZWxldGVBY3Rpb24gPSB0cnVlOwogICAgcHVi\nbGljIGJvb2xlYW4gc3VwcG9ydHNOdWxsRGVsZXRlQWN0aW9uID0gdHJ1ZTsK\nICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzRGVmYXVsdERlbGV0ZUFjdGlv\nbiA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1Jlc3RyaWN0\nVXBkYXRlQWN0aW9uID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzQ2FzY2FkZVVwZGF0ZUFjdGlvbiA9IHRydWU7CiAgICBwdWJsaWMgYm9v\nbGVhbiBzdXBwb3J0c051bGxVcGRhdGVBY3Rpb24gPSB0cnVlOwogICAgcHVi\nbGljIGJvb2xlYW4gc3VwcG9ydHNEZWZhdWx0VXBkYXRlQWN0aW9uID0gdHJ1\nZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzQWx0ZXJUYWJsZVdpdGhB\nZGRDb2x1bW4gPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNB\nbHRlclRhYmxlV2l0aERyb3BDb2x1bW4gPSB0cnVlOwogICAgcHVibGljIFN0\ncmluZyByZXNlcnZlZFdvcmRzID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcg\nc3lzdGVtU2NoZW1hcyA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIHN5c3Rl\nbVRhYmxlcyA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIGZpeGVkU2l6ZVR5\ncGVOYW1lcyA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIHNjaGVtYUNhc2Ug\nPSBTQ0hFTUFfQ0FTRV9VUFBFUjsKCiAgICAvLyBzcWwKICAgIHB1YmxpYyBT\ndHJpbmcgdmFsaWRhdGlvblNRTCA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5n\nIGNsb3NlUG9vbFNRTCA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIGluaXRp\nYWxpemF0aW9uU1FMID0gbnVsbDsKICAgIHB1YmxpYyBpbnQgam9pblN5bnRh\neCA9IFNZTlRBWF9TUUw5MjsKICAgIHB1YmxpYyBTdHJpbmcgb3V0ZXJKb2lu\nQ2xhdXNlID0gIkxFRlQgT1VURVIgSk9JTiI7CiAgICBwdWJsaWMgU3RyaW5n\nIGlubmVySm9pbkNsYXVzZSA9ICJJTk5FUiBKT0lOIjsKICAgIHB1YmxpYyBT\ndHJpbmcgY3Jvc3NKb2luQ2xhdXNlID0gIkNST1NTIEpPSU4iOwogICAgcHVi\nbGljIGJvb2xlYW4gcmVxdWlyZXNDb25kaXRpb25Gb3JDcm9zc0pvaW4gPSBm\nYWxzZTsKICAgIHB1YmxpYyBTdHJpbmcgZm9yVXBkYXRlQ2xhdXNlID0gIkZP\nUiBVUERBVEUiOwogICAgcHVibGljIFN0cmluZyB0YWJsZUZvclVwZGF0ZUNs\nYXVzZSA9IG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIGRpc3RpbmN0Q291bnRD\nb2x1bW5TZXBhcmF0b3IgPSBudWxsOwogICAgcHVibGljIGJvb2xlYW4gc3Vw\ncG9ydHNTZWxlY3RGb3JVcGRhdGUgPSB0cnVlOwogICAgcHVibGljIGJvb2xl\nYW4gc3VwcG9ydHNMb2NraW5nV2l0aERpc3RpbmN0Q2xhdXNlID0gdHJ1ZTsK\nICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9ja2luZ1dpdGhNdWx0aXBs\nZVRhYmxlcyA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0xv\nY2tpbmdXaXRoT3JkZXJDbGF1c2UgPSB0cnVlOwogICAgcHVibGljIGJvb2xl\nYW4gc3VwcG9ydHNMb2NraW5nV2l0aE91dGVySm9pbiA9IHRydWU7CiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c0xvY2tpbmdXaXRoSW5uZXJKb2luID0g\ndHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9ja2luZ1dpdGhT\nZWxlY3RSYW5nZSA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0\nc1F1ZXJ5VGltZW91dCA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzaW11\nbGF0ZUxvY2tpbmcgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzU3Vic2VsZWN0ID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzQ29ycmVsYXRlZFN1YnNlbGVjdCA9IHRydWU7CiAgICBwdWJsaWMgYm9v\nbGVhbiBzdXBwb3J0c0hhdmluZyA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c1NlbGVjdFN0YXJ0SW5kZXggPSBmYWxzZTsKICAgIHB1Ymxp\nYyBib29sZWFuIHN1cHBvcnRzU2VsZWN0RW5kSW5kZXggPSBmYWxzZTsKICAg\nIHB1YmxpYyBpbnQgcmFuZ2VQb3NpdGlvbiA9IFJBTkdFX1BPU1RfU0VMRUNU\nOwogICAgcHVibGljIGJvb2xlYW4gcmVxdWlyZXNBbGlhc0ZvclN1YnNlbGVj\ndCA9IGZhbHNlOwogICAgcHVibGljIGJvb2xlYW4gYWxsb3dzQWxpYXNJbkJ1\nbGtDbGF1c2UgPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNN\ndWx0aXBsZU5vbnRyYW5zYWN0aW9uYWxSZXN1bHRTZXRzID0gdHJ1ZTsKICAg\nIHB1YmxpYyBTdHJpbmcgc2VhcmNoU3RyaW5nRXNjYXBlID0gIlxcIjsKICAg\nIHB1YmxpYyBib29sZWFuIHJlcXVpcmVzQ2FzdEZvck1hdGhGdW5jdGlvbnMg\nPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHJlcXVpcmVzQ2FzdEZvckNv\nbXBhcmlzb25zID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0\nc01vZE9wZXJhdG9yID0gZmFsc2U7CgogICAgLy8gZnVuY3Rpb25zCiAgICBw\ndWJsaWMgU3RyaW5nIGNhc3RGdW5jdGlvbiA9ICJDQVNUKHswfSBBUyB7MX0p\nIjsKICAgIHB1YmxpYyBTdHJpbmcgdG9Mb3dlckNhc2VGdW5jdGlvbiA9ICJM\nT1dFUih7MH0pIjsKICAgIHB1YmxpYyBTdHJpbmcgdG9VcHBlckNhc2VGdW5j\ndGlvbiA9ICJVUFBFUih7MH0pIjsKICAgIHB1YmxpYyBTdHJpbmcgc3RyaW5n\nTGVuZ3RoRnVuY3Rpb24gPSAiQ0hBUl9MRU5HVEgoezB9KSI7CiAgICBwdWJs\naWMgU3RyaW5nIGJpdExlbmd0aEZ1bmN0aW9uID0gIihPQ1RFVF9MRU5HVEgo\nezB9KSAqIDgpIjsKICAgIHB1YmxpYyBTdHJpbmcgdHJpbUxlYWRpbmdGdW5j\ndGlvbiA9ICJUUklNKExFQURJTkcgezF9IEZST00gezB9KSI7CiAgICBwdWJs\naWMgU3RyaW5nIHRyaW1UcmFpbGluZ0Z1bmN0aW9uID0gIlRSSU0oVFJBSUxJ\nTkcgezF9IEZST00gezB9KSI7CiAgICBwdWJsaWMgU3RyaW5nIHRyaW1Cb3Ro\nRnVuY3Rpb24gPSAiVFJJTShCT1RIIHsxfSBGUk9NIHswfSkiOwogICAgcHVi\nbGljIFN0cmluZyBjb25jYXRlbmF0ZUZ1bmN0aW9uID0gIih7MH18fHsxfSki\nOwogICAgcHVibGljIFN0cmluZyBjb25jYXRlbmF0ZURlbGltaXRlciA9ICIn\nT1BFTkpQQVRPS0VOJyI7CiAgICBwdWJsaWMgU3RyaW5nIHN1YnN0cmluZ0Z1\nbmN0aW9uTmFtZSA9ICJTVUJTVFJJTkciOwogICAgcHVibGljIFN0cmluZyBj\ndXJyZW50RGF0ZUZ1bmN0aW9uID0gIkNVUlJFTlRfREFURSI7CiAgICBwdWJs\naWMgU3RyaW5nIGN1cnJlbnRUaW1lRnVuY3Rpb24gPSAiQ1VSUkVOVF9USU1F\nIjsKICAgIHB1YmxpYyBTdHJpbmcgY3VycmVudFRpbWVzdGFtcEZ1bmN0aW9u\nID0gIkNVUlJFTlRfVElNRVNUQU1QIjsKICAgIHB1YmxpYyBTdHJpbmcgZHJv\ncFRhYmxlU1FMID0gIkRST1AgVEFCTEUgezB9IjsKCiAgICAvLyB0eXBlcwog\nICAgcHVibGljIGJvb2xlYW4gc3RvcmFnZUxpbWl0YXRpb25zRmF0YWwgPSBm\nYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHN0b3JlTGFyZ2VOdW1iZXJzQXNT\ndHJpbmdzID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBzdG9yZUNoYXJz\nQXNOdW1iZXJzID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHVzZUdldEJ5\ndGVzRm9yQmxvYnMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHVzZVNl\ndEJ5dGVzRm9yQmxvYnMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHVz\nZUdldE9iamVjdEZvckJsb2JzID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVh\nbiB1c2VHZXRTdHJpbmdGb3JDbG9icyA9IGZhbHNlOwogICAgcHVibGljIGJv\nb2xlYW4gdXNlU2V0U3RyaW5nRm9yQ2xvYnMgPSBmYWxzZTsKICAgIHB1Ymxp\nYyBpbnQgbWF4RW1iZWRkZWRCbG9iU2l6ZSA9IC0xOwogICAgcHVibGljIGlu\ndCBtYXhFbWJlZGRlZENsb2JTaXplID0gLTE7CiAgICBwdWJsaWMgaW50IGlu\nQ2xhdXNlTGltaXQgPSAtMTsKICAgIHB1YmxpYyBpbnQgZGF0ZVByZWNpc2lv\nbiA9IE1JTExJOwogICAgcHVibGljIGludCBjaGFyYWN0ZXJDb2x1bW5TaXpl\nID0gMjU1OwogICAgcHVibGljIFN0cmluZyBhcnJheVR5cGVOYW1lID0gIkFS\nUkFZIjsKICAgIHB1YmxpYyBTdHJpbmcgYmlnaW50VHlwZU5hbWUgPSAiQklH\nSU5UIjsKICAgIHB1YmxpYyBTdHJpbmcgYmluYXJ5VHlwZU5hbWUgPSAiQklO\nQVJZIjsKICAgIHB1YmxpYyBTdHJpbmcgYml0VHlwZU5hbWUgPSAiQklUIjsK\nICAgIHB1YmxpYyBTdHJpbmcgYmxvYlR5cGVOYW1lID0gIkJMT0IiOwogICAg\ncHVibGljIFN0cmluZyBib29sZWFuVHlwZU5hbWUgPSAiQk9PTEVBTiI7CiAg\nICBwdWJsaWMgU3RyaW5nIGNoYXJUeXBlTmFtZSA9ICJDSEFSIjsKICAgIHB1\nYmxpYyBTdHJpbmcgY2xvYlR5cGVOYW1lID0gIkNMT0IiOwogICAgcHVibGlj\nIFN0cmluZyBkYXRlVHlwZU5hbWUgPSAiREFURSI7CiAgICBwdWJsaWMgU3Ry\naW5nIGRlY2ltYWxUeXBlTmFtZSA9ICJERUNJTUFMIjsKICAgIHB1YmxpYyBT\ndHJpbmcgZGlzdGluY3RUeXBlTmFtZSA9ICJESVNUSU5DVCI7CiAgICBwdWJs\naWMgU3RyaW5nIGRvdWJsZVR5cGVOYW1lID0gIkRPVUJMRSI7CiAgICBwdWJs\naWMgU3RyaW5nIGZsb2F0VHlwZU5hbWUgPSAiRkxPQVQiOwogICAgcHVibGlj\nIFN0cmluZyBpbnRlZ2VyVHlwZU5hbWUgPSAiSU5URUdFUiI7CiAgICBwdWJs\naWMgU3RyaW5nIGphdmFPYmplY3RUeXBlTmFtZSA9ICJKQVZBX09CSkVDVCI7\nCiAgICBwdWJsaWMgU3RyaW5nIGxvbmdWYXJiaW5hcnlUeXBlTmFtZSA9ICJM\nT05HVkFSQklOQVJZIjsKICAgIHB1YmxpYyBTdHJpbmcgbG9uZ1ZhcmNoYXJU\neXBlTmFtZSA9ICJMT05HVkFSQ0hBUiI7CiAgICBwdWJsaWMgU3RyaW5nIG51\nbGxUeXBlTmFtZSA9ICJOVUxMIjsKICAgIHB1YmxpYyBTdHJpbmcgbnVtZXJp\nY1R5cGVOYW1lID0gIk5VTUVSSUMiOwogICAgcHVibGljIFN0cmluZyBvdGhl\nclR5cGVOYW1lID0gIk9USEVSIjsKICAgIHB1YmxpYyBTdHJpbmcgcmVhbFR5\ncGVOYW1lID0gIlJFQUwiOwogICAgcHVibGljIFN0cmluZyByZWZUeXBlTmFt\nZSA9ICJSRUYiOwogICAgcHVibGljIFN0cmluZyBzbWFsbGludFR5cGVOYW1l\nID0gIlNNQUxMSU5UIjsKICAgIHB1YmxpYyBTdHJpbmcgc3RydWN0VHlwZU5h\nbWUgPSAiU1RSVUNUIjsKICAgIHB1YmxpYyBTdHJpbmcgdGltZVR5cGVOYW1l\nID0gIlRJTUUiOwogICAgcHVibGljIFN0cmluZyB0aW1lc3RhbXBUeXBlTmFt\nZSA9ICJUSU1FU1RBTVAiOwogICAgcHVibGljIFN0cmluZyB0aW55aW50VHlw\nZU5hbWUgPSAiVElOWUlOVCI7CiAgICBwdWJsaWMgU3RyaW5nIHZhcmJpbmFy\neVR5cGVOYW1lID0gIlZBUkJJTkFSWSI7CiAgICBwdWJsaWMgU3RyaW5nIHZh\ncmNoYXJUeXBlTmFtZSA9ICJWQVJDSEFSIjsKCiAgICAvLyBzY2hlbWEgbWV0\nYWRhdGEKICAgIHB1YmxpYyBib29sZWFuIHVzZVNjaGVtYU5hbWUgPSB0cnVl\nOwogICAgcHVibGljIFN0cmluZyB0YWJsZVR5cGVzID0gIlRBQkxFIjsKICAg\nIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzU2NoZW1hRm9yR2V0VGFibGVzID0g\ndHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzU2NoZW1hRm9yR2V0\nQ29sdW1ucyA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c051\nbGxUYWJsZUZvckdldENvbHVtbnMgPSB0cnVlOwogICAgcHVibGljIGJvb2xl\nYW4gc3VwcG9ydHNOdWxsVGFibGVGb3JHZXRQcmltYXJ5S2V5cyA9IGZhbHNl\nOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNOdWxsVGFibGVGb3JHZXRJ\nbmRleEluZm8gPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRz\nTnVsbFRhYmxlRm9yR2V0SW1wb3J0ZWRLZXlzID0gZmFsc2U7CiAgICBwdWJs\naWMgYm9vbGVhbiB1c2VHZXRCZXN0Um93SWRlbnRpZmllckZvclByaW1hcnlL\nZXlzID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiByZXF1aXJlc0F1dG9D\nb21taXRGb3JNZXRhRGF0YSA9IGZhbHNlOwoKICAgIC8vIGF1dG8taW5jcmVt\nZW50CiAgICBwdWJsaWMgaW50IG1heEF1dG9Bc3NpZ25OYW1lTGVuZ3RoID0g\nMzE7CiAgICBwdWJsaWMgU3RyaW5nIGF1dG9Bc3NpZ25DbGF1c2UgPSBudWxs\nOwogICAgcHVibGljIFN0cmluZyBhdXRvQXNzaWduVHlwZU5hbWUgPSBudWxs\nOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNBdXRvQXNzaWduID0gZmFs\nc2U7CiAgICBwdWJsaWMgU3RyaW5nIGxhc3RHZW5lcmF0ZWRLZXlRdWVyeSA9\nIG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIG5leHRTZXF1ZW5jZVF1ZXJ5ID0g\nbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgc2VxdWVuY2VTUUwgPSBudWxsOwog\nICAgcHVibGljIFN0cmluZyBzZXF1ZW5jZVNjaGVtYVNRTCA9IG51bGw7CiAg\nICBwdWJsaWMgU3RyaW5nIHNlcXVlbmNlTmFtZVNRTCA9IG51bGw7CgogICAg\ncHJvdGVjdGVkIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBudWxsOwogICAg\ncHJvdGVjdGVkIExvZyBsb2cgPSBudWxsOwogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gY29ubmVjdGVkID0gZmFsc2U7CiAgICBwcm90ZWN0ZWQgZmluYWwgU2V0\nIHJlc2VydmVkV29yZFNldCA9IG5ldyBIYXNoU2V0KCk7CiAgICBwcm90ZWN0\nZWQgZmluYWwgU2V0IHN5c3RlbVNjaGVtYVNldCA9IG5ldyBIYXNoU2V0KCk7\nCiAgICBwcm90ZWN0ZWQgZmluYWwgU2V0IHN5c3RlbVRhYmxlU2V0ID0gbmV3\nIEhhc2hTZXQoKTsKICAgIHByb3RlY3RlZCBmaW5hbCBTZXQgZml4ZWRTaXpl\nVHlwZU5hbWVTZXQgPSBuZXcgSGFzaFNldCgpOwoKICAgIC8vIHdoZW4gd2Ug\nc3RvcmUgdmFsdWVzIHRoYXQgbG9zZSBwcmVjaW9uLCB0cmFjayB0aGUgdHlw\nZXMgc28gdGhhdCB0aGUKICAgIC8vIGZpcnN0IHRpbWUgaXQgaGFwcGVucyB3\nZSBjYW4gd2FybiB0aGUgdXNlcgogICAgcHJpdmF0ZSBTZXQgX3ByZWNpc2lv\nbldhcm5lZFR5cGVzID0gbnVsbDsKCiAgICAvLyBjYWNoZSBsb2IgbWV0aG9k\ncwogICAgcHJpdmF0ZSBNZXRob2QgX3NldEJ5dGVzID0gbnVsbDsKICAgIHBy\naXZhdGUgTWV0aG9kIF9zZXRTdHJpbmcgPSBudWxsOwogICAgcHJpdmF0ZSBN\nZXRob2QgX3NldENoYXJTdHJlYW0gPSBudWxsOwoKICAgIHB1YmxpYyBEQkRp\nY3Rpb25hcnkoKSB7CiAgICAgICAgZml4ZWRTaXplVHlwZU5hbWVTZXQuYWRk\nQWxsKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdewogICAgICAgICAgICAi\nQklHSU5UIiwgIkJJVCIsICJCTE9CIiwgIkNMT0IiLCAiREFURSIsICJERUNJ\nTUFMIiwgIkRJU1RJTkNUIiwKICAgICAgICAgICAgIkRPVUJMRSIsICJGTE9B\nVCIsICJJTlRFR0VSIiwgIkpBVkFfT0JKRUNUIiwgIk5VTEwiLCAiTlVNRVJJ\nQyIsCiAgICAgICAgICAgICJPVEhFUiIsICJSRUFMIiwgIlJFRiIsICJTTUFM\nTElOVCIsICJTVFJVQ1QiLCAiVElNRSIsICJUSU1FU1RBTVAiLAogICAgICAg\nICAgICAiVElOWUlOVCIsCiAgICAgICAgfSkpOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhpcyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gdGhlIGRpY3Rpb25h\ncnkgZmlyc3Qgc2VlcyBhbnkgY29ubmVjdGlvbi4KICAgICAqIEl0IGlzIHVz\nZWQgdG8gaW5pdGlhbGl6ZSBkaWN0aW9uYXJ5IG1ldGFkYXRhIGlmIG5lZWRl\nZC4gSWYgeW91CiAgICAgKiBvdmVycmlkZSB0aGlzIG1ldGhvZCwgYmUgc3Vy\nZSB0byBjYWxsCiAgICAgKiA8Y29kZT5zdXBlci5jb25uZWN0ZWRDb25maWd1\ncmF0aW9uPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIHZvaWQgY29ubmVj\ndGVkQ29uZmlndXJhdGlvbihDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFjb25uZWN0ZWQpIHsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmIChsb2cuaXNU\ncmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2Uo\nREJEaWN0aW9uYXJ5RmFjdG9yeS50b1N0cmluZwogICAgICAgICAgICAgICAg\nICAgICAgICAoY29ubi5nZXRNZXRhRGF0YSgpKSk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBsb2cudHJh\nY2UoZS50b1N0cmluZygpLCBlKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICBjb25uZWN0ZWQgPSB0cnVlOwogICAgfQoKICAgIC8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8KICAgIC8vIFJlc3VsdFNldCB3cmFwcGVycwogICAg\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogQ29udmVy\ndCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0\nbyB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBBcnJheSBnZXRBcnJheShSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIHJzLmdldEFycmF5KGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0\nU2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwog\nICAgcHVibGljIElucHV0U3RyZWFtIGdldEFzY2lpU3RyZWFtKFJlc3VsdFNl\ndCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICByZXR1cm4gcnMuZ2V0QXNjaWlTdHJlYW0oY29sdW1uKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBj\nb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAg\nICogamF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgQmlnRGVjaW1hbCBn\nZXRCaWdEZWNpbWFsKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoc3RvcmVMYXJn\nZU51bWJlcnNBc1N0cmluZ3MpIHsKICAgICAgICAgICAgU3RyaW5nIHN0ciA9\nIGdldFN0cmluZyhycywgY29sdW1uKTsKICAgICAgICAgICAgcmV0dXJuIChz\ndHIgPT0gbnVsbCkgPyBudWxsIDogbmV3IEJpZ0RlY2ltYWwoc3RyKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIHJzLmdldEJpZ0RlY2ltYWwoY29sdW1u\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHNwZWNpZmll\nZCBjb2x1bW4gdmFsdWUgYXMgYW4gdW5rbm93biBudW1lcmljIHR5cGU7CiAg\nICAgKiB3ZSB0cnkgZnJvbSB0aGUgbW9zdCBnZW5lcmljIHRvIHRoZSBsZWFz\ndCBnZW5lcmljLgogICAgICovCiAgICBwdWJsaWMgTnVtYmVyIGdldE51bWJl\ncihSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gdHJ5IGZyb20gdGhlIG1vc3QgZ2Vu\nZXJpYywgYW5kIGlmIGVycm9ycyBvY2N1ciwgdHJ5CiAgICAgICAgLy8gbGVz\ncyBnZW5lcmljIHR5cGVzOyB0aGlzIGVuYWJsZXMgdXMgdG8gaGFuZGxlIHZh\nbHVlcwogICAgICAgIC8vIGxpa2UgRG91YmxlLk5hTiB3aXRob3V0IGhhdmlu\nZyB0byBpbnRyb3NwZWN0IG9uIHRoZQogICAgICAgIC8vIFJlc3VsdFNldE1l\ndGFEYXRhIChidWcgIzEwNTMpLiBub3RlIHRoYXQgd2UgaGFuZGxlCiAgICAg\nICAgLy8gZ2VuZXJpYyBleGNlcHRpb25zLCBzaW5jZSBzb21lIGRyaXZlcnMg\nbWF5IHRocm93CiAgICAgICAgLy8gTnVtYmVyRm9ybWF0RXhjZXB0aW9ucywg\nd2hlcmVhcyBvdGhlcnMgbWF5IHRocm93IFNRTEV4Y2VwdGlvbnMKICAgICAg\nICB0cnkgewogICAgICAgICAgICByZXR1cm4gZ2V0QmlnRGVjaW1hbChycywg\nY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZTEpIHsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG91\nYmxlKGdldERvdWJsZShycywgY29sdW1uKSk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlMikgewogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZsb2F0KGdldEZsb2F0KHJz\nLCBjb2x1bW4pKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlMykgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YoZ2V0TG9uZyhy\ncywgY29sdW1uKSk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGU0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1\nZU9mKGdldEludChycywgY29sdW1uKSk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlNSkgewogICAgICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZTEgaW5zdGFu\nY2VvZiBSdW50aW1lRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgdGhyb3co\nUnVudGltZUV4Y2VwdGlvbikgZTE7CiAgICAgICAgICAgIGlmIChlMSBpbnN0\nYW5jZW9mIFNRTEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRocm93KFNR\nTEV4Y2VwdGlvbikgZTE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmll\nZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3Blcgog\nICAgICogamF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgQmlnSW50ZWdl\nciBnZXRCaWdJbnRlZ2VyKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoc3RvcmVM\nYXJnZU51bWJlcnNBc1N0cmluZ3MpIHsKICAgICAgICAgICAgU3RyaW5nIHN0\nciA9IGdldFN0cmluZyhycywgY29sdW1uKTsKICAgICAgICAgICAgcmV0dXJu\nIChzdHIgPT0gbnVsbCkgPyBudWxsIDogbmV3IEJpZ0RlY2ltYWwoc3RyKS50\nb0JpZ0ludGVnZXIoKTsKICAgICAgICB9CiAgICAgICAgQmlnRGVjaW1hbCBi\nZCA9IGdldEJpZ0RlY2ltYWwocnMsIGNvbHVtbik7CiAgICAgICAgcmV0dXJu\nIChiZCA9PSBudWxsKSA/IG51bGwgOiBiZC50b0JpZ0ludGVnZXIoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1\nbW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICog\namF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgSW5wdXRTdHJlYW0gZ2V0\nQmluYXJ5U3RyZWFtKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcnMuZ2V0\nQmluYXJ5U3RyZWFtKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0\nU2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwog\nICAgcHVibGljIEJsb2IgZ2V0QmxvYihSZXN1bHRTZXQgcnMsIGludCBjb2x1\nbW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0\ndXJuIHJzLmdldEJsb2IoY29sdW1uKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1\nbHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICov\nCiAgICBwdWJsaWMgT2JqZWN0IGdldEJsb2JPYmplY3QoUmVzdWx0U2V0IHJz\nLCBpbnQgY29sdW1uLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgSW5wdXRTdHJlYW0gaW4gPSBudWxs\nOwogICAgICAgIGlmICh1c2VHZXRCeXRlc0ZvckJsb2JzIHx8IHVzZUdldE9i\namVjdEZvckJsb2JzKSB7CiAgICAgICAgICAgIGJ5dGVbXSBieXRlcyA9IGdl\ndEJ5dGVzKHJzLCBjb2x1bW4pOwogICAgICAgICAgICBpZiAoYnl0ZXMgIT0g\nbnVsbCAmJiBieXRlcy5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAgaW4g\nPSBuZXcgQnl0ZUFycmF5SW5wdXRTdHJlYW0oYnl0ZXMpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIEJsb2IgYmxvYiA9IGdldEJsb2IocnMsIGNv\nbHVtbik7CiAgICAgICAgICAgIGlmIChibG9iICE9IG51bGwgJiYgYmxvYi5s\nZW5ndGgoKSA+IDApCiAgICAgICAgICAgICAgICBpbiA9IGJsb2IuZ2V0Qmlu\nYXJ5U3RyZWFtKCk7CiAgICAgICAgfQogICAgICAgIGlmIChpbiA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgaWYgKHN0b3JlID09IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gU2VyaWFsaXphdGlvbi5kZXNlcmlhbGl6ZShpbiwgbnVsbCk7CiAg\nICAgICAgICAgIHJldHVybiBTZXJpYWxpemF0aW9uLmRlc2VyaWFsaXplKGlu\nLCBzdG9yZS5nZXRDb250ZXh0KCkpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpbi5jbG9zZSgpOwog\nICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENvbnZl\ncnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQg\ndG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRCb29sZWFuKFJlc3VsdFNldCBycywgaW50IGNv\nbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gcnMuZ2V0Qm9vbGVhbihjb2x1bW4pOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FM\nIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyBieXRlIGdldEJ5dGUoUmVzdWx0U2V0IHJzLCBp\nbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHJldHVybiBycy5nZXRCeXRlKGNvbHVtbik7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBT\nUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4K\nICAgICAqLwogICAgcHVibGljIGJ5dGVbXSBnZXRCeXRlcyhSZXN1bHRTZXQg\ncnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKHVzZUdldEJ5dGVzRm9yQmxvYnMpCiAgICAgICAgICAg\nIHJldHVybiBycy5nZXRCeXRlcyhjb2x1bW4pOwogICAgICAgIGlmICh1c2VH\nZXRPYmplY3RGb3JCbG9icykKICAgICAgICAgICAgcmV0dXJuIChieXRlW10p\nIHJzLmdldE9iamVjdChjb2x1bW4pOwoKICAgICAgICBCbG9iIGJsb2IgPSBn\nZXRCbG9iKHJzLCBjb2x1bW4pOwogICAgICAgIGlmIChibG9iID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGludCBsZW5ndGgg\nPSAoaW50KSBibG9iLmxlbmd0aCgpOwogICAgICAgIGlmIChsZW5ndGggPT0g\nMCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIGJs\nb2IuZ2V0Qnl0ZXMoMSwgbGVuZ3RoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1\nbHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLiBDb252ZXJ0\ncyB0aGUgZGF0ZSBmcm9tIGEge0BsaW5rIFRpbWVzdGFtcH0gYnkgZGVmYXVs\ndC4KICAgICAqLwogICAgcHVibGljIENhbGVuZGFyIGdldENhbGVuZGFyKFJl\nc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBEYXRlIGQgPSBnZXREYXRlKHJzLCBjb2x1bW4p\nOwogICAgICAgIGlmIChkID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwoKICAgICAgICBDYWxlbmRhciBjYWwgPSBDYWxlbmRhci5nZXRJbnN0\nYW5jZSgpOwogICAgICAgIGNhbC5zZXRUaW1lKGQpOwogICAgICAgIHJldHVy\nbiBjYWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVj\naWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9w\nZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIGNoYXIg\nZ2V0Q2hhcihSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHN0b3JlQ2hhcnNBc051\nbWJlcnMpCiAgICAgICAgICAgIHJldHVybiAoY2hhcikgZ2V0SW50KHJzLCBj\nb2x1bW4pOwoKICAgICAgICBTdHJpbmcgc3RyID0gZ2V0U3RyaW5nKHJzLCBj\nb2x1bW4pOwogICAgICAgIHJldHVybiAoU3RyaW5nVXRpbHMuaXNFbXB0eShz\ndHIpKSA/IDAgOiBzdHIuY2hhckF0KDApOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJl\nc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBSZWFkZXIgZ2V0Q2hhcmFjdGVyU3RyZWFtKFJlc3Vs\ndFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gcnMuZ2V0Q2hhcmFjdGVyU3RyZWFtKGNv\nbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVj\naWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9w\nZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIENsb2Ig\nZ2V0Q2xvYihSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHJzLmdldENsb2Io\nY29sdW1uKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNw\nZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHBy\nb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGdldENsb2JTdHJpbmcoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh1c2VH\nZXRTdHJpbmdGb3JDbG9icykKICAgICAgICAgICAgcmV0dXJuIHJzLmdldFN0\ncmluZyhjb2x1bW4pOwoKICAgICAgICBDbG9iIGNsb2IgPSBnZXRDbG9iKHJz\nLCBjb2x1bW4pOwogICAgICAgIGlmIChjbG9iID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChjbG9iLmxlbmd0aCgpID09\nIDApCiAgICAgICAgICAgIHJldHVybiAiIjsKCiAgICAgICAgLy8gdW5saWtl\nbHkgdGhhdCB3ZSdsbCBoYXZlIHN0cmluZ3Mgb3ZlciBJbnRlZ2VyLk1BWF9W\nQUxVRSBjaGFycwogICAgICAgIHJldHVybiBjbG9iLmdldFN1YlN0cmluZygx\nLCAoaW50KSBjbG9iLmxlbmd0aCgpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1\nbHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLiBDb252ZXJ0\ncyB0aGUgZGF0ZSBmcm9tIGEge0BsaW5rIFRpbWVzdGFtcH0gYnkgZGVmYXVs\ndC4KICAgICAqLwogICAgcHVibGljIERhdGUgZ2V0RGF0ZShSZXN1bHRTZXQg\ncnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgVGltZXN0YW1wIHRzdGFtcCA9IGdldFRpbWVzdGFtcChycywg\nY29sdW1uLCBudWxsKTsKICAgICAgICBpZiAodHN0YW1wID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAvLyBnZXQgdGhlIGZy\nYWN0aW9uYWwgc2Vjb25kcyBjb21wb25lbnQsIHJvdW5kaW5nIGF3YXkgYW55\ndGhpbmcgYmV5b25kCiAgICAgICAgLy8gbWlsbGlzZWNvbmRzCiAgICAgICAg\naW50IGZyYWN0aW9uYWwgPSAoaW50KSBNYXRoLnJvdW5kKHRzdGFtcC5nZXRO\nYW5vcygpIC8gKGRvdWJsZSkgTUlMTEkpOwoKICAgICAgICAvLyBnZXQgdGhl\nIG1pbGxpcyBjb21wb25lbnQ7IHNvbWUgSkRCQyBkcml2ZXJzIHJvdW5kIHRo\naXMgdG8gdGhlCiAgICAgICAgLy8gbmVhcmVzdCBzZWNvbmQsIHdoaWxlIG90\naGVycyBkbyBub3QKICAgICAgICBsb25nIG1pbGxpcyA9ICh0c3RhbXAuZ2V0\nVGltZSgpIC8gMTAwMEwpICogMTAwMEw7CiAgICAgICAgcmV0dXJuIG5ldyBE\nYXRlKG1pbGxpcyArIGZyYWN0aW9uYWwpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJl\nc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBqYXZhLnNxbC5EYXRlIGdldERhdGUoUmVzdWx0U2V0\nIHJzLCBpbnQgY29sdW1uLCBDYWxlbmRhciBjYWwpCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGNhbCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gcnMuZ2V0RGF0ZShjb2x1bW4pOwogICAgICAgIHJl\ndHVybiBycy5nZXREYXRlKGNvbHVtbiwgY2FsKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNR\nTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgog\nICAgICovCiAgICBwdWJsaWMgZG91YmxlIGdldERvdWJsZShSZXN1bHRTZXQg\ncnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgcmV0dXJuIHJzLmdldERvdWJsZShjb2x1bW4pOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBv\nZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZh\nIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBmbG9hdCBnZXRGbG9hdChSZXN1\nbHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIHJzLmdldEZsb2F0KGNvbHVtbik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29s\ndW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAq\nIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRJbnQoUmVz\ndWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIHJldHVybiBycy5nZXRJbnQoY29sdW1uKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1\nbW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICog\namF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgTG9jYWxlIGdldExvY2Fs\nZShSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHN0ciA9IGdldFN0cmluZyhy\ncywgY29sdW1uKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShz\ndHIpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU3RyaW5n\nW10gcGFyYW1zID0gU3RyaW5ncy5zcGxpdChzdHIsICJfIiwgMyk7CiAgICAg\nICAgaWYgKHBhcmFtcy5sZW5ndGggPCAzKQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICByZXR1cm4gbmV3IExvY2FsZShwYXJhbXNbMF0sIHBh\ncmFtc1sxXSwgcGFyYW1zWzJdKTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\nbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRT\nZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAg\nICBwdWJsaWMgbG9uZyBnZXRMb25nKFJlc3VsdFNldCBycywgaW50IGNvbHVt\nbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1\ncm4gcnMuZ2V0TG9uZyhjb2x1bW4pOwogICAgfQoKICAgIC8qKgogICAgICog\nQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3Vs\ndFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBPYmplY3QgZ2V0T2JqZWN0KFJlc3VsdFNldCBycywgaW50\nIGNvbHVtbiwgTWFwIG1hcCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAobWFwID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBycy5nZXRPYmplY3QoY29sdW1uKTsKICAgICAgICByZXR1cm4gcnMuZ2V0\nT2JqZWN0KGNvbHVtbiwgbWFwKTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\nbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRT\nZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAg\nICBwdWJsaWMgUmVmIGdldFJlZihSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4s\nIE1hcCBtYXApCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIHJzLmdldFJlZihjb2x1bW4pOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FM\nIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyBzaG9ydCBnZXRTaG9ydChSZXN1bHRTZXQgcnMs\nIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgcmV0dXJuIHJzLmdldFNob3J0KGNvbHVtbik7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRo\nZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlw\nZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTdHJpbmcoUmVzdWx0\nU2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHJldHVybiBycy5nZXRTdHJpbmcoY29sdW1uKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1\nbW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICog\namF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgVGltZSBnZXRUaW1lKFJl\nc3VsdFNldCBycywgaW50IGNvbHVtbiwgQ2FsZW5kYXIgY2FsKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChjYWwgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIHJzLmdldFRpbWUoY29sdW1uKTsKICAg\nICAgICByZXR1cm4gcnMuZ2V0VGltZShjb2x1bW4sIGNhbCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9m\nIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEg\ndHlwZS4KICAgICAqLwogICAgcHVibGljIFRpbWVzdGFtcCBnZXRUaW1lc3Rh\nbXAoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uLCBDYWxlbmRhciBjYWwpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGNhbCA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gcnMuZ2V0VGltZXN0YW1wKGNv\nbHVtbik7CiAgICAgICAgcmV0dXJuIHJzLmdldFRpbWVzdGFtcChjb2x1bW4s\nIGNhbCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vCiAgICAvLyBQcmVwYXJlZFN0YXRlbWVudCB3cmFwcGVycwogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBT\nZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0\nZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEFycmF5KFByZXBh\ncmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBBcnJheSB2YWwsCiAgICAg\nICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBzdG1udC5zZXRBcnJheShpZHgsIHZhbCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVy\nIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndEFzY2lpU3RyZWFtKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4\nLAogICAgICAgIElucHV0U3RyZWFtIHZhbCwgaW50IGxlbmd0aCwgQ29sdW1u\nIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBz\ndG1udC5zZXRBc2NpaVN0cmVhbShpZHgsIHZhbCwgbGVuZ3RoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJh\nbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0QmlnRGVjaW1hbChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50\nIGlkeCwgQmlnRGVjaW1hbCB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoKGNvbCAh\nPSBudWxsICYmIGNvbC5pc0NvbXBhdGlibGUoVHlwZXMuVkFSQ0hBUiwgbnVs\nbCwgMCwgMCkpCiAgICAgICAgICAgIHx8IChjb2wgPT0gbnVsbCAmJiBzdG9y\nZUxhcmdlTnVtYmVyc0FzU3RyaW5ncykpCiAgICAgICAgICAgIHNldFN0cmlu\nZyhzdG1udCwgaWR4LCB2YWwudG9TdHJpbmcoKSwgY29sKTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIHN0bW50LnNldEJpZ0RlY2ltYWwoaWR4LCB2YWwp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBh\ncyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRCaWdJbnRlZ2VyKFByZXBhcmVkU3RhdGVtZW50IHN0\nbW50LCBpbnQgaWR4LCBCaWdJbnRlZ2VyIHZhbCwKICAgICAgICBDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nICgoY29sICE9IG51bGwgJiYgY29sLmlzQ29tcGF0aWJsZShUeXBlcy5WQVJD\nSEFSLCBudWxsLCAwLCAwKSkKICAgICAgICAgICAgfHwgKGNvbCA9PSBudWxs\nICYmIHN0b3JlTGFyZ2VOdW1iZXJzQXNTdHJpbmdzKSkKICAgICAgICAgICAg\nc2V0U3RyaW5nKHN0bW50LCBpZHgsIHZhbC50b1N0cmluZygpLCBjb2wpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgc2V0QmlnRGVjaW1hbChzdG1udCwg\naWR4LCBuZXcgQmlnRGVjaW1hbCh2YWwpLCBjb2wpOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0\nbyB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRC\naW5hcnlTdHJlYW0oUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgs\nCiAgICAgICAgSW5wdXRTdHJlYW0gdmFsLCBpbnQgbGVuZ3RoLCBDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0\nbW50LnNldEJpbmFyeVN0cmVhbShpZHgsIHZhbCwgbGVuZ3RoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJh\nbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0QmxvYihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwg\nQmxvYiB2YWwsIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgc3RtbnQuc2V0QmxvYihpZHgsIHZhbCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFy\nYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuIFVzZXMgdGhlCiAgICAgKiB7QGxp\nbmsgI3NlcmlhbGl6ZX0gbWV0aG9kIHRvIHNlcmlhbGl6ZSB0aGUgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEJsb2JPYmplY3QoUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIE9iamVjdCB2YWwsCiAgICAg\nICAgQ29sdW1uIGNvbCwgSkRCQ1N0b3JlIHN0b3JlKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldEJ5dGVzKHN0bW50LCBpZHgs\nIHNlcmlhbGl6ZSh2YWwsIHN0b3JlKSwgY29sKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8g\ndGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Qm9v\nbGVhbihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgYm9vbGVh\nbiB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBzdG1udC5zZXRJbnQoaWR4LCAodmFsKSA/\nIDEgOiAwKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4g\ndmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0Qnl0ZShQcmVwYXJlZFN0YXRlbWVudCBz\ndG1udCwgaW50IGlkeCwgYnl0ZSB2YWwsIENvbHVtbiBjb2wpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0Qnl0ZShp\nZHgsIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVu\nIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEJ5dGVzKFByZXBhcmVkU3RhdGVtZW50\nIHN0bW50LCBpbnQgaWR4LCBieXRlW10gdmFsLAogICAgICAgIENvbHVtbiBj\nb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKHVzZVNldEJ5dGVzRm9yQmxvYnMpCiAgICAgICAgICAgIHN0bW50LnNldEJ5\ndGVzKGlkeCwgdmFsKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNldEJp\nbmFyeVN0cmVhbShzdG1udCwgaWR4LCBuZXcgQnl0ZUFycmF5SW5wdXRTdHJl\nYW0odmFsKSwKICAgICAgICAgICAgICAgIHZhbC5sZW5ndGgsIGNvbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEg\ncGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldENoYXIoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBp\nZHgsIGNoYXIgdmFsLCBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmICgoY29sICE9IG51bGwgJiYgY29sLmlz\nQ29tcGF0aWJsZShUeXBlcy5JTlRFR0VSLCBudWxsLCAwLCAwKSkKICAgICAg\nICAgICAgfHwgKGNvbCA9PSBudWxsICYmIHN0b3JlQ2hhcnNBc051bWJlcnMp\nKQogICAgICAgICAgICBzZXRJbnQoc3RtbnQsIGlkeCwgKGludCkgdmFsLCBj\nb2wpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc2V0U3RyaW5nKHN0bW50\nLCBpZHgsIFN0cmluZy52YWx1ZU9mKHZhbCksIGNvbCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVy\nIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndENoYXJhY3RlclN0cmVhbShQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50\nIGlkeCwKICAgICAgICBSZWFkZXIgdmFsLCBpbnQgbGVuZ3RoLCBDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0\nbW50LnNldENoYXJhY3RlclN0cmVhbShpZHgsIHZhbCwgbGVuZ3RoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBw\nYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0Q2xvYihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlk\neCwgQ2xvYiB2YWwsIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0Q2xvYihpZHgsIHZhbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEg\ncGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldENsb2JTdHJpbmcoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQs\nIGludCBpZHgsIFN0cmluZyB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodXNlU2V0\nU3RyaW5nRm9yQ2xvYnMpCiAgICAgICAgICAgIHN0bW50LnNldFN0cmluZyhp\nZHgsIHZhbCk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIHNldCBy\nZWFkZXIgZnJvbSBzdHJpbmcKICAgICAgICAgICAgU3RyaW5nUmVhZGVyIGlu\nID0gbmV3IFN0cmluZ1JlYWRlcih2YWwpOwogICAgICAgICAgICBzZXRDaGFy\nYWN0ZXJTdHJlYW0oc3RtbnQsIGlkeCwgaW4sIHZhbC5sZW5ndGgoKSwgY29s\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdp\ndmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERhdGUoUHJlcGFyZWRTdGF0ZW1l\nbnQgc3RtbnQsIGludCBpZHgsIERhdGUgdmFsLCBDb2x1bW4gY29sKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChjb2wgIT0g\nbnVsbCAmJiBjb2wuZ2V0VHlwZSgpID09IFR5cGVzLkRBVEUpCiAgICAgICAg\nICAgIHNldERhdGUoc3RtbnQsIGlkeCwgbmV3IGphdmEuc3FsLkRhdGUodmFs\nLmdldFRpbWUoKSksIG51bGwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAoY29s\nICE9IG51bGwgJiYgY29sLmdldFR5cGUoKSA9PSBUeXBlcy5USU1FKQogICAg\nICAgICAgICBzZXRUaW1lKHN0bW50LCBpZHgsIG5ldyBUaW1lKHZhbC5nZXRU\naW1lKCkpLCBudWxsLCBjb2wpOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nc2V0VGltZXN0YW1wKHN0bW50LCBpZHgsIG5ldyBUaW1lc3RhbXAodmFsLmdl\ndFRpbWUoKSksIG51bGwsIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0\nZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERhdGUoUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIGphdmEuc3FsLkRhdGUgdmFs\nLAogICAgICAgIENhbGVuZGFyIGNhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY2FsID09IG51bGwp\nCiAgICAgICAgICAgIHN0bW50LnNldERhdGUoaWR4LCB2YWwpOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgc3RtbnQuc2V0RGF0ZShpZHgsIHZhbCwgY2Fs\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUg\nYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0Q2FsZW5kYXIoUHJlcGFyZWRTdGF0ZW1lbnQgc3Rt\nbnQsIGludCBpZHgsIENhbGVuZGFyIHZhbCwKICAgICAgICBDb2x1bW4gY29s\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIGJ5\nIGRlZmF1bHQgd2UgbWVyZWx5IGRlbGVnYXRlIHRoZSB0aGUgRGF0ZSBwYXJh\nbWV0ZXIKICAgICAgICBzZXREYXRlKHN0bW50LCBpZHgsIHZhbC5nZXRUaW1l\nKCksIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVu\nIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldERvdWJsZShQcmVwYXJlZFN0YXRlbWVu\ndCBzdG1udCwgaW50IGlkeCwgZG91YmxlIHZhbCwKICAgICAgICBDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0\nbW50LnNldERvdWJsZShpZHgsIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBz\ndGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEZsb2F0KFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBmbG9hdCB2YWwsCiAg\nICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzdG1udC5zZXRGbG9hdChpZHgsIHZhbCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1l\ndGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldEludChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgaW50\nIHZhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzdG1udC5zZXRJbnQoaWR4LCB2YWwpOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRl\nciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRMb25nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBsb25n\nIHZhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzdG1udC5zZXRMb25nKGlkeCwgdmFsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0\nZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0TG9jYWxlKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBM\nb2NhbGUgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0U3RyaW5nKHN0bW50LCBpZHgs\nIHZhbC5nZXRMYW5ndWFnZSgpICsgIl8iICsgdmFsLmdldENvdW50cnkoKQog\nICAgICAgICAgICArICJfIiArIHZhbC5nZXRWYXJpYW50KCksIGNvbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEg\ncGFyYW1ldGVycyB0byB0aGUgc3RhdGVtZW50LiBUaGUgY29sdW1uCiAgICAg\nKiB0eXBlIHdpbGwgY29tZSBmcm9tIHtAbGluayBUeXBlc30uCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldE51bGwoUHJlcGFyZWRTdGF0ZW1lbnQgc3Rt\nbnQsIGludCBpZHgsIGludCBjb2xUeXBlLAogICAgICAgIENvbHVtbiBjb2wp\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQu\nc2V0TnVsbChpZHgsIGNvbFR5cGUpOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3Rh\ndGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXROdW1iZXIoUHJl\ncGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIE51bWJlciBudW0sCiAg\nICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAvLyBjaGVjayBmb3Iga25vd24gZmxvYXRpbmcgcG9pbnQg\ndHlwZXMgdG8gZ2l2ZSBkcml2ZXIgYSBjaGFuY2UgdG8KICAgICAgICAvLyBo\nYW5kbGUgc3BlY2lhbCBudW1iZXJzIGxpa2UgTmFOIGFuZCBpbmZpbml0eTsg\nYnVnICMxMDUzCiAgICAgICAgaWYgKG51bSBpbnN0YW5jZW9mIERvdWJsZSkK\nICAgICAgICAgICAgc2V0RG91YmxlKHN0bW50LCBpZHgsICgoRG91YmxlKSBu\ndW0pLmRvdWJsZVZhbHVlKCksIGNvbCk7CiAgICAgICAgZWxzZSBpZiAobnVt\nIGluc3RhbmNlb2YgRmxvYXQpCiAgICAgICAgICAgIHNldEZsb2F0KHN0bW50\nLCBpZHgsICgoRmxvYXQpIG51bSkuZmxvYXRWYWx1ZSgpLCBjb2wpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgc2V0QmlnRGVjaW1hbChzdG1udCwgaWR4\nLCBuZXcgQmlnRGVjaW1hbChudW0udG9TdHJpbmcoKSksIGNvbCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFy\nYW1ldGVycyB0byB0aGUgc3RhdGVtZW50LiBUaGUgY29sdW1uCiAgICAgKiB0\neXBlIHdpbGwgY29tZSBmcm9tIHtAbGluayBUeXBlc30uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldE9iamVjdChQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndCwgaW50IGlkeCwgT2JqZWN0IHZhbCwKICAgICAgICBpbnQgY29sVHlwZSwg\nQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoY29sVHlwZSA9PSAtMSB8fCBjb2xUeXBlID09IFR5cGVzLk9U\nSEVSKQogICAgICAgICAgICBzdG1udC5zZXRPYmplY3QoaWR4LCB2YWwpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgc3RtbnQuc2V0T2JqZWN0KGlkeCwg\ndmFsLCBjb2xUeXBlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUg\nZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVmKFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50LCBpbnQgaWR4LCBSZWYgdmFsLCBDb2x1bW4gY29sKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0bW50LnNldFJl\nZihpZHgsIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdp\ndmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNob3J0KFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50LCBpbnQgaWR4LCBzaG9ydCB2YWwsCiAgICAgICAgQ29sdW1u\nIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBz\ndG1udC5zZXRTaG9ydChpZHgsIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBz\ndGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFN0cmluZyhQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgU3RyaW5nIHZhbCwK\nICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHN0bW50LnNldFN0cmluZyhpZHgsIHZhbCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFy\nYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFRpbWUoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgs\nIFRpbWUgdmFsLAogICAgICAgIENhbGVuZGFyIGNhbCwgQ29sdW1uIGNvbCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY2Fs\nID09IG51bGwpCiAgICAgICAgICAgIHN0bW50LnNldFRpbWUoaWR4LCB2YWwp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc3RtbnQuc2V0VGltZShpZHgs\nIHZhbCwgY2FsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2\nZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKFByZXBhcmVkU3Rh\ndGVtZW50IHN0bW50LCBpbnQgaWR4LAogICAgICAgIFRpbWVzdGFtcCB2YWws\nIENhbGVuZGFyIGNhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBlbnN1cmUgdGhhdCB3ZSBkbyBub3Qg\naW5zZXJ0IGRhdGVzIGF0IGEgZ3JlYXRlciBwcmVjaXNpb24gdGhhbgogICAg\nICAgIC8vIHRoYXQgYXQgd2hpY2ggdGhleSB3aWxsIGJlIHJldHVybmVkIGJ5\nIGEgU0VMRUNUCiAgICAgICAgaW50IHJvdW5kZWQgPSAoaW50KSBNYXRoLnJv\ndW5kKHZhbC5nZXROYW5vcygpIC8KICAgICAgICAgICAgKGRvdWJsZSkgZGF0\nZVByZWNpc2lvbik7CiAgICAgICAgaW50IG5hbm9zID0gcm91bmRlZCAqIGRh\ndGVQcmVjaXNpb247CiAgICAgICAgaWYgKG5hbm9zID4gOTk5OTk5OTk5KSB7\nCiAgICAgICAgICAgIC8vIHJvbGxvdmVyIHRvIG5leHQgc2Vjb25kCiAgICAg\nICAgICAgIHZhbC5zZXRUaW1lKHZhbC5nZXRUaW1lKCkgKyAxMDAwKTsKICAg\nICAgICAgICAgbmFub3MgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN1\ncHBvcnRzVGltZXN0YW1wTmFub3MpCiAgICAgICAgICAgIHZhbC5zZXROYW5v\ncyhuYW5vcyk7CiAgICAgICAgZWxzZQogICAgICAgICAgICB2YWwuc2V0TmFu\nb3MoMCk7CgogICAgICAgIGlmIChjYWwgPT0gbnVsbCkKICAgICAgICAgICAg\nc3RtbnQuc2V0VGltZXN0YW1wKGlkeCwgdmFsKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIHN0bW50LnNldFRpbWVzdGFtcChpZHgsIHZhbCwgY2FsKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhIGNvbHVtbiB2YWx1ZSBpbnRv\nIGEgcHJlcGFyZWQgc3RhdGVtZW50LgogICAgICoKICAgICAqIEBwYXJhbSBz\ndG1udCB0aGUgcHJlcGFyZWQgc3RhdGVtZW50IHRvIHBhcmFtZXRlcml6ZQog\nICAgICogQHBhcmFtIGlkeCB0aGUgaW5kZXggb2YgdGhlIHBhcmFtZXRlciBp\nbiB0aGUgcHJlcGFyZWQgc3RhdGVtZW50CiAgICAgKiBAcGFyYW0gdmFsIHRo\nZSB2YWx1ZSBvZiB0aGUgY29sdW1uCiAgICAgKiBAcGFyYW0gY29sIHRoZSBj\nb2x1bW4gYmVpbmcgc2V0CiAgICAgKiBAcGFyYW0gdHlwZSB0aGUgZmllbGQg\nbWFwcGluZyB0eXBlIGNvZGUgZm9yIHRoZSB2YWx1ZQogICAgICogQHBhcmFt\nIHN0b3JlIHRoZSBzdG9yZSBtYW5hZ2VyIGZvciB0aGUgY3VycmVudCBjb250\nZXh0CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFR5cGVkKFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBPYmplY3QgdmFsLAogICAgICAg\nIENvbHVtbiBjb2wsIGludCB0eXBlLCBKREJDU3RvcmUgc3RvcmUpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHZhbCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIHNldE51bGwoc3RtbnQsIGlkeCwgKGNvbCA9\nPSBudWxsKSA/IFR5cGVzLk9USEVSIDogY29sLmdldFR5cGUoKSwKICAgICAg\nICAgICAgICAgIGNvbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nCgogICAgICAgIFNpemVkIHM7CiAgICAgICAgQ2FsZW5kYXJkIGM7CiAgICAg\nICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkJPT0xFQU46CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJPT0xFQU5f\nT0JKOgogICAgICAgICAgICAgICAgc2V0Qm9vbGVhbihzdG1udCwgaWR4LCAo\nKEJvb2xlYW4pIHZhbCkuYm9vbGVhblZhbHVlKCksIGNvbCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllU\nRToKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURV9PQko6CiAgICAg\nICAgICAgICAgICBzZXRCeXRlKHN0bW50LCBpZHgsICgoTnVtYmVyKSB2YWwp\nLmJ5dGVWYWx1ZSgpLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkNIQVJfT0JKOgogICAgICAgICAgICAgICAgc2V0Q2hh\ncihzdG1udCwgaWR4LCAoKENoYXJhY3RlcikgdmFsKS5jaGFyVmFsdWUoKSwg\nY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5ET1VCTEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkRPVUJMRV9PQko6CiAgICAgICAgICAgICAgICBzZXREb3VibGUoc3RtbnQs\nIGlkeCwgKChOdW1iZXIpIHZhbCkuZG91YmxlVmFsdWUoKSwgY29sKTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5GTE9BVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVRfT0JK\nOgogICAgICAgICAgICAgICAgc2V0RmxvYXQoc3RtbnQsIGlkeCwgKChOdW1i\nZXIpIHZhbCkuZmxvYXRWYWx1ZSgpLCBjb2wpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVDoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UX09CSjoKICAgICAgICAgICAgICAg\nIHNldEludChzdG1udCwgaWR4LCAoKE51bWJlcikgdmFsKS5pbnRWYWx1ZSgp\nLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkxPTkdfT0JKOgogICAgICAgICAgICAgICAgc2V0TG9uZyhzdG1udCwgaWR4\nLCAoKE51bWJlcikgdmFsKS5sb25nVmFsdWUoKSwgY29sKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9S\nVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAg\nICAgICAgICAgICAgc2V0U2hvcnQoc3RtbnQsIGlkeCwgKChOdW1iZXIpIHZh\nbCkuc2hvcnRWYWx1ZSgpLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoKICAgICAgICAg\nICAgICAgIGlmIChjb2wgIT0gbnVsbCAmJiAoY29sLmdldFR5cGUoKSA9PSBU\neXBlcy5DTE9CCiAgICAgICAgICAgICAgICAgICAgfHwgY29sLmdldFR5cGUo\nKSA9PSBUeXBlcy5MT05HVkFSQ0hBUikpCiAgICAgICAgICAgICAgICAgICAg\nc2V0Q2xvYlN0cmluZyhzdG1udCwgaWR4LCAoU3RyaW5nKSB2YWwsIGNvbCk7\nCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgc2V0\nU3RyaW5nKHN0bW50LCBpZHgsIChTdHJpbmcpIHZhbCwgY29sKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5P\nQkpFQ1Q6CiAgICAgICAgICAgICAgICBzZXRCbG9iT2JqZWN0KHN0bW50LCBp\nZHgsIHZhbCwgY29sLCBzdG9yZSk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuREFURToKICAgICAgICAgICAg\nICAgIHNldERhdGUoc3RtbnQsIGlkeCwgKERhdGUpIHZhbCwgY29sKTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5DQUxFTkRBUjoKICAgICAgICAgICAgICAgIHNldENhbGVuZGFyKHN0bW50\nLCBpZHgsIChDYWxlbmRhcikgdmFsLCBjb2wpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0RFQ0lNQUw6\nCiAgICAgICAgICAgICAgICBzZXRCaWdEZWNpbWFsKHN0bW50LCBpZHgsIChC\naWdEZWNpbWFsKSB2YWwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklHSU5URUdFUjoKICAgICAg\nICAgICAgICAgIHNldEJpZ0ludGVnZXIoc3RtbnQsIGlkeCwgKEJpZ0ludGVn\nZXIpIHZhbCwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5OVU1CRVI6CiAgICAgICAgICAgICAgICBz\nZXROdW1iZXIoc3RtbnQsIGlkeCwgKE51bWJlcikgdmFsLCBjb2wpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkxPQ0FMRToKICAgICAgICAgICAgICAgIHNldExvY2FsZShzdG1udCwgaWR4\nLCAoTG9jYWxlKSB2YWwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuU1FMX0FSUkFZOgogICAg\nICAgICAgICAgICAgc2V0QXJyYXkoc3RtbnQsIGlkeCwgKEFycmF5KSB2YWws\nIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKYXZhU1FMVHlwZXMuQVNDSUlfU1RSRUFNOgogICAgICAgICAgICAgICAg\ncyA9IChTaXplZCkgdmFsOwogICAgICAgICAgICAgICAgc2V0QXNjaWlTdHJl\nYW0oc3RtbnQsIGlkeCwgKElucHV0U3RyZWFtKSBzLnZhbHVlLCBzLnNpemUs\nIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKYXZhU1FMVHlwZXMuQklOQVJZX1NUUkVBTToKICAgICAgICAgICAgICAg\nIHMgPSAoU2l6ZWQpIHZhbDsKICAgICAgICAgICAgICAgIHNldEJpbmFyeVN0\ncmVhbShzdG1udCwgaWR4LCAoSW5wdXRTdHJlYW0pIHMudmFsdWUsIHMuc2l6\nZSwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEphdmFTUUxUeXBlcy5CTE9COgogICAgICAgICAgICAgICAgc2V0Qmxv\nYihzdG1udCwgaWR4LCAoQmxvYikgdmFsLCBjb2wpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLkJZVEVT\nOgogICAgICAgICAgICAgICAgc2V0Qnl0ZXMoc3RtbnQsIGlkeCwgKGJ5dGVb\nXSkgdmFsLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVNRTFR5cGVzLkNIQVJfU1RSRUFNOgogICAgICAgICAg\nICAgICAgcyA9IChTaXplZCkgdmFsOwogICAgICAgICAgICAgICAgc2V0Q2hh\ncmFjdGVyU3RyZWFtKHN0bW50LCBpZHgsIChSZWFkZXIpIHMudmFsdWUsIHMu\nc2l6ZSwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEphdmFTUUxUeXBlcy5DTE9COgogICAgICAgICAgICAgICAgc2V0\nQ2xvYihzdG1udCwgaWR4LCAoQ2xvYikgdmFsLCBjb2wpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLlNR\nTF9EQVRFOgogICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIENh\nbGVuZGFyZCkgewogICAgICAgICAgICAgICAgICAgIGMgPSAoQ2FsZW5kYXJk\nKSB2YWw7CiAgICAgICAgICAgICAgICAgICAgc2V0RGF0ZShzdG1udCwgaWR4\nLCAoamF2YS5zcWwuRGF0ZSkgYy52YWx1ZSwgYy5jYWxlbmRhciwKICAgICAg\nICAgICAgICAgICAgICAgICAgY29sKTsKICAgICAgICAgICAgICAgIH0gZWxz\nZQogICAgICAgICAgICAgICAgICAgIHNldERhdGUoc3RtbnQsIGlkeCwgKGph\ndmEuc3FsLkRhdGUpIHZhbCwgbnVsbCwgY29sKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5SRUY6CiAg\nICAgICAgICAgICAgICBzZXRSZWYoc3RtbnQsIGlkeCwgKFJlZikgdmFsLCBj\nb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVNRTFR5cGVzLlRJTUU6CiAgICAgICAgICAgICAgICBpZiAodmFsIGlu\nc3RhbmNlb2YgQ2FsZW5kYXJkKSB7CiAgICAgICAgICAgICAgICAgICAgYyA9\nIChDYWxlbmRhcmQpIHZhbDsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1l\nKHN0bW50LCBpZHgsIChUaW1lKSBjLnZhbHVlLCBjLmNhbGVuZGFyLCBjb2wp\nOwogICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAg\nc2V0VGltZShzdG1udCwgaWR4LCAoVGltZSkgdmFsLCBudWxsLCBjb2wpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNR\nTFR5cGVzLlRJTUVTVEFNUDoKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5z\ndGFuY2VvZiBDYWxlbmRhcmQpIHsKICAgICAgICAgICAgICAgICAgICBjID0g\nKENhbGVuZGFyZCkgdmFsOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVz\ndGFtcChzdG1udCwgaWR4LCAoVGltZXN0YW1wKSBjLnZhbHVlLCBjLmNhbGVu\nZGFyLAogICAgICAgICAgICAgICAgICAgICAgICBjb2wpOwogICAgICAgICAg\nICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgc2V0VGltZXN0YW1w\nKHN0bW50LCBpZHgsIChUaW1lc3RhbXApIHZhbCwgbnVsbCwgY29sKTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAg\nICAgICAgICAgICAgaWYgKGNvbCAhPSBudWxsICYmIChjb2wuZ2V0VHlwZSgp\nID09IFR5cGVzLkJMT0IKICAgICAgICAgICAgICAgICAgICB8fCBjb2wuZ2V0\nVHlwZSgpID09IFR5cGVzLlZBUkJJTkFSWSkpCiAgICAgICAgICAgICAgICAg\nICAgc2V0QmxvYk9iamVjdChzdG1udCwgaWR4LCB2YWwsIGNvbCwgc3RvcmUp\nOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHNl\ndE9iamVjdChzdG1udCwgaWR4LCB2YWwsIGNvbC5nZXRUeXBlKCksIGNvbCk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2V0IGEgY29tcGxl\ndGVseSB1bmtub3duIHBhcmFtZXRlciBpbnRvIGEgcHJlcGFyZWQgc3RhdGVt\nZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVbmtub3duKFByZXBh\ncmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBPYmplY3QgdmFsLAogICAg\nICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgU2l6ZWQgc2l6ZWQgPSBudWxsOwogICAgICAgIENhbGVuZGFy\nZCBjYWxkID0gbnVsbDsKICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU2l6\nZWQpIHsKICAgICAgICAgICAgc2l6ZWQgPSAoU2l6ZWQpIHZhbDsKICAgICAg\nICAgICAgdmFsID0gc2l6ZWQudmFsdWU7CiAgICAgICAgfSBlbHNlIGlmICh2\nYWwgaW5zdGFuY2VvZiBDYWxlbmRhcmQpIHsKICAgICAgICAgICAgY2FsZCA9\nIChDYWxlbmRhcmQpIHZhbDsKICAgICAgICAgICAgdmFsID0gY2FsZC52YWx1\nZTsKICAgICAgICB9CgogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAg\nICAgICAgc2V0TnVsbChzdG1udCwgaWR4LCAoY29sID09IG51bGwpID8gVHlw\nZXMuT1RIRVIgOiBjb2wuZ2V0VHlwZSgpLAogICAgICAgICAgICAgICAgY29s\nKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAg\nICAgICAgICAgIHNldFN0cmluZyhzdG1udCwgaWR4LCB2YWwudG9TdHJpbmco\nKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBJbnRl\nZ2VyKQogICAgICAgICAgICBzZXRJbnQoc3RtbnQsIGlkeCwgKChJbnRlZ2Vy\nKSB2YWwpLmludFZhbHVlKCksIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFs\nIGluc3RhbmNlb2YgQm9vbGVhbikKICAgICAgICAgICAgc2V0Qm9vbGVhbihz\ndG1udCwgaWR4LCAoKEJvb2xlYW4pIHZhbCkuYm9vbGVhblZhbHVlKCksIGNv\nbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgTG9uZykKICAg\nICAgICAgICAgc2V0TG9uZyhzdG1udCwgaWR4LCAoKExvbmcpIHZhbCkubG9u\nZ1ZhbHVlKCksIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNl\nb2YgRmxvYXQpCiAgICAgICAgICAgIHNldEZsb2F0KHN0bW50LCBpZHgsICgo\nRmxvYXQpIHZhbCkuZmxvYXRWYWx1ZSgpLCBjb2wpOwogICAgICAgIGVsc2Ug\naWYgKHZhbCBpbnN0YW5jZW9mIERvdWJsZSkKICAgICAgICAgICAgc2V0RG91\nYmxlKHN0bW50LCBpZHgsICgoRG91YmxlKSB2YWwpLmRvdWJsZVZhbHVlKCks\nIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQnl0ZSkK\nICAgICAgICAgICAgc2V0Qnl0ZShzdG1udCwgaWR4LCAoKEJ5dGUpIHZhbCku\nYnl0ZVZhbHVlKCksIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3Rh\nbmNlb2YgQ2hhcmFjdGVyKQogICAgICAgICAgICBzZXRDaGFyKHN0bW50LCBp\nZHgsICgoQ2hhcmFjdGVyKSB2YWwpLmNoYXJWYWx1ZSgpLCBjb2wpOwogICAg\nICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFNob3J0KQogICAgICAgICAg\nICBzZXRTaG9ydChzdG1udCwgaWR4LCAoKFNob3J0KSB2YWwpLnNob3J0VmFs\ndWUoKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBM\nb2NhbGUpCiAgICAgICAgICAgIHNldExvY2FsZShzdG1udCwgaWR4LCAoTG9j\nYWxlKSB2YWwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNl\nb2YgQmlnRGVjaW1hbCkKICAgICAgICAgICAgc2V0QmlnRGVjaW1hbChzdG1u\ndCwgaWR4LCAoQmlnRGVjaW1hbCkgdmFsLCBjb2wpOwogICAgICAgIGVsc2Ug\naWYgKHZhbCBpbnN0YW5jZW9mIEJpZ0ludGVnZXIpCiAgICAgICAgICAgIHNl\ndEJpZ0ludGVnZXIoc3RtbnQsIGlkeCwgKEJpZ0ludGVnZXIpIHZhbCwgY29s\nKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBBcnJheSkKICAg\nICAgICAgICAgc2V0QXJyYXkoc3RtbnQsIGlkeCwgKEFycmF5KSB2YWwsIGNv\nbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQmxvYikKICAg\nICAgICAgICAgc2V0QmxvYihzdG1udCwgaWR4LCAoQmxvYikgdmFsLCBjb2wp\nOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIGJ5dGVbXSkKICAg\nICAgICAgICAgc2V0Qnl0ZXMoc3RtbnQsIGlkeCwgKGJ5dGVbXSkgdmFsLCBj\nb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIENsb2IpCiAg\nICAgICAgICAgIHNldENsb2Ioc3RtbnQsIGlkeCwgKENsb2IpIHZhbCwgY29s\nKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBSZWYpCiAgICAg\nICAgICAgIHNldFJlZihzdG1udCwgaWR4LCAoUmVmKSB2YWwsIGNvbCk7CiAg\nICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgamF2YS5zcWwuRGF0ZSkK\nICAgICAgICAgICAgc2V0RGF0ZShzdG1udCwgaWR4LCAoamF2YS5zcWwuRGF0\nZSkgdmFsLAogICAgICAgICAgICAgICAgKGNhbGQgPT0gbnVsbCkgPyBudWxs\nIDogY2FsZC5jYWxlbmRhciwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwg\naW5zdGFuY2VvZiBUaW1lc3RhbXApCiAgICAgICAgICAgIHNldFRpbWVzdGFt\ncChzdG1udCwgaWR4LCAoVGltZXN0YW1wKSB2YWwsCiAgICAgICAgICAgICAg\nICAoY2FsZCA9PSBudWxsKSA/IG51bGwgOiBjYWxkLmNhbGVuZGFyLCBjb2wp\nOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFRpbWUpCiAgICAg\nICAgICAgIHNldFRpbWUoc3RtbnQsIGlkeCwgKFRpbWUpIHZhbCwKICAgICAg\nICAgICAgICAgIChjYWxkID09IG51bGwpID8gbnVsbCA6IGNhbGQuY2FsZW5k\nYXIsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgRGF0\nZSkKICAgICAgICAgICAgc2V0RGF0ZShzdG1udCwgaWR4LCAoRGF0ZSkgdmFs\nLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIENhbGVu\nZGFyKQogICAgICAgICAgICBzZXREYXRlKHN0bW50LCBpZHgsICgoQ2FsZW5k\nYXIpIHZhbCkuZ2V0VGltZSgpLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZh\nbCBpbnN0YW5jZW9mIFJlYWRlcikKICAgICAgICAgICAgc2V0Q2hhcmFjdGVy\nU3RyZWFtKHN0bW50LCBpZHgsIChSZWFkZXIpIHZhbCwKICAgICAgICAgICAg\nICAgIChzaXplZCA9PSBudWxsKSA/IDAgOiBzaXplZC5zaXplLCBjb2wpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRp\nb24oX2xvYy5nZXQoImJhZC1wYXJhbSIsIHZhbC5nZXRDbGFzcygpKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNlcmlhbGl6ZWQgYnl0\nZXMgZm9yIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBi\neXRlW10gc2VyaWFsaXplKE9iamVjdCB2YWwsIEpEQkNTdG9yZSBzdG9yZSkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodmFs\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlm\nICh2YWwgaW5zdGFuY2VvZiBTZXJpYWxpemVkRGF0YSkKICAgICAgICAgICAg\ncmV0dXJuICgoU2VyaWFsaXplZERhdGEpIHZhbCkuYnl0ZXM7CiAgICAgICAg\ncmV0dXJuIFNlcmlhbGl6YXRpb24uc2VyaWFsaXplKHZhbCwgc3RvcmUuZ2V0\nQ29udGV4dCgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGUg\nSkRLIDEuNCA8Y29kZT5zZXRCeXRlczwvY29kZT4gbWV0aG9kIG9uIHRoZSBn\naXZlbiBCTE9CIG9iamVjdC4KICAgICAqLwogICAgcHVibGljIHZvaWQgcHV0\nQnl0ZXMoT2JqZWN0IGJsb2IsIGJ5dGVbXSBkYXRhKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfc2V0Qnl0ZXMgPT0gbnVs\nbCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX3NldEJ5\ndGVzID0gYmxvYi5nZXRDbGFzcygpLmdldE1ldGhvZCgic2V0Qnl0ZXMiLAog\nICAgICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBsb25nLmNsYXNzLCBi\neXRlW10uY2xhc3MgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRp\nb24oZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaW52b2tl\nUHV0TG9iTWV0aG9kKF9zZXRCeXRlcywgYmxvYiwKICAgICAgICAgICAgbmV3\nIE9iamVjdFtdeyBOdW1iZXJzLnZhbHVlT2YoMUwpLCBkYXRhIH0pOwogICAg\nfQoKICAgIC8qKgogICAgICogSW52b2tlIHRoZSBKREsgMS40IDxjb2RlPnNl\ndFN0cmluZzwvY29kZT4gbWV0aG9kIG9uIHRoZSBnaXZlbiBDTE9CCiAgICAg\nKiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHB1dFN0cmluZyhP\nYmplY3QgY2xvYiwgU3RyaW5nIGRhdGEpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKF9zZXRTdHJpbmcgPT0gbnVsbCkgewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX3NldFN0cmluZyA9\nIGNsb2IuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoInNldFN0cmluZyIsCiAgICAg\nICAgICAgICAgICAgICAgbmV3IENsYXNzW117IGxvbmcuY2xhc3MsIFN0cmlu\nZy5jbGFzcyB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihl\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpbnZva2VQdXRM\nb2JNZXRob2QoX3NldFN0cmluZywgY2xvYiwKICAgICAgICAgICAgbmV3IE9i\namVjdFtdeyBOdW1iZXJzLnZhbHVlT2YoMUwpLCBkYXRhIH0pOwogICAgfQoK\nICAgIC8qKgogICAgICogSW52b2tlIHRoZSBKREsgMS40IDxjb2RlPnNldENo\nYXJhY3RlclN0cmVhbTwvY29kZT4gbWV0aG9kIG9uIHRoZSBnaXZlbgogICAg\nICogQ0xPQiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHB1dENo\nYXJzKE9iamVjdCBjbG9iLCBjaGFyW10gZGF0YSkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX3NldENoYXJTdHJlYW0gPT0g\nbnVsbCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX3Nl\ndENoYXJTdHJlYW0gPSBjbG9iLmdldENsYXNzKCkuZ2V0TWV0aG9kCiAgICAg\nICAgICAgICAgICAgICAgKCJzZXRDaGFyYWN0ZXJTdHJlYW0iLCBuZXcgQ2xh\nc3NbXXsgbG9uZy5jbGFzcyB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4\nY2VwdGlvbihlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nV3JpdGVyIHdyaXRlciA9IChXcml0ZXIpIGludm9rZVB1dExvYk1ldGhvZChf\nc2V0Q2hhclN0cmVhbSwgY2xvYiwKICAgICAgICAgICAgbmV3IE9iamVjdFtd\neyBOdW1iZXJzLnZhbHVlT2YoMUwpIH0pOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHdyaXRlci53cml0ZShkYXRhKTsKICAgICAgICAgICAgd3JpdGVy\nLmZsdXNoKCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBTUUxFeGNlcHRpb24oaW9lLnRvU3Ry\naW5nKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEludm9r\nZSB0aGUgZ2l2ZW4gTE9CIG1ldGhvZCBvbiB0aGUgZ2l2ZW4gdGFyZ2V0IHdp\ndGggdGhlIGdpdmVuIGRhdGEuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIE9iamVjdCBpbnZva2VQdXRMb2JNZXRob2QoTWV0aG9kIG1ldGhvZCwgT2Jq\nZWN0IHRhcmdldCwKICAgICAgICBPYmplY3RbXSBhcmdzKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHJldHVybiBtZXRob2QuaW52b2tlKHRhcmdldCwgYXJncyk7CiAgICAgICAg\nfSBjYXRjaCAoSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbiBpdGUpIHsKICAg\nICAgICAgICAgVGhyb3dhYmxlIHQgPSBpdGUuZ2V0VGFyZ2V0RXhjZXB0aW9u\nKCk7CiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgU1FMRXhjZXB0aW9u\nKQogICAgICAgICAgICAgICAgdGhyb3coU1FMRXhjZXB0aW9uKSB0OwogICAg\nICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24odCk7CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3\nIFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFdhcm4gdGhhdCBhIHBhcnRpY3VsYXIgdmFsdWUgY291bGQgbm90\nIGJlIHN0b3JlZCBwcmVjaXNlbHkuCiAgICAgKiBBZnRlciB0aGUgZmlyc3Qg\nd2FybmluZyBmb3IgYSBwYXJ0aWN1bGFyIHR5cGUsIG1lc3NhZ2VzCiAgICAg\nKiB3aWxsIGJlIHR1cm5lZCBpbnRvIHRyYWNlIG1lc3NhZ2VzLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzdG9yYWdlV2FybmluZyhPYmplY3Qgb3Jp\nZywgT2JqZWN0IGNvbnZlcnRlZCkgewogICAgICAgIGJvb2xlYW4gd2FybjsK\nICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAgaWYg\nKF9wcmVjaXNpb25XYXJuZWRUeXBlcyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgX3ByZWNpc2lvbldhcm5lZFR5cGVzID0gbmV3IEhhc2hTZXQoKTsKICAg\nICAgICAgICAgd2FybiA9IF9wcmVjaXNpb25XYXJuZWRUeXBlcy5hZGQob3Jp\nZy5nZXRDbGFzcygpKTsKICAgICAgICB9CgogICAgICAgIGlmIChzdG9yYWdl\nTGltaXRhdGlvbnNGYXRhbCB8fCAod2FybiAmJiBsb2cuaXNXYXJuRW5hYmxl\nZCgpKQogICAgICAgICAgICB8fCAoIXdhcm4gJiYgbG9nLmlzVHJhY2VFbmFi\nbGVkKCkpKSB7CiAgICAgICAgICAgIE1lc3NhZ2UgbXNnID0gX2xvYy5nZXQo\nInN0b3JhZ2UtcmVzdHJpY3Rpb24iLCBuZXcgT2JqZWN0W117CiAgICAgICAg\nICAgICAgICBwbGF0Zm9ybSwKICAgICAgICAgICAgICAgIG9yaWcsCiAgICAg\nICAgICAgICAgICBvcmlnLmdldENsYXNzKCkuZ2V0TmFtZSgpLAogICAgICAg\nICAgICAgICAgY29udmVydGVkLAogICAgICAgICAgICB9KTsKCiAgICAgICAg\nICAgIGlmIChzdG9yYWdlTGltaXRhdGlvbnNGYXRhbCkKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihtc2cpOwoKICAgICAgICAg\nICAgaWYgKHdhcm4pCiAgICAgICAgICAgICAgICBsb2cud2Fybihtc2cpOwog\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsb2cudHJhY2UobXNn\nKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vLy8vLy8vCiAgICAvLyBUeXBl\ncwogICAgLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHBy\nZWZlcnJlZCB7QGxpbmsgVHlwZXN9IGNvbnN0YW50IGZvciB0aGUgZ2l2ZW4K\nICAgICAqIHtAbGluayBKYXZhVHlwZXN9IG9yIHtAbGluayBKYXZhU1FMVHlw\nZXN9IGNvbnN0YW50LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldEpEQkNU\neXBlKGludCBtZXRhVHlwZUNvZGUsIGJvb2xlYW4gbG9iKSB7CiAgICAgICAg\naWYgKGxvYikgewogICAgICAgICAgICBzd2l0Y2ggKG1ldGFUeXBlQ29kZSkg\newogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOgogICAg\nICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQVNDSUlfU1RSRUFNOgog\nICAgICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQ0hBUl9TVFJFQU06\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUo\nVHlwZXMuQ0xPQik7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkJM\nT0IpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2gg\nKG1ldGFUeXBlQ29kZSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5C\nT09MRUFOOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09MRUFOX09C\nSjoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5\ncGVzLkJJVCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAg\nICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuVElOWUlOVCk7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkNIQVJfT0JKOgogICAgICAgICAgICAgICAgaWYg\nKHN0b3JlQ2hhcnNBc051bWJlcnMpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuSU5URUdFUik7CiAgICAgICAg\nICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5DSEFSKTsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxFOgogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAgICAgICAgICAgICAg\ncmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuRE9VQkxFKTsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkZMT0FUX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBn\nZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlJFQUwpOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklO\nVF9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlw\nZShUeXBlcy5JTlRFR0VSKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nTE9ORzoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9OR19PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5C\nSUdJTlQpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVDoKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAg\nICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuU01BTExJTlQp\nOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TVFJJTkc6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkxPQ0FMRToKICAgICAgICAgICAgY2FzZSBK\nYXZhU1FMVHlwZXMuQVNDSUlfU1RSRUFNOgogICAgICAgICAgICBjYXNlIEph\ndmFTUUxUeXBlcy5DSEFSX1NUUkVBTToKICAgICAgICAgICAgICAgIHJldHVy\nbiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlZBUkNIQVIpOwogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5CSUdJTlRFR0VSOgogICAgICAgICAgICAgICAg\naWYgKHN0b3JlTGFyZ2VOdW1iZXJzQXNTdHJpbmdzKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlZBUkNIQVIp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlw\nZXMuQklHSU5UKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklHREVD\nSU1BTDoKICAgICAgICAgICAgICAgIGlmIChzdG9yZUxhcmdlTnVtYmVyc0Fz\nU3RyaW5ncykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVy\ncmVkVHlwZShUeXBlcy5WQVJDSEFSKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkRPVUJMRSk7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLk5VTUJFUjoKICAgICAgICAgICAgICAgIGlmIChz\ndG9yZUxhcmdlTnVtYmVyc0FzU3RyaW5ncykKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5WQVJDSEFSKTsKICAg\nICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLk5V\nTUVSSUMpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DQUxFTkRBUjoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuREFURToKICAgICAgICAgICAg\nICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlRJTUVTVEFNUCk7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLlNRTF9BUlJBWToKICAg\nICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkFS\nUkFZKTsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQklOQVJZX1NU\nUkVBTToKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQkxPQjoKICAg\nICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQllURVM6CiAgICAgICAgICAg\nICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5CTE9CKTsKICAg\nICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQ0xPQjoKICAgICAgICAgICAg\nICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkNMT0IpOwogICAg\nICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5TUUxfREFURToKICAgICAgICAg\nICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkRBVEUpOwog\nICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5USU1FOgogICAgICAgICAg\nICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuVElNRSk7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLlRJTUVTVEFNUDoKICAgICAg\nICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlRJTUVT\nVEFNUCk7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5CTE9CKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHByZWZlcnJlZCB7\nQGxpbmsgVHlwZXN9IHR5cGUgZm9yIHRoZSBnaXZlbiBvbmUuIFJldHVybnMK\nICAgICAqIHRoZSBnaXZlbiB0eXBlIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAg\nIHB1YmxpYyBpbnQgZ2V0UHJlZmVycmVkVHlwZShpbnQgdHlwZSkgewogICAg\nICAgIHJldHVybiB0eXBlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBwcmVmZXJyZWQgZGF0YWJhc2UgdHlwZSBuYW1lIGZvciB0aGUgZ2l2\nZW4gY29sdW1uJ3MgdHlwZQogICAgICogZnJvbSB7QGxpbmsgVHlwZXN9Lgog\nICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFR5cGVOYW1lKENvbHVtbiBj\nb2wpIHsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoY29sLmdl\ndFR5cGVOYW1lKCkpKQogICAgICAgICAgICByZXR1cm4gYXBwZW5kU2l6ZShj\nb2wsIGNvbC5nZXRUeXBlTmFtZSgpKTsKCiAgICAgICAgaWYgKGNvbC5pc0F1\ndG9Bc3NpZ25lZCgpICYmIGF1dG9Bc3NpZ25UeXBlTmFtZSAhPSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gYXBwZW5kU2l6ZShjb2wsIGF1dG9Bc3NpZ25U\neXBlTmFtZSk7CgogICAgICAgIHJldHVybiBhcHBlbmRTaXplKGNvbCwgZ2V0\nVHlwZU5hbWUoY29sLmdldFR5cGUoKSkpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyB0aGUgdHlwZSBuYW1lIGZvciB0aGUgc3BlY2lmaWMgY29u\nc3RhbnQgYXMgZGVmaW5lZAogICAgICogYnkge0BsaW5rIGphdmEuc3FsLlR5\ncGVzfS4KICAgICAqCiAgICAgKiBAcGFyYW0gdHlwZSB0aGUgdHlwZQogICAg\nICogQHJldHVybiB0aGUgbmFtZSBmb3IgdGhlIHR5cGUKICAgICAqLwogICAg\ncHVibGljIFN0cmluZyBnZXRUeXBlTmFtZShpbnQgdHlwZSkgewogICAgICAg\nIHN3aXRjaCAodHlwZSkgewogICAgICAgICAgICBjYXNlIFR5cGVzLkFSUkFZ\nOgogICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5VHlwZU5hbWU7CiAgICAg\nICAgICAgIGNhc2UgVHlwZXMuQklHSU5UOgogICAgICAgICAgICAgICAgcmV0\ndXJuIGJpZ2ludFR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLkJJ\nTkFSWToKICAgICAgICAgICAgICAgIHJldHVybiBiaW5hcnlUeXBlTmFtZTsK\nICAgICAgICAgICAgY2FzZSBUeXBlcy5CSVQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gYml0VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuQkxP\nQjoKICAgICAgICAgICAgICAgIHJldHVybiBibG9iVHlwZU5hbWU7CiAgICAg\nICAgICAgIGNhc2UgMTY6IC8vIEpESyAxLjQgaW50cm9kdWNlcyBUeXBlcy5C\nT09MRUFOLCB3aG9zZSB2YWx1ZSBpcyAxNgogICAgICAgICAgICAgICAgcmV0\ndXJuIGJvb2xlYW5UeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5D\nSEFSOgogICAgICAgICAgICAgICAgcmV0dXJuIGNoYXJUeXBlTmFtZTsKICAg\nICAgICAgICAgY2FzZSBUeXBlcy5DTE9COgogICAgICAgICAgICAgICAgcmV0\ndXJuIGNsb2JUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5EQVRF\nOgogICAgICAgICAgICAgICAgcmV0dXJuIGRhdGVUeXBlTmFtZTsKICAgICAg\nICAgICAgY2FzZSBUeXBlcy5ERUNJTUFMOgogICAgICAgICAgICAgICAgcmV0\ndXJuIGRlY2ltYWxUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5E\nSVNUSU5DVDoKICAgICAgICAgICAgICAgIHJldHVybiBkaXN0aW5jdFR5cGVO\nYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLkRPVUJMRToKICAgICAgICAg\nICAgICAgIHJldHVybiBkb3VibGVUeXBlTmFtZTsKICAgICAgICAgICAgY2Fz\nZSBUeXBlcy5GTE9BVDoKICAgICAgICAgICAgICAgIHJldHVybiBmbG9hdFR5\ncGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLklOVEVHRVI6CiAgICAg\nICAgICAgICAgICByZXR1cm4gaW50ZWdlclR5cGVOYW1lOwogICAgICAgICAg\nICBjYXNlIFR5cGVzLkpBVkFfT0JKRUNUOgogICAgICAgICAgICAgICAgcmV0\ndXJuIGphdmFPYmplY3RUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBl\ncy5MT05HVkFSQklOQVJZOgogICAgICAgICAgICAgICAgcmV0dXJuIGxvbmdW\nYXJiaW5hcnlUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5MT05H\nVkFSQ0hBUjoKICAgICAgICAgICAgICAgIHJldHVybiBsb25nVmFyY2hhclR5\ncGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLk5VTEw6CiAgICAgICAg\nICAgICAgICByZXR1cm4gbnVsbFR5cGVOYW1lOwogICAgICAgICAgICBjYXNl\nIFR5cGVzLk5VTUVSSUM6CiAgICAgICAgICAgICAgICByZXR1cm4gbnVtZXJp\nY1R5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLk9USEVSOgogICAg\nICAgICAgICAgICAgcmV0dXJuIG90aGVyVHlwZU5hbWU7CiAgICAgICAgICAg\nIGNhc2UgVHlwZXMuUkVBTDoKICAgICAgICAgICAgICAgIHJldHVybiByZWFs\nVHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuUkVGOgogICAgICAg\nICAgICAgICAgcmV0dXJuIHJlZlR5cGVOYW1lOwogICAgICAgICAgICBjYXNl\nIFR5cGVzLlNNQUxMSU5UOgogICAgICAgICAgICAgICAgcmV0dXJuIHNtYWxs\naW50VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuU1RSVUNUOgog\nICAgICAgICAgICAgICAgcmV0dXJuIHN0cnVjdFR5cGVOYW1lOwogICAgICAg\nICAgICBjYXNlIFR5cGVzLlRJTUU6CiAgICAgICAgICAgICAgICByZXR1cm4g\ndGltZVR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLlRJTUVTVEFN\nUDoKICAgICAgICAgICAgICAgIHJldHVybiB0aW1lc3RhbXBUeXBlTmFtZTsK\nICAgICAgICAgICAgY2FzZSBUeXBlcy5USU5ZSU5UOgogICAgICAgICAgICAg\nICAgcmV0dXJuIHRpbnlpbnRUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBU\neXBlcy5WQVJCSU5BUlk6CiAgICAgICAgICAgICAgICByZXR1cm4gdmFyYmlu\nYXJ5VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuVkFSQ0hBUjoK\nICAgICAgICAgICAgICAgIHJldHVybiB2YXJjaGFyVHlwZU5hbWU7CiAgICAg\nICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gb3RoZXJU\neXBlTmFtZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBIZWxw\nZXIgbWV0aG9kIHRvIGFkZCBzaXplIHByb3BlcnRpZXMgdG8gdGhlIHNwZWNp\nZmllZCB0eXBlLgogICAgICogSWYgcHJlc2VudCwgdGhlIHN0cmluZyAiezB9\nIiB3aWxsIGJlIHJlcGxhY2VkIHdpdGggdGhlIHNpemUgZGVmaW5pdGlvbjsK\nICAgICAqIG90aGVyd2lzZSB0aGUgc2l6ZSBkZWZpbml0aW9uIHdpbGwgYmUg\nYXBwZW5kZWQgdG8gdGhlIHR5cGUgbmFtZS4KICAgICAqIElmIHlvdXIgZGF0\nYWJhc2UgaGFzIGNvbHVtbiB0eXBlcyB0aGF0IGRvbid0IGFsbG93IHNpemUg\nZGVmaW5pdGlvbnMsCiAgICAgKiBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBy\nZXR1cm4gdGhlIHVuYWx0ZXJlZCB0eXBlIG5hbWUgZm9yIGNvbHVtbnMgb2YK\nICAgICAqIHRob3NlIHR5cGVzIChvciBhZGQgdGhlIHR5cGUgbmFtZXMgdG8g\ndGhlCiAgICAgKiA8Y29kZT5maXhlZFNpemVUeXBlTmFtZVNldDwvY29kZT4p\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGFwcGVuZFNpemUoQ29s\ndW1uIGNvbCwgU3RyaW5nIHR5cGVOYW1lKSB7CiAgICAgICAgaWYgKGZpeGVk\nU2l6ZVR5cGVOYW1lU2V0LmNvbnRhaW5zKHR5cGVOYW1lLnRvVXBwZXJDYXNl\nKCkpKQogICAgICAgICAgICByZXR1cm4gdHlwZU5hbWU7CiAgICAgICAgaWYg\nKHR5cGVOYW1lLmluZGV4T2YoJygnKSAhPSAtMSkKICAgICAgICAgICAgcmV0\ndXJuIHR5cGVOYW1lOwoKICAgICAgICBTdHJpbmcgc2l6ZSA9IG51bGw7CiAg\nICAgICAgaWYgKGNvbC5nZXRTaXplKCkgPiAwKSB7CiAgICAgICAgICAgIFN0\ncmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKDEwKTsKICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiKCIpLmFwcGVuZChjb2wuZ2V0U2l6ZSgpKTsK\nICAgICAgICAgICAgaWYgKGNvbC5nZXREZWNpbWFsRGlnaXRzKCkgPiAwKQog\nICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKS5hcHBlbmQoY29sLmdl\ndERlY2ltYWxEaWdpdHMoKSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiki\nKTsKICAgICAgICAgICAgc2l6ZSA9IGJ1Zi50b1N0cmluZygpOwogICAgICAg\nIH0KCiAgICAgICAgaW50IGlkeCA9IHR5cGVOYW1lLmluZGV4T2YoInswfSIp\nOwogICAgICAgIGlmIChpZHggPT0gLTEgJiYgc2l6ZSAhPSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gdHlwZU5hbWUgKyBzaXplOwogICAgICAgIGlmIChp\nZHggPT0gLTEpCiAgICAgICAgICAgIHJldHVybiB0eXBlTmFtZTsKCiAgICAg\nICAgLy8gcmVwbGFjZSAnezB9JyB3aXRoIHNpemUKICAgICAgICBTdHJpbmcg\ncmV0ID0gdHlwZU5hbWUuc3Vic3RyaW5nKDAsIGlkeCk7CiAgICAgICAgaWYg\nKHNpemUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0ID0gcmV0ICsgc2l6ZTsK\nICAgICAgICBpZiAodHlwZU5hbWUubGVuZ3RoKCkgPiBpZHggKyAzKQogICAg\nICAgICAgICByZXQgPSByZXQgKyB0eXBlTmFtZS5zdWJzdHJpbmcoaWR4ICsg\nMyk7CiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICAvLy8vLy8vLy8v\nLwogICAgLy8gU2VsZWN0cwogICAgLy8vLy8vLy8vLy8KCiAgICAvKioKICAg\nICAqIFNldCB0aGUgbmFtZSBvZiB0aGUgam9pbiBzeW50YXggdG8gdXNlOiBz\ncWw5MiwgdHJhZGl0aW9uYWwsIGRhdGFiYXNlCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldEpvaW5TeW50YXgoU3RyaW5nIHN5bnRheCkgewogICAgICAg\nIGlmICgic3FsOTIiLmVxdWFscyhzeW50YXgpKQogICAgICAgICAgICBqb2lu\nU3ludGF4ID0gU1lOVEFYX1NRTDkyOwogICAgICAgIGVsc2UgaWYgKCJ0cmFk\naXRpb25hbCIuZXF1YWxzKHN5bnRheCkpCiAgICAgICAgICAgIGpvaW5TeW50\nYXggPSBTWU5UQVhfVFJBRElUSU9OQUw7CiAgICAgICAgZWxzZSBpZiAoImRh\ndGFiYXNlIi5lcXVhbHMoc3ludGF4KSkKICAgICAgICAgICAgam9pblN5bnRh\neCA9IFNZTlRBWF9EQVRBQkFTRTsKICAgICAgICBlbHNlIGlmICghU3RyaW5n\nVXRpbHMuaXNFbXB0eShzeW50YXgpKQogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKHN5bnRheCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gYSBTUUwgc3RyaW5nIHRvIGFjdCBhcyBhIHBs\nYWNlaG9sZGVyIGZvciB0aGUgZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFBsYWNlaG9sZGVyVmFsdWVTdHJpbmcoQ29sdW1u\nIGNvbCkgewogICAgICAgIHN3aXRjaCAoY29sLmdldFR5cGUoKSkgewogICAg\nICAgICAgICBjYXNlIFR5cGVzLkJJR0lOVDoKICAgICAgICAgICAgY2FzZSBU\neXBlcy5CSVQ6CiAgICAgICAgICAgIGNhc2UgVHlwZXMuSU5URUdFUjoKICAg\nICAgICAgICAgY2FzZSBUeXBlcy5OVU1FUklDOgogICAgICAgICAgICBjYXNl\nIFR5cGVzLlNNQUxMSU5UOgogICAgICAgICAgICBjYXNlIFR5cGVzLlRJTllJ\nTlQ6CiAgICAgICAgICAgICAgICByZXR1cm4gIjAiOwogICAgICAgICAgICBj\nYXNlIFR5cGVzLkNIQVI6CiAgICAgICAgICAgICAgICByZXR1cm4gKHN0b3Jl\nQ2hhcnNBc051bWJlcnMpID8gIjAiIDogIicgJyI7CiAgICAgICAgICAgIGNh\nc2UgVHlwZXMuQ0xPQjoKICAgICAgICAgICAgY2FzZSBUeXBlcy5MT05HVkFS\nQ0hBUjoKICAgICAgICAgICAgY2FzZSBUeXBlcy5WQVJDSEFSOgogICAgICAg\nICAgICAgICAgcmV0dXJuICInJyI7CiAgICAgICAgICAgIGNhc2UgVHlwZXMu\nREFURToKICAgICAgICAgICAgICAgIHJldHVybiBaRVJPX0RBVEVfU1RSOwog\nICAgICAgICAgICBjYXNlIFR5cGVzLkRFQ0lNQUw6CiAgICAgICAgICAgIGNh\nc2UgVHlwZXMuRE9VQkxFOgogICAgICAgICAgICBjYXNlIFR5cGVzLkZMT0FU\nOgogICAgICAgICAgICBjYXNlIFR5cGVzLlJFQUw6CiAgICAgICAgICAgICAg\nICByZXR1cm4gIjAuMCI7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuVElNRToK\nICAgICAgICAgICAgICAgIHJldHVybiBaRVJPX1RJTUVfU1RSOwogICAgICAg\nICAgICBjYXNlIFR5cGVzLlRJTUVTVEFNUDoKICAgICAgICAgICAgICAgIHJl\ndHVybiBaRVJPX1RJTUVTVEFNUF9TVFI7CiAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICByZXR1cm4gIk5VTEwiOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIFNFTEVDVCBDT1VOVCBzdGF0\nZW1lbnQgaW4gdGhlIHByb3BlciBqb2luIHN5bnRheCBmb3IgdGhlCiAgICAg\nKiBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZl\nciB0b1NlbGVjdENvdW50KFNlbGVjdCBzZWwpIHsKICAgICAgICBTUUxCdWZm\nZXIgc2VsZWN0U1FMID0gbmV3IFNRTEJ1ZmZlcih0aGlzKTsKICAgICAgICBT\nUUxCdWZmZXIgZnJvbTsKICAgICAgICBzZWwuYWRkSm9pbkNsYXNzQ29uZGl0\naW9ucygpOwogICAgICAgIGlmIChzZWwuZ2V0RnJvbVNlbGVjdCgpICE9IG51\nbGwpCiAgICAgICAgICAgIGZyb20gPSBnZXRGcm9tU2VsZWN0KHNlbCwgZmFs\nc2UpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgZnJvbSA9IGdldEZyb20o\nc2VsLCBmYWxzZSk7CiAgICAgICAgU1FMQnVmZmVyIHdoZXJlID0gZ2V0V2hl\ncmUoc2VsLCBmYWxzZSk7CgogICAgICAgIC8vIGlmIG5vIGdyb3VwaW5nIGFu\nZCBubyByYW5nZSwgd2UgbWlnaHQgYmUgYWJsZSB0byBnZXQgYnkgd2l0aG91\ndAogICAgICAgIC8vIGEgc3Vic2VsZWN0CiAgICAgICAgaWYgKHNlbC5nZXRH\ncm91cGluZygpID09IG51bGwgJiYgc2VsLmdldFN0YXJ0SW5kZXgoKSA9PSAw\nCiAgICAgICAgICAgICYmIHNlbC5nZXRFbmRJbmRleCgpID09IExvbmcuTUFY\nX1ZBTFVFKSB7CiAgICAgICAgICAgIC8vIGlmIHRoZSBzZWxlY3QgaGFzIG5v\nIGlkZW50aWZpZXIgY29scywgdXNlIENPVU5UKCopCiAgICAgICAgICAgIExp\nc3QgYWxpYXNlcyA9ICghc2VsLmlzRGlzdGluY3QoKSkgPyBDb2xsZWN0aW9u\ncy5FTVBUWV9MSVNUCiAgICAgICAgICAgICAgICA6IHNlbC5nZXRJZGVudGlm\naWVyQWxpYXNlcygpOwogICAgICAgICAgICBpZiAoYWxpYXNlcy5pc0VtcHR5\nKCkpIHsKICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoIkNPVU5U\nKCopIik7CiAgICAgICAgICAgICAgICByZXR1cm4gdG9TZWxlY3Qoc2VsZWN0\nU1FMLCBudWxsLCBmcm9tLCB3aGVyZSwgbnVsbCwgbnVsbCwgbnVsbCwKICAg\nICAgICAgICAgICAgICAgICBmYWxzZSwgZmFsc2UsIDAsIExvbmcuTUFYX1ZB\nTFVFKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaWYgdGhlcmUg\naXMgYSBzaW5nbGUgZGlzdGluY3QgY29sLCB1c2UgQ09VTlQoRElTVElOQ1Qg\nY29sKQogICAgICAgICAgICBpZiAoYWxpYXNlcy5zaXplKCkgPT0gMSkgewog\nICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgiQ09VTlQoRElTVElO\nQ1QgIikuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKGFsaWFzZXMuZ2V0\nKDApLnRvU3RyaW5nKCkpLmFwcGVuZCgiKSIpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIHRvU2VsZWN0KHNlbGVjdFNRTCwgbnVsbCwgZnJvbSwgd2hlcmUs\nIG51bGwsIG51bGwsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgZmFsc2Us\nIGZhbHNlLCAwLCBMb25nLk1BWF9WQUxVRSk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIC8vIGNhbiB3ZSBjb21iaW5lIGRpc3RpbmN0IGNvbHM/CiAg\nICAgICAgICAgIGlmIChkaXN0aW5jdENvdW50Q29sdW1uU2VwYXJhdG9yICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoIkNP\nVU5UKERJU1RJTkNUICIpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBhbGlhc2VzLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNl\nbGVjdFNRTC5hcHBlbmQoIiAiKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nc2VsZWN0U1FMLmFwcGVuZChkaXN0aW5jdENvdW50Q29sdW1uU2VwYXJhdG9y\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgi\nICIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICBzZWxlY3RTUUwuYXBwZW5kKGFsaWFzZXMuZ2V0KGkpLnRvU3RyaW5nKCkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZWN0U1FM\nLmFwcGVuZCgiKSIpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRvU2VsZWN0\nKHNlbGVjdFNRTCwgbnVsbCwgZnJvbSwgd2hlcmUsIG51bGwsIG51bGwsIG51\nbGwsCiAgICAgICAgICAgICAgICAgICAgZmFsc2UsIGZhbHNlLCAwLCBMb25n\nLk1BWF9WQUxVRSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8vIHNpbmNlIHdlIGNhbid0IGNvbWJpbmUgZGlzdGluY3QgY29scywgd2Ug\naGF2ZSB0byBwZXJmb3JtIGFuIG91dGVyCiAgICAgICAgLy8gQ09VTlQoKikg\nc2VsZWN0IHVzaW5nIHRoZSBvcmlnaW5hbCBzZWxlY3QgYXMgYSBzdWJzZWxl\nY3QgaW4gdGhlCiAgICAgICAgLy8gRlJPTSBjbGF1c2UKICAgICAgICBhc3Nl\ncnRTdXBwb3J0KHN1cHBvcnRzU3Vic2VsZWN0LCAiU3VwcG9ydHNTdWJzZWxl\nY3QiKTsKCiAgICAgICAgU1FMQnVmZmVyIHN1YlNlbGVjdCA9IGdldFNlbGVj\ndHMoc2VsLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgU1FMQnVmZmVyIHN1YkZy\nb20gPSBmcm9tOwogICAgICAgIGZyb20gPSBuZXcgU1FMQnVmZmVyKHRoaXMp\nOwogICAgICAgIGZyb20uYXBwZW5kKCIoIik7CiAgICAgICAgZnJvbS5hcHBl\nbmQodG9TZWxlY3Qoc3ViU2VsZWN0LCBudWxsLCBzdWJGcm9tLCB3aGVyZSwK\nICAgICAgICAgICAgc2VsLmdldEdyb3VwaW5nKCksIHNlbC5nZXRIYXZpbmco\nKSwgbnVsbCwgc2VsLmlzRGlzdGluY3QoKSwKICAgICAgICAgICAgZmFsc2Us\nIHNlbC5nZXRTdGFydEluZGV4KCksIHNlbC5nZXRFbmRJbmRleCgpKSk7CiAg\nICAgICAgZnJvbS5hcHBlbmQoIikiKTsKICAgICAgICBpZiAocmVxdWlyZXNB\nbGlhc0ZvclN1YnNlbGVjdCkKICAgICAgICAgICAgZnJvbS5hcHBlbmQoIiAi\nKS5hcHBlbmQoU2VsZWN0LkZST01fU0VMRUNUX0FMSUFTKTsKCiAgICAgICAg\nc2VsZWN0U1FMLmFwcGVuZCgiQ09VTlQoKikiKTsKICAgICAgICByZXR1cm4g\ndG9TZWxlY3Qoc2VsZWN0U1FMLCBudWxsLCBmcm9tLCBudWxsLCBudWxsLCBu\ndWxsLCBudWxsLAogICAgICAgICAgICBmYWxzZSwgZmFsc2UsIDAsIExvbmcu\nTUFYX1ZBTFVFKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIERF\nTEVURSBzdGF0ZW1lbnQgZm9yIHRoZSBzcGVjaWZpZWQgU2VsZWN0LiBJZiB0\naGUKICAgICAqIGRhdGFiYXNlIGRvZXMgbm90IHN1cHBvcnQgdGhlIGJ1bGsg\nZGVsZXRlIHN0YXRlbWVudCAoc3VjaCBhcwogICAgICogY2FzZXMgd2hlcmUg\nYSBzdWJzZWxlY3QgaXMgcmVxdWlyZWQgYW5kIHRoZSBkYXRhYmFzZSBkb2Vz\nbid0IHN1cHBvcnQKICAgICAqIHN1YnNlbGVjdHMpLCB0aGlzIG1ldGhvZCBz\naG91bGQgcmV0dXJuIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZm\nZXIgdG9EZWxldGUoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIFNlbGVjdCBzZWws\nIAogICAgICAgIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIHJldHVybiB0\nb0J1bGtPcGVyYXRpb24obWFwcGluZywgc2VsLCBudWxsLCBwYXJhbXMsIG51\nbGwpOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9VcGRhdGUoQ2xh\nc3NNYXBwaW5nIG1hcHBpbmcsIFNlbGVjdCBzZWwsCiAgICAgICAgSkRCQ1N0\nb3JlIHN0b3JlLCBPYmplY3RbXSBwYXJhbXMsIE1hcCB1cGRhdGVzKSB7CiAg\nICAgICAgcmV0dXJuIHRvQnVsa09wZXJhdGlvbihtYXBwaW5nLCBzZWwsIHN0\nb3JlLCBwYXJhbXMsIHVwZGF0ZXMpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJucyB0aGUgU1FMIGZvciBhIGJ1bGsgb3BlcmF0aW9uLCBlaXRoZXIg\nYSBERUxFVEUgb3IgYW4gVVBEQVRFLgogICAgICoKICAgICAqIEBwYXJhbSBt\nYXBwaW5nIHRoZSBtYXBwbmcgYWdhaW5zdCB3aGljaCB3ZSBhcmUgb3BlcmF0\naW5nCiAgICAgKiBAcGFyYW0gc2VsIHRoZSBTZWxlY3QgdGhhdCB3aWxsIGNv\nbnN0aXR1dGUgdGhlIFdIRVJFIGNsYXVzZQogICAgICogQHBhcmFtIHN0b3Jl\nIHRoZSBjdXJyZW50IHN0b3JlCiAgICAgKiBAcGFyYW0gdXBkYXRlUGFyYW1z\nIHRoZSBNYXAgdGhhdCBob2xkcyB0aGUgdXBkYXRlIHBhcmFtZXRlcnM7IGEg\nbnVsbAogICAgICogdmFsdWUgaW5kaWNhdGVzIHRoYXQgdGhpcyBpcyBhIGRl\nbGV0ZSBvcGVyYXRpb24KICAgICAqIEByZXR1cm4gdGhlIFNRTEJ1ZmZlciBm\nb3IgdGhlIHVwZGF0ZSwgb3IgPGVtPm51bGw8L2VtPiBpZiBpdCBpcyBub3QK\nICAgICAqIHBvc3NpYmxlIHRvIHBlcmZvcm0gdGhlIGJ1bGsgdXBkYXRlCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBTUUxCdWZmZXIgdG9CdWxrT3BlcmF0aW9u\nKENsYXNzTWFwcGluZyBtYXBwaW5nLCBTZWxlY3Qgc2VsLAogICAgICAgIEpE\nQkNTdG9yZSBzdG9yZSwgT2JqZWN0W10gcGFyYW1zLCBNYXAgdXBkYXRlUGFy\nYW1zKSB7CiAgICAgICAgU1FMQnVmZmVyIHNxbCA9IG5ldyBTUUxCdWZmZXIo\ndGhpcyk7CiAgICAgICAgaWYgKHVwZGF0ZVBhcmFtcyA9PSBudWxsKQogICAg\nICAgICAgICBzcWwuYXBwZW5kKCJERUxFVEUgRlJPTSAiKTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIHNxbC5hcHBlbmQoIlVQREFURSAiKTsKICAgICAg\nICBzZWwuYWRkSm9pbkNsYXNzQ29uZGl0aW9ucygpOwoKICAgICAgICAvLyBp\nZiB0aGVyZSBpcyBvbmx5IGEgc2luZ2xlIHRhYmxlIGluIHRoZSBzZWxlY3Qs\nIHRoZW4gd2UgY2FuCiAgICAgICAgLy8ganVzdCBpc3N1ZSBhIHNpbmdsZSBE\nRUxFVEUgRlJPTSBUQUJMRSBXSEVSRSA8Y29uZGl0aW9ucz4KICAgICAgICAv\nLyBzdGF0ZW1lbnQ7IG90aGVyd2lzZSwgc2luY2UgU1FMIGRvZXNuJ3QgYWxs\nb3cgZGVsZXRpbmcKICAgICAgICAvLyBmcm9tIG9uZSBvZiBhIG11bHRpLXRh\nYmxlIHNlbGVjdCwgd2UgbmVlZCB0byBpc3N1ZSBhIHN1YnNlbGVjdAogICAg\nICAgIC8vIGxpa2UgREVMRVRFIEZST00gVEFCTEUgV0hFUkUgRVhJU1RTCiAg\nICAgICAgLy8gKFNFTEVDVCAxIEZST00gVEFCTEUgdDAgV0hFUkUgdDAuSUQg\nPSBUQUJMRS5JRCk7IGFsc28sIHNvbWUKICAgICAgICAvLyBkYXRhYmFzZXMg\nZG8gbm90IGFsbG93IGFsaWFzZXMgaW4gZGVsZXRlIHN0YXRlbWVudHMsIHdo\naWNoCiAgICAgICAgLy8gYWxzbyBjYXVzZXMgdXMgdG8gdXNlIGEgc3Vic2Vs\nZWN0CiAgICAgICAgaWYgKHNlbC5nZXRUYWJsZUFsaWFzZXMoKS5zaXplKCkg\nPT0gMSAmJiBzdXBwb3J0c1N1YnNlbGVjdAogICAgICAgICAgICAmJiBhbGxv\nd3NBbGlhc0luQnVsa0NsYXVzZSkgewogICAgICAgICAgICBTUUxCdWZmZXIg\nZnJvbTsKICAgICAgICAgICAgaWYgKHNlbC5nZXRGcm9tU2VsZWN0KCkgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIGZyb20gPSBnZXRGcm9tU2VsZWN0KHNl\nbCwgZmFsc2UpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBm\ncm9tID0gZ2V0RnJvbShzZWwsIGZhbHNlKTsKCiAgICAgICAgICAgIHNxbC5h\ncHBlbmQoZnJvbSk7CiAgICAgICAgICAgIGFwcGVuZFVwZGF0ZXMoc2VsLCBz\ndG9yZSwgc3FsLCBwYXJhbXMsIHVwZGF0ZVBhcmFtcywKICAgICAgICAgICAg\nICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xhdXNlKTsKCiAgICAgICAgICAgIFNR\nTEJ1ZmZlciB3aGVyZSA9IHNlbC5nZXRXaGVyZSgpOwogICAgICAgICAgICBp\nZiAod2hlcmUgIT0gbnVsbCAmJiAhd2hlcmUuaXNFbXB0eSgpKSB7CiAgICAg\nICAgICAgICAgICBzcWwuYXBwZW5kKCIgV0hFUkUgIik7CiAgICAgICAgICAg\nICAgICBzcWwuYXBwZW5kKHdoZXJlKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICByZXR1cm4gc3FsOwogICAgICAgIH0KCiAgICAgICAgVGFibGUgdGFi\nbGUgPSBtYXBwaW5nLmdldFRhYmxlKCk7CiAgICAgICAgU3RyaW5nIHRhYmxl\nTmFtZSA9IGdldEZ1bGxOYW1lKHRhYmxlLCBmYWxzZSk7CgogICAgICAgIC8v\nIG9ubHkgdXNlIGEgIHN1YnNlbGVjdCBpZiB0aGUgd2hlcmUgaXMgbm90IGVt\ncHR5OyBvdGhlcndpc2UKICAgICAgICAvLyBhbiB1bnF1YWxpZmllZCBkZWxl\ndGUgb3IgdXBkYXRlIHdpbGwgd29yawogICAgICAgIGlmIChzZWwuZ2V0V2hl\ncmUoKSA9PSBudWxsIHx8IHNlbC5nZXRXaGVyZSgpLmlzRW1wdHkoKSkgewog\nICAgICAgICAgICBzcWwuYXBwZW5kKHRhYmxlTmFtZSk7CiAgICAgICAgICAg\nIGFwcGVuZFVwZGF0ZXMoc2VsLCBzdG9yZSwgc3FsLCBwYXJhbXMsIHVwZGF0\nZVBhcmFtcywgZmFsc2UpOwogICAgICAgICAgICByZXR1cm4gc3FsOwogICAg\nICAgIH0KCiAgICAgICAgLy8gd2UgbmVlZCB0byB1c2UgYSBzdWJzZWxlY3Qg\naWYgd2UgYXJlIHRvIGJ1bGsgZGVsZXRlIHdoZXJlCiAgICAgICAgLy8gdGhl\nIHNlbGVjdCBpbmNsdWRlcyBtdWx0aXBsZSB0YWJsZXM7IGlmIHRoZSBkYXRh\nYmFzZQogICAgICAgIC8vIGRvZXNuJ3Qgc3VwcG9ydCBpdCwgdGhlbiB3ZSBu\nZWVkIHRvIHNpZ2FsIHRoaXMgYnkgcmV0dXJuaW5nIG51bGwKICAgICAgICBp\nZiAoIXN1cHBvcnRzU3Vic2VsZWN0IHx8ICFzdXBwb3J0c0NvcnJlbGF0ZWRT\ndWJzZWxlY3QpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBD\nb2x1bW5bXSBwa3MgPSBtYXBwaW5nLmdldFByaW1hcnlLZXlDb2x1bW5zKCk7\nCiAgICAgICAgc2VsLmNsZWFyU2VsZWN0cygpOwogICAgICAgIHNlbC5zZXRE\naXN0aW5jdCh0cnVlKTsKCiAgICAgICAgLy8gaWYgd2UgaGF2ZSBvbmx5IGEg\nc2luZ2xlIFBLLCB3ZSBjYW4gdXNlIGEgbm9uLWNvcnJlbGF0ZWQKICAgICAg\nICAvLyBzdWJxdWVyeSAodXNpbmcgYW4gSU4gc3RhdGVtZW50KSwgd2hpY2gg\naXMgbXVjaCBmYXN0ZXIgdGhhbgogICAgICAgIC8vIGEgY29ycmVsYXRlZCBz\ndWJxdWVyeSAoc2luY2UgYSBjb3JyZWxhdGVkIHN1YnF1ZXJ5IG5lZWRzCiAg\nICAgICAgLy8gdG8gYmUgZXhlY3V0ZWQgb25jZSBmb3IgZWFjaCByb3cgaW4g\ndGhlIHRhYmxlKQogICAgICAgIGlmIChwa3MubGVuZ3RoID09IDEpIHsKICAg\nICAgICAgICAgc2VsLnNlbGVjdChwa3NbMF0pOwogICAgICAgICAgICBzcWwu\nYXBwZW5kKHRhYmxlTmFtZSk7CiAgICAgICAgICAgIGFwcGVuZFVwZGF0ZXMo\nc2VsLCBzdG9yZSwgc3FsLCBwYXJhbXMsIHVwZGF0ZVBhcmFtcywgZmFsc2Up\nOwogICAgICAgICAgICBzcWwuYXBwZW5kKCIgV0hFUkUgIikuCiAgICAgICAg\nICAgICAgICBhcHBlbmQocGtzWzBdKS5hcHBlbmQoIiBJTiAoIikuCiAgICAg\nICAgICAgICAgICBhcHBlbmQoc2VsLnRvU2VsZWN0KGZhbHNlLCBudWxsKSku\nYXBwZW5kKCIpIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2Vs\nLmNsZWFyU2VsZWN0cygpOwogICAgICAgICAgICBzZWwuc2V0RGlzdGluY3Qo\nZmFsc2UpOwoKICAgICAgICAgICAgLy8gc2luY2UgdGhlIHNlbGVjdCBpcyB1\nc2luZyBhIGNvcnJlbGF0ZWQgc3VicXVlcnksIHdlCiAgICAgICAgICAgIC8v\nIG9ubHkgbmVlZCB0byBzZWxlY3QgYSBib2d1cyB2aXJ0dWFsIGNvbHVtbgog\nICAgICAgICAgICBzZWwuc2VsZWN0KCIxIiwgbnVsbCk7CgogICAgICAgICAg\nICAvLyBhZGQgaW4gdGhlIGpvaW5zIHRvIHRoZSB0YWJsZQogICAgICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gdGFibGUuZ2V0UHJpbWFyeUtleSgpLmdldENv\nbHVtbnMoKTsKICAgICAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IG5ldyBTUUxC\ndWZmZXIodGhpcyk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIigiKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgICAgICBpZiAoaSA+IDApCiAgICAgICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiIEFORCAiKTsKCiAgICAgICAgICAgICAgICAv\nLyBhZGQgaW4gInQwLlBLID0gTVlUQUJMRS5QSyIKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoc2VsLmdldENvbHVtbkFsaWFzKGNvbHNbaV0sIG51bGwp\nKS5hcHBlbmQoIiA9ICIpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCh0\nYWJsZSkuYXBwZW5kKGNhdGFsb2dTZXBhcmF0b3IpLmFwcGVuZChjb2xzW2ld\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidWYuYXBwZW5kKCIpIik7\nCiAgICAgICAgICAgIHNlbC53aGVyZShidWYsIG51bGwpOwoKICAgICAgICAg\nICAgc3FsLmFwcGVuZCh0YWJsZU5hbWUpOwogICAgICAgICAgICBhcHBlbmRV\ncGRhdGVzKHNlbCwgc3RvcmUsIHNxbCwgcGFyYW1zLCB1cGRhdGVQYXJhbXMs\nIGZhbHNlKTsKICAgICAgICAgICAgc3FsLmFwcGVuZCgiIFdIRVJFIEVYSVNU\nUyAoIikuCiAgICAgICAgICAgICAgICBhcHBlbmQoc2VsLnRvU2VsZWN0KGZh\nbHNlLCBudWxsKSkuYXBwZW5kKCIpIik7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBzcWw7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5kVXBk\nYXRlcyhTZWxlY3Qgc2VsLCBKREJDU3RvcmUgc3RvcmUsIFNRTEJ1ZmZlciBz\ncWwsCiAgICAgICAgT2JqZWN0W10gcGFyYW1zLCBNYXAgdXBkYXRlUGFyYW1z\nLCBib29sZWFuIGFsbG93QWxpYXMpIHsKICAgICAgICBpZiAodXBkYXRlUGFy\nYW1zID09IG51bGwgfHwgdXBkYXRlUGFyYW1zLnNpemUoKSA9PSAwKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIC8vIG1hbnVhbGx5IGJ1aWxkIHVw\nIHRoZSBTRVQgY2xhdXNlIGZvciB0aGUgVVBEQVRFIHN0YXRlbWVudAogICAg\nICAgIHNxbC5hcHBlbmQoIiBTRVQgIik7CiAgICAgICAgRXhwQ29udGV4dCBj\ndHggPSBuZXcgRXhwQ29udGV4dChzdG9yZSwgcGFyYW1zLCAKICAgICAgICAg\nICAgc3RvcmUuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkpOwogICAgICAgIGZv\nciAoSXRlcmF0b3IgaSA9IHVwZGF0ZVBhcmFtcy5lbnRyeVNldCgpLml0ZXJh\ndG9yKCk7IGkuaGFzTmV4dCgpOykgewogICAgICAgICAgICBNYXAuRW50cnkg\nbmV4dCA9IChNYXAuRW50cnkpIGkubmV4dCgpOwogICAgICAgICAgICBGaWVs\nZE1ldGFEYXRhIGZtZCA9IChGaWVsZE1ldGFEYXRhKSBuZXh0LmdldEtleSgp\nOwogICAgICAgICAgICBWYWwgdmFsID0gKFZhbCkgbmV4dC5nZXRWYWx1ZSgp\nOwoKICAgICAgICAgICAgQ29sdW1uIGNvbCA9ICgoRmllbGRNYXBwaW5nKSBm\nbWQpLmdldENvbHVtbnMoKVswXTsKICAgICAgICAgICAgc3FsLmFwcGVuZChj\nb2wuZ2V0TmFtZSgpKTsKICAgICAgICAgICAgc3FsLmFwcGVuZCgiID0gIik7\nCgogICAgICAgICAgICBFeHBTdGF0ZSBzdGF0ZSA9IHZhbC5pbml0aWFsaXpl\nKHNlbCwgY3R4LCAwKTsKICAgICAgICAgICAgdmFsLmNhbGN1bGF0ZVZhbHVl\nKHNlbCwgY3R4LCBzdGF0ZSwgbnVsbCwgbnVsbCk7CgogICAgICAgICAgICAv\nLyBhcHBlbmQgdGhlIHZhbHVlIHdpdGggYSBudWxsIGZvciB0aGUgU2VsZWN0\nOyBpCiAgICAgICAgICAgIC8vIGluZGljYXRlcyB0aGF0IHRoZQogICAgICAg\nICAgICBpbnQgbGVuZ3RoID0gdmFsLmxlbmd0aChzZWwsIGN0eCwgc3RhdGUp\nOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGxlbmd0aDsgaisr\nKQogICAgICAgICAgICAgICAgdmFsLmFwcGVuZFRvKChhbGxvd0FsaWFzKSA/\nIHNlbCA6IG51bGwsIGN0eCwgc3RhdGUsIHNxbCwgaik7CgogICAgICAgICAg\nICBpZiAoaS5oYXNOZXh0KCkpCiAgICAgICAgICAgICAgICBzcWwuYXBwZW5k\nKCIsICIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBD\ncmVhdGUgU1FMIHRvIGRlbGV0ZSB0aGUgY29udGVudHMgb2YgdGhlIHNwZWNp\nZmllZCB0YWJsZXMuIAogICAgICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRp\nb24gZHJvcHMgYWxsIG5vbi1kZWZlcnJlZCBSRVNUUklDVCBmb3JlaWduIGtl\neSAKICAgICAqIGNvbnN0cmFpbnRzIGludm9sdmluZyB0aGUgc3BlY2lmaWVk\nIHRhYmxlcywgaXNzdWVzIERFTEVURSBzdGF0ZW1lbnRzIAogICAgICogYWdh\naW5zdCB0aGUgdGFibGVzLCBhbmQgdGhlbiBhZGRzIHRoZSBkcm9wcGVkIGNv\nbnN0cmFpbnRzIGJhY2sgaW4uIAogICAgICogRGF0YWJhc2VzIHdpdGggbW9y\nZSBvcHRpbWFsIHdheXMgb2YgZGVsZXRpbmcgdGhlIGNvbnRlbnRzIG9mIHNl\ndmVyYWwgCiAgICAgKiB0YWJsZXMgc2hvdWxkIG92ZXJyaWRlIHRoaXMgbWV0\naG9kLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RGVsZXRlVGFi\nbGVDb250ZW50c1NRTChUYWJsZVtdIHRhYmxlcykgewogICAgICAgIENvbGxl\nY3Rpb24gc3FsID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIAogICAgICAg\nIC8vIGNvbGxlY3QgYW5kIGRyb3Agbm9uLWRlZmVycmVkIHBoeXNpY2FsIHJl\nc3RyaWN0IGNvbnN0cmFpbnRzLCBhbmQKICAgICAgICAvLyBjb2xsZWN0IHRo\nZSBERUxFVEUgRlJPTSBzdGF0ZW1lbnRzCiAgICAgICAgQ29sbGVjdGlvbiBk\nZWxldGVTUUwgPSBuZXcgQXJyYXlMaXN0KHRhYmxlcy5sZW5ndGgpOwogICAg\nICAgIENvbGxlY3Rpb24gcmVzdHJpY3RDb25zdHJhaW50cyA9IG5ldyBMaW5r\nZWRIYXNoU2V0KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0YWJs\nZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgRm9yZWlnbktleVtdIGZr\ncyA9IHRhYmxlc1tpXS5nZXRGb3JlaWduS2V5cygpOwogICAgICAgICAgICBm\nb3IgKGludCBqID0gMDsgaiA8IGZrcy5sZW5ndGg7IGorKykgewogICAgICAg\nICAgICAgICAgaWYgKCFma3Nbal0uaXNMb2dpY2FsKCkgJiYgIWZrc1tqXS5p\nc0RlZmVycmVkKCkgCiAgICAgICAgICAgICAgICAgICAgJiYgZmtzW2pdLmdl\ndERlbGV0ZUFjdGlvbigpID09IEZvcmVpZ25LZXkuQUNUSU9OX1JFU1RSSUNU\nKQogICAgICAgICAgICAgICAgcmVzdHJpY3RDb25zdHJhaW50cy5hZGQoZmtz\nW2pdKTsKICAgICAgICAgICAgICAgIFN0cmluZ1tdIGNvbnN0cmFpbnRTUUwg\nPSBnZXREcm9wRm9yZWlnbktleVNRTChma3Nbal0pOwogICAgICAgICAgICAg\nICAgc3FsLmFkZEFsbChBcnJheXMuYXNMaXN0KGNvbnN0cmFpbnRTUUwpKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgZGVsZXRl\nU1FMLmFkZCgiREVMRVRFIEZST00gIiArIHRhYmxlc1tpXS5nZXRGdWxsTmFt\nZSgpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gYWRkIHRoZSBk\nZWxldGUgc3RhdGVtZW50cyBhZnRlciBhbGwgdGhlIGNvbnN0cmFpbnQgbXV0\nYXRpb25zCiAgICAgICAgc3FsLmFkZEFsbChkZWxldGVTUUwpOwogICAgICAg\nIAogICAgICAgIC8vIGFkZCB0aGUgZGVsZXRlZCBjb25zdHJhaW50cyBiYWNr\nIHRvIHRoZSBzY2hlbWEKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBy\nZXN0cmljdENvbnN0cmFpbnRzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgp\nOyApIHsKICAgICAgICAgICAgU3RyaW5nW10gY29uc3RyYWludFNRTCA9IAog\nICAgICAgICAgICAgICAgZ2V0QWRkRm9yZWlnbktleVNRTCgoRm9yZWlnbktl\neSkgaXRlci5uZXh0KCkpOwogICAgICAgICAgICBzcWwuYWRkQWxsKEFycmF5\ncy5hc0xpc3QoY29uc3RyYWludFNRTCkpOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICByZXR1cm4gKFN0cmluZ1tdKSBzcWwudG9BcnJheShuZXcgU3Ry\naW5nW3NxbC5zaXplKCldKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0\nZSBhIFNFTEVDVCBzdGF0ZW1lbnQgaW4gdGhlIHByb3BlciBqb2luIHN5bnRh\neCBmb3IgdGhlIGdpdmVuCiAgICAgKiBpbnN0YW5jZS4KICAgICAqLwogICAg\ncHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdChTZWxlY3Qgc2VsLCBib29sZWFu\nIGZvclVwZGF0ZSwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoKSB7CiAgICAgICAgc2VsLmFkZEpvaW5DbGFzc0NvbmRpdGlvbnMoKTsK\nICAgICAgICBib29sZWFuIHVwZGF0ZSA9IGZvclVwZGF0ZSAmJiBzZWwuZ2V0\nRnJvbVNlbGVjdCgpID09IG51bGw7CiAgICAgICAgU1FMQnVmZmVyIHNlbGVj\ndCA9IGdldFNlbGVjdHMoc2VsLCBmYWxzZSwgdXBkYXRlKTsKICAgICAgICBT\nUUxCdWZmZXIgb3JkZXJpbmcgPSBudWxsOwogICAgICAgIGlmICghc2VsLmlz\nQWdncmVnYXRlKCkgfHwgc2VsLmdldEdyb3VwaW5nKCkgIT0gbnVsbCkKICAg\nICAgICAgICAgb3JkZXJpbmcgPSBzZWwuZ2V0T3JkZXJpbmcoKTsKICAgICAg\nICBTUUxCdWZmZXIgZnJvbTsKICAgICAgICBpZiAoc2VsLmdldEZyb21TZWxl\nY3QoKSAhPSBudWxsKQogICAgICAgICAgICBmcm9tID0gZ2V0RnJvbVNlbGVj\ndChzZWwsIGZvclVwZGF0ZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBm\ncm9tID0gZ2V0RnJvbShzZWwsIHVwZGF0ZSk7CiAgICAgICAgU1FMQnVmZmVy\nIHdoZXJlID0gZ2V0V2hlcmUoc2VsLCB1cGRhdGUpOwogICAgICAgIHJldHVy\nbiB0b1NlbGVjdChzZWxlY3QsIGZldGNoLCBmcm9tLCB3aGVyZSwgc2VsLmdl\ndEdyb3VwaW5nKCksCiAgICAgICAgICAgIHNlbC5nZXRIYXZpbmcoKSwgb3Jk\nZXJpbmcsIHNlbC5pc0Rpc3RpbmN0KCksIGZvclVwZGF0ZSwKICAgICAgICAg\nICAgc2VsLmdldFN0YXJ0SW5kZXgoKSwgc2VsLmdldEVuZEluZGV4KCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwb3J0aW9uIG9mIHRo\nZSBzZWxlY3Qgc3RhdGVtZW50IGJldHdlZW4gdGhlIEZST00ga2V5d29yZAog\nICAgICogYW5kIHRoZSBXSEVSRSBrZXl3b3JkLgogICAgICovCiAgICBwcm90\nZWN0ZWQgU1FMQnVmZmVyIGdldEZyb20oU2VsZWN0IHNlbCwgYm9vbGVhbiBm\nb3JVcGRhdGUpIHsKICAgICAgICBTUUxCdWZmZXIgZnJvbVNRTCA9IG5ldyBT\nUUxCdWZmZXIodGhpcyk7CiAgICAgICAgQ29sbGVjdGlvbiBhbGlhc2VzID0g\nc2VsLmdldFRhYmxlQWxpYXNlcygpOwogICAgICAgIGlmIChhbGlhc2VzLnNp\nemUoKSA8IDIgfHwgc2VsLmdldEpvaW5TeW50YXgoKSAhPSBTWU5UQVhfU1FM\nOTIpIHsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhbGlhc2Vz\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAg\nICBmcm9tU1FMLmFwcGVuZChpdHIubmV4dCgpLnRvU3RyaW5nKCkpOwogICAg\nICAgICAgICAgICAgaWYgKGZvclVwZGF0ZSAmJiB0YWJsZUZvclVwZGF0ZUNs\nYXVzZSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGZyb21TUUwuYXBw\nZW5kKCIgIikuYXBwZW5kKHRhYmxlRm9yVXBkYXRlQ2xhdXNlKTsKICAgICAg\nICAgICAgICAgIGlmIChpdHIuaGFzTmV4dCgpKQogICAgICAgICAgICAgICAg\nICAgIGZyb21TUUwuYXBwZW5kKCIsICIpOwogICAgICAgICAgICB9CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgSXRlcmF0b3IgaXRyID0gc2VsLmdl\ndEpvaW5JdGVyYXRvcigpOwogICAgICAgICAgICBib29sZWFuIGZpcnN0ID0g\ndHJ1ZTsKICAgICAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsKICAg\nICAgICAgICAgICAgIGZyb21TUUwuYXBwZW5kKHRvU1FMOTJKb2luKChKb2lu\nKSBpdHIubmV4dCgpLCBmb3JVcGRhdGUsCiAgICAgICAgICAgICAgICAgICAg\nZmlyc3QpKTsKICAgICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZyb21TUUw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIEZST00gY2xhdXNlIGZv\nciBhIHNlbGVjdCB0aGF0IHNlbGVjdHMgZnJvbSBhIHRtcCB0YWJsZQogICAg\nICogY3JlYXRlZCBieSBhbiBpbm5lciBzZWxlY3QuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBTUUxCdWZmZXIgZ2V0RnJvbVNlbGVjdChTZWxlY3Qgc2VsLCBi\nb29sZWFuIGZvclVwZGF0ZSkgewogICAgICAgIFNRTEJ1ZmZlciBmcm9tU1FM\nID0gbmV3IFNRTEJ1ZmZlcih0aGlzKTsKICAgICAgICBmcm9tU1FMLmFwcGVu\nZCgiKCIpOwogICAgICAgIGZyb21TUUwuYXBwZW5kKHRvU2VsZWN0KHNlbC5n\nZXRGcm9tU2VsZWN0KCksIGZvclVwZGF0ZSwgbnVsbCkpOwogICAgICAgIGZy\nb21TUUwuYXBwZW5kKCIpIik7CiAgICAgICAgaWYgKHJlcXVpcmVzQWxpYXNG\nb3JTdWJzZWxlY3QpCiAgICAgICAgICAgIGZyb21TUUwuYXBwZW5kKCIgIiku\nYXBwZW5kKFNlbGVjdC5GUk9NX1NFTEVDVF9BTElBUyk7CiAgICAgICAgcmV0\ndXJuIGZyb21TUUw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIFdIRVJFIHBvcnRpb24gb2YgdGhlIHNlbGVjdCBzdGF0ZW1lbnQsIG9yIG51\nbGwgaWYgbm8gd2hlcmUKICAgICAqIGNvbmRpdGlvbnMuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBTUUxCdWZmZXIgZ2V0V2hlcmUoU2VsZWN0IHNlbCwgYm9v\nbGVhbiBmb3JVcGRhdGUpIHsKICAgICAgICBKb2lucyBqb2lucyA9IHNlbC5n\nZXRKb2lucygpOwogICAgICAgIGlmIChzZWwuZ2V0Sm9pblN5bnRheCgpID09\nIFNZTlRBWF9TUUw5MgogICAgICAgICAgICB8fCBqb2lucyA9PSBudWxsIHx8\nIGpvaW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRX\naGVyZSgpOwoKICAgICAgICBTUUxCdWZmZXIgd2hlcmUgPSBuZXcgU1FMQnVm\nZmVyKHRoaXMpOwogICAgICAgIGlmIChzZWwuZ2V0V2hlcmUoKSAhPSBudWxs\nKQogICAgICAgICAgICB3aGVyZS5hcHBlbmQoc2VsLmdldFdoZXJlKCkpOwog\nICAgICAgIGlmIChqb2lucyAhPSBudWxsKQogICAgICAgICAgICBzZWwuYXBw\nZW5kKHdoZXJlLCBqb2lucyk7CiAgICAgICAgcmV0dXJuIHdoZXJlOwogICAg\nfQoKICAgIC8qKgogICAgICogVXNlIHRoZSBnaXZlbiBqb2luIGluc3RhbmNl\nIHRvIGNyZWF0ZSBTUUwgam9pbmluZyBpdHMgdGFibGVzIGluCiAgICAgKiB0\naGUgdHJhZGl0aW9uYWwgc3R5bGUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxC\ndWZmZXIgdG9UcmFkaXRpb25hbEpvaW4oSm9pbiBqb2luKSB7CiAgICAgICAg\nRm9yZWlnbktleSBmayA9IGpvaW4uZ2V0Rm9yZWlnbktleSgpOwogICAgICAg\nIGlmIChmayA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgYm9vbGVhbiBpbnZlcnNlID0gam9pbi5pc0ZvcmVpZ25LZXlJbnZl\ncnNlZCgpOwogICAgICAgIENvbHVtbltdIGZyb20gPSAoaW52ZXJzZSkgPyBm\nay5nZXRQcmltYXJ5S2V5Q29sdW1ucygpCiAgICAgICAgICAgIDogZmsuZ2V0\nQ29sdW1ucygpOwogICAgICAgIENvbHVtbltdIHRvID0gKGludmVyc2UpID8g\nZmsuZ2V0Q29sdW1ucygpCiAgICAgICAgICAgIDogZmsuZ2V0UHJpbWFyeUtl\neUNvbHVtbnMoKTsKCiAgICAgICAgLy8gZG8gY29sdW1uIGpvaW5zCiAgICAg\nICAgU1FMQnVmZmVyIGJ1ZiA9IG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICAg\nICAgaW50IGNvdW50ID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGZyb20ubGVuZ3RoOyBpKyssIGNvdW50KyspIHsKICAgICAgICAgICAgaWYg\nKGNvdW50ID4gMCkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQg\nIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoam9pbi5nZXRBbGlhczEoKSku\nYXBwZW5kKCIuIikuYXBwZW5kKGZyb21baV0pOwogICAgICAgICAgICBidWYu\nYXBwZW5kKCIgPSAiKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChqb2luLmdl\ndEFsaWFzMigpKS5hcHBlbmQoIi4iKS5hcHBlbmQodG9baV0pOwogICAgICAg\nIH0KCiAgICAgICAgLy8gZG8gY29uc3RhbnQgam9pbnMKICAgICAgICBDb2x1\nbW5bXSBjb25zdENvbHMgPSBmay5nZXRDb25zdGFudENvbHVtbnMoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbnN0Q29scy5sZW5ndGg7IGkr\nKywgY291bnQrKykgewogICAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAg\naWYgKGludmVyc2UpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kVmFsdWUo\nZmsuZ2V0Q29uc3RhbnQoY29uc3RDb2xzW2ldKSwgY29uc3RDb2xzW2ldKTsK\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChq\nb2luLmdldEFsaWFzMSgpKS5hcHBlbmQoIi4iKS4KICAgICAgICAgICAgICAg\nICAgICBhcHBlbmQoY29uc3RDb2xzW2ldKTsKICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiID0gIik7CgogICAgICAgICAgICBpZiAoaW52ZXJzZSkKICAgICAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoam9pbi5nZXRBbGlhczIoKSkuYXBwZW5k\nKCIuIikuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKGNvbnN0Q29sc1tp\nXSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmRWYWx1ZShmay5nZXRDb25zdGFudChjb25zdENvbHNbaV0pLCBjb25zdENv\nbHNbaV0pOwogICAgICAgIH0KCiAgICAgICAgQ29sdW1uW10gY29uc3RDb2xz\nUEsgPSBmay5nZXRDb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb25zdENvbHNQSy5sZW5ndGg7IGkr\nKywgY291bnQrKykgewogICAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAg\naWYgKGludmVyc2UpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4u\nZ2V0QWxpYXMxKCkpLmFwcGVuZCgiLiIpLgogICAgICAgICAgICAgICAgICAg\nIGFwcGVuZChjb25zdENvbHNQS1tpXSk7CiAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgIGJ1Zi5hcHBlbmRWYWx1ZShmay5nZXRQcmltYXJ5S2V5\nQ29uc3RhbnQoY29uc3RDb2xzUEtbaV0pLAogICAgICAgICAgICAgICAgICAg\nIGNvbnN0Q29sc1BLW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiID0g\nIik7CgogICAgICAgICAgICBpZiAoaW52ZXJzZSkKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmRWYWx1ZShmay5nZXRQcmltYXJ5S2V5Q29uc3RhbnQoY29u\nc3RDb2xzUEtbaV0pLAogICAgICAgICAgICAgICAgICAgIGNvbnN0Q29sc1BL\nW2ldKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZChqb2luLmdldEFsaWFzMigpKS5hcHBlbmQoIi4iKS4KICAgICAgICAg\nICAgICAgICAgICBhcHBlbmQoY29uc3RDb2xzUEtbaV0pOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gYnVmOwogICAgfQoKICAgIC8qKgogICAgICogVXNl\nIHRoZSBnaXZlbiBqb2luIGluc3RhbmNlIHRvIGNyZWF0ZSBTUUwgam9pbmlu\nZyBpdHMgdGFibGVzIGluCiAgICAgKiB0aGUgU1FMOTIgc3R5bGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TUUw5MkpvaW4oSm9pbiBqb2lu\nLCBib29sZWFuIGZvclVwZGF0ZSwgYm9vbGVhbiBmaXJzdCkgewogICAgICAg\nIFNRTEJ1ZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAg\nIGlmIChmaXJzdCkgewogICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0\nVGFibGUxKCkpLmFwcGVuZCgiICIpLgogICAgICAgICAgICAgICAgYXBwZW5k\nKGpvaW4uZ2V0QWxpYXMxKCkpOwogICAgICAgICAgICBpZiAoZm9yVXBkYXRl\nICYmIHRhYmxlRm9yVXBkYXRlQ2xhdXNlICE9IG51bGwpCiAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKHRhYmxlRm9yVXBkYXRlQ2xh\ndXNlKTsKICAgICAgICB9CgogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKICAg\nICAgICBpZiAoam9pbi5nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX09VVEVSKQog\nICAgICAgICAgICBidWYuYXBwZW5kKG91dGVySm9pbkNsYXVzZSk7CiAgICAg\nICAgZWxzZSBpZiAoam9pbi5nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX0lOTkVS\nKQogICAgICAgICAgICBidWYuYXBwZW5kKGlubmVySm9pbkNsYXVzZSk7CiAg\nICAgICAgZWxzZSAvLyBjcm9zcwogICAgICAgICAgICBidWYuYXBwZW5kKGNy\nb3NzSm9pbkNsYXVzZSk7CiAgICAgICAgYnVmLmFwcGVuZCgiICIpOwoKICAg\nICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0VGFibGUyKCkpLmFwcGVuZCgiICIp\nLmFwcGVuZChqb2luLmdldEFsaWFzMigpKTsKICAgICAgICBpZiAoZm9yVXBk\nYXRlICYmIHRhYmxlRm9yVXBkYXRlQ2xhdXNlICE9IG51bGwpCiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQodGFibGVGb3JVcGRhdGVDbGF1\nc2UpOwoKICAgICAgICBpZiAoam9pbi5nZXRGb3JlaWduS2V5KCkgIT0gbnVs\nbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIE9OICIpLmFwcGVuZCh0b1Ry\nYWRpdGlvbmFsSm9pbihqb2luKSk7CiAgICAgICAgZWxzZSBpZiAocmVxdWly\nZXNDb25kaXRpb25Gb3JDcm9zc0pvaW4gJiYKICAgICAgICAgICAgam9pbi5n\nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX0NST1NTKQogICAgICAgICAgICBidWYu\nYXBwZW5kKCIgT04gKDEgPSAxKSIpOwoKICAgICAgICByZXR1cm4gYnVmOwog\nICAgfQoKICAgIC8qKgogICAgICogVXNlIHRoZSBnaXZlbiBqb2luIGluc3Rh\nbmNlIHRvIGNyZWF0ZSBTUUwgam9pbmluZyBpdHMgdGFibGVzIGluCiAgICAg\nKiB0aGUgZGF0YWJhc2UncyBuYXRpdmUgc3ludGF4LiBUaHJvd3MgYW4gZXhj\nZXB0aW9uIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZm\nZXIgdG9OYXRpdmVKb2luKEpvaW4gam9pbikgewogICAgICAgIHRocm93IG5l\ndyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyBpZiB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkgY2FuIGJlIGVh\nZ2VybHkgbG9hZGVkIHVzaW5nIG90aGVyIGpvaW5zLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBjYW5PdXRlckpvaW4oaW50IHN5bnRheCwgRm9yZWln\nbktleSBmaykgewogICAgICAgIHJldHVybiBzeW50YXggIT0gU1lOVEFYX1RS\nQURJVElPTkFMOwogICAgfQoKICAgIC8qKgogICAgICogQ29tYmluZSB0aGUg\nZ2l2ZW4gY29tcG9uZW50cyBpbnRvIGEgU0VMRUNUIHN0YXRlbWVudC4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdChTUUxCdWZmZXIg\nc2VsZWN0cywgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwKICAgICAg\nICBTUUxCdWZmZXIgZnJvbSwgU1FMQnVmZmVyIHdoZXJlLCBTUUxCdWZmZXIg\nZ3JvdXAsCiAgICAgICAgU1FMQnVmZmVyIGhhdmluZywgU1FMQnVmZmVyIG9y\nZGVyLAogICAgICAgIGJvb2xlYW4gZGlzdGluY3QsIGJvb2xlYW4gZm9yVXBk\nYXRlLCBsb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAgIHJldHVybiB0\nb09wZXJhdGlvbihnZXRTZWxlY3RPcGVyYXRpb24oZmV0Y2gpLCBzZWxlY3Rz\nLCBmcm9tLCB3aGVyZSwKICAgICAgICAgICAgZ3JvdXAsIGhhdmluZywgb3Jk\nZXIsIGRpc3RpbmN0LCBzdGFydCwgZW5kLAogICAgICAgICAgICBnZXRGb3JV\ncGRhdGVDbGF1c2UoZmV0Y2gsIGZvclVwZGF0ZSkpOwogICAgfQoKICAgIC8q\nKgogICAgICogR2V0IHRoZSB1cGRhdGUgY2xhdXNlIGZvciB0aGUgcXVlcnkg\nYmFzZWQgb24gdGhlCiAgICAgKiB1cGRhdGVDbGF1c2UgYW5kIGlzb2xhdGlv\nbkxldmVsIGhpbnRzCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0\nRm9yVXBkYXRlQ2xhdXNlKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gs\nCiAgICAgICAgYm9vbGVhbiBmb3JVcGRhdGUpIHsKICAgICAgICBpZiAoZmV0\nY2ggIT0gbnVsbCAmJiBmZXRjaC5nZXRJc29sYXRpb24oKSAhPSAtMSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9s\nb2MuZ2V0KAogICAgICAgICAgICAgICAgImlzb2xhdGlvbi1sZXZlbC1jb25m\naWctbm90LXN1cHBvcnRlZCIsIGdldENsYXNzKCkuZ2V0TmFtZSgpKSk7CiAg\nICAgICAgfSBlbHNlIGlmIChmb3JVcGRhdGUgJiYgIXNpbXVsYXRlTG9ja2lu\nZykgewogICAgICAgICAgICBhc3NlcnRTdXBwb3J0KHN1cHBvcnRzU2VsZWN0\nRm9yVXBkYXRlLCAiU3VwcG9ydHNTZWxlY3RGb3JVcGRhdGUiKTsKICAgICAg\nICAgICAgcmV0dXJuIGZvclVwZGF0ZUNsYXVzZTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlICJTRUxFQ1QiIG9wZXJhdGlvbiBj\nbGF1c2UsIGFkZGluZyBhbnkgYXZhaWxhYmxlIGhpbnRzLCBldGMuCiAgICAg\nKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2VsZWN0T3BlcmF0aW9uKEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4gIlNF\nTEVDVCI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIFNRTCBm\nb3IgdGhlIGdpdmVuIHNlbGVjdGluZyBvcGVyYXRpb24uCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBTUUxCdWZmZXIgdG9PcGVyYXRpb24oU3RyaW5nIG9wLCBT\nUUxCdWZmZXIgc2VsZWN0cywKICAgICAgICBTUUxCdWZmZXIgZnJvbSwgU1FM\nQnVmZmVyIHdoZXJlLCBTUUxCdWZmZXIgZ3JvdXAsIFNRTEJ1ZmZlciBoYXZp\nbmcsCiAgICAgICAgU1FMQnVmZmVyIG9yZGVyLCBib29sZWFuIGRpc3RpbmN0\nLCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAgICAgICBTdHJpbmcgZm9yVXBk\nYXRlQ2xhdXNlKSB7CiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IG5ldyBTUUxC\ndWZmZXIodGhpcyk7CiAgICAgICAgYnVmLmFwcGVuZChvcCk7CgogICAgICAg\nIGJvb2xlYW4gcmFuZ2UgPSBzdGFydCAhPSAwIHx8IGVuZCAhPSBMb25nLk1B\nWF9WQUxVRTsKICAgICAgICBpZiAocmFuZ2UgJiYgcmFuZ2VQb3NpdGlvbiA9\nPSBSQU5HRV9QUkVfRElTVElOQ1QpCiAgICAgICAgICAgIGFwcGVuZFNlbGVj\ndFJhbmdlKGJ1Ziwgc3RhcnQsIGVuZCk7CiAgICAgICAgaWYgKGRpc3RpbmN0\nKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgRElTVElOQ1QiKTsKICAgICAg\nICBpZiAocmFuZ2UgJiYgcmFuZ2VQb3NpdGlvbiA9PSBSQU5HRV9QT1NUX0RJ\nU1RJTkNUKQogICAgICAgICAgICBhcHBlbmRTZWxlY3RSYW5nZShidWYsIHN0\nYXJ0LCBlbmQpOwoKICAgICAgICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKHNl\nbGVjdHMpLmFwcGVuZCgiIEZST00gIikuYXBwZW5kKGZyb20pOwoKICAgICAg\nICBpZiAod2hlcmUgIT0gbnVsbCAmJiAhd2hlcmUuaXNFbXB0eSgpKQogICAg\nICAgICAgICBidWYuYXBwZW5kKCIgV0hFUkUgIikuYXBwZW5kKHdoZXJlKTsK\nICAgICAgICBpZiAoZ3JvdXAgIT0gbnVsbCAmJiAhZ3JvdXAuaXNFbXB0eSgp\nKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgR1JPVVAgQlkgIikuYXBwZW5k\nKGdyb3VwKTsKICAgICAgICBpZiAoaGF2aW5nICE9IG51bGwgJiYgIWhhdmlu\nZy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgYXNzZXJ0U3VwcG9ydChzdXBw\nb3J0c0hhdmluZywgIlN1cHBvcnRzSGF2aW5nIik7CiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiBIQVZJTkcgIikuYXBwZW5kKGhhdmluZyk7CiAgICAgICAg\nfQogICAgICAgIGlmIChvcmRlciAhPSBudWxsICYmICFvcmRlci5pc0VtcHR5\nKCkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBPUkRFUiBCWSAiKS5hcHBl\nbmQob3JkZXIpOwogICAgICAgIGlmIChyYW5nZSAmJiByYW5nZVBvc2l0aW9u\nID09IFJBTkdFX1BPU1RfU0VMRUNUKQogICAgICAgICAgICBhcHBlbmRTZWxl\nY3RSYW5nZShidWYsIHN0YXJ0LCBlbmQpOwogICAgICAgIGlmIChmb3JVcGRh\ndGVDbGF1c2UgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiICIp\nLmFwcGVuZChmb3JVcGRhdGVDbGF1c2UpOwogICAgICAgIGlmIChyYW5nZSAm\nJiByYW5nZVBvc2l0aW9uID09IFJBTkdFX1BPU1RfTE9DSykKICAgICAgICAg\nICAgYXBwZW5kU2VsZWN0UmFuZ2UoYnVmLCBzdGFydCwgZW5kKTsKICAgICAg\nICByZXR1cm4gYnVmOwogICAgfQoKICAgIC8qKgogICAgICogSWYgdGhpcyBk\naWN0aW9uYXJ5IGNhbiBzZWxlY3QgcmFuZ2VzLAogICAgICogdXNlIHRoaXMg\nbWV0aG9kIHRvIGFwcGVuZCB0aGUgcmFuZ2UgU1FMLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBhcHBlbmRTZWxlY3RSYW5nZShTUUxCdWZmZXIgYnVm\nLCBsb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBwb3J0aW9uIG9mIHRoZSBzZWxlY3Qgc3RhdGVtZW50\nIGJldHdlZW4gdGhlIFNFTEVDVCBrZXl3b3JkCiAgICAgKiBhbmQgdGhlIEZS\nT00ga2V5d29yZC4KICAgICAqLwogICAgcHJvdGVjdGVkIFNRTEJ1ZmZlciBn\nZXRTZWxlY3RzKFNlbGVjdCBzZWwsIGJvb2xlYW4gZGlzdGluY3RJZGVudGlm\naWVycywKICAgICAgICBib29sZWFuIGZvclVwZGF0ZSkgewogICAgICAgIC8v\nIGFwcGVuZCB0aGUgYWxpYXNlcyBmb3IgYWxsIHRoZSBjb2x1bW5zCiAgICAg\nICAgU1FMQnVmZmVyIHNlbGVjdFNRTCA9IG5ldyBTUUxCdWZmZXIodGhpcyk7\nCiAgICAgICAgTGlzdCBhbGlhc2VzOwogICAgICAgIGlmIChkaXN0aW5jdElk\nZW50aWZpZXJzKQogICAgICAgICAgICBhbGlhc2VzID0gc2VsLmdldElkZW50\naWZpZXJBbGlhc2VzKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBhbGlh\nc2VzID0gc2VsLmdldFNlbGVjdEFsaWFzZXMoKTsKCiAgICAgICAgT2JqZWN0\nIGFsaWFzOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gYWxpYXNlcy5p\ndGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBhbGlh\ncyA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChhbGlhcyBpbnN0YW5j\nZW9mIFNRTEJ1ZmZlcikKICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBl\nbmQoKFNRTEJ1ZmZlcikgYWxpYXMpOwogICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKGFsaWFzLnRvU3RyaW5nKCkp\nOwogICAgICAgICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAgICAgICAg\nICAgIHNlbGVjdFNRTC5hcHBlbmQoIiwgIik7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBzZWxlY3RTUUw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm5zIHRydWUgaWYgYSAiRk9SIFVQREFURSIgY2xhdXNlIGNhbiBiZSB1c2Vk\nIGZvciB0aGUgc3BlY2lmaWVkCiAgICAgKiBTZWxlY3Qgb2JqZWN0LgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0xvY2tpbmcoU2VsZWN0\nIHNlbCkgewogICAgICAgIGlmIChzZWwuaXNBZ2dyZWdhdGUoKSkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmICghc3VwcG9ydHNTZWxl\nY3RGb3JVcGRhdGUpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhTZWxlY3RSYW5nZSAmJiAoc2Vs\nLmdldFN0YXJ0SW5kZXgoKSAhPSAwCiAgICAgICAgICAgIHx8IHNlbC5nZXRF\nbmRJbmRleCgpICE9IExvbmcuTUFYX1ZBTFVFKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwoKICAgICAgICAvLyBvbmx5IGlubmVyIHNlbGVjdCBpcyBs\nb2NrZWQKICAgICAgICBpZiAoc2VsLmdldEZyb21TZWxlY3QoKSAhPSBudWxs\nKQogICAgICAgICAgICBzZWwgPSBzZWwuZ2V0RnJvbVNlbGVjdCgpOwoKICAg\nICAgICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhEaXN0aW5jdENsYXVzZSAm\nJiBzZWwuaXNEaXN0aW5jdCgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgaWYgKCFzdXBwb3J0c0xvY2tpbmdXaXRoTXVsdGlwbGVUYWJs\nZXMKICAgICAgICAgICAgJiYgc2VsLmdldFRhYmxlQWxpYXNlcygpLnNpemUo\nKSA+IDEpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAo\nIXN1cHBvcnRzTG9ja2luZ1dpdGhPcmRlckNsYXVzZSAmJiBzZWwuZ2V0T3Jk\nZXJpbmcoKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgaWYgKCFzdXBwb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2luIHx8ICFz\ndXBwb3J0c0xvY2tpbmdXaXRoSW5uZXJKb2luKSB7CiAgICAgICAgICAgIGZv\nciAoSXRlcmF0b3IgaXRyID0gc2VsLmdldEpvaW5JdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgSm9pbiBqb2luID0gKEpv\naW4pIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBpZiAoIXN1cHBvcnRz\nTG9ja2luZ1dpdGhPdXRlckpvaW4KICAgICAgICAgICAgICAgICAgICAmJiBq\nb2luLmdldFR5cGUoKSA9PSBKb2luLlRZUEVfT1VURVIpCiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgaWYgKCFz\ndXBwb3J0c0xvY2tpbmdXaXRoSW5uZXJKb2luCiAgICAgICAgICAgICAgICAg\nICAgJiYgam9pbi5nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX0lOTkVSKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBmYWxzZSBpZiB0aGUgZ2l2ZW4gc2VsZWN0IHJlcXVp\ncmVzIGEgZm9yd2FyZC1vbmx5IHJlc3VsdCBzZXQuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIHN1cHBvcnRzUmFuZG9tQWNjZXNzUmVzdWx0U2V0KFNl\nbGVjdCBzZWwsCiAgICAgICAgYm9vbGVhbiBmb3JVcGRhdGUpIHsKICAgICAg\nICByZXR1cm4gIXNlbC5pc0FnZ3JlZ2F0ZSgpOwogICAgfQoKICAgIC8qKgog\nICAgICogQXNzZXJ0IHRoYXQgdGhlIGdpdmVuIGRpY3Rpb25hcnkgZmxhZyBp\ncyB0cnVlLiBJZiBpdCBpcyBub3QgdHJ1ZSwKICAgICAqIHRocm93IGFuIGVy\ncm9yIHNheWluZyB0aGF0IHRoZSBnaXZlbiBzZXR0aW5nIG5lZWRzIHRvIHJl\ndHVybiB0cnVlIGZvcgogICAgICogdGhlIGN1cnJlbnQgb3BlcmF0aW9uIHRv\nIHdvcmsuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFzc2VydFN1cHBvcnQo\nYm9vbGVhbiBmZWF0dXJlLCBTdHJpbmcgcHJvcGVydHkpIHsKICAgICAgICBp\nZiAoIWZlYXR1cmUpCiAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRl\nZEV4Y2VwdGlvbihfbG9jLmdldCgiZmVhdHVyZS1ub3Qtc3VwcG9ydGVkIiwK\nICAgICAgICAgICAgICAgIGdldENsYXNzKCksIHByb3BlcnR5KSk7CiAgICB9\nCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFF1ZXJ5IGZ1bmN0\naW9ucwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAq\nIEludm9rZSB0aGlzIGRhdGFiYXNlJ3Mgc3Vic3RyaW5nIGZ1bmN0aW9uLgog\nICAgICoKICAgICAqIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3Jp\ndGUgdGhlIHN1YnN0cmluZyBpbnZvY2F0aW9uIHRvCiAgICAgKiBAcGFyYW0g\nc3RyIGEgcXVlcnkgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSB0YXJnZXQgc3Ry\naW5nCiAgICAgKiBAcGFyYW0gc3RhcnQgYSBxdWVyeSB2YWx1ZSByZXByZXNl\nbnRpbmcgdGhlIHN0YXJ0IGluZGV4CiAgICAgKiBAcGFyYW0gZW5kIGEgcXVl\ncnkgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBlbmQgaW5kZXgsIG9yIG51bGwg\nZm9yIG5vbmUKICAgICAqLwogICAgcHVibGljIHZvaWQgc3Vic3RyaW5nKFNR\nTEJ1ZmZlciBidWYsIEZpbHRlclZhbHVlIHN0ciwgRmlsdGVyVmFsdWUgc3Rh\ncnQsCiAgICAgICAgRmlsdGVyVmFsdWUgZW5kKSB7CiAgICAgICAgYnVmLmFw\ncGVuZChzdWJzdHJpbmdGdW5jdGlvbk5hbWUpLmFwcGVuZCgiKCgiKTsKICAg\nICAgICBzdHIuYXBwZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCIp\nLCAoIik7CiAgICAgICAgc3RhcnQuYXBwZW5kVG8oYnVmKTsKICAgICAgICBi\ndWYuYXBwZW5kKCIgKyAxKSIpOwogICAgICAgIGlmIChlbmQgIT0gbnVsbCkg\newogICAgICAgICAgICBidWYuYXBwZW5kKCIsICgiKTsKICAgICAgICAgICAg\nZW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAt\nICgiKTsKICAgICAgICAgICAgc3RhcnQuYXBwZW5kVG8oYnVmKTsKICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiKSkiKTsKICAgICAgICB9CiAgICAgICAgYnVm\nLmFwcGVuZCgiKSIpOwogICAgfQoKICAgIC8qKgogICAgICogSW52b2tlIHRo\naXMgZGF0YWJhc2UncyBpbmRleE9mIGZ1bmN0aW9uLgogICAgICoKICAgICAq\nIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIGluZGV4\nT2YgaW52b2NhdGlvbiB0bwogICAgICogQHBhcmFtIHN0ciBhIHF1ZXJ5IHZh\nbHVlIHJlcHJlc2VudGluZyB0aGUgdGFyZ2V0IHN0cmluZwogICAgICogQHBh\ncmFtIGZpbmQgYSBxdWVyeSB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIHNlYXJj\naCBzdHJpbmcKICAgICAqIEBwYXJhbSBzdGFydCBhIHF1ZXJ5IHZhbHVlIHJl\ncHJlc2VudGluZyB0aGUgc3RhcnQgaW5kZXgsIG9yIG51bGwKICAgICAqIHRv\nIHN0YXJ0IGF0IHRoZSBiZWdpbm5pbmcKICAgICAqLwogICAgcHVibGljIHZv\naWQgaW5kZXhPZihTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSBzdHIsIEZp\nbHRlclZhbHVlIGZpbmQsCiAgICAgICAgRmlsdGVyVmFsdWUgc3RhcnQpIHsK\nICAgICAgICBidWYuYXBwZW5kKCIoSU5TVFIoKCIpOwogICAgICAgIGlmIChz\ndGFydCAhPSBudWxsKQogICAgICAgICAgICBzdWJzdHJpbmcoYnVmLCBzdHIs\nIHN0YXJ0LCBudWxsKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0ci5h\ncHBlbmRUbyhidWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiksICgiKTsKICAg\nICAgICBmaW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgi\nKSkgLSAxIik7CiAgICAgICAgaWYgKHN0YXJ0ICE9IG51bGwpIHsKICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiICsgIik7CiAgICAgICAgICAgIHN0YXJ0LmFw\ncGVuZFRvKGJ1Zik7CiAgICAgICAgfQogICAgICAgIGJ1Zi5hcHBlbmQoIiki\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCB0aGUgbnVtZXJpYyBw\nYXJ0cyBvZiBhIG1hdGhlbWF0aWNhbCBmdW5jdGlvbi4KICAgICAqCiAgICAg\nKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRlIHRoZSBtYXRo\nIGZ1bmN0aW9uCiAgICAgKiBAcGFyYW0gb3AgdGhlIG1hdGhlbWF0aWNhbCBv\ncGVyYXRpb24gdG8gcGVyZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVm\ndCBoYW5kIHNpZGUgb2YgdGhlIG1hdGggZnVuY3Rpb24KICAgICAqIEBwYXJh\nbSByaHMgdGhlIHJpZ2h0IGhhbmQgc2lkZSBvZiB0aGUgbWF0aCBmdW5jdGlv\nbgogICAgICovCiAgICBwdWJsaWMgdm9pZCBtYXRoRnVuY3Rpb24oU1FMQnVm\nZmVyIGJ1ZiwgU3RyaW5nIG9wLCBGaWx0ZXJWYWx1ZSBsaHMsCiAgICAgICAg\nRmlsdGVyVmFsdWUgcmhzKSB7CiAgICAgICAgYm9vbGVhbiBjYXN0bGhzID0g\nZmFsc2U7CiAgICAgICAgYm9vbGVhbiBjYXN0cmhzID0gZmFsc2U7CiAgICAg\nICAgQ2xhc3MgbGMgPSBGaWx0ZXJzLndyYXAobGhzLmdldFR5cGUoKSk7CiAg\nICAgICAgQ2xhc3MgcmMgPSBGaWx0ZXJzLndyYXAocmhzLmdldFR5cGUoKSk7\nCiAgICAgICAgaW50IHR5cGUgPSAwOwogICAgICAgIGlmIChyZXF1aXJlc0Nh\nc3RGb3JNYXRoRnVuY3Rpb25zICYmIChsYyAhPSByYwogICAgICAgICAgICB8\nfCAobGhzLmlzQ29uc3RhbnQoKSAmJiByaHMuaXNDb25zdGFudCgpKSkpIHsK\nICAgICAgICAgICAgQ2xhc3MgYyA9IEZpbHRlcnMucHJvbW90ZShsYywgcmMp\nOwogICAgICAgICAgICB0eXBlID0gZ2V0SkRCQ1R5cGUoSmF2YVR5cGVzLmdl\ndFR5cGVDb2RlKGMpLCBmYWxzZSk7CiAgICAgICAgICAgIGlmICh0eXBlICE9\nIFR5cGVzLlZBUkJJTkFSWSAmJiB0eXBlICE9IFR5cGVzLkJMT0IpIHsKICAg\nICAgICAgICAgICAgIGNhc3RsaHMgPSAobGhzLmlzQ29uc3RhbnQoKSAmJiBy\naHMuaXNDb25zdGFudCgpKSB8fCBsYyAhPSBjOwogICAgICAgICAgICAgICAg\nY2FzdHJocyA9IChsaHMuaXNDb25zdGFudCgpICYmIHJocy5pc0NvbnN0YW50\nKCkpIHx8IHJjICE9IGM7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIGJvb2xlYW4gbW9kID0gIk1PRCIuZXF1YWxzKG9wKTsKICAgICAgICBp\nZiAobW9kKSB7CiAgICAgICAgICAgIGlmIChzdXBwb3J0c01vZE9wZXJhdG9y\nKQogICAgICAgICAgICAgICAgb3AgPSAiJSI7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQob3ApOwogICAgICAgIH0KICAg\nICAgICBidWYuYXBwZW5kKCIoIik7CgogICAgICAgIGlmIChjYXN0bGhzKQog\nICAgICAgICAgICBhcHBlbmRDYXN0KGJ1ZiwgbGhzLCB0eXBlKTsKICAgICAg\nICBlbHNlCiAgICAgICAgICAgIGxocy5hcHBlbmRUbyhidWYpOwoKICAgICAg\nICBpZiAobW9kICYmICFzdXBwb3J0c01vZE9wZXJhdG9yKQogICAgICAgICAg\nICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiICIpLmFwcGVuZChvcCkuYXBwZW5kKCIgIik7CgogICAg\nICAgIGlmIChjYXN0cmhzKQogICAgICAgICAgICBhcHBlbmRDYXN0KGJ1Ziwg\ncmhzLCB0eXBlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJocy5hcHBl\nbmRUbyhidWYpOwoKICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBcHBlbmQgYSBjb21wYXJpc29uLgogICAgICoKICAg\nICAqIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIGNv\nbXBhcmlzb24KICAgICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVy\nYXRpb24gdG8gcGVyZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVmdCBo\nYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24KICAgICAqIEBwYXJhbSByaHMg\ndGhlIHJpZ2h0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBjb21wYXJpc29uKFNRTEJ1ZmZlciBidWYsIFN0\ncmluZyBvcCwgRmlsdGVyVmFsdWUgbGhzLAogICAgICAgIEZpbHRlclZhbHVl\nIHJocykgewogICAgICAgIGJvb2xlYW4gY2FzdGxocyA9IGZhbHNlOwogICAg\nICAgIGJvb2xlYW4gY2FzdHJocyA9IGZhbHNlOwogICAgICAgIENsYXNzIGxj\nID0gRmlsdGVycy53cmFwKGxocy5nZXRUeXBlKCkpOwogICAgICAgIENsYXNz\nIHJjID0gRmlsdGVycy53cmFwKHJocy5nZXRUeXBlKCkpOwogICAgICAgIGlu\ndCB0eXBlID0gMDsKICAgICAgICBpZiAocmVxdWlyZXNDYXN0Rm9yQ29tcGFy\naXNvbnMgJiYgKGxjICE9IHJjCiAgICAgICAgICAgIHx8IChsaHMuaXNDb25z\ndGFudCgpICYmIHJocy5pc0NvbnN0YW50KCkpKSkgewogICAgICAgICAgICBD\nbGFzcyBjID0gRmlsdGVycy5wcm9tb3RlKGxjLCByYyk7CiAgICAgICAgICAg\nIHR5cGUgPSBnZXRKREJDVHlwZShKYXZhVHlwZXMuZ2V0VHlwZUNvZGUoYyks\nIGZhbHNlKTsKICAgICAgICAgICAgaWYgKHR5cGUgIT0gVHlwZXMuVkFSQklO\nQVJZICYmIHR5cGUgIT0gVHlwZXMuQkxPQikgewogICAgICAgICAgICAgICAg\nY2FzdGxocyA9IChsaHMuaXNDb25zdGFudCgpICYmIHJocy5pc0NvbnN0YW50\nKCkpIHx8IGxjICE9IGM7CiAgICAgICAgICAgICAgICBjYXN0cmhzID0gKGxo\ncy5pc0NvbnN0YW50KCkgJiYgcmhzLmlzQ29uc3RhbnQoKSkgfHwgcmMgIT0g\nYzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNhc3Rs\naHMpCiAgICAgICAgICAgIGFwcGVuZENhc3QoYnVmLCBsaHMsIHR5cGUpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgbGhzLmFwcGVuZFRvKGJ1Zik7Cgog\nICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQob3ApLmFwcGVuZCgiICIp\nOwoKICAgICAgICBpZiAoY2FzdHJocykKICAgICAgICAgICAgYXBwZW5kQ2Fz\ndChidWYsIHJocywgdHlwZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBy\naHMuYXBwZW5kVG8oYnVmKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVu\nZCBTUUwgZm9yIHRoZSBnaXZlbiBudW1lcmljIHZhbHVlIHRvIHRoZSBidWZm\nZXIsIGNhc3RpbmcgYXMgbmVlZGVkLgogICAgICovCiAgICBwcm90ZWN0ZWQg\ndm9pZCBhcHBlbmROdW1lcmljQ2FzdChTUUxCdWZmZXIgYnVmLCBGaWx0ZXJW\nYWx1ZSB2YWwpIHsKICAgICAgICBpZiAodmFsLmlzQ29uc3RhbnQoKSkKICAg\nICAgICAgICAgYXBwZW5kQ2FzdChidWYsIHZhbCwgVHlwZXMuTlVNRVJJQyk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICB2YWwuYXBwZW5kVG8oYnVmKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENhc3QgdGhlIHNwZWNpZmllZCB2YWx1\nZSB0byB0aGUgc3BlY2lmaWVkIHR5cGUuCiAgICAgKgogICAgICogQHBhcmFt\nIGJ1ZiB0aGUgYnVmZmVyIHRvIGFwcGVuZCB0aGUgY2FzdCB0bwogICAgICog\nQHBhcmFtIHZhbCB0aGUgdmFsdWUgdG8gY2FzdAogICAgICogQHBhcmFtIHR5\ncGUgdGhlIHR5cGUgb2YgdGhlIGNhc2UsIGUuZy4ge0BsaW5rIFR5cGVzI05V\nTUVSSUN9CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFwcGVuZENhc3QoU1FM\nQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgdmFsLCBpbnQgdHlwZSkgewogICAg\nICAgIC8vIENvbnZlcnQgdGhlIGNhc3QgZnVuY3Rpb246ICJDQVNUKHswfSBB\nUyB7MX0pIgogICAgICAgIGludCBmaXJzdFBhcmFtID0gY2FzdEZ1bmN0aW9u\nLmluZGV4T2YoInswfSIpOwogICAgICAgIFN0cmluZyBwcmUgPSBjYXN0RnVu\nY3Rpb24uc3Vic3RyaW5nKDAsIGZpcnN0UGFyYW0pOyAvLyAiQ0FTVCgiCiAg\nICAgICAgU3RyaW5nIG1pZCA9IGNhc3RGdW5jdGlvbi5zdWJzdHJpbmcoZmly\nc3RQYXJhbSArIDMpOwogICAgICAgIGludCBzZWNvbmRQYXJhbSA9IG1pZC5p\nbmRleE9mKCJ7MX0iKTsKICAgICAgICBTdHJpbmcgcG9zdDsKICAgICAgICBp\nZiAoc2Vjb25kUGFyYW0gPiAtMSkgewogICAgICAgICAgICBwb3N0ID0gbWlk\nLnN1YnN0cmluZyhzZWNvbmRQYXJhbSArIDMpOyAvLyAiKSIKICAgICAgICAg\nICAgbWlkID0gbWlkLnN1YnN0cmluZygwLCBzZWNvbmRQYXJhbSk7IC8vICIg\nQVMgIgogICAgICAgIH0gZWxzZQogICAgICAgICAgICBwb3N0ID0gIiI7Cgog\nICAgICAgIGJ1Zi5hcHBlbmQocHJlKTsKICAgICAgICB2YWwuYXBwZW5kVG8o\nYnVmKTsKICAgICAgICBidWYuYXBwZW5kKG1pZCk7CiAgICAgICAgYnVmLmFw\ncGVuZChnZXRUeXBlTmFtZSh0eXBlKSk7CiAgICAgICAgYnVmLmFwcGVuZChw\nb3N0KTsKICAgIH0KICAgIAogICAgLy8vLy8vLy8vLy8KICAgIC8vIERETCBT\nUUwKICAgIC8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBJbmNyZW1lbnQg\ndGhlIHJlZmVyZW5jZSBjb3VudCBvZiBhbnkgdGFibGUgY29tcG9uZW50cyB0\naGF0IHRoaXMKICAgICAqIGRpY3Rpb25hcnkgYWRkcyB0aGF0IGFyZSBub3Qg\ndXNlZCBieSBtYXBwaW5ncy4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHJlZlNjaGVtYUNvbXBvbmVudHMoVGFi\nbGUgdGFibGUpIHsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhl\nIGZ1bGwgbmFtZSBvZiB0aGUgdGFibGUsIGluY2x1ZGluZyB0aGUgc2NoZW1h\nIChkZWxpbWl0ZWQKICAgICAqIGJ5IHtAbGluayAjY2F0YWxvZ1NlcGFyYXRv\ncn0pLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZ1bGxOYW1lKFRh\nYmxlIHRhYmxlLCBib29sZWFuIGxvZ2ljYWwpIHsKICAgICAgICBpZiAoIXVz\nZVNjaGVtYU5hbWUgfHwgdGFibGUuZ2V0U2NoZW1hTmFtZSgpID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiB0YWJsZS5nZXROYW1lKCk7CiAgICAgICAg\naWYgKGxvZ2ljYWwgfHwgIi4iLmVxdWFscyhjYXRhbG9nU2VwYXJhdG9yKSkK\nICAgICAgICAgICAgcmV0dXJuIHRhYmxlLmdldEZ1bGxOYW1lKCk7CiAgICAg\nICAgcmV0dXJuIHRhYmxlLmdldFNjaGVtYU5hbWUoKSArIGNhdGFsb2dTZXBh\ncmF0b3IgKyB0YWJsZS5nZXROYW1lKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm5zIHRoZSBmdWxsIG5hbWUgb2YgdGhlIGluZGV4LCBpbmNsdWRp\nbmcgdGhlIHNjaGVtYSAoZGVsaW1pdGVkCiAgICAgKiBieSB0aGUgcmVzdWx0\nIG9mIHtAbGluayAjY2F0YWxvZ1NlcGFyYXRvcn0pLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldEZ1bGxOYW1lKEluZGV4IGluZGV4KSB7CiAgICAg\nICAgaWYgKCF1c2VTY2hlbWFOYW1lIHx8IGluZGV4LmdldFNjaGVtYU5hbWUo\nKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gaW5kZXguZ2V0TmFtZSgp\nOwogICAgICAgIGlmICgiLiIuZXF1YWxzKGNhdGFsb2dTZXBhcmF0b3IpKQog\nICAgICAgICAgICByZXR1cm4gaW5kZXguZ2V0RnVsbE5hbWUoKTsKICAgICAg\nICByZXR1cm4gaW5kZXguZ2V0U2NoZW1hTmFtZSgpICsgY2F0YWxvZ1NlcGFy\nYXRvciArIGluZGV4LmdldE5hbWUoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybnMgdGhlIGZ1bGwgbmFtZSBvZiB0aGUgc2VxdWVuY2UsIGluY2x1\nZGluZyB0aGUgc2NoZW1hIChkZWxpbWl0ZWQKICAgICAqIGJ5IHRoZSByZXN1\nbHQgb2Yge0BsaW5rICNjYXRhbG9nU2VwYXJhdG9yfSkuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0RnVsbE5hbWUoU2VxdWVuY2Ugc2VxKSB7CiAg\nICAgICAgaWYgKCF1c2VTY2hlbWFOYW1lIHx8IHNlcS5nZXRTY2hlbWFOYW1l\nKCkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHNlcS5nZXROYW1lKCk7\nCiAgICAgICAgaWYgKCIuIi5lcXVhbHMoY2F0YWxvZ1NlcGFyYXRvcikpCiAg\nICAgICAgICAgIHJldHVybiBzZXEuZ2V0RnVsbE5hbWUoKTsKICAgICAgICBy\nZXR1cm4gc2VxLmdldFNjaGVtYU5hbWUoKSArIGNhdGFsb2dTZXBhcmF0b3Ig\nKyBzZXEuZ2V0TmFtZSgpOwogICAgfQoKICAgIC8qKgogICAgICogTWFrZSBh\nbnkgbmVjZXNzYXJ5IGNoYW5nZXMgdG8gdGhlIGdpdmVuIHRhYmxlIG5hbWUg\ndG8gbWFrZSBpdCB2YWxpZAogICAgICogZm9yIHRoZSBjdXJyZW50IERCLgog\nICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbGlkVGFibGVOYW1lKFN0\ncmluZyBuYW1lLCBTY2hlbWEgc2NoZW1hKSB7CiAgICAgICAgd2hpbGUgKG5h\nbWUuc3RhcnRzV2l0aCgiXyIpKQogICAgICAgICAgICBuYW1lID0gbmFtZS5z\ndWJzdHJpbmcoMSk7CiAgICAgICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQobmFt\nZSwgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCksCiAgICAgICAgICAgIG1heFRh\nYmxlTmFtZUxlbmd0aCwgTkFNRV9UQUJMRSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBNYWtlIGFueSBuZWNlc3NhcnkgY2hhbmdlcyB0byB0aGUgZ2l2ZW4g\nc2VxdWVuY2UgbmFtZSB0byBtYWtlIGl0IHZhbGlkCiAgICAgKiBmb3IgdGhl\nIGN1cnJlbnQgREIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFs\naWRTZXF1ZW5jZU5hbWUoU3RyaW5nIG5hbWUsIFNjaGVtYSBzY2hlbWEpIHsK\nICAgICAgICB3aGlsZSAobmFtZS5zdGFydHNXaXRoKCJfIikpCiAgICAgICAg\nICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsKICAgICAgICByZXR1cm4g\nbWFrZU5hbWVWYWxpZCgiU18iICsgbmFtZSwgc2NoZW1hLmdldFNjaGVtYUdy\nb3VwKCksCiAgICAgICAgICAgIG1heFRhYmxlTmFtZUxlbmd0aCwgTkFNRV9T\nRVFVRU5DRSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYWtlIGFueSBuZWNl\nc3NhcnkgY2hhbmdlcyB0byB0aGUgZ2l2ZW4gY29sdW1uIG5hbWUgdG8gbWFr\nZSBpdCB2YWxpZAogICAgICogZm9yIHRoZSBjdXJyZW50IERCLgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbGlkQ29sdW1uTmFtZShTdHJpbmcg\nbmFtZSwgVGFibGUgdGFibGUpIHsKICAgICAgICB3aGlsZSAobmFtZS5zdGFy\ndHNXaXRoKCJfIikpCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmlu\nZygxKTsKICAgICAgICByZXR1cm4gbWFrZU5hbWVWYWxpZChuYW1lLCB0YWJs\nZSwgbWF4Q29sdW1uTmFtZUxlbmd0aCwgTkFNRV9BTlkpOwogICAgfQoKICAg\nIC8qKgogICAgICogTWFrZSBhbnkgbmVjZXNzYXJ5IGNoYW5nZXMgdG8gdGhl\nIGdpdmVuIHByaW1hcnkga2V5IG5hbWUgdG8gbWFrZSBpdAogICAgICogdmFs\naWQgZm9yIHRoZSBjdXJyZW50IERCLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGdldFZhbGlkUHJpbWFyeUtleU5hbWUoU3RyaW5nIG5hbWUsIFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgd2hpbGUgKG5hbWUuc3RhcnRzV2l0aCgiXyIp\nKQogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgICAg\nICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQoIlBfIiArIG5hbWUsIHRhYmxlLmdl\ndFNjaGVtYSgpLmdldFNjaGVtYUdyb3VwKCksCiAgICAgICAgICAgIG1heENv\nbnN0cmFpbnROYW1lTGVuZ3RoLCBOQU1FX0FOWSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBNYWtlIGFueSBuZWNlc3NhcnkgY2hhbmdlcyB0byB0aGUgZ2l2\nZW4gZm9yZWlnbiBrZXkgbmFtZSB0byBtYWtlIGl0CiAgICAgKiB2YWxpZCBm\nb3IgdGhlIGN1cnJlbnQgREIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0VmFsaWRGb3JlaWduS2V5TmFtZShTdHJpbmcgbmFtZSwgVGFibGUgdGFi\nbGUsCiAgICAgICAgVGFibGUgdG9UYWJsZSkgewogICAgICAgIHdoaWxlIChu\nYW1lLnN0YXJ0c1dpdGgoIl8iKSkKICAgICAgICAgICAgbmFtZSA9IG5hbWUu\nc3Vic3RyaW5nKDEpOwogICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSB0YWJs\nZS5nZXROYW1lKCk7CiAgICAgICAgaW50IGxlbiA9IE1hdGgubWluKHRhYmxl\nTmFtZS5sZW5ndGgoKSwgNyk7CiAgICAgICAgbmFtZSA9ICJGXyIgKyBzaG9y\ndGVuKHRhYmxlTmFtZSwgbGVuKSArICJfIiArIG5hbWU7CiAgICAgICAgcmV0\ndXJuIG1ha2VOYW1lVmFsaWQobmFtZSwgdGFibGUuZ2V0U2NoZW1hKCkuZ2V0\nU2NoZW1hR3JvdXAoKSwKICAgICAgICAgICAgbWF4Q29uc3RyYWludE5hbWVM\nZW5ndGgsIE5BTUVfQU5ZKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1ha2Ug\nYW55IG5lY2Vzc2FyeSBjaGFuZ2VzIHRvIHRoZSBnaXZlbiBpbmRleCBuYW1l\nIHRvIG1ha2UgaXQgdmFsaWQKICAgICAqIGZvciB0aGUgY3VycmVudCBEQi4K\nICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRWYWxpZEluZGV4TmFtZShT\ndHJpbmcgbmFtZSwgVGFibGUgdGFibGUpIHsKICAgICAgICB3aGlsZSAobmFt\nZS5zdGFydHNXaXRoKCJfIikpCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1\nYnN0cmluZygxKTsKICAgICAgICBTdHJpbmcgdGFibGVOYW1lID0gdGFibGUu\nZ2V0TmFtZSgpOwogICAgICAgIGludCBsZW4gPSBNYXRoLm1pbih0YWJsZU5h\nbWUubGVuZ3RoKCksIDcpOwogICAgICAgIG5hbWUgPSAiSV8iICsgc2hvcnRl\nbih0YWJsZU5hbWUsIGxlbikgKyAiXyIgKyBuYW1lOwogICAgICAgIHJldHVy\nbiBtYWtlTmFtZVZhbGlkKG5hbWUsIHRhYmxlLmdldFNjaGVtYSgpLmdldFNj\naGVtYUdyb3VwKCksCiAgICAgICAgICAgIG1heEluZGV4TmFtZUxlbmd0aCwg\nTkFNRV9BTlkpOwogICAgfQoKICAgIC8qKgogICAgICogTWFrZSBhbnkgbmVj\nZXNzYXJ5IGNoYW5nZXMgdG8gdGhlIGdpdmVuIHVuaXF1ZSBjb25zdHJhaW50\nIG5hbWUgdG8gbWFrZQogICAgICogaXQgdmFsaWQgZm9yIHRoZSBjdXJyZW50\nIERCLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbGlkVW5pcXVl\nTmFtZShTdHJpbmcgbmFtZSwgVGFibGUgdGFibGUpIHsKICAgICAgICB3aGls\nZSAobmFtZS5zdGFydHNXaXRoKCJfIikpCiAgICAgICAgICAgIG5hbWUgPSBu\nYW1lLnN1YnN0cmluZygxKTsKICAgICAgICBTdHJpbmcgdGFibGVOYW1lID0g\ndGFibGUuZ2V0TmFtZSgpOwogICAgICAgIGludCBsZW4gPSBNYXRoLm1pbih0\nYWJsZU5hbWUubGVuZ3RoKCksIDcpOwogICAgICAgIG5hbWUgPSAiVV8iICsg\nc2hvcnRlbih0YWJsZU5hbWUsIGxlbikgKyAiXyIgKyBuYW1lOwogICAgICAg\nIHJldHVybiBtYWtlTmFtZVZhbGlkKG5hbWUsIHRhYmxlLmdldFNjaGVtYSgp\nLmdldFNjaGVtYUdyb3VwKCksCiAgICAgICAgICAgIG1heENvbnN0cmFpbnRO\nYW1lTGVuZ3RoLCBOQU1FX0FOWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\naG9ydGVuIHRoZSBzcGVjaWZpZWQgbmFtZSB0byB0aGUgc3BlY2lmaWVkIHRh\ncmdldCBuYW1lLiBUaGlzIHdpbGwKICAgICAqIGJlIGRvbmUgYnkgZmlyc3Qg\nc3RyaXBwaW5nIG91dCB0aGUgdm93ZWxzLCBhbmQgdGhlbiByZW1vdmluZwog\nICAgICogY2hhcmFjdGVycyBmcm9tIHRoZSBtaWRkbGUgb2YgdGhlIHdvcmQg\ndW50aWwgaXQgcmVhY2hlcyB0aGUgdGFyZ2V0CiAgICAgKiBsZW5ndGguCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBzdGF0aWMgU3RyaW5nIHNob3J0ZW4oU3Ry\naW5nIG5hbWUsIGludCB0YXJnZXRMZW5ndGgpIHsKICAgICAgICBpZiAobmFt\nZSA9PSBudWxsIHx8IG5hbWUubGVuZ3RoKCkgPD0gdGFyZ2V0TGVuZ3RoKQog\nICAgICAgICAgICByZXR1cm4gbmFtZTsKCiAgICAgICAgU3RyaW5nQnVmZmVy\nIG5tID0gbmV3IFN0cmluZ0J1ZmZlcihuYW1lKTsKICAgICAgICB3aGlsZSAo\nbm0ubGVuZ3RoKCkgPiB0YXJnZXRMZW5ndGgpIHsKICAgICAgICAgICAgaWYg\nKCFzdHJpcFZvd2VsKG5tKSkgewogICAgICAgICAgICAgICAgLy8gY3V0IG91\ndCB0aGUgbWlkZGxlIGNoYXIKICAgICAgICAgICAgICAgIG5tLnJlcGxhY2Uo\nbm0ubGVuZ3RoKCkgLyAyLCAobm0ubGVuZ3RoKCkgLyAyKSArIDEsICIiKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbm0udG9T\ndHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB2b3dlbHMg\nZnJvbSB0aGUgc3BlY2lmaWVkIFN0cmluZ0J1ZmZlci4KICAgICAqCiAgICAg\nKiBAcmV0dXJuIHRydWUgaWYgYW55IHZvd2VscyBoYXZlIGJlZW4gcmVtb3Zl\nZAogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIHN0cmlwVm93\nZWwoU3RyaW5nQnVmZmVyIG5hbWUpIHsKICAgICAgICBpZiAobmFtZSA9PSBu\ndWxsIHx8IG5hbWUubGVuZ3RoKCkgPT0gMCkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwoKICAgICAgICBjaGFyW10gdm93ZWxzID0geyAnQScsICdFJywg\nJ0knLCAnTycsICdVJywgfTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHZvd2Vscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpbnQgaW5kZXgg\nPSBuYW1lLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKS5pbmRleE9mKHZvd2Vs\nc1tpXSk7CiAgICAgICAgICAgIGlmIChpbmRleCAhPSAtMSkgewogICAgICAg\nICAgICAgICAgbmFtZS5yZXBsYWNlKGluZGV4LCBpbmRleCArIDEsICIiKTsK\nICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNob3J0ZW5zIHRoZSBnaXZlbiBuYW1lIHRvIHRoZSBnaXZlbiBt\nYXhpbXVtIGxlbmd0aCwgdGhlbiBjaGVja3MgdGhhdAogICAgICogaXQgaXMg\nbm90IGEgcmVzZXJ2ZWQgd29yZC4gSWYgaXQgaXMgcmVzZXJ2ZWQsIGFwcGVu\nZHMgYSAiMCIuIElmCiAgICAgKiB0aGUgbmFtZSBjb25mbGljdHMgd2l0aCBh\nbiBleGlzdGluZyBzY2hlbWEgY29tcG9uZW50LCB0aGUgbGFzdAogICAgICog\nY2hhcmFjdGVyIGlzIHJlcGxhY2Ugd2l0aCAnMCcsIHRoZW4gJzEnLCBldGMu\nCiAgICAgKiBOb3RlIHRoYXQgdGhlIGdpdmVuIG1heCBsZW4gbWF5IGJlIDAg\naWYgdGhlIGRhdGFiYXNlIG1ldGFkYXRhIGlzCiAgICAgKiBpbmNvbXBsZXRl\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIG1ha2VOYW1lVmFsaWQo\nU3RyaW5nIG5hbWUsIE5hbWVTZXQgc2V0LCBpbnQgbWF4TGVuLAogICAgICAg\nIGludCBuYW1lVHlwZSkgewogICAgICAgIGlmIChtYXhMZW4gPCAxKQogICAg\nICAgICAgICBtYXhMZW4gPSAyNTU7CiAgICAgICAgaWYgKG5hbWUubGVuZ3Ro\nKCkgPiBtYXhMZW4pCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmlu\nZygwLCBtYXhMZW4pOwogICAgICAgIGlmIChyZXNlcnZlZFdvcmRTZXQuY29u\ndGFpbnMobmFtZS50b1VwcGVyQ2FzZSgpKSkgewogICAgICAgICAgICBpZiAo\nbmFtZS5sZW5ndGgoKSA9PSBtYXhMZW4pCiAgICAgICAgICAgICAgICBuYW1l\nID0gbmFtZS5zdWJzdHJpbmcoMCwgbmFtZS5sZW5ndGgoKSAtIDEpOwogICAg\nICAgICAgICBuYW1lICs9ICIwIjsKICAgICAgICB9CgogICAgICAgIC8vIG5v\ndyBtYWtlIHN1cmUgdGhlIG5hbWUgaXMgdW5pcXVlCiAgICAgICAgaWYgKHNl\ndCAhPSBudWxsKSB7CiAgICAgICAgICAgIG91dGVyOgogICAgICAgICAgICBm\nb3IgKGludCB2ZXJzaW9uID0gMSwgY2hhcnMgPSAxOyB0cnVlOyB2ZXJzaW9u\nKyspIHsKICAgICAgICAgICAgICAgIC8vIGZvciB0YWJsZSBuYW1lcywgd2Ug\nY2hlY2sgZm9yIHRoZSB0YWJsZSBpdHNlbGYgaW4gY2FzZSB0aGUKICAgICAg\nICAgICAgICAgIC8vIG5hbWUgc2V0IGlzIGxhenkgYWJvdXQgc2NoZW1hIHJl\nZmxlY3Rpb24KICAgICAgICAgICAgICAgIHN3aXRjaCAobmFtZVR5cGUpIHsK\nICAgICAgICAgICAgICAgICAgICBjYXNlIE5BTUVfVEFCTEU6CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmICghKChTY2hlbWFHcm91cCkgc2V0KS5pc0tu\nb3duVGFibGUobmFtZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBi\ncmVhayBvdXRlcjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICAgICAgY2FzZSBOQU1FX1NFUVVFTkNFOgogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoISgoU2NoZW1hR3JvdXApIHNldCkuaXNL\nbm93blNlcXVlbmNlKG5hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWsgb3V0ZXI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAg\nICAgICAgICAgIGlmICghc2V0LmlzTmFtZVRha2VuKG5hbWUpKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgYnJlYWsgb3V0ZXI7CiAgICAgICAgICAg\nICAgICB9CgogICAgICAgICAgICAgICAgLy8gYSBzaW5nbGUgY2hhciBmb3Ig\ndGhlIHZlcnNpb24gaXMgcHJvYmFibHkgZW5vdWdoLCBidXQgbWlnaHQKICAg\nICAgICAgICAgICAgIC8vIGFzIHdlbGwgYmUgZ2VuZXJhbCBhYm91dCBpdC4u\nLgogICAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPiAxKQogICAgICAgICAg\nICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0\naCgpIC0gY2hhcnMpOwogICAgICAgICAgICAgICAgaWYgKHZlcnNpb24gPj0g\nTWF0aC5wb3coMTAsIGNoYXJzKSkKICAgICAgICAgICAgICAgICAgICBjaGFy\ncysrOwogICAgICAgICAgICAgICAgaWYgKG5hbWUubGVuZ3RoKCkgKyBjaGFy\ncyA+IG1heExlbikKICAgICAgICAgICAgICAgICAgICBuYW1lID0gbmFtZS5z\ndWJzdHJpbmcoMCwgbWF4TGVuIC0gY2hhcnMpOwogICAgICAgICAgICAgICAg\nbmFtZSA9IG5hbWUgKyB2ZXJzaW9uOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBuYW1lLnRvVXBwZXJDYXNlKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzZXJpZXMgb2YgU1FMIHN0YXRlbWVu\ndHMgdG8gY3JlYXRlIHRoZSBnaXZlbiB0YWJsZSwgY29tcGxldGUKICAgICAq\nIHdpdGggY29sdW1ucy4gSW5kZXhlcyBhbmQgY29uc3RyYWludHMgd2lsbCBi\nZSBjcmVhdGVkIHNlcGFyYXRlbHkuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJp\nbmdbXSBnZXRDcmVhdGVUYWJsZVNRTChUYWJsZSB0YWJsZSkgewogICAgICAg\nIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAg\nICAgYnVmLmFwcGVuZCgiQ1JFQVRFIFRBQkxFICIpLmFwcGVuZChnZXRGdWxs\nTmFtZSh0YWJsZSwgZmFsc2UpKS4KICAgICAgICAgICAgYXBwZW5kKCIgKCIp\nOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0gdGFibGUuZ2V0Q29sdW1ucygp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBpZiAoaSA+IDApCiAgICAgICAgICAgICAgICBi\ndWYuYXBwZW5kKCIsICIpOwogICAgICAgICAgICBidWYuYXBwZW5kKGdldERl\nY2xhcmVDb2x1bW5TUUwoY29sc1tpXSwgZmFsc2UpKTsKICAgICAgICB9Cgog\nICAgICAgIFByaW1hcnlLZXkgcGsgPSB0YWJsZS5nZXRQcmltYXJ5S2V5KCk7\nCiAgICAgICAgU3RyaW5nIHBrU3RyOwogICAgICAgIGlmIChwayAhPSBudWxs\nKSB7CiAgICAgICAgICAgIHBrU3RyID0gZ2V0UHJpbWFyeUtleUNvbnN0cmFp\nbnRTUUwocGspOwogICAgICAgICAgICBpZiAocGtTdHIgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwgIikuYXBwZW5kKHBrU3RyKTsK\nICAgICAgICB9CgogICAgICAgIFVuaXF1ZVtdIHVucXMgPSB0YWJsZS5nZXRV\nbmlxdWVzKCk7CiAgICAgICAgU3RyaW5nIHVucVN0cjsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHVucXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgdW5xU3RyID0gZ2V0VW5pcXVlQ29uc3RyYWludFNRTCh1bnFzW2ldKTsK\nICAgICAgICAgICAgaWYgKHVucVN0ciAhPSBudWxsKQogICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiLCAiKS5hcHBlbmQodW5xU3RyKTsKICAgICAgICB9\nCgogICAgICAgIGJ1Zi5hcHBlbmQoIikiKTsKICAgICAgICByZXR1cm4gbmV3\nIFN0cmluZ1tdeyBidWYudG9TdHJpbmcoKSB9OwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIGEgc2VyaWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRvIGRy\nb3AgdGhlIGdpdmVuIHRhYmxlLiBJbmRleGVzCiAgICAgKiB3aWxsIGJlIGRy\nb3BwZWQgc2VwYXJhdGVseS4gUmV0dXJucwogICAgICogPGNvZGU+RFJPUCBU\nQUJMRSAmbHQ7dGFibGUgbmFtZSZndDs8L2NvZGU+IGJ5IGRlZmF1bHQuCiAg\nICAgKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wVGFibGVTUUwoVGFi\nbGUgdGFibGUpIHsKICAgICAgICBTdHJpbmcgZHJvcCA9IE1lc3NhZ2VGb3Jt\nYXQuZm9ybWF0KGRyb3BUYWJsZVNRTCwgbmV3IE9iamVjdFtdewogICAgICAg\nICAgICBnZXRGdWxsTmFtZSh0YWJsZSwgZmFsc2UpIH0pOwogICAgICAgIHJl\ndHVybiBuZXcgU3RyaW5nW117IGRyb3AgfTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBjcmVh\ndGUgdGhlIGdpdmVuIHNlcXVlbmNlLiBSZXR1cm5zCiAgICAgKiA8Y29kZT5D\nUkVBVEUgU0VRVUVOQ0UgJmx0O3NlcXVlbmNlIG5hbWUmZ3Q7WyBTVEFSVCBX\nSVRIICZsdDtzdGFydCZndDtdCiAgICAgKiBbIElOQ1JFTUVOVCBCWSAmbHQ7\naW5jcmVtZW50Jmd0O108L2NvZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVTZXF1ZW5jZVNRTChTZXF1ZW5j\nZSBzZXEpIHsKICAgICAgICBpZiAobmV4dFNlcXVlbmNlUXVlcnkgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIFN0cmluZ0J1\nZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgYnVmLmFw\ncGVuZCgiQ1JFQVRFIFNFUVVFTkNFICIpOwogICAgICAgIGJ1Zi5hcHBlbmQo\nZ2V0RnVsbE5hbWUoc2VxKSk7CiAgICAgICAgaWYgKHNlcS5nZXRJbml0aWFs\nVmFsdWUoKSAhPSAwKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgU1RBUlQg\nV0lUSCAiKS5hcHBlbmQoc2VxLmdldEluaXRpYWxWYWx1ZSgpKTsKICAgICAg\nICBpZiAoc2VxLmdldEluY3JlbWVudCgpID4gMSkKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiIElOQ1JFTUVOVCBCWSAiKS5hcHBlbmQoc2VxLmdldEluY3Jl\nbWVudCgpKTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyBidWYudG9T\ndHJpbmcoKSB9OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgc2Vy\naWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRvIGRyb3AgdGhlIGdpdmVuIHNlcXVl\nbmNlLiBSZXR1cm5zCiAgICAgKiA8Y29kZT5EUk9QIFNFUVVFTkNFICZsdDtz\nZXF1ZW5jZSBuYW1lJmd0OzwvY29kZT4gYnkgZGVmYXVsdC4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZ1tdIGdldERyb3BTZXF1ZW5jZVNRTChTZXF1ZW5j\nZSBzZXEpIHsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiRFJPUCBT\nRVFVRU5DRSAiICsgZ2V0RnVsbE5hbWUoc2VxKSB9OwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIGEgc2VyaWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRv\nIGNyZWF0ZSB0aGUgZ2l2ZW4gaW5kZXguIFJldHVybnMKICAgICAqIDxjb2Rl\nPkNSRUFURSBbVU5JUVVFXSBJTkRFWCAmbHQ7aW5kZXggbmFtZSZndDsgT04g\nJmx0O3RhYmxlIG5hbWUmZ3Q7CiAgICAgKiAoJmx0O2NvbCBsaXN0Jmd0Oyk8\nL2NvZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdb\nXSBnZXRDcmVhdGVJbmRleFNRTChJbmRleCBpbmRleCkgewogICAgICAgIFN0\ncmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAg\nYnVmLmFwcGVuZCgiQ1JFQVRFICIpOwogICAgICAgIGlmIChpbmRleC5pc1Vu\naXF1ZSgpKQogICAgICAgICAgICBidWYuYXBwZW5kKCJVTklRVUUgIik7CiAg\nICAgICAgYnVmLmFwcGVuZCgiSU5ERVggIikuYXBwZW5kKGluZGV4LmdldE5h\nbWUoKSk7CgogICAgICAgIGJ1Zi5hcHBlbmQoIiBPTiAiKS5hcHBlbmQoZ2V0\nRnVsbE5hbWUoaW5kZXguZ2V0VGFibGUoKSwgZmFsc2UpKTsKICAgICAgICBi\ndWYuYXBwZW5kKCIgKCIpLmFwcGVuZChTdHJpbmdzLmpvaW4oaW5kZXguZ2V0\nQ29sdW1ucygpLCAiLCAiKSkuCiAgICAgICAgICAgIGFwcGVuZCgiKSIpOwoK\nICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyBidWYudG9TdHJpbmcoKSB9\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgc2VyaWVzIG9mIFNR\nTCBzdGF0ZW1lbnRzIHRvIGRyb3AgdGhlIGdpdmVuIGluZGV4LiBSZXR1cm5z\nCiAgICAgKiA8Y29kZT5EUk9QIElOREVYICZsdDtpbmRleCBuYW1lJmd0Ozwv\nY29kZT4gYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1td\nIGdldERyb3BJbmRleFNRTChJbmRleCBpbmRleCkgewogICAgICAgIHJldHVy\nbiBuZXcgU3RyaW5nW117ICJEUk9QIElOREVYICIgKyBnZXRGdWxsTmFtZShp\nbmRleCkgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNlcmll\ncyBvZiBTUUwgc3RhdGVtZW50cyB0byBhZGQgdGhlIGdpdmVuIGNvbHVtbiB0\nbwogICAgICogaXRzIHRhYmxlLiBSZXR1cm4gYW4gZW1wdHkgYXJyYXkgaWYg\nb3BlcmF0aW9uIG5vdCBzdXBwb3J0ZWQuIFJldHVybnMKICAgICAqIDxjb2Rl\nPkFMVEVSIFRBQkxFICZsdDt0YWJsZSBuYW1lJmd0OyBBREQgKCZsdDtjb2wg\nZGVjJmd0Oyk8L2NvZGU+CiAgICAgKiBieSBkZWZhdWx0LgogICAgICovCiAg\nICBwdWJsaWMgU3RyaW5nW10gZ2V0QWRkQ29sdW1uU1FMKENvbHVtbiBjb2x1\nbW4pIHsKICAgICAgICBpZiAoIXN1cHBvcnRzQWx0ZXJUYWJsZVdpdGhBZGRD\nb2x1bW4pCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwoKICAg\nICAgICBTdHJpbmcgZGVjID0gZ2V0RGVjbGFyZUNvbHVtblNRTChjb2x1bW4s\nIHRydWUpOwogICAgICAgIGlmIChkZWMgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBTdHJpbmdbMF07CiAgICAgICAgcmV0dXJuIG5ldyBTdHJp\nbmdbXXsgIkFMVEVSIFRBQkxFICIKICAgICAgICAgICAgKyBnZXRGdWxsTmFt\nZShjb2x1bW4uZ2V0VGFibGUoKSwgZmFsc2UpICsgIiBBREQgIiArIGRlYyB9\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgc2VyaWVzIG9mIFNR\nTCBzdGF0ZW1lbnRzIHRvIGRyb3AgdGhlIGdpdmVuIGNvbHVtbiBmcm9tCiAg\nICAgKiBpdHMgdGFibGUuIFJldHVybiBhbiBlbXB0eSBhcnJheSBpZiBvcGVy\nYXRpb24gbm90IHN1cHBvcnRlZC4gUmV0dXJucwogICAgICogPGNvZGU+QUxU\nRVIgVEFCTEUgJmx0O3RhYmxlIG5hbWUmZ3Q7IERST1AgQ09MVU1OICZsdDtj\nb2wgbmFtZSZndDs8L2NvZGU+CiAgICAgKiBieSBkZWZhdWx0LgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RHJvcENvbHVtblNRTChDb2x1bW4g\nY29sdW1uKSB7CiAgICAgICAgaWYgKCFzdXBwb3J0c0FsdGVyVGFibGVXaXRo\nRHJvcENvbHVtbikKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbMF07\nCiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkFMVEVSIFRBQkxFICIK\nICAgICAgICAgICAgKyBnZXRGdWxsTmFtZShjb2x1bW4uZ2V0VGFibGUoKSwg\nZmFsc2UpCiAgICAgICAgICAgICsgIiBEUk9QIENPTFVNTiAiICsgY29sdW1u\nIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzZXJpZXMgb2Yg\nU1FMIHN0YXRlbWVudHMgdG8gYWRkIHRoZSBnaXZlbiBwcmltYXJ5IGtleSB0\nbwogICAgICogaXRzIHRhYmxlLiBSZXR1cm4gYW4gZW1wdHkgYXJyYXkgaWYg\nb3BlcmF0aW9uIG5vdCBzdXBwb3J0ZWQuCiAgICAgKiBSZXR1cm5zIDxjb2Rl\nPkFMVEVSIFRBQkxFICZsdDt0YWJsZSBuYW1lJmd0OyBBREQKICAgICAqICZs\ndDtwayBjb25zIHNxbCAmZ3Q7PC9jb2RlPiBieSBkZWZhdWx0LgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0QWRkUHJpbWFyeUtleVNRTChQcmlt\nYXJ5S2V5IHBrKSB7CiAgICAgICAgU3RyaW5nIHBrc3FsID0gZ2V0UHJpbWFy\neUtleUNvbnN0cmFpbnRTUUwocGspOwogICAgICAgIGlmIChwa3NxbCA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1swXTsKICAgICAg\nICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiQUxURVIgVEFCTEUgIgogICAgICAg\nICAgICArIGdldEZ1bGxOYW1lKHBrLmdldFRhYmxlKCksIGZhbHNlKSArICIg\nQUREICIgKyBwa3NxbCB9OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIGEgc2VyaWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRvIGRyb3AgdGhlIGdpdmVu\nIHByaW1hcnkga2V5IGZyb20KICAgICAqIGl0cyB0YWJsZS4gUmV0dXJuIGFu\nIGVtcHR5IGFycmF5IGlmIG9wZXJhdGlvbiBub3Qgc3VwcG9ydGVkLgogICAg\nICogUmV0dXJucyA8Y29kZT5BTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFtZSZn\ndDsgRFJPUCBDT05TVFJBSU5UCiAgICAgKiAmbHQ7cGsgbmFtZSZndDs8L2Nv\nZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBn\nZXREcm9wUHJpbWFyeUtleVNRTChQcmltYXJ5S2V5IHBrKSB7CiAgICAgICAg\naWYgKHBrLmdldE5hbWUoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nbmV3IFN0cmluZ1swXTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAi\nQUxURVIgVEFCTEUgIgogICAgICAgICAgICArIGdldEZ1bGxOYW1lKHBrLmdl\ndFRhYmxlKCksIGZhbHNlKQogICAgICAgICAgICArICIgRFJPUCBDT05TVFJB\nSU5UICIgKyBway5nZXROYW1lKCkgfTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBhZGQgdGhl\nIGdpdmVuIGZvcmVpZ24ga2V5IHRvCiAgICAgKiBpdHMgdGFibGUuIFJldHVy\nbiBhbiBlbXB0eSBhcnJheSBpZiBvcGVyYXRpb24gbm90IHN1cHBvcnRlZC4K\nICAgICAqIFJldHVybnMgPGNvZGU+QUxURVIgVEFCTEUgJmx0O3RhYmxlIG5h\nbWUmZ3Q7IEFERAogICAgICogJmx0O2ZrIGNvbnMgc3FsICZndDs8L2NvZGU+\nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRB\nZGRGb3JlaWduS2V5U1FMKEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBTdHJp\nbmcgZmtTUUwgPSBnZXRGb3JlaWduS2V5Q29uc3RyYWludFNRTChmayk7CiAg\nICAgICAgaWYgKGZrU1FMID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\nZXcgU3RyaW5nWzBdOwogICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJB\nTFRFUiBUQUJMRSAiCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUoZmsuZ2V0\nVGFibGUoKSwgZmFsc2UpICsgIiBBREQgIiArIGZrU1FMIH07CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzZXJpZXMgb2YgU1FMIHN0YXRlbWVu\ndHMgdG8gZHJvcCB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkgZnJvbQogICAgICog\naXRzIHRhYmxlLiBSZXR1cm4gYW4gZW1wdHkgYXJyYXkgaWYgb3BlcmF0aW9u\nIG5vdCBzdXBwb3J0ZWQuCiAgICAgKiBSZXR1cm5zIDxjb2RlPkFMVEVSIFRB\nQkxFICZsdDt0YWJsZSBuYW1lJmd0OyBEUk9QIENPTlNUUkFJTlQKICAgICAq\nICZsdDtmayBuYW1lJmd0OzwvY29kZT4gYnkgZGVmYXVsdC4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZ1tdIGdldERyb3BGb3JlaWduS2V5U1FMKEZvcmVp\nZ25LZXkgZmspIHsKICAgICAgICBpZiAoZmsuZ2V0TmFtZSgpID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAgIHJl\ndHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAgICAgICAg\nICsgZ2V0RnVsbE5hbWUoZmsuZ2V0VGFibGUoKSwgZmFsc2UpCiAgICAgICAg\nICAgICsgIiBEUk9QIENPTlNUUkFJTlQgIiArIGZrLmdldE5hbWUoKSB9Owog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBkZWNsYXJhdGlvbiBT\nUUwgZm9yIHRoZSBnaXZlbiBjb2x1bW4uIFRoaXMgbWV0aG9kIGlzIHVzZWQK\nICAgICAqIGZvciBlYWNoIGNvbHVtbiBmcm9tIHdpdGhpbiB7QGxpbmsgI2dl\ndENyZWF0ZVRhYmxlU1FMfSBhbmQKICAgICAqIHtAbGluayAjZ2V0QWRkQ29s\ndW1uU1FMfS4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXREZWNs\nYXJlQ29sdW1uU1FMKENvbHVtbiBjb2wsIGJvb2xlYW4gYWx0ZXIpIHsKICAg\nICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwog\nICAgICAgIGJ1Zi5hcHBlbmQoY29sKS5hcHBlbmQoIiAiKTsKICAgICAgICBi\ndWYuYXBwZW5kKGdldFR5cGVOYW1lKGNvbCkpOwoKICAgICAgICAvLyBjYW4n\ndCBhZGQgY29uc3RyYWludHMgdG8gYSBjb2x1bW4gd2UncmUgYWRkaW5nIGFm\ndGVyIHRhYmxlCiAgICAgICAgLy8gY3JlYXRpb24sIGNhdXNlIHNvbWUgZGF0\nYSBtaWdodCBhbHJlYWR5IGJlIGluc2VydGVkCiAgICAgICAgaWYgKCFhbHRl\ncikgewogICAgICAgICAgICBpZiAoY29sLmdldERlZmF1bHRTdHJpbmcoKSAh\nPSBudWxsICYmICFjb2wuaXNBdXRvQXNzaWduZWQoKSkKICAgICAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIiBERUZBVUxUICIpLmFwcGVuZChjb2wuZ2V0RGVm\nYXVsdFN0cmluZygpKTsKICAgICAgICAgICAgaWYgKGNvbC5pc05vdE51bGwo\nKSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBOT1QgTlVMTCIpOwog\nICAgICAgIH0KICAgICAgICBpZiAoY29sLmlzQXV0b0Fzc2lnbmVkKCkpIHsK\nICAgICAgICAgICAgaWYgKCFzdXBwb3J0c0F1dG9Bc3NpZ24pCiAgICAgICAg\nICAgICAgICBsb2cud2FybihfbG9jLmdldCgiaW52YWxpZC1hdXRvYXNzaWdu\nIiwgcGxhdGZvcm0sIGNvbCkpOwogICAgICAgICAgICBlbHNlIGlmIChhdXRv\nQXNzaWduQ2xhdXNlICE9IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCIgIikuYXBwZW5kKGF1dG9Bc3NpZ25DbGF1c2UpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIGRlY2xhcmF0aW9uIFNRTCBmb3IgdGhlIGdp\ndmVuIHByaW1hcnkga2V5LiBUaGlzIG1ldGhvZCBpcwogICAgICogdXNlZCBm\ncm9tIHdpdGhpbiB7QGxpbmsgI2dldENyZWF0ZVRhYmxlU1FMfSBhbmQKICAg\nICAqIHtAbGluayAjZ2V0QWRkUHJpbWFyeUtleVNRTH0uIFJldHVybnMKICAg\nICAqIDxjb2RlPkNPTlNUUkFJTlQgJmx0O3BrIG5hbWUmZ3Q7IFBSSU1BUlkg\nS0VZICgmbHQ7Y29sIGxpc3QmZ3Q7KTwvY29kZT4KICAgICAqIGJ5IGRlZmF1\nbHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0UHJpbWFyeUtl\neUNvbnN0cmFpbnRTUUwoUHJpbWFyeUtleSBwaykgewogICAgICAgIC8vIGlm\nIHdlIGhhdmUgZGlzYWJsZWQgdGhlIGNyZWF0aW9uIG9mIHByaW1hcnkga2V5\ncywgYWJvcnQgaGVyZQogICAgICAgIGlmICghY3JlYXRlUHJpbWFyeUtleXMp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmcgbmFt\nZSA9IHBrLmdldE5hbWUoKTsKICAgICAgICBpZiAobmFtZSAhPSBudWxsICYm\nIHJlc2VydmVkV29yZFNldC5jb250YWlucyhuYW1lLnRvVXBwZXJDYXNlKCkp\nKQogICAgICAgICAgICBuYW1lID0gbnVsbDsKCiAgICAgICAgU3RyaW5nQnVm\nZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBpZiAobmFt\nZSAhPSBudWxsICYmIENPTlNfTkFNRV9CRUZPUkUuZXF1YWxzKGNvbnN0cmFp\nbnROYW1lTW9kZSkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIkNPTlNUUkFJ\nTlQgIikuYXBwZW5kKG5hbWUpLmFwcGVuZCgiICIpOwogICAgICAgIGJ1Zi5h\ncHBlbmQoIlBSSU1BUlkgS0VZICIpOwogICAgICAgIGlmIChuYW1lICE9IG51\nbGwgJiYgQ09OU19OQU1FX01JRC5lcXVhbHMoY29uc3RyYWludE5hbWVNb2Rl\nKSkKICAgICAgICAgICAgYnVmLmFwcGVuZChuYW1lKS5hcHBlbmQoIiAiKTsK\nICAgICAgICBidWYuYXBwZW5kKCIoIikuYXBwZW5kKFN0cmluZ3Muam9pbihw\nay5nZXRDb2x1bW5zKCksICIsICIpKS4KICAgICAgICAgICAgYXBwZW5kKCIp\nIik7CiAgICAgICAgaWYgKG5hbWUgIT0gbnVsbCAmJiBDT05TX05BTUVfQUZU\nRVIuZXF1YWxzKGNvbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiBDT05TVFJBSU5UICIpLmFwcGVuZChuYW1lKTsKICAgICAg\nICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIGRlY2xhcmF0aW9uIFNRTCBmb3IgdGhlIGdpdmVuIGZv\ncmVpZ24ga2V5LCBvciBudWxsIGlmIGl0IGlzCiAgICAgKiBub3Qgc3VwcG9y\ndGVkLiBUaGlzIG1ldGhvZCBpcyB1c2VkIGZyb20gd2l0aGluCiAgICAgKiB7\nQGxpbmsgI2dldENyZWF0ZVRhYmxlU1FMfSBhbmQge0BsaW5rICNnZXRBZGRG\nb3JlaWduS2V5U1FMfS4gUmV0dXJucwogICAgICogPGNvZGU+Q09OU1RSQUlO\nVCAmbHQ7Y29ucyBuYW1lJmd0OyBGT1JFSUdOIEtFWSAoJmx0O2NvbCBsaXN0\nJmd0OykKICAgICAqIFJFRkVSRU5DRVMgJmx0O2ZvcmVpZ24gdGFibGUmZ3Q7\nICgmbHQ7Y29sIGxpc3QmZ3Q7KQogICAgICogW09OIERFTEVURSAmbHQ7YWN0\naW9uJmd0O10gW09OIFVQREFURSAmbHQ7YWN0aW9uJmd0O108L2NvZGU+IGJ5\nIGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Rm9y\nZWlnbktleUNvbnN0cmFpbnRTUUwoRm9yZWlnbktleSBmaykgewogICAgICAg\nIGlmICghc3VwcG9ydHNGb3JlaWduS2V5cykKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgaWYgKGZrLmdldERlbGV0ZUFjdGlvbigpID09IEZv\ncmVpZ25LZXkuQUNUSU9OX05PTkUpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIGlmIChmay5pc0RlZmVycmVkKCkgJiYgIXN1cHBvcnRzRGVm\nZXJyZWRDb25zdHJhaW50cykKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgaWYgKCFzdXBwb3J0c0RlbGV0ZUFjdGlvbihmay5nZXREZWxldGVB\nY3Rpb24oKSkKICAgICAgICAgICAgfHwgIXN1cHBvcnRzVXBkYXRlQWN0aW9u\nKGZrLmdldFVwZGF0ZUFjdGlvbigpKSkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CgogICAgICAgIENvbHVtbltdIGxvY2FscyA9IGZrLmdldENvbHVtbnMo\nKTsKICAgICAgICBDb2x1bW5bXSBmb3JlaWducyA9IGZrLmdldFByaW1hcnlL\nZXlDb2x1bW5zKCk7CgogICAgICAgIGludCBkZWxBY3Rpb25JZCA9IGZrLmdl\ndERlbGV0ZUFjdGlvbigpOwogICAgICAgIGlmIChkZWxBY3Rpb25JZCA9PSBG\nb3JlaWduS2V5LkFDVElPTl9OVUxMKSB7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbG9jYWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nICAgICBpZiAobG9jYWxzW2ldLmlzTm90TnVsbCgpKQogICAgICAgICAgICAg\nICAgICAgIGRlbEFjdGlvbklkID0gRm9yZWlnbktleS5BQ1RJT05fTk9ORTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgU3RyaW5nIGRlbEFj\ndGlvbiA9IGdldEFjdGlvbk5hbWUoZGVsQWN0aW9uSWQpOwogICAgICAgIFN0\ncmluZyB1cEFjdGlvbiA9IGdldEFjdGlvbk5hbWUoZmsuZ2V0VXBkYXRlQWN0\naW9uKCkpOwoKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmlu\nZ0J1ZmZlcigpOwogICAgICAgIGlmIChmay5nZXROYW1lKCkgIT0gbnVsbAog\nICAgICAgICAgICAmJiBDT05TX05BTUVfQkVGT1JFLmVxdWFscyhjb25zdHJh\naW50TmFtZU1vZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKCJDT05TVFJB\nSU5UICIpLmFwcGVuZChmay5nZXROYW1lKCkpLmFwcGVuZCgiICIpOwogICAg\nICAgIGJ1Zi5hcHBlbmQoIkZPUkVJR04gS0VZICIpOwogICAgICAgIGlmIChm\nay5nZXROYW1lKCkgIT0gbnVsbCAmJiBDT05TX05BTUVfTUlELmVxdWFscyhj\nb25zdHJhaW50TmFtZU1vZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKGZr\nLmdldE5hbWUoKSkuYXBwZW5kKCIgIik7CiAgICAgICAgYnVmLmFwcGVuZCgi\nKCIpLmFwcGVuZChTdHJpbmdzLmpvaW4obG9jYWxzLCAiLCAiKSkuYXBwZW5k\nKCIpIik7CiAgICAgICAgYnVmLmFwcGVuZCgiIFJFRkVSRU5DRVMgIik7CiAg\nICAgICAgYnVmLmFwcGVuZChnZXRGdWxsTmFtZShmb3JlaWduc1swXS5nZXRU\nYWJsZSgpLCBmYWxzZSkpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiAoIikuYXBw\nZW5kKFN0cmluZ3Muam9pbihmb3JlaWducywgIiwgIikpLmFwcGVuZCgiKSIp\nOwogICAgICAgIGlmIChkZWxBY3Rpb24gIT0gbnVsbCkKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIE9OIERFTEVURSAiKS5hcHBlbmQoZGVsQWN0aW9uKTsK\nICAgICAgICBpZiAodXBBY3Rpb24gIT0gbnVsbCkKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiIE9OIFVQREFURSAiKS5hcHBlbmQodXBBY3Rpb24pOwogICAg\nICAgIGlmIChmay5pc0RlZmVycmVkKCkpCiAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiBJTklUSUFMTFkgREVGRVJSRUQiKTsKICAgICAgICBpZiAoc3VwcG9y\ndHNEZWZlcnJlZENvbnN0cmFpbnRzKQogICAgICAgICAgICBidWYuYXBwZW5k\nKCIgREVGRVJSQUJMRSIpOwogICAgICAgIGlmIChmay5nZXROYW1lKCkgIT0g\nbnVsbAogICAgICAgICAgICAmJiBDT05TX05BTUVfQUZURVIuZXF1YWxzKGNv\nbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBD\nT05TVFJBSU5UICIpLmFwcGVuZChmay5nZXROYW1lKCkpOwogICAgICAgIHJl\ndHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgbmFtZSBvZiB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkgYWN0aW9u\nLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRBY3Rpb25OYW1lKGlu\ndCBhY3Rpb24pIHsKICAgICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAg\nICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX0NBU0NBREU6CiAgICAgICAg\nICAgICAgICByZXR1cm4gIkNBU0NBREUiOwogICAgICAgICAgICBjYXNlIEZv\ncmVpZ25LZXkuQUNUSU9OX05VTEw6CiAgICAgICAgICAgICAgICByZXR1cm4g\nIlNFVCBOVUxMIjsKICAgICAgICAgICAgY2FzZSBGb3JlaWduS2V5LkFDVElP\nTl9ERUZBVUxUOgogICAgICAgICAgICAgICAgcmV0dXJuICJTRVQgREVGQVVM\nVCI7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIHRoaXMgZGF0YWJhc2Ugc3VwcG9ydHMgdGhlIGdpdmVuIGZvcmVpZ24g\na2V5IGRlbGV0ZSBhY3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIHN1cHBvcnRzRGVsZXRlQWN0aW9uKGludCBhY3Rpb24pIHsKICAgICAgICBp\nZiAoYWN0aW9uID09IEZvcmVpZ25LZXkuQUNUSU9OX05PTkUpCiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmICghc3VwcG9ydHNGb3JlaWdu\nS2V5cykKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHN3aXRj\naCAoYWN0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgRm9yZWlnbktleS5BQ1RJ\nT05fUkVTVFJJQ1Q6CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNS\nZXN0cmljdERlbGV0ZUFjdGlvbjsKICAgICAgICAgICAgY2FzZSBGb3JlaWdu\nS2V5LkFDVElPTl9DQVNDQURFOgogICAgICAgICAgICAgICAgcmV0dXJuIHN1\ncHBvcnRzQ2FzY2FkZURlbGV0ZUFjdGlvbjsKICAgICAgICAgICAgY2FzZSBG\nb3JlaWduS2V5LkFDVElPTl9OVUxMOgogICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cHBvcnRzTnVsbERlbGV0ZUFjdGlvbjsKICAgICAgICAgICAgY2FzZSBG\nb3JlaWduS2V5LkFDVElPTl9ERUZBVUxUOgogICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cHBvcnRzRGVmYXVsdERlbGV0ZUFjdGlvbjsKICAgICAgICAgICAg\nZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZGF0YWJh\nc2Ugc3VwcG9ydHMgdGhlIGdpdmVuIGZvcmVpZ24ga2V5IHVwZGF0ZSBhY3Rp\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzVXBkYXRl\nQWN0aW9uKGludCBhY3Rpb24pIHsKICAgICAgICBpZiAoYWN0aW9uID09IEZv\ncmVpZ25LZXkuQUNUSU9OX05PTkUpCiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIGlmICghc3VwcG9ydHNGb3JlaWduS2V5cykKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7CiAg\nICAgICAgICAgIGNhc2UgRm9yZWlnbktleS5BQ1RJT05fUkVTVFJJQ1Q6CiAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNSZXN0cmljdFVwZGF0ZUFj\ndGlvbjsKICAgICAgICAgICAgY2FzZSBGb3JlaWduS2V5LkFDVElPTl9DQVND\nQURFOgogICAgICAgICAgICAgICAgcmV0dXJuIHN1cHBvcnRzQ2FzY2FkZVVw\nZGF0ZUFjdGlvbjsKICAgICAgICAgICAgY2FzZSBGb3JlaWduS2V5LkFDVElP\nTl9OVUxMOgogICAgICAgICAgICAgICAgcmV0dXJuIHN1cHBvcnRzTnVsbFVw\nZGF0ZUFjdGlvbjsKICAgICAgICAgICAgY2FzZSBGb3JlaWduS2V5LkFDVElP\nTl9ERUZBVUxUOgogICAgICAgICAgICAgICAgcmV0dXJuIHN1cHBvcnRzRGVm\nYXVsdFVwZGF0ZUFjdGlvbjsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGRlY2xhcmF0aW9uIFNRTCBmb3IgdGhl\nIGdpdmVuIHVuaXF1ZSBjb25zdHJhaW50LiBUaGlzCiAgICAgKiBtZXRob2Qg\naXMgdXNlZCBmcm9tIHdpdGhpbiB7QGxpbmsgI2dldENyZWF0ZVRhYmxlU1FM\nfS4KICAgICAqIFJldHVybnMJPGNvZGU+Q09OU1RSQUlOVCAmbHQ7bmFtZSZn\ndDsgVU5JUVVFICgmbHQ7Y29sIGxpc3QmZ3Q7KTwvY29kZT4KICAgICAqIGJ5\nIGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0VW5p\ncXVlQ29uc3RyYWludFNRTChVbmlxdWUgdW5xKSB7CiAgICAgICAgaWYgKCFz\ndXBwb3J0c1VuaXF1ZUNvbnN0cmFpbnRzCiAgICAgICAgICAgIHx8ICh1bnEu\naXNEZWZlcnJlZCgpICYmICFzdXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMp\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU3RyaW5nQnVm\nZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBpZiAodW5x\nLmdldE5hbWUoKSAhPSBudWxsCiAgICAgICAgICAgICYmIENPTlNfTkFNRV9C\nRUZPUkUuZXF1YWxzKGNvbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIkNPTlNUUkFJTlQgIikuYXBwZW5kKHVucS5nZXROYW1l\nKCkpLmFwcGVuZCgiICIpOwogICAgICAgIGJ1Zi5hcHBlbmQoIlVOSVFVRSAi\nKTsKICAgICAgICBpZiAodW5xLmdldE5hbWUoKSAhPSBudWxsICYmIENPTlNf\nTkFNRV9NSUQuZXF1YWxzKGNvbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQodW5xLmdldE5hbWUoKSkuYXBwZW5kKCIgIik7CiAg\nICAgICAgYnVmLmFwcGVuZCgiKCIpLmFwcGVuZChTdHJpbmdzLmpvaW4odW5x\nLmdldENvbHVtbnMoKSwgIiwgIikpLgogICAgICAgICAgICBhcHBlbmQoIiki\nKTsKICAgICAgICBpZiAodW5xLmlzRGVmZXJyZWQoKSkKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIElOSVRJQUxMWSBERUZFUlJFRCIpOwogICAgICAgIGlm\nIChzdXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMpCiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiBERUZFUlJBQkxFIik7CiAgICAgICAgaWYgKHVucS5nZXRO\nYW1lKCkgIT0gbnVsbAogICAgICAgICAgICAmJiBDT05TX05BTUVfQUZURVIu\nZXF1YWxzKGNvbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoIiBDT05TVFJBSU5UICIpLmFwcGVuZCh1bnEuZ2V0TmFtZSgpKTsK\nICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBEYXRhYmFzZSBtZXRhZGF0YQog\nICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBUaGlz\nIG1ldGhvZCBpcyB1c2VkIHRvIGZpbHRlciBzeXN0ZW0gdGFibGVzIGZyb20g\nZGF0YWJhc2UgbWV0YWRhdGEuCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUg\nZ2l2ZW4gdGFibGUgbmFtZSByZXByZXNlbnRzIGEgc3lzdGVtIHRhYmxlIHRo\nYXQKICAgICAqIHNob3VsZCBub3QgYXBwZWFyIGluIHRoZSBzY2hlbWEgZGVm\naW5pdGlvbi4gQnkgZGVmYXVsdCwgcmV0dXJucwogICAgICogdHJ1ZSBvbmx5\nIGlmIHRoZSBnaXZlbiB0YWJsZSBpcyBpbiB0aGUgaW50ZXJuYWwgbGlzdCBv\nZiBzeXN0ZW0gdGFibGVzLAogICAgICogb3IgaWYgdGhlIGdpdmVuIHNjaGVt\nYSBpcyBpbiB0aGUgbGlzdCBvZiBzeXN0ZW0gc2NoZW1hcyBhbmQgaXMgbm90\nCiAgICAgKiB0aGUgdGFyZ2V0IHNjaGVtYS4KICAgICAqCiAgICAgKiBAcGFy\nYW0gbmFtZSB0aGUgdGFibGUgbmFtZQogICAgICogQHBhcmFtIHNjaGVtYSB0\naGUgdGFibGUgc2NoZW1hOyBtYXkgYmUgbnVsbAogICAgICogQHBhcmFtIHRh\ncmdldFNjaGVtYSBpZiB0cnVlLCB0aGVuIHRoZSBnaXZlbiBzY2hlbWEgd2Fz\nIGxpc3RlZCBieQogICAgICogdGhlIHVzZXIgYXMgb25lIG9mIGhpcyBzY2hl\nbWFzCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtVGFibGUo\nU3RyaW5nIG5hbWUsIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0\nYXJnZXRTY2hlbWEpIHsKICAgICAgICBpZiAoc3lzdGVtVGFibGVTZXQuY29u\ndGFpbnMobmFtZS50b1VwcGVyQ2FzZSgpKSkKICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICAgICAgcmV0dXJuICF0YXJnZXRTY2hlbWEgJiYgc2NoZW1h\nICE9IG51bGwKICAgICAgICAgICAgJiYgc3lzdGVtU2NoZW1hU2V0LmNvbnRh\naW5zKHNjaGVtYS50b1VwcGVyQ2FzZSgpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gZmlsdGVyIHN5c3RlbSBpbmRl\neGVzIGZyb20gZGF0YWJhc2UgbWV0YWRhdGEuCiAgICAgKiBSZXR1cm4gdHJ1\nZSBpZiB0aGUgZ2l2ZW4gaW5kZXggbmFtZSByZXByZXNlbnRzIGEgc3lzdGVt\nIGluZGV4IHRoYXQKICAgICAqIHNob3VsZCBub3QgYXBwZWFyIGluIHRoZSBz\nY2hlbWEgZGVmaW5pdGlvbi4gUmV0dXJucyBmYWxzZSBieSBkZWZhdWx0Lgog\nICAgICoKICAgICAqIEBwYXJhbSBuYW1lIHRoZSBpbmRleCBuYW1lCiAgICAg\nKiBAcGFyYW0gdGFibGUgdGhlIGluZGV4IHRhYmxlCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGlzU3lzdGVtSW5kZXgoU3RyaW5nIG5hbWUsIFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byBmaWx0ZXIgc3lzdGVt\nIHNlcXVlbmNlcyBmcm9tIGRhdGFiYXNlIG1ldGFkYXRhLgogICAgICogUmV0\ndXJuIHRydWUgaWYgdGhlIGdpdmVuIHNlcXVlbmNlIHJlcHJlc2VudHMgYSBz\neXN0ZW0gc2VxdWVuY2UgdGhhdAogICAgICogc2hvdWxkIG5vdCBhcHBlYXIg\naW4gdGhlIHNjaGVtYSBkZWZpbml0aW9uLiBSZXR1cm5zIHRydWUgaWYgc3lz\ndGVtCiAgICAgKiBzY2hlbWEgYnkgZGVmYXVsdC4KICAgICAqCiAgICAgKiBA\ncGFyYW0gbmFtZSB0aGUgdGFibGUgbmFtZQogICAgICogQHBhcmFtIHNjaGVt\nYSB0aGUgdGFibGUgc2NoZW1hOyBtYXkgYmUgbnVsbAogICAgICogQHBhcmFt\nIHRhcmdldFNjaGVtYSBpZiB0cnVlLCB0aGVuIHRoZSBnaXZlbiBzY2hlbWEg\nd2FzIGxpc3RlZCBieQogICAgICogdGhlIHVzZXIgYXMgb25lIG9mIGhpcyBz\nY2hlbWFzCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtU2Vx\ndWVuY2UoU3RyaW5nIG5hbWUsIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9v\nbGVhbiB0YXJnZXRTY2hlbWEpIHsKICAgICAgICByZXR1cm4gIXRhcmdldFNj\naGVtYSAmJiBzY2hlbWEgIT0gbnVsbAogICAgICAgICAgICAmJiBzeXN0ZW1T\nY2hlbWFTZXQuY29udGFpbnMoc2NoZW1hLnRvVXBwZXJDYXNlKCkpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZp\nbmQgdGFibGVzIG1hdGNoaW5nIHRoZSBnaXZlbiBuYW1lIHBhdHRlcm4uCiAg\nICAgKi8KICAgIHB1YmxpYyBUYWJsZVtdIGdldFRhYmxlcyhEYXRhYmFzZU1l\ndGFEYXRhIG1ldGEsIFN0cmluZyBjYXRhbG9nLAogICAgICAgIFN0cmluZyBz\nY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVOYW1lLCBDb25uZWN0aW9uIGNvbm4p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFz\ndXBwb3J0c1NjaGVtYUZvckdldFRhYmxlcykKICAgICAgICAgICAgc2NoZW1h\nTmFtZSA9IG51bGw7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzY2hlbWFO\nYW1lID0gZ2V0U2NoZW1hTmFtZUZvck1ldGFkYXRhKHNjaGVtYU5hbWUpOwoK\nICAgICAgICBTdHJpbmdbXSB0eXBlcyA9IFN0cmluZ3Muc3BsaXQodGFibGVU\neXBlcywgIiwiLCAwKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHR5\ncGVzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICB0eXBlc1tpXSA9IHR5cGVz\nW2ldLnRyaW0oKTsKCiAgICAgICAgYmVmb3JlTWV0YWRhdGFPcGVyYXRpb24o\nY29ubik7CiAgICAgICAgUmVzdWx0U2V0IHRhYmxlcyA9IG51bGw7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgdGFibGVzID0gbWV0YS5nZXRUYWJsZXMo\nZ2V0Q2F0YWxvZ05hbWVGb3JNZXRhZGF0YShjYXRhbG9nKSwKICAgICAgICAg\nICAgICAgIHNjaGVtYU5hbWUsIGdldFRhYmxlTmFtZUZvck1ldGFkYXRhKHRh\nYmxlTmFtZSksIHR5cGVzKTsKICAgICAgICAgICAgTGlzdCB0YWJsZUxpc3Qg\nPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIHdoaWxlICh0YWJsZXMg\nIT0gbnVsbCAmJiB0YWJsZXMubmV4dCgpKQogICAgICAgICAgICAgICAgdGFi\nbGVMaXN0LmFkZChuZXdUYWJsZSh0YWJsZXMpKTsKICAgICAgICAgICAgcmV0\ndXJuIChUYWJsZVtdKSB0YWJsZUxpc3QudG9BcnJheShuZXcgVGFibGVbdGFi\nbGVMaXN0LnNpemUoKV0pOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGlmICh0YWJsZXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgdGFibGVzLmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nIG5ldyB0YWJsZSBmcm9tIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2NoZW1h\nIG1ldGFkYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgVGFibGUgbmV3VGFi\nbGUoUmVzdWx0U2V0IHRhYmxlTWV0YSkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBUYWJsZSB0ID0gbmV3IFRhYmxlKCk7CiAgICAg\nICAgdC5zZXROYW1lKHRhYmxlTWV0YS5nZXRTdHJpbmcoIlRBQkxFX05BTUUi\nKSk7CiAgICAgICAgcmV0dXJuIHQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZWZsZWN0IG9uIHRoZSBzY2hlbWEgdG8gZmluZCBzZXF1ZW5jZXMgbWF0Y2hp\nbmcgdGhlIGdpdmVuIG5hbWUgcGF0dGVybi4KICAgICAqIFJldHVybnMgYW4g\nZW1wdHkgYXJyYXkgYnkgZGVmYXVsdCwgYXMgdGhlcmUgaXMgbm8gc3RhbmRh\ncmQgd2F5IHRvCiAgICAgKiByZXRyaWV2ZSBhIGxpc3Qgb2Ygc2VxdWVuY2Vz\nLgogICAgICovCiAgICBwdWJsaWMgU2VxdWVuY2VbXSBnZXRTZXF1ZW5jZXMo\nRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcgY2F0YWxvZywKICAgICAg\nICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHNlcXVlbmNlTmFtZSwgQ29u\nbmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIFN0cmluZyBzdHIgPSBnZXRTZXF1ZW5jZXNTUUwoc2NoZW1hTmFt\nZSwgc2VxdWVuY2VOYW1lKTsKICAgICAgICBpZiAoc3RyID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBuZXcgU2VxdWVuY2VbMF07CgogICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVtZW50\nKHN0cik7CiAgICAgICAgUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpbnQgaWR4ID0gMTsKICAgICAgICAgICAgaWYg\nKHNjaGVtYU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHN0bW50LnNl\ndFN0cmluZyhpZHgrKywgc2NoZW1hTmFtZSk7CiAgICAgICAgICAgIGlmIChz\nZXF1ZW5jZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHN0bW50LnNl\ndFN0cmluZyhpZHgrKywgc2VxdWVuY2VOYW1lKTsKCiAgICAgICAgICAgIHJz\nID0gc3RtbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAgIExpc3Qgc2Vx\nTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgd2hpbGUgKHJz\nLm5leHQoKSkKICAgICAgICAgICAgICAgIHNlcUxpc3QuYWRkKG5ld1NlcXVl\nbmNlKHJzKSk7CiAgICAgICAgICAgIHJldHVybiAoU2VxdWVuY2VbXSkgc2Vx\nTGlzdC50b0FycmF5KG5ldyBTZXF1ZW5jZVtzZXFMaXN0LnNpemUoKV0pOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChycyAhPSBudWxs\nKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBy\ncy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBzdG1udC5jbG9zZSgpOwogICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBzZXF1\nZW5jZSBmcm9tIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2NoZW1hIG1ldGFk\nYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgU2VxdWVuY2UgbmV3U2VxdWVu\nY2UoUmVzdWx0U2V0IHNlcXVlbmNlTWV0YSkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBTZXF1ZW5jZSBzZXEgPSBuZXcgU2VxdWVu\nY2UoKTsKICAgICAgICBzZXEuc2V0U2NoZW1hTmFtZShzZXF1ZW5jZU1ldGEu\nZ2V0U3RyaW5nKCJTRVFVRU5DRV9TQ0hFTUEiKSk7CiAgICAgICAgc2VxLnNl\ndE5hbWUoc2VxdWVuY2VNZXRhLmdldFN0cmluZygiU0VRVUVOQ0VfTkFNRSIp\nKTsKICAgICAgICByZXR1cm4gc2VxOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBTUUwgbmVlZGVkIHRvIHNlbGVjdCB0aGUgbGlzdCBvZiBz\nZXF1ZW5jZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0U2Vx\ndWVuY2VzU1FMKFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgc2VxdWVuY2VO\nYW1lKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZWZsZWN0IG9uIHRoZSBzY2hlbWEgdG8gZmluZCBjb2x1bW5zIG1h\ndGNoaW5nIHRoZSBnaXZlbiB0YWJsZSBhbmQKICAgICAqIGNvbHVtbiBwYXR0\nZXJucy4KICAgICAqLwogICAgcHVibGljIENvbHVtbltdIGdldENvbHVtbnMo\nRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcgY2F0YWxvZywKICAgICAg\nICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwgU3RyaW5n\nIGNvbHVtbk5hbWUsIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodGFibGVOYW1lID09IG51bGwg\nJiYgIXN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0Q29sdW1ucykKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIGlmICghc3VwcG9ydHNTY2hlbWFG\nb3JHZXRDb2x1bW5zKQogICAgICAgICAgICBzY2hlbWFOYW1lID0gbnVsbDsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBnZXRTY2hl\nbWFOYW1lRm9yTWV0YWRhdGEoc2NoZW1hTmFtZSk7CgogICAgICAgIGJlZm9y\nZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4pOwogICAgICAgIFJlc3VsdFNldCBj\nb2xzID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb2xzID0g\nbWV0YS5nZXRDb2x1bW5zKGdldENhdGFsb2dOYW1lRm9yTWV0YWRhdGEoY2F0\nYWxvZyksCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1lLCBnZXRUYWJsZU5h\nbWVGb3JNZXRhZGF0YSh0YWJsZU5hbWUpLAogICAgICAgICAgICAgICAgZ2V0\nQ29sdW1uTmFtZUZvck1ldGFkYXRhKGNvbHVtbk5hbWUpKTsKCiAgICAgICAg\nICAgIExpc3QgY29sdW1uTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAg\nICAgICAgd2hpbGUgKGNvbHMgIT0gbnVsbCAmJiBjb2xzLm5leHQoKSkKICAg\nICAgICAgICAgICAgIGNvbHVtbkxpc3QuYWRkKG5ld0NvbHVtbihjb2xzKSk7\nCiAgICAgICAgICAgIHJldHVybiAoQ29sdW1uW10pIGNvbHVtbkxpc3QudG9B\ncnJheQogICAgICAgICAgICAgICAgKG5ldyBDb2x1bW5bY29sdW1uTGlzdC5z\naXplKCldKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAo\nY29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICBjb2xzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBjb2x1bW4g\nZnJvbSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNjaGVtYSBtZXRhZGF0YS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIENvbHVtbiBuZXdDb2x1bW4oUmVzdWx0\nU2V0IGNvbE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgQ29sdW1uIGMgPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgYy5zZXRT\nY2hlbWFOYW1lKGNvbE1ldGEuZ2V0U3RyaW5nKCJUQUJMRV9TQ0hFTSIpKTsK\nICAgICAgICBjLnNldFRhYmxlTmFtZShjb2xNZXRhLmdldFN0cmluZygiVEFC\nTEVfTkFNRSIpKTsKICAgICAgICBjLnNldE5hbWUoY29sTWV0YS5nZXRTdHJp\nbmcoIkNPTFVNTl9OQU1FIikpOwogICAgICAgIGMuc2V0VHlwZShjb2xNZXRh\nLmdldEludCgiREFUQV9UWVBFIikpOwogICAgICAgIGMuc2V0VHlwZU5hbWUo\nY29sTWV0YS5nZXRTdHJpbmcoIlRZUEVfTkFNRSIpKTsKICAgICAgICBjLnNl\ndFNpemUoY29sTWV0YS5nZXRJbnQoIkNPTFVNTl9TSVpFIikpOwogICAgICAg\nIGMuc2V0RGVjaW1hbERpZ2l0cyhjb2xNZXRhLmdldEludCgiREVDSU1BTF9E\nSUdJVFMiKSk7CiAgICAgICAgYy5zZXROb3ROdWxsKGNvbE1ldGEuZ2V0SW50\nKCJOVUxMQUJMRSIpCiAgICAgICAgICAgID09IERhdGFiYXNlTWV0YURhdGEu\nY29sdW1uTm9OdWxscyk7CgogICAgICAgIFN0cmluZyBkZWYgPSBjb2xNZXRh\nLmdldFN0cmluZygiQ09MVU1OX0RFRiIpOwogICAgICAgIGlmICghU3RyaW5n\nVXRpbHMuaXNFbXB0eShkZWYpICYmICEibnVsbCIuZXF1YWxzSWdub3JlQ2Fz\nZShkZWYpKQogICAgICAgICAgICBjLnNldERlZmF1bHRTdHJpbmcoZGVmKTsK\nICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZmxl\nY3Qgb24gdGhlIHNjaGVtYSB0byBmaW5kIHByaW1hcnkga2V5cyBmb3IgdGhl\nIGdpdmVuIHRhYmxlIHBhdHRlcm4uCiAgICAgKi8KICAgIHB1YmxpYyBQcmlt\nYXJ5S2V5W10gZ2V0UHJpbWFyeUtleXMoRGF0YWJhc2VNZXRhRGF0YSBtZXRh\nLAogICAgICAgIFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hTmFtZSwg\nU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh1c2VHZXRCZXN0Um93\nSWRlbnRpZmllckZvclByaW1hcnlLZXlzKQogICAgICAgICAgICByZXR1cm4g\nZ2V0UHJpbWFyeUtleXNGcm9tQmVzdFJvd0lkZW50aWZpZXIobWV0YSwgY2F0\nYWxvZywKICAgICAgICAgICAgICAgIHNjaGVtYU5hbWUsIHRhYmxlTmFtZSwg\nY29ubik7CiAgICAgICAgcmV0dXJuIGdldFByaW1hcnlLZXlzRnJvbUdldFBy\naW1hcnlLZXlzKG1ldGEsIGNhdGFsb2csCiAgICAgICAgICAgIHNjaGVtYU5h\nbWUsIHRhYmxlTmFtZSwgY29ubik7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZWZsZWN0IG9uIHRoZSBzY2hlbWEgdG8gZmluZCBwcmltYXJ5IGtleXMgZm9y\nIHRoZSBnaXZlbiB0YWJsZSBwYXR0ZXJuLgogICAgICovCiAgICBwcm90ZWN0\nZWQgUHJpbWFyeUtleVtdIGdldFByaW1hcnlLZXlzRnJvbUdldFByaW1hcnlL\nZXlzCiAgICAgICAgKERhdGFiYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5nIGNh\ndGFsb2csIFN0cmluZyBzY2hlbWFOYW1lLAogICAgICAgICAgICBTdHJpbmcg\ndGFibGVOYW1lLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHRhYmxlTmFtZSA9PSBudWxsICYm\nICFzdXBwb3J0c051bGxUYWJsZUZvckdldFByaW1hcnlLZXlzKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgYmVmb3JlTWV0YWRhdGFPcGVy\nYXRpb24oY29ubik7CiAgICAgICAgUmVzdWx0U2V0IHBrcyA9IG51bGw7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcGtzID0gbWV0YS5nZXRQcmltYXJ5\nS2V5cyhnZXRDYXRhbG9nTmFtZUZvck1ldGFkYXRhKGNhdGFsb2cpLAogICAg\nICAgICAgICAgICAgZ2V0U2NoZW1hTmFtZUZvck1ldGFkYXRhKHNjaGVtYU5h\nbWUpLAogICAgICAgICAgICAgICAgZ2V0VGFibGVOYW1lRm9yTWV0YWRhdGEo\ndGFibGVOYW1lKSk7CgogICAgICAgICAgICBMaXN0IHBrTGlzdCA9IG5ldyBB\ncnJheUxpc3QoKTsKICAgICAgICAgICAgd2hpbGUgKHBrcyAhPSBudWxsICYm\nIHBrcy5uZXh0KCkpCiAgICAgICAgICAgICAgICBwa0xpc3QuYWRkKG5ld1By\naW1hcnlLZXkocGtzKSk7CiAgICAgICAgICAgIHJldHVybiAoUHJpbWFyeUtl\neVtdKSBwa0xpc3QudG9BcnJheQogICAgICAgICAgICAgICAgKG5ldyBQcmlt\nYXJ5S2V5W3BrTGlzdC5zaXplKCldKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICBpZiAocGtzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIHBrcy5jbG9zZSgpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSBuZXcgcHJpbWFyeSBrZXkgZnJvbSB0aGUgaW5mb3JtYXRpb24gaW4gdGhl\nIHNjaGVtYSBtZXRhZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIFByaW1h\ncnlLZXkgbmV3UHJpbWFyeUtleShSZXN1bHRTZXQgcGtNZXRhKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFByaW1hcnlLZXkgcGsg\nPSBuZXcgUHJpbWFyeUtleSgpOwogICAgICAgIHBrLnNldFNjaGVtYU5hbWUo\ncGtNZXRhLmdldFN0cmluZygiVEFCTEVfU0NIRU0iKSk7CiAgICAgICAgcGsu\nc2V0VGFibGVOYW1lKHBrTWV0YS5nZXRTdHJpbmcoIlRBQkxFX05BTUUiKSk7\nCiAgICAgICAgcGsuc2V0Q29sdW1uTmFtZShwa01ldGEuZ2V0U3RyaW5nKCJD\nT0xVTU5fTkFNRSIpKTsKICAgICAgICBway5zZXROYW1lKHBrTWV0YS5nZXRT\ndHJpbmcoIlBLX05BTUUiKSk7CiAgICAgICAgcmV0dXJuIHBrOwogICAgfQoK\nICAgIC8qKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZpbmQg\ncHJpbWFyeSBrZXlzIGZvciB0aGUgZ2l2ZW4gdGFibGUgcGF0dGVybi4KICAg\nICAqLwogICAgcHJvdGVjdGVkIFByaW1hcnlLZXlbXSBnZXRQcmltYXJ5S2V5\nc0Zyb21CZXN0Um93SWRlbnRpZmllcgogICAgICAgIChEYXRhYmFzZU1ldGFE\nYXRhIG1ldGEsIFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hTmFtZSwK\nICAgICAgICAgICAgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVjdGlvbiBjb25u\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh0\nYWJsZU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIGJlZm9yZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4pOwogICAgICAg\nIFJlc3VsdFNldCBwa3MgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIHBrcyA9IG1ldGEuZ2V0QmVzdFJvd0lkZW50aWZpZXIoY2F0YWxvZywg\nc2NoZW1hTmFtZSwKICAgICAgICAgICAgICAgIHRhYmxlTmFtZSwgMCwgZmFs\nc2UpOwoKICAgICAgICAgICAgTGlzdCBwa0xpc3QgPSBuZXcgQXJyYXlMaXN0\nKCk7CiAgICAgICAgICAgIHdoaWxlIChwa3MgIT0gbnVsbCAmJiBwa3MubmV4\ndCgpKSB7CiAgICAgICAgICAgICAgICBQcmltYXJ5S2V5IHBrID0gbmV3IFBy\naW1hcnlLZXkoKTsKICAgICAgICAgICAgICAgIHBrLnNldFNjaGVtYU5hbWUo\nc2NoZW1hTmFtZSk7CiAgICAgICAgICAgICAgICBway5zZXRUYWJsZU5hbWUo\ndGFibGVOYW1lKTsKICAgICAgICAgICAgICAgIHBrLnNldENvbHVtbk5hbWUo\ncGtzLmdldFN0cmluZygiQ09MVU1OX05BTUUiKSk7CiAgICAgICAgICAgICAg\nICBwa0xpc3QuYWRkKHBrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBy\nZXR1cm4gKFByaW1hcnlLZXlbXSkgcGtMaXN0LnRvQXJyYXkKICAgICAgICAg\nICAgICAgIChuZXcgUHJpbWFyeUtleVtwa0xpc3Quc2l6ZSgpXSk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHBrcyAhPSBudWxsKQog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBwa3Mu\nY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZpbmQgaW5kZXhl\ncyBtYXRjaGluZyB0aGUgZ2l2ZW4gdGFibGUgcGF0dGVybi4KICAgICAqLwog\nICAgcHVibGljIEluZGV4W10gZ2V0SW5kZXhJbmZvKERhdGFiYXNlTWV0YURh\ndGEgbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAgICAgICAgU3RyaW5nIHNjaGVt\nYU5hbWUsIFN0cmluZyB0YWJsZU5hbWUsIGJvb2xlYW4gdW5pcXVlLAogICAg\nICAgIGJvb2xlYW4gYXBwcm94LCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHRhYmxlTmFtZSA9\nPSBudWxsICYmICFzdXBwb3J0c051bGxUYWJsZUZvckdldEluZGV4SW5mbykK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIGJlZm9yZU1ldGFk\nYXRhT3BlcmF0aW9uKGNvbm4pOwogICAgICAgIFJlc3VsdFNldCBpbmRleGVz\nID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBpbmRleGVzID0g\nbWV0YS5nZXRJbmRleEluZm8oZ2V0Q2F0YWxvZ05hbWVGb3JNZXRhZGF0YShj\nYXRhbG9nKSwKICAgICAgICAgICAgICAgIGdldFNjaGVtYU5hbWVGb3JNZXRh\nZGF0YShzY2hlbWFOYW1lKSwKICAgICAgICAgICAgICAgIGdldFRhYmxlTmFt\nZUZvck1ldGFkYXRhKHRhYmxlTmFtZSksIHVuaXF1ZSwgYXBwcm94KTsKCiAg\nICAgICAgICAgIExpc3QgaW5kZXhMaXN0ID0gbmV3IEFycmF5TGlzdCgpOwog\nICAgICAgICAgICB3aGlsZSAoaW5kZXhlcyAhPSBudWxsICYmIGluZGV4ZXMu\nbmV4dCgpKQogICAgICAgICAgICAgICAgaW5kZXhMaXN0LmFkZChuZXdJbmRl\neChpbmRleGVzKSk7CiAgICAgICAgICAgIHJldHVybiAoSW5kZXhbXSkgaW5k\nZXhMaXN0LnRvQXJyYXkobmV3IEluZGV4W2luZGV4TGlzdC5zaXplKCldKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoaW5kZXhlcyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICBpbmRleGVzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBpbmRleCBmcm9t\nIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2NoZW1hIG1ldGFkYXRhLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgSW5kZXggbmV3SW5kZXgoUmVzdWx0U2V0IGlk\neE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nSW5kZXggaWR4ID0gbmV3IEluZGV4KCk7CiAgICAgICAgaWR4LnNldFNjaGVt\nYU5hbWUoaWR4TWV0YS5nZXRTdHJpbmcoIlRBQkxFX1NDSEVNIikpOwogICAg\nICAgIGlkeC5zZXRUYWJsZU5hbWUoaWR4TWV0YS5nZXRTdHJpbmcoIlRBQkxF\nX05BTUUiKSk7CiAgICAgICAgaWR4LnNldENvbHVtbk5hbWUoaWR4TWV0YS5n\nZXRTdHJpbmcoIkNPTFVNTl9OQU1FIikpOwogICAgICAgIGlkeC5zZXROYW1l\nKGlkeE1ldGEuZ2V0U3RyaW5nKCJJTkRFWF9OQU1FIikpOwogICAgICAgIGlk\neC5zZXRVbmlxdWUoIWlkeE1ldGEuZ2V0Qm9vbGVhbigiTk9OX1VOSVFVRSIp\nKTsKICAgICAgICByZXR1cm4gaWR4OwogICAgfQoKICAgIC8qKgogICAgICog\nUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIHJldHVybiBmb3JlaWduIGtleXMg\naW1wb3J0ZWQgYnkgdGhlIGdpdmVuCiAgICAgKiB0YWJsZSBwYXR0ZXJuLgog\nICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleVtdIGdldEltcG9ydGVkS2V5\ncyhEYXRhYmFzZU1ldGFEYXRhIG1ldGEsIFN0cmluZyBjYXRhbG9nLAogICAg\nICAgIFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVOYW1lLCBDb25u\nZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKCFzdXBwb3J0c0ZvcmVpZ25LZXlzKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAodGFibGVOYW1lID09IG51bGwgJiYg\nIXN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0SW1wb3J0ZWRLZXlzKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgYmVmb3JlTWV0YWRhdGFPcGVy\nYXRpb24oY29ubik7CiAgICAgICAgUmVzdWx0U2V0IGtleXMgPSBudWxsOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGtleXMgPSBtZXRhLmdldEltcG9y\ndGVkS2V5cyhnZXRDYXRhbG9nTmFtZUZvck1ldGFkYXRhKGNhdGFsb2cpLAog\nICAgICAgICAgICAgICAgZ2V0U2NoZW1hTmFtZUZvck1ldGFkYXRhKHNjaGVt\nYU5hbWUpLAogICAgICAgICAgICAgICAgZ2V0VGFibGVOYW1lRm9yTWV0YWRh\ndGEodGFibGVOYW1lKSk7CgogICAgICAgICAgICBMaXN0IGltcG9ydGVkS2V5\nTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgd2hpbGUgKGtl\neXMgIT0gbnVsbCAmJiBrZXlzLm5leHQoKSkKICAgICAgICAgICAgICAgIGlt\ncG9ydGVkS2V5TGlzdC5hZGQobmV3Rm9yZWlnbktleShrZXlzKSk7CiAgICAg\nICAgICAgIHJldHVybiAoRm9yZWlnbktleVtdKSBpbXBvcnRlZEtleUxpc3Qu\ndG9BcnJheQogICAgICAgICAgICAgICAgKG5ldyBGb3JlaWduS2V5W2ltcG9y\ndGVkS2V5TGlzdC5zaXplKCldKTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICBpZiAoa2V5cyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICBrZXlzLmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nIG5ldyBmb3JlaWduIGtleSBmcm9tIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUg\nc2NoZW1hIG1ldGFkYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgRm9yZWln\nbktleSBuZXdGb3JlaWduS2V5KFJlc3VsdFNldCBma01ldGEpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgRm9yZWlnbktleSBmayA9\nIG5ldyBGb3JlaWduS2V5KCk7CiAgICAgICAgZmsuc2V0U2NoZW1hTmFtZShm\na01ldGEuZ2V0U3RyaW5nKCJGS1RBQkxFX1NDSEVNIikpOwogICAgICAgIGZr\nLnNldFRhYmxlTmFtZShma01ldGEuZ2V0U3RyaW5nKCJGS1RBQkxFX05BTUUi\nKSk7CiAgICAgICAgZmsuc2V0Q29sdW1uTmFtZShma01ldGEuZ2V0U3RyaW5n\nKCJGS0NPTFVNTl9OQU1FIikpOwogICAgICAgIGZrLnNldE5hbWUoZmtNZXRh\nLmdldFN0cmluZygiRktfTkFNRSIpKTsKICAgICAgICBmay5zZXRQcmltYXJ5\nS2V5U2NoZW1hTmFtZShma01ldGEuZ2V0U3RyaW5nKCJQS1RBQkxFX1NDSEVN\nIikpOwogICAgICAgIGZrLnNldFByaW1hcnlLZXlUYWJsZU5hbWUoZmtNZXRh\nLmdldFN0cmluZygiUEtUQUJMRV9OQU1FIikpOwogICAgICAgIGZrLnNldFBy\naW1hcnlLZXlDb2x1bW5OYW1lKGZrTWV0YS5nZXRTdHJpbmcoIlBLQ09MVU1O\nX05BTUUiKSk7CiAgICAgICAgZmsuc2V0S2V5U2VxdWVuY2UoZmtNZXRhLmdl\ndEludCgiS0VZX1NFUSIpKTsKICAgICAgICBmay5zZXREZWZlcnJlZChma01l\ndGEuZ2V0SW50KCJERUZFUlJBQklMSVRZIikKICAgICAgICAgICAgPT0gRGF0\nYWJhc2VNZXRhRGF0YS5pbXBvcnRlZEtleUluaXRpYWxseURlZmVycmVkKTsK\nCiAgICAgICAgaW50IGRlbCA9IGZrTWV0YS5nZXRJbnQoIkRFTEVURV9SVUxF\nIik7CiAgICAgICAgc3dpdGNoIChkZWwpIHsKICAgICAgICAgICAgY2FzZSBE\nYXRhYmFzZU1ldGFEYXRhLmltcG9ydGVkS2V5U2V0TnVsbDoKICAgICAgICAg\nICAgICAgIGZrLnNldERlbGV0ZUFjdGlvbihGb3JlaWduS2V5LkFDVElPTl9O\nVUxMKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIERhdGFiYXNlTWV0YURhdGEuaW1wb3J0ZWRLZXlTZXREZWZhdWx0OgogICAg\nICAgICAgICAgICAgZmsuc2V0RGVsZXRlQWN0aW9uKEZvcmVpZ25LZXkuQUNU\nSU9OX0RFRkFVTFQpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgRGF0YWJhc2VNZXRhRGF0YS5pbXBvcnRlZEtleUNhc2NhZGU6\nCiAgICAgICAgICAgICAgICBmay5zZXREZWxldGVBY3Rpb24oRm9yZWlnbktl\neS5BQ1RJT05fQ0FTQ0FERSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIGZrLnNldERlbGV0\nZUFjdGlvbihGb3JlaWduS2V5LkFDVElPTl9SRVNUUklDVCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZrOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgdGFibGUgbmFtZSB0\naGF0IHdpbGwgYmUgdXNlZCBmb3Igb2J0YWluaW5nIGluZm9ybWF0aW9uCiAg\nICAgKiBmcm9tIHtAbGluayBEYXRhYmFzZU1ldGFEYXRhfS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIFN0cmluZyBnZXRUYWJsZU5hbWVGb3JNZXRhZGF0YShT\ndHJpbmcgdGFibGVOYW1lKSB7CiAgICAgICAgcmV0dXJuIGNvbnZlcnRTY2hl\nbWFDYXNlKHRhYmxlTmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm5zIHRoZSBzY2hlbWEgbmFtZSB0aGF0IHdpbGwgYmUgdXNlZCBmb3Igb2J0\nYWluaW5nIGluZm9ybWF0aW9uCiAgICAgKiBmcm9tIHtAbGluayBEYXRhYmFz\nZU1ldGFEYXRhfS4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRT\nY2hlbWFOYW1lRm9yTWV0YWRhdGEoU3RyaW5nIHNjaGVtYU5hbWUpIHsKICAg\nICAgICBpZiAoc2NoZW1hTmFtZSA9PSBudWxsKQogICAgICAgICAgICBzY2hl\nbWFOYW1lID0gY29uZi5nZXRTY2hlbWEoKTsKICAgICAgICByZXR1cm4gY29u\ndmVydFNjaGVtYUNhc2Uoc2NoZW1hTmFtZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm5zIHRoZSBjYXRhbG9nIG5hbWUgdGhhdCB3aWxsIGJlIHVz\nZWQgZm9yIG9idGFpbmluZyBpbmZvcm1hdGlvbgogICAgICogZnJvbSB7QGxp\nbmsgRGF0YWJhc2VNZXRhRGF0YX0uCiAgICAgKi8KICAgIHByb3RlY3RlZCBT\ndHJpbmcgZ2V0Q2F0YWxvZ05hbWVGb3JNZXRhZGF0YShTdHJpbmcgY2F0YWxv\nZ05hbWUpIHsKICAgICAgICByZXR1cm4gY29udmVydFNjaGVtYUNhc2UoY2F0\nYWxvZ05hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUg\nY29sdW1uIG5hbWUgdGhhdCB3aWxsIGJlIHVzZWQgZm9yIG9idGFpbmluZyBp\nbmZvcm1hdGlvbgogICAgICogZnJvbSB7QGxpbmsgRGF0YWJhc2VNZXRhRGF0\nYX0uCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Q29sdW1uTmFt\nZUZvck1ldGFkYXRhKFN0cmluZyBjb2x1bW5OYW1lKSB7CiAgICAgICAgcmV0\ndXJuIGNvbnZlcnRTY2hlbWFDYXNlKGNvbHVtbk5hbWUpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIHNjaGVtYSBuYW1l\nIHRvIGEgbmFtZSB0aGF0IHRoZSBkYXRhYmFzZSB3aWxsCiAgICAgKiBiZSBh\nYmxlIHRvIHVuZGVyc3RhbmQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJp\nbmcgY29udmVydFNjaGVtYUNhc2UoU3RyaW5nIG9iamVjdE5hbWUpIHsKICAg\nICAgICBpZiAob2JqZWN0TmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgaWYgKFNDSEVNQV9DQVNFX0xPV0VSLmVxdWFs\ncyhzY2hlbWFDYXNlKSkKICAgICAgICAgICAgcmV0dXJuIG9iamVjdE5hbWUu\ndG9Mb3dlckNhc2UoKTsKICAgICAgICBpZiAoU0NIRU1BX0NBU0VfUFJFU0VS\nVkUuZXF1YWxzKHNjaGVtYUNhc2UpKQogICAgICAgICAgICByZXR1cm4gb2Jq\nZWN0TmFtZTsKICAgICAgICByZXR1cm4gb2JqZWN0TmFtZS50b1VwcGVyQ2Fz\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUHJlcGFyZWQgdGhlIGNvbm5l\nY3Rpb24gZm9yIG1ldGFkYXRhIG9wZXJhdGlvbnMuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBiZWZvcmVNZXRhZGF0YU9wZXJhdGlvbihDb25uZWN0aW9u\nIGMpIHsKICAgICAgICBpZiAocmVxdWlyZXNBdXRvQ29tbWl0Rm9yTWV0YURh\ndGEpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGMucm9s\nbGJhY2soKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNx\nbGUpIHsKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgaWYgKCFjLmdldEF1dG9Db21taXQoKSkKICAgICAgICAgICAg\nICAgICAgICBjLnNldEF1dG9Db21taXQodHJ1ZSk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8KICAgIC8vIFNlcXVlbmNlcyBhbmQgQXV0by1Bc3NpZ24KICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIGxhc3QgZ2VuZXJhdGVkIHZhbHVlIGZvciB0aGUgZ2l2ZW4gY29s\ndW1uLgogICAgICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBieSBkZWZhdWx0IGlm\nIHtAbGluayAjbGFzdEdlbmVyYXRlZEtleVF1ZXJ5fSBpcyBudWxsLgogICAg\nICovCiAgICBwdWJsaWMgT2JqZWN0IGdldEdlbmVyYXRlZEtleShDb2x1bW4g\nY29sLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKGxhc3RHZW5lcmF0ZWRLZXlRdWVyeSA9PSBu\ndWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oX2xv\nYy5nZXQoIm5vLWF1dG8tYXNzaWduIikpOwoKICAgICAgICAvLyByZXBsYWNl\nIHRoaW5ncyBsaWtlICJTRUxFQ1QgTUFYKHswfSkgRlJPTSB7MX0iCiAgICAg\nICAgU3RyaW5nIHF1ZXJ5ID0gbGFzdEdlbmVyYXRlZEtleVF1ZXJ5OwogICAg\nICAgIGlmIChxdWVyeS5pbmRleE9mKCd7JykgIT0gLTEpIC8vIG9ubHkgaWYg\ndGhlIHRva2VuIGlzIGluIHRoZSBzdHJpbmcKICAgICAgICB7CiAgICAgICAg\nICAgIHF1ZXJ5ID0gTWVzc2FnZUZvcm1hdC5mb3JtYXQocXVlcnksIG5ldyBP\nYmplY3RbXXsKICAgICAgICAgICAgICAgIGNvbC5nZXROYW1lKCksIGdldEZ1\nbGxOYW1lKGNvbC5nZXRUYWJsZSgpLCBmYWxzZSksCiAgICAgICAgICAgICAg\nICBnZXRHZW5lcmF0ZWRLZXlTZXF1ZW5jZU5hbWUoY29sKSwKICAgICAgICAg\nICAgfSk7CiAgICAgICAgfQoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBz\ndG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudChxdWVyeSk7CiAgICAgICAg\nUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBycyA9IHN0bW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAgICBpZiAo\nIXJzLm5leHQoKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4\nY2VwdGlvbihfbG9jLmdldCgibm8tZ2Vua2V5IikpOwogICAgICAgICAgICBP\nYmplY3Qga2V5ID0gcnMuZ2V0T2JqZWN0KDEpOwogICAgICAgICAgICBpZiAo\na2V5ID09IG51bGwpCiAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgiaW52YWxpZC1nZW5rZXkiLCBjb2wpKTsKICAgICAgICAgICAgcmV0dXJu\nIGtleTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAocnMg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7IHJzLmNsb3NlKCk7IH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAgICAgdHJ5IHsg\nc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fSAK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNl\ncXVlbmNlIG5hbWUgdXNlZCBieSBkYXRhYmFzZXMgZm9yIHRoZSBnaXZlbiBh\ndXRvYXNzaWduZWQKICAgICAqIGNvbHVtbi4gVGhpcyBpcyBvbmx5IHVzZWQg\nYnkgZGF0YWJhc2VzIHRoYXQgcmVxdWlyZSBhbiBleHBsaWNpdCBuYW1lCiAg\nICAgKiB0byBiZSB1c2VkIGZvciBhdXRvLWFzc2lnbiBzdXBwb3J0LgogICAg\nICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldEdlbmVyYXRlZEtleVNlcXVl\nbmNlTmFtZShDb2x1bW4gY29sKSB7CiAgICAgICAgU3RyaW5nIHRuYW1lID0g\nY29sLmdldFRhYmxlTmFtZSgpOwogICAgICAgIFN0cmluZyBjbmFtZSA9IGNv\nbC5nZXROYW1lKCk7CiAgICAgICAgaW50IG1heCA9IG1heEF1dG9Bc3NpZ25O\nYW1lTGVuZ3RoOwogICAgICAgIGludCBleHRyYUNoYXJzID0gLW1heCArIHRu\nYW1lLmxlbmd0aCgpICsgMSAvLyA8dG5hbWU+ICsgJ18nCiAgICAgICAgICAg\nICsgY25hbWUubGVuZ3RoKCkgKyA0OyAvLyA8Y25hbWU+ICsgJ19TRVEnCiAg\nICAgICAgaWYgKGV4dHJhQ2hhcnMgPiAwKSB7CiAgICAgICAgICAgIC8vIHRo\naXMgYXNzdW1lcyB0aGF0IHRuYW1lIGlzIGxvbmdlciB0aGFuIGV4dHJhQ2hh\ncnMKICAgICAgICAgICAgdG5hbWUgPSB0bmFtZS5zdWJzdHJpbmcoMCwgdG5h\nbWUubGVuZ3RoKCkgLSBleHRyYUNoYXJzKTsKICAgICAgICB9CiAgICAgICAg\nU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIobWF4KTsKICAg\nICAgICBidWYuYXBwZW5kKHRuYW1lKS5hcHBlbmQoIl8iKS5hcHBlbmQoY25h\nbWUpLmFwcGVuZCgiX1NFUSIpOwogICAgICAgIHJldHVybiBidWYudG9TdHJp\nbmcoKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vCiAgICAvLyBDb25maWd1cmFibGUgaW1wbGVtZW50YXRpb24KICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgdm9p\nZCBzZXRDb25maWd1cmF0aW9uKENvbmZpZ3VyYXRpb24gY29uZikgewogICAg\nICAgIHRoaXMuY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikgY29uZjsKICAg\nICAgICB0aGlzLmxvZyA9IHRoaXMuY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3Vy\nYXRpb24uTE9HX0pEQkMpOwoKICAgICAgICAvLyB3YXJuIGFib3V0IHVuc3Vw\ncG9ydGVkIGRpY3RzCiAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkg\nJiYgIWlzU3VwcG9ydGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9sb2Mu\nZ2V0KCJkaWN0LW5vdC1zdXBwb3J0ZWQiLCBnZXRDbGFzcygpKSk7CiAgICB9\nCgogICAgcHJpdmF0ZSBib29sZWFuIGlzU3VwcG9ydGVkKCkgewogICAgICAg\nIC8vIGlmIHRoaXMgaXMgYSBjdXN0b20gZGljdCwgdHJhdmVyc2UgdG8gd2hh\ndGV2ZXIgb3BlbmpwYSBkaWN0IGl0IGV4dGVuZHMKICAgICAgICBDbGFzcyBj\nID0gZ2V0Q2xhc3MoKTsKICAgICAgICB3aGlsZSAoIWMuZ2V0TmFtZSgpLnN0\nYXJ0c1dpdGgoIm9yZy5hcGFjaGUub3BlbmpwYS4iKSkKICAgICAgICAgICAg\nYyA9IGMuZ2V0U3VwZXJjbGFzcygpOwoKICAgICAgICAvLyB0aGUgZ2VuZXJp\nYyBkYmRpY3Rpb25hcnkgaXMgbm90IGNvbnNpZGVyZWQgYSBzdXBwb3J0ZWQg\nZGljdDsgYWxsCiAgICAgICAgLy8gb3RoZXIgY29uY3JldGUgZGljdGlvbmFy\naWVzIGFyZQogICAgICAgIGlmIChjID09IERCRGljdGlvbmFyeS5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJhdGlvbigp\nIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkg\newogICAgICAgIC8vIGluaXRpYWxpemUgdGhlIHNldCBvZiByZXNlcnZlZCBT\nUUw5MiB3b3JkcyBmcm9tIHJlc291cmNlCiAgICAgICAgSW5wdXRTdHJlYW0g\naW4gPSBEQkRpY3Rpb25hcnkuY2xhc3MuZ2V0UmVzb3VyY2VBc1N0cmVhbQog\nICAgICAgICAgICAoInNxbC1rZXl3b3Jkcy5yc3JjIik7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgU3RyaW5nIGtleXdvcmRzID0gbmV3IEJ1ZmZlcmVk\nUmVhZGVyKG5ldyBJbnB1dFN0cmVhbVJlYWRlcihpbikpLgogICAgICAgICAg\nICAgICAgcmVhZExpbmUoKTsKICAgICAgICAgICAgaW4uY2xvc2UoKTsKICAg\nICAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0\nKFN0cmluZ3Muc3BsaXQKICAgICAgICAgICAgICAgIChrZXl3b3JkcywgIiwi\nLCAwKSkpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihpb2UpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7IGluLmNsb3Nl\nKCk7IH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgfQoKICAg\nICAgICAvLyBhZGQgYWRkaXRpb25hbCByZXNlcnZlZCB3b3JkcyBzZXQgYnkg\ndXNlcgogICAgICAgIGlmIChyZXNlcnZlZFdvcmRzICE9IG51bGwpCiAgICAg\nICAgICAgIHJlc2VydmVkV29yZFNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChT\ndHJpbmdzLnNwbGl0CiAgICAgICAgICAgICAgICAocmVzZXJ2ZWRXb3Jkcy50\nb1VwcGVyQ2FzZSgpLCAiLCIsIDApKSk7CgogICAgICAgIC8vIGFkZCBzeXN0\nZW0gc2NoZW1hcyBzZXQgYnkgdXNlcgogICAgICAgIGlmIChzeXN0ZW1TY2hl\nbWFzICE9IG51bGwpCiAgICAgICAgICAgIHN5c3RlbVNjaGVtYVNldC5hZGRB\nbGwoQXJyYXlzLmFzTGlzdChTdHJpbmdzLnNwbGl0CiAgICAgICAgICAgICAg\nICAoc3lzdGVtU2NoZW1hcy50b1VwcGVyQ2FzZSgpLCAiLCIsIDApKSk7Cgog\nICAgICAgIC8vIGFkZCBzeXN0ZW0gdGFibGVzIHNldCBieSB1c2VyCiAgICAg\nICAgaWYgKHN5c3RlbVRhYmxlcyAhPSBudWxsKQogICAgICAgICAgICBzeXN0\nZW1UYWJsZVNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChTdHJpbmdzLnNwbGl0\nCiAgICAgICAgICAgICAgICAoc3lzdGVtVGFibGVzLnRvVXBwZXJDYXNlKCks\nICIsIiwgMCkpKTsKCiAgICAgICAgLy8gYWRkIGZpeGVkIHNpemUgdHlwZSBu\nYW1lcyBzZXQgYnkgdGhlIHVzZXIKICAgICAgICBpZiAoZml4ZWRTaXplVHlw\nZU5hbWVzICE9IG51bGwpCiAgICAgICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1l\nU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0KFN0cmluZ3Muc3BsaXQKICAgICAg\nICAgICAgICAgIChmaXhlZFNpemVUeXBlTmFtZXMudG9VcHBlckNhc2UoKSwg\nIiwiLCAwKSkpOwoKICAgICAgICAvLyBpZiB1c2VyIGhhcyB1bnNldCBzZXF1\nZW5jZSBzcWwsIG51bGwgaXQgb3V0IHNvIHdlIGtub3cgc2VxdWVuY2VzCiAg\nICAgICAgLy8gYXJlbid0IHN1cHBvcnRlZAogICAgICAgIG5leHRTZXF1ZW5j\nZVF1ZXJ5ID0gU3RyaW5nVXRpbHMudHJpbVRvTnVsbChuZXh0U2VxdWVuY2VR\ndWVyeSk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8KICAgIC8vIENvbm5lY3Rpb25EZWNvcmF0b3IgaW1wbGVt\nZW50YXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vCgogICAgLyoqCiAgICAgKiBEZWNvcmF0ZSB0aGUgZ2l2ZW4gY29u\nbmVjdGlvbiBpZiBuZWVkZWQuIFNvbWUgZGF0YWJhc2VzIHJlcXVpcmUgc3Bl\nY2lhbAogICAgICogaGFuZGxpbmcgZm9yIEpEQkMgYnVncy4gVGhpcyBpbXBs\nZW1lbnRhdGlvbiBpc3N1ZXMgYW55CiAgICAgKiB7QGxpbmsgI2luaXRpYWxp\nemF0aW9uU1FMfSB0aGF0IGhhcyBiZWVuIHNldCBmb3IgdGhlIGRpY3Rpb25h\ncnkgYnV0CiAgICAgKiBkb2VzIG5vdCBkZWNvcmVhdGUgdGhlIGNvbm5lY3Rp\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBDb25uZWN0aW9uIGRlY29yYXRlKENv\nbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIWNvbm5lY3RlZCkKICAgICAgICAgICAgY29ubmVjdGVk\nQ29uZmlndXJhdGlvbihjb25uKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxz\nLmlzRW1wdHkoaW5pdGlhbGl6YXRpb25TUUwpKSB7CiAgICAgICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVt\nZW50KGluaXRpYWxpemF0aW9uU1FMKTsKICAgICAgICAgICAgICAgIHN0bW50\nLmV4ZWN1dGUoKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoZS50b1N0cmluZygpLCBl\nKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlm\nIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBjb25uOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVt\nZW50YXRpb24gb2YgdGhlCiAgICAgKiB7QGxpbmsgTG9nZ2luZ0Nvbm5lY3Rp\nb25EZWNvcmF0b3IuU1FMV2FybmluZ0hhbmRsZXJ9IGludGVyZmFjZQogICAg\nICogdGhhdCBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgYWN0aW9ucyB0\nbyBwZXJmb3JtIHdoZW4gYQogICAgICoge0BsaW5rIFNRTFdhcm5pbmd9IG9j\nY3VycyBhdCBhbnkgcG9pbnQgb24gYSB7QGxpbmsgQ29ubmVjdGlvbn0sCiAg\nICAgKiB7QGxpbmsgU3RhdGVtZW50fSwgb3Ige0BsaW5rIFJlc3VsdFNldH0u\nIFRoaXMgbWV0aG9kIG1heQogICAgICogYmUgdXNlZCBkZXRlcm1pbmUgdGhv\nc2Ugd2FybmluZ3MgdGhlIGFwcGxpY2F0aW9uIHdhbnRzIHRvCiAgICAgKiBj\nb25zaWRlciBjcml0aWNhbCBmYWlsdXJlcywgYW5kIHRocm93IHRoZSB3YXJu\naW5nIGluIHRob3NlCiAgICAgKiBjYXNlcy4gQnkgZGVmYXVsdCwgdGhpcyBt\nZXRob2QgZG9lcyBub3RoaW5nLgogICAgICoKICAgICAqIEBzZWUgTG9nZ2lu\nZ0Nvbm5lY3Rpb25EZWNvcmF0b3Ijc2V0V2FybmluZ0FjdGlvbgogICAgICog\nQHNlZSBMb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvciNzZXRXYXJuaW5nSGFu\nZGxlcgogICAgICovCiAgICBwdWJsaWMgdm9pZCBoYW5kbGVXYXJuaW5nKFNR\nTFdhcm5pbmcgd2FybmluZykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIG5ldyBleGNlcHRp\nb24gdGhhdCB3cmFwcyA8Y29kZT5jYXVzZXM8L2NvZGU+LgogICAgICogSG93\nZXZlciwgdGhlIGRldGFpbHMgb2YgZXhhY3RseSB3aGF0IHR5cGUgb2YgZXhj\nZXB0aW9uIGlzIHJldHVybmVkIGNhbgogICAgICogYmUgZGV0ZXJtaW5lZCBi\neSB0aGUgaW1wbGVtZW50YXRpb24uIFRoaXMgbWF5IHRha2UgaW50byBhY2Nv\ndW50CiAgICAgKiBEQi1zcGVjaWZpYyBleGNlcHRpb24gaW5mb3JtYXRpb24g\naW4gPGNvZGU+Y2F1c2VzPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIE9w\nZW5KUEFFeGNlcHRpb24gbmV3U3RvcmVFeGNlcHRpb24oU3RyaW5nIG1zZywg\nU1FMRXhjZXB0aW9uW10gY2F1c2VzLAogICAgICAgIE9iamVjdCBmYWlsZWQp\nIHsKICAgICAgICBpZiAoY2F1c2VzLmxlbmd0aCA+IDAgJiYgIjIzMDAwIi5l\ncXVhbHMoY2F1c2VzWzBdLmdldFNRTFN0YXRlKCkpKQogICAgICAgICAgICBy\nZXR1cm4gbmV3IFJlZmVyZW50aWFsSW50ZWdyaXR5RXhjZXB0aW9uKG1zZyku\nCiAgICAgICAgICAgICAgICBzZXRGYWlsZWRPYmplY3QoZmFpbGVkKS5zZXRO\nZXN0ZWRUaHJvd2FibGVzKGNhdXNlcyk7CiAgICAgICAgcmV0dXJuIG5ldyBT\ndG9yZUV4Y2VwdGlvbihtc2cpLnNldEZhaWxlZE9iamVjdChmYWlsZWQpLgog\nICAgICAgICAgICBzZXROZXN0ZWRUaHJvd2FibGVzKGNhdXNlcyk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDbG9zZXMgdGhlIHNwZWNpZmllZCB7QGxpbmsg\nRGF0YVNvdXJjZX0gYW5kIHJlbGVhc2VzIGFueQogICAgICogcmVzb3VyY2Vz\nIGFzc29jaWF0ZWQgd2l0aCBpdC4KICAgICAqCiAgICAgKiBAcGFyYW0gZGF0\nYVNvdXJjZSB0aGUgRGF0YVNvdXJjZSB0byBjbG9zZQogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBjbG9zZURhdGFTb3VyY2UoRGF0YVNvdXJjZSBkYXRhU291\ncmNlKSB7CiAgICAgICAgRGF0YVNvdXJjZUZhY3RvcnkuY2xvc2VEYXRhU291\ncmNlKGRhdGFTb3VyY2UpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlZCBi\neSBzb21lIG1hcHBpbmdzIHRvIHJlcHJlc2VudCBkYXRhIHRoYXQgaGFzIGFs\ncmVhZHkgYmVlbgogICAgICogc2VyaWFsaXplZCBzbyB0aGF0IHdlIGRvbid0\nIGhhdmUgdG8gc2VyaWFsaXplIG11bHRpcGxlIHRpbWVzLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGNsYXNzIFNlcmlhbGl6ZWREYXRhIHsKCiAgICAg\nICAgcHVibGljIGZpbmFsIGJ5dGVbXSBieXRlczsKCiAgICAgICAgcHVibGlj\nIFNlcmlhbGl6ZWREYXRhKGJ5dGVbXSBieXRlcykgewogICAgICAgICAgICB0\naGlzLmJ5dGVzID0gYnl0ZXM7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

