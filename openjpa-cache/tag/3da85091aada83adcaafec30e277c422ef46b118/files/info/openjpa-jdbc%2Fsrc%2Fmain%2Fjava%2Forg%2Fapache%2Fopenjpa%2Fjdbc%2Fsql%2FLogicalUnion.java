{"sha":"dcb4ce76acf58654024e084e6e5074ca7f96035e","node_id":"MDQ6QmxvYjIwNjM2NDpkY2I0Y2U3NmFjZjU4NjU0MDI0ZTA4NGU2ZTUwNzRjYTdmOTYwMzVl","size":27533,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dcb4ce76acf58654024e084e6e5074ca7f96035e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwppbXBvcnQgamF2YS51dGlsLkJpdFNldDsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwpp\nbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxp\nc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJD\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVp\nZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEu\nVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJu\nYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5V\nbnN1cHBvcnRlZEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLlVzZXJFeGNlcHRpb247CgovKioKICogQSBsb2dpY2FsIHVuaW9u\nIG1hZGUgdXAgb2YgbXVsdGlwbGUgZGlzdGluY3Qgc2VsZWN0cyB3aG9zZSBy\nZXN1bHRzIGFyZQogKiBjb21iaW5lZCBpbiBtZW1vcnkuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgTG9naWNhbFVuaW9uCiAg\nICBpbXBsZW1lbnRzIFVuaW9uIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAg\nICAgKExvZ2ljYWxVbmlvbi5jbGFzcyk7CgogICAgcHJvdGVjdGVkIGZpbmFs\nIFVuaW9uU2VsZWN0W10gc2VsczsKICAgIHByb3RlY3RlZCBmaW5hbCBEQkRp\nY3Rpb25hcnkgZGljdDsKICAgIHByb3RlY3RlZCBmaW5hbCBDbGFzc01hcHBp\nbmdbXSBtYXBwaW5nczsKICAgIHByb3RlY3RlZCBmaW5hbCBCaXRTZXQgZGVz\nYyA9IG5ldyBCaXRTZXQoKTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZGlzdGlu\nY3QgPSB0cnVlOwogICAKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLgog\nICAgICoKICAgICAqIEBwYXJhbSBjb25mIHN5c3RlbSBjb25maWd1cmF0aW9u\nCiAgICAgKiBAcGFyYW0gc2VscyB0aGUgbnVtYmVyIG9mIFNRTCBzZWxlY3Rz\nIHRvIHVuaW9uIHRvZ2V0aGVyCiAgICAgKi8KICAgIHB1YmxpYyBMb2dpY2Fs\nVW5pb24oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgaW50IHNlbHMpIHsKICAg\nICAgICB0aGlzKGNvbmYsIHNlbHMsIG51bGwpOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29uc3RydWN0b3IgdXNlZCB0byBzZWVkIHRoZSBpbnRlcm5hbCBz\nZWxlY3RzLgogICAgICovCiAgICBwdWJsaWMgTG9naWNhbFVuaW9uKEpEQkND\nb25maWd1cmF0aW9uIGNvbmYsIFNlbGVjdFtdIHNlZWRzKSB7CiAgICAgICAg\ndGhpcyhjb25mLCBzZWVkcy5sZW5ndGgsIHNlZWRzKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIERlbGVnYXRlIGNvbnN0cnVjdG9yLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgTG9naWNhbFVuaW9uKEpEQkNDb25maWd1cmF0aW9uIGNvbmYs\nIGludCBzZWxzLCBTZWxlY3RbXSBzZWVkcykgewogICAgICAgIGlmIChzZWxz\nID09IDApCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlv\nbigic2VscyA9PSAwIik7CgogICAgICAgIGRpY3QgPSBjb25mLmdldERCRGlj\ndGlvbmFyeUluc3RhbmNlKCk7CiAgICAgICAgbWFwcGluZ3MgPSBuZXcgQ2xh\nc3NNYXBwaW5nW3NlbHNdOwogICAgICAgIHRoaXMuc2VscyA9IG5ldyBVbmlv\nblNlbGVjdFtzZWxzXTsKCiAgICAgICAgU2VsZWN0SW1wbCBzZWVkOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2VsczsgaSsrKSB7CiAgICAgICAg\nICAgIHNlZWQgPSAoc2VlZHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgID8g\nKFNlbGVjdEltcGwpIGNvbmYuZ2V0U1FMRmFjdG9yeUluc3RhbmNlKCkubmV3\nU2VsZWN0KCkKICAgICAgICAgICAgICAgIDogKFNlbGVjdEltcGwpIHNlZWRz\nW2ldOwogICAgICAgICAgICB0aGlzLnNlbHNbaV0gPSBuZXdVbmlvblNlbGVj\ndChzZWVkLCBpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBD\ncmVhdGUgYSBuZXcgdW5pb24gc2VsZWN0IHdpdGggdGhlIGdpdmVuIGRlbGVn\nYXRlIGFuZCB1bmlvbiBwb3NpdGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFVuaW9uU2VsZWN0IG5ld1VuaW9uU2VsZWN0KFNlbGVjdEltcGwgc2VlZCwg\naW50IHBvcykgewogICAgICAgIHJldHVybiBuZXcgVW5pb25TZWxlY3Qoc2Vl\nZCwgcG9zKTsKICAgIH0KCiAgICBwdWJsaWMgU2VsZWN0W10gZ2V0U2VsZWN0\ncygpIHsKICAgICAgICByZXR1cm4gc2VsczsKICAgIH0KICAgCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1VuaW9uKCkgewogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhYm9ydFVuaW9uKCkgewogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0T3JkZXJpbmcoKSB7CiAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIEpEQkNDb25maWd1cmF0aW9u\nIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0u\nZ2V0Q29uZmlndXJhdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBEQkRpY3Rp\nb25hcnkgZ2V0REJEaWN0aW9uYXJ5KCkgewogICAgICAgIHJldHVybiBkaWN0\nOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TZWxlY3QoYm9vbGVh\nbiBmb3JVcGRhdGUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsK\nICAgICAgICByZXR1cm4gZGljdC50b1NlbGVjdChzZWxzWzBdLCBmb3JVcGRh\ndGUsIGZldGNoKTsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIHRvU2Vs\nZWN0Q291bnQoKSB7CiAgICAgICAgcmV0dXJuIGRpY3QudG9TZWxlY3RDb3Vu\ndChzZWxzWzBdKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRBdXRv\nRGlzdGluY3QoKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0uZ2V0QXV0b0Rp\nc3RpbmN0KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0Rpc3Rp\nbmN0KGJvb2xlYW4gZGlzdGluY3QpIHsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHNlbHNbaV0u\nc2V0QXV0b0Rpc3RpbmN0KGRpc3RpbmN0KTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0Rpc3RpbmN0KCkgewogICAgICAgIHJldHVybiBfZGlzdGlu\nY3Q7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGlzdGluY3QoYm9vbGVh\nbiBkaXN0aW5jdCkgewogICAgICAgIF9kaXN0aW5jdCA9IGRpc3RpbmN0Owog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzTFJTKCkgewogICAgICAgIHJl\ndHVybiBzZWxzWzBdLmlzTFJTKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0TFJTKGJvb2xlYW4gbHJzKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzZWxzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZWxzW2ldLnNl\ndExSUyhscnMpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0RXhwZWN0ZWRS\nZXN1bHRDb3VudCgpIHsKICAgICAgICByZXR1cm4gc2Vsc1swXS5nZXRFeHBl\nY3RlZFJlc3VsdENvdW50KCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIHNldEV4cGVjdGVkUmVzdWx0Q291bnQoaW50IGV4cGVjdGVkUmVzdWx0Q291\nbnQsCiAgICAgICAgYm9vbGVhbiBmb3JjZSkgewogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgc2Vscy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgc2Vs\nc1tpXS5zZXRFeHBlY3RlZFJlc3VsdENvdW50KGV4cGVjdGVkUmVzdWx0Q291\nbnQsIGZvcmNlKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldEpvaW5TeW50\nYXgoKSB7CiAgICAgICAgcmV0dXJuIHNlbHNbMF0uZ2V0Sm9pblN5bnRheCgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEpvaW5TeW50YXgoaW50IHN5\nbnRheCkgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgc2Vsc1tpXS5zZXRKb2luU3ludGF4KHN5\nbnRheCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5k\nb21BY2Nlc3MoYm9vbGVhbiBmb3JVcGRhdGUpIHsKICAgICAgICBpZiAoc2Vs\ncy5sZW5ndGggPT0gMSkKICAgICAgICAgICAgcmV0dXJuIHNlbHNbMF0uc3Vw\ncG9ydHNSYW5kb21BY2Nlc3MoZm9yVXBkYXRlKTsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2Nr\naW5nKCkgewogICAgICAgIGlmIChzZWxzLmxlbmd0aCA9PSAxKQogICAgICAg\nICAgICByZXR1cm4gc2Vsc1swXS5zdXBwb3J0c0xvY2tpbmcoKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIGlmICghc2Vsc1tpXS5zdXBwb3J0c0xvY2tpbmcoKSkKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENvdW50KEpEQkNTdG9yZSBzdG9y\nZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpbnQg\nY291bnQgPSAwOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vscy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgY291bnQgKz0gc2Vsc1tpXS5nZXRD\nb3VudChzdG9yZSk7CiAgICAgICAgcmV0dXJuIGNvdW50OwogICAgfQoKICAg\nIHB1YmxpYyBSZXN1bHQgZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKGZldGNoID09IG51bGwpCiAgICAgICAg\nICAgIGZldGNoID0gc3RvcmUuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgcmV0dXJuIGV4ZWN1dGUoc3RvcmUsIGZldGNoLCBmZXRjaC5nZXRS\nZWFkTG9ja0xldmVsKCkpOwogICAgfQoKICAgIHB1YmxpYyBSZXN1bHQgZXhl\nY3V0ZShKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24g\nZmV0Y2gsCiAgICAgICAgaW50IGxvY2tMZXZlbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoZmV0Y2ggPT0gbnVsbCkKICAg\nICAgICAgICAgZmV0Y2ggPSBzdG9yZS5nZXRGZXRjaENvbmZpZ3VyYXRpb24o\nKTsKCiAgICAgICAgaWYgKHNlbHMubGVuZ3RoID09IDEpIHsKICAgICAgICAg\nICAgUmVzdWx0IHJlcyA9IHNlbHNbMF0uZXhlY3V0ZShzdG9yZSwgZmV0Y2gs\nIGxvY2tMZXZlbCk7CiAgICAgICAgICAgICgoQWJzdHJhY3RSZXN1bHQpIHJl\ncykuc2V0QmFzZU1hcHBpbmcobWFwcGluZ3NbMF0pOwogICAgICAgICAgICBy\nZXR1cm4gcmVzOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdldEV4cGVjdGVk\nUmVzdWx0Q291bnQoKSA9PSAxKSB7CiAgICAgICAgICAgIEFic3RyYWN0UmVz\ndWx0IHJlczsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICByZXMgPSAoQWJzdHJh\nY3RSZXN1bHQpIHNlbHNbaV0uZXhlY3V0ZShzdG9yZSwgZmV0Y2gsCiAgICAg\nICAgICAgICAgICAgICAgbG9ja0xldmVsKTsKICAgICAgICAgICAgICAgIHJl\ncy5zZXRCYXNlTWFwcGluZyhtYXBwaW5nc1tpXSk7CiAgICAgICAgICAgICAg\nICByZXMuc2V0SW5kZXhPZihpKTsKCiAgICAgICAgICAgICAgICAvLyBpZiB3\nZSBnZXQgdG8gdGhlIGxhc3Qgc2VsZWN0LCBqdXN0IHJldHVybiBpdHMgcmVz\ndWx0CiAgICAgICAgICAgICAgICBpZiAoaSA9PSBzZWxzLmxlbmd0aCAtIDEp\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKCiAgICAgICAgICAg\nICAgICAvLyByZXR1cm4gdGhlIGZpcnN0IHJlc3VsdCB0aGF0IGhhcyBhIHJv\ndwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBp\nZiAoIXJlcy5uZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5j\nbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAg\nICAgICAgICAgICAgICByZXMucHVzaEJhY2soKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzLmNsb3NlKCk7\nCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgc2U7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGNyZWF0\nZSBhIHNpbmdsZSByZXN1bHQgZnJvbSBlYWNoIHNlbGVjdCBpbiBvdXIgZmFr\nZSB1bmlvbiwgbWVyZ2luZwogICAgICAgIC8vIHRoZW0gYXMgbmVlZGVkCiAg\nICAgICAgQWJzdHJhY3RSZXN1bHRbXSByZXMgPSBuZXcgQWJzdHJhY3RSZXN1\nbHRbc2Vscy5sZW5ndGhdOwogICAgICAgIExpc3RbXSBvcmRlcklkeHMgPSBu\ndWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIExpc3QgbDsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgICAgIHJlc1tpXSA9IChBYnN0cmFjdFJlc3VsdCkgc2Vs\nc1tpXS5leGVjdXRlKHN0b3JlLCBmZXRjaCwKICAgICAgICAgICAgICAgICAg\nICBsb2NrTGV2ZWwpOwogICAgICAgICAgICAgICAgcmVzW2ldLnNldEJhc2VN\nYXBwaW5nKG1hcHBpbmdzW2ldKTsKICAgICAgICAgICAgICAgIHJlc1tpXS5z\nZXRJbmRleE9mKGkpOwoKICAgICAgICAgICAgICAgIGwgPSBzZWxzW2ldLmdl\ndFNlbGVjdGVkT3JkZXJJbmRleGVzKCk7CiAgICAgICAgICAgICAgICBpZiAo\nbCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9yZGVySWR4\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICBvcmRlcklkeHMg\nPSBuZXcgTGlzdFtzZWxzLmxlbmd0aF07CiAgICAgICAgICAgICAgICAgICAg\nb3JkZXJJZHhzW2ldID0gbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgcmVzW2ldICE9IG51bGw7IGkrKykK\nICAgICAgICAgICAgICAgIHJlc1tpXS5jbG9zZSgpOwogICAgICAgICAgICB0\naHJvdyBzZTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIG11bHRpcGxlIHNl\nbGVjdHMgaGF2ZSBvcmRlcmluZywgdXNlIGEgY29tcGFyYXRvciB0byBjb2xs\nYXRlCiAgICAgICAgUmVzdWx0Q29tcGFyYXRvciBjb21wID0gbnVsbDsKICAg\nICAgICBpZiAob3JkZXJJZHhzICE9IG51bGwpCiAgICAgICAgICAgIGNvbXAg\nPSBuZXcgUmVzdWx0Q29tcGFyYXRvcihvcmRlcklkeHMsIGRlc2MsIGRpY3Qp\nOwogICAgICAgIHJldHVybiBuZXcgTWVyZ2VkUmVzdWx0KHJlcywgY29tcCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2VsZWN0KFVuaW9uLlNlbGVjdG9y\nIHNlbGVjdG9yKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZWxz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZWxlY3Rvci5zZWxlY3Qoc2Vs\nc1tpXSwgaSk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygp\nIHsKICAgICAgICByZXR1cm4gdG9TZWxlY3QoZmFsc2UsIG51bGwpLmdldFNR\nTCgpOwogICAgfQoKICAgIC8qKgogICAgICogQSBjYWxsYmFjayB1c2VkIHRv\nIGNyZWF0ZSB0aGUgc2VsZWN0cyBpbiBhIFNRTCB1bmlvbi4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgU2VsZWN0b3IgewoKICAgICAg\nICAvKioKICAgICAgICAgKiBQb3B1bGF0ZSB0aGUgPGNvZGU+aTwvY29kZT50\naCBzZWxlY3QgaW4gdGhlIHVuaW9uLgogICAgICAgICAqLwogICAgICAgIHB1\nYmxpYyB2b2lkIHNlbGVjdChTZWxlY3Qgc2VsLCBpbnQgaSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBIHNlbGVjdCB0aGF0IGlzIHBhcnQgb2YgYSBsb2dp\nY2FsIHVuaW9uLgogICAgICovCiAgICBwcm90ZWN0ZWQgY2xhc3MgVW5pb25T\nZWxlY3QKICAgICAgICBpbXBsZW1lbnRzIFNlbGVjdCB7CgogICAgICAgIHBy\nb3RlY3RlZCBmaW5hbCBTZWxlY3RJbXBsIHNlbDsKICAgICAgICBwcm90ZWN0\nZWQgZmluYWwgaW50IHBvczsKICAgICAgICBwcm90ZWN0ZWQgaW50IG9yZGVy\ncyA9IDA7CiAgICAgICAgcHJvdGVjdGVkIExpc3Qgb3JkZXJJZHhzID0gbnVs\nbDsKICAgICAgIAogICAgICAgIHB1YmxpYyBVbmlvblNlbGVjdChTZWxlY3RJ\nbXBsIHNlbCwgaW50IHBvcykgewogICAgICAgICAgICB0aGlzLnNlbCA9IHNl\nbDsKICAgICAgICAgICAgdGhpcy5wb3MgPSBwb3M7CiAgICAgICAgICAgIHNl\nbC5zZXRSZWNvcmRPcmRlcmVkSW5kZXhlcyh0cnVlKTsKICAgICAgICB9Cgog\nICAgICAgIC8qKgogICAgICAgICAqIERlbGVnYXRlIHNlbGVjdC4KICAgICAg\nICAgKi8KICAgICAgICBwdWJsaWMgU2VsZWN0SW1wbCBnZXREZWxlZ2F0ZSgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbDsKICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIFJldHVybiB0aGUgaW5kZXhlcyBvZiB0aGUgZGF0\nYSBpbiB0aGUgc2VsZWN0IGNsYXVzZSB0aGlzIHF1ZXJ5IGlzCiAgICAgICAg\nICogb3JkZXJlZCBieS4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgTGlz\ndCBnZXRTZWxlY3RlZE9yZGVySW5kZXhlcygpIHsKICAgICAgICAgICAgaWYg\nKG9yZGVySWR4cyA9PSBudWxsKQogICAgICAgICAgICAgICAgb3JkZXJJZHhz\nID0gc2VsLmdldE9yZGVyZWRJbmRleGVzKCk7CiAgICAgICAgICAgIHJldHVy\nbiBvcmRlcklkeHM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSkRCQ0Nv\nbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICAgICAg\ncmV0dXJuIHNlbC5nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgaW50IGluZGV4T2YoKSB7CiAgICAgICAgICAgIHJldHVy\nbiBwb3M7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU1FMQnVmZmVyIHRv\nU2VsZWN0KGJvb2xlYW4gZm9yVXBkYXRlLAogICAgICAgICAgICBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgICAgIHJldHVybiBz\nZWwudG9TZWxlY3QoZm9yVXBkYXRlLCBmZXRjaCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgU1FMQnVmZmVyIHRvU2VsZWN0Q291bnQoKSB7CiAgICAg\nICAgICAgIHJldHVybiBzZWwudG9TZWxlY3RDb3VudCgpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gZ2V0QXV0b0Rpc3RpbmN0KCkgewog\nICAgICAgICAgICByZXR1cm4gc2VsLmdldEF1dG9EaXN0aW5jdCgpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0QXV0b0Rpc3RpbmN0KGJv\nb2xlYW4gZGlzdGluY3QpIHsKICAgICAgICAgICAgc2VsLnNldEF1dG9EaXN0\naW5jdChkaXN0aW5jdCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBpc0Rpc3RpbmN0KCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmlz\nRGlzdGluY3QoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNl\ndERpc3RpbmN0KGJvb2xlYW4gZGlzdGluY3QpIHsKICAgICAgICAgICAgc2Vs\nLnNldERpc3RpbmN0KGRpc3RpbmN0KTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBib29sZWFuIGlzTFJTKCkgewogICAgICAgICAgICByZXR1cm4gc2Vs\nLmlzTFJTKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRM\nUlMoYm9vbGVhbiBscnMpIHsKICAgICAgICAgICAgc2VsLnNldExSUyhscnMp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBnZXRKb2luU3ludGF4\nKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEpvaW5TeW50YXgoKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEpvaW5TeW50YXgo\naW50IGpvaW5TeW50YXgpIHsKICAgICAgICAgICAgc2VsLnNldEpvaW5TeW50\nYXgoam9pblN5bnRheCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBzdXBwb3J0c1JhbmRvbUFjY2Vzcyhib29sZWFuIGZvclVwZGF0ZSkg\newogICAgICAgICAgICByZXR1cm4gc2VsLnN1cHBvcnRzUmFuZG9tQWNjZXNz\nKGZvclVwZGF0ZSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c0xvY2tpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\nc3VwcG9ydHNMb2NraW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\naW50IGdldENvdW50KEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0\nQ291bnQoc3RvcmUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJlc3Vs\ndCBleGVjdXRlKEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuZXhlY3V0ZShzdG9yZSwgZmV0Y2gp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJlc3VsdCBleGVjdXRlKEpE\nQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwK\nICAgICAgICAgICAgaW50IGxvY2tMZXZlbCkKICAgICAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZXhlY3V0\nZShzdG9yZSwgZmV0Y2gsIGxvY2tMZXZlbCk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgTGlzdCBnZXRTdWJzZWxlY3RzKCkgewogICAgICAgICAgICBy\nZXR1cm4gQ29sbGVjdGlvbnMuRU1QVFlfTElTVDsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBTZWxlY3QgZ2V0UGFyZW50KCkgewogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0U3Vic2VsZWN0UGF0aCgpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRQYXJlbnQoU2Vs\nZWN0IHBhcmVudCwgU3RyaW5nIHBhdGgpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bmlvbi1lbGVt\nZW50IikpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNlbGVjdCBnZXRG\ncm9tU2VsZWN0KCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldEZyb21TZWxlY3QoU2VsZWN0\nIHNlbCkgewogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oX2xvYy5nZXQoInVuaW9uLWVsZW1lbnQiKSk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNFYWdlckpvaW4oYm9vbGVhbiB0\nb01hbnkpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5oYXNFYWdlckpvaW4o\ndG9NYW55KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGhh\nc0pvaW4oYm9vbGVhbiB0b01hbnkpIHsKICAgICAgICAgICAgcmV0dXJuIHNl\nbC5oYXNKb2luKHRvTWFueSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBpc1NlbGVjdGVkKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgICAg\nIHJldHVybiBzZWwuaXNTZWxlY3RlZCh0YWJsZSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRUYWJsZUFsaWFzZXMoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWwuZ2V0VGFibGVBbGlhc2VzKCk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgTGlzdCBnZXRTZWxlY3RBbGlhc2VzKCkg\newogICAgICAgICAgICByZXR1cm4gc2VsLmdldFNlbGVjdEFsaWFzZXMoKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBMaXN0IGdldElkZW50aWZpZXJB\nbGlhc2VzKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldElkZW50aWZp\nZXJBbGlhc2VzKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU1FMQnVm\nZmVyIGdldE9yZGVyaW5nKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdl\ndE9yZGVyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU1FMQnVm\nZmVyIGdldEdyb3VwaW5nKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdl\ndEdyb3VwaW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU1FMQnVm\nZmVyIGdldFdoZXJlKCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldFdo\nZXJlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU1FMQnVmZmVyIGdl\ndEhhdmluZygpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRIYXZpbmco\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGFkZEpvaW5DbGFz\nc0NvbmRpdGlvbnMoKSB7CiAgICAgICAgICAgIHNlbC5hZGRKb2luQ2xhc3ND\nb25kaXRpb25zKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMg\nZ2V0Sm9pbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0Sm9pbnMo\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBJdGVyYXRvciBnZXRKb2lu\nSXRlcmF0b3IoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0Sm9pbkl0\nZXJhdG9yKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgbG9uZyBnZXRT\ndGFydEluZGV4KCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldFN0YXJ0\nSW5kZXgoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBsb25nIGdldEVu\nZEluZGV4KCkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldEVuZEluZGV4\nKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRSYW5nZShs\nb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAgICAgICBzZWwuc2V0UmFu\nZ2Uoc3RhcnQsIGVuZCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3Ry\naW5nIGdldENvbHVtbkFsaWFzKENvbHVtbiBjb2wpIHsKICAgICAgICAgICAg\ncmV0dXJuIHNlbC5nZXRDb2x1bW5BbGlhcyhjb2wpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIFN0cmluZyBnZXRDb2x1bW5BbGlhcyhDb2x1bW4gY29s\nLCBKb2lucyBqb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldENv\nbHVtbkFsaWFzKGNvbCwgam9pbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIFN0cmluZyBnZXRDb2x1bW5BbGlhcyhTdHJpbmcgY29sLCBUYWJsZSB0\nYWJsZSkgewogICAgICAgICAgICByZXR1cm4gc2VsLmdldENvbHVtbkFsaWFz\nKGNvbCwgdGFibGUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmlu\nZyBnZXRDb2x1bW5BbGlhcyhTdHJpbmcgY29sLCBUYWJsZSB0YWJsZSwgSm9p\nbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRDb2x1bW5B\nbGlhcyhjb2wsIHRhYmxlLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBpc0FnZ3JlZ2F0ZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuIHNlbC5pc0FnZ3JlZ2F0ZSgpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIHZvaWQgc2V0QWdncmVnYXRlKGJvb2xlYW4gYWdnKSB7CiAgICAgICAg\nICAgIHNlbC5zZXRBZ2dyZWdhdGUoYWdnKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBib29sZWFuIGlzTG9iKCkgewogICAgICAgICAgICByZXR1cm4g\nc2VsLmlzTG9iKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBz\nZXRMb2IoYm9vbGVhbiBsb2IpIHsKICAgICAgICAgICAgc2VsLnNldExvYihs\nb2IpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2VsZWN0UGxh\nY2Vob2xkZXIoU3RyaW5nIHNxbCkgewogICAgICAgICAgICBzZWwuc2VsZWN0\nUGxhY2Vob2xkZXIoc3FsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIGNsZWFyU2VsZWN0cygpIHsKICAgICAgICAgICAgc2VsLmNsZWFyU2Vs\nZWN0cygpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gc2Vs\nZWN0KFNRTEJ1ZmZlciBzcWwsIE9iamVjdCBpZCkgewogICAgICAgICAgICBy\nZXR1cm4gc2VsLnNlbGVjdChzcWwsIGlkKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBib29sZWFuIHNlbGVjdChTUUxCdWZmZXIgc3FsLCBPYmplY3Qg\naWQsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2Vs\nZWN0KHNxbCwgaWQsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIHNlbGVjdChTdHJpbmcgc3FsLCBPYmplY3QgaWQpIHsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3Qoc3FsLCBpZCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBzZWxlY3QoU3RyaW5nIHNxbCwg\nT2JqZWN0IGlkLCBKb2lucyBqb2lucykgewogICAgICAgICAgICByZXR1cm4g\nc2VsLnNlbGVjdChzcWwsIGlkLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBzZWxlY3QoQ29sdW1uIGNvbCkgewogICAgICAg\nICAgICByZXR1cm4gc2VsLnNlbGVjdChjb2wpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gc2VsZWN0KENvbHVtbiBjb2wsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwuc2VsZWN0KGNvbCwgam9p\nbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBzZWxlY3QoQ29s\ndW1uW10gY29scykgewogICAgICAgICAgICByZXR1cm4gc2VsLnNlbGVjdChj\nb2xzKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2VsZWN0KENv\nbHVtbltdIGNvbHMsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHJldHVy\nbiBzZWwuc2VsZWN0KGNvbHMsIGpvaW5zKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyB2b2lkIHNlbGVjdChDbGFzc01hcHBpbmcgbWFwcGluZywgaW50\nIHN1YmNsYXNzZXMsCiAgICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRC\nQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgaW50IGVhZ2VyKSB7CiAgICAg\nICAgICAgIHNlbGVjdChtYXBwaW5nLCBzdWJjbGFzc2VzLCBzdG9yZSwgZmV0\nY2gsIGVhZ2VyLCBudWxsLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzZWxlY3QoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIGludCBz\ndWJjbGFzc2VzLAogICAgICAgICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlciwKICAgICAgICAg\nICAgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgc2VsZWN0KG1hcHBpbmcs\nIHN1YmNsYXNzZXMsIHN0b3JlLCBmZXRjaCwgZWFnZXIsIGpvaW5zLCBmYWxz\nZSk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgc2VsZWN0KENs\nYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywKICAgICAgICAg\nICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoLCBpbnQgZWFnZXIsCiAgICAgICAgICAgIEpvaW5zIGpvaW5zLCBib29s\nZWFuIGlkZW50aWZpZXIpIHsKICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyB0\naGUgZmlyc3QgKHByaW1hcnkpIG1hcHBpbmcgc2VsZWN0ZWQgZm9yIHRoaXMK\nICAgICAgICAgICAgLy8gU0VMRUNULCByZWNvcmQgaXQgc28gd2UgY2FuIGZp\nZ3VyZSBvdXQgd2hhdCB0aGUgcmVzdWx0IHR5cGUgaXMKICAgICAgICAgICAg\nLy8gc2luY2UgdGhlIGRpc2NyaW1pbmF0b3IgbWlnaHQgbm90IGJlIHNlbGVj\ndGVkCiAgICAgICAgICAgIGlmIChtYXBwaW5nc1twb3NdID09IG51bGwpCiAg\nICAgICAgICAgICAgICBtYXBwaW5nc1twb3NdID0gbWFwcGluZzsKCiAgICAg\nICAgICAgIHNlbC5zZWxlY3QodGhpcywgbWFwcGluZywgc3ViY2xhc3Nlcywg\nc3RvcmUsIGZldGNoLCBlYWdlciwKICAgICAgICAgICAgICAgIGpvaW5zLCBp\nZGVudGlmaWVyKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIHNlbGVjdElkZW50aWZpZXIoQ29sdW1uIGNvbCkgewogICAgICAgICAgICBy\nZXR1cm4gc2VsLnNlbGVjdElkZW50aWZpZXIoY29sKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBib29sZWFuIHNlbGVjdElkZW50aWZpZXIoQ29sdW1u\nIGNvbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5z\nZWxlY3RJZGVudGlmaWVyKGNvbCwgam9pbnMpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGludCBzZWxlY3RJZGVudGlmaWVyKENvbHVtbltdIGNvbHMp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5zZWxlY3RJZGVudGlmaWVyKGNv\nbHMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBzZWxlY3RJZGVu\ndGlmaWVyKENvbHVtbltdIGNvbHMsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAg\nICAgIHJldHVybiBzZWwuc2VsZWN0SWRlbnRpZmllcihjb2xzLCBqb2lucyk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZWxlY3RJZGVudGlm\naWVyKENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xhc3NlcywKICAg\nICAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGZldGNoLCBpbnQgZWFnZXIpIHsKICAgICAgICAgICAgc2VsZWN0KG1h\ncHBpbmcsIHN1YmNsYXNzZXMsIHN0b3JlLCBmZXRjaCwgZWFnZXIsIG51bGws\nIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2VsZWN0\nSWRlbnRpZmllcihDbGFzc01hcHBpbmcgbWFwcGluZywgaW50IHN1YmNsYXNz\nZXMsCiAgICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCwgaW50IGVhZ2VyLAogICAgICAgICAgICBKb2lu\ncyBqb2lucykgewogICAgICAgICAgICBzZWxlY3QobWFwcGluZywgc3ViY2xh\nc3Nlcywgc3RvcmUsIGZldGNoLCBlYWdlciwgam9pbnMsIHRydWUpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIGludCBzZWxlY3RQcmltYXJ5S2V5KENs\nYXNzTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgICAgIHJldHVybiBzZWwu\nc2VsZWN0UHJpbWFyeUtleShtYXBwaW5nKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBpbnQgc2VsZWN0UHJpbWFyeUtleShDbGFzc01hcHBpbmcgbWFw\ncGluZywgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5z\nZWxlY3RQcmltYXJ5S2V5KG1hcHBpbmcsIGpvaW5zKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBpbnQgb3JkZXJCeVByaW1hcnlLZXkoQ2xhc3NNYXBw\naW5nIG1hcHBpbmcsIGJvb2xlYW4gYXNjLAogICAgICAgICAgICBib29sZWFu\nIHNlbGVjdCkgewogICAgICAgICAgICByZXR1cm4gb3JkZXJCeVByaW1hcnlL\nZXkobWFwcGluZywgYXNjLCBudWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGludCBvcmRlckJ5UHJpbWFyeUtleShDbGFzc01hcHBp\nbmcgbWFwcGluZywgYm9vbGVhbiBhc2MsCiAgICAgICAgICAgIEpvaW5zIGpv\naW5zLCBib29sZWFuIHNlbGVjdCkgewogICAgICAgICAgICBDbGFzc01hcHBp\nbmcgcGtzID0gbWFwcGluZzsKICAgICAgICAgICAgd2hpbGUgKCFwa3MuaXNQ\ncmltYXJ5S2V5T2JqZWN0SWQodHJ1ZSkpCiAgICAgICAgICAgICAgICBwa3Mg\nPSBwa3MuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAgICAg\nICAgICAgIENvbHVtbltdIGNvbHMgPSBwa3MuZ2V0UHJpbWFyeUtleUNvbHVt\nbnMoKTsKICAgICAgICAgICAgcmVjb3JkT3JkZXJDb2x1bW5zKGNvbHMsIGFz\nYyk7CiAgICAgICAgICAgIHJldHVybiBzZWwub3JkZXJCeVByaW1hcnlLZXko\nbWFwcGluZywgYXNjLCBqb2lucywgc2VsZWN0LAogICAgICAgICAgICAgICAg\naXNVbmlvbigpKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIFJlY29yZCB0aGF0IHdlJ3JlIG9yZGVyaW5nIGJ5IGEgU1FMIGV4cHJlc3Np\nb24uCiAgICAgICAgICovCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgcmVjb3Jk\nT3JkZXIoT2JqZWN0IG9yZCwgYm9vbGVhbiBhc2MpIHsKICAgICAgICAgICAg\naWYgKG9yZCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICBvcmRlcklkeHMgPSBudWxsOwoKICAgICAgICAgICAgaW50IGlk\neCA9IG9yZGVycysrOwogICAgICAgICAgICBpZiAoZGVzYy5nZXQoaWR4KSAm\nJiBhc2MpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlv\nbihfbG9jLmdldCgiaW5jb21wYXQtb3JkZXJpbmciKSk7CiAgICAgICAgICAg\nIGlmICghYXNjKQogICAgICAgICAgICAgICAgZGVzYy5zZXQoaWR4KTsKICAg\nICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJlY29yZCB0aGF0IHdl\nJ3JlIG9yZGVyaW5nIGJ5IHRoZSBnaXZlbiBjb2x1bW5zLgogICAgICAgICAq\nLwogICAgICAgIHByb3RlY3RlZCB2b2lkIHJlY29yZE9yZGVyQ29sdW1ucyhD\nb2x1bW5bXSBjb2xzLCBib29sZWFuIGFzYykgewogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nICAgICByZWNvcmRPcmRlcihjb2xzW2ldLCBhc2MpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGJvb2xlYW4gb3JkZXJCeShDb2x1bW4gY29sLCBib29s\nZWFuIGFzYywgYm9vbGVhbiBzZWxlY3QpIHsKICAgICAgICAgICAgcmV0dXJu\nIG9yZGVyQnkoY29sLCBhc2MsIG51bGwsIHNlbGVjdCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBvcmRlckJ5KENvbHVtbiBjb2wsIGJv\nb2xlYW4gYXNjLCBKb2lucyBqb2lucywKICAgICAgICAgICAgYm9vbGVhbiBz\nZWxlY3QpIHsKICAgICAgICAgICAgcmVjb3JkT3JkZXIoY29sLCBhc2MpOwog\nICAgICAgICAgICByZXR1cm4gc2VsLm9yZGVyQnkoY29sLCBhc2MsIGpvaW5z\nLCBzZWxlY3QsIGlzVW5pb24oKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgaW50IG9yZGVyQnkoQ29sdW1uW10gY29scywgYm9vbGVhbiBhc2MsIGJv\nb2xlYW4gc2VsZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBvcmRlckJ5KGNv\nbHMsIGFzYywgbnVsbCwgc2VsZWN0KTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBpbnQgb3JkZXJCeShDb2x1bW5bXSBjb2xzLCBib29sZWFuIGFzYywg\nSm9pbnMgam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2VsZWN0KSB7CiAg\nICAgICAgICAgIHJlY29yZE9yZGVyQ29sdW1ucyhjb2xzLCBhc2MpOwogICAg\nICAgICAgICByZXR1cm4gc2VsLm9yZGVyQnkoY29scywgYXNjLCBqb2lucywg\nc2VsZWN0LCBpc1VuaW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gb3JkZXJCeShTUUxCdWZmZXIgc3FsLCBib29sZWFuIGFzYywg\nYm9vbGVhbiBzZWxlY3QpIHsKICAgICAgICAgICAgcmV0dXJuIG9yZGVyQnko\nc3FsLCBhc2MsIG51bGwsIHNlbGVjdCk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBvcmRlckJ5KFNRTEJ1ZmZlciBzcWwsIGJvb2xlYW4g\nYXNjLCBKb2lucyBqb2lucywKICAgICAgICAgICAgYm9vbGVhbiBzZWxlY3Qp\nIHsKICAgICAgICAgICAgcmVjb3JkT3JkZXIoc3FsLmdldFNRTChmYWxzZSks\nIGFzYyk7CiAgICAgICAgICAgIHJldHVybiBzZWwub3JkZXJCeShzcWwsIGFz\nYywgam9pbnMsIHNlbGVjdCwgaXNVbmlvbigpKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBib29sZWFuIG9yZGVyQnkoU3RyaW5nIHNxbCwgYm9vbGVh\nbiBhc2MsIGJvb2xlYW4gc2VsZWN0KSB7CiAgICAgICAgICAgIHJldHVybiBv\ncmRlckJ5KHNxbCwgYXNjLCBudWxsLCBzZWxlY3QpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGJvb2xlYW4gb3JkZXJCeShTdHJpbmcgc3FsLCBib29s\nZWFuIGFzYywgSm9pbnMgam9pbnMsCiAgICAgICAgICAgIGJvb2xlYW4gc2Vs\nZWN0KSB7CiAgICAgICAgICAgIHJlY29yZE9yZGVyKHNxbCwgYXNjKTsKICAg\nICAgICAgICAgcmV0dXJuIHNlbC5vcmRlckJ5KHNxbCwgYXNjLCBqb2lucywg\nc2VsZWN0LCBpc1VuaW9uKCkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIHZvaWQgY2xlYXJPcmRlcmluZygpIHsKICAgICAgICAgICAgc2VsLmNsZWFy\nT3JkZXJpbmcoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdo\nZXJlUHJpbWFyeUtleShPYmplY3Qgb2lkLCBDbGFzc01hcHBpbmcgbWFwcGlu\nZywKICAgICAgICAgICAgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgICAg\nIHNlbC53aGVyZVByaW1hcnlLZXkob2lkLCBtYXBwaW5nLCBzdG9yZSk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZUZvcmVpZ25LZXko\nRm9yZWlnbktleSBmaywgT2JqZWN0IG9pZCwKICAgICAgICAgICAgQ2xhc3NN\nYXBwaW5nIG1hcHBpbmcsIEpEQkNTdG9yZSBzdG9yZSkgewogICAgICAgICAg\nICBzZWwud2hlcmVGb3JlaWduS2V5KGZrLCBvaWQsIG1hcHBpbmcsIHN0b3Jl\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdoZXJlKEpvaW5z\nIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC53aGVyZShqb2lucyk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3aGVyZShTUUxCdWZmZXIgc3Fs\nKSB7CiAgICAgICAgICAgIHNlbC53aGVyZShzcWwpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHZvaWQgd2hlcmUoU1FMQnVmZmVyIHNxbCwgSm9pbnMg\nam9pbnMpIHsKICAgICAgICAgICAgc2VsLndoZXJlKHNxbCwgam9pbnMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgd2hlcmUoU3RyaW5nIHNx\nbCkgewogICAgICAgICAgICBzZWwud2hlcmUoc3FsKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIHdoZXJlKFN0cmluZyBzcWwsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgICAgIHNlbC53aGVyZShzcWwsIGpvaW5zKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTUUxCdWZmZXIg\nc3FsKSB7CiAgICAgICAgICAgIHNlbC5oYXZpbmcoc3FsKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIGhhdmluZyhTUUxCdWZmZXIgc3FsLCBK\nb2lucyBqb2lucykgewogICAgICAgICAgICBzZWwuaGF2aW5nKHNxbCwgam9p\nbnMpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgaGF2aW5nKFN0\ncmluZyBzcWwpIHsKICAgICAgICAgICAgc2VsLmhhdmluZyhzcWwpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgaGF2aW5nKFN0cmluZyBzcWws\nIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5oYXZpbmcoc3FsLCBq\nb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBncm91cEJ5\nKFNRTEJ1ZmZlciBzcWwpIHsKICAgICAgICAgICAgc2VsLmdyb3VwQnkoc3Fs\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoU1FM\nQnVmZmVyIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAgc2VsLmdy\nb3VwQnkoc3FsLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBncm91cEJ5KFN0cmluZyBzcWwpIHsKICAgICAgICAgICAgc2VsLmdy\nb3VwQnkoc3FsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdy\nb3VwQnkoU3RyaW5nIHNxbCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAgICAg\nc2VsLmdyb3VwQnkoc3FsLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBncm91cEJ5KENvbHVtbiBjb2wpIHsKICAgICAgICAgICAg\nc2VsLmdyb3VwQnkoY29sKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIGdyb3VwQnkoQ29sdW1uIGNvbCwgSm9pbnMgam9pbnMpIHsKICAgICAg\nICAgICAgc2VsLmdyb3VwQnkoY29sLCBqb2lucyk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCBncm91cEJ5KENvbHVtbltdIGNvbHMpIHsKICAg\nICAgICAgICAgc2VsLmdyb3VwQnkoY29scyk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBncm91cEJ5KENvbHVtbltdIGNvbHMsIEpvaW5zIGpv\naW5zKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KGNvbHMsIGpvaW5zKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdyb3VwQnkoQ2xhc3NN\nYXBwaW5nIG1hcHBpbmcsIGludCBzdWJjbGFzc2VzLCAKICAgICAgICAgICAg\nSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNo\nKSB7CiAgICAgICAgICAgIHNlbC5ncm91cEJ5KG1hcHBpbmcsIHN1YmNsYXNz\nZXMsIHN0b3JlLCBmZXRjaCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBncm91cEJ5KENsYXNzTWFwcGluZyBtYXBwaW5nLCBpbnQgc3ViY2xh\nc3NlcywgCiAgICAgICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCwgSm9pbnMgam9pbnMpIHsKICAgICAgICAg\nICAgc2VsLmdyb3VwQnkobWFwcGluZywgc3ViY2xhc3Nlcywgc3RvcmUsIGZl\ndGNoLCBqb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU2VsZWN0\nRXhlY3V0b3Igd2hlcmVDbG9uZShpbnQgc2VscykgewogICAgICAgICAgICBy\nZXR1cm4gc2VsLndoZXJlQ2xvbmUoc2Vscyk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgU2VsZWN0RXhlY3V0b3IgZnVsbENsb25lKGludCBzZWxzKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwuZnVsbENsb25lKHNlbHMpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFNlbGVjdEV4ZWN1dG9yIGVhZ2VyQ2xv\nbmUoRmllbGRNYXBwaW5nIGtleSwgaW50IGVhZ2VyVHlwZSwKICAgICAgICAg\nICAgYm9vbGVhbiB0b01hbnksIGludCBzZWxzKSB7CiAgICAgICAgICAgIFNl\nbGVjdEV4ZWN1dG9yIGV4ID0gc2VsLmVhZ2VyQ2xvbmUoa2V5LCBlYWdlclR5\ncGUsIHRvTWFueSwgc2Vscyk7CiAgICAgICAgICAgIHJldHVybiAoZXggPT0g\nc2VsKSA/IHRoaXMgOiBleDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBT\nZWxlY3RFeGVjdXRvciBnZXRFYWdlcihGaWVsZE1hcHBpbmcga2V5KSB7CiAg\nICAgICAgICAgIFNlbGVjdEV4ZWN1dG9yIGV4ID0gc2VsLmdldEVhZ2VyKGtl\neSk7CiAgICAgICAgICAgIHJldHVybiAoZXggPT0gc2VsKSA/IHRoaXMgOiBl\neDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBuZXdKb2lucygp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5uZXdKb2lucygpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIEpvaW5zIG5ld091dGVySm9pbnMoKSB7CiAg\nICAgICAgICAgIHJldHVybiBzZWwubmV3T3V0ZXJKb2lucygpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgYXBwZW5kKFNRTEJ1ZmZlciBidWYs\nIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgICAgIHNlbC5hcHBlbmQoYnVmLCBq\nb2lucyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSm9pbnMgYW5kKEpv\naW5zIGpvaW5zMSwgSm9pbnMgam9pbnMyKSB7CiAgICAgICAgICAgIHJldHVy\nbiBzZWwuYW5kKGpvaW5zMSwgam9pbnMyKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBKb2lucyBvcihKb2lucyBqb2luczEsIEpvaW5zIGpvaW5zMikg\newogICAgICAgICAgICByZXR1cm4gc2VsLm9yKGpvaW5zMSwgam9pbnMyKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBKb2lucyBvdXRlcihKb2lucyBq\nb2lucykgewogICAgICAgICAgICByZXR1cm4gc2VsLm91dGVyKGpvaW5zKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7\nCiAgICAgICAgICAgIHJldHVybiBzZWwudG9TdHJpbmcoKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBpbnQgZ2V0RXhwZWN0ZWRSZXN1bHRDb3VudCgp\nIHsKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRFeHBlY3RlZFJlc3VsdENv\ndW50KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRFeHBl\nY3RlZFJlc3VsdENvdW50KGludCBleHBlY3RlZFJlc3VsdENvdW50LCAKICAg\nICAgICAgICAgYm9vbGVhbiBmb3JjZSkgewogICAgICAgICAgICBzZWwuc2V0\nRXhwZWN0ZWRSZXN1bHRDb3VudChleHBlY3RlZFJlc3VsdENvdW50LCBmb3Jj\nZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ29tcGFyYXRv\nciBmb3IgY29sbGF0aW5nIG9yZGVyZWQgcmVzdWx0cyB3aGVuIGZha2luZyBh\nIHVuaW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBSZXN1\nbHRDb21wYXJhdG9yCiAgICAgICAgaW1wbGVtZW50cyBNZXJnZWRSZXN1bHQu\nUmVzdWx0Q29tcGFyYXRvciB7CgogICAgICAgIHByaXZhdGUgZmluYWwgTGlz\ndFtdIF9vcmRlcnM7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBCaXRTZXQgX2Rl\nc2M7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBEQkRpY3Rpb25hcnkgX2RpY3Q7\nCgogICAgICAgIHB1YmxpYyBSZXN1bHRDb21wYXJhdG9yKExpc3RbXSBvcmRl\ncnMsIEJpdFNldCBkZXNjLCBEQkRpY3Rpb25hcnkgZGljdCkgewogICAgICAg\nICAgICBfb3JkZXJzID0gb3JkZXJzOwogICAgICAgICAgICBfZGVzYyA9IGRl\nc2M7CiAgICAgICAgICAgIF9kaWN0ID0gZGljdDsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBPYmplY3QgZ2V0T3JkZXJpbmdWYWx1ZShSZXN1bHQgcmVz\nLCBpbnQgaWR4KSB7CiAgICAgICAgICAgIC8vIGlmIG9uZSB2YWx1ZSBqdXN0\nIHJldHVybiBpdAogICAgICAgICAgICBSZXN1bHRTZXQgcnMgPSAoKFJlc3Vs\ndFNldFJlc3VsdCkgcmVzKS5nZXRSZXN1bHRTZXQoKTsKICAgICAgICAgICAg\naWYgKF9vcmRlcnNbaWR4XS5zaXplKCkgPT0gMSkKICAgICAgICAgICAgICAg\nIHJldHVybiBnZXRPcmRlcmluZ1ZhbHVlKHJzLCBfb3JkZXJzW2lkeF0uZ2V0\nKDApKTsKCiAgICAgICAgICAgIC8vIHJldHVybiBhcnJheSBvZiB2YWx1ZXMK\nICAgICAgICAgICAgT2JqZWN0W10gdmFscyA9IG5ldyBPYmplY3RbX29yZGVy\nc1tpZHhdLnNpemUoKV07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgdmFscy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIHZhbHNbaV0g\nPSBnZXRPcmRlcmluZ1ZhbHVlKHJzLCBfb3JkZXJzW2lkeF0uZ2V0KGkpKTsK\nICAgICAgICAgICAgcmV0dXJuIHZhbHM7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBFeHRyYWN0IHZhbHVlIGF0IGdpdmVuIGluZGV4IGZy\nb20gcmVzdWx0IHNldC4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIE9i\namVjdCBnZXRPcmRlcmluZ1ZhbHVlKFJlc3VsdFNldCBycywgT2JqZWN0IGkp\nIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBf\nZGljdC5nZXRPYmplY3QocnMsICgoSW50ZWdlcikgaSkuaW50VmFsdWUoKSAr\nIDEsIG51bGwpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24g\nc2UpIHsKICAgICAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0\nU3RvcmUoc2UsIF9kaWN0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGludCBjb21wYXJlKE9iamVjdCBvMSwgT2JqZWN0IG8y\nKSB7CiAgICAgICAgICAgIGlmIChvMSA9PSBvMikKICAgICAgICAgICAgICAg\nIHJldHVybiAwOwogICAgICAgICAgICBpZiAobzEgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybiAoX2Rlc2MuZ2V0KDApKSA/IC0xIDogMTsKICAg\nICAgICAgICAgaWYgKG8yID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1\ncm4gKF9kZXNjLmdldCgwKSkgPyAxIDogLTE7CgogICAgICAgICAgICBpbnQg\nY21wOwogICAgICAgICAgICBpZiAoIShvMSBpbnN0YW5jZW9mIE9iamVjdFtd\nKSkgewogICAgICAgICAgICAgICAgaWYgKCEobzIgaW5zdGFuY2VvZiBPYmpl\nY3RbXSkpIHsKICAgICAgICAgICAgICAgICAgICBjbXAgPSAoKENvbXBhcmFi\nbGUpIG8xKS5jb21wYXJlVG8obzIpOwogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiAoX2Rlc2MuZ2V0KDApKSA/IC1jbXAgOiBjbXA7CiAgICAgICAgICAg\nICAgICB9CgogICAgICAgICAgICAgICAgY21wID0gKChDb21wYXJhYmxlKSBv\nMSkuY29tcGFyZVRvKCgoT2JqZWN0W10pIG8yKVswXSk7CiAgICAgICAgICAg\nICAgICBpZiAoY21wICE9IDApCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIChfZGVzYy5nZXQoMCkpID8gLWNtcCA6IGNtcDsKICAgICAgICAgICAgICAg\nIHJldHVybiAtMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEo\nbzIgaW5zdGFuY2VvZiBPYmplY3RbXSkpIHsKICAgICAgICAgICAgICAgIGNt\ncCA9ICgoQ29tcGFyYWJsZSkgKChPYmplY3RbXSkgbzEpWzBdKS5jb21wYXJl\nVG8obzIpOwogICAgICAgICAgICAgICAgaWYgKGNtcCAhPSAwKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiAoX2Rlc2MuZ2V0KDApKSA/IC1jbXAgOiBj\nbXA7CiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgT2JqZWN0W10gYTEgPSAoT2JqZWN0W10pIG8xOwogICAg\nICAgICAgICBPYmplY3RbXSBhMiA9IChPYmplY3RbXSkgbzI7CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYTEubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIGNtcCA9ICgoQ29tcGFyYWJsZSkgYTFbaV0pLmNvbXBh\ncmVUbyhhMltpXSk7CiAgICAgICAgICAgICAgICBpZiAoY21wICE9IDApCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIChfZGVzYy5nZXQoaSkpID8gLWNt\ncCA6IGNtcDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gYTEu\nbGVuZ3RoIC0gYTIubGVuZ3RoOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

