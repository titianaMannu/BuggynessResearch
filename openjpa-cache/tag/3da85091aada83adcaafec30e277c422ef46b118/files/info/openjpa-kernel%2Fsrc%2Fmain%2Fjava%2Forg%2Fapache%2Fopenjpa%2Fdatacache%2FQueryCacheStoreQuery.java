{"sha":"1ab32ff30337e7370749a82cb25b8c35d1577951","node_id":"MDQ6QmxvYjIwNjM2NDoxYWIzMmZmMzAzMzdlNzM3MDc0OWE4MmNiMjViOGMzNWQxNTc3OTUx","size":21381,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1ab32ff30337e7370749a82cb25b8c35d1577951","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS5p\nby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnV0aWwuQWJzdHJhY3RMaXN0\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5CaXRTZXQ7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9y\ndCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLkxvY2FsZTsKaW1wb3J0IGphdmEudXRpbC5NYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuVHJlZU1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMubWFwLkxpbmtlZE1hcDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Mb2NrTGV2ZWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUNvbnRleHQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlQ29udGV4dDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVRdWVyeTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5BZ2dyZWdh\ndGVMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5GaWx0ZXJMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIucm9wLkxpc3RSZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVjdFByb3ZpZGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3Np\ndG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9iamVjdE5v\ndEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7Cgov\nKioKICogQSB7QGxpbmsgU3RvcmVRdWVyeX0gaW1wbGVtZW50YXRpb24gdGhh\ndCBjYWNoZXMgdGhlIE9JRHMgaW52b2x2ZWQgaW4KICogdGhlIHF1ZXJ5LCBh\nbmQgY2FuIGRldGVybWluZSB3aGV0aGVyIG9yIG5vdCB0aGUgcXVlcnkgaGFz\nIGJlZW4gZGlydGllZC4KICoKICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkK\nICogQHNpbmNlIDAuMi41LjAKICovCnB1YmxpYyBjbGFzcyBRdWVyeUNhY2hl\nU3RvcmVRdWVyeQogICAgaW1wbGVtZW50cyBTdG9yZVF1ZXJ5IHsKCiAgICBw\ncml2YXRlIGZpbmFsIFN0b3JlUXVlcnkgX3F1ZXJ5OwogICAgcHJpdmF0ZSBm\naW5hbCBRdWVyeUNhY2hlIF9jYWNoZTsKICAgIHByaXZhdGUgU3RvcmVDb250\nZXh0IF9zY3R4OwogICAgcHJpdmF0ZSBNZXRhRGF0YVJlcG9zaXRvcnkgX3Jl\ncG9zOwoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIHRo\nYXQgZGVsZWdhdGVzIHRvIDxjb2RlPnF1ZXJ5PC9jb2RlPiBpZiBubwogICAg\nICogY2FjaGVkIHJlc3VsdHMgYXJlIGF2YWlsYWJsZS4KICAgICAqLwogICAg\ncHVibGljIFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5KFN0b3JlUXVlcnkgcXVlcnks\nIFF1ZXJ5Q2FjaGUgY2FjaGUpIHsKICAgICAgICBfcXVlcnkgPSBxdWVyeTsK\nICAgICAgICBfY2FjaGUgPSBjYWNoZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUge0BsaW5rIFF1ZXJ5Q2FjaGV9IHRoYXQgdGhpcyBvYmpl\nY3QgaXMgYXNzb2NpYXRlZCB3aXRoLgogICAgICovCiAgICBwdWJsaWMgUXVl\ncnlDYWNoZSBnZXRDYWNoZSgpIHsKICAgICAgICByZXR1cm4gX2NhY2hlOwog\nICAgfQoKICAgIC8qKgogICAgICogRGVsZWdhdGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdG9yZVF1ZXJ5IGdldERlbGVnYXRlKCkgewogICAgICAgIHJldHVy\nbiBfcXVlcnk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb29rIGluIHRoZSBx\ndWVyeSBjYWNoZSBmb3IgYSByZXN1bHQgZm9yIHRoZSBnaXZlbiBxdWVyeQog\nICAgICoga2V5LiBPbmx5IGxvb2sgaWYgdGhpcyBxdWVyeSBpcyBiZWluZyBl\neGVjdXRlZCBvdXRzaWRlIGEKICAgICAqIHRyYW5zYWN0aW9uIG9yIGluIGEg\ndHJhbnNhY3Rpb24gd2l0aCBJZ25vcmVDaGFuZ2VzIHNldCB0byB0cnVlCiAg\nICAgKiBvciBpbiBhIHRyYW5zYWN0aW9uIHdpdGggSWdub3JlQ2hhbmdlcyBz\nZXQgdG8gZmFsc2UgYnV0IGluIHdoaWNoCiAgICAgKiBub25lIG9mIHRoZSBj\nbGFzc2VzIGludm9sdmVkIGluIHRoaXMgcXVlcnkgaGF2ZSBiZWVuIHRvdWNo\nZWQuCiAgICAgKiAgQ2FjaGluZyBpcyBub3QgdXNlZCB3aGVuIHVzaW5nIG9i\namVjdCBsb2NraW5nLgogICAgICogVGhpcyBpcyBiZWNhdXNlIHdlIG11c3Qg\nb2J0YWluIGxvY2tzIG9uIHRoZQogICAgICogZGF0YSwgYW5kIGl0IGlzIGxp\na2VseSB0aGF0IG1ha2luZyBuIHRyaXBzIHRvIHRoZSBkYXRhYmFzZSB0bwog\nICAgICogbWFrZSB0aGUgbG9ja3Mgd2lsbCBiZSBzbG93ZXIgdGhhbiBydW5u\naW5nIHRoZSBxdWVyeSBhZ2FpbnN0CiAgICAgKiB0aGUgZGF0YWJhc2UuCiAg\nICAgKiAgSWYgdGhlIGZldGNoIGNvbmZpZ3VyYXRpb24gaGFzIHF1ZXJ5IGNh\nY2hpbmcgZGlzYWJsZWQsCiAgICAgKiB0aGVuIHRoaXMgbWV0aG9kIHJldHVy\nbnMgPGNvZGU+bnVsbDwvY29kZT4uCiAgICAgKiAgUmV0dXJuIHRoZSBsaXN0\nIGlmIHdlIG1lZXQgdGhlIGFib3ZlIGNyaXRlcmlhIGFuZCBpZiBhIGxpc3QK\nICAgICAqIGlzIGZvdW5kIGZvciA8Y29kZT5xazwvY29kZT4uIEVsc2UsIHJl\ndHVybgogICAgICogPGNvZGU+bnVsbDwvY29kZT4uCiAgICAgKiAgVGhpcyBp\nbXBsZW1lbnRhdGlvbiBtZWFucyB0aGF0IHF1ZXJpZXMgYWdhaW5zdCB0aGUg\nY2FjaGUKICAgICAqIGFyZSBvZiBSRUFEX0NPTU1JVFRFRCBpc29sYXRpb24g\nbGV2ZWwuIEl0J2QgYmUgbmljZSB0byBzdXBwb3J0CiAgICAgKiBSRUFEX1NF\nUklBTElaQUJMRSAtLSB0byBkbyBzbywgd2UnZCBqdXN0IHJldHVybiBmYWxz\nZSB3aGVuIGluCiAgICAgKiBhIHRyYW5zYWN0aW9uLgogICAgICovCiAgICBw\ncml2YXRlIExpc3QgY2hlY2tDYWNoZShRdWVyeUtleSBxaykgewogICAgICAg\nIGlmIChxayA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICBGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2ggPSBnZXRDb250ZXh0KCku\nZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKCFmZXRjaC5n\nZXRRdWVyeUNhY2hlKCkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgIGlmIChmZXRjaC5nZXRSZWFkTG9ja0xldmVsKCkgPiBMb2NrTGV2ZWxz\nLkxPQ0tfTk9ORSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIC8vIGdldCB0aGUgY2FjaGVkIGRhdGEKICAgICAgICBRdWVyeVJlc3VsdCBy\nZXMgPSBfY2FjaGUuZ2V0KHFrKTsKICAgICAgICBpZiAocmVzID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChyZXMuaXNF\nbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gQ29sbGVjdGlvbnMuRU1QVFlf\nTElTVDsKCiAgICAgICAgaW50IHByb2pzID0gZ2V0Q29udGV4dCgpLmdldFBy\nb2plY3Rpb25BbGlhc2VzKCkubGVuZ3RoOwogICAgICAgIGlmIChwcm9qcyA9\nPSAwKSB7CiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgZGF0YSBjYWNo\nZSBjb250YWlucyB0aGUgb2lkcyBmb3IgdGhlIHF1ZXJ5IHJlc3VsdDsKICAg\nICAgICAgICAgLy8gaWYgaXQgZG9lc24ndCwgdGhlbiB1c2luZyB0aGUgcmVz\ndWx0IGNvdWxkIGJlIHNsb3dlciB0aGFuIG5vdAogICAgICAgICAgICAvLyB1\nc2luZyBpdCBiZWNhdXNlIG9mIHRoZSBpbmRpdmlkdWFsIGJ5LW9pZCBsb29r\ndXBzCiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IF9yZXBvcy5n\nZXRNZXRhRGF0YShnZXRDb250ZXh0KCkuCiAgICAgICAgICAgICAgICBnZXRD\nYW5kaWRhdGVUeXBlKCksIF9zY3R4LmdldENsYXNzTG9hZGVyKCksIHRydWUp\nOwogICAgICAgICAgICBCaXRTZXQgaWR4cyA9IG1ldGEuZ2V0RGF0YUNhY2hl\nKCkuY29udGFpbnNBbGwocmVzKTsKCiAgICAgICAgICAgIC8vIGV2ZW50dWFs\nbHkgd2Ugc2hvdWxkIG9wdGltaXplIHRoaXMgdG8gZmlndXJlIG91dCBob3cg\nbWFueSBvYmplY3RzCiAgICAgICAgICAgIC8vIHRoZSBjYWNoZSBpcyBtaXNz\naW5nIGFuZCBpZiBvbmx5IGEgZmV3IGRvIGEgYnVsayBmZXRjaCBmb3IgdGhl\nbQogICAgICAgICAgICBpbnQgbGVuID0gaWR4cy5sZW5ndGgoKTsKICAgICAg\nICAgICAgaWYgKGxlbiA8IHJlcy5zaXplKCkpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBs\nZW47IGkrKykKICAgICAgICAgICAgICAgIGlmICghaWR4cy5nZXQoaSkpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBuZXcgQ2FjaGVkTGlzdChyZXMsIHByb2pzICE9IDAsIF9z\nY3R4KTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyYXAgdGhlIHJlc3VsdCBv\nYmplY3QgcHJvdmlkZXIgcmV0dXJuZWQgYnkgb3VyIGRlbGVnYXRlIGluIGEK\nICAgICAqIGNhY2hpbmcgcHJvdmlkZXIuCiAgICAgKi8KICAgIHByaXZhdGUg\nUmVzdWx0T2JqZWN0UHJvdmlkZXIgd3JhcFJlc3VsdChSZXN1bHRPYmplY3RQ\ncm92aWRlciByb3AsCiAgICAgICAgUXVlcnlLZXkga2V5KSB7CiAgICAgICAg\naWYgKGtleSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gcm9wOwogICAg\nICAgIHJldHVybiBuZXcgQ2FjaGluZ1Jlc3VsdE9iamVjdFByb3ZpZGVyKHJv\ncCwgZ2V0Q29udGV4dCgpLgogICAgICAgICAgICBnZXRQcm9qZWN0aW9uQWxp\nYXNlcygpLmxlbmd0aCA+IDAsIGtleSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb3B5IGEgcHJvamVjdGlvbiBlbGVtZW50IGZvciBjYWNoaW5nIC8gcmV0\ndXJuaW5nLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3QgY29w\neVByb2plY3Rpb24oT2JqZWN0IG9iaiwgU3RvcmVDb250ZXh0IGN0eCkgewog\nICAgICAgIGlmIChvYmogPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgc3dpdGNoIChKYXZhVHlwZXMuZ2V0VHlwZUNvZGUob2Jq\nLmdldENsYXNzKCkpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNU\nUklORzoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTl9PQko6\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuRE9VQkxFX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuRkxPQVRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5J\nTlRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5CSUdERUNJTUFMOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5CSUdJTlRFR0VSOgogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5PSUQ6CiAgICAgICAgICAgICAgICByZXR1cm4gb2JqOwogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAgICAgICAgICAg\ncmV0dXJuICgoRGF0ZSkgb2JqKS5jbG9uZSgpOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5MT0NBTEU6CiAgICAgICAgICAgICAgICByZXR1cm4gKChM\nb2NhbGUpIG9iaikuY2xvbmUoKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAgICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBDYWNoZWRPYmplY3RJ\nZCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnJvbU9iamVjdElkKCgo\nQ2FjaGVkT2JqZWN0SWQpIG9iaikub2lkLCBjdHgpOwogICAgICAgICAgICAg\nICAgT2JqZWN0IG9pZCA9IGN0eC5nZXRPYmplY3RJZChvYmopOwogICAgICAg\nICAgICAgICAgaWYgKG9pZCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBuZXcgQ2FjaGVkT2JqZWN0SWQob2lkKTsKICAgICAgICAgICAg\nICAgIHJldHVybiBvYmo7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSByZXN1bHQgb2JqZWN0IGJhc2VkIG9uIGl0cyBjYWNo\nZWQgb2lkLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3QgZnJv\nbU9iamVjdElkKE9iamVjdCBvaWQsIFN0b3JlQ29udGV4dCBzY3R4KSB7CiAg\nICAgICAgaWYgKG9pZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKCiAgICAgICAgT2JqZWN0IG9iaiA9IHNjdHguZmluZChvaWQsIG51bGws\nIG51bGwsIG51bGwsIDApOwogICAgICAgIGlmIChvYmogPT0gbnVsbCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IE9iamVjdE5vdEZvdW5kRXhjZXB0aW9uKG9p\nZCk7CiAgICAgICAgcmV0dXJuIG9iajsKICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IHdyaXRlUmVwbGFjZSgpCiAgICAgICAgdGhyb3dzIE9iamVjdFN0cmVh\nbUV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIF9xdWVyeTsKICAgIH0KCiAg\nICBwdWJsaWMgUXVlcnlDb250ZXh0IGdldENvbnRleHQoKSB7CiAgICAgICAg\ncmV0dXJuIF9xdWVyeS5nZXRDb250ZXh0KCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0Q29udGV4dChRdWVyeUNvbnRleHQgcWN0eCkgewogICAgICAg\nIF9xdWVyeS5zZXRDb250ZXh0KHFjdHgpOwogICAgICAgIF9zY3R4ID0gcWN0\neC5nZXRTdG9yZUNvbnRleHQoKTsKICAgICAgICBfcmVwb3MgPSBfc2N0eC5n\nZXRDb25maWd1cmF0aW9uKCkuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFu\nY2UoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzZXRRdWVyeShPYmpl\nY3QgcXVlcnkpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LnNldFF1ZXJ5KHF1\nZXJ5KTsKICAgIH0KCiAgICBwdWJsaWMgRmlsdGVyTGlzdGVuZXIgZ2V0Rmls\ndGVyTGlzdGVuZXIoU3RyaW5nIHRhZykgewogICAgICAgIHJldHVybiBfcXVl\ncnkuZ2V0RmlsdGVyTGlzdGVuZXIodGFnKTsKICAgIH0KCiAgICBwdWJsaWMg\nQWdncmVnYXRlTGlzdGVuZXIgZ2V0QWdncmVnYXRlTGlzdGVuZXIoU3RyaW5n\nIHRhZykgewogICAgICAgIHJldHVybiBfcXVlcnkuZ2V0QWdncmVnYXRlTGlz\ndGVuZXIodGFnKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IG5ld0NvbXBp\nbGF0aW9uS2V5KCkgewogICAgICAgIHJldHVybiBfcXVlcnkubmV3Q29tcGls\nYXRpb25LZXkoKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IG5ld0NvbXBp\nbGF0aW9uKCkgewogICAgICAgIHJldHVybiBfcXVlcnkubmV3Q29tcGlsYXRp\nb24oKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwb3B1bGF0ZUZyb21Db21w\naWxhdGlvbihPYmplY3QgY29tcCkgewogICAgICAgIF9xdWVyeS5wb3B1bGF0\nZUZyb21Db21waWxhdGlvbihjb21wKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBpbnZhbGlkYXRlQ29tcGlsYXRpb24oKSB7CiAgICAgICAgX3F1ZXJ5Lmlu\ndmFsaWRhdGVDb21waWxhdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIHN1cHBvcnRzRGF0YVN0b3JlRXhlY3V0aW9uKCkgewogICAgICAgIHJl\ndHVybiBfcXVlcnkuc3VwcG9ydHNEYXRhU3RvcmVFeGVjdXRpb24oKTsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0luTWVtb3J5RXhlY3V0\naW9uKCkgewogICAgICAgIHJldHVybiBfcXVlcnkuc3VwcG9ydHNJbk1lbW9y\neUV4ZWN1dGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBFeGVjdXRvciBuZXdJ\nbk1lbW9yeUV4ZWN1dG9yKENsYXNzTWV0YURhdGEgbWV0YSwgYm9vbGVhbiBz\ndWJzKSB7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5uZXdJbk1lbW9yeUV4ZWN1\ndG9yKG1ldGEsIHN1YnMpOwogICAgfQoKICAgIHB1YmxpYyBFeGVjdXRvciBu\nZXdEYXRhU3RvcmVFeGVjdXRvcihDbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xl\nYW4gc3VicykgewogICAgICAgIEV4ZWN1dG9yIGV4ID0gX3F1ZXJ5Lm5ld0Rh\ndGFTdG9yZUV4ZWN1dG9yKG1ldGEsIHN1YnMpOwogICAgICAgIHJldHVybiBu\nZXcgUXVlcnlDYWNoZUV4ZWN1dG9yKGV4LCBtZXRhLCBzdWJzKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0Fic3RyYWN0RXhlY3V0b3Jz\nKCkgewogICAgICAgIHJldHVybiBfcXVlcnkuc3VwcG9ydHNBYnN0cmFjdEV4\nZWN1dG9ycygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlcXVpcmVz\nQ2FuZGlkYXRlVHlwZSgpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LnJlcXVp\ncmVzQ2FuZGlkYXRlVHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHJlcXVpcmVzUGFyYW1ldGVyRGVjbGFyYXRpb25zKCkgewogICAgICAgIHJl\ndHVybiBfcXVlcnkucmVxdWlyZXNQYXJhbWV0ZXJEZWNsYXJhdGlvbnMoKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1BhcmFtZXRlckRl\nY2xhcmF0aW9ucygpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LnN1cHBvcnRz\nUGFyYW1ldGVyRGVjbGFyYXRpb25zKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDYWNoaW5nIGV4ZWN1dG9yLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBjbGFzcyBRdWVyeUNhY2hlRXhlY3V0b3IKICAgICAgICBpbXBsZW1lbnRz\nIEV4ZWN1dG9yIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBFeGVjdXRvciBf\nZXg7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDbGFzcyBfY2FuZGlkYXRlOwog\nICAgICAgIHByaXZhdGUgZmluYWwgYm9vbGVhbiBfc3ViczsKCiAgICAgICAg\ncHVibGljIFF1ZXJ5Q2FjaGVFeGVjdXRvcihFeGVjdXRvciBleCwgQ2xhc3NN\nZXRhRGF0YSBtZXRhLAogICAgICAgICAgICBib29sZWFuIHN1YnMpIHsKICAg\nICAgICAgICAgX2V4ID0gZXg7CiAgICAgICAgICAgIF9jYW5kaWRhdGUgPSAo\nbWV0YSA9PSBudWxsKSA/IG51bGwgOiBtZXRhLmdldERlc2NyaWJlZFR5cGUo\nKTsKICAgICAgICAgICAgX3N1YnMgPSBzdWJzOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIFJlc3VsdE9iamVjdFByb3ZpZGVyIGV4ZWN1dGVRdWVyeShT\ndG9yZVF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcywKICAgICAgICAgICAgUmFu\nZ2UgcmFuZ2UpIHsKICAgICAgICAgICAgUXVlcnlDYWNoZVN0b3JlUXVlcnkg\nY3EgPSAoUXVlcnlDYWNoZVN0b3JlUXVlcnkpIHE7CiAgICAgICAgICAgIFF1\nZXJ5S2V5IGtleSA9IFF1ZXJ5S2V5Lm5ld0luc3RhbmNlKGNxLmdldENvbnRl\neHQoKSwKICAgICAgICAgICAgICAgIF9leC5pc1BhY2tpbmcocSksIHBhcmFt\ncywgX2NhbmRpZGF0ZSwgX3N1YnMsIHJhbmdlLnN0YXJ0LCAKICAgICAgICAg\nICAgICAgIHJhbmdlLmVuZCk7CiAgICAgICAgICAgIExpc3QgY2FjaGVkID0g\nY3EuY2hlY2tDYWNoZShrZXkpOwogICAgICAgICAgICBpZiAoY2FjaGVkICE9\nIG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExpc3RSZXN1bHRP\nYmplY3RQcm92aWRlcihjYWNoZWQpOwoKICAgICAgICAgICAgUmVzdWx0T2Jq\nZWN0UHJvdmlkZXIgcm9wID0gX2V4LmV4ZWN1dGVRdWVyeShjcS5nZXREZWxl\nZ2F0ZSgpLAogICAgICAgICAgICAgICAgcGFyYW1zLCByYW5nZSk7CiAgICAg\nICAgICAgIHJldHVybiBjcS53cmFwUmVzdWx0KHJvcCwga2V5KTsKICAgICAg\nICB9CgogICAgICAgIC8qKgogICAgICAgICAqIENsZWFyIHRoZSBjYWNoZWQg\ncXVlcmllcyBhc3NvY2lhdGVkIHdpdGggdGhlIGFjY2VzcyBwYXRoCiAgICAg\nICAgICogY2xhc3NlcyBpbiB0aGUgcXVlcnkuIFRoaXMgaXMgZG9uZSB3aGVu\nIGJ1bGsgb3BlcmF0aW9ucwogICAgICAgICAqIChzdWNoIGFzIGRlbGV0ZXMg\nb3IgdXBkYXRlcykgYXJlIHBlcmZvcm1lZCBzbyB0aGF0IHRoZQogICAgICAg\nICAqIGNhY2hlIHJlbWFpbnMgdXAtdG8tZGF0ZS4KICAgICAgICAgKi8KICAg\nICAgICBwcml2YXRlIHZvaWQgY2xlYXJBY2Nlc3NQYXRoKFN0b3JlUXVlcnkg\ncSkgewogICAgICAgICAgICBpZiAocSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIGNtZCA9\nIGdldEFjY2Vzc1BhdGhNZXRhRGF0YXMocSk7CiAgICAgICAgICAgIGlmIChj\nbWQgPT0gbnVsbCB8fCBjbWQubGVuZ3RoID09IDApCiAgICAgICAgICAgICAg\nICByZXR1cm47CgogICAgICAgICAgICBMaXN0IGNsYXNzZXMgPSBuZXcgQXJy\nYXlMaXN0KGNtZC5sZW5ndGgpOwogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNtZC5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGNsYXNz\nZXMuYWRkKGNtZFtpXS5nZXREZXNjcmliZWRUeXBlKCkpOwoKICAgICAgICAg\nICAgLy8gZXZpY3QgZnJvbSB0aGUgcXVlcnkgY2FjaGUKICAgICAgICAgICAg\nUXVlcnlDYWNoZVN0b3JlUXVlcnkgY3EgPSAoUXVlcnlDYWNoZVN0b3JlUXVl\ncnkpIHE7CiAgICAgICAgICAgIGNxLmdldENhY2hlKCkub25UeXBlc0NoYW5n\nZWQobmV3IFR5cGVzQ2hhbmdlZEV2ZW50CiAgICAgICAgICAgICAgICAocS5n\nZXRDb250ZXh0KCksIGNsYXNzZXMpKTsKCiAgICAgICAgICAgIC8vIGV2aWN0\nIGZyb20gdGhlIGRhdGEgY2FjaGUKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBjbWQubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBjbWRb\naV0uZ2V0RGF0YUNhY2hlKCkucmVtb3ZlQWxsKAogICAgICAgICAgICAgICAg\nICAgIGNtZFtpXS5nZXREZXNjcmliZWRUeXBlKCksIHRydWUpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIE51bWJlciBleGVjdXRlRGVsZXRlKFN0b3Jl\nUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gX2V4LmV4ZWN1dGVEZWxldGUodW53\ncmFwKHEpLCBwYXJhbXMpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgY2xlYXJBY2Nlc3NQYXRoKHEpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgTnVtYmVyIGV4ZWN1dGVVcGRh\ndGUoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBfZXguZXhlY3V0ZVVw\nZGF0ZSh1bndyYXAocSksIHBhcmFtcyk7CiAgICAgICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgICAgICBjbGVhckFjY2Vzc1BhdGgocSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmdbXSBn\nZXREYXRhU3RvcmVBY3Rpb25zKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFy\nYW1zLAogICAgICAgICAgICBSYW5nZSByYW5nZSkgewogICAgICAgICAgICBy\nZXR1cm4gRU1QVFlfU1RSSU5HUzsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyB2b2lkIHZhbGlkYXRlKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICBf\nZXgudmFsaWRhdGUodW53cmFwKHEpKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHVibGljIHZvaWQgZ2V0UmFuZ2UoU3RvcmVRdWVyeSBxLCBPYmpl\nY3RbXSBwYXJhbXMsIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgICAgIF9leC5n\nZXRSYW5nZShxLCBwYXJhbXMsIHJhbmdlKTsgCiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgT2JqZWN0IGdldE9yZGVyaW5nVmFsdWUoU3RvcmVRdWVyeSBx\nLCBPYmplY3RbXSBwYXJhbXMsCiAgICAgICAgICAgIE9iamVjdCByZXN1bHRP\nYmplY3QsIGludCBvcmRlckluZGV4KSB7CiAgICAgICAgICAgIHJldHVybiBf\nZXguZ2V0T3JkZXJpbmdWYWx1ZSh1bndyYXAocSksIHBhcmFtcywgcmVzdWx0\nT2JqZWN0LAogICAgICAgICAgICAgICAgb3JkZXJJbmRleCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbltdIGdldEFzY2VuZGluZyhTdG9y\nZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIF9leC5nZXRBc2NlbmRp\nbmcodW53cmFwKHEpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29s\nZWFuIGlzUGFja2luZyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0\ndXJuIF9leC5pc1BhY2tpbmcodW53cmFwKHEpKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0QWxpYXMoU3RvcmVRdWVyeSBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBfZXguZ2V0QWxpYXModW53cmFwKHEpKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBDbGFzcyBnZXRSZXN1bHRDbGFzcyhT\ndG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIF9leC5nZXRSZXN1\nbHRDbGFzcyh1bndyYXAocSkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIFN0cmluZ1tdIGdldFByb2plY3Rpb25BbGlhc2VzKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICByZXR1cm4gX2V4LmdldFByb2plY3Rpb25BbGlhc2Vz\nKHVud3JhcChxKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2xhc3Nb\nXSBnZXRQcm9qZWN0aW9uVHlwZXMoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAg\nICAgIHJldHVybiBfZXguZ2V0UHJvamVjdGlvblR5cGVzKHVud3JhcChxKSk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YVtdIGdl\ndEFjY2Vzc1BhdGhNZXRhRGF0YXMoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAg\nICAgIHJldHVybiBfZXguZ2V0QWNjZXNzUGF0aE1ldGFEYXRhcyh1bndyYXAo\ncSkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBnZXRPcGVyYXRp\nb24oU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBfZXguZ2V0\nT3BlcmF0aW9uKHVud3JhcChxKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBpc0FnZ3JlZ2F0ZShTdG9yZVF1ZXJ5IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIF9leC5pc0FnZ3JlZ2F0ZSh1bndyYXAocSkpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzR3JvdXBpbmcoU3Rv\ncmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBfZXguaGFzR3JvdXBp\nbmcodW53cmFwKHEpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBMaW5r\nZWRNYXAgZ2V0UGFyYW1ldGVyVHlwZXMoU3RvcmVRdWVyeSBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBfZXguZ2V0UGFyYW1ldGVyVHlwZXModW53cmFwKHEp\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBNYXAgZ2V0VXBkYXRlcyhT\ndG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIF9leC5nZXRVcGRh\ndGVzKHVud3JhcChxKSk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHN0\nYXRpYyBTdG9yZVF1ZXJ5IHVud3JhcChTdG9yZVF1ZXJ5IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuICgoUXVlcnlDYWNoZVN0b3JlUXVlcnkpIHEpLmdldERl\nbGVnYXRlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVz\ndWx0IGxpc3QgaW1wbGVtZW50YXRpb24gZm9yIGEgY2FjaGVkIHF1ZXJ5IHJl\nc3VsdC4gUGFja2FnZS1wcm90ZWN0ZWQKICAgICAqIGZvciB0ZXN0aW5nLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIENhY2hlZExpc3QKICAg\nICAgICBleHRlbmRzIEFic3RyYWN0TGlzdAogICAgICAgIGltcGxlbWVudHMg\nU2VyaWFsaXphYmxlIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBRdWVyeVJl\nc3VsdCBfcmVzOwogICAgICAgIHByaXZhdGUgZmluYWwgYm9vbGVhbiBfcHJv\najsKICAgICAgICBwcml2YXRlIGZpbmFsIFN0b3JlQ29udGV4dCBfc2N0eDsK\nCiAgICAgICAgcHVibGljIENhY2hlZExpc3QoUXVlcnlSZXN1bHQgcmVzLCBi\nb29sZWFuIHByb2osIFN0b3JlQ29udGV4dCBjdHgpIHsKICAgICAgICAgICAg\nX3JlcyA9IHJlczsKICAgICAgICAgICAgX3Byb2ogPSBwcm9qOwogICAgICAg\nICAgICBfc2N0eCA9IGN0eDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBP\nYmplY3QgZ2V0KGludCBpZHgpIHsKICAgICAgICAgICAgaWYgKCFfcHJvaikK\nICAgICAgICAgICAgICAgIHJldHVybiBmcm9tT2JqZWN0SWQoX3Jlcy5nZXQo\naWR4KSwgX3NjdHgpOwoKICAgICAgICAgICAgT2JqZWN0W10gY2FjaGVkID0g\nKE9iamVjdFtdKSBfcmVzLmdldChpZHgpOwogICAgICAgICAgICBpZiAoY2Fj\naGVkID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICAgICAgT2JqZWN0W10gdW5jYWNoZWQgPSBuZXcgT2JqZWN0W2NhY2hl\nZC5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNh\nY2hlZC5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIHVuY2FjaGVkW2ld\nID0gY29weVByb2plY3Rpb24oY2FjaGVkW2ldLCBfc2N0eCk7CiAgICAgICAg\nICAgIHJldHVybiB1bmNhY2hlZDsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBpbnQgc2l6ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZXMuc2l6ZSgp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVjdCB3cml0ZVJlcGxh\nY2UoKQogICAgICAgICAgICB0aHJvd3MgT2JqZWN0U3RyZWFtRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheUxpc3QodGhpcyk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQSB3cmFwcGVyIGFyb3Vu\nZCBhIHtAbGluayBSZXN1bHRPYmplY3RQcm92aWRlcn0gdGhhdCBidWlsZHMg\ndXAgYSBsaXN0IG9mCiAgICAgKiBhbGwgdGhlIE9JRHMgaW4gdGhpcyBsaXN0\nIGFuZCByZWdpc3RlcnMgdGhhdCBsaXN0IHdpdGggdGhlCiAgICAgKiBxdWVy\neSBjYWNoZS4gQWJhbmRvbnMgbW9uaXRvcmluZyBhbmQgcmVnaXN0ZXJpbmcg\naWYgb25lIG9mIHRoZSBjbGFzc2VzCiAgICAgKiBpbiB0aGUgYWNjZXNzIHBh\ndGggaXMgbW9kaWZpZWQgd2hpbGUgdGhlIHF1ZXJ5IHJlc3VsdHMgYXJlIGJl\naW5nIGxvYWRlZC4KICAgICAqLwogICAgcHJpdmF0ZSBjbGFzcyBDYWNoaW5n\nUmVzdWx0T2JqZWN0UHJvdmlkZXIKICAgICAgICBpbXBsZW1lbnRzIFJlc3Vs\ndE9iamVjdFByb3ZpZGVyLCBUeXBlc0NoYW5nZWRMaXN0ZW5lciB7CgogICAg\nICAgIHByaXZhdGUgZmluYWwgUmVzdWx0T2JqZWN0UHJvdmlkZXIgX3JvcDsK\nICAgICAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gX3Byb2o7CiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBRdWVyeUtleSBfcWs7CiAgICAgICAgcHJpdmF0ZSBm\naW5hbCBUcmVlTWFwIF9kYXRhID0gbmV3IFRyZWVNYXAoKTsKICAgICAgICBw\ncml2YXRlIGJvb2xlYW4gX21haW50YWluQ2FjaGUgPSB0cnVlOwogICAgICAg\nIHByaXZhdGUgaW50IF9wb3MgPSAtMTsKCiAgICAgICAgLy8gdXNlZCB0byBk\nZXRlcm1pbmUgbGlzdCBzaXplIHdpdGhvdXQgbmVjZXNzYXJpbHkgY2FsbGlu\nZyBzaXplKCksCiAgICAgICAgLy8gd2hpY2ggbWF5IHJlcXVpcmUgYSBEQiB0\ncmlwIG9yIHJldHVybiBJbnRlZ2VyLk1BWF9WQUxVRQogICAgICAgIHByaXZh\ndGUgaW50IF9tYXggPSAtMTsKICAgICAgICBwcml2YXRlIGludCBfc2l6ZSA9\nIEludGVnZXIuTUFYX1ZBTFVFOwoKICAgICAgICAvKioKICAgICAgICAgKiBD\nb25zdHJ1Y3Rvci4gU3VwcGx5IGRlbGVnYXRlIHJlc3VsdCBwcm92aWRlciBh\nbmQgb3VyIHF1ZXJ5IGtleS4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\nQ2FjaGluZ1Jlc3VsdE9iamVjdFByb3ZpZGVyKFJlc3VsdE9iamVjdFByb3Zp\nZGVyIHJvcCwKICAgICAgICAgICAgYm9vbGVhbiBwcm9qLCBRdWVyeUtleSBr\nZXkpIHsKICAgICAgICAgICAgX3JvcCA9IHJvcDsKICAgICAgICAgICAgX3By\nb2ogPSBwcm9qOwogICAgICAgICAgICBfcWsgPSBrZXk7CiAgICAgICAgICAg\nIF9jYWNoZS5hZGRUeXBlc0NoYW5nZWRMaXN0ZW5lcih0aGlzKTsKICAgICAg\nICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFN0b3AgY2FjaGluZy4KICAg\nICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgYWJvcnRDYWNoaW5nKCkg\newogICAgICAgICAgICBpZiAoIV9tYWludGFpbkNhY2hlKQogICAgICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICAgICAgLy8gdGhpcyBjYW4gYmUgY2Fs\nbGVkIHZpYSBhbiBldmVudCBmcm9tIGFub3RoZXIgdGhyZWFkCiAgICAgICAg\nICAgIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICAgICAgLy8g\naXQncyBpbXBvcnRhbnQgdGhhdCB3ZSBzZXQgdGhpcyBmbGFnIGZpcnN0IHNv\nIHRoYXQgYW55CiAgICAgICAgICAgICAgICAvLyBzdWJzZXF1ZW50IGNhbGxz\nIHRvIHRoaXMgb2JqZWN0IGFyZSBieXBhc3NlZC4KICAgICAgICAgICAgICAg\nIF9tYWludGFpbkNhY2hlID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY2Fj\naGUucmVtb3ZlVHlwZXNDaGFuZ2VkTGlzdGVuZXIodGhpcyk7CiAgICAgICAg\nICAgICAgICBfZGF0YS5jbGVhcigpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBDaGVjayB3aGV0aGVyIHdlJ3Zl\nIGJ1ZmZlcmVkIGFsbCByZXN1bHRzLCB3aGlsZSBvcHRpb25hbGx5IGFkZGlu\nZwogICAgICAgICAqIHRoZSBnaXZlbiByZXN1bHQuCiAgICAgICAgICovCiAg\nICAgICAgcHJpdmF0ZSB2b2lkIGNoZWNrRmluaXNoZWQoT2JqZWN0IG9iaiwg\nYm9vbGVhbiByZXN1bHQpIHsKICAgICAgICAgICAgLy8gdGhpcyBjYW4gYmUg\nY2FsbGVkIGF0IHRoZSBzYW1lIHRpbWUgYXMgYWJvcnRDYWNoaW5nIHZpYQog\nICAgICAgICAgICAvLyBhIHR5cGVzIGNoYW5nZWQgZXZlbnQKICAgICAgICAg\nICAgYm9vbGVhbiBmaW5pc2hlZCA9IGZhbHNlOwogICAgICAgICAgICBzeW5j\naHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAgICAgIGlmIChfbWFpbnRh\naW5DYWNoZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgSW50ZWdlciBpbmRleCA9IE51bWJl\ncnMudmFsdWVPZihfcG9zKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKCFfZGF0YS5jb250YWluc0tleShpbmRleCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIE9iamVjdCBjYWNoZWQ7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAob2JqID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY2FjaGVkID0gbnVsbDsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGVsc2UgaWYgKCFfcHJvaikKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBjYWNoZWQgPSBfc2N0eC5nZXRPYmplY3RJZChv\nYmopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0W10gYXJyID0gKE9i\namVjdFtdKSBvYmo7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nT2JqZWN0W10gY3AgPSBuZXcgT2JqZWN0W2Fyci5sZW5ndGhdOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nYXJyLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBjcFtpXSA9IGNvcHlQcm9qZWN0aW9uKGFycltpXSwgX3NjdHgp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlZCA9IGNw\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGNhY2hlZCAhPSBudWxsKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIF9kYXRhLnB1dChpbmRleCwgY2FjaGVk\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICBmaW5pc2hlZCA9IF9zaXplID09\nIF9kYXRhLnNpemUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgaWYgKGZpbmlzaGVkKSB7CiAgICAgICAgICAgICAg\nICAvLyBhbiBhYm9ydENhY2hpbmcgY2FsbCBjYW4gc25lYWsgaW4gaGVyZSB2\naWEgb25FeHBpcmU7IHRoZQogICAgICAgICAgICAgICAgLy8gY2FjaGUgaXMg\nbG9ja2VkIGR1cmluZyBldmVudCBmaXJpbmdzLCBzbyB0aGUgbG9jayBoZXJl\nIHdpbGwKICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIGl0IChvciB3aWxs\nIGZvcmNlIHRoZSBuZXh0IGZpcmluZyB0byB3YWl0KQogICAgICAgICAgICAg\nICAgX2NhY2hlLndyaXRlTG9jaygpOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgd2UgZGlkbid0IGFi\nb3J0CiAgICAgICAgICAgICAgICAgICAgaWYgKF9tYWludGFpbkNhY2hlKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIFF1ZXJ5UmVzdWx0IHJlcyA9IG5l\ndyBRdWVyeVJlc3VsdChfcWssIF9kYXRhLnZhbHVlcygpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgX2NhY2hlLnB1dChfcWssIHJlcyk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGFib3J0Q2FjaGluZygpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgICAgIF9jYWNoZS53cml0ZVVubG9j\naygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1JhbmRvbUFjY2Vz\ncygpIHsKICAgICAgICAgICAgcmV0dXJuIF9yb3Auc3VwcG9ydHNSYW5kb21B\nY2Nlc3MoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIG9wZW4o\nKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nX3JvcC5vcGVuKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0\nIGdldFJlc3VsdE9iamVjdCgpCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgICAgICBPYmplY3Qgb2JqID0gX3JvcC5nZXRSZXN1bHRP\nYmplY3QoKTsKICAgICAgICAgICAgY2hlY2tGaW5pc2hlZChvYmosIHRydWUp\nOwogICAgICAgICAgICByZXR1cm4gb2JqOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gbmV4dCgpCiAgICAgICAgICAgIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICBfcG9zKys7CiAgICAgICAgICAgIGJvb2xl\nYW4gbmV4dCA9IF9yb3AubmV4dCgpOwogICAgICAgICAgICBpZiAoIW5leHQg\nJiYgX3BvcyA9PSBfbWF4ICsgMSkgewogICAgICAgICAgICAgICAgX3NpemUg\nPSBfcG9zOwogICAgICAgICAgICAgICAgY2hlY2tGaW5pc2hlZChudWxsLCBm\nYWxzZSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV4dCAmJiBfcG9zID4g\nX21heCkKICAgICAgICAgICAgICAgIF9tYXggPSBfcG9zOwogICAgICAgICAg\nICByZXR1cm4gbmV4dDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29s\nZWFuIGFic29sdXRlKGludCBwb3MpCiAgICAgICAgICAgIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICBfcG9zID0gcG9zOwogICAgICAgICAgICBi\nb29sZWFuIHZhbGlkID0gX3JvcC5hYnNvbHV0ZShwb3MpOwogICAgICAgICAg\nICBpZiAoIXZhbGlkICYmIF9wb3MgPT0gX21heCArIDEpIHsKICAgICAgICAg\nICAgICAgIF9zaXplID0gX3BvczsKICAgICAgICAgICAgICAgIGNoZWNrRmlu\naXNoZWQobnVsbCwgZmFsc2UpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZh\nbGlkICYmIF9wb3MgPiBfbWF4KQogICAgICAgICAgICAgICAgX21heCA9IF9w\nb3M7CiAgICAgICAgICAgIHJldHVybiB2YWxpZDsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBpbnQgc2l6ZSgpCiAgICAgICAgICAgIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICBpZiAoX3NpemUgIT0gSW50ZWdlci5NQVhf\nVkFMVUUpCiAgICAgICAgICAgICAgICByZXR1cm4gX3NpemU7CiAgICAgICAg\nICAgIGludCBzaXplID0gX3JvcC5zaXplKCk7CiAgICAgICAgICAgIF9zaXpl\nID0gc2l6ZTsKICAgICAgICAgICAgY2hlY2tGaW5pc2hlZChudWxsLCBmYWxz\nZSk7CiAgICAgICAgICAgIHJldHVybiBzaXplOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIHZvaWQgcmVzZXQoKQogICAgICAgICAgICB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgX3JvcC5yZXNldCgpOwogICAgICAgICAg\nICBfcG9zID0gLTE7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBj\nbG9zZSgpCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nICAgICBhYm9ydENhY2hpbmcoKTsKICAgICAgICAgICAgX3JvcC5jbG9zZSgp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgaGFuZGxlQ2hlY2tl\nZEV4Y2VwdGlvbihFeGNlcHRpb24gZSkgewogICAgICAgICAgICBfcm9wLmhh\nbmRsZUNoZWNrZWRFeGNlcHRpb24oZSk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBvblR5cGVzQ2hhbmdlZChUeXBlc0NoYW5nZWRFdmVudCBl\ndikgewogICAgICAgICAgICBpZiAoX3FrLmNoYW5nZUludmFsaWRhdGVzUXVl\ncnkoZXYuZ2V0VHlwZXMoKSkpCiAgICAgICAgICAgICAgICBhYm9ydENhY2hp\nbmcoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTdHJ1Y3Qg\ndG8gcmVjb2duaXplIGNhY2hlZCBvaWRzLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBjbGFzcyBDYWNoZWRPYmplY3RJZCB7CgogICAgICAgIHB1Ymxp\nYyBmaW5hbCBPYmplY3Qgb2lkOwoKICAgICAgICBwdWJsaWMgQ2FjaGVkT2Jq\nZWN0SWQgKE9iamVjdCBvaWQpCgkJewoJCQl0aGlzLm9pZCA9IG9pZDsKCQl9\nCgl9Cn0K\n","encoding":"base64"}

