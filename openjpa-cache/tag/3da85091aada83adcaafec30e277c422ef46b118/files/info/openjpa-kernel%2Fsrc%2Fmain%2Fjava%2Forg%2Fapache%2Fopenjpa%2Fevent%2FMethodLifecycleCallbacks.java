{"sha":"8a53d1d57fe4d48a5289b622d0522589dcb61dff","node_id":"MDQ6QmxvYjIwNjM2NDo4YTUzZDFkNTdmZTRkNDhhNTI4OWI2MjJkMDUyMjU4OWRjYjYxZGZm","size":4861,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8a53d1d57fe4d48a5289b622d0522589dcb61dff","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQ7CgppbXBvcnQgamF2\nYS5pby5FeHRlcm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRp\nb247CmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5p\nby5PYmplY3RPdXRwdXQ7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwoKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKLyoqCiAqIENhbGxi\nYWNrIGFkYXB0ZXIgdGhhdCBpbnZva2VzIGEgY2FsbGJhY2sgbWV0aG9kIHZp\nYSByZWZsZWN0aW9uLgogKgogKiBAYXV0aG9yIFN0ZXZlIEtpbQogKi8KcHVi\nbGljIGNsYXNzIE1ldGhvZExpZmVjeWNsZUNhbGxiYWNrcwogICAgaW1wbGVt\nZW50cyBMaWZlY3ljbGVDYWxsYmFja3MsIEV4dGVybmFsaXphYmxlIHsKCiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2Fs\naXplci5mb3JQYWNrYWdlCiAgICAgICAgKE1ldGhvZExpZmVjeWNsZUNhbGxi\nYWNrcy5jbGFzcyk7CgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTWV0aG9kIF9j\nYWxsYmFjazsKICAgIHByaXZhdGUgYm9vbGVhbiBfYXJnOwoKICAgIC8qKgog\nICAgICogQ29uc3RydWN0b3IuIFN1cHBseSBjYWxsYmFjayBjbGFzcyBhbmQg\naXRzIGNhbGxiYWNrIG1ldGhvZCBuYW1lLgogICAgICoKICAgICAqIEBhcmcg\nV2hldGhlciB3ZSBleHBlY3QgYSBmdXJ0aGVyIGFyZ3VtZW50IHN1Y2ggYXMg\naW4gQWZ0ZXJEZXRhY2gKICAgICAqLwogICAgcHVibGljIE1ldGhvZExpZmVj\neWNsZUNhbGxiYWNrcyhDbGFzcyBjbHMsIFN0cmluZyBtZXRob2QsIGJvb2xl\nYW4gYXJnKSB7CiAgICAgICAgQ2xhc3NbXSBhcmdzID0gYXJnID8gbmV3IENs\nYXNzW117IE9iamVjdC5jbGFzcyB9IDogbnVsbDsKICAgICAgICBfY2FsbGJh\nY2sgPSBnZXRNZXRob2QoY2xzLCBtZXRob2QsIGFyZ3MpOwogICAgICAgIF9h\ncmcgPSBhcmc7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4g\nU3VwcGx5IGNhbGxiYWNrIG1ldGhvZC4KICAgICAqLwogICAgcHVibGljIE1l\ndGhvZExpZmVjeWNsZUNhbGxiYWNrcyhNZXRob2QgbWV0aG9kLCBib29sZWFu\nIGFyZykgewogICAgICAgIF9jYWxsYmFjayA9IG1ldGhvZDsKICAgICAgICBf\nYXJnID0gYXJnOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGNhbGxiYWNr\nIG1ldGhvZC4KICAgICAqLwogICAgcHVibGljIE1ldGhvZCBnZXRDYWxsYmFj\na01ldGhvZCgpIHsKICAgICAgICByZXR1cm4gX2NhbGxiYWNrOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJucyBpZiB0aGlzIGNhbGxiYWNrIGV4cGVj\ndHMgYW5vdGhlciBhcmd1bWVudAogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiByZXF1aXJlc0FyZ3VtZW50KCkgewogICAgICAgIHJldHVybiBfYXJnOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc0NhbGxiYWNrKE9iamVjdCBv\nYmosIGludCBldmVudFR5cGUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBtYWtlQ2FsbGJhY2soT2JqZWN0IG9iaiwg\nT2JqZWN0IGFyZywgaW50IGV2ZW50VHlwZSkKICAgICAgICB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoIV9jYWxsYmFjay5pc0FjY2Vzc2libGUo\nKSkKICAgICAgICAgICAgX2NhbGxiYWNrLnNldEFjY2Vzc2libGUodHJ1ZSk7\nCgogICAgICAgIGlmIChfYXJnKQogICAgICAgICAgICBfY2FsbGJhY2suaW52\nb2tlKG9iaiwgbmV3IE9iamVjdFtdeyBhcmcgfSk7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBfY2FsbGJhY2suaW52b2tlKG9iaiwgKE9iamVjdFtdKSBu\ndWxsKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewog\nICAgICAgIHJldHVybiBnZXRDbGFzcygpLmdldE5hbWUoKSArICI6IiArIF9j\nYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBlciBtZXRob2Qg\ndG8gcmV0dXJuIHRoZSBuYW1lZCBtZXRob2Qgb2YgdGhlIGdpdmVuIGNsYXNz\nLCB0aHJvd2luZwogICAgICogdGhlIHByb3BlciBleGNlcHRpb24gb24gZXJy\nb3IuCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0aWMgTWV0aG9kIGdldE1l\ndGhvZChDbGFzcyBjbHMsIFN0cmluZyBtZXRob2QsIENsYXNzW10gYXJncykg\newogICAgICAgIENsYXNzIGN1cnJlbnRDbGFzcyA9IGNsczsKICAgICAgICBk\nbyB7CiAgICAgICAgICAgIE1ldGhvZFtdIG1ldGhvZHMgPSBjdXJyZW50Q2xh\nc3MuZ2V0RGVjbGFyZWRNZXRob2RzKCk7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbWV0aG9kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgaWYgKCFtZXRob2QuZXF1YWxzKG1ldGhvZHNbaV0uZ2V0TmFtZSgp\nKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nICAgICBpZiAoaXNBc3NpZ25hYmxlKG1ldGhvZHNbaV0uZ2V0UGFyYW1ldGVy\nVHlwZXMoKSwgYXJncykpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1l\ndGhvZHNbaV07CiAgICAgICAgICAgIH0KICAgICAgICB9IHdoaWxlICgoY3Vy\ncmVudENsYXNzID0gY3VycmVudENsYXNzLmdldFN1cGVyY2xhc3MoKSkgIT0g\nbnVsbCk7CgogICAgICAgIC8vIGlmIHdlIGdldCBoZXJlLCBubyBzdWl0YWJs\nZSBtZXRob2Qgd2FzIGZvdW5kCiAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNl\ncHRpb24oX2xvYy5nZXQoIm1ldGhvZC1ub3Rmb3VuZCIsIGNscy5nZXROYW1l\nKCksCiAgICAgICAgICAgICAgICBtZXRob2QsIGFyZ3MgPT0gbnVsbCA/IG51\nbGwgOiBBcnJheXMuYXNMaXN0KGFyZ3MpKSk7Cgl9CgogICAgLyoqIAogICAg\nICogUmV0dXJucyB0cnVlIGlmIGFsbCBwYXJhbWV0ZXJzIGluIHRoZSBmcm9t\nIGFycmF5IGFyZSBhc3NpZ25hYmxlCiAgICAgKiBmcm9tIHRoZSBjb3JyZXNw\nb25kaW5nIHBhcmFtZXRlcnMgb2YgdGhlIHRvIGFycmF5LiAKICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBpc0Fzc2lnbmFibGUoQ2xhc3Nb\nXSBmcm9tLCBDbGFzc1tdIHRvKSB7CiAgICAgICAgaWYgKGZyb20gPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIHRvID09IG51bGwgfHwgdG8ubGVuZ3Ro\nID09IDA7CiAgICAgICAgaWYgKHRvID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBmcm9tID09IG51bGwgfHwgZnJvbS5sZW5ndGggPT0gMDsKCiAgICAg\nICAgaWYgKGZyb20ubGVuZ3RoICE9IHRvLmxlbmd0aCkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZy\nb20ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGZyb21baV0gIT0g\nbnVsbCAmJiAhZnJvbVtpXS5pc0Fzc2lnbmFibGVGcm9tKHRvW2ldKSkKICAg\nICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlYWRFeHRl\ncm5hbChPYmplY3RJbnB1dCBpbikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIENsYXNzIGNs\ncyA9IChDbGFzcykgaW4ucmVhZE9iamVjdCgpOwogICAgICAgIFN0cmluZyBt\nZXRoTmFtZSA9IChTdHJpbmcpIGluLnJlYWRPYmplY3QoKTsKICAgICAgICBf\nYXJnID0gaW4ucmVhZEJvb2xlYW4oKTsKCiAgICAgICAgQ2xhc3NbXSBhcmdz\nID0gX2FyZyA/IG5ldyBDbGFzc1tdeyBPYmplY3QuY2xhc3MgfSA6IG51bGw7\nCiAgICAgICAgX2NhbGxiYWNrID0gZ2V0TWV0aG9kKGNscywgbWV0aE5hbWUs\nIGFyZ3MpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdyaXRlRXh0ZXJuYWwo\nT2JqZWN0T3V0cHV0IG91dCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgIG91dC53cml0ZU9iamVjdChfY2FsbGJhY2suZ2V0Q2xhc3Mo\nKSk7CiAgICAgICAgb3V0LndyaXRlT2JqZWN0KF9jYWxsYmFjay5nZXROYW1l\nKCkpOwogICAgICAgIG91dC53cml0ZUJvb2xlYW4oX2FyZyk7CiAgICB9IAp9\nCg==\n","encoding":"base64"}

