{"sha":"297cd81f367d86638db1500ebc254684018fe5ab","node_id":"MDQ6QmxvYjIwNjM2NDoyOTdjZDgxZjM2N2Q4NjYzOGRiMTUwMGViYzI1NDY4NDAxOGZlNWFi","size":32245,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/297cd81f367d86638db1500ebc254684018fe5ab","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQ7CgppbXBvcnQgamF2\nYS5pby5CdWZmZXJlZElucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5CeXRl\nQXJyYXlPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkVPRkV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlv\nLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5PYmplY3RJbnB1dFN0cmVh\nbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0U3RyZWFtOwppbXBvcnQg\namF2YS5pby5PcHRpb25hbERhdGFFeGNlcHRpb247CmltcG9ydCBqYXZhLmlv\nLk91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEubmV0LkluZXRBZGRyZXNzOwpp\nbXBvcnQgamF2YS5uZXQuU2VydmVyU29ja2V0OwppbXBvcnQgamF2YS5uZXQu\nU29ja2V0OwppbXBvcnQgamF2YS5uZXQuU29ja2V0RXhjZXB0aW9uOwppbXBv\ncnQgamF2YS5uZXQuVW5rbm93bkhvc3RFeGNlcHRpb247CmltcG9ydCBqYXZh\nLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1w\nb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hT\nZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0\naWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBq\nYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5wb29s\nLlBvb2xhYmxlT2JqZWN0RmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5wb29sLmltcGwuR2VuZXJpY09iamVjdFBvb2w7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLkdlbmVyYWxFeGNlcHRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlNlcmlhbGl6YXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVudC5S\nZWVudHJhbnRMb2NrOwoKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoKLyoq\nCiAqIFRDUC1iYXNlZCBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUmVtb3Rl\nQ29tbWl0UHJvdmlkZXJ9IHRoYXQKICogbGlzdGVucyBmb3Igb2JqZWN0IG1v\nZGlmaWNhdGlvbnMgYW5kIHByb3BhZ2F0ZXMgdGhvc2UgY2hhbmdlcyB0bwog\nKiBvdGhlciBSZW1vdGVDb21taXRQcm92aWRlcnMgb3ZlciBUQ1Agc29ja2V0\ncy4KICoKICogQGF1dGhvciBCcmlhbiBMZWFpcgogKiBAYXV0aG9yIFBhdHJp\nY2sgTGluc2tleQogKiBAc2luY2UgMC4yLjUuMAogKi8KcHVibGljIGNsYXNz\nIFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVyCiAgICBleHRlbmRzIEFic3RyYWN0\nUmVtb3RlQ29tbWl0UHJvdmlkZXIKICAgIGltcGxlbWVudHMgQ29uZmlndXJh\nYmxlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREVGQVVMVF9Q\nT1JUID0gNTYzNjsKCiAgICBwcml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIgc19s\nb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChUQ1BSZW1vdGVD\nb21taXRQcm92aWRlci5jbGFzcyk7CiAgICBwcml2YXRlIHN0YXRpYyBsb25n\nIHNfaWRTZXF1ZW5jZSA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwoK\nICAgIC8vCUEgbWFwIG9mIGxpc3RlbiBwb3J0cyB0byBsaXN0ZW5lcnMgaW4g\ndGhpcyBKVk0uIFdlIG1pZ2h0CiAgICAvLwl3YW50IHRvIGxvb2sgaW50byBh\nbGxvd2luZyBzYW1lIHBvcnQsIGRpZmZlcmVudCBpbnRlcmZhY2UgLS0KICAg\nIC8vCXRoYXQgaXMgbm90IGN1cnJlbnRseSBwb3NzaWJsZSBpbiBhIHNpbmds\nZSBKVk0uCiAgICBwcml2YXRlIHN0YXRpYyBNYXAgc19wb3J0TGlzdGVuZXJN\nYXAgPSBuZXcgSGFzaE1hcCgpOwoKICAgIHByaXZhdGUgbG9uZyBfaWQ7CiAg\nICBwcml2YXRlIGJ5dGVbXSBfbG9jYWxob3N0OwogICAgcHJpdmF0ZSBpbnQg\nX3BvcnQgPSBERUZBVUxUX1BPUlQ7CiAgICBwcml2YXRlIGludCBfbWF4QWN0\naXZlID0gMjsKICAgIHByaXZhdGUgaW50IF9tYXhJZGxlID0gMjsKICAgIHBy\naXZhdGUgaW50IF9yZWNvdmVyeVRpbWVNaWxsaXMgPSAxNTAwMDsKICAgIHBy\naXZhdGUgVENQUG9ydExpc3RlbmVyIF9saXN0ZW5lcjsKICAgIHByaXZhdGUg\nQnJvYWRjYXN0UXVldWUgX2Jyb2FkY2FzdFF1ZXVlID0gbmV3IEJyb2FkY2Fz\ndFF1ZXVlKCk7CiAgICBwcml2YXRlIExpbmtlZExpc3QgX2Jyb2FkY2FzdFRo\ncmVhZHMgPSBuZXcgTGlua2VkTGlzdCgpOwoKICAgIHByaXZhdGUgQXJyYXlM\naXN0IF9hZGRyZXNzZXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICBwcml2YXRl\nIFJlZW50cmFudExvY2sgX2FkZHJlc3Nlc0xvY2s7CgogICAgcHVibGljIFRD\nUFJlbW90ZUNvbW1pdFByb3ZpZGVyKCkKICAgICAgICB0aHJvd3MgVW5rbm93\nbkhvc3RFeGNlcHRpb24gewogICAgICAgIC8vIG9idGFpbiBhIHVuaXF1ZSBJ\nRC4KICAgICAgICBzeW5jaHJvbml6ZWQgKFRDUFJlbW90ZUNvbW1pdFByb3Zp\nZGVyLmNsYXNzKSB7CiAgICAgICAgICAgIF9pZCA9IHNfaWRTZXF1ZW5jZSsr\nOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FjaGUgdGhlIGxvY2FsIElQIGFk\nZHJlc3MuCiAgICAgICAgX2xvY2FsaG9zdCA9IEluZXRBZGRyZXNzLmdldExv\nY2FsSG9zdCgpLmdldEFkZHJlc3MoKTsKICAgICAgICBfYWRkcmVzc2VzTG9j\nayA9IG5ldyBSZWVudHJhbnRMb2NrKCk7CiAgICAgICAgc2V0TnVtQnJvYWRj\nYXN0VGhyZWFkcygyKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBwb3J0\nIHRoYXQgdGhpcyBwcm92aWRlciBzaG91bGQgbGlzdGVuIG9uLgogICAgICov\nCiAgICBwdWJsaWMgaW50IGdldFBvcnQoKSB7CiAgICAgICAgcmV0dXJuIF9w\nb3J0OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHBvcnQgdGhhdCB0aGlz\nIHByb3ZpZGVyIHNob3VsZCBsaXN0ZW4gb24uIFNldCBvbmNlIG9ubHkuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFBvcnQoaW50IHBvcnQpIHsKICAg\nICAgICBfcG9ydCA9IHBvcnQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUg\nbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSByZXRyeWlu\nZwogICAgICogdG8gcmVjb25uZWN0IHRvIGEgcGVlciBhZnRlciBpdCBiZWNv\nbWVzIHVucmVhY2hhYmxlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRS\nZWNvdmVyeVRpbWVNaWxsaXMoaW50IHJlY292ZXJ5dGltZSkgewogICAgICAg\nIF9yZWNvdmVyeVRpbWVNaWxsaXMgPSByZWNvdmVyeXRpbWU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3\nYWl0IGJlZm9yZSByZXRyeWluZwogICAgICogdG8gcmVjb25uZWN0IHRvIGEg\ncGVlciBhZnRlciBpdCBiZWNvbWVzIHVucmVhY2hhYmxlLgogICAgICovCiAg\nICBwdWJsaWMgaW50IGdldFJlY292ZXJ5VGltZU1pbGxpcygpIHsKICAgICAg\nICByZXR1cm4gX3JlY292ZXJ5VGltZU1pbGxpczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBzb2NrZXRzIHRoYXQgdGhp\ncyBwcm92aWRlciBjYW4KICAgICAqIHNpbWV0YW5lb3VzbHkgb3BlbiB0byBl\nYWNoIHBlZXIgaW4gdGhlIGNsdXN0ZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldE1heEFjdGl2ZShpbnQgbWF4QWN0aXZlKSB7CiAgICAgICAgX21h\neEFjdGl2ZSA9IG1heEFjdGl2ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBtYXhpbXVtIG51bWJlciBvZiBzb2NrZXRzIHRoYXQgdGhpcyBwcm92aWRl\nciBjYW4KICAgICAqIHNpbWV0YW5lb3VzbHkgb3BlbiB0byBlYWNoIHBlZXIg\naW4gdGhlIGNsdXN0ZXIuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0TWF4\nQWN0aXZlKCkgewogICAgICAgIHJldHVybiBfbWF4QWN0aXZlOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBpZGxlIHNvY2tldHMgdGhh\ndCB0aGlzIHByb3ZpZGVyIGNhbiBrZWVwIG9wZW4KICAgICAqIHRvIGVhY2gg\ncGVlciBpbiB0aGUgY2x1c3Rlci4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0TWF4SWRsZShpbnQgbWF4SWRsZSkgewogICAgICAgIF9tYXhJZGxlID0g\nbWF4SWRsZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBudW1iZXIgb2Yg\naWRsZSBzb2NrZXRzIHRoYXQgdGhpcyBwcm92aWRlciBjYW4ga2VlcCBvcGVu\nCiAgICAgKiB0byBlYWNoIHBlZXIgaW4gdGhlIGNsdXN0ZXIuCiAgICAgKi8K\nICAgIHB1YmxpYyBpbnQgZ2V0TWF4SWRsZSgpIHsKICAgICAgICByZXR1cm4g\nX21heElkbGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9m\nIHdvcmtlciB0aHJlYWRzIHRoYXQgYXJlIHVzZWQgZm9yCiAgICAgKiB0cmFu\nc21pdHRpbmcgcGFja2V0cyB0byBwZWVycyBpbiB0aGUgY2x1c3Rlci4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0TnVtQnJvYWRjYXN0VGhyZWFkcyhp\nbnQgbnVtQnJvYWRjYXN0VGhyZWFkcykgewogICAgICAgIHN5bmNocm9uaXpl\nZCAoX2Jyb2FkY2FzdFRocmVhZHMpIHsKICAgICAgICAgICAgaW50IGN1ciA9\nIF9icm9hZGNhc3RUaHJlYWRzLnNpemUoKTsKICAgICAgICAgICAgaWYgKGN1\nciA+IG51bUJyb2FkY2FzdFRocmVhZHMpIHsKICAgICAgICAgICAgICAgIC8v\nIE5vdGlmeSB0aGUgZXh0cmEgd29ya2VyIHRocmVhZHMgc28gdGhleSBzdG9w\nIHRoZW1zZWx2ZXMKICAgICAgICAgICAgICAgIC8vIFRocmVhZHMgd2lsbCBu\nb3QgZW5kIHVudGlsIHRoZXkgc2VuZCBhbm90aGVyIHBrLgogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IG51bUJyb2FkY2FzdFRocmVhZHM7IGkgPCBj\ndXI7IGkrKykgewogICAgICAgICAgICAgICAgICAgIEJyb2FkY2FzdFdvcmtl\nclRocmVhZCB3b3JrZXIgPSAoQnJvYWRjYXN0V29ya2VyVGhyZWFkKQogICAg\nICAgICAgICAgICAgICAgICAgICBfYnJvYWRjYXN0VGhyZWFkcy5yZW1vdmVG\naXJzdCgpOwogICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRSdW5uaW5n\nKGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNl\nIGlmIChjdXIgPCBudW1Ccm9hZGNhc3RUaHJlYWRzKSB7CiAgICAgICAgICAg\nICAgICAvLyBDcmVhdGUgYWRkaXRpb25hbCB3b3JrZXIgdGhyZWFkcwogICAg\nICAgICAgICAgICAgZm9yIChpbnQgaSA9IGN1cjsgaSA8IG51bUJyb2FkY2Fz\ndFRocmVhZHM7IGkrKykgewogICAgICAgICAgICAgICAgICAgIEJyb2FkY2Fz\ndFdvcmtlclRocmVhZCB3dCA9IG5ldyBCcm9hZGNhc3RXb3JrZXJUaHJlYWQo\nKTsKICAgICAgICAgICAgICAgICAgICB3dC5zZXREYWVtb24odHJ1ZSk7CiAg\nICAgICAgICAgICAgICAgICAgd3Quc3RhcnQoKTsKICAgICAgICAgICAgICAg\nICAgICBfYnJvYWRjYXN0VGhyZWFkcy5hZGRMYXN0KHd0KTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBudW1iZXIgb2Ygd29ya2VyIHRocmVhZHMgdGhhdCBh\ncmUgdXNlZCBmb3IKICAgICAqIHRyYW5zbWl0dGluZyBwYWNrZXRzIHRvIHBl\nZXJzIGluIHRoZSBjbHVzdGVyLgogICAgICovCiAgICBwdWJsaWMgaW50IGdl\ndE51bUJyb2FkY2FzdFRocmVhZHMoKSB7CiAgICAgICAgcmV0dXJuIF9icm9h\nZGNhc3RUaHJlYWRzLnNpemUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndHMgdGhlIGxpc3Qgb2YgYWRkcmVzc2VzIG9mIHBlZXJzIHRvIHdoaWNoIHRo\naXMgcHJvdmlkZXIgd2lsbAogICAgICogc2VuZCBldmVudHMgdG8uIFRoZSBw\nZWVycyBhcmUgc2VtaWNvbG9uLXNlcGFyYXRlZCA8Y29kZT5uYW1lczwvY29k\nZT4KICAgICAqIGxpc3QgaW4gdGhlIGZvcm0gb2YgIm15aG9zdDE6cG9ydEE7\nbXlob3N0Mjpwb3J0QiIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEFk\nZHJlc3NlcyhTdHJpbmcgbmFtZXMpCiAgICAgICAgdGhyb3dzIFVua25vd25I\nb3N0RXhjZXB0aW9uIHsKICAgICAgICAvLyBOWUkuIENvdWxkIGxvb2sgZm9y\nIGVxdWl2YWxlbmNlIG9mIGFkZHJlc3NlcyBhbmQgYXZvaWQKICAgICAgICAv\nLyBjaGFuZ2luZyB0aG9zZSB0aGF0IGRpZG4ndCBjaGFuZ2UuCgogICAgICAg\nIF9hZGRyZXNzZXNMb2NrLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBfYWRkcmVzc2VzLml0ZXJhdG9y\nKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgKChIb3N0\nQWRkcmVzcykgaXRlci5uZXh0KCkpLmNsb3NlKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgU3RyaW5nW10gdG9rcyA9IFN0cmluZ3Muc3BsaXQobmFt\nZXMsICI7IiwgMCk7CiAgICAgICAgICAgIF9hZGRyZXNzZXMgPSBuZXcgQXJy\nYXlMaXN0KHRva3MubGVuZ3RoKTsKCiAgICAgICAgICAgIEluZXRBZGRyZXNz\nIGxvY2FsaG9zdCA9IEluZXRBZGRyZXNzLmdldExvY2FsSG9zdCgpOwogICAg\nICAgICAgICBTdHJpbmcgbG9jYWxob3N0TmFtZSA9IGxvY2FsaG9zdC5nZXRI\nb3N0TmFtZSgpOwoKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0\nb2tzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgaG9z\ndCA9IHRva3NbaV07CiAgICAgICAgICAgICAgICBTdHJpbmcgaG9zdG5hbWU7\nCiAgICAgICAgICAgICAgICBpbnQgdG1wUG9ydDsKICAgICAgICAgICAgICAg\nIGludCBjb2xvbiA9IGhvc3QuaW5kZXhPZignOicpOwogICAgICAgICAgICAg\nICAgaWYgKGNvbG9uICE9IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgaG9z\ndG5hbWUgPSBob3N0LnN1YnN0cmluZygwLCBjb2xvbik7CiAgICAgICAgICAg\nICAgICAgICAgdG1wUG9ydCA9IEludGVnZXIucGFyc2VJbnQoaG9zdC5zdWJz\ndHJpbmcoY29sb24gKyAxKSk7CiAgICAgICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgICAgIGhvc3RuYW1lID0gaG9zdDsKICAgICAgICAg\nICAgICAgICAgICB0bXBQb3J0ID0gREVGQVVMVF9QT1JUOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgSW5ldEFkZHJlc3MgdG1wQWRkcmVz\ncyA9IEluZXRBZGRyZXNzLmdldEJ5TmFtZShob3N0bmFtZSk7CgogICAgICAg\nICAgICAgICAgLy8gYmxlYWlyOiBGb3IgZWFjaCBhZGRyZXNzIHdlIHdvdWxk\nIHJhdGhlciBtYWtlIHVzZSBvZgogICAgICAgICAgICAgICAgLy8gdGhlIGpk\nazEuNCBpc0xpbmtMb2NhbEFkZHJlc3MgKCkgfHwgaXNMb29wYmFja0FkZHJl\nc3MgKCkuCiAgICAgICAgICAgICAgICAvLyAoVGhvdWdoIGluIHByYWN0aWNl\nIG9uIHdpbjMyIHRoZXkgZG9uJ3Qgd29yayBhbnl3YXlzISkKICAgICAgICAg\nICAgICAgIC8vIEluc3RlYWQgd2Ugd2lsbCBjaGVjayBob3N0bmFtZS4gTm90\nIHBlcmZlY3QsIGJ1dAogICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBtYXRj\naCBvZnRlbiBlbm91Z2ggKHBlb3BsZSB3aWxsIHR5cGljYWxseQogICAgICAg\nICAgICAgICAgLy8gdXNlIHRoZSBETlMgbWFjaGluZSBuYW1lcyBhbmQgYmUg\nY3V0dGluZy9wYXN0aW5nLikKICAgICAgICAgICAgICAgIGlmIChsb2NhbGhv\nc3ROYW1lLmVxdWFscyhob3N0bmFtZSkpIHsKICAgICAgICAgICAgICAgICAg\nICAvLyBUaGlzIHN0cmluZyBtYXRjaGVzIHRoZSBob3N0bmFtZSBmb3IgZm9y\nIG91cnNlbHZlcywgd2UKICAgICAgICAgICAgICAgICAgICAvLyBkb24ndCBh\nY3R1YWxseSBuZWVkIHRvIHNlbmQgb3Vyc2VsdmVzIG1lc3NhZ2VzLgogICAg\nICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewog\nICAgICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2Uoc19sb2MuZ2V0KCJ0\nY3AtYWRkcmVzcy1hc3NlbGYiLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgdG1wQWRkcmVzcy5nZXRIb3N0TmFtZSgpICsgIjoiICsgdG1wUG9ydCkp\nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgSG9zdEFkZHJlc3MgbmV3QWRkcmVz\ncyA9IG5ldyBIb3N0QWRkcmVzcyhob3N0KTsKICAgICAgICAgICAgICAgICAg\nICBfYWRkcmVzc2VzLmFkZChuZXdBZGRyZXNzKTsKICAgICAgICAgICAgICAg\nICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgidGNwLWFkZHJlc3Mt\nc2V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0FkZHJlc3Mu\nX2FkZHJlc3MuZ2V0SG9zdE5hbWUoKSArICI6IgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICsgbmV3QWRkcmVzcy5fcG9ydCkpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgX2Fk\nZHJlc3Nlc0xvY2sudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8v\nIC0tLS0tLS0tLS0gQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9uIC0tLS0t\nLS0tLS0KCiAgICAvKioKICAgICAqIFN1YmNsYXNzZXMgdGhhdCBuZWVkIHRv\nIHBlcmZvcm0gYWN0aW9ucyBpbgogICAgICoge0BsaW5rIENvbmZpZ3VyYWJs\nZSNlbmRDb25maWd1cmF0aW9ufSBtdXN0IGludm9rZSB0aGlzIG1ldGhvZC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsK\nICAgICAgICBzdXBlci5lbmRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgc3lu\nY2hyb25pemVkIChzX3BvcnRMaXN0ZW5lck1hcCkgewogICAgICAgICAgICAv\nLyBzZWUgaWYgYSBsaXN0ZW5lciBleGlzdHMgZm9yIHRoaXMgcG9ydC4KICAg\nICAgICAgICAgX2xpc3RlbmVyID0gKFRDUFBvcnRMaXN0ZW5lcikgc19wb3J0\nTGlzdGVuZXJNYXAuZ2V0CiAgICAgICAgICAgICAgICAoU3RyaW5nLnZhbHVl\nT2YoX3BvcnQpKTsKCiAgICAgICAgICAgIGlmIChfbGlzdGVuZXIgPT0gbnVs\nbCB8fAogICAgICAgICAgICAgICAgKCFfbGlzdGVuZXIuaXNSdW5uaW5nKCkg\nJiYgX2xpc3RlbmVyLl9wb3J0ID09IF9wb3J0KSkgewogICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBfbGlzdGVuZXIgPSBuZXcg\nVENQUG9ydExpc3RlbmVyKF9wb3J0LCBsb2cpOwogICAgICAgICAgICAgICAg\nICAgIF9saXN0ZW5lci5saXN0ZW4oKTsKICAgICAgICAgICAgICAgICAgICBz\nX3BvcnRMaXN0ZW5lck1hcC5wdXQoU3RyaW5nLnZhbHVlT2YoX3BvcnQpLCBf\nbGlzdGVuZXIpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4\nY2VwdGlvbihzX2xvYy5nZXQoInRjcC1pbml0LWV4Y2VwdGlvbiIsCiAgICAg\nICAgICAgICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKF9wb3J0KSksIGUp\nLnNldEZhdGFsKHRydWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9IGVsc2UgaWYgKF9saXN0ZW5lci5pc1J1bm5pbmcoKSkgewogICAgICAg\nICAgICAgICAgaWYgKF9saXN0ZW5lci5fcG9ydCAhPSBfcG9ydCkgewogICAg\nICAgICAgICAgICAgICAgIC8vIHRoaXMgcmVhbGx5IHNob3VsZG4ndCBiZSBh\nYmxlIHRvIGhhcHBlbi4KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nR2VuZXJhbEV4Y2VwdGlvbihzX2xvYy5nZXQKICAgICAgICAgICAgICAgICAg\nICAgICAgKCJ0Y3Atbm90LWVxdWFsIiwgU3RyaW5nLnZhbHVlT2YoX3BvcnQp\nKSkuCiAgICAgICAgICAgICAgICAgICAgICAgIHNldEZhdGFsKHRydWUpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihzX2xvYy5nZXQo\nInRjcC1saXN0ZW5lci1icm9rZW4iKSk7CiAgICAgICAgICAgIF9saXN0ZW5l\nci5hZGRQcm92aWRlcih0aGlzKTsKICAgICAgICB9CgogICAgICAgIF9hZGRy\nZXNzZXNMb2NrLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBI\nb3N0QWRkcmVzcyBjdXJBZGRyZXNzOwogICAgICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ZXIgPSBfYWRkcmVzc2VzLml0ZXJhdG9yKCk7CiAgICAgICAgICAg\nICAgICBpdGVyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGN1ckFk\nZHJlc3MgPSAoSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgpOwogICAgICAgICAg\nICAgICAgY3VyQWRkcmVzcy5zZXRNYXhBY3RpdmUoX21heEFjdGl2ZSk7CiAg\nICAgICAgICAgICAgICBjdXJBZGRyZXNzLnNldE1heElkbGUoX21heElkbGUp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewog\nICAgICAgICAgICBfYWRkcmVzc2VzTG9jay51bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgLy8gLS0tLS0tLS0tLSBSZW1vdGVDb21taXRQcm92aWRl\nciBpbXBsZW1lbnRhdGlvbiAtLS0tLS0tLS0tCgogICAgLy8gcHJlIDMuMy40\nCT0gPG5vIHZlcnNpb24gbnVtYmVyIHRyYW5zbWl0dGVkPgogICAgLy8gMy4z\nIFByZXZpZXcgCT0gMHgxNDI4YWNmZDsKICAgIC8vIDMuNCAJCQk9IDB4MTQy\nOGFjZmY7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIFBST1RPQ09M\nX1ZFUlNJT04gPSAweDE0MjhhY2ZmOwoKICAgIHB1YmxpYyB2b2lkIGJyb2Fk\nY2FzdChSZW1vdGVDb21taXRFdmVudCBldmVudCkgewogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIC8vIGJ1aWxkIGEgcGFja2V0IG5vdGlmeWluZyBvdGhl\nciBKVk1zIG9mIG9iamVjdCBjaGFuZ2VzLgogICAgICAgICAgICBCeXRlQXJy\nYXlPdXRwdXRTdHJlYW0gYmFvcyA9IG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJl\nYW0oKTsKICAgICAgICAgICAgT2JqZWN0T3V0cHV0U3RyZWFtIG9vcyA9IG5l\ndyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyk7CgogICAgICAgICAgICBvb3Mu\nd3JpdGVMb25nKFBST1RPQ09MX1ZFUlNJT04pOwogICAgICAgICAgICBvb3Mu\nd3JpdGVMb25nKF9pZCk7CiAgICAgICAgICAgIG9vcy53cml0ZUludChfcG9y\ndCk7CiAgICAgICAgICAgIG9vcy53cml0ZU9iamVjdChfbG9jYWxob3N0KTsK\nICAgICAgICAgICAgb29zLndyaXRlT2JqZWN0KGV2ZW50KTsKICAgICAgICAg\nICAgb29zLmZsdXNoKCk7CgogICAgICAgICAgICBieXRlW10gYnl0ZXMgPSBi\nYW9zLnRvQnl0ZUFycmF5KCk7CiAgICAgICAgICAgIGJhb3MuY2xvc2UoKTsK\nICAgICAgICAgICAgaWYgKF9icm9hZGNhc3RUaHJlYWRzLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgICAgIHNlbmRVcGRhdGVQYWNrZXQoYnl0ZXMpOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBfYnJvYWRjYXN0UXVldWUu\nYWRkUGFja2V0KGJ5dGVzKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpb2UpIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoInRjcC1wYXls\nb2FkLWNyZWF0ZS1lcnJvciIpLCBpb2UpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFNlbmRzIGEgY2hhbmdlIG5vdGlmaWNhdGlvbiBwYWNr\nZXQgdG8gb3RoZXIgbWFjaGluZXMgaW4gdGhpcwogICAgICogcHJvdmlkZXIg\nY2x1c3Rlci4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlbmRVcGRhdGVQ\nYWNrZXQoYnl0ZVtdIGJ5dGVzKSB7CiAgICAgICAgX2FkZHJlc3Nlc0xvY2su\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRlciA9IF9hZGRyZXNzZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0\nKCk7KQogICAgICAgICAgICAgICAgKChIb3N0QWRkcmVzcykgaXRlci5uZXh0\nKCkpLnNlbmRVcGRhdGVQYWNrZXQoYnl0ZXMpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIF9hZGRyZXNzZXNMb2NrLnVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgICAg\nICBpZiAoX2xpc3RlbmVyICE9IG51bGwpCiAgICAgICAgICAgIF9saXN0ZW5l\nci5yZW1vdmVQcm92aWRlcih0aGlzKTsKCiAgICAgICAgX2FkZHJlc3Nlc0xv\nY2subG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRlciA9IF9hZGRyZXNzZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNO\nZXh0KCk7KQogICAgICAgICAgICAgICAgKChIb3N0QWRkcmVzcykgaXRlci5u\nZXh0KCkpLmNsb3NlKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgX2FkZHJlc3Nlc0xvY2sudW5sb2NrKCk7CiAgICAgICAgfQoKICAgICAg\nICAvLyBXZSBhcmUgZG9uZSB0cmFuc21pdHRpbmcuIEludGVycnVwdCBhbnkg\nd29ya2VyIHRocmVhZHMuCiAgICAgICAgc3luY2hyb25pemVkIChfYnJvYWRj\nYXN0VGhyZWFkcykgewogICAgICAgICAgICBUaHJlYWQgd29ya2VyOwogICAg\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBfYnJvYWRjYXN0VGhyZWFk\ncy5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgICAgICB3b3JrZXIgPSAoVGhyZWFkKSBpdGVyLm5l\neHQoKTsKICAgICAgICAgICAgICAgIHdvcmtlci5pbnRlcnJ1cHQoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFV0\naWxpdHkgY2xhc3MgdG8gaG9sZCBtZXNzYWdlcyB0byBiZSBzZW50LiBUaGlz\nCiAgICAgKiBhbGxvd3MgY2FsbHMgdG8gYnJvYWRjYXN0ICgpIHRvIHJldHVy\nbiB3aXRob3V0CiAgICAgKiB3YWl0aW5nIGZvciB0aGUgc2VuZCB0byBjb21w\nbGV0ZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQnJvYWRj\nYXN0UXVldWUgewoKICAgICAgICBMaW5rZWRMaXN0IF9wYWNrZXRRdWV1ZSA9\nIG5ldyBMaW5rZWRMaXN0KCk7CgogICAgICAgIHB1YmxpYyBzeW5jaHJvbml6\nZWQgdm9pZCBhZGRQYWNrZXQoYnl0ZVtdIGJ5dGVzKSB7CiAgICAgICAgICAg\nIF9wYWNrZXRRdWV1ZS5hZGRMYXN0KGJ5dGVzKTsKICAgICAgICAgICAgbm90\naWZ5KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgc3luY2hyb25pemVk\nIGJ5dGVbXSByZW1vdmVQYWNrZXQoKQogICAgICAgICAgICB0aHJvd3MgSW50\nZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgICAgICB3aGlsZSAoX3BhY2tl\ndFF1ZXVlLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIHdhaXQoKTsKICAg\nICAgICAgICAgcmV0dXJuIChieXRlW10pIF9wYWNrZXRRdWV1ZS5yZW1vdmVG\naXJzdCgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRocmVh\nZHMgdG8gYnJvYWRjYXN0IHBhY2tldHMgcGxhY2VkIGluIHRoZSB7QGxpbmsg\nQnJvYWRjYXN0UXVldWV9LgogICAgICovCiAgICBwcml2YXRlIGNsYXNzIEJy\nb2FkY2FzdFdvcmtlclRocmVhZAogICAgICAgIGV4dGVuZHMgVGhyZWFkIHsK\nCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIF9rZWVwUnVubmluZyA9IHRydWU7\nCgogICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAgICAgd2hp\nbGUgKF9rZWVwUnVubmluZykgewogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgYmxvY2sgdW50aWwgdGhl\ncmUgaXMgYSBwYWNrZXQgdG8gc2VuZC4KICAgICAgICAgICAgICAgICAgICBi\neXRlW10gYnl0ZXMgPSBfYnJvYWRjYXN0UXVldWUucmVtb3ZlUGFja2V0KCk7\nCiAgICAgICAgICAgICAgICAgICAgc2VuZFVwZGF0ZVBhY2tldChieXRlcyk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gRW5kIHRoZSB0aHJlYWQu\nCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lk\nIHNldFJ1bm5pbmcoYm9vbGVhbiBrZWVwUnVubmluZykgewogICAgICAgICAg\nICBfa2VlcFJ1bm5pbmcgPSBrZWVwUnVubmluZzsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXNwb25zaWJsZSBmb3IgbGlzdGVuaW5nIGZv\nciBpbmNvbWluZyBwYWNrZXRzIGFuZCBwcm9jZXNzaW5nIHRoZW0uCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFRDUFBvcnRMaXN0ZW5lcgog\nICAgICAgIGltcGxlbWVudHMgUnVubmFibGUgewoKICAgICAgICBwcml2YXRl\nIHN0YXRpYyBMb2NhbGl6ZXIgc19sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZQogICAgICAgICAgICAoVENQUG9ydExpc3RlbmVyLmNsYXNzKTsKCiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBMb2cgX2xvZzsKICAgICAgICBwcml2YXRlIFNl\ncnZlclNvY2tldCBfcmVjZWl2ZVNvY2tldDsKICAgICAgICBwcml2YXRlIFRo\ncmVhZCBfYWNjZXB0VGhyZWFkOwogICAgICAgIHByaXZhdGUgU2V0IF9yZWNl\naXZlclRocmVhZHMgPSBuZXcgSGFzaFNldCgpOwogICAgICAgIHByaXZhdGUg\nU2V0IF9wcm92aWRlcnMgPSBuZXcgSGFzaFNldCgpOwoKICAgICAgICAvKioK\nICAgICAgICAgKiBDYWNoZSB0aGUgbG9jYWwgSVAgYWRkcmVzcwogICAgICAg\nICAqLwogICAgICAgIHByaXZhdGUgYnl0ZVtdIF9sb2NhbGhvc3Q7CgogICAg\nICAgIC8qKgogICAgICAgICAqIFRoZSBwb3J0IHRoYXQgdGhpcyBsaXN0ZW5l\nciBzaG91bGQgbGlzdGVuIG9uLiBDb25maWd1cmVkCiAgICAgICAgICogYnkg\nVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIuCiAgICAgICAgICovCiAgICAgICAg\ncHJpdmF0ZSBpbnQgX3BvcnQ7CgogICAgICAgIC8qKgogICAgICAgICAqIFNo\nb3VsZCBiZSBzZXQgdG8gPGNvZGU+dHJ1ZTwvY29kZT4gb25jZSB0aGUgbGlz\ndGVuZXIgaXMgbGlzdGVuaW5nLgogICAgICAgICAqLwogICAgICAgIHByaXZh\ndGUgYm9vbGVhbiBfaXNSdW5uaW5nID0gZmFsc2U7CgogICAgICAgIC8qKgog\nICAgICAgICAqIENvbnN0cnVjdCBhIG5ldyBUQ1BQb3J0TGlzdGVuZXIgY29u\nZmlndXJlZCB0byB1c2UgdGhlIHNwZWNpZmllZCBwb3J0LgogICAgICAgICAq\nLwogICAgICAgIHByaXZhdGUgVENQUG9ydExpc3RlbmVyKGludCBwb3J0LCBM\nb2cgbG9nKQogICAgICAgICAgICB0aHJvd3MgVW5rbm93bkhvc3RFeGNlcHRp\nb24sIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgX3BvcnQgPSBwb3J0Owog\nICAgICAgICAgICBfbG9nID0gbG9nOwogICAgICAgICAgICBfcmVjZWl2ZVNv\nY2tldCA9IG5ldyBTZXJ2ZXJTb2NrZXQoX3BvcnQpOwogICAgICAgICAgICBf\nbG9jYWxob3N0ID0gSW5ldEFkZHJlc3MuZ2V0TG9jYWxIb3N0KCkuZ2V0QWRk\ncmVzcygpOwoKICAgICAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgIF9sb2cuaW5mbyhzX2xvYy5nZXQoInRjcC1z\ndGFydC1saXN0ZW5lciIsCiAgICAgICAgICAgICAgICAgICAgU3RyaW5nLnZh\nbHVlT2YoX3BvcnQpKSk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZv\naWQgbGlzdGVuKCkgewogICAgICAgICAgICBfYWNjZXB0VGhyZWFkID0gbmV3\nIFRocmVhZCh0aGlzKTsKICAgICAgICAgICAgX2FjY2VwdFRocmVhZC5zZXRE\nYWVtb24odHJ1ZSk7CiAgICAgICAgICAgIF9hY2NlcHRUaHJlYWQuc3RhcnQo\nKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEFsbCBwcm92\naWRlcnMgYWRkZWQgaGVyZSB3aWxsIGJlIG5vdGlmaWVkIG9mIGFueSBpbmNv\nbWluZwogICAgICAgICAqIHByb3ZpZGVyIG1lc3NhZ2VzLiBUaGVyZSB3aWxs\nIGJlIG9uZSBvZiB0aGVzZSBwZXIKICAgICAgICAgKiBCcm9rZXJGYWN0b3J5\nIGluIGEgZ2l2ZW4gSlZNLgogICAgICAgICAqIHtAbGluayBUQ1BSZW1vdGVD\nb21taXRQcm92aWRlciNlbmRDb25maWd1cmF0aW9ufSBpbnZva2VzCiAgICAg\nICAgICogPGNvZGU+YWRkUHJvdmlkZXI8L2NvZGU+IHdpdGggPGNvZGU+dGhp\nczwvY29kZT4gdXBvbgogICAgICAgICAqIGNvbXBsZXRpb24gb2YgY29uZmln\ndXJhdGlvbi4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgYWRk\nUHJvdmlkZXIoVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIgcHJvdmlkZXIpIHsK\nICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7CiAgICAg\nICAgICAgICAgICBfcHJvdmlkZXJzLmFkZChwcm92aWRlcik7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJlbW92\nZSBhIHByb3ZpZGVyIGZyb20gdGhlIGxpc3Qgb2YgcHJvdmlkZXJzIHRvIG5v\ndGlmeSBvZgogICAgICAgICAqIGNvbW1pdCBldmVudHMuCiAgICAgICAgICov\nCiAgICAgICAgcHJpdmF0ZSBzeW5jaHJvbml6ZWQgdm9pZCByZW1vdmVQcm92\naWRlcgogICAgICAgICAgICAoVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIgcHJv\ndmlkZXIpIHsKICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJz\nKSB7CiAgICAgICAgICAgICAgICBfcHJvdmlkZXJzLnJlbW92ZShwcm92aWRl\ncik7CgogICAgICAgICAgICAgICAgLy8gaWYgdGhlIHByb3ZpZGVyIGxpc3Qg\naXMgZW1wdHksIHNodXQgZG93biB0aGUgdGhyZWFkLgogICAgICAgICAgICAg\nICAgaWYgKF9wcm92aWRlcnMuc2l6ZSgpID09IDApIHsKICAgICAgICAgICAg\nICAgICAgICBfaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgX3JlY2VpdmVTb2Nr\nZXQuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9s\nb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgX2xvZy53YXJuKHNfbG9jLmdldCgidGNwLWNsb3NlLWVycm9yIiksIGlv\nZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIF9hY2NlcHRUaHJlYWQuaW50ZXJydXB0KCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZhdGUgYm9v\nbGVhbiBpc1J1bm5pbmcoKSB7CiAgICAgICAgICAgIHN5bmNocm9uaXplZCAo\nX3Byb3ZpZGVycykgewogICAgICAgICAgICAgICAgcmV0dXJuIF9pc1J1bm5p\nbmc7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIHJ1bigpIHsKICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlk\nZXJzKSB7CiAgICAgICAgICAgICAgICBfaXNSdW5uaW5nID0gdHJ1ZTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgU29ja2V0IHMgPSBudWxsOwogICAg\nICAgICAgICB3aGlsZSAoX2lzUnVubmluZykgewogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICBzID0gbnVsbDsKICAgICAgICAg\nICAgICAgICAgICAvLyBCbG9jaywgd2FpdGluZyB0byBhY2NlcHQgbmV3IGNv\nbm5lY3Rpb24gZnJvbSBhIHBlZXIKICAgICAgICAgICAgICAgICAgICBzID0g\nX3JlY2VpdmVTb2NrZXQuYWNjZXB0KCk7CiAgICAgICAgICAgICAgICAgICAg\naWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAg\nICAgICAgICBfbG9nLnRyYWNlKHNfbG9jLmdldCgidGNwLXJlY2VpdmVkLWNv\nbm5lY3Rpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcy5nZXRJ\nbmV0QWRkcmVzcygpLmdldEhvc3RBZGRyZXNzKCkKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICArICI6IiArIHMuZ2V0UG9ydCgpKSk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIFJlY2VpdmVT\nb2NrZXRIYW5kbGVyIHNoID0gbmV3IFJlY2VpdmVTb2NrZXRIYW5kbGVyKHMp\nOwogICAgICAgICAgICAgICAgICAgIFRocmVhZCByZWNlaXZlclRocmVhZCA9\nIG5ldyBUaHJlYWQoc2gpOwogICAgICAgICAgICAgICAgICAgIHJlY2VpdmVy\nVGhyZWFkLnNldERhZW1vbih0cnVlKTsKICAgICAgICAgICAgICAgICAgICBy\nZWNlaXZlclRocmVhZC5zdGFydCgpOwogICAgICAgICAgICAgICAgICAgIF9y\nZWNlaXZlclRocmVhZHMuYWRkKHJlY2VpdmVyVGhyZWFkKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIFNvY2tldEV4Y2VwdGlvbikgfHwg\nX2lzUnVubmluZykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9sb2cu\naXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nX2xvZy53YXJuKHNfbG9jLmdldCgidGNwLWFjY2VwdC1lcnJvciIpLCBlKTsK\nCiAgICAgICAgICAgICAgICAgICAgLy8gTm9taW5hbCBjYXNlIChJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbikgYmVjYXVzZSBjbG9zZSAoKQogICAgICAgICAgICAg\nICAgICAgIC8vIGNhbGxzIF9hY2NlcHRUaHJlYWQuaW50ZXJydXB0ICgpOwog\nICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChzICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBzLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIF9sb2cud2FybihzX2xvYy5nZXQoInRjcC1jbG9zZS1lcnJvciIpLCBlKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIC8vIFdlIGFyZSBkb25lIGxpc3Rlbmlu\nZy4gSW50ZXJydXB0IGFueSB3b3JrZXIgdGhyZWFkcy4KICAgICAgICAgICAg\nVGhyZWFkIHdvcmtlcjsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdGVy\nID0gX3JlY2VpdmVyVGhyZWFkcy5pdGVyYXRvcigpOwogICAgICAgICAgICAg\nICAgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICB3b3JrZXIg\nPSAoVGhyZWFkKSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgICAgIC8vIEZZ\nSSwgdGhlIHdvcmtlciB0aHJlYWRzIGFyZSBibG9ja2VkCiAgICAgICAgICAg\nICAgICAvLyByZWFkaW5nIGZyb20gdGhlIHNvY2tldCdzIElucHV0U3RyZWFt\nLiBJbnB1dFN0cmVhbXMKICAgICAgICAgICAgICAgIC8vIGFyZW4ndCBpbnRl\ncnJ1cHRhYmxlLCBzbyB0aGlzIGludGVycnVwdCBpc24ndAogICAgICAgICAg\nICAgICAgLy8gcmVhbGx5IGdvaW5nIHRvIGJlIGRlbGl2ZXJlZCB1bnRpbCBz\nb21ldGhpbmcgYnJlYWtzCiAgICAgICAgICAgICAgICAvLyB0aGUgSW5wdXRT\ndHJlYW0uCiAgICAgICAgICAgICAgICB3b3JrZXIuaW50ZXJydXB0KCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlk\nZXJzKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIGlmIChfaXNSdW5uaW5nKQogICAgICAgICAgICAgICAgICAgICAgICBf\ncmVjZWl2ZVNvY2tldC5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2xv\nZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIF9s\nb2cud2FybihzX2xvYy5nZXQoInRjcC1jbG9zZS1lcnJvciIpLCBlKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9pc1J1bm5pbmcgPSBm\nYWxzZTsKICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZy50cmFjZShzX2xvYy5nZXQo\nInRjcC1jbG9zZS1saXN0ZW5lciIsCiAgICAgICAgICAgICAgICAgICAgICAg\nIF9wb3J0ICsgIiIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgLyoqCiAgICAgICAgICogVXRpbGl0eSBjbGFzcyB0aGF0IGFjdHMgYXMg\nYSB3b3JrZXIgdGhyZWFkIHRvIHJlY2VpdmUgRXZlbnRzCiAgICAgICAgICog\nZnJvbSBicm9hZGNhc3RlcnMuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0\nZSBjbGFzcyBSZWNlaXZlU29ja2V0SGFuZGxlcgogICAgICAgICAgICBpbXBs\nZW1lbnRzIFJ1bm5hYmxlIHsKCiAgICAgICAgICAgIHByaXZhdGUgSW5wdXRT\ndHJlYW0gX2luOwogICAgICAgICAgICBwcml2YXRlIFNvY2tldCBfczsKCiAg\nICAgICAgICAgIHByaXZhdGUgUmVjZWl2ZVNvY2tldEhhbmRsZXIoU29ja2V0\nIHMpIHsKICAgICAgICAgICAgICAgIC8vIFdlIGFyZSB0aGUgcmVjZWl2aW5n\nIGVuZCBhbmQgd2UgZG9uJ3Qgc2VuZCBhbnkgbWVzc2FnZXMKICAgICAgICAg\nICAgICAgIC8vIGJhY2sgdG8gdGhlIGJyb2FkY2FzdGVyLiBUdXJuIG9mZiBO\nYWdsZSdzIHNvIHRoYXQKICAgICAgICAgICAgICAgIC8vIHdlIHdpbGwgc2Vu\nZCBhY2sgcGFja2V0cyB3aXRob3V0IHdhaXRpbmcuCiAgICAgICAgICAgICAg\nICBfcyA9IHM7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIF9zLnNldFRjcE5vRGVsYXkodHJ1ZSk7CiAgICAgICAgICAgICAg\nICAgICAgX2luID0gbmV3IEJ1ZmZlcmVkSW5wdXRTdHJlYW0ocy5nZXRJbnB1\ndFN0cmVhbSgpKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0\naW9uIGlvZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzSW5m\nb0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy5pbmZv\nKHNfbG9jLmdldCgidGNwLXNvY2tldC1vcHRpb24tZXJyb3IiKSwgaW9lKTsK\nICAgICAgICAgICAgICAgICAgICBfcyA9IG51bGw7CiAgICAgICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAg\nIGlmIChfbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgX2xvZy53YXJuKHNfbG9jLmdldCgidGNwLXJlY2VpdmUtZXJyb3Ii\nKSwgZSk7CiAgICAgICAgICAgICAgICAgICAgX3MgPSBudWxsOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBydW4oKSB7CiAgICAgICAgICAgICAgICBpZiAoX3MgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB3\naGlsZSAoX2lzUnVubmluZyAmJiBfcyAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhp\ncyB3aWxsIGJsb2NrIG91ciB0aHJlYWQsIHdhaXRpbmcgdG8gcmVhZAogICAg\nICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbmV4dCBFdmVudC1vYmplY3Qt\nbWVzc2FnZS4KICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlKF9pbik7\nCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRU9GRXhjZXB0aW9uIGVv\nZikgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBFT0ZFeGNlcHRpb24g\ncmFpc2VkIHdoZW4gcGVlciBpcyBwcm9wZXJseQogICAgICAgICAgICAgICAg\nICAgICAgICAvLyBjbG9zaW5nIGl0cyBlbmQuCiAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIF9sb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3At\nY2xvc2Utc29ja2V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBfcy5nZXRJbmV0QWRkcmVzcygpLmdldEhvc3RBZGRyZXNzKCkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiOiIgKyBfcy5nZXRQ\nb3J0KCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAoX2xvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBfbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtcmVjZWl2ZS1lcnJv\nciIpLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAvLyBXZSBhcmUgZG9uZSByZWNlaXZpbmcgb24gdGhpcyBzb2NrZXQg\nYW5kIHRoaXMgd29ya2VyCiAgICAgICAgICAgICAgICAvLyB0aHJlYWQgaXMg\ndGVybWluYXRpbmcuCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgIF9pbi5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIF9z\nLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihzX2xvYy5nZXQo\nInRjcC1jbG9zZS1zb2NrZXQtZXJyb3IiLAogICAgICAgICAgICAgICAgICAg\nICAgICBfcy5nZXRJbmV0QWRkcmVzcygpLmdldEhvc3RBZGRyZXNzKCkgKyAi\nOiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgX3MuZ2V0UG9ydCgp\nKSwgZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIC8qKgogICAgICAgICAgICAgKiBQcm9jZXNzIGFuIHtAbGluayBJ\nbnB1dFN0cmVhbX0gY29udGFpbmluZyBvYmplY3RzIHdyaXR0ZW4KICAgICAg\nICAgICAgICogYnkge0BsaW5rIFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVyI2Jy\nb2FkY2FzdENvbW1pdEluZm99LgogICAgICAgICAgICAgKi8KICAgICAgICAg\nICAgcHJpdmF0ZSB2b2lkIGhhbmRsZShJbnB1dFN0cmVhbSBpbikKICAgICAg\nICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4\nY2VwdGlvbiwKICAgICAgICAgICAgICAgIE9wdGlvbmFsRGF0YUV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgYmxvY2sgd2FpdGlu\nZyBmb3IgdGhlIG5leHQKICAgICAgICAgICAgICAgIE9iamVjdElucHV0U3Ry\nZWFtIG9pcyA9IAogICAgICAgICAgICAgICAgICAgIG5ldyBTZXJpYWxpemF0\naW9uLkNsYXNzUmVzb2x2aW5nT2JqZWN0SW5wdXRTdHJlYW0oaW4pOwoKICAg\nICAgICAgICAgICAgIGxvbmcgcHJvdG9jb2xWZXJzaW9uID0gb2lzLnJlYWRM\nb25nKCk7CiAgICAgICAgICAgICAgICBpZiAocHJvdG9jb2xWZXJzaW9uICE9\nIFBST1RPQ09MX1ZFUlNJT04pIHsKICAgICAgICAgICAgICAgICAgICBpZiAo\nX2xvZy5pc1dhcm5FbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgX2xvZy53YXJuKHNfbG9jLmdldCgidGNwLXdyb25nLXZlcnNpb24tZXJy\nb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3MuZ2V0SW5ldEFk\nZHJlc3MoKS5nZXRIb3N0QWRkcmVzcygpICsgIjoiCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyBfcy5nZXRQb3J0KCkpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsb25nIHNlbmRl\ncklkID0gb2lzLnJlYWRMb25nKCk7CiAgICAgICAgICAgICAgICBpbnQgc2Vu\nZGVyUG9ydCA9IG9pcy5yZWFkSW50KCk7CiAgICAgICAgICAgICAgICBieXRl\nW10gc2VuZGVyQWRkcmVzcyA9IChieXRlW10pIG9pcy5yZWFkT2JqZWN0KCk7\nCiAgICAgICAgICAgICAgICBSZW1vdGVDb21taXRFdmVudCByY2UgPSAoUmVt\nb3RlQ29tbWl0RXZlbnQpIG9pcy5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAg\nICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgX2xvZy50cmFjZShzX2xvYy5nZXQoInRjcC1yZWNlaXZlZC1l\ndmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgIF9zLmdldEluZXRBZGRy\nZXNzKCkuZ2V0SG9zdEFkZHJlc3MoKSArICI6IgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyBfcy5nZXRQb3J0KCkpKTsKICAgICAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgICAgICBib29sZWFuIGZyb21TZWxmID0gc2VuZGVy\nUG9ydCA9PSBfcG9ydCAmJgogICAgICAgICAgICAgICAgICAgIEFycmF5cy5l\ncXVhbHMoc2VuZGVyQWRkcmVzcywgX2xvY2FsaG9zdCk7CiAgICAgICAgICAg\nICAgICBUQ1BSZW1vdGVDb21taXRQcm92aWRlciBwcm92aWRlcjsKICAgICAg\nICAgICAgICAgIHN5bmNocm9uaXplZCAoX3Byb3ZpZGVycykgewogICAgICAg\nICAgICAgICAgICAgIC8vIGJsZWFpcjogV2UncmUgaXRlcmF0aW5nLCBidXQg\nY3VycmVubHR5IHRoZXJlIGNhbiByZWFsbHkKICAgICAgICAgICAgICAgICAg\nICAvLyBvbmx5IGJlIGEgc2luZ2xlIHByb3ZpZGVyLgogICAgICAgICAgICAg\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IF9wcm92aWRlcnMuaXRlcmF0\nb3IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gKFRDUFJl\nbW90ZUNvbW1pdFByb3ZpZGVyKSBpdGVyLm5leHQoKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKHNlbmRlcklkICE9IHByb3ZpZGVyLl9pZCB8fCAh\nZnJvbVNlbGYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRl\nci5ldmVudE1hbmFnZXIuZmlyZUV2ZW50KHJjZSk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogVXRpbGl0eSBjbGFzcyB0byBz\ndG9yZSBhbiBJbmV0QWRkcmVzcyBhbmQgYW4gaW50LiBOb3QgdXNpbmcKICAg\nICAqIEluZXRTb2NrZXRBZGRyZXNzIGJlY2F1c2UgaXQncyBhIEpESzEuNCBB\nUEkuIFRoaXMgYWxzbwogICAgICogcHJvdmlkZXMgYSB3cmFwcGVyIGFyb3Vu\nZCB0aGUgc29ja2V0KHMpIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGFkZHJlc3Mu\nCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgSG9zdEFkZHJlc3MgewoKICAg\nICAgICBwcml2YXRlIEluZXRBZGRyZXNzIF9hZGRyZXNzOwogICAgICAgIHBy\naXZhdGUgaW50IF9wb3J0OwogICAgICAgIHByaXZhdGUgbG9uZyBfdGltZUxh\nc3RFcnJvcjsgLy8gbWlsbGlzCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIF9p\nc0F2YWlsYWJsZTsgLy8gaXMgcGVlciB0aG91Z2h0IHRvIGJlIHVwCiAgICAg\nICAgcHJpdmF0ZSBpbnQgX2luZm9zSXNzdWVkID0gMDsgLy8gbGltaXQgbG9n\nIGVudHJpZXMKCiAgICAgICAgcHJpdmF0ZSBHZW5lcmljT2JqZWN0UG9vbCBf\nc29ja2V0UG9vbDsgLy8gcmV1c2FibGUgb3BlbiBzb2NrZXRzCgogICAgICAg\nIC8qKgogICAgICAgICAqIENvbnN0cnVjdCBhIG5ldyBob3N0IGFkZHJlc3Mg\nZnJvbSBhIHN0cmluZyBvZiB0aGUgZm9ybQogICAgICAgICAqICJob3N0OnBv\ncnQiIG9yIG9mIHRoZSBmb3JtICJob3N0Ii4KICAgICAgICAgKi8KICAgICAg\nICBwcml2YXRlIEhvc3RBZGRyZXNzKFN0cmluZyBob3N0KQogICAgICAgICAg\nICB0aHJvd3MgVW5rbm93bkhvc3RFeGNlcHRpb24gewogICAgICAgICAgICBp\nbnQgY29sb24gPSBob3N0LmluZGV4T2YoJzonKTsKICAgICAgICAgICAgaWYg\nKGNvbG9uICE9IC0xKSB7CiAgICAgICAgICAgICAgICBfYWRkcmVzcyA9IElu\nZXRBZGRyZXNzLmdldEJ5TmFtZShob3N0LnN1YnN0cmluZygwLCBjb2xvbikp\nOwogICAgICAgICAgICAgICAgX3BvcnQgPSBJbnRlZ2VyLnBhcnNlSW50KGhv\nc3Quc3Vic3RyaW5nKGNvbG9uICsgMSkpOwogICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgX2FkZHJlc3MgPSBJbmV0QWRkcmVzcy5nZXRC\neU5hbWUoaG9zdCk7CiAgICAgICAgICAgICAgICBfcG9ydCA9IERFRkFVTFRf\nUE9SVDsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyAtMSBtYXggd2Fp\ndCA9PSBhcyBsb25nIGFzIGl0IHRha2VzCiAgICAgICAgICAgIF9zb2NrZXRQ\nb29sID0gbmV3IEdlbmVyaWNPYmplY3RQb29sCiAgICAgICAgICAgICAgICAo\nbmV3IFNvY2tldFBvb2xhYmxlT2JqZWN0RmFjdG9yeSgpLCBfbWF4QWN0aXZl\nLAogICAgICAgICAgICAgICAgICAgIEdlbmVyaWNPYmplY3RQb29sLldIRU5f\nRVhIQVVTVEVEX0JMT0NLLCAtMSk7CiAgICAgICAgICAgIF9pc0F2YWlsYWJs\nZSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgc2V0\nTWF4QWN0aXZlKGludCBtYXhBY3RpdmUpIHsKICAgICAgICAgICAgX3NvY2tl\ndFBvb2wuc2V0TWF4QWN0aXZlKG1heEFjdGl2ZSk7CiAgICAgICAgfQoKICAg\nICAgICBwcml2YXRlIHZvaWQgc2V0TWF4SWRsZShpbnQgbWF4SWRsZSkgewog\nICAgICAgICAgICBfc29ja2V0UG9vbC5zZXRNYXhJZGxlKG1heElkbGUpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAg\nICAgICAgIC8vIENsb3NlIHRoZSBwb29sIG9mIHNvY2tldHMgdG8gdGhpcyBw\nZWVyLiBUaGlzCiAgICAgICAgICAgIC8vIHdpbGwgY2xvc2UgYWxsIHNvY2tl\ndHMgaW4gdGhlIHBvb2wuCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBfc29ja2V0UG9vbC5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dh\ncm5FbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICBsb2cud2Fybihz\nX2xvYy5nZXQoInRjcC1jbG9zZS1wb29sLWVycm9yIiksIGUpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBw\ncml2YXRlIHZvaWQgc2VuZFVwZGF0ZVBhY2tldChieXRlW10gYnl0ZXMpIHsK\nICAgICAgICAgICAgaWYgKCFfaXNBdmFpbGFibGUpIHsKICAgICAgICAgICAg\nICAgIGxvbmcgbm93ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAg\nICAgICAgICAgICAgICBpZiAobm93IC0gX3RpbWVMYXN0RXJyb3IgPCBfcmVj\nb3ZlcnlUaW1lTWlsbGlzKQogICAgICAgICAgICAgICAgICAgIC8vIE5vdCBl\nbm91Z2ggdGltZSBoYXMgcGFzc2VkIHNpbmNlIHRoZSBsYXN0IGVycm9yCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIFNvY2tldCBzID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHMgPSBnZXRTb2NrZXQoKTsKICAgICAgICAgICAgICAg\nIE91dHB1dFN0cmVhbSBvcyA9IHMuZ2V0T3V0cHV0U3RyZWFtKCk7CiAgICAg\nICAgICAgICAgICBvcy53cml0ZShieXRlcyk7CiAgICAgICAgICAgICAgICBv\ncy5mbHVzaCgpOwoKICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVu\nYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgIGxvZy50cmFjZShzX2xv\nYy5nZXQoInRjcC1zZW50LXVwZGF0ZSIsCiAgICAgICAgICAgICAgICAgICAg\nICAgIF9hZGRyZXNzLmdldEhvc3RBZGRyZXNzKCkgKyAiOiIgKyBfcG9ydCwK\nICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2Yocy5nZXRM\nb2NhbFBvcnQoKSkpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIF9pc0F2YWlsYWJsZSA9IHRydWU7CiAgICAgICAgICAgICAgICBfaW5m\nb3NJc3N1ZWQgPSAwOwogICAgICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBz\nb2NrZXQgdG8gdGhlIHBvb2w7IHRoZSBzb2NrZXQgaXMKICAgICAgICAgICAg\nICAgIC8vIHN0aWxsIGdvb2QuCiAgICAgICAgICAgICAgICByZXR1cm5Tb2Nr\nZXQocyk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAvLyBUaGVyZSBoYXMgYmVlbiBhIHByb2JsZW0gc2Vu\nZGluZyB0byB0aGUgcGVlci4KICAgICAgICAgICAgICAgIC8vIFRoZSBPUyBz\nb2NrZXQgdGhhdCB3YXMgYmVpbmcgdXNlZCBpcyBjYW4gbm8gbG9uZ2VyCiAg\nICAgICAgICAgICAgICAvLyBiZSB1c2VkLgogICAgICAgICAgICAgICAgaWYg\nKHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlU29j\na2V0KHMpOwogICAgICAgICAgICAgICAgdGhpcy5jbGVhckFsbFNvY2tldHMo\nKTsKCiAgICAgICAgICAgICAgICBpZiAoX2lzQXZhaWxhYmxlKSB7CiAgICAg\nICAgICAgICAgICAgICAgLy8gTG9nIGEgd2FybmluZywgdGhlIHBlZXIgd2Fz\nIHVwIGFuZCBoYXMgbm93IGdvbmUgZG93bgogICAgICAgICAgICAgICAgICAg\nIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGxvZy53YXJuKHNfbG9jLmdldCgidGNwLXNlbmQtZXJyb3IiLAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FkZHJlc3MuZ2V0SG9zdEFk\nZHJlc3MoKSArICI6IiArIF9wb3J0KSwgZSk7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIF9pc0F2YWlsYWJsZSA9IGZhbHNl\nOwogICAgICAgICAgICAgICAgICAgIC8vIE9uY2UgZW5vdWdoIHRpbWUgaGFz\nIHBhc3NlZCB3ZSB3aWxsIGxvZyBhbm90aGVyIHdhcm5pbmcKICAgICAgICAg\nICAgICAgICAgICBfdGltZUxhc3RFcnJvciA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICBsb25nIG5vdyA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxp\ncygpOwogICAgICAgICAgICAgICAgICAgIGlmIChub3cgLSBfdGltZUxhc3RF\ncnJvciA+IF9yZWNvdmVyeVRpbWVNaWxsaXMpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKF9pbmZvc0lzc3VlZCA8IDUpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIC8vIEVub3VnaCB0aW1lIGhhcyBwYXNzZWQsIGFu\nZCBwZWVyIGlzIHN0aWxsIGRvd24KICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIF90aW1lTGFzdEVycm9yID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlz\nKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHRy\neWluZyB0byByZWVzdGFibGlzaCB0aGUgY29ubmVjdGlvbiwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIGJ1dCB3ZSBmYWlsZWQgYWdhaW4uIExv\nZyBhIG1lc3NhZ2UsIGJ1dAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gbG93ZXIgc2V2ZXJpdHkuIFRoaXMgbG9nIHdpbGwgb2NjdXIgcGVyaW9k\naWNhbGx5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmb3IgNSB0\naW1lcyB1bnRpbCB0aGUgcGVlciBjb21lcyBiYWNrLgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cuaW5mbyhzX2xvYy5n\nZXQoInRjcC1zZW5kLXN0aWxsLWVycm9yIiwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgX2FkZHJlc3MuZ2V0SG9zdEFkZHJlc3MoKSAr\nICI6IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nKyBfcG9ydCksIGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luZm9zSXNzdWVkKys7CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIHByaXZhdGUgU29ja2V0IGdldFNvY2tldCgpCiAgICAgICAgICAg\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4gKFNvY2tl\ndCkgX3NvY2tldFBvb2wuYm9ycm93T2JqZWN0KCk7CiAgICAgICAgfQoKICAg\nICAgICBwcml2YXRlIHZvaWQgcmV0dXJuU29ja2V0KFNvY2tldCBzKQogICAg\nICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgX3NvY2tl\ndFBvb2wucmV0dXJuT2JqZWN0KHMpOwogICAgICAgIH0KCiAgICAgICAgcHJp\ndmF0ZSB2b2lkIGNsZWFyQWxsU29ja2V0cygpIHsKICAgICAgICAgICAgX3Nv\nY2tldFBvb2wuY2xlYXIoKTsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUg\ndm9pZCBjbG9zZVNvY2tldChTb2NrZXQgcykgewogICAgICAgICAgICAvLyBB\nbGwgc29ja2V0cyBjb21lIGZyb20gdGhlIHBvb2wuCiAgICAgICAgICAgIC8v\nIFRoaXMgc29ja2V0IGlzIG5vIGxvbmdlciB1c2FibGUsIHNvIGRlbGV0ZSBp\ndCBmcm9tIHRoZQogICAgICAgICAgICAvLyBwb29sLgogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgX3NvY2tldFBvb2wuaW52YWxpZGF0ZU9i\namVjdChzKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAg\nICogRmFjdG9yeSBmb3IgcG9vbGVkIHNvY2tldHMuCiAgICAgICAgICovCiAg\nICAgICAgcHJpdmF0ZSBjbGFzcyBTb2NrZXRQb29sYWJsZU9iamVjdEZhY3Rv\ncnkKICAgICAgICAgICAgaW1wbGVtZW50cyBQb29sYWJsZU9iamVjdEZhY3Rv\ncnkgewoKICAgICAgICAgICAgcHVibGljIE9iamVjdCBtYWtlT2JqZWN0KCkK\nICAgICAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBTb2NrZXQgcyA9IG5ldyBTb2NrZXQoX2FkZHJlc3MsIF9wb3J0\nKTsKICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkg\newogICAgICAgICAgICAgICAgICAgIGxvZy50cmFjZShzX2xvYy5nZXQoInRj\ncC1vcGVuLWNvbm5lY3Rpb24iLAogICAgICAgICAgICAgICAgICAgICAgICBf\nYWRkcmVzcyArICI6IiArIF9wb3J0LCAiIiArIHMuZ2V0TG9jYWxQb3J0KCkp\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBz\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBkZXN0\ncm95T2JqZWN0KE9iamVjdCBvYmopIHsKICAgICAgICAgICAgICAgIC8vIHNp\nbGVudENsb3NlICgpLgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICBTb2NrZXQgcyA9IChTb2NrZXQpIG9iajsKICAgICAgICAg\nICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIGxvZy50cmFjZShzX2xvYy5nZXQoInRjcC1jbG9z\nZS1zZW5kaW5nLXNvY2tldCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBfYWRkcmVzcyArICI6IiArIF9wb3J0LCAiIiArIHMuZ2V0TG9jYWxQb3J0\nKCkpKTsKICAgICAgICAgICAgICAgICAgICBzLmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgICAgIGxvZy53YXJuKHNfbG9jLmdldCgidGNwLWNsb3NlLXNvY2tldC1l\ncnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNzLmdldEhv\nc3RBZGRyZXNzKCkgKyAiOiIgKyBfcG9ydCksIGUpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVh\nbiB2YWxpZGF0ZU9iamVjdChPYmplY3Qgb2JqKSB7CiAgICAgICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgYWN0aXZhdGVPYmplY3QgKE9iamVjdCB2YWx1ZSkKCQkJewoJ\nCQl9CgoJCQlwdWJsaWMgdm9pZCBwYXNzaXZhdGVPYmplY3QgKE9iamVjdCB2\nYWx1ZSkKCQkJewoJCQl9CgkJfQoJfQp9Cg==\n","encoding":"base64"}

