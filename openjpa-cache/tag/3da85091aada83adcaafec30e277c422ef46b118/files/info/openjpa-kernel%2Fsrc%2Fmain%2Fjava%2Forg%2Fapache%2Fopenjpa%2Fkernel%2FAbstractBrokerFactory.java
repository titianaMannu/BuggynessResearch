{"sha":"c10d35171d5f8c99d4b10765fbecee2147c75a6b","node_id":"MDQ6QmxvYjIwNjM2NDpjMTBkMzUxNzFkNWY4Yzk5ZDRiMTA3NjVmYmVjZWUyMTQ3Yzc1YTZi","size":23687,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c10d35171d5f8c99d4b10765fbecee2147c75a6b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CmltcG9y\ndCBqYXZheC50cmFuc2FjdGlvbi5TdGF0dXM7CmltcG9ydCBqYXZheC50cmFu\nc2FjdGlvbi5TeW5jaHJvbml6YXRpb247CmltcG9ydCBqYXZheC50cmFuc2Fj\ndGlvbi5UcmFuc2FjdGlvbjsKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLlRy\nYW5zYWN0aW9uTWFuYWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMu\nbGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5j\nb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmNvbmYuT3BlbkpQQVZlcnNpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNoZVN0b3JlTWFuYWdlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBDUmVnaXN0cnk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuUmVtb3RlQ29tbWl0RXZl\nbnRNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cu\nTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2Fs\naXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5SZWZl\ncmVuY2VIYXNoU2V0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hNYXA7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50\nUmVmZXJlbmNlSGFzaFNldDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5jb25jdXJyZW50LlJlZW50cmFudExvY2s7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YVJlcG9zaXRvcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5HZW5lcmFsRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW52YWxpZFN0YXRlRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3BlbkpQ\nQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVz\nZXJFeGNlcHRpb247CgovKioKICogQWJzdHJhY3QgaW1wbGVtZW50YXRpb24g\nb2YgdGhlIHtAbGluayBCcm9rZXJGYWN0b3J5fQogKiB0aGF0IG11c3QgYmUg\nc3ViY2xhc3NlZCBmb3IgYSBzcGVjaWZpYyBydW50aW1lLgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3Ry\nYWN0QnJva2VyRmFjdG9yeQogICAgaW1wbGVtZW50cyBCcm9rZXJGYWN0b3J5\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEFic3RyYWN0QnJva2Vy\nRmFjdG9yeS5jbGFzcyk7CgogICAgLy8gc3RhdGljIG1hcHBpbmcgb2YgY29u\nZmlndXJhdGlvbnMgdG8gcG9vbGVkIGJyb2tlciBmYWN0b3JpZXMKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIE1hcCBfcG9vbCA9IENvbGxlY3Rpb25zLnN5\nbmNocm9uaXplZE1hcChuZXcgSGFzaE1hcCgpKTsKCiAgICAvLyBjb25maWd1\ncmF0aW9uCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0aW9u\nIF9jb25mOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcmVhZE9u\nbHkgPSBmYWxzZTsKICAgIHByaXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX2Ns\nb3NlZCA9IGZhbHNlOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgUnVudGltZUV4\nY2VwdGlvbiBfY2xvc2VkRXhjZXB0aW9uID0gbnVsbDsKICAgIHByaXZhdGUg\nTWFwIF91c2VyT2JqZWN0cyA9IG51bGw7CgogICAgLy8gaW50ZXJuYWwgbG9j\nazogc3BlYyBmb3JiaWRzIHN5bmNocm9uaXphdGlvbiBvbiB0aGlzIG9iamVj\ndAogICAgcHJpdmF0ZSBmaW5hbCBSZWVudHJhbnRMb2NrIF9sb2NrID0gbmV3\nIFJlZW50cmFudExvY2soKTsKCiAgICAvLyBtYXBzIGdsb2JhbCB0cmFuc2Fj\ndGlvbnMgdG8gYXNzb2NpYXRlZCBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5z\naWVudCBDb25jdXJyZW50SGFzaE1hcCBfdHJhbnNhY3Rpb25hbAogICAgICAg\nID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwKCk7CgogICAgLy8gd2Vhay1yZWYg\ndHJhY2tpbmcgb2Ygb3BlbiBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBDb2xsZWN0aW9uIF9icm9rZXJzID0gbmV3IENvbmN1cnJlbnRSZWZlcmVu\nY2VIYXNoU2V0CiAgICAgICAgKENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoU2V0\nLldFQUspOwoKICAgIC8vIGNhY2hlIHRoZSBjbGFzcyBuYW1lcyBsb2FkZWQg\nZnJvbSB0aGUgcGVyc2lzdGVudCBjbGFzc2VzIHByb3BlcnR5IHNvCiAgICAv\nLyB0aGF0IHdlIGNhbiByZS1sb2FkIHRoZW0gZm9yIGVhY2ggbmV3IGJyb2tl\ncgogICAgcHJpdmF0ZSB0cmFuc2llbnQgQ29sbGVjdGlvbiBfcGNDbGFzc05h\nbWVzID0gbnVsbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb24g\nX3BjQ2xhc3NMb2FkZXJzID0gbnVsbDsKCiAgICAvLyBsaWZlY3ljbGUgbGlz\ndGVuZXJzIHRvIHBhc3MgdG8gZWFjaCBicm9rZXIKICAgIHByaXZhdGUgdHJh\nbnNpZW50IE1hcCBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbnVsbDsKCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcG9vbGVkIGZhY3RvcnkgbWF0Y2hpbmcg\ndGhlIGdpdmVuIGNvbmZpZ3VyYXRpb24sIG9yIG51bGwKICAgICAqIGlmIG5v\nbmUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQWJzdHJhY3RCcm9rZXJG\nYWN0b3J5IGdldFBvb2xlZEZhY3RvcnkoCiAgICAgICAgT3BlbkpQQUNvbmZp\nZ3VyYXRpb24gY29uZikgewogICAgICAgIHJldHVybiAoQWJzdHJhY3RCcm9r\nZXJGYWN0b3J5KSBfcG9vbC5nZXQodG9Qb29sS2V5KGNvbmYpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiBhbiBpbnRlcm5hbCBmYWN0b3J5IHBv\nb2wga2V5IGZvciB0aGUgZ2l2ZW4gY29uZmlndXJhdGlvbi4KICAgICAqIFdl\nIHVzZSB0aGUgY29uZiBwcm9wZXJ0aWVzIGFzIGdpdmVuIGJ5IHRoZSB1c2Vy\nIGJlY2F1c2UgdGhhdCBpcyB3aGF0J3MKICAgICAqIHBhc3NlZCB0byB7QGxp\nbmsgI2dldFBvb2xlZEZhY3Rvcnl9IHdoZW4gbG9va2luZyBmb3IgYW4gZXhp\nc3RpbmcgZmFjdG9yeS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgTWFw\nIHRvUG9vbEtleShPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAg\nICAgcmV0dXJuIGNvbmYudG9Qcm9wZXJ0aWVzKGZhbHNlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgcG9vbGVkIGZhY3RvcnkgbWF0Y2hp\nbmcgdGhlIGdpdmVuIGNvbmZpZ3VyYXRpb24gZGF0YSwgb3IgbnVsbAogICAg\nICogaWYgbm9uZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBBYnN0\ncmFjdEJyb2tlckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeShNYXAgbWFwKSB7\nCiAgICAgICAgcmV0dXJuIChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9wb29s\nLmdldChtYXApOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3Iu\nIENvbmZpZ3VyYXRpb24gbXVzdCBiZSBwcm92aWRlZCBvbiBjb25zdHJ1Y3Rp\nb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBBYnN0cmFjdEJyb2tlckZhY3Rv\ncnkoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZmlnKSB7CiAgICAgICAgX2Nv\nbmYgPSBjb25maWc7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGNvbmZpZ3VyYXRpb24gZm9yIHRoaXMgZmFjdG9yeS4KICAgICAqLwogICAg\ncHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF9jb25mOwogICAgfQoKICAgIHB1YmxpYyBC\ncm9rZXIgbmV3QnJva2VyKCkgewogICAgICAgIHJldHVybiBuZXdCcm9rZXIo\nX2NvbmYuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCksCiAgICAgICAgICAgIF9j\nb25mLmdldENvbm5lY3Rpb25QYXNzd29yZCgpKTsKICAgIH0KCiAgICBwdWJs\naWMgQnJva2VyIG5ld0Jyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3Mp\nIHsKICAgICAgICByZXR1cm4gbmV3QnJva2VyKHVzZXIsIHBhc3MsIF9jb25m\nLmlzVHJhbnNhY3Rpb25Nb2RlTWFuYWdlZCgpLAogICAgICAgICAgICBfY29u\nZi5nZXRDb25uZWN0aW9uUmV0YWluTW9kZUNvbnN0YW50KCkpOwogICAgfQoK\nICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKGJvb2xlYW4gbWFuYWdlZCwg\naW50IGNvbm5SZXRhaW5Nb2RlKSB7CiAgICAgICAgcmV0dXJuIG5ld0Jyb2tl\ncihfY29uZi5nZXRDb25uZWN0aW9uVXNlck5hbWUoKSwKICAgICAgICAgICAg\nX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3JkKCksIG1hbmFnZWQsIGNvbm5S\nZXRhaW5Nb2RlKTsKICAgIH0KCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jyb2tl\ncihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFuYWdlZCwK\nICAgICAgICBpbnQgY29ublJldGFpbk1vZGUpIHsKICAgICAgICByZXR1cm4g\nbmV3QnJva2VyKHVzZXIsIHBhc3MsIG1hbmFnZWQsIGNvbm5SZXRhaW5Nb2Rl\nLCB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jyb2tlcihT\ndHJpbmcgdXNlciwgU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFuYWdlZCwKICAg\nICAgICBpbnQgY29ublJldGFpbk1vZGUsIGJvb2xlYW4gZmluZEV4aXN0aW5n\nKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwog\nICAgICAgICAgICBtYWtlUmVhZE9ubHkoKTsKCiAgICAgICAgICAgIEJyb2tl\nckltcGwgYnJva2VyID0gbnVsbDsKICAgICAgICAgICAgaWYgKGZpbmRFeGlz\ndGluZykKICAgICAgICAgICAgICAgIGJyb2tlciA9IGZpbmRCcm9rZXIodXNl\nciwgcGFzcywgbWFuYWdlZCk7CiAgICAgICAgICAgIGlmIChicm9rZXIgPT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgLy8gZGVjb3JhdGUgdGhlIHN0b3Jl\nIG1hbmFnZXIgZm9yIGRhdGEgY2FjaGluZyBhbmQgY3VzdG9tCiAgICAgICAg\nICAgICAgICAvLyByZXN1bHQgb2JqZWN0IHByb3ZpZGVyczsgYWx3YXlzIG1h\na2Ugc3VyZSBpdCdzIGEgZGVsZWdhdGluZwogICAgICAgICAgICAgICAgLy8g\nc3RvcmUgbWFuYWdlciwgYmVjYXVzZSBpdCdzIGVhc2llciBmb3IgdXNlcnMg\ndG8gZGVhbCB3aXRoCiAgICAgICAgICAgICAgICAvLyB0aGF0IHdheQogICAg\nICAgICAgICAgICAgU3RvcmVNYW5hZ2VyIHNtID0gbmV3U3RvcmVNYW5hZ2Vy\nKCk7CiAgICAgICAgICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRz\nbSA9IG51bGw7CiAgICAgICAgICAgICAgICBpZiAoX2NvbmYuZ2V0RGF0YUNh\nY2hlTWFuYWdlckluc3RhbmNlKCkuZ2V0U3lzdGVtRGF0YUNhY2hlKCkKICAg\nICAgICAgICAgICAgICAgICAhPSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIGRzbSA9IG5ldyBEYXRhQ2FjaGVTdG9yZU1hbmFnZXIoc20pOwogICAgICAg\nICAgICAgICAgZHNtID0gbmV3IFJPUFN0b3JlTWFuYWdlcigoZHNtID09IG51\nbGwpID8gc20gOiBkc20pOwoKICAgICAgICAgICAgICAgIGJyb2tlciA9IG5l\nd0Jyb2tlckltcGwodXNlciwgcGFzcyk7CiAgICAgICAgICAgICAgICBicm9r\nZXIuaW5pdGlhbGl6ZSh0aGlzLCBkc20sIG1hbmFnZWQsIGNvbm5SZXRhaW5N\nb2RlKTsKICAgICAgICAgICAgICAgIGFkZExpZmVjeWNsZUxpc3RlbmVycyhi\ncm9rZXIpOwoKICAgICAgICAgICAgICAgIC8vIGlmIHdlJ3JlIHVzaW5nIHJl\nbW90ZSBldmVudHMsIHJlZ2lzdGVyIHRoZSBldmVudCBtYW5hZ2VyIHNvCiAg\nICAgICAgICAgICAgICAvLyB0aGF0IGl0IGNhbiBicm9hZGNhc3QgY29tbWl0\nIG5vdGlmaWNhdGlvbnMgZnJvbSB0aGUgYnJva2VyCiAgICAgICAgICAgICAg\nICBSZW1vdGVDb21taXRFdmVudE1hbmFnZXIgcmVtb3RlID0gX2NvbmYuCiAg\nICAgICAgICAgICAgICAgICAgZ2V0UmVtb3RlQ29tbWl0RXZlbnRNYW5hZ2Vy\nKCk7CiAgICAgICAgICAgICAgICBpZiAocmVtb3RlLmFyZVJlbW90ZUV2ZW50\nc0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBicm9rZXIuYWRkVHJh\nbnNhY3Rpb25MaXN0ZW5lcihyZW1vdGUpOwoKICAgICAgICAgICAgICAgIGxv\nYWRQZXJzaXN0ZW50VHlwZXMoYnJva2VyLmdldENsYXNzTG9hZGVyKCkpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIF9icm9rZXJzLmFkZChicm9rZXIp\nOwoKICAgICAgICAgICAgcmV0dXJuIGJyb2tlcjsKICAgICAgICB9IGNhdGNo\nIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IGtl\nOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAg\nICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24ocmUpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBmYWN0b3J5LXJlZ2lz\ndGVyZWQgbGlmZWN5Y2xlIGxpc3RlbmVycyB0byB0aGUgYnJva2VyLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRMaWZlY3ljbGVMaXN0ZW5lcnMo\nQnJva2VySW1wbCBicm9rZXIpIHsKICAgICAgICBpZiAoX2xpZmVjeWNsZUxp\nc3RlbmVycyA9PSBudWxsIHx8IF9saWZlY3ljbGVMaXN0ZW5lcnMuaXNFbXB0\neSgpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIE1hcC5FbnRyeSBl\nbnRyeTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF9saWZlY3ljbGVM\naXN0ZW5lcnMuZW50cnlTZXQoKS5pdGVyYXRvcigpOwogICAgICAgICAgICBp\ndHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50\ncnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGJyb2tlci5hZGRMaWZlY3lj\nbGVMaXN0ZW5lcihlbnRyeS5nZXRLZXkoKSwgKENsYXNzW10pCiAgICAgICAg\nICAgICAgICBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBMb2FkIHRoZSBjb25maWd1cmVkIHBlcnNpc3RlbnQg\nY2xhc3NlcyBsaXN0LiBQZXJmb3JtZWQgYXV0b21hdGljYWxseQogICAgICog\nd2hlbmV2ZXIgYSBicm9rZXIgaXMgY3JlYXRlZC4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIGxvYWRQZXJzaXN0ZW50VHlwZXMoQ2xhc3NMb2FkZXIgZW52\nTG9hZGVyKSB7CiAgICAgICAgLy8gbm8gbGlzdGVkIHBlcnNpc3RlbnQgdHlw\nZXM/CiAgICAgICAgaWYgKF9wY0NsYXNzTmFtZXMgIT0gbnVsbCAmJiBfcGND\nbGFzc05hbWVzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICAvLyBjYWNoZSBwZXJzaXN0ZW50IHR5cGUgbmFtZXMgaWYgbm90IGFs\ncmVhZHkKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBfY29uZi5nZXRD\nbGFzc1Jlc29sdmVySW5zdGFuY2UoKS4KICAgICAgICAgICAgZ2V0Q2xhc3NM\nb2FkZXIoZ2V0Q2xhc3MoKSwgZW52TG9hZGVyKTsKICAgICAgICBpZiAoX3Bj\nQ2xhc3NOYW1lcyA9PSBudWxsKSB7CiAgICAgICAgICAgIENvbGxlY3Rpb24g\nY2xzcyA9IF9jb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCku\nCiAgICAgICAgICAgICAgICBsb2FkUGVyc2lzdGVudFR5cGVzKGZhbHNlLCBs\nb2FkZXIpOwogICAgICAgICAgICBpZiAoY2xzcy5pc0VtcHR5KCkpCiAgICAg\nICAgICAgICAgICBfcGNDbGFzc05hbWVzID0gQ29sbGVjdGlvbnMuRU1QVFlf\nU0VUOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIF9wY0Ns\nYXNzTmFtZXMgPSBuZXcgQXJyYXlMaXN0KGNsc3Muc2l6ZSgpKTsKICAgICAg\nICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gY2xzcy5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgICAgICAgICBfcGNDbGFz\nc05hbWVzLmFkZCgoKENsYXNzKSBpdHIubmV4dCgpKS5nZXROYW1lKCkpOwog\nICAgICAgICAgICAgICAgX3BjQ2xhc3NMb2FkZXJzID0gbmV3IFJlZmVyZW5j\nZUhhc2hTZXQoUmVmZXJlbmNlSGFzaFNldC5XRUFLKTsKICAgICAgICAgICAg\nICAgIF9wY0NsYXNzTG9hZGVycy5hZGQobG9hZGVyKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBy\nZWxvYWQgd2l0aCB0aGlzIGxvYWRlcgogICAgICAgIGlmIChfcGNDbGFzc0xv\nYWRlcnMuYWRkKGxvYWRlcikpIHsKICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSBfcGNDbGFzc05hbWVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0\nKCk7KSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIENsYXNzLmZvck5hbWUoKFN0cmluZykgaXRyLm5leHQoKSwgdHJ1ZSwg\nbG9hZGVyKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbmYuZ2V0TG9nKE9wZW5KUEFD\nb25maWd1cmF0aW9uLkxPR19SVU5USU1FKQogICAgICAgICAgICAgICAgICAg\nICAgICAud2FybihudWxsLCB0KTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRM\naWZlY3ljbGVMaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIsIENsYXNzW10gY2xh\nc3NlcykgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIGlmIChfbGlmZWN5Y2xl\nTGlzdGVuZXJzID09IG51bGwpCiAgICAgICAgICAgICAgICBfbGlmZWN5Y2xl\nTGlzdGVuZXJzID0gbmV3IEhhc2hNYXAoNyk7CiAgICAgICAgICAgIF9saWZl\nY3ljbGVMaXN0ZW5lcnMucHV0KGxpc3RlbmVyLCBjbGFzc2VzKTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlTGlmZWN5Y2xlTGlzdGVu\nZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgbG9jaygpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAg\naWYgKF9saWZlY3ljbGVMaXN0ZW5lcnMgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIF9saWZlY3ljbGVMaXN0ZW5lcnMucmVtb3ZlKGxpc3RlbmVyKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhp\ncyBicm9rZXIgZmFjdG9yeSBpcyBjbG9zZWQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGlzQ2xvc2VkKCkgewogICAgICAgIHJldHVybiBfY2xvc2Vk\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgIGxv\nY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7\nCiAgICAgICAgICAgIGFzc2VydE5vQWN0aXZlVHJhbnNhY3Rpb24oKTsKCiAg\nICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIGZhY3RvcnkgcG9vbAogICAgICAg\nICAgICBNYXAgbWFwID0gdG9Qb29sS2V5KF9jb25mKTsKICAgICAgICAgICAg\nc3luY2hyb25pemVkIChfcG9vbCkgewogICAgICAgICAgICAgICAgaWYgKF9w\nb29sLmdldChtYXApID09IHRoaXMpCiAgICAgICAgICAgICAgICAgICAgX3Bv\nb2wucmVtb3ZlKG1hcCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8v\nIGNsb3NlIGFsbCBicm9rZXJzCiAgICAgICAgICAgIEJyb2tlciBicm9rZXI7\nCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2Jyb2tlcnMuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGJy\nb2tlciA9IChCcm9rZXIpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICAv\nLyBDaGVjayBmb3IgbnVsbCBiZWNhdXNlIF9icm9rZXJzIGNvbnRhaW5zIHdl\nYWsgcmVmZXJlbmNlcwogICAgICAgICAgICAgICAgaWYgKChicm9rZXIgIT0g\nbnVsbCkgJiYgKCFicm9rZXIuaXNDbG9zZWQoKSkpCiAgICAgICAgICAgICAg\nICAgICAgYnJva2VyLmNsb3NlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIC8vIHJlbW92ZSBtZXRhZGF0YSByZXBvc2l0b3J5IGZyb20gbGlzdGVu\nZXIgbGlzdAogICAgICAgICAgICBQQ1JlZ2lzdHJ5LnJlbW92ZVJlZ2lzdGVy\nQ2xhc3NMaXN0ZW5lcgogICAgICAgICAgICAgICAgKF9jb25mLmdldE1ldGFE\nYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkpOwoKICAgICAgICAgICAgX2NvbmYu\nY2xvc2UoKTsKICAgICAgICAgICAgX2Nsb3NlZCA9IHRydWU7CiAgICAgICAg\nICAgIExvZyBsb2cgPSBfY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRp\nb24uTE9HX1JVTlRJTUUpOwogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VF\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICBfY2xvc2VkRXhjZXB0aW9uID0g\nbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFN1YmNsYXNzZXMgc2hvdWxkIG92ZXJyaWRlIHRoaXMg\nbWV0aG9kIHRvIGFkZCBhIDxjb2RlPlBsYXRmb3JtPC9jb2RlPgogICAgICog\ncHJvcGVydHkgbGlzdGluZyB0aGUgcnVudGltZSBwbGF0Zm9ybSwgc3VjaCBh\nczoKICAgICAqIDxjb2RlPk9wZW5KUEEgSkRCQyBFZGl0aW9uOiBPcmFjbGUg\nRGF0YWJhc2U8L2NvZGU+CiAgICAgKi8KICAgIHB1YmxpYyBQcm9wZXJ0aWVz\nIGdldFByb3BlcnRpZXMoKSB7CiAgICAgICAgLy8gcmVxdWlyZWQgcHJvcHMg\nYXJlIFZlbmRvck5hbWUgYW5kIFZlcnNpb25OdW1iZXIKICAgICAgICBQcm9w\nZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9w\ncy5zZXRQcm9wZXJ0eSgiVmVuZG9yTmFtZSIsIE9wZW5KUEFWZXJzaW9uLlZF\nTkRPUl9OQU1FKTsKICAgICAgICBwcm9wcy5zZXRQcm9wZXJ0eSgiVmVyc2lv\nbk51bWJlciIsIE9wZW5KUEFWZXJzaW9uLlZFUlNJT05fTlVNQkVSKTsKICAg\nICAgICBwcm9wcy5zZXRQcm9wZXJ0eSgiVmVyc2lvbklkIiwgT3BlbkpQQVZl\ncnNpb24uVkVSU0lPTl9JRCk7CiAgICAgICAgcmV0dXJuIHByb3BzOwogICAg\nfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0VXNlck9iamVjdChPYmplY3Qga2V5\nKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgcmV0dXJuIChfdXNlck9iamVj\ndHMgPT0gbnVsbCkgPyBudWxsIDogX3VzZXJPYmplY3RzLmdldChrZXkpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHB1dFVzZXJPYmplY3Qo\nT2JqZWN0IGtleSwgT2JqZWN0IHZhbCkgewogICAgICAgIGxvY2soKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAg\nICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiAo\nX3VzZXJPYmplY3RzID09IG51bGwpID8gbnVsbCA6IF91c2VyT2JqZWN0cy5y\nZW1vdmUoa2V5KTsKCiAgICAgICAgICAgIGlmIChfdXNlck9iamVjdHMgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF91c2VyT2JqZWN0cyA9IG5ldyBIYXNo\nTWFwKCk7CiAgICAgICAgICAgIHJldHVybiBfdXNlck9iamVjdHMucHV0KGtl\neSwgdmFsKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxv\nY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jaygp\nIHsKICAgICAgICBfbG9jay5sb2NrKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgdW5sb2NrKCkgewogICAgICAgIF9sb2NrLnVubG9jaygpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmVwbGFjZXMgdGhlIGZhY3Rvcnkgd2l0aCB0aGlz\nIEpWTXMgcG9vbGVkIHZlcnNpb24gaWYgaXQgZXhpc3RzLiBBbHNvCiAgICAg\nKiBmcmVlemVzIHRoZSBmYWN0b3J5LgogICAgICovCiAgICBwcm90ZWN0ZWQg\nT2JqZWN0IHJlYWRSZXNvbHZlKCkKICAgICAgICB0aHJvd3MgT2JqZWN0U3Ry\nZWFtRXhjZXB0aW9uIHsKICAgICAgICBBYnN0cmFjdEJyb2tlckZhY3Rvcnkg\nZmFjdG9yeSA9IGdldFBvb2xlZEZhY3RvcnkoX2NvbmYpOwogICAgICAgIGlm\nIChmYWN0b3J5ICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5\nOwoKICAgICAgICAvLyByZXNldCB0aGVzZSB0cmFuc2llbnQgZmllbGRzIHRv\nIGVtcHR5IHZhbHVlcwogICAgICAgIF90cmFuc2FjdGlvbmFsID0gbmV3IENv\nbmN1cnJlbnRIYXNoTWFwKCk7CiAgICAgICAgX2Jyb2tlcnMgPSBuZXcgQ29u\nY3VycmVudFJlZmVyZW5jZUhhc2hTZXQoCiAgICAgICAgICAgICAgICBDb25j\ndXJyZW50UmVmZXJlbmNlSGFzaFNldC5XRUFLKTsKCiAgICAgICAgbWFrZVJl\nYWRPbmx5KCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNZXRob2RzIGZvciBPdmVy\ncmlkZQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gYSBuZXcgU3RvcmVNYW5hZ2VyIGZvciB0aGlzIHJ1bnRp\nbWUuIE5vdGUgdGhhdCB0aGUgaW5zdGFuY2UKICAgICAqIHJldHVybmVkIGhl\ncmUgbWF5IGJlIHdyYXBwZWQgYmVmb3JlIGJlaW5nIHBhc3NlZCB0byB0aGUK\nICAgICAqIHtAbGluayAjbmV3QnJva2VyfSBtZXRob2QuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBhYnN0cmFjdCBTdG9yZU1hbmFnZXIgbmV3U3RvcmVNYW5h\nZ2VyKCk7CgogICAgLyoqCiAgICAgKiBGaW5kIGEgcG9vbGVkIGJyb2tlciwg\nb3IgcmV0dXJuIG51bGwgaWYgbm9uZS4gSWYgdXNpbmcKICAgICAqIG1hbmFn\nZWQgdHJhbnNhY3Rpb25zLCBsb29rcyBmb3IgYSB0cmFuc2FjdGlvbmFsIGJy\nb2tlcjsKICAgICAqIG90aGVyd2lzZSByZXR1cm5zIG51bGwgYnkgZGVmYXVs\ndC4gVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYmVmb3JlCiAgICAgKiB7\nQGxpbmsgI25ld1N0b3JlTWFuYWdlcn0gc28gdGhhdCBmYWN0b3J5IHN1YmNs\nYXNzZXMgaW1wbGVtZW50aW5nCiAgICAgKiBwb29saW5nIGNhbiByZXR1cm4g\nYSBtYXRjaGluZyBtYW5hZ2VyIGJlZm9yZSBhIG5ldyB7QGxpbmsgU3RvcmVN\nYW5hZ2VyfQogICAgICogaXMgY3JlYXRlZC4KICAgICAqLwogICAgcHJvdGVj\ndGVkIEJyb2tlckltcGwgZmluZEJyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5n\nIHBhc3MsIGJvb2xlYW4gbWFuYWdlZCkgewogICAgICAgIGlmIChtYW5hZ2Vk\nKQogICAgICAgICAgICByZXR1cm4gZmluZFRyYW5zYWN0aW9uYWxCcm9rZXIo\ndXNlciwgcGFzcyk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gYSBicm9rZXIgY29uZmlndXJlZCB3aXRoIHRo\nZSBwcm9wZXIgc2V0dGluZ3MuCiAgICAgKiBCeSBkZWZhdWx0LCB0aGlzIG1l\ndGhvZCBjb25zdHJ1Y3RzIGEgbmV3CiAgICAgKiBCcm9rZXJJbXBsIG9mIHRo\nZSBjbGFzcyBzZXQgZm9yIHRoaXMgZmFjdG9yeS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIEJyb2tlckltcGwgbmV3QnJva2VySW1wbChTdHJpbmcgdXNlciwg\nU3RyaW5nIHBhc3MpIHsKICAgICAgICBCcm9rZXJJbXBsIGJyb2tlciA9IF9j\nb25mLm5ld0Jyb2tlckluc3RhbmNlKHVzZXIsIHBhc3MpOwogICAgICAgIGlm\nIChicm9rZXIgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJF\neGNlcHRpb24oX2xvYy5nZXQoIm5vLWJyb2tlci1jbGFzcyIsCiAgICAgICAg\nICAgICAgICBfY29uZi5nZXRCcm9rZXJJbXBsKCkpKTsKCiAgICAgICAgcmV0\ndXJuIGJyb2tlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRyYW5z\naWVudCBzdGF0ZSB1c2VkIGJ5IHRoaXMgZmFjdG9yeSBiYXNlZCBvbiB0aGUK\nICAgICAqIGN1cnJlbnQgY29uZmlndXJhdGlvbiwgd2hpY2ggd2lsbCBzdWJz\nZXF1ZW50bHkgYmUgbG9ja2VkIGRvd24uIFRoaXMKICAgICAqIG1ldGhvZCB3\naWxsIGJlIGNhbGxlZCBiZWZvcmUgdGhlIGZpcnN0IGJyb2tlciBpcyByZXF1\nZXN0ZWQsCiAgICAgKiBhbmQgd2lsbCBiZSByZS1jYWxsZWQgZWFjaCB0aW1l\nIHRoZSBmYWN0b3J5IGlzIGRlc2VyaWFsaXplZCBpbnRvIGEgSlZNCiAgICAg\nKiB0aGF0IGhhcyBubyBjb25maWd1cmF0aW9uIGZvciB0aGlzIGRhdGEgc3Rv\ncmUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNldHVwKCkgewogICAg\nfQoKICAgIC8vLy8vLy8vLy8vLy8KICAgIC8vIFV0aWxpdGllcwogICAgLy8v\nLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogRmluZCBhIG1hbmFnZWQgcnVu\ndGltZSBicm9rZXIgYXNzb2NpYXRlZCB3aXRoIHRoZQogICAgICogY3VycmVu\ndCB0cmFuc2FjdGlvbiwgb3IgcmV0dXJucyBudWxsIGlmIG5vbmUuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBCcm9rZXJJbXBsIGZpbmRUcmFuc2FjdGlvbmFs\nQnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIFRy\nYW5zYWN0aW9uIHRyYW5zID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAg\nICAgICB0cmFucyA9IF9jb25mLmdldE1hbmFnZWRSdW50aW1lSW5zdGFuY2Uo\nKS5nZXRUcmFuc2FjdGlvbk1hbmFnZXIoKS4KICAgICAgICAgICAgICAgIGdl\ndFRyYW5zYWN0aW9uKCk7CgogICAgICAgICAgICBpZiAodHJhbnMgPT0gbnVs\nbAogICAgICAgICAgICAgICAgfHwgdHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3Rh\ndHVzLlNUQVRVU19OT19UUkFOU0FDVElPTgogICAgICAgICAgICAgICAgfHwg\ndHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRVU19VTktOT1dOKQog\nICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBjYXRjaCAo\nT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsK\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0\naHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihlKTsKICAgICAgICB9CgogICAg\nICAgIENvbGxlY3Rpb24gYnJva2VycyA9IChDb2xsZWN0aW9uKSBfdHJhbnNh\nY3Rpb25hbC5nZXQodHJhbnMpOwogICAgICAgIGlmIChicm9rZXJzICE9IG51\nbGwpIHsKICAgICAgICAgICAgLy8gd2UgZG9uJ3QgbmVlZCB0byBzeW5jaHJv\nbml6ZSBvbiBicm9rZXJzIHNpbmNlIG9uZSBKVEEgdHJhbnNhY3Rpb24KICAg\nICAgICAgICAgLy8gY2FuIG5ldmVyIGJlIGFjdGl2ZSBvbiBtdWx0aXBsZSBj\nb25jdXJyZW50IHRocmVhZHMuCiAgICAgICAgICAgIEJyb2tlckltcGwgYnJv\na2VyOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGJyb2tlcnMu\naXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAg\nIGJyb2tlciA9IChCcm9rZXJJbXBsKSBpdHIubmV4dCgpOwogICAgICAgICAg\nICAgICAgaWYgKFN0cmluZ1V0aWxzLmVxdWFscyhicm9rZXIuZ2V0Q29ubmVj\ndGlvblVzZXJOYW1lKCksCiAgICAgICAgICAgICAgICAgICAgdXNlcikgJiYg\nU3RyaW5nVXRpbHMuZXF1YWxzCiAgICAgICAgICAgICAgICAgICAgKGJyb2tl\nci5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKSwgcGFzcykpCiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIGJyb2tlcjsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbmZpZ3VyZXMgdGhlIGdpdmVuIGJyb2tlciB3aXRoIHRoZSBjdXJyZW50\nIGZhY3Rvcnkgb3B0aW9uIHNldHRpbmdzLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBjb25maWd1cmVCcm9rZXIoQnJva2VySW1wbCBicm9rZXIpIHsK\nICAgICAgICBicm9rZXIuc2V0T3B0aW1pc3RpYyhfY29uZi5nZXRPcHRpbWlz\ndGljKCkpOwogICAgICAgIGJyb2tlci5zZXROb250cmFuc2FjdGlvbmFsUmVh\nZChfY29uZi5nZXROb250cmFuc2FjdGlvbmFsUmVhZCgpKTsKICAgICAgICBi\ncm9rZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKF9jb25mLmdldE5vbnRy\nYW5zYWN0aW9uYWxXcml0ZSgpKTsKICAgICAgICBicm9rZXIuc2V0UmV0YWlu\nU3RhdGUoX2NvbmYuZ2V0UmV0YWluU3RhdGUoKSk7CiAgICAgICAgYnJva2Vy\nLnNldFJlc3RvcmVTdGF0ZShfY29uZi5nZXRSZXN0b3JlU3RhdGVDb25zdGFu\ndCgpKTsKICAgICAgICBicm9rZXIuc2V0QXV0b0NsZWFyKF9jb25mLmdldEF1\ndG9DbGVhckNvbnN0YW50KCkpOwogICAgICAgIGJyb2tlci5zZXRJZ25vcmVD\naGFuZ2VzKF9jb25mLmdldElnbm9yZUNoYW5nZXMoKSk7CiAgICAgICAgYnJv\na2VyLnNldE11bHRpdGhyZWFkZWQoX2NvbmYuZ2V0TXVsdGl0aHJlYWRlZCgp\nKTsKICAgICAgICBicm9rZXIuc2V0QXV0b0RldGFjaChfY29uZi5nZXRBdXRv\nRGV0YWNoQ29uc3RhbnQoKSk7CiAgICAgICAgYnJva2VyLnNldERldGFjaFN0\nYXRlKF9jb25mLmdldERldGFjaFN0YXRlSW5zdGFuY2UoKS4KICAgICAgICAg\nICAgZ2V0RGV0YWNoU3RhdGUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\nZGQgdGhlIGZhY3RvcnkgdG8gdGhlIHBvb2wuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHBvb2woKSB7CiAgICAgICAgc3luY2hyb25pemVkIChfcG9v\nbCkgewogICAgICAgICAgICBfcG9vbC5wdXQodG9Qb29sS2V5KF9jb25mKSwg\ndGhpcyk7CiAgICAgICAgICAgIG1ha2VSZWFkT25seSgpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIEZyZWV6ZXMgdGhlIGNvbmZpZ3VyYXRp\nb24gb2YgdGhpcyBmYWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBt\nYWtlUmVhZE9ubHkoKSB7CiAgICAgICAgaWYgKF9yZWFkT25seSkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgLy8gY2hlY2sgYWdhaW4KICAgICAgICAgICAgaWYgKF9y\nZWFkT25seSkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAg\nX3JlYWRPbmx5ID0gdHJ1ZTsKCiAgICAgICAgICAgIExvZyBsb2cgPSBfY29u\nZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwog\nICAgICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAg\nICAgICAgIGxvZy5pbmZvKGdldEZhY3RvcnlJbml0aWFsaXphdGlvbkJhbm5l\ncigpKTsKICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7\nCiAgICAgICAgICAgICAgICBNYXAgcHJvcHMgPSBfY29uZi50b1Byb3BlcnRp\nZXModHJ1ZSk7CiAgICAgICAgICAgICAgICBTdHJpbmcgbGluZVNlcCA9IFN5\nc3RlbS5nZXRQcm9wZXJ0eSgibGluZS5zZXBhcmF0b3IiKTsKICAgICAgICAg\nICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7\nCiAgICAgICAgICAgICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAgICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHByb3BzLmVudHJ5U2V0KCkuaXRl\ncmF0b3IoKTsKICAgICAgICAgICAgICAgICAgICBpdHIuaGFzTmV4dCgpOykg\newogICAgICAgICAgICAgICAgICAgIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGVudHJ5\nLmdldEtleSgpKS5hcHBlbmQoIjogIikuCiAgICAgICAgICAgICAgICAgICAg\nICAgIGFwcGVuZChlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAg\nICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZChsaW5lU2VwKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgiZmFjdG9yeS1wcm9w\nZXJ0aWVzIiwgYnVmLnRvU3RyaW5nKCkpKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgLy8gc2V0dXAgdHJhbnNpZW50IHN0YXRlCiAgICAgICAgICAg\nIHNldHVwKCk7CgogICAgICAgICAgICAvLyByZWdpc3RlciB0aGUgbWV0ZGF0\nYSByZXBvc2l0b3J5IHRvIGF1dG8tbG9hZCBwZXJzaXN0ZW50IHR5cGVzCiAg\nICAgICAgICAgIC8vIGFuZCBtYWtlIHN1cmUgdHlwZXMgYXJlIGVuaGFuY2Vk\nCiAgICAgICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvcyA9IF9jb25m\nLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICAgICAgICAg\nIHJlcG9zLnNldFZhbGlkYXRlKHJlcG9zLlZBTElEQVRFX1JVTlRJTUUsIHRy\ndWUpOwogICAgICAgICAgICByZXBvcy5zZXRSZXNvbHZlKHJlcG9zLk1PREVf\nTUFQUElOR19JTklULCB0cnVlKTsKICAgICAgICAgICAgUENSZWdpc3RyeS5h\nZGRSZWdpc3RlckNsYXNzTGlzdGVuZXIocmVwb3MpOwoKICAgICAgICAgICAg\nLy8gZnJlZXplIHVuZGVybHlpbmcgY29uZmlndXJhdGlvbiBhbmQgZWFnZXJs\neSBpbml0aWFsaXplIHRvCiAgICAgICAgICAgIC8vIGF2b2lkIHN5bmNocm9u\naXphdGlvbgogICAgICAgICAgICBfY29uZi5zZXRSZWFkT25seSh0cnVlKTsK\nICAgICAgICAgICAgX2NvbmYuaW5zdGFudGlhdGVBbGwoKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gb2JqZWN0IHRvIGJlIHdy\naXR0ZW4gdG8gdGhlIGxvZyB3aGVuIHRoaXMgYnJva2VyIGZhY3RvcnkKICAg\nICAqIGluaXRpYWxpemVzLiBUaGlzIGhhcHBlbnMgYWZ0ZXIgdGhlIGNvbmZp\nZ3VyYXRpb24gaXMgZnVsbHkgbG9hZGVkLgogICAgICovCiAgICBwcm90ZWN0\nZWQgT2JqZWN0IGdldEZhY3RvcnlJbml0aWFsaXphdGlvbkJhbm5lcigpIHsK\nICAgICAgICByZXR1cm4gX2xvYy5nZXQoImZhY3RvcnktaW5pdCIsIE9wZW5K\nUEFWZXJzaW9uLlZFUlNJT05fTlVNQkVSKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRocm93IGFuIGV4Y2VwdGlvbiBpZiB0aGUgZmFjdG9yeSBpcyBjbG9z\nZWQuICBUaGUgZXhhY3QgbWVzc2FnZSBhbmQKICAgICAqIGNvbnRlbnQgb2Yg\ndGhlIGV4Y2VwdGlvbiB2YXJpZXMgd2hldGhlciBUUkFDRSBpcyBlbmFibGVk\nIG9yIG5vdC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydE9wZW4o\nKSB7CiAgICAgICAgaWYgKF9jbG9zZWQpIHsKICAgICAgICAgICAgaWYgKF9j\nbG9zZWRFeGNlcHRpb24gPT0gbnVsbCkgIC8vIFRSQUNFIG5vdCBlbmFibGVk\nCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0\naW9uKF9sb2MKICAgICAgICAgICAgICAgICAgICAgICAgLmdldCgiY2xvc2Vk\nLWZhY3Rvcnktbm90cmFjZSIpKTsKICAgICAgICAgICAgZWxzZQogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9j\nLmdldCgiY2xvc2VkLWZhY3RvcnkiKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgLnNldENhdXNlKF9jbG9zZWRFeGNlcHRpb24pOwogICAgICAgIH0KICAg\nIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQnJva2VyIHV0\naWxpdGllcwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAg\nICAqIFRocm93cyBhIHtAbGluayBVc2VyRXhjZXB0aW9ufSBpZiBhIHRyYW5z\nYWN0aW9uIGlzIGFjdGl2ZS4gVGhlIHRocm93bgogICAgICogZXhjZXB0aW9u\nIHdpbGwgY29udGFpbiBhbGwgdGhlIEJyb2tlcnMgd2l0aCBhY3RpdmUgdHJh\nbnNhY3Rpb25zIGFzCiAgICAgKiBmYWlsZWQgb2JqZWN0cyBpbiB0aGUgbmVz\ndGVkIGV4Y2VwdGlvbnMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhc3Nl\ncnROb0FjdGl2ZVRyYW5zYWN0aW9uKCkgewogICAgICAgIENvbGxlY3Rpb24g\nZXhjcyA9IG51bGw7CiAgICAgICAgaWYgKF90cmFuc2FjdGlvbmFsLmlzRW1w\ndHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBleGNzID0gbmV3\nIEFycmF5TGlzdChfdHJhbnNhY3Rpb25hbC5zaXplKCkpOwogICAgICAgIGZv\nciAoSXRlcmF0b3IgdHJhbnMgPSBfdHJhbnNhY3Rpb25hbC52YWx1ZXMoKS5p\ndGVyYXRvcigpOwogICAgICAgICAgICB0cmFucy5oYXNOZXh0KCk7KSB7CiAg\nICAgICAgICAgIENvbGxlY3Rpb24gYnJva2VycyA9IChDb2xsZWN0aW9uKSB0\ncmFucy5uZXh0KCk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0g\nYnJva2Vycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAg\nICAgICAgICAgZXhjcy5hZGQobmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihf\nbG9jLmdldCgiYWN0aXZlIikpLgogICAgICAgICAgICAgICAgICAgIHNldEZh\naWxlZE9iamVjdChpdHIubmV4dCgpKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIGlmICghZXhjcy5pc0VtcHR5KCkpCiAgICAgICAgICAg\nIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoIm5l\nc3RlZC1leGNlcHMiKSkuCiAgICAgICAgICAgICAgICBzZXROZXN0ZWRUaHJv\nd2FibGVzKChUaHJvd2FibGVbXSkgZXhjcy50b0FycmF5CiAgICAgICAgICAg\nICAgICAgICAgKG5ldyBUaHJvd2FibGVbZXhjcy5zaXplKCldKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTeW5jaHJvbml6ZSB0aGUgZ2l2ZW4gYnJva2Vy\nIHdpdGggYSBtYW5hZ2VkIHRyYW5zYWN0aW9uLAogICAgICogb3B0aW9uYWxs\neSBzdGFydGluZyBvbmUgaWYgbm9uZSBpcyBpbiBwcm9ncmVzcy4KICAgICAq\nCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgc3luY2hlZCB3aXRoIHRyYW5zYWN0\naW9uLCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgYm9vbGVhbiBzeW5j\nV2l0aE1hbmFnZWRUcmFuc2FjdGlvbihCcm9rZXJJbXBsIGJyb2tlciwgYm9v\nbGVhbiBiZWdpbikgewogICAgICAgIFRyYW5zYWN0aW9uIHRyYW5zID0gbnVs\nbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBUcmFuc2FjdGlvbk1hbmFn\nZXIgdG0gPSBicm9rZXIuZ2V0TWFuYWdlZFJ1bnRpbWUoKS4KICAgICAgICAg\nICAgICAgIGdldFRyYW5zYWN0aW9uTWFuYWdlcigpOwogICAgICAgICAgICB0\ncmFucyA9IHRtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAgIGlmICh0\ncmFucyAhPSBudWxsCiAgICAgICAgICAgICAgICAmJiAodHJhbnMuZ2V0U3Rh\ndHVzKCkgPT0gU3RhdHVzLlNUQVRVU19OT19UUkFOU0FDVElPTgogICAgICAg\nICAgICAgICAgfHwgdHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRV\nU19VTktOT1dOKSkKICAgICAgICAgICAgICAgIHRyYW5zID0gbnVsbDsKCiAg\nICAgICAgICAgIGlmICh0cmFucyA9PSBudWxsICYmIGJlZ2luKSB7CiAgICAg\nICAgICAgICAgICB0bS5iZWdpbigpOwogICAgICAgICAgICAgICAgdHJhbnMg\nPSB0bS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgICAgICB9IGVsc2UgaWYg\nKHRyYW5zID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCgogICAgICAgICAgICAvLyBzeW5jaCBicm9rZXIgYW5kIHRyYW5zCiAgICAg\nICAgICAgIHRyYW5zLnJlZ2lzdGVyU3luY2hyb25pemF0aW9uKGJyb2tlcik7\nCgogICAgICAgICAgICAvLyB3ZSBkb24ndCBuZWVkIHRvIHN5bmNocm9uaXpl\nIG9uIGJyb2tlcnMgb3IgZ3VhcmQgYWdhaW5zdCBtdWx0aXBsZQogICAgICAg\nICAgICAvLyB0aHJlYWRzIHVzaW5nIHRoZSBzYW1lIHRyYW5zIHNpbmNlIG9u\nZSBKVEEgdHJhbnNhY3Rpb24gY2FuIG5ldmVyCiAgICAgICAgICAgIC8vIGJl\nIGFjdGl2ZSBvbiBtdWx0aXBsZSBjb25jdXJyZW50IHRocmVhZHMuCiAgICAg\nICAgICAgIENvbGxlY3Rpb24gYnJva2VycyA9IChDb2xsZWN0aW9uKSBfdHJh\nbnNhY3Rpb25hbC5nZXQodHJhbnMpOwogICAgICAgICAgICBpZiAoYnJva2Vy\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBicm9rZXJzID0gbmV3IEFy\ncmF5TGlzdCgyKTsKICAgICAgICAgICAgICAgIF90cmFuc2FjdGlvbmFsLnB1\ndCh0cmFucywgYnJva2Vycyk7CiAgICAgICAgICAgICAgICB0cmFucy5yZWdp\nc3RlclN5bmNocm9uaXphdGlvbihuZXcgUmVtb3ZlVHJhbnNhY3Rpb25TeW5j\nKHRyYW5zKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJva2Vycy5h\nZGQoYnJva2VyKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsK\nICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRp\nb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\ncyBhIHNldCBvZiBhbGwgdGhlIG9wZW4gYnJva2VycyBhc3NvY2lhdGVkIHdp\ndGggdGhpcyBmYWN0b3J5LiBUaGUKICAgICAqIHJldHVybmVkIHNldCBpcyB1\nbm1vZGlmaWFibGUsIGFuZCBtYXkgY29udGFpbiBudWxsIHJlZmVyZW5jZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldE9wZW5Ccm9rZXJz\nKCkgewogICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy51bm1vZGlmaWFibGVD\nb2xsZWN0aW9uKF9icm9rZXJzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNp\nbXBsZSBzeW5jaHJvbml6YXRpb24gbGlzdGVuZXIgdG8gcmVtb3ZlIGNvbXBs\nZXRlZCB0cmFuc2FjdGlvbnMKICAgICAqIGZyb20gb3VyIGNhY2hlLgogICAg\nICovCiAgICBwcml2YXRlIGNsYXNzIFJlbW92ZVRyYW5zYWN0aW9uU3luYwog\nICAgICAgIGltcGxlbWVudHMgU3luY2hyb25pemF0aW9uIHsKCiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBUcmFuc2FjdGlvbiBfdHJhbnM7CgogICAgICAgIHB1\nYmxpYyBSZW1vdmVUcmFuc2FjdGlvblN5bmMoVHJhbnNhY3Rpb24gdHJhbnMp\nIHsKICAgICAgICAgICAgX3RyYW5zID0gdHJhbnM7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCBiZWZvcmVDb21wbGV0aW9uKCkgewogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIHZvaWQgYWZ0ZXJDb21wbGV0aW9uKGludCBz\ndGF0dXMpIHsKICAgICAgICAgICAgX3RyYW5zYWN0aW9uYWwucmVtb3ZlIChf\ndHJhbnMpOwoJCX0KCX0KfQo=\n","encoding":"base64"}

