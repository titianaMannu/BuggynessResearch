{"sha":"825aa75f3f8927dcbe90dd2decf8f1cf7e0df5e1","node_id":"MDQ6QmxvYjIwNjM2NDo4MjVhYTc1ZjNmODkyN2RjYmU5MGRkMmRlY2Y4ZjFjZjdlMGRmNWUx","size":28289,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/825aa75f3f8927dcbe90dd2decf8f1cf7e0df5e1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBvcmcu\nYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxpbmtlZE1hcDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkFi\nc3RyYWN0RXhwcmVzc2lvblZpc2l0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuQWdncmVnYXRlTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQ29uc3RhbnQ7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbkZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMu\nRXhwcmVzc2lvblBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuZXhwcy5GaWx0ZXJMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5Jbk1lbW9yeUV4cHJlc3Npb25GYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGg7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuUXVlcnlF\neHByZXNzaW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5SZXNvbHZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuZXhwcy5TdHJpbmdDb250YWluczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5WYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLmV4cHMuVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLmV4cHMuV2lsZGNhcmRNYXRjaDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIucm9wLkxpc3RSZXN1bHRPYmplY3RQcm92aWRlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJhbmdlUmVzdWx0\nT2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnJvcC5SZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLkltcGxIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5JbnZhbGlkU3RhdGVFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5VbnN1cHBvcnRlZEV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247Cgov\nKioKICogSW1wbGVtZW50YXRpb24gb2YgYW4gZXhwcmVzc2lvbi1iYXNlZCBx\ndWVyeSwgd2hpY2ggY2FuIGhhbmRsZQogKiBTdHJpbmctYmFzZWQgcXVlcnkg\nZXhwcmVzc2lvbnMgc3VjaCBhcyBKUFFMIGFuZCBKRE9RTC4KICogVGhpcyBp\nbXBsZW1lbnRhdGlvbiBpcyBzdWl0YWJsZSBmb3IgaW4tbWVtb3J5IG9wZXJh\ndGlvbi4KICogT3ZlcnJpZGUgdGhlIGZvbGxvd2luZyBtZXRob2RzIHRvIGFs\nc28gc3VwcG9ydCBkYXRhc3RvcmUgb3BlcmF0aW9uOgogKiA8dWw+CiAqIDxs\naT5PdmVycmlkZSB7QGxpbmsgI3N1cHBvcnRzRGF0YVN0b3JlRXhlY3V0aW9u\nfSB0byByZXR1cm4KICogPGNvZGU+dHJ1ZTwvY29kZT4uPC9saT4KICogPGxp\nPk92ZXJyaWRlIHtAbGluayAjZXhlY3V0ZVF1ZXJ5fSwge0BsaW5rICNleGVj\ndXRlRGVsZXRlfSwgYW5kCiAqIHtAbGluayAjZXhlY3V0ZVVwZGF0ZX0gdG8g\nZXhlY3V0ZSB0aGUgcXVlcnkgYWdhaW5zdCB0aGUgZGF0YSBzdG9yZS4KICog\nS2VlcCBpbiBtaW5kIHRoYXQgdGhlIHBhcmFtZXRlcnMgcGFzc2VkIHRvIHRo\naXMgbWV0aG9kIG1pZ2h0IGJlIGluIHVzZQogKiBieSBzZXZlcmFsIHRocmVh\nZHMgaW4gZGlmZmVyZW50IHF1ZXJ5IGluc3RhbmNlcy4gVGh1cyBjb21wb25l\nbnRzIGxpa2UKICogdGhlIGV4cHJlc3Npb24gZmFjdG9yeSBtdXN0IGVpdGhl\nciBiZSB0aHJlYWQgc2FmZSwgb3IgdGhpcyBtZXRob2QgbXVzdAogKiBzeW5j\naHJvbml6ZSBvbiB0aGVtLjwvbGk+CiAqIDxsaT5PdmVycmlkZSB7QGxpbmsg\nI2dldERhdGFTdG9yZUFjdGlvbnN9IHRvIHJldHVybiBhIHJlcHJlc2VudGF0\naW9uIG9mCiAqIHRoZSBhY3Rpb25zIHRoYXQgd2lsbCBiZSB0YWtlbiBvbiB0\naGUgZGF0YSBzdG9yZS4gRm9yIHVzZSBpbiB2aXN1YWwKICogdG9vbHMuPC9s\naT4KICogPGxpPk92ZXJyaWRlIHtAbGluayAjZ2V0RXhwcmVzc2lvbkZhY3Rv\ncnl9IHRvIHJldHVybiBhIGZhY3RvcnkgZm9yIGNyZWF0aW5nCiAqIGV4cHJl\nc3Npb25zIGluIHRoZSBkYXRhc3RvcmUncyBsYW5ndWFnZS4gVGhlIGZhY3Rv\ncnkgbXVzdCBiZSBjYWNoYWJsZS48L2xpPgogKiA8L3VsPgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEV4cHJlc3Npb25TdG9y\nZVF1ZXJ5CiAgICBleHRlbmRzIEFic3RyYWN0U3RvcmVRdWVyeSB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChFeHByZXNzaW9uU3RvcmVRdWVyeS5j\nbGFzcyk7CgogICAgLy8gbWFpbnRhaW4gc3VwcG9ydCBmb3IgYSBjb3VwbGUg\nb2YgZGVwcmVjYXRlZCBleHRlbnNpb25zCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBGaWx0ZXJMaXN0ZW5lcltdIF9saXN0ZW5lcnMgPSBuZXcgRmlsdGVy\nTGlzdGVuZXJbXXsKICAgICAgICBuZXcgU3RyaW5nQ29udGFpbnMoKSwgbmV3\nIFdpbGRjYXJkTWF0Y2goKSwKICAgIH07CgogICAgcHJpdmF0ZSBmaW5hbCBF\neHByZXNzaW9uUGFyc2VyIF9wYXJzZXI7CiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBPYmplY3QgX3BhcnNlZDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBh\nIHF1ZXJ5IHdpdGggYSBwYXJzZXIgZm9yIHRoZSBsYW5ndWFnZS4KICAgICAq\nLwogICAgcHVibGljIEV4cHJlc3Npb25TdG9yZVF1ZXJ5KEV4cHJlc3Npb25Q\nYXJzZXIgcGFyc2VyKSB7CiAgICAgICAgX3BhcnNlciA9IHBhcnNlcjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlc29sdmVyIHVzZWQgaW4gcGFyc2luZy4K\nICAgICAqLwogICAgcHVibGljIFJlc29sdmVyIGdldFJlc29sdmVyKCkgewog\nICAgICAgIHJldHVybiBuZXcgUmVzb2x2ZXIoKSB7CiAgICAgICAgICAgIHB1\nYmxpYyBDbGFzcyBjbGFzc0Zvck5hbWUoU3RyaW5nIG5hbWUsIFN0cmluZ1td\nIGltcG9ydHMpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjdHguY2xhc3NG\nb3JOYW1lKG5hbWUsIGltcG9ydHMpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgRmlsdGVyTGlzdGVuZXIgZ2V0RmlsdGVyTGlzdGVuZXIo\nU3RyaW5nIHRhZykgewogICAgICAgICAgICAgICAgcmV0dXJuIGN0eC5nZXRG\naWx0ZXJMaXN0ZW5lcih0YWcpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgQWdncmVnYXRlTGlzdGVuZXIgZ2V0QWdncmVnYXRlTGlzdGVu\nZXIoU3RyaW5nIHRhZykgewogICAgICAgICAgICAgICAgcmV0dXJuIGN0eC5n\nZXRBZ2dyZWdhdGVMaXN0ZW5lcih0YWcpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmln\ndXJhdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjdHguZ2V0U3Rv\ncmVDb250ZXh0KCkuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgICAgICB9\nCiAgICAgICAgfTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbG93IGRpcmVj\ndCBzZXR0aW5nIG9mIHBhcnNlZCBzdGF0ZSBmb3IgZmFjYWRlcyB0aGF0IGRv\nIHBhcnNpbmcuCiAgICAgKiBUaGUgZmFjYWRlIHNob3VsZCBjYWxsIHRoaXMg\nbWV0aG9kIHR3aWNlOiBvbmNlIHdpdGggdGhlIHF1ZXJ5IHN0cmluZywKICAg\nICAqIGFuZCBhZ2FpbiB3aXRoIHRoZSBwYXJzZWQgc3RhdGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIHNldFF1ZXJ5KE9iamVjdCBxdWVyeSkgewog\nICAgICAgIF9wYXJzZWQgPSBxdWVyeTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgRmlsdGVyTGlzdGVuZXIgZ2V0RmlsdGVyTGlz\ndGVuZXIoU3RyaW5nIHRhZykgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgX2xpc3RlbmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKF9s\naXN0ZW5lcnNbaV0uZ2V0VGFnKCkuZXF1YWxzKHRhZykpCiAgICAgICAgICAg\nICAgICByZXR1cm4gX2xpc3RlbmVyc1tpXTsKICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IG5ld0NvbXBpbGF0aW9uKCkg\newogICAgICAgIGlmIChfcGFyc2VkICE9IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBfcGFyc2VkOwogICAgICAgIHJldHVybiBfcGFyc2VyLnBhcnNlKGN0\neC5nZXRRdWVyeVN0cmluZygpLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBwb3B1bGF0ZUZyb21Db21waWxhdGlvbihPYmplY3QgY29tcCkgewog\nICAgICAgIF9wYXJzZXIucG9wdWxhdGUoY29tcCwgdGhpcyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgaW52YWxpZGF0ZUNvbXBpbGF0aW9uKCkgewogICAg\nICAgIF9wYXJzZWQgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHN1cHBvcnRzSW5NZW1vcnlFeGVjdXRpb24oKSB7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHVibGljIEV4ZWN1dG9yIG5ld0luTWVtb3J5\nRXhlY3V0b3IoQ2xhc3NNZXRhRGF0YSBtZXRhLCBib29sZWFuIHN1YnMpIHsK\nICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5RXhlY3V0b3IodGhpcywgbWV0\nYSwgc3VicywgX3BhcnNlciwKICAgICAgICAgICAgY3R4LmdldENvbXBpbGF0\naW9uKCkpOwogICAgfQoKICAgIHB1YmxpYyBFeGVjdXRvciBuZXdEYXRhU3Rv\ncmVFeGVjdXRvcihDbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xlYW4gc3Vicykg\newogICAgICAgIHJldHVybiBuZXcgRGF0YVN0b3JlRXhlY3V0b3IodGhpcywg\nbWV0YSwgc3VicywgX3BhcnNlciwKICAgICAgICAgICAgY3R4LmdldENvbXBp\nbGF0aW9uKCkpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gTWV0aG9kcyBmb3IgT3ZlcnJpZGUKICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2\nZW4gZXhwcmVzc2lvbiBhZ2FpbnN0IHRoZSBnaXZlbiBjYW5kaWRhdGUgZXh0\nZW50LgogICAgICoKICAgICAqIEBwYXJhbSBleCBjdXJyZW50IGV4ZWN1dG9y\nCiAgICAgKiBAcGFyYW0gYmFzZSB0aGUgYmFzZSB0eXBlIHRoZSBxdWVyeSBz\naG91bGQgbWF0Y2gKICAgICAqIEBwYXJhbSB0eXBlcyB0aGUgaW5kZXBlbmRl\nbnQgY2FuZGlkYXRlIHR5cGVzCiAgICAgKiBAcGFyYW0gc3ViY2xhc3NlcyB0\ncnVlIGlmIHN1YmNsYXNzZXMgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBy\nZXN1bHRzCiAgICAgKiBAcGFyYW0gZmFjdHMgdGhlIGV4cHJlc3Npb24gZmFj\ndG9yeSB1c2VkIHRvIGJ1aWxkIHRoZSBxdWVyeSBmb3IKICAgICAqIGVhY2gg\nYmFzZSB0eXBlCiAgICAgKiBAcGFyYW0gcGFyc2VkIHRoZSBwYXJzZWQgcXVl\ncnkgdmFsdWVzCiAgICAgKiBAcGFyYW0gcGFyYW1zIHBhcmFtZXRlciB2YWx1\nZXMsIG9yIGVtcHR5IGFycmF5CiAgICAgKiBAcGFyYW0gcmFuZ2UgcmVzdWx0\nIHJhbmdlCiAgICAgKiBAcmV0dXJuIGEgcHJvdmlkZXIgZm9yIG1hdGNoaW5n\nIG9iamVjdHMKICAgICAqLwogICAgcHJvdGVjdGVkIFJlc3VsdE9iamVjdFBy\nb3ZpZGVyIGV4ZWN1dGVRdWVyeShFeGVjdXRvciBleCwKICAgICAgICBDbGFz\nc01ldGFEYXRhIGJhc2UsIENsYXNzTWV0YURhdGFbXSB0eXBlcywgYm9vbGVh\nbiBzdWJjbGFzc2VzLAogICAgICAgIEV4cHJlc3Npb25GYWN0b3J5W10gZmFj\ndHMsIFF1ZXJ5RXhwcmVzc2lvbnNbXSBwYXJzZWQsIE9iamVjdFtdIHBhcmFt\ncywKICAgICAgICBSYW5nZSByYW5nZSkgewogICAgICAgIHRocm93IG5ldyBV\nbnN1cHBvcnRlZEV4Y2VwdGlvbigpOwogICAgfQoKICAgIC8qKgogICAgICog\nRXhlY3V0ZSB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiBhZ2FpbnN0IHRoZSBnaXZl\nbiBjYW5kaWRhdGUgZXh0ZW50CiAgICAgKiBhbmQgZGVsZXRlIHRoZSBpbnN0\nYW5jZXMuCiAgICAgKgogICAgICogQHBhcmFtIGV4IGN1cnJlbnQgZXhlY3V0\nb3IKICAgICAqIEBwYXJhbSBiYXNlIHRoZSBiYXNlIHR5cGUgdGhlIHF1ZXJ5\nIHNob3VsZCBtYXRjaAogICAgICogQHBhcmFtIHR5cGVzIHRoZSBpbmRlcGVu\nZGVudCBjYW5kaWRhdGUgdHlwZXMKICAgICAqIEBwYXJhbSBzdWJjbGFzc2Vz\nIHRydWUgaWYgc3ViY2xhc3NlcyBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhl\nIHJlc3VsdHMKICAgICAqIEBwYXJhbSBmYWN0cyB0aGUgZXhwcmVzc2lvbiBm\nYWN0b3J5IHVzZWQgdG8gYnVpbGQgdGhlIHF1ZXJ5IGZvcgogICAgICogZWFj\naCBiYXNlIHR5cGUKICAgICAqIEBwYXJhbSBwYXJzZWQgdGhlIHBhcnNlZCBx\ndWVyeSB2YWx1ZXMKICAgICAqIEBwYXJhbSBwYXJhbXMgcGFyYW1ldGVyIHZh\nbHVlcywgb3IgZW1wdHkgYXJyYXkKICAgICAqIEByZXR1cm4gYSBudW1iZXIg\naW5kaWNhdGluZyB0aGUgbnVtYmVyIG9mIGluc3RhbmNlcyBkZWxldGVkLAog\nICAgICogb3IgbnVsbCB0byBleGVjdXRlIHRoZSBkZWxldGUgaW4gbWVtb3J5\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBOdW1iZXIgZXhlY3V0ZURlbGV0ZShF\neGVjdXRvciBleCwgQ2xhc3NNZXRhRGF0YSBiYXNlLAogICAgICAgIENsYXNz\nTWV0YURhdGFbXSB0eXBlcywgYm9vbGVhbiBzdWJjbGFzc2VzLCBFeHByZXNz\naW9uRmFjdG9yeVtdIGZhY3RzLAogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNb\nXSBwYXJzZWQsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIHJldHVybiBu\ndWxsOwogICAgfQoKICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4g\nZXhwcmVzc2lvbiBhZ2FpbnN0IHRoZSBnaXZlbiBjYW5kaWRhdGUgZXh0ZW50\nCiAgICAgKiBhbmQgdXBkYXRlcyB0aGUgaW5zdGFuY2VzLgogICAgICoKICAg\nICAqIEBwYXJhbSBleCBjdXJyZW50IGV4ZWN1dG9yCiAgICAgKiBAcGFyYW0g\nYmFzZSB0aGUgYmFzZSB0eXBlIHRoZSBxdWVyeSBzaG91bGQgbWF0Y2gKICAg\nICAqIEBwYXJhbSB0eXBlcyB0aGUgaW5kZXBlbmRlbnQgY2FuZGlkYXRlIHR5\ncGVzCiAgICAgKiBAcGFyYW0gc3ViY2xhc3NlcyB0cnVlIGlmIHN1YmNsYXNz\nZXMgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSByZXN1bHRzCiAgICAgKiBA\ncGFyYW0gZmFjdHMgdGhlIGV4cHJlc3Npb24gZmFjdG9yeSB1c2VkIHRvIGJ1\naWxkIHRoZSBxdWVyeSBmb3IKICAgICAqIGVhY2ggYmFzZSB0eXBlCiAgICAg\nKiBAcGFyYW0gcGFyc2VkIHRoZSBwYXJzZWQgcXVlcnkgdmFsdWVzCiAgICAg\nKiBAcGFyYW0gcGFyYW1zIHBhcmFtZXRlciB2YWx1ZXMsIG9yIGVtcHR5IGFy\ncmF5CiAgICAgKiBAcmV0dXJuIGEgbnVtYmVyIGluZGljYXRpbmcgdGhlIG51\nbWJlciBvZiBpbnN0YW5jZXMgdXBkYXRlZCwKICAgICAqIG9yIG51bGwgdG8g\nZXhlY3V0ZSB0aGUgdXBkYXRlIGluIG1lbW9yeS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIE51bWJlciBleGVjdXRlVXBkYXRlKEV4ZWN1dG9yIGV4LCBDbGFz\nc01ldGFEYXRhIGJhc2UsCiAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIHR5cGVz\nLCBib29sZWFuIHN1YmNsYXNzZXMsIEV4cHJlc3Npb25GYWN0b3J5W10gZmFj\ndHMsCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1tdIHBhcnNlZCwgT2JqZWN0\nW10gcGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbW1hbmRzIHRoYXQgd2lsbCBiZSBz\nZW50IHRvIHRoZSBkYXRhc3RvcmUgaW4gb3JkZXIKICAgICAqIHRvIGV4ZWN1\ndGUgdGhlIHF1ZXJ5LCB0eXBpY2FsbHkgaW4gdGhlIGRhdGFiYXNlJ3MgbmF0\naXZlIGxhbmd1YWdlLgogICAgICoKICAgICAqIEBwYXJhbSBleCBjdXJyZW50\nIGV4ZWN1dG9yCiAgICAgKiBAcGFyYW0gYmFzZSB0aGUgYmFzZSB0eXBlIHRo\nZSBxdWVyeSBzaG91bGQgbWF0Y2gKICAgICAqIEBwYXJhbSB0eXBlcyB0aGUg\naW5kZXBlbmRlbnQgY2FuZGlkYXRlIHR5cGVzCiAgICAgKiBAcGFyYW0gc3Vi\nY2xhc3NlcyB0cnVlIGlmIHN1YmNsYXNzZXMgc2hvdWxkIGJlIGluY2x1ZGVk\nIGluIHRoZSByZXN1bHRzCiAgICAgKiBAcGFyYW0gZmFjdHMgdGhlIGV4cHJl\nc3Npb24gZmFjdG9yeSB1c2VkIHRvIGJ1aWxkIHRoZSBxdWVyeSBmb3IKICAg\nICAqIGVhY2ggYmFzZSB0eXBlCiAgICAgKiBAcGFyYW0gcGFyc2VkIHRoZSBw\nYXJzZWQgcXVlcnkgdmFsdWVzCiAgICAgKiBAcGFyYW0gcGFyYW1zIHBhcmFt\nZXRlciB2YWx1ZXMsIG9yIGVtcHR5IGFycmF5CiAgICAgKiBAcGFyYW0gcmFu\nZ2UgcmVzdWx0IHJhbmdlCiAgICAgKiBAcmV0dXJuIGEgdGV4dHVhbCBkZXNj\ncmlwdGlvbiBvZiB0aGUgcXVlcnkgdG8gZXhlY3V0ZQogICAgICovCiAgICBw\ncm90ZWN0ZWQgU3RyaW5nW10gZ2V0RGF0YVN0b3JlQWN0aW9ucyhFeGVjdXRv\nciBleCwgQ2xhc3NNZXRhRGF0YSBiYXNlLAogICAgICAgIENsYXNzTWV0YURh\ndGFbXSB0eXBlcywgYm9vbGVhbiBzdWJjbGFzc2VzLCBFeHByZXNzaW9uRmFj\ndG9yeVtdIGZhY3RzLAogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNbXSBwYXJz\nZWQsIE9iamVjdFtdIHBhcmFtcywgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICBy\nZXR1cm4gU3RvcmVRdWVyeS5FTVBUWV9TVFJJTkdTOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBhc3NpZ25hYmxlIHR5cGVzIGZvciB0aGUg\nZ2l2ZW4gbWV0YWRhdGEgd2hvc2UgZXhwcmVzc2lvbgogICAgICogdHJlZXMg\nbXVzdCBiZSBjb21waWxlZCBpbmRlcGVuZGVudGx5LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgQ2xhc3NNZXRhRGF0YVtdIGdldEluZGVwZW5kZW50RXhwcmVz\nc2lvbkNhbmRpZGF0ZXMKICAgICAgICAoQ2xhc3NNZXRhRGF0YSB0eXBlLCBi\nb29sZWFuIHN1YmNsYXNzZXMpIHsKICAgICAgICByZXR1cm4gbmV3IENsYXNz\nTWV0YURhdGFbXXsgdHlwZSB9OwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIGFuIHtAbGluayBFeHByZXNzaW9uRmFjdG9yeX0gdG8gdXNlIHRvIGNy\nZWF0ZSBhbiBleHByZXNzaW9uIHRvCiAgICAgKiBiZSBleGVjdXRlZCBhZ2Fp\nbnN0IGFuIGV4dGVudC4gRWFjaCBmYWN0b3J5IHdpbGwgYmUgdXNlZCB0byBj\nb21waWxlCiAgICAgKiBvbmUgZmlsdGVyIG9ubHkuIFRoZSBmYWN0b3J5IG11\nc3QgYmUgY2FjaGFibGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBFeHByZXNz\naW9uRmFjdG9yeSBnZXRFeHByZXNzaW9uRmFjdG9yeShDbGFzc01ldGFEYXRh\nIHR5cGUpIHsKICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRp\nb24oKTsKICAgIH0KCiAgICAvKioKICAgICAqIFByb3ZpZGVzIHN1cHBvcnQg\nZm9yIHF1ZXJpZXMgdGhhdCBob2xkIHF1ZXJ5IGluZm9ybWF0aW9uCiAgICAg\nKiBpbiBhIHtAbGluayBRdWVyeUV4cHJlc3Npb25zfSBpbnN0YW5jZS4KICAg\nICAqCiAgICAgKiBAYXV0aG9yIE1hcmMgUHJ1ZCdob21tZWF1eAogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdEV4\ncHJlc3Npb25FeGVjdXRvcgogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RFeGVj\ndXRvcgogICAgICAgIGltcGxlbWVudHMgRXhlY3V0b3IgewoKICAgICAgICAv\nKioKICAgICAgICAgKiBSZXR1cm4gdGhlIHBhcnNlZCBxdWVyeSBleHByZXNz\naW9ucyBmb3Igb3VyIGNhbmRpZGF0ZSB0eXBlcy4KICAgICAgICAgKi8KICAg\nICAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgUXVlcnlFeHByZXNzaW9uc1tdIGdl\ndFF1ZXJ5RXhwcmVzc2lvbnMoKTsKCiAgICAgICAgLyoqCiAgICAgICAgICog\nUmV0dXJuIHRoZSBxdWVyeSBleHByZXNzaW9ucyBmb3Igb25lIGNhbmRpZGF0\nZSB0eXBlLCBvciBkaWUgaWYgbm9uZS4KICAgICAgICAgKi8KICAgICAgICBw\ncml2YXRlIFF1ZXJ5RXhwcmVzc2lvbnMgYXNzZXJ0UXVlcnlFeHByZXNzaW9u\nKCkgewogICAgICAgICAgICBRdWVyeUV4cHJlc3Npb25zW10gZXhwID0gZ2V0\nUXVlcnlFeHByZXNzaW9ucygpOwogICAgICAgICAgICBpZiAoZXhwID09IG51\nbGwgfHwgZXhwLmxlbmd0aCA8IDEpCiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1leHByZXNz\naW9ucyIpKTsKCiAgICAgICAgICAgIHJldHVybiBleHBbMF07CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBUaHJvdyBwcm9wZXIgZXhjZXB0\naW9uIGlmIGdpdmVuIHZhbHVlIGlzIGEgY29sbGVjdGlvbi9tYXAvYXJyYXku\nCiAgICAgICAgICovCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgYXNzZXJ0Tm90\nQ29udGFpbmVyKFZhbHVlIHZhbCwgU3RvcmVRdWVyeSBxKSB7CiAgICAgICAg\nICAgIC8vIHZhcmlhYmxlcyByZXByZXNlbnQgY29udGFpbmVyIGVsZW1lbnRz\nLCBub3QgdGhlIGNvbnRhaW5lciBpdHNlbGYKICAgICAgICAgICAgaWYgKHZh\nbC5pc1ZhcmlhYmxlKCkpCiAgICAgICAgICAgICAgICByZXR1cm47CgogICAg\nICAgICAgICBDbGFzcyB0eXBlOwogICAgICAgICAgICBpZiAodmFsIGluc3Rh\nbmNlb2YgUGF0aCkgewogICAgICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBm\nbWQgPSAoKFBhdGgpIHZhbCkubGFzdCgpOwogICAgICAgICAgICAgICAgdHlw\nZSA9IChmbWQgPT0gbnVsbCkgPyB2YWwuZ2V0VHlwZSgpIDogZm1kLmdldERl\nY2xhcmVkVHlwZSgpOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAg\nICAgIHR5cGUgPSB2YWwuZ2V0VHlwZSgpOwoKICAgICAgICAgICAgc3dpdGNo\nIChKYXZhVHlwZXMuZ2V0VHlwZUNvZGUodHlwZSkpIHsKICAgICAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgiY29udGFpbmVyLXByb2plY3Rpb24i\nLAogICAgICAgICAgICAgICAgICAgICAgICBxLmdldENvbnRleHQoKS5nZXRR\ndWVyeVN0cmluZygpKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBmaW5hbCB2b2lkIHZhbGlkYXRlKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICBRdWVyeUV4cHJlc3Npb25zIGV4cHMgPSBhc3NlcnRR\ndWVyeUV4cHJlc3Npb24oKTsgICAgCiAgICAgICAgICAgIFZhbGlkYXRlR3Jv\ndXBpbmdFeHByZXNzaW9uVmlzaXRvci52YWxpZGF0ZShxLmdldENvbnRleHQo\nKSwgZXhwcyk7IAogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgZ2V0\nUmFuZ2UoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsIFJhbmdlIHJh\nbmdlKSB7CiAgICAgICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcyA9IGFz\nc2VydFF1ZXJ5RXhwcmVzc2lvbigpOwogICAgICAgICAgICBpZiAoZXhwcy5y\nYW5nZS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgIHJldHVybjsKCiAg\nICAgICAgICAgIGlmIChleHBzLnJhbmdlLmxlbmd0aCA9PSAyIAogICAgICAg\nICAgICAgICAgJiYgZXhwcy5yYW5nZVswXSBpbnN0YW5jZW9mIENvbnN0YW50\nCiAgICAgICAgICAgICAgICAmJiBleHBzLnJhbmdlWzFdIGluc3RhbmNlb2Yg\nQ29uc3RhbnQpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgcmFuZ2Uuc3RhcnQgPSAoKE51bWJlcikgKChDb25zdGFudCkg\nZXhwcy5yYW5nZVswXSkuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldFZh\nbHVlKHBhcmFtcykpLmxvbmdWYWx1ZSgpOwogICAgICAgICAgICAgICAgICAg\nIHJhbmdlLmVuZCA9ICgoTnVtYmVyKSAoKENvbnN0YW50KSBleHBzLnJhbmdl\nWzFdKS4KICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VmFsdWUocGFyYW1z\nKSkubG9uZ1ZhbHVlKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgICAgICAgICAgfSBjYXRjaCAoQ2xhc3NDYXN0RXhjZXB0aW9uIGNj\nZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGZhbGwgdGhyb3VnaCB0byBl\neGNlcHRpb24gYmVsb3cKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKE51bGxQ\nb2ludGVyRXhjZXB0aW9uIG5wZSkgewogICAgICAgICAgICAgICAgICAgIC8v\nIGZhbGwgdGhyb3VnaCB0byBleGNlcHRpb24gYmVsb3cKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihfbG9jLmdldCgib25seS1yYW5nZS1jb25zdGFudHMiLAog\nICAgICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0UXVlcnlTdHJpbmco\nKSkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZpbmFsIENsYXNzIGdl\ndFJlc3VsdENsYXNzKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1\ncm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCkucmVzdWx0Q2xhc3M7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgZmluYWwgYm9vbGVhbltdIGdldEFzY2Vu\nZGluZyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGFzc2Vy\ndFF1ZXJ5RXhwcmVzc2lvbigpLmFzY2VuZGluZzsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBmaW5hbCBTdHJpbmcgZ2V0QWxpYXMoU3RvcmVRdWVyeSBx\nKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NlcnRRdWVyeUV4cHJlc3Npb24o\nKS5hbGlhczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5hbCBTdHJp\nbmdbXSBnZXRQcm9qZWN0aW9uQWxpYXNlcyhTdG9yZVF1ZXJ5IHEpIHsKICAg\nICAgICAgICAgcmV0dXJuIGFzc2VydFF1ZXJ5RXhwcmVzc2lvbigpLnByb2pl\nY3Rpb25BbGlhc2VzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZpbmFs\nIGludCBnZXRPcGVyYXRpb24oU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAg\nIHJldHVybiBhc3NlcnRRdWVyeUV4cHJlc3Npb24oKS5vcGVyYXRpb247CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBpc0FnZ3Jl\nZ2F0ZShTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGFzc2Vy\ndFF1ZXJ5RXhwcmVzc2lvbigpLmlzQWdncmVnYXRlKCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBoYXNHcm91cGluZyhTdG9y\nZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGFzc2VydFF1ZXJ5RXhw\ncmVzc2lvbigpLmdyb3VwaW5nLmxlbmd0aCA+IDA7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgZmluYWwgTGlua2VkTWFwIGdldFBhcmFtZXRlclR5cGVz\nKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4gYXNzZXJ0UXVl\ncnlFeHByZXNzaW9uKCkucGFyYW1ldGVyVHlwZXM7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgZmluYWwgTWFwIGdldFVwZGF0ZXMoU3RvcmVRdWVyeSBx\nKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NlcnRRdWVyeUV4cHJlc3Npb24o\nKS51cGRhdGVzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZpbmFsIENs\nYXNzTWV0YURhdGFbXSBnZXRBY2Nlc3NQYXRoTWV0YURhdGFzKFN0b3JlUXVl\ncnkgcSkgewogICAgICAgICAgICBRdWVyeUV4cHJlc3Npb25zW10gZXhwcyA9\nIGdldFF1ZXJ5RXhwcmVzc2lvbnMoKTsKICAgICAgICAgICAgaWYgKGV4cHMu\nbGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICByZXR1cm4gZXhwc1swXS5h\nY2Nlc3NQYXRoOwoKICAgICAgICAgICAgTGlzdCBtZXRhcyA9IG51bGw7CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZXhwcy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgICAgIG1ldGFzID0gRmlsdGVycy5hZGRBY2Nlc3NQ\nYXRoTWV0YURhdGFzKG1ldGFzLAogICAgICAgICAgICAgICAgICAgIGV4cHNb\naV0uYWNjZXNzUGF0aCk7CiAgICAgICAgICAgIGlmIChtZXRhcyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcmV0dXJuIFN0b3JlUXVlcnkuRU1QVFlfTUVU\nQVM7CiAgICAgICAgICAgIHJldHVybiAoQ2xhc3NNZXRhRGF0YVtdKSBtZXRh\ncy50b0FycmF5CiAgICAgICAgICAgICAgICAobmV3IENsYXNzTWV0YURhdGFb\nbWV0YXMuc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBpc1BhY2tpbmcoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIFRocm93cyBhbiBleGNlcHRpb24gaWYgc2VsZWN0IG9yIGhhdmluZyBjbGF1\nc2VzIGNvbnRhaW4gCiAgICAgICAgICogbm9uLWFnZ3JlZ2F0ZSwgbm9uLWdy\nb3VwZWQgcGF0aHMuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBzdGF0\naWMgY2xhc3MgVmFsaWRhdGVHcm91cGluZ0V4cHJlc3Npb25WaXNpdG9yIAog\nICAgICAgICAgICBleHRlbmRzIEFic3RyYWN0RXhwcmVzc2lvblZpc2l0b3Ig\newoKICAgICAgICAgICAgcHJpdmF0ZSBmaW5hbCBRdWVyeUNvbnRleHQgX2N0\neDsKICAgICAgICAgICAgcHJpdmF0ZSBib29sZWFuIF9ncm91cGluZyA9IGZh\nbHNlOwogICAgICAgICAgICBwcml2YXRlIFNldCBfZ3JvdXBlZCA9IG51bGw7\nCiAgICAgICAgICAgIHByaXZhdGUgVmFsdWUgX2FnZyA9IG51bGw7CgogICAg\nICAgICAgICAvKioKICAgICAgICAgICAgICogVGhyb3cgcHJvcGVyIGV4Y2Vw\ndGlvbiBpZiBxdWVyeSBkb2VzIG5vdCBtZWV0IHZhbGlkYXRpb24uCiAgICAg\nICAgICAgICAqLwogICAgICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgdmFs\naWRhdGUoUXVlcnlDb250ZXh0IGN0eCwgCiAgICAgICAgICAgICAgICBRdWVy\neUV4cHJlc3Npb25zIGV4cHMpIHsKICAgICAgICAgICAgICAgIGlmIChleHBz\nLmdyb3VwaW5nLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgICAgICAgICBWYWxpZGF0ZUdyb3VwaW5nRXhwcmVz\nc2lvblZpc2l0b3IgdmlzaXRvciA9IAogICAgICAgICAgICAgICAgICAgIG5l\ndyBWYWxpZGF0ZUdyb3VwaW5nRXhwcmVzc2lvblZpc2l0b3IoY3R4KTsKICAg\nICAgICAgICAgICAgIHZpc2l0b3IuX2dyb3VwaW5nID0gdHJ1ZTsKICAgICAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZXhwcy5ncm91cGluZy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBleHBzLmdyb3VwaW5n\nW2ldLmFjY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgICAgICAgICAgdmlz\naXRvci5fZ3JvdXBpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmIChl\neHBzLmhhdmluZyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGV4cHMu\naGF2aW5nLmFjY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBleHBzLnByb2plY3Rpb25zLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICAgICAgICAgIGV4cHMucHJvamVjdGlvbnNbaV0u\nYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyBWYWxpZGF0ZUdyb3VwaW5nRXhwcmVzc2lvblZpc2l0b3Io\nUXVlcnlDb250ZXh0IGN0eCkgewogICAgICAgICAgICAgICAgX2N0eCA9IGN0\neDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgZW50\nZXIoVmFsdWUgdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoX2dyb3VwaW5n\nKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFBh\ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9ncm91cGVkID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZ3JvdXBlZCA9\nIG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIF9ncm91\ncGVkLmFkZCh2YWwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0gZWxzZSBpZiAoX2FnZyA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHZhbC5pc0FnZ3JlZ2F0ZSgpKSAKICAgICAgICAgICAg\nICAgICAgICAgICAgX2FnZyA9IHZhbDsKICAgICAgICAgICAgICAgICAgICBl\nbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBQYXRoIAogICAgICAgICAgICAgICAg\nICAgICAgICAmJiAoX2dyb3VwZWQgPT0gbnVsbCB8fCAhX2dyb3VwZWQuY29u\ndGFpbnModmFsKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1ncm91cGluZyIsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBfY3R4LmdldENhbmRpZGF0ZVR5\ncGUoKSwgX2N0eC5nZXRRdWVyeVN0cmluZygpKSk7IAogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgZXhpdChWYWx1ZSB2YWwpIHsKICAgICAg\nICAgICAgICAgIGlmICh2YWwgPT0gX2FnZykKICAgICAgICAgICAgICAgICAg\nICBfYWdnID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFJ1bnMgdGhlIGV4cHJlc3Npb24gcXVlcnkgaW4g\nbWVtb3J5LgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBJbk1l\nbW9yeUV4ZWN1dG9yCiAgICAgICAgZXh0ZW5kcyBBYnN0cmFjdEV4cHJlc3Np\nb25FeGVjdXRvcgogICAgICAgIGltcGxlbWVudHMgRXhlY3V0b3IgewoKICAg\nICAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0YURhdGEgX21ldGE7CiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9zdWJzOwogICAgICAgIHByaXZh\ndGUgZmluYWwgSW5NZW1vcnlFeHByZXNzaW9uRmFjdG9yeSBfZmFjdG9yeTsK\nICAgICAgICBwcml2YXRlIGZpbmFsIFF1ZXJ5RXhwcmVzc2lvbnNbXSBfZXhw\nczsKICAgICAgICBwcml2YXRlIGZpbmFsIENsYXNzW10gX3Byb2pUeXBlczsK\nCiAgICAgICAgcHVibGljIEluTWVtb3J5RXhlY3V0b3IoRXhwcmVzc2lvblN0\nb3JlUXVlcnkgcSwKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBjYW5kaWRh\ndGUsIGJvb2xlYW4gc3ViY2xhc3NlcywKICAgICAgICAgICAgRXhwcmVzc2lv\nblBhcnNlciBwYXJzZXIsIE9iamVjdCBwYXJzZWQpIHsKICAgICAgICAgICAg\nX21ldGEgPSBjYW5kaWRhdGU7CiAgICAgICAgICAgIF9zdWJzID0gc3ViY2xh\nc3NlczsKICAgICAgICAgICAgX2ZhY3RvcnkgPSBuZXcgSW5NZW1vcnlFeHBy\nZXNzaW9uRmFjdG9yeSgpOwoKICAgICAgICAgICAgX2V4cHMgPSBuZXcgUXVl\ncnlFeHByZXNzaW9uc1tdIHsKICAgICAgICAgICAgICAgIHBhcnNlci5ldmFs\nKHBhcnNlZCwgcSwgX2ZhY3RvcnksIF9tZXRhKQogICAgICAgICAgICB9Owog\nICAgICAgICAgICBpZiAoX2V4cHNbMF0ucHJvamVjdGlvbnMubGVuZ3RoID09\nIDApCiAgICAgICAgICAgICAgICBfcHJvalR5cGVzID0gU3RvcmVRdWVyeS5F\nTVBUWV9DTEFTU0VTOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAg\nICAgIEFzc2VydE5vVmFyaWFibGVzRXhwcmVzc2lvblZpc2l0b3Igbm92YXJz\nID0gbmV3CiAgICAgICAgICAgICAgICAgICAgQXNzZXJ0Tm9WYXJpYWJsZXNF\neHByZXNzaW9uVmlzaXRvcihxLmdldENvbnRleHQoKSk7CiAgICAgICAgICAg\nICAgICBfcHJvalR5cGVzID0gbmV3IENsYXNzW19leHBzWzBdLnByb2plY3Rp\nb25zLmxlbmd0aF07CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IF9leHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgICAgICAgICAgX3Byb2pUeXBlc1tpXSA9IF9leHBzWzBdLnByb2pl\nY3Rpb25zW2ldLmdldFR5cGUoKTsKICAgICAgICAgICAgICAgICAgICBhc3Nl\ncnROb3RDb250YWluZXIoX2V4cHNbMF0ucHJvamVjdGlvbnNbaV0sIHEpOwog\nICAgICAgICAgICAgICAgICAgIF9leHBzWzBdLnByb2plY3Rpb25zW2ldLmFj\nY2VwdFZpc2l0KG5vdmFycyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9leHBzWzBdLmdyb3VwaW5n\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIF9leHBzWzBdLmdy\nb3VwaW5nW2ldLmFjY2VwdFZpc2l0KG5vdmFycyk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBRdWVyeUV4cHJlc3Npb25z\nW10gZ2V0UXVlcnlFeHByZXNzaW9ucygpIHsKICAgICAgICAgICAgcmV0dXJu\nIF9leHBzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFJlc3VsdE9iamVj\ndFByb3ZpZGVyIGV4ZWN1dGVRdWVyeShTdG9yZVF1ZXJ5IHEsCiAgICAgICAg\nICAgIE9iamVjdFtdIHBhcmFtcywgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAg\nICAgLy8gZXhlY3V0ZSBpbiBtZW1vcnkgZm9yIGNhbmRpZGF0ZSBjb2xsZWN0\naW9uOwogICAgICAgICAgICAvLyBhbHNvIGV4ZWN1dGUgaW4gbWVtb3J5IGZv\nciB0cmFuc2FjdGlvbmFsIGV4dGVudHMKICAgICAgICAgICAgQ29sbGVjdGlv\nbiBjb2xsID0gcS5nZXRDb250ZXh0KCkuZ2V0Q2FuZGlkYXRlQ29sbGVjdGlv\nbigpOwogICAgICAgICAgICBJdGVyYXRvciBpdHI7CiAgICAgICAgICAgIGlm\nIChjb2xsICE9IG51bGwpCiAgICAgICAgICAgICAgICBpdHIgPSBjb2xsLml0\nZXJhdG9yKCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGl0\nciA9IHEuZ2V0Q29udGV4dCgpLmdldFN0b3JlQ29udGV4dCgpLgogICAgICAg\nICAgICAgICAgICAgIGV4dGVudEl0ZXJhdG9yKF9tZXRhLmdldERlc2NyaWJl\nZFR5cGUoKSwgX3N1YnMsCiAgICAgICAgICAgICAgICAgICAgICAgIHEuZ2V0\nQ29udGV4dCgpLmdldEZldGNoQ29uZmlndXJhdGlvbigpLAogICAgICAgICAg\nICAgICAgICAgICAgICBxLmdldENvbnRleHQoKS5nZXRJZ25vcmVDaGFuZ2Vz\nKCkpOwoKICAgICAgICAgICAgLy8gZmluZCBtYXRjaGluZyBvYmplY3RzCiAg\nICAgICAgICAgIExpc3QgcmVzdWx0cyA9IG5ldyBBcnJheUxpc3QoKTsKICAg\nICAgICAgICAgU3RvcmVDb250ZXh0IGN0eCA9IHEuZ2V0Q29udGV4dCgpLmdl\ndFN0b3JlQ29udGV4dCgpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgT2JqZWN0IG9iajsKICAgICAgICAgICAgICAgIHdoaWxlIChpdHIu\naGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAgICAgICAgb2JqID0gaXRyLm5l\neHQoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoX2ZhY3RvcnkubWF0Y2hl\ncyhfZXhwc1swXSwgX21ldGEsIF9zdWJzLCBvYmosIGN0eCwKICAgICAgICAg\nICAgICAgICAgICAgICAgcGFyYW1zKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgcmVzdWx0cy5hZGQob2JqKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nIEltcGxIZWxwZXIuY2xvc2UoaXRyKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgLy8gZ3JvdXAgcmVzdWx0cwogICAgICAgICAgICByZXN1bHRzID0g\nX2ZhY3RvcnkuZ3JvdXAoX2V4cHNbMF0sIHJlc3VsdHMsIGN0eCwgcGFyYW1z\nKTsKCiAgICAgICAgICAgIC8vIGFwcGx5IGhhdmluZyB0byBmaWx0ZXIgZ3Jv\ndXBzCiAgICAgICAgICAgIGlmIChfZXhwc1swXS5oYXZpbmcgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgTGlzdCBtYXRjaGVzID0gbmV3IEFycmF5TGlz\ndChyZXN1bHRzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBDb2xsZWN0aW9u\nIGM7CiAgICAgICAgICAgICAgICBpdHIgPSByZXN1bHRzLml0ZXJhdG9yKCk7\nCiAgICAgICAgICAgICAgICB3aGlsZSAoaXRyLmhhc05leHQoKSkgewogICAg\nICAgICAgICAgICAgICAgIGMgPSAoQ29sbGVjdGlvbikgaXRyLm5leHQoKTsK\nICAgICAgICAgICAgICAgICAgICBpZiAoX2ZhY3RvcnkubWF0Y2hlcyhfZXhw\nc1swXSwgYywgY3R4LCBwYXJhbXMpKQogICAgICAgICAgICAgICAgICAgICAg\nICBtYXRjaGVzLmFkZChjKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIHJlc3VsdHMgPSBtYXRjaGVzOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICAvLyBhcHBseSBwcm9qZWN0aW9ucywgb3JkZXIgcmVzdWx0cywg\nYW5kIGZpbHRlciBkdXBsaWNhdGVzCiAgICAgICAgICAgIHJlc3VsdHMgPSBf\nZmFjdG9yeS5wcm9qZWN0KF9leHBzWzBdLCByZXN1bHRzLCBjdHgsIHBhcmFt\ncyk7CiAgICAgICAgICAgIHJlc3VsdHMgPSBfZmFjdG9yeS5vcmRlcihfZXhw\nc1swXSwgcmVzdWx0cywgY3R4LCBwYXJhbXMpOwogICAgICAgICAgICByZXN1\nbHRzID0gX2ZhY3RvcnkuZGlzdGluY3QoX2V4cHNbMF0sIGNvbGwgPT0gbnVs\nbCwgcmVzdWx0cyk7CgogICAgICAgICAgICBSZXN1bHRPYmplY3RQcm92aWRl\nciByb3AgPSBuZXcgTGlzdFJlc3VsdE9iamVjdFByb3ZpZGVyKHJlc3VsdHMp\nOwogICAgICAgICAgICBpZiAocmFuZ2Uuc3RhcnQgIT0gMCB8fCByYW5nZS5l\nbmQgIT0gTG9uZy5NQVhfVkFMVUUpCiAgICAgICAgICAgICAgICByb3AgPSBu\nZXcgUmFuZ2VSZXN1bHRPYmplY3RQcm92aWRlcihyb3AsIHJhbmdlLnN0YXJ0\nLHJhbmdlLmVuZCk7CiAgICAgICAgICAgIHJldHVybiByb3A7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RGF0YVN0b3JlQWN0aW9u\ncyhTdG9yZVF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcywKICAgICAgICAgICAg\nUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAgICAgLy8gaW4gbWVtb3J5IHF1ZXJp\nZXMgaGF2ZSBubyBkYXRhc3RvcmUgYWN0aW9ucyB0byBwZXJmb3JtCiAgICAg\nICAgICAgIHJldHVybiBTdG9yZVF1ZXJ5LkVNUFRZX1NUUklOR1M7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IGdldE9yZGVyaW5nVmFsdWUo\nU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsCiAgICAgICAgICAgIE9i\namVjdCByZXN1bHRPYmplY3QsIGludCBvcmRlckluZGV4KSB7CiAgICAgICAg\nICAgIC8vIGlmIHRoaXMgaXMgYSBwcm9qZWN0aW9uLCB0aGVuIHdlIGhhdmUg\ndG8gb3JkZXIgb24gc29tZXRoaW5nCiAgICAgICAgICAgIC8vIHdlIHNlbGVj\ndGVkCiAgICAgICAgICAgIGlmIChfZXhwc1swXS5wcm9qZWN0aW9ucy5sZW5n\ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgb3JkZXJpbmcgPSBf\nZXhwc1swXS5vcmRlcmluZ0NsYXVzZXNbb3JkZXJJbmRleF07CiAgICAgICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9leHBzWzBdLnByb2plY3Rp\nb25DbGF1c2VzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIGlm\nIChvcmRlcmluZy5lcXVhbHMoX2V4cHNbMF0ucHJvamVjdGlvbkNsYXVzZXNb\naV0pKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChPYmplY3Rb\nXSkgcmVzdWx0T2JqZWN0KVtpXTsKCiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAg\nICAgICAgICAgKCJtZXJnZWQtb3JkZXItd2l0aC1yZXN1bHQiLCBxLmdldENv\nbnRleHQoKS5nZXRMYW5ndWFnZSgpLAogICAgICAgICAgICAgICAgICAgICAg\nICBxLmdldENvbnRleHQoKS5nZXRRdWVyeVN0cmluZygpLCBvcmRlcmluZykp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyB1c2UgdGhlIHBhcnNl\nZCBvcmRlcmluZyBleHByZXNzaW9uIHRvIGV4dHJhY3QgdGhlIG9yZGVyaW5n\nIHZhbHVlCiAgICAgICAgICAgIFZhbCB2YWwgPSAoVmFsKSBfZXhwc1swXS5v\ncmRlcmluZ1tvcmRlckluZGV4XTsKICAgICAgICAgICAgcmV0dXJuIHZhbC5l\ndmFsdWF0ZShyZXN1bHRPYmplY3QsIHJlc3VsdE9iamVjdCwgcS5nZXRDb250\nZXh0KCkuCiAgICAgICAgICAgICAgICBnZXRTdG9yZUNvbnRleHQoKSwgcGFy\nYW1zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDbGFzc1tdIGdldFBy\nb2plY3Rpb25UeXBlcyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0\ndXJuIF9wcm9qVHlwZXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAg\nICAgKiBUaHJvd3MgYW4gZXhjZXB0aW9uIGlmIGEgdmFyaWFibGUgaXMgZm91\nbmQuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3Mg\nQXNzZXJ0Tm9WYXJpYWJsZXNFeHByZXNzaW9uVmlzaXRvciAKICAgICAgICAg\nICAgZXh0ZW5kcyBBYnN0cmFjdEV4cHJlc3Npb25WaXNpdG9yIHsKCiAgICAg\nICAgICAgIHByaXZhdGUgZmluYWwgUXVlcnlDb250ZXh0IF9jdHg7CgogICAg\nICAgICAgICBwdWJsaWMgQXNzZXJ0Tm9WYXJpYWJsZXNFeHByZXNzaW9uVmlz\naXRvcihRdWVyeUNvbnRleHQgY3R4KSB7CiAgICAgICAgICAgICAgICBfY3R4\nID0gY3R4OwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBlbnRlcihWYWx1ZSB2YWwpIHsKICAgICAgICAgICAgICAgIGlmICghdmFs\nLmlzVmFyaWFibGUoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24o\nX2xvYy5nZXQoImlubWVtLWFnZy1wcm9qLXZhciIsIAogICAgICAgICAgICAg\nICAgICAgIF9jdHguZ2V0Q2FuZGlkYXRlVHlwZSgpLCBfY3R4LmdldFF1ZXJ5\nU3RyaW5nKCkpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBEYXRhU3RvcmVFeGVjdXRvciBleGVjdXRlcyB0\naGUgcXVlcnkgYWdhaW5zdCB0aGUKICAgICAqIGltcGxlbWVudGF0aW9uJ3Mg\nb3ZlcnJpZGRlbiB7QGxpbmsgI2V4ZWN1dGVRdWVyeX0gbWV0aG9kLgogICAg\nICoKICAgICAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIERhdGFTdG9yZUV4ZWN1dG9yCiAg\nICAgICAgZXh0ZW5kcyBBYnN0cmFjdEV4cHJlc3Npb25FeGVjdXRvcgogICAg\nICAgIGltcGxlbWVudHMgRXhlY3V0b3IgewoKICAgICAgICBwcml2YXRlIGZp\nbmFsIENsYXNzTWV0YURhdGEgX21ldGE7CiAgICAgICAgcHJpdmF0ZSBmaW5h\nbCBDbGFzc01ldGFEYXRhW10gX21ldGFzOwogICAgICAgIHByaXZhdGUgZmlu\nYWwgYm9vbGVhbiBfc3ViczsKICAgICAgICBwcml2YXRlIGZpbmFsIEV4cHJl\nc3Npb25QYXJzZXIgX3BhcnNlcjsKICAgICAgICBwcml2YXRlIGZpbmFsIEV4\ncHJlc3Npb25GYWN0b3J5W10gX2ZhY3RzOwogICAgICAgIHByaXZhdGUgZmlu\nYWwgUXVlcnlFeHByZXNzaW9uc1tdIF9leHBzOwogICAgICAgIHByaXZhdGUg\nZmluYWwgQ2xhc3NbXSBfcHJvalR5cGVzOwogICAgICAgIHByaXZhdGUgVmFs\ndWVbXSBfaW5NZW1PcmRlcmluZzsKCiAgICAgICAgcHVibGljIERhdGFTdG9y\nZUV4ZWN1dG9yKEV4cHJlc3Npb25TdG9yZVF1ZXJ5IHEsCiAgICAgICAgICAg\nIENsYXNzTWV0YURhdGEgbWV0YSwgYm9vbGVhbiBzdWJjbGFzc2VzLAogICAg\nICAgICAgICBFeHByZXNzaW9uUGFyc2VyIHBhcnNlciwgT2JqZWN0IHBhcnNl\nZCkgewogICAgICAgICAgICBfbWV0YXMgPSBxLmdldEluZGVwZW5kZW50RXhw\ncmVzc2lvbkNhbmRpZGF0ZXMobWV0YSwgc3ViY2xhc3Nlcyk7CiAgICAgICAg\nICAgIGlmIChfbWV0YXMubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgicXVlcnktdW5tYXBw\nZWQiLCBtZXRhKSk7CiAgICAgICAgICAgIF9tZXRhID0gbWV0YTsKICAgICAg\nICAgICAgX3N1YnMgPSBzdWJjbGFzc2VzOwogICAgICAgICAgICBfcGFyc2Vy\nID0gcGFyc2VyOwoKICAgICAgICAgICAgX2ZhY3RzID0gbmV3IEV4cHJlc3Np\nb25GYWN0b3J5W19tZXRhcy5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9mYWN0cy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgIF9mYWN0c1tpXSA9IHEuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoX21ldGFz\nW2ldKTsKCiAgICAgICAgICAgIF9leHBzID0gbmV3IFF1ZXJ5RXhwcmVzc2lv\nbnNbX21ldGFzLmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgX2V4cHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBfZXhw\nc1tpXSA9IHBhcnNlci5ldmFsKHBhcnNlZCwgcSwgX2ZhY3RzW2ldLCBfbWV0\nYXNbaV0pOwoKICAgICAgICAgICAgaWYgKF9leHBzWzBdLnByb2plY3Rpb25z\nLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgX3Byb2pUeXBlcyA9IFN0\nb3JlUXVlcnkuRU1QVFlfQ0xBU1NFUzsKICAgICAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgICAgICBfcHJvalR5cGVzID0gbmV3IENsYXNzW19leHBzWzBd\nLnByb2plY3Rpb25zLmxlbmd0aF07CiAgICAgICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9leHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0Tm90Q29udGFpbmVyKF9l\neHBzWzBdLnByb2plY3Rpb25zW2ldLCBxKTsKICAgICAgICAgICAgICAgICAg\nICBfcHJvalR5cGVzW2ldID0gX2V4cHNbMF0ucHJvamVjdGlvbnNbaV0uZ2V0\nVHlwZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUXVlcnlFeHByZXNzaW9uc1tdIGdl\ndFF1ZXJ5RXhwcmVzc2lvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBfZXhw\nczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHRPYmplY3RQcm92\naWRlciBleGVjdXRlUXVlcnkoU3RvcmVRdWVyeSBxLAogICAgICAgICAgICBP\nYmplY3RbXSBwYXJhbXMsIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgICAgIHJh\nbmdlLmxycyAmPSAhaXNBZ2dyZWdhdGUocSkgJiYgIWhhc0dyb3VwaW5nKHEp\nOwogICAgICAgICAgICByZXR1cm4gKChFeHByZXNzaW9uU3RvcmVRdWVyeSkg\ncSkuZXhlY3V0ZVF1ZXJ5KHRoaXMsIF9tZXRhLCBfbWV0YXMsCiAgICAgICAg\nICAgICAgICBfc3VicywgX2ZhY3RzLCBfZXhwcywgcGFyYW1zLCByYW5nZSk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgTnVtYmVyIGV4ZWN1dGVEZWxl\ndGUoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICAg\nICAgTnVtYmVyIG51bSA9ICgoRXhwcmVzc2lvblN0b3JlUXVlcnkpIHEpLmV4\nZWN1dGVEZWxldGUodGhpcywgX21ldGEsCiAgICAgICAgICAgICAgICBfbWV0\nYXMsIF9zdWJzLCBfZmFjdHMsIF9leHBzLCBwYXJhbXMpOwogICAgICAgICAg\nICBpZiAobnVtID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gcS5n\nZXRDb250ZXh0KCkuZGVsZXRlSW5NZW1vcnkocSwgdGhpcywgcGFyYW1zKTsK\nICAgICAgICAgICAgcmV0dXJuIG51bTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBOdW1iZXIgZXhlY3V0ZVVwZGF0ZShTdG9yZVF1ZXJ5IHEsIE9iamVj\ndFtdIHBhcmFtcykgewogICAgICAgICAgICBOdW1iZXIgbnVtID0gKChFeHBy\nZXNzaW9uU3RvcmVRdWVyeSkgcSkuZXhlY3V0ZVVwZGF0ZSh0aGlzLCBfbWV0\nYSwKICAgICAgICAgICAgICAgIF9tZXRhcywgX3N1YnMsIF9mYWN0cywgX2V4\ncHMsIHBhcmFtcyk7CiAgICAgICAgICAgIGlmIChudW0gPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHJldHVybiBxLmdldENvbnRleHQoKS51cGRhdGVJbk1l\nbW9yeShxLCB0aGlzLCBwYXJhbXMpOwogICAgICAgICAgICByZXR1cm4gbnVt\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZ1tdIGdldERhdGFT\ndG9yZUFjdGlvbnMoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsCiAg\nICAgICAgICAgIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgICAgIHJldHVybiAo\nKEV4cHJlc3Npb25TdG9yZVF1ZXJ5KSBxKS5nZXREYXRhU3RvcmVBY3Rpb25z\nKHRoaXMsIF9tZXRhLAogICAgICAgICAgICAgICAgX21ldGFzLCBfc3Vicywg\nX2ZhY3RzLCBfZXhwcywgcGFyYW1zLCByYW5nZSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgT2JqZWN0IGdldE9yZGVyaW5nVmFsdWUoU3RvcmVRdWVy\neSBxLCBPYmplY3RbXSBwYXJhbXMsCiAgICAgICAgICAgIE9iamVjdCByZXN1\nbHRPYmplY3QsIGludCBvcmRlckluZGV4KSB7CiAgICAgICAgICAgIC8vIGlm\nIHRoaXMgaXMgYSBwcm9qZWN0aW9uLCB0aGVuIHdlIGhhdmUgdG8gb3JkZXIg\nb24gc29tZXRoaW5nCiAgICAgICAgICAgIC8vIHdlIHNlbGVjdGVkCiAgICAg\nICAgICAgIGlmIChfZXhwc1swXS5wcm9qZWN0aW9ucy5sZW5ndGggPiAwKSB7\nCiAgICAgICAgICAgICAgICBTdHJpbmcgb3JkZXJpbmcgPSBfZXhwc1swXS5v\ncmRlcmluZ0NsYXVzZXNbb3JkZXJJbmRleF07CiAgICAgICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IF9leHBzWzBdLnByb2plY3Rpb25DbGF1c2Vz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIGlmIChvcmRlcmlu\nZy5lcXVhbHMoX2V4cHNbMF0ucHJvamVjdGlvbkNsYXVzZXNbaV0pKQogICAg\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChPYmplY3RbXSkgcmVzdWx0\nT2JqZWN0KVtpXTsKCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxp\nZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAg\nKCJtZXJnZWQtb3JkZXItd2l0aC1yZXN1bHQiLCBxLmdldENvbnRleHQoKS5n\nZXRMYW5ndWFnZSgpLAogICAgICAgICAgICAgICAgICAgICAgICBxLmdldENv\nbnRleHQoKS5nZXRRdWVyeVN0cmluZygpLCBvcmRlcmluZykpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICAvLyBuZWVkIHRvIHBhcnNlIG9yZGVyaW5n\ncz8KICAgICAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAg\nICAgICAgICBpZiAoX2luTWVtT3JkZXJpbmcgPT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgICAgIEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnkgPSBuZXcg\nSW5NZW1vcnlFeHByZXNzaW9uRmFjdG9yeSgpOwogICAgICAgICAgICAgICAg\nICAgIF9pbk1lbU9yZGVyaW5nID0gX3BhcnNlci5ldmFsKF9leHBzWzBdLm9y\nZGVyaW5nQ2xhdXNlcywKICAgICAgICAgICAgICAgICAgICAgICAgKEV4cHJl\nc3Npb25TdG9yZVF1ZXJ5KSBxLCBmYWN0b3J5LCBfbWV0YSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHVzZSB0\naGUgcGFyc2VkIG9yZGVyaW5nIGV4cHJlc3Npb24gdG8gZXh0cmFjdCB0aGUg\nb3JkZXJpbmcgdmFsdWUKICAgICAgICAgICAgVmFsIHZhbCA9IChWYWwpIF9p\nbk1lbU9yZGVyaW5nW29yZGVySW5kZXhdOwogICAgICAgICAgICByZXR1cm4g\ndmFsLmV2YWx1YXRlKHJlc3VsdE9iamVjdCwgcmVzdWx0T2JqZWN0LAogICAg\nICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0U3RvcmVDb250ZXh0KCks\nIHBhcmFtcyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2xhc3NbXSBn\nZXRQcm9qZWN0aW9uVHlwZXMoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAg\nIHJldHVybiBfcHJvalR5cGVzOwoJCX0KCX0KfQo=\n","encoding":"base64"}

