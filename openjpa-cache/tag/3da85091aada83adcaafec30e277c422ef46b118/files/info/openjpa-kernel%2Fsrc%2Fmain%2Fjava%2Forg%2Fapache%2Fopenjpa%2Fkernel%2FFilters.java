{"sha":"a1c593e9f5d3d8c97282062ef775961d21b9156a","node_id":"MDQ6QmxvYjIwNjM2NDphMWM1OTNlOWY1ZDNkOGM5NzI4MjA2MmVmNzc1OTYxZDIxYjkxNTZh","size":30374,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a1c593e9f5d3d8c97282062ef775961d21b9156a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEubGFuZy5yZWZsZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRob2Q7CmltcG9ydCBqYXZhLm1h\ndGguQmlnRGVjaW1hbDsKaW1wb3J0IGphdmEubWF0aC5CaWdJbnRlZ2VyOwpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5D\nYWxlbmRhcjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQg\namF2YS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5SZWZsZWN0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkFnZ3JlZ2F0ZUxp\nc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBz\nLkZpbHRlckxpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nSW50ZXJuYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5Vc2VyRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7\nCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBIZWxwZXIgbWV0\naG9kcyBmb3IgZGVhbGluZyB3aXRoIHF1ZXJ5IGZpbHRlcnMuCiAqCiAqIEBh\ndXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFz\ncyBGaWx0ZXJzIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBCaWdEZWNp\nbWFsIFpFUk9fQklHREVDSU1BTCA9IG5ldyBCaWdEZWNpbWFsKDBEKTsKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIEJpZ0ludGVnZXIgWkVST19CSUdJTlRF\nR0VSID0gbmV3IEJpZ0ludGVnZXIoIjAiKTsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBpbnQgT1BfQUREID0gMDsKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIGludCBPUF9TVUJUUkFDVCA9IDE7CiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBpbnQgT1BfTVVMVElQTFkgPSAyOwogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgaW50IE9QX0RJVklERSA9IDM7CiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBpbnQgT1BfTU9EID0gNDsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKEZpbHRl\ncnMuY2xhc3MpOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb3JyZWN0\nIHdyYXBwZXIgdHlwZSBmb3IgdGhlIGdpdmVuIGNsYXNzLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIENsYXNzIHdyYXAoQ2xhc3MgYykgewogICAgICAg\nIGlmICghYy5pc1ByaW1pdGl2ZSgpKQogICAgICAgICAgICByZXR1cm4gYzsK\nICAgICAgICBpZiAoYyA9PSBpbnQuY2xhc3MpCiAgICAgICAgICAgIHJldHVy\nbiBJbnRlZ2VyLmNsYXNzOwogICAgICAgIGlmIChjID09IGZsb2F0LmNsYXNz\nKQogICAgICAgICAgICByZXR1cm4gRmxvYXQuY2xhc3M7CiAgICAgICAgaWYg\nKGMgPT0gZG91YmxlLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gRG91Ymxl\nLmNsYXNzOwogICAgICAgIGlmIChjID09IGxvbmcuY2xhc3MpCiAgICAgICAg\nICAgIHJldHVybiBMb25nLmNsYXNzOwogICAgICAgIGlmIChjID09IGJvb2xl\nYW4uY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBCb29sZWFuLmNsYXNzOwog\nICAgICAgIGlmIChjID09IHNob3J0LmNsYXNzKQogICAgICAgICAgICByZXR1\ncm4gU2hvcnQuY2xhc3M7CiAgICAgICAgaWYgKGMgPT0gYnl0ZS5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuIEJ5dGUuY2xhc3M7CiAgICAgICAgaWYgKGMg\nPT0gY2hhci5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIENoYXJhY3Rlci5j\nbGFzczsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgY29ycmVjdCBwcmltaXRpdmUgdHlwZSBmb3IgdGhlIGdp\ndmVuIGNsYXNzLCBpZiBpdCBpcyBhCiAgICAgKiB3cmFwcGVyLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIENsYXNzIHVud3JhcChDbGFzcyBjKSB7CiAg\nICAgICAgaWYgKGMuaXNQcmltaXRpdmUoKSB8fCBjID09IFN0cmluZy5jbGFz\ncykKICAgICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgaWYgKGMgPT0gSW50\nZWdlci5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIGludC5jbGFzczsKICAg\nICAgICBpZiAoYyA9PSBGbG9hdC5jbGFzcykKICAgICAgICAgICAgcmV0dXJu\nIGZsb2F0LmNsYXNzOwogICAgICAgIGlmIChjID09IERvdWJsZS5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuIGRvdWJsZS5jbGFzczsKICAgICAgICBpZiAo\nYyA9PSBMb25nLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gbG9uZy5jbGFz\nczsKICAgICAgICBpZiAoYyA9PSBCb29sZWFuLmNsYXNzKQogICAgICAgICAg\nICByZXR1cm4gYm9vbGVhbi5jbGFzczsKICAgICAgICBpZiAoYyA9PSBTaG9y\ndC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIHNob3J0LmNsYXNzOwogICAg\nICAgIGlmIChjID09IEJ5dGUuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBi\neXRlLmNsYXNzOwogICAgICAgIGlmIChjID09IENoYXJhY3Rlci5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuIGNoYXIuY2xhc3M7CiAgICAgICAgcmV0dXJu\nIGM7CiAgICB9CgogICAgLyoqCiAgICAgKiBHaXZlbiB0d28gdHlwZXMsIHJl\ndHVybiB0eXBlIHRoZXkgc2hvdWxkIGJvdGggYmUgY29udmVydGVkCiAgICAg\nKiB0byBiZWZvcmUgcGVyZm9ybWluZyBhbnkgb3BlcmF0aW9ucyBiZXR3ZWVu\nIHRoZW0uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQ2xhc3MgcHJvbW90\nZShDbGFzcyBjMSwgQ2xhc3MgYzIpIHsKICAgICAgICBpZiAoYzEgPT0gYzIp\nCiAgICAgICAgICAgIHJldHVybiB1bndyYXAoYzEpOwogICAgICAgIENsYXNz\nIHcxID0gd3JhcChjMSk7CiAgICAgICAgQ2xhc3MgdzIgPSB3cmFwKGMyKTsK\nICAgICAgICBpZiAodzEgPT0gdzIpCiAgICAgICAgICAgIHJldHVybiB1bndy\nYXAoYzEpOwoKICAgICAgICAvLyBub3QgbnVtYmVycz8KICAgICAgICBib29s\nZWFuIHcxTnVtYmVyID0gTnVtYmVyLmNsYXNzLmlzQXNzaWduYWJsZUZyb20o\ndzEpOwogICAgICAgIGJvb2xlYW4gdzJOdW1iZXIgPSBOdW1iZXIuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbSh3Mik7CiAgICAgICAgaWYgKCF3MU51bWJlciB8\nfCAhdzJOdW1iZXIpIHsKICAgICAgICAgICAgLy8gdGhlIG9ubHkgbm9uLW51\nbWVyaWMgcHJvbW90aW9uIHdlIGRvIGlzIHN0cmluZyB0byBjaGFyLAogICAg\nICAgICAgICAvLyBvciBmcm9tIGNoYXIvc3RyaW5nIHRvIG51bWJlcgogICAg\nICAgICAgICBpZiAoIXcxTnVtYmVyKSB7CiAgICAgICAgICAgICAgICBpZiAo\ndzJOdW1iZXIgJiYgKHcxID09IENoYXJhY3Rlci5jbGFzcyB8fCB3MSA9PSBT\ndHJpbmcuY2xhc3MpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAodzIg\nPT0gQnl0ZS5jbGFzcyB8fCB3MiA9PSBTaG9ydC5jbGFzcykKICAgICAgICAg\nICAgICAgICAgICAgICAgPyBJbnRlZ2VyLmNsYXNzIDogdW53cmFwKGMyKTsK\nICAgICAgICAgICAgICAgIGlmICghdzJOdW1iZXIgJiYgdzEgPT0gQ2hhcmFj\ndGVyLmNsYXNzICYmIHcyID09IFN0cmluZy5jbGFzcykKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gU3RyaW5nLmNsYXNzOwogICAgICAgICAgICAgICAg\naWYgKHcyTnVtYmVyKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB1bndy\nYXAoYzIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdzJOdW1i\nZXIpIHsKICAgICAgICAgICAgICAgIGlmICh3MU51bWJlciAmJiAodzIgPT0g\nQ2hhcmFjdGVyLmNsYXNzIHx8IHcyID09IFN0cmluZy5jbGFzcykpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuICh3MSA9PSBCeXRlLmNsYXNzIHx8IHcx\nID09IFNob3J0LmNsYXNzKQogICAgICAgICAgICAgICAgICAgICAgICA/IElu\ndGVnZXIuY2xhc3MgOiB1bndyYXAoYzEpOwogICAgICAgICAgICAgICAgaWYg\nKCF3MU51bWJlciAmJiB3MiA9PSBDaGFyYWN0ZXIuY2xhc3MgJiYgdzEgPT0g\nU3RyaW5nLmNsYXNzKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJp\nbmcuY2xhc3M7CiAgICAgICAgICAgICAgICBpZiAodzFOdW1iZXIpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHVud3JhcChjMSk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIC8vIGlmIG5laXRoZXIgYXJlIG51bWJlcnMsIHVz\nZSBsZWFzdC1kZXJpdmVkIG9mIHRoZSB0d28uICBpZiBuZWl0aGVyCiAgICAg\nICAgICAgIC8vIGlzIGFzc2lnbmFibGUgZnJvbSB0aGUgb3RoZXIgYnV0IG9u\nZSBpcyBhIHN0YW5kYXJkIHR5cGUsIGFzc3VtZQogICAgICAgICAgICAvLyB0\naGUgb3RoZXIgY2FuIGJlIGNvbnZlcnRlZCB0byB0aGF0IHN0YW5kYXJkIHR5\ncGUKICAgICAgICAgICAgaWYgKCF3MU51bWJlciAmJiAhdzJOdW1iZXIpIHsK\nICAgICAgICAgICAgICAgIGlmICh3MSA9PSBPYmplY3QuY2xhc3MpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIHVud3JhcChjMik7CiAgICAgICAgICAg\nICAgICBpZiAodzIgPT0gT2JqZWN0LmNsYXNzKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiB1bndyYXAoYzEpOwogICAgICAgICAgICAgICAgaWYgKHcx\nLmlzQXNzaWduYWJsZUZyb20odzIpKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiB1bndyYXAoYzEpOwogICAgICAgICAgICAgICAgaWYgKHcyLmlzQXNz\naWduYWJsZUZyb20odzEpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB1\nbndyYXAoYzIpOwogICAgICAgICAgICAgICAgaWYgKGlzTm9uc3RhbmRhcmRU\neXBlKHcxKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGlzTm9uc3Rh\nbmRhcmRUeXBlKHcyKSkgPyBPYmplY3QuY2xhc3MgOiB1bndyYXAoYzIpOwog\nICAgICAgICAgICAgICAgaWYgKGlzTm9uc3RhbmRhcmRUeXBlKHcyKSkKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gKGlzTm9uc3RhbmRhcmRUeXBlKHcx\nKSkgPyBPYmplY3QuY2xhc3MgOiB1bndyYXAoYzEpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIHJldHVybiBPYmplY3QuY2xhc3M7CiAgICAgICAgfQoK\nICAgICAgICBpZiAodzEgPT0gQmlnRGVjaW1hbC5jbGFzcyB8fCB3MiA9PSBC\naWdEZWNpbWFsLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gQmlnRGVjaW1h\nbC5jbGFzczsKICAgICAgICBpZiAodzEgPT0gQmlnSW50ZWdlci5jbGFzcykg\newogICAgICAgICAgICBpZiAodzIgPT0gRmxvYXQuY2xhc3MgfHwgdzIgPT0g\nRG91YmxlLmNsYXNzKQogICAgICAgICAgICAgICAgcmV0dXJuIEJpZ0RlY2lt\nYWwuY2xhc3M7CiAgICAgICAgICAgIHJldHVybiBCaWdJbnRlZ2VyLmNsYXNz\nOwogICAgICAgIH0KICAgICAgICBpZiAodzIgPT0gQmlnSW50ZWdlci5jbGFz\ncykgewogICAgICAgICAgICBpZiAodzEgPT0gRmxvYXQuY2xhc3MgfHwgdzEg\nPT0gRG91YmxlLmNsYXNzKQogICAgICAgICAgICAgICAgcmV0dXJuIEJpZ0Rl\nY2ltYWwuY2xhc3M7CiAgICAgICAgICAgIHJldHVybiBCaWdJbnRlZ2VyLmNs\nYXNzOwogICAgICAgIH0KICAgICAgICBpZiAodzEgPT0gRG91YmxlLmNsYXNz\nIHx8IHcyID09IERvdWJsZS5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIGRv\ndWJsZS5jbGFzczsKICAgICAgICBpZiAodzEgPT0gRmxvYXQuY2xhc3MgfHwg\ndzIgPT0gRmxvYXQuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBmbG9hdC5j\nbGFzczsKICAgICAgICBpZiAodzEgPT0gTG9uZy5jbGFzcyB8fCB3MiA9PSBM\nb25nLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gbG9uZy5jbGFzczsKICAg\nICAgICByZXR1cm4gaW50LmNsYXNzOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVuIHR5cGUgaXMgbm90IGEgc3RhbmRh\ncmQgcGVyc2lzdGVudCB0eXBlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBib29sZWFuIGlzTm9uc3RhbmRhcmRUeXBlKENsYXNzIGMpIHsKICAgICAg\nICBzd2l0Y2ggKEphdmFUeXBlcy5nZXRUeXBlQ29kZShjKSkKICAgICAgICB7\nCiAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICBjYXNlIEphdmFUeXBlcy5N\nQVA6CiAgICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuUENfVU5UWVBFRDoKICAgICAgICBjYXNlIEphdmFUeXBlcy5P\nSUQ6CiAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHdoZXRoZXIgYW4gaW5zdGFuY2Ugb2YgdGhlIGZpcnN0IGNsYXNz\nIGNhbiBiZSBjb252ZXJ0ZWQgdG8KICAgICAqIGFuIGluc3RhbmNlIG9mIHRo\nZSBzZWNvbmQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBj\nYW5Db252ZXJ0KENsYXNzIGMxLCBDbGFzcyBjMiwgYm9vbGVhbiBzdHJpY3Qp\nIHsKICAgICAgICBjMSA9IHdyYXAoYzEpOwogICAgICAgIGMyID0gd3JhcChj\nMik7CiAgICAgICAgaWYgKGMyLmlzQXNzaWduYWJsZUZyb20oYzEpKQogICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgYm9vbGVhbiBjMU51bWJl\nciA9IE51bWJlci5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGMxKTsKICAgICAg\nICBib29sZWFuIGMyTnVtYmVyID0gTnVtYmVyLmNsYXNzLmlzQXNzaWduYWJs\nZUZyb20oYzIpOwogICAgICAgIGlmIChjMU51bWJlciAmJiBjMk51bWJlcikK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKChjMU51bWJl\nciAmJiAoYzIgPT0gQ2hhcmFjdGVyLmNsYXNzCiAgICAgICAgICAgIHx8ICgh\nc3RyaWN0ICYmIGMyID09IFN0cmluZy5jbGFzcykpKQogICAgICAgICAgICB8\nfCAoYzJOdW1iZXIgJiYgKGMxID09IENoYXJhY3Rlci5jbGFzcwogICAgICAg\nICAgICB8fCAoIXN0cmljdCAmJiBjMSA9PSBTdHJpbmcuY2xhc3MpKSkpCiAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmIChjMSA9PSBTdHJp\nbmcuY2xhc3MgJiYgYzIgPT0gQ2hhcmFjdGVyLmNsYXNzKQogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoYzIgPT0gU3RyaW5nLmNsYXNz\nKQogICAgICAgICAgICByZXR1cm4gIXN0cmljdDsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBnaXZl\nbiB2YWx1ZSB0byB0aGUgZ2l2ZW4gdHlwZS4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBPYmplY3QgY29udmVydChPYmplY3QgbywgQ2xhc3MgdHlwZSkg\newogICAgICAgIGlmIChvID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwogICAgICAgIGlmIChvLmdldENsYXNzKCkgPT0gdHlwZSkKICAgICAg\nICAgICAgcmV0dXJuIG87CgogICAgICAgIHR5cGUgPSB3cmFwKHR5cGUpOwog\nICAgICAgIGlmICh0eXBlLmlzQXNzaWduYWJsZUZyb20oby5nZXRDbGFzcygp\nKSkKICAgICAgICAgICAgcmV0dXJuIG87CgogICAgICAgIC8vIHRoZSBvbmx5\nIG5vbi1udW1lcmljIGNvbnZlcnNpb25zIHdlIGRvIGFyZSB0byBzdHJpbmcs\nIG9yIGZyb20KICAgICAgICAvLyBzdHJpbmcvY2hhciB0byBudW1iZXIsIG9y\nIGNhbGVuZGFyL2RhdGUKICAgICAgICBib29sZWFuIG51bSA9IG8gaW5zdGFu\nY2VvZiBOdW1iZXI7CiAgICAgICAgaWYgKCFudW0pIHsKICAgICAgICAgICAg\naWYgKHR5cGUgPT0gU3RyaW5nLmNsYXNzKQogICAgICAgICAgICAgICAgcmV0\ndXJuIG8udG9TdHJpbmcoKTsKICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9\nPSBDaGFyYWN0ZXIuY2xhc3MpIHsKICAgICAgICAgICAgICAgIFN0cmluZyBz\ndHIgPSBvLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICBpZiAoc3RyICE9\nIG51bGwgJiYgc3RyLmxlbmd0aCgpID09IDEpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG5ldyBDaGFyYWN0ZXIoc3RyLmNoYXJBdCgwKSk7CiAgICAg\nICAgICAgIH0gZWxzZSBpZiAoQ2FsZW5kYXIuY2xhc3MuaXNBc3NpZ25hYmxl\nRnJvbSh0eXBlKSAmJgogICAgICAgICAgICAgICAgbyBpbnN0YW5jZW9mIERh\ndGUpIHsKICAgICAgICAgICAgICAgIENhbGVuZGFyIGNhbCA9IENhbGVuZGFy\nLmdldEluc3RhbmNlKCk7CiAgICAgICAgICAgICAgICBjYWwuc2V0VGltZSgo\nRGF0ZSkgbyk7CiAgICAgICAgICAgICAgICByZXR1cm4gY2FsOwogICAgICAg\nICAgICB9IGVsc2UgaWYgKERhdGUuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0\neXBlKSAmJgogICAgICAgICAgICAgICAgbyBpbnN0YW5jZW9mIENhbGVuZGFy\nKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKChDYWxlbmRhcikgbykuZ2V0\nVGltZSgpOwogICAgICAgICAgICB9IGVsc2UgaWYgKE51bWJlci5jbGFzcy5p\nc0Fzc2lnbmFibGVGcm9tKHR5cGUpKSB7CiAgICAgICAgICAgICAgICBJbnRl\nZ2VyIGkgPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKG8gaW5zdGFuY2Vv\nZiBDaGFyYWN0ZXIpCiAgICAgICAgICAgICAgICAgICAgaSA9IE51bWJlcnMu\ndmFsdWVPZigoKENoYXJhY3RlcikgbykuY2hhclZhbHVlKCkpOwogICAgICAg\nICAgICAgICAgZWxzZSBpZiAobyBpbnN0YW5jZW9mIFN0cmluZyAmJiAoKFN0\ncmluZykgbykubGVuZ3RoKCkgPT0gMSkKICAgICAgICAgICAgICAgICAgICBp\nID0gTnVtYmVycy52YWx1ZU9mKCgoU3RyaW5nKSBvKS5jaGFyQXQoMCkpOwoK\nICAgICAgICAgICAgICAgIGlmIChpICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAodHlwZSA9PSBJbnRlZ2VyLmNsYXNzKQogICAgICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICAgICAgICAgICAgICBu\ndW0gPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIGlmICghbnVtKQogICAgICAgICAgICB0aHJvdyBu\nZXcgQ2xhc3NDYXN0RXhjZXB0aW9uKF9sb2MuZ2V0KCJjYW50LWNvbnZlcnQi\nLCBvLAogICAgICAgICAgICAgICAgby5nZXRDbGFzcygpLCB0eXBlKS5nZXRN\nZXNzYWdlKCkpOwoKICAgICAgICBpZiAodHlwZSA9PSBJbnRlZ2VyLmNsYXNz\nKSB7CiAgICAgICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YoKChOdW1i\nZXIpIG8pLmludFZhbHVlKCkpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9\nPSBGbG9hdC5jbGFzcykgewogICAgICAgICAgICByZXR1cm4gbmV3IEZsb2F0\nKCgoTnVtYmVyKSBvKS5mbG9hdFZhbHVlKCkpOwogICAgICAgIH0gZWxzZSBp\nZiAodHlwZSA9PSBEb3VibGUuY2xhc3MpIHsKICAgICAgICAgICAgcmV0dXJu\nIG5ldyBEb3VibGUoKChOdW1iZXIpIG8pLmRvdWJsZVZhbHVlKCkpOwogICAg\nICAgIH0gZWxzZSBpZiAodHlwZSA9PSBMb25nLmNsYXNzKSB7CiAgICAgICAg\nICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YoKChOdW1iZXIpIG8pLmxvbmdW\nYWx1ZSgpKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gQmlnRGVjaW1h\nbC5jbGFzcykgewogICAgICAgICAgICAvLyB0aGUgQmlnRGVjaW1hbCBjb25z\ndHJ1Y3RvciBkb2Vzbid0IGhhbmRsZSB0aGUKICAgICAgICAgICAgLy8gIk5h\nTiIgc3RyaW5nIHZlcnNpb24gb2YgRG91YmxlLk5hTiBhbmQgRmxvYXQuTmFO\nLCBub3IKICAgICAgICAgICAgLy8gZG9lcyBpdCBoYW5kbGUgaW5maW5pdHk7\nIHdlIG5lZWQgdG8gaW5zdGVhZCB1c2UgdGhlIERvdWJsZQogICAgICAgICAg\nICAvLyBhbmQgRmxvYXQgdmVyc2lvbnMsIGRlc3BpdGUgd2FudGluZyB0byBj\nYXN0IGl0IHRvIEJpZ0RlY2ltYWwKICAgICAgICAgICAgZG91YmxlIGR2YWwg\nPSAoKE51bWJlcikgbykuZG91YmxlVmFsdWUoKTsKICAgICAgICAgICAgaWYg\nKERvdWJsZS5pc05hTihkdmFsKSB8fCBEb3VibGUuaXNJbmZpbml0ZShkdmFs\nKSkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG91YmxlKGR2YWwpOwoK\nICAgICAgICAgICAgZmxvYXQgZnZhbCA9ICgoTnVtYmVyKSBvKS5mbG9hdFZh\nbHVlKCk7CiAgICAgICAgICAgIGlmIChGbG9hdC5pc05hTihmdmFsKSB8fCBG\nbG9hdC5pc0luZmluaXRlKGZ2YWwpKQogICAgICAgICAgICAgICAgcmV0dXJu\nIG5ldyBGbG9hdChmdmFsKTsKCiAgICAgICAgICAgIHJldHVybiBuZXcgQmln\nRGVjaW1hbChvLnRvU3RyaW5nKCkpOwogICAgICAgIH0gZWxzZSBpZiAodHlw\nZSA9PSBCaWdJbnRlZ2VyLmNsYXNzKSB7CiAgICAgICAgICAgIHJldHVybiBu\nZXcgQmlnSW50ZWdlcihvLnRvU3RyaW5nKCkpOwogICAgICAgIH0gZWxzZSBp\nZiAodHlwZSA9PSBTaG9ydC5jbGFzcykgewogICAgICAgICAgICByZXR1cm4g\nbmV3IFNob3J0KCgoTnVtYmVyKSBvKS5zaG9ydFZhbHVlKCkpOwogICAgICAg\nIH0gZWxzZSBpZiAodHlwZSA9PSBCeXRlLmNsYXNzKSB7CiAgICAgICAgICAg\nIHJldHVybiBuZXcgQnl0ZSgoKE51bWJlcikgbykuYnl0ZVZhbHVlKCkpOwog\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBOdW1iZXJzLnZh\nbHVlT2YoKChOdW1iZXIpIG8pLmludFZhbHVlKCkpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gdmFsdWVzLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCBhZGQoT2JqZWN0IG8xLCBD\nbGFzcyBjMSwgT2JqZWN0IG8yLCBDbGFzcyBjMikgewogICAgICAgIHJldHVy\nbiBvcChvMSwgYzEsIG8yLCBjMiwgT1BfQUREKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFN1YnRyYWN0IHRoZSBnaXZlbiB2YWx1ZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgT2JqZWN0IHN1YnRyYWN0KE9iamVjdCBvMSwgQ2xh\nc3MgYzEsIE9iamVjdCBvMiwgQ2xhc3MgYzIpIHsKICAgICAgICByZXR1cm4g\nb3AobzEsIGMxLCBvMiwgYzIsIE9QX1NVQlRSQUNUKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIE11bHRpcGx5IHRoZSBnaXZlbiB2YWx1ZXMuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IG11bHRpcGx5KE9iamVjdCBvMSwg\nQ2xhc3MgYzEsIE9iamVjdCBvMiwgQ2xhc3MgYzIpIHsKICAgICAgICByZXR1\ncm4gb3AobzEsIGMxLCBvMiwgYzIsIE9QX01VTFRJUExZKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIERpdmlkZSB0aGUgZ2l2ZW4gdmFsdWVzLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCBkaXZpZGUoT2JqZWN0IG8xLCBD\nbGFzcyBjMSwgT2JqZWN0IG8yLCBDbGFzcyBjMikgewogICAgICAgIHJldHVy\nbiBvcChvMSwgYzEsIG8yLCBjMiwgT1BfRElWSURFKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIE1vZCB0aGUgZ2l2ZW4gdmFsdWVzLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIE9iamVjdCBtb2QoT2JqZWN0IG8xLCBDbGFzcyBjMSwg\nT2JqZWN0IG8yLCBDbGFzcyBjMikgewogICAgICAgIHJldHVybiBvcChvMSwg\nYzEsIG8yLCBjMiwgT1BfTU9EKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBl\ncmZvcm0gdGhlIGdpdmVuIG9wZXJhdGlvbiBvbiB0d28gbnVtYmVycy4KICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgT2JqZWN0IG9wKE9iamVjdCBvMSwg\nQ2xhc3MgYzEsIE9iamVjdCBvMiwgQ2xhc3MgYzIsIGludCBvcCkgewogICAg\nICAgIENsYXNzIHByb21vdGUgPSBwcm9tb3RlKGMxLCBjMik7CiAgICAgICAg\naWYgKHByb21vdGUgPT0gaW50LmNsYXNzKSB7CiAgICAgICAgICAgIGludCBu\nMSA9IChvMSA9PSBudWxsKSA/IDAgOiAoKE51bWJlcikgbzEpLmludFZhbHVl\nKCk7CiAgICAgICAgICAgIGludCBuMiA9IChvMiA9PSBudWxsKSA/IDAgOiAo\nKE51bWJlcikgbzIpLmludFZhbHVlKCk7CiAgICAgICAgICAgIHJldHVybiBv\ncChuMSwgbjIsIG9wKTsKICAgICAgICB9CiAgICAgICAgaWYgKHByb21vdGUg\nPT0gZmxvYXQuY2xhc3MpIHsKICAgICAgICAgICAgZmxvYXQgbjEgPSAobzEg\nPT0gbnVsbCkgPyAwRiA6ICgoTnVtYmVyKSBvMSkuZmxvYXRWYWx1ZSgpOwog\nICAgICAgICAgICBmbG9hdCBuMiA9IChvMiA9PSBudWxsKSA/IDBGIDogKChO\ndW1iZXIpIG8yKS5mbG9hdFZhbHVlKCk7CiAgICAgICAgICAgIHJldHVybiBv\ncChuMSwgbjIsIG9wKTsKICAgICAgICB9CiAgICAgICAgaWYgKHByb21vdGUg\nPT0gZG91YmxlLmNsYXNzKSB7CiAgICAgICAgICAgIGRvdWJsZSBuMSA9IChv\nMSA9PSBudWxsKSA/IDBEIDogKChOdW1iZXIpIG8xKS5kb3VibGVWYWx1ZSgp\nOwogICAgICAgICAgICBkb3VibGUgbjIgPSAobzIgPT0gbnVsbCkgPyAwRCA6\nICgoTnVtYmVyKSBvMikuZG91YmxlVmFsdWUoKTsKICAgICAgICAgICAgcmV0\ndXJuIG9wKG4xLCBuMiwgb3ApOwogICAgICAgIH0KICAgICAgICBpZiAocHJv\nbW90ZSA9PSBsb25nLmNsYXNzKSB7CiAgICAgICAgICAgIGxvbmcgbjEgPSAo\nbzEgPT0gbnVsbCkgPyAwTCA6ICgoTnVtYmVyKSBvMSkubG9uZ1ZhbHVlKCk7\nCiAgICAgICAgICAgIGxvbmcgbjIgPSAobzIgPT0gbnVsbCkgPyAwTCA6ICgo\nTnVtYmVyKSBvMikubG9uZ1ZhbHVlKCk7CiAgICAgICAgICAgIHJldHVybiBv\ncChuMSwgbjIsIG9wKTsKICAgICAgICB9CiAgICAgICAgaWYgKHByb21vdGUg\nPT0gQmlnRGVjaW1hbC5jbGFzcykgewogICAgICAgICAgICBCaWdEZWNpbWFs\nIG4xID0gKG8xID09IG51bGwpID8gWkVST19CSUdERUNJTUFMCiAgICAgICAg\nICAgICAgICA6IChCaWdEZWNpbWFsKSBjb252ZXJ0KG8xLCBwcm9tb3RlKTsK\nICAgICAgICAgICAgQmlnRGVjaW1hbCBuMiA9IChvMiA9PSBudWxsKSA/IFpF\nUk9fQklHREVDSU1BTAogICAgICAgICAgICAgICAgOiAoQmlnRGVjaW1hbCkg\nY29udmVydChvMiwgcHJvbW90ZSk7CiAgICAgICAgICAgIHJldHVybiBvcChu\nMSwgbjIsIG9wKTsKICAgICAgICB9CiAgICAgICAgaWYgKHByb21vdGUgPT0g\nQmlnSW50ZWdlci5jbGFzcykgewogICAgICAgICAgICBCaWdJbnRlZ2VyIG4x\nID0gKG8xID09IG51bGwpID8gWkVST19CSUdJTlRFR0VSCiAgICAgICAgICAg\nICAgICA6IChCaWdJbnRlZ2VyKSBjb252ZXJ0KG8xLCBwcm9tb3RlKTsKICAg\nICAgICAgICAgQmlnSW50ZWdlciBuMiA9IChvMiA9PSBudWxsKSA/IFpFUk9f\nQklHSU5URUdFUgogICAgICAgICAgICAgICAgOiAoQmlnSW50ZWdlcikgY29u\ndmVydChvMiwgcHJvbW90ZSk7CiAgICAgICAgICAgIHJldHVybiBvcChuMSwg\nbjIsIG9wKTsKICAgICAgICB9CiAgICAgICAgLy8gZGVmYXVsdCB0byBpbnQK\nICAgICAgICBpbnQgbjEgPSAobzEgPT0gbnVsbCkgPyAwIDogKChOdW1iZXIp\nIG8xKS5pbnRWYWx1ZSgpOwogICAgICAgIGludCBuMiA9IChvMiA9PSBudWxs\nKSA/IDAgOiAoKE51bWJlcikgbzIpLmludFZhbHVlKCk7CiAgICAgICAgcmV0\ndXJuIG9wKG4xLCBuMiwgb3ApOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSByZXN1bHQgb2YgYSBtYXRoZW1hdGljYWwgb3BlcmF0aW9uLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3Qgb3AoaW50IG4xLCBp\nbnQgbjIsIGludCBvcCkgewogICAgICAgIGludCB0b3Q7CiAgICAgICAgc3dp\ndGNoIChvcCkgewogICAgICAgICAgICBjYXNlIE9QX0FERDoKICAgICAgICAg\nICAgICAgIHRvdCA9IG4xICsgbjI7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBPUF9TVUJUUkFDVDoKICAgICAgICAgICAgICAg\nIHRvdCA9IG4xIC0gbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBPUF9NVUxUSVBMWToKICAgICAgICAgICAgICAgIHRvdCA9\nIG4xICogbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBPUF9ESVZJREU6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSAvIG4y\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1Bf\nTU9EOgogICAgICAgICAgICAgICAgdG90ID0gbjEgJSBuMjsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YodG90KTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzdWx0IG9mIGEgbWF0aGVt\nYXRpY2FsIG9wZXJhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nT2JqZWN0IG9wKGZsb2F0IG4xLCBmbG9hdCBuMiwgaW50IG9wKSB7CiAgICAg\nICAgZmxvYXQgdG90OwogICAgICAgIHN3aXRjaCAob3ApIHsKICAgICAgICAg\nICAgY2FzZSBPUF9BREQ6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSArIG4y\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1Bf\nU1VCVFJBQ1Q6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSAtIG4yOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1BfTVVMVElQ\nTFk6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSAqIG4yOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1BfRElWSURFOgogICAg\nICAgICAgICAgICAgdG90ID0gbjEgLyBuMjsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIE9QX01PRDoKICAgICAgICAgICAgICAg\nIHRvdCA9IG4xICUgbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnRl\ncm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3\nIEZsb2F0KHRvdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIHJlc3VsdCBvZiBhIG1hdGhlbWF0aWNhbCBvcGVyYXRpb24uCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBvcChkb3VibGUgbjEsIGRvdWJs\nZSBuMiwgaW50IG9wKSB7CiAgICAgICAgZG91YmxlIHRvdDsKICAgICAgICBz\nd2l0Y2ggKG9wKSB7CiAgICAgICAgICAgIGNhc2UgT1BfQUREOgogICAgICAg\nICAgICAgICAgdG90ID0gbjEgKyBuMjsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIE9QX1NVQlRSQUNUOgogICAgICAgICAgICAg\nICAgdG90ID0gbjEgLSBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIE9QX01VTFRJUExZOgogICAgICAgICAgICAgICAgdG90\nID0gbjEgKiBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIE9QX0RJVklERToKICAgICAgICAgICAgICAgIHRvdCA9IG4xIC8g\nbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBP\nUF9NT0Q6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSAlIG4yOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIG5ldyBEb3VibGUodG90KTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzdWx0IG9mIGEgbWF0aGVtYXRp\nY2FsIG9wZXJhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgT2Jq\nZWN0IG9wKGxvbmcgbjEsIGxvbmcgbjIsIGludCBvcCkgewogICAgICAgIGxv\nbmcgdG90OwogICAgICAgIHN3aXRjaCAob3ApIHsKICAgICAgICAgICAgY2Fz\nZSBPUF9BREQ6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSArIG4yOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1BfU1VCVFJB\nQ1Q6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSAtIG4yOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1BfTVVMVElQTFk6CiAg\nICAgICAgICAgICAgICB0b3QgPSBuMSAqIG4yOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1BfRElWSURFOgogICAgICAgICAg\nICAgICAgdG90ID0gbjEgLyBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIE9QX01PRDoKICAgICAgICAgICAgICAgIHRvdCA9\nIG4xICUgbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4\nY2VwdGlvbigpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gTnVtYmVycy52\nYWx1ZU9mKHRvdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIHJlc3VsdCBvZiBhIG1hdGhlbWF0aWNhbCBvcGVyYXRpb24uCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBvcChCaWdEZWNpbWFsIG4xLCBC\naWdEZWNpbWFsIG4yLCBpbnQgb3ApIHsKICAgICAgICBzd2l0Y2ggKG9wKSB7\nCiAgICAgICAgICAgIGNhc2UgT1BfQUREOgogICAgICAgICAgICAgICAgcmV0\ndXJuIG4xLmFkZChuMik7CiAgICAgICAgICAgIGNhc2UgT1BfU1VCVFJBQ1Q6\nCiAgICAgICAgICAgICAgICByZXR1cm4gbjEuc3VidHJhY3QobjIpOwogICAg\nICAgICAgICBjYXNlIE9QX01VTFRJUExZOgogICAgICAgICAgICAgICAgcmV0\ndXJuIG4xLm11bHRpcGx5KG4yKTsKICAgICAgICAgICAgY2FzZSBPUF9ESVZJ\nREU6CiAgICAgICAgICAgICAgICBpbnQgc2NhbGUgPSBNYXRoLm1heChuMS5z\nY2FsZSgpLCBuMi5zY2FsZSgpKTsKICAgICAgICAgICAgICAgIHJldHVybiBu\nMS5kaXZpZGUobjIsIHNjYWxlLCBCaWdEZWNpbWFsLlJPVU5EX0hBTEZfVVAp\nOwogICAgICAgICAgICBjYXNlIE9QX01PRDoKICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJtb2QtYmlnZGVjaW1h\nbCIpKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzdWx0IG9mIGEgbWF0aGVt\nYXRpY2FsIG9wZXJhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nT2JqZWN0IG9wKEJpZ0ludGVnZXIgbjEsIEJpZ0ludGVnZXIgbjIsIGludCBv\ncCkgewogICAgICAgIHN3aXRjaCAob3ApIHsKICAgICAgICAgICAgY2FzZSBP\nUF9BREQ6CiAgICAgICAgICAgICAgICByZXR1cm4gbjEuYWRkKG4yKTsKICAg\nICAgICAgICAgY2FzZSBPUF9TVUJUUkFDVDoKICAgICAgICAgICAgICAgIHJl\ndHVybiBuMS5zdWJ0cmFjdChuMik7CiAgICAgICAgICAgIGNhc2UgT1BfTVVM\nVElQTFk6CiAgICAgICAgICAgICAgICByZXR1cm4gbjEubXVsdGlwbHkobjIp\nOwogICAgICAgICAgICBjYXNlIE9QX0RJVklERToKICAgICAgICAgICAgICAg\nIHJldHVybiBuMS5kaXZpZGUobjIpOwogICAgICAgICAgICBkZWZhdWx0Ogog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUGFyc2VzIHRoZSBn\naXZlbiBkZWNsYXJhdGlvbnMgaW50byBhIGxpc3Qgb2YgdHlwZSwgbmFtZSwg\ndHlwZSwgbmFtZS4uLgogICAgICogUmV0dXJucyBudWxsIGlmIG5vIGRlY2xh\ncmF0aW9ucy4gQXNzdW1lcyBkZWNsYXJhdGlvbiBpcyBub3QgYW4gZW1wdHkK\nICAgICAqIHN0cmluZyBhbmQgaXMgYWxyZWFkeSB0cmltbWVkICh2YWxpZCBh\nc3N1bXB0aW9ucyBnaXZlbiB0aGUgY2hlY2tzIG1hZGUKICAgICAqIGluIG91\nciBzZXR0ZXJzKS4KICAgICAqCiAgICAgKiBAcGFyYW0gZGVjVHlwZSB0aGUg\ndHlwZSBvZiBkZWNsYXJhdGlvbiBiZWluZyBwYXJzZWQsIGZvciB1c2UgaW4K\nICAgICAqIGVycm9yIG1lc3NhZ2VzCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgTGlzdCBwYXJzZURlY2xhcmF0aW9uKFN0cmluZyBkZWMsIGNoYXIgc3Bs\naXQsCiAgICAgICAgU3RyaW5nIGRlY1R5cGUpIHsKICAgICAgICBpZiAoZGVj\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAv\nLyB3YXRjaCBmb3IgY29tbW9uIG1peHVwcyBiZXR3ZWVuIGNvbW1hcyBhbmQg\nc2VtaXMKICAgICAgICBjaGFyIGJhZCA9IChjaGFyKSAwOwogICAgICAgIGlm\nIChzcGxpdCA9PSAnLCcpCiAgICAgICAgICAgIGJhZCA9ICc7JzsKICAgICAg\nICBlbHNlIGlmIChzcGxpdCA9PSAnOycpCiAgICAgICAgICAgIGJhZCA9ICcs\nJzsKCiAgICAgICAgY2hhciBzZW50aW5hbCA9ICcgJzsKICAgICAgICBjaGFy\nIGN1cjsKICAgICAgICBpbnQgc3RhcnQgPSAwOwogICAgICAgIGJvb2xlYW4g\nc2tpcFNwYWNlID0gZmFsc2U7CiAgICAgICAgTGlzdCByZXN1bHRzID0gbmV3\nIEFycmF5TGlzdCg2KTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGRl\nYy5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAgICAgIGN1ciA9IGRlYy5jaGFy\nQXQoaSk7CiAgICAgICAgICAgIGlmIChjdXIgPT0gYmFkKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1k\nZWMiLCBkZWMsIGRlY1R5cGUpKTsKICAgICAgICAgICAgaWYgKGN1ciA9PSAn\nICcgJiYgc2tpcFNwYWNlKSB7CiAgICAgICAgICAgICAgICBzdGFydCsrOwog\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHNraXBTcGFjZSA9IGZhbHNlOwogICAgICAgICAgICBpZiAoY3Vy\nICE9IHNlbnRpbmFsKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAg\nICAgICAgICAvLyBpZiBsb29raW5nIGZvciBzcGFjZXMsIGxvb2sgZm9yIHNw\nbGl0IGNoYXIsIG9yIHZpY2UgdmVyc2EKICAgICAgICAgICAgc2VudGluYWwg\nPSAoc2VudGluYWwgPT0gJyAnKSA/IHNwbGl0IDogJyAnOwogICAgICAgICAg\nICByZXN1bHRzLmFkZChkZWMuc3Vic3RyaW5nKHN0YXJ0LCBpKS50cmltKCkp\nOwogICAgICAgICAgICBzdGFydCA9IGkgKyAxOwogICAgICAgICAgICBza2lw\nU3BhY2UgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgLy8gYWRkIGxhc3Qg\ndG9rZW4sIGlmIGFueQogICAgICAgIGlmIChzdGFydCA8IGRlYy5sZW5ndGgo\nKSkKICAgICAgICAgICAgcmVzdWx0cy5hZGQoZGVjLnN1YnN0cmluZyhzdGFy\ndCkpOwoKICAgICAgICAvLyBpZiBub3QgYW4gZXZlbiBudW1iZXIgb2YgZWxl\nbWVudHMsIHNvbWV0aGluZyBpcyB3cm9uZwogICAgICAgIGlmIChyZXN1bHRz\nLmlzRW1wdHkoKSB8fCByZXN1bHRzLnNpemUoKSAlIDIgIT0gMCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1k\nZWMiLCBkZWMsIGRlY1R5cGUpKTsKCiAgICAgICAgcmV0dXJuIHJlc3VsdHM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTcGxpdCB0aGUgZ2l2ZW4gZXhwcmVz\nc2lvbiBsaXN0IGludG8gZGlzdGluY3QgZXhwcmVzc2lvbnMuIEFzc3VtZXMg\ndGhlCiAgICAgKiBnaXZlbiBzdHJpbmcgaXMgbm90IG51bGwgb3Igb2YgemVy\nbyBsZW5ndGggYW5kIGlzIGFscmVhZHkgdHJpbW1lZAogICAgICogKHZhbGlk\nIGFzc3VtcHRpb25zIGdpdmVuIHRoZSBjaGVja3MgaW4gb3VyIHNldHRlcnMg\nYW5kIGJlZm9yZQogICAgICogdGhpcyBtZXRob2QgY2FsbCkuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgTGlzdCBzcGxpdEV4cHJlc3Npb25zKFN0cmlu\nZyBzdHIsIGNoYXIgc3BsaXQsIGludCBleHBlY3RlZCkgewogICAgICAgIGlm\nIChzdHIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAg\nICAgIExpc3QgZXhwcyA9IG51bGw7CiAgICAgICAgaW50IHBhcmVuRGVwdGgg\nPSAwOwogICAgICAgIGludCBiZWdpbiA9IDAsIHBvcyA9IDA7CiAgICAgICAg\nYm9vbGVhbiBlc2NhcGUgPSBmYWxzZTsKICAgICAgICBib29sZWFuIHN0cmlu\nZyA9IGZhbHNlOwogICAgICAgIGJvb2xlYW4gbm9uc3BhY2UgPSBmYWxzZTsK\nICAgICAgICBjaGFyIHF1b3RlID0gMDsKICAgICAgICBmb3IgKGNoYXIgYzsg\ncG9zIDwgc3RyLmxlbmd0aCgpOyBwb3MrKykgewogICAgICAgICAgICBjID0g\nc3RyLmNoYXJBdChwb3MpOwogICAgICAgICAgICBpZiAoYyA9PSAnXFwnKSB7\nCiAgICAgICAgICAgICAgICBlc2NhcGUgPSAhZXNjYXBlOwogICAgICAgICAg\nICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKGVzY2FwZSkgewogICAgICAgICAgICAgICAgZXNjYXBlID0gZmFsc2U7CiAg\nICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgc3dpdGNoIChjKSB7CiAgICAgICAgICAgICAgICBjYXNlICdcJyc6\nCiAgICAgICAgICAgICAgICBjYXNlICciJzoKICAgICAgICAgICAgICAgICAg\nICBpZiAoc3RyaW5nICYmIHF1b3RlID09IGMpCiAgICAgICAgICAgICAgICAg\nICAgICAgIHN0cmluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGVs\nc2UgaWYgKCFzdHJpbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcXVv\ndGUgPSBjOwogICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSB0cnVl\nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBu\nb25zcGFjZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlICcoJzoKICAgICAgICAgICAgICAgICAgICBp\nZiAoIXN0cmluZykKICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW5EZXB0\naCsrOwogICAgICAgICAgICAgICAgICAgIG5vbnNwYWNlID0gdHJ1ZTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nJyknOgogICAgICAgICAgICAgICAgICAgIGlmICghc3RyaW5nKQogICAgICAg\nICAgICAgICAgICAgICAgICBwYXJlbkRlcHRoLS07CiAgICAgICAgICAgICAg\nICAgICAgbm9uc3BhY2UgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnICc6CiAgICAgICAgICAgICAg\nICBjYXNlICdcdCc6CiAgICAgICAgICAgICAgICBjYXNlICdcbic6CiAgICAg\nICAgICAgICAgICBjYXNlICdccic6CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGMgPT0gc3BsaXQgJiYgIXN0cmluZyAmJiBwYXJlbkRlcHRoID09IDAgJiYg\nbm9uc3BhY2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cHMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cHMgPSBu\nZXcgQXJyYXlMaXN0KGV4cGVjdGVkKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgZXhwcy5hZGQoc3RyLnN1YnN0cmluZyhiZWdpbiwgcG9zKS50cmltKCkp\nOwogICAgICAgICAgICAgICAgICAgICAgICBiZWdpbiA9IHBvcyArIDE7CiAg\nICAgICAgICAgICAgICAgICAgICAgIG5vbnNwYWNlID0gZmFsc2U7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICBp\nZiAoYyA9PSBzcGxpdCAmJiAhc3RyaW5nICYmIHBhcmVuRGVwdGggPT0gMCkg\newogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwcyA9PSBudWxsKQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwcyA9IG5ldyBBcnJheUxp\nc3QoZXhwZWN0ZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBleHBzLmFk\nZChzdHIuc3Vic3RyaW5nKGJlZ2luLCBwb3MpLnRyaW0oKSk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGJlZ2luID0gcG9zICsgMTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbm9uc3BhY2UgPSB0cnVl\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVzY2FwZSA9IGZhbHNlOwog\nICAgICAgIH0KCiAgICAgICAgaWYgKGV4cHMgPT0gbnVsbCkgewogICAgICAg\nICAgICAvLyBDb2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0IHdhc24ndCBhZGRl\nZCB1bnRpbCAxLjMKICAgICAgICAgICAgZXhwcyA9IG5ldyBBcnJheUxpc3Qo\nMSk7CiAgICAgICAgICAgIGV4cHMuYWRkKHN0cik7CiAgICAgICAgICAgIHJl\ndHVybiBleHBzOwogICAgICAgIH0KCiAgICAgICAgLy8gYWRkIGxhc3QgZXhw\nIGFuZCByZXR1cm4gYXJyYXkKICAgICAgICBTdHJpbmcgbGFzdCA9IHN0ci5z\ndWJzdHJpbmcoYmVnaW4pLnRyaW0oKTsKICAgICAgICBpZiAobGFzdC5sZW5n\ndGgoKSA+IDApCiAgICAgICAgICAgIGV4cHMuYWRkKGxhc3QpOwogICAgICAg\nIHJldHVybiBleHBzOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBn\naXZlbiBhY2Nlc3MgcGF0aCBtZXRhZGF0YXMgdG8gdGhlIGZ1bGwgcGF0aCBs\naXN0LCBtYWtpbmcgc3VyZQogICAgICogdG8gbWFpbnRhaW4gb25seSBiYXNl\nIG1ldGFkYXRhcyBpbiB0aGUgbGlzdC4gVGhlIGdpdmVuIGxpc3QgbWF5IGJl\nIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgTGlzdCBhZGRBY2Nl\nc3NQYXRoTWV0YURhdGFzKExpc3QgbWV0YXMsCiAgICAgICAgQ2xhc3NNZXRh\nRGF0YVtdIHBhdGgpIHsKICAgICAgICBpZiAocGF0aCA9PSBudWxsIHx8IHBh\ndGgubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBtZXRhczsKCiAg\nICAgICAgLy8gY3JlYXRlIHNldCBvZiBiYXNlIGNsYXNzIG1ldGFkYXRhcyBp\nbiBhY2Nlc3MgcGF0aAogICAgICAgIGlmIChtZXRhcyA9PSBudWxsKQogICAg\nICAgICAgICBtZXRhcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBpbnQg\nbGFzdCA9IG1ldGFzLnNpemUoKTsKCiAgICAgICAgLy8gZm9yIGV2ZXJ5IGVs\nZW1lbnQgaW4gdGhlIHBhdGggb2YgdGhpcyBleGVjdXRvciwgY29tcGFyZSBp\ndAogICAgICAgIC8vIHRvIGFscmVhZHktZ2F0aGVyZWQgZWxlbWVudHMgdG8g\nc2VlIGlmIGl0IHNob3VsZCByZXBsYWNlCiAgICAgICAgLy8gYSBzdWJjbGFz\ncyBpbiB0aGUgbGlzdCBvciBzaG91bGQgYmUgYWRkZWQgYXMgYSBuZXcgYmFz\nZTsKICAgICAgICAvLyBhdCBsZWFzdCBpdCdzIG5eMiBvZiBhIHNtYWxsIG4u\nLi4KICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGE7CiAgICAgICAgYm9vbGVh\nbiBhZGQ7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYXRoLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGFkZCA9IHRydWU7CiAgICAgICAgICAg\nIGZvciAoaW50IGogPSAwOyBhZGQgJiYgaiA8IGxhc3Q7IGorKykgewogICAg\nICAgICAgICAgICAgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBtZXRhcy5nZXQo\naik7CgogICAgICAgICAgICAgICAgaWYgKG1ldGEuZ2V0RGVzY3JpYmVkVHlw\nZSgpLmlzQXNzaWduYWJsZUZyb20KICAgICAgICAgICAgICAgICAgICAocGF0\naFtpXS5nZXREZXNjcmliZWRUeXBlKCkpKSB7CiAgICAgICAgICAgICAgICAg\nICAgLy8gbGlzdCBhbHJlYWR5IGNvbnRhaW5zIGJhc2UgY2xhc3MKICAgICAg\nICAgICAgICAgICAgICBhZGQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0g\nZWxzZSBpZiAocGF0aFtpXS5nZXREZXNjcmliZWRUeXBlKCkuaXNBc3NpZ25h\nYmxlRnJvbQogICAgICAgICAgICAgICAgICAgIChtZXRhLmdldERlc2NyaWJl\nZFR5cGUoKSkpIHsKICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGVsZW1l\nbnQgcmVwbGFjZXMgaXRzIHN1YmNsYXNzCiAgICAgICAgICAgICAgICAgICAg\nYWRkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgbWV0YXMuc2V0KGos\nIHBhdGhbaV0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9Cgog\nICAgICAgICAgICAvLyBpZiBubyBiYXNlIGNsYXNzIG9mIGN1cnJlbnQgcGF0\naCBlbGVtZW50IGFscmVhZHkgaW4KICAgICAgICAgICAgLy8gbGlzdCBhbmQg\ncGF0aCBlbGVtZW50IGRpZG4ndCByZXBsYWNlIGEgc3ViY2xhc3MgaW4gdGhl\nCiAgICAgICAgICAgIC8vIGxpc3QsIHRoZW4gYWRkIGl0IG5vdyBhcyBhIG5l\ndyBiYXNlCiAgICAgICAgICAgIGlmIChhZGQpCiAgICAgICAgICAgICAgICBt\nZXRhcy5hZGQocGF0aFtpXSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBt\nZXRhczsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHVzZXIt\nZ2l2ZW4gaGludCB2YWx1ZSB0byBhbiBhZ2dyZWdhdGUgbGlzdGVuZXIuCiAg\nICAgKiBUaGUgaGludCBjYW4gYmUgYW4gYWdncmVnYXRlIGxpc3RlbmVyIGlu\nc3RhbmNlIG9yIGNsYXNzIG5hbWUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgQWdncmVnYXRlTGlzdGVuZXIgaGludFRvQWdncmVnYXRlTGlzdGVuZXIo\nT2JqZWN0IGhpbnQsCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAg\nICAgICAgaWYgKGhpbnQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBBZ2dyZWdhdGVMaXN0\nZW5lcikKICAgICAgICAgICAgcmV0dXJuIChBZ2dyZWdhdGVMaXN0ZW5lcikg\naGludDsKCiAgICAgICAgRXhjZXB0aW9uIGNhdXNlID0gbnVsbDsKICAgICAg\nICBpZiAoaGludCBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgcmV0dXJuIChBZ2dyZWdhdGVMaXN0ZW5l\ncikgQ2xhc3MuZm9yTmFtZSgoU3RyaW5nKSBoaW50LCB0cnVlLAogICAgICAg\nICAgICAgICAgICAgIGxvYWRlcikubmV3SW5zdGFuY2UoKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGNh\ndXNlID0gZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aHJv\ndyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWFnZy1saXN0ZW5l\nci1oaW50IiwgaGludCwKICAgICAgICAgICAgaGludC5nZXRDbGFzcygpKSku\nc2V0Q2F1c2UoY2F1c2UpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVy\ndCB0aGUgdXNlci1naXZlbiBoaW50IHZhbHVlIHRvIGFuIGFycmF5IG9mIGFn\nZ3JlZ2F0ZSBsaXN0ZW5lcnMuCiAgICAgKiBUaGUgaGludCBjYW4gYmUgYW4g\nYWdncmVnYXRlIGxpc3RlbmVyLCBhZ2dyZWdhdGUgbGlzdGVuZXIgYXJyYXks\nCiAgICAgKiBjb2xsZWN0aW9uLCBvciBjb21tYS1zZXBhcmF0ZWQgY2xhc3Mg\nbmFtZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQWdncmVnYXRlTGlz\ndGVuZXJbXSBoaW50VG9BZ2dyZWdhdGVMaXN0ZW5lcnMoT2JqZWN0IGhpbnQs\nCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgaWYgKGhp\nbnQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\naWYgKGhpbnQgaW5zdGFuY2VvZiBBZ2dyZWdhdGVMaXN0ZW5lcltdKQogICAg\nICAgICAgICByZXR1cm4gKEFnZ3JlZ2F0ZUxpc3RlbmVyW10pIGhpbnQ7CiAg\nICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBBZ2dyZWdhdGVMaXN0ZW5lcikK\nICAgICAgICAgICAgcmV0dXJuIG5ldyBBZ2dyZWdhdGVMaXN0ZW5lcltdeyAo\nQWdncmVnYXRlTGlzdGVuZXIpIGhpbnQgfTsKICAgICAgICBpZiAoaGludCBp\nbnN0YW5jZW9mIENvbGxlY3Rpb24pIHsKICAgICAgICAgICAgQ29sbGVjdGlv\nbiBjID0gKENvbGxlY3Rpb24pIGhpbnQ7CiAgICAgICAgICAgIHJldHVybiAo\nQWdncmVnYXRlTGlzdGVuZXJbXSkgYy50b0FycmF5CiAgICAgICAgICAgICAg\nICAobmV3IEFnZ3JlZ2F0ZUxpc3RlbmVyW2Muc2l6ZSgpXSk7CiAgICAgICAg\nfQoKICAgICAgICBFeGNlcHRpb24gY2F1c2UgPSBudWxsOwogICAgICAgIGlm\nIChoaW50IGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAgIFN0cmlu\nZ1tdIGNsc3MgPSBTdHJpbmdzLnNwbGl0KChTdHJpbmcpIGhpbnQsICIsIiwg\nMCk7CiAgICAgICAgICAgIEFnZ3JlZ2F0ZUxpc3RlbmVyW10gYWdncyA9IG5l\ndyBBZ2dyZWdhdGVMaXN0ZW5lcltjbHNzLmxlbmd0aF07CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNs\nc3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgYWdnc1tpXSA9\nIChBZ2dyZWdhdGVMaXN0ZW5lcikgQ2xhc3MuZm9yTmFtZShjbHNzW2ldLCB0\ncnVlLAogICAgICAgICAgICAgICAgICAgICAgICBsb2FkZXIpLm5ld0luc3Rh\nbmNlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYWdnczsKICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGNh\ndXNlID0gZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aHJv\ndyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWFnZy1saXN0ZW5l\nci1oaW50IiwgaGludCwKICAgICAgICAgICAgaGludC5nZXRDbGFzcygpKSku\nc2V0Q2F1c2UoY2F1c2UpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVy\ndCB0aGUgdXNlci1naXZlbiBoaW50IHZhbHVlIHRvIGEgZmlsdGVyIGxpc3Rl\nbmVyLgogICAgICogVGhlIGhpbnQgY2FuIGJlIGEgZmlsdGVyIGxpc3RlbmVy\nIGluc3RhbmNlIG9yIGNsYXNzIG5hbWUuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgRmlsdGVyTGlzdGVuZXIgaGludFRvRmlsdGVyTGlzdGVuZXIoT2Jq\nZWN0IGhpbnQsCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAg\nICAgaWYgKGhpbnQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBGaWx0ZXJMaXN0ZW5lcikK\nICAgICAgICAgICAgcmV0dXJuIChGaWx0ZXJMaXN0ZW5lcikgaGludDsKCiAg\nICAgICAgRXhjZXB0aW9uIGNhdXNlID0gbnVsbDsKICAgICAgICBpZiAoaGlu\ndCBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIChGaWx0ZXJMaXN0ZW5lcikgQ2xhc3MuZm9y\nTmFtZSgoU3RyaW5nKSBoaW50LCB0cnVlLAogICAgICAgICAgICAgICAgICAg\nIGxvYWRlcikubmV3SW5zdGFuY2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGNhdXNlID0gZTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcgVXNlckV4\nY2VwdGlvbihfbG9jLmdldCgiYmFkLWZpbHRlci1saXN0ZW5lci1oaW50Iiwg\naGludCwKICAgICAgICAgICAgaGludC5nZXRDbGFzcygpKSkuc2V0Q2F1c2Uo\nY2F1c2UpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgdXNl\nci1naXZlbiBoaW50IHZhbHVlIHRvIGFuIGFycmF5IG9mIGZpbHRlciBsaXN0\nZW5lcnMuCiAgICAgKiBUaGUgaGludCBjYW4gYmUgYSBmaWx0ZXIgbGlzdGVu\nZXIsIGZpbHRlciBsaXN0ZW5lciBhcnJheSwKICAgICAqIGNvbGxlY3Rpb24s\nIG9yIGNvbW1hLXNlcGFyYXRlZCBjbGFzcyBuYW1lcy4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBGaWx0ZXJMaXN0ZW5lcltdIGhpbnRUb0ZpbHRlckxp\nc3RlbmVycyhPYmplY3QgaGludCwKICAgICAgICBDbGFzc0xvYWRlciBsb2Fk\nZXIpIHsKICAgICAgICBpZiAoaGludCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9mIEZpbHRl\nckxpc3RlbmVyW10pCiAgICAgICAgICAgIHJldHVybiAoRmlsdGVyTGlzdGVu\nZXJbXSkgaGludDsKICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9mIEZpbHRl\nckxpc3RlbmVyKQogICAgICAgICAgICByZXR1cm4gbmV3IEZpbHRlckxpc3Rl\nbmVyW117IChGaWx0ZXJMaXN0ZW5lcikgaGludCB9OwogICAgICAgIGlmICho\naW50IGluc3RhbmNlb2YgQ29sbGVjdGlvbikgewogICAgICAgICAgICBDb2xs\nZWN0aW9uIGMgPSAoQ29sbGVjdGlvbikgaGludDsKICAgICAgICAgICAgcmV0\ndXJuIChGaWx0ZXJMaXN0ZW5lcltdKSBjLnRvQXJyYXkobmV3IEZpbHRlckxp\nc3RlbmVyW2Muc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICBFeGNlcHRp\nb24gY2F1c2UgPSBudWxsOwogICAgICAgIGlmIChoaW50IGluc3RhbmNlb2Yg\nU3RyaW5nKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGNsc3MgPSBTdHJpbmdz\nLnNwbGl0KChTdHJpbmcpIGhpbnQsICIsIiwgMCk7CiAgICAgICAgICAgIEZp\nbHRlckxpc3RlbmVyW10gZmlsdHMgPSBuZXcgRmlsdGVyTGlzdGVuZXJbY2xz\ncy5sZW5ndGhdOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjbHNzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgICAgIGZpbHRzW2ldID0gKEZpbHRlckxpc3RlbmVyKSBDbGFz\ncy5mb3JOYW1lKGNsc3NbaV0sIHRydWUsCiAgICAgICAgICAgICAgICAgICAg\nICAgIGxvYWRlcikubmV3SW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIHJl\ndHVybiBmaWx0czsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIGNhdXNlID0gZTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9j\nLmdldCgiYmFkLWZpbHRlci1saXN0ZW5lci1oaW50IiwgaGludCwKICAgICAg\nICAgICAgaGludC5nZXRDbGFzcygpKSkuc2V0Q2F1c2UoY2F1c2UpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGUgcHJv\ncGVydHkgbmFtZWQgYnkgdGhlIGhpbnQga2V5LgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIE9iamVjdCBoaW50VG9HZXR0ZXIoT2JqZWN0IHRhcmdldCwg\nU3RyaW5nIGhpbnRLZXkpIHsKICAgICAgICBpZiAodGFyZ2V0ID09IG51bGwg\nfHwgaGludEtleSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nCiAgICAgICAgTWV0aG9kIGdldHRlciA9IFJlZmxlY3Rpb24uZmluZEdldHRl\ncih0YXJnZXQuZ2V0Q2xhc3MoKSwgaGludEtleSwgdHJ1ZSk7CiAgICAgICAg\ncmV0dXJuIFJlZmxlY3Rpb24uZ2V0KHRhcmdldCwgZ2V0dGVyKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5\nIG5hbWVkIGJ5IHRoZSBoaW50IGtleS4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyB2b2lkIGhpbnRUb1NldHRlcihPYmplY3QgdGFyZ2V0LCBTdHJpbmcg\naGludEtleSwKICAgICAgICBPYmplY3QgdmFsdWUpIHsKICAgICAgICBpZiAo\ndGFyZ2V0ID09IG51bGwgfHwgaGludEtleSA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm47CgogICAgICAgIE1ldGhvZCBzZXR0ZXIgPSBSZWZsZWN0aW9u\nLmZpbmRTZXR0ZXIodGFyZ2V0LmdldENsYXNzKCksIGhpbnRLZXksIHRydWUp\nOwogICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZykgewogICAg\nICAgICAgICBpZiAoIm51bGwiLmVxdWFscyh2YWx1ZSkpCiAgICAgICAgICAg\nICAgICB2YWx1ZSA9IG51bGw7CiAgICAgICAgICAgIGVsc2UgewogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFN0\ncmluZ3MucGFyc2UoKFN0cmluZykgdmFsdWUsCiAgICAgICAgICAgICAgICAg\nICAgICAgIHNldHRlci5nZXRQYXJhbWV0ZXJUeXBlcygpWzBdKTsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJh\nZC1zZXR0ZXItaGludC1hcmciLAogICAgICAgICAgICAgICAgICAgICAgICBo\naW50S2V5LCB2YWx1ZSwgc2V0dGVyLmdldFBhcmFtZXRlclR5cGVzKClbMF0p\nKS4KICAgICAgICAgICAgICAgICAgICAgICAgc2V0Q2F1c2UoZSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\nUmVmbGVjdGlvbi5zZXQodGFyZ2V0LCBzZXR0ZXIsIHZhbHVlKTsKCX0KfQo=\n","encoding":"base64"}

