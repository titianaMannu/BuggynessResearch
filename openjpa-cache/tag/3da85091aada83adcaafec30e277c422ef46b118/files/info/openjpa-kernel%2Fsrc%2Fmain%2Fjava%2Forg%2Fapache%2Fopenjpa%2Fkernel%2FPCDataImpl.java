{"sha":"5f4f68a2e39b6cbfb2fadc5e83441d9e8a60db08","node_id":"MDQ6QmxvYjIwNjM2NDo1ZjRmNjhhMmUzOWI2Y2JmYjJmYWRjNWU4MzQ0MWQ5ZThhNjBkYjA4","size":9239,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5f4f68a2e39b6cbfb2fadc5e83441d9e8a60db08","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5CaXRTZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkZpZWxkTWV0YURhdGE7CgovKioKICogRGVmYXVsdCB7QGxpbmsgUENE\nYXRhfSBpbXBsZW1lbnRhdGlvbi4KICoKICogQGF1dGhvciBQYXRyaWNrIExp\nbnNrZXkKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8K\ncHVibGljIGNsYXNzIFBDRGF0YUltcGwKICAgIGV4dGVuZHMgQWJzdHJhY3RQ\nQ0RhdGEgewoKICAgIHByaXZhdGUgZmluYWwgT2JqZWN0IF9vaWQ7CiAgICBw\ncml2YXRlIGZpbmFsIENsYXNzIF90eXBlOwogICAgcHJpdmF0ZSBmaW5hbCBP\nYmplY3RbXSBfZGF0YTsKICAgIHByaXZhdGUgZmluYWwgQml0U2V0IF9sb2Fk\nZWQ7CiAgICBwcml2YXRlIE9iamVjdCBfdmVyc2lvbiA9IG51bGw7CiAgICBw\ncml2YXRlIE9iamVjdCBfaW1wbCA9IG51bGw7CiAgICBwcml2YXRlIE9iamVj\ndFtdIF9maWVsZEltcGwgPSBudWxsOwoKICAgIC8qKgogICAgICogQ29uc3Ry\ndWN0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBQQ0RhdGFJbXBsKE9iamVjdCBv\naWQsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIF9vaWQgPSBvaWQ7\nCiAgICAgICAgX3R5cGUgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKCiAg\nICAgICAgaW50IGxlbiA9IG1ldGEuZ2V0RmllbGRzKCkubGVuZ3RoOwogICAg\nICAgIF9kYXRhID0gbmV3IE9iamVjdFtsZW5dOwogICAgICAgIF9sb2FkZWQg\nPSBuZXcgQml0U2V0KGxlbik7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBn\nZXRJZCgpIHsKICAgICAgICByZXR1cm4gX29pZDsKICAgIH0KCiAgICBwdWJs\naWMgQ2xhc3MgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gX3R5cGU7CiAg\nICB9CgogICAgcHVibGljIEJpdFNldCBnZXRMb2FkZWQoKSB7CiAgICAgICAg\ncmV0dXJuIF9sb2FkZWQ7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRE\nYXRhKGludCBpbmRleCkgewogICAgICAgIC8vIG1ha2Ugc3VyZSBpbmRleCBp\ncyBhY3R1YWxseSBsb2FkZWQgdG8gYXZvaWQgcmV0dXJuaW5nIGFuCiAgICAg\nICAgLy8gaW50ZXJtZWRpYXRlIHZhbHVlCiAgICAgICAgcmV0dXJuIChfbG9h\nZGVkLmdldChpbmRleCkpID8gX2RhdGFbaW5kZXhdIDogbnVsbDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXREYXRhKGludCBpbmRleCwgT2JqZWN0IHZh\nbCkgewogICAgICAgIF9sb2FkZWQuc2V0KGluZGV4KTsKICAgICAgICBfZGF0\nYVtpbmRleF0gPSB2YWw7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2xlYXJE\nYXRhKGludCBpbmRleCkgewogICAgICAgIF9sb2FkZWQuY2xlYXIoaW5kZXgp\nOwogICAgICAgIF9kYXRhW2luZGV4XSA9IG51bGw7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBnZXRJbXBsRGF0YSgpIHsKICAgICAgICByZXR1cm4gX2lt\ncGw7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0SW1wbERhdGEoT2JqZWN0\nIHZhbCkgewogICAgICAgIF9pbXBsID0gdmFsOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgZ2V0SW1wbERhdGEoaW50IGluZGV4KSB7CiAgICAgICAgcmV0\ndXJuIChfZmllbGRJbXBsICE9IG51bGwpID8gX2ZpZWxkSW1wbFtpbmRleF0g\nOiBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEltcGxEYXRhKGlu\ndCBpbmRleCwgT2JqZWN0IHZhbCkgewogICAgICAgIGlmICh2YWwgIT0gbnVs\nbCkgewogICAgICAgICAgICBpZiAoX2ZpZWxkSW1wbCA9PSBudWxsKQogICAg\nICAgICAgICAgICAgX2ZpZWxkSW1wbCA9IG5ldyBPYmplY3RbX2RhdGEubGVu\nZ3RoXTsKICAgICAgICAgICAgX2ZpZWxkSW1wbFtpbmRleF0gPSB2YWw7CiAg\nICAgICAgfSBlbHNlIGlmIChfZmllbGRJbXBsICE9IG51bGwpCiAgICAgICAg\nICAgIF9maWVsZEltcGxbaW5kZXhdID0gbnVsbDsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGdldEludGVybWVkaWF0ZShpbnQgaW5kZXgpIHsKICAgICAg\nICByZXR1cm4gKCFfbG9hZGVkLmdldChpbmRleCkpID8gX2RhdGFbaW5kZXhd\nIDogbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRJbnRlcm1lZGlh\ndGUoaW50IGluZGV4LCBPYmplY3QgdmFsKSB7CiAgICAgICAgX2xvYWRlZC5j\nbGVhcihpbmRleCk7CiAgICAgICAgX2RhdGFbaW5kZXhdID0gdmFsOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGlzTG9hZGVkKGludCBpbmRleCkgewog\nICAgICAgIHJldHVybiBfbG9hZGVkLmdldChpbmRleCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0TG9hZGVkKGludCBpbmRleCwgYm9vbGVhbiBsb2Fk\nZWQpIHsKICAgICAgICBpZiAobG9hZGVkKQogICAgICAgICAgICBfbG9hZGVk\nLnNldChpbmRleCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfbG9hZGVk\nLmNsZWFyKGluZGV4KTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFZl\ncnNpb24oKSB7CiAgICAgICAgcmV0dXJuIF92ZXJzaW9uOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldFZlcnNpb24oT2JqZWN0IHZlcnNpb24pIHsKICAg\nICAgICBfdmVyc2lvbiA9IHZlcnNpb247CiAgICB9CgogICAgcHVibGljIHZv\naWQgbG9hZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBGZXRjaENvbmZpZ3Vy\nYXRpb24gZmV0Y2gsCiAgICAgICAgT2JqZWN0IGNvbnRleHQpIHsKICAgICAg\nICBsb2FkVmVyc2lvbihzbSk7CiAgICAgICAgbG9hZEltcGxEYXRhKHNtKTsK\nCiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBzbS5nZXRNZXRhRGF0\nYSgpLmdldEZpZWxkcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nZm1kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBsb2FkIGludGVy\nbWVkaWF0ZSBkYXRhIGZvciBhbGwgdW5sb2FkZWQgZmllbGRzIGFuZCBkYXRh\nIGZvcgogICAgICAgICAgICAvLyBmaWVsZHMgaW4gY29uZmlndXJlZCBmZXRj\naCBncm91cHMKICAgICAgICAgICAgaWYgKCFpc0xvYWRlZChpKSkKICAgICAg\nICAgICAgICAgIGxvYWRJbnRlcm1lZGlhdGUoc20sIGZtZHNbaV0pOwogICAg\nICAgICAgICBlbHNlIGlmICghc20uZ2V0TG9hZGVkKCkuZ2V0KGkpICYmIGZl\ndGNoLnJlcXVpcmVzRmV0Y2goZm1kc1tpXSkgCiAgICAgICAgICAgICAgICAh\nPSBGZXRjaENvbmZpZ3VyYXRpb24uRkVUQ0hfTk9ORSkKICAgICAgICAgICAg\nICAgIGxvYWRGaWVsZChzbSwgZm1kc1tpXSwgZmV0Y2gsIGNvbnRleHQpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2FkKE9wZW5KUEFT\ndGF0ZU1hbmFnZXIgc20sIEJpdFNldCBmaWVsZHMsCiAgICAgICAgRmV0Y2hD\nb25maWd1cmF0aW9uIGZldGNoLCBPYmplY3QgY29udGV4dCkgewogICAgICAg\nIGxvYWRWZXJzaW9uKHNtKTsKICAgICAgICBsb2FkSW1wbERhdGEoc20pOwoK\nICAgICAgICAvLyBhdHRlbXB0IHRvIGxvYWQgZ2l2ZW4gZmllbGRzCiAgICAg\nICAgaW50IGxlbiA9IChmaWVsZHMgPT0gbnVsbCkgPyAwIDogZmllbGRzLmxl\nbmd0aCgpOwogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgICAgaWYg\nKCFmaWVsZHMuZ2V0KGkpKQogICAgICAgICAgICAgICAgY29udGludWU7Cgog\nICAgICAgICAgICBmbWQgPSBzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKGkp\nOwogICAgICAgICAgICBpZiAoIWlzTG9hZGVkKGkpKQogICAgICAgICAgICAg\nICAgbG9hZEludGVybWVkaWF0ZShzbSwgZm1kKTsKICAgICAgICAgICAgZWxz\nZSB7CiAgICAgICAgICAgICAgICBsb2FkRmllbGQoc20sIGZtZCwgZmV0Y2gs\nIGNvbnRleHQpOwogICAgICAgICAgICAgICAgbG9hZEltcGxEYXRhKHNtLCBm\nbWQpOwogICAgICAgICAgICAgICAgZmllbGRzLmNsZWFyKGkpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2V0IHZl\ncnNpb24gaW5mb3JtYXRpb24gaW50byB0aGUgZ2l2ZW4gc3RhdGUgbWFuYWdl\nci4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgbG9hZFZlcnNpb24oT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIGlmIChzbS5nZXRWZXJz\naW9uKCkgPT0gbnVsbCkKICAgICAgICAgICAgc20uc2V0VmVyc2lvbihnZXRW\nZXJzaW9uKCkpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGltcGwgZGF0\nYSBpbmZvcm1hdGlvbiBpbnRvIHRoZSBnaXZlbiBzdGF0ZSBtYW5hZ2VyLgog\nICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBsb2FkSW1wbERhdGEoT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIE9iamVjdCBpbXBsID0gZ2V0\nSW1wbERhdGEoKTsKICAgICAgICBpZiAoc20uZ2V0SW1wbERhdGEoKSA9PSBu\ndWxsICYmIGltcGwgIT0gbnVsbCkKICAgICAgICAgICAgc20uc2V0SW1wbERh\ndGEoaW1wbCwgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgZmll\nbGQtbGV2ZWwgaW5mb3JtYXRpb24gaW50byB0aGUgZ2l2ZW4gc3RhdGUgbWFu\nYWdlci4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgbG9hZEZpZWxkKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEZpZWxkTWV0YURhdGEgZm1kLAogICAg\nICAgIEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgT2JqZWN0IGNvbnRleHQp\nIHsKICAgICAgICBpbnQgaW5kZXggPSBmbWQuZ2V0SW5kZXgoKTsKICAgICAg\nICBPYmplY3QgdmFsID0gdG9GaWVsZChzbSwgZm1kLCBnZXREYXRhKGluZGV4\nKSwgZmV0Y2gsIGNvbnRleHQpOwogICAgICAgIHNtLnN0b3JlRmllbGQoaW5k\nZXgsIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgZmllbGQtbGV2\nZWwgaW1wbCBkYXRhIGludG8gdGhlIGdpdmVuIHN0YXRlIG1hbmFnZXIuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGxvYWRJbXBsRGF0YShPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtLCBGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAg\nIGludCBpbmRleCA9IGZtZC5nZXRJbmRleCgpOwogICAgICAgIE9iamVjdCBp\nbXBsID0gZ2V0SW1wbERhdGEoaW5kZXgpOwogICAgICAgIGlmIChpbXBsICE9\nIG51bGwpCiAgICAgICAgICAgIHNtLnNldEltcGxEYXRhKGluZGV4LCBpbXBs\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBpbnRlcm1lZGlhdGUgaW5m\nb3JtYXRpb24gZm9yIHRoZSBnaXZlbiBmaWVsZCBpbnRvIHRoZSBzdGF0ZSBt\nYW5hZ2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBsb2FkSW50ZXJt\nZWRpYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEZpZWxkTWV0YURhdGEg\nZm1kKSB7CiAgICAgICAgaW50IGluZGV4ID0gZm1kLmdldEluZGV4KCk7CiAg\nICAgICAgT2JqZWN0IGludGVyID0gZ2V0SW50ZXJtZWRpYXRlKGluZGV4KTsK\nICAgICAgICBpZiAoaW50ZXIgIT0gbnVsbCAmJiAhc20uZ2V0TG9hZGVkKCku\nZ2V0KGluZGV4KSkKICAgICAgICAgICAgc20uc2V0SW50ZXJtZWRpYXRlKGlu\nZGV4LCBpbnRlcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgc3RvcmUoT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIHN0b3JlVmVyc2lvbihz\nbSk7CiAgICAgICAgc3RvcmVJbXBsRGF0YShzbSk7CgogICAgICAgIEZpZWxk\nTWV0YURhdGFbXSBmbWRzID0gc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVsZHMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKHNtLmdldExvYWRlZCgpLmdldChpKSkg\newogICAgICAgICAgICAgICAgc3RvcmVGaWVsZChzbSwgZm1kc1tpXSk7CiAg\nICAgICAgICAgICAgICBzdG9yZUltcGxEYXRhKHNtLCBmbWRzW2ldLCBpc0xv\nYWRlZChpKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlzTG9hZGVkKGkp\nKQogICAgICAgICAgICAgICAgc3RvcmVJbnRlcm1lZGlhdGUoc20sIGZtZHNb\naV0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdG9yZShP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBCaXRTZXQgZmllbGRzKSB7CiAgICAg\nICAgc3RvcmVWZXJzaW9uKHNtKTsKICAgICAgICBzdG9yZUltcGxEYXRhKHNt\nKTsKCiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBzbS5nZXRNZXRh\nRGF0YSgpLmdldEZpZWxkcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgZm1kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoZmllbGRz\nICE9IG51bGwgJiYgZmllbGRzLmdldChpKSkgewogICAgICAgICAgICAgICAg\nc3RvcmVGaWVsZChzbSwgZm1kc1tpXSk7CiAgICAgICAgICAgICAgICBzdG9y\nZUltcGxEYXRhKHNtLCBmbWRzW2ldLCBpc0xvYWRlZChpKSk7CiAgICAgICAg\nICAgIH0gZWxzZSBpZiAoIWlzTG9hZGVkKGkpKQogICAgICAgICAgICAgICAg\nc3RvcmVJbnRlcm1lZGlhdGUoc20sIGZtZHNbaV0pOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFN0b3JlIHZlcnNpb24gaW5mb3JtYXRpb24g\nZnJvbSB0aGUgZ2l2ZW4gc3RhdGUgbWFuYWdlci4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgc3RvcmVWZXJzaW9uKE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nc20pIHsKICAgICAgICBzZXRWZXJzaW9uKHNtLmdldFZlcnNpb24oKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTdG9yZSBpbXBsIGRhdGEgZnJvbSB0aGUg\nZ2l2ZW4gc3RhdGUgbWFuYWdlci4KICAgICAqLwogICAgcHJvdGVjdGVkIHZv\naWQgc3RvcmVJbXBsRGF0YShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7CiAg\nICAgICAgaWYgKHNtLmlzSW1wbERhdGFDYWNoZWFibGUoKSkKICAgICAgICAg\nICAgc2V0SW1wbERhdGEoc20uZ2V0SW1wbERhdGEoKSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTdG9yZSBmaWVsZC1sZXZlbCBpbmZvcm1hdGlvbiBmcm9t\nIHRoZSBnaXZlbiBzdGF0ZSBtYW5hZ2VyLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBzdG9yZUZpZWxkKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEZp\nZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgaWYgKGZtZC5nZXRNYW5hZ2Vt\nZW50KCkgIT0gZm1kLk1BTkFHRV9QRVJTSVNURU5UKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIGludCBpbmRleCA9IGZtZC5nZXRJbmRleCgpOwog\nICAgICAgIE9iamVjdCB2YWwgPSB0b0RhdGEoZm1kLCBzbS5mZXRjaEZpZWxk\nKGluZGV4LCBmYWxzZSksCiAgICAgICAgICAgIHNtLmdldENvbnRleHQoKSk7\nCiAgICAgICAgaWYgKHZhbCAhPSBOVUxMKQogICAgICAgICAgICBzZXREYXRh\nKGluZGV4LCB2YWwpOwogICAgICAgIGVsc2UgLy8gdW5hYmxlIHRvIHN0b3Jl\nIGZpZWxkIHZhbHVlOyBjbGVhciBvdXQgYW55IG9sZCB2YWx1ZXMKICAgICAg\nICAgICAgY2xlYXJEYXRhKGluZGV4KTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFN0b3JlIHRoZSBpbnRlcm1lZGlhdGUgZmllbGQgdmFsdWUgZm9yIHRoZSBn\naXZlbiBmaWVsZC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc3RvcmVJ\nbnRlcm1lZGlhdGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAgICBG\naWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAgIGludCBpbmRleCA9IGZtZC5n\nZXRJbmRleCgpOwogICAgICAgIE9iamVjdCB2YWwgPSBzbS5nZXRJbnRlcm1l\nZGlhdGUoaW5kZXgpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAg\nICAgICAgc2V0SW50ZXJtZWRpYXRlKGluZGV4LCB2YWwpOwogICAgfQoKICAg\nIC8qKgogICAgICogU3RvcmUgaW1wbCBkYXRhIGZvciB0aGUgZ2l2ZW4gZmll\nbGQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0b3JlSW1wbERhdGEo\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgRmllbGRNZXRhRGF0YSBmbWQsCiAg\nICAgICAgYm9vbGVhbiBmaWVsZExvYWRlZCkgewogICAgICAgIGludCBpbmRl\neCA9IGZtZC5nZXRJbmRleCgpOwogICAgICAgIGlmIChmaWVsZExvYWRlZCkg\newogICAgICAgICAgICAvLyBpcyB0aGVyZSBpbXBsIGRhdGEgdG8gc3RvcmU/\nCiAgICAgICAgICAgIE9iamVjdCBpbXBsID0gc20uZ2V0SW1wbERhdGEoaW5k\nZXgpOwogICAgICAgICAgICBpZiAoaW1wbCAhPSBudWxsICYmIHNtLmlzSW1w\nbERhdGFDYWNoZWFibGUoaW5kZXgpKQogICAgICAgICAgICAgICAgc2V0SW1w\nbERhdGEoaW5kZXgsIGltcGwpOwogICAgICAgIH0gZWxzZQogICAgICAgICAg\nICBzZXRJbXBsRGF0YShpbmRleCwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gYSBuZXcge0BsaW5rIFBDRGF0YX0gaW1wbGVtZW50YXRp\nb24gb2YgdGhlIHJpZ2h0IHR5cGUgZm9yCiAgICAgKiBlbWJlZGRlZCBpbnN0\nYW5jZXMuIFJldHVybnMgYSB7QGxpbmsgUENEYXRhSW1wbH0gYnkgZGVmYXVs\ndC4KICAgICAqLwogICAgcHVibGljIEFic3RyYWN0UENEYXRhIG5ld0VtYmVk\nZGVkUENEYXRhKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBy\nZXR1cm4gbmV3IFBDRGF0YUltcGwoc20uZ2V0SWQgKCksIHNtLmdldE1ldGFE\nYXRhICgpKTsKCX0KfQo=\n","encoding":"base64"}

