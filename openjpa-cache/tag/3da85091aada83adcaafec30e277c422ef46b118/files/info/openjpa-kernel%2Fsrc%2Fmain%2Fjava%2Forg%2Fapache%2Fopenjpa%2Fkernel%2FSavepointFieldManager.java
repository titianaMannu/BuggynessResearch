{"sha":"6980b455a0494c48e4870d331c7543e4bc0a9486","node_id":"MDQ6QmxvYjIwNjM2NDo2OTgwYjQ1NWEwNDk0YzQ4ZTQ4NzBkMzMxYzc1NDNlNGJjMGE5NDg2","size":7298,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6980b455a0494c48e4870d331c7543e4bc0a9486","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5CaXRTZXQ7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsK\naW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51dGlsLk1hcDsK\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5j\nZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmll\nbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkph\ndmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVy\nbmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nUHJveHlNYW5hZ2VyOwoKLyoqCiAqIEZpZWxkTWFuYWdlciB0eXBlIHVzZWQg\ndG8gc3RvcmUgaW5mb3JtYXRpb24gZm9yIHNhdmVwb2ludCByb2xsYmFjay4K\nICoKICogQGF1dGhvciBTdGV2ZSBLaW0KICogQHNpbmNlIDAuMy40CiAqLwpj\nbGFzcyBTYXZlcG9pbnRGaWVsZE1hbmFnZXIKICAgIGV4dGVuZHMgQ2xlYXJG\naWVsZE1hbmFnZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoU2F2\nZXBvaW50RmllbGRNYW5hZ2VyLmNsYXNzKTsKCiAgICBwcml2YXRlIGZpbmFs\nIFN0YXRlTWFuYWdlckltcGwgX3NtOwogICAgcHJpdmF0ZSBmaW5hbCBCaXRT\nZXQgX2xvYWRlZDsKICAgIHByaXZhdGUgZmluYWwgQml0U2V0IF9kaXJ0eTsK\nICAgIHByaXZhdGUgZmluYWwgQml0U2V0IF9mbHVzaDsKICAgIHByaXZhdGUg\nZmluYWwgUENTdGF0ZSBfc3RhdGU7CiAgICBwcml2YXRlIFBlcnNpc3RlbmNl\nQ2FwYWJsZSBfY29weTsKCiAgICBwcml2YXRlIGZpbmFsIE9iamVjdCBfdmVy\nc2lvbjsKICAgIHByaXZhdGUgZmluYWwgT2JqZWN0IF9sb2FkVmVyc2lvbjsK\nCiAgICAvLyB1c2VkIHRvIHRyYWNrIGZpZWxkIHZhbHVlIGR1cmluZyBzdG9y\nZS9mZXRjaCBjeWNsZQogICAgcHJpdmF0ZSBPYmplY3QgX2ZpZWxkID0gbnVs\nbDsKICAgIHByaXZhdGUgaW50W10gX2NvcHlGaWVsZCA9IG51bGw7CiAgICBw\ncml2YXRlIEJpdFNldCBfbXV0YWJsZTsKCiAgICAvKioKICAgICAqIENvbnN0\ncnVjdG9yLiBQcm92aWRlIGluc3RhbmNlIHRvIHNhdmUgYW5kIGluZGljYXRl\nIHdoZXRoZXIKICAgICAqIHRvIGNvcHkgcGVyc2lzdGVudCBmaWVsZHMuIFRy\nYW5zYWN0aW9uYWwgZmllbGRzIHdpbGwgYmUKICAgICAqIGNvcGllZCByZWdh\ncmRsZXNzIG9mIGNvcHkgc2V0dGluZy4KICAgICAqLwogICAgcHVibGljIFNh\ndmVwb2ludEZpZWxkTWFuYWdlcihTdGF0ZU1hbmFnZXJJbXBsIHNtLCBib29s\nZWFuIGNvcHkpIHsKICAgICAgICBfc20gPSBzbTsKICAgICAgICBfc3RhdGUg\nPSBfc20uZ2V0UENTdGF0ZSgpOwoKICAgICAgICBfZGlydHkgPSAoQml0U2V0\nKSBfc20uZ2V0RGlydHkoKS5jbG9uZSgpOwogICAgICAgIF9mbHVzaCA9IChC\naXRTZXQpIF9zbS5nZXRGbHVzaGVkKCkuY2xvbmUoKTsKICAgICAgICBfbG9h\nZGVkID0gKEJpdFNldCkgX3NtLmdldExvYWRlZCgpLmNsb25lKCk7CgogICAg\nICAgIEZpZWxkTWV0YURhdGFbXSBmaWVsZHMgPSBfc20uZ2V0TWV0YURhdGEo\nKS5nZXRGaWVsZHMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9s\nb2FkZWQubGVuZ3RoKCk7IGkrKykgewogICAgICAgICAgICBpZiAoIV9sb2Fk\nZWQuZ2V0KGkpKQogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAg\nICAgIGlmIChjb3B5IHx8IGZpZWxkc1tpXS5nZXRNYW5hZ2VtZW50KCkgPT0K\nICAgICAgICAgICAgICAgIEZpZWxkTWV0YURhdGEuTUFOQUdFX1RSQU5TQUNU\nSU9OQUwpIHsKICAgICAgICAgICAgICAgIGlmIChfY29weSA9PSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIF9jb3B5ID0gX3NtLmdldFBlcnNpc3RlbmNl\nQ2FwYWJsZSgpLnBjTmV3SW5zdGFuY2UKICAgICAgICAgICAgICAgICAgICAg\nICAgKF9zbSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBzdG9yZUZpZWxkKGZp\nZWxkc1tpXSk7CiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAg\nX2xvYWRlZC5jbGVhcihpKTsKICAgICAgICB9CgogICAgICAgIC8vIHdlIG5l\nZWQgdG8gcHJveHkgdGhlIGZpZWxkcyBzbyB0aGF0IHdlIGNhbiB0cmFjayBm\ndXR1cmUgY2hhbmdlcwogICAgICAgIC8vIGZyb20gdGhpcyBzYXZlcG9pbnQg\nZm9yd2FyZCBmb3IgUE5ldyBpbnN0YW5jZXMnIG11dGFibGUgZmllbGRzCiAg\nICAgICAgX3NtLnByb3h5RmllbGRzKGZhbHNlLCBmYWxzZSk7CgogICAgICAg\nIF92ZXJzaW9uID0gX3NtLmdldFZlcnNpb24gKCk7CiAgICAgICAgX2xvYWRW\nZXJzaW9uID0gX3NtLmdldExvYWRWZXJzaW9uICgpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBzdGF0ZSBtYW5hZ2VyIHRoYXQgdGhpcyBt\nYW5hZ2VyIGlzIGFzc29jaWF0ZWQgd2l0aC4KICAgICAqLwogICAgcHVibGlj\nIFN0YXRlTWFuYWdlckltcGwgZ2V0U3RhdGVNYW5hZ2VyKCkgewogICAgICAg\nIHJldHVybiBfc207CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRWZXJz\naW9uKCkgewogICAgICAgIHJldHVybiBfdmVyc2lvbjsKICAgIH0KCiAgICBw\ndWJsaWMgT2JqZWN0IGdldExvYWRWZXJzaW9uKCkgewogICAgICAgIHJldHVy\nbiBfbG9hZFZlcnNpb247CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIHBlcnNpc3RlbmNlIGNhcGFibGUgY29weSBob2xkaW5nIHRoZSBzYXZl\ncG9pbnQgZmllbGQgdmFsdWVzLgogICAgICovCiAgICBwdWJsaWMgUGVyc2lz\ndGVuY2VDYXBhYmxlIGdldENvcHkoKSB7CiAgICAgICAgcmV0dXJuIF9jb3B5\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzYXZlZCB7QGxp\nbmsgUENTdGF0ZX0KICAgICAqLwogICAgcHVibGljIFBDU3RhdGUgZ2V0UENT\ndGF0ZSgpIHsKICAgICAgICByZXR1cm4gX3N0YXRlOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBmaWVsZHMgc3RvcmVkIGluIHRoaXMgbWFu\nYWdlci4KICAgICAqLwogICAgcHVibGljIEJpdFNldCBnZXRMb2FkZWQoKSB7\nCiAgICAgICAgcmV0dXJuIF9sb2FkZWQ7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIGRpcnR5IGZpZWxkcyBkdXJpbmcgdGhlIHNhdmVkIHN0\nYXRlLgogICAgICovCiAgICBwdWJsaWMgQml0U2V0IGdldERpcnR5KCkgewog\nICAgICAgIHJldHVybiBfZGlydHk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGZsdXNoZWQgZmllbGRzIGR1cmluZyB0aGUgc2F2ZWQgc3Rh\ndGUuCiAgICAgKi8KICAgIHB1YmxpYyBCaXRTZXQgZ2V0Rmx1c2hlZCgpIHsK\nICAgICAgICByZXR1cm4gX2ZsdXNoOwogICAgfQoKICAgIC8qKgogICAgICog\nU3RvcmUgdGhlIGRhdGEgZm9yIHRoZSBnaXZlbiBmaWVsZC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc3RvcmVGaWVsZChGaWVsZE1ldGFEYXRhIGZpZWxk\nKSB7CiAgICAgICAgc3dpdGNoIChmaWVsZC5nZXREZWNsYXJlZFR5cGVDb2Rl\nKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuREFURToKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLk1BUDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgog\nICAgICAgICAgICAgICAgaWYgKF9tdXRhYmxlID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgX211dGFibGUgPSBuZXcgQml0U2V0KF9zbS5nZXRNZXRh\nRGF0YSgpLmdldEZpZWxkcygpLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBf\nbXV0YWJsZS5zZXQoZmllbGQuZ2V0SW5kZXgoKSk7CiAgICAgICAgfQogICAg\nICAgIGlmIChfbXV0YWJsZSA9PSBudWxsIHx8ICFfbXV0YWJsZS5nZXQoZmll\nbGQuZ2V0SW5kZXgoKSkpIHsKICAgICAgICAgICAgLy8gaW1tdXRhYmxlIGZp\nZWxkcyBjYW4ganVzdCBiZSBjb3BpZWQgb3ZlcgogICAgICAgICAgICBpZiAo\nX2NvcHlGaWVsZCA9PSBudWxsKQogICAgICAgICAgICAgICAgX2NvcHlGaWVs\nZCA9IG5ldyBpbnRbMV07CiAgICAgICAgICAgIF9jb3B5RmllbGRbMF0gPSBm\naWVsZC5nZXRJbmRleCgpOwogICAgICAgICAgICBfY29weS5wY0NvcHlGaWVs\nZHMoX3NtLmdldFBlcnNpc3RlbmNlQ2FwYWJsZSgpLCBfY29weUZpZWxkKTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfc20ucHJvdmlkZUZpZWxk\nKF9zbS5nZXRQZXJzaXN0ZW5jZUNhcGFibGUoKSwgdGhpcywKICAgICAgICAg\nICAgICAgIGZpZWxkLmdldEluZGV4KCkpOwogICAgICAgICAgICBfc20ucmVw\nbGFjZUZpZWxkKF9jb3B5LCB0aGlzLCBmaWVsZC5nZXRJbmRleCgpKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXN0b3JlIHRoZSBnaXZl\nbiBmaWVsZC4gSWYgdGhpcyBtZXRob2QgcmV0dXJucyB0cnVlLCB0aGVuIHlv\ndSBuZWVkCiAgICAgKiB0byB1c2UgdGhpcyBmaWVsZCBtYW5hZ2VyIHRvIHJl\ncGxhY2UgdGhlIGdpdmVuIGZpZWxkIGluIHRoZSBzdGF0ZQogICAgICogbWFu\nYWdlcidzIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBy\nZXN0b3JlRmllbGQoaW50IGZpZWxkKSB7CiAgICAgICAgaWYgKCFfbG9hZGVk\nLmdldChmaWVsZCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICBpZiAoX211dGFibGUgIT0gbnVsbCAmJiBfbXV0YWJsZS5nZXQoZmllbGQp\nKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgLy8gY29weSB0\naGUgc2F2ZWQgZmllbGQgb3ZlcgogICAgICAgIGlmIChfY29weUZpZWxkID09\nIG51bGwpCiAgICAgICAgICAgIF9jb3B5RmllbGQgPSBuZXcgaW50WzFdOwog\nICAgICAgIF9jb3B5RmllbGRbMF0gPSBmaWVsZDsKICAgICAgICBfc20uZ2V0\nUGVyc2lzdGVuY2VDYXBhYmxlKCkucGNDb3B5RmllbGRzKF9jb3B5LCBfY29w\neUZpZWxkKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBmZXRjaE9iamVjdEZpZWxkKGludCBmaWVsZCkgewogICAg\nICAgIC8vIHJldHVybiB0aGUgY29waWVkIGZpZWxkIGR1cmluZyBzYXZlLCBv\nciBhIG51bGwgdmFsdWUgZHVyaW5nIHJlc3RvcmUKICAgICAgICBPYmplY3Qg\ndmFsID0gX2ZpZWxkOwogICAgICAgIF9maWVsZCA9IG51bGw7CiAgICAgICAg\ncmV0dXJuIHZhbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdG9yZU9iamVj\ndEZpZWxkKGludCBmaWVsZCwgT2JqZWN0IGN1clZhbCkgewogICAgICAgIC8v\nIGNvcHkgbXV0YWJsZSBmaWVsZHMKICAgICAgICBQcm94eU1hbmFnZXIgcHJv\neHkgPSBfc20uZ2V0Q29udGV4dCgpLmdldENvbmZpZ3VyYXRpb24oKS4KICAg\nICAgICAgICAgZ2V0UHJveHlNYW5hZ2VySW5zdGFuY2UoKTsKICAgICAgICBG\naWVsZE1ldGFEYXRhIGZtZCA9IF9zbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxk\nKGZpZWxkKTsKICAgICAgICBzd2l0Y2ggKGZtZC5nZXREZWNsYXJlZFR5cGVD\nb2RlKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAg\nICAgICAgICAgICAgICBfZmllbGQgPSBwcm94eS5jb3B5QXJyYXkoY3VyVmFs\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICAgICAgX2ZpZWxkID0g\ncHJveHkuY29weUNvbGxlY3Rpb24oKENvbGxlY3Rpb24pIGN1clZhbCk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuTUFQOgogICAgICAgICAgICAgICAgX2ZpZWxkID0gcHJveHkuY29weU1h\ncCgoTWFwKSBjdXJWYWwpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkRBVEU6CiAgICAgICAgICAgICAgICBf\nZmllbGQgPSBwcm94eS5jb3B5RGF0ZSgoRGF0ZSkgY3VyVmFsKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5P\nQkpFQ1Q6CiAgICAgICAgICAgICAgICBfZmllbGQgPSBwcm94eS5jb3B5Q3Vz\ndG9tKGN1clZhbCk7CiAgICAgICAgICAgICAgICBpZiAoX2ZpZWxkID09IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgX2ZpZWxkID0gY3VyVmFsOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICBfZmllbGQgPSBjdXJWYWw7CiAgICAgICAgfQoKICAgICAg\nICAvLyBpZiB3ZSBjb3VsZG4ndCBnZXQgYSBjb3B5IG9mIHRoZSBzY28sIGFj\ndCBsaWtlIGl0IHdhc24ndCBzYXZlZAogICAgICAgIC8vIHNob3VsZCB0aHJv\ndyBhbiBleGNlcHRpb24KICAgICAgICBpZiAoY3VyVmFsICE9IG51bGwgJiYg\nX2ZpZWxkID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5h\nbEV4Y2VwdGlvbihfbG9jLmdldCgibm8tc2F2ZXBvaW50LWNvcHkiLCBmbWQp\nKTsKCX0KfQo=\n","encoding":"base64"}

