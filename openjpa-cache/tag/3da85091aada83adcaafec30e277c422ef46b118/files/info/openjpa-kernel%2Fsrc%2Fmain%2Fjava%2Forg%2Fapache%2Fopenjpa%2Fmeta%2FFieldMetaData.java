{"sha":"14ce57d08b988706fe40c37371416095868b4430","node_id":"MDQ6QmxvYjIwNjM2NDoxNGNlNTdkMDhiOTg4NzA2ZmU0MGMzNzM3MTQxNjA5NTg2OGI0NDMw","size":63888,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/14ce57d08b988706fe40c37371416095868b4430","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkV4dGVybmFsaXphYmxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXQ7CmltcG9ydCBqYXZhLmlv\nLk9iamVjdE91dHB1dDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkNvbnN0\ncnVjdG9yOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9y\ndCBqYXZhLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWVtYmVyOwppbXBvcnQgamF2\nYS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5sYW5nLnJlZmxl\nY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBq\nYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuVGltZVpvbmU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmNvbXBhcmF0\nb3JzLkNvbXBhcmF0b3JDaGFpbjsKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlQ29udGV4\ndDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1\ncmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KYXZhVmVy\nc2lvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9w\ndGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnhtbC5Db21t\nZW50YWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2Vw\ndGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5h\nbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1l\ndGFEYXRhRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLlVuc3VwcG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGls\nLlN0cmluZ3M7CgovKioKICogTWV0YWRhdGEgZm9yIGEgbWFuYWdlZCBjbGFz\ncyBmaWVsZC4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBj\nbGFzcyBGaWVsZE1ldGFEYXRhCiAgICBleHRlbmRzIEV4dGVuc2lvbnMKICAg\nIGltcGxlbWVudHMgVmFsdWVNZXRhRGF0YSwgTWV0YURhdGFDb250ZXh0LCBN\nZXRhRGF0YU1vZGVzLCBDb21tZW50YWJsZSB7CiAgICAKICAgIC8qKgogICAg\nICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGF0IG5vIG51bGwtdmFsdWUgd2Fz\nIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBO\nVUxMX1VOU0VUID0gLTE7CgogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVj\naWZ5aW5nIHRvIHVzZSBhIGRhdGFzdG9yZSBudWxsIHRvIHBlcnNpc3QgbnVs\nbCB2YWx1ZXMKICAgICAqIGluIG9iamVjdCBmaWVsZHMuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE5VTExfTk9ORSA9IDA7CgogICAg\nLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHVzZSBhIGRhdGFz\ndG9yZSBkZWZhdWx0IHZhbHVlIHRvIHBlcnNpc3QgbnVsbAogICAgICogdmFs\ndWVzIGluIG9iamVjdCBmaWVsZHMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IE5VTExfREVGQVVMVCA9IDE7CgogICAgLyoqCiAgICAg\nKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHRocm93IGFuIGV4Y2VwdGlvbiB3\naGVuIGF0dGVtcHRpbmcgdG8gcGVyc2lzdAogICAgICogbnVsbCB2YWx1ZXMg\naW4gb2JqZWN0IGZpZWxkcy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBpbnQgTlVMTF9FWENFUFRJT04gPSAyOwoKICAgIC8qKgogICAgICog\nQ29uc3RhbnQgc3BlY2lmeWluZyB0aGUgbWFuYWdlbWVudCBsZXZlbCBvZiBh\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBN\nQU5BR0VfUEVSU0lTVEVOVCA9IDM7CgogICAgLyoqCiAgICAgKiBDb25zdGFu\ndCBzcGVjaWZ5aW5nIHRoZSBtYW5hZ2VtZW50IGxldmVsIG9mIGEgZmllbGQu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1BTkFHRV9U\nUkFOU0FDVElPTkFMID0gMTsKCiAgICAvKioKICAgICAqIENvbnN0YW50IHNw\nZWNpZnlpbmcgdGhlIG1hbmFnZW1lbnQgbGV2ZWwgb2YgYSBmaWVsZC4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTUFOQUdFX05PTkUg\nPSAwOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoRmllbGRNZXRhRGF0\nYS5jbGFzcyk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IERGR19G\nQUxTRSA9IDE7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREZHX1RS\nVUUgPSAyOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IERGR19FWFBM\nSUNJVCA9IDQ7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWV0aG9kIERF\nRkFVTFRfTUVUSE9EOwogICAgc3RhdGljIHsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBERUZBVUxUX01FVEhPRCA9IE9iamVjdC5jbGFzcy5nZXRNZXRo\nb2QoIndhaXQiLCAoQ2xhc3NbXSkgbnVsbCk7CiAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gc2hvdWxkbid0IGV2ZXIg\naGFwcGVuCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlv\nbihlKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gbmFtZSBhbmQgdHlwZQog\nICAgcHJpdmF0ZSBmaW5hbCBWYWx1ZU1ldGFEYXRhIF92YWw7CiAgICBwcml2\nYXRlIGZpbmFsIFZhbHVlTWV0YURhdGEgX2tleTsKICAgIHByaXZhdGUgZmlu\nYWwgVmFsdWVNZXRhRGF0YSBfZWxlbTsKICAgIHByaXZhdGUgZmluYWwgQ2xh\nc3NNZXRhRGF0YSBfb3duZXI7CiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyBf\nbmFtZTsKICAgIHByaXZhdGUgQ2xhc3MgX2RlYyA9IG51bGw7CiAgICBwcml2\nYXRlIENsYXNzTWV0YURhdGEgX2RlY01ldGEgPSBudWxsOwogICAgcHJpdmF0\nZSBTdHJpbmcgX2Z1bGxOYW1lID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5n\nIF9lbWJlZEZ1bGxOYW1lID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9yZXNN\nb2RlID0gTU9ERV9OT05FOwoKICAgIC8vIGxvYWQvc3RvcmUgaW5mbwogICAg\ncHJpdmF0ZSBTdHJpbmdbXSBfY29tbWVudHMgPSBudWxsOwogICAgcHJpdmF0\nZSBpbnQgX2xpc3RJbmRleCA9IC0xOwoKICAgIC8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vCiAgICAvLyBOb3RlOiBpZiB5b3UgYWRkIGFkZGl0aW9uYWwgc3Rh\ndGUsIG1ha2Ugc3VyZSB0byBhZGQgaXQgdG8gY29weSgpCiAgICAvLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8vIG1pc2MgaW5mbwogICAgcHJpdmF0\nZSBDbGFzcyBfcHJveHlDbGFzcyA9IG51bGw7CiAgICBwcml2YXRlIE9iamVj\ndCBfaW5pdGlhbGl6ZXIgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF90\ncmFuc2llbnQgPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfcHJpbUtl\neSA9IGZhbHNlOwogICAgcHJpdmF0ZSBCb29sZWFuIF92ZXJzaW9uID0gbnVs\nbDsKICAgIHByaXZhdGUgaW50IF9udWxsVmFsdWUgPSBOVUxMX1VOU0VUOwog\nICAgcHJpdmF0ZSBpbnQgX21hbmFnZSA9IE1BTkFHRV9QRVJTSVNURU5UOwog\nICAgcHJpdmF0ZSBpbnQgX2luZGV4ID0gLTE7CiAgICBwcml2YXRlIGludCBf\nZGVjSW5kZXggPSAtMTsKICAgIHByaXZhdGUgaW50IF9wa0luZGV4ID0gLTE7\nCiAgICBwcml2YXRlIGJvb2xlYW4gX2V4cGxpY2l0ID0gZmFsc2U7CiAgICBw\ncml2YXRlIGludCBfZGZnID0gMDsKICAgIHByaXZhdGUgU2V0IF9mZ1NldCA9\nIG51bGw7CiAgICBwcml2YXRlIFN0cmluZ1tdIF9mZ3MgPSBudWxsOwogICAg\ncHJpdmF0ZSBTdHJpbmcgICBfbGZnID0gbnVsbDsKICAgIHByaXZhdGUgQm9v\nbGVhbiBfbHJzID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9leHROYW1l\nID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9mYWN0TmFtZSA9IG51bGw7\nCiAgICBwcml2YXRlIFN0cmluZyBfZXh0U3RyaW5nID0gbnVsbDsKICAgIHBy\naXZhdGUgTWFwIF9leHRWYWx1ZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9NQVA7\nCiAgICBwcml2YXRlIE1hcCBfZmllbGRWYWx1ZXMgPSBDb2xsZWN0aW9ucy5F\nTVBUWV9NQVA7CgogICAgLy8gTWVtYmVycyBhcmVuJ3Qgc2VyaWFsaXphYmxl\nLiBVc2UgYSBwcm94eSB0aGF0IGNhbiBwcm92aWRlIGEgTWVtYmVyCiAgICAv\nLyB0byBhdm9pZCB3cml0aW5nIHRoZSBmdWxsIEV4dGVybmFsaXphYmxlIGlt\ncGxlbWVudGF0aW9uLgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTWVtYmVyUHJv\ndmlkZXIgX2JhY2tpbmdNZW1iZXIgPSBudWxsOwogICAgCiAgICAvLyBNZW1i\nZXJzIGFyZW4ndCBzZXJpYWxpemFibGUuIEluaXRpYWxpemluZyBfZXh0TWV0\naG9kIGFuZCBfZmFjdE1ldGhvZCB0byAKICAgIC8vIERFRkFVTFRfTUVUSE9E\nIGlzIHN1ZmZpY2llbnQgdG8gdHJpZ2dlciBsYXp5IHBvcHVsYXRpb24gb2Yg\ndGhlc2UgZmllbGRzLgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTWV0aG9kIF9l\neHRNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAgIHByaXZhdGUgdHJhbnNp\nZW50IE1lbWJlciBfZmFjdE1ldGhvZCA9IERFRkFVTFRfTUVUSE9EOwoKICAg\nIC8vIGludGVybWVkaWF0ZSBhbmQgaW1wbCBkYXRhCiAgICBwcml2YXRlIGJv\nb2xlYW4gX2ludGVybWVkaWF0ZSA9IHRydWU7CiAgICBwcml2YXRlIEJvb2xl\nYW4gX2ltcGxEYXRhID0gQm9vbGVhbi5UUlVFOwoKICAgIC8vIHZhbHVlIGdl\nbmVyYXRpb24KICAgIHByaXZhdGUgaW50IF92YWxTdHJhdGVneSA9IC0xOwog\nICAgcHJpdmF0ZSBpbnQgX3VwU3RyYXRlZ3kgPSAtMTsKICAgIHByaXZhdGUg\nU3RyaW5nIF9zZXFOYW1lID0gQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklO\nRzsKICAgIHByaXZhdGUgU2VxdWVuY2VNZXRhRGF0YSBfc2VxTWV0YSA9IG51\nbGw7CgogICAgLy8gaW52ZXJzZXMKICAgIHByaXZhdGUgU3RyaW5nIF9tYXBw\nZWRCeSA9IG51bGw7CiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGEgX21hcHBl\nZEJ5TWV0YSA9IG51bGw7CiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGFbXSBf\naW52ZXJzZXMgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2ludmVyc2Ug\nPSBDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5HOwoKICAgIC8vIG9yZGVy\naW5nIG9uIGxvYWQKICAgIHByaXZhdGUgT3JkZXJbXSBfb3JkZXJzID0gbnVs\nbDsKICAgIHByaXZhdGUgU3RyaW5nIF9vcmRlckRlYyA9IG51bGw7CgogICAg\nLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4KICAgICAqCiAgICAgKiBAcGFyYW0g\nbmFtZSB0aGUgZmllbGQgbmFtZQogICAgICogQHBhcmFtIHR5cGUgdGhlIGZp\nZWxkIHR5cGUKICAgICAqIEBwYXJhbSBvd25lciB0aGUgb3duaW5nIGNsYXNz\nIG1ldGFkYXRhCiAgICAgKi8KICAgIHByb3RlY3RlZCBGaWVsZE1ldGFEYXRh\nKFN0cmluZyBuYW1lLCBDbGFzcyB0eXBlLCBDbGFzc01ldGFEYXRhIG93bmVy\nKSB7CiAgICAgICAgX25hbWUgPSBuYW1lOwogICAgICAgIF9vd25lciA9IG93\nbmVyOwogICAgICAgIF9kZWMgPSBudWxsOwogICAgICAgIF9kZWNNZXRhID0g\nbnVsbDsKICAgICAgICBfdmFsID0gb3duZXIuZ2V0UmVwb3NpdG9yeSgpLm5l\nd1ZhbHVlTWV0YURhdGEodGhpcyk7CiAgICAgICAgX2tleSA9IG93bmVyLmdl\ndFJlcG9zaXRvcnkoKS5uZXdWYWx1ZU1ldGFEYXRhKHRoaXMpOwogICAgICAg\nIF9lbGVtID0gb3duZXIuZ2V0UmVwb3NpdG9yeSgpLm5ld1ZhbHVlTWV0YURh\ndGEodGhpcyk7CgogICAgICAgIHNldERlY2xhcmVkVHlwZSh0eXBlKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFN1cHBseSB0aGUgYmFja2luZyBtZW1iZXIg\nb2JqZWN0OyB0aGlzIGFsbG93cyB1cyB0byB1dGlsaXplCiAgICAgKiBwYXJh\nbWV0ZXJpemVkIHR5cGUgaW5mb3JtYXRpb24gaWYgYXZhaWxhYmxlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBiYWNraW5nTWVtYmVyKE1lbWJlciBtZW1i\nZXIpIHsKICAgICAgICBpZiAobWVtYmVyID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBpZiAoTW9kaWZpZXIuaXNUcmFuc2llbnQobWVt\nYmVyLmdldE1vZGlmaWVycygpKSkKICAgICAgICAgICAgX3RyYW5zaWVudCA9\nIHRydWU7CgogICAgICAgIF9iYWNraW5nTWVtYmVyID0gbmV3IE1lbWJlclBy\nb3ZpZGVyKG1lbWJlcik7CgogICAgICAgIENsYXNzIHR5cGU7CiAgICAgICAg\nQ2xhc3NbXSB0eXBlczsKICAgICAgICBpZiAobWVtYmVyIGluc3RhbmNlb2Yg\nRmllbGQpIHsKICAgICAgICAgICAgRmllbGQgZiA9IChGaWVsZCkgbWVtYmVy\nOwogICAgICAgICAgICB0eXBlID0gZi5nZXRUeXBlKCk7CiAgICAgICAgICAg\nIHR5cGVzID0gSmF2YVZlcnNpb25zLmdldFBhcmFtZXRlcml6ZWRUeXBlcyhm\nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBNZXRob2QgbWV0aCA9\nIChNZXRob2QpIG1lbWJlcjsKICAgICAgICAgICAgdHlwZSA9IG1ldGguZ2V0\nUmV0dXJuVHlwZSgpOwogICAgICAgICAgICB0eXBlcyA9IEphdmFWZXJzaW9u\ncy5nZXRQYXJhbWV0ZXJpemVkVHlwZXMobWV0aCk7CiAgICAgICAgfQoKICAg\nICAgICBzZXREZWNsYXJlZFR5cGUodHlwZSk7CiAgICAgICAgaWYgKENvbGxl\nY3Rpb24uY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBlKQogICAgICAgICAg\nICAmJiBfZWxlbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmplY3QuY2xhc3MK\nICAgICAgICAgICAgJiYgdHlwZXMubGVuZ3RoID09IDEpIHsKICAgICAgICAg\nICAgX2VsZW0uc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzBdKTsKICAgICAgICB9\nIGVsc2UgaWYgKE1hcC5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUpCiAg\nICAgICAgICAgICYmIHR5cGVzLmxlbmd0aCA9PSAyKSB7CiAgICAgICAgICAg\nIGlmIChfa2V5LmdldERlY2xhcmVkVHlwZSgpID09IE9iamVjdC5jbGFzcykK\nICAgICAgICAgICAgICAgIF9rZXkuc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzBd\nKTsKICAgICAgICAgICAgaWYgKF9lbGVtLmdldERlY2xhcmVkVHlwZSgpID09\nIE9iamVjdC5jbGFzcykKICAgICAgICAgICAgICAgIF9lbGVtLnNldERlY2xh\ncmVkVHlwZSh0eXBlc1sxXSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBiYWNraW5nIG1lbWJlciBzdXBwbGllZCBpbiB7\nQGxpbmsgI2JhY2tpbmdNZW1iZXJ9LgogICAgICovCiAgICBwdWJsaWMgTWVt\nYmVyIGdldEJhY2tpbmdNZW1iZXIoKSB7CiAgICAgICAgcmV0dXJuIChfYmFj\na2luZ01lbWJlciA9PSBudWxsKSA/IG51bGwgOiBfYmFja2luZ01lbWJlci5n\nZXRNZW1iZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBtZXRhZGF0\nYSByZXBvc2l0b3J5LgogICAgICovCiAgICBwdWJsaWMgTWV0YURhdGFSZXBv\nc2l0b3J5IGdldFJlcG9zaXRvcnkoKSB7CiAgICAgICAgcmV0dXJuIF9vd25l\nci5nZXRSZXBvc2l0b3J5KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUg\nY2xhc3MgdGhhdCBkZWZpbmVzIHRoZSBtZXRhZGF0YSBmb3IgdGhpcyBmaWVs\nZC4KICAgICAqLwogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0RGVmaW5p\nbmdNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX293bmVyOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIGRlY2xhcmluZyBjbGFzcy4KICAgICAqLwog\nICAgcHVibGljIENsYXNzIGdldERlY2xhcmluZ1R5cGUoKSB7CiAgICAgICAg\ncmV0dXJuIChfZGVjID09IG51bGwpID8gX293bmVyLmdldERlc2NyaWJlZFR5\ncGUoKSA6IF9kZWM7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVjbGFy\naW5nIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREZWNsYXJp\nbmdUeXBlKENsYXNzIGNscykgewogICAgICAgIF9kZWMgPSBjbHM7CiAgICAg\nICAgX2RlY01ldGEgPSBudWxsOwogICAgICAgIF9mdWxsTmFtZSA9IG51bGw7\nCiAgICAgICAgX2VtYmVkRnVsbE5hbWUgPSBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIGRlY2xhcmluZyBjbGFzcy4KICAgICAqLwogICAgcHVi\nbGljIENsYXNzTWV0YURhdGEgZ2V0RGVjbGFyaW5nTWV0YURhdGEoKSB7CiAg\nICAgICAgaWYgKF9kZWMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9v\nd25lcjsKICAgICAgICBpZiAoX2RlY01ldGEgPT0gbnVsbCkKICAgICAgICAg\nICAgX2RlY01ldGEgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0TWV0YURhdGEoX2Rl\nYywKICAgICAgICAgICAgICAgIF9vd25lci5nZXRFbnZDbGFzc0xvYWRlcigp\nLCB0cnVlKTsKICAgICAgICByZXR1cm4gX2RlY01ldGE7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgZmllbGQgbmFtZS4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgIHJldHVybiBfbmFtZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVsZCBuYW1lLCBxdWFsaWZpZWQg\nYnkgdGhlIG93bmluZyBjbGFzcy4KICAgICAqIEBkZXByZWNhdGVkIFVzZSBn\nZXRGdWxsTmFtZShib29sZWFuKSBpbnN0ZWFkLgogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIGdldEZ1bGxOYW1lKCkgewogICAgICAgIHJldHVybiBnZXRG\ndWxsTmFtZShmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmll\nbGQgbmFtZSwgcXVhbGlmaWVkIGJ5IHRoZSBvd25pbmcgY2xhc3MgYW5kIG9w\ndGlvbmFsbHkgdGhlCiAgICAgKiBlbWJlZGRpbmcgb3duZXIncyBuYW1lIChp\nZiBhbnkpLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZ1bGxOYW1l\nKGJvb2xlYW4gZW1iZWRPd25lcikgewogICAgICAgIGlmIChfZnVsbE5hbWUg\nPT0gbnVsbCkKICAgICAgICAgICAgX2Z1bGxOYW1lID0gZ2V0RGVjbGFyaW5n\nVHlwZSgpLmdldE5hbWUoKSArICIuIiArIF9uYW1lOwogICAgICAgIGlmIChl\nbWJlZE93bmVyICYmIF9lbWJlZEZ1bGxOYW1lID09IG51bGwpIHsKICAgICAg\nICAgICAgaWYgKF9vd25lci5nZXRFbWJlZGRpbmdNZXRhRGF0YSgpID09IG51\nbGwpCiAgICAgICAgICAgICAgICBfZW1iZWRGdWxsTmFtZSA9IF9mdWxsTmFt\nZTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2VtYmVkRnVs\nbE5hbWUgPSBfb3duZXIuZ2V0RW1iZWRkaW5nTWV0YURhdGEoKS4KICAgICAg\nICAgICAgICAgICAgICBnZXRGaWVsZE1ldGFEYXRhKCkuZ2V0RnVsbE5hbWUo\ndHJ1ZSkgKyAiLiIgKyBfZnVsbE5hbWU7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiAoZW1iZWRPd25lcikgPyBfZW1iZWRGdWxsTmFtZSA6IF9mdWxsTmFt\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIE1ldGFEYXRhIGFib3V0IHRoZSBm\naWVsZCB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFZhbHVlTWV0YURhdGEg\nZ2V0VmFsdWUoKSB7CiAgICAgICAgcmV0dXJuIF92YWw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBNZXRhZGF0YSBhYm91dCB0aGUga2V5IHZhbHVlLgogICAg\nICovCiAgICBwdWJsaWMgVmFsdWVNZXRhRGF0YSBnZXRLZXkoKSB7CiAgICAg\nICAgcmV0dXJuIF9rZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRhZGF0\nYSBhYm91dCB0aGUgZWxlbWVudCB2YWx1ZS4KICAgICAqLwogICAgcHVibGlj\nIFZhbHVlTWV0YURhdGEgZ2V0RWxlbWVudCgpIHsKICAgICAgICByZXR1cm4g\nX2VsZW07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0\naGlzIGZpZWxkIGlzIG1hcHBlZCB0byB0aGUgZGF0YXN0b3JlLiBCeSBkZWZh\ndWx0LAogICAgICogcmV0dXJucyB0cnVlIGZvciBhbGwgcGVyc2lzdGVudCBm\naWVsZHMgd2hvc2UgZGVmaW5pbmcgY2xhc3MgaXMgbWFwcGVkLgogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc01hcHBlZCgpIHsKICAgICAgICByZXR1\ncm4gX21hbmFnZSA9PSBNQU5BR0VfUEVSU0lTVEVOVCAmJiBfb3duZXIuaXNN\nYXBwZWQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB0eXBlIHRoaXMg\nZmllbGQgd2FzIGluaXRpYWxpemVkIHdpdGgsIGFuZCB0aGVyZWZvcmUgdGhl\nCiAgICAgKiB0eXBlIHRvIHVzZSBmb3IgcHJveGllcyB3aGVuIGxvYWRpbmcg\nZGF0YSBpbnRvIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\ncyBnZXRQcm94eVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIChfcHJveHlDbGFz\ncyA9PSBudWxsKSA/IGdldERlY2xhcmVkVHlwZSgpIDogX3Byb3h5Q2xhc3M7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSB0aGlzIGZpZWxkIHdh\ncyBpbml0aWFsaXplZCB3aXRoLCBhbmQgdGhlcmVmb3JlIHRoZQogICAgICog\ndHlwZSB0byB1c2UgZm9yIHByb3hpZXMgd2hlbiBsb2FkaW5nIGRhdGEgaW50\nbyB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcm94\neVR5cGUoQ2xhc3MgdHlwZSkgewogICAgICAgIF9wcm94eUNsYXNzID0gdHlw\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBpbml0aWFsaXplciB1c2Vk\nIGJ5IHRoZSBmaWVsZCwgb3IgbnVsbCBpZiBub25lLiBUaGlzCiAgICAgKiBp\ncyBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIGZvciBpbml0aWFsaXppbmcgdGhl\nIGZpZWxkLCBzdWNoIGFzCiAgICAgKiBhIGN1c3RvbSB7QGxpbmsgQ29tcGFy\nYXRvcn0gdXNlZCBieSBhIHtAbGluayBTZXR9IG9yCiAgICAgKiBhIHtAbGlu\nayBUaW1lWm9uZX0gdXNlZCBieSBhIHtAbGluayBDYWxlbmRhcn0uCiAgICAg\nKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0SW5pdGlhbGl6ZXIoKSB7CiAgICAg\nICAgcmV0dXJuIF9pbml0aWFsaXplcjsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBpbml0aWFsaXplciB1c2VkIGJ5IHRoZSBmaWVsZCwgb3IgbnVsbCBp\nZiBub25lLiBUaGlzCiAgICAgKiBpcyBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nIGZvciBpbml0aWFsaXppbmcgdGhlIGZpZWxkLCBzdWNoIGFzCiAgICAgKiBh\nIGN1c3RvbSB7QGxpbmsgQ29tcGFyYXRvcn0gdXNlZCBieSBhIHtAbGluayBT\nZXR9IG9yCiAgICAgKiBhIHtAbGluayBUaW1lWm9uZX0gdXNlZCBieSBhIHtA\nbGluayBDYWxlbmRhcn0uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldElu\naXRpYWxpemVyKE9iamVjdCBpbml0aWFsaXplcikgewogICAgICAgIF9pbml0\naWFsaXplciA9IGluaXRpYWxpemVyOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHdoZXRoZXIgdGhpcyBpcyBhIHRyYW5zaWVudCBmaWVsZC4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNUcmFuc2llbnQoKSB7CiAgICAg\nICAgcmV0dXJuIF90cmFuc2llbnQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gd2hldGhlciB0aGlzIGlzIGEgdHJhbnNpZW50IGZpZWxkLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFuc2llbnQoYm9vbGVhbiB0cmFu\ncykgewogICAgICAgIF90cmFuc2llbnQgPSB0cmFuczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBhYnNvbHV0ZSBpbmRleCBvZiB0aGlzIHBlcnNpc3Rl\nbnQvdHJhbnNhY3Rpb25hbCBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRJbmRleCgpIHsKICAgICAgICByZXR1cm4gX2luZGV4OwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIGFic29sdXRlIGluZGV4IG9mIHRoaXMgcGVy\nc2lzdGVudC90cmFuc2FjdGlvbmFsIGZpZWxkLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJbmRleChpbnQgaW5kZXgpIHsKICAgICAgICBfaW5kZXgg\nPSBpbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSByZWxhdGl2ZSBp\nbmRleCBvZiB0aGlzIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25hbCBmaWVsZC4K\nICAgICAqLwogICAgcHVibGljIGludCBnZXREZWNsYXJlZEluZGV4KCkgewog\nICAgICAgIHJldHVybiBfZGVjSW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgcmVsYXRpdmUgaW5kZXggb2YgdGhpcyBwZXJzaXN0ZW50L3RyYW5z\nYWN0aW9uYWwgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERl\nY2xhcmVkSW5kZXgoaW50IGluZGV4KSB7CiAgICAgICAgX2RlY0luZGV4ID0g\naW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgaW5kZXggaW4gd2hp\nY2ggdGhpcyBmaWVsZCB3YXMgbGlzdGVkIGluIHRoZSBtZXRhZGF0YS4gRGVm\nYXVsdHMgdG8KICAgICAqIDxjb2RlPi0xPC9jb2RlPiBpZiB0aGlzIGZpZWxk\nIHdhcyBub3QgbGlzdGVkIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAg\ncHVibGljIGludCBnZXRMaXN0aW5nSW5kZXgoKSB7CiAgICAgICAgcmV0dXJu\nIF9saXN0SW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgaW5kZXgg\naW4gd2hpY2ggdGhpcyBmaWVsZCB3YXMgbGlzdGVkIGluIHRoZSBtZXRhZGF0\nYS4gRGVmYXVsdHMgdG8KICAgICAqIDxjb2RlPi0xPC9jb2RlPiBpZiB0aGlz\nIGZpZWxkIHdhcyBub3QgbGlzdGVkIGluIHRoZSBtZXRhZGF0YS4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0TGlzdGluZ0luZGV4KGludCBpbmRleCkg\newogICAgICAgIF9saXN0SW5kZXggPSBpbmRleDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBhYnNvbHV0ZSBwcmltYXJ5IGtleSBpbmRleCBmb3IgdGhp\ncyBmaWVsZCwgb3IgLTEgaWYgbm90IGEgcHJpbWFyeQogICAgICoga2V5LiBU\naGUgZmlyc3QgcHJpbWFyeSBrZXkgZmllbGQgaGFzIGluZGV4IDAsIHRoZSBz\nZWNvbmQgaW5kZXggMSwgZXRjLgogICAgICovCiAgICBwdWJsaWMgaW50IGdl\ndFByaW1hcnlLZXlJbmRleCgpIHsKICAgICAgICByZXR1cm4gX3BrSW5kZXg7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYWJzb2x1dGUgcHJpbWFyeSBr\nZXkgaW5kZXggZm9yIHRoaXMgZmllbGQsIG9yIC0xIGlmIG5vdCBhIHByaW1h\ncnkKICAgICAqIGtleS4gVGhlIGZpcnN0IHByaW1hcnkga2V5IGZpZWxkIGhh\ncyBpbmRleCAwLCB0aGUgc2Vjb25kIGluZGV4IDEsIGV0Yy4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0UHJpbWFyeUtleUluZGV4KGludCBpbmRleCkg\newogICAgICAgIF9wa0luZGV4ID0gaW5kZXg7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIG1hbmFnZW1lbnQgbGV2ZWwgZm9yIHRoZSBmaWVs\nZC4gV2lsbCBiZSBvbmUgb2Y6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+e0Bs\naW5rICNNQU5BR0VfUEVSU0lTVEVOVH06IHRoZSBmaWVsZCBpcyBwZXJzaXN0\nZW50PC9saT4KICAgICAqIDxsaT57QGxpbmsgI01BTkFHRV9UUkFOU0FDVElP\nTkFMfTogdGhlIGZpZWxkIGlzIHRyYW5zYWN0aW9uYWwgYnV0IG5vdAogICAg\nICogcGVyc2lzdGVudDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0Vf\nTk9ORX06IHRoZSBmaWVsZCBpcyBub3QgbWFuYWdlZDwvbGk+CiAgICAgKiA8\nL3VsPiBEZWZhdWx0cyB0byB7QGxpbmsgI01BTkFHRV9QRVJTSVNURU5UfS4K\nICAgICAqLwogICAgcHVibGljIGludCBnZXRNYW5hZ2VtZW50KCkgewogICAg\nICAgIHJldHVybiBfbWFuYWdlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBtYW5hZ2VtZW50IGxldmVsIGZvciB0aGUgZmllbGQuIFdpbGwg\nYmUgb25lIG9mOgogICAgICogPHVsPgogICAgICogPGxpPntAbGluayAjTUFO\nQUdFX1BFUlNJU1RFTlR9OiB0aGUgZmllbGQgaXMgcGVyc2lzdGVudDwvbGk+\nCiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfVFJBTlNBQ1RJT05BTH06IHRo\nZSBmaWVsZCBpcyB0cmFuc2FjdGlvbmFsIGJ1dCBub3QKICAgICAqIHBlcnNp\nc3RlbnQ8L2xpPgogICAgICogPGxpPntAbGluayAjTUFOQUdFX05PTkV9OiB0\naGUgZmllbGQgaXMgbm90IG1hbmFnZWQ8L2xpPgogICAgICogPC91bD4gCiAg\nICAgKiBEZWZhdWx0cyB0byB7QGxpbmsgI01BTkFHRV9QRVJTSVNURU5UfS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWFuYWdlbWVudChpbnQgbWFu\nYWdlKSB7CiAgICAgICAgaWYgKChfbWFuYWdlID09IE1BTkFHRV9OT05FKSAh\nPSAobWFuYWdlID09IE1BTkFHRV9OT05FKSkKICAgICAgICAgICAgX293bmVy\nLmNsZWFyRmllbGRDYWNoZSgpOwogICAgICAgIF9tYW5hZ2UgPSBtYW5hZ2U7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgaXMgYSBwcmlt\nYXJ5IGtleSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNQ\ncmltYXJ5S2V5KCkgewogICAgICAgIHJldHVybiBfcHJpbUtleTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBpcyBhIHByaW1hcnkga2V5\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcmltYXJ5S2V5\nKGJvb2xlYW4gcHJpbUtleSkgewogICAgICAgIF9wcmltS2V5ID0gcHJpbUtl\neTsKICAgIH0KCiAgICAvKioKICAgICAqIEZvciBhIHByaW1hcnkga2V5IGZp\nZWxkLCByZXR1cm4gdGhlIHR5cGUgb2YgdGhlIGNvcnJlc3BvbmRpbmcgb2Jq\nZWN0IGlkIAogICAgICogY2xhc3MgZmllbGQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBpbnQgZ2V0T2JqZWN0SWRGaWVsZFR5cGVDb2RlKCkgewogICAgICAgIENs\nYXNzTWV0YURhdGEgcmVsbWV0YSA9IGdldERlY2xhcmVkVHlwZU1ldGFEYXRh\nKCk7CiAgICAgICAgaWYgKHJlbG1ldGEgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIGdldERlY2xhcmVkVHlwZUNvZGUoKTsKICAgICAgICBpZiAocmVs\nbWV0YS5nZXRJZGVudGl0eVR5cGUoKSA9PSBDbGFzc01ldGFEYXRhLklEX0RB\nVEFTVE9SRSkgewogICAgICAgICAgICBib29sZWFuIHVud3JhcCA9IGdldFJl\ncG9zaXRvcnkoKS5nZXRNZXRhRGF0YUZhY3RvcnkoKS5nZXREZWZhdWx0cygp\nLgogICAgICAgICAgICAgICAgaXNEYXRhU3RvcmVPYmplY3RJZEZpZWxkVW53\ncmFwcGVkKCk7CiAgICAgICAgICAgIHJldHVybiAodW53cmFwKSA/IEphdmFU\neXBlcy5MT05HIDogSmF2YVR5cGVzLk9CSkVDVDsKICAgICAgICB9CiAgICAg\nICAgaWYgKHJlbG1ldGEuaXNPcGVuSlBBSWRlbnRpdHkoKSkKICAgICAgICAg\nICAgcmV0dXJuIHJlbG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpWzBdLmdl\ndE9iamVjdElkRmllbGRUeXBlQ29kZSgpOwogICAgICAgIHJldHVybiBKYXZh\nVHlwZXMuT0JKRUNUOwogICAgfQoKICAgIC8qKgogICAgICogRm9yIGEgcHJp\nbWFyeSBrZXkgZmllbGQsIHJldHVybiB0aGUgdHlwZSBvZiB0aGUgY29ycmVz\ncG9uZGluZyBvYmplY3QgaWQgCiAgICAgKiBjbGFzcyBmaWVsZC4KICAgICAq\nLwogICAgcHVibGljIENsYXNzIGdldE9iamVjdElkRmllbGRUeXBlKCkgewog\nICAgICAgIENsYXNzTWV0YURhdGEgcmVsbWV0YSA9IGdldERlY2xhcmVkVHlw\nZU1ldGFEYXRhKCk7CiAgICAgICAgaWYgKHJlbG1ldGEgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGdldERlY2xhcmVkVHlwZSgpOwogICAgICAgIHN3\naXRjaCAocmVsbWV0YS5nZXRJZGVudGl0eVR5cGUoKSkgewogICAgICAgICAg\nICBjYXNlIENsYXNzTWV0YURhdGEuSURfREFUQVNUT1JFOgogICAgICAgICAg\nICAgICAgYm9vbGVhbiB1bndyYXAgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0TWV0\nYURhdGFGYWN0b3J5KCkuCiAgICAgICAgICAgICAgICAgICAgZ2V0RGVmYXVs\ndHMoKS5pc0RhdGFTdG9yZU9iamVjdElkRmllbGRVbndyYXBwZWQoKTsKICAg\nICAgICAgICAgICAgIHJldHVybiAodW53cmFwKSA/IGxvbmcuY2xhc3MgOiBP\nYmplY3QuY2xhc3M7CiAgICAgICAgICAgIGNhc2UgQ2xhc3NNZXRhRGF0YS5J\nRF9BUFBMSUNBVElPTjoKICAgICAgICAgICAgICAgIGlmIChyZWxtZXRhLmlz\nT3BlbkpQQUlkZW50aXR5KCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIHJlbG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpWzBdLgogICAgICAgICAg\nICAgICAgICAgICAgICBnZXRPYmplY3RJZEZpZWxkVHlwZSgpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIChyZWxtZXRhLmdldE9iamVjdElkVHlwZSgpID09\nIG51bGwpID8gT2JqZWN0LmNsYXNzCiAgICAgICAgICAgICAgICAgICAgOiBy\nZWxtZXRhLmdldE9iamVjdElkVHlwZSgpOwogICAgICAgICAgICBkZWZhdWx0\nOgogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5jbGFzczsKICAgICAg\nICB9IAogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxk\nIGhvbGRzIG9wdGltaXN0aWMgdmVyc2lvbiBpbmZvcm1hdGlvbi4KICAgICAq\nLwogICAgcHVibGljIGJvb2xlYW4gaXNWZXJzaW9uKCkgewogICAgICAgIHJl\ndHVybiBfdmVyc2lvbiA9PSBCb29sZWFuLlRSVUU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaG9sZHMgb3B0aW1pc3RpYyB2\nZXJzaW9uIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRWZXJzaW9uKGJvb2xlYW4gdmVyc2lvbikgewogICAgICAgIF92ZXJzaW9u\nID0gKHZlcnNpb24pID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBp\nbiB0aGUgZGVmYXVsdCBmZXRjaCBncm91cC4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkgewogICAgICAgIGlm\nIChfZGZnID09IDApIHsKICAgICAgICAgICAgaWYgKF9tYW5hZ2UgIT0gTUFO\nQUdFX1BFUlNJU1RFTlQgfHwgaXNQcmltYXJ5S2V5KCkgfHwgaXNWZXJzaW9u\nKCkpCiAgICAgICAgICAgICAgICBfZGZnID0gREZHX0ZBTFNFOwogICAgICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGZpZWxkIGxlZnQgYXMg\nZGVmYXVsdDsgZGZnIHNldHRpbmcgZGVwZW5kcyBvbiB0eXBlCiAgICAgICAg\nICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5PQkpFQ1Q6CiAgICAgICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuUENfVU5UWVBFRDoKICAgICAgICAgICAgICAgICAgICAgICAg\nX2RmZyA9IERGR19GQUxTRTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgICAgICAgICAgX2RmZyA9IERGR19UUlVFOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAoX2Rm\nZyAmIERGR19UUlVFKSA+IDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIHRoaXMgZmllbGQgaXMgaW4gdGhlIGRlZmF1bHQgZmV0Y2ggZ3JvdXAu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEluRGVmYXVsdEZldGNoR3Jv\ndXAoYm9vbGVhbiBkZmcpIHsKICAgICAgICBpZiAoZGZnKQogICAgICAgICAg\nICBfZGZnID0gREZHX1RSVUU7CiAgICAgICAgZWxzZQogICAgICAgICAgICBf\nZGZnID0gREZHX0ZBTFNFOwogICAgICAgIF9kZmcgfD0gREZHX0VYUExJQ0lU\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGUgZGVmYXVsdCBm\nZXRjaCBncm91cCBzZXR0aW5nIGlzIGV4cGxpY2l0LgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc0RlZmF1bHRGZXRjaEdyb3VwRXhwbGljaXQoKSB7\nCiAgICAgICAgcmV0dXJuIChfZGZnICYgREZHX0VYUExJQ0lUKSA+IDA7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBkZWZhdWx0IGZldGNo\nIGdyb3VwIHNldHRpbmcgaXMgZXhwbGljaXQuIEFsbG93IHNldHRpbmcKICAg\nICAqIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRE\nZWZhdWx0RmV0Y2hHcm91cEV4cGxpY2l0KGJvb2xlYW4gZXhwbGljaXQpIHsK\nICAgICAgICBpZiAoZXhwbGljaXQpCiAgICAgICAgICAgIF9kZmcgfD0gREZH\nX0VYUExJQ0lUOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX2RmZyAmPSB+\nREZHX0VYUExJQ0lUOwogICAgfQoKICAgIC8qKgogICAgICogR2V0cyB0aGUg\nbmFtZSBvZiB0aGUgY3VzdG9tIGZldGNoIGdyb3VwcyB0aG9zZSBhcmUgYXNz\nb2NpYXRlZCB0byB0aGlzIAogICAgICogcmVjZWl2ZXIuICBUaGlzIGRvZXMg\nbm90IGluY2x1ZGUgdGhlICJkZWZhdWx0IiBhbmQgImFsbCIgZmV0Y2ggZ3Jv\ndXBzLgogICAgICoKICAgICAqIEByZXR1cm4gdGhlIHNldCBvZiBmZXRjaCBn\ncm91cCBuYW1lcywgbm90IGluY2x1ZGluZyB0aGUgZGVmYXVsdCBhbmQKICAg\nICAqIGFsbCBmZXRjaCBncm91cHMuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJp\nbmdbXSBnZXRDdXN0b21GZXRjaEdyb3VwcygpIHsKICAgICAgICBpZiAoX2Zn\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfZmdTZXQgPT0gbnVsbCB8\nfCBfbWFuYWdlICE9IE1BTkFHRV9QRVJTSVNURU5UIAogICAgICAgICAgICAg\nICAgfHwgaXNQcmltYXJ5S2V5KCkgfHwgaXNWZXJzaW9uKCkpCiAgICAgICAg\nICAgICAgICBfZmdzID0gbmV3IFN0cmluZ1swXTsKICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgX2ZncyA9IChTdHJpbmdbXSkgX2ZnU2V0LnRv\nQXJyYXkobmV3IFN0cmluZ1tfZmdTZXQuc2l6ZSgpXSk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBfZmdzOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIGZldGNoIGdyb3VwIHRoYXQgaXMgdG8gYmUgbG9hZGVkIHdoZW4gdGhpcyBy\nZWNlaXZlciBpcyBsb2FkZWQsIG9yCiAgICAgKiBudWxsIGlmIG5vbmUgc2V0\nLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldExvYWRGZXRjaEdyb3Vw\nICgpIHsKICAgIAlyZXR1cm4gX2xmZzsKICAgIH0KICAgIAogICAgLyoqCiAg\nICAgKiBUaGUgZmV0Y2ggZ3JvdXAgdGhhdCBpcyB0byBiZSBsb2FkZWQgd2hl\nbiB0aGlzIHJlY2VpdmVyIGlzIGxvYWRlZCwgb3IKICAgICAqIG51bGwgaWYg\nbm9uZSBzZXQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldExvYWRGZXRj\naEdyb3VwIChTdHJpbmcgbGZnKSB7CiAgICAgICAgaWYgKCIiLmVxdWFscyhs\nZmcpKQogICAgICAgICAgICBsZmcgPSBudWxsOwogICAgCV9sZmcgPSBsZmc7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaXMg\naW4gdGhlIGdpdmVuIGZldGNoIGdyb3VwLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0luRmV0Y2hHcm91cChTdHJpbmcgZmcpIHsKICAgICAgICBp\nZiAoX21hbmFnZSAhPSBNQU5BR0VfUEVSU0lTVEVOVCB8fCBpc1ByaW1hcnlL\nZXkoKSB8fCBpc1ZlcnNpb24oKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIGlmIChGZXRjaEdyb3VwLk5BTUVfQUxMLmVxdWFscyhmZykp\nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmIChGZXRjaEdy\nb3VwLk5BTUVfREVGQVVMVC5lcXVhbHMoZmcpKQogICAgICAgICAgICByZXR1\ncm4gaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCk7CiAgICAgICAgcmV0dXJuIF9m\nZ1NldCAhPSBudWxsICYmIF9mZ1NldC5jb250YWlucyhmZyk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgd2hldGhlciB0aGlzIGZpZWxkIGlzIGluIHRo\nZSBnaXZlbiBmZXRjaCBncm91cC4KICAgICAqCiAgICAgKiBAcGFyYW0gZmcg\naXMgdGhlIG5hbWUgb2YgYSBmZXRjaCBncm91cCB0aGF0IG11c3QgYmUgcHJl\nc2VudCBpbiB0aGUKICAgICAqIGNsYXNzIHRoYXQgZGVjbGFyZWQgdGhpcyBm\naWVsZCBvciBhbnkgb2YgaXRzIHBlcnNpc3RlbnQgc3VwZXJjbGFzc2VzLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbkZldGNoR3JvdXAoU3RyaW5n\nIGZnLCBib29sZWFuIGluKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlz\nRW1wdHkoZmcpKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNl\ncHRpb24oX2xvYy5nZXQoImVtcHR5LWZnLW5hbWUiLCB0aGlzKSk7CiAgICAg\nICAgaWYgKGZnLmVxdWFscyhGZXRjaEdyb3VwLk5BTUVfQUxMKSkKICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIGlmIChmZy5lcXVhbHMoRmV0Y2hHcm91\ncC5OQU1FX0RFRkFVTFQpKSB7CiAgICAgICAgICAgIHNldEluRGVmYXVsdEZl\ndGNoR3JvdXAoaW4pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQog\nICAgICAgIGlmIChfb3duZXIuZ2V0RmV0Y2hHcm91cChmZykgPT0gbnVsbCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJ1bmtub3duLWZnIiwgZmcsIHRoaXMpKTsKICAgICAgICBpZiAoaW4g\nJiYgX2ZnU2V0ID09IG51bGwpCiAgICAgICAgICAgIF9mZ1NldCA9IG5ldyBI\nYXNoU2V0KCk7CiAgICAgICAgaWYgKChpbiAmJiBfZmdTZXQuYWRkKGZnKSkK\nICAgICAgICAgICAgfHwgKCFpbiAmJiBfZmdTZXQgIT0gbnVsbCAmJiBfZmdT\nZXQucmVtb3ZlKGZnKSkpCiAgICAgICAgICAgIF9mZ3MgPSBudWxsOwogICAg\nfQogICAgCiAgICAvKioKICAgICAqIEhvdyB0aGUgZGF0YSBzdG9yZSBzaG91\nbGQgdHJlYXQgbnVsbCB2YWx1ZXMgZm9yIHRoaXMgZmllbGQ6CiAgICAgKiA8\ndWw+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX1VOU0VUfTogbm8gdmFsdWUg\nc3VwcGxpZWQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9OT05FfTog\nbGVhdmUgbnVsbCB2YWx1ZXMgYXMgbnVsbCBpbiB0aGUgZGF0YSBzdG9yZTwv\nbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0VYQ0VQVElPTn06IHRocm93\nIGFuIGV4Y2VwdGlvbiBpZiB0aGlzIGZpZWxkIGlzIG51bGwKICAgICAqIGF0\nIGNvbW1pdDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0RFRkFVTFR9\nOiB1c2UgdGhlIGRhdGFiYXNlIGRlZmF1bHQgaWYgdGhpcyBmaWVsZCBpcwog\nICAgICogbnVsbCBhdCBjb21taXQ8L2xpPgogICAgICogPC91bD4gRGVmYXVs\ndHMgdG8ge0BsaW5rICNOVUxMX1VOU0VUfS4KICAgICAqLwogICAgcHVibGlj\nIGludCBnZXROdWxsVmFsdWUoKSB7CiAgICAgICAgcmV0dXJuIF9udWxsVmFs\ndWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBIb3cgdGhlIGRhdGEgc3RvcmUg\nc2hvdWxkIHRyZWF0IG51bGwgdmFsdWVzIGZvciB0aGlzIGZpZWxkOgogICAg\nICogPHVsPgogICAgICogPGxpPntAbGluayAjTlVMTF9VTlNFVH06IG5vIHZh\nbHVlIHN1cHBsaWVkPC9saT4KICAgICAqIDxsaT57QGxpbmsgI05VTExfTk9O\nRX06IGxlYXZlIG51bGwgdmFsdWVzIGFzIG51bGwgaW4gdGhlIGRhdGEgc3Rv\ncmU8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9FWENFUFRJT059OiB0\naHJvdyBhbiBleGNlcHRpb24gaWYgdGhpcyBmaWVsZCBpcyBudWxsCiAgICAg\nKiBhdCBjb21taXQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9ERUZB\nVUxUfTogdXNlIHRoZSBkYXRhYmFzZSBkZWZhdWx0IGlmIHRoaXMgZmllbGQg\naXMKICAgICAqIG51bGwgYXQgY29tbWl0PC9saT4KICAgICAqIDwvdWw+IERl\nZmF1bHRzIHRvIHtAbGluayAjTlVMTF9VTlNFVH0uCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldE51bGxWYWx1ZShpbnQgbnVsbFZhbHVlKSB7CiAgICAg\nICAgX251bGxWYWx1ZSA9IG51bGxWYWx1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBleHBsaWNpdGx5IGRlY2xhcmVk\nIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4g\naXNFeHBsaWNpdCgpIHsKICAgICAgICByZXR1cm4gX2V4cGxpY2l0OwogICAg\nfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGV4cGxp\nY2l0bHkgZGVjbGFyZWQgaW4gdGhlIG1ldGFkYXRhLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRFeHBsaWNpdChib29sZWFuIGV4cGxpY2l0KSB7CiAg\nICAgICAgX2V4cGxpY2l0ID0gZXhwbGljaXQ7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJlcyBhIG1hcHBp\nbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRNYXBwZWRC\neSgpIHsKICAgICAgICByZXR1cm4gX21hcHBlZEJ5OwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIGZpZWxkIHRoYXQgdGhpcyBmaWVsZCBzaGFyZXMgYSBt\nYXBwaW5nIHdpdGguCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1hcHBl\nZEJ5KFN0cmluZyBtYXBwZWQpIHsKICAgICAgICBfbWFwcGVkQnkgPSBtYXBw\nZWQ7CiAgICAgICAgX21hcHBlZEJ5TWV0YSA9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJlcyBh\nIG1hcHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWV0YURh\ndGEgZ2V0TWFwcGVkQnlNZXRhRGF0YSgpIHsKICAgICAgICBpZiAoX21hcHBl\nZEJ5ICE9IG51bGwgJiYgX21hcHBlZEJ5TWV0YSA9PSBudWxsKSB7CiAgICAg\nICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IG51bGw7CiAgICAgICAgICAg\nIHN3aXRjaCAoZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9IGdl\ndFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgICAg\nIG1ldGEgPSBfZWxlbS5nZXRUeXBlTWV0YURhdGEoKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgRmll\nbGRNZXRhRGF0YSBmaWVsZCA9IChtZXRhID09IG51bGwpID8gbnVsbAogICAg\nICAgICAgICAgICAgOiBtZXRhLmdldEZpZWxkKF9tYXBwZWRCeSk7CiAgICAg\nICAgICAgIGlmIChmaWVsZCA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1tYXBwZWQt\nYnkiLCB0aGlzLAogICAgICAgICAgICAgICAgICAgIF9tYXBwZWRCeSkpOwog\nICAgICAgICAgICBpZiAoZmllbGQuZ2V0TWFwcGVkQnkoKSAhPSBudWxsKQog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJjaXJjLW1hcHBlZC1ieSIsIHRoaXMsCiAgICAgICAgICAgICAg\nICAgICAgX21hcHBlZEJ5KSk7CiAgICAgICAgICAgIF9tYXBwZWRCeU1ldGEg\nPSBmaWVsZDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9tYXBwZWRCeU1l\ndGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2dpY2FsIGludmVyc2UgZmll\nbGQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0SW52ZXJzZSgpIHsK\nICAgICAgICBpZiAoQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklORy5lcXVh\nbHMoX2ludmVyc2UpKQogICAgICAgICAgICBfaW52ZXJzZSA9IG51bGw7CiAg\nICAgICAgcmV0dXJuIF9pbnZlcnNlOwogICAgfQoKICAgIC8qKgogICAgICog\nTG9naWNhbCBpbnZlcnNlIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRJbnZlcnNlKFN0cmluZyBpbnZlcnNlKSB7CiAgICAgICAgX2ludmVy\nc2VzID0gbnVsbDsKICAgICAgICBfaW52ZXJzZSA9IGludmVyc2U7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIGludmVyc2VzIG9mIHRoaXMg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhW10gZ2V0\nSW52ZXJzZU1ldGFEYXRhcygpIHsKICAgICAgICBpZiAoX2ludmVyc2VzID09\nIG51bGwpIHsKICAgICAgICAgICAgLy8gY2FuJ3QgZGVjbGFyZSBib3RoIGFu\nIGludmVyc2Ugb3duZXIgYW5kIGEgbG9naWNhbCBpbnZlcnNlCiAgICAgICAg\nICAgIFN0cmluZyBpbnYgPSBnZXRJbnZlcnNlKCk7CiAgICAgICAgICAgIGlm\nIChfbWFwcGVkQnkgIT0gbnVsbCAmJiBpbnYgIT0gbnVsbCAmJiAhX21hcHBl\nZEJ5LmVxdWFscyhpbnYpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1l\ndGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJtYXBwZWQtbm90LWludmVyc2Ui\nLAogICAgICAgICAgICAgICAgICAgIHRoaXMpKTsKCiAgICAgICAgICAgIC8v\nIGdldCB0aGUgbWV0YWRhdGEgZm9yIHRoZSB0eXBlIG9uIHRoZSBvdGhlciBz\naWRlIG9mIHRoaXMgcmVsYXRpb24KICAgICAgICAgICAgQ2xhc3NNZXRhRGF0\nYSBtZXRhID0gbnVsbDsKICAgICAgICAgICAgc3dpdGNoIChnZXRUeXBlQ29k\nZSgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAg\nICAgICAgICAgICAgICAgICBtZXRhID0gZ2V0VHlwZU1ldGFEYXRhKCk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9IF9l\nbGVtLmdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBDb2xsZWN0aW9uIGlu\ndmVyc2VzID0gbnVsbDsKICAgICAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgLy8gYWRkIG1hcHBlZCBieSBhbmQgbmFtZWQg\naW52ZXJzZSwgaWYgYW55CiAgICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRh\nIGZpZWxkID0gZ2V0TWFwcGVkQnlNZXRhRGF0YSgpOwogICAgICAgICAgICAg\nICAgaWYgKGZpZWxkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAv\nLyBtYXBwZWQgYnkgZmllbGQgaXNuJ3QgbmVjZXNzYXJpbHkgYSBwYyB0eXBl\nLCBidXQgYWxsCiAgICAgICAgICAgICAgICAgICAgLy8gaW52ZXJzZXMgbXVz\ndCBiZQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZC5nZXRUeXBlQ29k\nZSgpID09IEphdmFUeXBlcy5QQwogICAgICAgICAgICAgICAgICAgICAgICB8\nfCBmaWVsZC5nZXRFbGVtZW50KCkuZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlw\nZXMuUEMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJzZXMgPSBu\nZXcgQXJyYXlMaXN0KDMpOwogICAgICAgICAgICAgICAgICAgICAgICBpbnZl\ncnNlcy5hZGQoZmllbGQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0gZWxzZSBpZiAoaW52ICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICBmaWVsZCA9IG1ldGEuZ2V0RmllbGQoaW52KTsKICAgICAg\nICAgICAgICAgICAgICBpZiAoZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby1pbnZlcnNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRoaXMsIGludikpOwogICAgICAgICAgICAgICAgICAgIGludmVyc2VzID0g\nbmV3IEFycmF5TGlzdCgzKTsKICAgICAgICAgICAgICAgICAgICBpbnZlcnNl\ncy5hZGQoZmllbGQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nICAgIC8vIHNjYW4gcmVsIHR5cGUgZm9yIGZpZWxkcyB0aGF0IG5hbWUgdGhp\ncyBmaWVsZCBhcyBhbiBpbnZlcnNlCiAgICAgICAgICAgICAgICBGaWVsZE1l\ndGFEYXRhW10gZmllbGRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICAg\nICAgICAgIENsYXNzIHR5cGUgPSBnZXREZWNsYXJpbmdNZXRhRGF0YSgpLmdl\ndERlc2NyaWJlZFR5cGUoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgLy8gc2tpcCBmaWVsZHMgdGhhdCBhcmVuJ3QgY29tcGF0aWJsZSB3\naXRoIG91ciBvd25pbmcgY2xhc3MKICAgICAgICAgICAgICAgICAgICBzd2l0\nY2ggKGZpZWxkc1tpXS5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKCF0eXBlLmlzQXNzaWduYWJsZUZyb20oZmllbGRz\nW2ldLmdldFR5cGUoKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09M\nTEVDVElPTjoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5\ncGUuaXNBc3NpZ25hYmxlRnJvbShmaWVsZHNbaV0uCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZ2V0RWxlbWVudCgpLmdldFR5cGUoKSkpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgLy8gaWYgdGhlIGZpZWxkIGRlY2xhcmVzIHVzIGFzIGl0cyBp\nbnZlcnNlIGFuZCB3ZSBoYXZlbid0CiAgICAgICAgICAgICAgICAgICAgLy8g\nYWxyZWFkeSBhZGRlZCBpdCAod2UgbWlnaHQgaGF2ZSBpZiB3ZSBhbHNvIGRl\nY2xhcmVkIGl0CiAgICAgICAgICAgICAgICAgICAgLy8gYXMgb3VyIGludmVy\nc2UpLCBhZGQgaXQgbm93CiAgICAgICAgICAgICAgICAgICAgaWYgKF9uYW1l\nLmVxdWFscyhmaWVsZHNbaV0uZ2V0TWFwcGVkQnkoKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgfHwgX25hbWUuZXF1YWxzKGZpZWxkc1tpXS5nZXRJbnZl\ncnNlKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnZlcnNl\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJz\nZXMgPSBuZXcgQXJyYXlMaXN0KDMpOwogICAgICAgICAgICAgICAgICAgICAg\nICBpZiAoIWludmVyc2VzLmNvbnRhaW5zKGZpZWxkc1tpXSkpCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGRzW2ldKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBv\ncyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICAgICAgaWYgKGludmVyc2Vz\nID09IG51bGwpCiAgICAgICAgICAgICAgICBfaW52ZXJzZXMgPSByZXBvcy5F\nTVBUWV9GSUVMRFM7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nIF9pbnZlcnNlcyA9IChGaWVsZE1ldGFEYXRhW10pIGludmVyc2VzLnRvQXJy\nYXkKICAgICAgICAgICAgICAgICAgICAocmVwb3MubmV3RmllbGRNZXRhRGF0\nYUFycmF5KGludmVyc2VzLnNpemUoKSkpOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gX2ludmVyc2VzOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0\ncmF0ZWd5IHRvIHVzZSBmb3IgaW5zZXJ0IHZhbHVlIGdlbmVyYXRpb24uCiAg\nICAgKiBPbmUgb2YgdGhlIGNvbnN0YW50cyBmcm9tIHtAbGluayBWYWx1ZVN0\ncmF0ZWdpZXN9LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFZhbHVlU3Ry\nYXRlZ3koKSB7CiAgICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkKICAg\nICAgICAgICAgX3ZhbFN0cmF0ZWd5ID0gVmFsdWVTdHJhdGVnaWVzLk5PTkU7\nCiAgICAgICAgcmV0dXJuIF92YWxTdHJhdGVneTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBzdHJhdGVneSB0byB1c2UgZm9yIGluc2VydCB2YWx1ZSBn\nZW5lcmF0aW9uLgogICAgICogT25lIG9mIHRoZSBjb25zdGFudHMgZnJvbSB7\nQGxpbmsgVmFsdWVTdHJhdGVnaWVzfS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0VmFsdWVTdHJhdGVneShpbnQgc3RyYXRlZ3kpIHsKICAgICAgICBf\ndmFsU3RyYXRlZ3kgPSBzdHJhdGVneTsKICAgICAgICBpZiAoc3RyYXRlZ3kg\nIT0gVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFKQogICAgICAgICAgICBzZXRW\nYWx1ZVNlcXVlbmNlTmFtZShudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSB2YWx1ZSBzZXF1ZW5jZSBuYW1lLCBvciBudWxsIGZvciBub25lLgog\nICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlU2VxdWVuY2VOYW1l\nKCkgewogICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5H\nLmVxdWFscyhfc2VxTmFtZSkpCiAgICAgICAgICAgIF9zZXFOYW1lID0gbnVs\nbDsKICAgICAgICByZXR1cm4gX3NlcU5hbWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgdmFsdWUgc2VxdWVuY2UgbmFtZSwgb3IgbnVsbCBmb3Igbm9u\nZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VmFsdWVTZXF1ZW5jZU5h\nbWUoU3RyaW5nIHNlcU5hbWUpIHsKICAgICAgICBfc2VxTmFtZSA9IHNlcU5h\nbWU7CiAgICAgICAgX3NlcU1ldGEgPSBudWxsOwogICAgICAgIGlmIChzZXFO\nYW1lICE9IG51bGwpCiAgICAgICAgICAgIHNldFZhbHVlU3RyYXRlZ3koVmFs\ndWVTdHJhdGVnaWVzLlNFUVVFTkNFKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIE1ldGFkYXRhIGZvciB0aGUgdmFsdWUgc2VxdWVuY2UuCiAgICAgKi8KICAg\nIHB1YmxpYyBTZXF1ZW5jZU1ldGFEYXRhIGdldFZhbHVlU2VxdWVuY2VNZXRh\nRGF0YSgpIHsKICAgICAgICBpZiAoX3NlcU1ldGEgPT0gbnVsbCAmJiBnZXRW\nYWx1ZVNlcXVlbmNlTmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIF9zZXFN\nZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmdldFNlcXVlbmNlTWV0YURhdGEoX293\nbmVyLAogICAgICAgICAgICAgICAgZ2V0VmFsdWVTZXF1ZW5jZU5hbWUoKSwg\ndHJ1ZSk7CiAgICAgICAgcmV0dXJuIF9zZXFNZXRhOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSB3aGVuIHVwZGF0aW5nIHRo\nZSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGludCBnZXRVcGRhdGVTdHJh\ndGVneSgpIHsKICAgICAgICBpZiAoaXNWZXJzaW9uKCkpCiAgICAgICAgICAg\nIHJldHVybiBVcGRhdGVTdHJhdGVnaWVzLlJFU1RSSUNUOwogICAgICAgIGlm\nIChfdXBTdHJhdGVneSA9PSAtMSkKICAgICAgICAgICAgX3VwU3RyYXRlZ3kg\nPSBVcGRhdGVTdHJhdGVnaWVzLk5PTkU7CiAgICAgICAgcmV0dXJuIF91cFN0\ncmF0ZWd5OwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB1cGRhdGUg\nc3RyYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVwZGF0ZVN0\ncmF0ZWd5KGludCBzdHJhdGVneSkgewogICAgICAgIF91cFN0cmF0ZWd5ID0g\nc3RyYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMg\nZmllbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVzdWx0IHNldC4KICAgICAq\nLwogICAgcHVibGljIGJvb2xlYW4gaXNMUlMoKSB7CiAgICAgICAgcmV0dXJu\nIF9scnMgPT0gQm9vbGVhbi5UUlVFICYmIF9tYW5hZ2UgPT0gTUFOQUdFX1BF\nUlNJU1RFTlQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMg\nZmllbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVzdWx0IHNldC4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0TFJTKGJvb2xlYW4gbHJzKSB7CiAgICAg\nICAgX2xycyA9IChscnMpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxT\nRTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCB1\nc2VzIGludGVybWVkaWF0ZSBkYXRhIHdoZW4gbG9hZGluZy9zdG9yaW5nCiAg\nICAgKiBpbmZvcm1hdGlvbiB0aHJvdWdoIGEge0BsaW5rIE9wZW5KUEFTdGF0\nZU1hbmFnZXJ9LiBEZWZhdWx0cyB0byB0cnVlLgogICAgICoKICAgICAqIEBz\nZWUgT3BlbkpQQVN0YXRlTWFuYWdlciNzZXRJbnRlcm1lZGlhdGUoaW50LE9i\namVjdCkKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gdXNlc0ludGVybWVk\naWF0ZSgpIHsKICAgICAgICByZXR1cm4gX2ludGVybWVkaWF0ZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCB1c2VzIGludGVy\nbWVkaWF0ZSBkYXRhIHdoZW4gbG9hZGluZy9zdG9yaW5nCiAgICAgKiBpbmZv\ncm1hdGlvbiB0aHJvdWdoIGEge0BsaW5rIE9wZW5KUEFTdGF0ZU1hbmFnZXJ9\nLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICoKICAgICAqIEBzZWUgT3BlbkpQ\nQVN0YXRlTWFuYWdlciNzZXRJbnRlcm1lZGlhdGUoaW50LE9iamVjdCkKICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0VXNlc0ludGVybWVkaWF0ZShib29s\nZWFuIGludGVybWVkaWF0ZSkgewogICAgICAgIF9pbnRlcm1lZGlhdGUgPSBp\nbnRlcm1lZGlhdGU7CiAgICAgICAgX293bmVyLmNsZWFyRXh0cmFGaWVsZERh\ndGFUYWJsZSgpOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlz\nIGZpZWxkIHVzZXMgaW1wbCBkYXRhIGluIGNvbmp1bmN0aW9uIHdpdGggc3Rh\nbmRhcmQKICAgICAqIGZpZWxkIGRhdGEgd2hlbiBhY3Rpbmcgb24gYSB7QGxp\nbmsgT3BlbkpQQVN0YXRlTWFuYWdlcn0uCiAgICAgKiBEZWZhdWx0cyB0byB7\nQGxpbmsgQm9vbGVhbiNUUlVFfSAobm9uLWNhY2hhYmxlIGltcGwgZGF0YSku\nCiAgICAgKgogICAgICogQHJldHVybiB7QGxpbmsgQm9vbGVhbiNGQUxTRX0g\naWYgdGhpcyBmaWVsZCBkb2VzIG5vdCB1c2UgaW1wbCBkYXRhLAogICAgICog\ne0BsaW5rIEJvb2xlYW4jVFJVRX0gaWYgdGhpcyBmaWVsZCB1c2VzIG5vbi1j\nYWNoYWJsZSBpbXBsCiAgICAgKiBkYXRhLCBvciA8Y29kZT5udWxsPC9jb2Rl\nPiBpZiB0aGlzIGZpZWxkIHVzZXMgaW1wbCBkYXRhIHRoYXQKICAgICAqIHNo\nb3VsZCBiZSBjYWNoZWQgYWNyb3NzIGluc3RhbmNlcwogICAgICogQHNlZSBP\ncGVuSlBBU3RhdGVNYW5hZ2VyI3NldEltcGxEYXRhKGludCxPYmplY3QpCiAg\nICAgKi8KICAgIHB1YmxpYyBCb29sZWFuIHVzZXNJbXBsRGF0YSgpIHsKICAg\nICAgICByZXR1cm4gX2ltcGxEYXRhOwogICAgfQoKICAgIC8qKgogICAgICog\nV2hldGhlciB0aGlzIGZpZWxkIHVzZXMgaW1wbCBkYXRhIGluIGNvbmp1bmN0\naW9uIHdpdGggc3RhbmRhcmQKICAgICAqIGZpZWxkIGRhdGEgd2hlbiBhY3Rp\nbmcgb24gYSB7QGxpbmsgT3BlbkpQQVN0YXRlTWFuYWdlcn0uCiAgICAgKgog\nICAgICogQHNlZSBPcGVuSlBBU3RhdGVNYW5hZ2VyI3NldEltcGxEYXRhKGlu\ndCxPYmplY3QpCiAgICAgKiBAc2VlICN1c2VzSW1wbERhdGEKICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0VXNlc0ltcGxEYXRhKEJvb2xlYW4gaW1wbERh\ndGEpIHsKICAgICAgICBfaW1wbERhdGEgPSBpbXBsRGF0YTsKICAgICAgICBf\nb3duZXIuY2xlYXJFeHRyYUZpZWxkRGF0YVRhYmxlKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgb3JkZXJpbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJl\nIGFwcGxpZWQgb24gbG9hZCwgb3IgZW1wdHkgYXJyYXkuCiAgICAgKi8KICAg\nIHB1YmxpYyBPcmRlcltdIGdldE9yZGVycygpIHsKICAgICAgICBpZiAoX29y\nZGVycyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfb3JkZXJEZWMgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF9vcmRlcnMgPSBnZXRSZXBvc2l0b3J5\nKCkuRU1QVFlfT1JERVJTOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAg\nICAgICAgIFN0cmluZ1tdIGRlY3MgPSBTdHJpbmdzLnNwbGl0KF9vcmRlckRl\nYywgIiwiLCAwKTsKICAgICAgICAgICAgICAgIE9yZGVyW10gb3JkZXJzID0g\nZ2V0UmVwb3NpdG9yeSgpLm5ld09yZGVyQXJyYXkoZGVjcy5sZW5ndGgpOwog\nICAgICAgICAgICAgICAgaW50IHNwYzsKICAgICAgICAgICAgICAgIGJvb2xl\nYW4gYXNjOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBk\nZWNzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgZGVjc1tp\nXSA9IGRlY3NbaV0udHJpbSgpOwogICAgICAgICAgICAgICAgICAgIHNwYyA9\nIGRlY3NbaV0uaW5kZXhPZignICcpOwogICAgICAgICAgICAgICAgICAgIGlm\nIChzcGMgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgICAgIGFzYyA9IHRy\ndWU7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGFzYyA9IGRlY3NbaV0uc3Vic3RyaW5nKHNwYyArIDEpLnRy\naW0oKS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvTG93ZXJDYXNl\nKCkuc3RhcnRzV2l0aCgiYXNjIik7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGRlY3NbaV0gPSBkZWNzW2ldLnN1YnN0cmluZygwLCBzcGMpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBvcmRlcnNbaV0g\nPSBnZXRSZXBvc2l0b3J5KCkubmV3T3JkZXIodGhpcywgZGVjc1tpXSwgYXNj\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9vcmRlcnMg\nPSBvcmRlcnM7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIF9vcmRlcnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgb3JkZXJp\nbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24gbG9hZC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0T3JkZXJzKE9yZGVyW10gb3JkZXJz\nKSB7CiAgICAgICAgX29yZGVyRGVjID0gbnVsbDsKICAgICAgICBfb3JkZXJz\nID0gb3JkZXJzOwogICAgfQoKICAgIC8qKgogICAgICogU3RyaW5nIGRlY2xh\ncmluZyB0aGUgb3JkZXJpbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJlIGFwcGxp\nZWQgb24gbG9hZCwKICAgICAqIG9yIG51bGwuIFRoZSBzdHJpbmcgaXMgb2Yg\ndGhlIGZvcm06PGJyIC8+CiAgICAgKiA8Y29kZT5vcmRlcmFibGVbIGFzY3xk\nZXNjXVssIC4uLl08L2NvZGU+PGJyIC8+CiAgICAgKiBUaGUgb3JkZXJhYmxl\nIDxjb2RlPiNlbGVtZW50PC9jb2RlPiBpcyB1c2VkIHRvIGRlbm90ZSB0aGUg\ndmFsdWUgb2YKICAgICAqIHRoZSBmaWVsZCdzIGVsZW1lbnRzLgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIGdldE9yZGVyRGVjbGFyYXRpb24oKSB7CiAg\nICAgICAgaWYgKF9vcmRlckRlYyA9PSBudWxsICYmIF9vcmRlcnMgIT0gbnVs\nbCkgewogICAgICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmlu\nZ0J1ZmZlcigpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9v\ncmRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChpID4g\nMCkKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZChfb3JkZXJzW2ldLmdldE5hbWUoKSku\nYXBwZW5kKCIgIik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKChfb3Jk\nZXJzW2ldLmlzQXNjZW5kaW5nKCkpID8gImFzYyIgOiAiZGVzYyIpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIF9vcmRlckRlYyA9IGJ1Zi50b1N0cmlu\nZygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX29yZGVyRGVjOwogICAg\nfQoKICAgIC8qKgogICAgICogU3RyaW5nIGRlY2xhcmluZyB0aGUgb3JkZXJp\nbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24gbG9hZCwKICAg\nICAqIG9yIG51bGwuIFRoZSBzdHJpbmcgaXMgb2YgdGhlIGZvcm06PGJyIC8+\nCiAgICAgKiA8Y29kZT5vcmRlcmFibGVbIGFzY3xkZXNjXVssIC4uLl08L2Nv\nZGU+PGJyIC8+CiAgICAgKiBUaGUgb3JkZXJhYmxlIDxjb2RlPiNlbGVtZW50\nPC9jb2RlPiBpcyB1c2VkIHRvIGRlbm90ZSB0aGUgdmFsdWUgb2YKICAgICAq\nIHRoZSBmaWVsZCdzIGVsZW1lbnRzLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRPcmRlckRlY2xhcmF0aW9uKFN0cmluZyBkZWMpIHsKICAgICAgICBf\nb3JkZXJEZWMgPSBTdHJpbmdVdGlscy50cmltVG9OdWxsKGRlYyk7CiAgICAg\nICAgX29yZGVycyA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBPcmRl\nciB0aGlzIGZpZWxkIHZhbHVlIHdoZW4gaXQgaXMgbG9hZGVkLgogICAgICov\nCiAgICBwdWJsaWMgT2JqZWN0IG9yZGVyKE9iamVjdCB2YWwpIHsKICAgICAg\nICBpZiAodmFsID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoK\nICAgICAgICBPcmRlcltdIG9yZGVycyA9IGdldE9yZGVycygpOwogICAgICAg\nIGlmIChvcmRlcnMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiB2\nYWw7CgogICAgICAgIC8vIGNyZWF0ZSBhIGNvbXBhcmF0b3IgZm9yIHRoZSBl\nbGVtZW50cyBvZiB0aGUgdmFsdWUKICAgICAgICBDb21wYXJhdG9yIGNvbXA7\nCiAgICAgICAgaWYgKG9yZGVycy5sZW5ndGggPT0gMSkKICAgICAgICAgICAg\nY29tcCA9IG9yZGVyc1swXS5nZXRDb21wYXJhdG9yKCk7CiAgICAgICAgZWxz\nZSB7CiAgICAgICAgICAgIExpc3QgY29tcHMgPSBudWxsOwogICAgICAgICAg\nICBDb21wYXJhdG9yIGN1ckNvbXA7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgb3JkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICBjdXJDb21wID0gb3JkZXJzW2ldLmdldENvbXBhcmF0b3IoKTsKICAgICAg\nICAgICAgICAgIGlmIChjdXJDb21wICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoY29tcHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICAgICAgY29tcHMgPSBuZXcgQXJyYXlMaXN0KG9yZGVycy5sZW5ndGgpOwog\nICAgICAgICAgICAgICAgICAgIGlmIChpICE9IGNvbXBzLnNpemUoKSkKICAg\nICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIm1p\neGVkLWlubWVtLW9yZGVyaW5nIiwgdGhpcykpOwogICAgICAgICAgICAgICAg\nICAgIGNvbXBzLmFkZChjdXJDb21wKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfQogICAgICAgICAgICBpZiAoY29tcHMgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGNvbXAgPSBudWxsOwogICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICBjb21wID0gbmV3IENvbXBhcmF0b3JDaGFpbihjb21w\ncyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29tcCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gdmFsOwoKICAgICAgICAvLyBzb3J0CiAgICAgICAg\nc3dpdGNoIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgTGlzdCBsID0gSmF2YVR5\ncGVzLnRvTGlzdCh2YWwsIF9lbGVtLmdldFR5cGUoKSwgdHJ1ZSk7CiAgICAg\nICAgICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KGwsIGNvbXApOwogICAgICAg\nICAgICAgICAgcmV0dXJuIEphdmFUeXBlcy50b0FycmF5KGwsIF9lbGVtLmdl\ndFR5cGUoKSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJ\nT046CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTGlzdCkK\nICAgICAgICAgICAgICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KChMaXN0KSB2\nYWwsIGNvbXApOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRh\nRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiY2FudC1vcmRlciIsIHRoaXMpKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBm\naWVsZCBpcyBleHRlcm5hbGl6ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGlzRXh0ZXJuYWxpemVkKCkgewogICAgICAgIHJldHVybiBnZXRFeHRl\ncm5hbGl6ZXJNZXRob2QoKSAhPSBudWxsCiAgICAgICAgICAgIHx8IGdldEV4\ndGVybmFsVmFsdWVNYXAoKSAhPSBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVydCB0aGUgZ2l2ZW4gZmllbGQgdmFsdWUgdG8gaXRzIGV4dGVy\nbmFsIHZhbHVlIHRocm91Z2ggdGhlCiAgICAgKiBwcm92aWRlZCBleHRlcm5h\nbGl6ZXIsIG9yIHJldHVybiB0aGUgdmFsdWUgYXMtaXMgaWYgbm8gZXh0ZXJu\nYWxpemVyLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldEV4dGVybmFs\nVmFsdWUoT2JqZWN0IHZhbCwgU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAg\nIE1hcCBleHRWYWx1ZXMgPSBnZXRFeHRlcm5hbFZhbHVlTWFwKCk7CiAgICAg\nICAgaWYgKGV4dFZhbHVlcyAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZXh0VmFsdWVzLmdldCh2YWwpOwoKICAgICAgICBNZXRob2QgZXh0ZXJuYWxp\nemVyID0gZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCk7CiAgICAgICAgaWYgKGV4\ndGVybmFsaXplciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdmFsOwoK\nICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIHF1ZXJpZXM6IGFsbG93IHRo\nZSBnaXZlbiB2YWx1ZSB0byBwYXNzIHRocm91Z2gKICAgICAgICAvLyBhcy1p\ncyBpZiBpdCBpcyBhbHJlYWR5IGluIGV4dGVybmFsaXplZCBmb3JtCiAgICAg\nICAgaWYgKHZhbCAhPSBudWxsICYmIGdldFR5cGUoKS5pc0luc3RhbmNlKHZh\nbCkKICAgICAgICAgICAgJiYgKCFnZXREZWNsYXJlZFR5cGUoKS5pc0luc3Rh\nbmNlKHZhbCkKICAgICAgICAgICAgfHwgZ2V0RGVjbGFyZWRUeXBlKCkgPT0g\nT2JqZWN0LmNsYXNzKSkKICAgICAgICAgICAgcmV0dXJuIHZhbDsKCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgLy8gZWl0aGVyIGludm9rZSB0aGUgc3Rh\ndGljIHRvRXh0ZXJuYWwodmFsWywgY3R4XSkgbWV0aG9kLCBvciB0aGUKICAg\nICAgICAgICAgLy8gbm9uLXN0YXRpYyB2YWwudG9FeHRlcm5hbChbY3R4XSkg\nbWV0aG9kCiAgICAgICAgICAgIGlmIChNb2RpZmllci5pc1N0YXRpYyhleHRl\ncm5hbGl6ZXIuZ2V0TW9kaWZpZXJzKCkpKSB7CiAgICAgICAgICAgICAgICBp\nZiAoZXh0ZXJuYWxpemVyLmdldFBhcmFtZXRlclR5cGVzKCkubGVuZ3RoID09\nIDEpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5p\nbnZva2UobnVsbCwgbmV3IE9iamVjdFtdeyB2YWwgfSk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gZXh0ZXJuYWxpemVyLmludm9rZShudWxsLCBuZXcgT2Jq\nZWN0W117IHZhbCwgY3R4IH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICBpZiAoZXh0ZXJuYWxpemVyLmdldFBhcmFtZXRlclR5\ncGVzKCkubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICByZXR1cm4gZXh0\nZXJuYWxpemVyLmludm9rZSh2YWwsIChPYmplY3RbXSkgbnVsbCk7CiAgICAg\nICAgICAgIHJldHVybiBleHRlcm5hbGl6ZXIuaW52b2tlKHZhbCwgbmV3IE9i\namVjdFtdeyBjdHggfSk7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2Vw\ndGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImV4dGVybmFsaXplci1lcnIiLCB0\naGlzLAogICAgICAgICAgICAgICAgRXhjZXB0aW9ucy50b1N0cmluZyh2YWwp\nLCBlLnRvU3RyaW5nKCkpKS5zZXRDYXVzZShlKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBwYXNzaW5n\nIHRoZSBnaXZlbiBleHRlcm5hbCB2YWx1ZSB0aHJvdWdoIHRoZQogICAgICog\nZmFjdG9yeSB0byBnZXQgdGhlIGZpZWxkIHZhbHVlLiBJZiBubyBmYWN0b3J5\nIGlzIHByZXNlbnQsCiAgICAgKiB0aGUgZ2l2ZW4gdmFsdWUgaXMgcmV0dXJu\nZWQgYXMtaXMuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0RmllbGRW\nYWx1ZShPYmplY3QgdmFsLCBTdG9yZUNvbnRleHQgY3R4KSB7CiAgICAgICAg\nTWFwIGZpZWxkVmFsdWVzID0gZ2V0RmllbGRWYWx1ZU1hcCgpOwogICAgICAg\nIGlmIChmaWVsZFZhbHVlcyAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZmllbGRWYWx1ZXMuZ2V0KHZhbCk7CgogICAgICAgIE1lbWJlciBmYWN0b3J5\nID0gZ2V0RmFjdG9yeU1ldGhvZCgpOwogICAgICAgIGlmIChmYWN0b3J5ID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCAmJiBnZXROdWxsVmFsdWUo\nKSA9PSBOVUxMX0RFRkFVTFQpCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0\nRGVjbGFyZWRUeXBlKCkubmV3SW5zdGFuY2UoKTsKCiAgICAgICAgICAgIC8v\nIGludm9rZSBlaXRoZXIgdGhlIGNvbnN0cnVjdG9yIGZvciB0aGUgZmllbGQg\ndHlwZSwKICAgICAgICAgICAgLy8gb3IgdGhlIHN0YXRpYyB0eXBlLnRvRmll\nbGQodmFsWywgY3R4XSkgbWV0aG9kCiAgICAgICAgICAgIGlmIChmYWN0b3J5\nIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpIHsKICAgICAgICAgICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICAgICAgICAgIHJldHVybiAoKENvbnN0cnVjdG9yKSBmYWN0\nb3J5KS5uZXdJbnN0YW5jZQogICAgICAgICAgICAgICAgICAgIChuZXcgT2Jq\nZWN0W117IHZhbCB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgTWV0\naG9kIG1ldGggPSAoTWV0aG9kKSBmYWN0b3J5OwogICAgICAgICAgICBpZiAo\nbWV0aC5nZXRQYXJhbWV0ZXJUeXBlcygpLmxlbmd0aCA9PSAxKQogICAgICAg\nICAgICAgICAgcmV0dXJuIG1ldGguaW52b2tlKG51bGwsIG5ldyBPYmplY3Rb\nXXsgdmFsIH0pOwogICAgICAgICAgICByZXR1cm4gbWV0aC5pbnZva2UobnVs\nbCwgbmV3IE9iamVjdFtdeyB2YWwsIGN0eCB9KTsKICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyB1bndyYXAgY2F1c2UK\nICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBJbnZvY2F0aW9uVGFyZ2V0\nRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICBUaHJvd2FibGUgdCA9ICgo\nSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbikgZSkuCiAgICAgICAgICAgICAg\nICAgICAgZ2V0VGFyZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICBp\nZiAodCBpbnN0YW5jZW9mIEVycm9yKQogICAgICAgICAgICAgICAgICAgIHRo\ncm93IChFcnJvcikgdDsKICAgICAgICAgICAgICAgIGUgPSAoRXhjZXB0aW9u\nKSB0OwoKICAgICAgICAgICAgICAgIC8vIGFsbG93IG51bGwgdmFsdWVzIHRv\nIGNhdXNlIE5QRXMgYW5kIGlsbGVnYWwgYXJnIGV4Y2VwdGlvbnMKICAgICAg\nICAgICAgICAgIC8vIHdpdGhvdXQgZXJyb3IKICAgICAgICAgICAgICAgIGlm\nICh2YWwgPT0gbnVsbCAmJiAoZSBpbnN0YW5jZW9mIE51bGxQb2ludGVyRXhj\nZXB0aW9uCiAgICAgICAgICAgICAgICAgICAgfHwgZSBpbnN0YW5jZW9mIEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbikpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChl\nIGluc3RhbmNlb2YgT3BlbkpQQUV4Y2VwdGlvbikKICAgICAgICAgICAgICAg\nIHRocm93IChPcGVuSlBBRXhjZXB0aW9uKSBlOwogICAgICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImZhY3RvcnktZXJy\nIiwgdGhpcywKICAgICAgICAgICAgICAgIEV4Y2VwdGlvbnMudG9TdHJpbmco\ndmFsKSwgZS50b1N0cmluZygpKSkuc2V0Q2F1c2UoZSk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdz\nIGV4dGVybmFsaXplciwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldEV4dGVybmFsaXplcigpIHsKICAgICAgICByZXR1\ncm4gX2V4dE5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBv\nZiB0aGlzIGZpZWxkJ3MgZXh0ZXJuYWxpemVyLCBvciBudWxsIGlmIG5vbmUu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEV4dGVybmFsaXplcihTdHJp\nbmcgZXh0ZXJuYWxpemVyKSB7CiAgICAgICAgX2V4dE5hbWUgPSBleHRlcm5h\nbGl6ZXI7CiAgICAgICAgX2V4dE1ldGhvZCA9IERFRkFVTFRfTUVUSE9EOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdz\nIGZhY3RvcnksIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRGYWN0b3J5KCkgewogICAgICAgIHJldHVybiBfZmFjdE5h\nbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGlzIGZp\nZWxkJ3MgZmFjdG9yeSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRGYWN0b3J5KFN0cmluZyBmYWN0b3J5KSB7CiAgICAg\nICAgX2ZhY3ROYW1lID0gZmFjdG9yeTsKICAgICAgICBfZmFjdE1ldGhvZCA9\nIERFRkFVTFRfTUVUSE9EOwogICAgfQoKICAgIC8qKgogICAgICogUHJvcGVy\ndGllcyBzdHJpbmcgbWFwcGluZyBmaWVsZCB2YWx1ZXMgdG8gZXh0ZXJuYWwg\ndmFsdWVzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEV4dGVybmFs\nVmFsdWVzKCkgewogICAgICAgIHJldHVybiBfZXh0U3RyaW5nOwogICAgfQoK\nICAgIC8qKgogICAgICogUHJvcGVydGllcyBzdHJpbmcgbWFwcGluZyBmaWVs\nZCB2YWx1ZXMgdG8gZXh0ZXJuYWwgdmFsdWVzLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRFeHRlcm5hbFZhbHVlcyhTdHJpbmcgdmFsdWVzKSB7CiAg\nICAgICAgX2V4dFN0cmluZyA9IHZhbHVlczsKICAgICAgICBfZXh0VmFsdWVz\nID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbWFw\ncGluZyBvZiBmaWVsZCB2YWx1ZXMgdG8gZXh0ZXJuYWwgdmFsdWVzLgogICAg\nICovCiAgICBwdWJsaWMgTWFwIGdldEV4dGVybmFsVmFsdWVNYXAoKSB7CiAg\nICAgICAgcGFyc2VFeHRlcm5hbFZhbHVlcygpOwogICAgICAgIHJldHVybiBf\nZXh0VmFsdWVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBt\nYXBwaW5nIG9mIGV4dGVybmFsIHZhbHVlcyB0byBmaWVsZCB2YWx1ZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyBNYXAgZ2V0RmllbGRWYWx1ZU1hcCgpIHsKICAg\nICAgICBwYXJzZUV4dGVybmFsVmFsdWVzKCk7CiAgICAgICAgcmV0dXJuIF9m\naWVsZFZhbHVlczsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGV4dGVy\nbmFsIHZhbHVlcyBpbnRvIG1hcHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBwYXJzZUV4dGVybmFsVmFsdWVzKCkgewogICAgICAgIGlmIChfZXh0VmFs\ndWVzICE9IENvbGxlY3Rpb25zLkVNUFRZX01BUAogICAgICAgICAgICAmJiBf\nZmllbGRWYWx1ZXMgIT0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIGlmIChfZXh0U3RyaW5nID09IG51bGwp\nIHsKICAgICAgICAgICAgX2V4dFZhbHVlcyA9IG51bGw7CiAgICAgICAgICAg\nIF9maWVsZFZhbHVlcyA9IG51bGw7CiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICB9CgogICAgICAgIC8vIHBhcnNlIHN0cmluZyBpbnRvIG9wdGlvbnM7\nIHRoaXMgdGFrZXMgY2FyZSBvZiBwcm9wZXIgdHJpbW1pbmcgZXRjCiAgICAg\nICAgT3B0aW9ucyB2YWx1ZXMgPSBDb25maWd1cmF0aW9ucy5wYXJzZVByb3Bl\ncnRpZXMoX2V4dFN0cmluZyk7CiAgICAgICAgaWYgKHZhbHVlcy5pc0VtcHR5\nKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihf\nbG9jLmdldCgibm8tZXh0ZXJuYWwtdmFsdWVzIiwgdGhpcywKICAgICAgICAg\nICAgICAgIF9leHRTdHJpbmcpKTsKCiAgICAgICAgTWFwIGV4dFZhbHVlcyA9\nIG5ldyBIYXNoTWFwKChpbnQpICh2YWx1ZXMuc2l6ZSgpICogMS4zMyArIDEp\nKTsKICAgICAgICBNYXAgZmllbGRWYWx1ZXMgPSBuZXcgSGFzaE1hcCgoaW50\nKSAodmFsdWVzLnNpemUoKSAqIDEuMzMgKyAxKSk7CiAgICAgICAgTWFwLkVu\ndHJ5IGVudHJ5OwogICAgICAgIE9iamVjdCBleHRWYWx1ZSwgZmllbGRWYWx1\nZTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHZhbHVlcy5lbnRyeVNl\ndCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAg\nIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAg\nZmllbGRWYWx1ZSA9IHRyYW5zZm9ybSgoU3RyaW5nKSBlbnRyeS5nZXRLZXko\nKSwKICAgICAgICAgICAgICAgIGdldERlY2xhcmVkVHlwZUNvZGUoKSk7CiAg\nICAgICAgICAgIGV4dFZhbHVlID0gdHJhbnNmb3JtKChTdHJpbmcpIGVudHJ5\nLmdldFZhbHVlKCksIGdldFR5cGVDb2RlKCkpOwoKICAgICAgICAgICAgZXh0\nVmFsdWVzLnB1dChmaWVsZFZhbHVlLCBleHRWYWx1ZSk7CiAgICAgICAgICAg\nIGZpZWxkVmFsdWVzLnB1dChleHRWYWx1ZSwgZmllbGRWYWx1ZSk7CiAgICAg\nICAgfQoKICAgICAgICBfZXh0VmFsdWVzID0gZXh0VmFsdWVzOwogICAgICAg\nIF9maWVsZFZhbHVlcyA9IGZpZWxkVmFsdWVzOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBzdHJpbmcgdmFsdWUgY29udmVydGVkIHRvIHRo\nZSBnaXZlbiB0eXBlIGNvZGUuIFRoZSBzdHJpbmcKICAgICAqIG11c3QgYmUg\nbm9uLW51bGwgYW5kIHRyaW1tZWQuCiAgICAgKi8KICAgIHByaXZhdGUgT2Jq\nZWN0IHRyYW5zZm9ybShTdHJpbmcgdmFsLCBpbnQgdHlwZUNvZGUpIHsKICAg\nICAgICBpZiAoIm51bGwiLmVxdWFscyh2YWwpKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgc3dpdGNoICh0eXBlQ29kZSkgewogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5CT09MRUFOOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5CT09MRUFOX09CSjoKICAgICAgICAgICAgICAgIHJldHVy\nbiBCb29sZWFuLnZhbHVlT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuQllURToKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURV9P\nQko6CiAgICAgICAgICAgICAgICByZXR1cm4gQnl0ZS52YWx1ZU9mKHZhbCk7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVDoKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuSU5UX09CSjoKICAgICAgICAgICAgICAgIHJldHVy\nbiBJbnRlZ2VyLnZhbHVlT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuTE9ORzoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9OR19P\nQko6CiAgICAgICAgICAgICAgICByZXR1cm4gTG9uZy52YWx1ZU9mKHZhbCk7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUOgogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5TSE9SVF9PQko6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gU2hvcnQudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5ET1VCTEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRP\nVUJMRV9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gRG91YmxlLnZhbHVl\nT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVQ6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FUX09CSjoKICAgICAgICAg\nICAgICAgIHJldHVybiBGbG9hdC52YWx1ZU9mKHZhbCk7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkNIQVJfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGFy\nYWN0ZXIodmFsLmNoYXJBdCgwKSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLlNUUklORzoKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAg\nICAgfQogICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9j\nLmdldCgiYmFkLWV4dGVybmFsLXR5cGUiLCB0aGlzKSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgZXh0ZXJuYWxpemVyIG1ldGhvZC4KICAgICAqLwog\nICAgcHVibGljIE1ldGhvZCBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKSB7CiAg\nICAgICAgaWYgKF9tYW5hZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChfZXh0TWV0aG9kID09\nIERFRkFVTFRfTUVUSE9EKSB7CiAgICAgICAgICAgIGlmIChfZXh0TmFtZSAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfZXh0TWV0aG9kID0gZmluZE1l\ndGhvZChfZXh0TmFtZSk7CiAgICAgICAgICAgICAgICBpZiAoX2V4dE1ldGhv\nZCA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRh\nRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWV4dGVybmFsaXplciIsCiAg\nICAgICAgICAgICAgICAgICAgICAgIHRoaXMsIF9leHROYW1lKSk7CiAgICAg\nICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgX2V4dE1ldGhvZCA9IG51\nbGw7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfZXh0TWV0aG9kOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIGZhY3RvcnkgbWV0aG9kIG9yIGNvbnN0\ncnVjdG9yLgogICAgICovCiAgICBwdWJsaWMgTWVtYmVyIGdldEZhY3RvcnlN\nZXRob2QoKSB7CiAgICAgICAgaWYgKF9tYW5hZ2UgIT0gTUFOQUdFX1BFUlNJ\nU1RFTlQpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChf\nZmFjdE1ldGhvZCA9PSBERUZBVUxUX01FVEhPRCkgewogICAgICAgICAgICBp\nZiAoZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIF9mYWN0TWV0aG9kID0gbnVsbDsKICAgICAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGlm\nIChfZmFjdE5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nX2ZhY3RNZXRob2QgPSBnZXREZWNsYXJlZFR5cGUoKS5nZXRDb25zdHJ1Y3Rv\ncgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKG5ldyBDbGFzc1tdeyBn\nZXRUeXBlKCkgfSk7CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAg\nICAgICAgICAgICAgICAgICBfZmFjdE1ldGhvZCA9IGZpbmRNZXRob2QoX2Zh\nY3ROYW1lKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNl\ncHRpb24ga2UpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBrZTsKICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEoX2ZhY3RNZXRob2Qg\naW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikKICAgICAgICAgICAgICAgICAgICAm\nJiAhKF9mYWN0TWV0aG9kIGluc3RhbmNlb2YgTWV0aG9kKSkKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5n\nZXQoImJhZC1mYWN0b3J5IiwgdGhpcykpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBfZmFjdE1ldGhvZDsKICAgIH0KCiAgICAv\nKioKICAgICAqIEZpbmQgdGhlIG1ldGhvZCBmb3IgdGhlIHNwZWNpZmllZCBu\nYW1lLiBQb3NzaWJsZSBmb3JtcyBhcmU6CiAgICAgKiA8dWw+CiAgICAgKiA8\nbGk+dG9FeHRlcm5hbFN0cmluZzwvbGk+CiAgICAgKiA8bGk+TXlGYWN0b3J5\nQ2xhc3MudG9FeHRlcm5hbFN0cmluZzwvbGk+CiAgICAgKiA8bGk+Y29tLmNv\nbXBhbnkuTXlGYWN0b3J5Q2xhc3MudG9FeHRlcm5hbFN0cmluZzwvbGk+CiAg\nICAgKiA8L3VsPgogICAgICoKICAgICAqIEBwYXJhbSBtZXRob2QgdGhlIG5h\nbWUgb2YgdGhlIG1ldGhvZCB0byBsb2NhdGUKICAgICAqIEByZXR1cm4gdGhl\nIG1ldGhvZCBmb3IgaW52b2NhdGlvbgogICAgICovCiAgICBwcml2YXRlIE1l\ndGhvZCBmaW5kTWV0aG9kKFN0cmluZyBtZXRob2QpIHsKICAgICAgICBpZiAo\nU3RyaW5nVXRpbHMuaXNFbXB0eShtZXRob2QpKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgLy8gZ2V0IGNsYXNzIG5hbWUgYW5kIGdldCBw\nYWNrYWdlIG5hbWUgZGl2aWRlIG9uIHRoZSBsYXN0ICcuJywgc28gdGhlCiAg\nICAgICAgLy8gbmFtZXMgZG9uJ3QgYXBwbHkgaW4gdGhpcyBjYXNlLCBidXQg\ndGhlIG1ldGhvZHMgZG8gd2hhdCB3ZSB3YW50CiAgICAgICAgU3RyaW5nIG1l\ndGhvZE5hbWUgPSBTdHJpbmdzLmdldENsYXNzTmFtZShtZXRob2QpOwogICAg\nICAgIFN0cmluZyBjbHNOYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZSht\nZXRob2QpOwoKICAgICAgICBDbGFzcyBjbHMgPSBudWxsOwogICAgICAgIENs\nYXNzIG93bmVyID0gX293bmVyLmdldERlc2NyaWJlZFR5cGUoKTsKCiAgICAg\nICAgaWYgKGNsc05hbWUubGVuZ3RoKCkgPT0gMCkKICAgICAgICAgICAgY2xz\nID0gZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICAgICAgZWxzZSBpZiAoY2xzTmFt\nZS5lcXVhbHMob3duZXIuZ2V0TmFtZSgpKQogICAgICAgICAgICB8fCBjbHNO\nYW1lLmVxdWFscyhTdHJpbmdzLmdldENsYXNzTmFtZShvd25lcikpKQogICAg\nICAgICAgICBjbHMgPSBvd25lcjsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIGNscyA9IEphdmFUeXBlcy5jbGFzc0Zvck5hbWUoY2xzTmFtZSwgdGhpcyk7\nCgogICAgICAgIC8vIGZpbmQgdGhlIG5hbWVkIG1ldGhvZAogICAgICAgIE1l\ndGhvZFtdIG1ldGhvZHMgPSBjbHMuZ2V0TWV0aG9kcygpOwogICAgICAgIENs\nYXNzW10gcGFyYW1zOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0\naG9kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAobWV0aG9kc1tp\nXS5nZXROYW1lKCkuZXF1YWxzKG1ldGhvZE5hbWUpKSB7CiAgICAgICAgICAg\nICAgICBwYXJhbXMgPSBtZXRob2RzW2ldLmdldFBhcmFtZXRlclR5cGVzKCk7\nCgogICAgICAgICAgICAgICAgLy8gc3RhdGljIGZhY3RvcnkgbWV0aG9kcyBy\nZXF1aXJlIG9uZSBhcmd1bWVudCBvciBvbmUgYXJndW1lbnQKICAgICAgICAg\nICAgICAgIC8vIHBsdXMgYSBjdHg7IG5vbi1zdGF0aWMgbWV0aG9kcyByZXF1\naXJlIHplcm8gYXJndW1lbnRzIG9yCiAgICAgICAgICAgICAgICAvLyBqdXN0\nIGEgY3R4CiAgICAgICAgICAgICAgICBpZiAoTW9kaWZpZXIuaXNTdGF0aWMo\nbWV0aG9kc1tpXS5nZXRNb2RpZmllcnMoKSkKICAgICAgICAgICAgICAgICAg\nICAmJiAocGFyYW1zLmxlbmd0aCA9PSAxIHx8IChwYXJhbXMubGVuZ3RoID09\nIDIKICAgICAgICAgICAgICAgICAgICAmJiBpc1N0b3JlQ29udGV4dFBhcmFt\nZXRlcihwYXJhbXNbMV0pKSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIG1ldGhvZHNbaV07CiAgICAgICAgICAgICAgICBpZiAoIU1vZGlmaWVyLmlz\nU3RhdGljKG1ldGhvZHNbaV0uZ2V0TW9kaWZpZXJzKCkpCiAgICAgICAgICAg\nICAgICAgICAgJiYgKHBhcmFtcy5sZW5ndGggPT0gMCB8fCAocGFyYW1zLmxl\nbmd0aCA9PSAxCiAgICAgICAgICAgICAgICAgICAgJiYgaXNTdG9yZUNvbnRl\neHRQYXJhbWV0ZXIocGFyYW1zWzBdKSkpKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBtZXRob2RzW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0cnVlIGlmIHRoZSBnaXZlbiB0eXBlIGlzIGEgc3RvcmUgY29udGV4\ndCB0eXBlOyB3ZSBjYW4ndAogICAgICogdXNlIHRoZSBzdGFuZGFyZCA8Y29k\nZT5pc0Fzc2lnbmFibGVGcm9tPC9jb2RlPiBiZWNhdXNlIG9mIGNsYXNzbG9h\nZGVyCiAgICAgKiBvZGRuZXNzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBib29sZWFuIGlzU3RvcmVDb250ZXh0UGFyYW1ldGVyKENsYXNzIHR5cGUp\nIHsKICAgICAgICByZXR1cm4gU3RvcmVDb250ZXh0LmNsYXNzLmdldE5hbWUo\nKS5lcXVhbHModHlwZS5nZXROYW1lKCkpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3Ro\nZXIgPT0gdGhpcykKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\naWYgKCEob3RoZXIgaW5zdGFuY2VvZiBGaWVsZE1ldGFEYXRhKSkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBnZXRGdWxsTmFt\nZSh0cnVlKS5lcXVhbHMoKChGaWVsZE1ldGFEYXRhKSBvdGhlcikuCiAgICAg\nICAgICAgIGdldEZ1bGxOYW1lKHRydWUpKTsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGNvbXBhcmVUbyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3Ro\nZXIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgcmV0\ndXJuIGdldEZ1bGxOYW1lKHRydWUpLmNvbXBhcmVUbygoKEZpZWxkTWV0YURh\ndGEpIG90aGVyKS4KICAgICAgICAgICAgZ2V0RnVsbE5hbWUodHJ1ZSkpOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAg\ncmV0dXJuIGdldEZ1bGxOYW1lKHRydWUpOwogICAgfQoKICAgIC8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUmVzb2x2ZSBhbmQgdmFsaWRhdGUK\nICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICog\nUmVzb2x2ZSBtb2RlIGZvciB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJs\naWMgaW50IGdldFJlc29sdmUoKSB7CiAgICAgICAgcmV0dXJuIF9yZXNNb2Rl\nOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZvciB0aGlz\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZXNvbHZlKGlu\ndCBtb2RlKSB7CiAgICAgICAgX3Jlc01vZGUgPSBtb2RlOwogICAgfQoKICAg\nIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZvciB0aGlzIGZpZWxkLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZXNvbHZlKGludCBtb2RlLCBib29s\nZWFuIG9uKSB7CiAgICAgICAgaWYgKG1vZGUgPT0gTU9ERV9OT05FKQogICAg\nICAgICAgICBfcmVzTW9kZSA9IG1vZGU7CiAgICAgICAgZWxzZSBpZiAob24p\nCiAgICAgICAgICAgIF9yZXNNb2RlIHw9IG1vZGU7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBfcmVzTW9kZSAmPSB+bW9kZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJlc29sdmUgYW5kIHZhbGlkYXRlIG1ldGFkYXRhLiBSZXR1cm4g\ndHJ1ZSBpZiBhbHJlYWR5IHJlc29sdmVkLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiByZXNvbHZlKGludCBtb2RlKSB7CiAgICAgICAgaWYgKChfcmVz\nTW9kZSAmIG1vZGUpID09IG1vZGUpCiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIGludCBjdXIgPSBfcmVzTW9kZTsKICAgICAgICBfcmVzTW9k\nZSB8PSBtb2RlOwoKICAgICAgICBMb2cgbG9nID0gZ2V0UmVwb3NpdG9yeSgp\nLmdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkK\nICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJyZXNvbHZlLWZpZWxk\nIiwgX293bmVyICsgIkAiCiAgICAgICAgICAgICAgICArIFN5c3RlbS5pZGVu\ndGl0eUhhc2hDb2RlKF9vd25lcikgKyAiLiIgKyBfbmFtZSkpOwoKICAgICAg\nICAvLyB3ZSBvbmx5IHBlcmZvcm0gYWN0aW9ucyBmb3IgbWV0YWRhdGEgbW9k\nZQogICAgICAgIGlmICgobW9kZSAmIE1PREVfTUVUQSkgPT0gMCB8fCAoY3Vy\nICYgTU9ERV9NRVRBKSAhPSAwKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCgogICAgICAgIE1ldGhvZCBleHRlcm5hbGl6ZXIgPSBnZXRFeHRlcm5hbGl6\nZXJNZXRob2QoKTsKICAgICAgICBpZiAoZXh0ZXJuYWxpemVyICE9IG51bGwp\nCiAgICAgICAgICAgIHNldFR5cGUoZXh0ZXJuYWxpemVyLmdldFJldHVyblR5\ncGUoKSk7CgogICAgICAgIC8vIG9ubHkgcGFzcyBvbiBtZXRhZGF0YSByZXNv\nbHZlIG1vZGUgc28gdGhhdCBtZXRhZGF0YSBpcyBhbHdheXMKICAgICAgICAv\nLyByZXNvbHZlZCBiZWZvcmUgYW55IG90aGVyIHJlc29sdmUgbW9kZXMgb3Vy\nIHN1YmNsYXNzZXMgcGFzcyBhbG9uZwogICAgICAgIF92YWwucmVzb2x2ZShN\nT0RFX01FVEEpOwogICAgICAgIF9rZXkucmVzb2x2ZShNT0RFX01FVEEpOwog\nICAgICAgIF9lbGVtLnJlc29sdmUoTU9ERV9NRVRBKTsKCiAgICAgICAgTWV0\nYURhdGFSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAg\nICAgIGludCB2YWxpZGF0ZSA9IHJlcG9zLmdldFZhbGlkYXRlKCk7CiAgICAg\nICAgaWYgKCh2YWxpZGF0ZSAmIE1ldGFEYXRhUmVwb3NpdG9yeS5WQUxJREFU\nRV9NRVRBKSAhPSAwCiAgICAgICAgICAgICYmICghUGVyc2lzdGVuY2VDYXBh\nYmxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20KICAgICAgICAgICAgKF9vd25l\nci5nZXREZXNjcmliZWRUeXBlKCkpCiAgICAgICAgICAgIHx8ICh2YWxpZGF0\nZSAmIE1ldGFEYXRhUmVwb3NpdG9yeS5WQUxJREFURV9VTkVOSEFOQ0VEKSA9\nPSAwKSkgewogICAgICAgICAgICB2YWxpZGF0ZUxSUygpOwogICAgICAgICAg\nICBpZiAoKHZhbGlkYXRlICYgcmVwb3MuVkFMSURBVEVfUlVOVElNRSkgPT0g\nMCkKICAgICAgICAgICAgICAgIHZhbGlkYXRlU3VwcG9ydGVkVHlwZSgpOwog\nICAgICAgICAgICB2YWxpZGF0ZVZhbHVlKCk7CiAgICAgICAgICAgIHZhbGlk\nYXRlRXh0ZW5zaW9uS2V5cygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRo\naXMgZmllbGQgY2FuIGJlIHVzZWQgZm9yIExSUy4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHZhbGlkYXRlTFJTKCkgewogICAgICAgIGlmICghaXNMUlMo\nKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBjYW4ndCB1c2Ug\nbHJzIGZvciBhcnJheXMKICAgICAgICBpZiAoZ2V0VHlwZUNvZGUoKSA9PSBK\nYXZhVHlwZXMuQVJSQVkpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0\nYUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWxycy1hcnJheSIsIHRoaXMpKTsK\nCiAgICAgICAgLy8gY2FuJ3QgdXNlIGxycyBmb3IgZXh0cmFuYWxpemVkIHZh\nbHMKICAgICAgICBpZiAoZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJiYWQtbHJzLWV4dGVybiIsIHRoaXMpKTsKCiAgICAgICAgLy8g\nY2FuJ3QgdXNlIGxycyBmb3IgY29uY3JldGUgdHlwZXMKICAgICAgICBpZiAo\nZ2V0VHlwZSgpICE9IENvbGxlY3Rpb24uY2xhc3MgJiYgZ2V0VHlwZSgpICE9\nIE1hcC5jbGFzcwogICAgICAgICAgICAmJiBnZXRUeXBlKCkgIT0gU2V0LmNs\nYXNzKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24o\nX2xvYy5nZXQoImJhZC1scnMtY29uY3JldGUiLCB0aGlzKSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRoaXMgZmllbGQgaXMgc3Vw\ncG9ydGVkIGJ5IHRoZSBydW50aW1lLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgdmFsaWRhdGVTdXBwb3J0ZWRUeXBlKCkgewogICAgICAgIC8vIGxvZyB3\nYXJuaW5ncyBhYm91dCB0aGluZ3Mgd2UgZG9uJ3QgaGFuZGxlCiAgICAgICAg\nT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiA9IGdldFJlcG9zaXRvcnkoKS5n\nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgQ29sbGVjdGlvbiBvcHRzID0g\nY29uZi5zdXBwb3J0ZWRPcHRpb25zKCk7CiAgICAgICAgTG9nIGxvZyA9IGNv\nbmYuZ2V0TG9nKGNvbmYuTE9HX01FVEFEQVRBKTsKICAgICAgICBzd2l0Y2gg\nKGdldFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nUEM6CiAgICAgICAgICAgICAgICBpZiAoaXNFbWJlZGRlZCgpICYmCiAgICAg\nICAgICAgICAgICAgICAgIW9wdHMuY29udGFpbnMoY29uZi5PUFRJT05fRU1C\nRURERURfUkVMQVRJT04pKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0RW1i\nZWRkZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fy\nbihfbG9jLmdldCgiY2FudC1lbWJlZCIsIHRoaXMpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZQogICAgICAgICAgICAgICAgaWYgKGlzRW1iZWRkZWQoKSAm\nJiBnZXREZWNsYXJlZFR5cGVDb2RlKCkgIT0gSmF2YVR5cGVzLlBDKSB7CiAg\nICAgICAgICAgICAgICAgICAgc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAg\nICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJl\nZC1leHRlcm4iLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09M\nTEVDVElPTjoKICAgICAgICAgICAgICAgIGlmICghb3B0cy5jb250YWlucyhj\nb25mLk9QVElPTl9UWVBFX0NPTExFQ1RJT04pKQogICAgICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigKICAgICAgICAg\nICAgICAgICAgICAgICAgX2xvYy5nZXQoInR5cGUtbm90LXN1cHBvcnRlZCIs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ29sbGVjdGlvbiIsIHRo\naXMpKTsKICAgICAgICAgICAgICAgIGlmIChfZWxlbS5pc0VtYmVkZGVkUEMo\nKQogICAgICAgICAgICAgICAgICAgICYmICFvcHRzLmNvbnRhaW5zKGNvbmYu\nT1BUSU9OX0VNQkVEREVEX0NPTExFQ1RJT05fUkVMQVRJT04pKQogICAgICAg\nICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIF9lbGVtLnNldEVtYmVk\nZGVkKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2Fy\nbkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4o\nX2xvYy5nZXQoImNhbnQtZW1iZWQtZWxlbWVudCIsIHRoaXMpKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGlmICgh\nb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9UWVBFX0FSUkFZKSkKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24o\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJ0eXBlLW5vdC1z\ndXBwb3J0ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkFycmF5\nIiwgdGhpcykpOwogICAgICAgICAgICAgICAgaWYgKF9lbGVtLmlzRW1iZWRk\nZWRQQygpCiAgICAgICAgICAgICAgICAgICAgJiYgIW9wdHMuY29udGFpbnMo\nY29uZi5PUFRJT05fRU1CRURERURfQ09MTEVDVElPTl9SRUxBVElPTikpCiAg\nICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgX2VsZW0uc2V0\nRW1iZWRkZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cu\naXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cu\nd2FybihfbG9jLmdldCgiY2FudC1lbWJlZC1lbGVtZW50IiwgdGhpcykpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgIGlm\nICghb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9UWVBFX01BUCkpCiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9u\nKAogICAgICAgICAgICAgICAgICAgICAgICBfbG9jLmdldCgidHlwZS1ub3Qt\nc3VwcG9ydGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNYXAi\nLCB0aGlzKSk7CiAgICAgICAgICAgICAgICBpZiAoX2VsZW0uaXNFbWJlZGRl\nZFBDKCkKICAgICAgICAgICAgICAgICAgICAmJiAhb3B0cy5jb250YWlucyhj\nb25mLk9QVElPTl9FTUJFRERFRF9NQVBfUkVMQVRJT04pKSB7CiAgICAgICAg\nICAgICAgICAgICAgX2VsZW0uc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAg\nICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJl\nZC1lbGVtZW50IiwgdGhpcykpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgaWYgKF9rZXkuaXNFbWJlZGRlZFBDKCkKICAgICAgICAgICAg\nICAgICAgICAmJiAhb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9FTUJFRERF\nRF9NQVBfUkVMQVRJT04pKSB7CiAgICAgICAgICAgICAgICAgICAgX2tleS5z\nZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxv\nZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxv\nZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVkLWtleSIsIHRoaXMpKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlIG91ciB2YWx1ZSBz\ndHJhdGVneS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlVmFs\ndWUoKSB7CiAgICAgICAgaWYgKGdldEV4dGVybmFsaXplck1ldGhvZCgpICE9\nIG51bGwgJiYgZ2V0RXh0ZXJuYWxWYWx1ZU1hcCgpICE9IG51bGwpCiAgICAg\nICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgi\nZXh0ZXJuLWV4dGVybnZhbHVlcyIsIHRoaXMpKTsKICAgICAgICBpZiAoZ2V0\nVmFsdWVTdHJhdGVneSgpID09IFZhbHVlU3RyYXRlZ2llcy5TRVFVRU5DRQog\nICAgICAgICAgICAmJiBnZXRWYWx1ZVNlcXVlbmNlTmFtZSgpID09IG51bGwp\nCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9j\nLmdldCgibm8tc2VxLW5hbWUiLCB0aGlzKSk7CiAgICAgICAgVmFsdWVTdHJh\ndGVnaWVzLmFzc2VydFN1cHBvcnRlZChnZXRWYWx1ZVN0cmF0ZWd5KCksIHRo\naXMsCiAgICAgICAgICAgICJ2YWx1ZSBzdHJhdGVneSIpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ29weSBzdGF0ZSBmcm9tIHRoZSBnaXZlbiBmaWVsZCB0\nbyB0aGlzIG9uZS4gRG8gbm90IGNvcHkgbWFwcGluZwogICAgICogaW5mb3Jt\nYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNvcHkoRmllbGRNZXRh\nRGF0YSBmaWVsZCkgewogICAgICAgIHN1cGVyLmNvcHkoZmllbGQpOwoKICAg\nICAgICBfaW50ZXJtZWRpYXRlID0gZmllbGQudXNlc0ludGVybWVkaWF0ZSgp\nOwogICAgICAgIF9pbXBsRGF0YSA9IGZpZWxkLnVzZXNJbXBsRGF0YSgpOwoK\nICAgICAgICAvLyBjb3B5IGZpZWxkLWxldmVsIGluZm87IHVzZSBnZXQgbWV0\naG9kcyB0byBmb3JjZSByZXNvbHV0aW9uIG9mCiAgICAgICAgLy8gbGF6eSBk\nYXRhCiAgICAgICAgX3Byb3h5Q2xhc3MgPSBmaWVsZC5nZXRQcm94eVR5cGUo\nKTsKICAgICAgICBfaW5pdGlhbGl6ZXIgPSBmaWVsZC5nZXRJbml0aWFsaXpl\ncigpOwogICAgICAgIF90cmFuc2llbnQgPSBmaWVsZC5pc1RyYW5zaWVudCgp\nOwogICAgICAgIF9udWxsVmFsdWUgPSBmaWVsZC5nZXROdWxsVmFsdWUoKTsK\nICAgICAgICBfbWFuYWdlID0gZmllbGQuZ2V0TWFuYWdlbWVudCgpOwogICAg\nICAgIF9leHBsaWNpdCA9IGZpZWxkLmlzRXhwbGljaXQoKTsKICAgICAgICBf\nZXh0TmFtZSA9IGZpZWxkLmdldEV4dGVybmFsaXplcigpOwogICAgICAgIF9l\neHRNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAgICAgICBfZmFjdE5hbWUg\nPSBmaWVsZC5nZXRGYWN0b3J5KCk7CiAgICAgICAgX2ZhY3RNZXRob2QgPSBE\nRUZBVUxUX01FVEhPRDsKICAgICAgICBfZXh0U3RyaW5nID0gZmllbGQuZ2V0\nRXh0ZXJuYWxWYWx1ZXMoKTsKICAgICAgICBfZXh0VmFsdWVzID0gQ29sbGVj\ndGlvbnMuRU1QVFlfTUFQOwogICAgICAgIF9maWVsZFZhbHVlcyA9IENvbGxl\nY3Rpb25zLkVNUFRZX01BUDsKICAgICAgICBfcHJpbUtleSA9IGZpZWxkLmlz\nUHJpbWFyeUtleSgpOwogICAgICAgIF9iYWNraW5nTWVtYmVyID0gZmllbGQu\nX2JhY2tpbmdNZW1iZXI7CgogICAgICAgIC8vIGVtYmVkZGVkIGZpZWxkcyBj\nYW4ndCBiZSB2ZXJzaW9ucwogICAgICAgIGlmIChfb3duZXIuZ2V0RW1iZWRk\naW5nTWV0YURhdGEoKSA9PSBudWxsICYmIF92ZXJzaW9uID09IG51bGwpCiAg\nICAgICAgICAgIF92ZXJzaW9uID0gKGZpZWxkLmlzVmVyc2lvbigpKSA/IEJv\nb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0U7CgogICAgICAgIC8vIG9ubHkg\nY29weSB0aGlzIGRhdGEgaWYgbm90IGFscmVhZHkgc2V0IGV4cGxpY2l0bHkg\naW4gdGhpcyBpbnN0YW5jZQogICAgICAgIGlmIChfZGZnID09IDApIHsKICAg\nICAgICAgICAgX2RmZyA9IChmaWVsZC5pc0luRGVmYXVsdEZldGNoR3JvdXAo\nKSkgPyBERkdfVFJVRSA6IERGR19GQUxTRTsKICAgICAgICAgICAgaWYgKGZp\nZWxkLmlzRGVmYXVsdEZldGNoR3JvdXBFeHBsaWNpdCgpKQogICAgICAgICAg\nICAgICAgX2RmZyB8PSBERkdfRVhQTElDSVQ7CiAgICAgICAgfQogICAgICAg\nIGlmIChfZmdTZXQgPT0gbnVsbCAmJiBmaWVsZC5fZmdTZXQgIT0gbnVsbCkK\nICAgICAgICAgICAgX2ZnU2V0ID0gbmV3IEhhc2hTZXQoZmllbGQuX2ZnU2V0\nKTsKICAgICAgICBpZiAoX2xmZyA9PSBudWxsKQogICAgICAgICAgICBfbGZn\nID0gZmllbGQuZ2V0TG9hZEZldGNoR3JvdXAoKTsKICAgICAgICBpZiAoX2xy\ncyA9PSBudWxsKQogICAgICAgICAgICBfbHJzID0gKGZpZWxkLmlzTFJTKCkp\nID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsKICAgICAgICBpZiAo\nX3ZhbFN0cmF0ZWd5ID09IC0xKQogICAgICAgICAgICBfdmFsU3RyYXRlZ3kg\nPSBmaWVsZC5nZXRWYWx1ZVN0cmF0ZWd5KCk7CiAgICAgICAgaWYgKF91cFN0\ncmF0ZWd5ID09IC0xKQogICAgICAgICAgICBfdXBTdHJhdGVneSA9IGZpZWxk\nLmdldFVwZGF0ZVN0cmF0ZWd5KCk7CiAgICAgICAgaWYgKENsYXNzTWV0YURh\ndGEuREVGQVVMVF9TVFJJTkcuZXF1YWxzKF9zZXFOYW1lKSkgewogICAgICAg\nICAgICBfc2VxTmFtZSA9IGZpZWxkLmdldFZhbHVlU2VxdWVuY2VOYW1lKCk7\nCiAgICAgICAgICAgIF9zZXFNZXRhID0gbnVsbDsKICAgICAgICB9CiAgICAg\nICAgaWYgKENsYXNzTWV0YURhdGEuREVGQVVMVF9TVFJJTkcuZXF1YWxzKF9p\nbnZlcnNlKSkKICAgICAgICAgICAgX2ludmVyc2UgPSBmaWVsZC5nZXRJbnZl\ncnNlKCk7CgogICAgICAgIC8vIGNvcHkgdmFsdWUgbWV0YWRhdGEKICAgICAg\nICBfdmFsLmNvcHkoZmllbGQpOwogICAgICAgIF9rZXkuY29weShmaWVsZC5n\nZXRLZXkoKSk7CiAgICAgICAgX2VsZW0uY29weShmaWVsZC5nZXRFbGVtZW50\nKCkpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFkZEV4dGVuc2lvbktl\neXMoQ29sbGVjdGlvbiBleHRzKSB7CiAgICAgICAgZ2V0UmVwb3NpdG9yeSgp\nLmdldE1ldGFEYXRhRmFjdG9yeSgpLmFkZEZpZWxkRXh0ZW5zaW9uS2V5cyhl\neHRzKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8KICAgIC8vIENvbW1l\nbnRhYmxlCiAgICAvLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgU3RyaW5n\nW10gZ2V0Q29tbWVudHMoKSB7CiAgICAgICAgcmV0dXJuIChfY29tbWVudHMg\nPT0gbnVsbCkgPyBFTVBUWV9DT01NRU5UUyA6IF9jb21tZW50czsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRDb21tZW50cyhTdHJpbmdbXSBjb21tZW50\ncykgewogICAgICAgIF9jb21tZW50cyA9IGNvbW1lbnRzOwogICAgfQoKICAg\nIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBWYWx1\nZU1ldGFEYXRhIGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhIGdl\ndEZpZWxkTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9\nCgogICAgcHVibGljIENsYXNzIGdldFR5cGUoKSB7CiAgICAgICAgcmV0dXJu\nIF92YWwuZ2V0VHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFR5\ncGUoQ2xhc3MgdHlwZSkgewogICAgICAgIF92YWwuc2V0VHlwZSh0eXBlKTsK\nICAgICAgICBpZiAodHlwZS5pc0FycmF5KCkpCiAgICAgICAgICAgIF9lbGVt\nLnNldFR5cGUodHlwZS5nZXRDb21wb25lbnRUeXBlKCkpOwogICAgICAgIGVs\nc2UgaWYgKHR5cGUgPT0gUHJvcGVydGllcy5jbGFzcykgewogICAgICAgICAg\nICBfa2V5LnNldFR5cGUoU3RyaW5nLmNsYXNzKTsKICAgICAgICAgICAgX2Vs\nZW0uc2V0VHlwZShTdHJpbmcuY2xhc3MpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgaW50IGdldFR5cGVDb2RlKCkgewogICAgICAgIHJldHVybiBf\ndmFsLmdldFR5cGVDb2RlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nVHlwZUNvZGUoaW50IGNvZGUpIHsKICAgICAgICBfdmFsLnNldFR5cGVDb2Rl\nKGNvZGUpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVHlwZVBDKCkg\newogICAgICAgIHJldHVybiBfdmFsLmlzVHlwZVBDKCk7CiAgICB9CgogICAg\ncHVibGljIENsYXNzTWV0YURhdGEgZ2V0VHlwZU1ldGFEYXRhKCkgewogICAg\nICAgIHJldHVybiBfdmFsLmdldFR5cGVNZXRhRGF0YSgpOwogICAgfQoKICAg\nIHB1YmxpYyBDbGFzcyBnZXREZWNsYXJlZFR5cGUoKSB7CiAgICAgICAgcmV0\ndXJuIF92YWwuZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0RGVjbGFyZWRUeXBlKENsYXNzIHR5cGUpIHsKICAgICAgICBf\ndmFsLnNldERlY2xhcmVkVHlwZSh0eXBlKTsKICAgICAgICBpZiAodHlwZS5p\nc0FycmF5KCkpCiAgICAgICAgICAgIF9lbGVtLnNldERlY2xhcmVkVHlwZSh0\neXBlLmdldENvbXBvbmVudFR5cGUoKSk7CiAgICAgICAgZWxzZSBpZiAodHlw\nZSA9PSBQcm9wZXJ0aWVzLmNsYXNzKSB7CiAgICAgICAgICAgIF9rZXkuc2V0\nRGVjbGFyZWRUeXBlKFN0cmluZy5jbGFzcyk7CiAgICAgICAgICAgIF9lbGVt\nLnNldERlY2xhcmVkVHlwZShTdHJpbmcuY2xhc3MpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgaW50IGdldERlY2xhcmVkVHlwZUNvZGUoKSB7CiAg\nICAgICAgcmV0dXJuIF92YWwuZ2V0RGVjbGFyZWRUeXBlQ29kZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkVHlwZUNvZGUoaW50IHR5\ncGUpIHsKICAgICAgICBfdmFsLnNldERlY2xhcmVkVHlwZUNvZGUodHlwZSk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEZWNsYXJlZFR5cGVQQygp\nIHsKICAgICAgICByZXR1cm4gX3ZhbC5pc0RlY2xhcmVkVHlwZVBDKCk7CiAg\nICB9CgogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0RGVjbGFyZWRUeXBl\nTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RGVjbGFyZWRU\neXBlTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0Vt\nYmVkZGVkKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzRW1iZWRkZWQoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFbWJlZGRlZChib29sZWFuIGVt\nYmVkZGVkKSB7CiAgICAgICAgX3ZhbC5zZXRFbWJlZGRlZChlbWJlZGRlZCk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNFbWJlZGRlZFBDKCkgewog\nICAgICAgIHJldHVybiBfdmFsLmlzRW1iZWRkZWRQQygpOwogICAgfQoKICAg\nIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdldEVtYmVkZGVkTWV0YURhdGEoKSB7\nCiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RW1iZWRkZWRNZXRhRGF0YSgpOwog\nICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGFkZEVtYmVkZGVkTWV0\nYURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuYWRkRW1iZWRkZWRNZXRh\nRGF0YSgpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0Q2FzY2FkZURlbGV0\nZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRDYXNjYWRlRGVsZXRlKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2FzY2FkZURlbGV0ZShpbnQg\nZGVsZXRlKSB7CiAgICAgICAgX3ZhbC5zZXRDYXNjYWRlRGVsZXRlKGRlbGV0\nZSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRDYXNjYWRlUGVyc2lzdCgp\nIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRDYXNjYWRlUGVyc2lzdCgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhc2NhZGVQZXJzaXN0KGludCBw\nZXJzaXN0KSB7CiAgICAgICAgX3ZhbC5zZXRDYXNjYWRlUGVyc2lzdChwZXJz\naXN0KTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENhc2NhZGVBdHRhY2go\nKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Q2FzY2FkZUF0dGFjaCgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhc2NhZGVBdHRhY2goaW50IGF0\ndGFjaCkgewogICAgICAgIF92YWwuc2V0Q2FzY2FkZUF0dGFjaChhdHRhY2gp\nOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0Q2FzY2FkZVJlZnJlc2goKSB7\nCiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Q2FzY2FkZVJlZnJlc2goKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDYXNjYWRlUmVmcmVzaChpbnQgcmVm\ncmVzaCkgewogICAgICAgIF92YWwuc2V0Q2FzY2FkZVJlZnJlc2gocmVmcmVz\naCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNTZXJpYWxpemVkKCkg\newogICAgICAgIHJldHVybiBfdmFsLmlzU2VyaWFsaXplZCgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldFNlcmlhbGl6ZWQoYm9vbGVhbiBzZXJpYWxp\nemVkKSB7CiAgICAgICAgX3ZhbC5zZXRTZXJpYWxpemVkKHNlcmlhbGl6ZWQp\nOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWVNYXBwZWRCeSgp\nIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRWYWx1ZU1hcHBlZEJ5KCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0VmFsdWVNYXBwZWRCeShTdHJpbmcg\nbWFwcGVkKSB7CiAgICAgICAgX3ZhbC5zZXRWYWx1ZU1hcHBlZEJ5KG1hcHBl\nZCk7CiAgICB9CgogICAgcHVibGljIEZpZWxkTWV0YURhdGEgZ2V0VmFsdWVN\nYXBwZWRCeU1ldGFEYXRhICgpCgl7CgkJcmV0dXJuIF92YWwuZ2V0VmFsdWVN\nYXBwZWRCeU1ldGFEYXRhICgpOwoJfQoKCXB1YmxpYyBDbGFzcyBnZXRUeXBl\nT3ZlcnJpZGUgKCkKCXsKCQlyZXR1cm4gX3ZhbC5nZXRUeXBlT3ZlcnJpZGUg\nKCk7Cgl9CgoJcHVibGljIHZvaWQgc2V0VHlwZU92ZXJyaWRlIChDbGFzcyB0\neXBlKQoJewoJCV92YWwuc2V0VHlwZU92ZXJyaWRlICh0eXBlKTsKCX0KCglw\ndWJsaWMgdm9pZCBjb3B5IChWYWx1ZU1ldGFEYXRhIHZtZCkKCXsKCQlfdmFs\nLmNvcHkgKHZtZCk7Cgl9CgogICAgLyoqCiAgICAgKiBTZXJpYWxpemFibGUg\nd3JhcHBlciBhcm91bmQgYSB7QGxpbmsgTWV0aG9kfSBvciB7QGxpbmsgRmll\nbGR9LiBGb3IgCiAgICAgKiBzcGFjZSBjb25zaWRlcmF0aW9ucywgdGhpcyBk\nb2VzIG5vdCBzdXBwb3J0IHtAbGluayBDb25zdHJ1Y3Rvcn1zLgogICAgICov\nCglwcml2YXRlIHN0YXRpYyBjbGFzcyBNZW1iZXJQcm92aWRlciAKICAgICAg\nICBpbXBsZW1lbnRzIEV4dGVybmFsaXphYmxlIHsKCiAgICAgICAgcHJpdmF0\nZSB0cmFuc2llbnQgTWVtYmVyIF9tZW1iZXI7CiAgICAgICAgCiAgICAgICAg\ncHJpdmF0ZSBNZW1iZXJQcm92aWRlcihNZW1iZXIgbWVtYmVyKSB7CiAgICAg\nICAgICAgIGlmIChfbWVtYmVyIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0\naW9uKCk7CgogICAgICAgICAgICBfbWVtYmVyID0gbWVtYmVyOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgTWVtYmVyIGdldE1lbWJlcigp\nIHsKICAgICAgICAgICAgcmV0dXJuIF9tZW1iZXI7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCByZWFkRXh0ZXJuYWwoT2JqZWN0SW5wdXQgaW4p\nCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJvb2xlYW4gaXNGaWVsZCA9IGlu\nLnJlYWRCb29sZWFuKCk7CiAgICAgICAgICAgIENsYXNzIGNscyA9IF9tZW1i\nZXIuZ2V0RGVjbGFyaW5nQ2xhc3MoKTsKICAgICAgICAgICAgU3RyaW5nIG1l\nbWJlck5hbWUgPSAoU3RyaW5nKSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoaXNGaWVsZCkKICAgICAg\nICAgICAgICAgICAgICBfbWVtYmVyID0gY2xzLmdldERlY2xhcmVkRmllbGQo\nbWVtYmVyTmFtZSk7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICBDbGFzc1tdIHBhcmFtZXRlclR5cGVzID0gKENsYXNzW10p\nIGluLnJlYWRPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgICBfbWVtYmVy\nID0gY2xzLmdldERlY2xhcmVkTWV0aG9kKG1lbWJlck5hbWUsIHBhcmFtZXRl\nclR5cGVzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRj\naCAoU2VjdXJpdHlFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgSU9F\neGNlcHRpb24gaW9lID0gbmV3IElPRXhjZXB0aW9uKGUuZ2V0TWVzc2FnZSgp\nKTsKICAgICAgICAgICAgICAgIGlvZS5pbml0Q2F1c2UoZSk7CiAgICAgICAg\nICAgICAgICB0aHJvdyBpb2U7CiAgICAgICAgICAgIH0gY2F0Y2ggKE5vU3Vj\naEZpZWxkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIElPRXhjZXB0\naW9uIGlvZSA9IG5ldyBJT0V4Y2VwdGlvbihlLmdldE1lc3NhZ2UoKSk7CiAg\nICAgICAgICAgICAgICBpb2UuaW5pdENhdXNlKGUpOwogICAgICAgICAgICAg\nICAgdGhyb3cgaW9lOwogICAgICAgICAgICB9IGNhdGNoIChOb1N1Y2hNZXRo\nb2RFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgSU9FeGNlcHRpb24g\naW9lID0gbmV3IElPRXhjZXB0aW9uKGUuZ2V0TWVzc2FnZSgpKTsKICAgICAg\nICAgICAgICAgIGlvZS5pbml0Q2F1c2UoZSk7CiAgICAgICAgICAgICAgICB0\naHJvdyBpb2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIHdyaXRlRXh0ZXJuYWwoT2JqZWN0T3V0cHV0IG91dCkKICAg\nICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgYm9v\nbGVhbiBpc0ZpZWxkID0gX21lbWJlciBpbnN0YW5jZW9mIEZpZWxkOwogICAg\nICAgICAgICBvdXQud3JpdGVCb29sZWFuKGlzRmllbGQpOwogICAgICAgICAg\nICBvdXQud3JpdGVPYmplY3QoX21lbWJlci5nZXREZWNsYXJpbmdDbGFzcygp\nKTsKICAgICAgICAgICAgb3V0LndyaXRlT2JqZWN0KF9tZW1iZXIuZ2V0TmFt\nZSgpKTsKICAgICAgICAgICAgaWYgKCFpc0ZpZWxkKQogICAgICAgICAgICAg\nICAgb3V0LndyaXRlT2JqZWN0KCgoTWV0aG9kKSBfbWVtYmVyKS5nZXRQYXJh\nbWV0ZXJUeXBlcygpKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

