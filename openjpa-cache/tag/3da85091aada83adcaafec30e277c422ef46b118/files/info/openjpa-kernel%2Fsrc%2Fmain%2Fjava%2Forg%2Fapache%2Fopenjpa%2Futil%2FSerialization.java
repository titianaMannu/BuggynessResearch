{"sha":"f70d0175e1187f51d7f03820254d4192b07d5061","node_id":"MDQ6QmxvYjIwNjM2NDpmNzBkMDE3NWUxMTg3ZjUxZDdmMDM4MjAyNTRkNDE5MmIwN2Q1MDYx","size":6286,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f70d0175e1187f51d7f03820254d4192b07d5061","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbDsKCmltcG9ydCBqYXZh\nLmlvLkJ5dGVBcnJheUlucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5CeXRl\nQXJyYXlPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8u\nT2JqZWN0SW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLk9iamVjdE91dHB1\ndFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0U3RyZWFtQ2xhc3M7Cmlt\ncG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uU2Vy\naWFsaXphYmxlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9w\nZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLk11bHRpQ2xhc3NMb2FkZXI7CgovKioKICogSGVscGVyIGNsYXNz\nIHRvIHNlcmlhbGl6ZSBhbmQgZGVzZXJpYWxpemUgcGVyc2lzdGVudCBvYmpl\nY3RzLAogKiBzdWJ0aXR1dGluZyBvaWRzIGludG8gdGhlIHNlcmlhbGl6ZWQg\nc3RyZWFtIGFuZCBzdWJ0aXR1dGluZyB0aGUgcGVyc2lzdGVudAogKiBvYmpl\nY3RzIGJhY2sgZHVyaW5nIGRlc2VyaWFsaXphdGlvbi4KICoKICogQGF1dGhv\nciBBYmUgV2hpdGUKICogQHNpbmNlIDAuMy4zCiAqIEBub2phdmFkb2MKICov\nCnB1YmxpYyBjbGFzcyBTZXJpYWxpemF0aW9uIHsKCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNr\nYWdlCiAgICAgICAgKFNlcmlhbGl6YXRpb24uY2xhc3MpOwoKICAgIC8qKgog\nICAgICogU2VyaWFsaXplIGEgdmFsdWUgdGhhdCBtaWdodCBjb250YWluIHBl\ncnNpc3RlbnQgb2JqZWN0cy4gUmVwbGFjZXMKICAgICAqIHBlcnNpc3RlbnQg\nb2JqZWN0cyB3aXRoIHRoZWlyIG9pZHMuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgYnl0ZVtdIHNlcmlhbGl6ZShPYmplY3QgdmFsLCBTdG9yZUNvbnRl\neHQgY3R4KSB7CiAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGJ5dGVz\nID0gbmV3IEJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIE9iamVjdE91dHB1dFN0cmVhbSBvYmpzID0gbmV3IFBl\ncnNpc3RlbnRPYmplY3RPdXRwdXRTdHJlYW0oYnl0ZXMsCiAgICAgICAgICAg\nICAgICBjdHgpOwogICAgICAgICAgICBvYmpzLndyaXRlT2JqZWN0KHZhbCk7\nCiAgICAgICAgICAgIG9ianMuZmx1c2goKTsKICAgICAgICAgICAgcmV0dXJu\nIGJ5dGVzLnRvQnl0ZUFycmF5KCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9u\nKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERlc2VyaWFs\naXplIGFuIG9iamVjdCB2YWx1ZSBmcm9tIHRoZSBnaXZlbiBieXRlcy4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgZGVzZXJpYWxpemUoYnl0\nZVtdIGJ5dGVzLCBTdG9yZUNvbnRleHQgY3R4KSB7CiAgICAgICAgQnl0ZUFy\ncmF5SW5wdXRTdHJlYW0gaW4gPSBuZXcgQnl0ZUFycmF5SW5wdXRTdHJlYW0o\nYnl0ZXMpOwogICAgICAgIHJldHVybiBkZXNlcmlhbGl6ZShpbiwgY3R4KTsK\nICAgIH0KCiAgICAvKioKICAgICAqIERlc2VyaWFsaXplIGFuIG9iamVjdCB2\nYWx1ZSBmcm9tIHRoZSBnaXZlbiBzdHJlYW0uCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgT2JqZWN0IGRlc2VyaWFsaXplKElucHV0U3RyZWFtIGluLCBT\ndG9yZUNvbnRleHQgY3R4KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naWYgKGN0eCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBD\nbGFzc1Jlc29sdmluZ09iamVjdElucHV0U3RyZWFtKGluKS5yZWFkT2JqZWN0\nKCk7CiAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVudE9iamVjdElu\ncHV0U3RyZWFtKGluLCBjdHgpLnJlYWRPYmplY3QoKTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgU3Rv\ncmVFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogT2JqZWN0IG91dHB1dCBzdHJlYW0gdGhhdCByZXBsYWNlcyBwZXJzaXN0\nZW50IG9iamVjdHMgd2l0aCB0aGVpciBvaWRzLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGNsYXNzIFBlcnNpc3RlbnRPYmplY3RPdXRwdXRTdHJlYW0K\nICAgICAgICBleHRlbmRzIE9iamVjdE91dHB1dFN0cmVhbSB7CgogICAgICAg\nIHByaXZhdGUgU3RvcmVDb250ZXh0IF9jdHg7CgogICAgICAgIC8qKgogICAg\nICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgdW5kZXJseWluZyBzdHJlYW0u\nCiAgICAgICAgICovCiAgICAgICAgcHVibGljIFBlcnNpc3RlbnRPYmplY3RP\ndXRwdXRTdHJlYW0oT3V0cHV0U3RyZWFtIGRlbGVnYXRlLAogICAgICAgICAg\nICBTdG9yZUNvbnRleHQgY3R4KQogICAgICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgICAgICBzdXBlcihkZWxlZ2F0ZSk7CiAgICAgICAg\nICAgIF9jdHggPSBjdHg7CiAgICAgICAgICAgIGVuYWJsZVJlcGxhY2VPYmpl\nY3QodHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgT2JqZWN0\nIHJlcGxhY2VPYmplY3QoT2JqZWN0IG9iaikgewogICAgICAgICAgICBPYmpl\nY3Qgb2lkID0gX2N0eC5nZXRPYmplY3RJZChvYmopOwogICAgICAgICAgICBy\nZXR1cm4gKG9pZCA9PSBudWxsKSA/IG9iaiA6IG5ldyBPYmplY3RJZE1hcmtl\ncihvaWQpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIENsYXNzUmVzb2x2aW5nT2JqZWN0SW5wdXRTdHJlYW0KICAgICAgICBl\neHRlbmRzIE9iamVjdElucHV0U3RyZWFtIHsKCiAgICAgICAgcHVibGljIENs\nYXNzUmVzb2x2aW5nT2JqZWN0SW5wdXRTdHJlYW0oSW5wdXRTdHJlYW0gZGVs\nZWdhdGUpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIHN1cGVyKGRlbGVnYXRlKTsKICAgICAgICB9CgogICAgICAgIHBy\nb3RlY3RlZCBDbGFzcyByZXNvbHZlQ2xhc3MoT2JqZWN0U3RyZWFtQ2xhc3Mg\nZGVzYykgCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NO\nb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIE11bHRpQ2xhc3NMb2Fk\nZXIgbG9hZGVyID0gbmV3IE11bHRpQ2xhc3NMb2FkZXIoKTsKICAgICAgICAg\nICAgYWRkQ29udGV4dENsYXNzTG9hZGVycyhsb2FkZXIpOwogICAgICAgICAg\nICBsb2FkZXIuYWRkQ2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKS5nZXRDbGFzc0xv\nYWRlcigpKTsKICAgICAgICAgICAgbG9hZGVyLmFkZENsYXNzTG9hZGVyKE11\nbHRpQ2xhc3NMb2FkZXIuU1lTVEVNX0xPQURFUik7CiAgICAgICAgICAgIHJl\ndHVybiBDbGFzcy5mb3JOYW1lKGRlc2MuZ2V0TmFtZSgpLCB0cnVlLCBsb2Fk\nZXIpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgYWRkQ29u\ndGV4dENsYXNzTG9hZGVycyhNdWx0aUNsYXNzTG9hZGVyIGxvYWRlcikgewog\nICAgICAgICAgICBsb2FkZXIuYWRkQ2xhc3NMb2FkZXIoVGhyZWFkLmN1cnJl\nbnRUaHJlYWQoKS4KICAgICAgICAgICAgICAgIGdldENvbnRleHRDbGFzc0xv\nYWRlcigpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBPYmpl\nY3QgaW5wdXQgc3RyZWFtIHRoYXQgcmVwbGFjZXMgb2lkcyB3aXRoIHRoZWly\nIG9iamVjdHMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgUGVy\nc2lzdGVudE9iamVjdElucHV0U3RyZWFtCiAgICAgICAgZXh0ZW5kcyBDbGFz\nc1Jlc29sdmluZ09iamVjdElucHV0U3RyZWFtIHsKCiAgICAgICAgcHJpdmF0\nZSBmaW5hbCBTdG9yZUNvbnRleHQgX2N0eDsKCiAgICAgICAgLyoqCiAgICAg\nICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBzb3VyY2Ugc3RyZWFtIGFuZCBi\ncm9rZXIgdG8KICAgICAgICAgKiB1c2UgZm9yIHBlcnNpc3RlbnQgb2JqZWN0\nIGxvb2t1cHMuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIFBlcnNpc3Rl\nbnRPYmplY3RJbnB1dFN0cmVhbShJbnB1dFN0cmVhbSBkZWxlZ2F0ZSwKICAg\nICAgICAgICAgU3RvcmVDb250ZXh0IGN0eCkKICAgICAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgc3VwZXIoZGVsZWdhdGUpOwog\nICAgICAgICAgICBfY3R4ID0gY3R4OwogICAgICAgICAgICBlbmFibGVSZXNv\nbHZlT2JqZWN0KHRydWUpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVk\nIHZvaWQgYWRkQ29udGV4dENsYXNzTG9hZGVycyhNdWx0aUNsYXNzTG9hZGVy\nIGxvYWRlcikgewogICAgICAgICAgICBzdXBlci5hZGRDb250ZXh0Q2xhc3NM\nb2FkZXJzKGxvYWRlcik7CiAgICAgICAgICAgIGxvYWRlci5hZGRDbGFzc0xv\nYWRlcihfY3R4LmdldENsYXNzTG9hZGVyKCkpOwogICAgICAgIH0KCiAgICAg\nICAgcHJvdGVjdGVkIE9iamVjdCByZXNvbHZlT2JqZWN0KE9iamVjdCBvYmop\nIHsKICAgICAgICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgT2JqZWN0SWRN\nYXJrZXIpKQogICAgICAgICAgICAgICAgcmV0dXJuIG9iajsKCiAgICAgICAg\nICAgIE9iamVjdCBvaWQgPSAoKE9iamVjdElkTWFya2VyKSBvYmopLm9pZDsK\nICAgICAgICAgICAgaWYgKG9pZCA9PSBudWxsKQogICAgICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgICAgICBPYmplY3QgcGMgPSBfY3R4LmZp\nbmQob2lkLCBudWxsLCBudWxsLCBudWxsLCAwKTsKICAgICAgICAgICAgaWYg\nKHBjID09IG51bGwpIHsKICAgICAgICAgICAgICAgIExvZyBsb2cgPSBfY3R4\nLmdldENvbmZpZ3VyYXRpb24oKS5nZXRMb2cKICAgICAgICAgICAgICAgICAg\nICAoT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAg\nICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAg\nICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImJhZC1zZXItb2lkIiwgb2lk\nKSk7CiAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgbG9nLnRyYWNlKG5ldyBPYmplY3ROb3RG\nb3VuZEV4Y2VwdGlvbihvaWQpKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gcGM7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nTWFya2VyIGZvciBvaWRzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBj\nbGFzcyBPYmplY3RJZE1hcmtlcgogICAgICAgIGltcGxlbWVudHMgU2VyaWFs\naXphYmxlIHsKCiAgICAgICAgcHVibGljIE9iamVjdCBvaWQ7CgogICAgICAg\nIHB1YmxpYyBPYmplY3RJZE1hcmtlcihPYmplY3Qgb2lkKSB7CiAgICAgICAg\nICAgIHRoaXMub2lkID0gb2lkOwoJCX0KCX0gCn0KCg==\n","encoding":"base64"}

