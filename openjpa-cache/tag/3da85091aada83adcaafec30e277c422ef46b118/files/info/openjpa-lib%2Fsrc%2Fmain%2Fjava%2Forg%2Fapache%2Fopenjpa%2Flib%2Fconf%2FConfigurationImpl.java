{"sha":"dcf94e19f9f09ef8006f44251a9bb246f4b10e73","node_id":"MDQ6QmxvYjIwNjM2NDpkY2Y5NGUxOWY5ZjA5ZWY4MDA2ZjQ0MjUxYTliYjI0NmY0YjEwZTcz","size":33315,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dcf94e19f9f09ef8006f44251a9bb246f4b10e73","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS5hd3QuSW1hZ2U7CmltcG9ydCBqYXZhLmJlYW5zLkJlYW5EZXNjcmlw\ndG9yOwppbXBvcnQgamF2YS5iZWFucy5CZWFuSW5mbzsKaW1wb3J0IGphdmEu\nYmVhbnMuRXZlbnRTZXREZXNjcmlwdG9yOwppbXBvcnQgamF2YS5iZWFucy5J\nbnRyb3NwZWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS5iZWFucy5JbnRy\nb3NwZWN0b3I7CmltcG9ydCBqYXZhLmJlYW5zLk1ldGhvZERlc2NyaXB0b3I7\nCmltcG9ydCBqYXZhLmJlYW5zLlByb3BlcnR5Q2hhbmdlTGlzdGVuZXI7Cmlt\ncG9ydCBqYXZhLmJlYW5zLlByb3BlcnR5Q2hhbmdlU3VwcG9ydDsKaW1wb3J0\nIGphdmEuYmVhbnMuUHJvcGVydHlEZXNjcmlwdG9yOwppbXBvcnQgamF2YS5p\nby5FeHRlcm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0\nIGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLk9iamVjdElu\ncHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXQ7CmltcG9ydCBqYXZh\nLmlvLlByaW50V3JpdGVyOwppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7\nCmltcG9ydCBqYXZhLmlvLlN0cmluZ1dyaXRlcjsKaW1wb3J0IGphdmEubGFu\nZy5yZWZsZWN0LkNvbnN0cnVjdG9yOwppbXBvcnQgamF2YS5sYW5nLnJlZmxl\nY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEubGFu\nZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNv\nbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRv\ncjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKaW1wb3J0IGphdmEudXRpbC5NaXNzaW5nUmVzb3VyY2VFeGNlcHRpb247\nCmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKaW1wb3J0IGphdmEudXRp\nbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0\ncmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cu\nTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nRmFj\ndG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZ0Zh\nY3RvcnlJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cu\nTm9uZUxvZ0ZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuQ2xvc2VhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5NdWx0aUNsYXNzTG9hZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLlBhcnNlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLlNlcnZpY2VzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLlN0cmluZ0Rpc3RhbmNlOwppbXBvcnQg\nc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogRGVmYXVsdCBpbXBsZW1lbnRh\ndGlvbiBvZiB0aGUge0BsaW5rIENvbmZpZ3VyYXRpb259IGludGVyZmFjZS4K\nICogU3ViY2xhc3NlcyBjYW4gY2hvb3NlIHRvIG9idGFpbiBjb25maWd1cmF0\naW9uCiAqIGluZm9ybWF0aW9uIGZyb20gSk5ESSwgUHJvcGVydGllcywgYSBC\nZWFuLWJ1aWxkZXIsIGV0Yy4gVGhpcyBjbGFzcwogKiBwcm92aWRlcyBiYXNl\nIGNvbmZpZ3VyYXRpb24gZnVuY3Rpb25hbGl0eSwgaW5jbHVkaW5nIHNlcmlh\nbGl6YXRpb24sCiAqIHRoZSA8Y29kZT5lcXVhbHM8L2NvZGU+IGFuZCA8Y29k\nZT5oYXNoQ29kZTwvY29kZT4gY29udHJhY3RzLCBhbmQgZGVmYXVsdAogKiBw\ncm9wZXJ0eSBsb2FkaW5nLgogKiBQcm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3Ig\ne0BsaW5rIFZhbHVlfSBpbnN0YW5jZXMgYXJlIGNvbnN0cnVjdGVkIGZyb20K\nICogdGhlIHtAbGluayBMb2NhbGl6ZXJ9IGZvciB0aGUgcGFja2FnZSBvZiB0\naGUgY29uZmlndXJhdGlvbiBjbGFzcy4gVGhlCiAqIGZvbGxvd2luZyBsb2Nh\nbGl6ZWQgc3RyaW5ncyB3aWxsIGJlIHVzZWQgZm9yIGRlc2NyaWJpbmcgYSB2\nYWx1ZSwgd2hlcmUKICogPGVtPm5hbWU8L2VtPiBpcyB0aGUgbGFzdCB0b2tl\nbiBvZiB0aGUgdmFsdWUncyBwcm9wZXJ0eSBzdHJpbmc6CiAqIDx1bD4KICog\nPGxpPjxlbT5uYW1lPC9lbT4tbmFtZTogVGhlIG5hbWUgdGhhdCB3aWxsIGJl\nIGRpc3BsYXllZCBmb3IgdGhlCiAqIG9wdGlvbiBpbiBhIHVzZXIgaW50ZXJm\nYWNlOyByZXF1aXJlZC48L2xpPgogKiA8bGk+PGVtPm5hbWU8L2VtPi1kZXNj\nOiBBIGJyaWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBvcHRpb247IHJlcXVpcmVk\nLjwvbGk+CiAqIDxsaT48ZW0+bmFtZTwvZW0+LXR5cGU6IFRoZSB0eXBlIG9y\nIGNhdGVnb3J5IG5hbWUgZm9yIHRoaXMgb3B0aW9uOwogKiByZXF1aXJlZC48\nL2xpPgogKiA8bGk+PGVtPm5hbWU8L2VtPi1leHBlcnQ6IFRydWUgaWYgdGhp\ncyBpcyBhbiBleHBlcnQgb3B0aW9uLCBmYWxzZQogKiBvdGhlcndpc2U7IGRl\nZmF1bHRzIHRvIGZhbHNlLjwvbGk+CiAqIDxsaT48ZW0+bmFtZTwvZW0+LXZh\nbHVlczogU2V0IG9mIGV4cGVjdGVkIG9yIGNvbW1vbiB2YWx1ZXMsIGV4Y2x1\nZGluZwogKiBhbGlhcyBrZXlzOyBvcHRpb25hbC48L2xpPgogKiA8bGk+PGVt\nPm5hbWU8L2VtPi1pbnRlcmZhY2U6IFRoZSBjbGFzcyBuYW1lIG9mIGFuIGlu\ndGVyZmFjZSB3aG9zZQogKiBkaXNjb3ZlcmFibGUgaW1wbGVtZW50YXRpb25z\nIHNob3VsZCBiZSBpbmNsdWRlZCBpbiB0aGUgc2V0IG9mIGV4cGVjdGVkCiAq\nIG9yIGNvbW1vbiB2YWx1ZXM7IG9wdGlvbmFsLjwvbGk+CiAqIDxsaT48ZW0+\nbmFtZTwvZW0+LWNhdDogVGhlIGhpZXJhcmNoaWNhbCBjYXRlZ29yeSBmb3Ig\ndGhlIHByb3BlcnR5CiAqIG5hbWUsIHNlcGFyYXRlZCBieSAiLiIuCiAqIDxs\naT48ZW0+bmFtZTwvZW0+LWRpc3BsYXlvcmRlcjogVGhlIG9yZGVyIGluIHdo\naWNoIHRoZSBwcm9wZXJ0eSBzaG91bGQKICogYmUgZGlzcGxheWVyLjwvbGk+\nCiAqIDwvdWw+CiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMg\nY2xhc3MgQ29uZmlndXJhdGlvbkltcGwKICAgIGltcGxlbWVudHMgQ29uZmln\ndXJhdGlvbiwgRXh0ZXJuYWxpemFibGUsIFZhbHVlTGlzdGVuZXIgewoKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBTRVAgPSBTeXN0ZW0uZ2V0\nUHJvcGVydHkoImxpbmUuc2VwYXJhdG9yIik7CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZQogICAgICAgIChDb25maWd1cmF0aW9uSW1wbC5jbGFzcyk7CgogICAgcHVi\nbGljIE9iamVjdFZhbHVlIGxvZ0ZhY3RvcnlQbHVnaW47CiAgICBwdWJsaWMg\nU3RyaW5nVmFsdWUgaWQ7CgogICAgcHJpdmF0ZSBTdHJpbmcgX3Byb2R1Y3Qg\nPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9yZWFkT25seSA9IGZhbHNl\nOwogICAgcHJpdmF0ZSBNYXAgX3Byb3BzID0gbnVsbDsKICAgIHByaXZhdGUg\nYm9vbGVhbiBfZ2xvYmFscyA9IGZhbHNlOwogICAgcHJpdmF0ZSBTdHJpbmcg\nX2F1dG8gPSBudWxsOwogICAgcHJpdmF0ZSBmaW5hbCBMaXN0IF92YWxzID0g\nbmV3IEFycmF5TGlzdCgpOwoKICAgIC8vIHByb3BlcnR5IGxpc3RlbmVyIGhl\nbHBlcgogICAgcHJpdmF0ZSBQcm9wZXJ0eUNoYW5nZVN1cHBvcnQgX2NoYW5n\nZVN1cHBvcnQgPSBudWxsOwoKICAgIC8vIGNhY2hlIGRlc2NyaXB0b3JzCiAg\nICBwcml2YXRlIFByb3BlcnR5RGVzY3JpcHRvcltdIF9wZHMgPSBudWxsOwog\nICAgcHJpdmF0ZSBNZXRob2REZXNjcmlwdG9yW10gX21kcyA9IG51bGw7Cgog\nICAgLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yLiBBdHRlbXB0cyB0\nbyBsb2FkIGRlZmF1bHQgcHJvcGVydGllcyB0aHJvdWdoCiAgICAgKiBzeXN0\nZW0ncyBjb25maWd1cmVkIHtAbGluayBQcm9kdWN0RGVyaXZhdGlvbn1zLgog\nICAgICovCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvbkltcGwoKSB7CiAgICAg\nICAgdGhpcyh0cnVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVj\ndG9yLgogICAgICoKICAgICAqIEBwYXJhbSBsb2FkR2xvYmFscyB3aGV0aGVy\nIHRvIGF0dGVtcHQgdG8gbG9hZCB0aGUgZ2xvYmFsIHByb3BlcnRpZXMKICAg\nICAqLwogICAgcHVibGljIENvbmZpZ3VyYXRpb25JbXBsKGJvb2xlYW4gbG9h\nZEdsb2JhbHMpIHsKICAgICAgICBzZXRQcm9kdWN0TmFtZSgib3BlbmpwYSIp\nOwoKICAgICAgICBsb2dGYWN0b3J5UGx1Z2luID0gYWRkUGx1Z2luKCJMb2ci\nLCB0cnVlKTsKICAgICAgICBTdHJpbmdbXSBhbGlhc2VzID0gbmV3IFN0cmlu\nZ1tdewogICAgICAgICAgICAidHJ1ZSIsIExvZ0ZhY3RvcnlJbXBsLmNsYXNz\nLmdldE5hbWUoKSwKICAgICAgICAgICAgIm9wZW5qcGEiLCBMb2dGYWN0b3J5\nSW1wbC5jbGFzcy5nZXROYW1lKCksCiAgICAgICAgICAgICJjb21tb25zIiwg\nIm9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkNvbW1vbnNMb2dGYWN0b3J5\nIiwKICAgICAgICAgICAgImxvZzRqIiwgIm9yZy5hcGFjaGUub3BlbmpwYS5s\naWIubG9nLkxvZzRKTG9nRmFjdG9yeSIsCiAgICAgICAgICAgICJub25lIiwg\nTm9uZUxvZ0ZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgpLAogICAgICAgICAgICAi\nZmFsc2UiLCBOb25lTG9nRmFjdG9yeS5jbGFzcy5nZXROYW1lKCksCiAgICAg\nICAgfTsKICAgICAgICBsb2dGYWN0b3J5UGx1Z2luLnNldEFsaWFzZXMoYWxp\nYXNlcyk7CiAgICAgICAgbG9nRmFjdG9yeVBsdWdpbi5zZXREZWZhdWx0KGFs\naWFzZXNbMF0pOwogICAgICAgIGxvZ0ZhY3RvcnlQbHVnaW4uc2V0U3RyaW5n\nKGFsaWFzZXNbMF0pOwogICAgICAgIGxvZ0ZhY3RvcnlQbHVnaW4uc2V0SW5z\ndGFudGlhdGluZ0dldHRlcigiZ2V0TG9nRmFjdG9yeSIpOwoKICAgICAgICBp\nZCA9IGFkZFN0cmluZygiSWQiKTsKICAgICAgICAKICAgICAgICBpZiAobG9h\nZEdsb2JhbHMpCiAgICAgICAgICAgIGxvYWRHbG9iYWxzKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBdXRvbWF0aWNhbGx5IGxvYWQgZ2xvYmFsIHZhbHVl\ncyBmcm9tIHRoZSBzeXN0ZW0ncwogICAgICoge0BsaW5rIFByb2R1Y3REZXJp\ndmF0aW9ufXMsIGFuZCBmcm9tIFN5c3RlbSBwcm9wZXJ0aWVzLgogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBsb2FkR2xvYmFscygpIHsKICAgICAgICBN\ndWx0aUNsYXNzTG9hZGVyIGxvYWRlciA9IG5ldyBNdWx0aUNsYXNzTG9hZGVy\nKCk7CiAgICAgICAgbG9hZGVyLmFkZENsYXNzTG9hZGVyKFRocmVhZC5jdXJy\nZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCkpOwogICAgICAg\nIGxvYWRlci5hZGRDbGFzc0xvYWRlcihnZXRDbGFzcygpLmdldENsYXNzTG9h\nZGVyKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlciBwcm92aWRl\nciA9IFByb2R1Y3REZXJpdmF0aW9ucy5sb2FkR2xvYmFscyhsb2FkZXIpOwog\nICAgICAgIGlmIChwcm92aWRlciAhPSBudWxsKQogICAgICAgICAgICBwcm92\naWRlci5zZXRJbnRvKHRoaXMpOwoKICAgICAgICAvLyBsZXQgc3lzdGVtIHBy\nb3BlcnRpZXMgb3ZlcnJpZGUgb3RoZXIgZ2xvYmFscwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGZyb21Qcm9wZXJ0aWVzKG5ldyBIYXNoTWFwKFN5c3Rl\nbS5nZXRQcm9wZXJ0aWVzKCkpKTsKICAgICAgICB9IGNhdGNoIChTZWN1cml0\neUV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAvLyBzZWN1cml0eSBtYW5h\nZ2VyIG1pZ2h0IGRpc2FsbG93CiAgICAgICAgfQoKICAgICAgICBfZ2xvYmFs\ncyA9IHRydWU7CiAgICAgICAgaWYgKHByb3ZpZGVyID09IG51bGwpIHsKICAg\nICAgICAgICAgTG9nIGxvZyA9IGdldENvbmZpZ3VyYXRpb25Mb2coKTsKICAg\nICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJuby1kZWZhdWx0LXByb3ZpZGVy\ncyIpKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFByb2R1Y3ROYW1lKCkgewogICAgICAgIHJldHVybiBfcHJvZHVjdDsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRQcm9kdWN0TmFtZShTdHJpbmcgbmFt\nZSkgewogICAgICAgIF9wcm9kdWN0ID0gbmFtZTsKICAgIH0KCiAgICBwdWJs\naWMgTG9nRmFjdG9yeSBnZXRMb2dGYWN0b3J5KCkgewogICAgICAgIGlmIChs\nb2dGYWN0b3J5UGx1Z2luLmdldCgpID09IG51bGwpCiAgICAgICAgICAgIGxv\nZ0ZhY3RvcnlQbHVnaW4uaW5zdGFudGlhdGUoTG9nRmFjdG9yeS5jbGFzcywg\ndGhpcyk7CiAgICAgICAgcmV0dXJuIChMb2dGYWN0b3J5KSBsb2dGYWN0b3J5\nUGx1Z2luLmdldCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExvZ0Zh\nY3RvcnkoTG9nRmFjdG9yeSBsb2dGYWN0b3J5KSB7CiAgICAgICAgYXNzZXJ0\nTm90UmVhZE9ubHkoKTsKICAgICAgICBsb2dGYWN0b3J5UGx1Z2luLnNldChs\nb2dGYWN0b3J5KTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldExvZygp\nIHsKICAgICAgICByZXR1cm4gbG9nRmFjdG9yeVBsdWdpbi5nZXRTdHJpbmco\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRMb2coU3RyaW5nIGxvZykg\newogICAgICAgIGFzc2VydE5vdFJlYWRPbmx5KCk7CiAgICAgICAgbG9nRmFj\ndG9yeVBsdWdpbi5zZXRTdHJpbmcobG9nKTsKICAgIH0KCiAgICBwdWJsaWMg\nTG9nIGdldExvZyhTdHJpbmcgY2F0ZWdvcnkpIHsKICAgICAgICByZXR1cm4g\nZ2V0TG9nRmFjdG9yeSgpLmdldExvZyhjYXRlZ29yeSk7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZyBnZXRJZCgpIHsKICAgICAgICByZXR1cm4gaWQuZ2V0\nKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHNldElkKFN0cmluZyBp\nZCkgewogICAgICAgIGFzc2VydE5vdFJlYWRPbmx5KCk7CiAgICAgICAgdGhp\ncy5pZC5zZXQoaWQpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0\naGUgbG9nZ2luZyBjaGFubmVsIDxjb2RlPm9wZW5qcGEuUnVudGltZTwvY29k\nZT4gYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIExvZyBnZXRDb25m\naWd1cmF0aW9uTG9nKCkgewogICAgICAgIHJldHVybiBnZXRMb2coIm9wZW5q\ncGEuUnVudGltZSIpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZVtdIGdldFZh\nbHVlcygpIHsKICAgICAgICByZXR1cm4gKFZhbHVlW10pIF92YWxzLnRvQXJy\nYXkobmV3IFZhbHVlW192YWxzLnNpemUoKV0pOwogICAgfQoKICAgIHB1Ymxp\nYyBWYWx1ZSBnZXRWYWx1ZShTdHJpbmcgcHJvcGVydHkpIHsKICAgICAgICBp\nZiAocHJvcGVydHkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCgogICAgICAgIC8vIHNlYXJjaCBiYWNrd2FyZHMgc28gdGhhdCBjdXN0b20g\ndmFsdWVzIGFkZGVkIGFmdGVyIGNvbnN0cnVjdGlvbgogICAgICAgIC8vIGFy\nZSBmb3VuZCBxdWlja2x5LCBzaW5jZSB0aGlzIHdpbGwgYmUgdGhlIHN0ZCB3\nYXkgb2YgYWNjZXNzaW5nIHRoZW0KICAgICAgICBWYWx1ZSB2YWw7CiAgICAg\nICAgZm9yIChpbnQgaSA9IF92YWxzLnNpemUoKSAtIDE7IGkgPj0gMDsgaS0t\nKSB7CiAgICAgICAgICAgIHZhbCA9IChWYWx1ZSkgX3ZhbHMuZ2V0KGkpOwog\nICAgICAgICAgICBpZiAodmFsLmdldFByb3BlcnR5KCkuZXF1YWxzKHByb3Bl\ncnR5KSkKICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndFJlYWRPbmx5KGJvb2xlYW4gcmVhZE9ubHkpIHsKICAgICAgICBfcmVhZE9u\nbHkgPSByZWFkT25seTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbnN0YW50\naWF0ZUFsbCgpIHsKICAgICAgICBTdHJpbmdXcml0ZXIgZXJycyA9IG51bGw7\nCiAgICAgICAgUHJpbnRXcml0ZXIgc3RhY2sgPSBudWxsOwogICAgICAgIFZh\nbHVlIHZhbDsKICAgICAgICBTdHJpbmcgZ2V0dGVyTmFtZTsKICAgICAgICBN\nZXRob2QgZ2V0dGVyOwogICAgICAgIE9iamVjdCBnZXR0ZXJUYXJnZXQ7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfdmFscy5zaXplKCk7IGkrKykg\newogICAgICAgICAgICB2YWwgPSAoVmFsdWUpIF92YWxzLmdldChpKTsKICAg\nICAgICAgICAgZ2V0dGVyTmFtZSA9IHZhbC5nZXRJbnN0YW50aWF0aW5nR2V0\ndGVyKCk7CiAgICAgICAgICAgIGlmIChnZXR0ZXJOYW1lID09IG51bGwpCiAg\nICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIGdldHRlclRh\ncmdldCA9IHRoaXM7CiAgICAgICAgICAgIGlmIChnZXR0ZXJOYW1lLnN0YXJ0\nc1dpdGgoInRoaXMuIikpIHsKICAgICAgICAgICAgICAgIGdldHRlck5hbWUg\nPSBnZXR0ZXJOYW1lLnN1YnN0cmluZygidGhpcy4iLmxlbmd0aCgpKTsKICAg\nICAgICAgICAgICAgIGdldHRlclRhcmdldCA9IHZhbDsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGdldHRlciA9\nIGdldHRlclRhcmdldC5nZXRDbGFzcygpLmdldE1ldGhvZChnZXR0ZXJOYW1l\nLAogICAgICAgICAgICAgICAgICAgIChDbGFzc1tdKSBudWxsKTsKICAgICAg\nICAgICAgICAgIGdldHRlci5pbnZva2UoZ2V0dGVyVGFyZ2V0LCAoT2JqZWN0\nW10pIG51bGwpOwogICAgICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkg\newogICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBJbnZvY2F0aW9u\nVGFyZ2V0RXhjZXB0aW9uKQogICAgICAgICAgICAgICAgICAgIHQgPSAoKElu\ndm9jYXRpb25UYXJnZXRFeGNlcHRpb24pIHQpLmdldFRhcmdldEV4Y2VwdGlv\nbigpOwogICAgICAgICAgICAgICAgaWYgKGVycnMgPT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgIGVycnMgPSBuZXcgU3RyaW5nV3JpdGVyKCk7CiAg\nICAgICAgICAgICAgICAgICAgc3RhY2sgPSBuZXcgUHJpbnRXcml0ZXIoZXJy\ncyk7CiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAg\nICBlcnJzLndyaXRlKFNFUCk7CiAgICAgICAgICAgICAgICB0LnByaW50U3Rh\nY2tUcmFjZShzdGFjayk7CiAgICAgICAgICAgICAgICBzdGFjay5mbHVzaCgp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChlcnJzICE9\nIG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJnZXQtcHJvcC1lcnJzIiwKICAgICAgICAgICAgICAgIGVy\ncnMudG9TdHJpbmcoKSkuZ2V0TWVzc2FnZSgpKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1JlYWRPbmx5KCkgewogICAgICAgIHJldHVybiBfcmVh\nZE9ubHk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkUHJvcGVydHlDaGFu\nZ2VMaXN0ZW5lcihQcm9wZXJ0eUNoYW5nZUxpc3RlbmVyIGxpc3RlbmVyKSB7\nCiAgICAgICAgaWYgKF9jaGFuZ2VTdXBwb3J0ID09IG51bGwpCiAgICAgICAg\nICAgIF9jaGFuZ2VTdXBwb3J0ID0gbmV3IFByb3BlcnR5Q2hhbmdlU3VwcG9y\ndCh0aGlzKTsKICAgICAgICBfY2hhbmdlU3VwcG9ydC5hZGRQcm9wZXJ0eUNo\nYW5nZUxpc3RlbmVyKGxpc3RlbmVyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCByZW1vdmVQcm9wZXJ0eUNoYW5nZUxpc3RlbmVyKFByb3BlcnR5Q2hhbmdl\nTGlzdGVuZXIgbGlzdGVuZXIpIHsKICAgICAgICBpZiAoX2NoYW5nZVN1cHBv\ncnQgIT0gbnVsbCkKICAgICAgICAgICAgX2NoYW5nZVN1cHBvcnQucmVtb3Zl\nUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdmFsdWVDaGFuZ2VkKFZhbHVlIHZhbCkgewogICAgICAg\nIGlmIChfY2hhbmdlU3VwcG9ydCA9PSBudWxsICYmIF9wcm9wcyA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIFN0cmluZyBuZXdTdHJp\nbmcgPSB2YWwuZ2V0U3RyaW5nKCk7CiAgICAgICAgaWYgKF9jaGFuZ2VTdXBw\nb3J0ICE9IG51bGwpCiAgICAgICAgICAgIF9jaGFuZ2VTdXBwb3J0LmZpcmVQ\ncm9wZXJ0eUNoYW5nZSh2YWwuZ2V0UHJvcGVydHkoKSwgbnVsbCwKICAgICAg\nICAgICAgICAgIG5ld1N0cmluZyk7CgogICAgICAgIC8vIGtlZXAgY2FjaGVk\nIHByb3BzIHVwIHRvIGRhdGUKICAgICAgICBpZiAoX3Byb3BzICE9IG51bGwp\nIHsKICAgICAgICAgICAgaWYgKG5ld1N0cmluZyA9PSBudWxsKQogICAgICAg\nICAgICAgICAgQ29uZmlndXJhdGlvbnMucmVtb3ZlUHJvcGVydHkodmFsLmdl\ndFByb3BlcnR5KCksIF9wcm9wcyk7CiAgICAgICAgICAgIGVsc2UgaWYgKENv\nbmZpZ3VyYXRpb25zLmNvbnRhaW5zUHJvcGVydHkodmFsLmdldFByb3BlcnR5\nKCksIF9wcm9wcykKICAgICAgICAgICAgICAgIHx8IHZhbC5nZXREZWZhdWx0\nKCkgPT0gbnVsbAogICAgICAgICAgICAgICAgfHwgIXZhbC5nZXREZWZhdWx0\nKCkuZXF1YWxzKG5ld1N0cmluZykpCiAgICAgICAgICAgICAgICBwdXQoX3By\nb3BzLCB2YWwsIG5ld1N0cmluZyk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQ2xvc2VzIGFsbCBjbG9zZWFibGUgdmFsdWVzIGFuZCBwbHVn\naW5zLgogICAgICovCiAgICBwdWJsaWMgZmluYWwgdm9pZCBjbG9zZSgpIHsK\nICAgICAgICBQcm9kdWN0RGVyaXZhdGlvbnMuYmVmb3JlQ2xvc2UodGhpcyk7\nCiAgICAgICAgCiAgICAgICAgcHJlQ2xvc2UoKTsKICAgICAgICAKICAgICAg\nICBPYmplY3RWYWx1ZSB2YWw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfdmFscy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBpZiAoX3ZhbHMu\nZ2V0KGkpIGluc3RhbmNlb2YgQ2xvc2VhYmxlKSB7CiAgICAgICAgICAgICAg\nICB0cnkgeyAoKENsb3NlYWJsZSkgX3ZhbHMuZ2V0KGkpKS5jbG9zZSgpOyB9\nCiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHt9IAogICAg\nICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIGlmICghKF92YWxzLmdldChpKSBpbnN0YW5jZW9mIE9iamVjdFZhbHVl\nKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgdmFs\nID0gKE9iamVjdFZhbHVlKSBfdmFscy5nZXQoaSk7CiAgICAgICAgICAgIGlm\nICh2YWwuZ2V0KCkgaW5zdGFuY2VvZiBDbG9zZWFibGUpIHsKICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgKChDbG9zZWFibGUp\nIHZhbC5nZXQoKSkuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogSW52b2tl\nZCBieSBmaW5hbCBtZXRob2Qge0BsaW5rICNjbG9zZX0gYWZ0ZXIgaW52b2tp\nbmcgdGhlIAogICAgICoge0BsaW5rIFByb2R1Y3REZXJpdmF0aW9uI2JlZm9y\nZUNvbmZpZ3VyYXRpb25DbG9zZX0gY2FsbGJhY2tzCiAgICAgKiBidXQgYmVm\nb3JlIHBlcmZvcm1pbmcgaW50ZXJuYWwgY2xvc2Ugb3BlcmF0aW9ucy4KICAg\nICAqIAogICAgICogQHNpbmNlIDAuOS43CiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIHByZUNsb3NlKCkgewogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwogICAgLy8gQmVhbkluZm8gaW1wbGVtZW50YXRpb24K\nICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBC\nZWFuSW5mb1tdIGdldEFkZGl0aW9uYWxCZWFuSW5mbygpIHsKICAgICAgICBy\nZXR1cm4gbmV3IEJlYW5JbmZvWzBdOwogICAgfQoKICAgIHB1YmxpYyBCZWFu\nRGVzY3JpcHRvciBnZXRCZWFuRGVzY3JpcHRvcigpIHsKICAgICAgICByZXR1\ncm4gbmV3IEJlYW5EZXNjcmlwdG9yKGdldENsYXNzKCkpOwogICAgfQoKICAg\nIHB1YmxpYyBpbnQgZ2V0RGVmYXVsdEV2ZW50SW5kZXgoKSB7CiAgICAgICAg\ncmV0dXJuIDA7CiAgICB9CgogICAgcHVibGljIGludCBnZXREZWZhdWx0UHJv\ncGVydHlJbmRleCgpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICBw\ndWJsaWMgRXZlbnRTZXREZXNjcmlwdG9yW10gZ2V0RXZlbnRTZXREZXNjcmlw\ndG9ycygpIHsKICAgICAgICByZXR1cm4gbmV3IEV2ZW50U2V0RGVzY3JpcHRv\nclswXTsKICAgIH0KCiAgICBwdWJsaWMgSW1hZ2UgZ2V0SWNvbihpbnQga2lu\nZCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBz\neW5jaHJvbml6ZWQgTWV0aG9kRGVzY3JpcHRvcltdIGdldE1ldGhvZERlc2Ny\naXB0b3JzKCkgewogICAgICAgIGlmIChfbWRzICE9IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBfbWRzOwoKICAgICAgICBQcm9wZXJ0eURlc2NyaXB0b3Jb\nXSBwZHMgPSBnZXRQcm9wZXJ0eURlc2NyaXB0b3JzKCk7CiAgICAgICAgTGlz\ndCBkZXNjcyA9IG5ldyBBcnJheUxpc3QoKTsgCiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBwZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgTWV0\naG9kIHdyaXRlID0gcGRzW2ldLmdldFdyaXRlTWV0aG9kKCk7CiAgICAgICAg\nICAgIE1ldGhvZCByZWFkID0gcGRzW2ldLmdldFJlYWRNZXRob2QoKTsKICAg\nICAgICAgICAgaWYgKHJlYWQgIT0gbnVsbCAmJiB3cml0ZSAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBkZXNjcy5hZGQobmV3IE1ldGhvZERlc2NyaXB0\nb3Iod3JpdGUpKTsKICAgICAgICAgICAgICAgIGRlc2NzLmFkZChuZXcgTWV0\naG9kRGVzY3JpcHRvcihyZWFkKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgX21kcyA9IChNZXRob2REZXNjcmlwdG9yW10pZGVzY3MuCiAg\nICAgICAgICAgIHRvQXJyYXkobmV3IE1ldGhvZERlc2NyaXB0b3JbZGVzY3Mu\nc2l6ZSgpXSk7CiAgICAgICAgcmV0dXJuIF9tZHM7CiAgICB9CgogICAgcHVi\nbGljIHN5bmNocm9uaXplZCBQcm9wZXJ0eURlc2NyaXB0b3JbXSBnZXRQcm9w\nZXJ0eURlc2NyaXB0b3JzKCkgewogICAgICAgIGlmIChfcGRzICE9IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBfcGRzOwoKICAgICAgICBfcGRzID0gbmV3\nIFByb3BlcnR5RGVzY3JpcHRvcltfdmFscy5zaXplKCldOwogICAgICAgIExp\nc3QgZmFpbHVyZXMgPSBudWxsOwogICAgICAgIFZhbHVlIHZhbDsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IF92YWxzLnNpemUoKTsgaSsrKSB7CiAg\nICAgICAgICAgIHZhbCA9IChWYWx1ZSkgX3ZhbHMuZ2V0KGkpOwogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgX3Bkc1tpXSA9IGdldFByb3Bl\ncnR5RGVzY3JpcHRvcih2YWwpOwogICAgICAgICAgICB9IGNhdGNoIChNaXNz\naW5nUmVzb3VyY2VFeGNlcHRpb24gbXJlKSB7CiAgICAgICAgICAgICAgICBp\nZiAoZmFpbHVyZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBmYWls\ndXJlcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgICAgIGZhaWx1\ncmVzLmFkZCh2YWwuZ2V0UHJvcGVydHkoKSk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEludHJvc3BlY3Rpb25FeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAg\nICAgIGlmIChmYWlsdXJlcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIGZhaWx1cmVzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICAgICAg\nZmFpbHVyZXMuYWRkKHZhbC5nZXRQcm9wZXJ0eSgpKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICBpZiAoZmFpbHVyZXMgIT0gbnVsbCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IFBhcnNlRXhjZXB0aW9uKF9sb2MuZ2V0KCJp\nbnZhbGlkLXByb3BlcnR5LWRlc2NyaXB0b3JzIiwKICAgICAgICAgICAgICAg\nIGZhaWx1cmVzKSk7CgogICAgICAgIHJldHVybiBfcGRzOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIGEgcHJvcGVydHkgZGVzY3JpcHRvciBmb3Ig\ndGhlIGdpdmVuIHZhbHVlLgogICAgICovCiAgICBwcml2YXRlIFByb3BlcnR5\nRGVzY3JpcHRvciBnZXRQcm9wZXJ0eURlc2NyaXB0b3IoVmFsdWUgdmFsKQog\nICAgICAgIHRocm93cyBJbnRyb3NwZWN0aW9uRXhjZXB0aW9uIHsKICAgICAg\nICBTdHJpbmcgcHJvcCA9IHZhbC5nZXRQcm9wZXJ0eSgpOwogICAgICAgIHBy\nb3AgPSBwcm9wLnN1YnN0cmluZyhwcm9wLmxhc3RJbmRleE9mKCcuJykgKyAx\nKTsKCiAgICAgICAgLy8gc2V0IHVwIHByb3BlcnR5IGRlc2NyaXB0b3IKICAg\nICAgICBQcm9wZXJ0eURlc2NyaXB0b3IgcGQ7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcGQgPSBuZXcgUHJvcGVydHlEZXNjcmlwdG9yKEludHJvc3Bl\nY3Rvci5kZWNhcGl0YWxpemUocHJvcCksIAogICAgICAgICAgICAgICAgZ2V0\nQ2xhc3MoKSk7CiAgICAgICAgfSBjYXRjaCAoSW50cm9zcGVjdGlvbkV4Y2Vw\ndGlvbiBpZSkgewogICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmVuJ3QgYW55\nIG1ldGhvZHMgZm9yIHRoaXMgdmFsdWUoaS5lLiwgaWYgaXQncyBhCiAgICAg\nICAgICAgIC8vIGR5bmFtaWNhbGx5LWFkZGVkIHZhbHVlKSwgdGhlbiBhbiBJ\nbnRyb3NwZWN0aW9uRXhjZXB0aW9uIHdpbGwKICAgICAgICAgICAgLy8gYmUg\ndGhyb3duLiBUcnkgdG8gY3JlYXRlIGEgUEQgd2l0aCBubyByZWFkIG9yIHdy\naXRlIG1ldGhvZHMuCiAgICAgICAgICAgIHBkID0gbmV3IFByb3BlcnR5RGVz\nY3JpcHRvcihJbnRyb3NwZWN0b3IuZGVjYXBpdGFsaXplKHByb3ApLAogICAg\nICAgICAgICAgICAgKE1ldGhvZCkgbnVsbCwgKE1ldGhvZCkgbnVsbCk7CiAg\nICAgICAgfQogICAgICAgIHBkLnNldERpc3BsYXlOYW1lKGZpbmRMb2NhbGl6\nZWQocHJvcCArICItbmFtZSIsIHRydWUsIHZhbC5nZXRTY29wZSgpKSk7CiAg\nICAgICAgcGQuc2V0U2hvcnREZXNjcmlwdGlvbihmaW5kTG9jYWxpemVkKHBy\nb3AgKyAiLWRlc2MiLCB0cnVlLAogICAgICAgICAgICB2YWwuZ2V0U2NvcGUo\nKSkpOwogICAgICAgIHBkLnNldEV4cGVydCgidHJ1ZSIuZXF1YWxzKGZpbmRM\nb2NhbGl6ZWQocHJvcCArICItZXhwZXJ0IiwgZmFsc2UsCiAgICAgICAgICAg\nIHZhbC5nZXRTY29wZSgpKSkpOwoKICAgICAgICB0cnkgewogICAgICAgICAg\nICBwZC5zZXRSZWFkTWV0aG9kKGdldENsYXNzKCkuZ2V0TWV0aG9kKCJnZXQi\nCiAgICAgICAgICAgICAgICArIFN0cmluZ1V0aWxzLmNhcGl0YWxpemUocHJv\ncCksIChDbGFzc1tdKSBudWxsKSk7CiAgICAgICAgICAgIHBkLnNldFdyaXRl\nTWV0aG9kKGdldENsYXNzKCkuZ2V0TWV0aG9kKCJzZXQiCiAgICAgICAgICAg\nICAgICArIFN0cmluZ1V0aWxzLmNhcGl0YWxpemUocHJvcCksIG5ldyBDbGFz\nc1tdCiAgICAgICAgICAgICAgICB7IHBkLmdldFJlYWRNZXRob2QoKS5nZXRS\nZXR1cm5UeXBlKCkgfSkpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgIC8vIGlmIGFuIGVycm9yIG9jY3VycywgaXQgbWln\naHQgYmUgYmVjYXVzZSB0aGUgdmFsdWUgaXMgYQogICAgICAgICAgICAvLyBk\neW5hbWljIHByb3BlcnR5LgogICAgICAgIH0KCiAgICAgICAgU3RyaW5nIHR5\ncGUgPSBmaW5kTG9jYWxpemVkKHByb3AgKyAiLXR5cGUiLCB0cnVlLCB2YWwu\nZ2V0U2NvcGUoKSk7CiAgICAgICAgaWYgKHR5cGUgIT0gbnVsbCkKICAgICAg\nICAgICAgcGQuc2V0VmFsdWUoQVRUUklCVVRFX1RZUEUsIHR5cGUpOwoKICAg\nICAgICBTdHJpbmcgY2F0ID0gZmluZExvY2FsaXplZChwcm9wICsgIi1jYXQi\nLCBmYWxzZSwgdmFsLmdldFNjb3BlKCkpOwogICAgICAgIGlmIChjYXQgIT0g\nbnVsbCkKICAgICAgICAgICAgcGQuc2V0VmFsdWUoQVRUUklCVVRFX0NBVEVH\nT1JZLCBjYXQpOwogICAgICAgIAogICAgICAgIHBkLnNldFZhbHVlKEFUVFJJ\nQlVURV9YTUwsIHRvWE1MTmFtZShwcm9wKSk7CgogICAgICAgIFN0cmluZyBv\ncmRlciA9IGZpbmRMb2NhbGl6ZWQocHJvcCArICItZGlzcGxheW9yZGVyIiwg\nZmFsc2UsCiAgICAgICAgICAgIHZhbC5nZXRTY29wZSgpKTsKICAgICAgICBp\nZiAob3JkZXIgIT0gbnVsbCkKICAgICAgICAgICAgcGQuc2V0VmFsdWUoQVRU\nUklCVVRFX09SREVSLCBvcmRlcik7CgogICAgICAgIC8vIGNvbGxlY3QgYWxs\nb3dlZCB2YWx1ZXMgZnJvbSBhbGlhcyBrZXlzLCBsaXN0ZWQgdmFsdWVzLCBh\nbmQKICAgICAgICAvLyBpbnRlcmZhY2UgaW1wbGVtZW50b3JzCiAgICAgICAg\nQ29sbGVjdGlvbiBhbGxvd2VkID0gbmV3IFRyZWVTZXQoKTsKICAgICAgICBM\naXN0IGFsaWFzZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwogICAgICAg\nIGlmICh2YWwuZ2V0QWxpYXNlcygpICE9IG51bGwpIHsKICAgICAgICAgICAg\nYWxpYXNlcyA9IEFycmF5cy5hc0xpc3QodmFsLmdldEFsaWFzZXMoKSk7CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYWxpYXNlcy5zaXplKCk7\nIGkgKz0gMikKICAgICAgICAgICAgICAgIGFsbG93ZWQuYWRkKGFsaWFzZXMu\nZ2V0KGkpKTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nW10gdmFscyA9IFN0\ncmluZ3Muc3BsaXQoZmluZExvY2FsaXplZChwcm9wCiAgICAgICAgICAgICsg\nIi12YWx1ZXMiLCBmYWxzZSwgdmFsLmdldFNjb3BlKCkpLCAiLCIsIDApOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdmFscy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgaWYgKCFhbGlhc2VzLmNvbnRhaW5zKHZhbHNbaV0pKQog\nICAgICAgICAgICAgICAgYWxsb3dlZC5hZGQodmFsc1tpXSk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgQ2xhc3MgaW50ZiA9IENsYXNzLmZvck5hbWUo\nZmluZExvY2FsaXplZChwcm9wCiAgICAgICAgICAgICAgICArICItaW50ZXJm\nYWNlIiwgdHJ1ZSwgdmFsLmdldFNjb3BlKCkpLCBmYWxzZSwKICAgICAgICAg\nICAgICAgIGdldENsYXNzKCkuZ2V0Q2xhc3NMb2FkZXIoKSk7CiAgICAgICAg\nICAgIHBkLnNldFZhbHVlKEFUVFJJQlVURV9JTlRFUkZBQ0UsIGludGYuZ2V0\nTmFtZSgpKTsKICAgICAgICAgICAgU3RyaW5nW10gaW1wbHMgPSBTZXJ2aWNl\ncy5nZXRJbXBsZW1lbnRvcnMoaW50Zik7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgaW1wbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICBpZiAoIWFsaWFzZXMuY29udGFpbnMoaW1wbHNbaV0pKQogICAgICAgICAg\nICAgICAgICAgIGFsbG93ZWQuYWRkKGltcGxzW2ldKTsKICAgICAgICB9IGNh\ndGNoIChUaHJvd2FibGUgdCkgewogICAgICAgIH0KICAgICAgICBpZiAoIWFs\nbG93ZWQuaXNFbXB0eSgpKQogICAgICAgICAgICBwZC5zZXRWYWx1ZShBVFRS\nSUJVVEVfQUxMT1dFRF9WQUxVRVMsIChTdHJpbmdbXSkgYWxsb3dlZC50b0Fy\ncmF5CiAgICAgICAgICAgICAgICAobmV3IFN0cmluZ1thbGxvd2VkLnNpemUo\nKV0pKTsKCiAgICAgICAgcmV0dXJuIHBkOwogICAgfQoKICAgIC8qKgogICAg\nICogRmluZCB0aGUgZ2l2ZW4gbG9jYWxpemVkIHN0cmluZywgb3IgcmV0dXJu\nIG51bGwgaWYgbm90IGZvdW5kLgogICAgICovCiAgICBwcml2YXRlIFN0cmlu\nZyBmaW5kTG9jYWxpemVkKFN0cmluZyBrZXksIGJvb2xlYW4gZmF0YWwsIENs\nYXNzIHNjb3BlKSB7CiAgICAgICAgLy8gZmluZCB0aGUgbG9jYWxpemVyIHBh\nY2thZ2UgdGhhdCBjb250YWlucyB0aGlzIGtleQogICAgICAgIExvY2FsaXpl\nciBsb2MgPSBudWxsOwoKICAgICAgICAvLyBjaGVjayB0aGUgcGFja2FnZSB0\naGF0IHRoZSB2YWx1ZSBjbGFpbXMgdG8gYmUgZGVmaW5lZCBpbiwgaWYKICAg\nICAgICAvLyBhdmFpbGFibGUsIGJlZm9yZSB3ZSBzdGFydCBndWVzc2luZy4K\nICAgICAgICBpZiAoc2NvcGUgIT0gbnVsbCkgewogICAgICAgICAgICBsb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShzY29wZSk7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jLmdldEZhdGFsKGtleSku\nZ2V0TWVzc2FnZSgpOwogICAgICAgICAgICB9IGNhdGNoIChNaXNzaW5nUmVz\nb3VyY2VFeGNlcHRpb24gbXNlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIGZvciAoQ2xhc3MgY2xzID0gZ2V0Q2xhc3MoKTsgY2xzICE9\nIE9iamVjdC5jbGFzczsKICAgICAgICAgICAgY2xzID0gY2xzLmdldFN1cGVy\nY2xhc3MoKSkgewogICAgICAgICAgICBsb2MgPSBMb2NhbGl6ZXIuZm9yUGFj\na2FnZShjbHMpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\ncmV0dXJuIGxvYy5nZXRGYXRhbChrZXkpLmdldE1lc3NhZ2UoKTsKICAgICAg\nICAgICAgfSBjYXRjaCAoTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uIG1zZSkg\newogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZmF0YWwp\nCiAgICAgICAgICAgIHRocm93IG5ldyBNaXNzaW5nUmVzb3VyY2VFeGNlcHRp\nb24oa2V5LCBnZXRDbGFzcygpLmdldE5hbWUoKSwga2V5KTsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vCiAgICAv\nLyBUby9mcm9tIG1hcHMKICAgIC8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJs\naWMgTWFwIHRvUHJvcGVydGllcyhib29sZWFuIHN0b3JlRGVmYXVsdHMpIHsK\nICAgICAgICAvLyBjbG9uZSBwcm9wZXJ0aWVzIGJlZm9yZSBtYWtpbmcgYW55\nIG1vZGlmaWNhdGlvbnM7IHdlIG5lZWQgdG8ga2VlcAogICAgICAgIC8vIHRo\nZSBpbnRlcm5hbCBwcm9wZXJ0aWVzIGluc3RhbmNlIGNvbnNpc3RlbnQgdG8g\nbWFpbnRhaW4gZXF1YWxzIGFuZAogICAgICAgIC8vIGhhc2hjb2RlIGNvbnRy\nYWN0cwogICAgICAgIE1hcCBjbG9uZTsKICAgICAgICBpZiAoX3Byb3BzID09\nIG51bGwpCiAgICAgICAgICAgIGNsb25lID0gbmV3IEhhc2hNYXAoKTsKICAg\nICAgICBlbHNlIGlmIChfcHJvcHMgaW5zdGFuY2VvZiBQcm9wZXJ0aWVzKQog\nICAgICAgICAgICBjbG9uZSA9IChNYXApICgoUHJvcGVydGllcykgX3Byb3Bz\nKS5jbG9uZSgpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgY2xvbmUgPSBu\nZXcgSGFzaE1hcChfcHJvcHMpOwoKICAgICAgICAvLyBpZiBubyBleGlzdGlu\nZyBwcm9wZXJ0aWVzIG9yIHRoZSBwcm9wZXJ0aWVzIHNob3VsZCBjb250YWlu\nIGVudHJpZXMKICAgICAgICAvLyB3aXRoIGRlZmF1bHQgdmFsdWVzLCBhZGQg\ndmFsdWVzIHRvIHByb3BlcnRpZXMKICAgICAgICBpZiAoX3Byb3BzID09IG51\nbGwgfHwgc3RvcmVEZWZhdWx0cykgewogICAgICAgICAgICBWYWx1ZSB2YWw7\nCiAgICAgICAgICAgIFN0cmluZyBzdHI7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX3ZhbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAg\nICAgIC8vIGlmIGtleSBpbiBleGlzdGluZyBwcm9wZXJ0aWVzLCB3ZSBhbHJl\nYWR5IGtub3cgdmFsdWUgaXMgdXAKICAgICAgICAgICAgICAgIC8vIHRvIGRh\ndGUKICAgICAgICAgICAgICAgIHZhbCA9IChWYWx1ZSkgX3ZhbHMuZ2V0KGkp\nOwogICAgICAgICAgICAgICAgaWYgKF9wcm9wcyAhPSBudWxsICYmIENvbmZp\nZ3VyYXRpb25zLmNvbnRhaW5zUHJvcGVydHkKICAgICAgICAgICAgICAgICAg\nICAodmFsLmdldFByb3BlcnR5KCksIF9wcm9wcykpCiAgICAgICAgICAgICAg\nICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgc3RyID0gdmFsLmdl\ndFN0cmluZygpOwogICAgICAgICAgICAgICAgaWYgKHN0ciAhPSBudWxsICYm\nIChzdG9yZURlZmF1bHRzCiAgICAgICAgICAgICAgICAgICAgfHwgIXN0ci5l\ncXVhbHModmFsLmdldERlZmF1bHQoKSkpKQogICAgICAgICAgICAgICAgICAg\nIHB1dChjbG9uZSwgdmFsLCBzdHIpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGlmIChfcHJvcHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9wcm9w\ncyA9IG5ldyBIYXNoTWFwKGNsb25lKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIGNsb25lOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGZyb21Qcm9wZXJ0\naWVzKE1hcCBtYXApIHsKICAgICAgICBpZiAobWFwID09IG51bGwgfHwgbWFw\nLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGFzc2Vy\ndE5vdFJlYWRPbmx5KCk7CgogICAgICAgIC8vIGlmIHRoZSBvbmx5IHByZXZp\nb3VzIGNhbGwgd2FzIHRvIGxvYWQgZGVmYXVsdHMsIGZvcmdldCB0aGVtLgog\nICAgICAgIC8vIHRoaXMgd2F5IHdlIHByZXNlcnZlIHRoZSBvcmlnaW5hbCBm\nb3JtYXR0aW5nIG9mIHRoZSB1c2VyJ3MgcHJvcHMKICAgICAgICAvLyBpbnN0\nZWFkIG9mIHRoZSBkZWZhdWx0cy4gIHRoaXMgaXMgaW1wb3J0YW50IGZvciBj\nYWNoaW5nIG9uCiAgICAgICAgLy8gY29uZmlndXJhdGlvbiBvYmplY3RzCiAg\nICAgICAgaWYgKF9nbG9iYWxzKSB7CiAgICAgICAgICAgIF9wcm9wcyA9IG51\nbGw7CiAgICAgICAgICAgIF9nbG9iYWxzID0gZmFsc2U7CiAgICAgICAgfQoK\nICAgICAgICBNYXAgcmVtYWluaW5nID0gbmV3IEhhc2hNYXAobWFwKTsKICAg\nICAgICBib29sZWFuIHNlciA9IHRydWU7CiAgICAgICAgVmFsdWUgdmFsOwog\nICAgICAgIE9iamVjdCBvOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nX3ZhbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgdmFsID0gKFZhbHVl\nKSBfdmFscy5nZXQoaSk7CiAgICAgICAgICAgIG8gPSBnZXQobWFwLCB2YWws\nIHRydWUpOwogICAgICAgICAgICBpZiAobyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgY29udGludWU7CgogICAgICAgICAgICBpZiAobyBpbnN0YW5jZW9m\nIFN0cmluZykgewogICAgICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5l\ncXVhbHMoKFN0cmluZykgbywgdmFsLmdldFN0cmluZygpKSkKICAgICAgICAg\nICAgICAgICAgICB2YWwuc2V0U3RyaW5nKChTdHJpbmcpIG8pOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2VyICY9IG8gaW5zdGFu\nY2VvZiBTZXJpYWxpemFibGU7CiAgICAgICAgICAgICAgICB2YWwuc2V0T2Jq\nZWN0KG8pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIENvbmZpZ3VyYXRp\nb25zLnJlbW92ZVByb3BlcnR5KHZhbC5nZXRQcm9wZXJ0eSgpLCByZW1haW5p\nbmcpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBjb252ZW50aW9u\nIGlzIHRvIHBvaW50IHByb2R1Y3QgYXQgYSByZXNvdXJjZSB3aXRoIHRoZQog\nICAgICAgIC8vIDxwcmVmaXg+LnByb3BlcnRpZXMgU3lzdGVtIHByb3BlcnR5\nOyByZW1vdmUgdGhhdCBwcm9wZXJ0eSBzbyB3ZQogICAgICAgIC8vIHdlIGRv\nbid0IHdhcm4gYWJvdXQgaXQKICAgICAgICBDb25maWd1cmF0aW9ucy5yZW1v\ndmVQcm9wZXJ0eSgicHJvcGVydGllcyIsIHJlbWFpbmluZyk7CiAgICAgICAg\nCiAgICAgICAgLy8gbm93IHdhcm4gaWYgdGhlcmUgYXJlIGFueSByZW1haW5p\nbmcgcHJvcGVydGllcyB0aGF0IHRoZXJlCiAgICAgICAgLy8gaXMgYW4gdW5o\nYW5kbGVkIHByb3AKICAgICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAg\nZm9yIChJdGVyYXRvciBpdHIgPSByZW1haW5pbmcuZW50cnlTZXQoKS5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRyeSA9\nIChNYXAuRW50cnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChlbnRy\neS5nZXRLZXkoKSAhPSBudWxsKQogICAgICAgICAgICAgICAgd2FybkludmFs\naWRQcm9wZXJ0eSgoU3RyaW5nKSBlbnRyeS5nZXRLZXkoKSk7CiAgICAgICAg\nICAgIHNlciAmPSBlbnRyeS5nZXRWYWx1ZSgpIGluc3RhbmNlb2YgU2VyaWFs\naXphYmxlOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FjaGUgcHJvcGVydGll\ncwogICAgICAgIGlmIChfcHJvcHMgPT0gbnVsbCAmJiBzZXIpCiAgICAgICAg\nICAgIF9wcm9wcyA9IG1hcDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZHMg\nPGNvZGU+bzwvY29kZT4gdG8gPGNvZGU+bWFwPC9jb2RlPiB1bmRlciBrZXkg\nZm9yIDxjb2RlPnZhbDwvY29kZT4uCiAgICAgKiBVc2UgdGhpcyBtZXRob2Qg\naW5zdGVhZCBvZiBhdHRlbXB0aW5nIHRvIGFkZCB0aGUgdmFsdWUgZGlyZWN0\nbHkgYmVjYXVzZSAKICAgICAqIHRoaXMgd2lsbCBhY2NvdW50IGZvciB0aGUg\ncHJvcGVydHkgcHJlZml4LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcHV0\nKE1hcCBtYXAsIFZhbHVlIHZhbCwgT2JqZWN0IG8pIHsKICAgICAgICBPYmpl\nY3Qga2V5ID0gdmFsLmdldExvYWRLZXkoKTsKICAgICAgICBpZiAoa2V5ID09\nIG51bGwpCiAgICAgICAgICAgIGtleSA9ICJvcGVuanBhLiIgKyB2YWwuZ2V0\nUHJvcGVydHkoKTsKICAgICAgICBtYXAucHV0KGtleSwgbyk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBMb29rIHVwIHRoZSBnaXZlbiB2YWx1ZSwgdGVzdGlu\nZyBhbGwgYXZhaWxhYmxlIHByZWZpeGVzLgogICAgICovCiAgICBwcml2YXRl\nIE9iamVjdCBnZXQoTWFwIG1hcCwgVmFsdWUgdmFsLCBib29sZWFuIHNldExv\nYWRLZXkpIHsKICAgICAgICBTdHJpbmcga2V5ID0gUHJvZHVjdERlcml2YXRp\nb25zLmdldENvbmZpZ3VyYXRpb25LZXkoCiAgICAgICAgICAgIHZhbC5nZXRQ\ncm9wZXJ0eSgpLCBtYXApOwogICAgICAgIGlmIChtYXAuY29udGFpbnNLZXko\na2V5KSAmJiBzZXRMb2FkS2V5KQogICAgICAgICAgICB2YWwuc2V0TG9hZEtl\neShrZXkpOwogICAgICAgIHJldHVybiBtYXAuZ2V0KGtleSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBJc3N1ZSBhIHdhcm5pbmcgdGhhdCB0aGUgc3BlY2lm\naWVkIHByb3BlcnR5IGlzIG5vdCB2YWxpZC4KICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIHdhcm5JbnZhbGlkUHJvcGVydHkoU3RyaW5nIHByb3BOYW1lKSB7\nCiAgICAgICAgaWYgKCFpc0ludmFsaWRQcm9wZXJ0eShwcm9wTmFtZSkpCiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICBMb2cgbG9nID0gZ2V0Q29uZmln\ndXJhdGlvbkxvZygpOwogICAgICAgIGlmIChsb2cgPT0gbnVsbCB8fCAhbG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAg\nICAvLyB0cnkgdG8gZmluZCB0aGUgY2xvc2VzdCBzdHJpbmcgdG8gdGhlIGlu\ndmFsaWQgcHJvcGVydHkKICAgICAgICAvLyBzbyB0aGF0IHdlIGNhbiBwcm92\naWRlIGEgaGludCBpbiBjYXNlIG9mIGEgbWlzc3BlbGxpbmcKICAgICAgICBT\ndHJpbmcgY2xvc2VzdCA9IFN0cmluZ0Rpc3RhbmNlLmdldENsb3Nlc3RMZXZl\nbnNodGVpbkRpc3RhbmNlCiAgICAgICAgICAgIChwcm9wTmFtZSwgbmV3UHJv\ncGVydHlMaXN0KCksIDE1KTsKCiAgICAgICAgaWYgKGNsb3Nlc3QgPT0gbnVs\nbCkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImludmFsaWQtcHJv\ncGVydHkiLCBwcm9wTmFtZSkpOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nbG9nLndhcm4oX2xvYy5nZXQoImludmFsaWQtcHJvcGVydHktaGludCIsIHBy\nb3BOYW1lLCBjbG9zZXN0KSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gYSBjb21wcmVoZW5zaXZlIGxpc3Qgb2YgcmVjb2duaXplZCBtYXAga2V5\ncy4KICAgICAqLwogICAgcHJpdmF0ZSBDb2xsZWN0aW9uIG5ld1Byb3BlcnR5\nTGlzdCgpIHsKICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFByb2R1Y3RE\nZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsKICAgICAg\nICBMaXN0IGwgPSBuZXcgQXJyYXlMaXN0KF92YWxzLnNpemUoKSAqIHByZWZp\neGVzLmxlbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfdmFs\ncy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsg\naiA8IHByZWZpeGVzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgbC5h\nZGQocHJlZml4ZXNbal0gKyAiLiIgKyAoKFZhbHVlKSBfdmFscy5nZXQoaSkp\nLmdldFByb3BlcnR5KCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgc3Bl\nY2lmaWVkIHByb3BlcnR5IG5hbWUgc2hvdWxkIHJhaXNlIGEgd2FybmluZwog\nICAgICogaWYgaXQgaXMgbm90IGZvdW5kIGluIHRoZSBsaXN0IG9mIGtub3du\nIHByb3BlcnRpZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlz\nSW52YWxpZFByb3BlcnR5KFN0cmluZyBwcm9wTmFtZSkgewogICAgICAgIC8v\nIGhhbmRsZSB3YXJuaW5ncyBmb3Igb3BlbmpwYS5Tb21lU3RyaW5nLCBidXQg\nbm90IGZvcgogICAgICAgIC8vIG9wZW5qcGEuc29tZS5zdWJwYWNrYWdlLlNv\nbWVTdHJpbmcsIHNpbmNlIGl0IG1pZ2h0IGJlIHZhbGlkIGZvciBzb21lCiAg\nICAgICAgLy8gc3BlY2lmaWMgaW1wbGVtZW50YXRpb24gb2YgT3BlbkpQQQog\nICAgICAgIFN0cmluZ1tdIHByZWZpeGVzID0gUHJvZHVjdERlcml2YXRpb25z\nLmdldENvbmZpZ3VyYXRpb25QcmVmaXhlcygpOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgaWYgKHByb3BOYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChwcmVm\naXhlc1tpXSkKICAgICAgICAgICAgICAgICYmIHByb3BOYW1lLmxlbmd0aCgp\nID4gcHJlZml4ZXNbaV0ubGVuZ3RoKCkgKyAxCiAgICAgICAgICAgICAgICAm\nJiBwcm9wTmFtZS5pbmRleE9mKCcuJywgcHJlZml4ZXNbaV0ubGVuZ3RoKCkp\nIAogICAgICAgICAgICAgICAgPT0gcHJlZml4ZXNbaV0ubGVuZ3RoKCkKICAg\nICAgICAgICAgICAgICYmIHByb3BOYW1lLmluZGV4T2YoJy4nLCBwcmVmaXhl\nc1tpXS5sZW5ndGgoKSArIDEpID09IC0xKQogICAgICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAg\nIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBBdXRvLWNv\nbmZpZ3VyYXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAv\nKioKICAgICAqIFRoaXMgbWV0aG9kIGxvYWRzIHRoZSBuYW1lZCByZXNvdXJj\nZSBhcyBhIHByb3BlcnRpZXMgZmlsZS4gSXQgaXMKICAgICAqIHVzZWZ1bCBm\nb3IgYXV0by1jb25maWd1cmF0aW9uIHRvb2xzIHNvIHVzZXJzIGNhbiBzcGVj\naWZ5IGEKICAgICAqIDxjb2RlPnByb3BlcnRpZXM8L2NvZGU+IHZhbHVlIHdp\ndGggdGhlIG5hbWUgb2YgYSByZXNvdXJjZS4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0UHJvcGVydGllcyhTdHJpbmcgcmVzb3VyY2VOYW1lKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIFByb2R1Y3REZXJpdmF0aW9ucy5s\nb2FkKHJlc291cmNlTmFtZSwgbnVsbCwgCiAgICAgICAgICAgIGdldENsYXNz\nKCkuZ2V0Q2xhc3NMb2FkZXIoKSkuc2V0SW50byh0aGlzKTsKICAgICAgICBf\nYXV0byA9IHJlc291cmNlTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\naXMgbWV0aG9kIGxvYWRzIHRoZSBuYW1lZCBmaWxlIGFzIGEgcHJvcGVydGll\ncyBmaWxlLiBJdCBpcwogICAgICogdXNlZnVsIGZvciBhdXRvLWNvbmZpZ3Vy\nYXRpb24gdG9vbHMgc28gdXNlcnMgY2FuIHNwZWNpZnkgYQogICAgICogPGNv\nZGU+cHJvcGVydGllc0ZpbGU8L2NvZGU+IHZhbHVlIHdpdGggdGhlIG5hbWUg\nb2YgYSBmaWxlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcm9wZXJ0\naWVzRmlsZShGaWxlIGZpbGUpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgUHJvZHVjdERlcml2YXRpb25zLmxvYWQoZmlsZSwgbnVsbCwgZ2V0Q2xh\nc3MoKS5nZXRDbGFzc0xvYWRlcigpKS4KICAgICAgICAgICAgc2V0SW50byh0\naGlzKTsKICAgICAgICBfYXV0byA9IGZpbGUudG9TdHJpbmcoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzb3VyY2UgdGhhdCB3YXMg\nc2V0IHZpYSBhdXRvLWNvbmZpZ3VyYXRpb24gbWV0aG9kcwogICAgICoge0Bs\naW5rICNzZXRQcm9wZXJ0aWVzfSBvciB7QGxpbmsgI3NldFByb3BlcnRpZXNG\naWxlfSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGdldFByb3BlcnRpZXNSZXNvdXJjZSgpIHsKICAgICAgICByZXR1cm4g\nX2F1dG87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLwogICAgLy8gVXRpbGl0\naWVzCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBDaGVja3Mg\naWYgdGhlIGNvbmZpZ3VyYXRpb24gaXMgcmVhZCBvbmx5IGFuZCBpZiBzbyB0\naHJvd3MgYW4KICAgICAqIGV4Y2VwdGlvbiwgb3RoZXJ3aXNlIHJldHVybnMg\nc2lsZW50bHkuCiAgICAgKiBJbXBsZW1lbnRhdGlvbnMgc2hvdWxkIGNhbGwg\ndGhpcyBtZXRob2QgYmVmb3JlIHNldHRpbmcgYW55IHN0YXRlLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBhc3NlcnROb3RSZWFkT25seSgpIHsKICAgICAg\nICBpZiAoaXNSZWFkT25seSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxs\nZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJyZWFkLW9ubHkiKS5nZXRN\nZXNzYWdlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogUGVyZm9ybXMgYW4g\nZXF1YWxpdHkgY2hlY2sgYmFzZWQgb24gdGhlIHByb3BlcnRpZXMgcmV0dXJu\nZWQgZnJvbQogICAgICoge0BsaW5rICN0b1Byb3BlcnRpZXN9LgogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7CiAg\nICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgIGlmIChvdGhlciA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFnZXRDbGFzcygpLmVxdWFscyhv\ndGhlci5nZXRDbGFzcygpKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoK\nICAgICAgICAvLyBjb21wYXJlIHByb3BlcnRpZXMKICAgICAgICBDb25maWd1\ncmF0aW9uSW1wbCBjb25mID0gKENvbmZpZ3VyYXRpb25JbXBsKSBvdGhlcjsK\nICAgICAgICBNYXAgcDEgPSAoX3Byb3BzID09IG51bGwpID8gdG9Qcm9wZXJ0\naWVzKGZhbHNlKSA6IF9wcm9wczsKICAgICAgICBNYXAgcDIgPSAoY29uZi5f\ncHJvcHMgPT0gbnVsbCkgPyBjb25mLnRvUHJvcGVydGllcyhmYWxzZSkgOiBj\nb25mLl9wcm9wczsKICAgICAgICByZXR1cm4gcDEuZXF1YWxzKHAyKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENvbXB1dGVzIGhhc2ggY29kZSBiYXNlZCBv\nbiB0aGUgcHJvcGVydGllcyByZXR1cm5lZCBmcm9tCiAgICAgKiB7QGxpbmsg\nI3RvUHJvcGVydGllc30uCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgaGFzaENv\nZGUoKSB7CiAgICAgICAgaWYgKF9wcm9wcyAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gX3Byb3BzLmhhc2hDb2RlKCk7CiAgICAgICAgcmV0dXJuIHRv\nUHJvcGVydGllcyhmYWxzZSkuaGFzaENvZGUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlcnQgPGNvZGU+cHJvcE5hbWU8L2NvZGU+IHRvIGEgbG93\nZXJjYXNlLXdpdGgtaHlwaGVucy1zdHlsZSBzdHJpbmcuCiAgICAgKiBUaGlz\nIGFsZ29yaXRobSBpcyBvbmx5IGRlc2lnbmVkIGZvciBtaXhlcyBvZiB1cHBl\ncmNhc2UgYW5kIGxvd2VyY2FzZSAKICAgICAqIGxldHRlcnMgYW5kIGxvbmUg\nZGlnaXRzLiBBIG1vcmUgc29waGlzdGljYXRlZCBjb252ZXJzaW9uIHNob3Vs\nZCBwcm9iYWJseSAKICAgICAqIGJlIGhhbmRsZWQgYnkgYSBwcm9wZXIgcGFy\nc2VyIGdlbmVyYXRvciBvciByZWd1bGFyIGV4cHJlc3Npb25zLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyB0b1hNTE5hbWUoU3RyaW5nIHBy\nb3BOYW1lKSB7CiAgICAgICAgaWYgKHByb3BOYW1lID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIFN0cmluZ0J1ZmZlciBidWYg\nPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgY2hhciBjOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcHJvcE5hbWUubGVuZ3RoKCk7IGkrKykg\newogICAgICAgICAgICBjID0gcHJvcE5hbWUuY2hhckF0KGkpOwoKICAgICAg\nICAgICAgLy8gY29udmVydCBzZXF1ZW5jZXMgb2YgYWxsLWNhcHMgdG8gZG93\nbmNhc2Ugd2l0aCBkYXNoZXMgYXJvdW5kIAogICAgICAgICAgICAvLyB0aGVt\nLiBwdXQgYSB0cmFpbGluZyBjYXAgdGhhdCBpcyBmb2xsb3dlZCBieSBkb3du\nY2FzZSBpbnRvIHRoZQogICAgICAgICAgICAvLyBkb3duY2FzZSB3b3JkLgog\nICAgICAgICAgICBpZiAoaSAhPSAwICYmIENoYXJhY3Rlci5pc1VwcGVyQ2Fz\nZShjKSAKICAgICAgICAgICAgICAgICYmIChDaGFyYWN0ZXIuaXNMb3dlckNh\nc2UocHJvcE5hbWUuY2hhckF0KGktMSkpCiAgICAgICAgICAgICAgICB8fCAo\naSA+IDEgJiYgaSA8IHByb3BOYW1lLmxlbmd0aCgpIC0gMQogICAgICAgICAg\nICAgICAgJiYgQ2hhcmFjdGVyLmlzVXBwZXJDYXNlKHByb3BOYW1lLmNoYXJB\ndChpLTEpKSAKICAgICAgICAgICAgICAgICYmIENoYXJhY3Rlci5pc0xvd2Vy\nQ2FzZShwcm9wTmFtZS5jaGFyQXQoaSsxKSkpKSkKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoJy0nKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8v\nIHN1cnJvdW5kIHNlcXVlbmNlcyBvZiBkaWdpdHMgd2l0aCBkYXNoZXMuCiAg\nICAgICAgICAgIGlmIChpICE9IDAKICAgICAgICAgICAgICAgICYmICgoIUNo\nYXJhY3Rlci5pc0xldHRlcihjKSAmJiBDaGFyYWN0ZXIuaXNMZXR0ZXIocHJv\ncE5hbWUKICAgICAgICAgICAgICAgICAgICAuY2hhckF0KGkgLSAxKSkpIAog\nICAgICAgICAgICAgICAgfHwgKENoYXJhY3Rlci5pc0xldHRlcihjKSAmJiAh\nQ2hhcmFjdGVyLmlzTGV0dGVyKHByb3BOYW1lCiAgICAgICAgICAgICAgICAg\nICAgLmNoYXJBdChpIC0gMSkpKSkpCiAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCctJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICBidWYuYXBwZW5k\nKENoYXJhY3Rlci50b0xvd2VyQ2FzZShjKSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KICAgIAogICAgLyoqCiAg\nICAgKiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUge0BsaW5rIEV4dGVybmFsaXph\nYmxlfSBpbnRlcmZhY2UgdG8gcmVhZCBmcm9tCiAgICAgKiB0aGUgcHJvcGVy\ndGllcyB3cml0dGVuIGJ5IHtAbGluayAjd3JpdGVFeHRlcm5hbH0uCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHJlYWRFeHRlcm5hbChPYmplY3RJbnB1dCBp\nbikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRF\neGNlcHRpb24gewogICAgICAgIGZyb21Qcm9wZXJ0aWVzKChNYXApIGluLnJl\nYWRPYmplY3QoKSk7CiAgICAgICAgX3Byb3BzID0gKE1hcCkgaW4ucmVhZE9i\namVjdCgpOwogICAgICAgIF9nbG9iYWxzID0gaW4ucmVhZEJvb2xlYW4oKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudGF0aW9uIG9mIHRoZSB7\nQGxpbmsgRXh0ZXJuYWxpemFibGV9IGludGVyZmFjZSB0byB3cml0ZQogICAg\nICogdGhlIHByb3BlcnRpZXMgcmV0dXJuZWQgYnkge0BsaW5rICN0b1Byb3Bl\ncnRpZXN9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCB3cml0ZUV4dGVybmFs\nKE9iamVjdE91dHB1dCBvdXQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgb3V0LndyaXRlT2JqZWN0KHRvUHJvcGVydGllcyh0cnVlKSk7CiAgICAg\nICAgb3V0LndyaXRlT2JqZWN0KF9wcm9wcyk7CiAgICAgICAgb3V0LndyaXRl\nQm9vbGVhbihfZ2xvYmFscyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2Vz\nIHtAbGluayAjdG9Qcm9wZXJ0aWVzfSBhbmQge0BsaW5rICNmcm9tUHJvcGVy\ndGllc30gdG8gY2xvbmUKICAgICAqIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8K\nICAgIHB1YmxpYyBPYmplY3QgY2xvbmUoKSB7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgQ29uc3RydWN0b3IgY29ucyA9IGdldENsYXNzKCkuZ2V0Q29u\nc3RydWN0b3IKICAgICAgICAgICAgICAgIChuZXcgQ2xhc3NbXXsgYm9vbGVh\nbi5jbGFzcyB9KTsKICAgICAgICAgICAgQ29uZmlndXJhdGlvbkltcGwgY2xv\nbmUgPSAoQ29uZmlndXJhdGlvbkltcGwpIGNvbnMubmV3SW5zdGFuY2UKICAg\nICAgICAgICAgICAgIChuZXcgT2JqZWN0W117IEJvb2xlYW4uRkFMU0UgfSk7\nCiAgICAgICAgICAgIGNsb25lLmZyb21Qcm9wZXJ0aWVzKHRvUHJvcGVydGll\ncyh0cnVlKSk7CiAgICAgICAgICAgIGNsb25lLl9wcm9wcyA9IChfcHJvcHMg\nPT0gbnVsbCkgPyBudWxsIDogbmV3IEhhc2hNYXAoX3Byb3BzKTsKICAgICAg\nICAgICAgY2xvbmUuX2dsb2JhbHMgPSBfZ2xvYmFsczsKICAgICAgICAgICAg\ncmV0dXJuIGNsb25lOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRp\nb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cgcmU7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBhcnNl\nRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiByZW1vdmVWYWx1ZShWYWx1ZSB2YWwpIHsKICAgICAgICBpZiAoIV92\nYWxzLnJlbW92ZSh2YWwpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgdmFsLnNldExpc3RlbmVyKG51bGwpOwogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBhZGRWYWx1ZShWYWx1ZSB2\nYWwpIHsKICAgICAgICBfdmFscy5hZGQodmFsKTsKICAgICAgICB2YWwuc2V0\nTGlzdGVuZXIodGhpcyk7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gdmFsdWUgdG8gdGhlIHNldCBv\nZiBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTdHJpbmdWYWx1ZSBhZGRTdHJpbmcoU3RyaW5nIHByb3BlcnR5KSB7CiAg\nICAgICAgU3RyaW5nVmFsdWUgdmFsID0gbmV3IFN0cmluZ1ZhbHVlKHByb3Bl\ncnR5KTsKICAgICAgICBhZGRWYWx1ZSh2YWwpOwogICAgICAgIHJldHVybiB2\nYWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVuIHZhbHVl\nIHRvIHRoZSBzZXQgb2YgY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVzLgogICAg\nICovCiAgICBwdWJsaWMgRmlsZVZhbHVlIGFkZEZpbGUoU3RyaW5nIHByb3Bl\ncnR5KSB7CiAgICAgICAgRmlsZVZhbHVlIHZhbCA9IG5ldyBGaWxlVmFsdWUo\ncHJvcGVydHkpOwogICAgICAgIGFkZFZhbHVlKHZhbCk7CiAgICAgICAgcmV0\ndXJuIHZhbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4g\ndmFsdWUgdG8gdGhlIHNldCBvZiBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyBJbnRWYWx1ZSBhZGRJbnQoU3RyaW5nIHBy\nb3BlcnR5KSB7CiAgICAgICAgSW50VmFsdWUgdmFsID0gbmV3IEludFZhbHVl\nKHByb3BlcnR5KTsKICAgICAgICBhZGRWYWx1ZSh2YWwpOwogICAgICAgIHJl\ndHVybiB2YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVu\nIHZhbHVlIHRvIHRoZSBzZXQgb2YgY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVz\nLgogICAgICovCiAgICBwdWJsaWMgRG91YmxlVmFsdWUgYWRkRG91YmxlKFN0\ncmluZyBwcm9wZXJ0eSkgewogICAgICAgIERvdWJsZVZhbHVlIHZhbCA9IG5l\ndyBEb3VibGVWYWx1ZShwcm9wZXJ0eSk7CiAgICAgICAgYWRkVmFsdWUodmFs\nKTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQoKICAgIC8qKgogICAgICog\nQWRkIHRoZSBnaXZlbiB2YWx1ZSB0byB0aGUgc2V0IG9mIGNvbmZpZ3VyYXRp\nb24gcHJvcGVydGllcy4KICAgICAqLwogICAgcHVibGljIEJvb2xlYW5WYWx1\nZSBhZGRCb29sZWFuKFN0cmluZyBwcm9wZXJ0eSkgewogICAgICAgIEJvb2xl\nYW5WYWx1ZSB2YWwgPSBuZXcgQm9vbGVhblZhbHVlKHByb3BlcnR5KTsKICAg\nICAgICBhZGRWYWx1ZSh2YWwpOwogICAgICAgIHZhbC5zZXREZWZhdWx0KCJm\nYWxzZSIpOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBZGQgdGhlIGdpdmVuIHZhbHVlIHRvIHRoZSBzZXQgb2YgY29uZmln\ndXJhdGlvbiBwcm9wZXJ0aWVzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nTGlzdFZhbHVlIGFkZFN0cmluZ0xpc3QoU3RyaW5nIHByb3BlcnR5KSB7CiAg\nICAgICAgU3RyaW5nTGlzdFZhbHVlIHZhbCA9IG5ldyBTdHJpbmdMaXN0VmFs\ndWUocHJvcGVydHkpOwogICAgICAgIGFkZFZhbHVlKHZhbCk7CiAgICAgICAg\ncmV0dXJuIHZhbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2\nZW4gdmFsdWUgdG8gdGhlIHNldCBvZiBjb25maWd1cmF0aW9uIHByb3BlcnRp\nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3RWYWx1ZSBhZGRPYmplY3Qo\nU3RyaW5nIHByb3BlcnR5KSB7CiAgICAgICAgT2JqZWN0VmFsdWUgdmFsID0g\nbmV3IE9iamVjdFZhbHVlKHByb3BlcnR5KTsKICAgICAgICBhZGRWYWx1ZSh2\nYWwpOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBZGQgdGhlIGdpdmVuIHZhbHVlIHRvIHRoZSBzZXQgb2YgY29uZmlndXJh\ndGlvbiBwcm9wZXJ0aWVzLgogICAgICovCiAgICBwdWJsaWMgUGx1Z2luVmFs\ndWUgYWRkUGx1Z2luKFN0cmluZyBwcm9wZXJ0eSwgYm9vbGVhbiBzaW5nbGV0\nb24pIHsKICAgICAgICBQbHVnaW5WYWx1ZSB2YWwgPSBuZXcgUGx1Z2luVmFs\ndWUocHJvcGVydHksIHNpbmdsZXRvbik7CiAgICAgICAgYWRkVmFsdWUodmFs\nKTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQoKICAgIC8qKgogICAgICog\nQWRkIHRoZSBnaXZlbiB2YWx1ZSB0byB0aGUgc2V0IG9mIGNvbmZpZ3VyYXRp\nb24gcHJvcGVydGllcy4KICAgICAqLwogICAgcHVibGljIFBsdWdpbkxpc3RW\nYWx1ZSBhZGRQbHVnaW5MaXN0KFN0cmluZyBwcm9wZXJ0eSkgewogICAgICAg\nIFBsdWdpbkxpc3RWYWx1ZSB2YWwgPSBuZXcgUGx1Z2luTGlzdFZhbHVlKHBy\nb3BlcnR5KTsKICAgICAgICBhZGRWYWx1ZSh2YWwpOwogICAgICAgIHJldHVy\nbiB2YWw7CiAgICB9Cn0K\n","encoding":"base64"}

