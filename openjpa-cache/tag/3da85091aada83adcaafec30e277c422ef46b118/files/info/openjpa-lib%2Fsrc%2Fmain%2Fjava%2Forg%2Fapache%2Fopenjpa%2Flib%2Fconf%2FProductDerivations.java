{"sha":"3e1ae57e0db692f385d11a6f81fe7ec9d0f3f325","node_id":"MDQ6QmxvYjIwNjM2NDozZTFhZTU3ZTBkYjY5MmYzODVkMTFhNmY4MWZlN2VjOWQwZjNmMzI1","size":13402,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3e1ae57e0db692f385d11a6f81fe7ec9d0f3f325","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5D\nb21wYXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLk1pc3NpbmdSZXNvdXJjZUV4\nY2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5M\nb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nU2VydmljZXM7CgovKioKICogVXRpbGl0aWVzIGZvciBydW5uaW5nIHByb2R1\nY3QgZGVyaXZhdGlvbnMuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBu\nb2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBQcm9kdWN0RGVyaXZhdGlvbnMg\newoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0g\nTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUHJvZHVjdERlcml2YXRp\nb25zLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBQcm9kdWN0\nRGVyaXZhdGlvbltdIF9kZXJpdmF0aW9uczsKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIFN0cmluZ1tdIF9kZXJpdmF0aW9uTmFtZXM7CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBUaHJvd2FibGVbXSBfZGVyaXZhdGlvbkVycm9yczsK\nICAgIHByaXZhdGUgc3RhdGljIFN0cmluZ1tdIF9wcmVmaXhlczsKICAgIHN0\nYXRpYyB7CiAgICAgICAgQ2xhc3NMb2FkZXIgbCA9IFByb2R1Y3REZXJpdmF0\naW9uLmNsYXNzLmdldENsYXNzTG9hZGVyKCk7CiAgICAgICAgX2Rlcml2YXRp\nb25OYW1lcyA9IFNlcnZpY2VzLmdldEltcGxlbWVudG9ycyhQcm9kdWN0RGVy\naXZhdGlvbi5jbGFzcywgbCk7CiAgICAgICAgX2Rlcml2YXRpb25FcnJvcnMg\nPSBuZXcgVGhyb3dhYmxlW19kZXJpdmF0aW9uTmFtZXMubGVuZ3RoXTsKICAg\nICAgICBMaXN0IGRlcml2YXRpb25zID0gbmV3IEFycmF5TGlzdChfZGVyaXZh\ndGlvbk5hbWVzLmxlbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfZGVyaXZhdGlvbk5hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBQcm9kdWN0RGVyaXZhdGlvbiBkID0g\nKFByb2R1Y3REZXJpdmF0aW9uKSBDbGFzcy4KICAgICAgICAgICAgICAgICAg\nICBmb3JOYW1lKF9kZXJpdmF0aW9uTmFtZXNbaV0sIHRydWUsIGwpLm5ld0lu\nc3RhbmNlKCk7CiAgICAgICAgICAgICAgICBkLnZhbGlkYXRlKCk7CiAgICAg\nICAgICAgICAgICBkZXJpdmF0aW9ucy5hZGQoZCk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICBfZGVyaXZh\ndGlvbkVycm9yc1tpXSA9IHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIC8vIG11c3QgYmUgYXQgbGVhc3Qgb25lIHByb2R1Y3QgZGVyaXZh\ndGlvbiB0byBkZWZpbmUgbWV0YWRhdGEgZmFjdG9yaWVzLAogICAgICAgIC8v\nIGV0Yy4gCiAgICAgICAgaWYgKGRlcml2YXRpb25zLmlzRW1wdHkoKSkgewog\nICAgICAgICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9u\nKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAoIm5vLXByb2R1Y3QtZGVyaXZh\ndGlvbnMiLCBQcm9kdWN0RGVyaXZhdGlvbi5jbGFzcy5nZXROYW1lKCksCiAg\nICAgICAgICAgICAgICBkZXJpdmF0aW9uRXJyb3JzVG9TdHJpbmcoKSkuZ2V0\nTWVzc2FnZSgpLCAKICAgICAgICAgICAgICAgIFByb2R1Y3REZXJpdmF0aW9u\ncy5jbGFzcy5nZXROYW1lKCksImRlcml2YXRpb25zIik7CiAgICAgICAgfQoK\nICAgICAgICAvLyBpZiBzb21lIGRlcml2YXRpb25zIHdlcmVuJ3QgaW5zdGFu\ndGlhYmxlLCB3YXJuCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZGVy\naXZhdGlvbkVycm9ycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAo\nX2Rlcml2YXRpb25FcnJvcnNbaV0gPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oX2xv\nYy5nZXQoImJhZC1wcm9kdWN0LWRlcml2YXRpb25zIiwKICAgICAgICAgICAg\nICAgIFByb2R1Y3REZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1lKCkpKTsKICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBDb2xsZWN0aW9u\ncy5zb3J0KGRlcml2YXRpb25zLCBuZXcgUHJvZHVjdERlcml2YXRpb25Db21w\nYXJhdG9yKCkpOwogICAgICAgIF9kZXJpdmF0aW9ucyA9IChQcm9kdWN0RGVy\naXZhdGlvbltdKSBkZXJpdmF0aW9ucy50b0FycmF5CiAgICAgICAgICAgIChu\nZXcgUHJvZHVjdERlcml2YXRpb25bZGVyaXZhdGlvbnMuc2l6ZSgpXSk7Cgog\nICAgICAgIExpc3QgcHJlZml4ZXMgPSBuZXcgQXJyYXlMaXN0KDIpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRpb25zLmxlbmd0aDsg\naSsrKSB7CiAgICAgICAgICAgIGlmIChfZGVyaXZhdGlvbnNbaV0uZ2V0Q29u\nZmlndXJhdGlvblByZWZpeCgpICE9IG51bGwKICAgICAgICAgICAgICAgICYm\nICEib3BlbmpwYSIuZXF1YWxzKF9kZXJpdmF0aW9uc1tpXS5nZXRDb25maWd1\ncmF0aW9uUHJlZml4KCkpKQogICAgICAgICAgICAgICAgcHJlZml4ZXMuYWRk\nKF9kZXJpdmF0aW9uc1tpXS5nZXRDb25maWd1cmF0aW9uUHJlZml4KCkpOwog\nICAgICAgIH0KICAgICAgICBTdHJpbmdbXSBwcmVmaXhBcnJheSA9IG5ldyBT\ndHJpbmdbMSArIHByZWZpeGVzLnNpemUoKV07CiAgICAgICAgcHJlZml4QXJy\nYXlbMF0gPSAib3BlbmpwYSI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBwcmVmaXhlcy5zaXplKCk7IGkrKykKICAgICAgICAgICAgcHJlZml4QXJy\nYXlbaSArIDFdID0gKFN0cmluZykgcHJlZml4ZXMuZ2V0KGkpOwogICAgICAg\nIHNldENvbmZpZ3VyYXRpb25QcmVmaXhlcyhwcmVmaXhBcnJheSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIHRoZSBwcm9kdWN0IGRlcml2\nYXRpb25zIHJlZ2lzdGVyZWQgaW4gdGhlIGN1cnJlbnQgY2xhc3Nsb2FkZXIK\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBQcm9kdWN0RGVyaXZhdGlvbltd\nIGdldFByb2R1Y3REZXJpdmF0aW9ucygpIHsKICAgICAgICByZXR1cm4gX2Rl\ncml2YXRpb25zOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBy\nZWNvZ25pemVkIHByZWZpeGVzIGZvciBjb25maWd1cmF0aW9uIHByb3BlcnRp\nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nW10gZ2V0Q29u\nZmlndXJhdGlvblByZWZpeGVzKCkgewogICAgICAgIHJldHVybiBfcHJlZml4\nZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGNvbmZpZ3VyYXRp\nb24gcHJlZml4IGFycmF5LiBUaGlzIGlzIHBhY2thZ2UtdmlzaWJsZSBmb3Ig\nCiAgICAgKiB0ZXN0aW5nIHB1cnBvc2VzLgogICAgICogCiAgICAgKiBAc2lu\nY2UgMC45LjcKICAgICAqLwogICAgc3RhdGljIHZvaWQgc2V0Q29uZmlndXJh\ndGlvblByZWZpeGVzKFN0cmluZ1tdIHByZWZpeGVzKSB7CiAgICAgICAgX3By\nZWZpeGVzID0gcHJlZml4ZXM7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nRGV0ZXJtaW5lIHRoZSBmdWxsIGtleSBuYW1lIGZvciA8Y29kZT5rZXk8L2Nv\nZGU+LCBnaXZlbiB0aGUgcmVnaXN0ZXJlZAogICAgICogcHJlZml4ZXMgYW5k\nIHRoZSBlbnRyaWVzIGluIDxjb2RlPm1hcDwvY29kZT4uIFRoaXMgbWV0aG9k\nCiAgICAgKiBjb21wdXRlcyB0aGUgYXBwcm9wcmlhdGUgY29uZmlndXJhdGlv\nbiBwcmVmaXggdG8gdXNlIGJ5IGxvb2tpbmcgCiAgICAgKiB0aHJvdWdoIDxj\nb2RlPm1hcDwvY29kZT4gZm9yIGEga2V5IHN0YXJ0aW5nIHdpdGggYW55IG9m\nIHRoZSBrbm93bgogICAgICogY29uZmlndXJhdGlvbiBwcmVmaXhlcyBhbmQg\nZW5kaW5nIHdpdGggPGNvZGU+a2V5PC9jb2RlPiBhbmQsIGlmIGEKICAgICAq\nIHZhbHVlIGlzIGZvdW5kLCB1c2luZyB0aGUgcHJlZml4IG9mIHRoYXQga2V5\nLiBPdGhlcndpc2UsIGl0IHVzZXMKICAgICAqIHRoZSBmaXJzdCByZWdpc3Rl\ncmVkIHByZWZpeC4gCiAgICAgKiAKICAgICAqIEBzaW5jZSAwLjkuNwogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyBnZXRDb25maWd1cmF0aW9u\nS2V5KFN0cmluZyBwYXJ0aWFsS2V5LCBNYXAgbWFwKSB7CiAgICAgICAgU3Ry\naW5nIGZpcnN0S2V5ID0gbnVsbDsKICAgICAgICBmb3IgKGludCBpID0gMDsg\nbWFwICE9IG51bGwgJiYgaSA8IF9wcmVmaXhlcy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBTdHJpbmcgZnVsbEtleSA9IF9wcmVmaXhlc1tpXSArICIu\nIiArIHBhcnRpYWxLZXk7CiAgICAgICAgICAgIGlmIChtYXAuY29udGFpbnNL\nZXkoZnVsbEtleSkpIHsKICAgICAgICAgICAgICAgIGlmIChmaXJzdEtleSA9\nPSBudWxsKSAKICAgICAgICAgICAgICAgICAgICBmaXJzdEtleSA9IGZ1bGxL\nZXk7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAg\nICAvLyBpZiB3ZSd2ZSBhbHJlYWR5IGZvdW5kIGEgcHJvcGVydHkgd2l0aCBh\nIHByZXZpb3VzIAogICAgICAgICAgICAgICAgICAgIC8vIHByZWZpeCwgdGhl\nbiB0aGlzIGlzIGEgY29sbGlzaW9uLgogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoCiAgICAg\nICAgICAgICAgICAgICAgICAgICJkdXAtd2l0aC1kaWZmZXJlbnQtcHJlZml4\nZXMiLCBmaXJzdEtleSwgZnVsbEtleSkKICAgICAgICAgICAgICAgICAgICAg\nICAgLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGZpcnN0S2V5\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBfcHJlZml4ZXNbMF0gKyAi\nLiIgKyBwYXJ0aWFsS2V5OwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0\ndXJuIGZpcnN0S2V5OwogICAgfQoKICAgIC8qKgogICAgICogQXBwbHkge0Bs\naW5rIFByb2R1Y3REZXJpdmF0aW9uI2JlZm9yZUNvbmZpZ3VyYXRpb25Db25z\ndHJ1Y3R9IGNhbGxiYWNrcwogICAgICogdG8gdGhlIHRoZSBnaXZlbiBpbnN0\nYW5jZS4gRXhjZXB0aW9ucyBhcmUgc3dhbGxvd2VkLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgYmVmb3JlQ29uZmlndXJhdGlvbkNvbnN0cnVj\ndChDb25maWd1cmF0aW9uUHJvdmlkZXIgY3ApIHsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9kZXJpdmF0aW9ucy5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX2Rlcml2YXRpb25zW2ld\nLmJlZm9yZUNvbmZpZ3VyYXRpb25Db25zdHJ1Y3QoY3ApOwogICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8g\nY2FuJ3QgbG9nOyBubyBjb25maWd1cmF0aW9uIHlldAogICAgICAgICAgICAg\nICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFwcGx5IHtAbGluayBQcm9kdWN0\nRGVyaXZhdGlvbiNiZWZvcmVDb25maWd1cmF0aW9uTG9hZH0gY2FsbGJhY2tz\nCiAgICAgKiB0byB0aGUgdGhlIGdpdmVuIGluc3RhbmNlLiBFeGNlcHRpb25z\nIGFyZSBzd2FsbG93ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9p\nZCBiZWZvcmVDb25maWd1cmF0aW9uTG9hZChDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJpdmF0aW9ucy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgX2Rlcml2YXRpb25zW2ldLmJlZm9yZUNvbmZpZ3VyYXRpb25Mb2FkKGNv\nbmYpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgLy8gbG9nZ2luZyBub3QgY29uZmlndXJlZCB5ZXQKICAg\nICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBseSB7QGxp\nbmsgUHJvZHVjdERlcml2YXRpb24jYWZ0ZXJTcGVjaWZpY2F0aW9uU2V0fSBj\nYWxsYmFja3MKICAgICAqIHRvIHRoZSB0aGUgZ2l2ZW4gaW5zdGFuY2UuIEV4\nY2VwdGlvbnMgYXJlIHN3YWxsb3dlZC4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyB2b2lkIGFmdGVyU3BlY2lmaWNhdGlvblNldChDb25maWd1cmF0aW9u\nIGNvbmYpIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJpdmF0\naW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgX2Rlcml2YXRpb25zW2ldLmFmdGVyU3BlY2lmaWNhdGlvblNl\ndChjb25mKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgIC8vIGxvZ2dpbmcgbm90IGNvbmZpZ3VyZWQgeWV0\nCiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ2FsbGVk\nIGFzIHRoZSBmaXJzdCBzdGVwIG9mIGEgQ29uZmlndXJhdGlvbidzIGNsb3Nl\nKCkgbWV0aG9kLiAKICAgICAqIEV4Y2VwdGlvbnMgYXJlIHN3YWxsb3dlZC4K\nICAgICAqIAogICAgICogQHNpbmNlIDAuOS43CiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgdm9pZCBiZWZvcmVDbG9zZShDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJpdmF0aW9ucy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgX2Rlcml2YXRpb25zW2ldLmJlZm9yZUNvbmZpZ3VyYXRpb25DbG9zZShj\nb25mKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIGNvbmYuZ2V0Q29uZmlndXJhdGlvbkxvZygpLndhcm4o\nX2xvYy5nZXQoImJlZm9yZS1jbG9zZS1leCIpLCBlKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgdGhlIGdp\ndmVuIGdpdmVuIHJlc291cmNlLCBvciByZXR1cm4gZmFsc2UgaWYgaXQgaXMg\nbm90IGEgcmVzb3VyY2UKICAgICAqIHRoaXMgcHJvdmlkZXIgdW5kZXJzdGFu\nZHMuIFRoZSBnaXZlbiBjbGFzcyBsb2FkZXIgbWF5IGJlIG51bGwuCiAgICAg\nKgogICAgICogQHBhcmFtIGFuY2hvciBvcHRpb25hbCBuYW1lZCBhbmNob3Ig\nd2l0aGluIGEgbXVsdGlwbGUtY29uZmlndXJhdGlvbgogICAgICogcmVzb3Vy\nY2UKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBDb25maWd1cmF0aW9uUHJv\ndmlkZXIgbG9hZChTdHJpbmcgcmVzb3VyY2UsIFN0cmluZyBhbmNob3IsIAog\nICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIGlmIChTdHJp\nbmdVdGlscy5pc0VtcHR5KHJlc291cmNlKSkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgaWYgKGxvYWRlciA9PSBudWxsKQogICAgICAgICAg\nICBsb2FkZXIgPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRD\nbGFzc0xvYWRlcigpOwogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlciBw\ncm92aWRlciA9IG51bGw7CiAgICAgICAgU3RyaW5nQnVmZmVyIGVycnMgPSBu\ndWxsOwogICAgICAgIC8vIG1vc3Qgc3BlY2lmaWMgdG8gbGVhc3QKICAgICAg\nICBmb3IgKGludCBpID0gX2Rlcml2YXRpb25zLmxlbmd0aCAtIDE7IGkgPj0g\nMDsgaS0tKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBw\ncm92aWRlciA9IF9kZXJpdmF0aW9uc1tpXS5sb2FkKHJlc291cmNlLCBhbmNo\nb3IsIGxvYWRlcik7CiAgICAgICAgICAgICAgICBpZiAocHJvdmlkZXIgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvdmlkZXI7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAg\nICAgICBlcnJzID0gKGVycnMgPT0gbnVsbCkgPyBuZXcgU3RyaW5nQnVmZmVy\nKCkgOiBlcnJzLmFwcGVuZCgiXG4iKTsKICAgICAgICAgICAgICAgIGVycnMu\nYXBwZW5kKF9kZXJpdmF0aW9uc1tpXS5nZXRDbGFzcygpLmdldE5hbWUoKSAr\nICI6IiArIHQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJl\ncG9ydEVycm9ycyhlcnJzLCByZXNvdXJjZSk7CiAgICAgICAgdGhyb3cgbmV3\nIE1pc3NpbmdSZXNvdXJjZUV4Y2VwdGlvbihyZXNvdXJjZSwgCiAgICAgICAg\nICAgIFByb2R1Y3REZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1lKCksIHJlc291\ncmNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgZ2l2ZW4gZmlsZSwg\nb3IgcmV0dXJuIGZhbHNlIGlmIGl0IGlzIG5vdCBhIGZpbGUgdGhpcyBwcm92\naWRlcgogICAgICogdW5kZXJzdGFuZHMuCiAgICAgKgogICAgICogQHBhcmFt\nIGFuY2hvciBvcHRpb25hbCBuYW1lZCBhbmNob3Igd2l0aGluIGEgbXVsdGlw\nbGUtY29uZmlndXJhdGlvbiBmaWxlCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgQ29uZmlndXJhdGlvblByb3ZpZGVyIGxvYWQoRmlsZSBmaWxlLCBTdHJp\nbmcgYW5jaG9yLCAKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAg\nICAgICBpZiAoZmlsZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAobG9hZGVyID09IG51bGwpCiAgICAgICAgICAgIGxv\nYWRlciA9IFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNz\nTG9hZGVyKCk7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVyIHByb3Zp\nZGVyID0gbnVsbDsKICAgICAgICBTdHJpbmdCdWZmZXIgZXJycyA9IG51bGw7\nCiAgICAgICAgLy8gbW9zdCBzcGVjaWZpYyB0byBsZWFzdAogICAgICAgIGZv\nciAoaW50IGkgPSBfZGVyaXZhdGlvbnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBp\nLS0pIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHByb3Zp\nZGVyID0gX2Rlcml2YXRpb25zW2ldLmxvYWQoZmlsZSwgYW5jaG9yKTsKICAg\nICAgICAgICAgICAgIGlmIChwcm92aWRlciAhPSBudWxsKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBwcm92aWRlcjsKICAgICAgICAgICAgfSBjYXRj\naCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgIGVycnMgPSAoZXJy\ncyA9PSBudWxsKSA/IG5ldyBTdHJpbmdCdWZmZXIoKSA6IGVycnMuYXBwZW5k\nKCJcbiIpOwogICAgICAgICAgICAgICAgZXJycy5hcHBlbmQoX2Rlcml2YXRp\nb25zW2ldLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIjoiICsgdCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmVwb3J0RXJyb3JzKGVycnMs\nIGZpbGUuZ2V0QWJzb2x1dGVQYXRoKCkpOwogICAgICAgIHRocm93IG5ldyBN\naXNzaW5nUmVzb3VyY2VFeGNlcHRpb24oZmlsZS5nZXRBYnNvbHV0ZVBhdGgo\nKSwgCiAgICAgICAgICAgIFByb2R1Y3REZXJpdmF0aW9ucy5jbGFzcy5nZXRO\nYW1lKCksIGZpbGUuZ2V0QWJzb2x1dGVQYXRoKCkpOwogICAgfQogICAKICAg\nIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5rIENvbmZpZ3VyYXRpb25Qcm92\naWRlcn0gdGhhdCBoYXMgcGFyc2VkIHN5c3RlbSBkZWZhdWx0cy4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9h\nZERlZmF1bHRzKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIHJldHVy\nbiBsb2FkKGxvYWRlciwgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIGEge0BsaW5rIENvbmZpZ3VyYXRpb25Qcm92aWRlcn0gdGhhdCBo\nYXMgcGFyc2VkIHN5c3RlbSBnbG9iYWxzLgogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkR2xvYmFscyhDbGFz\nc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICByZXR1cm4gbG9hZChsb2FkZXIs\nIHRydWUpOwogICAgfQogICAgICAgICAgICAKICAgIC8qKgogICAgICogTG9h\nZCBhIGJ1aWx0LWluIHJlc291cmNlIGxvY2F0aW9uLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZChDbGFz\nc0xvYWRlciBsb2FkZXIsIAogICAgICAgYm9vbGVhbiBnbG9iYWxzKSB7CiAg\nICAgICAgaWYgKGxvYWRlciA9PSBudWxsKQogICAgICAgICAgICBsb2FkZXIg\nPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRl\ncigpOwogICAgICAgIAogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlciBw\ncm92aWRlciA9IG51bGw7CiAgICAgICAgU3RyaW5nQnVmZmVyIGVycnMgPSBu\ndWxsOwogICAgICAgIFN0cmluZyB0eXBlID0gKGdsb2JhbHMpID8gImdsb2Jh\nbHMiIDogImRlZmF1bHRzIjsKICAgICAgICAvLyBtb3N0IHNwZWNpZmljIHRv\nIGxlYXN0CiAgICAgICAgZm9yIChpbnQgaSA9IF9kZXJpdmF0aW9ucy5sZW5n\ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgcHJvdmlkZXIgPSAoZ2xvYmFscykgPyBfZGVyaXZhdGlv\nbnNbaV0ubG9hZEdsb2JhbHMobG9hZGVyKSAKICAgICAgICAgICAgICAgICAg\nICA6IF9kZXJpdmF0aW9uc1tpXS5sb2FkRGVmYXVsdHMobG9hZGVyKTsKICAg\nICAgICAgICAgICAgIGlmIChwcm92aWRlciAhPSBudWxsKQogICAgICAgICAg\nICAgICAgICAgcmV0dXJuIHByb3ZpZGVyOwogICAgICAgICAgICB9IGNhdGNo\nIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAgICAgZXJycyA9IChlcnJz\nID09IG51bGwpID8gbmV3IFN0cmluZ0J1ZmZlcigpIDogZXJycy5hcHBlbmQo\nIlxuIik7CiAgICAgICAgICAgICAgICBlcnJzLmFwcGVuZChfZGVyaXZhdGlv\nbnNbaV0uZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiOiIgKyB0KTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXBvcnRFcnJvcnMoZXJycywg\ndHlwZSk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAKICAgIC8qKgog\nICAgICogVGhyb3duIHByb3BlciBleGNlcHRpb24gZm9yIGdpdmVuIGVycm9y\ncy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCByZXBvcnRFcnJv\ncnMoU3RyaW5nQnVmZmVyIGVycnMsIFN0cmluZyByZXNvdXJjZSkgewogICAg\nICAgIGlmIChlcnJzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKGVycnMu\ndG9TdHJpbmcoKSwgCiAgICAgICAgICAgIFByb2R1Y3REZXJpdmF0aW9ucy5j\nbGFzcy5nZXROYW1lKCksIHJlc291cmNlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENvbXBhcmUge0BsaW5rIFByb2R1Y3REZXJpdmF0aW9ufXMuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFByb2R1Y3REZXJpdmF0aW9u\nQ29tcGFyYXRvcgogICAgICAgIGltcGxlbWVudHMgQ29tcGFyYXRvciB7Cgog\nICAgICAgIHB1YmxpYyBpbnQgY29tcGFyZShPYmplY3QgbzEsIE9iamVjdCBv\nMikgewogICAgICAgICAgICBpbnQgdHlwZTEgPSAoKFByb2R1Y3REZXJpdmF0\naW9uKSBvMSkuZ2V0VHlwZSgpOwogICAgICAgICAgICBpbnQgdHlwZTIgPSAo\nKFByb2R1Y3REZXJpdmF0aW9uKSBvMikuZ2V0VHlwZSgpOwogICAgICAgICAg\nICBpZiAodHlwZTEgIT0gdHlwZTIpCiAgICAgICAgICAgICAgICByZXR1cm4g\ndHlwZTEgLSB0eXBlMjsKCiAgICAgICAgICAgIC8vIGFyYml0cmFyeSBidXQg\nY29uc2lzdGVudCBvcmRlcgogICAgICAgICAgICByZXR1cm4gbzEuZ2V0Q2xh\nc3MoKS5nZXROYW1lKCkuY29tcGFyZVRvKG8yLmdldENsYXNzKCkuCiAgICAg\nICAgICAgICAgICBnZXROYW1lKCkpOwoJCX0KCX0KCiAgICAvKioKICAgICAq\nIFByaW50cyBwcm9kdWN0IGRlcml2YXRpb24gaW5mb3JtYXRpb24uCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3Mp\nIHsKICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oZGVyaXZhdGlvbkVycm9y\nc1RvU3RyaW5nKCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEg\nbWVzc2FnZSBhYm91dCB0aGUgc3RhdHVzIG9mIGVhY2ggcHJvZHVjdCBkZXJp\ndmF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgZGVy\naXZhdGlvbkVycm9yc1RvU3RyaW5nKCkgewogICAgICAgIFN0cmluZ0J1ZmZl\nciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgYnVmLmFwcGVu\nZCgiUHJvZHVjdERlcml2YXRpb25zOiAiKS5hcHBlbmQoX2Rlcml2YXRpb25O\nYW1lcy5sZW5ndGgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rl\ncml2YXRpb25OYW1lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBidWYu\nYXBwZW5kKCJcbiIpLmFwcGVuZChpICsgMSkuYXBwZW5kKCIuICIpLgogICAg\nICAgICAgICAgICAgYXBwZW5kKF9kZXJpdmF0aW9uTmFtZXNbaV0pLmFwcGVu\nZCgiOiAiKTsKICAgICAgICAgICAgaWYgKF9kZXJpdmF0aW9uRXJyb3JzW2ld\nID09IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCJPSyIpOwog\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKF9k\nZXJpdmF0aW9uRXJyb3JzW2ldLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9Cn0KCg==\n","encoding":"base64"}

