{"sha":"0bb51bb1172bc4cd4c3aecb76bfe2f5fd358c734","node_id":"MDQ6QmxvYjIwNjM2NDowYmI1MWJiMTE3MmJjNGNkNGMzYWVjYjc2YmZlMmY1ZmQzNThjNzM0","size":4296,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0bb51bb1172bc4cd4c3aecb76bfe2f5fd358c734","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5QYXJzZUV4Y2VwdGlv\nbjsKCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBBIGNvbW1h\nLXNlcGFyYXRlZCBsaXN0IG9mIHN0cmluZyB2YWx1ZXMuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgU3RyaW5nTGlzdFZhbHVl\nIGV4dGVuZHMgVmFsdWUgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nW10gRU1QVFkgPSBuZXcgU3RyaW5nWzBdOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIHNfbG9jID0gTG9jYWxpemVyLmZvclBhY2th\nZ2UKICAgICAgICAoU3RyaW5nTGlzdFZhbHVlLmNsYXNzKTsKCiAgICBwcml2\nYXRlIFN0cmluZ1tdIF92YWx1ZXMgPSBFTVBUWTsKCiAgICBwdWJsaWMgU3Ry\naW5nTGlzdFZhbHVlKFN0cmluZyBwcm9wKSB7CiAgICAgICAgc3VwZXIocHJv\ncCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgaW50ZXJuYWwgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldChTdHJpbmdbXSB2YWx1ZXMp\nIHsKICAgICAgICBfdmFsdWVzID0gKHZhbHVlcyA9PSBudWxsKSA/IEVNUFRZ\nIDogdmFsdWVzOwogICAgICAgIHZhbHVlQ2hhbmdlZCgpOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGludGVybmFsIHZhbHVlLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0KCkgewogICAgICAgIHJldHVybiBfdmFsdWVz\nOwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBnZXRWYWx1ZVR5cGUoKSB7CiAg\nICAgICAgcmV0dXJuIFN0cmluZ1tdLmNsYXNzOwogICAgfQogICAgCiAgICAv\nKioKICAgICAqIFVuYWxpYXMgdGhlIHZhbHVlIGxpc3QuICBUaGlzIG1ldGhv\nZCBkZWZlcnMgdG8gc3VwZXIudW5hbGlhcygpCiAgICAgKiBVTkxFU1MgdGhl\nIHN0cmluZyBwYXNzZWQgaXMgYSBsaXN0IG9mIHZhbHVlcyBmb3IgYSBwcm9w\nZXJ0eSB0aGF0CiAgICAgKiBoYXMgYWxpYXNlcy4KICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyB1bmFsaWFzKFN0cmluZyBzdHIpIHsKICAgICAgICAKICAg\nICAgICAvLyBkZWZlciB0byBzdXBlci51bmFsaWFzCiAgICAgICAgU3RyaW5n\nW10gYWxpYXNlcyA9IGdldEFsaWFzZXMoKTsKICAgICAgICBpZiAoYWxpYXNl\ncy5sZW5ndGggPD0gMCB8fCBzdHIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLnVuYWxpYXMoc3RyKTsKICAgICAgICBzdHIgPSBzdHIudHJp\nbSgpOwogICAgICAgIGlmIChzdHIubGVuZ3RoKCkgPD0gMCkKICAgICAgICAg\nICAgcmV0dXJuIHN1cGVyLnVuYWxpYXMoc3RyKTsKICAgICAgICAKICAgICAg\nICAvLyBzbmFnIHRoaXMgY2FzZSBlYXJseSBhcyBpdCBvbmx5IGNhdXNlcyBw\ncm9ibGVtcwogICAgICAgIGlmIChzdHIuZXF1YWxzKCIsIikpCiAgICAgICAg\nICAgIHRocm93IG5ldyBQYXJzZUV4Y2VwdGlvbihzX2xvYy5nZXQoImludmFs\naWQtbGlzdC1jb25maWciLAogICAgICAgICAgICAgICAgZ2V0UHJvcGVydHko\nKSwgc3RyLCBnZXRBbGlhc0xpc3QoKSkpOwogICAgICAgIAogICAgICAgIC8v\nIHVuYWxpYXMgdGhlIGxpc3QgYW5kIGNvbmNhdGVuYXRlIHRoZSBsaXN0IG9m\nCiAgICAgICAgLy8gY2Fub25pY2FsIHZhbHVlcy4gIEFsc28sIGNhdGNoIGFu\neSBiYWQgYWxpYXNlcy4KICAgICAgICBib29sZWFuIGZvdW5kOwogICAgICAg\nIFN0cmluZyBpU3RyaW5nOwogICAgICAgIFN0cmluZ0J1ZmZlciByZXR2ID0g\nbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIFN0cmluZ1tdIHZhbHMgPSBz\ndHIuc3BsaXQoIiwiLCAwKTsKICAgICAgICAKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaVN0\ncmluZyA9IHZhbHNbaV0gPSB2YWxzW2ldLnRyaW0oKTsKICAgICAgICAgICAg\nCiAgICAgICAgICAgIGZvdW5kID0gZmFsc2U7CiAgICAgICAgICAgIGlmIChp\nID4gMCkKICAgICAgICAgICAgICAgIHJldHYuYXBwZW5kKCcsJyk7CiAgICAg\nICAgICAgIAogICAgICAgICAgICBmb3IgKGludCB4ID0gMDsgeCA8IGFsaWFz\nZXMubGVuZ3RoOyB4ICs9IDIpCiAgICAgICAgICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuZXF1YWxzKGlTdHJpbmcsIGFsaWFzZXNbeF0pCiAgICAgICAgICAg\nICAgICAgICAgfHwgU3RyaW5nVXRpbHMuZXF1YWxzKGlTdHJpbmcsIGFsaWFz\nZXNbeCArIDFdKSkgewogICAgICAgICAgICAgICAgICAgIHJldHYuYXBwZW5k\nKGFsaWFzZXNbeCArIDFdKTsKICAgICAgICAgICAgICAgICAgICBmb3VuZCA9\nIHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBJZiB0aGUgYWxp\nYXMgbGlzdCBpcyBub3QgY29tcHJlaGVuc2l2ZSwgYWRkIGFueSB1bmtub3du\nCiAgICAgICAgICAgIC8vIHZhbHVlcyBiYWNrIG9udG8gdGhlIGxpc3QKICAg\nICAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgICAgICAgaWYgKGlz\nQWxpYXNMaXN0Q29tcHJlaGVuc2l2ZSgpKQogICAgICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBQYXJzZUV4Y2VwdGlvbihzX2xvYy5nZXQoImludmFsaWQt\nbGlzdC1jb25maWciLAogICAgICAgICAgICAgICAgICAgICAgICBnZXRQcm9w\nZXJ0eSgpLCBzdHIsIGdldEFsaWFzTGlzdCgpKSk7CiAgICAgICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICAgICAgcmV0di5hcHBlbmQoaVN0cmlu\nZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJl\ndHYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdl\ndEludGVybmFsU3RyaW5nKCkgewogICAgICAgIHJldHVybiBTdHJpbmdzLmpv\naW4oX3ZhbHVlcywgIiwgIik7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nc2V0SW50ZXJuYWxTdHJpbmcoU3RyaW5nIHZhbCkgewogICAgICAgIFN0cmlu\nZ1tdIHZhbHMgPSBTdHJpbmdzLnNwbGl0KHZhbCwgIiwiLCAwKTsKICAgICAg\nICBpZiAodmFscyAhPSBudWxsKSB7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgdmFscy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIHZh\nbHNbaV0gPSB2YWxzW2ldLnRyaW0oKTsKICAgICAgICB9CgogICAgICAgIHNl\ndCh2YWxzKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRJbnRlcm5h\nbE9iamVjdChPYmplY3Qgb2JqKSB7CiAgICAgICAgc2V0KChTdHJpbmdbXSkg\nb2JqKTsKICAgIH0KICAgIAogICAgcHJvdGVjdGVkIExpc3QgZ2V0QWxpYXNM\naXN0KCkgewogICAgICAgIHJldHVybiBBcnJheXMuYXNMaXN0KGdldEFsaWFz\nZXMoKSk7CiAgICB9CiAgICAKfQoK\n","encoding":"base64"}

