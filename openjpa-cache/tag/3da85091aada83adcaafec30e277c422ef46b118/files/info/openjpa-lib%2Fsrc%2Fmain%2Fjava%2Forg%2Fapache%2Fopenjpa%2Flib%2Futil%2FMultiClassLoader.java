{"sha":"0fc96658b6f47f06dc8e6fd32d709137c66f10a3","node_id":"MDQ6QmxvYjIwNjM2NDowZmM5NjY1OGI2ZjQ3ZjA2ZGM4ZTZmZDMyZDcwOTEzN2M2NmYxMGEz","size":7941,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0fc96658b6f47f06dc8e6fd32d709137c66f10a3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWw7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0LlVSTDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuRW51\nbWVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5WZWN0b3I7CgovKioK\nICogQ2xhc3MgbG9hZGVyIHR5cGUgdGhhdCBjYW4gYmUgY29uZmlndXJlZCB0\nbyBkZWxlZ2F0ZSB0byBtdWx0aXBsZQogKiBpbnRlcm5hbCBjbGFzcyBsb2Fk\nZXJzLgogKiBUaGUge0BsaW5rICNUSFJFQURfTE9BREVSfSBjb25zdGFudCBp\ncyBhIG1hcmtlciB0aGF0IHdpbGwgYmUgcmVwbGFjZWQKICogd2l0aCB0aGUg\nY29udGV4dCBsb2FkZXIgb2YgdGhlIGN1cnJlbnQgdGhyZWFkLgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIE11bHRpQ2xhc3NM\nb2FkZXIgZXh0ZW5kcyBDbGFzc0xvYWRlciB7CgogICAgLyoqCiAgICAgKiBN\nYXJrZXIgdGhhdCB3aWxsIGJlIHJlcGxhY2VkIHdpdGggdGhlIGNvbnRleHQg\nbG9hZGVyIG9mIHRoZSBjdXJyZW50CiAgICAgKiB0aHJlYWQgd2hlbmV2ZXIg\naXQgaXMgZGlzY292ZXJlZCBpbiB0aGUgY2xhc3MgbG9hZGVyIGxpc3QuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgQ2xhc3NMb2FkZXIgVEhS\nRUFEX0xPQURFUiA9IG51bGw7CgogICAgLyoqCiAgICAgKiBUaGUgc3RhbmRh\ncmQgc3lzdGVtIGNsYXNzIGxvYWRlci4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBDbGFzc0xvYWRlciBTWVNURU1fTE9BREVSID0KICAgICAg\nICBDbGFzc0xvYWRlci5nZXRTeXN0ZW1DbGFzc0xvYWRlcigpOwoKICAgIHBy\naXZhdGUgTGlzdCBfbG9hZGVycyA9IG5ldyBBcnJheUxpc3QoNSk7CgogICAg\nLyoqCiAgICAgKiBDb25zdHJ1Y3RvcjsgaW5pdGlhbGl6ZXMgdGhlIGxvYWRl\nciB3aXRoIGFuIGVtcHR5IGxpc3Qgb2YgZGVsZWdhdGVzLgogICAgICovCiAg\nICBwdWJsaWMgTXVsdGlDbGFzc0xvYWRlcigpIHsKICAgICAgICBzdXBlcihu\ndWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCB3aXRoIHRo\nZSBjbGFzcyBsb2FkZXJzIG9mIGFub3RoZXIgbXVsdGkgbG9hZGVyLgogICAg\nICovCiAgICBwdWJsaWMgTXVsdGlDbGFzc0xvYWRlcihNdWx0aUNsYXNzTG9h\nZGVyIG90aGVyKSB7CiAgICAgICAgc3VwZXIobnVsbCk7CiAgICAgICAgYWRk\nQ2xhc3NMb2FkZXJzKG90aGVyKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybnMgdHJ1ZSBpZiB0aGUgbGlzdCBjb250YWlucyB0aGUgZ2l2ZW4gY2xh\nc3MgbG9hZGVyIG9yIG1hcmtlci4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gY29udGFpbnNDbGFzc0xvYWRlcihDbGFzc0xvYWRlciBsb2FkZXIpIHsK\nICAgICAgICByZXR1cm4gX2xvYWRlcnMuY29udGFpbnMobG9hZGVyKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhbiBhcnJheSBvZiBhbGwgY29u\ndGFpbmVkIGNsYXNzIGxvYWRlcnMuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\nc0xvYWRlcltdIGdldENsYXNzTG9hZGVycygpIHsKICAgICAgICBDbGFzc0xv\nYWRlcltdIGxvYWRlcnMgPSBuZXcgQ2xhc3NMb2FkZXJbc2l6ZSgpXTsKICAg\nICAgICBDbGFzc0xvYWRlciBsb2FkZXI7CiAgICAgICAgSXRlcmF0b3IgaXRy\nID0gX2xvYWRlcnMuaXRlcmF0b3IoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGxvYWRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgbG9h\nZGVyID0gKENsYXNzTG9hZGVyKSBpdHIubmV4dCgpOwogICAgICAgICAgICBp\nZiAobG9hZGVyID09IFRIUkVBRF9MT0FERVIpCiAgICAgICAgICAgICAgICBs\nb2FkZXIgPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFz\nc0xvYWRlcigpOwogICAgICAgICAgICBsb2FkZXJzW2ldID0gbG9hZGVyOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gbG9hZGVyczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgY2xhc3MgbG9hZGVyIGF0IHRoZSBnaXZl\nbiBpbmRleC4KICAgICAqLwogICAgcHVibGljIENsYXNzTG9hZGVyIGdldENs\nYXNzTG9hZGVyKGludCBpbmRleCkgewogICAgICAgIENsYXNzTG9hZGVyIGxv\nYWRlciA9IChDbGFzc0xvYWRlcikgX2xvYWRlcnMuZ2V0KGluZGV4KTsKICAg\nICAgICBpZiAobG9hZGVyID09IFRIUkVBRF9MT0FERVIpCiAgICAgICAgICAg\nIGxvYWRlciA9IFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0Q29udGV4dENs\nYXNzTG9hZGVyKCk7CiAgICAgICAgcmV0dXJuIGxvYWRlcjsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gY2xhc3MgbG9hZGVyIHRvIHRo\nZSBzZXQgb2YgbG9hZGVycyB0aGF0IHdpbGwgYmUgdHJpZWQuCiAgICAgKgog\nICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBsb2FkZXIgd2FzIGFkZGVkLCBm\nYWxzZSBpZiBhbHJlYWR5IGluIHRoZSBsaXN0CiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGFkZENsYXNzTG9hZGVyKENsYXNzTG9hZGVyIGxvYWRlcikg\newogICAgICAgIGlmIChfbG9hZGVycy5jb250YWlucyhsb2FkZXIpKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIF9sb2FkZXJz\nLmFkZChsb2FkZXIpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBn\naXZlbiBjbGFzcyBsb2FkZXIgYXQgdGhlIHNwZWNpZmllZCBpbmRleC4KICAg\nICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGxvYWRlciB3YXMgYWRk\nZWQsIGZhbHNlIGlmIGFscmVhZHkgaW4gdGhlIGxpc3QKICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gYWRkQ2xhc3NMb2FkZXIoaW50IGluZGV4LCBDbGFz\nc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBpZiAoX2xvYWRlcnMuY29udGFp\nbnMobG9hZGVyKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIF9sb2FkZXJzLmFkZChpbmRleCwgbG9hZGVyKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY2xhc3MgbG9h\nZGVycyBvZiB0aGlzIGxvYWRlciB0byB0aG9zZSBvZiB0aGUgZ2l2ZW4gbG9h\nZGVyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRDbGFzc0xvYWRlcnMo\nTXVsdGlDbGFzc0xvYWRlciBtdWx0aSkgewogICAgICAgIGNsZWFyKCk7CiAg\nICAgICAgYWRkQ2xhc3NMb2FkZXJzKG11bHRpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFkZHMgYWxsIGNsYXNzIGxvYWRlcnMgZnJvbSB0aGUgZ2l2ZW4g\nbXVsdGkgbG9hZGVyIHN0YXJ0aW5nIGF0IHRoZQogICAgICogZ2l2ZW4gaW5k\nZXguCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIGFueSBsb2FkZXJz\nIHdlcmUgYWRkZWQsIGZhbHNlIGlmIGFsbCBhbHJlYWR5IGluIGxpc3QKICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gYWRkQ2xhc3NMb2FkZXJzKGludCBp\nbmRleCwgTXVsdGlDbGFzc0xvYWRlciBtdWx0aSkgewogICAgICAgIGlmICht\ndWx0aSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAg\nICAgIC8vIHVzZSBpdGVyYXRvciBzbyB0aGF0IHRoZSB0aHJlYWQgbG9hZGVy\nIGlzIG5vdCByZXNvbHZlZAogICAgICAgIGJvb2xlYW4gYWRkZWQgPSBmYWxz\nZTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG11bHRpLl9sb2FkZXJz\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGlm\nIChhZGRDbGFzc0xvYWRlcihpbmRleCwgKENsYXNzTG9hZGVyKSBpdHIubmV4\ndCgpKSkgewogICAgICAgICAgICAgICAgaW5kZXgrKzsKICAgICAgICAgICAg\nICAgIGFkZGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICByZXR1cm4gYWRkZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGRz\nIGFsbCB0aGUgY2xhc3MgbG9hZGVycyBmcm9tIHRoZSBnaXZlbiBtdWx0aSBs\nb2FkZXIuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIGFueSBsb2Fk\nZXJzIHdlcmUgYWRkZWQsIGZhbHNlIGlmIGFsbCBhbHJlYWR5IGluIGxpc3QK\nICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gYWRkQ2xhc3NMb2FkZXJzKE11\nbHRpQ2xhc3NMb2FkZXIgbXVsdGkpIHsKICAgICAgICBpZiAobXVsdGkgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyB1\nc2UgaXRlcmF0b3Igc28gdGhhdCB0aGUgdGhyZWFkIGxvYWRlciBpcyBub3Qg\ncmVzb2x2ZWQKICAgICAgICBib29sZWFuIGFkZGVkID0gZmFsc2U7CiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBtdWx0aS5fbG9hZGVycy5pdGVyYXRv\ncigpOyBpdHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgYWRkZWQgPSBhZGRD\nbGFzc0xvYWRlcigoQ2xhc3NMb2FkZXIpIGl0ci5uZXh0KCkpIHx8IGFkZGVk\nOwogICAgICAgIHJldHVybiBhZGRlZDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJlbW92ZSB0aGUgZ2l2ZW4gbG9hZGVyIGZyb20gdGhlIGxpc3QuCiAgICAg\nKgogICAgICogQHJldHVybiB0cnVlIGlmIHJlbW92ZWQsIGZhbHNlIGlmIG5v\ndCBpbiBsaXN0CiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUNs\nYXNzTG9hZGVyKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIHJldHVy\nbiBfbG9hZGVycy5yZW1vdmUobG9hZGVyKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENsZWFyIHRoZSBsaXN0IG9mIGNsYXNzIGxvYWRlcnMuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIGNsZWFyKCkgewogICAgICAgIF9sb2FkZXJzLmNs\nZWFyKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG51bWJl\nciBvZiBpbnRlcm5hbCBjbGFzcyBsb2FkZXJzLgogICAgICovCiAgICBwdWJs\naWMgaW50IHNpemUoKSB7CiAgICAgICAgcmV0dXJuIF9sb2FkZXJzLnNpemUo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZXJl\nIGFyZSBubyBpbnRlcm5hbCBjbGFzcyBsYW9kZXJzLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc0VtcHR5KCkgewogICAgICAgIHJldHVybiBfbG9h\nZGVycy5pc0VtcHR5KCk7CiAgICB9CgogICAgcHJvdGVjdGVkIENsYXNzIGZp\nbmRDbGFzcyhTdHJpbmcgbmFtZSkgdGhyb3dzIENsYXNzTm90Rm91bmRFeGNl\ncHRpb24gewogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcjsKICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IF9sb2FkZXJzLml0ZXJhdG9yKCk7IGl0ci5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGxvYWRlciA9IChDbGFzc0xvYWRl\ncikgaXRyLm5leHQoKTsKICAgICAgICAgICAgaWYgKGxvYWRlciA9PSBUSFJF\nQURfTE9BREVSKQogICAgICAgICAgICAgICAgbG9hZGVyID0gVGhyZWFkLmN1\ncnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKTsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBDbGFzcy5mb3JO\nYW1lKG5hbWUsIGZhbHNlLCBsb2FkZXIpOwogICAgICAgICAgICB9IGNhdGNo\nIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHRocm93IG5ldyBDbGFzc05vdEZvdW5kRXhjZXB0aW9uKG5hbWUpOwog\nICAgfQoKICAgIHByb3RlY3RlZCBVUkwgZmluZFJlc291cmNlKFN0cmluZyBu\nYW1lKSB7CiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyOwogICAgICAgIFVS\nTCByc3JjOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2xvYWRlcnMu\naXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgbG9h\nZGVyID0gKENsYXNzTG9hZGVyKSBpdHIubmV4dCgpOwogICAgICAgICAgICBp\nZiAobG9hZGVyID09IFRIUkVBRF9MT0FERVIpCiAgICAgICAgICAgICAgICBs\nb2FkZXIgPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFz\nc0xvYWRlcigpOwoKICAgICAgICAgICAgaWYgKGxvYWRlciA9PSBudWxsKSAv\nLyBza2lwIAogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAg\nICByc3JjID0gbG9hZGVyLmdldFJlc291cmNlKG5hbWUpOwogICAgICAgICAg\nICBpZiAocnNyYyAhPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIHJz\ncmM7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAg\nIHByb3RlY3RlZCBFbnVtZXJhdGlvbiBmaW5kUmVzb3VyY2VzKFN0cmluZyBu\nYW1lKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENsYXNzTG9hZGVy\nIGxvYWRlcjsKICAgICAgICBFbnVtZXJhdGlvbiByc3JjczsKICAgICAgICBP\nYmplY3QgcnNyYzsKICAgICAgICBWZWN0b3IgYWxsID0gbmV3IFZlY3Rvcigp\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2xvYWRlcnMuaXRlcmF0\nb3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgbG9hZGVyID0g\nKENsYXNzTG9hZGVyKSBpdHIubmV4dCgpOwogICAgICAgICAgICBpZiAobG9h\nZGVyID09IFRIUkVBRF9MT0FERVIpCiAgICAgICAgICAgICAgICBsb2FkZXIg\nPSBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRl\ncigpOwoKICAgICAgICAgICAgcnNyY3MgPSBsb2FkZXIuZ2V0UmVzb3VyY2Vz\nKG5hbWUpOwogICAgICAgICAgICB3aGlsZSAocnNyY3MuaGFzTW9yZUVsZW1l\nbnRzKCkpIHsKICAgICAgICAgICAgICAgIHJzcmMgPSByc3Jjcy5uZXh0RWxl\nbWVudCgpOwogICAgICAgICAgICAgICAgaWYgKCFhbGwuY29udGFpbnMocnNy\nYykpCiAgICAgICAgICAgICAgICAgICAgYWxsLmFkZEVsZW1lbnQocnNyYyk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFsbC5l\nbGVtZW50cygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhP\nYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykKICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIgaW5z\ndGFuY2VvZiBNdWx0aUNsYXNzTG9hZGVyKSkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgIHJldHVybiAoKE11bHRpQ2xhc3NMb2FkZXIpIG90\naGVyKS5fbG9hZGVycy5lcXVhbHMoX2xvYWRlcnMpOwogICAgfQoKICAgIHB1\nYmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAgcmV0dXJuIF9sb2FkZXJz\nLmhhc2hDb2RlKCk7CiAgICB9Cn0K\n","encoding":"base64"}

