{"sha":"f26148a0915e9ba2ac285fbdac187c34041e18ed","node_id":"MDQ6QmxvYjIwNjM2NDpmMjYxNDhhMDkxNWU5YmEyYWMyODVmYmRhYzE4N2MzNDA0MWUxOGVk","size":11201,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f26148a0915e9ba2ac285fbdac187c34041e18ed","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBqYXZh\nLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uOwppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9y\ndCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0\nOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5Qcm9w\nZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwoKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUmVmbGVjdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQXV0b0RldGFjaDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXJGYWN0b3J5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5EZWxlZ2F0aW5nQnJva2Vy\nRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGVs\nZWdhdGluZ0ZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlByb2R1Y3REZXJpdmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5WYWx1\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhj\nZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogSW1w\nbGVtZW50YXRpb24gb2Yge0BsaW5rIEVudGl0eU1hbmFnZXJGYWN0b3J5fSB0\naGF0IGFjdHMgYXMgYQogKiBmYWNhZGUgdG8gYSB7QGxpbmsgQnJva2VyRmFj\ndG9yeX0uCiAqCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBu\nb2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBFbnRpdHlNYW5hZ2VyRmFjdG9y\neUltcGwKICAgIGltcGxlbWVudHMgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0\nb3J5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xv\nYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEVudGl0eU1hbmFn\nZXJGYWN0b3J5SW1wbC5jbGFzcyk7CgogICAgcHJpdmF0ZSBEZWxlZ2F0aW5n\nQnJva2VyRmFjdG9yeSBfZmFjdG9yeSA9IG51bGw7CiAgICBwcml2YXRlIHRy\nYW5zaWVudCBDb25zdHJ1Y3RvcjxGZXRjaFBsYW4+IF9wbGFuID0gbnVsbDsK\nICAgIHByaXZhdGUgdHJhbnNpZW50IFN0b3JlQ2FjaGUgX2NhY2hlID0gbnVs\nbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IFF1ZXJ5UmVzdWx0Q2FjaGUgX3F1\nZXJ5Q2FjaGUgPSBudWxsOwoKICAgIC8qKgogICAgICogRGVmYXVsdCBjb25z\ndHJ1Y3RvciBwcm92aWRlZCBmb3IgYXV0by1pbnN0YW50aWF0aW9uLgogICAg\nICovCiAgICBwdWJsaWMgRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsKCkgewog\nICAgfQoKICAgIC8qKgogICAgICogU3VwcGx5IGRlbGVnYXRlIG9uIGNvbnN0\ncnVjdGlvbi4KICAgICAqLwogICAgcHVibGljIEVudGl0eU1hbmFnZXJGYWN0\nb3J5SW1wbChCcm9rZXJGYWN0b3J5IGZhY3RvcnkpIHsKICAgICAgICBzZXRC\ncm9rZXJGYWN0b3J5KGZhY3RvcnkpOwogICAgfQoKICAgIC8qKgogICAgICog\nRGVsZWdhdGUuCiAgICAgKi8KICAgIHB1YmxpYyBCcm9rZXJGYWN0b3J5IGdl\ndEJyb2tlckZhY3RvcnkoKSB7CiAgICAgICAgcmV0dXJuIF9mYWN0b3J5Lmdl\ndERlbGVnYXRlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxlZ2F0ZSBt\ndXN0IGJlIHByb3ZpZGVkIGJlZm9yZSB1c2UuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldEJyb2tlckZhY3RvcnkoQnJva2VyRmFjdG9yeSBmYWN0b3J5\nKSB7CiAgICAgICAgX2ZhY3RvcnkgPSBuZXcgRGVsZWdhdGluZ0Jyb2tlckZh\nY3RvcnkoZmFjdG9yeSwKICAgICAgICAgICAgUGVyc2lzdGVuY2VFeGNlcHRp\nb25zLlRSQU5TTEFUT1IpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVy\nbiBfZmFjdG9yeS5nZXRDb25maWd1cmF0aW9uKCk7CiAgICB9CgogICAgcHVi\nbGljIFByb3BlcnRpZXMgZ2V0UHJvcGVydGllcygpIHsKICAgICAgICByZXR1\ncm4gX2ZhY3RvcnkuZ2V0UHJvcGVydGllcygpOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgcHV0VXNlck9iamVjdChPYmplY3Qga2V5LCBPYmplY3QgdmFs\nKSB7CiAgICAgICAgcmV0dXJuIF9mYWN0b3J5LnB1dFVzZXJPYmplY3Qoa2V5\nLCB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0VXNlck9iamVj\ndChPYmplY3Qga2V5KSB7CiAgICAgICAgcmV0dXJuIF9mYWN0b3J5LmdldFVz\nZXJPYmplY3Qoa2V5KTsKICAgIH0KCiAgICBwdWJsaWMgU3RvcmVDYWNoZSBn\nZXRTdG9yZUNhY2hlKCkgewogICAgICAgIF9mYWN0b3J5LmxvY2soKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBpZiAoX2NhY2hlID09IG51bGwpIHsK\nICAgICAgICAgICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBf\nZmFjdG9yeS5nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgICAgICBf\nY2FjaGUgPSBuZXcgU3RvcmVDYWNoZUltcGwodGhpcywKICAgICAgICAgICAg\nICAgICAgICBjb25mLmdldERhdGFDYWNoZU1hbmFnZXJJbnN0YW5jZSgpLmdl\ndFN5c3RlbURhdGFDYWNoZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gX2NhY2hlOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIF9mYWN0b3J5LnVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgU3RvcmVDYWNoZSBnZXRTdG9yZUNhY2hlKFN0cmluZyBjYWNoZU5h\nbWUpIHsKICAgICAgICByZXR1cm4gbmV3IFN0b3JlQ2FjaGVJbXBsKHRoaXMs\nIF9mYWN0b3J5LmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0\nRGF0YUNhY2hlTWFuYWdlckluc3RhbmNlKCkuZ2V0RGF0YUNhY2hlKGNhY2hl\nTmFtZSkpOwogICAgfQoKICAgIHB1YmxpYyBRdWVyeVJlc3VsdENhY2hlIGdl\ndFF1ZXJ5UmVzdWx0Q2FjaGUoKSB7CiAgICAgICAgX2ZhY3RvcnkubG9jaygp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChfcXVlcnlDYWNoZSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgX3F1ZXJ5Q2FjaGUgPSBuZXcgUXVl\ncnlSZXN1bHRDYWNoZUltcGwoX2ZhY3RvcnkuCiAgICAgICAgICAgICAgICAg\nICAgZ2V0Q29uZmlndXJhdGlvbigpLmdldERhdGFDYWNoZU1hbmFnZXJJbnN0\nYW5jZSgpLgogICAgICAgICAgICAgICAgICAgIGdldFN5c3RlbVF1ZXJ5Q2Fj\naGUoKSk7CiAgICAgICAgICAgIHJldHVybiBfcXVlcnlDYWNoZTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICBfZmFjdG9yeS51bmxvY2soKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIGNyZWF0ZUVudGl0eU1hbmFnZXIoKSB7CiAgICAgICAgcmV0dXJuIGNy\nZWF0ZUVudGl0eU1hbmFnZXIobnVsbCk7CiAgICB9CgogICAgcHVibGljIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIGNyZWF0ZUVudGl0eU1hbmFnZXIoTWFwIHBy\nb3BzKSB7CiAgICAgICAgaWYgKHByb3BzID09IG51bGwpCiAgICAgICAgICAg\nIHByb3BzID0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQOwogICAgICAgIGVsc2Ug\naWYgKCFwcm9wcy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHByb3BzID0gbmV3\nIEhhc2hNYXAocHJvcHMpOwoKICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlv\nbiBjb25mID0gZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIFN0cmluZyB1\nc2VyID0gKFN0cmluZykgQ29uZmlndXJhdGlvbnMucmVtb3ZlUHJvcGVydHkK\nICAgICAgICAgICAgKCJDb25uZWN0aW9uVXNlck5hbWUiLCBwcm9wcyk7CiAg\nICAgICAgaWYgKHVzZXIgPT0gbnVsbCkKICAgICAgICAgICAgdXNlciA9IGNv\nbmYuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCk7CiAgICAgICAgU3RyaW5nIHBh\nc3MgPSAoU3RyaW5nKSBDb25maWd1cmF0aW9ucy5yZW1vdmVQcm9wZXJ0eQog\nICAgICAgICAgICAoIkNvbm5lY3Rpb25QYXNzd29yZCIsIHByb3BzKTsKICAg\nICAgICBpZiAocGFzcyA9PSBudWxsKQogICAgICAgICAgICBwYXNzID0gY29u\nZi5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKTsKCiAgICAgICAgU3RyaW5nIHN0\nciA9IChTdHJpbmcpIENvbmZpZ3VyYXRpb25zLnJlbW92ZVByb3BlcnR5CiAg\nICAgICAgICAgICgiVHJhbnNhY3Rpb25Nb2RlIiwgcHJvcHMpOwogICAgICAg\nIGJvb2xlYW4gbWFuYWdlZDsKICAgICAgICBpZiAoc3RyID09IG51bGwpCiAg\nICAgICAgICAgIG1hbmFnZWQgPSBjb25mLmlzVHJhbnNhY3Rpb25Nb2RlTWFu\nYWdlZCgpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBWYWx1ZSB2YWwg\nPSBjb25mLmdldFZhbHVlKCJUcmFuc2FjdGlvbk1vZGUiKTsKICAgICAgICAg\nICAgbWFuYWdlZCA9IEJvb2xlYW4ucGFyc2VCb29sZWFuKHZhbC51bmFsaWFz\nKHN0cikpOwogICAgICAgIH0KCiAgICAgICAgT2JqZWN0IG9iaiA9IENvbmZp\nZ3VyYXRpb25zLnJlbW92ZVByb3BlcnR5KCJDb25uZWN0aW9uUmV0YWluTW9k\nZSIsIAogICAgICAgICAgICBwcm9wcyk7CiAgICAgICAgaW50IHJldGFpbk1v\nZGU7CiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIE51bWJlcikKICAgICAg\nICAgICAgcmV0YWluTW9kZSA9ICgoTnVtYmVyKSBvYmopLmludFZhbHVlKCk7\nCiAgICAgICAgZWxzZSBpZiAob2JqID09IG51bGwpCiAgICAgICAgICAgIHJl\ndGFpbk1vZGUgPSBjb25mLmdldENvbm5lY3Rpb25SZXRhaW5Nb2RlQ29uc3Rh\nbnQoKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgVmFsdWUgdmFsID0g\nY29uZi5nZXRWYWx1ZSgiQ29ubmVjdGlvblJldGFpbk1vZGUiKTsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldGFpbk1vZGUgPSBJbnRl\nZ2VyLnBhcnNlSW50KHZhbC51bmFsaWFzKChTdHJpbmcpIG9iaikpOwogICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQt\nZW0tcHJvcCIsCiAgICAgICAgICAgICAgICAgICAgIm9wZW5qcGEuQ29ubmVj\ndGlvblJldGFpbk1vZGUiLCBvYmopLAogICAgICAgICAgICAgICAgICAgIG5l\ndyBUaHJvd2FibGVbXXsgZSB9LCBvYmosIHRydWUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBCcm9rZXIgYnJva2VyID0gX2ZhY3Rvcnku\nbmV3QnJva2VyKHVzZXIsIHBhc3MsIG1hbmFnZWQsIHJldGFpbk1vZGUsCiAg\nICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgCiAgICAgICAgLy8gYWRk\nIGF1dG9kZXRhY2ggZm9yIGNsb3NlIGFuZCByb2xsYmFjayBjb25kaXRpb25z\nIHRvIHRoZSBjb25maWd1cmF0aW9uCiAgICAgICAgYnJva2VyLnNldEF1dG9E\nZXRhY2goQXV0b0RldGFjaC5ERVRBQ0hfQ0xPU0UsIHRydWUpOwogICAgICAg\nIGJyb2tlci5zZXRBdXRvRGV0YWNoKEF1dG9EZXRhY2guREVUQUNIX1JPTExC\nQUNLLCB0cnVlKTsKICAgICAgICAKICAgICAgICBicm9rZXIuc2V0RGV0YWNo\nZWROZXcoZmFsc2UpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVt\nID0gbmV3RW50aXR5TWFuYWdlckltcGwoYnJva2VyKTsKCiAgICAgICAgLy8g\nYWxsb3cgc2V0dGluZyBvZiBvdGhlciBiZWFuIHByb3BlcnRpZXMgb2YgRU0K\nICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFByb2R1Y3REZXJpdmF0aW9u\ncy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsKICAgICAgICBMaXN0PFJ1\nbnRpbWVFeGNlcHRpb24+IGVycnMgPSBudWxsOwogICAgICAgIE1ldGhvZCBz\nZXR0ZXIgPSBudWxsOwogICAgICAgIFN0cmluZyBwcm9wLCBwcmVmaXg7CiAg\nICAgICAgT2JqZWN0IHZhbDsKICAgICAgICBmb3IgKE1hcC5FbnRyeSBlbnRy\neSA6IChTZXQ8TWFwLkVudHJ5PikgcHJvcHMuZW50cnlTZXQoKSkgewogICAg\nICAgICAgICBwcm9wID0gKFN0cmluZykgZW50cnkuZ2V0S2V5KCk7CiAgICAg\nICAgICAgIHByZWZpeCA9IG51bGw7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgIHByZWZpeCA9IHByZWZpeGVzW2ldICsgIi4iOwogICAgICAgICAgICAg\nICAgaWYgKHByb3Auc3RhcnRzV2l0aChwcmVmaXgpKQogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgcHJlZml4ID0gbnVsbDsg\nCiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIGlmIChwcmVmaXggPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAKICAgICAgICAgICAgcHJv\ncCA9IHByb3Auc3Vic3RyaW5nKHByZWZpeC5sZW5ndGgoKSk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzZXR0ZXIgPSBSZWZsZWN0aW9u\nLmZpbmRTZXR0ZXIoZW0uZ2V0Q2xhc3MoKSwgcHJvcCwgdHJ1ZSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAg\nICAgICAgICAgIGlmIChlcnJzID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgZXJycyA9IG5ldyBMaW5rZWRMaXN0PFJ1bnRpbWVFeGNlcHRpb24+KCk7\nCiAgICAgICAgICAgICAgICBlcnJzLmFkZChQZXJzaXN0ZW5jZUV4Y2VwdGlv\nbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihrZSkpOwogICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhbCA9\nIGVudHJ5LmdldFZhbHVlKCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKCJudWxsIi5lcXVhbHModmFsKSkKICAgICAgICAg\nICAgICAgICAgICAgICAgdmFsID0gbnVsbDsKICAgICAgICAgICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IFN0cmluZ3Mu\ncGFyc2UoKFN0cmluZykgdmFsLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgc2V0dGVyLmdldFBhcmFtZXRlclR5cGVzKClbMF0pOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgUmVmbGVjdGlvbi5zZXQoZW0sIHNl\ndHRlciwgdmFsKTsKICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQp\nIHsKICAgICAgICAgICAgICAgIHdoaWxlICh0LmdldENhdXNlKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICB0ID0gdC5nZXRDYXVzZSgpOwogICAg\nICAgICAgICAgICAgQXJndW1lbnRFeGNlcHRpb24gZXJyID0gbmV3IEFyZ3Vt\nZW50RXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAgKCJi\nYWQtZW0tcHJvcCIsIHByb3AsIGVudHJ5LmdldFZhbHVlKCkpLAogICAgICAg\nICAgICAgICAgICAgIG5ldyBUaHJvd2FibGVbXXsgdCB9LCBudWxsLCB0cnVl\nKTsKICAgICAgICAgICAgICAgIGlmIChlcnJzID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgZXJycyA9IG5ldyBMaW5rZWRMaXN0PFJ1bnRpbWVFeGNl\ncHRpb24+KCk7CiAgICAgICAgICAgICAgICBlcnJzLmFkZChlcnIpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZXJycyAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAgIGlmIChl\ncnJzLnNpemUoKSA9PSAxKQogICAgICAgICAgICAgICAgdGhyb3cgZXJycy5n\nZXQoMCk7CiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLWVtLXByb3BzIiksCiAgICAgICAgICAgICAgICAo\nVGhyb3dhYmxlW10pIGVycnMudG9BcnJheShuZXcgVGhyb3dhYmxlW2VycnMu\nc2l6ZSgpXSksCiAgICAgICAgICAgICAgICBudWxsLCB0cnVlKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGVtOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgbmV3IGVudGl0eSBtYW5hZ2VyIGFyb3VuZCB0aGUgZ2l2ZW4g\nYnJva2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQgRW50aXR5TWFuYWdlcklt\ncGwgbmV3RW50aXR5TWFuYWdlckltcGwoQnJva2VyIGJyb2tlcikgewogICAg\nICAgIHJldHVybiBuZXcgRW50aXR5TWFuYWdlckltcGwodGhpcywgYnJva2Vy\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRMaWZlY3ljbGVMaXN0ZW5l\ncihPYmplY3QgbGlzdGVuZXIsIENsYXNzLi4uIGNsYXNzZXMpIHsKICAgICAg\nICBfZmFjdG9yeS5hZGRMaWZlY3ljbGVMaXN0ZW5lcihsaXN0ZW5lciwgY2xh\nc3Nlcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlTGlmZWN5Y2xl\nTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgX2ZhY3Rvcnku\ncmVtb3ZlTGlmZWN5Y2xlTGlzdGVuZXIobGlzdGVuZXIpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgIF9mYWN0b3J5LmNsb3Nl\nKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNPcGVuKCkgewogICAg\nICAgIHJldHVybiAhX2ZhY3RvcnkuaXNDbG9zZWQoKTsKICAgIH0KCiAgICBw\ndWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAgIHJldHVybiBfZmFjdG9y\neS5oYXNoQ29kZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVxdWFs\ncyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIg\naW5zdGFuY2VvZiBFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwpKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIF9mYWN0b3J5LmVx\ndWFscygoKEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCkgb3RoZXIpLl9mYWN0\nb3J5KTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIHN0b3JlLXNw\nZWNpZmljIGZhY2FkZSBmb3IgdGhlIGdpdmVuIGZldGNoIGNvbmZpZ3VyYXRp\nb24uCgkgKiBJZiBubyBmYWNhZGUgY2xhc3MgZXhpc3RzLCB3ZSB1c2UgdGhl\nIGRlZmF1bHQge0BsaW5rIEZldGNoUGxhbn0uCiAgICAgKi8KICAgIEZldGNo\nUGxhbiB0b0ZldGNoUGxhbihCcm9rZXIgYnJva2VyLCBGZXRjaENvbmZpZ3Vy\nYXRpb24gZmV0Y2gpIHsKICAgICAgICBpZiAoZmV0Y2ggPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIEZldGNoQ29uZmlndXJh\ndGlvbiBpbm5lciA9IGZldGNoOwogICAgICAgIGlmIChpbm5lciBpbnN0YW5j\nZW9mIERlbGVnYXRpbmdGZXRjaENvbmZpZ3VyYXRpb24pCiAgICAgICAgICAg\nIGlubmVyID0gKChEZWxlZ2F0aW5nRmV0Y2hDb25maWd1cmF0aW9uKSBpbm5l\ncikuCiAgICAgICAgICAgICAgICBnZXRJbm5lcm1vc3REZWxlZ2F0ZSgpOwoK\nICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoX3BsYW4gPT0gbnVsbCkg\newogICAgICAgICAgICAgICAgQ2xhc3Mgc3RvcmVUeXBlID0gKGJyb2tlciA9\nPSBudWxsKSA/IG51bGwgOiBicm9rZXIuCiAgICAgICAgICAgICAgICAgICAg\nZ2V0U3RvcmVNYW5hZ2VyKCkuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKS5nZXRD\nbGFzcygpOwogICAgICAgICAgICAgICAgQ2xhc3MgY2xzID0gX2ZhY3Rvcnku\nZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAgICAgICAgICAgIGdldFN0\nb3JlRmFjYWRlVHlwZVJlZ2lzdHJ5KCkuCiAgICAgICAgICAgICAgICAgICAg\nZ2V0SW1wbGVtZW50YXRpb24oRmV0Y2hQbGFuLmNsYXNzLCBzdG9yZVR5cGUs\nIAogICAgICAgICAgICAgICAgICAgIAkJRmV0Y2hQbGFuSW1wbC5jbGFzcyk7\nCiAgICAgICAgICAgICAgICBfcGxhbiA9IGNscy5nZXRDb25zdHJ1Y3RvcihG\nZXRjaENvbmZpZ3VyYXRpb24uY2xhc3MpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHJldHVybiBfcGxhbi5uZXdJbnN0YW5jZShmZXRjaCk7CiAgICAg\nICAgfSBjYXRjaCAoSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbiBpdGUpIHsK\nICAgICAgICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVy\nc2lzdGVuY2VFeGNlcHRpb24KICAgICAgICAgICAgICAgIChpdGUuZ2V0VGFy\nZ2V0RXhjZXB0aW9uKCkpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIHRocm93IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50\nb1BlcnNpc3RlbmNlRXhjZXB0aW9uKGUpOwogICAgICAgIH0KCX0KfQo=\n","encoding":"base64"}

