{"sha":"9216330719e0648b455e8661807c5dd5a3d660f3","node_id":"MDQ6QmxvYjIwNjM2NDo5MjE2MzMwNzE5ZTA2NDhiNDU1ZTg2NjE4MDdjNWRkNWEzZDY2MGYz","size":10729,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9216330719e0648b455e8661807c5dd5a3d660f3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLmxhbmcuYW5u\nb3RhdGlvbi5Bbm5vdGF0aW9uOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQW5ub3RhdGVkRWxlbWVudDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkZp\nZWxkOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWVtYmVyOwppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5CYXNpYzsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVtYmVkZGFibGU7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbWJlZGRlZDsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkVtYmVkZGVkSWQ7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5NYW55VG9NYW55OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nTWFueVRvT25lOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuT25lVG9NYW55\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuT25lVG9PbmU7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5Qb3N0TG9hZDsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlBvc3RQZXJzaXN0OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nUG9zdFJlbW92ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlBvc3RVcGRh\ndGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QcmVQZXJzaXN0OwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuUHJlUmVtb3ZlOwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuUHJlVXBkYXRlOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuVHJhbnNpZW50OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5n\nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkFic3RyYWN0TWV0YURhdGFEZWZhdWx0czsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuVmFsdWVNZXRhRGF0YTsKaW1wb3J0IHN0YXRpYyBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2VTdHJhdGVn\neS4qOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFF\neGNlcHRpb247CgovKioKICogSlBBLWJhc2VkIG1ldGFkYXRhIGRlZmF1bHRz\nLgogKgogKiBAYXV0aG9yIFBhdHJpY2sgTGluc2tleQogKiBAYXV0aG9yIEFi\nZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNlTWV0YURhdGFE\nZWZhdWx0cwogICAgZXh0ZW5kcyBBYnN0cmFjdE1ldGFEYXRhRGVmYXVsdHMg\newoKICAgIHByaXZhdGUgYm9vbGVhbiBfYWxsb3dzTXVsdGlwbGVNZXRob2Rz\nRm9yU2FtZUNhbGxiYWNrID0gZmFsc2U7CgogICAgcHJpdmF0ZSBzdGF0aWMg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAg\nIChQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuY2xhc3MpOwoKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIE1hcDxDbGFzcywgUGVyc2lzdGVuY2VTdHJh\ndGVneT4gX3N0cmF0cyA9CiAgICAgICAgbmV3IEhhc2hNYXA8Q2xhc3MsIFBl\ncnNpc3RlbmNlU3RyYXRlZ3k+KCk7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBTZXQ8U3RyaW5nPiBfaWdub3JlZEFubm9zID0gbmV3IEhhc2hTZXQ8U3Ry\naW5nPigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgX3N0cmF0cy5wdXQoQmFz\naWMuY2xhc3MsIEJBU0lDKTsKICAgICAgICBfc3RyYXRzLnB1dChNYW55VG9P\nbmUuY2xhc3MsIE1BTllfT05FKTsKICAgICAgICBfc3RyYXRzLnB1dChPbmVU\nb09uZS5jbGFzcywgT05FX09ORSk7CiAgICAgICAgX3N0cmF0cy5wdXQoRW1i\nZWRkZWQuY2xhc3MsIEVNQkVEREVEKTsKICAgICAgICBfc3RyYXRzLnB1dChF\nbWJlZGRlZElkLmNsYXNzLCBFTUJFRERFRCk7CiAgICAgICAgX3N0cmF0cy5w\ndXQoT25lVG9NYW55LmNsYXNzLCBPTkVfTUFOWSk7CiAgICAgICAgX3N0cmF0\ncy5wdXQoTWFueVRvTWFueS5jbGFzcywgTUFOWV9NQU5ZKTsKICAgICAgICBf\nc3RyYXRzLnB1dChQZXJzaXN0ZW50LmNsYXNzLCBQRVJTKTsKICAgICAgICBf\nc3RyYXRzLnB1dChQZXJzaXN0ZW50Q29sbGVjdGlvbi5jbGFzcywgUEVSU19D\nT0xMKTsKICAgICAgICBfc3RyYXRzLnB1dChQZXJzaXN0ZW50TWFwLmNsYXNz\nLCBQRVJTX01BUCk7CgogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKERldGFj\naGVkU3RhdGUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFu\nbm9zLmFkZChQb3N0TG9hZC5jbGFzcy5nZXROYW1lKCkpOwogICAgICAgIF9p\nZ25vcmVkQW5ub3MuYWRkKFBvc3RQZXJzaXN0LmNsYXNzLmdldE5hbWUoKSk7\nCiAgICAgICAgX2lnbm9yZWRBbm5vcy5hZGQoUG9zdFJlbW92ZS5jbGFzcy5n\nZXROYW1lKCkpOwogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFBvc3RVcGRh\ndGUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9zLmFk\nZChQcmVQZXJzaXN0LmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgX2lnbm9y\nZWRBbm5vcy5hZGQoUHJlUmVtb3ZlLmNsYXNzLmdldE5hbWUoKSk7CiAgICAg\nICAgX2lnbm9yZWRBbm5vcy5hZGQoUHJlVXBkYXRlLmNsYXNzLmdldE5hbWUo\nKSk7CiAgICB9CgogICAgcHVibGljIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZh\ndWx0cygpIHsKICAgICAgICBzZXRDYWxsYmFja01vZGUoQ0FMTEJBQ0tfUkVU\nSFJPVyB8IENBTExCQUNLX1JPTExCQUNLIHwKICAgICAgICAgICAgQ0FMTEJB\nQ0tfRkFJTF9GQVNUKTsKICAgICAgICBzZXREYXRhU3RvcmVPYmplY3RJZEZp\nZWxkVW53cmFwcGVkKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBjb2RlIGZvciB0aGUgc3RyYXRlZ3kgb2YgdGhlIGdpdmVuIG1l\nbWJlci4gUmV0dXJuIG51bGwgaWYKICAgICAqIG5vIHN0cmF0ZWd5LgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIFBlcnNpc3RlbmNlU3RyYXRlZ3kgZ2V0\nUGVyc2lzdGVuY2VTdHJhdGVneQogICAgICAgIChGaWVsZE1ldGFEYXRhIGZt\nZCwgTWVtYmVyIG1lbWJlcikgewogICAgICAgIGlmIChtZW1iZXIgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgQW5ub3RhdGVk\nRWxlbWVudCBlbCA9IChBbm5vdGF0ZWRFbGVtZW50KSBtZW1iZXI7CiAgICAg\nICAgaWYgKGVsLmlzQW5ub3RhdGlvblByZXNlbnQoVHJhbnNpZW50LmNsYXNz\nKSkKICAgICAgICAgICAgcmV0dXJuIFRSQU5TSUVOVDsKICAgICAgICBpZiAo\nZm1kICE9IG51bGwKICAgICAgICAgICAgJiYgZm1kLmdldE1hbmFnZW1lbnQo\nKSAhPSBGaWVsZE1ldGFEYXRhLk1BTkFHRV9QRVJTSVNURU5UKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8gbG9vayBmb3IgcGVyc2lz\ndGVuY2Ugc3RyYXRlZ3kgaW4gYW5ub3RhdGlvbiB0YWJsZQogICAgICAgIFBl\ncnNpc3RlbmNlU3RyYXRlZ3kgcHN0cmF0ID0gbnVsbDsKICAgICAgICBmb3Ig\nKEFubm90YXRpb24gYW5ubyA6IGVsLmdldERlY2xhcmVkQW5ub3RhdGlvbnMo\nKSkgewogICAgICAgICAgICBpZiAocHN0cmF0ICE9IG51bGwgJiYgX3N0cmF0\ncy5jb250YWluc0tleShhbm5vLmFubm90YXRpb25UeXBlKCkpKQogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJhbHJlYWR5LXBlcnMiLCBtZW1iZXIpKTsKICAgICAgICAgICAgaWYgKHBz\ndHJhdCA9PSBudWxsKQogICAgICAgICAgICAgICAgcHN0cmF0ID0gX3N0cmF0\ncy5nZXQoYW5uby5hbm5vdGF0aW9uVHlwZSgpKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKHBzdHJhdCAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gcHN0\ncmF0OwoKICAgICAgICBDbGFzcyB0eXBlOwogICAgICAgIGludCBjb2RlOwog\nICAgICAgIGlmIChmbWQgIT0gbnVsbCkgewogICAgICAgICAgICB0eXBlID0g\nZm1kLmdldFR5cGUoKTsKICAgICAgICAgICAgY29kZSA9IGZtZC5nZXRUeXBl\nQ29kZSgpOwogICAgICAgIH0gZWxzZSBpZiAobWVtYmVyIGluc3RhbmNlb2Yg\nRmllbGQpIHsKICAgICAgICAgICAgdHlwZSA9ICgoRmllbGQpIG1lbWJlciku\nZ2V0VHlwZSgpOwogICAgICAgICAgICBjb2RlID0gSmF2YVR5cGVzLmdldFR5\ncGVDb2RlKHR5cGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHR5\ncGUgPSAoKE1ldGhvZCkgbWVtYmVyKS5nZXRSZXR1cm5UeXBlKCk7CiAgICAg\nICAgICAgIGNvZGUgPSBKYXZhVHlwZXMuZ2V0VHlwZUNvZGUodHlwZSk7CiAg\nICAgICAgfQoKICAgICAgICBzd2l0Y2ggKGNvZGUpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAgICBpZiAodHlw\nZSA9PSBieXRlW10uY2xhc3MKICAgICAgICAgICAgICAgICAgICB8fCB0eXBl\nID09IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAgICAgICAgIHx8IHR5cGUg\nPT0gQnl0ZVtdLmNsYXNzCiAgICAgICAgICAgICAgICAgICAgfHwgdHlwZSA9\nPSBDaGFyYWN0ZXJbXS5jbGFzcykKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gQkFTSUM7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQk9PTEVBTjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuQk9PTEVBTl9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkJZVEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuRE9VQkxFOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VC\nTEVfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5GTE9BVDoKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVRfT0JKOgogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLklOVF9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkdfT0JKOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5TVFJJTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0RFQ0lN\nQUw6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0lOVEVHRVI6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRBVEU6CiAgICAgICAgICAgICAg\nICByZXR1cm4gQkFTSUM7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9C\nSkVDVDoKICAgICAgICAgICAgICAgIGlmIChFbnVtLmNsYXNzLmlzQXNzaWdu\nYWJsZUZyb20odHlwZSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEJB\nU0lDOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAg\nICAvLyMjIyBFSkIzOiB3aGF0IGlmIGRlZmluZWQgaW4gWE1MPwogICAgICAg\nIGlmICh0eXBlLmlzQW5ub3RhdGlvblByZXNlbnQoRW1iZWRkYWJsZS5jbGFz\ncykpCiAgICAgICAgICAgIHJldHVybiBFTUJFRERFRDsKICAgICAgICBpZiAo\nU2VyaWFsaXphYmxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAg\nICAgICAgICAgIHJldHVybiBCQVNJQzsKICAgICAgICByZXR1cm4gbnVsbDsK\nICAgIH0KICAgIAogICAgLyoqIAogICAgICogRmxhZ3MgaWYgbXVsdGlwbGUg\nbWV0aG9kcyBvZiB0aGUgc2FtZSBjbGFzcyBjYW4gaGFuZGxlIHRoZSBzYW1l\nIAogICAgICogY2FsbGJhY2sgZXZlbnQuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGdldEFsbG93c011bHRpcGxlTWV0aG9kc0ZvclNhbWVDYWxsYmFj\naygpIHsKICAgICAgICByZXR1cm4gX2FsbG93c011bHRpcGxlTWV0aG9kc0Zv\nclNhbWVDYWxsYmFjazsKICAgIH0KICAgIAogICAgLyoqIAogICAgICogRmxh\nZ3MgaWYgbXVsdGlwbGUgbWV0aG9kcyBvZiB0aGUgc2FtZSBjbGFzcyBjYW4g\naGFuZGxlIHRoZSBzYW1lIAogICAgICogY2FsbGJhY2sgZXZlbnQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEFsbG93c011bHRpcGxlTWV0aG9kc0Zv\nclNhbWVDYWxsYmFjayhib29sZWFuIGZsYWcpIHsKICAgICAgICBfYWxsb3dz\nTXVsdGlwbGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrID0gZmxhZzsKICAgIH0K\nCiAgICAvKioKICAgICAqIEF1dG8tY29uZmlndXJhdGlvbiBtZXRob2QgZm9y\nIHRoZSBkZWZhdWx0IGFjY2VzcyB0eXBlIG9mIGJhc2UgY2xhc3NlcyAKICAg\nICAqIHdpdGggQUNDRVNTX1VOS05PV04KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0RGVmYXVsdEFjY2Vzc1R5cGUoU3RyaW5nIHR5cGUpIHsKICAgICAg\nICBpZiAodHlwZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgaWYgKCJQUk9QRVJUWSIuZXF1YWxzKHR5cGUudG9VcHBlckNhc2UoKSkp\nCiAgICAgICAgICAgIHNldERlZmF1bHRBY2Nlc3NUeXBlKENsYXNzTWV0YURh\ndGEuQUNDRVNTX1BST1BFUlRZKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIHNldERlZmF1bHRBY2Nlc3NUeXBlKENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJ\nRUxEKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHBv\ncHVsYXRlKENsYXNzTWV0YURhdGEgbWV0YSwgaW50IGFjY2VzcykgewogICAg\nICAgIHN1cGVyLnBvcHVsYXRlKG1ldGEsIGFjY2Vzcyk7CiAgICAgICAgbWV0\nYS5zZXREZXRhY2hhYmxlKHRydWUpOwogICAgICAgIC8vIGRvIG5vdCBjYWxs\nIGdldCpGaWVsZHMgYXMgaXQgd2lsbCBsb2NrIGRvd24gdGhlIGZpZWxkcy4K\nICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHBvcHVs\nYXRlKEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgc2V0Q2FzY2FkZU5v\nbmUoZm1kKTsKICAgICAgICBzZXRDYXNjYWRlTm9uZShmbWQuZ2V0S2V5KCkp\nOwogICAgICAgIHNldENhc2NhZGVOb25lKGZtZC5nZXRFbGVtZW50KCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogVHVybnMgb2ZmIGF1dG8gY2FzY2FkaW5n\nIG9mIHBlcnNpc3QsIHJlZnJlc2gsIGF0dGFjaC4KICAgICAqLwogICAgc3Rh\ndGljIHZvaWQgc2V0Q2FzY2FkZU5vbmUoVmFsdWVNZXRhRGF0YSB2bWQpIHsK\nICAgICAgICB2bWQuc2V0Q2FzY2FkZVBlcnNpc3QoVmFsdWVNZXRhRGF0YS5D\nQVNDQURFX05PTkUpOwogICAgICAgIHZtZC5zZXRDYXNjYWRlUmVmcmVzaChW\nYWx1ZU1ldGFEYXRhLkNBU0NBREVfTk9ORSk7CiAgICAgICAgdm1kLnNldENh\nc2NhZGVBdHRhY2goVmFsdWVNZXRhRGF0YS5DQVNDQURFX05PTkUpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGludCBnZXRBY2Nlc3NU\neXBlKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBnZXRB\nY2Nlc3NUeXBlKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJlY3Vyc2l2ZSBoZWxwZXIgdG8gZGV0ZXJtaW5lIGFj\nY2VzcyB0eXBlIGJhc2VkIG9uIGFubm90YXRpb24gcGxhY2VtZW50LgogICAg\nICovCiAgICBwcml2YXRlIGludCBnZXRBY2Nlc3NUeXBlKENsYXNzIGNscykg\newogICAgICAgIC8vIHRyYXZlcnNlZCBlbnRpcmUgaGllcmFyY2h5IHdpdGhv\ndXQgZmluZGluZyBhbm5vdGF0aW9ucwogICAgICAgIGlmIChjbHMgPT0gbnVs\nbCB8fCBjbHMgPT0gT2JqZWN0LmNsYXNzKQogICAgICAgICAgICByZXR1cm4g\nQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfVU5LTk9XTjsKCiAgICAgICAgaW50IGFj\nY2VzcyA9IDA7CiAgICAgICAgaWYgKHVzZXNBY2Nlc3MoY2xzLmdldERlY2xh\ncmVkRmllbGRzKCkpKQogICAgICAgICAgICBhY2Nlc3MgfD0gQ2xhc3NNZXRh\nRGF0YS5BQ0NFU1NfRklFTEQ7CiAgICAgICAgaWYgKHVzZXNBY2Nlc3MoY2xz\nLmdldERlY2xhcmVkTWV0aG9kcygpKSkKICAgICAgICAgICAgYWNjZXNzIHw9\nIENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZOwogICAgICAgIHJldHVy\nbiAoYWNjZXNzID09IDApID8gZ2V0QWNjZXNzVHlwZShjbHMuZ2V0U3VwZXJj\nbGFzcygpKSA6IGFjY2VzczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB3aGV0aGVyIHRoZSBnaXZlbiBtZW1iZXJzIGhhdmUgcGVyc2lzdGVuY2Ug\nYW5ub3RhdGlvbnMuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xl\nYW4gdXNlc0FjY2VzcyhBbm5vdGF0ZWRFbGVtZW50W10gbWVtYmVycykgewog\nICAgICAgIEFubm90YXRpb25bXSBhbm5vczsKICAgICAgICBTdHJpbmcgbmFt\nZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1lbWJlcnMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgYW5ub3MgPSBtZW1iZXJzW2ldLmdldEFu\nbm90YXRpb25zKCk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwg\nYW5ub3MubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIG5hbWUgPSBh\nbm5vc1tqXS5hbm5vdGF0aW9uVHlwZSgpLmdldE5hbWUoKTsKICAgICAgICAg\nICAgICAgIGlmICgobmFtZS5zdGFydHNXaXRoKCJqYXZheC5wZXJzaXN0ZW5j\nZS4iKQogICAgICAgICAgICAgICAgICAgIHx8IG5hbWUuc3RhcnRzV2l0aCgi\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLiIpKQogICAgICAgICAg\nICAgICAgICAgICYmICFfaWdub3JlZEFubm9zLmNvbnRhaW5zKG5hbWUpKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBpc0RlZmF1bHRQZXJzaXN0ZW50KENsYXNzTWV0\nYURhdGEgbWV0YSwgTWVtYmVyIG1lbWJlciwKICAgICAgICBTdHJpbmcgbmFt\nZSkgewogICAgICAgIGludCBtb2RzID0gbWVtYmVyLmdldE1vZGlmaWVycygp\nOwogICAgICAgIGlmIChNb2RpZmllci5pc1RyYW5zaWVudChtb2RzKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAobWVtYmVyIGlu\nc3RhbmNlb2YgTWV0aG9kKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAvLyBjaGVjayBmb3Igc2V0dGVycyBmb3IgbWV0aG9kcwogICAg\nICAgICAgICAgICAgTWV0aG9kIHNldHRlciA9IG1ldGEuZ2V0RGVzY3JpYmVk\nVHlwZSgpLmdldERlY2xhcmVkTWV0aG9kKCJzZXQiCiAgICAgICAgICAgICAg\nICAgICAgKyBTdHJpbmdVdGlscy5jYXBpdGFsaXplKG5hbWUpLCBuZXcgQ2xh\nc3NbXSB7IAogICAgICAgICAgICAgICAgICAgICgoTWV0aG9kKSBtZW1iZXIp\nLmdldFJldHVyblR5cGUoKSB9KTsKICAgICAgICAgICAgICAgIGlmIChzZXR0\nZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICAvLyBlLmcuLCBOb1N1Y2hNZXRob2RFeGNlcHRpb24KICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdCA9IGdldFBl\ncnNpc3RlbmNlU3RyYXRlZ3kobnVsbCwgbWVtYmVyKTsKICAgICAgICBpZiAo\nc3RyYXQgPT0gbnVsbCB8fCBzdHJhdCA9PSBQZXJzaXN0ZW5jZVN0cmF0ZWd5\nLlRSQU5TSUVOVCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiB0cnVlOwoJfQp9Cg==\n","encoding":"base64"}

